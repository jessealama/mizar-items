environ
vocabularies STRUCT_0,XBOOLE_0,MSUALG_1,RELAT_1,PBOOLE,MEMBER_1,TARSKI,REALSET1,FUNCT_1,PZFMISC1,MSUALG_3,FUNCT_6,MSAFREE,LANG1,MCART_1,TREES_4,SUBSET_1,FUNCOP_1,PRELAMB,MSUALG_2,UNIALG_2,MARGREL1,CARD_3,NAT_1,PARTFUN1;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,RELSET_1,FUNCT_1,MCART_1,PARTFUN1,FUNCOP_1,FUNCT_6,PZFMISC1,FINSEQ_2,STRUCT_0,LANG1,FUNCT_2,CARD_3,NAT_1,TREES_4,DTCONSTR,PBOOLE,MSUALG_1,MSUALG_2,MSUALG_3,MSAFREE;
definitions MSUALG_2,MSUALG_3,PBOOLE,FUNCOP_1,TARSKI,XBOOLE_0;
theorems FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_6,MCART_1,MSAFREE,MSAFREE2,MSUALG_1,MSUALG_2,MSUALG_3,MSUHOM_1,PBOOLE,RELAT_1,CARD_3,RELSET_1,PZFMISC1,ORDINAL1,PARTFUN1,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13;
schemes MSAFREE1,PBOOLE;
registrations FUNCT_1,RELSET_1,FUNCOP_1,PBOOLE,STRUCT_0,MSUALG_1,MSUALG_3,MSAFREE,MSSUBFAM;
constructors PZFMISC1,MSSUBFAM,MSUALG_3,MSAFREE,RELSET_1,FINSEQ_2;
requirements SUBSET,BOOLE;
begin
reserve I for set;
reserve A for (ManySortedSet of I);
reserve B for  non-empty (ManySortedSet of I);
theorem
Th17: (for F being (ManySortedFunction of A,B) holds (A is  non-empty implies (F is  "1-1" iff (for C being (ManySortedSet of I) holds (for G,H being (ManySortedFunction of C,A) holds (( F ** G ) = ( F ** H ) implies G = H))))))
proof
let F being (ManySortedFunction of A,B);
assume that
A1: A is  non-empty;
thus (F is  "1-1" implies (for C being (ManySortedSet of I) holds (for G,H being (ManySortedFunction of C,A) holds (( F ** G ) = ( F ** H ) implies G = H))))
proof
assume A2: F is  "1-1";
let C being (ManySortedSet of I);
let G being (ManySortedFunction of C,A),H being (ManySortedFunction of C,A);
assume that
A3: ( F ** G ) = ( F ** H );
now
let i being set;
assume A4: i in I;
then reconsider f = ( F . i ) as (Function of ( A . i ),( B . i )) by PBOOLE:def 15;
reconsider h = ( H . i ) as (Function of ( C . i ),( A . i )) by A4,PBOOLE:def 15;
reconsider g = ( G . i ) as (Function of ( C . i ),( A . i )) by A4,PBOOLE:def 15;
A5: f is  one-to-one by A2,A4,MSUALG_3:1;
( f * g ) = ( ( F ** H ) . i ) by A3,A4,MSUALG_3:2
.= ( f * h ) by A4,MSUALG_3:2;
hence ( G . i ) = ( H . i ) by A1,A4,A5,FUNCT_2:21;
end;
hence thesis by PBOOLE:3;
end;

assume that
A6: (for C being (ManySortedSet of I) holds (for G,H being (ManySortedFunction of C,A) holds (( F ** G ) = ( F ** H ) implies G = H)))
and
A7: (not F is  "1-1");
consider j being set such that A8: j in I and A9: (not ( F . j ) is  one-to-one) by A7,MSUALG_3:1;
( F . j ) is (Function of ( A . j ),( B . j )) by A8,PBOOLE:def 15;
then consider Z being set such that A10: (ex g,h being (Function of Z,( A . j )) st (( ( F . j ) * g ) = ( ( F . j ) * h ) & g <> h)) by A1,A8,A9,FUNCT_2:21;
consider g being (Function of Z,( A . j )),h being (Function of Z,( A . j )) such that A11: ( ( F . j ) * g ) = ( ( F . j ) * h ) and A12: g <> h by A10;
(ex C being (ManySortedSet of I) st (ex G,H being (ManySortedFunction of C,A) st (( F ** G ) = ( F ** H ) & G <> H)))
proof
deffunc F(set) = ( IFEQ ($1,j,Z,( A . $1 )) );
consider C being (ManySortedSet of I) such that A13: (for i being set holds (i in I implies ( C . i ) = F(i))) from PBOOLE:sch 4;
take C;
deffunc F(set) = ( IFEQ ($1,j,g,( ( id C ) . $1 )) );
consider G being (ManySortedSet of I) such that A14: (for i being set holds (i in I implies ( G . i ) = F(i))) from PBOOLE:sch 4;
deffunc F(set) = ( IFEQ ($1,j,h,( ( id C ) . $1 )) );
consider H being (ManySortedSet of I) such that A15: (for i being set holds (i in I implies ( H . i ) = F(i))) from PBOOLE:sch 4;
now
let G being (ManySortedSet of I);
let g being (Function of Z,( A . j )),h being (Function of Z,( A . j ));
assume that
( ( F . j ) * g ) = ( ( F . j ) * h )
and
g <> h
and
A16: (for i being set holds (i in I implies ( G . i ) = ( IFEQ (i,j,g,( ( id C ) . i )) )));
thus G is  Function-yielding
proof
let i being set;
assume i in ( dom G );
then A17: i in I by PARTFUN1:def 2;
now
per cases ;
case i = j;
then ( IFEQ (i,j,g,( ( id C ) . i )) ) = g by FUNCOP_1:def 8;
hence thesis by A16,A17;
end;
case i <> j;
then ( IFEQ (i,j,g,( ( id C ) . i )) ) = ( ( id C ) . i ) by FUNCOP_1:def 8;
hence thesis by A16,A17;
end;
end;
hence thesis;
end;

end;
then reconsider G,H as (ManySortedFunction of I) by A11,A12,A14,A15;
now
let G being (ManySortedFunction of I);
let g being (Function of Z,( A . j )),h being (Function of Z,( A . j ));
assume that
( ( F . j ) * g ) = ( ( F . j ) * h )
and
g <> h
and
A18: (for i being set holds (i in I implies ( G . i ) = ( IFEQ (i,j,g,( ( id C ) . i )) )));
thus G is (ManySortedFunction of C,A)
proof
let i being set;
assume that
A19: i in I;
now
per cases ;
case A20: i = j;
then A21: (( IFEQ (i,j,g,( ( id C ) . i )) ) = g & ( IFEQ (i,j,Z,( A . i )) ) = Z) by FUNCOP_1:def 8;
( C . i ) = ( IFEQ (i,j,Z,( A . i )) ) by A13,A19;
hence thesis by A18,A19,A20,A21;
end;
case A22: i <> j;
then ( IFEQ (i,j,Z,( A . i )) ) = ( A . i ) by FUNCOP_1:def 8;
then A23: ( C . i ) = ( A . i ) by A13,A19;
( IFEQ (i,j,g,( ( id C ) . i )) ) = ( ( id C ) . i ) by A22,FUNCOP_1:def 8;
then ( G . i ) = ( ( id C ) . i ) by A18,A19;
hence thesis by A19,A23,PBOOLE:def 15;
end;
end;
hence thesis;
end;

end;
then reconsider G,H as (ManySortedFunction of C,A) by A11,A12,A14,A15;
A24:now
let i being set;
assume that
A25: i in I;
now
per cases ;
case A26: i = j;
then ( IFEQ (i,j,h,( ( id C ) . i )) ) = h by FUNCOP_1:def 8;
then A27: h = ( H . i ) by A15,A25;
( IFEQ (i,j,g,( ( id C ) . i )) ) = g by A26,FUNCOP_1:def 8;
then g = ( G . i ) by A14,A25;
hence ( ( F ** G ) . i ) = ( ( F . j ) * h ) by A8,A11,A26,MSUALG_3:2
.= ( ( F ** H ) . i ) by A8,A26,A27,MSUALG_3:2;
end;
case A28: i <> j;
reconsider g9 = ( G . i ) as (Function of ( C . i ),( A . i )) by A25,PBOOLE:def 15;
reconsider f9 = ( F . i ) as (Function of ( A . i ),( B . i )) by A25,PBOOLE:def 15;
reconsider h9 = ( H . i ) as (Function of ( C . i ),( A . i )) by A25,PBOOLE:def 15;
A29: ( IFEQ (i,j,h,( ( id C ) . i )) ) = ( ( id C ) . i ) by A28,FUNCOP_1:def 8;
( IFEQ (i,j,g,( ( id C ) . i )) ) = ( ( id C ) . i ) by A28,FUNCOP_1:def 8;
then g9 = ( ( id C ) . i ) by A14,A25
.= h9 by A15,A25,A29;
hence ( ( F ** G ) . i ) = ( f9 * h9 ) by A25,MSUALG_3:2
.= ( ( F ** H ) . i ) by A25,MSUALG_3:2;
end;
end;
hence ( ( F ** G ) . i ) = ( ( F ** H ) . i );
end;
take G;
take H;
(( F ** G ) is (ManySortedSet of I) & ( F ** H ) is (ManySortedSet of I)) by CKB1:1;
hence ( F ** G ) = ( F ** H ) by A24,PBOOLE:3;
(ex i being set st (i in I & ( G . i ) <> ( H . i )))
proof
take i = j;
thus i in I by A8;
A30: h = ( IFEQ (i,j,h,( ( id C ) . i )) ) by FUNCOP_1:def 8
.= ( H . i ) by A8,A15;
g = ( IFEQ (i,j,g,( ( id C ) . i )) ) by FUNCOP_1:def 8
.= ( G . i ) by A8,A14;
hence thesis by A12,A30;
end;
hence thesis;
end;
hence contradiction by A6;
end;
