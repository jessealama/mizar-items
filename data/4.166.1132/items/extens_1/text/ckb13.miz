environ
vocabularies STRUCT_0,XBOOLE_0,MSUALG_1,RELAT_1,PBOOLE,MEMBER_1,TARSKI,REALSET1,FUNCT_1,PZFMISC1,MSUALG_3,FUNCT_6,MSAFREE,LANG1,MCART_1,TREES_4,SUBSET_1,FUNCOP_1,PRELAMB,MSUALG_2,UNIALG_2,MARGREL1,CARD_3,NAT_1,PARTFUN1;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,RELSET_1,FUNCT_1,MCART_1,PARTFUN1,FUNCOP_1,FUNCT_6,PZFMISC1,FINSEQ_2,STRUCT_0,LANG1,FUNCT_2,CARD_3,NAT_1,TREES_4,DTCONSTR,PBOOLE,MSUALG_1,MSUALG_2,MSUALG_3,MSAFREE;
definitions MSUALG_2,MSUALG_3,PBOOLE,FUNCOP_1,TARSKI,XBOOLE_0;
theorems FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_6,MCART_1,MSAFREE,MSAFREE2,MSUALG_1,MSUALG_2,MSUALG_3,MSUHOM_1,PBOOLE,RELAT_1,CARD_3,RELSET_1,PZFMISC1,ORDINAL1,PARTFUN1,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12;
schemes MSAFREE1,PBOOLE;
registrations FUNCT_1,RELSET_1,FUNCOP_1,PBOOLE,STRUCT_0,MSUALG_1,MSUALG_3,MSAFREE,MSSUBFAM;
constructors PZFMISC1,MSSUBFAM,MSUALG_3,MSAFREE,RELSET_1,FINSEQ_2;
requirements SUBSET,BOOLE;
begin
reserve I for set;
reserve A for (ManySortedSet of I);
reserve B for  non-empty (ManySortedSet of I);
reserve C for  non-empty (ManySortedSet of I);
theorem
Th16: (for F being (ManySortedFunction of A,B) holds (F is  "onto" iff (for C holds (for G,H being (ManySortedFunction of B,C) holds (( G ** F ) = ( H ** F ) implies G = H)))))
proof
let F being (ManySortedFunction of A,B);
thus (F is  "onto" implies (for C holds (for G,H being (ManySortedFunction of B,C) holds (( G ** F ) = ( H ** F ) implies G = H))))
proof
assume A1: F is  "onto";
let C;
let G being (ManySortedFunction of B,C),H being (ManySortedFunction of B,C);
assume that
A2: ( G ** F ) = ( H ** F );
now
let i being set;
assume A3: i in I;
then reconsider f = ( F . i ) as (Function of ( A . i ),( B . i )) by PBOOLE:def 15;
reconsider h = ( H . i ) as (Function of ( B . i ),( C . i )) by A3,PBOOLE:def 15;
reconsider g = ( G . i ) as (Function of ( B . i ),( C . i )) by A3,PBOOLE:def 15;
A4: ( rng f ) = ( B . i ) by A1,A3,MSUALG_3:def 3;
( g * f ) = ( ( H ** F ) . i ) by A2,A3,MSUALG_3:2
.= ( h * f ) by A3,MSUALG_3:2;
hence ( G . i ) = ( H . i ) by A3,A4,FUNCT_2:16;
end;
hence thesis by PBOOLE:3;
end;

assume that
A5: (for C holds (for G,H being (ManySortedFunction of B,C) holds (( G ** F ) = ( H ** F ) implies G = H)))
and
A6: (not F is  "onto");
consider j being set such that A7: j in I and A8: ( rng ( F . j ) ) <> ( B . j ) by A6,MSUALG_3:def 3;
reconsider I as non empty set by A7;
reconsider j as (Element of I) by A7;
reconsider A,B as (ManySortedSet of I);
reconsider F as (ManySortedFunction of A,B);
reconsider f = ( F . j ) as (Function of ( A . j ),( B . j ));
consider Z being set such that A9: Z <> ( {} ) and A10: (ex g,h being (Function of ( B . j ),Z) st (( g * f ) = ( h * f ) & g <> h)) by A8,FUNCT_2:16;
consider g being (Function of ( B . j ),Z),h being (Function of ( B . j ),Z) such that A11: ( g * ( F . j ) ) = ( h * ( F . j ) ) and A12: g <> h by A10;
(ex C being (ManySortedSet of I) st (C is  non-empty & (ex G,H being (ManySortedFunction of B,C) st (( G ** F ) = ( H ** F ) & G <> H))))
proof
deffunc F(set) = ( IFEQ ($1,j,Z,( B . $1 )) );
consider C being (ManySortedSet of I) such that A13: (for i being set holds (i in I implies ( C . i ) = F(i))) from PBOOLE:sch 4;
take C;
thus C is  non-empty
proof
let i being set;
assume that
A14: i in I;
now
per cases ;
case i = j;
then ( IFEQ (i,j,Z,( B . i )) ) = Z by FUNCOP_1:def 8;
hence thesis by A9,A13,A14;
end;
case i <> j;
then ( IFEQ (i,j,Z,( B . i )) ) = ( B . i ) by FUNCOP_1:def 8;
hence thesis by A13,A14;
end;
end;
hence thesis;
end;

deffunc F(set) = ( IFEQ ($1,j,g,( ( id B ) . $1 )) );
consider G being (ManySortedSet of I) such that A15: (for i being set holds (i in I implies ( G . i ) = F(i))) from PBOOLE:sch 4;
deffunc F(set) = ( IFEQ ($1,j,h,( ( id B ) . $1 )) );
consider H being (ManySortedSet of I) such that A16: (for i being set holds (i in I implies ( H . i ) = F(i))) from PBOOLE:sch 4;
now
let G being (ManySortedSet of I);
let g being (Function of ( B . j ),Z),h being (Function of ( B . j ),Z);
assume that
( g * ( F . j ) ) = ( h * ( F . j ) )
and
g <> h
and
A17: (for i being set holds (i in I implies ( G . i ) = ( IFEQ (i,j,g,( ( id B ) . i )) )));
thus G is  Function-yielding
proof
let i being set;
assume i in ( dom G );
then A18: i in I by PARTFUN1:def 2;
now
per cases ;
case i = j;
then ( IFEQ (i,j,g,( ( id B ) . i )) ) = g by FUNCOP_1:def 8;
hence thesis by A17,A18;
end;
case i <> j;
then ( IFEQ (i,j,g,( ( id B ) . i )) ) = ( ( id B ) . i ) by FUNCOP_1:def 8;
hence thesis by A17,A18;
end;
end;
hence thesis;
end;

end;
then reconsider G,H as (ManySortedFunction of I) by A11,A12,A15,A16;
now
let G being (ManySortedFunction of I);
let g being (Function of ( B . j ),Z),h being (Function of ( B . j ),Z);
assume that
( g * ( F . j ) ) = ( h * ( F . j ) )
and
g <> h
and
A19: (for i being set holds (i in I implies ( G . i ) = ( IFEQ (i,j,g,( ( id B ) . i )) )));
thus G is (ManySortedFunction of B,C)
proof
let i being set;
assume that
A20: i in I;
now
per cases ;
case A21: i = j;
then A22: ( IFEQ (i,j,Z,( B . i )) ) = Z by FUNCOP_1:def 8;
(( IFEQ (i,j,g,( ( id B ) . i )) ) = g & ( C . i ) = ( IFEQ (i,j,Z,( B . i )) )) by A13,A21,FUNCOP_1:def 8;
hence thesis by A19,A21,A22;
end;
case A23: i <> j;
then ( IFEQ (i,j,Z,( B . i )) ) = ( B . i ) by FUNCOP_1:def 8;
then A24: ( B . i ) = ( C . i ) by A13,A20;
( IFEQ (i,j,g,( ( id B ) . i )) ) = ( ( id B ) . i ) by A23,FUNCOP_1:def 8;
then ( G . i ) = ( ( id B ) . i ) by A19,A20;
hence thesis by A20,A24,PBOOLE:def 15;
end;
end;
hence thesis;
end;

end;
then reconsider G,H as (ManySortedFunction of B,C) by A11,A12,A15,A16;
A25:now
let i being set;
assume that
A26: i in I;
now
per cases ;
case A27: i = j;
then ( IFEQ (i,j,h,( ( id B ) . i )) ) = h by FUNCOP_1:def 8;
then A28: h = ( H . i ) by A16,A26;
( IFEQ (i,j,g,( ( id B ) . i )) ) = g by A27,FUNCOP_1:def 8;
then g = ( G . i ) by A15,A26;
hence ( ( G ** F ) . i ) = ( h * ( F . j ) ) by A11,A27,MSUALG_3:2
.= ( ( H ** F ) . i ) by A27,A28,MSUALG_3:2;
end;
case A29: i <> j;
reconsider g9 = ( G . i ) as (Function of ( B . i ),( C . i )) by A26,PBOOLE:def 15;
reconsider f9 = ( F . i ) as (Function of ( A . i ),( B . i )) by A26,PBOOLE:def 15;
reconsider h9 = ( H . i ) as (Function of ( B . i ),( C . i )) by A26,PBOOLE:def 15;
A30: ( IFEQ (i,j,h,( ( id B ) . i )) ) = ( ( id B ) . i ) by A29,FUNCOP_1:def 8;
( IFEQ (i,j,g,( ( id B ) . i )) ) = ( ( id B ) . i ) by A29,FUNCOP_1:def 8;
then g9 = ( ( id B ) . i ) by A15,A26
.= h9 by A16,A26,A30;
hence ( ( G ** F ) . i ) = ( h9 * f9 ) by A26,MSUALG_3:2
.= ( ( H ** F ) . i ) by A26,MSUALG_3:2;
end;
end;
hence ( ( G ** F ) . i ) = ( ( H ** F ) . i );
end;
take G;
take H;
(( G ** F ) is (ManySortedSet of I) & ( H ** F ) is (ManySortedSet of I)) by CKB1:1;
hence ( G ** F ) = ( H ** F ) by A25,PBOOLE:3;
(ex i being set st (i in I & ( G . i ) <> ( H . i )))
proof
take i = j;
thus i in I;
A31: h = ( IFEQ (i,j,h,( ( id B ) . i )) ) by FUNCOP_1:def 8
.= ( H . i ) by A16;
g = ( IFEQ (i,j,g,( ( id B ) . i )) ) by FUNCOP_1:def 8
.= ( G . i ) by A15;
hence thesis by A12,A31;
end;
hence thesis;
end;
hence contradiction by A5;
end;
