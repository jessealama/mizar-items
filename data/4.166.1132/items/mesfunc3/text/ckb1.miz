environ
vocabularies NUMBERS,NAT_1,FUNCT_1,ZFMISC_1,FINSEQ_1,RELAT_1,CARD_3,ARYTM_3,SUBSET_1,XXREAL_0,TARSKI,XBOOLE_0,FINSEQ_2,ARYTM_1,PARTFUN1,BINOP_2,ORDINAL4,CARD_1,FUNCOP_1,PROB_1,MESFUNC2,FUNCT_3,SUPINF_2,PROB_2,MEASURE1,ORDINAL1,XXREAL_2,ORDINAL2,SUPINF_1,XREAL_0,MESFUNC1,VALUED_0,COMPLEX1,SETFAM_1,FINSET_1,FINSOP_1,SETWISEO,INTEGRA1,REAL_1,MESFUNC3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,CARD_1,NUMBERS,XCMPLX_0,NAT_1,REAL_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,XREAL_0,SETWOP_2,FINSEQ_1,SETFAM_1,FUNCOP_1,FINSOP_1,FUNCT_3,FINSET_1,PROB_1,PROB_2,XXREAL_0,XXREAL_2,SUPINF_1,SUPINF_2,MEASURE1,FINSEQOP,FINSEQ_2,BINOP_1,SEQ_1,BINOP_2,RVSUM_1,EXTREAL1,MESFUNC1,MESFUNC2;
definitions TARSKI,XBOOLE_0,BINOP_1,SUPINF_2,MESFUNC1;
theorems MEASURE1,TARSKI,FUNCT_1,FUNCT_2,NAT_1,SUPINF_2,EXTREAL1,EXTREAL2,ZFMISC_1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FUNCOP_1,FINSEQ_4,PROB_2,FUNCT_3,XBOOLE_0,XBOOLE_1,RELAT_1,RVSUM_1,BINOP_2,MESFUNC2,MEASURE2,FINSOP_1,CARD_2,XREAL_1,XXREAL_0,ORDINAL1,NUMBERS,VALUED_1,XXREAL_2,VALUED_0,XXREAL_3;
schemes FINSEQ_1,FINSEQ_2,NAT_1,PARTFUN1,BINOP_1;
registrations SUBSET_1,RELAT_1,ORDINAL1,FUNCT_2,NUMBERS,XXREAL_0,XREAL_0,NAT_1,BINOP_2,MEMBERED,FINSEQ_1,MEASURE1,FINSET_1,VALUED_0,CARD_1,CARD_3,XXREAL_3,RELSET_1;
constructors PARTFUN1,BINOP_1,SETWISEO,REAL_1,NAT_1,FINSEQOP,PROB_2,FINSOP_1,RVSUM_1,MEASURE3,MEASURE6,EXTREAL1,MESFUNC1,BINARITH,MESFUNC2,SEQ_1,BINOP_2,SUPINF_1,RELSET_1;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
theorem
Th1: (for n,m being Nat holds (for a being (Function of [: ( Seg n ),( Seg m ) :],( REAL )) holds (for p,q being (FinSequence of ( REAL )) holds (((( dom p ) = ( Seg n ) & (for i being Nat holds (i in ( dom p ) implies (ex r being (FinSequence of ( REAL )) st ((( dom r ) = ( Seg m ) & ( p . i ) = ( Sum r )) & (for j being Nat holds (j in ( dom r ) implies ( r . j ) = ( a . [ i,j ] )))))))) & (( dom q ) = ( Seg m ) & (for j being Nat holds (j in ( dom q ) implies (ex s being (FinSequence of ( REAL )) st ((( dom s ) = ( Seg n ) & ( q . j ) = ( Sum s )) & (for i being Nat holds (i in ( dom s ) implies ( s . i ) = ( a . [ i,j ] ))))))))) implies ( Sum p ) = ( Sum q )))))
proof
defpred P[ Nat ]
 means
(for m being Nat holds (for a being (Function of [: ( Seg $1 ),( Seg m ) :],( REAL )) holds (for p,q being (FinSequence of ( REAL )) holds (((( dom p ) = ( Seg $1 ) & (for i being Nat holds (i in ( dom p ) implies (ex r being (FinSequence of ( REAL )) st ((( dom r ) = ( Seg m ) & ( p . i ) = ( Sum r )) & (for j being Nat holds (j in ( dom r ) implies ( r . j ) = ( a . [ i,j ] )))))))) & (( dom q ) = ( Seg m ) & (for j being Nat holds (j in ( dom q ) implies (ex s being (FinSequence of ( REAL )) st ((( dom s ) = ( Seg $1 ) & ( q . j ) = ( Sum s )) & (for i being Nat holds (i in ( dom s ) implies ( s . i ) = ( a . [ i,j ] ))))))))) implies ( Sum p ) = ( Sum q )))));
A1: (for n being Nat holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
let n being Nat;
assume that
A2: P[ n ];
reconsider n as (Element of ( NAT )) by ORDINAL1:def 12;
now
let m being Nat;
let a being (Function of [: ( Seg ( n + 1 ) ),( Seg m ) :],( REAL ));
let p being (FinSequence of ( REAL )),q being (FinSequence of ( REAL ));
assume that
A3: ( dom p ) = ( Seg ( n + 1 ) )
and
A4: (for i being Nat holds (i in ( dom p ) implies (ex r being (FinSequence of ( REAL )) st ((( dom r ) = ( Seg m ) & ( p . i ) = ( Sum r )) & (for j being Nat holds (j in ( dom r ) implies ( r . j ) = ( a . [ i,j ] )))))))
and
A5: ( dom q ) = ( Seg m )
and
A6: (for j being Nat holds (j in ( dom q ) implies (ex s being (FinSequence of ( REAL )) st ((( dom s ) = ( Seg ( n + 1 ) ) & ( q . j ) = ( Sum s )) & (for i being Nat holds (i in ( dom s ) implies ( s . i ) = ( a . [ i,j ] )))))));
set a0 = ( a | [: ( Seg n ),( Seg m ) :] );
n <= ( n + 1 ) by NAT_1:11;
then ( Seg n ) c= ( Seg ( n + 1 ) ) by FINSEQ_1:5;
then [: ( Seg n ),( Seg m ) :] c= [: ( Seg ( n + 1 ) ),( Seg m ) :] by ZFMISC_1:95;
then reconsider a0 as (Function of [: ( Seg n ),( Seg m ) :],( REAL )) by FUNCT_2:32;
deffunc F(Nat) = ( a . [ ( n + 1 ),$1 ] );
reconsider p0 = ( p | ( Seg n ) ) as (FinSequence of ( REAL )) by FINSEQ_1:18;
( len p ) = ( n + 1 ) by A3,FINSEQ_1:def 3;
then A7: n <= ( len p ) by NAT_1:11;
then A8: ( dom p0 ) = ( Seg n ) by FINSEQ_1:17;
A9: ( dom p0 ) = ( Seg n ) by A7,FINSEQ_1:17;
A10:now
let i being Nat;
assume that
A11: i in ( dom p0 );
consider r being (FinSequence of ( REAL )) such that A12: ( dom r ) = ( Seg m ) and A13: ( p . i ) = ( Sum r ) and A14: (for j being Nat holds (j in ( dom r ) implies ( r . j ) = ( a . [ i,j ] ))) by A3,A4,A9,A11,FINSEQ_2:8;
take r;
thus ( dom r ) = ( Seg m ) by A12;
thus ( p0 . i ) = ( Sum r ) by A11,A13,FUNCT_1:47;
thus (for j being Nat holds (j in ( dom r ) implies ( r . j ) = ( a0 . [ i,j ] )))
proof
n <= ( n + 1 ) by NAT_1:11;
then A15: ( Seg n ) c= ( Seg ( n + 1 ) ) by FINSEQ_1:5;
( dom a ) = [: ( Seg ( n + 1 ) ),( Seg m ) :] by FUNCT_2:def 1;
then A16: ( dom a0 ) = ( [: ( Seg ( n + 1 ) ),( Seg m ) :] /\ [: ( Seg n ),( Seg m ) :] ) by RELAT_1:61
.= [: ( Seg n ),( Seg m ) :] by A15,ZFMISC_1:101;
let j being Nat;
assume that
A17: j in ( dom r );
A18: [ i,j ] in [: ( Seg n ),( Seg m ) :] by A9,A11,A12,A17,ZFMISC_1:87;
thus ( r . j ) = ( a . [ i,j ] ) by A14,A17
.= ( a0 . [ i,j ] ) by A18,A16,FUNCT_1:47;
end;

end;
reconsider m as (Element of ( NAT )) by ORDINAL1:def 12;
consider an being FinSequence such that A19: (( len an ) = m & (for j being Nat holds (j in ( dom an ) implies ( an . j ) = F(j)))) from FINSEQ_1:sch 2;
A20:now
let i being Nat;
assume i in ( dom an );
then ( an . i ) = ( a . [ ( n + 1 ),i ] ) by A19;
hence ( an . i ) in ( REAL );
end;
A21: ( dom an ) = ( Seg m ) by A19,FINSEQ_1:def 3;
reconsider an as (FinSequence of ( REAL )) by A20,FINSEQ_2:12;
A22: an is (Element of ( m -tuples_on ( REAL ) )) by A19,FINSEQ_2:92;
A23: ( dom an ) = ( Seg m ) by A19,FINSEQ_1:def 3;
A24: ( Sum an ) = ( p . ( n + 1 ) )
proof
consider r being (FinSequence of ( REAL )) such that A25: ( dom r ) = ( Seg m ) and A26: ( p . ( n + 1 ) ) = ( Sum r ) and A27: (for j being Nat holds (j in ( dom r ) implies ( r . j ) = ( a . [ ( n + 1 ),j ] ))) by A3,A4,FINSEQ_1:4;
now
let j being Nat;
assume A28: j in ( dom r );
hence ( r . j ) = ( a . [ ( n + 1 ),j ] ) by A27
.= ( an . j ) by A19,A21,A25,A28;
end;
hence thesis by A23,A25,A26,FINSEQ_1:13;
end;
reconsider q0 = ( q - an ) as (FinSequence of ( REAL ));
A29: ( rng <: q,an :> ) c= [: ( rng q ),( rng an ) :] by FUNCT_3:51;
( dom ( diffreal ) ) = [: ( REAL ),( REAL ) :] by FUNCT_2:def 1;
then A30: [: ( rng q ),( rng an ) :] c= ( dom ( diffreal ) ) by ZFMISC_1:96;
( dom ( ( diffreal ) .: (q,an) ) ) = ( dom ( ( diffreal ) * <: q,an :> ) ) by FUNCOP_1:def 3
.= ( dom <: q,an :> ) by A30,A29,RELAT_1:27,XBOOLE_1:1
.= ( ( dom q ) /\ ( dom an ) ) by FUNCT_3:def 7;
then A31: ( dom q0 ) = ( ( dom q ) /\ ( dom an ) ) by RVSUM_1:def 6
.= ( ( Seg m ) /\ ( Seg m ) ) by A5,A19,FINSEQ_1:def 3
.= ( Seg m );
then ( len q0 ) = m by FINSEQ_1:def 3;
then A32: q0 is (Element of ( m -tuples_on ( REAL ) )) by FINSEQ_2:92;
A33:now
let j being Nat;
assume that
A34: j in ( dom q0 );
consider s being (FinSequence of ( REAL )) such that A35: ( dom s ) = ( Seg ( n + 1 ) ) and A36: ( q . j ) = ( Sum s ) and A37: (for i being Nat holds (i in ( dom s ) implies ( s . i ) = ( a . [ i,j ] ))) by A5,A6,A31,A34;
( s . ( n + 1 ) ) = ( a . [ ( n + 1 ),j ] ) by A35,A37,FINSEQ_1:4;
then A38: ( s . ( n + 1 ) ) = ( an . j ) by A19,A21,A31,A34;
reconsider sn = ( s | ( Seg n ) ) as (FinSequence of ( REAL )) by FINSEQ_1:18;
take sn;
A39: ( len s ) = ( n + 1 ) by A35,FINSEQ_1:def 3;
then n <= ( len s ) by NAT_1:11;
hence A40: ( dom sn ) = ( Seg n ) by FINSEQ_1:17;
( sn ^ <* ( s . ( n + 1 ) ) *> ) = s by A39,FINSEQ_3:55;
then ( ( q . j ) - ( an . j ) ) = ( ( ( Sum sn ) + ( an . j ) ) - ( an . j ) ) by A36,A38,RVSUM_1:74
.= ( Sum sn );
hence ( q0 . j ) = ( Sum sn ) by A34,VALUED_1:13;
thus (for i being Nat holds (i in ( dom sn ) implies ( sn . i ) = ( a0 . [ i,j ] )))
proof
n <= ( n + 1 ) by NAT_1:11;
then A41: ( Seg n ) c= ( Seg ( n + 1 ) ) by FINSEQ_1:5;
( dom a ) = [: ( Seg ( n + 1 ) ),( Seg m ) :] by FUNCT_2:def 1;
then A42: ( dom a0 ) = ( [: ( Seg ( n + 1 ) ),( Seg m ) :] /\ [: ( Seg n ),( Seg m ) :] ) by RELAT_1:61
.= [: ( Seg n ),( Seg m ) :] by A41,ZFMISC_1:101;
let i being Nat;
assume that
A43: i in ( dom sn );
A44: [ i,j ] in [: ( Seg n ),( Seg m ) :] by A31,A34,A40,A43,ZFMISC_1:87;
thus ( sn . i ) = ( s . i ) by A43,FUNCT_1:47
.= ( a . [ i,j ] ) by A35,A37,A40,A43,A41
.= ( a0 . [ i,j ] ) by A44,A42,FUNCT_1:47;
end;

end;
( len q ) = m by A5,FINSEQ_1:def 3;
then q is (Element of ( m -tuples_on ( REAL ) )) by FINSEQ_2:92;
then A45: ( q0 + an ) = q by A22,RVSUM_1:43;
( len p ) = ( n + 1 ) by A3,FINSEQ_1:def 3;
then ( p0 ^ <* ( Sum an ) *> ) = p by A24,FINSEQ_3:55;
hence ( Sum p ) = ( ( Sum p0 ) + ( Sum an ) ) by RVSUM_1:74
.= ( ( Sum q0 ) + ( Sum an ) ) by A2,A10,A8,A31,A33
.= ( Sum q ) by A32,A22,A45,RVSUM_1:89;
end;
hence thesis;
end;
now
let m being Nat;
let a being (Function of [: ( Seg ( 0 ) ),( Seg m ) :],( REAL ));
let p being (FinSequence of ( REAL )),q being (FinSequence of ( REAL ));
assume that
A46: ( dom p ) = ( Seg ( 0 ) )
and
(for i being Nat holds (i in ( dom p ) implies (ex r being (FinSequence of ( REAL )) st ((( dom r ) = ( Seg m ) & ( p . i ) = ( Sum r )) & (for j being Nat holds (j in ( dom r ) implies ( r . j ) = ( a . [ i,j ] )))))))
and
A47: ( dom q ) = ( Seg m )
and
A48: (for j being Nat holds (j in ( dom q ) implies (ex s being (FinSequence of ( REAL )) st ((( dom s ) = ( Seg ( 0 ) ) & ( q . j ) = ( Sum s )) & (for i being Nat holds (i in ( dom s ) implies ( s . i ) = ( a . [ i,j ] )))))));
reconsider m as (Element of ( NAT )) by ORDINAL1:def 12;
now
let z being set;
assume A49: z in ( dom q );
then z in { k where k is (Element of ( NAT )): (1 <= k & k <= m) } by A47,FINSEQ_1:def 1;
then (ex k being (Element of ( NAT )) st ((z = k & 1 <= k) & k <= m));
then reconsider j = z as Nat;
consider s being (FinSequence of ( REAL )) such that A50: ( dom s ) = ( Seg ( 0 ) ) and A51: ( q . j ) = ( Sum s ) and (for i being Nat holds (i in ( dom s ) implies ( s . i ) = ( a . [ i,j ] ))) by A48,A49;
( len s ) = ( 0 ) by A50,FINSEQ_1:def 3;
then s = ( <*> ( REAL ) );
hence ( q . z ) = ( 0 ) by A51,RVSUM_1:72;
end;
then q = ( ( dom q ) --> ( 0 ) ) by FUNCOP_1:11;
then A52: q = ( m |-> ( 0 ) ) by A47,FINSEQ_2:def 2;
( len p ) = ( 0 ) by A46,FINSEQ_1:def 3;
then p = ( <*> ( REAL ) );
then ( Sum p ) = ( 0 ) by RVSUM_1:72;
hence ( Sum p ) = ( Sum q ) by A52,RVSUM_1:81;
end;
then A53: P[ ( 0 ) ];
thus (for n being Nat holds P[ n ]) from NAT_1:sch 2(A53,A1);
end;
