environ
vocabularies NUMBERS,XBOOLE_0,PROB_1,MEASURE1,PARTFUN1,SUBSET_1,RELAT_1,FUNCT_1,XXREAL_0,ARYTM_1,SUPINF_2,SUPINF_1,CARD_1,REAL_1,VALUED_1,MEASURE6,INTEGRA5,MESFUNC5,ARYTM_3,MESFUNC1,COMPLEX1,TARSKI,MESFUNC2,VALUED_0,FINSEQ_1,BINOP_1,SETWISEO,CARD_3,ORDINAL1,FINSEQ_2,NEWTON,ORDINAL4,NAT_1,XREAL_0,POWER,SQUARE_1,XXREAL_2,ORDINAL2,RFUNCT_3,FUNCT_3,MESFUNC7;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,VALUED_0,XREAL_0,COMPLEX1,REAL_1,XXREAL_0,XXREAL_2,MEASURE1,NAT_1,SUPINF_1,RELAT_1,RELSET_1,SETWISEO,PARTFUN1,FINSEQ_1,FINSEQ_2,SETWOP_2,BINOP_1,FUNCT_2,NEWTON,SQUARE_1,PROB_1,SUPINF_2,EXTREAL1,POWER,MESFUNC5,MESFUNC1,MESFUNC2,MEASURE6;
definitions TARSKI,MESFUNC1,MEASURE6,MESFUNC5,XCMPLX_0,SQUARE_1;
theorems ABSVALUE,SETWISEO,POWER,HOLDER_1,TARSKI,PARTFUN1,FUNCT_1,SUPINF_2,EXTREAL1,EXTREAL2,BINOP_1,MESFUNC1,FINSEQ_1,XREAL_0,XBOOLE_0,XBOOLE_1,XCMPLX_1,MESFUNC2,NEWTON,XREAL_1,COMPLEX1,XXREAL_0,FINSEQ_2,MESFUNC5,FINSOP_1,NAT_1,RELAT_1,FUNCT_3,MEASURE1,MESFUNC6,ORDINAL1,VALUED_0,XXREAL_2,XXREAL_3,CKB1,CKB2,CKB3;
schemes FUNCT_2,NAT_1,PARTFUN2,BINOP_1,BINOP_2;
registrations SUBSET_1,NAT_1,RELSET_1,XREAL_0,MEMBERED,ORDINAL1,FINSEQ_1,MEASURE1,NUMBERS,XXREAL_0,XBOOLE_0,VALUED_0,POWER,XXREAL_3,CKB4,CKB5;
constructors REAL_1,FINSOP_1,EXTREAL1,BINOP_1,NEWTON,POWER,MESFUNC1,MEASURE6,MESFUNC2,MEASURE3,SETWISEO,EXTREAL2,SQUARE_1,MESFUNC5,SUPINF_1,RELSET_1,BINOP_2;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve X for non  empty set;
reserve S for (SigmaField of X);
reserve M for (sigma_Measure of S);
reserve f for (PartFunc of X,( ExtREAL ));
reserve E for (Element of S);
theorem
(f is_integrable_on M implies (ex F being (Function of ( NAT ),S) st (((for n being (Element of ( NAT )) holds ( F . n ) = ( ( dom f ) /\ ( great_eq_dom (|. f .|,( R_EAL ( 1 / ( n + 1 ) ) )) ) )) & ( ( dom f ) \ ( eq_dom (f,( 0. )) ) ) = ( union ( rng F ) )) & (for n being (Element of ( NAT )) holds (( F . n ) in S & ( M . ( F . n ) ) < ( +infty ))))))
proof
assume A1: f is_integrable_on M;
then consider E being (Element of S) such that A2: E = ( dom f ) and A3: f is_measurable_on E by MESFUNC5:def 17;
defpred P[ (Element of ( NAT )),set ]
 means
$2 = ( E /\ ( great_eq_dom (|. f .|,( R_EAL ( 1 / ( $1 + 1 ) ) )) ) );
A4: ( dom |. f .| ) = E by A2,MESFUNC1:def 10;
now
let x being set;
assume A5: x in ( E \ ( eq_dom (f,( 0. )) ) );
then reconsider z = x as (Element of X);
reconsider y = ( f . z ) as R_eal;
A6: x in E by A5,XBOOLE_0:def 5;
then A7: x in ( dom |. f .| ) by A2,MESFUNC1:def 10;
(not x in ( eq_dom (f,( 0. )) )) by A5,XBOOLE_0:def 5;
then (not y = ( 0. )) by A2,A6,MESFUNC1:def 15;
then ( 0. ) < |. ( f . z ) .| by EXTREAL2:4;
then ( 0. ) < ( |. f .| . z ) by A7,MESFUNC1:def 10;
then x in ( great_dom (|. f .|,( 0. )) ) by A7,MESFUNC1:def 13;
hence x in ( E /\ ( great_dom (|. f .|,( 0. )) ) ) by A6,XBOOLE_0:def 4;
end;
then A8: ( E \ ( eq_dom (f,( 0. )) ) ) c= ( E /\ ( great_dom (|. f .|,( 0. )) ) ) by TARSKI:def 3;
now
let x being set;
assume A9: x in ( E /\ ( great_dom (|. f .|,( 0. )) ) );
then reconsider z = x as (Element of X);
x in ( great_dom (|. f .|,( 0. )) ) by A9,XBOOLE_0:def 4;
then A10: ( 0. ) < ( |. f .| . z ) by MESFUNC1:def 13;
A11: x in E by A9,XBOOLE_0:def 4;
then x in ( dom |. f .| ) by A2,MESFUNC1:def 10;
then A12: ( 0. ) < |. ( f . z ) .| by A10,MESFUNC1:def 10;
(not x in ( eq_dom (f,( 0. )) ))
proof
assume x in ( eq_dom (f,( 0. )) );
then ( f . z ) = ( 0. ) by MESFUNC1:def 15;
hence contradiction by A12,EXTREAL2:5;
end;
hence x in ( E \ ( eq_dom (f,( 0. )) ) ) by A11,XBOOLE_0:def 5;
end;
then A13: ( E /\ ( great_dom (|. f .|,( 0. )) ) ) c= ( E \ ( eq_dom (f,( 0. )) ) ) by TARSKI:def 3;
A14: |. f .| is_measurable_on E by A2,A3,MESFUNC2:27;
A15: (for n being (Element of ( NAT )) holds (ex Z being (Element of S) st P[ n,Z ]))
proof
let n being (Element of ( NAT ));
take ( E /\ ( great_eq_dom (|. f .|,( R_EAL ( 1 / ( n + 1 ) ) )) ) );
thus thesis by A14,A4,MESFUNC1:27;
end;
consider F being (Function of ( NAT ),S) such that A16: (for n being (Element of ( NAT )) holds P[ n,( F . n ) ]) from FUNCT_2:sch 10(A15);
A17: (for n being (Element of ( NAT )) holds (( F . n ) in S & ( M . ( F . n ) ) < ( +infty )))
proof
let n being (Element of ( NAT ));
set d = ( R_EAL ( 1 / ( n + 1 ) ) );
set En = ( F . n );
set g = ( |. f .| | En );
A18: g is  nonnegative by MESFUNC5:15;
set z = ( R_EAL ( 1 / ( n + 1 ) ) );
A19: ( |. f .| | E ) = |. f .| by A4,RELAT_1:69;
A20: ( F . n ) = ( E /\ ( great_eq_dom (|. f .|,( R_EAL ( 1 / ( n + 1 ) ) )) ) ) by A16;
then A21: ( dom g ) = En by A4,RELAT_1:62,XBOOLE_1:17;
( ( dom |. f .| ) /\ En ) = ( E /\ En ) by A2,MESFUNC1:def 10;
then A22: ( ( dom |. f .| ) /\ En ) = En by A20,XBOOLE_1:17,XBOOLE_1:28;
|. f .| is_measurable_on En by A14,A20,MESFUNC1:30,XBOOLE_1:17;
then A23: g is_measurable_on En by A22,MESFUNC5:42;
then A24: ( integral+ (M,g) ) = ( Integral (M,g) ) by A21,MESFUNC5:15,MESFUNC5:88;
|. f .| is_integrable_on M by A1,A2,A3,MESFUNC5:100;
then A25: ( Integral (M,|. f .|) ) < ( +infty ) by MESFUNC5:96;
A26: ( ( z * ( M . En ) ) / z ) = ( M . En ) by XXREAL_3:88;
( F . n ) c= E by A20,XBOOLE_1:17;
then A27: ( Integral (M,g) ) <= ( Integral (M,|. f .|) ) by A2,A3,A4,A19,MESFUNC2:27,MESFUNC5:93;
consider nf being (PartFunc of X,( ExtREAL )) such that A28: nf is_simple_func_in S and A29: ( dom nf ) = En and A30: (for x being set holds (x in En implies ( nf . x ) = d)) by MESFUNC5:41;
(for x being set holds (x in ( dom nf ) implies ( nf . x ) >= ( 0 ))) by A29,A30;
then A31: nf is  nonnegative by SUPINF_2:52;
then A32: ( Integral (M,nf) ) = ( integral' (M,nf) ) by A28,MESFUNC5:89;
A33: ( F . n ) c= ( great_eq_dom (|. f .|,( R_EAL ( 1 / ( n + 1 ) ) )) ) by A20,XBOOLE_1:17;
A34: (for x being (Element of X) holds (x in ( dom nf ) implies ( nf . x ) <= ( g . x )))
proof
let x being (Element of X);
assume A35: x in ( dom nf );
then A36: ( R_EAL ( 1 / ( n + 1 ) ) ) <= ( |. f .| . x ) by A33,A29,MESFUNC1:def 14;
( g . x ) = ( |. f .| . x ) by A21,A29,A35,FUNCT_1:47;
hence thesis by A29,A30,A35,A36;
end;
nf is_measurable_on En by A28,MESFUNC2:34;
then ( integral+ (M,nf) ) <= ( integral+ (M,g) ) by A21,A23,A18,A29,A31,A34,MESFUNC5:85;
then A37: ( integral+ (M,nf) ) <= ( Integral (M,|. f .|) ) by A24,A27,XXREAL_0:2;
A38: ( ( +infty ) / z ) = ( +infty ) by XXREAL_3:83;
( integral+ (M,nf) ) = ( Integral (M,nf) ) by A28,A31,MESFUNC5:89;
then ( integral+ (M,nf) ) = ( ( R_EAL ( 1 / ( n + 1 ) ) ) * ( M . En ) ) by A29,A30,A32,MESFUNC5:104;
then ( ( R_EAL ( 1 / ( n + 1 ) ) ) * ( M . En ) ) < ( +infty ) by A25,A37,XXREAL_0:2;
hence thesis by A26,A38,XXREAL_3:80;
end;
take F;
(for n being (Element of ( NAT )) holds ( F . n ) = ( E /\ ( great_eq_dom (|. f .|,( R_EAL ( ( 0 ) + ( 1 / ( n + 1 ) ) ) )) ) )) by A16;
then ( E /\ ( great_dom (|. f .|,( R_EAL ( 0 ) )) ) ) = ( union ( rng F ) ) by MESFUNC1:22;
hence thesis by A2,A16,A13,A8,A17,XBOOLE_0:def 10;
end;
