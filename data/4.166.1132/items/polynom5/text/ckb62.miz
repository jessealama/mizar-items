environ
vocabularies NUMBERS,SUBSET_1,CARD_1,RELAT_1,ARYTM_1,ARYTM_3,XXREAL_0,XREAL_0,ORDINAL1,REAL_1,FINSEQ_1,FUNCT_1,CARD_3,ORDINAL4,TARSKI,PARTFUN1,XBOOLE_0,HAHNBAN1,XCMPLX_0,COMPLFLD,SUPINF_2,COMPLEX1,GROUP_1,POWER,STRUCT_0,NAT_1,RLVECT_1,ALGSTR_0,VECTSP_1,BINOP_1,LATTICES,POLYNOM1,ALGSEQ_1,POLYNOM3,POLYNOM2,VECTSP_2,MESFUNC1,AFINSQ_1,FUNCT_4,CQC_LANG,CFCONT_1,FUNCOP_1,VALUED_1,FUNCT_2,SEQ_4,XXREAL_2,COMSEQ_1,VALUED_0,SEQ_2,ORDINAL2,SEQ_1,COMPTRIG,RFINSEQ,POLYNOM5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_2,XREAL_0,COMPLEX1,REAL_1,NAT_1,POWER,BINOP_1,RELAT_1,FUNCT_1,FUNCT_2,PARTFUN1,FUNCOP_1,FINSEQ_1,FINSEQ_4,POLYNOM1,RVSUM_1,STRUCT_0,ALGSTR_0,RLVECT_1,VECTSP_2,VECTSP_1,RFINSEQ,CFCONT_1,VALUED_0,VALUED_1,SEQ_1,SEQ_2,SEQ_4,XXREAL_0,COMSEQ_1,COMSEQ_2,NAT_D,COMPLFLD,HAHNBAN1,ALGSEQ_1,POLYNOM3,POLYNOM4,GROUP_1,FUNCT_7,RECDEF_1,CKB9,CKB17,CKB29,CKB39,CKB58;
definitions TARSKI,ALGSEQ_1,SEQ_4,XBOOLE_0,RVSUM_1,POLYNOM3,HAHNBAN1,STRUCT_0,ALGSTR_0,XCMPLX_0,XXREAL_2,CKB9,CKB17,CKB29,CKB39,CKB58;
theorems XREAL_0,TARSKI,ENUMSET1,NAT_1,POWER,INT_1,ABSVALUE,FUNCT_1,FUNCT_2,FUNCT_7,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FINSEQ_5,FUNCOP_1,TBSP_1,RFINSEQ,PRE_FF,CFCONT_1,TOPREAL3,INTEGRA5,RLVECT_1,VECTSP_1,RVSUM_1,SEQ_2,SEQM_3,SEQ_4,COMSEQ_2,COMSEQ_3,CFUNCT_1,FVSUM_1,GROUP_1,ALGSEQ_1,COMPLEX1,COMPLFLD,HAHNBAN1,POLYNOM1,POLYNOM2,POLYNOM3,POLYNOM4,XBOOLE_0,XCMPLX_1,VECTSP_2,XREAL_1,XXREAL_0,FINSOP_1,NORMSP_1,PARTFUN1,ORDINAL1,VALUED_1,RELAT_1,CARD_1,NAT_D,VALUED_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61;
schemes NAT_1,FUNCT_2,FINSEQ_2,FINSEQ_1,FINSEQ_4,SEQ_1,CFCONT_1,DOMAIN_1,FUNCT_7;
registrations FUNCT_1,ORDINAL1,RELSET_1,FUNCT_2,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,COMSEQ_2,STRUCT_0,GROUP_1,VECTSP_1,COMPLFLD,ALGSTR_1,POLYNOM3,POLYNOM4,VALUED_0,VALUED_1,FUNCOP_1,SEQ_4,CARD_1,CKB18,CKB30,CKB47;
constructors FINSEQ_4,ENUMSET1,REAL_1,SEQ_4,FINSOP_1,COMSEQ_2,RVSUM_1,COMSEQ_3,CFCONT_1,RFINSEQ,NAT_D,FUNCSDOM,VECTSP_2,ALGSTR_1,MATRIX_2,HAHNBAN1,POLYNOM1,POLYNOM4,SEQ_1,RECDEF_1,BINOP_2,SUPINF_1,XXREAL_2,POWER,SEQ_2,RELSET_1,FUNCT_7,FVSUM_1,CKB9,CKB17,CKB29,CKB39,CKB58;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
theorem
Th53: (for L being Field holds (for p,q being (Polynomial of L) holds ((( len p ) <> ( 0 ) & ( len q ) > 1) implies ( len ( Subst (p,q) ) ) = ( ( ( ( ( len p ) * ( len q ) ) - ( len p ) ) - ( len q ) ) + 2 ))))
proof
let L being Field;
let p being (Polynomial of L);
let q being (Polynomial of L);
assume that
A1: ( len p ) <> ( 0 )
and
A2: ( len q ) > 1;
consider F being (FinSequence of (the carrier of ( Polynom-Ring L ))) such that A3: ( Subst (p,q) ) = ( Sum F ) and A4: ( len F ) = ( len p ) and A5: (for n being (Element of ( NAT )) holds (n in ( dom F ) implies ( F . n ) = ( ( p . ( n -' 1 ) ) * ( q `^ ( n -' 1 ) ) ))) by CKB58:def 1;
A6: ( ( 0 ) + 1 ) <= ( len F ) by A1,A4,NAT_1:13;
then A7: 1 in ( dom F ) by FINSEQ_3:25;
reconsider k = ( ( ( ( ( len p ) * ( len q ) ) - ( len p ) ) - ( len q ) ) + 1 ) as (Element of ( NAT )) by A1,A2,CKB1:1,INT_1:3;
( len p ) >= ( ( 0 ) + 1 ) by A1,NAT_1:13;
then A8: ( ( len p ) - 1 ) >= ( 0 ) by XREAL_1:19;
A9: ( len ( q `^ ( ( len F ) -' 1 ) ) ) = ( ( ( ( ( len p ) -' 1 ) * ( len q ) ) - ( ( len p ) -' 1 ) ) + 1 ) by A2,A4,CKB28:1
.= ( ( ( ( ( len p ) -' 1 ) * ( len q ) ) - ( ( len p ) - 1 ) ) + 1 ) by A8,XREAL_0:def 2
.= ( ( ( ( ( len p ) - 1 ) * ( len q ) ) - ( ( len p ) - 1 ) ) + 1 ) by A8,XREAL_0:def 2
.= ( ( ( ( ( len p ) * ( len q ) ) - ( len p ) ) - ( len q ) ) + ( 1 + 1 ) );
A10: ( len ( Subst (p,q) ) ) >= ( ( ( ( ( len p ) * ( len q ) ) - ( len p ) ) - ( len q ) ) + ( 1 + 1 ) )
proof
set lF1 = ( ( len F ) -' 1 );
set F1 = ( F | lF1 );
reconsider sF1 = ( Sum F1 ) as (Polynomial of L) by POLYNOM3:def 10;
A11: ( len F ) = ( lF1 + 1 ) by A6,XREAL_1:235;
then A12: F = ( F1 ^ <* ( F /. ( len F ) ) *> ) by FINSEQ_5:21;
then A13: ( Sum F ) = ( ( Sum F1 ) + ( F /. ( len F ) ) ) by FVSUM_1:71;
A14: ( len F ) = ( ( len F1 ) + 1 ) by A12,FINSEQ_2:16;
assume A15: ( len ( Subst (p,q) ) ) < ( ( ( ( ( len p ) * ( len q ) ) - ( len p ) ) - ( len q ) ) + ( 1 + 1 ) );
then ( len ( Subst (p,q) ) ) < ( k + 1 );
then ( len ( Subst (p,q) ) ) <= k by NAT_1:13;
then A16: ( ( Subst (p,q) ) . k ) = ( 0. L ) by ALGSEQ_1:8;
now
per cases ;
suppose A17: ( len F1 ) <> ( {} );

defpred P[ Nat ]
 means
(for F2 being (Polynomial of L) holds (F2 = ( Sum ( F1 | $1 ) ) implies ( len F2 ) <= ( ( ( ( $1 * ( len q ) ) - ( len q ) ) - $1 ) + 2 )));
A18: ( F1 | ( len F1 ) ) = F1 by FINSEQ_1:58;
A19: (for n being non  empty Nat holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
let n being non  empty Nat;
assume A20: (for F2 being (Polynomial of L) holds (F2 = ( Sum ( F1 | n ) ) implies ( len F2 ) <= ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 2 )));
( len q ) >= ( ( 0 ) + ( 1 + 1 ) ) by A2,NAT_1:13;
then ( ( len q ) - 2 ) >= ( 0 ) by XREAL_1:19;
then ( ( ( ( n * ( len q ) ) - n ) + 1 ) + ( 0 ) ) <= ( ( ( ( n * ( len q ) ) - n ) + 1 ) + ( ( len q ) - 2 ) ) by XREAL_1:7;
then (( ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 2 ) + ( 0 ) ) <= ( ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 2 ) + 1 ) & ( ( ( ( n * ( len q ) ) - n ) + 1 ) - ( ( len q ) - 2 ) ) <= ( ( ( n * ( len q ) ) - n ) + 1 )) by XREAL_1:6,XREAL_1:20;
then A21: ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 2 ) <= ( ( ( n * ( len q ) ) - n ) + 1 ) by XXREAL_0:2;
reconsider F3 = ( Sum ( F1 | n ) ) as (Polynomial of L) by POLYNOM3:def 10;
let F2 being (Polynomial of L);
assume A22: F2 = ( Sum ( F1 | ( n + 1 ) ) );
( len F3 ) <= ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 2 ) by A20;
then A23: ( len F3 ) <= ( ( ( n * ( len q ) ) - n ) + 1 ) by A21,XXREAL_0:2;
now
per cases ;
suppose A24: ( n + 1 ) <= ( len F1 );

reconsider nn = n as (Element of ( NAT )) by ORDINAL1:def 12;
A25: ( n + 1 ) >= 1 by NAT_1:11;
reconsider maxFq = ( max (( len F3 ),( len ( ( p . nn ) * ( q `^ nn ) ) )) ) as (Element of ( NAT )) by FINSEQ_2:1;
A26: (maxFq >= ( len F3 ) & maxFq >= ( len ( ( p . nn ) * ( q `^ nn ) ) )) by XXREAL_0:25;
( len ( ( p . nn ) * ( q `^ nn ) ) ) <= ( ( ( n * ( len q ) ) - n ) + 1 )
proof
per cases ;
suppose ( p . n ) <> ( 0. L );

then ( len ( ( p . nn ) * ( q `^ nn ) ) ) = ( len ( q `^ nn ) ) by CKB32:1;
hence thesis by A2,CKB28:1;
end;
suppose A27: ( p . n ) = ( 0. L );

( len q ) >= ( ( 0 ) + 1 ) by A2;
then ( ( len q ) - 1 ) >= ( 0 ) by XREAL_1:19;
then A28: ( n * ( ( len q ) - 1 ) ) >= ( 0 );
( n * ( len q ) ) <= ( ( n * ( len q ) ) + 1 ) by NAT_1:11;
then ( ( n * ( len q ) ) - n ) <= ( ( ( n * ( len q ) ) + 1 ) - n ) by XREAL_1:9;
hence thesis by A27,A28,CKB31:1;
end;
end;
then A29: maxFq <= ( ( ( n * ( len q ) ) - n ) + 1 ) by A23,XXREAL_0:28;
( len F1 ) <= ( len F ) by A14,NAT_1:11;
then ( n + 1 ) <= ( len F ) by A24,XXREAL_0:2;
then A30: ( n + 1 ) in ( dom F ) by A25,FINSEQ_3:25;
A31: ( n + 1 ) in ( dom F1 ) by A24,A25,FINSEQ_3:25;
then A32: ( F1 /. ( n + 1 ) ) = ( F1 . ( n + 1 ) ) by PARTFUN1:def 6
.= ( F . ( n + 1 ) ) by A12,A31,FINSEQ_1:def 7
.= ( ( p . ( ( n + 1 ) -' 1 ) ) * ( q `^ ( ( n + 1 ) -' 1 ) ) ) by A5,A30
.= ( ( p . nn ) * ( q `^ ( ( n + 1 ) -' 1 ) ) ) by NAT_D:34
.= ( ( p . nn ) * ( q `^ nn ) ) by NAT_D:34;
( F1 | ( nn + 1 ) ) = ( ( F1 | nn ) ^ <* ( F1 /. ( nn + 1 ) ) *> ) by A24,FINSEQ_5:82;
then F2 = ( ( Sum ( F1 | n ) ) + ( F1 /. ( n + 1 ) ) ) by A22,FVSUM_1:71
.= ( F3 + ( ( p . nn ) * ( q `^ nn ) ) ) by A32,POLYNOM3:def 10;
then ( len F2 ) <= maxFq by A26,POLYNOM4:6;
hence ( len F2 ) <= ( ( ( ( ( n + 1 ) * ( len q ) ) - ( len q ) ) - ( n + 1 ) ) + 2 ) by A29,XXREAL_0:2;
end;
suppose A33: ( n + 1 ) > ( len F1 );

( - ( len q ) ) <= ( - 1 ) by A2,XREAL_1:24;
then ( ( ( n * ( len q ) ) - n ) + ( - ( len q ) ) ) <= ( ( ( n * ( len q ) ) - n ) + ( - 1 ) ) by XREAL_1:6;
then A34: ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 2 ) <= ( ( ( ( ( n + 1 ) * ( len q ) ) - ( len q ) ) - ( n + 1 ) ) + 2 ) by XREAL_1:6;
n >= ( len F1 ) by A33,NAT_1:13;
then A35: ( F1 | n ) = F1 by FINSEQ_1:58;
( F1 | ( n + 1 ) ) = F1 by A33,FINSEQ_1:58;
then ( len F2 ) <= ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 2 ) by A20,A22,A35;
hence ( len F2 ) <= ( ( ( ( ( n + 1 ) * ( len q ) ) - ( len q ) ) - ( n + 1 ) ) + 2 ) by A34,XXREAL_0:2;
end;
end;
hence ( len F2 ) <= ( ( ( ( ( n + 1 ) * ( len q ) ) - ( len q ) ) - ( n + 1 ) ) + 2 );
end;
( ( 0 ) + ( len q ) ) >= ( 1 + 1 ) by A2,NAT_1:13;
then ( 2 - ( len q ) ) <= ( 0 ) by XREAL_1:20;
then A36: ( ( 2 - ( len q ) ) + k ) <= ( ( 0 ) + k ) by XREAL_1:6;
( ( 0 ) + 1 ) <= ( len F1 ) by A17,NAT_1:13;
then A37: 1 in ( dom F1 ) by FINSEQ_3:25;
A38: P[ 1 ]
proof
let F2 being (Polynomial of L);
( F1 | 1 ) = <* ( F1 /. 1 ) *> by A17,CARD_1:27,FINSEQ_5:20;
then A39: ( Sum ( F1 | 1 ) ) = ( F1 /. 1 ) by RLVECT_1:44
.= ( F1 . 1 ) by A37,PARTFUN1:def 6
.= ( F . 1 ) by A12,A37,FINSEQ_1:def 7
.= ( ( p . ( 1 -' 1 ) ) * ( q `^ ( 1 -' 1 ) ) ) by A5,A7
.= ( ( p . ( 0 ) ) * ( q `^ ( 1 -' 1 ) ) ) by XREAL_1:232
.= ( ( p . ( 0 ) ) * ( q `^ ( 0 ) ) ) by XREAL_1:232
.= ( ( p . ( 0 ) ) * ( 1_. L ) ) by CKB19:1
.= <% ( p . ( 0 ) ) %> by CKB36:1;
assume F2 = ( Sum ( F1 | 1 ) );
hence ( len F2 ) <= ( ( ( ( 1 * ( len q ) ) - ( len q ) ) - 1 ) + 2 ) by A39,ALGSEQ_1:def 5;
end;
(for n being non  empty Nat holds P[ n ]) from NAT_1:sch 10(A38,A19);
then ( len sF1 ) <= ( ( ( ( ( len F1 ) * ( len q ) ) - ( len q ) ) - ( len F1 ) ) + 2 ) by A17,A18;
then A40: ( sF1 . k ) = ( 0. L ) by A4,A14,A36,ALGSEQ_1:8,XXREAL_0:2;
A41: ( len F ) in ( dom F ) by A6,FINSEQ_3:25;
then ( F /. ( len F ) ) = ( F . ( len F ) ) by PARTFUN1:def 6
.= ( ( p . lF1 ) * ( q `^ lF1 ) ) by A5,A41;
then ( Subst (p,q) ) = ( sF1 + ( ( p . lF1 ) * ( q `^ lF1 ) ) ) by A3,A13,POLYNOM3:def 10;
then A42: ( ( Subst (p,q) ) . k ) = ( ( sF1 . k ) + ( ( ( p . lF1 ) * ( q `^ lF1 ) ) . k ) ) by NORMSP_1:def 2
.= ( ( ( p . lF1 ) * ( q `^ lF1 ) ) . k ) by A40,RLVECT_1:def 4
.= ( ( p . lF1 ) * ( ( q `^ lF1 ) . k ) ) by CKB29:def 1;
( len ( q `^ lF1 ) ) = ( k + 1 ) by A9;
then A43: ( ( q `^ lF1 ) . k ) <> ( 0. L ) by ALGSEQ_1:10;
( p . lF1 ) <> ( 0. L ) by A4,A11,ALGSEQ_1:10;
hence contradiction by A16,A42,A43,VECTSP_1:12;
end;
suppose A44: ( len F1 ) = ( {} );

A45: ( F /. 1 ) = ( F . 1 ) by A7,PARTFUN1:def 6
.= ( ( p . ( 1 -' 1 ) ) * ( q `^ ( 1 -' 1 ) ) ) by A5,A7
.= ( ( p . ( 0 ) ) * ( q `^ ( 1 -' 1 ) ) ) by XREAL_1:232
.= ( ( p . ( 0 ) ) * ( q `^ ( 0 ) ) ) by XREAL_1:232
.= ( ( p . ( 0 ) ) * ( 1_. L ) ) by CKB19:1
.= <% ( p . ( 0 ) ) %> by CKB36:1;
A46: ( 0. ( Polynom-Ring L ) ) = ( 0_. L ) by POLYNOM3:def 10;
A47: ( len F ) = ( ( 0 ) + 1 ) by A12,A44,FINSEQ_2:16;
then A48: ( p . ( 0 ) ) <> ( 0. L ) by A4,ALGSEQ_1:10;
F1 = ( <*> (the carrier of ( Polynom-Ring L )) ) by A44;
then ( Sum F ) = ( ( 0. ( Polynom-Ring L ) ) + ( F /. 1 ) ) by A13,A47,RLVECT_1:43
.= ( ( 0_. L ) + <% ( p . ( 0 ) ) %> ) by A45,A46,POLYNOM3:def 10
.= <% ( p . ( 0 ) ) %> by POLYNOM3:28;
hence contradiction by A3,A4,A15,A47,A48,CKB41:1;
end;
end;
hence contradiction;
end;
defpred P[ Nat ]
 means
(for F1 being (Polynomial of L) holds (F1 = ( Sum ( F | $1 ) ) implies ( len F1 ) <= ( len ( q `^ ( $1 -' 1 ) ) )));
A49: (for n being non  empty Nat holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
let n being non  empty Nat;
assume A50: (for F1 being (Polynomial of L) holds (F1 = ( Sum ( F | n ) ) implies ( len F1 ) <= ( len ( q `^ ( n -' 1 ) ) )));
reconsider nn = n as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider F2 = ( Sum ( F | n ) ) as (Polynomial of L) by POLYNOM3:def 10;
let F1 being (Polynomial of L);
assume A51: F1 = ( Sum ( F | ( n + 1 ) ) );
( ( n * ( len q ) ) + ( ( len q ) -' 1 ) ) >= ( n * ( len q ) ) by NAT_1:11;
then A52: ( ( n * ( len q ) ) - ( ( len q ) -' 1 ) ) <= ( n * ( len q ) ) by XREAL_1:20;
( len q ) >= ( ( 0 ) + 1 ) by A2;
then ( ( len q ) - 1 ) >= ( 0 ) by XREAL_1:19;
then ( ( n * ( len q ) ) - ( ( len q ) - 1 ) ) <= ( n * ( len q ) ) by A52,XREAL_0:def 2;
then ( ( ( ( n * ( len q ) ) - ( len q ) ) + 1 ) - n ) <= ( ( n * ( len q ) ) - n ) by XREAL_1:9;
then A53: ( ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 1 ) + 1 ) <= ( ( ( n * ( len q ) ) - n ) + 1 ) by XREAL_1:6;
n >= ( ( 0 ) + 1 ) by NAT_1:13;
then A54: ( n - 1 ) >= ( 0 ) by XREAL_1:19;
( len ( q `^ ( n -' 1 ) ) ) = ( ( ( ( n -' 1 ) * ( len q ) ) - ( n -' 1 ) ) + 1 ) by A2,CKB28:1
.= ( ( ( ( n - 1 ) * ( len q ) ) - ( n -' 1 ) ) + 1 ) by A54,XREAL_0:def 2
.= ( ( ( ( n * ( len q ) ) - ( 1 * ( len q ) ) ) - ( n - 1 ) ) + 1 ) by A54,XREAL_0:def 2
.= ( ( ( ( ( n * ( len q ) ) - ( len q ) ) - n ) + 1 ) + 1 );
then A55: ( len ( q `^ ( n -' 1 ) ) ) <= ( len ( q `^ nn ) ) by A2,A53,CKB28:1;
per cases ;
suppose A56: ( n + 1 ) <= ( len F );

reconsider maxFq = ( max (( len F2 ),( len ( ( p . nn ) * ( q `^ nn ) ) )) ) as (Element of ( NAT )) by FINSEQ_2:1;
A57: ( len ( ( p . nn ) * ( q `^ nn ) ) ) <= ( len ( q `^ nn ) )
proof
per cases ;
suppose ( p . n ) <> ( 0. L );

hence thesis by CKB32:1;
end;
suppose ( p . n ) = ( 0. L );

hence thesis by CKB31:1;
end;
end;
( len F2 ) <= ( len ( q `^ ( n -' 1 ) ) ) by A50;
then ( len F2 ) <= ( len ( q `^ nn ) ) by A55,XXREAL_0:2;
then A58: maxFq <= ( len ( q `^ nn ) ) by A57,XXREAL_0:28;
( F | ( n + 1 ) ) = ( ( F | n ) ^ <* ( F /. ( nn + 1 ) ) *> ) by A56,FINSEQ_5:82;
then A59: F1 = ( ( Sum ( F | n ) ) + ( F /. ( n + 1 ) ) ) by A51,FVSUM_1:71;
( n + 1 ) >= 1 by NAT_1:11;
then A60: ( n + 1 ) in ( dom F ) by A56,FINSEQ_3:25;
then ( F /. ( n + 1 ) ) = ( F . ( n + 1 ) ) by PARTFUN1:def 6
.= ( ( p . ( ( n + 1 ) -' 1 ) ) * ( q `^ ( ( n + 1 ) -' 1 ) ) ) by A5,A60
.= ( ( p . nn ) * ( q `^ ( ( n + 1 ) -' 1 ) ) ) by NAT_D:34
.= ( ( p . nn ) * ( q `^ nn ) ) by NAT_D:34;
then A61: F1 = ( F2 + ( ( p . nn ) * ( q `^ nn ) ) ) by A59,POLYNOM3:def 10;
(maxFq >= ( len F2 ) & maxFq >= ( len ( ( p . nn ) * ( q `^ nn ) ) )) by XXREAL_0:25;
then ( len F1 ) <= maxFq by A61,POLYNOM4:6;
then ( len F1 ) <= ( len ( q `^ nn ) ) by A58,XXREAL_0:2;
hence thesis by NAT_D:34;
end;
suppose A62: ( n + 1 ) > ( len F );

then n >= ( len F ) by NAT_1:13;
then A63: ( F | n ) = F by FINSEQ_1:58;
( F | ( n + 1 ) ) = F by A62,FINSEQ_1:58;
then ( len F1 ) <= ( len ( q `^ ( n -' 1 ) ) ) by A50,A51,A63;
then ( len F1 ) <= ( len ( q `^ nn ) ) by A55,XXREAL_0:2;
hence thesis by NAT_D:34;
end;
end;
A64: ( F | ( len F ) ) = F by FINSEQ_1:58;
A65: P[ 1 ]
proof
let F1 being (Polynomial of L);
( F | 1 ) = <* ( F /. 1 ) *> by A1,A4,CARD_1:27,FINSEQ_5:20;
then A66: ( Sum ( F | 1 ) ) = ( F /. 1 ) by RLVECT_1:44
.= ( F . 1 ) by A7,PARTFUN1:def 6
.= ( ( p . ( 1 -' 1 ) ) * ( q `^ ( 1 -' 1 ) ) ) by A5,A7
.= ( ( p . ( 0 ) ) * ( q `^ ( 1 -' 1 ) ) ) by XREAL_1:232
.= ( ( p . ( 0 ) ) * ( q `^ ( 0 ) ) ) by XREAL_1:232
.= ( ( p . ( 0 ) ) * ( 1_. L ) ) by CKB19:1
.= <% ( p . ( 0 ) ) %> by CKB36:1;
assume F1 = ( Sum ( F | 1 ) );
then ( len F1 ) <= 1 by A66,ALGSEQ_1:def 5;
then ( len F1 ) <= ( len ( 1_. L ) ) by POLYNOM4:4;
then ( len F1 ) <= ( len ( q `^ ( 0 ) ) ) by CKB19:1;
hence thesis by XREAL_1:232;
end;
(for n being non  empty Nat holds P[ n ]) from NAT_1:sch 10(A65,A49);
then ( len ( Subst (p,q) ) ) <= ( len ( q `^ ( ( len F ) -' 1 ) ) ) by A1,A3,A4,A64;
hence thesis by A9,A10,XXREAL_0:1;
end;
