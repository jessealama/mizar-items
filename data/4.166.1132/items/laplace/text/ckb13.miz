environ
vocabularies NUMBERS,SUBSET_1,NAT_1,XBOOLE_0,MATRIX11,FINSEQ_1,ARYTM_3,MATRIX_2,VECTSP_1,MATRIX_1,RELAT_1,FINSEQ_3,ARYTM_1,TREES_1,CARD_1,XXREAL_0,FUNCT_1,INCSP_1,TARSKI,ALGSTR_0,ZFMISC_1,STRUCT_0,REALSET1,SETWOP_2,FUNCT_2,FINSUB_1,GROUP_1,SETWISEO,INT_1,FINSET_1,ABIAN,FINSEQ_2,BINOP_1,QC_LANG1,AFINSQ_1,ABSVALUE,MATRIX_3,SUPINF_2,CARD_3,FINSOP_1,RVSUM_1,FVSUM_1,MESFUNC1,MATRIX_6,LAPLACE;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,FINSET_1,RELAT_1,RELSET_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,BINOP_1,STRUCT_0,ALGSTR_0,GROUP_1,VECTSP_1,SETWISEO,SETWOP_2,FINSEQ_2,MATRIX_1,FINSUB_1,MATRIX_2,NAT_1,FVSUM_1,FINSOP_1,MATRIX_3,CARD_1,FINSEQ_7,NEWTON,MATRIX_7,FINSEQ_3,MATRIX11,MATRIX_6,NAT_D,CKB6;
definitions FINSEQ_2,FINSEQ_1,TARSKI,MATRIX_1,MATRIX_3,FVSUM_1,MATRIX_2,MATRIX_7,MATRIX11,RELAT_1,ALGSTR_0;
theorems FINSEQ_1,FINSEQ_2,TARSKI,FUNCT_2,NAT_1,FUNCT_1,SETWISEO,VECTSP_1,ZFMISC_1,FVSUM_1,SETWOP_2,MATRIX_1,MATRIX_2,FINSUB_1,FINSEQ_3,RELAT_1,FINSOP_1,XBOOLE_0,XBOOLE_1,MATRIX_3,XREAL_1,MATRIX_7,ORDINAL1,CARD_1,CARD_2,MATRIX_9,STIRL2_1,SGRAPH1,CARD_FIN,HURWITZ,NEWTON,COMPUT_1,MATRIX11,GROUP_1,MATRIX_4,MATRIX_6,MATRIXR1,NAT_D,XXREAL_0,MATRIXR2,XREAL_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12;
schemes FUNCT_2,NAT_1,FINSEQ_1,FUNCT_1,SETWISEO,MATRIX_1;
registrations FUNCT_1,FINSUB_1,FINSET_1,STRUCT_0,FVSUM_1,MATRIX_2,VECTSP_1,FUNCT_2,PARTFUN1,XBOOLE_0,ORDINAL1,XXREAL_0,NAT_1,INT_1,RELAT_1,CARD_1,MATRIX11,XCMPLX_0,RELSET_1,FINSEQ_2,FINSEQ_1;
constructors RELAT_2,SETWISEO,FINSOP_1,SETWOP_2,ALGSTR_1,FVSUM_1,BINOP_1,XXREAL_0,FINSEQ_4,FINSEQ_7,WELLORD2,NEWTON,MATRIX_6,MATRIX_7,MATRIX11,NAT_D,BINOP_2,RELSET_1,CKB6;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve D for non  empty set;
reserve K for Field;
reserve a for (Element of K);
reserve f for (FinSequence of K);
reserve A for (Matrix of K);
theorem
Th12: (for X,Y,D being non  empty set holds (for f being (Function of X,( Fin Y )) holds (for g being (Function of ( Fin Y ),D) holds (for F being (BinOp of D) holds (((((for A,B being (Element of ( Fin Y )) holds (A misses B implies ( F . (( g . A ),( g . B )) ) = ( g . ( A \/ B ) ))) & F is  commutative  associative) & F is  having_a_unity) & ( g . ( {} ) ) = ( the_unity_wrt F )) implies (for I being (Element of ( Fin X )) holds ((for x holds (for y holds (((x in I & y in I) & ( f . x ) meets ( f . y )) implies x = y))) implies ((( F $$ (I,( g * f )) ) = ( F $$ (( f .: I ),g) ) & ( F $$ (( f .: I ),g) ) = ( g . ( union ( f .: I ) ) )) & ( union ( f .: I ) ) is (Element of ( Fin Y ))))))))))
proof
let X being non  empty set;
let Y being non  empty set;
let D being non  empty set;
let f being (Function of X,( Fin Y ));
let g being (Function of ( Fin Y ),D);
let F being (BinOp of D);
assume that
A1: (for A,B being (Element of ( Fin Y )) holds (A misses B implies ( F . (( g . A ),( g . B )) ) = ( g . ( A \/ B ) )))
and
A2: F is  commutative  associative
and
A3: F is  having_a_unity
and
A4: ( g . ( {} ) ) = ( the_unity_wrt F );
defpred P[ set ]
 means
(for I being (Element of ( Fin X )) holds ((I = $1 & (for x holds (for y holds (((x in I & y in I) & ( f . x ) meets ( f . y )) implies x = y)))) implies ((( F $$ (I,( g * f )) ) = ( F $$ (( f .: I ),g) ) & ( F $$ (( f .: I ),g) ) = ( g . ( union ( f .: I ) ) )) & ( union ( f .: I ) ) is (Element of ( Fin Y )))));
A5: (for I being (Element of ( Fin X )) holds (for i being (Element of X) holds ((P[ I ] & (not i in I)) implies P[ ( I \/ { i } ) ])))
proof
let A being (Element of ( Fin X ));
let a being (Element of X);
assume that
A6: P[ A ]
and
A7: (not a in A);
let I being (Element of ( Fin X ));
assume that
A8: ( A \/ { a } ) = I
and
A9: (for x holds (for y holds (((x in I & y in I) & ( f . x ) meets ( f . y )) implies x = y)));
A10: (for x holds (for y holds (((x in A & y in A) & ( f . x ) meets ( f . y )) implies x = y)))
proof
let x;
let y;
assume that
A11: x in A
and
A12: y in A
and
A13: ( f . x ) meets ( f . y );
A c= I by A8,XBOOLE_1:7;
hence thesis by A9,A11,A12,A13;
end;
then A14: ( F $$ (A,( g * f )) ) = ( F $$ (( f .: A ),g) ) by A6;
A15: ( union ( f .: A ) ) is (Element of ( Fin Y )) by A6,A10;
( dom f ) = X by FUNCT_2:def 1;
then ( Im (f,a) ) = { ( f . a ) } by FUNCT_1:59;
then A16: ( f .: I ) = ( ( f .: A ) \/ { ( f . a ) } ) by A8,RELAT_1:120;
A17: ( F $$ (( f .: A ),g) ) = ( g . ( union ( f .: A ) ) ) by A6,A10;
( dom ( g * f ) ) = X by FUNCT_2:def 1;
then A18: ( g . ( f . a ) ) = ( ( g * f ) . a ) by FUNCT_1:12;
per cases ;
suppose A19: (( f . a ) is non  empty or (not ( f . a ) in ( f .: A )));

(not ( f . a ) in ( f .: A ))
proof
A20: A c= I by A8,XBOOLE_1:7;
A21: { a } c= I by A8,XBOOLE_1:7;
A22: a in { a } by TARSKI:def 1;
assume A23: ( f . a ) in ( f .: A );
then consider x such that x in ( dom f ) and A24: x in A and A25: ( f . x ) = ( f . a ) by FUNCT_1:def 6;
( f . x ) meets ( f . a ) by A19,A23,A25,XBOOLE_1:66;
hence thesis by A7,A9,A24,A22,A21,A20;
end;
then A26: ( F $$ (( f .: I ),g) ) = ( F . (( F $$ (( f .: A ),g) ),( ( g * f ) . a )) ) by A2,A3,A16,A18,SETWOP_2:2;
A27: ( f . a ) c= Y by FINSUB_1:def 5;
( union ( f .: A ) ) c= Y by A15,FINSUB_1:def 5;
then A28: ( ( union ( f .: A ) ) \/ ( f . a ) ) c= Y by A27,XBOOLE_1:8;
now
let x;
assume x in ( f .: A );
then A29: (ex y st ((y in ( dom f ) & y in A) & ( f . y ) = x)) by FUNCT_1:def 6;
A30: a in { a } by TARSKI:def 1;
A31: A c= I by A8,XBOOLE_1:7;
A32: { a } c= I by A8,XBOOLE_1:7;
assume x meets ( f . a );
hence contradiction by A7,A9,A29,A30,A32,A31;
end;
then A33: ( union ( f .: A ) ) misses ( f . a ) by ZFMISC_1:80;
( union ( f .: I ) ) = ( ( union ( f .: A ) ) \/ ( union { ( f . a ) } ) ) by A16,ZFMISC_1:78
.= ( ( union ( f .: A ) ) \/ ( f . a ) ) by ZFMISC_1:25;
hence thesis by A1,A2,A3,A7,A8,A14,A17,A15,A18,A26,A28,A33,FINSUB_1:def 5,SETWOP_2:2;
end;
suppose A34: (( f . a ) is  empty & ( f . a ) in ( f .: A ));

then A35: ( ( f .: A ) \/ { ( f . a ) } ) = ( f .: A ) by ZFMISC_1:40;
( F $$ (I,( g * f )) ) = ( F . (( F $$ (( f .: A ),g) ),( the_unity_wrt F )) ) by A2,A3,A4,A7,A8,A14,A18,A34,SETWOP_2:2
.= ( F $$ (( f .: I ),g) ) by A3,A16,A35,SETWISEO:15;
hence thesis by A6,A10,A16,A35;
end;
end;
A36: P[ ( {}. X ) ]
proof
A37: ( {} ) c= Y by XBOOLE_1:2;
let I being (Element of ( Fin X ));
assume that
A38: ( {}. X ) = I
and
(for x holds (for y holds (((x in I & y in I) & ( f . x ) meets ( f . y )) implies x = y)));
A39: ( f .: I ) = ( {}. ( Fin Y ) ) by A38,RELAT_1:116;
( F $$ (I,( g * f )) ) = ( g . ( {} ) ) by A2,A3,A4,A38,SETWISEO:31;
hence thesis by A2,A3,A4,A39,A37,FINSUB_1:def 5,SETWISEO:31,ZFMISC_1:2;
end;
(for I being (Element of ( Fin X )) holds P[ I ]) from SETWISEO:sch 2(A36,A5);
hence thesis;
end;
