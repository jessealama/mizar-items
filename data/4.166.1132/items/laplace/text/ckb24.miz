environ
vocabularies NUMBERS,SUBSET_1,NAT_1,XBOOLE_0,MATRIX11,FINSEQ_1,ARYTM_3,MATRIX_2,VECTSP_1,MATRIX_1,RELAT_1,FINSEQ_3,ARYTM_1,TREES_1,CARD_1,XXREAL_0,FUNCT_1,INCSP_1,TARSKI,ALGSTR_0,ZFMISC_1,STRUCT_0,REALSET1,SETWOP_2,FUNCT_2,FINSUB_1,GROUP_1,SETWISEO,INT_1,FINSET_1,ABIAN,FINSEQ_2,BINOP_1,QC_LANG1,AFINSQ_1,ABSVALUE,MATRIX_3,SUPINF_2,CARD_3,FINSOP_1,RVSUM_1,FVSUM_1,MESFUNC1,MATRIX_6,LAPLACE;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,FINSET_1,RELAT_1,RELSET_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,BINOP_1,STRUCT_0,ALGSTR_0,GROUP_1,VECTSP_1,SETWISEO,SETWOP_2,FINSEQ_2,MATRIX_1,FINSUB_1,MATRIX_2,NAT_1,FVSUM_1,FINSOP_1,MATRIX_3,CARD_1,FINSEQ_7,NEWTON,MATRIX_7,FINSEQ_3,MATRIX11,MATRIX_6,NAT_D,CKB6,CKB14,CKB18,CKB19;
definitions FINSEQ_2,FINSEQ_1,TARSKI,MATRIX_1,MATRIX_3,FVSUM_1,MATRIX_2,MATRIX_7,MATRIX11,RELAT_1,ALGSTR_0,CKB14,CKB18;
theorems FINSEQ_1,FINSEQ_2,TARSKI,FUNCT_2,NAT_1,FUNCT_1,SETWISEO,VECTSP_1,ZFMISC_1,FVSUM_1,SETWOP_2,MATRIX_1,MATRIX_2,FINSUB_1,FINSEQ_3,RELAT_1,FINSOP_1,XBOOLE_0,XBOOLE_1,MATRIX_3,XREAL_1,MATRIX_7,ORDINAL1,CARD_1,CARD_2,MATRIX_9,STIRL2_1,SGRAPH1,CARD_FIN,HURWITZ,NEWTON,COMPUT_1,MATRIX11,GROUP_1,MATRIX_4,MATRIX_6,MATRIXR1,NAT_D,XXREAL_0,MATRIXR2,XREAL_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB20,CKB21,CKB22,CKB23;
schemes FUNCT_2,NAT_1,FINSEQ_1,FUNCT_1,SETWISEO,MATRIX_1;
registrations FUNCT_1,FINSUB_1,FINSET_1,STRUCT_0,FVSUM_1,MATRIX_2,VECTSP_1,FUNCT_2,PARTFUN1,XBOOLE_0,ORDINAL1,XXREAL_0,NAT_1,INT_1,RELAT_1,CARD_1,MATRIX11,XCMPLX_0,RELSET_1,FINSEQ_2,FINSEQ_1;
constructors RELAT_2,SETWISEO,FINSOP_1,SETWOP_2,ALGSTR_1,FVSUM_1,BINOP_1,XXREAL_0,FINSEQ_4,FINSEQ_7,WELLORD2,NEWTON,MATRIX_6,MATRIX_7,MATRIX11,NAT_D,BINOP_2,RELSET_1,CKB6,CKB14,CKB18;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve i for Nat;
reserve k for Nat;
reserve n for Nat;
reserve q1 for (Element of ( Permutations ( n + 1 ) ));
definition
let i;
let n;
let perm being (Element of ( Permutations ( n + 1 ) ));
assume A1: i in ( Seg ( n + 1 ) );
func Rem (perm,i) -> (Element of ( Permutations n )) means 
:Def3: (for k holds (k in ( Seg n ) implies ((k < i implies ((( perm . k ) < ( perm . i ) implies ( it . k ) = ( perm . k )) & (( perm . k ) >= ( perm . i ) implies ( it . k ) = ( ( perm . k ) - 1 )))) & (k >= i implies ((( perm . ( k + 1 ) ) < ( perm . i ) implies ( it . k ) = ( perm . ( k + 1 ) )) & (( perm . ( k + 1 ) ) >= ( perm . i ) implies ( it . k ) = ( ( perm . ( k + 1 ) ) - 1 )))))));
existence
proof
set j = ( perm . i );
set P = ( Permutations n );
set p = perm;
set n1 = ( n + 1 );
reconsider N = n as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider p9 = p as (Permutation of ( Seg n1 )) by MATRIX_2:def 9;
A2: ( dom p9 ) = ( Seg n1 ) by FUNCT_2:52;
defpred Q[ set,set ]
 means
(for k holds ((k in ( Seg n ) & $1 = k) implies ((k < i implies ((( p . k ) < j implies $2 = ( p . k )) & (( p . k ) >= j implies $2 = ( ( p . k ) - 1 )))) & (k >= i implies ((( p . ( k + 1 ) ) < j implies $2 = ( p . ( k + 1 ) )) & (( p . ( k + 1 ) ) >= j implies $2 = ( ( p . ( k + 1 ) ) - 1 )))))));
A3: ( rng p9 ) = ( Seg n1 ) by FUNCT_2:def 3;
then A4: j in ( Seg n1 ) by A1,A2,FUNCT_1:def 3;
A5: (for k9 being set holds (k9 in ( Seg n ) implies (ex y st (y in ( Seg n ) & Q[ k9,y ]))))
proof
let k9 being set;
assume k9 in ( Seg n );
then consider k being (Element of ( NAT )) such that A6: k9 = k and A7: 1 <= k and A8: k <= n;
A9: k < n1 by A8,NAT_1:13;
then A10: k in ( Seg n1 ) by A7;
then A11: ( p . k ) in ( Seg n1 ) by A2,A3,FUNCT_1:def 3;
set k1 = ( k + 1 );
A12: ( 1 + ( 0 ) ) <= ( k + 1 ) by NAT_1:13;
( k + 1 ) <= n1 by A9,NAT_1:13;
then A13: ( k + 1 ) in ( Seg n1 ) by A12;
then A14: ( p . ( k + 1 ) ) in ( Seg n1 ) by A2,A3,FUNCT_1:def 3;
per cases ;
suppose A15: (k < i & ( p . k ) < j);

j <= n1 by A4,FINSEQ_1:1;
then ( p . k ) < n1 by A15,XXREAL_0:2;
then A16: ( p . k ) <= n by NAT_1:13;
A17: Q[ k9,( p . k ) ] by A6,A15;
1 <= ( p . k ) by A11,FINSEQ_1:1;
then ( p . k ) in ( Seg n ) by A16,FINSEQ_1:1;
hence thesis by A17;
end;
suppose A18: (k < i & ( p . k ) >= j);

then ( p9 . k ) <> ( p9 . i ) by A1,A10,FUNCT_2:19;
then A19: ( p . k ) > j by A18,XXREAL_0:1;
then reconsider pk1 = ( ( p . k ) - 1 ) as (Element of ( NAT )) by NAT_1:20;
A20: Q[ k9,pk1 ] by A6,A18;
A21: pk1 < ( pk1 + 1 ) by NAT_1:13;
( p . k ) <= n1 by A11,FINSEQ_1:1;
then pk1 < n1 by A21,XXREAL_0:2;
then A22: pk1 <= n by NAT_1:13;
j >= 1 by A4,FINSEQ_1:1;
then ( pk1 + 1 ) > 1 by A19,XXREAL_0:2;
then pk1 >= 1 by NAT_1:13;
then pk1 in ( Seg n ) by A22;
hence thesis by A20;
end;
suppose A23: (k >= i & ( p . k1 ) < j);

j <= n1 by A4,FINSEQ_1:1;
then ( p . k1 ) < n1 by A23,XXREAL_0:2;
then A24: ( p . k1 ) <= n by NAT_1:13;
A25: Q[ k9,( p . k1 ) ] by A6,A23;
1 <= ( p . k1 ) by A14,FINSEQ_1:1;
then ( p . k1 ) in ( Seg n ) by A24,FINSEQ_1:1;
hence thesis by A25;
end;
suppose A26: (k >= i & ( p . k1 ) >= j);

then i < k1 by NAT_1:13;
then ( p9 . k1 ) <> ( p9 . i ) by A1,A13,FUNCT_2:19;
then A27: ( p . k1 ) > j by A26,XXREAL_0:1;
then reconsider pk1 = ( ( p . k1 ) - 1 ) as (Element of ( NAT )) by NAT_1:20;
A28: Q[ k9,pk1 ] by A6,A26;
A29: pk1 < ( pk1 + 1 ) by NAT_1:13;
( p . k1 ) <= n1 by A14,FINSEQ_1:1;
then pk1 < n1 by A29,XXREAL_0:2;
then A30: pk1 <= n by NAT_1:13;
j >= 1 by A4,FINSEQ_1:1;
then ( pk1 + 1 ) > 1 by A27,XXREAL_0:2;
then pk1 >= 1 by NAT_1:13;
then pk1 in ( Seg n ) by A30;
hence thesis by A28;
end;
end;
consider q being (Function of ( Seg n ),( Seg n )) such that A31: (for x holds (x in ( Seg n ) implies Q[ x,( q . x ) ])) from FUNCT_2:sch 1(A5);
(for x1,x2 being set holds (((x1 in ( dom q ) & x2 in ( dom q )) & ( q . x1 ) = ( q . x2 )) implies x1 = x2))
proof
let x1 being set;
let x2 being set;
assume that
A32: x1 in ( dom q )
and
A33: x2 in ( dom q )
and
A34: ( q . x1 ) = ( q . x2 );
A35: ( dom q ) = ( Seg n ) by FUNCT_2:52;
then consider k1 being (Element of ( NAT )) such that A36: x1 = k1 and A37: 1 <= k1 and A38: k1 <= n by A32;
A39: ( ( 0 ) + 1 ) <= ( k1 + 1 ) by NAT_1:13;
A40: k1 < ( n + 1 ) by A38,NAT_1:13;
then A41: k1 in ( Seg n1 ) by A37;
( k1 + 1 ) <= ( n + 1 ) by A40,NAT_1:13;
then A42: ( k1 + 1 ) in ( Seg n1 ) by A39;
consider k2 being (Element of ( NAT )) such that A43: x2 = k2 and A44: 1 <= k2 and A45: k2 <= n by A33,A35;
A46: k2 < ( n + 1 ) by A45,NAT_1:13;
then A47: k2 in ( Seg n1 ) by A44;
A48: ( ( 0 ) + 1 ) <= ( k2 + 1 ) by NAT_1:13;
( k2 + 1 ) <= ( n + 1 ) by A46,NAT_1:13;
then A49: ( k2 + 1 ) in ( Seg n1 ) by A48;
per cases ;
suppose A50: (k1 < i & ( p . k1 ) < j);

then A51: ( q . k1 ) = ( p9 . k1 ) by A31,A32,A36;
per cases ;
suppose (k2 < i & ( p . k2 ) < j);

then ( p9 . k2 ) = ( p9 . k1 ) by A31,A33,A34,A36,A43,A51;
hence thesis by A2,A36,A43,A41,A47,FUNCT_1:def 4;
end;
suppose A52: (k2 < i & ( p . k2 ) >= j);

then ( q . k2 ) = ( ( p . k2 ) - 1 ) by A31,A33,A43;
then ( ( p . k1 ) + 1 ) = ( p . k2 ) by A34,A36,A43,A51;
then ( p . k2 ) <= j by A50,NAT_1:13;
then ( p9 . k2 ) = ( p9 . i ) by A52,XXREAL_0:1;
hence thesis by A1,A2,A47,A52,FUNCT_1:def 4;
end;
suppose A53: (k2 >= i & ( p . ( k2 + 1 ) ) < j);

then ( p9 . k1 ) = ( p9 . ( k2 + 1 ) ) by A31,A33,A34,A36,A43,A51;
then k1 = ( k2 + 1 ) by A2,A41,A49,FUNCT_1:def 4;
hence thesis by A50,A53,NAT_1:13;
end;
suppose A54: (k2 >= i & ( p . ( k2 + 1 ) ) >= j);

then ( p . k1 ) = ( ( p . ( k2 + 1 ) ) - 1 ) by A31,A33,A34,A36,A43,A51;
then ( ( p . k1 ) + 1 ) = ( p . ( k2 + 1 ) );
then ( p . ( k2 + 1 ) ) <= j by A50,NAT_1:13;
then ( p9 . ( k2 + 1 ) ) = ( p . i ) by A54,XXREAL_0:1;
then ( k2 + 1 ) = i by A1,A2,A49,FUNCT_1:def 4;
hence thesis by A54,NAT_1:13;
end;
end;
suppose A55: (k1 < i & ( p . k1 ) >= j);

then A56: ( q . k1 ) = ( ( p . k1 ) - 1 ) by A31,A32,A36;
per cases ;
suppose A57: (k2 < i & ( p . k2 ) < j);

then ( q . k2 ) = ( p9 . k2 ) by A31,A33,A43;
then ( p . k1 ) = ( ( p . k2 ) + 1 ) by A34,A36,A43,A56;
then ( p . k1 ) <= j by A57,NAT_1:13;
then ( p . k1 ) = ( p . i ) by A55,XXREAL_0:1;
hence thesis by A1,A2,A41,A55,FUNCT_1:def 4;
end;
suppose (k2 < i & ( p . k2 ) >= j);

then ( ( p . k1 ) - 1 ) = ( ( p . k2 ) - 1 ) by A31,A33,A34,A36,A43,A56;
hence thesis by A2,A36,A43,A41,A47,FUNCT_1:def 4;
end;
suppose A58: (k2 >= i & ( p . ( k2 + 1 ) ) < j);

then ( ( p . k1 ) - 1 ) = ( p . ( k2 + 1 ) ) by A31,A33,A34,A36,A43,A56;
then ( ( p . ( k2 + 1 ) ) + 1 ) = ( p . k1 );
then ( p . k1 ) <= j by A58,NAT_1:13;
then ( p9 . k1 ) = ( p9 . i ) by A55,XXREAL_0:1;
hence thesis by A1,A2,A41,A55,FUNCT_1:def 4;
end;
suppose A59: (k2 >= i & ( p . ( k2 + 1 ) ) >= j);

then ( ( p . k1 ) - 1 ) = ( ( p . ( k2 + 1 ) ) - 1 ) by A31,A33,A34,A36,A43,A56;
then k1 = ( k2 + 1 ) by A2,A41,A49,FUNCT_1:def 4;
hence thesis by A55,A59,NAT_1:13;
end;
end;
suppose A60: (k1 >= i & ( p . ( k1 + 1 ) ) < j);

then A61: ( q . k1 ) = ( p . ( k1 + 1 ) ) by A31,A32,A36;
per cases ;
suppose A62: (k2 < i & ( p . k2 ) < j);

then ( p9 . ( k1 + 1 ) ) = ( p9 . k2 ) by A31,A33,A34,A36,A43,A61;
then ( k1 + 1 ) = k2 by A2,A47,A42,FUNCT_1:def 4;
hence thesis by A60,A62,NAT_1:13;
end;
suppose A63: (k2 < i & ( p . k2 ) >= j);

then ( p . ( k1 + 1 ) ) = ( ( p . k2 ) - 1 ) by A31,A33,A34,A36,A43,A61;
then ( p . k2 ) = ( ( p . ( k1 + 1 ) ) + 1 );
then ( p . k2 ) <= j by A60,NAT_1:13;
then ( p9 . k2 ) = ( p9 . i ) by A63,XXREAL_0:1;
hence thesis by A1,A2,A47,A63,FUNCT_1:def 4;
end;
suppose (k2 >= i & ( p . ( k2 + 1 ) ) < j);

then ( q . k2 ) = ( p . ( k2 + 1 ) ) by A31,A33,A43;
then ( k1 + 1 ) = ( k2 + 1 ) by A2,A34,A36,A43,A42,A49,A61,FUNCT_1:def 4;
hence thesis by A36,A43;
end;
suppose A64: (k2 >= i & ( p . ( k2 + 1 ) ) >= j);

then ( p . ( k1 + 1 ) ) = ( ( p . ( k2 + 1 ) ) - 1 ) by A31,A33,A34,A36,A43,A61;
then ( p . ( k2 + 1 ) ) = ( ( p . ( k1 + 1 ) ) + 1 );
then ( p . ( k2 + 1 ) ) <= j by A60,NAT_1:13;
then ( p9 . ( k2 + 1 ) ) = ( p9 . i ) by A64,XXREAL_0:1;
then ( k2 + 1 ) = i by A1,A2,A49,FUNCT_1:def 4;
hence thesis by A64,NAT_1:13;
end;
end;
suppose A65: (k1 >= i & ( p . ( k1 + 1 ) ) >= j);

then A66: ( q . k1 ) = ( ( p . ( k1 + 1 ) ) - 1 ) by A31,A32,A36;
per cases ;
suppose A67: (k2 < i & ( p . k2 ) < j);

then ( ( p . ( k1 + 1 ) ) - 1 ) = ( p . k2 ) by A31,A33,A34,A36,A43,A66;
then ( p . ( k1 + 1 ) ) = ( ( p . k2 ) + 1 );
then ( p . ( k1 + 1 ) ) <= j by A67,NAT_1:13;
then ( p9 . ( k1 + 1 ) ) = ( p9 . i ) by A65,XXREAL_0:1;
then ( k1 + 1 ) = i by A1,A2,A42,FUNCT_1:def 4;
hence thesis by A65,NAT_1:13;
end;
suppose A68: (k2 < i & ( p . k2 ) >= j);

then ( ( p . ( k1 + 1 ) ) - 1 ) = ( ( p . k2 ) - 1 ) by A31,A33,A34,A36,A43,A66;
then ( k1 + 1 ) = k2 by A2,A47,A42,FUNCT_1:def 4;
hence thesis by A65,A68,NAT_1:13;
end;
suppose A69: (k2 >= i & ( p . ( k2 + 1 ) ) < j);

then ( ( p . ( k1 + 1 ) ) - 1 ) = ( p . ( k2 + 1 ) ) by A31,A33,A34,A36,A43,A66;
then ( p . ( k1 + 1 ) ) = ( ( p . ( k2 + 1 ) ) + 1 );
then ( p . ( k1 + 1 ) ) <= j by A69,NAT_1:13;
then ( p9 . ( k1 + 1 ) ) = ( p9 . i ) by A65,XXREAL_0:1;
then ( k1 + 1 ) = i by A1,A2,A42,FUNCT_1:def 4;
hence thesis by A65,NAT_1:13;
end;
suppose (k2 >= i & ( p . ( k2 + 1 ) ) >= j);

then ( ( p . ( k1 + 1 ) ) - 1 ) = ( ( p . ( k2 + 1 ) ) - 1 ) by A31,A33,A34,A36,A43,A66;
then ( k1 + 1 ) = ( k2 + 1 ) by A2,A42,A49,FUNCT_1:def 4;
hence thesis by A36,A43;
end;
end;
end;
then A70: q is  one-to-one by FUNCT_1:def 4;
( card ( finSeg N ) ) = ( card ( finSeg N ) );
then q is  one-to-one  onto by A70,STIRL2_1:60;
then reconsider q as (Element of P) by MATRIX_2:def 9;
take q;
thus thesis by A31;
end;
uniqueness
proof
set p = perm;
let q1 being (Element of ( Permutations n ));
let q2 being (Element of ( Permutations n ));
assume that
A71: (for k holds (k in ( Seg n ) implies ((k < i implies ((( p . k ) < ( p . i ) implies ( q1 . k ) = ( p . k )) & (( p . k ) >= ( p . i ) implies ( q1 . k ) = ( ( p . k ) - 1 )))) & (k >= i implies ((( p . ( k + 1 ) ) < ( p . i ) implies ( q1 . k ) = ( p . ( k + 1 ) )) & (( p . ( k + 1 ) ) >= ( p . i ) implies ( q1 . k ) = ( ( p . ( k + 1 ) ) - 1 )))))))
and
A72: (for k holds (k in ( Seg n ) implies ((k < i implies ((( p . k ) < ( p . i ) implies ( q2 . k ) = ( p . k )) & (( p . k ) >= ( p . i ) implies ( q2 . k ) = ( ( p . k ) - 1 )))) & (k >= i implies ((( p . ( k + 1 ) ) < ( p . i ) implies ( q2 . k ) = ( p . ( k + 1 ) )) & (( p . ( k + 1 ) ) >= ( p . i ) implies ( q2 . k ) = ( ( p . ( k + 1 ) ) - 1 )))))));
A73: q1 is (Permutation of ( Seg n )) by MATRIX_2:def 9;
then A74: ( dom q1 ) = ( Seg n ) by FUNCT_2:52;
A75:now
let x;
assume that
A76: x in ( dom q1 );
consider k being (Element of ( NAT )) such that A77: x = k and 1 <= k and k <= n by A74,A76;
set k1 = ( k + 1 );
A78: (( p . k ) < ( p . i ) or ( p . k ) >= ( p . i ));
A79: (( p . k1 ) < ( p . i ) or ( p . k1 ) >= ( p . i ));
(k < i or k >= i);
then (((((( p . k ) < ( p . i ) & ( q1 . k ) = ( p . k )) & ( q2 . k ) = ( p . k )) or ((( p . k ) >= ( p . i ) & ( q1 . k ) = ( ( p . k ) - 1 )) & ( q2 . k ) = ( ( p . k ) - 1 ))) or ((( p . k1 ) < ( p . i ) & ( q1 . k ) = ( p . k1 )) & ( q2 . k ) = ( p . k1 ))) or ((( p . k1 ) >= ( p . i ) & ( q1 . k ) = ( ( p . k1 ) - 1 )) & ( q2 . k ) = ( ( p . k1 ) - 1 ))) by A71,A72,A74,A76,A77,A78,A79;
hence ( q1 . x ) = ( q2 . x ) by A77;
end;
q2 is (Permutation of ( Seg n )) by MATRIX_2:def 9;
then ( dom q2 ) = ( Seg n ) by FUNCT_2:52;
hence thesis by A73,A75,FUNCT_1:2,FUNCT_2:52;
end;
end;
