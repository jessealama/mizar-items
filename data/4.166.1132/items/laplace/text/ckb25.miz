environ
vocabularies NUMBERS,SUBSET_1,NAT_1,XBOOLE_0,MATRIX11,FINSEQ_1,ARYTM_3,MATRIX_2,VECTSP_1,MATRIX_1,RELAT_1,FINSEQ_3,ARYTM_1,TREES_1,CARD_1,XXREAL_0,FUNCT_1,INCSP_1,TARSKI,ALGSTR_0,ZFMISC_1,STRUCT_0,REALSET1,SETWOP_2,FUNCT_2,FINSUB_1,GROUP_1,SETWISEO,INT_1,FINSET_1,ABIAN,FINSEQ_2,BINOP_1,QC_LANG1,AFINSQ_1,ABSVALUE,MATRIX_3,SUPINF_2,CARD_3,FINSOP_1,RVSUM_1,FVSUM_1,MESFUNC1,MATRIX_6,LAPLACE;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,FINSET_1,RELAT_1,RELSET_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,BINOP_1,STRUCT_0,ALGSTR_0,GROUP_1,VECTSP_1,SETWISEO,SETWOP_2,FINSEQ_2,MATRIX_1,FINSUB_1,MATRIX_2,NAT_1,FVSUM_1,FINSOP_1,MATRIX_3,CARD_1,FINSEQ_7,NEWTON,MATRIX_7,FINSEQ_3,MATRIX11,MATRIX_6,NAT_D,CKB6,CKB14,CKB18,CKB19,CKB24;
definitions FINSEQ_2,FINSEQ_1,TARSKI,MATRIX_1,MATRIX_3,FVSUM_1,MATRIX_2,MATRIX_7,MATRIX11,RELAT_1,ALGSTR_0,CKB14,CKB18,CKB24;
theorems FINSEQ_1,FINSEQ_2,TARSKI,FUNCT_2,NAT_1,FUNCT_1,SETWISEO,VECTSP_1,ZFMISC_1,FVSUM_1,SETWOP_2,MATRIX_1,MATRIX_2,FINSUB_1,FINSEQ_3,RELAT_1,FINSOP_1,XBOOLE_0,XBOOLE_1,MATRIX_3,XREAL_1,MATRIX_7,ORDINAL1,CARD_1,CARD_2,MATRIX_9,STIRL2_1,SGRAPH1,CARD_FIN,HURWITZ,NEWTON,COMPUT_1,MATRIX11,GROUP_1,MATRIX_4,MATRIX_6,MATRIXR1,NAT_D,XXREAL_0,MATRIXR2,XREAL_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB20,CKB21,CKB22,CKB23,CKB24;
schemes FUNCT_2,NAT_1,FINSEQ_1,FUNCT_1,SETWISEO,MATRIX_1;
registrations FUNCT_1,FINSUB_1,FINSET_1,STRUCT_0,FVSUM_1,MATRIX_2,VECTSP_1,FUNCT_2,PARTFUN1,XBOOLE_0,ORDINAL1,XXREAL_0,NAT_1,INT_1,RELAT_1,CARD_1,MATRIX11,XCMPLX_0,RELSET_1,FINSEQ_2,FINSEQ_1;
constructors RELAT_2,SETWISEO,FINSOP_1,SETWOP_2,ALGSTR_1,FVSUM_1,BINOP_1,XXREAL_0,FINSEQ_4,FINSEQ_7,WELLORD2,NEWTON,MATRIX_6,MATRIX_7,MATRIX11,NAT_D,BINOP_2,RELSET_1,CKB6,CKB14,CKB18,CKB24;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve i for Nat;
reserve j for Nat;
reserve n for Nat;
reserve p1 for (Element of ( Permutations ( n + 1 ) ));
reserve q1 for (Element of ( Permutations ( n + 1 ) ));
theorem
Th20: (for i holds (for j holds ((i in ( Seg ( n + 1 ) ) & j in ( Seg ( n + 1 ) )) implies (for P being set holds (P = { p1: ( p1 . i ) = j } implies (ex Proj being (Function of P,( Permutations n )) st (Proj is  bijective & (for q1 holds (( q1 . i ) = j implies ( Proj . q1 ) = ( Rem (q1,i) ))))))))))
proof
let i;
let j;
assume that
A1: i in ( Seg ( n + 1 ) )
and
A2: j in ( Seg ( n + 1 ) );
set n1 = ( n + 1 );
reconsider N = n as (Element of ( NAT )) by ORDINAL1:def 12;
set P1 = ( Permutations ( N + 1 ) );
defpred F[ set,set ]
 means
(for p being (Element of P1) holds (($1 = p & ( p . i ) = j) implies $2 = ( Rem (p,i) )));
let X being set;
assume that
A3: X = { p1: ( p1 . i ) = j };
A4: (for x holds (x in X implies (ex y st (y in ( Permutations n ) & F[ x,y ]))))
proof
let x;
assume x in X;
then consider p being (Element of P1) such that A5: p = x and ( p . i ) = j by A3;
take ( Rem (p,i) );
thus thesis by A5;
end;
consider f being (Function of X,( Permutations n )) such that A6: (for x holds (x in X implies F[ x,( f . x ) ])) from FUNCT_2:sch 1(A4);
(for x1,x2 being set holds (((x1 in X & x2 in X) & ( f . x1 ) = ( f . x2 )) implies x1 = x2))
proof
let x1 being set,x2 being set;
assume that
A7: x1 in X
and
A8: x2 in X
and
A9: ( f . x1 ) = ( f . x2 );
consider p1 being (Element of P1) such that A10: p1 = x1 and A11: ( p1 . i ) = j by A3,A7;
set R1 = ( Rem (p1,i) );
A12: ( f . x1 ) = R1 by A6,A7,A10,A11;
consider p2 being (Element of P1) such that A13: p2 = x2 and A14: ( p2 . i ) = j by A3,A8;
set R2 = ( Rem (p2,i) );
A15: ( f . x2 ) = R2 by A6,A8,A13,A14;
reconsider p19 = p1,p29 = p2 as (Permutation of ( Seg n1 )) by MATRIX_2:def 9;
A16: ( dom p29 ) = ( Seg n1 ) by FUNCT_2:52;
A17: ( dom p19 ) = ( Seg n1 ) by FUNCT_2:52;
now
let x;
assume that
A18: x in ( Seg n1 );
consider k being (Element of ( NAT )) such that A19: x = k and A20: 1 <= k and A21: k <= n1 by A18;
per cases  by XXREAL_0:1;
suppose A22: k < i;

i <= n1 by A1,FINSEQ_1:1;
then k < n1 by A22,XXREAL_0:2;
then k <= n by NAT_1:13;
then A23: k in ( Seg n ) by A20;
per cases ;
suppose ((( p1 . k ) < j & ( p2 . k ) < j) or (( p1 . k ) >= j & ( p2 . k ) >= j));

then ((( R1 . k ) = ( p1 . k ) & ( R2 . k ) = ( p2 . k )) or (( R1 . k ) = ( ( p1 . k ) - 1 ) & ( R2 . k ) = ( ( p2 . k ) - 1 ))) by A1,A11,A14,A22,A23,CKB24:def 1;
hence ( p1 . x ) = ( p2 . x ) by A9,A12,A15,A19;
end;
suppose ((( p1 . k ) < j & ( p2 . k ) >= j) or (( p1 . k ) >= j & ( p2 . k ) < j));

then ((((( R1 . k ) = ( p1 . k ) & ( R2 . k ) = ( ( p2 . k ) - 1 )) & ( p1 . k ) < j) & ( p2 . k ) >= j) or (((( R1 . k ) = ( ( p1 . k ) - 1 ) & ( R2 . k ) = ( p2 . k )) & ( p1 . k ) >= j) & ( p2 . k ) < j)) by A1,A11,A14,A22,A23,CKB24:def 1;
then (((( ( p1 . k ) + 1 ) = ( p2 . k ) & ( p1 . k ) < j) & ( p2 . k ) >= j) or ((( p1 . k ) = ( ( p2 . k ) + 1 ) & ( p1 . k ) >= j) & ( p2 . k ) < j)) by A9,A12,A15;
then ((( p2 . k ) <= j & ( p2 . k ) >= j) or (( p1 . k ) >= j & ( p1 . k ) <= j)) by NAT_1:13;
then (( p29 . k ) = ( p29 . i ) or ( p19 . k ) = ( p19 . i )) by A11,A14,XXREAL_0:1;
hence ( p1 . x ) = ( p2 . x ) by A1,A17,A16,A18,A19,A22,FUNCT_1:def 4;
end;
end;
suppose k = i;

hence ( p1 . x ) = ( p2 . x ) by A11,A14,A19;
end;
suppose A24: k > i;

then reconsider k1 = ( k - 1 ) as (Element of ( NAT )) by NAT_1:20;
( k1 + 1 ) > i by A24;
then A25: k1 >= i by NAT_1:13;
( k1 + 1 ) <= n1 by A21;
then k1 < n1 by NAT_1:13;
then A26: k1 <= n by NAT_1:13;
1 <= i by A1,FINSEQ_1:1;
then 1 < ( k1 + 1 ) by A24,XXREAL_0:2;
then 1 <= k1 by NAT_1:13;
then A27: k1 in ( Seg n ) by A26;
per cases ;
suppose ((( p1 . ( k1 + 1 ) ) < j & ( p2 . ( k1 + 1 ) ) < j) or (( p1 . ( k1 + 1 ) ) >= j & ( p2 . ( k1 + 1 ) ) >= j));

then ((( R1 . k1 ) = ( p1 . k ) & ( R2 . k1 ) = ( p2 . k )) or (( R1 . k1 ) = ( ( p1 . k ) - 1 ) & ( R2 . k1 ) = ( ( p2 . k ) - 1 ))) by A1,A11,A14,A27,A25,CKB24:def 1;
hence ( p1 . x ) = ( p2 . x ) by A9,A12,A15,A19;
end;
suppose ((( p1 . ( k1 + 1 ) ) < j & ( p2 . ( k1 + 1 ) ) >= j) or (( p1 . ( k1 + 1 ) ) >= j & ( p2 . ( k1 + 1 ) ) < j));

then ((((( R1 . k1 ) = ( p1 . k ) & ( R2 . k1 ) = ( ( p2 . k ) - 1 )) & ( p1 . k ) < j) & ( p2 . k ) >= j) or (((( R1 . k1 ) = ( ( p1 . k ) - 1 ) & ( R2 . k1 ) = ( p2 . k )) & ( p1 . k ) >= j) & ( p2 . k ) < j)) by A1,A11,A14,A27,A25,CKB24:def 1;
then (((( ( p1 . k ) + 1 ) = ( p2 . k ) & ( p1 . k ) < j) & ( p2 . k ) >= j) or ((( p1 . k ) = ( ( p2 . k ) + 1 ) & ( p1 . k ) >= j) & ( p2 . k ) < j)) by A9,A12,A15;
then ((( p2 . k ) <= j & ( p2 . k ) >= j) or (( p1 . k ) >= j & ( p1 . k ) <= j)) by NAT_1:13;
then (( p29 . k ) = ( p29 . i ) or ( p19 . k ) = ( p19 . i )) by A11,A14,XXREAL_0:1;
hence ( p1 . x ) = ( p2 . x ) by A1,A17,A16,A18,A19,A24,FUNCT_1:def 4;
end;
end;
end;
hence thesis by A10,A13,A17,A16,FUNCT_1:2;
end;
then A28: f is  one-to-one by FUNCT_2:19;
set P = ( Permutations N );
A29: ( card P ) = ( N ! ) by CKB7:1;
( card X ) = ( N ! ) by A1,A2,A3,CKB8:1;
then reconsider P9 = P,X9 = X as  finite set by A29;
take f;
A30: ( card P9 ) = ( n ! ) by CKB7:1;
( card X9 ) = ( n ! ) by A1,A2,A3,CKB8:1;
then f is  onto  one-to-one by A28,A30,STIRL2_1:60;
hence f is  bijective;
let p being (Element of ( Permutations ( n + 1 ) ));
assume that
A31: ( p . i ) = j;
p in X by A3,A31;
hence thesis by A6,A31;
end;
