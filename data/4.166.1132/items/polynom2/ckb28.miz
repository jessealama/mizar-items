environ
vocabularies NUMBERS,XBOOLE_0,SUBSET_1,FINSEQ_1,RELAT_1,PARTFUN1,CARD_1,FUNCT_1,TARSKI,XXREAL_0,ARYTM_1,ARYTM_3,NAT_1,ORDERS_1,RELAT_2,GROUP_1,BINOP_1,ALGSTR_0,RLVECT_1,VECTSP_1,LATTICES,ZFMISC_1,FINSET_1,ALGSTR_1,STRUCT_0,SUPINF_2,CARD_3,FINSOP_1,ORDINAL4,PRE_POLY,FINSEQ_5,FUNCT_4,FUNCOP_1,ORDINAL1,WELLORD2,MESFUNC1,RFINSEQ,POLYNOM1,ALGSEQ_1,QC_LANG1,MSSUBFAM,QUOFIELD,POLYNOM2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,RELAT_1,FINSOP_1,RELAT_2,RELSET_1,FUNCT_1,FINSET_1,ORDINAL1,PARTFUN1,FUNCT_2,BINOP_1,FUNCT_4,FUNCT_7,REAL_1,NAT_1,ALGSTR_1,ORDERS_1,FINSEQ_1,STRUCT_0,ALGSTR_0,RLVECT_1,FUNCOP_1,VFUNCT_1,VECTSP_1,GROUP_1,GROUP_4,QUOFIELD,FINSEQ_5,GRCAT_1,RFINSEQ,YELLOW_1,GROUP_6,XXREAL_0,RECDEF_1,PRE_POLY,POLYNOM1,CKB20,CKB22,CKB24,CKB25;
definitions QUOFIELD,GROUP_1,BINOP_1,FUNCOP_1,ALGSTR_0,CKB20,CKB25;
theorems TARSKI,FINSEQ_1,FUNCT_1,FUNCT_2,ORDINAL1,RELAT_1,ZFMISC_1,VECTSP_1,POLYNOM1,RELAT_2,WELLORD2,FUNCT_7,FUNCT_4,FUNCOP_1,ORDERS_1,NAT_1,FINSEQ_4,GRCAT_1,INT_1,FINSEQ_3,RLVECT_1,GROUP_4,PARTFUN2,CARD_1,RFINSEQ,FINSOP_1,FINSEQ_5,CARD_2,FINSEQ_2,ALGSTR_1,GROUP_1,XBOOLE_0,XBOOLE_1,PARTFUN1,XREAL_1,GROUP_6,XXREAL_0,VALUED_0,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB23,CKB25,CKB26,CKB27;
schemes FUNCT_2,NAT_1,RECDEF_1,INT_1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,FINSEQ_1,STRUCT_0,VECTSP_1,ALGSTR_1,MONOID_0,POLYNOM1,VALUED_0,CARD_1,SUBSET_1,PRE_POLY,RELAT_1,VFUNCT_1,FUNCT_2,FUNCT_1,CKB5,CKB21;
constructors XXREAL_0,REAL_1,FINSOP_1,RFINSEQ,BINARITH,FINSEQ_5,GROUP_4,GRCAT_1,GROUP_6,MONOID_0,TRIANG_1,YELLOW_1,QUOFIELD,POLYNOM1,RECDEF_1,ALGSTR_1,RELSET_1,FUNCT_7,FVSUM_1,VFUNCT_1,CKB20,CKB22,CKB24,CKB25;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
theorem
Th17: (for n being Ordinal holds (for L being  well-unital non trivial doubleLoopStr holds (for u being set holds (for b being (bag of n) holds (( support b ) = { u } implies (for x being (Function of n,L) holds ( eval (b,x) ) = ( ( power L ) . (( x . u ),( b . u )) )))))))
proof
let n being Ordinal;
let L being  well-unital non trivial doubleLoopStr;
let u being set;
let b being (bag of n);
reconsider sb = ( support b ) as  finite (Subset of n);
set sg = ( SgmX (( RelIncl n ),sb) );
assume A1: ( support b ) = { u };
then A2: u in ( support b ) by TARSKI:def 1;
let x being (Function of n,L);
A3: ( rng x ) c= (the carrier of L) by RELAT_1:def 19;
A4: n = ( dom x ) by FUNCT_2:def 1;
then ( x . u ) in ( rng x ) by A2,FUNCT_1:def 3;
then reconsider xu = ( x . u ) as (Element of L) by A3;
A5: ( RelIncl n ) linearly_orders sb by CKB23:1;
then A6: ( rng sg ) = { u } by A1,PRE_POLY:def 2;
then A7: u in ( rng sg ) by TARSKI:def 1;
then A8: 1 in ( dom sg ) by FINSEQ_3:31;
then A9: ( sg . 1 ) in ( rng sg ) by FUNCT_1:def 3;
then A10: ( sg . 1 ) = u by A6,TARSKI:def 1;
then 1 in ( dom ( x * sg ) ) by A4,A8,A2,FUNCT_1:11;
then A11: ( ( x * sg ) /. 1 ) = ( ( x * sg ) . 1 ) by PARTFUN1:def 6
.= ( x . ( sg . 1 ) ) by A8,FUNCT_1:13
.= ( x . u ) by A6,A9,TARSKI:def 1;
( dom b ) = n by PARTFUN1:def 2;
then 1 in ( dom ( b * sg ) ) by A8,A10,A2,FUNCT_1:11;
then A12: ( ( b * sg ) /. 1 ) = ( ( b * sg ) . 1 ) by PARTFUN1:def 6
.= ( b . ( sg . 1 ) ) by A8,FUNCT_1:13
.= ( b . u ) by A6,A9,TARSKI:def 1;
A13: ( ( power L ) . (xu,( b . u )) ) = ( ( power L ) . [ xu,( b . u ) ] );
A14: (for v being set holds (v in ( dom sg ) implies v in { 1 }))
proof
let v being set;
assume A15: v in ( dom sg );
assume A16: (not v in { 1 });
reconsider v as (Element of ( NAT )) by A15;
( sg /. v ) = ( sg . v ) by A15,PARTFUN1:def 6;
then A17: ( sg /. v ) in ( rng sg ) by A15,FUNCT_1:def 3;
A18: v <> 1 by A16,TARSKI:def 1;
A19: 1 < v
proof
consider k being Nat such that A20: ( dom sg ) = ( Seg k ) by FINSEQ_1:def 2;
( Seg k ) = { l where l is (Element of ( NAT )): (1 <= l & l <= k) } by FINSEQ_1:def 1;
then (ex m9 being (Element of ( NAT )) st ((m9 = v & 1 <= m9) & m9 <= k)) by A15,A20;
hence thesis by A18,XXREAL_0:1;
end;
( sg /. 1 ) = ( sg . 1 ) by A7,A15,FINSEQ_3:31,PARTFUN1:def 6;
then ( sg /. 1 ) in ( rng sg ) by A8,FUNCT_1:def 3;
then ( sg /. 1 ) = u by A6,TARSKI:def 1
.= ( sg /. v ) by A6,A17,TARSKI:def 1;
hence thesis by A5,A8,A15,A19,PRE_POLY:def 2;
end;
consider y being (FinSequence of (the carrier of L)) such that A21: ( len y ) = ( len ( SgmX (( RelIncl n ),( support b )) ) ) and A22: ( eval (b,x) ) = ( Product y ) and A23: (for i being (Element of ( NAT )) holds ((1 <= i & i <= ( len y )) implies ( y /. i ) = ( ( power L ) . (( ( x * ( SgmX (( RelIncl n ),( support b )) ) ) /. i ),( ( b * ( SgmX (( RelIncl n ),( support b )) ) ) /. i )) ))) by CKB25:def 1;
(for v being set holds (v in { 1 } implies v in ( dom sg ))) by A8,TARSKI:def 1;
then ( dom sg ) = ( Seg 1 ) by A14,FINSEQ_1:2,TARSKI:1;
then A24: ( len sg ) = 1 by FINSEQ_1:def 3;
then ( y . 1 ) = ( y /. 1 ) by A21,FINSEQ_4:15
.= ( ( power L ) . (( ( x * sg ) /. 1 ),( ( b * sg ) /. 1 )) ) by A21,A23,A24;
then y = <* ( ( power L ) . (( x . u ),( b . u )) ) *> by A21,A24,A12,A11,FINSEQ_1:40;
hence thesis by A22,A13,GROUP_4:9;
end;
