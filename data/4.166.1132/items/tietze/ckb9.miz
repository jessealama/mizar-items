environ
vocabularies NUMBERS,XREAL_0,ORDINAL1,VALUED_0,FUNCT_1,COMPLEX1,ARYTM_1,XXREAL_0,ARYTM_3,CARD_1,NAT_1,TARSKI,RELAT_1,XBOOLE_0,SERIES_1,SEQ_2,SEQ_1,FUNCOP_1,SUBSET_1,PRE_TOPC,ORDINAL2,CARD_3,POWER,REAL_1,PREPOWER,NEWTON,VALUED_1,SEQFUNC,PBOOLE,PARTFUN1,RCOMP_1,SETFAM_1,STRUCT_0,TOPMETR,LIMFUNC1,TOPS_2,XXREAL_1,TMAP_1,METRIC_1,FUNCT_2,PSCOMP_1,TIETZE;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,XCMPLX_0,NUMBERS,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,NEWTON,PREPOWER,POWER,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,VALUED_0,VALUED_1,SEQ_1,SEQ_2,FUNCT_2,FUNCOP_1,SERIES_1,LIMFUNC1,RCOMP_1,SEQFUNC,STRUCT_0,PRE_TOPC,TOPS_2,BORSUK_1,TOPMETR,TSEP_1,TMAP_1,MEASURE6,PSCOMP_1,TOPREALB,METRIC_1,PARTFUN3,CKB4;
definitions TARSKI,XBOOLE_0,SEQM_3,SEQFUNC,PRE_TOPC,BORSUK_1,COMPTS_1,STRUCT_0,LIMFUNC1,PROB_1,CKB4;
theorems PRE_TOPC,RCOMP_1,XBOOLE_0,TARSKI,FUNCT_1,RELAT_1,TOPREALB,URYSOHN3,TSEP_1,JGRAPH_5,XREAL_0,TOPREALA,TOPMETR,ABSVALUE,FUNCT_2,XREAL_1,TOPS_2,SEQ_1,TMAP_1,TOPS_1,XBOOLE_1,FUNCOP_1,NEWTON,TOPREAL6,GRFUNC_1,RFUNCT_1,SEQFUNC,METRIC_1,GOBOARD6,RSSPACE,SEQ_2,SEQ_4,XCMPLX_1,SERIES_1,COMPLEX1,XCMPLX_0,ORDINAL1,POWER,PREPOWER,NAT_1,UNIFORM1,MESFUNC1,RELSET_1,XXREAL_0,VALUED_0,VALUED_1,XXREAL_1,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8;
schemes NAT_1,RECDEF_1,FUNCT_2;
registrations XBOOLE_0,SUBSET_1,FUNCT_1,ORDINAL1,RELSET_1,FUNCT_2,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,NEWTON,FCONT_3,STRUCT_0,PRE_TOPC,METRIC_1,BORSUK_1,TOPMETR,PSCOMP_1,BORSUK_3,BORSUK_4,BORSUK_6,TOPREALB,VALUED_0,VALUED_1,SEQ_4,FUNCOP_1,RELAT_1,TMAP_1,MEASURE6,PARTFUN4,CKB5;
constructors NAT_1,SEQM_3,PROB_1,LIMFUNC1,NEWTON,PREPOWER,FUNCOP_1,SERIES_1,COMPTS_1,TMAP_1,BORSUK_4,TOPREALB,PARTFUN3,SEQ_1,SEQFUNC,SETFAM_1,SEQ_2,MEASURE6,PCOMPS_1,PSCOMP_1,SEQ_4,SQUARE_1,WAYBEL18,CKB4;
requirements BOOLE,SUBSET,NUMERALS,REAL,ARITHM;
begin
theorem
Th9: (for f being Real_Sequence holds (for a,r being  positive  real number holds ((r < 1 & (for n being  natural number holds |. ( ( f . n ) - ( f . ( n + 1 ) ) ) .| <= ( a * ( r to_power n ) ))) implies (f is  convergent & (for n being  natural number holds |. ( ( lim f ) - ( f . n ) ) .| <= ( ( a * ( r to_power n ) ) / ( 1 - r ) ))))))
proof
let f being Real_Sequence;
let a being  positive  real number,r being  positive  real number;
deffunc S(Nat,Real) = ( ( f . ( $1 + 1 ) ) - ( f . $1 ) );
consider g being (Function of ( NAT ),( REAL )) such that A1: (( g . ( 0 ) ) = ( f . ( 0 ) ) & (for n being Nat holds ( g . ( n + 1 ) ) = S(n,( g . n )))) from NAT_1:sch 12;
now
let n being (Element of ( NAT ));
thus ( f . ( n + 1 ) ) = ( ( ( f . ( n + 1 ) ) - ( f . n ) ) + ( f . n ) )
.= ( ( f . n ) + ( g . ( n + 1 ) ) ) by A1;
end;
then A2: f = ( Partial_Sums g ) by A1,SERIES_1:def 1;
A3:now
let n being (Element of ( NAT ));
( ( abs g ) . n ) = ( abs ( g . n ) ) by SEQ_1:12;
hence ( 0 ) <= ( ( abs g ) . n ) by COMPLEX1:46;
end;
A4: |. r .| = r by COMPLEX1:43;
assume A5: r < 1;
then A6: ( r GeoSeq ) is  summable by A4,SERIES_1:24;
assume A7: (for n being  natural number holds |. ( ( f . n ) - ( f . ( n + 1 ) ) ) .| <= ( a * ( r to_power n ) ));
A8:now
let n being (Element of ( NAT ));
set m = 1;
assume m <= n;
then consider k being Nat such that A9: n = ( 1 + k ) by NAT_1:10;
( g . n ) = S(k,( g . k )) by A1,A9;
then ( ( abs g ) . n ) = |. ( ( f . n ) - ( f . k ) ) .| by A9,SEQ_1:12
.= |. ( ( f . k ) - ( f . n ) ) .| by COMPLEX1:60;
then A10: ( ( abs g ) . n ) <= ( a * ( r to_power k ) ) by A7,A9;
( ( a * 1 ) * ( r to_power k ) ) = ( ( a * ( ( r " ) * r ) ) * ( r to_power k ) ) by XCMPLX_0:def 7
.= ( ( a * ( r " ) ) * ( r * ( r to_power k ) ) )
.= ( ( a * ( r " ) ) * ( ( r to_power 1 ) * ( r to_power k ) ) ) by POWER:25
.= ( ( a * ( r " ) ) * ( r to_power n ) ) by A9,POWER:27
.= ( ( a * ( r " ) ) * ( r |^ n ) ) by POWER:41
.= ( ( a * ( r " ) ) * ( ( r GeoSeq ) . n ) ) by PREPOWER:def 1;
hence ( ( abs g ) . n ) <= ( ( ( a * ( r " ) ) (#) ( r GeoSeq ) ) . n ) by A10,SEQ_1:9;
end;
( ( a * ( r " ) ) (#) ( r GeoSeq ) ) is  summable by A6,SERIES_1:10;
then ( abs g ) is  summable by A3,A8,SERIES_1:19;
then A11: g is  absolutely_summable by SERIES_1:def 4;
then g is  summable by SERIES_1:35;
hence f is  convergent by A2,SERIES_1:def 2;
let n being  natural number;
reconsider n9 = n as (Element of ( NAT )) by ORDINAL1:def 12;
A12:now
let k being (Element of ( NAT ));
( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) = |. ( ( g ^\ ( n9 + 1 ) ) . k ) .| by SEQ_1:12;
hence ( 0 ) <= ( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) by COMPLEX1:46;
( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) = |. ( ( g ^\ ( n9 + 1 ) ) . k ) .| by SEQ_1:12
.= |. ( g . ( ( n9 + 1 ) + k ) ) .| by NAT_1:def 3
.= |. ( ( f . ( ( n9 + k ) + 1 ) ) - ( f . ( n9 + k ) ) ) .| by A1
.= |. ( ( f . ( n9 + k ) ) - ( f . ( ( n9 + k ) + 1 ) ) ) .| by UNIFORM1:11;
then ( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) <= ( a * ( r to_power ( n9 + k ) ) ) by A7;
then ( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) <= ( a * ( ( r to_power n9 ) * ( r to_power k ) ) ) by POWER:27;
then ( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) <= ( ( a * ( r to_power n9 ) ) * ( r to_power k ) );
then ( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) <= ( ( a * ( r to_power n9 ) ) * ( r |^ k ) ) by POWER:41;
then ( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) <= ( ( a * ( r to_power n9 ) ) * ( ( r GeoSeq ) . k ) ) by PREPOWER:def 1;
hence ( ( abs ( g ^\ ( n9 + 1 ) ) ) . k ) <= ( ( ( a * ( r to_power n ) ) (#) ( r GeoSeq ) ) . k ) by SEQ_1:9;
end;
A13: ( ( a * ( r to_power n ) ) (#) ( r GeoSeq ) ) is  summable by A6,SERIES_1:10;
then ( abs ( g ^\ ( n9 + 1 ) ) ) is  summable by A12,SERIES_1:20;
then A14: ( g ^\ ( n9 + 1 ) ) is  absolutely_summable by SERIES_1:def 4;
( lim f ) = ( Sum g ) by A2,SERIES_1:def 3;
then ( lim f ) = ( ( f . n ) + ( Sum ( g ^\ ( n9 + 1 ) ) ) ) by A2,A11,SERIES_1:15,SERIES_1:35;
then A15: |. ( ( lim f ) - ( f . n ) ) .| <= ( Sum ( abs ( g ^\ ( n9 + 1 ) ) ) ) by A14,CKB8:1;
A16: ( Sum ( abs ( g ^\ ( n9 + 1 ) ) ) ) <= ( Sum ( ( a * ( r to_power n ) ) (#) ( r GeoSeq ) ) ) by A13,A12,SERIES_1:20;
( Sum ( ( a * ( r to_power n ) ) (#) ( r GeoSeq ) ) ) = ( ( a * ( r to_power n ) ) * ( Sum ( r GeoSeq ) ) ) by A6,SERIES_1:10
.= ( ( a * ( r to_power n ) ) * ( 1 / ( 1 - r ) ) ) by A5,A4,SERIES_1:24
.= ( ( a * ( r to_power n ) ) / ( 1 - r ) ) by XCMPLX_1:99;
hence thesis by A16,A15,XXREAL_0:2;
end;
