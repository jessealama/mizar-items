environ
vocabularies NUMBERS,REAL_1,SUBSET_1,FINSEQ_1,INTEGRA1,XREAL_0,ORDINAL1,SEQ_4,XXREAL_0,XXREAL_1,VALUED_0,RELAT_1,ARYTM_3,FUNCT_1,CARD_1,NAT_1,CLASSES1,FINSEQ_5,ARYTM_1,ORDINAL4,XBOOLE_0,JORDAN3,MEMBERED,MEMBER_1,TARSKI,PARTFUN1,XXREAL_2,VALUED_1,MEASURE7,CARD_3,SEQ_1,INTEGRA2,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,CARD_1,NUMBERS,XXREAL_0,XREAL_0,XXREAL_2,XXREAL_3,MEMBERED,MEMBER_1,REAL_1,NAT_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,FINSEQ_1,RFUNCT_1,RVSUM_1,INTEGRA1,VALUED_1,SEQ_1,SEQ_2,SEQ_4,FINSEQ_6,RCOMP_1,FINSEQ_5,CLASSES1,RFINSEQ,MEASURE5,MEASURE6,CKB2,CKB7;
definitions TARSKI,XBOOLE_0,VALUED_1,RELAT_1,MEMBER_1,XXREAL_2,XXREAL_3,CKB2;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,NEWTON,RCOMP_1,NAT_1,RFINSEQ,CARD_1,FINSEQ_5,FINSEQ_3,RELAT_1,FUNCT_2,XREAL_0,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,MEMBERED,VALUED_1,XXREAL_2,TARSKI,SEQM_3,CLASSES1,FINSEQ_6,MEMBER_1,XXREAL_3,CKB1,CKB2,CKB4,CKB5,CKB6,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33;
schemes SUBSET_1,SEQ_1,NAT_1;
registrations RELAT_1,ORDINAL1,FUNCT_2,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FINSEQ_1,RFINSEQ,INTEGRA1,VALUED_0,VALUED_1,XXREAL_2,CARD_1,SEQ_2,RELSET_1,XXREAL_3,MEMBER_1,MEASURE5,CKB3;
constructors PARTFUN1,REAL_1,NAT_1,SEQM_3,RFUNCT_1,RFINSEQ,BINARITH,FINSEQ_5,FINSEQ_6,INTEGRA1,SEQ_1,XXREAL_2,NAT_D,RVSUM_1,SEQ_4,CLASSES1,RELSET_1,SEQ_2,MEMBER_1,MEASURE6,CKB2,CKB7;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve a for Real;
reserve r for Real;
reserve A for non empty  closed_interval (Subset of ( REAL ));
reserve f for (Function of A,( REAL ));
theorem
Th31: ((( f | A ) is  bounded & f is  integrable) implies (( r (#) f ) is  integrable & ( integral ( r (#) f ) ) = ( r * ( integral f ) )))
proof
assume that
A1: ( f | A ) is  bounded
and
A2: f is  integrable;
f is  upper_integrable by A2,INTEGRA1:def 16;
then A3: ( rng ( upper_sum_set f ) ) is  bounded_below by INTEGRA1:def 12;
f is  lower_integrable by A2,INTEGRA1:def 16;
then A4: ( rng ( lower_sum_set f ) ) is  bounded_above by INTEGRA1:def 13;
A11:now
per cases ;
suppose A12: r >= ( 0 );

A13: (for D being set holds (D in ( divs A ) implies ( ( upper_sum_set ( r (#) f ) ) . D ) = ( ( r (#) ( upper_sum_set f ) ) . D )))
proof
let D being set;
assume A14: D in ( divs A );
then reconsider D as (Division of A) by INTEGRA1:def 3;
( ( upper_sum_set ( r (#) f ) ) . D ) = ( upper_sum (( r (#) f ),D) ) by INTEGRA1:def 10
.= ( r * ( upper_sum (f,D) ) ) by A1,A12,CKB30:1
.= ( r * ( ( upper_sum_set f ) . D ) ) by INTEGRA1:def 10
.= ( ( r (#) ( upper_sum_set f ) ) . D ) by A14,RFUNCT_1:57;
hence thesis;
end;
A16: ( divs A ) = ( dom ( upper_sum_set f ) ) by FUNCT_2:def 1
.= ( dom ( r (#) ( upper_sum_set f ) ) ) by VALUED_1:def 5;
( divs A ) = ( dom ( upper_sum_set ( r (#) f ) ) ) by FUNCT_2:def 1;
then ( upper_sum_set ( r (#) f ) ) = ( r (#) ( upper_sum_set f ) ) by A16,A13,FUNCT_1:2;
then A17: ( upper_integral ( r (#) f ) ) = ( lower_bound ( rng ( r (#) ( upper_sum_set f ) ) ) ) by INTEGRA1:def 14
.= ( lower_bound ( r ** ( rng ( upper_sum_set f ) ) ) ) by CKB20:1
.= ( r * ( lower_bound ( rng ( upper_sum_set f ) ) ) ) by A3,A12,CKB18:1
.= ( r * ( upper_integral f ) ) by INTEGRA1:def 14;
A18: (for D being set holds (D in ( divs A ) implies ( ( lower_sum_set ( r (#) f ) ) . D ) = ( ( r (#) ( lower_sum_set f ) ) . D )))
proof
let D being set;
assume A19: D in ( divs A );
then reconsider D as (Division of A) by INTEGRA1:def 3;
( ( lower_sum_set ( r (#) f ) ) . D ) = ( lower_sum (( r (#) f ),D) ) by INTEGRA1:def 11
.= ( r * ( lower_sum (f,D) ) ) by A1,A12,CKB32:1
.= ( r * ( ( lower_sum_set f ) . D ) ) by INTEGRA1:def 11
.= ( ( r (#) ( lower_sum_set f ) ) . D ) by A19,RFUNCT_1:57;
hence thesis;
end;
A21: ( divs A ) = ( dom ( lower_sum_set f ) ) by FUNCT_2:def 1
.= ( dom ( r (#) ( lower_sum_set f ) ) ) by VALUED_1:def 5;
( divs A ) = ( dom ( lower_sum_set ( r (#) f ) ) ) by FUNCT_2:def 1;
then ( lower_sum_set ( r (#) f ) ) = ( r (#) ( lower_sum_set f ) ) by A21,A18,FUNCT_1:2;
then ( lower_integral ( r (#) f ) ) = ( upper_bound ( rng ( r (#) ( lower_sum_set f ) ) ) ) by INTEGRA1:def 15
.= ( upper_bound ( r ** ( rng ( lower_sum_set f ) ) ) ) by CKB20:1
.= ( r * ( upper_bound ( rng ( lower_sum_set f ) ) ) ) by A4,A12,CKB16:1
.= ( r * ( lower_integral f ) ) by INTEGRA1:def 15
.= ( r * ( upper_integral f ) ) by A2,INTEGRA1:def 16;
hence ( upper_integral ( r (#) f ) ) = ( lower_integral ( r (#) f ) ) by A17;
thus ( upper_integral ( r (#) f ) ) = ( r * ( integral f ) ) by A17,INTEGRA1:def 17;
end;
suppose A22: r < ( 0 );

A23: (for D being set holds (D in ( divs A ) implies ( ( upper_sum_set ( r (#) f ) ) . D ) = ( ( r (#) ( lower_sum_set f ) ) . D )))
proof
let D being set;
assume A24: D in ( divs A );
then reconsider D as (Division of A) by INTEGRA1:def 3;
( ( upper_sum_set ( r (#) f ) ) . D ) = ( upper_sum (( r (#) f ),D) ) by INTEGRA1:def 10
.= ( r * ( lower_sum (f,D) ) ) by A1,A22,CKB33:1
.= ( r * ( ( lower_sum_set f ) . D ) ) by INTEGRA1:def 11
.= ( ( r (#) ( lower_sum_set f ) ) . D ) by A24,RFUNCT_1:57;
hence thesis;
end;
A26: ( divs A ) = ( dom ( lower_sum_set f ) ) by FUNCT_2:def 1
.= ( dom ( r (#) ( lower_sum_set f ) ) ) by VALUED_1:def 5;
( divs A ) = ( dom ( upper_sum_set ( r (#) f ) ) ) by FUNCT_2:def 1;
then ( upper_sum_set ( r (#) f ) ) = ( r (#) ( lower_sum_set f ) ) by A26,A23,FUNCT_1:2;
then A27: ( upper_integral ( r (#) f ) ) = ( lower_bound ( rng ( r (#) ( lower_sum_set f ) ) ) ) by INTEGRA1:def 14
.= ( lower_bound ( r ** ( rng ( lower_sum_set f ) ) ) ) by CKB20:1
.= ( r * ( upper_bound ( rng ( lower_sum_set f ) ) ) ) by A4,A22,CKB17:1
.= ( r * ( lower_integral f ) ) by INTEGRA1:def 15;
A28: (for D being set holds (D in ( divs A ) implies ( ( lower_sum_set ( r (#) f ) ) . D ) = ( ( r (#) ( upper_sum_set f ) ) . D )))
proof
let D being set;
assume A29: D in ( divs A );
then reconsider D as (Division of A) by INTEGRA1:def 3;
( ( lower_sum_set ( r (#) f ) ) . D ) = ( lower_sum (( r (#) f ),D) ) by INTEGRA1:def 11
.= ( r * ( upper_sum (f,D) ) ) by A1,A22,CKB31:1
.= ( r * ( ( upper_sum_set f ) . D ) ) by INTEGRA1:def 10
.= ( ( r (#) ( upper_sum_set f ) ) . D ) by A29,RFUNCT_1:57;
hence thesis;
end;
A31: ( divs A ) = ( dom ( upper_sum_set f ) ) by FUNCT_2:def 1
.= ( dom ( r (#) ( upper_sum_set f ) ) ) by VALUED_1:def 5;
( divs A ) = ( dom ( lower_sum_set ( r (#) f ) ) ) by FUNCT_2:def 1;
then ( lower_sum_set ( r (#) f ) ) = ( r (#) ( upper_sum_set f ) ) by A31,A28,FUNCT_1:2;
then ( lower_integral ( r (#) f ) ) = ( upper_bound ( rng ( r (#) ( upper_sum_set f ) ) ) ) by INTEGRA1:def 15
.= ( upper_bound ( r ** ( rng ( upper_sum_set f ) ) ) ) by CKB20:1
.= ( r * ( lower_bound ( rng ( upper_sum_set f ) ) ) ) by A3,A22,CKB19:1
.= ( r * ( upper_integral f ) ) by INTEGRA1:def 14
.= ( r * ( lower_integral f ) ) by A2,INTEGRA1:def 16;
hence ( upper_integral ( r (#) f ) ) = ( lower_integral ( r (#) f ) ) by A27;
( upper_integral ( r (#) f ) ) = ( r * ( upper_integral f ) ) by A2,A27,INTEGRA1:def 16
.= ( r * ( integral f ) ) by INTEGRA1:def 17;
hence ( upper_integral ( r (#) f ) ) = ( r * ( integral f ) );
end;
end;
(ex a st (for D being set holds (D in ( ( divs A ) /\ ( dom ( lower_sum_set ( r (#) f ) ) ) ) implies a >= ( ( lower_sum_set ( r (#) f ) ) . D ))))
proof
now
per cases ;
suppose A32: r >= ( 0 );

(for D being set holds (D in ( ( divs A ) /\ ( dom ( lower_sum_set ( r (#) f ) ) ) ) implies ( ( r * ( upper_bound ( rng f ) ) ) * ( vol A ) ) >= ( ( lower_sum_set ( r (#) f ) ) . D )))
proof
let D being set;
assume D in ( ( divs A ) /\ ( dom ( lower_sum_set ( r (#) f ) ) ) );
then D is (Division of A) by INTEGRA1:def 3;
hence thesis by A1,A32,CKB24:1;
end;
hence thesis;
end;
suppose A33: r < ( 0 );

(for D being set holds (D in ( ( divs A ) /\ ( dom ( lower_sum_set ( r (#) f ) ) ) ) implies ( ( r * ( lower_bound ( rng f ) ) ) * ( vol A ) ) >= ( ( lower_sum_set ( r (#) f ) ) . D )))
proof
let D being set;
assume D in ( ( divs A ) /\ ( dom ( lower_sum_set ( r (#) f ) ) ) );
then D is (Division of A) by INTEGRA1:def 3;
hence thesis by A1,A33,CKB25:1;
end;
hence thesis;
end;
end;
hence thesis;
end;
then ( ( lower_sum_set ( r (#) f ) ) | ( divs A ) ) is  bounded_above by RFUNCT_1:70;
then ( rng ( lower_sum_set ( r (#) f ) ) ) is  bounded_above by INTEGRA1:13;
then A34: ( r (#) f ) is  lower_integrable by INTEGRA1:def 13;
(ex a st (for D being set holds (D in ( ( divs A ) /\ ( dom ( upper_sum_set ( r (#) f ) ) ) ) implies a <= ( ( upper_sum_set ( r (#) f ) ) . D ))))
proof
now
per cases ;
suppose A35: r >= ( 0 );

(for D being set holds (D in ( ( divs A ) /\ ( dom ( upper_sum_set ( r (#) f ) ) ) ) implies ( ( r * ( lower_bound ( rng f ) ) ) * ( vol A ) ) <= ( ( upper_sum_set ( r (#) f ) ) . D )))
proof
let D being set;
assume D in ( ( divs A ) /\ ( dom ( upper_sum_set ( r (#) f ) ) ) );
then D is (Division of A) by INTEGRA1:def 3;
hence thesis by A1,A35,CKB22:1;
end;
hence thesis;
end;
suppose A36: r < ( 0 );

(for D being set holds (D in ( ( divs A ) /\ ( dom ( upper_sum_set ( r (#) f ) ) ) ) implies ( ( r * ( upper_bound ( rng f ) ) ) * ( vol A ) ) <= ( ( upper_sum_set ( r (#) f ) ) . D )))
proof
let D being set;
assume D in ( ( divs A ) /\ ( dom ( upper_sum_set ( r (#) f ) ) ) );
then D is (Division of A) by INTEGRA1:def 3;
hence thesis by A1,A36,CKB23:1;
end;
hence thesis;
end;
end;
hence thesis;
end;
then ( ( upper_sum_set ( r (#) f ) ) | ( divs A ) ) is  bounded_below by RFUNCT_1:71;
then ( rng ( upper_sum_set ( r (#) f ) ) ) is  bounded_below by INTEGRA1:11;
then ( r (#) f ) is  upper_integrable by INTEGRA1:def 12;
hence thesis by A34,A11,INTEGRA1:def 16,INTEGRA1:def 17;
end;
