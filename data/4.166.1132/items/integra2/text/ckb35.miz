environ
vocabularies NUMBERS,REAL_1,SUBSET_1,FINSEQ_1,INTEGRA1,XREAL_0,ORDINAL1,SEQ_4,XXREAL_0,XXREAL_1,VALUED_0,RELAT_1,ARYTM_3,FUNCT_1,CARD_1,NAT_1,CLASSES1,FINSEQ_5,ARYTM_1,ORDINAL4,XBOOLE_0,JORDAN3,MEMBERED,MEMBER_1,TARSKI,PARTFUN1,XXREAL_2,VALUED_1,MEASURE7,CARD_3,SEQ_1,INTEGRA2,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,CARD_1,NUMBERS,XXREAL_0,XREAL_0,XXREAL_2,XXREAL_3,MEMBERED,MEMBER_1,REAL_1,NAT_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,FINSEQ_1,RFUNCT_1,RVSUM_1,INTEGRA1,VALUED_1,SEQ_1,SEQ_2,SEQ_4,FINSEQ_6,RCOMP_1,FINSEQ_5,CLASSES1,RFINSEQ,MEASURE5,MEASURE6,CKB2,CKB7;
definitions TARSKI,XBOOLE_0,VALUED_1,RELAT_1,MEMBER_1,XXREAL_2,XXREAL_3,CKB2;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,NEWTON,RCOMP_1,NAT_1,RFINSEQ,CARD_1,FINSEQ_5,FINSEQ_3,RELAT_1,FUNCT_2,XREAL_0,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,MEMBERED,VALUED_1,XXREAL_2,TARSKI,SEQM_3,CLASSES1,FINSEQ_6,MEMBER_1,XXREAL_3,CKB1,CKB2,CKB4,CKB5,CKB6,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34;
schemes SUBSET_1,SEQ_1,NAT_1;
registrations RELAT_1,ORDINAL1,FUNCT_2,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FINSEQ_1,RFINSEQ,INTEGRA1,VALUED_0,VALUED_1,XXREAL_2,CARD_1,SEQ_2,RELSET_1,XXREAL_3,MEMBER_1,MEASURE5,CKB3;
constructors PARTFUN1,REAL_1,NAT_1,SEQM_3,RFUNCT_1,RFINSEQ,BINARITH,FINSEQ_5,FINSEQ_6,INTEGRA1,SEQ_1,XXREAL_2,NAT_D,RVSUM_1,SEQ_4,CLASSES1,RELSET_1,SEQ_2,MEMBER_1,MEASURE6,CKB2,CKB7;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve a for Real;
reserve x for Real;
reserve i for (Element of ( NAT ));
reserve A for non  empty  closed_interval (Subset of ( REAL ));
reserve f for (Function of A,( REAL ));
reserve D for (Division of A);
theorem
Th32: ((( f | A ) is  bounded & (for x holds (x in A implies ( f . x ) >= ( 0 )))) implies ( integral f ) >= ( 0 ))
proof
assume that
A1: ( f | A ) is  bounded
and
A2: (for x holds (x in A implies ( f . x ) >= ( 0 )));
A3: (for a being  real number holds (a in ( rng ( upper_sum_set f ) ) implies a >= ( 0 )))
proof
let a being  real number;
assume a in ( rng ( upper_sum_set f ) );
then consider D being (Element of ( divs A )) such that A4: (D in ( dom ( upper_sum_set f ) ) & a = ( ( upper_sum_set f ) . D )) by PARTFUN1:3;
reconsider D as (Division of A) by INTEGRA1:def 3;
A5: (for i being Nat holds (i in ( dom ( upper_volume (f,D) ) ) implies ( 0 ) <= ( ( upper_volume (f,D) ) . i )))
proof
let i being Nat;
set r = ( ( upper_volume (f,D) ) . i );
assume A6: i in ( dom ( upper_volume (f,D) ) );
( len D ) = ( len ( upper_volume (f,D) ) ) by INTEGRA1:def 6;
then A7: i in ( dom D ) by A6,FINSEQ_3:29;
A8: ( upper_bound ( rng ( f | ( divset (D,i) ) ) ) ) >= ( 0 )
proof
( rng f ) is  bounded_above by A1,INTEGRA1:13;
then A9: ( rng ( f | ( divset (D,i) ) ) ) is  bounded_above by RELAT_1:70,XXREAL_2:43;
(( dom ( f | ( divset (D,i) ) ) ) = ( ( dom f ) /\ ( divset (D,i) ) ) & ( dom f ) = A) by FUNCT_2:def 1,RELAT_1:61;
then ( dom ( f | ( divset (D,i) ) ) ) is non  empty non  empty (Subset of ( REAL )) by A7,INTEGRA1:8,XBOOLE_1:28;
then consider x such that A10: x in ( dom ( f | ( divset (D,i) ) ) ) by SUBSET_1:4;
( f . x ) >= ( 0 ) by A2,A10;
then A11: ( ( f | ( divset (D,i) ) ) . x ) >= ( 0 ) by A10,FUNCT_1:47;
( ( f | ( divset (D,i) ) ) . x ) in ( rng ( f | ( divset (D,i) ) ) ) by A10,FUNCT_1:def 3;
hence thesis by A9,A11,SEQ_4:def 1;
end;
A12: ( vol ( divset (D,i) ) ) >= ( 0 ) by INTEGRA1:9;
r = ( ( upper_bound ( rng ( f | ( divset (D,i) ) ) ) ) * ( vol ( divset (D,i) ) ) ) by A7,INTEGRA1:def 6;
hence thesis by A12,A8;
end;
a = ( upper_sum (f,D) ) by A4,INTEGRA1:def 10
.= ( Sum ( upper_volume (f,D) ) ) by INTEGRA1:def 8;
hence thesis by A5,RVSUM_1:84;
end;
(( upper_integral f ) = ( lower_bound ( rng ( upper_sum_set f ) ) ) & ( rng ( upper_sum_set f ) ) is non  empty) by INTEGRA1:def 14;
then ( upper_integral f ) >= ( 0 ) by A3,SEQ_4:43;
hence thesis by INTEGRA1:def 17;
end;
