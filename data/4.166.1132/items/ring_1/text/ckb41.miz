environ
vocabularies RLVECT_1,ALGSTR_0,XBOOLE_0,SUBSET_1,ARYTM_1,ARYTM_3,SUPINF_2,RELAT_1,INT_2,CARD_FIL,TARSKI,GROUP_4,IDEAL_1,VECTSP_2,GROUP_1,FUNCSDOM,EQREL_1,STRUCT_0,WAYBEL20,PARTFUN1,RELAT_2,SETWISEO,FUNCT_1,MESFUNC1,BINOP_1,VECTSP_1,LATTICES,WELLORD2,ORDERS_1,WELLORD1,RING_1;
notations TARSKI,XBOOLE_0,SUBSET_1,SETWISEO,RELAT_1,RELSET_1,FUNCT_1,PARTFUN1,ALG_1,RELAT_2,EQREL_1,WELLORD1,WELLORD2,ORDERS_1,BINOP_1,DOMAIN_1,STRUCT_0,ALGSTR_0,GROUP_1,RLVECT_1,VECTSP_1,VECTSP_2,FUNCSDOM,IDEAL_1,CKB4,CKB5,CKB6,CKB7,CKB16,CKB24,CKB25;
definitions TARSKI,XBOOLE_0,RELAT_1,RLVECT_1,GROUP_1,VECTSP_1,VECTSP_2,IDEAL_1,ORDERS_1,WELLORD1,STRUCT_0,ALGSTR_0,CKB4,CKB5,CKB6,CKB7,CKB16,CKB24;
theorems VECTSP_1,TARSKI,FUNCT_1,RLVECT_1,VECTSP_2,XBOOLE_0,FUNCT_2,BINOP_1,ZFMISC_1,GROUP_1,IDEAL_1,RELAT_1,EQREL_1,SETWISEO,ORDERS_1,WELLORD2,RELAT_2,SUBSET_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB27,CKB28,CKB29,CKB30,CKB31,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39;
schemes EQREL_1,BINOP_1;
registrations XBOOLE_0,SUBSET_1,RELSET_1,FINSUB_1,EQREL_1,STRUCT_0,VECTSP_1,ALGSTR_1,QUOFIELD,IDEAL_1,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB17,CKB26,CKB32,CKB33,CKB40;
constructors WELLORD1,WELLORD2,BINOP_1,SETWISEO,ORDERS_1,EQREL_1,GCD_1,IDEAL_1,DOMAIN_1,RELSET_1,CKB4,CKB5,CKB6,CKB7,CKB16,CKB24;
requirements BOOLE,SUBSET;
begin
registration
let R being non degenerated Ring;
cluster  maximal for (Ideal of R);
existence
proof
set S = { A where A is (Ideal of R): A is  proper };
set P = ( RelIncl S );
A1: P is_antisymmetric_in S by WELLORD2:21;
A2: ( field P ) = S by WELLORD2:def 1;
A3: S has_upper_Zorn_property_wrt P
proof
let Y being set;
assume that
A4: Y c= S
and
A5: ( P |_2 Y ) is  being_linear-order;
per cases ;
suppose A6: Y is  empty;

take x = ( { ( 0. R ) } -Ideal );
now
assume x is non proper;
then A7: x = (the carrier of R) by SUBSET_1:def 6;
x = { ( 0. R ) } by IDEAL_1:47;
then ( 1. R ) = ( 0. R ) by A7,TARSKI:def 1;
hence contradiction;
end;
hence x in S;
thus thesis by A6;
end;
suppose Y is non empty;

then consider e being set such that A8: e in Y by XBOOLE_0:def 1;
take x = ( union Y );
x c= (the carrier of R)
proof
let a being set;
assume a in x;
then consider Z being set such that A9: a in Z and A10: Z in Y by TARSKI:def 4;
Z in S by A4,A10;
then (ex A being (Ideal of R) st (Z = A & A is  proper));
hence thesis by A9;
end;
then reconsider B = x as (Subset of R);
A11: B is  right-ideal
proof
let p being (Element of R),a being (Element of R);
assume a in B;
then consider Aa being set such that A12: a in Aa and A13: Aa in Y by TARSKI:def 4;
Aa in S by A4,A13;
then consider Ia being (Ideal of R) such that A14: Aa = Ia and Ia is  proper;
(( a * p ) in Ia & Ia c= B) by A12,A13,A14,IDEAL_1:def 3,ZFMISC_1:74;
hence thesis;
end;
A15: B is  left-ideal
proof
let p being (Element of R),a being (Element of R);
assume a in B;
then consider Aa being set such that A16: a in Aa and A17: Aa in Y by TARSKI:def 4;
Aa in S by A4,A17;
then consider Ia being (Ideal of R) such that A18: Aa = Ia and Ia is  proper;
(( p * a ) in Ia & Ia c= B) by A16,A17,A18,IDEAL_1:def 2,ZFMISC_1:74;
hence thesis;
end;
A19:now
assume B is non proper;
then ( 1. R ) in B by A15,IDEAL_1:19;
then consider Aa being set such that A20: ( 1. R ) in Aa and A21: Aa in Y by TARSKI:def 4;
Aa in S by A4,A21;
then (ex Ia being (Ideal of R) st (Aa = Ia & Ia is  proper));
hence contradiction by A20,IDEAL_1:19;
end;
A22: B is  add-closed
proof
P is_reflexive_in ( field P ) by A2,WELLORD2:19;
then P is  reflexive by RELAT_2:def 9;
then A23: ( field ( P |_2 Y ) ) = Y by A2,A4,ORDERS_1:71;
let a being (Element of R),b being (Element of R);
A24:now
let A being (Ideal of R);
assume (a in A & b in A);
then A25: ( a + b ) in A by IDEAL_1:def 1;
assume A in Y;
hence ( a + b ) in B by A25,TARSKI:def 4;
end;
assume a in B;
then consider Aa being set such that A26: a in Aa and A27: Aa in Y by TARSKI:def 4;
Aa in S by A4,A27;
then A28: (ex Ia being (Ideal of R) st (Aa = Ia & Ia is  proper));
assume b in B;
then consider Ab being set such that A29: b in Ab and A30: Ab in Y by TARSKI:def 4;
( P |_2 Y ) is  connected by A5,ORDERS_1:def 5;
then ( P |_2 Y ) is_connected_in ( field ( P |_2 Y ) ) by RELAT_2:def 14;
then (([ Aa,Ab ] in ( P |_2 Y ) or [ Ab,Aa ] in ( P |_2 Y )) or Aa = Ab) by A27,A30,A23,RELAT_2:def 6;
then (([ Aa,Ab ] in P or [ Ab,Aa ] in P) or Aa = Ab) by XBOOLE_0:def 4;
then A31: (Aa c= Ab or Ab c= Aa) by A4,A27,A30,WELLORD2:def 1;
Ab in S by A4,A30;
then (ex Ib being (Ideal of R) st (Ab = Ib & Ib is  proper));
hence ( a + b ) in B by A26,A27,A29,A30,A24,A28,A31;
end;
e in S by A4,A8;
then consider A being (Ideal of R) such that A32: e = A and A is  proper;
(ex q being set st q in A) by XBOOLE_0:def 1;
then B is non empty by A8,A32,TARSKI:def 4;
hence A33: x in S by A22,A15,A11,A19;
let y being set;
assume A34: y in Y;
then y c= x by ZFMISC_1:74;
hence thesis by A4,A33,A34,WELLORD2:def 1;
end;
end;
(P is_reflexive_in S & P is_transitive_in S) by WELLORD2:19,WELLORD2:20;
then P partially_orders S by A1,ORDERS_1:def 7;
then consider x being set such that A35: x is_maximal_in P by A2,A3,ORDERS_1:63;
A36: x in ( field P ) by A35,ORDERS_1:def 11;
then consider I being (Ideal of R) such that A37: x = I and A38: I is  proper by A2;
take I;
thus I is  proper by A38;
let J being (Ideal of R);
assume that
A39: I c= J;
now
assume J is  proper;
then A40: J in S;
then [ I,J ] in P by A2,A36,A37,A39,WELLORD2:def 1;
hence I = J by A2,A35,A37,A40,ORDERS_1:def 11;
end;
hence thesis;
end;
end;
