environ
vocabularies NUMBERS,REAL_1,ZFMISC_1,NORMSP_1,PRE_TOPC,PARTFUN1,FUNCT_1,NAT_1,FDIFF_1,SUBSET_1,RELAT_1,RCOMP_1,TARSKI,SEQ_1,ARYTM_3,VALUED_1,FUNCT_2,ARYTM_1,SEQ_2,ORDINAL2,SUPINF_2,FCONT_1,COMPLEX1,STRUCT_0,CARD_1,VALUED_0,XXREAL_0,FUNCOP_1,XREAL_0,ORDINAL1,XXREAL_2,XBOOLE_0,XXREAL_1;
notations TARSKI,SUBSET_1,FUNCT_1,ORDINAL1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,NAT_1,VALUED_0,COMPLEX1,BINOP_2,VALUED_1,SEQ_1,SEQ_2,RCOMP_1,FDIFF_1,STRUCT_0,PRE_TOPC,RLVECT_1,VFUNCT_1,NORMSP_0,NORMSP_1,NDIFF_1,NFCONT_3,CKB3,CKB5,CKB6,CKB8,CKB15;
definitions RCOMP_1,SUBSET_1,XBOOLE_0,TARSKI,CKB3,CKB6,CKB15;
theorems TARSKI,ABSVALUE,XBOOLE_0,XBOOLE_1,RLVECT_1,XCMPLX_0,XCMPLX_1,ZFMISC_1,SEQ_1,SEQ_2,NAT_1,RELAT_1,FUNCT_1,VFUNCT_1,FUNCT_2,ORDINAL1,SEQ_4,NORMSP_1,LOPBAN_1,LOPBAN_3,PARTFUN1,PARTFUN2,FDIFF_1,NDIFF_1,FUNCOP_1,XREAL_1,COMPLEX1,XXREAL_0,VALUED_1,VALUED_0,NORMSP_0,XREAL_0,RCOMP_1,SEQM_3,RFUNCT_2,NFCONT_3,CKB1,CKB2,CKB3,CKB6,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15;
schemes FUNCT_2,SEQ_1;
registrations RELSET_1,STRUCT_0,ORDINAL1,XREAL_0,MEMBERED,FUNCT_2,NUMBERS,XBOOLE_0,VALUED_0,NORMSP_0,NORMSP_1,RELAT_1,SUBSET_1,XXREAL_0,LOPBAN_2,FUNCOP_1,NAT_1,RCOMP_1,VALUED_1,SEQ_4,FDIFF_1,CKB4,CKB7;
constructors REAL_1,FDIFF_1,VFUNCT_1,NDIFF_1,SEQ_1,RELSET_1,RVSUM_1,BINOP_2,INTEGR15,NAT_D,MEASURE6,NFCONT_3,CKB3,CKB6,CKB15;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve F for non  trivial RealNormSpace;
reserve x for Real;
reserve x0 for Real;
reserve g for Real;
reserve r for Real;
reserve s for Real;
reserve n for (Element of ( NAT ));
reserve s1 for Real_Sequence;
reserve f for (PartFunc of ( REAL ),(the carrier of F));
reserve R for (REST of F);
reserve R1 for (REST of F);
reserve L for (LINEAR of F);
reserve L1 for (LINEAR of F);
definition
let F;
let f;
let x0 being  real number;
assume A1: f is_differentiable_in x0;
func diff (f,x0) -> (Point of F) means 
:Def4: (ex N being (Neighbourhood of x0) st (N c= ( dom f ) & (ex L st (ex R st (it = ( L . 1 ) & (for x holds (x in N implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))))))));
existence
proof
consider N being (Neighbourhood of x0) such that A2: N c= ( dom f ) and A3: (ex L st (ex R st (for x holds (x in N implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))))) by A1,CKB15:def 1;
consider L,R such that A4: (for x holds (x in N implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))) by A3;
consider r being (Point of F) such that A5: (for p being Real holds ( L . p ) = ( p * r )) by CKB6:def 1;
take r;
( L . 1 ) = ( 1 * r ) by A5
.= r by RLVECT_1:def 8;
hence thesis by A2,A4;
end;
uniqueness
proof
let r being (Point of F);
let s being (Point of F);
assume that
A6: (ex N being (Neighbourhood of x0) st (N c= ( dom f ) & (ex L st (ex R st (r = ( L . 1 ) & (for x being Real holds (x in N implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))))))))
and
A7: (ex N being (Neighbourhood of x0) st (N c= ( dom f ) & (ex L st (ex R st (s = ( L . 1 ) & (for x being Real holds (x in N implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))))))));
consider N being (Neighbourhood of x0) such that N c= ( dom f ) and A8: (ex L st (ex R st (r = ( L . 1 ) & (for x being Real holds (x in N implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) )))))) by A6;
consider L,R such that A9: r = ( L . 1 ) and A10: (for x being Real holds (x in N implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))) by A8;
consider r1 being (Point of F) such that A11: (for p being Real holds ( L . p ) = ( p * r1 )) by CKB6:def 1;
consider N1 being (Neighbourhood of x0) such that N1 c= ( dom f ) and A12: (ex L st (ex R st (s = ( L . 1 ) & (for x being Real holds (x in N1 implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) )))))) by A7;
consider L1,R1 such that A13: s = ( L1 . 1 ) and A14: (for x being Real holds (x in N1 implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L1 . ( x - x0 ) ) + ( R1 /. ( x - x0 ) ) ))) by A12;
consider p1 being (Point of F) such that A15: (for p being Real holds ( L1 . p ) = ( p * p1 )) by CKB6:def 1;
consider N0 being (Neighbourhood of x0) such that A16: (N0 c= N & N0 c= N1) by RCOMP_1:17;
consider g being  real number such that A17: ( 0 ) < g and A18: N0 = ]. ( x0 - g ),( x0 + g ) .[ by RCOMP_1:def 6;
deffunc F((Element of ( NAT ))) = ( g / ( $1 + 2 ) );
consider s1 such that A19: (for n holds ( s1 . n ) = F(n)) from SEQ_1:sch 1;
now
let n;
( 0 ) <> ( g / ( n + 2 ) ) by A17,XREAL_1:139;
hence ( 0 ) <> ( s1 . n ) by A19;
end;
then A20: s1 is  non-zero by SEQ_1:5;
(s1 is  convergent & ( lim s1 ) = ( 0 )) by A19,SEQ_4:31;
then reconsider h = s1 as  convergent_to_0 Real_Sequence by A20,FDIFF_1:def 1;
A21: (for n holds (ex x being Real st ((x in N & x in N1) & ( h . n ) = ( x - x0 ))))
proof
let n;
take x = ( x0 + ( g / ( n + 2 ) ) );
reconsider z0 = ( 0 ) as (Element of ( NAT ));
( z0 + 1 ) < ( ( n + 1 ) + 1 ) by XREAL_1:6;
then ( g / ( n + 2 ) ) < ( g / 1 ) by A17,XREAL_1:76;
then A22: ( x0 + ( g / ( n + 2 ) ) ) < ( x0 + g ) by XREAL_1:6;
( 0 ) < ( g / ( n + 2 ) ) by A17,XREAL_1:139;
then ( x0 + ( - g ) ) < ( x0 + ( g / ( n + 2 ) ) ) by A17,XREAL_1:6;
then ( x0 + ( g / ( n + 2 ) ) ) in ]. ( x0 - g ),( x0 + g ) .[ by A22;
hence thesis by A16,A18,A19;
end;
A23: s = ( 1 * p1 ) by A13,A15;
A24: r = ( 1 * r1 ) by A9,A11;
A25:now
let x being Real;
assume that
A26: x in N
and
A27: x in N1;
( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ) by A10,A26;
then ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ) = ( ( L1 . ( x - x0 ) ) + ( R1 /. ( x - x0 ) ) ) by A14,A27;
then ( ( ( x - x0 ) * r1 ) + ( R /. ( x - x0 ) ) ) = ( ( L1 . ( x - x0 ) ) + ( R1 /. ( x - x0 ) ) ) by A11;
then ( ( ( ( x - x0 ) * 1 ) * r1 ) + ( R /. ( x - x0 ) ) ) = ( ( ( ( x - x0 ) * 1 ) * p1 ) + ( R1 /. ( x - x0 ) ) ) by A15;
then ( ( ( ( x - x0 ) * 1 ) * r ) + ( R /. ( x - x0 ) ) ) = ( ( ( ( x - x0 ) * 1 ) * p1 ) + ( R1 /. ( x - x0 ) ) ) by A24,RLVECT_1:def 7;
hence ( ( ( x - x0 ) * r ) + ( R /. ( x - x0 ) ) ) = ( ( ( x - x0 ) * s ) + ( R1 /. ( x - x0 ) ) ) by A23,RLVECT_1:def 7;
end;
now
R1 is  total by CKB3:def 1;
then ( dom R1 ) = ( REAL ) by PARTFUN1:def 2;
then A28: ( rng h ) c= ( dom R1 );
let n being Nat;
R is  total by CKB3:def 1;
then ( dom R ) = ( REAL ) by PARTFUN1:def 2;
then A29: ( rng h ) c= ( dom R );
A30: n in ( NAT ) by ORDINAL1:def 12;
then (ex x being Real st ((x in N & x in N1) & ( h . n ) = ( x - x0 ))) by A21;
then ( ( ( h . n ) * r ) + ( R /. ( h . n ) ) ) = ( ( ( h . n ) * s ) + ( R1 /. ( h . n ) ) ) by A25;
then ( ( ( 1 / ( h . n ) ) * ( ( h . n ) * r ) ) + ( ( 1 / ( h . n ) ) * ( R /. ( h . n ) ) ) ) = ( ( 1 / ( h . n ) ) * ( ( ( h . n ) * s ) + ( R1 /. ( h . n ) ) ) ) by RLVECT_1:def 5;
then ( ( ( ( 1 / ( h . n ) ) * ( h . n ) ) * r ) + ( ( 1 / ( h . n ) ) * ( R /. ( h . n ) ) ) ) = ( ( 1 / ( h . n ) ) * ( ( ( h . n ) * s ) + ( R1 /. ( h . n ) ) ) ) by RLVECT_1:def 7;
then A31: ( ( ( ( 1 / ( h . n ) ) * ( h . n ) ) * r ) + ( ( 1 / ( h . n ) ) * ( R /. ( h . n ) ) ) ) = ( ( ( 1 / ( h . n ) ) * ( ( h . n ) * s ) ) + ( ( 1 / ( h . n ) ) * ( R1 /. ( h . n ) ) ) ) by RLVECT_1:def 5;
A32: ( ( 1 / ( h . n ) ) * ( R /. ( h . n ) ) ) = ( ( ( h . n ) " ) * ( R /. ( h . n ) ) ) by XCMPLX_1:215
.= ( ( ( h " ) . n ) * ( R /. ( h . n ) ) ) by VALUED_1:10
.= ( ( ( h " ) . n ) * ( ( R /* h ) . n ) ) by A30,A29,FUNCT_2:109
.= ( ( ( h " ) (#) ( R /* h ) ) . n ) by A30,NDIFF_1:def 2;
h is  non-zero by FDIFF_1:def 1;
then A33: ( h . n ) <> ( 0 ) by A30,SEQ_1:5;
A34: ( ( 1 / ( h . n ) ) * ( R1 /. ( h . n ) ) ) = ( ( ( h . n ) " ) * ( R1 /. ( h . n ) ) ) by XCMPLX_1:215
.= ( ( ( h " ) . n ) * ( R1 /. ( h . n ) ) ) by VALUED_1:10
.= ( ( ( h " ) . n ) * ( ( R1 /* h ) . n ) ) by A30,A28,FUNCT_2:109
.= ( ( ( h " ) (#) ( R1 /* h ) ) . n ) by A30,NDIFF_1:def 2;
A35: ( ( ( 1 / ( h . n ) ) * ( h . n ) ) * s ) = ( 1 * s ) by A33,XCMPLX_1:106
.= s by RLVECT_1:def 8;
( ( ( 1 / ( h . n ) ) * ( h . n ) ) * r ) = ( 1 * r ) by A33,XCMPLX_1:106
.= r by RLVECT_1:def 8;
then ( r + ( ( ( h " ) (#) ( R /* h ) ) . n ) ) = ( s + ( ( ( h " ) (#) ( R1 /* h ) ) . n ) ) by A31,A35,A32,A34,RLVECT_1:def 7;
then ( r + ( ( ( ( h " ) (#) ( R /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) ) = ( ( s + ( ( ( h " ) (#) ( R1 /* h ) ) . n ) ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) by RLVECT_1:28;
then ( r + ( ( ( ( h " ) (#) ( R /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) ) = ( s + ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) ) by RLVECT_1:28;
then ( r + ( 0. F ) ) = ( s + ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) ) by RLVECT_1:15;
then r = ( s + ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) ) by RLVECT_1:4;
then ( r - s ) = ( ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) + ( s - s ) ) by RLVECT_1:28;
then ( r - s ) = ( ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) + ( 0. F ) ) by RLVECT_1:15;
then A36: ( r - s ) = ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) by RLVECT_1:4;
n is (Element of ( NAT )) by ORDINAL1:def 12;
hence ( r - s ) = ( ( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) . n ) by A36,NORMSP_1:def 3;
end;
then (( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) is  constant & ( ( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) . ( 0 ) ) = ( r - s )) by VALUED_0:def 18;
then A37: ( lim ( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) ) = ( r - s ) by NDIFF_1:18;
A38: (( ( h " ) (#) ( R1 /* h ) ) is  convergent & ( lim ( ( h " ) (#) ( R1 /* h ) ) ) = ( 0. F )) by CKB3:def 1;
(( ( h " ) (#) ( R /* h ) ) is  convergent & ( lim ( ( h " ) (#) ( R /* h ) ) ) = ( 0. F )) by CKB3:def 1;
then ( r - s ) = ( ( 0. F ) - ( 0. F ) ) by A37,A38,NORMSP_1:26;
hence thesis by RLVECT_1:13,RLVECT_1:21;
end;
end;
