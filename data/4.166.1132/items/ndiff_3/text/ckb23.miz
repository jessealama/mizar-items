environ
vocabularies NUMBERS,REAL_1,ZFMISC_1,NORMSP_1,PRE_TOPC,PARTFUN1,FUNCT_1,NAT_1,FDIFF_1,SUBSET_1,RELAT_1,RCOMP_1,TARSKI,SEQ_1,ARYTM_3,VALUED_1,FUNCT_2,ARYTM_1,SEQ_2,ORDINAL2,SUPINF_2,FCONT_1,COMPLEX1,STRUCT_0,CARD_1,VALUED_0,XXREAL_0,FUNCOP_1,XREAL_0,ORDINAL1,XXREAL_2,XBOOLE_0,XXREAL_1;
notations TARSKI,SUBSET_1,FUNCT_1,ORDINAL1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,NAT_1,VALUED_0,COMPLEX1,BINOP_2,VALUED_1,SEQ_1,SEQ_2,RCOMP_1,FDIFF_1,STRUCT_0,PRE_TOPC,RLVECT_1,VFUNCT_1,NORMSP_0,NORMSP_1,NDIFF_1,NFCONT_3,CKB3,CKB5,CKB6,CKB8,CKB15,CKB16,CKB17,CKB21;
definitions RCOMP_1,SUBSET_1,XBOOLE_0,TARSKI,CKB3,CKB6,CKB15,CKB16,CKB17,CKB21;
theorems TARSKI,ABSVALUE,XBOOLE_0,XBOOLE_1,RLVECT_1,XCMPLX_0,XCMPLX_1,ZFMISC_1,SEQ_1,SEQ_2,NAT_1,RELAT_1,FUNCT_1,VFUNCT_1,FUNCT_2,ORDINAL1,SEQ_4,NORMSP_1,LOPBAN_1,LOPBAN_3,PARTFUN1,PARTFUN2,FDIFF_1,NDIFF_1,FUNCOP_1,XREAL_1,COMPLEX1,XXREAL_0,VALUED_1,VALUED_0,NORMSP_0,XREAL_0,RCOMP_1,SEQM_3,RFUNCT_2,NFCONT_3,CKB1,CKB2,CKB3,CKB6,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22;
schemes FUNCT_2,SEQ_1;
registrations RELSET_1,STRUCT_0,ORDINAL1,XREAL_0,MEMBERED,FUNCT_2,NUMBERS,XBOOLE_0,VALUED_0,NORMSP_0,NORMSP_1,RELAT_1,SUBSET_1,XXREAL_0,LOPBAN_2,FUNCOP_1,NAT_1,RCOMP_1,VALUED_1,SEQ_4,FDIFF_1,CKB4,CKB7;
constructors REAL_1,FDIFF_1,VFUNCT_1,NDIFF_1,SEQ_1,RELSET_1,RVSUM_1,BINOP_2,INTEGR15,NAT_D,MEASURE6,NFCONT_3,CKB3,CKB6,CKB15,CKB16,CKB17,CKB21;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve F for non  trivial RealNormSpace;
reserve x for Real;
reserve x0 for Real;
reserve g for Real;
reserve r for Real;
reserve s for Real;
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve s1 for Real_Sequence;
reserve f for (PartFunc of ( REAL ),(the carrier of F));
reserve h for  convergent_to_0 Real_Sequence;
reserve c for  constant Real_Sequence;
reserve R for (REST of F);
reserve L for (LINEAR of F);
theorem
Th13: (for x0 being  real number holds (for N being (Neighbourhood of x0) holds ((f is_differentiable_in x0 & N c= ( dom f )) implies (for h holds (for c holds ((( rng c ) = { x0 } & ( rng ( h + c ) ) c= N) implies (( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) is  convergent & ( diff (f,x0) ) = ( lim ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ))))))))
proof
let x0 being  real number;
let N being (Neighbourhood of x0);
assume that
A1: f is_differentiable_in x0
and
A2: N c= ( dom f );
consider N1 being (Neighbourhood of x0) such that N1 c= ( dom f ) and A3: (ex L st (ex R st (for x holds (x in N1 implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))))) by A1,CKB15:def 1;
consider N2 being (Neighbourhood of x0) such that A4: N2 c= N and A5: N2 c= N1 by RCOMP_1:17;
A6: N2 c= ( dom f ) by A2,A4,XBOOLE_1:1;
let h;
let c;
assume that
A7: ( rng c ) = { x0 }
and
A8: ( rng ( h + c ) ) c= N;
consider g being  real number such that A9: ( 0 ) < g and A10: N2 = ]. ( x0 - g ),( x0 + g ) .[ by RCOMP_1:def 6;
reconsider z0 = ( 0 ) as Nat;
(( x0 + z0 ) < ( x0 + g ) & ( x0 - g ) < ( x0 - ( 0 ) )) by A9,XREAL_1:8,XREAL_1:15;
then A11: x0 in N2 by A10;
now
let y being set;
assume y in ( rng c );
then y = x0 by A7,TARSKI:def 1;
then y in N by A4,A11;
hence y in ( dom f ) by A2;
end;
then A12: ( rng c ) c= ( dom f ) by TARSKI:def 3;
(ex n st (( rng ( c ^\ n ) ) c= N2 & ( rng ( ( h + c ) ^\ n ) ) c= N2))
proof
x0 in ( rng c ) by A7,TARSKI:def 1;
then A13: ( lim c ) = x0 by SEQ_4:25;
A14: h is  convergent by FDIFF_1:def 1;
then A15: ( h + c ) is  convergent by SEQ_2:5;
reconsider z0 = ( 0 ) as Real;
( lim h ) = z0 by FDIFF_1:def 1;
then ( lim ( h + c ) ) = ( z0 + x0 ) by A13,A14,SEQ_2:6
.= x0;
then consider n such that A16: (for m being (Element of ( NAT )) holds (n <= m implies ( abs ( ( ( h + c ) . m ) - x0 ) ) < g)) by A9,A15,SEQ_2:def 7;
take n;
A17: ( rng ( c ^\ n ) ) = { x0 } by A7,VALUED_0:26;
(for y being set holds (y in ( rng ( c ^\ n ) ) implies y in N2)) by A11,A17,TARSKI:def 1;
hence ( rng ( c ^\ n ) ) c= N2 by TARSKI:def 3;
now
let y being set;
assume y in ( rng ( ( h + c ) ^\ n ) );
then consider m such that A18: y = ( ( ( h + c ) ^\ n ) . m ) by FUNCT_2:113;
reconsider z0 = ( 0 ) as Nat;
( n + z0 ) <= ( n + m ) by XREAL_1:7;
then A19: ( abs ( ( ( h + c ) . ( n + m ) ) - x0 ) ) < g by A16;
then ( ( ( h + c ) . ( m + n ) ) - x0 ) < g by SEQ_2:1;
then ( ( ( ( h + c ) ^\ n ) . m ) - x0 ) < g by NAT_1:def 3;
then A20: ( ( ( h + c ) ^\ n ) . m ) < ( x0 + g ) by XREAL_1:19;
( - g ) < ( ( ( h + c ) . ( m + n ) ) - x0 ) by A19,SEQ_2:1;
then ( - g ) < ( ( ( ( h + c ) ^\ n ) . m ) - x0 ) by NAT_1:def 3;
then ( x0 + ( - g ) ) < ( ( ( h + c ) ^\ n ) . m ) by XREAL_1:20;
hence y in N2 by A10,A18,A20;
end;
hence ( rng ( ( h + c ) ^\ n ) ) c= N2 by TARSKI:def 3;
end;
then consider n such that ( rng ( c ^\ n ) ) c= N2 and A21: ( rng ( ( h + c ) ^\ n ) ) c= N2;
consider L,R such that A22: (for x holds (x in N1 implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))) by A3;
now
let y being set;
assume A23: y in ( rng ( c ^\ n ) );
( rng ( c ^\ n ) ) = ( rng c ) by VALUED_0:26;
then y = x0 by A7,A23,TARSKI:def 1;
then y in N by A4,A11;
hence y in ( dom f ) by A2;
end;
then A24: ( rng ( c ^\ n ) ) c= ( dom f ) by TARSKI:def 3;
A25: (( ( ( h ^\ n ) " ) (#) ( ( L /* ( h ^\ n ) ) + ( R /* ( h ^\ n ) ) ) ) is  convergent & ( lim ( ( ( h ^\ n ) " ) (#) ( ( L /* ( h ^\ n ) ) + ( R /* ( h ^\ n ) ) ) ) ) = ( L . 1 ))
proof
deffunc F0((Element of ( NAT ))) = ( ( L . 1 ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . $1 ) );
consider s1 being (sequence of (the carrier of F)) such that A26: (for k holds ( s1 . k ) = F0(k)) from FUNCT_2:sch 4;
A27:now
A28: (( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) is  convergent & ( lim ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) ) = ( 0. F )) by CKB3:def 1;
let r being Real;
assume ( 0 ) < r;
then consider m being (Element of ( NAT )) such that A29: (for k being (Element of ( NAT )) holds (m <= k implies ||. ( ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . k ) - ( 0. F ) ) .|| < r)) by A28,NORMSP_1:def 7;
take n1 = m;
let k;
assume that
A30: n1 <= k;
A31: ||. ( ( s1 . k ) - ( L . 1 ) ) .|| = ||. ( ( ( L . 1 ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . k ) ) - ( L . 1 ) ) .|| by A26
.= ||. ( ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . k ) + ( ( L . 1 ) - ( L . 1 ) ) ) .|| by RLVECT_1:28
.= ||. ( ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . k ) + ( 0. F ) ) .|| by RLVECT_1:15
.= ||. ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . k ) .|| by RLVECT_1:4;
||. ( ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . k ) - ( 0. F ) ) .|| < r by A29,A30;
hence ||. ( ( s1 . k ) - ( L . 1 ) ) .|| < r by A31,RLVECT_1:13;
end;
consider s being (Point of F) such that A32: (for p1 being Real holds ( L . p1 ) = ( p1 * s )) by CKB6:def 1;
A33: ( L . 1 ) = ( 1 * s ) by A32
.= s by RLVECT_1:def 8;
now
let m;
( h ^\ n ) is  non-zero by FDIFF_1:def 1;
then A34: ( ( h ^\ n ) . m ) <> ( 0 ) by SEQ_1:5;
thus ( ( ( ( h ^\ n ) " ) (#) ( ( L /* ( h ^\ n ) ) + ( R /* ( h ^\ n ) ) ) ) . m ) = ( ( ( ( ( h ^\ n ) " ) (#) ( L /* ( h ^\ n ) ) ) + ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) ) . m ) by NDIFF_1:9
.= ( ( ( ( ( h ^\ n ) " ) (#) ( L /* ( h ^\ n ) ) ) . m ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . m ) ) by NORMSP_1:def 2
.= ( ( ( ( ( h ^\ n ) " ) . m ) * ( ( L /* ( h ^\ n ) ) . m ) ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . m ) ) by NDIFF_1:def 2
.= ( ( ( ( ( h ^\ n ) " ) . m ) * ( L . ( ( h ^\ n ) . m ) ) ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . m ) ) by FUNCT_2:115
.= ( ( ( ( ( h ^\ n ) " ) . m ) * ( ( ( h ^\ n ) . m ) * s ) ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . m ) ) by A32
.= ( ( ( ( ( h ^\ n ) . m ) " ) * ( ( ( h ^\ n ) . m ) * s ) ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . m ) ) by VALUED_1:10
.= ( ( ( ( ( ( h ^\ n ) . m ) " ) * ( ( h ^\ n ) . m ) ) * s ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . m ) ) by RLVECT_1:def 7
.= ( ( 1 * s ) + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . m ) ) by A34,XCMPLX_0:def 7
.= ( s + ( ( ( ( h ^\ n ) " ) (#) ( R /* ( h ^\ n ) ) ) . m ) ) by RLVECT_1:def 8
.= ( s1 . m ) by A26,A33;
end;
then A35: ( ( ( h ^\ n ) " ) (#) ( ( L /* ( h ^\ n ) ) + ( R /* ( h ^\ n ) ) ) ) = s1 by FUNCT_2:63;
hence ( ( ( h ^\ n ) " ) (#) ( ( L /* ( h ^\ n ) ) + ( R /* ( h ^\ n ) ) ) ) is  convergent by A27,NORMSP_1:def 6;
hence thesis by A35,A27,NORMSP_1:def 7;
end;
now
let y being set;
assume y in ( rng ( ( h + c ) ^\ n ) );
then y in N2 by A21;
then y in N by A4;
hence y in ( dom f ) by A2;
end;
then A36: ( rng ( ( h + c ) ^\ n ) ) c= ( dom f ) by TARSKI:def 3;
now
let y being set;
assume y in ( rng ( h + c ) );
then y in N by A8;
hence y in ( dom f ) by A2;
end;
then A37: ( rng ( h + c ) ) c= ( dom f ) by TARSKI:def 3;
A38: (for k holds ( ( f /. ( ( ( h + c ) ^\ n ) . k ) ) - ( f /. ( ( c ^\ n ) . k ) ) ) = ( ( L . ( ( h ^\ n ) . k ) ) + ( R /. ( ( h ^\ n ) . k ) ) ))
proof
let k;
( ( ( h + c ) ^\ n ) . k ) in ( rng ( ( h + c ) ^\ n ) ) by VALUED_0:28;
then A39: ( ( ( h + c ) ^\ n ) . k ) in N2 by A21;
(( ( c ^\ n ) . k ) in ( rng ( c ^\ n ) ) & ( rng ( c ^\ n ) ) = ( rng c )) by VALUED_0:26,VALUED_0:28;
then A40: ( ( c ^\ n ) . k ) = x0 by A7,TARSKI:def 1;
( ( ( ( h + c ) ^\ n ) . k ) - ( ( c ^\ n ) . k ) ) = ( ( ( ( h ^\ n ) + ( c ^\ n ) ) . k ) - ( ( c ^\ n ) . k ) ) by SEQM_3:15
.= ( ( ( ( h ^\ n ) . k ) + ( ( c ^\ n ) . k ) ) - ( ( c ^\ n ) . k ) ) by SEQ_1:7
.= ( ( h ^\ n ) . k );
hence thesis by A22,A5,A39,A40;
end;
A41: R is  total by CKB3:def 1;
now
let k;
( dom R ) = ( REAL ) by A41,FUNCT_2:def 1;
then A42: ( rng ( h ^\ n ) ) c= ( dom R );
thus ( ( ( f /* ( ( h + c ) ^\ n ) ) - ( f /* ( c ^\ n ) ) ) . k ) = ( ( ( f /* ( ( h + c ) ^\ n ) ) . k ) - ( ( f /* ( c ^\ n ) ) . k ) ) by NORMSP_1:def 3
.= ( ( f /. ( ( ( h + c ) ^\ n ) . k ) ) - ( ( f /* ( c ^\ n ) ) . k ) ) by A36,FUNCT_2:109
.= ( ( f /. ( ( ( h + c ) ^\ n ) . k ) ) - ( f /. ( ( c ^\ n ) . k ) ) ) by A24,FUNCT_2:109
.= ( ( L . ( ( h ^\ n ) . k ) ) + ( R /. ( ( h ^\ n ) . k ) ) ) by A38
.= ( ( ( L /* ( h ^\ n ) ) . k ) + ( R /. ( ( h ^\ n ) . k ) ) ) by FUNCT_2:115
.= ( ( ( L /* ( h ^\ n ) ) . k ) + ( ( R /* ( h ^\ n ) ) . k ) ) by A42,FUNCT_2:109
.= ( ( ( L /* ( h ^\ n ) ) + ( R /* ( h ^\ n ) ) ) . k ) by NORMSP_1:def 2;
end;
then ( ( f /* ( ( h + c ) ^\ n ) ) - ( f /* ( c ^\ n ) ) ) = ( ( L /* ( h ^\ n ) ) + ( R /* ( h ^\ n ) ) ) by FUNCT_2:63;
then A43: ( ( ( h ^\ n ) " ) (#) ( ( L /* ( h ^\ n ) ) + ( R /* ( h ^\ n ) ) ) ) = ( ( ( h ^\ n ) " ) (#) ( ( ( f /* ( h + c ) ) ^\ n ) - ( f /* ( c ^\ n ) ) ) ) by A37,VALUED_0:27
.= ( ( ( h ^\ n ) " ) (#) ( ( ( f /* ( h + c ) ) ^\ n ) - ( ( f /* c ) ^\ n ) ) ) by A12,VALUED_0:27
.= ( ( ( h ^\ n ) " ) (#) ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) by NDIFF_1:16
.= ( ( ( h " ) ^\ n ) (#) ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) by SEQM_3:18
.= ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ^\ n ) by CKB2:1;
then A44: ( L . 1 ) = ( lim ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) by A25,LOPBAN_3:11;
thus ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) is  convergent by A25,A43,LOPBAN_3:10;
(for x holds (x in N2 implies ( ( f /. x ) - ( f /. x0 ) ) = ( ( L . ( x - x0 ) ) + ( R /. ( x - x0 ) ) ))) by A22,A5;
hence thesis by A1,A6,A44,CKB16:def 1;
end;
