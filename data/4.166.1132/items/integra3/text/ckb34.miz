environ
vocabularies FINSEQ_1,ARYTM_1,INTEGRA1,RELAT_1,ORDINAL2,FUNCT_1,CARD_1,FUNCT_3,SEQ_2,JORDAN3,RFINSEQ,INTEGRA2,FDIFF_1,ARYTM_3,SEQ_4,CLASSES1,VALUED_0,XBOOLE_0,NUMBERS,MEASURE7,XREAL_0,REAL_1,SUBSET_1,XXREAL_2,ORDINAL1,XXREAL_0,NAT_1,TARSKI,ORDINAL4,COMPLEX1,CARD_3,XXREAL_1,PARTFUN1,SEQ_1,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,CARD_1,NUMBERS,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,FUNCT_2,XXREAL_2,SEQ_4,VALUED_0,PARTFUN1,MEASURE6,FINSEQ_1,RFUNCT_1,RVSUM_1,INTEGRA1,SEQ_1,SEQ_2,FINSEQ_6,RCOMP_1,FDIFF_1,SQUARE_1,CLASSES1,RFINSEQ,MEASURE5,INTEGRA2,CKB3,CKB4;
definitions TARSKI,RVSUM_1,CKB3,CKB4;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,RFINSEQ,TARSKI,FINSEQ_5,FINSEQ_3,FINSEQ_4,FINSEQ_6,INTEGRA2,RELAT_1,XREAL_0,FUNCT_2,XBOOLE_0,XBOOLE_1,XREAL_1,COMPLEX1,XXREAL_0,FINSOP_1,ORDINAL1,XXREAL_2,SEQM_3,CLASSES1,MEASURE5,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33;
schemes FINSEQ_2,NAT_1,SEQ_1;
registrations XBOOLE_0,RELAT_1,ORDINAL1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,FINSEQ_1,SEQM_3,INTEGRA1,INTEGRA2,VALUED_0,FUNCT_2,FINSET_1,XXREAL_2,CARD_1,SEQ_2,MEASURE5;
constructors PARTFUN1,REAL_1,SQUARE_1,NAT_1,COMPLEX1,FINSOP_1,RFUNCT_1,FDIFF_1,RFINSEQ,BINARITH,MEASURE6,FINSEQ_6,INTEGRA2,SEQ_1,BINOP_2,XXREAL_2,NAT_D,RVSUM_1,CLASSES1,SEQ_4,RELSET_1,SEQ_2,CKB3,CKB4;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve a for Real;
reserve e for Real;
reserve x for Real;
reserve y for Real;
reserve i for (Element of ( NAT ));
reserve j for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve x1 for set;
reserve A for non  empty  closed_interval (Subset of ( REAL ));
reserve D for (Division of A);
reserve D1 for (Division of A);
reserve D2 for (Division of A);
reserve f for (Function of A,( REAL ));
reserve T for (DivSequence of A);
theorem
(((( f | A ) is  bounded & ( delta T ) is  convergent_to_0) & ( vol A ) <> ( 0 )) implies (( lower_sum (f,T) ) is  convergent & ( lim ( lower_sum (f,T) ) ) = ( lower_integral f )))
proof
assume that
A1: ( f | A ) is  bounded
and
A2: ( delta T ) is  convergent_to_0
and
A3: ( vol A ) <> ( 0 );
A4: ( delta T ) is  convergent by A2,FDIFF_1:def 1;
A5: (for D holds (for D1 holds (ex D2 st ((((D <= D2 & D1 <= D2) & ( rng D2 ) = ( ( rng D1 ) \/ ( rng D ) )) & ( 0 ) <= ( ( lower_sum (f,D2) ) - ( lower_sum (f,D) ) )) & ( 0 ) <= ( ( lower_sum (f,D2) ) - ( lower_sum (f,D1) ) )))))
proof
let D;
let D1;
consider D2 such that A6: D <= D2 and A7: D1 <= D2 and A8: ( rng D2 ) = ( ( rng D1 ) \/ ( rng D ) ) by CKB8:1;
A9: ( ( lower_sum (f,D2) ) - ( lower_sum (f,D1) ) ) >= ( 0 ) by A1,A7,INTEGRA1:46,XREAL_1:48;
( ( lower_sum (f,D2) ) - ( lower_sum (f,D) ) ) >= ( 0 ) by A1,A6,INTEGRA1:46,XREAL_1:48;
hence thesis by A6,A7,A8,A9;
end;
A10: (for D holds (for D1 holds (( delta D1 ) < ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) implies (ex D2 st (((D <= D2 & D1 <= D2) & ( rng D2 ) = ( ( rng D1 ) \/ ( rng D ) )) & ( ( lower_sum (f,D2) ) - ( lower_sum (f,D1) ) ) <= ( ( ( len D ) * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) ))))))
proof
let D;
let D1;
assume A11: ( delta D1 ) < ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) );
(ex D2 st (((D <= D2 & D1 <= D2) & ( rng D2 ) = ( ( rng D1 ) \/ ( rng D ) )) & ( ( lower_sum (f,D2) ) - ( lower_sum (f,D1) ) ) <= ( ( ( len D ) * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) )))
proof
consider D2 such that A12: D <= D2 and A13: D1 <= D2 and A14: ( rng D2 ) = ( ( rng D1 ) \/ ( rng D ) ) and ( 0 ) <= ( ( lower_sum (f,D2) ) - ( lower_sum (f,D) ) ) and ( 0 ) <= ( ( lower_sum (f,D2) ) - ( lower_sum (f,D1) ) ) by A5;
( ( lower_sum (f,D2) ) - ( lower_sum (f,D1) ) ) <= ( ( ( len D ) * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) )
proof
deffunc LVf((Division of A)) = ( lower_volume (f,$1) );
deffunc PLf((Division of A),Nat) = ( ( PartSums ( lower_volume (f,$1) ) ) . $2 );
A15: ( len D2 ) in ( dom D2 ) by FINSEQ_5:6;
A16: (for i holds (i in ( dom D ) implies (ex j st ((j in ( dom D1 ) & ( D . i ) in ( divset (D1,j) )) & ( PLf(D2,( indx (D2,D1,j) )) - PLf(D1,j) ) <= ( ( i * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) )))))
proof
defpred P[ non  empty Nat ]
 means
($1 in ( dom D ) implies (ex j st ((j in ( dom D1 ) & ( D . $1 ) in ( divset (D1,j) )) & ( PLf(D2,( indx (D2,D1,j) )) - PLf(D1,j) ) <= ( ( $1 * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) ))));
let i;
assume A17: i in ( dom D );
then A18: i in ( Seg ( len D ) ) by FINSEQ_1:def 3;
A19: (for i holds (for j holds (((i in ( dom D ) & j in ( dom D1 )) & ( D . i ) in ( divset (D1,j) )) implies j >= 2)))
proof
let i;
let j;
assume A20: i in ( dom D );
assume that
A21: j in ( dom D1 )
and
A22: ( D . i ) in ( divset (D1,j) );
assume j < 2;
then j < ( 1 + 1 );
then A23: j <= 1 by NAT_1:13;
j in ( Seg ( len D1 ) ) by A21,FINSEQ_1:def 3;
then j >= 1 by FINSEQ_1:1;
then j = 1 by A23,XXREAL_0:1;
then A24: ( lower_bound ( divset (D1,j) ) ) = ( lower_bound A ) by A21,INTEGRA1:def 4;
A25: ( D . i ) <= ( upper_bound ( divset (D1,j) ) ) by A22,INTEGRA2:1;
( delta D1 ) >= ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) )
proof
per cases ;
suppose A26: i = 1;

( len D ) in ( Seg ( len D ) ) by FINSEQ_1:3;
then 1 <= ( len D ) by FINSEQ_1:1;
then A27: 1 in ( Seg ( len D ) ) by FINSEQ_1:1;
then A28: 1 in ( dom D ) by FINSEQ_1:def 3;
then A29: ( lower_bound ( divset (D,1) ) ) = ( lower_bound A ) by INTEGRA1:def 4;
1 in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by A27,INTEGRA1:def 6;
then A30: 1 in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
( vol ( divset (D,1) ) ) = ( ( upper_volume (( chi (A,A) ),D) ) . 1 ) by A28,INTEGRA1:20;
then ( vol ( divset (D,1) ) ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by A30,FUNCT_1:def 3;
then A31: ( vol ( divset (D,1) ) ) >= ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by XXREAL_2:def 7;
A32: ( upper_bound ( divset (D,1) ) ) = ( D . 1 ) by A28,INTEGRA1:def 4;
( ( upper_bound ( divset (D1,j) ) ) - ( lower_bound A ) ) >= ( ( D . 1 ) - ( lower_bound A ) ) by A25,A26,XREAL_1:9;
then ( vol ( divset (D1,j) ) ) >= ( ( upper_bound ( divset (D,1) ) ) - ( lower_bound ( divset (D,1) ) ) ) by A24,A29,A32,INTEGRA1:def 5;
then A33: ( vol ( divset (D1,j) ) ) >= ( vol ( divset (D,1) ) ) by INTEGRA1:def 5;
( vol ( divset (D1,j) ) ) <= ( delta D1 ) by A21,CKB16:1;
then ( delta D1 ) >= ( vol ( divset (D,1) ) ) by A33,XXREAL_0:2;
hence thesis by A31,XXREAL_0:2;
end;
suppose A34: i <> 1;

then ( D . ( i - 1 ) ) in A by A20,INTEGRA1:7;
then A35: ( lower_bound A ) <= ( D . ( i - 1 ) ) by INTEGRA2:1;
( lower_bound ( divset (D,i) ) ) = ( D . ( i - 1 ) ) by A20,A34,INTEGRA1:def 4;
then A36: ( ( upper_bound ( divset (D,i) ) ) - ( lower_bound A ) ) >= ( ( upper_bound ( divset (D,i) ) ) - ( lower_bound ( divset (D,i) ) ) ) by A35,XREAL_1:10;
( upper_bound ( divset (D,i) ) ) = ( D . i ) by A20,A34,INTEGRA1:def 4;
then ( ( upper_bound ( divset (D1,j) ) ) - ( lower_bound ( divset (D1,j) ) ) ) >= ( ( upper_bound ( divset (D,i) ) ) - ( lower_bound A ) ) by A25,A24,XREAL_1:9;
then ( ( upper_bound ( divset (D1,j) ) ) - ( lower_bound ( divset (D1,j) ) ) ) >= ( ( upper_bound ( divset (D,i) ) ) - ( lower_bound ( divset (D,i) ) ) ) by A36,XXREAL_0:2;
then ( vol ( divset (D1,j) ) ) >= ( ( upper_bound ( divset (D,i) ) ) - ( lower_bound ( divset (D,i) ) ) ) by INTEGRA1:def 5;
then A37: ( vol ( divset (D1,j) ) ) >= ( vol ( divset (D,i) ) ) by INTEGRA1:def 5;
i in ( Seg ( len D ) ) by A20,FINSEQ_1:def 3;
then i in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by INTEGRA1:def 6;
then A38: i in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
( vol ( divset (D,i) ) ) = ( ( upper_volume (( chi (A,A) ),D) ) . i ) by A20,INTEGRA1:20;
then ( vol ( divset (D,i) ) ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by A38,FUNCT_1:def 3;
then A39: ( vol ( divset (D,i) ) ) >= ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by XXREAL_2:def 7;
( vol ( divset (D1,j) ) ) <= ( delta D1 ) by A21,CKB16:1;
then ( delta D1 ) >= ( vol ( divset (D,i) ) ) by A37,XXREAL_0:2;
hence thesis by A39,XXREAL_0:2;
end;
end;
hence contradiction by A11;
end;
A40: P[ 1 ]
proof
( len D ) in ( Seg ( len D ) ) by FINSEQ_1:3;
then 1 <= ( len D ) by FINSEQ_1:1;
then A41: 1 in ( dom D ) by FINSEQ_3:25;
then consider j such that A42: j in ( dom D1 ) and A43: ( D . 1 ) in ( divset (D1,j) ) by CKB7:1,INTEGRA1:6;
( PLf(D2,( indx (D2,D1,j) )) - PLf(D1,j) ) <= ( ( 1 * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) )
proof
A44: j <> 1 by A19,A41,A42,A43;
then reconsider j1 = ( j - 1 ) as (Element of ( NAT )) by A42,INTEGRA1:7;
A45: j1 in ( dom D1 ) by A42,A44,INTEGRA1:7;
then j1 in ( Seg ( len D1 ) ) by FINSEQ_1:def 3;
then j1 in ( Seg ( len ( lower_volume (f,D1) ) ) ) by INTEGRA1:def 7;
then A46: j1 in ( dom ( lower_volume (f,D1) ) ) by FINSEQ_1:def 3;
A47: ( j - 1 ) in ( dom D1 ) by A42,A44,INTEGRA1:7;
then A48: ( indx (D2,D1,j1) ) in ( dom D2 ) by A13,INTEGRA1:def 19;
then A49: ( indx (D2,D1,j1) ) in ( Seg ( len D2 ) ) by FINSEQ_1:def 3;
then A50: 1 <= ( indx (D2,D1,j1) ) by FINSEQ_1:1;
then ( mid (D2,1,( indx (D2,D1,j1) )) ) is  increasing by A48,INTEGRA1:35;
then A51: ( D2 | ( indx (D2,D1,j1) ) ) is  increasing by A50,FINSEQ_6:116;
j < ( j + 1 ) by NAT_1:13;
then j1 < j by XREAL_1:19;
then A52: ( indx (D2,D1,j1) ) < ( indx (D2,D1,j) ) by A13,A42,A45,CKB12:1;
then A53: ( ( indx (D2,D1,j1) ) + 1 ) <= ( indx (D2,D1,j) ) by NAT_1:13;
A54: ( ( Sum ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) - ( Sum ( mid (( lower_volume (f,D1) ),j,j) ) ) ) <= ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta D1 ) )
proof
A55: ( ( indx (D2,D1,j) ) - ( indx (D2,D1,j1) ) ) <= 2
proof
reconsider ID1 = ( ( indx (D2,D1,j1) ) + 1 ) as (Element of ( NAT ));
reconsider ID2 = ( ID1 + 1 ) as (Element of ( NAT ));
assume ( ( indx (D2,D1,j) ) - ( indx (D2,D1,j1) ) ) > 2;
then A56: ( ( indx (D2,D1,j1) ) + ( 1 + 1 ) ) < ( indx (D2,D1,j) ) by XREAL_1:20;
A57: ID1 < ID2 by NAT_1:13;
then ( indx (D2,D1,j1) ) <= ID2 by NAT_1:13;
then A58: 1 <= ID2 by A50,XXREAL_0:2;
A59: ( indx (D2,D1,j) ) in ( dom D2 ) by A13,A42,INTEGRA1:def 19;
then A60: ( indx (D2,D1,j) ) <= ( len D2 ) by FINSEQ_3:25;
then ID2 <= ( len D2 ) by A56,XXREAL_0:2;
then ID2 in ( Seg ( len D2 ) ) by A58,FINSEQ_1:1;
then A61: ID2 in ( dom D2 ) by FINSEQ_1:def 3;
then A62: ( D2 . ID2 ) < ( D2 . ( indx (D2,D1,j) ) ) by A56,A59,SEQM_3:def 1;
A63: 1 <= ID1 by A50,NAT_1:13;
A64: ( D1 . j ) = ( D2 . ( indx (D2,D1,j) ) ) by A13,A42,INTEGRA1:def 19;
ID1 <= ( indx (D2,D1,j) ) by A56,A57,XXREAL_0:2;
then ID1 <= ( len D2 ) by A60,XXREAL_0:2;
then ID1 in ( Seg ( len D2 ) ) by A63,FINSEQ_1:1;
then A65: ID1 in ( dom D2 ) by FINSEQ_1:def 3;
then A66: ( D2 . ID1 ) < ( D2 . ID2 ) by A57,A61,SEQM_3:def 1;
( indx (D2,D1,j1) ) < ID1 by NAT_1:13;
then A67: ( D2 . ( indx (D2,D1,j1) ) ) < ( D2 . ID1 ) by A48,A65,SEQM_3:def 1;
A68: ( D1 . j1 ) = ( D2 . ( indx (D2,D1,j1) ) ) by A13,A45,INTEGRA1:def 19;
A69: ((not ( D2 . ID1 ) in ( rng D1 )) & (not ( D2 . ID2 ) in ( rng D1 )))
proof
assume A70: (( D2 . ID1 ) in ( rng D1 ) or ( D2 . ID2 ) in ( rng D1 ));
per cases  by A70;
suppose ( D2 . ID1 ) in ( rng D1 );

then consider n such that A71: n in ( dom D1 ) and A72: ( D1 . n ) = ( D2 . ID1 ) by PARTFUN1:3;
j1 < n by A45,A67,A68,A71,A72,SEQ_4:137;
then A73: j < ( n + 1 ) by XREAL_1:19;
( D2 . ID1 ) < ( D2 . ( indx (D2,D1,j) ) ) by A66,A62,XXREAL_0:2;
then n < j by A42,A64,A71,A72,SEQ_4:137;
hence contradiction by A73,NAT_1:13;
end;
suppose ( D2 . ID2 ) in ( rng D1 );

then consider n such that A74: n in ( dom D1 ) and A75: ( D1 . n ) = ( D2 . ID2 ) by PARTFUN1:3;
( D2 . ( indx (D2,D1,j1) ) ) < ( D2 . ID2 ) by A67,A66,XXREAL_0:2;
then j1 < n by A45,A68,A74,A75,SEQ_4:137;
then A76: j < ( n + 1 ) by XREAL_1:19;
n < j by A42,A62,A64,A74,A75,SEQ_4:137;
hence contradiction by A76,NAT_1:13;
end;
end;
( upper_bound ( divset (D1,j) ) ) = ( D1 . j ) by A42,A44,INTEGRA1:def 4;
then A77: ( upper_bound ( divset (D1,j) ) ) = ( D2 . ( indx (D2,D1,j) ) ) by A13,A42,INTEGRA1:def 19;
( lower_bound ( divset (D1,j) ) ) = ( D1 . j1 ) by A42,A44,INTEGRA1:def 4;
then A78: ( lower_bound ( divset (D1,j) ) ) = ( D2 . ( indx (D2,D1,j1) ) ) by A13,A45,INTEGRA1:def 19;
( D2 . ID2 ) in ( ( rng D ) \/ ( rng D1 ) ) by A14,A61,FUNCT_1:def 3;
then A79: ( D2 . ID2 ) in ( rng D ) by A69,XBOOLE_0:def 3;
( D2 . ID1 ) in ( ( rng D ) \/ ( rng D1 ) ) by A14,A65,FUNCT_1:def 3;
then A80: ( D2 . ID1 ) in ( rng D ) by A69,XBOOLE_0:def 3;
( D2 . ( indx (D2,D1,j1) ) ) <= ( D2 . ID2 ) by A67,A66,XXREAL_0:2;
then ( D2 . ID2 ) in ( divset (D1,j) ) by A62,A78,A77,INTEGRA2:1;
then A81: ( D2 . ID2 ) in ( ( rng D ) /\ ( divset (D1,j) ) ) by A79,XBOOLE_0:def 4;
( D2 . ID1 ) <= ( D2 . ( indx (D2,D1,j) ) ) by A66,A62,XXREAL_0:2;
then ( D2 . ID1 ) in ( divset (D1,j) ) by A67,A78,A77,INTEGRA2:1;
then ( D2 . ID1 ) in ( ( rng D ) /\ ( divset (D1,j) ) ) by A80,XBOOLE_0:def 4;
hence contradiction by A11,A42,A57,A65,A61,A81,CKB9:1,SEQ_4:138;
end;
A82: 1 <= ( ( indx (D2,D1,j1) ) + 1 ) by A50,NAT_1:13;
j <= ( len D1 ) by A42,FINSEQ_3:25;
then A83: j <= ( len ( lower_volume (f,D1) ) ) by INTEGRA1:def 7;
A84: 1 <= j by A42,FINSEQ_3:25;
then A85: ( ( mid (( lower_volume (f,D1) ),j,j) ) . 1 ) = ( ( lower_volume (f,D1) ) . j ) by A83,FINSEQ_6:118;
( ( j -' j ) + 1 ) = 1 by CKB1:1;
then ( len ( mid (( lower_volume (f,D1) ),j,j) ) ) = 1 by A84,A83,FINSEQ_6:118;
then ( mid (( lower_volume (f,D1) ),j,j) ) = <* ( ( lower_volume (f,D1) ) . j ) *> by A85,FINSEQ_1:40;
then A86: ( Sum ( mid (( lower_volume (f,D1) ),j,j) ) ) = ( ( lower_volume (f,D1) ) . j ) by FINSOP_1:11;
( indx (D2,D1,j) ) in ( dom D2 ) by A13,A42,INTEGRA1:def 19;
then A87: ( indx (D2,D1,j) ) in ( Seg ( len D2 ) ) by FINSEQ_1:def 3;
then A88: 1 <= ( indx (D2,D1,j) ) by FINSEQ_1:1;
( indx (D2,D1,j) ) in ( Seg ( len ( lower_volume (f,D2) ) ) ) by A87,INTEGRA1:def 7;
then A89: ( indx (D2,D1,j) ) <= ( len ( lower_volume (f,D2) ) ) by FINSEQ_1:1;
then A90: ( ( indx (D2,D1,j1) ) + 1 ) <= ( len ( lower_volume (f,D2) ) ) by A53,XXREAL_0:2;
then ( ( indx (D2,D1,j1) ) + 1 ) in ( Seg ( len ( lower_volume (f,D2) ) ) ) by A82,FINSEQ_1:1;
then A91: ( ( indx (D2,D1,j1) ) + 1 ) in ( Seg ( len D2 ) ) by INTEGRA1:def 7;
then A92: ( ( indx (D2,D1,j1) ) + 1 ) in ( dom D2 ) by FINSEQ_1:def 3;
( ( indx (D2,D1,j) ) -' ( ( indx (D2,D1,j1) ) + 1 ) ) = ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,j1) ) + 1 ) ) by A53,XREAL_1:233;
then ( ( ( indx (D2,D1,j) ) -' ( ( indx (D2,D1,j1) ) + 1 ) ) + 1 ) <= 2 by A55;
then A93: ( len ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) <= 2 by A53,A88,A89,A82,A90,FINSEQ_6:118;
( ( ( indx (D2,D1,j) ) -' ( ( indx (D2,D1,j1) ) + 1 ) ) + 1 ) >= ( ( 0 ) + 1 ) by XREAL_1:6;
then A94: 1 <= ( len ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) by A53,A88,A89,A82,A90,FINSEQ_6:118;
now
per cases  by A94,A93,CKB2:1;
suppose A95: ( len ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) = 1;

( upper_bound ( divset (D1,j) ) ) = ( D1 . j ) by A42,A44,INTEGRA1:def 4;
then A96: ( upper_bound ( divset (D1,j) ) ) = ( D2 . ( indx (D2,D1,j) ) ) by A13,A42,INTEGRA1:def 19;
( lower_bound ( divset (D1,j) ) ) = ( D1 . j1 ) by A42,A44,INTEGRA1:def 4;
then ( lower_bound ( divset (D1,j) ) ) = ( D2 . ( indx (D2,D1,j1) ) ) by A13,A45,INTEGRA1:def 19;
then A97: ( divset (D1,j) ) = [. ( D2 . ( indx (D2,D1,j1) ) ),( D2 . ( indx (D2,D1,j) ) ) .] by A96,INTEGRA1:4;
A98: ( delta D1 ) >= ( 0 ) by CKB13:1;
A99: ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) >= ( 0 ) by A1,CKB14:1,XREAL_1:48;
A100: ( indx (D2,D1,j) ) in ( dom D2 ) by A13,A42,INTEGRA1:def 19;
( ( ( indx (D2,D1,j) ) -' ( ( indx (D2,D1,j1) ) + 1 ) ) + 1 ) = 1 by A53,A88,A89,A82,A90,A95,FINSEQ_6:118;
then A101: ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,j1) ) + 1 ) ) = ( 0 ) by A53,XREAL_1:233;
then ( indx (D2,D1,j) ) <> 1 by A49,FINSEQ_1:1;
then A102: ( upper_bound ( divset (D2,( indx (D2,D1,j) )) ) ) = ( D2 . ( indx (D2,D1,j) ) ) by A100,INTEGRA1:def 4;
( ( indx (D2,D1,j) ) - 1 ) = ( indx (D2,D1,j1) ) by A101;
then ( lower_bound ( divset (D2,( indx (D2,D1,j) )) ) ) = ( D2 . ( indx (D2,D1,j1) ) ) by A50,A101,A100,INTEGRA1:def 4;
then A103: ( divset (D2,( indx (D2,D1,j) )) ) = ( divset (D1,j) ) by A97,A102,INTEGRA1:4;
( ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) . 1 ) = ( ( lower_volume (f,D2) ) . ( ( indx (D2,D1,j1) ) + 1 ) ) by A88,A89,A82,A90,FINSEQ_6:118;
then ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) = <* ( ( lower_volume (f,D2) ) . ( ( indx (D2,D1,j1) ) + 1 ) ) *> by A95,FINSEQ_1:40;
then ( Sum ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) = ( ( lower_volume (f,D2) ) . ( ( indx (D2,D1,j1) ) + 1 ) ) by FINSOP_1:11
.= ( ( lower_bound ( rng ( f | ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) ) ) * ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) ) by A92,INTEGRA1:def 7
.= ( Sum ( mid (( lower_volume (f,D1) ),j,j) ) ) by A42,A86,A101,A103,INTEGRA1:def 7;
hence thesis by A98,A99;
end;
suppose A104: ( len ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) = 2;

A105: ( ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) . 1 ) = ( ( lower_volume (f,D2) ) . ( ( indx (D2,D1,j1) ) + 1 ) ) by A88,A89,A82,A90,FINSEQ_6:118;
A106: ( 2 + ( ( indx (D2,D1,j1) ) + 1 ) ) >= ( ( 0 ) + 1 ) by XREAL_1:7;
( ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) . 2 ) = ( LVf(D2) . ( ( 2 + ( ( indx (D2,D1,j1) ) + 1 ) ) -' 1 ) ) by A53,A88,A89,A82,A90,A104,FINSEQ_6:118
.= ( LVf(D2) . ( ( 2 + ( ( indx (D2,D1,j1) ) + 1 ) ) - 1 ) ) by A106,XREAL_1:233
.= ( LVf(D2) . ( ( indx (D2,D1,j1) ) + ( 1 + 1 ) ) );
then ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) = <* ( ( lower_volume (f,D2) ) . ( ( indx (D2,D1,j1) ) + 1 ) ),( ( lower_volume (f,D2) ) . ( ( indx (D2,D1,j1) ) + 2 ) ) *> by A104,A105,FINSEQ_1:44;
then A107: ( Sum ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) = ( ( ( lower_volume (f,D2) ) . ( ( indx (D2,D1,j1) ) + 1 ) ) + ( ( lower_volume (f,D2) ) . ( ( indx (D2,D1,j1) ) + 2 ) ) ) by RVSUM_1:77;
A108: ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) >= ( 0 ) by INTEGRA1:9;
( upper_bound ( divset (D1,j) ) ) = ( D1 . j ) by A42,A44,INTEGRA1:def 4;
then A109: ( upper_bound ( divset (D1,j) ) ) = ( D2 . ( indx (D2,D1,j) ) ) by A13,A42,INTEGRA1:def 19;
A110: ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) >= ( 0 ) by INTEGRA1:9;
( ( ( indx (D2,D1,j) ) -' ( ( indx (D2,D1,j1) ) + 1 ) ) + 1 ) = 2 by A53,A88,A89,A82,A90,A104,FINSEQ_6:118;
then A111: ( ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,j1) ) + 1 ) ) + 1 ) = 2 by A53,XREAL_1:233;
then A112: ( ( indx (D2,D1,j1) ) + 2 ) in ( dom D2 ) by A13,A42,INTEGRA1:def 19;
( lower_bound ( divset (D1,j) ) ) = ( D1 . j1 ) by A42,A44,INTEGRA1:def 4;
then ( lower_bound ( divset (D1,j) ) ) = ( D2 . ( indx (D2,D1,j1) ) ) by A13,A45,INTEGRA1:def 19;
then A113: ( vol ( divset (D1,j) ) ) = ( ( ( ( D2 . ( ( indx (D2,D1,j1) ) + 2 ) ) - ( D2 . ( ( indx (D2,D1,j1) ) + 1 ) ) ) + ( D2 . ( ( indx (D2,D1,j1) ) + 1 ) ) ) - ( D2 . ( indx (D2,D1,j1) ) ) ) by A109,A111,INTEGRA1:def 5;
( ( indx (D2,D1,j1) ) + 1 ) in ( Seg ( len ( lower_volume (f,D2) ) ) ) by A82,A90,FINSEQ_1:1;
then ( ( indx (D2,D1,j1) ) + 1 ) in ( Seg ( len D2 ) ) by INTEGRA1:def 7;
then A114: ( ( indx (D2,D1,j1) ) + 1 ) in ( dom D2 ) by FINSEQ_1:def 3;
A115: ( ( indx (D2,D1,j1) ) + 1 ) <> 1 by A50,NAT_1:13;
then A116: ( upper_bound ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) = ( D2 . ( ( indx (D2,D1,j1) ) + 1 ) ) by A114,INTEGRA1:def 4;
( ( ( indx (D2,D1,j1) ) + 1 ) - 1 ) = ( ( indx (D2,D1,j1) ) + ( 0 ) );
then A117: ( lower_bound ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) = ( D2 . ( indx (D2,D1,j1) ) ) by A114,A115,INTEGRA1:def 4;
A118: ( ( ( indx (D2,D1,j1) ) + 1 ) + 1 ) > 1 by A82,NAT_1:13;
( ( ( indx (D2,D1,j1) ) + 2 ) - 1 ) = ( ( indx (D2,D1,j1) ) + 1 );
then A119: ( lower_bound ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) = ( D2 . ( ( indx (D2,D1,j1) ) + 1 ) ) by A112,A118,INTEGRA1:def 4;
( upper_bound ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) = ( D2 . ( ( indx (D2,D1,j1) ) + 2 ) ) by A112,A118,INTEGRA1:def 4;
then ( vol ( divset (D1,j) ) ) = ( ( ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) + ( D2 . ( ( indx (D2,D1,j1) ) + 1 ) ) ) - ( D2 . ( indx (D2,D1,j1) ) ) ) by A119,A113,INTEGRA1:def 5
.= ( ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) + ( ( upper_bound ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) - ( lower_bound ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) ) ) by A117,A116;
then A120: ( vol ( divset (D1,j) ) ) = ( ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) + ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) ) by INTEGRA1:def 5;
then A121: ( ( lower_volume (f,D1) ) . j ) = ( ( lower_bound ( rng ( f | ( divset (D1,j) ) ) ) ) * ( ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) + ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) ) ) by A42,INTEGRA1:def 7;
A122: ( ( Sum ( mid (LVf(D2),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) - ( Sum ( mid (LVf(D1),j,j) ) ) ) <= ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) + ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) ) )
proof
set ID2 = ( ( indx (D2,D1,j1) ) + 2 );
set ID1 = ( ( indx (D2,D1,j1) ) + 1 );
set B = ( vol ( divset (D2,ID1) ) );
set C = ( vol ( divset (D2,ID2) ) );
( divset (D1,j) ) c= A by A42,INTEGRA1:8;
then A123: ( lower_bound ( rng ( f | ( divset (D1,j) ) ) ) ) >= ( lower_bound ( rng f ) ) by A1,CKB15:1;
ID1 in ( dom D2 ) by A91,FINSEQ_1:def 3;
then ( divset (D2,ID1) ) c= A by INTEGRA1:8;
then ( lower_bound ( rng ( f | ( divset (D2,ID1) ) ) ) ) <= ( upper_bound ( rng f ) ) by A1,CKB15:1;
then A124: ( ( lower_bound ( rng ( f | ( divset (D2,ID1) ) ) ) ) * ( vol ( divset (D2,ID1) ) ) ) <= ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID1) ) ) ) by A108,XREAL_1:64;
( ( ( indx (D2,D1,j) ) -' ( ( indx (D2,D1,j1) ) + 1 ) ) + 1 ) = 2 by A53,A88,A89,A82,A90,A104,FINSEQ_6:118;
then A125: ( ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,j1) ) + 1 ) ) + 1 ) = 2 by A53,XREAL_1:233;
A126: ( indx (D2,D1,j) ) in ( dom D2 ) by A13,A42,INTEGRA1:def 19;
then ( divset (D2,ID2) ) c= A by A125,INTEGRA1:8;
then A127: ( lower_bound ( rng ( f | ( divset (D2,ID2) ) ) ) ) <= ( upper_bound ( rng f ) ) by A1,CKB15:1;
reconsider A = ( lower_bound ( rng ( f | ( divset (D1,j) ) ) ) ) as  real number;
A128: ( ( ( lower_volume (f,D1) ) . j ) - ( A * B ) ) = ( A * C ) by A121;
( ( lower_bound ( rng ( f | ( divset (D1,j) ) ) ) ) * ( vol ( divset (D2,ID2) ) ) ) >= ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) by A110,A123,XREAL_1:64;
then ( Sum ( mid (LVf(D1),j,j) ) ) >= ( ( ( lower_bound ( rng ( f | ( divset (D1,j) ) ) ) ) * ( vol ( divset (D2,ID1) ) ) ) + ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) ) by A86,A128,XREAL_1:19;
then A129: ( ( Sum ( mid (LVf(D1),j,j) ) ) - ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) ) >= ( ( lower_bound ( rng ( f | ( divset (D1,j) ) ) ) ) * ( vol ( divset (D2,ID1) ) ) ) by XREAL_1:19;
( ( lower_bound ( rng ( f | ( divset (D1,j) ) ) ) ) * ( vol ( divset (D2,ID1) ) ) ) >= ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID1) ) ) ) by A108,A123,XREAL_1:64;
then ( ( Sum ( mid (LVf(D1),j,j) ) ) - ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) ) >= ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID1) ) ) ) by A129,XXREAL_0:2;
then A130: ( Sum ( mid (LVf(D1),j,j) ) ) >= ( ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) + ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID1) ) ) ) ) by XREAL_1:19;
( Sum ( mid (LVf(D2),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) = ( ( ( lower_bound ( rng ( f | ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) ) ) * ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) ) + ( LVf(D2) . ( ( indx (D2,D1,j1) ) + 1 ) ) ) by A107,A126,A125,INTEGRA1:def 7
.= ( ( ( lower_bound ( rng ( f | ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) ) ) * ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 2 )) ) ) ) + ( ( lower_bound ( rng ( f | ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) ) ) * ( vol ( divset (D2,( ( indx (D2,D1,j1) ) + 1 )) ) ) ) ) by A92,INTEGRA1:def 7;
then ( ( Sum ( mid (LVf(D2),ID1,( indx (D2,D1,j) )) ) ) - ( ( lower_bound ( rng ( f | ( divset (D2,ID1) ) ) ) ) * ( vol ( divset (D2,ID1) ) ) ) ) <= ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) by A110,A127,XREAL_1:64;
then ( Sum ( mid (LVf(D2),ID1,( indx (D2,D1,j) )) ) ) <= ( ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) + ( ( lower_bound ( rng ( f | ( divset (D2,ID1) ) ) ) ) * ( vol ( divset (D2,ID1) ) ) ) ) by XREAL_1:20;
then ( ( Sum ( mid (LVf(D2),ID1,( indx (D2,D1,j) )) ) ) - ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) ) <= ( ( lower_bound ( rng ( f | ( divset (D2,ID1) ) ) ) ) * ( vol ( divset (D2,ID1) ) ) ) by XREAL_1:20;
then ( ( Sum ( mid (LVf(D2),ID1,( indx (D2,D1,j) )) ) ) - ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) ) <= ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID1) ) ) ) by A124,XXREAL_0:2;
then ( Sum ( mid (LVf(D2),ID1,( indx (D2,D1,j) )) ) ) <= ( ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) + ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID1) ) ) ) ) by XREAL_1:20;
then ( ( Sum ( mid (LVf(D2),ID1,( indx (D2,D1,j) )) ) ) - ( Sum ( mid (LVf(D1),j,j) ) ) ) <= ( ( ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) + ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,ID1) ) ) ) ) - ( ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID2) ) ) ) + ( ( lower_bound ( rng f ) ) * ( vol ( divset (D2,ID1) ) ) ) ) ) by A130,XREAL_1:13;
hence thesis;
end;
( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) >= ( 0 ) by A1,CKB14:1,XREAL_1:48;
then ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( vol ( divset (D1,j) ) ) ) <= ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta D1 ) ) by A42,CKB16:1,XREAL_1:64;
hence thesis by A120,A122,XXREAL_0:2;
end;
end;
hence thesis;
end;
j < ( j + 1 ) by NAT_1:13;
then A131: j1 < j by XREAL_1:19;
( indx (D2,D1,j) ) in ( dom D2 ) by A13,A42,INTEGRA1:def 19;
then A132: ( indx (D2,D1,j) ) in ( Seg ( len D2 ) ) by FINSEQ_1:def 3;
then A133: 1 <= ( indx (D2,D1,j) ) by FINSEQ_1:1;
A134: ( indx (D2,D1,j1) ) <= ( len D2 ) by A49,FINSEQ_1:1;
then A135: ( len ( D2 | ( indx (D2,D1,j1) ) ) ) = ( indx (D2,D1,j1) ) by FINSEQ_1:59;
A136: j1 in ( Seg ( len D1 ) ) by A47,FINSEQ_1:def 3;
then A137: j1 <= ( len D1 ) by FINSEQ_1:1;
(for x1 holds (x1 in ( rng ( D1 | j1 ) ) implies x1 in ( rng ( D2 | ( indx (D2,D1,j1) ) ) )))
proof
let x1;
assume x1 in ( rng ( D1 | j1 ) );
then consider k such that A138: k in ( dom ( D1 | j1 ) ) and A139: x1 = ( ( D1 | j1 ) . k ) by PARTFUN1:3;
k in ( Seg ( len ( D1 | j1 ) ) ) by A138,FINSEQ_1:def 3;
then A140: k in ( Seg j1 ) by A137,FINSEQ_1:59;
then A141: k in ( dom D1 ) by A45,RFINSEQ:6;
k <= j1 by A140,FINSEQ_1:1;
then ( D1 . k ) <= ( D1 . j1 ) by A47,A141,SEQ_4:137;
then ( D2 . ( indx (D2,D1,k) ) ) <= ( D1 . j1 ) by A13,A141,INTEGRA1:def 19;
then A142: ( D2 . ( indx (D2,D1,k) ) ) <= ( D2 . ( indx (D2,D1,j1) ) ) by A13,A47,INTEGRA1:def 19;
A143: ( ( D1 | j1 ) . k ) = ( D1 . k ) by A45,A140,RFINSEQ:6;
( D1 . k ) in ( rng D1 ) by A141,FUNCT_1:def 3;
then x1 in ( rng D2 ) by A14,A139,A143,XBOOLE_0:def 3;
then consider n such that A144: n in ( dom D2 ) and A145: x1 = ( D2 . n ) by PARTFUN1:3;
( D2 . ( indx (D2,D1,k) ) ) = ( D2 . n ) by A13,A139,A143,A141,A145,INTEGRA1:def 19;
then A146: n <= ( indx (D2,D1,j1) ) by A48,A144,A142,SEQM_3:def 1;
1 <= n by A144,FINSEQ_3:25;
then A147: n in ( Seg ( indx (D2,D1,j1) ) ) by A146,FINSEQ_1:1;
then n in ( Seg ( len ( D2 | ( indx (D2,D1,j1) ) ) ) ) by A134,FINSEQ_1:59;
then A148: n in ( dom ( D2 | ( indx (D2,D1,j1) ) ) ) by FINSEQ_1:def 3;
( D2 . n ) = ( ( D2 | ( indx (D2,D1,j1) ) ) . n ) by A48,A147,RFINSEQ:6;
hence thesis by A145,A148,FUNCT_1:def 3;
end;
then A149: ( rng ( D1 | j1 ) ) c= ( rng ( D2 | ( indx (D2,D1,j1) ) ) ) by TARSKI:def 3;
A150: 1 <= j1 by A136,FINSEQ_1:1;
( lower_bound ( divset (D1,j) ) ) <= ( D . 1 ) by A43,INTEGRA2:1;
then A151: ( D1 . j1 ) <= ( D . 1 ) by A42,A44,INTEGRA1:def 4;
(for x1 holds (x1 in ( rng ( D2 | ( indx (D2,D1,j1) ) ) ) implies x1 in ( rng ( D1 | j1 ) )))
proof
let x1;
assume x1 in ( rng ( D2 | ( indx (D2,D1,j1) ) ) );
then consider k such that A152: k in ( dom ( D2 | ( indx (D2,D1,j1) ) ) ) and A153: x1 = ( ( D2 | ( indx (D2,D1,j1) ) ) . k ) by PARTFUN1:3;
k in ( Seg ( len ( D2 | ( indx (D2,D1,j1) ) ) ) ) by A152,FINSEQ_1:def 3;
then A154: k in ( Seg ( indx (D2,D1,j1) ) ) by A134,FINSEQ_1:59;
then A155: k in ( dom D2 ) by A48,RFINSEQ:6;
A156: ( len ( D1 | j1 ) ) = j1 by A137,FINSEQ_1:59;
k <= ( indx (D2,D1,j1) ) by A154,FINSEQ_1:1;
then ( D2 . k ) <= ( D2 . ( indx (D2,D1,j1) ) ) by A48,A155,SEQ_4:137;
then A157: ( D2 . k ) <= ( D1 . j1 ) by A13,A47,INTEGRA1:def 19;
A158: (( D2 . k ) in ( rng D1 ) implies ( D2 . k ) in ( rng ( D1 | j1 ) ))
proof
assume ( D2 . k ) in ( rng D1 );
then consider m such that A159: m in ( dom D1 ) and A160: ( D2 . k ) = ( D1 . m ) by PARTFUN1:3;
m in ( Seg ( len D1 ) ) by A159,FINSEQ_1:def 3;
then A161: 1 <= m by FINSEQ_1:1;
A162: m <= j1 by A45,A157,A159,A160,SEQM_3:def 1;
then m in ( Seg j1 ) by A161,FINSEQ_1:1;
then A163: ( D2 . k ) = ( ( D1 | j1 ) . m ) by A45,A160,RFINSEQ:6;
m in ( dom ( D1 | j1 ) ) by A156,A161,A162,FINSEQ_3:25;
hence thesis by A163,FUNCT_1:def 3;
end;
A164: (( D2 . k ) in ( rng D ) implies ( D2 . k ) = ( D1 . j1 ))
proof
assume ( D2 . k ) in ( rng D );
then consider n such that A165: n in ( dom D ) and A166: ( D2 . k ) = ( D . n ) by PARTFUN1:3;
1 <= n by A165,FINSEQ_3:25;
then ( D . 1 ) <= ( D2 . k ) by A41,A165,A166,SEQ_4:137;
then ( D1 . j1 ) <= ( D2 . k ) by A151,XXREAL_0:2;
hence thesis by A157,XXREAL_0:1;
end;
A167: (( D2 . k ) in ( rng D ) implies ( D2 . k ) in ( rng ( D1 | j1 ) ))
proof
j1 in ( Seg ( len ( D1 | j1 ) ) ) by A150,A156,FINSEQ_1:1;
then j1 in ( dom ( D1 | j1 ) ) by FINSEQ_1:def 3;
then A168: ( ( D1 | j1 ) . j1 ) in ( rng ( D1 | j1 ) ) by FUNCT_1:def 3;
assume A169: ( D2 . k ) in ( rng D );
j1 in ( Seg j1 ) by A150,FINSEQ_1:1;
hence thesis by A45,A164,A169,A168,RFINSEQ:6;
end;
( D2 . k ) in ( rng D2 ) by A155,FUNCT_1:def 3;
hence thesis by A14,A48,A153,A154,A167,A158,RFINSEQ:6,XBOOLE_0:def 3;
end;
then ( rng ( D2 | ( indx (D2,D1,j1) ) ) ) c= ( rng ( D1 | j1 ) ) by TARSKI:def 3;
then A170: ( rng ( D2 | ( indx (D2,D1,j1) ) ) ) = ( rng ( D1 | j1 ) ) by A149,XBOOLE_0:def 10;
( mid (D1,1,j1) ) is  increasing by A42,A44,A150,INTEGRA1:7,INTEGRA1:35;
then A171: ( D1 | j1 ) is  increasing by A150,FINSEQ_6:116;
then A172: ( D2 | ( indx (D2,D1,j1) ) ) = ( D1 | j1 ) by A51,A170,CKB10:1;
A173: (for k holds ((1 <= k & k <= j1) implies k = ( indx (D2,D1,k) )))
proof
let k;
assume that
A174: 1 <= k
and
A175: k <= j1;
assume A176: k <> ( indx (D2,D1,k) );
now
per cases  by A176,XXREAL_0:1;
suppose A177: k > ( indx (D2,D1,k) );

k <= ( len D1 ) by A137,A175,XXREAL_0:2;
then A178: k in ( dom D1 ) by A174,FINSEQ_3:25;
then ( indx (D2,D1,k) ) in ( dom D2 ) by A13,INTEGRA1:def 19;
then ( indx (D2,D1,k) ) in ( Seg ( len D2 ) ) by FINSEQ_1:def 3;
then A179: 1 <= ( indx (D2,D1,k) ) by FINSEQ_1:1;
A180: ( indx (D2,D1,k) ) < j1 by A175,A177,XXREAL_0:2;
then A181: ( indx (D2,D1,k) ) in ( Seg j1 ) by A179,FINSEQ_1:1;
( indx (D2,D1,k) ) <= ( indx (D2,D1,j1) ) by A13,A45,A175,A178,CKB11:1;
then ( indx (D2,D1,k) ) in ( Seg ( indx (D2,D1,j1) ) ) by A179,FINSEQ_1:1;
then A182: ( ( D2 | ( indx (D2,D1,j1) ) ) . ( indx (D2,D1,k) ) ) = ( D2 . ( indx (D2,D1,k) ) ) by A48,RFINSEQ:6;
( indx (D2,D1,k) ) <= ( len D1 ) by A137,A180,XXREAL_0:2;
then ( indx (D2,D1,k) ) in ( dom D1 ) by A179,FINSEQ_3:25;
then A183: ( D1 . k ) > ( D1 . ( indx (D2,D1,k) ) ) by A177,A178,SEQM_3:def 1;
( D1 . k ) = ( D2 . ( indx (D2,D1,k) ) ) by A13,A178,INTEGRA1:def 19;
hence contradiction by A45,A172,A182,A183,A181,RFINSEQ:6;
end;
suppose A184: k < ( indx (D2,D1,k) );

k <= ( len D1 ) by A137,A175,XXREAL_0:2;
then A185: k in ( dom D1 ) by A174,FINSEQ_3:25;
then ( indx (D2,D1,k) ) <= ( indx (D2,D1,j1) ) by A13,A45,A175,CKB11:1;
then A186: k <= ( indx (D2,D1,j1) ) by A184,XXREAL_0:2;
then k <= ( len D2 ) by A134,XXREAL_0:2;
then A187: k in ( dom D2 ) by A174,FINSEQ_3:25;
k in ( Seg j1 ) by A174,A175,FINSEQ_1:1;
then A188: ( D1 . k ) = ( ( D1 | j1 ) . k ) by A47,RFINSEQ:6;
( indx (D2,D1,k) ) in ( dom D2 ) by A13,A185,INTEGRA1:def 19;
then A189: ( D2 . k ) < ( D2 . ( indx (D2,D1,k) ) ) by A184,A187,SEQM_3:def 1;
A190: k in ( Seg ( indx (D2,D1,j1) ) ) by A174,A186,FINSEQ_1:1;
( D1 . k ) = ( D2 . ( indx (D2,D1,k) ) ) by A13,A185,INTEGRA1:def 19;
hence contradiction by A48,A172,A188,A189,A190,RFINSEQ:6;
end;
end;
hence contradiction;
end;
A191: (for k being Nat holds ((1 <= k & k <= ( len ( ( lower_volume (f,D1) ) | j1 ) )) implies ( ( ( lower_volume (f,D1) ) | j1 ) . k ) = ( ( ( lower_volume (f,D2) ) | ( indx (D2,D1,j1) ) ) . k )))
proof
( indx (D2,D1,j1) ) in ( Seg ( len D2 ) ) by A48,FINSEQ_1:def 3;
then ( indx (D2,D1,j1) ) in ( Seg ( len ( lower_volume (f,D2) ) ) ) by INTEGRA1:def 7;
then A192: ( indx (D2,D1,j1) ) in ( dom ( lower_volume (f,D2) ) ) by FINSEQ_1:def 3;
let k being Nat;
assume that
A193: 1 <= k
and
A194: k <= ( len ( ( lower_volume (f,D1) ) | j1 ) );
reconsider k as (Element of ( NAT )) by ORDINAL1:def 12;
A195: ( len ( lower_volume (f,D1) ) ) = ( len D1 ) by INTEGRA1:def 7;
then A196: k <= j1 by A137,A194,FINSEQ_1:59;
then k <= ( len D1 ) by A137,XXREAL_0:2;
then A197: k in ( Seg ( len D1 ) ) by A193,FINSEQ_1:1;
then A198: k in ( dom D1 ) by FINSEQ_1:def 3;
then A199: ( indx (D2,D1,k) ) in ( dom D2 ) by A13,INTEGRA1:def 19;
A200: k in ( Seg j1 ) by A193,A196,FINSEQ_1:1;
then ( indx (D2,D1,k) ) in ( Seg j1 ) by A173,A193,A196;
then A201: ( indx (D2,D1,k) ) in ( Seg ( indx (D2,D1,j1) ) ) by A150,A173;
then ( indx (D2,D1,k) ) <= ( indx (D2,D1,j1) ) by FINSEQ_1:1;
then A202: ( indx (D2,D1,k) ) <= ( len D2 ) by A134,XXREAL_0:2;
A203: ( D1 . k ) = ( D2 . ( indx (D2,D1,k) ) ) by A13,A198,INTEGRA1:def 19;
A204: (( lower_bound ( divset (D1,k) ) ) = ( lower_bound ( divset (D2,( indx (D2,D1,k) )) ) ) & ( upper_bound ( divset (D1,k) ) ) = ( upper_bound ( divset (D2,( indx (D2,D1,k) )) ) ))
proof
per cases ;
suppose A205: k = 1;

then A206: ( upper_bound ( divset (D1,k) ) ) = ( D1 . k ) by A198,INTEGRA1:def 4;
A207: ( lower_bound ( divset (D1,k) ) ) = ( lower_bound A ) by A198,A205,INTEGRA1:def 4;
( indx (D2,D1,k) ) = 1 by A150,A173,A205;
hence thesis by A199,A203,A207,A206,INTEGRA1:def 4;
end;
suppose A208: k <> 1;

then reconsider k1 = ( k - 1 ) as (Element of ( NAT )) by A198,INTEGRA1:7;
k <= ( k + 1 ) by NAT_1:11;
then k1 <= k by XREAL_1:20;
then A209: k1 <= j1 by A196,XXREAL_0:2;
A210: ( k - 1 ) in ( dom D1 ) by A198,A208,INTEGRA1:7;
then k1 in ( Seg ( len D1 ) ) by FINSEQ_1:def 3;
then 1 <= k1 by FINSEQ_1:1;
then k1 = ( indx (D2,D1,k1) ) by A173,A209;
then A211: ( D2 . ( ( indx (D2,D1,k) ) - 1 ) ) = ( D2 . ( indx (D2,D1,k1) ) ) by A173,A193,A196;
A212: ( indx (D2,D1,k) ) <> 1 by A173,A193,A196,A208;
then A213: ( lower_bound ( divset (D2,( indx (D2,D1,k) )) ) ) = ( D2 . ( ( indx (D2,D1,k) ) - 1 ) ) by A199,INTEGRA1:def 4;
A214: ( upper_bound ( divset (D2,( indx (D2,D1,k) )) ) ) = ( D2 . ( indx (D2,D1,k) ) ) by A199,A212,INTEGRA1:def 4;
A215: ( upper_bound ( divset (D1,k) ) ) = ( D1 . k ) by A198,A208,INTEGRA1:def 4;
( lower_bound ( divset (D1,k) ) ) = ( D1 . ( k - 1 ) ) by A198,A208,INTEGRA1:def 4;
hence thesis by A13,A198,A215,A210,A213,A214,A211,INTEGRA1:def 19;
end;
end;
( divset (D2,( indx (D2,D1,k) )) ) = [. ( lower_bound ( divset (D2,( indx (D2,D1,k) )) ) ),( upper_bound ( divset (D2,( indx (D2,D1,k) )) ) ) .] by INTEGRA1:4;
then A216: ( divset (D1,k) ) = ( divset (D2,( indx (D2,D1,k) )) ) by A204,INTEGRA1:4;
A217: k in ( dom D1 ) by A197,FINSEQ_1:def 3;
j1 in ( Seg ( len ( lower_volume (f,D1) ) ) ) by A45,A195,FINSEQ_1:def 3;
then j1 in ( dom ( lower_volume (f,D1) ) ) by FINSEQ_1:def 3;
then A218: ( ( ( lower_volume (f,D1) ) | j1 ) . k ) = ( ( lower_volume (f,D1) ) . k ) by A200,RFINSEQ:6
.= ( ( lower_bound ( rng ( f | ( divset (D2,( indx (D2,D1,k) )) ) ) ) ) * ( vol ( divset (D2,( indx (D2,D1,k) )) ) ) ) by A217,A216,INTEGRA1:def 7;
1 <= ( indx (D2,D1,k) ) by A173,A193,A196;
then ( indx (D2,D1,k) ) in ( Seg ( len D2 ) ) by A202,FINSEQ_1:1;
then A219: ( indx (D2,D1,k) ) in ( dom D2 ) by FINSEQ_1:def 3;
( ( ( lower_volume (f,D2) ) | ( indx (D2,D1,j1) ) ) . k ) = ( ( ( lower_volume (f,D2) ) | ( indx (D2,D1,j1) ) ) . ( indx (D2,D1,k) ) ) by A173,A193,A196
.= ( ( lower_volume (f,D2) ) . ( indx (D2,D1,k) ) ) by A201,A192,RFINSEQ:6
.= ( ( lower_bound ( rng ( f | ( divset (D2,( indx (D2,D1,k) )) ) ) ) ) * ( vol ( divset (D2,( indx (D2,D1,k) )) ) ) ) by A219,INTEGRA1:def 7;
hence thesis by A218;
end;
( indx (D2,D1,j1) ) in ( dom D2 ) by A13,A47,INTEGRA1:def 19;
then ( indx (D2,D1,j1) ) <= ( len D2 ) by FINSEQ_3:25;
then A220: ( indx (D2,D1,j1) ) <= ( len ( lower_volume (f,D2) ) ) by INTEGRA1:def 7;
j1 <= ( len D1 ) by A47,FINSEQ_3:25;
then A221: j1 <= ( len ( lower_volume (f,D1) ) ) by INTEGRA1:def 7;
( len ( D2 | ( indx (D2,D1,j1) ) ) ) = ( len ( D1 | j1 ) ) by A51,A171,A170,CKB10:1;
then ( indx (D2,D1,j1) ) = j1 by A137,A135,FINSEQ_1:59;
then ( len ( ( lower_volume (f,D1) ) | j1 ) ) = ( indx (D2,D1,j1) ) by A221,FINSEQ_1:59;
then ( len ( ( lower_volume (f,D1) ) | j1 ) ) = ( len ( ( lower_volume (f,D2) ) | ( indx (D2,D1,j1) ) ) ) by A220,FINSEQ_1:59;
then A222: ( ( lower_volume (f,D2) ) | ( indx (D2,D1,j1) ) ) = ( ( lower_volume (f,D1) ) | j1 ) by A191,FINSEQ_1:14;
A223: j in ( Seg ( len D1 ) ) by A42,FINSEQ_1:def 3;
then A224: 1 <= j by FINSEQ_1:1;
( indx (D2,D1,j) ) in ( Seg ( len LVf(D2) ) ) by A132,INTEGRA1:def 7;
then A225: ( indx (D2,D1,j) ) in ( dom LVf(D2) ) by FINSEQ_1:def 3;
( indx (D2,D1,j) ) <= ( len D2 ) by A132,FINSEQ_1:1;
then A226: ( indx (D2,D1,j) ) <= ( len LVf(D2) ) by INTEGRA1:def 7;
j in ( Seg ( len LVf(D1) ) ) by A223,INTEGRA1:def 7;
then A227: j in ( dom LVf(D1) ) by FINSEQ_1:def 3;
j <= ( len D1 ) by A223,FINSEQ_1:1;
then A228: j <= ( len LVf(D1) ) by INTEGRA1:def 7;
j1 in ( Seg ( len D1 ) ) by A45,FINSEQ_1:def 3;
then j1 in ( Seg ( len LVf(D1) ) ) by INTEGRA1:def 7;
then j1 in ( dom LVf(D1) ) by FINSEQ_1:def 3;
then PLf(D1,j1) = ( Sum ( LVf(D1) | j1 ) ) by INTEGRA1:def 20;
then ( PLf(D1,j1) + ( Sum ( mid (LVf(D1),j,j) ) ) ) = ( Sum ( ( LVf(D1) | j1 ) ^ ( mid (LVf(D1),j,j) ) ) ) by RVSUM_1:75
.= ( Sum ( ( mid (LVf(D1),1,j1) ) ^ ( mid (LVf(D1),( j1 + 1 ),j) ) ) ) by A150,FINSEQ_6:116
.= ( Sum ( mid (LVf(D1),1,j) ) ) by A150,A228,A131,INTEGRA2:4
.= ( Sum ( LVf(D1) | j ) ) by A224,FINSEQ_6:116;
then A229: ( PLf(D1,j1) + ( Sum ( mid (( lower_volume (f,D1) ),j,j) ) ) ) = PLf(D1,j) by A227,INTEGRA1:def 20;
( indx (D2,D1,j1) ) in ( Seg ( len D2 ) ) by A48,FINSEQ_1:def 3;
then ( indx (D2,D1,j1) ) in ( Seg ( len LVf(D2) ) ) by INTEGRA1:def 7;
then ( indx (D2,D1,j1) ) in ( dom LVf(D2) ) by FINSEQ_1:def 3;
then PLf(D2,( indx (D2,D1,j1) )) = ( Sum ( LVf(D2) | ( indx (D2,D1,j1) ) ) ) by INTEGRA1:def 20;
then ( PLf(D2,( indx (D2,D1,j1) )) + ( Sum ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) ) = ( Sum ( ( LVf(D2) | ( indx (D2,D1,j1) ) ) ^ ( mid (LVf(D2),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) ) by RVSUM_1:75
.= ( Sum ( ( mid (LVf(D2),1,( indx (D2,D1,j1) )) ) ^ ( mid (LVf(D2),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) ) by A50,FINSEQ_6:116
.= ( Sum ( mid (LVf(D2),1,( indx (D2,D1,j) )) ) ) by A50,A52,A226,INTEGRA2:4
.= ( Sum ( LVf(D2) | ( indx (D2,D1,j) ) ) ) by A133,FINSEQ_6:116;
then A230: ( PLf(D2,( indx (D2,D1,j1) )) + ( Sum ( mid (( lower_volume (f,D2) ),( ( indx (D2,D1,j1) ) + 1 ),( indx (D2,D1,j) )) ) ) ) = PLf(D2,( indx (D2,D1,j) )) by A225,INTEGRA1:def 20;
( indx (D2,D1,j1) ) in ( Seg ( len D2 ) ) by A48,FINSEQ_1:def 3;
then ( indx (D2,D1,j1) ) in ( Seg ( len ( lower_volume (f,D2) ) ) ) by INTEGRA1:def 7;
then ( indx (D2,D1,j1) ) in ( dom ( lower_volume (f,D2) ) ) by FINSEQ_1:def 3;
then PLf(D2,( indx (D2,D1,j1) )) = ( Sum ( ( lower_volume (f,D2) ) | ( indx (D2,D1,j1) ) ) ) by INTEGRA1:def 20
.= PLf(D1,j1) by A222,A46,INTEGRA1:def 20;
hence thesis by A54,A230,A229;
end;
hence thesis by A42,A43;
end;
reconsider i as non  empty (Element of ( NAT )) by A18,FINSEQ_1:1;
A231: (for i being non  empty Nat holds (P[ i ] implies P[ ( i + 1 ) ]))
proof
let i being non  empty Nat;
A232: i >= 1 by NAT_1:14;
assume A233: P[ i ];
P[ ( i + 1 ) ]
proof
A234: i <= ( i + 1 ) by NAT_1:11;
assume A235: ( i + 1 ) in ( dom D );
then consider j such that A236: j in ( dom D1 ) and A237: ( D . ( i + 1 ) ) in ( divset (D1,j) ) by CKB7:1,INTEGRA1:6;
A238: ( D2 . ( indx (D2,D1,j) ) ) = ( D1 . j ) by A13,A236,INTEGRA1:def 19;
( i + 1 ) <= ( len D ) by A235,FINSEQ_3:25;
then i <= ( len D ) by A234,XXREAL_0:2;
then A239: i in ( Seg ( len D ) ) by A232,FINSEQ_1:1;
then A240: i in ( dom D ) by FINSEQ_1:def 3;
consider n1 being (Element of ( NAT )) such that A241: n1 in ( dom D1 ) and A242: ( D . i ) in ( divset (D1,n1) ) and A243: ( PLf(D2,( indx (D2,D1,n1) )) - PLf(D1,n1) ) <= ( ( i * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) ) by A233,A239,FINSEQ_1:def 3;
A244: 1 <= ( n1 + 1 ) by NAT_1:12;
A245: n1 < j
proof
assume A246: n1 >= j;
now
per cases  by A246,XXREAL_0:1;
suppose A247: n1 = j;

( D . i ) in ( rng D ) by A240,FUNCT_1:def 3;
then A248: ( D . i ) in ( ( rng D ) /\ ( divset (D1,j) ) ) by A242,A247,XBOOLE_0:def 4;
( D . ( i + 1 ) ) in ( rng D ) by A235,FUNCT_1:def 3;
then A249: ( D . ( i + 1 ) ) in ( ( rng D ) /\ ( divset (D1,j) ) ) by A237,XBOOLE_0:def 4;
( i + 1 ) > i by XREAL_1:29;
hence contradiction by A11,A235,A236,A240,A248,A249,CKB9:1,SEQ_4:138;
end;
suppose n1 > j;

then A250: n1 >= ( j + 1 ) by NAT_1:13;
then A251: ( n1 - 1 ) >= j by XREAL_1:19;
1 <= j by A236,FINSEQ_3:25;
then ( 1 + 1 ) <= ( j + 1 ) by XREAL_1:6;
then A252: n1 <> 1 by A250,XXREAL_0:2;
( lower_bound ( divset (D1,n1) ) ) <= ( D . i ) by A242,INTEGRA2:1;
then A253: ( D . i ) >= ( D1 . ( n1 - 1 ) ) by A241,A252,INTEGRA1:def 4;
( n1 - 1 ) in ( dom D1 ) by A241,A252,INTEGRA1:7;
then ( D1 . j ) <= ( D1 . ( n1 - 1 ) ) by A236,A251,SEQ_4:137;
then A254: ( D . i ) >= ( D1 . j ) by A253,XXREAL_0:2;
A255: i < ( i + 1 ) by XREAL_1:29;
A256: ( upper_bound ( divset (D1,j) ) ) = ( D1 . j )
proof
per cases ;
suppose j = 1;

hence thesis by A236,INTEGRA1:def 4;
end;
suppose j <> 1;

hence thesis by A236,INTEGRA1:def 4;
end;
end;
( D . ( i + 1 ) ) <= ( upper_bound ( divset (D1,j) ) ) by A237,INTEGRA2:1;
then ( D . i ) >= ( D . ( i + 1 ) ) by A256,A254,XXREAL_0:2;
hence contradiction by A235,A240,A255,SEQM_3:def 1;
end;
end;
hence thesis;
end;
then A257: ( n1 + 1 ) <= j by NAT_1:13;
A258: 1 <= n1 by A241,FINSEQ_3:25;
A259: ( indx (D2,D1,n1) ) in ( dom D2 ) by A13,A241,INTEGRA1:def 19;
then A260: 1 <= ( indx (D2,D1,n1) ) by FINSEQ_3:25;
A261: ( indx (D2,D1,j) ) in ( dom D2 ) by A13,A236,INTEGRA1:def 19;
then A262: 1 <= ( indx (D2,D1,j) ) by FINSEQ_3:25;
A263: ( indx (D2,D1,j) ) <= ( len D2 ) by A261,FINSEQ_3:25;
then A264: ( indx (D2,D1,j) ) <= ( len LVf(D2) ) by INTEGRA1:def 7;
A265: 1 <= j by A236,FINSEQ_3:25;
A266: j <= ( len D1 ) by A236,FINSEQ_3:25;
then A267: ( n1 + 1 ) <= ( len D1 ) by A257,XXREAL_0:2;
then A268: ( n1 + 1 ) in ( dom D1 ) by A244,FINSEQ_3:25;
then A269: ( indx (D2,D1,( n1 + 1 )) ) in ( dom D2 ) by A13,INTEGRA1:def 19;
then A270: 1 <= ( indx (D2,D1,( n1 + 1 )) ) by FINSEQ_3:25;
A271: ( D2 . ( indx (D2,D1,( n1 + 1 )) ) ) = ( D1 . ( n1 + 1 ) ) by A13,A268,INTEGRA1:def 19;
then ( D2 . ( indx (D2,D1,( n1 + 1 )) ) ) <= ( D2 . ( indx (D2,D1,j) ) ) by A236,A257,A268,A238,SEQ_4:137;
then A272: ( indx (D2,D1,( n1 + 1 )) ) <= ( indx (D2,D1,j) ) by A269,A261,SEQM_3:def 1;
then ( 1 + ( indx (D2,D1,( n1 + 1 )) ) ) <= ( ( indx (D2,D1,j) ) + 1 ) by XREAL_1:6;
then 1 <= ( ( ( indx (D2,D1,j) ) + 1 ) - ( indx (D2,D1,( n1 + 1 )) ) ) by XREAL_1:19;
then A273: ( ( mid (D2,( indx (D2,D1,( n1 + 1 )) ),( indx (D2,D1,j) )) ) . 1 ) = ( D2 . ( ( 1 - 1 ) + ( indx (D2,D1,( n1 + 1 )) ) ) ) by A272,A270,A263,FINSEQ_6:122
.= ( D1 . ( n1 + 1 ) ) by A13,A268,INTEGRA1:def 19;
A274: ( D2 . ( indx (D2,D1,n1) ) ) = ( D1 . n1 ) by A13,A241,INTEGRA1:def 19;
A275: j <= ( len LVf(D1) ) by A266,INTEGRA1:def 7;
then j in ( Seg ( len LVf(D1) ) ) by A265,FINSEQ_1:1;
then A276: j in ( dom LVf(D1) ) by FINSEQ_1:def 3;
A277: ( indx (D2,D1,( n1 + 1 )) ) <= ( len D2 ) by A269,FINSEQ_3:25;
n1 in ( Seg ( len D1 ) ) by A241,FINSEQ_1:def 3;
then n1 in ( Seg ( len LVf(D1) ) ) by INTEGRA1:def 7;
then n1 in ( dom LVf(D1) ) by FINSEQ_1:def 3;
then PLf(D1,n1) = ( Sum ( LVf(D1) | n1 ) ) by INTEGRA1:def 20
.= ( Sum ( mid (LVf(D1),1,n1) ) ) by A258,FINSEQ_6:116;
then ( PLf(D1,n1) + ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) ) = ( Sum ( ( mid (LVf(D1),1,n1) ) ^ ( mid (LVf(D1),( n1 + 1 ),j) ) ) ) by RVSUM_1:75
.= ( Sum ( mid (LVf(D1),1,j) ) ) by A245,A258,A275,INTEGRA2:4
.= ( Sum ( LVf(D1) | j ) ) by A265,FINSEQ_6:116;
then A278: PLf(D1,j) = ( PLf(D1,n1) + ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) ) by A276,INTEGRA1:def 20;
( indx (D2,D1,j) ) in ( Seg ( len D2 ) ) by A261,FINSEQ_1:def 3;
then ( indx (D2,D1,j) ) in ( Seg ( len LVf(D2) ) ) by INTEGRA1:def 7;
then A279: ( indx (D2,D1,j) ) in ( dom LVf(D2) ) by FINSEQ_1:def 3;
A280: n1 >= 1 by A241,FINSEQ_3:25;
A281: ( j - n1 ) >= 1 by A257,XREAL_1:19;
( ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) - ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) ) <= ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta D1 ) )
proof
now
per cases  by A257,XXREAL_0:1;
suppose A282: ( n1 + 1 ) = j;

A283: ( ( indx (D2,D1,j) ) - ( indx (D2,D1,n1) ) ) <= 2
proof
A284: ( upper_bound ( divset (D1,j) ) ) = ( D1 . j ) by A236,A245,A280,INTEGRA1:def 4;
A285: ( lower_bound ( divset (D1,j) ) ) = ( D1 . ( j - 1 ) ) by A236,A245,A280,INTEGRA1:def 4;
A286: 1 <= ( ( indx (D2,D1,n1) ) + 1 ) by A260,NAT_1:13;
assume ( ( indx (D2,D1,j) ) - ( indx (D2,D1,n1) ) ) > 2;
then A287: ( ( indx (D2,D1,n1) ) + 2 ) < ( indx (D2,D1,j) ) by XREAL_1:20;
then A288: ( ( indx (D2,D1,n1) ) + 2 ) <= ( len D2 ) by A263,XXREAL_0:2;
A289: ( ( indx (D2,D1,n1) ) + 1 ) < ( ( indx (D2,D1,n1) ) + 2 ) by XREAL_1:6;
then A290: ( indx (D2,D1,n1) ) < ( ( indx (D2,D1,n1) ) + 2 ) by NAT_1:13;
then 1 <= ( ( indx (D2,D1,n1) ) + 2 ) by A260,XXREAL_0:2;
then A291: ( ( indx (D2,D1,n1) ) + 2 ) in ( dom D2 ) by A288,FINSEQ_3:25;
then A292: ( D2 . ( indx (D2,D1,j) ) ) >= ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) by A261,A287,SEQ_4:137;
A293: (not ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) in ( rng D1 ))
proof
assume ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) in ( rng D1 );
then consider k1 being (Element of ( NAT )) such that A294: k1 in ( dom D1 ) and A295: ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) = ( D1 . k1 ) by PARTFUN1:3;
( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) < ( D2 . ( indx (D2,D1,j) ) ) by A261,A287,A291,SEQM_3:def 1;
then A296: k1 < j by A236,A238,A294,A295,SEQ_4:137;
( D2 . ( indx (D2,D1,n1) ) ) < ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) by A259,A290,A291,SEQM_3:def 1;
then n1 < k1 by A241,A274,A294,A295,SEQ_4:137;
hence contradiction by A282,A296,NAT_1:13;
end;
( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) in ( rng D2 ) by A291,FUNCT_1:def 3;
then A297: ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) in ( rng D ) by A14,A293,XBOOLE_0:def 3;
A298: ( lower_bound ( divset (D1,j) ) ) = ( D1 . ( j - 1 ) ) by A236,A245,A280,INTEGRA1:def 4;
A299: ( upper_bound ( divset (D1,j) ) ) = ( D1 . j ) by A236,A245,A280,INTEGRA1:def 4;
( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) >= ( D2 . ( indx (D2,D1,n1) ) ) by A259,A290,A291,SEQ_4:137;
then ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) in ( divset (D1,j) ) by A274,A238,A282,A298,A284,A292,INTEGRA2:1;
then A300: ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) in ( ( rng D ) /\ ( divset (D1,j) ) ) by A297,XBOOLE_0:def 4;
A301: ( ( indx (D2,D1,n1) ) + 1 ) < ( indx (D2,D1,j) ) by A287,A289,XXREAL_0:2;
then ( ( indx (D2,D1,n1) ) + 1 ) <= ( len D2 ) by A263,XXREAL_0:2;
then A302: ( ( indx (D2,D1,n1) ) + 1 ) in ( dom D2 ) by A286,FINSEQ_3:25;
then A303: ( D2 . ( indx (D2,D1,j) ) ) >= ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) by A261,A301,SEQ_4:137;
A304: ( indx (D2,D1,n1) ) < ( ( indx (D2,D1,n1) ) + 1 ) by NAT_1:13;
A305: (not ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( rng D1 ))
proof
assume ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( rng D1 );
then consider k1 being (Element of ( NAT )) such that A306: k1 in ( dom D1 ) and A307: ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) = ( D1 . k1 ) by PARTFUN1:3;
( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) < ( D2 . ( indx (D2,D1,j) ) ) by A261,A301,A302,SEQM_3:def 1;
then A308: k1 < j by A236,A238,A306,A307,SEQ_4:137;
( D2 . ( indx (D2,D1,n1) ) ) < ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) by A259,A304,A302,SEQM_3:def 1;
then n1 < k1 by A241,A274,A306,A307,SEQ_4:137;
hence contradiction by A282,A308,NAT_1:13;
end;
( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( rng D2 ) by A302,FUNCT_1:def 3;
then A309: ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( rng D ) by A14,A305,XBOOLE_0:def 3;
( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) >= ( D2 . ( indx (D2,D1,n1) ) ) by A259,A304,A302,SEQ_4:137;
then ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( divset (D1,j) ) by A274,A238,A282,A285,A299,A303,INTEGRA2:1;
then ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( ( rng D ) /\ ( divset (D1,j) ) ) by A309,XBOOLE_0:def 4;
then ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) = ( D2 . ( ( indx (D2,D1,n1) ) + 2 ) ) by A11,A236,A300,CKB9:1;
hence contradiction by A289,A302,A291,SEQM_3:def 1;
end;
A310: (( ( indx (D2,D1,n1) ) + 1 ) < ( indx (D2,D1,j) ) implies ( ( indx (D2,D1,n1) ) + 2 ) = ( indx (D2,D1,j) ))
proof
assume ( ( indx (D2,D1,n1) ) + 1 ) < ( indx (D2,D1,j) );
then A311: ( ( ( indx (D2,D1,n1) ) + 1 ) + 1 ) <= ( indx (D2,D1,j) ) by NAT_1:13;
( ( indx (D2,D1,n1) ) + 2 ) >= ( indx (D2,D1,j) ) by A283,XREAL_1:20;
hence thesis by A311,XXREAL_0:1;
end;
A312: 1 <= ( ( indx (D2,D1,n1) ) + 1 ) by NAT_1:12;
A313: ( indx (D2,D1,j) ) <= ( len LVf(D2) ) by A263,INTEGRA1:def 7;
( D1 . n1 ) < ( D1 . j ) by A236,A241,A245,SEQM_3:def 1;
then A314: ( indx (D2,D1,n1) ) < ( indx (D2,D1,j) ) by A259,A274,A261,A238,SEQ_4:137;
then A315: ( ( indx (D2,D1,n1) ) + 1 ) <= ( indx (D2,D1,j) ) by NAT_1:13;
then ( ( indx (D2,D1,n1) ) + 1 ) <= ( len D2 ) by A263,XXREAL_0:2;
then ( ( indx (D2,D1,n1) ) + 1 ) <= ( len LVf(D2) ) by INTEGRA1:def 7;
then A316: ( len ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) = ( ( ( indx (D2,D1,j) ) -' ( ( indx (D2,D1,n1) ) + 1 ) ) + 1 ) by A262,A315,A312,A313,FINSEQ_6:118
.= ( ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,n1) ) + 1 ) ) + 1 ) by A315,XREAL_1:233
.= ( ( indx (D2,D1,j) ) - ( indx (D2,D1,n1) ) );
( ( indx (D2,D1,n1) ) + 1 ) <= ( indx (D2,D1,j) ) by A314,NAT_1:13;
then A317: (( ( indx (D2,D1,n1) ) + 1 ) = ( indx (D2,D1,j) ) or ( ( indx (D2,D1,n1) ) + 1 ) < ( indx (D2,D1,j) )) by XXREAL_0:1;
A318: ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) <= ( ( upper_bound ( rng f ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) )
proof
per cases  by A317,A310;
suppose A319: ( ( indx (D2,D1,j) ) - ( indx (D2,D1,n1) ) ) = 1;

A320: ( ( indx (D2,D1,n1) ) + 1 ) > 1 by A260,NAT_1:13;
then ( upper_bound ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) = ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) by A261,A319,INTEGRA1:def 4;
then A321: ( upper_bound ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) = ( D1 . j ) by A13,A236,A319,INTEGRA1:def 19;
( lower_bound ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) = ( D2 . ( ( ( indx (D2,D1,n1) ) + 1 ) - 1 ) ) by A261,A319,A320,INTEGRA1:def 4;
then A322: ( lower_bound ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) = ( D1 . n1 ) by A13,A241,INTEGRA1:def 19;
( lower_bound ( divset (D1,( n1 + 1 )) ) ) = ( D1 . ( ( n1 + 1 ) - 1 ) ) by A245,A280,A268,A282,INTEGRA1:def 4;
then A323: ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) = ( divset (D1,( n1 + 1 )) ) by A245,A280,A268,A282,A322,A321,INTEGRA1:def 4;
A324: ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) >= ( 0 ) by INTEGRA1:9;
1 = ( ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,n1) ) + 1 ) ) + 1 ) by A319;
then ( ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) . 1 ) = ( LVf(D2) . ( ( 1 + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) ) by A312,A313,FINSEQ_6:122
.= ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) );
then A325: ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) = <* ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) ) *> by A316,A319,FINSEQ_1:40;
( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) ) = ( ( lower_bound ( rng ( f | ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) ) ) * ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) ) by A261,A319,INTEGRA1:def 7;
then ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) ) <= ( ( upper_bound ( rng f ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) ) by A1,A261,A319,A323,A324,CKB32:1,XREAL_1:64;
hence thesis by A325,FINSOP_1:11;
end;
suppose A326: ( ( indx (D2,D1,j) ) - ( indx (D2,D1,n1) ) ) = 2;

( ( indx (D2,D1,n1) ) + 2 ) >= ( 2 + 1 ) by A260,XREAL_1:6;
then A327: ( ( indx (D2,D1,n1) ) + 2 ) <> 1;
then A328: ( upper_bound ( divset (D2,( ( indx (D2,D1,n1) ) + 2 )) ) ) = ( D2 . ( indx (D2,D1,j) ) ) by A261,A326,INTEGRA1:def 4;
( ( ( indx (D2,D1,n1) ) + 2 ) - 1 ) = ( ( indx (D2,D1,n1) ) + 1 );
then ( lower_bound ( divset (D2,( ( indx (D2,D1,n1) ) + 2 )) ) ) = ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) by A261,A326,A327,INTEGRA1:def 4;
then A329: ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 2 )) ) ) = ( ( D1 . j ) - ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) ) by A238,A328,INTEGRA1:def 5;
A330: ( upper_bound ( divset (D1,( n1 + 1 )) ) ) = ( D1 . ( n1 + 1 ) ) by A245,A280,A268,A282,INTEGRA1:def 4;
( lower_bound ( divset (D1,( n1 + 1 )) ) ) = ( D1 . ( ( n1 + 1 ) - 1 ) ) by A245,A280,A268,A282,INTEGRA1:def 4;
then A331: ( vol ( divset (D1,( n1 + 1 )) ) ) = ( ( D1 . ( n1 + 1 ) ) - ( D1 . n1 ) ) by A330,INTEGRA1:def 5;
A332: ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 2 )) ) ) >= ( 0 ) by INTEGRA1:9;
A333: ( indx (D2,D1,j) ) <= ( len LVf(D2) ) by A263,INTEGRA1:def 7;
A334: ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) >= ( 0 ) by INTEGRA1:9;
A335: 1 <= ( ( indx (D2,D1,n1) ) + 1 ) by NAT_1:12;
A336: ( ( indx (D2,D1,n1) ) + 1 ) <= ( ( indx (D2,D1,n1) ) + 2 ) by XREAL_1:6;
then ( ( indx (D2,D1,n1) ) + 1 ) <= ( len D2 ) by A263,A326,XXREAL_0:2;
then A337: ( ( indx (D2,D1,n1) ) + 1 ) in ( dom D2 ) by A335,FINSEQ_3:25;
then ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) ) = ( ( lower_bound ( rng ( f | ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) ) ) * ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) ) by INTEGRA1:def 7;
then A338: ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) ) <= ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) ) by A1,A337,A334,CKB32:1,XREAL_1:64;
( ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,n1) ) + 1 ) ) + 1 ) = ( 1 + 1 ) by A326;
then A339: ( ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) . 2 ) = ( LVf(D2) . ( ( 2 + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) ) by A335,A336,A333,FINSEQ_6:122
.= ( LVf(D2) . ( ( ( indx (D2,D1,n1) ) + ( 0 ) ) + 2 ) );
( ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,n1) ) + 1 ) ) + 1 ) >= 1 by A326;
then ( ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) . 1 ) = ( LVf(D2) . ( ( 1 + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) ) by A326,A335,A336,A333,FINSEQ_6:122
.= ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) );
then ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) = <* ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) ),( LVf(D2) . ( ( indx (D2,D1,n1) ) + 2 ) ) *> by A316,A326,A339,FINSEQ_1:44;
then A340: ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) = ( ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 1 ) ) + ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 2 ) ) ) by RVSUM_1:77;
A341: ( ( indx (D2,D1,n1) ) + 1 ) > 1 by A260,NAT_1:13;
then A342: ( upper_bound ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) = ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) by A337,INTEGRA1:def 4;
( lower_bound ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) = ( D2 . ( ( ( indx (D2,D1,n1) ) + 1 ) - 1 ) ) by A337,A341,INTEGRA1:def 4;
then A343: ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) = ( ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) - ( D1 . n1 ) ) by A274,A342,INTEGRA1:def 5;
( LVf(D2) . ( ( indx (D2,D1,n1) ) + 2 ) ) = ( ( lower_bound ( rng ( f | ( divset (D2,( ( indx (D2,D1,n1) ) + 2 )) ) ) ) ) * ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 2 )) ) ) ) by A261,A326,INTEGRA1:def 7;
then ( LVf(D2) . ( ( indx (D2,D1,n1) ) + 2 ) ) <= ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 2 )) ) ) ) by A1,A261,A326,A332,CKB32:1,XREAL_1:64;
then ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) <= ( ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 1 )) ) ) ) + ( ( upper_bound ( rng f ) ) * ( vol ( divset (D2,( ( indx (D2,D1,n1) ) + 2 )) ) ) ) ) by A340,A338,XREAL_1:7;
hence thesis by A282,A343,A329,A331;
end;
end;
A344: ( n1 + 1 ) <= ( len LVf(D1) ) by A267,INTEGRA1:def 7;
then A345: ( len ( mid (LVf(D1),( n1 + 1 ),j) ) ) = ( ( j -' ( n1 + 1 ) ) + 1 ) by A244,A282,FINSEQ_6:118
.= ( ( j - j ) + 1 ) by A282,XREAL_1:233
.= 1;
( ( n1 + 1 ) + 1 ) <= ( j + 1 ) by A257,XREAL_1:6;
then 1 <= ( ( j + 1 ) - ( n1 + 1 ) ) by XREAL_1:19;
then ( ( mid (LVf(D1),( n1 + 1 ),j) ) . 1 ) = ( LVf(D1) . ( ( 1 - 1 ) + ( n1 + 1 ) ) ) by A244,A282,A344,FINSEQ_6:122
.= ( ( lower_bound ( rng ( f | ( divset (D1,( n1 + 1 )) ) ) ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) ) by A268,INTEGRA1:def 7;
then ( mid (LVf(D1),( n1 + 1 ),j) ) = <* ( ( lower_bound ( rng ( f | ( divset (D1,( n1 + 1 )) ) ) ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) ) *> by A345,FINSEQ_1:40;
then A346: ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) = ( ( lower_bound ( rng ( f | ( divset (D1,( n1 + 1 )) ) ) ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) ) by FINSOP_1:11;
( divset (D1,( n1 + 1 )) ) c= A by A268,INTEGRA1:8;
then A347: ( lower_bound ( rng ( f | ( divset (D1,( n1 + 1 )) ) ) ) ) >= ( lower_bound ( rng f ) ) by A1,CKB15:1;
( n1 + 1 ) in ( Seg ( len D1 ) ) by A268,FINSEQ_1:def 3;
then ( n1 + 1 ) in ( Seg ( len ( upper_volume (( chi (A,A) ),D1) ) ) ) by INTEGRA1:def 6;
then A348: ( n1 + 1 ) in ( dom ( upper_volume (( chi (A,A) ),D1) ) ) by FINSEQ_1:def 3;
( vol ( divset (D1,( n1 + 1 )) ) ) = ( ( upper_volume (( chi (A,A) ),D1) ) . ( n1 + 1 ) ) by A268,INTEGRA1:20;
then ( vol ( divset (D1,( n1 + 1 )) ) ) in ( rng ( upper_volume (( chi (A,A) ),D1) ) ) by A348,FUNCT_1:def 3;
then A349: ( vol ( divset (D1,( n1 + 1 )) ) ) <= ( delta D1 ) by XXREAL_2:def 8;
( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) >= ( 0 ) by A1,CKB14:1,XREAL_1:48;
then A350: ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) ) <= ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta D1 ) ) by A349,XREAL_1:64;
( vol ( divset (D1,( n1 + 1 )) ) ) >= ( 0 ) by INTEGRA1:9;
then ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) >= ( ( lower_bound ( rng f ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) ) by A346,A347,XREAL_1:64;
then ( ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) - ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) ) <= ( ( ( upper_bound ( rng f ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) ) - ( ( lower_bound ( rng f ) ) * ( vol ( divset (D1,( n1 + 1 )) ) ) ) ) by A318,XREAL_1:13;
hence thesis by A350,XXREAL_0:2;
end;
suppose A351: ( n1 + 1 ) < j;

A352: n1 < ( n1 + 1 ) by NAT_1:13;
then A353: ( D1 . n1 ) < ( D1 . ( n1 + 1 ) ) by A241,A268,SEQM_3:def 1;
then consider B being non  empty  closed_interval (Subset of ( REAL )),MD1,MD2 being (Division of B) such that A354: ( D1 . n1 ) = ( lower_bound B ) and ( upper_bound B ) = ( MD2 . ( len MD2 ) ) and A355: ( upper_bound B ) = ( MD1 . ( len MD1 ) ) and A356: MD1 <= MD2 and A357: MD1 = ( mid (D1,( n1 + 1 ),j) ) and A358: MD2 = ( mid (D2,( indx (D2,D1,( n1 + 1 )) ),( indx (D2,D1,j) )) ) by A13,A236,A257,A268,A273,CKB29:1;
A359: ( delta MD1 ) >= ( 0 ) by CKB13:1;
A360: ( len MD1 ) = ( ( j -' ( n1 + 1 ) ) + 1 ) by A257,A265,A266,A244,A267,A357,FINSEQ_6:118;
then A361: ( ( ( len MD1 ) + ( n1 + 1 ) ) - 1 ) = ( ( ( ( j - ( n1 + 1 ) ) + 1 ) + ( n1 + 1 ) ) - 1 ) by A257,XREAL_1:233
.= j;
( j -' ( n1 + 1 ) ) = ( j - ( n1 + 1 ) ) by A257,XREAL_1:233;
then A362: ( ( j -' ( n1 + 1 ) ) + 1 ) = ( j - n1 );
then A363: ( len MD1 ) = ( j - n1 ) by A257,A265,A266,A244,A267,A357,FINSEQ_6:118;
A364: B c= A
proof
let x1;
A365: ( rng D1 ) c= A by INTEGRA1:def 2;
( D1 . n1 ) in ( rng D1 ) by A241,FUNCT_1:def 3;
then A366: ( lower_bound A ) <= ( D1 . n1 ) by A365,INTEGRA2:1;
assume A367: x1 in B;
then reconsider x1 as Real;
A368: x1 <= ( MD1 . ( len MD1 ) ) by A355,A367,INTEGRA2:1;
( D1 . j ) in ( rng D1 ) by A236,FUNCT_1:def 3;
then A369: ( D1 . j ) <= ( upper_bound A ) by A365,INTEGRA2:1;
( D1 . n1 ) <= x1 by A354,A367,INTEGRA2:1;
then A370: ( lower_bound A ) <= x1 by A366,XXREAL_0:2;
( MD1 . ( len MD1 ) ) = ( D1 . ( ( ( j - n1 ) - 1 ) + ( n1 + 1 ) ) ) by A257,A281,A266,A244,A357,A362,A363,FINSEQ_6:122
.= ( D1 . j );
then x1 <= ( upper_bound A ) by A368,A369,XXREAL_0:2;
hence thesis by A370,INTEGRA2:1;
end;
then reconsider g = ( f | B ) as (Function of B,( REAL )) by FUNCT_2:32;
A371: ( len ( lower_volume (g,MD1) ) ) = ( len MD1 ) by INTEGRA1:def 7
.= ( ( j -' ( n1 + 1 ) ) + 1 ) by A257,A265,A266,A244,A267,A357,FINSEQ_6:118
.= ( ( j - ( n1 + 1 ) ) + 1 ) by A257,XREAL_1:233;
A372: ( len MD1 ) in ( dom MD1 ) by FINSEQ_5:6;
then A373: 1 <= ( len MD1 ) by FINSEQ_3:25;
A374: (( lower_bound ( divset (MD1,( len MD1 )) ) ) = ( lower_bound ( divset (D1,j) ) ) & ( upper_bound ( divset (MD1,( len MD1 )) ) ) = ( upper_bound ( divset (D1,j) ) ))
proof
per cases ;
suppose A375: ( len MD1 ) = 1;

then A376: ( upper_bound ( divset (MD1,( len MD1 )) ) ) = ( MD1 . ( len MD1 ) ) by A372,INTEGRA1:def 4;
A377: ( upper_bound ( divset (D1,j) ) ) = ( D1 . j ) by A236,A245,A280,INTEGRA1:def 4;
( lower_bound ( divset (D1,j) ) ) = ( D1 . ( j - 1 ) ) by A236,A245,A280,INTEGRA1:def 4;
hence thesis by A265,A266,A354,A357,A361,A372,A375,A376,A377,FINSEQ_6:118,INTEGRA1:def 4;
end;
suppose A378: ( len MD1 ) <> 1;

then ( ( len MD1 ) - 1 ) in ( dom MD1 ) by A372,INTEGRA1:7;
then A379: ( ( len MD1 ) - 1 ) >= 1 by FINSEQ_3:25;
( len MD1 ) <= ( ( len MD1 ) + 1 ) by NAT_1:11;
then A380: ( ( len MD1 ) - 1 ) <= ( len MD1 ) by XREAL_1:20;
( upper_bound ( divset (MD1,( len MD1 )) ) ) = ( MD1 . ( len MD1 ) ) by A372,A378,INTEGRA1:def 4;
then A381: ( upper_bound ( divset (MD1,( len MD1 )) ) ) = ( D1 . j ) by A257,A266,A244,A357,A360,A361,A373,FINSEQ_6:122;
A382: ( ( ( ( len MD1 ) - 1 ) + ( n1 + 1 ) ) - 1 ) = ( j - 1 ) by A363;
( lower_bound ( divset (MD1,( len MD1 )) ) ) = ( MD1 . ( ( len MD1 ) - 1 ) ) by A372,A378,INTEGRA1:def 4;
then ( lower_bound ( divset (MD1,( len MD1 )) ) ) = ( D1 . ( j - 1 ) ) by A257,A266,A244,A357,A360,A382,A379,A380,FINSEQ_6:122;
hence thesis by A236,A245,A280,A381,INTEGRA1:def 4;
end;
end;
A383: ( len MD1 ) in ( dom MD1 ) by FINSEQ_5:6;
A384: ( upper_bound ( divset (MD1,( len MD1 )) ) ) = ( MD1 . ( len MD1 ) )
proof
per cases ;
suppose ( len MD1 ) = 1;

hence thesis by A383,INTEGRA1:def 4;
end;
suppose ( len MD1 ) <> 1;

hence thesis by A383,INTEGRA1:def 4;
end;
end;
( D1 . n1 ) < ( D1 . ( n1 + 1 ) ) by A241,A268,A352,SEQM_3:def 1;
then ( indx (D2,D1,n1) ) < ( indx (D2,D1,( n1 + 1 )) ) by A259,A274,A269,A271,SEQ_4:137;
then A385: ( ( indx (D2,D1,n1) ) + 1 ) <= ( indx (D2,D1,( n1 + 1 )) ) by NAT_1:13;
then A386: ( ( indx (D2,D1,n1) ) + 1 ) <= ( len D2 ) by A277,XXREAL_0:2;
( vol B ) = ( ( upper_bound B ) - ( D1 . n1 ) ) by A354,INTEGRA1:def 5;
then ( vol B ) = ( ( D1 . j ) - ( D1 . n1 ) ) by A236,A245,A280,A355,A374,A384,INTEGRA1:def 4;
then A387: ( vol B ) <> ( 0 ) by A236,A241,A245,SEQM_3:def 1;
A388: 1 <= ( ( indx (D2,D1,n1) ) + 1 ) by A260,NAT_1:13;
A389: ( indx (D2,D1,n1) ) < ( ( indx (D2,D1,n1) ) + 1 ) by NAT_1:13;
A390: ( indx (D2,D1,( n1 + 1 )) ) = ( ( indx (D2,D1,n1) ) + 1 )
proof
assume ( indx (D2,D1,( n1 + 1 )) ) <> ( ( indx (D2,D1,n1) ) + 1 );
then A391: ( indx (D2,D1,( n1 + 1 )) ) > ( ( indx (D2,D1,n1) ) + 1 ) by A385,XXREAL_0:1;
A392: ( ( indx (D2,D1,n1) ) + 1 ) in ( dom D2 ) by A388,A386,FINSEQ_3:25;
then A393: ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( rng D2 ) by FUNCT_1:def 3;
now
per cases  by A14,A393,XBOOLE_0:def 3;
suppose ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( rng D1 );

then consider n2 being (Element of ( NAT )) such that A394: n2 in ( dom D1 ) and A395: ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) = ( D1 . n2 ) by PARTFUN1:3;
( D2 . ( indx (D2,D1,n1) ) ) < ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) by A259,A389,A392,SEQM_3:def 1;
then n1 < n2 by A241,A274,A394,A395,SEQ_4:137;
then A396: ( n1 + 1 ) <= n2 by NAT_1:13;
( D1 . n2 ) < ( D1 . ( n1 + 1 ) ) by A269,A271,A391,A392,A395,SEQM_3:def 1;
hence contradiction by A268,A394,A396,SEQ_4:137;
end;
suppose A397: ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) in ( rng D );

A398: ( D . i ) <= ( upper_bound ( divset (D1,n1) ) ) by A242,INTEGRA2:1;
A399: ( upper_bound ( divset (D1,n1) ) ) = ( D1 . n1 )
proof
per cases ;
suppose n1 = 1;

hence thesis by A241,INTEGRA1:def 4;
end;
suppose n1 <> 1;

hence thesis by A241,INTEGRA1:def 4;
end;
end;
consider n2 being (Element of ( NAT )) such that A400: n2 in ( dom D ) and A401: ( D2 . ( ( indx (D2,D1,n1) ) + 1 ) ) = ( D . n2 ) by A397,PARTFUN1:3;
( D1 . n1 ) < ( D . n2 ) by A259,A274,A389,A392,A401,SEQM_3:def 1;
then ( D . i ) < ( D . n2 ) by A398,A399,XXREAL_0:2;
then i < n2 by A240,A400,SEQ_4:137;
then A402: ( i + 1 ) <= n2 by NAT_1:13;
( ( n1 + 1 ) + 1 ) <= j by A351,NAT_1:13;
then A403: ( n1 + 1 ) <= ( j - 1 ) by XREAL_1:19;
( j - 1 ) in ( dom D1 ) by A236,A245,A280,INTEGRA1:7;
then A404: ( D1 . ( n1 + 1 ) ) <= ( D1 . ( j - 1 ) ) by A268,A403,SEQ_4:137;
A405: ( lower_bound ( divset (D1,j) ) ) <= ( D . ( i + 1 ) ) by A237,INTEGRA2:1;
( lower_bound ( divset (D1,j) ) ) = ( D1 . ( j - 1 ) ) by A236,A245,A280,INTEGRA1:def 4;
then A406: ( D1 . ( n1 + 1 ) ) <= ( D . ( i + 1 ) ) by A404,A405,XXREAL_0:2;
( D . n2 ) < ( D1 . ( n1 + 1 ) ) by A269,A271,A391,A392,A401,SEQM_3:def 1;
then ( D . n2 ) < ( D . ( i + 1 ) ) by A406,XXREAL_0:2;
hence contradiction by A235,A400,A402,SEQ_4:137;
end;
end;
hence contradiction;
end;
A407: j <= ( len LVf(D1) ) by A266,INTEGRA1:def 7;
A408: (for k being Nat holds ((1 <= k & k <= ( len ( lower_volume (g,MD1) ) )) implies ( ( lower_volume (g,MD1) ) . k ) = ( ( mid (LVf(D1),( n1 + 1 ),j) ) . k )))
proof
let k being Nat;
assume that
A409: 1 <= k
and
A410: k <= ( len ( lower_volume (g,MD1) ) );
A411: k in ( Seg ( len ( lower_volume (g,MD1) ) ) ) by A409,A410,FINSEQ_1:1;
then A412: k in ( Seg ( len MD1 ) ) by INTEGRA1:def 7;
then A413: k in ( dom MD1 ) by FINSEQ_1:def 3;
k in ( dom MD1 ) by A412,FINSEQ_1:def 3;
then A414: ( ( lower_volume (g,MD1) ) . k ) = ( ( lower_bound ( rng ( g | ( divset (MD1,k) ) ) ) ) * ( vol ( divset (MD1,k) ) ) ) by INTEGRA1:def 7;
consider k2 being (Element of ( NAT )) such that A415: ( n1 + 1 ) = ( 1 + k2 );
A416: 1 <= ( k + k2 ) by A409,NAT_1:12;
k <= ( j - ( ( n1 + 1 ) - 1 ) ) by A371,A410;
then ( k + ( ( n1 + 1 ) - 1 ) ) <= j by XREAL_1:19;
then ( k + k2 ) <= ( len D1 ) by A266,A415,XXREAL_0:2;
then A417: ( k + k2 ) in ( Seg ( len D1 ) ) by A416,FINSEQ_1:1;
then A418: ( k + k2 ) in ( dom D1 ) by FINSEQ_1:def 3;
( 1 + 1 ) <= ( k + k2 ) by A258,A409,A415,XREAL_1:7;
then A419: 1 < ( k + k2 ) by NAT_1:13;
A420: k2 = ( ( n1 + 1 ) - 1 ) by A415;
A421: (( lower_bound ( divset (D1,( k + k2 )) ) ) = ( lower_bound ( divset (MD1,k) ) ) & ( upper_bound ( divset (D1,( k + k2 )) ) ) = ( upper_bound ( divset (MD1,k) ) ))
proof
per cases ;
suppose A422: k = 1;

then ( upper_bound ( divset (MD1,k) ) ) = ( MD1 . k ) by A413,INTEGRA1:def 4;
then A423: ( upper_bound ( divset (MD1,k) ) ) = ( D1 . ( ( k + ( n1 + 1 ) ) - 1 ) ) by A257,A266,A244,A357,A371,A409,A410,A411,FINSEQ_6:122;
( lower_bound ( divset (MD1,k) ) ) = ( D1 . n1 ) by A354,A413,A422,INTEGRA1:def 4;
hence thesis by A420,A419,A418,A422,A423,INTEGRA1:def 4;
end;
suppose A424: k <> 1;

then ( upper_bound ( divset (MD1,k) ) ) = ( MD1 . k ) by A413,INTEGRA1:def 4;
then A425: ( upper_bound ( divset (MD1,k) ) ) = ( D1 . ( ( k + ( n1 + 1 ) ) - 1 ) ) by A257,A266,A244,A357,A371,A409,A410,A411,FINSEQ_6:122;
A426: ( k - 1 ) <= ( ( j - ( n1 + 1 ) ) + 1 ) by A371,A410,XREAL_1:146,XXREAL_0:2;
A427: ( lower_bound ( divset (MD1,k) ) ) = ( MD1 . ( k - 1 ) ) by A413,A424,INTEGRA1:def 4;
A428: ( k - 1 ) in ( dom MD1 ) by A413,A424,INTEGRA1:7;
then 1 <= ( k - 1 ) by FINSEQ_3:25;
then ( lower_bound ( divset (MD1,k) ) ) = ( D1 . ( ( ( k - 1 ) + ( n1 + 1 ) ) - 1 ) ) by A257,A266,A244,A357,A428,A426,A427,FINSEQ_6:122;
hence thesis by A415,A419,A418,A425,INTEGRA1:def 4;
end;
end;
( divset (MD1,k) ) = [. ( lower_bound ( divset (MD1,k) ) ),( upper_bound ( divset (MD1,k) ) ) .] by INTEGRA1:4;
then A429: ( divset (D1,( k + k2 )) ) = ( divset (MD1,k) ) by A421,INTEGRA1:4;
A430: ( k + k2 ) in ( dom D1 ) by A417,FINSEQ_1:def 3;
A431: ( ( mid (LVf(D1),( n1 + 1 ),j) ) . k ) = ( LVf(D1) . ( ( k + ( n1 + 1 ) ) - 1 ) ) by A257,A244,A371,A407,A409,A410,A411,FINSEQ_6:122
.= ( ( lower_bound ( rng ( f | ( divset (D1,( k + k2 )) ) ) ) ) * ( vol ( divset (D1,( k + k2 )) ) ) ) by A415,A430,INTEGRA1:def 7;
k in ( dom MD1 ) by A412,FINSEQ_1:def 3;
then ( divset (D1,( k + k2 )) ) c= B by A429,INTEGRA1:8;
hence thesis by A414,A431,A429,FUNCT_1:51;
end;
A432: ( g | B ) is  bounded
proof
consider a being  real number such that A433: (for x being set holds (x in ( A /\ ( dom f ) ) implies a <= ( f . x ))) by A1,RFUNCT_1:71;
(for x being set holds (x in ( B /\ ( dom g ) ) implies a <= ( g . x )))
proof
let x being set;
A434: ( ( dom f ) /\ B ) c= ( ( dom f ) /\ A ) by A364,XBOOLE_1:26;
assume x in ( B /\ ( dom g ) );
then A435: x in ( dom g ) by XBOOLE_0:def 4;
then x in ( ( dom f ) /\ B ) by RELAT_1:61;
then a <= ( f . x ) by A433,A434;
hence thesis by A435,FUNCT_1:47;
end;
then A436: ( g | B ) is  bounded_below by RFUNCT_1:71;
consider a being  real number such that A437: (for x being set holds (x in ( A /\ ( dom f ) ) implies ( f . x ) <= a)) by A1,RFUNCT_1:70;
(for x being set holds (x in ( B /\ ( dom g ) ) implies ( g . x ) <= a))
proof
let x being set;
A438: ( ( dom f ) /\ B ) c= ( ( dom f ) /\ A ) by A364,XBOOLE_1:26;
assume x in ( B /\ ( dom g ) );
then A439: x in ( dom g ) by XBOOLE_0:def 4;
then x in ( ( dom f ) /\ B ) by RELAT_1:61;
then a >= ( f . x ) by A437,A438;
hence thesis by A439,FUNCT_1:47;
end;
then ( g | B ) is  bounded_above by RFUNCT_1:70;
hence thesis by A436;
end;
( rng f ) is  bounded_below by A1,INTEGRA1:11;
then A440: ( lower_bound ( rng f ) ) <= ( lower_bound ( rng g ) ) by RELAT_1:70,SEQ_4:47;
( rng f ) is  bounded_above by A1,INTEGRA1:13;
then ( upper_bound ( rng f ) ) >= ( upper_bound ( rng g ) ) by RELAT_1:70,SEQ_4:48;
then ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) >= ( ( upper_bound ( rng g ) ) - ( lower_bound ( rng g ) ) ) by A440,XREAL_1:13;
then A441: ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta MD1 ) ) >= ( ( ( upper_bound ( rng g ) ) - ( lower_bound ( rng g ) ) ) * ( delta MD1 ) ) by A359,XREAL_1:64;
A442: n1 < ( j - 1 ) by A351,XREAL_1:20;
A443: ( indx (D2,D1,j) ) <= ( len LVf(D2) ) by A263,INTEGRA1:def 7;
A444: ( len MD2 ) = ( ( ( indx (D2,D1,j) ) -' ( indx (D2,D1,( n1 + 1 )) ) ) + 1 ) by A272,A270,A277,A262,A263,A358,FINSEQ_6:118;
then A445: ( len MD2 ) = ( ( ( indx (D2,D1,j) ) - ( indx (D2,D1,( n1 + 1 )) ) ) + 1 ) by A272,XREAL_1:233;
then A446: ( len ( lower_volume (g,MD2) ) ) = ( ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,n1) ) + 1 ) ) + 1 ) by A390,INTEGRA1:def 7;
(x1 in ( ( rng MD1 ) \/ { ( D . ( i + 1 ) ) } ) implies x1 in ( rng MD2 ))
proof
assume A447: x1 in ( ( rng MD1 ) \/ { ( D . ( i + 1 ) ) } );
then reconsider x1 as Real;
now
per cases  by A447,XBOOLE_0:def 3;
suppose A448: x1 in ( rng MD1 );

( rng MD1 ) <> ( {} );
then 1 in ( dom MD1 ) by FINSEQ_3:32;
then A449: 1 <= ( len MD1 ) by FINSEQ_3:25;
( rng MD1 ) c= ( rng D1 ) by A357,FINSEQ_6:119;
then A450: x1 in ( rng D1 ) by A448;
( rng D1 ) c= ( rng D2 ) by A13,INTEGRA1:def 18;
then consider k such that A451: k in ( dom D2 ) and A452: ( D2 . k ) = x1 by A450,PARTFUN1:3;
( MD1 . 1 ) = ( D1 . ( n1 + 1 ) ) by A265,A266,A244,A267,A357,FINSEQ_6:118;
then ( D2 . ( indx (D2,D1,( n1 + 1 )) ) ) <= x1 by A271,A448,CKB30:1;
then A453: ( indx (D2,D1,( n1 + 1 )) ) <= k by A269,A451,A452,SEQM_3:def 1;
then consider n being Nat such that A454: ( k + 1 ) = ( ( indx (D2,D1,( n1 + 1 )) ) + n ) by NAT_1:10,NAT_1:12;
A455: ( len MD1 ) = ( ( j -' ( n1 + 1 ) ) + 1 ) by A257,A265,A266,A244,A267,A357,FINSEQ_6:118;
then ( ( ( len MD1 ) + ( n1 + 1 ) ) - 1 ) = ( ( ( ( j - ( n1 + 1 ) ) + 1 ) + ( n1 + 1 ) ) - 1 ) by A257,XREAL_1:233
.= j;
then ( MD1 . ( len MD1 ) ) = ( D1 . j ) by A257,A266,A244,A357,A449,A455,FINSEQ_6:122;
then x1 <= ( D2 . ( indx (D2,D1,j) ) ) by A238,A448,CKB30:1;
then k <= ( indx (D2,D1,j) ) by A261,A451,A452,SEQM_3:def 1;
then ( k - ( indx (D2,D1,( n1 + 1 )) ) ) <= ( ( indx (D2,D1,j) ) - ( indx (D2,D1,( n1 + 1 )) ) ) by XREAL_1:9;
then A456: ( ( k - ( indx (D2,D1,( n1 + 1 )) ) ) + 1 ) <= ( ( ( indx (D2,D1,j) ) - ( indx (D2,D1,( n1 + 1 )) ) ) + 1 ) by XREAL_1:6;
( ( indx (D2,D1,( n1 + 1 )) ) + 1 ) <= ( k + 1 ) by A453,XREAL_1:6;
then A457: 1 <= ( ( k + 1 ) - ( indx (D2,D1,( n1 + 1 )) ) ) by XREAL_1:19;
then A458: n in ( dom MD2 ) by A445,A456,A454,FINSEQ_3:25;
n in ( NAT ) by ORDINAL1:def 12;
then ( MD2 . n ) = ( D2 . ( ( n + ( indx (D2,D1,( n1 + 1 )) ) ) - 1 ) ) by A272,A270,A263,A358,A457,A456,A454,FINSEQ_6:122
.= ( D2 . k ) by A454;
hence x1 in ( rng MD2 ) by A452,A458,FUNCT_1:def 3;
end;
suppose x1 in { ( D . ( i + 1 ) ) };

then A459: x1 = ( D . ( i + 1 ) ) by TARSKI:def 1;
reconsider j1 = ( j - 1 ) as (Element of ( NAT )) by A236,A245,A280,INTEGRA1:7;
A460: ( rng D ) c= ( rng D2 ) by A12,INTEGRA1:def 18;
( D . ( i + 1 ) ) in ( rng D ) by A235,FUNCT_1:def 3;
then consider k such that A461: k in ( dom D2 ) and A462: x1 = ( D2 . k ) by A459,A460,PARTFUN1:3;
( D . ( i + 1 ) ) <= ( upper_bound ( divset (D1,j) ) ) by A237,INTEGRA2:1;
then x1 <= ( D1 . j ) by A236,A245,A280,A459,INTEGRA1:def 4;
then A463: ( D2 . k ) <= ( D2 . ( indx (D2,D1,j) ) ) by A13,A236,A462,INTEGRA1:def 19;
n1 < j1 by A351,XREAL_1:20;
then A464: ( n1 + 1 ) <= j1 by NAT_1:13;
( j - 1 ) in ( dom D1 ) by A236,A245,A280,INTEGRA1:7;
then A465: ( D1 . ( n1 + 1 ) ) <= ( D1 . ( j - 1 ) ) by A268,A464,SEQ_4:137;
( lower_bound ( divset (D1,j) ) ) <= ( D . ( i + 1 ) ) by A237,INTEGRA2:1;
then ( D1 . ( j - 1 ) ) <= x1 by A236,A245,A280,A459,INTEGRA1:def 4;
then ( D2 . ( indx (D2,D1,( n1 + 1 )) ) ) <= ( D2 . k ) by A271,A462,A465,XXREAL_0:2;
hence x1 in ( rng MD2 ) by A269,A261,A358,A461,A462,A463,CKB31:1;
end;
end;
hence thesis;
end;
then A466: ( ( rng MD1 ) \/ { ( D . ( i + 1 ) ) } ) c= ( rng MD2 ) by TARSKI:def 3;
( rng MD2 ) <> ( {} );
then 1 in ( dom MD2 ) by FINSEQ_3:32;
then A467: 1 <= ( len MD2 ) by FINSEQ_3:25;
A468: ( ( ( len MD2 ) - 1 ) + ( indx (D2,D1,( n1 + 1 )) ) ) = ( indx (D2,D1,j) ) by A445;
(x1 in ( rng MD2 ) implies x1 in ( ( rng MD1 ) \/ { ( D . ( i + 1 ) ) } ))
proof
assume A469: x1 in ( rng MD2 );
then reconsider x1 as Real;
( MD2 . 1 ) = ( D2 . ( indx (D2,D1,( n1 + 1 )) ) ) by A270,A277,A262,A263,A358,FINSEQ_6:118;
then A470: ( D1 . ( n1 + 1 ) ) <= x1 by A271,A469,CKB30:1;
( MD2 . ( len MD2 ) ) = ( D2 . ( indx (D2,D1,j) ) ) by A272,A270,A263,A358,A467,A444,A468,FINSEQ_6:122;
then A471: x1 <= ( D1 . j ) by A238,A469,CKB30:1;
A472: ( rng MD2 ) c= ( rng D2 ) by A358,FINSEQ_6:119;
now
per cases  by A14,A469,A472,XBOOLE_0:def 3;
suppose x1 in ( rng D1 );

then consider k such that A473: k in ( dom D1 ) and A474: ( D1 . k ) = x1 by PARTFUN1:3;
A475: ( n1 + 1 ) <= k by A268,A470,A473,A474,SEQM_3:def 1;
then A476: 1 <= ( k - n1 ) by XREAL_1:19;
n1 <= ( n1 + 1 ) by NAT_1:11;
then consider n being Nat such that A477: k = ( n1 + n ) by A475,NAT_1:10,XXREAL_0:2;
A478: k <= j by A236,A471,A473,A474,SEQM_3:def 1;
then ( k - n1 ) <= ( len MD1 ) by A363,XREAL_1:9;
then n in ( dom MD1 ) by A476,A477,FINSEQ_3:25;
then A479: ( MD1 . n ) in ( rng MD1 ) by FUNCT_1:def 3;
( ( j - ( n1 + 1 ) ) + 1 ) = ( j - n1 );
then A480: ( k - n1 ) <= ( ( j - ( n1 + 1 ) ) + 1 ) by A478,XREAL_1:9;
n in ( NAT ) by ORDINAL1:def 12;
then ( MD1 . n ) = ( D1 . ( ( ( k - n1 ) - 1 ) + ( n1 + 1 ) ) ) by A257,A266,A244,A357,A476,A480,A477,FINSEQ_6:122
.= ( D1 . k );
hence x1 in ( ( rng MD1 ) \/ { ( D . ( i + 1 ) ) } ) by A474,A479,XBOOLE_0:def 3;
end;
suppose x1 in ( rng D );

then consider n such that A481: n in ( dom D ) and A482: ( D . n ) = x1 by PARTFUN1:3;
A483: (not ( i + 1 ) < n)
proof
A484: ( upper_bound ( divset (D1,j) ) ) = ( D1 . j )
proof
per cases ;
suppose j = 1;

hence thesis by A236,INTEGRA1:def 4;
end;
suppose j <> 1;

hence thesis by A236,INTEGRA1:def 4;
end;
end;
consider y1 being Real such that A485: y1 = ( D . ( i + 1 ) );
A486: ( D . n ) in ( rng D ) by A481,FUNCT_1:def 3;
assume ( i + 1 ) < n;
then A487: ( D . ( i + 1 ) ) < ( D . n ) by A235,A481,SEQM_3:def 1;
( lower_bound ( divset (D1,j) ) ) <= ( D . ( i + 1 ) ) by A237,INTEGRA2:1;
then ( lower_bound ( divset (D1,j) ) ) <= ( D . n ) by A487,XXREAL_0:2;
then ( D . n ) in ( divset (D1,j) ) by A471,A482,A484,INTEGRA2:1;
then A488: x1 in ( ( rng D ) /\ ( divset (D1,j) ) ) by A482,A486,XBOOLE_0:def 4;
( D . ( i + 1 ) ) in ( rng D ) by A235,FUNCT_1:def 3;
then y1 in ( ( rng D ) /\ ( divset (D1,j) ) ) by A237,A485,XBOOLE_0:def 4;
hence contradiction by A11,A236,A482,A487,A488,A485,CKB9:1;
end;
A489: ( upper_bound ( divset (D1,n1) ) ) = ( D1 . n1 )
proof
per cases ;
suppose n1 = 1;

hence thesis by A241,INTEGRA1:def 4;
end;
suppose n1 <> 1;

hence thesis by A241,INTEGRA1:def 4;
end;
end;
( D . i ) <= ( upper_bound ( divset (D1,n1) ) ) by A242,INTEGRA2:1;
then ( D . i ) < ( D1 . ( n1 + 1 ) ) by A353,A489,XXREAL_0:2;
then ( D . i ) < ( D . n ) by A470,A482,XXREAL_0:2;
then i < n by A240,A481,SEQ_4:137;
then ( i + 1 ) <= n by NAT_1:13;
then (( i + 1 ) = n or ( i + 1 ) < n) by XXREAL_0:1;
then x1 in { ( D . ( i + 1 ) ) } by A482,A483,TARSKI:def 1;
hence x1 in ( ( rng MD1 ) \/ { ( D . ( i + 1 ) ) } ) by XBOOLE_0:def 3;
end;
end;
hence thesis;
end;
then ( rng MD2 ) c= ( ( rng MD1 ) \/ { ( D . ( i + 1 ) ) } ) by TARSKI:def 3;
then A490: ( rng MD2 ) = ( ( rng MD1 ) \/ { ( D . ( i + 1 ) ) } ) by A466,XBOOLE_0:def 10;
( delta MD1 ) in ( rng ( upper_volume (( chi (B,B) ),MD1) ) ) by XXREAL_2:def 8;
then consider k such that A491: k in ( dom ( upper_volume (( chi (B,B) ),MD1) ) ) and A492: ( ( upper_volume (( chi (B,B) ),MD1) ) . k ) = ( delta MD1 ) by PARTFUN1:3;
A493: k in ( Seg ( len ( upper_volume (( chi (B,B) ),MD1) ) ) ) by A491,FINSEQ_1:def 3;
then A494: k in ( Seg ( len MD1 ) ) by INTEGRA1:def 6;
then A495: k in ( dom MD1 ) by FINSEQ_1:def 3;
A496: k <= ( len MD1 ) by A494,FINSEQ_1:1;
then ( k + n1 ) <= j by A363,XREAL_1:19;
then A497: ( k + n1 ) <= ( len D1 ) by A266,XXREAL_0:2;
A498: 1 <= k by A493,FINSEQ_1:1;
A499: ( n1 + 1 ) > 1 by A280,NAT_1:13;
then n1 > ( 1 - 1 ) by XREAL_1:19;
then A500: k < ( k + n1 ) by XREAL_1:29;
then 1 < ( k + n1 ) by A498,XXREAL_0:2;
then A501: ( k + n1 ) in ( dom D1 ) by A497,FINSEQ_3:25;
(( lower_bound ( divset (MD1,k) ) ) = ( lower_bound ( divset (D1,( k + n1 )) ) ) & ( upper_bound ( divset (MD1,k) ) ) = ( upper_bound ( divset (D1,( k + n1 )) ) ))
proof
per cases ;
suppose A502: k = 1;

then ( upper_bound ( divset (MD1,k) ) ) = ( MD1 . k ) by A495,INTEGRA1:def 4;
then A503: ( upper_bound ( divset (MD1,k) ) ) = ( D1 . ( ( k + ( n1 + 1 ) ) - 1 ) ) by A257,A266,A244,A357,A360,A498,A496,FINSEQ_6:122;
( lower_bound ( divset (D1,( k + n1 )) ) ) = ( D1 . ( ( k + n1 ) - 1 ) ) by A498,A500,A501,INTEGRA1:def 4;
hence thesis by A354,A499,A495,A501,A502,A503,INTEGRA1:def 4;
end;
suppose A504: k <> 1;

then ( upper_bound ( divset (MD1,k) ) ) = ( MD1 . k ) by A495,INTEGRA1:def 4;
then A505: ( upper_bound ( divset (MD1,k) ) ) = ( D1 . ( ( k + ( n1 + 1 ) ) - 1 ) ) by A257,A266,A244,A357,A360,A498,A496,FINSEQ_6:122;
A506: ( lower_bound ( divset (MD1,k) ) ) = ( MD1 . ( k - 1 ) ) by A495,A504,INTEGRA1:def 4;
A507: ( k - 1 ) in ( dom MD1 ) by A495,A504,INTEGRA1:7;
then A508: ( k - 1 ) <= ( len MD1 ) by FINSEQ_3:25;
1 <= ( k - 1 ) by A507,FINSEQ_3:25;
then ( lower_bound ( divset (MD1,k) ) ) = ( D1 . ( ( ( k - 1 ) + ( n1 + 1 ) ) - 1 ) ) by A257,A266,A244,A357,A360,A507,A508,A506,FINSEQ_6:122;
hence thesis by A498,A500,A501,A505,INTEGRA1:def 4;
end;
end;
then ( divset (MD1,k) ) = [. ( lower_bound ( divset (D1,( k + n1 )) ) ),( upper_bound ( divset (D1,( k + n1 )) ) ) .] by INTEGRA1:4;
then A509: ( divset (MD1,k) ) = ( divset (D1,( k + n1 )) ) by INTEGRA1:4;
( k + n1 ) in ( Seg ( len D1 ) ) by A501,FINSEQ_1:def 3;
then ( k + n1 ) in ( Seg ( len ( upper_volume (( chi (A,A) ),D1) ) ) ) by INTEGRA1:def 6;
then A510: ( k + n1 ) in ( dom ( upper_volume (( chi (A,A) ),D1) ) ) by FINSEQ_1:def 3;
k in ( dom MD1 ) by A494,FINSEQ_1:def 3;
then ( delta MD1 ) = ( vol ( divset (MD1,k) ) ) by A492,INTEGRA1:20;
then ( delta MD1 ) = ( ( upper_volume (( chi (A,A) ),D1) ) . ( k + n1 ) ) by A501,A509,INTEGRA1:20;
then ( delta MD1 ) in ( rng ( upper_volume (( chi (A,A) ),D1) ) ) by A510,FUNCT_1:def 3;
then ( delta MD1 ) <= ( max ( rng ( upper_volume (( chi (A,A) ),D1) ) ) ) by XXREAL_2:def 8;
then A511: ( delta MD1 ) <= ( delta D1 );
( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) >= ( 0 ) by A1,CKB14:1,XREAL_1:48;
then A512: ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta MD1 ) ) <= ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta D1 ) ) by A511,XREAL_1:64;
( lower_bound ( divset (D1,j) ) ) <= ( D . ( i + 1 ) ) by A237,INTEGRA2:1;
then A513: ( D1 . ( j - 1 ) ) <= ( D . ( i + 1 ) ) by A236,A245,A280,INTEGRA1:def 4;
A514: ( D . ( i + 1 ) ) <= ( upper_bound ( divset (D1,j) ) ) by A237,INTEGRA2:1;
A515: ( ( indx (D2,D1,n1) ) + 1 ) <= ( indx (D2,D1,j) ) by A272,A385,XXREAL_0:2;
A516: (for k being Nat holds ((1 <= k & k <= ( len ( lower_volume (g,MD2) ) )) implies ( ( lower_volume (g,MD2) ) . k ) = ( ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) . k )))
proof
let k being Nat;
assume that
A517: 1 <= k
and
A518: k <= ( len ( lower_volume (g,MD2) ) );
A519: k in ( Seg ( len ( lower_volume (g,MD2) ) ) ) by A517,A518,FINSEQ_1:1;
then A520: ( ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) . k ) = ( LVf(D2) . ( ( k + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) ) by A388,A446,A443,A515,A517,A518,FINSEQ_6:122;
1 <= ( ( indx (D2,D1,n1) ) + 1 ) by NAT_1:12;
then ( 1 + 1 ) <= ( k + ( ( indx (D2,D1,n1) ) + 1 ) ) by A517,XREAL_1:7;
then A521: 1 <= ( ( k + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) by XREAL_1:19;
consider k2 being (Element of ( NAT )) such that A522: ( ( indx (D2,D1,n1) ) + 1 ) = ( 1 + k2 );
k <= ( ( indx (D2,D1,j) ) - ( ( ( indx (D2,D1,n1) ) + 1 ) - 1 ) ) by A445,A390,A518,INTEGRA1:def 7;
then ( k + ( ( ( indx (D2,D1,n1) ) + 1 ) - 1 ) ) <= ( indx (D2,D1,j) ) by XREAL_1:19;
then ( ( k + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) <= ( len LVf(D2) ) by A443,XXREAL_0:2;
then ( k + k2 ) in ( Seg ( len LVf(D2) ) ) by A521,A522,FINSEQ_1:1;
then A523: ( k + k2 ) in ( Seg ( len D2 ) ) by INTEGRA1:def 7;
then ( k + k2 ) in ( dom D2 ) by FINSEQ_1:def 3;
then A524: ( ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) . k ) = ( ( lower_bound ( rng ( f | ( divset (D2,( k + k2 )) ) ) ) ) * ( vol ( divset (D2,( k + k2 )) ) ) ) by A520,A522,INTEGRA1:def 7;
A525: k in ( Seg ( len MD2 ) ) by A519,INTEGRA1:def 7;
A526: (( lower_bound ( divset (MD2,k) ) ) = ( lower_bound ( divset (D2,( k + k2 )) ) ) & ( upper_bound ( divset (MD2,k) ) ) = ( upper_bound ( divset (D2,( k + k2 )) ) ))
proof
( k + k2 ) >= ( 1 + 1 ) by A260,A517,A522,XREAL_1:7;
then A527: ( k + k2 ) > 1 by NAT_1:13;
A528: k in ( dom MD2 ) by A525,FINSEQ_1:def 3;
A529: ( k + k2 ) in ( dom D2 ) by A523,FINSEQ_1:def 3;
per cases ;
suppose A530: k = 1;

then ( upper_bound ( divset (MD2,k) ) ) = ( MD2 . k ) by A528,INTEGRA1:def 4;
then A531: ( upper_bound ( divset (MD2,k) ) ) = ( D2 . ( ( k + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) ) by A272,A263,A358,A388,A390,A446,A517,A518,A519,FINSEQ_6:122;
A532: ( lower_bound ( divset (D2,( k + k2 )) ) ) = ( D2 . ( ( k + k2 ) - 1 ) ) by A527,A529,INTEGRA1:def 4;
( lower_bound ( divset (MD2,k) ) ) = ( D1 . n1 ) by A354,A528,A530,INTEGRA1:def 4;
hence thesis by A13,A241,A522,A527,A529,A530,A531,A532,INTEGRA1:def 4,INTEGRA1:def 19;
end;
suppose A533: k <> 1;

then ( upper_bound ( divset (MD2,k) ) ) = ( MD2 . k ) by A528,INTEGRA1:def 4;
then A534: ( upper_bound ( divset (MD2,k) ) ) = ( D2 . ( ( k + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) ) by A272,A263,A358,A388,A390,A446,A517,A518,A519,FINSEQ_6:122;
A535: ( k - 1 ) <= ( ( ( indx (D2,D1,j) ) - ( ( indx (D2,D1,n1) ) + 1 ) ) + 1 ) by A446,A518,XREAL_1:146,XXREAL_0:2;
A536: ( lower_bound ( divset (MD2,k) ) ) = ( MD2 . ( k - 1 ) ) by A528,A533,INTEGRA1:def 4;
A537: ( k - 1 ) in ( dom MD2 ) by A528,A533,INTEGRA1:7;
then 1 <= ( k - 1 ) by FINSEQ_3:25;
then ( lower_bound ( divset (MD2,k) ) ) = ( D2 . ( ( ( k - 1 ) + ( ( indx (D2,D1,n1) ) + 1 ) ) - 1 ) ) by A272,A263,A358,A388,A390,A537,A535,A536,FINSEQ_6:122;
hence thesis by A522,A527,A529,A534,INTEGRA1:def 4;
end;
end;
( divset (MD2,k) ) = [. ( lower_bound ( divset (MD2,k) ) ),( upper_bound ( divset (MD2,k) ) ) .] by INTEGRA1:4;
then A538: ( divset (MD2,k) ) = ( divset (D2,( k + k2 )) ) by A526,INTEGRA1:4;
k in ( dom MD2 ) by A525,FINSEQ_1:def 3;
then ( divset (D2,( k + k2 )) ) c= B by A538,INTEGRA1:8;
then A539: ( rng ( f | ( divset (D2,( k + k2 )) ) ) ) = ( rng ( g | ( divset (D2,( k + k2 )) ) ) ) by FUNCT_1:51;
k in ( dom MD2 ) by A525,FINSEQ_1:def 3;
hence thesis by A524,A538,A539,INTEGRA1:def 7;
end;
( lower_bound ( divset (D1,j) ) ) <= ( D . ( i + 1 ) ) by A237,INTEGRA2:1;
then A540: ( D . ( i + 1 ) ) in ( divset (MD1,( len MD1 )) ) by A374,A514,INTEGRA2:1;
( j - 1 ) in ( dom D1 ) by A236,A245,A280,INTEGRA1:7;
then ( D1 . n1 ) < ( D1 . ( j - 1 ) ) by A241,A442,SEQM_3:def 1;
then ( D . ( i + 1 ) ) > ( lower_bound B ) by A354,A513,XXREAL_0:2;
then ( ( Sum ( lower_volume (g,MD2) ) ) - ( Sum ( lower_volume (g,MD1) ) ) ) <= ( ( ( upper_bound ( rng g ) ) - ( lower_bound ( rng g ) ) ) * ( delta MD1 ) ) by A356,A432,A490,A540,A387,CKB27:1;
then A541: ( ( Sum ( lower_volume (g,MD2) ) ) - ( Sum ( lower_volume (g,MD1) ) ) ) <= ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta MD1 ) ) by A441,XXREAL_0:2;
( ( indx (D2,D1,n1) ) + 1 ) <= ( len LVf(D2) ) by A386,INTEGRA1:def 7;
then ( len ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) = ( ( ( indx (D2,D1,j) ) -' ( ( indx (D2,D1,n1) ) + 1 ) ) + 1 ) by A262,A388,A443,A515,FINSEQ_6:118;
then ( len ( lower_volume (g,MD2) ) ) = ( len ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) by A272,A385,A446,XREAL_1:233,XXREAL_0:2;
then A542: ( Sum ( lower_volume (g,MD2) ) ) = ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) by A516,FINSEQ_1:14;
( n1 + 1 ) <= ( len LVf(D1) ) by A267,INTEGRA1:def 7;
then ( len ( mid (LVf(D1),( n1 + 1 ),j) ) ) = ( ( j -' ( n1 + 1 ) ) + 1 ) by A257,A265,A244,A407,FINSEQ_6:118
.= ( ( j - ( n1 + 1 ) ) + 1 ) by A257,XREAL_1:233;
then ( Sum ( lower_volume (g,MD1) ) ) = ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) by A371,A408,FINSEQ_1:14;
hence thesis by A541,A512,A542,XXREAL_0:2;
end;
end;
hence thesis;
end;
then A543: ( ( PLf(D2,( indx (D2,D1,n1) )) - PLf(D1,n1) ) + ( ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) - ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) ) ) <= ( ( ( i * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) ) + ( ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) * ( delta D1 ) ) ) by A243,XREAL_1:7;
n1 < ( n1 + 1 ) by NAT_1:13;
then ( D1 . n1 ) < ( D1 . ( n1 + 1 ) ) by A241,A268,SEQM_3:def 1;
then ( indx (D2,D1,n1) ) < ( indx (D2,D1,( n1 + 1 )) ) by A259,A274,A269,A271,SEQ_4:137;
then A544: ( indx (D2,D1,n1) ) < ( indx (D2,D1,j) ) by A272,XXREAL_0:2;
( indx (D2,D1,n1) ) in ( Seg ( len D2 ) ) by A259,FINSEQ_1:def 3;
then ( indx (D2,D1,n1) ) in ( Seg ( len LVf(D2) ) ) by INTEGRA1:def 7;
then ( indx (D2,D1,n1) ) in ( dom LVf(D2) ) by FINSEQ_1:def 3;
then PLf(D2,( indx (D2,D1,n1) )) = ( Sum ( LVf(D2) | ( indx (D2,D1,n1) ) ) ) by INTEGRA1:def 20
.= ( Sum ( mid (LVf(D2),1,( indx (D2,D1,n1) )) ) ) by A260,FINSEQ_6:116;
then ( PLf(D2,( indx (D2,D1,n1) )) + ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) ) = ( Sum ( ( mid (LVf(D2),1,( indx (D2,D1,n1) )) ) ^ ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) ) by RVSUM_1:75
.= ( Sum ( mid (LVf(D2),1,( indx (D2,D1,j) )) ) ) by A260,A544,A264,INTEGRA2:4
.= ( Sum ( LVf(D2) | ( indx (D2,D1,j) ) ) ) by A262,FINSEQ_6:116;
then PLf(D2,( indx (D2,D1,j) )) = ( PLf(D2,( indx (D2,D1,n1) )) + ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) ) by A279,INTEGRA1:def 20;
then ( ( PLf(D2,( indx (D2,D1,n1) )) - PLf(D1,n1) ) + ( ( Sum ( mid (LVf(D2),( ( indx (D2,D1,n1) ) + 1 ),( indx (D2,D1,j) )) ) ) - ( Sum ( mid (LVf(D1),( n1 + 1 ),j) ) ) ) ) = ( PLf(D2,( indx (D2,D1,j) )) - PLf(D1,j) ) by A278;
hence thesis by A236,A237,A543;
end;
hence thesis;
end;
(for k being non  empty Nat holds P[ k ]) from NAT_1:sch 10(A40,A231);
then P[ i ];
hence thesis by A17;
end;
A545: ( len D1 ) in ( dom D1 ) by FINSEQ_5:6;
then ( D1 . ( len D1 ) ) = ( D2 . ( indx (D2,D1,( len D1 )) ) ) by A13,INTEGRA1:def 19;
then ( upper_bound A ) = ( D2 . ( indx (D2,D1,( len D1 )) ) ) by INTEGRA1:def 2;
then A546: ( D2 . ( len D2 ) ) = ( D2 . ( indx (D2,D1,( len D1 )) ) ) by INTEGRA1:def 2;
( len D ) in ( dom D ) by FINSEQ_5:6;
then consider j such that A547: j in ( dom D1 ) and A548: ( D . ( len D ) ) in ( divset (D1,j) ) and A549: ( PLf(D2,( indx (D2,D1,j) )) - PLf(D1,j) ) <= ( ( ( len D ) * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) ) by A16;
A550: j = ( len D1 )
proof
assume A551: j <> ( len D1 );
j <= ( len D1 ) by A547,FINSEQ_3:25;
then j < ( len D1 ) by A551,XXREAL_0:1;
then ( D1 . j ) < ( D1 . ( len D1 ) ) by A547,A545,SEQM_3:def 1;
then A552: ( D1 . j ) < ( upper_bound A ) by INTEGRA1:def 2;
A553: ( upper_bound ( divset (D1,j) ) ) < ( upper_bound A )
proof
per cases ;
suppose j = 1;

hence thesis by A547,A552,INTEGRA1:def 4;
end;
suppose j <> 1;

hence thesis by A547,A552,INTEGRA1:def 4;
end;
end;
( D . ( len D ) ) <= ( upper_bound ( divset (D1,j) ) ) by A548,INTEGRA2:1;
hence contradiction by A553,INTEGRA1:def 2;
end;
( indx (D2,D1,( len D1 )) ) in ( dom D2 ) by A13,A545,INTEGRA1:def 19;
then ( indx (D2,D1,( len D1 )) ) = ( len D2 ) by A15,A546,SEQ_4:138;
then ( PLf(D2,( len D2 )) - ( lower_sum (f,D1) ) ) <= ( ( ( len D ) * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) ) by A549,A550,INTEGRA1:43;
hence thesis by INTEGRA1:43;
end;
hence thesis by A12,A13,A14;
end;
hence thesis;
end;
A554: ( lim ( delta T ) ) = ( 0 ) by A2,FDIFF_1:def 1;
A555: ( delta T ) is  non-zero by A2,FDIFF_1:def 1;
A556: (for e holds (e > ( 0 ) implies (ex n st (for m holds (n <= m implies (( 0 ) < ( ( delta T ) . m ) & ( ( delta T ) . m ) < e))))))
proof
let e;
assume e > ( 0 );
then consider n such that A557: (for m holds (n <= m implies ( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) < e)) by A4,A554,SEQ_2:def 7;
(for m holds (n <= m implies (( 0 ) < ( ( delta T ) . m ) & ( ( delta T ) . m ) < e)))
proof
let m;
A558: ( ( delta T ) . m ) = ( delta ( T . m ) ) by CKB4:def 1;
( delta ( T . m ) ) in ( rng ( upper_volume (( chi (A,A) ),( T . m )) ) ) by XXREAL_2:def 8;
then consider i such that A559: i in ( dom ( upper_volume (( chi (A,A) ),( T . m )) ) ) and A560: ( delta ( T . m ) ) = ( ( upper_volume (( chi (A,A) ),( T . m )) ) . i ) by PARTFUN1:3;
consider D being (Division of A) such that A561: D = ( T . m );
i in ( Seg ( len ( upper_volume (( chi (A,A) ),( T . m )) ) ) ) by A559,FINSEQ_1:def 3;
then i in ( Seg ( len D ) ) by A561,INTEGRA1:def 6;
then i in ( dom D ) by FINSEQ_1:def 3;
then A562: ( delta ( T . m ) ) = ( vol ( divset (( T . m ),i) ) ) by A560,A561,INTEGRA1:20;
assume n <= m;
then ( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) < e by A557;
then A563: ( ( ( delta T ) . m ) + ( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) ) < ( e + ( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) ) by ABSVALUE:4,XREAL_1:8;
( ( delta T ) . m ) <> ( 0 ) by A555,SEQ_1:5;
hence thesis by A563,A558,A562,INTEGRA1:9,XREAL_1:6;
end;
hence thesis;
end;
A564: (for e being  real number holds (e > ( 0 ) implies (ex n st (for m holds (n <= m implies ( abs ( ( ( lower_sum (f,T) ) . m ) - ( lower_integral f ) ) ) < e)))))
proof
set h = ( lower_bound ( rng f ) );
set H = ( upper_bound ( rng f ) );
let e being  real number;
assume A565: e > ( 0 );
then A566: ( e / 2 ) > ( 0 ) by XREAL_1:139;
reconsider e as Real by XREAL_0:def 1;
A567: ( H - h ) >= ( 0 ) by A1,CKB14:1,XREAL_1:48;
A569: ( rng ( lower_sum_set f ) ) is  bounded_above by A1,INTEGRA2:36;
( lower_integral f ) = ( upper_bound ( rng ( lower_sum_set f ) ) ) by INTEGRA1:def 15;
then consider y being  real number such that A570: y in ( rng ( lower_sum_set f ) ) and A571: ( ( lower_integral f ) - ( e / 2 ) ) < y by A566,A569,SEQ_4:def 1;
consider D being (Division of A) such that D in ( dom ( lower_sum_set f ) ) and A573: y = ( ( lower_sum_set f ) . D ) and A574: ( D . 1 ) > ( lower_bound A ) by A3,A570,CKB20:1;
deffunc F(Nat) = ( vol ( divset (D,$1) ) );
set p = ( len D );
consider v being (FinSequence of ( REAL )) such that A575: (( len v ) = ( len D ) & (for j being Nat holds (j in ( dom v ) implies ( v . j ) = F(j)))) from FINSEQ_2:sch 1;
consider v1 being  non-decreasing (FinSequence of ( REAL )) such that A576: v,v1 are_fiberwise_equipotent  by INTEGRA2:3;
defpred P[ Nat ]
 means
($1 in ( dom v1 ) & ( v1 . $1 ) > ( 0 ));
A577: ( dom v ) = ( Seg ( len D ) ) by A575,FINSEQ_1:def 3;
A578: (ex k being Nat st P[ k ])
proof
consider H being Function such that ( dom H ) = ( dom v ) and ( rng H ) = ( dom v1 ) and H is  one-to-one and A579: v = ( v1 * H ) by A576,CLASSES1:77;
consider k such that A580: k in ( dom D ) and A581: ( vol ( divset (D,k) ) ) > ( 0 ) by A3,CKB6:1;
A582: ( dom D ) = ( Seg ( len v ) ) by A575,FINSEQ_1:def 3;
then ( H . k ) in ( dom v1 ) by A575,A577,A579,A580,FUNCT_1:11;
then reconsider Hk = ( H . k ) as Nat;
( v . k ) > ( 0 ) by A575,A577,A580,A581,A582;
then P[ Hk ] by A575,A577,A579,A580,A582,FUNCT_1:11,FUNCT_1:12;
hence thesis;
end;
consider k being Nat such that A583: (P[ k ] & (for n being Nat holds (P[ n ] implies k <= n))) from NAT_1:sch 5(A578);
A584: ( 2 * p ) > ( 0 ) by XREAL_1:129;
then A585: ( ( 2 * p ) * ( ( H - h ) + 1 ) ) > ( 0 ) by A567,XREAL_1:129;
( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) ) > ( 0 )
proof
per cases  by XXREAL_0:15;
suppose ( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) ) = ( v1 . k );

hence thesis by A583;
end;
suppose ( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) ) = ( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) );

hence thesis by A565,A585,XREAL_1:139;
end;
end;
then consider n such that A586: (for m holds (n <= m implies (( 0 ) < ( ( delta T ) . m ) & ( ( delta T ) . m ) < ( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) )))) by A556;
take n;
A587: y = ( lower_sum (f,D) ) by A573,INTEGRA1:def 11;
(for m holds (n <= m implies ( abs ( ( ( lower_sum (f,T) ) . m ) - ( lower_integral f ) ) ) < e))
proof
A588: ( v1 . 1 ) > ( 0 )
proof
A589: (for n1 being (Element of ( NAT )) holds (n1 in ( dom D ) implies ( vol ( divset (D,n1) ) ) > ( 0 )))
proof
let n1 being (Element of ( NAT ));
assume A590: n1 in ( dom D );
then A591: 1 <= n1 by FINSEQ_3:25;
per cases  by A591,XXREAL_0:1;
suppose A592: n1 = 1;

then A593: ( upper_bound ( divset (D,n1) ) ) = ( D . n1 ) by A590,INTEGRA1:def 4;
( lower_bound ( divset (D,n1) ) ) = ( lower_bound A ) by A590,A592,INTEGRA1:def 4;
then ( vol ( divset (D,n1) ) ) = ( ( D . n1 ) - ( lower_bound A ) ) by A593,INTEGRA1:def 5;
hence thesis by A574,A592,XREAL_1:50;
end;
suppose A594: n1 > 1;

then A595: ( upper_bound ( divset (D,n1) ) ) = ( D . n1 ) by A590,INTEGRA1:def 4;
( lower_bound ( divset (D,n1) ) ) = ( D . ( n1 - 1 ) ) by A590,A594,INTEGRA1:def 4;
then A596: ( vol ( divset (D,n1) ) ) = ( ( D . n1 ) - ( D . ( n1 - 1 ) ) ) by A595,INTEGRA1:def 5;
n1 < ( n1 + 1 ) by XREAL_1:29;
then A597: ( n1 - 1 ) < n1 by XREAL_1:19;
( n1 - 1 ) in ( dom D ) by A590,A594,INTEGRA1:7;
then ( D . ( n1 - 1 ) ) < ( D . n1 ) by A590,A597,SEQM_3:def 1;
hence thesis by A596,XREAL_1:50;
end;
end;
A598: k <= ( len v1 ) by A583,FINSEQ_3:25;
1 <= k by A583,FINSEQ_3:25;
then 1 <= ( len v1 ) by A598,XXREAL_0:2;
then 1 in ( dom v1 ) by FINSEQ_3:25;
then A599: ( v1 . 1 ) in ( rng v1 ) by FUNCT_1:def 3;
( rng v ) = ( rng v1 ) by A576,CLASSES1:75;
then consider n1 being (Element of ( NAT )) such that A600: n1 in ( dom v ) and A601: ( v1 . 1 ) = ( v . n1 ) by A599,PARTFUN1:3;
n1 in ( Seg ( len D ) ) by A575,A600,FINSEQ_1:def 3;
then A602: n1 in ( dom D ) by FINSEQ_1:def 3;
( v1 . 1 ) = ( vol ( divset (D,n1) ) ) by A575,A600,A601;
hence thesis by A589,A602;
end;
A603: ( v1 . k ) = ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) )
proof
A604: k = 1
proof
( len v1 ) = ( len v ) by A576,RFINSEQ:3;
then k in ( Seg ( len v ) ) by A583,FINSEQ_1:def 3;
then A605: 1 <= k by FINSEQ_1:1;
k in ( Seg ( len v1 ) ) by A583,FINSEQ_1:def 3;
then k <= ( len v1 ) by FINSEQ_1:1;
then 1 <= ( len v1 ) by A605,XXREAL_0:2;
then A606: 1 in ( dom v1 ) by FINSEQ_3:25;
assume k <> 1;
then k > 1 by A605,XXREAL_0:1;
hence contradiction by A583,A588,A606;
end;
( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by XXREAL_2:def 7;
then consider m such that A607: m in ( dom ( upper_volume (( chi (A,A) ),D) ) ) and A608: ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) = ( ( upper_volume (( chi (A,A) ),D) ) . m ) by PARTFUN1:3;
m in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by A607,FINSEQ_1:def 3;
then A609: m in ( Seg ( len D ) ) by INTEGRA1:def 6;
then m in ( dom D ) by FINSEQ_1:def 3;
then ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) = ( vol ( divset (D,m) ) ) by A608,INTEGRA1:20;
then A610: ( v . m ) = ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by A575,A577,A609;
A611: ( rng v ) = ( rng v1 ) by A576,CLASSES1:75;
m in ( dom v ) by A575,A609,FINSEQ_1:def 3;
then ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) in ( rng v ) by A610,FUNCT_1:def 3;
then consider m1 being (Element of ( NAT )) such that A612: m1 in ( dom v1 ) and A613: ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) = ( v1 . m1 ) by A611,PARTFUN1:3;
( v1 . k ) in ( rng v1 ) by A583,FUNCT_1:def 3;
then consider k2 being (Element of ( NAT )) such that A614: k2 in ( dom v ) and A615: ( v1 . k ) = ( v . k2 ) by A611,PARTFUN1:3;
A616: k2 in ( Seg ( len D ) ) by A575,A614,FINSEQ_1:def 3;
then A617: k2 in ( dom D ) by FINSEQ_1:def 3;
k2 in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by A616,INTEGRA1:def 6;
then A618: k2 in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
( v1 . k ) = ( vol ( divset (D,k2) ) ) by A575,A614,A615;
then ( v1 . k ) = ( ( upper_volume (( chi (A,A) ),D) ) . k2 ) by A617,INTEGRA1:20;
then ( v1 . k ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by A618,FUNCT_1:def 3;
then A619: ( v1 . k ) >= ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by XXREAL_2:def 7;
m1 >= 1 by A612,FINSEQ_3:25;
then ( v1 . 1 ) <= ( min ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by A583,A604,A612,A613,INTEGRA2:2;
hence thesis by A604,A619,XXREAL_0:1;
end;
( H - h ) <= ( ( H - h ) + 1 ) by XREAL_1:29;
then A620: ( p * ( H - h ) ) <= ( p * ( ( H - h ) + 1 ) ) by XREAL_1:64;
set sD = ( lower_sum (f,D) );
set s = ( lower_integral f );
let m;
reconsider D1 = ( T . m ) as (Division of A);
A621: ( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) ) <= ( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) ) by XXREAL_0:17;
assume A622: n <= m;
then ( ( delta T ) . m ) < ( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) ) by A586;
then A623: ( delta D1 ) < ( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) ) by CKB4:def 1;
( ( delta T ) . m ) < ( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) ) by A586,A622;
then ( ( delta T ) . m ) < ( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) ) by A621,XXREAL_0:2;
then ( ( ( delta T ) . m ) * ( ( 2 * p ) * ( ( H - h ) + 1 ) ) ) < e by A584,A567,XREAL_1:79,XREAL_1:129;
then ( ( ( ( delta T ) . m ) * ( p * ( ( H - h ) + 1 ) ) ) * 2 ) < e;
then A624: ( ( p * ( ( H - h ) + 1 ) ) * ( ( delta T ) . m ) ) < ( e / 2 ) by XREAL_1:81;
( T . m ) in ( divs A ) by INTEGRA1:def 3;
then A625: ( T . m ) in ( dom ( lower_sum_set f ) ) by FUNCT_2:def 1;
( ( lower_sum (f,T) ) . m ) = ( lower_sum (f,( T . m )) ) by INTEGRA2:def 3;
then ( ( lower_sum (f,T) ) . m ) = ( ( lower_sum_set f ) . ( T . m ) ) by INTEGRA1:def 11;
then ( ( lower_sum (f,T) ) . m ) in ( rng ( lower_sum_set f ) ) by A625,FUNCT_1:def 3;
then ( upper_bound ( rng ( lower_sum_set f ) ) ) >= ( ( lower_sum (f,T) ) . m ) by A569,SEQ_4:def 1;
then ( lower_integral f ) >= ( ( lower_sum (f,T) ) . m ) by INTEGRA1:def 15;
then A626: ( ( lower_integral f ) - ( ( lower_sum (f,T) ) . m ) ) >= ( 0 ) by XREAL_1:48;
( 0 ) < ( ( delta T ) . m ) by A586,A622;
then A627: ( ( p * ( H - h ) ) * ( ( delta T ) . m ) ) <= ( ( p * ( ( H - h ) + 1 ) ) * ( ( delta T ) . m ) ) by A620,XREAL_1:64;
set sD1 = ( lower_sum (f,( T . m )) );
consider D2 being (Division of A) such that A628: D <= D2 and D1 <= D2 and A629: ( rng D2 ) = ( ( rng D1 ) \/ ( rng D ) ) and ( 0 ) <= ( ( lower_sum (f,D2) ) - ( lower_sum (f,D) ) ) and ( 0 ) <= ( ( lower_sum (f,D2) ) - ( lower_sum (f,D1) ) ) by A5;
set sD2 = ( lower_sum (f,D2) );
A630: ( ( sD - sD1 ) - ( sD2 - sD1 ) ) = ( sD - sD2 );
( min (( v1 . k ),( e / ( ( 2 * p ) * ( ( H - h ) + 1 ) ) )) ) <= ( v1 . k ) by XXREAL_0:17;
then ( delta D1 ) < ( v1 . k ) by A623,XXREAL_0:2;
then (ex D3 being (Division of A) st (((D <= D3 & D1 <= D3) & ( rng D3 ) = ( ( rng D1 ) \/ ( rng D ) )) & ( ( lower_sum (f,D3) ) - ( lower_sum (f,D1) ) ) <= ( ( ( len D ) * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) ))) by A10,A603;
then A631: ( ( lower_sum (f,D2) ) - ( lower_sum (f,D1) ) ) <= ( ( ( len D ) * ( ( upper_bound ( rng f ) ) - ( lower_bound ( rng f ) ) ) ) * ( delta D1 ) ) by A629,CKB10:1;
( ( lower_sum (f,D) ) - ( lower_sum (f,D2) ) ) <= ( 0 ) by A1,A628,INTEGRA1:46,XREAL_1:47;
then A632: ( sD - sD1 ) <= ( sD2 - sD1 ) by A630,XREAL_1:50;
( delta D1 ) = ( ( delta T ) . m ) by CKB4:def 1;
then ( ( lower_sum (f,D2) ) - ( lower_sum (f,( T . m )) ) ) <= ( ( p * ( ( H - h ) + 1 ) ) * ( ( delta T ) . m ) ) by A631,A627,XXREAL_0:2;
then ( sD - sD1 ) <= ( ( p * ( ( H - h ) + 1 ) ) * ( ( delta T ) . m ) ) by A632,XXREAL_0:2;
then ( sD - sD1 ) < ( e / 2 ) by A624,XXREAL_0:2;
then A633: ( ( sD - sD1 ) + ( e / 2 ) ) < ( ( e / 2 ) + ( e / 2 ) ) by XREAL_1:6;
( ( s - sD1 ) + sD1 ) < ( sD + ( e / 2 ) ) by A571,A587,XREAL_1:19;
then ( s - sD1 ) < ( ( sD + ( e / 2 ) ) - sD1 ) by XREAL_1:20;
then ( s - sD1 ) < e by A633,XXREAL_0:2;
then ( ( lower_integral f ) - ( ( lower_sum (f,T) ) . m ) ) < e by INTEGRA2:def 3;
then ( abs ( ( lower_integral f ) - ( ( lower_sum (f,T) ) . m ) ) ) < e by A626,ABSVALUE:def 1;
then ( abs ( - ( ( lower_integral f ) - ( ( lower_sum (f,T) ) . m ) ) ) ) < e by COMPLEX1:52;
hence thesis;
end;
hence thesis;
end;
hence ( lower_sum (f,T) ) is  convergent by SEQ_2:def 6;
hence thesis by A564,SEQ_2:def 7;
end;
