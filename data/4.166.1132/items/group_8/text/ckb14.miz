environ
vocabularies NUMBERS,STRUCT_0,GROUP_1,SUBSET_1,GROUP_2,FINSET_1,INT_2,CARD_1,GRAPH_1,RELAT_1,TARSKI,ALGSTR_0,ZFMISC_1,PBOOLE,REALSET1,NEWTON,INT_1,ARYTM_3,GROUP_4,ARYTM_1,NAT_1,FINSEQ_1,FUNCT_1,XXREAL_0,ORDINAL1,CQC_SIM1,XBOOLE_0,SETFAM_1,GROUP_8;
notations XBOOLE_0,CARD_1,TARSKI,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,RELAT_1,REALSET1,FUNCT_1,FUNCT_2,PBOOLE,INT_1,NAT_1,FINSET_1,GROUP_2,GROUP_4,GR_CY_1,FINSEQ_1,DOMAIN_1,STRUCT_0,ALGSTR_0,GROUP_1,INT_2;
definitions TARSKI,FUNCT_1,WELLORD2,REALSET1,STRUCT_0,ALGSTR_0;
theorems GROUP_2,GR_CY_1,GR_CY_2,NAT_1,TARSKI,XBOOLE_0,GROUP_1,CARD_1,GROUP_6,ALTCAT_1,FUNCT_2,GROUP_4,INT_2,XCMPLX_1,INT_1,FINSEQ_1,FUNCT_1,NEWTON,ORDINAL1,NAT_D,STRUCT_0,XXREAL_0,RELAT_1,PARTFUN1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13;
schemes SUBSET_1,NAT_1,FINSEQ_1,FUNCT_2;
registrations XBOOLE_0,SUBSET_1,RELSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,FINSEQ_1,STRUCT_0,GROUP_1,GROUP_2,GR_CY_1,ORDINAL1,FINSET_1;
constructors WELLORD2,BINOP_1,XXREAL_0,REAL_1,NAT_D,BINOP_2,REALSET2,GROUP_4,GR_CY_1,RELSET_1;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve G for  strict Group;
reserve a for (Element of G);
reserve b for (Element of G);
reserve H for  strict (Subgroup of G);
theorem
(for G holds ((ex a st a <> ( 1_ G )) implies ((for H holds (H = G or H = ( (1). G ))) iff ((G is  cyclic & G is  finite) & (ex p being (Element of ( NAT )) st (( card G ) = p & p is  prime))))))
proof
let G;
assume that
A1: (ex a st a <> ( 1_ G ));
thus ((for H holds (H = G or H = ( (1). G ))) implies ((G is  cyclic & G is  finite) & (ex p being (Element of ( NAT )) st (( card G ) = p & p is  prime))))
proof
assume A2: (for H holds (H = G or H = ( (1). G )));
consider b such that A3: b <> ( 1_ G ) by A1;
A4: ( gr { b } ) = G by A2,A3,CKB7:1;
A5: (not b is  being_of_order_0)
proof
assume A6: b is  being_of_order_0;
then A7: ( b |^ 2 ) <> ( 1_ G ) by GROUP_1:def 10;
(not b in ( gr { ( b |^ 2 ) } ))
proof
assume b in ( gr { ( b |^ 2 ) } );
then consider j1 being Integer such that A8: b = ( ( b |^ 2 ) |^ j1 ) by GR_CY_1:5;
b = ( b |^ ( 2 * j1 ) ) by A8,GROUP_1:35;
then ( ( b " ) * ( b |^ ( 2 * j1 ) ) ) = ( 1_ G ) by GROUP_1:def 5;
then ( ( b |^ ( - 1 ) ) * ( b |^ ( 2 * j1 ) ) ) = ( 1_ G ) by GROUP_1:32;
then ( b |^ ( ( - 1 ) + ( 2 * j1 ) ) ) = ( 1_ G ) by GROUP_1:33;
then ( ( - 1 ) + ( 2 * j1 ) ) = ( 0 ) by A6,CKB13:1;
hence thesis by INT_1:9;
end;
then ( gr { ( b |^ 2 ) } ) <> G by A4,GR_CY_2:2;
hence contradiction by A2,A7,CKB7:1;
end;
then consider n being (Element of ( NAT )) such that A9: n = ( ord b ) and (not b is  being_of_order_0);
A10: G is  finite by A4,A5,CKB11:1;
then A11: ( card G ) = n by A4,A9,GR_CY_1:7;
n is  prime
proof
assume A12: (not n is  prime);
(ex u,v being (Element of ( NAT )) st ((u > 1 & v > 1) & n = ( u * v )))
proof
A13: (not (n > 1 & (for m being  natural number holds (m divides n implies (m = 1 or m = n))))) by A12,INT_2:def 4;
n >= 1 by A10,A11,GROUP_1:45;
then n > 1 by A3,A9,GROUP_1:43,XXREAL_0:1;
then consider m being  natural number such that A14: m <> 1 and A15: m <> n and A16: m divides n by A13;
reconsider m as (Element of ( NAT )) by ORDINAL1:def 12;
consider o being Nat such that A17: n = ( m * o ) by A16,NAT_D:def 3;
reconsider o as (Element of ( NAT )) by ORDINAL1:def 12;
take u = m;
take v = o;
u <> ( 0 )
proof
assume u = ( 0 );
then n = ( ( 0 ) * ( n div ( 0 ) ) ) by A16,NAT_D:3;
hence contradiction by A10,A11;
end;
then A18: ( ( 0 ) + 1 ) <= u by INT_1:7;
( 0 ) < v by A10,A11,A17;
then A19: ( ( 0 ) + 1 ) <= v by INT_1:7;
v <> 1 by A15,A17;
hence thesis by A14,A17,A18,A19,XXREAL_0:1;
end;
then consider u being (Element of ( NAT )),v being (Element of ( NAT )) such that A20: u > 1 and A21: v > 1 and A22: n = ( u * v );
( ord ( b |^ v ) ) = u by A4,A10,A11,A22,GR_CY_2:8;
then A23: ( card ( gr { ( b |^ v ) } ) ) = u by A10,GR_CY_1:7;
A24: u <> n by A20,A21,A22,XCMPLX_1:7;
( gr { ( b |^ v ) } ) <> ( (1). G ) by A20,A23,GROUP_2:69;
hence thesis by A2,A11,A23,A24;
end;
hence thesis by A4,A5,A11,CKB11:1,GR_CY_2:4;
end;

assume that
G is  cyclic
and
A25: G is  finite
and
A26: (ex p being (Element of ( NAT )) st (( card G ) = p & p is  prime));
let H;
reconsider G as  finite Group by A25;
reconsider H as (Subgroup of G);
( card G ) = ( ( card H ) * ( index H ) ) by GROUP_2:147;
then A27: ( card H ) divides ( card G ) by NAT_D:def 3;
per cases  by A26,A27,INT_2:def 4;
suppose ( card H ) = ( card G );

hence thesis by GROUP_2:73;
end;
suppose ( card H ) = 1;

hence thesis by GROUP_2:70;
end;
end;
