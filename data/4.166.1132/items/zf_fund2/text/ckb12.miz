environ
vocabularies NUMBERS,ZF_LANG,XBOOLE_0,SUBSET_1,FUNCT_1,ARYTM_3,CARD_1,ZF_MODEL,TARSKI,ORDINAL1,BVFUNC_2,XBOOLEAN,ZFMISC_1,CLASSES2,ZF_REFLE,CARD_3,RELAT_1,ORDINAL2,ZF_LANG1,ZFMODEL1,XXREAL_0,REALSET1,ZF_FUND1,FUNCT_2,ORDINAL4,NAT_1,ZF_FUND2;
notations TARSKI,XBOOLE_0,ENUMSET1,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,NAT_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,ORDINAL1,ZF_LANG,ZF_MODEL,ZFMODEL1,ORDINAL2,CARD_3,ZF_LANG1,CLASSES2,ORDINAL4,ZF_REFLE,ZF_FUND1,XXREAL_0,CKB1,CKB2;
definitions TARSKI,ORDINAL1,XBOOLE_0,CKB1,CKB2;
theorems TARSKI,NAT_1,ENUMSET1,FUNCT_1,FUNCT_2,ORDINAL1,ORDINAL2,CARD_1,CARD_2,ZF_MODEL,ZFMODEL1,ZFMODEL2,ZF_LANG1,CARD_3,ZF_REFLE,ZFREFLE1,CLASSES2,ZFMISC_1,ZF_FUND1,GRFUNC_1,RELAT_1,CLASSES1,RELSET_1,XBOOLE_0,XBOOLE_1,XREAL_1,FUNCT_7,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11;
schemes ZF_REFLE,NAT_1;
registrations ORDINAL1,RELSET_1,FINSET_1,XREAL_0,CARD_1,CLASSES2,ZF_LANG,ORDINAL4,FUNCT_1,ZF_FUND1,ZF_LANG1;
constructors PARTFUN1,WELLORD2,DOMAIN_1,XXREAL_0,XREAL_0,NAT_1,CLASSES1,ZFMODEL1,ZF_LANG1,ZF_REFLE,ZF_FUND1,ORDINAL4,RELSET_1,ZF_MODEL,CKB1,CKB2;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
reserve H for ZF-formula;
reserve E for non  empty set;
reserve e for (Element of E);
reserve f for (Function of ( VAR ),E);
reserve f1 for (Function of ( VAR ),E);
reserve u for set;
reserve W for Universe;
reserve w for (Element of W);
reserve Y for (Subclass of W);
theorem
Th5: ((Y is  closed_wrt_A1-A7 & Y is  epsilon-transitive) implies Y is  predicatively_closed)
proof
assume that
A1: Y is  closed_wrt_A1-A7
and
A2: Y is  epsilon-transitive;
let H;
let E;
let f;
assume that
A3: E in Y;
now
per cases ;
suppose (not ( x. ( 0 ) ) in ( Free H ));

then ( Section (H,f) ) = ( {} ) by CKB1:def 1;
hence thesis by A1,ZF_FUND1:3;
end;
suppose A4: ( x. ( 0 ) ) in ( Free H );

reconsider a = E as (Element of W) by A3;
reconsider n = ( {} ) as (Element of ( omega )) by ORDINAL1:def 11;
set fs = ( ( code ( Free H ) ) \ { n } );
A5: ( Diagram (H,E) ) in Y by A1,A3,ZF_FUND1:22;
then reconsider b = ( Diagram (H,E) ) as (Element of W);
A6: b c= ( Funcs (( fs \/ { n } ),a) )
proof
let u;
assume u in b;
then (ex f1 st (u = ( ( f1 * ( decode ) ) | ( code ( Free H ) ) ) & f1 in ( St (H,E) ))) by ZF_FUND1:def 5;
then A7: u in ( Funcs (( code ( Free H ) ),a) ) by ZF_FUND1:31;
( x". ( x. ( 0 ) ) ) in ( code ( Free H ) ) by A4,ZF_FUND1:33;
then n in ( code ( Free H ) ) by ZF_FUND1:def 3;
then { n } c= ( code ( Free H ) ) by ZFMISC_1:31;
hence thesis by A7,XBOOLE_1:45;
end;
n in { n } by TARSKI:def 1;
then A8: (not n in fs) by XBOOLE_0:def 5;
A9: ( ( f * ( decode ) ) | fs ) in ( Funcs (fs,a) ) by ZF_FUND1:31;
( Funcs (fs,a) ) in Y by A1,A3,ZF_FUND1:9;
then reconsider y = ( ( f * ( decode ) ) | fs ) as (Element of W) by A9,ZF_FUND1:1;
set B = { e: ( { [ n,e ] } \/ y ) in b };
set A = { w: (w in a & ( { [ n,w ] } \/ y ) in b) };
A10: A = B
proof
thus A c= B
proof
let u;
assume u in A;
then (ex w st ((u = w & w in a) & ( { [ n,w ] } \/ y ) in b));
hence thesis;
end;

let u;
assume u in B;
then consider e such that A11: u = e and A12: ( { [ n,e ] } \/ y ) in b;
reconsider e as (Element of W) by A3,ZF_FUND1:1;
e in A by A12;
hence thesis by A11;
end;
a c= Y by A2,A3,ORDINAL1:def 2;
then A in Y by A1,A3,A5,A9,A8,A6,ZF_FUND1:16;
hence thesis by A10,CKB11:1;
end;
end;
hence thesis;
end;
