environ
vocabularies MYCIELSK,FINSET_1,DILWORTH,CARD_1,ARYTM_3,ARYTM_1,FUNCT_1,RELAT_1,RELAT_2,YELLOW_0,TARSKI,EQREL_1,CIRCUIT2,SUBSET_1,COMBGRAS,NECKLACE,NEWTON,XREAL_0,XXREAL_0,ORDINAL1,NAT_1,XBOOLE_0,ORDERS_2,STRUCT_0,ZFMISC_1,FUNCT_2,NUMBERS;
notations TARSKI,XBOOLE_0,ZFMISC_1,FINSET_1,CARD_1,SUBSET_1,STRUCT_0,ORDINAL1,ORDERS_2,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,NAT_D,RELAT_1,RELSET_1,RELAT_2,PARTFUN1,EQREL_1,FUNCT_1,FUNCT_2,NEWTON,YELLOW_0,NECKLACE,DILWORTH,NUMBERS,CKB8;
definitions STRUCT_0,XREAL_0,TARSKI,XBOOLE_0,RELAT_2,FUNCT_1,DILWORTH,NECKLACE,SUBSET_1,EQREL_1,ORDERS_2,CKB8;
theorems NEWTON,NAT_1,NAT_D,XREAL_0,XREAL_1,XXREAL_0,ORDINAL1,FUNCT_1,DILWORTH,XBOOLE_0,XBOOLE_1,TARSKI,NECKLACE,PENCIL_1,ZFMISC_1,ORDERS_2,EULER_1,CARD_2,CARD_1,YELLOW_0,RELSET_1,EQREL_1,FUNCT_2,RELAT_1,FINSET_1,FINSEQ_4,RELAT_2,SUBSET_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB11;
schemes RECDEF_1,NAT_1,CLASSES1,PRE_CIRC,FUNCT_1,FUNCT_2,DILWORTH;
registrations SUBSET_1,XBOOLE_0,STRUCT_0,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,CARD_1,RELSET_1,PARTFUN1,ZFMISC_1,ORDINAL1,EQREL_1,NECKLA_3,RELAT_1,FUNCT_1,FUNCT_2,FINSET_1,DILWORTH,NUMBERS,NEWTON,NECKLACE,YELLOW_0,YELLOW14,ORDERS_2,CKB9,CKB10;
constructors STRUCT_0,NECKLACE,NECKLA_3,RELSET_1,SETFAM_1,XXREAL_0,NAT_1,NAT_D,FUNCT_2,NEWTON,YELLOW_0,DILWORTH,DOMAIN_1,CKB8;
requirements SUBSET,BOOLE,NUMERALS,ARITHM,REAL;
begin
theorem
Th9: (for X being set holds (for P being  finite (a_partition of X) holds (for S being (Subset of X) holds ((for p being set holds (p in P implies p meets S)) iff ( card ( P | S ) ) = ( card P )))))
proof
let X being set;
let P being  finite (a_partition of X);
let S being (Subset of X);
per cases ;
suppose A1: X = ( {} );

hereby
assume (for p being set holds (p in P implies p meets S));
S = ( {} ) by A1;
hence ( card ( P | S ) ) = ( {} ) by CARD_1:27,EQREL_1:32
.= ( card P ) by A1,CARD_1:27,EQREL_1:32;
end;
thus thesis by A1,EQREL_1:32;
end;
suppose A2: X <> ( {} );

set PS = ( P | S );
reconsider Pp1 = P as  finite non  empty set by A2;
hereby
assume A3: (for p being set holds (p in P implies p meets S));
set p = the (Element of P);
p in Pp1;
then p meets S by A3;
then ( p /\ S ) in PS;
then reconsider PSp1 = PS as non  empty  finite set;
defpred P[ set,set ]
 means
($1 in P & $2 = ( $1 /\ S ));
A4: (for x being set holds (x in P implies (ex y being set st (y in PSp1 & P[ x,y ]))))
proof
let x being set;
assume A5: x in P;
take ( x /\ S );
x meets S by A5,A3;
hence thesis by A5;
end;
consider f being (Function of P,PSp1) such that A6: (for x being set holds (x in P implies P[ x,( f . x ) ])) from FUNCT_2:sch 1(A4);
now
let x1 being set;
let x2 being set;
assume that
A7: x1 in P
and
A8: x2 in P
and
A9: ( f . x1 ) = ( f . x2 );
A10: ( f . x1 ) = ( x1 /\ S ) by A7,A6;
A11: ( f . x2 ) = ( x2 /\ S ) by A8,A6;
x1 meets S by A7,A3;
then ( f . x1 ) in PS by A10,A7;
then ( f . x1 ) <> ( {} ) by EQREL_1:def 4;
then consider x being set such that A12: x in ( f . x1 ) by XBOOLE_0:def 1;
(x in x1 & x in x2) by A12,A9,A10,A11,XBOOLE_0:def 4;
then x1 meets x2 by XBOOLE_0:3;
hence x1 = x2 by A7,A8,EQREL_1:def 4;
end;
then A13: f is  one-to-one by FUNCT_2:19;
( rng f ) = PSp1
proof
thus ( rng f ) c= PSp1
proof
let y being set;
assume y in ( rng f );
then consider x being set such that A14: x in P and A15: ( f . x ) = y by FUNCT_2:11;
x meets S by A3,A14;
then ( x /\ S ) in PS by A14;
hence y in PSp1 by A15,A14,A6;
end;

thus PSp1 c= ( rng f )
proof
let y being set;
assume y in PSp1;
then consider p being (Element of P) such that A16: y = ( p /\ S ) and p meets S;
A17: p in Pp1;
then ( f . p ) = ( p /\ S ) by A6;
hence y in ( rng f ) by A16,A17,FUNCT_2:4;
end;

end;
then f is  onto by FUNCT_2:def 3;
hence ( card ( P | S ) ) = ( card P ) by A13,EULER_1:11;
end;
assume A18: ( card ( P | S ) ) = ( card P );
defpred P[ set,set ]
 means
(($1 in PS & $2 in Pp1) & $1 = ( $2 /\ S ));
A19: (for x being set holds (x in PS implies (ex y being set st (y in Pp1 & P[ x,y ]))))
proof
let x being set;
assume A20: x in PS;
then consider p being (Element of P) such that A21: x = ( p /\ S ) and p meets S;
take p;
thus thesis by A20,A21;
end;
consider f being (Function of PS,Pp1) such that A22: (for x being set holds (x in PS implies P[ x,( f . x ) ])) from FUNCT_2:sch 1(A19);
A23: f is  one-to-one
proof
let x1 being set;
let x2 being set;
assume that
A24: x1 in ( dom f )
and
A25: x2 in ( dom f )
and
A26: ( f . x1 ) = ( f . x2 );
x1 = ( ( f . x1 ) /\ S ) by A24,A22;
hence x1 = x2 by A26,A25,A22;
end;
A27: ( rng f ) = P by A18,A23,FINSEQ_4:63;
let p being set;
assume p in P;
then consider ps being set such that A28: ps in ( dom f ) and A29: p = ( f . ps ) by A27,FUNCT_1:def 3;
A30: ( dom f ) = PS by FUNCT_2:def 1;
A31: ps = ( p /\ S ) by A29,A28,A22;
ps is non  empty by A28,A30,EQREL_1:def 4;
then (ex x being set st x in ps) by XBOOLE_0:def 1;
hence p meets S by A31,XBOOLE_0:4;
end;
end;
