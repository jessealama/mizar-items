environ
vocabularies MYCIELSK,FINSET_1,DILWORTH,CARD_1,ARYTM_3,ARYTM_1,FUNCT_1,RELAT_1,RELAT_2,YELLOW_0,TARSKI,EQREL_1,CIRCUIT2,SUBSET_1,COMBGRAS,NECKLACE,NEWTON,XREAL_0,XXREAL_0,ORDINAL1,NAT_1,XBOOLE_0,ORDERS_2,STRUCT_0,ZFMISC_1,FUNCT_2,NUMBERS;
notations TARSKI,XBOOLE_0,ZFMISC_1,FINSET_1,CARD_1,SUBSET_1,STRUCT_0,ORDINAL1,ORDERS_2,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,NAT_D,RELAT_1,RELSET_1,RELAT_2,PARTFUN1,EQREL_1,FUNCT_1,FUNCT_2,NEWTON,YELLOW_0,NECKLACE,DILWORTH,NUMBERS,CKB8,CKB14,CKB19,CKB22,CKB27,CKB55,CKB57,CKB62,CKB70;
definitions STRUCT_0,XREAL_0,TARSKI,XBOOLE_0,RELAT_2,FUNCT_1,DILWORTH,NECKLACE,SUBSET_1,EQREL_1,ORDERS_2,CKB8,CKB14,CKB19,CKB22,CKB27,CKB55,CKB57,CKB62,CKB70;
theorems NEWTON,NAT_1,NAT_D,XREAL_0,XREAL_1,XXREAL_0,ORDINAL1,FUNCT_1,DILWORTH,XBOOLE_0,XBOOLE_1,TARSKI,NECKLACE,PENCIL_1,ZFMISC_1,ORDERS_2,EULER_1,CARD_2,CARD_1,YELLOW_0,RELSET_1,EQREL_1,FUNCT_2,RELAT_1,FINSET_1,FINSEQ_4,RELAT_2,SUBSET_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB11,CKB12,CKB13,CKB14,CKB19,CKB22,CKB27,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB39,CKB40,CKB41,CKB42,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB53,CKB54,CKB55,CKB56,CKB57,CKB62,CKB63,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB76,CKB77,CKB78,CKB79,CKB80,CKB81;
schemes RECDEF_1,NAT_1,CLASSES1,PRE_CIRC,FUNCT_1,FUNCT_2,DILWORTH;
registrations SUBSET_1,XBOOLE_0,STRUCT_0,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,CARD_1,RELSET_1,PARTFUN1,ZFMISC_1,ORDINAL1,EQREL_1,NECKLA_3,RELAT_1,FUNCT_1,FUNCT_2,FINSET_1,DILWORTH,NUMBERS,NEWTON,NECKLACE,YELLOW_0,YELLOW14,ORDERS_2,CKB9,CKB10,CKB15,CKB16,CKB17,CKB18,CKB20,CKB21,CKB23,CKB24,CKB25,CKB26,CKB28,CKB29,CKB38,CKB43,CKB44,CKB51,CKB52,CKB58,CKB59,CKB60,CKB61,CKB64,CKB65;
constructors STRUCT_0,NECKLACE,NECKLA_3,RELSET_1,SETFAM_1,XXREAL_0,NAT_1,NAT_D,FUNCT_2,NEWTON,YELLOW_0,DILWORTH,DOMAIN_1,CKB8,CKB14,CKB19,CKB22,CKB27,CKB55,CKB57,CKB62,CKB70;
requirements SUBSET,BOOLE,NUMERALS,ARITHM,REAL;
begin
theorem
Th48: (for n being Nat holds (for R being  irreflexive (NatRelStr of n) holds ( chromatic# ( Mycielskian R ) ) = ( 1 + ( chromatic# R ) )))
proof
let n being Nat;
let R being  irreflexive (NatRelStr of n);
set cR = (the carrier of R);
set iR = (the InternalRel of R);
set cnR = ( chromatic# R );
set MR = ( Mycielskian R );
set cnMR = ( chromatic# MR );
set cMR = (the carrier of MR);
set iMR = (the InternalRel of MR);
A1: cR = n by CKB57:def 1;
A2: (ex C being  finite (Coloring of MR) st ( card C ) = ( 1 + cnR ))
proof
consider C being  finite (Coloring of R) such that A3: ( card C ) = cnR by CKB19:def 1;
defpred P[ set,set ]
 means
$2 = { ( m + n ) where m is (Element of ( NAT )): m in $1 };
A4: (for e being set holds (e in C implies (ex u being set st P[ e,u ])));
consider r being Function such that ( dom r ) = C and A5: (for e being set holds (e in C implies P[ e,( r . e ) ])) from CLASSES1:sch 1(A4);
set D = { ( d \/ ( r . d ) ) where d is (Element of C): d in C };
A6: ( card D ) = ( card C )
proof
per cases ;
suppose A7: D is  empty;

now
assume C is non  empty;
then consider c being set such that A8: c in C by XBOOLE_0:def 1;
( c \/ ( r . c ) ) in D by A8;
hence contradiction by A7;
end;
hence thesis by A7;
end;
suppose A9: D is non  empty;

defpred R[ set,set ]
 means
$2 = ( $1 \/ ( r . $1 ) );
A10: (for e being set holds (e in C implies (ex u being set st R[ e,u ])));
consider s being Function such that A11: ( dom s ) = C and A12: (for e being set holds (e in C implies R[ e,( s . e ) ])) from CLASSES1:sch 1(A10);
A13: ( rng s ) c= D
proof
let y being set;
assume y in ( rng s );
then consider x being set such that A14: x in ( dom s ) and A15: y = ( s . x ) by FUNCT_1:def 3;
y = ( x \/ ( r . x ) ) by A14,A15,A11,A12;
hence y in D by A14,A11;
end;
then reconsider s as (Function of C,D) by A11,FUNCT_2:2;
D c= ( rng s )
proof
let x being set;
assume x in D;
then consider c being (Element of C) such that A16: x = ( c \/ ( r . c ) ) and A17: c in C;
x = ( s . c ) by A16,A17,A12;
hence x in ( rng s ) by A17,A11,FUNCT_1:def 3;
end;
then ( rng s ) = D by A13,XBOOLE_0:def 10;
then A18: s is  onto by FUNCT_2:def 3;
s is  one-to-one
proof
let x1 being set;
let x2 being set;
assume that
A19: x1 in ( dom s )
and
A20: x2 in ( dom s )
and
A21: ( s . x1 ) = ( s . x2 );
A22: ( s . x1 ) = ( x1 \/ ( r . x1 ) ) by A19,A12;
A23: ( s . x2 ) = ( x2 \/ ( r . x2 ) ) by A20,A12;
thus x1 c= x2
proof
let x being set;
assume A24: x in x1;
A25: x in ( s . x1 ) by A22,A24,XBOOLE_0:def 3;
per cases  by A25,A21,A23,XBOOLE_0:def 3;
suppose x in x2;

hence thesis;
end;
suppose x in ( r . x2 );

then x in { ( m + n ) where m is (Element of ( NAT )): m in x2 } by A5,A20;
then consider m being (Element of ( NAT )) such that A26: x = ( m + n ) and m in x2;
( m + n ) < ( ( 0 ) + n ) by A24,A26,A19,A11,A1,NAT_1:44;
hence thesis by XREAL_1:6;
end;
end;

thus x2 c= x1
proof
let x being set;
assume A27: x in x2;
A28: x in ( s . x2 ) by A23,A27,XBOOLE_0:def 3;
per cases  by A28,A21,A22,XBOOLE_0:def 3;
suppose x in x1;

hence thesis;
end;
suppose x in ( r . x1 );

then x in { ( m + n ) where m is (Element of ( NAT )): m in x1 } by A5,A19;
then consider m being (Element of ( NAT )) such that A29: x = ( m + n ) and m in x1;
( m + n ) < ( ( 0 ) + n ) by A27,A29,A20,A11,A1,NAT_1:44;
hence thesis by XREAL_1:6;
end;
end;

end;
hence thesis by A18,A9,EULER_1:11;
end;
end;
then A30: D is  finite;
set E = ( D \/ { { ( 2 * n ) } } );
A31: ( union E ) c= cMR
proof
let x being set;
assume x in ( union E );
then consider Y being set such that A32: x in Y and A33: Y in E by TARSKI:def 4;
per cases  by A33,XBOOLE_0:def 3;
suppose Y in D;

then consider d being (Element of C) such that A34: Y = ( d \/ ( r . d ) ) and A35: d in C;
A36: ( r . d ) = { ( m + n ) where m is (Element of ( NAT )): m in d } by A35,A5;
per cases  by A32,A34,XBOOLE_0:def 3;
suppose A37: x in d;

reconsider a = x as Nat by A37,A35,A1,NECKLACE:3;
a < n by A37,A35,A1,NAT_1:44;
then ( a + ( 0 ) ) < ( n + n ) by XREAL_1:8;
then a < ( ( 2 * n ) + 1 ) by NAT_1:13;
then a in ( ( 2 * n ) + 1 ) by NAT_1:44;
hence x in cMR by CKB57:def 1;
end;
suppose x in ( r . d );

then consider m being (Element of ( NAT )) such that A38: x = ( m + n ) and A39: m in d by A36;
m < n by A39,A35,A1,NAT_1:44;
then ( m + n ) < ( n + n ) by XREAL_1:6;
then ( m + n ) < ( ( 2 * n ) + 1 ) by NAT_1:13;
then x in ( ( 2 * n ) + 1 ) by A38,NAT_1:44;
hence x in cMR by CKB57:def 1;
end;
end;
suppose Y in { { ( 2 * n ) } };

then Y = { ( 2 * n ) } by TARSKI:def 1;
then A40: x = ( 2 * n ) by A32,TARSKI:def 1;
( 2 * n ) < ( ( 2 * n ) + 1 ) by NAT_1:13;
then ( 2 * n ) in ( ( 2 * n ) + 1 ) by NAT_1:44;
hence x in cMR by A40,CKB57:def 1;
end;
end;
A41: E c= ( bool cMR )
proof
let X being set;
assume A42: X in E;
X c= cMR
proof
let x being set;
assume x in X;
then x in ( union E ) by A42,TARSKI:def 4;
hence x in cMR by A31;
end;
hence X in ( bool cMR );
end;
A43: ( union E ) = cMR
proof
thus ( union E ) c= cMR by A31;
thus cMR c= ( union E )
proof
let x being set;
assume x in cMR;
then A44: x in ( ( 2 * n ) + 1 ) by CKB57:def 1;
then reconsider a = x as Nat by NECKLACE:3;
a < ( ( 2 * n ) + 1 ) by A44,NAT_1:44;
then A45: a <= ( 2 * n ) by NAT_1:13;
per cases ;
suppose a < n;

then a in n by NAT_1:44;
then a in ( union C ) by A1,EQREL_1:def 4;
then consider c being set such that A46: a in c and A47: c in C by TARSKI:def 4;
A48: x in ( c \/ ( r . c ) ) by A46,XBOOLE_0:def 3;
( c \/ ( r . c ) ) in D by A47;
then ( c \/ ( r . c ) ) in E by XBOOLE_0:def 3;
hence x in ( union E ) by A48,TARSKI:def 4;
end;
suppose A49: a >= n;

per cases  by A45,XXREAL_0:1;
suppose A50: a < ( n + n );

consider b being Nat such that A51: a = ( n + b ) by A49,NAT_1:10;
reconsider b as (Element of ( NAT )) by ORDINAL1:def 12;
b < n by A51,A50,XREAL_1:6;
then b in cR by A1,NAT_1:44;
then b in ( union C ) by EQREL_1:def 4;
then consider c being set such that A52: b in c and A53: c in C by TARSKI:def 4;
( r . c ) = { ( m + n ) where m is (Element of ( NAT )): m in c } by A53,A5;
then a in ( r . c ) by A52,A51;
then A54: x in ( c \/ ( r . c ) ) by XBOOLE_0:def 3;
( c \/ ( r . c ) ) in D by A53;
then ( c \/ ( r . c ) ) in E by XBOOLE_0:def 3;
hence x in ( union E ) by A54,TARSKI:def 4;
end;
suppose a = ( 2 * n );

then A55: a in { ( 2 * n ) } by TARSKI:def 1;
{ ( 2 * n ) } in { { ( 2 * n ) } } by TARSKI:def 1;
then { ( 2 * n ) } in E by XBOOLE_0:def 3;
hence x in ( union E ) by A55,TARSKI:def 4;
end;
end;
end;

end;
now
let A being (Subset of cMR);
assume that
A56: A in E;
thus A <> ( {} )
proof
per cases  by A56,XBOOLE_0:def 3;
suppose A in D;

then consider d being (Element of C) such that A57: A = ( d \/ ( r . d ) ) and A58: d in C;
d <> ( {} ) by A58,EQREL_1:def 4;
hence thesis by A57;
end;
suppose A in { { ( 2 * n ) } };

hence thesis by TARSKI:def 1;
end;
end;

let B being (Subset of cMR);
assume that
A59: B in E;
assume A60: A <> B;
assume A meets B;
then consider x being set such that A61: x in A and A62: x in B by XBOOLE_0:3;
per cases  by A56,A59,XBOOLE_0:def 3;
suppose that A63: A in D
and
A64: B in D;
consider d being (Element of C) such that A65: A = ( d \/ ( r . d ) ) and A66: d in C by A63;
consider e being (Element of C) such that A67: B = ( e \/ ( r . e ) ) and A68: e in C by A64;
per cases  by A65,A67,A61,A62,XBOOLE_0:def 3;
suppose (x in d & x in e);

then d meets e by XBOOLE_0:3;
then d = e by A66,A68,EQREL_1:def 4;
hence contradiction by A65,A67,A60;
end;
suppose that A69: x in d
and
A70: x in ( r . e );
x in { ( m + n ) where m is (Element of ( NAT )): m in e } by A70,A68,A5;
then consider mb being (Element of ( NAT )) such that A71: x = ( mb + n ) and mb in e;
( mb + n ) < ( n + ( 0 ) ) by A71,A69,A66,A1,NAT_1:44;
hence contradiction by XREAL_1:6;
end;
suppose that A72: x in ( r . d )
and
A73: x in e;
x in { ( m + n ) where m is (Element of ( NAT )): m in d } by A72,A66,A5;
then consider ma being (Element of ( NAT )) such that A74: x = ( ma + n ) and ma in d;
( ma + n ) < ( n + ( 0 ) ) by A74,A73,A68,A1,NAT_1:44;
hence contradiction by XREAL_1:6;
end;
suppose that A75: x in ( r . d )
and
A76: x in ( r . e );
x in { ( m + n ) where m is (Element of ( NAT )): m in d } by A75,A66,A5;
then consider ma being (Element of ( NAT )) such that A77: x = ( ma + n ) and A78: ma in d;
x in { ( m + n ) where m is (Element of ( NAT )): m in e } by A76,A68,A5;
then consider mb being (Element of ( NAT )) such that A79: x = ( mb + n ) and A80: mb in e;
d meets e by A77,A79,A78,A80,XBOOLE_0:3;
then d = e by A66,A68,EQREL_1:def 4;
hence contradiction by A65,A67,A60;
end;
end;
suppose that A81: A in D
and
A82: B in { { ( 2 * n ) } };
B = { ( 2 * n ) } by A82,TARSKI:def 1;
then A83: x = ( 2 * n ) by A62,TARSKI:def 1;
consider d being (Element of C) such that A84: A = ( d \/ ( r . d ) ) and A85: d in C by A81;
per cases  by A84,A61,XBOOLE_0:def 3;
suppose x in d;

then ( n + n ) < n by A85,A1,A83,NAT_1:44;
hence contradiction by NAT_1:11;
end;
suppose x in ( r . d );

then x in { ( m + n ) where m is (Element of ( NAT )): m in d } by A85,A5;
then consider m being (Element of ( NAT )) such that A86: x = ( m + n ) and A87: m in d;
m in n by A87,A85,A1;
hence contradiction by A86,A83;
end;
end;
suppose that A88: A in { { ( 2 * n ) } }
and
A89: B in D;
A = { ( 2 * n ) } by A88,TARSKI:def 1;
then A90: x = ( 2 * n ) by A61,TARSKI:def 1;
consider d being (Element of C) such that A91: B = ( d \/ ( r . d ) ) and A92: d in C by A89;
per cases  by A91,A62,XBOOLE_0:def 3;
suppose x in d;

then ( n + n ) < n by A92,A1,A90,NAT_1:44;
hence contradiction by NAT_1:11;
end;
suppose x in ( r . d );

then x in { ( m + n ) where m is (Element of ( NAT )): m in d } by A92,A5;
then consider m being (Element of ( NAT )) such that A93: x = ( m + n ) and A94: m in d;
m in n by A94,A92,A1;
hence contradiction by A93,A90;
end;
end;
suppose (A in { { ( 2 * n ) } } & B in { { ( 2 * n ) } });

then (A = { ( 2 * n ) } & B = { ( 2 * n ) }) by TARSKI:def 1;
hence contradiction by A60;
end;
end;
then reconsider E as (a_partition of cMR) by A41,A43,EQREL_1:def 4;
now
let x being set;
assume A95: x in E;
per cases  by A95,XBOOLE_0:def 3;
suppose x in D;

then consider d being (Element of C) such that A96: x = ( d \/ ( r . d ) ) and A97: d in C;
reconsider d as (Subset of R) by A97;
A98: ( r . d ) = { ( m + n ) where m is (Element of ( NAT )): m in d } by A97,A5;
A99: x c= cMR
proof
let a being set;
assume A100: a in x;
per cases  by A96,A100,XBOOLE_0:def 3;
suppose A101: a in d;

then reconsider ap1 = a as Nat by A1,NECKLACE:3;
A102: ap1 < n by A101,A1,NAT_1:44;
n <= ( n + n ) by NAT_1:12;
then ap1 < ( n + n ) by A102,XXREAL_0:2;
then ap1 < ( ( 2 * n ) + 1 ) by NAT_1:13;
then a in ( ( 2 * n ) + 1 ) by NAT_1:44;
hence a in cMR by CKB57:def 1;
end;
suppose a in ( r . d );

then consider am being (Element of ( NAT )) such that A103: a = ( am + n ) and A104: am in d by A98;
am < n by A104,A1,NAT_1:44;
then ( am + n ) < ( n + n ) by XREAL_1:6;
then ( am + n ) < ( ( 2 * n ) + 1 ) by NAT_1:13;
then a in ( ( 2 * n ) + 1 ) by A103,NAT_1:44;
hence a in cMR by CKB57:def 1;
end;
end;
A105:now
let x being Nat;
assume x in ( r . d );
then consider m being (Element of ( NAT )) such that A106: x = ( m + n ) and A107: m in d by A98;
thus n <= x by A106,NAT_1:11;
m < n by A107,A1,NAT_1:44;
then ( m + n ) < ( n + n ) by XREAL_1:6;
hence x < ( 2 * n ) by A106;
end;
A108: d is  stable by A97,DILWORTH:def 12;
now
let a being (Element of MR);
let b being (Element of MR);
assume that
A109: a in x
and
A110: b in x
and
A111: a <> b
and
A112: (a <= b or b <= a);
A113: ([ a,b ] in iMR or [ b,a ] in iMR) by A112,ORDERS_2:def 5;
per cases  by A109,A110,A96,XBOOLE_0:def 3;
suppose A114: (a in d & b in d);

then A115: ([ a,b ] in iR or [ b,a ] in iR) by A1,A113,CKB74:1;
reconsider a,b as (Element of R) by A114;
(a <= b or b <= a) by A115,ORDERS_2:def 5;
hence contradiction by A114,A111,A108,DILWORTH:def 2;
end;
suppose that A116: a in d
and
A117: b in ( r . d );
consider bm being (Element of ( NAT )) such that A118: b = ( bm + n ) and A119: bm in d by A117,A98;
reconsider ap1 = a as Nat by A116,A1,NECKLACE:3;
A120: ([ ap1,bm ] in iR or [ bm,ap1 ] in iR) by A113,CKB76:1,CKB77:1,A118,A116,A1;
reconsider bmp1 = bm,a as (Element of R) by A119,A116;
A121: (bmp1 <= a or a <= bmp1) by A120,ORDERS_2:def 5;
bmp1 <> a by A120,A116,NECKLACE:def 5;
hence contradiction by A121,A119,A116,A108,DILWORTH:def 2;
end;
suppose that A122: a in ( r . d )
and
A123: b in d;
consider am being (Element of ( NAT )) such that A124: a = ( am + n ) and A125: am in d by A122,A98;
reconsider bp1 = b as Nat by A123,A1,NECKLACE:3;
A126: ([ am,bp1 ] in iR or [ bp1,am ] in iR) by A113,CKB76:1,CKB77:1,A124,A123,A1;
reconsider amp1 = am,b as (Element of R) by A125,A123;
A127: (amp1 <= b or b <= amp1) by A126,ORDERS_2:def 5;
amp1 <> b by A126,A123,NECKLACE:def 5;
hence contradiction by A127,A125,A123,A108,DILWORTH:def 2;
end;
suppose that A128: a in ( r . d )
and
A129: b in ( r . d );
consider am being (Element of ( NAT )) such that A130: a = ( am + n ) and am in d by A128,A98;
consider bm being (Element of ( NAT )) such that A131: b = ( bm + n ) and bm in d by A129,A98;
(((n <= ( am + n ) & ( am + n ) < ( 2 * n )) & n <= ( bm + n )) & ( bm + n ) < ( 2 * n )) by A128,A129,A130,A131,A105;
hence contradiction by A130,A131,A113,CKB72:1;
end;
end;
hence x is (StableSet of MR) by A99,DILWORTH:def 2;
end;
suppose x in { { ( 2 * n ) } };

then A132: x = { ( 2 * n ) } by TARSKI:def 1;
( 2 * n ) < ( ( 2 * n ) + 1 ) by NAT_1:13;
then ( 2 * n ) in ( ( 2 * n ) + 1 ) by NAT_1:44;
then A133: ( 2 * n ) in cMR by CKB57:def 1;
x is (Subset of MR) by A132,A133,SUBSET_1:33;
hence x is (StableSet of MR) by A132;
end;
end;
then reconsider E as (Coloring of MR) by DILWORTH:def 12;
take E;
now
assume { ( 2 * n ) } in D;
then consider d being (Element of C) such that A134: { ( 2 * n ) } = ( d \/ ( r . d ) ) and A135: d in C;
A136: ( 2 * n ) in ( d \/ ( r . d ) ) by A134,TARSKI:def 1;
per cases  by A136,XBOOLE_0:def 3;
suppose ( 2 * n ) in d;

then ( 2 * n ) in cR by A135;
then ( 2 * n ) in n by CKB57:def 1;
then ( n + n ) < n by NAT_1:44;
hence contradiction by NAT_1:11;
end;
suppose ( 2 * n ) in ( r . d );

then ( 2 * n ) in { ( m + n ) where m is (Element of ( NAT )): m in d } by A135,A5;
then consider m being (Element of ( NAT )) such that A137: ( 2 * n ) = ( m + n ) and A138: m in d;
m in cR by A135,A138;
then m in n by CKB57:def 1;
hence contradiction by A137;
end;
end;
hence ( card E ) = ( 1 + cnR ) by A6,A30,A3,CARD_2:41;
end;
(for C being  finite (Coloring of MR) holds ( 1 + cnR ) <= ( card C ))
proof
let E being  finite (Coloring of MR);
assume ( 1 + cnR ) > ( card E );
then A139: cnR >= ( card E ) by NAT_1:13;
A140: cnMR <= ( card E ) by CKB19:def 1;
then A141: cnMR <= cnR by A139,XXREAL_0:2;
n <= ( n + n ) by NAT_1:11;
then n < ( ( 2 * n ) + 1 ) by NAT_1:13;
then n c= ( ( 2 * n ) + 1 ) by NAT_1:39;
then reconsider S = n as (Subset of MR) by CKB57:def 1;
A142: R = ( subrelstr S ) by CKB79:1;
then cnR <= cnMR by CKB81:1;
then cnR = cnMR by A141,XXREAL_0:1;
then A143: ( card E ) = cnR by A139,A140,XXREAL_0:1;
reconsider C = ( E | S ) as (Coloring of R) by A142,CKB13:1;
A144: ( card C ) >= cnR by CKB19:def 1;
A145: ( card C ) <= ( card E ) by CKB11:1;
then A146: ( card C ) = cnR by A143,A144,XXREAL_0:1;
( 2 * n ) < ( ( 2 * n ) + 1 ) by NAT_1:13;
then ( 2 * n ) in ( ( 2 * n ) + 1 ) by NAT_1:44;
then ( 2 * n ) in cMR by CKB57:def 1;
then ( 2 * n ) in ( union E ) by EQREL_1:def 4;
then consider e being set such that A147: ( 2 * n ) in e and A148: e in E by TARSKI:def 4;
reconsider e as (Subset of MR) by A148;
reconsider n2 = ( 2 * n ) as (Element of MR) by A147,A148;
set se = ( e /\ S );
e meets S by A143,A146,A148,CKB12:1;
then A149: se in C by A148;
then consider mp1 being (Element of R) such that A150: mp1 in se and A151: (for d being (Element of C) holds (d <> se implies (ex w being (Element of R) st (w in ( Adjacent mp1 ) & w in d)))) by A145,A143,A144,CKB56:1,XXREAL_0:1;
reconsider m = mp1 as Nat by A150,A149,NECKLACE:3;
set mn = ( m + n );
A152: ( ( 0 ) + n ) <= mn by XREAL_1:6;
m < n by A150,A149,NAT_1:44;
then A153: mn < ( n + n ) by XREAL_1:6;
then mn < ( ( 2 * n ) + 1 ) by NAT_1:13;
then A154: mn in ( ( 2 * n ) + 1 ) by NAT_1:44;
then mn in cMR by CKB57:def 1;
then mn in ( union E ) by EQREL_1:def 4;
then consider f being set such that A155: mn in f and A156: f in E by TARSKI:def 4;
reconsider f as (Subset of MR) by A156;
reconsider mnp1 = mn as (Element of MR) by A154,CKB57:def 1;
A157:now
assume A158: e <> f;
set sf = ( f /\ S );
f meets S by A143,A146,A156,CKB12:1;
then A159: sf in C by A156;
A160: sf c= f by XBOOLE_1:17;
now
assume A161: sf = se;
sf <> ( {} ) by A159,EQREL_1:def 4;
then consider x being set such that A162: x in sf by XBOOLE_0:def 1;
se c= e by XBOOLE_1:17;
then e meets f by A161,A162,A160,XBOOLE_0:3;
hence contradiction by A158,A156,A148,EQREL_1:def 4;
end;
then consider wp1 being (Element of R) such that A163: wp1 in ( Adjacent mp1 ) and A164: wp1 in sf by A159,A151;
reconsider w = wp1 as Nat by A164,A159,NECKLACE:3;
A165: w < n by A164,A159,NAT_1:44;
(mp1 < wp1 or wp1 < mp1) by A163,CKB55:def 1;
then (mp1 <= wp1 or wp1 <= mp1) by ORDERS_2:def 6;
then ([ m,w ] in iR or [ w,m ] in iR) by ORDERS_2:def 5;
then A166: ([ ( m + n ),w ] in iMR or [ w,( m + n ) ] in iMR) by CKB75:1;
reconsider wp2 = wp1 as (Element of MR) by A164;
f is  stable by A156,DILWORTH:def 12;
then ((not wp2 <= mnp1) & (not mnp1 <= wp2)) by A165,A152,A164,A160,A155,DILWORTH:def 2;
hence contradiction by A166,ORDERS_2:def 5;
end;
A167: [ mn,( 2 * n ) ] in iMR by A153,A152,CKB78:1;
e is  stable by A148,DILWORTH:def 12;
then ((not mnp1 <= n2) & (not n2 <= mnp1)) by A147,A155,A157,A153,DILWORTH:def 2;
hence contradiction by A167,ORDERS_2:def 5;
end;
hence ( chromatic# ( Mycielskian R ) ) = ( 1 + ( chromatic# R ) ) by A2,CKB19:def 1;
end;
