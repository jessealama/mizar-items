environ
vocabularies NUMBERS,FINSEQ_1,ORDINAL4,XBOOLE_0,SUBSET_1,ARYTM_3,RELAT_1,XXREAL_0,CARD_1,NAT_1,FUNCT_1,FINSEQ_5,ARYTM_1,TARSKI,WELLORD1,PBOOLE,RELAT_2,FUNCOP_1,EQREL_1,REWRITE1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,FUNCT_1,RELAT_1,RELAT_2,WELLORD1,EQREL_1,FINSEQ_1,FUNCOP_1,PBOOLE,FINSEQ_5,CKB1;
definitions TARSKI,RELAT_1,RELAT_2,WELLORD1,CKB1;
theorems TARSKI,ZFMISC_1,NAT_1,WELLORD1,RELAT_1,RELAT_2,FUNCT_1,FUNCOP_1,FINSEQ_1,FINSEQ_5,EQREL_1,WELLORD2,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,ORDINAL1,CARD_1,PARTFUN1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6;
schemes NAT_1,RELAT_1,EQREL_1,TREES_2;
registrations XBOOLE_0,RELAT_1,FUNCT_1,ORDINAL1,PARTFUN1,NAT_1,XXREAL_0,XREAL_0,FINSEQ_1,CARD_1;
constructors SETFAM_1,WELLORD1,XXREAL_0,XREAL_0,NAT_1,EQREL_1,PBOOLE,FINSEQ_5,RELSET_1,CKB1;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
Lm1:now
let p being FinSequence;
let x being Nat;
assume x in ( dom p );
then A1: x in ( Seg ( len p ) ) by FINSEQ_1:def 3;
hence (x <= ( len p ) & x >= ( ( 0 ) + 1 )) by FINSEQ_1:1;
thus x > ( 0 ) by A1,FINSEQ_1:1;
end;
Lm2:now
let p being FinSequence;
let x being Nat;
assume ( x + 1 ) in ( dom p );
then ( x + 1 ) <= ( len p ) by Lm1;
hence x < ( len p ) by NAT_1:13;
end;
Lm3:now
let p being FinSequence;
let x being Nat;
assume that
A1: (x <= ( len p ) or x < ( len p ))
and
A2: (x >= 1 or x > ( 0 ));
x >= ( ( 0 ) + 1 ) by A2,NAT_1:13;
then x in ( Seg ( len p ) ) by A1,FINSEQ_1:1;
hence x in ( dom p ) by FINSEQ_1:def 3;
end;
Lm4:now
let p being FinSequence;
let x being Nat;
assume x < ( len p );
then ( x + 1 ) <= ( len p ) by NAT_1:13;
hence ( x + 1 ) in ( dom p ) by Lm3;
end;
reserve p for FinSequence;
reserve q for FinSequence;
reserve r for FinSequence;
reserve x for set;
reserve y for set;
scheme PathCatenation { P[set,set],p,q() -> FinSequence } : (for i being (Element of ( NAT )) holds ((i in ( dom ( p() $^ q() ) ) & ( i + 1 ) in ( dom ( p() $^ q() ) )) implies (for x,y being set holds ((x = ( ( p() $^ q() ) . i ) & y = ( ( p() $^ q() ) . ( i + 1 ) )) implies P[ x,y ]))))
provided
A1: (for i being (Element of ( NAT )) holds ((i in ( dom p() ) & ( i + 1 ) in ( dom p() )) implies P[ ( p() . i ),( p() . ( i + 1 ) ) ]))
and
A2: (for i being (Element of ( NAT )) holds ((i in ( dom q() ) & ( i + 1 ) in ( dom q() )) implies P[ ( q() . i ),( q() . ( i + 1 ) ) ]))
and
A3: ((( len p() ) > ( 0 ) & ( len q() ) > ( 0 )) & ( p() . ( len p() ) ) = ( q() . 1 ))
proof
p() <> ( {} ) by A3;
then consider r being FinSequence,a being set such that A4: p() = ( r ^ <* a *> ) by FINSEQ_1:46;
q() <> ( {} ) by A3;
then A5: ( p() $^ q() ) = ( r ^ q() ) by A4,CKB3:1;
( ( 0 ) + 1 ) <= ( len q() ) by A3,NAT_1:13;
then A6: 1 in ( Seg ( len q() ) ) by FINSEQ_1:1;
A7: ( Seg ( len q() ) ) = ( dom q() ) by FINSEQ_1:def 3;
let i being (Element of ( NAT ));
assume that
A8: i in ( dom ( p() $^ q() ) )
and
A9: ( i + 1 ) in ( dom ( p() $^ q() ) );
A10: i >= ( ( 0 ) + 1 ) by A8,Lm1;
let x being set;
let y being set;
A11: ( i + 1 ) >= 1 by NAT_1:11;
A12: ( len p() ) = ( ( len r ) + ( len <* a *> ) ) by A4,FINSEQ_1:22
.= ( ( len r ) + 1 ) by FINSEQ_1:40;
assume that
A13: x = ( ( p() $^ q() ) . i )
and
A14: y = ( ( p() $^ q() ) . ( i + 1 ) );
per cases ;
suppose A15: i < ( len p() );

then (i in ( dom p() ) & ( i + 1 ) in ( dom p() )) by A10,Lm3,Lm4;
then A16: P[ ( p() . i ),( p() . ( i + 1 ) ) ] by A1;
A17:now
assume ( i + 1 ) <= ( len r );
then ( i + 1 ) in ( Seg ( len r ) ) by A11,FINSEQ_1:1;
then ( i + 1 ) in ( dom r ) by FINSEQ_1:def 3;
hence (y = ( r . ( i + 1 ) ) & ( r . ( i + 1 ) ) = ( p() . ( i + 1 ) )) by A14,A4,A5,FINSEQ_1:def 7;
end;
A18: i <= ( len r ) by A12,A15,NAT_1:13;
then i in ( Seg ( len r ) ) by A10,FINSEQ_1:1;
then i in ( dom r ) by FINSEQ_1:def 3;
then A19: (x = ( r . i ) & ( r . i ) = ( p() . i )) by A13,A4,A5,FINSEQ_1:def 7;
(i = ( len r ) or i < ( len r )) by A18,XXREAL_0:1;
hence thesis by A3,A6,A7,A14,A5,A12,A16,A19,A17,FINSEQ_1:def 7,NAT_1:13;
end;
suppose i >= ( len p() );

then consider k being Nat such that A20: i = ( ( len p() ) + k ) by NAT_1:10;
reconsider k as (Element of ( NAT )) by ORDINAL1:def 12;
A21: i = ( ( len r ) + ( 1 + k ) ) by A12,A20;
( len ( p() $^ q() ) ) = ( ( len r ) + ( len q() ) ) by A5,FINSEQ_1:22;
then A22: ( k + 1 ) < ( len q() ) by A9,A21,Lm2,XREAL_1:7;
then A23: ( ( k + 1 ) + 1 ) in ( dom q() ) by Lm4;
A24: ( k + 1 ) in ( dom q() ) by A22,Lm3;
then A25: x = ( q() . ( k + 1 ) ) by A13,A5,A21,FINSEQ_1:def 7;
( ( ( len r ) + ( 1 + k ) ) + 1 ) = ( ( len r ) + ( ( k + 1 ) + 1 ) );
then y = ( q() . ( ( k + 1 ) + 1 ) ) by A14,A5,A12,A20,A23,FINSEQ_1:def 7;
hence thesis by A2,A24,A23,A25;
end;
end;
