environ
vocabularies NUMBERS,XBOOLE_0,FINSET_1,FINSEQ_1,RELAT_1,TARSKI,RPR_1,NAT_1,CARD_1,SUBSET_1,FUNCT_1,REAL_1,ARYTM_3,UPROOTS,SETFAM_1,MATRPROB,VALUED_1,CARD_3,PROB_2,XXREAL_0,ORDINAL4,PARTFUN1,DIST_1;
notations TARSKI,XBOOLE_0,SUBSET_1,FINSET_1,CARD_1,CARD_3,NUMBERS,XXREAL_0,BINOP_2,REAL_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FINSEQ_1,FINSEQ_2,VALUED_1,FUNCT_2,NAT_1,SETFAM_1,RPR_1,PROB_2,RVSUM_1,UPROOTS,MATRPROB,CKB1,CKB4,CKB5,CKB6,CKB9,CKB11,CKB13,CKB15,CKB19,CKB22,CKB26,CKB27;
definitions TARSKI,RPR_1,FINSEQ_1,RELAT_1,FUNCT_1,CARD_3,CKB6,CKB9,CKB11,CKB13,CKB15,CKB19,CKB22,CKB26,CKB27;
theorems TARSKI,FINSEQ_2,CARD_2,FINSEQ_4,FUNCT_1,FINSEQ_1,XBOOLE_0,XBOOLE_1,XXREAL_0,PROB_2,NAT_1,RELAT_1,ZFMISC_1,FUNCT_2,XCMPLX_1,VALUED_1,UPROOTS,FINSEQ_5,CARD_1,RVSUM_1,MATRPROB,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31;
schemes NAT_1,FINSEQ_1,FUNCT_2,SUBSET_1,CLASSES1;
registrations FUNCT_1,SUBSET_1,NAT_1,XREAL_0,XXREAL_0,ORDINAL1,UPROOTS,FINSEQ_1,FUNCT_2,RELAT_1,XBOOLE_0,FINSET_1,NUMBERS,VALUED_0,VALUED_1,CARD_1,MATRPROB,ENTROPY1,CKB2,CKB25;
constructors RPR_1,RVSUM_1,SEQ_1,BINOP_2,PARTFUN3,PROB_2,UPROOTS,MATRPROB,RELSET_1,REAL_1,CKB5,CKB6,CKB9,CKB11,CKB13,CKB15,CKB19,CKB22,CKB26,CKB27;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
theorem
Th17: (for n being Nat holds (for S being Function holds (for L being (FinSequence of ( NAT )) holds ((((S is  disjoint_valued & ( dom S ) = ( dom L )) & n = ( len L )) & (for i being Nat holds (i in ( dom S ) implies (( S . i ) is  finite & ( L . i ) = ( card ( S . i ) ))))) implies (( Union S ) is  finite & ( card ( Union S ) ) = ( Sum L ))))))
proof
defpred P[ Nat ]
 means
(for S being Function holds (for L being (FinSequence of ( NAT )) holds ((((S is  disjoint_valued & ( dom S ) = ( dom L )) & $1 = ( len L )) & (for i being Nat holds (i in ( dom S ) implies (( S . i ) is  finite & ( L . i ) = ( card ( S . i ) ))))) implies (( Union S ) is  finite & ( card ( Union S ) ) = ( Sum L )))));
A1:now
let n being Nat;
assume A2: P[ n ];
now
let S being Function;
let L being (FinSequence of ( NAT ));
assume that
A3: S is  disjoint_valued
and
A4: ( dom S ) = ( dom L )
and
A5: ( n + 1 ) = ( len L )
and
A6: (for i being Nat holds (i in ( dom S ) implies (( S . i ) is  finite & ( L . i ) = ( card ( S . i ) ))));
reconsider SN = ( S | ( Seg n ) ) as Function;
reconsider LN = ( L | n ) as (FinSequence of ( NAT ));
A7: n = ( len LN ) by A5,FINSEQ_1:59,NAT_1:12;
now
let x being set;
assume x in ( Union S );
then consider y being set such that A8: x in y and A9: y in ( rng S ) by TARSKI:def 4;
consider i being set such that A10: i in ( dom S ) and A11: y = ( S . i ) by A9,FUNCT_1:def 3;
A12: i in ( Seg ( n + 1 ) ) by A4,A5,A10,FINSEQ_1:def 3;
reconsider i as (Element of ( NAT )) by A4,A10;
A13: i <= ( n + 1 ) by A12,FINSEQ_1:1;
A14: 1 <= i by A12,FINSEQ_1:1;
now
per cases ;
suppose i = ( n + 1 );

hence x in ( ( Union SN ) \/ ( S . ( n + 1 ) ) ) by A8,A11,XBOOLE_0:def 3;
end;
suppose i <> ( n + 1 );

then i < ( n + 1 ) by A13,XXREAL_0:1;
then i <= n by NAT_1:13;
then i in ( Seg n ) by A14;
then i in ( ( dom S ) /\ ( Seg n ) ) by A10,XBOOLE_0:def 4;
then A15: i in ( dom SN ) by RELAT_1:61;
then ( S . i ) = ( SN . i ) by FUNCT_1:47;
then y in ( rng SN ) by A11,A15,FUNCT_1:def 3;
then x in ( Union SN ) by A8,TARSKI:def 4;
hence x in ( ( Union SN ) \/ ( S . ( n + 1 ) ) ) by XBOOLE_0:def 3;
end;
end;
hence x in ( ( Union SN ) \/ ( S . ( n + 1 ) ) );
end;
then A16: ( Union S ) c= ( ( Union SN ) \/ ( S . ( n + 1 ) ) ) by TARSKI:def 3;
A17: ( ( Union SN ) \/ ( S . ( n + 1 ) ) ) c= ( Union S )
proof
let x being set;
assume A18: x in ( ( Union SN ) \/ ( S . ( n + 1 ) ) );
now
per cases  by A18,XBOOLE_0:def 3;
suppose A19: x in ( S . ( n + 1 ) );

( n + 1 ) in ( Seg ( n + 1 ) ) by FINSEQ_1:4;
then ( n + 1 ) in ( dom S ) by A4,A5,FINSEQ_1:def 3;
then ( S . ( n + 1 ) ) in ( rng S ) by FUNCT_1:def 3;
hence x in ( Union S ) by A19,TARSKI:def 4;
end;
suppose x in ( Union SN );

then consider y being set such that A20: x in y and A21: y in ( rng SN ) by TARSKI:def 4;
consider i being set such that A22: i in ( dom SN ) and A23: y = ( SN . i ) by A21,FUNCT_1:def 3;
i in ( ( dom S ) /\ ( Seg n ) ) by A22,RELAT_1:61;
then A24: i in ( dom S ) by XBOOLE_0:def 4;
( SN . i ) = ( S . i ) by A22,FUNCT_1:47;
then y in ( rng S ) by A23,A24,FUNCT_1:def 3;
hence x in ( Union S ) by A20,TARSKI:def 4;
end;
end;
hence x in ( Union S );
end;
then A25: ( ( Union SN ) \/ ( S . ( n + 1 ) ) ) = ( Union S ) by A16,XBOOLE_0:def 10;
A26: (for i being Nat holds (i in ( dom SN ) implies (( SN . i ) is  finite & ( LN . i ) = ( card ( SN . i ) ))))
proof
let i being Nat;
assume A27: i in ( dom SN );
then A28: i in ( ( dom S ) /\ ( Seg n ) ) by RELAT_1:61;
then A29: i in ( dom S ) by XBOOLE_0:def 4;
( LN . i ) = ( L . i ) by A4,A28,FUNCT_1:48
.= ( card ( S . i ) ) by A6,A29
.= ( card ( SN . i ) ) by A27,FUNCT_1:47;
hence thesis;
end;
now
let x being set;
let y being set;
assume A30: x <> y;
per cases ;
suppose (x in ( dom SN ) & y in ( dom SN ));

then (( SN . x ) = ( S . x ) & ( SN . y ) = ( S . y )) by FUNCT_1:47;
hence ( SN . x ) misses ( SN . y ) by A3,A30,PROB_2:def 2;
end;
suppose A31: (not (x in ( dom SN ) & y in ( dom SN )));

now
per cases  by A31;
suppose (not x in ( dom SN ));

then ( SN . x ) = ( {} ) by FUNCT_1:def 2;
then ( ( SN . x ) /\ ( SN . y ) ) = ( {} );
hence ( SN . x ) misses ( SN . y ) by XBOOLE_0:def 7;
end;
suppose (not y in ( dom SN ));

then ( SN . y ) = ( {} ) by FUNCT_1:def 2;
then ( ( SN . x ) /\ ( SN . y ) ) = ( {} );
hence ( SN . x ) misses ( SN . y ) by XBOOLE_0:def 7;
end;
end;
hence ( SN . x ) misses ( SN . y );
end;
end;
then A32: SN is  disjoint_valued by PROB_2:def 2;
A33: ( dom SN ) = ( ( dom S ) /\ ( Seg n ) ) by RELAT_1:61
.= ( dom LN ) by A4,RELAT_1:61;
then A34: ( card ( Union SN ) ) = ( Sum LN ) by A2,A32,A7,A26;
reconsider USN = ( Union SN ) as  finite set by A2,A32,A33,A7,A26;
A35: 1 <= ( n + 1 ) by NAT_1:11;
A36: L = ( ( L | n ) ^ <* ( L /. ( len L ) ) *> ) by A5,FINSEQ_5:21
.= ( LN ^ <* ( L . ( n + 1 ) ) *> ) by A5,A35,FINSEQ_4:15;
( n + 1 ) in ( Seg ( len L ) ) by A5,FINSEQ_1:4;
then A37: ( n + 1 ) in ( dom S ) by A4,FINSEQ_1:def 3;
then reconsider S1 = ( S . ( n + 1 ) ) as  finite set by A6;
( Union S ) = ( USN \/ S1 ) by A16,A17,XBOOLE_0:def 10;
hence ( Union S ) is  finite;
(for z being set holds (z in ( rng SN ) implies z misses ( S . ( n + 1 ) )))
proof
let y being set;
assume y in ( rng SN );
then consider i being set such that A38: i in ( dom SN ) and A39: y = ( SN . i ) by FUNCT_1:def 3;
A40: i in ( ( dom S ) /\ ( Seg n ) ) by A38,RELAT_1:61;
then A41: i in ( Seg n ) by XBOOLE_0:def 4;
reconsider i as (Element of ( NAT )) by A40;
i <= n by A41,FINSEQ_1:1;
then A42: i <> ( n + 1 ) by NAT_1:13;
y = ( S . i ) by A38,A39,FUNCT_1:47;
hence thesis by A3,A42,PROB_2:def 2;
end;
then ( Union SN ) misses ( S . ( n + 1 ) ) by ZFMISC_1:80;
then ( card ( ( Union SN ) \/ ( S . ( n + 1 ) ) ) ) = ( ( card USN ) + ( card S1 ) ) by CARD_2:40;
hence ( card ( Union S ) ) = ( ( Sum LN ) + ( L . ( n + 1 ) ) ) by A6,A37,A34,A25
.= ( Sum L ) by A36,RVSUM_1:74;
end;
hence P[ ( n + 1 ) ];
end;
A43: P[ ( 0 ) ]
proof
let S being Function;
let L being (FinSequence of ( NAT ));
assume that
S is  disjoint_valued
and
A44: ( dom S ) = ( dom L )
and
A45: ( 0 ) = ( len L )
and
(for i being Nat holds (i in ( dom S ) implies (( S . i ) is  finite & ( L . i ) = ( card ( S . i ) ))));
A46: L = ( {} ) by A45;
then S = ( {} ) by A44;
then (for X being set holds (X in ( rng S ) implies X c= ( {} )));
then ( Union S ) c= ( {} ) by ZFMISC_1:76;
hence (( Union S ) is  finite & ( card ( Union S ) ) = ( Sum L )) by A46,RVSUM_1:72;
end;
thus (for n being Nat holds P[ n ]) from NAT_1:sch 2(A43,A1);
end;
