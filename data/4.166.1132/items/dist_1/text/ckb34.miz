environ
vocabularies NUMBERS,XBOOLE_0,FINSET_1,FINSEQ_1,RELAT_1,TARSKI,RPR_1,NAT_1,CARD_1,SUBSET_1,FUNCT_1,REAL_1,ARYTM_3,UPROOTS,SETFAM_1,MATRPROB,VALUED_1,CARD_3,PROB_2,XXREAL_0,ORDINAL4,PARTFUN1,DIST_1;
notations TARSKI,XBOOLE_0,SUBSET_1,FINSET_1,CARD_1,CARD_3,NUMBERS,XXREAL_0,BINOP_2,REAL_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FINSEQ_1,FINSEQ_2,VALUED_1,FUNCT_2,NAT_1,SETFAM_1,RPR_1,PROB_2,RVSUM_1,UPROOTS,MATRPROB,CKB1,CKB4,CKB5,CKB6,CKB9,CKB11,CKB13,CKB15,CKB19,CKB22,CKB26,CKB27;
definitions TARSKI,RPR_1,FINSEQ_1,RELAT_1,FUNCT_1,CARD_3,CKB6,CKB9,CKB11,CKB13,CKB15,CKB19,CKB22,CKB26,CKB27;
theorems TARSKI,FINSEQ_2,CARD_2,FINSEQ_4,FUNCT_1,FINSEQ_1,XBOOLE_0,XBOOLE_1,XXREAL_0,PROB_2,NAT_1,RELAT_1,ZFMISC_1,FUNCT_2,XCMPLX_1,VALUED_1,UPROOTS,FINSEQ_5,CARD_1,RVSUM_1,MATRPROB,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33;
schemes NAT_1,FINSEQ_1,FUNCT_2,SUBSET_1,CLASSES1;
registrations FUNCT_1,SUBSET_1,NAT_1,XREAL_0,XXREAL_0,ORDINAL1,UPROOTS,FINSEQ_1,FUNCT_2,RELAT_1,XBOOLE_0,FINSET_1,NUMBERS,VALUED_0,VALUED_1,CARD_1,MATRPROB,ENTROPY1,CKB2,CKB25;
constructors RPR_1,RVSUM_1,SEQ_1,BINOP_2,PARTFUN3,PROB_2,UPROOTS,MATRPROB,RELSET_1,REAL_1,CKB5,CKB6,CKB9,CKB11,CKB13,CKB15,CKB19,CKB22,CKB26,CKB27;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
theorem
Th19: (for S being non  empty  finite set holds (for s being non  empty (FinSequence of S) holds ( Sum ( freqSEQ s ) ) = ( len s )))
proof
let S being non  empty  finite set;
let s being non  empty (FinSequence of S);
set L = ( freqSEQ s );
defpred P[ set,set ]
 means
(ex z being (Element of S) st (z = ( ( canFS S ) . $1 ) & $2 = ( event_pick (z,s) )));
( len ( canFS S ) ) = ( card S ) by UPROOTS:3;
then A1: ( dom ( canFS S ) ) = ( Seg ( card S ) ) by FINSEQ_1:def 3;
A2: (for x being set holds (x in ( dom L ) implies (ex y being set st P[ x,y ])))
proof
let x being set;
set z = ( ( canFS S ) . x );
assume x in ( dom L );
then A3: x in ( Seg ( card S ) ) by CKB27:def 1;
( rng ( canFS S ) ) = S by FUNCT_2:def 3;
then reconsider z as (Element of S) by A1,A3,FUNCT_1:3;
consider y being set such that A4: y = ( s " { z } );
take y;
y = ( event_pick (z,s) ) by A4;
hence thesis;
end;
consider T being Function such that A6: (( dom T ) = ( dom L ) & (for x being set holds (x in ( dom L ) implies P[ x,( T . x ) ]))) from CLASSES1:sch 1(A2);
A7: (for a,b being set holds (((a in ( dom T ) & b in ( dom T )) & a <> b) implies ( T . a ) misses ( T . b )))
proof
let a being set;
let b being set;
assume that
A8: (a in ( dom T ) & b in ( dom T ))
and
A9: a <> b;
(a in ( dom ( canFS S ) ) & b in ( dom ( canFS S ) )) by A1,A6,A8,CKB27:def 1;
then A10: ( ( canFS S ) . a ) <> ( ( canFS S ) . b ) by A9,FUNCT_1:def 4;
((ex za being (Element of S) st (za = ( ( canFS S ) . a ) & ( T . a ) = ( event_pick (za,s) ))) & (ex zb being (Element of S) st (zb = ( ( canFS S ) . b ) & ( T . b ) = ( event_pick (zb,s) )))) by A6,A8;
hence thesis by A10,FUNCT_1:71,ZFMISC_1:11;
end;
(for a,b being set holds (a <> b implies ( T . a ) misses ( T . b )))
proof
let a being set;
let b being set;
assume A11: a <> b;
now
per cases ;
case (a in ( dom T ) & b in ( dom T ));
hence thesis by A7,A11;
end;
case (not a in ( dom T ));
then ( T . a ) = ( {} ) by FUNCT_1:def 2;
hence thesis by XBOOLE_1:65;
end;
case (a in ( dom T ) & (not b in ( dom T )));
then ( T . b ) = ( {} ) by FUNCT_1:def 2;
hence thesis by XBOOLE_1:65;
end;
end;
hence thesis;
end;
then A12: T is  disjoint_valued by PROB_2:def 2;
A13: ( Seg ( len s ) ) c= ( Union T )
proof
assume (not ( Seg ( len s ) ) c= ( Union T ));
then consider ne being set such that A14: ne in ( Seg ( len s ) ) and A15: (not ne in ( Union T )) by TARSKI:def 3;
set yne = ( s . ne );
A16: ne in ( dom s ) by A14,FINSEQ_1:def 3;
then yne in ( rng s ) by FUNCT_1:def 3;
then reconsider yne as (Element of S);
( rng ( canFS S ) ) = S by FUNCT_2:def 3;
then consider nne being set such that A17: nne in ( dom ( canFS S ) ) and A18: yne = ( ( canFS S ) . nne ) by FUNCT_1:def 3;
A19: nne in ( dom L ) by A1,A17,CKB27:def 1;
then A20: ( T . nne ) in ( rng T ) by A6,FUNCT_1:3;
A21: ( s . ne ) in { ( s . ne ) } by TARSKI:def 1;
(ex zne being (Element of S) st (zne = ( ( canFS S ) . nne ) & ( T . nne ) = ( event_pick (zne,s) ))) by A6,A19;
then ne in ( T . nne ) by A16,A18,A21,FUNCT_1:def 7;
hence contradiction by A15,A20,TARSKI:def 4;
end;
A22: (for i being Nat holds (i in ( dom T ) implies (( T . i ) is  finite & ( L . i ) = ( card ( T . i ) ))))
proof
let i being Nat;
assume A23: i in ( dom T );
then A24: (ex zi being (Element of S) st (zi = ( ( canFS S ) . i ) & ( T . i ) = ( event_pick (zi,s) ))) by A6;
( dom L ) = ( Seg ( card S ) ) by CKB27:def 1;
then A25: i in ( dom ( FDprobSEQ s ) ) by A6,A23,CKB11:def 1;
( L . i ) = ( ( len s ) * ( ( FDprobSEQ s ) . i ) ) by A6,A23,CKB27:def 1
.= ( ( len s ) * ( FDprobability (( ( canFS S ) . i ),s) ) ) by A25,CKB11:def 1
.= ( card ( T . i ) ) by A24,XCMPLX_1:87;
hence thesis;
end;
then reconsider T1 = ( Union T ) as  finite set by A6,A12,CKB33:1;
(for X being set holds (X in ( rng T ) implies X c= ( Seg ( len s ) )))
proof
let X being set;
assume X in ( rng T );
then consider j being set such that A26: j in ( dom T ) and A27: X = ( T . j ) by FUNCT_1:def 3;
(ex zj being (Element of S) st (zj = ( ( canFS S ) . j ) & ( T . j ) = ( event_pick (zj,s) ))) by A6,A26;
then X c= ( whole_event s ) by A27;
hence thesis by FINSEQ_1:def 3;
end;
then ( Union T ) c= ( Seg ( len s ) ) by ZFMISC_1:76;
then A28: T1 = ( Seg ( len s ) ) by A13,XBOOLE_0:def 10;
thus ( Sum ( freqSEQ s ) ) = ( card T1 ) by A6,A12,A22,CKB33:1
.= ( len s ) by A28,FINSEQ_1:57;
end;
