environ
vocabularies FINSET_1,CARD_1,XBOOLE_0,SUBSET_1,CARD_5,SETFAM_1,TARSKI,ZFMISC_1,ORDINAL1,CARD_2,FUNCT_1,RELAT_1,ORDINAL2,FUNCT_2,CARD_3,FUNCOP_1,FUNCT_5,CARD_FIL;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,FUNCOP_1,BINOP_1,FUNCT_5,SETFAM_1,FINSET_1,ORDINAL1,CARD_1,RELSET_1,FUNCT_2,ORDINAL2,CARD_2,CARD_3,CARD_5,CKB4,CKB10,CKB14,CKB15,CKB18,CKB19,CKB20,CKB21,CKB23,CKB24,CKB25,CKB26,CKB29,CKB33,CKB34,CKB44,CKB45,CKB48,CKB53,CKB59,CKB65,CKB67,CKB68;
definitions TARSKI,FUNCT_1,CARD_1,XBOOLE_0,BINOP_1,SUBSET_1,CKB4,CKB14,CKB18,CKB19,CKB23,CKB24,CKB25,CKB26,CKB29,CKB33,CKB34,CKB44,CKB45,CKB48,CKB53,CKB59,CKB65,CKB68;
theorems TARSKI,FUNCT_1,FUNCT_2,ORDINAL1,ORDINAL2,WELLORD2,CARD_1,CARD_2,CARD_5,SETFAM_1,ZFMISC_1,FUNCT_5,RELAT_1,SUBSET_1,FUNCOP_1,SETWISEO,RELSET_1,FRAENKEL,ORDERS_1,XBOOLE_0,XBOOLE_1,ORDINAL3,CARD_3,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB12,CKB13,CKB14,CKB16,CKB17,CKB18,CKB19,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB41,CKB42,CKB43,CKB44,CKB45,CKB47,CKB48,CKB49,CKB50,CKB52,CKB53,CKB55,CKB56,CKB58,CKB59,CKB60,CKB61,CKB65,CKB68;
schemes FUNCT_1,FUNCT_2,DOMAIN_1,FRAENKEL,TREES_2,BINOP_1,CKB2;
registrations XBOOLE_0,SUBSET_1,FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,CARD_1,CARD_5,CARD_3,CARD_2,CKB11,CKB39,CKB40,CKB46,CKB51,CKB54,CKB57,CKB62,CKB63,CKB64,CKB66;
constructors SETFAM_1,WELLORD2,BINOP_1,FUNCOP_1,ORDINAL2,FUNCT_5,CARD_2,CARD_5,NUMBERS,RELSET_1,CKB4,CKB14,CKB15,CKB18,CKB19,CKB23,CKB24,CKB25,CKB26,CKB29,CKB33,CKB34,CKB44,CKB45,CKB48,CKB53,CKB59,CKB65,CKB68;
requirements NUMERALS,SUBSET,BOOLE;
begin
reserve M for non limit_cardinal Aleph;
reserve N1 for (Element of ( predecessor M ));
reserve N2 for (Element of ( predecessor M ));
reserve K1 for (Element of M);
reserve K2 for (Element of M);
reserve T for (Inf_Matrix of ( predecessor M ),M,( bool M ));
theorem
Th34: (ex T st T is_Ulam_Matrix_of M)
proof
set N = ( predecessor M );
set GT = ( ( nextcard N ) \ N );
defpred P[ set,set ]
 means
(ex f being Function st ((($2 = f & f is  one-to-one) & ( dom f ) = N) & ( rng f ) = $1));
A1: (for K1 being set holds (K1 in GT implies (ex x being set st (x in ( Funcs (N,( nextcard N )) ) & P[ K1,x ]))))
proof
let K1 being set;
assume that
A2: K1 in ( ( nextcard N ) \ N );
reconsider K2 = K1 as (Element of ( nextcard N )) by A2;
(not K1 in N) by A2,XBOOLE_0:def 5;
then ( card N ) c= ( card K2 ) by CARD_1:11,ORDINAL1:16;
then A3: N c= ( card K2 ) by CARD_1:def 2;
( card K2 ) in ( nextcard N ) by CARD_1:9;
then ( card K2 ) c= N by CARD_3:91;
then ( card K2 ) = N by A3,XBOOLE_0:def 10
.= ( card N ) by CARD_1:def 2;
then K2,N are_equipotent  by CARD_1:5;
then consider f being Function such that A4: f is  one-to-one and A5: ( dom f ) = N and A6: ( rng f ) = K1 by WELLORD2:def 4;
( rng f ) c= ( nextcard N ) by A2,A6,ORDINAL1:def 2;
then f in ( Funcs (N,( nextcard N )) ) by A5,FUNCT_2:def 2;
hence thesis by A4,A5,A6;
end;
consider h1 being Function such that A7: ( dom h1 ) = GT and ( rng h1 ) c= ( Funcs (N,( nextcard N )) ) and A8: (for K1 being set holds (K1 in GT implies P[ K1,( h1 . K1 ) ])) from FUNCT_1:sch 5(A1);
(for K1 being set holds (K1 in ( dom h1 ) implies ( h1 . K1 ) is Function))
proof
let K1 being set;
assume K1 in ( dom h1 );
then (ex f being Function st (((( h1 . K1 ) = f & f is  one-to-one) & ( dom f ) = N) & ( rng f ) = K1)) by A7,A8;
hence thesis;
end;
then reconsider h = h1 as  Function-yielding Function by FUNCOP_1:def 6;
(N in ( nextcard N ) & (not N in N)) by CARD_1:18;
then reconsider GT1 = ( ( nextcard N ) \ N ) as non empty set by XBOOLE_0:def 5;
deffunc g(set,set) = ( ( h . $2 ) . $1 );
defpred P[ set,set,set ]
 means
$3 = { K2 where K2 is (Element of GT1): g($1,K2) = $2 };
A9: (for N1 holds (for K1 holds (ex S1 being (Subset of GT1) st P[ N1,K1,S1 ])))
proof
let N1;
let K1;
defpred P[ set ]
 means
g(N1,$1) = K1;
take { K2 where K2 is (Element of GT1): g(N1,K2) = K1 };
{ K2 where K2 is (Element of GT1): P[ K2 ] } is (Subset of GT1) from DOMAIN_1:sch 7;
hence thesis;
end;
consider T1 being (Function of [: ( predecessor M ),M :],( bool GT1 )) such that A10: (for N1 holds (for K1 holds P[ N1,K1,( T1 . (N1,K1) ) ])) from BINOP_1:sch 3(A9);
GT1 c= ( nextcard N );
then GT1 c= M by CKB65:def 1;
then ( bool GT1 ) c= ( bool M ) by ZFMISC_1:67;
then reconsider T = T1 as (Function of [: ( predecessor M ),M :],( bool M )) by FUNCT_2:7;
take T;
A11: (for N1 holds (for N2 holds (for K1 holds (for K2 holds (for K3 being set holds (K3 in ( ( T . (N1,K1) ) /\ ( T . (N2,K2) ) ) implies (ex K4 being (Element of GT1) st ((K4 = K3 & g(N1,K4) = K1) & g(N2,K4) = K2))))))))
proof
let N1;
let N2;
let K1;
let K2;
let K3 being set;
defpred A[ (Element of GT1) ]
 means
g(N1,$1) = K1;
defpred B[ (Element of GT1) ]
 means
g(N2,$1) = K2;
assume A12: K3 in ( ( T . (N1,K1) ) /\ ( T . (N2,K2) ) );
then A13: K3 in ( T1 . (N1,K1) ) by XBOOLE_0:def 4;
then reconsider K4 = K3 as (Element of GT1);
take K4;
thus K4 = K3;
A14: K4 in { K5 where K5 is (Element of GT1): A[ K5 ] } by A10,A13;
thus A[ K4 ] from CKB2:sch 1(A14);
K3 in ( T1 . (N2,K2) ) by A12,XBOOLE_0:def 4;
then A15: K4 in { K5 where K5 is (Element of GT1): B[ K5 ] } by A10;
thus B[ K4 ] from CKB2:sch 1(A15);
end;
thus (for N1 holds (for K1 holds (for K2 holds (K1 <> K2 implies ( ( T . (N1,K1) ) /\ ( T . (N1,K2) ) ) is  empty))))
proof
let N1;
let K1;
let K2;
assume A16: K1 <> K2;
assume (not ( ( T . (N1,K1) ) /\ ( T . (N1,K2) ) ) is  empty);
then consider K3 being set such that A17: K3 in ( ( T . (N1,K1) ) /\ ( T . (N1,K2) ) ) by XBOOLE_0:def 1;
(ex K4 being (Element of GT1) st ((K4 = K3 & g(N1,K4) = K1) & g(N1,K4) = K2)) by A11,A17;
hence contradiction by A16;
end;

thus (for K1 holds (for N1 holds (for N2 holds (N1 <> N2 implies ( ( T . (N1,K1) ) /\ ( T . (N2,K1) ) ) is  empty))))
proof
let K1;
let N1;
let N2;
assume A18: N1 <> N2;
assume (not ( ( T . (N1,K1) ) /\ ( T . (N2,K1) ) ) is  empty);
then consider K3 being set such that A19: K3 in ( ( T . (N1,K1) ) /\ ( T . (N2,K1) ) ) by XBOOLE_0:def 1;
consider K4 being (Element of GT1) such that K4 = K3 and A20: (g(N1,K4) = K1 & g(N2,K4) = K1) by A11,A19;
(ex f being Function st (((( h1 . K4 ) = f & f is  one-to-one) & ( dom f ) = N) & ( rng f ) = K4)) by A8;
hence contradiction by A18,A20,FUNCT_1:def 4;
end;

A21: (for N1 holds (for K1 being (Element of GT1) holds (( dom ( h . K1 ) ) = N & ( rng ( h . K1 ) ) = K1)))
proof
let N1;
let K1 being (Element of GT1);
(ex f being Function st (((( h1 . K1 ) = f & f is  one-to-one) & ( dom f ) = N) & ( rng f ) = K1)) by A8;
hence thesis;
end;
thus (for N1 holds ( card ( M \ ( union { ( T . (N1,K1) ): K1 in M } ) ) ) c= N)
proof
let N1;
( union { ( T . (N1,K1) ): K1 in M } ) = GT1
proof
(for S1 being set holds (S1 in { ( T . (N1,K1) ): K1 in M } implies S1 c= GT1))
proof
let S1 being set;
assume S1 in { ( T . (N1,K1) ): K1 in M };
then consider K1 such that A22: S1 = ( T . (N1,K1) ) and K1 in M;
( T1 . (N1,K1) ) c= GT1;
hence thesis by A22;
end;
hence ( union { ( T . (N1,K1) ): K1 in M } ) c= GT1 by ZFMISC_1:76;
let K2 being set;
assume that
A23: K2 in GT1;
reconsider K5 = K2 as (Element of GT1) by A23;
N1 in N;
then N1 in ( dom ( h . K5 ) ) by A21;
then ( ( h . K5 ) . N1 ) in ( rng ( h . K5 ) ) by FUNCT_1:def 3;
then A24: g(N1,K5) in K5 by A21;
K2 in ( nextcard N ) by A23;
then K2 in M by CKB65:def 1;
then A25: K2 c= M by ORDINAL1:def 2;
then A26: ( T . (N1,g(N1,K5)) ) in { ( T . (N1,K1) ): K1 in M } by A24;
K5 in { K3 where K3 is (Element of GT1): g(N1,K3) = g(N1,K5) };
then K5 in ( T . (N1,g(N1,K5)) ) by A10,A25,A24;
hence thesis by A26,TARSKI:def 4;
end;
then ( union { ( T . (N1,K1) ): K1 in M } ) = ( M \ N ) by CKB65:def 1;
then ( M \ ( union { ( T . (N1,K1) ): K1 in M } ) ) = ( M /\ N ) by XBOOLE_1:48;
hence thesis by CARD_1:7,XBOOLE_1:17;
end;

thus (for K1 holds ( card ( M \ ( union { ( T . (N1,K1) ): N1 in N } ) ) ) c= N)
proof
let K1;
A27: (N c= K1 implies ( card K1 ) = N)
proof
assume N c= K1;
then ( card N ) c= ( card K1 ) by CARD_1:11;
then A28: N c= ( card K1 ) by CARD_1:def 2;
( card K1 ) in M by CARD_1:9;
then ( card K1 ) in ( nextcard N ) by CKB65:def 1;
then ( card K1 ) c= N by CARD_3:91;
hence thesis by A28,XBOOLE_0:def 10;
end;
A29: ( card ( M \ { K5 where K5 is (Element of GT1): K1 in K5 } ) ) c= N
proof
per cases  by ORDINAL1:16;
suppose A30: N c= K1;

( M \ ( K1 \/ { K1 } ) ) c= { K5 where K5 is (Element of GT1): K1 in K5 }
proof
let K6 being set;
assume that
A31: K6 in ( M \ ( K1 \/ { K1 } ) );
reconsider K7 = K6 as (Element of M) by A31;
A32: (not K6 in ( K1 \/ { K1 } )) by A31,XBOOLE_0:def 5;
then (not K6 in { K1 }) by XBOOLE_0:def 3;
then A33: (not K6 = K1) by TARSKI:def 1;
K7 in M;
then A34: K7 in ( nextcard N ) by CKB65:def 1;
(not K6 in K1) by A32,XBOOLE_0:def 3;
then A35: K1 in K7 by A33,ORDINAL1:14;
then N in K7 by A30,ORDINAL1:12;
then reconsider K8 = K7 as (Element of GT1) by A34,XBOOLE_0:def 5;
K8 in { K5 where K5 is (Element of GT1): K1 in K5 } by A35;
hence thesis;
end;
then ( M \ { K5 where K5 is (Element of GT1): K1 in K5 } ) c= ( M \ ( M \ ( K1 \/ { K1 } ) ) ) by XBOOLE_1:34;
then A36: ( M \ { K5 where K5 is (Element of GT1): K1 in K5 } ) c= ( M /\ ( K1 \/ { K1 } ) ) by XBOOLE_1:48;
(not K1 is  finite) by A30;
then A37: ( card ( K1 \/ { K1 } ) ) = ( card K1 ) by CARD_2:78;
( M /\ ( K1 \/ { K1 } ) ) c= ( K1 \/ { K1 } ) by XBOOLE_1:17;
then ( M \ { K5 where K5 is (Element of GT1): K1 in K5 } ) c= ( K1 \/ { K1 } ) by A36,XBOOLE_1:1;
hence thesis by A27,A30,A37,CARD_1:11;
end;
suppose A38: K1 in N;

{ K5 where K5 is (Element of GT1): K1 in K5 } = GT1
proof
defpred P[ set ]
 means
K1 in $1;
{ K5 where K5 is (Element of GT1): P[ K5 ] } is (Subset of GT1) from DOMAIN_1:sch 7;
hence { K5 where K5 is (Element of GT1): K1 in K5 } c= GT1;
let K6 being set;
assume that
A39: K6 in GT1;
reconsider K7 = K6 as (Element of ( nextcard N )) by A39;
reconsider K8 = K7 as (Element of GT1) by A39;
(not K6 in N) by A39,XBOOLE_0:def 5;
then N c= K7 by ORDINAL1:16;
then K8 in { K5 where K5 is (Element of GT1): K1 in K5 } by A38;
hence thesis;
end;
then ( M \ { K5 where K5 is (Element of GT1): K1 in K5 } ) = ( M \ ( M \ N ) ) by CKB65:def 1
.= ( M /\ N ) by XBOOLE_1:48;
hence thesis by CARD_1:7,XBOOLE_1:17;
end;
end;
{ K5 where K5 is (Element of GT1): K1 in K5 } c= ( union { ( T . (N1,K1) ): N1 in N } )
proof
let K4 being set;
assume K4 in { K5 where K5 is (Element of GT1): K1 in K5 };
then consider K5 being (Element of GT1) such that A40: K4 = K5 and A41: K1 in K5;
( rng ( h . K5 ) ) = K5 by A21;
then consider N2 being set such that A42: N2 in ( dom ( h . K5 ) ) and A43: ( ( h . K5 ) . N2 ) = K1 by A41,FUNCT_1:def 3;
reconsider N3 = N2 as (Element of N) by A21,A42;
K5 in { K3 where K3 is (Element of GT1): g(N3,K3) = K1 } by A43;
then A44: K5 in ( T . (N3,K1) ) by A10;
( T . (N3,K1) ) in { ( T . (N1,K1) ): N1 in N };
hence thesis by A40,A44,TARSKI:def 4;
end;
then ( M \ ( union { ( T . (N1,K1) ): N1 in N } ) ) c= ( M \ { K5 where K5 is (Element of GT1): K1 in K5 } ) by XBOOLE_1:34;
then ( card ( M \ ( union { ( T . (N1,K1) ): N1 in N } ) ) ) c= ( card ( M \ { K5 where K5 is (Element of GT1): K1 in K5 } ) ) by CARD_1:11;
hence thesis by A29,XBOOLE_1:1;
end;

end;
