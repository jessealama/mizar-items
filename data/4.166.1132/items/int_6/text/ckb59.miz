environ
vocabularies NUMBERS,REAL_3,FINSEQ_1,RELAT_1,TARSKI,VALUED_0,ORDINAL1,RFINSEQ,XXREAL_0,ARYTM_1,SUBSET_1,FUNCT_1,ARYTM_3,INT_1,ORDINAL4,XBOOLE_0,NAT_1,VALUED_1,CARD_3,BINOP_2,SETWISEO,BINOP_1,SETWOP_2,CARD_1,FINSOP_1,PARTFUN1,COMPLEX1,INT_2,PARTFUN3,XREAL_0,INT_6;
notations TARSKI,XBOOLE_0,SUBSET_1,INT_1,INT_2,ORDINAL1,NUMBERS,PARTFUN1,PARTFUN3,REAL_3,XXREAL_0,XREAL_0,FUNCT_1,VALUED_0,VALUED_1,BINOP_2,SETWISEO,RFINSEQ,BINOP_1,FINSEQ_1,SETWOP_2,RVSUM_1,XCMPLX_0,NAT_1,FINSOP_1,CKB36,CKB37,CKB42,CKB44,CKB52,CKB54;
definitions INT_2,XCMPLX_0,FINSEQ_1,FUNCT_1,CKB37,CKB42,CKB52,CKB54;
theorems INT_1,FUNCT_1,FINSEQ_1,RVSUM_1,NAT_1,SETWOP_2,FINSEQ_3,BINOP_2,SETWISEO,TARSKI,NAT_D,INT_2,XCMPLX_0,XCMPLX_1,XREAL_1,RFINSEQ,FINSEQ_5,FINSEQ_2,ABSVALUE,PARTFUN3,XBOOLE_0,XXREAL_0,ORDINAL1,XBOOLE_1,PARTFUN1,XREAL_0,WSIERP_1,VALUED_0,VALUED_1,COMPLEX1,CKB1,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB37,CKB41,CKB42,CKB47,CKB48,CKB50,CKB51,CKB52,CKB54,CKB56,CKB57,CKB58;
schemes FINSEQ_1,NAT_1,INT_1;
registrations NUMBERS,XREAL_0,NAT_1,INT_1,RELAT_1,FINSEQ_1,RVSUM_1,XBOOLE_0,MEMBERED,BINOP_2,ORDINAL1,XXREAL_0,VALUED_0,VALUED_1,FUNCT_1,CARD_1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB14,CKB15,CKB38,CKB39,CKB40,CKB43,CKB45,CKB46,CKB49,CKB53,CKB55;
constructors FINSOP_1,RFINSEQ,INT_2,BINOP_2,REAL_1,SETWISEO,SETWOP_2,PARTFUN3,XXREAL_0,RVSUM_1,BINOP_1,RELSET_1,CKB42,CKB52,CKB54;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
theorem
Th29: (for u being  integer-valued FinSequence holds (for m being CR_Sequence holds (( len m ) = ( len u ) implies (for c being (CR_coefficients of m) holds (for i being  natural number holds (i in ( dom m ) implies ( Sum ( u (#) c ) ),( u . i ) are_congruent_mod ( m . i )))))))
proof
let u being  integer-yielding FinSequence;
let m being CR_Sequence;
assume A1: ( len m ) = ( len u );
let c being (CR_coefficients of m);
let i being  natural number;
defpred P[ Nat ]
 means
(for v,cc being  integer-yielding FinSequence holds ((v = ( u | $1 ) & cc = ( c | $1 )) implies (($1 < i & ( Sum ( v (#) cc ) ),( 0 ) are_congruent_mod ( m . i )) or ($1 >= i & ( Sum ( v (#) cc ) ),( u . i ) are_congruent_mod ( m . i )))));
assume A2: i in ( dom m );
A3: ( len m ) = ( len c ) by CKB54:def 1;
then A4: ( dom m ) = ( Seg ( len c ) ) by FINSEQ_1:def 3
.= ( dom c ) by FINSEQ_1:def 3;
A5:now
let k being (Element of ( NAT ));
assume that
( 0 ) <= k
and
A6: k < ( len u )
and
A7: P[ k ];
now
set v9 = ( u | k );
set cc9 = ( c | k );
let v being  integer-yielding FinSequence;
let cc being  integer-yielding FinSequence;
A8: ( ( 0 ) + 1 ) <= ( k + 1 ) by XREAL_1:6;
reconsider a = ( v (#) cc ),b = ( v9 (#) cc9 ) as (FinSequence of ( REAL )) by CKB16:1;
assume that
A9: v = ( u | ( k + 1 ) )
and
A10: cc = ( c | ( k + 1 ) );
( k + 1 ) <= ( len u ) by A6,NAT_1:13;
then ( len v ) = ( k + 1 ) by A9,FINSEQ_1:59;
then ( k + 1 ) in ( Seg ( len v ) ) by A8;
then ( k + 1 ) in ( dom v ) by FINSEQ_1:def 3;
then A11: ( v . ( k + 1 ) ) = ( u . ( k + 1 ) ) by A9,FUNCT_1:47;
A12: ( k + 1 ) <= ( len c ) by A1,A3,A6,NAT_1:13;
then ( k + 1 ) in ( Seg ( len c ) ) by A8;
then A13: ( k + 1 ) in ( dom c ) by FINSEQ_1:def 3;
reconsider r = ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) as (Element of ( REAL )) by XREAL_0:def 1;
reconsider s = <* r *> as (FinSequence of ( REAL ));
A14: ( len u ) = ( len c ) by A1,CKB54:def 1;
( len cc ) = ( k + 1 ) by A10,A12,FINSEQ_1:59;
then ( k + 1 ) in ( Seg ( len cc ) ) by A8;
then ( k + 1 ) in ( dom cc ) by FINSEQ_1:def 3;
then A15: ( cc . ( k + 1 ) ) = ( c . ( k + 1 ) ) by A10,FUNCT_1:47;
A16: ( k + 1 ) <= ( len u ) by A6,NAT_1:13;
A17: ( ( ( u (#) c ) | k ) ^ <* ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) *> ) = ( ( u (#) c ) | ( k + 1 ) )
proof
set p = ( ( ( u (#) c ) | k ) ^ <* ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) *> );
set q = ( ( u (#) c ) | ( k + 1 ) );
A18: ( k + 1 ) <= ( len ( u (#) c ) ) by A1,A3,A16,CKB12:1;
then A19: k <= ( len ( u (#) c ) ) by NAT_1:13;
A20: ( len p ) = ( ( len ( ( u (#) c ) | k ) ) + 1 ) by FINSEQ_2:16
.= ( k + 1 ) by A19,FINSEQ_1:59;
A21: ( k + 1 ) = ( len q ) by A18,FINSEQ_1:59;
now
let j being Nat;
assume that
A22: 1 <= j
and
A23: j <= ( len p );
A24: j in ( NAT ) by ORDINAL1:def 12;
per cases ;
suppose A25: j in ( dom ( ( u (#) c ) | k ) );

j in ( Seg ( k + 1 ) ) by A20,A22,A23,A24;
then A26: j in ( dom q ) by A21,FINSEQ_1:def 3;
thus ( p . j ) = ( ( ( u (#) c ) | k ) . j ) by A25,FINSEQ_1:def 7
.= ( ( u (#) c ) . j ) by A25,FUNCT_1:47
.= ( q . j ) by A26,FUNCT_1:47;
end;
suppose A27: (not j in ( dom ( ( u (#) c ) | k ) ));

k <= ( len ( u (#) c ) ) by A6,A14,CKB12:1;
then A28: ( len ( ( u (#) c ) | k ) ) = k by FINSEQ_1:59;
then ( dom ( ( u (#) c ) | k ) ) = ( Seg k ) by FINSEQ_1:def 3;
then j > k by A22,A24,A27;
then A29: j >= ( k + 1 ) by NAT_1:13;
then A30: j = ( k + 1 ) by A20,A23,XXREAL_0:1;
( dom <* ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) *> ) = { 1 } by FINSEQ_1:2,FINSEQ_1:38;
then 1 in ( dom <* ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) *> ) by TARSKI:def 1;
then A31: ( p . ( k + 1 ) ) = ( <* ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) *> . 1 ) by A28,FINSEQ_1:def 7
.= ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) by FINSEQ_1:40;
( k + 1 ) <= ( len ( u (#) c ) ) by A12,A14,CKB12:1;
then j in ( Seg ( len ( u (#) c ) ) ) by A8,A30;
then A32: j in ( dom ( u (#) c ) ) by FINSEQ_1:def 3;
j in ( Seg ( k + 1 ) ) by A20,A22,A23,A24;
then j in ( dom q ) by A21,FINSEQ_1:def 3;
then ( q . j ) = ( ( u (#) c ) . j ) by FUNCT_1:47
.= ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) by A15,A11,A30,A32,VALUED_1:def 4;
hence ( p . j ) = ( q . j ) by A20,A23,A29,A31,XXREAL_0:1;
end;
end;
hence thesis by A20,A21,FINSEQ_1:14;
end;
( v9 (#) cc9 ) = ( ( u (#) c ) | k ) by A6,A14,CKB13:1;
then a = ( b ^ s ) by A9,A10,A16,A14,A17,CKB13:1;
then A33: ( Sum ( v (#) cc ) ) = ( ( Sum b ) + ( Sum s ) ) by RVSUM_1:75
.= ( ( Sum ( v9 (#) cc9 ) ) + ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ) ) by RVSUM_1:73;
A34: k < ( k + 1 ) by NAT_1:13;
now
per cases  by XXREAL_0:1;
case A35: ( k + 1 ) < i;
then k < i by NAT_1:13;
then A36: ( Sum ( v9 (#) cc9 ) ),( 0 ) are_congruent_mod ( m . i ) by A7;
A37: ( v . ( k + 1 ) ),( v . ( k + 1 ) ) are_congruent_mod ( m . i ) by INT_1:11;
( cc . ( k + 1 ) ),( 0 ) are_congruent_mod ( m . i ) by A2,A4,A13,A15,A35,CKB57:1;
then ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ),( ( v . ( k + 1 ) ) * ( 0 ) ) are_congruent_mod ( m . i ) by A37,INT_1:18;
then ( Sum ( v (#) cc ) ),( ( 0 ) + ( ( v . ( k + 1 ) ) * ( 0 ) ) ) are_congruent_mod ( m . i ) by A33,A36,INT_1:16;
hence ( Sum ( v (#) cc ) ),( 0 ) are_congruent_mod ( m . i );
end;
case A38: ( k + 1 ) = i;
A39: ( v . ( k + 1 ) ),( v . ( k + 1 ) ) are_congruent_mod ( m . i ) by INT_1:11;
( cc . ( k + 1 ) ),1 are_congruent_mod ( m . i ) by A13,A15,A38,CKB56:1;
then A40: ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ),( ( u . ( k + 1 ) ) * 1 ) are_congruent_mod ( m . i ) by A11,A39,INT_1:18;
( Sum ( v9 (#) cc9 ) ),( 0 ) are_congruent_mod ( m . i ) by A7,A34,A38;
hence ( Sum ( v (#) cc ) ),( ( 0 ) + ( u . i ) ) are_congruent_mod ( m . i ) by A33,A38,A40,INT_1:16;
end;
case A41: ( k + 1 ) > i;
then k >= i by NAT_1:13;
then A42: ( Sum ( v9 (#) cc9 ) ),( u . i ) are_congruent_mod ( m . i ) by A7;
A43: ( v . ( k + 1 ) ),( v . ( k + 1 ) ) are_congruent_mod ( m . i ) by INT_1:11;
( cc . ( k + 1 ) ),( 0 ) are_congruent_mod ( m . i ) by A2,A4,A13,A15,A41,CKB57:1;
then ( ( v . ( k + 1 ) ) * ( cc . ( k + 1 ) ) ),( ( u . ( k + 1 ) ) * ( 0 ) ) are_congruent_mod ( m . i ) by A11,A43,INT_1:18;
hence ( Sum ( v (#) cc ) ),( ( u . i ) + ( 0 ) ) are_congruent_mod ( m . i ) by A33,A42,INT_1:16;
end;
end;
hence ((( k + 1 ) < i & ( Sum ( v (#) cc ) ),( 0 ) are_congruent_mod ( m . i )) or (( k + 1 ) >= i & ( Sum ( v (#) cc ) ),( u . i ) are_congruent_mod ( m . i )));
end;
hence P[ ( k + 1 ) ];
end;
A44: ( dom m ) = ( Seg ( len u ) ) by A1,FINSEQ_1:def 3;
now
let v being  integer-yielding FinSequence;
let cc being  integer-yielding FinSequence;
assume that
A45: v = ( u | ( 0 ) )
and
A46: cc = ( c | ( 0 ) );
( ( dom v ) /\ ( dom cc ) ) = ( {} ) by A45,A46;
then ( dom ( v (#) cc ) ) = ( {} ) by VALUED_1:def 4;
then ( v (#) cc ) = ( {} );
hence ((( 0 ) < i & ( Sum ( v (#) cc ) ),( 0 ) are_congruent_mod ( m . i )) or (( 0 ) >= i & ( Sum ( v (#) cc ) ),( u . i ) are_congruent_mod ( m . i ))) by A2,A44,FINSEQ_1:1,INT_1:11,RVSUM_1:72;
end;
then A47: P[ ( 0 ) ];
A48: (for k being (Element of ( NAT )) holds ((( 0 ) <= k & k <= ( len u )) implies P[ k ])) from INT_1:sch 7(A47,A5);
( len u ) = ( len c ) by A1,CKB54:def 1;
then A49: ( c | ( len u ) ) = c by FINSEQ_1:58;
A50: u = ( u | ( len u ) ) by FINSEQ_1:58;
i <= ( len u ) by A2,A44,FINSEQ_1:1;
hence thesis by A48,A50,A49;
end;
