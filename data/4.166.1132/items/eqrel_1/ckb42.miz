environ
vocabularies NUMBERS,SUBSET_1,RELAT_1,ZFMISC_1,SETFAM_1,TARSKI,PARTFUN1,RELAT_2,XBOOLE_0,FINSEQ_1,XXREAL_0,FUNCT_1,ARYTM_3,ORDINAL4,ARYTM_1,NAT_1,CARD_1,EQREL_1,MCART_1,CARD_3;
notations TARSKI,XBOOLE_0,ZFMISC_1,MCART_1,DOMAIN_1,SUBSET_1,XCMPLX_0,XXREAL_0,RELAT_1,RELAT_2,SETFAM_1,FINSEQ_1,FUNCT_1,NUMBERS,NAT_1,FUNCT_3,RELSET_1,PARTFUN1,FUNCT_2,BINOP_1,CKB1,CKB3,CKB4,CKB7,CKB8,CKB18,CKB22,CKB29,CKB30;
definitions TARSKI,RELAT_1,RELAT_2,XBOOLE_0,PARTFUN1,SETFAM_1,SUBSET_1,BINOP_1,CKB1,CKB22;
theorems RELAT_1,RELAT_2,RELSET_1,SETFAM_1,ZFMISC_1,TARSKI,FINSEQ_1,NAT_1,XBOOLE_0,XBOOLE_1,ORDERS_1,PARTFUN1,XREAL_1,XXREAL_0,FUNCT_1,FUNCT_3,FUNCT_2,MCART_1,SUBSET_1,SETWISEO,CKB1,CKB5,CKB6,CKB9,CKB10,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41;
schemes SUBSET_1,RELSET_1,FINSEQ_1,NAT_1,FUNCT_2,CKB28;
registrations XBOOLE_0,SUBSET_1,PARTFUN1,XXREAL_0,XREAL_0,FINSEQ_1,RELAT_1,ORDINAL1,RELSET_1,FUNCT_2,FUNCT_3,ZFMISC_1,FUNCT_1,CKB2,CKB11;
constructors SETFAM_1,RELAT_2,PARTFUN1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,RELSET_1,FUNCT_3,BINOP_1,DOMAIN_1,CKB1,CKB3,CKB4,CKB18,CKB22,CKB30;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve X for set;
reserve x for set;
reserve y for set;
reserve z for set;
reserve i for (Element of ( NAT ));
reserve j for (Element of ( NAT ));
reserve EqR1 for (Equivalence_Relation of X);
reserve EqR2 for (Equivalence_Relation of X);
theorem
(x in X implies ([ x,y ] in ( EqR1 "\/" EqR2 ) iff (ex f being FinSequence st (((1 <= ( len f ) & x = ( f . 1 )) & y = ( f . ( len f ) )) & (for i holds ((1 <= i & i < ( len f )) implies [ ( f . i ),( f . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 )))))))
proof
assume A1: x in X;
thus ([ x,y ] in ( EqR1 "\/" EqR2 ) implies (ex f being FinSequence st (((1 <= ( len f ) & x = ( f . 1 )) & y = ( f . ( len f ) )) & (for i holds ((1 <= i & i < ( len f )) implies [ ( f . i ),( f . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 ))))))
proof
defpred P[ set,set ]
 means
(ex f being FinSequence st (((1 <= ( len f ) & $1 = ( f . 1 )) & $2 = ( f . ( len f ) )) & (for i holds ((1 <= i & i < ( len f )) implies [ ( f . i ),( f . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 )))));
consider Y being (Relation of X,X) such that A2: (for x holds (for y holds ([ x,y ] in Y iff ((x in X & y in X) & P[ x,y ])))) from RELSET_1:sch 1;
A3: Y is_transitive_in X
proof
let x;
let y;
let z;
assume that
A4: x in X
and
A5: y in X
and
A6: z in X
and
A7: [ x,y ] in Y
and
A8: [ y,z ] in Y;
consider g being FinSequence such that A9: 1 <= ( len g ) and A10: y = ( g . 1 ) and A11: z = ( g . ( len g ) ) and A12: (for i holds ((1 <= i & i < ( len g )) implies [ ( g . i ),( g . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 ))) by A2,A8;
consider f being FinSequence such that A13: 1 <= ( len f ) and A14: x = ( f . 1 ) and A15: y = ( f . ( len f ) ) and A16: (for i holds ((1 <= i & i < ( len f )) implies [ ( f . i ),( f . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 ))) by A2,A7;
set h = ( f ^ g );
A17: ( len h ) = ( ( len f ) + ( len g ) ) by FINSEQ_1:22;
A18: ( ( len f ) + 1 ) <= ( ( len f ) + ( len g ) ) by A9,XREAL_1:7;
then A19: ( h . ( len h ) ) = ( g . ( ( ( len g ) + ( len f ) ) - ( len f ) ) ) by A17,FINSEQ_1:23
.= ( g . ( len g ) );
A20: (for i holds ((1 <= i & i < ( len h )) implies [ ( h . i ),( h . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 )))
proof
let i;
assume that
A21: 1 <= i
and
A22: i < ( len h );
A23: (((1 <= i & i < ( len f )) or i = ( len f )) or ( len f ) < i) by A21,XXREAL_0:1;
now
per cases  by A22,A23,NAT_1:13;
suppose A24: (1 <= i & i < ( len f ));

then (1 <= ( i + 1 ) & ( i + 1 ) <= ( len f )) by NAT_1:13;
then ( i + 1 ) in ( Seg ( len f ) ) by FINSEQ_1:1;
then ( i + 1 ) in ( dom f ) by FINSEQ_1:def 3;
then A25: ( h . ( i + 1 ) ) = ( f . ( i + 1 ) ) by FINSEQ_1:def 7;
i in ( Seg ( len f ) ) by A24,FINSEQ_1:1;
then i in ( dom f ) by FINSEQ_1:def 3;
then ( h . i ) = ( f . i ) by FINSEQ_1:def 7;
hence thesis by A16,A24,A25;
end;
suppose A26: i = ( len f );

( len f ) in ( Seg ( len f ) ) by A13,FINSEQ_1:1;
then ( len f ) in ( dom f ) by FINSEQ_1:def 3;
then A27: ( h . i ) = y by A15,A26,FINSEQ_1:def 7;
A28: [ y,y ] in EqR1 by A5,CKB13:1;
( h . ( i + 1 ) ) = ( g . ( ( 1 + ( len f ) ) - ( len f ) ) ) by A18,A26,FINSEQ_1:23
.= y by A10;
hence thesis by A27,A28,XBOOLE_0:def 3;
end;
suppose A29: (( ( len f ) + 1 ) <= i & i < ( len h ));

then ( len f ) < i by NAT_1:13;
then reconsider k = ( i - ( len f ) ) as (Element of ( NAT )) by NAT_1:21;
i < ( ( len f ) + ( len g ) ) by A29,FINSEQ_1:22;
then A30: ( i - ( len f ) ) < ( len g ) by XREAL_1:19;
(( ( len f ) + 1 ) <= ( i + 1 ) & ( i + 1 ) <= ( ( len f ) + ( len g ) )) by A17,A29,NAT_1:13;
then A31: ( h . ( i + 1 ) ) = ( g . ( ( 1 + i ) - ( len f ) ) ) by FINSEQ_1:23
.= ( g . ( ( i - ( len f ) ) + 1 ) );
( ( 1 + ( len f ) ) - ( len f ) ) <= ( i - ( len f ) ) by A29,XREAL_1:9;
then [ ( g . k ),( g . ( k + 1 ) ) ] in ( EqR1 \/ EqR2 ) by A12,A30;
hence thesis by A17,A29,A31,FINSEQ_1:23;
end;
end;
hence thesis;
end;
1 in ( Seg ( len f ) ) by A13,FINSEQ_1:1;
then 1 in ( dom f ) by FINSEQ_1:def 3;
then A32: x = ( h . 1 ) by A14,FINSEQ_1:def 7;
1 <= ( len h ) by A13,A17,NAT_1:12;
hence thesis by A2,A4,A6,A11,A32,A19,A20;
end;
A33: Y is_symmetric_in X
proof
let x;
let y;
assume that
A34: (x in X & y in X)
and
A35: [ x,y ] in Y;
consider f being FinSequence such that A36: 1 <= ( len f ) and A37: x = ( f . 1 ) and A38: y = ( f . ( len f ) ) and A39: (for i holds ((1 <= i & i < ( len f )) implies [ ( f . i ),( f . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 ))) by A2,A35;
defpred P[ Nat,set ]
 means
$2 = ( f . ( ( 1 + ( len f ) ) - $1 ) );
A40: (for k being Nat holds (k in ( Seg ( len f ) ) implies (ex z st P[ k,z ])));
consider g being FinSequence such that A41: (( dom g ) = ( Seg ( len f ) ) & (for k being Nat holds (k in ( Seg ( len f ) ) implies P[ k,( g . k ) ]))) from FINSEQ_1:sch 1(A40);
A42: ( len f ) = ( len g ) by A41,FINSEQ_1:def 3;
A43: (for j holds ((1 <= j & j < ( len g )) implies [ ( g . j ),( g . ( j + 1 ) ) ] in ( EqR1 \/ EqR2 )))
proof
let j;
assume that
A44: 1 <= j
and
A45: j < ( len g );
reconsider k = ( ( len f ) - j ) as (Element of ( NAT )) by A42,A45,NAT_1:21;
( j - ( len f ) ) < ( ( len f ) - ( len f ) ) by A42,A45,XREAL_1:9;
then ( - ( ( len f ) - j ) ) < ( - ( 0 ) );
then ( 0 ) < k;
then A46: ( ( 0 ) + 1 ) <= k by NAT_1:13;
( - j ) < ( - ( 0 ) ) by A44,XREAL_1:24;
then ( ( len f ) + ( - j ) ) < ( ( 0 ) + ( len f ) ) by XREAL_1:6;
then A47: [ ( f . k ),( f . ( k + 1 ) ) ] in ( EqR1 \/ EqR2 ) by A39,A46;
A48:now
per cases  by A47,XBOOLE_0:def 3;
suppose [ ( f . k ),( f . ( k + 1 ) ) ] in EqR1;

then [ ( f . ( k + 1 ) ),( f . k ) ] in EqR1 by CKB14:1;
hence [ ( f . ( k + 1 ) ),( f . k ) ] in ( EqR1 \/ EqR2 ) by XBOOLE_0:def 3;
end;
suppose [ ( f . k ),( f . ( k + 1 ) ) ] in EqR2;

then [ ( f . ( k + 1 ) ),( f . k ) ] in EqR2 by CKB14:1;
hence [ ( f . ( k + 1 ) ),( f . k ) ] in ( EqR1 \/ EqR2 ) by XBOOLE_0:def 3;
end;
end;
(1 <= ( j + 1 ) & ( j + 1 ) <= ( len f )) by A42,A45,NAT_1:12,NAT_1:13;
then ( j + 1 ) in ( Seg ( len f ) ) by FINSEQ_1:1;
then A49: ( g . ( j + 1 ) ) = ( f . ( ( ( len f ) + 1 ) - ( 1 + j ) ) ) by A41
.= ( f . ( ( len f ) - j ) );
j in ( Seg ( len f ) ) by A42,A44,A45,FINSEQ_1:1;
then ( g . j ) = ( f . ( ( 1 + ( len f ) ) - j ) ) by A41
.= ( f . ( ( ( len f ) - j ) + 1 ) );
hence thesis by A49,A48;
end;
( len f ) in ( Seg ( len f ) ) by A36,FINSEQ_1:1;
then ( g . ( len f ) ) = ( f . ( ( 1 + ( len f ) ) - ( len f ) ) ) by A41
.= ( f . ( 1 + ( 0 ) ) );
then A50: x = ( g . ( len g ) ) by A37,A41,FINSEQ_1:def 3;
1 in ( Seg ( len f ) ) by A36,FINSEQ_1:1;
then A51: ( g . 1 ) = ( f . ( ( ( len f ) + 1 ) - 1 ) ) by A41
.= ( f . ( len f ) );
1 <= ( len g ) by A36,A41,FINSEQ_1:def 3;
hence thesis by A2,A34,A38,A51,A50,A43;
end;
Y is_reflexive_in X
proof
let x;
assume that
A52: x in X;
set g = <* x *>;
A53: (for i holds ((1 <= i & i < ( len g )) implies [ ( g . i ),( g . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 ))) by FINSEQ_1:40;
(( len g ) = 1 & ( g . 1 ) = x) by FINSEQ_1:40;
hence thesis by A2,A52,A53;
end;
then (( field Y ) = X & ( dom Y ) = X) by ORDERS_1:13;
then reconsider R1 = Y as (Equivalence_Relation of X) by A33,A3,PARTFUN1:def 2,RELAT_2:def 11,RELAT_2:def 16;
(for x holds (for y holds ([ x,y ] in ( EqR1 \/ EqR2 ) implies [ x,y ] in R1)))
proof
let x;
let y;
assume A54: [ x,y ] in ( EqR1 \/ EqR2 );
set g = <* x,y *>;
A55: ( len g ) = ( 1 + 1 ) by FINSEQ_1:44;
A56: ( g . 1 ) = x by FINSEQ_1:44;
A57: (for i holds ((1 <= i & i < ( len g )) implies [ ( g . i ),( g . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 )))
proof
let i;
assume that
A58: 1 <= i
and
A59: i < ( len g );
i <= 1 by A55,A59,NAT_1:13;
then 1 = i by A58,XXREAL_0:1;
hence thesis by A54,A56,FINSEQ_1:44;
end;
( len g ) = 2 by FINSEQ_1:44;
then A60: (( g . 1 ) = x & ( g . ( len g ) ) = y) by FINSEQ_1:44;
(x in X & y in X) by A54,CKB12:1;
hence thesis by A2,A55,A60,A57;
end;
then ( EqR1 \/ EqR2 ) c= R1 by RELAT_1:def 3;
then A61: ( EqR1 "\/" EqR2 ) c= R1 by CKB22:def 1;
assume [ x,y ] in ( EqR1 "\/" EqR2 );
then consider f being FinSequence such that A62: ((1 <= ( len f ) & x = ( f . 1 )) & (y = ( f . ( len f ) ) & (for i holds ((1 <= i & i < ( len f )) implies [ ( f . i ),( f . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 ))))) by A2,A61;
take f;
thus thesis by A62;
end;

given f being FinSequence such that
A63: 1 <= ( len f )
and
A64: x = ( f . 1 )
and
A65: y = ( f . ( len f ) )
and
A66: (for i holds ((1 <= i & i < ( len f )) implies [ ( f . i ),( f . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 )));

defpred P[ (Element of ( NAT )) ]
 means
((1 <= $1 & $1 <= ( len f )) implies [ ( f . 1 ),( f . $1 ) ] in ( EqR1 "\/" EqR2 ));
A67:now
let i;
assume A68: P[ i ];
thus P[ ( i + 1 ) ]
proof
assume that
A69: 1 <= ( i + 1 )
and
A70: ( i + 1 ) <= ( len f );
A71: (1 <= i or 1 = ( i + 1 )) by A69,NAT_1:8;
A72: ( EqR1 \/ EqR2 ) c= ( EqR1 "\/" EqR2 ) by CKB22:def 1;
A73: i < ( len f ) by A70,NAT_1:13;
now
per cases  by A71;
suppose A74: 1 <= i;

then [ ( f . i ),( f . ( i + 1 ) ) ] in ( EqR1 \/ EqR2 ) by A66,A73;
hence thesis by A68,A70,A72,A74,CKB15:1,NAT_1:13;
end;
suppose A75: ( 0 ) = i;

[ ( f . 1 ),( f . 1 ) ] in EqR1 by A1,A64,CKB13:1;
then [ ( f . 1 ),( f . 1 ) ] in ( EqR1 \/ EqR2 ) by XBOOLE_0:def 3;
hence thesis by A72,A75;
end;
end;
hence thesis;
end;

end;
A76: P[ ( 0 ) ];
(for i holds P[ i ]) from NAT_1:sch 1(A76,A67);
hence thesis by A63,A64,A65;
end;
