environ
vocabularies NUMBERS,XBOOLE_0,FINSEQ_1,ARYTM_1,GROUP_1,STRUCT_0,GROUP_2,SETFAM_1,SUBSET_1,RELAT_1,INT_1,TARSKI,GROUP_3,QC_LANG1,NEWTON,ARYTM_3,CARD_1,XXREAL_0,COMPLEX1,ALGSTR_0,CARD_3,FINSOP_1,BINOP_1,ORDINAL4,SETWISEO,FINSEQ_2,NAT_1,FUNCT_1,PARTFUN1,FUNCT_2,ZFMISC_1,RLSUB_1,BVFUNC_2,EQREL_1,PRE_TOPC,RLSUB_2,LATTICES,GROUP_4;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,XCMPLX_0,FINSOP_1,NUMBERS,INT_1,SETWISEO,SETFAM_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,FINSEQ_3,FINSEQ_4,BINOP_1,STRUCT_0,ALGSTR_0,GROUP_2,GROUP_3,LATTICES,GROUP_1,DOMAIN_1,XXREAL_0,NAT_1,INT_2,CKB1,CKB4,CKB9,CKB25,CKB35,CKB44,CKB46,CKB48;
definitions TARSKI,XBOOLE_0,GROUP_2,SUBSET_1,ALGSTR_0,CKB4,CKB9,CKB25,CKB35,CKB44,CKB46,CKB48;
theorems BINOP_1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FINSOP_1,FUNCT_1,GROUP_1,GROUP_2,GROUP_3,INT_1,LATTICES,NAT_1,RLSUB_2,SETFAM_1,SUBSET_1,TARSKI,ZFMISC_1,RELAT_1,XBOOLE_0,XBOOLE_1,ORDERS_1,XREAL_1,XXREAL_0,NAT_D,STRUCT_0,PARTFUN1,ABSVALUE,CARD_1,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51;
schemes BINOP_1,DOMAIN_1,FINSEQ_1,FINSEQ_2,NAT_1,ORDERS_1,XBOOLE_0,CKB2,CKB3;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,NUMBERS,XREAL_0,INT_1,FINSEQ_1,STRUCT_0,LATTICES,GROUP_1,GROUP_2,GROUP_3,ORDINAL1,CARD_1,FINSEQ_2;
constructors PARTFUN1,SETFAM_1,BINOP_1,SETWISEO,XXREAL_0,NAT_1,NAT_D,FINSEQ_3,FINSEQ_4,FINSOP_1,REALSET1,REAL_1,LATTICES,GROUP_3,RELSET_1,FINSEQ_2,BINOP_2,CKB1,CKB4,CKB9,CKB25,CKB35,CKB44,CKB46,CKB48;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve X for set;
reserve Y for set;
reserve G for Group;
reserve a for (Element of G);
reserve b for (Element of G);
reserve B for (Subset of G);
reserve H for (Subgroup of G);
reserve H1 for (Subgroup of G);
reserve H2 for (Subgroup of G);
reserve H3 for (Subgroup of G);
reserve F for (FinSequence of (the carrier of G));
reserve I for (FinSequence of ( INT ));
theorem
Th55: (for G being  strict Group holds (the carrier of ( Phi G )) = { a where a is (Element of G): a is non  generating })
proof
let G being  strict Group;
set A = { a where a is (Element of G): a is non  generating };
thus (the carrier of ( Phi G )) c= A
proof
defpred P[ set,set ]
 means
(ex H1,H2 being  strict (Subgroup of G) st (($1 = H1 & $2 = H2) & H1 is (Subgroup of H2)));
let x;
assume A1: x in (the carrier of ( Phi G ));
then x in ( Phi G ) by STRUCT_0:def 5;
then x in G by GROUP_2:40;
then reconsider a = x as (Element of G) by STRUCT_0:def 5;
assume (not x in A);
then a is  generating;
then consider B being (Subset of G) such that A2: ( gr B ) = G and A3: ( gr ( B \ { a } ) ) <> G by CKB44:def 1;
set M = ( B \ { a } );
A4:now
assume A5: a in ( gr M );
now
let b being (Element of G);
b in ( gr B ) by A2,STRUCT_0:def 5;
then consider F being (FinSequence of (the carrier of G)),I such that ( len I ) = ( len F ) and A6: ( rng F ) c= B and A7: b = ( Product ( F |^ I ) ) by CKB36:1;
( rng ( F |^ I ) ) c= ( carr ( gr M ) )
proof
let x;
assume x in ( rng ( F |^ I ) );
then consider y such that A8: y in ( dom ( F |^ I ) ) and A9: ( ( F |^ I ) . y ) = x by FUNCT_1:def 3;
reconsider y as (Element of ( NAT )) by A8;
( len ( F |^ I ) ) = ( len F ) by CKB25:def 1;
then A10: y in ( dom F ) by A8,FINSEQ_3:29;
then A11: x = ( ( F /. y ) |^ ( @ ( I /. y ) ) ) by A9,CKB25:def 1;
now
per cases ;
suppose ( F /. y ) = a;

then x in ( gr M ) by A5,A11,CKB8:1;
hence thesis by STRUCT_0:def 5;
end;
suppose ( F /. y ) <> a;

then A12: (not ( F /. y ) in { a }) by TARSKI:def 1;
(( F /. y ) = ( F . y ) & ( F . y ) in ( rng F )) by A10,FUNCT_1:def 3,PARTFUN1:def 6;
then ( F /. y ) in M by A6,A12,XBOOLE_0:def 5;
then x in ( gr M ) by A11,CKB8:1,CKB37:1;
hence thesis by STRUCT_0:def 5;
end;
end;
hence thesis;
end;
hence b in ( gr M ) by A7,CKB24:1;
end;
hence contradiction by A3,GROUP_2:62;
end;
defpred P[ (Subgroup of G) ]
 means
(M c= ( carr $1 ) & (not a in $1));
consider X such that A13: X c= ( Subgroups G ) and A14: (for H being  strict (Subgroup of G) holds (H in X iff P[ H ])) from CKB3:sch 1;
M c= ( carr ( gr M ) ) by CKB35:def 1;
then reconsider X as non  empty set by A14,A4;
A15: (for x,y,z being (Element of X) holds ((P[ x,y ] & P[ y,z ]) implies P[ x,z ]))
proof
let x being (Element of X);
let y being (Element of X);
let z being (Element of X);
given H1 being  strict (Subgroup of G),H2 being  strict (Subgroup of G) such that
A16: x = H1
and
A17: (y = H2 & H1 is (Subgroup of H2));

given H3 being  strict (Subgroup of G),H4 being  strict (Subgroup of G) such that
A18: y = H3
and
A19: z = H4
and
A20: H3 is (Subgroup of H4);

H1 is (Subgroup of H4) by A17,A18,A20,GROUP_2:56;
hence thesis by A16,A19;
end;
A21: (for Y holds ((Y c= X & (for x,y being (Element of X) holds ((x in Y & y in Y) implies (P[ x,y ] or P[ y,x ])))) implies (ex y being (Element of X) st (for x being (Element of X) holds (x in Y implies P[ x,y ])))))
proof
let Y;
assume A22: Y c= X;
set C = { D where D is (Subset of G): (ex H being  strict (Subgroup of G) st (H in Y & D = ( carr H ))) };
now
let Z being set;
assume Z in C;
then (ex D being (Subset of G) st (Z = D & (ex H being  strict (Subgroup of G) st (H in Y & D = ( carr H )))));
hence Z c= (the carrier of G);
end;
then reconsider E = ( union C ) as (Subset of G) by ZFMISC_1:76;
assume A23: (for x,y being (Element of X) holds ((x in Y & y in Y) implies (P[ x,y ] or P[ y,x ])));
now
per cases ;
suppose A24: Y = ( {} );

set y = the (Element of X);
take y;
let x being (Element of X);
assume x in Y;
hence P[ x,y ] by A24;
end;
suppose A25: Y <> ( {} );

A26:now
let a being (Element of G);
let b being (Element of G);
assume that
A27: a in E
and
A28: b in E;
consider Z being set such that A29: a in Z and A30: Z in C by A27,TARSKI:def 4;
consider Z1 being set such that A31: b in Z1 and A32: Z1 in C by A28,TARSKI:def 4;
consider D being (Subset of G) such that A33: Z = D and A34: (ex H being  strict (Subgroup of G) st (H in Y & D = ( carr H ))) by A30;
consider B being (Subset of G) such that A35: Z1 = B and A36: (ex H being  strict (Subgroup of G) st (H in Y & B = ( carr H ))) by A32;
consider H1 being (Subgroup of G) such that A37: H1 in Y and A38: D = ( carr H1 ) by A34;
consider H2 being (Subgroup of G) such that A39: H2 in Y and A40: B = ( carr H2 ) by A36;
now
per cases  by A22,A23,A37,A39;
suppose P[ H1,H2 ];

then ( carr H1 ) c= (the carrier of H2) by GROUP_2:def 5;
then ( a * b ) in ( carr H2 ) by A29,A33,A38,A31,A35,A40,GROUP_2:74;
hence ( a * b ) in E by A32,A35,A40,TARSKI:def 4;
end;
suppose P[ H2,H1 ];

then ( carr H2 ) c= (the carrier of H1) by GROUP_2:def 5;
then ( a * b ) in ( carr H1 ) by A29,A33,A38,A31,A35,A40,GROUP_2:74;
hence ( a * b ) in E by A30,A33,A38,TARSKI:def 4;
end;
end;
hence ( a * b ) in E;
end;
A41:now
let a being (Element of G);
assume a in E;
then consider Z being set such that A42: a in Z and A43: Z in C by TARSKI:def 4;
consider D being (Subset of G) such that A44: Z = D and A45: (ex H being  strict (Subgroup of G) st (H in Y & D = ( carr H ))) by A43;
consider H1 being (Subgroup of G) such that H1 in Y and A46: D = ( carr H1 ) by A45;
( a " ) in ( carr H1 ) by A42,A44,A46,GROUP_2:75;
hence ( a " ) in E by A43,A44,A46,TARSKI:def 4;
end;
set s = the (Element of Y);
A47: s in X by A22,A25,TARSKI:def 3;
then reconsider s as  strict (Subgroup of G) by A13,GROUP_3:def 1;
A48: ( carr s ) in C by A25;
then A49: ( carr s ) c= E by ZFMISC_1:74;
E <> ( {} ) by A48,ORDERS_1:6;
then consider H being  strict (Subgroup of G) such that A50: (the carrier of H) = E by A26,A41,GROUP_2:52;
A51:now
assume a in H;
then a in E by A50,STRUCT_0:def 5;
then consider Z being set such that A52: a in Z and A53: Z in C by TARSKI:def 4;
consider D being (Subset of G) such that A54: Z = D and A55: (ex H being  strict (Subgroup of G) st (H in Y & D = ( carr H ))) by A53;
consider H1 being  strict (Subgroup of G) such that A56: H1 in Y and A57: D = ( carr H1 ) by A55;
(not a in H1) by A14,A22,A56;
hence contradiction by A52,A54,A57,STRUCT_0:def 5;
end;
M c= ( carr s ) by A14,A47;
then A58: M c= E by A49,XBOOLE_1:1;
(the carrier of H) = ( carr H );
then reconsider y = H as (Element of X) by A14,A58,A50,A51;
take y;
let x being (Element of X);
assume A59: x in Y;
x in ( Subgroups G ) by A13,TARSKI:def 3;
then reconsider K = x as  strict (Subgroup of G) by GROUP_3:def 1;
take K;
take H;
thus (x = K & y = H);
( carr K ) = (the carrier of K);
then (the carrier of K) in C by A59;
hence K is (Subgroup of H) by A50,GROUP_2:57,ZFMISC_1:74;
end;
end;
hence thesis;
end;
A60:now
let x being (Element of X);
x in ( Subgroups G ) by A13,TARSKI:def 3;
hence x is  strict  strict (Subgroup of G) by GROUP_3:def 1;
end;
A61: (for x being (Element of X) holds P[ x,x ])
proof
let x being (Element of X);
reconsider H = x as  strict (Subgroup of G) by A60;
H is (Subgroup of H) by GROUP_2:54;
hence thesis;
end;
A62: (for x,y being (Element of X) holds ((P[ x,y ] & P[ y,x ]) implies x = y)) by GROUP_2:55;
consider s being (Element of X) such that A63: (for y being (Element of X) holds (s <> y implies (not P[ s,y ]))) from ORDERS_1:sch 1(A61,A62,A15,A21);
reconsider H = s as  strict (Subgroup of G) by A60;
H is  maximal
proof
(not a in H) by A14;
hence ( the multMagma of H ) <> ( the multMagma of G ) by STRUCT_0:def 5;
let K being  strict (Subgroup of G);
assume that
A64: K <> ( the multMagma of H )
and
A65: H is (Subgroup of K)
and
A66: K <> ( the multMagma of G );
A67: M c= ( carr H ) by A14;
(the carrier of H) c= (the carrier of K) by A65,GROUP_2:def 5;
then A68: M c= ( carr K ) by A67,XBOOLE_1:1;
now
A69: B c= ( M \/ { a } )
proof
let x;
assume A70: x in B;
now
per cases ;
suppose x = a;

then x in { a } by TARSKI:def 1;
hence thesis by XBOOLE_0:def 3;
end;
suppose x <> a;

then (not x in { a }) by TARSKI:def 1;
then x in M by A70,XBOOLE_0:def 5;
hence thesis by XBOOLE_0:def 3;
end;
end;
hence thesis;
end;
assume a in K;
then a in ( carr K ) by STRUCT_0:def 5;
then { a } c= ( carr K ) by ZFMISC_1:31;
then ( M \/ { a } ) c= ( carr K ) by A68,XBOOLE_1:8;
then ( gr B ) is (Subgroup of ( gr ( carr K ) )) by A69,CKB40:1,XBOOLE_1:1;
then G is (Subgroup of K) by A2,CKB39:1;
hence contradiction by A66,GROUP_2:55;
end;
then reconsider v = K as (Element of X) by A14,A68;
(not P[ s,v ]) by A63,A64;
hence thesis by A65;
end;
then ( Phi G ) is (Subgroup of H) by CKB51:1;
then (the carrier of ( Phi G )) c= (the carrier of H) by GROUP_2:def 5;
then x in H by A1,STRUCT_0:def 5;
hence thesis by A14;
end;

let x;
assume x in A;
then consider a being (Element of G) such that A71: x = a and A72: a is non  generating;
now
per cases ;
suppose (for H being  strict (Subgroup of G) holds (not H is  maximal));

then ( Phi G ) = G by CKB48:def 1;
hence thesis by A71;
end;
suppose A73: (ex H being  strict (Subgroup of G) st H is  maximal);

now
let H being  strict (Subgroup of G);
assume A74: H is  maximal;
now
assume A75: (not a in H);
( ( carr H ) /\ { a } ) c= ( {} )
proof
let x;
assume A76: x in ( ( carr H ) /\ { a } );
then x in { a } by XBOOLE_0:def 4;
then A77: x = a by TARSKI:def 1;
x in ( carr H ) by A76,XBOOLE_0:def 4;
hence thesis by A75,A77,STRUCT_0:def 5;
end;
then ( ( carr H ) /\ { a } ) = ( {} );
then A78: ( carr H ) misses { a } by XBOOLE_0:def 7;
( ( ( carr H ) \/ { a } ) \ { a } ) = ( ( carr H ) \ { a } ) by XBOOLE_1:40
.= ( carr H ) by A78,XBOOLE_1:83;
then A79: ( gr ( ( ( carr H ) \/ { a } ) \ { a } ) ) = H by CKB39:1;
A80: H <> G by A74,CKB46:def 1;
( gr ( ( carr H ) \/ { a } ) ) = G by A74,A75,CKB47:1;
hence contradiction by A72,A79,A80,CKB44:def 1;
end;
hence a in H;
end;
then a in ( Phi G ) by A73,CKB49:1;
hence thesis by A71,STRUCT_0:def 5;
end;
end;
hence thesis;
end;
