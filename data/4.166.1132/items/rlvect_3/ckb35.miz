environ
vocabularies REAL_1,SUBSET_1,NUMBERS,RLVECT_1,RLSUB_1,FINSET_1,RLVECT_2,FINSEQ_1,STRUCT_0,FUNCT_1,XBOOLE_0,ORDERS_1,VALUED_1,ORDINAL4,ARYTM_3,RELAT_1,PARTFUN1,NAT_1,CARD_3,CARD_1,SUPINF_2,FINSEQ_4,TARSKI,FUNCT_2,ARYTM_1,ZFMISC_1,ORDINAL1,RLVECT_3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,FINSEQ_1,RELAT_1,ORDINAL1,FUNCT_1,PARTFUN1,FUNCT_2,ORDERS_1,DOMAIN_1,STRUCT_0,RLVECT_1,FINSEQ_4,FINSET_1,REAL_1,RLSUB_1,RLSUB_2,RLVECT_2,NAT_1,CKB6,CKB7,CKB18;
definitions XBOOLE_0,RLSUB_1,RLVECT_2,TARSKI,CKB6,CKB18;
theorems CARD_2,FUNCT_1,FUNCT_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FINSET_1,RLSUB_1,RLSUB_2,RLVECT_1,RLVECT_2,TARSKI,ZFMISC_1,RELAT_1,RELSET_1,ORDINAL1,XBOOLE_0,XBOOLE_1,XCMPLX_0,ORDERS_1,STRUCT_0,PARTFUN1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB8,CKB9,CKB10,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34;
schemes FINSEQ_1,FUNCT_1,FUNCT_2,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,FUNCT_1,RELSET_1,FINSET_1,NUMBERS,STRUCT_0,RLVECT_1,RLSUB_1,ORDINAL1,REAL_1,XREAL_0,RLVECT_2,CKB11;
constructors PARTFUN1,REAL_1,NAT_1,ORDERS_1,FINSEQ_4,REALSET1,RLSUB_2,RLVECT_2,RELSET_1,CKB6,CKB18;
requirements NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve X for set;
reserve Y for set;
reserve Z for set;
reserve V for RealLinearSpace;
reserve A for (Subset of V);
reserve B for (Subset of V);
theorem
Th27: (A is  linearly-independent implies (ex B st ((A c= B & B is  linearly-independent) & ( Lin B ) = ( the RLSStruct of V ))))
proof
defpred P[ set ]
 means
(ex B being (Subset of V) st ((B = $1 & A c= B) & B is  linearly-independent));
consider Q being set such that A1: (for Z holds (Z in Q iff (Z in ( bool (the carrier of V) ) & P[ Z ]))) from XBOOLE_0:sch 1;
A2:now
let Z;
assume that
A3: Z <> ( {} )
and
A4: Z c= Q
and
A5: Z is  c=-linear;
set W = ( union Z );
W c= (the carrier of V)
proof
let x;
assume x in W;
then consider X such that A6: x in X and A7: X in Z by TARSKI:def 4;
X in ( bool (the carrier of V) ) by A1,A4,A7;
hence thesis by A6;
end;
then reconsider W as (Subset of V);
A8: W is  linearly-independent
proof
deffunc Q(set) = { C where C is (Subset of V): ($1 in C & C in Z) };
let l being (Linear_Combination of W);
assume that
A9: ( Sum l ) = ( 0. V )
and
A10: ( Carrier l ) <> ( {} );
consider f being Function such that A11: ( dom f ) = ( Carrier l ) and A12: (for x holds (x in ( Carrier l ) implies ( f . x ) = Q(x))) from FUNCT_1:sch 3;
reconsider M = ( rng f ) as non empty set by A10,A11,RELAT_1:42;
set F = the (Choice_Function of M);
set S = ( rng F );
A13:now
assume ( {} ) in M;
then consider x such that A14: x in ( dom f ) and A15: ( f . x ) = ( {} ) by FUNCT_1:def 3;
( Carrier l ) c= W by RLVECT_2:def 6;
then consider X such that A16: x in X and A17: X in Z by A11,A14,TARSKI:def 4;
reconsider X as (Subset of V) by A1,A4,A17;
X in { C where C is (Subset of V): (x in C & C in Z) } by A16,A17;
hence contradiction by A11,A12,A14,A15;
end;
then A18: ( dom F ) = M by CKB34:1;
then ( dom F ) is  finite by A11,FINSET_1:8;
then A19: S is  finite by FINSET_1:8;
A20:now
let X;
assume X in S;
then consider x such that A21: x in ( dom F ) and A22: ( F . x ) = X by FUNCT_1:def 3;
consider y such that A23: (y in ( dom f ) & ( f . y ) = x) by A18,A21,FUNCT_1:def 3;
A24: x = Q(y) by A11,A12,A23;
X in x by A13,A18,A21,A22,ORDERS_1:def 1;
then (ex C being (Subset of V) st ((C = X & y in C) & C in Z)) by A24;
hence X in Z;
end;
A25:now
let X;
let Y;
assume (X in S & Y in S);
then (X in Z & Y in Z) by A20;
then X,Y are_c=-comparable  by A5,ORDINAL1:def 8;
hence (X c= Y or Y c= X) by XBOOLE_0:def 9;
end;
S <> ( {} ) by A18,RELAT_1:42;
then ( union S ) in S by A25,A19,CARD_2:62;
then ( union S ) in Z by A20;
then consider B being (Subset of V) such that A26: B = ( union S ) and A c= B and A27: B is  linearly-independent by A1,A4;
( Carrier l ) c= ( union S )
proof
let x;
set X = ( f . x );
assume A28: x in ( Carrier l );
then A29: ( f . x ) = { C where C is (Subset of V): (x in C & C in Z) } by A12;
A30: ( f . x ) in M by A11,A28,FUNCT_1:def 3;
then ( F . X ) in X by A13,ORDERS_1:def 1;
then A31: (ex C being (Subset of V) st ((( F . X ) = C & x in C) & C in Z)) by A29;
( F . X ) in S by A18,A30,FUNCT_1:def 3;
hence thesis by A31,TARSKI:def 4;
end;
then l is (Linear_Combination of B) by A26,RLVECT_2:def 6;
hence thesis by A9,A10,A27,CKB6:def 1;
end;
set x = the (Element of Z);
x in Q by A3,A4,TARSKI:def 3;
then A32: (ex B being (Subset of V) st ((B = x & A c= B) & B is  linearly-independent)) by A1;
x c= W by A3,ZFMISC_1:74;
then A c= W by A32,XBOOLE_1:1;
hence ( union Z ) in Q by A1,A8;
end;
A33: ( (Omega). V ) = ( the RLSStruct of V );
assume A is  linearly-independent;
then Q <> ( {} ) by A1;
then consider X such that A34: X in Q and A35: (for Z holds ((Z in Q & Z <> X) implies (not X c= Z))) by A2,ORDERS_1:67;
consider B being (Subset of V) such that A36: B = X and A37: A c= B and A38: B is  linearly-independent by A1,A34;
take B;
thus (A c= B & B is  linearly-independent) by A37,A38;
assume ( Lin B ) <> ( the RLSStruct of V );
then consider v being (VECTOR of V) such that A39: (not (v in ( Lin B ) iff v in ( the RLSStruct of V ))) by A33,RLSUB_1:31;
A40: ( B \/ { v } ) is  linearly-independent
proof
let l being (Linear_Combination of ( B \/ { v } ));
assume A41: ( Sum l ) = ( 0. V );
now
per cases ;
suppose v in ( Carrier l );

then A42: ( - ( l . v ) ) <> ( 0 ) by RLVECT_2:19;
deffunc G((VECTOR of V)) = ( 0 );
deffunc L((VECTOR of V)) = ( l . $1 );
consider f being (Function of (the carrier of V),( REAL )) such that A43: ( f . v ) = ( 0 ) and A44: (for u being (VECTOR of V) holds (u <> v implies ( f . u ) = L(u))) from FUNCT_2:sch 6;
reconsider f as (Element of ( Funcs ((the carrier of V),( REAL )) )) by FUNCT_2:8;
now
let u being (VECTOR of V);
assume (not u in ( ( Carrier l ) \ { v } ));
then ((not u in ( Carrier l )) or u in { v }) by XBOOLE_0:def 5;
then ((( l . u ) = ( 0 ) & u <> v) or u = v) by TARSKI:def 1;
hence ( f . u ) = ( 0 ) by A43,A44;
end;
then reconsider f as (Linear_Combination of V) by RLVECT_2:def 3;
( Carrier f ) c= B
proof
let x;
A45: ( Carrier l ) c= ( B \/ { v } ) by RLVECT_2:def 6;
assume x in ( Carrier f );
then consider u being (VECTOR of V) such that A46: u = x and A47: ( f . u ) <> ( 0 );
( f . u ) = ( l . u ) by A43,A44,A47;
then u in ( Carrier l ) by A47;
then (u in B or u in { v }) by A45,XBOOLE_0:def 3;
hence thesis by A43,A46,A47,TARSKI:def 1;
end;
then reconsider f as (Linear_Combination of B) by RLVECT_2:def 6;
consider g being (Function of (the carrier of V),( REAL )) such that A48: ( g . v ) = ( - ( l . v ) ) and A49: (for u being (VECTOR of V) holds (u <> v implies ( g . u ) = G(u))) from FUNCT_2:sch 6;
reconsider g as (Element of ( Funcs ((the carrier of V),( REAL )) )) by FUNCT_2:8;
now
let u being (VECTOR of V);
assume (not u in { v });
then u <> v by TARSKI:def 1;
hence ( g . u ) = ( 0 ) by A49;
end;
then reconsider g as (Linear_Combination of V) by RLVECT_2:def 3;
( Carrier g ) c= { v }
proof
let x;
assume x in ( Carrier g );
then (ex u being (VECTOR of V) st (x = u & ( g . u ) <> ( 0 )));
then x = v by A49;
hence thesis by TARSKI:def 1;
end;
then reconsider g as (Linear_Combination of { v }) by RLVECT_2:def 6;
A50: ( Sum g ) = ( ( - ( l . v ) ) * v ) by A48,RLVECT_2:32;
( f - g ) = l
proof
let u being (VECTOR of V);
now
per cases ;
suppose A51: v = u;

thus ( ( f - g ) . u ) = ( ( f . u ) - ( g . u ) ) by RLVECT_2:54
.= ( l . u ) by A43,A48,A51;
end;
suppose A52: v <> u;

thus ( ( f - g ) . u ) = ( ( f . u ) - ( g . u ) ) by RLVECT_2:54
.= ( ( l . u ) - ( g . u ) ) by A44,A52
.= ( ( l . u ) - ( 0 ) ) by A49,A52
.= ( l . u );
end;
end;
hence thesis;
end;
then ( 0. V ) = ( ( Sum f ) - ( Sum g ) ) by A41,CKB5:1;
then ( Sum f ) = ( ( 0. V ) + ( Sum g ) ) by RLSUB_2:61
.= ( ( - ( l . v ) ) * v ) by A50,RLVECT_1:4;
then A53: ( ( - ( l . v ) ) * v ) in ( Lin B ) by CKB19:1;
( ( ( - ( l . v ) ) " ) * ( ( - ( l . v ) ) * v ) ) = ( ( ( ( - ( l . v ) ) " ) * ( - ( l . v ) ) ) * v ) by RLVECT_1:def 7
.= ( 1 * v ) by A42,XCMPLX_0:def 7
.= v by RLVECT_1:def 8;
hence thesis by A39,A53,RLSUB_1:21,RLVECT_1:1;
end;
suppose A54: (not v in ( Carrier l ));

( Carrier l ) c= B
proof
let x;
assume A55: x in ( Carrier l );
( Carrier l ) c= ( B \/ { v } ) by RLVECT_2:def 6;
then (x in B or x in { v }) by A55,XBOOLE_0:def 3;
hence thesis by A54,A55,TARSKI:def 1;
end;
then l is (Linear_Combination of B) by RLVECT_2:def 6;
hence thesis by A38,A41,CKB6:def 1;
end;
end;
hence thesis;
end;
v in { v } by TARSKI:def 1;
then A56: v in ( B \/ { v } ) by XBOOLE_0:def 3;
A57: (not v in B) by A39,CKB20:1,RLVECT_1:1;
B c= ( B \/ { v } ) by XBOOLE_1:7;
then A c= ( B \/ { v } ) by A37,XBOOLE_1:1;
then ( B \/ { v } ) in Q by A1,A40;
hence contradiction by A35,A36,A56,A57,XBOOLE_1:7;
end;
