environ
vocabularies NUMBERS,NAT_1,XBOOLE_0,VECTSP_1,SUBSET_1,MATRIX_2,FUNCT_2,FINSEQ_1,FUNCT_1,ARYTM_3,SGRAPH1,XXREAL_0,TARSKI,CARD_1,FINSET_1,ORDINAL1,RELAT_1,ALGSTR_0,SETWISEO,BINOP_1,STRUCT_0,GROUP_1,ARYTM_1,FINSUB_1,INT_1,SUPINF_2,ABSVALUE,FINSEQ_2,CARD_3,ORDINAL4,FINSOP_1,ABIAN,MATRIX_1,TREES_1,ZFMISC_1,INCSP_1,AFINSQ_1,PARTFUN1,MATRIX_3,RLVECT_1,RVSUM_1,FVSUM_1,FUNCT_5,FUNCT_4,MATRIX11;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,BINOP_1,STRUCT_0,ALGSTR_0,NAT_D,RLVECT_1,GROUP_1,VECTSP_1,SETWISEO,SETWOP_2,FINSEQ_2,FINSEQOP,MATRIX_1,FINSUB_1,MATRIX_2,NAT_1,FVSUM_1,CAT_2,FINSOP_1,GROUP_4,MATRIX_3,CARD_1,FINSEQ_7,FUNCT_4,ORDINAL1,SGRAPH1,MATRIX_6,CKB1,CKB9,CKB18,CKB39,CKB40,CKB54,CKB74;
definitions BINOP_1,FINSEQ_2,FINSEQ_1,TARSKI,XBOOLE_0,MATRIX_1,MATRIX_3,FVSUM_1,RELAT_1,ALGSTR_0,CKB9,CKB18,CKB39,CKB54,CKB74;
theorems FINSEQ_1,FINSEQ_2,TARSKI,FUNCT_2,NAT_1,BINOP_1,FUNCT_1,SETWISEO,VECTSP_1,ZFMISC_1,FVSUM_1,SETWOP_2,MATRIX_1,MATRIX_2,FUNCOP_1,FINSUB_1,FINSEQ_3,RLVECT_1,RELAT_1,FINSOP_1,XBOOLE_0,XBOOLE_1,GROUP_1,MATRIX_3,FINSEQ_5,FINSET_1,GROUP_4,XREAL_1,MATRIX_7,ORDINAL1,MATRIX_4,CARD_1,CARD_2,MATRIX_9,STIRL2_1,RADIX_1,REWRITE1,FINSEQ_7,SGRAPH1,WELLORD2,FRAENKEL,FUNCT_5,FUNCT_4,NAT_D,XXREAL_0,PARTFUN1,CKB2,CKB3,CKB4,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB39,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB78;
schemes FUNCT_2,NAT_1,FINSEQ_1,FINSEQ_2,MATRIX_1,BINOP_1,FUNCT_1,SETWISEO;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,PARTFUN1,FUNCT_2,FINSET_1,FINSUB_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,STRUCT_0,GROUP_1,VECTSP_1,MATRIX_2,FVSUM_1,CARD_1,RELSET_1,FINSEQ_2,CKB5,CKB6,CKB7,CKB8,CKB38,CKB76,CKB77;
constructors RELAT_2,WELLORD2,SETWISEO,XXREAL_0,NAT_1,NAT_D,FINSOP_1,SETWOP_2,FINSEQ_7,CAT_2,ALGSTR_1,GROUP_4,FVSUM_1,SGRAPH1,MATRIX_6,MATRIX_7,RELSET_1,CKB9,CKB18,CKB39,CKB54,CKB74;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve i for Nat;
reserve j for Nat;
reserve k for Nat;
reserve n for Nat;
reserve D for non  empty set;
reserve K for Field;
reserve P for (Permutation of ( Seg n ));
reserve pK for (FinSequence of K);
reserve A for (Matrix of n,K);
theorem
Th56: (for A,B,C being (Matrix of n,K) holds (for i holds (i in ( Seg n ) implies (ex P being (FinSequence of K) st ((( len P ) = n & ( Det ( RLine (C,i,( Line (( A * B ),i) )) ) ) = ( (the addF of K) "**" P )) & (for j holds (j in ( Seg n ) implies ( P . j ) = ( ( A * (i,j) ) * ( Det ( RLine (C,i,( Line (B,j) )) ) ) ))))))))
proof
let A being (Matrix of n,K);
let B being (Matrix of n,K);
let C being (Matrix of n,K);
let i;
assume that
A1: i in ( Seg n );
( Seg n ) <> ( {} ) by A1;
then A2: n <> ( 0 );
set a = ( addFinS K );
A3: ( len B ) = n by MATRIX_1:24;
deffunc F(Nat) = ( ( A * (i,$1) ) * ( Det ( RLine (C,i,( Line (B,$1) )) ) ) );
set aa = (the addF of K);
set KK = (the carrier of K);
A4: ( len A ) = n by MATRIX_1:24;
consider D being (FinSequence of KK) such that A5: ( len D ) = ( len A ) and A6: (for j being Nat holds (j in ( dom D ) implies ( D . j ) = F(j))) from FINSEQ_2:sch 1;
A7: n <> ( 0 ) by A1;
then ( len D ) >= 1 by A4,A5,NAT_1:14;
then consider Fd being (Function of ( NAT ),KK) such that A8: ( Fd . 1 ) = ( D . 1 ) and A9: (for k being (Element of ( NAT )) holds ((( 0 ) <> k & k < n) implies ( Fd . ( k + 1 ) ) = ( aa . (( Fd . k ),( D . ( k + 1 ) )) ))) and A10: ( aa "**" D ) = ( Fd . n ) by A4,A5,FINSOP_1:def 1;
A11: ( dom D ) = ( Seg ( len A ) ) by A5,FINSEQ_1:def 3;
( width A ) = n by MATRIX_1:24;
then consider P being (FinSequence of ( KK * )) such that A12: ( len P ) = n and A13: ( Line (( A * B ),i) ) = ( a "**" P ) and A14: (for j holds (j in ( Seg ( len B ) ) implies ( P . j ) = ( ( A * (i,j) ) * ( Line (B,j) ) ))) by A1,A7,A3,A4,CKB78:1;
( len P ) >= 1 by A12,A2,NAT_1:14;
then consider Fp being (Function of ( NAT ),( KK * )) such that A15: ( Fp . 1 ) = ( P . 1 ) and A16: (for k being (Element of ( NAT )) holds ((( 0 ) <> k & k < n) implies ( Fp . ( k + 1 ) ) = ( a . (( Fp . k ),( P . ( k + 1 ) )) ))) and A17: ( Line (( A * B ),i) ) = ( Fp . n ) by A12,A13,FINSOP_1:def 1;
defpred P[ Nat ]
 means
((1 <= $1 & $1 <= n) implies (for pK holds (pK = ( Fp . $1 ) implies (( len pK ) = n & ( Fd . $1 ) = ( Det ( RLine (C,i,pK) ) )))));
A18: ( width B ) = n by MATRIX_1:24;
A19: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume that
A20: P[ k ];
set k1 = ( k + 1 );
set A9 = ( A * (i,k1) );
set L = ( Line (B,k1) );
assume that
A21: 1 <= k1
and
A22: k1 <= n;
A23: k1 in ( Seg n ) by A21,A22;
let Fpk1 being (FinSequence of KK);
assume that
A24: Fpk1 = ( Fp . k1 );
per cases ;
suppose A25: k = ( 0 );

A26: ( P . k1 ) = ( A9 * L ) by A3,A14,A23;
A27: ( len L ) = n by A18,MATRIX_1:def 7;
( D . k1 ) = F(1) by A4,A6,A11,A23,A25;
hence thesis by A1,A15,A8,A24,A25,A26,A27,CKB45:1,CKB50:1;
end;
suppose A28: k > ( 0 );

k1 in ( dom P ) by A12,A23,FINSEQ_1:def 3;
then A29: ( P . k1 ) in ( rng P ) by FUNCT_1:def 3;
( rng P ) c= ( KK * ) by FINSEQ_1:def 4;
then reconsider Pk1 = ( P . k1 ),Fpk = ( Fp . k ) as (Element of ( KK * )) by A29;
A30: ( k + ( 0 ) ) < k1 by XREAL_1:8;
then A31: ( Fd . k ) = ( Det ( RLine (C,i,Fpk) ) ) by A20,A22,A28,NAT_1:14,XXREAL_0:2;
A32: ( len Fpk ) = n by A20,A22,A28,A30,NAT_1:14,XXREAL_0:2;
A33: k < n by A22,A30,XXREAL_0:2;
then A34: ( Fd . k1 ) = ( aa . (( Fd . k ),( D . k1 )) ) by A9,A28;
A35: ( P . k1 ) = ( A9 * L ) by A3,A14,A23;
Fpk1 = ( a . (Fpk,Pk1) ) by A16,A24,A28,A33;
then A36: Fpk1 = ( Fpk + ( A9 * L ) ) by A35,CKB74:def 1;
A37: ( len L ) = n by A18,MATRIX_1:def 7;
then A38: ( len ( A9 * L ) ) = n by CKB45:1;
( Det ( RLine (C,i,( A9 * L )) ) ) = ( A9 * ( Det ( RLine (C,i,L) ) ) ) by A1,A37,CKB50:1;
then ( Det ( RLine (C,i,Fpk1) ) ) = ( ( Det ( RLine (C,i,Fpk) ) ) + ( A9 * ( Det ( RLine (C,i,L) ) ) ) ) by A1,A32,A36,A38,CKB52:1;
hence thesis by A4,A6,A11,A23,A31,A34,A32,A36,A38,CKB46:1;
end;
end;
take D;
thus ( len D ) = n by A5,MATRIX_1:24;
A39: P[ ( 0 ) ];
(for k being (Element of ( NAT )) holds P[ k ]) from NAT_1:sch 1(A39,A19);
then P[ ( len P ) ];
hence thesis by A4,A12,A6,A11,A17,A10,A2,NAT_1:14;
end;
