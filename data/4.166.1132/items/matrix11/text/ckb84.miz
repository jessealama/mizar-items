environ
vocabularies NUMBERS,NAT_1,XBOOLE_0,VECTSP_1,SUBSET_1,MATRIX_2,FUNCT_2,FINSEQ_1,FUNCT_1,ARYTM_3,SGRAPH1,XXREAL_0,TARSKI,CARD_1,FINSET_1,ORDINAL1,RELAT_1,ALGSTR_0,SETWISEO,BINOP_1,STRUCT_0,GROUP_1,ARYTM_1,FINSUB_1,INT_1,SUPINF_2,ABSVALUE,FINSEQ_2,CARD_3,ORDINAL4,FINSOP_1,ABIAN,MATRIX_1,TREES_1,ZFMISC_1,INCSP_1,AFINSQ_1,PARTFUN1,MATRIX_3,RLVECT_1,RVSUM_1,FVSUM_1,FUNCT_5,FUNCT_4,MATRIX11;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,BINOP_1,STRUCT_0,ALGSTR_0,NAT_D,RLVECT_1,GROUP_1,VECTSP_1,SETWISEO,SETWOP_2,FINSEQ_2,FINSEQOP,MATRIX_1,FINSUB_1,MATRIX_2,NAT_1,FVSUM_1,CAT_2,FINSOP_1,GROUP_4,MATRIX_3,CARD_1,FINSEQ_7,FUNCT_4,ORDINAL1,SGRAPH1,MATRIX_6,CKB1,CKB9,CKB18,CKB39,CKB40,CKB54,CKB74;
definitions BINOP_1,FINSEQ_2,FINSEQ_1,TARSKI,XBOOLE_0,MATRIX_1,MATRIX_3,FVSUM_1,RELAT_1,ALGSTR_0,CKB9,CKB18,CKB39,CKB54,CKB74;
theorems FINSEQ_1,FINSEQ_2,TARSKI,FUNCT_2,NAT_1,BINOP_1,FUNCT_1,SETWISEO,VECTSP_1,ZFMISC_1,FVSUM_1,SETWOP_2,MATRIX_1,MATRIX_2,FUNCOP_1,FINSUB_1,FINSEQ_3,RLVECT_1,RELAT_1,FINSOP_1,XBOOLE_0,XBOOLE_1,GROUP_1,MATRIX_3,FINSEQ_5,FINSET_1,GROUP_4,XREAL_1,MATRIX_7,ORDINAL1,MATRIX_4,CARD_1,CARD_2,MATRIX_9,STIRL2_1,RADIX_1,REWRITE1,FINSEQ_7,SGRAPH1,WELLORD2,FRAENKEL,FUNCT_5,FUNCT_4,NAT_D,XXREAL_0,PARTFUN1,CKB2,CKB3,CKB4,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB39,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB78,CKB79,CKB80,CKB81,CKB82,CKB83;
schemes FUNCT_2,NAT_1,FINSEQ_1,FINSEQ_2,MATRIX_1,BINOP_1,FUNCT_1,SETWISEO;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,PARTFUN1,FUNCT_2,FINSET_1,FINSUB_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,STRUCT_0,GROUP_1,VECTSP_1,MATRIX_2,FVSUM_1,CARD_1,RELSET_1,FINSEQ_2,CKB5,CKB6,CKB7,CKB8,CKB38,CKB76,CKB77;
constructors RELAT_2,WELLORD2,SETWISEO,XXREAL_0,NAT_1,NAT_D,FINSOP_1,SETWOP_2,FINSEQ_7,CAT_2,ALGSTR_1,GROUP_4,FVSUM_1,SGRAPH1,MATRIX_6,MATRIX_7,RELSET_1,CKB9,CKB18,CKB39,CKB54,CKB74;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve i for Nat;
reserve j for Nat;
reserve k for Nat;
reserve n for Nat;
reserve m for Nat;
reserve D for non  empty set;
reserve K for Field;
reserve q for (Element of ( Permutations n ));
reserve F for (Function of ( Seg n ),( Seg n ));
reserve M for (Matrix of n,m,D);
reserve A for (Matrix of n,K);
theorem
Th60: (for A,B being (Matrix of n,K) holds (( 0 ) < n implies (ex P being (Function of ( Funcs (( Seg n ),( Seg n )) ),(the carrier of K)) st ((for F being (Function of ( Seg n ),( Seg n )) holds (ex Path being (FinSequence of K) st ((( len Path ) = n & (for Fj,j being Nat holds ((j in ( Seg n ) & Fj = ( F . j )) implies ( Path . j ) = ( A * (j,Fj) )))) & ( P . F ) = ( ( (the multF of K) $$ Path ) * ( Det ( B * F ) ) )))) & ( Det ( A * B ) ) = ( (the addF of K) $$ (( FinOmega ( Funcs (( Seg n ),( Seg n )) ) ),P) )))))
proof
let A being (Matrix of n,K);
let B being (Matrix of n,K);
assume that
A1: ( 0 ) < n;
set AB = ( A * B );
set aa = (the addF of K);
set I = ( idseq n );
set mm = (the multF of K);
set KK = (the carrier of K);
defpred FF[ Function,Nat ]
 means
(for F being (Function of ( Seg $2 ),( Seg n )) holds (for M being (Matrix of n,n,K) holds ((M = ( ( A * B ) +* ( ( B * ( I +* F ) ) | ( Seg $2 ) ) ) & (for j holds ((j in ( Seg $2 ) implies ( M . j ) = ( B . ( F . j ) )) & ((not j in ( Seg $2 )) implies ( M . j ) = ( ( A * B ) . j ))))) implies (ex Path being (FinSequence of K) st ((( len Path ) = $2 & (for Fj,j being Nat holds ((j in ( Seg $2 ) & Fj = ( F . j )) implies ( Path . j ) = ( A * (j,Fj) )))) & ( $1 . F ) = ( ( mm $$ Path ) * ( Det M ) ))))));
defpred P[ Nat ]
 means
($1 <= n implies (for FUNC being non  empty set holds (FUNC = ( Funcs (( Seg $1 ),( Seg n )) ) implies (ex P being (Function of FUNC,KK) st (FF[ P,$1 ] & ( Det AB ) = ( aa $$ (( FinOmega FUNC ),P) ))))));
A2: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
set Y = ( Seg n );
let k being (Element of ( NAT ));
assume that
A3: P[ k ];
set X = ( Seg k );
reconsider FUNC = ( Funcs (( Seg k ),( Seg n )) ) as non  empty set by A1;
set k1 = ( k + 1 );
assume A4: k1 <= n;
set Xx = ( ( Seg k ) \/ { k1 } );
let FUNC1 being non  empty set;
assume that
A5: FUNC1 = ( Funcs (( Seg k1 ),( Seg n )) );
consider P1 being (Function of FUNC1,KK) such that A6: FF[ P1,k1 ] by A4,A5,CKB83:1;
reconsider FUNC19 = ( Funcs (Xx,Y) ) as non  empty set by A5,FINSEQ_1:9;
A7: FUNC1 = ( Funcs (Xx,Y) ) by A5,FINSEQ_1:9;
then reconsider P19 = P1 as (Function of FUNC19,KK);
A8: ( k + ( 0 ) ) <= k1 by XREAL_1:8;
then consider P being (Function of FUNC,KK) such that A9: FF[ P,k ] and A10: ( Det AB ) = ( aa $$ (( FinOmega FUNC ),P) ) by A3,A4,XXREAL_0:2;
A11: (not k1 in X) by FINSEQ_3:8;
A12: (for H being (Function of X,Y) holds (for SF being (Element of ( Fin FUNC19 )) holds (SF = { h where h is (Function of Xx,Y): ( h | X ) = H } implies ( aa $$ (SF,P19) ) = ( P . H ))))
proof
reconsider YY = Y as non  empty set by A1;
let H being (Function of X,Y);
let SF being (Element of ( Fin FUNC19 ));
assume that
A13: SF = { h where h is (Function of Xx,Y): ( h | X ) = H };
defpred Q[ set,set ]
 means
(for h being (Function of Xx,Y) holds ((( h | X ) = H & ( h . k1 ) = $1) implies h = $2));
A14: (for y holds (y in YY implies (ex f9 being set st (f9 in SF & Q[ y,f9 ]))))
proof
let y;
assume y in YY;
then ( Y \/ { y } ) = Y by ZFMISC_1:40;
then consider q being (Function of Xx,Y) such that A15: ( q | X ) = H and A16: ( q . k1 ) = y by A11,STIRL2_1:57;
take q;
thus q in SF by A13,A15;
let h being (Function of Xx,Y);
assume that
A17: ( h | X ) = H
and
A18: ( h . k1 ) = y;
now
let x;
assume x in Xx;
then A19: (x in X or x in { k1 }) by XBOOLE_0:def 3;
( dom H ) = X by A1,FUNCT_2:def 1;
then ((( q . x ) = ( H . x ) & ( h . x ) = ( H . x )) or x = k1) by A15,A17,A19,FUNCT_1:47,TARSKI:def 1;
hence ( h . x ) = ( q . x ) by A16,A18;
end;
hence thesis by FUNCT_2:12;
end;
consider QQ being (Function of YY,SF) such that A20: (for y holds (y in YY implies Q[ y,( QQ . y ) ])) from FUNCT_2:sch 1(A14);
A21: SF c= ( rng QQ )
proof
let y;
k1 in { k1 } by TARSKI:def 1;
then A22: k1 in Xx by XBOOLE_0:def 3;
assume A23: y in SF;
then consider h being (Function of Xx,Y) such that A24: y = h and A25: ( h | X ) = H by A13;
( dom h ) = Xx by A1,FUNCT_2:def 1;
then A26: ( h . k1 ) in ( rng h ) by A22,FUNCT_1:def 3;
A27: ( rng h ) c= Y by RELAT_1:def 19;
( dom QQ ) = YY by A23,FUNCT_2:def 1;
then ( QQ . ( h . k1 ) ) in ( rng QQ ) by A26,A27,FUNCT_1:def 3;
hence thesis by A20,A24,A25,A26,A27;
end;
( rng QQ ) c= SF by RELAT_1:def 19;
then A28: ( rng QQ ) = SF by A21,XBOOLE_0:def 10;
( Y \/ { n } ) = Y by A1,FINSEQ_1:3,ZFMISC_1:40;
then consider h being (Function of Xx,Y) such that A29: ( h | X ) = H and ( h . k1 ) = n by A11,STIRL2_1:57;
A30: SF c= FUNC19 by FINSUB_1:def 5;
k <= n by A4,A8,XXREAL_0:2;
then consider Mh being (Matrix of n,K) such that A31: Mh = ( AB +* ( ( B * ( I +* H ) ) | ( Seg k ) ) ) and A32: (for j holds ((j in ( Seg k ) implies ( Mh . j ) = ( B . ( H . j ) )) & ((not j in ( Seg k )) implies ( Mh . j ) = ( AB . j )))) by A1,CKB82:1;
consider Path being (FinSequence of K) such that A33: ( len Path ) = k and A34: (for Hj,j being Nat holds ((j in ( Seg k ) & Hj = ( H . j )) implies ( Path . j ) = ( A * (j,Hj) ))) and A35: ( P . H ) = ( ( mm $$ Path ) * ( Det Mh ) ) by A9,A31,A32;
A36: ( Mh . k1 ) = ( AB . k1 ) by A11,A32;
h in SF by A13,A29;
then reconsider QQ as (Function of YY,FUNC19) by A28,A30,FUNCT_2:6;
A37: ( dom ( P19 * QQ ) ) = Y by FUNCT_2:def 1;
A38: ( QQ .: ( dom QQ ) ) = SF by A28,RELAT_1:113;
( 1 + ( 0 ) ) <= k1 by XREAL_1:7;
then A39: k1 in ( Seg n ) by A4;
then A40: ( AB . k1 ) = ( Line (AB,k1) ) by MATRIX_2:8;
( Mh . k1 ) = ( Line (Mh,k1) ) by A39,MATRIX_2:8;
then Mh = ( RLine (Mh,k1,( Line (AB,k1) )) ) by A36,A40,CKB44:1;
then consider SUM1 being (FinSequence of KK) such that A41: ( len SUM1 ) = n and A42: ( Det Mh ) = ( aa "**" SUM1 ) and A43: (for j holds (j in Y implies ( SUM1 . j ) = ( ( A * (k1,j) ) * ( Det ( RLine (Mh,k1,( Line (B,j) )) ) ) ))) by A39,CKB79:1;
A44: ( dom ( id Y ) ) = Y by RELAT_1:45;
set PA = ( mm "**" Path );
set PS = ( PA * SUM1 );
( len PS ) = n by A41,CKB45:1;
then A45: ( dom PS ) = Y by FINSEQ_1:def 3;
set PSaa = ( [#] (PS,( the_unity_wrt aa )) );
A46: (for j being Nat holds (j in Y implies ( ( P19 * QQ ) . j ) = ( ( PA * ( A * (k1,j) ) ) * ( Det ( RLine (Mh,k1,( Line (B,j) )) ) ) )))
proof
A47: ( width B ) = n by MATRIX_1:24;
A48: ( len Mh ) = n by MATRIX_1:24;
A49: ( dom ( P19 * QQ ) ) = Y by FUNCT_2:def 1;
A50: ( width Mh ) = n by MATRIX_1:24;
let j being Nat;
assume that
A51: j in Y;
( Y \/ { j } ) = Y by A51,ZFMISC_1:40;
then consider hj being (Function of Xx,Y) such that A52: ( hj | X ) = H and A53: ( hj . k1 ) = j by A11,STIRL2_1:57;
set L = ( Line (B,j) );
set R = ( RLine (Mh,k1,L) );
Xx = ( Seg k1 ) by FINSEQ_1:9;
then reconsider hj9 = hj as (Function of ( Seg k1 ),Y);
consider Mhj being (Matrix of n,K) such that A54: Mhj = ( AB +* ( ( B * ( I +* hj9 ) ) | ( Seg k1 ) ) ) and A55: (for i holds ((i in ( Seg k1 ) implies ( Mhj . i ) = ( B . ( hj9 . i ) )) & ((not i in ( Seg k1 )) implies ( Mhj . i ) = ( AB . i )))) by A4,CKB82:1;
A56: ( len Mhj ) = n by MATRIX_1:24;
A57: ( len L ) = ( width B ) by MATRIX_1:def 7;
A58:now
A59: ( k + ( 0 ) ) < k1 by XREAL_1:8;
let i being Nat;
assume that
A60: 1 <= i
and
A61: i <= ( len Mhj );
A62: i in ( NAT ) by ORDINAL1:def 12;
then A63: i in ( Seg n ) by A56,A60,A61;
per cases ;
suppose A64: i <= k;

then i <= k1 by A59,XXREAL_0:2;
then A65: i in ( Seg k1 ) by A60,A62;
A66: ( Line (R,i) ) = ( R . i ) by A63,MATRIX_2:8;
A67: i in X by A60,A62,A64;
then A68: ( Mh . i ) = ( B . ( H . i ) ) by A32;
( dom H ) = X by A56,A60,A61,FUNCT_2:def 1;
then A69: ( H . i ) = ( hj . i ) by A52,A67,FUNCT_1:47;
A70: ( Line (Mh,i) ) = ( Mh . i ) by A63,MATRIX_2:8;
( Line (R,i) ) = ( Line (Mh,i) ) by A63,A59,A64,CKB42:1;
hence ( Mhj . i ) = ( R . i ) by A55,A66,A70,A68,A69,A65;
end;
suppose A71: (i > k & i <= k1);

A72: k1 in ( Seg k1 ) by FINSEQ_1:4;
A73: L = ( B . j ) by A51,MATRIX_2:8;
A74: ( R . i ) = ( Line (R,i) ) by A63,MATRIX_2:8;
A75: i = k1 by A71,NAT_1:9;
then L = ( Line (R,i) ) by A57,A47,A50,A63,CKB42:1;
hence ( Mhj . i ) = ( R . i ) by A53,A55,A75,A72,A74,A73;
end;
suppose A76: (i > k & i > k1);

then (not i in ( Seg k1 )) by FINSEQ_1:1;
then A77: ( Mhj . i ) = ( AB . i ) by A55;
A78: ( Line (R,i) ) = ( R . i ) by A63,MATRIX_2:8;
A79: (not i in X) by A76,FINSEQ_1:1;
A80: ( Line (Mh,i) ) = ( Mh . i ) by A63,MATRIX_2:8;
( Line (R,i) ) = ( Line (Mh,i) ) by A63,A76,CKB42:1;
hence ( Mhj . i ) = ( R . i ) by A32,A78,A80,A79,A77;
end;
end;
( len R ) = ( len Mh ) by CKB41:1;
then R = Mhj by A48,A56,A58,FINSEQ_1:14;
then consider Pathj being (FinSequence of K) such that A81: ( len Pathj ) = k1 and A82: (for m,j being Nat holds ((j in ( Seg k1 ) & m = ( hj . j )) implies ( Pathj . j ) = ( A * (j,m) ))) and A83: ( P1 . hj ) = ( ( mm "**" Pathj ) * ( Det R ) ) by A6,A54,A55;
A84: ( Pathj . k1 ) = ( A * (k1,j) ) by A53,A82,FINSEQ_1:4;
A85:now
A86: ( rng H ) c= Y by RELAT_1:def 19;
A87: X = ( dom H ) by A51,FUNCT_2:def 1;
let i being Nat;
assume that
A88: 1 <= i
and
A89: i <= ( len Path );
A90: ( ( Pathj | k ) . i ) = ( Pathj . i ) by A33,A89,FINSEQ_3:112;
A91: i in ( NAT ) by ORDINAL1:def 12;
then A92: i in X by A33,A88,A89;
then ( H . i ) in ( rng H ) by A87,FUNCT_1:def 3;
then ( H . i ) in Y by A86;
then reconsider Hi = ( H . i ) as Nat;
i <= k1 by A8,A33,A89,XXREAL_0:2;
then A93: i in ( Seg k1 ) by A88,A91;
i in X by A33,A88,A89,A91;
then A94: ( Path . i ) = ( A * (i,Hi) ) by A34;
( H . i ) = ( hj . i ) by A52,A92,A87,FUNCT_1:47;
hence ( Path . i ) = ( ( Pathj | X ) . i ) by A82,A93,A94,A90;
end;
( len ( Pathj | k ) ) = k by A8,A81,FINSEQ_1:59;
then Pathj = ( Path ^ <* ( Pathj . k1 ) *> ) by A33,A81,A85,FINSEQ_1:14,FINSEQ_3:55;
then A95: ( mm "**" Pathj ) = ( PA * ( A * (k1,j) ) ) by A84,FINSOP_1:4;
( QQ . j ) = hj by A20,A51,A52,A53;
hence thesis by A51,A83,A49,A95,FUNCT_1:12;
end;
now
let y;
assume that
A96: y in ( dom PS );
reconsider j = y as Nat by A96;
( SUM1 . j ) = ( ( A * (k1,j) ) * ( Det ( RLine (Mh,k1,( Line (B,j) )) ) ) ) by A43,A45,A96;
hence ( PS . y ) = ( PA * ( ( A * (k1,j) ) * ( Det ( RLine (Mh,k1,( Line (B,j) )) ) ) ) ) by A96,FVSUM_1:50
.= ( ( PA * ( A * (k1,j) ) ) * ( Det ( RLine (Mh,k1,( Line (B,j) )) ) ) ) by GROUP_1:def 3
.= ( ( P19 * QQ ) . y ) by A46,A45,A96;
end;
then PS = ( P19 * QQ ) by A37,A45,FUNCT_1:2;
then A97: ( PSaa | ( dom PS ) ) = ( P19 * QQ ) by SETWOP_2:21;
now
let x1 being set;
let x2 being set;
assume that
A98: x1 in Y
and
A99: x2 in Y
and
A100: ( QQ . x1 ) = ( QQ . x2 );
( Y \/ { x2 } ) = Y by A99,ZFMISC_1:40;
then A101: (ex h2 being (Function of Xx,Y) st (( h2 | X ) = H & ( h2 . k1 ) = x2)) by A11,STIRL2_1:57;
( Y \/ { x1 } ) = Y by A98,ZFMISC_1:40;
then consider h1 being (Function of Xx,Y) such that A102: ( h1 | X ) = H and A103: ( h1 . k1 ) = x1 by A11,STIRL2_1:57;
( QQ . x1 ) = h1 by A20,A98,A102,A103;
hence x1 = x2 by A20,A99,A100,A103,A101;
end;
then A104: QQ is  one-to-one by FUNCT_2:19;
reconsider Y9 = Y as (Element of ( Fin YY )) by FINSUB_1:def 5;
A105: ( dom QQ ) = Y9 by FUNCT_2:def 1;
A106: ( rng ( id Y ) ) = Y by RELAT_1:45;
( ( P19 * QQ ) * ( id Y ) ) = ( P19 * QQ ) by A37,RELAT_1:52;
then ( aa $$ (Y9,( P19 * QQ )) ) = ( aa $$ (( findom PS ),PSaa) ) by A45,A44,A106,A97,SETWOP_2:5
.= ( Sum PS ) by FVSUM_1:8,SETWOP_2:def 2
.= ( PA * ( Sum SUM1 ) ) by FVSUM_1:73
.= ( P . H ) by A35,A42;
hence thesis by A104,A38,A105,SETWOP_2:6;
end;
aa is  having_a_unity by FVSUM_1:8;
then ( Det AB ) = ( aa $$ (( FinOmega FUNC19 ),P19) ) by A1,A10,A11,A12,CKB81:1;
hence thesis by A6,A7;
end;
set FUN = ( Funcs (( Seg n ),( Seg n )) );
A107: n is (Element of ( NAT )) by ORDINAL1:def 12;
A108: P[ ( 0 ) ]
proof
reconsider E = ( {} ) as (Function of ( Seg ( 0 ) ),( Seg n )) by XBOOLE_1:2;
assume ( 0 ) <= n;
A109: ( the_unity_wrt mm ) = ( 1_ K ) by GROUP_1:22;
let FUNC being non  empty set;
assume that
A110: FUNC = ( Funcs (( Seg ( 0 ) ),( Seg n )) );
consider P being (Function of FUNC,KK) such that A111: FF[ P,( 0 ) ] by A1,A110,CKB83:1;
A112: FUNC = { E } by A110,FUNCT_5:57;
then A113: E in FUNC by TARSKI:def 1;
( FinOmega FUNC ) = { E } by A112,MATRIX_2:def 14;
then A114: ( aa $$ (( FinOmega FUNC ),P) ) = ( P . E ) by A113,SETWISEO:17;
consider M being (Matrix of n,K) such that A115: M = ( AB +* ( ( B * ( I +* E ) ) | (( Seg ( 0 ) ) qua set) ) ) and A116: (for j holds ((j in ( Seg ( 0 ) ) implies ( M . j ) = ( B . ( E . j ) )) & ((not j in ( Seg ( 0 ) )) implies ( M . j ) = ( AB . j )))) by A1,CKB82:1;
A117: M = AB by A115,FUNCT_4:21;
consider Path being (FinSequence of K) such that A118: ( len Path ) = ( 0 ) and (for Fj,j being Nat holds ((j in ( Seg ( 0 ) ) & Fj = ( E . j )) implies ( Path . j ) = ( A * (j,Fj) ))) and A119: ( P . E ) = ( ( mm $$ Path ) * ( Det M ) ) by A111,A115,A116;
Path = ( <*> KK ) by A118;
then ( mm "**" Path ) = ( 1_ K ) by A109,FINSOP_1:10;
then ( P . E ) = ( Det AB ) by A119,A117,VECTSP_1:def 4;
hence thesis by A111,A114;
end;
(for k being (Element of ( NAT )) holds P[ k ]) from NAT_1:sch 1(A108,A2);
then consider P being (Function of FUN,KK) such that A120: FF[ P,n ] and A121: ( Det AB ) = ( aa $$ (( FinOmega FUN ),P) ) by A107;
take P;
thus (for F being (Function of ( Seg n ),( Seg n )) holds (ex Path being (FinSequence of K) st ((( len Path ) = n & (for Fj,j being Nat holds ((j in ( Seg n ) & Fj = ( F . j )) implies ( Path . j ) = ( A * (j,Fj) )))) & ( P . F ) = ( ( (the multF of K) $$ Path ) * ( Det ( B * F ) ) ))))
proof
( len AB ) = n by MATRIX_1:24;
then A122: ( dom AB ) = ( Seg n ) by FINSEQ_1:def 3;
let F being (Function of ( Seg n ),( Seg n ));
A123: ( dom I ) = ( Seg n ) by FUNCT_2:52;
( dom F ) = ( Seg n ) by FUNCT_2:52;
then A124: ( I +* F ) = F by A123,FUNCT_4:19;
A125: ( len B ) = n by MATRIX_1:24;
A126: ( len ( B * F ) ) = ( len B ) by CKB54:def 1;
then A127: ( dom ( B * F ) ) = ( Seg n ) by A125,FINSEQ_1:def 3;
consider M being (Matrix of n,K) such that A128: M = ( AB +* ( ( B * ( I +* F ) ) | ( Seg n ) ) ) and A129: (for j holds ((j in ( Seg n ) implies ( M . j ) = ( B . ( F . j ) )) & ((not j in ( Seg n )) implies ( M . j ) = ( AB . j )))) by A1,CKB82:1;
( ( B * F ) | n ) = ( B * F ) by A126,A125,FINSEQ_1:58;
then M = ( B * F ) by A128,A124,A127,A122,FUNCT_4:19;
hence thesis by A120,A128,A129;
end;

thus thesis by A121;
end;
