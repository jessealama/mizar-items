environ
vocabularies NUMBERS,SUBSET_1,FINSEQ_2,MARGREL1,CARD_1,ARYTM_3,INT_2,NAT_1,RELAT_1,XXREAL_0,INT_1,ARYTM_1,GRCAT_1,XBOOLEAN,FINSEQ_1,PARTFUN1,FUNCT_1,POWER,BINARI_3,FUNCOP_1,XBOOLE_0,BINARITH,MATRIX_1,INCSP_1,ORDINAL4,FUNCT_7,FUNCT_2,TARSKI,TREES_1,IDEA_1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XCMPLX_0,INT_1,INT_2,NAT_1,NAT_D,MARGREL1,RELAT_1,FUNCT_1,FUNCOP_1,MATRIX_1,PARTFUN1,FUNCT_2,FUNCT_7,SERIES_1,FINSEQ_1,FINSEQ_2,RECDEF_1,BINARITH,BINARI_3,XXREAL_0,CKB8,CKB9,CKB12,CKB15,CKB17,CKB18,CKB19,CKB26,CKB29,CKB32,CKB33;
definitions TARSKI,FINSEQ_2,XBOOLEAN,CKB8,CKB9,CKB15,CKB17,CKB18,CKB19,CKB26,CKB29,CKB32,CKB33;
theorems NAT_1,NAT_2,NEWTON,INT_1,INT_2,FINSEQ_1,FINSEQ_2,FUNCT_1,FUNCT_2,FUNCT_7,FUNCOP_1,POWER,EULER_1,EULER_2,BINARITH,BINARI_3,MATRIX_1,RELSET_1,RELAT_1,XBOOLE_1,XREAL_1,XXREAL_0,XBOOLEAN,NAT_D,PARTFUN1,ORDINAL1,XREAL_0,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35;
schemes FINSEQ_1,FINSEQ_2,NAT_1,FUNCT_2;
registrations XBOOLE_0,RELAT_1,FUNCT_1,ORDINAL1,FUNCT_2,XXREAL_0,XREAL_0,NAT_1,INT_1,FINSEQ_1,MARGREL1,FUNCT_7,VALUED_0,CARD_1,FINSEQ_2,RELSET_1;
constructors PARTFUN1,XXREAL_0,NAT_1,NAT_D,SERIES_1,BINARITH,WSIERP_1,FUNCT_7,MATRIX_1,BINARI_3,RECDEF_1,RELSET_1,CKB8,CKB9,CKB12,CKB15,CKB17,CKB18,CKB19,CKB26,CKB29,CKB32,CKB33;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve i for (Element of ( NAT ));
reserve j for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
theorem
Th24: ((((( ( 2 to_power n ) + 1 ) is  prime & i is_expressible_by n) & j is_expressible_by n) & k is_expressible_by n) implies ( MUL_MOD (( MUL_MOD (i,j,n) ),k,n) ) = ( MUL_MOD (i,( MUL_MOD (j,k,n) ),n) ))
proof
assume that
A1: ( ( 2 to_power n ) + 1 ) is  prime
and
A2: i is_expressible_by n
and
A3: j is_expressible_by n
and
A4: k is_expressible_by n;
set J = ( ChangeVal_1 (j,n) );
A5: J > ( 0 ) by A3,CKB27:1;
set I = ( ChangeVal_1 (i,n) );
I <= ( 2 to_power n ) by A2,CKB27:1;
then A6: I < ( ( 2 to_power n ) + 1 ) by NAT_1:13;
J <= ( 2 to_power n ) by A3,CKB27:1;
then A7: J < ( ( 2 to_power n ) + 1 ) by NAT_1:13;
set K = ( ChangeVal_1 (k,n) );
A8: K > ( 0 ) by A4,CKB27:1;
K <= ( 2 to_power n ) by A4,CKB27:1;
then A9: K < ( ( 2 to_power n ) + 1 ) by NAT_1:13;
A10: I > ( 0 ) by A2,CKB27:1;
now
set CV = ( ( I * J ) mod ( ( 2 to_power n ) + 1 ) );
( ( I * J ) mod ( ( 2 to_power n ) + 1 ) ) < ( ( 2 to_power n ) + 1 ) by NAT_D:1;
then A11: ( ( I * J ) mod ( ( 2 to_power n ) + 1 ) ) <= ( 2 to_power n ) by NAT_1:13;
A12: CV <> ( 0 ) by A1,A6,A10,A7,A5,CKB7:1;
now
per cases  by A11,XXREAL_0:1;
suppose A13: CV = ( 2 to_power n );

then A14: ( MUL_MOD (( MUL_MOD (i,j,n) ),k,n) ) = ( ChangeVal_2 (( ( ( ChangeVal_1 (( 0 ),n) ) * K ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by CKB29:def 1
.= ( ChangeVal_2 (( ( CV * K ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by A13,CKB26:def 1
.= ( ChangeVal_2 (( ( ( I * J ) * K ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by EULER_2:8;
set CV2 = ( ( J * K ) mod ( ( 2 to_power n ) + 1 ) );
CV2 < ( ( 2 to_power n ) + 1 ) by NAT_D:1;
then A15: CV2 <= ( 2 to_power n ) by NAT_1:13;
A16: CV2 <> ( 0 ) by A1,A7,A5,A9,A8,CKB7:1;
now
per cases  by A15,XXREAL_0:1;
suppose A17: CV2 = ( 2 to_power n );

then ( MUL_MOD (i,( MUL_MOD (j,k,n) ),n) ) = ( ChangeVal_2 (( ( I * ( ChangeVal_1 (( 0 ),n) ) ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by CKB29:def 1
.= ( ChangeVal_2 (( ( I * CV2 ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by A17,CKB26:def 1
.= ( ChangeVal_2 (( ( I * ( J * K ) ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by EULER_2:8
.= ( ChangeVal_2 (( ( ( I * J ) * K ) mod ( ( 2 to_power n ) + 1 ) ),n) );
hence thesis by A14;
end;
suppose CV2 < ( 2 to_power n );

then ( MUL_MOD (j,k,n) ) = CV2 by CKB29:def 1;
then ( MUL_MOD (i,( MUL_MOD (j,k,n) ),n) ) = ( ChangeVal_2 (( ( I * CV2 ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by A16,CKB26:def 1
.= ( ChangeVal_2 (( ( I * ( J * K ) ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by EULER_2:8
.= ( ChangeVal_2 (( ( ( I * J ) * K ) mod ( ( 2 to_power n ) + 1 ) ),n) );
hence thesis by A14;
end;
end;
hence thesis;
end;
suppose CV < ( 2 to_power n );

then A18: ( MUL_MOD (( MUL_MOD (i,j,n) ),k,n) ) = ( ChangeVal_2 (( ( ( ChangeVal_1 (CV,n) ) * K ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by CKB29:def 1
.= ( ChangeVal_2 (( ( CV * K ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by A12,CKB26:def 1
.= ( ChangeVal_2 (( ( ( I * J ) * K ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by EULER_2:8;
set CV2 = ( ( J * K ) mod ( ( 2 to_power n ) + 1 ) );
CV2 < ( ( 2 to_power n ) + 1 ) by NAT_D:1;
then A19: CV2 <= ( 2 to_power n ) by NAT_1:13;
A20: CV2 <> ( 0 ) by A1,A7,A5,A9,A8,CKB7:1;
now
per cases  by A19,XXREAL_0:1;
suppose A21: CV2 = ( 2 to_power n );

then ( MUL_MOD (i,( MUL_MOD (j,k,n) ),n) ) = ( ChangeVal_2 (( ( I * ( ChangeVal_1 (( 0 ),n) ) ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by CKB29:def 1
.= ( ChangeVal_2 (( ( I * CV2 ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by A21,CKB26:def 1
.= ( ChangeVal_2 (( ( I * ( J * K ) ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by EULER_2:8
.= ( ChangeVal_2 (( ( ( I * J ) * K ) mod ( ( 2 to_power n ) + 1 ) ),n) );
hence thesis by A18;
end;
suppose CV2 < ( 2 to_power n );

then ( MUL_MOD (j,k,n) ) = CV2 by CKB29:def 1;
then ( MUL_MOD (i,( MUL_MOD (j,k,n) ),n) ) = ( ChangeVal_2 (( ( I * CV2 ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by A20,CKB26:def 1
.= ( ChangeVal_2 (( ( I * ( J * K ) ) mod ( ( 2 to_power n ) + 1 ) ),n) ) by EULER_2:8
.= ( ChangeVal_2 (( ( ( I * J ) * K ) mod ( ( 2 to_power n ) + 1 ) ),n) );
hence thesis by A18;
end;
end;
hence thesis;
end;
end;
hence thesis;
end;
hence thesis;
end;
