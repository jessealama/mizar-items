environ
vocabularies XBOOLE_0,PBOOLE,SUBSET_1,NUMBERS,FINSEQ_1,STRUCT_0,MSUALG_1,RELAT_1,XXREAL_0,ARYTM_3,FUNCT_1,MSUALG_5,EQREL_1,TARSKI,LATTICES,XXREAL_2,REWRITE1,LATTICE3,SETFAM_1,ZFMISC_1,CARD_1,MSUALG_4,CLOSURE2,NAT_1,MARGREL1,PARTFUN1,FUNCT_4,FINSET_1,CARD_3,MSUALG_6,MSUALG_7,MSUALG_8;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,RELAT_1,RELSET_1,DOMAIN_1,NUMBERS,STRUCT_0,NAT_1,BINOP_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSET_1,FINSEQ_1,CARD_3,REWRITE1,EQREL_1,LATTICES,LATTICE3,PBOOLE,MSSUBFAM,MSUALG_1,MSUALG_4,MSUALG_5,CLOSURE2,MSUALG_6,MSUALG_7,XXREAL_0,CKB15,CKB16,CKB22,CKB23;
definitions TARSKI,XBOOLE_0,EQREL_1,CKB15,CKB16,CKB23;
theorems XBOOLE_0,TARSKI,PBOOLE,NAT_LAT,MSUALG_4,MSUALG_5,MSUALG_7,CLOSURE2,SETFAM_1,LATTICES,LATTICE3,MSSUBFAM,ZFMISC_1,FINSEQ_1,SUBSET_1,REWRITE1,RELAT_1,MSUALG_6,FUNCT_2,NAT_1,EQREL_1,VECTSP_8,CARD_3,XBOOLE_1,PARTFUN1,CKB1,CKB3,CKB5,CKB6,CKB7,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB23,CKB24;
schemes FINSEQ_1,PARTFUN1,CLASSES1,CKB2;
registrations SUBSET_1,RELSET_1,PARTFUN1,FINSET_1,MEMBERED,EQREL_1,PBOOLE,STRUCT_0,LATTICES,MSUALG_1,MSUALG_3,MSUALG_5,CLOSURE2,MSUALG_6,MSUALG_7,FUNCT_1,CKB4,CKB8;
constructors SETFAM_1,BINOP_1,XXREAL_0,NAT_1,MEMBERED,REALSET1,REWRITE1,MSSUBFAM,LATTICE3,MSUALG_5,CLOSURE2,MSUALG_6,MSUALG_7,RELSET_1,CKB15,CKB16,CKB23;
requirements NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve S for non void non empty ManySortedSign;
reserve A for  non-empty MSAlgebra over S;
theorem
Th18: (for X being (Subset of ( CongrLatt A )) holds ( "\/" (X,( EqRelLatt (the Sorts of A) )) ) is (MSCongruence of A))
proof
let X9 being (Subset of ( CongrLatt A ));
set M = (the Sorts of A);
set E = ( EqRelLatt M );
(the carrier of ( CongrLatt A )) c= (the carrier of ( EqRelLatt M )) by NAT_LAT:def 12;
then reconsider X = X9 as (Subset of ( EqRelLatt M )) by XBOOLE_1:1;
reconsider V = ( "\/" (X,E) ) as (Equivalence_Relation of M) by MSUALG_5:def 5;
reconsider V as (ManySortedRelation of A);
reconsider V as  MSEquivalence-like (ManySortedRelation of A) by MSUALG_4:def 3;
(for s1,s2 being (SortSymbol of S) holds (for t being Function holds (t is_e.translation_of A,s1,s2 implies (for a,b being set holds ([ a,b ] in ( V . s1 ) implies [ ( t . a ),( t . b ) ] in ( V . s2 ))))))
proof
let s1 being (SortSymbol of S),s2 being (SortSymbol of S);
let t being Function;
assume A1: t is_e.translation_of A,s1,s2;
then reconsider t9 = t as (Function of ( M . s1 ),( M . s2 )) by MSUALG_6:11;
let a being set,b being set;
assume A2: [ a,b ] in ( V . s1 );
then A3: a in ( M . s1 ) by ZFMISC_1:87;
A4: b in ( M . s1 ) by A2,ZFMISC_1:87;
then A5: ( t9 . b ) in ( M . s2 ) by FUNCT_2:5;
[ a,b ] in ( "\/" ( EqRelSet (X,s1) ) ) by A2,CKB24:1;
then consider f being FinSequence such that A6: 1 <= ( len f ) and A7: a = ( f . 1 ) and A8: b = ( f . ( len f ) ) and A9: (for i being (Element of ( NAT )) holds ((1 <= i & i < ( len f )) implies [ ( f . i ),( f . ( i + 1 ) ) ] in ( union ( EqRelSet (X,s1) ) ))) by A3,A4,CKB13:1;
A10: (ex g being FinSequence st (((1 <= ( len g ) & ( t . a ) = ( g . 1 )) & ( t . b ) = ( g . ( len g ) )) & (for i being (Element of ( NAT )) holds ((1 <= i & i < ( len g )) implies [ ( g . i ),( g . ( i + 1 ) ) ] in ( union ( EqRelSet (X,s2) ) )))))
proof
deffunc F(set) = ( t . ( f . $1 ) );
consider g being FinSequence such that A11: (( len g ) = ( len f ) & (for k being Nat holds (k in ( dom g ) implies ( g . k ) = F(k)))) from FINSEQ_1:sch 2;
take g;
thus 1 <= ( len g ) by A6,A11;
A12: ( dom g ) = ( Seg ( len f ) ) by A11,FINSEQ_1:def 3;
1 in ( Seg ( len f ) ) by A6,FINSEQ_1:1;
hence ( g . 1 ) = ( t . a ) by A7,A11,A12;
( len g ) in ( Seg ( len f ) ) by A6,A11,FINSEQ_1:1;
hence ( g . ( len g ) ) = ( t . b ) by A8,A11,A12;
let j being (Element of ( NAT ));
assume that
A13: 1 <= j
and
A14: j < ( len g );
A15: 1 <= ( j + 1 ) by A13,NAT_1:13;
[ ( f . j ),( f . ( j + 1 ) ) ] in ( union ( EqRelSet (X,s1) ) ) by A9,A11,A13,A14;
then consider Z being set such that A16: [ ( f . j ),( f . ( j + 1 ) ) ] in Z and A17: Z in ( EqRelSet (X,s1) ) by TARSKI:def 4;
consider Eq being (Equivalence_Relation of M) such that A18: Z = ( Eq . s1 ) and A19: Eq in X by A17,CKB23:def 1;
reconsider Eq as (ManySortedRelation of A);
reconsider Eq as  MSEquivalence-like (ManySortedRelation of A) by MSUALG_4:def 3;
Eq is (MSCongruence of A) by A19,MSUALG_5:def 6;
then reconsider Eq as  compatible  MSEquivalence-like (ManySortedRelation of A) by MSUALG_6:27;
(ex W being set st ([ ( t . ( f . j ) ),( t . ( f . ( j + 1 ) ) ) ] in W & W in ( EqRelSet (X,s2) )))
proof
take W = ( Eq . s2 );
thus [ ( t . ( f . j ) ),( t . ( f . ( j + 1 ) ) ) ] in W by A1,A16,A18,MSUALG_6:def 8;
thus thesis by A19,CKB23:def 1;
end;
then A20: [ ( t . ( f . j ) ),( t . ( f . ( j + 1 ) ) ) ] in ( union ( EqRelSet (X,s2) ) ) by TARSKI:def 4;
( j + 1 ) <= ( len f ) by A11,A14,NAT_1:13;
then A21: ( j + 1 ) in ( Seg ( len f ) ) by A15,FINSEQ_1:1;
j in ( Seg ( len f ) ) by A11,A13,A14,FINSEQ_1:1;
then ( g . j ) = ( t . ( f . j ) ) by A11,A12;
hence thesis by A11,A12,A20,A21;
end;
( t9 . a ) in ( M . s2 ) by A3,FUNCT_2:5;
then [ ( t . a ),( t . b ) ] in ( "\/" ( EqRelSet (X,s2) ) ) by A5,A10,CKB13:1;
hence thesis by CKB24:1;
end;
then reconsider V as  invariant  MSEquivalence-like (ManySortedRelation of A) by MSUALG_6:def 8;
V is  compatible;
hence thesis by MSUALG_6:27;
end;
