environ
vocabularies VECTSP_1,SUBSET_1,FINSET_1,RLVECT_2,FUNCT_1,STRUCT_0,RLVECT_3,CARD_3,SUPINF_2,XBOOLE_0,TARSKI,GROUP_1,FUNCT_2,RELAT_1,ARYTM_1,ARYTM_3,MESFUNC1,RLSUB_1,ZFMISC_1,ORDINAL1,ORDERS_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,FUNCT_2,FINSET_1,ORDERS_1,DOMAIN_1,STRUCT_0,ORDINAL1,RLVECT_1,GROUP_1,VECTSP_1,VECTSP_4,VECTSP_5,VECTSP_6,CKB1,CKB2,CKB11;
definitions XBOOLE_0,VECTSP_4,VECTSP_6,TARSKI,CKB1,CKB11;
theorems FUNCT_1,FINSET_1,ORDERS_1,RLVECT_3,TARSKI,VECTSP_1,VECTSP_2,VECTSP_4,VECTSP_5,VECTSP_6,ZFMISC_1,RLVECT_1,FUNCT_2,RELAT_1,ORDINAL1,XBOOLE_0,XBOOLE_1,CARD_2,STRUCT_0,CKB1,CKB3,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21;
schemes FUNCT_1,FUNCT_2,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELSET_1,FINSET_1,STRUCT_0,VECTSP_1,VECTSP_4,CKB5,CKB6;
constructors ORDERS_1,REALSET1,VECTSP_5,VECTSP_6,CKB1,CKB11;
requirements SUBSET,BOOLE;
begin
reserve x for set;
reserve y for set;
reserve X for set;
reserve Y for set;
reserve Z for set;
reserve GF for Field;
reserve V for (VectSp of GF);
reserve v for (Vector of V);
reserve u for (Vector of V);
reserve A for (Subset of V);
reserve B for (Subset of V);
reserve l for (Linear_Combination of A);
reserve f for (Function of (the carrier of V),(the carrier of GF));
reserve g for (Function of (the carrier of V),(the carrier of GF));
theorem
Th22: (for V being (VectSp of GF) holds (for A being (Subset of V) holds (A is  linearly-independent implies (ex B being (Subset of V) st ((A c= B & B is  linearly-independent) & ( Lin B ) = ( the VectSpStr of V ))))))
proof
let V being (VectSp of GF);
let A being (Subset of V);
defpred P[ set ]
 means
(ex B being (Subset of V) st ((B = $1 & A c= B) & B is  linearly-independent));
consider Q being set such that A1: (for Z holds (Z in Q iff (Z in ( bool (the carrier of V) ) & P[ Z ]))) from XBOOLE_0:sch 1;
A2:now
let Z;
assume that
A3: Z <> ( {} )
and
A4: Z c= Q
and
A5: Z is  c=-linear;
set W = ( union Z );
W c= (the carrier of V)
proof
let x;
assume x in W;
then consider X such that A6: x in X and A7: X in Z by TARSKI:def 4;
X in ( bool (the carrier of V) ) by A1,A4,A7;
hence thesis by A6;
end;
then reconsider W as (Subset of V);
A8: W is  linearly-independent
proof
deffunc F(set) = { C where C is (Subset of V): ($1 in C & C in Z) };
let l being (Linear_Combination of W);
assume that
A9: ( Sum l ) = ( 0. V )
and
A10: ( Carrier l ) <> ( {} );
consider f being Function such that A11: ( dom f ) = ( Carrier l ) and A12: (for x holds (x in ( Carrier l ) implies ( f . x ) = F(x))) from FUNCT_1:sch 3;
reconsider M = ( rng f ) as non  empty set by A10,A11,RELAT_1:42;
set F = the (Choice_Function of M);
set S = ( rng F );
A13:now
assume ( {} ) in M;
then consider x such that A14: x in ( dom f ) and A15: ( f . x ) = ( {} ) by FUNCT_1:def 3;
( Carrier l ) c= W by VECTSP_6:def 4;
then consider X such that A16: x in X and A17: X in Z by A11,A14,TARSKI:def 4;
reconsider X as (Subset of V) by A1,A4,A17;
X in { C where C is (Subset of V): (x in C & C in Z) } by A16,A17;
hence contradiction by A11,A12,A14,A15;
end;
then A18: ( dom F ) = M by RLVECT_3:28;
then ( dom F ) is  finite by A11,FINSET_1:8;
then A19: S is  finite by FINSET_1:8;
A20:now
let X;
assume X in S;
then consider x such that A21: x in ( dom F ) and A22: ( F . x ) = X by FUNCT_1:def 3;
consider y such that A23: (y in ( dom f ) & ( f . y ) = x) by A18,A21,FUNCT_1:def 3;
A24: x = { C where C is (Subset of V): (y in C & C in Z) } by A11,A12,A23;
X in x by A13,A18,A21,A22,ORDERS_1:def 1;
then (ex C being (Subset of V) st ((C = X & y in C) & C in Z)) by A24;
hence X in Z;
end;
A25:now
let X;
let Y;
assume (X in S & Y in S);
then (X in Z & Y in Z) by A20;
then X,Y are_c=-comparable  by A5,ORDINAL1:def 8;
hence (X c= Y or Y c= X) by XBOOLE_0:def 9;
end;
S <> ( {} ) by A18,RELAT_1:42;
then ( union S ) in S by A25,A19,CARD_2:62;
then ( union S ) in Z by A20;
then consider B being (Subset of V) such that A26: B = ( union S ) and A c= B and A27: B is  linearly-independent by A1,A4;
( Carrier l ) c= ( union S )
proof
let x;
set X = ( f . x );
assume A28: x in ( Carrier l );
then A29: ( f . x ) = { C where C is (Subset of V): (x in C & C in Z) } by A12;
A30: ( f . x ) in M by A11,A28,FUNCT_1:def 3;
then ( F . X ) in X by A13,ORDERS_1:def 1;
then A31: (ex C being (Subset of V) st ((( F . X ) = C & x in C) & C in Z)) by A29;
( F . X ) in S by A18,A30,FUNCT_1:def 3;
hence thesis by A31,TARSKI:def 4;
end;
then l is (Linear_Combination of B) by A26,VECTSP_6:def 4;
hence thesis by A9,A10,A27,CKB1:def 1;
end;
set x = the (Element of Z);
x in Q by A3,A4,TARSKI:def 3;
then A32: (ex B being (Subset of V) st ((B = x & A c= B) & B is  linearly-independent)) by A1;
x c= W by A3,ZFMISC_1:74;
then A c= W by A32,XBOOLE_1:1;
hence ( union Z ) in Q by A1,A8;
end;
assume A is  linearly-independent;
then Q <> ( {} ) by A1;
then consider X such that A33: X in Q and A34: (for Z holds ((Z in Q & Z <> X) implies (not X c= Z))) by A2,ORDERS_1:67;
consider B being (Subset of V) such that A35: B = X and A36: A c= B and A37: B is  linearly-independent by A1,A33;
take B;
thus (A c= B & B is  linearly-independent) by A36,A37;
assume ( Lin B ) <> ( the VectSpStr of V );
then consider v being (Vector of V) such that A38: (not (v in ( Lin B ) iff v in ( (Omega). V ))) by VECTSP_4:30;
A39: ( B \/ { v } ) is  linearly-independent
proof
let l being (Linear_Combination of ( B \/ { v } ));
assume A40: ( Sum l ) = ( 0. V );
now
per cases ;
suppose v in ( Carrier l );

then ( l . v ) <> ( 0. GF ) by VECTSP_6:2;
then A41: ( - ( l . v ) ) <> ( 0. GF ) by VECTSP_2:3;
deffunc G(set) = ( 0. GF );
deffunc F((Vector of V)) = ( l . $1 );
consider f being (Function of (the carrier of V),(the carrier of GF)) such that A42: ( f . v ) = ( 0. GF ) and A43: (for u being (Vector of V) holds (u <> v implies ( f . u ) = F(u))) from FUNCT_2:sch 6;
reconsider f as (Element of ( Funcs ((the carrier of V),(the carrier of GF)) )) by FUNCT_2:8;
now
let u being (Vector of V);
assume (not u in ( ( Carrier l ) \ { v } ));
then ((not u in ( Carrier l )) or u in { v }) by XBOOLE_0:def 5;
then ((( l . u ) = ( 0. GF ) & u <> v) or u = v) by TARSKI:def 1;
hence ( f . u ) = ( 0. GF ) by A42,A43;
end;
then reconsider f as (Linear_Combination of V) by VECTSP_6:def 1;
( Carrier f ) c= B
proof
let x;
A44: ( Carrier l ) c= ( B \/ { v } ) by VECTSP_6:def 4;
assume x in ( Carrier f );
then consider u being (Vector of V) such that A45: u = x and A46: ( f . u ) <> ( 0. GF );
( f . u ) = ( l . u ) by A42,A43,A46;
then u in ( Carrier l ) by A46;
then (u in B or u in { v }) by A44,XBOOLE_0:def 3;
hence thesis by A42,A45,A46,TARSKI:def 1;
end;
then reconsider f as (Linear_Combination of B) by VECTSP_6:def 4;
consider g being (Function of (the carrier of V),(the carrier of GF)) such that A47: ( g . v ) = ( - ( l . v ) ) and A48: (for u being (Vector of V) holds (u <> v implies ( g . u ) = G(u))) from FUNCT_2:sch 6;
reconsider g as (Element of ( Funcs ((the carrier of V),(the carrier of GF)) )) by FUNCT_2:8;
now
let u being (Vector of V);
assume (not u in { v });
then u <> v by TARSKI:def 1;
hence ( g . u ) = ( 0. GF ) by A48;
end;
then reconsider g as (Linear_Combination of V) by VECTSP_6:def 1;
( Carrier g ) c= { v }
proof
let x;
assume x in ( Carrier g );
then (ex u being (Vector of V) st (x = u & ( g . u ) <> ( 0. GF )));
then x = v by A48;
hence thesis by TARSKI:def 1;
end;
then reconsider g as (Linear_Combination of { v }) by VECTSP_6:def 4;
A49: ( Sum g ) = ( ( - ( l . v ) ) * v ) by A47,VECTSP_6:17;
( f - g ) = l
proof
let u being (Vector of V);
now
per cases ;
suppose A50: v = u;

thus ( ( f - g ) . u ) = ( ( f . u ) - ( g . u ) ) by VECTSP_6:40
.= ( ( 0. GF ) + ( - ( - ( l . v ) ) ) ) by A42,A47,A50,RLVECT_1:def 11
.= ( ( l . v ) + ( 0. GF ) ) by RLVECT_1:17
.= ( l . u ) by A50,RLVECT_1:4;
end;
suppose A51: v <> u;

thus ( ( f - g ) . u ) = ( ( f . u ) - ( g . u ) ) by VECTSP_6:40
.= ( ( l . u ) - ( g . u ) ) by A43,A51
.= ( ( l . u ) - ( 0. GF ) ) by A48,A51
.= ( l . u ) by RLVECT_1:13;
end;
end;
hence thesis;
end;
then ( 0. V ) = ( ( Sum f ) - ( Sum g ) ) by A40,VECTSP_6:47;
then ( Sum f ) = ( ( 0. V ) + ( Sum g ) ) by VECTSP_2:2
.= ( ( - ( l . v ) ) * v ) by A49,RLVECT_1:4;
then A52: ( ( - ( l . v ) ) * v ) in ( Lin B ) by CKB12:1;
( ( ( - ( l . v ) ) " ) * ( ( - ( l . v ) ) * v ) ) = ( ( ( ( - ( l . v ) ) " ) * ( - ( l . v ) ) ) * v ) by VECTSP_1:def 16
.= ( ( 1_ GF ) * v ) by A41,VECTSP_1:def 10
.= v by VECTSP_1:def 17;
hence thesis by A38,A52,RLVECT_1:1,VECTSP_4:21;
end;
suppose A53: (not v in ( Carrier l ));

( Carrier l ) c= B
proof
let x;
assume A54: x in ( Carrier l );
( Carrier l ) c= ( B \/ { v } ) by VECTSP_6:def 4;
then (x in B or x in { v }) by A54,XBOOLE_0:def 3;
hence thesis by A53,A54,TARSKI:def 1;
end;
then l is (Linear_Combination of B) by VECTSP_6:def 4;
hence thesis by A37,A40,CKB1:def 1;
end;
end;
hence thesis;
end;
v in { v } by TARSKI:def 1;
then A55: v in ( B \/ { v } ) by XBOOLE_0:def 3;
A56: (not v in B) by A38,CKB13:1,RLVECT_1:1;
B c= ( B \/ { v } ) by XBOOLE_1:7;
then A c= ( B \/ { v } ) by A36,XBOOLE_1:1;
then ( B \/ { v } ) in Q by A1,A39;
hence contradiction by A34,A35,A55,A56,XBOOLE_1:7;
end;
