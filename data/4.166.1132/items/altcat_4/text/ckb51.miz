environ
vocabularies ALTCAT_1,XBOOLE_0,CAT_1,RELAT_1,ALTCAT_3,CAT_3,RELAT_2,FUNCTOR0,FUNCT_1,FUNCT_2,ZFMISC_1,STRUCT_0,PBOOLE,MSUALG_3,MSUALG_6,ALTCAT_2,REALSET1,TARSKI,ALTCAT_4;
notations TARSKI,XBOOLE_0,ZFMISC_1,MCART_1,RELAT_1,FUNCT_1,FUNCT_2,BINOP_1,MULTOP_1,PBOOLE,REALSET1,STRUCT_0,MSUALG_3,ALTCAT_1,ALTCAT_2,ALTCAT_3,FUNCTOR0,CKB45,CKB47,CKB49;
definitions ALTCAT_1,ALTCAT_3,FUNCTOR0,MSUALG_3,STRUCT_0,TARSKI,FUNCT_2,XBOOLE_0,PBOOLE,BINOP_1,REALSET1,ALTCAT_2,CKB45,CKB47,CKB49;
theorems ALTCAT_1,ALTCAT_2,ALTCAT_3,FUNCT_1,FUNCT_2,FUNCTOR0,MCART_1,MULTOP_1,FUNCTOR1,FUNCTOR2,MSUALG_3,PBOOLE,RELAT_1,ZFMISC_1,XBOOLE_0,XBOOLE_1,PARTFUN1,CKB2,CKB3,CKB4,CKB5,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB47,CKB49;
schemes PBOOLE,XBOOLE_0;
registrations SUBSET_1,RELSET_1,FUNCOP_1,STRUCT_0,FUNCT_1,RELAT_1,ALTCAT_1,ALTCAT_2,FUNCTOR0,FUNCTOR2,PBOOLE,CKB1,CKB6,CKB7,CKB39,CKB46,CKB48,CKB50;
constructors REALSET1,MSUALG_3,FUNCTOR0,ALTCAT_3,RELSET_1,CKB45,CKB47,CKB49;
requirements SUBSET,BOOLE;
begin
reserve C for category;
reserve o1 for (object of C);
reserve o2 for (object of C);
Lm1:now
let C being non  empty  transitive AltCatStr;
let p1 being (object of C);
let p2 being (object of C);
let p3 being (object of C);
assume that
A1: ( (the Arrows of C) . (p1,p3) ) = ( {} );
thus [: ( (the Arrows of C) . (p2,p3) ),( (the Arrows of C) . (p1,p2) ) :] = ( {} )
proof
assume [: ( (the Arrows of C) . (p2,p3) ),( (the Arrows of C) . (p1,p2) ) :] <> ( {} );
then consider k being set such that A2: k in [: ( (the Arrows of C) . (p2,p3) ),( (the Arrows of C) . (p1,p2) ) :] by XBOOLE_0:def 1;
consider u1,u2 being set such that A3: (u1 in ( (the Arrows of C) . (p2,p3) ) & u2 in ( (the Arrows of C) . (p1,p2) )) and k = [ u1,u2 ] by A2,ZFMISC_1:def 2;
(u1 in <^ p2,p3 ^> & u2 in <^ p1,p2 ^>) by A3;
then <^ p1,p3 ^> <> ( {} ) by ALTCAT_1:def 2;
hence contradiction by A1;
end;

end;
definition
let C being category;
func AllCoretr C ->  strict non  empty  transitive (SubCatStr of C) means 
:Def4: (((the carrier of it) = (the carrier of C) & (the Arrows of it) cc= (the Arrows of C)) & (for o1,o2 being (object of C) holds (for m being (Morphism of o1,o2) holds (m in ( (the Arrows of it) . (o1,o2) ) iff ((<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) & m is  coretraction)))));
existence
proof
defpred P[ set,set ]
 means
(for x being set holds (x in $2 iff (ex o1,o2 being (object of C) st (ex m being (Morphism of o1,o2) st (((($1 = [ o1,o2 ] & <^ o1,o2 ^> <> ( {} )) & <^ o2,o1 ^> <> ( {} )) & x = m) & m is  coretraction)))));
set I = (the carrier of C);
A1: (for i being set holds (i in [: I,I :] implies (ex X being set st P[ i,X ])))
proof
let i being set;
assume i in [: I,I :];
then consider o1,o2 being set such that A2: (o1 in I & o2 in I) and A3: i = [ o1,o2 ] by ZFMISC_1:84;
reconsider o1,o2 as (object of C) by A2;
defpred P[ set ]
 means
(ex m being (Morphism of o1,o2) st (((<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) & m = $1) & m is  coretraction));
consider X being set such that A4: (for x being set holds (x in X iff (x in ( (the Arrows of C) . (o1,o2) ) & P[ x ]))) from XBOOLE_0:sch 1;
take X;
let x being set;
thus (x in X implies (ex o1,o2 being (object of C) st (ex m being (Morphism of o1,o2) st ((((i = [ o1,o2 ] & <^ o1,o2 ^> <> ( {} )) & <^ o2,o1 ^> <> ( {} )) & x = m) & m is  coretraction))))
proof
assume x in X;
then consider m being (Morphism of o1,o2) such that A5: (((<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) & m = x) & m is  coretraction) by A4;
take o1;
take o2;
take m;
thus thesis by A3,A5;
end;

given p1 being (object of C),p2 being (object of C),m being (Morphism of p1,p2) such that
A6: i = [ p1,p2 ]
and
A7: (((<^ p1,p2 ^> <> ( {} ) & <^ p2,p1 ^> <> ( {} )) & x = m) & m is  coretraction);

(o1 = p1 & o2 = p2) by A3,A6,ZFMISC_1:27;
hence thesis by A4,A7;
end;
consider Ar being (ManySortedSet of [: I,I :]) such that A8: (for i being set holds (i in [: I,I :] implies P[ i,( Ar . i ) ])) from PBOOLE:sch 3(A1);
defpred R[ set,set ]
 means
(ex p1,p2,p3 being (object of C) st ($1 = [ p1,p2,p3 ] & $2 = ( ( (the Comp of C) . (p1,p2,p3) ) | ([: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] qua set) )));
A9: (for i being set holds (i in [: I,I,I :] implies (ex j being set st R[ i,j ])))
proof
let i being set;
assume i in [: I,I,I :];
then consider p1,p2,p3 being set such that A10: ((p1 in I & p2 in I) & p3 in I) and A11: i = [ p1,p2,p3 ] by MCART_1:68;
reconsider p1,p2,p3 as (object of C) by A10;
take ( ( (the Comp of C) . (p1,p2,p3) ) | ([: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] qua set) );
take p1;
take p2;
take p3;
thus i = [ p1,p2,p3 ] by A11;
thus thesis;
end;
consider Co being (ManySortedSet of [: I,I,I :]) such that A12: (for i being set holds (i in [: I,I,I :] implies R[ i,( Co . i ) ])) from PBOOLE:sch 3(A9);
A13: Ar cc= (the Arrows of C)
proof
thus [: I,I :] c= [: (the carrier of C),(the carrier of C) :];
let i being set;
assume A14: i in [: I,I :];
let q being set;
assume q in ( Ar . i );
then (ex p1,p2 being (object of C) st (ex m being (Morphism of p1,p2) st ((((i = [ p1,p2 ] & <^ p1,p2 ^> <> ( {} )) & <^ p2,p1 ^> <> ( {} )) & q = m) & m is  coretraction))) by A8,A14;
hence thesis;
end;
Co is (ManySortedFunction of {| Ar,Ar |},{| Ar |})
proof
let i being set;
assume i in [: I,I,I :];
then consider p1,p2,p3 being (object of C) such that A15: i = [ p1,p2,p3 ] and A16: ( Co . i ) = ( ( (the Comp of C) . (p1,p2,p3) ) | ([: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] qua set) ) by A12;
A17: [ p1,p2 ] in [: I,I :] by ZFMISC_1:def 2;
then A18: ( Ar . [ p1,p2 ] ) c= ( (the Arrows of C) . (p1,p2) ) by A13,ALTCAT_2:def 2;
A19: [ p2,p3 ] in [: I,I :] by ZFMISC_1:def 2;
then ( Ar . [ p2,p3 ] ) c= ( (the Arrows of C) . (p2,p3) ) by A13,ALTCAT_2:def 2;
then A20: [: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] c= [: ( (the Arrows of C) . (p2,p3) ),( (the Arrows of C) . (p1,p2) ) :] by A18,ZFMISC_1:96;
(( (the Arrows of C) . (p1,p3) ) = ( {} ) implies [: ( (the Arrows of C) . (p2,p3) ),( (the Arrows of C) . (p1,p2) ) :] = ( {} )) by Lm1;
then reconsider f = ( Co . i ) as (Function of [: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :],( (the Arrows of C) . (p1,p3) )) by A16,A20,FUNCT_2:32;
A21: ( Ar . [ p1,p2 ] ) c= ( (the Arrows of C) . [ p1,p2 ] ) by A13,A17,ALTCAT_2:def 2;
A22: ( Ar . [ p2,p3 ] ) c= ( (the Arrows of C) . [ p2,p3 ] ) by A13,A19,ALTCAT_2:def 2;
A23: (( (the Arrows of C) . (p1,p3) ) = ( {} ) implies [: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] = ( {} ))
proof
assume A24: ( (the Arrows of C) . (p1,p3) ) = ( {} );
assume [: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] <> ( {} );
then consider k being set such that A25: k in [: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] by XBOOLE_0:def 1;
consider u1,u2 being set such that A26: (u1 in ( Ar . (p2,p3) ) & u2 in ( Ar . (p1,p2) )) and k = [ u1,u2 ] by A25,ZFMISC_1:def 2;
(u1 in <^ p2,p3 ^> & u2 in <^ p1,p2 ^>) by A22,A21,A26;
then <^ p1,p3 ^> <> ( {} ) by ALTCAT_1:def 2;
hence contradiction by A24;
end;
A27: ( {| Ar |} . (p1,p2,p3) ) = ( Ar . (p1,p3) ) by ALTCAT_1:def 3;
A28: ( rng f ) c= ( {| Ar |} . i )
proof
let q being set;
assume q in ( rng f );
then consider x being set such that A29: x in ( dom f ) and A30: q = ( f . x ) by FUNCT_1:def 3;
A31: ( dom f ) = [: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] by A23,FUNCT_2:def 1;
then consider m1,m2 being set such that A32: m1 in ( Ar . (p2,p3) ) and A33: m2 in ( Ar . (p1,p2) ) and A34: x = [ m1,m2 ] by A29,ZFMISC_1:84;
[ p2,p3 ] in [: I,I :] by ZFMISC_1:def 2;
then consider q2,q3 being (object of C),qq being (Morphism of q2,q3) such that A35: [ p2,p3 ] = [ q2,q3 ] and A36: <^ q2,q3 ^> <> ( {} ) and A37: <^ q3,q2 ^> <> ( {} ) and A38: m1 = qq and A39: qq is  coretraction by A8,A32;
[ p1,p2 ] in [: I,I :] by ZFMISC_1:def 2;
then consider r1,r2 being (object of C),rr being (Morphism of r1,r2) such that A40: [ p1,p2 ] = [ r1,r2 ] and A41: <^ r1,r2 ^> <> ( {} ) and A42: <^ r2,r1 ^> <> ( {} ) and A43: m2 = rr and A44: rr is  coretraction by A8,A33;
A45: (ex o1,o3 being (object of C) st (ex m being (Morphism of o1,o3) st (((([ p1,p3 ] = [ o1,o3 ] & <^ o1,o3 ^> <> ( {} )) & <^ o3,o1 ^> <> ( {} )) & q = m) & m is  coretraction)))
proof
A46: p2 = q2 by A35,ZFMISC_1:27;
then reconsider mm = qq as (Morphism of r2,q3) by A40,ZFMISC_1:27;
take r1;
take q3;
take ( mm * rr );
A47: p1 = r1 by A40,ZFMISC_1:27;
hence [ p1,p3 ] = [ r1,q3 ] by A35,ZFMISC_1:27;
A48: r2 = p2 by A40,ZFMISC_1:27;
hence A49: (<^ r1,q3 ^> <> ( {} ) & <^ q3,r1 ^> <> ( {} )) by A36,A37,A41,A42,A46,ALTCAT_1:def 2;
A50: p3 = q3 by A35,ZFMISC_1:27;
thus q = ( ( (the Comp of C) . (p1,p2,p3) ) . (mm,rr) ) by A16,A29,A30,A31,A34,A38,A43,FUNCT_1:49
.= ( mm * rr ) by A35,A36,A41,A48,A47,A50,ALTCAT_1:def 8;
thus thesis by A36,A39,A41,A44,A48,A46,A49,ALTCAT_3:19;
end;
[ p1,p3 ] in [: I,I :] by ZFMISC_1:def 2;
then q in ( Ar . [ p1,p3 ] ) by A8,A45;
hence thesis by A15,A27,MULTOP_1:def 1;
end;
( {| Ar,Ar |} . (p1,p2,p3) ) = [: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] by ALTCAT_1:def 4;
then [: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] = ( {| Ar,Ar |} . i ) by A15,MULTOP_1:def 1;
hence thesis by A23,A28,FUNCT_2:6;
end;
then reconsider Co as (BinComp of Ar);
set IT = AltCatStr (# I,Ar,Co #);
set J = (the carrier of IT);
IT is (SubCatStr of C)
proof
thus (the carrier of IT) c= (the carrier of C);
thus (the Arrows of IT) cc= (the Arrows of C) by A13;
thus [: J,J,J :] c= [: I,I,I :];
let i being set;
assume i in [: J,J,J :];
then consider p1,p2,p3 being (object of C) such that A51: i = [ p1,p2,p3 ] and A52: ( Co . i ) = ( ( (the Comp of C) . (p1,p2,p3) ) | ([: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] qua set) ) by A12;
A53: ( ( (the Comp of C) . (p1,p2,p3) ) | ([: ( Ar . (p2,p3) ),( Ar . (p1,p2) ) :] qua set) ) c= ( (the Comp of C) . (p1,p2,p3) ) by RELAT_1:59;
let q being set;
assume q in ( (the Comp of IT) . i );
then q in ( (the Comp of C) . (p1,p2,p3) ) by A52,A53;
hence thesis by A51,MULTOP_1:def 1;
end;
then reconsider IT as  strict non  empty (SubCatStr of C);
IT is  transitive
proof
let p1 being (object of IT);
let p2 being (object of IT);
let p3 being (object of IT);
assume that
A54: <^ p1,p2 ^> <> ( {} )
and
A55: <^ p2,p3 ^> <> ( {} );
consider m2 being set such that A56: m2 in <^ p1,p2 ^> by A54,XBOOLE_0:def 1;
consider m1 being set such that A57: m1 in <^ p2,p3 ^> by A55,XBOOLE_0:def 1;
[ p2,p3 ] in [: I,I :] by ZFMISC_1:def 2;
then consider q2,q3 being (object of C),qq being (Morphism of q2,q3) such that A58: [ p2,p3 ] = [ q2,q3 ] and A59: <^ q2,q3 ^> <> ( {} ) and A60: <^ q3,q2 ^> <> ( {} ) and m1 = qq and A61: qq is  coretraction by A8,A57;
[ p1,p2 ] in [: I,I :] by ZFMISC_1:def 2;
then consider r1,r2 being (object of C),rr being (Morphism of r1,r2) such that A62: [ p1,p2 ] = [ r1,r2 ] and A63: <^ r1,r2 ^> <> ( {} ) and A64: <^ r2,r1 ^> <> ( {} ) and m2 = rr and A65: rr is  coretraction by A8,A56;
A66: p2 = q2 by A58,ZFMISC_1:27;
then reconsider mm = qq as (Morphism of r2,q3) by A62,ZFMISC_1:27;
A67: r2 = p2 by A62,ZFMISC_1:27;
A68: (ex o1,o3 being (object of C) st (ex m being (Morphism of o1,o3) st (((([ p1,p3 ] = [ o1,o3 ] & <^ o1,o3 ^> <> ( {} )) & <^ o3,o1 ^> <> ( {} )) & ( mm * rr ) = m) & m is  coretraction)))
proof
take r1;
take q3;
take ( mm * rr );
p1 = r1 by A62,ZFMISC_1:27;
hence [ p1,p3 ] = [ r1,q3 ] by A58,ZFMISC_1:27;
thus A69: (<^ r1,q3 ^> <> ( {} ) & <^ q3,r1 ^> <> ( {} )) by A59,A60,A63,A64,A67,A66,ALTCAT_1:def 2;
thus ( mm * rr ) = ( mm * rr );
thus thesis by A59,A61,A63,A65,A67,A66,A69,ALTCAT_3:19;
end;
[ p1,p3 ] in [: I,I :] by ZFMISC_1:def 2;
hence thesis by A8,A68;
end;
then reconsider IT as  strict non  empty  transitive (SubCatStr of C);
take IT;
thus (the carrier of IT) = (the carrier of C);
thus (the Arrows of IT) cc= (the Arrows of C) by A13;
let o1 being (object of C);
let o2 being (object of C);
let m being (Morphism of o1,o2);
A70: [ o1,o2 ] in [: I,I :] by ZFMISC_1:def 2;
thus (m in ( (the Arrows of IT) . (o1,o2) ) implies ((<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) & m is  coretraction))
proof
assume m in ( (the Arrows of IT) . (o1,o2) );
then consider p1,p2 being (object of C),n being (Morphism of p1,p2) such that A71: [ o1,o2 ] = [ p1,p2 ] and A72: (((<^ p1,p2 ^> <> ( {} ) & <^ p2,p1 ^> <> ( {} )) & m = n) & n is  coretraction) by A8,A70;
(o1 = p1 & o2 = p2) by A71,ZFMISC_1:27;
hence thesis by A72;
end;

assume ((<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) & m is  coretraction);
hence thesis by A8,A70;
end;
uniqueness
proof
let S1 being  strict non  empty  transitive (SubCatStr of C);
let S2 being  strict non  empty  transitive (SubCatStr of C);
assume that
A73: (the carrier of S1) = (the carrier of C)
and
A74: (the Arrows of S1) cc= (the Arrows of C)
and
A75: (for o1,o2 being (object of C) holds (for m being (Morphism of o1,o2) holds (m in ( (the Arrows of S1) . (o1,o2) ) iff ((<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) & m is  coretraction))))
and
A76: (the carrier of S2) = (the carrier of C)
and
A77: (the Arrows of S2) cc= (the Arrows of C)
and
A78: (for o1,o2 being (object of C) holds (for m being (Morphism of o1,o2) holds (m in ( (the Arrows of S2) . (o1,o2) ) iff ((<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) & m is  coretraction))));
now
let i being set;
assume A79: i in [: (the carrier of C),(the carrier of C) :];
then consider o1,o2 being set such that A80: (o1 in (the carrier of C) & o2 in (the carrier of C)) and A81: i = [ o1,o2 ] by ZFMISC_1:84;
reconsider o1,o2 as (object of C) by A80;
thus ( (the Arrows of S1) . i ) = ( (the Arrows of S2) . i )
proof
thus ( (the Arrows of S1) . i ) c= ( (the Arrows of S2) . i )
proof
let n being set;
assume that
A82: n in ( (the Arrows of S1) . i );
( (the Arrows of S1) . i ) c= ( (the Arrows of C) . i ) by A73,A74,A79,ALTCAT_2:def 2;
then reconsider m = n as (Morphism of o1,o2) by A81,A82;
A83: m in ( (the Arrows of S1) . (o1,o2) ) by A81,A82;
then A84: m is  coretraction by A75;
(<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) by A75,A83;
then m in ( (the Arrows of S2) . (o1,o2) ) by A78,A84;
hence thesis by A81;
end;

let n being set;
assume that
A85: n in ( (the Arrows of S2) . i );
( (the Arrows of S2) . i ) c= ( (the Arrows of C) . i ) by A76,A77,A79,ALTCAT_2:def 2;
then reconsider m = n as (Morphism of o1,o2) by A81,A85;
A86: m in ( (the Arrows of S2) . (o1,o2) ) by A81,A85;
then A87: m is  coretraction by A78;
(<^ o1,o2 ^> <> ( {} ) & <^ o2,o1 ^> <> ( {} )) by A78,A86;
then m in ( (the Arrows of S1) . (o1,o2) ) by A75,A87;
hence thesis by A81;
end;

end;
hence thesis by A73,A76,ALTCAT_2:26,PBOOLE:3;
end;
end;
