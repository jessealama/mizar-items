environ
vocabularies XBOOLE_0,PRE_TOPC,RCOMP_1,TARSKI,NAT_1,NUMBERS,FUNCOP_1,FRECHET,SUBSET_1,CARD_1,STRUCT_0,ORDINAL2,RELAT_1,SEQ_1,VALUED_0,XXREAL_0,FUNCT_1,RLVECT_3,CARD_3,SETFAM_1,ORDINAL1,ZFMISC_1,FINSET_1,ARYTM_3,SEQ_2,METRIC_1,PCOMPS_1,METRIC_6,XREAL_0,REAL_1,WAYBEL_7,ARYTM_1,FUNCT_2,FRECHET2;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,ORDINAL1,SETFAM_1,FINSET_1,CARD_3,TOPS_2,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,SEQ_1,FUNCT_2,REAL_1,NAT_1,XXREAL_2,LIMFUNC1,VALUED_0,METRIC_1,PCOMPS_1,TBSP_1,DOMAIN_1,STRUCT_0,PRE_TOPC,FUNCOP_1,METRIC_6,YELLOW_8,FRECHET,SEQ_4,CKB18,CKB30,CKB38;
definitions TARSKI,SEQM_3,PRE_TOPC,TOPS_2,METRIC_6,FUNCT_1,FUNCT_2,FRECHET,XBOOLE_0,CKB18,CKB30,CKB38;
theorems FRECHET,URYSOHN1,YELLOW_8,PRE_TOPC,TARSKI,FUNCOP_1,NORMSP_1,ZFMISC_1,PCOMPS_1,FUNCT_1,AXIOMS,CARD_1,RELAT_1,SETFAM_1,ORDINAL1,FUNCT_2,TOPS_2,FINSET_1,SUBSET_1,SEQM_3,NAT_1,INT_1,SEQ_1,TOPMETR,METRIC_6,RELSET_1,XBOOLE_0,XBOOLE_1,XREAL_0,XREAL_1,XXREAL_0,VALUED_0,XXREAL_2,CARD_3,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43;
schemes CLASSES1,DOMAIN_1,NAT_1,RECDEF_1,SEQ_1,FUNCT_1,VALUED_1;
registrations SUBSET_1,FUNCT_1,RELSET_1,FUNCT_2,NUMBERS,XREAL_0,MEMBERED,REALSET1,STRUCT_0,METRIC_1,PCOMPS_1,FRECHET,VALUED_0,CARD_1,XXREAL_2,ORDINAL1,FINSET_1;
constructors SETFAM_1,PARTFUN1,NAT_1,NAT_D,SEQ_1,LIMFUNC1,REALSET1,CARD_3,TOPS_2,COMPTS_1,PCOMPS_1,BHSP_3,TBSP_1,URYSOHN1,METRIC_6,YELLOW_8,FRECHET,RECDEF_1,SEQ_4,XXREAL_2,SEQM_3,RELSET_1,FUNCOP_1,CKB18,CKB30,CKB38;
requirements NUMERALS,BOOLE,SUBSET,ARITHM;
begin
theorem
Th39: (for T being non  empty TopStruct holds (for S1,S2 being (sequence of T) holds ((( rng S2 ) c= ( rng S1 ) & S2 is  one-to-one) implies (ex P being (Permutation of ( NAT )) st ( S2 * P ) is (subsequence of S1)))))
proof
let T being non  empty TopStruct;
let S1 being (sequence of T);
let S2 being (sequence of T);
assume that
A1: ( rng S2 ) c= ( rng S1 )
and
A2: S2 is  one-to-one;
defpred P[ set,set ]
 means
( S2 . $1 ) = ( S1 . $2 );
A3: (for n being set holds (n in ( NAT ) implies (ex u being set st (u in ( NAT ) & P[ n,u ]))))
proof
let n being set;
assume n in ( NAT );
then n in ( dom S2 ) by NORMSP_1:12;
then ( S2 . n ) in ( rng S2 ) by FUNCT_1:def 3;
then consider m being set such that A4: m in ( dom S1 ) and A5: ( S2 . n ) = ( S1 . m ) by A1,FUNCT_1:def 3;
take m;
thus m in ( NAT ) by A4;
thus thesis by A5;
end;
consider f being Function such that A6: ( dom f ) = ( NAT ) and A7: ( rng f ) c= ( NAT ) and A8: (for n being set holds (n in ( NAT ) implies P[ n,( f . n ) ])) from FUNCT_1:sch 5(A3);
reconsider A = ( rng f ) as non  empty (Subset of ( NAT )) by A6,A7,RELAT_1:42;
defpred P[ (Element of ( NAT )),set,set ]
 means
(for B being non  empty (Subset of ( NAT )) holds (for m being (Element of ( NAT )) holds ((m = $2 & B = { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) }) implies $3 = ( min B ))));
A9: f is  one-to-one
proof
let x1 being set;
let x2 being set;
assume that
A10: x1 in ( dom f )
and
A11: x2 in ( dom f )
and
A12: ( f . x1 ) = ( f . x2 );
( S2 . x2 ) = ( S1 . ( f . x2 ) ) by A6,A8,A11;
then A13: ( S2 . x1 ) = ( S2 . x2 ) by A6,A8,A10,A12;
(x1 in ( dom S2 ) & x2 in ( dom S2 )) by A6,A10,A11,NORMSP_1:12;
hence thesis by A2,A13,FUNCT_1:def 4;
end;
A14: (for m being (Element of ( NAT )) holds { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) } <> ( {} ))
proof
let m being (Element of ( NAT ));
assume A15: { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) } = ( {} );
( rng f ) c= ( m + 1 )
proof
let x being set;
assume A16: x in ( rng f );
then reconsider x9 = x as (Element of ( NAT )) by A7;
x9 < ( m + 1 )
proof
assume x9 >= ( m + 1 );
then x9 > m by NAT_1:13;
then x9 in { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) } by A16;
hence contradiction by A15;
end;
then x9 in { x99 where x99 is (Element of ( NAT )): x99 < ( m + 1 ) };
hence thesis by AXIOMS:4;
end;
then ( rng f ) is  finite;
hence contradiction by A6,A9,CARD_1:59;
end;
A17: (for m being (Element of ( NAT )) holds { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) } c= ( NAT ))
proof
let m being (Element of ( NAT ));
let z being set;
assume z in { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) };
then (ex k being (Element of ( NAT )) st ((k = z & k in ( rng f )) & k > m));
hence thesis;
end;
A18: (for n being (Element of ( NAT )) holds (for x being set holds (ex y being set st P[ n,x,y ])))
proof
let n being (Element of ( NAT ));
let x being set;
per cases ;
suppose x in ( NAT );

then reconsider x9 = x as (Element of ( NAT ));
set B = { k where k is (Element of ( NAT )): (k in ( rng f ) & k > x9) };
reconsider B as (Subset of ( NAT )) by A17;
reconsider B as non  empty (Subset of ( NAT )) by A14;
take ( min B );
let B9 being non  empty (Subset of ( NAT ));
let m being (Element of ( NAT ));
assume (m = x & B9 = { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) });
hence thesis;
end;
suppose A19: (not x in ( NAT ));

take ( 0 );
let B being non  empty (Subset of ( NAT ));
let m being (Element of ( NAT ));
assume that
A20: m = x
and
B = { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) };
thus thesis by A19,A20;
end;
end;
consider g being Function such that A21: ( dom g ) = ( NAT ) and A22: ( g . ( 0 ) ) = ( min A ) and A23: (for n being (Element of ( NAT )) holds P[ n,( g . n ),( g . ( n + 1 ) ) ]) from RECDEF_1:sch 1(A18);
defpred P[ (Element of ( NAT )) ]
 means
( g . $1 ) in ( NAT );
A24: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume ( g . k ) in ( NAT );
then reconsider m = ( g . k ) as (Element of ( NAT ));
set B = { l where l is (Element of ( NAT )): (l in ( rng f ) & l > m) };
reconsider B as (Subset of ( NAT )) by A17;
reconsider B as non  empty (Subset of ( NAT )) by A14;
( g . ( k + 1 ) ) = ( min B ) by A23;
hence thesis;
end;
A25: P[ ( 0 ) ] by A22;
A26: (for k being (Element of ( NAT )) holds P[ k ]) from NAT_1:sch 1(A25,A24);
(for n being (Element of ( NAT )) holds ( g . n ) is  real)
proof
let n being (Element of ( NAT ));
( g . n ) in ( NAT ) by A26;
then reconsider w = ( g . n ) as (Element of ( REAL ));
w is  real;
hence thesis;
end;
then reconsider g1 = g as Real_Sequence by A21,SEQ_1:2;
A27: g1 is  increasing
proof
let n being (Element of ( NAT ));
reconsider m = ( g . n ) as (Element of ( NAT )) by A26;
reconsider B = { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) } as non  empty (Subset of ( NAT )) by A14,A17;
( g1 . ( n + 1 ) ) = ( min B ) by A23;
then ( g1 . ( n + 1 ) ) in B by XXREAL_2:def 7;
then (ex k being (Element of ( NAT )) st ((k = ( g1 . ( n + 1 ) ) & k in ( rng f )) & k > m));
hence thesis;
end;
A28: ( rng g ) c= ( NAT )
proof
let y being set;
assume y in ( rng g );
then consider x being set such that A29: x in ( dom g ) and A30: y = ( g . x ) by FUNCT_1:def 3;
reconsider x as (Element of ( NAT )) by A21,A29;
( g . x ) in ( NAT ) by A26;
hence thesis by A30;
end;
then reconsider g1 as  increasing (sequence of ( NAT )) by A21,A27,RELSET_1:4;
A31: g1 is  one-to-one
proof
let x1 being set;
let x2 being set;
assume that
A32: x1 in ( dom g1 )
and
A33: x2 in ( dom g1 )
and
A34: ( g1 . x1 ) = ( g1 . x2 );
reconsider n2 = x2 as (Element of ( NAT )) by A33;
reconsider n1 = x1 as (Element of ( NAT )) by A32;
assume A35: x1 <> x2;
per cases  by A35,XXREAL_0:1;
suppose n1 < n2;

hence contradiction by A34,SEQM_3:1;
end;
suppose n2 < n1;

hence contradiction by A34,SEQM_3:1;
end;
end;
then A36: ( rng ( g " ) ) = ( NAT ) by A21,FUNCT_1:33;
A37: ( rng f ) = ( rng g )
proof
thus (for y being set holds (y in ( rng f ) implies y in ( rng g )))
proof
let y being set;
assume A38: y in ( rng f );
then reconsider y9 = y as (Element of ( NAT )) by A7;
defpred P[ (Element of ( NAT )) ]
 means
( g1 . $1 ) < y9;
assume A39: (not y in ( rng g ));
A40: (for n being (Element of ( NAT )) holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
let n being (Element of ( NAT ));
reconsider m = ( g . n ) as (Element of ( NAT )) by A26;
reconsider B = { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) } as non  empty (Subset of ( NAT )) by A14,A17;
A41: (( g . ( n + 1 ) ) = ( min B ) & ( g . ( n + 1 ) ) in ( rng g )) by A21,A23,FUNCT_1:def 3;
assume ( g1 . n ) < y9;
then y9 in { k where k is (Element of ( NAT )): (k in ( rng f ) & k > m) } by A38;
then A42: ( min B ) <= y9 by XXREAL_2:def 7;
assume (not ( g1 . ( n + 1 ) ) < y9);
hence contradiction by A39,A42,A41,XXREAL_0:1;
end;
A43: P[ ( 0 ) ]
proof
assume A44: (not ( g1 . ( 0 ) ) < y9);
(( min A ) <= y9 & ( g . ( 0 ) ) in ( rng g )) by A21,A38,FUNCT_1:def 3,XXREAL_2:def 7;
hence contradiction by A22,A39,A44,XXREAL_0:1;
end;
A45: (for n being (Element of ( NAT )) holds P[ n ]) from NAT_1:sch 1(A43,A40);
( rng g ) c= y9
proof
let y being set;
assume y in ( rng g );
then consider x being set such that A46: x in ( dom g ) and A47: y = ( g . x ) by FUNCT_1:def 3;
reconsider x as (Element of ( NAT )) by A21,A46;
( g1 . x ) < y9 by A45;
then ( g1 . x ) in { i where i is (Element of ( NAT )): i < y9 };
hence thesis by A47,AXIOMS:4;
end;
then ( rng g ) is  finite;
hence contradiction by A21,A31,CARD_1:59;
end;

let y being set;
assume y in ( rng g );
then consider x being set such that A48: x in ( dom g ) and A49: y = ( g . x ) by FUNCT_1:def 3;
reconsider n = x as (Element of ( NAT )) by A21,A48;
per cases ;
suppose n = ( 0 );

hence thesis by A22,A49,XXREAL_2:def 7;
end;
suppose n <> ( 0 );

then n > ( 0 ) by NAT_1:3;
then ( n + 1 ) > ( ( 0 ) + 1 ) by XREAL_1:6;
then 1 <= n by NAT_1:13;
then reconsider m = ( n - 1 ) as (Element of ( NAT )) by INT_1:5;
reconsider l = ( g . m ) as (Element of ( NAT )) by A26;
reconsider B = { k where k is (Element of ( NAT )): (k in ( rng f ) & k > l) } as non  empty (Subset of ( NAT )) by A14,A17;
( m + 1 ) = n;
then ( g . n ) = ( min B ) by A23;
then y in B by A49,XXREAL_2:def 7;
then (ex k being (Element of ( NAT )) st ((k = y & k in ( rng f )) & k > l));
hence thesis;
end;
end;
then A50: ( rng f ) = ( dom ( g " ) ) by A31,FUNCT_1:33;
then (( dom ( ( g " ) * f ) ) = ( dom f ) & ( rng ( ( g " ) * f ) ) = ( rng ( g " ) )) by RELAT_1:27,RELAT_1:28;
then reconsider P = ( ( g " ) * f ) as (Function of ( NAT ),( NAT )) by A6,A36,FUNCT_2:def 1,RELSET_1:4;
( rng ( g " ) ) = ( dom g ) by A31,FUNCT_1:33;
then ( rng P ) = ( NAT ) by A21,A50,RELAT_1:28;
then P is  onto by FUNCT_2:def 3;
then reconsider P as (Permutation of ( NAT )) by A9,A31;
take ( P " );
((( NAT ) = ( dom ( S2 * ( P " ) ) ) & ( NAT ) = ( dom ( S1 * g ) )) & (for x being set holds (x in ( NAT ) implies ( ( S2 * ( P " ) ) . x ) = ( ( S1 * g ) . x ))))
proof
thus ( NAT ) = ( dom ( S2 * ( P " ) ) ) by FUNCT_2:def 1;
( rng g ) c= ( dom S1 ) by A28,NORMSP_1:12;
hence ( NAT ) = ( dom ( S1 * g ) ) by A21,RELAT_1:27;
let x being set;
assume A51: x in ( NAT );
then A52: ( g . x ) in ( rng g ) by A21,FUNCT_1:def 3;
then A53: ( ( f " ) . ( g . x ) ) in ( dom f ) by A9,A37,FUNCT_1:32;
( dom ( P " ) ) = ( NAT ) by FUNCT_2:def 1;
hence ( ( S2 * ( P " ) ) . x ) = ( S2 . ( ( ( ( g " ) * f ) " ) . x ) ) by A51,FUNCT_1:13
.= ( S2 . ( ( ( f " ) * ( ( g " ) " ) ) . x ) ) by A9,A31,FUNCT_1:44
.= ( S2 . ( ( ( f " ) * g ) . x ) ) by A31,FUNCT_1:43
.= ( S2 . ( ( f " ) . ( g . x ) ) ) by A21,A51,FUNCT_1:13
.= ( S1 . ( f . ( ( f " ) . ( g . x ) ) ) ) by A6,A8,A53
.= ( S1 . ( g . x ) ) by A9,A37,A52,FUNCT_1:35
.= ( ( S1 * g ) . x ) by A21,A51,FUNCT_1:13;
end;
then ( S2 * ( P " ) ) = ( S1 * g1 ) by FUNCT_1:2;
hence thesis;
end;
