environ
vocabularies NUMBERS,XBOOLE_0,PROB_1,MEASURE1,PARTFUN1,SUBSET_1,REAL_1,INTEGRA5,TARSKI,RELAT_1,FUNCT_1,ARYTM_3,XXREAL_0,MEASURE6,MESFUNC5,FUNCT_3,VALUED_1,MESFUNC1,ARYTM_1,SUPINF_2,MESFUNC2,FINSEQ_1,NAT_1,CARD_3,CARD_1,MESFUNC3,INTEGRA1,ZFMISC_1,XXREAL_2,VALUED_0,SEQ_1,RPR_1,FINSET_1,UPROOTS,RFUNCT_3,PROB_4,XREAL_0,ORDINAL1,COMPLEX1,EQREL_1,SEQ_2,ORDINAL2,POWER,RANDOM_1,BSPACE;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,FINSET_1,CARD_1,NUMBERS,XREAL_0,XXREAL_0,REAL_1,COMPLEX1,XXREAL_2,FUNCT_1,RELSET_1,PARTFUN1,VALUED_1,FINSEQ_1,RFUNCT_3,FUNCT_2,NAT_1,SUPINF_2,SEQ_1,SEQ_2,RPR_1,PROB_1,PROB_4,MEASURE1,EXTREAL1,MESFUNC1,MESFUNC3,MEASURE6,MESFUNC5,MESFUNC6,MESFUNC2,RVSUM_1,UPROOTS,MESFUN6C,CKB10,CKB11;
definitions TARSKI,RPR_1,SUBSET_1,FINSEQ_1,MESFUNC1,MEASURE6,MESFUNC5,MESFUNC6,XCMPLX_0,PROB_4,VALUED_1,XBOOLE_0,XXREAL_3;
theorems ABSVALUE,TARSKI,PARTFUN1,FUNCT_1,NUMBERS,SUPINF_2,EXTREAL1,RPR_1,MESFUNC1,FINSEQ_1,XBOOLE_0,SEQM_3,RVSUM_1,XBOOLE_1,XCMPLX_1,MESFUNC2,MESFUNC3,XREAL_1,COMPLEX1,XXREAL_0,RFUNCT_3,MESFUNC5,PROB_1,NAT_1,RELAT_1,FUNCT_3,ZFMISC_1,FUNCT_2,MEASURE1,INTEGRA5,MESFUNC4,MESFUNC6,ORDINAL1,SEQ_2,CARD_FIN,MESFUNC7,VALUED_0,VALUED_1,UPROOTS,ABCMIZ_1,RCOMP_1,MESFUN6C,FINSEQ_3,XXREAL_3,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21;
schemes FINSEQ_1,FUNCT_2,FINSEQ_2;
registrations SUBSET_1,NAT_1,XREAL_0,XXREAL_0,TOPREAL6,MEMBERED,ORDINAL1,FINSEQ_1,MEASURE1,FUNCT_2,RELAT_1,SEQ_4,FINSET_1,NUMBERS,XCMPLX_0,VALUED_0,VALUED_1,UPROOTS,RELSET_1;
constructors REAL_1,RPR_1,NAT_3,EXTREAL1,SEQ_1,POWER,RVSUM_1,MESFUNC6,MESFUNC3,MESFUNC5,MEASURE6,MESFUNC2,BINOP_2,PARTFUN3,INTEGRA2,PROB_4,SUPINF_1,UPROOTS,MESFUN6C,MESFUNC1,DOMAIN_1,RELSET_1,CKB11;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve Omega for non  empty set;
reserve E for  finite non  empty set;
theorem
Th10: (for Omega being non  empty  finite set holds (for M being (sigma_Measure of ( Trivial-SigmaField Omega )) holds (for f being (Function of Omega,( REAL )) holds (for x being (FinSequence of ( ExtREAL )) holds (for s being (FinSequence of Omega) holds ((((((( M . Omega ) < ( +infty ) & ( len x ) = ( card Omega )) & s is  one-to-one) & ( rng s ) = Omega) & ( len s ) = ( card Omega )) & (for n being Nat holds (n in ( dom x ) implies ( x . n ) = ( ( R_EAL ( f . ( s . n ) ) ) * ( M . { ( s . n ) } ) )))) implies ( Integral (M,f) ) = ( Sum x )))))))
proof
let Omega being non  empty  finite set;
let M being (sigma_Measure of ( Trivial-SigmaField Omega ));
let f being (Function of Omega,( REAL ));
let x being (FinSequence of ( ExtREAL ));
let s being (FinSequence of Omega);
assume that
A1: ( M . Omega ) < ( +infty )
and
A2: ( len x ) = ( card Omega )
and
A3: s is  one-to-one
and
A4: ( rng s ) = Omega
and
A5: ( len s ) = ( card Omega )
and
A6: (for n being Nat holds (n in ( dom x ) implies ( x . n ) = ( ( R_EAL ( f . ( s . n ) ) ) * ( M . { ( s . n ) } ) )));
set Sigma = ( Trivial-SigmaField Omega );
consider F being (Finite_Sep_Sequence of Sigma),a being (FinSequence of ( REAL )) such that A7: ( dom f ) = ( union ( rng F ) ) and ( dom a ) = ( dom s ) and A8: ( dom F ) = ( dom s ) and A9: (for k being Nat holds (k in ( dom F ) implies ( F . k ) = { ( s . k ) })) and (for n being Nat holds (for x,y being (Element of Omega) holds (((n in ( dom F ) & x in ( F . n )) & y in ( F . n )) implies ( f . x ) = ( f . y )))) by A3,A4,CKB21:1;
A10: ( dom x ) = ( Seg ( len s ) ) by A2,A5,FINSEQ_1:def 3
.= ( dom F ) by A8,FINSEQ_1:def 3;
set fm = ( max- f );
set fp = ( max+ f );
A11: ( dom f ) = Omega by FUNCT_2:def 1;
then ( dom fp ) = Omega by RFUNCT_3:def 10;
then A12: fp is_integrable_on M by A1,CKB9:1,CKB14:1;
A13: (for n being Nat holds (n in ( dom s ) implies ( M . { ( s . n ) } ) in ( REAL )))
proof
let n being Nat;
assume n in ( dom s );
then ( s . n ) in ( rng s ) by FUNCT_1:3;
then { ( s . n ) } c= Omega by ZFMISC_1:31;
hence ( M . { ( s . n ) } ) in ( REAL ) by A1,A4,CKB16:1;
end;
now
let y being set;
assume y in ( rng x );
then consider n being (Element of ( NAT )) such that A14: n in ( dom x ) and A15: y = ( x . n ) by PARTFUN1:3;
reconsider z = ( M . { ( s . n ) } ) as (Element of ( REAL )) by A8,A10,A13,A14;
reconsider w = ( f . ( s . n ) ) as (Element of ( REAL ));
( x . n ) = ( ( R_EAL ( f . ( s . n ) ) ) * ( M . { ( s . n ) } ) ) by A6,A14
.= ( w * z ) by EXTREAL1:1;
hence y in ( REAL ) by A15;
end;
then ( rng x ) c= ( REAL ) by TARSKI:def 3;
then reconsider x1 = x as (FinSequence of ( REAL )) by FINSEQ_1:def 4;
A16: (fm is_simple_func_in Sigma & fm is  nonnegative) by CKB14:1,MESFUNC6:61;
defpred AP[ Nat,set ]
 means
(for x being set holds (x in ( F . $1 ) implies $2 = ( fp . x )));
set L = ( len F );
A17: ( dom F ) = ( Seg L ) by FINSEQ_1:def 3;
A18: (for k being Nat holds (k in ( Seg L ) implies (ex y being (Element of ( REAL )) st AP[ k,y ])))
proof
let k being Nat;
assume A19: k in ( Seg L );
take ( fp . ( s . k ) );
( F . k ) = { ( s . k ) } by A9,A17,A19;
hence thesis by TARSKI:def 1;
end;
consider ap being (FinSequence of ( REAL )) such that A20: (( dom ap ) = ( Seg L ) & (for k being Nat holds (k in ( Seg L ) implies AP[ k,( ap . k ) ]))) from FINSEQ_1:sch 5(A18);
defpred AM[ Nat,set ]
 means
(for x being set holds (x in ( F . $1 ) implies $2 = ( fm . x )));
A21: (for k being Nat holds (k in ( Seg L ) implies (ex y being (Element of ( REAL )) st AM[ k,y ])))
proof
let k being Nat;
assume A22: k in ( Seg L );
take ( fm . ( s . k ) );
( F . k ) = { ( s . k ) } by A9,A17,A22;
hence thesis by TARSKI:def 1;
end;
consider am being (FinSequence of ( REAL )) such that A23: (( dom am ) = ( Seg L ) & (for k being Nat holds (k in ( Seg L ) implies AM[ k,( am . k ) ]))) from FINSEQ_1:sch 5(A21);
A24: ( dom fm ) = ( dom f ) by RFUNCT_3:def 11;
then A25: fm is (Function of Omega,( REAL )) by A11,FUNCT_2:def 1;
then ( M . ( dom ( ( - 1 ) (#) fm ) ) ) < ( +infty ) by A1,FUNCT_2:def 1;
then ( ( - 1 ) (#) fm ) is_integrable_on M by A25,CKB9:1,CKB14:1;
then consider E being (Element of Sigma) such that A26: E = ( ( dom fp ) /\ ( dom ( ( - 1 ) (#) fm ) ) ) and A27: ( Integral (M,( fp + ( ( - 1 ) (#) fm ) )) ) = ( ( Integral (M,( fp | E )) ) + ( Integral (M,( ( ( - 1 ) (#) fm ) | E )) ) ) by A12,MESFUNC6:101;
A28: ( ( R_EAL ( - 1 ) ) * ( Integral (M,fm) ) ) = ( ( - ( R_EAL 1 ) ) * ( Integral (M,fm) ) ) by SUPINF_2:2
.= ( - ( ( R_EAL 1 ) * ( Integral (M,fm) ) ) ) by XXREAL_3:92
.= ( - ( Integral (M,fm) ) ) by XXREAL_3:81;
defpred Pp[ Nat,set ]
 means
$2 = ( ( R_EAL ( ap . $1 ) ) * ( ( M * F ) . $1 ) );
A29: (for k being Nat holds (k in ( Seg L ) implies (ex x being (Element of ( ExtREAL )) st Pp[ k,x ])));
consider xp being (FinSequence of ( ExtREAL )) such that A30: (( dom xp ) = ( Seg L ) & (for k being Nat holds (k in ( Seg L ) implies Pp[ k,( xp . k ) ]))) from FINSEQ_1:sch 5(A29);
A31: ( dom xp ) = ( dom F ) by A30,FINSEQ_1:def 3;
A32: (for n being Nat holds (n in ( dom xp ) implies ( xp . n ) = ( ( R_EAL ( fp . ( s . n ) ) ) * ( M . { ( s . n ) } ) )))
proof
let n being Nat;
assume A33: n in ( dom xp );
then A34: ( ( M * F ) . n ) = ( M . ( F . n ) ) by A31,FUNCT_1:13
.= ( M . { ( s . n ) } ) by A9,A31,A33;
( F . n ) = { ( s . n ) } by A9,A31,A33;
then A35: ( s . n ) in ( F . n ) by TARSKI:def 1;
thus ( xp . n ) = ( ( R_EAL ( ap . n ) ) * ( ( M * F ) . n ) ) by A30,A33
.= ( ( R_EAL ( fp . ( s . n ) ) ) * ( M . { ( s . n ) } ) ) by A20,A30,A33,A35,A34;
end;
now
let y being set;
assume y in ( rng xp );
then consider n being (Element of ( NAT )) such that A36: n in ( dom xp ) and A37: y = ( xp . n ) by PARTFUN1:3;
reconsider z = ( M . { ( s . n ) } ) as (Element of ( REAL )) by A8,A31,A13,A36;
reconsider w = ( fp . ( s . n ) ) as (Element of ( REAL ));
( xp . n ) = ( ( R_EAL ( fp . ( s . n ) ) ) * ( M . { ( s . n ) } ) ) by A32,A36
.= ( w * z ) by EXTREAL1:1;
hence y in ( REAL ) by A37;
end;
then ( rng xp ) c= ( REAL ) by TARSKI:def 3;
then reconsider xp1 = xp as (FinSequence of ( REAL )) by FINSEQ_1:def 4;
defpred Pm[ Nat,set ]
 means
$2 = ( ( R_EAL ( am . $1 ) ) * ( ( M * F ) . $1 ) );
A38: (for k being Nat holds (k in ( Seg L ) implies (ex x being (Element of ( ExtREAL )) st Pm[ k,x ])));
consider xm being (FinSequence of ( ExtREAL )) such that A39: (( dom xm ) = ( Seg L ) & (for k being Nat holds (k in ( Seg L ) implies Pm[ k,( xm . k ) ]))) from FINSEQ_1:sch 5(A38);
A40: ( dom xm ) = ( dom F ) by A39,FINSEQ_1:def 3;
A41: (for n being Nat holds (n in ( dom xm ) implies ( xm . n ) = ( ( R_EAL ( fm . ( s . n ) ) ) * ( M . { ( s . n ) } ) )))
proof
let n being Nat;
assume A42: n in ( dom xm );
then A43: ( ( M * F ) . n ) = ( M . ( F . n ) ) by A40,FUNCT_1:13
.= ( M . { ( s . n ) } ) by A9,A40,A42;
( F . n ) = { ( s . n ) } by A9,A40,A42;
then A44: ( s . n ) in ( F . n ) by TARSKI:def 1;
thus ( xm . n ) = ( ( R_EAL ( am . n ) ) * ( ( M * F ) . n ) ) by A39,A42
.= ( ( R_EAL ( fm . ( s . n ) ) ) * ( M . { ( s . n ) } ) ) by A23,A39,A42,A44,A43;
end;
now
let y being set;
assume y in ( rng xm );
then consider n being (Element of ( NAT )) such that A45: n in ( dom xm ) and A46: y = ( xm . n ) by PARTFUN1:3;
reconsider z = ( M . { ( s . n ) } ) as (Element of ( REAL )) by A8,A40,A13,A45;
reconsider w = ( fm . ( s . n ) ) as (Element of ( REAL ));
( xm . n ) = ( ( R_EAL ( fm . ( s . n ) ) ) * ( M . { ( s . n ) } ) ) by A41,A45
.= ( w * z ) by EXTREAL1:1;
hence y in ( REAL ) by A46;
end;
then ( rng xm ) c= ( REAL ) by TARSKI:def 3;
then reconsider xm1 = xm as (FinSequence of ( REAL )) by FINSEQ_1:def 4;
A47: (( Sum xp ) = ( Sum xp1 ) & ( Sum xm ) = ( Sum xm1 )) by MESFUNC3:2;
A48: (for k being Nat holds (k in ( dom x1 ) implies ( ( xp1 - xm1 ) . k ) = ( x1 . k )))
proof
let k being Nat;
A49: f = ( fp - fm ) by MESFUNC6:42;
assume A50: k in ( dom x1 );
then reconsider z = ( M . { ( s . k ) } ) as (Element of ( REAL )) by A8,A10,A13;
A51: ( xm1 . k ) = ( ( R_EAL ( fm . ( s . k ) ) ) * ( M . { ( s . k ) } ) ) by A10,A40,A41,A50
.= ( ( fm . ( s . k ) ) * z ) by EXTREAL1:1;
( s . k ) in ( rng s ) by A8,A10,A50,FUNCT_1:3;
then ( s . k ) in Omega;
then A52: ( s . k ) in ( dom f ) by FUNCT_2:def 1;
k in ( ( dom xp1 ) /\ ( dom xm1 ) ) by A10,A31,A40,A50;
then A53: k in ( dom ( xp1 - xm1 ) ) by VALUED_1:12;
( xp1 . k ) = ( ( R_EAL ( fp . ( s . k ) ) ) * ( M . { ( s . k ) } ) ) by A10,A31,A32,A50
.= ( ( fp . ( s . k ) ) * z ) by EXTREAL1:1;
hence ( ( xp1 - xm1 ) . k ) = ( ( ( fp . ( s . k ) ) * z ) - ( ( fm . ( s . k ) ) * z ) ) by A53,A51,VALUED_1:13
.= ( ( ( fp . ( s . k ) ) - ( fm . ( s . k ) ) ) * z )
.= ( ( f . ( s . k ) ) * z ) by A52,A49,VALUED_1:13
.= ( ( R_EAL ( f . ( s . k ) ) ) * ( M . { ( s . k ) } ) ) by EXTREAL1:1
.= ( x1 . k ) by A6,A50;
end;
( dom fm ) = Omega by A11,RFUNCT_3:def 11;
then A54: fm is_integrable_on M by A1,CKB9:1,CKB14:1;
A55: ( dom fp ) = ( dom f ) by RFUNCT_3:def 10;
then A56: fp is (Function of Omega,( REAL )) by A11,FUNCT_2:def 1;
A57: ( dom ( xp1 - xm1 ) ) = ( ( dom xp1 ) /\ ( dom xm1 ) ) by VALUED_1:12
.= ( dom x1 ) by A10,A31,A40;
A58: ( len xp1 ) = L by A30,FINSEQ_1:def 3
.= ( len xm1 ) by A39,FINSEQ_1:def 3;
( dom ( ( - 1 ) (#) fm ) ) = ( dom fm ) by VALUED_1:def 5
.= Omega by A11,RFUNCT_3:def 11;
then A59: E = ( Omega /\ Omega ) by A11,A26,RFUNCT_3:def 10
.= Omega;
then ( ( ( - 1 ) (#) fm ) | E ) = ( ( - 1 ) (#) fm ) by A25,FUNCT_2:33;
then A60: ( Integral (M,( fp + ( ( - 1 ) (#) fm ) )) ) = ( ( Integral (M,fp) ) + ( Integral (M,( ( - 1 ) (#) fm )) ) ) by A56,A27,A59,FUNCT_2:33
.= ( ( Integral (M,fp) ) + ( - ( Integral (M,fm) ) ) ) by A54,A28,MESFUNC6:102;
(fp is_simple_func_in Sigma & fp is  nonnegative) by CKB14:1,MESFUNC6:61;
then A61: ( Integral (M,fp) ) = ( Sum xp ) by A7,A55,A17,A20,A30,CKB5:1;
thus ( Integral (M,f) ) = ( Integral (M,( fp - fm )) ) by MESFUNC6:42
.= ( ( Sum xp ) - ( Sum xm ) ) by A7,A24,A17,A23,A16,A39,A61,A60,CKB5:1
.= ( ( Sum xp1 ) - ( Sum xm1 ) ) by A47,SUPINF_2:3
.= ( Sum ( xp1 - xm1 ) ) by A58,INTEGRA5:2
.= ( Sum x ) by A57,A48,FINSEQ_1:13,MESFUNC3:2;
end;
