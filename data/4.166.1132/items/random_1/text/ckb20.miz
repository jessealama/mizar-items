environ
vocabularies NUMBERS,XBOOLE_0,PROB_1,MEASURE1,PARTFUN1,SUBSET_1,REAL_1,INTEGRA5,TARSKI,RELAT_1,FUNCT_1,ARYTM_3,XXREAL_0,MEASURE6,MESFUNC5,FUNCT_3,VALUED_1,MESFUNC1,ARYTM_1,SUPINF_2,MESFUNC2,FINSEQ_1,NAT_1,CARD_3,CARD_1,MESFUNC3,INTEGRA1,ZFMISC_1,XXREAL_2,VALUED_0,SEQ_1,RPR_1,FINSET_1,UPROOTS,RFUNCT_3,PROB_4,XREAL_0,ORDINAL1,COMPLEX1,EQREL_1,SEQ_2,ORDINAL2,POWER,RANDOM_1,BSPACE;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,FINSET_1,CARD_1,NUMBERS,XREAL_0,XXREAL_0,REAL_1,COMPLEX1,XXREAL_2,FUNCT_1,RELSET_1,PARTFUN1,VALUED_1,FINSEQ_1,RFUNCT_3,FUNCT_2,NAT_1,SUPINF_2,SEQ_1,SEQ_2,RPR_1,PROB_1,PROB_4,MEASURE1,EXTREAL1,MESFUNC1,MESFUNC3,MEASURE6,MESFUNC5,MESFUNC6,MESFUNC2,RVSUM_1,UPROOTS,MESFUN6C,CKB10,CKB11;
definitions TARSKI,RPR_1,SUBSET_1,FINSEQ_1,MESFUNC1,MEASURE6,MESFUNC5,MESFUNC6,XCMPLX_0,PROB_4,VALUED_1,XBOOLE_0,XXREAL_3;
theorems ABSVALUE,TARSKI,PARTFUN1,FUNCT_1,NUMBERS,SUPINF_2,EXTREAL1,RPR_1,MESFUNC1,FINSEQ_1,XBOOLE_0,SEQM_3,RVSUM_1,XBOOLE_1,XCMPLX_1,MESFUNC2,MESFUNC3,XREAL_1,COMPLEX1,XXREAL_0,RFUNCT_3,MESFUNC5,PROB_1,NAT_1,RELAT_1,FUNCT_3,ZFMISC_1,FUNCT_2,MEASURE1,INTEGRA5,MESFUNC4,MESFUNC6,ORDINAL1,SEQ_2,CARD_FIN,MESFUNC7,VALUED_0,VALUED_1,UPROOTS,ABCMIZ_1,RCOMP_1,MESFUN6C,FINSEQ_3,XXREAL_3,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19;
schemes FINSEQ_1,FUNCT_2,FINSEQ_2;
registrations SUBSET_1,NAT_1,XREAL_0,XXREAL_0,TOPREAL6,MEMBERED,ORDINAL1,FINSEQ_1,MEASURE1,FUNCT_2,RELAT_1,SEQ_4,FINSET_1,NUMBERS,XCMPLX_0,VALUED_0,VALUED_1,UPROOTS,RELSET_1;
constructors REAL_1,RPR_1,NAT_3,EXTREAL1,SEQ_1,POWER,RVSUM_1,MESFUNC6,MESFUNC3,MESFUNC5,MEASURE6,MESFUNC2,BINOP_2,PARTFUN3,INTEGRA2,PROB_4,SUPINF_1,UPROOTS,MESFUN6C,MESFUNC1,DOMAIN_1,RELSET_1,CKB11;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
theorem
Lm10: (for Omega being non empty  finite set holds (for M being (sigma_Measure of ( Trivial-SigmaField Omega )) holds (for f being (Function of Omega,( REAL )) holds (( M . Omega ) < ( +infty ) implies (ex x being (FinSequence of ( ExtREAL )) st ((( len x ) = ( card Omega ) & (for n being Nat holds (n in ( dom x ) implies ( x . n ) = ( ( R_EAL ( f . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) )))) & ( Integral (M,f) ) = ( Sum x )))))))
proof
let Omega being non empty  finite set;
let M being (sigma_Measure of ( Trivial-SigmaField Omega ));
let f being (Function of Omega,( REAL ));
set fm = ( max- f );
set Dm = ( dom fm );
reconsider am = ( fm * ( canFS Dm ) ) as (FinSequence of ( REAL )) by CKB17:1;
set fp = ( max+ f );
set Dp = ( dom fp );
reconsider ap = ( fp * ( canFS Dp ) ) as (FinSequence of ( REAL )) by CKB17:1;
set Sigma = ( Trivial-SigmaField Omega );
set D = ( dom f );
consider F being (Finite_Sep_Sequence of Sigma) such that ( dom f ) = ( union ( rng F ) ) and A1: ( dom F ) = ( dom ( canFS D ) ) and A2: (for k being Nat holds (k in ( dom F ) implies ( F . k ) = { ( ( canFS D ) . k ) })) and (for n being Nat holds (for x,y being (Element of Omega) holds (((n in ( dom F ) & x in ( F . n )) & y in ( F . n )) implies ( f . x ) = ( f . y )))) by CKB12:1;
set L = ( len F );
consider Fp being (Finite_Sep_Sequence of Sigma) such that A3: ( dom fp ) = ( union ( rng Fp ) ) and A4: ( dom Fp ) = ( dom ( canFS Dp ) ) and A5: (for k being Nat holds (k in ( dom Fp ) implies ( Fp . k ) = { ( ( canFS Dp ) . k ) })) and (for n being Nat holds (for x,y being (Element of Omega) holds (((n in ( dom Fp ) & x in ( Fp . n )) & y in ( Fp . n )) implies ( fp . x ) = ( fp . y )))) by CKB12:1;
defpred Pp[ Nat,set ]
 means
$2 = ( ( R_EAL ( ap . $1 ) ) * ( ( M * Fp ) . $1 ) );
A6: (for k being Nat holds (k in ( Seg L ) implies (ex x being (Element of ( ExtREAL )) st Pp[ k,x ])));
consider xp being (FinSequence of ( ExtREAL )) such that A7: (( dom xp ) = ( Seg L ) & (for k being Nat holds (k in ( Seg L ) implies Pp[ k,( xp . k ) ]))) from FINSEQ_1:sch 5(A6);
A8: ( dom Fp ) = ( dom ap ) by A4,CKB18:1;
A9: (for n being Nat holds (n in ( dom Fp ) implies (for x being set holds (x in ( Fp . n ) implies ( fp . x ) = ( ap . n )))))
proof
let n being Nat;
assume that
A10: n in ( dom Fp );
let x being set;
assume x in ( Fp . n );
then x in { ( ( canFS Dp ) . n ) } by A5,A10;
then x = ( ( canFS Dp ) . n ) by TARSKI:def 1;
hence ( fp . x ) = ( ap . n ) by A8,A10,FUNCT_1:12;
end;
reconsider a = ( f * ( canFS D ) ) as (FinSequence of ( REAL )) by CKB17:1;
A11: ( ( R_EAL ( - 1 ) ) * ( Integral (M,fm) ) ) = ( ( - ( R_EAL 1 ) ) * ( Integral (M,fm) ) ) by SUPINF_2:2
.= ( - ( ( R_EAL 1 ) * ( Integral (M,fm) ) ) ) by XXREAL_3:92
.= ( - ( Integral (M,fm) ) ) by XXREAL_3:81;
defpred PX[ Nat,set ]
 means
$2 = ( ( R_EAL ( a . $1 ) ) * ( ( M * F ) . $1 ) );
A12: (for k being Nat holds (k in ( Seg L ) implies (ex x being (Element of ( ExtREAL )) st PX[ k,x ])));
consider x being (FinSequence of ( ExtREAL )) such that A13: (( dom x ) = ( Seg L ) & (for k being Nat holds (k in ( Seg L ) implies PX[ k,( x . k ) ]))) from FINSEQ_1:sch 5(A12);
assume A14: ( M . Omega ) < ( +infty );
A15: (for n being Nat holds (n in ( dom ( canFS Omega ) ) implies ( M . { ( ( canFS Omega ) . n ) } ) in ( REAL )))
proof
let n being Nat;
assume n in ( dom ( canFS Omega ) );
then ( ( canFS Omega ) . n ) in ( rng ( canFS Omega ) ) by FUNCT_1:3;
then A16: { ( ( canFS Omega ) . n ) } c= Omega by ZFMISC_1:31;
Omega in Sigma by MEASURE1:7;
hence ( M . { ( ( canFS Omega ) . n ) } ) in ( REAL ) by A14,A16,CKB16:1;
end;
A17: ( dom f ) = Omega by FUNCT_2:def 1;
then A18: ( dom fm ) = Omega by RFUNCT_3:def 11;
then A19: fm is_integrable_on M by A14,CKB9:1,CKB14:1;
A20: ( dom x ) = ( dom F ) by A13,FINSEQ_1:def 3;
A21: (for n being Nat holds (n in ( dom x ) implies ( x . n ) = ( ( R_EAL ( f . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) )))
proof
let n being Nat;
assume A22: n in ( dom x );
then A23: ( ( M * F ) . n ) = ( M . ( F . n ) ) by A20,FUNCT_1:13
.= ( M . { ( ( canFS Omega ) . n ) } ) by A2,A17,A20,A22;
A24: ( f . ( ( canFS D ) . n ) ) = ( a . n ) by A1,A20,A22,FUNCT_1:13;
thus ( x . n ) = ( ( R_EAL ( a . n ) ) * ( ( M * F ) . n ) ) by A13,A22
.= ( ( R_EAL ( f . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) ) by A24,A23,FUNCT_2:def 1;
end;
x is (FinSequence of ( REAL ))
proof
let y being set;
assume y in ( rng x );
then consider n being (Element of ( NAT )) such that A25: n in ( dom x ) and A26: y = ( x . n ) by PARTFUN1:3;
reconsider z = ( M . { ( ( canFS Omega ) . n ) } ) as (Element of ( REAL )) by A1,A17,A20,A15,A25;
reconsider w = ( f . ( ( canFS Omega ) . n ) ) as (Element of ( REAL ));
( x . n ) = ( ( R_EAL ( f . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) ) by A21,A25
.= ( w * z ) by EXTREAL1:1;
hence y in ( REAL ) by A26;
end;
then reconsider x1 = x as (FinSequence of ( REAL ));
take x;
A27: (fm is_simple_func_in Sigma & fm is  nonnegative) by CKB14:1,MESFUNC6:61;
A28: ( dom Fp ) = ( dom F ) by A1,A4,RFUNCT_3:def 10;
then A29: ( dom xp ) = ( dom Fp ) by A7,FINSEQ_1:def 3;
A30: Dp = D by RFUNCT_3:def 10;
A31: (for n being Nat holds (n in ( dom xp ) implies ( xp . n ) = ( ( R_EAL ( fp . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) )))
proof
let n being Nat;
assume A32: n in ( dom xp );
then A33: ( ( M * Fp ) . n ) = ( M . ( Fp . n ) ) by A29,FUNCT_1:13
.= ( M . { ( ( canFS Omega ) . n ) } ) by A17,A5,A30,A29,A32;
A34: ( fp . ( ( canFS D ) . n ) ) = ( ap . n ) by A4,A30,A29,A32,FUNCT_1:13;
thus ( xp . n ) = ( ( R_EAL ( ap . n ) ) * ( ( M * Fp ) . n ) ) by A7,A32
.= ( ( R_EAL ( fp . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) ) by A34,A33,FUNCT_2:def 1;
end;
now
let y being set;
assume y in ( rng xp );
then consider n being (Element of ( NAT )) such that A35: n in ( dom xp ) and A36: y = ( xp . n ) by PARTFUN1:3;
reconsider z = ( M . { ( ( canFS Omega ) . n ) } ) as (Element of ( REAL )) by A17,A4,A30,A29,A15,A35;
reconsider w = ( fp . ( ( canFS Omega ) . n ) ) as (Element of ( REAL ));
( xp . n ) = ( ( R_EAL ( fp . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) ) by A31,A35
.= ( w * z ) by EXTREAL1:1;
hence y in ( REAL ) by A36;
end;
then ( rng xp ) c= ( REAL ) by TARSKI:def 3;
then reconsider xp1 = xp as (FinSequence of ( REAL )) by FINSEQ_1:def 4;
consider Fm being (Finite_Sep_Sequence of Sigma) such that A37: ( dom fm ) = ( union ( rng Fm ) ) and A38: ( dom Fm ) = ( dom ( canFS Dm ) ) and A39: (for k being Nat holds (k in ( dom Fm ) implies ( Fm . k ) = { ( ( canFS Dm ) . k ) })) and (for n being Nat holds (for x,y being (Element of Omega) holds (((n in ( dom Fm ) & x in ( Fm . n )) & y in ( Fm . n )) implies ( fm . x ) = ( fm . y )))) by CKB12:1;
defpred Pm[ Nat,set ]
 means
$2 = ( ( R_EAL ( am . $1 ) ) * ( ( M * Fm ) . $1 ) );
A40: (for k being Nat holds (k in ( Seg L ) implies (ex x being (Element of ( ExtREAL )) st Pm[ k,x ])));
consider xm being (FinSequence of ( ExtREAL )) such that A41: (( dom xm ) = ( Seg L ) & (for k being Nat holds (k in ( Seg L ) implies Pm[ k,( xm . k ) ]))) from FINSEQ_1:sch 5(A40);
A42: ( dom Fm ) = ( dom F ) by A1,A38,RFUNCT_3:def 11;
then A43: ( dom xm ) = ( dom Fm ) by A41,FINSEQ_1:def 3;
A44: Dm = D by RFUNCT_3:def 11;
A45: (for n being Nat holds (n in ( dom xm ) implies ( xm . n ) = ( ( R_EAL ( fm . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) )))
proof
let n being Nat;
assume A46: n in ( dom xm );
then A47: ( ( M * Fm ) . n ) = ( M . ( Fm . n ) ) by A43,FUNCT_1:13
.= ( M . { ( ( canFS Omega ) . n ) } ) by A17,A39,A44,A43,A46;
thus ( xm . n ) = ( ( R_EAL ( am . n ) ) * ( ( M * Fm ) . n ) ) by A41,A46
.= ( ( R_EAL ( fm . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) ) by A38,A43,A18,A46,A47,FUNCT_1:13;
end;
now
let y being set;
assume y in ( rng xm );
then consider n being (Element of ( NAT )) such that A48: n in ( dom xm ) and A49: y = ( xm . n ) by PARTFUN1:3;
reconsider z = ( M . { ( ( canFS Omega ) . n ) } ) as (Element of ( REAL )) by A17,A38,A44,A43,A15,A48;
reconsider w = ( fm . ( ( canFS Omega ) . n ) ) as (Element of ( REAL ));
( xm . n ) = ( ( R_EAL ( fm . ( ( canFS Omega ) . n ) ) ) * ( M . { ( ( canFS Omega ) . n ) } ) ) by A45,A48
.= ( w * z ) by EXTREAL1:1;
hence y in ( REAL ) by A49;
end;
then ( rng xm ) c= ( REAL ) by TARSKI:def 3;
then reconsider xm1 = xm as (FinSequence of ( REAL )) by FINSEQ_1:def 4;
A50: (( Sum xp ) = ( Sum xp1 ) & ( Sum xm ) = ( Sum xm1 )) by MESFUNC3:2;
( dom fp ) = Omega by A17,RFUNCT_3:def 10;
then A51: fp is_integrable_on M by A14,CKB9:1,CKB14:1;
A52: ( dom fm ) = ( dom f ) by RFUNCT_3:def 11;
then A53: fm is (Function of Omega,( REAL )) by A17,FUNCT_2:def 1;
then ( M . ( dom ( ( - 1 ) (#) fm ) ) ) < ( +infty ) by A14,FUNCT_2:def 1;
then ( ( - 1 ) (#) fm ) is_integrable_on M by A53,CKB9:1,CKB14:1;
then consider E being (Element of Sigma) such that A54: E = ( ( dom fp ) /\ ( dom ( ( - 1 ) (#) fm ) ) ) and A55: ( Integral (M,( fp + ( ( - 1 ) (#) fm ) )) ) = ( ( Integral (M,( fp | E )) ) + ( Integral (M,( ( ( - 1 ) (#) fm ) | E )) ) ) by A51,MESFUNC6:101;
A56: ( dom fp ) = ( dom f ) by RFUNCT_3:def 10;
then A57: fp is (Function of Omega,( REAL )) by A17,FUNCT_2:def 1;
( dom ( ( - 1 ) (#) fm ) ) = ( dom fm ) by VALUED_1:def 5
.= Omega by A52,FUNCT_2:def 1;
then A58: E = ( Omega /\ Omega ) by A56,A54,FUNCT_2:def 1
.= Omega;
then ( ( ( - 1 ) (#) fm ) | E ) = ( ( - 1 ) (#) fm ) by A53,FUNCT_2:33;
then A59: ( Integral (M,( fp + ( ( - 1 ) (#) fm ) )) ) = ( ( Integral (M,fp) ) + ( Integral (M,( ( - 1 ) (#) fm )) ) ) by A57,A55,A58,FUNCT_2:33
.= ( ( Integral (M,fp) ) + ( - ( Integral (M,fm) ) ) ) by A19,A11,MESFUNC6:102;
A60: ( dom Fm ) = ( dom am ) by A38,CKB18:1;
A61: (for n being Nat holds (n in ( dom Fm ) implies (for x being set holds (x in ( Fm . n ) implies ( fm . x ) = ( am . n )))))
proof
let n being Nat;
assume that
A62: n in ( dom Fm );
let x being set;
assume x in ( Fm . n );
then x in { ( ( canFS Dm ) . n ) } by A39,A62;
then x = ( ( canFS Dm ) . n ) by TARSKI:def 1;
hence ( fm . x ) = ( am . n ) by A60,A62,FUNCT_1:12;
end;
(fp is_simple_func_in Sigma & fp is  nonnegative) by CKB14:1,MESFUNC6:61;
then A63: ( Integral (M,fp) ) = ( Sum xp ) by A56,A3,A7,A29,A8,A9,CKB5:1;
( dom ( canFS D ) ) = ( Seg ( len F ) ) by A1,FINSEQ_1:def 3;
then A64: ( len F ) = ( len ( canFS D ) ) by FINSEQ_1:def 3;
A65: ( len x ) = L by A13,FINSEQ_1:def 3;
A66: ( dom ( xp1 - xm1 ) ) = ( ( dom xp1 ) /\ ( dom xm1 ) ) by VALUED_1:12
.= ( dom x1 ) by A28,A42,A13,A29,A43,FINSEQ_1:def 3;
A67: ( len xp1 ) = L by A7,FINSEQ_1:def 3
.= ( len xm1 ) by A41,FINSEQ_1:def 3;
A68: (for k being Nat holds (k in ( dom x1 ) implies ( ( xp1 - xm1 ) . k ) = ( x1 . k )))
proof
let k being Nat;
A69: f = ( fp - fm ) by MESFUNC6:42;
assume A70: k in ( dom x1 );
then reconsider z = ( M . { ( ( canFS Omega ) . k ) } ) as (Element of ( REAL )) by A1,A17,A20,A15;
A71: ( xm1 . k ) = ( ( R_EAL ( fm . ( ( canFS Omega ) . k ) ) ) * ( M . { ( ( canFS Omega ) . k ) } ) ) by A13,A41,A45,A70
.= ( ( fm . ( ( canFS Omega ) . k ) ) * z ) by EXTREAL1:1;
k in ( dom ( canFS Omega ) ) by A1,A20,A70,FUNCT_2:def 1;
then ( ( canFS Omega ) . k ) in ( rng ( canFS Omega ) ) by FUNCT_1:3;
then ( ( canFS Omega ) . k ) in Omega;
then A72: ( ( canFS Omega ) . k ) in ( dom f ) by FUNCT_2:def 1;
k in ( ( dom xp1 ) /\ ( dom xm1 ) ) by A13,A7,A41,A70;
then A73: k in ( dom ( xp1 - xm1 ) ) by VALUED_1:12;
( xp1 . k ) = ( ( R_EAL ( fp . ( ( canFS Omega ) . k ) ) ) * ( M . { ( ( canFS Omega ) . k ) } ) ) by A13,A7,A31,A70
.= ( ( fp . ( ( canFS Omega ) . k ) ) * z ) by EXTREAL1:1;
hence ( ( xp1 - xm1 ) . k ) = ( ( ( fp . ( ( canFS Omega ) . k ) ) * z ) - ( ( fm . ( ( canFS Omega ) . k ) ) * z ) ) by A73,A71,VALUED_1:13
.= ( ( ( fp . ( ( canFS Omega ) . k ) ) - ( fm . ( ( canFS Omega ) . k ) ) ) * z )
.= ( ( f . ( ( canFS Omega ) . k ) ) * z ) by A72,A69,VALUED_1:13
.= ( ( R_EAL ( f . ( ( canFS Omega ) . k ) ) ) * ( M . { ( ( canFS Omega ) . k ) } ) ) by EXTREAL1:1
.= ( x1 . k ) by A21,A70;
end;
( Integral (M,f) ) = ( Integral (M,( fp - fm )) ) by MESFUNC6:42
.= ( ( Sum xp ) - ( Sum xm ) ) by A52,A37,A27,A41,A43,A63,A59,A60,A61,CKB5:1
.= ( ( Sum xp1 ) - ( Sum xm1 ) ) by A50,SUPINF_2:3
.= ( Sum ( xp1 - xm1 ) ) by A67,INTEGRA5:2
.= ( Sum x ) by A66,A68,FINSEQ_1:13,MESFUNC3:2;
hence thesis by A17,A21,A65,A64,UPROOTS:3;
end;
