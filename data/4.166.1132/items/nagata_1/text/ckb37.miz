environ
vocabularies NUMBERS,XBOOLE_0,PRE_TOPC,METRIC_1,REAL_1,XXREAL_0,CARD_1,ARYTM_3,COMPLEX1,ARYTM_1,SETFAM_1,NATTRA_1,RCOMP_1,SUBSET_1,STRUCT_0,TARSKI,ZFMISC_1,PCOMPS_1,FINSET_1,FUNCT_1,CARD_3,FUNCOP_1,COMPTS_1,RELAT_1,ORDINAL1,RLVECT_3,XREAL_0,CARD_5,NEWTON,FINSEQ_1,PSCOMP_1,ORDINAL2,TOPMETR,TMAP_1,BINOP_1,FUNCT_2,SETWISEO,COH_SP,FINSOP_1,NAT_1,RELAT_2,NAGATA_1;
notations BINOP_1,SETWISEO,TARSKI,XBOOLE_0,SUBSET_1,SETFAM_1,RELAT_1,FUNCT_1,ORDINAL1,COMPLEX1,RELSET_1,FUNCT_2,FINSEQ_1,ZFMISC_1,PCOMPS_1,PRE_TOPC,FINSET_1,CARD_1,XCMPLX_0,NUMBERS,XXREAL_0,XREAL_0,REAL_1,NAT_1,FINSOP_1,VALUED_1,STRUCT_0,TOPS_2,COMPTS_1,METRIC_1,NEWTON,CARD_3,PROB_1,FUNCOP_1,CANTOR_1,DOMAIN_1,TOPMETR,PSCOMP_1,BORSUK_1,TMAP_1,CKB3,CKB20,CKB21,CKB22,CKB23,CKB26,CKB27,CKB28,CKB33,CKB34;
definitions PCOMPS_1,TARSKI,BINOP_1,SUBSET_1,COMPTS_1,PRE_TOPC,STRUCT_0,CKB3,CKB23,CKB26,CKB27,CKB33,CKB34;
theorems FUNCT_1,FUNCT_2,METRIC_1,XREAL_0,XCMPLX_1,ABSVALUE,TOPMETR,TMAP_1,CARD_1,PCOMPS_1,PCOMPS_2,BORSUK_1,XBOOLE_1,TARSKI,SETFAM_1,XBOOLE_0,SUBSET_1,TOPS_1,TOPS_2,PRE_TOPC,REALSET1,COMPTS_1,CARD_3,URYSOHN1,NAT_1,YELLOW_9,FINSEQ_1,CARD_2,FINSOP_1,SETWISEO,NEWTON,TOPREAL6,ZFMISC_1,BINOP_1,SEQ_2,PROB_1,FUNCOP_1,XREAL_1,COMPLEX1,XXREAL_0,PREPOWER,ORDINAL1,VALUED_1,CKB1,CKB2,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB16,CKB17,CKB18,CKB19,CKB23,CKB24,CKB26,CKB27,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36;
schemes FUNCT_1,FRAENKEL,FUNCT_2,NAT_1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,FINSEQ_1,CARD_LAR,STRUCT_0,TOPS_1,COMPTS_1,METRIC_1,BORSUK_1,TOPMETR,PSCOMP_1,VALUED_0,VALUED_1,FUNCT_2,CARD_3,FUNCT_1,PRE_TOPC,ZFMISC_1,CKB4,CKB5,CKB15,CKB25,CKB29,CKB30;
constructors SETFAM_1,SETWISEO,REAL_1,SQUARE_1,NAT_1,PROB_1,FUNCOP_1,FINSOP_1,NEWTON,REALSET1,CARD_5,TOPS_2,COMPTS_1,TMAP_1,CANTOR_1,PCOMPS_1,PSCOMP_1,URYSOHN3,CKB3,CKB21,CKB22,CKB23,CKB26,CKB27,CKB33,CKB34;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve T for non empty TopSpace;
reserve A for (Subset of T);
reserve p for (Point of T);
reserve x for set;
reserve y for set;
reserve r1 for Real;
reserve n for (Element of ( NAT ));
theorem
(for T holds (T is  metrizable implies (ex Un being (FamilySequence of T) st Un is  Basis_sigma_locally_finite)))
proof
let T;
assume A1: T is  metrizable;
then consider metr being (Function of [: (the carrier of T),(the carrier of T) :],( REAL )) such that A2: metr is_metric_of (the carrier of T) and A3: ( Family_open_set ( SpaceMetr ((the carrier of T),metr) ) ) = (the topology of T) by PCOMPS_1:def 8;
set PM = ( SpaceMetr ((the carrier of T),metr) );
reconsider PM as non empty MetrSpace by A2,PCOMPS_1:36;
deffunc BALL((Element of ( NAT ))) = { ( Ball (x,( 1 / ( 2 |^ $1 ) )) ) where x is (Element of PM): x is (Element of PM) };
defpred E[ (Element of ( NAT )),set ]
 means
$2 = BALL($1);
A4: (for k being (Element of ( NAT )) holds (ex y being (Subset-Family of T) st E[ k,y ]))
proof
let k being (Element of ( NAT ));
set Ak = BALL(k);
Ak c= ( bool (the carrier of T) )
proof
let B being set;
assume B in Ak;
then (ex x being (Element of PM) st (B = ( Ball (x,( 1 / ( 2 |^ k ) )) ) & x is (Element of PM)));
then B in ( Family_open_set PM ) by PCOMPS_1:29;
hence thesis by A3;
end;
hence thesis;
end;
consider FB being (Function of ( NAT ),( bool ( bool (the carrier of T) ) )) such that A5: (for k being (Element of ( NAT )) holds E[ k,( FB . k ) ]) from FUNCT_2:sch 3(A4);
defpred P[ set,set ]
 means
(ex W being (Subset-Family of T) st ((((W = $2 & W is  open) & W is (Cover of T)) & W is_finer_than ( FB . $1 )) & W is  locally_finite));
set TPM = ( TopSpaceMetr PM );
A6: ( [#] T ) = ( [#] TPM ) by A2,PCOMPS_2:4;
A7: (for n holds (ex PP being (Subset-Family of T) st (((PP is_finer_than ( FB . n ) & PP is (Cover of T)) & PP is  open) & PP is  locally_finite)))
proof
let n;
( [#] TPM ) c= ( union ( FB . n ) )
proof
let x;
assume x in ( [#] TPM );
then reconsider x9 = x as (Element of PM);
(( dist (x9,x9) ) = ( 0 ) & ( 2 |^ n ) > ( 0 )) by METRIC_1:1,NEWTON:83;
then ( dist (x9,x9) ) < ( 1 / ( 2 |^ n ) ) by XREAL_1:139;
then A8: x9 in ( Ball (x9,( 1 / ( 2 |^ n ) )) ) by METRIC_1:11;
( Ball (x9,( 1 / ( 2 |^ n ) )) ) in BALL(n);
then ( Ball (x9,( 1 / ( 2 |^ n ) )) ) in ( FB . n ) by A5;
hence thesis by A8,TARSKI:def 4;
end;
then A9: ( FB . n ) is (Cover of T) by A6,SETFAM_1:def 11;
(for U being (Subset of T) holds (U in ( FB . n ) implies U is  open))
proof
let U being (Subset of T);
assume U in ( FB . n );
then U in BALL(n) by A5;
then (ex x being (Element of PM) st (U = ( Ball (x,( 1 / ( 2 |^ n ) )) ) & x is (Element of PM)));
then U in (the topology of T) by A3,PCOMPS_1:29;
hence thesis by PRE_TOPC:def 2;
end;
then ( FB . n ) is  open by TOPS_2:def 1;
then (ex PP being (Subset-Family of T) st (((PP is  open & PP is (Cover of T)) & PP is_finer_than ( FB . n )) & PP is  locally_finite)) by A1,A9,PCOMPS_2:6;
hence thesis;
end;
A10: (for k being set holds (k in ( NAT ) implies (ex y st (y in ( bool ( bool (the carrier of T) ) ) & P[ k,y ]))))
proof
let k being set;
assume k in ( NAT );
then reconsider k as (Element of ( NAT ));
(ex PP being (Subset-Family of T) st (((PP is_finer_than ( FB . k ) & PP is (Cover of T)) & PP is  open) & PP is  locally_finite)) by A7;
hence thesis;
end;
consider UC being (FamilySequence of T) such that A11: (for x holds (x in ( NAT ) implies P[ x,( UC . x ) ])) from FUNCT_2:sch 1(A10);
A12: (for A being (Subset of T) holds (A is  open implies (for p being (Point of T) holds (p in A implies (ex B being (Subset of T) st ((B in ( Union UC ) & p in B) & B c= A))))))
proof
let A;
assume A is  open;
then A13: A in ( Family_open_set PM ) by A3,PRE_TOPC:def 2;
let p;
assume A14: p in A;
then reconsider p as (Element of PM) by A13;
consider r1 such that A15: r1 > ( 0 ) and A16: ( Ball (p,r1) ) c= A by A14,A13,PCOMPS_1:def 4;
consider n such that A17: ( 1 / ( 2 |^ n ) ) <= r1 by A15,PREPOWER:92;
A18: P[ ( n + 1 ),( UC . ( n + 1 ) ) ] by A11;
then ( union ( UC . ( n + 1 ) ) ) = (the carrier of T) by SETFAM_1:45;
then consider B being set such that A19: p in B and A20: B in ( UC . ( n + 1 ) ) by TARSKI:def 4;
reconsider B as (Subset of PM) by A2,A20,PCOMPS_2:4;
consider B1 being set such that A21: B1 in ( FB . ( n + 1 ) ) and A22: B c= B1 by A18,A20,SETFAM_1:def 2;
B1 in BALL(( n + 1 )) by A5,A21;
then consider q being (Element of PM) such that A23: B1 = ( Ball (q,( 1 / ( 2 |^ ( n + 1 ) ) )) ) and q is (Element of PM);
A24: ( dist (q,p) ) < ( 1 / ( 2 |^ ( n + 1 ) ) ) by A19,A22,A23,METRIC_1:11;
now
let r being (Element of PM);
assume r in B;
then ( dist (q,r) ) < ( 1 / ( 2 |^ ( n + 1 ) ) ) by A22,A23,METRIC_1:11;
then (( dist (p,r) ) <= ( ( dist (q,p) ) + ( dist (q,r) ) ) & ( ( dist (q,p) ) + ( dist (q,r) ) ) < ( ( 1 / ( 2 |^ ( n + 1 ) ) ) + ( 1 / ( 2 |^ ( n + 1 ) ) ) )) by A24,METRIC_1:4,XREAL_1:8;
then ( dist (p,r) ) < ( 2 * ( 1 / ( 2 |^ ( n + 1 ) ) ) ) by XXREAL_0:2;
then ( dist (p,r) ) < ( ( 1 / ( ( 2 |^ n ) * 2 ) ) * 2 ) by NEWTON:6;
then ( dist (p,r) ) < ( 1 / ( 2 |^ n ) ) by XCMPLX_1:92;
then ( dist (p,r) ) < r1 by A17,XXREAL_0:2;
hence r in ( Ball (p,r1) ) by METRIC_1:11;
end;
then A25: B c= ( Ball (p,r1) ) by SUBSET_1:2;
B in ( Union UC ) by A20,PROB_1:12;
hence thesis by A16,A19,A25,XBOOLE_1:1;
end;
(for n holds ( UC . n ) is  locally_finite)
proof
let n;
P[ n,( UC . n ) ] by A11;
hence thesis;
end;
then A26: UC is  sigma_locally_finite by CKB26:def 1;
( Union UC ) c= (the topology of T)
proof
let u being set;
assume u in ( Union UC );
then consider k being (Element of ( NAT )) such that A27: u in ( UC . k ) by PROB_1:12;
reconsider u9 = u as (Subset of T) by A27;
P[ k,( UC . k ) ] by A11;
then u9 is  open by A27,TOPS_2:def 1;
hence thesis by PRE_TOPC:def 2;
end;
then ( Union UC ) is (Basis of T) by A12,YELLOW_9:32;
then UC is  Basis_sigma_locally_finite by A26,CKB34:def 1;
hence thesis;
end;
