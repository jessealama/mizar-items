environ
vocabularies NUMBERS,CARD_1,INT_1,POWER,SUBSET_1,XXREAL_0,RELAT_1,ARYTM_3,ARYTM_1,NAT_1,AMI_3,AFINSQ_1,AMI_1,ORDINAL4,GRAPHSP,SCM_1,FINSEQ_1,MSUALG_1,FUNCT_1,PRE_FF,FSM_1,NEWTON,FIB_FUSC,SCMNORM,PARTFUN1,TARSKI;
notations TARSKI,ENUMSET1,XCMPLX_0,SUBSET_1,NUMBERS,INT_1,NAT_1,NEWTON,POWER,CARD_3,ORDINAL4,RELAT_1,FUNCT_1,PARTFUN1,AFINSQ_1,FINSEQ_1,MEMSTR_0,COMPOS_1,EXTPRO_1,SCM_1,AMI_3,PRE_FF,XXREAL_0,CKB17;
definitions AFINSQ_1,MEMSTR_0,CKB17;
theorems NAT_1,INT_1,POWER,NEWTON,SCM_1,PRE_FF,AMI_3,XREAL_1,XXREAL_0,ORDINAL1,COMPOS_1,EXTPRO_1,AFINSQ_1,GRFUNC_1,CARD_1,ENUMSET1,RELAT_1,MEMSTR_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18;
schemes NAT_1;
registrations SETFAM_1,NUMBERS,XREAL_0,INT_1,AMI_3,XBOOLE_0,ORDINAL1,AFINSQ_1,CARD_3,FUNCT_1,RELSET_1,COMPOS_1,SCM_1,PBOOLE,REAL_1,MEMSTR_0;
constructors XXREAL_0,REAL_1,NAT_1,NEWTON,POWER,PRE_FF,SCM_1,AFINSQ_1,ORDINAL4,FINSUB_1,CARD_3,ENUMSET1,PRE_POLY,NAT_D,MEMSTR_0,CKB17;
requirements REAL,NUMERALS,SUBSET,ARITHM,BOOLE;
begin
reserve F for  total ( NAT ) -defined (the Instructions of ( SCM )) -valued Function;
theorem
(( Fib_Program ) c= F implies (for N being (Element of ( NAT )) holds (for s being ( 0 ) -started (State-consisting of ( 0 ),( ( ( <* 1 *> ^ <* N *> ) ^ <* ( 0 ) *> ) ^ <* ( 0 ) *> )) holds (((F halts_on s & (N = ( 0 ) implies ( LifeSpan (F,s) ) = 1)) & (N > ( 0 ) implies ( LifeSpan (F,s) ) = ( ( 6 * N ) - 2 ))) & ( ( Result (F,s) ) . ( dl. 3 ) ) = ( Fib N )))))
proof
assume A1: ( Fib_Program ) c= F;
let N being (Element of ( NAT ));
let s being ( 0 ) -started (State-consisting of ( 0 ),( ( ( <* 1 *> ^ <* N *> ) ^ <* ( 0 ) *> ) ^ <* ( 0 ) *> ));
set C1 = ( dl. ( 0 ) );
set n = ( dl. 1 );
set FP = ( dl. 2 );
set FC = ( dl. 3 );
set AUX = ( dl. 4 );
set L6 = 6;
set L7 = 7;
set L8 = 8;
set L0 = ( 0 );
set L1 = 1;
set L2 = 2;
set L3 = 3;
set L4 = 4;
set L5 = 5;
A2: (( IC s ) = L0 & ( F . L0 ) = ( n >0_goto L2 )) by A1,CKB18:1,MEMSTR_0:def 9;
set s1 = ( Comput (F,s,( ( 0 ) + 1 )) );
set s0 = ( Comput (F,s,( 0 )) );
A3: s = s0 by EXTPRO_1:2;
( s . C1 ) = 1 by SCM_1:1;
then A4: ( s1 . C1 ) = 1 by A2,A3,SCM_1:11;
A5: ( F . L3 ) = ( SubFrom (n,C1) ) by A1,CKB18:1;
( s . FP ) = ( 0 ) by SCM_1:1;
then A6: ( s1 . FP ) = ( 0 ) by A2,A3,SCM_1:11;
A7: ( F . L4 ) = ( n =0_goto L1 ) by A1,CKB18:1;
( s . FC ) = ( 0 ) by SCM_1:1;
then A8: ( s1 . FC ) = ( 0 ) by A2,A3,SCM_1:11;
A9: ( F . L6 ) = ( FP := FC ) by A1,CKB18:1;
defpred P[ (Element of ( NAT )) ]
 means
($1 < N implies (for u being (State of ( SCM )) holds (u = ( Comput (F,s,( ( 6 * $1 ) + 3 )) ) implies ((((( u . C1 ) = 1 & ( u . n ) = ( ( N - 1 ) - $1 )) & ( u . FP ) = ( Fib $1 )) & ( u . FC ) = ( Fib ( $1 + 1 ) )) & ( IC u ) = L4))));
A10: ( F . L2 ) = ( FC := C1 ) by A1,CKB18:1;
A11: ( F . L7 ) = ( AddTo (FC,AUX) ) by A1,CKB18:1;
A12: ( F . L8 ) = ( SCM-goto L3 ) by A1,CKB18:1;
A13: ( F . L5 ) = ( AUX := FP ) by A1,CKB18:1;
A14: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume that
A15: (k < N implies (for u being (State of ( SCM )) holds (u = ( Comput (F,s,( ( 6 * k ) + 3 )) ) implies ((((( u . C1 ) = 1 & ( u . n ) = ( ( N - 1 ) - k )) & ( u . FP ) = ( Fib k )) & ( u . FC ) = ( Fib ( k + 1 ) )) & ( IC u ) = L4))))
and
A16: ( k + 1 ) < N;
set b = ( ( 6 * k ) + 3 );
set s5 = ( Comput (F,s,( b + 1 )) );
set s6 = ( Comput (F,s,( ( b + 1 ) + 1 )) );
set s7 = ( Comput (F,s,( ( ( b + 1 ) + 1 ) + 1 )) );
set s8 = ( Comput (F,s,( ( ( ( b + 1 ) + 1 ) + 1 ) + 1 )) );
set s9 = ( Comput (F,s,( ( ( ( ( b + 1 ) + 1 ) + 1 ) + 1 ) + 1 )) );
set s10 = ( Comput (F,s,( ( ( ( ( ( b + 1 ) + 1 ) + 1 ) + 1 ) + 1 ) + 1 )) );
set s4 = ( Comput (F,s,( ( 6 * k ) + 3 )) );
A17: ( IC s4 ) = L4 by A15,A16,NAT_1:13;
let t being (State of ( SCM ));
assume A18: t = ( Comput (F,s,( ( 6 * ( k + 1 ) ) + 3 )) );
A19: ( s4 . n ) = ( ( N - 1 ) - k ) by A15,A16,NAT_1:13;
then ( s4 . n ) <> ( 0 ) by A16;
then A20: ( IC s5 ) = ( 4 + 1 ) by A7,A17,SCM_1:10;
then A21: ( IC s6 ) = ( 5 + 1 ) by A13,SCM_1:4;
then A22: ( IC s7 ) = ( 6 + 1 ) by A9,SCM_1:4;
then A23: ( IC s8 ) = ( 7 + 1 ) by A11,SCM_1:5;
then A24: ( IC s9 ) = L3 by A12,SCM_1:9;
then A25: ( IC s10 ) = ( 3 + 1 ) by A5,SCM_1:6;
( s4 . C1 ) = 1 by A15,A16,NAT_1:13;
then ( s5 . C1 ) = 1 by A7,A17,SCM_1:10;
then ( s6 . C1 ) = 1 by A13,A20,CKB13:1,SCM_1:4;
then ( s7 . C1 ) = 1 by A9,A21,CKB8:1,SCM_1:4;
then ( s8 . C1 ) = 1 by A11,A22,CKB9:1,SCM_1:5;
then A26: ( s9 . C1 ) = 1 by A12,A23,SCM_1:9;
( s4 . FC ) = ( Fib ( k + 1 ) ) by A15,A16,NAT_1:13;
then ( s5 . FC ) = ( Fib ( k + 1 ) ) by A7,A17,SCM_1:10;
then A27: ( s6 . FC ) = ( Fib ( k + 1 ) ) by A13,A20,CKB16:1,SCM_1:4;
then A28: ( s7 . FC ) = ( Fib ( k + 1 ) ) by A9,A21,CKB12:1,SCM_1:4;
( s4 . FP ) = ( Fib k ) by A15,A16,NAT_1:13;
then ( s5 . FP ) = ( Fib k ) by A7,A17,SCM_1:10;
then ( s6 . AUX ) = ( Fib k ) by A13,A20,SCM_1:4;
then A29: ( s7 . AUX ) = ( Fib k ) by A9,A21,CKB15:1,SCM_1:4;
( s8 . FC ) = ( ( s7 . AUX ) + ( s7 . FC ) ) by A11,A22,SCM_1:5
.= ( Fib ( ( k + 1 ) + 1 ) ) by A28,A29,PRE_FF:1;
then A30: ( s9 . FC ) = ( Fib ( ( k + 1 ) + 1 ) ) by A12,A23,SCM_1:9;
( s7 . FP ) = ( Fib ( k + 1 ) ) by A9,A21,A27,SCM_1:4;
then ( s8 . FP ) = ( Fib ( k + 1 ) ) by A11,A22,CKB12:1,SCM_1:5;
then A31: ( s9 . FP ) = ( Fib ( k + 1 ) ) by A12,A23,SCM_1:9;
( s5 . n ) = ( ( N - 1 ) - k ) by A7,A19,A17,SCM_1:10;
then ( s6 . n ) = ( ( N - 1 ) - k ) by A13,A20,CKB14:1,SCM_1:4;
then ( s7 . n ) = ( ( N - 1 ) - k ) by A9,A21,CKB10:1,SCM_1:4;
then ( s8 . n ) = ( ( N - 1 ) - k ) by A11,A22,CKB11:1,SCM_1:5;
then ( s9 . n ) = ( ( N - 1 ) - k ) by A12,A23,SCM_1:9;
then ( s10 . n ) = ( ( ( N - 1 ) - k ) - 1 ) by A5,A24,A26,SCM_1:6;
hence thesis by A5,A18,A24,A26,A31,A30,A25,CKB7:1,CKB10:1,CKB11:1,SCM_1:6;
end;
A32: ( F . L1 ) = ( halt ( SCM ) ) by A1,CKB18:1;
A33: ( s . n ) = N by SCM_1:1;
then A34: ( s1 . n ) = N by A2,A3,SCM_1:11;
A35: P[ ( 0 ) ]
proof
set s3 = ( Comput (F,s,( 2 + 1 )) );
set s2 = ( Comput (F,s,( 1 + 1 )) );
assume ( 0 ) < N;
then A36: ( IC s1 ) = L2 by A2,A33,A3,SCM_1:11;
then A37: (( s2 . FC ) = 1 & ( s2 . C1 ) = 1) by A10,A4,A8,SCM_1:4;
let t being (State of ( SCM ));
assume A38: t = ( Comput (F,s,( ( 6 * ( 0 ) ) + 3 )) );
A39: (( s2 . n ) = N & ( s2 . FP ) = ( 0 )) by A10,A34,A6,A36,CKB11:1,CKB12:1,SCM_1:4;
A40: ( IC s2 ) = ( 2 + 1 ) by A10,A36,SCM_1:4;
then ( IC s3 ) = ( 3 + 1 ) by A5,SCM_1:6;
hence thesis by A5,A38,A37,A39,A40,CKB7:1,CKB10:1,CKB11:1,PRE_FF:1,SCM_1:6;
end;
A41: (for k being (Element of ( NAT )) holds P[ k ]) from NAT_1:sch 1(A35,A14);
per cases  by NAT_1:6;
suppose A42: N = ( 0 );

then A43: ( F . ( IC s1 ) ) = ( halt ( SCM ) ) by A2,A32,A33,A3,SCM_1:11;
hence F halts_on s by EXTPRO_1:30;
hereby
assume N = ( 0 );
( halt ( SCM ) ) <> ( n >0_goto L2 ) by SCM_1:12;
hence ( LifeSpan (F,s) ) = 1 by A2,A3,A43,EXTPRO_1:33;
end;
thus (N > ( 0 ) implies ( LifeSpan (F,s) ) = ( ( 6 * N ) - 2 )) by A42;
thus thesis by A8,A42,A43,EXTPRO_1:31,PRE_FF:1;
end;
suppose (ex k being Nat st N = ( k + 1 ));

then consider k being Nat such that A44: N = ( k + 1 );
reconsider k as (Element of ( NAT )) by ORDINAL1:def 12;
set r = ( Comput (F,s,( ( 6 * k ) + 3 )) );
A45: k < N by A44,NAT_1:13;
then A46: ( IC r ) = L4 by A41;
A47: ( r . FC ) = ( Fib ( k + 1 ) ) by A41,A45;
set t = ( Comput (F,s,( ( ( 6 * k ) + 3 ) + 1 )) );
( r . n ) = ( ( k + ( 1 - 1 ) ) - k ) by A41,A44,A45
.= ( 0 );
then A48: ( IC t ) = L1 by A7,A46,SCM_1:10;
hence F halts_on s by A32,EXTPRO_1:30;
thus (N = ( 0 ) implies ( LifeSpan (F,s) ) = 1) by A44,NAT_1:5;
thus (N > ( 0 ) implies ( LifeSpan (F,s) ) = ( ( 6 * N ) - 2 )) by A32,A44,A46,A48,EXTPRO_1:33;
thus ( ( Result (F,s) ) . FC ) = ( t . FC ) by A32,A48,EXTPRO_1:31
.= ( Fib N ) by A7,A44,A47,A46,SCM_1:10;
end;
end;
