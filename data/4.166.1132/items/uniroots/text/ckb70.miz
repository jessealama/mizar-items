environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,XXREAL_0,CARD_1,ARYTM_3,NAT_1,FINSEQ_1,RELAT_1,FUNCT_1,TARSKI,COMPLFLD,COMPLEX1,PARTFUN1,CARD_3,STRUCT_0,REAL_1,ORDINAL4,FINSET_1,UPROOTS,ARYTM_1,POLYNOM2,AFINSQ_1,GROUP_1,INT_1,HAHNBAN1,SQUARE_1,POWER,SIN_COS,BINOP_1,ALGSTR_0,FINSEQ_2,MOD_2,VECTSP_1,VECTSP_2,REALSET1,ZFMISC_1,SUPINF_2,COMPTRIG,RAT_1,PREPOWER,XREAL_0,ORDINAL1,NEWTON,XCMPLX_0,INT_2,BINOP_2,GROUP_2,POLYNOM1,POLYNOM3,FUNCT_4,ALGSEQ_1,VALUED_0,POLYNOM5,SGRAPH1,PRE_POLY,GRAPH_2,MESFUNC1,UNIROOTS;
notations TARSKI,XBOOLE_0,SUBSET_1,REALSET1,CARD_1,NUMBERS,XREAL_0,ZFMISC_1,XXREAL_0,COMPLEX1,REAL_1,SQUARE_1,INT_1,INT_2,NAT_1,NAT_D,PREPOWER,POWER,BINOP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,RAT_1,DOMAIN_1,FINSET_1,BINOP_2,STRUCT_0,ALGSTR_0,VECTSP_2,VECTSP_1,GROUP_4,RVSUM_1,ALGSEQ_1,COMPLFLD,HAHNBAN1,POLYNOM3,POLYNOM4,POLYNOM5,COMPTRIG,GROUP_2,NEWTON,GROUP_1,MOD_2,GRAPH_2,ORDINAL1,PRE_POLY,FVSUM_1,UPROOTS,SIN_COS,FUNCT_7,FINSEQ_2,CKB21,CKB29,CKB48,CKB50,CKB63;
definitions TARSKI,GROUP_1,XBOOLE_0,BINOP_1,REALSET1,SQUARE_1,HAHNBAN1,POLYNOM3,FINSEQ_2,COMPLEX1,GROUP_4,ALGSTR_0,STRUCT_0,CKB21,CKB29,CKB48,CKB50,CKB63;
theorems GROUP_1,CARD_1,FINSEQ_1,ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,RELAT_1,TARSKI,XBOOLE_0,XBOOLE_1,VECTSP_1,PREPOWER,COMPTRIG,COMPLFLD,BINOP_1,XCMPLX_1,COMPLEX1,HAHNBAN1,SIN_COS,POWER,SIN_COS2,POLYNOM5,INT_1,COMPLEX2,XCMPLX_0,XREAL_0,SQUARE_1,RVSUM_1,FVSUM_1,FINSEQ_3,FINSEQ_2,FINSEQ_4,POLYNOM4,INT_2,WSIERP_1,NAT_2,PEPIN,POLYNOM3,COMPUT_1,NORMSP_1,FUNCT_7,ALGSEQ_1,RLVECT_1,NEWTON,POLYNOM2,MATRIX_3,VECTSP_2,MOD_2,CARD_2,GRAPH_2,FINSEQ_5,UPROOTS,GROUP_2,BINOP_2,XREAL_1,XXREAL_0,GROUP_4,FUNCOP_1,ORDINAL1,FINSOP_1,NAT_D,PARTFUN1,PRE_POLY,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB21,CKB22,CKB23,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69;
schemes NAT_1,FUNCT_2,FINSEQ_1,INT_1,RECDEF_1,CKB2;
registrations RELAT_1,FUNCT_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,CARD_1,MEMBERED,FINSEQ_1,FINSEQ_2,REALSET1,WSIERP_1,STRUCT_0,GROUP_1,VECTSP_1,COMPLFLD,QUOFIELD,POLYNOM3,POLYNOM5,VALUED_0,ALGSTR_0,POWER,UPROOTS,FUNCT_2,RELSET_1,PRE_POLY,XBOOLE_0,ZFMISC_1,CKB19,CKB20,CKB25,CKB37,CKB38,CKB55;
constructors WELLORD2,BINOP_1,REAL_1,SQUARE_1,NAT_D,FINSEQOP,FINSOP_1,RVSUM_1,PREPOWER,POWER,REALSET1,SIN_COS,GROUP_4,MOD_2,MATRIX_2,HAHNBAN1,GRAPH_2,POLYNOM4,POLYNOM5,UPROOTS,SEQ_1,RECDEF_1,BINOP_2,RELSET_1,PBOOLE,FUNCT_7,POLYNOM1,NEWTON,FVSUM_1,CKB21,CKB29,CKB48,CKB50,CKB63;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
theorem
Th58: (for n,ni being non  empty (Element of ( NAT )) holds ((ni < n & ni divides n) implies (ex f being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) st (ex p being (Polynomial of ( F_Complex )) st (((p = ( Product f ) & ( dom f ) = ( Seg n )) & (for i being non  empty (Element of ( NAT )) holds (i in ( Seg n ) implies (((((not i divides n) or i divides ni) or i = n) implies ( f . i ) = <% ( 1_ ( F_Complex ) ) %>) & (((i divides n & (not i divides ni)) & i <> n) implies ( f . i ) = ( cyclotomic_poly i )))))) & ( unital_poly (( F_Complex ),n) ) = ( ( ( unital_poly (( F_Complex ),ni) ) *' ( cyclotomic_poly n ) ) *' p ))))))
proof
set cMGFC = (the carrier of ( MultGroup ( F_Complex ) ));
set cPRFC = (the carrier of ( Polynom-Ring ( F_Complex ) ));
let n being non  empty (Element of ( NAT ));
let ni being non  empty (Element of ( NAT ));
assume that
A1: ni < n
and
A2: ni divides n;
set rbp = { y where y is (Element of cMGFC): ((( ord y ) divides n & (not ( ord y ) divides ni)) & ( ord y ) <> n) };
rbp c= ( n -roots_of_1 )
proof
let x being set;
assume x in rbp;
then (ex y being (Element of cMGFC) st (((x = y & ( ord y ) divides n) & (not ( ord y ) divides ni)) & ( ord y ) <> n));
hence thesis by CKB45:1;
end;
then reconsider rbp as  finite (Subset of ( F_Complex )) by XBOOLE_1:1;
A3: ( n -roots_of_1 ) c= cMGFC by CKB43:1;
set bp = ( (rbp,1) -bag );
defpred P[ set,set ]
 means
(ex d being non  empty Nat st (($1 = d & ((((not d divides n) or d divides ni) or d = n) implies $2 = <% ( 1_ ( F_Complex ) ) %>)) & (((d divides n & (not d divides ni)) & d <> n) implies $2 = ( cyclotomic_poly d ))));
A4:now
let i being Nat;
assume A5: i in ( Seg n );
then A6: i is non  empty by FINSEQ_1:1;
per cases ;
suppose A7: (((not i divides n) or i divides ni) or i = n);

<% ( 1_ ( F_Complex ) ) %> is (Element of cPRFC) by POLYNOM3:def 10;
hence (ex x being (Element of cPRFC) st P[ i,x ]) by A6,A7;
end;
suppose A8: ((i divides n & (not i divides ni)) & i <> n);

reconsider i9 = i as non  empty (Element of ( NAT )) by A5,FINSEQ_1:1;
( cyclotomic_poly i9 ) is (Element of cPRFC) by POLYNOM3:def 10;
hence (ex x being (Element of cPRFC) st P[ i,x ]) by A8;
end;
end;
consider f being (FinSequence of cPRFC) such that A9: ( dom f ) = ( Seg n ) and A10: (for i being Nat holds (i in ( Seg n ) implies P[ i,( f . i ) ])) from FINSEQ_1:sch 5(A4);
A11:now
let i being non  empty (Element of ( NAT ));
assume i in ( Seg n );
then (ex d being non  empty Nat st ((i = d & ((((not d divides n) or d divides ni) or d = n) implies ( f . i ) = <% ( 1_ ( F_Complex ) ) %>)) & (((d divides n & (not d divides ni)) & d <> n) implies ( f . i ) = ( cyclotomic_poly d )))) by A10;
hence (((((not i divides n) or i divides ni) or i = n) implies ( f . i ) = <% ( 1_ ( F_Complex ) ) %>) & (((i divides n & (not i divides ni)) & i <> n) implies ( f . i ) = ( cyclotomic_poly i )));
end;
then ( Product f ) = ( poly_with_roots bp ) by A9,CKB69:1;
then reconsider p = ( Product f ) as (Polynomial of ( F_Complex ));
take f;
take p;
thus p = ( Product f );
thus ( dom f ) = ( Seg n ) by A9;
thus (for i being non  empty (Element of ( NAT )) holds (i in ( Seg n ) implies (((((not i divides n) or i divides ni) or i = n) implies ( f . i ) = <% ( 1_ ( F_Complex ) ) %>) & (((i divides n & (not i divides ni)) & i <> n) implies ( f . i ) = ( cyclotomic_poly i ))))) by A11;
set b = ( (( n -roots_of_1 ),1) -bag );
set bi = ( (( ni -roots_of_1 ),1) -bag );
consider rbn being non  empty  finite (Subset of ( F_Complex )) such that A12: rbn = { y where y is (Element of cMGFC): ( ord y ) = n } and A13: ( cyclotomic_poly n ) = ( poly_with_roots ( (rbn,1) -bag ) ) by CKB63:def 1;
set bn = ( (rbn,1) -bag );
( ni -roots_of_1 ) misses rbn
proof
assume ( ( ni -roots_of_1 ) /\ rbn ) <> ( {} );
then consider x being set such that A14: x in ( ( ni -roots_of_1 ) /\ rbn ) by XBOOLE_0:def 1;
x in rbn by A14,XBOOLE_0:def 4;
then A15: (ex y1 being (Element of cMGFC) st (x = y1 & ( ord y1 ) = n)) by A12;
x in ( ni -roots_of_1 ) by A14,XBOOLE_0:def 4;
then (ex y being (Element of cMGFC) st (x = y & ( ord y ) divides ni)) by CKB47:1;
hence contradiction by A1,A15,NAT_D:7;
end;
then A16: ( bi + bn ) = ( (( ( ni -roots_of_1 ) \/ rbn ),1) -bag ) by UPROOTS:10;
set rbibn = ( ( ni -roots_of_1 ) \/ rbn );
reconsider rbibn as  finite (Subset of ( F_Complex ));
A17: ( ni -roots_of_1 ) c= ( n -roots_of_1 ) by A2,CKB39:1;
now
let x being set;
hereby
assume A18: x in ( n -roots_of_1 );
then reconsider y = x as (Element of cMGFC) by A3;
A19: ( ord y ) divides n by A18,CKB45:1;
per cases ;
suppose ( ord y ) = n;

then y in rbn by A12;
then y in rbibn by XBOOLE_0:def 3;
hence x in ( rbibn \/ rbp ) by XBOOLE_0:def 3;
end;
suppose (( ord y ) <> n & (not ( ord y ) divides ni));

then y in rbp by A19;
hence x in ( rbibn \/ rbp ) by XBOOLE_0:def 3;
end;
suppose (( ord y ) <> n & ( ord y ) divides ni);

then x in ( ni -roots_of_1 ) by CKB45:1;
then x in rbibn by XBOOLE_0:def 3;
hence x in ( rbibn \/ rbp ) by XBOOLE_0:def 3;
end;
end;
assume x in ( rbibn \/ rbp );
then A20: (x in rbibn or x in rbp) by XBOOLE_0:def 3;
per cases  by A20,XBOOLE_0:def 3;
suppose x in ( ni -roots_of_1 );

hence x in ( n -roots_of_1 ) by A17;
end;
suppose x in rbn;

then (ex y being (Element of cMGFC) st (x = y & ( ord y ) = n)) by A12;
hence x in ( n -roots_of_1 ) by CKB45:1;
end;
suppose x in rbp;

then (ex y being (Element of cMGFC) st (((x = y & ( ord y ) divides n) & (not ( ord y ) divides ni)) & ( ord y ) <> n));
hence x in ( n -roots_of_1 ) by CKB45:1;
end;
end;
then A21: ( n -roots_of_1 ) = ( rbibn \/ rbp ) by TARSKI:1;
set bibn = ( (rbibn,1) -bag );
A22: ( unital_poly (( F_Complex ),ni) ) = ( poly_with_roots bi ) by CKB61:1;
rbibn misses rbp
proof
assume ( rbibn /\ rbp ) <> ( {} );
then consider x being set such that A23: x in ( rbibn /\ rbp ) by XBOOLE_0:def 1;
x in rbp by A23,XBOOLE_0:def 4;
then A24: (ex y being (Element of cMGFC) st (((x = y & ( ord y ) divides n) & (not ( ord y ) divides ni)) & ( ord y ) <> n));
A25: x in rbibn by A23,XBOOLE_0:def 4;
per cases  by A25,XBOOLE_0:def 3;
suppose x in ( ni -roots_of_1 );

then (ex y being (Element of cMGFC) st (x = y & ( ord y ) divides ni)) by CKB47:1;
hence contradiction by A24;
end;
suppose x in rbn;

then (ex y being (Element of cMGFC) st (x = y & ( ord y ) = n)) by A12;
hence contradiction by A24;
end;
end;
then A26: b = ( bibn + bp ) by A21,UPROOTS:10;
( unital_poly (( F_Complex ),n) ) = ( poly_with_roots b ) by CKB61:1
.= ( ( poly_with_roots bibn ) *' ( poly_with_roots bp ) ) by A26,UPROOTS:64
.= ( ( ( unital_poly (( F_Complex ),ni) ) *' ( cyclotomic_poly n ) ) *' ( poly_with_roots bp ) ) by A13,A16,A22,UPROOTS:64;
hence thesis by A9,A11,CKB69:1;
end;
