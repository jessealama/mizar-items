environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,XXREAL_0,CARD_1,ARYTM_3,NAT_1,FINSEQ_1,RELAT_1,FUNCT_1,TARSKI,COMPLFLD,COMPLEX1,PARTFUN1,CARD_3,STRUCT_0,REAL_1,ORDINAL4,FINSET_1,UPROOTS,ARYTM_1,POLYNOM2,AFINSQ_1,GROUP_1,INT_1,HAHNBAN1,SQUARE_1,POWER,SIN_COS,BINOP_1,ALGSTR_0,FINSEQ_2,MOD_2,VECTSP_1,VECTSP_2,REALSET1,ZFMISC_1,SUPINF_2,COMPTRIG,RAT_1,PREPOWER,XREAL_0,ORDINAL1,NEWTON,XCMPLX_0,INT_2,BINOP_2,GROUP_2,POLYNOM1,POLYNOM3,FUNCT_4,ALGSEQ_1,VALUED_0,POLYNOM5,SGRAPH1,PRE_POLY,GRAPH_2,MESFUNC1,UNIROOTS;
notations TARSKI,XBOOLE_0,SUBSET_1,REALSET1,CARD_1,NUMBERS,XREAL_0,ZFMISC_1,XXREAL_0,COMPLEX1,REAL_1,SQUARE_1,INT_1,INT_2,NAT_1,NAT_D,PREPOWER,POWER,BINOP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,RAT_1,DOMAIN_1,FINSET_1,BINOP_2,STRUCT_0,ALGSTR_0,VECTSP_2,VECTSP_1,GROUP_4,RVSUM_1,ALGSEQ_1,COMPLFLD,HAHNBAN1,POLYNOM3,POLYNOM4,POLYNOM5,COMPTRIG,GROUP_2,NEWTON,GROUP_1,MOD_2,GRAPH_2,ORDINAL1,PRE_POLY,FVSUM_1,UPROOTS,SIN_COS,FUNCT_7,FINSEQ_2,CKB21,CKB29;
definitions TARSKI,GROUP_1,XBOOLE_0,BINOP_1,REALSET1,SQUARE_1,HAHNBAN1,POLYNOM3,FINSEQ_2,COMPLEX1,GROUP_4,ALGSTR_0,STRUCT_0,CKB21,CKB29;
theorems GROUP_1,CARD_1,FINSEQ_1,ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,RELAT_1,TARSKI,XBOOLE_0,XBOOLE_1,VECTSP_1,PREPOWER,COMPTRIG,COMPLFLD,BINOP_1,XCMPLX_1,COMPLEX1,HAHNBAN1,SIN_COS,POWER,SIN_COS2,POLYNOM5,INT_1,COMPLEX2,XCMPLX_0,XREAL_0,SQUARE_1,RVSUM_1,FVSUM_1,FINSEQ_3,FINSEQ_2,FINSEQ_4,POLYNOM4,INT_2,WSIERP_1,NAT_2,PEPIN,POLYNOM3,COMPUT_1,NORMSP_1,FUNCT_7,ALGSEQ_1,RLVECT_1,NEWTON,POLYNOM2,MATRIX_3,VECTSP_2,MOD_2,CARD_2,GRAPH_2,FINSEQ_5,UPROOTS,GROUP_2,BINOP_2,XREAL_1,XXREAL_0,GROUP_4,FUNCOP_1,ORDINAL1,FINSOP_1,NAT_D,PARTFUN1,PRE_POLY,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB21,CKB22,CKB23,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47;
schemes NAT_1,FUNCT_2,FINSEQ_1,INT_1,RECDEF_1,CKB2;
registrations RELAT_1,FUNCT_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,CARD_1,MEMBERED,FINSEQ_1,FINSEQ_2,REALSET1,WSIERP_1,STRUCT_0,GROUP_1,VECTSP_1,COMPLFLD,QUOFIELD,POLYNOM3,POLYNOM5,VALUED_0,ALGSTR_0,POWER,UPROOTS,FUNCT_2,RELSET_1,PRE_POLY,XBOOLE_0,ZFMISC_1,CKB19,CKB20,CKB25,CKB37,CKB38;
constructors WELLORD2,BINOP_1,REAL_1,SQUARE_1,NAT_D,FINSEQOP,FINSOP_1,RVSUM_1,PREPOWER,POWER,REALSET1,SIN_COS,GROUP_4,MOD_2,MATRIX_2,HAHNBAN1,GRAPH_2,POLYNOM4,POLYNOM5,UPROOTS,SEQ_1,RECDEF_1,BINOP_2,RELSET_1,PBOOLE,FUNCT_7,POLYNOM1,NEWTON,FVSUM_1,CKB21,CKB29;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
definition
let n being non  empty (Element of ( NAT ));
func n -th_roots_of_1 ->  strict Group means 
:Def3: ((the carrier of it) = ( n -roots_of_1 ) & (the multF of it) = ( (the multF of ( F_Complex )) || ( n -roots_of_1 ) ));
existence
proof
set X = [: ( n -roots_of_1 ),( n -roots_of_1 ) :];
set mru = ( (the multF of ( F_Complex )) || ( n -roots_of_1 ) );
( n -roots_of_1 ) c= (the carrier of ( F_Complex ));
then ( n -roots_of_1 ) c= ( COMPLEX ) by COMPLFLD:def 1;
then X c= [: ( COMPLEX ),( COMPLEX ) :] by ZFMISC_1:96;
then A1: X c= ( dom ( multcomplex ) ) by FUNCT_2:def 1;
A2: ( multcomplex ) = (the multF of ( F_Complex )) by COMPLFLD:def 1;
then A3: ( dom mru ) = ( ( dom ( multcomplex ) ) /\ X ) by RELAT_1:61;
then A4: ( dom mru ) = X by A1,XBOOLE_1:28;
(for x being set holds (x in X implies ( mru . x ) in ( n -roots_of_1 )))
proof
let x being set;
assume that
A5: x in X;
consider a,b being set such that A6: [ a,b ] = x by A5,RELAT_1:def 1;
A7: b in ( n -roots_of_1 ) by A5,A6,ZFMISC_1:87;
A8: a in ( n -roots_of_1 ) by A5,A6,ZFMISC_1:87;
reconsider b as (Element of ( COMPLEX )) by A7,COMPLFLD:def 1;
reconsider a as (Element of ( COMPLEX )) by A8,COMPLFLD:def 1;
(( ( multcomplex ) . (a,b) ) = ( a * b ) & ( mru . [ a,b ] ) = ( ( multcomplex ) . [ a,b ] )) by A2,A4,A5,A6,BINOP_2:def 5,FUNCT_1:47;
hence thesis by A6,A8,A7,CKB34:1;
end;
then reconsider uM = mru as (BinOp of ( n -roots_of_1 )) by A1,A3,FUNCT_2:3,XBOOLE_1:28;
set H = multMagma (# ( n -roots_of_1 ),uM #);
reconsider 1F = ( 1_ ( F_Complex ) ) as (Element of H) by CKB31:1;
A9: ( 1_ ( F_Complex ) ) = [** ( cos ( ( ( 2 * ( PI ) ) * (( 0 ) qua Nat) ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * (( 0 ) qua Nat) ) / n ) ) **] by COMPLFLD:8,SIN_COS:31;
A10: (for s1 being (Element of H) holds ((( s1 * 1F ) = s1 & ( 1F * s1 ) = s1) & (ex s2 being (Element of H) st (( s1 * s2 ) = ( 1_ ( F_Complex ) ) & ( s2 * s1 ) = ( 1_ ( F_Complex ) )))))
proof
let s1 being (Element of H);
A11: (ex s2 being (Element of H) st (( s1 * s2 ) = ( 1_ ( F_Complex ) ) & ( s2 * s1 ) = ( 1_ ( F_Complex ) )))
proof
s1 in (the carrier of ( F_Complex )) by TARSKI:def 3;
then consider k being (Element of ( NAT )) such that A12: s1 = [** ( cos ( ( ( 2 * ( PI ) ) * k ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * k ) / n ) ) **] by CKB33:1;
reconsider e1 = [** ( cos ( ( ( 2 * ( PI ) ) * k ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * k ) / n ) ) **] as (Element of ( F_Complex ));
(ex j being (Element of ( NAT )) st ( ( k + j ) mod n ) = ( 0 ))
proof
set r = ( k mod n );
r < n by NAT_D:1;
then consider j being Nat such that A13: ( r + j ) = n by NAT_1:10;
k = ( ( n * ( k div n ) ) + r ) by NAT_D:2;
then (j in ( NAT ) & ( ( k + j ) mod n ) = ( ( ( ( k div n ) + 1 ) * n ) mod n )) by A13,ORDINAL1:def 12;
hence thesis by NAT_D:13;
end;
then consider j being (Element of ( NAT )) such that A14: ( ( k + j ) mod n ) = ( 0 );
set ss2 = [** ( cos ( ( ( 2 * ( PI ) ) * j ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * j ) / n ) ) **];
reconsider s2 = ss2 as (Element of H) by CKB33:1;
reconsider e2 = s2 as (Element of ( F_Complex ));
(( e2 * e1 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( j + k ) mod n ) ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * ( ( j + k ) mod n ) ) / n ) ) **] & [ s2,s1 ] in ( dom mru )) by A4,CKB14:1,ZFMISC_1:87;
then A15: ( s2 * s1 ) = ( 1_ ( F_Complex ) ) by A12,A14,COMPLFLD:8,FUNCT_1:47,SIN_COS:31;
(( e1 * e2 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( j + k ) mod n ) ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * ( ( j + k ) mod n ) ) / n ) ) **] & [ s1,s2 ] in ( dom mru )) by A4,CKB14:1,ZFMISC_1:87;
then ( s1 * s2 ) = ( 1_ ( F_Complex ) ) by A12,A14,COMPLFLD:8,FUNCT_1:47,SIN_COS:31;
hence thesis by A15;
end;
(( s1 * 1F ) = s1 & ( 1F * s1 ) = s1)
proof
A16: ([ s1,1F ] in ( dom mru ) & [ 1F,s1 ] in ( dom mru )) by A4,ZFMISC_1:87;
reconsider e1 = s1 as (Element of ( F_Complex )) by TARSKI:def 3;
consider k being (Element of ( NAT )) such that A17: e1 = [** ( cos ( ( ( 2 * ( PI ) ) * k ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * k ) / n ) ) **] by CKB33:1;
A18: ( ( 1_ ( F_Complex ) ) * e1 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( k + ( 0 ) ) mod n ) ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * ( ( k + ( 0 ) ) mod n ) ) / n ) ) **] by A9,A17,CKB14:1
.= s1 by A17,CKB13:1;
( e1 * ( 1_ ( F_Complex ) ) ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( k + ( 0 ) ) mod n ) ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * ( ( k + ( 0 ) ) mod n ) ) / n ) ) **] by A9,A17,CKB14:1
.= s1 by A17,CKB13:1;
hence thesis by A18,A16,FUNCT_1:47;
end;
hence thesis by A11;
end;
A19: ( rng uM ) c= ( n -roots_of_1 ) by RELAT_1:def 19;
(for r,s,t being (Element of H) holds ( ( r * s ) * t ) = ( r * ( s * t ) ))
proof
set mc = ( multcomplex );
let r being (Element of H);
let s being (Element of H);
let t being (Element of H);
r in (the carrier of ( F_Complex )) by TARSKI:def 3;
then A20: r is (Element of ( COMPLEX )) by COMPLFLD:def 1;
s in (the carrier of ( F_Complex )) by TARSKI:def 3;
then A21: s is (Element of ( COMPLEX )) by COMPLFLD:def 1;
A22: [ r,s ] in ( dom mru ) by A4,ZFMISC_1:87;
then ( mru . [ r,s ] ) in ( rng mru ) by FUNCT_1:3;
then A23: [ ( mru . [ r,s ] ),t ] in ( dom mru ) by A4,A19,ZFMISC_1:87;
A24: [ s,t ] in ( dom mru ) by A4,ZFMISC_1:87;
then ( mru . [ s,t ] ) in ( rng mru ) by FUNCT_1:3;
then A25: [ r,( mru . [ s,t ] ) ] in ( dom mru ) by A4,A19,ZFMISC_1:87;
( mru . [ s,t ] ) = ( mc . [ s,t ] ) by A2,A24,FUNCT_1:47;
then A26: ( mru . [ r,( mru . [ s,t ] ) ] ) = ( mc . (r,( mc . (s,t) )) ) by A2,A25,FUNCT_1:47;
t in (the carrier of ( F_Complex )) by TARSKI:def 3;
then A27: t is (Element of ( COMPLEX )) by COMPLFLD:def 1;
( mru . [ r,s ] ) = ( mc . [ r,s ] ) by A2,A22,FUNCT_1:47;
then ( mru . [ ( mru . [ r,s ] ),t ] ) = ( mc . (( mc . (r,s) ),t) ) by A2,A23,FUNCT_1:47;
hence thesis by A20,A21,A27,A26,BINOP_1:def 3;
end;
then H is Group by A10,GROUP_1:1;
hence thesis;
end;
uniqueness;
end;
