environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,XXREAL_0,CARD_1,ARYTM_3,NAT_1,FINSEQ_1,RELAT_1,FUNCT_1,TARSKI,COMPLFLD,COMPLEX1,PARTFUN1,CARD_3,STRUCT_0,REAL_1,ORDINAL4,FINSET_1,UPROOTS,ARYTM_1,POLYNOM2,AFINSQ_1,GROUP_1,INT_1,HAHNBAN1,SQUARE_1,POWER,SIN_COS,BINOP_1,ALGSTR_0,FINSEQ_2,MOD_2,VECTSP_1,VECTSP_2,REALSET1,ZFMISC_1,SUPINF_2,COMPTRIG,RAT_1,PREPOWER,XREAL_0,ORDINAL1,NEWTON,XCMPLX_0,INT_2,BINOP_2,GROUP_2,POLYNOM1,POLYNOM3,FUNCT_4,ALGSEQ_1,VALUED_0,POLYNOM5,SGRAPH1,PRE_POLY,GRAPH_2,MESFUNC1,UNIROOTS;
notations TARSKI,XBOOLE_0,SUBSET_1,REALSET1,CARD_1,NUMBERS,XREAL_0,ZFMISC_1,XXREAL_0,COMPLEX1,REAL_1,SQUARE_1,INT_1,INT_2,NAT_1,NAT_D,PREPOWER,POWER,BINOP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,RAT_1,DOMAIN_1,FINSET_1,BINOP_2,STRUCT_0,ALGSTR_0,VECTSP_2,VECTSP_1,GROUP_4,RVSUM_1,ALGSEQ_1,COMPLFLD,HAHNBAN1,POLYNOM3,POLYNOM4,POLYNOM5,COMPTRIG,GROUP_2,NEWTON,GROUP_1,MOD_2,GRAPH_2,ORDINAL1,PRE_POLY,FVSUM_1,UPROOTS,SIN_COS,FUNCT_7,FINSEQ_2,CKB21,CKB29,CKB48,CKB50,CKB63;
definitions TARSKI,GROUP_1,XBOOLE_0,BINOP_1,REALSET1,SQUARE_1,HAHNBAN1,POLYNOM3,FINSEQ_2,COMPLEX1,GROUP_4,ALGSTR_0,STRUCT_0,CKB21,CKB29,CKB48,CKB50,CKB63;
theorems GROUP_1,CARD_1,FINSEQ_1,ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,RELAT_1,TARSKI,XBOOLE_0,XBOOLE_1,VECTSP_1,PREPOWER,COMPTRIG,COMPLFLD,BINOP_1,XCMPLX_1,COMPLEX1,HAHNBAN1,SIN_COS,POWER,SIN_COS2,POLYNOM5,INT_1,COMPLEX2,XCMPLX_0,XREAL_0,SQUARE_1,RVSUM_1,FVSUM_1,FINSEQ_3,FINSEQ_2,FINSEQ_4,POLYNOM4,INT_2,WSIERP_1,NAT_2,PEPIN,POLYNOM3,COMPUT_1,NORMSP_1,FUNCT_7,ALGSEQ_1,RLVECT_1,NEWTON,POLYNOM2,MATRIX_3,VECTSP_2,MOD_2,CARD_2,GRAPH_2,FINSEQ_5,UPROOTS,GROUP_2,BINOP_2,XREAL_1,XXREAL_0,GROUP_4,FUNCOP_1,ORDINAL1,FINSOP_1,NAT_D,PARTFUN1,PRE_POLY,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB21,CKB22,CKB23,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64;
schemes NAT_1,FUNCT_2,FINSEQ_1,INT_1,RECDEF_1,CKB2;
registrations RELAT_1,FUNCT_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,CARD_1,MEMBERED,FINSEQ_1,FINSEQ_2,REALSET1,WSIERP_1,STRUCT_0,GROUP_1,VECTSP_1,COMPLFLD,QUOFIELD,POLYNOM3,POLYNOM5,VALUED_0,ALGSTR_0,POWER,UPROOTS,FUNCT_2,RELSET_1,PRE_POLY,XBOOLE_0,ZFMISC_1,CKB19,CKB20,CKB25,CKB37,CKB38,CKB55;
constructors WELLORD2,BINOP_1,REAL_1,SQUARE_1,NAT_D,FINSEQOP,FINSOP_1,RVSUM_1,PREPOWER,POWER,REALSET1,SIN_COS,GROUP_4,MOD_2,MATRIX_2,HAHNBAN1,GRAPH_2,POLYNOM4,POLYNOM5,UPROOTS,SEQ_1,RECDEF_1,BINOP_2,RELSET_1,PBOOLE,FUNCT_7,POLYNOM1,NEWTON,FVSUM_1,CKB21,CKB29,CKB48,CKB50,CKB63;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
theorem
Th53: (for n being non empty (Element of ( NAT )) holds (for f being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds ((( len f ) = n & (for i being non empty (Element of ( NAT )) holds (i in ( dom f ) implies (((not i divides n) implies ( f . i ) = <% ( 1_ ( F_Complex ) ) %>) & (i divides n implies ( f . i ) = ( cyclotomic_poly i )))))) implies ( unital_poly (( F_Complex ),n) ) = ( Product f ))))
proof
set cMGFC = (the carrier of ( MultGroup ( F_Complex ) ));
let n being non empty (Element of ( NAT ));
let f being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) )));
assume that
A1: ( len f ) = n
and
A2: (for i being non empty (Element of ( NAT )) holds (i in ( dom f ) implies (((not i divides n) implies ( f . i ) = <% ( 1_ ( F_Complex ) ) %>) & (i divides n implies ( f . i ) = ( cyclotomic_poly i )))));
defpred P[ Nat,set ]
 means
(for fi being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds (fi = ( f | ( Seg $1 ) ) implies $2 = ( Product fi )));
set nr1 = ( n -roots_of_1 );
deffunc MG(Nat) = { y where y is (Element of ( MultGroup ( F_Complex ) )): (y in nr1 & ( ord y ) <= $1) };
A3:now
let i being Nat;
assume i in ( Seg ( len f ) );
reconsider fi = ( f | ( Seg i ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
set x = ( Product fi );
take x;
thus P[ i,x ];
end;
consider F being (FinSequence of ( Polynom-Ring ( F_Complex ) )) such that ( dom F ) = ( Seg ( len f ) ) and A4: (for i being Nat holds (i in ( Seg ( len f ) ) implies P[ i,( F . i ) ])) from FINSEQ_1:sch 5(A3);
defpred R[ (Element of ( NAT )) ]
 means
(ex t being  finite (Subset of ( F_Complex )) st (t = MG($1) & ( F . $1 ) = ( poly_with_roots ( (t,1) -bag ) )));
A5:now
let i being (Element of ( NAT ));
MG(i) c= nr1
proof
let x being set;
assume x in MG(i);
then (ex y being (Element of cMGFC) st ((x = y & y in nr1) & ( ord y ) <= i));
hence thesis;
end;
hence MG(i) is  finite  finite (Subset of ( F_Complex )) by XBOOLE_1:1;
end;
then reconsider sB = MG(n) as  finite (Subset of ( F_Complex ));
A6: nr1 = { x where x is (Element of ( MultGroup ( F_Complex ) )): ( ord x ) divides n } by CKB46:1;
A7: (for i being (Element of ( NAT )) holds ((1 <= i & i < ( len f )) implies (R[ i ] implies R[ ( i + 1 ) ])))
proof
let i being (Element of ( NAT ));
assume that
A8: 1 <= i
and
A9: i < ( len f )
and
A10: R[ i ];
reconsider fi = ( f | ( Seg i ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
i in ( Seg ( len f ) ) by A8,A9,FINSEQ_1:1;
then A11: ( F . i ) = ( Product fi ) by A4;
reconsider fi1 = ( f | ( Seg ( i + 1 ) ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
A12: ( i + 1 ) <= ( len f ) by A9,NAT_1:13;
then ( i + 1 ) = ( min (( i + 1 ),( len f )) ) by XXREAL_0:def 9;
then A13: ( len fi1 ) = ( i + 1 ) by FINSEQ_2:21;
1 <= ( i + 1 ) by A8,NAT_1:13;
then A14: ( i + 1 ) in ( Seg ( len f ) ) by A12,FINSEQ_1:1;
then A15: ( i + 1 ) in ( dom f ) by FINSEQ_1:def 3;
reconsider sB = MG(( i + 1 )) as  finite (Subset of ( F_Complex )) by A5;
take sB;
thus sB = MG(( i + 1 ));
set B = ( (sB,1) -bag );
consider sb being  finite (Subset of ( F_Complex )) such that A16: sb = MG(i) and A17: ( F . i ) = ( poly_with_roots ( (sb,1) -bag ) ) by A10;
A18: ( ( f | ( Seg ( i + 1 ) ) ) . ( i + 1 ) ) = ( f . ( i + 1 ) ) by FINSEQ_1:4,FUNCT_1:49;
then reconsider fi1d1 = ( fi1 . ( i + 1 ) ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by A15,FINSEQ_2:11;
set b = ( (sb,1) -bag );
reconsider fi1d1p = fi1d1 as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
fi = ( fi1 | ( Seg i ) ) by CKB4:1,NAT_1:12;
then fi1 = ( fi ^ <* fi1d1 *> ) by A13,FINSEQ_3:55;
then A19: ( Product fi1 ) = ( ( Product fi ) * fi1d1 ) by GROUP_4:6
.= ( ( poly_with_roots b ) *' fi1d1p ) by A17,A11,POLYNOM3:def 10;
per cases ;
suppose A20: (not ( i + 1 ) divides n);

set eb = ( EmptyBag (the carrier of ( F_Complex )) );
now
let x being set;
hereby
assume x in sB;
then consider y being (Element of ( MultGroup ( F_Complex ) )) such that A21: x = y and A22: y in nr1 and A23: ( ord y ) <= ( i + 1 );
( ord y ) divides n by A22,CKB45:1;
then ( ord y ) < ( i + 1 ) by A20,A23,XXREAL_0:1;
then ( ord y ) <= i by NAT_1:13;
hence x in sb by A16,A21,A22;
end;
assume x in sb;
then consider y being (Element of cMGFC) such that A24: (x = y & y in nr1) and A25: ( ord y ) <= i by A16;
( ord y ) <= ( i + 1 ) by A25,NAT_1:12;
hence x in sB by A24;
end;
then A26: sB = sb by TARSKI:1;
( f . ( i + 1 ) ) = <% ( 1_ ( F_Complex ) ) %> by A2,A15,A20
.= ( poly_with_roots eb ) by UPROOTS:60;
hence ( F . ( i + 1 ) ) = ( ( poly_with_roots b ) *' ( poly_with_roots eb ) ) by A4,A14,A18,A19
.= ( poly_with_roots ( b + eb ) ) by UPROOTS:64
.= ( poly_with_roots B ) by A26,PRE_POLY:53;
end;
suppose A27: ( i + 1 ) divides n;

consider scb being non empty  finite (Subset of ( F_Complex )) such that A28: scb = { y where y is (Element of cMGFC): ( ord y ) = ( i + 1 ) } and A29: ( cyclotomic_poly ( i + 1 ) ) = ( poly_with_roots ( (scb,1) -bag ) ) by CKB63:def 1;
now
let x being set;
hereby
assume x in sB;
then consider y being (Element of cMGFC) such that A30: x = y and A31: y in nr1 and A32: ( ord y ) <= ( i + 1 );
(( ord y ) <= i or ( ord y ) = ( i + 1 )) by A32,NAT_1:8;
then (y in sb or y in scb) by A16,A28,A31;
hence x in ( sb \/ scb ) by A30,XBOOLE_0:def 3;
end;
assume A33: x in ( sb \/ scb );
per cases  by A33,XBOOLE_0:def 3;
suppose x in sb;

then consider y being (Element of cMGFC) such that A34: (x = y & y in nr1) and A35: ( ord y ) <= i by A16;
( ord y ) <= ( i + 1 ) by A35,NAT_1:12;
hence x in sB by A34;
end;
suppose x in scb;

then consider y being (Element of cMGFC) such that A36: x = y and A37: ( ord y ) = ( i + 1 ) by A28;
y in nr1 by A6,A27,A37;
hence x in sB by A36,A37;
end;
end;
then A38: sB = ( sb \/ scb ) by TARSKI:1;
set cb = ( (scb,1) -bag );
A39: sb misses scb
proof
assume ( sb /\ scb ) <> ( {} );
then consider x being set such that A40: x in ( sb /\ scb ) by XBOOLE_0:def 1;
x in scb by A40,XBOOLE_0:def 4;
then A41: (ex y2 being (Element of cMGFC) st (x = y2 & ( ord y2 ) = ( i + 1 ))) by A28;
x in sb by A40,XBOOLE_0:def 4;
then (ex y1 being (Element of cMGFC) st ((x = y1 & y1 in nr1) & ( ord y1 ) <= i)) by A16;
hence contradiction by A41,NAT_1:13;
end;
( f . ( i + 1 ) ) = ( poly_with_roots cb ) by A2,A15,A27,A29;
hence ( F . ( i + 1 ) ) = ( ( poly_with_roots b ) *' ( poly_with_roots cb ) ) by A4,A14,A18,A19
.= ( poly_with_roots ( b + cb ) ) by UPROOTS:64
.= ( poly_with_roots B ) by A38,A39,UPROOTS:10;
end;
end;
A42: ( ( 0 ) + 1 ) <= n by NAT_1:13;
A43: R[ 1 ]
proof
reconsider t = MG(1) as  finite (Subset of ( F_Complex )) by A5;
take t;
thus t = MG(1);
reconsider f1 = ( f | ( Seg 1 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
A44: (1 in ( dom f ) & 1 divides n) by A1,A42,FINSEQ_3:25,NAT_D:6;
A45: 1 in ( Seg ( len f ) ) by A1,A42,FINSEQ_1:1;
then 1 in ( dom f ) by FINSEQ_1:def 3;
then reconsider fd1 = ( f . 1 ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_2:11;
f1 = <* ( f . 1 ) *> by A1,A42,CKB3:1;
then ( F . 1 ) = ( Product <* fd1 *> ) by A4,A45
.= fd1 by FINSOP_1:11
.= ( cyclotomic_poly 1 ) by A2,A44;
then consider sB being non empty  finite (Subset of ( F_Complex )) such that A46: sB = { y where y is (Element of cMGFC): ( ord y ) = 1 } and A47: ( F . 1 ) = ( poly_with_roots ( (sB,1) -bag ) ) by CKB63:def 1;
now
let x being set;
hereby
assume x in MG(1);
then consider y being (Element of cMGFC) such that A48: x = y and A49: y in nr1 and A50: ( ord y ) <= 1;
(not y is  being_of_order_0) by A49,CKB41:1;
then ( ord y ) <> ( 0 ) by GROUP_1:def 11;
then ( ( 0 ) + 1 ) <= ( ord y ) by NAT_1:13;
then ( ord y ) = 1 by A50,XXREAL_0:1;
hence x in sB by A46,A48;
end;
assume x in sB;
then consider y being (Element of cMGFC) such that A51: x = y and A52: ( ord y ) = 1 by A46;
( ord y ) divides n by A52,NAT_D:6;
then y in nr1 by A6;
hence x in MG(1) by A51,A52;
end;
hence thesis by A47,TARSKI:1;
end;
(for i being (Element of ( NAT )) holds ((1 <= i & i <= ( len f )) implies R[ i ])) from INT_1:sch 7(A43,A7);
then A53: (ex t being  finite (Subset of ( F_Complex )) st (t = MG(( len f )) & ( F . ( len f ) ) = ( poly_with_roots ( (t,1) -bag ) ))) by A1,A42;
set b = ( (nr1,1) -bag );
A54: f = ( f | ( Seg ( len f ) ) ) by FINSEQ_3:49;
now
let x being set;
hereby
assume A55: x in nr1;
then consider y being (Element of ( MultGroup ( F_Complex ) )) such that A56: x = y and A57: ( ord y ) divides n by A6;
( ord y ) <= n by A57,NAT_D:7;
hence x in sB by A55,A56;
end;
assume x in sB;
then (ex y being (Element of ( MultGroup ( F_Complex ) )) st ((y = x & y in nr1) & ( ord y ) <= n));
hence x in nr1;
end;
then A58: nr1 = sB by TARSKI:1;
thus ( unital_poly (( F_Complex ),n) ) = ( poly_with_roots b ) by CKB61:1
.= ( Product f ) by A1,A4,A58,A53,A54,FINSEQ_1:3;
end;
