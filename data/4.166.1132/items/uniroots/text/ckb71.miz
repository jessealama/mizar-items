environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,XXREAL_0,CARD_1,ARYTM_3,NAT_1,FINSEQ_1,RELAT_1,FUNCT_1,TARSKI,COMPLFLD,COMPLEX1,PARTFUN1,CARD_3,STRUCT_0,REAL_1,ORDINAL4,FINSET_1,UPROOTS,ARYTM_1,POLYNOM2,AFINSQ_1,GROUP_1,INT_1,HAHNBAN1,SQUARE_1,POWER,SIN_COS,BINOP_1,ALGSTR_0,FINSEQ_2,MOD_2,VECTSP_1,VECTSP_2,REALSET1,ZFMISC_1,SUPINF_2,COMPTRIG,RAT_1,PREPOWER,XREAL_0,ORDINAL1,NEWTON,XCMPLX_0,INT_2,BINOP_2,GROUP_2,POLYNOM1,POLYNOM3,FUNCT_4,ALGSEQ_1,VALUED_0,POLYNOM5,SGRAPH1,PRE_POLY,GRAPH_2,MESFUNC1,UNIROOTS;
notations TARSKI,XBOOLE_0,SUBSET_1,REALSET1,CARD_1,NUMBERS,XREAL_0,ZFMISC_1,XXREAL_0,COMPLEX1,REAL_1,SQUARE_1,INT_1,INT_2,NAT_1,NAT_D,PREPOWER,POWER,BINOP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,RAT_1,DOMAIN_1,FINSET_1,BINOP_2,STRUCT_0,ALGSTR_0,VECTSP_2,VECTSP_1,GROUP_4,RVSUM_1,ALGSEQ_1,COMPLFLD,HAHNBAN1,POLYNOM3,POLYNOM4,POLYNOM5,COMPTRIG,GROUP_2,NEWTON,GROUP_1,MOD_2,GRAPH_2,ORDINAL1,PRE_POLY,FVSUM_1,UPROOTS,SIN_COS,FUNCT_7,FINSEQ_2,CKB21,CKB29,CKB48,CKB50,CKB63;
definitions TARSKI,GROUP_1,XBOOLE_0,BINOP_1,REALSET1,SQUARE_1,HAHNBAN1,POLYNOM3,FINSEQ_2,COMPLEX1,GROUP_4,ALGSTR_0,STRUCT_0,CKB21,CKB29,CKB48,CKB50,CKB63;
theorems GROUP_1,CARD_1,FINSEQ_1,ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,RELAT_1,TARSKI,XBOOLE_0,XBOOLE_1,VECTSP_1,PREPOWER,COMPTRIG,COMPLFLD,BINOP_1,XCMPLX_1,COMPLEX1,HAHNBAN1,SIN_COS,POWER,SIN_COS2,POLYNOM5,INT_1,COMPLEX2,XCMPLX_0,XREAL_0,SQUARE_1,RVSUM_1,FVSUM_1,FINSEQ_3,FINSEQ_2,FINSEQ_4,POLYNOM4,INT_2,WSIERP_1,NAT_2,PEPIN,POLYNOM3,COMPUT_1,NORMSP_1,FUNCT_7,ALGSEQ_1,RLVECT_1,NEWTON,POLYNOM2,MATRIX_3,VECTSP_2,MOD_2,CARD_2,GRAPH_2,FINSEQ_5,UPROOTS,GROUP_2,BINOP_2,XREAL_1,XXREAL_0,GROUP_4,FUNCOP_1,ORDINAL1,FINSOP_1,NAT_D,PARTFUN1,PRE_POLY,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB21,CKB22,CKB23,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70;
schemes NAT_1,FUNCT_2,FINSEQ_1,INT_1,RECDEF_1,CKB2;
registrations RELAT_1,FUNCT_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,CARD_1,MEMBERED,FINSEQ_1,FINSEQ_2,REALSET1,WSIERP_1,STRUCT_0,GROUP_1,VECTSP_1,COMPLFLD,QUOFIELD,POLYNOM3,POLYNOM5,VALUED_0,ALGSTR_0,POWER,UPROOTS,FUNCT_2,RELSET_1,PRE_POLY,XBOOLE_0,ZFMISC_1,CKB19,CKB20,CKB25,CKB37,CKB38,CKB55;
constructors WELLORD2,BINOP_1,REAL_1,SQUARE_1,NAT_D,FINSEQOP,FINSOP_1,RVSUM_1,PREPOWER,POWER,REALSET1,SIN_COS,GROUP_4,MOD_2,MATRIX_2,HAHNBAN1,GRAPH_2,POLYNOM4,POLYNOM5,UPROOTS,SEQ_1,RECDEF_1,BINOP_2,RELSET_1,PBOOLE,FUNCT_7,POLYNOM1,NEWTON,FVSUM_1,CKB21,CKB29,CKB48,CKB50,CKB63;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
theorem
Th59: (for i being Integer holds (for c being (Element of ( F_Complex )) holds (for f being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds (for p being (Polynomial of ( F_Complex )) holds (((p = ( Product f ) & c = i) & (for i being non  empty (Element of ( NAT )) holds (i in ( dom f ) implies (( f . i ) = <% ( 1_ ( F_Complex ) ) %> or ( f . i ) = ( cyclotomic_poly i ))))) implies ( eval (p,c) ) is  integer)))))
proof
A1: ( 1_. ( F_Complex ) ) = ( ( 1_ ( F_Complex ) ) * ( 1_. ( F_Complex ) ) ) by POLYNOM5:27
.= <% ( 1_ ( F_Complex ) ) %> by POLYNOM5:29;
let i being Integer;
let c being (Element of ( F_Complex ));
let f being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) )));
let p being (Polynomial of ( F_Complex ));
assume that
A2: p = ( Product f )
and
A3: c = i
and
A4: (for i being non  empty (Element of ( NAT )) holds (i in ( dom f ) implies (( f . i ) = <% ( 1_ ( F_Complex ) ) %> or ( f . i ) = ( cyclotomic_poly i ))));
A5: ( eval (( 1_. ( F_Complex ) ),c) ) = 1 by COMPLFLD:8,POLYNOM4:18;
per cases ;
suppose ( len f ) = ( 0 );

then f = ( <*> (the carrier of ( Polynom-Ring ( F_Complex ) )) );
then p = ( 1_ ( Polynom-Ring ( F_Complex ) ) ) by A2,GROUP_4:8
.= ( 1. ( Polynom-Ring ( F_Complex ) ) );
hence thesis by A5,POLYNOM3:def 10;
end;
suppose A6: ( 0 ) < ( len f );

defpred P[ Nat,set ]
 means
(for fi being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds (fi = ( f | ( Seg $1 ) ) implies $2 = ( Product fi )));
A7: f = ( f | ( Seg ( len f ) ) ) by FINSEQ_3:49;
A8:now
let i being Nat;
assume i in ( Seg ( len f ) );
reconsider fi = ( f | ( Seg i ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
set x = ( Product fi );
take x;
thus P[ i,x ];
end;
consider F being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) such that ( dom F ) = ( Seg ( len f ) ) and A9: (for i being Nat holds (i in ( Seg ( len f ) ) implies P[ i,( F . i ) ])) from FINSEQ_1:sch 5(A8);
defpred R[ (Element of ( NAT )) ]
 means
(ex r being (Polynomial of ( F_Complex )) st (r = ( F . $1 ) & ( eval (r,c) ) is  integer));
A10:now
let i being (Element of ( NAT ));
assume that
A11: 1 <= i
and
A12: i < ( len f );
A13: i in ( Seg ( len f ) ) by A11,A12,FINSEQ_1:1;
reconsider fi1 = ( f | ( Seg ( i + 1 ) ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
A14: ( i + 1 ) <= ( len f ) by A12,NAT_1:13;
then ( i + 1 ) = ( min (( i + 1 ),( len f )) ) by XXREAL_0:def 9;
then A15: ( len fi1 ) = ( i + 1 ) by FINSEQ_2:21;
1 <= ( i + 1 ) by A11,NAT_1:13;
then A16: ( i + 1 ) in ( Seg ( len f ) ) by A14,FINSEQ_1:1;
then A17: ( i + 1 ) in ( dom f ) by FINSEQ_1:def 3;
reconsider fi = ( f | ( Seg i ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
assume A18: R[ i ];
A19: ( ( f | ( Seg ( i + 1 ) ) ) . ( i + 1 ) ) = ( f . ( i + 1 ) ) by FINSEQ_1:4,FUNCT_1:49;
then reconsider fi1d1 = ( fi1 . ( i + 1 ) ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by A17,FINSEQ_2:11;
reconsider pfi1 = ( Product fi1 ),pfi = ( Product fi ) as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
reconsider fi1d1p = fi1d1 as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
fi = ( fi1 | ( Seg i ) ) by CKB4:1,NAT_1:12;
then fi1 = ( fi ^ <* fi1d1 *> ) by A15,FINSEQ_3:55;
then A20: ( Product fi1 ) = ( ( Product fi ) * fi1d1 ) by GROUP_4:6;
thus R[ ( i + 1 ) ]
proof
reconsider epfi = ( eval (pfi,c) ),efi1d1p = ( eval (fi1d1p,c) ) as (Element of ( COMPLEX )) by COMPLFLD:def 1;
now
reconsider i1 = ( i + 1 ) as non  empty (Element of ( NAT ));
per cases  by A4,A17;
suppose ( f . i1 ) = <% ( 1_ ( F_Complex ) ) %>;

hence ( eval (fi1d1p,c) ) is  integer by A5,A1,FINSEQ_1:4,FUNCT_1:49;
end;
suppose ( f . i1 ) = ( cyclotomic_poly i1 );

hence ( eval (fi1d1p,c) ) is  integer by A3,A19,CKB68:1;
end;
end;
then reconsider iefi1d1p = efi1d1p as Integer;
reconsider iepfi = epfi as Integer by A9,A18,A13;
take pfi1;
thus pfi1 = ( F . ( i + 1 ) ) by A9,A16;
pfi1 = ( pfi *' fi1d1p ) by A20,POLYNOM3:def 10;
then ( eval (pfi1,c) ) = ( ( eval (pfi,c) ) * ( eval (fi1d1p,c) ) ) by POLYNOM4:24
.= ( iepfi * iefi1d1p );
hence thesis;
end;

end;
A21: ( ( 0 ) + 1 ) <= ( len f ) by A6,NAT_1:13;
then A22: 1 in ( Seg ( len f ) ) by FINSEQ_1:1;
A23: R[ 1 ]
proof
reconsider f1 = ( f | ( Seg 1 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
A24: 1 in ( dom f ) by A22,FINSEQ_1:def 3;
then reconsider fd1 = ( f . 1 ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_2:11;
reconsider fd1 as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
take fd1;
f1 = <* ( f . 1 ) *> by A21,CKB3:1;
hence fd1 = ( Product f1 ) by FINSOP_1:11
.= ( F . 1 ) by A9,A22;
per cases  by A4,A24;
suppose ( f . 1 ) = <% ( 1_ ( F_Complex ) ) %>;

hence thesis by A1,COMPLFLD:8,POLYNOM4:18;
end;
suppose ( f . 1 ) = ( cyclotomic_poly 1 );

hence thesis by A3,CKB68:1;
end;
end;
(for i being (Element of ( NAT )) holds ((1 <= i & i <= ( len f )) implies R[ i ])) from INT_1:sch 7(A23,A10);
then (ex r being (Polynomial of ( F_Complex )) st (r = ( F . ( len f ) ) & ( eval (r,c) ) is  integer)) by A21;
hence thesis by A2,A6,A9,A7,FINSEQ_1:3;
end;
end;
