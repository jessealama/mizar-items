environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,XXREAL_0,CARD_1,ARYTM_3,NAT_1,FINSEQ_1,RELAT_1,FUNCT_1,TARSKI,COMPLFLD,COMPLEX1,PARTFUN1,CARD_3,STRUCT_0,REAL_1,ORDINAL4,FINSET_1,UPROOTS,ARYTM_1,POLYNOM2,AFINSQ_1,GROUP_1,INT_1,HAHNBAN1,SQUARE_1,POWER,SIN_COS,BINOP_1,ALGSTR_0,FINSEQ_2,MOD_2,VECTSP_1,VECTSP_2,REALSET1,ZFMISC_1,SUPINF_2,COMPTRIG,RAT_1,PREPOWER,XREAL_0,ORDINAL1,NEWTON,XCMPLX_0,INT_2,BINOP_2,GROUP_2,POLYNOM1,POLYNOM3,FUNCT_4,ALGSEQ_1,VALUED_0,POLYNOM5,SGRAPH1,PRE_POLY,GRAPH_2,MESFUNC1,UNIROOTS;
notations TARSKI,XBOOLE_0,SUBSET_1,REALSET1,CARD_1,NUMBERS,XREAL_0,ZFMISC_1,XXREAL_0,COMPLEX1,REAL_1,SQUARE_1,INT_1,INT_2,NAT_1,NAT_D,PREPOWER,POWER,BINOP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,RAT_1,DOMAIN_1,FINSET_1,BINOP_2,STRUCT_0,ALGSTR_0,VECTSP_2,VECTSP_1,GROUP_4,RVSUM_1,ALGSEQ_1,COMPLFLD,HAHNBAN1,POLYNOM3,POLYNOM4,POLYNOM5,COMPTRIG,GROUP_2,NEWTON,GROUP_1,MOD_2,GRAPH_2,ORDINAL1,PRE_POLY,FVSUM_1,UPROOTS,SIN_COS,FUNCT_7,FINSEQ_2,CKB21,CKB29,CKB48,CKB50,CKB63;
definitions TARSKI,GROUP_1,XBOOLE_0,BINOP_1,REALSET1,SQUARE_1,HAHNBAN1,POLYNOM3,FINSEQ_2,COMPLEX1,GROUP_4,ALGSTR_0,STRUCT_0,CKB21,CKB29,CKB48,CKB50,CKB63;
theorems GROUP_1,CARD_1,FINSEQ_1,ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,RELAT_1,TARSKI,XBOOLE_0,XBOOLE_1,VECTSP_1,PREPOWER,COMPTRIG,COMPLFLD,BINOP_1,XCMPLX_1,COMPLEX1,HAHNBAN1,SIN_COS,POWER,SIN_COS2,POLYNOM5,INT_1,COMPLEX2,XCMPLX_0,XREAL_0,SQUARE_1,RVSUM_1,FVSUM_1,FINSEQ_3,FINSEQ_2,FINSEQ_4,POLYNOM4,INT_2,WSIERP_1,NAT_2,PEPIN,POLYNOM3,COMPUT_1,NORMSP_1,FUNCT_7,ALGSEQ_1,RLVECT_1,NEWTON,POLYNOM2,MATRIX_3,VECTSP_2,MOD_2,CARD_2,GRAPH_2,FINSEQ_5,UPROOTS,GROUP_2,BINOP_2,XREAL_1,XXREAL_0,GROUP_4,FUNCOP_1,ORDINAL1,FINSOP_1,NAT_D,PARTFUN1,PRE_POLY,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB21,CKB22,CKB23,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65;
schemes NAT_1,FUNCT_2,FINSEQ_1,INT_1,RECDEF_1,CKB2;
registrations RELAT_1,FUNCT_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,CARD_1,MEMBERED,FINSEQ_1,FINSEQ_2,REALSET1,WSIERP_1,STRUCT_0,GROUP_1,VECTSP_1,COMPLFLD,QUOFIELD,POLYNOM3,POLYNOM5,VALUED_0,ALGSTR_0,POWER,UPROOTS,FUNCT_2,RELSET_1,PRE_POLY,XBOOLE_0,ZFMISC_1,CKB19,CKB20,CKB25,CKB37,CKB38,CKB55;
constructors WELLORD2,BINOP_1,REAL_1,SQUARE_1,NAT_D,FINSEQOP,FINSOP_1,RVSUM_1,PREPOWER,POWER,REALSET1,SIN_COS,GROUP_4,MOD_2,MATRIX_2,HAHNBAN1,GRAPH_2,POLYNOM4,POLYNOM5,UPROOTS,SEQ_1,RECDEF_1,BINOP_2,RELSET_1,PBOOLE,FUNCT_7,POLYNOM1,NEWTON,FVSUM_1,CKB21,CKB29,CKB48,CKB50,CKB63;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
theorem
Th54: (for n being non empty (Element of ( NAT )) holds (ex f being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) st (ex p being (Polynomial of ( F_Complex )) st (((p = ( Product f ) & ( dom f ) = ( Seg n )) & (for i being non empty (Element of ( NAT )) holds (i in ( Seg n ) implies ((((not i divides n) or i = n) implies ( f . i ) = <% ( 1_ ( F_Complex ) ) %>) & ((i divides n & i <> n) implies ( f . i ) = ( cyclotomic_poly i )))))) & ( unital_poly (( F_Complex ),n) ) = ( ( cyclotomic_poly n ) *' p )))))
proof
set cPRFC = (the carrier of ( Polynom-Ring ( F_Complex ) ));
let n being non empty (Element of ( NAT ));
defpred P[ set,set ]
 means
(ex i being non empty (Element of ( NAT )) st ((i = $1 & ((not i divides n) implies $2 = <% ( 1_ ( F_Complex ) ) %>)) & (i divides n implies $2 = ( cyclotomic_poly i ))));
consider m being Nat such that A1: n = ( m + 1 ) by NAT_1:6;
A2: (for k being (Element of ( NAT )) holds (k in ( Seg n ) implies (ex x being (Element of cPRFC) st P[ k,x ])))
proof
let k being (Element of ( NAT ));
assume k in ( Seg n );
then reconsider i = k as non empty (Element of ( NAT )) by FINSEQ_1:1;
per cases ;
suppose A3: (not i divides n);

reconsider FC1 = <% ( 1_ ( F_Complex ) ) %> as (Element of cPRFC) by POLYNOM3:def 10;
take FC1;
take i;
thus i = k;
thus thesis by A3;
end;
suppose A4: i divides n;

reconsider FC1 = ( cyclotomic_poly i ) as (Element of cPRFC) by POLYNOM3:def 10;
take FC1;
take i;
thus i = k;
thus thesis by A4;
end;
end;
consider f being (FinSequence of cPRFC) such that A5: ( dom f ) = ( Seg n ) and A6: (for k being (Element of ( NAT )) holds (k in ( Seg n ) implies P[ k,( f /. k ) ])) from RECDEF_1:sch 17(A2);
reconsider fm = ( f | ( Seg m ) ) as (FinSequence of cPRFC) by FINSEQ_1:18;
A7: ( len f ) = n by A5,FINSEQ_1:def 3;
A8:now
let i being non empty (Element of ( NAT ));
assume A9: i in ( dom f );
then A10: i <= n by A5,FINSEQ_1:1;
((ex j being non empty (Element of ( NAT )) st ((j = i & ((not j divides n) implies ( f /. i ) = <% ( 1_ ( F_Complex ) ) %>)) & (j divides n implies ( f /. i ) = ( cyclotomic_poly j )))) & 1 <= i) by A5,A6,A9,FINSEQ_1:1;
hence (((not i divides n) implies ( f . i ) = <% ( 1_ ( F_Complex ) ) %>) & (i divides n implies ( f . i ) = ( cyclotomic_poly i ))) by A7,A10,FINSEQ_4:15;
end;
reconsider FC1 = <% ( 1_ ( F_Complex ) ) %> as (Element of cPRFC) by POLYNOM3:def 10;
<* FC1 *> is (FinSequence of cPRFC);
then reconsider h = ( fm ^ <* <% ( 1_ ( F_Complex ) ) %> *> ) as (FinSequence of cPRFC) by FINSEQ_1:75;
reconsider p = ( Product h ) as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
take h;
take p;
thus p = ( Product h );
A11: m <= n by A1,NAT_1:13;
then A12: ( len fm ) = m by A7,FINSEQ_1:17;
reconsider cpn = ( cyclotomic_poly n ) as (Element of cPRFC) by POLYNOM3:def 10;
reconsider fn = ( f | ( Seg n ) ) as (FinSequence of cPRFC) by FINSEQ_1:18;
1 <= n by NAT_1:53;
then A13: n in ( Seg n ) by FINSEQ_1:1;
then A14: ( f . n ) = ( cyclotomic_poly n ) by A5,A8;
( len <* <% ( 1_ ( F_Complex ) ) %> *> ) = 1 by FINSEQ_1:40;
hence ( dom h ) = ( Seg n ) by A1,A12,FINSEQ_1:def 7;
A15: ( dom fm ) = ( Seg m ) by A7,A11,FINSEQ_1:17;
thus (for i being non empty (Element of ( NAT )) holds (i in ( Seg n ) implies ((((not i divides n) or i = n) implies ( h . i ) = <% ( 1_ ( F_Complex ) ) %>) & ((i divides n & i <> n) implies ( h . i ) = ( cyclotomic_poly i )))))
proof
let i being non empty (Element of ( NAT ));
assume A16: i in ( Seg n );
per cases ;
suppose A17: i in ( Seg m );

then A18: (( fm . i ) = ( f . i ) & i <= m) by FINSEQ_1:1,FUNCT_1:49;
( h . i ) = ( fm . i ) by A15,A17,FINSEQ_1:def 7;
hence thesis by A5,A1,A8,A16,A18,NAT_1:13;
end;
suppose (not i in ( Seg m ));

then (not (1 <= i & i <= m)) by FINSEQ_1:1;
then A19: n <= i by A1,A16,FINSEQ_1:1,NAT_1:13;
A20: i <= n by A16,FINSEQ_1:1;
1 in ( Seg 1 ) by FINSEQ_1:1;
then 1 in ( dom <* <% ( 1_ ( F_Complex ) ) %> *> ) by FINSEQ_1:38;
then ( h . n ) = ( <* <% ( 1_ ( F_Complex ) ) %> *> . 1 ) by A1,A12,FINSEQ_1:def 7
.= <% ( 1_ ( F_Complex ) ) %> by FINSEQ_1:40;
hence (((not i divides n) or i = n) implies ( h . i ) = <% ( 1_ ( F_Complex ) ) %>) by A19,A20,XXREAL_0:1;
thus thesis by A19,A20,XXREAL_0:1;
end;
end;

reconsider p1 = <% ( 1_ ( F_Complex ) ) %> as (Element of cPRFC) by POLYNOM3:def 10;
reconsider Pfm = ( Product fm ) as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
A21: ( Product h ) = ( ( Product fm ) * p1 ) by GROUP_4:6
.= ( Pfm *' <% ( 1_ ( F_Complex ) ) %> ) by POLYNOM3:def 10
.= ( Product fm ) by UPROOTS:32;
f = fn by A7,FINSEQ_2:20
.= ( fm ^ <* ( cyclotomic_poly n ) *> ) by A5,A1,A13,A14,FINSEQ_5:10;
then A22: ( Product f ) = ( ( Product fm ) * cpn ) by GROUP_4:6;
( unital_poly (( F_Complex ),n) ) = ( Product f ) by A7,A8,CKB65:1;
hence thesis by A21,A22,POLYNOM3:def 10;
end;
