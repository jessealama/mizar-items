environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,XXREAL_0,CARD_1,ARYTM_3,NAT_1,FINSEQ_1,RELAT_1,FUNCT_1,TARSKI,COMPLFLD,COMPLEX1,PARTFUN1,CARD_3,STRUCT_0,REAL_1,ORDINAL4,FINSET_1,UPROOTS,ARYTM_1,POLYNOM2,AFINSQ_1,GROUP_1,INT_1,HAHNBAN1,SQUARE_1,POWER,SIN_COS,BINOP_1,ALGSTR_0,FINSEQ_2,MOD_2,VECTSP_1,VECTSP_2,REALSET1,ZFMISC_1,SUPINF_2,COMPTRIG,RAT_1,PREPOWER,XREAL_0,ORDINAL1,NEWTON,XCMPLX_0,INT_2,BINOP_2,GROUP_2,POLYNOM1,POLYNOM3,FUNCT_4,ALGSEQ_1,VALUED_0,POLYNOM5,SGRAPH1,PRE_POLY,GRAPH_2,MESFUNC1,UNIROOTS;
notations TARSKI,XBOOLE_0,SUBSET_1,REALSET1,CARD_1,NUMBERS,XREAL_0,ZFMISC_1,XXREAL_0,COMPLEX1,REAL_1,SQUARE_1,INT_1,INT_2,NAT_1,NAT_D,PREPOWER,POWER,BINOP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,RAT_1,DOMAIN_1,FINSET_1,BINOP_2,STRUCT_0,ALGSTR_0,VECTSP_2,VECTSP_1,GROUP_4,RVSUM_1,ALGSEQ_1,COMPLFLD,HAHNBAN1,POLYNOM3,POLYNOM4,POLYNOM5,COMPTRIG,GROUP_2,NEWTON,GROUP_1,MOD_2,GRAPH_2,ORDINAL1,PRE_POLY,FVSUM_1,UPROOTS,SIN_COS,FUNCT_7,FINSEQ_2,CKB21,CKB29;
definitions TARSKI,GROUP_1,XBOOLE_0,BINOP_1,REALSET1,SQUARE_1,HAHNBAN1,POLYNOM3,FINSEQ_2,COMPLEX1,GROUP_4,ALGSTR_0,STRUCT_0,CKB21,CKB29;
theorems GROUP_1,CARD_1,FINSEQ_1,ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,RELAT_1,TARSKI,XBOOLE_0,XBOOLE_1,VECTSP_1,PREPOWER,COMPTRIG,COMPLFLD,BINOP_1,XCMPLX_1,COMPLEX1,HAHNBAN1,SIN_COS,POWER,SIN_COS2,POLYNOM5,INT_1,COMPLEX2,XCMPLX_0,XREAL_0,SQUARE_1,RVSUM_1,FVSUM_1,FINSEQ_3,FINSEQ_2,FINSEQ_4,POLYNOM4,INT_2,WSIERP_1,NAT_2,PEPIN,POLYNOM3,COMPUT_1,NORMSP_1,FUNCT_7,ALGSEQ_1,RLVECT_1,NEWTON,POLYNOM2,MATRIX_3,VECTSP_2,MOD_2,CARD_2,GRAPH_2,FINSEQ_5,UPROOTS,GROUP_2,BINOP_2,XREAL_1,XXREAL_0,GROUP_4,FUNCOP_1,ORDINAL1,FINSOP_1,NAT_D,PARTFUN1,PRE_POLY,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB21,CKB22,CKB23,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB39,CKB40,CKB41;
schemes NAT_1,FUNCT_2,FINSEQ_1,INT_1,RECDEF_1,CKB2;
registrations RELAT_1,FUNCT_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,CARD_1,MEMBERED,FINSEQ_1,FINSEQ_2,REALSET1,WSIERP_1,STRUCT_0,GROUP_1,VECTSP_1,COMPLFLD,QUOFIELD,POLYNOM3,POLYNOM5,VALUED_0,ALGSTR_0,POWER,UPROOTS,FUNCT_2,RELSET_1,PRE_POLY,XBOOLE_0,ZFMISC_1,CKB19,CKB20,CKB25,CKB37,CKB38;
constructors WELLORD2,BINOP_1,REAL_1,SQUARE_1,NAT_D,FINSEQOP,FINSOP_1,RVSUM_1,PREPOWER,POWER,REALSET1,SIN_COS,GROUP_4,MOD_2,MATRIX_2,HAHNBAN1,GRAPH_2,POLYNOM4,POLYNOM5,UPROOTS,SEQ_1,RECDEF_1,BINOP_2,RELSET_1,PBOOLE,FUNCT_7,POLYNOM1,NEWTON,FVSUM_1,CKB21,CKB29;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
theorem
Th34: (for n being non  empty (Element of ( NAT )) holds (for k being (Element of ( NAT )) holds (for x being (Element of ( MultGroup ( F_Complex ) )) holds (x = [** ( cos ( ( ( 2 * ( PI ) ) * k ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * k ) / n ) ) **] implies ( ord x ) = ( n div ( k gcd n ) )))))
proof
let n being non  empty (Element of ( NAT ));
let k being (Element of ( NAT ));
reconsider kgn = ( k gcd n ) as (Element of ( NAT ));
A1: ( k gcd n ) divides n by INT_2:21;
then consider vn being Nat such that A2: n = ( kgn * vn ) by NAT_D:def 3;
( k gcd n ) divides k by INT_2:21;
then consider i being Nat such that A3: k = ( kgn * i ) by NAT_D:def 3;
let x being (Element of ( MultGroup ( F_Complex ) ));
assume that
A4: x = [** ( cos ( ( ( 2 * ( PI ) ) * k ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * k ) / n ) ) **];
x in ( n -roots_of_1 ) by A4,CKB33:1;
then A5: (not x is  being_of_order_0) by CKB41:1;
A6: ( n gcd k ) > ( 0 ) by NEWTON:58;
A7:now
assume ( n div kgn ) = ( 0 );
then n = ( ( kgn * (( 0 ) qua Nat) ) + ( n mod kgn ) ) by NAT_D:2,NEWTON:58;
hence contradiction by A1,A6,NAT_D:1,NAT_D:7;
end;
reconsider y = x as (Element of ( F_Complex )) by CKB27:1;
reconsider vn as (Element of ( NAT )) by ORDINAL1:def 12;
A8: (not vn is  empty) by A2;
A9: n = ( ( kgn * vn ) + ( 0 ) ) by A2;
then A10: ( n div kgn ) = vn by A6,NAT_D:def 1;
A11: (for m being Nat holds ((( x |^ m ) = ( 1_ ( MultGroup ( F_Complex ) ) ) & m <> ( 0 )) implies ( n div kgn ) <= m))
proof
let m being Nat;
assume that
A12: ( x |^ m ) = ( 1_ ( MultGroup ( F_Complex ) ) )
and
A13: m <> ( 0 );
reconsider m as (Element of ( NAT )) by ORDINAL1:def 12;
now
assume A14: m < vn;
A15:now
assume ( ( k * m ) mod n ) = ( 0 );
then n divides ( k * m ) by PEPIN:6;
then consider j being Nat such that A16: ( k * m ) = ( n * j ) by NAT_D:def 3;
consider a,b being Integer such that A17: k = ( kgn * a ) and A18: n = ( kgn * b ) and A19: a,b are_relative_prime  by INT_2:23;
( 0 ) <= a by A6,A17;
then reconsider ai = a as (Element of ( NAT )) by INT_1:3;
( 0 ) <= b by A18;
then reconsider bi = b as (Element of ( NAT )) by INT_1:3;
( ( m * a ) * kgn ) = ( j * ( b * kgn ) ) by A17,A18,A16;
then ( m * a ) = ( ( ( j * b ) * kgn ) / kgn ) by A6,XCMPLX_1:89;
then ( m * a ) = ( j * b ) by A6,XCMPLX_1:89;
then A20: bi divides ( m * ai ) by NAT_D:def 3;
m < bi by A6,A10,A14,A18,NAT_D:18;
hence contradiction by A13,A19,A20,INT_2:25,NAT_D:7;
end;
A21: ( ( ( ( 2 * ( PI ) ) * k ) / n ) * m ) = ( ( ( 2 * ( PI ) ) * k ) / ( n / m ) ) by XCMPLX_1:82
.= ( ( ( ( 2 * ( PI ) ) * k ) * m ) / n ) by XCMPLX_1:77;
( ( 2 * ( PI ) ) * ( ( k * m ) mod n ) ) < ( ( 2 * ( PI ) ) * n ) by COMPTRIG:5,NAT_D:1,XREAL_1:68;
then ( ( ( 2 * ( PI ) ) * ( ( k * m ) mod n ) ) / n ) < ( ( ( 2 * ( PI ) ) * n ) / n ) by XREAL_1:74;
then A22: ( ( ( 2 * ( PI ) ) * ( ( k * m ) mod n ) ) / n ) < ( 2 * ( PI ) ) by XCMPLX_1:89;
A23: ( 1_ ( MultGroup ( F_Complex ) ) ) = [** 1,( 0 ) **] by CKB24:1,COMPLFLD:8;
( x |^ m ) = ( ( power ( F_Complex ) ) . (y,m) ) by CKB40:1
.= ( y |^ m ) by A13,COMPLFLD:74
.= [** ( cos ( ( ( 2 * ( PI ) ) * ( k * m ) ) / n ) ),( sin ( ( ( ( 2 * ( PI ) ) * k ) * m ) / n ) ) **] by A4,A21,COMPTRIG:53
.= [** ( cos ( ( ( 2 * ( PI ) ) * ( ( k * m ) mod n ) ) / n ) ),( sin ( ( ( 2 * ( PI ) ) * ( ( k * m ) mod n ) ) / n ) ) **] by CKB13:1;
then ( cos ( ( ( 2 * ( PI ) ) * ( ( k * m ) mod n ) ) / n ) ) = 1 by A12,A23,COMPLEX1:77;
hence contradiction by A15,A22,COMPTRIG:5,COMPTRIG:61;
end;
hence thesis by A6,A9,NAT_D:def 1;
end;
reconsider i as (Element of ( NAT )) by ORDINAL1:def 12;
A24: ( ( ( ( 2 * ( PI ) ) * k ) / n ) * vn ) = ( ( ( 2 * ( PI ) ) * ( kgn * i ) ) / ( n / vn ) ) by A3,XCMPLX_1:82
.= ( ( ( ( 2 * ( PI ) ) * ( kgn * i ) ) * vn ) / n ) by XCMPLX_1:77
.= ( ( ( ( 2 * ( PI ) ) * i ) * n ) / n ) by A2
.= ( ( ( 2 * ( PI ) ) * i ) + ( 0 ) ) by XCMPLX_1:89;
( x |^ ( n div kgn ) ) = ( ( power ( F_Complex ) ) . (y,vn) ) by A10,CKB40:1
.= ( y |^ vn ) by A8,COMPLFLD:74
.= [** ( cos ( ( ( ( 2 * ( PI ) ) * k ) / n ) * vn ) ),( sin ( ( ( ( 2 * ( PI ) ) * k ) / n ) * vn ) ) **] by A4,COMPTRIG:53
.= [** ( cos ( 0 ) ),( sin ( ( ( 2 * ( PI ) ) * i ) + ( 0 ) ) ) **] by A24,COMPLEX2:9
.= ( 1 + ( ( 0 ) * ( <i> ) ) ) by COMPLEX2:8,SIN_COS:31
.= ( 1_ ( MultGroup ( F_Complex ) ) ) by CKB24:1,COMPLFLD:8;
hence thesis by A7,A5,A11,GROUP_1:def 11;
end;
