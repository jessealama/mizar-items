environ
vocabularies NUMBERS,SUBSET_1,FINSEQ_1,EUCLID,PRE_TOPC,TOPREAL1,JORDAN3,XXREAL_0,XBOOLE_0,CARD_1,ARYTM_3,GROUP_2,PARTFUN1,FINSEQ_5,FUNCT_1,RELAT_1,FINSEQ_6,ARYTM_1,FINSEQ_4,RFINSEQ,ORDINAL4,RCOMP_1,SPPOL_1,JORDAN9,RLTOPSP1,NAT_1,TARSKI,GRAPH_2,MCART_1,REAL_1,SUPINF_2,JORDAN2C,SPPOL_2,JORDAN18,GOBOARD1,GOBOARD2,GOBOARD5,MATRIX_1,JORDAN23;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XXREAL_0,REAL_1,NAT_1,FUNCT_1,PARTFUN1,FINSEQ_1,FINSEQ_4,FINSEQ_5,RFINSEQ,MATRIX_1,FINSEQ_6,GRAPH_2,STRUCT_0,PRE_TOPC,NAT_D,COMPTS_1,RLVECT_1,RLTOPSP1,EUCLID,GOBOARD1,TOPREAL1,GOBOARD2,GOBOARD5,SPPOL_1,SPPOL_2,JORDAN3,JORDAN5C,JORDAN9,JORDAN2C,JORDAN18,CKB5,CKB6,CKB7;
definitions TARSKI,XBOOLE_0,FUNCT_1,RLTOPSP1,CKB5,CKB6,CKB7;
theorems NAT_1,FINSEQ_1,FINSEQ_4,EUCLID,FINSEQ_3,SPPOL_2,TARSKI,JORDAN3,FINSEQ_5,FINSEQ_6,GOBOARD7,TOPREAL1,JORDAN5B,SPRECT_2,SPPOL_1,FUNCT_1,FINSEQ_2,JORDAN4,GOBOARD2,SPRECT_3,TOPREAL3,JORDAN8,PARTFUN2,XBOOLE_0,XBOOLE_1,ZFMISC_1,JORDAN1E,REVROT_1,JORDAN1B,JORDAN1J,GOBOARD3,TOPREAL8,GRAPH_2,SPRECT_5,JORDAN18,JORDAN5C,MSUALG_8,XREAL_1,XXREAL_0,ORDINAL1,PARTFUN1,XREAL_0,NAT_D,RLTOPSP1,RFINSEQ,SEQ_4,CKB1,CKB2,CKB3,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB13,CKB19,CKB20,CKB21,CKB26,CKB27,CKB28,CKB33,CKB36,CKB37,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59;
registrations XBOOLE_0,RELAT_1,FUNCT_1,XXREAL_0,XREAL_0,REAL_1,FINSEQ_1,REALSET1,FINSEQ_5,FINSEQ_6,STRUCT_0,GOBOARD2,SPPOL_2,SPRECT_1,REVROT_1,TOPREAL6,JORDAN1J,ORDINAL1,CARD_1,EUCLID,SPRECT_5,ZFMISC_1,SUBSET_1,CKB4,CKB11,CKB12,CKB14,CKB15,CKB16,CKB17,CKB18,CKB22,CKB23,CKB24,CKB25,CKB29,CKB30,CKB31,CKB32,CKB34,CKB35,CKB38;
constructors PARTFUN1,XXREAL_0,REAL_1,NAT_1,FINSEQ_4,REALSET1,RFINSEQ,NAT_D,FINSEQ_5,GOBOARD2,GRAPH_2,JORDAN3,JORDAN5C,SPRECT_1,JORDAN2C,JORDAN9,JORDAN18,BINOP_2,GOBOARD1,RELSET_1,CKB5,CKB6,CKB7;
requirements ARITHM,NUMERALS,BOOLE,SUBSET,REAL;
begin
theorem
Th38: (for f being non empty (FinSequence of ( TOP-REAL 2 )) holds (for p being (Point of ( TOP-REAL 2 )) holds (((f is  poorly-one-to-one  unfolded  s.n.c. & p in ( L~ f )) & p <> ( f . ( len f ) )) implies ( L_Cut (( Rev f ),p) ) = ( Rev ( R_Cut (f,p) ) ))))
proof
let f being non empty (FinSequence of ( TOP-REAL 2 ));
let p being (Point of ( TOP-REAL 2 ));
assume that
A1: f is  poorly-one-to-one  unfolded  s.n.c.
and
A2: p in ( L~ f )
and
A3: p <> ( f . ( len f ) );
A4: ( Index (p,f) ) < ( len f ) by A2,JORDAN3:8;
A5: p in ( L~ ( Rev f ) ) by A2,SPPOL_2:22;
A6: ( Rev ( Rev f ) ) = f by FINSEQ_6:25;
A7: ( Rev f ) is  s.n.c. by A1,SPPOL_2:35;
A8: ( dom ( Rev f ) ) = ( dom f ) by FINSEQ_5:57;
A9: ( len f ) = ( len ( Rev f ) ) by FINSEQ_5:def 3;
A10: 1 <= ( Index (p,f) ) by A2,JORDAN3:8;
then A11: 1 < ( len f ) by A4,XXREAL_0:2;
( L~ f ) = ( L~ ( Rev f ) ) by SPPOL_2:22;
then ( Index (p,( Rev f )) ) < ( len ( Rev f ) ) by A2,JORDAN3:8;
then A12: ( ( Index (p,( Rev f )) ) + 1 ) <= ( len f ) by A9,NAT_1:13;
1 <= ( ( Index (p,( Rev f )) ) + 1 ) by NAT_1:11;
then A13: ( ( Index (p,( Rev f )) ) + 1 ) in ( dom f ) by A12,FINSEQ_3:25;
per cases  by A3;
suppose A14: p = ( f . 1 );

A15: ( ( ( len ( Rev f ) ) -' 1 ) + 1 ) = ( len ( Rev f ) ) by A9,A10,A4,XREAL_1:235,XXREAL_0:2;
then A16: ( ( ( Rev f ) /^ ( ( len ( Rev f ) ) -' 1 ) ) . 1 ) = ( ( Rev f ) . ( len ( Rev f ) ) ) by FINSEQ_6:114;
A17: ( len ( ( Rev f ) /^ ( ( len ( Rev f ) ) -' 1 ) ) ) = ( ( len ( Rev f ) ) -' ( ( len ( Rev f ) ) -' 1 ) ) by RFINSEQ:29;
A18: 1 <= ( ( len ( Rev f ) ) - ( ( len ( Rev f ) ) -' 1 ) ) by A15;
then A19: 1 <= ( len ( ( Rev f ) /^ ( ( len ( Rev f ) ) -' 1 ) ) ) by A17,NAT_D:39;
A20: ( ( Rev f ) /^ ( ( len ( Rev f ) ) -' 1 ) ) is non empty by A17,A18,NAT_D:39;
( ( ( len ( Rev f ) ) -' ( len ( Rev f ) ) ) + 1 ) = ( ( ( len ( Rev f ) ) - ( len ( Rev f ) ) ) + 1 ) by XREAL_1:233
.= 1;
then A21: ( mid (( Rev f ),( len ( Rev f ) ),( len ( Rev f ) )) ) = ( ( ( Rev f ) /^ ( ( len ( Rev f ) ) -' 1 ) ) | 1 ) by FINSEQ_6:def 3
.= <* ( ( ( Rev f ) /^ ( ( len ( Rev f ) ) -' 1 ) ) /. 1 ) *> by A20,FINSEQ_5:20
.= <* ( ( Rev f ) . ( len ( Rev f ) ) ) *> by A16,A19,FINSEQ_4:15;
A22: p = ( ( Rev f ) . ( len f ) ) by A14,FINSEQ_5:62;
then ( ( Index (p,( Rev f )) ) + 1 ) = ( len f ) by A1,A7,A9,A11,CKB40:1,SPPOL_2:28;
hence ( L_Cut (( Rev f ),p) ) = <* p *> by A9,A22,A21,JORDAN3:def 3
.= ( Rev <* p *> ) by FINSEQ_5:60
.= ( Rev ( R_Cut (f,p) ) ) by A14,JORDAN3:def 4;
end;
suppose that A23: p <> ( f . 1 )
and
A24: p <> ( f . ( len f ) )
and
A25: p = ( f . ( ( Index (p,f) ) + 1 ) );
A26: ( len f ) = ( ( ( Index (p,( Rev f )) ) + ( Index (p,f) ) ) + 1 ) by A1,A2,A24,A25,CKB58:1
.= ( ( Index (p,f) ) + ( ( Index (p,( Rev f )) ) + 1 ) );
( len f ) = ( ( ( Index (p,( Rev f )) ) + ( Index (p,f) ) ) + 1 ) by A1,A2,A24,A25,CKB58:1
.= ( ( Index (p,( Rev f )) ) + ( ( Index (p,f) ) + 1 ) );
then A27: p = ( f . ( ( ( len f ) - ( ( Index (p,( Rev f )) ) + 1 ) ) + 1 ) ) by A25
.= ( ( Rev f ) . ( ( Index (p,( Rev f )) ) + 1 ) ) by A13,FINSEQ_5:58;
A28: ( ( len f ) -' ( Index (p,f) ) ) = ( ( len f ) - ( Index (p,f) ) ) by A4,XREAL_1:233
.= ( ( Index (p,( Rev f )) ) + 1 ) by A26;
p <> ( ( Rev f ) . ( len f ) ) by A23,FINSEQ_5:62;
then A29: ( ( Index (p,( Rev f )) ) + 1 ) < ( len f ) by A12,A27,XXREAL_0:1;
thus ( L_Cut (( Rev f ),p) ) = ( mid (( Rev f ),( ( Index (p,( Rev f )) ) + 1 ),( len f )) ) by A9,A27,JORDAN3:def 3
.= ( <* p *> ^ ( mid (( Rev f ),( ( ( len f ) -' ( Index (p,f) ) ) + 1 ),( len f )) ) ) by A8,A13,A27,A28,A29,FINSEQ_6:126
.= ( <* p *> ^ ( mid (( Rev f ),( ( ( len f ) -' ( Index (p,f) ) ) + 1 ),( ( ( len f ) -' 1 ) + 1 )) ) ) by A10,A4,XREAL_1:235,XXREAL_0:2
.= ( <* p *> ^ ( Rev ( mid (f,1,( Index (p,f) )) ) ) ) by A10,A4,A11,FINSEQ_6:113
.= ( Rev ( ( mid (f,1,( Index (p,f) )) ) ^ <* p *> ) ) by FINSEQ_5:63
.= ( Rev ( R_Cut (f,p) ) ) by A23,JORDAN3:def 4;
end;
suppose that A30: p <> ( f . 1 )
and
A31: p <> ( f . ( ( Index (p,f) ) + 1 ) );
A32: p <> ( ( Rev f ) . ( len f ) ) by A30,FINSEQ_5:62;
A33:now
assume A34: p = ( ( Rev f ) . ( ( Index (p,( Rev f )) ) + 1 ) );
then A35: ( len ( Rev f ) ) = ( ( ( Index (p,( Rev ( Rev f ) )) ) + ( Index (p,( Rev f )) ) ) + 1 ) by A1,A7,A5,A9,A32,CKB58:1,SPPOL_2:28
.= ( ( ( Index (p,f) ) + 1 ) + ( Index (p,( Rev f )) ) ) by A6;
p = ( f . ( ( ( len f ) - ( ( Index (p,( Rev f )) ) + 1 ) ) + 1 ) ) by A13,A34,FINSEQ_5:58
.= ( f . ( ( Index (p,f) ) + 1 ) ) by A9,A35;
hence contradiction by A31;
end;
A36: ( Index (p,f) ) < ( len f ) by A2,JORDAN3:8;
( len f ) = ( ( Index (p,( Rev f )) ) + ( Index (p,f) ) ) by A1,A2,A31,JORDAN3:21;
then ( Index (p,( Rev f )) ) = ( ( len f ) - ( Index (p,f) ) )
.= ( ( len f ) -' ( Index (p,f) ) ) by A36,XREAL_1:233;
hence ( L_Cut (( Rev f ),p) ) = ( <* p *> ^ ( mid (( Rev f ),( ( ( len f ) -' ( Index (p,f) ) ) + 1 ),( len f )) ) ) by A9,A33,JORDAN3:def 3
.= ( <* p *> ^ ( mid (( Rev f ),( ( ( len f ) -' ( Index (p,f) ) ) + 1 ),( ( ( len f ) -' 1 ) + 1 )) ) ) by A10,A4,XREAL_1:235,XXREAL_0:2
.= ( <* p *> ^ ( Rev ( mid (f,1,( Index (p,f) )) ) ) ) by A10,A4,A11,FINSEQ_6:113
.= ( Rev ( ( mid (f,1,( Index (p,f) )) ) ^ <* p *> ) ) by FINSEQ_5:63
.= ( Rev ( R_Cut (f,p) ) ) by A30,JORDAN3:def 4;
end;
end;
