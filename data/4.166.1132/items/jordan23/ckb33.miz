environ
vocabularies NUMBERS,SUBSET_1,FINSEQ_1,EUCLID,PRE_TOPC,TOPREAL1,JORDAN3,XXREAL_0,XBOOLE_0,CARD_1,ARYTM_3,GROUP_2,PARTFUN1,FINSEQ_5,FUNCT_1,RELAT_1,FINSEQ_6,ARYTM_1,FINSEQ_4,RFINSEQ,ORDINAL4,RCOMP_1,SPPOL_1,JORDAN9,RLTOPSP1,NAT_1,TARSKI,GRAPH_2,MCART_1,REAL_1,SUPINF_2,JORDAN2C,SPPOL_2,JORDAN18,GOBOARD1,GOBOARD2,GOBOARD5,MATRIX_1,JORDAN23;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XXREAL_0,REAL_1,NAT_1,FUNCT_1,PARTFUN1,FINSEQ_1,FINSEQ_4,FINSEQ_5,RFINSEQ,MATRIX_1,FINSEQ_6,GRAPH_2,STRUCT_0,PRE_TOPC,NAT_D,COMPTS_1,RLVECT_1,RLTOPSP1,EUCLID,GOBOARD1,TOPREAL1,GOBOARD2,GOBOARD5,SPPOL_1,SPPOL_2,JORDAN3,JORDAN5C,JORDAN9,JORDAN2C,JORDAN18,CKB5,CKB6,CKB7;
definitions TARSKI,XBOOLE_0,FUNCT_1,RLTOPSP1,CKB5,CKB6,CKB7;
theorems NAT_1,FINSEQ_1,FINSEQ_4,EUCLID,FINSEQ_3,SPPOL_2,TARSKI,JORDAN3,FINSEQ_5,FINSEQ_6,GOBOARD7,TOPREAL1,JORDAN5B,SPRECT_2,SPPOL_1,FUNCT_1,FINSEQ_2,JORDAN4,GOBOARD2,SPRECT_3,TOPREAL3,JORDAN8,PARTFUN2,XBOOLE_0,XBOOLE_1,ZFMISC_1,JORDAN1E,REVROT_1,JORDAN1B,JORDAN1J,GOBOARD3,TOPREAL8,GRAPH_2,SPRECT_5,JORDAN18,JORDAN5C,MSUALG_8,XREAL_1,XXREAL_0,ORDINAL1,PARTFUN1,XREAL_0,NAT_D,RLTOPSP1,RFINSEQ,SEQ_4,CKB1,CKB2,CKB3,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB13,CKB19,CKB20,CKB21,CKB26,CKB27,CKB28;
registrations XBOOLE_0,RELAT_1,FUNCT_1,XXREAL_0,XREAL_0,REAL_1,FINSEQ_1,REALSET1,FINSEQ_5,FINSEQ_6,STRUCT_0,GOBOARD2,SPPOL_2,SPRECT_1,REVROT_1,TOPREAL6,JORDAN1J,ORDINAL1,CARD_1,EUCLID,SPRECT_5,ZFMISC_1,SUBSET_1,CKB4,CKB11,CKB12,CKB14,CKB15,CKB16,CKB17,CKB18,CKB22,CKB23,CKB24,CKB25,CKB29,CKB30,CKB31,CKB32;
constructors PARTFUN1,XXREAL_0,REAL_1,NAT_1,FINSEQ_4,REALSET1,RFINSEQ,NAT_D,FINSEQ_5,GOBOARD2,GRAPH_2,JORDAN3,JORDAN5C,SPRECT_1,JORDAN2C,JORDAN9,JORDAN18,BINOP_2,GOBOARD1,RELSET_1,CKB5,CKB6,CKB7;
requirements ARITHM,NUMERALS,BOOLE,SUBSET,REAL;
begin
theorem
Th14: (for D being non empty set holds (for f being (FinSequence of D) holds (f is  almost-one-to-one iff (( f /^ 1 ) is  one-to-one & ( f | ( ( len f ) -' 1 ) ) is  one-to-one))))
proof
let D being non empty set;
let f being (FinSequence of D);
A1: ( len ( f /^ 1 ) ) = ( ( len f ) -' 1 ) by RFINSEQ:29;
thus (f is  almost-one-to-one implies (( f /^ 1 ) is  one-to-one & ( f | ( ( len f ) -' 1 ) ) is  one-to-one))
proof
assume A2: f is  almost-one-to-one;
thus ( f /^ 1 ) is  one-to-one
proof
let x being set,y being set;
assume that
A3: x in ( dom ( f /^ 1 ) )
and
A4: y in ( dom ( f /^ 1 ) )
and
A5: ( ( f /^ 1 ) . x ) = ( ( f /^ 1 ) . y );
reconsider i = x,j = y as (Element of ( NAT )) by A3,A4;
A6: i in ( Seg ( len ( f /^ 1 ) ) ) by A3,FINSEQ_1:def 3;
then A7: 1 <= i by FINSEQ_1:1;
A8: i <= ( len ( f /^ 1 ) ) by A6,FINSEQ_1:1;
then ( ( len f ) -' 1 ) >= 1 by A1,A7,XXREAL_0:2;
then A9: ( ( len f ) -' 1 ) = ( ( len f ) - 1 ) by NAT_D:39;
then A10: ( i + 1 ) <= ( len f ) by A1,A8,XREAL_1:19;
then A11: ( ( f /^ 1 ) . i ) = ( f . ( i + 1 ) ) by A7,FINSEQ_6:114;
A12: j in ( Seg ( len ( f /^ 1 ) ) ) by A4,FINSEQ_1:def 3;
then A13: 1 <= j by FINSEQ_1:1;
j <= ( len ( f /^ 1 ) ) by A12,FINSEQ_1:1;
then A14: ( j + 1 ) <= ( len f ) by A1,A9,XREAL_1:19;
then A15: ( ( f /^ 1 ) . j ) = ( f . ( j + 1 ) ) by A13,FINSEQ_6:114;
A16: ( j + 1 ) > 1 by A13,NAT_1:13;
then A17: ( j + 1 ) in ( dom f ) by A14,FINSEQ_3:25;
A18: ( i + 1 ) > 1 by A7,NAT_1:13;
then ( i + 1 ) in ( dom f ) by A10,FINSEQ_3:25;
then ( i + 1 ) = ( j + 1 ) by A2,A5,A11,A15,A18,A16,A17,CKB5:def 1;
hence thesis;
end;

A19: ( len ( f | ( ( len f ) -' 1 ) ) ) = ( ( len f ) -' 1 ) by FINSEQ_1:59,NAT_D:35;
thus ( f | ( ( len f ) -' 1 ) ) is  one-to-one
proof
let x being set,y being set;
assume that
A20: x in ( dom ( f | ( ( len f ) -' 1 ) ) )
and
A21: y in ( dom ( f | ( ( len f ) -' 1 ) ) )
and
A22: ( ( f | ( ( len f ) -' 1 ) ) . x ) = ( ( f | ( ( len f ) -' 1 ) ) . y );
reconsider i = x,j = y as (Element of ( NAT )) by A20,A21;
A23: i in ( Seg ( len ( f | ( ( len f ) -' 1 ) ) ) ) by A20,FINSEQ_1:def 3;
then A24: 1 <= i by FINSEQ_1:1;
A25: j in ( Seg ( len ( f | ( ( len f ) -' 1 ) ) ) ) by A21,FINSEQ_1:def 3;
then A26: j <= ( len ( f | ( ( len f ) -' 1 ) ) ) by FINSEQ_1:1;
then A27: ( ( f | ( ( len f ) -' 1 ) ) . j ) = ( f . j ) by A19,FINSEQ_3:112;
A28: i <= ( len ( f | ( ( len f ) -' 1 ) ) ) by A23,FINSEQ_1:1;
then A29: ( ( f | ( ( len f ) -' 1 ) ) . i ) = ( f . i ) by A19,FINSEQ_3:112;
( ( len f ) -' 1 ) >= 1 by A19,A24,A28,XXREAL_0:2;
then A30: ( ( len f ) -' 1 ) = ( ( len f ) - 1 ) by NAT_D:39;
then ( j + 1 ) <= ( len f ) by A19,A26,XREAL_1:19;
then A31: j < ( len f ) by NAT_1:13;
1 <= j by A25,FINSEQ_1:1;
then A32: j in ( dom f ) by A31,FINSEQ_3:25;
( i + 1 ) <= ( len f ) by A19,A28,A30,XREAL_1:19;
then A33: i < ( len f ) by NAT_1:13;
then i in ( dom f ) by A24,FINSEQ_3:25;
hence thesis by A2,A22,A29,A27,A33,A31,A32,CKB5:def 1;
end;

end;

assume that
A34: ( f /^ 1 ) is  one-to-one
and
A35: ( f | ( ( len f ) -' 1 ) ) is  one-to-one;
let i being (Element of ( NAT )),j being (Element of ( NAT ));
assume that
A36: i in ( dom f )
and
A37: j in ( dom f )
and
A38: (i <> 1 or j <> ( len f ))
and
A39: (i <> ( len f ) or j <> 1)
and
A40: ( f . i ) = ( f . j );
A41: ( ( 0 ) + 1 ) <= i by A36,FINSEQ_3:25;
then A42: ( i - 1 ) >= ( 0 ) by XREAL_1:19;
A43: i <= ( len f ) by A36,FINSEQ_3:25;
then A44: ( i - 1 ) <= ( ( len f ) - 1 ) by XREAL_1:9;
then ( i -' 1 ) <= ( ( len f ) - 1 ) by A42,XREAL_0:def 2;
then A45: ( i -' 1 ) <= ( ( len f ) -' 1 ) by XREAL_0:def 2;
( len f ) = ( ( ( len f ) -' 1 ) + 1 ) by A41,A43,XREAL_1:235,XXREAL_0:2;
then ( ( len f ) -' 1 ) <= ( len f ) by NAT_1:13;
then A46: ( len ( f | ( ( len f ) -' 1 ) ) ) = ( ( len f ) -' 1 ) by FINSEQ_1:59;
A47: j <= ( len f ) by A37,FINSEQ_3:25;
then ( j - 1 ) <= ( ( len f ) - 1 ) by XREAL_1:9;
then ( j -' 1 ) <= ( ( len f ) - 1 ) by A42,A44,XREAL_0:def 2;
then A48: ( j -' 1 ) <= ( ( len f ) -' 1 ) by XREAL_0:def 2;
f is non empty by A36;
then A49: f = ( <* ( f /. 1 ) *> ^ ( f /^ 1 ) ) by FINSEQ_5:29;
A50: i = ( ( i -' 1 ) + 1 ) by A41,XREAL_1:235;
A51: ( ( 0 ) + 1 ) <= j by A37,FINSEQ_3:25;
then A52: ( j - 1 ) >= ( 0 ) by XREAL_1:19;
A53: j = ( ( j -' 1 ) + 1 ) by A51,XREAL_1:235;
per cases ;
suppose A54: (i <> 1 & j <> 1);

then j > ( ( 0 ) + 1 ) by A51,XXREAL_0:1;
then ( j - 1 ) > ( 0 ) by XREAL_1:20;
then ( j -' 1 ) > ( 0 ) by XREAL_0:def 2;
then ( j -' 1 ) >= ( ( 0 ) + 1 ) by NAT_1:13;
then A55: ( j -' 1 ) in ( dom ( f /^ 1 ) ) by A1,A48,FINSEQ_3:25;
then A56: ( f . j ) = ( ( f /^ 1 ) . ( j -' 1 ) ) by A53,A49,FINSEQ_3:103;
i > ( ( 0 ) + 1 ) by A41,A54,XXREAL_0:1;
then ( i - 1 ) > ( 0 ) by XREAL_1:20;
then ( i -' 1 ) > ( 0 ) by XREAL_0:def 2;
then ( i -' 1 ) >= ( ( 0 ) + 1 ) by NAT_1:13;
then A57: ( i -' 1 ) in ( dom ( f /^ 1 ) ) by A1,A45,FINSEQ_3:25;
then ( f . i ) = ( ( f /^ 1 ) . ( i -' 1 ) ) by A50,A49,FINSEQ_3:103;
then ( i -' 1 ) = ( j -' 1 ) by A34,A40,A57,A55,A56,FUNCT_1:def 4;
then ( i - 1 ) = ( j -' 1 ) by A42,XREAL_0:def 2;
then ( i - 1 ) = ( j - 1 ) by A52,XREAL_0:def 2;
hence thesis;
end;
suppose A58: i = 1;

then j < ( len f ) by A38,A47,XXREAL_0:1;
then ( j + 1 ) <= ( len f ) by NAT_1:13;
then j <= ( ( len f ) - 1 ) by XREAL_1:19;
then A59: j <= ( ( len f ) -' 1 ) by XREAL_0:def 2;
then A60: ( ( f | ( ( len f ) -' 1 ) ) . j ) = ( f . j ) by FINSEQ_3:112;
i <= ( ( len f ) -' 1 ) by A51,A58,A59,XXREAL_0:2;
then A61: i in ( dom ( f | ( ( len f ) -' 1 ) ) ) by A41,A46,FINSEQ_3:25;
A62: j in ( dom ( f | ( ( len f ) -' 1 ) ) ) by A51,A46,A59,FINSEQ_3:25;
( ( f | ( ( len f ) -' 1 ) ) . i ) = ( f . i ) by A51,A58,A59,FINSEQ_3:112,XXREAL_0:2;
hence thesis by A35,A40,A60,A61,A62,FUNCT_1:def 4;
end;
suppose A63: j = 1;

then i < ( len f ) by A39,A43,XXREAL_0:1;
then ( i + 1 ) <= ( len f ) by NAT_1:13;
then i <= ( ( len f ) - 1 ) by XREAL_1:19;
then A64: i <= ( ( len f ) -' 1 ) by XREAL_0:def 2;
then A65: ( ( f | ( ( len f ) -' 1 ) ) . i ) = ( f . i ) by FINSEQ_3:112;
j <= ( ( len f ) -' 1 ) by A41,A63,A64,XXREAL_0:2;
then A66: j in ( dom ( f | ( ( len f ) -' 1 ) ) ) by A51,A46,FINSEQ_3:25;
A67: i in ( dom ( f | ( ( len f ) -' 1 ) ) ) by A41,A46,A64,FINSEQ_3:25;
( ( f | ( ( len f ) -' 1 ) ) . j ) = ( f . j ) by A41,A63,A64,FINSEQ_3:112,XXREAL_0:2;
hence thesis by A35,A40,A65,A67,A66,FUNCT_1:def 4;
end;
end;
