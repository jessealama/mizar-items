environ
vocabularies NUMBERS,FINSEQ_1,FUNCT_1,RELAT_1,XBOOLE_0,TARSKI,ORDINAL4,NAT_1,XXREAL_0,ARYTM_3,PRE_POLY,CARD_1,FUNCOP_1,PARTFUN1,SUBSET_1,ARYTM_1,FUNCT_4,ORDINAL1,PBOOLE,FINSET_1,ORDERS_1,VECTSP_1,ZFMISC_1,ALGSTR_0,POLYNOM2,GROUP_1,POLYNOM1,SUPINF_2,RLVECT_1,ALGSEQ_1,LATTICES,POLYNOM3,STRUCT_0,CARD_3,CARD_FIL,QUOFIELD,MSSUBFAM,IDEAL_1,PRELAMB,MCART_1,BINOP_1,FUNCT_2,HILBASIS;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,PBOOLE,RELAT_1,FINSET_1,FUNCT_1,PARTFUN1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,RELSET_1,FUNCT_2,FUNCOP_1,FINSEQ_1,FUNCT_4,BINOP_1,XXREAL_2,MCART_1,FINSEQOP,FINSEQ_2,FUNCT_7,PRE_POLY,DOMAIN_1,STRUCT_0,ALGSTR_0,RLVECT_1,VFUNCT_1,BHSP_1,GROUP_1,VECTSP_1,NORMSP_1,POLYNOM1,POLYNOM2,POLYNOM3,ALGSEQ_1,NAT_D,IDEAL_1,TOPS_2,GRCAT_1,ORDINAL1,WSIERP_1,ORDERS_1,GROUP_6,QUOFIELD,RECDEF_1,MATRLIN,CKB6,CKB9,CKB14,CKB21,CKB23,CKB36;
definitions TARSKI,IDEAL_1,GRCAT_1,GROUP_6,FUNCOP_1,POLYNOM3,CARD_1,STRUCT_0,CKB6,CKB9,CKB14,CKB21,CKB23,CKB36;
theorems TARSKI,ZFMISC_1,RLVECT_1,FUNCT_1,FUNCT_2,POLYNOM1,NAT_1,AXIOMS,FVSUM_1,FINSEQ_1,FINSEQ_2,FINSEQ_3,POLYNOM3,FUNCOP_1,ALGSEQ_1,INT_1,FUNCT_7,IDEAL_1,POLYNOM4,GRCAT_1,QUOFIELD,FUNCT_4,RELAT_1,CARD_1,MATRLIN,CARD_3,ORDINAL1,WAYBEL_1,ORDERS_1,FINSET_1,FINSEQOP,POLYNOM2,TOPS_2,FINSEQ_5,GROUP_1,XBOOLE_0,XBOOLE_1,RLVECT_2,VECTSP_1,XREAL_1,GROUP_6,XXREAL_0,NORMSP_1,PARTFUN1,XXREAL_2,NAT_D,XREAL_0,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36;
schemes NAT_1,RECDEF_1,FUNCT_1,FUNCT_2,FINSEQ_2,FUNCT_7;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,FUNCOP_1,FINSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,CARD_1,MEMBERED,FINSEQ_1,CARD_5,PRE_CIRC,STRUCT_0,VECTSP_1,ALGSTR_1,GR_CY_1,WAYBEL_2,GCD_1,PRE_POLY,POLYNOM1,POLYNOM2,POLYNOM3,IDEAL_1,VALUED_0,ALGSTR_0,XXREAL_2,VFUNCT_1,FUNCT_2,RELSET_1,CKB17,CKB37,CKB38,CKB39,CKB40;
constructors FINSEQOP,RFUNCT_3,NAT_D,REAL_1,WSIERP_1,TOPS_2,ALGSEQ_1,BHSP_1,GRCAT_1,GROUP_6,MATRIX_2,DTCONSTR,TRIANG_1,QUOFIELD,POLYNOM2,POLYNOM3,IDEAL_1,SEQ_1,RECDEF_1,SEQ_4,XXREAL_2,DOMAIN_1,BINARITH,RELSET_1,FUNCT_7,PRE_POLY,MATRLIN,VFUNCT_1,CKB6,CKB9,CKB14,CKB21,CKB23,CKB36;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
definition
let R being  Abelian  add-associative  right_zeroed  right_complementable  associative  distributive  well-unital  commutative non trivial doubleLoopStr;
let n being (Element of ( NAT ));
func mpu (n,R) -> (Function of ( Polynom-Ring (( n + 1 ),R) ),( Polynom-Ring ( Polynom-Ring (n,R) ) ))
means
:Def7: (for p1 being (Polynomial of ( n + 1 ),R) holds (for p2 being (Polynomial of n,R) holds (for p3 being (Polynomial of ( Polynom-Ring (n,R) )) holds (for i being (Element of ( NAT )) holds (for b being (bag of n) holds ((p3 = ( it . p1 ) & p2 = ( p3 . i )) implies ( p2 . b ) = ( p1 . ( b bag_extend i ) )))))));
existence
proof
set CR = (the carrier of R);
set PNR = ( Polynom-Ring (n,R) );
set PN1R = ( Polynom-Ring (( n + 1 ),R) );
set PRPNR = ( Polynom-Ring ( Polynom-Ring (n,R) ) );
set CPRPNR = (the carrier of PRPNR);
set CPN1R = (the carrier of PN1R);
set CPNR = (the carrier of PNR);
defpred P1[ (Element of CPN1R),(Element of CPRPNR) ]
 means
(for p1 being (Polynomial of ( n + 1 ),R) holds (for p2 being (Polynomial of n,R) holds (for p3 being (Polynomial of ( Polynom-Ring (n,R) )) holds (for i being (Element of ( NAT )) holds (for b being (bag of n) holds (((p1 = $1 & p3 = $2) & p2 = ( p3 . i )) implies ( p2 . b ) = ( p1 . ( b bag_extend i ) )))))));
A1:now
let x being (Element of CPN1R);
reconsider p1 = x as (Polynomial of ( n + 1 ),R) by POLYNOM1:def 10;
defpred P2[ (Element of ( NAT )),(Element of CPNR) ]
 means
(for p2 being (Polynomial of n,R) holds (for b being (bag of n) holds (p2 = $2 implies ( p2 . b ) = ( p1 . ( b bag_extend $1 ) ))));
A2:now
let i being (Element of ( NAT ));
deffunc F((Element of ( Bags n ))) = ( p1 . ( $1 bag_extend i ) );
consider p2 being (Function of ( Bags n ),CR) such that A3: (for b being (Element of ( Bags n )) holds ( p2 . b ) = F(b)) from FUNCT_2:sch 4;
reconsider p2 as (Function of ( Bags n ),R);
reconsider p2 as (Series of n,R);
now
per cases ;
suppose A4: ( Support p1 ) = ( {} );

now
assume ( Support p2 ) <> ( {} );
then consider b being set such that A5: b in ( Support p2 ) by XBOOLE_0:def 1;
reconsider b as (Element of ( Bags n )) by A5;
( p2 . b ) <> ( 0. R ) by A5,POLYNOM1:def 3;
then ( p1 . ( b bag_extend i ) ) <> ( 0. R ) by A3;
hence ( Support p1 ) <> ( {} ) by POLYNOM1:def 3;
end;
hence ( Support p2 ) is  finite by A4;
end;
suppose ( Support p2 ) = ( {} );

hence ( Support p2 ) is  finite;
end;
suppose A6: (( Support p1 ) <> ( {} ) & ( Support p2 ) <> ( {} ));

then reconsider Supportp2 = ( Support p2 ) as non empty (Subset of ( Bags n ));
reconsider Supportp1 = ( Support p1 ) as non empty (Subset of ( Bags ( n + 1 ) )) by A6;
defpred P[ (Element of Supportp2),set ]
 means
$2 = ( $1 bag_extend i );
A7:now
let x being (Element of Supportp2);
(x is (Element of ( Bags n )) & ( p2 . x ) <> ( 0. R )) by POLYNOM1:def 3;
then ( p1 . ( x bag_extend i ) ) <> ( 0. R ) by A3;
then ( x bag_extend i ) in ( Support p1 ) by POLYNOM1:def 3;
hence (ex y being (Element of Supportp1) st P[ x,y ]);
end;
consider f being (Function of Supportp2,Supportp1) such that A8: (for x being (Element of Supportp2) holds P[ x,( f . x ) ]) from FUNCT_2:sch 3(A7);
A9: ( dom f ) = Supportp2 by FUNCT_2:def 1;
now
let x1 being set,x2 being set;
assume that
A10: x1 in ( dom f )
and
A11: x2 in ( dom f )
and
A12: ( f . x1 ) = ( f . x2 );
reconsider x19 = x1,x29 = x2 as (Element of ( Bags n )) by A9,A10,A11;
A13: ( x19 bag_extend i ) = ( f . x1 ) by A8,A10
.= ( x29 bag_extend i ) by A8,A11,A12;
x19 = ( ( x19 bag_extend i ) | n ) by CKB6:def 1
.= x29 by A13,CKB6:def 1;
hence x1 = x2;
end;
then A14: f is  one-to-one by FUNCT_1:def 4;
( rng f ) c= Supportp1;
then ( card Supportp2 ) c= ( card Supportp1 ) by A9,A14,CARD_1:10;
hence ( Support p2 ) is  finite;
end;
end;
then p2 is  finite-Support by POLYNOM1:def 4;
then reconsider p29 = p2 as (Element of CPNR) by POLYNOM1:def 10;
take p29;
now
let p299 being (Polynomial of n,R);
let b being (bag of n);
A15: b is (Element of ( Bags n )) by PRE_POLY:def 12;
assume p299 = p29;
hence ( p299 . b ) = ( p1 . ( b bag_extend i ) ) by A3,A15;
end;
hence P2[ i,p29 ];
end;
consider p3 being (Function of ( NAT ),CPNR) such that A16: (for x being (Element of ( NAT )) holds P2[ x,( p3 . x ) ]) from FUNCT_2:sch 3(A2);
reconsider p3 as (sequence of PNR);
now
per cases ;
suppose A17: ( Support p1 ) = ( {} );

now
let i being Nat;
assume i >= ( 0 );
reconsider i1 = i as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider p2 = ( p3 . i1 ) as (Polynomial of n,R) by POLYNOM1:def 10;
A18:now
let x being set;
assume x in ( Bags n );
then reconsider x9 = x as (Element of ( Bags n ));
( p1 . ( x9 bag_extend i ) ) = ( 0. R ) by A17,POLYNOM1:def 3;
then ( p2 . x9 ) = ( 0. R ) by A16;
hence ( p2 . x ) = ( ( ( Bags n ) --> ( 0. R ) ) . x ) by FUNCOP_1:7;
end;
(( dom ( ( Bags n ) --> ( 0. R ) ) ) = ( Bags n ) & ( dom p2 ) = ( Bags n )) by FUNCT_2:def 1;
then p2 = ( ( Bags n ) --> ( 0. R ) ) by A18,FUNCT_1:2;
hence ( p3 . i ) = ( 0_ (n,R) ) by POLYNOM1:def 7
.= ( 0. PNR ) by POLYNOM1:def 10;
end;
hence p3 is  finite-Support by ALGSEQ_1:def 1;
end;
suppose ( Support p1 ) <> ( {} );

then reconsider Supportp1 = ( Support p1 ) as  finite non empty (Subset of ( Bags ( n + 1 ) ));
deffunc F((Element of ( Bags ( n + 1 ) ))) = ( $1 . n );
consider f being (Function of ( Bags ( n + 1 ) ),( NAT )) such that A19: (for x being (Element of ( Bags ( n + 1 ) )) holds ( f . x ) = F(x)) from FUNCT_2:sch 4;
reconsider j = ( max ( f .: Supportp1 ) ) as (Element of ( NAT )) by ORDINAL1:def 12;
now
let i being Nat;
reconsider i1 = i as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider p2 = ( p3 . i1 ) as (Polynomial of n,R) by POLYNOM1:def 10;
assume A20: i >= ( j + 1 );
A21:now
let x being set;
assume x in ( Bags n );
then reconsider x9 = x as (Element of ( Bags n ));
i > j by A20,NAT_1:13;
then A22: (not i in ( f .: Supportp1 )) by XXREAL_2:def 8;
( f . ( x9 bag_extend i ) ) = ( ( x9 bag_extend i ) . n ) by A19
.= i by CKB6:def 1;
then (not ( x9 bag_extend i ) in Supportp1) by A22,FUNCT_2:35;
then ( p1 . ( x9 bag_extend i ) ) = ( 0. R ) by POLYNOM1:def 3;
then ( p2 . x9 ) = ( 0. R ) by A16;
hence ( p2 . x ) = ( ( ( Bags n ) --> ( 0. R ) ) . x ) by FUNCOP_1:7;
end;
(( dom ( ( Bags n ) --> ( 0. R ) ) ) = ( Bags n ) & ( dom p2 ) = ( Bags n )) by FUNCT_2:def 1;
then p2 = ( ( Bags n ) --> ( 0. R ) ) by A21,FUNCT_1:2;
hence ( p3 . i ) = ( 0_ (n,R) ) by POLYNOM1:def 7
.= ( 0. PNR ) by POLYNOM1:def 10;
end;
hence p3 is  finite-Support by ALGSEQ_1:def 1;
end;
end;
then reconsider y = p3 as (Element of CPRPNR) by POLYNOM3:def 10;
take y;
thus P1[ x,y ] by A16;
end;
consider P being (Function of CPN1R,CPRPNR) such that A23: (for x being (Element of CPN1R) holds P1[ x,( P . x ) ]) from FUNCT_2:sch 3(A1);
reconsider P as (Function of PN1R,PRPNR);
take P;
now
let p1 being (Polynomial of ( n + 1 ),R);
let p2 being (Polynomial of n,R);
let p3 being (Polynomial of ( Polynom-Ring (n,R) ));
let i being (Element of ( NAT ));
let b being (bag of n);
A24: p1 in CPN1R by POLYNOM1:def 10;
assume (p3 = ( P . p1 ) & p2 = ( p3 . i ));
hence ( p2 . b ) = ( p1 . ( b bag_extend i ) ) by A23,A24;
end;
hence thesis;
end;
uniqueness
proof
set PNR = ( Polynom-Ring (n,R) );
set PN1R = ( Polynom-Ring (( n + 1 ),R) );
set PRPNR = ( Polynom-Ring ( Polynom-Ring (n,R) ) );
set CPN1R = (the carrier of PN1R);
let A being (Function of PN1R,PRPNR),B being (Function of PN1R,PRPNR);
assume A25: (for p1 being (Polynomial of ( n + 1 ),R) holds (for p2 being (Polynomial of n,R) holds (for p3 being (Polynomial of ( Polynom-Ring (n,R) )) holds (for i being (Element of ( NAT )) holds (for b being (bag of n) holds ((p3 = ( A . p1 ) & p2 = ( p3 . i )) implies ( p2 . b ) = ( p1 . ( b bag_extend i ) )))))));
assume A26: (for p1 being (Polynomial of ( n + 1 ),R) holds (for p2 being (Polynomial of n,R) holds (for p3 being (Polynomial of ( Polynom-Ring (n,R) )) holds (for i being (Element of ( NAT )) holds (for b being (bag of n) holds ((p3 = ( B . p1 ) & p2 = ( p3 . i )) implies ( p2 . b ) = ( p1 . ( b bag_extend i ) )))))));
now
let x being set;
assume A27: x in CPN1R;
then reconsider x99 = x as (Element of CPN1R);
reconsider x9 = x as (Polynomial of ( n + 1 ),R) by A27,POLYNOM1:def 10;
reconsider Ax = ( A . x99 ),Bx = ( B . x99 ) as (Polynomial of PNR) by POLYNOM3:def 10;
now
let i being set;
assume i in ( NAT );
then reconsider i9 = i as (Element of ( NAT ));
reconsider Axi = ( Ax . i9 ),Bxi = ( Bx . i9 ) as (Polynomial of n,R) by POLYNOM1:def 10;
now
let b being set;
assume b in ( Bags n );
then reconsider b9 = b as (bag of n);
thus ( Axi . b ) = ( x9 . ( b9 bag_extend i9 ) ) by A25
.= ( Bxi . b ) by A26;
end;
hence ( Ax . i ) = ( Bx . i ) by FUNCT_2:12;
end;
hence ( A . x ) = ( B . x ) by FUNCT_2:12;
end;
hence A = B by FUNCT_2:12;
end;
end;
