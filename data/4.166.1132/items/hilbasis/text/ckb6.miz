environ
vocabularies NUMBERS,FINSEQ_1,FUNCT_1,RELAT_1,XBOOLE_0,TARSKI,ORDINAL4,NAT_1,XXREAL_0,ARYTM_3,PRE_POLY,CARD_1,FUNCOP_1,PARTFUN1,SUBSET_1,ARYTM_1,FUNCT_4,ORDINAL1,PBOOLE,FINSET_1,ORDERS_1,VECTSP_1,ZFMISC_1,ALGSTR_0,POLYNOM2,GROUP_1,POLYNOM1,SUPINF_2,RLVECT_1,ALGSEQ_1,LATTICES,POLYNOM3,STRUCT_0,CARD_3,CARD_FIL,QUOFIELD,MSSUBFAM,IDEAL_1,PRELAMB,MCART_1,BINOP_1,FUNCT_2,HILBASIS;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,PBOOLE,RELAT_1,FINSET_1,FUNCT_1,PARTFUN1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,RELSET_1,FUNCT_2,FUNCOP_1,FINSEQ_1,FUNCT_4,BINOP_1,XXREAL_2,MCART_1,FINSEQOP,FINSEQ_2,FUNCT_7,PRE_POLY,DOMAIN_1,STRUCT_0,ALGSTR_0,RLVECT_1,VFUNCT_1,BHSP_1,GROUP_1,VECTSP_1,NORMSP_1,POLYNOM1,POLYNOM2,POLYNOM3,ALGSEQ_1,NAT_D,IDEAL_1,TOPS_2,GRCAT_1,ORDINAL1,WSIERP_1,ORDERS_1,GROUP_6,QUOFIELD,RECDEF_1,MATRLIN;
definitions TARSKI,IDEAL_1,GRCAT_1,GROUP_6,FUNCOP_1,POLYNOM3,CARD_1,STRUCT_0;
theorems TARSKI,ZFMISC_1,RLVECT_1,FUNCT_1,FUNCT_2,POLYNOM1,NAT_1,AXIOMS,FVSUM_1,FINSEQ_1,FINSEQ_2,FINSEQ_3,POLYNOM3,FUNCOP_1,ALGSEQ_1,INT_1,FUNCT_7,IDEAL_1,POLYNOM4,GRCAT_1,QUOFIELD,FUNCT_4,RELAT_1,CARD_1,MATRLIN,CARD_3,ORDINAL1,WAYBEL_1,ORDERS_1,FINSET_1,FINSEQOP,POLYNOM2,TOPS_2,FINSEQ_5,GROUP_1,XBOOLE_0,XBOOLE_1,RLVECT_2,VECTSP_1,XREAL_1,GROUP_6,XXREAL_0,NORMSP_1,PARTFUN1,XXREAL_2,NAT_D,XREAL_0,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5;
schemes NAT_1,RECDEF_1,FUNCT_1,FUNCT_2,FINSEQ_2,FUNCT_7;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,FUNCOP_1,FINSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,CARD_1,MEMBERED,FINSEQ_1,CARD_5,PRE_CIRC,STRUCT_0,VECTSP_1,ALGSTR_1,GR_CY_1,WAYBEL_2,GCD_1,PRE_POLY,POLYNOM1,POLYNOM2,POLYNOM3,IDEAL_1,VALUED_0,ALGSTR_0,XXREAL_2,VFUNCT_1,FUNCT_2,RELSET_1;
constructors FINSEQOP,RFUNCT_3,NAT_D,REAL_1,WSIERP_1,TOPS_2,ALGSEQ_1,BHSP_1,GRCAT_1,GROUP_6,MATRIX_2,DTCONSTR,TRIANG_1,QUOFIELD,POLYNOM2,POLYNOM3,IDEAL_1,SEQ_1,RECDEF_1,SEQ_4,XXREAL_2,DOMAIN_1,BINARITH,RELSET_1,FUNCT_7,PRE_POLY,MATRLIN,VFUNCT_1;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
definition
let n being Nat;
let k being Nat;
let b being (bag of n);
func b bag_extend k -> (Element of ( Bags ( n + 1 ) ))
means
:Def1: (( it | n ) = b & ( it . n ) = k);
existence
proof
set b1 = ( b +* ( n .--> k ) );
A1: ( dom b ) = n by PARTFUN1:def 2;
A2: ( dom b1 ) = ( ( dom b ) \/ ( dom ( n .--> k ) ) ) by FUNCT_4:def 1
.= ( ( dom b ) \/ { n } ) by FUNCOP_1:13
.= ( n \/ { n } ) by PARTFUN1:def 2
.= ( succ n ) by ORDINAL1:def 1
.= ( n + 1 ) by NAT_1:38;
then b1 is (ManySortedSet of ( n + 1 )) by PARTFUN1:def 2,RELAT_1:def 18;
then reconsider b1 as (Element of ( Bags ( n + 1 ) )) by PRE_POLY:def 12;
take b1;
A3: ( dom ( b1 | n ) ) = ( ( n + 1 ) /\ n ) by A2,RELAT_1:61
.= ( ( succ n ) /\ n ) by NAT_1:38
.= ( ( n \/ { n } ) /\ n ) by ORDINAL1:def 1
.= n by XBOOLE_1:21;
now
let x being set;
assume A4: x in n;
then A5: x in ( ( dom b ) \/ ( dom ( n .--> k ) ) ) by A1,XBOOLE_0:def 3;
A6:now
assume x in ( dom ( n .--> k ) );
then x in { n } by FUNCOP_1:13;
then x = n by TARSKI:def 1;
hence contradiction by A4;
end;
thus ( ( b1 | n ) . x ) = ( b1 . x ) by A3,A4,FUNCT_1:47
.= ( b . x ) by A5,A6,FUNCT_4:def 1;
end;
hence ( b1 | n ) = b by A3,A1,FUNCT_1:2;
n in { n } by TARSKI:def 1;
then A7: n in ( dom ( n .--> k ) ) by FUNCOP_1:13;
then n in ( ( dom b ) \/ ( dom ( n .--> k ) ) ) by XBOOLE_0:def 3;
hence ( b1 . n ) = ( ( n .--> k ) . n ) by A7,FUNCT_4:def 1
.= k by FUNCOP_1:72;
end;
uniqueness
proof
let b1 being (Element of ( Bags ( n + 1 ) )),b2 being (Element of ( Bags ( n + 1 ) ));
assume that
A8: ( b1 | n ) = b
and
A9: ( b1 . n ) = k
and
A10: ( b2 | n ) = b
and
A11: ( b2 . n ) = k;
A12: ( dom b1 ) = ( n + 1 ) by PARTFUN1:def 2;
A13:now
let x being set;
assume A14: x in ( n + 1 );
then x in ( succ n ) by NAT_1:38;
then A15: x in ( n \/ { n } ) by ORDINAL1:def 1;
per cases ;
suppose x in { n };

then x = n by TARSKI:def 1;
hence ( b1 . x ) = ( b2 . x ) by A9,A11;
end;
suppose (not x in { n });

then x in n by A15,XBOOLE_0:def 3;
then x in ( ( n + 1 ) /\ n ) by A14,XBOOLE_0:def 4;
then A16: x in ( dom b ) by A8,A12,RELAT_1:61;
hence ( b1 . x ) = ( b . x ) by A8,FUNCT_1:47
.= ( b2 . x ) by A10,A16,FUNCT_1:47;
end;
end;
( dom b2 ) = ( n + 1 ) by PARTFUN1:def 2;
hence thesis by A12,A13,FUNCT_1:2;
end;
end;
