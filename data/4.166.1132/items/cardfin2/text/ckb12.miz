environ
vocabularies FUNCT_1,INT_1,ARYTM_1,ARYTM_3,CARD_1,FUNCT_2,NAT_1,CARD_3,FINSET_1,ORDINAL2,RPR_1,CARDFIN2,ABIAN,POWER,COMPLEX1,AFINSQ_1,RELAT_1,XCMPLX_0,SIN_COS,SERIES_1,TAYLOR_1,SUBSET_1,FDIFF_1,FINSEQ_1,TARSKI,REAL_1,FINSOP_1,NEWTON,ORDINAL1,REALSET1,XXREAL_0,XBOOLE_0,XXREAL_1,VALUED_1,NUMBERS,BINOP_2,XREAL_0;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,RELSET_1,PARTFUN1,FUNCT_2,BINOP_1,FINSET_1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,REAL_1,NAT_1,NAT_D,INT_1,COMPLEX1,BINOP_2,VALUED_1,NEWTON,RCOMP_1,FCONT_1,POWER,SERIES_1,SEQFUNC,SIN_COS,AFINSQ_1,ABIAN,TAYLOR_1,STIRL2_1,CARD_FIN,RPR_1,AFINSQ_2,CKB5,CKB10;
definitions XBOOLE_0,TARSKI,XCMPLX_0,SUBSET_1,SIN_COS,RELAT_1,CKB5,CKB10;
theorems CARD_2,CARD_FIN,FUNCT_2,XBOOLE_0,NEWTON,XREAL_0,XCMPLX_1,RPR_1,XREAL_1,XCMPLX_0,INT_1,ORDINAL1,CARD_1,TAYLOR_1,SIN_COS,TAYLOR_2,XXREAL_1,ABIAN,STIRL2_1,SERIES_1,SEQ_1,SIN_COS2,NAT_1,TARSKI,BINOP_2,IRRAT_1,SEQ_2,FIB_NUM2,SIN_COS7,XXREAL_0,ALTCAT_1,RELAT_1,VALUED_1,VALUED_0,FUNCT_1,AFINSQ_2,XBOOLE_1,POWER,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10;
schemes RECDEF_2,FIB_NUM,NAT_1;
registrations RELSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,CARD_1,FINSET_1,NUMBERS,SIN_COS,RCOMP_1,VALUED_0,VALUED_1,FUNCT_2,FCONT_3,FCONT_1,AFINSQ_1,POWER,FUNCT_1,BINOP_2,WSIERP_1,XCMPLX_0,XBOOLE_0,RELAT_1,FRAENKEL,AFINSQ_2,ORDINAL1,NEWTON,CKB1,CKB2,CKB11;
constructors REAL_1,SERIES_1,ABIAN,VALUED_1,CARD_FIN,RCOMP_1,SIN_COS,TAYLOR_1,SEQ_1,FCONT_1,SEQFUNC,RELSET_1,STIRL2_1,SETWISEO,YELLOW20,WELLORD2,NAT_D,BINARITH,RPR_1,AFINSQ_2,AFINSQ_1,NEWTON,CKB5,CKB10;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
theorem
Th7: (for s being  finite set holds ( derangements s ) = { h where h is (Function of s,s): (h is  one-to-one & (for x holds (x in s implies ( h . x ) <> x))) })
proof
let s being  finite set;
set xx = { h where h is (Function of s,s): (h is  one-to-one & (for x holds (x in s implies ( h . x ) <> x))) };
hereby
let x;
assume x in ( derangements s );
then consider f being (Permutation of s) such that A1: (x = f & f has_no_fixpoint );
now
let y being set;
(not y is_a_fixpoint_of f) by A1,ABIAN:def 5;
hence (y in s implies ( f . y ) <> y) by ABIAN:def 4;
end;
hence x in xx by A1;
end;
let x;
assume x in xx;
then consider h being (Function of s,s) such that A2: ((x = h & h is  one-to-one) & (for x holds (x in s implies ( h . x ) <> x)));
( card s ) = ( card s );
then A3: h is  onto by A2,STIRL2_1:60;
now
let y;
assume y is_a_fixpoint_of h;
then (y in ( dom h ) & ( h . y ) = y) by ABIAN:def 3;
hence contradiction by A2;
end;
then h has_no_fixpoint  by ABIAN:def 5;
hence x in ( derangements s ) by A3,A2;
end;
