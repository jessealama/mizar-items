environ
vocabularies NUMBERS,FDIFF_1,SEQ_1,FUNCT_1,PARTFUN1,REAL_1,SUBSET_1,XXREAL_0,CARD_1,XXREAL_1,ARYTM_1,TARSKI,RELAT_1,ARYTM_3,FUNCOP_1,VALUED_0,SEQ_2,ORDINAL2,VALUED_1,FUNCT_2,NAT_1,LIMFUNC1,XBOOLE_0,XREAL_0,ORDINAL1,COMPLEX1,SQUARE_1,ORDINAL4,RCOMP_1,FDIFF_3;
notations TARSKI,ORDINAL1,SUBSET_1,NUMBERS,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,VALUED_0,VALUED_1,SEQ_1,SEQ_2,SQUARE_1,RFUNCT_1,RCOMP_1,FDIFF_1,LIMFUNC1,RECDEF_1,CKB5,CKB6,CKB7,CKB8;
definitions TARSKI,XBOOLE_0,SQUARE_1,PROB_1,LIMFUNC1,VALUED_1,CKB5,CKB6,CKB7,CKB8;
theorems NAT_1,SEQ_1,SEQ_2,SEQM_3,SEQ_4,ABSVALUE,RFUNCT_1,RFUNCT_2,RCOMP_1,FDIFF_1,LIMFUNC2,FDIFF_2,TARSKI,SCHEME1,ZFMISC_1,FCONT_3,FUNCT_1,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_0,XCMPLX_1,FUNCOP_1,XREAL_1,COMPLEX1,XXREAL_0,VALUED_1,XXREAL_1,XXREAL_2,VALUED_0,ORDINAL1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10;
schemes SEQ_1,SCHEME1,FUNCT_2,FDIFF_2;
registrations ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FDIFF_1,VALUED_0,VALUED_1,FUNCT_2,XXREAL_2,FUNCOP_1,SEQ_4,SETFAM_1,REALSET1,FINSET_1;
constructors FUNCOP_1,REAL_1,SQUARE_1,NAT_1,COMPLEX1,SEQ_2,SEQM_3,PROB_1,RCOMP_1,RFUNCT_1,RFUNCT_2,LIMFUNC1,PARTFUN1,FDIFF_1,SEQ_1,VALUED_1,RECDEF_1,XXREAL_2,SETFAM_1,RELSET_1,BINOP_2,RVSUM_1,CKB5,CKB6,CKB7,CKB8;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve f for (PartFunc of ( REAL ),( REAL ));
reserve x0 for Real;
reserve r for Real;
reserve r1 for Real;
reserve g for Real;
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve a for Real_Sequence;
reserve d for Real_Sequence;
reserve x for set;
theorem
Th7: (f is_right_differentiable_in x0 implies f is_Rcontinuous_in x0)
proof
assume A1: f is_right_differentiable_in x0;
then consider r such that A2: r > ( 0 ) and A3: [. x0,( x0 + r ) .] c= ( dom f ) by CKB7:def 1;
A4: (for a holds (((( rng a ) c= ( ( right_open_halfline x0 ) /\ ( dom f ) ) & a is  convergent) & ( lim a ) = x0) implies (( f /* a ) is  convergent & ( f . x0 ) = ( lim ( f /* a ) ))))
proof
reconsider b = ( ( NAT ) --> x0 ) as Real_Sequence;
let a;
assume that
A5: ( rng a ) c= ( ( right_open_halfline x0 ) /\ ( dom f ) )
and
A6: a is  convergent
and
A7: ( lim a ) = x0;
consider r such that A8: r > ( 0 ) and A9: [. x0,( x0 + r ) .] c= ( dom f ) by A1,CKB7:def 1;
( x0 + ( 0 ) ) < ( x0 + r ) by A8,XREAL_1:6;
then consider n0 being (Element of ( NAT )) such that A10: (for k holds (k >= n0 implies ( a . k ) < ( x0 + r ))) by A6,A7,LIMFUNC2:2;
deffunc F((Element of ( NAT ))) = ( ( a . $1 ) - ( b . $1 ) );
consider d such that A11: (for n holds ( d . n ) = F(n)) from SEQ_1:sch 1;
A12: d = ( a - b ) by A11,RFUNCT_2:1;
then A13: d is  convergent by A6,SEQ_2:11;
reconsider c = ( b ^\ n0 ) as  constant Real_Sequence;
A14: ( rng c ) = { x0 }
proof
thus ( rng c ) c= { x0 }
proof
let x;
assume x in ( rng c );
then consider n such that A15: x = ( ( b ^\ n0 ) . n ) by FUNCT_2:113;
x = ( b . ( n + n0 ) ) by A15,NAT_1:def 3;
then x = x0 by FUNCOP_1:7;
hence thesis by TARSKI:def 1;
end;

let x;
assume x in { x0 };
then A16: x = x0 by TARSKI:def 1;
( c . ( 0 ) ) = ( b . ( ( 0 ) + n0 ) ) by NAT_1:def 3
.= x by A16,FUNCOP_1:7;
hence thesis by VALUED_0:28;
end;
A17:now
let g being  real number;
assume that
A18: ( 0 ) < g;
take n = ( 0 );
let m;
assume that
n <= m;
( x0 + ( 0 ) ) <= ( x0 + r ) by A8,XREAL_1:7;
then x0 in [. x0,( x0 + r ) .] by XXREAL_1:1;
then ( rng c ) c= ( dom f ) by A9,A14,ZFMISC_1:31;
then ( abs ( ( ( f /* c ) . m ) - ( f . x0 ) ) ) = ( abs ( ( f . ( c . m ) ) - ( f . x0 ) ) ) by FUNCT_2:108
.= ( abs ( ( f . ( b . ( m + n0 ) ) ) - ( f . x0 ) ) ) by NAT_1:def 3
.= ( abs ( ( f . x0 ) - ( f . x0 ) ) ) by FUNCOP_1:7
.= ( 0 ) by ABSVALUE:2;
hence ( abs ( ( ( f /* c ) . m ) - ( f . x0 ) ) ) < g by A18;
end;
then A19: ( f /* c ) is  convergent by SEQ_2:def 6;
( lim b ) = ( b . ( 0 ) ) by SEQ_4:26
.= x0 by FUNCOP_1:7;
then ( lim d ) = ( x0 - x0 ) by A6,A7,A12,SEQ_2:12
.= ( 0 );
then A20: ( lim ( d ^\ n0 ) ) = ( 0 ) by A13,SEQ_4:20;
A21: (for n holds (( d . n ) > ( 0 ) & ( d . n ) <> ( 0 )))
proof
let n;
A22: ( d . n ) = ( ( a . n ) - ( b . n ) ) by A11;
( a . n ) in ( rng a ) by VALUED_0:28;
then ( a . n ) in ( right_open_halfline x0 ) by A5,XBOOLE_0:def 4;
then ( a . n ) in { r1: x0 < r1 } by XXREAL_1:230;
then A23: (ex r1 st (r1 = ( a . n ) & x0 < r1));
then ( ( a . n ) - x0 ) > ( x0 - x0 ) by XREAL_1:9;
hence ( d . n ) > ( 0 ) by A22,FUNCOP_1:7;
thus thesis by A22,A23,FUNCOP_1:7;
end;
A24: (for n holds ( ( d ^\ n0 ) . n ) > ( 0 ))
proof
let n;
( ( d ^\ n0 ) . n ) = ( d . ( n + n0 ) ) by NAT_1:def 3;
hence thesis by A21;
end;
then (for n holds ( ( d ^\ n0 ) . n ) <> ( 0 ));
then ( d ^\ n0 ) is  non-zero by SEQ_1:5;
then reconsider h = ( d ^\ n0 ) as  convergent_to_0 Real_Sequence by A13,A20,FDIFF_1:def 1;
A25: ( rng a ) c= ( dom f )
proof
let x;
assume x in ( rng a );
hence thesis by A5,XBOOLE_0:def 4;
end;
now
let n;
thus ( ( ( ( f /* ( h + c ) ) - ( f /* c ) ) + ( f /* c ) ) . n ) = ( ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) + ( ( f /* c ) . n ) ) by SEQ_1:7
.= ( ( ( ( f /* ( h + c ) ) . n ) - ( ( f /* c ) . n ) ) + ( ( f /* c ) . n ) ) by RFUNCT_2:1
.= ( ( f /* ( h + c ) ) . n );
end;
then A26: ( ( ( f /* ( h + c ) ) - ( f /* c ) ) + ( f /* c ) ) = ( f /* ( h + c ) ) by FUNCT_2:63;
now
let n;
thus ( ( h + c ) . n ) = ( ( ( ( a - b ) + b ) ^\ n0 ) . n ) by A12,SEQM_3:15
.= ( ( ( a - b ) + b ) . ( n + n0 ) ) by NAT_1:def 3
.= ( ( ( a - b ) . ( n + n0 ) ) + ( b . ( n + n0 ) ) ) by SEQ_1:7
.= ( ( ( a . ( n + n0 ) ) - ( b . ( n + n0 ) ) ) + ( b . ( n + n0 ) ) ) by RFUNCT_2:1
.= ( ( a ^\ n0 ) . n ) by NAT_1:def 3;
end;
then A27: ( ( ( f /* ( h + c ) ) - ( f /* c ) ) + ( f /* c ) ) = ( f /* ( a ^\ n0 ) ) by A26,FUNCT_2:63
.= ( ( f /* a ) ^\ n0 ) by A25,VALUED_0:27;
A28: (for n holds ( ( a ^\ n0 ) . n ) in [. x0,( x0 + r ) .])
proof
let n;
( a . ( n + n0 ) ) in ( rng a ) by VALUED_0:28;
then ( ( a ^\ n0 ) . n ) in ( rng a ) by NAT_1:def 3;
then ( ( a ^\ n0 ) . n ) in ( right_open_halfline x0 ) by A5,XBOOLE_0:def 4;
then ( ( a ^\ n0 ) . n ) in { g: x0 < g } by XXREAL_1:230;
then A29: (ex g st (g = ( ( a ^\ n0 ) . n ) & x0 < g));
(( 0 ) <= n & ( ( 0 ) + n0 ) = n0) by NAT_1:2;
then n0 <= ( n0 + n ) by XREAL_1:6;
then ( a . ( n + n0 ) ) <= ( x0 + r ) by A10;
then ( ( a ^\ n0 ) . n ) <= ( x0 + r ) by NAT_1:def 3;
then ( ( a ^\ n0 ) . n ) in { g: (x0 <= g & g <= ( x0 + r )) } by A29;
hence thesis by RCOMP_1:def 1;
end;
( rng ( h + c ) ) c= [. x0,( x0 + r ) .]
proof
let x;
assume x in ( rng ( h + c ) );
then consider n such that A30: x = ( ( h + c ) . n ) by FUNCT_2:113;
( ( h + c ) . n ) = ( ( ( ( a - b ) + b ) ^\ n0 ) . n ) by A12,SEQM_3:15
.= ( ( ( a - b ) + b ) . ( n + n0 ) ) by NAT_1:def 3
.= ( ( ( a - b ) . ( n + n0 ) ) + ( b . ( n + n0 ) ) ) by SEQ_1:7
.= ( ( ( a . ( n + n0 ) ) - ( b . ( n + n0 ) ) ) + ( b . ( n + n0 ) ) ) by RFUNCT_2:1
.= ( ( a ^\ n0 ) . n ) by NAT_1:def 3;
hence thesis by A28,A30;
end;
then ( rng ( h + c ) ) c= ( dom f ) by A9,XBOOLE_1:1;
then A31: ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) is  convergent by A1,A24,A14,CKB7:def 1;
then A32: ( lim ( h (#) ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) ) = ( ( 0 ) * ( lim ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) ) by A13,A20,SEQ_2:15
.= ( 0 );
now
let n;
A33: ( h . n ) <> ( 0 ) by A24;
thus ( ( h (#) ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) . n ) = ( ( h . n ) * ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) . n ) ) by SEQ_1:8
.= ( ( h . n ) * ( ( ( h " ) . n ) * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) ) by SEQ_1:8
.= ( ( h . n ) * ( ( ( h . n ) " ) * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) ) by VALUED_1:10
.= ( ( ( h . n ) * ( ( h . n ) " ) ) * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) )
.= ( 1 * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) by A33,XCMPLX_0:def 7
.= ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n );
end;
then A34: ( h (#) ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) = ( ( f /* ( h + c ) ) - ( f /* c ) ) by FUNCT_2:63;
then A35: ( ( f /* ( h + c ) ) - ( f /* c ) ) is  convergent by A13,A31,SEQ_2:14;
then A36: ( ( ( f /* ( h + c ) ) - ( f /* c ) ) + ( f /* c ) ) is  convergent by A19,SEQ_2:5;
hence ( f /* a ) is  convergent by A27,SEQ_4:21;
( lim ( f /* c ) ) = ( f . x0 ) by A17,A19,SEQ_2:def 7;
then ( lim ( ( ( f /* ( h + c ) ) - ( f /* c ) ) + ( f /* c ) ) ) = ( ( 0 ) + ( f . x0 ) ) by A32,A34,A35,A19,SEQ_2:6
.= ( f . x0 );
hence thesis by A36,A27,SEQ_4:22;
end;
( x0 + ( 0 ) ) <= ( x0 + r ) by A2,XREAL_1:7;
then x0 in [. x0,( x0 + r ) .] by XXREAL_1:1;
hence thesis by A3,A4,CKB6:def 1;
end;
