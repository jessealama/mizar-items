environ
vocabularies NUMBERS,FDIFF_1,SEQ_1,FUNCT_1,PARTFUN1,REAL_1,SUBSET_1,XXREAL_0,CARD_1,XXREAL_1,ARYTM_1,TARSKI,RELAT_1,ARYTM_3,FUNCOP_1,VALUED_0,SEQ_2,ORDINAL2,VALUED_1,FUNCT_2,NAT_1,LIMFUNC1,XBOOLE_0,XREAL_0,ORDINAL1,COMPLEX1,SQUARE_1,ORDINAL4,RCOMP_1,FDIFF_3;
notations TARSKI,ORDINAL1,SUBSET_1,NUMBERS,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,VALUED_0,VALUED_1,SEQ_1,SEQ_2,SQUARE_1,RFUNCT_1,RCOMP_1,FDIFF_1,LIMFUNC1,RECDEF_1,CKB5,CKB6,CKB7,CKB8,CKB13,CKB14;
definitions TARSKI,XBOOLE_0,SQUARE_1,PROB_1,LIMFUNC1,VALUED_1,CKB5,CKB6,CKB7,CKB8,CKB13,CKB14;
theorems NAT_1,SEQ_1,SEQ_2,SEQM_3,SEQ_4,ABSVALUE,RFUNCT_1,RFUNCT_2,RCOMP_1,FDIFF_1,LIMFUNC2,FDIFF_2,TARSKI,SCHEME1,ZFMISC_1,FCONT_3,FUNCT_1,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_0,XCMPLX_1,FUNCOP_1,XREAL_1,COMPLEX1,XXREAL_0,VALUED_1,XXREAL_1,XXREAL_2,VALUED_0,ORDINAL1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28;
schemes SEQ_1,SCHEME1,FUNCT_2,FDIFF_2;
registrations ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FDIFF_1,VALUED_0,VALUED_1,FUNCT_2,XXREAL_2,FUNCOP_1,SEQ_4,SETFAM_1,REALSET1,FINSET_1;
constructors FUNCOP_1,REAL_1,SQUARE_1,NAT_1,COMPLEX1,SEQ_2,SEQM_3,PROB_1,RCOMP_1,RFUNCT_1,RFUNCT_2,LIMFUNC1,PARTFUN1,FDIFF_1,SEQ_1,VALUED_1,RECDEF_1,XXREAL_2,SETFAM_1,RELSET_1,BINOP_2,RVSUM_1,CKB5,CKB6,CKB7,CKB8,CKB13,CKB14;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve h for  convergent_to_0 Real_Sequence;
reserve c for  constant Real_Sequence;
reserve f for (PartFunc of ( REAL ),( REAL ));
reserve x0 for Real;
reserve r0 for Real;
reserve r2 for Real;
reserve g for Real;
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve x for set;
theorem
Lm4: ((f is_right_differentiable_in x0 & (ex r0 st (r0 > ( 0 ) & (for g holds ((g in ( dom f ) & g in [. x0,( x0 + r0 ) .]) implies ( f . g ) <> ( 0 )))))) implies (( f ^ ) is_right_differentiable_in x0 & ( Rdiff (( f ^ ),x0) ) = ( - ( ( Rdiff (f,x0) ) / ( ( f . x0 ) ^2 ) ) )))
proof
A1: ( ( 0 ) + x0 ) = x0;
assume A2: f is_right_differentiable_in x0;
then consider r2 such that A3: ( 0 ) < r2 and A4: [. x0,( x0 + r2 ) .] c= ( dom f ) by CKB7:def 1;
given r0 such that
A5: r0 > ( 0 )
and
A6: (for g holds ((g in ( dom f ) & g in [. x0,( x0 + r0 ) .]) implies ( f . g ) <> ( 0 )));

set r3 = ( min (r0,r2) );
( 0 ) <= r3 by A5,A3,XXREAL_0:15;
then A7: x0 <= ( x0 + r3 ) by A1,XREAL_1:6;
r3 <= r2 by XXREAL_0:17;
then A8: ( x0 + r3 ) <= ( x0 + r2 ) by XREAL_1:7;
then x0 <= ( x0 + r2 ) by A7,XXREAL_0:2;
then A9: x0 in [. x0,( x0 + r2 ) .] by XXREAL_1:1;
( x0 + r3 ) in { g: (x0 <= g & g <= ( x0 + r2 )) } by A7,A8;
then ( x0 + r3 ) in [. x0,( x0 + r2 ) .] by RCOMP_1:def 1;
then [. x0,( x0 + r3 ) .] c= [. x0,( x0 + r2 ) .] by A9,XXREAL_2:def 12;
then A10: [. x0,( x0 + r3 ) .] c= ( dom f ) by A4,XBOOLE_1:1;
r3 <= r0 by XXREAL_0:17;
then A11: ( x0 + r3 ) <= ( x0 + r0 ) by XREAL_1:7;
then x0 <= ( x0 + r0 ) by A7,XXREAL_0:2;
then A12: x0 in [. x0,( x0 + r0 ) .] by XXREAL_1:1;
( x0 + r3 ) in { g: (x0 <= g & g <= ( x0 + r0 )) } by A7,A11;
then ( x0 + r3 ) in [. x0,( x0 + r0 ) .] by RCOMP_1:def 1;
then A13: [. x0,( x0 + r3 ) .] c= [. x0,( x0 + r0 ) .] by A12,XXREAL_2:def 12;
A14: [. x0,( x0 + r3 ) .] c= ( dom ( f ^ ) )
proof
assume (not thesis);
then consider x such that A15: x in [. x0,( x0 + r3 ) .] and A16: (not x in ( dom ( f ^ ) )) by TARSKI:def 3;
reconsider x as Real by A15;
A17: (not x in ( ( dom f ) \ ( f " { ( 0 ) } ) )) by A16,RFUNCT_1:def 2;
now
per cases  by A17,XBOOLE_0:def 5;
suppose (not x in ( dom f ));

hence contradiction by A10,A15;
end;
suppose A18: x in ( f " { ( 0 ) } );

then ( f . x ) in { ( 0 ) } by FUNCT_1:def 7;
then A19: ( f . x ) = ( 0 ) by TARSKI:def 1;
x in ( dom f ) by A18,FUNCT_1:def 7;
hence contradiction by A6,A13,A15,A19;
end;
end;
hence contradiction;
end;
A20: x0 in [. x0,( x0 + r3 ) .] by A7,XXREAL_1:1;
A21: (for h holds (for c holds (((( rng c ) = { x0 } & ( rng ( h + c ) ) c= ( dom ( f ^ ) )) & (for n holds ( h . n ) > ( 0 ))) implies (( ( h " ) (#) ( ( ( f ^ ) /* ( h + c ) ) - ( ( f ^ ) /* c ) ) ) is  convergent & ( lim ( ( h " ) (#) ( ( ( f ^ ) /* ( h + c ) ) - ( ( f ^ ) /* c ) ) ) ) = ( - ( ( Rdiff (f,x0) ) / ( ( f . x0 ) ^2 ) ) )))))
proof
let h;
let c;
assume that
A22: ( rng c ) = { x0 }
and
A23: ( rng ( h + c ) ) c= ( dom ( f ^ ) )
and
A24: (for n holds ( h . n ) > ( 0 ));
A25: ( lim h ) = ( 0 ) by FDIFF_1:def 1;
A26: (for m holds ( c . m ) = x0)
proof
let m;
( c . m ) in ( rng c ) by VALUED_0:28;
hence thesis by A22,TARSKI:def 1;
end;
A27: ( ( dom f ) \ ( f " { ( 0 ) } ) ) c= ( dom f ) by XBOOLE_1:36;
( rng ( h + c ) ) c= ( ( dom f ) \ ( f " { ( 0 ) } ) ) by A23,RFUNCT_1:def 2;
then A28: ( rng ( h + c ) ) c= ( dom f ) by A27,XBOOLE_1:1;
then A29: ( lim ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) = ( Rdiff (f,x0) ) by A2,A22,A24,CKB23:1;
( Rdiff (f,x0) ) = ( Rdiff (f,x0) );
then A30: ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) is  convergent by A2,A22,A24,A28,CKB23:1;
then A31: ( - ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) is  convergent by SEQ_2:9;
x0 in ( dom ( f ^ ) ) by A20,A14;
then A32: x0 in ( ( dom f ) \ ( f " { ( 0 ) } ) ) by RFUNCT_1:def 2;
( rng c ) c= ( ( dom f ) \ ( f " { ( 0 ) } ) )
proof
let x being set;
assume x in ( rng c );
hence thesis by A22,A32,TARSKI:def 1;
end;
then A33: ( rng c ) c= ( dom ( f ^ ) ) by RFUNCT_1:def 2;
then A34: ( f /* c ) is  non-zero by RFUNCT_2:11;
now
let n;
A35: ( h . n ) <> ( 0 ) by A24;
thus ( ( h (#) ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) . n ) = ( ( ( h (#) ( h " ) ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) . n ) by SEQ_1:14
.= ( ( ( h (#) ( h " ) ) . n ) * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) by SEQ_1:8
.= ( ( ( h . n ) * ( ( h " ) . n ) ) * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) by SEQ_1:8
.= ( ( ( h . n ) * ( ( h . n ) " ) ) * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) by VALUED_1:10
.= ( 1 * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) by A35,XCMPLX_0:def 7
.= ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n );
end;
then A36: ( h (#) ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) = ( ( f /* ( h + c ) ) - ( f /* c ) ) by FUNCT_2:63;
A37: ( f /* ( h + c ) ) is  non-zero by A23,RFUNCT_2:11;
then A38: ( ( f /* ( h + c ) ) (#) ( f /* c ) ) is  non-zero by A34,SEQ_1:35;
now
let n;
thus ( ( ( f /* c ) + ( ( f /* ( h + c ) ) - ( f /* c ) ) ) . n ) = ( ( ( f /* c ) . n ) + ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) by SEQ_1:7
.= ( ( ( f /* c ) . n ) + ( ( ( f /* ( h + c ) ) . n ) - ( ( f /* c ) . n ) ) ) by RFUNCT_2:1
.= ( ( f /* ( h + c ) ) . n );
end;
then A39: ( ( f /* c ) + ( ( f /* ( h + c ) ) - ( f /* c ) ) ) = ( f /* ( h + c ) ) by FUNCT_2:63;
( dom ( f ^ ) ) = ( ( dom f ) \ ( f " { ( 0 ) } ) ) by RFUNCT_1:def 2;
then A40: ( dom ( f ^ ) ) c= ( dom f ) by XBOOLE_1:36;
A41: (for g being  real number holds (( 0 ) < g implies (ex n st (for m holds (n <= m implies ( abs ( ( ( f /* c ) . m ) - ( f . x0 ) ) ) < g)))))
proof
let g being  real number;
assume that
A42: ( 0 ) < g;
take n = ( 0 );
let m;
assume that
n <= m;
( abs ( ( ( f /* c ) . m ) - ( f . x0 ) ) ) = ( abs ( ( f . ( c . m ) ) - ( f . x0 ) ) ) by A33,A40,FUNCT_2:108,XBOOLE_1:1
.= ( abs ( ( f . x0 ) - ( f . x0 ) ) ) by A26
.= ( 0 ) by ABSVALUE:def 1;
hence thesis by A42;
end;
then A43: ( f /* c ) is  convergent by SEQ_2:def 6;
then A44: ( lim ( f /* c ) ) = ( f . x0 ) by A41,SEQ_2:def 7;
A45: h is  convergent by FDIFF_1:def 1;
then ( h (#) ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) is  convergent by A30,SEQ_2:14;
then A46: ( f /* ( h + c ) ) is  convergent by A43,A36,A39,SEQ_2:5;
( lim ( h (#) ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) ) = ( ( lim h ) * ( lim ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) ) by A45,A30,SEQ_2:15
.= ( 0 ) by A25;
then ( 0 ) = ( ( lim ( f /* ( h + c ) ) ) - ( f . x0 ) ) by A43,A44,A36,A46,SEQ_2:12;
then A47: ( lim ( ( f /* ( h + c ) ) (#) ( f /* c ) ) ) = ( ( f . x0 ) ^2 ) by A43,A44,A46,SEQ_2:15;
A48: ( lim ( ( f /* ( h + c ) ) (#) ( f /* c ) ) ) <> ( 0 )
proof
assume (not thesis);
then ( f . x0 ) = ( 0 ) by A47,XCMPLX_1:6;
hence contradiction by A6,A4,A12,A9;
end;
now
let n;
A49: (( ( f /* ( h + c ) ) . n ) <> ( 0 ) & ( ( f /* c ) . n ) <> ( 0 )) by A37,A34,SEQ_1:5;
thus ( ( ( h " ) (#) ( ( ( f ^ ) /* ( h + c ) ) - ( ( f ^ ) /* c ) ) ) . n ) = ( ( ( h " ) . n ) * ( ( ( ( f ^ ) /* ( h + c ) ) - ( ( f ^ ) /* c ) ) . n ) ) by SEQ_1:8
.= ( ( ( h " ) . n ) * ( ( ( ( f ^ ) /* ( h + c ) ) . n ) - ( ( ( f ^ ) /* c ) . n ) ) ) by RFUNCT_2:1
.= ( ( ( h " ) . n ) * ( ( ( ( f /* ( h + c ) ) " ) . n ) - ( ( ( f ^ ) /* c ) . n ) ) ) by A23,RFUNCT_2:12
.= ( ( ( h " ) . n ) * ( ( ( ( f /* ( h + c ) ) " ) . n ) - ( ( ( f /* c ) " ) . n ) ) ) by A33,RFUNCT_2:12
.= ( ( ( h " ) . n ) * ( ( ( ( f /* ( h + c ) ) . n ) " ) - ( ( ( f /* c ) " ) . n ) ) ) by VALUED_1:10
.= ( ( ( h " ) . n ) * ( ( ( ( f /* ( h + c ) ) . n ) " ) - ( ( ( f /* c ) . n ) " ) ) ) by VALUED_1:10
.= ( ( ( h " ) . n ) * ( ( 1 / ( ( f /* ( h + c ) ) . n ) ) - ( ( ( f /* c ) . n ) " ) ) ) by XCMPLX_1:215
.= ( ( ( h " ) . n ) * ( ( 1 / ( ( f /* ( h + c ) ) . n ) ) - ( 1 / ( ( f /* c ) . n ) ) ) ) by XCMPLX_1:215
.= ( ( ( h " ) . n ) * ( ( ( 1 * ( ( f /* c ) . n ) ) - ( 1 * ( ( f /* ( h + c ) ) . n ) ) ) / ( ( ( f /* ( h + c ) ) . n ) * ( ( f /* c ) . n ) ) ) ) by A49,XCMPLX_1:130
.= ( ( ( h " ) . n ) * ( ( - ( ( ( f /* ( h + c ) ) . n ) - ( ( f /* c ) . n ) ) ) / ( ( ( f /* ( h + c ) ) (#) ( f /* c ) ) . n ) ) ) by SEQ_1:8
.= ( ( ( h " ) . n ) * ( ( - ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) / ( ( ( f /* ( h + c ) ) (#) ( f /* c ) ) . n ) ) ) by RFUNCT_2:1
.= ( ( ( h " ) . n ) * ( - ( ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) / ( ( ( f /* ( h + c ) ) (#) ( f /* c ) ) . n ) ) ) ) by XCMPLX_1:187
.= ( - ( ( ( h " ) . n ) * ( ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) / ( ( ( f /* ( h + c ) ) (#) ( f /* c ) ) . n ) ) ) )
.= ( - ( ( ( ( h " ) . n ) * ( ( ( f /* ( h + c ) ) - ( f /* c ) ) . n ) ) / ( ( ( f /* ( h + c ) ) (#) ( f /* c ) ) . n ) ) ) by XCMPLX_1:74
.= ( - ( ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) . n ) / ( ( ( f /* ( h + c ) ) (#) ( f /* c ) ) . n ) ) ) by SEQ_1:8
.= ( - ( ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) . n ) * ( ( ( ( f /* ( h + c ) ) (#) ( f /* c ) ) . n ) " ) ) ) by XCMPLX_0:def 9
.= ( - ( ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) . n ) * ( ( ( ( f /* ( h + c ) ) (#) ( f /* c ) ) " ) . n ) ) ) by VALUED_1:10
.= ( - ( ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) /" ( ( f /* ( h + c ) ) (#) ( f /* c ) ) ) . n ) ) by SEQ_1:8
.= ( ( - ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) /" ( ( f /* ( h + c ) ) (#) ( f /* c ) ) ) ) . n ) by SEQ_1:10
.= ( ( ( - ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) /" ( ( f /* ( h + c ) ) (#) ( f /* c ) ) ) . n ) by SEQ_1:48;
end;
then A50: ( ( h " ) (#) ( ( ( f ^ ) /* ( h + c ) ) - ( ( f ^ ) /* c ) ) ) = ( ( - ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) /" ( ( f /* ( h + c ) ) (#) ( f /* c ) ) ) by FUNCT_2:63;
A51: ( ( f /* ( h + c ) ) (#) ( f /* c ) ) is  convergent by A43,A46,SEQ_2:14;
then ( lim ( ( h " ) (#) ( ( ( f ^ ) /* ( h + c ) ) - ( ( f ^ ) /* c ) ) ) ) = ( ( lim ( - ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) ) / ( ( f . x0 ) ^2 ) ) by A38,A47,A48,A31,A50,SEQ_2:24
.= ( ( - ( Rdiff (f,x0) ) ) / ( ( f . x0 ) ^2 ) ) by A30,A29,SEQ_2:10
.= ( - ( ( Rdiff (f,x0) ) / ( ( f . x0 ) ^2 ) ) ) by XCMPLX_1:187;
hence thesis by A38,A51,A48,A31,A50,SEQ_2:23;
end;
( 0 ) < r3 by A5,A3,XXREAL_0:15;
hence thesis by A14,A21,CKB23:1;
end;
