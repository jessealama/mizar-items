environ
vocabularies NUMBERS,SUBSET_1,CQC_LANG,FINSEQ_1,ORDINAL1,ARYTM_3,XXREAL_0,TARSKI,CARD_1,XBOOLE_0,NAT_1,FINSET_1,RELAT_1,ORDINAL4,FUNCT_1,CALCUL_1,FUNCT_2,CQC_THE1,QC_LANG1,XBOOLEAN,FINSEQ_5,ARYTM_1,FINSEQ_2,CALCUL_2;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,XCMPLX_0,CARD_1,NUMBERS,XXREAL_0,NAT_1,RELAT_1,FUNCT_1,FINSEQ_1,CQC_LANG,FINSET_1,FINSEQ_5,FINSEQ_2,RELSET_1,FUNCT_2,WELLORD2,CALCUL_1,CKB1,CKB2,CKB23,CKB26,CKB27;
definitions TARSKI,XBOOLE_0,FINSEQ_2,CKB1,CKB23,CKB26,CKB27;
theorems TARSKI,FINSEQ_1,FINSEQ_3,FUNCT_1,XBOOLE_0,FINSEQ_2,RELAT_1,NAT_1,XBOOLE_1,FUNCT_2,CALCUL_1,QC_LANG2,CARD_1,ORDINAL1,FUNCT_4,FINSEQ_5,INT_1,XREAL_1,XXREAL_0,FUNCOP_1,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34;
schemes NAT_1,RECDEF_1;
registrations FUNCT_1,ORDINAL1,RELSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,FINSEQ_1,CQC_LANG,FUNCT_2,FINSEQ_2,CARD_1,CKB9,CKB10;
constructors PARTFUN1,WELLORD2,XXREAL_0,REAL_1,NAT_1,INT_1,FINSEQ_2,FINSEQ_5,CALCUL_1,RELSET_1,CKB1,CKB2,CKB23,CKB26,CKB27;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve p for (Element of ( CQC-WFF ));
reserve q for (Element of ( CQC-WFF ));
reserve p1 for (Element of ( CQC-WFF ));
reserve q1 for (Element of ( CQC-WFF ));
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve f for (FinSequence of ( CQC-WFF ));
reserve f1 for (FinSequence of ( CQC-WFF ));
reserve f2 for (FinSequence of ( CQC-WFF ));
reserve g for (FinSequence of ( CQC-WFF ));
theorem
Th28: ((1 <= ( len g ) &  |- ( f ^ g )) implies  |- ( f ^ <* ( Impl ( Rev g ) ) *> ))
proof
set h = ( Rev g );
assume that
A1: 1 <= ( len g )
and
A2:  |- ( f ^ g );
A3: 1 <= ( len h ) by A1,FINSEQ_5:def 3;
then consider F being (FinSequence of ( CQC-WFF )) such that A4: ( Impl h ) = ( F . ( len h ) ) and A5: ( len F ) = ( len h ) and A6: (( F . 1 ) = ( Begin h ) or ( len h ) = ( 0 )) and A7: (for n holds ((1 <= n & n < ( len h )) implies (ex p st (ex q st ((p = ( h . ( n + 1 ) ) & q = ( F . n )) & ( F . ( n + 1 ) ) = ( p => q )))))) by CKB27:def 1;
A8: 1 <= ( len h ) by A1,FINSEQ_5:def 3;
defpred P[ (Element of ( NAT )) ]
 means
((1 <= $1 & $1 <= ( len F )) implies (ex f1 st (ex f2 st (ex n st (((( $1 + n ) = ( len ( f ^ g ) ) & f1 = ( ( f ^ g ) | ( Seg n ) )) & f2 = ( f1 ^ <* ( F . $1 ) *> )) &  |- f2)))));
A9: (for k holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k;
assume that
A10: P[ k ];
A11: ( len g ) <= ( len ( f ^ g ) ) by CALCUL_1:6;
assume that
A12: 1 <= ( k + 1 )
and
A13: ( k + 1 ) <= ( len F );
A14: ( k + 1 ) <= ( len g ) by A5,A13,FINSEQ_5:def 3;
then consider n being Nat such that A15: ( len ( f ^ g ) ) = ( ( k + 1 ) + n ) by A11,NAT_1:10,XXREAL_0:2;
reconsider n as (Element of ( NAT )) by ORDINAL1:def 12;
A16:now
( k + 1 ) in ( dom F ) by A12,A13,FINSEQ_3:25;
then reconsider r = ( F . ( k + 1 ) ) as (Element of ( CQC-WFF )) by FINSEQ_2:11;
set f1 = ( ( f ^ g ) | ( Seg n ) );
reconsider f1 as (FinSequence of ( CQC-WFF )) by FINSEQ_1:18;
set f2 = ( f1 ^ <* r *> );
( len ( f ^ g ) ) <= ( ( len ( f ^ g ) ) + k ) by NAT_1:11;
then A17: ( ( len ( f ^ g ) ) - k ) <= ( ( ( len ( f ^ g ) ) + k ) - k ) by XREAL_1:9;
assume k <> ( 0 );
then A18: ( ( 0 ) + 1 ) <= k by NAT_1:13;
then consider f1k being (FinSequence of ( CQC-WFF )) such that A19: (ex f2 st (ex n st (((( k + n ) = ( len ( f ^ g ) ) & f1k = ( ( f ^ g ) | ( Seg n ) )) & f2 = ( f1k ^ <* ( F . k ) *> )) &  |- f2))) by A10,A13,NAT_1:13;
consider f2k being (FinSequence of ( CQC-WFF )) such that A20: (ex n st (((( k + n ) = ( len ( f ^ g ) ) & f1k = ( ( f ^ g ) | ( Seg n ) )) & f2k = ( f1k ^ <* ( F . k ) *> )) &  |- f2k)) by A19;
consider nk being (Element of ( NAT )) such that A21: ( k + nk ) = ( len ( f ^ g ) ) and A22: (f1k = ( ( f ^ g ) | ( Seg nk ) ) & f2k = ( f1k ^ <* ( F . k ) *> )) and A23:  |- f2k by A20;
1 <= ( n + 1 ) by NAT_1:11;
then A24: nk in ( dom ( f ^ g ) ) by A15,A21,A17,FINSEQ_3:25;
then reconsider p = ( ( f ^ g ) . nk ) as (Element of ( CQC-WFF )) by FINSEQ_2:11;
( n + 1 ) = nk by A15,A21;
then A25: f2k = ( ( f1 ^ <* ( ( f ^ g ) . nk ) *> ) ^ <* ( F . k ) *> ) by A22,A24,FINSEQ_5:10;
A26: k < ( len h ) by A5,A13,NAT_1:13;
then consider p1,q1 such that A27: p1 = ( h . ( k + 1 ) ) and A28: (q1 = ( F . k ) & ( F . ( k + 1 ) ) = ( p1 => q1 )) by A7,A18;
( k + 1 ) in ( dom h ) by A5,A12,A13,FINSEQ_3:25;
then ( k + 1 ) in ( dom g ) by FINSEQ_5:57;
then A29: p1 = ( g . ( ( ( len g ) - ( k + 1 ) ) + 1 ) ) by A27,FINSEQ_5:58
.= ( g . ( ( len g ) - k ) );
k < ( len g ) by A26,FINSEQ_5:def 3;
then A30: ( k + ( - k ) ) < ( ( len g ) + ( - k ) ) by XREAL_1:8;
then reconsider i = ( ( len g ) - k ) as (Element of ( NAT )) by INT_1:3;
( len g ) <= ( k + ( len g ) ) by NAT_1:11;
then A31: i <= ( len g ) by XREAL_1:20;
( ( 0 ) + 1 ) <= i by A30,INT_1:7;
then i in ( dom g ) by A31,FINSEQ_3:25;
then p1 = ( ( f ^ g ) . ( ( len f ) + i ) ) by A29,FINSEQ_1:def 7
.= ( ( f ^ g ) . ( ( ( len f ) + ( len g ) ) - k ) )
.= ( ( f ^ g ) . ( ( len ( f ^ g ) ) - k ) ) by FINSEQ_1:22
.= p by A21;
then  |- f2 by A23,A25,A28,CKB34:1;
hence thesis by A15;
end;
A32: ( k + 1 ) <= ( len ( f ^ g ) ) by A14,A11,XXREAL_0:2;
now
( F . 1 ) = ( h . 1 ) by A3,A6,CKB26:def 1;
then A33: ( F . 1 ) = ( g . ( len g ) ) by FINSEQ_5:62;
set f1 = ( ( f ^ g ) | ( Seg n ) );
reconsider f1 as (FinSequence of ( CQC-WFF )) by FINSEQ_1:18;
set f2 = ( f1 ^ <* ( F . 1 ) *> );
A34: ( len g ) in ( dom g ) by A1,FINSEQ_3:25;
assume A35: k = ( 0 );
then A36: ( ( f ^ g ) . ( n + 1 ) ) = ( ( f ^ g ) . ( ( len f ) + ( len g ) ) ) by A15,FINSEQ_1:22;
1 <= ( len ( f ^ g ) ) by A12,A32,XXREAL_0:2;
then ( len ( f ^ g ) ) in ( dom ( f ^ g ) ) by FINSEQ_3:25;
then ( ( f ^ g ) | ( Seg ( n + 1 ) ) ) = ( f1 ^ <* ( ( f ^ g ) . ( n + 1 ) ) *> ) by A15,A35,FINSEQ_5:10;
then f2 = ( ( f ^ g ) | ( Seg ( len ( f ^ g ) ) ) ) by A15,A35,A33,A34,A36,FINSEQ_1:def 7;
then A37: f2 = ( ( f ^ g ) | ( dom ( f ^ g ) ) ) by FINSEQ_1:def 3;
then reconsider f2 as (FinSequence of ( CQC-WFF )) by RELAT_1:69;
take f1;
take f2;
take n;
 |- f2 by A2,A37,RELAT_1:69;
hence thesis by A15,A35;
end;
hence thesis by A16;
end;
A38: P[ ( 0 ) ];
(for k holds P[ k ]) from NAT_1:sch 1(A38,A9);
then consider f1 such that A39: (ex f2 st (ex n st (((( ( len h ) + n ) = ( len ( f ^ g ) ) & f1 = ( ( f ^ g ) | ( Seg n ) )) & f2 = ( f1 ^ <* ( F . ( len h ) ) *> )) &  |- f2))) by A5,A8;
consider f2 such that A40: (ex n st (((( ( len h ) + n ) = ( len ( f ^ g ) ) & f1 = ( ( f ^ g ) | ( Seg n ) )) & f2 = ( f1 ^ <* ( F . ( len h ) ) *> )) &  |- f2)) by A39;
consider n such that A41: ( ( len h ) + n ) = ( len ( f ^ g ) ) and A42: ((f1 = ( ( f ^ g ) | ( Seg n ) ) & f2 = ( f1 ^ <* ( F . ( len h ) ) *> )) &  |- f2) by A40;
( ( n + ( len h ) ) - ( len h ) ) = ( ( len ( f ^ g ) ) - ( len g ) ) by A41,FINSEQ_5:def 3;
then ( ( n + ( len h ) ) + ( - ( len h ) ) ) = ( ( ( len f ) + ( len g ) ) - ( len g ) ) by FINSEQ_1:22;
then ( Seg n ) = ( dom f ) by FINSEQ_1:def 3;
hence thesis by A4,A42,FINSEQ_1:21;
end;
