environ
vocabularies NUMBERS,REAL_1,XREAL_0,ORDINAL1,LIMFUNC1,XBOOLE_0,XXREAL_0,CARD_1,ARYTM_3,POWER,RELAT_1,PREPOWER,ARYTM_1,PARTFUN1,FUNCT_1,FDIFF_1,VALUED_1,SUBSET_1,TARSKI,XXREAL_1,ORDINAL2,SEQ_1,SERIES_1,VALUED_0,COMPLEX1,SEQ_2,XXREAL_2,NAT_1,FUNCT_2,FCONT_1,CARD_3;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,PARTFUN1,FUNCT_2,LIMFUNC1,RCOMP_1,FCONT_1,XXREAL_0,XREAL_0,COMPLEX1,ORDINAL1,NUMBERS,REAL_1,NAT_1,VALUED_0,VALUED_1,SEQ_1,SEQ_2,SERIES_1,FDIFF_1,PREPOWER,POWER,TAYLOR_1,RECDEF_1;
definitions SUBSET_1,LIMFUNC1;
theorems XBOOLE_1,ABSVALUE,TARSKI,XBOOLE_0,XREAL_0,XCMPLX_1,RCOMP_1,SEQ_1,SEQ_2,SEQM_3,SERIES_1,FUNCT_1,NAT_1,POWER,FCONT_1,FDIFF_1,ROLLE,SEQ_4,PREPOWER,RELSET_1,FUNCT_2,TAYLOR_1,XREAL_1,COMPLEX1,XXREAL_0,PARTFUN1,ORDINAL1,VALUED_1,XXREAL_1,VALUED_0,RELAT_1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14;
schemes SEQ_1,RECDEF_1,NAT_1,PARTFUN2;
registrations XBOOLE_0,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,RCOMP_1,VALUED_0,VALUED_1,FUNCT_2,SEQ_2,SEQ_4,FCONT_3,CKB1;
constructors PARTFUN1,REAL_1,NAT_1,INT_2,SEQ_2,SEQM_3,RCOMP_1,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,PREPOWER,SERIES_1,TAYLOR_1,SEQ_1,VALUED_1,RECDEF_1,RELSET_1;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve a for Real;
reserve p for Real;
theorem
Th10: (for p being Real holds (( 0 ) < p implies (for a,ap being Real_Sequence holds (((a is  convergent & (for n being (Element of ( NAT )) holds ( 0 ) <= ( a . n ))) & (for n being (Element of ( NAT )) holds ( ap . n ) = ( ( a . n ) to_power p ))) implies (ap is  convergent & ( lim ap ) = ( ( lim a ) to_power p ))))))
proof
let p being Real;
assume that
A1: ( 0 ) < p;
let a being Real_Sequence;
let ap being Real_Sequence;
assume that
A2: a is  convergent
and
A3: (for n being (Element of ( NAT )) holds ( 0 ) <= ( a . n ))
and
A4: (for n being (Element of ( NAT )) holds ( ap . n ) = ( ( a . n ) to_power p ));
now
per cases ;
case A5: ( lim a ) = ( 0 );
now
per cases ;
case (ex n being (Element of ( NAT )) st (for m being (Element of ( NAT )) holds (n <= m implies ( a . m ) = ( 0 ))));
then consider N being (Element of ( NAT )) such that A6: (for m being (Element of ( NAT )) holds (N <= m implies ( a . m ) = ( 0 )));
A7: (for n being (Element of ( NAT )) holds ( ( a ^\ N ) . n ) = ( 0 ))
proof
let n being (Element of ( NAT ));
( a . ( n + N ) ) = ( 0 ) by A6,NAT_1:12;
hence thesis by NAT_1:def 3;
end;
A8:now
let e being  real number;
assume that
A9: e > ( 0 );
take n = ( 0 );
let m being (Element of ( NAT ));
assume that
n <= m;
A10: ( ( lim a ) to_power p ) = ( 0 ) by A1,A5,POWER:def 2;
( ( ap ^\ N ) . m ) = ( ap . ( m + N ) ) by NAT_1:def 3
.= ( ( a . ( m + N ) ) to_power p ) by A4
.= ( ( ( a ^\ N ) . m ) to_power p ) by NAT_1:def 3
.= ( ( 0 ) to_power p ) by A7
.= ( 0 ) by A1,POWER:def 2;
hence ( abs ( ( ( ap ^\ N ) . m ) - ( ( lim a ) to_power p ) ) ) < e by A9,A10,ABSVALUE:2;
end;
then A11: ( ap ^\ N ) is  convergent by SEQ_2:def 6;
then ( ( lim a ) to_power p ) = ( lim ( ap ^\ N ) ) by A8,SEQ_2:def 7;
hence thesis by A11,SEQ_4:20,SEQ_4:21;
end;
case A12: (for n being (Element of ( NAT )) holds (ex m being (Element of ( NAT )) st (n <= m & ( a . m ) <> ( 0 ))));
defpred P[ set ]
 means
( a . $1 ) <> ( 0 );
(ex m1 being (Element of ( NAT )) st (( 0 ) <= m1 & ( a . m1 ) <> ( 0 ))) by A12;
then A13: (ex m being Nat st P[ m ]);
consider M being Nat such that A14: (P[ M ] & (for n being Nat holds (P[ n ] implies M <= n))) from NAT_1:sch 5(A13);
defpred P[ set,set,set ]
 means
(for n,m being (Element of ( NAT )) holds (($2 = n & $3 = m) implies ((n < m & ( a . m ) <> ( 0 )) & (for k being (Element of ( NAT )) holds ((n < k & ( a . k ) <> ( 0 )) implies m <= k)))));
A15: ( ( lim a ) to_power p ) = ( 0 ) by A1,A5,POWER:def 2;
reconsider M as (Element of ( NAT )) by ORDINAL1:def 12;
A16:now
let n being (Element of ( NAT ));
consider m being (Element of ( NAT )) such that A17: (( n + 1 ) <= m & ( a . m ) <> ( 0 )) by A12;
take m;
thus (n < m & ( a . m ) <> ( 0 )) by A17,NAT_1:13;
end;
A18: (for n being (Element of ( NAT )) holds (for x being (Element of ( NAT )) holds (ex y being (Element of ( NAT )) st P[ n,x,y ])))
proof
let n being (Element of ( NAT ));
let x being (Element of ( NAT ));
defpred P[ Nat ]
 means
(x < $1 & ( a . $1 ) <> ( 0 ));
(ex m being (Element of ( NAT )) st P[ m ]) by A16;
then A19: (ex m being Nat st P[ m ]);
consider l being Nat such that A20: (P[ l ] & (for k being Nat holds (P[ k ] implies l <= k))) from NAT_1:sch 5(A19);
take l;
l in ( NAT ) by ORDINAL1:def 12;
hence thesis by A20;
end;
consider F being (Function of ( NAT ),( NAT )) such that A21: (( F . ( 0 ) ) = M & (for n being (Element of ( NAT )) holds P[ n,( F . n ),( F . ( n + 1 ) ) ])) from RECDEF_1:sch 2(A18);
A22: ( rng F ) c= ( NAT ) by RELAT_1:def 19;
then A23: ( rng F ) c= ( REAL ) by XBOOLE_1:1;
A24: ( dom F ) = ( NAT ) by FUNCT_2:def 1;
then reconsider F as Real_Sequence by A23,RELSET_1:4;
A25:now
let n being (Element of ( NAT ));
( F . n ) in ( rng F ) by A24,FUNCT_1:def 3;
hence ( F . n ) is (Element of ( NAT )) by A22;
end;
now
let n being (Element of ( NAT ));
(( F . n ) is (Element of ( NAT )) & ( F . ( n + 1 ) ) is (Element of ( NAT ))) by A25;
hence ( F . n ) < ( F . ( n + 1 ) ) by A21;
end;
then reconsider F as  increasing (sequence of ( NAT )) by SEQM_3:def 6;
A26: (for n being (Element of ( NAT )) holds (( a . n ) <> ( 0 ) implies (ex m being (Element of ( NAT )) st ( F . m ) = n)))
proof
defpred P[ set ]
 means
(( a . $1 ) <> ( 0 ) & (for m being (Element of ( NAT )) holds ( F . m ) <> $1));
assume (ex n being (Element of ( NAT )) st P[ n ]);
then A27: (ex n being Nat st P[ n ]);
consider M1 being Nat such that A28: (P[ M1 ] & (for n being Nat holds (P[ n ] implies M1 <= n))) from NAT_1:sch 5(A27);
defpred P[ Nat ]
 means
(($1 < M1 & ( a . $1 ) <> ( 0 )) & (ex m being (Element of ( NAT )) st ( F . m ) = $1));
A29: (ex n being Nat st P[ n ])
proof
take M;
(M <= M1 & M <> M1) by A14,A21,A28;
hence M < M1 by XXREAL_0:1;
thus ( a . M ) <> ( 0 ) by A14;
take ( 0 );
thus thesis by A21;
end;
A30: (for n being Nat holds (P[ n ] implies n <= M1));
consider MX being Nat such that A31: (P[ MX ] & (for n being Nat holds (P[ n ] implies n <= MX))) from NAT_1:sch 6(A30,A29);
A32: (for k being (Element of ( NAT )) holds ((MX < k & k < M1) implies ( a . k ) = ( 0 )))
proof
given k being (Element of ( NAT )) such that
A33: MX < k
and
A34: (k < M1 & ( a . k ) <> ( 0 ));

now
per cases ;
case (ex m being (Element of ( NAT )) st ( F . m ) = k);
hence contradiction by A31,A33,A34;
end;
case (for m being (Element of ( NAT )) holds ( F . m ) <> k);
hence contradiction by A28,A34;
end;
end;
hence contradiction;
end;
consider m being (Element of ( NAT )) such that A35: ( F . m ) = MX by A31;
A36: (MX < ( F . ( m + 1 ) ) & ( a . ( F . ( m + 1 ) ) ) <> ( 0 )) by A21,A35;
M1 in ( NAT ) by ORDINAL1:def 12;
then A37: ( F . ( m + 1 ) ) <= M1 by A21,A28,A31,A35;
now
assume ( F . ( m + 1 ) ) <> M1;
then ( F . ( m + 1 ) ) < M1 by A37,XXREAL_0:1;
hence contradiction by A32,A36;
end;
hence contradiction by A28;
end;
A38: (( a * F ) is  convergent & ( lim ( a * F ) ) = ( 0 )) by A2,A5,SEQ_4:16,SEQ_4:17;
A39:now
let e being  real number;
assume A40: ( 0 ) < e;
then ( 0 ) < ( e to_power ( 1 / p ) ) by POWER:34;
then consider n being (Element of ( NAT )) such that A41: (for m being (Element of ( NAT )) holds (n <= m implies ( abs ( ( ( a * F ) . m ) - ( 0 ) ) ) < ( e to_power ( 1 / p ) ))) by A38,SEQ_2:def 7;
take k = ( F . n );
let m being (Element of ( NAT ));
assume that
A42: k <= m;
now
per cases ;
case ( a . m ) = ( 0 );
then ( ap . m ) = ( ( 0 ) to_power p ) by A4
.= ( 0 ) by A1,POWER:def 2;
hence ( abs ( ( ap . m ) - ( ( lim a ) to_power p ) ) ) < e by A15,A40,ABSVALUE:2;
end;
case A43: ( a . m ) <> ( 0 );
then consider l being (Element of ( NAT )) such that A44: m = ( F . l ) by A26;
n <= l by A42,A44,SEQM_3:1;
then ( abs ( ( ( a * F ) . l ) - ( 0 ) ) ) < ( e to_power ( 1 / p ) ) by A41;
then A45: ( abs ( a . ( F . l ) ) ) < ( e to_power ( 1 / p ) ) by FUNCT_2:15;
A46: ( ( a . m ) to_power p ) = ( ap . m ) by A4;
A47: ( a . m ) > ( 0 ) by A3,A43;
then A48: ( 0 ) < ( ap . m ) by A46,POWER:34;
( abs ( a . m ) ) > ( 0 ) by A43,COMPLEX1:47;
then ( ( abs ( a . m ) ) to_power p ) < ( ( e to_power ( 1 / p ) ) to_power p ) by A1,A44,A45,POWER:37;
then ( ( abs ( a . m ) ) to_power p ) < ( e to_power ( ( 1 / p ) * p ) ) by A40,POWER:33;
then ( ( abs ( a . m ) ) to_power p ) < ( e to_power 1 ) by A1,XCMPLX_1:106;
then ( ( abs ( a . m ) ) to_power p ) < e by POWER:25;
then ( ap . m ) < e by A47,A46,ABSVALUE:def 1;
hence ( abs ( ( ap . m ) - ( ( lim a ) to_power p ) ) ) < e by A15,A48,ABSVALUE:def 1;
end;
end;
hence ( abs ( ( ap . m ) - ( ( lim a ) to_power p ) ) ) < e;
end;
hence ap is  convergent by SEQ_2:def 6;
hence ( lim ap ) = ( ( lim a ) to_power p ) by A39,SEQ_2:def 7;
end;
end;
hence thesis;
end;
case A49: ( lim a ) <> ( 0 );
A50: ( 0 ) <= ( lim a ) by A2,A3,SEQ_2:17;
(ex k being (Element of ( NAT )) st ( rng ( a ^\ k ) ) c= ( dom ( #R p ) ))
proof
set e0 = ( lim a );
A51: ( e0 / 2 ) > ( 0 ) by A49,A50,XREAL_1:215;
then consider k being (Element of ( NAT )) such that A52: (for m being (Element of ( NAT )) holds (k <= m implies ( abs ( ( a . m ) - e0 ) ) < ( e0 / 2 ))) by A2,SEQ_2:def 7;
take k;
A53:now
let m being (Element of ( NAT ));
( abs ( ( a . ( k + m ) ) - e0 ) ) < ( e0 / 2 ) by A52,NAT_1:12;
then ( - ( e0 / 2 ) ) <= ( ( a . ( k + m ) ) - e0 ) by ABSVALUE:5;
then ( ( - ( e0 / 2 ) ) + e0 ) <= ( ( ( a . ( k + m ) ) - e0 ) + e0 ) by XREAL_1:7;
hence ( 0 ) < ( ( a ^\ k ) . m ) by A51,NAT_1:def 3;
end;
now
let x being set;
assume x in ( rng ( a ^\ k ) );
then consider n being (Element of ( NAT )) such that A54: x = ( ( a ^\ k ) . n ) by FUNCT_2:113;
( 0 ) < ( ( a ^\ k ) . n ) by A53;
then ( ( a ^\ k ) . n ) in { g where g is Real: ( 0 ) < g };
then ( ( a ^\ k ) . n ) in ( right_open_halfline ( 0 ) ) by XXREAL_1:230;
hence x in ( dom ( #R p ) ) by A54,TAYLOR_1:def 4;
end;
hence thesis by TARSKI:def 3;
end;
then consider k being (Element of ( NAT )) such that A55: ( rng ( a ^\ k ) ) c= ( dom ( #R p ) );
now
let x being set;
assume x in ( NAT );
then reconsider n = x as (Element of ( NAT ));
( ( a ^\ k ) . n ) in ( rng ( a ^\ k ) ) by VALUED_0:28;
then ( ( a ^\ k ) . n ) in ( dom ( #R p ) ) by A55;
then A56: ( ( a ^\ k ) . n ) in ( right_open_halfline ( 0 ) ) by TAYLOR_1:def 4;
then ( a . ( k + n ) ) in ( right_open_halfline ( 0 ) ) by NAT_1:def 3;
then ( a . ( k + n ) ) in { g where g is Real: ( 0 ) < g } by XXREAL_1:230;
then A57: (ex g being Real st (( a . ( k + n ) ) = g & g > ( 0 )));
thus ( ( ( #R p ) /* ( a ^\ k ) ) . x ) = ( ( #R p ) . ( ( a ^\ k ) . n ) ) by A55,FUNCT_2:108
.= ( ( ( a ^\ k ) . n ) #R p ) by A56,TAYLOR_1:def 4
.= ( ( a . ( k + n ) ) #R p ) by NAT_1:def 3
.= ( ( a . ( k + n ) ) to_power p ) by A57,POWER:def 2
.= ( ap . ( k + n ) ) by A4
.= ( ( ap ^\ k ) . x ) by NAT_1:def 3;
end;
then A58: ( ( #R p ) /* ( a ^\ k ) ) = ( ap ^\ k ) by FUNCT_2:12;
A59: ( lim ( a ^\ k ) ) = ( lim a ) by A2,SEQ_4:20;
( lim a ) > ( 0 ) by A2,A3,A49,SEQ_2:17;
then ( #R p ) is_continuous_in ( lim ( a ^\ k ) ) by A59,FDIFF_1:24,TAYLOR_1:21;
then A60: (( ( #R p ) /* ( a ^\ k ) ) is  convergent & ( ( #R p ) . ( lim ( a ^\ k ) ) ) = ( lim ( ( #R p ) /* ( a ^\ k ) ) )) by A2,A55,FCONT_1:def 1;
( lim a ) in { g where g is Real: ( 0 ) < g } by A49,A50;
then ( lim a ) in ( right_open_halfline ( 0 ) ) by XXREAL_1:230;
then ( ( #R p ) . ( lim ( a ^\ k ) ) ) = ( ( lim a ) #R p ) by A59,TAYLOR_1:def 4
.= ( ( lim a ) to_power p ) by A49,A50,POWER:def 2;
hence thesis by A60,A58,SEQ_4:21,SEQ_4:22;
end;
end;
hence thesis;
end;
