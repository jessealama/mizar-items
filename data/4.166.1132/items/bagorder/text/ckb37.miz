environ
vocabularies NUMBERS,XBOOLE_0,SUBSET_1,FINSEQ_1,ARYTM_1,ARYTM_3,XXREAL_0,CARD_1,NAT_1,PRE_POLY,FUNCT_1,RELAT_1,TARSKI,CLASSES1,FUNCT_2,CARD_3,FINSEQ_2,PBOOLE,GRAPH_2,VALUED_0,FINSUB_1,FINSET_1,RELAT_2,ORDERS_2,WAYBEL_4,STRUCT_0,WELLFND1,WELLORD1,ORDERS_1,ORDINAL1,WELLORD2,ORDINAL4,REAL_1,FUNCOP_1,FUNCT_4,PARTFUN1,DICKSON,RLVECT_2,ZFMISC_1,MCART_1,BAGORDER;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,XCMPLX_0,RELAT_1,PBOOLE,RELAT_2,RELSET_1,PARTFUN1,FINSET_1,FINSUB_1,ORDINAL1,FUNCT_7,MCART_1,WELLORD1,ORDERS_1,WELLFND1,CARD_1,NUMBERS,VALUED_0,XXREAL_0,REAL_1,FUNCT_1,SEQ_1,PRE_POLY,CARD_3,NAT_D,FINSEQ_1,RVSUM_1,WSIERP_1,FUNCOP_1,FUNCT_2,SEQ_4,DOMAIN_1,FINSEQOP,CLASSES1,RECDEF_1,NAT_1,STRUCT_0,WAYBEL_0,YELLOW_1,WAYBEL_4,PRALG_1,ORDERS_2,DICKSON,POLYNOM2,CKB6,CKB10,CKB15,CKB19,CKB30,CKB31,CKB32;
definitions TARSKI,RELAT_2,WELLFND1,FINSEQ_2,CKB6,CKB10,CKB15,CKB19,CKB32;
theorems WELLORD1,TARSKI,RELAT_2,RELSET_1,ZFMISC_1,ORDERS_2,NAT_1,FUNCT_1,AXIOMS,CARD_3,PBOOLE,YELLOW_1,PRALG_1,FUNCOP_1,PARTIT_2,WELLFND1,RELAT_1,DICKSON,FINSEQ_1,INTEGRA5,RVSUM_1,FINSEQ_2,CARD_1,WAYBEL_0,WAYBEL_4,ORDINAL1,FUNCT_2,CARD_2,MCART_1,FINSUB_1,ORDERS_1,FUNCT_7,WELLORD2,FINSEQ_3,FINSEQ_5,FINSEQOP,RFINSEQ,XBOOLE_0,XBOOLE_1,PARTFUN1,XREAL_1,XXREAL_0,VALUED_0,VALUED_1,XXREAL_2,XREAL_0,NAT_D,CLASSES1,PRE_POLY,CKB1,CKB2,CKB4,CKB5,CKB6,CKB9,CKB10,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB32,CKB33,CKB36;
schemes NAT_1,RELSET_1,FINSET_1,RECDEF_1,FUNCT_2,ORDINAL1,CLASSES1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCT_2,FINSET_1,FINSUB_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,CARD_1,MEMBERED,FINSEQ_1,CARD_5,STRUCT_0,ORDERS_2,WAYBEL_0,YELLOW_1,DICKSON,VALUED_0,XXREAL_2,RELSET_1,PRE_POLY,CKB3,CKB7,CKB8,CKB11,CKB34,CKB35;
constructors DOMAIN_1,FINSEQOP,NAT_D,WSIERP_1,PRALG_1,TRIANG_1,WAYBEL_4,WELLFND1,POLYNOM2,DICKSON,SEQ_1,RECDEF_1,BINOP_2,SEQ_4,CLASSES1,RELSET_1,FUNCT_7,REAL_1,CKB6,CKB10,CKB15,CKB19,CKB32;
requirements SUBSET,NUMERALS,REAL,BOOLE,ARITHM;
begin
definition
let n being Ordinal;
func InvLexOrder n -> (TermOrder of n)
means
:Def8: (for p,q being (bag of n) holds ([ p,q ] in it iff (p = q or (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))))));
existence
proof
defpred P[ set,set ]
 means
($1 = $2 or (ex p,q being (Element of ( Bags n )) st (($1 = p & $2 = q) & (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))))));
consider ILO being (Relation of ( Bags n ),( Bags n )) such that A1: (for x,y being set holds ([ x,y ] in ILO iff ((x in ( Bags n ) & y in ( Bags n )) & P[ x,y ]))) from RELSET_1:sch 1;
A2: ILO is_reflexive_in ( Bags n )
proof
let x being set;
assume x in ( Bags n );
hence thesis by A1;
end;
A3: ILO is_antisymmetric_in ( Bags n )
proof
let x being set,y being set;
assume that
x in ( Bags n )
and
y in ( Bags n )
and
A4: [ x,y ] in ILO
and
A5: [ y,x ] in ILO;
per cases ;
suppose x = y;

hence thesis;
end;
suppose A6: (not x = y);

then consider p being (Element of ( Bags n )),q being (Element of ( Bags n )) such that A7: x = p and A8: y = q and A9: (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))) by A1,A4;
(ex q9,p9 being (Element of ( Bags n )) st ((y = q9 & x = p9) & (ex i being Ordinal st ((i in n & ( q9 . i ) < ( p9 . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( q9 . k ) = ( p9 . k ))))))) by A1,A5,A6;
then consider i being Ordinal such that A10: i in n and A11: ( q . i ) < ( p . i ) and A12: (for k being Ordinal holds ((i in k & k in n) implies ( q . k ) = ( p . k ))) by A7,A8;
consider j being Ordinal such that A13: j in n and A14: ( p . j ) < ( q . j ) and A15: (for k being Ordinal holds ((j in k & k in n) implies ( p . k ) = ( q . k ))) by A9;
now
per cases  by ORDINAL1:14;
suppose i in j;

hence i = j by A12,A13,A14;
end;
suppose i = j;

hence i = j;
end;
suppose j in i;

hence i = j by A10,A11,A15;
end;
end;
hence thesis by A11,A14;
end;
end;
A16: ILO is_transitive_in ( Bags n )
proof
let x being set,y being set,z being set;
assume that
x in ( Bags n )
and
y in ( Bags n )
and
z in ( Bags n )
and
A17: [ x,y ] in ILO
and
A18: [ y,z ] in ILO;
per cases ;
suppose x = y;

hence thesis by A18;
end;
suppose x <> y;

then consider p being (Element of ( Bags n )),q being (Element of ( Bags n )) such that A19: x = p and A20: y = q and A21: (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))) by A1,A17;
consider i being Ordinal such that A22: i in n and A23: ( p . i ) < ( q . i ) and A24: (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))) by A21;
now
per cases ;
suppose y = z;

hence thesis by A17;
end;
suppose y <> z;

then consider q9 being (Element of ( Bags n )),r being (Element of ( Bags n )) such that A25: y = q9 and A26: z = r and A27: (ex i being Ordinal st ((i in n & ( q9 . i ) < ( r . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( q9 . k ) = ( r . k ))))) by A1,A18;
consider j being Ordinal such that A28: j in n and A29: ( q9 . j ) < ( r . j ) and A30: (for k being Ordinal holds ((j in k & k in n) implies ( q9 . k ) = ( r . k ))) by A27;
now
per cases  by ORDINAL1:14;
suppose A31: i in j;

then A32: ( p . j ) < ( r . j ) by A20,A24,A25,A28,A29;
now
let k being Ordinal;
assume that
A33: j in k
and
A34: k in n;
A35: ( q . k ) = ( r . k ) by A20,A25,A30,A33,A34;
i in k by A31,A33,ORDINAL1:10;
hence ( p . k ) = ( r . k ) by A24,A34,A35;
end;
hence thesis by A1,A19,A26,A28,A32;
end;
suppose A36: i = j;

now
take p;
take r;
thus (x = p & z = r) by A19,A26;
take j;
thus j in n by A28;
thus ( p . j ) < ( r . j ) by A20,A23,A25,A29,A36,XXREAL_0:2;
now
let k being Ordinal;
assume that
A37: j in k
and
A38: k in n;
( p . k ) = ( q . k ) by A24,A36,A37,A38;
hence ( p . k ) = ( r . k ) by A20,A25,A30,A37,A38;
end;
hence (for k being Ordinal holds ((j in k & k in n) implies ( p . k ) = ( r . k )));
end;
hence thesis by A1;
end;
suppose A39: j in i;

then A40: ( p . i ) < ( r . i ) by A20,A22,A23,A25,A30;
now
let k being Ordinal;
assume that
A41: i in k
and
A42: k in n;
A43: ( p . k ) = ( q . k ) by A24,A41,A42;
j in k by A39,A41,ORDINAL1:10;
hence ( p . k ) = ( r . k ) by A20,A25,A30,A42,A43;
end;
hence thesis by A1,A19,A22,A26,A40;
end;
end;
hence thesis;
end;
end;
hence thesis;
end;
end;
A44: ( dom ILO ) = ( Bags n ) by A2,ORDERS_1:13;
( field ILO ) = ( Bags n ) by A2,ORDERS_1:13;
then reconsider ILO as (TermOrder of n) by A2,A3,A16,A44,PARTFUN1:def 2,RELAT_2:def 9,RELAT_2:def 12,RELAT_2:def 16;
take ILO;
let x being (bag of n),y being (bag of n);
hereby
assume A45: [ x,y ] in ILO;
now
assume x <> y;
then (ex p,q being (Element of ( Bags n )) st ((x = p & y = q) & (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))))) by A1,A45;
hence (ex i being Ordinal st ((i in n & ( x . i ) < ( y . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( x . k ) = ( y . k )))));
end;
hence (x = y or (ex i being Ordinal st ((i in n & ( x . i ) < ( y . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( x . k ) = ( y . k ))))));
end;
assume A46: (x = y or (ex i being Ordinal st ((i in n & ( x . i ) < ( y . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( x . k ) = ( y . k ))))));
A47:now
assume A48: x <> y;
thus (ex p,q being (Element of ( Bags n )) st ((x = p & y = q) & (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k )))))))
proof
reconsider x9 = x,y9 = y as (Element of ( Bags n )) by PRE_POLY:def 12;
take x9;
take y9;
thus (x = x9 & y = y9);
thus thesis by A46,A48;
end;

end;
x in ( Bags n ) by PRE_POLY:def 12;
hence thesis by A1,A47;
end;
uniqueness
proof
let IT1 being (TermOrder of n),IT2 being (TermOrder of n);
assume that
A49: (for p,q being (bag of n) holds ([ p,q ] in IT1 iff (p = q or (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))))))
and
A50: (for p,q being (bag of n) holds ([ p,q ] in IT2 iff (p = q or (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))))));
now
let a being set,b being set;
hereby
assume A51: [ a,b ] in IT1;
then consider p being set,q being set such that A52: [ a,b ] = [ p,q ] and A53: p in ( Bags n ) and A54: q in ( Bags n ) by RELSET_1:2;
reconsider p,q as (bag of n) by A53,A54;
per cases ;
suppose p = q;

hence [ a,b ] in IT2 by A50,A52;
end;
suppose p <> q;

then (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))) by A49,A51,A52;
hence [ a,b ] in IT2 by A50,A52;
end;
end;
assume A55: [ a,b ] in IT2;
then consider p being set,q being set such that A56: [ a,b ] = [ p,q ] and A57: p in ( Bags n ) and A58: q in ( Bags n ) by RELSET_1:2;
reconsider p,q as (bag of n) by A57,A58;
per cases ;
suppose p = q;

hence [ a,b ] in IT1 by A49,A56;
end;
suppose p <> q;

then (ex i being Ordinal st ((i in n & ( p . i ) < ( q . i )) & (for k being Ordinal holds ((i in k & k in n) implies ( p . k ) = ( q . k ))))) by A50,A55,A56;
hence [ a,b ] in IT1 by A49,A56;
end;
end;
hence IT1 = IT2 by RELAT_1:def 2;
end;
end;
