environ
vocabularies NUMBERS,XBOOLE_0,SUBSET_1,FINSEQ_1,ARYTM_1,ARYTM_3,XXREAL_0,CARD_1,NAT_1,PRE_POLY,FUNCT_1,RELAT_1,TARSKI,CLASSES1,FUNCT_2,CARD_3,FINSEQ_2,PBOOLE,GRAPH_2,VALUED_0,FINSUB_1,FINSET_1,RELAT_2,ORDERS_2,WAYBEL_4,STRUCT_0,WELLFND1,WELLORD1,ORDERS_1,ORDINAL1,WELLORD2,ORDINAL4,REAL_1,FUNCOP_1,FUNCT_4,PARTFUN1,DICKSON,RLVECT_2,ZFMISC_1,MCART_1,BAGORDER;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,XCMPLX_0,RELAT_1,PBOOLE,RELAT_2,RELSET_1,PARTFUN1,FINSET_1,FINSUB_1,ORDINAL1,FUNCT_7,MCART_1,WELLORD1,ORDERS_1,WELLFND1,CARD_1,NUMBERS,VALUED_0,XXREAL_0,REAL_1,FUNCT_1,SEQ_1,PRE_POLY,CARD_3,NAT_D,FINSEQ_1,RVSUM_1,WSIERP_1,FUNCOP_1,FUNCT_2,SEQ_4,DOMAIN_1,FINSEQOP,CLASSES1,RECDEF_1,NAT_1,STRUCT_0,WAYBEL_0,YELLOW_1,WAYBEL_4,PRALG_1,ORDERS_2,DICKSON,POLYNOM2,CKB6,CKB10,CKB15,CKB19,CKB30,CKB31,CKB32,CKB37,CKB41,CKB43,CKB44,CKB51,CKB53,CKB57,CKB58,CKB59,CKB65,CKB66;
definitions TARSKI,RELAT_2,WELLFND1,FINSEQ_2,CKB6,CKB10,CKB15,CKB19,CKB32,CKB37,CKB41,CKB43,CKB44,CKB51,CKB53,CKB57,CKB58,CKB59,CKB65,CKB66;
theorems WELLORD1,TARSKI,RELAT_2,RELSET_1,ZFMISC_1,ORDERS_2,NAT_1,FUNCT_1,AXIOMS,CARD_3,PBOOLE,YELLOW_1,PRALG_1,FUNCOP_1,PARTIT_2,WELLFND1,RELAT_1,DICKSON,FINSEQ_1,INTEGRA5,RVSUM_1,FINSEQ_2,CARD_1,WAYBEL_0,WAYBEL_4,ORDINAL1,FUNCT_2,CARD_2,MCART_1,FINSUB_1,ORDERS_1,FUNCT_7,WELLORD2,FINSEQ_3,FINSEQ_5,FINSEQOP,RFINSEQ,XBOOLE_0,XBOOLE_1,PARTFUN1,XREAL_1,XXREAL_0,VALUED_0,VALUED_1,XXREAL_2,XREAL_0,NAT_D,CLASSES1,PRE_POLY,CKB1,CKB2,CKB4,CKB5,CKB6,CKB9,CKB10,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB32,CKB33,CKB36,CKB37,CKB38,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB47,CKB48,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB68;
schemes NAT_1,RELSET_1,FINSET_1,RECDEF_1,FUNCT_2,ORDINAL1,CLASSES1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCT_2,FINSET_1,FINSUB_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,CARD_1,MEMBERED,FINSEQ_1,CARD_5,STRUCT_0,ORDERS_2,WAYBEL_0,YELLOW_1,DICKSON,VALUED_0,XXREAL_2,RELSET_1,PRE_POLY,CKB3,CKB7,CKB8,CKB11,CKB34,CKB35,CKB39,CKB46,CKB49,CKB67;
constructors DOMAIN_1,FINSEQOP,NAT_D,WSIERP_1,PRALG_1,TRIANG_1,WAYBEL_4,WELLFND1,POLYNOM2,DICKSON,SEQ_1,RECDEF_1,BINOP_2,SEQ_4,CLASSES1,RELSET_1,FUNCT_7,REAL_1,CKB6,CKB10,CKB15,CKB19,CKB32,CKB37,CKB41,CKB43,CKB44,CKB51,CKB53,CKB57,CKB58,CKB59,CKB65,CKB66;
requirements SUBSET,NUMERALS,REAL,BOOLE,ARITHM;
begin
registration
let R being  connected non  empty Poset;
cluster ( FinPoset R ) ->  connected;
correctness
proof
set IR = (the InternalRel of R);
set CR = (the carrier of R);
set FIR = ( FinOrd R );
set FCR = ( Fin CR );
A1: ( FinPoset R ) = RelStr (# FCR,FIR #);
now
let x being (Element of ( FinPoset R ));
let y being (Element of ( FinPoset R ));
reconsider x9 = x,y9 = y as (Element of ( Fin CR ));
defpred P[ Nat ]
 means
(for x,y being (Element of ( Fin CR )) holds (( card x ) = $1 implies ([ x,y ] in FIR or [ y,x ] in FIR)));
now
let a being (Element of ( Fin CR ));
let b being (Element of ( Fin CR ));
assume ( card a ) = ( 0 );
then a = ( {} );
hence ([ a,b ] in FIR or [ a,b ] in FIR) by A1,CKB68:1;
end;
then A2: P[ ( 0 ) ];
now
let n being Nat;
assume that
A3: (for x,y being (Element of ( Fin CR )) holds (( card x ) = n implies ([ x,y ] in FIR or [ y,x ] in FIR)));
let a being (Element of ( Fin CR ));
let b being (Element of ( Fin CR ));
assume that
A4: ( card a ) = ( n + 1 );
per cases ;
suppose a = ( {} );

hence ([ a,b ] in FIR or [ b,a ] in FIR) by A1,CKB68:1;
end;
suppose A5: a <> ( {} );

now
per cases ;
suppose b = ( {} );

hence ([ a,b ] in FIR or [ b,a ] in FIR) by A1,CKB68:1;
end;
suppose A6: b <> ( {} );

now
per cases ;
suppose A7: ( PosetMax a ) <> ( PosetMax b );

now
per cases  by WAYBEL_0:def 29;
suppose ( PosetMax a ) <= ( PosetMax b );

then [ ( PosetMax a ),( PosetMax b ) ] in IR by ORDERS_2:def 5;
hence ([ a,b ] in FIR or [ b,a ] in FIR) by A1,A5,A6,A7,CKB68:1;
end;
suppose ( PosetMax b ) <= ( PosetMax a );

then [ ( PosetMax b ),( PosetMax a ) ] in IR by ORDERS_2:def 5;
hence ([ a,b ] in FIR or [ b,a ] in FIR) by A1,A5,A6,A7,CKB68:1;
end;
end;
hence ([ a,b ] in FIR or [ b,a ] in FIR);
end;
suppose A8: ( PosetMax a ) = ( PosetMax b );

set ax = ( a \ { ( PosetMax a ) } );
set bx = ( b \ { ( PosetMax b ) } );
A9: ( card ax ) = n by A4,CKB63:1;
reconsider ax,bx as (Element of ( Fin CR )) by CKB62:1;
now
per cases  by A3,A9;
suppose [ ax,bx ] in FIR;

hence ([ a,b ] in FIR or [ b,a ] in FIR) by A1,A5,A6,A8,CKB68:1;
end;
suppose [ bx,ax ] in FIR;

hence ([ a,b ] in FIR or [ b,a ] in FIR) by A1,A5,A6,A8,CKB68:1;
end;
end;
hence ([ a,b ] in FIR or [ b,a ] in FIR);
end;
end;
hence ([ a,b ] in FIR or [ b,a ] in FIR);
end;
end;
hence ([ a,b ] in FIR or [ b,a ] in FIR);
end;
end;
then A10: (for n being Nat holds (P[ n ] implies P[ ( n + 1 ) ]));
A11: (for n being Nat holds P[ n ]) from NAT_1:sch 2(A2,A10);
consider n being Nat such that A12: x,n are_equipotent  by CARD_1:43;
( card x9 ) = n by A12,CARD_1:def 2;
then ([ x9,y9 ] in FIR or [ y9,x9 ] in FIR) by A11;
hence (x <= y or y <= x) by ORDERS_2:def 5;
end;
hence thesis by WAYBEL_0:def 29;
end;
end;
