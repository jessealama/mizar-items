environ
vocabularies FUNCT_1,COMPLEX1,RELAT_1,ZFMISC_1,XXREAL_0,PARTFUN1,ARYTM_1,XBOOLE_0,ORDINAL4,INT_1,SQUARE_1,ARYTM_3,RLVECT_1,SUPINF_2,RSSPACE,FUNCOP_1,FINSOP_1,NAT_1,FUNCT_4,BINOP_2,PROB_1,MEASURE6,MESFUNC1,TARSKI,MESFUNC5,IDEAL_1,SUBSET_1,RANDOM_1,RANDOM_2,C0SP1,FINSET_1,FINSEQ_1,ORDINAL2,RPR_1,CARD_1,SEQ_2,POWER,FUNCT_3,PROB_4,UPROOTS,FINSEQ_2,CARD_3,FUNCT_2,RFINSEQ,XREAL_0,FUNCSDOM,POLYALG1,BHSP_5,NUMBERS,REAL_1,INTEGRA5,VALUED_1,ORDINAL1,EQREL_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,FUNCT_4,FUNCOP_1,FINSEQ_1,ORDINAL1,REAL_1,NAT_1,CARD_1,FINSET_1,NUMBERS,XREAL_0,XXREAL_0,NAT_D,COMPLEX1,VALUED_1,RFINSEQ,FINSOP_1,STRUCT_0,ALGSTR_0,IDEAL_1,VECTSP_1,BINOP_1,BINOP_2,RLVECT_1,FUNCSDOM,SUPINF_2,SEQ_1,SEQ_2,SQUARE_1,GROUP_1,POWER,PROB_1,PROB_4,EXTREAL1,MESFUNC1,MEASURE6,MESFUNC5,MESFUNC6,MESFUNC2,RVSUM_1,UPROOTS,MESFUN6C,C0SP1,RANDOM_1,BHSP_5;
definitions TARSKI,BINOP_1,STRUCT_0,ALGSTR_0,RLVECT_1,MEASURE6,MESFUNC5,FINSEQ_2,FINSEQ_1,PROB_4,FUNCSDOM,VALUED_1,BHSP_5,RVSUM_1,SQUARE_1;
theorems FUNCT_1,FUNCT_2,PARTFUN1,COMPLEX1,XBOOLE_0,TARSKI,RELAT_1,VALUED_1,IDEAL_1,ZFMISC_1,RLVECT_1,FUNCOP_1,XBOOLE_1,MESFUNC2,EXTREAL1,MEASURE1,MESFUNC6,PROB_1,XXREAL_0,ABSVALUE,MESFUNC7,RELSET_1,XXREAL_3,XREAL_0,RANDOM_1,C0SP1,FINSEQ_4,POWER,BINOP_2,RFINSEQ,CARD_2,FINSEQ_1,FUNCT_4,FINSOP_1,NAT_1,NAT_2,NAT_D,INT_3,XREAL_1,SQUARE_1,FINSEQ_2,INT_1,FUNCT_3,CARD_1,FINSEQ_3,FINSEQ_5,UPROOTS,MESFUN6C,FUNCSDOM,BHSP_5,RVSUM_1,FIB_NUM3,SUBSET,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8;
schemes FINSEQ_1,FUNCT_2,NAT_1,FUNCT_3;
registrations XBOOLE_0,ORDINAL1,NUMBERS,XREAL_0,MEMBERED,VALUED_0,NAT_1,SUBSET_1,XCMPLX_0,RLVECT_1,XXREAL_0,MEASURE1,FINSEQ_1,RELAT_1,XXREAL_3,C0SP1,FUNCT_2,CARD_1,FINSET_1,BINOP_2,FUNCT_1,UPROOTS,MESFUN6C,FUNCSDOM,BHSP_5,RELSET_1,CKB3,CKB4;
constructors EXTREAL1,REAL_1,IDEAL_1,MEASURE6,MESFUNC2,MESFUNC5,SEQ_2,MESFUNC6,SEQ_1,SUPINF_1,REALSET1,RVSUM_1,MESFUNC1,RELSET_1,RANDOM_1,C0SP1,RFINSEQ,POWER,FINSOP_1,BINARITH,FINSEQOP,SEQ_4,CONVFUN1,SEQFUNC,SETWISEO,FINSEQ_4,PARTFUN3,PROB_4,WELLORD2,SQUARE_1,NAT_D,UPROOTS,MESFUN6C,BHSP_5;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve Omega for non  empty set;
reserve Sigma for (SigmaField of Omega);
reserve P for (Probability of Sigma);
definition
let Omega;
let Sigma;
let P;
let X being (Real-Valued-Random-Variable of Sigma);
assume A1: (X is_integrable_on P & ( ( abs X ) to_power 2 ) is_integrable_on ( P2M P ));
func variance (X,P) -> (Element of ( REAL )) means 
:Def1: (ex Y being (Real-Valued-Random-Variable of Sigma) st (ex E being (Real-Valued-Random-Variable of Sigma) st ((((E = ( Omega --> ( expect (X,P) ) ) & Y = ( X - E )) & Y is_integrable_on P) & ( ( abs Y ) to_power 2 ) is_integrable_on ( P2M P )) & it = ( Integral (( P2M P ),( ( abs Y ) to_power 2 )) ))));
correctness
proof
consider S being (Element of Sigma) such that A2: (S = Omega & X is_measurable_on S) by RANDOM_1:def 2;
( ( P2M P ) . S ) <= 1 by PROB_1:35;
then A3: ( ( P2M P ) . S ) < ( +infty ) by XXREAL_0:2,XXREAL_0:9;
set r = ( expect (X,P) );
set E0 = ( Omega --> 1 );
set E = ( Omega --> ( expect (X,P) ) );
A4: (( dom E0 ) = Omega & ( rng E0 ) c= { 1 }) by FUNCOP_1:13;
reconsider E0 as (Real-Valued-Random-Variable of Sigma) by CKB6:1;
A5: ( R_EAL E0 ) = ( chi (S,Omega) ) by A2,CKB5:1;
A6: ( dom E ) = ( dom E0 ) by A4,FUNCT_2:def 1;
now
let x being set;
assume A7: x in ( dom E );
hence ( E . x ) = ( r * 1 ) by FUNCOP_1:7
.= ( r * ( E0 . x ) ) by A7,FUNCOP_1:7;
end;
then A8: E = ( r (#) E0 ) by A6,VALUED_1:def 5;
reconsider E as (Real-Valued-Random-Variable of Sigma) by CKB6:1;
set Y = ( X - E );
reconsider Y as (Real-Valued-Random-Variable of Sigma);
( chi (S,Omega) ) is_integrable_on ( P2M P ) by A3,MESFUNC7:24;
then A9: E0 is_integrable_on ( P2M P ) by A5,MESFUNC6:def 4;
then A10: ( r (#) E0 ) is_integrable_on ( P2M P ) by MESFUNC6:102;
A11: ( - 1 ) is Real by XREAL_0:def 1;
then A12: ( ( - 1 ) (#) ( r (#) E0 ) ) is_integrable_on ( P2M P ) by A10,MESFUNC6:102;
A13: X is_integrable_on ( P2M P ) by A1,RANDOM_1:def 3;
then Y is_integrable_on ( P2M P ) by A8,A12,MESFUNC6:100;
then A14: Y is_integrable_on P by RANDOM_1:def 3;
( ( 2 * r ) (#) X ) is_integrable_on ( P2M P ) by A13,MESFUNC6:102;
then ( ( - 1 ) (#) ( ( 2 * r ) (#) X ) ) is_integrable_on ( P2M P ) by A11,MESFUNC6:102;
then A15: ( ( ( abs X ) to_power 2 ) - ( ( 2 * r ) (#) X ) ) is_integrable_on ( P2M P ) by A1,MESFUNC6:100;
A16: ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) + ( ( r (#) E0 ) to_power 2 ) ) = ( ( ( X to_power 2 ) - ( ( 2 * r ) (#) X ) ) + ( ( r * r ) (#) E0 ) )
proof
A17: ( dom ( X to_power 2 ) ) = ( dom X ) by MESFUN6C:def 4;
A18: ( dom ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) = ( dom ( ( r (#) E0 ) (#) X ) ) by VALUED_1:def 5
.= ( ( dom ( r (#) E0 ) ) /\ ( dom X ) ) by VALUED_1:def 4
.= ( Omega /\ ( dom X ) ) by A4,VALUED_1:def 5;
A19: ( dom ( ( r (#) E0 ) to_power 2 ) ) = ( dom ( r (#) E0 ) ) by MESFUN6C:def 4
.= Omega by A4,VALUED_1:def 5;
A20: ( dom ( ( r * r ) (#) E0 ) ) = Omega by A4,VALUED_1:def 5;
A21: ( dom ( ( 2 * r ) (#) X ) ) = ( dom X ) by VALUED_1:def 5;
A22: ( dom ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) ) = ( ( dom X ) /\ ( Omega /\ ( dom X ) ) ) by A17,A18,VALUED_1:12
.= ( ( ( dom X ) /\ ( dom X ) ) /\ Omega ) by XBOOLE_1:16
.= ( ( dom X ) /\ Omega );
A23: ( dom ( ( X to_power 2 ) - ( ( 2 * r ) (#) X ) ) ) = ( ( dom ( X to_power 2 ) ) /\ ( dom ( ( 2 * r ) (#) X ) ) ) by VALUED_1:12
.= ( dom X ) by A17,A21;
A24: ( dom ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) + ( ( r (#) E0 ) to_power 2 ) ) ) = ( ( dom ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) ) /\ ( dom ( ( r (#) E0 ) to_power 2 ) ) ) by VALUED_1:def 1
.= ( ( dom X ) /\ ( Omega /\ Omega ) ) by A19,A22,XBOOLE_1:16
.= ( ( dom X ) /\ Omega );
then A25: ( dom ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) + ( ( r (#) E0 ) to_power 2 ) ) ) = ( dom ( ( ( X to_power 2 ) - ( ( 2 * r ) (#) X ) ) + ( ( r * r ) (#) E0 ) ) ) by A20,A23,VALUED_1:def 1;
(for x being (Element of Omega) holds (x in ( dom ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) + ( ( r (#) E0 ) to_power 2 ) ) ) implies ( ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) + ( ( r (#) E0 ) to_power 2 ) ) . x ) = ( ( ( ( X to_power 2 ) - ( ( 2 * r ) (#) X ) ) + ( ( r * r ) (#) E0 ) ) . x )))
proof
let x being (Element of Omega);
assume A26: x in ( dom ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) + ( ( r (#) E0 ) to_power 2 ) ) );
then A27: (x in ( dom X ) & x in Omega) by A24,XBOOLE_0:def 4;
A28: ( ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) + ( ( r (#) E0 ) to_power 2 ) ) . x ) = ( ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) . x ) + ( ( ( r (#) E0 ) to_power 2 ) . x ) ) by A26,VALUED_1:def 1
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 (#) ( ( r (#) E0 ) (#) X ) ) . x ) ) + ( ( ( r (#) E0 ) to_power 2 ) . x ) ) by A22,A24,A26,VALUED_1:13
.= ( ( ( ( X to_power 2 ) . x ) - ( 2 * ( ( ( r (#) E0 ) (#) X ) . x ) ) ) + ( ( ( r (#) E0 ) to_power 2 ) . x ) ) by VALUED_1:6
.= ( ( ( ( X to_power 2 ) . x ) - ( 2 * ( ( ( r (#) E0 ) . x ) * ( X . x ) ) ) ) + ( ( ( r (#) E0 ) to_power 2 ) . x ) ) by VALUED_1:5
.= ( ( ( ( X to_power 2 ) . x ) - ( 2 * ( ( r * ( E0 . x ) ) * ( X . x ) ) ) ) + ( ( ( r (#) E0 ) to_power 2 ) . x ) ) by VALUED_1:6
.= ( ( ( ( X to_power 2 ) . x ) - ( 2 * ( ( r * 1 ) * ( X . x ) ) ) ) + ( ( ( r (#) E0 ) to_power 2 ) . x ) ) by FUNCOP_1:7
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( ( ( r (#) E0 ) . x ) to_power 2 ) ) by A19,MESFUN6C:def 4
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( ( r * ( E0 . x ) ) to_power 2 ) ) by VALUED_1:6
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( ( r * 1 ) to_power 2 ) ) by FUNCOP_1:7
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( r ^2 ) ) by POWER:46
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( r * r ) );
( ( ( ( X to_power 2 ) - ( ( 2 * r ) (#) X ) ) + ( ( r * r ) (#) E0 ) ) . x ) = ( ( ( ( X to_power 2 ) - ( ( 2 * r ) (#) X ) ) . x ) + ( ( ( r * r ) (#) E0 ) . x ) ) by A26,A25,VALUED_1:def 1
.= ( ( ( ( X to_power 2 ) . x ) - ( ( ( 2 * r ) (#) X ) . x ) ) + ( ( ( r * r ) (#) E0 ) . x ) ) by A23,A27,VALUED_1:13
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( ( ( r * r ) (#) E0 ) . x ) ) by VALUED_1:6
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( ( r * r ) * ( E0 . x ) ) ) by VALUED_1:6
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( ( r * r ) * 1 ) ) by FUNCOP_1:7
.= ( ( ( ( X to_power 2 ) . x ) - ( ( 2 * r ) * ( X . x ) ) ) + ( r * r ) );
hence thesis by A28;
end;
hence thesis by A25,PARTFUN1:5;
end;
A29: ( ( abs Y ) to_power 2 ) = ( ( X - ( r (#) E0 ) ) to_power 2 ) by CKB7:1,A8
.= ( ( ( X to_power 2 ) - ( 2 (#) ( ( r (#) E0 ) (#) X ) ) ) + ( ( r (#) E0 ) to_power 2 ) ) by CKB8:1
.= ( ( ( ( abs X ) to_power 2 ) - ( ( 2 * r ) (#) X ) ) + ( ( r * r ) (#) E0 ) ) by CKB7:1,A16;
A30: ( ( r * r ) (#) E0 ) is_integrable_on ( P2M P ) by A9,MESFUNC6:102;
then ( ( abs Y ) to_power 2 ) is_integrable_on ( P2M P ) by A15,A29,MESFUNC6:100;
then (( -infty ) < ( Integral (( P2M P ),( ( abs Y ) to_power 2 )) ) & ( Integral (( P2M P ),( ( abs Y ) to_power 2 )) ) < ( +infty )) by MESFUNC6:90;
then ( Integral (( P2M P ),( ( abs Y ) to_power 2 )) ) is (Element of ( REAL )) by XXREAL_0:14;
hence thesis by A30,A15,A29,A14,MESFUNC6:100;
end;
end;
