environ
vocabularies FUNCT_1,COMPLEX1,RELAT_1,ZFMISC_1,XXREAL_0,PARTFUN1,ARYTM_1,XBOOLE_0,ORDINAL4,INT_1,SQUARE_1,ARYTM_3,RLVECT_1,SUPINF_2,RSSPACE,FUNCOP_1,FINSOP_1,NAT_1,FUNCT_4,BINOP_2,PROB_1,MEASURE6,MESFUNC1,TARSKI,MESFUNC5,IDEAL_1,SUBSET_1,RANDOM_1,RANDOM_2,C0SP1,FINSET_1,FINSEQ_1,ORDINAL2,RPR_1,CARD_1,SEQ_2,POWER,FUNCT_3,PROB_4,UPROOTS,FINSEQ_2,CARD_3,FUNCT_2,RFINSEQ,XREAL_0,FUNCSDOM,POLYALG1,BHSP_5,NUMBERS,REAL_1,INTEGRA5,VALUED_1,ORDINAL1,EQREL_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,FUNCT_4,FUNCOP_1,FINSEQ_1,ORDINAL1,REAL_1,NAT_1,CARD_1,FINSET_1,NUMBERS,XREAL_0,XXREAL_0,NAT_D,COMPLEX1,VALUED_1,RFINSEQ,FINSOP_1,STRUCT_0,ALGSTR_0,IDEAL_1,VECTSP_1,BINOP_1,BINOP_2,RLVECT_1,FUNCSDOM,SUPINF_2,SEQ_1,SEQ_2,SQUARE_1,GROUP_1,POWER,PROB_1,PROB_4,EXTREAL1,MESFUNC1,MEASURE6,MESFUNC5,MESFUNC6,MESFUNC2,RVSUM_1,UPROOTS,MESFUN6C,C0SP1,RANDOM_1,BHSP_5,CKB9;
definitions TARSKI,BINOP_1,STRUCT_0,ALGSTR_0,RLVECT_1,MEASURE6,MESFUNC5,FINSEQ_2,FINSEQ_1,PROB_4,FUNCSDOM,VALUED_1,BHSP_5,RVSUM_1,SQUARE_1,CKB9;
theorems FUNCT_1,FUNCT_2,PARTFUN1,COMPLEX1,XBOOLE_0,TARSKI,RELAT_1,VALUED_1,IDEAL_1,ZFMISC_1,RLVECT_1,FUNCOP_1,XBOOLE_1,MESFUNC2,EXTREAL1,MEASURE1,MESFUNC6,PROB_1,XXREAL_0,ABSVALUE,MESFUNC7,RELSET_1,XXREAL_3,XREAL_0,RANDOM_1,C0SP1,FINSEQ_4,POWER,BINOP_2,RFINSEQ,CARD_2,FINSEQ_1,FUNCT_4,FINSOP_1,NAT_1,NAT_2,NAT_D,INT_3,XREAL_1,SQUARE_1,FINSEQ_2,INT_1,FUNCT_3,CARD_1,FINSEQ_3,FINSEQ_5,UPROOTS,MESFUN6C,FUNCSDOM,BHSP_5,RVSUM_1,FIB_NUM3,SUBSET,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23;
schemes FINSEQ_1,FUNCT_2,NAT_1,FUNCT_3;
registrations XBOOLE_0,ORDINAL1,NUMBERS,XREAL_0,MEMBERED,VALUED_0,NAT_1,SUBSET_1,XCMPLX_0,RLVECT_1,XXREAL_0,MEASURE1,FINSEQ_1,RELAT_1,XXREAL_3,C0SP1,FUNCT_2,CARD_1,FINSET_1,BINOP_2,FUNCT_1,UPROOTS,MESFUN6C,FUNCSDOM,BHSP_5,RELSET_1,CKB3,CKB4;
constructors EXTREAL1,REAL_1,IDEAL_1,MEASURE6,MESFUNC2,MESFUNC5,SEQ_2,MESFUNC6,SEQ_1,SUPINF_1,REALSET1,RVSUM_1,MESFUNC1,RELSET_1,RANDOM_1,C0SP1,RFINSEQ,POWER,FINSOP_1,BINARITH,FINSEQOP,SEQ_4,CONVFUN1,SEQFUNC,SETWISEO,FINSEQ_4,PARTFUN3,PROB_4,WELLORD2,SQUARE_1,NAT_D,UPROOTS,MESFUN6C,BHSP_5,CKB9;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
theorem
Th15: (for Omega being non empty  finite set holds (for P being (Probability of ( Trivial-SigmaField Omega )) holds (for Y being non empty  finite (Subset of Omega) holds (for f being (Function of Omega,( REAL )) holds (ex G being (FinSequence of ( REAL )) st (ex s being (FinSequence of Y) st (((((( len G ) = ( card Y ) & s is  one-to-one) & ( rng s ) = Y) & ( len s ) = ( card Y )) & (for n being Nat holds (n in ( dom G ) implies ( G . n ) = ( ( f . ( s . n ) ) * ( P . { ( s . n ) } ) )))) & ( Integral (( P2M P ),( f | Y )) ) = ( Sum G ))))))))
proof
let Omega being non empty  finite set;
let P being (Probability of ( Trivial-SigmaField Omega ));
let Y being non empty  finite (Subset of Omega);
let f being (Function of Omega,( REAL ));
set YN = ( Omega \ Y );
A1: (( dom ( YN --> ( 0 ) ) ) = YN & ( rng ( YN --> ( 0 ) ) ) c= ( REAL )) by FUNCOP_1:13;
A2: ( dom ( f +* ( YN --> ( 0 ) ) ) ) = ( ( dom f ) \/ ( dom ( YN --> ( 0 ) ) ) ) by FUNCT_4:def 1
.= ( Omega \/ YN ) by A1,FUNCT_2:def 1
.= Omega by XBOOLE_1:12;
( rng ( f +* ( YN --> ( 0 ) ) ) ) c= ( REAL );
then reconsider g = ( f +* ( YN --> ( 0 ) ) ) as (Function of Omega,( REAL )) by A2,FUNCT_2:2;
consider G being (FinSequence of ( REAL )),s being (FinSequence of Omega) such that A3: (((((( len G ) = ( card Omega ) & s is  one-to-one) & ( rng s ) = Omega) & ( len s ) = ( card Omega )) & (for n being Nat holds (n in ( dom G ) implies ( G . n ) = ( ( g . ( s . n ) ) * ( P . { ( s . n ) } ) )))) & ( Integral (( P2M P ),g) ) = ( Sum G )) by RANDOM_1:13;
reconsider g as (Real-Valued-Random-Variable of ( Trivial-SigmaField Omega )) by RANDOM_1:29;
A4: ( dom g ) = Omega by FUNCT_2:def 1;
g is_integrable_on P by RANDOM_1:30;
then A5: g is_integrable_on ( P2M P ) by RANDOM_1:def 3;
A6: Y misses YN by XBOOLE_1:79;
A7: ( Integral (( P2M P ),( g | ( Y \/ YN ) )) ) = ( ( Integral (( P2M P ),( g | Y )) ) + ( Integral (( P2M P ),( g | YN )) ) ) by A5,MESFUNC6:92,XBOOLE_1:79;
( Y \/ YN ) = ( Y \/ Omega ) by XBOOLE_1:39
.= Omega by XBOOLE_1:12;
then A8: ( g | ( Y \/ YN ) ) = g by FUNCT_2:33;
A9: ( g | Y ) = ( f | Y ) by A1,A6,FUNCT_4:72;
A10: ( dom ( g | YN ) ) = YN by A4,RELAT_1:62;
A11: (for x being set holds (x in ( dom ( g | YN ) ) implies ( ( g | YN ) . x ) = ( 0 )))
proof
let x being set;
assume A12: x in ( dom ( g | YN ) );
then A13: (x in YN & ( ( g | YN ) . x ) = ( g . x )) by A4,FUNCT_1:47,RELAT_1:62;
( g . x ) = ( ( YN --> ( 0 ) ) . x ) by A12,A1,A10,FUNCT_4:13;
hence thesis by A13,FUNCOP_1:7;
end;
then ( Integral (( P2M P ),( g | YN )) ) = ( ( R_EAL ( 0 ) ) * ( ( P2M P ) . YN ) ) by A10,MESFUNC6:97
.= ( R_EAL ( 0 ) );
then A14: ( Integral (( P2M P ),g) ) = ( Integral (( P2M P ),( f | Y )) ) by A9,A7,A8,XXREAL_3:4;
set N1 = ( s " Y );
s is (Function of ( dom s ),( rng s )) by FUNCT_2:1;
then N1 is  finite  finite (Subset of ( dom s )) by FUNCT_2:39;
then reconsider N1 as  finite (Subset of ( Seg ( len G ) )) by A3,FINSEQ_1:def 3;
( rng ( canFS N1 ) ) c= N1 by FINSEQ_1:def 4;
then ( rng ( canFS N1 ) ) c= ( Seg ( len G ) ) by XBOOLE_1:1;
then A15: ( canFS N1 ) is (FinSequence of ( Seg ( len G ) )) by FINSEQ_1:def 4;
( dom s ) = ( Seg ( len G ) ) by A3,FINSEQ_1:def 3;
then A16: s is (Function of ( Seg ( len G ) ),Omega) by A3,FUNCT_2:1;
then reconsider t1 = ( s * ( canFS N1 ) ) as (FinSequence of Omega) by A15,FINSEQ_2:32;
A17: ( rng t1 ) = ( s .: ( rng ( canFS N1 ) ) ) by RELAT_1:127
.= ( s .: N1 ) by FUNCT_2:def 3
.= Y by A3,FUNCT_1:77;
set N2 = ( ( Seg ( len G ) ) \ N1 );
reconsider N2 as  finite (Subset of ( Seg ( len G ) )) by XBOOLE_1:36;
( rng ( canFS N2 ) ) c= N2 by FINSEQ_1:def 4;
then ( rng ( canFS N2 ) ) c= ( Seg ( len G ) ) by XBOOLE_1:1;
then ( canFS N2 ) is (FinSequence of ( Seg ( len G ) )) by FINSEQ_1:def 4;
then reconsider t2 = ( s * ( canFS N2 ) ) as (FinSequence of Omega) by A16,FINSEQ_2:32;
reconsider t = ( t1 ^ t2 ) as (FinSequence of Omega);
A18: ( rng ( canFS N1 ) ) = N1 by FUNCT_2:def 3;
A19: ( rng ( canFS N2 ) ) = N2 by FUNCT_2:def 3;
A20: (N1 is  finite  finite (Subset of ( dom s )) & N2 is  finite  finite (Subset of ( dom s ))) by A3,FINSEQ_1:def 3;
then ( rng ( s | N1 ) ) misses ( rng ( s | N2 ) ) by CKB1:1,A3,XBOOLE_1:79;
then ( rng t1 ) misses ( rng ( s | N2 ) ) by A18,CKB2:1,XBOOLE_1:63;
then A21: ( rng t1 ) misses ( rng t2 ) by A19,CKB2:1,XBOOLE_1:63;
then A22: t is  one-to-one by A3,FINSEQ_3:91;
( len ( canFS N1 ) ) = ( card N1 ) by UPROOTS:3;
then A23: ( dom ( canFS N1 ) ) = ( Seg ( card N1 ) ) by FINSEQ_1:def 3;
( rng ( canFS N1 ) ) is (Subset of ( dom s )) by A20,FUNCT_2:def 3;
then ( dom t1 ) = ( Seg ( card N1 ) ) by A23,RELAT_1:27;
then A24: ( len t1 ) = ( card N1 ) by FINSEQ_1:def 3;
( len ( canFS N2 ) ) = ( card N2 ) by UPROOTS:3;
then A25: ( dom ( canFS N2 ) ) = ( Seg ( card N2 ) ) by FINSEQ_1:def 3;
( rng ( canFS N2 ) ) is (Subset of ( dom s )) by A20,FUNCT_2:def 3;
then ( dom t2 ) = ( Seg ( card N2 ) ) by A25,RELAT_1:27;
then A26: ( len t2 ) = ( card N2 ) by FINSEQ_1:def 3;
A27: ( N1 \/ N2 ) = ( ( Seg ( len G ) ) \/ N1 ) by XBOOLE_1:39
.= ( Seg ( len G ) ) by XBOOLE_1:12
.= ( dom s ) by A3,FINSEQ_1:def 3;
( dom t ) = ( Seg ( ( len t1 ) + ( len t2 ) ) ) by FINSEQ_1:def 7
.= ( Seg ( card ( N1 \/ N2 ) ) ) by A24,A26,CARD_2:40,XBOOLE_1:79;
then A28: ( len t ) = ( card ( N1 \/ N2 ) ) by FINSEQ_1:def 3;
then A29: ( len t ) = ( len s ) by A27,CARD_1:62;
A30: ( Seg ( len s ) ) = ( Seg ( len t ) ) by A28,A27,CARD_1:62;
A31: ( dom s ) = ( Seg ( len s ) ) by FINSEQ_1:def 3
.= ( dom t ) by A30,FINSEQ_1:def 3;
A32: ( card ( dom t ) ) = ( card Omega ) by A3,A29,CARD_1:62;
t is (Function of ( dom t ),Omega) by FINSEQ_2:26;
then ( rng s ) = ( rng t ) by A3,A22,A32,FINSEQ_4:63;
then consider PN being (Permutation of ( dom s )) such that A33: ((t = ( s * PN ) & ( dom PN ) = ( dom s )) & ( rng PN ) = ( dom s )) by A3,A22,BHSP_5:1;
defpred FF1[ set,set ]
 means
((( t . $1 ) in Y implies $2 = ( ( f . ( t . $1 ) ) * ( P . { ( t . $1 ) } ) )) & ((not ( t . $1 ) in Y) implies $2 = ( ( g . ( t . $1 ) ) * ( P . { ( t . $1 ) } ) )));
A34:now
let k being Nat;
assume k in ( Seg ( card Omega ) );
now
per cases ;
suppose ( t . k ) in Y;

hence (ex x being (Element of ( REAL )) st FF1[ k,x ]);
end;
suppose (not ( t . k ) in Y);

hence (ex x being (Element of ( REAL )) st FF1[ k,x ]);
end;
end;
hence (ex x being (Element of ( REAL )) st FF1[ k,x ]);
end;
consider F being (FinSequence of ( REAL )) such that A35: ( dom F ) = ( Seg ( card Omega ) ) and A36: (for n being Nat holds (n in ( Seg ( card Omega ) ) implies FF1[ n,( F . n ) ])) from FINSEQ_1:sch 5(A34);
A37: ( dom s ) = ( Seg ( len G ) ) by A3,FINSEQ_1:def 3
.= ( dom G ) by FINSEQ_1:def 3;
then A38: ( dom ( G * PN ) ) = ( dom PN ) by A33,RELAT_1:27;
A39: ( dom F ) = ( dom s ) by A3,A35,FINSEQ_1:def 3;
now
let x being set;
assume A40: x in ( dom F );
then reconsider nx = x as (Element of ( NAT ));
A41: nx in ( dom t ) by A40,A3,A35,A31,FINSEQ_1:def 3;
A42: ( t . nx ) = ( s . ( PN . nx ) ) by A33,A40,A39,A31,FUNCT_1:12;
( PN . nx ) in ( dom G ) by A37,A41,A33,FUNCT_1:11;
then A43: ( G . ( PN . nx ) ) = ( ( g . ( s . ( PN . nx ) ) ) * ( P . { ( s . ( PN . nx ) ) } ) ) by A3;
now
per cases ;
suppose A44: ( t . nx ) in Y;

hence ( F . nx ) = ( ( f . ( t . nx ) ) * ( P . { ( t . nx ) } ) ) by A36,A35,A40
.= ( ( ( f | Y ) . ( s . ( PN . nx ) ) ) * ( P . { ( s . ( PN . nx ) ) } ) ) by A42,A44,FUNCT_1:49
.= ( ( g . ( s . ( PN . nx ) ) ) * ( P . { ( s . ( PN . nx ) ) } ) ) by A44,A42,A9,FUNCT_1:49
.= ( ( G * PN ) . nx ) by A39,A40,A33,A43,FUNCT_1:13;
end;
suppose (not ( t . nx ) in Y);

hence ( F . nx ) = ( ( g . ( s . ( PN . nx ) ) ) * ( P . { ( s . ( PN . nx ) ) } ) ) by A42,A36,A35,A40
.= ( ( G * PN ) . nx ) by A39,A40,A33,A43,FUNCT_1:13;
end;
end;
hence ( F . x ) = ( ( G * PN ) . x );
end;
then F = ( G * PN ) by A33,A38,A39,FUNCT_1:2;
then A45: ( Sum G ) = ( Sum F ) by A37,FINSOP_1:7;
reconsider t1 as (FinSequence of Y) by A17,FINSEQ_1:def 4;
reconsider F1 = ( F | ( len t1 ) ) as (FinSequence of ( REAL ));
reconsider F2 = ( F /^ ( len t1 ) ) as (FinSequence of ( REAL ));
A46: F = ( F1 ^ F2 ) by RFINSEQ:8;
A47: ( len t1 ) = ( card Y ) by A17,A3,FINSEQ_4:62;
A48: ( len F ) = ( card Omega ) by A35,FINSEQ_1:def 3;
A49: ( len F ) = ( len t ) by A29,A3,A35,FINSEQ_1:def 3;
A50: ( len t ) = ( ( len t1 ) + ( len t2 ) ) by FINSEQ_1:22;
then A51: ( len t1 ) <= ( len t ) by NAT_1:11;
then A52: ( len F2 ) = ( ( len F ) - ( len t1 ) ) by A49,RFINSEQ:def 1
.= ( len t2 ) by A50,A49;
then A53: ( dom F2 ) = ( Seg ( len t2 ) ) by FINSEQ_1:def 3
.= ( dom ( ( len t2 ) |-> ( 0 ) ) ) by FUNCOP_1:13;
now
let m being Nat;
assume A54: m in ( dom F2 );
then A55: m in ( Seg ( len t2 ) ) by A52,FINSEQ_1:def 3;
then A56: m in ( dom t2 ) by FINSEQ_1:def 3;
A57: (1 <= m & m <= ( len t2 )) by A55,FINSEQ_1:1;
m <= ( m + ( len t1 ) ) by NAT_1:11;
then (1 <= ( m + ( len t1 ) ) & ( m + ( len t1 ) ) <= ( len t )) by A50,A57,XREAL_1:6,XXREAL_0:2;
then A58: ( m + ( len t1 ) ) in ( Seg ( card Omega ) ) by A3,A29;
A59: ( t . ( m + ( len t1 ) ) ) = ( t2 . m ) by A56,FINSEQ_1:def 7;
A60: ( ( rng t1 ) /\ ( rng t2 ) ) = ( {} ) by A21,XBOOLE_0:def 7;
A61: ( t2 . m ) in ( rng t2 ) by A56,FUNCT_1:3;
then (not ( t2 . m ) in ( rng t1 )) by A60,XBOOLE_0:def 4;
then A62: ( t2 . m ) in ( dom ( g | YN ) ) by A10,A17,A61,XBOOLE_0:def 5;
then A63: ( g . ( t2 . m ) ) = ( ( g | YN ) . ( t2 . m ) ) by FUNCT_1:47
.= ( 0 ) by A11,A62;
(not ( t . ( m + ( len t1 ) ) ) in Y) by A17,A60,A61,A59,XBOOLE_0:def 4;
then A64: ( F . ( m + ( len t1 ) ) ) = ( ( g . ( t . ( m + ( len t1 ) ) ) ) * ( P . { ( t . ( m + ( len t1 ) ) ) } ) ) by A36,A58
.= ( 0 ) by A63,A59;
thus ( F2 . m ) = ( F . ( m + ( len t1 ) ) ) by A49,A51,A54,RFINSEQ:def 1
.= ( ( ( len t2 ) |-> ( 0 ) ) . m ) by A55,A64,FINSEQ_2:57;
end;
then A65: F2 = ( ( len t2 ) |-> ( 0 ) ) by A53,FINSEQ_1:13;
( card Y ) c= ( card Omega ) by CARD_1:11;
then A66: ( card Y ) <= ( card Omega ) by NAT_1:39;
A67: ( Sum F ) = ( ( Sum F1 ) + ( Sum F2 ) ) by A46,RVSUM_1:75
.= ( ( Sum F1 ) + ( 0 ) ) by A65,RVSUM_1:81
.= ( Sum F1 );
A68: ( len F1 ) = ( card Y ) by A48,A47,A66,FINSEQ_1:59;
(for n being Nat holds (n in ( dom F1 ) implies ( F1 . n ) = ( ( f . ( t1 . n ) ) * ( P . { ( t1 . n ) } ) )))
proof
let n being Nat;
assume n in ( dom F1 );
then A69: n in ( Seg ( len t1 ) ) by A68,A47,FINSEQ_1:def 3;
then A70: n in ( dom t1 ) by FINSEQ_1:def 3;
then A71: ( t . n ) = ( t1 . n ) by FINSEQ_1:def 7;
then A72: ( t . n ) in Y by A17,A70,FUNCT_1:3;
A73: ( Seg ( len t1 ) ) c= ( Seg ( card Omega ) ) by A47,A66,FINSEQ_1:5;
thus ( F1 . n ) = ( F . n ) by A69,FUNCT_1:49
.= ( ( f . ( t1 . n ) ) * ( P . { ( t1 . n ) } ) ) by A71,A73,A69,A36,A72;
end;
hence thesis by A68,A47,A17,A67,A45,A3,A14;
end;
