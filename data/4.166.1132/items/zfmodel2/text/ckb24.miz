environ
vocabularies NUMBERS,ZF_LANG,XBOOLE_0,SUBSET_1,FUNCT_1,ZF_MODEL,ARYTM_3,TARSKI,XBOOLEAN,BVFUNC_2,ZF_LANG1,FINSET_1,RELAT_1,CARD_1,XXREAL_0,ZFMODEL1;
notations TARSKI,XBOOLE_0,ENUMSET1,SUBSET_1,NUMBERS,NAT_1,RELAT_1,FUNCT_1,FINSET_1,PARTFUN1,FUNCT_2,ZF_LANG,ZF_MODEL,ZFMODEL1,ZF_LANG1,XXREAL_0;
definitions TARSKI,ZF_MODEL,ZFMODEL1,XBOOLE_0,FUNCT_2;
theorems TARSKI,ZFMISC_1,ENUMSET1,NAT_1,FUNCT_1,FUNCT_2,ZF_MODEL,ZFMODEL1,ZF_LANG1,RELSET_1,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,FUNCT_7,CKB1,CKB2,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23;
schemes NAT_1,PARTFUN1,ZF_LANG1;
registrations FUNCT_1,RELSET_1,FUNCT_2,FINSET_1,XXREAL_0,XREAL_0,FINSEQ_1,ZF_LANG,ORDINAL1,CKB3;
constructors ENUMSET1,PARTFUN1,XXREAL_0,XREAL_0,NAT_1,ZF_MODEL,ZFMODEL1,ZF_LANG1,RELSET_1;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
reserve M for non empty set;
reserve a for set;
reserve b for set;
reserve m for (Element of M);
reserve m1 for (Element of M);
reserve m2 for (Element of M);
reserve m3 for (Element of M);
reserve m4 for (Element of M);
reserve H for ZF-formula;
reserve H1 for ZF-formula;
reserve H2 for ZF-formula;
reserve v for (Function of ( VAR ),M);
reserve F for Function;
reserve G for Function;
theorem
(((F is_definable_in M & G is_definable_in M) & ( Free H ) c= { ( x. 3 ) }) implies (for FG being Function holds ((( dom FG ) = M & (for v holds ((M,v |= H implies ( FG . ( v . ( x. 3 ) ) ) = ( F . ( v . ( x. 3 ) ) )) & (M,v |= ( 'not' H ) implies ( FG . ( v . ( x. 3 ) ) ) = ( G . ( v . ( x. 3 ) ) ))))) implies FG is_definable_in M)))
proof
A1: { ( x. 3 ),( x. 3 ),( x. 4 ) } = { ( x. 3 ),( x. 4 ) } by ENUMSET1:30;
A2: ( { ( x. 3 ) } \/ { ( x. 3 ),( x. 4 ) } ) = { ( x. 3 ),( x. 3 ),( x. 4 ) } by ENUMSET1:2;
given H1 such that
A3: ( Free H1 ) c= { ( x. 3 ),( x. 4 ) }
and
A4: M |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( H1 <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) )
and
A5: F = ( def_func (H1,M) );

given H2 such that
A6: ( Free H2 ) c= { ( x. 3 ),( x. 4 ) }
and
A7: M |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( H2 <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) )
and
A8: G = ( def_func (H2,M) );

assume A9: ( Free H ) c= { ( x. 3 ) };
then A10: (not ( x. 4 ) in ( Free H )) by CKB14:1,TARSKI:def 1;
let FG being Function;
assume that
A11: ( dom FG ) = M
and
A12: (for v holds ((M,v |= H implies ( FG . ( v . ( x. 3 ) ) ) = ( F . ( v . ( x. 3 ) ) )) & (M,v |= ( 'not' H ) implies ( FG . ( v . ( x. 3 ) ) ) = ( G . ( v . ( x. 3 ) ) ))));
( rng FG ) c= M
proof
set v = the (Function of ( VAR ),M);
let a;
assume a in ( rng FG );
then consider b such that A13: b in M and A14: a = ( FG . b ) by A11,FUNCT_1:def 3;
reconsider b as (Element of M) by A13;
A15: (M,( v / (( x. 3 ),b) ) |= H or M,( v / (( x. 3 ),b) ) |= ( 'not' H )) by ZF_MODEL:14;
( ( v / (( x. 3 ),b) ) . ( x. 3 ) ) = b by FUNCT_7:128;
then (( FG . b ) = ( ( def_func (H1,M) ) . b ) or ( FG . b ) = ( ( def_func (H2,M) ) . b )) by A5,A8,A12,A15;
hence thesis by A14;
end;
then reconsider f = FG as (Function of M,M) by A11,FUNCT_2:def 1,RELSET_1:4;
take I = ( ( H '&' H1 ) 'or' ( ( 'not' H ) '&' H2 ) );
A16: ( Free ( 'not' H ) ) = ( Free H ) by ZF_LANG1:60;
( Free ( H '&' H1 ) ) = ( ( Free H ) \/ ( Free H1 ) ) by ZF_LANG1:61;
then A17: ( Free ( H '&' H1 ) ) c= { ( x. 3 ),( x. 4 ) } by A3,A9,A2,A1,XBOOLE_1:13;
A18: (not ( x. ( 0 ) ) in ( Free H2 )) by A6,CKB12:1,CKB13:1,TARSKI:def 2;
A19: (not ( x. ( 0 ) ) in ( Free H1 )) by A3,CKB12:1,CKB13:1,TARSKI:def 2;
( Free ( ( 'not' H ) '&' H2 ) ) = ( ( Free ( 'not' H ) ) \/ ( Free H2 ) ) by ZF_LANG1:61;
then A20: ( Free ( ( 'not' H ) '&' H2 ) ) c= { ( x. 3 ),( x. 4 ) } by A6,A9,A16,A2,A1,XBOOLE_1:13;
A21: ( Free I ) = ( ( Free ( H '&' H1 ) ) \/ ( Free ( ( 'not' H ) '&' H2 ) ) ) by ZF_LANG1:63;
hence ( Free I ) c= { ( x. 3 ),( x. 4 ) } by A17,A20,XBOOLE_1:8;
then A22: (not ( x. ( 0 ) ) in ( Free I )) by CKB12:1,CKB13:1,TARSKI:def 2;
A23:now
let v;
now
let m3;
M,v |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( H1 <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) ) by A4,ZF_MODEL:def 5;
then consider m1 such that A24: (M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= H1 iff m4 = m1) by A19,CKB23:1;
M,v |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( H2 <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) ) by A7,ZF_MODEL:def 5;
then consider m2 such that A25: (M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= H2 iff m4 = m2) by A18,CKB23:1;
(((not M,( v / (( x. 3 ),m3) ) |= ( 'not' H )) & M,( v / (( x. 3 ),m3) ) |= H) or (M,( v / (( x. 3 ),m3) ) |= ( 'not' H ) & (not M,( v / (( x. 3 ),m3) ) |= H))) by ZF_MODEL:14;
then consider m such that A26: ((((not M,( v / (( x. 3 ),m3) ) |= ( 'not' H )) & M,( v / (( x. 3 ),m3) ) |= H) & m = m1) or ((M,( v / (( x. 3 ),m3) ) |= ( 'not' H ) & m = m2) & (not M,( v / (( x. 3 ),m3) ) |= H)));
take m;
let m4;
thus (M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= I implies m4 = m)
proof
assume M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= I;
then (M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= ( H '&' H1 ) or M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= ( ( 'not' H ) '&' H2 )) by ZF_MODEL:17;
then ((M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= H & M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= H1) or (M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= ( 'not' H ) & M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= H2)) by ZF_MODEL:15;
hence thesis by A10,A16,A24,A25,A26,CKB10:1;
end;

assume m4 = m;
then ((M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= H & M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= H1) or (M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= ( 'not' H ) & M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= H2)) by A10,A16,A24,A25,A26,CKB10:1;
then (M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= ( H '&' H1 ) or M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= ( ( 'not' H ) '&' H2 )) by ZF_MODEL:15;
hence M,( ( v / (( x. 3 ),m3) ) / (( x. 4 ),m4) ) |= I by ZF_MODEL:17;
end;
hence M,v |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( I <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) ) by A22,CKB23:1;
end;
hence A27: M |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( I <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) ) by ZF_MODEL:def 5;
now
set v = the (Function of ( VAR ),M);
let a being (Element of M);
set m4 = ( ( def_func (I,M) ) . a );
A28: M,v |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( I <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) ) by A23;
( def_func (I,M) ) = ( def_func' (I,v) ) by A21,A17,A20,A27,CKB15:1,XBOOLE_1:8;
then M,( ( v / (( x. 3 ),a) ) / (( x. 4 ),m4) ) |= I by A22,A28,CKB11:1;
then (M,( ( v / (( x. 3 ),a) ) / (( x. 4 ),m4) ) |= ( H '&' H1 ) or M,( ( v / (( x. 3 ),a) ) / (( x. 4 ),m4) ) |= ( ( 'not' H ) '&' H2 )) by ZF_MODEL:17;
then ((((M,( ( v / (( x. 3 ),a) ) / (( x. 4 ),m4) ) |= H & M,( ( v / (( x. 3 ),a) ) / (( x. 4 ),m4) ) |= H1) & M,v |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( H1 <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) )) & ( def_func (H1,M) ) = ( def_func' (H1,v) )) or (((M,( ( v / (( x. 3 ),a) ) / (( x. 4 ),m4) ) |= ( 'not' H ) & M,( ( v / (( x. 3 ),a) ) / (( x. 4 ),m4) ) |= H2) & M,v |= ( All (( x. 3 ),( Ex (( x. ( 0 ) ),( All (( x. 4 ),( H2 <=> ( ( x. 4 ) '=' ( x. ( 0 ) ) ) )) )) )) )) & ( def_func (H2,M) ) = ( def_func' (H2,v) ))) by A3,A4,A6,A7,CKB15:1,ZF_MODEL:15,ZF_MODEL:def 5;
then A29: ((M,( v / (( x. 3 ),a) ) |= H & m4 = ( F . a )) or (M,( v / (( x. 3 ),a) ) |= ( 'not' H ) & m4 = ( G . a ))) by A5,A8,A10,A16,A19,A18,CKB10:1,CKB11:1;
( ( v / (( x. 3 ),a) ) . ( x. 3 ) ) = a by FUNCT_7:128;
hence ( f . a ) = ( ( def_func (I,M) ) . a ) by A12,A29;
end;
hence thesis by FUNCT_2:63;
end;
