environ
vocabularies UNIALG_1,SUBSET_1,NUMBERS,UNIALG_2,XBOOLE_0,FINSEQ_1,FUNCT_1,RELAT_1,NAT_1,TARSKI,STRUCT_0,PARTFUN1,MSUALG_3,CQC_SIM1,WELLORD1,FINSEQ_2,GROUP_6,EQREL_1,FUNCT_2,CARD_3,RELAT_2,ALG_1,CARD_1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,NAT_1,RELAT_1,RELAT_2,FUNCT_1,RELSET_1,FINSEQ_1,PARTFUN1,EQREL_1,FINSEQ_2,FUNCT_2,STRUCT_0,MARGREL1,UNIALG_1,FINSEQOP,FINSEQ_3,UNIALG_2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB20,CKB23,CKB24,CKB25;
definitions UNIALG_2,RELAT_2,TARSKI,FUNCT_1,XBOOLE_0,FUNCT_2,MARGREL1,FINSEQ_3,CKB5,CKB6,CKB7,CKB8,CKB9,CKB20,CKB25;
theorems FINSEQ_1,FINSEQ_2,FUNCT_1,FUNCT_2,PARTFUN1,UNIALG_1,UNIALG_2,RELAT_1,RELSET_1,EQREL_1,ZFMISC_1,FINSEQ_3,XBOOLE_0,RELAT_2,ORDERS_1,MARGREL1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB25;
schemes FINSEQ_1,RELSET_1,FUNCT_2,FUNCT_1;
registrations RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,EQREL_1,FINSEQ_2,STRUCT_0,UNIALG_1,UNIALG_2,ORDINAL1,FINSEQ_1,CARD_1,RELSET_1,MARGREL1,XBOOLE_0;
constructors EQREL_1,FINSEQOP,UNIALG_2,RELSET_1,CARD_3,FINSEQ_3,CARD_1,NAT_1,CKB5,CKB6,CKB7,CKB8,CKB9,CKB20,CKB25;
requirements BOOLE,SUBSET;
begin
reserve U1 for Universal_Algebra;
reserve m for (Element of ( NAT ));
reserve x for set;
reserve y for set;
reserve a for (FinSequence of U1);
reserve E for (Congruence of U1);
definition
let U1 being Universal_Algebra;
let E being (Congruence of U1);
let o being (operation of U1);
func QuotOp (o,E) ->  homogeneous  quasi_total non  empty (PartFunc of ( ( Class E ) * ),( Class E )) means 
:Def12: (( dom it ) = ( ( arity o ) -tuples_on ( Class E ) ) & (for y being (FinSequence of ( Class E )) holds (y in ( dom it ) implies (for x being (FinSequence of (the carrier of U1)) holds (x is_representatives_FS y implies ( it . y ) = ( Class (E,( o . x )) ))))));
existence
proof
defpred P[ set,set ]
 means
(for y being (FinSequence of ( Class E )) holds (y = $1 implies (for x being (FinSequence of (the carrier of U1)) holds (x is_representatives_FS y implies $2 = ( Class (E,( o . x )) )))));
set X = ( ( arity o ) -tuples_on ( Class E ) );
A1: (for e being set holds (e in X implies (ex u being set st (u in ( Class E ) & P[ e,u ]))))
proof
let e being set;
A2: ( dom o ) = ( ( arity o ) -tuples_on (the carrier of U1) ) by MARGREL1:22
.= { q where q is (Element of ( (the carrier of U1) * )): ( len q ) = ( arity o ) } by FINSEQ_2:def 4;
assume e in X;
then e in { s where s is (Element of ( ( Class E ) * )): ( len s ) = ( arity o ) } by FINSEQ_2:def 4;
then consider s being (Element of ( ( Class E ) * )) such that A3: s = e and A4: ( len s ) = ( arity o );
consider x being (FinSequence of (the carrier of U1)) such that A5: x is_representatives_FS s by FINSEQ_3:122;
take y = ( Class (E,( o . x )) );
A6: ( len x ) = ( arity o ) by A4,A5,FINSEQ_3:def 4;
x is (Element of ( (the carrier of U1) * )) by FINSEQ_1:def 11;
then A7: x in ( dom o ) by A2,A6;
then A8: ( o . x ) in ( rng o ) by FUNCT_1:def 3;
hence y in ( Class E ) by EQREL_1:def 3;
let a being (FinSequence of ( Class E ));
assume A9: a = e;
let b being (FinSequence of (the carrier of U1));
assume A10: b is_representatives_FS a;
then A11: ( len b ) = ( arity o ) by A3,A4,A9,FINSEQ_3:def 4;
(for m holds (m in ( dom x ) implies [ ( x . m ),( b . m ) ] in E))
proof
let m;
assume A12: m in ( dom x );
then A13: (( Class (E,( x . m )) ) = ( s . m ) & ( x . m ) in ( rng x )) by A5,FINSEQ_3:def 4,FUNCT_1:def 3;
( dom x ) = ( Seg ( arity o ) ) by A6,FINSEQ_1:def 3
.= ( dom b ) by A11,FINSEQ_1:def 3;
then ( Class (E,( b . m )) ) = ( s . m ) by A3,A9,A10,A12,FINSEQ_3:def 4;
hence thesis by A13,EQREL_1:35;
end;
then A14: [ x,b ] in ( ExtendRel E ) by A6,A11,FINSEQ_3:def 3;
b is (Element of ( (the carrier of U1) * )) by FINSEQ_1:def 11;
then ((ex n being Nat st (n in ( dom (the charact of U1) ) & ( (the charact of U1) . n ) = o)) & b in ( dom o )) by A2,A11,FINSEQ_2:10;
then [ ( o . x ),( o . b ) ] in E by A7,A14,CKB25:def 1;
hence thesis by A8,EQREL_1:35;
end;
consider F being Function such that A15: ((( dom F ) = X & ( rng F ) c= ( Class E )) & (for e being set holds (e in X implies P[ e,( F . e ) ]))) from FUNCT_1:sch 5(A1);
X in { ( m -tuples_on ( Class E ) ): (not contradiction) };
then X c= ( union { ( m -tuples_on ( Class E ) ): (not contradiction) } ) by ZFMISC_1:74;
then X c= ( ( Class E ) * ) by FINSEQ_2:108;
then reconsider F as (PartFunc of ( ( Class E ) * ),( Class E )) by A15,RELSET_1:4;
A16: ( dom F ) = { t where t is (Element of ( ( Class E ) * )): ( len t ) = ( arity o ) } by A15,FINSEQ_2:def 4;
A17: (for x,y being (FinSequence of ( Class E )) holds ((( len x ) = ( len y ) & x in ( dom F )) implies y in ( dom F )))
proof
let x being (FinSequence of ( Class E ));
let y being (FinSequence of ( Class E ));
assume that
A18: ( len x ) = ( len y )
and
A19: x in ( dom F );
A20: y is (Element of ( ( Class E ) * )) by FINSEQ_1:def 11;
(ex t1 being (Element of ( ( Class E ) * )) st (x = t1 & ( len t1 ) = ( arity o ))) by A16,A19;
hence thesis by A16,A18,A20;
end;
A21: (ex x being FinSequence st x in ( dom F ))
proof
set a = the (Element of X);
a in X;
hence (ex x being FinSequence st x in ( dom F )) by A15;
end;
( dom F ) is  with_common_domain
proof
let x being FinSequence;
let y being FinSequence;
assume (x in ( dom F ) & y in ( dom F ));
then ((ex t1 being (Element of ( ( Class E ) * )) st (x = t1 & ( len t1 ) = ( arity o ))) & (ex t2 being (Element of ( ( Class E ) * )) st (y = t2 & ( len t2 ) = ( arity o )))) by A16;
hence thesis;
end;
then reconsider F as  homogeneous  quasi_total non  empty (PartFunc of ( ( Class E ) * ),( Class E )) by A17,A21,MARGREL1:def 21,MARGREL1:def 22;
take F;
thus ( dom F ) = ( ( arity o ) -tuples_on ( Class E ) ) by A15;
let y being (FinSequence of ( Class E ));
assume A22: y in ( dom F );
let x being (FinSequence of (the carrier of U1));
assume x is_representatives_FS y;
hence thesis by A15,A22;
end;
uniqueness
proof
let F being  homogeneous  quasi_total non  empty (PartFunc of ( ( Class E ) * ),( Class E ));
let G being  homogeneous  quasi_total non  empty (PartFunc of ( ( Class E ) * ),( Class E ));
assume that
A23: ( dom F ) = ( ( arity o ) -tuples_on ( Class E ) )
and
A24: (for y being (FinSequence of ( Class E )) holds (y in ( dom F ) implies (for x being (FinSequence of (the carrier of U1)) holds (x is_representatives_FS y implies ( F . y ) = ( Class (E,( o . x )) )))))
and
A25: ( dom G ) = ( ( arity o ) -tuples_on ( Class E ) )
and
A26: (for y being (FinSequence of ( Class E )) holds (y in ( dom G ) implies (for x being (FinSequence of (the carrier of U1)) holds (x is_representatives_FS y implies ( G . y ) = ( Class (E,( o . x )) )))));
(for a being set holds (a in ( dom F ) implies ( F . a ) = ( G . a )))
proof
let a being set;
assume A27: a in ( dom F );
then reconsider b = a as (FinSequence of ( Class E )) by FINSEQ_1:def 11;
consider x being (FinSequence of (the carrier of U1)) such that A28: x is_representatives_FS b by FINSEQ_3:122;
( F . b ) = ( Class (E,( o . x )) ) by A24,A27,A28;
hence thesis by A23,A25,A26,A27,A28;
end;
hence thesis by A23,A25,FUNCT_1:2;
end;
end;
