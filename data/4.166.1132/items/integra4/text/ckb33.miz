environ
vocabularies NUMBERS,SUBSET_1,REAL_1,INTEGRA1,XBOOLE_0,MEASURE7,CARD_1,FINSEQ_1,RELAT_1,XXREAL_0,FUNCT_1,SEQ_4,ARYTM_3,ARYTM_1,FUNCT_3,TARSKI,PARTFUN1,CARD_3,VALUED_1,XXREAL_2,XXREAL_1,INTEGRA2,SEQ_2,ORDINAL2,FINSET_1,NAT_1,FINSEQ_2,VALUED_0,FDIFF_1,XREAL_0,ORDINAL1,COMPLEX1,INT_1,ZFMISC_1,RFUNCT_3,SEQ_1,ORDINAL4,SQUARE_1,INTEGRA4,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,INT_1,XXREAL_2,VALUED_0,ZFMISC_1,FUNCT_1,RELSET_1,FINSET_1,FUNCT_2,FINSEQ_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQ_2,SEQ_2,SEQ_4,RCOMP_1,FDIFF_1,SQUARE_1,RVSUM_1,MEASURE5,INTEGRA1,INTEGRA2,INTEGRA3,RFUNCT_3,PARTFUN1,XXREAL_0,CKB13;
definitions TARSKI,SQUARE_1,RVSUM_1,FINSEQ_2,VALUED_1,XXREAL_2,CKB13;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,TARSKI,FINSEQ_3,INTEGRA2,INTEGRA3,SEQM_3,PARTFUN2,NAT_2,INT_1,FINSEQ_2,RFUNCT_3,RELAT_1,XREAL_0,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_0,XCMPLX_1,XREAL_1,COMPLEX1,XXREAL_0,FINSOP_1,FUNCOP_1,VALUED_1,XXREAL_2,VALUED_0,ORDINAL1,RELSET_1,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32;
schemes FINSEQ_2,FUNCT_2;
registrations XBOOLE_0,RELAT_1,ORDINAL1,FUNCT_2,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,FINSEQ_2,INTEGRA1,VALUED_0,VALUED_1,XXREAL_2,CARD_1,SEQ_2,SEQ_4,RELSET_1,SEQM_3,MEASURE5;
constructors REAL_1,SQUARE_1,NAT_1,BINOP_2,COMPLEX1,FINSEQOP,FINSOP_1,PARTFUN2,FDIFF_1,ZFMISC_1,RFUNCT_3,INTEGRA2,SEQ_1,XXREAL_2,RVSUM_1,SEQ_4,RELSET_1,SEQ_2,INTEGRA3,CKB13;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve j for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve a for Real;
reserve r for Real;
reserve x for Real;
reserve y for Real;
reserve A for non  empty  closed_interval (Subset of ( REAL ));
theorem
Th27: (for f,g being (Function of A,( REAL )) holds (((((( f | A ) is  bounded & f is  integrable) & ( g | A ) is  bounded) & a > ( 0 )) & (for x holds (for y holds ((x in A & y in A) implies ( abs ( ( g . x ) - ( g . y ) ) ) <= ( a * ( abs ( ( f . x ) - ( f . y ) ) ) ))))) implies g is  integrable))
proof
let f being (Function of A,( REAL ));
let g being (Function of A,( REAL ));
assume that
A1: ( f | A ) is  bounded
and
A2: f is  integrable
and
A3: ( g | A ) is  bounded
and
A4: a > ( 0 )
and
A5: (for x holds (for y holds ((x in A & y in A) implies ( abs ( ( g . x ) - ( g . y ) ) ) <= ( a * ( abs ( ( f . x ) - ( f . y ) ) ) ))));
(for T being (DivSequence of A) holds ((( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 )) implies ( ( lim ( upper_sum (g,T) ) ) - ( lim ( lower_sum (g,T) ) ) ) = ( 0 )))
proof
let T being (DivSequence of A);
assume that
A6: ( delta T ) is  convergent
and
A7: ( lim ( delta T ) ) = ( 0 );
A8: ( lower_sum (f,T) ) is  convergent by A1,A6,A7,CKB10:1;
A9: ( upper_sum (f,T) ) is  convergent by A1,A6,A7,CKB11:1;
then A10: ( ( upper_sum (f,T) ) - ( lower_sum (f,T) ) ) is  convergent by A8,SEQ_2:11;
reconsider osc1 = ( ( upper_sum (g,T) ) - ( lower_sum (g,T) ) ) as Real_Sequence;
reconsider osc = ( ( upper_sum (f,T) ) - ( lower_sum (f,T) ) ) as Real_Sequence;
( ( lim ( upper_sum (f,T) ) ) - ( lim ( lower_sum (f,T) ) ) ) = ( 0 ) by A1,A2,A6,A7,CKB18:1;
then A11: ( lim ( ( upper_sum (f,T) ) - ( lower_sum (f,T) ) ) ) = ( 0 ) by A9,A8,SEQ_2:12;
A12: (for b being  real number holds (( 0 ) < b implies (ex n st (for m holds (n <= m implies ( abs ( ( osc1 . m ) - ( 0 ) ) ) < b)))))
proof
let b being  real number;
assume b > ( 0 );
then ( b / a ) > ( 0 ) by A4,XREAL_1:139;
then consider n such that A13: (for m holds (n <= m implies ( abs ( ( osc . m ) - ( 0 ) ) ) < ( b / a ))) by A10,A11,SEQ_2:def 7;
(for m holds (n <= m implies ( abs ( ( osc1 . m ) - ( 0 ) ) ) < b))
proof
let m;
reconsider D = ( T . m ) as (Division of A);
( len ( upper_volume (f,D) ) ) = ( len D ) by INTEGRA1:def 6;
then reconsider UV = ( upper_volume (f,D) ) as (Element of ( ( len D ) -tuples_on ( REAL ) )) by FINSEQ_2:133;
( len ( lower_volume (f,D) ) ) = ( len D ) by INTEGRA1:def 7;
then reconsider LV = ( lower_volume (f,D) ) as (Element of ( ( len D ) -tuples_on ( REAL ) )) by FINSEQ_2:133;
( osc . m ) = ( ( ( upper_sum (f,T) ) . m ) + ( ( - ( lower_sum (f,T) ) ) . m ) ) by SEQ_1:7
.= ( ( ( upper_sum (f,T) ) . m ) + ( - ( ( lower_sum (f,T) ) . m ) ) ) by SEQ_1:10
.= ( ( ( upper_sum (f,T) ) . m ) - ( ( lower_sum (f,T) ) . m ) )
.= ( ( upper_sum (f,( T . m )) ) - ( ( lower_sum (f,T) ) . m ) ) by INTEGRA2:def 2
.= ( ( upper_sum (f,( T . m )) ) - ( lower_sum (f,( T . m )) ) ) by INTEGRA2:def 3
.= ( ( Sum ( upper_volume (f,D) ) ) - ( lower_sum (f,( T . m )) ) ) by INTEGRA1:def 8
.= ( ( Sum ( upper_volume (f,D) ) ) - ( Sum ( lower_volume (f,D) ) ) ) by INTEGRA1:def 9;
then A14: ( osc . m ) = ( Sum ( UV - LV ) ) by RVSUM_1:90;
assume n <= m;
then A15: ( abs ( ( osc . m ) - ( 0 ) ) ) < ( b / a ) by A13;
( len ( lower_volume (g,D) ) ) = ( len D ) by INTEGRA1:def 7;
then reconsider LV1 = ( lower_volume (g,D) ) as (Element of ( ( len D ) -tuples_on ( REAL ) )) by FINSEQ_2:133;
( len ( upper_volume (g,D) ) ) = ( len D ) by INTEGRA1:def 6;
then reconsider UV1 = ( upper_volume (g,D) ) as (Element of ( ( len D ) -tuples_on ( REAL ) )) by FINSEQ_2:133;
reconsider F = ( UV1 - LV1 ) as (FinSequence of ( REAL ));
( osc1 . m ) = ( ( ( upper_sum (g,T) ) . m ) + ( ( - ( lower_sum (g,T) ) ) . m ) ) by SEQ_1:7
.= ( ( ( upper_sum (g,T) ) . m ) + ( - ( ( lower_sum (g,T) ) . m ) ) ) by SEQ_1:10
.= ( ( ( upper_sum (g,T) ) . m ) - ( ( lower_sum (g,T) ) . m ) )
.= ( ( upper_sum (g,( T . m )) ) - ( ( lower_sum (g,T) ) . m ) ) by INTEGRA2:def 2
.= ( ( upper_sum (g,( T . m )) ) - ( lower_sum (g,( T . m )) ) ) by INTEGRA2:def 3
.= ( ( Sum ( upper_volume (g,D) ) ) - ( lower_sum (g,( T . m )) ) ) by INTEGRA1:def 8
.= ( ( Sum ( upper_volume (g,D) ) ) - ( Sum ( lower_volume (g,D) ) ) ) by INTEGRA1:def 9;
then A16: ( osc1 . m ) = ( Sum ( UV1 - LV1 ) ) by RVSUM_1:90;
(for j being Nat holds (j in ( dom F ) implies ( 0 ) <= ( F . j )))
proof
let j being Nat;
set r = ( F . j );
A17: ( rng g ) is  bounded_below by A3,INTEGRA1:11;
assume that
A18: j in ( dom F );
j in ( Seg ( len F ) ) by A18,FINSEQ_1:def 3;
then A19: j in ( Seg ( len D ) ) by CARD_1:def 7;
then A20: j in ( dom D ) by FINSEQ_1:def 3;
then A21: ( LV1 . j ) = ( ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) by INTEGRA1:def 7;
A22: (ex r st r in ( rng ( g | ( divset (D,j) ) ) ))
proof
consider r such that A23: r in ( divset (D,j) ) by SUBSET_1:4;
j in ( dom D ) by A19,FINSEQ_1:def 3;
then ( divset (D,j) ) c= A by INTEGRA1:8;
then r in A by A23;
then r in ( dom g ) by FUNCT_2:def 1;
then r in ( ( dom g ) /\ ( divset (D,j) ) ) by A23,XBOOLE_0:def 4;
then r in ( dom ( g | ( divset (D,j) ) ) ) by RELAT_1:61;
then ( ( g | ( divset (D,j) ) ) . r ) in ( rng ( g | ( divset (D,j) ) ) ) by FUNCT_1:def 3;
hence thesis;
end;
( rng g ) is  bounded_above by A3,INTEGRA1:13;
then ( rng ( g | ( divset (D,j) ) ) ) is  bounded by A17,RELAT_1:70,XXREAL_2:45;
then A24: ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) - ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) ) >= ( 0 ) by A22,SEQ_4:11,XREAL_1:48;
( UV1 . j ) = ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) by A20,INTEGRA1:def 6;
then A25: r = ( ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) - ( ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) ) by A18,A21,VALUED_1:13
.= ( ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) - ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) ) * ( vol ( divset (D,j) ) ) );
( vol ( divset (D,j) ) ) >= ( 0 ) by INTEGRA1:9;
hence thesis by A25,A24;
end;
then A26: ( osc1 . m ) >= ( 0 ) by A16,RVSUM_1:84;
then A27: ( abs ( osc1 . m ) ) = ( osc1 . m ) by ABSVALUE:def 1;
(for j being Nat holds (j in ( Seg ( len D ) ) implies ( ( UV1 - LV1 ) . j ) <= ( ( a * ( UV - LV ) ) . j )))
proof
let j being Nat;
set x = ( ( UV1 - LV1 ) . j );
set y = ( ( a * ( UV - LV ) ) . j );
A28: y = ( a * ( ( UV - LV ) . j ) ) by RVSUM_1:45;
assume A29: j in ( Seg ( len D ) );
then A30: j in ( dom D ) by FINSEQ_1:def 3;
then A31: ( LV1 . j ) = ( ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) by INTEGRA1:def 7;
A32: ( a * ( ( upper_bound ( rng ( f | ( divset (D,j) ) ) ) ) - ( lower_bound ( rng ( f | ( divset (D,j) ) ) ) ) ) ) >= ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) - ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) )
proof
A33: j in ( dom D ) by A29,FINSEQ_1:def 3;
then A34: ( ( f | ( divset (D,j) ) ) | ( divset (D,j) ) ) is  bounded_below by A1,INTEGRA1:8,INTEGRA2:6;
A35: ( dom ( g | ( divset (D,j) ) ) ) = ( ( dom g ) /\ ( divset (D,j) ) ) by RELAT_1:61
.= ( A /\ ( divset (D,j) ) ) by FUNCT_2:def 1
.= ( divset (D,j) ) by A33,INTEGRA1:8,XBOOLE_1:28;
then reconsider g1 = ( g | ( divset (D,j) ) ) as (PartFunc of ( divset (D,j) ),( REAL )) by RELSET_1:5;
A36: ( dom ( f | ( divset (D,j) ) ) ) = ( ( dom f ) /\ ( divset (D,j) ) ) by RELAT_1:61
.= ( A /\ ( divset (D,j) ) ) by FUNCT_2:def 1
.= ( divset (D,j) ) by A33,INTEGRA1:8,XBOOLE_1:28;
then reconsider f1 = ( f | ( divset (D,j) ) ) as (PartFunc of ( divset (D,j) ),( REAL )) by RELSET_1:5;
reconsider g1 as (Function of ( divset (D,j) ),( REAL )) by A35,FUNCT_2:def 1;
reconsider f1 as (Function of ( divset (D,j) ),( REAL )) by A36,FUNCT_2:def 1;
A37: ( divset (D,j) ) c= A by A33,INTEGRA1:8;
A38: (for x holds (for y holds ((x in ( divset (D,j) ) & y in ( divset (D,j) )) implies ( abs ( ( g1 . x ) - ( g1 . y ) ) ) <= ( a * ( abs ( ( f1 . x ) - ( f1 . y ) ) ) ))))
proof
let x;
let y;
assume that
A39: x in ( divset (D,j) )
and
A40: y in ( divset (D,j) );
A41: ( g . y ) = ( g1 . y ) by A35,A40,FUNCT_1:47;
A42: ( f . y ) = ( f1 . y ) by A36,A40,FUNCT_1:47;
A43: ( f . x ) = ( f1 . x ) by A36,A39,FUNCT_1:47;
( g . x ) = ( g1 . x ) by A35,A39,FUNCT_1:47;
hence thesis by A5,A37,A39,A40,A41,A43,A42;
end;
( ( f | ( divset (D,j) ) ) | ( divset (D,j) ) ) is  bounded_above by A1,A33,INTEGRA1:8,INTEGRA2:5;
then ( f1 | ( divset (D,j) ) ) is  bounded by A34;
hence thesis by A4,A38,CKB31:1;
end;
( vol ( divset (D,j) ) ) >= ( 0 ) by INTEGRA1:9;
then A44: ( ( a * ( ( upper_bound ( rng ( f | ( divset (D,j) ) ) ) ) - ( lower_bound ( rng ( f | ( divset (D,j) ) ) ) ) ) ) * ( vol ( divset (D,j) ) ) ) >= ( ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) - ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) ) * ( vol ( divset (D,j) ) ) ) by A32,XREAL_1:64;
( UV1 . j ) = ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) by A30,INTEGRA1:def 6;
then A45: x = ( ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) - ( ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) ) by A31,RVSUM_1:27
.= ( ( ( upper_bound ( rng ( g | ( divset (D,j) ) ) ) ) - ( lower_bound ( rng ( g | ( divset (D,j) ) ) ) ) ) * ( vol ( divset (D,j) ) ) );
A46: ( LV . j ) = ( ( lower_bound ( rng ( f | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) by A30,INTEGRA1:def 7;
( UV . j ) = ( ( upper_bound ( rng ( f | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) by A30,INTEGRA1:def 6;
then y = ( a * ( ( ( upper_bound ( rng ( f | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) - ( ( lower_bound ( rng ( f | ( divset (D,j) ) ) ) ) * ( vol ( divset (D,j) ) ) ) ) ) by A46,A28,RVSUM_1:27
.= ( a * ( ( ( upper_bound ( rng ( f | ( divset (D,j) ) ) ) ) - ( lower_bound ( rng ( f | ( divset (D,j) ) ) ) ) ) * ( vol ( divset (D,j) ) ) ) );
hence thesis by A45,A44;
end;
then ( osc1 . m ) <= ( Sum ( a * ( UV - LV ) ) ) by A16,RVSUM_1:82;
then A47: ( osc1 . m ) <= ( a * ( osc . m ) ) by A14,RVSUM_1:87;
then ( osc . m ) >= ( ( 0 ) / a ) by A4,A26,XREAL_1:79;
then ( abs ( osc . m ) ) = ( osc . m ) by ABSVALUE:def 1;
then ( a * ( osc . m ) ) < ( a * ( b / a ) ) by A4,A15,XREAL_1:68;
then ( a * ( osc . m ) ) < b by A4,XCMPLX_1:87;
hence thesis by A47,A27,XXREAL_0:2;
end;
hence thesis;
end;
then osc1 is  convergent by SEQ_2:def 6;
then A48: ( lim ( ( upper_sum (g,T) ) - ( lower_sum (g,T) ) ) ) = ( 0 ) by A12,SEQ_2:def 7;
A49: ( lower_sum (g,T) ) is  convergent by A3,A6,A7,CKB10:1;
( upper_sum (g,T) ) is  convergent by A3,A6,A7,CKB11:1;
hence thesis by A49,A48,SEQ_2:12;
end;
hence thesis by A3,CKB18:1;
end;
