environ
vocabularies NUMBERS,SUBSET_1,REAL_1,INTEGRA1,XBOOLE_0,MEASURE7,CARD_1,FINSEQ_1,RELAT_1,XXREAL_0,FUNCT_1,SEQ_4,ARYTM_3,ARYTM_1,FUNCT_3,TARSKI,PARTFUN1,CARD_3,VALUED_1,XXREAL_2,XXREAL_1,INTEGRA2,SEQ_2,ORDINAL2,FINSET_1,NAT_1,FINSEQ_2,VALUED_0,FDIFF_1,XREAL_0,ORDINAL1,COMPLEX1,INT_1,ZFMISC_1,RFUNCT_3,SEQ_1,ORDINAL4,SQUARE_1,INTEGRA4,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,INT_1,XXREAL_2,VALUED_0,ZFMISC_1,FUNCT_1,RELSET_1,FINSET_1,FUNCT_2,FINSEQ_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQ_2,SEQ_2,SEQ_4,RCOMP_1,FDIFF_1,SQUARE_1,RVSUM_1,MEASURE5,INTEGRA1,INTEGRA2,INTEGRA3,RFUNCT_3,PARTFUN1,XXREAL_0,CKB13;
definitions TARSKI,SQUARE_1,RVSUM_1,FINSEQ_2,VALUED_1,XXREAL_2,CKB13;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,TARSKI,FINSEQ_3,INTEGRA2,INTEGRA3,SEQM_3,PARTFUN2,NAT_2,INT_1,FINSEQ_2,RFUNCT_3,RELAT_1,XREAL_0,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_0,XCMPLX_1,XREAL_1,COMPLEX1,XXREAL_0,FINSOP_1,FUNCOP_1,VALUED_1,XXREAL_2,VALUED_0,ORDINAL1,RELSET_1,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14;
schemes FINSEQ_2,FUNCT_2;
registrations XBOOLE_0,RELAT_1,ORDINAL1,FUNCT_2,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,FINSEQ_2,INTEGRA1,VALUED_0,VALUED_1,XXREAL_2,CARD_1,SEQ_2,SEQ_4,RELSET_1,SEQM_3,MEASURE5;
constructors REAL_1,SQUARE_1,NAT_1,BINOP_2,COMPLEX1,FINSEQOP,FINSOP_1,PARTFUN2,FDIFF_1,ZFMISC_1,RFUNCT_3,INTEGRA2,SEQ_1,XXREAL_2,RVSUM_1,SEQ_4,RELSET_1,SEQ_2,INTEGRA3,CKB13;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve i for (Element of ( NAT ));
reserve j for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve a for Real;
reserve A for non  empty  closed_interval (Subset of ( REAL ));
theorem
Lm4: (( vol A ) > ( 0 ) implies (ex T being (DivSequence of A) st (( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 ))))
proof
defpred P[ set,set ]
 means
(ex n being (Element of ( NAT )) st (ex e being (Division of A) st ((n = $1 & e = $2) & e divide_into_equal ( n + 1 ))));
assume A1: ( vol A ) > ( 0 );
A2: (for n holds (ex D being (Element of ( divs A )) st P[ n,D ]))
proof
let n;
consider D being (Division of A) such that A3: ( len D ) = ( n + 1 ) and A4: (for i holds (i in ( dom D ) implies ( D . i ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( n + 1 ) ) * i ) ))) by A1,CKB14:1;
A5: D is (Element of ( divs A )) by INTEGRA1:def 3;
D divide_into_equal ( n + 1 ) by A3,A4,CKB13:def 1;
hence thesis by A5;
end;
consider T being (Function of ( NAT ),( divs A )) such that A6: (for n holds P[ n,( T . n ) ]) from FUNCT_2:sch 3(A2);
reconsider T as (DivSequence of A);
A7: (for i holds ( ( delta T ) . i ) = ( ( vol A ) / ( i + 1 ) ))
proof
let i;
( ( delta T ) . i ) = ( delta ( T . i ) ) by INTEGRA3:def 2;
then A8: ( ( delta T ) . i ) = ( max ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) ) by INTEGRA3:def 1;
(for x1 being set holds (x1 in ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) implies x1 in { ( ( vol A ) / ( i + 1 ) ) }))
proof
reconsider D = ( T . i ) as (Division of A);
let x1 being set;
assume x1 in ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) );
then consider k such that A9: k in ( dom ( upper_volume (( chi (A,A) ),( T . i )) ) ) and A10: ( ( upper_volume (( chi (A,A) ),( T . i )) ) . k ) = x1 by PARTFUN1:3;
A11: (ex n being (Element of ( NAT )) st (ex e being (Division of A) st ((n = i & e = D) & e divide_into_equal ( n + 1 )))) by A6;
k in ( Seg ( len ( upper_volume (( chi (A,A) ),( T . i )) ) ) ) by A9,FINSEQ_1:def 3;
then A12: k in ( Seg ( len D ) ) by INTEGRA1:def 6;
A13: ( ( upper_bound ( divset (D,k) ) ) - ( lower_bound ( divset (D,k) ) ) ) = ( ( vol A ) / ( i + 1 ) )
proof
A14: 1 <= k by A9,FINSEQ_3:25;
now
per cases  by A14,XXREAL_0:1;
suppose A15: k = 1;

A16: ( len D ) = ( i + 1 ) by A11,CKB13:def 1;
A17: 1 in ( dom D ) by A12,A15,FINSEQ_1:def 3;
then ( upper_bound ( divset (D,k) ) ) = ( D . 1 ) by A15,INTEGRA1:def 4;
then ( upper_bound ( divset (D,k) ) ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( i + 1 ) ) * 1 ) ) by A11,A17,A16,CKB13:def 1;
then ( ( upper_bound ( divset (D,k) ) ) - ( lower_bound ( divset (D,k) ) ) ) = ( ( ( lower_bound A ) + ( ( vol A ) / ( i + 1 ) ) ) - ( lower_bound A ) ) by A15,A17,INTEGRA1:def 4
.= ( ( ( vol A ) / ( i + 1 ) ) - ( ( lower_bound A ) - ( lower_bound A ) ) );
hence thesis;
end;
suppose A18: k > 1;

A19: k in ( dom D ) by A12,FINSEQ_1:def 3;
then A20: ( lower_bound ( divset (D,k) ) ) = ( D . ( k - 1 ) ) by A18,INTEGRA1:def 4;
( k - 1 ) in ( dom D ) by A18,A19,INTEGRA1:7;
then A21: ( D . ( k - 1 ) ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( len D ) ) * ( k - 1 ) ) ) by A11,CKB13:def 1;
A22: ( upper_bound ( divset (D,k) ) ) = ( D . k ) by A18,A19,INTEGRA1:def 4;
( D . k ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( len D ) ) * k ) ) by A11,A19,CKB13:def 1;
hence thesis by A11,A20,A22,A21,CKB13:def 1;
end;
end;
hence thesis;
end;
k in ( dom D ) by A12,FINSEQ_1:def 3;
then x1 = ( vol ( divset (D,k) ) ) by A10,INTEGRA1:20;
then x1 = ( ( upper_bound ( divset (D,k) ) ) - ( lower_bound ( divset (D,k) ) ) ) by INTEGRA1:def 5;
hence thesis by A13,TARSKI:def 1;
end;
then A23: ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) c= { ( ( vol A ) / ( i + 1 ) ) } by TARSKI:def 3;
(for x1 being set holds (x1 in { ( ( vol A ) / ( i + 1 ) ) } implies x1 in ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) )))
proof
reconsider D = ( T . i ) as (Division of A);
let x1 being set;
A24: ( vol ( divset (D,1) ) ) = ( ( upper_bound ( divset (D,1) ) ) - ( lower_bound ( divset (D,1) ) ) ) by INTEGRA1:def 5;
A25: (ex n being (Element of ( NAT )) st (ex e being (Division of A) st ((n = i & e = D) & e divide_into_equal ( n + 1 )))) by A6;
( rng D ) <> ( {} );
then A26: 1 in ( dom D ) by FINSEQ_3:32;
then ( upper_bound ( divset (D,1) ) ) = ( D . 1 ) by INTEGRA1:def 4;
then ( upper_bound ( divset (D,1) ) ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( len D ) ) * 1 ) ) by A26,A25,CKB13:def 1;
then A27: ( vol ( divset (D,1) ) ) = ( ( ( lower_bound A ) + ( ( vol A ) / ( len D ) ) ) - ( lower_bound A ) ) by A26,A24,INTEGRA1:def 4
.= ( ( vol A ) / ( len D ) );
assume x1 in { ( ( vol A ) / ( i + 1 ) ) };
then A28: x1 = ( ( vol A ) / ( i + 1 ) ) by TARSKI:def 1;
1 in ( Seg ( len D ) ) by A26,FINSEQ_1:def 3;
then 1 in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by INTEGRA1:def 6;
then 1 in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
then A29: ( ( upper_volume (( chi (A,A) ),D) ) . 1 ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by FUNCT_1:def 3;
( ( upper_volume (( chi (A,A) ),D) ) . 1 ) = ( vol ( divset (D,1) ) ) by A26,INTEGRA1:20;
hence thesis by A28,A29,A25,A27,CKB13:def 1;
end;
then { ( ( vol A ) / ( i + 1 ) ) } c= ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) by TARSKI:def 3;
then ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) = { ( ( vol A ) / ( i + 1 ) ) } by A23,XBOOLE_0:def 10;
then ( ( delta T ) . i ) in { ( ( vol A ) / ( i + 1 ) ) } by A8,XXREAL_2:def 8;
hence thesis by TARSKI:def 1;
end;
A30: (for a holds (( 0 ) < a implies (ex i st ( abs ( ( ( delta T ) . i ) - ( 0 ) ) ) < a)))
proof
let a;
A31: ( vol A ) >= ( 0 ) by INTEGRA1:9;
reconsider i1 = ( [\ ( ( vol A ) / a ) /] + 1 ) as Integer;
assume A32: ( 0 ) < a;
then ( [\ ( ( vol A ) / a ) /] + 1 ) > ( 0 ) by A31,INT_1:29;
then reconsider i1 as (Element of ( NAT )) by INT_1:3;
i1 < ( i1 + 1 ) by NAT_1:13;
then ( ( vol A ) / a ) < ( 1 * ( i1 + 1 ) ) by INT_1:29,XXREAL_0:2;
then A33: ( ( vol A ) / ( i1 + 1 ) ) < ( 1 * a ) by A32,XREAL_1:113;
A34: ( ( delta T ) . i1 ) = ( ( vol A ) / ( i1 + 1 ) ) by A7;
( ( ( vol A ) / ( i1 + 1 ) ) - ( 0 ) ) = ( abs ( ( ( vol A ) / ( i1 + 1 ) ) - ( 0 ) ) ) by A31,ABSVALUE:def 1;
hence thesis by A33,A34;
end;
A35: (for i holds ( ( delta T ) . i ) >= ( 0 ))
proof
let i;
( ( delta T ) . i ) = ( delta ( T . i ) ) by INTEGRA3:def 2;
hence thesis by INTEGRA3:9;
end;
A36: (for i holds (for j holds (i <= j implies ( ( delta T ) . i ) >= ( ( delta T ) . j ))))
proof
let i;
let j;
assume i <= j;
then A37: ( i + 1 ) <= ( j + 1 ) by XREAL_1:6;
( vol A ) >= ( 0 ) by INTEGRA1:9;
then ( ( vol A ) / ( i + 1 ) ) >= ( ( vol A ) / ( j + 1 ) ) by A37,XREAL_1:118;
then ( ( delta T ) . i ) >= ( ( vol A ) / ( j + 1 ) ) by A7;
hence thesis by A7;
end;
A38: (for a being  real number holds (( 0 ) < a implies (ex i st (for j holds (i <= j implies ( abs ( ( ( delta T ) . j ) - ( 0 ) ) ) < a)))))
proof
let a being  real number;
assume A39: ( 0 ) < a;
a is Real by XREAL_0:def 1;
then consider i such that A40: ( abs ( ( ( delta T ) . i ) - ( 0 ) ) ) < a by A30,A39;
( ( delta T ) . i ) >= ( 0 ) by A35;
then A41: ( ( delta T ) . i ) < a by A40,ABSVALUE:def 1;
(for j holds (i <= j implies ( abs ( ( ( delta T ) . j ) - ( 0 ) ) ) < a))
proof
let j;
assume i <= j;
then ( ( delta T ) . j ) <= ( ( delta T ) . i ) by A36;
then A42: ( ( delta T ) . j ) < a by A41,XXREAL_0:2;
( ( delta T ) . j ) >= ( 0 ) by A35;
hence thesis by A42,ABSVALUE:def 1;
end;
hence thesis;
end;
then A43: ( delta T ) is  convergent by SEQ_2:def 6;
then ( lim ( delta T ) ) = ( 0 ) by A38,SEQ_2:def 7;
hence thesis by A43;
end;
