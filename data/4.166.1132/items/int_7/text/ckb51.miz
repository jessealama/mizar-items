environ
vocabularies NUMBERS,FUNCOP_1,CARD_1,FUNCT_4,FUNCT_1,RELAT_1,PBOOLE,PRE_POLY,VALUED_0,XBOOLE_0,ARYTM_3,NEWTON,TARSKI,FINSET_1,ORDINAL1,NAT_3,CARD_3,UPROOTS,FINSEQ_1,SUBSET_1,ORDINAL4,ARYTM_1,XXREAL_0,FUNCT_2,CLASSES1,PARTFUN1,INT_2,NAT_1,POWER,RVSUM_1,BINOP_1,BINOP_2,REALSET1,ZFMISC_1,INT_3,SUPINF_2,FUNCT_7,ALGSTR_0,GROUP_1,MESFUNC1,INT_1,COMPLEX1,VECTSP_1,POLYNOM1,HURWITZ,POLYNOM5,POLYNOM3,POLYNOM2,AFINSQ_1,STRUCT_0,GROUP_4,GROUP_2,GRAPH_1,INT_7;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,FINSET_1,RVSUM_1,CARD_1,CLASSES1,DOMAIN_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,POWER,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,FINSEQ_1,FUNCT_4,STRUCT_0,ALGSTR_0,VFUNCT_1,GROUP_1,VECTSP_1,BINOP_1,PBOOLE,GROUP_2,BHSP_1,ALGSEQ_1,WSIERP_1,POLYNOM3,POLYNOM4,UPROOTS,NAT_3,POLYNOM5,GROUP_4,GR_CY_1,INT_1,FUNCT_7,NEWTON,INT_2,INT_3,HURWITZ,VALUED_0,REALSET1,RECDEF_1,PRE_POLY,POLYNOM2,CKB8,CKB31,CKB33,CKB36;
definitions STRUCT_0,GROUP_1,INT_3,CARD_1,ALGSTR_0,BINOP_1,FINSEQ_1,POLYNOM3,HURWITZ,REALSET1,TARSKI,CKB8,CKB31,CKB33,CKB36;
theorems TARSKI,XBOOLE_0,ZFMISC_1,ORDINAL1,FUNCT_1,FUNCT_2,VECTSP_1,INT_1,RELAT_1,RLVECT_1,ABSVALUE,GR_CY_1,FUNCT_7,NAT_1,INT_2,INT_3,PEPIN,NAT_D,XCMPLX_1,NUMBERS,PYTHTRIP,WSIERP_1,CARD_1,GROUP_1,GROUP_2,STRUCT_0,WELLORD2,XREAL_1,NEWTON,XXREAL_0,GR_CY_2,POWER,VALUED_0,ALGSEQ_1,NAT_3,UPROOTS,RVSUM_1,FINSEQ_4,FINSEQ_5,POLYNOM3,POLYNOM4,POLYNOM5,CARD_2,EULER_1,EULER_2,XBOOLE_1,FINSEQ_1,HURWITZ,GROUP_8,REALSET1,RELSET_1,FUNCT_4,FUNCOP_1,CLASSES1,PARTFUN1,PRE_POLY,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50;
schemes NAT_1,PRE_CIRC,FUNCT_2,RECDEF_1;
registrations XBOOLE_0,STRUCT_0,FUNCT_1,XREAL_0,ORDINAL1,NAT_1,INT_1,GROUP_1,GROUP_2,FINSET_1,FINSEQ_1,FUNCT_2,GR_CY_1,ALGSTR_0,MEMBERED,VECTSP_1,INT_3,XXREAL_0,NEWTON,SUBSET_1,RELAT_1,CARD_1,ALGSTR_1,NAT_3,VALUED_0,POLYNOM3,POLYNOM4,POLYNOM5,UPROOTS,RELSET_1,PRE_POLY,VFUNCT_1,CKB9,CKB40;
constructors REAL_1,NAT_D,NAT_3,SEQ_1,PEPIN,EUCLID,REALSET1,GROUP_4,GR_CY_1,INT_3,WSIERP_1,BHSP_1,POLYNOM2,POLYNOM4,POLYNOM5,WELLORD2,POWER,ALGSTR_1,HURWITZ,UPROOTS,FUNCT_4,RECDEF_1,BINOP_2,CLASSES1,RELSET_1,PBOOLE,FUNCT_7,VFUNCT_1,CKB8,CKB31,CKB33,CKB36;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
theorem
(for p being Prime holds ( Z/Z* p ) is  cyclic  cyclic Group)
proof
let p being Prime;
set a = the (Element of ( Z/Z* p ));
set ZP = ( Z/Z* p );
defpred P[  natural number,(Element of ZP),(Element of ZP) ]
 means
( ord $2 ) < ( ord $3 );
assume A1: (not ( Z/Z* p ) is  cyclic  cyclic Group);
A2: (for x being (Element of ( Z/Z* p )) holds ( ord x ) < ( card ( Z/Z* p ) ))
proof
let x being (Element of ( Z/Z* p ));
A3: ( ord x ) <= ( card ( Z/Z* p ) ) by GR_CY_1:8,NAT_D:7;
( ord x ) <> ( card ( Z/Z* p ) ) by A1,GR_CY_1:19;
hence thesis by A3,XXREAL_0:1;
end;
A4: (for n being (Element of ( NAT )) holds (for x being (Element of ZP) holds (ex y being (Element of ZP) st P[ n,x,y ])))
proof
let n being (Element of ( NAT ));
let x being (Element of ZP);
set n = ( ord x );
n < ( card ( Z/Z* p ) ) by A2;
then A5: ( card ( gr { x } ) ) <> ( card ( Z/Z* p ) ) by GR_CY_1:7;
(the carrier of ( gr { x } )) c= (the carrier of ( Z/Z* p )) by GROUP_2:def 5;
then (the carrier of ( gr { x } )) c< (the carrier of ( Z/Z* p )) by A5,XBOOLE_0:def 8;
then ( (the carrier of ( Z/Z* p )) \ (the carrier of ( gr { x } )) ) <> ( {} ) by XBOOLE_1:105;
then consider z being set such that A6: z in ( (the carrier of ( Z/Z* p )) \ (the carrier of ( gr { x } )) ) by XBOOLE_0:def 1;
reconsider z as (Element of ZP) by A6;
set m = ( ord z );
now
set l = ( m lcm n );
1 <= ( card ( gr { x } ) ) by GROUP_1:45;
then A7: 1 <= n by GR_CY_1:7;
(not m divides n)
proof
assume m divides n;
then consider j being Integer such that A8: n = ( m * j ) by INT_1:def 3;
( z |^ n ) = ( ( z |^ m ) |^ j ) by A8,GROUP_1:35
.= ( ( 1_ ( Z/Z* p ) ) |^ j ) by GROUP_1:41
.= ( 1_ ( Z/Z* p ) ) by GROUP_1:31
.= 1 by CKB38:1;
then z is (Element of ( gr { x } )) by A7,CKB49:1;
hence contradiction by A6,XBOOLE_0:def 5;
end;
then A9: n <> l by INT_2:18;
1 <= ( card ( gr { z } ) ) by GROUP_1:45;
then A10: 1 <= m by GR_CY_1:7;
then consider m0 being (Element of ( NAT )),n0 being (Element of ( NAT )) such that A11: l = ( n0 * m0 ) and A12: ( n0 gcd m0 ) = 1 and A13: n0 divides n and A14: m0 divides m and A15: n0 <> ( 0 ) and A16: m0 <> ( 0 ) by A7,CKB30:1;
consider j being Integer such that A17: n = ( n0 * j ) by A13,INT_1:def 3;
consider u being Integer such that A18: m = ( m0 * u ) by A14,INT_1:def 3;
( m / m0 ) = u by A16,A18,XCMPLX_1:89;
then reconsider d2 = ( m / m0 ) as (Element of ( NAT )) by INT_1:3;
m = ( ( m / m0 ) * m0 ) by A16,XCMPLX_1:87;
then A19: ( ord ( z |^ d2 ) ) = m0 by CKB50:1;
( n / n0 ) = j by A15,A17,XCMPLX_1:89;
then reconsider d1 = ( n / n0 ) as (Element of ( NAT )) by INT_1:3;
n divides ( m lcm n ) by INT_2:18;
then consider j being Integer such that A20: l = ( n * j ) by INT_1:def 3;
take y = ( ( x |^ d1 ) * ( z |^ d2 ) );
n = ( ( n / n0 ) * n0 ) by A15,XCMPLX_1:87;
then ( ord ( x |^ d1 ) ) = n0 by CKB50:1;
then A21: ( ord y ) = ( m0 * n0 ) by A12,A19,CKB43:1;
( l / n ) = j by A7,A20,XCMPLX_1:89;
then A22: j is (Element of ( NAT )) by INT_1:3;
j <> ( 0 ) by A7,A10,A20,INT_2:4;
then ( n * 1 ) <= ( n * j ) by A22,NAT_1:14,XREAL_1:64;
hence n < ( ord y ) by A11,A21,A9,A20,XXREAL_0:1;
end;
hence thesis;
end;
consider f being (Function of ( NAT ),(the carrier of ZP)) such that A23: (( f . ( 0 ) ) = a & (for n being (Element of ( NAT )) holds P[ n,( f . n ),( f . ( n + 1 ) ) ])) from RECDEF_1:sch 2(A4);
deffunc F((Element of ( NAT ))) = ( ord ( f . $1 ) );
consider g being (Function of ( NAT ),( NAT )) such that A24: (for k being (Element of ( NAT )) holds ( g . k ) = F(k)) from FUNCT_2:sch 4;
A25:now
let k being (Element of ( NAT ));
A26: ( g . ( k + 1 ) ) = ( ord ( f . ( k + 1 ) ) ) by A24;
( g . k ) = ( ord ( f . k ) ) by A24;
hence ( g . k ) < ( g . ( k + 1 ) ) by A23,A26;
end;
A27: (for k,m being (Element of ( NAT )) holds ( g . k ) < ( g . ( ( k + 1 ) + m ) ))
proof
let k being (Element of ( NAT ));
defpred P[ Nat ]
 means
( g . k ) < ( g . ( ( k + 1 ) + $1 ) );
A28:now
let m being (Element of ( NAT ));
assume A29: P[ m ];
( g . ( ( k + 1 ) + m ) ) < ( g . ( ( ( k + 1 ) + m ) + 1 ) ) by A25;
hence P[ ( m + 1 ) ] by A29,XXREAL_0:2;
end;
A30: P[ ( 0 ) ] by A25;
(for m being (Element of ( NAT )) holds P[ m ]) from NAT_1:sch 1(A30,A28);
hence thesis;
end;
A31: (for k,m being (Element of ( NAT )) holds (k < m implies ( g . k ) < ( g . m )))
proof
let k being (Element of ( NAT )),m being (Element of ( NAT ));
assume A32: k < m;
then ( m - k ) is (Element of ( NAT )) by INT_1:5;
then reconsider mk = ( m - k ) as Nat;
( m - k ) <> ( 0 ) by A32;
then consider n0 being Nat such that A33: mk = ( n0 + 1 ) by NAT_1:6;
reconsider n = n0 as (Element of ( NAT )) by ORDINAL1:def 12;
m = ( ( k + 1 ) + n ) by A33;
hence thesis by A27;
end;
now
let x1 being set,x2 being set;
assume that
A34: x1 in ( NAT )
and
A35: x2 in ( NAT )
and
A36: ( g . x1 ) = ( g . x2 );
reconsider xx1 = x1,xx2 = x2 as (Element of ( NAT )) by A34,A35;
A37: xx2 <= xx1 by A31,A36;
xx1 <= xx2 by A31,A36;
hence x2 = x1 by A37,XXREAL_0:1;
end;
then g is  one-to-one by FUNCT_2:19;
then ( dom g ),( rng g ) are_equipotent  by WELLORD2:def 4;
then ( card ( dom g ) ) = ( card ( rng g ) ) by CARD_1:5;
then A38: ( card ( rng g ) ) = ( card ( NAT ) ) by FUNCT_2:def 1;
( rng g ) c= ( Segm ( card ZP ) )
proof
let y being set;
assume y in ( rng g );
then consider x being set such that A39: x in ( NAT ) and A40: y = ( g . x ) by FUNCT_2:11;
reconsider x as (Element of ( NAT )) by A39;
reconsider gg = ( g . x ) as (Element of ( NAT ));
( g . x ) = ( ord ( f . x ) ) by A24;
then gg < ( card ZP ) by A2;
hence thesis by A40,ALGSEQ_1:1;
end;
hence contradiction by A38;
end;
