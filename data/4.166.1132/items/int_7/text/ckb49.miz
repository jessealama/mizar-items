environ
vocabularies NUMBERS,FUNCOP_1,CARD_1,FUNCT_4,FUNCT_1,RELAT_1,PBOOLE,PRE_POLY,VALUED_0,XBOOLE_0,ARYTM_3,NEWTON,TARSKI,FINSET_1,ORDINAL1,NAT_3,CARD_3,UPROOTS,FINSEQ_1,SUBSET_1,ORDINAL4,ARYTM_1,XXREAL_0,FUNCT_2,CLASSES1,PARTFUN1,INT_2,NAT_1,POWER,RVSUM_1,BINOP_1,BINOP_2,REALSET1,ZFMISC_1,INT_3,SUPINF_2,FUNCT_7,ALGSTR_0,GROUP_1,MESFUNC1,INT_1,COMPLEX1,VECTSP_1,POLYNOM1,HURWITZ,POLYNOM5,POLYNOM3,POLYNOM2,AFINSQ_1,STRUCT_0,GROUP_4,GROUP_2,GRAPH_1,INT_7;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,FINSET_1,RVSUM_1,CARD_1,CLASSES1,DOMAIN_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,POWER,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,FINSEQ_1,FUNCT_4,STRUCT_0,ALGSTR_0,VFUNCT_1,GROUP_1,VECTSP_1,BINOP_1,PBOOLE,GROUP_2,BHSP_1,ALGSEQ_1,WSIERP_1,POLYNOM3,POLYNOM4,UPROOTS,NAT_3,POLYNOM5,GROUP_4,GR_CY_1,INT_1,FUNCT_7,NEWTON,INT_2,INT_3,HURWITZ,VALUED_0,REALSET1,RECDEF_1,PRE_POLY,POLYNOM2,CKB8,CKB31,CKB33,CKB36;
definitions STRUCT_0,GROUP_1,INT_3,CARD_1,ALGSTR_0,BINOP_1,FINSEQ_1,POLYNOM3,HURWITZ,REALSET1,TARSKI,CKB8,CKB31,CKB33,CKB36;
theorems TARSKI,XBOOLE_0,ZFMISC_1,ORDINAL1,FUNCT_1,FUNCT_2,VECTSP_1,INT_1,RELAT_1,RLVECT_1,ABSVALUE,GR_CY_1,FUNCT_7,NAT_1,INT_2,INT_3,PEPIN,NAT_D,XCMPLX_1,NUMBERS,PYTHTRIP,WSIERP_1,CARD_1,GROUP_1,GROUP_2,STRUCT_0,WELLORD2,XREAL_1,NEWTON,XXREAL_0,GR_CY_2,POWER,VALUED_0,ALGSEQ_1,NAT_3,UPROOTS,RVSUM_1,FINSEQ_4,FINSEQ_5,POLYNOM3,POLYNOM4,POLYNOM5,CARD_2,EULER_1,EULER_2,XBOOLE_1,FINSEQ_1,HURWITZ,GROUP_8,REALSET1,RELSET_1,FUNCT_4,FUNCOP_1,CLASSES1,PARTFUN1,PRE_POLY,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48;
schemes NAT_1,PRE_CIRC,FUNCT_2,RECDEF_1;
registrations XBOOLE_0,STRUCT_0,FUNCT_1,XREAL_0,ORDINAL1,NAT_1,INT_1,GROUP_1,GROUP_2,FINSET_1,FINSEQ_1,FUNCT_2,GR_CY_1,ALGSTR_0,MEMBERED,VECTSP_1,INT_3,XXREAL_0,NEWTON,SUBSET_1,RELAT_1,CARD_1,ALGSTR_1,NAT_3,VALUED_0,POLYNOM3,POLYNOM4,POLYNOM5,UPROOTS,RELSET_1,PRE_POLY,VFUNCT_1,CKB9,CKB40;
constructors REAL_1,NAT_D,NAT_3,SEQ_1,PEPIN,EUCLID,REALSET1,GROUP_4,GR_CY_1,INT_3,WSIERP_1,BHSP_1,POLYNOM2,POLYNOM4,POLYNOM5,WELLORD2,POWER,ALGSTR_1,HURWITZ,UPROOTS,FUNCT_4,RECDEF_1,BINOP_2,CLASSES1,RELSET_1,PBOOLE,FUNCT_7,VFUNCT_1,CKB8,CKB31,CKB33,CKB36;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
theorem
Th29: (for p being Prime holds (for a,b being (Element of ( Z/Z* p )) holds (for n being  natural number holds (((( 0 ) < n & ( ord a ) = n) & ( b |^ n ) = 1) implies b is (Element of ( gr { a } ))))))
proof
let p being Prime;
let a being (Element of ( Z/Z* p )),b being (Element of ( Z/Z* p ));
let n being  natural number;
assume that
A1: ( 0 ) < n
and
A2: ( ord a ) = n
and
A3: ( b |^ n ) = 1;
reconsider XX = (the carrier of ( gr { a } )) as  finite set;
A4: (ex D being  finite set st (D = (the carrier of ( gr { a } )) & ( card ( gr { a } ) ) = ( card D )));
reconsider L = ( INT.Ring p ) as  unital non empty doubleLoopStr;
consider f being (Polynomial of L) such that A5: ( deg f ) = n and A6: (for x being (Element of L) holds (for xz being (Element of ( Z/Z* p )) holds (for xn being (Element of ( INT.Ring p )) holds ((x = xz & xn = ( xz |^ n )) implies ( eval (f,x) ) = ( xn - ( 1_ ( INT.Ring p ) ) ))))) by A1,CKB48:1;
consider m being (Element of ( NAT )),n0 being (Element of ( NAT )) such that A7: n0 = ( deg f ) and A8: m = ( card ( Roots f ) ) and A9: m <= n0 by A5,CKB46:1;
assume (not b is (Element of ( gr { a } )));
then ( card ( (the carrier of ( gr { a } )) \/ { b } ) ) = ( ( card XX ) + 1 ) by CARD_2:41
.= ( n0 + 1 ) by A2,A5,A7,A4,GR_CY_1:7;
then A10: ( card ( n0 + 1 ) ) = ( card ( (the carrier of ( gr { a } )) \/ { b } ) );
A11: 1 < p by INT_2:def 4;
A12: (for x being (Element of ( Z/Z* p )) holds (( x |^ n ) = 1 implies x in ( Roots f )))
proof
let x1 being (Element of ( Z/Z* p ));
assume ( x1 |^ n ) = 1;
then A13: ( x1 |^ n ) = ( 1_ ( Z/Z* p ) ) by CKB38:1
.= ( 1_ ( INT.Ring p ) ) by CKB38:1;
( x1 |^ n ) in ( Segm0 p );
then ( x1 |^ n ) in ( ( Segm p ) \ { ( 0 ) } ) by A11,CKB31:def 1;
then reconsider x2 = ( x1 |^ n ) as (Element of ( INT.Ring p )) by XBOOLE_0:def 5;
x1 in ( Segm0 p );
then x1 in ( ( Segm p ) \ { ( 0 ) } ) by A11,CKB31:def 1;
then reconsider x3 = x1 as (Element of L) by XBOOLE_0:def 5;
( eval (f,x3) ) = ( x2 - ( 1_ ( INT.Ring p ) ) ) by A6
.= ( 0. L ) by A13,RLVECT_1:15;
then x3 is_a_root_of f by POLYNOM5:def 6;
hence thesis by POLYNOM5:def 9;
end;
A14: (the carrier of ( gr { a } )) c= ( Roots f )
proof
let x being set;
assume A15: x in (the carrier of ( gr { a } ));
then x in ( gr { a } ) by STRUCT_0:def 5;
then x in ( Z/Z* p ) by GROUP_2:40;
then reconsider x1 = x as (Element of ( Z/Z* p )) by STRUCT_0:def 5;
x1 in ( gr { a } ) by A15,STRUCT_0:def 5;
then consider j being Integer such that A16: x1 = ( a |^ j ) by GR_CY_1:5;
( x1 |^ n ) = ( a |^ ( j * n ) ) by A16,GROUP_1:35
.= ( ( a |^ n ) |^ j ) by GROUP_1:35
.= ( ( 1_ ( Z/Z* p ) ) |^ j ) by A2,GROUP_1:41
.= ( 1_ ( Z/Z* p ) ) by GROUP_1:31
.= 1 by CKB38:1;
hence thesis by A12;
end;
b in ( Roots f ) by A3,A12;
then { b } c= ( Roots f ) by ZFMISC_1:31;
then ( (the carrier of ( gr { a } )) \/ { b } ) c= ( Roots f ) by A14,XBOOLE_1:8;
then A17: ( card ( (the carrier of ( gr { a } )) \/ { b } ) ) c= ( card ( Roots f ) ) by CARD_1:11;
( card m ) = ( card ( Roots f ) ) by A8;
then ( n0 + 1 ) c= m by A17,A10,CARD_1:41;
then ( n0 + 1 ) <= m by NAT_1:39;
hence contradiction by A9,NAT_1:16,XXREAL_0:2;
end;
