environ
vocabularies NUMBERS,FUNCOP_1,CARD_1,FUNCT_4,FUNCT_1,RELAT_1,PBOOLE,PRE_POLY,VALUED_0,XBOOLE_0,ARYTM_3,NEWTON,TARSKI,FINSET_1,ORDINAL1,NAT_3,CARD_3,UPROOTS,FINSEQ_1,SUBSET_1,ORDINAL4,ARYTM_1,XXREAL_0,FUNCT_2,CLASSES1,PARTFUN1,INT_2,NAT_1,POWER,RVSUM_1,BINOP_1,BINOP_2,REALSET1,ZFMISC_1,INT_3,SUPINF_2,FUNCT_7,ALGSTR_0,GROUP_1,MESFUNC1,INT_1,COMPLEX1,VECTSP_1,POLYNOM1,HURWITZ,POLYNOM5,POLYNOM3,POLYNOM2,AFINSQ_1,STRUCT_0,GROUP_4,GROUP_2,GRAPH_1,INT_7;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,FINSET_1,RVSUM_1,CARD_1,CLASSES1,DOMAIN_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,POWER,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,FINSEQ_1,FUNCT_4,STRUCT_0,ALGSTR_0,VFUNCT_1,GROUP_1,VECTSP_1,BINOP_1,PBOOLE,GROUP_2,BHSP_1,ALGSEQ_1,WSIERP_1,POLYNOM3,POLYNOM4,UPROOTS,NAT_3,POLYNOM5,GROUP_4,GR_CY_1,INT_1,FUNCT_7,NEWTON,INT_2,INT_3,HURWITZ,VALUED_0,REALSET1,RECDEF_1,PRE_POLY,POLYNOM2,CKB8;
definitions STRUCT_0,GROUP_1,INT_3,CARD_1,ALGSTR_0,BINOP_1,FINSEQ_1,POLYNOM3,HURWITZ,REALSET1,TARSKI,CKB8;
theorems TARSKI,XBOOLE_0,ZFMISC_1,ORDINAL1,FUNCT_1,FUNCT_2,VECTSP_1,INT_1,RELAT_1,RLVECT_1,ABSVALUE,GR_CY_1,FUNCT_7,NAT_1,INT_2,INT_3,PEPIN,NAT_D,XCMPLX_1,NUMBERS,PYTHTRIP,WSIERP_1,CARD_1,GROUP_1,GROUP_2,STRUCT_0,WELLORD2,XREAL_1,NEWTON,XXREAL_0,GR_CY_2,POWER,VALUED_0,ALGSEQ_1,NAT_3,UPROOTS,RVSUM_1,FINSEQ_4,FINSEQ_5,POLYNOM3,POLYNOM4,POLYNOM5,CARD_2,EULER_1,EULER_2,XBOOLE_1,FINSEQ_1,HURWITZ,GROUP_8,REALSET1,RELSET_1,FUNCT_4,FUNCOP_1,CLASSES1,PARTFUN1,PRE_POLY,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23;
schemes NAT_1,PRE_CIRC,FUNCT_2,RECDEF_1;
registrations XBOOLE_0,STRUCT_0,FUNCT_1,XREAL_0,ORDINAL1,NAT_1,INT_1,GROUP_1,GROUP_2,FINSET_1,FINSEQ_1,FUNCT_2,GR_CY_1,ALGSTR_0,MEMBERED,VECTSP_1,INT_3,XXREAL_0,NEWTON,SUBSET_1,RELAT_1,CARD_1,ALGSTR_1,NAT_3,VALUED_0,POLYNOM3,POLYNOM4,POLYNOM5,UPROOTS,RELSET_1,PRE_POLY,VFUNCT_1,CKB9;
constructors REAL_1,NAT_D,NAT_3,SEQ_1,PEPIN,EUCLID,REALSET1,GROUP_4,GR_CY_1,INT_3,WSIERP_1,BHSP_1,POLYNOM2,POLYNOM4,POLYNOM5,WELLORD2,POWER,ALGSTR_1,HURWITZ,UPROOTS,FUNCT_4,RECDEF_1,BINOP_2,CLASSES1,RELSET_1,PBOOLE,FUNCT_7,VFUNCT_1,CKB8;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
theorem
Lm10: (for p being (bag of ( SetPrimes )) holds (for x being Prime holds (((p is  prime-factorization-like & x in ( support p )) & ( p . x ) <> x) implies (ex p1,r1 being (bag of ( SetPrimes )) st ((((((p1 is  prime-factorization-like & ( support r1 ) = { x }) & ( Product r1 ) = x) & ( support p1 ) = ( support p )) & ( p1 | ( ( support p1 ) \ { x } ) ) = ( p | ( ( support p1 ) \ { x } ) )) & ( p . x ) = ( ( p1 . x ) * x )) & ( Product p ) = ( ( Product p1 ) * x ))))))
proof
let p being (bag of ( SetPrimes ));
let x being Prime;
assume that
A1: p is  prime-factorization-like
and
A2: x in ( support p )
and
A3: ( p . x ) <> x;
consider nx being  natural number such that A4: ( 0 ) < nx and A5: ( p . x ) = ( x |^ nx ) by A1,A2,CKB8:def 1;
consider mx being Nat such that A6: nx = ( mx + 1 ) by A4,NAT_1:6;
A7: mx <> ( 0 ) by A3,A5,A6,NEWTON:5;
A8: ( dom ( ( SetPrimes ) --> ( 0 ) ) ) = ( SetPrimes ) by FUNCOP_1:13;
then A9: x in ( dom ( ( SetPrimes ) --> ( 0 ) ) ) by NEWTON:def 6;
set r10 = ( ( ( SetPrimes ) --> ( 0 ) ) +* (x,x) );
x is (Element of ( NAT )) by ORDINAL1:def 12;
then A10: (ex r1 being (bag of ( SetPrimes )) st ((r1 = r10 & ( support r1 ) = { x }) & ( Product r1 ) = x)) by CKB22:1;
A11: { x } c= ( support p ) by A2,ZFMISC_1:31;
then consider q being (bag of ( SetPrimes )),r being (bag of ( SetPrimes )) such that A12: ( support q ) = ( ( support p ) \ { x } ) and A13: ( support r ) = { x } and A14: ( support q ) misses ( support r ) and A15: ( q | ( support q ) ) = ( p | ( support q ) ) and A16: ( r | ( support r ) ) = ( p | ( support r ) ) and A17: ( q + r ) = p by CKB7:1;
A18: x in ( support r ) by A13,TARSKI:def 1;
then A19: ( r . x ) = ( ( r | ( support r ) ) . x ) by FUNCT_1:49
.= ( p . x ) by A16,A18,FUNCT_1:49;
then A20: ( ( r . x ) / x ) = ( ( ( x |^ mx ) * x ) / x ) by A5,A6,NEWTON:6
.= ( x |^ mx ) by XCMPLX_1:89;
then reconsider rxx = ( ( r . x ) / x ) as (Element of ( NAT )) by ORDINAL1:def 12;
set r20 = ( ( ( SetPrimes ) --> ( 0 ) ) +* (x,rxx) );
rxx <> ( 0 )
proof
assume A21: rxx = ( 0 );
( r . x ) = ( rxx * x ) by XCMPLX_1:87
.= ( 0 ) by A21;
hence contradiction by A5,A19;
end;
then consider r2 being (bag of ( SetPrimes )) such that A22: r2 = r20 and A23: ( support r2 ) = { x } and A24: ( Product r2 ) = rxx by CKB22:1;
set p1 = ( q + r2 );
A25: r = ( ( ( SetPrimes ) --> ( 0 ) ) +* (x,( r . x )) ) by A13,CKB2:1;
A26:now
let z being set;
A27: ( p1 . z ) = ( ( q . z ) + ( r2 . z ) ) by PRE_POLY:def 5;
assume A28: z in ( ( support p1 ) \ { x } );
then (not z in { x }) by XBOOLE_0:def 5;
then A29: ( r2 . z ) = ( 0 ) by A23,PRE_POLY:def 7;
z in ( support p1 ) by A28,XBOOLE_0:def 5;
then z in ( ( support q ) \/ ( support r2 ) ) by PRE_POLY:38;
then A30: (z in ( support q ) or z in ( support r2 )) by XBOOLE_0:def 3;
then ( q . z ) = ( ( q | ( support q ) ) . z ) by A23,A28,FUNCT_1:49,XBOOLE_0:def 5
.= ( p . z ) by A15,A23,A28,A30,FUNCT_1:49,XBOOLE_0:def 5;
hence ( p1 . z ) = ( p . z ) by A27,A29;
end;
( dom p1 ) = ( SetPrimes ) by PARTFUN1:def 2
.= ( dom p ) by PARTFUN1:def 2;
then A31: ( p1 | ( ( support p1 ) \ { x } ) ) = ( p | ( ( support p1 ) \ { x } ) ) by A26,FUNCT_1:96;
A32: ( ( support q ) /\ ( support r ) ) = ( {} ) by A14,XBOOLE_0:def 7;
now
let z being Prime;
A33: ( p1 . z ) = ( ( q . z ) + ( r2 . z ) ) by PRE_POLY:def 5;
assume z in ( support p1 );
then A34: z in ( ( support q ) \/ ( support r2 ) ) by PRE_POLY:38;
per cases  by A34,XBOOLE_0:def 3;
suppose A35: z in ( support q );

then (not z in { x }) by A12,XBOOLE_0:def 5;
then A36: ( r2 . z ) = ( 0 ) by A23,PRE_POLY:def 7;
A37: ( support q ) c= ( support p ) by A12,XBOOLE_1:36;
( q . z ) = ( ( q | ( support q ) ) . z ) by A35,FUNCT_1:49
.= ( p . z ) by A15,A35,FUNCT_1:49;
hence (ex n being  natural number st (( 0 ) < n & ( p1 . z ) = ( z |^ n ))) by A1,A33,A35,A37,A36,CKB8:def 1;
end;
suppose A38: z in ( support r2 );

take mx;
thus ( 0 ) < mx by A7;
A39: z = x by A23,A38,TARSKI:def 1;
A40: (not z in ( support q )) by A13,A32,A23,A38,XBOOLE_0:def 4;
( p1 . z ) = ( ( q . z ) + ( r2 . z ) ) by PRE_POLY:def 5
.= ( ( 0 ) + ( r2 . z ) ) by A40,PRE_POLY:def 7
.= ( z |^ mx ) by A20,A22,A8,A38,A39,FUNCT_7:31;
hence ( p1 . z ) = ( z |^ mx );
end;
end;
then A41: p1 is  prime-factorization-like by CKB8:def 1;
x in { x } by TARSKI:def 1;
then A42: (not x in ( support q )) by A12,XBOOLE_0:def 5;
( p1 . x ) = ( ( q . x ) + ( r2 . x ) ) by PRE_POLY:def 5
.= ( ( 0 ) + ( r2 . x ) ) by A42,PRE_POLY:def 7
.= rxx by A22,A9,FUNCT_7:31;
then A43: ( p . x ) = ( ( p1 . x ) * x ) by A19,XCMPLX_1:87;
( r . x ) = ( rxx * x ) by XCMPLX_1:87;
then (ex rr1 being (bag of ( SetPrimes )) st ((rr1 = r & ( support rr1 ) = { x }) & ( Product rr1 ) = ( rxx * x ))) by A5,A19,A25,CKB22:1;
then A44: ( Product p ) = ( ( Product q ) * ( ( Product r2 ) * x ) ) by A14,A17,A24,NAT_3:19
.= ( ( ( Product q ) * ( Product r2 ) ) * x )
.= ( ( Product p1 ) * x ) by A13,A14,A23,NAT_3:19;
( support p1 ) = ( ( ( support p ) \ { x } ) \/ { x } ) by A12,A23,PRE_POLY:38
.= ( ( support p ) \/ { x } ) by XBOOLE_1:39
.= ( support p ) by A11,XBOOLE_1:12;
hence thesis by A10,A43,A44,A41,A31;
end;
