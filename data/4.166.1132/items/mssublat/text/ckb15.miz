environ
vocabularies NAT_1,PBOOLE,FUNCT_1,CARD_1,XBOOLE_0,FINSEQ_2,FINSEQ_1,RELAT_1,TARSKI,NUMBERS,SUBSET_1,UNIALG_1,UNIALG_2,MSUALG_1,FUNCOP_1,CQC_SIM1,STRUCT_0,MSUALG_2,MARGREL1,PARTFUN1,CARD_3,FUNCT_2,ZFMISC_1,EQREL_1,INCPROJ,WELLORD1,GROUP_6,LATTICES;
notations TARSKI,XBOOLE_0,SUBSET_1,BINOP_1,CARD_3,NAT_1,LATTICES,LATTICE4,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,STRUCT_0,PBOOLE,UNIALG_1,UNIALG_2,NUMBERS,FINSEQ_1,FINSEQ_2,MARGREL1,MSUALG_1,MSUALG_2;
definitions TARSKI,XBOOLE_0,MSUALG_2,PBOOLE,LATTICE4,UNIALG_1,UNIALG_2,FUNCOP_1,FINSEQ_2,FUNCT_2,MARGREL1;
theorems MSUALG_1,MSUALG_2,PBOOLE,TARSKI,UNIALG_1,UNIALG_2,FUNCT_1,RELAT_1,FUNCOP_1,PARTFUN1,FUNCT_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,ZFMISC_1,CARD_3,LATTICES,MSUHOM_1,XBOOLE_0,XBOOLE_1,ORDINAL1,STRUCT_0,MARGREL1,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14;
schemes FUNCT_2;
registrations XBOOLE_0,FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSEQ_2,RELAT_1,PBOOLE,STRUCT_0,UNIALG_1,UNIALG_2,MSUALG_1,MSUALG_2,FINSEQ_1,MARGREL1,CARD_1;
constructors BINOP_1,CARD_3,FINSEQOP,FILTER_1,UNIALG_2,LATTICE4,MSUALG_2,RELSET_1,MARGREL1,NAT_1;
requirements NUMERALS,SUBSET,BOOLE;
begin
reconsider z = ( 0 ) as (Element of { ( 0 ) }) by TARSKI:def 1;
theorem
Th15: (for U1,U2 being Universal_Algebra holds (( MSAlg U1 ) is (MSSubAlgebra of ( MSAlg U2 )) implies (for B being non  empty (Subset of U2) holds (B = (the carrier of U1) implies (the charact of U1) = ( Opers (U2,B) )))))
proof
let U1 being Universal_Algebra;
let U2 being Universal_Algebra;
set MU1 = ( MSAlg U1 );
set MU2 = ( MSAlg U2 );
A1: MU2 = MSAlgebra (# ( MSSorts U2 ),( MSCharact U2 ) #) by MSUALG_1:def 11;
assume A2: MU1 is (MSSubAlgebra of MU2);
then reconsider MU1 as MSAlgebra over ( MSSign U2 );
reconsider C = (the Sorts of MU1) as (MSSubset of MU2) by A2,MSUALG_2:def 9;
A3: (the Charact of MU1) = ( Opers (MU2,C) ) by A2,MSUALG_2:def 9;
set gg1 = ( ( *--> ( 0 ) ) * ( signature U2 ) );
set gg2 = ( ( dom ( signature U2 ) ) --> z );
reconsider gg1 as (Function of ( dom ( signature U2 ) ),( { ( 0 ) } * )) by MSUALG_1:2;
A4: ( MSSign U2 ) = ManySortedSign (# { ( 0 ) },( dom ( signature U2 ) ),gg1,gg2 #) by MSUALG_1:10;
let B being non  empty (Subset of U2);
assume A5: B = (the carrier of U1);
then reconsider ch1 = (the charact of U1) as (PFuncFinSequence of B);
A6: MU1 = MSAlgebra (# ( MSSorts U1 ),( MSCharact U1 ) #) by MSUALG_1:def 11;
then A7: ( dom ch1 ) = ( dom (the Charact of MU1) ) by MSUALG_1:def 10
.= (the carrier' of ( MSSign U2 )) by PARTFUN1:def 2
.= ( Seg ( len ( signature U2 ) ) ) by A4,FINSEQ_1:def 3
.= ( Seg ( len (the charact of U2) ) ) by UNIALG_1:def 4
.= ( dom (the charact of U2) ) by FINSEQ_1:def 3;
A8: C is  opers_closed by A2,MSUALG_2:def 9;
(for n being set holds (for o being (operation of U2) holds ((n in ( dom ch1 ) & o = ( (the charact of U2) . n )) implies ( ch1 . n ) = ( o /. B ))))
proof
A9: C = ( ( 0 ) .--> (the carrier of U1) ) by A6,MSUALG_1:def 9;
then ( dom C ) = { ( 0 ) } by FUNCOP_1:13;
then A10: ( 0 ) in ( dom C ) by TARSKI:def 1;
let n being set;
let o being (operation of U2);
assume that
A11: n in ( dom ch1 )
and
A12: o = ( (the charact of U2) . n );
n in ( dom (the Charact of MU2) ) by A1,A7,A11,MSUALG_1:def 10;
then reconsider N = n as (OperSymbol of ( MSSign U2 )) by PARTFUN1:def 2;
A13: (( dom (the charact of U2) ) = ( Seg ( len (the charact of U2) ) ) & ( dom ( signature U2 ) ) = ( Seg ( len ( signature U2 ) ) )) by FINSEQ_1:def 3;
then A14: N in ( dom ( signature U2 ) ) by A7,A11,UNIALG_1:def 4;
( ( arity o ) |-> ( 0 ) ) is (FinSequence of (the carrier of ( MSSign U2 ))) by A4,FINSEQ_2:63;
then reconsider ao0 = ( ( arity o ) |-> ( 0 ) ) as (Element of ( (the carrier of ( MSSign U2 )) * )) by FINSEQ_1:def 11;
A15: C is_closed_on N by A8,MSUALG_2:def 6;
B is  opers_closed by A2,A5,CKB14:1;
then A16: B is_closed_on o by UNIALG_2:def 4;
A17: ( 0 ) in { ( 0 ) } by TARSKI:def 1;
N in ( dom ( signature U2 ) ) by A7,A11,A13,UNIALG_1:def 4;
then (( dom ( *--> ( 0 ) ) ) = ( NAT ) & ( ( signature U2 ) . N ) = ( arity o )) by A12,FUNCT_2:def 1,UNIALG_1:def 4;
then A18: N in ( dom ( ( *--> ( 0 ) ) * ( signature U2 ) ) ) by A14,FUNCT_1:11;
then ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . N ) = ( ( C # ) . ( ( ( *--> ( 0 ) ) * ( signature U2 ) ) . N ) ) by A4,FUNCT_1:13
.= ( ( C # ) . ( ( *--> ( 0 ) ) . ( ( signature U2 ) . N ) ) ) by A18,FUNCT_1:12
.= ( ( C # ) . ( ( *--> ( 0 ) ) . ( arity o ) ) ) by A12,A14,UNIALG_1:def 4
.= ( ( C # ) . ( ( arity o ) |-> ( 0 ) ) ) by FINSEQ_2:def 6;
then A19: ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . N ) = ( product ( C * ao0 ) ) by FINSEQ_2:def 5
.= ( product ( ( Seg ( arity o ) ) --> ( C . ( 0 ) ) ) ) by A10,FUNCOP_1:17
.= ( product ( ( Seg ( arity o ) ) --> B ) ) by A5,A9,A17,FUNCOP_1:7
.= ( Funcs (( Seg ( arity o ) ),B) ) by CARD_3:11
.= ( ( arity o ) -tuples_on B ) by FINSEQ_2:93;
( ch1 . N ) = ( (the Charact of MU1) . N ) by A6,MSUALG_1:def 10
.= ( N /. C ) by A3,MSUALG_2:def 8
.= ( ( Den (N,MU2) ) | ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . N ) ) by A15,MSUALG_2:def 7
.= ( ( ( MSCharact U2 ) . N ) | ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . N ) ) by A1,MSUALG_1:def 6
.= ( o | ( ( arity o ) -tuples_on B ) ) by A12,A19,MSUALG_1:def 10;
hence thesis by A16,UNIALG_2:def 5;
end;
hence thesis by A7,UNIALG_2:def 6;
end;
