environ
vocabularies NAT_1,PBOOLE,FUNCT_1,CARD_1,XBOOLE_0,FINSEQ_2,FINSEQ_1,RELAT_1,TARSKI,NUMBERS,SUBSET_1,UNIALG_1,UNIALG_2,MSUALG_1,FUNCOP_1,CQC_SIM1,STRUCT_0,MSUALG_2,MARGREL1,PARTFUN1,CARD_3,FUNCT_2,ZFMISC_1,EQREL_1,INCPROJ,WELLORD1,GROUP_6,LATTICES;
notations TARSKI,XBOOLE_0,SUBSET_1,BINOP_1,CARD_3,NAT_1,LATTICES,LATTICE4,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,STRUCT_0,PBOOLE,UNIALG_1,UNIALG_2,NUMBERS,FINSEQ_1,FINSEQ_2,MARGREL1,MSUALG_1,MSUALG_2;
definitions TARSKI,XBOOLE_0,MSUALG_2,PBOOLE,LATTICE4,UNIALG_1,UNIALG_2,FUNCOP_1,FINSEQ_2,FUNCT_2,MARGREL1;
theorems MSUALG_1,MSUALG_2,PBOOLE,TARSKI,UNIALG_1,UNIALG_2,FUNCT_1,RELAT_1,FUNCOP_1,PARTFUN1,FUNCT_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,ZFMISC_1,CARD_3,LATTICES,MSUHOM_1,XBOOLE_0,XBOOLE_1,ORDINAL1,STRUCT_0,MARGREL1,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13;
schemes FUNCT_2;
registrations XBOOLE_0,FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSEQ_2,RELAT_1,PBOOLE,STRUCT_0,UNIALG_1,UNIALG_2,MSUALG_1,MSUALG_2,FINSEQ_1,MARGREL1,CARD_1;
constructors BINOP_1,CARD_3,FINSEQOP,FILTER_1,UNIALG_2,LATTICE4,MSUALG_2,RELSET_1,MARGREL1,NAT_1;
requirements NUMERALS,SUBSET,BOOLE;
begin
reconsider z = ( 0 ) as (Element of { ( 0 ) }) by TARSKI:def 1;
theorem
Th14: (for U1,U2 being Universal_Algebra holds (( MSAlg U1 ) is (MSSubAlgebra of ( MSAlg U2 )) implies (for B being non  empty (Subset of U2) holds (B = (the carrier of U1) implies B is  opers_closed))))
proof
let U1 being Universal_Algebra;
let U2 being Universal_Algebra;
set MU1 = ( MSAlg U1 );
set MU2 = ( MSAlg U2 );
A1: MU2 = MSAlgebra (# ( MSSorts U2 ),( MSCharact U2 ) #) by MSUALG_1:def 11;
assume A2: MU1 is (MSSubAlgebra of MU2);
then reconsider MU1 as MSAlgebra over ( MSSign U2 );
let B being non  empty (Subset of U2);
assume A3: B = (the carrier of U1);
let o being (operation of U2);
reconsider C = (the Sorts of MU1) as (MSSubset of MU2) by A2,MSUALG_2:def 9;
A4: MU1 = MSAlgebra (# ( MSSorts U1 ),( MSCharact U1 ) #) by MSUALG_1:def 11;
set gg1 = ( ( *--> ( 0 ) ) * ( signature U2 ) );
set gg2 = ( ( dom ( signature U2 ) ) --> z );
reconsider gg1 as (Function of ( dom ( signature U2 ) ),( { ( 0 ) } * )) by MSUALG_1:2;
A5: ( MSSign U2 ) = ManySortedSign (# { ( 0 ) },( dom ( signature U2 ) ),gg1,gg2 #) by MSUALG_1:10;
A6: C is  opers_closed by A2,MSUALG_2:def 9;
thus B is_closed_on o
proof
A7: ( 0 ) in { ( 0 ) } by TARSKI:def 1;
let s being (FinSequence of B);
consider n being set such that A8: n in ( dom (the charact of U2) ) and A9: o = ( (the charact of U2) . n ) by FUNCT_1:def 3;
A10: (( dom (the charact of U2) ) = ( Seg ( len (the charact of U2) ) ) & ( dom ( signature U2 ) ) = ( Seg ( len ( signature U2 ) ) )) by FINSEQ_1:def 3;
then A11: n in ( dom ( signature U2 ) ) by A8,UNIALG_1:def 4;
reconsider n as (OperSymbol of ( MSSign U2 )) by A5,A8,A10,UNIALG_1:def 4;
assume A12: ( len s ) = ( arity o );
(ex y being set st (y in ( dom ( ( Den (n,MU2) ) | ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) ) ) & ( ( ( Den (n,MU2) ) | ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) ) . y ) = ( o . s )))
proof
take s;
thus s in ( dom ( ( Den (n,MU2) ) | ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) ) )
proof
( ( arity o ) |-> ( 0 ) ) is (FinSequence of (the carrier of ( MSSign U2 ))) by A5,FINSEQ_2:63;
then reconsider ao0 = ( ( arity o ) |-> ( 0 ) ) as (Element of ( (the carrier of ( MSSign U2 )) * )) by FINSEQ_1:def 11;
A13:now
assume ( Seg ( arity o ) ) = ( {} );
then ( ( arity o ) |-> ( 0 ) ) = ( <*> (the carrier of ( MSSign U2 )) );
hence ( ( arity o ) |-> ( 0 ) ) is (FinSequence of (the carrier of ( MSSign U2 )));
end;
(( Seg ( arity o ) ) <> ( {} ) implies (( dom ( ( arity o ) |-> ( 0 ) ) ) = ( Seg ( arity o ) ) & ( rng ( ( arity o ) |-> ( 0 ) ) ) c= (the carrier of ( MSSign U2 )))) by A5,FUNCOP_1:13;
then ( ( arity o ) |-> ( 0 ) ) is (FinSequence of (the carrier of ( MSSign U2 ))) by A13,FINSEQ_1:def 4;
then reconsider aro = ( ( arity o ) |-> ( 0 ) ) as (Element of ( (the carrier of ( MSSign U2 )) * )) by FINSEQ_1:def 11;
A14: ( dom (the Arity of ( MSSign U2 )) ) = (the carrier' of ( MSSign U2 )) by FUNCT_2:def 1;
(the Sorts of MU2) = ( ( 0 ) .--> (the carrier of U2) ) by A1,MSUALG_1:def 9;
then A15: ( (the Sorts of MU2) * aro ) = ( ( arity o ) |-> (the carrier of U2) ) by FINSEQ_2:144
.= ( ( Seg ( arity o ) ) --> (the carrier of U2) );
( dom s ) = ( Seg ( arity o ) ) by A12,FINSEQ_1:def 3;
then A16: ( dom s ) = ( dom ( (the Sorts of MU2) * aro ) ) by A15,FUNCT_2:def 1;
A17: (for x being set holds (x in ( dom ( (the Sorts of MU2) * aro ) ) implies ( s . x ) in ( ( (the Sorts of MU2) * aro ) . x )))
proof
let x being set;
( rng s ) c= B by FINSEQ_1:def 4;
then A18: ( rng s ) c= (the carrier of U2) by XBOOLE_1:1;
assume A19: x in ( dom ( (the Sorts of MU2) * aro ) );
then A20: x in ( Seg ( arity o ) ) by A15,FUNCT_2:def 1;
( s . x ) in ( rng s ) by A16,A19,FUNCT_1:def 3;
then A21: (( 0 ) in { ( 0 ) } & ( s . x ) in (the carrier of U2)) by A18,TARSKI:def 1;
( ( (the Sorts of MU2) * aro ) . x ) = ( (the Sorts of MU2) . ( aro . x ) ) by A19,FUNCT_1:12
.= ( ( MSSorts U2 ) . ( 0 ) ) by A1,A20,FUNCOP_1:7
.= ( ( ( 0 ) .--> (the carrier of U2) ) . ( 0 ) ) by MSUALG_1:def 9;
hence thesis by A21,FUNCOP_1:7;
end;
( dom ( Den (n,MU2) ) ) = ( Args (n,MU2) ) by FUNCT_2:def 1;
then ( dom ( Den (n,MU2) ) ) = ( ( ( (the Sorts of MU2) # ) * (the Arity of ( MSSign U2 )) ) . n ) by MSUALG_1:def 4
.= ( ( (the Sorts of MU2) # ) . ( ( ( *--> ( 0 ) ) * ( signature U2 ) ) . n ) ) by A5,A14,FUNCT_1:13
.= ( ( (the Sorts of MU2) # ) . ( ( *--> ( 0 ) ) . ( ( signature U2 ) . n ) ) ) by A11,FUNCT_1:13
.= ( ( (the Sorts of MU2) # ) . ( ( *--> ( 0 ) ) . ( arity o ) ) ) by A9,A11,UNIALG_1:def 4
.= ( ( (the Sorts of MU2) # ) . ( ( arity o ) |-> ( 0 ) ) ) by FINSEQ_2:def 6;
then ( dom ( Den (n,MU2) ) ) = ( product ( (the Sorts of MU2) * aro ) ) by FINSEQ_2:def 5;
then A22: s in ( dom ( Den (n,MU2) ) ) by A16,A17,CARD_3:def 5;
A23: s is (Element of ( ( len s ) -tuples_on B )) by FINSEQ_2:92;
A24: ( 0 ) in { ( 0 ) } by TARSKI:def 1;
A25: n in ( dom ( signature U2 ) ) by A8,A10,UNIALG_1:def 4;
A26: C = ( ( 0 ) .--> (the carrier of U1) ) by A4,MSUALG_1:def 9;
then ( dom C ) = { ( 0 ) } by FUNCOP_1:13;
then A27: ( 0 ) in ( dom C ) by TARSKI:def 1;
(( dom ( *--> ( 0 ) ) ) = ( NAT ) & ( ( signature U2 ) . n ) = ( arity o )) by A9,A11,FUNCT_2:def 1,UNIALG_1:def 4;
then A28: n in ( dom ( ( *--> ( 0 ) ) * ( signature U2 ) ) ) by A25,FUNCT_1:11;
then ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) = ( ( C # ) . ( ( ( *--> ( 0 ) ) * ( signature U2 ) ) . n ) ) by A5,FUNCT_1:13
.= ( ( C # ) . ( ( *--> ( 0 ) ) . ( ( signature U2 ) . n ) ) ) by A28,FUNCT_1:12
.= ( ( C # ) . ( ( *--> ( 0 ) ) . ( arity o ) ) ) by A9,A25,UNIALG_1:def 4
.= ( ( C # ) . ( ( arity o ) |-> ( 0 ) ) ) by FINSEQ_2:def 6;
then ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) = ( product ( C * ao0 ) ) by FINSEQ_2:def 5
.= ( product ( ( Seg ( arity o ) ) --> ( C . ( 0 ) ) ) ) by A27,FUNCOP_1:17
.= ( product ( ( Seg ( arity o ) ) --> B ) ) by A3,A26,A24,FUNCOP_1:7
.= ( Funcs (( Seg ( arity o ) ),B) ) by CARD_3:11
.= ( ( arity o ) -tuples_on B ) by FINSEQ_2:93;
then s in ( ( dom ( Den (n,MU2) ) ) /\ ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) ) by A12,A22,A23,XBOOLE_0:def 4;
hence thesis by RELAT_1:61;
end;

hence ( ( ( Den (n,MU2) ) | ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) ) . s ) = ( ( Den (n,MU2) ) . s ) by FUNCT_1:47
.= ( ( ( MSCharact U2 ) . n ) . s ) by A1,MSUALG_1:def 6
.= ( o . s ) by A9,MSUALG_1:def 10;
end;
then A29: ( o . s ) in ( rng ( ( Den (n,MU2) ) | ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) ) ) by FUNCT_1:def 3;
C is_closed_on n by A6,MSUALG_2:def 6;
then A30: ( rng ( ( Den (n,MU2) ) | ( ( ( C # ) * (the Arity of ( MSSign U2 )) ) . n ) ) ) c= ( ( C * (the ResultSort of ( MSSign U2 )) ) . n ) by MSUALG_2:def 5;
n in ( dom ( ( dom ( signature U2 ) ) --> ( 0 ) ) ) by A11,FUNCOP_1:13;
then ( ( C * (the ResultSort of ( MSSign U2 )) ) . n ) = ( C . ( ( ( dom ( signature U2 ) ) --> ( 0 ) ) . n ) ) by A5,FUNCT_1:13
.= ( (the Sorts of MU1) . ( 0 ) ) by A11,FUNCOP_1:7
.= ( ( ( 0 ) .--> (the carrier of U1) ) . ( 0 ) ) by A4,MSUALG_1:def 9
.= B by A3,A7,FUNCOP_1:7;
hence thesis by A30,A29;
end;

end;
