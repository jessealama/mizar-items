environ
vocabularies TARSKI,XBOOLE_0,FUNCT_1,RELAT_1,SUBSET_1,FINSUB_1,BINOP_1,FINSET_1,FUNCOP_1,SETWISEO;
notations TARSKI,XBOOLE_0,ENUMSET1,SUBSET_1,RELAT_1,FUNCT_1,FINSUB_1,RELSET_1,FINSET_1,PARTFUN1,FUNCT_2,BINOP_1,FUNCOP_1,CKB16,CKB18,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB33;
definitions BINOP_1,TARSKI,RELAT_1,CKB16,CKB18,CKB33;
theorems FINSUB_1,ZFMISC_1,SUBSET_1,BINOP_1,TARSKI,FUNCT_1,FUNCT_2,FUNCOP_1,ENUMSET1,RELAT_1,XBOOLE_0,XBOOLE_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB16,CKB18,CKB19,CKB20,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43;
schemes FINSET_1,FUNCT_2,BINOP_1,SUBSET_1,CKB17,CKB30,CKB31,CKB32;
registrations XBOOLE_0,SUBSET_1,RELSET_1,FUNCT_2,FINSET_1,FINSUB_1,CKB15,CKB21;
constructors ENUMSET1,PARTFUN1,BINOP_1,FUNCOP_1,FINSET_1,FINSUB_1,RELSET_1,CKB16,CKB18,CKB25,CKB26,CKB27,CKB28,CKB29,CKB33;
requirements BOOLE,SUBSET;
begin
reserve X for non empty set;
reserve Y for non empty set;
reserve F for (BinOp of Y);
theorem
Th35: (((F is  commutative & F is  associative) & F is  idempotent) implies (for f,g being (Function of X,Y) holds (for A,B being (Element of ( Fin X )) holds ((A <> ( {} ) & ( f .: A ) = ( g .: B )) implies ( F $$ (A,f) ) = ( F $$ (B,g) )))))
proof
assume that
A1: F is  commutative
and
A2: F is  associative
and
A3: F is  idempotent;
let f being (Function of X,Y),g being (Function of X,Y);
defpred X[ (Element of ( Fin X )) ]
 means
($1 <> ( {} ) implies (for B being (Element of ( Fin X )) holds (( f .: $1 ) = ( g .: B ) implies ( F $$ ($1,f) ) = ( F $$ (B,g) ))));
A4: (for B9 being (Element of ( Fin X )) holds (for b being (Element of X) holds (X[ B9 ] implies X[ ( B9 \/ {. b .} ) ])))
proof
let A being (Element of ( Fin X ));
let x being (Element of X);
assume that
A5: (A <> ( {} ) implies (for B being (Element of ( Fin X )) holds (( f .: A ) = ( g .: B ) implies ( F $$ (A,f) ) = ( F $$ (B,g) ))));
assume ( A \/ { x } ) <> ( {} );
let B being (Element of ( Fin X ));
assume that
A6: ( f .: ( A \/ { x } ) ) = ( g .: B );
per cases ;
suppose ( f . x ) in ( f .: A );

then consider x9 being (Element of X) such that A7: x9 in A and A8: ( f . x9 ) = ( f . x ) by FUNCT_2:65;
A9: ( g .: B ) = ( ( f .: A ) \/ ( Im (f,x) ) ) by A6,RELAT_1:120
.= ( ( f .: A ) \/ { ( f . x ) } ) by CKB8:1
.= ( f .: A ) by A7,A8,FUNCT_2:35,ZFMISC_1:40;
thus ( F $$ (( A \/ {. x .} ),f) ) = ( F . (( F $$ (A,f) ),( f . x )) ) by A1,A2,A3,A7,CKB38:1
.= ( F . (( F $$ (( A \/ {. x9 .} ),f) ),( f . x )) ) by A7,ZFMISC_1:40
.= ( F . (( F . (( F $$ (A,f) ),( f . x9 )) ),( f . x )) ) by A1,A2,A3,A7,CKB38:1
.= ( F . (( F $$ (A,f) ),( F . (( f . x9 ),( f . x9 )) )) ) by A2,A8,BINOP_1:def 3
.= ( F . (( F $$ (A,f) ),( f . x9 )) ) by A3,BINOP_1:def 4
.= ( F $$ (( A \/ {. x9 .} ),f) ) by A1,A2,A3,A7,CKB38:1
.= ( F $$ (A,f) ) by A7,ZFMISC_1:40
.= ( F $$ (B,g) ) by A5,A7,A9;
end;
suppose A10: (not ( f . x ) in ( f .: A ));

per cases ;
suppose A11: A = ( {} );

then A12: ( g .: B ) = ( Im (f,x) ) by A6
.= { ( f . x ) } by CKB8:1;
thus ( F $$ (( A \/ {. x .} ),f) ) = ( f . x ) by A1,A2,A11,CKB35:1
.= ( F $$ (B,g) ) by A1,A2,A3,A12,CKB43:1;
end;
suppose A13: A <> ( {} );

reconsider B1 = ( B \ ( g " { ( f . x ) } ) ) as (Element of ( Fin X )) by CKB11:1;
A14:now
assume B1 = ( {} );
then B c= ( g " { ( f . x ) } ) by XBOOLE_1:37;
then A15: ( g .: B ) c= ( g .: ( g " { ( f . x ) } ) ) by RELAT_1:123;
A16: ( f .: A ) misses { ( f . x ) } by A10,ZFMISC_1:50;
( g .: ( g " { ( f . x ) } ) ) c= { ( f . x ) } by FUNCT_1:75;
then ( f .: ( A \/ { x } ) ) c= { ( f . x ) } by A6,A15,XBOOLE_1:1;
then ( ( f .: A ) \/ ( f .: { x } ) ) c= { ( f . x ) } by RELAT_1:120;
then ( f .: A ) = ( ( f .: A ) /\ { ( f . x ) } ) by XBOOLE_1:11,XBOOLE_1:28
.= ( {} ) by A16,XBOOLE_0:def 7;
hence contradiction by A13,CKB14:1;
end;
reconsider B2 = ( B /\ ( g " { ( f . x ) } ) ) as (Element of ( Fin X )) by CKB11:1,XBOOLE_1:17;
A17: B = ( B1 \/ B2 ) by XBOOLE_1:51;
A18: (for b being (Element of X) holds (b in B2 implies ( g . b ) = ( f . x )))
proof
let b being (Element of X);
assume b in B2;
then b in ( g " { ( f . x ) } ) by XBOOLE_0:def 4;
then ( g . b ) in { ( f . x ) } by FUNCT_1:def 7;
hence thesis by TARSKI:def 1;
end;
A19: ( f .: A ) = ( ( f .: A ) \ { ( f . x ) } ) by A10,ZFMISC_1:57
.= ( ( f .: A ) \ ( Im (f,x) ) ) by CKB8:1
.= ( ( ( f .: A ) \/ ( f .: { x } ) ) \ ( f .: { x } ) ) by XBOOLE_1:40
.= ( ( f .: ( A \/ { x } ) ) \ ( Im (f,x) ) ) by RELAT_1:120
.= ( ( g .: B ) \ { ( f . x ) } ) by A6,CKB8:1
.= ( g .: B1 ) by CKB6:1;
x in ( A \/ { x } ) by CKB4:1;
then consider x9 being (Element of X) such that A20: x9 in B and A21: ( g . x9 ) = ( f . x ) by A6,FUNCT_2:35,FUNCT_2:65;
x9 in ( g " { ( f . x ) } ) by A21,CKB7:1;
then A22: B2 <> ( {} ) by A20,XBOOLE_0:def 4;
thus ( F $$ (( A \/ {. x .} ),f) ) = ( F . (( F $$ (A,f) ),( f . x )) ) by A1,A2,A3,A13,CKB38:1
.= ( F . (( F $$ (B1,g) ),( f . x )) ) by A5,A13,A19
.= ( F . (( F $$ (B1,g) ),( F $$ (B2,g) )) ) by A1,A2,A3,A22,A18,CKB42:1
.= ( F $$ (B,g) ) by A1,A2,A3,A17,A14,A22,CKB39:1;
end;
end;
end;
A23: X[ ( {}. X ) ];
A24: (for A being (Element of ( Fin X )) holds X[ A ]) from CKB32:sch 1(A23,A4);
let A being (Element of ( Fin X )),B being (Element of ( Fin X ));
assume (A <> ( {} ) & ( f .: A ) = ( g .: B ));
hence thesis by A24;
end;
