environ
vocabularies NUMBERS,XBOOLE_0,SUBSET_1,NAT_1,REAL_1,FINSEQ_1,MATRIX_1,CARD_1,ARYTM_3,XXREAL_0,INT_1,ARYTM_1,RELAT_1,TAYLOR_1,FUNCT_1,XXREAL_1,LIMFUNC1,POWER,PARTFUN1,FDIFF_1,ORDINAL2,TARSKI,CARD_3,SEQ_1,SUPINF_2,PARTFUN3,XREAL_0,ORDINAL1,RVSUM_1,ORDINAL4,FINSEQ_2,MATRPROB,MATRIXC1,TREES_1,INCSP_1,MATRIXR1,FVSUM_1,ZFMISC_1,FUNCOP_1,ENTROPY1;
notations TARSKI,SUBSET_1,XBOOLE_0,XXREAL_0,XREAL_0,REAL_1,NAT_1,NAT_D,ORDINAL1,NUMBERS,RELAT_1,FUNCT_1,VALUED_1,SEQ_1,ZFMISC_1,PARTFUN1,FUNCOP_1,RVSUM_1,FINSEQ_1,FINSEQ_2,NEWTON,MATRIXR1,MATRIX_1,PARTFUN3,POWER,LIMFUNC1,RCOMP_1,MATRPROB,FDIFF_1,TAYLOR_1,FCONT_1,CKB10,CKB11,CKB14,CKB31,CKB34,CKB49,CKB58,CKB59,CKB66,CKB69;
definitions TARSKI,PARTFUN3,FINSEQ_2,LIMFUNC1,RCOMP_1,VALUED_1,XCMPLX_0,TAYLOR_1,CKB11,CKB14,CKB31,CKB34,CKB49,CKB58,CKB59,CKB66,CKB69;
theorems FUNCT_1,NAT_1,MATRIX_2,XREAL_1,NAT_2,MATRIXR1,GOBOARD1,XBOOLE_0,PROB_3,INTEGRA5,FINSEQ_1,MATRIX_1,GOBRD13,FINSEQ_2,PARTFUN3,FINSEQ_3,RVSUM_1,POWER,FDIFF_1,TREES_1,XBOOLE_1,TAYLOR_1,RELAT_1,ROLLE,FCONT_1,XCMPLX_1,INTEGRA1,XXREAL_0,ORDINAL1,MATRPROB,FUNCOP_1,PEPIN,NAT_D,PARTFUN1,VALUED_1,XXREAL_1,XXREAL_2,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB11,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB20,CKB21,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71;
schemes FINSEQ_2,SEQ_1,NAT_1,RECDEF_1,FINSEQ_1,MATRIX_1;
registrations MATRPROB,RELSET_1,NAT_1,MEMBERED,ORDINAL1,XREAL_0,FCONT_3,RCOMP_1,XXREAL_0,NUMBERS,XBOOLE_0,VALUED_0,FINSEQ_1,CARD_1,XXREAL_2,FINSEQ_2,CKB12,CKB19,CKB22,CKB23,CKB32;
constructors REAL_1,NAT_D,BINOP_2,MATRIX_3,MATRIXR1,MATRLIN,MATRPROB,PARTFUN3,PARTFUN2,FDIFF_1,FCONT_1,POWER,LIMFUNC1,SIN_COS,TAYLOR_1,INTEGRA1,SEQ_1,XXREAL_2,RVSUM_1,RELSET_1,NEWTON,CKB14,CKB31,CKB34,CKB49,CKB58,CKB59,CKB66,CKB69;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve k for (Element of ( NAT ));
theorem
Th57: (for p,q being non empty  ProbFinS (FinSequence of ( REAL )) holds (for pp,qq being (FinSequence of ( REAL )) holds ((((( len p ) = ( len q ) & ( len pp ) = ( len p )) & ( len qq ) = ( len q )) & (for k holds (k in ( dom p ) implies (((( p . k ) > ( 0 ) & ( q . k ) > ( 0 )) & ( pp . k ) = ( - ( ( p . k ) * ( log (2,( p . k )) ) ) )) & ( qq . k ) = ( - ( ( p . k ) * ( log (2,( q . k )) ) ) ))))) implies ((( Sum pp ) <= ( Sum qq ) & ((for k holds (k in ( dom p ) implies ( p . k ) = ( q . k ))) iff ( Sum pp ) = ( Sum qq ))) & ((ex k st (k in ( dom p ) & ( p . k ) <> ( q . k ))) iff ( Sum pp ) < ( Sum qq ))))))
proof
let p being non empty  ProbFinS (FinSequence of ( REAL )),q being non empty  ProbFinS (FinSequence of ( REAL ));
let pp being (FinSequence of ( REAL )),qq being (FinSequence of ( REAL ));
assume that
A1: ( len p ) = ( len q )
and
A2: ( len pp ) = ( len p )
and
A3: ( len qq ) = ( len q )
and
A4: (for k holds (k in ( dom p ) implies (((( p . k ) > ( 0 ) & ( q . k ) > ( 0 )) & ( pp . k ) = ( - ( ( p . k ) * ( log (2,( p . k )) ) ) )) & ( qq . k ) = ( - ( ( p . k ) * ( log (2,( q . k )) ) ) ))));
set p1 = ( pp - qq );
A5: ( number_e ) <> 1 by TAYLOR_1:11;
A6: ( len ( pp - qq ) ) = ( len p ) by A1,A2,A3,RVSUM_1:116;
then A7: ( dom ( pp - qq ) ) = ( dom pp ) by A2,FINSEQ_3:29;
then (for k holds (k in ( dom pp ) implies ( ( pp - qq ) . k ) = ( ( pp . k ) - ( qq . k ) ))) by VALUED_1:13;
then A8: ( ( Sum pp ) - ( Sum qq ) ) = ( Sum ( pp - qq ) ) by A1,A2,A3,A6,CKB8:1;
A9: ( dom pp ) = ( Seg ( len pp ) ) by FINSEQ_1:def 3
.= ( dom p ) by A2,FINSEQ_1:def 3;
A10: (for k holds (k in ( dom p ) implies ( p1 . k ) = ( ( ( p . k ) * ( log (2,( number_e )) ) ) * ( log (( number_e ),( ( q . k ) / ( p . k ) )) ) )))
proof
let k;
assume that
A11: k in ( dom p );
A12: ( pp . k ) = ( - ( ( p . k ) * ( log (2,( p . k )) ) ) ) by A4,A11;
A13: ( qq . k ) = ( - ( ( p . k ) * ( log (2,( q . k )) ) ) ) by A4,A11;
A14: ( p . k ) > ( 0 ) by A4,A11;
then A15: ( - ( log (2,( p . k )) ) ) = ( log (2,( 1 / ( p . k ) )) ) by CKB5:1;
A16: ( q . k ) > ( 0 ) by A4,A11;
then ( ( q . k ) / ( p . k ) ) > ( 0 ) by A14,XREAL_1:139;
then A17: ( log (2,( ( q . k ) / ( p . k ) )) ) = ( ( log (2,( number_e )) ) * ( log (( number_e ),( ( q . k ) / ( p . k ) )) ) ) by A5,POWER:56,TAYLOR_1:11;
thus ( p1 . k ) = ( ( pp . k ) - ( qq . k ) ) by A7,A9,A11,VALUED_1:13
.= ( ( p . k ) * ( ( log (2,( 1 / ( p . k ) )) ) + ( log (2,( q . k )) ) ) ) by A12,A13,A15
.= ( ( p . k ) * ( log (2,( ( 1 / ( p . k ) ) * ( q . k ) )) ) ) by A14,A16,POWER:53
.= ( ( ( p . k ) * ( log (2,( number_e )) ) ) * ( log (( number_e ),( ( q . k ) / ( p . k ) )) ) ) by A17;
end;
set n = ( len p );
deffunc F(Nat) = ( ( ( p . $1 ) * ( log (2,( number_e )) ) ) * ( ( ( q . $1 ) / ( p . $1 ) ) - 1 ) );
consider p2 being (FinSequence of ( REAL )) such that A18: ( len p2 ) = n and A19: (for k being Nat holds (k in ( dom p2 ) implies ( p2 . k ) = F(k))) from FINSEQ_2:sch 1;
A20: ( dom p2 ) = ( Seg ( len p2 ) ) by FINSEQ_1:def 3
.= ( dom p ) by A18,FINSEQ_1:def 3;
A21: ( len p1 ) = ( len p ) by A1,A2,A3,RVSUM_1:116;
then A22: p1 is (Element of ( n -tuples_on ( REAL ) )) by FINSEQ_2:92;
A23: ( dom p2 ) = ( Seg n ) by A18,FINSEQ_1:def 3;
A24: ( len ( q - p ) ) = ( len q ) by A1,RVSUM_1:116;
A25: (for k holds (k in ( dom q ) implies ( ( q - p ) . k ) = ( ( q . k ) - ( p . k ) )))
proof
let k;
assume k in ( dom q );
then k in ( dom ( q - p ) ) by A24,FINSEQ_3:29;
hence thesis by VALUED_1:13;
end;
A26: ( dom p ) = ( Seg n ) by FINSEQ_1:def 3;
A27: ( dom ( q - p ) ) = ( dom p2 ) by A1,A18,A24,FINSEQ_3:29;
A28: (for k being Nat holds (k in ( dom p2 ) implies ( p2 . k ) = ( ( ( log (2,( number_e )) ) * ( q - p ) ) . k )))
proof
let k being Nat;
assume that
A29: k in ( dom p2 );
A30: ( p . k ) > ( 0 ) by A4,A20,A29;
thus ( p2 . k ) = ( ( ( log (2,( number_e )) ) * ( p . k ) ) * ( ( ( q . k ) / ( p . k ) ) - 1 ) ) by A19,A29
.= ( ( log (2,( number_e )) ) * ( ( ( ( p . k ) / ( p . k ) ) * ( q . k ) ) - ( p . k ) ) )
.= ( ( log (2,( number_e )) ) * ( ( 1 * ( q . k ) ) - ( p . k ) ) ) by A30,XCMPLX_1:60
.= ( ( log (2,( number_e )) ) * ( ( q - p ) . k ) ) by A27,A29,VALUED_1:13
.= ( ( ( log (2,( number_e )) ) * ( q - p ) ) . k ) by RVSUM_1:44;
end;
( dom p2 ) = ( dom ( ( log (2,( number_e )) ) * ( q - p ) ) ) by A27,VALUED_1:def 5;
then A31: ( Sum p2 ) = ( Sum ( ( log (2,( number_e )) ) * ( q - p ) ) ) by A28,FINSEQ_1:13
.= ( ( log (2,( number_e )) ) * ( Sum ( q - p ) ) ) by RVSUM_1:87
.= ( ( log (2,( number_e )) ) * ( ( Sum q ) - ( Sum p ) ) ) by A1,A24,A25,CKB8:1
.= ( ( log (2,( number_e )) ) * ( 1 - ( Sum p ) ) ) by MATRPROB:def 5
.= ( ( log (2,( number_e )) ) * ( 1 - 1 ) ) by MATRPROB:def 5
.= ( 0 );
( ( number_e ) - ( 0 ) ) > ( 2 - 1 ) by TAYLOR_1:11,XREAL_1:15;
then A32: ( log (2,( number_e )) ) > ( 0 ) by CKB4:1;
A33: (for k being Nat holds (k in ( Seg n ) implies ( p1 . k ) <= ( p2 . k )))
proof
let k being Nat;
assume that
A34: k in ( Seg n );
A35: k in ( dom p ) by A34,FINSEQ_1:def 3;
then A36: ( p . k ) > ( 0 ) by A4;
( q . k ) > ( 0 ) by A4,A35;
then ( ( q . k ) / ( p . k ) ) > ( 0 ) by A36,XREAL_1:139;
then ( log (( number_e ),( ( q . k ) / ( p . k ) )) ) <= ( ( ( q . k ) / ( p . k ) ) - 1 ) by CKB3:1;
then ( ( ( p . k ) * ( log (2,( number_e )) ) ) * ( log (( number_e ),( ( q . k ) / ( p . k ) )) ) ) <= ( ( ( p . k ) * ( log (2,( number_e )) ) ) * ( ( ( q . k ) / ( p . k ) ) - 1 ) ) by A32,A36,XREAL_1:64;
then ( p1 . k ) <= ( ( ( p . k ) * ( log (2,( number_e )) ) ) * ( ( ( q . k ) / ( p . k ) ) - 1 ) ) by A10,A35;
hence thesis by A19,A23,A34;
end;
A37: p2 is (Element of ( n -tuples_on ( REAL ) )) by A18,FINSEQ_2:92;
hence ( Sum pp ) <= ( Sum qq ) by A8,A33,A22,A31,RVSUM_1:82,XREAL_1:50;
A38: ((ex k st (k in ( Seg n ) & ( p . k ) <> ( q . k ))) implies ( Sum pp ) < ( Sum qq ))
proof
assume (ex k st (k in ( Seg n ) & ( p . k ) <> ( q . k )));
then consider k1 being Nat such that A39: k1 in ( Seg n ) and A40: ( p . k1 ) <> ( q . k1 );
A41: k1 in ( dom p ) by A39,FINSEQ_1:def 3;
then A42: ( p . k1 ) > ( 0 ) by A4;
then A43: ( ( p . k1 ) * ( log (2,( number_e )) ) ) > ( 0 ) by A32,XREAL_1:129;
( q . k1 ) > ( 0 ) by A4,A41;
then A44: ( ( q . k1 ) / ( p . k1 ) ) > ( 0 ) by A42,XREAL_1:139;
( ( q . k1 ) / ( p . k1 ) ) <> 1 by A40,XCMPLX_1:58;
then ( log (( number_e ),( ( q . k1 ) / ( p . k1 ) )) ) < ( ( ( q . k1 ) / ( p . k1 ) ) - 1 ) by A44,CKB3:1;
then ( ( ( p . k1 ) * ( log (2,( number_e )) ) ) * ( log (( number_e ),( ( q . k1 ) / ( p . k1 ) )) ) ) < ( ( ( p . k1 ) * ( log (2,( number_e )) ) ) * ( ( ( q . k1 ) / ( p . k1 ) ) - 1 ) ) by A43,XREAL_1:68;
then ( p1 . k1 ) < ( ( ( p . k1 ) * ( log (2,( number_e )) ) ) * ( ( ( q . k1 ) / ( p . k1 ) ) - 1 ) ) by A10,A41;
then ( p1 . k1 ) < ( p2 . k1 ) by A19,A23,A39;
then ( ( Sum pp ) - ( Sum qq ) ) < ( 0 ) by A8,A33,A22,A37,A31,A39,RVSUM_1:83;
hence thesis by XREAL_1:48;
end;
A45: ( dom p1 ) = ( dom p2 ) by A21,A18,FINSEQ_3:29;
thus ((for k holds (k in ( dom p ) implies ( p . k ) = ( q . k ))) iff ( Sum pp ) = ( Sum qq ))
proof
hereby
assume A46: (for k holds (k in ( dom p ) implies ( p . k ) = ( q . k )));
(for k being Nat holds (k in ( dom p ) implies ( p1 . k ) = ( p2 . k )))
proof
let k being Nat;
assume that
A47: k in ( dom p );
A48: ( p . k ) = ( q . k ) by A46,A47;
( p . k ) > ( 0 ) by A4,A47;
then ( ( q . k ) / ( p . k ) ) = 1 by A48,XCMPLX_1:60;
then ( ( ( p . k ) * ( log (2,( number_e )) ) ) * ( log (( number_e ),( ( q . k ) / ( p . k ) )) ) ) = ( ( ( p . k ) * ( log (2,( number_e )) ) ) * ( ( ( q . k ) / ( p . k ) ) - 1 ) ) by CKB3:1;
then A49: ( p1 . k ) = ( ( ( p . k ) * ( log (2,( number_e )) ) ) * ( ( ( q . k ) / ( p . k ) ) - 1 ) ) by A10,A47;
k in ( Seg n ) by A47,FINSEQ_1:def 3;
hence thesis by A19,A23,A49;
end;
then ( Sum p1 ) = ( 0 ) by A20,A45,A31,FINSEQ_1:13;
hence ( Sum pp ) = ( Sum qq ) by A8;
end;
assume A50: ( Sum pp ) = ( Sum qq );
assume (not (for k holds (k in ( dom p ) implies ( p . k ) = ( q . k ))));
hence contradiction by A26,A38,A50;
end;

hence thesis by A26,A38;
end;
