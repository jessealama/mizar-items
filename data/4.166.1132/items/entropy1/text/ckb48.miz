environ
vocabularies NUMBERS,XBOOLE_0,SUBSET_1,NAT_1,REAL_1,FINSEQ_1,MATRIX_1,CARD_1,ARYTM_3,XXREAL_0,INT_1,ARYTM_1,RELAT_1,TAYLOR_1,FUNCT_1,XXREAL_1,LIMFUNC1,POWER,PARTFUN1,FDIFF_1,ORDINAL2,TARSKI,CARD_3,SEQ_1,SUPINF_2,PARTFUN3,XREAL_0,ORDINAL1,RVSUM_1,ORDINAL4,FINSEQ_2,MATRPROB,MATRIXC1,TREES_1,INCSP_1,MATRIXR1,FVSUM_1,ZFMISC_1,FUNCOP_1,ENTROPY1;
notations TARSKI,SUBSET_1,XBOOLE_0,XXREAL_0,XREAL_0,REAL_1,NAT_1,NAT_D,ORDINAL1,NUMBERS,RELAT_1,FUNCT_1,VALUED_1,SEQ_1,ZFMISC_1,PARTFUN1,FUNCOP_1,RVSUM_1,FINSEQ_1,FINSEQ_2,NEWTON,MATRIXR1,MATRIX_1,PARTFUN3,POWER,LIMFUNC1,RCOMP_1,MATRPROB,FDIFF_1,TAYLOR_1,FCONT_1,CKB10,CKB11,CKB14,CKB31,CKB34;
definitions TARSKI,PARTFUN3,FINSEQ_2,LIMFUNC1,RCOMP_1,VALUED_1,XCMPLX_0,TAYLOR_1,CKB11,CKB14,CKB31,CKB34;
theorems FUNCT_1,NAT_1,MATRIX_2,XREAL_1,NAT_2,MATRIXR1,GOBOARD1,XBOOLE_0,PROB_3,INTEGRA5,FINSEQ_1,MATRIX_1,GOBRD13,FINSEQ_2,PARTFUN3,FINSEQ_3,RVSUM_1,POWER,FDIFF_1,TREES_1,XBOOLE_1,TAYLOR_1,RELAT_1,ROLLE,FCONT_1,XCMPLX_1,INTEGRA1,XXREAL_0,ORDINAL1,MATRPROB,FUNCOP_1,PEPIN,NAT_D,PARTFUN1,VALUED_1,XXREAL_1,XXREAL_2,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB11,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB20,CKB21,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47;
schemes FINSEQ_2,SEQ_1,NAT_1,RECDEF_1,FINSEQ_1,MATRIX_1;
registrations MATRPROB,RELSET_1,NAT_1,MEMBERED,ORDINAL1,XREAL_0,FCONT_3,RCOMP_1,XXREAL_0,NUMBERS,XBOOLE_0,VALUED_0,FINSEQ_1,CARD_1,XXREAL_2,FINSEQ_2,CKB12,CKB19,CKB22,CKB23,CKB32;
constructors REAL_1,NAT_D,BINOP_2,MATRIX_3,MATRIXR1,MATRLIN,MATRPROB,PARTFUN3,PARTFUN2,FDIFF_1,FCONT_1,POWER,LIMFUNC1,SIN_COS,TAYLOR_1,INTEGRA1,SEQ_1,XXREAL_2,RVSUM_1,RELSET_1,NEWTON,CKB14,CKB31,CKB34;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve j for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve p for (FinSequence of ( REAL ));
theorem
Th38: (for M being (Matrix of ( REAL )) holds (for p being (FinSequence of ( ( REAL ) * )) holds (((( len p ) = ( len M ) & ( p . 1 ) = ( M . 1 )) & (for k holds ((k >= 1 & k < ( len M )) implies ( p . ( k + 1 ) ) = ( ( p . k ) ^ ( M . ( k + 1 ) ) )))) implies ( SumAll M ) = ( Sum ( p . ( len M ) ) ))))
proof
let M being (Matrix of ( REAL ));
let p being (FinSequence of ( ( REAL ) * ));
assume that
A1: ( len p ) = ( len M )
and
A2: ( p . 1 ) = ( M . 1 )
and
A3: (for k holds ((k >= 1 & k < ( len M )) implies ( p . ( k + 1 ) ) = ( ( p . k ) ^ ( M . ( k + 1 ) ) )));
per cases ;
suppose A4: ( len M ) = ( 0 );

then p = ( {} ) by A1;
hence ( Sum ( p . ( len M ) ) ) = ( 0 ) by FUNCT_1:def 2,RELAT_1:38,RVSUM_1:72
.= ( SumAll M ) by A4,MATRPROB:23;
end;
suppose A5: ( len M ) > ( 0 );

then A6: ( len M ) >= 1 by NAT_1:14;
set q = ( LineSum M );
A7: ( len q ) = ( len M ) by MATRPROB:def 1;
then consider qq being (FinSequence of ( REAL )) such that A8: ( len qq ) = ( len q ) and A9: ( qq . 1 ) = ( q . 1 ) and A10: (for k holds ((( 0 ) <> k & k < ( len q )) implies ( qq . ( k + 1 ) ) = ( ( qq . k ) + ( q . ( k + 1 ) ) ))) and A11: ( Sum q ) = ( qq . ( len q ) ) by A5,CKB9:1,NAT_1:14;
A12: ( len qq ) = ( len M ) by A8,MATRPROB:def 1
.= ( len ( Sum p ) ) by A1,MATRPROB:def 1;
A13: ( dom qq ) = ( Seg ( len qq ) ) by FINSEQ_1:def 3;
A14: ( len ( Sum p ) ) = ( len p ) by MATRPROB:def 1;
then A15: ( dom ( Sum p ) ) = ( dom p ) by FINSEQ_3:29;
(for j being Nat holds (j in ( dom qq ) implies ( qq . j ) = ( ( Sum p ) . j )))
proof
defpred P[ Nat ]
 means
($1 in ( dom qq ) implies ( qq . $1 ) = ( ( Sum p ) . $1 ));
A16: (for k holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k;
assume that
A17: P[ k ];
assume A18: ( k + 1 ) in ( dom qq );
then A19: ( k + 1 ) <= ( len qq ) by A13,FINSEQ_1:1;
A20: ( k + 1 ) in ( dom ( Sum p ) ) by A1,A7,A14,A8,A13,A18,FINSEQ_1:def 3;
A21: ( k + 1 ) in ( dom M ) by A7,A8,A13,A18,FINSEQ_1:def 3;
( k + 1 ) >= 1 by A13,A18,FINSEQ_1:1;
then A22: (( k + 1 ) = 1 or ( k + 1 ) > 1) by XXREAL_0:1;
per cases  by A22,NAT_1:13;
suppose A23: ( k + 1 ) = 1;

A24: 1 in ( Seg ( len M ) ) by A6,FINSEQ_1:1;
then A25: 1 in ( dom M ) by FINSEQ_1:def 3;
A26: 1 in ( dom p ) by A1,A24,FINSEQ_1:def 3;
( qq . ( k + 1 ) ) = ( Sum ( Line (M,1) ) ) by A9,A23,A24,MATRPROB:20
.= ( Sum ( M . 1 ) ) by A25,MATRIX_2:16
.= ( ( Sum p ) . 1 ) by A2,A15,A26,MATRPROB:def 1;
hence thesis by A23;
end;
suppose A27: k >= 1;

A28: k < ( len qq ) by A19,NAT_1:13;
then A29: k < ( len M ) by A8,MATRPROB:def 1;
k in ( Seg ( len qq ) ) by A27,A28,FINSEQ_1:1;
then A30: k in ( dom ( Sum p ) ) by A12,FINSEQ_1:def 3;
( qq . ( k + 1 ) ) = ( ( qq . k ) + ( q . ( k + 1 ) ) ) by A8,A10,A27,A28
.= ( ( Sum ( p . k ) ) + ( q . ( k + 1 ) ) ) by A13,A17,A27,A28,A30,FINSEQ_1:1,MATRPROB:def 1
.= ( ( Sum ( p . k ) ) + ( Sum ( Line (M,( k + 1 )) ) ) ) by A7,A8,A13,A18,MATRPROB:20
.= ( ( Sum ( p . k ) ) + ( Sum ( M . ( k + 1 ) ) ) ) by A21,MATRIX_2:16
.= ( Sum ( p . ( k + 1 ) ) ) by A3,A27,A29,CKB47:1
.= ( ( Sum p ) . ( k + 1 ) ) by A20,MATRPROB:def 1;
hence thesis;
end;
end;
A31: P[ ( 0 ) ] by A13,FINSEQ_1:1;
(for j holds P[ j ]) from NAT_1:sch 1(A31,A16);
hence thesis;
end;
then A32: qq = ( Sum p ) by A12,FINSEQ_2:9;
( len M ) in ( Seg ( len M ) ) by A5,FINSEQ_1:3;
then A33: ( len M ) in ( dom ( Sum p ) ) by A1,A14,FINSEQ_1:def 3;
thus ( SumAll M ) = ( Sum q ) by MATRPROB:def 3
.= ( ( Sum p ) . ( len M ) ) by A11,A32,MATRPROB:def 1
.= ( Sum ( p . ( len M ) ) ) by A33,MATRPROB:def 1;
end;
end;
