environ
vocabularies NUMBERS,ORDERS_2,XBOOLE_0,STRUCT_0,EQREL_1,SUBSET_1,FINSEQ_1,LATTICE5,LATTICES,WAYBEL_0,ZFMISC_1,GROUP_6,FUNCT_1,RELAT_1,XXREAL_0,FINSET_1,ABIAN,CARD_1,ARYTM_3,CAT_1,YELLOW_0,ORDINAL2,ORDINAL1,TARSKI,WELLORD1,SEQM_3,LATTICE3,WAYBEL_1,MCART_1,VALUED_0,RELAT_2,PARTFUN1,FUNCOP_1,FUNCT_6,NAT_1,FUNCT_2,LATTICE8;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,RELSET_1,FUNCT_2,FUNCT_6,NUMBERS,NAT_1,ORDINAL1,ORDINAL2,MCART_1,DOMAIN_1,PARTFUN1,FUNCOP_1,STRUCT_0,ORDERS_2,EQREL_1,FINSEQ_1,LATTICE3,BINOP_1,YELLOW_0,YELLOW_2,LATTICE5,YELLOW11,WAYBEL_1,WAYBEL_0,ABIAN,XXREAL_0,CKB1,CKB2,CKB16,CKB18,CKB23,CKB29,CKB30,CKB36,CKB43,CKB45,CKB46,CKB47,CKB49;
definitions TARSKI,LATTICE3,FUNCOP_1,WAYBEL_0,YELLOW_0,YELLOW11,LATTICE5,XBOOLE_0,BINOP_1,YELLOW_2,RELSET_1,CKB1,CKB2,CKB16,CKB18,CKB23,CKB29,CKB30,CKB43,CKB45,CKB47,CKB49;
theorems EQREL_1,RELAT_1,RELAT_2,FINSEQ_1,FINSEQ_2,ORDERS_2,TARSKI,ORDINAL1,ORDINAL3,TREES_2,PARTFUN1,GRFUNC_1,FUNCT_6,MCART_1,NAT_1,BINOP_1,ZFMISC_1,FUNCT_1,FUNCT_2,LATTICE3,YELLOW_0,YELLOW_3,YELLOW_5,WAYBEL_0,WAYBEL_1,WAYBEL_6,RELSET_1,LATTICE5,YELLOW11,WAYBEL13,ORDERS_3,TEX_1,SYSREL,XBOOLE_0,XBOOLE_1,REALSET1,ORDERS_1,STRUCT_0,CKB1,CKB2,CKB4,CKB5,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB45,CKB47,CKB48,CKB49,CKB50,CKB51;
schemes RECDEF_1,ORDINAL2,NAT_1,FINSEQ_1,BINOP_1,CLASSES1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,PARTFUN1,FUNCOP_1,XREAL_0,INT_1,CARD_1,FINSEQ_1,EQREL_1,REALSET1,ABIAN,STRUCT_0,LATTICE3,YELLOW_0,YELLOW_2,WAYBEL_1,WAYBEL10,LATTICE5,YELLOW11,WAYBEL21,LATTICE7,ZFMISC_1,FUNCT_1,CKB3,CKB6,CKB17,CKB27,CKB44;
constructors ORDINAL2,FUNCT_6,RFUNCT_3,ABIAN,REALSET2,ORDERS_3,WAYBEL_1,LATTICE5,YELLOW11,RELSET_1,CKB1,CKB2,CKB16,CKB18,CKB23,CKB29,CKB30,CKB36,CKB43,CKB45,CKB46,CKB47,CKB49;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
theorem
Th33: (for L being  lower-bounded  modular LATTICE holds (for S being (ExtensionSeq2 of (the carrier of L),( BasicDF L )) holds (for FS being non empty set holds (FS = ( union { ( ( S . i ) `1 ) where i is (Element of ( NAT )): (not contradiction) } ) implies ( union { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) } ) is (distance_function of FS,L)))))
proof
let L being  lower-bounded  modular LATTICE;
let S being (ExtensionSeq2 of (the carrier of L),( BasicDF L ));
let FS being non empty set;
assume A1: FS = ( union { ( ( S . i ) `1 ) where i is (Element of ( NAT )): (not contradiction) } );
reconsider FS as non empty set;
set A = (the carrier of L);
set FD = ( union { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) } );
now
let x being set,y being set;
assume that
A2: x in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) }
and
A3: y in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
consider k being (Element of ( NAT )) such that A4: x = ( ( S . k ) `2 ) by A2;
consider l being (Element of ( NAT )) such that A5: y = ( ( S . l ) `2 ) by A3;
(k <= l or l <= k);
then (x c= y or y c= x) by A4,A5,CKB51:1;
hence x,y are_c=-comparable  by XBOOLE_0:def 9;
end;
then A6: { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) } is  c=-linear by ORDINAL1:def 8;
{ ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) } c= ( PFuncs ([: FS,FS :],A) )
proof
let z being set;
assume z in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
then consider j being (Element of ( NAT )) such that A7: z = ( ( S . j ) `2 );
consider A9 being non empty set,d9 being (distance_function of A9,L),Aq being non empty set,dq being (distance_function of Aq,L) such that Aq,dq is_extension2_of A9,d9 and A8: ( S . j ) = [ A9,d9 ] and ( S . ( j + 1 ) ) = [ Aq,dq ] by CKB49:def 1;
A9 = ( ( S . j ) `1 ) by A8,MCART_1:def 1;
then A9 in { ( ( S . i ) `1 ) where i is (Element of ( NAT )): (not contradiction) };
then (( dom d9 ) = [: A9,A9 :] & A9 c= FS) by A1,FUNCT_2:def 1,ZFMISC_1:74;
then A9: (( rng d9 ) c= A & ( dom d9 ) c= [: FS,FS :]) by ZFMISC_1:96;
z = d9 by A7,A8,MCART_1:def 2;
hence thesis by A9,PARTFUN1:def 3;
end;
then FD in ( PFuncs ([: FS,FS :],A) ) by A6,TREES_2:40;
then A10: (ex g being Function st ((FD = g & ( dom g ) c= [: FS,FS :]) & ( rng g ) c= A)) by PARTFUN1:def 3;
( ( S . ( 0 ) ) `1 ) in { ( ( S . i ) `1 ) where i is (Element of ( NAT )): (not contradiction) };
then reconsider X = { ( ( S . i ) `1 ) where i is (Element of ( NAT )): (not contradiction) } as non empty set;
set LL = { [: I,I :] where I is (Element of X): I in X };
set PP = { [: ( ( S . i ) `1 ),( ( S . i ) `1 ) :] where i is (Element of ( NAT )): (not contradiction) };
defpred X[ set,set ]
 means
$2 = ( ( S . $1 ) `2 );
A11: LL = PP
proof
thus LL c= PP
proof
let x being set;
assume x in LL;
then consider J being (Element of X) such that A12: x = [: J,J :] and A13: J in X;
(ex j being (Element of ( NAT )) st J = ( ( S . j ) `1 )) by A13;
hence thesis by A12;
end;

let x being set;
assume x in PP;
then consider j being (Element of ( NAT )) such that A14: x = [: ( ( S . j ) `1 ),( ( S . j ) `1 ) :];
( ( S . j ) `1 ) in X;
hence thesis by A14;
end;
reconsider FD as Function by A10;
A15: (for x being set holds (x in ( NAT ) implies (ex y being set st X[ x,y ])));
consider F being Function such that A16: ( dom F ) = ( NAT ) and A17: (for x being set holds (x in ( NAT ) implies X[ x,( F . x ) ])) from CLASSES1:sch 1(A15);
A18: ( rng F ) = { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) }
proof
thus ( rng F ) c= { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) }
proof
let x being set;
assume x in ( rng F );
then consider j being set such that A19: j in ( dom F ) and A20: ( F . j ) = x by FUNCT_1:def 3;
reconsider j as (Element of ( NAT )) by A16,A19;
x = ( ( S . j ) `2 ) by A17,A20;
hence thesis;
end;

let x being set;
assume x in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
then consider j being (Element of ( NAT )) such that A21: x = ( ( S . j ) `2 );
x = ( F . j ) by A17,A21;
hence thesis by A16,FUNCT_1:def 3;
end;
F is  Function-yielding
proof
let x being set;
assume x in ( dom F );
then reconsider j = x as (Element of ( NAT )) by A16;
consider A1 being non empty set,d1 being (distance_function of A1,L),Aq1 being non empty set,dq1 being (distance_function of Aq1,L) such that Aq1,dq1 is_extension2_of A1,d1 and A22: ( S . j ) = [ A1,d1 ] and ( S . ( j + 1 ) ) = [ Aq1,dq1 ] by CKB49:def 1;
( ( S . j ) `2 ) = d1 by A22,MCART_1:def 2;
hence thesis by A17;
end;
then reconsider F as  Function-yielding Function;
A23: ( rng ( doms F ) ) = PP
proof
thus ( rng ( doms F ) ) c= PP
proof
let x being set;
assume x in ( rng ( doms F ) );
then consider j being set such that A24: j in ( dom ( doms F ) ) and A25: x = ( ( doms F ) . j ) by FUNCT_1:def 3;
A26: j in ( dom F ) by A24,FUNCT_6:59;
reconsider j as (Element of ( NAT )) by A16,A24,FUNCT_6:59;
consider A1 being non empty set,d1 being (distance_function of A1,L),Aq1 being non empty set,dq1 being (distance_function of Aq1,L) such that Aq1,dq1 is_extension2_of A1,d1 and A27: ( S . j ) = [ A1,d1 ] and ( S . ( j + 1 ) ) = [ Aq1,dq1 ] by CKB49:def 1;
A28: ( ( S . j ) `2 ) = d1 by A27,MCART_1:def 2;
A29: ( ( S . j ) `1 ) = A1 by A27,MCART_1:def 1;
x = ( dom ( F . j ) ) by A25,A26,FUNCT_6:22
.= ( dom d1 ) by A17,A28
.= [: ( ( S . j ) `1 ),( ( S . j ) `1 ) :] by A29,FUNCT_2:def 1;
hence thesis;
end;

let x being set;
assume x in PP;
then consider j being (Element of ( NAT )) such that A30: x = [: ( ( S . j ) `1 ),( ( S . j ) `1 ) :];
consider A1 being non empty set,d1 being (distance_function of A1,L),Aq1 being non empty set,dq1 being (distance_function of Aq1,L) such that Aq1,dq1 is_extension2_of A1,d1 and A31: ( S . j ) = [ A1,d1 ] and ( S . ( j + 1 ) ) = [ Aq1,dq1 ] by CKB49:def 1;
A32: ( ( S . j ) `2 ) = d1 by A31,MCART_1:def 2;
j in ( NAT );
then A33: j in ( dom ( doms F ) ) by A16,FUNCT_6:59;
( ( S . j ) `1 ) = A1 by A31,MCART_1:def 1;
then x = ( dom d1 ) by A30,FUNCT_2:def 1
.= ( dom ( F . j ) ) by A17,A32
.= ( ( doms F ) . j ) by A16,FUNCT_6:22;
hence thesis by A33,FUNCT_1:def 3;
end;
now
let x being set,y being set;
assume that
A34: x in X
and
A35: y in X;
consider k being (Element of ( NAT )) such that A36: x = ( ( S . k ) `1 ) by A34;
consider l being (Element of ( NAT )) such that A37: y = ( ( S . l ) `1 ) by A35;
(k <= l or l <= k);
then (x c= y or y c= x) by A36,A37,CKB50:1;
hence x,y are_c=-comparable  by XBOOLE_0:def 9;
end;
then X is  c=-linear by ORDINAL1:def 8;
then [: FS,FS :] = ( union ( rng ( doms F ) ) ) by A1,A23,A11,LATTICE5:3
.= ( dom FD ) by A18,LATTICE5:1;
then reconsider FD as (BiFunction of FS,L) by A10,FUNCT_2:def 1,RELSET_1:4;
A38: FD is  symmetric
proof
let x being (Element of FS),y being (Element of FS);
consider x1 being set such that A39: x in x1 and A40: x1 in X by A1,TARSKI:def 4;
consider k being (Element of ( NAT )) such that A41: x1 = ( ( S . k ) `1 ) by A40;
consider A1 being non empty set,d1 being (distance_function of A1,L),Aq1 being non empty set,dq1 being (distance_function of Aq1,L) such that Aq1,dq1 is_extension2_of A1,d1 and A42: ( S . k ) = [ A1,d1 ] and ( S . ( k + 1 ) ) = [ Aq1,dq1 ] by CKB49:def 1;
A43: x in A1 by A39,A41,A42,MCART_1:def 1;
A44: ( ( S . k ) `1 ) = A1 by A42,MCART_1:def 1;
( ( S . k ) `2 ) = d1 by A42,MCART_1:def 2;
then d1 in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
then A45: d1 c= FD by ZFMISC_1:74;
consider y1 being set such that A46: y in y1 and A47: y1 in X by A1,TARSKI:def 4;
consider l being (Element of ( NAT )) such that A48: y1 = ( ( S . l ) `1 ) by A47;
consider A2 being non empty set,d2 being (distance_function of A2,L),Aq2 being non empty set,dq2 being (distance_function of Aq2,L) such that Aq2,dq2 is_extension2_of A2,d2 and A49: ( S . l ) = [ A2,d2 ] and ( S . ( l + 1 ) ) = [ Aq2,dq2 ] by CKB49:def 1;
A50: y in A2 by A46,A48,A49,MCART_1:def 1;
A51: ( ( S . l ) `1 ) = A2 by A49,MCART_1:def 1;
( ( S . l ) `2 ) = d2 by A49,MCART_1:def 2;
then d2 in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
then A52: d2 c= FD by ZFMISC_1:74;
per cases ;
suppose k <= l;

then A1 c= A2 by A44,A51,CKB50:1;
then reconsider x9 = x,y9 = y as (Element of A2) by A43,A46,A48,A49,MCART_1:def 1;
A53: ( dom d2 ) = [: A2,A2 :] by FUNCT_2:def 1;
hence ( FD . (x,y) ) = ( d2 . [ x9,y9 ] ) by A52,GRFUNC_1:2
.= ( d2 . (x9,y9) )
.= ( d2 . (y9,x9) ) by LATTICE5:def 5
.= ( FD . [ y9,x9 ] ) by A52,A53,GRFUNC_1:2
.= ( FD . (y,x) );
end;
suppose l <= k;

then A2 c= A1 by A44,A51,CKB50:1;
then reconsider x9 = x,y9 = y as (Element of A1) by A39,A41,A42,A50,MCART_1:def 1;
A54: ( dom d1 ) = [: A1,A1 :] by FUNCT_2:def 1;
hence ( FD . (x,y) ) = ( d1 . [ x9,y9 ] ) by A45,GRFUNC_1:2
.= ( d1 . (x9,y9) )
.= ( d1 . (y9,x9) ) by LATTICE5:def 5
.= ( FD . [ y9,x9 ] ) by A45,A54,GRFUNC_1:2
.= ( FD . (y,x) );
end;
end;
A55: FD is  u.t.i.
proof
let x being (Element of FS),y being (Element of FS),z being (Element of FS);
consider x1 being set such that A56: x in x1 and A57: x1 in X by A1,TARSKI:def 4;
consider k being (Element of ( NAT )) such that A58: x1 = ( ( S . k ) `1 ) by A57;
consider A1 being non empty set,d1 being (distance_function of A1,L),Aq1 being non empty set,dq1 being (distance_function of Aq1,L) such that Aq1,dq1 is_extension2_of A1,d1 and A59: ( S . k ) = [ A1,d1 ] and ( S . ( k + 1 ) ) = [ Aq1,dq1 ] by CKB49:def 1;
A60: x in A1 by A56,A58,A59,MCART_1:def 1;
( ( S . k ) `2 ) = d1 by A59,MCART_1:def 2;
then d1 in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
then A61: d1 c= FD by ZFMISC_1:74;
A62: ( dom d1 ) = [: A1,A1 :] by FUNCT_2:def 1;
A63: ( ( S . k ) `1 ) = A1 by A59,MCART_1:def 1;
consider y1 being set such that A64: y in y1 and A65: y1 in X by A1,TARSKI:def 4;
consider l being (Element of ( NAT )) such that A66: y1 = ( ( S . l ) `1 ) by A65;
consider A2 being non empty set,d2 being (distance_function of A2,L),Aq2 being non empty set,dq2 being (distance_function of Aq2,L) such that Aq2,dq2 is_extension2_of A2,d2 and A67: ( S . l ) = [ A2,d2 ] and ( S . ( l + 1 ) ) = [ Aq2,dq2 ] by CKB49:def 1;
A68: y in A2 by A64,A66,A67,MCART_1:def 1;
( ( S . l ) `2 ) = d2 by A67,MCART_1:def 2;
then d2 in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
then A69: d2 c= FD by ZFMISC_1:74;
A70: ( dom d2 ) = [: A2,A2 :] by FUNCT_2:def 1;
A71: ( ( S . l ) `1 ) = A2 by A67,MCART_1:def 1;
consider z1 being set such that A72: z in z1 and A73: z1 in X by A1,TARSKI:def 4;
consider n being (Element of ( NAT )) such that A74: z1 = ( ( S . n ) `1 ) by A73;
consider A3 being non empty set,d3 being (distance_function of A3,L),Aq3 being non empty set,dq3 being (distance_function of Aq3,L) such that Aq3,dq3 is_extension2_of A3,d3 and A75: ( S . n ) = [ A3,d3 ] and ( S . ( n + 1 ) ) = [ Aq3,dq3 ] by CKB49:def 1;
A76: z in A3 by A72,A74,A75,MCART_1:def 1;
A77: ( ( S . n ) `1 ) = A3 by A75,MCART_1:def 1;
( ( S . n ) `2 ) = d3 by A75,MCART_1:def 2;
then d3 in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
then A78: d3 c= FD by ZFMISC_1:74;
A79: ( dom d3 ) = [: A3,A3 :] by FUNCT_2:def 1;
per cases ;
suppose k <= l;

then A80: A1 c= A2 by A63,A71,CKB50:1;
thus ( ( FD . (x,y) ) "\/" ( FD . (y,z) ) ) >= ( FD . (x,z) )
proof
per cases ;
suppose l <= n;

then A81: A2 c= A3 by A71,A77,CKB50:1;
then A1 c= A3 by A80,XBOOLE_1:1;
then reconsider x9 = x,y9 = y,z9 = z as (Element of A3) by A60,A68,A72,A74,A75,A81,MCART_1:def 1;
A82: ( FD . (y,z) ) = ( d3 . [ y9,z9 ] ) by A78,A79,GRFUNC_1:2
.= ( d3 . (y9,z9) );
A83: ( FD . (x,z) ) = ( d3 . [ x9,z9 ] ) by A78,A79,GRFUNC_1:2
.= ( d3 . (x9,z9) );
( FD . (x,y) ) = ( d3 . [ x9,y9 ] ) by A78,A79,GRFUNC_1:2
.= ( d3 . (x9,y9) );
hence thesis by A82,A83,LATTICE5:def 7;
end;
suppose n <= l;

then A3 c= A2 by A71,A77,CKB50:1;
then reconsider x9 = x,y9 = y,z9 = z as (Element of A2) by A60,A64,A66,A67,A76,A80,MCART_1:def 1;
A84: ( FD . (y,z) ) = ( d2 . [ y9,z9 ] ) by A69,A70,GRFUNC_1:2
.= ( d2 . (y9,z9) );
A85: ( FD . (x,z) ) = ( d2 . [ x9,z9 ] ) by A69,A70,GRFUNC_1:2
.= ( d2 . (x9,z9) );
( FD . (x,y) ) = ( d2 . [ x9,y9 ] ) by A69,A70,GRFUNC_1:2
.= ( d2 . (x9,y9) );
hence thesis by A84,A85,LATTICE5:def 7;
end;
end;

end;
suppose l <= k;

then A86: A2 c= A1 by A63,A71,CKB50:1;
thus ( ( FD . (x,y) ) "\/" ( FD . (y,z) ) ) >= ( FD . (x,z) )
proof
per cases ;
suppose k <= n;

then A87: A1 c= A3 by A63,A77,CKB50:1;
then A2 c= A3 by A86,XBOOLE_1:1;
then reconsider x9 = x,y9 = y,z9 = z as (Element of A3) by A60,A68,A72,A74,A75,A87,MCART_1:def 1;
A88: ( FD . (y,z) ) = ( d3 . [ y9,z9 ] ) by A78,A79,GRFUNC_1:2
.= ( d3 . (y9,z9) );
A89: ( FD . (x,z) ) = ( d3 . [ x9,z9 ] ) by A78,A79,GRFUNC_1:2
.= ( d3 . (x9,z9) );
( FD . (x,y) ) = ( d3 . [ x9,y9 ] ) by A78,A79,GRFUNC_1:2
.= ( d3 . (x9,y9) );
hence thesis by A88,A89,LATTICE5:def 7;
end;
suppose n <= k;

then A3 c= A1 by A63,A77,CKB50:1;
then reconsider x9 = x,y9 = y,z9 = z as (Element of A1) by A56,A58,A59,A68,A76,A86,MCART_1:def 1;
A90: ( FD . (y,z) ) = ( d1 . [ y9,z9 ] ) by A61,A62,GRFUNC_1:2
.= ( d1 . (y9,z9) );
A91: ( FD . (x,z) ) = ( d1 . [ x9,z9 ] ) by A61,A62,GRFUNC_1:2
.= ( d1 . (x9,z9) );
( FD . (x,y) ) = ( d1 . [ x9,y9 ] ) by A61,A62,GRFUNC_1:2
.= ( d1 . (x9,y9) );
hence thesis by A90,A91,LATTICE5:def 7;
end;
end;

end;
end;
FD is  zeroed
proof
let x being (Element of FS);
consider y being set such that A92: x in y and A93: y in X by A1,TARSKI:def 4;
consider j being (Element of ( NAT )) such that A94: y = ( ( S . j ) `1 ) by A93;
consider A1 being non empty set,d1 being (distance_function of A1,L),Aq1 being non empty set,dq1 being (distance_function of Aq1,L) such that Aq1,dq1 is_extension2_of A1,d1 and A95: ( S . j ) = [ A1,d1 ] and ( S . ( j + 1 ) ) = [ Aq1,dq1 ] by CKB49:def 1;
( ( S . j ) `2 ) = d1 by A95,MCART_1:def 2;
then d1 in { ( ( S . i ) `2 ) where i is (Element of ( NAT )): (not contradiction) };
then A96: d1 c= FD by ZFMISC_1:74;
reconsider x9 = x as (Element of A1) by A92,A94,A95,MCART_1:def 1;
( dom d1 ) = [: A1,A1 :] by FUNCT_2:def 1;
hence ( FD . (x,x) ) = ( d1 . [ x9,x9 ] ) by A96,GRFUNC_1:2
.= ( d1 . (x9,x9) )
.= ( Bottom L ) by LATTICE5:def 6;
end;
hence thesis by A38,A55;
end;
