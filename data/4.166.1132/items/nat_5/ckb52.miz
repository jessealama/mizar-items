environ
vocabularies NUMBERS,ORDINAL1,XCMPLX_0,INT_2,NAT_3,XXREAL_0,XBOOLE_0,NEWTON,ARYTM_3,ARYTM_1,NAT_1,RELAT_1,CARD_1,ABIAN,SUBSET_1,FINSET_1,FINSEQ_1,FUNCT_1,FINSEQ_3,TARSKI,CARD_3,ORDINAL4,FUNCT_2,FINSEQ_2,FUNCOP_1,MOEBIUS1,COMPLEX1,INT_1,REALSET1,SQUARE_1,INT_5,ZFMISC_1,POWER,REAL_1,PRE_POLY,UPROOTS,BHSP_5,CLASSES1,XXREAL_2,MEMBERED,PARTFUN1,RFUNCT_3,BINOP_2,PROB_1,WAYBEL29,MSSUBFAM,TOPGEN_1,EULER_1,NAT_5;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,FUNCOP_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,MCART_1,FUNCT_2,ORDINAL1,CARD_1,NUMBERS,FINSEQ_1,FINSEQ_3,INT_1,INT_2,NAT_1,NAT_D,RVSUM_1,REAL_1,SQUARE_1,XXREAL_0,NEWTON,ABIAN,PEPIN,INT_5,MEMBERED,FINSEQOP,ENUMSET1,FINSET_1,COMPLEX1,NAT_3,DOMAIN_1,POWER,MOEBIUS1,BHSP_5,EULER_1,WSIERP_1,BINOP_1,RECDEF_1,EXTREAL1,UPROOTS,BINOP_2,FUNCT_3,RFUNCT_3,XXREAL_2,CLASSES1,PRE_POLY,CKB34,CKB42,CKB43,CKB44,CKB45,CKB51;
definitions TARSKI,NEWTON,FINSEQ_1,FINSEQ_3,EULER_1,MOEBIUS1,CKB42,CKB43,CKB44,CKB45,CKB51;
theorems XBOOLE_0,XBOOLE_1,XXREAL_0,XREAL_1,XCMPLX_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,INT_1,INT_2,INT_4,INT_5,NEWTON,EULER_1,EULER_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_5,RVSUM_1,WSIERP_1,ORDINAL1,IDEA_1,INT_6,INT_3,FIB_NUM3,POWER,PEPIN,SQUARE_1,CARD_1,CARD_2,ZFMISC_1,ALGSEQ_1,FINSEQ_4,JGRAPH_1,TARSKI,COMPLEX1,ABSVALUE,MOEBIUS1,CARD_3,MESFUNC3,FUNCT_2,EXTREAL1,FINSEQOP,FUNCOP_1,BAGORDER,RELSET_1,WELLORD2,PARTFUN1,BHSP_5,UPROOTS,RFINSEQ,BINOP_2,BINOP_1,FUNCT_3,RFUNCT_3,NAT_4,NAT_3,RADIX_1,XREAL_0,ABIAN,ENUMSET1,MONOID_1,CLASSES1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51;
schemes NAT_1,FUNCT_1,FUNCT_2,BINOP_2,FINSEQ_1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,RVSUM_1,VALUED_0,NEWTON,ABIAN,FUNCT_1,ZFMISC_1,SUBSET_1,MOEBIUS1,FUNCT_2,PRE_CIRC,DYNKIN,RELAT_1,SQUARE_1,CARD_1,PREPOWER,NAT_3,UPROOTS,XXREAL_2,PRE_POLY,CKB35;
constructors WELLORD2,REAL_1,NAT_D,BINOP_2,WSIERP_1,ABIAN,EULER_1,PEPIN,INT_5,RECDEF_1,MOEBIUS1,FINSEQOP,EXTREAL1,UPROOTS,NAT_3,REALSET1,POWER,BHSP_5,CALCUL_2,PROB_3,SUPINF_1,RFUNCT_3,XXREAL_2,CLASSES1,PBOOLE,BINOP_1,CKB34,CKB42,CKB43,CKB44,CKB45,CKB51;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve n0 for non zero  natural number;
theorem
Th34: (for f,F being (Function of ( NAT ),( NAT )) holds ((f is  multiplicative & (for n0 holds ( F . n0 ) = ( Sum ( f | ( NatDivisors n0 ) ) ))) implies F is  multiplicative))
proof
let f being (Function of ( NAT ),( NAT )),F being (Function of ( NAT ),( NAT ));
assume A1: f is  multiplicative;
assume A2: (for n0 holds ( F . n0 ) = ( Sum ( f | ( NatDivisors n0 ) ) ));
(for n,m being non zero  natural number holds (n,m are_relative_prime  implies ( F . ( n * m ) ) = ( ( F . n ) * ( F . m ) )))
proof
let n being non zero  natural number,m being non zero  natural number;
set b1 = ( f | ( NatDivisors ( n * m ) ) );
set b2 = ( ( ( multnat ) * [: f,f :] ) | [: ( NatDivisors n ),( NatDivisors m ) :] );
consider f1 being (FinSequence of ( REAL )) such that A3: ( Sum b1 ) = ( Sum f1 ) and A4: f1 = ( b1 * ( canFS ( support b1 ) ) ) by UPROOTS:def 3;
set h9 = ( ( multnat ) | [: ( NatDivisors n ),( NatDivisors m ) :] );
set g2 = ( canFS ( support b2 ) );
set g1 = ( canFS ( support b1 ) );
consider f2 being (FinSequence of ( REAL )) such that A5: ( Sum b2 ) = ( Sum f2 ) and A6: f2 = ( b2 * ( canFS ( support b2 ) ) ) by UPROOTS:def 3;
( dom ( multnat ) ) = [: ( NAT ),( NAT ) :] by FUNCT_2:def 1;
then A7: ( dom h9 ) = [: ( NatDivisors n ),( NatDivisors m ) :] by RELAT_1:62;
assume A8: n,m are_relative_prime ;
(for x1,x2 being set holds (((x1 in ( dom h9 ) & x2 in ( dom h9 )) & ( h9 . x1 ) = ( h9 . x2 )) implies x1 = x2))
proof
let x1 being set,x2 being set;
assume A9: x1 in ( dom h9 );
then consider n1 being set,m1 being set such that A10: (n1 in ( NatDivisors n ) & m1 in ( NatDivisors m )) and A11: x1 = [ n1,m1 ] by A7,ZFMISC_1:def 2;
reconsider n1,m1 as (Element of ( NAT )) by A10;
A12: ( h9 . x1 ) = ( ( multnat ) . x1 ) by A9,FUNCT_1:47
.= ( ( multnat ) . (n1,m1) ) by A11,BINOP_1:def 1
.= ( n1 * m1 ) by BINOP_2:def 24;
assume A13: x2 in ( dom h9 );
then consider n2 being set,m2 being set such that A14: n2 in ( NatDivisors n ) and A15: m2 in ( NatDivisors m ) and A16: x2 = [ n2,m2 ] by A7,ZFMISC_1:def 2;
reconsider n2,m2 as (Element of ( NAT )) by A14,A15;
assume A17: ( h9 . x1 ) = ( h9 . x2 );
A18: ( h9 . x2 ) = ( ( multnat ) . x2 ) by A13,FUNCT_1:47
.= ( ( multnat ) . (n2,m2) ) by A16,BINOP_1:def 1
.= ( n2 * m2 ) by BINOP_2:def 24;
then n1 = n2 by A8,A10,A14,A15,A17,A12,CKB18:1;
hence x1 = x2 by A8,A10,A11,A15,A16,A17,A12,A18,CKB18:1;
end;
then reconsider h9 as  one-to-one Function by FUNCT_1:def 4;
set h = ( ( ( g1 " ) * h9 ) * g2 );
A19: ( support b2 ) c= ( dom b2 ) by PRE_POLY:37;
( dom ( ( multnat ) * [: f,f :] ) ) = [: ( NAT ),( NAT ) :] by FUNCT_2:def 1;
then A20: ( dom b2 ) = [: ( NatDivisors n ),( NatDivisors m ) :] by RELAT_1:62;
A21: ( dom [: f,f :] ) = [: ( NAT ),( NAT ) :] by FUNCT_2:def 1;
(for x being set holds (x in ( support b2 ) implies x in ( dom ( ( g1 " ) * h9 ) )))
proof
let x being set;
A22: ( rng g1 ) = ( support b1 ) by FUNCT_2:def 3;
assume A23: x in ( support b2 );
then A24: ( b2 . x ) <> ( 0 ) by PRE_POLY:def 7;
A25: x in [: ( NatDivisors n ),( NatDivisors m ) :] by A20,A19,A23;
consider n1 being set,m1 being set such that A26: (n1 in ( NatDivisors n ) & m1 in ( NatDivisors m )) and A27: x = [ n1,m1 ] by A20,A19,A23,ZFMISC_1:def 2;
reconsider n1,m1 as (Element of ( NAT )) by A26;
A28: n1,m1 are_relative_prime  by A8,A26,CKB17:1;
reconsider n19 = n1,m19 = m1 as non zero  natural number by A26,MOEBIUS1:39;
set x9 = ( ( g1 " ) . ( n1 * m1 ) );
set fn1 = ( f . n1 );
set fm1 = ( f . m1 );
( b2 . x ) = ( ( ( multnat ) * [: f,f :] ) . x ) by A20,A19,A23,FUNCT_1:49
.= ( ( multnat ) . ( [: f,f :] . x ) ) by A21,A25,FUNCT_1:13
.= ( ( multnat ) . ( [: f,f :] . (n1,m1) ) ) by A27,BINOP_1:def 1
.= ( ( multnat ) . [ ( f . n1 ),( f . m1 ) ] ) by FUNCT_3:75
.= ( ( multnat ) . (( f . n1 ),( f . m1 )) ) by BINOP_1:def 1
.= ( fn1 * fm1 ) by BINOP_2:def 24
.= ( f . ( n19 * m19 ) ) by A1,A28,CKB51:def 1
.= ( ( f | ( NatDivisors ( n * m ) ) ) . ( n1 * m1 ) ) by A26,CKB19:1,FUNCT_1:49;
then A29: ( n1 * m1 ) in ( rng g1 ) by A24,A22,PRE_POLY:def 7;
then ( n1 * m1 ) in ( dom ( g1 " ) ) by FUNCT_1:33;
then x9 in ( rng ( g1 " ) ) by FUNCT_1:3;
then A30: x9 in ( dom g1 ) by FUNCT_1:33;
( g1 . x9 ) = ( n1 * m1 ) by A29,FUNCT_1:35
.= ( ( multnat ) . (n1,m1) ) by BINOP_2:def 24
.= ( ( multnat ) . [ n1,m1 ] ) by BINOP_1:def 1
.= ( h9 . x ) by A20,A19,A23,A27,FUNCT_1:49;
then ( h9 . x ) in ( rng g1 ) by A30,FUNCT_1:def 3;
then ( h9 . x ) in ( dom ( g1 " ) ) by FUNCT_1:33;
hence x in ( dom ( ( g1 " ) * h9 ) ) by A7,A20,A19,A23,FUNCT_1:11;
end;
then ( support b2 ) c= ( dom ( ( g1 " ) * h9 ) ) by TARSKI:def 3;
then ( rng g2 ) c= ( dom ( ( g1 " ) * h9 ) ) by FUNCT_2:def 3;
then A31: ( dom ( ( ( g1 " ) * h9 ) * g2 ) ) = ( dom g2 ) by RELAT_1:27;
( rng g2 ) c= ( dom b2 ) by A19,FUNCT_2:def 3;
then A32: ( dom h ) = ( dom f2 ) by A6,A31,RELAT_1:27;
A33: (for x being set holds (x in ( dom f2 ) implies ( f2 . x ) = ( f1 . ( h . x ) )))
proof
let x being set;
set x9 = ( g2 . x );
A34: ( ( b1 * g1 ) * ( ( g1 " ) * h9 ) ) = ( ( ( b1 * g1 ) * ( g1 " ) ) * h9 ) by RELAT_1:36
.= ( ( b1 * ( g1 * ( g1 " ) ) ) * h9 ) by RELAT_1:36
.= ( ( b1 * ( id ( rng g1 ) ) ) * h9 ) by FUNCT_1:39
.= ( ( b1 * ( id ( support b1 ) ) ) * h9 ) by FUNCT_2:def 3;
assume A35: x in ( dom f2 );
then A36: x in ( dom g2 ) by A6,FUNCT_1:11;
then A37: x9 in ( rng g2 ) by FUNCT_1:3;
then A38: (( support b2 ) c= ( dom b2 ) & x9 in ( support b2 )) by PRE_POLY:37;
then consider n1 being set,m1 being set such that A39: (n1 in ( NatDivisors n ) & m1 in ( NatDivisors m )) and A40: x9 = [ n1,m1 ] by A20,ZFMISC_1:def 2;
reconsider n1,m1 as (Element of ( NAT )) by A39;
A41: n1,m1 are_relative_prime  by A8,A39,CKB17:1;
reconsider n19 = n1,m19 = m1 as non zero  natural number by A39,MOEBIUS1:39;
set fn1 = ( f . n1 );
set fm1 = ( f . m1 );
A42: x9 in [: ( NatDivisors n ),( NatDivisors m ) :] by A20,A38;
A43: ( b2 . x9 ) = ( ( ( multnat ) * [: f,f :] ) . x9 ) by A20,A38,FUNCT_1:49
.= ( ( multnat ) . ( [: f,f :] . x9 ) ) by A21,A42,FUNCT_1:13
.= ( ( multnat ) . ( [: f,f :] . (n1,m1) ) ) by A40,BINOP_1:def 1
.= ( ( multnat ) . [ ( f . n1 ),( f . m1 ) ] ) by FUNCT_3:75
.= ( ( multnat ) . (( f . n1 ),( f . m1 )) ) by BINOP_1:def 1
.= ( fn1 * fm1 ) by BINOP_2:def 24
.= ( f . ( n19 * m19 ) ) by A1,A41,CKB51:def 1;
A44: ( b2 . x9 ) <> ( 0 ) by A37,PRE_POLY:def 7;
( f . ( n19 * m19 ) ) = ( ( f | ( NatDivisors ( n * m ) ) ) . ( n1 * m1 ) ) by A39,CKB19:1,FUNCT_1:49;
then A45: ( n1 * m1 ) in ( support b1 ) by A44,A43,PRE_POLY:def 7;
then A46: ( n1 * m1 ) in ( dom ( id ( support b1 ) ) ) by RELAT_1:45;
A47: ( h9 . x9 ) = ( ( multnat ) . x9 ) by A7,A20,A38,FUNCT_1:47
.= ( ( multnat ) . (n1,m1) ) by A40,BINOP_1:def 1
.= ( n1 * m1 ) by BINOP_2:def 24;
A48: ( ( b1 * g1 ) . ( h . x ) ) = ( ( ( b1 * g1 ) * h ) . x ) by A32,A35,FUNCT_1:13
.= ( ( ( ( b1 * g1 ) * ( ( g1 " ) * h9 ) ) * g2 ) . x ) by RELAT_1:36
.= ( ( ( b1 * g1 ) * ( ( g1 " ) * h9 ) ) . ( g2 . x ) ) by A36,FUNCT_1:13;
( ( ( b1 * ( id ( support b1 ) ) ) * h9 ) . x9 ) = ( ( b1 * ( id ( support b1 ) ) ) . ( h9 . x9 ) ) by A7,A20,A38,FUNCT_1:13
.= ( b1 . ( ( id ( support b1 ) ) . ( n1 * m1 ) ) ) by A46,A47,FUNCT_1:13
.= ( b1 . ( n1 * m1 ) ) by A45,FUNCT_1:18
.= ( b2 . x9 ) by A39,A43,CKB19:1,FUNCT_1:49;
hence ( f2 . x ) = ( f1 . ( h . x ) ) by A4,A6,A36,A48,A34,FUNCT_1:13;
end;
( dom f ) = ( NAT ) by FUNCT_2:def 1;
then A49: ( dom b1 ) = ( NatDivisors ( n * m ) ) by RELAT_1:62;
(for y being set holds (y in ( rng g1 ) implies y in ( rng ( h9 * g2 ) )))
proof
let y being set;
assume A50: y in ( rng g1 );
then A51: y in ( support b1 );
A52: ( support b1 ) c= ( dom b1 ) by PRE_POLY:37;
then consider n1 being  natural number,m1 being  natural number such that A53: (n1 in ( NatDivisors n ) & m1 in ( NatDivisors m )) and A54: y = ( n1 * m1 ) by A8,A49,A51,CKB21:1;
reconsider n19 = n1,m19 = m1 as non zero  natural number by A53,MOEBIUS1:39;
reconsider n1,m1 as (Element of ( NAT )) by ORDINAL1:def 12;
A55: n1,m1 are_relative_prime  by A8,A53,CKB17:1;
A56: ( b1 . y ) <> ( 0 ) by A50,PRE_POLY:def 7;
A57: [ n1,m1 ] in [: ( NatDivisors n ),( NatDivisors m ) :] by A53,ZFMISC_1:def 2;
set x = ( ( g2 " ) . [ n1,m1 ] );
A58: [ n1,m1 ] in [: ( NatDivisors n ),( NatDivisors m ) :] by A53,ZFMISC_1:def 2;
( b1 . y ) = ( f . y ) by A49,A51,A52,FUNCT_1:49
.= ( ( f . n19 ) * ( f . m19 ) ) by A1,A54,A55,CKB51:def 1
.= ( ( multnat ) . (( f . n1 ),( f . m1 )) ) by BINOP_2:def 24
.= ( ( multnat ) . [ ( f . n1 ),( f . m1 ) ] ) by BINOP_1:def 1
.= ( ( multnat ) . ( [: f,f :] . (n1,m1) ) ) by FUNCT_3:75
.= ( ( multnat ) . ( [: f,f :] . [ n1,m1 ] ) ) by BINOP_1:def 1
.= ( ( ( multnat ) * [: f,f :] ) . [ n1,m1 ] ) by A21,FUNCT_1:13
.= ( b2 . [ n1,m1 ] ) by A58,FUNCT_1:49;
then [ n1,m1 ] in ( support b2 ) by A56,PRE_POLY:def 7;
then A59: [ n1,m1 ] in ( rng g2 ) by FUNCT_2:def 3;
then [ n1,m1 ] in ( dom ( g2 " ) ) by FUNCT_1:33;
then x in ( rng ( g2 " ) ) by FUNCT_1:3;
then A60: x in ( dom g2 ) by FUNCT_1:33;
A61: y = ( ( multnat ) . (n1,m1) ) by A54,BINOP_2:def 24
.= ( ( multnat ) . [ n1,m1 ] ) by BINOP_1:def 1
.= ( ( ( multnat ) | [: ( NatDivisors n ),( NatDivisors m ) :] ) . [ n1,m1 ] ) by A57,FUNCT_1:49
.= ( h9 . ( g2 . ( ( g2 " ) . [ n1,m1 ] ) ) ) by A59,FUNCT_1:35
.= ( ( h9 * g2 ) . x ) by A60,FUNCT_1:13;
( g2 . ( ( g2 " ) . [ n1,m1 ] ) ) = [ n1,m1 ] by A59,FUNCT_1:35;
then x in ( dom ( h9 * g2 ) ) by A7,A57,A60,FUNCT_1:11;
hence y in ( rng ( h9 * g2 ) ) by A61,FUNCT_1:def 3;
end;
then ( rng g1 ) c= ( rng ( h9 * g2 ) ) by TARSKI:def 3;
then ( dom ( g1 " ) ) c= ( rng ( h9 * g2 ) ) by FUNCT_1:33;
then ( rng ( ( g1 " ) * ( h9 * g2 ) ) ) = ( rng ( g1 " ) ) by RELAT_1:28;
then A62: ( rng ( ( g1 " ) * ( h9 * g2 ) ) ) = ( dom g1 ) by FUNCT_1:33;
( support b1 ) c= ( dom b1 ) by PRE_POLY:37;
then ( rng g1 ) c= ( dom b1 ) by FUNCT_2:def 3;
then ( dom ( b1 * g1 ) ) = ( dom g1 ) by RELAT_1:27;
then A63: ( rng h ) = ( dom f1 ) by A4,A62,RELAT_1:36;
then (for x being set holds (x in ( dom f2 ) iff (x in ( dom h ) & ( h . x ) in ( dom f1 )))) by A32,FUNCT_1:3;
then f2 = ( f1 * h ) by A33,FUNCT_1:10;
then A64: f1,f2 are_fiberwise_equipotent  by A32,A63,CLASSES1:77;
thus ( F . ( n * m ) ) = ( Sum ( f | ( NatDivisors ( n * m ) ) ) ) by A2
.= ( Sum ( ( ( multnat ) * [: f,f :] ) | [: ( NatDivisors n ),( NatDivisors m ) :] ) ) by A3,A5,A64,RFINSEQ:9
.= ( ( Sum ( f | ( NatDivisors n ) ) ) * ( Sum ( f | ( NatDivisors m ) ) ) ) by CKB41:1
.= ( ( Sum ( f | ( NatDivisors n ) ) ) * ( F . m ) ) by A2
.= ( ( F . n ) * ( F . m ) ) by A2;
end;
hence F is  multiplicative by CKB51:def 1;
end;
