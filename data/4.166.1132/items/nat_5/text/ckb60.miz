environ
vocabularies NUMBERS,ORDINAL1,XCMPLX_0,INT_2,NAT_3,XXREAL_0,XBOOLE_0,NEWTON,ARYTM_3,ARYTM_1,NAT_1,RELAT_1,CARD_1,ABIAN,SUBSET_1,FINSET_1,FINSEQ_1,FUNCT_1,FINSEQ_3,TARSKI,CARD_3,ORDINAL4,FUNCT_2,FINSEQ_2,FUNCOP_1,MOEBIUS1,COMPLEX1,INT_1,REALSET1,SQUARE_1,INT_5,ZFMISC_1,POWER,REAL_1,PRE_POLY,UPROOTS,BHSP_5,CLASSES1,XXREAL_2,MEMBERED,PARTFUN1,RFUNCT_3,BINOP_2,PROB_1,WAYBEL29,MSSUBFAM,TOPGEN_1,EULER_1,NAT_5;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,FUNCOP_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,MCART_1,FUNCT_2,ORDINAL1,CARD_1,NUMBERS,FINSEQ_1,FINSEQ_3,INT_1,INT_2,NAT_1,NAT_D,RVSUM_1,REAL_1,SQUARE_1,XXREAL_0,NEWTON,ABIAN,PEPIN,INT_5,MEMBERED,FINSEQOP,ENUMSET1,FINSET_1,COMPLEX1,NAT_3,DOMAIN_1,POWER,MOEBIUS1,BHSP_5,EULER_1,WSIERP_1,BINOP_1,RECDEF_1,EXTREAL1,UPROOTS,BINOP_2,FUNCT_3,RFUNCT_3,XXREAL_2,CLASSES1,PRE_POLY,CKB34,CKB42,CKB43,CKB44,CKB45,CKB51,CKB56,CKB59;
definitions TARSKI,NEWTON,FINSEQ_1,FINSEQ_3,EULER_1,MOEBIUS1,CKB42,CKB43,CKB44,CKB45,CKB51,CKB56,CKB59;
theorems XBOOLE_0,XBOOLE_1,XXREAL_0,XREAL_1,XCMPLX_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,INT_1,INT_2,INT_4,INT_5,NEWTON,EULER_1,EULER_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_5,RVSUM_1,WSIERP_1,ORDINAL1,IDEA_1,INT_6,INT_3,FIB_NUM3,POWER,PEPIN,SQUARE_1,CARD_1,CARD_2,ZFMISC_1,ALGSEQ_1,FINSEQ_4,JGRAPH_1,TARSKI,COMPLEX1,ABSVALUE,MOEBIUS1,CARD_3,MESFUNC3,FUNCT_2,EXTREAL1,FINSEQOP,FUNCOP_1,BAGORDER,RELSET_1,WELLORD2,PARTFUN1,BHSP_5,UPROOTS,RFINSEQ,BINOP_2,BINOP_1,FUNCT_3,RFUNCT_3,NAT_4,NAT_3,RADIX_1,XREAL_0,ABIAN,ENUMSET1,MONOID_1,CLASSES1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59;
schemes NAT_1,FUNCT_1,FUNCT_2,BINOP_2,FINSEQ_1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,RVSUM_1,VALUED_0,NEWTON,ABIAN,FUNCT_1,ZFMISC_1,SUBSET_1,MOEBIUS1,FUNCT_2,PRE_CIRC,DYNKIN,RELAT_1,SQUARE_1,CARD_1,PREPOWER,NAT_3,UPROOTS,XXREAL_2,PRE_POLY,CKB35;
constructors WELLORD2,REAL_1,NAT_D,BINOP_2,WSIERP_1,ABIAN,EULER_1,PEPIN,INT_5,RECDEF_1,MOEBIUS1,FINSEQOP,EXTREAL1,UPROOTS,NAT_3,REALSET1,POWER,BHSP_5,CALCUL_2,PROB_3,SUPINF_1,RFUNCT_3,XXREAL_2,CLASSES1,PBOOLE,BINOP_1,CKB34,CKB42,CKB43,CKB44,CKB45,CKB51,CKB56,CKB59;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve k for  natural number;
reserve l for  natural number;
reserve n0 for non  zero  natural number;
reserve x for set;
reserve I for set;
reserve j for set;
reserve f for (Function of I,( NAT ));
theorem
( Sum ( ( Euler_phi ) | ( NatDivisors n0 ) ) ) = n0
proof
(( dom ( Euler_phi ) ) = ( NAT ) & ( rng ( Euler_phi ) ) c= ( REAL )) by FUNCT_2:def 1;
then reconsider EU9 = ( Euler_phi ) as (Function of ( NAT ),( REAL )) by FUNCT_2:2;
set X = ( Seg n0 );
defpred P[ set,set ]
 means
$2 = { i where i is (Element of ( NAT )): (ex h being  natural number st (((i in X & $1 in ( NatDivisors n0 )) & h = $1) & ( i gcd n0 ) = ( n0 / h ))) };
A1: ( dom ( Euler_phi ) ) = ( NAT ) by FUNCT_2:def 1;
A2: (for k being  natural number holds (k in X implies (ex x being (Element of ( bool X )) st P[ k,x ])))
proof
let k being  natural number;
set X9 = { i where i is (Element of ( NAT )): (ex h being  natural number st (((i in X & k in ( NatDivisors n0 )) & h = k) & ( i gcd n0 ) = ( n0 / h ))) };
(for x being set holds (x in X9 implies x in X))
proof
let x being set;
assume x in X9;
then (ex i being (Element of ( NAT )) st (i = x & (ex h being  natural number st (((i in X & k in ( NatDivisors n0 )) & h = k) & ( i gcd n0 ) = ( n0 / h )))));
hence x in X;
end;
then reconsider X9 as (Element of ( bool X )) by TARSKI:def 3;
assume k in X;
take X9;
thus P[ k,X9 ];
end;
consider fp being (FinSequence of ( bool X )) such that A3: (( dom fp ) = X & (for k being  natural number holds (k in X implies P[ k,( fp . k ) ]))) from FINSEQ_1:sch 5(A2);
A4: ( NatDivisors n0 ) c= ( Seg n0 ) by MOEBIUS1:40;
then A5: ( rng ( Sgm ( NatDivisors n0 ) ) ) c= ( dom fp ) by A3,FINSEQ_1:def 13;
then A6: ( rng ( Sgm ( NatDivisors n0 ) ) ) c= ( dom ( Card fp ) ) by CARD_3:def 2;
then reconsider f1 = ( ( Card fp ) * ( Sgm ( NatDivisors n0 ) ) ) as (FinSequence of ( NAT )) by CKB12:1;
A7: ( NatDivisors n0 ) c= ( dom fp ) by A3,MOEBIUS1:40;
A8: ( dom ( ( Card fp ) * ( Sgm ( NatDivisors n0 ) ) ) ) = ( dom ( Sgm ( NatDivisors n0 ) ) ) by A6,RELAT_1:27
.= ( dom ( ( Euler_phi ) * ( Sgm ( NatDivisors n0 ) ) ) ) by A5,A1,RELAT_1:27,XBOOLE_1:1;
(for k being (Element of ( NAT )) holds (k in ( dom ( ( Card fp ) * ( Sgm ( NatDivisors n0 ) ) ) ) implies ( ( ( Card fp ) * ( Sgm ( NatDivisors n0 ) ) ) . k ) = ( ( ( Euler_phi ) * ( Sgm ( NatDivisors n0 ) ) ) . k )))
proof
let k being (Element of ( NAT ));
set k9 = ( ( Sgm ( NatDivisors n0 ) ) . k );
set Y = { l where l is (Element of ( NAT )): ((k9,l are_relative_prime  & l >= 1) & l <= k9) };
set Z = { i where i is (Element of ( NAT )): (ex h being  natural number st (((i in X & k9 in ( NatDivisors n0 )) & h = k9) & ( i gcd n0 ) = ( n0 / h ))) };
deffunc F(Nat) = ( ( $1 * n0 ) / k9 );
A9: (for x being set holds (x in Y implies x in ( NAT )))
proof
let x being set;
assume x in Y;
then (ex l being (Element of ( NAT )) st (((x = l & k9,l are_relative_prime ) & l >= 1) & l <= k9));
hence x in ( NAT );
end;
assume A10: k in ( dom ( ( Card fp ) * ( Sgm ( NatDivisors n0 ) ) ) );
then k in ( dom ( Sgm ( NatDivisors n0 ) ) ) by FUNCT_1:11;
then k9 in ( rng ( Sgm ( NatDivisors n0 ) ) ) by FUNCT_1:3;
then A11: k9 in ( NatDivisors n0 ) by A4,FINSEQ_1:def 13;
then A12: 1 <= k9 by A3,A7,FINSEQ_1:1;
k9,1 are_relative_prime  by WSIERP_1:9;
then 1 in Y by A12;
then reconsider Y as non  empty (Subset of ( NAT )) by A9,TARSKI:def 3;
consider f being Function such that A13: (( dom f ) = Y & (for d being (Element of Y) holds ( f . d ) = F(d))) from FUNCT_1:sch 4;
(for y being set holds (y in ( rng f ) iff y in Z))
proof
let y being set;
hereby
assume y in ( rng f );
then consider x being set such that A14: x in ( dom f ) and A15: y = ( f . x ) by FUNCT_1:def 3;
reconsider x as (Element of Y) by A13,A14;
A16: ( 0 ) < k9 by A11,MOEBIUS1:39;
k9 divides n0 by A11,MOEBIUS1:39;
then consider j being  natural number such that A17: n0 = ( k9 * j ) by NAT_D:def 3;
y = F(x) by A13,A15
.= ( x * ( n0 / k9 ) ) by XCMPLX_1:74;
then A18: y = ( x * ( j / ( k9 / k9 ) ) ) by A17,XCMPLX_1:77
.= ( x * ( j / 1 ) ) by A16,XCMPLX_1:60
.= ( x * j );
then reconsider i = y as (Element of ( NAT ));
x in Y;
then consider l being (Element of ( NAT )) such that A19: x = l and A20: k9,l are_relative_prime  and A21: l >= 1 and A22: l <= k9;
A23: ( x * j ) <= ( k9 * j ) by A19,A22,XREAL_1:64;
j <> ( 0 ) by A17;
then ( j + 1 ) > ( ( 0 ) + 1 ) by XREAL_1:6;
then 1 <= j by NAT_1:13;
then ( 1 * 1 ) <= ( x * j ) by A19,A21,XREAL_1:66;
then A24: i in X by A17,A18,A23;
A25: ( k9 gcd l ) = 1 by A20,INT_2:def 3;
( n0 / k9 ) = ( j / ( k9 / k9 ) ) by A17,XCMPLX_1:77
.= ( j / 1 ) by A16,XCMPLX_1:60;
then ( i gcd n0 ) = ( n0 / k9 ) by A19,A17,A18,A25,EULER_1:5;
hence y in Z by A11,A24;
end;
assume y in Z;
then consider i being (Element of ( NAT )) such that A26: i = y and A27: (ex h being  natural number st (((i in X & k9 in ( NatDivisors n0 )) & h = k9) & ( i gcd n0 ) = ( n0 / h )));
( i gcd n0 ) divides i by INT_2:def 2;
then consider x being  natural number such that A28: i = ( ( i gcd n0 ) * x ) by NAT_D:def 3;
A29: y = ( ( x * n0 ) / k9 ) by A26,A27,A28,XCMPLX_1:74;
reconsider x as (Element of ( NAT )) by ORDINAL1:def 12;
A30: k9 <> ( 0 ) by A27,MOEBIUS1:39;
A31: ( k9 * ( i gcd n0 ) ) = ( n0 / ( k9 / k9 ) ) by A27,XCMPLX_1:81
.= ( n0 / 1 ) by A30,XCMPLX_1:60;
then A32: k9,x are_relative_prime  by A27,A28,A30,EULER_1:6;
x <> ( 0 ) by A27,A28,FINSEQ_1:1;
then ( x + 1 ) > ( ( 0 ) + 1 ) by XREAL_1:6;
then A33: x >= 1 by NAT_1:13;
i <= n0 by A27,FINSEQ_1:1;
then x <= k9 by A27,A28,A30,A31,XREAL_1:68;
then x in ( dom f ) by A13,A32,A33;
then reconsider x as (Element of Y) by A13;
y = ( f . x ) by A13,A29;
hence y in ( rng f ) by A13,FUNCT_1:def 3;
end;
then A34: ( rng f ) = Z by TARSKI:1;
(for x1,x2 being set holds (((x1 in ( dom f ) & x2 in ( dom f )) & ( f . x1 ) = ( f . x2 )) implies x1 = x2))
proof
let x1 being set;
let x2 being set;
assume x1 in ( dom f );
then reconsider x19 = x1 as (Element of Y) by A13;
assume x2 in ( dom f );
then reconsider x29 = x2 as (Element of Y) by A13;
assume A35: ( f . x1 ) = ( f . x2 );
A36: F(x19) = ( f . x19 ) by A13
.= F(x29) by A13,A35;
( x19 * ( n0 / k9 ) ) = ( ( x19 * n0 ) / k9 ) by XCMPLX_1:74
.= ( x29 * ( n0 / k9 ) ) by A36,XCMPLX_1:74;
hence x1 = x2 by A12,XCMPLX_1:5;
end;
then f is  one-to-one by FUNCT_1:def 4;
then A37: Y,Z are_equipotent  by A13,A34,WELLORD2:def 4;
( fp . k9 ) = Z by A3,A7,A11;
then ( card ( fp . k9 ) ) = ( card Y ) by A37,CARD_1:5;
then ( ( Card fp ) . k9 ) = ( Euler k9 ) by A7,A11,CARD_3:def 2;
then A38: ( ( Card fp ) . k9 ) = ( ( Euler_phi ) . k9 ) by CKB59:def 1;
( ( ( Card fp ) * ( Sgm ( NatDivisors n0 ) ) ) . k ) = ( ( Card fp ) . k9 ) by A10,FUNCT_1:12;
hence thesis by A8,A10,A38,FUNCT_1:12;
end;
then A39: ( ( Card fp ) * ( Sgm ( NatDivisors n0 ) ) ) = ( ( Euler_phi ) * ( Sgm ( NatDivisors n0 ) ) ) by A8,PARTFUN1:5;
set k = ( len fp );
A40: ( Func_Seq (( Euler_phi ),( Sgm ( NatDivisors n0 ) )) ) = ( ( Euler_phi ) * ( Sgm ( NatDivisors n0 ) ) ) by BHSP_5:def 4
.= ( Func_Seq (EU9,( Sgm ( NatDivisors n0 ) )) ) by BHSP_5:def 4;
A41: (for x being set holds (x in ( NatDivisors n0 ) iff (x in ( Seg n0 ) & (not x in ( ( Card fp ) " { ( 0 ) } )))))
proof
reconsider y = ( 0 ) as (Element of ( NAT ));
let x being set;
A42: y in { ( 0 ) } by TARSKI:def 1;
hereby
assume A43: x in ( NatDivisors n0 );
then reconsider k = x as (Element of ( NAT ));
thus x in ( Seg n0 ) by A4,A43;
assume x in ( ( Card fp ) " { ( 0 ) } );
then consider y being set such that A44: ([ x,y ] in ( Card fp ) & y in { ( 0 ) }) by RELAT_1:def 14;
(y = ( 0 ) & y = ( ( Card fp ) . x )) by A44,FUNCT_1:1,TARSKI:def 1;
then ( card ( fp . x ) ) = ( {} ) by A3,A4,A43,CARD_3:def 2;
then A45: ( fp . x ) = ( {} );
k divides n0 by A43,MOEBIUS1:39;
then consider i being  natural number such that A46: n0 = ( k * i ) by NAT_D:def 3;
i <> ( 0 ) by A46;
then ( ( 0 ) + 1 ) < ( i + 1 ) by XREAL_1:6;
then A47: 1 <= i by NAT_1:13;
A48: i divides n0 by A46,NAT_D:def 3;
then i <= n0 by NAT_D:7;
then A49: i in X by A47,FINSEQ_1:1;
A50: k <> ( 0 ) by A46;
n0 = ( k * ( i gcd n0 ) ) by A46,A48,NEWTON:49;
then ( n0 / k ) = ( ( i gcd n0 ) * ( k / k ) ) by XCMPLX_1:74
.= ( ( i gcd n0 ) * 1 ) by A50,XCMPLX_1:60;
then i in { i9 where i9 is (Element of ( NAT )): (ex h being  natural number st (((i9 in X & k in ( NatDivisors n0 )) & h = k) & ( i9 gcd n0 ) = ( n0 / h ))) } by A43,A49;
hence contradiction by A3,A4,A43,A45;
end;
assume A51: x in ( Seg n0 );
then reconsider k = x as (Element of ( NAT ));
A52: ( fp . k ) = { i9 where i9 is (Element of ( NAT )): (ex h being  natural number st (((i9 in X & k in ( NatDivisors n0 )) & h = k) & ( i9 gcd n0 ) = ( n0 / h ))) } by A3,A51;
assume A53: (not x in ( ( Card fp ) " { ( 0 ) } ));
assume A54: (not x in ( NatDivisors n0 ));
( fp . k ) = ( {} )
proof
assume ( fp . k ) <> ( {} );
then consider x9 being set such that A55: x9 in ( fp . k ) by XBOOLE_0:def 1;
(ex i being (Element of ( NAT )) st (x9 = i & (ex h being  natural number st (((i in X & k in ( NatDivisors n0 )) & h = k) & ( i gcd n0 ) = ( n0 / h ))))) by A52,A55;
hence contradiction by A54;
end;
then A56: y = ( ( Card fp ) . x ) by A3,A51,CARD_1:27,CARD_3:def 2;
x in ( dom ( Card fp ) ) by A3,A51,CARD_3:def 2;
then [ k,y ] in ( Card fp ) by A56,FUNCT_1:1;
hence contradiction by A53,A42,RELSET_1:30;
end;
reconsider f29 = ( Card fp ) as (FinSequence of ( REAL )) by CKB16:1;
reconsider f19 = f1 as (FinSequence of ( REAL )) by CKB16:1;
A57: ( NatDivisors n0 ) c= ( Seg n0 ) by MOEBIUS1:40;
( Seg n0 ) = ( dom ( Card fp ) ) by A3,CARD_3:def 2;
then f19 = ( f29 - { ( 0 ) } ) by A41,XBOOLE_0:def 5;
then A58: ( Sum f19 ) = ( Sum f29 ) by CKB15:1;
A59: (for d,e being Nat holds (((d in ( dom fp ) & e in ( dom fp )) & d <> e) implies ( fp . d ) misses ( fp . e )))
proof
let d being Nat;
let e being Nat;
assume d in ( dom fp );
then A60: ( fp . d ) = { i where i is (Element of ( NAT )): (ex h being  natural number st (((i in X & d in ( NatDivisors n0 )) & h = d) & ( i gcd n0 ) = ( n0 / h ))) } by A3;
assume e in ( dom fp );
then A61: ( fp . e ) = { i where i is (Element of ( NAT )): (ex h being  natural number st (((i in X & e in ( NatDivisors n0 )) & h = e) & ( i gcd n0 ) = ( n0 / h ))) } by A3;
assume A62: d <> e;
assume (not ( fp . d ) misses ( fp . e ));
then ( ( fp . d ) /\ ( fp . e ) ) <> ( {} ) by XBOOLE_0:def 7;
then consider x being set such that A63: x in ( ( fp . d ) /\ ( fp . e ) ) by XBOOLE_0:def 1;
x in ( fp . d ) by A63,XBOOLE_0:def 4;
then A64: (ex i1 being (Element of ( NAT )) st (x = i1 & (ex h being  natural number st (((i1 in X & d in ( NatDivisors n0 )) & h = d) & ( i1 gcd n0 ) = ( n0 / h ))))) by A60;
x in ( fp . e ) by A63,XBOOLE_0:def 4;
then (ex i2 being (Element of ( NAT )) st (x = i2 & (ex h being  natural number st (((i2 in X & e in ( NatDivisors n0 )) & h = e) & ( i2 gcd n0 ) = ( n0 / h ))))) by A61;
then d = ( n0 / ( n0 / e ) ) by A64,XCMPLX_1:52;
hence contradiction by A62,XCMPLX_1:52;
end;
A65: (for x being set holds (x in ( union ( rng fp ) ) iff x in X))
proof
let x being set;
thus (x in ( union ( rng fp ) ) implies x in X);
assume A66: x in X;
then reconsider i = x as  natural number;
( i gcd n0 ) divides n0 by NAT_D:def 5;
then consider h being  natural number such that A67: n0 = ( ( i gcd n0 ) * h ) by NAT_D:def 3;
A68: ( 0 ) < h by A67;
then ( ( 0 ) + 1 ) < ( h + 1 ) by XREAL_1:6;
then A69: 1 <= h by NAT_1:13;
A70: h divides n0 by A67,NAT_D:def 3;
then A71: h in ( NatDivisors n0 ) by A68,MOEBIUS1:39;
set Y = ( fp . h );
A72: h <> ( 0 ) by A67;
h <= n0 by A70,NAT_D:7;
then A73: h in ( dom fp ) by A3,A69,FINSEQ_1:1;
then A74: Y in ( rng fp ) by FUNCT_1:3;
A75: ( fp . h ) = { i9 where i9 is (Element of ( NAT )): (ex h9 being  natural number st (((i9 in X & h in ( NatDivisors n0 )) & h9 = h) & ( i9 gcd n0 ) = ( n0 / h9 ))) } by A3,A73;
( n0 / h ) = ( ( i gcd n0 ) * ( h / h ) ) by A67,XCMPLX_1:74
.= ( ( i gcd n0 ) * 1 ) by A72,XCMPLX_1:60;
then x in Y by A66,A71,A75;
hence x in ( union ( rng fp ) ) by A74,TARSKI:def 4;
end;
( len fp ) = k;
then ( card ( union ( rng fp ) ) ) = ( Sum ( Card fp ) ) by A59,INT_5:48;
then A76: ( card X ) = ( Sum ( Card fp ) ) by A65,TARSKI:1;
( card X ) = ( card n0 ) by FINSEQ_1:55;
then n0 = ( Sum ( Card fp ) ) by A76,CARD_1:def 2;
then ( Sum ( Func_Seq (( Euler_phi ),( Sgm ( NatDivisors n0 ) )) ) ) = n0 by A58,A39,BHSP_5:def 4;
hence thesis by A40,A57,CKB36:1;
end;
