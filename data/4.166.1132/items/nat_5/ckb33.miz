environ
vocabularies NUMBERS,ORDINAL1,XCMPLX_0,INT_2,NAT_3,XXREAL_0,XBOOLE_0,NEWTON,ARYTM_3,ARYTM_1,NAT_1,RELAT_1,CARD_1,ABIAN,SUBSET_1,FINSET_1,FINSEQ_1,FUNCT_1,FINSEQ_3,TARSKI,CARD_3,ORDINAL4,FUNCT_2,FINSEQ_2,FUNCOP_1,MOEBIUS1,COMPLEX1,INT_1,REALSET1,SQUARE_1,INT_5,ZFMISC_1,POWER,REAL_1,PRE_POLY,UPROOTS,BHSP_5,CLASSES1,XXREAL_2,MEMBERED,PARTFUN1,RFUNCT_3,BINOP_2,PROB_1,WAYBEL29,MSSUBFAM,TOPGEN_1,EULER_1,NAT_5;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,FUNCOP_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,MCART_1,FUNCT_2,ORDINAL1,CARD_1,NUMBERS,FINSEQ_1,FINSEQ_3,INT_1,INT_2,NAT_1,NAT_D,RVSUM_1,REAL_1,SQUARE_1,XXREAL_0,NEWTON,ABIAN,PEPIN,INT_5,MEMBERED,FINSEQOP,ENUMSET1,FINSET_1,COMPLEX1,NAT_3,DOMAIN_1,POWER,MOEBIUS1,BHSP_5,EULER_1,WSIERP_1,BINOP_1,RECDEF_1,EXTREAL1,UPROOTS,BINOP_2,FUNCT_3,RFUNCT_3,XXREAL_2,CLASSES1,PRE_POLY;
definitions TARSKI,NEWTON,FINSEQ_1,FINSEQ_3,EULER_1,MOEBIUS1;
theorems XBOOLE_0,XBOOLE_1,XXREAL_0,XREAL_1,XCMPLX_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,INT_1,INT_2,INT_4,INT_5,NEWTON,EULER_1,EULER_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_5,RVSUM_1,WSIERP_1,ORDINAL1,IDEA_1,INT_6,INT_3,FIB_NUM3,POWER,PEPIN,SQUARE_1,CARD_1,CARD_2,ZFMISC_1,ALGSEQ_1,FINSEQ_4,JGRAPH_1,TARSKI,COMPLEX1,ABSVALUE,MOEBIUS1,CARD_3,MESFUNC3,FUNCT_2,EXTREAL1,FINSEQOP,FUNCOP_1,BAGORDER,RELSET_1,WELLORD2,PARTFUN1,BHSP_5,UPROOTS,RFINSEQ,BINOP_2,BINOP_1,FUNCT_3,RFUNCT_3,NAT_4,NAT_3,RADIX_1,XREAL_0,ABIAN,ENUMSET1,MONOID_1,CLASSES1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32;
schemes NAT_1,FUNCT_1,FUNCT_2,BINOP_2,FINSEQ_1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,RVSUM_1,VALUED_0,NEWTON,ABIAN,FUNCT_1,ZFMISC_1,SUBSET_1,MOEBIUS1,FUNCT_2,PRE_CIRC,DYNKIN,RELAT_1,SQUARE_1,CARD_1,PREPOWER,NAT_3,UPROOTS,XXREAL_2,PRE_POLY;
constructors WELLORD2,REAL_1,NAT_D,BINOP_2,WSIERP_1,ABIAN,EULER_1,PEPIN,INT_5,RECDEF_1,MOEBIUS1,FINSEQOP,EXTREAL1,UPROOTS,NAT_3,REALSET1,POWER,BHSP_5,CALCUL_2,PROB_3,SUPINF_1,RFUNCT_3,XXREAL_2,CLASSES1,PBOOLE,BINOP_1;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve n for  natural number;
reserve m for  natural number;
reserve p for  natural number;
theorem
((p is  prime & ( p mod 4 ) = 1) implies (ex n st (ex m st p = ( ( n ^2 ) + ( m ^2 ) ))))
proof
( 0 ) <= ( sqrt p ) by SQUARE_1:def 2;
then reconsider p9 = [\ ( sqrt p ) /] as (Element of ( NAT )) by INT_1:3,INT_1:54;
reconsider p99 = ( p9 + 1 ) as (Element of ( NAT ));
set X = ( Segm p99 );
A1: ( card X ) = ( card p99 ) by CARD_1:def 6
.= ( 1 + [\ ( sqrt p ) /] ) by CARD_1:def 2;
then A2: ( ( sqrt p ) * ( card X ) ) < ( ( card X ) * ( card X ) ) by INT_1:29,XREAL_1:68;
assume A3: p is  prime;
then p > 1 by INT_2:def 4;
then ( p + 1 ) > ( 1 + 1 ) by XREAL_1:6;
then A4: p >= 2 by NAT_1:13;
A5: ( p9 ^2 ) <> p
proof
assume ( p9 ^2 ) = p;
then reconsider p99 = ( sqrt p ) as (Element of ( NAT )) by SQUARE_1:def 2;
( p99 ^2 ) = p by SQUARE_1:def 2;
then A6: ( p99 * p99 ) = p by SQUARE_1:def 1;
then A7: p99 divides p by INT_1:def 3;
per cases  by A3,A7,INT_2:def 4;
suppose p99 = 1;

hence contradiction by A3,A6,INT_2:def 4;
end;
suppose p99 = p;

then 1 = ( ( p * p ) / p ) by A3,A6,XCMPLX_1:60
.= ( p * ( p / p ) ) by XCMPLX_1:74
.= ( p * 1 ) by A3,XCMPLX_1:60;
hence contradiction by A3,INT_2:def 4;
end;
end;
p9 <= ( sqrt p ) by INT_1:def 6;
then ( p9 ^2 ) <= ( ( sqrt p ) ^2 ) by SQUARE_1:15;
then ( p9 ^2 ) <= p by SQUARE_1:def 2;
then A8: ( p9 ^2 ) < p by A5,XXREAL_0:1;
assume A9: ( p mod 4 ) = 1;
then p <> 2 by NAT_D:24;
then p > 2 by A4,XXREAL_0:1;
then ( - 1 ) is_quadratic_residue_mod p by A3,A9,INT_5:37;
then consider s being Integer such that A10: ( ( ( s ^2 ) - ( - 1 ) ) mod p ) = ( 0 ) by INT_5:def 2;
( 0 ) < ( sqrt p ) by A3,SQUARE_1:25;
then ( ( sqrt p ) * ( sqrt p ) ) < ( ( card X ) * ( sqrt p ) ) by A1,INT_1:29,XREAL_1:68;
then ( ( sqrt p ) * ( sqrt p ) ) < ( ( card X ) * ( card X ) ) by A2,XXREAL_0:2;
then ( sqrt ( p * p ) ) < ( ( card X ) * ( card X ) ) by SQUARE_1:29;
then ( sqrt ( p ^2 ) ) < ( ( card X ) * ( card X ) ) by SQUARE_1:def 1;
then p < ( ( card X ) * ( card X ) ) by SQUARE_1:22;
then A11: p < ( card [: X,X :] ) by CARD_2:46;
(for s being  integer number holds (ex x9,x99,y9,y99 being  natural number st (((((x9 in X & x99 in X) & y9 in X) & y99 in X) & [ x9,y9 ] <> [ x99,y99 ]) & ( ( x9 - ( s * y9 ) ) mod p ) = ( ( x99 - ( s * y99 ) ) mod p ))))
proof
set A = [: X,X :];
reconsider p9 = p as (Element of ( NAT )) by ORDINAL1:def 12;
let s being  integer number;
set B = ( Segm p9 );
defpred P[ set,set ]
 means
(ex n1,n2,n3 being (Element of ( NAT )) st (($1 = [ n1,n2 ] & $2 = n3) & ( ( n1 - ( s * n2 ) ) mod p ) = n3));
( card B ) = ( card p9 ) by CARD_1:def 6
.= p by CARD_1:def 2;
then A12: ( card B ) in ( card A ) by A11,NAT_1:44;
A13: (for x being set holds (x in A implies (ex y being set st (y in B & P[ x,y ]))))
proof
let x being set;
assume x in A;
then consider n1 being set,n2 being set such that A14: (n1 in X & n2 in X) and A15: x = [ n1,n2 ] by ZFMISC_1:def 2;
reconsider n1,n2 as (Element of ( NAT )) by A14;
set y = ( ( n1 - ( s * n2 ) ) mod p );
reconsider y as (Element of ( NAT )) by INT_1:3,INT_1:57;
take y;
y < p by A3,INT_1:58;
then y in p by NAT_1:44;
hence y in B by CARD_1:def 6;
thus P[ x,y ] by A15;
end;
consider f being (Function of A,B) such that A16: (for x being set holds (x in A implies P[ x,( f . x ) ])) from FUNCT_2:sch 1(A13);
B <> ( {} ) by A3,ALGSEQ_1:1;
then consider x1 being set,x2 being set such that A17: x1 in A and A18: x2 in A and A19: x1 <> x2 and A20: ( f . x1 ) = ( f . x2 ) by A12,FINSEQ_4:65;
consider x9 being set,y9 being set such that A21: (x9 in X & y9 in X) and A22: x1 = [ x9,y9 ] by A17,ZFMISC_1:def 2;
reconsider x9,y9 as  natural number by A21;
consider x99 being set,y99 being set such that A23: (x99 in X & y99 in X) and A24: x2 = [ x99,y99 ] by A18,ZFMISC_1:def 2;
reconsider x99,y99 as  natural number by A23;
take x9;
take x99;
take y9;
take y99;
thus (((x9 in X & x99 in X) & y9 in X) & y99 in X) by A21,A23;
thus [ x9,y9 ] <> [ x99,y99 ] by A19,A22,A24;
consider n11 being (Element of ( NAT )),n12 being (Element of ( NAT )),n13 being (Element of ( NAT )) such that A25: x1 = [ n11,n12 ] and A26: (( f . x1 ) = n13 & ( ( n11 - ( s * n12 ) ) mod p ) = n13) by A16,A17;
A27: (n11 = x9 & n12 = y9) by A22,A25,ZFMISC_1:27;
consider n21 being (Element of ( NAT )),n22 being (Element of ( NAT )),n23 being (Element of ( NAT )) such that A28: x2 = [ n21,n22 ] and A29: (( f . x2 ) = n23 & ( ( n21 - ( s * n22 ) ) mod p ) = n23) by A16,A18;
n21 = x99 by A24,A28,ZFMISC_1:27;
hence ( ( x9 - ( s * y9 ) ) mod p ) = ( ( x99 - ( s * y99 ) ) mod p ) by A20,A24,A26,A28,A29,A27,ZFMISC_1:27;
end;
then consider x9 being  natural number,x99 being  natural number,y9 being  natural number,y99 being  natural number such that A30: x9 in X and A31: x99 in X and A32: y9 in X and A33: y99 in X and A34: [ x9,y9 ] <> [ x99,y99 ] and A35: ( ( x9 - ( s * y9 ) ) mod p ) = ( ( x99 - ( s * y99 ) ) mod p );
set m9 = ( y9 - y99 );
A36: ( 0 ) = ( ( ( ( ( s ^2 ) + 1 ) mod p ) * ( ( m9 ^2 ) mod p ) ) mod p ) by A10,INT_4:12
.= ( ( ( ( s ^2 ) + 1 ) * ( m9 ^2 ) ) mod p ) by NAT_D:67
.= ( ( ( ( s ^2 ) * ( m9 ^2 ) ) + ( m9 ^2 ) ) mod p )
.= ( ( ( ( s * m9 ) ^2 ) + ( m9 ^2 ) ) mod p ) by SQUARE_1:9;
set n9 = ( x9 - x99 );
A37: ( ( n9 + ( s * m9 ) ) * ( n9 - ( s * m9 ) ) ) = ( ( n9 to_power 2 ) - ( ( s * m9 ) to_power 2 ) ) by FIB_NUM3:7
.= ( ( n9 ^2 ) - ( ( s * m9 ) to_power 2 ) ) by POWER:46
.= ( ( n9 ^2 ) - ( ( s * m9 ) ^2 ) ) by POWER:46;
( ( ( x9 - ( s * y9 ) ) mod p ) - ( ( x99 - ( s * y99 ) ) mod p ) ) = ( 0 ) by A35;
then ( ( ( x9 - ( s * y9 ) ) - ( x99 - ( s * y99 ) ) ) mod p ) = ( ( 0 ) mod p ) by INT_6:7;
then ( ( ( x9 - x99 ) - ( s * ( y9 - y99 ) ) ) mod p ) = ( 0 ) by INT_4:12;
then ( 0 ) = ( ( ( ( n9 + ( s * m9 ) ) mod p ) * ( ( n9 - ( s * m9 ) ) mod p ) ) mod p ) by INT_4:12
.= ( ( ( n9 ^2 ) - ( ( s * m9 ) ^2 ) ) mod p ) by A37,NAT_D:67;
then ( 0 ) = ( ( ( ( ( n9 ^2 ) - ( ( s * m9 ) ^2 ) ) mod p ) + ( ( ( ( s * m9 ) ^2 ) + ( m9 ^2 ) ) mod p ) ) mod p ) by A36,INT_4:12
.= ( ( ( ( n9 ^2 ) - ( ( s * m9 ) ^2 ) ) + ( ( ( s * m9 ) ^2 ) + ( m9 ^2 ) ) ) mod p ) by NAT_D:66
.= ( ( ( n9 ^2 ) + ( m9 ^2 ) ) mod p );
then p divides ( ( n9 ^2 ) + ( m9 ^2 ) ) by A3,INT_1:62;
then consider i being Integer such that A38: ( ( n9 ^2 ) + ( m9 ^2 ) ) = ( p * i ) by INT_1:def 3;
A39: ( p * i ) = ( ( |. n9 .| ^2 ) + ( m9 ^2 ) ) by A38,COMPLEX1:75
.= ( ( ( abs n9 ) ^2 ) + ( ( abs m9 ) ^2 ) ) by COMPLEX1:75;
y9 in p99 by A32,CARD_1:def 6;
then y9 < p99 by NAT_1:44;
then A40: y9 <= p9 by NAT_1:13;
x99 in p99 by A31,CARD_1:def 6;
then x99 < p99 by NAT_1:44;
then A41: x99 <= p9 by NAT_1:13;
y99 in p99 by A33,CARD_1:def 6;
then y99 < p99 by NAT_1:44;
then A42: y99 <= p9 by NAT_1:13;
x9 in p99 by A30,CARD_1:def 6;
then x9 < p99 by NAT_1:44;
then A43: x9 <= p9 by NAT_1:13;
set m = ( abs m9 );
A44: (y9 in ( NAT ) & y99 in ( NAT )) by ORDINAL1:def 12;
set n = ( abs n9 );
(x9 in ( NAT ) & x99 in ( NAT )) by ORDINAL1:def 12;
then reconsider x9,x99,y9,y99 as Real by A44;
( abs ( y9 - y99 ) ) <= ( p9 - ( 0 ) ) by A40,A42,JGRAPH_1:27;
then ( m ^2 ) <= ( p9 ^2 ) by SQUARE_1:15;
then A45: ( m ^2 ) < p by A8,XXREAL_0:2;
( abs ( x9 - x99 ) ) <= ( p9 - ( 0 ) ) by A43,A41,JGRAPH_1:27;
then ( n ^2 ) <= ( p9 ^2 ) by SQUARE_1:15;
then ( n ^2 ) < p by A8,XXREAL_0:2;
then ( ( n ^2 ) + ( m ^2 ) ) < ( p + p ) by A45,XREAL_1:8;
then ( ( i * p ) / p ) < ( ( 2 * p ) / p ) by A3,A39,XREAL_1:74;
then ( ( i * p ) / p ) < ( 2 * ( p / p ) ) by XCMPLX_1:74;
then ( i * ( p / p ) ) < ( 2 * ( p / p ) ) by XCMPLX_1:74;
then ( i * ( p / p ) ) < ( 2 * 1 ) by A3,XCMPLX_1:60;
then ( i * 1 ) < 2 by A3,XCMPLX_1:60;
then ( i + 1 ) <= 2 by INT_1:7;
then A46: ( ( i + 1 ) - 1 ) <= ( 2 - 1 ) by XREAL_1:9;
take n;
take m;
( ( n ^2 ) + ( m ^2 ) ) <> ( 0 )
proof
assume A47: ( ( n ^2 ) + ( m ^2 ) ) = ( 0 );
then ( m ^2 ) = ( 0 );
then ( m * m ) = ( 0 ) by SQUARE_1:def 1;
then m = ( 0 );
then A48: ( y9 - y99 ) = ( 0 ) by ABSVALUE:2;
( n ^2 ) = ( 0 ) by A47;
then ( n * n ) = ( 0 ) by SQUARE_1:def 1;
then n = ( 0 );
then ( x9 - x99 ) = ( 0 ) by ABSVALUE:2;
hence contradiction by A34,A48;
end;
then i > ( 0 ) by A39;
then i >= ( ( 0 ) + 1 ) by INT_1:7;
then i = 1 by A46,XXREAL_0:1;
hence p = ( ( n ^2 ) + ( m ^2 ) ) by A39;
end;
