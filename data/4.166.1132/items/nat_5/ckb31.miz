environ
vocabularies NUMBERS,ORDINAL1,XCMPLX_0,INT_2,NAT_3,XXREAL_0,XBOOLE_0,NEWTON,ARYTM_3,ARYTM_1,NAT_1,RELAT_1,CARD_1,ABIAN,SUBSET_1,FINSET_1,FINSEQ_1,FUNCT_1,FINSEQ_3,TARSKI,CARD_3,ORDINAL4,FUNCT_2,FINSEQ_2,FUNCOP_1,MOEBIUS1,COMPLEX1,INT_1,REALSET1,SQUARE_1,INT_5,ZFMISC_1,POWER,REAL_1,PRE_POLY,UPROOTS,BHSP_5,CLASSES1,XXREAL_2,MEMBERED,PARTFUN1,RFUNCT_3,BINOP_2,PROB_1,WAYBEL29,MSSUBFAM,TOPGEN_1,EULER_1,NAT_5;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,FUNCOP_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,MCART_1,FUNCT_2,ORDINAL1,CARD_1,NUMBERS,FINSEQ_1,FINSEQ_3,INT_1,INT_2,NAT_1,NAT_D,RVSUM_1,REAL_1,SQUARE_1,XXREAL_0,NEWTON,ABIAN,PEPIN,INT_5,MEMBERED,FINSEQOP,ENUMSET1,FINSET_1,COMPLEX1,NAT_3,DOMAIN_1,POWER,MOEBIUS1,BHSP_5,EULER_1,WSIERP_1,BINOP_1,RECDEF_1,EXTREAL1,UPROOTS,BINOP_2,FUNCT_3,RFUNCT_3,XXREAL_2,CLASSES1,PRE_POLY;
definitions TARSKI,NEWTON,FINSEQ_1,FINSEQ_3,EULER_1,MOEBIUS1;
theorems XBOOLE_0,XBOOLE_1,XXREAL_0,XREAL_1,XCMPLX_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,INT_1,INT_2,INT_4,INT_5,NEWTON,EULER_1,EULER_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_5,RVSUM_1,WSIERP_1,ORDINAL1,IDEA_1,INT_6,INT_3,FIB_NUM3,POWER,PEPIN,SQUARE_1,CARD_1,CARD_2,ZFMISC_1,ALGSEQ_1,FINSEQ_4,JGRAPH_1,TARSKI,COMPLEX1,ABSVALUE,MOEBIUS1,CARD_3,MESFUNC3,FUNCT_2,EXTREAL1,FINSEQOP,FUNCOP_1,BAGORDER,RELSET_1,WELLORD2,PARTFUN1,BHSP_5,UPROOTS,RFINSEQ,BINOP_2,BINOP_1,FUNCT_3,RFUNCT_3,NAT_4,NAT_3,RADIX_1,XREAL_0,ABIAN,ENUMSET1,MONOID_1,CLASSES1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30;
schemes NAT_1,FUNCT_1,FUNCT_2,BINOP_2,FINSEQ_1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,RVSUM_1,VALUED_0,NEWTON,ABIAN,FUNCT_1,ZFMISC_1,SUBSET_1,MOEBIUS1,FUNCT_2,PRE_CIRC,DYNKIN,RELAT_1,SQUARE_1,CARD_1,PREPOWER,NAT_3,UPROOTS,XXREAL_2,PRE_POLY;
constructors WELLORD2,REAL_1,NAT_D,BINOP_2,WSIERP_1,ABIAN,EULER_1,PEPIN,INT_5,RECDEF_1,MOEBIUS1,FINSEQOP,EXTREAL1,UPROOTS,NAT_3,REALSET1,POWER,BHSP_5,CALCUL_2,PROB_3,SUPINF_1,RFUNCT_3,XXREAL_2,CLASSES1,PBOOLE,BINOP_1;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve k for  natural number;
reserve n for  natural number;
reserve l for  natural number;
theorem
Lm10: (for f being (FinSequence of ( NAT )) holds ((((( n + 2 ) is  prime & ( rng f ) c= ( Seg n )) & f is  one-to-one) & (for l holds ((l in ( rng f ) & l <> 1) implies (ex k st (((k in ( rng f ) & k <> 1) & k <> l) & ( ( l * k ) mod ( n + 2 ) ) = 1))))) implies ( ( Product f ) mod ( n + 2 ) ) = 1))
proof
defpred P[  natural number ]
 means
(for f being (FinSequence of ( NAT )) holds (((((( len f ) = $1 & ( n + 2 ) is  prime) & ( rng f ) c= ( Seg n )) & f is  one-to-one) & (for l holds ((l in ( rng f ) & l <> 1) implies (ex k st (((k in ( rng f ) & k <> 1) & k <> l) & ( ( l * k ) mod ( n + 2 ) ) = 1))))) implies ( ( Product f ) mod ( n + 2 ) ) = 1));
let f being (FinSequence of ( NAT ));
set n9 = ( len f );
A1: (for k9 being  natural number holds ((for n9 being  natural number holds (n9 < k9 implies P[ n9 ])) implies P[ k9 ]))
proof
let k9 being  natural number;
assume A2: (for n9 being  natural number holds (n9 < k9 implies P[ n9 ]));
thus P[ k9 ]
proof
let f being (FinSequence of ( NAT ));
assume A3: ( len f ) = k9;
assume A4: ( n + 2 ) is  prime;
assume A5: ( rng f ) c= ( Seg n );
assume A6: f is  one-to-one;
assume A7: (for l holds ((l in ( rng f ) & l <> 1) implies (ex k st (((k in ( rng f ) & k <> 1) & k <> l) & ( ( l * k ) mod ( n + 2 ) ) = 1))));
per cases ;
suppose A8: k9 = ( 0 );

A9: ( ( 0 ) + 1 ) < ( ( n + 1 ) + 1 ) by XREAL_1:6;
f = ( <*> ( NAT ) ) by A3,A8;
then ( Product f ) = 1 by RVSUM_1:94;
hence ( ( Product f ) mod ( n + 2 ) ) = 1 by A9,NAT_D:24;
end;
suppose A10: k9 <> ( 0 );

reconsider f9 = f as (FinSequence of ( REAL )) by FINSEQ_2:24;
( dom f ) <> ( {} ) by A3,A10,CARD_1:27,RELAT_1:41;
then consider x1 being set such that A11: x1 in ( dom f ) by XBOOLE_0:def 1;
reconsider x1 as (Element of ( NAT )) by A11;
A12: (ex m being Nat st (( len f ) = ( m + 1 ) & ( len ( Del (f,x1) ) ) = m)) by A11,FINSEQ_3:104;
A13: ( ( Product ( Del (f9,x1) ) ) * ( f9 . x1 ) ) = ( Product f ) by A11,CKB29:1;
A14: ( rng ( Del (f,x1) ) ) c= ( rng f ) by FINSEQ_3:106;
then A15: ( rng ( Del (f,x1) ) ) c= ( Seg n ) by A5,XBOOLE_1:1;
set n19 = ( len ( Del (f,x1) ) );
A16: ( ( 0 ) + n19 ) < ( 1 + n19 ) by XREAL_1:6;
A17: ( Del (f,x1) ) is  one-to-one by A6,CKB9:1;
per cases ;
suppose A18: ( f9 . x1 ) = 1;

(for l holds ((l in ( rng ( Del (f,x1) ) ) & l <> 1) implies (ex k st (((k in ( rng ( Del (f,x1) ) ) & k <> 1) & k <> l) & ( ( l * k ) mod ( n + 2 ) ) = 1))))
proof
let l;
assume A19: l in ( rng ( Del (f,x1) ) );
assume l <> 1;
then consider k such that A20: k in ( rng f ) and A21: k <> 1 and A22: (k <> l & ( ( l * k ) mod ( n + 2 ) ) = 1) by A7,A14,A19;
take k;
thus k in ( rng ( Del (f,x1) ) ) by A18,A20,A21,CKB11:1;
thus ((k <> 1 & k <> l) & ( ( l * k ) mod ( n + 2 ) ) = 1) by A21,A22;
end;
hence ( ( Product f ) mod ( n + 2 ) ) = 1 by A2,A3,A4,A13,A15,A17,A12,A16,A18;
end;
suppose A23: ( f9 . x1 ) <> 1;

set f99 = ( Del (f,x1) );
set l = ( f . x1 );
A24: l in ( rng f ) by A11,FUNCT_1:3;
then consider k being  natural number such that A25: k in ( rng f ) and k <> 1 and A26: k <> l and A27: ( ( l * k ) mod ( n + 2 ) ) = 1 by A7,A23;
k in ( rng f99 ) by A25,A26,CKB11:1;
then consider x2 being set such that A28: x2 in ( dom f99 ) and A29: k = ( f99 . x2 ) by FUNCT_1:def 3;
reconsider x2 as (Element of ( NAT )) by A28;
A30: ( rng ( Del (f99,x2) ) ) c= ( rng ( Del (f9,x1) ) ) by FINSEQ_3:106;
then A31: ( rng ( Del (f99,x2) ) ) c= ( Seg n ) by A15,XBOOLE_1:1;
A32: (for l holds ((l in ( rng ( Del (f99,x2) ) ) & l <> 1) implies (ex k st (((k in ( rng ( Del (f99,x2) ) ) & k <> 1) & k <> l) & ( ( l * k ) mod ( n + 2 ) ) = 1))))
proof
A33: 1 <= l by A5,A24,FINSEQ_1:1;
A34: ( ( 0 ) + n ) < ( 2 + n ) by XREAL_1:6;
l <= n by A5,A24,FINSEQ_1:1;
then A35: ( n + 2 ) > l by A34,XXREAL_0:2;
k <= n by A5,A25,FINSEQ_1:1;
then A36: ( n + 2 ) > k by A34,XXREAL_0:2;
let l9 being  natural number;
A37: ( ( 0 ) + n ) < ( 2 + n ) by XREAL_1:6;
assume A38: l9 in ( rng ( Del (f99,x2) ) );
then A39: l9 in ( rng ( Del (f9,x1) ) ) by A30;
then l9 in ( rng f ) by A14;
then A40: l9 <= n by A5,FINSEQ_1:1;
assume l9 <> 1;
then consider k9 being  natural number such that A41: k9 in ( rng f ) and A42: (k9 <> 1 & k9 <> l9) and A43: ( ( l9 * k9 ) mod ( n + 2 ) ) = 1 by A7,A14,A39;
take k9;
A44: 1 <= k by A5,A25,FINSEQ_1:1;
thus k9 in ( rng ( Del (f99,x2) ) )
proof
assume A45: (not k9 in ( rng ( Del (f99,x2) ) ));
per cases ;
suppose A46: k9 in ( rng f99 );

A47: l9 < ( n + 2 ) by A40,A37,XXREAL_0:2;
( ( k * l ) mod ( n + 2 ) ) = ( ( k * l9 ) mod ( n + 2 ) ) by A27,A29,A43,A45,A46,CKB11:1;
then l9 = l by A4,A44,A36,A35,A47,CKB23:1;
hence contradiction by A6,A11,A30,A38,CKB10:1;
end;
suppose A48: (not k9 in ( rng f99 ));

A49: l9 < ( n + 2 ) by A40,A37,XXREAL_0:2;
( ( l * k ) mod ( n + 2 ) ) = ( ( l * l9 ) mod ( n + 2 ) ) by A27,A41,A43,A48,CKB11:1;
then ( f99 . x2 ) in ( rng ( Del (f99,x2) ) ) by A4,A29,A38,A33,A36,A35,A49,CKB23:1;
hence contradiction by A6,A28,CKB9:1,CKB10:1;
end;
end;

thus ((k9 <> 1 & k9 <> l9) & ( ( l9 * k9 ) mod ( n + 2 ) ) = 1) by A42,A43;
end;
set n299 = ( len ( Del (f99,x2) ) );
A50: ( ( 0 ) + n299 ) < ( 1 + n299 ) by XREAL_1:6;
(ex m being Nat st (( len ( Del (f9,x1) ) ) = ( m + 1 ) & ( len ( Del (f99,x2) ) ) = m)) by A28,FINSEQ_3:104;
then A51: n299 < k9 by A3,A12,A16,A50,XXREAL_0:2;
A52: ( Del (f99,x2) ) is  one-to-one by A17,CKB9:1;
( ( Product ( Del (f99,x2) ) ) * ( f99 . x2 ) ) = ( Product f99 ) by A28,CKB29:1;
then ( ( Product ( Del (f99,x2) ) ) * ( k * l ) ) = ( Product f ) by A13,A29;
hence ( ( Product f ) mod ( n + 2 ) ) = ( ( ( Product ( Del (f99,x2) ) ) * ( ( k * l ) mod ( n + 2 ) ) ) mod ( n + 2 ) ) by EULER_2:7
.= 1 by A2,A4,A27,A31,A52,A32,A51;
end;
end;
end;

end;
(for n9 being  natural number holds P[ n9 ]) from NAT_1:sch 4(A1);
then P[ n9 ];
hence thesis;
end;
