environ
vocabularies NUMBERS,SUBSET_1,FINSEQ_1,INT_1,RELAT_1,FUNCT_1,ORDINAL4,XBOOLE_0,XXREAL_0,PARTFUN1,GRAPH_1,STRUCT_0,TREES_2,GLIB_000,GRAPH_5,CARD_3,GRAPH_4,NAT_1,ARYTM_3,TARSKI,CARD_1,FINSET_1,FUNCT_4,REAL_1,FUNCT_2,ARYTM_1,GRAPHSP;
notations XCMPLX_0,XXREAL_0,REAL_1,INT_1,TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,FINSEQ_1,SEQ_1,FINSEQ_2,FINSEQ_4,CARD_1,FINSET_1,STRUCT_0,GRAPH_1,PARTFUN1,FUNCT_2,CQC_SIM1,GRAPH_4,GRAPH_5,NAT_D,DOMAIN_1,RVSUM_1,NUMBERS,FUNCT_7,NAT_1,CKB21,CKB22,CKB23,CKB28,CKB29,CKB30,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB44,CKB45,CKB51,CKB54,CKB62,CKB63,CKB64,CKB65,CKB75,CKB83,CKB84,CKB86,CKB93,CKB94;
definitions TARSKI,RVSUM_1,CKB23,CKB30,CKB35,CKB36,CKB37,CKB38,CKB39,CKB44,CKB45,CKB51,CKB54,CKB62,CKB63,CKB64,CKB65,CKB75,CKB83,CKB84,CKB86,CKB93,CKB94;
theorems FUNCT_2,FUNCT_1,PARTFUN1,FINSEQ_1,NAT_1,ZFMISC_1,TARSKI,FINSEQ_3,XBOOLE_0,XBOOLE_1,SUBSET_1,GRAPH_1,FINSEQ_4,CARD_2,INT_1,GRAPH_5,GRAPH_4,FINSEQ_2,ENUMSET1,FUNCT_7,XREAL_1,XXREAL_0,FINSOP_1,ORDINAL1,NAT_D,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB23,CKB24,CKB25,CKB26,CKB27,CKB30,CKB31,CKB32,CKB33,CKB35,CKB36,CKB37,CKB38,CKB39,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB48,CKB49,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB76,CKB77,CKB78,CKB79,CKB80,CKB81,CKB82,CKB83,CKB84,CKB85,CKB86,CKB87,CKB88,CKB89,CKB90,CKB91,CKB92,CKB93,CKB94,CKB95,CKB96,CKB97,CKB98,CKB99,CKB100;
schemes NAT_1,GRAPH_5,CLASSES1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FUNCT_2,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,GRAPH_1,GRAPH_4,GRAPH_5,VALUED_0,CARD_1,FUNCT_1,CKB47,CKB50;
constructors DOMAIN_1,XXREAL_0,REAL_1,FINSEQ_4,FINSOP_1,NAT_D,FUNCT_7,CQC_SIM1,GRAPH_4,GRAPH_5,SEQ_1,BINOP_2,RVSUM_1,RELSET_1,CKB22,CKB23,CKB28,CKB29,CKB30,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB44,CKB45,CKB51,CKB54,CKB62,CKB63,CKB64,CKB65,CKB75,CKB83,CKB84,CKB86,CKB93,CKB94;
requirements NUMERALS,SUBSET,BOOLE,REAL,ARITHM;
begin
reserve x for set;
reserve i for (Element of ( NAT ));
reserve j for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve e for set;
reserve f for (Element of ( ( REAL ) * ));
reserve g for (Element of ( ( REAL ) * ));
reserve p for (FinSequence of ( NAT ));
reserve G for  finite  oriented Graph;
reserve P for  oriented (Chain of G);
reserve Q for  oriented (Chain of G);
reserve W for (Function of (the carrier' of G),( Real>=0 ));
reserve v1 for (Vertex of G);
reserve v2 for (Vertex of G);
reserve v3 for (Vertex of G);
reserve v4 for (Vertex of G);
theorem
((((((f is_Input_of_Dijkstra_Alg G,n,W & v1 = 1) & 1 <> v2) & v2 = i) & n >= 1) & g = ( ( DijkstraAlgorithm n ) . f )) implies (((the carrier of G) = ( ( UsedVx (g,n) ) \/ ( UnusedVx (g,n) ) ) & (v2 in ( UsedVx (g,n) ) implies (ex p st (ex P st (((p is_simple_vertex_seq_at g,i,n & P is_oriented_edge_seq_of p) & P is_shortestpath_of v1,v2,W) & ( cost (P,W) ) = ( g . ( ( 2 * n ) + i ) )))))) & (v2 in ( UnusedVx (g,n) ) implies (not (ex Q st Q is_orientedpath_of v1,v2)))))
proof
assume that
A1: f is_Input_of_Dijkstra_Alg G,n,W
and
A2: v1 = 1
and
A3: 1 <> v2
and
A4: v2 = i
and
A5: n >= 1
and
A6: g = ( ( DijkstraAlgorithm n ) . f );
A7: ( Seg n ) = (the carrier of G) by A1,CKB93:def 1;
then reconsider VG = (the carrier of G) as non empty (Subset of ( NAT )) by A5;
A8: ( f . ( n + 1 ) ) = ( 0 ) by A1,CKB93:def 1;
set Ug = ( UsedVx (g,n) );
set Vg = ( UnusedVx (g,n) );
set R = ( Relax n );
set M = ( findmin n );
set RM = ( repeat ( R * M ) );
set cn = ( LifeSpan (( R * M ),f,n) );
set mi = ( ( ( n * n ) + ( 3 * n ) ) + 1 );
A9: g = ( ( RM . cn ) . f ) by A6,CKB37:def 1;
A10: ( Ug \/ Vg ) c= VG
proof
let x;
assume A11: x in ( Ug \/ Vg );
per cases  by A11,XBOOLE_0:def 3;
suppose x in Ug;

then (ex k st ((((x = k & k in ( dom g )) & 1 <= k) & k <= n) & ( g . k ) = ( - 1 )));
hence thesis by A7,FINSEQ_1:1;
end;
suppose x in Vg;

then (ex k st ((((x = k & k in ( dom g )) & 1 <= k) & k <= n) & ( g . k ) <> ( - 1 )));
hence thesis by A7,FINSEQ_1:1;
end;
end;
A12: ( len f ) = mi by A1,CKB93:def 1;
VG c= ( Ug \/ Vg )
proof
let x;
assume A13: x in VG;
then reconsider j = x as (Element of ( NAT ));
A14: 1 <= j by A7,A13,FINSEQ_1:1;
A15: j <= n by A7,A13,FINSEQ_1:1;
n < mi by CKB59:1;
then j < mi by A15,XXREAL_0:2;
then j in ( dom f ) by A12,A14,FINSEQ_3:25;
then A16: j in ( dom g ) by A9,CKB74:1;
per cases ;
suppose ( g . j ) = ( - 1 );

then j in { k: (((k in ( dom g ) & 1 <= k) & k <= n) & ( g . k ) = ( - 1 )) } by A14,A15,A16;
hence thesis by XBOOLE_0:def 3;
end;
suppose ( g . j ) <> ( - 1 );

then j in { k: (((k in ( dom g ) & 1 <= k) & k <= n) & ( g . k ) <> ( - 1 )) } by A14,A15,A16;
hence thesis by XBOOLE_0:def 3;
end;
end;
hence A17: (the carrier of G) = ( Ug \/ Vg ) by A10,XBOOLE_0:def 10;
defpred P[ (Element of ( NAT )) ]
 means
($1 <= cn implies (((for v3 holds (for j holds (((v3 <> v1 & v3 = j) & ( ( ( RM . $1 ) . f ) . ( n + j ) ) <> ( - 1 )) implies (ex p st (ex P st (((((p is_simple_vertex_seq_at ( ( RM . $1 ) . f ),j,n & (for m holds ((1 <= m & m < ( len p )) implies ( p . m ) in ( UsedVx (( ( RM . $1 ) . f ),n) )))) & P is_oriented_edge_seq_of p) & P is_shortestpath_of v1,v3,( UsedVx (( ( RM . $1 ) . f ),n) ),W) & ( cost (P,W) ) = ( ( ( RM . $1 ) . f ) . ( ( 2 * n ) + j ) )) & ((not v3 in ( UsedVx (( ( RM . $1 ) . f ),n) )) implies P islongestInShortestpath ( UsedVx (( ( RM . $1 ) . f ),n) ),v1,W))))))) & (for m holds (for j holds ((((( ( ( RM . $1 ) . f ) . ( n + j ) ) = ( - 1 ) & 1 <= j) & j <= n) & m in ( UsedVx (( ( RM . $1 ) . f ),n) )) implies ( f . ( ( ( 2 * n ) + ( n * m ) ) + j ) ) = ( - 1 ))))) & (for m holds (m in ( UsedVx (( ( RM . $1 ) . f ),n) ) implies ( ( ( RM . $1 ) . f ) . ( n + m ) ) <> ( - 1 )))));
1 <= mi by NAT_1:12;
then A18: 1 in ( dom f ) by A12,FINSEQ_3:25;
A19: ((for m holds ((1 <= m & m <= n) implies ( f . m ) = 1)) & (for m holds ((2 <= m & m <= n) implies ( f . ( n + m ) ) = ( - 1 )))) by A1,CKB93:def 1;
then { 1 } = ( UsedVx (( ( RM . 1 ) . f ),n) ) by A5,A8,A18,CKB81:1;
then A20: 1 in ( UsedVx (( ( RM . 1 ) . f ),n) ) by TARSKI:def 1;
A21: (for k holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k;
assume A22: P[ k ];
now
set FK1 = ( ( RM . ( k + 1 ) ) . f );
set UV1 = ( UsedVx (FK1,n) );
set FK = ( ( RM . k ) . f );
assume A23: ( k + 1 ) <= cn;
then A24: k < cn by NAT_1:13;
then A25: ( OuterVx (FK,n) ) <> ( {} ) by CKB36:def 1;
per cases ;
suppose k = ( 0 );

hence (((for v3 holds (for j holds (((v3 <> v1 & v3 = j) & ( FK1 . ( n + j ) ) <> ( - 1 )) implies (ex p st (ex P st (((((p is_simple_vertex_seq_at FK1,j,n & (for m holds ((1 <= m & m < ( len p )) implies ( p . m ) in UV1))) & P is_oriented_edge_seq_of p) & P is_shortestpath_of v1,v3,UV1,W) & ( cost (P,W) ) = ( FK1 . ( ( 2 * n ) + j ) )) & ((not v3 in UV1) implies P islongestInShortestpath UV1,v1,W))))))) & (for m holds (for j holds ((((( FK1 . ( n + j ) ) = ( - 1 ) & 1 <= j) & j <= n) & m in UV1) implies ( f . ( ( ( 2 * n ) + ( n * m ) ) + j ) ) = ( - 1 ))))) & (for m holds (m in UV1 implies ( FK1 . ( n + m ) ) <> ( - 1 )))) by A1,A2,A5,CKB95:1;
end;
suppose k <> ( 0 );

then k >= ( 1 + ( 0 ) ) by INT_1:7;
then 1 in ( UsedVx (FK,n) ) by A20,A24,CKB82:1;
hence (((for v3 holds (for j holds (((v3 <> v1 & v3 = j) & ( FK1 . ( n + j ) ) <> ( - 1 )) implies (ex p st (ex P st (((((p is_simple_vertex_seq_at FK1,j,n & (for m holds ((1 <= m & m < ( len p )) implies ( p . m ) in UV1))) & P is_oriented_edge_seq_of p) & P is_shortestpath_of v1,v3,UV1,W) & ( cost (P,W) ) = ( FK1 . ( ( 2 * n ) + j ) )) & ((not v3 in UV1) implies P islongestInShortestpath UV1,v1,W))))))) & (for m holds (for j holds ((((( FK1 . ( n + j ) ) = ( - 1 ) & 1 <= j) & j <= n) & m in UV1) implies ( f . ( ( ( 2 * n ) + ( n * m ) ) + j ) ) = ( - 1 ))))) & (for m holds (m in UV1 implies ( FK1 . ( n + m ) ) <> ( - 1 )))) by A1,A2,A5,A22,A23,A25,CKB100:1,NAT_1:13;
end;
end;
hence thesis;
end;
A26: ( ( RM . ( 0 ) ) . f ) = f by CKB31:1;
A27: P[ ( 0 ) ]
proof
set UV = ( UsedVx (( ( RM . ( 0 ) ) . f ),n) );
set h = ( ( RM . ( 0 ) ) . f );
assume ( 0 ) <= cn;
hereby
let v3;
let j;
assume that
A28: v3 <> v1
and
A29: v3 = j
and
A30: ( h . ( n + j ) ) <> ( - 1 );
A31: v3 in VG;
then 1 <= j by A7,A29,FINSEQ_1:1;
then 1 < j by A2,A28,A29,XXREAL_0:1;
then A32: ( 1 + 1 ) <= j by INT_1:7;
assume (not (ex p st (ex P st (((((p is_simple_vertex_seq_at h,j,n & (for m holds ((1 <= m & m < ( len p )) implies ( p . m ) in UV))) & P is_oriented_edge_seq_of p) & P is_shortestpath_of v1,v3,UV,W) & ( cost (P,W) ) = ( h . ( ( 2 * n ) + j ) )) & ((not v3 in UV) implies P islongestInShortestpath UV,v1,W)))));
j <= n by A7,A29,A31,FINSEQ_1:1;
hence contradiction by A1,A26,A30,A32,CKB93:def 1;
end;
thus (for m holds (for j holds (((((( h . ( n + j ) ) = ( - 1 ) & 1 <= j) & j <= n) & m in UV) & (not ( f . ( ( ( 2 * n ) + ( n * m ) ) + j ) ) = ( - 1 ))) implies contradiction))) by A5,A26,A8,A19,A18,CKB81:1;
let m;
assume A33: m in ( UsedVx (h,n) );
assume ( h . ( n + m ) ) = ( - 1 );
thus contradiction by A5,A26,A8,A19,A18,A33,CKB81:1;
end;
A34: (for k holds P[ k ]) from NAT_1:sch 1(A27,A21);
(ex ii being (Element of ( NAT )) st (ii <= n & ( OuterVx (( ( RM . ii ) . f ),n) ) = ( {} ))) by CKB71:1;
then A35: ( OuterVx (g,n) ) = ( {} ) by A9,CKB36:def 1;
A36:now
let v3;
let v4;
assume that
A37: v3 in Ug
and
A38: v4 in Vg;
v3 in VG;
then reconsider m = v3 as (Element of ( NAT ));
consider j such that A39: v4 = j and A40: j in ( dom g ) and A41: (1 <= j & j <= n) and A42: ( g . j ) <> ( - 1 ) by A38;
now
assume ( g . ( n + j ) ) <> ( - 1 );
then j in { k: ((((k in ( dom g ) & 1 <= k) & k <= n) & ( g . k ) <> ( - 1 )) & ( g . ( n + k ) ) <> ( - 1 )) } by A40,A41,A42;
hence contradiction by A35;
end;
then ( - 1 ) = ( f . ( ( ( 2 * n ) + ( n * m ) ) + j ) ) by A9,A34,A37,A41
.= ( Weight (v3,v4,W) ) by A1,A39,CKB93:def 1;
hence (not (ex e st (e in (the carrier' of G) & e orientedly_joins v3,v4))) by CKB41:1;
end;
A43: ( f . 1 ) = 1 by A1,A5,CKB93:def 1;
now
assume A44: cn = ( 0 );
1 in { k: ((((k in ( dom f ) & 1 <= k) & k <= n) & ( f . k ) <> ( - 1 )) & ( f . ( n + k ) ) <> ( - 1 )) } by A5,A43,A8,A18;
hence contradiction by A9,A26,A35,A44;
end;
then cn >= ( 1 + ( 0 ) ) by INT_1:7;
then A45: v1 in Ug by A2,A9,A20,CKB82:1;
hereby
assume v2 in Ug;
then ( g . ( n + i ) ) <> ( - 1 ) by A4,A9,A34;
then consider p,P such that A46: p is_simple_vertex_seq_at g,i,n and (for m holds ((1 <= m & m < ( len p )) implies ( p . m ) in Ug)) and A47: P is_oriented_edge_seq_of p and A48: P is_shortestpath_of v1,v2,Ug,W and A49: ( cost (P,W) ) = ( g . ( ( 2 * n ) + i ) ) and ((not v2 in Ug) implies P islongestInShortestpath Ug,v1,W) by A2,A3,A4,A9,A34;
take p;
take P;
thus p is_simple_vertex_seq_at g,i,n by A46;
thus P is_oriented_edge_seq_of p by A47;
thus P is_shortestpath_of v1,v2,W by A17,A36,A45,A48,CKB20:1;
thus ( cost (P,W) ) = ( g . ( ( 2 * n ) + i ) ) by A49;
end;
thus thesis by A17,A36,A45,CKB14:1;
end;
