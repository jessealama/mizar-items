environ
vocabularies NUMBERS,PRE_POLY,ARYTM_3,ARYTM_1,ORDINAL1,BAGORDER,XXREAL_0,RLVECT_1,ALGSTR_0,VECTSP_1,LATTICES,VECTSP_2,ZFMISC_1,VALUED_0,POLYNOM7,CAT_3,RELAT_2,POLYNOM1,BROUWER,SUPINF_2,XCMPLX_0,SUBSET_1,RELAT_1,FUNCT_1,XBOOLE_0,TARSKI,ALGSTR_1,CARD_1,FUNCT_7,QC_LANG1,TERMORD,BINOP_1,POLYRED,REWRITE1,FINSEQ_1,STRUCT_0,MCART_1,FINSET_1,FUNCT_4,FUNCOP_1,ALGSEQ_1,ORDERS_2,WAYBEL_4,RUSUB_4,GROEB_2,MESFUNC1,GROEB_1,GROEB_3;
notations TARSKI,SUBSET_1,RELAT_1,XBOOLE_0,RELAT_2,CARD_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,FUNCT_1,RELSET_1,FUNCT_2,FUNCT_4,FUNCOP_1,PRE_POLY,STRUCT_0,ALGSTR_0,GROUP_1,ALGSTR_1,RLVECT_1,VFUNCT_1,FINSET_1,MCART_1,FINSEQ_1,VECTSP_2,VECTSP_1,POLYNOM2,POLYNOM7,ORDERS_2,FUNCT_7,REWRITE1,BAGORDER,TERMORD,GROEB_1,POLYRED,GROEB_2,WAYBEL_4,POLYNOM1,CKB18,CKB19,CKB25,CKB26,CKB33,CKB34;
definitions TARSKI,STRUCT_0,CKB19,CKB25,CKB26,CKB33,CKB34;
theorems TARSKI,VECTSP_1,POLYNOM1,RLVECT_1,NAT_1,INT_1,POLYNOM7,REWRITE1,XBOOLE_0,TERMORD,CARD_1,FUNCT_1,XBOOLE_1,POLYRED,FUNCT_2,RELAT_1,BAGORDER,ALGSTR_1,CARD_2,GROEB_1,FUNCT_4,FUNCOP_1,FINSET_1,VECTSP_2,RELSET_1,WAYBEL_4,MCART_1,GROEB_2,GROUP_1,FUNCT_7,POLYNOM2,FINSEQ_3,XREAL_1,XXREAL_0,STRUCT_0,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB19,CKB20,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB51,CKB52,CKB53;
schemes FUNCT_2,NAT_1,INT_1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,FINSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,CARD_1,REWRITE1,STRUCT_0,VECTSP_1,ORDERS_2,ALGSTR_1,POLYNOM1,POLYNOM2,POLYNOM4,POLYNOM7,TERMORD,POLYRED,ORDINAL1,VALUED_0,ALGSTR_0,PRE_POLY,VFUNCT_1,FUNCT_2,RELSET_1,CKB17,CKB21,CKB48,CKB49,CKB50;
constructors XXREAL_0,REWRITE1,VECTSP_2,WAYBEL_4,POLYNOM2,BAGORDER,TERMORD,POLYRED,GROEB_1,GROEB_2,RELSET_1,PBOOLE,FUNCT_7,VFUNCT_1,CKB18,CKB19,CKB25,CKB26,CKB33,CKB34;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
theorem
Th40: (for n being Ordinal holds (for T being  connected  admissible (TermOrder of n) holds (for L being  add-associative  right_complementable  right_zeroed  well-unital  distributive  domRing-like non  trivial doubleLoopStr holds (for p being (Polynomial of n,L) holds (for m being  non-zero (Monomial of n,L) holds (for i being (Element of ( NAT )) holds (i <= ( card ( Support p ) ) implies (for b being (bag of n) holds (( ( term m ) + b ) in ( Support ( Low (( m *' p ),T,i) ) ) iff b in ( Support ( Low (p,T,i) ) ))))))))))
proof
let n being Ordinal;
let T being  connected  admissible (TermOrder of n);
let L being  add-associative  right_complementable  right_zeroed  well-unital  distributive  domRing-like non  trivial doubleLoopStr;
let p being (Polynomial of n,L);
let m being  non-zero (Monomial of n,L);
let i being (Element of ( NAT ));
set l = ( Low (p,T,i) );
assume A1: i <= ( card ( Support p ) );
then A2: ( Support l ) c= ( Support p ) by CKB37:1;
A3: ( Support ( Up (p,T,i) ) ) = ( Upper_Support (p,T,i) ) by A1,CKB35:1;
then A4: ( card ( Support ( Up (p,T,i) ) ) ) = i by A1,CKB25:def 1;
A5: ( Support ( Up (p,T,i) ) ) c= ( Support p ) by A1,CKB37:1;
A6: ( Support ( Low (p,T,i) ) ) = ( Lower_Support (p,T,i) ) by A1,CKB35:1;
let b being (bag of n);
A7: i <= ( card ( Support ( m *' p ) ) ) by A1,CKB10:1;
then A8: ( Support ( Low (( m *' p ),T,i) ) ) = ( Lower_Support (( m *' p ),T,i) ) by CKB35:1;
A9: ( Support ( Low (( m *' p ),T,i) ) ) c= ( Support ( m *' p ) ) by A7,CKB37:1;
A10: ( Support ( Up (( m *' p ),T,i) ) ) c= ( Support ( m *' p ) ) by A7,CKB37:1;
A11: ( Support ( Up (( m *' p ),T,i) ) ) = ( Upper_Support (( m *' p ),T,i) ) by A7,CKB35:1;
then A12: ( card ( Support ( Up (( m *' p ),T,i) ) ) ) = i by A7,CKB25:def 1;
then A13: (( Support ( Up (p,T,i) ) ) = ( {} ) implies ( Support ( Up (( m *' p ),T,i) ) ) = ( {} )) by A4;
A14:now
assume A15: ( ( term m ) + b ) in ( Support ( Low (( m *' p ),T,i) ) );
A16:now
assume ( ( term m ) + b ) in ( Support ( Up (( m *' p ),T,i) ) );
then ( ( term m ) + b ) in ( ( Support ( Up (( m *' p ),T,i) ) ) /\ ( Support ( Low (( m *' p ),T,i) ) ) ) by A15,XBOOLE_0:def 4;
hence contradiction by A7,A9,A15,CKB39:1;
end;
A17: ( Support ( m *' p ) ) = { ( ( term m ) + u ) where u is (Element of ( Bags n )): u in ( Support p ) } by CKB9:1;
A18:now
defpred P[ set,set ]
 means
$1 = ( ( term m ) + ( ( In ($2,( Bags n )) ) @ ) );
assume A19: b in ( Support ( Up (p,T,i) ) );
A20:now
let b9 being (bag of n);
assume A21: ( ( term m ) + b9 ) in ( Support ( Up (( m *' p ),T,i) ) );
then A22: ( ( term m ) + b ) < ( ( term m ) + b9 ),T by A7,A11,A8,A15,CKB28:1;
now
assume b9 <= b,T;
then ( ( term m ) + b9 ) <= ( ( term m ) + b ),T by CKB2:1;
hence contradiction by A22,TERMORD:5;
end;
then b < b9,T by TERMORD:5;
then A23: b <= b9,T by TERMORD:def 3;
b9 in ( Support p ) by A10,A21,CKB8:1;
hence b9 in ( Support ( Up (p,T,i) ) ) by A1,A3,A19,A23,CKB25:def 1;
end;
A24: (for x being set holds (x in ( Support ( Up (( m *' p ),T,i) ) ) implies (ex y being set st (y in ( Support ( Up (p,T,i) ) ) & P[ x,y ]))))
proof
let x being set;
assume A25: x in ( Support ( Up (( m *' p ),T,i) ) );
then x in ( Support ( m *' p ) ) by A10;
then consider x9 being (Element of ( Bags n )) such that A26: x = ( ( term m ) + x9 ) and x9 in ( Support p ) by A17;
take x9;
x9 = ( In (x9,( Bags n )) ) by FUNCT_7:def 1
.= ( ( In (x9,( Bags n )) ) @ ) by POLYNOM2:def 3;
hence thesis by A20,A25,A26;
end;
consider f being (Function of ( Support ( Up (( m *' p ),T,i) ) ),( Support ( Up (p,T,i) ) )) such that A27: (for x being set holds (x in ( Support ( Up (( m *' p ),T,i) ) ) implies P[ x,( f . x ) ])) from FUNCT_2:sch 1(A24);
now
let x1 being set;
let x2 being set;
assume that
A28: x1 in ( dom f )
and
A29: x2 in ( dom f )
and
A30: ( f . x1 ) = ( f . x2 );
( f . x2 ) in ( rng f ) by A29,FUNCT_1:3;
then A31: ( f . x2 ) in ( Support ( Up (p,T,i) ) );
( f . x1 ) in ( rng f ) by A28,FUNCT_1:3;
then ( f . x1 ) in ( Support ( Up (p,T,i) ) );
then reconsider x19 = ( f . x1 ),x29 = ( f . x2 ) as (Element of ( Bags n )) by A31;
A32: x19 = ( In (x19,( Bags n )) ) by FUNCT_7:def 1
.= ( ( In (x19,( Bags n )) ) @ ) by POLYNOM2:def 3;
x29 = ( In (x29,( Bags n )) ) by FUNCT_7:def 1
.= ( ( In (x29,( Bags n )) ) @ ) by POLYNOM2:def 3;
hence x1 = ( ( term m ) + x19 ) by A27,A28,A30
.= x2 by A27,A29,A30,A32;
end;
then A33: f is  one-to-one by FUNCT_1:def 4;
( Support ( Up (( m *' p ),T,i) ) ) c= ( dom f ) by A13,FUNCT_2:def 1;
then ( Support ( Up (( m *' p ),T,i) ) ),( f .: ( Support ( Up (( m *' p ),T,i) ) ) ) are_equipotent  by A33,CARD_1:33;
then ( card ( f .: ( Support ( Up (( m *' p ),T,i) ) ) ) ) = ( card ( Support ( Up (( m *' p ),T,i) ) ) ) by CARD_1:5
.= i by A7,A11,CKB25:def 1;
then b in ( f .: ( Support ( Up (( m *' p ),T,i) ) ) ) by A4,A19,PRE_POLY:8;
then consider bb being set such that A34: bb in ( dom f ) and A35: (bb in ( Support ( Up (( m *' p ),T,i) ) ) & ( f . bb ) = b) by FUNCT_1:def 6;
( f . bb ) in ( rng f ) by A34,FUNCT_1:3;
then ( f . bb ) in ( Support ( Up (p,T,i) ) );
then reconsider bb9 = ( f . bb ) as (Element of ( Bags n ));
bb9 = ( In (bb9,( Bags n )) ) by FUNCT_7:def 1
.= ( ( In (bb9,( Bags n )) ) @ ) by POLYNOM2:def 3;
hence contradiction by A16,A27,A35;
end;
( ( term m ) + b ) in ( Support ( m *' p ) ) by A9,A15;
then ( ( term m ) + b ) in { ( ( term m ) + u ) where u is (Element of ( Bags n )): u in ( Support p ) } by CKB9:1;
then consider u being (Element of ( Bags n )) such that A36: ( ( term m ) + b ) = ( ( term m ) + u ) and A37: u in ( Support p );
b = ( ( ( term m ) + b ) -' ( term m ) ) by PRE_POLY:48
.= u by A36,PRE_POLY:48;
hence b in ( Support ( Low (p,T,i) ) ) by A1,A37,A18,CKB39:1;
end;
A38: (( Support ( Up (( m *' p ),T,i) ) ) = ( {} ) implies ( Support ( Up (p,T,i) ) ) = ( {} )) by A12,A4;
now
assume A39: b in ( Support ( Low (p,T,i) ) );
A40:now
assume b in ( Support ( Up (p,T,i) ) );
then b in ( ( Support ( Up (p,T,i) ) ) /\ ( Support ( Low (p,T,i) ) ) ) by A39,XBOOLE_0:def 4;
hence contradiction by A1,A2,A39,CKB39:1;
end;
A41:now
defpred P[ set,set ]
 means
$2 = ( ( term m ) + ( ( In ($1,( Bags n )) ) @ ) );
assume A42: ( ( term m ) + b ) in ( Support ( Up (( m *' p ),T,i) ) );
A43:now
let b9 being (bag of n);
assume A44: b9 in ( Support ( Up (p,T,i) ) );
then ( ( term m ) + b ) < ( ( term m ) + b9 ),T by A1,A3,A6,A39,CKB4:1,CKB28:1;
then A45: ( ( term m ) + b ) <= ( ( term m ) + b9 ),T by TERMORD:def 3;
( ( term m ) + b9 ) in ( Support ( m *' p ) ) by A5,A44,CKB8:1;
hence ( ( term m ) + b9 ) in ( Support ( Up (( m *' p ),T,i) ) ) by A7,A11,A42,A45,CKB25:def 1;
end;
A46: (for x being set holds (x in ( Support ( Up (p,T,i) ) ) implies (ex y being set st (y in ( Support ( Up (( m *' p ),T,i) ) ) & P[ x,y ]))))
proof
let x being set;
assume A47: x in ( Support ( Up (p,T,i) ) );
then reconsider x9 = x as (Element of ( Bags n ));
take ( ( term m ) + x9 );
x9 = ( In (x9,( Bags n )) ) by FUNCT_7:def 1
.= ( ( In (x9,( Bags n )) ) @ ) by POLYNOM2:def 3;
hence thesis by A43,A47;
end;
consider f being (Function of ( Support ( Up (p,T,i) ) ),( Support ( Up (( m *' p ),T,i) ) )) such that A48: (for x being set holds (x in ( Support ( Up (p,T,i) ) ) implies P[ x,( f . x ) ])) from FUNCT_2:sch 1(A46);
now
let x1 being set;
let x2 being set;
assume that
A49: x1 in ( dom f )
and
A50: x2 in ( dom f )
and
A51: ( f . x1 ) = ( f . x2 );
(x1 in ( Support ( Up (p,T,i) ) ) & x2 in ( Support ( Up (p,T,i) ) )) by A49,A50;
then reconsider x = x1,y = x2 as (Element of ( Bags n ));
y = ( In (y,( Bags n )) ) by FUNCT_7:def 1
.= ( ( In (y,( Bags n )) ) @ ) by POLYNOM2:def 3;
then A52: ( f . y ) = ( ( term m ) + y ) by A48,A50;
x = ( In (x,( Bags n )) ) by FUNCT_7:def 1
.= ( ( In (x,( Bags n )) ) @ ) by POLYNOM2:def 3;
then A53: ( f . x ) = ( ( term m ) + x ) by A48,A49;
thus x1 = ( ( ( term m ) + x ) -' ( term m ) ) by PRE_POLY:48
.= x2 by A51,A53,A52,PRE_POLY:48;
end;
then A54: f is  one-to-one by FUNCT_1:def 4;
( Support ( Up (p,T,i) ) ) c= ( dom f ) by A38,FUNCT_2:def 1;
then ( Support ( Up (p,T,i) ) ),( f .: ( Support ( Up (p,T,i) ) ) ) are_equipotent  by A54,CARD_1:33;
then ( card ( f .: ( Support ( Up (p,T,i) ) ) ) ) = ( card ( Support ( Up (p,T,i) ) ) ) by CARD_1:5
.= i by A1,A3,CKB25:def 1;
then ( ( term m ) + b ) in ( f .: ( Support ( Up (p,T,i) ) ) ) by A12,A42,PRE_POLY:8;
then consider bb being set such that A55: bb in ( dom f ) and A56: bb in ( Support ( Up (p,T,i) ) ) and A57: ( f . bb ) = ( ( term m ) + b ) by FUNCT_1:def 6;
reconsider bb as (Element of ( Bags n )) by A56;
bb = ( In (bb,( Bags n )) ) by FUNCT_7:def 1
.= ( ( In (bb,( Bags n )) ) @ ) by POLYNOM2:def 3;
then A58: ( ( term m ) + bb ) = ( ( term m ) + b ) by A48,A55,A57;
bb = ( ( ( term m ) + bb ) -' ( term m ) ) by PRE_POLY:48
.= b by A58,PRE_POLY:48;
hence contradiction by A40,A55;
end;
( ( term m ) + b ) in ( Support ( m *' p ) ) by A2,A39,CKB8:1;
hence ( ( term m ) + b ) in ( Support ( Low (( m *' p ),T,i) ) ) by A7,A41,CKB39:1;
end;
hence thesis by A14;
end;
