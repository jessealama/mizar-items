environ
vocabularies NUMBERS,PRE_POLY,ARYTM_3,ARYTM_1,ORDINAL1,BAGORDER,XXREAL_0,RLVECT_1,ALGSTR_0,VECTSP_1,LATTICES,VECTSP_2,ZFMISC_1,VALUED_0,POLYNOM7,CAT_3,RELAT_2,POLYNOM1,BROUWER,SUPINF_2,XCMPLX_0,SUBSET_1,RELAT_1,FUNCT_1,XBOOLE_0,TARSKI,ALGSTR_1,CARD_1,FUNCT_7,QC_LANG1,TERMORD,BINOP_1,POLYRED,REWRITE1,FINSEQ_1,STRUCT_0,MCART_1,FINSET_1,FUNCT_4,FUNCOP_1,ALGSEQ_1,ORDERS_2,WAYBEL_4,RUSUB_4,GROEB_2,MESFUNC1,GROEB_1,GROEB_3;
notations TARSKI,SUBSET_1,RELAT_1,XBOOLE_0,RELAT_2,CARD_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,FUNCT_1,RELSET_1,FUNCT_2,FUNCT_4,FUNCOP_1,PRE_POLY,STRUCT_0,ALGSTR_0,GROUP_1,ALGSTR_1,RLVECT_1,VFUNCT_1,FINSET_1,MCART_1,FINSEQ_1,VECTSP_2,VECTSP_1,POLYNOM2,POLYNOM7,ORDERS_2,FUNCT_7,REWRITE1,BAGORDER,TERMORD,GROEB_1,POLYRED,GROEB_2,WAYBEL_4,POLYNOM1,CKB18,CKB19;
definitions TARSKI,STRUCT_0,CKB19;
theorems TARSKI,VECTSP_1,POLYNOM1,RLVECT_1,NAT_1,INT_1,POLYNOM7,REWRITE1,XBOOLE_0,TERMORD,CARD_1,FUNCT_1,XBOOLE_1,POLYRED,FUNCT_2,RELAT_1,BAGORDER,ALGSTR_1,CARD_2,GROEB_1,FUNCT_4,FUNCOP_1,FINSET_1,VECTSP_2,RELSET_1,WAYBEL_4,MCART_1,GROEB_2,GROUP_1,FUNCT_7,POLYNOM2,FINSEQ_3,XREAL_1,XXREAL_0,STRUCT_0,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB19,CKB20,CKB22,CKB23,CKB24;
schemes FUNCT_2,NAT_1,INT_1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,FINSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,CARD_1,REWRITE1,STRUCT_0,VECTSP_1,ORDERS_2,ALGSTR_1,POLYNOM1,POLYNOM2,POLYNOM4,POLYNOM7,TERMORD,POLYRED,ORDINAL1,VALUED_0,ALGSTR_0,PRE_POLY,VFUNCT_1,FUNCT_2,RELSET_1,CKB17,CKB21;
constructors XXREAL_0,REWRITE1,VECTSP_2,WAYBEL_4,POLYNOM2,BAGORDER,TERMORD,POLYRED,GROEB_1,GROEB_2,RELSET_1,PBOOLE,FUNCT_7,VFUNCT_1,CKB18,CKB19;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
definition
let n being Ordinal;
let T being  connected (TermOrder of n);
let L being  add-associative  right_zeroed  right_complementable non empty addLoopStr;
let p being (Polynomial of n,L);
let i being (Element of ( NAT ));
assume that
A1: i <= ( card ( Support p ) );
func Upper_Support (p,T,i) ->  finite (Subset of ( Bags n ))
means
:Def2: ((it c= ( Support p ) & ( card it ) = i) & (for b,b9 being (bag of n) holds (((b in it & b9 in ( Support p )) & b <= b9,T) implies b9 in it)));
existence
proof
defpred P[ (Element of ( NAT )) ]
 means
($1 > ( card ( Support p ) ) or (ex M being  finite (Subset of ( Bags n )) st ((M c= ( Support p ) & ( card M ) = $1) & (for b,b9 being (bag of n) holds (((b in M & b9 in ( Support p )) & b <= b9,T) implies b9 in M)))));
A2:now
let k being (Element of ( NAT ));
assume A3: P[ k ];
(( k + 1 ) > ( card ( Support p ) ) or (ex M being  finite (Subset of ( Bags n )) st ((M c= ( Support p ) & ( card M ) = ( k + 1 )) & (for b,b9 being (bag of n) holds (((b in M & b9 in ( Support p )) & b <= b9,T) implies b9 in M)))))
proof
set R = RelStr (# ( Bags n ),T #);
assume A4: (not ( k + 1 ) > ( card ( Support p ) ));
k <= ( k + 1 ) by NAT_1:11;
then consider M1 being  finite (Subset of ( Bags n )) such that A5: M1 c= ( Support p ) and A6: ( card M1 ) = k and A7: (for b,b9 being (bag of n) holds (((b in M1 & b9 in ( Support p )) & b <= b9,T) implies b9 in M1)) by A3,A4,XXREAL_0:2;
set G = ( ( Support p ) \ M1 );
now
let u being set;
assume u in G;
then u in ( Support p ) by XBOOLE_0:def 5;
hence u in ( Bags n );
end;
then reconsider G as (Subset of ( Bags n )) by TARSKI:def 3;
A8: (for u being set holds (u in M1 implies u in ( Support p ))) by A5;
now
assume G = ( {} );
then ( Support p ) c= M1 by XBOOLE_1:37;
then (for u being set holds (u in ( Support p ) implies u in M1));
then ( card ( Support p ) ) = k by A6,A8,TARSKI:1;
hence contradiction by A4,NAT_1:16;
end;
then reconsider G as non empty  finite (Subset of ( Bags n ));
consider x being (Element of R) such that A9: x in G and A10: x is_maximal_wrt G,(the InternalRel of R) by BAGORDER:6;
reconsider b = x as (bag of n);
set M = ( M1 \/ { b } );
now
let u being set;
assume u in { b };
then u = b by TARSKI:def 1;
hence u in ( Bags n );
end;
then { b } c= ( Bags n ) by TARSKI:def 3;
then M c= ( ( Bags n ) \/ ( Bags n ) ) by XBOOLE_1:13;
then reconsider M as  finite (Subset of ( Bags n ));
now
let u being set;
assume A11: u in M;
now
per cases  by A11,XBOOLE_0:def 3;
case u in M1;
hence u in ( Support p ) by A5;
end;
case u in { b };
then u in G by A9,TARSKI:def 1;
hence u in ( Support p ) by XBOOLE_0:def 5;
end;
end;
hence u in ( Support p );
end;
then A12: M c= ( Support p ) by TARSKI:def 3;
A13:now
let b9 being (bag of n);
assume A14: b9 in G;
now
per cases ;
case b9 = b;
hence b9 <= b,T by TERMORD:6;
end;
case b9 <> b;
then (not [ b,b9 ] in T) by A10,A14,WAYBEL_4:def 23;
then (not b <= b9,T) by TERMORD:def 2;
then b9 < b,T by TERMORD:5;
hence b9 <= b,T by TERMORD:def 3;
end;
end;
hence b9 <= b,T;
end;
A15:now
let b1 being (bag of n),b2 being (bag of n);
assume that
A16: b1 in M
and
A17: b2 in ( Support p )
and
A18: b1 <= b2,T;
now
per cases  by A16,XBOOLE_0:def 3;
case b1 in M1;
then b2 in M1 by A7,A17,A18;
hence b2 in M by XBOOLE_0:def 3;
end;
case b1 in { b };
then A19: b1 = b by TARSKI:def 1;
now
per cases ;
case b2 = b1;
hence b2 in M by A16;
end;
case b2 <> b1;
then A20: b1 < b2,T by A18,TERMORD:def 3;
now
assume b2 in G;
then b2 <= b1,T by A13,A19;
hence contradiction by A20,TERMORD:5;
end;
then b2 in M1 by A17,XBOOLE_0:def 5;
hence b2 in M by XBOOLE_0:def 3;
end;
end;
hence b2 in M;
end;
end;
hence b2 in M;
end;
(not b in M1) by A9,XBOOLE_0:def 5;
then ( card M ) = ( k + 1 ) by A6,CARD_2:41;
hence thesis by A12,A15;
end;
hence P[ ( k + 1 ) ];
end;
(ex M being  finite (Subset of ( Bags n )) st ((M c= ( Support p ) & ( card M ) = ( 0 )) & (for b,b9 being (bag of n) holds (((b in M & b9 in ( Support p )) & b <= b9,T) implies b9 in M))))
proof
set M = ( {} ( Bags n ) );
take M;
thus thesis by XBOOLE_1:2;
end;
then A21: P[ ( 0 ) ];
(for k being (Element of ( NAT )) holds P[ k ]) from NAT_1:sch 1(A21,A2);
hence thesis by A1;
end;
uniqueness
proof
let F1 being  finite (Subset of ( Bags n )),F2 being  finite (Subset of ( Bags n ));
assume that
A22: F1 c= ( Support p )
and
A23: ( card F1 ) = i
and
A24: (for b,b9 being (bag of n) holds (((b in F1 & b9 in ( Support p )) & b <= b9,T) implies b9 in F1));
assume that
A25: F2 c= ( Support p )
and
A26: ( card F2 ) = i
and
A27: (for b,b9 being (bag of n) holds (((b in F2 & b9 in ( Support p )) & b <= b9,T) implies b9 in F2));
now
let u being set;
assume A28: u in F1;
then reconsider u9 = u as (Element of ( Bags n ));
now
assume A29: (not u9 in F2);
now
let x being set;
assume A30: x in F2;
then reconsider x9 = x as (Element of ( Bags n ));
now
per cases ;
case u9 <= x9,T;
hence x9 in F1 by A24,A25,A28,A30;
end;
case (not u9 <= x9,T);
then x9 < u9,T by TERMORD:5;
then x9 <= u9,T by TERMORD:def 3;
hence x9 in F1 by A22,A27,A28,A29,A30;
end;
end;
hence x in F1;
end;
then F2 c= F1 by TARSKI:def 3;
then F2 c< F1 by A28,A29,XBOOLE_0:def 8;
hence contradiction by A23,A26,CARD_2:48;
end;
hence u in F2;
end;
then F1 c= F2 by TARSKI:def 3;
hence thesis by A23,A26,PRE_POLY:8;
end;
end;
