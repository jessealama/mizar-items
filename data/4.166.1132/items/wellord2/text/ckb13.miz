environ
vocabularies RELAT_1,ORDINAL1,TARSKI,RELAT_2,WELLORD1,XBOOLE_0,SUBSET_1,ZFMISC_1,FUNCT_1,MCART_1,WELLORD2;
notations TARSKI,XBOOLE_0,ZFMISC_1,MCART_1,SUBSET_1,RELAT_1,RELAT_2,FUNCT_1,WELLORD1,ORDINAL1,CKB1;
definitions TARSKI,XBOOLE_0,FUNCT_1,RELAT_1,RELAT_2,WELLORD1,CKB1;
theorems TARSKI,FUNCT_1,RELAT_1,RELAT_2,ZFMISC_1,WELLORD1,ORDINAL1,XBOOLE_0,XBOOLE_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12;
schemes FUNCT_1,RELAT_1,ORDINAL1,XBOOLE_0;
registrations RELAT_1,FUNCT_1,ORDINAL1;
constructors RELAT_2,ORDINAL1,WELLORD1,MCART_1,CKB1;
requirements SUBSET,BOOLE;
begin
reserve a for set;
reserve b for set;
reserve c for set;
reserve d for set;
reserve R for Relation;
reserve A for Ordinal;
reserve B for Ordinal;
reserve C for Ordinal;
reserve H for Function;
theorem
Th13: (for R holds ((R is  well-ordering & (for a holds (a in ( field R ) implies (ex A st ( R |_2 ( R -Seg a ) ),( RelIncl A ) are_isomorphic )))) implies (ex A st R,( RelIncl A ) are_isomorphic )))
proof
let R;
assume that
A1: R is  well-ordering;
defpred P[ set,set ]
 means
(for A holds (A = $2 iff ( R |_2 ( R -Seg $1 ) ),( RelIncl A ) are_isomorphic ));
assume A2: (for a holds (a in ( field R ) implies (ex A st ( R |_2 ( R -Seg a ) ),( RelIncl A ) are_isomorphic )));
A3: (for a holds (a in ( field R ) implies (ex b st P[ a,b ])))
proof
let a;
assume a in ( field R );
then consider A such that A4: ( R |_2 ( R -Seg a ) ),( RelIncl A ) are_isomorphic  by A2;
reconsider b = A as set;
take b;
let B;
thus (B = b implies ( R |_2 ( R -Seg a ) ),( RelIncl B ) are_isomorphic ) by A4;
assume ( R |_2 ( R -Seg a ) ),( RelIncl B ) are_isomorphic ;
hence thesis by A4,CKB12:1;
end;
A5: (for b holds (for c holds (for d holds (((b in ( field R ) & P[ b,c ]) & P[ b,d ]) implies c = d))))
proof
let b;
let c;
let d;
assume that
A6: b in ( field R )
and
A7: (A = c iff ( R |_2 ( R -Seg b ) ),( RelIncl A ) are_isomorphic )
and
A8: (B = d iff ( R |_2 ( R -Seg b ) ),( RelIncl B ) are_isomorphic );
consider A such that A9: ( R |_2 ( R -Seg b ) ),( RelIncl A ) are_isomorphic  by A2,A6;
A = c by A7,A9;
hence thesis by A8,A9;
end;
consider H such that A10: (( dom H ) = ( field R ) & (for b holds (b in ( field R ) implies P[ b,( H . b ) ]))) from FUNCT_1:sch 2(A5,A3);
(for a holds (a in ( rng H ) implies a is Ordinal))
proof
let b;
assume b in ( rng H );
then consider c such that A11: c in ( dom H ) and A12: b = ( H . c ) by FUNCT_1:def 3;
(ex A st ( R |_2 ( R -Seg c ) ),( RelIncl A ) are_isomorphic ) by A2,A10,A11;
hence thesis by A10,A11,A12;
end;
then consider C such that A13: ( rng H ) c= C by ORDINAL1:24;
A14:now
let b;
assume A15: b in ( rng H );
then consider b9 being set such that A16: b9 in ( dom H ) and A17: b = ( H . b9 ) by FUNCT_1:def 3;
set V = ( R -Seg b9 );
set P = ( R |_2 V );
consider A such that A18: P,( RelIncl A ) are_isomorphic  by A2,A10,A16;
let c;
assume that
A19: [ c,b ] in ( RelIncl C );
A20: A = b by A10,A16,A17,A18;
now
A21: C = ( field ( RelIncl C ) ) by CKB1:def 1;
then A22: c in C by A19,RELAT_1:15;
then reconsider B = c as Ordinal;
b in C by A19,A21,RELAT_1:15;
then A23: B c= A by A20,A19,A22,CKB1:def 1;
then A24: ( ( RelIncl A ) |_2 B ) = ( RelIncl B ) by CKB8:1;
assume c <> b;
then A25: B c< A by A20,A23,XBOOLE_0:def 8;
then A26: B = ( ( RelIncl A ) -Seg B ) by CKB10:1,ORDINAL1:11;
A27: A = ( field ( RelIncl A ) ) by CKB1:def 1;
A28: ( RelIncl A ) is  well-ordering by CKB7:1;
( RelIncl A ),P are_isomorphic  by A18,WELLORD1:40;
then ( canonical_isomorphism_of (( RelIncl A ),P) ) is_isomorphism_of ( RelIncl A ),P by A28,WELLORD1:def 9;
then consider d such that A29: d in ( field P ) and A30: ( ( RelIncl A ) |_2 ( ( RelIncl A ) -Seg B ) ),( P |_2 ( P -Seg d ) ) are_isomorphic  by A25,A27,A28,ORDINAL1:11,WELLORD1:50;
A31: d in ( field R ) by A29,WELLORD1:12;
A32: ( P -Seg d ) = ( R -Seg d ) by A1,A29,WELLORD1:12,WELLORD1:27;
d in V by A29,WELLORD1:12;
then [ d,b9 ] in R by WELLORD1:1;
then ( R -Seg d ) c= ( R -Seg b9 ) by A1,A10,A16,A31,WELLORD1:29;
then ( RelIncl B ),( R |_2 ( R -Seg d ) ) are_isomorphic  by A30,A26,A24,A32,WELLORD1:22;
then ( R |_2 ( R -Seg d ) ),( RelIncl B ) are_isomorphic  by WELLORD1:40;
then B = ( H . d ) by A10,A31;
hence c in ( rng H ) by A10,A31,FUNCT_1:def 3;
end;
hence c in ( rng H ) by A15;
end;
A33: ((ex a st (a in C & ( rng H ) = ( ( RelIncl C ) -Seg a ))) implies ( rng H ) is Ordinal) by CKB10:1;
(C = ( field ( RelIncl C ) ) & ( RelIncl C ) is  well-ordering) by CKB1:def 1,CKB7:1;
then reconsider A = ( rng H ) as Ordinal by A13,A14,A33,WELLORD1:28;
take A;
take H;
thus ( dom H ) = ( field R ) by A10;
thus ( rng H ) = ( field ( RelIncl A ) ) by CKB1:def 1;
A34: (a in ( dom H ) implies ( H . a ) is Ordinal)
proof
assume a in ( dom H );
then ( H . a ) in A by FUNCT_1:def 3;
hence thesis;
end;
thus A35: H is  one-to-one
proof
let a;
let b;
assume that
A36: a in ( dom H )
and
A37: b in ( dom H )
and
A38: ( H . a ) = ( H . b );
reconsider B = ( H . a ) as Ordinal by A34,A36;
( R |_2 ( R -Seg b ) ),( RelIncl B ) are_isomorphic  by A10,A37,A38;
then A39: ( RelIncl B ),( R |_2 ( R -Seg b ) ) are_isomorphic  by WELLORD1:40;
( R |_2 ( R -Seg a ) ),( RelIncl B ) are_isomorphic  by A10,A36;
then ( R |_2 ( R -Seg a ) ),( R |_2 ( R -Seg b ) ) are_isomorphic  by A39,WELLORD1:42;
hence thesis by A1,A10,A36,A37,WELLORD1:47;
end;

let a;
let b;
thus ([ a,b ] in R implies ((a in ( field R ) & b in ( field R )) & [ ( H . a ),( H . b ) ] in ( RelIncl A )))
proof
set Z = ( R -Seg b );
set P = ( R |_2 Z );
A40: (A = ( field ( RelIncl A ) ) & P is  well-ordering) by A1,CKB1:def 1,WELLORD1:25;
assume A41: [ a,b ] in R;
hence A42: (a in ( field R ) & b in ( field R )) by RELAT_1:15;
then reconsider A9 = ( H . a ),B9 = ( H . b ) as Ordinal by A10,A34;
A43: ( R |_2 ( R -Seg b ) ),( RelIncl B9 ) are_isomorphic  by A10,A42;
A44: A9 in A by A10,A42,FUNCT_1:def 3;
A45: B9 in A by A10,A42,FUNCT_1:def 3;
A46: ( R |_2 ( R -Seg a ) ),( RelIncl A9 ) are_isomorphic  by A10,A42;
now
assume a <> b;
then A47: a in Z by A41,WELLORD1:1;
then A48: ( P -Seg a ) = ( R -Seg a ) by A1,WELLORD1:27;
Z c= ( field R ) by WELLORD1:9;
then A49: a in ( field P ) by A1,A47,WELLORD1:31;
A9 c= A by A44,ORDINAL1:def 2;
then A50: ( ( RelIncl A ) |_2 A9 ) = ( RelIncl A9 ) by CKB8:1;
(A9 = ( ( RelIncl A ) -Seg A9 ) & ( R -Seg a ) c= ( R -Seg b )) by A1,A41,A42,A44,CKB10:1,WELLORD1:29;
then A51: ( P |_2 ( P -Seg a ) ),( ( RelIncl A ) |_2 ( ( RelIncl A ) -Seg A9 ) ) are_isomorphic  by A46,A50,A48,WELLORD1:22;
(B9 = ( ( RelIncl A ) -Seg B9 ) & B9 c= A) by A45,CKB10:1,ORDINAL1:def 2;
then A52: P,( ( RelIncl A ) |_2 ( ( RelIncl A ) -Seg B9 ) ) are_isomorphic  by A43,CKB8:1;
( RelIncl A ) is  well-ordering by CKB7:1;
hence [ A9,B9 ] in ( RelIncl A ) by A44,A45,A40,A49,A52,A51,WELLORD1:51;
end;
hence thesis by A44,CKB1:def 1;
end;

assume that
A53: a in ( field R )
and
A54: b in ( field R )
and
A55: [ ( H . a ),( H . b ) ] in ( RelIncl A );
assume A56: (not [ a,b ] in R);
R is  reflexive by A1,WELLORD1:def 4;
then R is_reflexive_in ( field R ) by RELAT_2:def 9;
then A57: a <> b by A53,A56,RELAT_2:def 1;
R is  connected by A1,WELLORD1:def 4;
then R is_connected_in ( field R ) by RELAT_2:def 14;
then A58: [ b,a ] in R by A53,A54,A56,A57,RELAT_2:def 6;
then A59: ( R -Seg b ) c= ( R -Seg a ) by A1,A53,A54,WELLORD1:29;
( RelIncl A ) is  antisymmetric by CKB5:1;
then A60: ( RelIncl A ) is_antisymmetric_in ( field ( RelIncl A ) ) by RELAT_2:def 12;
A61: A = ( field ( RelIncl A ) ) by CKB1:def 1;
reconsider A9 = ( H . a ),B9 = ( H . b ) as Ordinal by A10,A34,A53,A54;
A62: ( R |_2 ( R -Seg a ) ),( RelIncl A9 ) are_isomorphic  by A10,A53;
A63: ( R |_2 ( R -Seg b ) ),( RelIncl B9 ) are_isomorphic  by A10,A54;
A64: B9 in A by A10,A54,FUNCT_1:def 3;
then B9 c= A by ORDINAL1:def 2;
then A65: ( ( RelIncl A ) |_2 B9 ) = ( RelIncl B9 ) by CKB8:1;
set Z = ( R -Seg a );
set P = ( R |_2 Z );
A66: ( RelIncl A ) is  well-ordering by CKB7:1;
A67: A9 in A by A10,A53,FUNCT_1:def 3;
then (A9 = ( ( RelIncl A ) -Seg A9 ) & A9 c= A) by CKB10:1,ORDINAL1:def 2;
then A68: P,( ( RelIncl A ) |_2 ( ( RelIncl A ) -Seg A9 ) ) are_isomorphic  by A62,CKB8:1;
A69: b in Z by A56,A58,WELLORD1:1;
then A70: ( P -Seg b ) = ( R -Seg b ) by A1,WELLORD1:27;
B9 = ( ( RelIncl A ) -Seg B9 ) by A64,CKB10:1;
then A71: ( P |_2 ( P -Seg b ) ),( ( RelIncl A ) |_2 ( ( RelIncl A ) -Seg B9 ) ) are_isomorphic  by A63,A65,A70,A59,WELLORD1:22;
Z c= ( field R ) by WELLORD1:9;
then A72: b in ( field P ) by A1,A69,WELLORD1:31;
P is  well-ordering by A1,WELLORD1:25;
then [ B9,A9 ] in ( RelIncl A ) by A72,A66,A67,A64,A61,A68,A71,WELLORD1:51;
then ( H . a ) = ( H . b ) by A55,A60,A67,A64,A61,RELAT_2:def 4;
hence contradiction by A10,A35,A53,A54,A57,FUNCT_1:def 4;
end;
