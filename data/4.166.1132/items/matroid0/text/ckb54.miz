environ
vocabularies NUMBERS,TARSKI,PRE_TOPC,SUBSET_1,BVFUNC_2,RCOMP_1,SETFAM_1,CLASSES1,FINSET_1,CARD_1,ARYTM_3,XBOOLE_0,STRUCT_0,ZFMISC_1,LEXBFS,NAT_1,XXREAL_0,TAXONOM2,AOFA_000,ORDERS_1,FUNCT_1,RELAT_1,NATTRA_1,EQREL_1,VECTSP_1,RLVECT_3,CARD_3,RLVECT_2,SUPINF_2,REALSET1,ARYTM_1,RLVECT_5,JORDAN13,MATROID0;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,DOMAIN_1,SETFAM_1,FINSET_1,NUMBERS,FUNCT_1,RELSET_1,FUNCT_2,EQREL_1,ORDERS_1,TAXONOM2,XCMPLX_0,XXREAL_0,NAT_1,CARD_1,CLASSES1,LEXBFS,AOFA_000,STRUCT_0,RLVECT_1,VECTSP_1,VECTSP_6,VECTSP_7,PRE_TOPC,TDLAT_3,MATRLIN,PENCIL_1,RANKNULL,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB14,CKB22,CKB23,CKB24,CKB25,CKB33,CKB44,CKB51;
definitions TARSKI,FUNCT_1,CLASSES1,TAXONOM2,XBOOLE_0,STRUCT_0,LEXBFS,PENCIL_1,CKB5,CKB6,CKB7,CKB8,CKB23,CKB24,CKB25,CKB33,CKB44,CKB51;
theorems PENCIL_1,TARSKI,XBOOLE_1,ZFMISC_1,CARD_1,COH_SP,PRE_TOPC,NAT_1,CLASSES1,TDLAT_3,XXREAL_0,XREAL_1,XBOOLE_0,TAXONOM2,ORDERS_1,FUNCT_2,FUNCT_1,EQREL_1,WELLORD2,VECTSP_7,VECTSP_9,MATRLIN,STRUCT_0,CARD_FIN,CARD_2,VECTSP_4,ORDINAL1,CARD_FIL,RANKNULL,VECTSP_1,VECTSP_6,ALGSTR_0,SETWISEO,HALLMAR1,BORSUK_5,CKB5,CKB6,CKB7,CKB8,CKB12,CKB15,CKB17,CKB21,CKB23,CKB24,CKB25,CKB29,CKB30,CKB32,CKB33,CKB35,CKB37,CKB38,CKB44,CKB46,CKB47,CKB48,CKB51,CKB52,CKB53;
schemes FUNCT_2,NAT_1;
registrations FINSET_1,XBOOLE_0,CARD_1,RELSET_1,STRUCT_0,SUBSET_1,PENCIL_1,TDLAT_3,SETFAM_1,EQREL_1,MATRLIN,XREAL_0,MEMBERED,ALGSTR_0,BINOM,RLVECT_1,VECTSP_1,VECTSP_7,CKB9,CKB10,CKB11,CKB13,CKB16,CKB18,CKB19,CKB20,CKB26,CKB27,CKB28,CKB31,CKB34,CKB36,CKB39,CKB40,CKB41,CKB42,CKB43,CKB45,CKB49,CKB50;
constructors PCOMPS_1,EQREL_1,COH_SP,TDLAT_3,TAXONOM2,LEXBFS,RANKNULL,VECTSP_7,PENCIL_1,REALSET1,RELSET_1,CKB5,CKB7,CKB8,CKB24,CKB25,CKB33,CKB44,CKB51;
requirements BOOLE,SUBSET,NUMERALS,ARITHM,REAL;
begin
theorem
Th16: (for M being non empty non void  subset-closed  finite-degree SubsetFamilyStr holds (M is Matroid iff (for C being (Subset of M) holds (for A,B being  independent (Subset of M) holds ((A is_maximal_independent_in C & B is_maximal_independent_in C) implies ( card A ) = ( card B ))))))
proof
let M being non empty non void  subset-closed  finite-degree SubsetFamilyStr;
hereby
assume A1: M is Matroid;
let C being (Subset of M);
A2:now
let A being  independent (Subset of M),B being  independent (Subset of M);
assume that
A3: A is_maximal_independent_in C
and
A4: B is_maximal_independent_in C
and
A5: ( card A ) < ( card B );
A6: A c= C by A3,CKB51:def 1;
( ( card A ) + 1 ) <= ( card B ) by A5,NAT_1:13;
then ( ( card A ) + 1 ) c= ( card B ) by NAT_1:39;
then consider D being set such that A7: D c= B and A8: ( card D ) = ( ( card A ) + 1 ) by CARD_FIL:36;
reconsider D as  finite (Subset of M) by A7,XBOOLE_1:1;
D is  independent by A7,CKB17:1;
then consider e being (Element of M) such that A9: e in ( D \ A ) and A10: ( A \/ { e } ) is  independent by A1,A8,CKB21:1;
( D \ A ) c= D by XBOOLE_1:36;
then A11: ( D \ A ) c= B by A7,XBOOLE_1:1;
B c= C by A4,CKB51:def 1;
then ( D \ A ) c= C by A11,XBOOLE_1:1;
then { e } c= C by A9,ZFMISC_1:31;
then A12: ( A \/ { e } ) c= C by A6,XBOOLE_1:8;
A c= ( A \/ { e } ) by XBOOLE_1:7;
then ( A \/ { e } ) = A by A3,A10,A12,CKB51:def 1;
then { e } c= A by XBOOLE_1:7;
then e in A by ZFMISC_1:31;
hence contradiction by A9,XBOOLE_0:def 5;
end;
let A being  independent (Subset of M),B being  independent (Subset of M);
assume that
A13: A is_maximal_independent_in C
and
A14: B is_maximal_independent_in C;
((( card A ) < ( card B ) or ( card B ) < ( card A )) or ( card A ) = ( card B )) by XXREAL_0:1;
hence ( card A ) = ( card B ) by A2,A13,A14;
end;
assume A15: (for C being (Subset of M) holds (for A,B being  independent (Subset of M) holds ((A is_maximal_independent_in C & B is_maximal_independent_in C) implies ( card A ) = ( card B ))));
M is  with_exchange_property
proof
let A being  finite (Subset of M),B being  finite (Subset of M);
reconsider C = ( A \/ B ) as (Subset of M);
assume that
A16: A in ( the_family_of M )
and
A17: B in ( the_family_of M )
and
A18: ( card B ) = ( ( card A ) + 1 );
B is  independent by A17,CKB6:def 1;
then consider B9 being  independent (Subset of M) such that A19: B c= B9 and A20: B9 is_maximal_independent_in C by CKB52:1,XBOOLE_1:7;
A21: ( card B ) <= ( card B9 ) by A19,NAT_1:43;
assume A22: (for e being (Element of M) holds (e in ( B \ A ) implies (not ( A \/ { e } ) in ( the_family_of M ))));
reconsider A as  independent (Subset of M) by A16,CKB6:def 1;
A is_maximal_independent_in C
proof
thus A in ( the_family_of M ) by A16;
thus A c= C by XBOOLE_1:7;
let D being (Subset of M);
assume that
A23: D is  independent
and
A24: D c= C
and
A25: A c= D;
assume (not (A c= D & D c= A));
then consider e being set such that A26: e in D and A27: (not e in A) by A25,TARSKI:def 3;
reconsider e as (Element of M) by A26;
e in B by A24,A26,A27,XBOOLE_0:def 3;
then e in ( B \ A ) by A27,XBOOLE_0:def 5;
then (not ( A \/ { e } ) in ( the_family_of M )) by A22;
then A28: (not ( A \/ { e } ) is  independent) by CKB6:def 1;
{ e } c= D by A26,ZFMISC_1:31;
then ( A \/ { e } ) c= D by A25,XBOOLE_1:8;
hence contradiction by A23,A28,CKB17:1;
end;
then ( card A ) = ( card B9 ) by A15,A20;
hence contradiction by A18,A21,NAT_1:13;
end;
hence thesis;
end;
