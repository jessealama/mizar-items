environ
vocabularies NUMBERS,RCOMP_1,SUBSET_1,REAL_1,COMPLEX1,NEWTON,ARYTM_3,RELAT_1,CARD_1,PARTFUN1,XREAL_0,ORDINAL1,SEQ_1,TAYLOR_1,XXREAL_1,ARYTM_1,TARSKI,FDIFF_1,FUNCT_1,SERIES_1,REALSET1,XBOOLE_0,SIN_COS,XXREAL_0,VALUED_0,VALUED_1,SEQ_2,ORDINAL2,CARD_3,ABIAN,TAYLOR_2;
notations TARSKI,SUBSET_1,RELAT_1,PARTFUN1,RFUNCT_2,RCOMP_1,XXREAL_0,XREAL_0,ORDINAL1,NUMBERS,COMPLEX1,REAL_1,NAT_1,FUNCT_2,VALUED_1,SEQ_1,SEQ_2,SERIES_1,FDIFF_1,SEQFUNC,NEWTON,SIN_COS,TAYLOR_1,ABIAN,CKB2;
definitions TAYLOR_1,VALUED_1,SUBSET_1,CKB2;
theorems XBOOLE_1,ABSVALUE,PARTFUN1,XCMPLX_1,RELAT_1,RCOMP_1,SEQ_1,SEQ_2,SIN_COS,SERIES_1,FUNCT_1,RFUNCT_2,NAT_1,NEWTON,POWER,FDIFF_1,FDIFF_2,TAYLOR_1,SIN_COS2,XREAL_1,RFUNCT_1,ABIAN,COMPLEX1,XXREAL_0,VALUED_1,FUNCT_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23;
schemes NAT_1;
registrations RELSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,RCOMP_1,XBOOLE_0,VALUED_0,VALUED_1,FUNCT_2;
constructors ARYTM_0,REAL_1,NAT_1,SEQ_2,RCOMP_1,RFUNCT_2,LIMFUNC1,FDIFF_1,COMSEQ_3,SIN_COS,ABIAN,TAYLOR_1,SEQ_1,SEQFUNC,SERIES_1,VALUED_1,RELSET_1,CKB2;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
theorem
Th22: (for r being Real holds (r > ( 0 ) implies (ex r1,r2 being Real st ((r1 >= ( 0 ) & r2 >= ( 0 )) & (for n being (Element of ( NAT )) holds (for x,s being Real holds (((x in ]. ( - r ),r .[ & ( 0 ) < s) & s < 1) implies (( abs ( ( ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) <= ( ( r1 * ( r2 |^ n ) ) / ( n ! ) ) & ( abs ( ( ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) <= ( ( r1 * ( r2 |^ n ) ) / ( n ! ) )))))))))
proof
let r being Real;
assume that
A1: r > ( 0 );
take r1 = 1;
take r2 = r;
now
let n being (Element of ( NAT ));
let x being Real;
let s being Real;
assume that
A2: x in ]. ( - r ),r .[
and
A3: s > ( 0 )
and
A4: s < 1;
x in ]. ( ( 0 ) - r ),( ( 0 ) + r ) .[ by A2;
then A5: ( abs ( x - ( 0 ) ) ) < r by RCOMP_1:1;
A6: ( ( ( abs x ) |^ n ) / ( n ! ) ) <= ( ( r2 |^ n ) / ( n ! ) )
proof
defpred P[ (Element of ( NAT )) ]
 means
( ( ( abs x ) |^ $1 ) / ( $1 ! ) ) <= ( ( r2 |^ $1 ) / ( $1 ! ) );
A7: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume that
A8: P[ k ];
A9: ( ( ( abs x ) |^ ( k + 1 ) ) / ( ( k + 1 ) ! ) ) = ( ( ( ( abs x ) |^ k ) * ( abs x ) ) / ( ( k + 1 ) ! ) ) by NEWTON:6
.= ( ( ( ( abs x ) |^ k ) * ( abs x ) ) / ( ( k ! ) * ( k + 1 ) ) ) by NEWTON:15
.= ( ( ( abs x ) |^ k ) * ( ( abs x ) / ( ( k ! ) * ( k + 1 ) ) ) ) by XCMPLX_1:74
.= ( ( ( abs x ) |^ k ) * ( ( ( abs x ) / ( k ! ) ) / ( k + 1 ) ) ) by XCMPLX_1:78
.= ( ( ( abs x ) |^ k ) * ( ( 1 / ( ( k ! ) / ( abs x ) ) ) / ( k + 1 ) ) ) by XCMPLX_1:57
.= ( ( ( abs x ) |^ k ) * ( ( ( 1 / ( k ! ) ) * ( abs x ) ) / ( k + 1 ) ) ) by XCMPLX_1:82
.= ( ( ( ( abs x ) |^ k ) * ( ( 1 / ( k ! ) ) * ( abs x ) ) ) / ( k + 1 ) ) by XCMPLX_1:74
.= ( ( ( ( ( abs x ) |^ k ) * ( 1 / ( k ! ) ) ) * ( abs x ) ) / ( k + 1 ) )
.= ( ( ( ( ( ( abs x ) |^ k ) * 1 ) / ( k ! ) ) * ( abs x ) ) / ( k + 1 ) ) by XCMPLX_1:74
.= ( ( ( ( ( abs x ) |^ k ) / ( k ! ) ) * ( abs x ) ) / ( k + 1 ) );
A10: ( k ! ) > ( 0 ) by NEWTON:17;
( ( ( abs x ) |^ k ) / ( k ! ) ) = ( ( abs ( x |^ k ) ) / ( k ! ) ) by CKB1:1
.= ( ( abs ( x |^ k ) ) / ( abs ( k ! ) ) ) by A10,ABSVALUE:def 1
.= ( abs ( ( x |^ k ) / ( k ! ) ) ) by COMPLEX1:67;
then A11: ( ( ( abs x ) |^ k ) / ( k ! ) ) >= ( 0 ) by COMPLEX1:46;
A12: ( ( r2 |^ ( k + 1 ) ) / ( ( k + 1 ) ! ) ) = ( ( ( r2 |^ k ) * r2 ) / ( ( k + 1 ) ! ) ) by NEWTON:6
.= ( ( ( r2 |^ k ) * r2 ) / ( ( k ! ) * ( k + 1 ) ) ) by NEWTON:15
.= ( ( r2 |^ k ) * ( r2 / ( ( k ! ) * ( k + 1 ) ) ) ) by XCMPLX_1:74
.= ( ( r2 |^ k ) * ( ( r2 / ( k ! ) ) / ( k + 1 ) ) ) by XCMPLX_1:78
.= ( ( r2 |^ k ) * ( ( 1 / ( ( k ! ) / r2 ) ) / ( k + 1 ) ) ) by XCMPLX_1:57
.= ( ( r2 |^ k ) * ( ( ( 1 / ( k ! ) ) * r2 ) / ( k + 1 ) ) ) by XCMPLX_1:82
.= ( ( ( r2 |^ k ) * ( ( 1 / ( k ! ) ) * r2 ) ) / ( k + 1 ) ) by XCMPLX_1:74
.= ( ( ( ( r2 |^ k ) * ( 1 / ( k ! ) ) ) * r2 ) / ( k + 1 ) )
.= ( ( ( ( ( r2 |^ k ) * 1 ) / ( k ! ) ) * r2 ) / ( k + 1 ) ) by XCMPLX_1:74
.= ( ( ( ( r2 |^ k ) / ( k ! ) ) * r2 ) / ( k + 1 ) );
( abs x ) >= ( 0 ) by COMPLEX1:46;
then ( ( ( ( abs x ) |^ k ) / ( k ! ) ) * ( abs x ) ) <= ( ( ( r2 |^ k ) / ( k ! ) ) * r2 ) by A5,A8,A11,XREAL_1:66;
hence thesis by A9,A12,XREAL_1:72;
end;
( ( ( abs x ) |^ ( 0 ) ) / ( ( 0 ) ! ) ) = ( 1 / ( ( 0 ) ! ) ) by NEWTON:4
.= ( ( r2 |^ ( 0 ) ) / ( ( 0 ) ! ) ) by NEWTON:4;
then A13: P[ ( 0 ) ];
(for i being (Element of ( NAT )) holds P[ i ]) from NAT_1:sch 1(A13,A7);
hence thesis;
end;
( abs x ) >= ( 0 ) by COMPLEX1:46;
then ( s * ( abs x ) ) < ( 1 * r ) by A3,A4,A5,XREAL_1:97;
then ( ( abs s ) * ( abs x ) ) < r by A3,ABSVALUE:def 1;
then ( abs ( ( s * x ) - ( 0 ) ) ) < r by COMPLEX1:65;
then A14: ( s * x ) in ]. ( ( 0 ) - r ),( ( 0 ) + r ) .[ by RCOMP_1:1;
A15: (for k being (Element of ( NAT )) holds ( abs ( ( - 1 ) |^ k ) ) = 1)
proof
let k being (Element of ( NAT ));
per cases ;
suppose k is  even;

then consider j being (Element of ( NAT )) such that A16: k = ( 2 * j ) by ABIAN:def 2;
thus ( abs ( ( - 1 ) |^ k ) ) = ( abs ( ( ( - 1 ) |^ ( 1 + 1 ) ) |^ j ) ) by A16,NEWTON:9
.= ( abs ( ( ( ( - 1 ) |^ 1 ) * ( - 1 ) ) |^ j ) ) by NEWTON:6
.= ( abs ( ( ( - 1 ) * ( - 1 ) ) |^ j ) ) by NEWTON:5
.= ( abs 1 ) by NEWTON:10
.= 1 by ABSVALUE:def 1;
end;
suppose k is  odd;

then consider j being (Element of ( NAT )) such that A17: k = ( ( 2 * j ) + 1 ) by ABIAN:9;
thus ( abs ( ( - 1 ) |^ k ) ) = ( abs ( ( ( - 1 ) |^ ( 2 * j ) ) * ( - 1 ) ) ) by A17,NEWTON:6
.= ( abs ( ( ( ( - 1 ) |^ ( 1 + 1 ) ) |^ j ) * ( - 1 ) ) ) by NEWTON:9
.= ( abs ( ( ( ( ( - 1 ) |^ 1 ) * ( - 1 ) ) |^ j ) * ( - 1 ) ) ) by NEWTON:6
.= ( abs ( ( ( ( - 1 ) * ( - 1 ) ) |^ j ) * ( - 1 ) ) ) by NEWTON:5
.= ( abs ( 1 * ( - 1 ) ) ) by NEWTON:10
.= ( abs 1 ) by COMPLEX1:52
.= 1 by ABSVALUE:def 1;
end;
end;
A18: ( abs ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) <= r1
proof
per cases ;
suppose n is  even;

then consider k being (Element of ( NAT )) such that A19: n = ( 2 * k ) by ABIAN:def 2;
A20: ( dom ( ( ( - 1 ) |^ k ) (#) ( ( sin ) | ]. ( - r ),r .[ ) ) ) = ( dom ( ( sin ) | ]. ( - r ),r .[ ) ) by VALUED_1:def 5
.= ]. ( - r ),r .[ by CKB19:1;
A21: ( s * x ) in ( dom ( ( sin ) | ]. ( - r ),r .[ ) ) by A14,CKB19:1;
A22: ( abs ( sin ( s * x ) ) ) <= 1 by SIN_COS:27;
( abs ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) = ( abs ( ( ( ( - 1 ) |^ k ) (#) ( ( sin ) | ]. ( - r ),r .[ ) ) . ( s * x ) ) ) by A19,CKB21:1
.= ( abs ( ( ( - 1 ) |^ k ) * ( ( ( sin ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by A14,A20,VALUED_1:def 5
.= ( ( abs ( ( - 1 ) |^ k ) ) * ( abs ( ( ( sin ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by COMPLEX1:65
.= ( 1 * ( abs ( ( ( sin ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by A15
.= ( abs ( ( sin ) . ( s * x ) ) ) by A21,FUNCT_1:47;
hence thesis by A22,SIN_COS:def 17;
end;
suppose n is  odd;

then consider k being (Element of ( NAT )) such that A23: n = ( ( 2 * k ) + 1 ) by ABIAN:9;
A24: ( dom ( ( ( - 1 ) |^ k ) (#) ( ( cos ) | ]. ( - r ),r .[ ) ) ) = ( dom ( ( cos ) | ]. ( - r ),r .[ ) ) by VALUED_1:def 5
.= ]. ( - r ),r .[ by CKB19:1;
A25: ( s * x ) in ( dom ( ( cos ) | ]. ( - r ),r .[ ) ) by A14,CKB19:1;
A26: ( abs ( cos ( s * x ) ) ) <= 1 by SIN_COS:27;
( abs ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) = ( abs ( ( ( ( - 1 ) |^ k ) (#) ( ( cos ) | ]. ( - r ),r .[ ) ) . ( s * x ) ) ) by A23,CKB21:1
.= ( abs ( ( ( - 1 ) |^ k ) * ( ( ( cos ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by A14,A24,VALUED_1:def 5
.= ( ( abs ( ( - 1 ) |^ k ) ) * ( abs ( ( ( cos ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by COMPLEX1:65
.= ( 1 * ( abs ( ( ( cos ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by A15
.= ( abs ( ( cos ) . ( s * x ) ) ) by A25,FUNCT_1:47;
hence thesis by A26,SIN_COS:def 19;
end;
end;
A27: ( abs ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) <= r1
proof
per cases ;
suppose n is  even;

then consider k being (Element of ( NAT )) such that A28: n = ( 2 * k ) by ABIAN:def 2;
A29: ( dom ( ( ( - 1 ) |^ k ) (#) ( ( cos ) | ]. ( - r ),r .[ ) ) ) = ( dom ( ( cos ) | ]. ( - r ),r .[ ) ) by VALUED_1:def 5
.= ]. ( - r ),r .[ by CKB19:1;
A30: ( s * x ) in ( dom ( ( cos ) | ]. ( - r ),r .[ ) ) by A14,CKB19:1;
A31: ( abs ( cos ( s * x ) ) ) <= 1 by SIN_COS:27;
( abs ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) = ( abs ( ( ( ( - 1 ) |^ k ) (#) ( ( cos ) | ]. ( - r ),r .[ ) ) . ( s * x ) ) ) by A28,CKB21:1
.= ( abs ( ( ( - 1 ) |^ k ) * ( ( ( cos ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by A14,A29,VALUED_1:def 5
.= ( ( abs ( ( - 1 ) |^ k ) ) * ( abs ( ( ( cos ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by COMPLEX1:65
.= ( 1 * ( abs ( ( ( cos ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by A15
.= ( abs ( ( cos ) . ( s * x ) ) ) by A30,FUNCT_1:47;
hence thesis by A31,SIN_COS:def 19;
end;
suppose n is  odd;

then consider k being (Element of ( NAT )) such that A32: n = ( ( 2 * k ) + 1 ) by ABIAN:9;
A33: ( dom ( ( ( - 1 ) |^ ( k + 1 ) ) (#) ( ( sin ) | ]. ( - r ),r .[ ) ) ) = ( dom ( ( sin ) | ]. ( - r ),r .[ ) ) by VALUED_1:def 5
.= ]. ( - r ),r .[ by CKB19:1;
A34: ( s * x ) in ( dom ( ( sin ) | ]. ( - r ),r .[ ) ) by A14,CKB19:1;
A35: ( abs ( sin ( s * x ) ) ) <= 1 by SIN_COS:27;
( abs ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) = ( abs ( ( ( ( - 1 ) |^ ( k + 1 ) ) (#) ( ( sin ) | ]. ( - r ),r .[ ) ) . ( s * x ) ) ) by A32,CKB21:1
.= ( abs ( ( ( - 1 ) |^ ( k + 1 ) ) * ( ( ( sin ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by A14,A33,VALUED_1:def 5
.= ( ( abs ( ( - 1 ) |^ ( k + 1 ) ) ) * ( abs ( ( ( sin ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by COMPLEX1:65
.= ( 1 * ( abs ( ( ( sin ) | ]. ( - r ),r .[ ) . ( s * x ) ) ) ) by A15
.= ( abs ( ( sin ) . ( s * x ) ) ) by A34,FUNCT_1:47;
hence thesis by A35,SIN_COS:def 17;
end;
end;
A36: ( n ! ) > ( 0 ) by NEWTON:17;
A37: ( abs ( ( x |^ n ) / ( n ! ) ) ) = ( ( abs ( x |^ n ) ) / ( abs ( n ! ) ) ) by COMPLEX1:67
.= ( ( abs ( x |^ n ) ) / ( n ! ) ) by A36,ABSVALUE:def 1
.= ( ( ( abs x ) |^ n ) / ( n ! ) ) by CKB1:1;
then A38: ( ( ( abs x ) |^ n ) / ( n ! ) ) >= ( 0 ) by COMPLEX1:46;
A39: ( abs ( ( ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) = ( abs ( ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( ( x |^ n ) / ( n ! ) ) ) ) by XCMPLX_1:74
.= ( ( abs ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) * ( abs ( ( x |^ n ) / ( n ! ) ) ) ) by COMPLEX1:65
.= ( ( ( abs ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) * ( ( abs x ) |^ n ) ) / ( n ! ) ) by A37,XCMPLX_1:74;
A40: ( abs ( ( ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) = ( abs ( ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( ( x |^ n ) / ( n ! ) ) ) ) by XCMPLX_1:74
.= ( ( abs ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) * ( abs ( ( x |^ n ) / ( n ! ) ) ) ) by COMPLEX1:65
.= ( ( ( abs ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) * ( ( abs x ) |^ n ) ) / ( n ! ) ) by A37,XCMPLX_1:74;
( abs ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) >= ( 0 ) by COMPLEX1:46;
then A41: ( ( abs ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) * ( ( ( abs x ) |^ n ) / ( n ! ) ) ) <= ( r1 * ( ( r2 |^ n ) / ( n ! ) ) ) by A38,A27,A6,XREAL_1:66;
( abs ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) >= ( 0 ) by COMPLEX1:46;
then ( ( abs ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) ) * ( ( ( abs x ) |^ n ) / ( n ! ) ) ) <= ( r1 * ( ( r2 |^ n ) / ( n ! ) ) ) by A38,A18,A6,XREAL_1:66;
hence (( abs ( ( ( ( ( diff (( sin ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) <= ( ( r1 * ( r2 |^ n ) ) / ( n ! ) ) & ( abs ( ( ( ( ( diff (( cos ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) <= ( ( r1 * ( r2 |^ n ) ) / ( n ! ) )) by A40,A39,A41,XCMPLX_1:74;
end;
hence thesis by A1;
end;
