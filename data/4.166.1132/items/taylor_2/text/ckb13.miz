environ
vocabularies NUMBERS,RCOMP_1,SUBSET_1,REAL_1,COMPLEX1,NEWTON,ARYTM_3,RELAT_1,CARD_1,PARTFUN1,XREAL_0,ORDINAL1,SEQ_1,TAYLOR_1,XXREAL_1,ARYTM_1,TARSKI,FDIFF_1,FUNCT_1,SERIES_1,REALSET1,XBOOLE_0,SIN_COS,XXREAL_0,VALUED_0,VALUED_1,SEQ_2,ORDINAL2,CARD_3,ABIAN,TAYLOR_2;
notations TARSKI,SUBSET_1,RELAT_1,PARTFUN1,RFUNCT_2,RCOMP_1,XXREAL_0,XREAL_0,ORDINAL1,NUMBERS,COMPLEX1,REAL_1,NAT_1,FUNCT_2,VALUED_1,SEQ_1,SEQ_2,SERIES_1,FDIFF_1,SEQFUNC,NEWTON,SIN_COS,TAYLOR_1,ABIAN,CKB2;
definitions TAYLOR_1,VALUED_1,SUBSET_1,CKB2;
theorems XBOOLE_1,ABSVALUE,PARTFUN1,XCMPLX_1,RELAT_1,RCOMP_1,SEQ_1,SEQ_2,SIN_COS,SERIES_1,FUNCT_1,RFUNCT_2,NAT_1,NEWTON,POWER,FDIFF_1,FDIFF_2,TAYLOR_1,SIN_COS2,XREAL_1,RFUNCT_1,ABIAN,COMPLEX1,XXREAL_0,VALUED_1,FUNCT_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12;
schemes NAT_1;
registrations RELSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,RCOMP_1,XBOOLE_0,VALUED_0,VALUED_1,FUNCT_2;
constructors ARYTM_0,REAL_1,NAT_1,SEQ_2,RCOMP_1,RFUNCT_2,LIMFUNC1,FDIFF_1,COMSEQ_3,SIN_COS,ABIAN,TAYLOR_1,SEQ_1,SEQFUNC,SERIES_1,VALUED_1,RELSET_1,CKB2;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
theorem
Th11: (for r being Real holds (( 0 ) < r implies (ex M,L being Real st ((( 0 ) <= M & ( 0 ) <= L) & (for n being (Element of ( NAT )) holds (for x,s being Real holds (((x in ]. ( - r ),r .[ & ( 0 ) < s) & s < 1) implies ( abs ( ( ( ( ( diff (( exp_R ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) <= ( ( M * ( L |^ n ) ) / ( n ! ) ))))))))
proof
let r being Real;
assume that
A1: r > ( 0 );
take M = ( ( exp_R ) . r );
take L = r;
now
let n being (Element of ( NAT ));
now
A2: (for a,b being Real holds ((( 0 ) <= a & a <= b) implies (for n being (Element of ( NAT )) holds (( 0 ) <= ( a |^ n ) & ( a |^ n ) <= ( b |^ n )))))
proof
let a being Real;
let b being Real;
assume that
A3: ( 0 ) <= a
and
A4: a <= b;
defpred P[ (Element of ( NAT )) ]
 means
(( 0 ) <= ( a |^ $1 ) & ( a |^ $1 ) <= ( b |^ $1 ));
A5: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume that
A6: P[ k ];
( ( 0 ) * a ) <= ( ( a |^ k ) * a ) by A3,A6;
hence ( a |^ ( k + 1 ) ) >= ( 0 ) by NEWTON:6;
(( b |^ ( k + 1 ) ) = ( ( b |^ k ) * b ) & ( ( a |^ k ) * a ) <= ( ( b |^ k ) * b )) by A3,A4,A6,NEWTON:6,XREAL_1:66;
hence thesis by NEWTON:6;
end;
( b |^ ( 0 ) ) = 1 by NEWTON:4;
then A7: P[ ( 0 ) ] by NEWTON:4;
(for n being (Element of ( NAT )) holds P[ n ]) from NAT_1:sch 1(A7,A5);
hence thesis;
end;
let x being Real;
let s being Real;
assume that
A8: x in ]. ( - r ),r .[
and
A9: ( 0 ) < s
and
A10: s < 1;
x in ]. ( ( 0 ) - r ),( ( 0 ) + r ) .[ by A8;
then A11: ( abs ( x - ( 0 ) ) ) < r by RCOMP_1:1;
( abs x ) >= ( 0 ) by COMPLEX1:46;
then A12: ( ( abs x ) |^ n ) <= ( L |^ n ) by A11,A2;
A13: ( n ! ) > ( 0 ) by NEWTON:17;
( abs x ) >= ( 0 ) by COMPLEX1:46;
then ( s * ( abs x ) ) < ( 1 * r ) by A9,A10,A11,XREAL_1:97;
then ( ( abs s ) * ( abs x ) ) < r by A9,ABSVALUE:def 1;
then ( abs ( ( s * x ) - ( 0 ) ) ) < r by COMPLEX1:65;
then A14: ( s * x ) in ]. ( ( 0 ) - r ),( ( 0 ) + r ) .[ by RCOMP_1:1;
then A15: ( abs ( ( ( ( ( diff (( exp_R ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) = ( abs ( ( ( ( exp_R ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) by CKB9:1
.= ( abs ( ( ( exp_R ) . ( s * x ) ) * ( ( x |^ n ) / ( n ! ) ) ) ) by XCMPLX_1:74
.= ( ( abs ( ( exp_R ) . ( s * x ) ) ) * ( abs ( ( x |^ n ) / ( n ! ) ) ) ) by COMPLEX1:65;
( ( exp_R ) . ( s * x ) ) >= ( 0 ) by SIN_COS:54;
then A16: (r in ( ( [#] ( REAL ) ) /\ ( dom ( exp_R ) ) ) & ( abs ( ( exp_R ) . ( s * x ) ) ) = ( ( exp_R ) . ( s * x ) )) by ABSVALUE:def 1,TAYLOR_1:16;
(for x0 being Real holds ( 0 ) <= ( diff (( exp_R ),x0) )) by TAYLOR_1:16;
then A17: ( ( exp_R ) | ( [#] ( REAL ) ) ) is  non-decreasing by FDIFF_2:39,TAYLOR_1:16;
( abs ( ( x |^ n ) / ( n ! ) ) ) = ( ( abs ( x |^ n ) ) / ( abs ( n ! ) ) ) by COMPLEX1:67
.= ( ( abs ( x |^ n ) ) / ( n ! ) ) by A13,ABSVALUE:def 1
.= ( ( ( abs x ) |^ n ) / ( n ! ) ) by CKB1:1;
then A18: ( abs ( ( x |^ n ) / ( n ! ) ) ) <= ( ( L |^ n ) / ( n ! ) ) by A13,A12,XREAL_1:72;
A19: (( abs ( ( exp_R ) . ( s * x ) ) ) >= ( 0 ) & ( abs ( ( x |^ n ) / ( n ! ) ) ) >= ( 0 )) by COMPLEX1:46;
( s * x ) in { p where p is Real: (( - r ) < p & p < r) } by A14,RCOMP_1:def 2;
then (ex g being Real st ((g = ( s * x ) & ( - r ) < g) & g < r));
then ( abs ( ( exp_R ) . ( s * x ) ) ) <= M by A17,A16,RFUNCT_2:24,TAYLOR_1:16;
then ( abs ( ( ( ( ( diff (( exp_R ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) <= ( M * ( ( L |^ n ) / ( n ! ) ) ) by A19,A18,A15,XREAL_1:66;
hence ( abs ( ( ( ( ( diff (( exp_R ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) <= ( ( M * ( L |^ n ) ) / ( n ! ) ) by XCMPLX_1:74;
end;
hence (for x,s being Real holds (((x in ]. ( - r ),r .[ & ( 0 ) < s) & s < 1) implies ( abs ( ( ( ( ( diff (( exp_R ),]. ( - r ),r .[) ) . n ) . ( s * x ) ) * ( x |^ n ) ) / ( n ! ) ) ) <= ( ( M * ( L |^ n ) ) / ( n ! ) )));
end;
hence thesis by A1,SIN_COS:54;
end;
