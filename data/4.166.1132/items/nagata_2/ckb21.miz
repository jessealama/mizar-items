environ
vocabularies NUMBERS,SUBSET_1,REAL_1,XREAL_0,ORDINAL1,XBOOLE_0,PRE_TOPC,ZFMISC_1,STRUCT_0,FUNCT_1,PSCOMP_1,SEQFUNC,SEQ_1,XXREAL_0,CARD_1,NEWTON,RELAT_1,ARYTM_3,INT_1,NAT_1,ARYTM_1,FUNCT_7,FUNCT_2,TARSKI,METRIC_1,RCOMP_1,MCART_1,SETFAM_1,ORDINAL2,TOPMETR,TMAP_1,SEQ_4,NAGATA_1,XXREAL_2,COMPLEX1,RELAT_2,VALUED_0,PCOMPS_1,PBOOLE,SERIES_1,CARD_3,VALUED_1,SEQ_2,FINSEQ_1,PREPOWER,BINOP_1,SETWISEO,FINSOP_1,ORDINAL4,CARD_5,RLVECT_3,FINSET_1,COH_SP,PARTFUN1,WELLORD1,PCOMPS_2,NATTRA_1,NAGATA_2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,SETWISEO,BORSUK_1,RELAT_1,RELAT_2,ORDINAL1,XCMPLX_0,XXREAL_0,XXREAL_2,XREAL_0,FUNCT_1,COMPLEX1,REAL_1,RELSET_1,PARTFUN1,VALUED_0,VALUED_1,SEQ_1,FUNCT_2,FUNCT_3,DOMAIN_1,BINOP_1,PRE_TOPC,NAT_1,NAT_D,CARD_1,NUMBERS,FINSET_1,STRUCT_0,FINSEQ_1,PCOMPS_1,PCOMPS_2,NEWTON,TOPS_2,METRIC_1,PROB_1,SEQFUNC,PREPOWER,TOPMETR,PSCOMP_1,MEASURE6,TMAP_1,NAGATA_1,SEQ_2,SEQ_4,SERIES_1,FINSOP_1,CANTOR_1,WELLORD1,FUNCT_7,CKB2,CKB4,CKB7;
definitions FUNCT_2,TARSKI,TOPS_2,XBOOLE_0,BINOP_1,SUBSET_1,STRUCT_0,PRE_TOPC,XXREAL_2,CKB2,CKB4,CKB7;
theorems NAT_1,NEWTON,FUNCT_2,PCOMPS_1,PCOMPS_2,NAGATA_1,SUBSET_1,METRIC_6,FUNCT_3,FUNCT_1,METRIC_1,XCMPLX_1,ABSVALUE,TOPMETR,TMAP_1,BORSUK_1,XBOOLE_1,TARSKI,SETFAM_1,XBOOLE_0,TOPS_1,TOPS_2,PRE_TOPC,FINSEQ_1,CARD_4,TOPREAL6,ZFMISC_1,BINOP_1,SEQ_2,SEQ_4,SEQ_1,SERIES_1,PREPOWER,SEQFUNC,PARTFUN1,JGRAPH_2,URYSOHN1,FINSEQ_3,FINSEQ_4,FINSOP_1,SETWISEO,PROB_1,URYSOHN3,WELLORD1,WELLORD2,TBSP_1,RELAT_1,RELAT_2,YELLOW_9,FUNCT_7,RSSPACE2,RSSPACE,BHSP_5,XREAL_1,COMPLEX1,XXREAL_0,ORDINAL1,NAT_D,VALUED_1,XXREAL_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20;
schemes FUNCT_2,NAT_1,SEQFUNC,FRAENKEL,BINOP_1,PCOMPS_2;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,FINSEQ_1,STRUCT_0,TOPS_1,METRIC_1,BORSUK_1,TOPMETR,MEASURE6,TOPREAL6,VALUED_0,VALUED_1,FUNCT_2,BORSUK_4,BORSUK_6,CARD_1,PRE_TOPC,FUNCT_1,PSCOMP_1;
constructors SETFAM_1,WELLORD1,FUNCT_3,SETWISEO,REAL_1,SQUARE_1,NAT_1,NAT_D,SEQM_3,PROB_1,FINSOP_1,NEWTON,PREPOWER,SERIES_1,FUNCT_7,TOPS_2,COMPTS_1,TMAP_1,CANTOR_1,PCOMPS_2,MEASURE6,URYSOHN3,NAGATA_1,SEQ_1,BORSUK_4,XXREAL_2,SEQFUNC,SEQ_4,BINOP_2,SEQ_2,RVSUM_1,PSCOMP_1,PCOMPS_1,CKB2,CKB4,CKB7;
requirements BOOLE,SUBSET,NUMERALS,REAL,ARITHM;
begin
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve s for Real;
reserve rn for  real number;
reserve x for set;
reserve y for set;
reserve T for non empty TopSpace;
reserve p for (Point of T);
reserve q for (Point of T);
reserve A9 for non empty (Subset of T);
reserve pq for (Element of [: (the carrier of T),(the carrier of T) :]);
reserve pmet for (Function of [: (the carrier of T),(the carrier of T) :],( REAL ));
reserve pmet1 for (Function of [: (the carrier of T),(the carrier of T) :],( REAL ));
reserve pmet9 for (RealMap of [: T,T :]);
reserve pmet19 for (RealMap of [: T,T :]);
reserve FS2 for (Functional_Sequence of [: (the carrier of T),(the carrier of T) :],( REAL ));
theorem
Th17: (for T holds (T is  T_1 implies (for s holds (for FS2 holds (((for n holds (ex pmet st (((( FS2 . n ) = pmet & pmet is_a_pseudometric_of (the carrier of T)) & (for pq holds ( pmet . pq ) <= s)) & (for pmet9 holds (pmet = pmet9 implies pmet9 is  continuous))))) & (for p holds (for A9 holds (((not p in A9) & A9 is  closed) implies (ex n st (for pmet holds (( FS2 . n ) = pmet implies ( ( lower_bound (pmet,A9) ) . p ) > ( 0 )))))))) implies ((ex pmet st (pmet is_metric_of (the carrier of T) & (for pq holds ( pmet . pq ) = ( Sum ( ( ( 1 / 2 ) GeoSeq ) (#) ( FS2 # pq ) ) )))) & T is  metrizable))))))
proof
let T;
assume that
A1: T is  T_1;
set cT = (the carrier of T);
set Geo = ( ( 1 / 2 ) GeoSeq );
let s;
let FS2;
assume that
A2: (for n holds (ex pmet st (((( FS2 . n ) = pmet & pmet is_a_pseudometric_of (the carrier of T)) & (for pq holds ( pmet . pq ) <= s)) & (for pmet9 holds (pmet = pmet9 implies pmet9 is  continuous)))))
and
A3: (for p holds (for A9 holds (((not p in A9) & A9 is  closed) implies (ex n st (for pmet holds (( FS2 . n ) = pmet implies ( ( lower_bound (pmet,A9) ) . p ) > ( 0 )))))));
deffunc pm((Element of cT),(Element of cT)) = ( Sum ( Geo (#) ( FS2 # [ $1,$2 ] ) ) );
consider pmet such that A4: (for p holds (for q holds ( pmet . (p,q) ) = pm(p,q))) from BINOP_1:sch 4;
A5: (for pq holds ( pmet . pq ) = ( Sum ( Geo (#) ( FS2 # pq ) ) ))
proof
let pq;
consider p being set,q being set such that A6: (p in cT & q in cT) and A7: pq = [ p,q ] by ZFMISC_1:def 2;
( pmet . pq ) = ( pmet . (p,q) ) by A7;
hence thesis by A4,A6,A7;
end;
A8: (for pq holds (for n holds (( 0 ) <= ( ( Geo (#) ( FS2 # pq ) ) . n ) & ( ( Geo (#) ( FS2 # pq ) ) . n ) <= ( ( s (#) Geo ) . n ))))
proof
let pq;
let n;
consider x,y such that A9: (x in cT & y in cT) and A10: [ x,y ] = pq by ZFMISC_1:def 2;
reconsider x,y as (Point of T) by A9;
A11: ( ( Geo . n ) * s ) = ( ( s (#) Geo ) . n ) by SEQ_1:9;
( ( 1 / 2 ) |^ n ) > ( 0 ) by NEWTON:83;
then A12: ( Geo . n ) > ( 0 ) by PREPOWER:def 1;
consider pmet1 such that A13: ( FS2 . n ) = pmet1 and A14: pmet1 is_a_pseudometric_of cT and A15: (for pq holds ( pmet1 . pq ) <= s) and (for pmet19 holds (pmet1 = pmet19 implies pmet19 is  continuous)) by A2;
A16: ( 0 ) <= ( pmet1 . (x,y) ) by A14,NAGATA_1:29;
A17: ( pmet1 . pq ) = ( ( FS2 # pq ) . n ) by A13,SEQFUNC:def 10;
then ( ( Geo . n ) * ( ( FS2 # pq ) . n ) ) <= ( ( Geo . n ) * s ) by A15,A12,XREAL_1:64;
hence thesis by A10,A16,A12,A17,A11,SEQ_1:8;
end;
A18: (for p holds (for q holds (( pmet . (p,q) ) = ( 0 ) implies p = q)))
proof
let p;
let q;
assume that
A19: ( pmet . (p,q) ) = ( 0 )
and
A20: p <> q;
set Q = { q };
A21: (not p in Q) by A20,TARSKI:def 1;
set pq = [ p,q ];
A22: ( Sum ( Geo (#) ( FS2 # pq ) ) ) = ( 0 ) by A5,A19;
A23: (for n holds (( 0 ) <= ( ( Geo (#) ( FS2 # pq ) ) . n ) & ( ( Geo (#) ( FS2 # pq ) ) . n ) <= ( ( s (#) Geo ) . n ))) by A8;
Q is  closed by A1,URYSOHN1:19;
then consider n such that A24: (for pmet1 holds (( FS2 . n ) = pmet1 implies ( ( lower_bound (pmet1,Q) ) . p ) > ( 0 ))) by A3,A21;
consider pmet1 such that A25: ( FS2 . n ) = pmet1 and A26: pmet1 is_a_pseudometric_of cT and (for pq holds ( pmet1 . pq ) <= s) and (for pmet19 holds (pmet1 = pmet19 implies pmet19 is  continuous)) by A2;
( ( lower_bound (pmet1,Q) ) . p ) > ( 0 ) by A24,A25;
then A27: ( lower_bound ( ( dist (pmet1,p) ) .: Q ) ) > ( 0 ) by CKB7:def 1;
( 1 / 2 ) < 1;
then ( abs ( 1 / 2 ) ) < 1 by ABSVALUE:def 1;
then Geo is  summable by SERIES_1:24;
then ( s (#) Geo ) is  summable by SERIES_1:10;
then ( Geo (#) ( FS2 # pq ) ) is  summable by A23,SERIES_1:20;
then ( ( Geo (#) ( FS2 # pq ) ) . n ) = ( 0 ) by A23,A22,RSSPACE:17;
then A28: ( ( Geo . n ) * ( ( FS2 # pq ) . n ) ) = ( 0 ) by SEQ_1:8;
( ( 1 / 2 ) |^ n ) > ( 0 ) by NEWTON:83;
then ( Geo . n ) <> ( 0 ) by PREPOWER:def 1;
then A29: ( ( FS2 # pq ) . n ) = ( 0 ) by A28,XCMPLX_1:6;
A30: ( pmet1 . (p,q) ) = ( ( dist (pmet1,p) ) . q ) by CKB4:def 1;
(( dom ( dist (pmet1,p) ) ) = cT & q in Q) by FUNCT_2:def 1,TARSKI:def 1;
then A31: ( ( dist (pmet1,p) ) . q ) in ( ( dist (pmet1,p) ) .: Q ) by FUNCT_1:def 6;
( ( dist (pmet1,p) ) .: Q ) is non empty  bounded_below by A26,CKB8:1;
then ( ( dist (pmet1,p) ) . q ) > ( 0 ) by A31,A27,SEQ_4:def 2;
hence thesis by A25,A29,A30,SEQFUNC:def 10;
end;
pmet is_a_pseudometric_of cT by A2,A5,CKB19:1;
then pmet is  Reflexive  discerning  symmetric  triangle by A18,METRIC_1:def 3,NAGATA_1:def 10;
then A32: pmet is_metric_of cT by METRIC_6:3;
hence (ex pmet st (pmet is_metric_of (the carrier of T) & (for pq holds ( pmet . pq ) = ( Sum ( ( ( 1 / 2 ) GeoSeq ) (#) ( FS2 # pq ) ) )))) by A5;
(for A being non empty (Subset of T) holds ( Cl A ) = { p where p is (Point of T): ( ( lower_bound (pmet,A) ) . p ) = ( 0 ) })
proof
let A being non empty (Subset of T);
set INF = { p where p is (Point of T): ( ( lower_bound (pmet,A) ) . p ) = ( 0 ) };
A33: INF c= ( Cl A )
proof
let x;
assume x in INF;
then consider p being (Point of T) such that A34: x = p and A35: ( ( lower_bound (pmet,A) ) . p ) = ( 0 );
A36: ( lower_bound ( ( dist (pmet,p) ) .: A ) ) = ( 0 ) by A35,CKB7:def 1;
pmet is_a_pseudometric_of cT by A2,A5,CKB19:1;
then A37: ( ( dist (pmet,p) ) .: A ) is non empty  bounded_below by CKB8:1;
A38: (A c= ( Cl A ) & (ex y st y in A)) by PRE_TOPC:18,XBOOLE_0:def 1;
A39: A c= ( Cl A ) by PRE_TOPC:18;
assume (not x in ( Cl A ));
then consider n such that A40: (for pmet1 holds (( FS2 . n ) = pmet1 implies ( ( lower_bound (pmet1,( Cl A )) ) . p ) > ( 0 ))) by A3,A34,A38;
( ( 1 / 2 ) |^ n ) > ( 0 ) by NEWTON:83;
then A41: ( Geo . n ) > ( 0 ) by PREPOWER:def 1;
( ( 1 / 2 ) |^ n ) > ( 0 ) by NEWTON:83;
then A42: ( Geo . n ) > ( 0 ) by PREPOWER:def 1;
consider pmet1 such that A43: ( FS2 . n ) = pmet1 and A44: pmet1 is_a_pseudometric_of cT and (for pq holds ( pmet1 . pq ) <= s) and (for pmet19 holds (pmet1 = pmet19 implies pmet19 is  continuous)) by A2;
set r = ( ( Geo . n ) * ( ( lower_bound (pmet1,( Cl A )) ) . p ) );
A45: ( lower_bound ( ( dist (pmet1,p) ) .: ( Cl A ) ) ) = ( ( lower_bound (pmet1,( Cl A )) ) . p ) by CKB7:def 1;
A46: ( ( lower_bound (pmet1,( Cl A )) ) . p ) > ( 0 ) by A40,A43;
then r > ( 0 ) by A41,XREAL_1:129;
then ( r / 2 ) > ( 0 ) by XREAL_1:215;
then consider rn such that A47: rn in ( ( dist (pmet,p) ) .: A ) and A48: rn < ( ( lower_bound ( ( dist (pmet,p) ) .: A ) ) + ( r / 2 ) ) by A37,SEQ_4:def 2;
consider a being set such that A49: a in ( dom ( dist (pmet,p) ) ) and A50: a in A and A51: rn = ( ( dist (pmet,p) ) . a ) by A47,FUNCT_1:def 6;
reconsider a as (Point of T) by A49;
reconsider pa = [ p,a ] as (Element of [: cT,cT :]);
A52: ( ( dist (pmet1,p) ) . a ) = ( pmet1 . (p,a) ) by CKB4:def 1;
( dom ( dist (pmet1,p) ) ) = cT by FUNCT_2:def 1;
then A53: ( ( dist (pmet1,p) ) . a ) in ( ( dist (pmet1,p) ) .: ( Cl A ) ) by A50,A39,FUNCT_1:def 6;
( ( dist (pmet1,p) ) .: ( Cl A ) ) is non empty  bounded_below by A44,A50,A39,CKB8:1;
then ( ( lower_bound (pmet1,( Cl A )) ) . p ) <= ( ( dist (pmet1,p) ) . a ) by A53,A45,SEQ_4:def 2;
then ( ( lower_bound (pmet1,( Cl A )) ) . p ) <= ( ( FS2 # pa ) . n ) by A43,A52,SEQFUNC:def 10;
then r <= ( ( Geo . n ) * ( ( FS2 # pa ) . n ) ) by A42,XREAL_1:64;
then A54: r <= ( ( Geo (#) ( FS2 # pa ) ) . n ) by SEQ_1:8;
A55: (for k holds (( 0 ) <= ( ( Geo (#) ( FS2 # pa ) ) . k ) & ( ( Geo (#) ( FS2 # pa ) ) . k ) <= ( ( s (#) Geo ) . k ))) by A8;
( pmet . pa ) = ( pmet . (p,a) );
then A56: rn = ( pmet . pa ) by A51,CKB4:def 1;
( 1 / 2 ) < 1;
then ( abs ( 1 / 2 ) ) < 1 by ABSVALUE:def 1;
then Geo is  summable by SERIES_1:24;
then ( s (#) Geo ) is  summable by SERIES_1:10;
then ( Geo (#) ( FS2 # pa ) ) is  summable by A55,SERIES_1:20;
then ( ( Geo (#) ( FS2 # pa ) ) . n ) <= ( Sum ( Geo (#) ( FS2 # pa ) ) ) by A55,RSSPACE2:3;
then rn >= ( ( Geo (#) ( FS2 # pa ) ) . n ) by A5,A56;
then ( ( Geo (#) ( FS2 # pa ) ) . n ) < ( r / 2 ) by A48,A36,XXREAL_0:2;
then r < ( r / 2 ) by A54,XXREAL_0:2;
hence thesis by A41,A46,XREAL_1:129,XREAL_1:216;
end;
( Cl A ) c= INF
proof
let x;
assume A57: x in ( Cl A );
then reconsider p = x as (Point of T);
(pmet is_a_pseudometric_of cT & (for pmet9 holds (pmet = pmet9 implies pmet9 is  continuous))) by A2,A5,CKB19:1;
then ( ( lower_bound (pmet,A) ) . p ) = ( 0 ) by A57,CKB20:1;
hence thesis;
end;
hence thesis by A33,XBOOLE_0:def 10;
end;
hence thesis by A32,CKB14:1;
end;
