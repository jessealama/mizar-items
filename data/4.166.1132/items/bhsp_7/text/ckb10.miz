environ
vocabularies NUMBERS,BHSP_1,PRE_TOPC,REAL_1,COMPLEX1,ARYTM_1,ARYTM_3,XXREAL_0,XREAL_0,ORDINAL1,CARD_1,SUBSET_1,RELAT_1,HAHNBAN,BHSP_6,FINSET_1,XBOOLE_0,TARSKI,BHSP_5,STRUCT_0,BINOP_2,FUNCT_1,ZFMISC_1,NAT_1,SEQ_2,ALGSTR_0,BINOP_1,SETWISEO,PROB_2,FINSEQ_1,FINSOP_1,SQUARE_1,NORMSP_1,SEMI_AF1,SUPINF_2,RSSPACE2;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,NUMBERS,XREAL_0,BINOP_2,STRUCT_0,ALGSTR_0,COMPLEX1,REAL_1,NAT_1,FUNCT_1,FUNCT_2,RELAT_1,PRE_TOPC,BHSP_1,SQUARE_1,SEQ_2,BINOP_1,FINSET_1,SETWISEO,HAHNBAN,FINSEQ_1,FINSOP_1,BHSP_5,BHSP_6,RSSPACE2,PARTFUN1,XXREAL_0;
definitions TARSKI,SQUARE_1,RLVECT_1;
theorems XBOOLE_1,SQUARE_1,ZFMISC_1,XREAL_0,ABSVALUE,FUNCT_1,NAT_1,FUNCT_2,RLVECT_1,SEQ_2,SEQ_4,BHSP_1,BHSP_5,BHSP_6,UNIFORM1,CHAIN_1,XCMPLX_1,BINOP_2,XREAL_1,COMPLEX1,XXREAL_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9;
schemes NAT_1,FUNCT_2;
registrations XBOOLE_0,FUNCT_1,ORDINAL1,RELSET_1,FUNCT_2,FINSET_1,NUMBERS,XREAL_0,BINOP_2,MEMBERED,STRUCT_0,BHSP_5;
constructors BINOP_1,DOMAIN_1,SETWISEO,REAL_1,SQUARE_1,BINOP_2,COMPLEX1,SEQ_2,FINSOP_1,BHSP_3,BHSP_5,BHSP_6,SEQ_1,SUPINF_1,RELSET_1;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve X for RealUnitarySpace;
theorem
Th7: (for S being (Subset of X) holds (S is  summable_set implies (for e being Real holds (( 0 ) < e implies (ex Y0 being  finite (Subset of X) st ((Y0 is non  empty & Y0 c= S) & (for Y1 being  finite (Subset of X) holds ((Y0 c= Y1 & Y1 c= S) implies ( abs ( ( ( sum S ) .|. ( sum S ) ) - ( ( setsum Y1 ) .|. ( setsum Y1 ) ) ) ) < e))))))))
proof
let S being (Subset of X);
assume that
A1: S is  summable_set;
consider Y02 being  finite (Subset of X) such that Y02 is non  empty and A2: Y02 c= S and A3: (for Y1 being  finite (Subset of X) holds ((Y02 c= Y1 & Y1 c= S) implies ||. ( ( sum S ) - ( setsum Y1 ) ) .|| < 1)) by A1,BHSP_6:def 3;
let e being Real;
assume that
A4: ( 0 ) < e;
set e9 = ( e / ( ( 2 * ||. ( sum S ) .|| ) + 1 ) );
( 0 ) <= ||. ( sum S ) .|| by BHSP_1:28;
then ( 0 ) <= ( 2 * ||. ( sum S ) .|| ) by XREAL_1:127;
then A5: ( ( 0 ) + ( 0 ) ) < ( ( 2 * ||. ( sum S ) .|| ) + 1 ) by XREAL_1:8;
then ( 0 ) < e9 by A4,XREAL_1:139;
then consider Y01 being  finite (Subset of X) such that A6: Y01 is non  empty and A7: Y01 c= S and A8: (for Y1 being  finite (Subset of X) holds ((Y01 c= Y1 & Y1 c= S) implies ||. ( ( sum S ) - ( setsum Y1 ) ) .|| < e9)) by A1,BHSP_6:def 3;
set Y0 = ( Y01 \/ Y02 );
A9: (for Y1 being  finite (Subset of X) holds ((Y0 c= Y1 & Y1 c= S) implies ( abs ( ( ( sum S ) .|. ( sum S ) ) - ( ( setsum Y1 ) .|. ( setsum Y1 ) ) ) ) < e))
proof
let Y1 being  finite (Subset of X);
assume that
A10: Y0 c= Y1
and
A11: Y1 c= S;
set SS = ( ( sum S ) - ( setsum Y1 ) );
set SY = ( setsum Y1 );
Y01 c= Y1 by A10,XBOOLE_1:11;
then A12: ( ||. SS .|| * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) < ( e9 * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) by A5,A8,A11,XREAL_1:68;
||. SY .|| = ||. ( - SY ) .|| by BHSP_1:31
.= ||. ( ( 0. X ) - SY ) .|| by RLVECT_1:14
.= ||. ( ( ( - ( sum S ) ) + ( sum S ) ) - SY ) .|| by RLVECT_1:5
.= ||. ( ( - ( sum S ) ) + SS ) .|| by RLVECT_1:def 3;
then ||. SY .|| <= ( ||. ( - ( sum S ) ) .|| + ||. SS .|| ) by BHSP_1:30;
then A13: ||. SY .|| <= ( ||. ( sum S ) .|| + ||. SS .|| ) by BHSP_1:31;
Y02 c= Y1 by A10,XBOOLE_1:11;
then ( ||. SS .|| + ||. SY .|| ) < ( 1 + ( ||. ( sum S ) .|| + ||. SS .|| ) ) by A3,A11,A13,XREAL_1:8;
then ( ( ||. SY .|| + ||. SS .|| ) - ||. SS .|| ) < ( ( ( 1 + ||. ( sum S ) .|| ) + ||. SS .|| ) - ||. SS .|| ) by XREAL_1:14;
then A14: ( ||. ( sum S ) .|| + ||. SY .|| ) < ( ( 1 + ||. ( sum S ) .|| ) + ||. ( sum S ) .|| ) by XREAL_1:8;
( 0 ) <= ||. SS .|| by BHSP_1:28;
then ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) <= ( ||. SS .|| * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) by A14,XREAL_1:64;
then ( ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) + ( ||. SS .|| * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) ) < ( ( e9 * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) + ( ||. SS .|| * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) ) by A12,XREAL_1:8;
then ( ( ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) + ( ||. SS .|| * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) ) - ( ||. SS .|| * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) ) < ( ( ( e9 * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) + ( ||. SS .|| * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) ) - ( ||. SS .|| * ( ( 2 * ||. ( sum S ) .|| ) + 1 ) ) ) by XREAL_1:14;
then A15: ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) < e by A5,XCMPLX_1:87;
set F = ( ( sum S ) .|. ( sum S ) );
set G = ( ( setsum Y1 ) .|. ( setsum Y1 ) );
( abs ( F - G ) ) = ( abs ( ( F - ( ( sum S ) .|. SY ) ) + ( ( ( sum S ) .|. SY ) - G ) ) )
.= ( abs ( ( ( sum S ) .|. SS ) + ( ( ( sum S ) .|. SY ) - G ) ) ) by BHSP_1:12
.= ( abs ( ( ( sum S ) .|. SS ) + ( SS .|. SY ) ) ) by BHSP_1:11;
then A16: ( abs ( F - G ) ) <= ( ( abs ( ( sum S ) .|. SS ) ) + ( abs ( SS .|. SY ) ) ) by COMPLEX1:56;
( abs ( ( sum S ) .|. SS ) ) <= ( ||. ( sum S ) .|| * ||. SS .|| ) by BHSP_1:29;
then ( ( abs ( F - G ) ) + ( abs ( ( sum S ) .|. SS ) ) ) <= ( ( ( abs ( ( sum S ) .|. SS ) ) + ( abs ( SS .|. SY ) ) ) + ( ||. ( sum S ) .|| * ||. SS .|| ) ) by A16,XREAL_1:7;
then ( ( abs ( F - G ) ) + ( abs ( ( sum S ) .|. SS ) ) ) <= ( ( ( abs ( SS .|. SY ) ) + ( ||. ( sum S ) .|| * ||. SS .|| ) ) + ( abs ( ( sum S ) .|. SS ) ) );
then A17: ( abs ( F - G ) ) <= ( ( abs ( SS .|. SY ) ) + ( ||. ( sum S ) .|| * ||. SS .|| ) ) by XREAL_1:6;
( abs ( SS .|. SY ) ) <= ( ||. SS .|| * ||. SY .|| ) by BHSP_1:29;
then ( ( abs ( F - G ) ) + ( abs ( SS .|. SY ) ) ) <= ( ( ( abs ( SS .|. SY ) ) + ( ||. ( sum S ) .|| * ||. SS .|| ) ) + ( ||. SS .|| * ||. SY .|| ) ) by A17,XREAL_1:7;
then ( ( abs ( F - G ) ) + ( abs ( SS .|. SY ) ) ) <= ( ( ( ||. ( sum S ) .|| * ||. SS .|| ) + ( ||. SS .|| * ||. SY .|| ) ) + ( abs ( SS .|. SY ) ) );
then ( abs ( F - G ) ) <= ( ( ||. SS .|| * ||. ( sum S ) .|| ) + ( ||. SS .|| * ||. SY .|| ) ) by XREAL_1:6;
then ( ( abs ( F - G ) ) + ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) ) < ( e + ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) ) by A15,XREAL_1:8;
then ( ( ( abs ( F - G ) ) + ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) ) - ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) ) < ( ( e + ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) ) - ( ||. SS .|| * ( ||. ( sum S ) .|| + ||. SY .|| ) ) ) by XREAL_1:14;
hence thesis;
end;
Y0 c= S by A7,A2,XBOOLE_1:8;
hence thesis by A6,A9;
end;
