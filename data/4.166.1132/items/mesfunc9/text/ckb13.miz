environ
vocabularies NUMBERS,XBOOLE_0,PROB_1,MEASURE1,SUBSET_1,SEQFUNC,MESFUNC5,PARTFUN1,XXREAL_0,ORDINAL1,NAT_1,RELAT_1,ARYTM_3,ARYTM_1,FUNCT_1,XREAL_0,ORDINAL2,CARD_1,COMPLEX1,SEQ_2,SUPINF_2,XXREAL_2,RINFSUP1,TARSKI,MEASURE6,REAL_1,PBOOLE,MESFUNC1,VALUED_1,FUNCT_3,MESFUNC2,SUPINF_1,VALUED_0,RFUNCT_3,SERIES_1,CARD_3,MESFUNC8,MSSUBFAM,SETFAM_1,INTEGRA5,FUNCOP_1,ZFMISC_1,FUNCT_2,MEASURE2,MESFUNC9;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,COMPLEX1,REAL_1,XXREAL_0,VALUED_0,RELAT_1,FUNCT_1,RELSET_1,BINOP_1,FUNCT_2,PARTFUN1,NAT_1,PROB_1,SETFAM_1,SUPINF_1,SUPINF_2,XXREAL_2,MEASURE1,MEASURE2,EXTREAL1,MESFUNC1,MEASURE6,MESFUNC2,SEQFUNC,MESFUNC5,MESFUNC8,RINFSUP2,FUNCOP_1;
definitions MESFUNC1,MEASURE6,MESFUNC5,BINOP_1,RINFSUP2,MESFUNC8,TARSKI,VALUED_0,XXREAL_3;
theorems TARSKI,PARTFUN1,FUNCT_1,SUPINF_2,EXTREAL1,EXTREAL2,MESFUNC1,XREAL_0,XBOOLE_0,XBOOLE_1,XCMPLX_1,MESFUNC2,XREAL_1,XXREAL_0,MESFUNC5,PROB_1,NAT_1,RELAT_1,FUNCT_3,ZFMISC_1,FUNCT_2,MEASURE1,MESFUNC6,SEQFUNC,ORDINAL1,SETFAM_1,MESFUNC8,RINFSUP2,MESFUNC7,SEQ_4,RELSET_1,MEASURE2,XXREAL_2,VALUED_0,FUNCOP_1,XXREAL_3,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12;
schemes FUNCT_2,NAT_1,BINOP_1,RECDEF_1,SEQFUNC,FUNCT_1;
registrations SUBSET_1,NAT_1,XREAL_0,MEMBERED,ORDINAL1,PARTFUN1,MEASURE1,FUNCT_2,RELAT_1,XBOOLE_0,NUMBERS,XXREAL_0,XCMPLX_0,MESFUNC8,FUNCT_1,VALUED_0,XXREAL_3,RELSET_1;
constructors REAL_1,EXTREAL1,EXTREAL2,BINOP_1,NEWTON,MESFUNC1,MEASURE2,MEASURE6,MESFUNC2,MESFUNC5,MESFUNC8,RINFSUP2,SUPINF_1,SEQFUNC,RELSET_1,BINOP_2;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve X for non  empty set;
reserve S for (SigmaField of X);
reserve M for (sigma_Measure of S);
reserve E for (Element of S);
reserve f for (PartFunc of X,( ExtREAL ));
reserve g for (PartFunc of X,( ExtREAL ));
reserve n for Nat;
reserve m for Nat;
reserve x for (Element of X);
theorem
Th13: ((((E = ( dom f ) & f is_measurable_on E) & f is  nonnegative) & ( M . ( E /\ ( eq_dom (f,( +infty )) ) ) ) <> ( 0 )) implies ( Integral (M,f) ) = ( +infty ))
proof
assume that
A1: E = ( dom f )
and
A2: f is_measurable_on E
and
A3: f is  nonnegative
and
A4: ( M . ( E /\ ( eq_dom (f,( +infty )) ) ) ) <> ( 0 );
reconsider EE = ( E /\ ( eq_dom (f,( +infty )) ) ) as (Element of S) by A1,A2,MESFUNC1:33;
A5: ( dom ( f | E ) ) = E by A1,RELAT_1:62;
E = ( ( dom f ) /\ E ) by A1;
then A6: ( f | E ) is_measurable_on E by A2,MESFUNC5:42;
( integral+ (M,( f | EE )) ) <= ( integral+ (M,( f | E )) ) by A1,A2,A3,MESFUNC5:83,XBOOLE_1:17;
then A7: ( integral+ (M,( f | EE )) ) <= ( Integral (M,( f | E )) ) by A3,A6,A5,MESFUNC5:15,MESFUNC5:88;
A8: EE = ( ( dom f ) /\ EE ) by A1,XBOOLE_1:17,XBOOLE_1:28;
f is_measurable_on EE by A2,MESFUNC1:30,XBOOLE_1:17;
then A9: ( f | EE ) is_measurable_on EE by A8,MESFUNC5:42;
A10: ( f | EE ) is  nonnegative by A3,MESFUNC5:15;
reconsider ES = ( {} ) as (Element of S) by PROB_1:4;
deffunc G((Element of ( NAT ))) = ( $1 (#) ( ( chi (EE,X) ) | EE ) );
consider G being Function such that A11: (( dom G ) = ( NAT ) & (for n being (Element of ( NAT )) holds ( G . n ) = G(n))) from FUNCT_1:sch 4;
now
let g being set;
assume g in ( rng G );
then consider m being set such that A12: m in ( dom G ) and A13: g = ( G . m ) by FUNCT_1:def 3;
reconsider m as (Element of ( NAT )) by A11,A12;
g = ( m (#) ( ( chi (EE,X) ) | EE ) ) by A11,A13;
hence g in ( PFuncs (X,( ExtREAL )) ) by PARTFUN1:45;
end;
then ( rng G ) c= ( PFuncs (X,( ExtREAL )) ) by TARSKI:def 3;
then reconsider G as (Functional_Sequence of X,( ExtREAL )) by A11,FUNCT_2:def 1,RELSET_1:4;
A14: (for n being Nat holds (( dom ( G . n ) ) = EE & (for x being set holds (x in ( dom ( G . n ) ) implies ( ( G . n ) . x ) = n))))
proof
let n being Nat;
reconsider n1 = n as (Element of ( NAT )) by ORDINAL1:def 12;
EE c= X;
then EE c= ( dom ( chi (EE,X) ) ) by FUNCT_3:def 3;
then A15: ( dom ( ( chi (EE,X) ) | EE ) ) = EE by RELAT_1:62;
A16: ( G . n ) = ( n1 (#) ( ( chi (EE,X) ) | EE ) ) by A11;
hence A17: ( dom ( G . n ) ) = EE by A15,MESFUNC1:def 6;
let x being set;
assume A18: x in ( dom ( G . n ) );
then reconsider x1 = x as (Element of X);
( ( chi (EE,X) ) . x1 ) = ( 1. ) by A17,A18,FUNCT_3:def 3;
then ( ( ( chi (EE,X) ) | EE ) . x1 ) = ( 1. ) by A15,A17,A18,FUNCT_1:47;
then ( ( G . n ) . x ) = ( ( R_EAL n1 ) * ( 1. ) ) by A16,A18,MESFUNC1:def 6;
hence thesis by XXREAL_3:81;
end;
A19: (for n being Nat holds ( G . n ) is  nonnegative)
proof
let n being Nat;
(for x being set holds (x in ( dom ( G . n ) ) implies ( 0 ) <= ( ( G . n ) . x ))) by A14;
hence thesis by SUPINF_2:52;
end;
deffunc K((Element of ( NAT ))) = ( integral' (M,( G . $1 )) );
consider K being (Function of ( NAT ),( ExtREAL )) such that A20: (for n being (Element of ( NAT )) holds ( K . n ) = K(n)) from FUNCT_2:sch 4;
reconsider K as ExtREAL_sequence;
A21: (for n being Nat holds ( K . n ) = ( integral' (M,( G . n )) ))
proof
let n being Nat;
reconsider n1 = n as (Element of ( NAT )) by ORDINAL1:def 12;
( K . n ) = ( integral' (M,( G . n1 )) ) by A20;
hence thesis;
end;
A22: ( dom ( f | EE ) ) = EE by A1,RELAT_1:62,XBOOLE_1:17;
A23: (for n,m being Nat holds (n <= m implies (for x being (Element of X) holds (x in ( dom ( f | EE ) ) implies ( ( G . n ) . x ) <= ( ( G . m ) . x )))))
proof
let n being Nat;
let m being Nat;
assume that
A24: n <= m;
let x being (Element of X);
assume A25: x in ( dom ( f | EE ) );
then x in ( dom ( G . n ) ) by A22,A14;
then A26: ( ( G . n ) . x ) = n by A14;
x in ( dom ( G . m ) ) by A22,A14,A25;
hence thesis by A14,A24,A26;
end;
A27: (for n being Nat holds (( dom ( G . n ) ) = ( dom ( f | EE ) ) & ( G . n ) is_simple_func_in S))
proof
let n being Nat;
reconsider n1 = n as (Element of ( NAT )) by ORDINAL1:def 12;
thus A28: ( dom ( G . n ) ) = ( dom ( f | EE ) ) by A22,A14;
(for x being set holds (x in ( dom ( G . n ) ) implies ( ( G . n ) . x ) = n1)) by A14;
hence thesis by A22,A28,MESFUNC6:2;
end;
A29: (for i being (Element of ( NAT )) holds ( K . i ) = ( ( R_EAL i ) * ( M . ( dom ( G . i ) ) ) ))
proof
let i being (Element of ( NAT ));
(for x being set holds (x in ( dom ( G . i ) ) implies ( ( G . i ) . x ) = ( R_EAL i ))) by A14;
then ( integral' (M,( G . i )) ) = ( ( R_EAL i ) * ( M . ( dom ( G . i ) ) ) ) by A27,MESFUNC5:71;
hence thesis by A21;
end;
( M . ES ) <= ( M . EE ) by MEASURE1:31,XBOOLE_1:2;
then A30: ( 0 ) < ( M . EE ) by A4,VALUED_0:def 19;
A31: (not ( rng K ) is  bounded_above)
proof
assume ( rng K ) is  bounded_above;
then consider UB being  real number such that A32: UB is (UpperBound of ( rng K )) by XXREAL_2:def 10;
UB in ( REAL ) by XREAL_0:def 1;
then reconsider r = UB as Real;
per cases  by A30,XXREAL_0:10;
suppose A33: ( M . EE ) = ( +infty );

( K . 1 ) = ( ( R_EAL 1 ) * ( M . ( dom ( G . 1 ) ) ) ) by A29;
then ( K . 1 ) = ( ( R_EAL 1 ) * ( M . EE ) ) by A14;
then A34: ( K . 1 ) = ( +infty ) by A33,XXREAL_3:def 5;
( dom K ) = ( NAT ) by FUNCT_2:def 1;
then ( K . 1 ) in ( rng K ) by FUNCT_1:3;
then ( K . 1 ) <= UB by A32,XXREAL_2:def 1;
hence contradiction by A34,XXREAL_0:4;
end;
suppose ( M . EE ) in ( REAL );

then reconsider ee = ( M . EE ) as Real;
consider n being (Element of ( NAT )) such that A35: ( r / ee ) < n by SEQ_4:3;
( K . n ) = ( ( R_EAL n ) * ( M . ( dom ( G . n ) ) ) ) by A29;
then ( K . n ) = ( ( R_EAL n ) * ( M . EE ) ) by A14;
then A36: ( K . n ) = ( n * ee ) by EXTREAL1:1;
( ( r / ee ) * ee ) < ( n * ee ) by A30,A35,XREAL_1:68;
then ( r / ( ee / ee ) ) < ( K . n ) by A36,XCMPLX_1:82;
then A37: r < ( K . n ) by A4,XCMPLX_1:51;
( dom K ) = ( NAT ) by FUNCT_2:def 1;
then ( K . n ) in ( rng K ) by FUNCT_1:3;
then ( K . n ) <= r by A32,XXREAL_2:def 1;
hence contradiction by A37;
end;
end;
(for n,m being (Element of ( NAT )) holds (m <= n implies ( K . m ) <= ( K . n )))
proof
let n being (Element of ( NAT ));
let m being (Element of ( NAT ));
( dom ( G . m ) ) = EE by A14;
then A38: ( K . m ) = ( ( R_EAL m ) * ( M . EE ) ) by A29;
( dom ( G . n ) ) = EE by A14;
then A39: ( K . n ) = ( ( R_EAL n ) * ( M . EE ) ) by A29;
assume m <= n;
hence thesis by A30,A38,A39,XXREAL_3:71;
end;
then A40: K is  non-decreasing by RINFSUP2:7;
then A41: ( lim K ) = ( sup K ) by RINFSUP2:37;
A42: (for x being (Element of X) holds (x in ( dom ( f | EE ) ) implies (( G # x ) is  convergent & ( lim ( G # x ) ) = ( ( f | EE ) . x ))))
proof
let x being (Element of X);
assume A43: x in ( dom ( f | EE ) );
then A44: x in EE by A1,RELAT_1:62,XBOOLE_1:17;
then x in ( eq_dom (f,( +infty )) ) by XBOOLE_0:def 4;
then ( f . x ) = ( +infty ) by MESFUNC1:def 15;
then A45: ( ( f | EE ) . x ) = ( +infty ) by A44,FUNCT_1:49;
A46: (not ( rng ( G # x ) ) is  bounded_above)
proof
assume ( rng ( G # x ) ) is  bounded_above;
then consider UB being  real number such that A47: UB is (UpperBound of ( rng ( G # x ) )) by XXREAL_2:def 10;
UB in ( REAL ) by XREAL_0:def 1;
then reconsider r = UB as Real;
consider n being (Element of ( NAT )) such that A48: r < n by SEQ_4:3;
x in ( dom ( G . n ) ) by A14,A44;
then ( ( G . n ) . x ) = n by A14;
then A49: UB < ( ( G # x ) . n ) by A48,MESFUNC5:def 13;
( dom ( G # x ) ) = ( NAT ) by FUNCT_2:def 1;
then ( ( G # x ) . n ) in ( rng ( G # x ) ) by FUNCT_1:3;
hence contradiction by A49,A47,XXREAL_2:def 1;
end;
(for n,m being (Element of ( NAT )) holds (m <= n implies ( ( G # x ) . m ) <= ( ( G # x ) . n )))
proof
let n being (Element of ( NAT ));
let m being (Element of ( NAT ));
( dom ( G . n ) ) = EE by A14;
then A50: ( ( G . n ) . x ) = n by A22,A14,A43;
( dom ( G . m ) ) = EE by A14;
then ( ( G . m ) . x ) = m by A22,A14,A43;
then A51: ( ( G # x ) . m ) = m by MESFUNC5:def 13;
assume m <= n;
hence thesis by A50,A51,MESFUNC5:def 13;
end;
then A52: ( G # x ) is  non-decreasing by RINFSUP2:7;
( sup ( rng ( G # x ) ) ) is (UpperBound of ( rng ( G # x ) )) by XXREAL_2:def 3;
then ( sup ( G # x ) ) = ( +infty ) by A46,XXREAL_2:53;
hence thesis by A52,A45,RINFSUP2:37;
end;
( sup ( rng K ) ) is (UpperBound of ( rng K )) by XXREAL_2:def 3;
then A53: ( sup K ) = ( +infty ) by A31,XXREAL_2:53;
K is  convergent by A40,RINFSUP2:37;
then ( integral+ (M,( f | EE )) ) = ( +infty ) by A10,A22,A9,A27,A19,A23,A42,A21,A41,A53,MESFUNC5:def 15;
then ( Integral (M,( f | E )) ) = ( +infty ) by A7,XXREAL_0:4;
hence thesis by A1,RELAT_1:68;
end;
