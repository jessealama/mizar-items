environ
vocabularies ABIAN,ARYTM_1,ARYTM_3,BORSUK_1,BROUWER,CARD_1,COMPLEX1,CONNSP_2,CONVEX1,EUCLID,FUNCOP_1,FUNCT_1,FUNCT_3,FUNCT_4,JGRAPH_4,JORDAN2C,MEASURE5,MEMBERED,METRIC_1,NAT_1,NUMBERS,ORDINAL1,ORDINAL2,PCOMPS_1,PRE_TOPC,PROB_1,RCOMP_1,REAL_1,RELAT_1,RLAFFIN1,RLTOPSP1,RLVECT_1,RLVECT_5,RUSUB_4,RVSUM_1,STRUCT_0,SUBSET_1,SUPINF_2,TARSKI,TOPMETR,TOPREALB,TOPS_1,TOPS_2,VALUED_1,VALUED_2,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_2,FUNCT_2;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,ORDINAL1,NUMBERS,VALUED_1,CARD_1,XCMPLX_0,XREAL_0,XXREAL_0,MEMBERED,COMPLEX1,NAT_1,FUNCOP_1,FINSEQ_2,VALUED_2,STRUCT_0,PRE_TOPC,RLAFFIN2,TOPS_1,METRIC_1,PCOMPS_1,TOPMETR,BORSUK_1,RLVECT_1,RLTOPSP1,EUCLID,TOPREAL9,TOPREALB,DOMAIN_1,TOPS_2,COMPTS_1,TBSP_1,JORDAN2C,XXREAL_2,FUNCT_4,JGRAPH_4,TMAP_1,RUSUB_4,CONVEX1,REAL_1,CONNSP_2,BROUWER,ABIAN,RLVECT_5,RLAFFIN1;
definitions TARSKI,XCMPLX_0,STRUCT_0,ALGSTR_0,TOPREAL9,BORSUK_1,BROUWER;
theorems ABIAN,ABSVALUE,BOOLMARK,BORSUK_1,BROUWER,COMPLEX1,COMPTS_1,CONNSP_2,CONVEX1,EUCLID,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,GOBOARD6,HAUSDORF,JGRAPH_4,JORDAN24,JORDAN2C,MEMBERED,METRIC_1,NECKLACE,ORDINAL1,PRE_TOPC,RELAT_1,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLTOPSP1,RLVECT_1,RUSUB_4,SIMPLEX2,SPPOL_1,SUBSET_1,TARSKI,TBSP_1,TMAP_1,TOPGEN_1,TOPMETR,TOPMETR2,TOPREAL9,TOPREALB,TOPREALC,TOPRNS_1,TOPS_1,TOPS_2,TOPS_4,VALUED_2,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_0,XREAL_1,XXREAL_0,XXREAL_2,ZFMISC_1,CKB1,CKB2,CKB3,CKB4;
registrations BORSUK_1,BORSUK_3,BROUWER,CARD_1,COMPTS_1,CONVEX1,EUCLID,EUCLID_9,FUNCOP_1,FUNCT_1,FUNCT_2,JGRAPH_4,JORDAN,JORDAN2C,MEMBERED,NAT_1,PCOMPS_1,PRE_TOPC,REALSET1,RELAT_1,REVROT_1,RLAFFIN1,RLAFFIN3,RLTOPSP1,RLVECT_1,SIMPLEX2,STRUCT_0,SUBSET_1,TMAP_1,TOPGRP_1,TOPMETR,TOPREAL1,TOPREAL9,TOPREALC,TOPS_1,VALUED_0,VALUED_2,WAYBEL_2,XBOOLE_0,XCMPLX_0,XREAL_0,XXREAL_0,ZFMISC_1,RELSET_1,FINSET_1;
constructors BINOP_2,COMPLEX1,POLYEQ_1,TBSP_1,MONOID_0,JORDAN2C,CONVEX1,GRCAT_1,TOPREAL9,TOPS_1,COMPTS_1,PCOMPS_1,XXREAL_2,FUNCSDOM,JGRAPH_4,TMAP_1,TOPREALC,BROUWER,ABIAN,RUSUB_4,RLAFFIN1,RLAFFIN2,RLVECT_5,SEQ_4;
requirements ARITHM,BOOLE,NUMERALS,SUBSET,REAL;
begin
reserve n for Nat;
reserve p for (Point of ( TOP-REAL n ));
reserve q for (Point of ( TOP-REAL n ));
reserve r for  real number;
theorem
Lm3: (for A being (Subset of ( TOP-REAL n )) holds (((p in A & p <> q) & ( A /\ ( halfline (p,q) ) ) is  Bounded) implies (ex w being (Point of ( Euclid n )) st ((w in ( ( Fr A ) /\ ( halfline (p,q) ) ) & (for u,P being (Point of ( Euclid n )) holds ((P = p & u in ( A /\ ( halfline (p,q) ) )) implies ( dist (P,u) ) <= ( dist (P,w) )))) & (for r holds (r > ( 0 ) implies (ex u being (Point of ( Euclid n )) st (u in ( A /\ ( halfline (p,q) ) ) & ( dist (w,u) ) < r))))))))
proof
set TRn = ( TOP-REAL n );
let A being (Subset of TRn);
assume that
A1: p in A
and
A2: p <> q
and
A3: ( A /\ ( halfline (p,q) ) ) is  Bounded;
reconsider P = p,Q = q as (Element of ( Euclid n )) by EUCLID:67;
A4: ( dist (P,Q) ) > ( 0 ) by A2,METRIC_1:7;
set H = ( halfline (p,q) );
reconsider AH = ( A /\ H ) as  bounded (Subset of ( Euclid n )) by A3,JORDAN2C:def 1;
A5: n in ( NAT ) by ORDINAL1:def 12;
then A6: ( dist (Q,P) ) = |. ( q - p ) .| by SPPOL_1:39;
p in H by A5,TOPREAL9:27;
then A7: p in AH by A1,XBOOLE_0:def 4;
set DAH = ( diameter AH );
set X = { r where r is Real: (( ( ( 1 - r ) * p ) + ( r * q ) ) in AH & ( 0 ) <= r) };
set dAH = ( DAH + 1 );
A8:now
let x being set;
assume x in X;
then (ex r being Real st ((x = r & ( ( ( 1 - r ) * p ) + ( r * q ) ) in AH) & ( 0 ) <= r));
hence x is  real;
end;
(( 1 * p ) = p & ( ( 0 ) * q ) = ( 0. TRn )) by RLVECT_1:10,RLVECT_1:def 8;
then p = ( ( ( 1 - ( 0 ) ) * p ) + ( ( 0 ) * q ) ) by RLVECT_1:def 4;
then A9: ( 0 ) in X by A7;
then reconsider X as non empty  real-membered set by A8,MEMBERED:def 3;
A10: ( DAH + ( 0 ) ) < dAH by XREAL_1:8;
now
let x being  ext-real number;
assume x in X;
then consider r being Real such that A11: x = r and A12: ( ( ( 1 - r ) * p ) + ( r * q ) ) in AH and A13: ( 0 ) <= r;
reconsider PQ = ( ( ( 1 - r ) * p ) + ( r * q ) ) as (Element of ( Euclid n )) by A12;
( ( ( ( 1 - r ) * p ) + ( r * q ) ) - p ) = ( r * ( q - p ) ) by CKB1:1;
then ( dist (PQ,P) ) = |. ( r * ( q - p ) ) .| by A5,SPPOL_1:39
.= ( ( abs r ) * |. ( q - p ) .| ) by A5,TOPRNS_1:7
.= ( r * ( dist (Q,P) ) ) by A6,A13,ABSVALUE:def 1;
then ( r * ( dist (Q,P) ) ) <= DAH by A7,A12,TBSP_1:def 8;
then A14: ( r * ( dist (Q,P) ) ) <= dAH by A10,XXREAL_0:2;
( ( r * ( dist (Q,P) ) ) / ( dist (Q,P) ) ) = ( r * ( ( dist (Q,P) ) / ( dist (Q,P) ) ) )
.= ( r * 1 ) by A4,XCMPLX_1:60;
hence x <= ( dAH / ( dist (Q,P) ) ) by A11,A14,XREAL_1:72;
end;
then ( dAH / ( dist (P,Q) ) ) is (UpperBound of X) by XXREAL_2:def 1;
then X is  bounded_above by XXREAL_2:def 10;
then reconsider S = ( sup X ) as Real by XXREAL_2:16;
A15: ( 0 ) <= S by A9,XXREAL_2:4;
set Spq = ( ( ( 1 - S ) * p ) + ( S * q ) );
reconsider spq = Spq as (Element of ( Euclid n )) by EUCLID:67;
A16: (for r being  real number holds (r > ( 0 ) implies (ex w being (Point of ( Euclid n )) st (w in AH & ( dist (spq,w) ) < r))))
proof
let r being  real number;
assume that
A17: r > ( 0 );
set r2 = ( r / |. ( q - p ) .| );
assume A18: (for w being (Point of ( Euclid n )) holds (w in AH implies ( dist (spq,w) ) >= r));
now
let x being  ext-real number;
assume A19: x in X;
then consider w being Real such that A20: x = w and A21: ( ( ( 1 - w ) * p ) + ( w * q ) ) in AH and ( 0 ) <= w;
( S - w ) >= ( 0 ) by A19,A20,XREAL_1:48,XXREAL_2:4;
then A22: ( abs ( S - w ) ) = ( S - w ) by ABSVALUE:def 1;
reconsider PQ = ( ( ( 1 - w ) * p ) + ( w * q ) ) as (Element of ( Euclid n )) by A21;
A23: PQ = ( p + ( w * ( q - p ) ) ) by CKB3:1;
( Spq - ( p + ( w * ( q - p ) ) ) ) = ( ( Spq - p ) - ( w * ( q - p ) ) ) by RLVECT_1:27
.= ( ( S * ( q - p ) ) - ( w * ( q - p ) ) ) by CKB1:1
.= ( ( S - w ) * ( q - p ) ) by RLVECT_1:35;
then ( dist (spq,PQ) ) = |. ( ( S - w ) * ( q - p ) ) .| by A5,A23,SPPOL_1:39
.= ( ( S - w ) * |. ( q - p ) .| ) by A5,A22,TOPRNS_1:7;
then ( ( S - w ) * |. ( q - p ) .| ) >= r by A18,A21;
then ( S - w ) >= r2 by A2,A6,METRIC_1:7,XREAL_1:79;
hence ( S - r2 ) >= x by A20,XREAL_1:11;
end;
then ( S - r2 ) is (UpperBound of X) by XXREAL_2:def 1;
then ( S - ( 0 ) ) <= ( S - r2 ) by XXREAL_2:def 3;
hence contradiction by A4,A6,A17,XREAL_1:8;
end;
A24: ( the TopStruct of TRn ) = ( TopSpaceMetr ( Euclid n ) ) by EUCLID:def 8;
now
let U being (Subset of TRn);
reconsider UE = U as (Subset of ( TopSpaceMetr ( Euclid n ) )) by A24;
assume that
A25: U is  open
and
A26: Spq in U;
UE in (the topology of ( TopSpaceMetr ( Euclid n ) )) by A24,A25,PRE_TOPC:def 2;
then UE is  open by PRE_TOPC:def 2;
then consider r being  real number such that A27: r > ( 0 ) and A28: ( Ball (spq,r) ) c= UE by A26,TOPMETR:15;
set r2 = ( r / |. ( q - p ) .| );
set Sr = ( S + ( r2 / 2 ) );
consider w being (Element of ( Euclid n )) such that A29: (w in AH & ( dist (spq,w) ) < r) by A16,A27;
(w in ( Ball (spq,r) ) & w in A) by A29,METRIC_1:11,XBOOLE_0:def 4;
hence A meets U by A28,XBOOLE_0:3;
A30: ( r2 * |. ( q - p ) .| ) = ( r * ( |. ( q - p ) .| / |. ( q - p ) .| ) )
.= ( r * 1 ) by A4,A6,XCMPLX_1:60;
Sr > ( S + ( 0 ) ) by A4,A6,A27,XREAL_1:6;
then ( S - Sr ) < ( 0 ) by XREAL_1:49;
then A31: ( abs ( S - Sr ) ) = ( - ( S - Sr ) ) by ABSVALUE:def 1
.= ( r2 / 2 );
set Srpq = ( ( ( 1 - Sr ) * p ) + ( Sr * q ) );
reconsider srpq = Srpq as (Element of ( Euclid n )) by EUCLID:67;
A32: srpq in H by A15,A27;
A33: (not srpq in A)
proof
assume srpq in A;
then srpq in AH by A32,XBOOLE_0:def 4;
then Sr in X by A15,A27;
then ( S + ( r2 / 2 ) ) <= ( S + ( 0 ) ) by XXREAL_2:4;
hence contradiction by A4,A6,A27,XREAL_1:8;
end;
( Spq - Srpq ) = ( Spq - ( p + ( Sr * ( q - p ) ) ) ) by CKB3:1
.= ( ( Spq - p ) - ( Sr * ( q - p ) ) ) by RLVECT_1:27
.= ( ( S * ( q - p ) ) - ( Sr * ( q - p ) ) ) by CKB1:1
.= ( ( S - Sr ) * ( q - p ) ) by RLVECT_1:35;
then ( dist (spq,srpq) ) = |. ( ( S - Sr ) * ( q - p ) ) .| by A5,SPPOL_1:39
.= ( ( r2 / 2 ) * |. ( q - p ) .| ) by A5,A31,TOPRNS_1:7
.= ( r / 2 ) by A30;
then ( dist (spq,srpq) ) < r by A27,XREAL_1:216;
then srpq in ( Ball (spq,r) ) by METRIC_1:11;
hence ( U \ A ) <> ( {} ) by A28,A33,XBOOLE_0:def 5;
end;
then A34: Spq in ( Fr A ) by TOPGEN_1:9;
take spq;
A35: ( Spq - p ) = ( S * ( q - p ) ) by CKB1:1;
Spq in H by A15;
hence spq in ( ( Fr A ) /\ H ) by A34,XBOOLE_0:def 4;
A36: ( abs S ) = S by A15,ABSVALUE:def 1;
hereby
let u being (Point of ( Euclid n )),P being (Point of ( Euclid n ));
assume that
A37: P = p
and
A38: u in ( A /\ H );
A39: ( dist (P,spq) ) = |. ( S * ( q - p ) ) .| by A5,A35,A37,SPPOL_1:39
.= ( S * |. ( q - p ) .| ) by A5,A36,TOPRNS_1:7;
u in H by A38,XBOOLE_0:def 4;
then consider Ur being  real number such that A40: u = ( ( ( 1 - Ur ) * p ) + ( Ur * q ) ) and A41: ( 0 ) <= Ur by A5,TOPREAL9:26;
A42: ( abs Ur ) = Ur by A41,ABSVALUE:def 1;
Ur in ( REAL ) by XREAL_0:def 1;
then Ur in X by A38,A40,A41;
then A43: Ur <= S by XXREAL_2:4;
set du = ( dist (P,u) );
set ds = ( dist (P,spq) );
A44: ( ( ( ( 1 - Ur ) * p ) + ( Ur * q ) ) - p ) = ( Ur * ( q - p ) ) by CKB1:1;
( dist (P,u) ) = |. ( Ur * ( q - p ) ) .| by A5,A37,A40,A44,SPPOL_1:39
.= ( Ur * |. ( q - p ) .| ) by A5,A42,TOPRNS_1:7;
hence du <= ds by A39,A43,XREAL_1:64;
end;
thus thesis by A16;
end;
