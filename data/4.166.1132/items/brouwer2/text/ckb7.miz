environ
vocabularies ABIAN,ARYTM_1,ARYTM_3,BORSUK_1,BROUWER,CARD_1,COMPLEX1,CONNSP_2,CONVEX1,EUCLID,FUNCOP_1,FUNCT_1,FUNCT_3,FUNCT_4,JGRAPH_4,JORDAN2C,MEASURE5,MEMBERED,METRIC_1,NAT_1,NUMBERS,ORDINAL1,ORDINAL2,PCOMPS_1,PRE_TOPC,PROB_1,RCOMP_1,REAL_1,RELAT_1,RLAFFIN1,RLTOPSP1,RLVECT_1,RLVECT_5,RUSUB_4,RVSUM_1,STRUCT_0,SUBSET_1,SUPINF_2,TARSKI,TOPMETR,TOPREALB,TOPS_1,TOPS_2,VALUED_1,VALUED_2,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_2,FUNCT_2;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,ORDINAL1,NUMBERS,VALUED_1,CARD_1,XCMPLX_0,XREAL_0,XXREAL_0,MEMBERED,COMPLEX1,NAT_1,FUNCOP_1,FINSEQ_2,VALUED_2,STRUCT_0,PRE_TOPC,RLAFFIN2,TOPS_1,METRIC_1,PCOMPS_1,TOPMETR,BORSUK_1,RLVECT_1,RLTOPSP1,EUCLID,TOPREAL9,TOPREALB,DOMAIN_1,TOPS_2,COMPTS_1,TBSP_1,JORDAN2C,XXREAL_2,FUNCT_4,JGRAPH_4,TMAP_1,RUSUB_4,CONVEX1,REAL_1,CONNSP_2,BROUWER,ABIAN,RLVECT_5,RLAFFIN1;
definitions TARSKI,XCMPLX_0,STRUCT_0,ALGSTR_0,TOPREAL9,BORSUK_1,BROUWER;
theorems ABIAN,ABSVALUE,BOOLMARK,BORSUK_1,BROUWER,COMPLEX1,COMPTS_1,CONNSP_2,CONVEX1,EUCLID,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,GOBOARD6,HAUSDORF,JGRAPH_4,JORDAN24,JORDAN2C,MEMBERED,METRIC_1,NECKLACE,ORDINAL1,PRE_TOPC,RELAT_1,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLTOPSP1,RLVECT_1,RUSUB_4,SIMPLEX2,SPPOL_1,SUBSET_1,TARSKI,TBSP_1,TMAP_1,TOPGEN_1,TOPMETR,TOPMETR2,TOPREAL9,TOPREALB,TOPREALC,TOPRNS_1,TOPS_1,TOPS_2,TOPS_4,VALUED_2,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_0,XREAL_1,XXREAL_0,XXREAL_2,ZFMISC_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6;
registrations BORSUK_1,BORSUK_3,BROUWER,CARD_1,COMPTS_1,CONVEX1,EUCLID,EUCLID_9,FUNCOP_1,FUNCT_1,FUNCT_2,JGRAPH_4,JORDAN,JORDAN2C,MEMBERED,NAT_1,PCOMPS_1,PRE_TOPC,REALSET1,RELAT_1,REVROT_1,RLAFFIN1,RLAFFIN3,RLTOPSP1,RLVECT_1,SIMPLEX2,STRUCT_0,SUBSET_1,TMAP_1,TOPGRP_1,TOPMETR,TOPREAL1,TOPREAL9,TOPREALC,TOPS_1,VALUED_0,VALUED_2,WAYBEL_2,XBOOLE_0,XCMPLX_0,XREAL_0,XXREAL_0,ZFMISC_1,RELSET_1,FINSET_1;
constructors BINOP_2,COMPLEX1,POLYEQ_1,TBSP_1,MONOID_0,JORDAN2C,CONVEX1,GRCAT_1,TOPREAL9,TOPS_1,COMPTS_1,PCOMPS_1,XXREAL_2,FUNCSDOM,JGRAPH_4,TMAP_1,TOPREALC,BROUWER,ABIAN,RUSUB_4,RLAFFIN1,RLAFFIN2,RLVECT_5,SEQ_4;
requirements ARITHM,BOOLE,NUMERALS,SUBSET,REAL;
begin
reserve n for Nat;
reserve p for (Point of ( TOP-REAL n ));
reserve q for (Point of ( TOP-REAL n ));
reserve u for (Point of ( TOP-REAL n ));
reserve A for  convex (Subset of ( TOP-REAL n ));
theorem
Th4: (for A holds ((((A is  closed & p in ( Int A )) & p <> q) & ( A /\ ( halfline (p,q) ) ) is  Bounded) implies (ex u st ( ( Fr A ) /\ ( halfline (p,q) ) ) = { u })))
proof
set TRn = ( TOP-REAL n );
set En = ( Euclid n );
let A being  convex (Subset of ( TOP-REAL n ));
assume that
A1: A is  closed
and
A2: p in ( Int A )
and
A3: p <> q
and
A4: ( A /\ ( halfline (p,q) ) ) is  Bounded;
A5: n in ( NAT ) by ORDINAL1:def 12;
reconsider P = p,Q = q as (Point of En) by EUCLID:67;
A6: ( the TopStruct of TRn ) = ( TopSpaceMetr ( Euclid n ) ) by EUCLID:def 8;
then reconsider I = ( Int A ) as (Subset of ( TopSpaceMetr En ));
( Int A ) in (the topology of ( TopSpaceMetr En )) by A6,PRE_TOPC:def 2;
then I is  open by PRE_TOPC:def 2;
then consider r being  real number such that A7: r > ( 0 ) and A8: ( Ball (P,r) ) c= I by A2,TOPMETR:15;
( dist (P,P) ) < r by A7,METRIC_1:1;
then A9: P in ( Ball (P,r) ) by METRIC_1:11;
set H = ( halfline (p,q) );
reconsider AH = ( A /\ H ) as  bounded (Subset of En) by A4,JORDAN2C:def 1;
A10: ( Int A ) c= A by TOPS_1:16;
then consider W being (Point of En) such that A11: W in ( ( Fr A ) /\ H ) and A12: (for u,P being (Point of ( Euclid n )) holds ((P = p & u in AH) implies ( dist (P,u) ) <= ( dist (P,W) ))) and (for r being  real number holds (r > ( 0 ) implies (ex u being (Point of En) st (u in AH & ( dist (W,u) ) < r)))) by A2,A3,A4,CKB5:1;
reconsider w = W as (Point of TRn) by EUCLID:67;
A13: W in ( Fr A ) by A11,XBOOLE_0:def 4;
W in H by A11,XBOOLE_0:def 4;
then consider Wr being  real number such that A14: W = ( ( ( 1 - Wr ) * p ) + ( Wr * q ) ) and A15: Wr >= ( 0 ) by A5,TOPREAL9:26;
A16: ( Fr A ) c= A by A1,TOPS_1:35;
A17: ( Fr A ) misses ( Ball (P,r) ) by A8,TOPS_1:39,XBOOLE_1:63;
( ( Fr A ) /\ H ) = { W }
proof
assume ( ( Fr A ) /\ H ) <> { W };
then consider u being set such that A18: u in ( ( Fr A ) /\ H ) and A19: u <> W by A11,ZFMISC_1:35;
reconsider u as (Point of TRn) by A18;
A20: u in H by A18,XBOOLE_0:def 4;
then consider Ur being  real number such that A21: u = ( ( ( 1 - Ur ) * p ) + ( Ur * q ) ) and A22: Ur >= ( 0 ) by A5,TOPREAL9:26;
A23: ( abs Ur ) = Ur by A22,ABSVALUE:def 1;
reconsider U = u as (Element of En) by EUCLID:67;
A24: ( Wr - Ur ) in ( REAL ) by XREAL_0:def 1;
( ( ( ( 1 - Ur ) * p ) + ( Ur * q ) ) - p ) = ( Ur * ( q - p ) ) by CKB1:1;
then A25: ( dist (U,P) ) = |. ( Ur * ( q - p ) ) .| by A5,A21,SPPOL_1:39
.= ( Ur * |. ( q - p ) .| ) by A5,A23,TOPRNS_1:7;
set R = ( ( r * ( Wr - Ur ) ) / Wr );
reconsider b = ( Ball (U,R) ) as (Subset of ( TopSpaceMetr En )) by A6,EUCLID:67;
set x = ( ( Wr - Ur ) / Wr );
b is  open by TOPMETR:14;
then b in (the topology of TRn) by A6,PRE_TOPC:def 2;
then reconsider B = b as  open (Subset of TRn) by PRE_TOPC:def 2;
A26: ( abs Wr ) = Wr by A15,ABSVALUE:def 1;
( ( ( ( 1 - Wr ) * p ) + ( Wr * q ) ) - p ) = ( Wr * ( q - p ) ) by CKB1:1;
then A27: ( dist (W,P) ) = |. ( Wr * ( q - p ) ) .| by A5,A14,SPPOL_1:39
.= ( Wr * |. ( q - p ) .| ) by A5,A26,TOPRNS_1:7;
A28: u in ( Fr A ) by A18,XBOOLE_0:def 4;
then A29: u in AH by A16,A20,XBOOLE_0:def 4;
P <> W by A17,A9,A13,XBOOLE_0:3;
then A30: Wr > ( 0 ) by A27,METRIC_1:7;
then A31: ( 1 - x ) = ( ( Wr / Wr ) - x ) by XCMPLX_1:60
.= ( Ur / Wr );
P <> u by A17,A9,A28,XBOOLE_0:3;
then Ur > ( 0 ) by A25,METRIC_1:7;
then ( 1 - x ) >= ( x - x ) by A30,A31;
then A32: (x in ( REAL ) & x <= 1) by XREAL_0:def 1,XREAL_1:6;
A33: ( ( ( 1 - Wr ) * p ) + ( Wr * q ) ) = ( ( Wr * ( q - p ) ) + p ) by CKB3:1;
A34: ( ( ( 1 - Ur ) * p ) + ( Ur * q ) ) = ( p + ( Ur * ( q - p ) ) ) by CKB3:1;
then ( ( ( ( 1 - Wr ) * p ) + ( Wr * q ) ) - ( ( ( 1 - Ur ) * p ) + ( Ur * q ) ) ) = ( ( ( p + ( Wr * ( q - p ) ) ) - p ) - ( Ur * ( q - p ) ) ) by A33,RLVECT_1:27
.= ( ( ( Wr * ( q - p ) ) + ( p - p ) ) - ( Ur * ( q - p ) ) ) by EUCLID:45
.= ( ( ( Wr * ( q - p ) ) + ( 0. TRn ) ) - ( Ur * ( q - p ) ) ) by EUCLID:42
.= ( ( Wr * ( q - p ) ) - ( Ur * ( q - p ) ) ) by RLVECT_1:def 4
.= ( ( Wr - Ur ) * ( q - p ) ) by EUCLID:50;
then A35: ( dist (U,W) ) = |. ( ( Wr - Ur ) * ( q - p ) ) .| by A5,A14,A21,SPPOL_1:39
.= ( ( abs ( Wr - Ur ) ) * |. ( q - p ) .| ) by A5,A24,TOPRNS_1:7;
( dist (U,W) ) > ( 0 ) by A19,METRIC_1:7;
then |. ( q - p ) .| > ( 0 ) by A35,XREAL_1:134;
then Ur <= Wr by A12,A25,A27,A29,XREAL_1:68;
then ( Wr - Ur ) >= ( 0 ) by XREAL_1:48;
then A36: ( abs ( Wr - Ur ) ) = ( Wr - Ur ) by ABSVALUE:def 1;
then A37: ( Wr - Ur ) > ( 0 ) by A19,A35,METRIC_1:7;
( dist (U,U) ) = ( 0 ) by METRIC_1:1;
then U in B by A7,A30,A37,METRIC_1:11;
then ( B \ A ) <> ( {} ) by A28,TOPGEN_1:9;
then consider t being set such that A38: t in ( B \ A ) by XBOOLE_0:def 1;
A39: t in B by A38,XBOOLE_0:def 5;
reconsider t as (Point of TRn) by A38;
set z = ( p + ( ( Wr / ( Wr - Ur ) ) * ( t - u ) ) );
reconsider Z = z as (Point of En) by EUCLID:67;
reconsider T = t as (Point of En) by EUCLID:67;
A40: ( dist (U,T) ) = |. ( u - t ) .| by A5,SPPOL_1:39;
A41: ( ( Wr / ( Wr - Ur ) ) * R ) = ( ( ( ( Wr / Wr ) * ( Wr - Ur ) ) / ( Wr - Ur ) ) * r )
.= ( ( ( Wr - Ur ) / ( Wr - Ur ) ) * r ) by A30,XCMPLX_1:88
.= r by A37,XCMPLX_1:88;
( abs ( - Wr ) ) = ( - ( - Wr ) ) by A30,ABSVALUE:def 1;
then A42: (( ( - Wr ) / ( Wr - Ur ) ) in ( REAL ) & ( abs ( ( - Wr ) / ( Wr - Ur ) ) ) = ( Wr / ( Wr - Ur ) )) by A36,COMPLEX1:67,XREAL_0:def 1;
A43: ( ( Ur / Wr ) * ( Wr * ( q - p ) ) ) = ( ( ( Ur / Wr ) * Wr ) * ( q - p ) ) by RLVECT_1:def 7
.= ( ( ( Wr / Wr ) * Ur ) * ( q - p ) )
.= ( Ur * ( q - p ) ) by A30,XCMPLX_1:88;
( p - z ) = ( ( p - p ) - ( ( Wr / ( Wr - Ur ) ) * ( t - u ) ) ) by RLVECT_1:27
.= ( ( 0. TRn ) - ( ( Wr / ( Wr - Ur ) ) * ( t - u ) ) ) by RLVECT_1:15
.= ( - ( ( Wr / ( Wr - Ur ) ) * ( t - u ) ) ) by RLVECT_1:14
.= ( ( - 1 ) * ( ( Wr / ( Wr - Ur ) ) * ( t - u ) ) ) by RLVECT_1:16
.= ( ( ( - 1 ) * ( Wr / ( Wr - Ur ) ) ) * ( t - u ) ) by RLVECT_1:def 7
.= ( ( ( - Wr ) / ( Wr - Ur ) ) * ( t - u ) );
then A44: ( dist (P,Z) ) = |. ( ( ( - Wr ) / ( Wr - Ur ) ) * ( t - u ) ) .| by A5,SPPOL_1:39
.= ( ( Wr / ( Wr - Ur ) ) * |. ( t - u ) .| ) by A5,A42,TOPRNS_1:7;
( dist (U,T) ) < R by A39,METRIC_1:11;
then ( ( Wr / ( Wr - Ur ) ) * |. ( u - t ) .| ) < r by A30,A37,A40,A41,XREAL_1:68;
then ( dist (P,Z) ) < r by A5,A40,A44,SPPOL_1:39;
then Z in ( Ball (P,r) ) by METRIC_1:11;
then A45: Z in I by A8;
( x * ( ( Wr / ( Wr - Ur ) ) * ( t - u ) ) ) = ( ( x * ( Wr / ( Wr - Ur ) ) ) * ( t - u ) ) by RLVECT_1:def 7
.= ( ( ( ( ( Wr - Ur ) / ( Wr - Ur ) ) * Wr ) / Wr ) * ( t - u ) )
.= ( ( Wr / Wr ) * ( t - u ) ) by A37,XCMPLX_1:88
.= ( 1 * ( t - u ) ) by A30,XCMPLX_1:60
.= ( t - u ) by RLVECT_1:def 8;
then ( x * z ) = ( ( x * p ) + ( t - u ) ) by RLVECT_1:def 5;
then ( ( x * z ) + ( ( 1 - x ) * w ) ) = ( ( ( t - u ) + ( x * p ) ) + ( ( ( 1 - x ) * p ) + ( Ur * ( q - p ) ) ) ) by A14,A31,A33,A43,RLVECT_1:def 5
.= ( ( ( ( t - u ) + ( x * p ) ) + ( ( 1 - x ) * p ) ) + ( Ur * ( q - p ) ) ) by RLVECT_1:def 3
.= ( ( ( t - u ) + ( ( x * p ) + ( ( 1 - x ) * p ) ) ) + ( Ur * ( q - p ) ) ) by RLVECT_1:def 3
.= ( ( ( t - u ) + ( ( x + ( 1 - x ) ) * p ) ) + ( Ur * ( q - p ) ) ) by RLVECT_1:def 6
.= ( ( ( t - u ) + p ) + ( Ur * ( q - p ) ) ) by RLVECT_1:def 8
.= ( ( t - u ) + u ) by A21,A34,RLVECT_1:def 3
.= ( t - ( u - u ) ) by RLVECT_1:29
.= ( t - ( 0. TRn ) ) by RLVECT_1:15
.= t by RLVECT_1:13;
then t in A by A16,A10,A13,A30,A32,A37,A45,RLTOPSP1:def 1;
hence contradiction by A38,XBOOLE_0:def 5;
end;
hence thesis by A11;
end;
