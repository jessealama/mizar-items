environ
vocabularies ORDINAL6,CARD_1,RELAT_1,FUNCT_1,CLASSES2,NUMBERS,TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,ORDINAL2,WELLORD1,WELLORD2,ABIAN,CARD_3,MATROID0,ORDINAL4,NAT_1,ARYTM_3,CLASSES1,VALUED_0,AFINSQ_1,ORDINAL5,ZFMISC_1,FINSET_1,MESFUNC8,NAGATA_1,ORDINAL3,PRE_TOPC,AOFA_000;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSET_1,ORDINAL1,ORDINAL2,NAT_1,ORDINAL3,ABIAN,WELLORD1,WELLORD2,CARD_1,ORDINAL4,CARD_3,NAGATA_1,AFINSQ_1,CLASSES1,CLASSES2,NUMBERS,MATROID0,ORDINAL5,AOFA_000,CKB1,CKB25,CKB26,CKB32,CKB33,CKB41,CKB55,CKB72,CKB74;
definitions TARSKI,XBOOLE_0,FUNCT_1,WELLORD1,ABIAN,ORDINAL1,ORDINAL2,ORDINAL4,CARD_3,ORDINAL5,CKB1,CKB25,CKB26,CKB32,CKB33,CKB41,CKB55;
theorems XBOOLE_1,ZFMISC_1,RELAT_1,FUNCT_1,ORDINAL1,ORDINAL2,ORDINAL3,FUNCT_3,WELLORD1,WELLORD2,ORDERS_1,CARD_2,CARD_5,FUNCT_2,ORDINAL4,XBOOLE_0,TARSKI,ORDINAL5,NAT_1,CLASSES1,CLASSES2,CARD_1,AFINSQ_1,NAT_2,GRFUNC_1,ABIAN,CKB1,CKB4,CKB7,CKB8,CKB9,CKB10,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB25,CKB26,CKB31,CKB32,CKB33,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB70,CKB75,CKB76;
schemes NAT_1,ORDINAL1,ORDINAL2,ORDINAL4,TREES_2;
registrations XBOOLE_0,RELAT_1,RELSET_1,FUNCT_1,FINSET_1,FUNCT_2,ORDINAL1,ORDINAL2,CARD_1,WELLORD2,ORDINAL3,CLASSES2,CARD_5,ORDINAL4,CARD_LAR,ORDINAL5,CLASSES1,AFINSQ_1,SUBSET_1,CKB2,CKB3,CKB5,CKB6,CKB11,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB27,CKB28,CKB29,CKB30,CKB34,CKB35,CKB36,CKB48,CKB49,CKB50,CKB59,CKB69,CKB71,CKB73;
constructors WELLORD1,WELLORD2,CLASSES1,ABIAN,CARD_3,AFINSQ_1,ORDINAL3,ORDINAL5,NAT_1,RELSET_1,CKB1,CKB25,CKB32,CKB41,CKB55,CKB74;
requirements SUBSET,BOOLE,NUMERALS;
begin
reserve a for  ordinal number;
reserve b for  ordinal number;
reserve c for  ordinal number;
scheme CriticalNumber2 { U() -> Universe,a() -> (Ordinal of U()),f() -> (Ordinal-Sequence of ( omega ),U()),phi(Ordinal) -> Ordinal } : ((a() c= ( Union f() ) & phi(( Union f() )) = ( Union f() )) & (for b holds (((a() c= b & b in U()) & phi(b) = b) implies ( Union f() ) c= b)))
provided
A0: ( omega ) in U()
and
P0: (for a holds (a in U() implies phi(a) in U()))
and
A1: (for a holds (for b holds ((a in b & b in U()) implies phi(a) in phi(b))))
and
A2: (for a being (Ordinal of U()) holds (a is non empty  limit_ordinal implies (for phi being Ordinal-Sequence holds ((( dom phi ) = a & (for b holds (b in a implies ( phi . b ) = phi(b)))) implies phi(a) is_limes_of phi))))
and
F1: ( f() . ( 0 ) ) = a()
and
F2: (for a holds (a in ( omega ) implies ( f() . ( succ a ) ) = phi(( f() . a ))))
proof
F1a: ( dom f() ) = ( omega ) by FUNCT_2:def 1;
F0: a() in ( rng f() ) by F1,F1a,FUNCT_1:def 3;
hence a() c= ( Union f() ) by ZFMISC_1:74;
set phi = f();
A7:now
defpred P[ Ordinal ]
 means
($1 in U() & $1 c/= phi($1));
assume A8: (ex a st P[ a ]);
consider a such that A9: P[ a ] and A10: (for b holds (P[ b ] implies a c= b)) from ORDINAL1:sch 1(A8);
phi(phi(a)) in phi(a) by A1,A9,ORDINAL1:16;
then phi(a) c/= phi(phi(a)) by ORDINAL1:5;
hence contradiction by P0,A9,A10;
end;
then a() c= phi(a());
then F3: (a() c< phi(a()) or a() = phi(a())) by XBOOLE_0:def 8;
per cases  by F3,ORDINAL1:11;
suppose A3: phi(a()) = a();

A4: (for a being set holds (a in ( omega ) implies ( f() . a ) = a()))
proof
let a being set;
assume a in ( omega );
then reconsider a as (Element of ( omega ));
defpred P[ Nat ]
 means
( f() . $1 ) = a();
C0: P[ ( 0 ) ] by F1;
C1:now
let n being Nat;
assume C2: P[ n ];
n in ( omega ) by ORDINAL1:def 12;
then ( f() . ( succ n ) ) = phi(a()) by F2,C2;
hence P[ ( n + 1 ) ] by A3,NAT_1:38;
end;
(for n being Nat holds P[ n ]) from NAT_1:sch 2(C0,C1);
then P[ a ];
hence thesis;
end;
( rng f() ) = { a() }
proof
thus ( rng f() ) c= { a() }
proof
let x being set;
assume x in ( rng f() );
then consider a being set such that G1: (a in ( dom f() ) & x = ( f() . a )) by FUNCT_1:def 3;
x = a() by A4,G1,F1a;
hence thesis by TARSKI:def 1;
end;

thus thesis by F0,ZFMISC_1:31;
end;
then ( Union f() ) = a() by ZFMISC_1:25;
hence (phi(( Union f() )) = ( Union f() ) & (for b holds (((a() c= b & b in U()) & phi(b) = b) implies ( Union f() ) c= b))) by A3;
end;
suppose A3: a() in phi(a());

deffunc F(Ordinal,Ordinal) = phi($2);
deffunc G(Ordinal,T-Sequence) = ( {} );
A6:now
let a;
assume that
G1: ( succ a ) in ( omega );
a in ( succ a ) by ORDINAL1:6;
hence ( phi . ( succ a ) ) = F(a,( phi . a )) by F2,G1,ORDINAL1:10;
end;
B1: (for a holds (a in ( omega ) implies (a() c= ( phi . a ) & ( phi . a ) in ( phi . ( succ a ) ))))
proof
let a;
assume a in ( omega );
then reconsider a as (Element of ( omega ));
defpred N[ Nat ]
 means
(a() c= ( phi . $1 ) & ( phi . $1 ) in ( phi . ( succ $1 ) ));
B01: N[ ( 0 ) ] by A3,F1,F2;
B02:now
let n being Nat;
assume B03: N[ n ];
B04: (((( n + 1 ) = ( succ n ) & ( ( n + 1 ) + 1 ) = ( succ ( n + 1 ) )) & ( n + 1 ) in ( omega )) & ( ( n + 1 ) + 1 ) in ( omega )) by NAT_1:38;
then (( phi . ( n + 1 ) ) = phi(( phi . n )) & ( phi . ( ( n + 1 ) + 1 ) ) = phi(( phi . ( n + 1 ) ))) by A6;
then (( phi . n ) c= ( phi . ( n + 1 ) ) & ( phi . ( n + 1 ) ) in ( phi . ( ( n + 1 ) + 1 ) )) by A1,A7,B03,B04;
hence N[ ( n + 1 ) ] by B03,NAT_1:38,XBOOLE_1:1;
end;
(for n being Nat holds N[ n ]) from NAT_1:sch 2(B01,B02);
then N[ a ];
hence thesis;
end;
deffunc phi(Ordinal) = phi($1);
consider fi being Ordinal-Sequence such that A23: (( dom fi ) = ( Union phi ) & (for a holds (a in ( Union phi ) implies ( fi . a ) = phi(a)))) from ORDINAL2:sch 3;
1 = ( succ ( 0 ) );
then ( f() . 1 ) = phi(a()) by F1,F2;
then phi(a()) in ( rng phi ) by F1a,FUNCT_1:def 3;
then A24: phi(a()) c= ( Union phi ) by ZFMISC_1:74;
J1: ( Union phi ) in U() by A0,CKB75:1;
now
let c;
assume c in ( Union phi );
then consider x being set such that V1: (x in ( dom phi ) & c in ( phi . x )) by CARD_5:2;
reconsider x as (Element of ( omega )) by V1,FUNCT_2:def 1;
(( succ c ) c= ( phi . x ) & ( phi . x ) in ( phi . ( succ x ) )) by B1,V1,ORDINAL1:21;
then (( succ c ) in ( phi . ( succ x ) ) & ( succ x ) in ( omega )) by ORDINAL1:12;
hence ( succ c ) in ( Union phi ) by F1a,CARD_5:2;
end;
then A249: ( Union phi ) is  limit_ordinal by ORDINAL1:28;
then A25: phi(( Union phi )) is_limes_of fi by A2,A3,A23,A24,J1;
fi is  increasing
proof
let a;
let b;
assume A26: (a in b & b in ( dom fi ));
then ((( fi . a ) = phi(a) & ( fi . b ) = phi(b)) & b in U()) by J1,A23,ORDINAL1:10;
hence thesis by A1,A26;
end;
then A27: ( sup fi ) = ( lim fi ) by A3,A23,A24,A249,ORDINAL4:8
.= phi(( Union phi )) by A25,ORDINAL2:def 10;
thus phi(( Union phi )) c= ( Union phi )
proof
let x being Ordinal;
assume A28: x in phi(( Union phi ));
reconsider A = x as Ordinal;
consider b such that A29: (b in ( rng fi ) & A c= b) by A27,A28,ORDINAL2:21;
consider y being set such that A30: (y in ( dom fi ) & b = ( fi . y )) by A29,FUNCT_1:def 3;
reconsider y as Ordinal by A30;
consider z being set such that A32: (z in ( dom phi ) & y in ( phi . z )) by A23,A30,CARD_5:2;
reconsider z as Ordinal by A32;
set c = ( phi . z );
( succ z ) in ( omega ) by F1a,A32,ORDINAL1:28;
then A33: ((( phi . ( succ z ) ) = phi(c) & ( phi . ( succ z ) ) in ( rng phi )) & b = phi(y)) by F1a,A6,A23,A30,FUNCT_1:def 3;
(b in phi(c) & phi(c) c= ( Union phi )) by A33,A1,A32,ZFMISC_1:74;
hence thesis by A29,ORDINAL1:12;
end;

thus ( Union f() ) c= phi(( Union f() )) by A7,A0,CKB75:1;
let b;
assume Z1: ((a() c= b & b in U()) & phi(b) = b);
( rng f() ) c= b
proof
let x being set;
assume x in ( rng f() );
then consider a being set such that Z2: (a in ( dom f() ) & x = ( f() . a )) by FUNCT_1:def 3;
reconsider a as (Element of ( omega )) by Z2,FUNCT_2:def 1;
defpred P[ Nat ]
 means
( f() . $1 ) in b;
a() <> b by A3,Z1;
then a() c< b by Z1,XBOOLE_0:def 8;
then Z3: P[ ( 0 ) ] by F1,ORDINAL1:11;
Z4:now
let n being Nat;
assume P[ n ];
then (phi(( f() . n )) in b & n in ( omega )) by A1,Z1,ORDINAL1:def 12;
then ( f() . ( succ n ) ) in b by F2;
hence P[ ( n + 1 ) ] by NAT_1:38;
end;
(for n being Nat holds P[ n ]) from NAT_1:sch 2(Z3,Z4);
then P[ a ];
hence thesis by Z2;
end;
then (( Union f() ) c= ( union b ) & ( union b ) c= b) by ORDINAL2:5,ZFMISC_1:77;
hence ( Union f() ) c= b by XBOOLE_1:1;
end;
end;
