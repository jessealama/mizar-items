environ
vocabularies NUMBERS,NAT_1,INT_1,CARD_1,RELAT_1,ARYTM_3,XXREAL_0,ARYTM_1,NEWTON,FINSEQ_1,RADIX_1,POWER,FINSEQ_2,PARTFUN1,FUNCT_1,CARD_3,ORDINAL4,SUBSET_1,TARSKI,REAL_1,RADIX_2;
notations TARSKI,NUMBERS,XCMPLX_0,XXREAL_0,REAL_1,INT_1,NAT_1,NAT_D,FUNCT_1,POWER,PARTFUN1,FINSEQ_1,FINSEQ_2,SEQ_1,NEWTON,BINARITH,RVSUM_1,GR_CY_1,WSIERP_1,RADIX_1,SUBSET_1,RECDEF_1,CKB12,CKB13,CKB14,CKB15,CKB16,CKB21,CKB22,CKB24;
definitions TARSKI,CKB12,CKB13,CKB14,CKB15,CKB16,CKB21,CKB22,CKB24;
theorems NAT_1,NAT_2,INT_1,FINSEQ_1,PREPOWER,POWER,RVSUM_1,FINSEQ_2,TARSKI,FUNCT_1,PEPIN,RADIX_1,EULER_2,INT_3,NEWTON,INT_2,XCMPLX_1,XREAL_1,XXREAL_0,XREAL_0,NAT_D,ORDINAL1,PARTFUN1,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24;
schemes NAT_1,FINSEQ_2,RECDEF_1;
registrations ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,NEWTON,XBOOLE_0,VALUED_0,FINSEQ_2,CARD_1,FINSEQ_1;
constructors REAL_1,NAT_D,NEWTON,POWER,BINARITH,WSIERP_1,GR_CY_1,RADIX_1,SEQ_1,RECDEF_1,CKB12,CKB13,CKB14,CKB15,CKB16,CKB21,CKB22,CKB24;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
definition
let k being Nat;
let f being Nat;
let m being Nat;
let n being Nat;
let e being (Tuple of n,( NAT ));
assume A1: n >= 1;
func Pow_mod (m,e,f,k) -> (Tuple of n,( NAT ))
means
:Def9: (( it . 1 ) = ( Table2 (m,e,f,n) ) & (for i being Nat holds ((1 <= i & i <= ( n - 1 )) implies (ex i1,i2 being Nat st ((i1 = ( it . i ) & i2 = ( it . ( i + 1 ) )) & i2 = ( ( ( ( i1 |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n -' i )) ) ) mod f ))))));
existence
proof
reconsider n1 = n as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider T = ( Table2 (m,e,f,n) ) as (Element of ( NAT ));
defpred PP[ Nat,set,set ]
 means
(ex i1,i2 being Nat st ((i1 = $2 & i2 = $3) & i2 = ( ( ( ( i1 |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n1 -' $1 )) ) ) mod f )));
A2: (for i being (Element of ( NAT )) holds ((1 <= i & i < n1) implies (for x being (Element of ( NAT )) holds (ex y being (Element of ( NAT )) st PP[ i,x,y ]))))
proof
let i being (Element of ( NAT ));
assume that
1 <= i
and
i < n1;
let x being (Element of ( NAT ));
reconsider x as (Element of ( NAT ));
consider y being (Element of ( NAT )) such that A3: y = ( ( ( ( x |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n -' i )) ) ) mod f );
reconsider z = y as (Element of ( NAT ));
take z;
thus thesis by A3;
end;
consider r being (FinSequence of ( NAT )) such that A4: (( len r ) = n1 & (( r . 1 ) = T or n1 = ( 0 ))) and A5: (for i being (Element of ( NAT )) holds ((1 <= i & i < n1) implies PP[ i,( r . i ),( r . ( i + 1 ) ) ])) from RECDEF_1:sch 4(A2);
reconsider r as (Tuple of n,( NAT )) by A4,CARD_1:def 7;
take r;
thus ( r . 1 ) = ( Table2 (m,e,f,n) ) by A1,A4;
let i being Nat;
assume A6: (1 <= i & i <= ( n - 1 ));
i in ( NAT ) by ORDINAL1:def 12;
hence thesis by A5,A6,XREAL_1:147;
end;
uniqueness
proof
let s1 being (Tuple of n,( NAT )),s2 being (Tuple of n,( NAT ));
assume that
A7: ( s1 . 1 ) = ( Table2 (m,e,f,n) )
and
A8: (for i being Nat holds ((1 <= i & i <= ( n - 1 )) implies (ex I1,I2 being Nat st ((I1 = ( s1 . i ) & I2 = ( s1 . ( i + 1 ) )) & I2 = ( ( ( ( I1 |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n -' i )) ) ) mod f )))))
and
A9: ( s2 . 1 ) = ( Table2 (m,e,f,n) )
and
A10: (for i being Nat holds ((1 <= i & i <= ( n - 1 )) implies (ex I1,I2 being Nat st ((I1 = ( s2 . i ) & I2 = ( s2 . ( i + 1 ) )) & I2 = ( ( ( ( I1 |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n -' i )) ) ) mod f )))));
defpred P[ (Element of ( NAT )) ]
 means
((1 <= $1 & $1 <= ( n - 1 )) implies ( s1 . $1 ) = ( s2 . $1 ));
A11: (for i being (Element of ( NAT )) holds (P[ i ] implies P[ ( i + 1 ) ]))
proof
let kk being (Element of ( NAT ));
assume A12: ((1 <= kk & kk <= ( n - 1 )) implies ( s1 . kk ) = ( s2 . kk ));
A13: (( 0 ) = kk or (( 0 ) < kk & ( ( 0 ) + 1 ) = 1));
assume that
1 <= ( kk + 1 )
and
A14: ( kk + 1 ) <= ( n - 1 );
per cases  by A13,NAT_1:13;
suppose ( 0 ) = kk;

hence thesis by A7,A9;
end;
suppose A15: 1 <= kk;

A16: kk <= ( kk + 1 ) by NAT_1:11;
then kk <= ( n - 1 ) by A14,XXREAL_0:2;
then ((ex i1,i2 being Nat st ((i1 = ( s1 . kk ) & i2 = ( s1 . ( kk + 1 ) )) & i2 = ( ( ( ( i1 |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n -' kk )) ) ) mod f ))) & (ex i1,i2 being Nat st ((i1 = ( s2 . kk ) & i2 = ( s2 . ( kk + 1 ) )) & i2 = ( ( ( ( i1 |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n -' kk )) ) ) mod f )))) by A8,A10,A15;
hence thesis by A12,A14,A15,A16,XXREAL_0:2;
end;
end;
A17: ( len s1 ) = n by CARD_1:def 7;
A18: P[ ( 0 ) ];
A19: (for kk being (Element of ( NAT )) holds P[ kk ]) from NAT_1:sch 1(A18,A11);
A20: ( s1 . n ) = ( s2 . n )
proof
( n - 1 ) >= ( 1 - 1 ) by A1,XREAL_1:9;
then reconsider U1 = ( n - 1 ) as (Element of ( NAT )) by INT_1:3;
now
per cases ;
suppose U1 = ( 0 );

hence thesis by A7,A9;
end;
suppose ( 0 ) < U1;

then A21: 1 <= U1 by NAT_1:14;
then ((ex i1,i2 being Nat st ((i1 = ( s1 . U1 ) & i2 = ( s1 . ( U1 + 1 ) )) & i2 = ( ( ( ( i1 |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n -' U1 )) ) ) mod f ))) & (ex j1,j2 being Nat st ((j1 = ( s2 . U1 ) & j2 = ( s2 . ( U1 + 1 ) )) & j2 = ( ( ( ( j1 |^ ( Radix k ) ) mod f ) * ( Table2 (m,e,f,( n -' U1 )) ) ) mod f )))) by A8,A10;
hence thesis by A19,A21;
end;
end;
hence thesis;
end;
A22: (for kk being Nat holds ((1 <= kk & kk <= ( len s1 )) implies ( s1 . kk ) = ( s2 . kk )))
proof
let kk being Nat;
assume that
A23: 1 <= kk
and
A24: kk <= ( len s1 );
A25: kk in ( NAT ) by ORDINAL1:def 12;
now
per cases  by A24,XXREAL_0:1;
suppose A26: kk < ( len s1 );

( n - 1 ) >= ( 1 - 1 ) by A1,XREAL_1:9;
then reconsider U1 = ( ( len s1 ) - 1 ) as (Element of ( NAT )) by A17,INT_1:3;
( U1 + 1 ) = ( len s1 );
then kk <= U1 by A26,NAT_1:13;
hence thesis by A17,A19,A23,A25;
end;
suppose kk = ( len s1 );

hence thesis by A17,A20;
end;
end;
hence thesis;
end;
( len s1 ) = ( len s2 ) by A17,CARD_1:def 7;
hence thesis by A22,FINSEQ_1:14;
end;
end;
