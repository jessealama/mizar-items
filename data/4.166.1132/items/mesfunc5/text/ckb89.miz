environ
vocabularies NUMBERS,SUPINF_1,COMPLEX1,ARYTM_1,XXREAL_0,XREAL_0,ORDINAL1,ARYTM_3,MEASURE6,NAT_1,CARD_1,NEWTON,RELAT_1,REAL_1,SUBSET_1,INT_1,PARTFUN1,FUNCT_1,SUPINF_2,XBOOLE_0,PROB_1,MESFUNC2,VALUED_0,RAT_1,MESFUNC1,TARSKI,MEASURE1,VALUED_1,RFUNCT_3,FINSEQ_1,MESFUNC3,CARD_3,ZFMISC_1,SEQ_2,ORDINAL2,XCMPLX_0,XXREAL_2,SEQFUNC,PBOOLE,INTEGRA1,FINSET_1,MEMBERED,SETLIM_1,INTEGRA5,FUNCT_3,MESFUNC5;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,XXREAL_2,XXREAL_3,REAL_1,RELAT_1,FUNCT_1,FINSEQ_1,RELSET_1,FINSET_1,PARTFUN1,FUNCT_2,INT_1,NAT_D,RAT_1,MEMBERED,SQUARE_1,SUPINF_1,SUPINF_2,MEASURE1,EXTREAL1,NAT_1,MESFUNC1,MESFUNC2,MESFUNC3,FINSEQOP,RFUNCT_3,PROB_1,MEASURE6,NEWTON,LIMFUNC1,SEQFUNC,SETLIM_1,CKB8,CKB9,CKB12,CKB13,CKB14,CKB15,CKB27,CKB66,CKB67,CKB68,CKB69,CKB72,CKB73,CKB87,CKB88;
definitions TARSKI,XBOOLE_0,FINSEQ_1,CARD_3,MEASURE6,XXREAL_3,CKB8,CKB9,CKB12,CKB13,CKB14,CKB15,CKB27,CKB67,CKB68,CKB69,CKB72,CKB73,CKB87;
theorems MEASURE1,MEASURE2,TARSKI,PARTFUN1,FUNCT_1,FUNCT_2,MEASURE6,NAT_1,SUPINF_2,RELSET_1,EXTREAL1,INT_1,EXTREAL2,MESFUNC1,FINSEQ_1,XREAL_0,PROB_1,PROB_2,XBOOLE_0,NAT_2,XBOOLE_1,XCMPLX_1,MESFUNC2,MESFUNC3,NEWTON,XREAL_1,PREPOWER,XXREAL_0,MESFUNC4,ZFMISC_1,SETLIM_1,FINSEQ_3,RAT_1,FUNCT_3,RELAT_1,FINSUB_1,GRFUNC_1,FINSEQ_2,ORDINAL1,NAT_D,NUMBERS,CARD_1,XXREAL_2,VALUED_0,XXREAL_3,KURATO_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB76,CKB77,CKB78,CKB79,CKB80,CKB81,CKB82,CKB83,CKB84,CKB85,CKB86,CKB87;
schemes CLASSES1,FUNCT_2,FINSEQ_1,FINSEQ_2,NAT_1,SEQFUNC,PARTFUN1;
registrations SUBSET_1,ORDINAL1,RELSET_1,PARTFUN1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,RAT_1,MEMBERED,COMPLEX1,FINSEQ_1,MEASURE1,VALUED_0,XXREAL_2,XBOOLE_0,XXREAL_3,XCMPLX_0,CKB20,CKB21;
constructors WELLORD2,REAL_1,SQUARE_1,NAT_D,FINSEQOP,LIMFUNC1,SEQFUNC,NEWTON,RFUNCT_3,MEASURE6,EXTREAL1,MESFUNC1,EXTREAL2,BINARITH,MESFUNC2,KURATO_0,MESFUNC3,SETLIM_1,SUPINF_1,RELSET_1,CKB8,CKB9,CKB12,CKB13,CKB14,CKB15,CKB27,CKB67,CKB68,CKB69,CKB72,CKB73,CKB87,CKB88;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
theorem
Th70: (for X being non  empty set holds (for S being (SigmaField of X) holds (for f being (PartFunc of X,( ExtREAL )) holds (((ex A being (Element of S) st (A = ( dom f ) & f is_measurable_on A)) & f is  nonnegative) implies (ex F being (Functional_Sequence of X,( ExtREAL )) st ((((for n being Nat holds (( F . n ) is_simple_func_in S & ( dom ( F . n ) ) = ( dom f ))) & (for n being Nat holds ( F . n ) is  nonnegative)) & (for n,m being Nat holds (n <= m implies (for x being (Element of X) holds (x in ( dom f ) implies ( ( F . n ) . x ) <= ( ( F . m ) . x )))))) & (for x being (Element of X) holds (x in ( dom f ) implies (( F # x ) is  convergent & ( lim ( F # x ) ) = ( f . x ))))))))))
proof
let X being non  empty set;
let S being (SigmaField of X);
let f being (PartFunc of X,( ExtREAL ));
assume that
A1: (ex A being (Element of S) st (A = ( dom f ) & f is_measurable_on A))
and
A2: f is  nonnegative;
defpred PF[ Nat,(PartFunc of X,( ExtREAL )) ]
 means
(( dom $2 ) = ( dom f ) & (for x being (Element of X) holds (x in ( dom f ) implies ((for k being Nat holds ((((1 <= k & k <= ( ( 2 |^ $1 ) * $1 )) & ( ( k - 1 ) / ( 2 |^ $1 ) ) <= ( f . x )) & ( f . x ) < ( k / ( 2 |^ $1 ) )) implies ( $2 . x ) = ( ( k - 1 ) / ( 2 |^ $1 ) ))) & ($1 <= ( f . x ) implies ( $2 . x ) = $1)))));
A3: (for n being (Element of ( NAT )) holds (ex y being (Element of ( PFuncs (X,( ExtREAL )) )) st PF[ n,y ]))
proof
let n being (Element of ( NAT ));
defpred PP[ set,set ]
 means
((for k being Nat holds ((((1 <= k & k <= ( ( 2 |^ n ) * n )) & ( ( k - 1 ) / ( 2 |^ n ) ) <= ( f . $1 )) & ( f . $1 ) < ( k / ( 2 |^ n ) )) implies $2 = ( ( k - 1 ) / ( 2 |^ n ) ))) & (n <= ( f . $1 ) implies $2 = n));
A4: (for x being set holds (x in ( dom f ) implies (ex y being set st PP[ x,y ])))
proof
let x being set;
assume x in ( dom f );
per cases ;
suppose A5: ( f . x ) < n;

( 0 ) <= ( f . x ) by A2,SUPINF_2:51;
then consider k being Nat such that 1 <= k and k <= ( ( 2 |^ n ) * n ) and A6: ( ( k - 1 ) / ( 2 |^ n ) ) <= ( f . x ) and A7: ( f . x ) < ( k / ( 2 |^ n ) ) by A5,CKB4:1;
take y = ( ( k - 1 ) / ( 2 |^ n ) );
now
let k1 being Nat;
assume that
1 <= k1
and
k1 <= ( ( 2 |^ n ) * n )
and
A8: ( ( k1 - 1 ) / ( 2 |^ n ) ) <= ( f . x )
and
A9: ( f . x ) < ( k1 / ( 2 |^ n ) );
A10:now
assume k1 < k;
then ( k1 + 1 ) <= k by NAT_1:13;
then k1 <= ( k - 1 ) by XREAL_1:19;
then ( k1 / ( 2 |^ n ) ) <= ( ( k - 1 ) / ( 2 |^ n ) ) by XREAL_1:72;
hence contradiction by A6,A9,XXREAL_0:2;
end;
now
assume k < k1;
then ( k + 1 ) <= k1 by NAT_1:13;
then k <= ( k1 - 1 ) by XREAL_1:19;
then ( k / ( 2 |^ n ) ) <= ( ( k1 - 1 ) / ( 2 |^ n ) ) by XREAL_1:72;
hence contradiction by A7,A8,XXREAL_0:2;
end;
hence y = ( ( k1 - 1 ) / ( 2 |^ n ) ) by A10,XXREAL_0:1;
end;
hence thesis by A5;
end;
suppose A11: n <= ( f . x );

reconsider y = n as Real;
take y;
thus thesis by A11,CKB5:1;
end;
end;
consider fn being Function such that A12: (( dom fn ) = ( dom f ) & (for x being set holds (x in ( dom f ) implies PP[ x,( fn . x ) ]))) from CLASSES1:sch 1(A4);
now
let w being set;
assume w in ( rng fn );
then consider v being set such that A13: v in ( dom fn ) and A14: w = ( fn . v ) by FUNCT_1:def 3;
per cases ;
suppose ( R_EAL n ) <= ( f . v );

then ( fn . v ) = ( R_EAL n ) by A12,A13;
hence w in ( ExtREAL ) by A14;
end;
suppose A15: ( f . v ) < ( R_EAL n );

( 0 ) <= ( f . v ) by A2,SUPINF_2:51;
then consider k being Nat such that A16: 1 <= k and A17: k <= ( ( 2 |^ n ) * n ) and A18: ( ( k - 1 ) / ( 2 |^ n ) ) <= ( f . v ) and A19: ( f . v ) < ( k / ( 2 |^ n ) ) by A15,CKB4:1;
( fn . v ) = ( ( k - 1 ) / ( 2 |^ n ) ) by A12,A13,A16,A17,A18,A19;
hence w in ( ExtREAL ) by A14,XXREAL_0:def 1;
end;
end;
then ( rng fn ) c= ( ExtREAL ) by TARSKI:def 3;
then reconsider fn as (PartFunc of ( dom f ),( ExtREAL )) by A12,RELSET_1:4;
reconsider fn as (PartFunc of X,( ExtREAL )) by A12,RELSET_1:5;
reconsider y = fn as (Element of ( PFuncs (X,( ExtREAL )) )) by PARTFUN1:45;
take y;
thus thesis by A12;
end;
(ex F being (Function of ( NAT ),( PFuncs (X,( ExtREAL )) )) st (for n being (Element of ( NAT )) holds PF[ n,( F . n ) ])) from FUNCT_2:sch 3(A3);
then consider F being (Function of ( NAT ),( PFuncs (X,( ExtREAL )) )) such that A20: (for n being (Element of ( NAT )) holds ( dom ( F . n ) ) = ( dom f )) and A21: (for n being (Element of ( NAT )) holds (for x being (Element of X) holds (x in ( dom f ) implies ((for k being Nat holds ((((1 <= k & k <= ( ( 2 |^ n ) * n )) & ( ( k - 1 ) / ( 2 |^ n ) ) <= ( f . x )) & ( f . x ) < ( k / ( 2 |^ n ) )) implies ( ( F . n ) . x ) = ( ( k - 1 ) / ( 2 |^ n ) ))) & (n <= ( f . x ) implies ( ( F . n ) . x ) = n)))));
A22:now
let n being Nat;
n in ( NAT ) by ORDINAL1:def 12;
hence ( dom ( F . n ) ) = ( dom f ) by A20;
end;
reconsider F as (Functional_Sequence of X,( ExtREAL ));
consider A being (Element of S) such that A23: A = ( dom f ) and A24: f is_measurable_on A by A1;
A25: (for n,m being Nat holds (n <= m implies (for x being (Element of X) holds (x in ( dom f ) implies ( ( F . n ) . x ) <= ( ( F . m ) . x )))))
proof
let n being Nat;
let m being Nat;
assume that
A26: n <= m;
reconsider n,m as (Element of ( NAT )) by ORDINAL1:def 12;
let x being (Element of X);
assume that
A27: x in ( dom f );
per cases ;
suppose A28: ( R_EAL m ) <= ( f . x );

then A29: ( R_EAL n ) <= ( f . x ) by A26,XXREAL_0:2;
( ( F . m ) . x ) = ( R_EAL m ) by A21,A27,A28;
hence thesis by A21,A26,A27,A29;
end;
suppose A30: ( f . x ) < ( R_EAL m );

A31: ( 0 ) <= ( f . x ) by A2,SUPINF_2:51;
then consider M being Nat such that A32: 1 <= M and A33: M <= ( ( 2 |^ m ) * m ) and A34: ( ( M - 1 ) / ( 2 |^ m ) ) <= ( f . x ) and A35: ( f . x ) < ( M / ( 2 |^ m ) ) by A30,CKB4:1;
reconsider M as (Element of ( NAT )) by ORDINAL1:def 12;
A36: ( ( F . m ) . x ) = ( ( M - 1 ) / ( 2 |^ m ) ) by A21,A27,A32,A33,A34,A35;
per cases ;
suppose A37: ( R_EAL n ) <= ( f . x );

reconsider M1 = ( 2 |^ m ) as (Element of ( NAT ));
n < ( M / ( 2 |^ m ) ) by A35,A37,XXREAL_0:2;
then ( ( 2 |^ m ) * n ) < M by PREPOWER:6,XREAL_1:79;
then ( ( M1 * n ) + 1 ) <= M by NAT_1:13;
then A38: ( M1 * n ) <= ( M - 1 ) by XREAL_1:19;
A39: ( 0 ) < ( 2 |^ m ) by PREPOWER:6;
( ( F . n ) . x ) = ( R_EAL n ) by A21,A27,A37;
hence thesis by A36,A39,A38,XREAL_1:77;
end;
suppose A40: ( f . x ) < ( R_EAL n );

consider k being Nat such that A41: m = ( n + k ) by A26,NAT_1:10;
reconsider k as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider K = ( 2 |^ k ) as (Element of ( NAT ));
consider N1 being Nat such that A42: 1 <= N1 and A43: N1 <= ( ( 2 |^ n ) * n ) and A44: ( ( N1 - 1 ) / ( 2 |^ n ) ) <= ( f . x ) and A45: ( f . x ) < ( N1 / ( 2 |^ n ) ) by A31,A40,CKB4:1;
reconsider N1 as (Element of ( NAT )) by ORDINAL1:def 12;
A46: ( ( F . n ) . x ) = ( ( N1 - 1 ) / ( 2 |^ n ) ) by A21,A27,A42,A43,A44,A45;
( R_EAL ( ( N1 - 1 ) / ( 2 |^ n ) ) ) < ( R_EAL ( M / ( 2 |^ ( n + k ) ) ) ) by A35,A44,A41,XXREAL_0:2;
then ( ( N1 - 1 ) / ( 2 |^ n ) ) < ( M / ( ( 2 |^ n ) * ( 2 |^ k ) ) ) by NEWTON:8;
then ( ( N1 - 1 ) / ( 2 |^ n ) ) < ( ( M / ( 2 |^ k ) ) / ( 2 |^ n ) ) by XCMPLX_1:78;
then ( N1 - 1 ) < ( M / ( 2 |^ k ) ) by XREAL_1:72;
then ( K * ( N1 - 1 ) ) < M by PREPOWER:6,XREAL_1:79;
then ( ( K * ( N1 - 1 ) ) + 1 ) <= M by INT_1:7;
then ( K * ( N1 - 1 ) ) <= ( M - 1 ) by XREAL_1:19;
then ( ( K * ( N1 - 1 ) ) / ( 2 |^ ( n + k ) ) ) <= ( ( M - 1 ) / ( 2 |^ ( n + k ) ) ) by XREAL_1:72;
then A47: ( ( K * ( N1 - 1 ) ) / ( ( 2 |^ n ) * ( 2 |^ k ) ) ) <= ( ( M - 1 ) / ( 2 |^ ( n + k ) ) ) by NEWTON:8;
( 2 |^ k ) > ( 0 ) by PREPOWER:6;
hence thesis by A36,A46,A41,A47,XCMPLX_1:91;
end;
end;
end;
A48: (for n being Nat holds ( F . n ) is_simple_func_in S)
proof
let n being Nat;
reconsider n as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider N = ( 2 |^ n ) as (Element of ( NAT ));
defpred PG[ Nat,set ]
 means
(($1 <= ( N * n ) implies $2 = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( $1 - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( $1 / ( 2 |^ n ) ) )) ) )) & ($1 = ( ( N * n ) + 1 ) implies $2 = ( A /\ ( great_eq_dom (f,( R_EAL n )) ) )));
now
let x being (Element of X);
assume x in ( dom ( F . n ) );
then A49: x in ( dom f ) by A22;
per cases ;
suppose A50: ( R_EAL n ) <= ( f . x );

then ( ( F . n ) . x ) = ( R_EAL n ) by A21,A49;
then A51: ( ( F . n ) . x ) < ( +infty ) by XXREAL_0:9;
( - ( +infty ) ) < ( ( F . n ) . x ) by A21,A49,A50;
hence |. ( ( F . n ) . x ) .| < ( +infty ) by A51,EXTREAL2:11;
end;
suppose A52: ( f . x ) < ( R_EAL n );

A53: ( 0 ) <= ( f . x ) by A2,SUPINF_2:51;
( R_EAL n ) < ( +infty ) by XXREAL_0:9;
then reconsider y = ( f . x ) as Real by A52,A53,XXREAL_0:14;
set k = ( [\ ( ( 2 |^ n ) * y ) /] + 1 );
A54: [\ ( ( 2 |^ n ) * y ) /] <= ( ( 2 |^ n ) * y ) by INT_1:def 6;
( ( ( 2 |^ n ) * y ) - 1 ) < [\ ( ( 2 |^ n ) * y ) /] by INT_1:def 6;
then A55: ( ( 2 |^ n ) * y ) < k by XREAL_1:19;
A56: ( 0 ) < ( 2 |^ n ) by PREPOWER:6;
then ( ( 2 |^ n ) * y ) < ( ( 2 |^ n ) * n ) by A52,XREAL_1:68;
then [\ ( ( 2 |^ n ) * y ) /] < ( ( 2 |^ n ) * n ) by A54,XXREAL_0:2;
then A57: k <= ( ( 2 |^ n ) * n ) by INT_1:7;
A58: ( 0 ) <= ( ( 2 |^ n ) * y ) by A53;
then A59: ( ( 0 ) + 1 ) <= k by A55,INT_1:7;
reconsider k as (Element of ( NAT )) by A58,A55,INT_1:3;
( k - 1 ) <= ( ( 2 |^ n ) * y ) by INT_1:def 6;
then A60: ( ( k - 1 ) / ( 2 |^ n ) ) <= y by PREPOWER:6,XREAL_1:79;
y < ( k / ( 2 |^ n ) ) by A56,INT_1:29,XREAL_1:81;
then A61: ( ( F . n ) . x ) = ( ( k - 1 ) / ( 2 |^ n ) ) by A21,A49,A59,A57,A60;
then ( -infty ) < ( ( F . n ) . x ) by XXREAL_0:12;
then A62: ( - ( +infty ) ) < ( ( F . n ) . x ) by XXREAL_3:def 3;
( ( F . n ) . x ) < ( +infty ) by A61,XXREAL_0:9;
hence |. ( ( F . n ) . x ) .| < ( +infty ) by A62,EXTREAL2:11;
end;
end;
then A63: ( F . n ) is  real-valued by MESFUNC2:def 1;
A64:now
let k being Nat;
assume k in ( Seg ( ( N * n ) + 1 ) );
reconsider k1 = k as (Element of ( NAT )) by ORDINAL1:def 12;
per cases ;
suppose A65: k <> ( ( N * n ) + 1 );

set B = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( k1 - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( k1 / ( 2 |^ n ) ) )) ) );
reconsider B as (Element of S) by A23,A24,CKB43:1;
take B;
thus PG[ k,B ] by A65;
end;
suppose A66: k = ( ( N * n ) + 1 );

set B = ( A /\ ( great_eq_dom (f,( R_EAL n )) ) );
reconsider B as (Element of S) by A23,A24,MESFUNC1:27;
take B;
thus PG[ k,B ] by A66,NAT_1:13;
end;
end;
consider G being (FinSequence of S) such that A67: (( dom G ) = ( Seg ( ( N * n ) + 1 ) ) & (for k being Nat holds (k in ( Seg ( ( N * n ) + 1 ) ) implies PG[ k,( G . k ) ]))) from FINSEQ_1:sch 5(A64);
A68:now
let k being Nat;
assume that
A69: 1 <= k
and
A70: k <= ( ( 2 |^ n ) * n );
A71: k in ( NAT ) by ORDINAL1:def 12;
k <= ( ( N * n ) + 1 ) by A70,NAT_1:12;
then k in ( Seg ( ( N * n ) + 1 ) ) by A69,A71;
hence ( G . k ) = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( k / ( 2 |^ n ) ) )) ) ) by A67,A70;
end;
A72: ( len G ) = ( ( ( 2 |^ n ) * n ) + 1 ) by A67,FINSEQ_1:def 3;
now
let x being set;
let y being set;
assume A73: x <> y;
per cases ;
suppose ((not x in ( dom G )) or (not y in ( dom G )));

then (( G . x ) = ( {} ) or ( G . y ) = ( {} )) by FUNCT_1:def 2;
hence ( G . x ) misses ( G . y ) by XBOOLE_1:65;
end;
suppose A74: (x in ( dom G ) & y in ( dom G ));

then reconsider x1 = x,y1 = y as (Element of ( NAT ));
A75: x1 in ( Seg ( len G ) ) by A74,FINSEQ_1:def 3;
then A76: 1 <= x1 by FINSEQ_1:1;
A77: y1 in ( Seg ( len G ) ) by A74,FINSEQ_1:def 3;
then A78: 1 <= y1 by FINSEQ_1:1;
A79: y1 <= ( ( ( 2 |^ n ) * n ) + 1 ) by A72,A77,FINSEQ_1:1;
A80: x1 <= ( ( ( 2 |^ n ) * n ) + 1 ) by A72,A75,FINSEQ_1:1;
now
per cases  by A73,XXREAL_0:1;
case A81: x1 < y1;
hereby
assume A82: y1 = ( ( ( 2 |^ n ) * n ) + 1 );
then A83: ( G . y ) = ( A /\ ( great_eq_dom (f,( R_EAL n )) ) ) by A67,A74;
A84: x1 <= ( N * n ) by A81,A82,NAT_1:13;
then A85: ( G . x ) = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( x1 - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( x1 / ( 2 |^ n ) ) )) ) ) by A68,A76;
now
assume (ex v being set st v in ( ( G . x ) /\ ( G . y ) ));
then consider v being set such that A86: v in ( ( G . x ) /\ ( G . y ) );
v in ( G . y ) by A86,XBOOLE_0:def 4;
then v in ( great_eq_dom (f,( R_EAL n )) ) by A83,XBOOLE_0:def 4;
then A87: ( R_EAL n ) <= ( f . v ) by MESFUNC1:def 14;
v in ( G . x ) by A86,XBOOLE_0:def 4;
then v in ( less_dom (f,( R_EAL ( x1 / ( 2 |^ n ) ) )) ) by A85,XBOOLE_0:def 4;
then ( f . v ) < ( R_EAL ( x1 / ( 2 |^ n ) ) ) by MESFUNC1:def 11;
then ( R_EAL n ) < ( R_EAL ( x1 / ( 2 |^ n ) ) ) by A87,XXREAL_0:2;
hence contradiction by A84,PREPOWER:6,XREAL_1:79;
end;
then ( ( G . x ) /\ ( G . y ) ) = ( {} ) by XBOOLE_0:def 1;
hence ( G . x ) misses ( G . y ) by XBOOLE_0:def 7;
end;
assume y1 <> ( ( ( 2 |^ n ) * n ) + 1 );
then y1 < ( ( N * n ) + 1 ) by A79,XXREAL_0:1;
then A88: y1 <= ( N * n ) by NAT_1:13;
then x1 <= ( ( 2 |^ n ) * n ) by A81,XXREAL_0:2;
then A89: ( G . x ) = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( x1 - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( x1 / ( 2 |^ n ) ) )) ) ) by A68,A76;
A90: ( G . y ) = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( y1 - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( y1 / ( 2 |^ n ) ) )) ) ) by A68,A78,A88;
now
assume (ex v being set st v in ( ( G . x ) /\ ( G . y ) ));
then consider v being set such that A91: v in ( ( G . x ) /\ ( G . y ) );
v in ( G . y ) by A91,XBOOLE_0:def 4;
then v in ( A /\ ( great_eq_dom (f,( R_EAL ( ( y1 - 1 ) / ( 2 |^ n ) ) )) ) ) by A90,XBOOLE_0:def 4;
then v in ( great_eq_dom (f,( R_EAL ( ( y1 - 1 ) / ( 2 |^ n ) ) )) ) by XBOOLE_0:def 4;
then A92: ( R_EAL ( ( y1 - 1 ) / ( 2 |^ n ) ) ) <= ( f . v ) by MESFUNC1:def 14;
v in ( G . x ) by A91,XBOOLE_0:def 4;
then v in ( less_dom (f,( R_EAL ( x1 / ( 2 |^ n ) ) )) ) by A89,XBOOLE_0:def 4;
then ( f . v ) < ( R_EAL ( x1 / ( 2 |^ n ) ) ) by MESFUNC1:def 11;
then ( R_EAL ( ( y1 - 1 ) / ( 2 |^ n ) ) ) < ( R_EAL ( x1 / ( 2 |^ n ) ) ) by A92,XXREAL_0:2;
then ( y1 - 1 ) < x1 by XREAL_1:72;
then y1 < ( x1 + 1 ) by XREAL_1:19;
hence contradiction by A81,NAT_1:13;
end;
then ( ( G . x ) /\ ( G . y ) ) = ( {} ) by XBOOLE_0:def 1;
hence ( G . x ) misses ( G . y ) by XBOOLE_0:def 7;
end;
case A93: y1 < x1;
hereby
assume x1 <> ( ( ( 2 |^ n ) * n ) + 1 );
then x1 < ( ( N * n ) + 1 ) by A80,XXREAL_0:1;
then A94: x1 <= ( N * n ) by NAT_1:13;
then y1 <= ( ( 2 |^ n ) * n ) by A93,XXREAL_0:2;
then A95: ( G . y ) = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( y1 - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( y1 / ( 2 |^ n ) ) )) ) ) by A68,A78;
A96: ( G . x ) = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( x1 - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( x1 / ( 2 |^ n ) ) )) ) ) by A68,A76,A94;
now
assume (ex v being set st v in ( ( G . x ) /\ ( G . y ) ));
then consider v being set such that A97: v in ( ( G . x ) /\ ( G . y ) );
v in ( G . x ) by A97,XBOOLE_0:def 4;
then v in ( A /\ ( great_eq_dom (f,( R_EAL ( ( x1 - 1 ) / ( 2 |^ n ) ) )) ) ) by A96,XBOOLE_0:def 4;
then v in ( great_eq_dom (f,( R_EAL ( ( x1 - 1 ) / ( 2 |^ n ) ) )) ) by XBOOLE_0:def 4;
then A98: ( R_EAL ( ( x1 - 1 ) / ( 2 |^ n ) ) ) <= ( f . v ) by MESFUNC1:def 14;
v in ( G . y ) by A97,XBOOLE_0:def 4;
then v in ( less_dom (f,( R_EAL ( y1 / ( 2 |^ n ) ) )) ) by A95,XBOOLE_0:def 4;
then ( f . v ) < ( R_EAL ( y1 / ( 2 |^ n ) ) ) by MESFUNC1:def 11;
then ( R_EAL ( ( x1 - 1 ) / ( 2 |^ n ) ) ) < ( R_EAL ( y1 / ( 2 |^ n ) ) ) by A98,XXREAL_0:2;
then ( x1 - 1 ) < y1 by XREAL_1:72;
then x1 < ( y1 + 1 ) by XREAL_1:19;
hence contradiction by A93,NAT_1:13;
end;
then ( ( G . x ) /\ ( G . y ) ) = ( {} ) by XBOOLE_0:def 1;
hence ( G . x ) misses ( G . y ) by XBOOLE_0:def 7;
end;
assume A99: x1 = ( ( ( 2 |^ n ) * n ) + 1 );
then A100: ( G . x ) = ( A /\ ( great_eq_dom (f,( R_EAL n )) ) ) by A67,A74;
A101: y1 <= ( N * n ) by A93,A99,NAT_1:13;
then A102: ( G . y ) = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( y1 - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( y1 / ( 2 |^ n ) ) )) ) ) by A68,A78;
now
assume (ex v being set st v in ( ( G . x ) /\ ( G . y ) ));
then consider v being set such that A103: v in ( ( G . x ) /\ ( G . y ) );
v in ( G . y ) by A103,XBOOLE_0:def 4;
then v in ( less_dom (f,( R_EAL ( y1 / ( 2 |^ n ) ) )) ) by A102,XBOOLE_0:def 4;
then A104: ( f . v ) < ( R_EAL ( y1 / ( 2 |^ n ) ) ) by MESFUNC1:def 11;
v in ( G . x ) by A103,XBOOLE_0:def 4;
then v in ( great_eq_dom (f,( R_EAL n )) ) by A100,XBOOLE_0:def 4;
then ( R_EAL n ) <= ( f . v ) by MESFUNC1:def 14;
then ( R_EAL n ) < ( R_EAL ( y1 / ( 2 |^ n ) ) ) by A104,XXREAL_0:2;
hence contradiction by A101,PREPOWER:6,XREAL_1:79;
end;
then ( ( G . x ) /\ ( G . y ) ) = ( {} ) by XBOOLE_0:def 1;
hence ( G . x ) misses ( G . y ) by XBOOLE_0:def 7;
end;
end;
hence ( G . x ) misses ( G . y );
end;
end;
then reconsider G as (Finite_Sep_Sequence of S) by PROB_2:def 2;
A105: (for k being Nat holds (for x,y being (Element of X) holds (((k in ( dom G ) & x in ( G . k )) & y in ( G . k )) implies ( ( F . n ) . x ) = ( ( F . n ) . y ))))
proof
let k being Nat;
let x being (Element of X);
let y being (Element of X);
assume that
A106: k in ( dom G )
and
A107: x in ( G . k )
and
A108: y in ( G . k );
A109: 1 <= k by A67,A106,FINSEQ_1:1;
A110: k <= ( ( N * n ) + 1 ) by A67,A106,FINSEQ_1:1;
now
per cases ;
suppose k = ( ( N * n ) + 1 );

then A111: ( G . k ) = ( A /\ ( great_eq_dom (f,( R_EAL n )) ) ) by A67,A106;
then x in ( great_eq_dom (f,( R_EAL n )) ) by A107,XBOOLE_0:def 4;
then A112: ( R_EAL n ) <= ( f . x ) by MESFUNC1:def 14;
y in ( great_eq_dom (f,( R_EAL n )) ) by A108,A111,XBOOLE_0:def 4;
then A113: ( R_EAL n ) <= ( f . y ) by MESFUNC1:def 14;
x in A by A107,A111,XBOOLE_0:def 4;
then A114: ( ( F . n ) . x ) = ( R_EAL n ) by A23,A21,A112;
y in A by A108,A111,XBOOLE_0:def 4;
hence thesis by A23,A21,A114,A113;
end;
suppose k <> ( ( N * n ) + 1 );

then k < ( ( N * n ) + 1 ) by A110,XXREAL_0:1;
then A115: k <= ( N * n ) by NAT_1:13;
then A116: ( G . k ) = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( k / ( 2 |^ n ) ) )) ) ) by A67,A106;
then x in ( less_dom (f,( R_EAL ( k / ( 2 |^ n ) ) )) ) by A107,XBOOLE_0:def 4;
then A117: ( f . x ) < ( R_EAL ( k / ( 2 |^ n ) ) ) by MESFUNC1:def 11;
A118: x in ( A /\ ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) ) by A107,A116,XBOOLE_0:def 4;
then x in ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) by XBOOLE_0:def 4;
then A119: ( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) ) <= ( f . x ) by MESFUNC1:def 14;
x in A by A118,XBOOLE_0:def 4;
then A120: ( ( F . n ) . x ) = ( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) ) by A23,A21,A109,A115,A117,A119;
y in ( less_dom (f,( R_EAL ( k / ( 2 |^ n ) ) )) ) by A108,A116,XBOOLE_0:def 4;
then A121: ( f . y ) < ( R_EAL ( k / ( 2 |^ n ) ) ) by MESFUNC1:def 11;
A122: y in ( A /\ ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) ) by A108,A116,XBOOLE_0:def 4;
then y in ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) by XBOOLE_0:def 4;
then A123: ( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) ) <= ( f . y ) by MESFUNC1:def 14;
y in A by A122,XBOOLE_0:def 4;
hence thesis by A23,A21,A109,A115,A121,A123,A120;
end;
end;
hence thesis;
end;
(for v being set holds (v in ( dom f ) implies v in ( union ( rng G ) )))
proof
let v being set;
assume A124: v in ( dom f );
(ex B being set st (v in B & B in ( rng G )))
proof
per cases ;
suppose A125: ( f . v ) < ( R_EAL n );

( 0 ) <= ( f . v ) by A2,SUPINF_2:51;
then consider k being Nat such that A126: 1 <= k and A127: k <= ( ( 2 |^ n ) * n ) and A128: ( ( k - 1 ) / ( 2 |^ n ) ) <= ( f . v ) and A129: ( f . v ) < ( k / ( 2 |^ n ) ) by A125,CKB4:1;
v in ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) by A124,A128,MESFUNC1:def 14;
then A130: v in ( A /\ ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) ) by A23,A124,XBOOLE_0:def 4;
v in ( less_dom (f,( R_EAL ( k / ( 2 |^ n ) ) )) ) by A124,A129,MESFUNC1:def 11;
then A131: v in ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( k - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( k / ( 2 |^ n ) ) )) ) ) by A130,XBOOLE_0:def 4;
take ( G . k );
A132: k in ( NAT ) by ORDINAL1:def 12;
( N * n ) <= ( ( N * n ) + 1 ) by NAT_1:11;
then k <= ( ( N * n ) + 1 ) by A127,XXREAL_0:2;
then k in ( Seg ( ( N * n ) + 1 ) ) by A126,A132;
hence thesis by A67,A127,A131,FUNCT_1:3;
end;
suppose A133: ( R_EAL n ) <= ( f . v );

set k = ( ( N * n ) + 1 );
take ( G . k );
1 <= k by NAT_1:11;
then A134: k in ( Seg ( ( N * n ) + 1 ) );
v in ( great_eq_dom (f,( R_EAL n )) ) by A124,A133,MESFUNC1:def 14;
then v in ( A /\ ( great_eq_dom (f,( R_EAL n )) ) ) by A23,A124,XBOOLE_0:def 4;
hence thesis by A67,A134,FUNCT_1:3;
end;
end;
hence thesis by TARSKI:def 4;
end;
then A135: ( dom f ) c= ( union ( rng G ) ) by TARSKI:def 3;
(for v being set holds (v in ( union ( rng G ) ) implies v in ( dom f )))
proof
let v being set;
assume v in ( union ( rng G ) );
then consider B being set such that A136: v in B and A137: B in ( rng G ) by TARSKI:def 4;
consider m being set such that A138: m in ( dom G ) and A139: B = ( G . m ) by A137,FUNCT_1:def 3;
reconsider m as (Element of ( NAT )) by A138;
A140: m <= ( ( N * n ) + 1 ) by A67,A138,FINSEQ_1:1;
now
per cases ;
suppose m = ( ( N * n ) + 1 );

then B = ( A /\ ( great_eq_dom (f,( R_EAL n )) ) ) by A67,A138,A139;
hence v in A by A136,XBOOLE_0:def 4;
end;
suppose m <> ( ( N * n ) + 1 );

then m < ( ( N * n ) + 1 ) by A140,XXREAL_0:1;
then m <= ( N * n ) by NAT_1:13;
then B = ( ( A /\ ( great_eq_dom (f,( R_EAL ( ( m - 1 ) / ( 2 |^ n ) ) )) ) ) /\ ( less_dom (f,( R_EAL ( m / ( 2 |^ n ) ) )) ) ) by A67,A138,A139;
then v in ( A /\ ( great_eq_dom (f,( R_EAL ( ( m - 1 ) / ( 2 |^ n ) ) )) ) ) by A136,XBOOLE_0:def 4;
hence v in A by XBOOLE_0:def 4;
end;
end;
hence thesis by A23;
end;
then ( union ( rng G ) ) c= ( dom f ) by TARSKI:def 3;
then ( union ( rng G ) ) = ( dom f ) by A135,XBOOLE_0:def 10;
then ( dom ( F . n ) ) = ( union ( rng G ) ) by A22;
hence thesis by A63,A105,MESFUNC2:def 4;
end;
A141:now
let x being (Element of X);
assume that
A142: x in ( dom f );
per cases ;
suppose A143: |. ( f . x ) .| = ( +infty );

now
assume ( - ( f . x ) ) = ( +infty );
then ( f . x ) < ( 0 );
hence contradiction by A2,SUPINF_2:51;
end;
then A144: ( f . x ) = ( +infty ) by A143,EXTREAL2:2;
(for g being  real number holds (( 0 ) < g implies (ex n being Nat st (for m being Nat holds (n <= m implies g <= ( ( F # x ) . m ))))))
proof
let g being  real number;
assume ( 0 ) < g;
then reconsider n = [/ g \] as Nat by INT_1:53;
A145: g <= n by INT_1:def 7;
(for m being Nat holds (n <= m implies g <= ( ( F # x ) . m )))
proof
let m being Nat;
assume n <= m;
then A146: g <= m by A145,XXREAL_0:2;
reconsider m as (Element of ( NAT )) by ORDINAL1:def 12;
( R_EAL m ) <= ( f . x ) by A144,XXREAL_0:4;
then ( ( F . m ) . x ) = ( R_EAL m ) by A21,A142;
hence thesis by A146,CKB87:def 1;
end;
hence thesis;
end;
then A147: ( F # x ) is  convergent_to_+infty by CKB68:def 1;
then ( F # x ) is  convergent by CKB72:def 1;
hence (( F # x ) is  convergent & ( lim ( F # x ) ) = ( f . x )) by A144,A147,CKB73:def 1;
end;
suppose |. ( f . x ) .| <> ( +infty );

then reconsider g = ( f . x ) as Real by EXTREAL2:19,XXREAL_0:14;
A148: (for p being  real number holds (( 0 ) < p implies (ex k being Nat st (for j being Nat holds (j >= k implies |. ( ( ( F # x ) . j ) - ( f . x ) ) .| < p)))))
proof
set N2 = ( [/ g \] + 1 );
let p being  real number;
A149: g <= [/ g \] by INT_1:def 7;
[/ g \] < ( [/ g \] + 1 ) by XREAL_1:29;
then A150: g < N2 by A149,XXREAL_0:2;
( 0 ) <= g by A2,SUPINF_2:51;
then reconsider N2 as (Element of ( NAT )) by A149,INT_1:3;
A151: (for N being Nat holds (N >= N2 implies |. ( ( ( F # x ) . N ) - ( f . x ) ) .| < ( 1 / ( 2 |^ N ) )))
proof
let N being Nat;
assume A152: N >= N2;
reconsider N as (Element of ( NAT )) by ORDINAL1:def 12;
A153: ( 0 ) <= ( f . x ) by A2,SUPINF_2:51;
( f . x ) < N by A150,A152,XXREAL_0:2;
then consider m being Nat such that A154: 1 <= m and A155: m <= ( ( 2 |^ N ) * N ) and A156: ( ( m - 1 ) / ( 2 |^ N ) ) <= ( f . x ) and A157: ( f . x ) < ( m / ( 2 |^ N ) ) by A153,CKB4:1;
reconsider m as (Element of ( NAT )) by ORDINAL1:def 12;
A158: ( ( F # x ) . N ) = ( ( F . N ) . x ) by CKB87:def 1
.= ( ( m - 1 ) / ( 2 |^ N ) ) by A21,A142,A154,A155,A156,A157;
( ( R_EAL ( m / ( 2 |^ N ) ) ) - ( R_EAL ( ( m - 1 ) / ( 2 |^ N ) ) ) ) = ( ( m / ( 2 |^ N ) ) - ( ( m - 1 ) / ( 2 |^ N ) ) ) by SUPINF_2:3
.= ( ( m / ( 2 |^ N ) ) + ( - ( ( m - 1 ) / ( 2 |^ N ) ) ) )
.= ( ( m / ( 2 |^ N ) ) + ( ( - ( m - 1 ) ) / ( 2 |^ N ) ) ) by XCMPLX_1:187
.= ( ( m + ( - ( m - 1 ) ) ) / ( 2 |^ N ) ) by XCMPLX_1:62;
then A159: ( ( f . x ) - ( ( F # x ) . N ) ) < ( 1 / ( 2 |^ N ) ) by A157,A158,XXREAL_3:43;
( - ( ( ( F # x ) . N ) - ( f . x ) ) ) = ( ( f . x ) - ( ( F # x ) . N ) ) by XXREAL_3:26;
then A160: |. ( ( ( F # x ) . N ) - ( f . x ) ) .| = |. ( ( f . x ) - ( ( F # x ) . N ) ) .| by EXTREAL2:18;
( 2 |^ N ) > ( 0 ) by PREPOWER:6;
then A161: ( - ( R_EAL ( 1 / ( 2 |^ N ) ) ) ) < ( 0 );
( 0 ) <= ( ( f . x ) - ( ( F # x ) . N ) ) by A156,A158,XXREAL_3:40;
hence thesis by A160,A159,A161,EXTREAL2:11;
end;
assume ( 0 ) < p;
then consider N1 being (Element of ( NAT )) such that A162: ( 1 / ( 2 |^ N1 ) ) <= p by PREPOWER:92;
reconsider k = ( max (N2,N1) ) as (Element of ( NAT ));
A163: (for k being Nat holds (k >= N1 implies ( 1 / ( 2 |^ k ) ) <= p))
proof
let k being Nat;
assume k >= N1;
then consider i being Nat such that A164: k = ( N1 + i ) by NAT_1:10;
( ( 2 |^ N1 ) * ( 2 |^ i ) ) >= ( 2 |^ N1 ) by PREPOWER:11,XREAL_1:151;
then A165: ( 2 |^ k ) >= ( 2 |^ N1 ) by A164,NEWTON:8;
( 2 |^ N1 ) > ( 0 ) by PREPOWER:11;
then ( ( 2 |^ k ) " ) <= ( ( 2 |^ N1 ) " ) by A165,XREAL_1:85;
then ( 1 / ( 2 |^ k ) ) <= ( ( 2 |^ N1 ) " ) by XCMPLX_1:215;
then ( 1 / ( 2 |^ k ) ) <= ( 1 / ( 2 |^ N1 ) ) by XCMPLX_1:215;
hence thesis by A162,XXREAL_0:2;
end;
now
let j being Nat;
assume A166: j >= k;
k >= N2 by XXREAL_0:25;
then j >= N2 by A166,XXREAL_0:2;
then A167: |. ( ( ( F # x ) . j ) - ( f . x ) ) .| < ( R_EAL ( 1 / ( 2 |^ j ) ) ) by A151;
k >= N1 by XXREAL_0:25;
then j >= N1 by A166,XXREAL_0:2;
then ( 1 / ( 2 |^ j ) ) <= p by A163;
hence |. ( ( ( F # x ) . j ) - ( f . x ) ) .| < p by A167,XXREAL_0:2;
end;
hence thesis;
end;
A168: ( f . x ) = ( R_EAL g );
then A169: ( F # x ) is  convergent_to_finite_number by A148,CKB67:def 1;
then ( F # x ) is  convergent by CKB72:def 1;
hence (( F # x ) is  convergent & ( lim ( F # x ) ) = ( f . x )) by A168,A148,A169,CKB73:def 1;
end;
end;
(for n being Nat holds ( F . n ) is  nonnegative)
proof
let n being Nat;
reconsider n as (Element of ( NAT )) by ORDINAL1:def 12;
now
let x being set;
assume x in ( dom ( F . n ) );
then A170: x in ( dom f ) by A22;
per cases ;
suppose n <= ( f . x );

hence ( 0 ) <= ( ( F . n ) . x ) by A21,A170;
end;
suppose A171: ( f . x ) < n;

( 0 ) <= ( f . x ) by A2,SUPINF_2:51;
then consider k being Nat such that A172: 1 <= k and A173: k <= ( ( 2 |^ n ) * n ) and A174: ( ( k - 1 ) / ( 2 |^ n ) ) <= ( f . x ) and A175: ( f . x ) < ( k / ( 2 |^ n ) ) by A171,CKB4:1;
( 0 ) <= ( k - 1 ) by A172,XREAL_1:48;
hence ( 0 ) <= ( ( F . n ) . x ) by A21,A170,A172,A173,A174,A175;
end;
end;
hence thesis by SUPINF_2:52;
end;
hence thesis by A22,A48,A25,A141;
end;
