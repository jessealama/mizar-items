environ
vocabularies NAT_1,XBOOLE_0,SUBSET_1,FINSEQ_2,TARSKI,UNIALG_1,FUNCT_2,PARTFUN1,RELAT_1,FINSEQ_1,FUNCOP_1,STRUCT_0,CQC_SIM1,FUNCT_1,NUMBERS,CARD_1,ZFMISC_1,SETFAM_1,EQREL_1,BINOP_1,LATTICES,UNIALG_2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,NAT_1,STRUCT_0,RELAT_1,FUNCT_1,FINSEQ_1,SETFAM_1,FUNCOP_1,PARTFUN1,FINSEQ_2,LATTICES,BINOP_1,UNIALG_1,MARGREL1,CKB1,CKB2,CKB3,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB15;
definitions TARSKI,UNIALG_1,XBOOLE_0,SUBSET_1,FUNCOP_1,MARGREL1,CKB3,CKB7,CKB9,CKB10,CKB11,CKB12,CKB15;
theorems TARSKI,FUNCT_1,PARTFUN1,FINSEQ_1,FINSEQ_2,UNIALG_1,ZFMISC_1,SETFAM_1,FUNCOP_1,BINOP_1,LATTICES,FINSEQ_3,RELAT_1,RELSET_1,XBOOLE_0,XBOOLE_1,MARGREL1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB17,CKB18,CKB19;
schemes FINSEQ_1,BINOP_1,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELSET_1,PARTFUN1,FINSEQ_2,STRUCT_0,LATTICES,UNIALG_1,ORDINAL1,FINSEQ_1,CARD_1,MARGREL1,CKB16;
constructors SETFAM_1,BINOP_1,DOMAIN_1,FUNCOP_1,LATTICES,UNIALG_1,MARGREL1,FINSEQ_2,RELSET_1,CKB3,CKB7,CKB9,CKB10,CKB11,CKB12,CKB15;
requirements BOOLE,SUBSET;
begin
reserve U0 for Universal_Algebra;
reserve U1 for Universal_Algebra;
reserve U2 for Universal_Algebra;
reserve n for Nat;
theorem
((U0 is (SubAlgebra of U1) & U1 is (SubAlgebra of U2)) implies U0 is (SubAlgebra of U2))
proof
assume that
A1: U0 is (SubAlgebra of U1)
and
A2: U1 is (SubAlgebra of U2);
A3: (the carrier of U0) is (Subset of U1) by A1,CKB15:def 1;
reconsider B2 = (the carrier of U1) as non  empty (Subset of U2) by A2,CKB15:def 1;
A4: (the charact of U1) = ( Opers (U2,B2) ) by A2,CKB15:def 1;
(the carrier of U1) is (Subset of U2) by A2,CKB15:def 1;
hence (the carrier of U0) is (Subset of U2) by A3,XBOOLE_1:1;
let B being non  empty (Subset of U2);
assume A5: B = (the carrier of U0);
reconsider B1 = (the carrier of U0) as non  empty (Subset of U1) by A1,CKB15:def 1;
A6: (the charact of U0) = ( Opers (U1,B1) ) by A1,CKB15:def 1;
A7: B2 is  opers_closed by A2,CKB15:def 1;
A8: ( dom (the charact of U1) ) = ( dom ( Opers (U2,B2) ) ) by A2,CKB15:def 1
.= ( dom (the charact of U2) ) by CKB12:def 1;
A9: B1 is  opers_closed by A1,CKB15:def 1;
A10:now
let o2 being (operation of U2);
consider n being Nat such that A11: n in ( dom (the charact of U2) ) and A12: ( (the charact of U2) . n ) = o2 by FINSEQ_2:10;
A13: ( dom (the charact of U2) ) = ( dom ( Opers (U2,B2) ) ) by CKB12:def 1;
then reconsider o21 = ( (the charact of U1) . n ) as (operation of U1) by A4,A11,FUNCT_1:def 3;
A14: ( dom o21 ) = ( ( arity o21 ) -tuples_on (the carrier of U1) ) by MARGREL1:22;
A15: ( dom (the charact of U1) ) = ( dom ( Opers (U1,B1) ) ) by CKB12:def 1;
then reconsider o20 = ( (the charact of U0) . n ) as (operation of U0) by A6,A4,A11,A13,FUNCT_1:def 3;
A16: ( dom o20 ) = ( ( arity o20 ) -tuples_on (the carrier of U0) ) by MARGREL1:22;
A17: (( dom o2 ) = ( ( arity o2 ) -tuples_on (the carrier of U2) ) & ( dom ( o2 | ( ( arity o2 ) -tuples_on B2 ) ) ) = ( ( dom o2 ) /\ ( ( arity o2 ) -tuples_on B2 ) )) by MARGREL1:22,RELAT_1:61;
A18: B2 is_closed_on o2 by A7,CKB10:def 1;
A19: o21 = ( o2 /. B2 ) by A4,A11,A12,A13,CKB12:def 1;
then o21 = ( o2 | ( ( arity o2 ) -tuples_on B2 ) ) by A18,CKB11:def 1;
then A20: ( arity o2 ) = ( arity o21 ) by A14,A17,FINSEQ_2:110,MARGREL1:21;
A21: B1 is_closed_on o21 by A9,CKB10:def 1;
A22: o20 = ( o21 /. B1 ) by A6,A4,A11,A13,A15,CKB12:def 1;
then o20 = ( o21 | ( ( arity o21 ) -tuples_on B1 ) ) by A21,CKB11:def 1;
then ( ( arity o20 ) -tuples_on B1 ) = ( ( ( arity o21 ) -tuples_on (the carrier of U1) ) /\ ( ( arity o21 ) -tuples_on B1 ) ) by A16,A14,RELAT_1:61;
then A23: ( arity o20 ) = ( arity o21 ) by FINSEQ_2:110,MARGREL1:21;
now
let s being (FinSequence of B);
reconsider s1 = s as (Element of ( B1 * )) by A5,FINSEQ_1:def 11;
reconsider s0 = s as (Element of ( (the carrier of U0) * )) by A5,FINSEQ_1:def 11;
A24: ( rng o20 ) c= B by A5,RELAT_1:def 19;
( rng s ) c= B by FINSEQ_1:def 4;
then ( rng s ) c= B2 by A3,A5,XBOOLE_1:1;
then s is (FinSequence of B2) by FINSEQ_1:def 4;
then reconsider s2 = s as (Element of ( B2 * )) by FINSEQ_1:def 11;
assume A25: ( len s ) = ( arity o2 );
then s2 in { w where w is (Element of ( B2 * )): ( len w ) = ( arity o2 ) };
then A26: s2 in ( ( arity o2 ) -tuples_on B2 ) by FINSEQ_2:def 4;
s0 in { w where w is (Element of ( (the carrier of U0) * )): ( len w ) = ( arity o20 ) } by A23,A20,A25;
then s0 in ( ( arity o20 ) -tuples_on (the carrier of U0) ) by FINSEQ_2:def 4;
then A27: ( o20 . s0 ) in ( rng o20 ) by A16,FUNCT_1:def 3;
s1 in { w where w is (Element of ( B1 * )): ( len w ) = ( arity o21 ) } by A20,A25;
then A28: s1 in ( ( arity o21 ) -tuples_on B1 ) by FINSEQ_2:def 4;
( o20 . s0 ) = ( ( o21 | ( ( arity o21 ) -tuples_on B1 ) ) . s1 ) by A21,A22,CKB11:def 1
.= ( o21 . s1 ) by A28,FUNCT_1:49
.= ( ( o2 | ( ( arity o2 ) -tuples_on B2 ) ) . s2 ) by A18,A19,CKB11:def 1
.= ( o2 . s ) by A26,FUNCT_1:49;
hence ( o2 . s ) in B by A27,A24;
end;
hence B is_closed_on o2 by CKB9:def 1;
end;
A29: ( dom (the charact of U0) ) = ( dom ( Opers (U1,B1) ) ) by A1,CKB15:def 1
.= ( dom (the charact of U1) ) by CKB12:def 1;
A30: ( dom (the charact of U2) ) = ( dom ( Opers (U2,B) ) ) by CKB12:def 1;
A31: B = B1 by A5;
now
let n being Nat;
assume A32: n in ( dom ( Opers (U2,B) ) );
then reconsider o2 = ( (the charact of U2) . n ) as (operation of U2) by A30,FUNCT_1:def 3;
reconsider o21 = ( (the charact of U1) . n ) as (operation of U1) by A8,A30,A32,FUNCT_1:def 3;
A33: B2 is_closed_on o2 by A7,CKB10:def 1;
A34: B1 is_closed_on o21 by A9,CKB10:def 1;
thus ( ( Opers (U2,B) ) . n ) = ( o2 /. B ) by A32,CKB12:def 1
.= ( o2 | ( ( arity o2 ) -tuples_on B ) ) by A10,CKB11:def 1
.= ( o2 | ( ( ( arity o2 ) -tuples_on B2 ) /\ ( ( arity o2 ) -tuples_on B ) ) ) by A31,MARGREL1:21
.= ( ( o2 | ( ( arity o2 ) -tuples_on B2 ) ) | ( ( arity o2 ) -tuples_on B ) ) by RELAT_1:71
.= ( ( o2 /. B2 ) | ( ( arity o2 ) -tuples_on B ) ) by A33,CKB11:def 1
.= ( o21 | ( ( arity o2 ) -tuples_on B ) ) by A4,A8,A30,A32,CKB12:def 1
.= ( o21 | ( ( arity o21 ) -tuples_on B1 ) ) by A2,A5,A8,A30,A32,CKB17:1
.= ( o21 /. B1 ) by A34,CKB11:def 1
.= ( (the charact of U0) . n ) by A6,A29,A8,A30,A32,CKB12:def 1;
end;
hence (the charact of U0) = ( Opers (U2,B) ) by A29,A8,A30,FINSEQ_1:13;
thus thesis by A10,CKB10:def 1;
end;
