environ
vocabularies NUMBERS,ORDINAL1,REAL_1,FINSEQ_1,VALUED_0,XBOOLE_0,NEWTON,ARYTM_3,RELAT_1,NAT_1,XXREAL_0,ARYTM_1,SUBSET_1,CARD_1,CARD_3,ORDINAL4,TARSKI,INT_2,FUNCT_1,FINSEQ_2,PRE_POLY,PBOOLE,FINSET_1,RVSUM_1,XCMPLX_0,UPROOTS,FUNCT_2,BINOP_2,SETWISEO,INT_1,FUNCOP_1,ZFMISC_1,NAT_3;
notations TARSKI,XBOOLE_0,SUBSET_1,FINSET_1,ZFMISC_1,ORDINAL1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,REAL_1,NAT_D,INT_2,RELAT_1,FUNCT_1,FUNCT_2,FINSEQ_1,VALUED_0,SEQ_1,PBOOLE,RVSUM_1,NAT_1,NEWTON,WSIERP_1,TREES_4,UPROOTS,BINOP_2,FUNCOP_1,XXREAL_2,SETWOP_2,PRE_POLY,POLYNOM2,CKB12,CKB15,CKB16,CKB25,CKB31,CKB36,CKB42,CKB43,CKB45;
definitions TARSKI,XBOOLE_0,INT_2,NAT_D,FINSEQ_1,FINSEQ_2,VALUED_0,PRE_POLY,CKB12,CKB25,CKB31,CKB36,CKB42,CKB45;
theorems ORDINAL1,NEWTON,NAT_1,XCMPLX_1,INT_1,CARD_4,XREAL_0,RVSUM_1,INT_2,PEPIN,PBOOLE,FUNCT_1,CARD_2,PREPOWER,FINSEQ_1,TARSKI,XBOOLE_1,FUNCOP_1,WSIERP_1,XBOOLE_0,RADIX_1,BAGORDER,FINSEQ_2,FINSEQ_3,FINSEQ_4,RELAT_1,UPROOTS,FINSOP_1,FUNCT_2,XREAL_1,XXREAL_0,NAT_D,VALUED_0,XXREAL_2,PARTFUN1,PRE_POLY,CARD_1,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB25,CKB29,CKB31,CKB34,CKB36,CKB39,CKB42,CKB44,CKB45,CKB48;
schemes NAT_1,PRE_CIRC,FINSEQ_1,FINSEQ_2,PBOOLE,CLASSES1;
registrations XBOOLE_0,RELAT_1,FUNCT_1,ORDINAL1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,INT_1,BINOP_2,MEMBERED,NEWTON,VALUED_0,FINSEQ_1,XXREAL_2,CARD_1,UPROOTS,FUNCT_2,RELSET_1,ZFMISC_1,FINSEQ_2,PRE_POLY,CKB1,CKB2,CKB3,CKB13,CKB14,CKB24,CKB26,CKB27,CKB28,CKB30,CKB32,CKB33,CKB35,CKB37,CKB38,CKB40,CKB41,CKB46,CKB47;
constructors BINOP_1,SETWISEO,NAT_D,FINSEQOP,FINSOP_1,NEWTON,WSIERP_1,POLYNOM2,UPROOTS,SEQ_1,BINOP_2,XXREAL_2,RELSET_1,CKB12,CKB15,CKB16,CKB25,CKB31,CKB36,CKB42,CKB43,CKB45;
requirements NUMERALS,SUBSET,ARITHM,REAL,BOOLE;
begin
definition
let n being  natural number;
let d being  natural number;
assume that
A1: d <> 1
and
A2: n <> ( 0 );
func d |-count n -> Nat
means
:Def7: (( d |^ it ) divides n & (not ( d |^ ( it + 1 ) ) divides n));
existence
proof
reconsider n1 = n as (Element of ( NAT )) by ORDINAL1:def 12;
per cases ;
suppose A3: d = ( 0 );

take ( 0 );
( (( 0 ) qua Nat) |^ ( 0 ) ) = 1 by NEWTON:4;
hence ( d |^ ( 0 ) ) divides n by A3,NAT_D:6;
(not ( 0 ) divides n1) by A2,INT_2:3;
hence (not ( d |^ ( ( 0 ) + 1 ) ) divides n) by A3,NEWTON:11;
end;
suppose A4: d <> ( 0 );

defpred P[ Nat ]
 means
( d |^ $1 ) divides n;
A5: (for k being Nat holds (P[ k ] implies k <= n1))
proof
let k being Nat;
assume P[ k ];
then A6: ( d |^ k ) <= n by A2,NAT_D:7;
k <= ( d |^ k ) by A1,A4,CKB5:1,NAT_1:25;
hence thesis by A6,XXREAL_0:2;
end;
A7: (ex k being Nat st P[ k ])
proof
take ( 0 );
( d |^ ( 0 ) ) = 1 by NEWTON:4;
hence thesis by NAT_D:6;
end;
consider k being Nat such that A8: (P[ k ] & (for n being Nat holds (P[ n ] implies n <= k))) from NAT_1:sch 6(A5,A7);
take k;
( k + (( 0 ) qua Nat) ) < ( k + 1 ) by XREAL_1:6;
hence thesis by A8;
end;
end;
uniqueness
proof
reconsider d1 = d as (Element of ( NAT )) by ORDINAL1:def 12;
let a being Nat,b being Nat;
assume that
A9: ( d |^ a ) divides n
and
A10: ((not ( d |^ ( a + 1 ) ) divides n) & ( d |^ b ) divides n)
and
A11: (not ( d |^ ( b + 1 ) ) divides n)
and
A12: a <> b;
reconsider a,b as (Element of ( NAT )) by ORDINAL1:def 12;
per cases  by A12,XXREAL_0:1;
suppose A13: a < b;

then consider x being Nat such that A14: ( a + x ) = b by NAT_1:10;
reconsider x as (Element of ( NAT )) by ORDINAL1:def 12;
now
assume ( ( 0 ) + 1 ) > x;
then x = ( 0 ) by NAT_1:13;
hence contradiction by A13,A14;
end;
then ( a + 1 ) <= ( a + x ) by XREAL_1:6;
then ( d1 |^ ( a + 1 ) ) divides ( d1 |^ ( a + x ) ) by RADIX_1:6;
hence contradiction by A10,A14,NAT_D:4;
end;
suppose A15: b < a;

then consider x being Nat such that A16: ( b + x ) = a by NAT_1:10;
reconsider x as (Element of ( NAT )) by ORDINAL1:def 12;
now
assume ( ( 0 ) + 1 ) > x;
then x = ( 0 ) by NAT_1:13;
hence contradiction by A15,A16;
end;
then ( b + 1 ) <= ( b + x ) by XREAL_1:6;
then ( d1 |^ ( b + 1 ) ) divides ( d1 |^ ( b + x ) ) by RADIX_1:6;
hence contradiction by A9,A11,A16,NAT_D:4;
end;
end;
end;
