environ
vocabularies NUMBERS,ORDINAL1,REAL_1,FINSEQ_1,VALUED_0,XBOOLE_0,NEWTON,ARYTM_3,RELAT_1,NAT_1,XXREAL_0,ARYTM_1,SUBSET_1,CARD_1,CARD_3,ORDINAL4,TARSKI,INT_2,FUNCT_1,FINSEQ_2,PRE_POLY,PBOOLE,FINSET_1,RVSUM_1,XCMPLX_0,UPROOTS,FUNCT_2,BINOP_2,SETWISEO,INT_1,FUNCOP_1,ZFMISC_1,NAT_3;
notations TARSKI,XBOOLE_0,SUBSET_1,FINSET_1,ZFMISC_1,ORDINAL1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,REAL_1,NAT_D,INT_2,RELAT_1,FUNCT_1,FUNCT_2,FINSEQ_1,VALUED_0,SEQ_1,PBOOLE,RVSUM_1,NAT_1,NEWTON,WSIERP_1,TREES_4,UPROOTS,BINOP_2,FUNCOP_1,XXREAL_2,SETWOP_2,PRE_POLY,POLYNOM2,CKB12,CKB15,CKB16,CKB25,CKB31,CKB36,CKB42,CKB43,CKB45,CKB49,CKB50,CKB63,CKB64;
definitions TARSKI,XBOOLE_0,INT_2,NAT_D,FINSEQ_1,FINSEQ_2,VALUED_0,PRE_POLY,CKB12,CKB25,CKB31,CKB36,CKB42,CKB45,CKB49,CKB63;
theorems ORDINAL1,NEWTON,NAT_1,XCMPLX_1,INT_1,CARD_4,XREAL_0,RVSUM_1,INT_2,PEPIN,PBOOLE,FUNCT_1,CARD_2,PREPOWER,FINSEQ_1,TARSKI,XBOOLE_1,FUNCOP_1,WSIERP_1,XBOOLE_0,RADIX_1,BAGORDER,FINSEQ_2,FINSEQ_3,FINSEQ_4,RELAT_1,UPROOTS,FINSOP_1,FUNCT_2,XREAL_1,XXREAL_0,NAT_D,VALUED_0,XXREAL_2,PARTFUN1,PRE_POLY,CARD_1,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB25,CKB29,CKB31,CKB34,CKB36,CKB39,CKB42,CKB44,CKB45,CKB48,CKB49,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB65,CKB66,CKB67,CKB69,CKB70,CKB72,CKB73,CKB75,CKB76,CKB77,CKB78,CKB81,CKB82,CKB83,CKB84,CKB85,CKB86,CKB87,CKB88,CKB89,CKB90;
schemes NAT_1,PRE_CIRC,FINSEQ_1,FINSEQ_2,PBOOLE,CLASSES1;
registrations XBOOLE_0,RELAT_1,FUNCT_1,ORDINAL1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,INT_1,BINOP_2,MEMBERED,NEWTON,VALUED_0,FINSEQ_1,XXREAL_2,CARD_1,UPROOTS,FUNCT_2,RELSET_1,ZFMISC_1,FINSEQ_2,PRE_POLY,CKB1,CKB2,CKB3,CKB13,CKB14,CKB24,CKB26,CKB27,CKB28,CKB30,CKB32,CKB33,CKB35,CKB37,CKB38,CKB40,CKB41,CKB46,CKB47,CKB68,CKB71,CKB74,CKB79,CKB80;
constructors BINOP_1,SETWISEO,NAT_D,FINSEQOP,FINSOP_1,NEWTON,WSIERP_1,POLYNOM2,UPROOTS,SEQ_1,BINOP_2,XXREAL_2,RELSET_1,CKB12,CKB15,CKB16,CKB25,CKB31,CKB36,CKB42,CKB43,CKB45,CKB49,CKB50,CKB63;
requirements NUMERALS,SUBSET,ARITHM,REAL,BOOLE;
begin
theorem
(for m,n being non empty Nat holds ( pfexp ( n lcm m ) ) = ( max (( pfexp n ),( pfexp m )) ))
proof
let m being non empty Nat,n being non empty Nat;
now
set rhs = ( max (( pfexp n ),( pfexp m )) );
set lhs = ( pfexp ( n lcm m ) );
let i being set;
A1: m divides ( n lcm m ) by NAT_D:def 4;
assume i in ( SetPrimes );
then reconsider j = i as  prime (Element of ( NAT )) by NEWTON:def 6;
set x = ( j |-count n );
set y = ( j |-count m );
set z = ( j |-count ( n lcm m ) );
A2: ( lhs . j ) = z by CKB63:def 1;
A3: ( ( pfexp n ) . j ) = x by CKB63:def 1;
A4: j > 1 by INT_2:def 4;
then A5: (not ( j |^ ( x + 1 ) ) divides n) by CKB49:def 1;
A6: ( n lcm m ) <> ( 0 ) by INT_2:4;
then A7: ( j |^ z ) divides ( n lcm m ) by A4,CKB49:def 1;
A8: (not ( j |^ ( z + 1 ) ) divides ( n lcm m )) by A4,A6,CKB49:def 1;
A9: ( ( pfexp m ) . j ) = y by CKB63:def 1;
A10: n divides ( n lcm m ) by NAT_D:def 4;
A11: ( j |^ x ) divides n by A4,CKB49:def 1;
then A12: ( j |^ x ) divides ( n lcm m ) by A10,NAT_D:4;
A13: (not ( j |^ ( y + 1 ) ) divides m) by A4,CKB49:def 1;
A14: ( j |^ y ) divides m by A4,CKB49:def 1;
then A15: ( j |^ y ) divides ( n lcm m ) by A1,NAT_D:4;
thus ( lhs . i ) = ( rhs . i )
proof
per cases ;
suppose A16: ( ( pfexp n ) . j ) <= ( ( pfexp m ) . j );

A17:now
consider p being Nat such that A18: y = ( x + p ) by A3,A9,A16,NAT_1:10;
consider t being Nat such that A19: n = ( ( j |^ x ) * t ) by A11,NAT_D:def 3;
A20:now
assume j divides t;
then consider w being Nat such that A21: t = ( j * w ) by NAT_D:def 3;
n = ( ( ( j |^ x ) * j ) * w ) by A19,A21
.= ( ( j |^ ( x + 1 ) ) * w ) by NEWTON:6;
hence contradiction by A5,NAT_D:def 3;
end;
consider u being Nat such that A22: ( n lcm m ) = ( n * u ) by A10,NAT_D:def 3;
assume y < z;
then ( j |^ ( y + 1 ) ) divides ( n lcm m ) by A7,CKB7:1;
then consider k being Nat such that A23: ( n lcm m ) = ( ( j |^ ( y + 1 ) ) * k ) by NAT_D:def 3;
A24: ( n lcm m ) = ( ( ( j |^ y ) * j ) * k ) by A23,NEWTON:6
.= ( ( j |^ y ) * ( k * j ) );
( ( j |^ x ) * ( ( j |^ p ) * ( k * j ) ) ) = ( ( ( j |^ x ) * ( j |^ p ) ) * ( k * j ) )
.= ( ( j |^ x ) * ( t * u ) ) by A24,A19,A22,A18,NEWTON:8;
then ( ( ( j |^ p ) * k ) * j ) = ( t * u ) by XCMPLX_1:5;
then j divides ( t * u ) by NAT_D:def 3;
then j divides u by A20,NEWTON:80;
then consider w being Nat such that A25: u = ( j * w ) by NAT_D:def 3;
( ( ( j |^ y ) * k ) * j ) = ( ( n * w ) * j ) by A24,A22,A25;
then ( ( j |^ y ) * k ) = ( n * w ) by XCMPLX_1:5;
then A26: n divides ( ( j |^ y ) * k ) by NAT_D:def 3;
consider t being Nat such that A27: m = ( ( j |^ y ) * t ) by A14,NAT_D:def 3;
A28:now
assume j divides t;
then consider w being Nat such that A29: t = ( j * w ) by NAT_D:def 3;
m = ( ( ( j |^ y ) * j ) * w ) by A27,A29
.= ( ( j |^ ( y + 1 ) ) * w ) by NEWTON:6;
hence contradiction by A13,NAT_D:def 3;
end;
consider u being Nat such that A30: ( n lcm m ) = ( m * u ) by A1,NAT_D:def 3;
( ( j |^ y ) * ( k * j ) ) = ( ( j |^ y ) * ( t * u ) ) by A24,A27,A30;
then ( k * j ) = ( t * u ) by XCMPLX_1:5;
then j divides ( t * u ) by NAT_D:def 3;
then j divides u by A28,NEWTON:80;
then consider w being Nat such that A31: u = ( j * w ) by NAT_D:def 3;
( ( ( j |^ y ) * k ) * j ) = ( ( m * w ) * j ) by A24,A30,A31;
then ( ( j |^ y ) * k ) = ( m * w ) by XCMPLX_1:5;
then m divides ( ( j |^ y ) * k ) by NAT_D:def 3;
then A32: ( n lcm m ) divides ( ( j |^ y ) * k ) by A26,NAT_D:def 4;
( 0 ) <> k by A23,INT_2:4;
then ( j |^ ( y + 1 ) ) <= ( j |^ y ) by A23,A32,NAT_D:7,XREAL_1:68;
then ( ( j |^ y ) * j ) <= ( ( j |^ y ) * 1 ) by NEWTON:6;
then j <= 1 by XREAL_1:68;
hence contradiction by INT_2:def 4;
end;
A33: y <= z by A8,A15,CKB7:1;
( rhs . j ) = y by A9,A16,CKB36:def 1;
hence thesis by A2,A33,A17,XXREAL_0:1;
end;
suppose A34: ( ( pfexp n ) . j ) > ( ( pfexp m ) . j );

A35:now
consider p being Nat such that A36: x = ( y + p ) by A3,A9,A34,NAT_1:10;
consider t being Nat such that A37: m = ( ( j |^ y ) * t ) by A14,NAT_D:def 3;
A38:now
assume j divides t;
then consider w being Nat such that A39: t = ( j * w ) by NAT_D:def 3;
m = ( ( ( j |^ y ) * j ) * w ) by A37,A39
.= ( ( j |^ ( y + 1 ) ) * w ) by NEWTON:6;
hence contradiction by A13,NAT_D:def 3;
end;
consider u being Nat such that A40: ( n lcm m ) = ( m * u ) by A1,NAT_D:def 3;
assume x < z;
then ( j |^ ( x + 1 ) ) divides ( n lcm m ) by A7,CKB7:1;
then consider k being Nat such that A41: ( n lcm m ) = ( ( j |^ ( x + 1 ) ) * k ) by NAT_D:def 3;
A42: ( n lcm m ) = ( ( ( j |^ x ) * j ) * k ) by A41,NEWTON:6
.= ( ( j |^ x ) * ( k * j ) );
( ( j |^ y ) * ( ( j |^ p ) * ( k * j ) ) ) = ( ( ( j |^ y ) * ( j |^ p ) ) * ( k * j ) )
.= ( ( j |^ y ) * ( t * u ) ) by A42,A37,A40,A36,NEWTON:8;
then ( t * u ) = ( ( ( j |^ p ) * k ) * j ) by XCMPLX_1:5;
then j divides ( t * u ) by NAT_D:def 3;
then j divides u by A38,NEWTON:80;
then consider w being Nat such that A43: u = ( j * w ) by NAT_D:def 3;
( ( ( j |^ x ) * k ) * j ) = ( ( m * w ) * j ) by A42,A40,A43;
then ( ( j |^ x ) * k ) = ( m * w ) by XCMPLX_1:5;
then A44: m divides ( ( j |^ x ) * k ) by NAT_D:def 3;
consider t being Nat such that A45: n = ( ( j |^ x ) * t ) by A11,NAT_D:def 3;
A46:now
assume j divides t;
then consider w being Nat such that A47: t = ( j * w ) by NAT_D:def 3;
n = ( ( ( j |^ x ) * j ) * w ) by A45,A47
.= ( ( j |^ ( x + 1 ) ) * w ) by NEWTON:6;
hence contradiction by A5,NAT_D:def 3;
end;
consider u being Nat such that A48: ( n lcm m ) = ( n * u ) by A10,NAT_D:def 3;
( ( j |^ x ) * ( k * j ) ) = ( ( j |^ x ) * ( t * u ) ) by A42,A45,A48;
then ( k * j ) = ( t * u ) by XCMPLX_1:5;
then j divides ( t * u ) by NAT_D:def 3;
then j divides u by A46,NEWTON:80;
then consider w being Nat such that A49: u = ( j * w ) by NAT_D:def 3;
( ( ( j |^ x ) * k ) * j ) = ( ( n * w ) * j ) by A42,A48,A49;
then ( ( j |^ x ) * k ) = ( n * w ) by XCMPLX_1:5;
then n divides ( ( j |^ x ) * k ) by NAT_D:def 3;
then A50: ( n lcm m ) divides ( ( j |^ x ) * k ) by A44,NAT_D:def 4;
( 0 ) <> k by A41,INT_2:4;
then ( j |^ ( x + 1 ) ) <= ( j |^ x ) by A41,A50,NAT_D:7,XREAL_1:68;
then ( ( j |^ x ) * j ) <= ( ( j |^ x ) * 1 ) by NEWTON:6;
then j <= 1 by XREAL_1:68;
hence contradiction by INT_2:def 4;
end;
A51: x <= z by A8,A12,CKB7:1;
( rhs . j ) = x by A3,A34,CKB36:def 1;
hence thesis by A2,A51,A35,XXREAL_0:1;
end;
end;

end;
hence thesis by PBOOLE:3;
end;
