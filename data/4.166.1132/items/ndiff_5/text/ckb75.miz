environ
vocabularies NUMBERS,REAL_1,ZFMISC_1,NORMSP_1,PRE_TOPC,PARTFUN1,FUNCT_1,FUNCT_4,NAT_1,FDIFF_1,SUBSET_1,SEQ_4,RELAT_1,GLIB_000,LOPBAN_1,ORDINAL4,RFINSEQ,RCOMP_1,TARSKI,SEQ_1,ARYTM_3,VALUED_1,FUNCT_2,ARYTM_1,SEQ_2,ORDINAL2,SUPINF_2,FCONT_1,COMPLEX1,STRUCT_0,CARD_1,VALUED_0,XXREAL_0,GROUP_2,FUNCOP_1,XREAL_0,ORDINAL1,MEMBERED,FINSEQ_5,XXREAL_2,XBOOLE_0,CARD_3,FINSEQ_1,FINSEQ_2,AFINSQ_1,RLVECT_1,SQUARE_1,RVSUM_1,XXREAL_1,PDIFF_1,PRVECT_1,PRVECT_2,ALGSTR_0,EUCLID,CFCONT_1,RFINSEQ2,NORMSP_0,NFCONT_1,MONOID_0,RLTOPSP1;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,FUNCT_4,CARD_1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,SQUARE_1,NAT_1,MEMBERED,VALUED_0,COMPLEX1,NAT_D,BINOP_2,XXREAL_2,CARD_3,FINSEQ_1,VALUED_1,FINSEQ_2,SEQ_1,SEQ_2,RVSUM_1,RFINSEQ,SEQ_4,RCOMP_1,FCONT_1,FDIFF_1,FINSEQ_5,FINSEQ_7,RFINSEQ2,STRUCT_0,MONOID_0,ALGSTR_0,PRE_TOPC,RLVECT_1,NORMSP_0,NORMSP_1,VFUNCT_1,EUCLID,LOPBAN_1,PRVECT_1,NFCONT_1,NDIFF_1,PRVECT_2,NFCONT_3,NDIFF_3,RLTOPSP1,FUNCT_7,CKB11,CKB14,CKB22,CKB23,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB42;
definitions TARSKI,FUNCT_2,RLVECT_1,LOPBAN_1,EUCLID,RFINSEQ2,FINSEQ_1,FINSEQ_2,STRUCT_0,MONOID_0,ALGSTR_0,NORMSP_0,RCOMP_1,XCMPLX_0,PRVECT_2,CKB14,CKB22,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB42;
theorems TARSKI,ABSVALUE,XBOOLE_0,XBOOLE_1,RLVECT_1,XCMPLX_0,XCMPLX_1,ZFMISC_1,SEQ_1,SEQ_2,NAT_1,RELAT_1,FUNCT_1,VFUNCT_1,FUNCT_2,FUNCT_3,FINSEQ_4,RLVECT_2,FINSEQ_3,ORDINAL1,FINSEQ_1,CARD_3,FUNCT_4,SEQ_4,NORMSP_1,LOPBAN_1,PARTFUN1,PARTFUN2,NFCONT_1,FDIFF_1,NDIFF_1,FUNCOP_1,XREAL_1,COMPLEX1,XXREAL_0,VALUED_1,VALUED_0,GRCAT_1,NORMSP_0,XREAL_0,RCOMP_1,FINSEQ_2,FINSEQ_7,RVSUM_1,SQUARE_1,PRVECT_1,PRVECT_2,PDIFF_7,EUCLID,TOPREAL7,XXREAL_2,FINSEQ_5,NAT_D,RFINSEQ2,INTEGRA5,FCONT_1,NAT_2,NFCONT_3,NDIFF_2,NDIFF_3,CARD_1,ROLLE,XXREAL_1,RLTOPSP1,FUNCT_7,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB12,CKB13,CKB14,CKB18,CKB19,CKB20,CKB21,CKB22,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74;
schemes FUNCT_2,SEQ_1,FINSEQ_1,NAT_1,FINSEQ_2;
registrations RELSET_1,STRUCT_0,ORDINAL1,XREAL_0,MEMBERED,FUNCT_1,NDIFF_1,FUNCT_2,NUMBERS,XBOOLE_0,VALUED_0,PRVECT_2,FINSEQ_2,FINSEQ_1,CARD_3,NORMSP_0,NORMSP_1,RELAT_1,XXREAL_0,LOPBAN_1,LOPBAN_2,PRVECT_3,FUNCOP_1,NAT_1,FINSEQ_5,XXREAL_2,RCOMP_1,VALUED_1,FDIFF_1,NFCONT_3,FINSET_1,XCMPLX_0,PARTFUN1,CARD_1,MONOID_0,CKB10,CKB15,CKB16,CKB17,CKB49;
constructors REAL_1,SQUARE_1,SEQ_2,FDIFF_1,NFCONT_1,RSSPACE,VFUNCT_1,NDIFF_1,SEQ_1,RELSET_1,FINSEQ_7,FINSEQ_5,RVSUM_1,BINOP_2,PRVECT_2,RLVECT_2,NAT_D,FINSEQOP,RFINSEQ,RFINSEQ2,SEQ_4,FCONT_1,NFCONT_3,NDIFF_3,MONOID_0,RLTOPSP1,FUNCT_7,CKB11,CKB14,CKB22,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB42;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve j for set;
reserve S for non  trivial RealNormSpace;
reserve T for non  trivial RealNormSpace;
reserve g for (PartFunc of S,T);
reserve R for (REST of S,T);
reserve G for  non-trivial RealNormSpace-Sequence;
reserve F for non  trivial RealNormSpace;
reserve i for (Element of ( dom G ));
reserve f for (PartFunc of ( product G ),F);
reserve x for (Point of ( product G ));
reserve X for set;
theorem
Th48X: (for G being  non-trivial RealNormSpace-Sequence holds (for S being non  trivial RealNormSpace holds (for f being (PartFunc of ( product G ),S) holds (for X being (Subset of ( product G )) holds (for x being (Point of ( product G )) holds (((X is  open & x in X) & (for i being set holds (i in ( dom G ) implies (f is_partial_differentiable_on X,i & ( f `partial| (X,i) ) is_continuous_on X)))) implies (f is_differentiable_in x & (for h being (Point of ( product G )) holds (ex w being (FinSequence of S) st ((( dom w ) = ( dom G ) & (for i being set holds (i in ( dom G ) implies ( w . i ) = ( ( partdiff (f,x,i) ) . ( ( proj ( modetrans (G,i) ) ) . h ) )))) & ( ( diff (f,x) ) . h ) = ( Sum w )))))))))))
proof
let G being  non-trivial RealNormSpace-Sequence;
let S being non  trivial RealNormSpace;
let f being (PartFunc of ( product G ),S);
let X being (Subset of ( product G ));
let x being (Point of ( product G ));
assume A1: ((X is  open & x in X) & (for i being set holds (i in ( dom G ) implies (f is_partial_differentiable_on X,i & ( f `partial| (X,i) ) is_continuous_on X))));
set m = ( len G );
CG2: ( dom G ) = ( Seg m ) by FINSEQ_1:def 3;
reconsider Z0 = ( 0. ( product G ) ) as (Element of ( product ( carr G ) )) by CKB12:1;
reconsider x0 = x as (Element of ( product ( carr G ) )) by CKB12:1;
reconsider x1 = x as ( len G ) -element FinSequence;
reconsider Z1 = ( 0. ( product G ) ) as ( len G ) -element FinSequence;
consider L being  bounded (LinearOperator of ( product G ),S) such that A2: (for h being (Point of ( product G )) holds (ex w being (FinSequence of S) st ((( dom w ) = ( Seg m ) & (for i being (Element of ( NAT )) holds (i in ( Seg m ) implies ( w . i ) = ( ( partdiff (f,x,i) ) . ( ( proj ( modetrans (G,i) ) ) . h ) )))) & ( L . h ) = ( Sum w )))) by CKB60:1;
A200: (for h being (Point of ( product G )) holds (ex w being (FinSequence of S) st ((( dom w ) = ( dom G ) & (for i being set holds (i in ( dom G ) implies ( w . i ) = ( ( partdiff (f,x,i) ) . ( ( proj ( modetrans (G,i) ) ) . h ) )))) & ( L . h ) = ( Sum w ))))
proof
let h being (Point of ( product G ));
consider w being (FinSequence of S) such that X1: ((( dom w ) = ( Seg m ) & (for i being (Element of ( NAT )) holds (i in ( Seg m ) implies ( w . i ) = ( ( partdiff (f,x,i) ) . ( ( proj ( modetrans (G,i) ) ) . h ) )))) & ( L . h ) = ( Sum w )) by A2;
take w;
thus ( dom w ) = ( dom G ) by X1,FINSEQ_1:def 3;
thus thesis by X1,CG2;
end;
consider d0 being Real such that A3: d0 > ( 0 ) and A4: { y where y is (Element of ( product G )): ||. ( y - x ) .|| < d0 } c= X by A1,NDIFF_1:3;
set N = { y where y is (Element of ( product G )): ||. ( y - x ) .|| < d0 };
N c= (the carrier of ( product G )) by A4,XBOOLE_1:1;
then A300: N is (Neighbourhood of x) by A3,NFCONT_1:def 1;
A301: 1 <= m by NAT_1:14;
then m in ( dom G ) by CG2;
then f is_partial_differentiable_on X,m by A1;
then X c= ( dom f ) by CKB36:def 1;
then A5: N c= ( dom f ) by A4,XBOOLE_1:1;
deffunc RF((Element of ( product G ))) = ( ( ( f /. ( x + $1 ) ) - ( f /. x ) ) - ( L . $1 ) );
consider R being (Function of (the carrier of ( product G )),(the carrier of S)) such that A6: (for h being (Element of (the carrier of ( product G ))) holds ( R . h ) = RF(h)) from FUNCT_2:sch 4;
now
let r0 being Real;
assume A9: r0 > ( 0 );
set r1 = ( r0 / 2 );
set r = ( r1 / m );
defpred DSQ[ Nat,(Element of ( REAL )) ]
 means
(ex k being (Element of ( NAT )) st (($1 = k & ( 0 ) < $2) & (for q being (Element of ( product G )) holds ((q in X & ||. ( q - x ) .|| < $2) implies ||. ( ( partdiff (f,q,k) ) - ( partdiff (f,x,k) ) ) .|| < r))));
A10: (for k0 being Nat holds (k0 in ( Seg m ) implies (ex d being (Element of ( REAL )) st DSQ[ k0,d ])))
proof
let k0 being Nat;
assume A11: k0 in ( Seg m );
reconsider k = k0 as (Element of ( NAT )) by ORDINAL1:def 12;
( f `partial| (X,k) ) is_continuous_on X by CG2,A11,A1;
then consider d being Real such that A13: (( 0 ) < d & (for q being (Point of ( product G )) holds ((q in X & ||. ( q - x ) .|| < d) implies ||. ( ( ( f `partial| (X,k) ) /. q ) - ( ( f `partial| (X,k) ) /. x ) ) .|| < r))) by A9,A1,NFCONT_1:19;
take d;
(for q being (Point of ( product G )) holds ((q in X & ||. ( q - x ) .|| < d) implies ||. ( ( partdiff (f,q,k) ) - ( partdiff (f,x,k) ) ) .|| < r))
proof
let q being (Point of ( product G ));
assume A14: (q in X & ||. ( q - x ) .|| < d);
then A15: ||. ( ( ( f `partial| (X,k) ) /. q ) - ( ( f `partial| (X,k) ) /. x ) ) .|| < r by A13;
A16: f is_partial_differentiable_on X,k by A1,A11,CG2;
then ( ( f `partial| (X,k) ) /. q ) = ( partdiff (f,q,k) ) by A14,A11,CG2,CKB42:def 1;
hence ||. ( ( partdiff (f,q,k) ) - ( partdiff (f,x,k) ) ) .|| < r by A15,A16,A1,A11,CG2,CKB42:def 1;
end;
hence (ex k being (Element of ( NAT )) st ((k0 = k & ( 0 ) < d) & (for q being (Element of ( product G )) holds ((q in X & ||. ( q - x ) .|| < d) implies ||. ( ( partdiff (f,q,k) ) - ( partdiff (f,x,k) ) ) .|| < r)))) by A13;
end;
consider Dseq being (FinSequence of ( REAL )) such that A17: (( dom Dseq ) = ( Seg m ) & (for i being Nat holds (i in ( Seg m ) implies DSQ[ i,( Dseq . i ) ]))) from FINSEQ_1:sch 5(A10);
m in ( Seg m ) by A301;
then reconsider rDseq = ( rng Dseq ) as non  empty  ext-real-membered set by A17,FUNCT_1:3;
reconsider rDseq as  left_end  right_end non  empty  ext-real-membered set;
A19: ( min rDseq ) in ( rng Dseq ) by XXREAL_2:def 7;
then reconsider d1 = ( min rDseq ) as Real;
set d = ( min (d0,d1) );
B1: (d <= d0 & d <= d1) by XXREAL_0:17;
consider i1 being set such that A20: (i1 in ( dom Dseq ) & d1 = ( Dseq . i1 )) by A19,FUNCT_1:def 3;
reconsider i1 as Nat by A20;
A21: (ex k being (Element of ( NAT )) st ((i1 = k & ( 0 ) < ( Dseq . i1 )) & (for q being (Element of ( product G )) holds ((q in X & ||. ( q - x ) .|| < ( Dseq . i1 )) implies ||. ( ( partdiff (f,q,k) ) - ( partdiff (f,x,k) ) ) .|| < r)))) by A17,A20;
A22:now
let q being (Element of ( product G ));
assume ||. ( q - x ) .|| < d;
then ||. ( q - x ) .|| < d0 by B1,XXREAL_0:2;
then q in { y where y is (Element of ( product G )): ||. ( y - x ) .|| < d0 };
hence q in X by A4;
end;
A24:now
let q being (Element of ( product G ));
let i being (Element of ( NAT ));
assume A25: (||. ( q - x ) .|| < d & i in ( Seg m ));
reconsider i0 = i as Nat;
consider k being (Element of ( NAT )) such that A26: ((i0 = k & ( 0 ) < ( Dseq . i0 )) & (for q being (Element of ( product G )) holds ((q in X & ||. ( q - x ) .|| < ( Dseq . i0 )) implies ||. ( ( partdiff (f,q,k) ) - ( partdiff (f,x,k) ) ) .|| < r))) by A17,A25;
( Dseq . i0 ) in ( rng Dseq ) by A17,A25,FUNCT_1:3;
then d1 <= ( Dseq . i0 ) by XXREAL_2:def 7;
then d <= ( Dseq . i0 ) by B1,XXREAL_0:2;
then ||. ( q - x ) .|| < ( Dseq . i0 ) by A25,XXREAL_0:2;
hence ||. ( ( partdiff (f,q,i) ) - ( partdiff (f,x,i) ) ) .|| < r by A22,A25,A26;
end;
take d;
thus ( 0 ) < d by A3,A20,A21,XXREAL_0:21;
thus (for y being (Point of ( product G )) holds ((y <> ( 0. ( product G ) ) & ||. y .|| < d) implies ( ( ||. y .|| " ) * ||. ( R /. y ) .|| ) < r0))
proof
let y being (Point of ( product G ));
assume A28: (y <> ( 0. ( product G ) ) & ||. y .|| < d);
then A280: ( 0 ) <> ||. y .|| by NORMSP_0:def 5;
set z = ( R /. y );
consider h being (FinSequence of ( product G )),g being (FinSequence of S),Z,y0 being (Element of ( product ( carr G ) )) such that A29: (((((((y0 = y & Z = ( 0. ( product G ) )) & ( len h ) = ( ( len G ) + 1 )) & ( len g ) = ( len G )) & (for i being Nat holds (i in ( dom h ) implies ( h /. i ) = ( Z +* ( y0 | ( Seg ( ( ( len G ) + 1 ) -' i ) ) ) )))) & (for i being Nat holds (i in ( dom g ) implies ( g /. i ) = ( ( f /. ( x + ( h /. i ) ) ) - ( f /. ( x + ( h /. ( i + 1 ) ) ) ) )))) & (for i being Nat holds (for hi being (Point of ( product G )) holds ((i in ( dom h ) & ( h /. i ) = hi) implies ||. hi .|| <= ||. y .||)))) & ( ( f /. ( x + y ) ) - ( f /. x ) ) = ( Sum g )) by CKB64:1;
consider w being (FinSequence of S) such that A31: ((( dom w ) = ( Seg m ) & (for i being (Element of ( NAT )) holds (i in ( Seg m ) implies ( w . i ) = ( ( partdiff (f,x,i) ) . ( ( proj ( modetrans (G,i) ) ) . y ) )))) & ( L . y ) = ( Sum w )) by A2;
A32: (( dom ( idseq m ) ) = ( Seg m ) & ( rng ( idseq m ) ) = ( Seg m )) by FUNCT_2:def 1,FUNCT_2:def 3;
then A33: (( dom ( Rev ( idseq m ) ) ) = ( Seg m ) & ( rng ( Rev ( idseq m ) ) ) = ( Seg m )) by FINSEQ_5:57;
then reconsider Ri = ( Rev ( idseq m ) ) as (Function of ( Seg m ),( Seg m )) by FUNCT_2:1;
Ri is  one-to-one  onto by A33,FUNCT_2:def 3;
then reconsider Ri = ( Rev ( idseq m ) ) as (Permutation of ( dom w )) by A31;
A39: (( len ( idseq m ) ) = m & ( len w ) = m) by A31,A32,FINSEQ_1:def 3;
( dom ( w * Ri ) ) = ( dom Ri ) by A33,RELAT_1:27;
then A35: ( dom ( w * Ri ) ) = ( dom ( Rev w ) ) by A33,A31,FINSEQ_5:57;
reconsider wRi = ( w * Ri ) as (FinSequence of S) by FINSEQ_2:47;
now
let k being Nat;
assume A36: k in ( dom ( Rev w ) );
then A37: k in ( dom ( Rev ( idseq m ) ) ) by A33,A31,FINSEQ_5:57;
then A38: (1 <= k & k <= m) by A33,FINSEQ_1:1;
then reconsider mk = ( m - k ) as Nat by NAT_1:21;
reconsider zr0 = ( 0 ) as Nat;
( 0 ) <= mk;
then A40: ( zr0 + 1 ) <= ( ( m - k ) + 1 ) by XREAL_1:6;
( k - 1 ) >= ( 1 - 1 ) by A38,XREAL_1:9;
then ( m - ( k - 1 ) ) <= m by XREAL_1:43;
then A41: ( mk + 1 ) in ( Seg m ) by A40;
( ( Rev w ) . k ) = ( w . ( ( ( len ( idseq m ) ) - k ) + 1 ) ) by A39,A36,FINSEQ_5:def 3
.= ( w . ( ( idseq m ) . ( ( ( len ( idseq m ) ) - k ) + 1 ) ) ) by A41,A39,FINSEQ_2:49
.= ( w . ( ( Rev ( idseq m ) ) . k ) ) by A37,FINSEQ_5:def 3;
hence ( ( Rev w ) . k ) = ( wRi . k ) by A36,A35,FUNCT_1:12;
end;
then A42: ( Sum ( Rev w ) ) = ( Sum w ) by A35,FINSEQ_1:13,RLVECT_2:7;
deffunc GW(Nat) = ( ( g /. $1 ) - ( ( Rev w ) /. $1 ) );
consider gw being (FinSequence of S) such that A43: (( len gw ) = m & (for j being Nat holds (j in ( dom gw ) implies ( gw . j ) = GW(j)))) from FINSEQ_2:sch 1;
A44:now
let j being (Element of ( NAT ));
assume j in ( dom g );
then j in ( Seg m ) by A29,FINSEQ_1:def 3;
then j in ( dom gw ) by A43,FINSEQ_1:def 3;
hence ( gw . j ) = ( ( g /. j ) - ( ( Rev w ) /. j ) ) by A43;
end;
( len ( Rev w ) ) = ( len g ) by A29,A39,FINSEQ_5:def 3;
then ( Sum gw ) = ( ( Sum g ) - ( Sum ( Rev w ) ) ) by A29,A43,A44,RLVECT_2:5;
then A47: ( R /. y ) = ( Sum gw ) by A6,A29,A31,A42;
A48: (for j being (Element of ( NAT )) holds (j in ( dom gw ) implies ||. ( gw /. j ) .|| <= ( ||. y .|| * r )))
proof
let j being (Element of ( NAT ));
assume A49: j in ( dom gw );
then A50: j in ( Seg m ) by A43,FINSEQ_1:def 3;
then A500: j in ( dom g ) by A29,FINSEQ_1:def 3;
then A51: ( g /. j ) = ( ( f /. ( x + ( h /. j ) ) ) - ( f /. ( x + ( h /. ( j + 1 ) ) ) ) ) by A29;
A52: (1 <= j & j <= m) by A50,FINSEQ_1:1;
then A54: (( m + 1 ) <= ( m + j ) & ( j + 1 ) <= ( m + 1 )) by XREAL_1:6;
then (( ( m + 1 ) - j ) <= m & 1 <= ( ( m + 1 ) - j )) by XREAL_1:19,XREAL_1:20;
then (( ( m + 1 ) -' j ) <= m & 1 <= ( ( m + 1 ) -' j )) by A52,NAT_D:37;
then A56: ( ( m + 1 ) -' j ) in ( Seg m );
then f is_partial_differentiable_on X,( ( m + 1 ) -' j ) by A1,CG2;
then A55: (X c= ( dom f ) & (for x being (Element of ( product G )) holds (x in X implies f is_partial_differentiable_in x,( ( m + 1 ) -' j )))) by CKB40:1,A1;
( w /. ( ( m + 1 ) -' j ) ) = ( w . ( ( m + 1 ) -' j ) ) by A31,A56,PARTFUN1:def 6;
then A57: ( w /. ( ( m + 1 ) -' j ) ) = ( ( partdiff (f,x,( ( m + 1 ) -' j )) ) . ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . y ) ) by A56,A31;
A58:now
let j being (Element of ( NAT ));
reconsider hj = ( h /. j ) as (Element of ( product G ));
assume (1 <= j & j <= ( m + 1 ));
then j in ( dom h ) by A29,FINSEQ_3:25;
then A59: ||. hj .|| <= ||. y .|| by A29;
( ( x + ( h /. j ) ) - x ) = ( ( h /. j ) + ( x - x ) ) by RLVECT_1:28
.= ( ( h /. j ) + ( 0. ( product G ) ) ) by RLVECT_1:15;
then ( ( x + ( h /. j ) ) - x ) = ( h /. j ) by RLVECT_1:4;
hence ||. ( ( x + ( h /. j ) ) - x ) .|| < d by A59,A28,XXREAL_0:2;
end;
m <= ( m + 1 ) by NAT_1:11;
then ( Seg m ) c= ( Seg ( m + 1 ) ) by FINSEQ_1:5;
then (1 <= j & j <= ( m + 1 )) by A50,FINSEQ_1:1;
then A62: ||. ( ( x + ( h /. j ) ) - x ) .|| < d by A58;
1 <= ( j + 1 ) by NAT_1:11;
then A68: ||. ( ( x + ( h /. ( j + 1 ) ) ) - x ) .|| < d by A54,A58;
A75: ( x + ( h /. j ) ) = ( ( reproj (( modetrans (G,( ( m + 1 ) -' j )) ),( x + ( h /. ( j + 1 ) ) )) ) . ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . ( x + y ) ) ) by CKB73:1,A29,A52;
Y5: ( ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . ( x + y ) ) - ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . ( x + ( h /. ( j + 1 ) ) ) ) ) = ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . y ) by CKB74:1,A29,A52;
(for z being (Point of ( product G )) holds (||. ( z - x ) .|| < d implies ||. ( ( partdiff (f,z,( ( m + 1 ) -' j )) ) - ( partdiff (f,x,( ( m + 1 ) -' j )) ) ) .|| <= r)) by A24,A56;
then XXX: ||. ( ( ( f /. ( x + ( h /. j ) ) ) - ( f /. ( x + ( h /. ( j + 1 ) ) ) ) ) - ( ( partdiff (f,x,( ( m + 1 ) -' j )) ) . ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . y ) ) ) .|| <= ( ||. ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . y ) .|| * r ) by A1,A55,A56,CG2,A22,A62,A68,A75,Y5,CKB72:1;
A89: ( ( m + 1 ) -' j ) = ( ( m + 1 ) - j ) by A52,NAT_1:12,XREAL_1:233;
j in ( Seg ( len ( Rev w ) ) ) by A50,A39,FINSEQ_5:def 3;
then A90: j in ( dom ( Rev w ) ) by FINSEQ_1:def 3;
then A901: ( ( Rev w ) /. j ) = ( ( Rev w ) . j ) by PARTFUN1:def 6
.= ( w . ( ( m - j ) + 1 ) ) by A39,A90,FINSEQ_5:def 3
.= ( w /. ( ( m + 1 ) -' j ) ) by A89,A56,A31,PARTFUN1:def 6;
A92: ( gw /. j ) = ( gw . j ) by A49,PARTFUN1:def 6
.= ( ( ( f /. ( x + ( h /. j ) ) ) - ( f /. ( x + ( h /. ( j + 1 ) ) ) ) ) - ( ( partdiff (f,x,( ( m + 1 ) -' j )) ) . ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . y ) ) ) by A57,A51,A901,A500,A44;
( ||. ( ( proj ( modetrans (G,( ( m + 1 ) -' j )) ) ) . y ) .|| * r ) <= ( ||. y .|| * r ) by A9,CKB48:1,XREAL_1:64;
hence ||. ( gw /. j ) .|| <= ( ||. y .|| * r ) by A92,XXX,XXREAL_0:2;
end;
defpred YSQ[ set,set ]
 means
$2 = ||. ( gw /. $1 ) .||;
A93: (for k being Nat holds (k in ( Seg m ) implies (ex x being (Element of ( REAL )) st YSQ[ k,x ])));
consider yseq being (FinSequence of ( REAL )) such that A94: (( dom yseq ) = ( Seg m ) & (for i being Nat holds (i in ( Seg m ) implies YSQ[ i,( yseq . i ) ]))) from FINSEQ_1:sch 5(A93);
A95: ( len gw ) = ( len yseq ) by A43,A94,FINSEQ_1:def 3;
A96:now
let i being (Element of ( NAT ));
assume i in ( dom gw );
then i in ( Seg m ) by A43,FINSEQ_1:def 3;
hence ( yseq . i ) = ||. ( gw /. i ) .|| by A94;
end;
reconsider yseq as (Element of ( REAL m )) by A95,A43,FINSEQ_2:92;
A97: ||. ( Sum gw ) .|| <= ( Sum yseq ) by A96,A95,CKB7:1;
(for j being Nat holds (j in ( Seg m ) implies ( yseq . j ) <= ( ( m |-> ( ||. y .|| * r ) ) . j )))
proof
let j being Nat;
assume A98: j in ( Seg m );
then j in ( dom gw ) by A43,FINSEQ_1:def 3;
then A100: ||. ( gw /. j ) .|| <= ( ||. y .|| * r ) by A48;
( yseq . j ) = ||. ( gw /. j ) .|| by A94,A98;
hence ( yseq . j ) <= ( ( m |-> ( ||. y .|| * r ) ) . j ) by A98,A100,FINSEQ_2:57;
end;
then ( Sum yseq ) <= ( Sum ( m |-> ( ||. y .|| * r ) ) ) by RVSUM_1:82;
then ( Sum yseq ) <= ( m * ( ||. y .|| * r ) ) by RVSUM_1:80;
then ||. z .|| <= ( m * ( ||. y .|| * r ) ) by A47,A97,XXREAL_0:2;
then ( ||. z .|| * ( ||. y .|| " ) ) <= ( ( ( m * ||. y .|| ) * r ) * ( ||. y .|| " ) ) by XREAL_1:64;
then ( ||. z .|| * ( ||. y .|| " ) ) <= ( m * ( ( r * ||. y .|| ) * ( ||. y .|| " ) ) );
then ( ( ||. y .|| " ) * ||. z .|| ) <= ( m * r ) by A280,XCMPLX_1:203;
then A101: ( ( ||. y .|| " ) * ||. z .|| ) <= r1 by XCMPLX_1:87;
r1 < r0 by A9,XREAL_1:216;
hence ( ( ||. y .|| " ) * ||. z .|| ) < r0 by A101,XXREAL_0:2;
end;

end;
then reconsider R as (REST of ( product G ),S) by NDIFF_1:23;
reconsider L as (Point of ( R_NormSpace_of_BoundedLinearOperators (( product G ),S) )) by LOPBAN_1:def 9;
AD0: (for y being (Point of ( product G )) holds (y in N implies ( ( f /. y ) - ( f /. x ) ) = ( ( L . ( y - x ) ) + ( R /. ( y - x ) ) )))
proof
let y being (Point of ( product G ));
assume y in N;
( y - x ) in (the carrier of ( product G ));
then ( y - x ) in ( dom R ) by PARTFUN1:def 2;
then ( R /. ( y - x ) ) = ( R . ( y - x ) ) by PARTFUN1:def 6;
then ( R /. ( y - x ) ) = ( ( ( f /. ( x + ( y - x ) ) ) - ( f /. x ) ) - ( L . ( y - x ) ) ) by A6;
hence ( ( L . ( y - x ) ) + ( R /. ( y - x ) ) ) = ( ( ( f /. ( x + ( y - x ) ) ) - ( f /. x ) ) - ( ( L . ( y - x ) ) - ( L . ( y - x ) ) ) ) by RLVECT_1:29
.= ( ( ( f /. ( x + ( y - x ) ) ) - ( f /. x ) ) - ( 0. S ) ) by RLVECT_1:5
.= ( ( f /. ( x + ( y - x ) ) ) - ( f /. x ) ) by RLVECT_1:13
.= ( ( f /. ( y - ( x - x ) ) ) - ( f /. x ) ) by RLVECT_1:29
.= ( ( f /. ( y - ( 0. ( product G ) ) ) ) - ( f /. x ) ) by RLVECT_1:5
.= ( ( f /. y ) - ( f /. x ) ) by RLVECT_1:13;
end;
then f is_differentiable_in x by A5,A300,NDIFF_1:def 6;
then ( diff (f,x) ) = L by A300,A5,AD0,NDIFF_1:def 7;
hence thesis by A200,AD0,A5,A300,NDIFF_1:def 6;
end;
