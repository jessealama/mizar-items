environ
vocabularies NUMBERS,REAL_1,ZFMISC_1,NORMSP_1,PRE_TOPC,PARTFUN1,FUNCT_1,FUNCT_4,NAT_1,FDIFF_1,SUBSET_1,SEQ_4,RELAT_1,GLIB_000,LOPBAN_1,ORDINAL4,RFINSEQ,RCOMP_1,TARSKI,SEQ_1,ARYTM_3,VALUED_1,FUNCT_2,ARYTM_1,SEQ_2,ORDINAL2,SUPINF_2,FCONT_1,COMPLEX1,STRUCT_0,CARD_1,VALUED_0,XXREAL_0,GROUP_2,FUNCOP_1,XREAL_0,ORDINAL1,MEMBERED,FINSEQ_5,XXREAL_2,XBOOLE_0,CARD_3,FINSEQ_1,FINSEQ_2,AFINSQ_1,RLVECT_1,SQUARE_1,RVSUM_1,XXREAL_1,PDIFF_1,PRVECT_1,PRVECT_2,ALGSTR_0,EUCLID,CFCONT_1,RFINSEQ2,NORMSP_0,NFCONT_1,MONOID_0,RLTOPSP1;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,RELSET_1,PARTFUN1,FUNCT_2,FUNCOP_1,FUNCT_4,CARD_1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,SQUARE_1,NAT_1,MEMBERED,VALUED_0,COMPLEX1,NAT_D,BINOP_2,XXREAL_2,CARD_3,FINSEQ_1,VALUED_1,FINSEQ_2,SEQ_1,SEQ_2,RVSUM_1,RFINSEQ,SEQ_4,RCOMP_1,FCONT_1,FDIFF_1,FINSEQ_5,FINSEQ_7,RFINSEQ2,STRUCT_0,MONOID_0,ALGSTR_0,PRE_TOPC,RLVECT_1,NORMSP_0,NORMSP_1,VFUNCT_1,EUCLID,LOPBAN_1,PRVECT_1,NFCONT_1,NDIFF_1,PRVECT_2,NFCONT_3,NDIFF_3,RLTOPSP1,FUNCT_7,CKB11,CKB14,CKB22,CKB23;
definitions TARSKI,FUNCT_2,RLVECT_1,LOPBAN_1,EUCLID,RFINSEQ2,FINSEQ_1,FINSEQ_2,STRUCT_0,MONOID_0,ALGSTR_0,NORMSP_0,RCOMP_1,XCMPLX_0,PRVECT_2,CKB14,CKB22;
theorems TARSKI,ABSVALUE,XBOOLE_0,XBOOLE_1,RLVECT_1,XCMPLX_0,XCMPLX_1,ZFMISC_1,SEQ_1,SEQ_2,NAT_1,RELAT_1,FUNCT_1,VFUNCT_1,FUNCT_2,FUNCT_3,FINSEQ_4,RLVECT_2,FINSEQ_3,ORDINAL1,FINSEQ_1,CARD_3,FUNCT_4,SEQ_4,NORMSP_1,LOPBAN_1,PARTFUN1,PARTFUN2,NFCONT_1,FDIFF_1,NDIFF_1,FUNCOP_1,XREAL_1,COMPLEX1,XXREAL_0,VALUED_1,VALUED_0,GRCAT_1,NORMSP_0,XREAL_0,RCOMP_1,FINSEQ_2,FINSEQ_7,RVSUM_1,SQUARE_1,PRVECT_1,PRVECT_2,PDIFF_7,EUCLID,TOPREAL7,XXREAL_2,FINSEQ_5,NAT_D,RFINSEQ2,INTEGRA5,FCONT_1,NAT_2,NFCONT_3,NDIFF_2,NDIFF_3,CARD_1,ROLLE,XXREAL_1,RLTOPSP1,FUNCT_7,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB12,CKB13,CKB14,CKB18,CKB19,CKB20,CKB21,CKB22,CKB24,CKB25,CKB26,CKB27,CKB28;
schemes FUNCT_2,SEQ_1,FINSEQ_1,NAT_1,FINSEQ_2;
registrations RELSET_1,STRUCT_0,ORDINAL1,XREAL_0,MEMBERED,FUNCT_1,NDIFF_1,FUNCT_2,NUMBERS,XBOOLE_0,VALUED_0,PRVECT_2,FINSEQ_2,FINSEQ_1,CARD_3,NORMSP_0,NORMSP_1,RELAT_1,XXREAL_0,LOPBAN_1,LOPBAN_2,PRVECT_3,FUNCOP_1,NAT_1,FINSEQ_5,XXREAL_2,RCOMP_1,VALUED_1,FDIFF_1,NFCONT_3,FINSET_1,XCMPLX_0,PARTFUN1,CARD_1,MONOID_0,CKB10,CKB15,CKB16,CKB17;
constructors REAL_1,SQUARE_1,SEQ_2,FDIFF_1,NFCONT_1,RSSPACE,VFUNCT_1,NDIFF_1,SEQ_1,RELSET_1,FINSEQ_7,FINSEQ_5,RVSUM_1,BINOP_2,PRVECT_2,RLVECT_2,NAT_D,FINSEQOP,RFINSEQ,RFINSEQ2,SEQ_4,FCONT_1,NFCONT_3,NDIFF_3,MONOID_0,RLTOPSP1,FUNCT_7,CKB11,CKB14,CKB22;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve p for Real;
reserve S for non  trivial RealNormSpace;
reserve T for non  trivial RealNormSpace;
reserve F for non  trivial RealNormSpace;
reserve x0 for (Point of S);
reserve G for RealNormSpace-Sequence;
reserve f for (PartFunc of ( product G ),F);
reserve x for (Element of ( product G ));
LmX:now
let S being RealLinearSpace;
let p being (Point of S);
let q being (Point of S);
let z1 being Real;
thus ( p + ( z1 * ( q - p ) ) ) = ( p + ( ( z1 * q ) + ( z1 * ( - p ) ) ) ) by RLVECT_1:def 5
.= ( p + ( ( z1 * q ) + ( - ( z1 * p ) ) ) ) by RLVECT_1:25
.= ( ( p + ( - ( z1 * p ) ) ) + ( z1 * q ) ) by RLVECT_1:def 3
.= ( ( ( 1 * p ) - ( z1 * p ) ) + ( z1 * q ) ) by RLVECT_1:def 8
.= ( ( ( 1 - z1 ) * p ) + ( z1 * q ) ) by RLVECT_1:35;
end;
theorem
FDAF10: (for S,T being non  trivial RealNormSpace holds (for f being (PartFunc of S,T) holds (for p,q being (Point of S) holds (for M being Real holds (((([. p,q .] c= ( dom f ) & (for x being (Point of S) holds (x in [. p,q .] implies f is_continuous_in x))) & (for x being (Point of S) holds (x in ]. p,q .[ implies f is_differentiable_in x))) & (for x being (Point of S) holds (x in ]. p,q .[ implies ||. ( diff (f,x) ) .|| <= M))) implies ||. ( ( f /. q ) - ( f /. p ) ) .|| <= ( M * ||. ( q - p ) .|| ))))))
proof
let S being non  trivial RealNormSpace;
let T being non  trivial RealNormSpace;
let f being (PartFunc of S,T);
let p being (Point of S);
let q being (Point of S);
let M being Real;
assume AS1: ((([. p,q .] c= ( dom f ) & (for x being (Point of S) holds (x in [. p,q .] implies f is_continuous_in x))) & (for x being (Point of S) holds (x in ]. p,q .[ implies f is_differentiable_in x))) & (for x being (Point of S) holds (x in ]. p,q .[ implies ||. ( diff (f,x) ) .|| <= M)));
deffunc PP((Element of ( REAL ))) = ( ( $1 * ( q - p ) ) + p );
consider pt0 being (Function of ( REAL ),(the carrier of S)) such that D0: (for t being (Element of ( REAL )) holds ( pt0 . t ) = PP(t)) from FUNCT_2:sch 4;
set pt = ( pt0 | [. ( 0 ),1 .] );
D1: ( dom pt0 ) = ( REAL ) by FUNCT_2:def 1;
then D3: ( dom pt ) = [. ( 0 ),1 .] by RELAT_1:62;
now
let t being  real number;
assume t in [. ( 0 ),1 .];
D11: t is (Element of ( REAL )) by XREAL_0:def 1;
then ( pt0 /. t ) = ( pt0 . t ) by D1,PARTFUN1:def 6;
hence ( pt0 /. t ) = ( ( t * ( q - p ) ) + p ) by D0,D11;
end;
then D2: pt is  continuous by NFCONT_3:33;
D4: ]. ( 0 ),1 .[ c= [. ( 0 ),1 .] by XXREAL_1:25;
D5:now
let t being Real;
assume t in ]. ( 0 ),1 .[;
hence ( pt /. t ) = ( pt0 /. t ) by D3,D4,PARTFUN2:15
.= ( ( t * ( q - p ) ) + p ) by D0;
end;
then D6: (pt is_differentiable_on ]. ( 0 ),1 .[ & (for t being Real holds (t in ]. ( 0 ),1 .[ implies ( ( pt `| ]. ( 0 ),1 .[ ) . t ) = ( q - p )))) by D3,D4,NDIFF_3:21;
reconsider phi = ( f * pt ) as (PartFunc of ( REAL ),T);
D7: ( rng pt ) c= [. p,q .]
proof
let y being set;
assume y in ( rng pt );
then consider x being set such that X1: (x in ( dom pt ) & y = ( pt . x )) by FUNCT_1:def 3;
X2: y = ( pt0 . x ) by X1,FUNCT_1:47;
reconsider x as (Element of ( REAL )) by X1;
consider r being Real such that X3: ((x = r & ( 0 ) <= r) & r <= 1) by X1,D3;
y = ( p + ( x * ( q - p ) ) ) by D0,X2
.= ( ( ( 1 - x ) * p ) + ( x * q ) ) by LmX;
then y in { ( ( ( 1 - r1 ) * p ) + ( r1 * q ) ) where r1 is Real: (( 0 ) <= r1 & r1 <= 1) } by X3;
hence y in [. p,q .] by RLTOPSP1:def 2;
end;
then ( rng pt ) c= ( dom f ) by AS1,XBOOLE_1:1;
then P1A: ( dom phi ) = [. ( 0 ),1 .] by D3,RELAT_1:27;
P1B: (for t being  real number holds (t in [. ( 0 ),1 .] implies ( phi /. t ) = ( f /. ( p + ( t * ( q - p ) ) ) )))
proof
let t being  real number;
assume X1: t in [. ( 0 ),1 .];
then X2: ( phi /. t ) = ( phi . t ) by P1A,PARTFUN1:def 6
.= ( f . ( pt . t ) ) by X1,P1A,FUNCT_1:12;
( pt . t ) in ( rng pt ) by X1,D3,FUNCT_1:def 3;
then X3: ( pt . t ) in [. p,q .] by D7;
( pt . t ) = ( pt0 . t ) by X1,D3,FUNCT_1:47
.= ( p + ( t * ( q - p ) ) ) by D0,X1;
hence thesis by X2,X3,AS1,PARTFUN1:def 6;
end;
now
let x0 being  real number;
assume X1: x0 in ( dom phi );
then X3: pt is_continuous_in x0 by D3,D2,P1A,NFCONT_3:def 2;
( pt . x0 ) in ( rng pt ) by D3,X1,P1A,FUNCT_1:def 3;
then ( pt . x0 ) in [. p,q .] by D7;
then ( pt /. x0 ) in [. p,q .] by X1,P1A,D3,PARTFUN1:def 6;
hence phi is_continuous_in x0 by AS1,X1,X3,NFCONT_3:15;
end;
then phi is  continuous by NFCONT_3:def 2;
then P2: ( phi | [. ( 0 ),1 .] ) is  continuous;
P40:now
let x being Real;
assume X1: x in ]. ( 0 ),1 .[;
then X2: pt is_differentiable_in x by D6,NDIFF_3:10;
( ( pt `| ]. ( 0 ),1 .[ ) . x ) = ( q - p ) by X1,D5,D3,D4,NDIFF_3:21;
then X3: ( diff (pt,x) ) = ( q - p ) by D6,X1,NDIFF_3:def 6;
X5: ( pt . x ) = ( pt /. x ) by X1,D4,D3,PARTFUN1:def 6;
Y3: (ex r being Real st ((x = r & ( 0 ) < r) & r < 1)) by X1;
Y4: ( pt . x ) = ( pt0 . x ) by X1,D4,D3,FUNCT_1:47;
Y5: ( pt0 . x ) = ( p + ( x * ( q - p ) ) ) by D0;
then ( pt . x ) in ]. p,q .[ by Y3,Y4;
then X6: f is_differentiable_in ( pt /. x ) by X5,AS1;
hence phi is_differentiable_in x by X2,CKB6:1;
thus ( diff (phi,x) ) = ( ( diff (f,( p + ( x * ( q - p ) ) )) ) . ( q - p ) ) by X3,X5,Y4,Y5,X6,X2,CKB6:1;
end;
then (]. ( 0 ),1 .[ c= ( dom phi ) & (for x being Real holds (x in ]. ( 0 ),1 .[ implies phi is_differentiable_in x))) by P1A,XXREAL_1:25;
then P3: phi is_differentiable_on ]. ( 0 ),1 .[ by NDIFF_3:10;
deffunc GG((Element of ( REAL ))) = ( ( M * ||. ( q - p ) .|| ) * $1 );
consider g0 being (Function of ( REAL ),( REAL )) such that Q0: (for t being (Element of ( REAL )) holds ( g0 . t ) = GG(t)) from FUNCT_2:sch 4;
set g = ( g0 | [. ( 0 ),1 .] );
(for t being  real number holds (t in [. ( 0 ),1 .] implies ( g0 . t ) = ( ( ( M * ||. ( q - p ) .|| ) * t ) + (( 0 ) qua  real number) ))) by Q0;
then Q9: g is  continuous by FCONT_1:41;
( dom g0 ) = ( REAL ) by FUNCT_2:def 1;
then Q3: ( dom g ) = [. ( 0 ),1 .] by RELAT_1:62;
then Q2: ( g | [. ( 0 ),1 .] ) is  continuous by Q9,RELAT_1:68;
Q5:now
let t being Real;
assume t in ]. ( 0 ),1 .[;
hence ( g . t ) = ( g0 . t ) by Q3,D4,FUNCT_1:47
.= ( ( ( M * ||. ( q - p ) .|| ) * t ) + (( 0 ) qua Real) ) by Q0;
end;
then Q6: (g is_differentiable_on ]. ( 0 ),1 .[ & (for t being Real holds (t in ]. ( 0 ),1 .[ implies ( ( g `| ]. ( 0 ),1 .[ ) . t ) = ( M * ||. ( q - p ) .|| )))) by Q3,D4,FDIFF_1:23;
(for t being  real number holds (t in ]. ( 0 ),1 .[ implies ||. ( diff (phi,t) ) .|| <= ( diff (g,t) )))
proof
let t being  real number;
assume X1: t in ]. ( 0 ),1 .[;
then X2: ||. ( diff (phi,t) ) .|| = ||. ( ( diff (f,( p + ( t * ( q - p ) ) )) ) . ( q - p ) ) .|| by P40;
reconsider L = ( diff (f,( p + ( t * ( q - p ) ) )) ) as  bounded (LinearOperator of S,T) by LOPBAN_1:def 9;
X3: ||. ( L . ( q - p ) ) .|| <= ( ||. ( diff (f,( p + ( t * ( q - p ) ) )) ) .|| * ||. ( q - p ) .|| ) by LOPBAN_1:32;
(ex r being Real st ((t = r & ( 0 ) < r) & r < 1)) by X1;
then ( p + ( t * ( q - p ) ) ) in ]. p,q .[;
then Y3: ( ||. ( diff (f,( p + ( t * ( q - p ) ) )) ) .|| * ||. ( q - p ) .|| ) <= ( M * ||. ( q - p ) .|| ) by AS1,XREAL_1:64;
( diff (g,t) ) = ( ( g `| ]. ( 0 ),1 .[ ) . t ) by X1,Q6,FDIFF_1:def 7;
then ( diff (g,t) ) = ( M * ||. ( q - p ) .|| ) by X1,Q5,Q3,D4,FDIFF_1:23;
hence thesis by Y3,X3,X2,XXREAL_0:2;
end;
then R2: ||. ( ( phi /. 1 ) - ( phi /. ( 0 ) ) ) .|| <= ( ( g /. 1 ) - ( g /. ( 0 ) ) ) by CKB28:1,P1A,P2,P3,Q3,Q2,Q6;
R31: (1 in [. ( 0 ),1 .] & ( 0 ) in [. ( 0 ),1 .]);
then R3: ( g /. 1 ) = ( g . 1 ) by Q3,PARTFUN1:def 6
.= ( g0 . 1 ) by Q3,R31,FUNCT_1:47
.= ( ( M * ||. ( q - p ) .|| ) * 1 ) by Q0;
R4: ( g /. ( 0 ) ) = ( g . ( 0 ) ) by Q3,R31,PARTFUN1:def 6
.= ( g0 . ( 0 ) ) by Q3,R31,FUNCT_1:47
.= ( ( M * ||. ( q - p ) .|| ) * (( 0 ) qua Real) ) by Q0;
R5: ( phi /. 1 ) = ( f /. ( p + ( 1 * ( q - p ) ) ) ) by P1B,R31
.= ( f /. ( p + ( q - p ) ) ) by RLVECT_1:def 8
.= ( f /. ( q - ( p - p ) ) ) by RLVECT_1:29
.= ( f /. ( q - ( 0. S ) ) ) by RLVECT_1:15
.= ( f /. q ) by RLVECT_1:13;
( phi /. ( 0 ) ) = ( f /. ( p + ( (( 0 ) qua Real) * ( q - p ) ) ) ) by P1B,R31
.= ( f /. ( p + ( 0. S ) ) ) by RLVECT_1:10
.= ( f /. p ) by RLVECT_1:4;
hence thesis by R2,R3,R4,R5;
end;
