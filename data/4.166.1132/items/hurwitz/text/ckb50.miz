environ
vocabularies NUMBERS,RLVECT_1,ALGSTR_0,XBOOLE_0,FINSEQ_1,NAT_1,RELAT_1,ARYTM_3,TARSKI,ORDINAL4,PARTFUN1,XXREAL_0,FUNCT_1,SUBSET_1,STRUCT_0,BINOP_1,VECTSP_1,LATTICES,SUPINF_2,ARYTM_1,GROUP_1,CARD_1,MESFUNC1,COMPLFLD,COMPLEX1,CARD_3,POLYNOM1,POLYNOM3,SGRAPH1,INT_1,ALGSEQ_1,VECTSP_2,POLYNOM5,AFINSQ_1,POLYNOM2,FUNCT_4,FUNCOP_1,XCMPLX_0,SQUARE_1,HURWITZ;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,NUMBERS,XCMPLX_0,ALGSTR_0,VECTSP_2,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,NAT_1,NAT_D,XXREAL_0,FINSEQ_1,INT_1,FUNCOP_1,STRUCT_0,RLVECT_1,VFUNCT_1,GROUP_1,POLYNOM1,COMPLEX1,COMPLFLD,BINOP_1,NORMSP_1,BHSP_1,ALGSEQ_1,FUNCT_4,POLYNOM3,POLYNOM4,POLYNOM5,VECTSP_1,SQUARE_1,CKB18,CKB27,CKB28,CKB40,CKB47;
definitions FINSEQ_1,POLYNOM3,COMPLEX1,SQUARE_1,FUNCOP_1,CKB18,CKB27,CKB40,CKB47;
theorems GROUP_1,VECTSP_1,ALGSEQ_1,NAT_1,FUNCT_1,FUNCT_2,XREAL_1,SQUARE_1,VECTSP_2,INT_1,FINSEQ_1,RLVECT_1,POLYNOM4,TARSKI,FUNCT_4,POLYNOM3,XBOOLE_1,POLYNOM2,FUNCOP_1,XCMPLX_1,XCMPLX_0,COMPLFLD,POLYNOM5,XXREAL_0,ALGSTR_1,COMPLEX1,FINSEQ_2,POLYNOM1,FINSEQ_3,BHSP_1,NORMSP_1,ORDINAL1,PARTFUN1,XREAL_0,NAT_D,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49;
schemes NAT_1,FUNCT_2,FINSEQ_1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,XCMPLX_0,XXREAL_0,XREAL_0,SQUARE_1,NAT_1,INT_1,MEMBERED,FINSEQ_1,STRUCT_0,VECTSP_1,COMPLFLD,ALGSTR_1,GCD_1,POLYNOM3,POLYNOM4,POLYNOM5,FUNCOP_1,CARD_1,VFUNCT_1,FUNCT_2;
constructors BINOP_1,REAL_1,SQUARE_1,FINSOP_1,BINARITH,VECTSP_2,ALGSTR_1,BHSP_1,POLYNOM1,POLYNOM4,POLYNOM5,SEQ_1,BINOP_2,NAT_D,RELSET_1,FVSUM_1,VFUNCT_1,CKB18,CKB27,CKB40,CKB47;
requirements NUMERALS,SUBSET,REAL,BOOLE,ARITHM;
begin
theorem
Th33: (for L being  Abelian  add-associative  right_zeroed  right_complementable  well-unital  associative  distributive  commutative non  empty doubleLoopStr holds (for p being (Polynomial of L) holds (for z being (Element of L) holds (z is_a_root_of p implies (ex s being (Polynomial of L) st p = ( ( rpoly (1,z) ) *' s ))))))
proof
let L being  Abelian  add-associative  right_zeroed  right_complementable  well-unital  distributive  associative  commutative non  empty doubleLoopStr;
let p being (Polynomial of L);
let z being (Element of L);
assume A1: z is_a_root_of p;
set m = ( len p );
per cases ;
suppose A2: m = ( 0 );

take ( 0_. L );
p = ( 0_. L ) by A2,POLYNOM4:5;
hence thesis by POLYNOM3:34;
end;
suppose A3: m > ( 0 );

then m >= ( ( 0 ) + 1 ) by NAT_1:13;
then reconsider m1 = ( m - 1 ) as (Element of ( NAT )) by INT_1:5;
defpred Pr[ set,set ]
 means
(ex u being (Element of L) st (ex b being (Element of ( NAT )) st ((u = ( p . $1 ) & b = $1) & $2 = ( u * ( rpoly (b,z) ) ))));
defpred Pq[ set,set ]
 means
(($1 = 1 & $2 = ( ( p . 1 ) * ( 1_. L ) )) or ($1 <> 1 & (ex u being (Element of L) st (ex b being (Element of ( NAT )) st ((u = ( p . $1 ) & b = $1) & $2 = ( u * ( qpoly (b,z) ) ))))));
A4: (for k being Nat holds (k in ( Seg m1 ) implies (ex x being (Element of (the carrier of ( Polynom-Ring L ))) st Pq[ k,x ])))
proof
let k being Nat;
A5: ( dom p ) = ( NAT ) by FUNCT_2:def 1;
assume k in ( Seg m1 );
then A6: 1 <= k by FINSEQ_1:1;
per cases  by A6,XXREAL_0:1;
suppose A7: k = 1;

reconsider t = ( ( p . 1 ) * ( 1_. L ) ) as (Element of (the carrier of ( Polynom-Ring L ))) by POLYNOM3:def 10;
take t;
thus thesis by A7;
end;
suppose A8: k > 1;

reconsider t = ( ( p /. k ) * ( qpoly (k,z) ) ) as (Element of (the carrier of ( Polynom-Ring L ))) by POLYNOM3:def 10;
take t;
(ex u being (Element of L) st (ex b being (Element of ( NAT )) st ((u = ( p . k ) & b = k) & t = ( u * ( qpoly (b,z) ) ))))
proof
take ( p /. k );
reconsider b = k as (Element of ( NAT )) by ORDINAL1:def 12;
take b;
b in ( NAT );
hence thesis by A5,PARTFUN1:def 6;
end;
hence thesis by A8;
end;
end;
consider hs being (FinSequence of ( Polynom-Ring L )) such that A9: (( dom hs ) = ( Seg m1 ) & (for k being Nat holds (k in ( Seg m1 ) implies Pq[ k,( hs . k ) ]))) from FINSEQ_1:sch 5(A4);
A10:now
let i being (Element of ( NAT ));
assume that
A11: 1 < i
and
A12: i <= ( m - 1 );
i in ( Seg m1 ) by A11,A12;
then (ex u being (Element of L) st (ex b being (Element of ( NAT )) st ((u = ( p . i ) & b = i) & ( hs . i ) = ( u * ( qpoly (b,z) ) )))) by A9,A11;
hence ( hs . i ) = ( ( p . i ) * ( qpoly (i,z) ) );
end;
A13: (for k being Nat holds (k in ( Seg m1 ) implies (ex x being (Element of (the carrier of ( Polynom-Ring L ))) st Pr[ k,x ])))
proof
let k being Nat;
assume k in ( Seg m1 );
then reconsider k1 = k as (Element of ( NAT ));
reconsider t = ( ( p /. k ) * ( rpoly (k1,z) ) ) as (Element of (the carrier of ( Polynom-Ring L ))) by POLYNOM3:def 10;
take t;
take ( p /. k );
take k1;
A14: k1 in ( NAT );
( dom p ) = ( NAT ) by FUNCT_2:def 1;
hence thesis by A14,PARTFUN1:def 6;
end;
consider h being (FinSequence of ( Polynom-Ring L )) such that A15: (( dom h ) = ( Seg m1 ) & (for k being Nat holds (k in ( Seg m1 ) implies Pr[ k,( h . k ) ]))) from FINSEQ_1:sch 5(A13);
set s = ( Sum hs );
set rs = ( Sum h );
reconsider s,rs as (Polynomial of L) by POLYNOM3:def 10;
A16:now
let k being (Element of ( NAT ));
assume that
A17: 1 <= k
and
A18: k <= m1;
k in ( Seg m1 ) by A17,A18;
then (ex u being (Element of L) st (ex b being (Element of ( NAT )) st ((u = ( p . k ) & b = k) & ( h . k ) = ( u * ( rpoly (b,z) ) )))) by A15;
hence ( h . k ) = ( ( p . k ) * ( rpoly (k,z) ) );
end;
A19: ( m1 + 1 ) = m;
A20:now
let i being (Element of ( NAT ));
assume A21: i >= ( len p );
set co = ( Coeff (h,i) );
A22: ( dom h ) = ( Seg ( len h ) ) by FINSEQ_1:def 3
.= ( Seg ( len co ) ) by CKB18:def 1
.= ( dom co ) by FINSEQ_1:def 3;
now
let j being (Element of ( NAT ));
assume A23: j in ( dom co );
then A24: (ex ci being (Polynomial of L) st (ci = ( h . j ) & ( co . j ) = ( ci . i ))) by CKB18:def 1;
A25: j <= m1 by A15,A22,A23,FINSEQ_1:1;
then A26: j <> i by A19,A21,NAT_1:16,XXREAL_0:2;
1 <= j by A15,A22,A23,FINSEQ_1:1;
hence ( co . j ) = ( ( ( p . j ) * ( rpoly (j,z) ) ) . i ) by A16,A24,A25
.= ( ( p . j ) * ( ( rpoly (j,z) ) . i ) ) by POLYNOM5:def 3
.= ( ( p . j ) * ( 0. L ) ) by A3,A21,A26,CKB39:1
.= ( 0. L ) by VECTSP_1:6;
end;
then ( Sum co ) = ( 0. L ) by POLYNOM3:1;
hence ( rs . i ) = ( 0. L ) by CKB19:1;
end;
A27: ( len h ) = m1 by A15,FINSEQ_1:def 3;
A28:now
let i being (Element of ( NAT ));
assume that
A29: i > ( 0 )
and
A30: i < ( len p );
i < ( m1 + 1 ) by A30;
then A31: i <= m1 by NAT_1:13;
( i + 1 ) > ( ( 0 ) + 1 ) by A29,XREAL_1:8;
then A32: i >= 1 by NAT_1:13;
then A33: ( h . i ) = ( ( p . i ) * ( rpoly (i,z) ) ) by A16,A31;
set co = ( Coeff (h,i) );
A34: ( dom h ) = ( Seg ( len h ) ) by FINSEQ_1:def 3
.= ( Seg ( len co ) ) by CKB18:def 1
.= ( dom co ) by FINSEQ_1:def 3;
i in ( Seg ( len h ) ) by A27,A32,A31;
then A35: i in ( dom co ) by A34,FINSEQ_1:def 3;
then A36: (ex cc being (Polynomial of L) st (cc = ( h . i ) & ( co . i ) = ( cc . i ))) by CKB18:def 1;
now
let i9 being (Element of ( NAT ));
assume that
A37: i9 in ( dom co )
and
A38: i9 <> i;
A39: (ex ci being (Polynomial of L) st (ci = ( h . i9 ) & ( co . i9 ) = ( ci . i ))) by A37,CKB18:def 1;
A40: i9 <= ( m - 1 ) by A15,A34,A37,FINSEQ_1:1;
1 <= i9 by A15,A34,A37,FINSEQ_1:1;
then ( co . i9 ) = ( ( ( p . i9 ) * ( rpoly (i9,z) ) ) . i ) by A16,A39,A40
.= ( ( p . i9 ) * ( ( rpoly (i9,z) ) . i ) ) by POLYNOM5:def 3
.= ( ( p . i9 ) * ( 0. L ) ) by A29,A38,CKB39:1
.= ( 0. L ) by VECTSP_1:6;
hence ( co /. i9 ) = ( 0. L ) by A37,PARTFUN1:def 6;
end;
then ( Sum co ) = ( co /. i ) by A35,POLYNOM2:3
.= ( co . i ) by A35,PARTFUN1:def 6;
hence ( rs . i ) = ( ( ( p . i ) * ( rpoly (i,z) ) ) . i ) by A36,A33,CKB19:1;
end;
A41:now
let i9 being set;
assume i9 in ( dom p );
then reconsider i = i9 as (Element of ( NAT ));
per cases ;
suppose A42: i = ( 0 );

set co = ( Coeff (h,( 0 )) );
consider evp being (FinSequence of L) such that A43: ( eval (p,z) ) = ( Sum evp ) and A44: ( len evp ) = ( len p ) and A45: (for n being (Element of ( NAT )) holds (n in ( dom evp ) implies ( evp . n ) = ( ( p . ( n -' 1 ) ) * ( ( power L ) . (z,( n -' 1 )) ) ))) by POLYNOM4:def 2;
set cop = ( <* ( - ( p . ( 0 ) ) ) *> ^ co );
A46: ( len cop ) = ( ( len <* ( - ( p . ( 0 ) ) ) *> ) + ( len co ) ) by FINSEQ_1:22
.= ( 1 + ( len co ) ) by FINSEQ_1:39;
then A47: ( len cop ) = ( 1 + ( len h ) ) by CKB18:def 1
.= ( len evp ) by A27,A44;
then A48: ( dom cop ) = ( Seg ( len evp ) ) by FINSEQ_1:def 3
.= ( dom evp ) by FINSEQ_1:def 3;
A49: ( dom h ) = ( Seg ( len h ) ) by FINSEQ_1:def 3
.= ( Seg ( len co ) ) by CKB18:def 1
.= ( dom co ) by FINSEQ_1:def 3;
A50:now
let j being (Element of ( NAT ));
reconsider aj = ( - ( ( power L ) . (z,j) ) ) as (Element of L);
assume A51: j in ( dom co );
then A52: 1 <= j by A15,A49,FINSEQ_1:1;
A53: j <= m1 by A15,A49,A51,FINSEQ_1:1;
(ex ci being (Polynomial of L) st (ci = ( h . j ) & ( co . j ) = ( ci . i ))) by A42,A51,CKB18:def 1;
hence ( co . j ) = ( ( ( p . j ) * ( rpoly (j,z) ) ) . i ) by A16,A52,A53
.= ( ( p . j ) * ( ( rpoly (j,z) ) . i ) ) by POLYNOM5:def 3
.= ( ( p . j ) * aj ) by A42,A52,CKB38:1
.= ( - ( ( p . j ) * ( ( power L ) . (z,j) ) ) ) by VECTSP_1:8;
end;
now
let j being (Element of ( NAT ));
A54: ( dom <* ( - ( p . ( 0 ) ) ) *> ) = { 1 } by FINSEQ_1:2,FINSEQ_1:38;
assume A55: j in ( dom cop );
then A56: ( evp /. j ) = ( evp . j ) by A48,PARTFUN1:def 6
.= ( ( p . ( j -' 1 ) ) * ( ( power L ) . (z,( j -' 1 )) ) ) by A45,A48,A55;
A57: j in ( Seg ( len cop ) ) by A55,FINSEQ_1:def 3;
then A58: 1 <= j by FINSEQ_1:1;
A59: j <= ( len cop ) by A57,FINSEQ_1:1;
per cases  by A58,XXREAL_0:1;
suppose A60: j = 1;

then ( j -' 1 ) = ( 1 - 1 ) by XREAL_0:def 2;
then A61: ( evp /. j ) = ( ( p . ( 0 ) ) * ( 1_ L ) ) by A56,GROUP_1:def 7
.= ( p . ( 0 ) ) by VECTSP_1:def 4;
j in ( dom <* ( - ( p . ( 0 ) ) ) *> ) by A54,A60,TARSKI:def 1;
then ( cop . j ) = ( <* ( - ( p . ( 0 ) ) ) *> . j ) by FINSEQ_1:def 7
.= ( - ( p . ( 0 ) ) ) by A60,FINSEQ_1:40;
hence ( cop /. j ) = ( - ( evp /. j ) ) by A55,A61,PARTFUN1:def 6;
end;
suppose A62: j > 1;

then reconsider j1 = ( j - 1 ) as (Element of ( NAT )) by INT_1:5;
1 < ( j1 + 1 ) by A62;
then A63: 1 <= j1 by NAT_1:13;
j1 <= ( ( len cop ) - 1 ) by A59,XREAL_1:9;
then j1 in ( Seg ( len co ) ) by A46,A63;
then A64: j1 in ( dom co ) by FINSEQ_1:def 3;
A65: j <= ( len cop ) by A57,FINSEQ_1:1;
( j - 1 ) >= ( 1 - 1 ) by A62,XREAL_1:9;
then A66: ( j -' 1 ) = ( j - 1 ) by XREAL_0:def 2;
( len <* ( - ( p . ( 0 ) ) ) *> ) < j by A62,FINSEQ_1:40;
then ( cop . j ) = ( co . ( j - ( len <* ( - ( p . ( 0 ) ) ) *> ) ) ) by A65,FINSEQ_1:24
.= ( co . ( j - 1 ) ) by FINSEQ_1:40
.= ( - ( ( p . j1 ) * ( ( power L ) . (z,j1) ) ) ) by A50,A64;
hence ( cop /. j ) = ( - ( evp /. j ) ) by A55,A56,A66,PARTFUN1:def 6;
end;
end;
then A67: ( - ( Sum evp ) ) = ( Sum cop ) by A47,CKB10:1
.= ( ( Sum <* ( - ( p . ( 0 ) ) ) *> ) + ( Sum co ) ) by RLVECT_1:41
.= ( ( - ( p . ( 0 ) ) ) + ( Sum co ) ) by RLVECT_1:44;
( Sum evp ) = ( 0. L ) by A1,A43,POLYNOM5:def 6;
then ( 0. L ) = ( ( - ( p . ( 0 ) ) ) + ( Sum co ) ) by A67,RLVECT_1:12;
then ( p . ( 0 ) ) = ( ( p . ( 0 ) ) + ( ( - ( p . ( 0 ) ) ) + ( Sum co ) ) ) by ALGSTR_1:def 2
.= ( ( ( p . ( 0 ) ) + ( - ( p . ( 0 ) ) ) ) + ( Sum co ) ) by RLVECT_1:def 3
.= ( ( 0. L ) + ( Sum co ) ) by RLVECT_1:5
.= ( Sum co ) by ALGSTR_1:def 2;
hence ( p . i9 ) = ( rs . i9 ) by A42,CKB19:1;
end;
suppose A68: i > ( 0 );

per cases ;
suppose A69: i >= ( len p );

hence ( rs . i9 ) = ( 0. L ) by A20
.= ( p . i9 ) by A69,ALGSEQ_1:8;
end;
suppose i < ( len p );

hence ( rs . i9 ) = ( ( ( p . i ) * ( rpoly (i,z) ) ) . i ) by A28,A68
.= ( ( p . i ) * ( ( rpoly (i,z) ) . i ) ) by POLYNOM5:def 3
.= ( ( p . i ) * ( 1_ L ) ) by A68,CKB38:1
.= ( p . i9 ) by VECTSP_1:def 4;
end;
end;
end;
now
assume m1 < 1;
then ( deg p ) = ( 0 ) by NAT_1:14;
then (not p is  with_roots) by CKB37:1;
hence contradiction by A1,POLYNOM5:def 7;
end;
then 1 in ( Seg m1 );
then A70: ( hs . 1 ) = ( ( p . 1 ) * ( 1_. L ) ) by A9;
A71:now
reconsider r1z = ( rpoly (1,z) ) as (Element of ( Polynom-Ring L )) by POLYNOM3:def 10;
let i9 being set;
assume i9 in ( dom rs );
A72: ( dom ( r1z * hs ) ) = ( dom h ) by A9,A15,POLYNOM1:def 1;
now
let k being Nat;
assume A73: k in ( dom h );
then A74: 1 <= k by A15,FINSEQ_1:1;
A75: k <= m1 by A15,A73,FINSEQ_1:1;
per cases  by A74,XXREAL_0:1;
suppose A76: k = 1;

then A77: ( hs /. k ) = ( ( p . 1 ) * ( 1_. L ) ) by A9,A70,A15,A73,PARTFUN1:def 6;
thus ( ( r1z * hs ) . k ) = ( ( r1z * hs ) /. k ) by A72,A73,PARTFUN1:def 6
.= ( r1z * ( hs /. k ) ) by A9,A15,A73,POLYNOM1:def 1
.= ( ( rpoly (1,z) ) *' ( ( p . 1 ) * ( 1_. L ) ) ) by A77,POLYNOM3:def 10
.= ( ( p . 1 ) * ( ( rpoly (1,z) ) *' ( 1_. L ) ) ) by CKB26:1
.= ( ( p . 1 ) * ( rpoly (1,z) ) ) by POLYNOM3:35
.= ( h . k ) by A16,A75,A76;
end;
suppose A78: k > 1;

reconsider k1 = k as (Element of ( NAT )) by A73;
A79: ( hs /. k ) = ( hs . k ) by A9,A15,A73,PARTFUN1:def 6
.= ( ( p . k1 ) * ( qpoly (k1,z) ) ) by A10,A75,A78;
thus ( ( r1z * hs ) . k ) = ( ( r1z * hs ) /. k ) by A72,A73,PARTFUN1:def 6
.= ( r1z * ( hs /. k ) ) by A9,A15,A73,POLYNOM1:def 1
.= ( ( rpoly (1,z) ) *' ( ( p . k1 ) * ( qpoly (k1,z) ) ) ) by A79,POLYNOM3:def 10
.= ( ( p . k1 ) * ( ( rpoly (1,z) ) *' ( qpoly (k1,z) ) ) ) by CKB26:1
.= ( ( p . k1 ) * ( rpoly (k1,z) ) ) by A78,CKB49:1
.= ( h . k ) by A16,A74,A75;
end;
end;
then ( r1z * hs ) = h by A72,FINSEQ_1:13;
hence ( rs . i9 ) = ( ( ( rpoly (1,z) ) *' s ) . i9 ) by CKB20:1;
end;
take s;
( dom ( ( rpoly (1,z) ) *' s ) ) = ( NAT ) by FUNCT_2:def 1
.= ( dom rs ) by FUNCT_2:def 1;
then A80: ( ( rpoly (1,z) ) *' s ) = rs by A71,FUNCT_1:2;
( dom p ) = ( NAT ) by FUNCT_2:def 1
.= ( dom rs ) by FUNCT_2:def 1;
hence thesis by A80,A41,FUNCT_1:2;
end;
end;
