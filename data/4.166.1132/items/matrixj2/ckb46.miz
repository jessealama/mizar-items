environ
vocabularies NUMBERS,NAT_1,VECTSP_1,SUBSET_1,FUNCT_1,RELAT_1,FUNCT_4,XBOOLE_0,FUNCOP_1,MATRIX_1,FINSEQ_1,TREES_1,ARYTM_3,GROUP_1,SUPINF_2,ZFMISC_1,MATRIX_2,XXREAL_0,MATRIX_3,FINSEQ_2,ALGSTR_0,SETWISEO,CARD_3,CARD_1,INCSP_1,MESFUNC1,STRUCT_0,FVSUM_1,PARTFUN1,RVSUM_1,ARYTM_1,MATRIX_6,MATRIXJ1,MATHMORP,ORDINAL4,RFINSEQ,BCIALG_2,NEWTON,GRCAT_1,FUNCSDOM,VECTSP_2,RANKNULL,VECTSP10,HURWITZ,TARSKI,RLSUB_1,RLVECT_5,MATRLIN,MATRLIN2,MATRIXR1,FINSEQ_4,RLVECT_3,FINSET_1,RLVECT_2,POLYNOM5,VECTSP11,RLSUB_2,PRVECT_1,MATRIXJ2,UNIALG_1,MSSUBFAM;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,SETWOP_2,FINSEQ_1,PRVECT_1,FUNCOP_1,STRUCT_0,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,FVSUM_1,NAT_D,GROUP_4,MATRIX_3,MATRIX_6,FUNCT_4,DOMAIN_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,MATRIX13,MATRLIN,FUNCT_7,LAPLACE,MOD_2,RFINSEQ,VECTSP_2,VECTSP_5,MATRIX15,RANKNULL,FUNCSDOM,GRCAT_1,POLYNOM5,WSIERP_1,MATRIXJ1,MATRLIN2,VECTSP11,CKB2,CKB3,CKB13,CKB16,CKB18,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB35,CKB36;
definitions STRUCT_0,TARSKI,RLVECT_1,FINSEQ_1,VECTSP_4,RELAT_1,GROUP_4,FVSUM_1,MATRIX_1,FUNCT_1,FUNCOP_1,MATRIXJ1,MATRLIN2,CKB2,CKB13,CKB18,CKB30,CKB35;
theorems ZFMISC_1,RLVECT_1,MATRIX_1,MATRIX_2,MATRIX_3,VECTSP_1,NAT_1,FINSEQ_2,CARD_1,CARD_2,FINSEQ_1,FINSEQ_3,FRECHET,FUNCT_1,FUNCT_2,FUNCT_7,FUNCOP_1,FVSUM_1,GROUP_1,LAPLACE,MATRIX_6,MATRIX13,MATRIXR1,MATRIXR2,MATRLIN,ORDINAL1,PARTFUN1,RELAT_1,STIRL2_1,STRUCT_0,TARSKI,WELLORD2,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,MATRIX15,MOD_2,VECTSP10,RANKNULL,VECTSP_5,FINSEQ_4,FINSEQ_5,RFINSEQ,RVSUM_1,POLYNOM3,POLYNOM4,MATRIXJ1,MATRLIN2,VECTSP11,GRCAT_1,FUNCT_4,NAT_D,CKB1,CKB2,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB17,CKB18,CKB19,CKB20,CKB23,CKB30,CKB31,CKB34,CKB35,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45;
schemes NAT_1,MATRIX_1,FUNCT_2;
registrations XBOOLE_0,FINSET_1,STRUCT_0,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,CARD_1,FINSEQ_2,XREAL_0,VECTSP_9,VALUED_0,MATRIXJ1,VECTSP11,POLYNOM5,FUNCOP_1,RELSET_1,MOD_2,GRCAT_1,PRVECT_1,MATRIX13,MATRLIN2,CKB14,CKB15,CKB21,CKB22,CKB32,CKB33;
constructors FINSOP_1,XXREAL_0,GROUP_4,WELLORD2,VECTSP_7,VECTSP_9,MATRIX_6,REALSET1,LAPLACE,VECTSP_5,RANKNULL,MATRIX15,POLYNOM1,POLYNOM5,MATRIXJ1,MATRLIN2,VECTSP11,REAL_1,BINARITH,RELSET_1,FUNCT_7,MATRIX13,FVSUM_1,CKB2,CKB3,CKB13,CKB18,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB35;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve i for Nat;
reserve m for Nat;
reserve n for Nat;
reserve K for Field;
reserve L for (Element of K);
reserve V1 for  finite-dimensional (VectSp of K);
reserve V2 for  finite-dimensional (VectSp of K);
reserve b1 for (OrdBasis of V1);
reserve B2 for (FinSequence of V2);
theorem
Th24: (for J being (FinSequence_of_Jordan_block of L,K) holds (for M being (Matrix of ( len b1 ),( len B2 ),K) holds (M = ( block_diagonal (J,( 0. K )) ) implies (for i holds (for m holds ((i in ( dom b1 ) & m = ( min (( Len J ),i) )) implies ((i = ( Sum ( Len ( J | m ) ) ) implies ( ( Mx2Tran (M,b1,B2) ) . ( b1 /. i ) ) = ( L * ( B2 /. i ) )) & (i <> ( Sum ( Len ( J | m ) ) ) implies ( ( Mx2Tran (M,b1,B2) ) . ( b1 /. i ) ) = ( ( L * ( B2 /. i ) ) + ( B2 /. ( i + 1 ) ) )))))))))
proof
let J being (FinSequence_of_Jordan_block of L,K);
let M being (Matrix of ( len b1 ),( len B2 ),K);
assume that
A1: M = ( block_diagonal (J,( 0. K )) );
A2: (( dom b1 ) = ( Seg ( len b1 ) ) & ( len M ) = ( Sum ( Len J ) )) by A1,FINSEQ_1:def 3,MATRIXJ1:def 5;
let i;
let m;
assume that
A3: i in ( dom b1 )
and
A4: m = ( min (( Len J ),i) );
set Sm = ( Sum ( Len ( J | m ) ) );
A5: 1 <= i by A3,FINSEQ_3:25;
A6: i <= ( len b1 ) by A3,FINSEQ_3:25;
then A7: ( len M ) = ( len b1 ) by A5,MATRIX_1:23;
then A8: m in ( dom ( Len J ) ) by A3,A4,A2,MATRIXJ1:def 1;
then A9: ( ( Len J ) . m ) = ( len ( J . m ) ) by MATRIXJ1:def 3;
set S = ( Sum ( Len ( J | ( m -' 1 ) ) ) );
set iS = ( i -' S );
set BBB = ( ( B2 | ( Sum ( Width ( J | m ) ) ) ) /^ ( Sum ( Width ( J | ( m -' 1 ) ) ) ) );
A10: ( ( Mx2Tran (M,b1,B2) ) . ( b1 /. i ) ) = ( Sum ( lmlt (( Line (( J . m ),iS) ),BBB) ) ) by A1,A3,A4,CKB42:1;
A11: ( width M ) = ( Sum ( Width J ) ) by A1,MATRIXJ1:def 5;
A12: ( len BBB ) = ( width ( J . m ) ) by A1,A3,A4,CKB42:1;
A13: ( ( Len J ) | m ) = ( Len ( J | m ) ) by MATRIXJ1:17;
then A14: i <= Sm by A3,A4,A7,A2,MATRIXJ1:def 1;
A15: ( ( Len J ) | ( m -' 1 ) ) = ( Len ( J | ( m -' 1 ) ) ) by MATRIXJ1:17;
then S < i by A3,A4,A7,A2,MATRIXJ1:7;
then A16: iS = ( i - S ) by XREAL_1:233;
A17: ( m -' 1 ) = ( m - 1 ) by A3,A4,A7,A2,MATRIXJ1:7;
then ( ( Len J ) | ( ( m -' 1 ) + 1 ) ) = ( ( Len ( J | ( m -' 1 ) ) ) ^ <* ( ( Len J ) . m ) *> ) by A15,A8,FINSEQ_5:10;
then A18: Sm = ( S + ( len ( J . m ) ) ) by A13,A17,A9,RVSUM_1:74;
then ( S + iS ) <= ( S + ( len ( J . m ) ) ) by A3,A4,A13,A7,A2,A16,MATRIXJ1:def 1;
then A19: iS <= ( len ( J . m ) ) by XREAL_1:6;
( dom ( Len J ) ) = ( dom J ) by MATRIXJ1:def 3;
then consider n such that A20: ( J . m ) = ( Jordan_block (L,n) ) by A8,CKB18:def 1;
(m in ( NAT ) & m <= ( len ( Len J ) )) by A8,FINSEQ_3:25;
then Sm <= ( Sum ( ( Len J ) | ( len ( Len J ) ) ) ) by A13,POLYNOM3:18;
then A21: Sm <= ( Sum ( Len J ) ) by FINSEQ_1:58;
A22: ( Width J ) = ( Len J ) by MATRIXJ1:46;
then A23: ( ( Len J ) . m ) = ( width ( J . m ) ) by A8,MATRIXJ1:def 4;
( width M ) = ( len B2 ) by A5,A6,MATRIX_1:23;
then A24: ( len ( B2 | Sm ) ) = Sm by A22,A11,A21,FINSEQ_1:59;
then A25: i in ( dom ( B2 | Sm ) ) by A5,A14,FINSEQ_3:25;
A26: ( len ( J . m ) ) = n by A20,MATRIX_1:24;
iS <> ( 0 ) by A3,A4,A15,A7,A2,A16,MATRIXJ1:7;
then 1 <= iS by NAT_1:14;
then A27: iS in ( dom BBB ) by A12,A9,A23,A19,FINSEQ_3:25;
then A28: ( BBB /. iS ) = ( ( B2 | ( Sum ( Width ( J | m ) ) ) ) /. ( ( Sum ( Width ( J | ( m -' 1 ) ) ) ) + iS ) ) by FINSEQ_5:27
.= ( ( B2 | ( Sum ( Width ( J | m ) ) ) ) /. ( S + iS ) ) by MATRIXJ1:46
.= ( ( B2 | ( Sum ( ( Len J ) | m ) ) ) /. i ) by A22,A16,MATRIXJ1:21
.= ( B2 /. i ) by A13,A25,FINSEQ_4:70;
hence (i = Sm implies ( ( Mx2Tran (M,b1,B2) ) . ( b1 /. i ) ) = ( L * ( B2 /. i ) )) by A10,A12,A9,A16,A23,A18,A27,A20,A26,CKB43:1;
assume A29: i <> Sm;
then i < Sm by A14,XXREAL_0:1;
then (1 <= ( i + 1 ) & ( i + 1 ) <= Sm) by NAT_1:11,NAT_1:13;
then A30: ( i + 1 ) in ( dom ( B2 | Sm ) ) by A24,FINSEQ_3:25;
A31: iS <> ( len ( J . m ) ) by A16,A18,A29;
then iS < ( len ( J . m ) ) by A19,XXREAL_0:1;
then (1 <= ( iS + 1 ) & ( iS + 1 ) <= ( len ( J . m ) )) by NAT_1:11,NAT_1:13;
then ( iS + 1 ) in ( dom BBB ) by A12,A9,A23,FINSEQ_3:25;
then ( BBB /. ( iS + 1 ) ) = ( ( B2 | ( Sum ( Width ( J | m ) ) ) ) /. ( ( Sum ( Width ( J | ( m -' 1 ) ) ) ) + ( iS + 1 ) ) ) by FINSEQ_5:27
.= ( ( B2 | ( Sum ( Width ( J | m ) ) ) ) /. ( ( Sum ( ( Len J ) | ( m -' 1 ) ) ) + ( iS + 1 ) ) ) by A22,MATRIXJ1:21
.= ( ( B2 | ( Sum ( ( Len J ) | m ) ) ) /. ( i + 1 ) ) by A15,A22,A16,MATRIXJ1:21
.= ( B2 /. ( i + 1 ) ) by A13,A30,FINSEQ_4:70;
hence thesis by A10,A12,A9,A23,A27,A20,A26,A28,A31,CKB44:1;
end;
