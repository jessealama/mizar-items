environ
vocabularies NUMBERS,NAT_1,VECTSP_1,SUBSET_1,FUNCT_1,RELAT_1,FUNCT_4,XBOOLE_0,FUNCOP_1,MATRIX_1,FINSEQ_1,TREES_1,ARYTM_3,GROUP_1,SUPINF_2,ZFMISC_1,MATRIX_2,XXREAL_0,MATRIX_3,FINSEQ_2,ALGSTR_0,SETWISEO,CARD_3,CARD_1,INCSP_1,MESFUNC1,STRUCT_0,FVSUM_1,PARTFUN1,RVSUM_1,ARYTM_1,MATRIX_6,MATRIXJ1,MATHMORP,ORDINAL4,RFINSEQ,BCIALG_2,NEWTON,GRCAT_1,FUNCSDOM,VECTSP_2,RANKNULL,VECTSP10,HURWITZ,TARSKI,RLSUB_1,RLVECT_5,MATRLIN,MATRLIN2,MATRIXR1,FINSEQ_4,RLVECT_3,FINSET_1,RLVECT_2,POLYNOM5,VECTSP11,RLSUB_2,PRVECT_1,MATRIXJ2,UNIALG_1,MSSUBFAM;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,SETWOP_2,FINSEQ_1,PRVECT_1,FUNCOP_1,STRUCT_0,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,FVSUM_1,NAT_D,GROUP_4,MATRIX_3,MATRIX_6,FUNCT_4,DOMAIN_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,MATRIX13,MATRLIN,FUNCT_7,LAPLACE,MOD_2,RFINSEQ,VECTSP_2,VECTSP_5,MATRIX15,RANKNULL,FUNCSDOM,GRCAT_1,POLYNOM5,WSIERP_1,MATRIXJ1,MATRLIN2,VECTSP11,CKB2,CKB3,CKB13,CKB16,CKB18,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB35,CKB36;
definitions STRUCT_0,TARSKI,RLVECT_1,FINSEQ_1,VECTSP_4,RELAT_1,GROUP_4,FVSUM_1,MATRIX_1,FUNCT_1,FUNCOP_1,MATRIXJ1,MATRLIN2,CKB2,CKB13,CKB18,CKB30,CKB35;
theorems ZFMISC_1,RLVECT_1,MATRIX_1,MATRIX_2,MATRIX_3,VECTSP_1,NAT_1,FINSEQ_2,CARD_1,CARD_2,FINSEQ_1,FINSEQ_3,FRECHET,FUNCT_1,FUNCT_2,FUNCT_7,FUNCOP_1,FVSUM_1,GROUP_1,LAPLACE,MATRIX_6,MATRIX13,MATRIXR1,MATRIXR2,MATRLIN,ORDINAL1,PARTFUN1,RELAT_1,STIRL2_1,STRUCT_0,TARSKI,WELLORD2,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,MATRIX15,MOD_2,VECTSP10,RANKNULL,VECTSP_5,FINSEQ_4,FINSEQ_5,RFINSEQ,RVSUM_1,POLYNOM3,POLYNOM4,MATRIXJ1,MATRLIN2,VECTSP11,GRCAT_1,FUNCT_4,NAT_D,CKB1,CKB2,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB17,CKB18,CKB19,CKB20,CKB23,CKB30,CKB31,CKB34,CKB35,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49;
schemes NAT_1,MATRIX_1,FUNCT_2;
registrations XBOOLE_0,FINSET_1,STRUCT_0,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,CARD_1,FINSEQ_2,XREAL_0,VECTSP_9,VALUED_0,MATRIXJ1,VECTSP11,POLYNOM5,FUNCOP_1,RELSET_1,MOD_2,GRCAT_1,PRVECT_1,MATRIX13,MATRLIN2,CKB14,CKB15,CKB21,CKB22,CKB32,CKB33;
constructors FINSOP_1,XXREAL_0,GROUP_4,WELLORD2,VECTSP_7,VECTSP_9,MATRIX_6,REALSET1,LAPLACE,VECTSP_5,RANKNULL,MATRIX15,POLYNOM1,POLYNOM5,MATRIXJ1,MATRLIN2,VECTSP11,REAL_1,BINARITH,RELSET_1,FUNCT_7,MATRIX13,FVSUM_1,CKB2,CKB3,CKB13,CKB18,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB35;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve i for Nat;
reserve m for Nat;
reserve n for Nat;
reserve k for Nat;
reserve K for Field;
reserve V1 for  finite-dimensional (VectSp of K);
reserve b1 for (OrdBasis of V1);
theorem
(for J being (FinSequence_of_Jordan_block of ( 0. K ),K) holds (for M being (Matrix of ( len b1 ),( len b1 ),K) holds ((M = ( block_diagonal (J,( 0. K )) ) & ( len b1 ) > ( 0 )) implies (for F being  nilpotent (Function of V1,V1) holds (F = ( Mx2Tran (M,b1,b1) ) implies ((ex i st (i in ( dom J ) & ( len ( J . i ) ) = ( deg F ))) & (for i holds (i in ( dom J ) implies ( len ( J . i ) ) <= ( deg F )))))))))
proof
let J being (FinSequence_of_Jordan_block of ( 0. K ),K);
let M being (Matrix of ( len b1 ),( len b1 ),K);
assume that
A1: M = ( block_diagonal (J,( 0. K )) )
and
A2: ( len b1 ) > ( 0 );
A3: (( len M ) = ( len b1 ) & ( len M ) = ( Sum ( Len J ) )) by A1,MATRIX_1:def 2;
defpred P[ Nat ]
 means
(for i holds (i in ( dom J ) implies ( len ( J . i ) ) <= $1));
set mm = ( min (( Len J ),( len b1 )) );
A4: ( dom J ) = ( dom ( Len J ) ) by MATRIXJ1:def 3;
now
let i;
assume that
A5: i in ( dom J );
( len ( J . i ) ) = ( ( Len J ) . i ) by A4,A5,MATRIXJ1:def 3;
hence ( len ( J . i ) ) <= ( Sum ( Len J ) ) by A4,A5,POLYNOM3:4;
end;
then A6: (ex k st P[ k ]);
consider MIN being Nat such that A7: P[ MIN ] and A8: (for m holds (P[ m ] implies MIN <= m)) from NAT_1:sch 5(A6);
( len b1 ) in ( Seg ( len b1 ) ) by A2,FINSEQ_1:3;
then A9: ( min (( Len J ),( len b1 )) ) in ( dom ( Len J ) ) by A3,MATRIXJ1:def 1;
A10: (ex i st (i in ( dom J ) & ( len ( J . i ) ) = MIN))
proof
assume A11: (for i holds (i in ( dom J ) implies ( len ( J . i ) ) <> MIN));
( len ( J . mm ) ) <= MIN by A9,A4,A7;
then ( len ( J . mm ) ) < MIN by A9,A4,A11,XXREAL_0:1;
then reconsider M1 = ( MIN - 1 ) as (Element of ( NAT )) by NAT_1:20;
now
let i;
assume that
A12: i in ( dom J );
( len ( J . i ) ) <= MIN by A7,A12;
then ( len ( J . i ) ) < ( M1 + 1 ) by A11,A12,XXREAL_0:1;
hence ( len ( J . i ) ) <= M1 by NAT_1:13;
end;
then ( M1 + 1 ) <= M1 by A8;
hence thesis by NAT_1:13;
end;
A13: ( ( Len J ) | ( len ( Len J ) ) ) = ( Len J ) by FINSEQ_1:58;
let F being  nilpotent (Function of V1,V1);
assume that
A14: F = ( Mx2Tran (M,b1,b1) );
consider i such that A15: i in ( dom J ) and A16: ( len ( J . i ) ) = MIN by A10;
A17: ( ( Len J ) . i ) = ( ( Len J ) /. i ) by A4,A15,PARTFUN1:def 6;
set S = ( Sum ( ( Len J ) | ( i -' 1 ) ) );
defpred P[ Nat ]
 means
(($1 in ( Seg MIN ) & $1 <> MIN) implies ( ( F |^ $1 ) . ( b1 /. ( S + 1 ) ) ) = ( b1 /. ( ( S + $1 ) + 1 ) ));
A18: ( len ( J . i ) ) = ( ( Len J ) . i ) by A4,A15,MATRIXJ1:def 3;
i <= ( len ( Len J ) ) by A4,A15,FINSEQ_3:25;
then ( Sum ( ( Len J ) | i ) ) <= ( Sum ( ( Len J ) | ( len ( Len J ) ) ) ) by A15,POLYNOM3:18;
then A19: (( dom b1 ) = ( Seg ( len b1 ) ) & ( Seg ( Sum ( ( Len J ) | i ) ) ) c= ( Seg ( Sum ( Len J ) ) )) by A13,FINSEQ_1:5,FINSEQ_1:def 3;
1 <= i by A15,FINSEQ_3:25;
then ( i -' 1 ) = ( i - 1 ) by XREAL_1:233;
then A20: i = ( ( i -' 1 ) + 1 );
A21: (for n holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
( ( Len J ) | i ) = ( ( ( Len J ) | ( i -' 1 ) ) ^ <* MIN *> ) by A4,A15,A16,A18,A20,FINSEQ_5:10;
then A22: ( Sum ( ( Len J ) | i ) ) = ( S + MIN ) by RVSUM_1:74;
let n;
assume that
A23: P[ n ];
A24: ( ( Len J ) | i ) = ( Len ( J | i ) ) by MATRIXJ1:17;
set n1 = ( n + 1 );
assume that
A25: n1 in ( Seg MIN )
and
A26: n1 <> MIN;
A27: n1 <= MIN by A25,FINSEQ_1:1;
then n1 < MIN by A26,XXREAL_0:1;
then A28: ( S + n1 ) < ( Sum ( ( Len J ) | i ) ) by A22,XREAL_1:6;
(( S + n1 ) in ( Seg ( Sum ( ( Len J ) | i ) ) ) & ( min (( Len J ),( S + n1 )) ) = i) by A4,A15,A16,A18,A17,A25,MATRIXJ1:10;
then A29: ( F . ( b1 /. ( S + n1 ) ) ) = ( ( ( 0. K ) * ( b1 /. ( S + n1 ) ) ) + ( b1 /. ( ( S + n1 ) + 1 ) ) ) by A1,A3,A14,A19,A28,A24,CKB46:1
.= ( ( 0. V1 ) + ( b1 /. ( ( S + n1 ) + 1 ) ) ) by VECTSP_1:14
.= ( b1 /. ( ( S + n1 ) + 1 ) ) by RLVECT_1:def 4;
A30: n < MIN by A27,NAT_1:13;
now
per cases  by NAT_1:14;
suppose n = ( 0 );

hence thesis by A29,VECTSP11:19;
end;
suppose A31: n >= 1;

A32: ( dom ( F |^ n ) ) = (the carrier of V1) by FUNCT_2:def 1;
thus ( ( F |^ n1 ) . ( b1 /. ( S + 1 ) ) ) = ( ( ( F |^ 1 ) * ( F |^ n ) ) . ( b1 /. ( S + 1 ) ) ) by VECTSP11:20
.= ( ( F |^ 1 ) . ( ( F |^ n ) . ( b1 /. ( S + 1 ) ) ) ) by A32,FUNCT_1:13
.= ( b1 /. ( ( S + n1 ) + 1 ) ) by A23,A30,A29,A31,FINSEQ_1:1,VECTSP11:19;
end;
end;
hence thesis;
end;
A33: P[ ( 0 ) ] by FINSEQ_1:1;
A34: (for n holds P[ n ]) from NAT_1:sch 2(A33,A21);
A35: ( deg F ) >= MIN
proof
set D = ( deg F );
( rng b1 ) is (Basis of V1) by MATRLIN:def 2;
then A36: ( rng b1 ) is  linearly-independent  linearly-independent (Subset of V1) by VECTSP_7:def 3;
assume A37: D < MIN;
then (1 <= ( 1 + D ) & ( D + 1 ) <= MIN) by NAT_1:11,NAT_1:13;
then ( D + 1 ) in ( Seg MIN );
then ( S + ( D + 1 ) ) in ( Seg ( Sum ( ( Len J ) | i ) ) ) by A4,A15,A16,A18,A17,MATRIXJ1:10;
then A38: (( b1 /. ( ( S + D ) + 1 ) ) = ( b1 . ( ( S + D ) + 1 ) ) & ( b1 . ( ( S + D ) + 1 ) ) in ( rng b1 )) by A3,A19,FUNCT_1:def 3,PARTFUN1:def 6;
D <> ( 0 )
proof
assume D = ( 0 );
then ( [#] V1 ) = { ( 0. V1 ) } by CKB37:1;
then ( (Omega). V1 ) = ( (0). V1 ) by VECTSP_4:def 3;
then ( dim V1 ) = ( 0 ) by VECTSP_9:29;
hence thesis by A2,MATRLIN2:21;
end;
then D >= 1 by NAT_1:14;
then D in ( Seg MIN ) by A37,FINSEQ_1:1;
then ( b1 /. ( ( S + D ) + 1 ) ) = ( ( F |^ D ) . ( b1 /. ( S + 1 ) ) ) by A34,A37
.= ( ( ZeroMap (V1,V1) ) . ( b1 /. ( S + 1 ) ) ) by CKB35:def 1
.= ( ( (the carrier of V1) --> ( 0. V1 ) ) . ( b1 /. ( S + 1 ) ) ) by GRCAT_1:def 7
.= ( 0. V1 ) by FUNCOP_1:7;
hence thesis by A38,A36,VECTSP_7:2;
end;
( F |^ MIN ) = ( ZeroMap (V1,V1) ) by A1,A14,A7,CKB47:1;
then ( deg F ) <= MIN by CKB35:def 1;
then ( deg F ) = MIN by A35,XXREAL_0:1;
hence thesis by A7,A10;
end;
