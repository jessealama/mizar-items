environ
vocabularies NUMBERS,SUBSET_1,XREAL_0,ORDINAL1,PRE_TOPC,EUCLID,ARYTM_1,ARYTM_3,SUPINF_2,XBOOLE_0,RELAT_1,CARD_1,VALUED_0,FINSEQ_1,COMPLEX1,SQUARE_1,CARD_3,RVSUM_1,XXREAL_0,NAT_1,TARSKI,STRUCT_0,REAL_1,FUNCT_1,UNIALG_1,MSSUBFAM,FUNCOP_1,FINSEQ_2,ALGSTR_0,FUNCT_2,FVSUM_1,INCSP_1,MATRIX_1,MATRIX_3,MATRIX13,MATRLIN,MATRLIN2,MESFUNC1,ORDINAL4,PARTFUN1,PRVECT_1,QC_LANG1,RLVECT_2,RLVECT_3,TREES_1,VALUED_1,VECTSP_1,MATRIXJ1,ZFMISC_1,BINOP_1,GROUP_1,ABIAN,MATRIX_2,XXREAL_1,SIN_COS,FINSOP_1,FUNCT_4,MATRIX_6,PRE_POLY,TOPS_2,RFINSEQ,MONOID_0,MATRIXR2,MATRTOP3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,NAT_D,FUNCOP_1,FINSEQ_1,PRE_POLY,RFINSEQ,FINSEQ_2,RVSUM_1,VALUED_0,SQUARE_1,STRUCT_0,PRE_TOPC,TOPS_2,RLVECT_1,EUCLID,GRCAT_1,TOPREAL9,CARD_1,VECTSP_1,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_6,GROUP_1,MATRIX11,MATRTOP1,SIN_COS,ALGSTR_0,MATRIX_7,BINOP_1,FVSUM_1,RCOMP_1,SEQ_1,MONOID_0,GROUP_4,PRVECT_1,RLVECT_2,RLVECT_3,FUNCT_7,MATRIX13,MATRIXR2,FINSOP_1,MATRLIN,MATRLIN2,MOD_2,MATRIXJ1,TMAP_1,CKB4,CKB15;
definitions TARSKI,SQUARE_1,EUCLID,XCMPLX_0,ALGSTR_0,STRUCT_0,GRCAT_1,TOPREAL9,FINSEQ_1,MATRTOP1,VECTSP_1,MATRIX_7,FVSUM_1,NAT_D,CKB4,CKB15;
theorems XREAL_0,TARSKI,FUNCT_2,EUCLID,XBOOLE_1,XBOOLE_0,JORDAN2C,SQUARE_1,XCMPLX_1,ABSVALUE,RVSUM_1,EUCLID_2,ENUMSET1,XREAL_1,XXREAL_0,RLVECT_1,ORDINAL1,GRCAT_1,CARD_1,CARD_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FUNCT_1,FVSUM_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_6,MATRIX13,MATRIXR1,MATRLIN2,MATRTOP1,NAT_1,PARTFUN1,PRE_POLY,RELAT_1,RLSUB_1,RLVECT_2,RLVECT_3,STRUCT_0,TOPREAL7,ZFMISC_1,MATRIXJ1,STIRL2_1,TOPS_2,TOPREAL9,MATRIX_9,SIN_COS,MATRIX_7,MATRIXR2,MATRIX11,MATRIX_3,MATRIX15,RFINSEQ,FINSEQ_7,SIN_COS6,XXREAL_1,GROUP_4,MONOID_0,GROUP_1,FINSEQ_5,TMAP_1,RLVECT_4,FUNCT_7,TOPREALC,VALUED_1,INT_1,FINSOP_1,MOD_2,CKB1,CKB2,CKB3,CKB4,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25;
schemes NAT_1,FINSEQ_4,MATRIX_1;
registrations XBOOLE_0,XXREAL_0,XREAL_0,SQUARE_1,NAT_1,MEMBERED,STRUCT_0,MONOID_0,EUCLID,VALUED_0,FINSEQ_1,FUNCT_1,RELAT_1,TOPREAL9,CARD_1,FINSEQ_2,FINSET_1,FUNCT_2,MATRIX13,MATRIX_2,MATRTOP1,NUMBERS,PRVECT_1,RELSET_1,RLVECT_2,VECTSP_1,XCMPLX_0,SIN_COS,MATRIX11,MATRIXJ1,GRCAT_1,BORSUK_3,FUNCOP_1,MATRIX_1,INT_1,FUNCT_7,PRE_POLY,SUBSET_1,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13;
constructors REAL_1,SQUARE_1,BORSUK_1,MONOID_0,CONVEX1,TOPREAL9,BINARITH,FVSUM_1,LAPLACE,MATRIX_6,MATRIX11,TOPS_2,MATRIX13,MATRLIN2,MATRTOP1,REALSET1,RLVECT_3,SEQ_1,MATRIXJ1,RCOMP_1,ABIAN,SIN_COS,MATRIX_7,SETWISEO,GROUP_4,TMAP_1,FINSOP_1,MATRIXR2,SEQ_4,CKB4,CKB15;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
reserve r for  real number;
reserve i for Nat;
reserve j for Nat;
reserve k for Nat;
reserve m for Nat;
reserve n for Nat;
theorem
Lm2: (((1 <= i & i < j) & j <= n) implies (ex A being (Matrix of n,( F_Real )) st (((((( Det A ) = ( 1. ( F_Real ) ) & ( A * (i,i) ) = ( cos r )) & ( A * (j,j) ) = ( cos r )) & ( A * (i,j) ) = ( sin r )) & ( A * (j,i) ) = ( - ( sin r ) )) & (for k holds (for m holds ([ k,m ] in ( Indices A ) implies ((((k = m & k <> i) & k <> j) implies ( A * (k,k) ) = ( 1. ( F_Real ) )) & ((k <> m & { k,m } <> { i,j }) implies ( A * (k,m) ) = ( 0. ( F_Real ) )))))))))
proof
A1:now
let k;
assume that
A2: (k >= 1 & k <> 1)
and
A3: k <> 2;
k > 1 by A2,XXREAL_0:1;
then k >= ( 1 + 1 ) by NAT_1:13;
hence k > 2 by A3,XXREAL_0:1;
end;
reconsider s = ( sin r ),c = ( cos r ) as (Element of ( F_Real )) by XREAL_0:def 1;
set S = ( Seg n );
assume that
A4: 1 <= i
and
A5: i < j
and
A6: j <= n;
A7: 1 < j by A4,A5,XXREAL_0:2;
then A8: ( 1 + 1 ) <= j by NAT_1:13;
then reconsider n2 = ( n - 2 ) as Nat by A6,NAT_1:21,XXREAL_0:2;
consider P being (Permutation of S) such that A9: ( P . 1 ) = i and A10: ( P . 2 ) = j and (for k holds ((k in ( Seg n ) & k > 2) implies (((k <= ( i + 1 ) implies ( P . k ) = ( k - 2 )) & ((( i + 1 ) < k & k <= j) implies ( P . k ) = ( k - 1 ))) & (k > j implies ( P . k ) = k)))) by A4,A5,A6,CKB25:1;
reconsider p = P as  one-to-one Function;
( dom P ) = S by FUNCT_2:52;
then A11: ( rng ( p " ) ) = S by FUNCT_1:33;
( rng P ) = S by FUNCT_2:def 3;
then ( dom ( p " ) ) = S by FUNCT_1:33;
then reconsider P1 = ( p " ) as  one-to-one (Function of S,S) by A11,FUNCT_2:1;
P1 is  onto by A11,FUNCT_2:def 3;
then reconsider P1 as (Permutation of S);
A12: ( dom P ) = S by FUNCT_2:52;
1 <= n by A6,A7,XXREAL_0:2;
then A13: 1 in S;
then A14: ( P1 . ( P . 1 ) ) = 1 by A12,FUNCT_1:34;
set A = ( (c,s) ][ (( - s ),c) );
set ONE = ( 1. (( F_Real ),n2) );
set ao = <* A,ONE *>;
set B = ( block_diagonal (ao,( 0. ( F_Real ) )) );
A15: ( len A ) = 2 by MATRIX_1:25;
then ( Len <* A *> ) = <* 2 *> by MATRIXJ1:15;
then A16: ( Sum ( Len <* A *> ) ) = 2 by RVSUM_1:73;
( len ONE ) = n2 by MATRIX_1:25;
then A17: ( Sum ( Len ao ) ) = ( 2 + n2 ) by A15,MATRIXJ1:16;
then reconsider B as (Matrix of n,( F_Real ));
A18: ( Indices B ) = [: S,S :] by MATRIX_1:24;
2 <= n by A6,A8,XXREAL_0:2;
then A19: 2 in S;
then A20: ( P1 . ( P . 2 ) ) = 2 by A12,FUNCT_1:34;
set pBp = ( ( ( ( B * P1 ) @ ) * P1 ) @ );
A21: ( dom P1 ) = S by FUNCT_2:52;
i < n by A5,A6,XXREAL_0:2;
then A22: i in S by A4,FINSEQ_1:1;
then [ i,i ] in ( Indices B ) by A18,ZFMISC_1:87;
then A23: ( pBp * (i,i) ) = ( B * (1,1) ) by A9,A14,CKB1:1;
take pBp;
A24: ( Indices pBp ) = [: S,S :] by MATRIX_1:24;
A25: ( Det B ) = ( 1. ( F_Real ) ) by A17,CKB24:1;
A26: ( block_diagonal (<* A *>,( 0. ( F_Real ) )) ) = A by MATRIXJ1:34;
( width A ) = 2 by MATRIX_1:24;
then ( Width <* A *> ) = <* 2 *> by MATRIXJ1:19;
then A27: ( Sum ( Width <* A *> ) ) = 2 by RVSUM_1:73;
1 < j by A4,A5,XXREAL_0:2;
then A28: j in S by A6,FINSEQ_1:1;
then [ j,j ] in ( Indices B ) by A18,ZFMISC_1:87;
then A29: ( pBp * (j,j) ) = ( B * (2,2) ) by A10,A20,CKB1:1;
A30: ( block_diagonal (<* ONE *>,( 0. ( F_Real ) )) ) = ONE by MATRIXJ1:34;
[ 1,1 ] in ( Indices A ) by MATRIX_2:4;
then A31: ( B * (1,1) ) = ( A * (1,1) ) by A26,A30,MATRIXJ1:26;
[ 2,1 ] in ( Indices A ) by MATRIX_2:4;
then A32: ( B * (2,1) ) = ( A * (2,1) ) by A26,A30,MATRIXJ1:26;
[ 1,2 ] in ( Indices A ) by MATRIX_2:4;
then A33: ( B * (1,2) ) = ( A * (1,2) ) by A26,A30,MATRIXJ1:26;
[ 2,2 ] in ( Indices A ) by MATRIX_2:4;
then A34: ( B * (2,2) ) = ( A * (2,2) ) by A26,A30,MATRIXJ1:26;
A35: ( <* A *> ^ <* ONE *> ) = ao;
[ i,j ] in ( Indices B ) by A18,A22,A28,ZFMISC_1:87;
then A36: ( pBp * (i,j) ) = ( B * (1,2) ) by A9,A10,A14,A20,CKB1:1;
[ j,i ] in ( Indices B ) by A18,A22,A28,ZFMISC_1:87;
then ( pBp * (j,i) ) = ( B * (2,1) ) by A9,A10,A14,A20,CKB1:1;
hence ((((( Det pBp ) = ( 1. ( F_Real ) ) & ( pBp * (i,i) ) = ( cos r )) & ( pBp * (j,j) ) = ( cos r )) & ( pBp * (i,j) ) = ( sin r )) & ( pBp * (j,i) ) = ( - ( sin r ) )) by A23,A25,A29,A34,A33,A32,A31,A36,CKB1:1,MATRIX_2:6;
let k;
let m;
assume that
A37: [ k,m ] in ( Indices pBp );
A38: k in S by A24,A37,ZFMISC_1:87;
set Pk = ( P1 . k );
set Pm = ( P1 . m );
A39: ( rng P1 ) = S by FUNCT_2:def 3;
then A40: Pk in S by A21,A38,FUNCT_1:def 3;
then A41: Pk >= 1 by FINSEQ_1:1;
A42: m in S by A24,A37,ZFMISC_1:87;
then A43: Pm in S by A21,A39,FUNCT_1:def 3;
then A44: [ Pk,Pm ] in [: S,S :] by A40,ZFMISC_1:87;
A45: ( pBp * (k,m) ) = ( B * (Pk,Pm) ) by A18,A24,A37,CKB1:1;
thus (((k = m & k <> i) & k <> j) implies ( pBp * (k,k) ) = ( 1. ( F_Real ) ))
proof
assume that
A46: k = m
and
A47: (k <> i & k <> j);
(Pk <> 1 & Pk <> 2) by A9,A10,A14,A20,A21,A22,A28,A38,A47,FUNCT_1:def 4;
then A48: Pk > 2 by A1,A41;
then reconsider Pk2 = ( Pk - 2 ) as Nat by NAT_1:21;
(Pk = ( Pk2 + 2 ) & Pk2 > ( 2 - 2 )) by A48,XREAL_1:8;
then A49: [ Pk2,Pk2 ] in ( Indices ONE ) by A16,A18,A27,A30,A44,A46,MATRIXJ1:27;
then ( ONE * (Pk2,Pk2) ) = ( B * (( Pk2 + 2 ),( Pk2 + 2 )) ) by A16,A27,A30,MATRIXJ1:28;
hence thesis by A45,A46,A49,MATRIX_1:def 11;
end;

A50: Pm >= 1 by A43,FINSEQ_1:1;
thus ((k <> m & { k,m } <> { i,j }) implies ( pBp * (k,m) ) = ( 0. ( F_Real ) ))
proof
assume that
A51: k <> m
and
A52: { k,m } <> { i,j };
A53: Pk <> Pm by A21,A38,A42,A51,FUNCT_1:def 4;
per cases  by A52;
suppose A54: (((k <> i & k <> j) & m <> i) & m <> j);

then (Pk <> 1 & Pk <> 2) by A9,A10,A14,A20,A21,A22,A28,A38,FUNCT_1:def 4;
then A55: Pk > 2 by A1,A41;
(Pm <> 1 & Pm <> 2) by A9,A10,A14,A20,A21,A22,A28,A42,A54,FUNCT_1:def 4;
then A56: Pm > 2 by A1,A50;
then reconsider Pk2 = ( Pk - 2 ),Pm2 = ( Pm - 2 ) as Nat by A55,NAT_1:21;
A57: Pk2 > ( 2 - 2 ) by A55,XREAL_1:8;
A58: (Pk = ( Pk2 + 2 ) & Pm = ( Pm2 + 2 ));
Pm2 > ( 2 - 2 ) by A56,XREAL_1:8;
then A59: [ Pk2,Pm2 ] in ( Indices ONE ) by A16,A18,A27,A30,A44,A58,A57,MATRIXJ1:27;
then ( ONE * (Pk2,Pm2) ) = ( B * (( Pk2 + 2 ),( Pm2 + 2 )) ) by A16,A27,A30,MATRIXJ1:28;
hence thesis by A45,A53,A59,MATRIX_1:def 11;
end;
suppose A60: (k = i & m <> j);

then Pm <> 2 by A10,A20,A21,A28,A42,FUNCT_1:def 4;
then A61: Pm > 2 by A1,A9,A14,A50,A53,A60;
Pk = 1 by A9,A12,A13,A60,FUNCT_1:34;
hence thesis by A16,A18,A27,A35,A44,A45,A61,MATRIXJ1:29;
end;
suppose A62: (k = j & m <> i);

then Pm <> 1 by A9,A14,A21,A22,A42,FUNCT_1:def 4;
then A63: Pm > 2 by A1,A10,A20,A50,A53,A62;
Pk = 2 by A10,A12,A19,A62,FUNCT_1:34;
hence thesis by A16,A18,A27,A35,A44,A45,A63,MATRIXJ1:29;
end;
suppose A64: (m = i & k <> j);

then Pk <> 2 by A10,A20,A21,A28,A38,FUNCT_1:def 4;
then A65: Pk > 2 by A1,A9,A14,A41,A53,A64;
Pm = 1 by A9,A12,A13,A64,FUNCT_1:34;
hence thesis by A16,A18,A27,A35,A44,A45,A65,MATRIXJ1:29;
end;
suppose A66: (m = j & k <> i);

then Pk <> 1 by A9,A14,A21,A22,A38,FUNCT_1:def 4;
then A67: Pk > 2 by A1,A10,A20,A41,A53,A66;
Pm = 2 by A10,A12,A19,A66,FUNCT_1:34;
hence thesis by A16,A18,A27,A35,A44,A45,A67,MATRIXJ1:29;
end;
end;

end;
