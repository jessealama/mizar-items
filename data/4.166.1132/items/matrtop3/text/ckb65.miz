environ
vocabularies NUMBERS,SUBSET_1,XREAL_0,ORDINAL1,PRE_TOPC,EUCLID,ARYTM_1,ARYTM_3,SUPINF_2,XBOOLE_0,RELAT_1,CARD_1,VALUED_0,FINSEQ_1,COMPLEX1,SQUARE_1,CARD_3,RVSUM_1,XXREAL_0,NAT_1,TARSKI,STRUCT_0,REAL_1,FUNCT_1,UNIALG_1,MSSUBFAM,FUNCOP_1,FINSEQ_2,ALGSTR_0,FUNCT_2,FVSUM_1,INCSP_1,MATRIX_1,MATRIX_3,MATRIX13,MATRLIN,MATRLIN2,MESFUNC1,ORDINAL4,PARTFUN1,PRVECT_1,QC_LANG1,RLVECT_2,RLVECT_3,TREES_1,VALUED_1,VECTSP_1,MATRIXJ1,ZFMISC_1,BINOP_1,GROUP_1,ABIAN,MATRIX_2,XXREAL_1,SIN_COS,FINSOP_1,FUNCT_4,MATRIX_6,PRE_POLY,TOPS_2,RFINSEQ,MONOID_0,MATRIXR2,MATRTOP3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,NAT_D,FUNCOP_1,FINSEQ_1,PRE_POLY,RFINSEQ,FINSEQ_2,RVSUM_1,VALUED_0,SQUARE_1,STRUCT_0,PRE_TOPC,TOPS_2,RLVECT_1,EUCLID,GRCAT_1,TOPREAL9,CARD_1,VECTSP_1,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_6,GROUP_1,MATRIX11,MATRTOP1,SIN_COS,ALGSTR_0,MATRIX_7,BINOP_1,FVSUM_1,RCOMP_1,SEQ_1,MONOID_0,GROUP_4,PRVECT_1,RLVECT_2,RLVECT_3,FUNCT_7,MATRIX13,MATRIXR2,FINSOP_1,MATRLIN,MATRLIN2,MOD_2,MATRIXJ1,TMAP_1,CKB4,CKB15,CKB27,CKB45,CKB47,CKB57;
definitions TARSKI,SQUARE_1,EUCLID,XCMPLX_0,ALGSTR_0,STRUCT_0,GRCAT_1,TOPREAL9,FINSEQ_1,MATRTOP1,VECTSP_1,MATRIX_7,FVSUM_1,NAT_D,CKB4,CKB15,CKB27,CKB45,CKB47,CKB57;
theorems XREAL_0,TARSKI,FUNCT_2,EUCLID,XBOOLE_1,XBOOLE_0,JORDAN2C,SQUARE_1,XCMPLX_1,ABSVALUE,RVSUM_1,EUCLID_2,ENUMSET1,XREAL_1,XXREAL_0,RLVECT_1,ORDINAL1,GRCAT_1,CARD_1,CARD_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FUNCT_1,FVSUM_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_6,MATRIX13,MATRIXR1,MATRLIN2,MATRTOP1,NAT_1,PARTFUN1,PRE_POLY,RELAT_1,RLSUB_1,RLVECT_2,RLVECT_3,STRUCT_0,TOPREAL7,ZFMISC_1,MATRIXJ1,STIRL2_1,TOPS_2,TOPREAL9,MATRIX_9,SIN_COS,MATRIX_7,MATRIXR2,MATRIX11,MATRIX_3,MATRIX15,RFINSEQ,FINSEQ_7,SIN_COS6,XXREAL_1,GROUP_4,MONOID_0,GROUP_1,FINSEQ_5,TMAP_1,RLVECT_4,FUNCT_7,TOPREALC,VALUED_1,INT_1,FINSOP_1,MOD_2,CKB1,CKB2,CKB3,CKB4,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB51,CKB52,CKB53,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64;
schemes NAT_1,FINSEQ_4,MATRIX_1;
registrations XBOOLE_0,XXREAL_0,XREAL_0,SQUARE_1,NAT_1,MEMBERED,STRUCT_0,MONOID_0,EUCLID,VALUED_0,FINSEQ_1,FUNCT_1,RELAT_1,TOPREAL9,CARD_1,FINSEQ_2,FINSET_1,FUNCT_2,MATRIX13,MATRIX_2,MATRTOP1,NUMBERS,PRVECT_1,RELSET_1,RLVECT_2,VECTSP_1,XCMPLX_0,SIN_COS,MATRIX11,MATRIXJ1,GRCAT_1,BORSUK_3,FUNCOP_1,MATRIX_1,INT_1,FUNCT_7,PRE_POLY,SUBSET_1,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB48,CKB49,CKB50,CKB54,CKB55,CKB56;
constructors REAL_1,SQUARE_1,BORSUK_1,MONOID_0,CONVEX1,TOPREAL9,BINARITH,FVSUM_1,LAPLACE,MATRIX_6,MATRIX11,TOPS_2,MATRIX13,MATRLIN2,MATRTOP1,REALSET1,RLVECT_3,SEQ_1,MATRIXJ1,RCOMP_1,ABIAN,SIN_COS,MATRIX_7,SETWISEO,GROUP_4,TMAP_1,FINSOP_1,MATRIXR2,SEQ_4,CKB4,CKB15,CKB27,CKB45,CKB47,CKB57;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
reserve x for set;
reserve i for Nat;
reserve j for Nat;
reserve k for Nat;
reserve n for Nat;
reserve p for (Point of ( TOP-REAL n ));
reserve f for  homogeneous  additive (Function of ( TOP-REAL n ),( TOP-REAL n ));
theorem
Th34: (f is { i } -support-yielding  rotation implies (( AutMt f ) = ( AxialSymmetry (i,n) ) or ( AutMt f ) = ( 1. (( F_Real ),n) )))
proof
set TR = ( TOP-REAL n );
set S = { ( Base_FinSeq (n,j) ) where j is (Element of ( NAT )): (1 <= j & j <= n) };
S c= (the carrier of TR)
proof
let x;
assume x in S;
then consider j being (Element of ( NAT )) such that A1: x = ( Base_FinSeq (n,j) ) and (1 <= j & j <= n);
( len ( Base_FinSeq (n,j) ) ) = n by MATRIXR2:74;
hence thesis by A1,TOPREAL7:17;
end;
then reconsider S as (Subset of TR);
set M = ( Mx2Tran ( AxialSymmetry (n,i) ) );
assume A2: f is { i } -support-yielding  rotation;
A3: ( id TR ) = ( Mx2Tran ( 1. (( F_Real ),n) ) ) by MATRTOP1:33;
then A4: ( AutMt ( id TR ) ) = ( 1. (( F_Real ),n) ) by CKB57:def 1;
A5: ( dom f ) = (the carrier of TR) by FUNCT_2:52;
per cases ;
suppose A6: (not i in ( Seg n ));

now
let p being (Point of TR);
A7:now
let j;
assume (1 <= j & j <= n);
then j <> i by A6,FINSEQ_1:1;
then (not j in { i }) by TARSKI:def 1;
hence ( ( f . p ) . j ) = ( p . j ) by A2,A5,CKB4:def 1;
end;
(( len ( f . p ) ) = n & ( len p ) = n) by CARD_1:def 7;
hence ( f . p ) = p by A7,FINSEQ_1:14;
end;
then f = ( id TR ) by FUNCT_2:124;
hence thesis by A3,CKB57:def 1;
end;
suppose A8: i in ( Seg n );

then (1 <= i & i <= n) by FINSEQ_1:1;
then ( Base_FinSeq (n,i) ) in S by A8;
then reconsider B = ( Base_FinSeq (n,i) ) as (Point of TR);
B = ( ( 0* n ) +* (i,1) ) by MATRIXR2:def 4;
then A9: |. B .| = ( abs 1 ) by A8,TOPREALC:13
.= 1 by ABSVALUE:def 1;
set B0 = ( ( 0* n ) +* (i,( ( f . B ) . i )) );
A10: ( len ( 0* n ) ) = n by CARD_1:def 7;
A11: (for j holds ((1 <= j & j <= n) implies ( ( f . B ) . j ) = ( B0 . j )))
proof
let j;
assume A12: (1 <= j & j <= n);
then A13: j in ( Seg n ) by FINSEQ_1:1;
A14: j in ( dom ( 0* n ) ) by A10,A12,FINSEQ_3:25;
per cases ;
suppose j = i;

hence ( B0 . j ) = ( ( f . B ) . j ) by A14,FUNCT_7:31;
end;
suppose A15: j <> i;

then A16: (not j in { i }) by TARSKI:def 1;
thus ( B0 . j ) = ( ( 0* n ) . j ) by A15,FUNCT_7:32
.= ( 0 ) by A13,FINSEQ_2:57
.= ( B . j ) by A12,A15,MATRIXR2:76
.= ( ( f . B ) . j ) by A2,A5,A16,CKB4:def 1;
end;
end;
(( len B0 ) = ( len ( 0* n ) ) & ( len ( f . B ) ) = n) by CARD_1:def 7,FUNCT_7:97;
then A17: ( f . B ) = B0 by A10,A11,FINSEQ_1:14;
then A18: |. B .| = |. B0 .| by A2,CKB45:def 1
.= ( abs ( ( f . B ) . i ) ) by A8,TOPREALC:13;
A19: (for h being  homogeneous  additive  rotation (Function of TR,TR) holds (( h | S ) = ( id S ) implies h = ( id TR )))
proof
let h being  homogeneous  additive  rotation (Function of TR,TR);
A20: ( dom ( id TR ) ) = (the carrier of TR) by FUNCT_2:def 1;
assume A21: ( h | S ) = ( id S );
A22: (for x holds (x in ( dom ( id TR ) ) implies ( ( id TR ) . x ) = ( h . x )))
proof
let x;
assume A23: x in ( dom ( id TR ) );
then reconsider p = x as (Point of TR) by FUNCT_2:def 1;
set hp = ( h . p );
A24: (( len p ) = n & ( len hp ) = n) by CARD_1:def 7;
A25:now
let j;
assume A26: (1 <= j & j <= n);
then A27: j in ( Seg n ) by FINSEQ_1:1;
then ( Base_FinSeq (n,j) ) in S by A26;
then ( Base_FinSeq (n,j) ) in ( Lin S ) by RLVECT_3:15;
hence ( p . j ) = ( hp . j ) by A21,A27,CKB61:1;
end;
( ( id TR ) . x ) = x by A20,A23,FUNCT_1:17;
hence thesis by A24,A25,FINSEQ_1:14;
end;
( dom h ) = (the carrier of TR) by FUNCT_2:def 1;
hence thesis by A20,A22,FUNCT_1:2;
end;
per cases ;
suppose A28: ( ( f . B ) . i ) >= ( 0 );

A29: ( dom ( f | S ) ) = S by A5,RELAT_1:62;
A30: ( ( f . B ) . i ) = 1 by A9,A18,A28,ABSVALUE:def 1;
A31: (for x holds (x in S implies ( ( f | S ) . x ) = ( ( id S ) . x )))
proof
let x;
assume A32: x in S;
then consider j being (Element of ( NAT )) such that A33: x = ( Base_FinSeq (n,j) ) and 1 <= j and j <= n;
A34: (( ( f | S ) . x ) = ( f . x ) & ( ( id S ) . x ) = x) by A29,A32,FUNCT_1:17,FUNCT_1:47;
per cases ;
suppose j = i;

hence thesis by A17,A30,A33,A34,MATRIXR2:def 4;
end;
suppose j <> i;

then (not j in { i }) by TARSKI:def 1;
hence thesis by A2,A33,A34,CKB64:1;
end;
end;
( dom ( id S ) ) = S by FUNCT_2:52;
hence thesis by A2,A4,A19,A29,A31,FUNCT_1:2;
end;
suppose A35: ( ( f . B ) . i ) < ( 0 );

set MA = ( Mx2Tran ( AxialSymmetry (i,n) ) );
MA is  rotation by A8,CKB46:1;
then reconsider MAf = ( MA * f ) as  homogeneous  additive  rotation (Function of TR,TR) by A2;
A36: ( dom MAf ) = (the carrier of TR) by FUNCT_2:52;
then A37: ( dom ( MAf | S ) ) = S by RELAT_1:62;
A38: (MA is { i } -support-yielding & ( { i } \/ { i } ) = { i }) by A8,CKB23:1;
A39: (for x holds (x in S implies ( ( MAf | S ) . x ) = ( ( id S ) . x )))
proof
let x;
assume A40: x in S;
then consider j being (Element of ( NAT )) such that A41: x = ( Base_FinSeq (n,j) ) and (1 <= j & j <= n);
A42: (( ( MAf | S ) . x ) = ( MAf . x ) & ( ( id S ) . x ) = x) by A37,A40,FUNCT_1:17,FUNCT_1:47;
per cases ;
suppose A43: j = i;

A44: (for k holds ((1 <= k & k <= n) implies ( ( MAf . B ) . k ) = ( B . k )))
proof
let k;
assume A45: (1 <= k & k <= n);
then A46: k in ( Seg n ) by FINSEQ_1:1;
per cases ;
suppose A47: k = i;

thus ( ( MAf . B ) . k ) = ( ( MA . ( f . B ) ) . k ) by A36,FUNCT_1:12
.= ( - ( ( f . B ) . k ) ) by A46,A47,CKB21:1
.= ( - ( - 1 ) ) by A9,A18,A35,A47,ABSVALUE:def 1
.= ( B . k ) by A45,A47,MATRIXR2:75;
end;
suppose A48: k <> i;

then A49: (not k in { i }) by TARSKI:def 1;
thus ( ( MAf . B ) . k ) = ( ( MA . ( f . B ) ) . k ) by A36,FUNCT_1:12
.= ( ( f . B ) . k ) by A8,A48,CKB20:1
.= ( B . k ) by A2,A5,A49,CKB4:def 1;
end;
end;
(( len ( MAf . B ) ) = n & ( len B ) = n) by CARD_1:def 7;
hence thesis by A41,A42,A43,A44,FINSEQ_1:14;
end;
suppose j <> i;

then (not j in { i }) by TARSKI:def 1;
hence thesis by A2,A38,A41,A42,CKB64:1;
end;
end;
( dom ( id S ) ) = S by FUNCT_2:52;
then A50: MAf = ( id TR ) by A19,A37,A39,FUNCT_1:2;
A51: ( dom MA ) = ( [#] TR ) by TOPS_2:def 5;
set R = ( AutMt f );
A52: ( rng MA ) = ( [#] TR ) by TOPS_2:def 5;
A53: MA is  one-to-one by TOPS_2:def 5;
A54: (the carrier of TR) c= ( rng f )
proof
let x;
assume A55: x in (the carrier of TR);
then A56: ( MA . x ) in ( rng MA ) by A51,FUNCT_1:def 3;
then A57: ( MAf . ( MA . x ) ) = ( MA . ( f . ( MA . x ) ) ) by A36,A52,FUNCT_1:12;
(( f . ( MA . x ) ) in ( dom MA ) & ( MAf . ( MA . x ) ) = ( MA . x )) by A36,A50,A52,A56,FUNCT_1:11,FUNCT_1:18;
then x = ( f . ( MA . x ) ) by A51,A53,A55,A57,FUNCT_1:def 4;
hence thesis by A5,A52,A56,FUNCT_1:def 3;
end;
( rng f ) c= (the carrier of TR) by RELAT_1:def 19;
then ( rng f ) = (the carrier of TR) by A54,XBOOLE_0:def 10;
then A58: f = ( (MA qua Function) " ) by A50,A52,A51,A53,FUNCT_1:42;
(f = ( Mx2Tran R ) & ( Det ( AxialSymmetry (i,n) ) ) <> ( 0. ( F_Real ) )) by A8,CKB57:def 1,CKB16:1;
then R = ( ( AxialSymmetry (i,n) ) ~ ) by A58,MATRTOP1:43
.= ( AxialSymmetry (i,n) ) by A8,CKB19:1;
hence thesis;
end;
end;
end;
