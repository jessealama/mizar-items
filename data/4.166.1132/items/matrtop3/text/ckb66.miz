environ
vocabularies NUMBERS,SUBSET_1,XREAL_0,ORDINAL1,PRE_TOPC,EUCLID,ARYTM_1,ARYTM_3,SUPINF_2,XBOOLE_0,RELAT_1,CARD_1,VALUED_0,FINSEQ_1,COMPLEX1,SQUARE_1,CARD_3,RVSUM_1,XXREAL_0,NAT_1,TARSKI,STRUCT_0,REAL_1,FUNCT_1,UNIALG_1,MSSUBFAM,FUNCOP_1,FINSEQ_2,ALGSTR_0,FUNCT_2,FVSUM_1,INCSP_1,MATRIX_1,MATRIX_3,MATRIX13,MATRLIN,MATRLIN2,MESFUNC1,ORDINAL4,PARTFUN1,PRVECT_1,QC_LANG1,RLVECT_2,RLVECT_3,TREES_1,VALUED_1,VECTSP_1,MATRIXJ1,ZFMISC_1,BINOP_1,GROUP_1,ABIAN,MATRIX_2,XXREAL_1,SIN_COS,FINSOP_1,FUNCT_4,MATRIX_6,PRE_POLY,TOPS_2,RFINSEQ,MONOID_0,MATRIXR2,MATRTOP3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,NAT_D,FUNCOP_1,FINSEQ_1,PRE_POLY,RFINSEQ,FINSEQ_2,RVSUM_1,VALUED_0,SQUARE_1,STRUCT_0,PRE_TOPC,TOPS_2,RLVECT_1,EUCLID,GRCAT_1,TOPREAL9,CARD_1,VECTSP_1,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_6,GROUP_1,MATRIX11,MATRTOP1,SIN_COS,ALGSTR_0,MATRIX_7,BINOP_1,FVSUM_1,RCOMP_1,SEQ_1,MONOID_0,GROUP_4,PRVECT_1,RLVECT_2,RLVECT_3,FUNCT_7,MATRIX13,MATRIXR2,FINSOP_1,MATRLIN,MATRLIN2,MOD_2,MATRIXJ1,TMAP_1,CKB4,CKB15,CKB27,CKB45,CKB47,CKB57;
definitions TARSKI,SQUARE_1,EUCLID,XCMPLX_0,ALGSTR_0,STRUCT_0,GRCAT_1,TOPREAL9,FINSEQ_1,MATRTOP1,VECTSP_1,MATRIX_7,FVSUM_1,NAT_D,CKB4,CKB15,CKB27,CKB45,CKB47,CKB57;
theorems XREAL_0,TARSKI,FUNCT_2,EUCLID,XBOOLE_1,XBOOLE_0,JORDAN2C,SQUARE_1,XCMPLX_1,ABSVALUE,RVSUM_1,EUCLID_2,ENUMSET1,XREAL_1,XXREAL_0,RLVECT_1,ORDINAL1,GRCAT_1,CARD_1,CARD_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FUNCT_1,FVSUM_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_6,MATRIX13,MATRIXR1,MATRLIN2,MATRTOP1,NAT_1,PARTFUN1,PRE_POLY,RELAT_1,RLSUB_1,RLVECT_2,RLVECT_3,STRUCT_0,TOPREAL7,ZFMISC_1,MATRIXJ1,STIRL2_1,TOPS_2,TOPREAL9,MATRIX_9,SIN_COS,MATRIX_7,MATRIXR2,MATRIX11,MATRIX_3,MATRIX15,RFINSEQ,FINSEQ_7,SIN_COS6,XXREAL_1,GROUP_4,MONOID_0,GROUP_1,FINSEQ_5,TMAP_1,RLVECT_4,FUNCT_7,TOPREALC,VALUED_1,INT_1,FINSOP_1,MOD_2,CKB1,CKB2,CKB3,CKB4,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB51,CKB52,CKB53,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65;
schemes NAT_1,FINSEQ_4,MATRIX_1;
registrations XBOOLE_0,XXREAL_0,XREAL_0,SQUARE_1,NAT_1,MEMBERED,STRUCT_0,MONOID_0,EUCLID,VALUED_0,FINSEQ_1,FUNCT_1,RELAT_1,TOPREAL9,CARD_1,FINSEQ_2,FINSET_1,FUNCT_2,MATRIX13,MATRIX_2,MATRTOP1,NUMBERS,PRVECT_1,RELSET_1,RLVECT_2,VECTSP_1,XCMPLX_0,SIN_COS,MATRIX11,MATRIXJ1,GRCAT_1,BORSUK_3,FUNCOP_1,MATRIX_1,INT_1,FUNCT_7,PRE_POLY,SUBSET_1,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB48,CKB49,CKB50,CKB54,CKB55,CKB56;
constructors REAL_1,SQUARE_1,BORSUK_1,MONOID_0,CONVEX1,TOPREAL9,BINARITH,FVSUM_1,LAPLACE,MATRIX_6,MATRIX11,TOPS_2,MATRIX13,MATRLIN2,MATRTOP1,REALSET1,RLVECT_3,SEQ_1,MATRIXJ1,RCOMP_1,ABIAN,SIN_COS,MATRIX_7,SETWISEO,GROUP_4,TMAP_1,FINSOP_1,MATRIXR2,SEQ_4,CKB4,CKB15,CKB27,CKB45,CKB47,CKB57;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
reserve x for set;
reserve i for Nat;
reserve j for Nat;
reserve k for Nat;
reserve n for Nat;
reserve p for (Point of ( TOP-REAL n ));
reserve f1 for  homogeneous  additive (Function of ( TOP-REAL n ),( TOP-REAL n ));
reserve f2 for  homogeneous  additive (Function of ( TOP-REAL n ),( TOP-REAL n ));
theorem
Th35: (f1 is  rotation implies (ex f2 st (f2 is  base_rotation & ( f2 * f1 ) is { n } -support-yielding)))
proof
set TR = ( TOP-REAL n );
assume A1: f1 is  rotation;
set cTR = (the carrier of TR);
set f = f1;
A2: ( dom f ) = cTR by FUNCT_2:52;
A3: ( rng f ) c= cTR by RELAT_1:def 19;
per cases ;
suppose A4: n = ( 0 );

take I = ( id TR );
A5: ( dom ( id cTR ) ) = cTR by RELAT_1:45;
A6: (for h being Function holds (for x being set holds ((h in ( dom I ) & ( ( I . h ) . x ) <> ( h . x )) implies x in { n }))) by A5,FUNCT_1:17;
A7: cTR = { ( 0. TR ) } by A4,JORDAN2C:105,EUCLID:22;
then (( rng ( id cTR ) ) = cTR & ( rng f ) = cTR) by A3,RELAT_1:45,ZFMISC_1:33;
then f = ( id cTR ) by A2,A5,A7,FUNCT_1:7;
then ( I * f ) = I by A2,RELAT_1:52;
hence thesis by A6,CKB4:def 1;
end;
suppose n > ( 0 );

then reconsider n1 = ( n - 1 ) as Nat by NAT_1:20;
defpred P[ Nat ]
 means
($1 <= ( n - 1 ) implies (for S being (Subset of TR) holds (S = { ( Base_FinSeq (n,i) ) where i is (Element of ( NAT )): (1 <= i & i <= $1) } implies (ex g being  base_rotation (Function of TR,TR) st ( ( g * f ) | S ) = ( id S )))));
set S = { ( Base_FinSeq (n,i) ) where i is (Element of ( NAT )): (1 <= i & i <= n1) };
S c= (the carrier of TR)
proof
let x;
assume x in S;
then consider j being (Element of ( NAT )) such that A8: x = ( Base_FinSeq (n,j) ) and 1 <= j and j <= n1;
( len ( Base_FinSeq (n,j) ) ) = n by MATRIXR2:74;
hence thesis by A8,TOPREAL7:17;
end;
then reconsider S as (Subset of TR);
A9: (for k holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let z being Nat;
assume A10: P[ z ];
set z1 = ( z + 1 );
set SS = { ( Base_FinSeq (n,i) ) where i is (Element of ( NAT )): (1 <= i & i <= z) };
assume A11: z1 <= ( n - 1 );
then reconsider n1 = ( n - 1 ) as (Element of ( NAT )) by INT_1:3;
A12: n1 < ( n1 + 1 ) by NAT_1:13;
then A13: z1 < n by A11,XXREAL_0:2;
set B = ( Base_FinSeq (n,z1) );
set X = { i where i is (Element of ( NAT )): (z1 <= i & i <= n) };
let S being (Subset of TR);
assume that
A14: S = { ( Base_FinSeq (n,i) ) where i is (Element of ( NAT )): (1 <= i & i <= z1) };
SS c= S
proof
let x;
assume x in SS;
then consider i being (Element of ( NAT )) such that A15: (x = ( Base_FinSeq (n,i) ) & 1 <= i) and A16: i <= z;
i < z1 by A16,NAT_1:13;
hence thesis by A14,A15;
end;
then reconsider SS as (Subset of TR) by XBOOLE_1:1;
z < n1 by A11,NAT_1:13;
then consider g being  base_rotation (Function of TR,TR) such that A17: ( ( g * f ) | SS ) = ( id SS ) by A10;
A18: n in ( NAT ) by ORDINAL1:def 12;
then A19: n in X by A13;
n >= 1 by A12,NAT_1:14;
then n in ( Seg n ) by A18;
then A20: n in ( X /\ ( Seg n ) ) by A19,XBOOLE_0:def 4;
A21: ( card { z1,n } ) = 2 by A11,A12,CARD_2:57;
A22: 1 <= z1 by NAT_1:11;
then A23: z1 in ( Seg n ) by A13;
B in S by A14,A22;
then reconsider B as (Point of TR);
set gfB = ( ( g * f ) . B );
A24: z1 in X by A13;
then consider h being  homogeneous  additive (Function of TR,TR) such that A25: h is X -support-yielding  base_rotation and A26: (( card ( X /\ ( Seg n ) ) ) > 1 implies ( ( h . gfB ) . z1 ) >= ( 0 )) and A27: (for i holds ((i in ( X /\ ( Seg n ) ) & i <> z1) implies ( ( h . gfB ) . i ) = ( 0 ))) by A23,CKB59:1;
reconsider hg = ( h * g ) as  base_rotation (Function of TR,TR) by A25;
A28: ( dom ( hg * f ) ) = (the carrier of TR) by FUNCT_2:52;
A29: (for x holds (x in SS implies (( ( ( h * g ) * f ) . x ) = x & ( h . x ) = x)))
proof
let x;
assume that
A30: x in SS;
reconsider B = x as (Point of TR) by A30;
( ( ( g * f ) | SS ) . x ) = ( ( g * f ) . x ) by A30,FUNCT_1:49;
then A31: ( ( g * f ) . x ) = x by A17,A30,FUNCT_1:17;
A32: (ex i being (Element of ( NAT )) st ((x = ( Base_FinSeq (n,i) ) & 1 <= i) & i <= z)) by A30;
A33: (for j holds (j in ( X /\ ( Seg n ) ) implies ( B . j ) = ( 0 )))
proof
let j;
assume A34: j in ( X /\ ( Seg n ) );
then j in X by XBOOLE_0:def 4;
then (ex I being (Element of ( NAT )) st ((I = j & z1 <= I) & I <= n));
then A35: z < j by NAT_1:13;
j in ( Seg n ) by A34,XBOOLE_0:def 4;
then (1 <= j & j <= n) by FINSEQ_1:1;
hence thesis by A32,A35,MATRIXR2:76;
end;
A36: ( hg * f ) = ( h * ( g * f ) ) by RELAT_1:36;
then ( ( h * ( g * f ) ) . x ) = ( h . ( ( g * f ) . x ) ) by A28,A30,FUNCT_1:12;
hence thesis by A25,A31,A33,A36,CKB62:1;
end;
z1 in ( X /\ ( Seg n ) ) by A23,A24,XBOOLE_0:def 4;
then { z1,n } c= ( X /\ ( Seg n ) ) by A20,ZFMISC_1:32;
then A37: ( 1 + 1 ) <= ( card ( X /\ ( Seg n ) ) ) by A21,NAT_1:43;
A38: (for x holds (x in S implies ( ( ( hg * f ) | S ) . x ) = ( ( id S ) . x )))
proof
let x;
assume that
A39: x in S;
A40: ( ( id S ) . x ) = x by A39,FUNCT_1:17;
A41: ( hg * f ) = ( h * ( g * f ) ) by RELAT_1:36;
A42: ( ( ( hg * f ) | S ) . x ) = ( ( hg * f ) . x ) by A39,FUNCT_1:49;
consider i being (Element of ( NAT )) such that A43: x = ( Base_FinSeq (n,i) ) and A44: 1 <= i and A45: i <= z1 by A14,A39;
per cases  by A45,NAT_1:8;
suppose i <= z;

then x in SS by A43,A44;
hence thesis by A29,A40,A42;
end;
suppose A46: i = z1;

set H = ( h . gfB );
A47: ( ( h * ( g * f ) ) . x ) = ( h . gfB ) by A28,A41,A43,A46,FUNCT_1:12;
A48: ( len H ) = n by CARD_1:def 7;
A49: (for j holds ((j in ( Seg n ) & j < z1) implies ( ( h . gfB ) . j ) = ( 0 )))
proof
let j;
assume that
A50: j in ( Seg n )
and
A51: j < z1;
A52: 1 <= j by A50,FINSEQ_1:1;
j <= z by A51,NAT_1:13;
then A53: ( Base_FinSeq (n,j) ) in SS by A50,A52;
then reconsider Bnj = ( Base_FinSeq (n,j) ) as (Point of TR);
( ( ( h * g ) * f ) . Bnj ) = Bnj by A29,A53;
then A54: ( Bnj + H ) = ( ( ( h * g ) * f ) . ( Bnj + B ) ) by A41,A43,A46,A47,GRCAT_1:def 8;
A55: ( len Bnj ) = n by CARD_1:def 7;
|. ( ( ( h * g ) * f ) . ( Bnj + B ) ) .| = |. ( Bnj + B ) .| by A1,A25,CKB45:def 1;
then A56: ( |. ( Bnj + B ) .| ^2 ) = ( ( ( |. Bnj .| ^2 ) + ( 2 * |( H,Bnj )| ) ) + ( |. H .| ^2 ) ) by A48,A54,A55,EUCLID_2:11;
A57: Bnj = ( ( 0* n ) +* (j,1) ) by MATRIXR2:def 4;
( len B ) = n by CARD_1:def 7;
then A58: ( |. ( Bnj + B ) .| ^2 ) = ( ( ( |. Bnj .| ^2 ) + ( 2 * |( B,Bnj )| ) ) + ( |. B .| ^2 ) ) by A55,EUCLID_2:11;
A59: j <= n by A50,FINSEQ_1:1;
|. H .| = |. B .| by A1,A25,A43,A46,A47,CKB45:def 1;
then ( ( B . j ) * 1 ) = |( H,Bnj )| by A56,A57,A58,TOPREALC:16
.= ( ( H . j ) * 1 ) by A57,TOPREALC:16;
hence thesis by A51,A52,A59,MATRIXR2:76;
end;
set H = ( h . gfB );
set 0H = ( ( 0* n ) +* (z1,( H . z1 )) );
A60: ( len ( 0* n ) ) = n by CARD_1:def 7;
A61: (for j holds ((j in ( Seg n ) & j > z1) implies ( ( h . gfB ) . j ) = ( 0 )))
proof
let j;
assume that
A62: j in ( Seg n )
and
A63: j > z1;
j <= n by A62,FINSEQ_1:1;
then j in X by A62,A63;
then j in ( X /\ ( Seg n ) ) by A62,XBOOLE_0:def 4;
hence thesis by A27,A63;
end;
A64: (for j holds ((1 <= j & j <= n) implies ( H . j ) = ( 0H . j )))
proof
let j;
assume (1 <= j & j <= n);
then A65: j in ( Seg n ) by FINSEQ_1:1;
then A66: j in ( dom ( 0* n ) ) by A60,FINSEQ_1:def 3;
per cases ;
suppose j = z1;

hence thesis by A66,FUNCT_7:31;
end;
suppose A67: j <> z1;

then (j > z1 or j < z1) by XXREAL_0:1;
then A68: ( H . j ) = ( 0 ) by A49,A61,A65;
( 0H . j ) = ( ( 0* n ) . j ) by A67,FUNCT_7:32;
hence thesis by A65,A68,FINSEQ_2:57;
end;
end;
(( len H ) = n & ( len 0H ) = ( len ( 0* n ) )) by CARD_1:def 7,FUNCT_7:97;
then A69: 0H = H by A60,A64,FINSEQ_1:14;
A70: |. gfB .| = |. B .| by A1,CKB45:def 1;
A71: B = ( ( 0* n ) +* (z1,1) ) by MATRIXR2:def 4;
then A72: |. B .| = ( abs 1 ) by A23,TOPREALC:13
.= 1 by ABSVALUE:def 1;
(|. H .| = |. gfB .| & ( abs ( H . z1 ) ) = ( H . z1 )) by A25,A26,A37,CKB45:def 1,ABSVALUE:def 1,NAT_1:13;
then H = B by A23,A69,A71,A72,A70,TOPREALC:13;
hence thesis by A39,A40,A41,A43,A46,A47,FUNCT_1:49;
end;
end;
take hg;
(( dom ( id S ) ) = S & ( dom ( ( hg * f ) | S ) ) = S) by A28,RELAT_1:45,RELAT_1:62;
hence thesis by A38,FUNCT_1:2;
end;
A73: P[ ( 0 ) ]
proof
assume ( 0 ) <= ( n - 1 );
let S being (Subset of TR);
assume that
A74: S = { ( Base_FinSeq (n,i) ) where i is (Element of ( NAT )): (1 <= i & i <= ( 0 )) };
A75: S = ( {} )
proof
assume S <> ( {} );
then consider x being set such that A76: x in S by XBOOLE_0:def 1;
(ex i being (Element of ( NAT )) st ((x = ( Base_FinSeq (n,i) ) & 1 <= i) & i <= ( 0 ))) by A74,A76;
hence contradiction;
end;
take g = ( id ( TOP-REAL n ) );
( ( g * f ) | S ) = ( {} ) by A75;
hence thesis by A75;
end;
(for k holds P[ k ]) from NAT_1:sch 2(A73,A9);
then consider g being  base_rotation (Function of TR,TR) such that A77: ( ( g * f ) | S ) = ( id S );
take g;
set gf = ( g * f );
thus g is  base_rotation;
let p being Function;
let x being set;
assume that
A78: p in ( dom gf )
and
A79: ( ( gf . p ) . x ) <> ( p . x );
reconsider p as (Point of TR) by A78,FUNCT_2:52;
( len ( gf . p ) ) = n by CARD_1:def 7;
then ( dom ( gf . p ) ) = ( Seg n ) by FINSEQ_1:def 3;
then A80: ((not x in ( Seg n )) implies ( ( gf . p ) . x ) = ( {} )) by FUNCT_1:def 2;
( len p ) = n by CARD_1:def 7;
then ( dom p ) = ( Seg n ) by FINSEQ_1:def 3;
then A81: x in ( Seg n ) by A79,A80,FUNCT_1:def 2;
assume A82: (not x in { n });
reconsider x as Nat by A81;
A83: x <= n by A81,FINSEQ_1:1;
x <> n by A82,TARSKI:def 1;
then x < ( n1 + 1 ) by A83,XXREAL_0:1;
then A84: x <= n1 by NAT_1:13;
(x in ( NAT ) & 1 <= x) by A81,FINSEQ_1:1;
then ( Base_FinSeq (n,x) ) in S by A84;
then ( Base_FinSeq (n,x) ) in ( Lin S ) by RLVECT_3:15;
then ( ( gf . p ) . x ) = ( p . x ) by A1,A77,A81,CKB61:1;
hence contradiction by A79;
end;
end;
