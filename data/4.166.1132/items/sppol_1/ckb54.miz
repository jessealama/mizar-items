environ
vocabularies NUMBERS,SUBSET_1,XREAL_0,ORDINAL1,NAT_1,ARYTM_3,XXREAL_0,ARYTM_1,FINSEQ_1,XBOOLE_0,RELAT_1,FINSET_1,TARSKI,COMPLEX1,REAL_1,PRE_TOPC,EUCLID,METRIC_1,FUNCT_1,RCOMP_1,RLTOPSP1,CARD_1,SEQ_4,XXREAL_2,PCOMPS_1,STRUCT_0,SUPINF_2,TEX_2,COMPTS_1,TOPREAL1,BORSUK_1,TOPS_2,ORDINAL2,MCART_1,ZFMISC_1,PARTFUN1,SETFAM_1,SPPOL_1;
notations TARSKI,XBOOLE_0,SUBSET_1,SETFAM_1,ORDINAL1,NUMBERS,XXREAL_0,XXREAL_2,XREAL_0,COMPLEX1,REAL_1,NAT_1,SQUARE_1,SEQ_4,FUNCT_1,PARTFUN1,PRE_TOPC,BORSUK_1,FINSET_1,FINSEQ_1,FINSEQ_4,DOMAIN_1,STRUCT_0,METRIC_1,PCOMPS_1,TOPS_2,ZFMISC_1,COMPTS_1,RLVECT_1,RLTOPSP1,EUCLID,TEX_2,TOPREAL1,CKB13,CKB20,CKB21,CKB42;
definitions TARSKI,TOPREAL1,SEQ_4,EUCLID,COMPTS_1,SUBSET_1,VALUED_1,STRUCT_0,ALGSTR_0,RLTOPSP1,XXREAL_2,CKB13,CKB20,CKB21,CKB42;
theorems TARSKI,NAT_1,INT_1,ABSVALUE,SUBSET_1,FINSET_1,FINSEQ_1,PRE_TOPC,METRIC_1,TOPS_1,TOPS_2,SEQ_4,EUCLID,TOPMETR,TOPREAL1,TOPREAL3,PCOMPS_1,COMPTS_1,TEX_2,FINSEQ_3,ZFMISC_1,HEINE,TDLAT_3,PARTFUN2,XREAL_0,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,COMPLEX1,XXREAL_0,RLTOPSP1,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB25,CKB26,CKB27,CKB28,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53;
schemes FRAENKEL,CKB3,CKB4;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,INT_1,MEMBERED,FINSEQ_1,STRUCT_0,PRE_TOPC,TEX_2,EUCLID,TOPREAL1,FINSET_1,VALUED_0,RLTOPSP1,FUNCT_1,CKB11,CKB12,CKB23,CKB24,CKB29,CKB40;
constructors SETFAM_1,REAL_1,SQUARE_1,NAT_1,COMPLEX1,SEQ_4,FINSEQ_4,TOPS_2,COMPTS_1,REALSET2,TDLAT_3,TEX_2,MONOID_0,TOPMETR,TOPREAL1,PCOMPS_1,XXREAL_2,FUNCSDOM,CONVEX1,BINOP_2,CKB13,CKB20,CKB21,CKB42;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve i for (Element of ( NAT ));
reserve s for Real;
reserve f for (FinSequence of (the carrier of ( TOP-REAL 2 )));
reserve p for (Point of ( TOP-REAL 2 ));
reserve p3 for (Point of ( TOP-REAL 2 ));
reserve q for (Point of ( TOP-REAL 2 ));
theorem
Th60: (for u being (Point of ( Euclid 2 )) holds (((((((f is  special  alternating & 1 <= i) & ( i + 2 ) <= ( len f )) & u = ( f /. ( i + 1 ) )) & ( f /. ( i + 1 ) ) in ( LSeg (p,q) )) & ( f /. ( i + 1 ) ) <> q) & (not p in ( ( LSeg (f,i) ) \/ ( LSeg (f,( i + 1 )) ) ))) implies (for s holds (s > ( 0 ) implies (ex p3 st (((not p3 in ( ( LSeg (f,i) ) \/ ( LSeg (f,( i + 1 )) ) )) & p3 in ( LSeg (p,q) )) & p3 in ( Ball (u,s) )))))))
proof
let u being (Point of ( Euclid 2 ));
assume that
A1: (f is  special & f is  alternating)
and
A2: 1 <= i
and
A3: ( i + 2 ) <= ( len f )
and
A4: u = ( f /. ( i + 1 ) )
and
A5: ( f /. ( i + 1 ) ) in ( LSeg (p,q) )
and
A6: ( f /. ( i + 1 ) ) <> q
and
A7: (not p in ( ( LSeg (f,i) ) \/ ( LSeg (f,( i + 1 )) ) ));
set p0 = ( f /. ( i + 1 ) );
( i + 1 ) <= ( i + 2 ) by XREAL_1:6;
then ( i + 1 ) <= ( len f ) by A3,XXREAL_0:2;
then ( LSeg (f,i) ) = ( LSeg (( f /. i ),p0) ) by A2,TOPREAL1:def 3;
then A8: p0 in ( LSeg (f,i) ) by RLTOPSP1:68;
let s;
assume A9: s > ( 0 );
per cases ;
suppose p = q;

then ( f /. ( i + 1 ) ) in { p } by A5,RLTOPSP1:70;
then p in ( LSeg (f,i) ) by A8,TARSKI:def 1;
hence thesis by A7,XBOOLE_0:def 3;
end;
suppose A10: p <> q;

reconsider v2 = q as (Element of ( REAL 2 )) by EUCLID:22;
reconsider v1 = p as (Element of ( REAL 2 )) by EUCLID:22;
A11: |. ( v2 - v1 ) .| > ( 0 ) by A10,EUCLID:17;
reconsider r0 = ( s / 2 ) as Real;
consider s0 being Real such that A12: p0 = ( ( ( 1 - s0 ) * p ) + ( s0 * q ) ) and A13: ( 0 ) <= s0 and A14: s0 <= 1 by A5;
set r3 = ( min (( s0 + ( r0 / |. ( v2 - v1 ) .| ) ),1) );
set r4 = ( max (( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ),( 0 )) );
set p4 = ( ( ( 1 - r4 ) * p ) + ( r4 * q ) );
set p3 = ( ( ( 1 - r3 ) * p ) + ( r3 * q ) );
A15: r0 > ( 0 ) by A9,XREAL_1:139;
then A16: s0 <= ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ) by A11,XREAL_1:29,XREAL_1:139;
A17: ( r0 / |. ( v2 - v1 ) .| ) > ( 0 ) by A15,A11,XREAL_1:139;
then A18: ( - ( r0 / |. ( v2 - v1 ) .| ) ) < ( - ( 0 ) ) by XREAL_1:24;
then A19: ( ( - r0 ) / |. ( v2 - v1 ) .| ) < ( 0 ) by XCMPLX_1:187;
then A20: ( s0 + ( 0 ) ) > ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) by XREAL_1:6;
then A21: ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) <= 1 by A14,XXREAL_0:2;
then (( 0 ) <= r4 & r4 <= 1) by XXREAL_0:28,XXREAL_0:30;
then A22: p4 in ( LSeg (p,q) );
A23: s0 < ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ) by A15,A11,XREAL_1:29,XREAL_1:139;
(not ( LSeg (p3,p4) ) c= ( ( LSeg (f,i) ) \/ ( LSeg (f,( i + 1 )) ) ))
proof
A24: p0 in ( LSeg (p3,p4) )
proof
( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) < ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ) by A9,A19,XREAL_1:6;
then A25: r4 < ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ) by A17,A13,XXREAL_0:29;
A26: r4 <= 1 by A21,XXREAL_0:28;
per cases  by A26,XXREAL_0:1;
suppose r4 < 1;

then r4 < r3 by A25,XXREAL_0:21;
then A27: ( r3 - r4 ) > ( 0 ) by XREAL_1:50;
set r5 = ( ( r3 - s0 ) / ( r3 - r4 ) );
( min (( s0 + ( r0 / |. ( v2 - v1 ) .| ) ),1) ) >= s0 by A14,A16,XXREAL_0:20;
then A28: ( r3 - s0 ) >= ( 0 ) by XREAL_1:48;
( max (( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ),( 0 )) ) <= s0 by A13,A20,XXREAL_0:28;
then ( r3 - s0 ) <= ( r3 - r4 ) by XREAL_1:10;
then ( ( r3 - s0 ) / ( r3 - r4 ) ) <= ( ( r3 - r4 ) / ( r3 - r4 ) ) by A27,XREAL_1:72;
then A29: r5 <= 1 by A27,XCMPLX_1:60;
A30: ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * r3 ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * r4 ) ) = ( r3 - ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( r3 - r4 ) ) )
.= ( r3 - ( r3 - s0 ) ) by A27,XCMPLX_1:87
.= s0;
( ( ( 1 - r5 ) * p3 ) + ( r5 * p4 ) ) = ( ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( ( 1 - r3 ) * p ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( r3 * q ) ) ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( ( ( 1 - r4 ) * p ) + ( r4 * q ) ) ) ) by EUCLID:32
.= ( ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( ( 1 - r3 ) * p ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( r3 * q ) ) ) + ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( ( 1 - r4 ) * p ) ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( r4 * q ) ) ) ) by EUCLID:32
.= ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( ( 1 - r4 ) * p ) ) + ( ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( ( 1 - r3 ) * p ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( r3 * q ) ) ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( r4 * q ) ) ) ) by EUCLID:26;
then ( ( ( 1 - r5 ) * p3 ) + ( r5 * p4 ) ) = ( ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( ( 1 - r4 ) * p ) ) + ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( ( 1 - r3 ) * p ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( r3 * q ) ) ) ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( r4 * q ) ) ) by EUCLID:26
.= ( ( ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( ( 1 - r4 ) * p ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( ( 1 - r3 ) * p ) ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( r3 * q ) ) ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( r4 * q ) ) ) by EUCLID:26
.= ( ( ( ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( 1 - r4 ) ) * p ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( ( 1 - r3 ) * p ) ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( r3 * q ) ) ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( r4 * q ) ) ) by EUCLID:30;
then ( ( ( 1 - r5 ) * p3 ) + ( r5 * p4 ) ) = ( ( ( ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( 1 - r4 ) ) * p ) + ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( 1 - r3 ) ) * p ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( r3 * q ) ) ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( r4 * q ) ) ) by EUCLID:30
.= ( ( ( ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( 1 - r4 ) ) * p ) + ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( 1 - r3 ) ) * p ) ) + ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * r3 ) * q ) ) + ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( r4 * q ) ) ) by EUCLID:30;
then ( ( ( 1 - r5 ) * p3 ) + ( r5 * p4 ) ) = ( ( ( ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( 1 - r4 ) ) * p ) + ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( 1 - r3 ) ) * p ) ) + ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * r3 ) * q ) ) + ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * r4 ) * q ) ) by EUCLID:30;
then ( ( ( 1 - r5 ) * p3 ) + ( r5 * p4 ) ) = ( ( ( ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( 1 - r4 ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( 1 - r3 ) ) ) * p ) + ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * r3 ) * q ) ) + ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * r4 ) * q ) ) by EUCLID:33
.= ( ( ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * ( 1 - r4 ) ) + ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * ( 1 - r3 ) ) ) * p ) + ( ( ( ( 1 - ( ( r3 - s0 ) / ( r3 - r4 ) ) ) * r3 ) * q ) + ( ( ( ( r3 - s0 ) / ( r3 - r4 ) ) * r4 ) * q ) ) ) by EUCLID:26
.= p0 by A12,A30,EUCLID:33;
hence thesis by A27,A28,A29;
end;
suppose r4 = 1;

then (( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) = 1 or ( 0 ) = 1) by XXREAL_0:16;
then ( ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) - s0 ) >= ( s0 - s0 ) by A14,XREAL_1:9;
hence thesis by A18,XCMPLX_1:187;
end;
end;
A31: p0 is_extremal_in ( ( LSeg (f,i) ) \/ ( LSeg (f,( i + 1 )) ) ) by A1,A2,A3,CKB53:1;
assume A32: ( LSeg (p3,p4) ) c= ( ( LSeg (f,i) ) \/ ( LSeg (f,( i + 1 )) ) );
per cases  by A32,A24,A31,CKB13:def 1;
suppose A33: p0 = p3;

now
per cases ;
suppose s0 = 1;

then p0 = ( ( 0. ( TOP-REAL 2 ) ) + ( 1 * q ) ) by A12,EUCLID:29
.= ( 1 * q ) by EUCLID:27
.= q by EUCLID:29;
hence contradiction by A6;
end;
suppose A34: s0 <> 1;

( 0. ( TOP-REAL 2 ) ) = ( ( ( ( 1 - s0 ) * p ) + ( s0 * q ) ) - ( ( ( 1 - r3 ) * p ) + ( r3 * q ) ) ) by A12,A33,EUCLID:42
.= ( ( ( ( 1 - s0 ) * p ) + ( s0 * q ) ) + ( ( - ( ( 1 - r3 ) * p ) ) - ( r3 * q ) ) ) by EUCLID:38
.= ( ( ( ( ( 1 - s0 ) * p ) + ( s0 * q ) ) + ( - ( r3 * q ) ) ) + ( - ( ( 1 - r3 ) * p ) ) ) by EUCLID:26
.= ( ( - ( ( 1 - r3 ) * p ) ) + ( ( ( 1 - s0 ) * p ) + ( ( s0 * q ) + ( - ( r3 * q ) ) ) ) ) by EUCLID:26
.= ( ( ( - ( ( 1 - r3 ) * p ) ) + ( ( 1 - s0 ) * p ) ) + ( ( s0 * q ) + ( - ( r3 * q ) ) ) ) by EUCLID:26
.= ( ( ( ( - ( 1 - r3 ) ) * p ) + ( ( 1 - s0 ) * p ) ) + ( ( s0 * q ) + ( - ( r3 * q ) ) ) ) by EUCLID:40
.= ( ( ( ( - ( 1 - r3 ) ) + ( 1 - s0 ) ) * p ) + ( ( s0 * q ) + ( - ( r3 * q ) ) ) ) by EUCLID:33
.= ( ( ( ( - ( 1 - r3 ) ) + ( 1 - s0 ) ) * p ) + ( ( s0 * q ) + ( ( - r3 ) * q ) ) ) by EUCLID:40
.= ( ( ( ( - 1 ) * ( s0 - r3 ) ) * p ) + ( ( s0 + ( - r3 ) ) * q ) ) by EUCLID:33
.= ( ( ( - ( s0 - r3 ) ) * p ) + ( ( s0 + ( - r3 ) ) * q ) )
.= ( ( - ( ( s0 - r3 ) * p ) ) + ( ( s0 + ( - r3 ) ) * q ) ) by EUCLID:40
.= ( ( ( s0 - r3 ) * q ) - ( ( s0 - r3 ) * p ) );
then ( ( s0 - r3 ) * q ) = ( - ( - ( ( s0 - r3 ) * p ) ) ) by EUCLID:37
.= ( ( s0 - r3 ) * p ) by EUCLID:35;
then A35: ( s0 + ( - r3 ) ) = ( 0 ) by A10,EUCLID:34;
1 > s0 by A14,A34,XXREAL_0:1;
hence contradiction by A23,A35,XXREAL_0:21;
end;
end;
hence contradiction;
end;
suppose A36: p0 = p4;

now
per cases ;
suppose s0 = ( 0 );

then p0 = ( ( 1 * p ) + ( 0. ( TOP-REAL 2 ) ) ) by A12,EUCLID:29
.= ( 1 * p ) by EUCLID:27
.= p by EUCLID:29;
hence contradiction by A7,A8,XBOOLE_0:def 3;
end;
suppose A37: s0 <> ( 0 );

( 0. ( TOP-REAL 2 ) ) = ( ( ( ( 1 - s0 ) * p ) + ( s0 * q ) ) - ( ( ( 1 - r4 ) * p ) + ( r4 * q ) ) ) by A12,A36,EUCLID:42
.= ( ( ( ( 1 - s0 ) * p ) + ( s0 * q ) ) + ( ( - ( ( 1 - r4 ) * p ) ) - ( r4 * q ) ) ) by EUCLID:38
.= ( ( ( ( ( 1 - s0 ) * p ) + ( s0 * q ) ) + ( - ( r4 * q ) ) ) + ( - ( ( 1 - r4 ) * p ) ) ) by EUCLID:26
.= ( ( - ( ( 1 - r4 ) * p ) ) + ( ( ( 1 - s0 ) * p ) + ( ( s0 * q ) + ( - ( r4 * q ) ) ) ) ) by EUCLID:26
.= ( ( ( - ( ( 1 - r4 ) * p ) ) + ( ( 1 - s0 ) * p ) ) + ( ( s0 * q ) + ( - ( r4 * q ) ) ) ) by EUCLID:26
.= ( ( ( ( - ( 1 - r4 ) ) * p ) + ( ( 1 - s0 ) * p ) ) + ( ( s0 * q ) + ( - ( r4 * q ) ) ) ) by EUCLID:40
.= ( ( ( ( - ( 1 - r4 ) ) + ( 1 - s0 ) ) * p ) + ( ( s0 * q ) + ( - ( r4 * q ) ) ) ) by EUCLID:33
.= ( ( ( ( - ( 1 - r4 ) ) + ( 1 - s0 ) ) * p ) + ( ( s0 * q ) + ( ( - r4 ) * q ) ) ) by EUCLID:40
.= ( ( ( ( - 1 ) * ( s0 - r4 ) ) * p ) + ( ( s0 + ( - r4 ) ) * q ) ) by EUCLID:33
.= ( ( ( - ( s0 - r4 ) ) * p ) + ( ( s0 - r4 ) * q ) )
.= ( ( - ( ( s0 - r4 ) * p ) ) + ( ( s0 - r4 ) * q ) ) by EUCLID:40
.= ( ( - ( ( s0 - r4 ) * p ) ) + ( ( s0 - r4 ) * q ) )
.= ( ( ( s0 - r4 ) * q ) + ( - ( ( s0 - r4 ) * p ) ) )
.= ( ( ( s0 - r4 ) * q ) - ( ( s0 - r4 ) * p ) );
then ( ( s0 - r4 ) * q ) = ( - ( - ( ( s0 - r4 ) * p ) ) ) by EUCLID:37
.= ( ( s0 - r4 ) * p ) by EUCLID:35;
then ( s0 + ( - r4 ) ) = ( 0 ) by A10,EUCLID:34;
hence contradiction by A13,A20,A37,XXREAL_0:29;
end;
end;
hence contradiction;
end;
end;
then A38: (ex x being set st (x in ( LSeg (p3,p4) ) & (not x in ( ( LSeg (f,i) ) \/ ( LSeg (f,( i + 1 )) ) )))) by TARSKI:def 3;
reconsider u4 = p4 as (Point of ( Euclid 2 )) by EUCLID:22;
A39: |. ( v2 - v1 ) .| <> ( 0 ) by A10,EUCLID:17;
reconsider u3 = p3 as (Point of ( Euclid 2 )) by EUCLID:22;
A40: r3 <= 1 by XXREAL_0:22;
( 0 ) <= r3 by A9,A13,XXREAL_0:20;
then p3 in ( LSeg (p,q) ) by A40;
then A41: ( LSeg (p3,p4) ) c= ( LSeg (p,q) ) by A22,TOPREAL1:6;
reconsider u0 = p0 as (Point of ( Euclid 2 )) by EUCLID:22;
A42: ( q - p ) = ( v2 - v1 ) by EUCLID:69;
A43: ( p4 - p0 ) = ( ( ( ( 1 - r4 ) * p ) + ( r4 * q ) ) + ( ( - ( ( 1 - s0 ) * p ) ) - ( s0 * q ) ) ) by A12,EUCLID:38
.= ( ( ( ( ( 1 - r4 ) * p ) + ( r4 * q ) ) + ( - ( ( 1 - s0 ) * p ) ) ) + ( - ( s0 * q ) ) ) by EUCLID:26
.= ( ( ( r4 * q ) + ( ( ( 1 - r4 ) * p ) + ( - ( ( 1 - s0 ) * p ) ) ) ) + ( - ( s0 * q ) ) ) by EUCLID:26
.= ( ( ( ( ( 1 - r4 ) * p ) + ( - ( ( 1 - s0 ) * p ) ) ) + ( r4 * q ) ) + ( ( - s0 ) * q ) ) by EUCLID:40
.= ( ( ( ( ( 1 - r4 ) * p ) + ( ( - ( 1 - s0 ) ) * p ) ) + ( r4 * q ) ) + ( ( - s0 ) * q ) ) by EUCLID:40
.= ( ( ( ( 1 - r4 ) * p ) + ( ( - ( 1 - s0 ) ) * p ) ) + ( ( r4 * q ) + ( ( - s0 ) * q ) ) ) by EUCLID:26
.= ( ( ( ( 1 - r4 ) * p ) + ( ( - ( 1 - s0 ) ) * p ) ) + ( ( r4 + ( - s0 ) ) * q ) ) by EUCLID:33
.= ( ( ( ( 1 - r4 ) + ( - ( 1 - s0 ) ) ) * p ) + ( ( r4 - s0 ) * q ) ) by EUCLID:33
.= ( ( ( - ( r4 - s0 ) ) * p ) + ( ( r4 - s0 ) * q ) )
.= ( ( ( r4 - s0 ) * q ) - ( ( r4 - s0 ) * p ) ) by EUCLID:40
.= ( ( r4 - s0 ) * ( q - p ) ) by EUCLID:49
.= ( ( r4 - s0 ) * ( v2 - v1 ) ) by A42,EUCLID:65;
now
per cases ;
suppose ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) <= ( 0 );

then A44: r4 = ( 0 ) by XXREAL_0:def 10;
r4 >= ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) by XXREAL_0:25;
then ( r4 + ( - s0 ) ) >= ( ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) + ( - s0 ) ) by XREAL_1:6;
then A45: ( - ( r4 - s0 ) ) <= ( - ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) by XREAL_1:24;
( r0 + r0 ) = s;
then A46: r0 < s by A9,XREAL_1:29;
reconsider v3 = p4,v4 = p0 as (Element of ( REAL 2 )) by EUCLID:22;
A47: ( - ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) = ( ( - ( - r0 ) ) / |. ( v2 - v1 ) .| ) by XCMPLX_1:187
.= ( r0 / |. ( v2 - v1 ) .| );
A48: ( dist (u4,u0) ) = |. ( v3 - v4 ) .| by CKB7:1
.= |. ( p4 - p0 ) .| by EUCLID:69
.= ( ( abs ( r4 - s0 ) ) * |. ( v2 - v1 ) .| ) by A43,EUCLID:11;
( abs ( r4 - s0 ) ) = ( abs ( - ( r4 - s0 ) ) ) by COMPLEX1:52
.= ( - ( ( 0 ) - s0 ) ) by A13,A44,ABSVALUE:def 1;
then ( ( abs ( r4 - s0 ) ) * |. ( v2 - v1 ) .| ) <= ( ( r0 / |. ( v2 - v1 ) .| ) * |. ( v2 - v1 ) .| ) by A44,A45,A47,XREAL_1:64;
then ( dist (u4,u0) ) <= r0 by A39,A48,XCMPLX_1:87;
hence ( dist (u4,u0) ) < s by A46,XXREAL_0:2;
end;
suppose (not ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) <= ( 0 ));

then A49: ( p4 - p0 ) = ( ( ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) - s0 ) * ( v2 - v1 ) ) by A43,XXREAL_0:def 10
.= ( ( ( s0 + ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) - s0 ) * ( q - p ) ) by A42,EUCLID:65
.= ( ( ( - r0 ) / |. ( v2 - v1 ) .| ) * ( q - p ) )
.= ( ( ( - r0 ) / |. ( v2 - v1 ) .| ) * ( v2 - v1 ) ) by A42,EUCLID:65;
reconsider v3 = p4,v4 = p0 as (Element of ( REAL 2 )) by EUCLID:22;
A50: ( r0 + r0 ) = s;
( dist (u4,u0) ) = |. ( v3 - v4 ) .| by CKB7:1
.= |. ( p4 - p0 ) .| by EUCLID:69
.= ( ( abs ( ( - r0 ) / |. ( v2 - v1 ) .| ) ) * |. ( v2 - v1 ) .| ) by A49,EUCLID:11
.= ( ( ( abs ( - r0 ) ) / ( abs |. ( v2 - v1 ) .| ) ) * |. ( v2 - v1 ) .| ) by COMPLEX1:67
.= ( ( ( abs ( - r0 ) ) / |. ( v2 - v1 ) .| ) * |. ( v2 - v1 ) .| ) by ABSVALUE:def 1
.= ( abs ( - r0 ) ) by A11,XCMPLX_1:87
.= ( abs r0 ) by COMPLEX1:52
.= r0 by A9,ABSVALUE:def 1;
hence ( dist (u4,u0) ) < s by A9,A50,XREAL_1:29;
end;
end;
then u4 in { u7 where u7 is (Point of ( Euclid 2 )): ( dist (u0,u7) ) < s };
then A51: p4 in ( Ball (u0,s) ) by METRIC_1:17;
A52: ( p3 - p0 ) = ( ( ( ( 1 - r3 ) * p ) + ( r3 * q ) ) + ( ( - ( ( 1 - s0 ) * p ) ) - ( s0 * q ) ) ) by A12,EUCLID:38
.= ( ( ( ( ( 1 - r3 ) * p ) + ( r3 * q ) ) + ( - ( ( 1 - s0 ) * p ) ) ) + ( - ( s0 * q ) ) ) by EUCLID:26
.= ( ( ( r3 * q ) + ( ( ( 1 - r3 ) * p ) + ( - ( ( 1 - s0 ) * p ) ) ) ) + ( - ( s0 * q ) ) ) by EUCLID:26
.= ( ( ( ( ( 1 - r3 ) * p ) + ( - ( ( 1 - s0 ) * p ) ) ) + ( r3 * q ) ) + ( ( - s0 ) * q ) ) by EUCLID:40
.= ( ( ( ( ( 1 - r3 ) * p ) + ( ( - ( 1 - s0 ) ) * p ) ) + ( r3 * q ) ) + ( ( - s0 ) * q ) ) by EUCLID:40
.= ( ( ( ( 1 - r3 ) * p ) + ( ( - ( 1 - s0 ) ) * p ) ) + ( ( r3 * q ) + ( ( - s0 ) * q ) ) ) by EUCLID:26
.= ( ( ( ( 1 - r3 ) * p ) + ( ( - ( 1 - s0 ) ) * p ) ) + ( ( r3 + ( - s0 ) ) * q ) ) by EUCLID:33
.= ( ( ( ( 1 - r3 ) + ( - ( 1 - s0 ) ) ) * p ) + ( ( r3 - s0 ) * q ) ) by EUCLID:33
.= ( ( ( - ( r3 - s0 ) ) * p ) + ( ( r3 - s0 ) * q ) )
.= ( ( ( r3 - s0 ) * q ) - ( ( r3 - s0 ) * p ) ) by EUCLID:40
.= ( ( r3 - s0 ) * ( q - p ) ) by EUCLID:49
.= ( ( r3 - s0 ) * ( v2 - v1 ) ) by A42,EUCLID:65;
now
per cases ;
suppose A53: 1 <= ( s0 + ( r0 / |. ( v2 - v1 ) .| ) );

r3 <= ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ) by XXREAL_0:17;
then A54: ( r3 + ( - s0 ) ) <= ( ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ) + ( - s0 ) ) by XREAL_1:6;
r3 = 1 by A53,XXREAL_0:def 9;
then ( r3 - s0 ) >= ( 0 ) by A14,XREAL_1:48;
then ( abs ( r3 - s0 ) ) <= ( r0 / |. ( v2 - v1 ) .| ) by A54,ABSVALUE:def 1;
then A55: ( ( abs ( r3 - s0 ) ) * |. ( v2 - v1 ) .| ) <= ( ( r0 / |. ( v2 - v1 ) .| ) * |. ( v2 - v1 ) .| ) by XREAL_1:64;
reconsider v3 = p3,v4 = p0 as (Element of ( REAL 2 )) by EUCLID:22;
( r0 + r0 ) = s;
then A56: r0 < s by A9,XREAL_1:29;
( dist (u3,u0) ) = |. ( v3 - v4 ) .| by CKB7:1
.= |. ( p3 - p0 ) .| by EUCLID:69
.= |. ( ( r3 - s0 ) * ( v2 - v1 ) ) .| by A52
.= ( ( abs ( r3 - s0 ) ) * |. ( v2 - v1 ) .| ) by EUCLID:11;
then ( dist (u3,u0) ) <= r0 by A39,A55,XCMPLX_1:87;
hence ( dist (u3,u0) ) < s by A56,XXREAL_0:2;
end;
suppose (not 1 <= ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ));

then A57: ( p3 - p0 ) = ( ( ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ) - s0 ) * ( v2 - v1 ) ) by A52,XXREAL_0:def 9
.= ( ( ( s0 + ( r0 / |. ( v2 - v1 ) .| ) ) - s0 ) * ( q - p ) ) by A42,EUCLID:65
.= ( ( r0 / |. ( v2 - v1 ) .| ) * ( q - p ) )
.= ( ( r0 / |. ( v2 - v1 ) .| ) * ( v2 - v1 ) ) by A42,EUCLID:65;
reconsider v3 = p3,v4 = p0 as (Element of ( REAL 2 )) by EUCLID:22;
A58: ( r0 + r0 ) = s;
( dist (u3,u0) ) = |. ( v3 - v4 ) .| by CKB7:1
.= |. ( p3 - p0 ) .| by EUCLID:69
.= ( ( abs ( r0 / |. ( v2 - v1 ) .| ) ) * |. ( v2 - v1 ) .| ) by A57,EUCLID:11
.= ( ( ( abs r0 ) / ( abs |. ( v2 - v1 ) .| ) ) * |. ( v2 - v1 ) .| ) by COMPLEX1:67
.= ( ( ( abs r0 ) / |. ( v2 - v1 ) .| ) * |. ( v2 - v1 ) .| ) by ABSVALUE:def 1
.= ( abs r0 ) by A11,XCMPLX_1:87
.= r0 by A9,ABSVALUE:def 1;
hence ( dist (u3,u0) ) < s by A9,A58,XREAL_1:29;
end;
end;
then u3 in { u6 where u6 is (Point of ( Euclid 2 )): ( dist (u0,u6) ) < s };
then p3 in ( Ball (u0,s) ) by METRIC_1:17;
then ( LSeg (p3,p4) ) c= ( Ball (u0,s) ) by A51,TOPREAL3:21;
hence thesis by A4,A38,A41;
end;
end;
