environ
vocabularies PBOOLE,FUNCT_6,RELAT_1,PARTFUN1,FUNCT_1,SETFAM_1,SUBSET_1,FINSET_1,XBOOLE_0,TARSKI,MEMBER_1,PZFMISC1,ZFMISC_1,FUNCT_4,FUNCOP_1,FUNCT_2,ORDINAL1,MSSUBFAM;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,RELAT_1,FUNCT_1,ORDINAL1,PARTFUN1,FUNCT_2,FUNCOP_1,FINSET_1,FUNCT_4,FUNCT_6,PBOOLE,MBOOLEAN,PZFMISC1;
definitions XBOOLE_0,PBOOLE,FINSET_1,ORDINAL1,FUNCOP_1;
theorems FUNCOP_1,FINSET_1,ORDERS_1,FRAENKEL,FUNCT_2,FUNCT_4,FUNCT_6,MBOOLEAN,PBOOLE,FUNCT_1,PZFMISC1,SETFAM_1,TARSKI,RELSET_1,XBOOLE_0,XBOOLE_1,RELAT_1,PARTFUN1,CKB5;
schemes FUNCT_2,PBOOLE;
registrations XBOOLE_0,FUNCT_1,FUNCOP_1,FINSET_1,PBOOLE,PRE_CIRC,MBOOLEAN,PZFMISC1,FUNCT_2,PARTFUN1,CARD_1,RELSET_1,CKB1,CKB2,CKB3,CKB4;
constructors SETFAM_1,FUNCT_4,FUNCT_6,MBOOLEAN,PZFMISC1,PARTFUN1,RELSET_1,ORDINAL1,PBOOLE,FINSET_1;
requirements SUBSET,BOOLE;
begin
reserve I for set;
reserve i for set;
reserve x for set;
reserve A for (ManySortedSet of I);
reserve B for (ManySortedSet of I);
reserve F for (ManySortedFunction of I);
scheme MSFExFunc { I() -> set,A,B() -> (ManySortedSet of I()),P[set,set,set] } : (ex F being (ManySortedFunction of A(),B()) st (for i being set holds (i in I() implies (ex f being (Function of ( A() . i ),( B() . i )) st (f = ( F . i ) & (for x being set holds (x in ( A() . i ) implies P[ ( f . x ),x,i ])))))))
provided
A1: (for i being set holds (i in I() implies (for x being set holds (x in ( A() . i ) implies (ex y being set st (y in ( B() . i ) & P[ y,x,i ]))))))
proof
defpred Q[ set,set ]
 means
(ex f1 being (Function of ( A() . $1 ),( B() . $1 )) st (f1 = $2 & (for x being set holds (x in ( A() . $1 ) implies P[ ( f1 . x ),x,$1 ]))));
A2:now
let i being set;
assume that
A3: i in I();
per cases ;
suppose ( B() . i ) is non  empty;

then reconsider bb = ( B() . i ) as non  empty set;
defpred Z[ set,set ]
 means
P[ $2,$1,i ];
A4: (for e being set holds (e in ( A() . i ) implies (ex u being set st (u in bb & Z[ e,u ])))) by A1,A3;
consider ff being (Function of ( A() . i ),bb) such that A5: (for e being set holds (e in ( A() . i ) implies Z[ e,( ff . e ) ])) from FUNCT_2:sch 1(A4);
reconsider fff = ff as (Function of ( A() . i ),( B() . i ));
reconsider j = fff as set;
take j;
thus Q[ i,j ] by A5;
end;
suppose A6: ( B() . i ) is  empty;

A7:now
let x being set;
(for y being set holds (not (y in ( B() . i ) & P[ y,x,i ]))) by A6;
hence (not x in ( A() . i )) by A1,A3;
end;
then ( A() . i ) = ( {} ) by XBOOLE_0:def 1;
then reconsider fff = ( {} ) as (Function of ( A() . i ),( B() . i )) by RELSET_1:12;
reconsider j = fff as set;
take j;
thus Q[ i,j ]
proof
take fff;
thus fff = j;
thus thesis by A7;
end;

end;
end;
consider F being (ManySortedSet of I()) such that A8: (for i being set holds (i in I() implies Q[ i,( F . i ) ])) from PBOOLE:sch 3(A2);
F is (ManySortedFunction of A(),B())
proof
let i being set;
assume i in I();
then (ex f being (Function of ( A() . i ),( B() . i )) st (f = ( F . i ) & (for x being set holds (x in ( A() . i ) implies P[ ( f . x ),x,i ])))) by A8;
hence thesis;
end;
then reconsider F as (ManySortedFunction of A(),B());
take F;
thus thesis by A8;
end;
