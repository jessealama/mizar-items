environ
vocabularies NUMBERS,NAT_1,INT_1,FINSEQ_1,ARYTM_3,XXREAL_0,CARD_1,SUBSET_1,ARYTM_1,INT_2,COMPLEX1,RELAT_1,TARSKI,FUNCT_1,CLASSES1,CARD_3,ORDINAL4,RFINSEQ,XBOOLE_0,NEWTON,EULER_1,FINSET_1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,CARD_1,RELAT_1,FUNCT_1,RECDEF_1,INT_1,INT_2,FINSET_1,NAT_1,NAT_D,NEWTON,EULER_1,CLASSES1,RFINSEQ,RVSUM_1,FINSEQ_1,FINSEQ_3,TREES_4,WSIERP_1,CKB14,CKB16;
definitions TARSKI,FUNCT_1,XBOOLE_0,RELAT_1,CKB16;
theorems INT_2,FINSEQ_1,NAT_1,ABSVALUE,INT_1,FUNCT_1,EULER_1,PREPOWER,RFINSEQ,FINSEQ_2,RVSUM_1,FINSEQ_3,NEWTON,RELAT_1,XBOOLE_1,XCMPLX_1,XREAL_1,FINSEQ_5,XXREAL_0,ORDINAL1,NAT_D,CLASSES1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21;
schemes NAT_1,FINSEQ_1;
registrations FUNCT_1,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,FINSEQ_1,SEQM_3,NEWTON,XBOOLE_0,VALUED_0,FINSET_1,CARD_1;
constructors REAL_1,SQUARE_1,NAT_1,NAT_D,NEWTON,RFINSEQ,WSIERP_1,EULER_1,SEQ_1,RECDEF_1,CLASSES1,BINOP_2,RELSET_1,CKB14,CKB16;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve a for Nat;
reserve m for Nat;
theorem
(for F,G being (FinSequence of ( NAT )) holds ( ( a * ( F ^ G ) ) mod m ) = ( ( ( a * F ) mod m ) ^ ( ( a * G ) mod m ) ))
proof
let F being (FinSequence of ( NAT )),G being (FinSequence of ( NAT ));
reconsider FG = ( F ^ G ) as (FinSequence of ( NAT ));
A1: ( dom ( a * ( F ^ G ) ) ) = ( Seg ( len ( a * FG ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len FG ) ) by NEWTON:2
.= ( dom ( F ^ G ) ) by FINSEQ_1:def 3;
A2: ( dom ( a * G ) ) = ( Seg ( len ( a * G ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len G ) ) by NEWTON:2
.= ( dom G ) by FINSEQ_1:def 3;
A3: ( dom ( ( a * G ) mod m ) ) = ( Seg ( len ( ( a * G ) mod m ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( a * G ) ) ) by CKB16:def 1
.= ( Seg ( len G ) ) by NEWTON:2
.= ( dom G ) by FINSEQ_1:def 3;
A4: ( dom ( a * F ) ) = ( Seg ( len ( a * F ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len F ) ) by NEWTON:2
.= ( dom F ) by FINSEQ_1:def 3;
A5: ( dom ( ( a * F ) mod m ) ) = ( Seg ( len ( ( a * F ) mod m ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( a * F ) ) ) by CKB16:def 1
.= ( Seg ( len F ) ) by NEWTON:2
.= ( dom F ) by FINSEQ_1:def 3;
A6: (for x being set holds (x in ( dom ( F ^ G ) ) implies ( ( ( a * ( F ^ G ) ) mod m ) . x ) = ( ( ( ( a * F ) mod m ) ^ ( ( a * G ) mod m ) ) . x )))
proof
reconsider H = ( F ^ G ) as (FinSequence of ( NAT ));
let x being set;
assume A7: x in ( dom ( F ^ G ) );
then reconsider x as (Element of ( NAT ));
now
per cases  by A7,FINSEQ_1:25;
suppose A8: x in ( dom F );

A9: ( ( ( a * ( F ^ G ) ) mod m ) . x ) = ( ( ( a * ( F ^ G ) ) . x ) mod m ) by A1,A7,CKB16:def 1
.= ( ( a * ( H . x ) ) mod m ) by RVSUM_1:44
.= ( ( a * ( F . x ) ) mod m ) by A8,FINSEQ_1:def 7;
( ( ( ( a * F ) mod m ) ^ ( ( a * G ) mod m ) ) . x ) = ( ( ( a * F ) mod m ) . x ) by A5,A8,FINSEQ_1:def 7
.= ( ( ( a * F ) . x ) mod m ) by A4,A8,CKB16:def 1
.= ( ( a * ( F . x ) ) mod m ) by RVSUM_1:44;
hence ( ( ( a * ( F ^ G ) ) mod m ) . x ) = ( ( ( ( a * F ) mod m ) ^ ( ( a * G ) mod m ) ) . x ) by A9;
end;
suppose (ex n being Nat st (n in ( dom G ) & x = ( ( len F ) + n )));

then consider n being (Element of ( NAT )) such that A10: n in ( dom G ) and A11: x = ( ( len F ) + n );
A12: ( ( ( a * ( F ^ G ) ) mod m ) . x ) = ( ( ( a * ( F ^ G ) ) . x ) mod m ) by A1,A7,CKB16:def 1
.= ( ( a * ( H . x ) ) mod m ) by RVSUM_1:44
.= ( ( a * ( G . n ) ) mod m ) by A10,A11,FINSEQ_1:def 7;
( len ( ( a * F ) mod m ) ) = ( len ( a * F ) ) by CKB16:def 1
.= ( len F ) by NEWTON:2;
then ( ( ( ( a * F ) mod m ) ^ ( ( a * G ) mod m ) ) . x ) = ( ( ( a * G ) mod m ) . n ) by A3,A10,A11,FINSEQ_1:def 7
.= ( ( ( a * G ) . n ) mod m ) by A2,A10,CKB16:def 1
.= ( ( a * ( G . n ) ) mod m ) by RVSUM_1:44;
hence ( ( ( a * ( F ^ G ) ) mod m ) . x ) = ( ( ( ( a * F ) mod m ) ^ ( ( a * G ) mod m ) ) . x ) by A12;
end;
end;
hence thesis;
end;
A13: ( dom ( ( a * ( F ^ G ) ) mod m ) ) = ( Seg ( len ( ( a * FG ) mod m ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( a * FG ) ) ) by CKB16:def 1
.= ( Seg ( len FG ) ) by NEWTON:2
.= ( dom ( F ^ G ) ) by FINSEQ_1:def 3;
( dom ( ( ( a * F ) mod m ) ^ ( ( a * G ) mod m ) ) ) = ( Seg ( len ( ( ( a * F ) mod m ) ^ ( ( a * G ) mod m ) ) ) ) by FINSEQ_1:def 3
.= ( Seg ( ( len ( ( a * F ) mod m ) ) + ( len ( ( a * G ) mod m ) ) ) ) by FINSEQ_1:22
.= ( Seg ( ( len ( a * F ) ) + ( len ( ( a * G ) mod m ) ) ) ) by CKB16:def 1
.= ( Seg ( ( len ( a * F ) ) + ( len ( a * G ) ) ) ) by CKB16:def 1
.= ( Seg ( ( len F ) + ( len ( a * G ) ) ) ) by NEWTON:2
.= ( Seg ( ( len F ) + ( len G ) ) ) by NEWTON:2
.= ( Seg ( len ( F ^ G ) ) ) by FINSEQ_1:22
.= ( dom ( F ^ G ) ) by FINSEQ_1:def 3;
hence thesis by A13,A6,FUNCT_1:2;
end;
