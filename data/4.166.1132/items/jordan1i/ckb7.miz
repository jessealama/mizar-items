environ
vocabularies NUMBERS,SUBSET_1,RCOMP_1,RELAT_2,SPPOL_1,EUCLID,PSCOMP_1,TOPREAL1,JORDAN9,FINSEQ_4,XXREAL_0,PARTFUN1,ARYTM_3,FUNCT_1,GOBOARD5,PRE_TOPC,RELAT_1,FINSEQ_6,FINSEQ_1,MATRIX_1,GOBOARD2,ARYTM_1,XBOOLE_0,JORDAN8,TREES_1,GOBOARD1,MCART_1,COMPLEX1,CARD_1,RLTOPSP1,TARSKI,SPRECT_2,GOBOARD9,JORDAN2C,TOPS_1,REAL_1,ZFMISC_1,JORDAN5D,CONNSP_1,TOPREAL2,JORDAN1A,JORDAN6,ORDINAL2,JORDAN1E,SEQ_4;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,COMPLEX1,REAL_1,NAT_1,FUNCT_1,NAT_D,RELSET_1,PARTFUN1,FINSEQ_1,FINSEQ_4,MATRIX_1,FINSEQ_6,ZFMISC_1,SEQ_4,STRUCT_0,PRE_TOPC,TOPS_1,TOPREAL2,CONNSP_1,COMPTS_1,RLVECT_1,RLTOPSP1,EUCLID,PSCOMP_1,SPRECT_2,GOBOARD1,TOPREAL1,GOBOARD2,GOBOARD5,GOBOARD9,GOBRD13,SPPOL_1,JORDAN8,JORDAN2C,JORDAN6,JORDAN9,JORDAN5D,JORDAN1A,JORDAN1E,XXREAL_0;
definitions TARSKI,PSCOMP_1;
theorems EUCLID,JORDAN8,PSCOMP_1,JORDAN1A,NAT_1,TOPREAL6,GOBOARD5,JORDAN4,SPRECT_2,FINSEQ_4,FINSEQ_5,FINSEQ_6,GOBOARD7,GOBOARD9,SPPOL_2,REVROT_1,TOPREAL1,GOBRD13,JORDAN9,JORDAN2C,ABSVALUE,GOBOARD1,TARSKI,TOPREAL3,FINSEQ_3,UNIFORM1,FUNCT_1,JORDAN1B,SPRECT_5,JORDAN5D,JORDAN1E,JORDAN1F,JORDAN1G,JORDAN1H,TOPREAL8,GOBRD14,JORDAN1D,GOBOARD6,SPRECT_1,XBOOLE_0,XBOOLE_1,XREAL_1,JORDAN6,XXREAL_0,PARTFUN1,MATRIX_1,NAT_D,XREAL_0,RLTOPSP1,SEQM_3,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6;
registrations XBOOLE_0,ORDINAL1,RELSET_1,NUMBERS,MEMBERED,FINSEQ_6,STRUCT_0,GOBOARD2,SPRECT_1,SPRECT_2,REVROT_1,TOPREAL6,JORDAN8,JORDAN1A,FUNCT_1,EUCLID,FINSEQ_1;
constructors PARTFUN1,XXREAL_0,REAL_1,NAT_1,FINSEQ_4,NEWTON,BINARITH,TOPS_1,CONNSP_1,REALSET2,GOBOARD2,PSCOMP_1,GOBOARD9,JORDAN6,JORDAN5D,JORDAN2C,JORDAN8,GOBRD13,JORDAN9,JORDAN1A,JORDAN1E,NAT_D,SEQ_4,RELSET_1;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve n for (Element of ( NAT ));
theorem
(for C being  compact  connected non vertical non horizontal non empty (Subset of ( TOP-REAL 2 )) holds ( E-max C ) in ( right_cell (( Rotate (( Cage (C,n) ),( E-max ( L~ ( Cage (C,n) ) ) )) ),1) ))
proof
let C being  compact  connected non vertical non horizontal non empty (Subset of ( TOP-REAL 2 ));
set f = ( Cage (C,n) );
set G = ( Gauge (C,n) );
consider j being (Element of ( NAT )) such that A1: 1 <= j and A2: j <= ( width G ) and A3: ( E-max ( L~ f ) ) = ( G * (( len G ),j) ) by JORDAN1D:25;
A4: ( len G ) >= 4 by JORDAN8:10;
then A5: 1 <= ( len G ) by XXREAL_0:2;
set k = ( ( E-max ( L~ f ) ) .. f );
A6: ( E-max ( L~ f ) ) in ( rng f ) by SPRECT_2:46;
then A7: (k in ( dom f ) & ( f . k ) = ( E-max ( L~ f ) )) by FINSEQ_4:19,FINSEQ_4:20;
then A8: ( f /. k ) = ( E-max ( L~ f ) ) by PARTFUN1:def 6;
A9:now
A10: 1 < ( ( E-max ( L~ f ) ) .. f ) by CKB2:1;
A11: 1 in ( dom f ) by A6,FINSEQ_3:31;
assume k = ( len f );
then ( f /. 1 ) = ( E-max ( L~ f ) ) by A8,FINSEQ_6:def 1;
then ( f . 1 ) = ( E-max ( L~ f ) ) by A11,PARTFUN1:def 6;
hence contradiction by A11,A10,FINSEQ_4:24;
end;
( f /. k ) = ( G * (( len G ),j) ) by A3,A7,PARTFUN1:def 6;
then A12: ( f /. k ) = ( ( GoB f ) * (( len G ),j) ) by JORDAN1H:44;
k <= ( len f ) by A6,FINSEQ_4:21;
then k < ( len f ) by A9,XXREAL_0:1;
then A13: ( k + 1 ) <= ( len f ) by NAT_1:13;
A14: 1 <= ( len G ) by A4,XXREAL_0:2;
then A15: [ ( len G ),j ] in ( Indices G ) by A1,A2,MATRIX_1:36;
(1 <= ( ( j -' 1 ) + 1 ) & ( ( j -' 1 ) + 1 ) <= ( width G )) by A1,A2,XREAL_1:235;
then A16: [ ( len G ),( ( j -' 1 ) + 1 ) ] in ( Indices G ) by A14,MATRIX_1:36;
set p = ( E-max C );
A17: f is_sequence_on G by JORDAN9:def 1;
A18: 1 <= ( k + 1 ) by NAT_1:11;
then A19: ( k + 1 ) in ( dom f ) by A13,FINSEQ_3:25;
A20: ( k + 1 ) in ( dom f ) by A13,A18,FINSEQ_3:25;
then consider ki being (Element of ( NAT )),kj being (Element of ( NAT )) such that A21: [ ki,kj ] in ( Indices G ) and A22: ( f /. ( k + 1 ) ) = ( G * (ki,kj) ) by A17,GOBOARD1:def 9;
A23: ([ ki,kj ] in ( Indices ( GoB f ) ) & ( f /. ( k + 1 ) ) = ( ( GoB f ) * (ki,kj) )) by A21,A22,JORDAN1H:44;
A24: 1 <= k by CKB2:1;
then A25: ( ( f /. ( k + 1 ) ) `1 ) = ( E-bound ( L~ ( Cage (C,n) ) ) ) by A8,A13,JORDAN1E:20;
then ( ( G * (( len G ),j) ) `1 ) = ( ( G * (ki,kj) ) `1 ) by A3,A22,EUCLID:52;
then A26: ki = ( len G ) by A21,A15,JORDAN1G:7;
A27: (kj <= ( width G ) & 1 <= ki) by A21,MATRIX_1:38;
[ ( len G ),j ] in ( Indices ( GoB f ) ) by A15,JORDAN1H:44;
then ( ( abs ( ( len G ) - ki ) ) + ( abs ( j - kj ) ) ) = 1 by A6,A19,A12,A23,FINSEQ_4:20,GOBOARD5:12;
then A28: ( ( 0 ) + ( abs ( j - kj ) ) ) = 1 by A26,ABSVALUE:2;
2 <= ( len f ) by GOBOARD7:34,XXREAL_0:2;
then ( f /. ( k + 1 ) ) in ( E-most ( L~ f ) ) by A25,A20,GOBOARD1:1,SPRECT_2:13;
then ( ( G * (( len G ),j) ) `2 ) >= ( ( G * (ki,kj) ) `2 ) by A3,A22,PSCOMP_1:47;
then j >= kj by A1,A26,A27,GOBOARD5:4;
then j = ( kj + 1 ) by A28,SEQM_3:41;
then kj = ( j - 1 );
then A29: kj = ( j -' 1 ) by A1,XREAL_1:233;
then A30: 1 <= ( j -' 1 ) by A21,MATRIX_1:38;
A31: ( j -' 1 ) <= ( width G ) by A21,A29,MATRIX_1:38;
( f /. k ) = ( G * (( len G ),( ( j -' 1 ) + 1 )) ) by A1,A3,A8,XREAL_1:235;
then A32: ( right_cell (f,k,G) ) = ( cell (G,( ( len G ) -' 1 ),( j -' 1 )) ) by A17,A24,A13,A21,A22,A26,A29,A16,GOBRD13:28;
A33:now
( j -' 1 ) <= ( len G ) by A31,JORDAN8:def 1;
then A34: ( ( G * (( ( len G ) -' 1 ),( j -' 1 )) ) `1 ) = ( E-bound C ) by A30,JORDAN8:12;
j <= ( len G ) by A2,JORDAN8:def 1;
then A35: ( ( G * (( ( len G ) -' 1 ),j) ) `1 ) = ( E-bound C ) by A1,JORDAN8:12;
assume A36: (not p in ( right_cell (f,k,G) ));
A37: 1 < ( len G ) by A4,XXREAL_0:2;
then A38: 1 <= ( ( len G ) -' 1 ) by NAT_D:49;
A39: ( ( len G ) -' 1 ) <= ( len G ) by NAT_D:50;
then A40: (( ( G * (1,j) ) `2 ) = ( ( G * (( ( len G ) -' 1 ),j) ) `2 ) & ( ( G * (1,( j -' 1 )) ) `2 ) = ( ( G * (( ( len G ) -' 1 ),( j -' 1 )) ) `2 )) by A1,A2,A30,A31,A38,GOBOARD5:1;
( j -' 1 ) < j by A30,NAT_D:51;
then ( j -' 1 ) < ( width G ) by A2,XXREAL_0:2;
then ( LSeg (( G * (( ( len G ) -' 1 ),( j -' 1 )) ),( G * (( ( len G ) -' 1 ),( ( j -' 1 ) + 1 )) )) ) c= ( cell (G,( ( len G ) -' 1 ),( j -' 1 )) ) by A30,A38,A39,GOBOARD5:19;
then (not p in ( LSeg (( G * (( ( len G ) -' 1 ),( j -' 1 )) ),( G * (( ( len G ) -' 1 ),( ( j -' 1 ) + 1 )) )) )) by A32,A36;
then A41: (not p in ( LSeg (( G * (( ( len G ) -' 1 ),( j -' 1 )) ),( G * (( ( len G ) -' 1 ),j) )) )) by A1,XREAL_1:235;
( p `1 ) = ( E-bound C ) by EUCLID:52;
then A42: (( p `2 ) > ( ( G * (( ( len G ) -' 1 ),j) ) `2 ) or ( p `2 ) < ( ( G * (( ( len G ) -' 1 ),( j -' 1 )) ) `2 )) by A41,A34,A35,GOBOARD7:7;
per cases  by A1,A2,A5,A30,A31,A42,A40,GOBOARD5:1;
suppose A43: ( p `2 ) < ( ( G * (( len G ),( j -' 1 )) ) `2 );

A44: (1 <= ( j -' 1 ) & ( ( j -' 1 ) + 1 ) <= ( width G )) by A1,A2,A21,A29,MATRIX_1:38,XREAL_1:235;
( cell (G,( ( len G ) -' 1 ),( j -' 1 )) ) meets C by A24,A13,A32,JORDAN9:31;
then ( ( cell (G,( ( len G ) -' 1 ),( j -' 1 )) ) /\ C ) <> ( {} ) by XBOOLE_0:def 7;
then consider c being set such that A45: c in ( ( cell (G,( ( len G ) -' 1 ),( j -' 1 )) ) /\ C ) by XBOOLE_0:def 1;
reconsider c as (Element of ( TOP-REAL 2 )) by A45;
A46: (1 <= ( ( len G ) -' 1 ) & ( ( ( len G ) -' 1 ) + 1 ) <= ( len G )) by A37,NAT_D:49,XREAL_1:235;
A47: c in ( cell (G,( ( len G ) -' 1 ),( j -' 1 )) ) by A45,XBOOLE_0:def 4;
then A48: ( ( G * (( ( len G ) -' 1 ),( j -' 1 )) ) `1 ) <= ( c `1 ) by A46,A44,JORDAN9:17;
A49: c in C by A45,XBOOLE_0:def 4;
then ( c `1 ) <= ( E-bound C ) by PSCOMP_1:24;
then c in ( E-most C ) by A34,A49,A48,SPRECT_2:13,XXREAL_0:1;
then A50: ( c `2 ) <= ( p `2 ) by PSCOMP_1:47;
( ( G * (( ( len G ) -' 1 ),( j -' 1 )) ) `2 ) <= ( c `2 ) by A47,A46,A44,JORDAN9:17;
then ( ( G * (1,( j -' 1 )) ) `2 ) <= ( c `2 ) by A30,A31,A38,A39,GOBOARD5:1;
then ( ( G * (( len G ),( j -' 1 )) ) `2 ) <= ( c `2 ) by A5,A30,A31,GOBOARD5:1;
hence contradiction by A43,A50,XXREAL_0:2;
end;
suppose A51: ( p `2 ) > ( ( G * (( len G ),j) ) `2 );

( east_halfline p ) meets ( L~ f ) by JORDAN1A:52,SPRECT_1:14;
then consider r being set such that A52: r in ( east_halfline p ) and A53: r in ( L~ f ) by XBOOLE_0:3;
reconsider r as (Element of ( TOP-REAL 2 )) by A52;
r in ( ( east_halfline p ) /\ ( L~ f ) ) by A52,A53,XBOOLE_0:def 4;
then ( r `1 ) = ( E-bound ( L~ f ) ) by JORDAN1A:83,PSCOMP_1:50;
then r in ( E-most ( L~ f ) ) by A53,SPRECT_2:13;
then ( ( E-max ( L~ f ) ) `2 ) >= ( r `2 ) by PSCOMP_1:47;
hence contradiction by A3,A51,A52,TOPREAL1:def 11;
end;
end;
( GoB f ) = G by JORDAN1H:44;
then p in ( right_cell (f,k) ) by A24,A13,A33,JORDAN1H:23;
hence thesis by A6,CKB5:1;
end;
