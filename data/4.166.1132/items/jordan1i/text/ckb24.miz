environ
vocabularies NUMBERS,SUBSET_1,RCOMP_1,RELAT_2,SPPOL_1,EUCLID,PSCOMP_1,TOPREAL1,JORDAN9,FINSEQ_4,XXREAL_0,PARTFUN1,ARYTM_3,FUNCT_1,GOBOARD5,PRE_TOPC,RELAT_1,FINSEQ_6,FINSEQ_1,MATRIX_1,GOBOARD2,ARYTM_1,XBOOLE_0,JORDAN8,TREES_1,GOBOARD1,MCART_1,COMPLEX1,CARD_1,RLTOPSP1,TARSKI,SPRECT_2,GOBOARD9,JORDAN2C,TOPS_1,REAL_1,ZFMISC_1,JORDAN5D,CONNSP_1,TOPREAL2,JORDAN1A,JORDAN6,ORDINAL2,JORDAN1E,SEQ_4;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,COMPLEX1,REAL_1,NAT_1,FUNCT_1,NAT_D,RELSET_1,PARTFUN1,FINSEQ_1,FINSEQ_4,MATRIX_1,FINSEQ_6,ZFMISC_1,SEQ_4,STRUCT_0,PRE_TOPC,TOPS_1,TOPREAL2,CONNSP_1,COMPTS_1,RLVECT_1,RLTOPSP1,EUCLID,PSCOMP_1,SPRECT_2,GOBOARD1,TOPREAL1,GOBOARD2,GOBOARD5,GOBOARD9,GOBRD13,SPPOL_1,JORDAN8,JORDAN2C,JORDAN6,JORDAN9,JORDAN5D,JORDAN1A,JORDAN1E,XXREAL_0;
definitions TARSKI,PSCOMP_1;
theorems EUCLID,JORDAN8,PSCOMP_1,JORDAN1A,NAT_1,TOPREAL6,GOBOARD5,JORDAN4,SPRECT_2,FINSEQ_4,FINSEQ_5,FINSEQ_6,GOBOARD7,GOBOARD9,SPPOL_2,REVROT_1,TOPREAL1,GOBRD13,JORDAN9,JORDAN2C,ABSVALUE,GOBOARD1,TARSKI,TOPREAL3,FINSEQ_3,UNIFORM1,FUNCT_1,JORDAN1B,SPRECT_5,JORDAN5D,JORDAN1E,JORDAN1F,JORDAN1G,JORDAN1H,TOPREAL8,GOBRD14,JORDAN1D,GOBOARD6,SPRECT_1,XBOOLE_0,XBOOLE_1,XREAL_1,JORDAN6,XXREAL_0,PARTFUN1,MATRIX_1,NAT_D,XREAL_0,RLTOPSP1,SEQM_3,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23;
registrations XBOOLE_0,ORDINAL1,RELSET_1,NUMBERS,MEMBERED,FINSEQ_6,STRUCT_0,GOBOARD2,SPRECT_1,SPRECT_2,REVROT_1,TOPREAL6,JORDAN8,JORDAN1A,FUNCT_1,EUCLID,FINSEQ_1;
constructors PARTFUN1,XXREAL_0,REAL_1,NAT_1,FINSEQ_4,NEWTON,BINARITH,TOPS_1,CONNSP_1,REALSET2,GOBOARD2,PSCOMP_1,GOBOARD9,JORDAN6,JORDAN5D,JORDAN2C,JORDAN8,GOBRD13,JORDAN9,JORDAN1A,JORDAN1E,NAT_D,SEQ_4,RELSET_1;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve k for (Element of ( NAT ));
theorem
Th26: (for f being  clockwise_oriented non  constant  standard special_circular_sequence holds (for G being Go-board holds (for k being (Element of ( NAT )) holds ((((f is_sequence_on G & 1 <= k) & ( k + 1 ) <= ( len f )) & ( f /. k ) = ( S-max ( L~ f ) )) implies (ex i,j being (Element of ( NAT )) st ((([ ( i + 1 ),j ] in ( Indices G ) & [ i,j ] in ( Indices G )) & ( f /. k ) = ( G * (( i + 1 ),j) )) & ( f /. ( k + 1 ) ) = ( G * (i,j) )))))))
proof
let f being  clockwise_oriented non  constant  standard special_circular_sequence;
let G being Go-board;
let k being (Element of ( NAT ));
assume that
A1: f is_sequence_on G
and
A2: 1 <= k
and
A3: ( k + 1 ) <= ( len f )
and
A4: ( f /. k ) = ( S-max ( L~ f ) );
consider i1,j1,i2,j2 being (Element of ( NAT )) such that A5: [ i1,j1 ] in ( Indices G ) and A6: ( f /. k ) = ( G * (i1,j1) ) and A7: [ i2,j2 ] in ( Indices G ) and A8: ( f /. ( k + 1 ) ) = ( G * (i2,j2) ) and A9: ((((i1 = i2 & ( j1 + 1 ) = j2) or (( i1 + 1 ) = i2 & j1 = j2)) or (i1 = ( i2 + 1 ) & j1 = j2)) or (i1 = i2 & j1 = ( j2 + 1 ))) by A1,A2,A3,JORDAN8:3;
A10: ( ( G * (i1,j1) ) `2 ) = ( S-bound ( L~ f ) ) by A4,A6,EUCLID:52;
A11: 1 <= j2 by A7,MATRIX_1:38;
take i2;
take j2;
A12: i1 <= ( len G ) by A5,MATRIX_1:38;
A13: ( k + 1 ) >= ( 1 + 1 ) by A2,XREAL_1:7;
then A14: ( len f ) >= 2 by A3,XXREAL_0:2;
( k + 1 ) >= 1 by NAT_1:11;
then A15: ( k + 1 ) in ( dom f ) by A3,FINSEQ_3:25;
then ( f /. ( k + 1 ) ) in ( L~ f ) by A3,A13,GOBOARD1:1,XXREAL_0:2;
then A16: ( ( G * (i1,j1) ) `2 ) <= ( ( G * (i2,j2) ) `2 ) by A8,A10,PSCOMP_1:24;
A17: 1 <= j1 by A5,MATRIX_1:38;
A18: k < ( len f ) by A3,NAT_1:13;
then A19: k in ( dom f ) by A2,FINSEQ_3:25;
A20: i2 <= ( len G ) by A7,MATRIX_1:38;
A21: (1 <= i1 & j1 <= ( width G )) by A5,MATRIX_1:38;
A22: (1 <= i2 & j2 <= ( width G )) by A7,MATRIX_1:38;
now
per cases  by A9;
suppose (( i2 + 1 ) = i1 & j1 = j2);

hence (([ ( i2 + 1 ),j2 ] in ( Indices G ) & [ i2,j2 ] in ( Indices G )) & ( f /. k ) = ( G * (( i2 + 1 ),j2) )) by A5,A6,A7;
end;
suppose A23: ((i1 = i2 & ( j1 + 1 ) = j2) & k <> 1);

reconsider k9 = ( k - 1 ) as (Element of ( NAT )) by A19,FINSEQ_3:26;
k > 1 by A2,A23,XXREAL_0:1;
then k >= ( 1 + 1 ) by NAT_1:13;
then A24: k9 >= ( ( 1 + 1 ) - 1 ) by XREAL_1:9;
then consider i3,j3,i4,j4 being (Element of ( NAT )) such that A25: [ i3,j3 ] in ( Indices G ) and A26: ( f /. k9 ) = ( G * (i3,j3) ) and A27: [ i4,j4 ] in ( Indices G ) and A28: ( f /. ( k9 + 1 ) ) = ( G * (i4,j4) ) and A29: ((((i3 = i4 & ( j3 + 1 ) = j4) or (( i3 + 1 ) = i4 & j3 = j4)) or (i3 = ( i4 + 1 ) & j3 = j4)) or (i3 = i4 & j3 = ( j4 + 1 ))) by A1,A18,JORDAN8:3;
A30: i1 = i4 by A5,A6,A27,A28,GOBOARD1:5;
( k9 + 1 ) < ( len f ) by A3,NAT_1:13;
then k9 < ( len f ) by NAT_1:13;
then A31: k9 in ( dom f ) by A24,FINSEQ_3:25;
A32: i3 <= ( len G ) by A25,MATRIX_1:38;
A33: 1 <= j3 by A25,MATRIX_1:38;
A34: j1 = j4 by A5,A6,A27,A28,GOBOARD1:5;
A35: (1 <= i3 & j3 <= ( width G )) by A25,MATRIX_1:38;
A36: i3 = i4
proof
assume A37: i3 <> i4;
per cases  by A29,A37;
suppose A38: (j3 = j4 & i4 = ( i3 + 1 ));

then ( ( G * (i3,j3) ) `2 ) <> ( S-bound ( L~ f ) ) by A1,A18,A24,A25,A26,A27,A28,CKB19:1;
then ( ( G * (1,j3) ) `2 ) <> ( S-bound ( L~ f ) ) by A32,A33,A35,GOBOARD5:1;
then ( ( S-max ( L~ f ) ) `2 ) <> ( S-bound ( L~ f ) ) by A4,A6,A12,A17,A21,A34,A38,GOBOARD5:1;
hence contradiction by EUCLID:52;
end;
suppose A39: (j3 = j4 & ( i4 + 1 ) = i3);

( ( G * (i3,j3) ) `2 ) = ( ( G * (1,j3) ) `2 ) by A32,A33,A35,GOBOARD5:1
.= ( ( S-max ( L~ f ) ) `2 ) by A4,A6,A12,A17,A21,A34,A39,GOBOARD5:1
.= ( S-bound ( L~ f ) ) by EUCLID:52;
then ( G * (i3,j3) ) in ( S-most ( L~ f ) ) by A14,A26,A31,GOBOARD1:1,SPRECT_2:11;
then ( ( G * (i4,j4) ) `1 ) >= ( ( G * (i3,j3) ) `1 ) by A4,A28,PSCOMP_1:55;
then i4 >= ( i4 + 1 ) by A17,A21,A30,A34,A32,A39,GOBOARD5:3;
hence contradiction by NAT_1:13;
end;
end;
A40: ( k9 + 1 ) = k;
( f /. k9 ) in ( L~ f ) by A3,A13,A31,GOBOARD1:1,XXREAL_0:2;
then A41: ( ( G * (i1,j1) ) `2 ) <= ( ( G * (i3,j3) ) `2 ) by A10,A26,PSCOMP_1:24;
now
per cases  by A29,A36;
suppose ( j3 + 1 ) = j4;

then j3 >= ( j3 + 1 ) by A12,A21,A30,A34,A33,A41,A36,GOBOARD5:4;
hence contradiction by NAT_1:13;
end;
suppose A42: j3 = ( j4 + 1 );

( k9 + ( 1 + 1 ) ) <= ( len f ) by A3;
then A43: ( ( LSeg (f,k9) ) /\ ( LSeg (f,k) ) ) = { ( f /. k ) } by A24,A40,TOPREAL1:def 6;
(( f /. k9 ) in ( LSeg (f,k9) ) & ( f /. ( k + 1 ) ) in ( LSeg (f,k) )) by A2,A3,A18,A24,A40,TOPREAL1:21;
then ( f /. ( k + 1 ) ) in { ( f /. k ) } by A8,A23,A26,A30,A34,A36,A42,A43,XBOOLE_0:def 4;
then A44: ( f /. ( k + 1 ) ) = ( f /. k ) by TARSKI:def 1;
j1 <> j2 by A23;
hence contradiction by A5,A6,A7,A8,A44,GOBOARD1:5;
end;
end;
hence (([ ( i2 + 1 ),j2 ] in ( Indices G ) & [ i2,j2 ] in ( Indices G )) & ( f /. k ) = ( G * (( i2 + 1 ),j2) ));
end;
suppose A45: ((i1 = i2 & ( j1 + 1 ) = j2) & k = 1);

set k1 = ( len f );
k < ( len f ) by A3,NAT_1:13;
then A46: ( len f ) > ( 1 + ( 0 ) ) by A2,XXREAL_0:2;
then ( len f ) in ( dom f ) by FINSEQ_3:25;
then reconsider k9 = ( ( len f ) - 1 ) as (Element of ( NAT )) by FINSEQ_3:26;
( k + 1 ) >= ( 1 + 1 ) by A2,XREAL_1:7;
then ( len f ) >= ( 1 + 1 ) by A3,XXREAL_0:2;
then A47: k9 >= ( ( 1 + 1 ) - 1 ) by XREAL_1:9;
then consider i3,j3,i4,j4 being (Element of ( NAT )) such that A48: [ i3,j3 ] in ( Indices G ) and A49: ( f /. k9 ) = ( G * (i3,j3) ) and A50: [ i4,j4 ] in ( Indices G ) and A51: ( f /. ( k9 + 1 ) ) = ( G * (i4,j4) ) and A52: ((((i3 = i4 & ( j3 + 1 ) = j4) or (( i3 + 1 ) = i4 & j3 = j4)) or (i3 = ( i4 + 1 ) & j3 = j4)) or (i3 = i4 & j3 = ( j4 + 1 ))) by A1,JORDAN8:3;
A53: ( f /. k1 ) = ( f /. 1 ) by FINSEQ_6:def 1;
then A54: i1 = i4 by A5,A6,A45,A50,A51,GOBOARD1:5;
( k9 + 1 ) <= ( len f );
then k9 < ( len f ) by NAT_1:13;
then A55: k9 in ( dom f ) by A47,FINSEQ_3:25;
then ( f /. k9 ) in ( L~ f ) by A3,A13,GOBOARD1:1,XXREAL_0:2;
then A56: ( ( G * (i1,j1) ) `2 ) <= ( ( G * (i3,j3) ) `2 ) by A10,A49,PSCOMP_1:24;
A57: i3 <= ( len G ) by A48,MATRIX_1:38;
A58: j1 = j4 by A5,A6,A45,A53,A50,A51,GOBOARD1:5;
A59: 1 <= j3 by A48,MATRIX_1:38;
A60: (1 <= i3 & j3 <= ( width G )) by A48,MATRIX_1:38;
A61: i3 = i4
proof
assume A62: i3 <> i4;
per cases  by A52,A62;
suppose A63: (j3 = j4 & i4 = ( i3 + 1 ));

then ( ( G * (i3,j3) ) `2 ) <> ( S-bound ( L~ f ) ) by A1,A47,A48,A49,A50,A51,CKB19:1;
then ( ( G * (1,j3) ) `2 ) <> ( S-bound ( L~ f ) ) by A57,A59,A60,GOBOARD5:1;
then ( ( S-max ( L~ f ) ) `2 ) <> ( S-bound ( L~ f ) ) by A4,A6,A12,A17,A21,A58,A63,GOBOARD5:1;
hence contradiction by EUCLID:52;
end;
suppose A64: (j3 = j4 & ( i4 + 1 ) = i3);

( ( G * (i3,j3) ) `2 ) = ( ( G * (1,j3) ) `2 ) by A57,A59,A60,GOBOARD5:1
.= ( ( S-max ( L~ f ) ) `2 ) by A4,A6,A12,A17,A21,A58,A64,GOBOARD5:1
.= ( S-bound ( L~ f ) ) by EUCLID:52;
then ( G * (i3,j3) ) in ( S-most ( L~ f ) ) by A14,A49,A55,GOBOARD1:1,SPRECT_2:11;
then ( ( G * (i4,j4) ) `1 ) >= ( ( G * (i3,j3) ) `1 ) by A4,A45,A53,A51,PSCOMP_1:55;
then i4 >= ( i4 + 1 ) by A17,A21,A54,A58,A57,A64,GOBOARD5:3;
hence contradiction by NAT_1:13;
end;
end;
A65: ( k9 + 1 ) = k1;
now
per cases  by A52,A61;
suppose ( j3 + 1 ) = j4;

then j3 >= ( j3 + 1 ) by A12,A21,A54,A58,A59,A56,A61,GOBOARD5:4;
hence contradiction by NAT_1:13;
end;
suppose A66: j3 = ( j4 + 1 );

( ( len f ) - 1 ) >= ( 0 ) by A46,XREAL_1:19;
then ( ( len f ) -' 1 ) = ( ( len f ) - 1 ) by XREAL_0:def 2;
then A67: ( ( LSeg (f,k) ) /\ ( LSeg (f,k9) ) ) = { ( f . k ) } by A45,JORDAN4:42
.= { ( f /. k ) } by A19,PARTFUN1:def 6;
(( f /. k9 ) in ( LSeg (f,k9) ) & ( f /. ( k + 1 ) ) in ( LSeg (f,k) )) by A2,A3,A47,A65,TOPREAL1:21;
then ( f /. ( k + 1 ) ) in { ( f /. k ) } by A8,A45,A49,A54,A58,A61,A66,A67,XBOOLE_0:def 4;
then A68: ( f /. ( k + 1 ) ) = ( f /. k ) by TARSKI:def 1;
j1 <> j2 by A45;
hence contradiction by A5,A6,A7,A8,A68,GOBOARD1:5;
end;
end;
hence (([ ( i2 + 1 ),j2 ] in ( Indices G ) & [ i2,j2 ] in ( Indices G )) & ( f /. k ) = ( G * (( i2 + 1 ),j2) ));
end;
suppose (i1 = i2 & j1 = ( j2 + 1 ));

then j2 >= ( j2 + 1 ) by A12,A21,A11,A16,GOBOARD5:4;
hence (([ ( i2 + 1 ),j2 ] in ( Indices G ) & [ i2,j2 ] in ( Indices G )) & ( f /. k ) = ( G * (( i2 + 1 ),j2) )) by NAT_1:13;
end;
suppose A69: (i2 = ( i1 + 1 ) & j1 = j2);

( ( G * (i2,j2) ) `2 ) = ( ( G * (1,j2) ) `2 ) by A20,A11,A22,GOBOARD5:1
.= ( S-bound ( L~ f ) ) by A12,A17,A21,A10,A69,GOBOARD5:1;
then ( G * (i2,j2) ) in ( S-most ( L~ f ) ) by A8,A14,A15,GOBOARD1:1,SPRECT_2:11;
then ( ( G * (i1,j1) ) `1 ) >= ( ( G * (i2,j2) ) `1 ) by A4,A6,PSCOMP_1:55;
then i1 >= ( i1 + 1 ) by A17,A21,A20,A69,GOBOARD5:3;
hence (([ ( i2 + 1 ),j2 ] in ( Indices G ) & [ i2,j2 ] in ( Indices G )) & ( f /. k ) = ( G * (( i2 + 1 ),j2) )) by NAT_1:13;
end;
end;
hence (([ ( i2 + 1 ),j2 ] in ( Indices G ) & [ i2,j2 ] in ( Indices G )) & ( f /. k ) = ( G * (( i2 + 1 ),j2) ));
thus thesis by A8;
end;
