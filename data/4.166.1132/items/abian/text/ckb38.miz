environ
vocabularies NUMBERS,SETFAM_1,FUNCT_1,SUBSET_1,ORDINAL1,INT_1,RELAT_1,CARD_1,XXREAL_0,ARYTM_3,ARYTM_1,FUNCT_7,XBOOLE_0,TARSKI,ZFMISC_1,FINSET_1,EQREL_1,FUNCOP_1,MCART_1,ABIAN,XCMPLX_0;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,MCART_1,DOMAIN_1,FINSET_1,SETFAM_1,SEQ_4,RELAT_1,FUNCT_1,FUNCT_2,FUNCOP_1,INT_1,NAT_1,NAT_D,EQREL_1,FUNCT_7,XXREAL_0,CKB1,CKB2,CKB4,CKB27,CKB30,CKB31,CKB32,CKB33,CKB34;
definitions TARSKI,XBOOLE_0,RELAT_1,FUNCT_1,REALSET1,SETFAM_1,INT_1,CKB1,CKB4,CKB30,CKB31,CKB32,CKB34;
theorems TARSKI,ZFMISC_1,FUNCT_1,FUNCT_2,EQREL_1,NAT_1,INT_1,MCART_1,SCHEME1,FUNCOP_1,SETFAM_1,XBOOLE_0,XBOOLE_1,FUNCT_7,XREAL_1,XXREAL_0,NAT_D,XXREAL_2,CKB1,CKB3,CKB4,CKB9,CKB28,CKB29,CKB30,CKB31,CKB32,CKB34,CKB35,CKB37;
schemes EQREL_1,FUNCT_2,NAT_1,DOMAIN_1;
registrations XBOOLE_0,SUBSET_1,SETFAM_1,FUNCT_1,ORDINAL1,RELSET_1,PARTFUN1,FINSET_1,XREAL_0,INT_1,MEMBERED,EQREL_1,XXREAL_2,XXREAL_0,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB36;
constructors SETFAM_1,XXREAL_0,REAL_1,NAT_1,NAT_D,EQREL_1,SEQ_4,REALSET1,FUNCT_7,XXREAL_2,RELSET_1,CKB1,CKB27,CKB30,CKB31,CKB32,CKB34;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve z for set;
reserve E for set;
reserve f for (Function of E,E);
reserve k for (Element of ( NAT ));
reserve l for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
definition
let E;
let f;
func =_ f -> (Equivalence_Relation of E) means 
:Def7: (for x holds (for y holds ((x in E & y in E) implies ([ x,y ] in it iff (ex k st (ex l st ( ( iter (f,k) ) . x ) = ( ( iter (f,l) ) . y )))))));
existence
proof
defpred P[ set,set ]
 means
(($1 in E & $2 in E) & (ex k st (ex l st ( ( iter (f,k) ) . $1 ) = ( ( iter (f,l) ) . $2 ))));
A1:now
let x;
A2: ( ( iter (f,( 0 )) ) . x ) = ( ( iter (f,( 0 )) ) . x );
assume x in E;
hence P[ x,x ] by A2;
end;
A3:now
let x;
let y;
let z;
assume that
A4: P[ x,y ]
and
A5: P[ y,z ];
consider k,l such that A6: ( ( iter (f,k) ) . x ) = ( ( iter (f,l) ) . y ) by A4;
consider m,n such that A7: ( ( iter (f,m) ) . y ) = ( ( iter (f,n) ) . z ) by A5;
A8: ( dom ( iter (f,m) ) ) = E by FUNCT_2:52;
A9: ( dom ( iter (f,l) ) ) = E by FUNCT_2:52;
A10: ( dom ( iter (f,k) ) ) = E by FUNCT_2:52;
A11: ( dom ( iter (f,n) ) ) = E by FUNCT_2:52;
( ( iter (f,( k + m )) ) . x ) = ( ( ( iter (f,m) ) * ( iter (f,k) ) ) . x ) by FUNCT_7:77
.= ( ( iter (f,m) ) . ( ( iter (f,l) ) . y ) ) by A4,A6,A10,FUNCT_1:13
.= ( ( ( iter (f,m) ) * ( iter (f,l) ) ) . y ) by A4,A9,FUNCT_1:13
.= ( ( iter (f,( m + l )) ) . y ) by FUNCT_7:77
.= ( ( ( iter (f,l) ) * ( iter (f,m) ) ) . y ) by FUNCT_7:77
.= ( ( iter (f,l) ) . ( ( iter (f,n) ) . z ) ) by A4,A7,A8,FUNCT_1:13
.= ( ( ( iter (f,l) ) * ( iter (f,n) ) ) . z ) by A5,A11,FUNCT_1:13
.= ( ( iter (f,( l + n )) ) . z ) by FUNCT_7:77;
hence P[ x,z ] by A4,A5;
end;
A12: (for x holds (for y holds (P[ x,y ] implies P[ y,x ])));
consider EqR being (Equivalence_Relation of E) such that A13: (for x holds (for y holds ([ x,y ] in EqR iff ((x in E & y in E) & P[ x,y ])))) from EQREL_1:sch 1(A1,A12,A3);
take EqR;
let x;
let y;
assume (x in E & y in E);
hence thesis by A13;
end;
uniqueness
proof
let IT1 being (Equivalence_Relation of E);
let IT2 being (Equivalence_Relation of E);
assume that
A14: (for x holds (for y holds ((x in E & y in E) implies ([ x,y ] in IT1 iff (ex k st (ex l st ( ( iter (f,k) ) . x ) = ( ( iter (f,l) ) . y )))))))
and
A15: (for x holds (for y holds ((x in E & y in E) implies ([ x,y ] in IT2 iff (ex k st (ex l st ( ( iter (f,k) ) . x ) = ( ( iter (f,l) ) . y )))))));
let a being set;
let b being set;
hereby
assume A16: [ a,b ] in IT1;
then A17: (a in E & b in E) by ZFMISC_1:87;
then (ex k st (ex l st ( ( iter (f,k) ) . a ) = ( ( iter (f,l) ) . b ))) by A14,A16;
hence [ a,b ] in IT2 by A15,A17;
end;
assume A18: [ a,b ] in IT2;
then A19: (a in E & b in E) by ZFMISC_1:87;
then (ex k st (ex l st ( ( iter (f,k) ) . a ) = ( ( iter (f,l) ) . b ))) by A15,A18;
hence thesis by A14,A19;
end;
end;
