environ
vocabularies FUNCT_1,PBOOLE,RELAT_1,XBOOLE_0,ALGSTR_0,PRALG_1,FUNCOP_1,SUBSET_1,RLVECT_2,STRUCT_0,CARD_3,TARSKI,BINOP_1,ZFMISC_1,MONOID_0,GROUP_1,SEMI_AF1,GROUP_2,FINSET_1,FUNCT_4,REALSET1,FINSEQ_1,NAT_1,XXREAL_0,NUMBERS,GROUP_6,FUNCT_2,WELLORD1,GROUP_7,PARTFUN1;
notations TARSKI,XBOOLE_0,ENUMSET1,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,NUMBERS,NAT_1,FINSEQ_1,RELSET_1,PARTFUN1,FUNCT_2,FUNCT_4,FINSET_1,BINOP_1,REALSET1,XXREAL_0,PBOOLE,FUNCOP_1,STRUCT_0,ALGSTR_0,MONOID_0,GROUP_1,GROUP_2,GROUP_6,CARD_3,PRALG_1,CKB1,CKB5,CKB6,CKB8,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16;
definitions STRUCT_0,GROUP_1,TARSKI,GROUP_2,GROUP_6,FINSEQ_1,XBOOLE_0,PRALG_1,FUNCT_1,PBOOLE,BINOP_1,REALSET1,ALGSTR_0,CKB1,CKB8,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16;
theorems PRALG_1,FUNCT_1,CARD_3,FUNCT_2,BINOP_1,TARSKI,ZFMISC_1,GROUP_1,GROUP_2,GROUP_6,FUNCT_4,FINSEQ_1,FINSEQ_3,ENUMSET1,RELSET_1,XBOOLE_0,XBOOLE_1,RELAT_1,FUNCOP_1,MONOID_0,ORDINAL1,PARTFUN1,CKB1,CKB8,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB21,CKB22;
schemes BINOP_1,FUNCT_1,PBOOLE,FUNCT_2,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,FINSET_1,XREAL_0,FINSEQ_1,REALSET1,STRUCT_0,GROUP_1,GROUP_2,MONOID_0,ORDINAL1,CARD_3,PRE_CIRC,FUNCOP_1,RELSET_1,CKB2,CKB3,CKB4,CKB7,CKB9,CKB17,CKB18,CKB19,CKB20;
constructors BINOP_1,XXREAL_0,REALSET1,GROUP_6,MONOID_0,PRALG_1,PRALG_2,RELSET_1,FUNCT_4,CKB1,CKB6,CKB8,CKB11,CKB12,CKB13;
requirements NUMERALS,BOOLE,SUBSET;
begin
reserve i for set;
reserve I for set;
theorem
(for F being (multMagma-Family of I) holds (for G being non  empty multMagma holds (((i in I & G = ( F . i )) & ( product F ) is  commutative) implies G is  commutative)))
proof
let F being (multMagma-Family of I);
let G being non  empty multMagma;
assume that
A1: i in I
and
A2: G = ( F . i )
and
A3: (for x,y being (Element of ( product F )) holds ( x * y ) = ( y * x ));
let x being (Element of G);
let y being (Element of G);
defpred Y[ set,set ]
 means
(($1 = i implies $2 = y) & ($1 <> i implies (ex H being non  empty multMagma st (ex a being (Element of H) st (H = ( F . $1 ) & $2 = a)))));
A4: (for j being set holds (j in I implies (ex k being set st Y[ j,k ])))
proof
let j being set;
assume that
A5: j in I;
per cases ;
suppose j = i;

hence thesis;
end;
suppose A6: j <> i;

j in ( dom F ) by A5,PARTFUN1:def 2;
then ( F . j ) in ( rng F ) by FUNCT_1:def 3;
then reconsider Fj = ( F . j ) as non  empty multMagma by CKB1:def 1;
set a = the (Element of Fj);
take a;
thus (j = i implies a = y) by A6;
thus thesis;
end;
end;
consider gy being (ManySortedSet of I) such that A7: (for j being set holds (j in I implies Y[ j,( gy . j ) ])) from PBOOLE:sch 3(A4);
set GP = ( product F );
defpred X[ set,set ]
 means
(($1 = i implies $2 = x) & ($1 <> i implies (ex H being non  empty multMagma st (ex a being (Element of H) st (H = ( F . $1 ) & $2 = a)))));
A8: (for j being set holds (j in I implies (ex k being set st X[ j,k ])))
proof
let j being set;
assume that
A9: j in I;
per cases ;
suppose j = i;

hence thesis;
end;
suppose A10: j <> i;

j in ( dom F ) by A9,PARTFUN1:def 2;
then ( F . j ) in ( rng F ) by FUNCT_1:def 3;
then reconsider Fj = ( F . j ) as non  empty multMagma by CKB1:def 1;
set a = the (Element of Fj);
take a;
thus (j = i implies a = x) by A10;
thus thesis;
end;
end;
consider gx being (ManySortedSet of I) such that A11: (for j being set holds (j in I implies X[ j,( gx . j ) ])) from PBOOLE:sch 3(A8);
A12: ( dom gy ) = I by PARTFUN1:def 2;
A13:now
let j being set;
assume A14: j in ( dom gy );
then A15: (ex R being 1-sorted st (R = ( F . j ) & ( ( Carrier F ) . j ) = (the carrier of R))) by A12,PRALG_1:def 13;
per cases ;
suppose A16: i = j;

then ( gy . j ) = y by A7,A12,A14;
hence ( gy . j ) in ( ( Carrier F ) . j ) by A2,A15,A16;
end;
suppose j <> i;

then (ex H being non  empty multMagma st (ex a being (Element of H) st (H = ( F . j ) & ( gy . j ) = a))) by A7,A12,A14;
hence ( gy . j ) in ( ( Carrier F ) . j ) by A15;
end;
end;
A17: ( dom ( Carrier F ) ) = I by PARTFUN1:def 2;
then reconsider gy as (Element of ( product ( Carrier F ) )) by A12,A13,CARD_3:9;
A18: ( gy . i ) = y by A1,A7;
A19: ( dom gx ) = I by PARTFUN1:def 2;
now
let j being set;
assume A20: j in ( dom gx );
then A21: (ex R being 1-sorted st (R = ( F . j ) & ( ( Carrier F ) . j ) = (the carrier of R))) by A19,PRALG_1:def 13;
per cases ;
suppose A22: i = j;

then ( gx . j ) = x by A11,A19,A20;
hence ( gx . j ) in ( ( Carrier F ) . j ) by A2,A21,A22;
end;
suppose j <> i;

then (ex H being non  empty multMagma st (ex a being (Element of H) st (H = ( F . j ) & ( gx . j ) = a))) by A11,A19,A20;
hence ( gx . j ) in ( ( Carrier F ) . j ) by A21;
end;
end;
then reconsider gx as (Element of ( product ( Carrier F ) )) by A19,A17,CARD_3:9;
reconsider x1 = gx,y1 = gy as (Element of GP) by CKB8:def 1;
A23: ( x1 * y1 ) = ( y1 * x1 ) by A3;
reconsider xy = ( x1 * y1 ) as (Element of ( product ( Carrier F ) )) by CKB8:def 1;
A24: ( gx . i ) = x by A1,A11;
then ( xy . i ) = ( x * y ) by A1,A2,A18,CKB10:1;
hence thesis by A1,A2,A23,A24,A18,CKB10:1;
end;
