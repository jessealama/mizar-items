environ
vocabularies NUMBERS,FUNCT_1,CARD_1,RELAT_1,TARSKI,FUNCT_4,FUNCOP_1,XBOOLE_0,SUBSET_1,XXREAL_0,ARYTM_3,FINSET_1,XREAL_0,ORDINAL1,ARYTM_1,NAT_1,ZFMISC_1,FINSEQ_1,UPROOTS,VALUED_0,RELAT_2,BAGORDER,PRE_POLY,WELLORD1,GLIB_000,GLIB_001,ORDINAL4,PBOOLE,PARTFUN1,MCART_1,FUNCT_2,FINSUB_1,CHORD,TOPGEN_1,RCOMP_1,FINSEQ_4,GRAPH_1,MEMBERED,ABIAN,LEXBFS;
notations TARSKI,XBOOLE_0,ZFMISC_1,MCART_1,CARD_1,NUMBERS,SUBSET_1,XXREAL_0,VALUED_0,XREAL_0,RELAT_1,RELAT_2,WELLORD1,MEMBERED,XXREAL_2,PARTFUN1,FUNCT_1,FUNCT_2,PBOOLE,ORDINAL1,FINSET_1,XCMPLX_0,NAT_1,NAT_D,FUNCOP_1,FUNCT_4,GLIB_000,GLIB_001,BAGORDER,TERMORD,UPROOTS,CHORD,FINSEQ_1,DOMAIN_1,ABIAN,RELSET_1,RECDEF_1,FINSUB_1,RFUNCT_3,PRE_POLY,CKB7,CKB11,CKB15,CKB18,CKB20;
definitions GLIB_000,GLIB_001,FUNCOP_1,TARSKI,CKB7,CKB11,CKB15,CKB20;
theorems AXIOMS,CARD_1,CARD_2,FUNCOP_1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSET_1,FUNCT_1,FUNCT_2,FUNCT_4,GLIB_000,GLIB_001,INT_1,NAT_1,BAGORDER,TERMORD,ORDINAL1,PARTFUN1,PBOOLE,NAT_D,XREAL_0,RELAT_1,RELSET_1,TARSKI,XBOOLE_0,XBOOLE_1,XREAL_1,ZFMISC_1,ENUMSET1,CHORD,NECKLACE,FINSEQ_4,WELLORD1,UPROOTS,CARD_FIN,TREES_1,NAT_2,XXREAL_0,XXREAL_2,VALUED_0,MCART_1,FINSUB_1,SYSREL,GRFUNC_1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB19,CKB20;
schemes NAT_1,FUNCT_1,RECDEF_1,FRAENKEL,PBOOLE,FUNCT_2,CLASSES1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCOP_1,FINSET_1,XXREAL_0,XREAL_0,XXREAL_2,NAT_1,INT_1,MEMBERED,FINSEQ_1,CARD_1,UPROOTS,FUNCT_2,GLIB_000,ABIAN,BAGORDER,TERMORD,CARD_FIN,GLIB_001,CHORD,VALUED_0,FINSUB_1,PARTFUN1,RELSET_1,PRE_POLY,CKB8,CKB9,CKB10,CKB17;
constructors DOMAIN_1,FUNCT_4,XXREAL_2,BAGORDER,TERMORD,UPROOTS,CHORD,RECDEF_1,RFUNCT_3,WELLORD2,RELSET_1,PBOOLE,CKB7,CKB11,CKB15,CKB18,CKB20;
requirements NUMERALS,SUBSET,BOOLE,REAL,ARITHM;
begin
definition
let n being Ordinal;
let T being  connected (TermOrder of n);
let B being non empty  finite (Subset of ( Bags n ));
func max (B,T) -> (bag of n)
means
:Def5: (it in B & (for x being (bag of n) holds (x in B implies x <= it,T)));
existence
proof
consider p being FinSequence such that A1: ( rng p ) = B by FINSEQ_1:52;
defpred P[ Nat ]
 means
($1 <= ( len p ) implies (ex a being Nat st (ex A being (bag of n) st (((a in ( dom p ) & a <= $1) & ( p . a ) = A) & (for c being Nat holds (for C being (bag of n) holds (((c in ( dom p ) & c <= $1) & ( p . c ) = C) implies C <= A,T)))))));
A2: (for k being non empty Nat holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being non empty Nat;
assume that
A3: P[ k ];
per cases ;
suppose A4: k < ( len p );

A5: 1 <= ( k + 1 ) by CHORD:1;
( k + 1 ) <= ( len p ) by A4,NAT_1:13;
then A6: ( k + 1 ) in ( dom p ) by A5,FINSEQ_3:25;
then ( p . ( k + 1 ) ) in B by A1,FUNCT_1:def 3;
then reconsider Ck = ( p . ( k + 1 ) ) as (bag of n);
consider a being Nat,A being (bag of n) such that A7: a in ( dom p ) and A8: a <= k and A9: ( p . a ) = A and A10: (for c being Nat holds (for C being (bag of n) holds (((c in ( dom p ) & c <= k) & ( p . c ) = C) implies C <= A,T))) by A3,A4;
set m = ( max (A,Ck,T) );
A11: A <= m,T by TERMORD:14;
per cases  by TERMORD:12;
suppose A12: m = A;

A13:now
let c being Nat;
let C being (bag of n);
assume that
A14: c in ( dom p )
and
A15: c <= ( k + 1 )
and
A16: ( p . c ) = C;
per cases  by A15,XXREAL_0:1;
suppose c = ( k + 1 );

hence C <= m,T by A16,TERMORD:14;
end;
suppose c < ( k + 1 );

then c <= k by NAT_1:13;
then C <= A,T by A10,A14,A16;
hence C <= m,T by A11,TERMORD:8;
end;
end;
a <= ( k + 1 ) by A8,NAT_1:13;
hence thesis by A7,A9,A12,A13;
end;
suppose A17: m = Ck;

now
let c being Nat;
let C being (bag of n);
assume that
A18: c in ( dom p )
and
A19: c <= ( k + 1 )
and
A20: ( p . c ) = C;
per cases  by A19,XXREAL_0:1;
suppose c = ( k + 1 );

hence C <= m,T by A20,TERMORD:14;
end;
suppose c < ( k + 1 );

then c <= k by NAT_1:13;
then C <= A,T by A10,A18,A20;
hence C <= m,T by A11,TERMORD:8;
end;
end;
hence thesis by A6,A17;
end;
end;
suppose k >= ( len p );

hence thesis by NAT_1:13;
end;
end;
A21: p <> ( {} ) by A1;
A22: P[ 1 ]
proof
A23: 1 in ( dom p ) by A1,FINSEQ_3:32;
then ( p . 1 ) in B by A1,FUNCT_1:def 3;
then reconsider A = ( p . 1 ) as (bag of n);
now
let c being Nat;
let C being (bag of n);
assume that
A24: c in ( dom p )
and
A25: c <= 1
and
A26: ( p . c ) = C;
1 <= c by A24,FINSEQ_3:25;
then C = A by A25,A26,XXREAL_0:1;
hence C <= A,T by TERMORD:6;
end;
hence thesis by A23;
end;
(for k being non empty Nat holds P[ k ]) from NAT_1:sch 10(A22,A2);
then consider a being Nat,A being (bag of n) such that A27: a in ( dom p ) and a <= ( len p ) and A28: ( p . a ) = A and A29: (for c being Nat holds (for C being (bag of n) holds (((c in ( dom p ) & c <= ( len p )) & ( p . c ) = C) implies C <= A,T))) by A21;
take A;
thus A in B by A1,A27,A28,FUNCT_1:def 3;
now
let x being (bag of n);
assume x in B;
then consider y being Nat such that A30: y in ( dom p ) and A31: ( p . y ) = x by A1,FINSEQ_2:10;
y <= ( len p ) by A30,FINSEQ_3:25;
hence x <= A,T by A29,A30,A31;
end;
hence thesis;
end;
uniqueness
proof
let IT1 being (bag of n),IT2 being (bag of n);
assume that
A32: IT1 in B
and
A33: (for x being (bag of n) holds (x in B implies x <= IT1,T))
and
A34: IT2 in B
and
A35: (for x being (bag of n) holds (x in B implies x <= IT2,T));
A36: IT1 <= IT2,T by A32,A35;
IT2 <= IT1,T by A33,A34;
hence IT1 = IT2 by A36,TERMORD:7;
end;
end;
