environ
vocabularies RELAT_1,RELAT_2,XBOOLE_0,SUBSET_1,TARSKI,FUNCT_1,ZFMISC_1,WELLORD1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,RELAT_2,FUNCT_1,CKB5,CKB8,CKB9,CKB11,CKB12,CKB19,CKB47,CKB49;
definitions TARSKI,XBOOLE_0,FUNCT_1,RELAT_1,CKB5,CKB8,CKB9,CKB11,CKB12,CKB19,CKB47,CKB49;
theorems TARSKI,XBOOLE_0,FUNCT_1,RELAT_1,RELAT_2,ZFMISC_1,XBOOLE_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55;
schemes XBOOLE_0,FUNCT_1;
registrations FUNCT_1,RELAT_1;
constructors TARSKI,SUBSET_1,FUNCT_1,RELAT_2,CKB5,CKB8,CKB9,CKB11,CKB12,CKB19,CKB47,CKB49;
requirements SUBSET,BOOLE;
begin
reserve a for set;
reserve b for set;
reserve c for set;
reserve x for set;
reserve Y for set;
reserve Z for set;
reserve R for Relation;
reserve S for Relation;
reserve F for Function;
theorem
Th53: (F is_isomorphism_of R,S implies (((((R is  reflexive implies S is  reflexive) & (R is  transitive implies S is  transitive)) & (R is  connected implies S is  connected)) & (R is  antisymmetric implies S is  antisymmetric)) & (R is  well_founded implies S is  well_founded)))
proof
assume A1: F is_isomorphism_of R,S;
then A2: ( dom F ) = ( field R ) by CKB47:def 1;
A3: ( rng F ) = ( field S ) by A1,CKB47:def 1;
A4: F is  one-to-one by A1,CKB47:def 1;
then A5: (( rng ( F " ) ) = ( dom F ) & ( dom ( F " ) ) = ( rng F )) by FUNCT_1:33;
thus (R is  reflexive implies S is  reflexive)
proof
assume A6: R is  reflexive;
now
let a;
assume A7: a in ( field S );
then ( ( F " ) . a ) in ( field R ) by A2,A3,A5,FUNCT_1:def 3;
then A8: [ ( ( F " ) . a ),( ( F " ) . a ) ] in R by A6,CKB1:1;
a = ( F . ( ( F " ) . a ) ) by A3,A4,A7,FUNCT_1:35;
hence [ a,a ] in S by A1,A8,CKB47:def 1;
end;
hence thesis by CKB1:1;
end;

thus (R is  transitive implies S is  transitive)
proof
assume A9: R is  transitive;
now
let a;
let b;
let c;
assume that
A10: [ a,b ] in S
and
A11: [ b,c ] in S;
A12: c in ( field S ) by A11,RELAT_1:15;
then A13: c = ( F . ( ( F " ) . c ) ) by A3,A4,FUNCT_1:35;
b in ( field S ) by A10,RELAT_1:15;
then A14: (b = ( F . ( ( F " ) . b ) ) & ( ( F " ) . b ) in ( field R )) by A2,A3,A4,A5,FUNCT_1:35,FUNCT_1:def 3;
( ( F " ) . c ) in ( field R ) by A2,A3,A5,A12,FUNCT_1:def 3;
then A15: [ ( ( F " ) . b ),( ( F " ) . c ) ] in R by A1,A11,A13,A14,CKB47:def 1;
A16: a in ( field S ) by A10,RELAT_1:15;
then A17: a = ( F . ( ( F " ) . a ) ) by A3,A4,FUNCT_1:35;
( ( F " ) . a ) in ( field R ) by A2,A3,A5,A16,FUNCT_1:def 3;
then [ ( ( F " ) . a ),( ( F " ) . b ) ] in R by A1,A10,A17,A14,CKB47:def 1;
then [ ( ( F " ) . a ),( ( F " ) . c ) ] in R by A9,A15,CKB2:1;
hence [ a,c ] in S by A1,A17,A13,CKB47:def 1;
end;
hence thesis by CKB2:1;
end;

thus (R is  connected implies S is  connected)
proof
assume A18: R is  connected;
now
let a;
let b;
assume that
A19: (a in ( field S ) & b in ( field S ))
and
A20: a <> b;
A21: (a = ( F . ( ( F " ) . a ) ) & b = ( F . ( ( F " ) . b ) )) by A3,A4,A19,FUNCT_1:35;
(( ( F " ) . a ) in ( field R ) & ( ( F " ) . b ) in ( field R )) by A2,A3,A5,A19,FUNCT_1:def 3;
then ([ ( ( F " ) . a ),( ( F " ) . b ) ] in R or [ ( ( F " ) . b ),( ( F " ) . a ) ] in R) by A18,A20,A21,CKB4:1;
hence ([ a,b ] in S or [ b,a ] in S) by A1,A21,CKB47:def 1;
end;
hence thesis by CKB4:1;
end;

thus (R is  antisymmetric implies S is  antisymmetric)
proof
assume A22: R is  antisymmetric;
now
let a;
let b;
assume that
A23: [ a,b ] in S
and
A24: [ b,a ] in S;
A25: a in ( field S ) by A23,RELAT_1:15;
then A26: a = ( F . ( ( F " ) . a ) ) by A3,A4,FUNCT_1:35;
A27: b in ( field S ) by A23,RELAT_1:15;
then A28: b = ( F . ( ( F " ) . b ) ) by A3,A4,FUNCT_1:35;
A29: ( ( F " ) . b ) in ( field R ) by A2,A3,A5,A27,FUNCT_1:def 3;
( ( F " ) . a ) in ( field R ) by A2,A3,A5,A25,FUNCT_1:def 3;
then ([ ( ( F " ) . a ),( ( F " ) . b ) ] in R & [ ( ( F " ) . b ),( ( F " ) . a ) ] in R) by A1,A23,A24,A26,A28,A29,CKB47:def 1;
hence a = b by A22,A26,A28,CKB3:1;
end;
hence thesis by CKB3:1;
end;

assume A30: (for Y holds ((Y c= ( field R ) & Y <> ( {} )) implies (ex x st (x in Y & ( R -Seg x ) misses Y))));
let Z;
assume that
A31: Z c= ( field S )
and
A32: Z <> ( {} );
A33: ( F " Z ) c= ( dom F ) by RELAT_1:132;
then consider x such that A34: x in ( F " Z ) and A35: ( R -Seg x ) misses ( F " Z ) by A2,A3,A30,A31,A32,RELAT_1:139;
take ( F . x );
thus ( F . x ) in Z by A34,FUNCT_1:def 7;
assume (not thesis);
then consider y being set such that A36: y in ( S -Seg ( F . x ) ) and A37: y in Z by XBOOLE_0:3;
A38: ( ( F " ) . y ) in ( dom F ) by A3,A5,A31,A37,FUNCT_1:def 3;
A39: [ y,( F . x ) ] in S by A36,CKB6:1;
A40: y = ( F . ( ( F " ) . y ) ) by A3,A4,A31,A37,FUNCT_1:35;
then ( ( F " ) . y ) in ( F " Z ) by A37,A38,FUNCT_1:def 7;
then (not ( ( F " ) . y ) in ( R -Seg x )) by A35,XBOOLE_0:3;
then ((not [ ( ( F " ) . y ),x ] in R) or ( ( F " ) . y ) = x) by CKB6:1;
hence contradiction by A1,A2,A33,A34,A36,A40,A38,A39,CKB6:1,CKB47:def 1;
end;
