environ
vocabularies NUMBERS,NAT_1,XBOOLE_0,VECTSP_1,SUPINF_2,MATRIX_1,FINSEQ_2,ARYTM_1,FINSEQ_1,TREES_1,RELAT_1,ZFMISC_1,XXREAL_0,CARD_1,ARYTM_3,SUBSET_1,FUNCT_1,INCSP_1,FVSUM_1,RVSUM_1,ALGSTR_0,MESFUNC1,RLVECT_1,CARD_3,ORDINAL4,TARSKI,STRUCT_0,MATRIX_2,QC_LANG1,FINSUB_1,BINOP_1,SETWISEO,FUNCOP_1,PARTFUN1,FINSEQOP,FUNCT_5,FINSOP_1,ABIAN,MATRIX_3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XXREAL_0,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,BINOP_1,FINSEQ_4,STRUCT_0,ALGSTR_0,FUNCT_3,FUNCOP_1,RLVECT_1,GROUP_1,VECTSP_1,SETWISEO,FINSOP_1,SETWOP_2,FINSEQ_2,FINSEQOP,MATRIX_1,FINSUB_1,MATRIX_2,NAT_1,FVSUM_1,TREES_1,CAT_2,CKB1,CKB2,CKB3,CKB9,CKB10,CKB11,CKB12,CKB31,CKB32;
definitions BINOP_1,FINSEQ_2,ALGSTR_0,MATRIX_1,CKB1,CKB2,CKB3,CKB9,CKB11,CKB12;
theorems FINSEQ_1,FINSEQ_2,TARSKI,FUNCT_2,NAT_1,BINOP_1,TREES_1,FUNCT_1,SETWISEO,VECTSP_1,ZFMISC_1,FVSUM_1,SETWOP_2,MATRIX_1,MATRIX_2,FUNCT_3,FINSEQOP,FUNCOP_1,FINSUB_1,FUNCT_5,FINSEQ_3,RLVECT_1,RELAT_1,FINSOP_1,XBOOLE_0,XBOOLE_1,XCMPLX_1,GROUP_1,ORDINAL1,XXREAL_0,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30;
schemes FUNCT_2,FINSEQ_2,MATRIX_1,FINSEQ_1,FUNCT_3,SETWISEO,FUNCT_1,BINOP_1;
registrations XBOOLE_0,SUBSET_1,FUNCT_1,ORDINAL1,RELSET_1,PARTFUN1,FUNCT_2,FINSET_1,FINSUB_1,XXREAL_0,XREAL_0,NAT_1,STRUCT_0,VECTSP_1,MATRIX_2,FVSUM_1,RELAT_1,CARD_1,FINSEQ_1,FINSEQ_2;
constructors RELAT_2,PARTFUN1,SETWISEO,SQUARE_1,NAT_1,FINSEQOP,FINSOP_1,SETWOP_2,CAT_2,ALGSTR_1,MATRIX_2,FVSUM_1,RELSET_1,FINSEQ_4,CKB1,CKB2,CKB3,CKB9,CKB10,CKB11,CKB12,CKB31,CKB32;
requirements NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve z for set;
reserve x1 for set;
reserve x2 for set;
reserve y1 for set;
reserve y2 for set;
reserve z1 for set;
reserve z2 for set;
theorem
Th25: (for I,J,D being non empty set holds (for F,G being (BinOp of D) holds (for f being (Function of I,D) holds (for g being (Function of J,D) holds (for X being (Element of ( Fin I )) holds (for Y being (Element of ( Fin J )) holds ((((F is  commutative & F is  associative) & ([: Y,X :] <> ( {} ) or F is  having_a_unity)) & G is  commutative) implies ( F $$ ([: X,Y :],( G * (f,g) )) ) = ( F $$ ([: Y,X :],( G * (g,f) )) ))))))))
proof
deffunc F(set,set) = [ $2,$1 ];
let I being non empty set,J being non empty set,D being non empty set;
let F being (BinOp of D),G being (BinOp of D);
let f being (Function of I,D);
let g being (Function of J,D);
let X being (Element of ( Fin I ));
let Y being (Element of ( Fin J ));
assume A1: ((F is  commutative & F is  associative) & ([: Y,X :] <> ( {} ) or F is  having_a_unity));
consider h being Function such that A2: (( dom h ) = [: J,I :] & (for x holds (for y holds ((x in J & y in I) implies ( h . (x,y) ) = F(x,y))))) from FUNCT_3:sch 2;
now
let z1;
let z2;
assume that
A3: z1 in ( dom h )
and
A4: z2 in ( dom h )
and
A5: ( h . z1 ) = ( h . z2 );
consider x2,y2 such that A6: z2 = [ x2,y2 ] by A2,A4,RELAT_1:def 1;
(x2 in J & y2 in I) by A2,A4,A6,ZFMISC_1:87;
then A7: ( h . (x2,y2) ) = [ y2,x2 ] by A2;
consider x1,y1 such that A8: z1 = [ x1,y1 ] by A2,A3,RELAT_1:def 1;
(x1 in J & y1 in I) by A2,A3,A8,ZFMISC_1:87;
then A9: ( h . (x1,y1) ) = [ y1,x1 ] by A2;
then y1 = y2 by A5,A8,A6,A7,ZFMISC_1:27;
hence z1 = z2 by A5,A8,A6,A9,A7,ZFMISC_1:27;
end;
then A10: h is  one-to-one by FUNCT_1:def 4;
A11: (for x holds (x in [: J,I :] implies ( h . x ) in [: I,J :]))
proof
let x;
assume A12: x in [: J,I :];
then consider y,z such that A13: x = [ y,z ] by RELAT_1:def 1;
A14: (y in J & z in I) by A12,A13,ZFMISC_1:87;
then ( h . (y,z) ) = [ z,y ] by A2;
hence thesis by A13,A14,ZFMISC_1:87;
end;
assume A15: G is  commutative;
A16: ( G * (g,f) ) = ( ( G * (f,g) ) * h )
proof
reconsider G as (Function of [: D,D :],D);
A17: ( dom ( G * (g,f) ) ) = [: J,I :] by FUNCT_2:def 1;
A18: ( dom ( G * (f,g) ) ) = [: I,J :] by FUNCT_2:def 1;
A19: (for x holds (x in ( dom ( G * (g,f) ) ) iff (x in ( dom h ) & ( h . x ) in ( dom ( G * (f,g) ) ))))
proof
let x;
thus (x in ( dom ( G * (g,f) ) ) implies (x in ( dom h ) & ( h . x ) in ( dom ( G * (f,g) ) )))
proof
assume A20: x in ( dom ( G * (g,f) ) );
then consider y,z such that A21: x = [ y,z ] by RELAT_1:def 1;
A22: (y in J & z in I) by A17,A20,A21,ZFMISC_1:87;
then ( h . (y,z) ) = [ z,y ] by A2;
hence thesis by A2,A18,A21,A22,ZFMISC_1:87;
end;

assume that
A23: x in ( dom h )
and
( h . x ) in ( dom ( G * (f,g) ) );
thus thesis by A2,A23,FUNCT_2:def 1;
end;
(for x holds (x in ( dom ( G * (g,f) ) ) implies ( ( G * (g,f) ) . x ) = ( ( G * (f,g) ) . ( h . x ) )))
proof
let x;
assume A24: x in ( dom ( G * (g,f) ) );
then consider y,z such that A25: x = [ y,z ] by RELAT_1:def 1;
reconsider z as (Element of I) by A17,A24,A25,ZFMISC_1:87;
reconsider y as (Element of J) by A17,A24,A25,ZFMISC_1:87;
A26: [ z,y ] in ( dom ( G * (f,g) ) ) by A18,ZFMISC_1:87;
A27: [ y,z ] in ( dom ( G * (g,f) ) ) by A17,ZFMISC_1:87;
thus ( ( G * (f,g) ) . ( h . x ) ) = ( ( G * (f,g) ) . ( h . (y,z) ) ) by A25
.= ( ( G * (f,g) ) . (z,y) ) by A2
.= ( G . (( f . z ),( g . y )) ) by A26,FINSEQOP:77
.= ( G . (( g . y ),( f . z )) ) by A15,BINOP_1:def 2
.= ( ( G * (g,f) ) . (y,z) ) by A27,FINSEQOP:77
.= ( ( G * (g,f) ) . x ) by A25;
end;
hence thesis by A19,FUNCT_1:10;
end;
A28: (X c= I & Y c= J) by FINSUB_1:def 5;
(for y holds (y in [: X,Y :] iff y in ( h .: [: Y,X :] )))
proof
let y;
thus (y in [: X,Y :] implies y in ( h .: [: Y,X :] ))
proof
assume A29: y in [: X,Y :];
then consider y1,x1 such that A30: y = [ y1,x1 ] by RELAT_1:def 1;
A31: (y1 in X & x1 in Y) by A29,A30,ZFMISC_1:87;
then A32: ([ x1,y1 ] in [: Y,X :] & [ x1,y1 ] in ( dom h )) by A28,A2,ZFMISC_1:87;
( h . (x1,y1) ) = y by A28,A2,A30,A31;
hence thesis by A32,FUNCT_1:def 6;
end;

assume y in ( h .: [: Y,X :] );
then consider x such that x in ( dom h ) and A33: x in [: Y,X :] and A34: y = ( h . x ) by FUNCT_1:def 6;
consider x1,y1 such that A35: x = [ x1,y1 ] by A33,RELAT_1:def 1;
A36: (x1 in Y & y1 in X) by A33,A35,ZFMISC_1:87;
y = ( h . (x1,y1) ) by A34,A35;
then y = [ y1,x1 ] by A28,A2,A36;
hence thesis by A36,ZFMISC_1:87;
end;
then A37: ( h .: [: Y,X :] ) = [: X,Y :] by TARSKI:1;
reconsider h as (Function of [: J,I :],[: I,J :]) by A2,A11,FUNCT_2:3;
( F $$ ([: X,Y :],( G * (f,g) )) ) = ( F $$ ([: Y,X :],( ( G * (f,g) ) * h )) ) by A1,A10,A37,SETWOP_2:6
.= ( F $$ ([: Y,X :],( G * (g,f) )) ) by A16;
hence thesis;
end;
