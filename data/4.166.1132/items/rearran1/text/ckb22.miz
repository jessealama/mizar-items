environ
vocabularies NUMBERS,SUBSET_1,REAL_1,XBOOLE_0,MEMBERED,PARTFUN1,VALUED_1,FUNCT_1,RELAT_1,FINSEQ_1,NAT_1,XXREAL_0,FINSET_1,CARD_1,ARYTM_1,TARSKI,ARYTM_3,ZFMISC_1,ORDINAL4,RFINSEQ,RFUNCT_3,CLASSES1,CARD_3,PBOOLE,FINSEQ_2,FUNCT_3,VALUED_0,REARRAN1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,MEMBERED,FUNCT_1,RELSET_1,CARD_1,FINSET_1,NUMBERS,XXREAL_0,XCMPLX_0,REAL_1,NAT_1,PARTFUN1,FINSEQ_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQOP,RVSUM_1,CLASSES1,RFINSEQ,RFUNCT_3,CKB1,CKB3,CKB4,CKB8,CKB10;
definitions TARSKI,XBOOLE_0,FINSEQ_2,RELAT_1,CKB3,CKB4,CKB8;
theorems FINSEQ_1,NAT_1,FUNCT_1,FINSEQ_2,TARSKI,CARD_2,CARD_1,PARTFUN1,FINSET_1,FINSEQ_3,RFUNCT_1,RVSUM_1,ZFMISC_1,RFINSEQ,RFUNCT_3,RELAT_1,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,FUNCOP_1,ORDINAL1,VALUED_1,CLASSES1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21;
schemes NAT_1,FINSEQ_1;
registrations SUBSET_1,RELSET_1,PARTFUN1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,FINSEQ_1,VALUED_0,CARD_1,FINSEQ_2,FUNCT_1,CKB9;
constructors REAL_1,NAT_1,FINSEQOP,RVSUM_1,RFINSEQ,RFUNCT_3,SEQ_1,CLASSES1,RELSET_1,BINOP_2,CKB1,CKB3,CKB4,CKB8;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve m for (Element of ( NAT ));
reserve x for set;
reserve D for non  empty  finite set;
definition
let D being non  empty  finite set;
let A being (RearrangmentGen of D);
func Co_Gen A -> (RearrangmentGen of D) means 
:Def4: (for m being Nat holds ((1 <= m & m <= ( ( len it ) - 1 )) implies ( it . m ) = ( D \ ( A . ( ( len A ) - m ) ) )));
existence
proof
deffunc F(Nat) = ( D \ ( A . ( ( len A ) - $1 ) ) );
set c = ( card D );
D c= D;
then reconsider y = D as (Subset of D);
( ( 0 ) + 1 ) <= c by NAT_1:13;
then ( max (( 0 ),( c - 1 )) ) = ( c - 1 ) by FINSEQ_2:4;
then reconsider c1 = ( c - 1 ) as (Element of ( NAT )) by FINSEQ_2:5;
consider f being FinSequence such that A1: ( len f ) = c1 and A2: (for m being Nat holds (m in ( dom f ) implies ( f . m ) = F(m))) from FINSEQ_1:sch 2;
A3: ( dom f ) = ( Seg c1 ) by A1,FINSEQ_1:def 3;
( rng f ) c= ( bool D )
proof
let x;
assume x in ( rng f );
then consider m being Nat such that A4: (m in ( dom f ) & ( f . m ) = x) by FINSEQ_2:10;
( D \ ( A . ( ( len A ) - m ) ) ) c= D;
then x is (Subset of D) by A2,A4;
hence thesis;
end;
then reconsider f as (FinSequence of ( bool D )) by FINSEQ_1:def 4;
set C = ( f ^ <* y *> );
A5: ( len C ) = ( ( len f ) + ( len <* y *> ) ) by FINSEQ_1:22
.= ( ( len f ) + 1 ) by FINSEQ_1:39;
A6: ( card D ) = ( len A ) by CKB11:1;
A7: C is  terms've_same_card_as_number
proof
let m being Nat;
assume that
A8: 1 <= m
and
A9: m <= ( len C );
( max (( 0 ),( ( len C ) - m )) ) = ( ( len C ) - m ) by A9,FINSEQ_2:4;
then reconsider l = ( ( len C ) - m ) as (Element of ( NAT )) by FINSEQ_2:5;
let B being  finite set;
assume that
A10: B = ( C . m );
now
per cases ;
case m = ( len C );
hence thesis by A1,A5,A10,FINSEQ_1:42;
end;
case m <> ( len C );
then m < ( len C ) by A9,XXREAL_0:1;
then A11: ( m + 1 ) <= ( len C ) by NAT_1:13;
then A12: 1 <= l by XREAL_1:19;
A13: l <= ( len A ) by A6,A1,A5,XREAL_1:43;
then A14: l in ( dom A ) by A12,FINSEQ_3:25;
then reconsider Al = ( A . l ) as  finite set by CKB17:1,FINSET_1:1;
m <= ( ( len C ) - 1 ) by A11,XREAL_1:19;
then A15: m in ( dom f ) by A5,A8,FINSEQ_3:25;
then ( C . m ) = ( f . m ) by FINSEQ_1:def 7
.= ( D \ ( A . l ) ) by A6,A1,A2,A5,A15;
hence ( card B ) = ( ( card D ) - ( card Al ) ) by A10,A14,CKB17:1,CARD_2:44
.= ( ( len A ) - l ) by A6,A12,A13,CKB3:def 1
.= m by A6,A1,A5;
end;
end;
hence thesis;
end;
(for m being Nat holds ((1 <= m & m <= ( ( len C ) - 1 )) implies ( C . m ) c= ( C . ( m + 1 ) )))
proof
let m being Nat;
assume that
A16: 1 <= m
and
A17: m <= ( ( len C ) - 1 );
A18: m in ( dom f ) by A5,A16,A17,FINSEQ_3:25;
then A19: ( C . m ) = ( f . m ) by FINSEQ_1:def 7
.= ( D \ ( A . ( ( len A ) - m ) ) ) by A2,A18;
now
per cases ;
case m = ( ( len C ) - 1 );
then ( C . ( m + 1 ) ) = D by A5,FINSEQ_1:42;
hence thesis by A19;
end;
case m <> ( ( len C ) - 1 );
then A20: m < ( ( len C ) - 1 ) by A17,XXREAL_0:1;
then A21: ( m + 1 ) < ( len A ) by A6,A1,A5,XREAL_1:20;
then ( max (( 0 ),( ( len A ) - ( m + 1 ) )) ) = ( ( len A ) - ( m + 1 ) ) by FINSEQ_2:4;
then reconsider l = ( ( len A ) - ( m + 1 ) ) as (Element of ( NAT )) by FINSEQ_2:5;
A22: 1 <= ( m + 1 ) by NAT_1:11;
( m + 1 ) <= ( ( len C ) - 1 ) by A5,A20,NAT_1:13;
then A23: ( m + 1 ) in ( dom f ) by A5,A22,FINSEQ_3:25;
then A24: ( C . ( m + 1 ) ) = ( f . ( m + 1 ) ) by FINSEQ_1:def 7
.= ( D \ ( A . l ) ) by A2,A23;
( ( m + 1 ) + 1 ) <= ( len A ) by A21,NAT_1:13;
then A25: 1 <= ( ( len A ) - ( m + 1 ) ) by XREAL_1:19;
l <= ( ( len A ) - 1 ) by A22,XREAL_1:13;
then ( A . l ) c= ( A . ( l + 1 ) ) by A25,CKB4:def 1;
hence thesis by A19,A24,XBOOLE_1:34;
end;
end;
hence thesis;
end;
then reconsider C as (RearrangmentGen of D) by A1,A5,A7,CKB4:def 1,CKB11:1;
take C;
let m being Nat;
assume (1 <= m & m <= ( ( len C ) - 1 ));
then A26: m in ( Seg c1 ) by A1,A5,FINSEQ_1:1;
then m in ( dom f ) by A1,FINSEQ_1:def 3;
hence ( C . m ) = ( f . m ) by FINSEQ_1:def 7
.= ( D \ ( A . ( ( len A ) - m ) ) ) by A2,A3,A26;
end;
uniqueness
proof
let f1 being (RearrangmentGen of D);
let f2 being (RearrangmentGen of D);
assume that
A27: (for m being Nat holds ((1 <= m & m <= ( ( len f1 ) - 1 )) implies ( f1 . m ) = ( D \ ( A . ( ( len A ) - m ) ) )))
and
A28: (for m being Nat holds ((1 <= m & m <= ( ( len f2 ) - 1 )) implies ( f2 . m ) = ( D \ ( A . ( ( len A ) - m ) ) )));
A29: ( len f2 ) = ( card D ) by CKB11:1;
A30: ( len A ) = ( card D ) by CKB11:1;
A31: ( len f1 ) = ( card D ) by CKB11:1;
then A32: ( dom f1 ) = ( Seg ( len A ) ) by A30,FINSEQ_1:def 3;
now
let m being Nat;
reconsider m1 = m as (Element of ( NAT )) by ORDINAL1:def 12;
assume A33: m in ( dom f1 );
then A34: 1 <= m by A32,FINSEQ_1:1;
A35: m <= ( len A ) by A32,A33,FINSEQ_1:1;
now
per cases ;
case A36: m = ( len A );
then ( f1 . m ) = D by A31,A30,CKB13:1;
hence ( f1 . m ) = ( f2 . m ) by A29,A30,A36,CKB13:1;
end;
case m <> ( len A );
then m < ( len A ) by A35,XXREAL_0:1;
then ( m + 1 ) <= ( len A ) by NAT_1:13;
then A37: m <= ( ( len A ) - 1 ) by XREAL_1:19;
then ( f1 . m1 ) = ( D \ ( A . ( ( len A ) - m1 ) ) ) by A27,A31,A30,A34;
hence ( f1 . m ) = ( f2 . m ) by A28,A29,A30,A34,A37;
end;
end;
hence ( f1 . m ) = ( f2 . m );
end;
hence thesis by A31,A29,FINSEQ_2:9;
end;
end;
