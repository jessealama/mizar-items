environ
vocabularies NUMBERS,SUBSET_1,REAL_1,XBOOLE_0,MEMBERED,PARTFUN1,VALUED_1,FUNCT_1,RELAT_1,FINSEQ_1,NAT_1,XXREAL_0,FINSET_1,CARD_1,ARYTM_1,TARSKI,ARYTM_3,ZFMISC_1,ORDINAL4,RFINSEQ,RFUNCT_3,CLASSES1,CARD_3,PBOOLE,FINSEQ_2,FUNCT_3,VALUED_0,REARRAN1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,MEMBERED,FUNCT_1,RELSET_1,CARD_1,FINSET_1,NUMBERS,XXREAL_0,XCMPLX_0,REAL_1,NAT_1,PARTFUN1,FINSEQ_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQOP,RVSUM_1,CLASSES1,RFINSEQ,RFUNCT_3,CKB1,CKB3,CKB4,CKB8,CKB10,CKB22,CKB25,CKB26;
definitions TARSKI,XBOOLE_0,FINSEQ_2,RELAT_1,CKB3,CKB4,CKB8,CKB22,CKB25,CKB26;
theorems FINSEQ_1,NAT_1,FUNCT_1,FINSEQ_2,TARSKI,CARD_2,CARD_1,PARTFUN1,FINSET_1,FINSEQ_3,RFUNCT_1,RVSUM_1,ZFMISC_1,RFINSEQ,RFUNCT_3,RELAT_1,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,FUNCOP_1,ORDINAL1,VALUED_1,CLASSES1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45;
schemes NAT_1,FINSEQ_1;
registrations SUBSET_1,RELSET_1,PARTFUN1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,FINSEQ_1,VALUED_0,CARD_1,FINSEQ_2,FUNCT_1,CKB9;
constructors REAL_1,NAT_1,FINSEQOP,RVSUM_1,RFINSEQ,RFUNCT_3,SEQ_1,CLASSES1,RELSET_1,BINOP_2,CKB1,CKB3,CKB4,CKB8,CKB22,CKB25,CKB26;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve C for non empty  finite set;
reserve D for non empty  finite set;
theorem
(for F being (PartFunc of D,( REAL )) holds (for A being (RearrangmentGen of C) holds (((F is  total & ( card D ) = ( card C )) & n in ( dom A )) implies ( ( FinS (( Rland (F,A) ),C) ) | n ) = ( FinS (( Rland (F,A) ),( A . n )) ))))
proof
let F being (PartFunc of D,( REAL ));
let B being (RearrangmentGen of C);
assume that
A1: (F is  total & ( card D ) = ( card C ))
and
A2: n in ( dom B );
set p = ( Rland (F,B) );
A3: ( len ( FinS (p,C) ) ) = ( card C ) by A1,CKB45:1;
defpred P[ (Element of ( NAT )) ]
 means
($1 in ( dom B ) implies ( ( FinS (( Rland (F,B) ),C) ) | $1 ) = ( FinS (( Rland (F,B) ),( B . $1 )) ));
A4: ( len B ) = ( card C ) by CKB11:1;
A5: (( dom B ) = ( Seg ( len B ) ) & ( dom ( FinS (p,C) ) ) = ( Seg ( len ( FinS (p,C) ) ) )) by FINSEQ_1:def 3;
A6: (for m holds (P[ m ] implies P[ ( m + 1 ) ]))
proof
set f = ( FinS (p,C) );
let m;
assume A7: P[ m ];
A8: m <= ( m + 1 ) by NAT_1:11;
assume A9: ( m + 1 ) in ( dom B );
then 1 <= ( m + 1 ) by FINSEQ_3:25;
then A10: ( m + 1 ) in ( Seg ( m + 1 ) ) by FINSEQ_1:1;
A11: ( dom p ) = C by A1,CKB27:1;
A12: ( m + 1 ) <= ( len B ) by A9,FINSEQ_3:25;
then A13: m <= ( len B ) by NAT_1:13;
A14: m < ( len B ) by A12,NAT_1:13;
A15: m <= ( ( len B ) - 1 ) by A12,XREAL_1:19;
A16: ( len ( f | ( m + 1 ) ) ) = ( m + 1 ) by A4,A3,A12,FINSEQ_1:59;
now
per cases ;
case A17: m = ( 0 );
consider d being (Element of C) such that A18: ( B . 1 ) = { d } by CKB20:1;
A19: d in ( B . 1 ) by A18,TARSKI:def 1;
A20: 1 <= ( len ( FinS (p,C) ) ) by A1,CKB45:1;
then (1 in ( Seg 1 ) & 1 in ( dom ( FinS (p,C) ) )) by FINSEQ_1:1,FINSEQ_3:25;
then A21: ( ( ( FinS (p,C) ) | ( m + 1 ) ) . 1 ) = ( ( FinS (p,C) ) . 1 ) by A17,RFINSEQ:6
.= ( ( FinS (F,D) ) . 1 ) by A1,CKB32:1
.= ( p . d ) by A1,A19,CKB29:1;
( dom p ) = C by A1,CKB27:1;
then A22: ( FinS (p,( B . ( m + 1 ) )) ) = <* ( p . d ) *> by A17,A18,RFUNCT_3:69;
( len ( ( FinS (p,C) ) | ( m + 1 ) ) ) = 1 by A17,A20,FINSEQ_1:59;
hence thesis by A22,A21,FINSEQ_1:40;
end;
case A23: m <> ( 0 );
A24: ( Seg m ) c= ( Seg ( m + 1 ) ) by A8,FINSEQ_1:5;
A25: ( ( f | ( m + 1 ) ) | m ) = ( ( f | ( m + 1 ) ) | ( Seg m ) ) by FINSEQ_1:def 15
.= ( ( f | ( Seg ( m + 1 ) ) ) | ( Seg m ) ) by FINSEQ_1:def 15
.= ( f | ( ( Seg ( m + 1 ) ) /\ ( Seg m ) ) ) by RELAT_1:71
.= ( f | ( Seg m ) ) by A24,XBOOLE_1:28
.= ( f | m ) by FINSEQ_1:def 15;
A26: ( ( 0 ) + 1 ) <= m by A23,NAT_1:13;
then consider d being (Element of C) such that A27: ( ( B . ( m + 1 ) ) \ ( B . m ) ) = { d } and ( B . ( m + 1 ) ) = ( ( B . m ) \/ { d } ) and A28: ( ( B . ( m + 1 ) ) \ { d } ) = ( B . m ) by A15,CKB21:1;
A29: d in { d } by TARSKI:def 1;
then ( p . d ) = ( ( FinS (F,D) ) . ( m + 1 ) ) by A1,A14,A26,A27,CKB29:1
.= ( ( FinS (p,C) ) . ( m + 1 ) ) by A1,CKB32:1
.= ( ( f | ( m + 1 ) ) . ( m + 1 ) ) by A5,A4,A3,A9,A10,RFINSEQ:6;
then A30: ( f | ( m + 1 ) ) = ( ( f | m ) ^ <* ( p . d ) *> ) by A16,A25,RFINSEQ:7;
d in ( ( dom p ) /\ ( B . ( m + 1 ) ) ) by A11,A27,A29,XBOOLE_0:def 4;
then A31: d in ( dom ( p | ( B . ( m + 1 ) ) ) ) by RELAT_1:61;
A32: ( f | ( m + 1 ) ) is  non-increasing by RFINSEQ:20;
A33: ( dom ( p | ( B . ( m + 1 ) ) ) ) = ( ( dom p ) /\ ( B . ( m + 1 ) ) ) by RELAT_1:61
.= ( B . ( m + 1 ) ) by A9,A11,CKB17:1,XBOOLE_1:28;
( B . ( m + 1 ) ) is  finite by A9,CKB17:1,FINSET_1:1;
then ( f | ( m + 1 ) ),( p | ( B . ( m + 1 ) ) ) are_fiberwise_equipotent  by A7,A13,A26,A28,A30,A31,FINSEQ_3:25,RFUNCT_3:65;
hence thesis by A33,A32,RFUNCT_3:def 13;
end;
end;
hence thesis;
end;
A34: P[ ( 0 ) ] by FINSEQ_3:25;
(for m holds P[ m ]) from NAT_1:sch 1(A34,A6);
hence thesis by A2;
end;
