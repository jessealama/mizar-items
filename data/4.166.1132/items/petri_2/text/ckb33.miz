environ
vocabularies PETRI,FUNCT_1,XBOOLE_0,TARSKI,SUBSET_1,FUNCT_2,RELAT_1,FUNCOP_1,FUNCT_4,FINSET_1,SETFAM_1,ZFMISC_1,PARTFUN1,ARYTM_3,CARD_1,PETRI_2,STRUCT_0;
notations TARSKI,XBOOLE_0,ENUMSET1,SUBSET_1,ZFMISC_1,SETFAM_1,RELAT_1,RELSET_1,DOMAIN_1,PETRI,FUNCT_1,PARTFUN1,FUNCT_2,FUNCT_4,RELSET_2,FINSET_1,FUNCOP_1,CARD_1,PARTIT_2,STRUCT_0,CKB1,CKB2,CKB5,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB21,CKB22,CKB23,CKB24,CKB30,CKB31,CKB32;
definitions TARSKI,PETRI,STRUCT_0,PARTIT_2,CKB1,CKB2,CKB5,CKB13,CKB14,CKB15,CKB16,CKB18,CKB22,CKB23,CKB24,CKB31,CKB32;
theorems RELSET_1,PARTFUN1,TARSKI,ZFMISC_1,RELAT_1,XBOOLE_0,PETRI,FUNCT_1,FUNCT_2,XBOOLE_1,FUNCT_4,FUNCOP_1,RELSET_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB31,CKB32;
schemes FUNCT_2;
registrations SUBSET_1,RELAT_1,PARTFUN1,RELSET_1,XBOOLE_0,FUNCT_2,FINSET_1,REALSET1,STRUCT_0,PARTIT_2,FUNCT_1,PETRI,ZFMISC_1,CKB17,CKB19,CKB20,CKB29;
constructors RELSET_1,DOMAIN_1,PETRI,RELSET_2,FUNCOP_1,FUNCT_4,CARD_1,STRUCT_0,PARTIT_2,CKB1,CKB2,CKB5,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB22,CKB23,CKB24,CKB31,CKB32;
requirements SUBSET,BOOLE;
begin
definition
let CPNT1 being Colored-PT-net;
let CPNT2 being Colored-PT-net;
let O being (connecting-mapping of CPNT1,CPNT2);
mode connecting-firing-rule of CPNT1,CPNT2,O
means :Def14: (ex q12,q21 being Function st (ex O12 being (Function of ( Outbds CPNT1 ),(the carrier of CPNT2)) st (ex O21 being (Function of ( Outbds CPNT2 ),(the carrier of CPNT1)) st (((((O = [ O12,O21 ] & ( dom q12 ) = ( Outbds CPNT1 )) & ( dom q21 ) = ( Outbds CPNT2 )) & (for t01 being (transition of CPNT1) holds (t01 is  outbound implies ( q12 . t01 ) is (Function of ( thin_cylinders ((the ColoredSet of CPNT1),( *' { t01 } )) ),( thin_cylinders ((the ColoredSet of CPNT1),( Im (O12,t01) )) ))))) & (for t02 being (transition of CPNT2) holds (t02 is  outbound implies ( q21 . t02 ) is (Function of ( thin_cylinders ((the ColoredSet of CPNT2),( *' { t02 } )) ),( thin_cylinders ((the ColoredSet of CPNT2),( Im (O21,t02) )) ))))) & it = [ q12,q21 ]))));
correctness
proof
set L2 = ( bool ( PFuncs ((the carrier of CPNT1),(the ColoredSet of CPNT2)) ) );
set L1 = ( bool ( PFuncs ((the carrier of CPNT2),(the ColoredSet of CPNT2)) ) );
set K2 = ( bool ( PFuncs ((the carrier of CPNT2),(the ColoredSet of CPNT1)) ) );
set K1 = ( bool ( PFuncs ((the carrier of CPNT1),(the ColoredSet of CPNT1)) ) );
set TO2 = ( Outbds CPNT2 );
set TO1 = ( Outbds CPNT1 );
set Y1 = ( PFuncs (K1,K2) );
set Y2 = ( PFuncs (L1,L2) );
consider O12 being (Function of ( Outbds CPNT1 ),(the carrier of CPNT2)),O21 being (Function of ( Outbds CPNT2 ),(the carrier of CPNT1)) such that A1: O = [ O12,O21 ] by CKB32:def 1;
defpred R[ set,set ]
 means
(ex t02 being (transition of CPNT2) st ($1 = t02 & $2 is (Function of ( thin_cylinders ((the ColoredSet of CPNT2),( *' { t02 } )) ),( thin_cylinders ((the ColoredSet of CPNT2),( Im (O21,t02) )) ))));
defpred P[ set,set ]
 means
(ex t01 being (transition of CPNT1) st ($1 = t01 & $2 is (Function of ( thin_cylinders ((the ColoredSet of CPNT1),( *' { t01 } )) ),( thin_cylinders ((the ColoredSet of CPNT1),( Im (O12,t01) )) ))));
A2: (for x being set holds (x in TO1 implies (ex y being set st (y in Y1 & P[ x,y ]))))
proof
let x being set;
assume x in TO1;
then consider t01 being (transition of CPNT1) such that A3: x = t01 and t01 is  outbound;
set t2 = ( Im (O12,t01) );
set t1 = ( *' { t01 } );
set y = the (Function of ( thin_cylinders ((the ColoredSet of CPNT1),t1) ),( thin_cylinders ((the ColoredSet of CPNT1),t2) ));
take y;
set H1 = ( thin_cylinders ((the ColoredSet of CPNT1),t1) );
set H2 = ( thin_cylinders ((the ColoredSet of CPNT1),t2) );
A4: ( Funcs (H1,H2) ) c= ( PFuncs (H1,H2) ) by FUNCT_2:72;
A5: H2 c= ( bool ( PFuncs ((the carrier of CPNT2),(the ColoredSet of CPNT1)) ) ) by CKB6:1;
H1 c= ( bool ( PFuncs ((the carrier of CPNT1),(the ColoredSet of CPNT1)) ) ) by CKB6:1;
then A6: ( PFuncs (H1,H2) ) c= ( PFuncs (K1,K2) ) by A5,PARTFUN1:50;
y in ( Funcs (H1,H2) ) by FUNCT_2:8;
then y in ( PFuncs (H1,H2) ) by A4;
hence thesis by A3,A6;
end;
consider q12 being (Function of TO1,Y1) such that A7: (for x being set holds (x in TO1 implies P[ x,( q12 . x ) ])) from FUNCT_2:sch 1(A2);
A8:now
let tt01 being (transition of CPNT1);
assume tt01 is  outbound;
then tt01 in TO1;
then (ex t01 being (transition of CPNT1) st (tt01 = t01 & ( q12 . tt01 ) is (Function of ( thin_cylinders ((the ColoredSet of CPNT1),( *' { t01 } )) ),( thin_cylinders ((the ColoredSet of CPNT1),( Im (O12,t01) )) )))) by A7;
hence ( q12 . tt01 ) is (Function of ( thin_cylinders ((the ColoredSet of CPNT1),( *' { tt01 } )) ),( thin_cylinders ((the ColoredSet of CPNT1),( Im (O12,tt01) )) ));
end;
A9: (for x being set holds (x in TO2 implies (ex y being set st (y in Y2 & R[ x,y ]))))
proof
let x being set;
assume x in TO2;
then consider t02 being (transition of CPNT2) such that A10: x = t02 and t02 is  outbound;
set t2 = ( Im (O21,t02) );
set t1 = ( *' { t02 } );
set y = the (Function of ( thin_cylinders ((the ColoredSet of CPNT2),t1) ),( thin_cylinders ((the ColoredSet of CPNT2),t2) ));
take y;
set H1 = ( thin_cylinders ((the ColoredSet of CPNT2),t1) );
set H2 = ( thin_cylinders ((the ColoredSet of CPNT2),t2) );
A11: ( Funcs (H1,H2) ) c= ( PFuncs (H1,H2) ) by FUNCT_2:72;
A12: H2 c= ( bool ( PFuncs ((the carrier of CPNT1),(the ColoredSet of CPNT2)) ) ) by CKB6:1;
H1 c= ( bool ( PFuncs ((the carrier of CPNT2),(the ColoredSet of CPNT2)) ) ) by CKB6:1;
then A13: ( PFuncs (H1,H2) ) c= ( PFuncs (L1,L2) ) by A12,PARTFUN1:50;
y in ( Funcs (H1,H2) ) by FUNCT_2:8;
then y in ( PFuncs (H1,H2) ) by A11;
hence thesis by A10,A13;
end;
consider q21 being (Function of TO2,Y2) such that A14: (for x being set holds (x in TO2 implies R[ x,( q21 . x ) ])) from FUNCT_2:sch 1(A9);
A15:now
let tt02 being (transition of CPNT2);
assume tt02 is  outbound;
then tt02 in TO2;
then (ex t02 being (transition of CPNT2) st (tt02 = t02 & ( q21 . tt02 ) is (Function of ( thin_cylinders ((the ColoredSet of CPNT2),( *' { t02 } )) ),( thin_cylinders ((the ColoredSet of CPNT2),( Im (O21,t02) )) )))) by A14;
hence ( q21 . tt02 ) is (Function of ( thin_cylinders ((the ColoredSet of CPNT2),( *' { tt02 } )) ),( thin_cylinders ((the ColoredSet of CPNT2),( Im (O21,tt02) )) ));
end;
take [ q12,q21 ];
A16: ( dom q21 ) = ( Outbds CPNT2 ) by FUNCT_2:def 1;
( dom q12 ) = ( Outbds CPNT1 ) by FUNCT_2:def 1;
hence thesis by A1,A8,A15,A16;
end;
end;
