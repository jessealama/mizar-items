environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,FUNCT_1,PARTFUN1,FUNCT_4,RELAT_1,TARSKI,FUNCOP_1,ORDINAL1,XXREAL_0,FINSET_1,CARD_1,FINSEQ_1,NAT_1,CARD_3,ARYTM_3,QMAX_1,FSM_1,ZFMISC_1,ARYTM_1,FUNCT_2,LANG1,INT_1,MCART_1,CIRCUIT2,MSUALG_1,ORDINAL4,VALUED_2,FINSEQ_2,UNIALG_1,PRALG_3,TURING_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,INT_1,FINSET_1,MCART_1,DOMAIN_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCT_4,FUNCOP_1,GR_CY_1,FINSEQ_1,FINSEQ_2,FINSEQ_4,UNIALG_1,COMPUT_1,XXREAL_0,REAL_1,NAT_1,MARGREL1,CKB1,CKB2,CKB3,CKB4,CKB9,CKB10,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB33,CKB34,CKB36,CKB37,CKB39,CKB40,CKB50,CKB59,CKB62,CKB64;
definitions FINSEQ_1,GR_CY_1,COMPUT_1,FUNCOP_1,MARGREL1,CKB4,CKB17,CKB21,CKB22,CKB23,CKB24,CKB25,CKB33,CKB34,CKB36,CKB37,CKB39,CKB40,CKB50,CKB59,CKB62,CKB64;
theorems FUNCOP_1,FUNCT_4,ZFMISC_1,TARSKI,FUNCT_2,INT_1,MCART_1,NAT_1,RELSET_1,PARTFUN1,DOMAIN_1,CQC_THE1,ENUMSET1,FINSEQ_2,FINSEQ_1,FINSEQ_3,FUNCT_1,RELAT_1,FINSEQ_6,FINSEQ_7,COMPUT_1,FINSEQ_4,ORDINAL1,XBOOLE_0,XBOOLE_1,NUMBERS,XREAL_1,FUNCT_7,FINSOP_1,XXREAL_0,RVSUM_1,CKB4,CKB6,CKB7,CKB8,CKB11,CKB12,CKB17,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67;
schemes NAT_1,FUNCT_2,BINOP_2;
registrations XBOOLE_0,SUBSET_1,FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,NUMBERS,XREAL_0,INT_1,COMPUT_1,MARGREL1,FINSEQ_1,CKB5,CKB13;
constructors DOMAIN_1,REAL_1,BINOP_2,FINSEQ_4,FINSOP_1,GR_CY_1,COMPUT_1,RECDEF_1,RELSET_1,UNIALG_1,MARGREL1,CKB1,CKB2,CKB4,CKB10,CKB13,CKB17,CKB21,CKB22,CKB23,CKB24,CKB25,CKB33,CKB34,CKB36,CKB37,CKB39,CKB40,CKB50,CKB59,CKB62,CKB64;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve n for (Element of ( NAT ));
reserve i for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve T for TuringStr;
reserve s for (All-State of T);
theorem
Th36: (for s being (All-State of ( SuccTuring )) holds (for t being (Tape of ( SuccTuring )) holds (for head,n being (Element of ( NAT )) holds ((s = [ ( 0 ),head,t ] & t storeData <* head,n *>) implies ((s is  Accept-Halt & ( ( Result s ) `2 ) = head) & ( ( Result s ) `3 ) storeData <* head,( n + 1 ) *>)))))
proof
reconsider F = ( 0 ) as (Symbol of ( SuccTuring )) by CKB66:1;
let s being (All-State of ( SuccTuring ));
let t being (Tape of ( SuccTuring ));
let h being (Element of ( NAT ));
let n being (Element of ( NAT ));
assume that
A1: s = [ ( 0 ),h,t ]
and
A2: t storeData <* h,n *>;
A3: ( t . h ) = ( 0 ) by A2,CKB43:1;
set i3 = ( ( ( ( h + 1 ) + 1 ) + n ) + 1 );
reconsider h1 = ( h + 1 ) as (Element of ( INT )) by INT_1:def 2;
reconsider p1 = 1 as (State of ( SuccTuring )) by CKB65:1;
A4: ( ( h1 + 1 ) + n ) < i3 by XREAL_1:29;
h <= ( h + n ) by NAT_1:11;
then A5: ( h + 2 ) <= ( ( h + n ) + 2 ) by XREAL_1:7;
A6: h1 < ( h + 2 ) by XREAL_1:8;
then A7: h1 < ( ( h + n ) + 2 ) by A5,XXREAL_0:2;
reconsider p2 = 2 as (State of ( SuccTuring )) by CKB65:1;
reconsider i2 = ( h1 + 1 ) as (Element of ( INT )) by INT_1:def 2;
reconsider nk = ( ( h1 + 1 ) + n ) as (Element of ( INT )) by INT_1:def 2;
reconsider hh = h as (Element of ( INT )) by INT_1:def 2;
reconsider n3 = i3 as (Element of ( INT )) by INT_1:def 2;
reconsider T = 1 as (Symbol of ( SuccTuring )) by CKB66:1;
A8: ( n3 + ( - 1 ) ) = ( ( ( h + 1 ) + 1 ) + n );
set t1 = ( Tape-Chg (t,h1,T) );
A9: h < h1 by XREAL_1:29;
A10: ( t . ( ( h + n ) + 2 ) ) = ( 0 ) by A2,CKB43:1;
A11: ((( t1 . h ) = ( 0 ) & ( t1 . ( ( h + n ) + 2 ) ) = ( 0 )) & (for i being Integer holds ((h < i & i < ( ( h + n ) + 2 )) implies ( t1 . i ) = 1)))
proof
thus ( t1 . h ) = ( 0 ) by A3,A9,CKB56:1;
thus ( t1 . ( ( h + n ) + 2 ) ) = ( 0 ) by A10,A5,A6,CKB56:1;
hereby
let i being Integer;
assume A12: (h < i & i < ( ( h + n ) + 2 ));
per cases ;
suppose h1 = i;

hence ( t1 . i ) = 1 by CKB56:1;
end;
suppose h1 <> i;

hence ( t1 . i ) = ( t . i ) by CKB56:1
.= 1 by A2,A12,CKB43:1;
end;
end;
end;
A13: (for i being Integer holds ((( ( h + 1 ) + 1 ) <= i & i < ( ( ( h + 1 ) + 1 ) + n )) implies ( t1 . i ) = 1))
proof
let i being Integer;
assume that
A14: ( ( h + 1 ) + 1 ) <= i
and
A15: i < ( ( ( h + 1 ) + 1 ) + n );
h1 < ( h1 + 1 ) by XREAL_1:29;
then h1 < i by A14,XXREAL_0:2;
then h < i by A9,XXREAL_0:2;
hence thesis by A11,A15;
end;
reconsider s3 = ( s `3 ) as (Tape of ( SuccTuring ));
A16: ( TRAN s ) = ( ( Succ_Tran ) . [ ( s `1 ),( s3 . ( Head s ) ) ] ) by CKB64:def 1
.= ( ( Succ_Tran ) . [ ( 0 ),( s3 . ( Head s ) ) ] ) by A1,MCART_1:64
.= ( ( Succ_Tran ) . [ ( 0 ),( t . ( Head s ) ) ] ) by A1,MCART_1:64
.= [ 1,( 0 ),1 ] by A1,A3,CKB63:1,MCART_1:64;
then A17: ( offset ( TRAN s ) ) = 1 by MCART_1:64;
set s1 = [ p1,h1,t ];
reconsider s3 = ( s1 `3 ) as (Tape of ( SuccTuring ));
( Tape-Chg (( s `3 ),( Head s ),( ( TRAN s ) `2 )) ) = ( Tape-Chg (t,( Head s ),( ( TRAN s ) `2 )) ) by A1,MCART_1:64
.= ( Tape-Chg (t,h,( ( TRAN s ) `2 )) ) by A1,MCART_1:64
.= ( Tape-Chg (t,h,F) ) by A16,MCART_1:64
.= t by A3,CKB52:1;
then A18: ( Following s ) = [ ( ( TRAN s ) `1 ),( ( Head s ) + ( offset ( TRAN s ) ) ),t ] by A1,CKB67:1
.= [ 1,( ( Head s ) + ( offset ( TRAN s ) ) ),t ] by A16,MCART_1:64
.= s1 by A1,A17,MCART_1:64;
A19: ( TRAN s1 ) = ( ( Succ_Tran ) . [ ( s1 `1 ),( s3 . ( Head s1 ) ) ] ) by CKB64:def 1
.= ( ( Succ_Tran ) . [ p1,( s3 . ( Head s1 ) ) ] ) by MCART_1:64
.= ( ( Succ_Tran ) . [ p1,( t . ( Head s1 ) ) ] ) by MCART_1:64
.= ( ( Succ_Tran ) . [ 1,( t . h1 ) ] ) by MCART_1:64
.= [ 1,1,1 ] by A2,A9,A7,CKB43:1,CKB63:1;
then A20: ( offset ( TRAN s1 ) ) = 1 by MCART_1:64;
reconsider p1 = 1 as (State of ( SuccTuring )) by CKB65:1;
set s2 = [ p1,i2,t1 ];
( Tape-Chg (( s1 `3 ),( Head s1 ),( ( TRAN s1 ) `2 )) ) = ( Tape-Chg (t,( Head s1 ),( ( TRAN s1 ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t,h1,( ( TRAN s1 ) `2 )) ) by MCART_1:64
.= t1 by A19,MCART_1:64;
then A21: ( Following s1 ) = [ ( ( TRAN s1 ) `1 ),( ( Head s1 ) + ( offset ( TRAN s1 ) ) ),t1 ] by CKB67:1
.= [ 1,( ( Head s1 ) + ( offset ( TRAN s1 ) ) ),t1 ] by A19,MCART_1:64
.= s2 by A20,MCART_1:64;
reconsider p3 = 3 as (State of ( SuccTuring )) by CKB65:1;
set sn = [ p1,nk,t1 ];
set t2 = ( Tape-Chg (t1,nk,T) );
set t3 = ( Tape-Chg (t2,n3,F) );
(( (the Tran of ( SuccTuring )) . [ p1,1 ] ) = [ p1,1,1 ] & p1 <> (the AcceptS of ( SuccTuring ))) by CKB64:def 1,CKB63:1;
then A22: ( ( Computation s2 ) . n ) = [ p1,( ( ( h + 1 ) + 1 ) + n ),t1 ] by A13,CKB57:1;
(( h1 + 1 ) <= ( ( ( h + 1 ) + 1 ) + n ) & h1 < ( h1 + 1 )) by NAT_1:11,XREAL_1:29;
then A23: h1 < ( ( h1 + 1 ) + n ) by XXREAL_0:2;
A24: (( t2 . h ) = ( 0 ) & (for i being Integer holds ((h < i & i <= ( ( h + n ) + 2 )) implies ( t2 . i ) = 1)))
proof
thus ( t2 . h ) = ( 0 ) by A9,A11,A23,CKB56:1;
hereby
let i being Integer;
assume that
A25: h < i
and
A26: i <= ( ( h + n ) + 2 );
per cases ;
suppose A27: i <> ( ( h + n ) + 2 );

then A28: i < ( ( h + n ) + 2 ) by A26,XXREAL_0:1;
thus ( t2 . i ) = ( t1 . i ) by A27,CKB56:1
.= 1 by A11,A25,A28;
end;
suppose i = ( ( h + n ) + 2 );

hence ( t2 . i ) = 1 by CKB56:1;
end;
end;
end;
set sp3 = [ p3,nk,t3 ];
set sm = [ p2,n3,t2 ];
reconsider sm3 = ( sm `3 ) as (Tape of ( SuccTuring ));
A29: (the Symbols of ( SuccTuring )) = { ( 0 ),1 } by CKB64:def 1;
A30:now
per cases  by A29,TARSKI:def 2;
suppose ( t2 . n3 ) = 1;

hence ( ( Succ_Tran ) . [ 2,( t2 . n3 ) ] ) = [ p3,( 0 ),( - 1 ) ] by CKB63:1;
end;
suppose ( t2 . n3 ) = ( 0 );

hence ( ( Succ_Tran ) . [ 2,( t2 . n3 ) ] ) = [ p3,( 0 ),( - 1 ) ] by CKB63:1;
end;
end;
A31: ( TRAN sm ) = ( ( Succ_Tran ) . [ ( sm `1 ),( sm3 . ( Head sm ) ) ] ) by CKB64:def 1
.= ( ( Succ_Tran ) . [ 2,( sm3 . ( Head sm ) ) ] ) by MCART_1:64
.= ( ( Succ_Tran ) . [ 2,( t2 . ( Head sm ) ) ] ) by MCART_1:64
.= [ p3,( 0 ),( - 1 ) ] by A30,MCART_1:64;
then A32: ( offset ( TRAN sm ) ) = ( - 1 ) by MCART_1:64;
set j1 = ( ( 1 + 1 ) + n );
set sp5 = [ p3,hh,t3 ];
defpred R[ (Element of ( NAT )) ]
 means
(( h + $1 ) <= nk implies ( ( Computation sp3 ) . $1 ) = [ 3,( nk - $1 ),t3 ]);
reconsider sn3 = ( sn `3 ) as (Tape of ( SuccTuring ));
A33: ( h + j1 ) = nk;
set Rs = ( ( Computation s ) . ( ( 1 + 1 ) + ( ( ( n + 1 ) + 1 ) + ( j1 + 1 ) ) ) );
A34: ( TRAN sn ) = ( ( Succ_Tran ) . [ ( sn `1 ),( sn3 . ( Head sn ) ) ] ) by CKB64:def 1
.= ( ( Succ_Tran ) . [ p1,( sn3 . ( Head sn ) ) ] ) by MCART_1:64
.= ( ( Succ_Tran ) . [ p1,( t1 . ( Head sn ) ) ] ) by MCART_1:64
.= [ 2,1,1 ] by A11,CKB63:1,MCART_1:64;
then A35: ( offset ( TRAN sn ) ) = 1 by MCART_1:64;
A36: h < ( ( h1 + 1 ) + n ) by A9,A23,XXREAL_0:2;
A37: ((( t3 . h ) = ( 0 ) & ( t3 . ( ( h + ( n + 1 ) ) + 2 ) ) = ( 0 )) & (for k being Integer holds ((h < k & k < ( ( h + ( n + 1 ) ) + 2 )) implies ( t3 . k ) = 1)))
proof
thus ( t3 . h ) = ( 0 ) by A36,A24,A4,CKB56:1;
thus ( t3 . ( ( h + ( n + 1 ) ) + 2 ) ) = ( 0 ) by CKB56:1;
hereby
let i being Integer;
assume that
A38: h < i
and
A39: i < ( ( h + ( n + 1 ) ) + 2 );
( i + 1 ) <= ( ( h + ( n + 1 ) ) + 2 ) by A39,INT_1:7;
then A40: i <= ( ( ( h + ( n + 1 ) ) + 2 ) - 1 ) by XREAL_1:19;
thus ( t3 . i ) = ( t2 . i ) by A39,CKB56:1
.= 1 by A24,A38,A40;
end;
end;
then A41: t3 is_1_between h,( ( h + ( n + 1 ) ) + 2 ) by CKB39:def 1;
( Tape-Chg (( sm `3 ),( Head sm ),( ( TRAN sm ) `2 )) ) = ( Tape-Chg (t2,( Head sm ),( ( TRAN sm ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t2,n3,( ( TRAN sm ) `2 )) ) by MCART_1:64
.= t3 by A31,MCART_1:64;
then A42: ( Following sm ) = [ ( ( TRAN sm ) `1 ),( ( Head sm ) + ( offset ( TRAN sm ) ) ),t3 ] by CKB67:1
.= [ p3,( ( Head sm ) + ( offset ( TRAN sm ) ) ),t3 ] by A31,MCART_1:64
.= sp3 by A32,A8,MCART_1:64;
( Tape-Chg (( sn `3 ),( Head sn ),( ( TRAN sn ) `2 )) ) = ( Tape-Chg (t1,( Head sn ),( ( TRAN sn ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t1,nk,( ( TRAN sn ) `2 )) ) by MCART_1:64
.= t2 by A34,MCART_1:64;
then A43: ( Following sn ) = [ ( ( TRAN sn ) `1 ),( ( Head sn ) + ( offset ( TRAN sn ) ) ),t2 ] by CKB67:1
.= [ 2,( ( Head sn ) + ( offset ( TRAN sn ) ) ),t2 ] by A34,MCART_1:64
.= sm by A35,MCART_1:64;
A44: (for k being (Element of ( NAT )) holds (R[ k ] implies R[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume A45: R[ k ];
now
reconsider ik = ( nk - k ) as (Element of ( INT )) by INT_1:def 2;
set k3 = ( nk - k );
A46: ( h + k ) < ( ( h + k ) + 1 ) by XREAL_1:29;
set sk = [ p3,ik,t3 ];
reconsider tt = ( sk `3 ) as (Tape of ( SuccTuring ));
nk <= ( nk + k ) by INT_1:6;
then A47: ( nk - k ) <= nk by XREAL_1:20;
assume A48: ( h + ( k + 1 ) ) <= nk;
then ( h + k ) < ( nk + ( 0 ) ) by A46,XXREAL_0:2;
then A49: ( h - ( 0 ) ) < ( nk - k ) by XREAL_1:21;
h >= ( 0 ) by NAT_1:2;
then reconsider ii = ( nk - k ) as (Element of ( NAT )) by A49,INT_1:3,XXREAL_0:2;
( ( h + n ) + 2 ) < ( ( ( h + n ) + 2 ) + 1 ) by XREAL_1:29;
then ii < ( ( h + ( n + 1 ) ) + 2 ) by A47,XXREAL_0:2;
then A50: ( t3 . ii ) = 1 by A37,A49;
A51: ( TRAN sk ) = ( ( Succ_Tran ) . [ ( sk `1 ),( tt . ( Head sk ) ) ] ) by CKB64:def 1
.= ( ( Succ_Tran ) . [ p3,( tt . ( Head sk ) ) ] ) by MCART_1:64
.= ( ( Succ_Tran ) . [ p3,( t3 . ( Head sk ) ) ] ) by MCART_1:64
.= [ 3,1,( - 1 ) ] by A50,CKB63:1,MCART_1:64;
then A52: ( offset ( TRAN sk ) ) = ( - 1 ) by MCART_1:64;
A53: ( Tape-Chg (( sk `3 ),( Head sk ),( ( TRAN sk ) `2 )) ) = ( Tape-Chg (t3,( Head sk ),( ( TRAN sk ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t3,k3,( ( TRAN sk ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t3,k3,T) ) by A51,MCART_1:64
.= t3 by A50,CKB52:1;
hereby
thus ( ( Computation sp3 ) . ( k + 1 ) ) = ( Following sk ) by A45,A48,A46,CKB25:def 1,XXREAL_0:2
.= [ ( ( TRAN sk ) `1 ),( ( Head sk ) + ( offset ( TRAN sk ) ) ),t3 ] by A53,CKB67:1
.= [ 3,( ( Head sk ) + ( offset ( TRAN sk ) ) ),t3 ] by A51,MCART_1:64
.= [ 3,( ( nk - k ) + ( - 1 ) ),t3 ] by A52,MCART_1:64
.= [ 3,( nk - ( k + 1 ) ),t3 ];
end;
end;
hence thesis;
end;
A54: R[ ( 0 ) ] by CKB25:def 1;
(for k being (Element of ( NAT )) holds R[ k ]) from NAT_1:sch 1(A54,A44);
then A55: ( ( Computation sp3 ) . j1 ) = [ 3,( nk - j1 ),t3 ] by A33
.= sp5;
A56:now
reconsider tt = ( sp5 `3 ) as (Tape of ( SuccTuring ));
A57: ( TRAN sp5 ) = ( ( Succ_Tran ) . [ ( sp5 `1 ),( tt . ( Head sp5 ) ) ] ) by CKB64:def 1
.= ( ( Succ_Tran ) . [ 3,( tt . ( Head sp5 ) ) ] ) by MCART_1:64
.= ( ( Succ_Tran ) . [ 3,( t3 . ( Head sp5 ) ) ] ) by MCART_1:64
.= [ 4,( 0 ),( 0 ) ] by A37,CKB63:1,MCART_1:64;
then A58: ( offset ( TRAN sp5 ) ) = ( 0 ) by MCART_1:64;
( Tape-Chg (( sp5 `3 ),( Head sp5 ),( ( TRAN sp5 ) `2 )) ) = ( Tape-Chg (t3,( Head sp5 ),( ( TRAN sp5 ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t3,h,( ( TRAN sp5 ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t3,h,F) ) by A57,MCART_1:64
.= t3 by A37,CKB52:1;
hence ( Following sp5 ) = [ ( ( TRAN sp5 ) `1 ),( ( Head sp5 ) + ( offset ( TRAN sp5 ) ) ),t3 ] by CKB67:1
.= [ 4,( ( Head sp5 ) + ( offset ( TRAN sp5 ) ) ),t3 ] by A57,MCART_1:64
.= [ 4,( h + ( 0 ) ),t3 ] by A58,MCART_1:64;
end;
Rs = ( ( Computation ( ( Computation s ) . ( 1 + 1 ) ) ) . ( ( ( n + 1 ) + 1 ) + ( j1 + 1 ) ) ) by CKB30:1
.= ( ( Computation ( Following ( ( Computation s ) . 1 ) ) ) . ( ( ( n + 1 ) + 1 ) + ( j1 + 1 ) ) ) by CKB25:def 1
.= ( ( Computation ( Following s1 ) ) . ( ( ( n + 1 ) + 1 ) + ( j1 + 1 ) ) ) by A18,CKB29:1
.= ( ( Computation ( ( Computation s2 ) . ( ( n + 1 ) + 1 ) ) ) . ( j1 + 1 ) ) by A21,CKB30:1
.= ( ( Computation ( Following ( ( Computation s2 ) . ( n + 1 ) ) ) ) . ( j1 + 1 ) ) by CKB25:def 1;
then Rs = ( ( Computation sp3 ) . ( j1 + 1 ) ) by A22,A43,A42,CKB25:def 1;
then A59: Rs = [ 4,h,t3 ] by A55,A56,CKB25:def 1;
then A60: ( Rs `1 ) = 4 by MCART_1:64
.= (the AcceptS of ( SuccTuring )) by CKB64:def 1;
hence s is  Accept-Halt by CKB33:def 1;
then A61: ( Result s ) = Rs by A60,CKB34:def 1;
hence ( ( Result s ) `2 ) = h by A59,MCART_1:64;
( ( Result s ) `3 ) = t3 by A59,A61,MCART_1:64;
hence thesis by A41,CKB42:1;
end;
