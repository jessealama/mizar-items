environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,FUNCT_1,PARTFUN1,FUNCT_4,RELAT_1,TARSKI,FUNCOP_1,ORDINAL1,XXREAL_0,FINSET_1,CARD_1,FINSEQ_1,NAT_1,CARD_3,ARYTM_3,QMAX_1,FSM_1,ZFMISC_1,ARYTM_1,FUNCT_2,LANG1,INT_1,MCART_1,CIRCUIT2,MSUALG_1,ORDINAL4,VALUED_2,FINSEQ_2,UNIALG_1,PRALG_3,TURING_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,INT_1,FINSET_1,MCART_1,DOMAIN_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCT_4,FUNCOP_1,GR_CY_1,FINSEQ_1,FINSEQ_2,FINSEQ_4,UNIALG_1,COMPUT_1,XXREAL_0,REAL_1,NAT_1,MARGREL1,CKB1,CKB2,CKB3,CKB4,CKB9,CKB10,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB33,CKB34,CKB36,CKB37,CKB39,CKB40,CKB50,CKB59,CKB62,CKB64,CKB70,CKB72;
definitions FINSEQ_1,GR_CY_1,COMPUT_1,FUNCOP_1,MARGREL1,CKB4,CKB17,CKB21,CKB22,CKB23,CKB24,CKB25,CKB33,CKB34,CKB36,CKB37,CKB39,CKB40,CKB50,CKB59,CKB62,CKB64,CKB70,CKB72;
theorems FUNCOP_1,FUNCT_4,ZFMISC_1,TARSKI,FUNCT_2,INT_1,MCART_1,NAT_1,RELSET_1,PARTFUN1,DOMAIN_1,CQC_THE1,ENUMSET1,FINSEQ_2,FINSEQ_1,FINSEQ_3,FUNCT_1,RELAT_1,FINSEQ_6,FINSEQ_7,COMPUT_1,FINSEQ_4,ORDINAL1,XBOOLE_0,XBOOLE_1,NUMBERS,XREAL_1,FUNCT_7,FINSOP_1,XXREAL_0,RVSUM_1,CKB4,CKB6,CKB7,CKB8,CKB11,CKB12,CKB17,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75;
schemes NAT_1,FUNCT_2,BINOP_2;
registrations XBOOLE_0,SUBSET_1,FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,NUMBERS,XREAL_0,INT_1,COMPUT_1,MARGREL1,FINSEQ_1,CKB5,CKB13;
constructors DOMAIN_1,REAL_1,BINOP_2,FINSEQ_4,FINSOP_1,GR_CY_1,COMPUT_1,RECDEF_1,RELSET_1,UNIALG_1,MARGREL1,CKB1,CKB2,CKB4,CKB10,CKB13,CKB17,CKB21,CKB22,CKB23,CKB24,CKB25,CKB33,CKB34,CKB36,CKB37,CKB39,CKB40,CKB50,CKB59,CKB62,CKB64,CKB70,CKB72;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
theorem
Th39: (for s being (All-State of ( ZeroTuring )) holds (for t being (Tape of ( ZeroTuring )) holds (for head being (Element of ( NAT )) holds (for f being (FinSequence of ( NAT )) holds (((( len f ) >= 1 & s = [ ( 0 ),head,t ]) & t storeData ( <* head *> ^ f )) implies ((s is  Accept-Halt & ( ( Result s ) `2 ) = head) & ( ( Result s ) `3 ) storeData <* head,( 0 ) *>))))))
proof
reconsider F = ( 0 ) as (Symbol of ( ZeroTuring )) by CKB74:1;
let s being (All-State of ( ZeroTuring ));
let t being (Tape of ( ZeroTuring ));
let h being (Element of ( NAT ));
let f being (FinSequence of ( NAT ));
assume that
A1: ( len f ) >= 1
and
A2: s = [ ( 0 ),h,t ]
and
A3: t storeData ( <* h *> ^ f );
reconsider s3 = ( s `3 ) as (Tape of ( ZeroTuring ));
reconsider h1 = ( h + 1 ) as (Element of ( INT )) by INT_1:def 2;
set m = ( f /. 1 );
set n = ( ( h + ( f /. 1 ) ) + 2 );
A4: h < h1 by XREAL_1:29;
reconsider p1 = 1 as (State of ( ZeroTuring )) by CKB73:1;
A5: ( h1 + ( - 1 ) ) = h;
set s1 = [ p1,h1,t ];
reconsider i2 = ( h1 + 1 ) as (Element of ( INT )) by INT_1:def 2;
A6: h1 < i2 by XREAL_1:29;
reconsider T = 1 as (Symbol of ( ZeroTuring )) by CKB74:1;
A7: ( i2 + ( - 1 ) ) = h1;
set t1 = ( Tape-Chg (t,h1,T) );
set t2 = ( Tape-Chg (t1,i2,F) );
set t3 = ( Tape-Chg (t2,h1,T) );
A8: t is_1_between h,n by A1,A3,CKB48:1;
then A9: ( t . h ) = ( 0 ) by CKB39:def 1;
then ( t1 . h ) = ( 0 ) by A4,CKB56:1;
then ( t2 . h ) = ( 0 ) by A4,A6,CKB56:1;
then A10: ( t3 . h ) = ( 0 ) by A4,CKB56:1;
A11: ( TRAN s ) = ( ( Zero_Tran ) . [ ( s `1 ),( s3 . ( Head s ) ) ] ) by CKB72:def 1
.= ( ( Zero_Tran ) . [ ( 0 ),( s3 . ( Head s ) ) ] ) by A2,MCART_1:64
.= ( ( Zero_Tran ) . [ ( 0 ),( t . ( Head s ) ) ] ) by A2,MCART_1:64
.= [ 1,( 0 ),1 ] by A2,A9,CKB71:1,MCART_1:64;
then A12: ( offset ( TRAN s ) ) = 1 by MCART_1:64;
set Rs = ( ( Computation s ) . ( ( ( 1 + 1 ) + 1 ) + 1 ) );
reconsider p3 = 3 as (State of ( ZeroTuring )) by CKB73:1;
A13: ( ( h + 1 ) + 1 ) = ( ( h + ( 0 ) ) + 2 );
A14: ( t3 . ( h + 1 ) ) = 1 by CKB56:1;
A15:now
let k being Integer;
assume (h < k & k < ( ( h + ( 0 ) ) + 2 ));
then (( h + 1 ) <= k & k <= ( h + 1 )) by A13,INT_1:7;
hence ( t3 . k ) = 1 by A14,XXREAL_0:1;
end;
( t1 . ( h + 1 ) ) = 1 by CKB56:1;
then A16: ( t2 . ( h + 1 ) ) = 1 by A6,CKB56:1;
set s3 = [ p3,h1,t2 ];
reconsider s33 = ( s3 `3 ) as (Tape of ( ZeroTuring ));
A17: ( TRAN s3 ) = ( ( Zero_Tran ) . [ ( s3 `1 ),( s33 . ( Head s3 ) ) ] ) by CKB72:def 1
.= ( ( Zero_Tran ) . [ p3,( s33 . ( Head s3 ) ) ] ) by MCART_1:64
.= ( ( Zero_Tran ) . [ p3,( t2 . ( Head s3 ) ) ] ) by MCART_1:64
.= [ 4,1,( - 1 ) ] by A16,CKB71:1,MCART_1:64;
then A18: ( offset ( TRAN s3 ) ) = ( - 1 ) by MCART_1:64;
reconsider p2 = 2 as (State of ( ZeroTuring )) by CKB73:1;
reconsider s13 = ( s1 `3 ) as (Tape of ( ZeroTuring ));
h <= ( h + m ) by NAT_1:11;
then A19: ( h + 2 ) <= ( ( h + m ) + 2 ) by XREAL_1:7;
h1 < ( h + 2 ) by XREAL_1:8;
then A20: h1 < n by A19,XXREAL_0:2;
A21: ( TRAN s1 ) = ( ( Zero_Tran ) . [ ( s1 `1 ),( s13 . ( Head s1 ) ) ] ) by CKB72:def 1
.= ( ( Zero_Tran ) . [ p1,( s13 . ( Head s1 ) ) ] ) by MCART_1:64
.= ( ( Zero_Tran ) . [ p1,( t . ( Head s1 ) ) ] ) by MCART_1:64
.= ( ( Zero_Tran ) . [ 1,( t . h1 ) ] ) by MCART_1:64
.= [ 2,1,1 ] by A8,A4,A20,CKB39:def 1,CKB71:1;
then A22: ( offset ( TRAN s1 ) ) = 1 by MCART_1:64;
A23:now
A24: (the Symbols of ( ZeroTuring )) = { ( 0 ),1 } by CKB72:def 1;
per cases  by A24,TARSKI:def 2;
suppose ( t1 . i2 ) = 1;

hence ( ( Zero_Tran ) . [ 2,( t1 . i2 ) ] ) = [ 3,( 0 ),( - 1 ) ] by CKB71:1;
end;
suppose ( t1 . i2 ) = ( 0 );

hence ( ( Zero_Tran ) . [ 2,( t1 . i2 ) ] ) = [ 3,( 0 ),( - 1 ) ] by CKB71:1;
end;
end;
set s2 = [ p2,i2,t1 ];
reconsider s23 = ( s2 `3 ) as (Tape of ( ZeroTuring ));
A25: ( TRAN s2 ) = ( ( Zero_Tran ) . [ ( s2 `1 ),( s23 . ( Head s2 ) ) ] ) by CKB72:def 1
.= ( ( Zero_Tran ) . [ p2,( s23 . ( Head s2 ) ) ] ) by MCART_1:64
.= ( ( Zero_Tran ) . [ p2,( t1 . ( Head s2 ) ) ] ) by MCART_1:64
.= [ 3,( 0 ),( - 1 ) ] by A23,MCART_1:64;
then A26: ( offset ( TRAN s2 ) ) = ( - 1 ) by MCART_1:64;
( Tape-Chg (( s2 `3 ),( Head s2 ),( ( TRAN s2 ) `2 )) ) = ( Tape-Chg (t1,( Head s2 ),( ( TRAN s2 ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t1,i2,( ( TRAN s2 ) `2 )) ) by MCART_1:64
.= t2 by A25,MCART_1:64;
then A27: ( Following s2 ) = [ ( ( TRAN s2 ) `1 ),( ( Head s2 ) + ( offset ( TRAN s2 ) ) ),t2 ] by CKB75:1
.= [ 3,( ( Head s2 ) + ( offset ( TRAN s2 ) ) ),t2 ] by A25,MCART_1:64
.= s3 by A26,A7,MCART_1:64;
reconsider p3 = 3 as (State of ( ZeroTuring )) by CKB73:1;
A28: ( Tape-Chg (( s3 `3 ),( Head s3 ),( ( TRAN s3 ) `2 )) ) = ( Tape-Chg (t2,( Head s3 ),( ( TRAN s3 ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t2,h1,( ( TRAN s3 ) `2 )) ) by MCART_1:64
.= t3 by A17,MCART_1:64;
set s3 = [ p3,h1,t2 ];
A29: ( Following s3 ) = [ ( ( TRAN s3 ) `1 ),( ( Head s3 ) + ( offset ( TRAN s3 ) ) ),t3 ] by A28,CKB75:1
.= [ 4,( ( Head s3 ) + ( offset ( TRAN s3 ) ) ),t3 ] by A17,MCART_1:64
.= [ 4,h,t3 ] by A18,A5,MCART_1:64;
( Tape-Chg (( s `3 ),( Head s ),( ( TRAN s ) `2 )) ) = ( Tape-Chg (t,( Head s ),( ( TRAN s ) `2 )) ) by A2,MCART_1:64
.= ( Tape-Chg (t,h,( ( TRAN s ) `2 )) ) by A2,MCART_1:64
.= ( Tape-Chg (t,h,F) ) by A11,MCART_1:64
.= t by A9,CKB52:1;
then A30: ( Following s ) = [ ( ( TRAN s ) `1 ),( ( Head s ) + ( offset ( TRAN s ) ) ),t ] by A2,CKB75:1
.= [ 1,( ( Head s ) + ( offset ( TRAN s ) ) ),t ] by A11,MCART_1:64
.= s1 by A2,A12,MCART_1:64;
( Tape-Chg (( s1 `3 ),( Head s1 ),( ( TRAN s1 ) `2 )) ) = ( Tape-Chg (t,( Head s1 ),( ( TRAN s1 ) `2 )) ) by MCART_1:64
.= ( Tape-Chg (t,h1,( ( TRAN s1 ) `2 )) ) by MCART_1:64
.= t1 by A21,MCART_1:64;
then A31: ( Following s1 ) = [ ( ( TRAN s1 ) `1 ),( ( Head s1 ) + ( offset ( TRAN s1 ) ) ),t1 ] by CKB75:1
.= [ 2,( ( Head s1 ) + ( offset ( TRAN s1 ) ) ),t1 ] by A21,MCART_1:64
.= s2 by A22,MCART_1:64;
A32: Rs = ( Following ( ( Computation s ) . ( ( 1 + 1 ) + 1 ) ) ) by CKB25:def 1
.= ( Following ( Following ( ( Computation s ) . ( 1 + 1 ) ) ) ) by CKB25:def 1
.= ( Following ( Following ( Following ( ( Computation s ) . 1 ) ) ) ) by CKB25:def 1
.= [ 4,h,t3 ] by A30,A31,A27,A29,CKB29:1;
then A33: ( Rs `1 ) = 4 by MCART_1:64
.= (the AcceptS of ( ZeroTuring )) by CKB72:def 1;
hence s is  Accept-Halt by CKB33:def 1;
then A34: ( Result s ) = Rs by A33,CKB34:def 1;
hence ( ( Result s ) `2 ) = h by A32,MCART_1:64;
A35: ( ( Result s ) `3 ) = t3 by A32,A34,MCART_1:64;
( t2 . i2 ) = ( 0 ) by CKB56:1;
then ( t3 . i2 ) = ( 0 ) by A6,CKB56:1;
then t3 is_1_between h,( ( h + ( 0 ) ) + 2 ) by A10,A15,CKB39:def 1;
hence thesis by A35,CKB42:1;
end;
