environ
vocabularies NUMBERS,NAT_1,XREAL_0,ORDINAL1,SUBSET_1,FINSEQ_2,PRE_TOPC,EUCLID,VALUED_0,FINSEQ_1,FUNCT_1,RELAT_1,XBOOLE_0,TARSKI,FUNCT_2,CARD_1,ARYTM_1,ARYTM_3,REAL_1,PARTFUN1,ZFMISC_1,ORDINAL2,XXREAL_0,RLVECT_1,RLSUB_1,STRUCT_0,SUPINF_2,ALGSTR_0,REALSET1,MONOID_0,FUNCT_7,AFINSQ_1,RFINSEQ2,CLASSES1,RVSUM_1,COMPLEX1,SQUARE_1,REWRITE1,SETFAM_1,CARD_3,ORDINAL4,MATRIXR2,BINOP_2,XCMPLX_0,REAL_NS1,VALUED_1,RLVECT_2,MATRIX_7,FUNCOP_1,FUNCSDOM,RLVECT_3,FINSET_1,RLVECT_5,EUCLID_7;
notations XBOOLE_0,TARSKI,RELAT_1,FUNCT_1,RVSUM_1,RELSET_1,PARTFUN1,CARD_1,FUNCT_2,FUNCT_3,ORDINAL1,CLASSES1,NUMBERS,XREAL_0,SUBSET_1,COMPLEX1,FINSEQ_1,FINSEQ_2,VALUED_0,VALUED_1,SEQ_1,FINSET_1,BINOP_1,STRUCT_0,ALGSTR_0,FUNCSDOM,MONOID_0,PRE_TOPC,BINOP_2,RLVECT_1,EUCLID,SQUARE_1,XXREAL_0,SETFAM_1,RLSUB_1,RLVECT_2,RLVECT_3,REAL_1,NAT_1,NAT_D,MATRIXR2,ZFMISC_1,RLVECT_5,REALSET1,MATRIX_7,RFINSEQ2,FINSEQ_7,RUSUB_3,REAL_NS1,DOMAIN_1,RUSUB_4,FUNCOP_1,CKB8,CKB10,CKB15,CKB21,CKB24,CKB30,CKB36,CKB37,CKB42,CKB46,CKB48,CKB49;
definitions TARSKI,SQUARE_1,FINSEQ_2,RVSUM_1,VALUED_1,RLVECT_1,RLVECT_3,BINOP_1,STRUCT_0,MONOID_0,ALGSTR_0,XBOOLE_0,FUNCSDOM,EUCLID,CKB10,CKB15,CKB21,CKB24,CKB30,CKB36,CKB37,CKB42,CKB46,CKB48,CKB49;
theorems EUCLID,RVSUM_1,FINSEQ_2,FINSEQ_1,RFUNCT_1,FINSEQ_3,SQUARE_1,ABSVALUE,JORDAN2C,XREAL_1,XXREAL_0,FUNCOP_1,XCMPLX_1,SUBSET_1,XBOOLE_0,XBOOLE_1,EUCLID_2,TARSKI,EUCLID_4,ORDINAL1,CARD_1,SETFAM_1,REAL_NS1,RLVECT_2,RLVECT_3,PARTFUN1,FUNCT_1,RLVECT_1,NAT_1,RLSUB_1,STRUCT_0,RELAT_1,REALSET1,FUNCT_2,MATRIXR2,BINOP_2,FINSOP_1,ZFMISC_1,FUNCT_3,FINSEQ_4,MATRPROB,MATRIX_7,RFINSEQ2,INTEGRA2,FINSEQ_7,INT_5,EUCLIDLP,RLVECT_5,RUSUB_1,RUSUB_3,RUSUB_4,RLVECT_4,VALUED_0,XREAL_0,VALUED_1,CLASSES1,RELSET_1,FUNCSDOM,EULER_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB23,CKB24,CKB28,CKB29,CKB30,CKB36,CKB37,CKB40,CKB41,CKB42,CKB44,CKB46,CKB48,CKB49;
schemes NAT_1,CLASSES1,FUNCT_2,FINSEQ_1;
registrations REALSET1,FUNCT_1,MONOID_0,RELSET_1,NUMBERS,XREAL_0,STRUCT_0,FINSET_1,XXREAL_0,CARD_1,NAT_1,MEMBERED,FINSEQ_2,EUCLID,VALUED_0,FUNCT_2,SUBSET_1,XBOOLE_0,REAL_NS1,FINSEQ_1,RELAT_1,ZFMISC_1,CKB7,CKB22,CKB25,CKB26,CKB27,CKB31,CKB32,CKB33,CKB34,CKB35,CKB38,CKB39,CKB43,CKB45,CKB47;
constructors REAL_1,SQUARE_1,BINOP_2,MONOID_0,SEQ_1,SETFAM_1,RLVECT_2,RLVECT_3,REAL_NS1,FUNCT_3,REALSET1,MATRIXR2,RLVECT_5,FINSOP_1,MATRIX_7,RFINSEQ2,SETWISEO,FINSEQ_7,RUSUB_3,RUSUB_4,NAT_D,CLASSES1,FUNCSDOM,RELSET_1,CKB8,CKB15,CKB21,CKB24,CKB30,CKB36,CKB37,CKB42,CKB46,CKB48,CKB49;
requirements REAL,SUBSET,NUMERALS,ARITHM,BOOLE;
begin
reserve i for Nat;
reserve n for Nat;
theorem
Th23: (for F,F2 being (FinSequence of ( REAL n )) holds (for h being (Permutation of ( dom F )) holds (F2 = ( F (*) h ) implies ( Sum F2 ) = ( Sum F ))))
proof
let F being (FinSequence of ( REAL n ));
let F2 being (FinSequence of ( REAL n ));
let h being (Permutation of ( dom F ));
assume A1: F2 = ( F (*) h );
per cases ;
suppose A2: ( len F ) > ( 0 );

then A3: ( ( 0 ) + 1 ) <= ( len F ) by NAT_1:13;
then A4: 1 in ( Seg ( len F ) ) by FINSEQ_1:1;
then A5: 1 in ( dom F ) by FINSEQ_1:def 3;
then A6: ( dom h ) = ( dom F ) by FUNCT_2:def 1;
then ( rng h ) = ( dom h ) by FUNCT_2:def 3;
then A7: ( dom F2 ) = ( dom h ) by A1,RELAT_1:27;
then A8: ( Seg ( len F2 ) ) = ( dom F ) by A6,FINSEQ_1:def 3;
set gF = ( accum F );
A9: ( len F ) = ( len gF ) by CKB48:def 1;
A10: (for i being Nat holds ((1 <= i & i < ( len F )) implies ( gF . ( i + 1 ) ) = ( ( gF /. i ) + ( F /. ( i + 1 ) ) ))) by CKB48:def 1;
defpred P[ Nat ]
 means
(for h2 being (Permutation of ( dom F )) holds (($1 < ( len F ) & (for i being Nat holds ((( $1 + 1 ) < i & i <= ( len F )) implies ( h2 . i ) = i))) implies ( gF . ( $1 + 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( $1 + 1 ) )));
A11: ( dom F ) = ( Seg ( len F ) ) by FINSEQ_1:def 3;
1 in ( Seg ( len F2 ) ) by A5,A6,A7,FINSEQ_1:def 3;
then A12: 1 <= ( len F2 ) by FINSEQ_1:1;
A13: ( ( len F ) -' 1 ) = ( ( len F ) - 1 ) by A3,XREAL_1:233;
then A14: (for i being Nat holds ((( ( ( len F ) -' 1 ) + 1 ) < i & i <= ( len F )) implies ( h . i ) = i));
A15: ( dom F ) <> ( {} ) by A4,FINSEQ_1:def 3;
A16: (for k being Nat holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being Nat;
assume A17: P[ k ];
(for h2 being (Permutation of ( dom F )) holds ((( k + 1 ) < ( len F ) & (for i being Nat holds ((( ( k + 1 ) + 1 ) < i & i <= ( len F )) implies ( h2 . i ) = i))) implies ( gF . ( ( k + 1 ) + 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( ( k + 1 ) + 1 ) )))
proof
A18: 1 <= ( k + 1 ) by NAT_1:11;
A19: ( k + 1 ) < ( ( k + 1 ) + 1 ) by XREAL_1:29;
let h2 being (Permutation of ( dom F ));
assume that
A20: ( k + 1 ) < ( len F )
and
A21: (for i being Nat holds ((( ( k + 1 ) + 1 ) < i & i <= ( len F )) implies ( h2 . i ) = i));
A22: ( ( k + 1 ) + 1 ) <= ( len F ) by A20,NAT_1:13;
k < ( k + 1 ) by XREAL_1:29;
then A23: k < ( len F ) by A20,XXREAL_0:2;
A24: 1 < ( ( k + 1 ) + 1 ) by XREAL_1:29;
then A25: ( ( k + 1 ) + 1 ) in ( Seg ( len F ) ) by A22,FINSEQ_1:1;
then A26: ( ( k + 1 ) + 1 ) in ( dom F ) by FINSEQ_1:def 3;
A27: ( dom h2 ) = ( dom F ) by A5,FUNCT_2:def 1;
then A28: ( rng h2 ) = ( dom h2 ) by FUNCT_2:def 3;
then A29: ( dom ( F (*) h2 ) ) = ( dom h2 ) by RELAT_1:27
.= ( dom F ) by A5,FUNCT_2:def 1;
then A30: ( Seg ( len ( F (*) h2 ) ) ) = ( dom F ) by FINSEQ_1:def 3;
then A31: ( Seg ( len ( F (*) h2 ) ) ) = ( Seg ( len F ) ) by FINSEQ_1:def 3;
A32: ( len ( F (*) h2 ) ) = ( len F ) by A30,FINSEQ_1:def 3;
h2 is FinSequence by A11,A27,FINSEQ_1:def 2;
then reconsider h2r = h2 as (FinSequence of ( NAT )) by A27,A28,FINSEQ_1:def 4;
( dom h2 ) = ( Seg ( len F ) ) by A2,A11,FUNCT_2:def 1;
then A33: ( len h2r ) = ( len F ) by FINSEQ_1:def 3;
consider x being set such that A34: x in ( dom h2 ) and A35: ( ( k + 1 ) + 1 ) = ( h2 . x ) by A11,A27,A28,A25,FUNCT_1:def 3;
reconsider nx = x as (Element of ( NAT )) by A27,A34;
A36: nx <= ( len F ) by A11,A34,FINSEQ_1:1;
reconsider h2b = ( Swap (h2r,nx,( ( k + 1 ) + 1 )) ) as (FinSequence of ( NAT ));
A37: ( rng h2b ) = ( rng h2 ) by FINSEQ_7:22
.= ( dom F ) by FUNCT_2:def 3;
A38: ( len h2b ) = ( len h2r ) by FINSEQ_7:18;
then ( dom h2b ) = ( Seg ( len h2r ) ) by FINSEQ_1:def 3;
then A39: ( dom h2b ) = ( dom h2 ) by FINSEQ_1:def 3
.= ( dom F ) by A15,FUNCT_2:def 1;
then reconsider h2d = h2b as (Function of ( dom F ),( dom F )) by A37,FUNCT_2:1;
A40: h2d is  one-to-one by INT_5:39;
h2d is  onto by A37,FUNCT_2:def 3;
then reconsider h4 = h2d as (Permutation of ( dom F )) by A40;
A41: 1 <= nx by A11,A34,FINSEQ_1:1;
then A42: ( h4 . nx ) = ( h2r . ( ( k + 1 ) + 1 ) ) by A22,A24,A36,A33,CKB16:1;
A43: ( dom h4 ) = ( dom F ) by A5,FUNCT_2:def 1;
( rng h4 ) c= ( dom F );
then A44: ( dom ( F (*) h4 ) ) = ( dom h4 ) by RELAT_1:27
.= ( dom F ) by A5,FUNCT_2:def 1;
then ( Seg ( len ( F (*) h4 ) ) ) = ( dom F ) by FINSEQ_1:def 3;
then A45: ( len ( F (*) h4 ) ) = ( len F ) by FINSEQ_1:def 3;
per cases ;
suppose A46: nx <= ( k + 1 );

A47: ( ( k + 1 ) + 1 ) <= ( len h2r ) by A20,A33,NAT_1:13;
A48: nx <= ( len h2r ) by A11,A34,A33,FINSEQ_1:1;
A49: ( F . ( ( k + 1 ) + 1 ) ) = ( ( F (*) h2 ) . nx ) by A34,A35,FUNCT_1:13;
A50: ( len ( accum ( F (*) h4 ) ) ) = ( len ( F (*) h4 ) ) by CKB48:def 1;
A51: 1 <= nx by A11,A34,FINSEQ_1:1;
A52: 1 <= ( ( k + 1 ) + 1 ) by NAT_1:11;
then A53: ( h2b . ( ( k + 1 ) + 1 ) ) = ( ( k + 1 ) + 1 ) by A35,A51,A48,A47,CKB16:1;
A54: (for i being Nat holds ((( k + 1 ) < i & i <= ( len F )) implies ( h4 . i ) = i))
proof
let i being Nat;
assume that
A55: ( k + 1 ) < i
and
A56: i <= ( len F );
A57: ( ( k + 1 ) + 1 ) <= i by A55,NAT_1:13;
per cases ;
suppose A58: ( ( k + 1 ) + 1 ) < i;

1 <= ( k + 1 ) by NAT_1:11;
then A59: 1 < i by A55,XXREAL_0:2;
then ( h4 . i ) = ( h2b /. i ) by A33,A38,A56,FINSEQ_4:15
.= ( h2r /. i ) by A33,A46,A55,A56,A58,A59,FINSEQ_7:30
.= ( h2 . i ) by A33,A56,A59,FINSEQ_4:15
.= i by A21,A56,A58;
hence ( h4 . i ) = i;
end;
suppose ( ( k + 1 ) + 1 ) >= i;

then i = ( ( k + 1 ) + 1 ) by A57,XXREAL_0:1;
hence ( h4 . i ) = i by A35,A51,A48,A52,A47,CKB16:1;
end;
end;
A60: ( F /. ( ( k + 1 ) + 1 ) ) = ( F . ( ( k + 1 ) + 1 ) ) by A22,A24,FINSEQ_4:15;
A61: 1 <= ( k + 1 ) by NAT_1:11;
A62: ( len ( accum ( F (*) h2 ) ) ) = ( len ( F (*) h2 ) ) by CKB48:def 1;
A63: nx < ( ( k + 1 ) + 1 ) by A19,A46,XXREAL_0:2;
A64: (for i4 being Nat holds ((1 <= i4 & i4 < nx) implies ( ( accum ( F (*) h2 ) ) . i4 ) = ( ( accum ( F (*) h4 ) ) . i4 )))
proof
defpred T[ Nat ]
 means
(( 1 + $1 ) < nx implies ( ( accum ( F (*) h2 ) ) . ( 1 + $1 ) ) = ( ( accum ( F (*) h4 ) ) . ( 1 + $1 ) ));
let i4 being Nat;
assume that
A65: 1 <= i4
and
A66: i4 < nx;
A67: ( 1 + ( i4 -' 1 ) ) = ( ( i4 - 1 ) + 1 ) by A65,XREAL_1:233
.= i4;
A68: (for k3 being Nat holds (T[ k3 ] implies T[ ( k3 + 1 ) ]))
proof
let k3 being Nat;
A69: 1 <= ( k3 + 1 ) by NAT_1:11;
assume A70: T[ k3 ];
(( 1 + ( k3 + 1 ) ) < nx implies ( ( accum ( F (*) h2 ) ) . ( 1 + ( k3 + 1 ) ) ) = ( ( accum ( F (*) h4 ) ) . ( 1 + ( k3 + 1 ) ) ))
proof
assume A71: ( 1 + ( k3 + 1 ) ) < nx;
then A72: ( 1 + ( k3 + 1 ) ) < ( len F ) by A36,XXREAL_0:2;
then A73: ( h2r /. ( ( k3 + 1 ) + 1 ) ) = ( h2r . ( ( k3 + 1 ) + 1 ) ) by A33,FINSEQ_4:15,NAT_1:11;
A74: ( ( k3 + 1 ) + 1 ) < ( ( k + 1 ) + 1 ) by A63,A71,XXREAL_0:2;
A75: ( h2b /. ( ( k3 + 1 ) + 1 ) ) = ( h2b . ( ( k3 + 1 ) + 1 ) ) by A33,A38,A72,FINSEQ_4:15,NAT_1:11;
1 <= ( 1 + ( k3 + 1 ) ) by NAT_1:11;
then ( ( k3 + 1 ) + 1 ) in ( Seg ( len F ) ) by A72,FINSEQ_1:1;
then A76: ( ( k3 + 1 ) + 1 ) in ( dom ( F (*) h2 ) ) by A29,FINSEQ_1:def 3;
then A77: ( ( F (*) h2 ) . ( ( k3 + 1 ) + 1 ) ) = ( F . ( h2 . ( ( k3 + 1 ) + 1 ) ) ) by FUNCT_1:12
.= ( F . ( h4 . ( ( k3 + 1 ) + 1 ) ) ) by A33,A71,A72,A74,A73,A75,FINSEQ_7:30,NAT_1:11
.= ( ( F (*) h4 ) . ( ( k3 + 1 ) + 1 ) ) by A44,A29,A76,FUNCT_1:12;
A78: ( ( F (*) h4 ) /. ( ( k3 + 1 ) + 1 ) ) = ( ( F (*) h4 ) . ( ( k3 + 1 ) + 1 ) ) by A45,A72,FINSEQ_4:15,NAT_1:11;
A79: ( k3 + 1 ) < ( 1 + ( k3 + 1 ) ) by XREAL_1:29;
then A80: ( k3 + 1 ) < nx by A71,XXREAL_0:2;
then A81: ( k3 + 1 ) < ( len F ) by A36,XXREAL_0:2;
( k3 + 1 ) < ( len ( F (*) h2 ) ) by A36,A32,A80,XXREAL_0:2;
then A82: ( ( accum ( F (*) h4 ) ) /. ( 1 + k3 ) ) = ( ( accum ( F (*) h4 ) ) . ( 1 + k3 ) ) by A45,A32,A50,FINSEQ_4:15,NAT_1:11;
( ( accum ( F (*) h2 ) ) /. ( 1 + k3 ) ) = ( ( accum ( F (*) h2 ) ) . ( 1 + k3 ) ) by A32,A62,A81,FINSEQ_4:15,NAT_1:11;
then ( ( accum ( F (*) h2 ) ) . ( 1 + ( k3 + 1 ) ) ) = ( ( ( accum ( F (*) h4 ) ) /. ( k3 + 1 ) ) + ( ( F (*) h2 ) /. ( ( k3 + 1 ) + 1 ) ) ) by A32,A70,A69,A71,A79,A81,A82,CKB48:def 1,XXREAL_0:2
.= ( ( ( accum ( F (*) h4 ) ) /. ( k3 + 1 ) ) + ( ( F (*) h4 ) /. ( ( k3 + 1 ) + 1 ) ) ) by A32,A72,A77,A78,FINSEQ_4:15,NAT_1:11;
hence ( ( accum ( F (*) h2 ) ) . ( 1 + ( k3 + 1 ) ) ) = ( ( accum ( F (*) h4 ) ) . ( 1 + ( k3 + 1 ) ) ) by A45,A69,A81,CKB48:def 1;
end;
hence T[ ( k3 + 1 ) ];
end;
( 0 ) < ( k + 1 );
then A83: 1 <> ( ( k + 1 ) + 1 );
A84: ( h2b /. 1 ) = ( h2b . 1 ) by A3,A33,A38,FINSEQ_4:15;
A85: ( h2r /. 1 ) = ( h2r . 1 ) by A3,A33,FINSEQ_4:15;
( ( F (*) h2 ) . 1 ) = ( F . ( h2 . 1 ) ) by A5,A29,FUNCT_1:12
.= ( F . ( h4 . 1 ) ) by A3,A33,A65,A66,A83,A85,A84,FINSEQ_7:30
.= ( ( F (*) h4 ) . 1 ) by A5,A44,FUNCT_1:12;
then ( ( accum ( F (*) h2 ) ) . ( 1 + ( 0 ) ) ) = ( ( F (*) h4 ) . 1 ) by CKB48:def 1
.= ( ( accum ( F (*) h4 ) ) . ( 1 + ( 0 ) ) ) by CKB48:def 1;
then A86: T[ ( 0 ) ];
(for k3 being Nat holds T[ k3 ]) from NAT_1:sch 2(A86,A68);
hence ( ( accum ( F (*) h2 ) ) . i4 ) = ( ( accum ( F (*) h4 ) ) . i4 ) by A66,A67;
end;
A87: (for i being Nat holds ((nx <= i & i < ( ( k + 1 ) + 1 )) implies ( ( accum ( F (*) h2 ) ) . i ) = ( ( ( ( accum ( F (*) h4 ) ) /. i ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) )))
proof
defpred S[ Nat ]
 means
((nx <= ( nx + $1 ) & ( nx + $1 ) < ( ( k + 1 ) + 1 )) implies ( ( accum ( F (*) h2 ) ) . ( nx + $1 ) ) = ( ( ( ( accum ( F (*) h4 ) ) /. ( nx + $1 ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ));
let i being Nat;
assume that
A88: nx <= i
and
A89: i < ( ( k + 1 ) + 1 );
A90: ( len ( accum ( F (*) h4 ) ) ) = ( len ( F (*) h4 ) ) by CKB48:def 1;
A91: ( len ( accum ( F (*) h2 ) ) ) = ( len ( F (*) h2 ) ) by CKB48:def 1;
A92: (for k3 being Nat holds (S[ k3 ] implies S[ ( k3 + 1 ) ]))
proof
let k3 being Nat;
assume A93: S[ k3 ];
((nx <= ( nx + ( k3 + 1 ) ) & ( nx + ( k3 + 1 ) ) < ( ( k + 1 ) + 1 )) implies ( ( accum ( F (*) h2 ) ) . ( nx + ( k3 + 1 ) ) ) = ( ( ( ( accum ( F (*) h4 ) ) /. ( nx + ( k3 + 1 ) ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ))
proof
reconsider f3 = ( ( F (*) h2 ) /. ( ( nx + k3 ) + 1 ) ) as (Element of ( REAL n ));
A94: nx <= ( nx + k3 ) by NAT_1:11;
reconsider f2 = ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) as (Element of ( REAL n ));
A95: ( nx + k3 ) < ( ( nx + k3 ) + 1 ) by XREAL_1:29;
reconsider f4 = ( ( F (*) h2 ) /. nx ) as (Element of ( REAL n ));
reconsider f1 = ( ( accum ( F (*) h4 ) ) /. ( nx + k3 ) ) as (Element of ( REAL n ));
assume that
nx <= ( nx + ( k3 + 1 ) )
and
A96: ( nx + ( k3 + 1 ) ) < ( ( k + 1 ) + 1 );
A97: ( nx + ( k3 + 1 ) ) < ( len ( accum ( F (*) h4 ) ) ) by A22,A45,A90,A96,XXREAL_0:2;
A98: ( nx + k3 ) < ( ( nx + k3 ) + 1 ) by XREAL_1:29;
then ( nx + k3 ) < ( ( k + 1 ) + 1 ) by A96,XXREAL_0:2;
then A99: ( nx + k3 ) < ( len ( F (*) h2 ) ) by A33,A32,A47,XXREAL_0:2;
then A100: ( ( nx + k3 ) + 1 ) <= ( len ( F (*) h2 ) ) by NAT_1:13;
( nx + k3 ) >= ( ( 0 ) + 1 ) by A41,NAT_1:13;
then A101: 1 < ( nx + ( k3 + 1 ) ) by A98,XXREAL_0:2;
then A102: ( ( F (*) h4 ) /. ( ( nx + k3 ) + 1 ) ) = ( ( F (*) h4 ) . ( ( nx + k3 ) + 1 ) ) by A45,A32,A100,FINSEQ_4:15;
( ( nx + k3 ) + 1 ) in ( Seg ( len ( F (*) h2 ) ) ) by A101,A100,FINSEQ_1:1;
then A103: ( ( nx + k3 ) + 1 ) in ( dom ( F (*) h2 ) ) by FINSEQ_1:def 3;
then A104: ( ( F (*) h4 ) . ( ( nx + k3 ) + 1 ) ) = ( F . ( h4 . ( ( nx + k3 ) + 1 ) ) ) by A44,A29,FUNCT_1:12
.= ( F . ( h2b /. ( ( nx + k3 ) + 1 ) ) ) by A33,A38,A32,A101,A100,FINSEQ_4:15
.= ( F . ( h2r /. ( ( nx + k3 ) + 1 ) ) ) by A33,A32,A96,A101,A100,A95,A94,FINSEQ_7:30
.= ( F . ( h2r . ( ( nx + k3 ) + 1 ) ) ) by A33,A32,A101,A100,FINSEQ_4:15
.= ( ( F (*) h2 ) . ( ( nx + k3 ) + 1 ) ) by A103,FUNCT_1:12;
nx <= ( nx + k3 ) by NAT_1:11;
then A105: 1 <= ( nx + k3 ) by A51,XXREAL_0:2;
then ( ( accum ( F (*) h4 ) ) . ( nx + ( k3 + 1 ) ) ) = ( ( ( accum ( F (*) h4 ) ) /. ( nx + k3 ) ) + ( ( F (*) h4 ) /. ( ( nx + k3 ) + 1 ) ) ) by A45,A32,A99,CKB48:def 1
.= ( ( ( accum ( F (*) h4 ) ) /. ( nx + k3 ) ) + ( ( F (*) h2 ) /. ( ( nx + k3 ) + 1 ) ) ) by A101,A100,A104,A102,FINSEQ_4:15;
then A106: ( ( ( ( accum ( F (*) h4 ) ) /. ( nx + ( k3 + 1 ) ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) = ( ( ( f1 + f3 ) - f2 ) + f4 ) by A101,A97,FINSEQ_4:15
.= ( ( ( f1 - f2 ) + f3 ) + f4 ) by RFUNCT_1:8
.= ( ( ( f1 - f2 ) + f4 ) + f3 ) by RFUNCT_1:8;
( ( accum ( F (*) h2 ) ) . ( nx + ( k3 + 1 ) ) ) = ( ( ( accum ( F (*) h2 ) ) /. ( nx + k3 ) ) + ( ( F (*) h2 ) /. ( ( nx + k3 ) + 1 ) ) ) by A105,A99,CKB48:def 1
.= ( ( ( ( ( accum ( F (*) h4 ) ) /. ( nx + k3 ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) + ( ( F (*) h2 ) /. ( ( nx + k3 ) + 1 ) ) ) by A91,A93,A96,A98,A105,A99,FINSEQ_4:15,NAT_1:11,XXREAL_0:2;
hence ( ( accum ( F (*) h2 ) ) . ( nx + ( k3 + 1 ) ) ) = ( ( ( ( accum ( F (*) h4 ) ) /. ( nx + ( k3 + 1 ) ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) by A106;
end;
hence S[ ( k3 + 1 ) ];
end;
now
per cases  by A41,XXREAL_0:1;
case A107: 1 = nx;
A108: n in ( NAT ) by ORDINAL1:def 12;
( ( accum ( F (*) h4 ) ) /. ( nx + ( 0 ) ) ) = ( ( accum ( F (*) h4 ) ) . 1 ) by A3,A45,A90,A107,FINSEQ_4:15
.= ( ( F (*) h4 ) . 1 ) by CKB48:def 1
.= ( F . ( h2 . ( ( k + 1 ) + 1 ) ) ) by A5,A43,A42,A107,FUNCT_1:13
.= ( ( F (*) h2 ) . ( ( k + 1 ) + 1 ) ) by A27,A26,FUNCT_1:13
.= ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) by A22,A24,A32,FINSEQ_4:15;
then A109: ( ( ( ( accum ( F (*) h4 ) ) /. ( nx + ( 0 ) ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) = ( ( 0* n ) + ( ( F (*) h2 ) /. nx ) ) by A108,EUCLIDLP:2
.= ( ( F (*) h2 ) /. nx ) by EUCLID_4:1;
( ( accum ( F (*) h2 ) ) . ( nx + ( 0 ) ) ) = ( ( F (*) h2 ) . 1 ) by A107,CKB48:def 1
.= ( ( F (*) h2 ) /. nx ) by A36,A32,A107,FINSEQ_4:15;
hence ( ( accum ( F (*) h2 ) ) . ( nx + ( 0 ) ) ) = ( ( ( ( accum ( F (*) h4 ) ) /. ( nx + ( 0 ) ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) by A109;
end;
case A110: 1 < nx;
A111: ( ( F (*) h4 ) /. nx ) = ( ( F (*) h4 ) . nx ) by A41,A36,A45,FINSEQ_4:15
.= ( F . ( h2 . ( ( k + 1 ) + 1 ) ) ) by A34,A43,A42,FUNCT_1:13
.= ( ( F (*) h2 ) . ( ( k + 1 ) + 1 ) ) by A27,A26,FUNCT_1:13
.= ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) by A22,A24,A32,FINSEQ_4:15;
A112: ( nx -' 1 ) = ( nx - 1 ) by A110,XREAL_1:233;
then ( nx -' 1 ) > ( 0 ) by A110,XREAL_1:50;
then A113: ( nx -' 1 ) >= ( ( 0 ) + 1 ) by NAT_1:13;
nx < ( nx + 1 ) by XREAL_1:29;
then A114: ( nx - 1 ) < ( ( nx + 1 ) - 1 ) by XREAL_1:9;
then A115: ( nx -' 1 ) < ( len ( F (*) h2 ) ) by A33,A32,A48,A112,XXREAL_0:2;
then A116: ( ( accum ( F (*) h2 ) ) /. ( nx -' 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( nx -' 1 ) ) by A91,A113,FINSEQ_4:15;
( ( accum ( F (*) h4 ) ) . ( nx + ( 0 ) ) ) = ( ( ( accum ( F (*) h4 ) ) /. ( nx -' 1 ) ) + ( ( F (*) h4 ) /. ( ( nx -' 1 ) + 1 ) ) ) by A45,A32,A112,A113,A115,CKB48:def 1
.= ( ( ( accum ( F (*) h4 ) ) /. ( nx -' 1 ) ) + ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) by A112,A111;
then A117: ( ( ( accum ( F (*) h4 ) ) /. ( nx + ( 0 ) ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) = ( ( ( ( accum ( F (*) h4 ) ) /. ( nx -' 1 ) ) + ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) by A33,A45,A51,A48,A90,FINSEQ_4:15
.= ( ( accum ( F (*) h4 ) ) /. ( nx -' 1 ) ) by RVSUM_1:42;
A118: ( ( accum ( F (*) h4 ) ) /. ( nx -' 1 ) ) = ( ( accum ( F (*) h4 ) ) . ( nx -' 1 ) ) by A45,A32,A90,A113,A115,FINSEQ_4:15;
( ( accum ( F (*) h2 ) ) . ( nx + ( 0 ) ) ) = ( ( ( accum ( F (*) h2 ) ) /. ( nx -' 1 ) ) + ( ( F (*) h2 ) /. ( ( nx -' 1 ) + 1 ) ) ) by A112,A113,A115,CKB48:def 1
.= ( ( ( accum ( F (*) h4 ) ) /. ( nx -' 1 ) ) + ( ( F (*) h2 ) /. nx ) ) by A64,A112,A113,A114,A116,A118;
hence ( ( accum ( F (*) h2 ) ) . ( nx + ( 0 ) ) ) = ( ( ( ( accum ( F (*) h4 ) ) /. ( nx + ( 0 ) ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) by A117;
end;
end;
then A119: S[ ( 0 ) ];
A120: (for k3 being Nat holds S[ k3 ]) from NAT_1:sch 2(A119,A92);
A121: ( i -' nx ) = ( i - nx ) by A88,XREAL_1:233;
then nx <= ( nx + ( i -' nx ) ) by A88;
hence ( ( accum ( F (*) h2 ) ) . i ) = ( ( ( ( accum ( F (*) h4 ) ) /. i ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) by A89,A120,A121;
end;
A122: ( ( F (*) h2 ) /. nx ) = ( ( F (*) h2 ) . nx ) by A41,A36,A32,FINSEQ_4:15;
A123: ( ( k + 1 ) + 1 ) in ( dom h4 ) by A25,A39,FINSEQ_1:def 3;
A124: ( ( F (*) h4 ) /. ( ( k + 1 ) + 1 ) ) = ( ( F (*) h4 ) . ( ( k + 1 ) + 1 ) ) by A22,A24,A45,FINSEQ_4:15;
A125: (for i being Nat holds ((( ( k + 1 ) + 1 ) <= i & i <= ( len F )) implies ( ( accum ( F (*) h2 ) ) . i ) = ( ( accum ( F (*) h4 ) ) . i )))
proof
defpred Y[ Nat ]
 means
(( ( ( k + 1 ) + 1 ) + $1 ) <= ( len F ) implies ( ( accum ( F (*) h2 ) ) . ( ( ( k + 1 ) + 1 ) + $1 ) ) = ( ( accum ( F (*) h4 ) ) . ( ( ( k + 1 ) + 1 ) + $1 ) ));
let i being Nat;
assume that
A126: ( ( k + 1 ) + 1 ) <= i
and
A127: i <= ( len F );
A128: (for k3 being Nat holds (Y[ k3 ] implies Y[ ( k3 + 1 ) ]))
proof
let k3 being Nat;
assume A129: Y[ k3 ];
(( ( ( k + 1 ) + 1 ) + ( k3 + 1 ) ) <= ( len F ) implies ( ( accum ( F (*) h2 ) ) . ( ( ( k + 1 ) + 1 ) + ( k3 + 1 ) ) ) = ( ( accum ( F (*) h4 ) ) . ( ( ( k + 1 ) + 1 ) + ( k3 + 1 ) ) ))
proof
A130: ( ( k + 1 ) + 1 ) <= ( ( ( k + 1 ) + 1 ) + k3 ) by NAT_1:11;
A131: ( ( ( k + 1 ) + 1 ) + k3 ) < ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) by XREAL_1:29;
then A132: ( ( k + 1 ) + 1 ) < ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) by A130,XXREAL_0:2;
assume A133: ( ( ( k + 1 ) + 1 ) + ( k3 + 1 ) ) <= ( len F );
then A134: ( ( F (*) h4 ) /. ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) = ( ( F (*) h4 ) . ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) by A45,FINSEQ_4:15,NAT_1:11;
1 <= ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) by NAT_1:11;
then ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) in ( Seg ( len ( F (*) h2 ) ) ) by A31,A133,FINSEQ_1:1;
then A135: ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) in ( dom ( F (*) h2 ) ) by FINSEQ_1:def 3;
then A136: ( ( F (*) h4 ) . ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) = ( F . ( h4 . ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) ) by A44,A29,FUNCT_1:12
.= ( F . ( h2b /. ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) ) by A33,A38,A133,FINSEQ_4:15,NAT_1:11
.= ( F . ( h2r /. ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) ) by A33,A63,A133,A132,FINSEQ_7:30,NAT_1:11
.= ( F . ( h2r . ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) ) by A33,A133,FINSEQ_4:15,NAT_1:11
.= ( ( F (*) h2 ) . ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) by A135,FUNCT_1:12;
1 <= ( ( k + 1 ) + 1 ) by NAT_1:11;
then A137: 1 <= ( ( ( k + 1 ) + 1 ) + k3 ) by A130,XXREAL_0:2;
A138: ( ( ( k + 1 ) + 1 ) + k3 ) < ( len F ) by A133,A131,XXREAL_0:2;
then A139: ( ( accum ( F (*) h4 ) ) /. ( ( ( k + 1 ) + 1 ) + k3 ) ) = ( ( accum ( F (*) h4 ) ) . ( ( ( k + 1 ) + 1 ) + k3 ) ) by A45,A50,A137,FINSEQ_4:15;
( ( accum ( F (*) h2 ) ) . ( ( ( k + 1 ) + 1 ) + ( k3 + 1 ) ) ) = ( ( ( accum ( F (*) h2 ) ) /. ( ( ( k + 1 ) + 1 ) + k3 ) ) + ( ( F (*) h2 ) /. ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) ) by A32,A138,A137,CKB48:def 1
.= ( ( ( accum ( F (*) h4 ) ) /. ( ( ( k + 1 ) + 1 ) + k3 ) ) + ( ( F (*) h2 ) /. ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) ) by A32,A62,A129,A138,A137,A139,FINSEQ_4:15
.= ( ( ( accum ( F (*) h4 ) ) /. ( ( ( k + 1 ) + 1 ) + k3 ) ) + ( ( F (*) h4 ) /. ( ( ( ( k + 1 ) + 1 ) + k3 ) + 1 ) ) ) by A32,A133,A136,A134,FINSEQ_4:15,NAT_1:11;
hence ( ( accum ( F (*) h2 ) ) . ( ( ( k + 1 ) + 1 ) + ( k3 + 1 ) ) ) = ( ( accum ( F (*) h4 ) ) . ( ( ( k + 1 ) + 1 ) + ( k3 + 1 ) ) ) by A45,A138,A137,CKB48:def 1;
end;
hence Y[ ( k3 + 1 ) ];
end;
A140: ( len ( accum ( F (*) h2 ) ) ) = ( len ( F (*) h2 ) ) by CKB48:def 1;
A141: ( ( accum ( F (*) h2 ) ) . ( k + 1 ) ) = ( ( ( ( accum ( F (*) h4 ) ) /. ( k + 1 ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) by A19,A46,A87;
A142: 1 <= ( k + 1 ) by NAT_1:11;
( k + 1 ) < ( len ( F (*) h2 ) ) by A20,A30,FINSEQ_1:def 3;
then ( ( accum ( F (*) h2 ) ) . ( ( k + 1 ) + 1 ) ) = ( ( ( accum ( F (*) h2 ) ) /. ( k + 1 ) ) + ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) by A142,CKB48:def 1
.= ( ( ( ( ( accum ( F (*) h4 ) ) /. ( k + 1 ) ) - ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) + ( ( F (*) h2 ) /. nx ) ) + ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) by A20,A32,A140,A141,FINSEQ_4:15,NAT_1:11
.= ( ( ( accum ( F (*) h4 ) ) /. ( k + 1 ) ) + ( ( F (*) h2 ) /. nx ) ) by CKB6:1
.= ( ( ( accum ( F (*) h4 ) ) /. ( k + 1 ) ) + ( ( F (*) h4 ) /. ( ( k + 1 ) + 1 ) ) ) by A123,A53,A49,A124,A122,FUNCT_1:13;
then A143: Y[ ( 0 ) ] by A20,A18,A45,CKB48:def 1;
A144: (for k3 being Nat holds Y[ k3 ]) from NAT_1:sch 2(A143,A128);
( ( ( k + 1 ) + 1 ) + ( i -' ( ( k + 1 ) + 1 ) ) ) = ( ( i - ( ( k + 1 ) + 1 ) ) + ( ( k + 1 ) + 1 ) ) by A126,XREAL_1:233
.= i;
hence ( ( accum ( F (*) h2 ) ) . i ) = ( ( accum ( F (*) h4 ) ) . i ) by A127,A144;
end;
A145: ( gF /. ( k + 1 ) ) = ( gF . ( k + 1 ) ) by A9,A20,FINSEQ_4:15,NAT_1:11;
A146: ( dom h4 ) = ( dom F ) by A5,FUNCT_2:def 1;
( rng h4 ) c= ( dom F );
then A147: ( dom ( F (*) h4 ) ) = ( dom h4 ) by RELAT_1:27;
then ( Seg ( len ( F (*) h4 ) ) ) = ( dom h4 ) by FINSEQ_1:def 3;
then A148: ( k + 1 ) < ( len ( F (*) h4 ) ) by A20,A146,FINSEQ_1:def 3;
( Seg ( len ( F (*) h4 ) ) ) = ( dom F ) by A146,A147,FINSEQ_1:def 3;
then ( len ( F (*) h4 ) ) = ( len F ) by FINSEQ_1:def 3;
then A149: ( ( F (*) h4 ) /. ( ( k + 1 ) + 1 ) ) = ( ( F (*) h4 ) . ( ( k + 1 ) + 1 ) ) by A22,A24,FINSEQ_4:15;
( len ( accum ( F (*) h4 ) ) ) = ( len ( F (*) h4 ) ) by CKB48:def 1;
then A150: ( ( accum ( F (*) h4 ) ) /. ( k + 1 ) ) = ( ( accum ( F (*) h4 ) ) . ( k + 1 ) ) by A148,FINSEQ_4:15,NAT_1:11;
( gF . ( ( k + 1 ) + 1 ) ) = ( ( gF /. ( k + 1 ) ) + ( F /. ( ( k + 1 ) + 1 ) ) ) by A10,A20,NAT_1:11
.= ( ( ( accum ( F (*) h4 ) ) /. ( k + 1 ) ) + ( F /. ( ( k + 1 ) + 1 ) ) ) by A17,A23,A54,A150,A145
.= ( ( ( accum ( F (*) h4 ) ) /. ( k + 1 ) ) + ( ( F (*) h4 ) /. ( ( k + 1 ) + 1 ) ) ) by A123,A53,A149,A60,FUNCT_1:13
.= ( ( accum ( F (*) h4 ) ) . ( ( k + 1 ) + 1 ) ) by A61,A148,CKB48:def 1;
hence ( gF . ( ( k + 1 ) + 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( ( k + 1 ) + 1 ) ) by A22,A125;
end;
suppose nx > ( k + 1 );

then A151: ( ( k + 1 ) + 1 ) <= nx by NAT_1:13;
per cases  by A151,XXREAL_0:1;
suppose A152: ( ( k + 1 ) + 1 ) = nx;

A153: (for i being Nat holds ((( k + 1 ) < i & i <= ( len F )) implies ( h2 . i ) = i))
proof
let i being Nat;
assume that
A154: ( k + 1 ) < i
and
A155: i <= ( len F );
A156: ( ( k + 1 ) + 1 ) <= i by A154,NAT_1:13;
per cases  by A156,XXREAL_0:1;
suppose ( ( k + 1 ) + 1 ) < i;

hence ( h2 . i ) = i by A21,A155;
end;
suppose ( ( k + 1 ) + 1 ) = i;

hence ( h2 . i ) = i by A35,A152;
end;
end;
A157: ( k + 1 ) < ( len ( F (*) h2 ) ) by A20,A30,FINSEQ_1:def 3;
( len ( accum ( F (*) h2 ) ) ) = ( len ( F (*) h2 ) ) by CKB48:def 1;
then A158: ( ( accum ( F (*) h2 ) ) /. ( k + 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( k + 1 ) ) by A20,A32,FINSEQ_4:15,NAT_1:11;
A159: 1 <= ( k + 1 ) by NAT_1:11;
A160: ( F . ( ( k + 1 ) + 1 ) ) = ( ( F (*) h2 ) . nx ) by A34,A35,FUNCT_1:13;
A161: ( gF /. ( k + 1 ) ) = ( gF . ( k + 1 ) ) by A9,A20,FINSEQ_4:15,NAT_1:11;
A162: ( F /. ( ( k + 1 ) + 1 ) ) = ( F . ( ( k + 1 ) + 1 ) ) by A22,A24,FINSEQ_4:15;
( gF . ( ( k + 1 ) + 1 ) ) = ( ( gF /. ( k + 1 ) ) + ( F /. ( ( k + 1 ) + 1 ) ) ) by A10,A20,NAT_1:11
.= ( ( ( accum ( F (*) h2 ) ) /. ( k + 1 ) ) + ( F /. ( ( k + 1 ) + 1 ) ) ) by A17,A23,A153,A158,A161
.= ( ( ( accum ( F (*) h2 ) ) /. ( k + 1 ) ) + ( ( F (*) h2 ) /. ( ( k + 1 ) + 1 ) ) ) by A22,A24,A32,A152,A162,A160,FINSEQ_4:15
.= ( ( accum ( F (*) h2 ) ) . ( ( k + 1 ) + 1 ) ) by A159,A157,CKB48:def 1;
hence ( gF . ( ( k + 1 ) + 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( ( k + 1 ) + 1 ) );
end;
suppose ( ( k + 1 ) + 1 ) < nx;

hence ( gF . ( ( k + 1 ) + 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( ( k + 1 ) + 1 ) ) by A21,A35,A36;
end;
end;
end;
hence P[ ( k + 1 ) ];
end;
(for h2 being (Permutation of ( dom F )) holds ((for i being Nat holds ((( ( 0 ) + 1 ) < i & i <= ( len F )) implies ( h2 . i ) = i)) implies ( gF . ( ( 0 ) + 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( ( 0 ) + 1 ) )))
proof
let h2 being (Permutation of ( dom F ));
A163: ( rng h2 ) = ( dom F ) by FUNCT_2:def 3;
A164: ( dom h2 ) = ( dom F ) by A5,FUNCT_2:def 1;
assume A165: (for i being Nat holds ((( ( 0 ) + 1 ) < i & i <= ( len F )) implies ( h2 . i ) = i));
A166:now
assume A167: ( h2 . 1 ) <> 1;
consider x being set such that A168: x in ( dom h2 ) and A169: ( h2 . x ) = 1 by A5,A163,FUNCT_1:def 3;
reconsider nx = x as (Element of ( NAT )) by A164,A168;
1 <= nx by A11,A168,FINSEQ_1:1;
then (nx = 1 or (1 < nx & nx <= ( len F ))) by A11,A168,FINSEQ_1:1,XXREAL_0:1;
hence contradiction by A165,A167,A169;
end;
( ( accum ( F (*) h2 ) ) . 1 ) = ( ( F (*) h2 ) . 1 ) by CKB48:def 1
.= ( F . 1 ) by A5,A164,A166,FUNCT_1:13;
hence ( gF . ( ( 0 ) + 1 ) ) = ( ( accum ( F (*) h2 ) ) . ( ( 0 ) + 1 ) ) by CKB48:def 1;
end;
then A170: P[ ( 0 ) ];
(for k being Nat holds P[ k ]) from NAT_1:sch 2(A170,A16);
then ( gF . ( len F ) ) = ( ( accum ( F (*) h ) ) . ( len F ) ) by A13,A14,XREAL_1:44
.= ( ( accum F2 ) . ( len F2 ) ) by A1,A8,FINSEQ_1:def 3
.= ( Sum F2 ) by A12,CKB49:def 1;
hence ( Sum F2 ) = ( Sum F ) by A2,CKB49:def 1;
end;
suppose A171: ( len F ) <= ( 0 );

( rng h ) c= ( dom F );
then A172: ( dom ( F (*) h ) ) = ( dom h ) by RELAT_1:27;
( Seg ( len F ) ) = ( {} ) by A171;
then ( dom F ) = ( {} ) by FINSEQ_1:def 3;
then ( Seg ( len F ) ) = ( dom F2 ) by A1,A172,FINSEQ_1:def 3;
then A173: ( len F ) = ( len F2 ) by FINSEQ_1:def 3;
( Sum F ) = ( 0* n ) by A171,CKB49:def 1;
hence ( Sum F2 ) = ( Sum F ) by A171,A173,CKB49:def 1;
end;
end;
