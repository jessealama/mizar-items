environ
vocabularies FUNCT_1,RELAT_1,XBOOLE_0,TARSKI,FUNCT_4,PARTFUN1,SUBSET_1,PBOOLE,STRUCT_0,MSUALG_1,MARGREL1,CATALG_1,PUA2MSS1,TREES_1,FINSEQ_1,INSTALG1,FUNCSDOM,MSUALG_6,PROB_2,CARD_3,ALGSPEC1;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,MSAFREE1,FINSEQ_1,PBOOLE,RELSET_1,PARTFUN1,FINSEQ_2,FUNCT_4,LANG1,FUNCT_2,STRUCT_0,CARD_3,MSUALG_1,PROB_2,PUA2MSS1,CIRCCOMB,MSUALG_6,INSTALG1,CATALG_1,CKB7,CKB24,CKB31,CKB39,CKB50;
definitions TARSKI,FUNCT_1,PARTFUN1,STRUCT_0,MSUALG_1,CIRCCOMB,PUA2MSS1,INSTALG1,XBOOLE_0,FUNCT_2,CKB7,CKB24,CKB31,CKB39,CKB50;
theorems RELAT_1,FUNCT_1,FUNCT_2,FUNCT_3,FUNCT_4,PARTFUN1,GRFUNC_1,FINSEQ_1,PBOOLE,LANG1,PUA2MSS1,FRECHET,INSTALG1,FUNCT_7,CIRCCOMB,RELSET_1,PROB_2,MSAFREE1,XBOOLE_0,XBOOLE_1,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB59,CKB61,CKB62;
schemes FUNCT_1;
registrations XBOOLE_0,RELAT_1,FUNCT_1,FUNCT_2,PBOOLE,STRUCT_0,MSUALG_1,MSUALG_2,CIRCCOMB,MSUALG_6,INSTALG1,CATALG_1,RELSET_1,CKB38,CKB57,CKB58,CKB60;
constructors MSAFREE1,CIRCCOMB,PUA2MSS1,MSUALG_6,CATALG_1,RELSET_1,CKB7,CKB24,CKB31,CKB39,CKB50;
requirements SUBSET,BOOLE;
begin
reserve f for Function;
reserve g for Function;
theorem
(for S1,S2 being non  void Signature holds (S1 tolerates S2 implies (for f,g being Function holds (f,g form_a_replacement_in ( S1 +* S2 ) implies ( ( S1 +* S2 ) with-replacement (f,g) ) = ( ( S1 with-replacement (f,g) ) +* ( S2 with-replacement (f,g) ) )))))
proof
let S1 being non  void Signature;
let S2 being non  void Signature;
assume that
A1: S1 tolerates S2;
A2: (the ResultSort of S1) tolerates (the ResultSort of S2) by A1,CIRCCOMB:def 1;
A3: ( rng (the Arity of S2) ) c= ( (the carrier of S2) * );
A4: ( rng (the ResultSort of S2) ) c= (the carrier of S2);
A5: ( rng (the ResultSort of S1) ) c= (the carrier of S1);
set S = ( S1 +* S2 );
let f being Function;
let g being Function;
assume that
A6: f,g form_a_replacement_in ( S1 +* S2 );
deffunc F(non  void Signature) = ( (the carrier of $1) -indexing f );
deffunc T(non  void Signature) = ( $1 with-replacement (f,g) );
A7: ( dom F(S2) ) = (the carrier of S2) by PARTFUN1:def 2;
A8: F(S1) tolerates F(S2) by CKB20:1;
A9: S is (Extension of S1) by A1,CKB53:1;
then reconsider F1 = F(S1) as (Function of (the carrier of S1),(the carrier of T(S1))) by A6,CKB41:1,CKB61:1;
A10: ( dom ( F(S1) * (the ResultSort of S1) ) ) = (the carrier' of S1) by PARTFUN1:def 2;
deffunc G(non  void Signature) = ( (the carrier' of $1) -indexing g );
A11: ( dom F(S1) ) = (the carrier of S1) by PARTFUN1:def 2;
A12: ( dom G(S1) ) = (the carrier' of S1) by PARTFUN1:def 2;
set g1 = the (rng-retract of G(S1));
set g2 = the (rng-retract of G(S2));
A13: (the ResultSort of S) = ( (the ResultSort of S1) +* (the ResultSort of S2) ) by CIRCCOMB:def 2;
A14: ( rng g2 ) c= ( dom G(S2) ) by CKB25:1;
A15: (the carrier' of S) = ( (the carrier' of S1) \/ (the carrier' of S2) ) by CIRCCOMB:def 2;
then G(S) = ( G(S1) \/ G(S2) ) by CKB21:1;
then A16: ( rng G(S) ) = ( ( rng G(S1) ) \/ ( rng G(S2) ) ) by RELAT_1:12;
A17: ( dom G(S2) ) = (the carrier' of S2) by PARTFUN1:def 2;
A18: S is (Extension of S2) by CKB54:1;
then reconsider F2 = F(S2) as (Function of (the carrier of S2),(the carrier of T(S2))) by A6,CKB41:1,CKB61:1;
A19: ( dom ( F(S2) * (the ResultSort of S2) ) ) = (the carrier' of S2) by PARTFUN1:def 2;
A20: (the carrier of S) = ( (the carrier of S1) \/ (the carrier of S2) ) by CIRCCOMB:def 2;
then A21: F(S) = ( F(S1) +* F(S2) ) by CKB19:1;
F(S) = ( F(S1) \/ F(S2) ) by A20,CKB21:1;
then A22: ( rng F(S) ) = ( ( rng F(S1) ) \/ ( rng F(S2) ) ) by RELAT_1:12;
A23: ( dom ( ( F2 * ) * (the Arity of S2) ) ) = (the carrier' of S2) by FUNCT_2:def 1;
A24: ( dom ( F2 * ) ) = ( (the carrier of S2) * ) by FUNCT_2:def 1;
G(S) = ( G(S1) +* G(S2) ) by A15,CKB19:1;
then reconsider gg = ( g1 +* g2 ) as (rng-retract of G(S)) by CKB20:1,CKB29:1;
A25: ( rng g1 ) c= ( dom G(S1) ) by CKB25:1;
A26: (the ResultSort of T(S)) = ( ( F(S) * (the ResultSort of S) ) * gg ) by A6,CKB43:1
.= ( ( ( F(S1) * (the ResultSort of S1) ) +* ( F(S2) * (the ResultSort of S2) ) ) * gg ) by A13,A21,A5,A4,A11,A7,CKB20:1,FUNCT_4:69
.= ( ( ( F(S1) * (the ResultSort of S1) ) * g1 ) +* ( ( F(S2) * (the ResultSort of S2) ) * g2 ) ) by A8,A25,A14,A12,A17,A10,A19,A2,CKB4:1,FUNCT_4:69
.= ( (the ResultSort of T(S1)) +* ( ( F(S2) * (the ResultSort of S2) ) * g2 ) ) by A6,A9,CKB43:1,CKB61:1
.= ( (the ResultSort of T(S1)) +* (the ResultSort of T(S2)) ) by A6,A18,CKB43:1,CKB61:1;
A27: (the carrier of T(S)) = ( rng F(S) ) by A6,CKB39:def 1;
A28: ( dom ( ( F1 * ) * (the Arity of S1) ) ) = (the carrier' of S1) by FUNCT_2:def 1;
reconsider FS = F(S) as (Function of (the carrier of S),(the carrier of T(S))) by A6,CKB41:1;
A29: ( ( rng (the Arity of S) ) /\ ( dom ( FS * ) ) ) c= ( rng (the Arity of S) ) by XBOOLE_1:17;
A30: (the Arity of S) = ( (the Arity of S1) +* (the Arity of S2) ) by CIRCCOMB:def 2;
A31: f,g form_a_replacement_in S1 by A6,A9,CKB61:1;
then A32: (the carrier of T(S1)) = ( rng F(S1) ) by CKB39:def 1;
A33: (the carrier' of T(S1)) = ( rng G(S1) ) by A31,CKB39:def 1;
A34: (the carrier' of T(S)) = ( rng G(S) ) by A6,CKB39:def 1;
A35: ( dom ( F1 * ) ) = ( (the carrier of S1) * ) by FUNCT_2:def 1;
(the Arity of S1) tolerates (the Arity of S2) by A1,CIRCCOMB:def 1;
then (the Arity of S) = ( (the Arity of S1) \/ (the Arity of S2) ) by A30,FUNCT_4:30;
then ( rng (the Arity of S) ) = ( ( rng (the Arity of S1) ) \/ ( rng (the Arity of S2) ) ) by RELAT_1:12;
then ( rng (the Arity of S) ) c= ( ( (the carrier of S1) * ) \/ ( (the carrier of S2) * ) ) by XBOOLE_1:13;
then ( rng (the Arity of S) ) c= ( dom ( ( F1 * ) +* ( F2 * ) ) ) by A35,A24,FUNCT_4:def 1;
then A36: ( ( rng (the Arity of S) ) /\ ( dom ( FS * ) ) ) c= ( dom ( ( F1 * ) +* ( F2 * ) ) ) by A29,XBOOLE_1:1;
A37: f,g form_a_replacement_in S2 by A6,A18,CKB61:1;
then A38: (the carrier of T(S2)) = ( rng F(S2) ) by CKB39:def 1;
A39: (the carrier' of T(S2)) = ( rng G(S2) ) by A37,CKB39:def 1;
A40: ( F1 * ) tolerates ( F2 * ) by CKB6:1,CKB20:1;
A41: ( ( F1 * ) +* ( F2 * ) ) c= ( ( F1 * ) \/ ( F2 * ) ) by FUNCT_4:29;
F2 = ( FS | (the carrier of S2) ) by A20,CKB18:1,XBOOLE_1:7;
then A42: ( F2 * ) c= ( FS * ) by CKB5:1,RELAT_1:59;
F1 = ( FS | (the carrier of S1) ) by A20,CKB18:1,XBOOLE_1:7;
then ( F1 * ) c= ( FS * ) by CKB5:1,RELAT_1:59;
then ( ( F1 * ) \/ ( F2 * ) ) c= ( FS * ) by A42,XBOOLE_1:8;
then A43: ( ( F1 * ) +* ( F2 * ) ) c= ( FS * ) by A41,XBOOLE_1:1;
A44: (the Arity of S1) tolerates (the Arity of S2) by A1,CIRCCOMB:def 1;
A45: ( rng (the Arity of S1) ) c= ( (the carrier of S1) * );
(the Arity of T(S)) = ( ( ( FS * ) * (the Arity of S) ) * gg ) by A6,CKB42:1
.= ( ( ( ( F1 * ) +* ( F2 * ) ) * (the Arity of S) ) * gg ) by A43,A36,CKB2:1
.= ( ( ( ( F1 * ) * (the Arity of S1) ) +* ( ( F2 * ) * (the Arity of S2) ) ) * gg ) by A30,A8,A45,A3,A35,A24,CKB6:1,FUNCT_4:69
.= ( ( ( ( F1 * ) * (the Arity of S1) ) * g1 ) +* ( ( ( F2 * ) * (the Arity of S2) ) * g2 ) ) by A25,A14,A12,A17,A40,A44,A28,A23,CKB4:1,FUNCT_4:69
.= ( (the Arity of T(S1)) +* ( ( ( F2 * ) * (the Arity of S2) ) * g2 ) ) by A6,A9,CKB42:1,CKB61:1
.= ( (the Arity of T(S1)) +* (the Arity of T(S2)) ) by A6,A18,CKB42:1,CKB61:1;
hence thesis by A22,A27,A32,A38,A16,A34,A33,A39,A26,CIRCCOMB:def 2;
end;
