environ
vocabularies XBOOLE_0,ORDERS_2,SUBSET_1,STRUCT_0,MSUALG_1,PRALG_2,FUNCT_1,RELAT_1,CARD_3,RLVECT_2,PBOOLE,XXREAL_0,MEMBER_1,MSUALG_3,FUNCOP_1,RELAT_2,MCART_1,MSUALG_2,TARSKI,UNIALG_2,MARGREL1,FUNCT_6,FINSEQ_1,FUNCT_2,COMPLEX1,PARTFUN1,FINSEQ_4,NAT_1,FUNCT_5,NATTRA_1,PUA2MSS1,ZFMISC_1,MSALIMIT;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NAT_1,MCART_1,RELAT_1,FUNCT_1,STRUCT_0,RELAT_2,FUNCT_2,FINSEQ_1,FINSEQ_2,ORDERS_2,FUNCOP_1,RELSET_1,PARTFUN1,CARD_3,BINOP_1,FUNCT_5,FUNCT_6,PBOOLE,PRALG_1,MSUALG_1,MSUALG_2,MSUALG_3,PRALG_2,PUA2MSS1,ORDERS_3,CKB3,CKB4,CKB5,CKB7;
definitions TARSKI,XBOOLE_0,BINOP_1,CKB3,CKB4,CKB5,CKB7;
theorems ALTCAT_1,CARD_3,FUNCOP_1,FINSEQ_1,FUNCT_1,FUNCT_2,FUNCT_5,FUNCT_7,MCART_1,MSUALG_1,MSUALG_2,MSUALG_3,MSUHOM_1,ORDERS_2,ORDERS_3,PARTFUN1,PBOOLE,PRALG_1,PRALG_2,PUA2MSS1,RELAT_1,RELAT_2,TARSKI,ZFMISC_1,RELSET_1,XBOOLE_0,XBOOLE_1,ORDERS_1,FUNCT_6,FINSEQ_2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8;
schemes FRAENKEL,PBOOLE,TARSKI,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,FUNCT_2,FUNCOP_1,PBOOLE,STRUCT_0,ORDERS_2,MSUALG_1,MSUALG_2,PRALG_2,MSUALG_3,ORDERS_3,PRALG_3,ORDINAL1,CARD_3,RELSET_1,CKB1,CKB2;
constructors PRALG_1,PRALG_2,MSUALG_3,PUA2MSS1,ORDERS_3,RELSET_1,FINSEQ_2,CKB3,CKB4,CKB5,CKB7;
requirements SUBSET,BOOLE;
begin
reserve P for non  empty Poset;
reserve i for (Element of P);
reserve j for (Element of P);
reserve k for (Element of P);
reserve S for non  void non  empty ManySortedSign;
reserve OAF for (OrderedAlgFam of P,S);
reserve B for (Binding of OAF);
definition
let P;
let S;
let OAF;
let B;
func Normalized B -> (Binding of OAF) means 
:Def5: (for i holds (for j holds (i >= j implies ( it . (j,i) ) = ( IFEQ (j,i,( id (the Sorts of ( OAF . i )) ),( ( bind (B,i,j) ) ** ( id (the Sorts of ( OAF . i )) ) )) ))));
existence
proof
defpred P[ set,set ]
 means
(ex i st (ex j st ($1 = [ j,i ] & $2 = ( IFEQ (j,i,( id (the Sorts of ( OAF . i )) ),( ( bind (B,i,j) ) ** ( id (the Sorts of ( OAF . i )) ) )) ))));
now
let ij being set;
assume A1: ij in (the InternalRel of P);
then reconsider i2 = ( ij `1 ),i1 = ( ij `2 ) as (Element of P) by MCART_1:10;
reconsider i1,i2 as (Element of P);
deffunc Z(set) = ( IFEQ (i2,i1,( id (the Sorts of ( OAF . i1 )) ),( ( bind (B,i1,i2) ) ** ( id (the Sorts of ( OAF . i1 )) ) )) );
consider A being (ManySortedSet of (the InternalRel of P)) such that A2: (for ij being set holds (ij in (the InternalRel of P) implies ( A . ij ) = Z(ij))) from PBOOLE:sch 4;
take x = ( A . ij );
take i1;
take i2;
thus (ij = [ i2,i1 ] & x = ( IFEQ (i2,i1,( id (the Sorts of ( OAF . i1 )) ),( ( bind (B,i1,i2) ) ** ( id (the Sorts of ( OAF . i1 )) ) )) )) by A1,A2,MCART_1:21;
end;
then A3: (for z being set holds (z in (the InternalRel of P) implies (ex y being set st P[ z,y ])));
consider A being (ManySortedSet of (the InternalRel of P)) such that A4: (for ij being set holds (ij in (the InternalRel of P) implies P[ ij,( A . ij ) ])) from PBOOLE:sch 3(A3);
(for z being set holds (z in ( dom A ) implies ( A . z ) is Function))
proof
let z being set;
assume z in ( dom A );
then z in (the InternalRel of P) by PARTFUN1:def 2;
then consider i1,i2 being (Element of P) such that z = [ i2,i1 ] and A5: ( A . z ) = ( IFEQ (i2,i1,( id (the Sorts of ( OAF . i1 )) ),( ( bind (B,i1,i2) ) ** ( id (the Sorts of ( OAF . i1 )) ) )) ) by A4;
per cases ;
suppose i1 = i2;

hence thesis by A5,FUNCOP_1:def 8;
end;
suppose i1 <> i2;

hence thesis by A5,FUNCOP_1:def 8;
end;
end;
then reconsider A as (ManySortedFunction of (the InternalRel of P)) by FUNCOP_1:def 6;
now
let i;
let j;
let k;
assume that
A6: i >= j
and
A7: j >= k;
consider kl being set such that A8: kl = [ j,i ];
kl in (the InternalRel of P) by A6,A8,ORDERS_2:def 5;
then consider i1,j1 being (Element of P) such that A9: [ j1,i1 ] = kl and A10: ( A . kl ) = ( IFEQ (j1,i1,( id (the Sorts of ( OAF . i1 )) ),( ( bind (B,i1,j1) ) ** ( id (the Sorts of ( OAF . i1 )) ) )) ) by A4;
A11: (i1 = i & j1 = j) by A8,A9,ZFMISC_1:27;
( A . (j,i) ) is (ManySortedFunction of ( OAF . i ),( OAF . j ))
proof
per cases ;
suppose i = j;

hence thesis by A9,A10,A11,FUNCOP_1:def 8;
end;
suppose i <> j;

hence thesis by A9,A10,A11,FUNCOP_1:def 8;
end;
end;
then reconsider f1 = ( A . (j,i) ) as (ManySortedFunction of ( OAF . i ),( OAF . j ));
consider lm being set such that A12: lm = [ k,j ];
lm in (the InternalRel of P) by A7,A12,ORDERS_2:def 5;
then consider i2,j2 being (Element of P) such that A13: [ j2,i2 ] = lm and A14: ( A . lm ) = ( IFEQ (j2,i2,( id (the Sorts of ( OAF . i2 )) ),( ( bind (B,i2,j2) ) ** ( id (the Sorts of ( OAF . i2 )) ) )) ) by A4;
A15: (j2 = k & i2 = j) by A12,A13,ZFMISC_1:27;
( A . (k,j) ) is (ManySortedFunction of ( OAF . j ),( OAF . k ))
proof
per cases ;
suppose j = k;

hence thesis by A13,A14,A15,FUNCOP_1:def 8;
end;
suppose j <> k;

hence thesis by A13,A14,A15,FUNCOP_1:def 8;
end;
end;
then reconsider f2 = ( A . (k,j) ) as (ManySortedFunction of ( OAF . j ),( OAF . k ));
A16: (for i holds (for j holds ((i >= j & i <> j) implies ( A . (j,i) ) = ( bind (B,i,j) ))))
proof
let i;
let j;
assume that
A17: i >= j
and
A18: i <> j;
consider lm being set such that A19: lm = [ j,i ];
lm in (the InternalRel of P) by A17,A19,ORDERS_2:def 5;
then consider i2,j2 being (Element of P) such that A20: [ j2,i2 ] = lm and A21: ( A . lm ) = ( IFEQ (j2,i2,( id (the Sorts of ( OAF . i2 )) ),( ( bind (B,i2,j2) ) ** ( id (the Sorts of ( OAF . i2 )) ) )) ) by A4;
(i2 = i & j2 = j) by A19,A20,ZFMISC_1:27;
then ( A . (j,i) ) = ( ( bind (B,i,j) ) ** ( id (the Sorts of ( OAF . i )) ) ) by A18,A20,A21,FUNCOP_1:def 8;
hence thesis by MSUALG_3:3;
end;
A22: ( A . (k,i) ) = ( f2 ** f1 )
proof
per cases ;
suppose A23: (i = j & j = k);

then f2 = ( id (the Sorts of ( OAF . j )) ) by A13,A14,A15,FUNCOP_1:def 8;
hence thesis by A23,MSUALG_3:3;
end;
suppose A24: (i = j & j <> k);

then f1 = ( id (the Sorts of ( OAF . i )) ) by A9,A10,A11,FUNCOP_1:def 8;
hence thesis by A24,MSUALG_3:3;
end;
suppose A25: (i <> j & j = k);

then f2 = ( id (the Sorts of ( OAF . j )) ) by A13,A14,A15,FUNCOP_1:def 8;
hence thesis by A25,MSUALG_3:4;
end;
suppose A26: (i <> j & j <> k);

then (i > j & j > k) by A6,A7,ORDERS_2:def 6;
then A27: i <> k by ORDERS_2:5;
f2 = ( ( bind (B,j,k) ) ** ( id (the Sorts of ( OAF . j )) ) ) by A13,A14,A15,A26,FUNCOP_1:def 8;
then A28: f2 = ( bind (B,j,k) ) by MSUALG_3:3;
f1 = ( ( bind (B,i,j) ) ** ( id (the Sorts of ( OAF . i )) ) ) by A9,A10,A11,A26,FUNCOP_1:def 8;
then f1 = ( bind (B,i,j) ) by MSUALG_3:3;
then ( f2 ** f1 ) = ( bind (B,i,k) ) by A6,A7,A28,CKB6:1;
hence thesis by A6,A7,A16,A27,ORDERS_2:3;
end;
end;
A29: (for i holds (for j holds (i = j implies ( A . (j,i) ) = ( id (the Sorts of ( OAF . i )) ))))
proof
let i;
let j;
consider lm being set such that A30: lm = [ j,i ];
assume A31: i = j;
then i >= j by ORDERS_2:1;
then lm in (the InternalRel of P) by A30,ORDERS_2:def 5;
then consider i2,j2 being (Element of P) such that A32: [ j2,i2 ] = lm and A33: ( A . lm ) = ( IFEQ (j2,i2,( id (the Sorts of ( OAF . i2 )) ),( ( bind (B,i2,j2) ) ** ( id (the Sorts of ( OAF . i2 )) ) )) ) by A4;
(i2 = i & j2 = j) by A30,A32,ZFMISC_1:27;
hence thesis by A31,A32,A33,FUNCOP_1:def 8;
end;
f1 is_homomorphism ( OAF . i ),( OAF . j )
proof
per cases ;
suppose A34: i = j;

then ( A . (i,j) ) = ( id (the Sorts of ( OAF . i )) ) by A29;
hence thesis by A34,MSUALG_3:9;
end;
suppose i <> j;

then ( A . (j,i) ) = ( bind (B,i,j) ) by A6,A16;
hence thesis by A6,CKB8:1;
end;
end;
hence (ex f1 being (ManySortedFunction of ( OAF . i ),( OAF . j )) st (ex f2 being (ManySortedFunction of ( OAF . j ),( OAF . k )) st (((f1 = ( A . (j,i) ) & f2 = ( A . (k,j) )) & ( A . (k,i) ) = ( f2 ** f1 )) & f1 is_homomorphism ( OAF . i ),( OAF . j )))) by A22;
end;
then reconsider A as (Binding of OAF) by CKB4:def 1;
take A;
let i;
let j;
consider kl being set such that A35: kl = [ j,i ];
assume i >= j;
then kl in (the InternalRel of P) by A35,ORDERS_2:def 5;
then consider i1,j1 being (Element of P) such that A36: [ j1,i1 ] = kl and A37: ( A . kl ) = ( IFEQ (j1,i1,( id (the Sorts of ( OAF . i1 )) ),( ( bind (B,i1,j1) ) ** ( id (the Sorts of ( OAF . i1 )) ) )) ) by A4;
(i1 = i & j1 = j) by A35,A36,ZFMISC_1:27;
hence thesis by A36,A37;
end;
uniqueness
proof
let N1 being (Binding of OAF);
let N2 being (Binding of OAF);
assume that
A38: (for i holds (for j holds (i >= j implies ( N1 . (j,i) ) = ( IFEQ (j,i,( id (the Sorts of ( OAF . i )) ),( ( bind (B,i,j) ) ** ( id (the Sorts of ( OAF . i )) ) )) ))))
and
A39: (for i holds (for j holds (i >= j implies ( N2 . (j,i) ) = ( IFEQ (j,i,( id (the Sorts of ( OAF . i )) ),( ( bind (B,i,j) ) ** ( id (the Sorts of ( OAF . i )) ) )) ))));
now
let ij being set;
assume A40: ij in (the InternalRel of P);
then reconsider i2 = ( ij `1 ),i1 = ( ij `2 ) as (Element of P) by MCART_1:10;
reconsider i1,i2 as (Element of P);
A41: ( N2 . ij ) = ( N2 . (i2,i1) ) by A40,MCART_1:21;
ij = [ ( ij `1 ),( ij `2 ) ] by A40,MCART_1:21;
then A42: i2 <= i1 by A40,ORDERS_2:def 5;
( N1 . ij ) = ( N1 . (i2,i1) ) by A40,MCART_1:21;
then ( N1 . ij ) = ( IFEQ (i2,i1,( id (the Sorts of ( OAF . i1 )) ),( ( bind (B,i1,i2) ) ** ( id (the Sorts of ( OAF . i1 )) ) )) ) by A38,A42;
hence ( N1 . ij ) = ( N2 . ij ) by A39,A42,A41;
end;
hence N1 = N2 by PBOOLE:3;
end;
end;
