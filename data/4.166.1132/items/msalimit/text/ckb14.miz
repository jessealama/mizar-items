environ
vocabularies XBOOLE_0,ORDERS_2,SUBSET_1,STRUCT_0,MSUALG_1,PRALG_2,FUNCT_1,RELAT_1,CARD_3,RLVECT_2,PBOOLE,XXREAL_0,MEMBER_1,MSUALG_3,FUNCOP_1,RELAT_2,MCART_1,MSUALG_2,TARSKI,UNIALG_2,MARGREL1,FUNCT_6,FINSEQ_1,FUNCT_2,COMPLEX1,PARTFUN1,FINSEQ_4,NAT_1,FUNCT_5,NATTRA_1,PUA2MSS1,ZFMISC_1,MSALIMIT;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NAT_1,MCART_1,RELAT_1,FUNCT_1,STRUCT_0,RELAT_2,FUNCT_2,FINSEQ_1,FINSEQ_2,ORDERS_2,FUNCOP_1,RELSET_1,PARTFUN1,CARD_3,BINOP_1,FUNCT_5,FUNCT_6,PBOOLE,PRALG_1,MSUALG_1,MSUALG_2,MSUALG_3,PRALG_2,PUA2MSS1,ORDERS_3,CKB3,CKB4,CKB5,CKB7,CKB9;
definitions TARSKI,XBOOLE_0,BINOP_1,CKB3,CKB4,CKB5,CKB7,CKB9;
theorems ALTCAT_1,CARD_3,FUNCOP_1,FINSEQ_1,FUNCT_1,FUNCT_2,FUNCT_5,FUNCT_7,MCART_1,MSUALG_1,MSUALG_2,MSUALG_3,MSUHOM_1,ORDERS_2,ORDERS_3,PARTFUN1,PBOOLE,PRALG_1,PRALG_2,PUA2MSS1,RELAT_1,RELAT_2,TARSKI,ZFMISC_1,RELSET_1,XBOOLE_0,XBOOLE_1,ORDERS_1,FUNCT_6,FINSEQ_2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB13;
schemes FRAENKEL,PBOOLE,TARSKI,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,FUNCT_2,FUNCOP_1,PBOOLE,STRUCT_0,ORDERS_2,MSUALG_1,MSUALG_2,PRALG_2,MSUALG_3,ORDERS_3,PRALG_3,ORDINAL1,CARD_3,RELSET_1,CKB1,CKB2,CKB11,CKB12;
constructors PRALG_1,PRALG_2,MSUALG_3,PUA2MSS1,ORDERS_3,RELSET_1,FINSEQ_2,CKB3,CKB4,CKB5,CKB7,CKB9;
requirements SUBSET,BOOLE;
begin
reserve P for non  empty Poset;
reserve i for (Element of P);
reserve j for (Element of P);
reserve S for non  void non  empty ManySortedSign;
reserve OAF for (OrderedAlgFam of P,S);
reserve B for (Binding of OAF);
definition
let P;
let S;
let OAF;
let B being (Binding of OAF);
func InvLim B ->  strict (MSSubAlgebra of ( product OAF )) means 
:Def6: (for s being (SortSymbol of S) holds (for f being (Element of ( ( SORTS OAF ) . s )) holds (f in ( (the Sorts of it) . s ) iff (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( f . i ) ) = ( f . j )))))));
existence
proof
reconsider L = ( product OAF ) as  non-empty MSAlgebra over S;
deffunc F((SortSymbol of S)) = { f where f is (Element of ( product ( Carrier (OAF,$1) ) )): (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . $1 ) . ( f . i ) ) = ( f . j )))) };
consider C being (ManySortedSet of (the carrier of S)) such that A1: (for s being (SortSymbol of S) holds ( C . s ) = F(s)) from PBOOLE:sch 5;
(for i being set holds (i in (the carrier of S) implies ( C . i ) c= ( ( SORTS OAF ) . i )))
proof
let i being set;
assume i in (the carrier of S);
then reconsider s = i as (SortSymbol of S);
defpred P[ (Element of ( product ( Carrier (OAF,s) ) )) ]
 means
(for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( $1 . i ) ) = ( $1 . j ))));
A2: { f where f is (Element of ( product ( Carrier (OAF,s) ) )): P[ f ] } c= ( product ( Carrier (OAF,s) ) ) from FRAENKEL:sch 10;
( ( SORTS OAF ) . s ) = ( product ( Carrier (OAF,s) ) ) by PRALG_2:def 10;
hence thesis by A1,A2;
end;
then C c= ( SORTS OAF ) by PBOOLE:def 2;
then reconsider C as (ManySortedSubset of ( SORTS OAF )) by PBOOLE:def 18;
reconsider C as (MSSubset of ( product OAF )) by PRALG_2:12;
(for o being (OperSymbol of S) holds C is_closed_on o)
proof
let o being (OperSymbol of S);
( rng ( ( Den (o,( product OAF )) ) | ( ( ( C # ) * (the Arity of S) ) . o ) ) ) c= ( ( C * (the ResultSort of S) ) . o )
proof
reconsider MS = C as (ManySortedSet of (the carrier of S));
reconsider K = ( ( Den (o,( product OAF )) ) | ( ( ( C # ) * (the Arity of S) ) . o ) ) as Function;
let x being set;
A3: ( dom (the Arity of S) ) = (the carrier' of S) by FUNCT_2:def 1;
assume A4: x in ( rng ( ( Den (o,( product OAF )) ) | ( ( ( C # ) * (the Arity of S) ) . o ) ) );
then consider y being set such that A5: y in ( dom K ) and A6: x = ( K . y ) by FUNCT_1:def 3;
A7: ( dom K ) = ( ( dom ( Den (o,( product OAF )) ) ) /\ ( ( ( C # ) * (the Arity of S) ) . o ) ) by RELAT_1:61;
then y in ( ( ( C # ) * (the Arity of S) ) . o ) by A5,XBOOLE_0:def 4;
then y in ( ( C # ) . ( (the Arity of S) . o ) ) by A3,FUNCT_1:13;
then y in ( ( C # ) . ( the_arity_of o ) ) by MSUALG_1:def 1;
then A8: y in ( product ( MS * ( the_arity_of o ) ) ) by FINSEQ_2:def 5;
x in ( Result (o,( product OAF )) ) by A4;
then (( dom (the ResultSort of S) ) = (the carrier' of S) & x in ( ( (the Sorts of ( product OAF )) * (the ResultSort of S) ) . o )) by FUNCT_2:def 1,MSUALG_1:def 5;
then x in ( (the Sorts of ( product OAF )) . ( (the ResultSort of S) . o ) ) by FUNCT_1:13;
then A9: x in ( ( SORTS OAF ) . ( (the ResultSort of S) . o ) ) by PRALG_2:12;
then reconsider x1 = x as Function;
x in ( ( SORTS OAF ) . ( the_result_sort_of o ) ) by A9,MSUALG_1:def 2;
then A10: x is (Element of ( product ( Carrier (OAF,( the_result_sort_of o )) ) )) by PRALG_2:def 10;
A11: y in ( dom ( Den (o,( product OAF )) ) ) by A5,A7,XBOOLE_0:def 4;
now
let s being (SortSymbol of S);
(for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . ( the_result_sort_of o ) ) . ( x1 . i ) ) = ( x1 . j ))))
proof
reconsider OPE = ( ( OPS OAF ) . o ) as Function;
A12: ( Den (o,( product OAF )) ) = ( (the Charact of ( product OAF )) . o ) by MSUALG_1:def 6
.= ( ( OPS OAF ) . o ) by PRALG_2:12;
reconsider y as Function by A8;
let i;
let j;
assume A13: i >= j;
reconsider Co = ( commute y ) as Function;
set y1 = ( ( commute y ) . i );
A14: ( dom y ) = ( dom ( MS * ( the_arity_of o ) ) ) by A8,CARD_3:9;
A15: ( rng ( the_arity_of o ) ) c= ( dom MS )
proof
let i being set;
assume i in ( rng ( the_arity_of o ) );
then i in (the carrier of S);
hence thesis by PARTFUN1:def 2;
end;
then A16: ( dom y ) = ( dom ( the_arity_of o ) ) by A14,RELAT_1:27;
then A17: ( dom y ) = ( Seg ( len ( the_arity_of o ) ) ) by FINSEQ_1:def 3;
( rng y ) c= ( Funcs ((the carrier of P),|. OAF .|) )
proof
let z being set;
assume z in ( rng y );
then consider n being set such that A18: n in ( dom y ) and A19: z = ( y . n ) by FUNCT_1:def 3;
A20: n in ( dom ( MS * ( the_arity_of o ) ) ) by A8,A18,CARD_3:9;
then n in ( dom ( the_arity_of o ) ) by A15,RELAT_1:27;
then ( ( the_arity_of o ) . n ) = ( ( the_arity_of o ) /. n ) by PARTFUN1:def 6;
then reconsider Pa = ( ( the_arity_of o ) . n ) as (SortSymbol of S);
z in ( ( MS * ( the_arity_of o ) ) . n ) by A8,A19,A20,CARD_3:9;
then z in ( MS . ( ( the_arity_of o ) . n ) ) by A20,FUNCT_1:12;
then z in { f where f is (Element of ( product ( Carrier (OAF,Pa) ) )): (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . Pa ) . ( f . i ) ) = ( f . j )))) } by A1;
then A21: (ex z9 being (Element of ( product ( Carrier (OAF,Pa) ) )) st (z9 = z & (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . Pa ) . ( z9 . i ) ) = ( z9 . j ))))));
then reconsider z as Function;
A22: ( dom z ) = ( dom ( Carrier (OAF,Pa) ) ) by A21,CARD_3:9
.= (the carrier of P) by PARTFUN1:def 2;
( rng z ) c= |. OAF .|
proof
let p being set;
assume p in ( rng z );
then consider r being set such that A23: r in ( dom z ) and A24: ( z . r ) = p by FUNCT_1:def 3;
reconsider r9 = r as (Element of P) by A22,A23;
reconsider r9 as (Element of P);
r9 in (the carrier of P);
then A25: (ex U0 being MSAlgebra over S st (U0 = ( OAF . r ) & ( ( Carrier (OAF,Pa) ) . r ) = ( (the Sorts of U0) . Pa ))) by PRALG_2:def 9;
|. ( OAF . r9 ) .| in { |. ( OAF . k ) .| where k is (Element of P): (not contradiction) };
then |. ( OAF . r9 ) .| c= ( union { |. ( OAF . k ) .| where k is (Element of P): (not contradiction) } ) by ZFMISC_1:74;
then A26: |. ( OAF . r9 ) .| c= |. OAF .| by PRALG_2:def 7;
( dom (the Sorts of ( OAF . r9 )) ) = (the carrier of S) by PARTFUN1:def 2;
then A27: ( (the Sorts of ( OAF . r9 )) . Pa ) in ( rng (the Sorts of ( OAF . r9 )) ) by FUNCT_1:def 3;
( dom z ) = ( dom ( Carrier (OAF,Pa) ) ) by A21,CARD_3:9;
then p in ( ( Carrier (OAF,Pa) ) . r ) by A21,A23,A24,CARD_3:9;
then p in ( union ( rng (the Sorts of ( OAF . r9 )) ) ) by A25,A27,TARSKI:def 4;
then p in |. ( OAF . r9 ) .| by PRALG_2:def 6;
hence thesis by A26;
end;
hence thesis by A22,FUNCT_2:def 2;
end;
then A28: y in ( Funcs (( Seg ( len ( the_arity_of o ) ) ),( Funcs ((the carrier of P),|. OAF .|) )) ) by A17,FUNCT_2:def 2;
per cases ;
suppose A29: ( the_arity_of o ) <> ( {} );

A30: (for t being set holds (t in ( dom ( doms ( OAF ?. o ) ) ) implies ( Co . t ) in ( ( doms ( OAF ?. o ) ) . t )))
proof
let t being set;
assume t in ( dom ( doms ( OAF ?. o ) ) );
then reconsider t as (Element of P) by PRALG_2:11;
reconsider yt = ( Co . t ) as Function;
( dom ( the_arity_of o ) ) <> ( {} ) by A29;
then ( Seg ( len ( the_arity_of o ) ) ) <> ( {} ) by FINSEQ_1:def 3;
then Co in ( Funcs ((the carrier of P),( Funcs (( Seg ( len ( the_arity_of o ) ) ),|. OAF .|) )) ) by A28,FUNCT_6:55;
then A31: (ex ss being Function st ((ss = Co & ( dom ss ) = (the carrier of P)) & ( rng ss ) c= ( Funcs (( Seg ( len ( the_arity_of o ) ) ),|. OAF .|) ))) by FUNCT_2:def 2;
A32: ( Co . t ) in ( product ( (the Sorts of ( OAF . t )) * ( the_arity_of o ) ) )
proof
A33: ( dom ( (the Sorts of ( OAF . t )) * ( the_arity_of o ) ) ) = ( dom ( the_arity_of o ) ) by PRALG_2:3
.= ( Seg ( len ( the_arity_of o ) ) ) by FINSEQ_1:def 3;
A34: ( dom y ) = ( Seg ( len ( the_arity_of o ) ) ) by A16,FINSEQ_1:def 3;
A35: (for w being set holds (w in ( dom ( (the Sorts of ( OAF . t )) * ( the_arity_of o ) ) ) implies ( yt . w ) in ( ( (the Sorts of ( OAF . t )) * ( the_arity_of o ) ) . w )))
proof
( dom ( the_arity_of o ) ) <> ( {} ) by A29;
then ( Seg ( len ( the_arity_of o ) ) ) <> ( {} ) by FINSEQ_1:def 3;
then A36: y = ( commute ( commute y ) ) by A28,FUNCT_6:57;
let w being set;
reconsider Pi = ( ( the_arity_of o ) /. w ) as (SortSymbol of S);
A37: ( dom ( Carrier (OAF,( ( the_arity_of o ) /. w )) ) ) = (the carrier of P) by PARTFUN1:def 2;
assume A38: w in ( dom ( (the Sorts of ( OAF . t )) * ( the_arity_of o ) ) );
then A39: w in ( dom ( the_arity_of o ) ) by A33,FINSEQ_1:def 3;
( y . w ) in ( ( MS * ( the_arity_of o ) ) . w ) by A8,A14,A33,A34,A38,CARD_3:9;
then A40: ( y . w ) in ( MS . ( ( the_arity_of o ) . w ) ) by A39,FUNCT_1:13;
reconsider y as  Function-yielding Function by A36;
reconsider yw = ( y . w ) as Function;
( y . w ) in ( MS . ( ( the_arity_of o ) /. w ) ) by A39,A40,PARTFUN1:def 6;
then yw in { ff where ff is (Element of ( product ( Carrier (OAF,Pi) ) )): (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . Pi ) . ( ff . i ) ) = ( ff . j )))) } by A1;
then (ex jg being (Element of ( product ( Carrier (OAF,Pi) ) )) st (jg = yw & (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . Pi ) . ( jg . i ) ) = ( jg . j ))))));
then A41: ( yw . t ) in ( ( Carrier (OAF,( ( the_arity_of o ) /. w )) ) . t ) by A37,CARD_3:9;
(ex U0 being MSAlgebra over S st (U0 = ( OAF . t ) & ( ( Carrier (OAF,( ( the_arity_of o ) /. w )) ) . t ) = ( (the Sorts of U0) . ( ( the_arity_of o ) /. w ) ))) by PRALG_2:def 9;
then ( ( Carrier (OAF,( ( the_arity_of o ) /. w )) ) . t ) = ( (the Sorts of ( OAF . t )) . ( ( the_arity_of o ) . w ) ) by A39,PARTFUN1:def 6
.= ( ( (the Sorts of ( OAF . t )) * ( the_arity_of o ) ) . w ) by A39,FUNCT_1:13;
hence thesis by A28,A33,A38,A41,FUNCT_6:56;
end;
( Co . t ) in ( rng Co ) by A31,FUNCT_1:def 3;
then (ex ts being Function st ((ts = ( Co . t ) & ( dom ts ) = ( Seg ( len ( the_arity_of o ) ) )) & ( rng ts ) c= |. OAF .|)) by A31,FUNCT_2:def 2;
hence thesis by A33,A35,CARD_3:9;
end;
( ( doms ( OAF ?. o ) ) . t ) = ( Args (o,( OAF . t )) ) by PRALG_2:11;
hence thesis by A32,PRALG_2:3;
end;
A42: Co in ( product ( doms ( OAF ?. o ) ) )
proof
( dom ( the_arity_of o ) ) <> ( {} ) by A29;
then ( Seg ( len ( the_arity_of o ) ) ) <> ( {} ) by FINSEQ_1:def 3;
then Co in ( Funcs ((the carrier of P),( Funcs (( Seg ( len ( the_arity_of o ) ) ),|. OAF .|) )) ) by A28,FUNCT_6:55;
then (ex Co9 being Function st ((Co9 = Co & ( dom Co9 ) = (the carrier of P)) & ( rng Co9 ) c= ( Funcs (( Seg ( len ( the_arity_of o ) ) ),|. OAF .|) ))) by FUNCT_2:def 2;
then ( dom Co ) = ( dom ( doms ( OAF ?. o ) ) ) by PRALG_2:11;
hence thesis by A30,CARD_3:9;
end;
A43: OPE = ( IFEQ (( the_arity_of o ),( {} ),( commute ( OAF ?. o ) ),( Commute ( Frege ( OAF ?. o ) ) )) ) by PRALG_2:def 13;
then A44: y in ( dom ( Commute ( Frege ( OAF ?. o ) ) ) ) by A11,A12,A29,FUNCOP_1:def 8;
reconsider y1 as Function;
A45: ( dom ( OAF ?. o ) ) = (the carrier of P) by PARTFUN1:def 2;
A46: x1 = ( OPE . y ) by A5,A6,A12,FUNCT_1:47
.= ( ( Commute ( Frege ( OAF ?. o ) ) ) . y ) by A29,A43,FUNCOP_1:def 8
.= ( ( Frege ( OAF ?. o ) ) . ( commute y ) ) by A44,PRALG_2:def 1
.= ( ( OAF ?. o ) .. ( commute y ) ) by A42,PRALG_2:def 2;
then A47: ( x1 . i ) = ( ( ( OAF ?. o ) . i ) . ( ( commute y ) . i ) ) by A45,PRALG_1:def 17
.= ( ( Den (o,( OAF . i )) ) . y1 ) by PRALG_2:7;
( dom ( the_arity_of o ) ) <> ( {} ) by A29;
then ( Seg ( len ( the_arity_of o ) ) ) <> ( {} ) by FINSEQ_1:def 3;
then Co in ( Funcs ((the carrier of P),( Funcs (( Seg ( len ( the_arity_of o ) ) ),|. OAF .|) )) ) by A28,FUNCT_6:55;
then A48: (ex ss being Function st ((ss = Co & ( dom ss ) = (the carrier of P)) & ( rng ss ) c= ( Funcs (( Seg ( len ( the_arity_of o ) ) ),|. OAF .|) ))) by FUNCT_2:def 2;
y1 in ( product ( (the Sorts of ( OAF . i )) * ( the_arity_of o ) ) )
proof
A49: ( dom ( (the Sorts of ( OAF . i )) * ( the_arity_of o ) ) ) = ( dom ( the_arity_of o ) ) by PRALG_2:3
.= ( Seg ( len ( the_arity_of o ) ) ) by FINSEQ_1:def 3;
A50: (for w being set holds (w in ( dom ( (the Sorts of ( OAF . i )) * ( the_arity_of o ) ) ) implies ( y1 . w ) in ( ( (the Sorts of ( OAF . i )) * ( the_arity_of o ) ) . w )))
proof
( dom ( the_arity_of o ) ) <> ( {} ) by A29;
then ( Seg ( len ( the_arity_of o ) ) ) <> ( {} ) by FINSEQ_1:def 3;
then A51: y = ( commute ( commute y ) ) by A28,FUNCT_6:57;
let w being set;
reconsider Pi = ( ( the_arity_of o ) /. w ) as (SortSymbol of S);
A52: ( dom ( Carrier (OAF,( ( the_arity_of o ) /. w )) ) ) = (the carrier of P) by PARTFUN1:def 2;
assume A53: w in ( dom ( (the Sorts of ( OAF . i )) * ( the_arity_of o ) ) );
then A54: w in ( dom ( the_arity_of o ) ) by A49,FINSEQ_1:def 3;
w in ( dom y ) by A16,A49,A53,FINSEQ_1:def 3;
then ( y . w ) in ( ( MS * ( the_arity_of o ) ) . w ) by A8,A14,CARD_3:9;
then A55: ( y . w ) in ( MS . ( ( the_arity_of o ) . w ) ) by A54,FUNCT_1:13;
reconsider y as  Function-yielding Function by A51;
reconsider yw = ( y . w ) as Function;
( y . w ) in ( MS . ( ( the_arity_of o ) /. w ) ) by A54,A55,PARTFUN1:def 6;
then yw in { ff where ff is (Element of ( product ( Carrier (OAF,Pi) ) )): (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . Pi ) . ( ff . i ) ) = ( ff . j )))) } by A1;
then (ex jg being (Element of ( product ( Carrier (OAF,Pi) ) )) st (jg = yw & (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . Pi ) . ( jg . i ) ) = ( jg . j ))))));
then A56: ( yw . i ) in ( ( Carrier (OAF,( ( the_arity_of o ) /. w )) ) . i ) by A52,CARD_3:9;
(ex U0 being MSAlgebra over S st (U0 = ( OAF . i ) & ( ( Carrier (OAF,( ( the_arity_of o ) /. w )) ) . i ) = ( (the Sorts of U0) . ( ( the_arity_of o ) /. w ) ))) by PRALG_2:def 9;
then ( ( Carrier (OAF,( ( the_arity_of o ) /. w )) ) . i ) = ( (the Sorts of ( OAF . i )) . ( ( the_arity_of o ) . w ) ) by A54,PARTFUN1:def 6
.= ( ( (the Sorts of ( OAF . i )) * ( the_arity_of o ) ) . w ) by A54,FUNCT_1:13;
hence thesis by A28,A49,A53,A56,FUNCT_6:56;
end;
( Co . i ) in ( rng Co ) by A48,FUNCT_1:def 3;
then (ex ts being Function st ((ts = ( Co . i ) & ( dom ts ) = ( Seg ( len ( the_arity_of o ) ) )) & ( rng ts ) c= |. OAF .|)) by A48,FUNCT_2:def 2;
hence thesis by A49,A50,CARD_3:9;
end;
then reconsider y19 = y1 as (Element of ( Args (o,( OAF . i )) )) by PRALG_2:3;
A57: ( bind (B,i,j) ) is_homomorphism ( OAF . i ),( OAF . j ) by A13,CKB8:1;
( ( bind (B,i,j) ) # y19 ) = ( ( commute y ) . j )
proof
A58: ( dom ( ( bind (B,i,j) ) # y19 ) ) = ( dom ( the_arity_of o ) ) by MSUALG_3:6
.= ( Seg ( len ( the_arity_of o ) ) ) by FINSEQ_1:def 3;
then reconsider One = ( ( bind (B,i,j) ) # y19 ) as FinSequence by FINSEQ_1:def 2;
( dom ( the_arity_of o ) ) <> ( {} ) by A29;
then A59: ( Seg ( len ( the_arity_of o ) ) ) <> ( {} ) by FINSEQ_1:def 3;
then y = ( commute ( commute y ) ) by A28,FUNCT_6:57;
then reconsider y as  Function-yielding Function;
reconsider y2 = ( ( commute y ) . j ) as Function;
Co in ( Funcs ((the carrier of P),( Funcs (( Seg ( len ( the_arity_of o ) ) ),|. OAF .|) )) ) by A28,A59,FUNCT_6:55;
then A60: (ex ss being Function st ((ss = Co & ( dom ss ) = (the carrier of P)) & ( rng ss ) c= ( Funcs (( Seg ( len ( the_arity_of o ) ) ),|. OAF .|) ))) by FUNCT_2:def 2;
then ( Co . j ) in ( rng Co ) by FUNCT_1:def 3;
then A61: (ex ts being Function st ((ts = ( Co . j ) & ( dom ts ) = ( Seg ( len ( the_arity_of o ) ) )) & ( rng ts ) c= |. OAF .|)) by A60,FUNCT_2:def 2;
then reconsider Two = y2 as FinSequence by FINSEQ_1:def 2;
A62: ( Co . i ) in ( rng Co ) by A60,FUNCT_1:def 3;
now
let n being Nat;
reconsider yn = ( y . n ) as Function;
reconsider Pi = ( ( the_arity_of o ) /. n ) as (SortSymbol of S);
A63: (ex ts9 being Function st ((ts9 = ( Co . i ) & ( dom ts9 ) = ( Seg ( len ( the_arity_of o ) ) )) & ( rng ts9 ) c= |. OAF .|)) by A60,A62,FUNCT_2:def 2;
assume A64: n in ( dom y2 );
then A65: ( y . n ) in ( ( MS * ( the_arity_of o ) ) . n ) by A8,A14,A17,A61,CARD_3:9;
A66: n in ( dom ( the_arity_of o ) ) by A61,A64,FINSEQ_1:def 3;
then ( ( the_arity_of o ) /. n ) = ( ( the_arity_of o ) . n ) by PARTFUN1:def 6;
then yn in ( MS . Pi ) by A66,A65,FUNCT_1:13;
then yn in { f where f is (Element of ( product ( Carrier (OAF,Pi) ) )): (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . Pi ) . ( f . i ) ) = ( f . j )))) } by A1;
then A67: (ex yn9 being (Element of ( product ( Carrier (OAF,Pi) ) )) st (yn9 = yn & (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . Pi ) . ( yn9 . i ) ) = ( yn9 . j ))))));
( y19 . n ) = ( yn . i ) by A28,A61,A64,FUNCT_6:56;
then ( ( ( bind (B,i,j) ) # y19 ) . n ) = ( ( ( bind (B,i,j) ) . ( ( the_arity_of o ) /. n ) ) . ( yn . i ) ) by A61,A64,A63,MSUALG_3:def 6
.= ( yn . j ) by A13,A67;
hence ( ( ( bind (B,i,j) ) # y19 ) . n ) = ( y2 . n ) by A28,A61,A64,FUNCT_6:56;
end;
then (for n being Nat holds (n in ( Seg ( len ( the_arity_of o ) ) ) implies ( One . n ) = ( Two . n ))) by A61;
hence thesis by A61,A58,FINSEQ_1:13;
end;
then ( ( Den (o,( OAF . j )) ) . ( ( bind (B,i,j) ) # y19 ) ) = ( ( ( OAF ?. o ) . j ) . ( ( commute y ) . j ) ) by PRALG_2:7
.= ( x1 . j ) by A45,A46,PRALG_1:def 17;
hence thesis by A57,A47,MSUALG_3:def 7;
end;
suppose A68: ( the_arity_of o ) = ( {} );

reconsider co = ( ( commute ( OAF ?. o ) ) . y ) as Function;
A69: ( MS * ( {} ) ) = ( {} );
A70: co = ( ( curry' ( uncurry ( OAF ?. o ) ) ) . y ) by FUNCT_6:def 10;
A71: ( dom ( OAF ?. o ) ) = (the carrier of P) by PARTFUN1:def 2;
A72: ( Den (o,( product OAF )) ) = ( (the Charact of ( product OAF )) . o ) by MSUALG_1:def 6
.= ( ( OPS OAF ) . o ) by PRALG_2:12
.= ( IFEQ (( the_arity_of o ),( {} ),( commute ( OAF ?. o ) ),( Commute ( Frege ( OAF ?. o ) ) )) ) by PRALG_2:def 13
.= ( commute ( OAF ?. o ) ) by A68,FUNCOP_1:def 8;
A73: (for d being (Element of P) holds ( x1 . d ) = ( ( Den (o,( OAF . d )) ) . ( {} ) ))
proof
reconsider co9 = ( ( curry' ( uncurry ( OAF ?. o ) ) ) . y ) as Function by A70;
let d being (Element of P);
reconsider g = ( ( OAF ?. o ) . d ) as Function;
A74: x1 = ( ( commute ( OAF ?. o ) ) . y ) by A5,A6,A72,FUNCT_1:47;
g = ( Den (o,( OAF . d )) ) by PRALG_2:7;
then ( dom g ) = ( Args (o,( OAF . d )) ) by FUNCT_2:def 1
.= { ( {} ) } by A68,PRALG_2:4;
then A75: y in ( dom g ) by A8,A68,CARD_3:10;
then A76: [ d,y ] in ( dom ( uncurry ( OAF ?. o ) ) ) by A71,FUNCT_5:38;
( co . d ) = ( co9 . d ) by FUNCT_6:def 10
.= ( ( uncurry ( OAF ?. o ) ) . (d,y) ) by A76,FUNCT_5:22
.= ( g . y ) by A71,A75,FUNCT_5:38;
then ( x1 . d ) = ( ( Den (o,( OAF . d )) ) . y ) by A74,PRALG_2:7
.= ( ( Den (o,( OAF . d )) ) . ( {} ) ) by A8,A68,A69,CARD_3:10,TARSKI:def 1;
hence thesis;
end;
then A77: ( x1 . i ) = ( ( Den (o,( OAF . i )) ) . ( {} ) );
( Args (o,( OAF . i )) ) = { ( {} ) } by A68,PRALG_2:4;
then reconsider E = ( {} ) as (Element of ( Args (o,( OAF . i )) )) by TARSKI:def 1;
set F = ( bind (B,i,j) );
A78: ( Args (o,( OAF . j )) ) = { ( {} ) } by A68,PRALG_2:4;
( bind (B,i,j) ) is_homomorphism ( OAF . i ),( OAF . j ) by A13,CKB8:1;
then A79: ( ( F . ( the_result_sort_of o ) ) . ( x1 . i ) ) = ( ( Den (o,( OAF . j )) ) . ( F # E ) ) by A77,MSUALG_3:def 7;
( x1 . j ) = ( ( Den (o,( OAF . j )) ) . ( {} ) ) by A73;
hence thesis by A79,A78,TARSKI:def 1;
end;
end;
then x in { f where f is (Element of ( product ( Carrier (OAF,( the_result_sort_of o )) ) )): (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . ( the_result_sort_of o ) ) . ( f . i ) ) = ( f . j )))) } by A10;
hence x in ( C . ( the_result_sort_of o ) ) by A1;
end;
then x in ( C . ( the_result_sort_of o ) );
then A80: x in ( C . ( (the ResultSort of S) . o ) ) by MSUALG_1:def 2;
( dom (the ResultSort of S) ) = (the carrier' of S) by FUNCT_2:def 1;
hence thesis by A80,FUNCT_1:13;
end;
hence thesis by MSUALG_2:def 5;
end;
then A81: C is  opers_closed by MSUALG_2:def 6;
reconsider C as (MSSubset of L);
set MSA = ( L | C );
A82: MSA = MSAlgebra (# C,( Opers (L,C) ) #) by A81,MSUALG_2:def 15;
now
let s being (SortSymbol of S);
let f being (Element of ( ( SORTS OAF ) . s ));
A83: f is (Element of ( product ( Carrier (OAF,s) ) )) by PRALG_2:def 10;
thus (f in ( (the Sorts of MSA) . s ) iff (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( f . i ) ) = ( f . j )))))
proof
hereby
assume f in ( (the Sorts of MSA) . s );
then f in { g where g is (Element of ( product ( Carrier (OAF,s) ) )): (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( g . i ) ) = ( g . j )))) } by A1,A82;
then (ex k being (Element of ( product ( Carrier (OAF,s) ) )) st (k = f & (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( k . i ) ) = ( k . j ))))));
hence (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( f . i ) ) = ( f . j ))));
end;
assume (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( f . i ) ) = ( f . j ))));
then f in { h where h is (Element of ( product ( Carrier (OAF,s) ) )): (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( h . i ) ) = ( h . j )))) } by A83;
hence thesis by A1,A82;
end;

end;
hence thesis;
end;
uniqueness
proof
let A1 being  strict (MSSubAlgebra of ( product OAF ));
let A2 being  strict (MSSubAlgebra of ( product OAF ));
assume that
A84: (for s being (SortSymbol of S) holds (for f being (Element of ( ( SORTS OAF ) . s )) holds (f in ( (the Sorts of A1) . s ) iff (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( f . i ) ) = ( f . j )))))))
and
A85: (for s being (SortSymbol of S) holds (for f being (Element of ( ( SORTS OAF ) . s )) holds (f in ( (the Sorts of A2) . s ) iff (for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( f . i ) ) = ( f . j )))))));
(for s being set holds (s in (the carrier of S) implies ( (the Sorts of A1) . s ) = ( (the Sorts of A2) . s )))
proof
let a being set;
assume a in (the carrier of S);
then reconsider s = a as (SortSymbol of S);
thus ( (the Sorts of A1) . a ) c= ( (the Sorts of A2) . a )
proof
let e being set;
assume A86: e in ( (the Sorts of A1) . a );
(the Sorts of A1) is (MSSubset of ( product OAF )) by MSUALG_2:def 9;
then (the Sorts of A1) c= (the Sorts of ( product OAF )) by PBOOLE:def 18;
then (the Sorts of A1) c= ( SORTS OAF ) by PRALG_2:12;
then ( (the Sorts of A1) . s ) c= ( ( SORTS OAF ) . s ) by PBOOLE:def 2;
then reconsider f = e as (Element of ( ( SORTS OAF ) . s )) by A86;
(for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( f . i ) ) = ( f . j )))) by A84,A86;
hence thesis by A85;
end;

let e being set;
assume A87: e in ( (the Sorts of A2) . a );
(the Sorts of A2) is (MSSubset of ( product OAF )) by MSUALG_2:def 9;
then (the Sorts of A2) c= (the Sorts of ( product OAF )) by PBOOLE:def 18;
then (the Sorts of A2) c= ( SORTS OAF ) by PRALG_2:12;
then ( (the Sorts of A2) . s ) c= ( ( SORTS OAF ) . s ) by PBOOLE:def 2;
then reconsider f = e as (Element of ( ( SORTS OAF ) . s )) by A87;
(for i holds (for j holds (i >= j implies ( ( ( bind (B,i,j) ) . s ) . ( f . i ) ) = ( f . j )))) by A85,A87;
hence thesis by A84;
end;
hence thesis by MSUALG_2:9,PBOOLE:3;
end;
end;
