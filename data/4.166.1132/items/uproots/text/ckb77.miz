environ
vocabularies NUMBERS,FINSEQ_1,SUBSET_1,RELAT_1,FUNCT_1,CARD_1,CARD_3,FINSEQ_2,ARYTM_3,ORDINAL4,TARSKI,NAT_1,XXREAL_0,REAL_1,ARYTM_1,XBOOLE_0,ORDINAL1,RLVECT_1,ALGSTR_0,SUPINF_2,PARTFUN1,FINSET_1,FUNCT_2,MCART_1,ZFMISC_1,PRE_POLY,FUNCT_4,FUNCOP_1,VALUED_0,PBOOLE,XREAL_0,SGRAPH1,FINSOP_1,BINOP_1,GROUP_1,STRUCT_0,POLYNOM1,POLYNOM3,AFINSQ_1,MESFUNC1,ALGSEQ_1,VECTSP_1,POLYNOM5,LATTICES,VECTSP_2,COMPLFLD,POLYNOM2,FVSUM_1,MEMBERED,CLASSES1,UPROOTS;
notations TARSKI,XBOOLE_0,XCMPLX_0,XXREAL_0,SUBSET_1,ORDINAL1,CARD_1,NUMBERS,XREAL_0,ZFMISC_1,REAL_1,VECTSP_2,BINOP_1,RELAT_1,FUNCT_1,PBOOLE,RELSET_1,PARTFUN1,FINSEQ_1,FINSEQ_2,DOMAIN_1,FUNCT_2,XXREAL_2,VALUED_0,NAT_1,NAT_D,STRUCT_0,ALGSTR_0,RLVECT_1,VFUNCT_1,VECTSP_1,FINSOP_1,NORMSP_1,GROUP_4,RVSUM_1,ALGSEQ_1,COMPLFLD,BHSP_1,POLYNOM3,POLYNOM4,POLYNOM5,FINSET_1,MCART_1,FUNCT_4,FUNCOP_1,CLASSES1,FVSUM_1,WSIERP_1,MEMBERED,GROUP_1,RECDEF_1,PRE_POLY,CKB5,CKB11,CKB17,CKB18,CKB19,CKB20,CKB27,CKB59,CKB65,CKB72,CKB75;
definitions TARSKI,VECTSP_2,FUNCT_1,POLYNOM3,POLYNOM5,FINSEQ_2,RVSUM_1,GROUP_4,RLVECT_1,FUNCOP_1,RELAT_1,STRUCT_0,CKB5,CKB11,CKB18,CKB20,CKB27,CKB59,CKB65,CKB72,CKB75;
theorems GROUP_1,CARD_1,FINSEQ_1,ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,RELAT_1,TARSKI,XBOOLE_0,XBOOLE_1,VECTSP_1,POLYNOM5,INT_1,AXIOMS,RVSUM_1,FVSUM_1,FINSEQ_3,FINSEQ_2,POLYNOM4,POLYNOM3,FUNCT_7,ALGSEQ_1,RLVECT_1,PBOOLE,FUNCOP_1,MATRIX_3,VECTSP_2,CARD_2,FINSEQ_5,GRAPH_5,BAGORDER,RFINSEQ,WELLORD2,CARD_3,ORDINAL1,FINSOP_1,MONOID_0,INTEGRA1,FUNCT_4,MCART_1,XREAL_1,GROUP_4,XXREAL_0,PARTFUN1,XXREAL_2,NAT_D,FINSEQ_4,CLASSES1,PRE_POLY,TREES_9,CKB1,CKB3,CKB5,CKB7,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB31,CKB32,CKB33,CKB35,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB72,CKB73,CKB74,CKB75,CKB76;
schemes NAT_1,FUNCT_1,FUNCT_2,FRAENKEL,ALGSEQ_1,FINSEQ_1,RECDEF_1,CLASSES1,INT_1,CKB2;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCOP_1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,CARD_1,MEMBERED,FINSEQ_1,STRUCT_0,VECTSP_1,COMPLFLD,ALGSTR_1,MONOID_0,PRE_POLY,POLYNOM3,POLYNOM4,POLYNOM5,FINSEQ_2,VALUED_0,XXREAL_2,FUNCT_2,RELSET_1,GROUP_1,VFUNCT_1,CKB4,CKB6,CKB8,CKB29,CKB30,CKB34,CKB36,CKB37,CKB56,CKB71;
constructors WELLORD2,SETWISEO,REAL_1,FINSEQOP,FINSOP_1,NAT_D,WSIERP_1,VECTSP_2,REALSET2,ALGSTR_1,GROUP_4,BHSP_1,MATRIX_2,MONOID_0,GOBOARD1,POLYNOM2,POLYNOM4,POLYNOM5,SEQ_1,RECDEF_1,BINOP_2,CLASSES1,XXREAL_2,RELSET_1,FUNCT_7,FVSUM_1,VFUNCT_1,CKB5,CKB11,CKB18,CKB20,CKB27,CKB59,CKB65,CKB72,CKB75;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
theorem
Th57: (for L being domRing holds (for x being (Element of L) holds (for p,q being  non-zero (Polynomial of L) holds ( multiplicity (( p *' q ),x) ) = ( ( multiplicity (p,x) ) + ( multiplicity (q,x) ) ))))
proof
let L being domRing;
let x being (Element of L);
let p being  non-zero (Polynomial of L);
let q being  non-zero (Polynomial of L);
set r = <% ( - x ),( 1. L ) %>;
consider F being  finite non  empty (Subset of ( NAT )) such that A1: F = { k where k is (Element of ( NAT )): (ex pqq being (Polynomial of L) st ( p *' q ) = ( ( r `^ k ) *' pqq )) } and A2: ( multiplicity (( p *' q ),x) ) = ( max F ) by CKB72:def 1;
consider f being  finite non  empty (Subset of ( NAT )) such that A3: f = { k where k is (Element of ( NAT )): (ex pq being (Polynomial of L) st p = ( ( r `^ k ) *' pq )) } and A4: ( multiplicity (p,x) ) = ( max f ) by CKB72:def 1;
( max f ) in f by XXREAL_2:def 8;
then consider i being (Element of ( NAT )) such that A5: i = ( max f ) and A6: (ex pq being (Polynomial of L) st p = ( ( r `^ i ) *' pq )) by A3;
consider pq being (Polynomial of L) such that A7: p = ( ( r `^ i ) *' pq ) by A6;
consider g being  finite non  empty (Subset of ( NAT )) such that A8: g = { k where k is (Element of ( NAT )): (ex qq being (Polynomial of L) st q = ( ( r `^ k ) *' qq )) } and A9: ( multiplicity (q,x) ) = ( max g ) by CKB72:def 1;
( max F ) in F by XXREAL_2:def 8;
then consider k being (Element of ( NAT )) such that A10: k = ( max F ) and A11: (ex pqq being (Polynomial of L) st ( p *' q ) = ( ( r `^ k ) *' pqq )) by A1;
consider pqq being (Polynomial of L) such that A12: ( p *' q ) = ( ( r `^ k ) *' pqq ) by A11;
( max g ) in g by XXREAL_2:def 8;
then consider j being (Element of ( NAT )) such that A13: j = ( max g ) and A14: (ex qq being (Polynomial of L) st q = ( ( r `^ j ) *' qq )) by A8;
consider qq being (Polynomial of L) such that A15: q = ( ( r `^ j ) *' qq ) by A14;
A16: ( p *' q ) = ( ( ( ( r `^ i ) *' pq ) *' ( r `^ j ) ) *' qq ) by A7,A15,POLYNOM3:33
.= ( ( ( ( r `^ i ) *' ( r `^ j ) ) *' pq ) *' qq ) by POLYNOM3:33
.= ( ( ( r `^ ( i + j ) ) *' pq ) *' qq ) by CKB46:1
.= ( ( r `^ ( i + j ) ) *' ( pq *' qq ) ) by POLYNOM3:33;
A17:now
assume ( i + j ) < k;
then ( (( 0 ) qua Nat) + ( i + j ) ) < k;
then A18: ( 0 ) < ( k - ( i + j ) ) by XREAL_1:20;
then reconsider kij = ( k - ( i + j ) ) as (Element of ( NAT )) by INT_1:3;
consider kk being Nat such that A19: kij = ( kk + 1 ) by A18,NAT_1:6;
reconsider kk as (Element of ( NAT )) by ORDINAL1:def 12;
( r `^ kij ) = ( ( r `^ 1 ) *' ( r `^ kk ) ) by A19,CKB46:1
.= ( r *' ( r `^ kk ) ) by POLYNOM5:16;
then A20: ( ( r `^ kij ) *' pqq ) = ( r *' ( ( r `^ kk ) *' pqq ) ) by POLYNOM3:33;
(( ( 0_. L ) . 1 ) = ( 0. L ) & ( r . 1 ) = ( 1. L )) by FUNCOP_1:7,POLYNOM5:38;
then A21: ( r `^ ( i + j ) ) <> ( 0_. L ) by CKB45:1;
k = ( kij + ( i + j ) );
then ( p *' q ) = ( ( ( r `^ ( i + j ) ) *' ( r `^ kij ) ) *' pqq ) by A12,CKB46:1
.= ( ( r `^ ( i + j ) ) *' ( ( r `^ kij ) *' pqq ) ) by POLYNOM3:33;
then x is_a_root_of ( pq *' qq ) by A16,A21,A20,CKB44:1,CKB68:1;
then x in ( Roots ( pq *' qq ) ) by POLYNOM5:def 9;
then A22: x in ( ( Roots pq ) \/ ( Roots qq ) ) by CKB39:1;
per cases  by A22,XBOOLE_0:def 3;
suppose x in ( Roots pq );

then x is_a_root_of pq by POLYNOM5:def 9;
then pq = ( r *' ( poly_quotient (pq,x) ) ) by CKB69:1;
then p = ( ( ( r `^ i ) *' r ) *' ( poly_quotient (pq,x) ) ) by A7,POLYNOM3:33
.= ( ( ( r `^ i ) *' ( r `^ 1 ) ) *' ( poly_quotient (pq,x) ) ) by POLYNOM5:16
.= ( ( r `^ ( i + 1 ) ) *' ( poly_quotient (pq,x) ) ) by CKB46:1;
then ( i + 1 ) in f by A3;
then ( i + 1 ) <= i by A5,XXREAL_2:def 8;
hence contradiction by NAT_1:13;
end;
suppose x in ( Roots qq );

then x is_a_root_of qq by POLYNOM5:def 9;
then qq = ( r *' ( poly_quotient (qq,x) ) ) by CKB69:1;
then q = ( ( ( r `^ j ) *' r ) *' ( poly_quotient (qq,x) ) ) by A15,POLYNOM3:33
.= ( ( ( r `^ j ) *' ( r `^ 1 ) ) *' ( poly_quotient (qq,x) ) ) by POLYNOM5:16
.= ( ( r `^ ( j + 1 ) ) *' ( poly_quotient (qq,x) ) ) by CKB46:1;
then ( j + 1 ) in g by A8;
then ( j + 1 ) <= j by A13,XXREAL_2:def 8;
hence contradiction by NAT_1:13;
end;
end;
( i + j ) in F by A1,A16;
then ( i + j ) <= k by A10,XXREAL_2:def 8;
hence thesis by A2,A4,A9,A10,A5,A13,A17,XXREAL_0:1;
end;
