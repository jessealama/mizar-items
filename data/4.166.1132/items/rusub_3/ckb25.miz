environ
vocabularies BHSP_1,SUBSET_1,RLVECT_3,STRUCT_0,RLSUB_1,CARD_3,RLVECT_2,TARSKI,RLVECT_1,ARYTM_3,REAL_1,RELAT_1,SUPINF_2,CARD_1,FUNCT_1,NUMBERS,FUNCT_2,FINSET_1,XBOOLE_0,ZFMISC_1,ORDINAL1,ORDERS_1,ARYTM_1,FINSEQ_1,VALUED_1,NAT_1,ORDINAL4,CLASSES1,XXREAL_0,PARTFUN1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,REAL_1,NAT_1,FINSEQ_1,RELAT_1,ORDINAL1,FUNCT_1,PARTFUN1,FUNCT_2,ORDERS_1,DOMAIN_1,STRUCT_0,RLVECT_1,FINSET_1,RLSUB_1,RLVECT_2,BHSP_1,RLVECT_3,RUSUB_1,RUSUB_2,CLASSES1,XXREAL_0,CKB1,CKB19;
definitions XBOOLE_0,RLVECT_2,TARSKI,RLVECT_3,RLSUB_1,RLVECT_1,CKB1,CKB19;
theorems FUNCT_1,FUNCT_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSET_1,ORDERS_1,RLSUB_2,RLVECT_1,RLVECT_2,TARSKI,ZFMISC_1,RELAT_1,ORDINAL1,XBOOLE_0,XBOOLE_1,RUSUB_1,RUSUB_2,RLVECT_3,ENUMSET1,RLVECT_4,RFINSEQ,NAT_1,SUBSET_1,XCMPLX_0,XCMPLX_1,CARD_2,STRUCT_0,PARTFUN1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24;
schemes FUNCT_1,FUNCT_2,NAT_1,XBOOLE_0,RLVECT_4;
registrations SUBSET_1,ORDINAL1,RELSET_1,FUNCT_2,FINSET_1,NUMBERS,MEMBERED,FINSEQ_1,STRUCT_0,RLVECT_3,BHSP_1,RUSUB_1,CARD_1,RLVECT_2;
constructors PARTFUN1,XXREAL_0,REAL_1,NAT_1,ORDERS_1,REALSET1,RFINSEQ,RLVECT_2,RLVECT_3,CLASSES1,RUSUB_2,RELSET_1,CKB1,CKB19;
requirements NUMERALS,BOOLE,SUBSET,ARITHM;
begin
theorem
Th18: (for V being RealUnitarySpace holds (for W being (Subspace of V) holds (for L being (Linear_Combination of V) holds (( Carrier L ) c= (the carrier of W) implies (for K being (Linear_Combination of W) holds (K = ( L | (the carrier of W) ) implies (( Carrier L ) = ( Carrier K ) & ( Sum L ) = ( Sum K ))))))))
proof
let V being RealUnitarySpace;
let W being (Subspace of V);
let L being (Linear_Combination of V);
assume that
A1: ( Carrier L ) c= (the carrier of W);
let K being (Linear_Combination of W);
assume that
A2: K = ( L | (the carrier of W) );
A3: ( dom K ) = (the carrier of W) by FUNCT_2:def 1;
now
let x being set;
assume x in ( Carrier K );
then consider w being (VECTOR of W) such that A4: x = w and A5: ( K . w ) <> ( 0 );
A6: w is (VECTOR of V) by RUSUB_1:3;
( L . w ) <> ( 0 ) by A2,A3,A5,FUNCT_1:47;
hence x in ( Carrier L ) by A4,A6;
end;
then A7: ( Carrier K ) c= ( Carrier L ) by TARSKI:def 3;
consider G being (FinSequence of W) such that A8: (G is  one-to-one & ( rng G ) = ( Carrier K )) and A9: ( Sum K ) = ( Sum ( K (#) G ) ) by RLVECT_2:def 8;
consider F being (FinSequence of V) such that A10: F is  one-to-one and A11: ( rng F ) = ( Carrier L ) and A12: ( Sum L ) = ( Sum ( L (#) F ) ) by RLVECT_2:def 8;
now
let x being set;
assume A13: x in ( Carrier L );
then consider v being (VECTOR of V) such that A14: x = v and A15: ( L . v ) <> ( 0 );
( K . v ) <> ( 0 ) by A1,A2,A3,A13,A14,A15,FUNCT_1:47;
hence x in ( Carrier K ) by A1,A13,A14;
end;
then A16: ( Carrier L ) c= ( Carrier K ) by TARSKI:def 3;
then A17: ( Carrier K ) = ( Carrier L ) by A7,XBOOLE_0:def 10;
then F,G are_fiberwise_equipotent  by A10,A11,A8,RFINSEQ:26;
then consider P being (Permutation of ( dom G )) such that A18: F = ( G * P ) by RFINSEQ:4;
( len ( K (#) G ) ) = ( len G ) by RLVECT_2:def 7;
then A19: ( dom ( K (#) G ) ) = ( dom G ) by FINSEQ_3:29;
then reconsider q = ( ( K (#) G ) * P ) as (FinSequence of W) by FINSEQ_2:47;
A20: ( len q ) = ( len ( K (#) G ) ) by A19,FINSEQ_2:44;
then ( len q ) = ( len G ) by RLVECT_2:def 7;
then A21: ( dom q ) = ( dom G ) by FINSEQ_3:29;
set p = ( L (#) F );
A22: (the carrier of W) c= (the carrier of V) by RUSUB_1:def 1;
( rng q ) c= (the carrier of W) by FINSEQ_1:def 4;
then ( rng q ) c= (the carrier of V) by A22,XBOOLE_1:1;
then reconsider q9 = q as (FinSequence of V) by FINSEQ_1:def 4;
consider f being (Function of ( NAT ),(the carrier of W)) such that A23: ( Sum q ) = ( f . ( len q ) ) and A24: ( f . ( 0 ) ) = ( 0. W ) and A25: (for i being (Element of ( NAT )) holds (for w being (VECTOR of W) holds ((i < ( len q ) & w = ( q . ( i + 1 ) )) implies ( f . ( i + 1 ) ) = ( ( f . i ) + w )))) by RLVECT_1:def 12;
(( dom f ) = ( NAT ) & ( rng f ) c= (the carrier of W)) by FUNCT_2:def 1,RELAT_1:def 19;
then reconsider f9 = f as (Function of ( NAT ),(the carrier of V)) by A22,FUNCT_2:2,XBOOLE_1:1;
A26: (for i being (Element of ( NAT )) holds (for v being (VECTOR of V) holds ((i < ( len q9 ) & v = ( q9 . ( i + 1 ) )) implies ( f9 . ( i + 1 ) ) = ( ( f9 . i ) + v ))))
proof
let i being (Element of ( NAT ));
let v being (VECTOR of V);
assume that
A27: i < ( len q9 )
and
A28: v = ( q9 . ( i + 1 ) );
(1 <= ( i + 1 ) & ( i + 1 ) <= ( len q )) by A27,NAT_1:11,NAT_1:13;
then ( i + 1 ) in ( dom q ) by FINSEQ_3:25;
then reconsider v9 = v as (VECTOR of W) by A28,FINSEQ_2:11;
( f . ( i + 1 ) ) = ( ( f . i ) + v9 ) by A25,A27,A28;
hence thesis by RUSUB_1:6;
end;
A29: ( len G ) = ( len F ) by A18,FINSEQ_2:44;
then A30: ( dom G ) = ( dom F ) by FINSEQ_3:29;
( len G ) = ( len ( L (#) F ) ) by A29,RLVECT_2:def 7;
then A31: ( dom p ) = ( dom G ) by FINSEQ_3:29;
A32: ( dom q ) = ( dom ( K (#) G ) ) by A20,FINSEQ_3:29;
now
let i being Nat;
set v = ( F /. i );
set j = ( P . i );
A33: i in ( NAT ) by ORDINAL1:def 12;
assume A34: i in ( dom p );
then A35: ( F /. i ) = ( F . i ) by A31,A30,PARTFUN1:def 6;
then v in ( rng F ) by A31,A30,A34,FUNCT_1:def 3;
then reconsider w = v as (VECTOR of W) by A17,A11;
(( dom P ) = ( dom G ) & ( rng P ) = ( dom G )) by FUNCT_2:52,FUNCT_2:def 3;
then A36: j in ( dom G ) by A31,A34,FUNCT_1:def 3;
then j in ( Seg ( card G ) ) by FINSEQ_1:def 3;
then reconsider j as (Element of ( NAT ));
A37: ( G /. j ) = ( G . ( P . i ) ) by A36,PARTFUN1:def 6
.= v by A18,A31,A30,A34,A35,FUNCT_1:12;
( q . i ) = ( ( K (#) G ) . j ) by A31,A21,A34,FUNCT_1:12
.= ( ( K . w ) * w ) by A32,A21,A36,A37,RLVECT_2:def 7
.= ( ( L . v ) * w ) by A2,A3,FUNCT_1:47
.= ( ( L . v ) * v ) by RUSUB_1:7;
hence ( p . i ) = ( q . i ) by A34,A33,RLVECT_2:def 7;
end;
then A38: ( L (#) F ) = ( ( K (#) G ) * P ) by A31,A21,FINSEQ_1:13;
( len G ) = ( len ( K (#) G ) ) by RLVECT_2:def 7;
then ( dom G ) = ( dom ( K (#) G ) ) by FINSEQ_3:29;
then reconsider P as (Permutation of ( dom ( K (#) G ) ));
q = ( ( K (#) G ) * P );
then A39: ( Sum ( K (#) G ) ) = ( Sum q ) by RLVECT_2:7;
A40: ( f9 . ( len q9 ) ) is (Element of V);
( f9 . ( 0 ) ) = ( 0. V ) by A24,RUSUB_1:4;
hence thesis by A7,A16,A12,A9,A38,A39,A23,A26,A40,RLVECT_1:def 12,XBOOLE_0:def 10;
end;
