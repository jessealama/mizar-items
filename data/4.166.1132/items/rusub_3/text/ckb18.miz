environ
vocabularies BHSP_1,SUBSET_1,RLVECT_3,STRUCT_0,RLSUB_1,CARD_3,RLVECT_2,TARSKI,RLVECT_1,ARYTM_3,REAL_1,RELAT_1,SUPINF_2,CARD_1,FUNCT_1,NUMBERS,FUNCT_2,FINSET_1,XBOOLE_0,ZFMISC_1,ORDINAL1,ORDERS_1,ARYTM_1,FINSEQ_1,VALUED_1,NAT_1,ORDINAL4,CLASSES1,XXREAL_0,PARTFUN1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,REAL_1,NAT_1,FINSEQ_1,RELAT_1,ORDINAL1,FUNCT_1,PARTFUN1,FUNCT_2,ORDERS_1,DOMAIN_1,STRUCT_0,RLVECT_1,FINSET_1,RLSUB_1,RLVECT_2,BHSP_1,RLVECT_3,RUSUB_1,RUSUB_2,CLASSES1,XXREAL_0,CKB1;
definitions XBOOLE_0,RLVECT_2,TARSKI,RLVECT_3,RLSUB_1,RLVECT_1,CKB1;
theorems FUNCT_1,FUNCT_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSET_1,ORDERS_1,RLSUB_2,RLVECT_1,RLVECT_2,TARSKI,ZFMISC_1,RELAT_1,ORDINAL1,XBOOLE_0,XBOOLE_1,RUSUB_1,RUSUB_2,RLVECT_3,ENUMSET1,RLVECT_4,RFINSEQ,NAT_1,SUBSET_1,XCMPLX_0,XCMPLX_1,CARD_2,STRUCT_0,PARTFUN1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17;
schemes FUNCT_1,FUNCT_2,NAT_1,XBOOLE_0,RLVECT_4;
registrations SUBSET_1,ORDINAL1,RELSET_1,FUNCT_2,FINSET_1,NUMBERS,MEMBERED,FINSEQ_1,STRUCT_0,RLVECT_3,BHSP_1,RUSUB_1,CARD_1,RLVECT_2;
constructors PARTFUN1,XXREAL_0,REAL_1,NAT_1,ORDERS_1,REALSET1,RFINSEQ,RLVECT_2,RLVECT_3,CLASSES1,RUSUB_2,RELSET_1,CKB1;
requirements NUMERALS,BOOLE,SUBSET,ARITHM;
begin
theorem
Th12: (for V being RealUnitarySpace holds (for A being (Subset of V) holds (( Lin A ) = V implies (ex B being (Subset of V) st ((B c= A & B is  linearly-independent) & ( Lin B ) = V)))))
proof
let V being RealUnitarySpace;
let A being (Subset of V);
assume A1: ( Lin A ) = V;
defpred P[ set ]
 means
(ex B being (Subset of V) st ((B = $1 & B c= A) & B is  linearly-independent));
consider Q being set such that A2: (for Z being set holds (Z in Q iff (Z in ( bool (the carrier of V) ) & P[ Z ]))) from XBOOLE_0:sch 1;
A3:now
let Z being set;
assume that
Z <> ( {} )
and
A4: Z c= Q
and
A5: Z is  c=-linear;
set W = ( union Z );
W c= (the carrier of V)
proof
let x being set;
assume x in W;
then consider X being set such that A6: x in X and A7: X in Z by TARSKI:def 4;
X in ( bool (the carrier of V) ) by A2,A4,A7;
hence thesis by A6;
end;
then reconsider W as (Subset of V);
A8: W is  linearly-independent
proof
deffunc F(set) = { C where C is (Subset of V): ($1 in C & C in Z) };
let l being (Linear_Combination of W);
assume that
A9: ( Sum l ) = ( 0. V )
and
A10: ( Carrier l ) <> ( {} );
consider f being Function such that A11: ( dom f ) = ( Carrier l ) and A12: (for x being set holds (x in ( Carrier l ) implies ( f . x ) = F(x))) from FUNCT_1:sch 3;
reconsider M = ( rng f ) as non  empty set by A10,A11,RELAT_1:42;
set F = the (Choice_Function of M);
set S = ( rng F );
A13:now
assume ( {} ) in M;
then consider x being set such that A14: x in ( dom f ) and A15: ( f . x ) = ( {} ) by FUNCT_1:def 3;
( Carrier l ) c= W by RLVECT_2:def 6;
then consider X being set such that A16: x in X and A17: X in Z by A11,A14,TARSKI:def 4;
reconsider X as (Subset of V) by A2,A4,A17;
X in { C where C is (Subset of V): (x in C & C in Z) } by A16,A17;
hence contradiction by A11,A12,A14,A15;
end;
then A18: ( dom F ) = M by RLVECT_3:28;
then ( dom F ) is  finite by A11,FINSET_1:8;
then A19: S is  finite by FINSET_1:8;
A20:now
let X being set;
assume X in S;
then consider x being set such that A21: x in ( dom F ) and A22: ( F . x ) = X by FUNCT_1:def 3;
consider y being set such that A23: (y in ( dom f ) & ( f . y ) = x) by A18,A21,FUNCT_1:def 3;
A24: x = { C where C is (Subset of V): (y in C & C in Z) } by A11,A12,A23;
X in x by A13,A18,A21,A22,ORDERS_1:def 1;
then (ex C being (Subset of V) st ((C = X & y in C) & C in Z)) by A24;
hence X in Z;
end;
A25:now
let X being set;
let Y being set;
assume (X in S & Y in S);
then (X in Z & Y in Z) by A20;
then X,Y are_c=-comparable  by A5,ORDINAL1:def 8;
hence (X c= Y or Y c= X) by XBOOLE_0:def 9;
end;
S <> ( {} ) by A18,RELAT_1:42;
then ( union S ) in S by A25,A19,CARD_2:62;
then ( union S ) in Z by A20;
then consider B being (Subset of V) such that A26: B = ( union S ) and B c= A and A27: B is  linearly-independent by A2,A4;
( Carrier l ) c= ( union S )
proof
let x being set;
set X = ( f . x );
assume A28: x in ( Carrier l );
then A29: ( f . x ) = { C where C is (Subset of V): (x in C & C in Z) } by A12;
A30: ( f . x ) in M by A11,A28,FUNCT_1:def 3;
then ( F . X ) in X by A13,ORDERS_1:def 1;
then A31: (ex C being (Subset of V) st ((( F . X ) = C & x in C) & C in Z)) by A29;
( F . X ) in S by A18,A30,FUNCT_1:def 3;
hence thesis by A31,TARSKI:def 4;
end;
then l is (Linear_Combination of B) by A26,RLVECT_2:def 6;
hence thesis by A9,A10,A27,RLVECT_3:def 1;
end;
W c= A
proof
let x being set;
assume x in W;
then consider X being set such that A32: x in X and A33: X in Z by TARSKI:def 4;
(ex B being (Subset of V) st ((B = X & B c= A) & B is  linearly-independent)) by A2,A4,A33;
hence thesis by A32;
end;
hence ( union Z ) in Q by A2,A8;
end;
(( {} (the carrier of V) ) c= A & ( {} (the carrier of V) ) is  linearly-independent) by RLVECT_3:7,XBOOLE_1:2;
then Q <> ( {} ) by A2;
then consider X being set such that A34: X in Q and A35: (for Z being set holds ((Z in Q & Z <> X) implies (not X c= Z))) by A3,ORDERS_1:67;
consider B being (Subset of V) such that A36: B = X and A37: B c= A and A38: B is  linearly-independent by A2,A34;
take B;
thus (B c= A & B is  linearly-independent) by A37,A38;
assume A39: ( Lin B ) <> V;
now
assume A40: (for v being (VECTOR of V) holds (v in A implies v in ( Lin B )));
now
reconsider F = (the carrier of ( Lin B )) as (Subset of V) by RUSUB_1:def 1;
let v being (VECTOR of V);
assume v in ( Lin A );
then consider l being (Linear_Combination of A) such that A41: v = ( Sum l ) by CKB2:1;
( Carrier l ) c= (the carrier of ( Lin B ))
proof
let x being set;
assume A42: x in ( Carrier l );
then reconsider a = x as (VECTOR of V);
( Carrier l ) c= A by RLVECT_2:def 6;
then a in ( Lin B ) by A40,A42;
hence thesis by STRUCT_0:def 5;
end;
then reconsider l as (Linear_Combination of F) by RLVECT_2:def 6;
( Sum l ) = v by A41;
then v in ( Lin F ) by CKB2:1;
hence v in ( Lin B ) by CKB7:1;
end;
then ( Lin A ) is (Subspace of ( Lin B )) by RUSUB_1:23;
hence contradiction by A1,A39,RUSUB_1:20;
end;
then consider v being (VECTOR of V) such that A43: v in A and A44: (not v in ( Lin B ));
A45: ( B \/ { v } ) is  linearly-independent
proof
let l being (Linear_Combination of ( B \/ { v } ));
assume A46: ( Sum l ) = ( 0. V );
now
per cases ;
suppose v in ( Carrier l );

then A47: ( - ( l . v ) ) <> ( 0 ) by RLVECT_2:19;
deffunc G(set) = ( 0 );
deffunc F((VECTOR of V)) = ( l . $1 );
consider f being (Function of (the carrier of V),( REAL )) such that A48: ( f . v ) = ( 0 ) and A49: (for u being (VECTOR of V) holds (u <> v implies ( f . u ) = F(u))) from FUNCT_2:sch 6;
reconsider f as (Element of ( Funcs ((the carrier of V),( REAL )) )) by FUNCT_2:8;
now
let u being (VECTOR of V);
assume (not u in ( ( Carrier l ) \ { v } ));
then ((not u in ( Carrier l )) or u in { v }) by XBOOLE_0:def 5;
then ((( l . u ) = ( 0 ) & u <> v) or u = v) by TARSKI:def 1;
hence ( f . u ) = ( 0 ) by A48,A49;
end;
then reconsider f as (Linear_Combination of V) by RLVECT_2:def 3;
( Carrier f ) c= B
proof
let x being set;
A50: ( Carrier l ) c= ( B \/ { v } ) by RLVECT_2:def 6;
assume x in ( Carrier f );
then consider u being (VECTOR of V) such that A51: u = x and A52: ( f . u ) <> ( 0 );
( f . u ) = ( l . u ) by A48,A49,A52;
then u in ( Carrier l ) by A52;
then (u in B or u in { v }) by A50,XBOOLE_0:def 3;
hence thesis by A48,A51,A52,TARSKI:def 1;
end;
then reconsider f as (Linear_Combination of B) by RLVECT_2:def 6;
consider g being (Function of (the carrier of V),( REAL )) such that A53: ( g . v ) = ( - ( l . v ) ) and A54: (for u being (VECTOR of V) holds (u <> v implies ( g . u ) = G(u))) from FUNCT_2:sch 6;
reconsider g as (Element of ( Funcs ((the carrier of V),( REAL )) )) by FUNCT_2:8;
now
let u being (VECTOR of V);
assume (not u in { v });
then u <> v by TARSKI:def 1;
hence ( g . u ) = ( 0 ) by A54;
end;
then reconsider g as (Linear_Combination of V) by RLVECT_2:def 3;
( Carrier g ) c= { v }
proof
let x being set;
assume x in ( Carrier g );
then (ex u being (VECTOR of V) st (x = u & ( g . u ) <> ( 0 )));
then x = v by A54;
hence thesis by TARSKI:def 1;
end;
then reconsider g as (Linear_Combination of { v }) by RLVECT_2:def 6;
A55: ( Sum g ) = ( ( - ( l . v ) ) * v ) by A53,RLVECT_2:32;
( f - g ) = l
proof
let u being (VECTOR of V);
now
per cases ;
suppose A56: v = u;

thus ( ( f - g ) . u ) = ( ( f . u ) - ( g . u ) ) by RLVECT_2:54
.= ( l . u ) by A48,A53,A56;
end;
suppose A57: v <> u;

thus ( ( f - g ) . u ) = ( ( f . u ) - ( g . u ) ) by RLVECT_2:54
.= ( ( l . u ) - ( g . u ) ) by A49,A57
.= ( ( l . u ) - ( 0 ) ) by A54,A57
.= ( l . u );
end;
end;
hence thesis;
end;
then ( 0. V ) = ( ( Sum f ) - ( Sum g ) ) by A46,RLVECT_3:4;
then ( Sum f ) = ( ( 0. V ) + ( Sum g ) ) by RLSUB_2:61
.= ( ( - ( l . v ) ) * v ) by A55,RLVECT_1:4;
then A58: ( ( - ( l . v ) ) * v ) in ( Lin B ) by CKB2:1;
( ( ( - ( l . v ) ) " ) * ( ( - ( l . v ) ) * v ) ) = ( ( ( ( - ( l . v ) ) " ) * ( - ( l . v ) ) ) * v ) by RLVECT_1:def 7
.= ( 1 * v ) by A47,XCMPLX_0:def 7
.= v by RLVECT_1:def 8;
hence thesis by A44,A58,RUSUB_1:15;
end;
suppose A59: (not v in ( Carrier l ));

( Carrier l ) c= B
proof
let x being set;
assume A60: x in ( Carrier l );
( Carrier l ) c= ( B \/ { v } ) by RLVECT_2:def 6;
then (x in B or x in { v }) by A60,XBOOLE_0:def 3;
hence thesis by A59,A60,TARSKI:def 1;
end;
then l is (Linear_Combination of B) by RLVECT_2:def 6;
hence thesis by A38,A46,RLVECT_3:def 1;
end;
end;
hence thesis;
end;
{ v } c= A by A43,ZFMISC_1:31;
then ( B \/ { v } ) c= A by A37,XBOOLE_1:8;
then A61: ( B \/ { v } ) in Q by A2,A45;
v in { v } by TARSKI:def 1;
then A62: v in ( B \/ { v } ) by XBOOLE_0:def 3;
(not v in B) by A44,CKB3:1;
hence contradiction by A35,A36,A62,A61,XBOOLE_1:7;
end;
