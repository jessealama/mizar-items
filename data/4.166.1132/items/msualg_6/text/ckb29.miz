environ
vocabularies NUMBERS,XBOOLE_0,MSUALG_1,SUBSET_1,FUNCT_1,PBOOLE,MEMBER_1,RELAT_1,STRUCT_0,CARD_3,MARGREL1,PARTFUN1,MOD_4,MSUALG_3,NAT_1,FUNCT_4,RLTOPSP1,TARSKI,REWRITE1,FUNCOP_1,FINSEQ_1,ARYTM_3,FUNCT_7,CARD_1,XXREAL_0,ORDINAL4,MSUALG_4,CIRCUIT2,MCART_1,ZFMISC_1,EQREL_1,RELAT_2,MSUALG_5,MSUALG_6;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,NAT_1,MCART_1,STRUCT_0,RELAT_1,RELAT_2,RELSET_1,EQREL_1,REWRITE1,FUNCT_1,PBOOLE,PARTFUN1,FUNCT_2,FINSEQ_1,CARD_3,FUNCOP_1,MSUALG_1,MSUALG_3,MSUALG_4,MSUALG_5,FUNCT_7,XXREAL_0,CKB1,CKB2,CKB5,CKB9,CKB13,CKB14,CKB18,CKB20,CKB25;
definitions TARSKI,RELAT_1,REWRITE1,FUNCT_1,PBOOLE,MSUALG_3,MSUALG_4,FUNCT_7,FUNCOP_1,CKB5,CKB9,CKB14,CKB18,CKB20,CKB25;
theorems TARSKI,NAT_1,MCART_1,ZFMISC_1,RELAT_1,RELSET_1,EQREL_1,FUNCT_1,FINSEQ_1,FINSEQ_3,FUNCT_2,CARD_3,FUNCT_7,REWRITE1,PBOOLE,PRALG_2,MSUALG_3,MSUALG_4,MSUALG_5,FINSEQ_5,XBOOLE_0,PARTFUN1,RELAT_2,ORDERS_1,XREAL_1,XXREAL_0,ORDINAL1,CKB3,CKB4,CKB5,CKB6,CKB9,CKB10,CKB11,CKB12,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28;
schemes NAT_1,RECDEF_1,RELSET_1,FUNCT_1,FINSEQ_1,CARD_3,CLASSES1,PBOOLE,PUA2MSS1;
registrations XBOOLE_0,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,PBOOLE,REWRITE1,FUNCT_7,STRUCT_0,MSUALG_1,MSUALG_3,MSUALG_4,MSUALG_5,ORDINAL1,CARD_1,RELSET_1,CKB7,CKB8;
constructors XXREAL_0,NAT_1,NAT_D,REWRITE1,FUNCT_7,MSUALG_3,MSUALG_5,RELSET_1,CKB2,CKB5,CKB9,CKB13,CKB14,CKB18,CKB20,CKB25;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve S for non  empty non  void ManySortedSign;
reserve A for  non-empty MSAlgebra over S;
theorem
Th18: (for s1,s2,s3 being (SortSymbol of S) holds ((( TranslationRel S ) reduces s1,s2 & ( TranslationRel S ) reduces s2,s3) implies (for t1 being (Translation of A,s1,s2) holds (for t2 being (Translation of A,s2,s3) holds ( t2 * t1 ) is (Translation of A,s1,s3)))))
proof
let s1 being (SortSymbol of S);
let s2 being (SortSymbol of S);
let s3 being (SortSymbol of S);
assume that
A1: ( TranslationRel S ) reduces s1,s2
and
A2: ( TranslationRel S ) reduces s2,s3;
let t1 being (Translation of A,s1,s2);
let t2 being (Translation of A,s2,s3);
thus ( TranslationRel S ) reduces s1,s3 by A1,A2,REWRITE1:16;
consider q1 being (RedSequence of ( TranslationRel S )),p1 being  Function-yielding FinSequence such that A3: t1 = ( compose (p1,( (the Sorts of A) . s1 )) ) and A4: ( len q1 ) = ( ( len p1 ) + 1 ) and A5: s1 = ( q1 . 1 ) and A6: s2 = ( q1 . ( len q1 ) ) and A7: (for i being (Element of ( NAT )) holds (for f being Function holds (for s1,s2 being (SortSymbol of S) holds ((((i in ( dom p1 ) & f = ( p1 . i )) & s1 = ( q1 . i )) & s2 = ( q1 . ( i + 1 ) )) implies f is_e.translation_of A,s1,s2)))) by A1,CKB25:def 1;
consider q2 being (RedSequence of ( TranslationRel S )),p2 being  Function-yielding FinSequence such that A8: t2 = ( compose (p2,( (the Sorts of A) . s2 )) ) and A9: ( len q2 ) = ( ( len p2 ) + 1 ) and A10: s2 = ( q2 . 1 ) and A11: s3 = ( q2 . ( len q2 ) ) and A12: (for i being (Element of ( NAT )) holds (for f being Function holds (for s1,s2 being (SortSymbol of S) holds ((((i in ( dom p2 ) & f = ( p2 . i )) & s1 = ( q2 . i )) & s2 = ( q2 . ( i + 1 ) )) implies f is_e.translation_of A,s1,s2)))) by A2,CKB25:def 1;
reconsider q = ( q1 $^ q2 ) as (RedSequence of ( TranslationRel S )) by A6,A10,REWRITE1:8;
take q;
take p = ( p1 ^ p2 );
( rng t1 ) c= ( (the Sorts of A) . s2 ) by RELAT_1:def 19;
hence ( t2 * t1 ) = ( compose (p,( (the Sorts of A) . s1 )) ) by A3,A8,FUNCT_7:48;
A13: ( len p ) = ( ( len p1 ) + ( len p2 ) ) by FINSEQ_1:22;
consider x2 being set,r2 being FinSequence such that A14: q2 = ( <* x2 *> ^ r2 ) and ( len q2 ) = ( ( len r2 ) + 1 ) by REWRITE1:5;
A15: x2 = s2 by A10,A14,FINSEQ_1:41;
consider r1 being FinSequence,x1 being set such that A16: q1 = ( r1 ^ <* x1 *> ) by FINSEQ_1:46;
A17: q = ( r1 ^ q2 ) by A16,REWRITE1:2;
( len <* x1 *> ) = 1 by FINSEQ_1:40;
then A18: ( len q1 ) = ( ( len r1 ) + 1 ) by A16,FINSEQ_1:22;
then A19: ( len q ) = ( ( len p1 ) + ( len q2 ) ) by A4,A17,FINSEQ_1:22;
hence ( len q ) = ( ( len p ) + 1 ) by A9,A13;
x1 = s2 by A6,A16,A18,FINSEQ_1:42;
then A20: q = ( q1 ^ r2 ) by A16,A14,A17,A15,FINSEQ_1:32;
(1 <= ( len r1 ) or ( ( 0 ) + 1 ) > ( len r1 ));
then A21: ((1 in ( Seg ( len r1 ) ) & ( Seg ( len r1 ) ) = ( dom r1 )) or (( 0 ) <= ( len r1 ) & ( 0 ) >= ( len r1 ))) by FINSEQ_1:1,FINSEQ_1:def 3,NAT_1:13;
then A22: ((( q . 1 ) = ( r1 . 1 ) & ( r1 . 1 ) = ( q1 . 1 )) or (r1 = ( {} ) & ( ( {} ) ^ q2 ) = q2)) by A16,A17,FINSEQ_1:34,FINSEQ_1:def 7;
((( q . 1 ) = ( r1 . 1 ) & ( r1 . 1 ) = ( q1 . 1 )) or (( len r1 ) = ( 0 ) & ( ( {} ) ^ q2 ) = q2)) by A16,A17,A21,FINSEQ_1:34,FINSEQ_1:def 7;
hence s1 = ( q . 1 ) by A5,A6,A10,A16,A18,A22,REWRITE1:2;
( len q2 ) in ( dom q2 ) by FINSEQ_5:6;
hence s3 = ( q . ( len q ) ) by A4,A11,A18,A17,A19,FINSEQ_1:def 7;
let i being (Element of ( NAT ));
let f being Function;
let s1 being (SortSymbol of S);
let s2 being (SortSymbol of S);
assume that
A23: i in ( dom p )
and
A24: f = ( p . i )
and
A25: s1 = ( q . i )
and
A26: s2 = ( q . ( i + 1 ) );
per cases ;
suppose A27: i in ( dom p1 );

then ( i + 1 ) in ( dom q1 ) by A4,FUNCT_7:22;
then A28: s2 = ( q1 . ( i + 1 ) ) by A20,A26,FINSEQ_1:def 7;
i in ( dom q1 ) by A4,A27,FUNCT_7:22;
then A29: s1 = ( q1 . i ) by A20,A25,FINSEQ_1:def 7;
f = ( p1 . i ) by A24,A27,FINSEQ_1:def 7;
hence thesis by A7,A27,A29,A28;
end;
suppose (not i in ( dom p1 ));

then (not (i <= ( len p1 ) & i >= 1)) by FINSEQ_3:25;
then i >= ( ( len p1 ) + 1 ) by A23,FINSEQ_3:25,NAT_1:13;
then consider k being Nat such that A30: i = ( ( ( len p1 ) + 1 ) + k ) by NAT_1:10;
A31: ( ( len p1 ) + ( ( k + 1 ) + 1 ) ) = ( i + 1 ) by A30;
A32: ( k + 1 ) >= 1 by NAT_1:11;
A33: i = ( ( len p1 ) + ( 1 + k ) ) by A30;
i <= ( len p ) by A23,FINSEQ_3:25;
then ( k + 1 ) <= ( len p2 ) by A13,A33,XREAL_1:6;
then A34: ( k + 1 ) in ( dom p2 ) by A32,FINSEQ_3:25;
then ( k + 1 ) in ( dom q2 ) by A9,FUNCT_7:22;
then A35: s1 = ( q2 . ( k + 1 ) ) by A4,A18,A17,A25,A33,FINSEQ_1:def 7;
( ( k + 1 ) + 1 ) in ( dom q2 ) by A9,A34,FUNCT_7:22;
then A36: s2 = ( q2 . ( ( k + 1 ) + 1 ) ) by A4,A18,A17,A26,A31,FINSEQ_1:def 7;
f = ( p2 . ( k + 1 ) ) by A24,A33,A34,FINSEQ_1:def 7;
hence thesis by A12,A34,A35,A36;
end;
end;
