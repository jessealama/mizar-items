environ
vocabularies NUMBERS,XBOOLE_0,MSUALG_1,SUBSET_1,FUNCT_1,PBOOLE,MEMBER_1,RELAT_1,STRUCT_0,CARD_3,MARGREL1,PARTFUN1,MOD_4,MSUALG_3,NAT_1,FUNCT_4,RLTOPSP1,TARSKI,REWRITE1,FUNCOP_1,FINSEQ_1,ARYTM_3,FUNCT_7,CARD_1,XXREAL_0,ORDINAL4,MSUALG_4,CIRCUIT2,MCART_1,ZFMISC_1,EQREL_1,RELAT_2,MSUALG_5,MSUALG_6;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,NAT_1,MCART_1,STRUCT_0,RELAT_1,RELAT_2,RELSET_1,EQREL_1,REWRITE1,FUNCT_1,PBOOLE,PARTFUN1,FUNCT_2,FINSEQ_1,CARD_3,FUNCOP_1,MSUALG_1,MSUALG_3,MSUALG_4,MSUALG_5,FUNCT_7,XXREAL_0,CKB1,CKB2,CKB5,CKB9,CKB13,CKB14,CKB18,CKB20,CKB25,CKB39,CKB40,CKB41,CKB49;
definitions TARSKI,RELAT_1,REWRITE1,FUNCT_1,PBOOLE,MSUALG_3,MSUALG_4,FUNCT_7,FUNCOP_1,CKB5,CKB9,CKB14,CKB18,CKB20,CKB25,CKB39,CKB40,CKB41,CKB49;
theorems TARSKI,NAT_1,MCART_1,ZFMISC_1,RELAT_1,RELSET_1,EQREL_1,FUNCT_1,FINSEQ_1,FINSEQ_3,FUNCT_2,CARD_3,FUNCT_7,REWRITE1,PBOOLE,PRALG_2,MSUALG_3,MSUALG_4,MSUALG_5,FINSEQ_5,XBOOLE_0,PARTFUN1,RELAT_2,ORDERS_1,XREAL_1,XXREAL_0,ORDINAL1,CKB3,CKB4,CKB5,CKB6,CKB9,CKB10,CKB11,CKB12,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB49;
schemes NAT_1,RECDEF_1,RELSET_1,FUNCT_1,FINSEQ_1,CARD_3,CLASSES1,PBOOLE,PUA2MSS1,CKB32,CKB47,CKB48;
registrations XBOOLE_0,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,PBOOLE,REWRITE1,FUNCT_7,STRUCT_0,MSUALG_1,MSUALG_3,MSUALG_4,MSUALG_5,ORDINAL1,CARD_1,RELSET_1,CKB7,CKB8,CKB44,CKB45,CKB46,CKB50,CKB51;
constructors XXREAL_0,NAT_1,NAT_D,REWRITE1,FUNCT_7,MSUALG_3,MSUALG_5,RELSET_1,CKB2,CKB5,CKB9,CKB13,CKB14,CKB18,CKB20,CKB25,CKB39,CKB40,CKB41,CKB49;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve S for non  empty non  void ManySortedSign;
reserve A for  non-empty MSAlgebra over S;
reserve R for (ManySortedRelation of (the Sorts of A));
scheme MSRelCl { S() -> non  empty non  void ManySortedSign,A() ->  non-empty MSAlgebra over S(),P[set,set,set],R[set],R,Q() -> (ManySortedRelation of A()) } : ((R[ Q() ] & R() c= Q()) & (for P being (ManySortedRelation of A()) holds ((R[ P ] & R() c= P) implies Q() c= P)))
provided
A1: (for R being (ManySortedRelation of A()) holds (R[ R ] iff (for s1,s2 being (SortSymbol of S()) holds (for f being (Function of ( (the Sorts of A()) . s1 ),( (the Sorts of A()) . s2 )) holds (P[ f,s1,s2 ] implies (for a,b being set holds ([ a,b ] in ( R . s1 ) implies [ ( f . a ),( f . b ) ] in ( R . s2 ))))))))
and
A2: (for s1,s2,s3 being (SortSymbol of S()) holds (for f1 being (Function of ( (the Sorts of A()) . s1 ),( (the Sorts of A()) . s2 )) holds (for f2 being (Function of ( (the Sorts of A()) . s2 ),( (the Sorts of A()) . s3 )) holds ((P[ f1,s1,s2 ] & P[ f2,s2,s3 ]) implies P[ ( f2 * f1 ),s1,s3 ]))))
and
A3: (for s being (SortSymbol of S()) holds P[ ( id ( (the Sorts of A()) . s ) ),s,s ])
and
A4: (for s being (SortSymbol of S()) holds (for a,b being (Element of A(),s) holds ([ a,b ] in ( Q() . s ) iff (ex s9 being (SortSymbol of S()) st (ex f being (Function of ( (the Sorts of A()) . s9 ),( (the Sorts of A()) . s )) st (ex x,y being (Element of A(),s9) st (((P[ f,s9,s ] & [ x,y ] in ( R() . s9 )) & a = ( f . x )) & b = ( f . y ))))))))
proof
now
let s1 being (SortSymbol of S());
let s2 being (SortSymbol of S());
set R = Q();
let f being (Function of ( (the Sorts of A()) . s1 ),( (the Sorts of A()) . s2 ));
assume A5: P[ f,s1,s2 ];
let a being set;
let b being set;
assume A6: [ a,b ] in ( R . s1 );
then A7: b in ( (the Sorts of A()) . s1 ) by ZFMISC_1:87;
a in ( (the Sorts of A()) . s1 ) by A6,ZFMISC_1:87;
then consider s9 being (SortSymbol of S()),f9 being (Function of ( (the Sorts of A()) . s9 ),( (the Sorts of A()) . s1 )),x,y being (Element of A(),s9) such that A8: P[ f9,s9,s1 ] and A9: [ x,y ] in ( R() . s9 ) and A10: a = ( f9 . x ) and A11: b = ( f9 . y ) by A4,A6,A7;
A12: ( f . a ) = ( ( f * f9 ) . x ) by A10,FUNCT_2:15;
A13: ( f . b ) = ( ( f * f9 ) . y ) by A11,FUNCT_2:15;
P[ ( f * f9 ),s9,s2 ] by A2,A5,A8;
hence [ ( f . a ),( f . b ) ] in ( R . s2 ) by A4,A9,A12,A13;
end;
hence R[ Q() ] by A1;
thus R() c= Q()
proof
let i being set;
assume i in (the carrier of S());
then reconsider s = i as (SortSymbol of S());
( R() . s ) c= ( Q() . s )
proof
set f = ( id ( (the Sorts of A()) . s ) );
let x being set;
let y being set;
assume A14: [ x,y ] in ( R() . s );
then reconsider a = x,b = y as (Element of A(),s) by ZFMISC_1:87;
A15: ( f . b ) = b by FUNCT_1:17;
A16: P[ f,s,s ] by A3;
( f . a ) = a by FUNCT_1:17;
hence thesis by A4,A14,A16,A15;
end;
hence thesis;
end;

let P being (ManySortedRelation of A());
assume that
A17: R[ P ]
and
A18: R() c= P;
let i being set;
assume i in (the carrier of S());
then reconsider s = i as (SortSymbol of S());
( Q() . s ) c= ( P . s )
proof
let x being set;
let y being set;
assume A19: [ x,y ] in ( Q() . s );
then reconsider a = x,b = y as (Element of A(),s) by ZFMISC_1:87;
consider s9 being (SortSymbol of S()),f being (Function of ( (the Sorts of A()) . s9 ),( (the Sorts of A()) . s )),u,v being (Element of A(),s9) such that A20: P[ f,s9,s ] and A21: [ u,v ] in ( R() . s9 ) and A22: a = ( f . u ) and A23: b = ( f . v ) by A4,A19;
( R() . s9 ) c= ( P . s9 ) by A18,PBOOLE:def 2;
hence thesis by A1,A17,A20,A21,A22,A23;
end;
hence thesis;
end;
