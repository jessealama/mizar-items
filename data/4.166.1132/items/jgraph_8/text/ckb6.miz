environ
vocabularies NUMBERS,SUBSET_1,PRE_TOPC,EUCLID,XREAL_0,ORDINAL1,BORSUK_1,PCOMPS_1,TOPMETR,CARD_1,FINSEQ_1,XXREAL_0,ORDINAL4,FUNCT_1,ARYTM_3,RELAT_1,PARTFUN1,ORDINAL2,ARYTM_1,JGRAPH_6,CONVEX1,MCART_1,RLTOPSP1,REAL_1,TOPREALA,TARSKI,STRUCT_0,XXREAL_1,MEASURE5,XBOOLE_0,FCONT_2,METRIC_1,NAT_1,INT_1,COMPLEX1,XXREAL_2,RELAT_2,RCOMP_1,CONNSP_1,GRAPH_1,WEIERSTR,PSCOMP_1,GOBOARD1,GOBOARD4,TOPREAL1,BORSUK_2;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,FINSEQ_1,NAT_1,NAT_D,SEQ_1,SEQM_3,STRUCT_0,TOPREAL1,PRE_TOPC,GOBOARD1,GOBOARD4,TOPMETR,PCOMPS_1,COMPTS_1,WEIERSTR,METRIC_1,TBSP_1,RCOMP_1,UNIFORM1,INT_1,CONNSP_1,PSCOMP_1,RLVECT_1,RLTOPSP1,EUCLID,BORSUK_1,BORSUK_2,JGRAPH_6,TOPREALA,TOPALG_2;
definitions TARSKI,XBOOLE_0,RLTOPSP1,JORDAN1,TOPALG_2,EUCLID,TOPREALA,STRUCT_0;
theorems TARSKI,FUNCT_1,FINSEQ_1,NAT_1,SPPOL_1,FINSEQ_4,RELAT_1,FINSEQ_3,TOPREAL1,GOBOARD4,TOPREAL3,EUCLID,UNIFORM1,WEIERSTR,PRE_TOPC,TBSP_1,HEINE,COMPTS_1,TOPMETR,PSCOMP_1,BORSUK_1,RCOMP_1,FUNCT_2,XBOOLE_0,XBOOLE_1,TOPRNS_1,XCMPLX_1,JGRAPH_1,INT_1,XREAL_0,CONNSP_1,JORDAN2C,XREAL_1,BORSUK_2,TSEP_1,JGRAPH_6,JORDAN5B,FINSEQ_2,XXREAL_0,TOPS_2,PARTFUN1,XXREAL_1,XXREAL_2,SEQM_3,RLTOPSP1,CKB1,CKB2,CKB3;
schemes FINSEQ_1,NAT_1;
registrations XBOOLE_0,RELAT_1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,INT_1,FINSEQ_1,STRUCT_0,PRE_TOPC,BORSUK_1,EUCLID,TOPREAL1,BORSUK_2,JORDAN5A,TOPALG_2,MEMBERED,VALUED_0,FUNCT_2,XXREAL_2,RELSET_1,SPPOL_1,TOPMETR,FUNCT_1,CKB4,CKB5;
constructors REAL_1,NAT_1,COMPLEX1,RCOMP_1,BINARITH,CONNSP_1,COMPTS_1,TBSP_1,MONOID_0,TOPREAL1,GOBOARD1,GOBOARD4,JORDAN1,PSCOMP_1,WEIERSTR,UNIFORM1,JGRAPH_6,TOPALG_2,TOPREALA,SEQ_1,BORSUK_2,SEQM_3,NAT_D,XXREAL_2,FUNCSDOM,CONVEX1,RLTOPSP1;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve i for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
theorem
Th1: (for e being  positive  real number holds (for g being  continuous (Function of ( I[01] ),( TOP-REAL n )) holds (ex h being (FinSequence of ( REAL )) st (((((( h . 1 ) = ( 0 ) & ( h . ( len h ) ) = 1) & 5 <= ( len h )) & ( rng h ) c= (the carrier of ( I[01] ))) & h is  increasing) & (for i being (Element of ( NAT )) holds (for Q being (Subset of ( I[01] )) holds (for W being (Subset of ( Euclid n )) holds ((((1 <= i & i < ( len h )) & Q = [. ( h /. i ),( h /. ( i + 1 ) ) .]) & W = ( g .: Q )) implies ( diameter W ) < e))))))))
proof
1 in { r where r is Real: (( 0 ) <= r & r <= 1) };
then A1: 1 in [. ( 0 ),1 .] by RCOMP_1:def 1;
{ 1 } c= [. ( 0 ),1 .]
proof
let x being set;
assume x in { 1 };
hence thesis by A1,TARSKI:def 1;
end;
then A2: ( [. ( 0 ),1 .] \/ { 1 } ) = [. ( 0 ),1 .] by XBOOLE_1:12;
( Closed-Interval-TSpace (( 0 ),1) ) = ( TopSpaceMetr ( Closed-Interval-MSpace (( 0 ),1) ) ) by TOPMETR:def 7;
then A3: (the carrier of ( I[01] )) = (the carrier of ( Closed-Interval-MSpace (( 0 ),1) )) by TOPMETR:12,TOPMETR:20
.= [. ( 0 ),1 .] by TOPMETR:10;
let e being  positive  real number;
let g being  continuous (Function of ( I[01] ),( TOP-REAL n ));
reconsider e as  positive Real by XREAL_0:def 1;
reconsider f = g as (Function of ( Closed-Interval-MSpace (( 0 ),1) ),( Euclid n )) by UNIFORM1:10;
A4: ( e / 2 ) < e by XREAL_1:216;
A5: ( e / 2 ) > ( 0 ) by XREAL_1:215;
f is  uniformly_continuous by UNIFORM1:8;
then consider s1 being Real such that A6: ( 0 ) < s1 and A7: (for u1,u2 being (Element of ( Closed-Interval-MSpace (( 0 ),1) )) holds (( dist (u1,u2) ) < s1 implies ( dist (( f /. u1 ),( f /. u2 )) ) < ( e / 2 ))) by A5,UNIFORM1:def 1;
set s = ( min (s1,( 1 / 2 )) );
defpred P[ Nat,set ]
 means
$2 = ( ( s / 2 ) * ( $1 - 1 ) );
A8: ( 0 ) <= s by A6,XXREAL_0:20;
then reconsider j = [/ ( 2 / s ) \] as (Element of ( NAT )) by INT_1:53;
A9: ( 2 / s ) <= j by INT_1:def 7;
A10: s <= s1 by XXREAL_0:17;
A11: (for u1,u2 being (Element of ( Closed-Interval-MSpace (( 0 ),1) )) holds (( dist (u1,u2) ) < s implies ( dist (( f /. u1 ),( f /. u2 )) ) < ( e / 2 )))
proof
let u1 being (Element of ( Closed-Interval-MSpace (( 0 ),1) ));
let u2 being (Element of ( Closed-Interval-MSpace (( 0 ),1) ));
assume ( dist (u1,u2) ) < s;
then ( dist (u1,u2) ) < s1 by A10,XXREAL_0:2;
hence thesis by A7;
end;
A12: ( 2 / s ) <= [/ ( 2 / s ) \] by INT_1:def 7;
then ( ( 2 / s ) - j ) <= ( 0 ) by XREAL_1:47;
then ( 1 + ( ( 2 / s ) - j ) ) <= ( 1 + ( 0 ) ) by XREAL_1:6;
then A13: ( ( s / 2 ) * ( 1 + ( ( 2 / s ) - j ) ) ) <= ( ( s / 2 ) * 1 ) by A8,XREAL_1:64;
A14: (for k being Nat holds (k in ( Seg j ) implies (ex x st P[ k,x ])));
consider p being FinSequence such that A15: (( dom p ) = ( Seg j ) & (for k being Nat holds (k in ( Seg j ) implies P[ k,( p . k ) ]))) from FINSEQ_1:sch 1(A14);
A16: ( Seg ( len p ) ) = ( Seg j ) by A15,FINSEQ_1:def 3;
( rng ( p ^ <* 1 *> ) ) c= ( REAL )
proof
let y;
A17: ( len ( p ^ <* 1 *> ) ) = ( ( len p ) + 1 ) by FINSEQ_2:16;
assume y in ( rng ( p ^ <* 1 *> ) );
then consider x such that A18: x in ( dom ( p ^ <* 1 *> ) ) and A19: y = ( ( p ^ <* 1 *> ) . x ) by FUNCT_1:def 3;
reconsider nx = x as (Element of ( NAT )) by A18;
A20: ( dom ( p ^ <* 1 *> ) ) = ( Seg ( len ( p ^ <* 1 *> ) ) ) by FINSEQ_1:def 3;
then A21: 1 <= nx by A18,FINSEQ_1:1;
A22: 1 <= nx by A18,A20,FINSEQ_1:1;
A23: nx <= ( len ( p ^ <* 1 *> ) ) by A18,A20,FINSEQ_1:1;
per cases ;
suppose nx < ( ( len p ) + 1 );

then A24: nx <= ( len p ) by NAT_1:13;
then nx in ( Seg j ) by A16,A22,FINSEQ_1:1;
then A25: ( p . nx ) = ( ( s / 2 ) * ( nx - 1 ) ) by A15;
y = ( p . nx ) by A19,A21,A24,FINSEQ_1:64;
hence thesis by A25;
end;
suppose nx >= ( ( len p ) + 1 );

then nx = ( ( len p ) + 1 ) by A23,A17,XXREAL_0:1;
then y = 1 by A19,FINSEQ_1:42;
hence thesis;
end;
end;
then reconsider h1 = ( p ^ <* 1 *> ) as (FinSequence of ( REAL )) by FINSEQ_1:def 4;
A26: ( len h1 ) = ( ( len p ) + 1 ) by FINSEQ_2:16;
A27: ( len p ) = j by A15,FINSEQ_1:def 3;
A28: s <> ( 0 ) by A6,XXREAL_0:15;
then ( 2 / s ) >= ( 2 / ( 1 / 2 ) ) by A8,XREAL_1:118,XXREAL_0:17;
then 4 <= j by A9,XXREAL_0:2;
then A29: ( 4 + 1 ) <= ( ( len p ) + 1 ) by A27,XREAL_1:6;
A30: ( s / 2 ) > ( 0 ) by A8,A28,XREAL_1:215;
A31: (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((1 <= i & i < ( len p )) & r1 = ( p . i )) & r2 = ( p . ( i + 1 ) )) implies (r1 < r2 & ( r2 - r1 ) = ( s / 2 )))))
proof
let i being (Element of ( NAT ));
let r1 being Real;
let r2 being Real;
assume that
A32: (1 <= i & i < ( len p ))
and
A33: r1 = ( p . i )
and
A34: r2 = ( p . ( i + 1 ) );
(1 < ( i + 1 ) & ( i + 1 ) <= ( len p )) by A32,NAT_1:13;
then ( i + 1 ) in ( Seg j ) by A16,FINSEQ_1:1;
then A35: r2 = ( ( s / 2 ) * ( ( i + 1 ) - 1 ) ) by A15,A34;
i < ( i + 1 ) by NAT_1:13;
then A36: ( i - 1 ) < ( ( i + 1 ) - 1 ) by XREAL_1:9;
A37: i in ( Seg j ) by A16,A32,FINSEQ_1:1;
then r1 = ( ( s / 2 ) * ( i - 1 ) ) by A15,A33;
hence r1 < r2 by A30,A35,A36,XREAL_1:68;
( r2 - r1 ) = ( ( ( s / 2 ) * i ) - ( ( s / 2 ) * ( i - 1 ) ) ) by A15,A33,A37,A35;
hence thesis;
end;
( 0 ) < s by A6,A28,XXREAL_0:20;
then ( 0 ) < j by A12,XREAL_1:139;
then A38: ( ( 0 ) + 1 ) <= j by NAT_1:13;
then 1 in ( Seg j ) by FINSEQ_1:1;
then ( p . 1 ) = ( ( s / 2 ) * ( 1 - 1 ) ) by A15
.= ( 0 );
then A39: ( h1 . 1 ) = ( 0 ) by A38,A27,CKB2:1;
( 2 * s ) <> ( 0 ) by A6,XXREAL_0:15;
then A40: (( ( s / 2 ) * ( 2 / s ) ) = ( ( 2 * s ) / ( 2 * s ) ) & ( ( 2 * s ) / ( 2 * s ) ) = 1) by XCMPLX_1:60,XCMPLX_1:76;
then A41: ( 1 - ( ( s / 2 ) * ( j - 1 ) ) ) = ( ( s / 2 ) * ( 1 + ( ( 2 / s ) - [/ ( 2 / s ) \] ) ) );
A42: (for r1 being Real holds (r1 = ( p . ( len p ) ) implies ( 1 - r1 ) <= ( s / 2 )))
proof
let r1 being Real;
assume A43: r1 = ( p . ( len p ) );
( len p ) in ( Seg j ) by A38,A27,FINSEQ_1:1;
hence thesis by A13,A15,A27,A41,A43;
end;
A44: (for i being (Element of ( NAT )) holds ((1 <= i & i < ( len h1 )) implies ( ( h1 /. ( i + 1 ) ) - ( h1 /. i ) ) <= ( s / 2 )))
proof
let i being (Element of ( NAT ));
assume that
A45: 1 <= i
and
A46: i < ( len h1 );
A47: ( i + 1 ) <= ( len h1 ) by A46,NAT_1:13;
A48: i <= ( len p ) by A26,A46,NAT_1:13;
A49: 1 < ( i + 1 ) by A45,NAT_1:13;
per cases ;
suppose A50: i < ( len p );

then ( i + 1 ) <= ( len p ) by NAT_1:13;
then A51: ( h1 . ( i + 1 ) ) = ( p . ( i + 1 ) ) by A49,FINSEQ_1:64;
A52: ( h1 . i ) = ( p . i ) by A45,A50,FINSEQ_1:64;
(( h1 . i ) = ( h1 /. i ) & ( h1 . ( i + 1 ) ) = ( h1 /. ( i + 1 ) )) by A45,A46,A47,A49,FINSEQ_4:15;
hence thesis by A31,A45,A50,A52,A51;
end;
suppose i >= ( len p );

then A53: i = ( len p ) by A48,XXREAL_0:1;
A54: ( h1 /. i ) = ( h1 . i ) by A45,A46,FINSEQ_4:15
.= ( p . i ) by A45,A48,FINSEQ_1:64;
( h1 /. ( i + 1 ) ) = ( h1 . ( i + 1 ) ) by A47,A49,FINSEQ_4:15
.= 1 by A53,FINSEQ_1:42;
hence thesis by A42,A53,A54;
end;
end;
[/ ( 2 / s ) \] < ( ( 2 / s ) + 1 ) by INT_1:def 7;
then ( [/ ( 2 / s ) \] - 1 ) < ( ( ( 2 / s ) + 1 ) - 1 ) by XREAL_1:9;
then A55: ( ( s / 2 ) * ( j - 1 ) ) < ( ( s / 2 ) * ( 2 / s ) ) by A30,XREAL_1:68;
A56: (for i being (Element of ( NAT )) holds (for r1 being Real holds (((1 <= i & i <= ( len p )) & r1 = ( p . i )) implies r1 < 1)))
proof
let i being (Element of ( NAT ));
let r1 being Real;
assume that
A57: 1 <= i
and
A58: i <= ( len p )
and
A59: r1 = ( p . i );
( i - 1 ) <= ( j - 1 ) by A27,A58,XREAL_1:9;
then A60: ( ( s / 2 ) * ( i - 1 ) ) <= ( ( s / 2 ) * ( j - 1 ) ) by A8,XREAL_1:64;
i in ( Seg j ) by A16,A57,A58,FINSEQ_1:1;
then r1 = ( ( s / 2 ) * ( i - 1 ) ) by A15,A59;
hence thesis by A55,A40,A60,XXREAL_0:2;
end;
A61: (for i being (Element of ( NAT )) holds ((1 <= i & i < ( len h1 )) implies ( h1 /. i ) < ( h1 /. ( i + 1 ) )))
proof
let i being (Element of ( NAT ));
assume that
A62: 1 <= i
and
A63: i < ( len h1 );
A64: ( i + 1 ) <= ( len h1 ) by A63,NAT_1:13;
A65: 1 < ( i + 1 ) by A62,NAT_1:13;
A66: i <= ( len p ) by A26,A63,NAT_1:13;
per cases ;
suppose A67: i < ( len p );

then ( i + 1 ) <= ( len p ) by NAT_1:13;
then A68: ( h1 . ( i + 1 ) ) = ( p . ( i + 1 ) ) by A65,FINSEQ_1:64;
A69: ( h1 . i ) = ( p . i ) by A62,A67,FINSEQ_1:64;
(( h1 . i ) = ( h1 /. i ) & ( h1 . ( i + 1 ) ) = ( h1 /. ( i + 1 ) )) by A62,A63,A64,A65,FINSEQ_4:15;
hence thesis by A31,A62,A67,A69,A68;
end;
suppose i >= ( len p );

then A70: i = ( len p ) by A66,XXREAL_0:1;
A71: ( h1 /. ( i + 1 ) ) = ( h1 . ( i + 1 ) ) by A64,A65,FINSEQ_4:15
.= 1 by A70,FINSEQ_1:42;
( h1 /. i ) = ( h1 . i ) by A62,A63,FINSEQ_4:15
.= ( p . i ) by A62,A66,FINSEQ_1:64;
hence thesis by A56,A62,A66,A71;
end;
end;
A72: ( dom g ) = (the carrier of ( I[01] )) by FUNCT_2:def 1;
A73: (for i being (Element of ( NAT )) holds (for Q being (Subset of ( I[01] )) holds (for W being (Subset of ( Euclid n )) holds ((((1 <= i & i < ( len h1 )) & Q = [. ( h1 /. i ),( h1 /. ( i + 1 ) ) .]) & W = ( g .: Q )) implies ( diameter W ) < e))))
proof
let i being (Element of ( NAT ));
let Q being (Subset of ( I[01] ));
let W being (Subset of ( Euclid n ));
assume that
A74: (1 <= i & i < ( len h1 ))
and
A75: Q = [. ( h1 /. i ),( h1 /. ( i + 1 ) ) .]
and
A76: W = ( g .: Q );
( h1 /. i ) < ( h1 /. ( i + 1 ) ) by A61,A74;
then A77: Q <> ( {} ) by A75,XXREAL_1:1;
A78: (for x,y being (Point of ( Euclid n )) holds ((x in W & y in W) implies ( dist (x,y) ) <= ( e / 2 )))
proof
let x being (Point of ( Euclid n ));
let y being (Point of ( Euclid n ));
assume that
A79: x in W
and
A80: y in W;
consider x3 being set such that A81: x3 in ( dom g ) and A82: x3 in Q and A83: x = ( g . x3 ) by A76,A79,FUNCT_1:def 6;
reconsider x3 as (Element of ( Closed-Interval-MSpace (( 0 ),1) )) by A81,CKB1:1,TOPMETR:12;
reconsider r3 = x3 as Real by A75,A82;
A84: ( ( h1 /. ( i + 1 ) ) - ( h1 /. i ) ) <= ( s / 2 ) by A44,A74;
consider y3 being set such that A85: y3 in ( dom g ) and A86: y3 in Q and A87: y = ( g . y3 ) by A76,A80,FUNCT_1:def 6;
reconsider y3 as (Element of ( Closed-Interval-MSpace (( 0 ),1) )) by A85,CKB1:1,TOPMETR:12;
reconsider s3 = y3 as Real by A75,A86;
A88: (( f . x3 ) = ( f /. x3 ) & ( f . y3 ) = ( f /. y3 ));
( abs ( r3 - s3 ) ) <= ( ( h1 /. ( i + 1 ) ) - ( h1 /. i ) ) by A75,A82,A86,UNIFORM1:12;
then ( abs ( r3 - s3 ) ) <= ( s / 2 ) by A84,XXREAL_0:2;
then A89: ( dist (x3,y3) ) <= ( s / 2 ) by HEINE:1;
( s / 2 ) < s by A8,A28,XREAL_1:216;
then ( dist (x3,y3) ) < s by A89,XXREAL_0:2;
hence thesis by A11,A83,A87,A88;
end;
then W is  bounded by A5,TBSP_1:def 7;
then ( diameter W ) <= ( e / 2 ) by A72,A76,A77,A78,TBSP_1:def 8;
hence thesis by A4,XXREAL_0:2;
end;
A90: ( rng p ) c= [. ( 0 ),1 .]
proof
let y being set;
assume y in ( rng p );
then consider x being set such that A91: x in ( dom p ) and A92: y = ( p . x ) by FUNCT_1:def 3;
reconsider nx = x as (Element of ( NAT )) by A91;
A93: ( p . nx ) = ( ( s / 2 ) * ( nx - 1 ) ) by A15,A91;
then reconsider ry = ( p . nx ) as Real;
A94: x in ( Seg ( len p ) ) by A91,FINSEQ_1:def 3;
then A95: 1 <= nx by FINSEQ_1:1;
then A96: ( nx - 1 ) >= ( 1 - 1 ) by XREAL_1:9;
nx <= ( len p ) by A94,FINSEQ_1:1;
then ry < 1 by A56,A95;
then y in { rs where rs is Real: (( 0 ) <= rs & rs <= 1) } by A8,A92,A93,A96;
hence thesis by RCOMP_1:def 1;
end;
( rng <* 1 *> ) = { 1 } by FINSEQ_1:38;
then ( rng h1 ) = ( ( rng p ) \/ { 1 } ) by FINSEQ_1:31;
then A97: ( rng h1 ) c= ( [. ( 0 ),1 .] \/ { 1 } ) by A90,XBOOLE_1:13;
( h1 . ( len h1 ) ) = 1 by A26,FINSEQ_1:42;
hence thesis by A26,A29,A39,A2,A97,A3,A61,A73,CKB3:1;
end;
