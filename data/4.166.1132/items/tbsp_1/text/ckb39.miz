environ
vocabularies NUMBERS,XBOOLE_0,METRIC_1,SUBSET_1,SETFAM_1,RELAT_2,FUNCT_1,REAL_1,CARD_1,ARYTM_3,XXREAL_0,POWER,RELAT_1,SEQ_1,SEQ_2,ORDINAL2,COMPLEX1,ARYTM_1,FINSET_1,STRUCT_0,TARSKI,NAT_1,BHSP_3,REWRITE1,ALI2,PRE_TOPC,PCOMPS_1,RCOMP_1,ZFMISC_1,ORDINAL1,XXREAL_2,XREAL_0,MEASURE5,FINSEQ_1,TBSP_1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XREAL_0,COMPLEX1,REAL_1,RELAT_1,ORDINAL1,FUNCT_1,RELSET_1,FINSEQ_1,DOMAIN_1,SETFAM_1,FUNCT_2,FINSET_1,NAT_1,STRUCT_0,PRE_TOPC,TOPS_2,SEQ_1,SEQ_2,COMPTS_1,METRIC_1,POWER,PCOMPS_1,ALI2,XXREAL_0,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB18,CKB19;
definitions COMPTS_1,TARSKI,ORDINAL1,XBOOLE_0,STRUCT_0,FINSET_1,CKB4,CKB7,CKB8,CKB9,CKB10,CKB18,CKB19;
theorems METRIC_1,SUBSET_1,FUNCT_1,PCOMPS_1,PRE_TOPC,MEMBERED,TOPS_2,TARSKI,COMPTS_1,NAT_1,SEQ_2,ZFMISC_1,POWER,SERIES_1,ABSVALUE,FUNCT_2,SETFAM_1,FINSEQ_1,ALI2,RELSET_1,XREAL_0,XBOOLE_0,XBOOLE_1,XCMPLX_1,FINSET_1,XREAL_1,XXREAL_0,ORDINAL1,RELAT_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB12,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB24,CKB25,CKB26,CKB27,CKB29,CKB30,CKB31,CKB32,CKB35,CKB36,CKB38;
schemes DOMAIN_1,SUBSET_1,NAT_1,SEQ_1,FINSET_1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,FINSEQ_1,STRUCT_0,METRIC_1,PCOMPS_1,CKB13,CKB20,CKB21,CKB22,CKB23,CKB28,CKB33,CKB34,CKB37;
constructors SETFAM_1,DOMAIN_1,XXREAL_0,REAL_1,NAT_1,COMPLEX1,FINSEQ_1,SEQ_2,POWER,TOPS_2,COMPTS_1,PCOMPS_1,ALI2,SEQ_1,VALUED_1,RELSET_1,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB18,CKB19;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve N for non  empty MetrStruct;
reserve C for (Subset of N);
reserve r for Real;
reserve s for Real;
reserve x for set;
reserve y for set;
definition
let N being  Reflexive non  empty MetrStruct;
let C being (Subset of N);
assume A1: C is  bounded;
func diameter C -> Real means 
:Def10: ((for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= it)) & (for s holds ((for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= s)) implies it <= s))) if C <> ( {} ) otherwise it = ( 0 );
consistency;
existence
proof
thus (C <> ( {} ) implies (ex r being Real st ((for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= r)) & (for s holds ((for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= s)) implies r <= s)))))
proof
set c = the (Element of C);
defpred X[ Real ]
 means
(for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= $1));
set I = { r: X[ r ] };
defpred X[ set ]
 means
(ex x,y being (Point of N) st ((x in C & y in C) & $1 = ( dist (x,y) )));
set J = { r: X[ r ] };
A2: (for a,b being  real number holds ((a in J & b in I) implies a <= b))
proof
let a being  real number;
let b being  real number;
assume (a in J & b in I);
then ((ex t being Real st (t = a & (ex x,y being (Point of N) st ((x in C & y in C) & t = ( dist (x,y) ))))) & (ex t9 being Real st (t9 = b & (for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= t9)))));
hence thesis;
end;
A3: J is (Subset of ( REAL )) from DOMAIN_1:sch 7;
assume A4: C <> ( {} );
then reconsider c as (Point of N) by TARSKI:def 3;
( dist (c,c) ) = ( 0 ) by METRIC_1:1;
then A5: ( 0 ) in J by A4;
reconsider J as (Subset of ( REAL )) by A3;
A6: I is (Subset of ( REAL )) from DOMAIN_1:sch 7;
consider r such that ( 0 ) < r and A7: (for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= r)) by A1,CKB19:def 1;
A8: r in I by A7;
reconsider I as (Subset of ( REAL )) by A6;
consider d being  real number such that A9: (for a being  real number holds (a in J implies a <= d)) and A10: (for b being  real number holds (b in I implies d <= b)) by A8,A5,A2,MEMBERED:37;
take d;
thus d is Real by XREAL_0:def 1;
thus (for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= d))
proof
let x being (Point of N);
let y being (Point of N);
assume (x in C & y in C);
then ( dist (x,y) ) in J;
hence thesis by A9;
end;

let s;
assume (for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= s));
then s in I;
hence thesis by A10;
end;

thus thesis;
end;
uniqueness
proof
let r1 being Real;
let r2 being Real;
hereby
assume C <> ( {} );
assume (((for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= r1)) & ((for s holds ((for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= s)) implies r1 <= s)) & (for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= r2)))) & (for s holds ((for x,y being (Point of N) holds ((x in C & y in C) implies ( dist (x,y) ) <= s)) implies r2 <= s)));
then (r1 <= r2 & r2 <= r1);
hence r1 = r2 by XXREAL_0:1;
end;
thus thesis;
end;
end;
