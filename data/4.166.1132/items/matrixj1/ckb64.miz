environ
vocabularies NUMBERS,NAT_1,VECTSP_1,SUBSET_1,XBOOLE_0,MATRIX_1,FINSEQ_1,ALGSTR_0,RELAT_1,ARYTM_3,TARSKI,STRUCT_0,ZFMISC_1,ORDINAL4,XXREAL_0,FUNCT_1,PARTFUN1,FINSEQ_3,CARD_1,ARYTM_1,FINSEQ_2,CARD_3,GROUP_1,RFINSEQ,TREES_1,INCSP_1,MATRIX_2,MATRIX_3,SUPINF_2,LAPLACE,MATRIX11,MESFUNC1,RVSUM_1,MATHMORP,VALUED_1,FVSUM_1,MATRIXJ1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,RELAT_1,FUNCT_1,PARTFUN1,FINSEQ_1,STRUCT_0,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,FVSUM_1,NAT_D,BINARITH,GROUP_4,MATRIX_3,MATRIX11,FINSEQOP,MATRIX13,LAPLACE,RFINSEQ,WSIERP_1,CKB7,CKB15,CKB17,CKB18,CKB20,CKB21,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB42,CKB43;
definitions TARSKI,FINSEQ_1,MATRIX_1,LAPLACE,MATRIX13,FVSUM_1,CKB7,CKB15,CKB27,CKB28,CKB42;
theorems CARD_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_5,FINSEQ_6,FINSEQOP,FUNCT_1,FVSUM_1,GROUP_1,GROUP_4,GOBOARD1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_9,MATRIX11,MATRIX13,MATRIX15,MATRIXR2,NAT_1,ORDINAL1,PARTFUN1,POLYNOM3,PRGCOR_1,RELAT_1,RFINSEQ,RLVECT_1,RVSUM_1,TARSKI,VECTSP_1,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,ZFMISC_1,MATRIX_4,FUNCT_2,FUNCOP_1,MATRIXR1,CARD_1,NAT_D,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB19,CKB22,CKB27,CKB28,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63;
schemes FINSEQ_1,FINSEQ_2,NAT_1,MATRIX_1;
registrations XBOOLE_0,FINSET_1,STRUCT_0,VECTSP_1,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,FINSEQ_2,MATRIX13,XREAL_0,VALUED_0,CARD_1,FVSUM_1,CKB16;
constructors XXREAL_0,GROUP_4,VECTSP_7,MATRIX11,MATRIX13,LAPLACE,RFINSEQ,POLYNOM1,WSIERP_1,SEQ_1,VALUED_0,VALUED_1,REAL_1,NAT_D,BINARITH,RELSET_1,FVSUM_1,CKB7,CKB15,CKB20,CKB21,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB42,CKB43;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve i for Nat;
reserve j for Nat;
reserve m for Nat;
reserve K for Field;
reserve a for (Element of K);
reserve A for (Matrix of K);
reserve G for (FinSequence_of_Matrix of K);
theorem
Th42: ((i in ( dom A ) & ( width A ) = ( width ( DelLine (A,i) ) )) implies ( DelLine (( block_diagonal (( G ^ <* A *> ),a) ),( ( Sum ( Len G ) ) + i )) ) = ( block_diagonal (( G ^ <* ( DelLine (A,i) ) *> ),a) ))
proof
assume that
A1: i in ( dom A )
and
A2: ( width A ) = ( width ( DelLine (A,i) ) );
A3: i in ( Seg ( len A ) ) by A1,FINSEQ_1:def 3;
set da = ( DelLine (A,i) );
consider m such that A4: ( len A ) = ( m + 1 ) and A5: ( len da ) = m by A1,FINSEQ_3:104;
set Si = ( ( Sum ( Len G ) ) + i );
set bG = ( block_diagonal (G,a) );
set DA = <* da *>;
set AA = <* A *>;
set BG = <* bG *>;
set bGA = ( block_diagonal (<* bG,A *>,a) );
set bGdA = ( block_diagonal (<* bG,da *>,a) );
A6: ( Seg ( len bGA ) ) = ( dom bGA ) by FINSEQ_1:def 3;
A7: ( len bGdA ) = ( Sum ( Len ( BG ^ DA ) ) ) by CKB42:def 1;
then A8: ( len bGdA ) = ( m + ( len bG ) ) by A5,CKB35:1;
A9: ( len bG ) = ( Sum ( Len G ) ) by CKB42:def 1;
A10: ( len bGA ) = ( Sum ( Len ( BG ^ AA ) ) ) by CKB42:def 1;
then A11: ( len bGA ) = ( ( len A ) + ( len bG ) ) by CKB35:1;
then A12: ( len bGA ) = ( ( m + ( len bG ) ) + 1 ) by A4;
A13: ( len bGdA ) = ( ( len da ) + ( len bG ) ) by A7,CKB35:1;
A14:now
( m + ( len bG ) ) <= ( len bGA ) by A12,NAT_1:11;
then A15: ( Seg ( m + ( len bG ) ) ) c= ( Seg ( len bGA ) ) by FINSEQ_1:5;
reconsider da9 = da as (Matrix of ( len da ),( width da ),K) by MATRIX_2:7;
reconsider A9 = A as (Matrix of ( len A ),( width A ),K) by MATRIX_2:7;
let j;
assume that
A16: 1 <= j
and
A17: j <= ( m + ( len bG ) );
A18: j in ( Seg ( m + ( len bG ) ) ) by A16,A17,FINSEQ_1:1;
A19: 1 <= ( 1 + j ) by NAT_1:11;
( j + 1 ) <= ( len bGA ) by A12,A17,XREAL_1:7;
then A20: ( j + 1 ) in ( Seg ( len bGA ) ) by A19;
now
per cases ;
suppose A21: j <= ( len bG );

then A22: j in ( dom bG ) by A16,FINSEQ_3:25;
( 0 ) < i by A3,FINSEQ_1:1;
then ( j + ( 0 ) ) < ( ( len bG ) + i ) by A21,XREAL_1:8;
then j < Si by CKB42:def 1;
hence ( ( Del (bGA,Si) ) . j ) = ( bGA . j ) by FINSEQ_3:110
.= ( Line (bGA,j) ) by A10,A18,A15,MATRIX_2:8
.= ( ( Line (bG,j) ) ^ ( ( width da ) |-> a ) ) by A2,A22,CKB45:1
.= ( Line (bGdA,j) ) by A22,CKB45:1
.= ( bGdA . j ) by A5,A7,A13,A18,MATRIX_2:8;
end;
suppose A23: j > ( len bG );

then reconsider jL = ( j - ( len bG ) ) as (Element of ( NAT )) by NAT_1:21;
A24: ( ( 0 ) + 1 ) <= ( jL + 1 ) by NAT_1:13;
( jL + ( len bG ) ) <= ( m + ( len bG ) ) by A17;
then A25: jL <= m by XREAL_1:8;
then A26: ( jL + 1 ) <= ( len A ) by A4,XREAL_1:7;
then A27: ( jL + 1 ) in ( dom A ) by A24,FINSEQ_3:25;
jL <> ( 0 ) by A23;
then A28: 1 <= jL by NAT_1:14;
then A29: jL in ( dom da ) by A5,A25,FINSEQ_3:25;
A30: ( jL + 1 ) in ( Seg ( len A ) ) by A24,A26;
A31: jL in ( Seg ( len da ) ) by A5,A28,A25;
A32: jL <= ( len A ) by A4,A25,NAT_1:13;
then A33: jL in ( Seg ( len A ) ) by A28;
A34: jL in ( dom A ) by A28,A32,FINSEQ_3:25;
now
per cases ;
suppose A35: j < Si;

then ( jL + ( len bG ) ) < ( i + ( len bG ) ) by CKB42:def 1;
then A36: jL < i by XREAL_1:7;
A37: ( Line (A,jL) ) = ( A9 . jL ) by A33,MATRIX_2:8
.= ( da9 . jL ) by A36,FINSEQ_3:110
.= ( Line (da,jL) ) by A31,MATRIX_2:8;
thus ( ( Del (bGA,Si) ) . j ) = ( bGA . j ) by A35,FINSEQ_3:110
.= ( Line (bGA,( jL + ( len bG ) )) ) by A10,A18,A15,MATRIX_2:8
.= ( ( ( width bG ) |-> a ) ^ ( Line (da,jL) ) ) by A34,A37,CKB45:1
.= ( Line (bGdA,( jL + ( len bG ) )) ) by A29,CKB45:1;
end;
suppose A38: j >= Si;

then ( jL + ( len bG ) ) >= ( i + ( len bG ) ) by CKB42:def 1;
then A39: jL >= i by XREAL_1:8;
A40: ( Line (A,( 1 + jL )) ) = ( A9 . ( 1 + jL ) ) by A30,MATRIX_2:8
.= ( da9 . jL ) by A1,A4,A25,A39,FINSEQ_3:111
.= ( Line (da,jL) ) by A31,MATRIX_2:8;
thus ( ( Del (bGA,Si) ) . j ) = ( bGA . ( j + 1 ) ) by A9,A11,A12,A3,A6,A17,A38,FINSEQ_1:60,FINSEQ_3:111
.= ( Line (bGA,( ( jL + 1 ) + ( len bG ) )) ) by A10,A20,MATRIX_2:8
.= ( ( ( width bG ) |-> a ) ^ ( Line (da,jL) ) ) by A27,A40,CKB45:1
.= ( Line (bGdA,( jL + ( len bG ) )) ) by A29,CKB45:1;
end;
end;
hence ( ( Del (bGA,Si) ) . j ) = ( bGdA . j ) by A5,A7,A13,A18,MATRIX_2:8;
end;
end;
hence ( ( Del (bGA,( i + ( Sum ( Len G ) ) )) ) . j ) = ( bGdA . j );
end;
A41: ( block_diagonal (( G ^ DA ),a) ) = bGdA by CKB57:1;
A42: ( block_diagonal (( G ^ AA ),a) ) = bGA by CKB57:1;
( len ( Del (bGA,Si) ) ) = ( m + ( len bG ) ) by A9,A11,A12,A3,A6,FINSEQ_1:60,FINSEQ_3:109;
hence thesis by A8,A42,A41,A14,FINSEQ_1:14;
end;
