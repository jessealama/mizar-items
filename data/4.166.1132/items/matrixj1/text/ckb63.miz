environ
vocabularies NUMBERS,NAT_1,VECTSP_1,SUBSET_1,XBOOLE_0,MATRIX_1,FINSEQ_1,ALGSTR_0,RELAT_1,ARYTM_3,TARSKI,STRUCT_0,ZFMISC_1,ORDINAL4,XXREAL_0,FUNCT_1,PARTFUN1,FINSEQ_3,CARD_1,ARYTM_1,FINSEQ_2,CARD_3,GROUP_1,RFINSEQ,TREES_1,INCSP_1,MATRIX_2,MATRIX_3,SUPINF_2,LAPLACE,MATRIX11,MESFUNC1,RVSUM_1,MATHMORP,VALUED_1,FVSUM_1,MATRIXJ1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,RELAT_1,FUNCT_1,PARTFUN1,FINSEQ_1,STRUCT_0,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,FVSUM_1,NAT_D,BINARITH,GROUP_4,MATRIX_3,MATRIX11,FINSEQOP,MATRIX13,LAPLACE,RFINSEQ,WSIERP_1,CKB7,CKB15,CKB17,CKB18,CKB20,CKB21,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB42,CKB43;
definitions TARSKI,FINSEQ_1,MATRIX_1,LAPLACE,MATRIX13,FVSUM_1,CKB7,CKB15,CKB27,CKB28,CKB42;
theorems CARD_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_5,FINSEQ_6,FINSEQOP,FUNCT_1,FVSUM_1,GROUP_1,GROUP_4,GOBOARD1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_9,MATRIX11,MATRIX13,MATRIX15,MATRIXR2,NAT_1,ORDINAL1,PARTFUN1,POLYNOM3,PRGCOR_1,RELAT_1,RFINSEQ,RLVECT_1,RVSUM_1,TARSKI,VECTSP_1,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,ZFMISC_1,MATRIX_4,FUNCT_2,FUNCOP_1,MATRIXR1,CARD_1,NAT_D,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB19,CKB22,CKB27,CKB28,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62;
schemes FINSEQ_1,FINSEQ_2,NAT_1,MATRIX_1;
registrations XBOOLE_0,FINSET_1,STRUCT_0,VECTSP_1,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,FINSEQ_2,MATRIX13,XREAL_0,VALUED_0,CARD_1,FVSUM_1,CKB16;
constructors XXREAL_0,GROUP_4,VECTSP_7,MATRIX11,MATRIX13,LAPLACE,RFINSEQ,POLYNOM1,WSIERP_1,SEQ_1,VALUED_0,VALUED_1,REAL_1,NAT_D,BINARITH,RELSET_1,FVSUM_1,CKB7,CKB15,CKB20,CKB21,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB42,CKB43;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve i for Nat;
reserve j for Nat;
reserve m for Nat;
reserve K for Field;
reserve a for (Element of K);
reserve A for (Matrix of K);
reserve G for (FinSequence_of_Matrix of K);
theorem
Th41: ((i in ( dom A ) & ( width A ) = ( width ( DelLine (A,i) ) )) implies ( DelLine (( block_diagonal (( <* A *> ^ G ),a) ),i) ) = ( block_diagonal (( <* ( DelLine (A,i) ) *> ^ G ),a) ))
proof
assume that
A1: i in ( dom A )
and
A2: ( width A ) = ( width ( DelLine (A,i) ) );
A3: i in ( Seg ( len A ) ) by A1,FINSEQ_1:def 3;
set da = ( DelLine (A,i) );
consider m such that A4: ( len A ) = ( m + 1 ) and A5: ( len da ) = m by A1,FINSEQ_3:104;
set bG = ( block_diagonal (G,a) );
set DA = <* da *>;
set AA = <* A *>;
set BG = <* bG *>;
set bAG = ( block_diagonal (<* A,bG *>,a) );
set bdAG = ( block_diagonal (<* da,bG *>,a) );
A6: ( Seg ( len bAG ) ) = ( dom bAG ) by FINSEQ_1:def 3;
A7: ( len bAG ) = ( Sum ( Len ( AA ^ BG ) ) ) by CKB42:def 1;
then A8: ( len bAG ) = ( ( len A ) + ( len bG ) ) by CKB35:1;
then ( len bAG ) >= ( len A ) by NAT_1:11;
then A9: ( Seg ( len A ) ) c= ( Seg ( len bAG ) ) by FINSEQ_1:5;
A10: ( len bdAG ) = ( Sum ( Len ( DA ^ BG ) ) ) by CKB42:def 1;
then A11: ( len bdAG ) = ( m + ( len bG ) ) by A5,CKB35:1;
A12: ( len bAG ) = ( ( m + ( len bG ) ) + 1 ) by A4,A8;
A13: ( len bdAG ) = ( ( len da ) + ( len bG ) ) by A10,CKB35:1;
A14:now
( m + ( len bG ) ) <= ( len bAG ) by A12,NAT_1:11;
then A15: ( Seg ( m + ( len bG ) ) ) c= ( Seg ( len bAG ) ) by FINSEQ_1:5;
reconsider da9 = da as (Matrix of ( len da ),( width da ),K) by MATRIX_2:7;
reconsider A9 = A as (Matrix of ( len A ),( width A ),K) by MATRIX_2:7;
let j;
assume that
A16: 1 <= j
and
A17: j <= ( m + ( len bG ) );
A18: j in ( Seg ( m + ( len bG ) ) ) by A16,A17,FINSEQ_1:1;
A19: 1 <= ( 1 + j ) by NAT_1:11;
( j + 1 ) <= ( len bAG ) by A12,A17,XREAL_1:7;
then A20: ( j + 1 ) in ( Seg ( len bAG ) ) by A19;
now
per cases ;
suppose A21: j < i;

i <= ( len A ) by A3,FINSEQ_1:1;
then A22: j < ( len A ) by A21,XXREAL_0:2;
then A23: j <= m by A4,NAT_1:13;
then A24: j in ( dom da ) by A5,A16,FINSEQ_3:25;
A25: j in ( dom A ) by A16,A22,FINSEQ_3:25;
then A26: j in ( Seg m ) by A16,A23;
j in ( Seg ( len A ) ) by A16,A22,FINSEQ_1:1;
then A27: ( Line (A9,j) ) = ( A . j ) by MATRIX_2:8
.= ( da9 . j ) by A21,FINSEQ_3:110
.= ( Line (da,j) ) by A5,A26,MATRIX_2:8;
thus ( ( Del (bAG,i) ) . j ) = ( bAG . j ) by A21,FINSEQ_3:110
.= ( Line (bAG,j) ) by A7,A18,A15,MATRIX_2:8
.= ( ( Line (da,j) ) ^ ( ( width bG ) |-> a ) ) by A25,A27,CKB45:1
.= ( Line (bdAG,j) ) by A24,CKB45:1
.= ( bdAG . j ) by A5,A10,A13,A18,MATRIX_2:8;
end;
suppose A28: j >= i;

then A29: ( ( Del (bAG,i) ) . j ) = ( bAG . ( j + 1 ) ) by A12,A9,A3,A6,A17,FINSEQ_3:111
.= ( Line (bAG,( j + 1 )) ) by A7,A20,MATRIX_2:8;
now
per cases ;
suppose A30: ( j + 1 ) <= ( len A );

then A31: ( j + 1 ) in ( dom A ) by A19,FINSEQ_3:25;
A32: j <= m by A4,A30,XREAL_1:8;
then A33: j in ( Seg m ) by A16,FINSEQ_1:1;
A34: j in ( dom da ) by A5,A16,A32,FINSEQ_3:25;
( j + 1 ) in ( Seg ( len A ) ) by A19,A30;
then ( Line (A9,( j + 1 )) ) = ( A . ( j + 1 ) ) by MATRIX_2:8
.= ( da9 . j ) by A1,A4,A28,A32,FINSEQ_3:111
.= ( Line (da,j) ) by A5,A33,MATRIX_2:8;
hence ( ( Del (bAG,i) ) . j ) = ( ( Line (da,j) ) ^ ( ( width bG ) |-> a ) ) by A29,A31,CKB45:1
.= ( Line (bdAG,j) ) by A34,CKB45:1;
end;
suppose A35: ( j + 1 ) > ( len A );

then reconsider jL = ( ( j + 1 ) - ( len A ) ) as (Element of ( NAT )) by NAT_1:21;
jL <> ( 0 ) by A35;
then A36: jL >= 1 by NAT_1:14;
( jL + ( len A ) ) <= ( ( len bG ) + ( len A ) ) by A8,A12,A17,XREAL_1:7;
then jL <= ( len bG ) by XREAL_1:8;
then A37: jL in ( dom bG ) by A36,FINSEQ_3:25;
thus ( ( Del (bAG,i) ) . j ) = ( Line (bAG,( jL + ( len A ) )) ) by A29
.= ( ( ( width da ) |-> a ) ^ ( Line (bG,jL) ) ) by A2,A37,CKB45:1
.= ( Line (bdAG,( jL + ( len da ) )) ) by A37,CKB45:1
.= ( Line (bdAG,j) ) by A4,A5;
end;
end;
hence ( ( Del (bAG,i) ) . j ) = ( bdAG . j ) by A5,A10,A13,A18,MATRIX_2:8;
end;
end;
hence ( ( Del (bAG,i) ) . j ) = ( bdAG . j );
end;
A38: ( block_diagonal (( DA ^ G ),a) ) = bdAG by CKB58:1;
A39: ( block_diagonal (( AA ^ G ),a) ) = bAG by CKB58:1;
( len ( Del (bAG,i) ) ) = ( m + ( len bG ) ) by A12,A9,A3,A6,FINSEQ_3:109;
hence thesis by A11,A39,A38,A14,FINSEQ_1:14;
end;
