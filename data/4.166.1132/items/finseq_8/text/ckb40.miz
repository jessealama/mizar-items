environ
vocabularies FINSEQ_8,ARYTM_1,RELAT_1,FINSEQ_1,FUNCT_1,FINSEQ_5,RFINSEQ,JORDAN3,ARYTM_3,NUMBERS,ORDINAL4,TARSKI,XBOOLE_0,XXREAL_0,CARD_1,SUBSET_1,NAT_1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,NAT_D,RELAT_1,RFINSEQ,FINSEQ_1,FUNCT_1,FINSEQ_6,FINSEQ_5,CKB1,CKB5,CKB6,CKB13,CKB15,CKB17,CKB18,CKB24,CKB26,CKB30,CKB31,CKB33;
definitions FINSEQ_1,CKB5,CKB13,CKB15,CKB17,CKB18,CKB24,CKB26,CKB31,CKB33;
theorems NAT_1,NAT_2,FINSEQ_1,FINSEQ_3,FINSEQ_5,FINSEQ_6,RFINSEQ,RELAT_1,XREAL_1,XBOOLE_1,XXREAL_0,ORDINAL1,XREAL_0,NAT_D,CKB2,CKB3,CKB4,CKB5,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39;
schemes NAT_1;
registrations RELSET_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,ORDINAL1,XBOOLE_0,CARD_1;
constructors SQUARE_1,NAT_1,RFINSEQ,NAT_D,FINSEQ_5,FINSEQ_6,REAL_1,CKB1,CKB5,CKB6,CKB13,CKB15,CKB17,CKB18,CKB24,CKB26,CKB31,CKB33;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
definition
let D being non  empty set;
let f being (FinSequence of D);
let g being (FinSequence of D);
let n being (Element of ( NAT ));
func instr (n,f,g) -> (Element of ( NAT )) means 
:Def10: ((it <> ( 0 ) implies ((n <= it & g is_preposition_of ( f /^ ( it -' 1 ) )) & (for j being (Element of ( NAT )) holds (((j >= n & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= it)))) & (it = ( 0 ) implies (not g is_substring_of f,n)));
existence
proof
A1: ( 1 -' 1 ) = ( 1 - 1 ) by XREAL_0:def 2;
now
per cases ;
case A2: g is_substring_of f,n;
now
per cases ;
case A3: ( len g ) > ( 0 );
then A4: (ex i2 being (Element of ( NAT )) st ((n <= i2 & i2 <= ( len f )) & ( mid (f,i2,( ( i2 -' 1 ) + ( len g ) )) ) = g)) by A2,CKB26:def 1;
A5: ( ( 0 ) + 1 ) <= ( len g ) by A3,NAT_1:13;
now
per cases ;
case A6: n > ( 0 );
defpred P[ Nat ]
 means
((n <= $1 & $1 <= ( len f )) & ( mid (f,$1,( ( $1 -' 1 ) + ( len g ) )) ) = g);
A7: (ex i being Nat st P[ i ]) by A4;
(ex k being Nat st (P[ k ] & (for m being Nat holds (P[ m ] implies m >= k)))) from NAT_1:sch 5(A7);
then consider k0 being Nat such that A8: n <= k0 and A9: k0 <= ( len f ) and A10: ( mid (f,k0,( ( k0 -' 1 ) + ( len g ) )) ) = g and A11: (for m being Nat holds (((n <= m & m <= ( len f )) & ( mid (f,m,( ( m -' 1 ) + ( len g ) )) ) = g) implies m >= k0));
reconsider k0 as (Element of ( NAT )) by ORDINAL1:def 12;
( ( 0 ) + 1 ) <= k0 by A6,A8,NAT_1:13;
then ( k0 - 1 ) >= ( 0 ) by XREAL_1:48;
then A12: ( k0 -' 1 ) = ( k0 - 1 ) by XREAL_0:def 2;
k0 < ( k0 + 1 ) by XREAL_1:29;
then ( k0 - 1 ) < ( ( k0 + 1 ) - 1 ) by XREAL_1:9;
then ( k0 -' 1 ) < ( len f ) by A9,A12,XXREAL_0:2;
then A13: ( len ( f /^ ( k0 -' 1 ) ) ) = ( ( len f ) - ( k0 -' 1 ) ) by RFINSEQ:def 1;
( ( len f ) - k0 ) >= ( 0 ) by A9,XREAL_1:48;
then A14: ( ( ( len f ) - k0 ) + 1 ) >= ( ( 0 ) + 1 ) by XREAL_1:7;
A15: ( 1 -' 1 ) = ( 1 - 1 ) by XREAL_0:def 2;
A16: ( ( 0 ) + 1 ) <= ( len g ) by A3,NAT_1:13;
then A17: ( ( k0 -' 1 ) + 1 ) <= ( ( k0 -' 1 ) + ( len g ) ) by XREAL_1:7;
A18: ( ( len g ) - 1 ) >= ( 0 ) by A16,XREAL_1:48;
then ( ( ( ( - 1 ) + ( len g ) ) + k0 ) - k0 ) >= ( 0 );
then A19: ( ( ( ( k0 -' 1 ) + ( len g ) ) -' k0 ) + 1 ) = ( ( ( len g ) - 1 ) + 1 ) by A12,XREAL_0:def 2
.= ( ( ( len g ) -' 1 ) + 1 ) by A18,XREAL_0:def 2;
( mid (( f /^ ( k0 -' 1 ) ),1,( len g )) ) = ( ( ( f /^ ( k0 -' 1 ) ) /^ ( 1 -' 1 ) ) | ( ( ( len g ) -' 1 ) + 1 ) ) by A5,FINSEQ_6:def 3
.= ( ( f /^ ( k0 -' 1 ) ) | ( ( ( ( k0 -' 1 ) + ( len g ) ) -' k0 ) + 1 ) ) by A15,A19,FINSEQ_5:28
.= ( mid (f,k0,( ( k0 -' 1 ) + ( len g ) )) ) by A12,A17,FINSEQ_6:def 3;
then A20: g is_preposition_of ( f /^ ( k0 -' 1 ) ) by A10,A12,A13,A14,CKB31:def 1;
(for j being (Element of ( NAT )) holds (((j >= n & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= k0))
proof
let j being (Element of ( NAT ));
assume that
A21: j >= n
and
A22: j > ( 0 )
and
A23: g is_preposition_of ( f /^ ( j -' 1 ) );
A24: ( mid (( f /^ ( j -' 1 ) ),1,( len g )) ) = g by A3,A23,CKB31:def 1;
now
per cases ;
case A25: j <= ( len f );
( ( 0 ) + 1 ) <= j by A22,NAT_1:13;
then ( j - 1 ) >= ( 0 ) by XREAL_1:48;
then A26: ( j -' 1 ) = ( j - 1 ) by XREAL_0:def 2;
( ( ( ( - 1 ) + ( len g ) ) + j ) - j ) >= ( 0 ) by A18;
then A27: ( ( ( ( j -' 1 ) + ( len g ) ) -' j ) + 1 ) = ( ( ( len g ) - 1 ) + 1 ) by A26,XREAL_0:def 2
.= ( ( ( len g ) -' 1 ) + 1 ) by A18,XREAL_0:def 2;
A28: ( ( j -' 1 ) + 1 ) <= ( ( j -' 1 ) + ( len g ) ) by A16,XREAL_1:7;
( mid (( f /^ ( j -' 1 ) ),1,( len g )) ) = ( ( ( f /^ ( j -' 1 ) ) /^ ( 1 -' 1 ) ) | ( ( ( len g ) -' 1 ) + 1 ) ) by A5,FINSEQ_6:def 3
.= ( ( f /^ ( j -' 1 ) ) | ( ( ( ( j -' 1 ) + ( len g ) ) -' j ) + 1 ) ) by A15,A27,FINSEQ_5:28
.= ( mid (f,j,( ( j -' 1 ) + ( len g ) )) ) by A26,A28,FINSEQ_6:def 3;
hence thesis by A11,A21,A24,A25;
end;
case j > ( len f );
hence thesis by A9,XXREAL_0:2;
end;
end;
hence thesis;
end;
hence thesis by A6,A8,A20;
end;
case A29: n = ( 0 );
then A30: g is_substring_of f,1 by A2,CKB29:1;
reconsider n2 = 1 as (Element of ( NAT ));
A31: (ex i2 being (Element of ( NAT )) st ((n2 <= i2 & i2 <= ( len f )) & ( mid (f,i2,( ( i2 -' 1 ) + ( len g ) )) ) = g)) by A3,A30,CKB26:def 1;
defpred P[ Nat ]
 means
((n2 <= $1 & $1 <= ( len f )) & ( mid (f,$1,( ( $1 -' 1 ) + ( len g ) )) ) = g);
A32: (ex i being Nat st P[ i ]) by A31;
(ex k being Nat st (P[ k ] & (for m being Nat holds (P[ m ] implies m >= k)))) from NAT_1:sch 5(A32);
then consider k0 being Nat such that A33: n2 <= k0 and A34: k0 <= ( len f ) and A35: ( mid (f,k0,( ( k0 -' 1 ) + ( len g ) )) ) = g and A36: (for m being Nat holds (((n2 <= m & m <= ( len f )) & ( mid (f,m,( ( m -' 1 ) + ( len g ) )) ) = g) implies m >= k0));
reconsider k0 as (Element of ( NAT )) by ORDINAL1:def 12;
( k0 - 1 ) >= ( 0 ) by A33,XREAL_1:48;
then A37: ( k0 -' 1 ) = ( k0 - 1 ) by XREAL_0:def 2;
k0 < ( k0 + 1 ) by XREAL_1:29;
then ( k0 - 1 ) < ( ( k0 + 1 ) - 1 ) by XREAL_1:9;
then ( k0 -' 1 ) < ( len f ) by A34,A37,XXREAL_0:2;
then A38: ( len ( f /^ ( k0 -' 1 ) ) ) = ( ( len f ) - ( k0 -' 1 ) ) by RFINSEQ:def 1;
( ( len f ) - k0 ) >= ( 0 ) by A34,XREAL_1:48;
then A39: ( ( ( len f ) - k0 ) + 1 ) >= ( ( 0 ) + 1 ) by XREAL_1:7;
A40: ( ( 0 ) + 1 ) <= ( len g ) by A3,NAT_1:13;
then A41: ( ( k0 -' 1 ) + 1 ) <= ( ( k0 -' 1 ) + ( len g ) ) by XREAL_1:7;
A42: ( ( len g ) - 1 ) >= ( 0 ) by A40,XREAL_1:48;
then ( ( ( ( - 1 ) + ( len g ) ) + k0 ) - k0 ) >= ( 0 );
then A43: ( ( ( ( k0 -' 1 ) + ( len g ) ) -' k0 ) + 1 ) = ( ( ( len g ) - 1 ) + 1 ) by A37,XREAL_0:def 2
.= ( ( ( len g ) -' 1 ) + 1 ) by A42,XREAL_0:def 2;
( mid (( f /^ ( k0 -' 1 ) ),1,( len g )) ) = ( ( ( f /^ ( k0 -' 1 ) ) /^ ( 1 -' 1 ) ) | ( ( ( len g ) -' 1 ) + 1 ) ) by A5,FINSEQ_6:def 3
.= ( ( f /^ ( k0 -' 1 ) ) | ( ( ( ( k0 -' 1 ) + ( len g ) ) -' k0 ) + 1 ) ) by A1,A43,FINSEQ_5:28
.= ( mid (f,k0,( ( k0 -' 1 ) + ( len g ) )) ) by A37,A41,FINSEQ_6:def 3;
then A44: g is_preposition_of ( f /^ ( k0 -' 1 ) ) by A35,A37,A38,A39,CKB31:def 1;
A45: (for j being (Element of ( NAT )) holds (((j >= n2 & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= k0))
proof
let j being (Element of ( NAT ));
assume that
A46: j >= n2
and
j > ( 0 )
and
A47: g is_preposition_of ( f /^ ( j -' 1 ) );
A48: ( mid (( f /^ ( j -' 1 ) ),1,( len g )) ) = g by A3,A47,CKB31:def 1;
now
per cases ;
case A49: j <= ( len f );
( j - 1 ) >= ( 0 ) by A46,XREAL_1:48;
then A50: ( j -' 1 ) = ( j - 1 ) by XREAL_0:def 2;
( ( ( ( - 1 ) + ( len g ) ) + j ) - j ) >= ( 0 ) by A42;
then A51: ( ( ( ( j -' 1 ) + ( len g ) ) -' j ) + 1 ) = ( ( ( len g ) - 1 ) + 1 ) by A50,XREAL_0:def 2
.= ( ( ( len g ) -' 1 ) + 1 ) by A42,XREAL_0:def 2;
A52: ( ( j -' 1 ) + 1 ) <= ( ( j -' 1 ) + ( len g ) ) by A40,XREAL_1:7;
( mid (( f /^ ( j -' 1 ) ),1,( len g )) ) = ( ( ( f /^ ( j -' 1 ) ) /^ ( 1 -' 1 ) ) | ( ( ( len g ) -' 1 ) + 1 ) ) by A5,FINSEQ_6:def 3
.= ( ( f /^ ( j -' 1 ) ) | ( ( ( ( j -' 1 ) + ( len g ) ) -' j ) + 1 ) ) by A1,A51,FINSEQ_5:28
.= ( mid (f,j,( ( j -' 1 ) + ( len g ) )) ) by A50,A52,FINSEQ_6:def 3;
hence thesis by A36,A46,A48,A49;
end;
case j > ( len f );
hence thesis by A34,XXREAL_0:2;
end;
end;
hence thesis;
end;
(for j being (Element of ( NAT )) holds (((j >= n & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= k0))
proof
let j being (Element of ( NAT ));
assume that
j >= n
and
A53: j > ( 0 )
and
A54: g is_preposition_of ( f /^ ( j -' 1 ) );
j >= ( ( 0 ) + n2 ) by A53,NAT_1:13;
hence thesis by A45,A54;
end;
hence thesis by A29,A33,A44;
end;
end;
hence thesis;
end;
case A55: ( len g ) <= ( 0 );
reconsider nn = ( max (n,1) ) as (Element of ( NAT )) by XXREAL_0:16;
A56: nn >= n by XXREAL_0:25;
A57: nn >= ( ( 0 ) + 1 ) by XXREAL_0:25;
A58: g is_preposition_of ( f /^ ( nn -' 1 ) ) by A55,CKB31:def 1;
(for j being (Element of ( NAT )) holds (((j >= n & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= nn))
proof
let j being (Element of ( NAT ));
assume that
A59: j >= n
and
A60: j > ( 0 )
and
g is_preposition_of ( f /^ ( j -' 1 ) );
j >= ( ( 0 ) + 1 ) by A60,NAT_1:13;
hence thesis by A59,XXREAL_0:28;
end;
hence thesis by A56,A57,A58;
end;
end;
hence thesis;
end;
case (not g is_substring_of f,n);
hence thesis;
end;
end;
hence thesis;
end;
uniqueness
proof
A61: ( 1 -' 1 ) = ( 1 - 1 ) by XREAL_0:def 2;
thus (for k1,k2 being (Element of ( NAT )) holds (((((k1 <> ( 0 ) implies ((n <= k1 & g is_preposition_of ( f /^ ( k1 -' 1 ) )) & (for j being (Element of ( NAT )) holds (((j >= n & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= k1)))) & (k1 = ( 0 ) implies (not g is_substring_of f,n))) & (k2 <> ( 0 ) implies ((n <= k2 & g is_preposition_of ( f /^ ( k2 -' 1 ) )) & (for j being (Element of ( NAT )) holds (((j >= n & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= k2))))) & (k2 = ( 0 ) implies (not g is_substring_of f,n))) implies k1 = k2))
proof
let k1 being (Element of ( NAT ));
let k2 being (Element of ( NAT ));
assume that
A62: (k1 <> ( 0 ) implies ((n <= k1 & g is_preposition_of ( f /^ ( k1 -' 1 ) )) & (for j being (Element of ( NAT )) holds (((j >= n & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= k1))))
and
A63: (k1 = ( 0 ) implies (not g is_substring_of f,n))
and
A64: (k2 <> ( 0 ) implies ((n <= k2 & g is_preposition_of ( f /^ ( k2 -' 1 ) )) & (for j being (Element of ( NAT )) holds (((j >= n & j > ( 0 )) & g is_preposition_of ( f /^ ( j -' 1 ) )) implies j >= k2))))
and
A65: (k2 = ( 0 ) implies (not g is_substring_of f,n));
now
per cases ;
case ( len g ) > ( 0 );
then A66: ( ( 0 ) + 1 ) <= ( len g ) by NAT_1:13;
then A67: ( ( len g ) - 1 ) >= ( 0 ) by XREAL_1:48;
now
per cases ;
case A68: (k1 <> ( 0 ) & k2 <> ( 0 ));
then A69: k2 >= k1 by A62,A64;
k1 >= k2 by A62,A64,A68;
hence thesis by A69,XXREAL_0:1;
end;
case A70: (k1 <> ( 0 ) & k2 = ( 0 ));
then A71: ( len g ) > ( 0 ) by A65,CKB26:def 1;
(for i being (Element of ( NAT )) holds ((n <= i & ( 0 ) < i) implies (not g is_preposition_of ( f /^ ( i -' 1 ) ))))
proof
let i being (Element of ( NAT ));
assume that
A72: n <= i
and
A73: ( 0 ) < i;
( ( 0 ) + 1 ) <= i by A73,NAT_1:13;
then ( i - 1 ) >= ( 0 ) by XREAL_1:48;
then A74: ( i -' 1 ) = ( i - 1 ) by XREAL_0:def 2;
( ( ( ( - 1 ) + ( len g ) ) + i ) - i ) >= ( 0 ) by A67;
then A75: ( ( ( ( i -' 1 ) + ( len g ) ) -' i ) + 1 ) = ( ( ( len g ) - 1 ) + 1 ) by A74,XREAL_0:def 2
.= ( ( ( len g ) -' 1 ) + 1 ) by A67,XREAL_0:def 2;
A76: ( ( i -' 1 ) + 1 ) <= ( ( i -' 1 ) + ( len g ) ) by A66,XREAL_1:7;
( mid (( f /^ ( i -' 1 ) ),1,( len g )) ) = ( ( ( f /^ ( i -' 1 ) ) /^ ( 1 -' 1 ) ) | ( ( ( len g ) -' 1 ) + 1 ) ) by A66,FINSEQ_6:def 3
.= ( ( f /^ ( i -' 1 ) ) | ( ( ( ( i -' 1 ) + ( len g ) ) -' i ) + 1 ) ) by A61,A75,FINSEQ_5:28
.= ( mid (f,i,( ( i -' 1 ) + ( len g ) )) ) by A74,A76,FINSEQ_6:def 3;
then (not (1 <= ( len ( f /^ ( i -' 1 ) ) ) & ( mid (( f /^ ( i -' 1 ) ),1,( len g )) ) = g)) by A65,A70,A72,A73,CKB39:1;
hence thesis by A71,CKB31:def 1;
end;
hence contradiction by A62,A70;
end;
case A77: (k1 = ( 0 ) & k2 <> ( 0 ));
then A78: ( len g ) > ( 0 ) by A63,CKB26:def 1;
(for i being (Element of ( NAT )) holds ((n <= i & ( 0 ) < i) implies (not g is_preposition_of ( f /^ ( i -' 1 ) ))))
proof
let i being (Element of ( NAT ));
assume that
A79: n <= i
and
A80: ( 0 ) < i;
( ( 0 ) + 1 ) <= i by A80,NAT_1:13;
then ( i - 1 ) >= ( 0 ) by XREAL_1:48;
then A81: ( i -' 1 ) = ( i - 1 ) by XREAL_0:def 2;
( ( ( ( - 1 ) + ( len g ) ) + i ) - i ) >= ( 0 ) by A67;
then A82: ( ( ( ( i -' 1 ) + ( len g ) ) -' i ) + 1 ) = ( ( ( len g ) - 1 ) + 1 ) by A81,XREAL_0:def 2
.= ( ( ( len g ) -' 1 ) + 1 ) by A67,XREAL_0:def 2;
A83: ( ( i -' 1 ) + 1 ) <= ( ( i -' 1 ) + ( len g ) ) by A66,XREAL_1:7;
( mid (( f /^ ( i -' 1 ) ),1,( len g )) ) = ( ( ( f /^ ( i -' 1 ) ) /^ ( 1 -' 1 ) ) | ( ( ( len g ) -' 1 ) + 1 ) ) by A66,FINSEQ_6:def 3
.= ( ( f /^ ( i -' 1 ) ) | ( ( ( ( i -' 1 ) + ( len g ) ) -' i ) + 1 ) ) by A61,A82,FINSEQ_5:28
.= ( mid (f,i,( ( i -' 1 ) + ( len g ) )) ) by A81,A83,FINSEQ_6:def 3;
then (not (1 <= ( len ( f /^ ( i -' 1 ) ) ) & ( mid (( f /^ ( i -' 1 ) ),1,( len g )) ) = g)) by A63,A77,A79,A80,CKB39:1;
hence thesis by A78,CKB31:def 1;
end;
hence contradiction by A64,A77;
end;
case (k1 = ( 0 ) & k2 = ( 0 ));
hence thesis;
end;
end;
hence thesis;
end;
case A84: ( len g ) <= ( 0 );
now
per cases ;
case A85: (k1 <> ( 0 ) & k2 <> ( 0 ));
then A86: k2 >= k1 by A62,A64;
k1 >= k2 by A62,A64,A85;
hence thesis by A86,XXREAL_0:1;
end;
case (k1 <> ( 0 ) & k2 = ( 0 ));
hence contradiction by A65,A84,CKB26:def 1;
end;
case (k1 = ( 0 ) & k2 <> ( 0 ));
hence contradiction by A63,A84,CKB26:def 1;
end;
case (k1 = ( 0 ) & k2 = ( 0 ));
hence contradiction by A63,A84,CKB26:def 1;
end;
end;
hence thesis;
end;
end;
hence thesis;
end;

end;
end;
