environ
vocabularies FUNCT_1,NUMBERS,SUBSET_1,SUPINF_2,XXREAL_0,ORDINAL1,RELAT_1,SUPINF_1,ORDINAL2,PROB_1,MEASURE2,MEASURE1,TARSKI,SETFAM_1,CARD_1,XBOOLE_0,ARYTM_3,NAT_1,ARYTM_1,REAL_1,XXREAL_2,ZFMISC_1,MEASURE3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,XXREAL_0,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,REAL_1,NAT_1,SETFAM_1,PROB_1,XXREAL_2,SUPINF_1,SUPINF_2,MEASURE1,MEASURE2,CKB3,CKB4,CKB17,CKB18,CKB19,CKB20;
definitions TARSKI,XBOOLE_0,XXREAL_3,CKB17,CKB18,CKB19,CKB20;
theorems TARSKI,FUNCT_1,FUNCT_2,ZFMISC_1,NAT_1,SETFAM_1,SUPINF_2,MEASURE1,MEASURE2,PROB_2,XBOOLE_0,XBOOLE_1,XXREAL_0,PROB_1,FINSUB_1,ORDINAL1,XXREAL_2,VALUED_0,XXREAL_3,RELAT_1,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB26;
schemes NAT_1,FUNCT_2,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,FUNCT_2,NUMBERS,XREAL_0,MEMBERED,MEASURE1,VALUED_0,XXREAL_3,RELSET_1,CKB25;
constructors PARTFUN1,REAL_1,NAT_1,PROB_2,MEASURE1,MEASURE2,SUPINF_1,RELSET_1,CKB4,CKB17,CKB18,CKB19,CKB20;
requirements NUMERALS,SUBSET,BOOLE,ARITHM;
begin
definition
let X being set;
let S being (SigmaField of X);
let M being (sigma_Measure of S);
func COM M -> (sigma_Measure of ( COM (S,M) ))
means
:Def6: (for B being set holds (B in S implies (for C being (thin of M) holds ( it . ( B \/ C ) ) = ( M . B ))));
existence
proof
set B = ( {} );
defpred P[ set,set ]
 means
(for x,y being set holds (x in ( COM (S,M) ) implies ((x = $1 & y = $2) implies (for B being set holds (B in S implies (for C being (thin of M) holds (x = ( B \/ C ) implies y = ( M . B ))))))));
A1: (ex B1 being set st ((B1 in S & ( {} ) c= B1) & ( M . B1 ) = ( 0. )))
proof
take ( {} );
thus thesis by PROB_1:4,VALUED_0:def 19;
end;
( {} ) is (Subset of X) by XBOOLE_1:2;
then reconsider C = ( {} ) as (thin of M) by A1,CKB18:def 1;
A2: (for x being set holds (x in ( COM (S,M) ) implies (ex y being set st (y in ( ExtREAL ) & P[ x,y ]))))
proof
let x being set;
assume x in ( COM (S,M) );
then consider B being set such that A3: (B in S & (ex C being (thin of M) st x = ( B \/ C ))) by CKB19:def 1;
take ( M . B );
thus thesis by A3,CKB26:1;
end;
consider comM being (Function of ( COM (S,M) ),( ExtREAL )) such that A4: (for x being set holds (x in ( COM (S,M) ) implies P[ x,( comM . x ) ])) from FUNCT_2:sch 1(A2);
A5: (for B being set holds (B in S implies (for C being (thin of M) holds ( comM . ( B \/ C ) ) = ( M . B ))))
proof
let B being set;
assume A6: B in S;
let C being (thin of M);
( B \/ C ) in ( COM (S,M) ) by A6,CKB19:def 1;
hence thesis by A4,A6;
end;
A7: (for F being (Sep_Sequence of ( COM (S,M) )) holds ( SUM ( comM * F ) ) = ( comM . ( union ( rng F ) ) ))
proof
let F being (Sep_Sequence of ( COM (S,M) ));
consider G being (Function of ( NAT ),S) such that A8: (for n being (Element of ( NAT )) holds ( G . n ) in ( MeasPart ( F . n ) )) by CKB21:1;
consider H being (Function of ( NAT ),( bool X )) such that A9: (for n being (Element of ( NAT )) holds ( H . n ) = ( ( F . n ) \ ( G . n ) )) by CKB22:1;
A10: (for n being (Element of ( NAT )) holds ((( G . n ) in S & ( G . n ) c= ( F . n )) & ( ( F . n ) \ ( G . n ) ) is (thin of M)))
proof
let n being (Element of ( NAT ));
( G . n ) in ( MeasPart ( F . n ) ) by A8;
hence thesis by CKB20:def 1;
end;
(for n being (Element of ( NAT )) holds ( H . n ) is (thin of M))
proof
let n being (Element of ( NAT ));
( ( F . n ) \ ( G . n ) ) is (thin of M) by A10;
hence thesis by A9;
end;
then consider L being (Function of ( NAT ),S) such that A11: (for n being (Element of ( NAT )) holds (( H . n ) c= ( L . n ) & ( M . ( L . n ) ) = ( 0. ))) by CKB23:1;
A12: (for n,m being set holds (n <> m implies ( G . n ) misses ( G . m )))
proof
let n being set,m being set;
A13: ( dom F ) = ( NAT ) by FUNCT_2:def 1
.= ( dom G ) by FUNCT_2:def 1;
(for n being set holds ( G . n ) c= ( F . n ))
proof
let n being set;
per cases ;
suppose n in ( dom F );

hence thesis by A10;
end;
suppose A14: (not n in ( dom F ));

then ( F . n ) = ( {} ) by FUNCT_1:def 2
.= ( G . n ) by A13,A14,FUNCT_1:def 2;
hence thesis;
end;
end;
then A15: (( G . n ) c= ( F . n ) & ( G . m ) c= ( F . m ));
assume n <> m;
then ( F . n ) misses ( F . m ) by PROB_2:def 2;
then ( ( F . n ) /\ ( F . m ) ) = ( {} ) by XBOOLE_0:def 7;
then ( ( G . n ) /\ ( G . m ) ) = ( {} ) by A15,XBOOLE_1:3,XBOOLE_1:27;
hence thesis by XBOOLE_0:def 7;
end;
consider B being set such that A16: B = ( union ( rng G ) );
A17: ( dom F ) = ( NAT ) by FUNCT_2:def 1;
A18: B c= ( union ( rng F ) )
proof
let x being set;
assume x in B;
then consider Z being set such that A19: x in Z and A20: Z in ( rng G ) by A16,TARSKI:def 4;
( dom G ) = ( NAT ) by FUNCT_2:def 1;
then consider n being set such that A21: n in ( NAT ) and A22: Z = ( G . n ) by A20,FUNCT_1:def 3;
reconsider n as (Element of ( NAT )) by A21;
set P = ( F . n );
A23: ( G . n ) c= P by A10;
(ex P being set st (P in ( rng F ) & x in P))
proof
take P;
thus thesis by A17,A19,A22,A23,FUNCT_1:def 3;
end;
hence thesis by TARSKI:def 4;
end;
A24: (ex C being (thin of M) st ( union ( rng F ) ) = ( B \/ C ))
proof
(for A being set holds (A in ( rng L ) implies A is (measure_zero of M)))
proof
let A being set;
assume A25: A in ( rng L );
( dom L ) = ( NAT ) by FUNCT_2:def 1;
then A26: (ex n being set st (n in ( NAT ) & A = ( L . n ))) by A25,FUNCT_1:def 3;
( rng L ) c= S by MEASURE2:def 1;
then reconsider A as (Element of S) by A25;
( M . A ) = ( 0. ) by A11,A26;
hence thesis by MEASURE1:def 7;
end;
then ( union ( rng L ) ) is (measure_zero of M) by MEASURE2:14;
then A27: ( M . ( union ( rng L ) ) ) = ( 0. ) by MEASURE1:def 7;
set C = ( ( union ( rng F ) ) \ B );
A28: ( union ( rng F ) ) = ( C \/ ( ( union ( rng F ) ) /\ B ) ) by XBOOLE_1:51
.= ( B \/ C ) by A18,XBOOLE_1:28;
reconsider C as (Subset of X);
A29: C c= ( union ( rng H ) )
proof
let x being set;
assume A30: x in C;
then x in ( union ( rng F ) ) by XBOOLE_0:def 5;
then consider Z being set such that A31: x in Z and A32: Z in ( rng F ) by TARSKI:def 4;
consider n being set such that A33: n in ( NAT ) and A34: Z = ( F . n ) by A17,A32,FUNCT_1:def 3;
reconsider n as (Element of ( NAT )) by A33;
A35: (not x in ( union ( rng G ) )) by A16,A30,XBOOLE_0:def 5;
(not x in ( G . n ))
proof
( dom G ) = ( NAT ) by FUNCT_2:def 1;
then A36: ( G . n ) in ( rng G ) by FUNCT_1:def 3;
assume x in ( G . n );
hence thesis by A35,A36,TARSKI:def 4;
end;
then A37: x in ( ( F . n ) \ ( G . n ) ) by A31,A34,XBOOLE_0:def 5;
(ex Z being set st (x in Z & Z in ( rng H )))
proof
take ( H . n );
( dom H ) = ( NAT ) by FUNCT_2:def 1;
hence thesis by A9,A37,FUNCT_1:def 3;
end;
hence thesis by TARSKI:def 4;
end;
( union ( rng H ) ) c= ( union ( rng L ) )
proof
let x being set;
assume x in ( union ( rng H ) );
then consider Z being set such that A38: x in Z and A39: Z in ( rng H ) by TARSKI:def 4;
( dom H ) = ( NAT ) by FUNCT_2:def 1;
then consider n being set such that A40: n in ( NAT ) and A41: Z = ( H . n ) by A39,FUNCT_1:def 3;
reconsider n as (Element of ( NAT )) by A40;
n in ( dom L ) by A40,FUNCT_2:def 1;
then A42: ( L . n ) in ( rng L ) by FUNCT_1:def 3;
( H . n ) c= ( L . n ) by A11;
hence thesis by A38,A41,A42,TARSKI:def 4;
end;
then C c= ( union ( rng L ) ) by A29,XBOOLE_1:1;
then C is (thin of M) by A27,CKB18:def 1;
then consider C being (thin of M) such that A43: ( union ( rng F ) ) = ( B \/ C ) by A28;
take C;
thus thesis by A43;
end;
reconsider G as (Sep_Sequence of S) by A12,PROB_2:def 2;
A44: (for n being (Element of ( NAT )) holds ( comM . ( F . n ) ) = ( M . ( G . n ) ))
proof
let n being (Element of ( NAT ));
( ( F . n ) \ ( G . n ) ) is (thin of M) by A10;
then consider C being (thin of M) such that A45: C = ( ( F . n ) \ ( G . n ) );
( F . n ) = ( ( ( F . n ) /\ ( G . n ) ) \/ ( ( F . n ) \ ( G . n ) ) ) by XBOOLE_1:51
.= ( ( G . n ) \/ C ) by A10,A45,XBOOLE_1:28;
hence thesis by A5;
end;
A46: (for n being (Element of ( NAT )) holds ( ( comM * F ) . n ) = ( ( M * G ) . n ))
proof
let n being (Element of ( NAT ));
( ( comM * F ) . n ) = ( comM . ( F . n ) ) by FUNCT_2:15
.= ( M . ( G . n ) ) by A44
.= ( ( M * G ) . n ) by FUNCT_2:15;
hence thesis;
end;
then (for n being (Element of ( NAT )) holds ( ( M * G ) . n ) <= ( ( comM * F ) . n ));
then A47: ( SUM ( M * G ) ) <= ( SUM ( comM * F ) ) by SUPINF_2:43;
(for n being (Element of ( NAT )) holds ( ( comM * F ) . n ) <= ( ( M * G ) . n )) by A46;
then ( SUM ( comM * F ) ) <= ( SUM ( M * G ) ) by SUPINF_2:43;
then (( SUM ( M * G ) ) = ( M . ( union ( rng G ) ) ) & ( SUM ( comM * F ) ) = ( SUM ( M * G ) )) by A47,MEASURE1:def 6,XXREAL_0:1;
hence thesis by A5,A16,A24;
end;
A48: (for x being (Element of ( COM (S,M) )) holds ( 0. ) <= ( comM . x ))
proof
let x being (Element of ( COM (S,M) ));
consider B being set such that A49: B in S and A50: (ex C being (thin of M) st x = ( B \/ C )) by CKB19:def 1;
reconsider B as (Element of S) by A49;
( comM . x ) = ( M . B ) by A4,A50;
hence thesis by MEASURE1:def 2;
end;
( {} ) = ( B \/ C );
then ( comM . ( {} ) ) = ( M . ( {} ) ) by A5,PROB_1:4
.= ( 0. ) by VALUED_0:def 19;
then reconsider comM as (sigma_Measure of ( COM (S,M) )) by A48,A7,MEASURE1:def 2,MEASURE1:def 6,VALUED_0:def 19;
take comM;
thus thesis by A5;
end;
uniqueness
proof
let M1 being (sigma_Measure of ( COM (S,M) )),M2 being (sigma_Measure of ( COM (S,M) ));
assume that
A51: (for B being set holds (B in S implies (for C being (thin of M) holds ( M1 . ( B \/ C ) ) = ( M . B ))))
and
A52: (for B being set holds (B in S implies (for C being (thin of M) holds ( M2 . ( B \/ C ) ) = ( M . B ))));
(for x being set holds (x in ( COM (S,M) ) implies ( M1 . x ) = ( M2 . x )))
proof
let x being set;
assume x in ( COM (S,M) );
then consider B being set such that A53: (B in S & (ex C being (thin of M) st x = ( B \/ C ))) by CKB19:def 1;
( M1 . x ) = ( M . B ) by A51,A53
.= ( M2 . x ) by A52,A53;
hence thesis;
end;
hence thesis by FUNCT_2:12;
end;
end;
