environ
vocabularies NUMBERS,XREAL_0,ORDINAL1,SUBSET_1,RELAT_1,WELLORD1,RELAT_2,ZFMISC_1,TARSKI,XBOOLE_0,FUNCT_1,FINSEQ_1,PRE_TOPC,METRIC_1,SETFAM_1,CARD_5,RCOMP_1,STRUCT_0,PCOMPS_1,CARD_1,ARYTM_3,XXREAL_0,ORDINAL4,PARTFUN1,NEWTON,NAT_1,REAL_1,FINSET_1,ARYTM_1,PCOMPS_2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,XREAL_0,REAL_1,TOPS_2,FUNCT_1,PARTFUN1,FUNCT_2,NAT_1,SETFAM_1,STRUCT_0,NEWTON,METRIC_1,PRE_TOPC,PCOMPS_1,WELLORD1,RELAT_1,FINSEQ_1,FINSET_1,RELAT_2,FINSEQ_2,XXREAL_0,CKB3,CKB4,CKB5,CKB10;
definitions TARSKI,WELLORD1,RELAT_2,SETFAM_1,XBOOLE_0,PRE_TOPC,STRUCT_0,CKB3,CKB4,CKB5;
theorems PCOMPS_1,COMPTS_1,SETFAM_1,TOPS_1,TOPS_2,PRE_TOPC,SUBSET_1,TARSKI,WELLORD2,ZFMISC_1,NAT_1,PREPOWER,WELLORD1,RELAT_1,RELAT_2,FUNCT_1,METRIC_1,FINSEQ_1,CARD_1,FINSEQ_2,FINSEQ_4,TBSP_1,NEWTON,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,PARTFUN1,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9;
schemes NAT_1,FUNCT_2,SUBSET_1,RECDEF_1,TREES_2,FRAENKEL,XBOOLE_0,CKB2;
registrations SUBSET_1,ORDINAL1,RELSET_1,FINSET_1,XXREAL_0,NAT_1,MEMBERED,FINSEQ_1,STRUCT_0,PRE_TOPC,METRIC_1,TOPS_1;
constructors SETFAM_1,RELAT_2,WELLORD1,WELLORD2,XXREAL_0,REAL_1,NAT_1,PARTFUN1,MEMBERED,NEWTON,TOPS_2,COMPTS_1,PCOMPS_1,RELSET_1,CKB3,CKB4,CKB5,CKB10;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve PT for non  empty TopSpace;
reserve PM for MetrSpace;
reserve V for (Subset of PT);
reserve n for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve q for (Element of ( NAT ));
scheme XXX1 { PM() -> non  empty set,UB() -> (Subset-Family of PM()),F(set,set) -> (Subset of PM()),P[set],Q[set,set,set,set] } : (ex f being (Function of ( NAT ),( bool ( bool PM() ) )) st (( f . ( 0 ) ) = UB() & (for n holds ( f . ( n + 1 ) ) = { ( union { F(c,n) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( f . q )) implies Q[ c,V,n,fq ]))) } ) where V is (Subset of PM()): P[ V ] })))
proof
reconsider A = <* UB() *> as (Element of ( ( bool ( bool PM() ) ) * )) by FINSEQ_1:def 11;
defpred T[ (Element of ( NAT )),(FinSequence of ( bool ( bool PM() ) )),set ]
 means
$3 = ( $2 ^ <* { ( union { F(c,$1) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= $1 & fq = ( $2 /. ( q + 1 ) )) implies Q[ c,V,$1,fq ]))) } ) where V is (Subset of PM()): P[ V ] } *> );
A1: (for n being (Element of ( NAT )) holds (for x being (Element of ( ( bool ( bool PM() ) ) * )) holds (ex y being (Element of ( ( bool ( bool PM() ) ) * )) st T[ n,x,y ])))
proof
let n;
let x being (Element of ( ( bool ( bool PM() ) ) * ));
set T = { ( union { F(c,n) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( x /. ( q + 1 ) )) implies Q[ c,V,n,fq ]))) } ) where V is (Subset of PM()): P[ V ] };
now
let X being set;
assume X in T;
then consider V being (Subset of PM()) such that A2: X = ( union { F(c,n) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( x /. ( q + 1 ) )) implies Q[ c,V,n,fq ]))) } ) and P[ V ];
now
let a being set;
assume a in X;
then consider P being set such that A3: a in P and A4: P in { F(c,n) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( x /. ( q + 1 ) )) implies Q[ c,V,n,fq ]))) } by A2,TARSKI:def 4;
(ex c being (Element of PM()) st (P = F(c,n) & (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( x /. ( q + 1 ) )) implies Q[ c,V,n,fq ]))))) by A4;
hence a in PM() by A3;
end;
then X c= PM() by TARSKI:def 3;
hence X in ( bool PM() );
end;
then reconsider T as (Subset-Family of PM()) by TARSKI:def 3;
reconsider T1 = <* T *> as (FinSequence of ( bool ( bool PM() ) ));
consider y being (FinSequence of ( bool ( bool PM() ) )) such that A5: y = ( x ^ T1 );
reconsider y as (Element of ( ( bool ( bool PM() ) ) * )) by FINSEQ_1:def 11;
take y;
thus thesis by A5;
end;
consider g being (Function of ( NAT ),( ( bool ( bool PM() ) ) * )) such that A6: ( g . ( 0 ) ) = A and A7: (for n being (Element of ( NAT )) holds T[ n,( g . n ),( g . ( n + 1 ) ) ]) from RECDEF_1:sch 2(A1);
defpred R[ (Element of ( NAT )) ]
 means
( len ( g . $1 ) ) = ( $1 + 1 );
A8: (for k holds (R[ k ] implies R[ ( k + 1 ) ]))
proof
let k;
assume that
A9: ( len ( g . k ) ) = ( k + 1 );
( len ( g . ( k + 1 ) ) ) = ( len ( ( g . k ) ^ <* { ( union { F(c,k) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= k & fq = ( ( g . k ) /. ( q + 1 ) )) implies Q[ c,V,k,fq ]))) } ) where V is (Subset of PM()): P[ V ] } *> ) ) by A7
.= ( ( len ( g . k ) ) + 1 ) by FINSEQ_2:16;
hence thesis by A9;
end;
deffunc G((Element of ( NAT ))) = ( ( g . $1 ) /. ( len ( g . $1 ) ) );
consider f being (Function of ( NAT ),( bool ( bool PM() ) )) such that A10: (for n holds ( f . n ) = G(n)) from FUNCT_2:sch 4;
take f;
( len <* UB() *> ) = 1 by FINSEQ_1:39;
hence ( f . ( 0 ) ) = ( <* UB() *> /. 1 ) by A6,A10
.= UB() by FINSEQ_4:16;
let n;
defpred T[ (Element of ( NAT )) ]
 means
(for q holds (q <= $1 implies ( f . q ) = ( ( g . $1 ) /. ( q + 1 ) )));
A11: R[ ( 0 ) ] by A6,FINSEQ_1:39;
A12: (for n holds R[ n ]) from NAT_1:sch 1(A11,A8);
then A13: ( ( len ( g . n ) ) + 1 ) = ( ( n + 1 ) + 1 );
A14: (for k holds (T[ k ] implies T[ ( k + 1 ) ]))
proof
let k;
assume A15: (for q holds (q <= k implies ( f . q ) = ( ( g . k ) /. ( q + 1 ) )));
let q;
assume A16: q <= ( k + 1 );
now
per cases  by A16,XXREAL_0:1;
suppose A17: q = ( k + 1 );

thus ( f . q ) = ( ( g . q ) /. ( len ( g . q ) ) ) by A10
.= ( ( g . ( k + 1 ) ) /. ( q + 1 ) ) by A12,A17;
end;
suppose A18: q < ( k + 1 );

A19: ( q + 1 ) >= 1 by NAT_1:11;
( q + 1 ) <= ( k + 1 ) by A18,NAT_1:13;
then A20: ( q + 1 ) in ( Seg ( k + 1 ) ) by A19,FINSEQ_1:1;
then ( q + 1 ) in ( Seg ( len ( g . k ) ) ) by A12;
then A21: ( q + 1 ) in ( dom ( g . k ) ) by FINSEQ_1:def 3;
A22: q <= k by A18,NAT_1:13;
( ( k + 1 ) + 1 ) >= ( k + 1 ) by NAT_1:11;
then ( Seg ( k + 1 ) ) c= ( Seg ( ( k + 1 ) + 1 ) ) by FINSEQ_1:5;
then ( q + 1 ) in ( Seg ( ( k + 1 ) + 1 ) ) by A20;
then ( q + 1 ) in ( Seg ( len ( g . ( k + 1 ) ) ) ) by A12;
then ( q + 1 ) in ( dom ( g . ( k + 1 ) ) ) by FINSEQ_1:def 3;
hence ( ( g . ( k + 1 ) ) /. ( q + 1 ) ) = ( ( g . ( k + 1 ) ) . ( q + 1 ) ) by PARTFUN1:def 6
.= ( ( ( g . k ) ^ <* { ( union { F(c,k) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= k & fq = ( ( g . k ) /. ( q + 1 ) )) implies Q[ c,V,k,fq ]))) } ) where V is (Subset of PM()): P[ V ] } *> ) . ( q + 1 ) ) by A7
.= ( ( g . k ) . ( q + 1 ) ) by A21,FINSEQ_1:def 7
.= ( ( g . k ) /. ( q + 1 ) ) by A21,PARTFUN1:def 6
.= ( f . q ) by A15,A22;
end;
end;
hence thesis;
end;
deffunc G2(set) = ( union { F(c,n) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( ( g . n ) /. ( q + 1 ) )) implies Q[ c,$1,n,fq ]))) } );
deffunc F2(set) = ( union { F(c,n) where c is (Element of PM()): (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( f . q )) implies Q[ c,$1,n,fq ]))) } );
set NF = { F2(V) where V is (Subset of PM()): P[ V ] };
( len ( g . ( n + 1 ) ) ) = ( ( n + 1 ) + 1 ) by A12;
then A23: ( dom ( g . ( n + 1 ) ) ) = ( Seg ( ( n + 1 ) + 1 ) ) by FINSEQ_1:def 3;
A24: T[ ( 0 ) ]
proof
let q;
assume q <= ( 0 );
then A25: q = ( 0 );
thus ( f . q ) = ( ( g . q ) /. ( len ( g . q ) ) ) by A10
.= ( ( g . ( 0 ) ) /. ( q + 1 ) ) by A6,A25,FINSEQ_1:39;
end;
A26: (for n holds T[ n ]) from NAT_1:sch 1(A24,A14);
A27: (for V being (Subset of PM()) holds (P[ V ] implies F2(V) = G2(V)))
proof
deffunc F1(set) = F($1,n);
let V being (Subset of PM());
assume that
P[ V ];
defpred P1[ set ]
 means
(for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( f . q )) implies Q[ $1,V,n,fq ])));
defpred P[ set ]
 means
(for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( ( g . n ) /. ( q + 1 ) )) implies Q[ $1,V,n,fq ])));
A28: (for c being (Element of PM()) holds (P1[ c ] iff P[ c ]))
proof
let c being (Element of PM());
thus ((for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( f . q )) implies Q[ c,V,n,fq ]))) implies (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( ( g . n ) /. ( q + 1 ) )) implies Q[ c,V,n,fq ]))))
proof
assume A29: (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( f . q )) implies Q[ c,V,n,fq ])));
let fq being (Subset-Family of PM());
let q;
assume that
A30: q <= n
and
A31: fq = ( ( g . n ) /. ( q + 1 ) );
fq = ( f . q ) by A26,A30,A31;
hence thesis by A29,A30;
end;

assume A32: (for fq being (Subset-Family of PM()) holds (for q holds ((q <= n & fq = ( ( g . n ) /. ( q + 1 ) )) implies Q[ c,V,n,fq ])));
let fq being (Subset-Family of PM());
let q;
assume that
A33: q <= n
and
A34: fq = ( f . q );
( f . q ) = ( ( g . n ) /. ( q + 1 ) ) by A26,A33;
hence thesis by A32,A33,A34;
end;
{ F1(c) where c is (Element of PM()): P1[ c ] } = { F1(c) where c is (Element of PM()): P[ c ] } from FRAENKEL:sch 3(A28);
hence thesis;
end;
A35: NF = { G2(V) where V is (Subset of PM()): P[ V ] } from FRAENKEL:sch 6(A27);
then ( len ( g . ( n + 1 ) ) ) = ( len ( ( g . n ) ^ <* NF *> ) ) by A7
.= ( ( len ( g . n ) ) + 1 ) by FINSEQ_2:16;
hence ( f . ( n + 1 ) ) = ( ( g . ( n + 1 ) ) /. ( ( len ( g . n ) ) + 1 ) ) by A10
.= ( ( g . ( n + 1 ) ) . ( ( len ( g . n ) ) + 1 ) ) by A23,A13,FINSEQ_1:4,PARTFUN1:def 6
.= ( ( ( g . n ) ^ <* NF *> ) . ( ( len ( g . n ) ) + 1 ) ) by A7,A35
.= NF by FINSEQ_1:42;
end;
