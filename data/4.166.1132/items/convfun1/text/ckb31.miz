environ
vocabularies NUMBERS,XBOOLE_0,RLVECT_1,BINOP_1,ZFMISC_1,STRUCT_0,SUBSET_1,FUNCT_1,ALGSTR_0,REAL_1,SUPINF_2,RELAT_1,ARYTM_3,XREAL_0,ORDINAL1,FINSEQ_1,CARD_3,CARD_1,XXREAL_0,TARSKI,PARTFUN1,ORDINAL4,BINOP_2,ARYTM_1,SUPINF_1,NAT_1,FUNCT_2,RFINSEQ,MEASURE6,CONVEX1,RFUNCT_3,FINSET_1,CLASSES1,CONVFUN1;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,ORDINAL1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,FUNCT_1,RELSET_1,PARTFUN1,SUPINF_1,ZFMISC_1,MEASURE6,BINOP_1,FUNCT_2,SUPINF_2,SEQ_1,DOMAIN_1,BINOP_2,FINSET_1,CLASSES1,RFINSEQ,RFUNCT_3,NAT_1,RVSUM_1,EXTREAL1,FINSEQ_1,FINSEQ_4,STRUCT_0,ALGSTR_0,RLVECT_1,CONVEX1,CKB1,CKB2,CKB3,CKB13,CKB26,CKB27;
definitions BINOP_1,RLVECT_1,RVSUM_1,STRUCT_0,ALGSTR_0,MEASURE6,CKB1,CKB2,CKB3,CKB13,CKB26,CKB27;
theorems ZFMISC_1,BINOP_1,FUNCT_2,CONVEX1,SUPINF_2,EXTREAL1,RLVECT_1,RFUNCT_3,RVSUM_1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FINSEQ_5,NAT_1,TARSKI,FUNCT_1,CARD_2,INT_1,XCMPLX_1,XBOOLE_0,RFINSEQ,RLVECT_2,RELAT_1,XBOOLE_1,BINOP_2,XREAL_1,XXREAL_0,XREAL_0,FINSOP_1,PARTFUN1,ALGSTR_0,VALUED_1,XXREAL_3,CKB1,CKB2,CKB3,CKB5,CKB6,CKB12,CKB13,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30;
schemes BINOP_1,DOMAIN_1,FINSEQ_2,FRAENKEL,NAT_1,RECDEF_1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FUNCT_2,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,FINSEQ_1,STRUCT_0,RLVECT_1,VALUED_0,ALGSTR_0,CARD_1,XXREAL_3,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB14;
constructors BINOP_1,DOMAIN_1,REAL_1,FINSEQ_4,FINSOP_1,RVSUM_1,SUPINF_2,RFINSEQ,RFUNCT_3,MEASURE6,EXTREAL1,CONVEX1,SEQ_1,BINOP_2,SUPINF_1,CLASSES1,RELSET_1,CKB1,CKB2,CKB3,CKB13,CKB26,CKB27;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
theorem
(for f being (PartFunc of ( REAL ),( REAL )) holds (for g being (Function of (the carrier of ( RLS_Real )),( ExtREAL )) holds (for X being (Subset of ( RLS_Real )) holds ((X c= ( dom f ) & (for x being Real holds ((x in X implies ( g . x ) = ( f . x )) & ((not x in X) implies ( g . x ) = ( +infty ))))) implies (g is  convex iff (f is_convex_on X & X is  convex))))))
proof
let f being (PartFunc of ( REAL ),( REAL ));
let g being (Function of (the carrier of ( RLS_Real )),( ExtREAL ));
let X being (Subset of ( RLS_Real ));
assume that
A1: X c= ( dom f )
and
A2: (for x being Real holds ((x in X implies ( g . x ) = ( f . x )) & ((not x in X) implies ( g . x ) = ( +infty ))));
A3: (for v being (VECTOR of ( RLS_Real )) holds ( g . v ) <> ( -infty ))
proof
let v being (VECTOR of ( RLS_Real ));
reconsider x = v as Real;
( f . x ) in ( REAL );
hence thesis by A2;
end;
A4: (for v being (VECTOR of ( RLS_Real )) holds (v in X implies ( g . v ) in ( REAL )))
proof
let v being (VECTOR of ( RLS_Real ));
reconsider x = v as Real;
assume v in X;
then ( g . x ) = ( f . x ) by A2;
hence thesis;
end;
thus (g is  convex implies (f is_convex_on X & X is  convex))
proof
assume A5: g is  convex;
(for p being Real holds ((( 0 ) <= p & p <= 1) implies (for x1,x2 being Real holds (((x1 in X & x2 in X) & ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) in X) implies ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) <= ( ( p * ( f . x1 ) ) + ( ( 1 - p ) * ( f . x2 ) ) )))))
proof
let p being Real;
assume that
A6: ( 0 ) <= p
and
A7: p <= 1;
let x1 being Real,x2 being Real;
assume that
A8: x1 in X
and
A9: x2 in X
and
A10: ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) in X;
A11: ( f . x1 ) = ( g . x1 ) by A2,A8;
A12: ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) = ( g . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) by A2,A10;
A13: ( f . x2 ) = ( g . x2 ) by A2,A9;
per cases ;
suppose p = ( 0 );

hence thesis;
end;
suppose p = 1;

hence thesis;
end;
suppose A14: (p <> ( 0 ) & p <> 1);

reconsider v2 = x2 as (VECTOR of ( RLS_Real ));
reconsider v1 = x1 as (VECTOR of ( RLS_Real ));
A15: ( ( 1 - p ) * v2 ) = ( ( 1 - p ) * x2 ) by BINOP_2:def 11;
( p * v1 ) = ( p * x1 ) by BINOP_2:def 11;
then A16: ( g . ( ( p * v1 ) + ( ( 1 - p ) * v2 ) ) ) = ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) by A12,A15,BINOP_2:def 9;
A17: p < 1 by A7,A14,XXREAL_0:1;
( ( p * ( f . v1 ) ) + ( ( 1 - p ) * ( f . v2 ) ) ) = ( ( ( R_EAL p ) * ( g . v1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) ) by A11,A13,CKB28:1;
hence thesis by A3,A5,A6,A14,A17,A16,CKB29:1;
end;
end;
hence f is_convex_on X by A1,RFUNCT_3:def 12;
(for v1,v2 being (VECTOR of ( RLS_Real )) holds (for p being Real holds ((((( 0 ) < p & p < 1) & v1 in X) & v2 in X) implies ( ( p * v1 ) + ( ( 1 - p ) * v2 ) ) in X)))
proof
let v1 being (VECTOR of ( RLS_Real )),v2 being (VECTOR of ( RLS_Real ));
let p being Real;
assume that
A18: ( 0 ) < p
and
A19: p < 1
and
A20: v1 in X
and
A21: v2 in X;
reconsider w1 = ( g . v1 ),w2 = ( g . v2 ) as Real by A4,A20,A21;
A22: ( ( p * w1 ) + ( ( 1 - p ) * w2 ) ) = ( ( ( R_EAL p ) * ( g . v1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) ) by CKB28:1;
( g . ( ( p * v1 ) + ( ( 1 - p ) * v2 ) ) ) <= ( ( ( R_EAL p ) * ( g . v1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) ) by A3,A5,A18,A19,CKB29:1;
then ( g . ( ( p * v1 ) + ( ( 1 - p ) * v2 ) ) ) <> ( +infty ) by A22,XXREAL_0:9;
hence thesis by A2;
end;
hence X is  convex by CONVEX1:def 2;
end;

thus ((f is_convex_on X & X is  convex) implies g is  convex)
proof
assume that
A23: f is_convex_on X
and
A24: X is  convex;
(for v1,v2 being (VECTOR of ( RLS_Real )) holds (for p being Real holds ((( 0 ) < p & p < 1) implies ( g . ( ( p * v1 ) + ( ( 1 - p ) * v2 ) ) ) <= ( ( ( R_EAL p ) * ( g . v1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) ))))
proof
let v1 being (VECTOR of ( RLS_Real )),v2 being (VECTOR of ( RLS_Real ));
let p being Real;
assume that
A25: ( 0 ) < p
and
A26: p < 1;
reconsider x2 = v2 as Real;
reconsider x1 = v1 as Real;
A27: ( 1 - p ) > ( 0 ) by A26,XREAL_1:50;
per cases ;
suppose A28: (v1 in X & v2 in X);

then A29: ( f . x2 ) = ( g . v2 ) by A2;
( f . x1 ) = ( g . v1 ) by A2,A28;
then A30: ( ( p * ( f . x1 ) ) + ( ( 1 - p ) * ( f . x2 ) ) ) = ( ( ( R_EAL p ) * ( g . v1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) ) by A29,CKB28:1;
A31: ( ( 1 - p ) * v2 ) = ( ( 1 - p ) * x2 ) by BINOP_2:def 11;
( p * v1 ) = ( p * x1 ) by BINOP_2:def 11;
then A32: ( ( p * v1 ) + ( ( 1 - p ) * v2 ) ) = ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) by A31,BINOP_2:def 9;
A33: ( ( p * v1 ) + ( ( 1 - p ) * v2 ) ) in X by A24,A25,A26,A28,CONVEX1:def 2;
then ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) = ( g . ( ( p * v1 ) + ( ( 1 - p ) * v2 ) ) ) by A2,A32;
hence thesis by A23,A25,A26,A28,A33,A32,A30,RFUNCT_3:def 12;
end;
suppose A34: (v1 in X & (not v2 in X));

then ( g . x2 ) = ( +infty ) by A2;
then A35: ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) = ( +infty ) by A27,XXREAL_3:def 5;
reconsider w1 = ( g . x1 ) as Real by A4,A34;
( p * w1 ) = ( ( R_EAL p ) * ( g . v1 ) ) by EXTREAL1:1;
then ( ( ( R_EAL p ) * ( g . v1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) ) = ( +infty ) by A35,XXREAL_3:def 2;
hence thesis by XXREAL_0:4;
end;
suppose A36: ((not v1 in X) & v2 in X);

then ( g . x1 ) = ( +infty ) by A2;
then A37: ( ( R_EAL p ) * ( g . v1 ) ) = ( +infty ) by A25,XXREAL_3:def 5;
reconsider w2 = ( g . x2 ) as Real by A4,A36;
( ( 1 - p ) * w2 ) = ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) by EXTREAL1:1;
then ( ( ( R_EAL p ) * ( g . v1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) ) = ( +infty ) by A37,XXREAL_3:def 2;
hence thesis by XXREAL_0:4;
end;
suppose A38: ((not v1 in X) & (not v2 in X));

then ( g . x2 ) = ( +infty ) by A2;
then A39: ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) = ( +infty ) by A27,XXREAL_3:def 5;
( g . x1 ) = ( +infty ) by A2,A38;
then ( ( ( R_EAL p ) * ( g . v1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( g . v2 ) ) ) = ( +infty ) by A25,A39,XXREAL_3:def 2;
hence thesis by XXREAL_0:4;
end;
end;
hence thesis by A3,CKB29:1;
end;

end;
