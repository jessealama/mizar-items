environ
vocabularies NUMBERS,XBOOLE_0,RLVECT_1,BINOP_1,ZFMISC_1,STRUCT_0,SUBSET_1,FUNCT_1,ALGSTR_0,REAL_1,SUPINF_2,RELAT_1,ARYTM_3,XREAL_0,ORDINAL1,FINSEQ_1,CARD_3,CARD_1,XXREAL_0,TARSKI,PARTFUN1,ORDINAL4,BINOP_2,ARYTM_1,SUPINF_1,NAT_1,FUNCT_2,RFINSEQ,MEASURE6,CONVEX1,RFUNCT_3,FINSET_1,CLASSES1,CONVFUN1;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,ORDINAL1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,FUNCT_1,RELSET_1,PARTFUN1,SUPINF_1,ZFMISC_1,MEASURE6,BINOP_1,FUNCT_2,SUPINF_2,SEQ_1,DOMAIN_1,BINOP_2,FINSET_1,CLASSES1,RFINSEQ,RFUNCT_3,NAT_1,RVSUM_1,EXTREAL1,FINSEQ_1,FINSEQ_4,STRUCT_0,ALGSTR_0,RLVECT_1,CONVEX1,CKB1,CKB2,CKB3,CKB13,CKB26,CKB27;
definitions BINOP_1,RLVECT_1,RVSUM_1,STRUCT_0,ALGSTR_0,MEASURE6,CKB1,CKB2,CKB3,CKB13,CKB26,CKB27;
theorems ZFMISC_1,BINOP_1,FUNCT_2,CONVEX1,SUPINF_2,EXTREAL1,RLVECT_1,RFUNCT_3,RVSUM_1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FINSEQ_5,NAT_1,TARSKI,FUNCT_1,CARD_2,INT_1,XCMPLX_1,XBOOLE_0,RFINSEQ,RLVECT_2,RELAT_1,XBOOLE_1,BINOP_2,XREAL_1,XXREAL_0,XREAL_0,FINSOP_1,PARTFUN1,ALGSTR_0,VALUED_1,XXREAL_3,CKB1,CKB2,CKB3,CKB5,CKB6,CKB12,CKB13,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28;
schemes BINOP_1,DOMAIN_1,FINSEQ_2,FRAENKEL,NAT_1,RECDEF_1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FUNCT_2,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,FINSEQ_1,STRUCT_0,RLVECT_1,VALUED_0,ALGSTR_0,CARD_1,XXREAL_3,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB14;
constructors BINOP_1,DOMAIN_1,REAL_1,FINSEQ_4,FINSOP_1,RVSUM_1,SUPINF_2,RFINSEQ,RFUNCT_3,MEASURE6,EXTREAL1,CONVEX1,SEQ_1,BINOP_2,SUPINF_1,CLASSES1,RELSET_1,CKB1,CKB2,CKB3,CKB13,CKB26,CKB27;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
theorem
Th9: (for X being non empty RLSStruct holds (for f being (Function of (the carrier of X),( ExtREAL )) holds ((for x being (VECTOR of X) holds ( f . x ) <> ( -infty )) implies (f is  convex iff (for x1,x2 being (VECTOR of X) holds (for p being Real holds ((( 0 ) < p & p < 1) implies ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) <= ( ( ( R_EAL p ) * ( f . x1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( f . x2 ) ) ))))))))
proof
let X being non empty RLSStruct;
let f being (Function of (the carrier of X),( ExtREAL ));
assume A1: (for x being (VECTOR of X) holds ( f . x ) <> ( -infty ));
thus (f is  convex implies (for x1,x2 being (VECTOR of X) holds (for p being Real holds ((( 0 ) < p & p < 1) implies ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) <= ( ( ( R_EAL p ) * ( f . x1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( f . x2 ) ) )))))
proof
assume f is  convex;
then A2: ( epigraph f ) is  convex by CKB27:def 1;
let x1 being (VECTOR of X),x2 being (VECTOR of X);
let p being Real;
assume that
A3: ( 0 ) < p
and
A4: p < 1;
set p2 = ( R_EAL ( 1 - p ) );
set p1 = ( R_EAL p );
A5: ( 1 - p ) > ( 0 ) by A4,XREAL_1:50;
per cases  by A1,XXREAL_0:14;
suppose A6: (( f . x1 ) in ( REAL ) & ( f . x2 ) in ( REAL ));

then reconsider w2 = ( f . x2 ) as Real;
reconsider w1 = ( f . x1 ) as Real by A6;
reconsider u1 = [ x1,w1 ] as (VECTOR of ( Prod_of_RLS (X,( RLS_Real )) ));
reconsider u2 = [ x2,w2 ] as (VECTOR of ( Prod_of_RLS (X,( RLS_Real )) ));
( f . x2 ) <= ( R_EAL w2 );
then A7: [ x2,w2 ] in ( epigraph f );
A8: ( p * u1 ) = [ ( p * x1 ),( p * w1 ) ] by CKB15:1;
A9: ( ( 1 - p ) * u2 ) = [ ( ( 1 - p ) * x2 ),( ( 1 - p ) * w2 ) ] by CKB15:1;
( f . x1 ) <= ( R_EAL w1 );
then [ x1,w1 ] in ( epigraph f );
then ( ( p * u1 ) + ( ( 1 - p ) * u2 ) ) in ( epigraph f ) by A2,A3,A4,A7,CONVEX1:def 2;
then [ ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ),( ( p * w1 ) + ( ( 1 - p ) * w2 ) ) ] in ( epigraph f ) by A8,A9,CKB16:1;
then consider x0 being (Element of X),y0 being (Element of ( REAL )) such that A10: [ ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ),( ( p * w1 ) + ( ( 1 - p ) * w2 ) ) ] = [ x0,y0 ] and A11: ( f . x0 ) <= ( R_EAL y0 );
A12: y0 = ( ( p * w1 ) + ( ( 1 - p ) * w2 ) ) by A10,ZFMISC_1:27;
x0 = ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) by A10,ZFMISC_1:27;
hence thesis by A11,A12,CKB28:1;
end;
suppose A13: (( f . x1 ) = ( +infty ) & ( f . x2 ) in ( REAL ));

A14: ( p2 * ( f . x2 ) ) in ( REAL )
proof
reconsider w2 = ( f . x2 ) as Real by A13;
( p2 * ( f . x2 ) ) = ( ( 1 - p ) * w2 ) by EXTREAL1:1;
hence thesis;
end;
( p1 * ( f . x1 ) ) = ( +infty ) by A3,A13,XXREAL_3:def 5;
then ( ( p1 * ( f . x1 ) ) + ( p2 * ( f . x2 ) ) ) = ( +infty ) by A14,XXREAL_3:def 2;
hence thesis by XXREAL_0:4;
end;
suppose A15: (( f . x1 ) in ( REAL ) & ( f . x2 ) = ( +infty ));

A16: ( p1 * ( f . x1 ) ) in ( REAL )
proof
reconsider w1 = ( f . x1 ) as Real by A15;
( p1 * ( f . x1 ) ) = ( p * w1 ) by EXTREAL1:1;
hence thesis;
end;
( p2 * ( f . x2 ) ) = ( +infty ) by A5,A15,XXREAL_3:def 5;
then ( ( p1 * ( f . x1 ) ) + ( p2 * ( f . x2 ) ) ) = ( +infty ) by A16,XXREAL_3:def 2;
hence thesis by XXREAL_0:4;
end;
suppose A17: (( f . x1 ) = ( +infty ) & ( f . x2 ) = ( +infty ));

then ( p2 * ( f . x2 ) ) = ( +infty ) by A5,XXREAL_3:def 5;
then ( ( p1 * ( f . x1 ) ) + ( p2 * ( f . x2 ) ) ) = ( +infty ) by A3,A17,XXREAL_3:def 2;
hence thesis by XXREAL_0:4;
end;
end;

assume A18: (for x1,x2 being (VECTOR of X) holds (for p being Real holds ((( 0 ) < p & p < 1) implies ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) <= ( ( ( R_EAL p ) * ( f . x1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( f . x2 ) ) ))));
(for u1,u2 being (VECTOR of ( Prod_of_RLS (X,( RLS_Real )) )) holds (for p being Real holds ((((( 0 ) < p & p < 1) & u1 in ( epigraph f )) & u2 in ( epigraph f )) implies ( ( p * u1 ) + ( ( 1 - p ) * u2 ) ) in ( epigraph f ))))
proof
let u1 being (VECTOR of ( Prod_of_RLS (X,( RLS_Real )) )),u2 being (VECTOR of ( Prod_of_RLS (X,( RLS_Real )) ));
let p being Real;
assume that
A19: ( 0 ) < p
and
A20: p < 1
and
A21: u1 in ( epigraph f )
and
A22: u2 in ( epigraph f );
thus ( ( p * u1 ) + ( ( 1 - p ) * u2 ) ) in ( epigraph f )
proof
consider x2 being (Element of X),y2 being (Element of ( REAL )) such that A23: u2 = [ x2,y2 ] and A24: ( f . x2 ) <= ( R_EAL y2 ) by A22;
A25: ( ( 1 - p ) * u2 ) = [ ( ( 1 - p ) * x2 ),( ( 1 - p ) * y2 ) ] by A23,CKB15:1;
( f . x2 ) <> ( +infty ) by A24,XXREAL_0:9;
then reconsider w2 = ( f . x2 ) as Real by A1,XXREAL_0:14;
consider x1 being (Element of X),y1 being (Element of ( REAL )) such that A26: u1 = [ x1,y1 ] and A27: ( f . x1 ) <= ( R_EAL y1 ) by A21;
( f . x1 ) <> ( +infty ) by A27,XXREAL_0:9;
then reconsider w1 = ( f . x1 ) as Real by A1,XXREAL_0:14;
( 1 - p ) > ( 0 ) by A20,XREAL_1:50;
then ( ( 1 - p ) * w2 ) <= ( ( 1 - p ) * y2 ) by A24,XREAL_1:64;
then A28: ( ( p * w1 ) + ( ( 1 - p ) * w2 ) ) <= ( ( p * w1 ) + ( ( 1 - p ) * y2 ) ) by XREAL_1:6;
( p * w1 ) <= ( p * y1 ) by A19,A27,XREAL_1:64;
then ( ( p * w1 ) + ( ( 1 - p ) * y2 ) ) <= ( ( p * y1 ) + ( ( 1 - p ) * y2 ) ) by XREAL_1:6;
then A29: ( ( p * w1 ) + ( ( 1 - p ) * w2 ) ) <= ( ( p * y1 ) + ( ( 1 - p ) * y2 ) ) by A28,XXREAL_0:2;
A30: ( R_EAL ( ( p * w1 ) + ( ( 1 - p ) * w2 ) ) ) = ( ( ( R_EAL p ) * ( f . x1 ) ) + ( ( R_EAL ( 1 - p ) ) * ( f . x2 ) ) ) by CKB28:1;
then ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) <> ( +infty ) by A18,A19,A20,XXREAL_0:9;
then reconsider w = ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) as Real by A1,XXREAL_0:14;
w <= ( ( p * w1 ) + ( ( 1 - p ) * w2 ) ) by A18,A19,A20,A30;
then ( f . ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ) ) <= ( R_EAL ( ( p * y1 ) + ( ( 1 - p ) * y2 ) ) ) by A29,XXREAL_0:2;
then A31: [ ( ( p * x1 ) + ( ( 1 - p ) * x2 ) ),( ( p * y1 ) + ( ( 1 - p ) * y2 ) ) ] in { [ x,y ] where x is (Element of X),y is (Element of ( REAL )): ( f . x ) <= ( R_EAL y ) };
( p * u1 ) = [ ( p * x1 ),( p * y1 ) ] by A26,CKB15:1;
hence thesis by A31,A25,CKB16:1;
end;

end;
then ( epigraph f ) is  convex by CONVEX1:def 2;
hence thesis by CKB27:def 1;
end;
