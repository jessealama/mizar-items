environ
vocabularies ORDINAL1,FUNCT_1,XBOOLE_0,TARSKI,ZFMISC_1,RELAT_1,SETFAM_1,SUBSET_1,FUNCOP_1,ORDINAL2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,SETFAM_1,FUNCOP_1,CKB7,CKB17,CKB18,CKB31,CKB33;
definitions ORDINAL1,TARSKI,XBOOLE_0,CKB7,CKB17,CKB18,CKB31;
theorems TARSKI,XBOOLE_0,ORDINAL1,SETFAM_1,ZFMISC_1,FUNCT_1,RELAT_1,XBOOLE_1,FUNCOP_1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB31,CKB36;
schemes XBOOLE_0,FUNCT_1,ORDINAL1,CKB1,CKB30,CKB38,CKB39;
registrations XBOOLE_0,SUBSET_1,FUNCT_1,ORDINAL1,FUNCOP_1,CKB16,CKB32,CKB34,CKB35,CKB37;
constructors SETFAM_1,ORDINAL1,FUNCOP_1,CKB7,CKB17,CKB18,CKB31;
requirements SUBSET,BOOLE,NUMERALS;
begin
reserve A for Ordinal;
reserve A1 for Ordinal;
reserve B for Ordinal;
reserve C for Ordinal;
reserve D for Ordinal;
reserve x for set;
reserve a for set;
reserve b for set;
reserve c for set;
reserve L for T-Sequence;
reserve L1 for T-Sequence;
reserve L2 for T-Sequence;
reserve L3 for T-Sequence;
scheme TSExist1 { A() -> Ordinal,B() -> set,C(Ordinal,set) -> set,D(Ordinal,T-Sequence) -> set } : (ex L st (((( dom L ) = A() & (( {} ) in A() implies ( L . ( {} ) ) = B())) & (for A holds (( succ A ) in A() implies ( L . ( succ A ) ) = C(A,( L . A ))))) & (for A holds (((A in A() & A <> ( {} )) & A is  limit_ordinal) implies ( L . A ) = D(A,( L | A ))))))
proof
defpred P[ Ordinal,T-Sequence ]
 means
(((( dom $2 ) = $1 & (( {} ) in $1 implies ( $2 . ( {} ) ) = B())) & (for A holds (( succ A ) in $1 implies ( $2 . ( succ A ) ) = C(A,( $2 . A ))))) & (for A holds (((A in $1 & A <> ( {} )) & A is  limit_ordinal) implies ( $2 . A ) = D(A,( $2 | A )))));
defpred R[ Ordinal ]
 means
(ex L st P[ $1,L ]);
A1: (for B holds ((for C holds (C in B implies R[ C ])) implies R[ B ]))
proof
defpred R[ set,set ]
 means
(($1 is Ordinal & $2 is T-Sequence) & (for A holds (for L holds ((A = $1 & L = $2) implies P[ A,L ]))));
let B;
assume that
A2: (for C holds (C in B implies (ex L st P[ C,L ])));
A3: (for a holds (for b holds (for c holds ((R[ a,b ] & R[ a,c ]) implies b = c))))
proof
let a;
let b;
let c;
assume that
A4: a is Ordinal
and
A5: b is T-Sequence
and
A6: (for A holds (for L holds ((A = a & L = b) implies P[ A,L ])))
and
a is Ordinal
and
A7: c is T-Sequence
and
A8: (for A holds (for L holds ((A = a & L = c) implies P[ A,L ])));
reconsider a as Ordinal by A4;
reconsider c as T-Sequence by A7;
A9: ( dom c ) = a by A8;
A10: (for A holds (((A in a & A <> ( {} )) & A is  limit_ordinal) implies ( c . A ) = D(A,( c | A )))) by A8;
A11: (for A holds (( succ A ) in a implies ( c . ( succ A ) ) = C(A,( c . A )))) by A8;
A12: (( {} ) in a implies ( c . ( {} ) ) = B()) by A8;
reconsider b as T-Sequence by A5;
A13: (( {} ) in a implies ( b . ( {} ) ) = B()) by A6;
A14: (for A holds (( succ A ) in a implies ( b . ( succ A ) ) = C(A,( b . A )))) by A6;
A15: (for A holds (((A in a & A <> ( {} )) & A is  limit_ordinal) implies ( b . A ) = D(A,( b | A )))) by A6;
A16: ( dom b ) = a by A6;
b = c from CKB39:sch 1(A16,A13,A14,A15,A9,A12,A11,A10);
hence thesis;
end;
consider G being Function such that A17: ([ a,b ] in G iff (a in B & R[ a,b ])) from FUNCT_1:sch 1(A3);
defpred Q[ set,set ]
 means
(ex A st (ex L st ((A = $1 & L = ( G . $1 )) & (((A = ( {} ) & $2 = B()) or (ex B st (A = ( succ B ) & $2 = C(B,( L . B ))))) or ((A <> ( {} ) & A is  limit_ordinal) & $2 = D(A,L))))));
A18: ( dom G ) = B
proof
thus (a in ( dom G ) implies a in B)
proof
assume a in ( dom G );
then (ex b st [ a,b ] in G) by RELAT_1:def 4;
hence thesis by A17;
end;

let a;
assume A19: a in B;
then reconsider a9 = a as Ordinal;
consider L such that A20: P[ a9,L ] by A2,A19;
(for A holds (for K being T-Sequence holds ((A = a9 & K = L) implies P[ A,K ]))) by A20;
then [ a9,L ] in G by A17,A19;
hence thesis by RELAT_1:def 4;
end;
A21: (for a holds (a in B implies (ex b st Q[ a,b ])))
proof
let a;
assume A22: a in B;
then reconsider A = a as Ordinal;
consider c such that A23: [ a,c ] in G by A18,A22,RELAT_1:def 4;
reconsider L = c as T-Sequence by A17,A23;
A24:now
given C such that
A25: A = ( succ C );

thus (ex b st Q[ a,b ])
proof
take C(C,( L . C ));
take A;
take L;
thus (A = a & L = ( G . a )) by A23,FUNCT_1:1;
thus thesis by A25;
end;

end;
A26:now
assume A27: (A <> ( {} ) & (for C holds A <> ( succ C )));
thus Q[ a,D(A,L) ]
proof
take A;
take L;
thus (A = a & L = ( G . a )) by A23,FUNCT_1:1;
thus thesis by A27,ORDINAL1:29;
end;

end;
now
assume A28: A = ( {} );
thus Q[ a,B() ]
proof
take A;
take L;
thus (A = a & L = ( G . a )) by A23,FUNCT_1:1;
thus thesis by A28;
end;

end;
hence thesis by A24,A26;
end;
A29: (for a holds (for b holds (for c holds (((a in B & Q[ a,b ]) & Q[ a,c ]) implies b = c))))
proof
let a;
let b;
let c;
assume that
a in B;
given Ab being Ordinal,Lb being T-Sequence such that
A30: Ab = a
and
A31: Lb = ( G . a )
and
A32: (((Ab = ( {} ) & b = B()) or (ex B st (Ab = ( succ B ) & b = C(B,( Lb . B ))))) or ((Ab <> ( {} ) & Ab is  limit_ordinal) & b = D(Ab,Lb)));

given Ac being Ordinal,Lc being T-Sequence such that
A33: Ac = a
and
A34: Lc = ( G . a )
and
A35: (((Ac = ( {} ) & c = B()) or (ex B st (Ac = ( succ B ) & c = C(B,( Lc . B ))))) or ((Ac <> ( {} ) & Ac is  limit_ordinal) & c = D(Ac,Lc)));

now
given C such that
A36: Ab = ( succ C );

consider A such that A37: Ab = ( succ A ) and A38: b = C(A,( Lb . A )) by A32,A36,ORDINAL1:29;
consider D such that A39: Ac = ( succ D ) and A40: c = C(D,( Lc . D )) by A30,A33,A35,A36,ORDINAL1:29;
A = D by A30,A33,A37,A39,ORDINAL1:7;
hence thesis by A31,A34,A38,A40;
end;
hence thesis by A30,A31,A32,A33,A34,A35;
end;
consider F being Function such that A41: (( dom F ) = B & (for a holds (a in B implies Q[ a,( F . a ) ]))) from FUNCT_1:sch 2(A29,A21);
reconsider L = F as T-Sequence by A41,ORDINAL1:def 7;
take L;
thus ( dom L ) = B by A41;
thus (( {} ) in B implies ( L . ( {} ) ) = B())
proof
assume ( {} ) in B;
then (ex A being Ordinal st (ex K being T-Sequence st ((A = ( {} ) & K = ( G . ( {} ) )) & (((A = ( {} ) & ( F . ( {} ) ) = B()) or (ex B st (A = ( succ B ) & ( F . ( {} ) ) = C(B,( K . B ))))) or ((A <> ( {} ) & A is  limit_ordinal) & ( F . ( {} ) ) = D(A,K)))))) by A41;
hence thesis;
end;

A42: (for A holds (for L1 holds ((A in B & L1 = ( G . A )) implies ( L | A ) = L1)))
proof
defpred P[ Ordinal ]
 means
(for L1 holds (($1 in B & L1 = ( G . $1 )) implies ( L | $1 ) = L1));
A43: (for A holds ((for C holds (C in A implies P[ C ])) implies P[ A ]))
proof
let A;
assume that
(for C holds (C in A implies (for L1 holds ((C in B & L1 = ( G . C )) implies ( L | C ) = L1))));
let L1;
assume that
A44: A in B
and
A45: L1 = ( G . A );
A46: [ A,L1 ] in G by A18,A44,A45,FUNCT_1:1;
then A47: P[ A,L1 ] by A17;
A48:now
let x;
assume A49: x in A;
then reconsider x9 = x as Ordinal;
A50: x9 in B by A44,A49,ORDINAL1:10;
then consider A1,L2 such that A51: A1 = x9 and A52: L2 = ( G . x9 ) and A53: (((A1 = ( {} ) & ( L . x9 ) = B()) or (ex B st (A1 = ( succ B ) & ( L . x9 ) = C(B,( L2 . B ))))) or ((A1 <> ( {} ) & A1 is  limit_ordinal) & ( L . x9 ) = D(A1,L2))) by A41;
(for D holds (for L3 holds ((D = x9 & L3 = ( L1 | x9 )) implies P[ D,L3 ])))
proof
let D;
let L3;
assume that
A54: D = x9
and
A55: L3 = ( L1 | x9 );
x9 c= A by A49,ORDINAL1:def 2;
hence ( dom L3 ) = D by A47,A54,A55,RELAT_1:62;
thus (( {} ) in D implies ( L3 . ( {} ) ) = B()) by A47,A49,A54,A55,FUNCT_1:49,ORDINAL1:10;
thus (( succ C ) in D implies ( L3 . ( succ C ) ) = C(C,( L3 . C )))
proof
assume A56: ( succ C ) in D;
C in ( succ C ) by ORDINAL1:6;
then A57: ( ( L1 | x9 ) . C ) = ( L1 . C ) by A54,A56,FUNCT_1:49,ORDINAL1:10;
(( succ C ) in A & ( ( L1 | x9 ) . ( succ C ) ) = ( L1 . ( succ C ) )) by A49,A54,A56,FUNCT_1:49,ORDINAL1:10;
hence thesis by A17,A46,A55,A57;
end;

let C;
assume that
A58: C in D
and
A59: (C <> ( {} ) & C is  limit_ordinal);
C c= x9 by A54,A58,ORDINAL1:def 2;
then A60: ( L1 | C ) = ( L3 | C ) by A55,FUNCT_1:51;
C in A by A49,A54,A58,ORDINAL1:10;
then ( L1 . C ) = D(C,( L3 | C )) by A17,A46,A59,A60;
hence thesis by A54,A55,A58,FUNCT_1:49;
end;
then [ x9,( L1 | x9 ) ] in G by A17,A50;
then A61: ( L1 | x9 ) = L2 by A52,FUNCT_1:1;
A62: ( ( L | A ) . x ) = ( L . x ) by A49,FUNCT_1:49;
now
given D such that
A63: x9 = ( succ D );

A64: ( L1 . x ) = C(D,( L1 . D )) by A17,A46,A49,A63;
consider C such that A65: A1 = ( succ C ) and A66: ( L . x9 ) = C(C,( L2 . C )) by A51,A53,A63,ORDINAL1:29;
C = D by A51,A63,A65,ORDINAL1:7;
hence ( L1 . x ) = ( ( L | A ) . x ) by A62,A61,A63,A66,A64,FUNCT_1:49,ORDINAL1:6;
end;
hence ( L1 . x ) = ( ( L | A ) . x ) by A17,A46,A49,A51,A53,A62,A61;
end;
A c= ( dom L ) by A41,A44,ORDINAL1:def 2;
then ( dom ( L | A ) ) = A by RELAT_1:62;
hence thesis by A47,A48,FUNCT_1:2;
end;
thus (for A holds P[ A ]) from ORDINAL1:sch 2(A43);
end;
thus (( succ A ) in B implies ( L . ( succ A ) ) = C(A,( L . A )))
proof
assume A67: ( succ A ) in B;
then consider C being Ordinal,K being T-Sequence such that A68: C = ( succ A ) and A69: K = ( G . ( succ A ) ) and A70: (((C = ( {} ) & ( F . ( succ A ) ) = B()) or (ex B st (C = ( succ B ) & ( F . ( succ A ) ) = C(B,( K . B ))))) or ((C <> ( {} ) & C is  limit_ordinal) & ( F . ( succ A ) ) = D(C,K))) by A41;
A71: K = ( L | ( succ A ) ) by A42,A67,A69;
consider D such that A72: C = ( succ D ) and A73: ( F . ( succ A ) ) = C(D,( K . D )) by A68,A70,ORDINAL1:29;
A = D by A68,A72,ORDINAL1:7;
hence thesis by A73,A71,FUNCT_1:49,ORDINAL1:6;
end;

let D;
assume that
A74: D in B
and
A75: (D <> ( {} ) & D is  limit_ordinal);
(ex A being Ordinal st (ex K being T-Sequence st ((A = D & K = ( G . D )) & (((A = ( {} ) & ( F . D ) = B()) or (ex B st (A = ( succ B ) & ( F . D ) = C(B,( K . B ))))) or ((A <> ( {} ) & A is  limit_ordinal) & ( F . D ) = D(A,K)))))) by A41,A74;
hence thesis by A42,A74,A75,ORDINAL1:29;
end;
(for A holds R[ A ]) from ORDINAL1:sch 2(A1);
hence thesis;
end;
