environ
vocabularies NUMBERS,NAT_1,VECTSP_1,FREEALG,FINSET_1,SUBSET_1,MATRIX_1,TREES_1,FINSEQ_1,RELAT_1,XXREAL_0,INCSP_1,FVSUM_1,CARD_3,RVSUM_1,GROUP_1,ARYTM_1,SUPINF_2,FUNCT_1,ARYTM_3,CARD_1,XBOOLE_0,ALGSTR_0,ORDINAL4,STRUCT_0,FINSEQ_2,TARSKI,RLVECT_1,PARTFUN1,VALUED_1,ZFMISC_1,CLASSES1,XCMPLX_0,MATRIX_3,MATRIX13,LAPLACE,PRVECT_1,RLVECT_3,LMOD_7,QC_LANG1,RLSUB_1,MESFUNC1,PRE_POLY,MATRIX11,MATRIXR1,AFINSQ_1,MATRIX_2,FINSEQ_3,FUNCT_2,SETWISEO,FINSOP_1,RLVECT_2,RLVECT_5,FUNCOP_1,FUNCT_4,MATRIX_6,MATRIX15;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,SETWOP_2,FINSEQ_1,STRUCT_0,FUNCOP_1,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,FVSUM_1,FINSOP_1,NAT_D,BINARITH,GROUP_4,MATRIX_3,MATRIX_6,MATRIX_7,FINSEQ_7,FUNCT_4,DOMAIN_1,MATRIX11,MEASURE6,PSCOMP_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,FINSEQOP,PRVECT_1,MATRIX13,PRE_POLY,MATRLIN,FUNCT_7,PNPROC_1,LAPLACE,CKB17;
definitions TARSKI,XBOOLE_0,RLVECT_1,FINSEQ_1,FINSEQ_2,MATRIX_1,GROUP_4,MATRIX_3,MATRIX_7,VECTSP_4,RELAT_1,LAPLACE,MATRIX13,FVSUM_1,ALGSTR_0;
theorems CARD_1,CARD_2,CARD_FIN,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQOP,FINSOP_1,FRECHET,FUNCT_1,FUNCT_2,FUNCT_7,FUNCOP_1,FVSUM_1,GROUP_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_4,MATRIX_5,MATRIX_6,MATRIX_7,MATRIX11,MATRIX13,MATRIXR1,MATRIXR2,MATRLIN,NAT_1,ORDINAL1,PARTFUN1,PNPROC_1,RELAT_1,RLVECT_1,STIRL2_1,STRUCT_0,TARSKI,WELLORD2,VECTSP_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,ZFMISC_1,NAT_D,PRE_POLY,MEASURE6,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26;
schemes FINSEQ_2,NAT_1,MATRIX_1;
registrations XBOOLE_0,FUNCT_1,FINSET_1,STRUCT_0,FVSUM_1,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,CARD_1,FUNCOP_1,SETFAM_1,FINSEQ_2,MATRLIN,MATRIX13,XREAL_0,PNPROC_1,VECTSP_9,VALUED_0,RELSET_1,PRVECT_1;
constructors SETWISEO,FINSOP_1,ALGSTR_1,FVSUM_1,XXREAL_0,GROUP_4,FINSEQ_7,WELLORD2,VECTSP_6,VECTSP_7,VECTSP_9,MATRIX_6,MATRIX_7,MATRIX11,MATRIX13,PNPROC_1,REALSET1,LAPLACE,BINOP_2,NAT_D,BINARITH,RELSET_1,PRE_POLY,PSCOMP_1,CKB17;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve i for Nat;
reserve j for Nat;
reserve K for Field;
reserve N for  without_zero  finite (Subset of ( NAT ));
reserve A for (Matrix of K);
reserve B for (Matrix of K);
theorem
Th24: (for A,B being (Matrix of K) holds ((( the_rank_of A ) = ( the_rank_of ( A ^^ B ) ) & ( len A ) = ( len B )) implies (for N holds ((N c= ( dom A ) & (for i holds (i in N implies ( Line (A,i) ) = ( ( width A ) |-> ( 0. K ) )))) implies (for i holds (i in N implies ( Line (B,i) ) = ( ( width B ) |-> ( 0. K ) )))))))
proof
let A being (Matrix of K);
let B being (Matrix of K);
assume that
A1: ( the_rank_of A ) = ( the_rank_of ( A ^^ B ) )
and
A2: ( len A ) = ( len B );
reconsider B9 = B as (Matrix of ( len A ),( width B ),K) by A2,MATRIX_2:7;
reconsider A9 = A as (Matrix of ( len A ),( width A ),K) by MATRIX_2:7;
set AB = ( A9 ^^ B9 );
let N;
assume that
A3: N c= ( dom A )
and
A4: (for i holds (i in N implies ( Line (A,i) ) = ( ( width A ) |-> ( 0. K ) )));
let i;
assume that
A5: i in N;
( dom A ) <> ( {} ) by A3,A5;
then ( Seg ( len A ) ) <> ( {} ) by FINSEQ_1:def 3;
then A6: ( len A ) <> ( 0 );
then A7: ( width AB ) = ( ( width A ) + ( width B ) ) by MATRIX_1:23;
then ( width A ) <= ( width AB ) by NAT_1:11;
then A8: ( Seg ( width A ) ) c= ( Seg ( width AB ) ) by FINSEQ_1:5;
A9: ( card ( Seg ( len A ) ) ) = ( len A ) by FINSEQ_1:57;
A10: ( Segm (AB,( Seg ( len A ) ),( Seg ( width A ) )) ) = A by CKB22:1;
A11: ( dom A ) = ( Seg ( len A ) ) by FINSEQ_1:def 3;
A12: ( ( Sgm ( Seg ( len A ) ) ) . i ) = ( ( idseq ( len A ) ) . i ) by FINSEQ_3:48
.= i by A3,A5,A11,FINSEQ_2:49;
( card ( Seg ( width A ) ) ) = ( width A ) by FINSEQ_1:57;
then A13: ( ( card ( Seg ( width A ) ) ) |-> ( 0. K ) ) = ( Line (A,i) ) by A4,A5
.= ( ( Line (AB,i) ) * ( Sgm ( Seg ( width A ) ) ) ) by A3,A5,A11,A10,A8,A9,A12,MATRIX13:47;
assume ( Line (B,i) ) <> ( ( width B ) |-> ( 0. K ) );
then consider j such that A14: j in ( Seg ( width B ) ) and A15: ( ( Line (B,i) ) . j ) <> ( ( ( width B ) |-> ( 0. K ) ) . j ) by FINSEQ_2:119;
A16: (( len ( Line (A9,i) ) ) = ( width A9 ) & 1 <= j) by A14,FINSEQ_1:1,MATRIX_1:def 7;
( len ( Line (B9,i) ) ) = ( width B9 ) by MATRIX_1:def 7;
then A17: j <= ( len ( Line (B9,i) ) ) by A14,FINSEQ_1:1;
A18: ( j + ( width A ) ) in ( Seg ( width AB ) ) by A14,A7,FINSEQ_1:60;
then ( AB * (i,( j + ( width A ) )) ) = ( ( Line (AB,i) ) . ( j + ( width A ) ) ) by MATRIX_1:def 7
.= ( ( ( Line (A9,i) ) ^ ( Line (B9,i) ) ) . ( j + ( width A ) ) ) by A3,A5,A11,CKB18:1
.= ( ( Line (B9,i) ) . j ) by A16,A17,FINSEQ_1:65;
then A19: ( AB * (i,( j + ( width A ) )) ) <> ( 0. K ) by A14,A15,FINSEQ_2:57;
consider P,Q being  without_zero  finite (Subset of ( NAT )) such that A20: [: P,Q :] c= ( Indices A9 ) and A21: ( card P ) = ( card Q ) and A22: ( card P ) = ( the_rank_of A9 ) and A23: ( Det ( EqSegm (A9,P,Q) ) ) <> ( 0. K ) by MATRIX13:def 4;
(P = ( {} ) iff Q = ( {} )) by A21;
then consider P2,Q2 being  without_zero  finite (Subset of ( NAT )) such that A24: P2 c= ( Seg ( len A ) ) and A25: Q2 c= ( Seg ( width A ) ) and A26: P2 = ( ( Sgm ( Seg ( len A ) ) ) .: P ) and Q2 = ( ( Sgm ( Seg ( width A ) ) ) .: Q ) and ( card P2 ) = ( card P ) and ( card Q2 ) = ( card Q ) and A27: ( Segm (A,P,Q) ) = ( Segm (AB,P2,Q2) ) by A20,A10,MATRIX13:57;
A28: ( Segm (AB,P2,Q2) ) = ( EqSegm (A,P,Q) ) by A21,A27,MATRIX13:def 3;
A29: (( dom AB ) = ( Seg ( len AB ) ) & ( len AB ) = ( len A )) by A6,FINSEQ_1:def 3,MATRIX_1:23;
then A30: [: P2,( Seg ( width A ) ) :] c= ( Indices AB ) by A24,A8,ZFMISC_1:96;
j >= 1 by A14,FINSEQ_1:1;
then ( j + ( width A ) ) >= ( 1 + ( width A ) ) by XREAL_1:6;
then ( j + ( width A ) ) > ( width A ) by NAT_1:13;
then (not ( j + ( width A ) ) in Q2) by A25,FINSEQ_1:1;
then A31: ( j + ( width A ) ) in ( ( Seg ( width AB ) ) \ Q2 ) by A18,XBOOLE_0:def 5;
(not i in P2)
proof
A32: ( Line (A,i) ) = ( ( width A ) |-> ( 0. K ) ) by A4,A5
.= ( ( 0. K ) * ( Line (A,i) ) ) by FVSUM_1:58;
A33: ( Sgm ( Seg ( len A ) ) ) = ( idseq ( len A ) ) by FINSEQ_3:48
.= ( id ( Seg ( len A ) ) );
A34: P c= ( Seg ( len A ) ) by A20,A21,MATRIX13:67;
then A35: ( rng ( Sgm P ) ) = P by FINSEQ_1:def 13;
assume i in P2;
then i in P by A26,A33,A34,FUNCT_1:92;
then consider x such that A36: x in ( dom ( Sgm P ) ) and A37: ( ( Sgm P ) . x ) = i by A35,FUNCT_1:def 3;
reconsider x as (Element of ( NAT )) by A36;
A38: ( Segm (A,P,Q) ) = ( EqSegm (A,P,Q) ) by A21,MATRIX13:def 3;
A39: Q c= ( Seg ( width A ) ) by A20,A21,MATRIX13:67;
then A40: ( rng ( Sgm Q ) ) = Q by FINSEQ_1:def 13;
A41: ( dom ( Sgm P ) ) = ( Seg ( card P ) ) by A34,FINSEQ_3:40;
then (( dom ( Line (A,i) ) ) = ( Seg ( width A ) ) & ( Line (( Segm (A,P,Q) ),x) ) = ( ( Line (A,i) ) * ( Sgm Q ) )) by A39,A36,A37,FINSEQ_2:124,MATRIX13:47;
then ( Line (( Segm (A,P,Q) ),x) ) = ( ( 0. K ) * ( Line (( Segm (A,P,Q) ),x) ) ) by A39,A40,A32,MATRIX13:87;
then ( ( 0. K ) * ( Det ( EqSegm (A,P,Q) ) ) ) = ( Det ( RLine (( EqSegm (A,P,Q) ),x,( Line (( EqSegm (A,P,Q) ),x) )) ) ) by A41,A36,A38,MATRIX11:35
.= ( Det ( EqSegm (A,P,Q) ) ) by MATRIX11:30;
hence thesis by A23,VECTSP_1:6;
end;
then i in ( ( dom AB ) \ P2 ) by A3,A5,A11,A29,XBOOLE_0:def 5;
then ( card P ) > ( the_rank_of ( Segm (AB,P2,Q2) ) ) by A1,A19,A22,A25,A30,A31,A13,CKB12:1;
hence thesis by A23,A28,MATRIX13:83;
end;
