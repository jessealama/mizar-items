environ
vocabularies NUMBERS,NAT_1,VECTSP_1,FREEALG,FINSET_1,SUBSET_1,MATRIX_1,TREES_1,FINSEQ_1,RELAT_1,XXREAL_0,INCSP_1,FVSUM_1,CARD_3,RVSUM_1,GROUP_1,ARYTM_1,SUPINF_2,FUNCT_1,ARYTM_3,CARD_1,XBOOLE_0,ALGSTR_0,ORDINAL4,STRUCT_0,FINSEQ_2,TARSKI,RLVECT_1,PARTFUN1,VALUED_1,ZFMISC_1,CLASSES1,XCMPLX_0,MATRIX_3,MATRIX13,LAPLACE,PRVECT_1,RLVECT_3,LMOD_7,QC_LANG1,RLSUB_1,MESFUNC1,PRE_POLY,MATRIX11,MATRIXR1,AFINSQ_1,MATRIX_2,FINSEQ_3,FUNCT_2,SETWISEO,FINSOP_1,RLVECT_2,RLVECT_5,FUNCOP_1,FUNCT_4,MATRIX_6,MATRIX15;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,SETWOP_2,FINSEQ_1,STRUCT_0,FUNCOP_1,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,FVSUM_1,FINSOP_1,NAT_D,BINARITH,GROUP_4,MATRIX_3,MATRIX_6,MATRIX_7,FINSEQ_7,FUNCT_4,DOMAIN_1,MATRIX11,MEASURE6,PSCOMP_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,FINSEQOP,PRVECT_1,MATRIX13,PRE_POLY,MATRLIN,FUNCT_7,PNPROC_1,LAPLACE;
definitions TARSKI,XBOOLE_0,RLVECT_1,FINSEQ_1,FINSEQ_2,MATRIX_1,GROUP_4,MATRIX_3,MATRIX_7,VECTSP_4,RELAT_1,LAPLACE,MATRIX13,FVSUM_1,ALGSTR_0;
theorems CARD_1,CARD_2,CARD_FIN,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQOP,FINSOP_1,FRECHET,FUNCT_1,FUNCT_2,FUNCT_7,FUNCOP_1,FVSUM_1,GROUP_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_4,MATRIX_5,MATRIX_6,MATRIX_7,MATRIX11,MATRIX13,MATRIXR1,MATRIXR2,MATRLIN,NAT_1,ORDINAL1,PARTFUN1,PNPROC_1,RELAT_1,RLVECT_1,STIRL2_1,STRUCT_0,TARSKI,WELLORD2,VECTSP_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,ZFMISC_1,NAT_D,PRE_POLY,MEASURE6,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10;
schemes FINSEQ_2,NAT_1,MATRIX_1;
registrations XBOOLE_0,FUNCT_1,FINSET_1,STRUCT_0,FVSUM_1,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,CARD_1,FUNCOP_1,SETFAM_1,FINSEQ_2,MATRLIN,MATRIX13,XREAL_0,PNPROC_1,VECTSP_9,VALUED_0,RELSET_1,PRVECT_1;
constructors SETWISEO,FINSOP_1,ALGSTR_1,FVSUM_1,XXREAL_0,GROUP_4,FINSEQ_7,WELLORD2,VECTSP_6,VECTSP_7,VECTSP_9,MATRIX_6,MATRIX_7,MATRIX11,MATRIX13,PNPROC_1,REALSET1,LAPLACE,BINOP_2,NAT_D,BINARITH,RELSET_1,PRE_POLY,PSCOMP_1;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve i for Nat;
reserve j for Nat;
reserve m for Nat;
reserve n for Nat;
reserve K for Field;
reserve A for (Matrix of K);
reserve B for (Matrix of K);
theorem
Th9: (for D being non  empty set holds (for A being (Matrix of D) holds (for Bx,By,Cx,Cy being  without_zero  finite (Subset of ( NAT )) holds (([: Bx,By :] c= ( Indices A ) & [: Cx,Cy :] c= ( Indices A )) implies (for B being (Matrix of ( card Bx ),( card By ),D) holds (for C being (Matrix of ( card Cx ),( card Cy ),D) holds ((for i,j,bi,bj,ci,cj being Nat holds ((((([ i,j ] in ( [: Bx,By :] /\ [: Cx,Cy :] ) & bi = ( ( ( Sgm Bx ) " ) . i )) & bj = ( ( ( Sgm By ) " ) . j )) & ci = ( ( ( Sgm Cx ) " ) . i )) & cj = ( ( ( Sgm Cy ) " ) . j )) implies ( B * (bi,bj) ) = ( C * (ci,cj) ))) implies (ex M being (Matrix of ( len A ),( width A ),D) st ((( Segm (M,Bx,By) ) = B & ( Segm (M,Cx,Cy) ) = C) & (for i holds (for j holds ([ i,j ] in ( ( Indices M ) \ ( [: Bx,By :] \/ [: Cx,Cy :] ) ) implies ( M * (i,j) ) = ( A * (i,j) )))))))))))))
proof
let D being non  empty set;
let A being (Matrix of D);
let Bx being  without_zero  finite (Subset of ( NAT ));
let By being  without_zero  finite (Subset of ( NAT ));
let Cx being  without_zero  finite (Subset of ( NAT ));
let Cy being  without_zero  finite (Subset of ( NAT ));
assume that
A1: [: Bx,By :] c= ( Indices A )
and
A2: [: Cx,Cy :] c= ( Indices A );
set w = ( width A );
set l = ( len A );
set cy = ( card Cy );
set cx = ( card Cx );
set bY = ( card By );
set bx = ( card Bx );
let B being (Matrix of bx,bY,D);
let C being (Matrix of cx,cy,D);
assume that
A3: (for i,j,bi,bj,ci,cj being Nat holds ((((([ i,j ] in ( [: Bx,By :] /\ [: Cx,Cy :] ) & bi = ( ( ( Sgm Bx ) " ) . i )) & bj = ( ( ( Sgm By ) " ) . j )) & ci = ( ( ( Sgm Cx ) " ) . i )) & cj = ( ( ( Sgm Cy ) " ) . j )) implies ( B * (bi,bj) ) = ( C * (ci,cj) )));
A4: (ex kBy being Nat st By c= ( Seg kBy )) by MATRIX13:43;
then A5: ( rng ( Sgm By ) ) = By by FINSEQ_1:def 13;
defpred P[ set,set,set ]
 means
(for i holds (for j holds (($1 = i & $2 = j) implies ((([ i,j ] in [: Bx,By :] implies ((ex m st (ex n st (((m in ( dom ( Sgm Bx ) ) & n in ( dom ( Sgm By ) )) & ( ( Sgm Bx ) . m ) = i) & ( ( Sgm By ) . n ) = j))) & (for m holds (for n holds ((((m in ( dom ( Sgm Bx ) ) & n in ( dom ( Sgm By ) )) & ( ( Sgm Bx ) . m ) = i) & ( ( Sgm By ) . n ) = j) implies $3 = ( B * (m,n) )))))) & ([ i,j ] in [: Cx,Cy :] implies ((ex m st (ex n st (((m in ( dom ( Sgm Cx ) ) & n in ( dom ( Sgm Cy ) )) & ( ( Sgm Cx ) . m ) = i) & ( ( Sgm Cy ) . n ) = j))) & (for m holds (for n holds ((((m in ( dom ( Sgm Cx ) ) & n in ( dom ( Sgm Cy ) )) & ( ( Sgm Cx ) . m ) = i) & ( ( Sgm Cy ) . n ) = j) implies $3 = ( C * (m,n) ))))))) & ((not [ i,j ] in ( [: Bx,By :] \/ [: Cx,Cy :] )) implies $3 = ( A * (i,j) ))))));
A14: (ex kBx being Nat st Bx c= ( Seg kBx )) by MATRIX13:43;
then A15: ( rng ( Sgm Bx ) ) = Bx by FINSEQ_1:def 13;
A16: ( dom ( Sgm By ) ) = ( Seg bY ) by A4,FINSEQ_3:40;
A17: ( Sgm By ) is  one-to-one by A4,FINSEQ_3:92;
A18: ( Sgm Bx ) is  one-to-one by A14,FINSEQ_3:92;
A19: (ex kCy being Nat st Cy c= ( Seg kCy )) by MATRIX13:43;
then A20: ( rng ( Sgm Cy ) ) = Cy by FINSEQ_1:def 13;
A21: ( Sgm Cy ) is  one-to-one by A19,FINSEQ_3:92;
A22: (ex kCx being Nat st Cx c= ( Seg kCx )) by MATRIX13:43;
then A23: ( rng ( Sgm Cx ) ) = Cx by FINSEQ_1:def 13;
A24: ( Sgm Cx ) is  one-to-one by A22,FINSEQ_3:92;
A25: (for i holds (for j holds ([ i,j ] in [: ( Seg l ),( Seg w ) :] implies (ex x being (Element of D) st P[ i,j,x ]))))
proof
let i;
let j;
assume that
[ i,j ] in [: ( Seg l ),( Seg w ) :];
per cases ;
suppose A26: ([ i,j ] in [: Bx,By :] & [ i,j ] in [: Cx,Cy :]);

then j in Cy by ZFMISC_1:87;
then consider yC being set such that A27: yC in ( dom ( Sgm Cy ) ) and A28: ( ( Sgm Cy ) . yC ) = j by A20,FUNCT_1:def 3;
j in By by A26,ZFMISC_1:87;
then consider y such that A29: y in ( dom ( Sgm By ) ) and A30: ( ( Sgm By ) . y ) = j by A5,FUNCT_1:def 3;
i in Cx by A26,ZFMISC_1:87;
then consider xC being set such that A31: xC in ( dom ( Sgm Cx ) ) and A32: ( ( Sgm Cx ) . xC ) = i by A23,FUNCT_1:def 3;
i in Bx by A26,ZFMISC_1:87;
then consider x such that A33: x in ( dom ( Sgm Bx ) ) and A34: ( ( Sgm Bx ) . x ) = i by A15,FUNCT_1:def 3;
reconsider x,y as (Element of ( NAT )) by A33,A29;
take BB = ( B * (x,y) );
A35:now
let m;
let n;
assume (((m in ( dom ( Sgm Cx ) ) & n in ( dom ( Sgm Cy ) )) & ( ( Sgm Cx ) . m ) = i) & ( ( Sgm Cy ) . n ) = j);
then A36: (( ( ( Sgm Cx ) " ) . i ) = m & ( ( ( Sgm Cy ) " ) . j ) = n) by A24,A21,FUNCT_1:32;
A37: ( ( ( Sgm By ) " ) . j ) = y by A17,A29,A30,FUNCT_1:32;
([ i,j ] in ( [: Bx,By :] /\ [: Cx,Cy :] ) & ( ( ( Sgm Bx ) " ) . i ) = x) by A18,A26,A33,A34,FUNCT_1:32,XBOOLE_0:def 4;
hence BB = ( C * (m,n) ) by A3,A37,A36;
end;
now
let m;
let n;
assume that
A38: m in ( dom ( Sgm Bx ) )
and
A39: n in ( dom ( Sgm By ) )
and
A40: ( ( Sgm Bx ) . m ) = i
and
A41: ( ( Sgm By ) . n ) = j;
x = m by A18,A33,A34,A38,A40,FUNCT_1:def 4;
hence BB = ( B * (m,n) ) by A17,A29,A30,A39,A41,FUNCT_1:def 4;
end;
hence thesis by A26,A33,A34,A29,A30,A31,A32,A27,A28,A35,XBOOLE_0:def 3;
end;
suppose A42: ([ i,j ] in [: Bx,By :] & (not [ i,j ] in [: Cx,Cy :]));

then j in By by ZFMISC_1:87;
then consider y such that A43: y in ( dom ( Sgm By ) ) and A44: ( ( Sgm By ) . y ) = j by A5,FUNCT_1:def 3;
i in Bx by A42,ZFMISC_1:87;
then consider x such that A45: x in ( dom ( Sgm Bx ) ) and A46: ( ( Sgm Bx ) . x ) = i by A15,FUNCT_1:def 3;
reconsider x,y as (Element of ( NAT )) by A45,A43;
take BB = ( B * (x,y) );
now
let m;
let n;
assume that
A47: m in ( dom ( Sgm Bx ) )
and
A48: n in ( dom ( Sgm By ) )
and
A49: ( ( Sgm Bx ) . m ) = i
and
A50: ( ( Sgm By ) . n ) = j;
x = m by A18,A45,A46,A47,A49,FUNCT_1:def 4;
hence BB = ( B * (m,n) ) by A17,A43,A44,A48,A50,FUNCT_1:def 4;
end;
hence thesis by A42,A45,A46,A43,A44,XBOOLE_0:def 3;
end;
suppose A51: ((not [ i,j ] in [: Bx,By :]) & [ i,j ] in [: Cx,Cy :]);

then j in Cy by ZFMISC_1:87;
then consider y such that A52: y in ( dom ( Sgm Cy ) ) and A53: ( ( Sgm Cy ) . y ) = j by A20,FUNCT_1:def 3;
i in Cx by A51,ZFMISC_1:87;
then consider x such that A54: x in ( dom ( Sgm Cx ) ) and A55: ( ( Sgm Cx ) . x ) = i by A23,FUNCT_1:def 3;
reconsider x,y as (Element of ( NAT )) by A54,A52;
take CC = ( C * (x,y) );
now
let m;
let n;
assume that
A56: m in ( dom ( Sgm Cx ) )
and
A57: n in ( dom ( Sgm Cy ) )
and
A58: ( ( Sgm Cx ) . m ) = i
and
A59: ( ( Sgm Cy ) . n ) = j;
x = m by A24,A54,A55,A56,A58,FUNCT_1:def 4;
hence CC = ( C * (m,n) ) by A21,A52,A53,A57,A59,FUNCT_1:def 4;
end;
hence thesis by A51,A54,A55,A52,A53,XBOOLE_0:def 3;
end;
suppose A60: ((not [ i,j ] in [: Bx,By :]) & (not [ i,j ] in [: Cx,Cy :]));

take ( A * (i,j) );
thus thesis by A60;
end;
end;
consider M being (Matrix of l,w,D) such that A61: (for i holds (for j holds ([ i,j ] in ( Indices M ) implies P[ i,j,( M * (i,j) ) ]))) from MATRIX_1:sch 2(A25);
set MB = ( Segm (M,Bx,By) );
take M;
A is (Matrix of l,w,D) by MATRIX_2:7;
then A62: ( Indices A ) = ( Indices M ) by MATRIX_1:26;
A63: ( dom ( Sgm Bx ) ) = ( Seg bx ) by A14,FINSEQ_3:40;
now
let i;
let j;
assume that
A64: [ i,j ] in ( Indices MB );
bx <> ( 0 ) by A64,MATRIX_1:22;
then A65: ( Indices MB ) = [: ( Seg bx ),( Seg bY ) :] by MATRIX_1:23;
then A66: j in ( Seg bY ) by A64,ZFMISC_1:87;
then A67: ( ( Sgm By ) . j ) in By by A5,A16,FUNCT_1:def 3;
A68: i in ( Seg bx ) by A64,A65,ZFMISC_1:87;
then ( ( Sgm Bx ) . i ) in Bx by A15,A63,FUNCT_1:def 3;
then [ ( ( Sgm Bx ) . i ),( ( Sgm By ) . j ) ] in [: Bx,By :] by A67,ZFMISC_1:87;
hence ( B * (i,j) ) = ( M * (( ( Sgm Bx ) . i ),( ( Sgm By ) . j )) ) by A1,A63,A16,A61,A62,A68,A66
.= ( MB * (i,j) ) by A64,MATRIX13:def 1;
end;
hence MB = B by MATRIX_1:27;
set MC = ( Segm (M,Cx,Cy) );
A69: ( dom ( Sgm Cy ) ) = ( Seg cy ) by A19,FINSEQ_3:40;
A70: ( dom ( Sgm Cx ) ) = ( Seg cx ) by A22,FINSEQ_3:40;
now
let i;
let j;
assume that
A71: [ i,j ] in ( Indices MC );
cx <> ( 0 ) by A71,MATRIX_1:22;
then A72: ( Indices MC ) = [: ( Seg cx ),( Seg cy ) :] by MATRIX_1:23;
then A73: j in ( Seg cy ) by A71,ZFMISC_1:87;
then A74: ( ( Sgm Cy ) . j ) in Cy by A20,A69,FUNCT_1:def 3;
A75: i in ( Seg cx ) by A71,A72,ZFMISC_1:87;
then ( ( Sgm Cx ) . i ) in Cx by A23,A70,FUNCT_1:def 3;
then [ ( ( Sgm Cx ) . i ),( ( Sgm Cy ) . j ) ] in [: Cx,Cy :] by A74,ZFMISC_1:87;
hence ( C * (i,j) ) = ( M * (( ( Sgm Cx ) . i ),( ( Sgm Cy ) . j )) ) by A2,A70,A69,A61,A62,A75,A73
.= ( MC * (i,j) ) by A71,MATRIX13:def 1;
end;
hence MC = C by MATRIX_1:27;
let i;
let j;
assume that
A76: [ i,j ] in ( ( Indices M ) \ ( [: Bx,By :] \/ [: Cx,Cy :] ) );
(not [ i,j ] in ( [: Bx,By :] \/ [: Cx,Cy :] )) by A76,XBOOLE_0:def 5;
hence thesis by A61,A76;
end;
