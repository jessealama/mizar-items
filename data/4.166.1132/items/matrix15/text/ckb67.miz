environ
vocabularies NUMBERS,NAT_1,VECTSP_1,FREEALG,FINSET_1,SUBSET_1,MATRIX_1,TREES_1,FINSEQ_1,RELAT_1,XXREAL_0,INCSP_1,FVSUM_1,CARD_3,RVSUM_1,GROUP_1,ARYTM_1,SUPINF_2,FUNCT_1,ARYTM_3,CARD_1,XBOOLE_0,ALGSTR_0,ORDINAL4,STRUCT_0,FINSEQ_2,TARSKI,RLVECT_1,PARTFUN1,VALUED_1,ZFMISC_1,CLASSES1,XCMPLX_0,MATRIX_3,MATRIX13,LAPLACE,PRVECT_1,RLVECT_3,LMOD_7,QC_LANG1,RLSUB_1,MESFUNC1,PRE_POLY,MATRIX11,MATRIXR1,AFINSQ_1,MATRIX_2,FINSEQ_3,FUNCT_2,SETWISEO,FINSOP_1,RLVECT_2,RLVECT_5,FUNCOP_1,FUNCT_4,MATRIX_6,MATRIX15;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,SETWOP_2,FINSEQ_1,STRUCT_0,FUNCOP_1,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,FVSUM_1,FINSOP_1,NAT_D,BINARITH,GROUP_4,MATRIX_3,MATRIX_6,MATRIX_7,FINSEQ_7,FUNCT_4,DOMAIN_1,MATRIX11,MEASURE6,PSCOMP_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,FINSEQOP,PRVECT_1,MATRIX13,PRE_POLY,MATRLIN,FUNCT_7,PNPROC_1,LAPLACE,CKB17,CKB28,CKB29,CKB38;
definitions TARSKI,XBOOLE_0,RLVECT_1,FINSEQ_1,FINSEQ_2,MATRIX_1,GROUP_4,MATRIX_3,MATRIX_7,VECTSP_4,RELAT_1,LAPLACE,MATRIX13,FVSUM_1,ALGSTR_0,CKB28,CKB29,CKB38;
theorems CARD_1,CARD_2,CARD_FIN,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQOP,FINSOP_1,FRECHET,FUNCT_1,FUNCT_2,FUNCT_7,FUNCOP_1,FVSUM_1,GROUP_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_4,MATRIX_5,MATRIX_6,MATRIX_7,MATRIX11,MATRIX13,MATRIXR1,MATRIXR2,MATRLIN,NAT_1,ORDINAL1,PARTFUN1,PNPROC_1,RELAT_1,RLVECT_1,STIRL2_1,STRUCT_0,TARSKI,WELLORD2,VECTSP_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,ZFMISC_1,NAT_D,PRE_POLY,MEASURE6,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66;
schemes FINSEQ_2,NAT_1,MATRIX_1;
registrations XBOOLE_0,FUNCT_1,FINSET_1,STRUCT_0,FVSUM_1,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,CARD_1,FUNCOP_1,SETFAM_1,FINSEQ_2,MATRLIN,MATRIX13,XREAL_0,PNPROC_1,VECTSP_9,VALUED_0,RELSET_1,PRVECT_1;
constructors SETWISEO,FINSOP_1,ALGSTR_1,FVSUM_1,XXREAL_0,GROUP_4,FINSEQ_7,WELLORD2,VECTSP_6,VECTSP_7,VECTSP_9,MATRIX_6,MATRIX_7,MATRIX11,MATRIX13,PNPROC_1,REALSET1,LAPLACE,BINOP_2,NAT_D,BINARITH,RELSET_1,PRE_POLY,PSCOMP_1,CKB17,CKB28,CKB29,CKB38;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve i for Nat;
reserve j for Nat;
reserve k for Nat;
reserve m for Nat;
reserve n for Nat;
reserve K for Field;
reserve A for (Matrix of K);
reserve B for (Matrix of K);
reserve A9 for (Matrix of m,n,K);
reserve B9 for (Matrix of m,k,K);
reserve f for (FinSequence of K);
scheme GAUSS1 { K() -> Field,n,m,m9() -> Nat,A() -> (Matrix of n(),m(),K()),B() -> (Matrix of n(),m9(),K()),F((Matrix of n(),m9(),K()),Nat,Nat,(Element of K())) -> (Matrix of n(),m9(),K()),P[set,set] } : (ex A9 being (Matrix of n(),m(),K()) st (ex B9 being (Matrix of n(),m9(),K()) st (ex N being  without_zero  finite (Subset of ( NAT )) st (((((((N c= ( Seg m() ) & ( the_rank_of A() ) = ( the_rank_of A9 )) & ( the_rank_of A() ) = ( card N )) & P[ A9,B9 ]) & ( Segm (A9,( Seg ( card N ) ),N) ) is  diagonal) & (for i holds (i in ( Seg ( card N ) ) implies ( A9 * (i,( ( Sgm N ) /. i )) ) <> ( 0. K() )))) & (for i holds ((i in ( dom A9 ) & i > ( card N )) implies ( Line (A9,i) ) = ( m() |-> ( 0. K() ) )))) & (for i holds (for j holds (((i in ( Seg ( card N ) ) & j in ( Seg ( width A9 ) )) & j < ( ( Sgm N ) . i )) implies ( A9 * (i,j) ) = ( 0. K() ))))))))
provided
A1: P[ A(),B() ]
and
A2: (for A9 being (Matrix of n(),m(),K()) holds (for B9 being (Matrix of n(),m9(),K()) holds (P[ A9,B9 ] implies (for i holds (for j holds ((i <> j & j in ( dom A9 )) implies (for a being (Element of K()) holds P[ ( RLine (A9,i,( ( Line (A9,i) ) + ( a * ( Line (A9,j) ) ) )) ),F(B9,i,j,a) ])))))))
proof
defpred PP[ (FinSequence of ( NAT )),Nat,Nat,(Matrix of n(),m(),K()) ]
 means
(((( $4 * ($2,( $1 /. $2 )) ) <> ( 0. K() ) & (($3 in ( dom $1 ) & $2 < $3) implies ( $1 /. $2 ) < ( $1 /. $3 ))) & ($3 in ( ( dom $1 ) \ { $2 } ) implies ( $4 * ($3,( $1 /. $2 )) ) = ( 0. K() ))) & (($3 in ( Seg ( width $4 ) ) & $3 < ( $1 /. $2 )) implies ( $4 * ($2,$3) ) = ( 0. K() )));
set r = ( the_rank_of A() );
(ex A9 being (Matrix of n(),m(),K()) st (ex B9 being (Matrix of n(),m9(),K()) st (((P[ A9,B9 ] & r = ( the_rank_of A9 )) & (for i holds ((i in ( dom A9 ) & i > r) implies ( Line (A9,i) ) = ( m() |-> ( 0. K() ) )))) & (ex f being (FinSequence of ( NAT )) st (((( len f ) = ( the_rank_of A9 ) & f is  one-to-one) & ( rng f ) c= ( Seg ( width A9 ) )) & (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ]))))))))
proof
per cases ;
suppose A3: n() = ( 0 );

take A9 = A();
take B9 = B();
(( dom A9 ) = ( Seg ( len A9 ) ) & ( len A9 ) = ( 0 )) by A3,FINSEQ_1:def 3,MATRIX_1:def 2;
hence ((P[ A9,B9 ] & r = ( the_rank_of A9 )) & (for i holds ((i in ( dom A9 ) & i > r) implies ( Line (A9,i) ) = ( m() |-> ( 0. K() ) )))) by A1;
take ( <*> ( NAT ) );
( len A9 ) = ( 0 ) by A3,MATRIX_1:22;
hence thesis by MATRIX13:74,XBOOLE_1:2;
end;
suppose A4: n() > ( 0 );

defpred Q[ Nat ]
 means
($1 <= m() implies (ex A9 being (Matrix of n(),m(),K()) st (ex B9 being (Matrix of n(),m9(),K()) st ((P[ A9,B9 ] & r = ( the_rank_of A9 )) & (ex f being (FinSequence of ( NAT )) st ((((((for i holds (for j holds ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j <= $1) implies ( A9 * (i,j) ) = ( 0. K() )))) & f is  one-to-one) & ( len f ) <= $1) & ( len f ) <= n()) & ( rng f ) c= ( Seg $1 )) & (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ])))))))));
A5: (for n holds (Q[ n ] implies Q[ ( n + 1 ) ]))
proof
let n;
assume that
A6: Q[ n ];
set n1 = ( n + 1 );
assume A7: n1 <= m();
then consider A9 being (Matrix of n(),m(),K()),B9 being (Matrix of n(),m9(),K()) such that A8: (P[ A9,B9 ] & r = ( the_rank_of A9 )) and A9: (ex f being (FinSequence of ( NAT )) st ((((((for i holds (for j holds ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j <= n) implies ( A9 * (i,j) ) = ( 0. K() )))) & f is  one-to-one) & ( len f ) <= n) & ( len f ) <= n()) & ( rng f ) c= ( Seg n )) & (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ]))))) by A6,NAT_1:13;
consider f being (FinSequence of ( NAT )) such that A10: (for i holds (for j holds ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j <= n) implies ( A9 * (i,j) ) = ( 0. K() )))) and A11: f is  one-to-one and A12: ( len f ) <= n and A13: ( len f ) <= n() and A14: ( rng f ) c= ( Seg n ) and A15: (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ]))) by A9;
per cases ;
suppose A16: (for i holds (for j holds ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j = n1) implies ( A9 * (i,j) ) = ( 0. K() ))));

A17:now
let i;
let j;
assume that
A18: ([ i,j ] in ( Indices A9 ) & i > ( len f ))
and
A19: j <= n1;
(j <= n or j = n1) by A19,NAT_1:8;
hence ( A9 * (i,j) ) = ( 0. K() ) by A10,A16,A18;
end;
n <= n1 by NAT_1:13;
then ( Seg n ) c= ( Seg n1 ) by FINSEQ_1:5;
then A20: ( rng f ) c= ( Seg n1 ) by A14,XBOOLE_1:1;
( len f ) <= n1 by A12,NAT_1:12;
hence thesis by A8,A11,A13,A15,A17,A20;
end;
suppose (ex i st (ex j st ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j = n1) & ( A9 * (i,j) ) <> ( 0. K() ))));

then consider i0,j0 being Nat such that A21: [ i0,j0 ] in ( Indices A9 ) and A22: i0 > ( len f ) and A23: j0 = n1 and A24: ( A9 * (i0,j0) ) <> ( 0. K() );
A25: ( Indices A9 ) = [: ( Seg n() ),( Seg m() ) :] by A4,MATRIX_1:23;
then A26: n1 in ( Seg m() ) by A21,A23,ZFMISC_1:87;
A27: i0 in ( Seg n() ) by A21,A25,ZFMISC_1:87;
then A28: i0 <= n() by FINSEQ_1:1;
A29: ( ( len f ) + 1 ) <= i0 by A22,NAT_1:13;
then (( ( 0 ) + 1 ) <= ( ( len f ) + 1 ) & ( ( len f ) + 1 ) <= n()) by A28,XREAL_1:7,XXREAL_0:2;
then A30: ( ( len f ) + 1 ) in ( Seg n() );
defpred QQ[ Nat ]
 means
($1 <= n() implies (ex A9 being (Matrix of n(),m(),K()) st (ex B9 being (Matrix of n(),m9(),K()) st (((((P[ A9,B9 ] & r = ( the_rank_of A9 )) & ( A9 * (( ( len f ) + 1 ),n1) ) <> ( 0. K() )) & (for i holds (for j holds ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j <= n) implies ( A9 * (i,j) ) = ( 0. K() ))))) & (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ])))) & (for j holds ((j in ( ( dom A9 ) \ { ( ( len f ) + 1 ) } ) & j <= $1) implies ( A9 * (j,n1) ) = ( 0. K() )))))));
A31: ( dom f ) = ( Seg ( len f ) ) by FINSEQ_1:def 3;
n <= m() by A7,NAT_1:13;
then A32: ( Seg n ) c= ( Seg m() ) by FINSEQ_1:5;
A33: ( Seg ( len f ) ) c= ( Seg n() ) by A13,FINSEQ_1:5;
A34: (for k holds (QQ[ k ] implies QQ[ ( k + 1 ) ]))
proof
let k;
assume that
A35: QQ[ k ];
set k1 = ( k + 1 );
assume k1 <= n();
then consider AA being (Matrix of n(),m(),K()),BB being (Matrix of n(),m9(),K()) such that A36: P[ AA,BB ] and A37: r = ( the_rank_of AA ) and A38: ( AA * (( ( len f ) + 1 ),n1) ) <> ( 0. K() ) and A39: (for i holds (for j holds ((([ i,j ] in ( Indices AA ) & i > ( len f )) & j <= n) implies ( AA * (i,j) ) = ( 0. K() )))) and A40: (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,AA ]))) and A41: (for j holds ((j in ( ( dom AA ) \ { ( ( len f ) + 1 ) } ) & j <= k) implies ( AA * (j,n1) ) = ( 0. K() ))) by A35,NAT_1:13;
now
per cases ;
suppose A42: k1 = ( ( len f ) + 1 );

take RA = AA;
take RB = BB;
now
let j;
assume that
A43: j in ( ( dom RA ) \ { ( ( len f ) + 1 ) } )
and
A44: j <= k1;
j <> ( ( len f ) + 1 ) by A43,ZFMISC_1:56;
then j < ( k + 1 ) by A42,A44,XXREAL_0:1;
then j <= k by NAT_1:13;
hence ( RA * (j,n1) ) = ( 0. K() ) by A41,A43;
end;
hence thesis by A36,A37,A38,A39,A40;
end;
suppose A45: k1 <> ( ( len f ) + 1 );

set LA = ( Line (AA,k1) );
set LAf = ( Line (AA,( ( len f ) + 1 )) );
set a = ( AA * (( ( len f ) + 1 ),n1) );
set RA = ( RLine (AA,k1,( LA + ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) )) );
A46: ( width AA ) = m() by A4,MATRIX_1:23;
then A47: ( len ( LA + ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) ) ) = m() by CARD_1:def 7;
A48: ( Indices A9 ) = ( Indices AA ) by MATRIX_1:26;
then [ ( ( len f ) + 1 ),n1 ] in ( Indices AA ) by A25,A30,A26,ZFMISC_1:87;
then A49: ( RA * (( ( len f ) + 1 ),n1) ) <> ( 0. K() ) by A38,A45,A46,A47,MATRIX11:def 3;
A50: ( Indices A9 ) = ( Indices RA ) by MATRIX_1:26;
A51:now
let i;
let j;
assume that
A52: [ i,j ] in ( Indices RA )
and
A53: i > ( len f )
and
A54: j <= n;
now
per cases ;
suppose A55: i = k1;

A56: j in ( Seg m() ) by A25,A50,A52,ZFMISC_1:87;
then (( ( len f ) + 1 ) > ( len f ) & [ ( ( len f ) + 1 ),j ] in ( Indices A9 )) by A25,A30,NAT_1:13,ZFMISC_1:87;
then ( AA * (( ( len f ) + 1 ),j) ) = ( 0. K() ) by A39,A48,A54;
then ( LAf . j ) = ( 0. K() ) by A46,A56,MATRIX_1:def 7;
then A57: ( ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) . j ) = ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * ( 0. K() ) ) by A46,A56,FVSUM_1:51
.= ( 0. K() ) by VECTSP_1:6;
( LA . j ) = ( AA * (k1,j) ) by A46,A56,MATRIX_1:def 7
.= ( 0. K() ) by A39,A48,A50,A52,A53,A54,A55;
then ( ( 0. K() ) + ( 0. K() ) ) = ( ( LA + ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) ) . j ) by A46,A56,A57,FVSUM_1:18
.= ( RA * (i,j) ) by A48,A50,A46,A47,A52,A55,MATRIX11:def 3;
hence ( RA * (i,j) ) = ( 0. K() ) by RLVECT_1:def 4;
end;
suppose i <> k1;

hence ( RA * (i,j) ) = ( AA * (i,j) ) by A48,A50,A46,A47,A52,MATRIX11:def 3
.= ( 0. K() ) by A39,A48,A50,A52,A53,A54;
end;
end;
hence ( RA * (i,j) ) = ( 0. K() );
end;
set RB = F(BB,k1,( ( len f ) + 1 ),( - ( ( AA * (k1,n1) ) * ( a " ) ) ));
take RA;
take RB;
A58: ( width RA ) = m() by A4,MATRIX_1:23;
A59: ( len AA ) = n() by MATRIX_1:def 2;
A60:now
A61: ( dom AA ) = ( Seg ( len AA ) ) by FINSEQ_1:def 3;
let j;
assume that
A62: j in ( ( dom RA ) \ { ( ( len f ) + 1 ) } )
and
A63: j <= k1;
j in ( dom RA ) by A62,XBOOLE_0:def 5;
then A64: [ j,n1 ] in ( Indices AA ) by A26,A48,A50,A58,ZFMISC_1:87;
A65: (( dom RA ) = ( Seg ( len RA ) ) & ( len RA ) = n()) by FINSEQ_1:def 3,MATRIX_1:def 2;
now
per cases  by A63,NAT_1:8;
suppose A66: j <= k;

then j < k1 by NAT_1:13;
hence ( RA * (j,n1) ) = ( AA * (j,n1) ) by A46,A47,A64,MATRIX11:def 3
.= ( 0. K() ) by A41,A59,A62,A65,A61,A66;
end;
suppose A67: j = k1;

( LAf . n1 ) = a by A26,A46,MATRIX_1:def 7;
then A68: ( ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) . n1 ) = ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * a ) by A26,A46,FVSUM_1:51
.= ( ( ( - ( AA * (k1,n1) ) ) * ( a " ) ) * a ) by VECTSP_1:9
.= ( ( - ( AA * (k1,n1) ) ) * ( ( a " ) * a ) ) by GROUP_1:def 3
.= ( ( - ( AA * (k1,n1) ) ) * ( 1_ K() ) ) by A38,VECTSP_1:def 10
.= ( - ( AA * (k1,n1) ) ) by VECTSP_1:def 4;
( LA . n1 ) = ( AA * (k1,n1) ) by A26,A46,MATRIX_1:def 7;
then ( ( LA + ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) ) . n1 ) = ( ( AA * (k1,n1) ) + ( - ( AA * (k1,n1) ) ) ) by A26,A46,A68,FVSUM_1:18
.= ( 0. K() ) by VECTSP_1:19;
hence ( RA * (j,n1) ) = ( 0. K() ) by A46,A47,A64,A67,MATRIX11:def 3;
end;
end;
hence ( RA * (j,n1) ) = ( 0. K() );
end;
A69: ( dom AA ) = ( Seg ( len AA ) ) by FINSEQ_1:def 3;
A70:now
let i;
let j;
assume that
A71: i in ( dom f );
set fi = ( f /. i );
A72: (fi = ( f . i ) & ( f . i ) in ( rng f )) by A71,FUNCT_1:def 3,PARTFUN1:def 6;
then A73: fi in ( Seg n ) by A14;
A74: (( ( len f ) + 1 ) > ( len f ) & fi <= n) by A14,A72,FINSEQ_1:1,NAT_1:13;
([ ( ( len f ) + 1 ),fi ] in ( Indices AA ) & ( LAf . fi ) = ( AA * (( ( len f ) + 1 ),fi) )) by A25,A32,A30,A48,A46,A73,MATRIX_1:def 7,ZFMISC_1:87;
then ( LAf . fi ) = ( 0. K() ) by A39,A74;
then A75: ( ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) . fi ) = ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * ( 0. K() ) ) by A32,A46,A73,FVSUM_1:51
.= ( 0. K() ) by VECTSP_1:12;
( LA . fi ) = ( AA * (k1,fi) ) by A32,A46,A73,MATRIX_1:def 7;
then A76: ( ( LA + ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) ) . fi ) = ( ( AA * (k1,fi) ) + ( 0. K() ) ) by A32,A46,A73,A75,FVSUM_1:18
.= ( AA * (k1,fi) ) by RLVECT_1:def 4;
A77: [ i,fi ] in ( Indices AA ) by A25,A32,A33,A31,A48,A71,A73,ZFMISC_1:87;
now
per cases ;
suppose i <> k1;

then ( RA * (i,fi) ) = ( AA * (i,fi) ) by A46,A47,A77,MATRIX11:def 3;
hence ( RA * (i,fi) ) <> ( 0. K() ) by A40,A71;
end;
suppose i = k1;

then ( RA * (i,fi) ) = ( AA * (i,fi) ) by A46,A47,A77,A76,MATRIX11:def 3;
hence ( RA * (i,( f /. i )) ) <> ( 0. K() ) by A40,A71;
end;
end;
hence (( RA * (i,fi) ) <> ( 0. K() ) & ((j in ( dom f ) & i < j) implies fi < ( f /. j ))) by A15,A71;
thus (j in ( ( dom f ) \ { i } ) implies ( RA * (j,fi) ) = ( 0. K() ))
proof
assume A78: j in ( ( dom f ) \ { i } );
then j in ( Seg ( len f ) ) by A31,XBOOLE_0:def 5;
then A79: [ j,fi ] in ( Indices AA ) by A25,A32,A33,A48,A73,ZFMISC_1:87;
per cases ;
suppose j <> k1;

hence ( RA * (j,fi) ) = ( AA * (j,fi) ) by A46,A47,A79,MATRIX11:def 3
.= ( 0. K() ) by A40,A71,A78;
end;
suppose A80: j = k1;

hence ( RA * (j,fi) ) = ( ( LA + ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) ) . fi ) by A46,A47,A79,MATRIX11:def 3
.= ( 0. K() ) by A40,A71,A76,A78,A80;
end;
end;

thus ((j in ( Seg ( width RA ) ) & j < ( f /. i )) implies ( RA * (i,j) ) = ( 0. K() ))
proof
assume that
A81: j in ( Seg ( width RA ) )
and
A82: j < ( f /. i );
A83: [ ( ( len f ) + 1 ),j ] in ( Indices AA ) by A30,A59,A69,A46,A58,A81,ZFMISC_1:87;
A84: [ i,j ] in ( Indices AA ) by A33,A31,A59,A69,A46,A58,A71,A81,ZFMISC_1:87;
per cases ;
suppose i <> k1;

hence ( RA * (i,j) ) = ( AA * (i,j) ) by A46,A47,A84,MATRIX11:def 3
.= ( 0. K() ) by A40,A46,A58,A71,A81,A82;
end;
suppose A85: i = k1;

fi <= n by A14,A72,FINSEQ_1:1;
then A86: j <= n by A82,XXREAL_0:2;
( ( len f ) + 1 ) > ( len f ) by NAT_1:13;
then ( 0. K() ) = ( AA * (( ( len f ) + 1 ),j) ) by A39,A83,A86
.= ( LAf . j ) by A46,A58,A81,MATRIX_1:def 7;
then A87: ( ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) . j ) = ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * ( 0. K() ) ) by A46,A58,A81,FVSUM_1:51
.= ( 0. K() ) by VECTSP_1:6;
( LA . j ) = ( AA * (i,j) ) by A46,A58,A81,A85,MATRIX_1:def 7
.= ( 0. K() ) by A40,A46,A58,A71,A81,A82;
then ( ( LA + ( ( - ( ( AA * (k1,n1) ) * ( a " ) ) ) * LAf ) ) . j ) = ( ( 0. K() ) + ( 0. K() ) ) by A46,A58,A81,A87,FVSUM_1:18
.= ( 0. K() ) by RLVECT_1:def 4;
hence thesis by A46,A47,A84,A85,MATRIX11:def 3;
end;
end;

end;
A88: ( ( len f ) + 1 ) in ( Seg ( len AA ) ) by A4,A30,MATRIX_1:23;
then A89: r = ( the_rank_of RA ) by A37,A45,MATRIX13:92;
P[ RA,RB ] by A2,A36,A45,A88,A69;
hence thesis by A89,A49,A51,A70,A60;
end;
end;
hence thesis;
end;
A90: j0 in ( Seg m() ) by A21,A25,ZFMISC_1:87;
(ex A9 being (Matrix of n(),m(),K()) st (ex B9 being (Matrix of n(),m9(),K()) st ((((P[ A9,B9 ] & r = ( the_rank_of A9 )) & ( A9 * (( ( len f ) + 1 ),n1) ) <> ( 0. K() )) & (for i holds (for j holds ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j <= n) implies ( A9 * (i,j) ) = ( 0. K() ))))) & (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ]))))))
proof
per cases ;
suppose ( A9 * (( ( len f ) + 1 ),n1) ) <> ( 0. K() );

hence thesis by A8,A10,A15;
end;
suppose A91: ( A9 * (( ( len f ) + 1 ),n1) ) = ( 0. K() );

set RB = F(B9,( ( len f ) + 1 ),i0,( 1_ K() ));
set LA = ( Line (A9,i0) );
set LAf = ( Line (A9,( ( len f ) + 1 )) );
set RA = ( RLine (A9,( ( len f ) + 1 ),( LAf + ( ( 1_ K() ) * LA ) )) );
take RA;
take RB;
(i0 in ( dom A9 ) & ( dom A9 ) = ( Seg ( len A9 ) )) by A21,FINSEQ_1:def 3,ZFMISC_1:87;
hence (P[ RA,RB ] & r = ( the_rank_of RA )) by A2,A8,A23,A24,A91,MATRIX13:92;
A92: (( ( 1_ K() ) * LA ) = LA & ( len ( LAf + LA ) ) = ( width A9 )) by CARD_1:def 7,FVSUM_1:57;
[ ( ( len f ) + 1 ),j0 ] in ( Indices A9 ) by A25,A30,A90,ZFMISC_1:87;
then A93: ( RA * (( ( len f ) + 1 ),n1) ) = ( ( LAf + LA ) . n1 ) by A23,A92,MATRIX11:def 3;
A94: ( width A9 ) = m() by A4,MATRIX_1:23;
then A95: ( LA . n1 ) = ( A9 * (i0,n1) ) by A23,A90,MATRIX_1:def 7;
( LAf . n1 ) = ( 0. K() ) by A23,A90,A91,A94,MATRIX_1:def 7;
then ( RA * (( ( len f ) + 1 ),n1) ) = ( ( 0. K() ) + ( A9 * (i0,n1) ) ) by A26,A94,A93,A95,FVSUM_1:18
.= ( A9 * (i0,n1) ) by RLVECT_1:def 4;
hence ( RA * (( ( len f ) + 1 ),n1) ) <> ( 0. K() ) by A23,A24;
A96: ( Indices RA ) = ( Indices A9 ) by MATRIX_1:26;
now
let i;
let j;
assume that
A97: [ i,j ] in ( Indices RA )
and
A98: i > ( len f )
and
A99: j <= n;
A100: j in ( Seg m() ) by A94,A96,A97,ZFMISC_1:87;
A101: i >= ( ( len f ) + 1 ) by A98,NAT_1:13;
now
per cases  by A101,XXREAL_0:1;
suppose i > ( ( len f ) + 1 );

hence ( RA * (i,j) ) = ( A9 * (i,j) ) by A92,A96,A97,MATRIX11:def 3
.= ( 0. K() ) by A10,A96,A97,A98,A99;
end;
suppose A102: i = ( ( len f ) + 1 );

A103: [ i0,j ] in ( Indices A9 ) by A25,A27,A100,ZFMISC_1:87;
A104: (( LAf . j ) = ( A9 * (( ( len f ) + 1 ),j) ) & ( LA . j ) = ( A9 * (i0,j) )) by A94,A100,MATRIX_1:def 7;
( RA * (i,j) ) = ( ( LAf + LA ) . j ) by A92,A96,A97,A102,MATRIX11:def 3;
hence ( RA * (i,j) ) = ( ( A9 * (( ( len f ) + 1 ),j) ) + ( A9 * (i0,j) ) ) by A94,A100,A104,FVSUM_1:18
.= ( ( 0. K() ) + ( A9 * (i0,j) ) ) by A10,A96,A97,A98,A99,A102
.= ( ( 0. K() ) + ( 0. K() ) ) by A10,A22,A99,A103
.= ( 0. K() ) by RLVECT_1:def 4;
end;
end;
hence ( RA * (i,j) ) = ( 0. K() );
end;
hence (for i holds (for j holds ((([ i,j ] in ( Indices RA ) & i > ( len f )) & j <= n) implies ( RA * (i,j) ) = ( 0. K() ))));
let i;
let j;
assume that
A105: i in ( dom f );
i <= ( len f ) by A31,A105,FINSEQ_1:1;
then A106: i < ( ( len f ) + 1 ) by NAT_1:13;
(( f /. i ) = ( f . i ) & ( f . i ) in ( rng f )) by A105,FUNCT_1:def 3,PARTFUN1:def 6;
then A107: ( f /. i ) in ( Seg n ) by A14;
then [ i,( f /. i ) ] in ( Indices A9 ) by A25,A32,A33,A31,A105,ZFMISC_1:87;
then ( RA * (i,( f /. i )) ) = ( A9 * (i,( f /. i )) ) by A92,A106,MATRIX11:def 3;
hence (( RA * (i,( f /. i )) ) <> ( 0. K() ) & ((j in ( dom f ) & i < j) implies ( f /. i ) < ( f /. j ))) by A15,A105;
thus (j in ( ( dom f ) \ { i } ) implies ( RA * (j,( f /. i )) ) = ( 0. K() ))
proof
assume A108: j in ( ( dom f ) \ { i } );
then A109: j in ( dom f ) by XBOOLE_0:def 5;
then j <= ( len f ) by A31,FINSEQ_1:1;
then A110: j < ( ( len f ) + 1 ) by NAT_1:13;
[ j,( f /. i ) ] in ( Indices A9 ) by A25,A32,A33,A31,A107,A109,ZFMISC_1:87;
hence ( RA * (j,( f /. i )) ) = ( A9 * (j,( f /. i )) ) by A92,A110,MATRIX11:def 3
.= ( 0. K() ) by A15,A105,A108;
end;

assume that
A111: j in ( Seg ( width RA ) )
and
A112: j < ( f /. i );
A113: ( width RA ) = ( width A9 ) by A92,MATRIX11:def 3;
then [ i,j ] in ( Indices A9 ) by A25,A33,A31,A94,A105,A111,ZFMISC_1:87;
hence ( RA * (i,j) ) = ( A9 * (i,j) ) by A92,A106,MATRIX11:def 3
.= ( 0. K() ) by A15,A105,A111,A112,A113;
end;
end;
then consider A0 being (Matrix of n(),m(),K()),B0 being (Matrix of n(),m9(),K()) such that A114: (((P[ A0,B0 ] & r = ( the_rank_of A0 )) & (( A0 * (( ( len f ) + 1 ),n1) ) <> ( 0. K() ) & (for i holds (for j holds ((([ i,j ] in ( Indices A0 ) & i > ( len f )) & j <= n) implies ( A0 * (i,j) ) = ( 0. K() )))))) & (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A0 ]))));
A115: QQ[ ( 0 ) ]
proof
assume ( 0 ) <= n();
take A0;
take B0;
now
A116: ( dom A0 ) = ( Seg ( len A0 ) ) by FINSEQ_1:def 3;
let j;
assume (j in ( ( dom A0 ) \ { ( ( len f ) + 1 ) } ) & j <= ( 0 ));
hence ( A0 * (j,n1) ) = ( 0. K() ) by A116;
end;
hence thesis by A114;
end;
(for k holds QQ[ k ]) from NAT_1:sch 2(A115,A34);
then consider Aa being (Matrix of n(),m(),K()),Bb being (Matrix of n(),m9(),K()) such that A117: (P[ Aa,Bb ] & r = ( the_rank_of Aa )) and A118: ( Aa * (( ( len f ) + 1 ),n1) ) <> ( 0. K() ) and A119: (for i holds (for j holds ((([ i,j ] in ( Indices Aa ) & i > ( len f )) & j <= n) implies ( Aa * (i,j) ) = ( 0. K() )))) and A120: (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,Aa ]))) and A121: (for j holds ((j in ( ( dom Aa ) \ { ( ( len f ) + 1 ) } ) & j <= n()) implies ( Aa * (j,n1) ) = ( 0. K() )));
take Aa;
take Bb;
thus (P[ Aa,Bb ] & r = ( the_rank_of Aa )) by A117;
take f9 = ( f ^ <* n1 *> );
A122: ( len f9 ) = ( ( len f ) + 1 ) by FINSEQ_2:16;
A123: (( len Aa ) = n() & ( dom Aa ) = ( Seg ( len Aa ) )) by A4,FINSEQ_1:def 3,MATRIX_1:23;
A124:now
let i;
let j;
assume that
A125: [ i,j ] in ( Indices Aa )
and
A126: i > ( len f9 )
and
A127: j <= n1;
per cases  by A127,NAT_1:8;
suppose A128: j <= n;

i > ( len f ) by A122,A126,NAT_1:13;
hence ( Aa * (i,j) ) = ( 0. K() ) by A119,A125,A128;
end;
suppose A129: j = n1;

i in ( dom Aa ) by A125,ZFMISC_1:87;
then (i in ( ( dom Aa ) \ { ( ( len f ) + 1 ) } ) & i <= n()) by A122,A123,A126,FINSEQ_1:1,ZFMISC_1:56;
hence ( Aa * (i,j) ) = ( 0. K() ) by A121,A129;
end;
end;
A130: ( width Aa ) = m() by A4,MATRIX_1:23;
A131: ( len f9 ) <= n() by A28,A29,A122,XXREAL_0:2;
A132:now
let i;
let j;
assume that
A133: i in ( dom f9 );
A134: ( dom f9 ) = ( Seg ( ( len f ) + 1 ) ) by A122,FINSEQ_1:def 3
.= ( ( dom f ) \/ { ( ( len f ) + 1 ) } ) by A31,FINSEQ_1:9;
A135:now
let k;
assume that
A136: k in ( dom f );
A137: k in ( dom f9 ) by A134,A136,XBOOLE_0:def 3;
thus ( f /. k ) = ( f . k ) by A136,PARTFUN1:def 6
.= ( f9 . k ) by A136,FINSEQ_1:def 7
.= ( f9 /. k ) by A137,PARTFUN1:def 6;
end;
now
per cases  by A133,A134,XBOOLE_0:def 3;
suppose A138: i in ( dom f );

then ( f /. i ) = ( f9 /. i ) by A135;
hence ( Aa * (i,( f9 /. i )) ) <> ( 0. K() ) by A120,A138;
end;
suppose A139: i in { ( ( len f ) + 1 ) };

A140: ( f9 /. i ) = ( f9 . i ) by A133,PARTFUN1:def 6;
i = ( ( len f ) + 1 ) by A139,TARSKI:def 1;
hence ( Aa * (i,( f9 /. i )) ) <> ( 0. K() ) by A118,A140,FINSEQ_1:42;
end;
end;
hence ( Aa * (i,( f9 /. i )) ) <> ( 0. K() );
thus ((j in ( dom f9 ) & i < j) implies ( f9 /. i ) < ( f9 /. j ))
proof
assume that
A141: j in ( dom f9 )
and
A142: i < j;
per cases  by A133,A134,A141,XBOOLE_0:def 3;
suppose A143: (j in { ( ( len f ) + 1 ) } & i in { ( ( len f ) + 1 ) });

then i = ( ( len f ) + 1 ) by TARSKI:def 1;
hence thesis by A142,A143,TARSKI:def 1;
end;
suppose A144: (j in { ( ( len f ) + 1 ) } & i in ( dom f ));

then ( ( len f ) + 1 ) = j by TARSKI:def 1;
then A145: ( f9 . j ) = n1 by FINSEQ_1:42;
(( f /. i ) = ( f . i ) & ( f . i ) in ( rng f )) by A144,FUNCT_1:def 3,PARTFUN1:def 6;
then A146: ( f /. i ) <= n by A14,FINSEQ_1:1;
( f9 . j ) = ( f9 /. j ) by A141,PARTFUN1:def 6;
then ( f /. i ) < ( f9 /. j ) by A146,A145,NAT_1:13;
hence thesis by A135,A144;
end;
suppose (j in ( dom f ) & i in { ( ( len f ) + 1 ) });

then (j <= ( len f ) & i = ( ( len f ) + 1 )) by A31,FINSEQ_1:1,TARSKI:def 1;
hence thesis by A142,NAT_1:13;
end;
suppose A147: (j in ( dom f ) & i in ( dom f ));

then (( f /. i ) = ( f9 /. i ) & ( f /. j ) = ( f9 /. j )) by A135;
hence thesis by A15,A142,A147;
end;
end;

( dom f9 ) = ( Seg ( len f9 ) ) by FINSEQ_1:def 3;
then A148: ( dom f9 ) c= ( dom Aa ) by A123,A131,FINSEQ_1:5;
thus (j in ( ( dom f9 ) \ { i } ) implies ( Aa * (j,( f9 /. i )) ) = ( 0. K() ))
proof
assume A149: j in ( ( dom f9 ) \ { i } );
per cases ;
suppose A150: i = ( ( len f ) + 1 );

( ( len f ) + 1 ) in { ( ( len f ) + 1 ) } by TARSKI:def 1;
then ( ( len f ) + 1 ) in ( dom f9 ) by A134,XBOOLE_0:def 3;
then A151: ( f9 . ( ( len f ) + 1 ) ) = ( f9 /. i ) by A150,PARTFUN1:def 6;
A152: j in ( dom f9 ) by A149,ZFMISC_1:56;
j <> i by A149,ZFMISC_1:56;
then A153: j in ( ( dom Aa ) \ { i } ) by A148,A152,ZFMISC_1:56;
j <= n() by A123,A148,A152,FINSEQ_1:1;
then ( Aa * (j,n1) ) = ( 0. K() ) by A121,A150,A153;
hence thesis by A151,FINSEQ_1:42;
end;
suppose A154: i <> ( ( len f ) + 1 );

A155: j in ( dom f9 ) by A149,XBOOLE_0:def 5;
A156: (i in ( dom f ) or i in { ( ( len f ) + 1 ) }) by A133,A134,XBOOLE_0:def 3;
then A157: ( f . i ) in ( rng f ) by A154,FUNCT_1:def 3,TARSKI:def 1;
A158: (( f /. i ) = ( f9 /. i ) & ( f . i ) = ( f /. i )) by A135,A154,A156,PARTFUN1:def 6,TARSKI:def 1;
then A159: 1 <= ( f9 /. i ) by A14,A157,FINSEQ_1:1;
A160: ( f9 /. i ) <= n by A14,A158,A157,FINSEQ_1:1;
n <= m() by A7,NAT_1:13;
then ( f9 /. i ) <= m() by A160,XXREAL_0:2;
then ( f9 /. i ) in ( Seg ( width Aa ) ) by A130,A159;
then A161: [ j,( f9 /. i ) ] in ( Indices Aa ) by A148,A155,ZFMISC_1:87;
per cases ;
suppose j = ( ( len f ) + 1 );

then j > ( len f ) by NAT_1:13;
hence thesis by A119,A160,A161;
end;
suppose A162: j <> ( ( len f ) + 1 );

j in ( dom f9 ) by A149,XBOOLE_0:def 5;
then A163: (j in ( dom f ) or j in { ( ( len f ) + 1 ) }) by A134,XBOOLE_0:def 3;
j <> i by A149,ZFMISC_1:56;
then j in ( ( dom f ) \ { i } ) by A162,A163,TARSKI:def 1,ZFMISC_1:56;
then ( Aa * (j,( f /. i )) ) = ( 0. K() ) by A120,A154,A156,TARSKI:def 1;
hence thesis by A135,A154,A156,TARSKI:def 1;
end;
end;
end;

thus ((j in ( Seg ( width Aa ) ) & j < ( f9 /. i )) implies ( Aa * (i,j) ) = ( 0. K() ))
proof
assume that
A164: j in ( Seg ( width Aa ) )
and
A165: j < ( f9 /. i );
per cases ;
suppose A166: i in ( dom f );

then ( f9 /. i ) = ( f /. i ) by A135;
hence thesis by A120,A164,A165,A166;
end;
suppose A167: (not i in ( dom f ));

(i in ( dom f ) or i in { ( ( len f ) + 1 ) }) by A133,A134,XBOOLE_0:def 3;
then A168: i = ( ( len f ) + 1 ) by A167,TARSKI:def 1;
then A169: ( f9 . i ) = n1 by FINSEQ_1:42;
( f9 . i ) = ( f9 /. i ) by A133,PARTFUN1:def 6;
then A170: j <= n by A165,A169,NAT_1:13;
A171: i > ( len f ) by A168,NAT_1:13;
[ i,j ] in ( Indices Aa ) by A133,A148,A164,ZFMISC_1:87;
hence thesis by A119,A170,A171;
end;
end;

end;
A172: (( rng <* n1 *> ) = { n1 } & ( ( rng f ) \/ { n1 } ) c= ( ( Seg n ) \/ { n1 } )) by A14,FINSEQ_1:38,XBOOLE_1:9;
A173: ( ( Seg n ) \/ { n1 } ) = ( Seg n1 ) by FINSEQ_1:9;
(( rng f ) misses { n1 } & <* n1 *> is  one-to-one) by A14,FINSEQ_3:14,XBOOLE_1:63;
hence thesis by A11,A12,A28,A29,A122,A124,A172,A173,A132,FINSEQ_1:31,FINSEQ_3:91,XREAL_1:6,XXREAL_0:2;
end;
end;
A174: Q[ ( 0 ) ]
proof
assume ( 0 ) <= m();
take A9 = A();
take B9 = B();
thus (P[ A9,B9 ] & r = ( the_rank_of A9 )) by A1;
take f = ( <*> ( NAT ) );
now
let i;
let j;
assume that
A175: [ i,j ] in ( Indices A9 )
and
i > ( len f )
and
A176: j <= ( 0 );
j in ( Seg ( width A9 ) ) by A175,ZFMISC_1:87;
hence ( A9 * (i,j) ) = ( 0. K() ) by A176;
end;
hence thesis;
end;
(for n holds Q[ n ]) from NAT_1:sch 2(A174,A5);
then consider A9 being (Matrix of n(),m(),K()),B9 being (Matrix of n(),m9(),K()) such that A177: P[ A9,B9 ] and A178: r = ( the_rank_of A9 ) and A179: (ex f being (FinSequence of ( NAT )) st ((((((for i holds (for j holds ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j <= m()) implies ( A9 * (i,j) ) = ( 0. K() )))) & f is  one-to-one) & ( len f ) <= m()) & ( len f ) <= n()) & ( rng f ) c= ( Seg m() )) & (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ])))));
consider f being (FinSequence of ( NAT )) such that A180: (for i holds (for j holds ((([ i,j ] in ( Indices A9 ) & i > ( len f )) & j <= m()) implies ( A9 * (i,j) ) = ( 0. K() )))) and A181: f is  one-to-one and ( len f ) <= m() and A182: ( len f ) <= n() and A183: ( rng f ) c= ( Seg m() ) and A184: (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ]))) by A179;
A185: ( len A9 ) = n() by A4,MATRIX_1:23;
take A9;
take B9;
thus (P[ A9,B9 ] & r = ( the_rank_of A9 )) by A177,A178;
A186: ( dom A9 ) = ( Seg ( len A9 ) ) by FINSEQ_1:def 3;
set L = ( len f );
A187: ( Seg L ) c= ( Seg n() ) by A182,FINSEQ_1:5;
(( idseq L ) is (FinSequence of ( NAT )) & ( len ( idseq L ) ) = L) by CARD_1:def 7,FINSEQ_2:48;
then reconsider idL = ( idseq L ),F9 = f as (Element of ( L -tuples_on ( NAT ) )) by FINSEQ_2:92;
set S = ( Segm (A9,idL,F9) );
A188: ( dom f ) = ( Seg L ) by FINSEQ_1:def 3;
set D = ( diagonal_of_Matrix S );
A189: ( Indices S ) = [: ( Seg L ),( Seg L ) :] by MATRIX_1:24;
(for k being (Element of ( NAT )) holds (k in ( dom D ) implies ( D . k ) <> ( 0. K() )))
proof
A190: ( len D ) = L by MATRIX_3:def 10;
let k being (Element of ( NAT ));
assume k in ( dom D );
then A191: k in ( Seg L ) by A190,FINSEQ_1:def 3;
then [ k,k ] in ( Indices S ) by A189,ZFMISC_1:87;
then ( S * (k,k) ) = ( A9 * (( idL . k ),( f . k )) ) by MATRIX13:def 1
.= ( A9 * (k,( f . k )) ) by A191,FINSEQ_2:49
.= ( A9 * (k,( f /. k )) ) by A188,A191,PARTFUN1:def 6;
then ( S * (k,k) ) <> ( 0. K() ) by A184,A188,A191;
hence thesis by A191,MATRIX_3:def 10;
end;
then A192: ( Product D ) <> ( 0. K() ) by FVSUM_1:82;
now
let i;
let j;
assume that
A193: [ i,j ] in ( Indices S );
A194: i in ( Seg L ) by A189,A193,ZFMISC_1:87;
assume i > j;
then A195: i in ( ( dom f ) \ { j } ) by A188,A194,ZFMISC_1:56;
reconsider i9 = i,j9 = j as (Element of ( NAT )) by ORDINAL1:def 12;
A196: j in ( Seg L ) by A189,A193,ZFMISC_1:87;
thus ( S * (i,j) ) = ( A9 * (( idL . i9 ),( f . j9 )) ) by A193,MATRIX13:def 1
.= ( A9 * (i,( f . j )) ) by A194,FINSEQ_2:49
.= ( A9 * (i,( f /. j )) ) by A188,A196,PARTFUN1:def 6
.= ( 0. K() ) by A184,A188,A196,A195;
end;
then S is (Upper_Triangular_Matrix of L,K()) by MATRIX_2:def 3;
then A197: ( Det S ) <> ( 0. K() ) by A192,MATRIX13:7;
A198: ( len ( Segm (A9,( Seg L ),( Seg ( width A9 ) )) ) ) = ( card ( Seg L ) ) by MATRIX_1:def 2;
A199: ( width A9 ) = m() by A4,MATRIX_1:23;
( rng idL ) = ( Seg L ) by RELAT_1:45;
then [: ( rng idL ),( rng F9 ) :] c= ( Indices A9 ) by A183,A187,A185,A186,A199,ZFMISC_1:96;
then A200: ( the_rank_of A9 ) >= L by A197,MATRIX13:76;
A201:now
set w0 = ( ( width A9 ) |-> ( 0. K() ) );
let i;
assume that
A202: i in ( ( dom A9 ) \ ( Seg L ) );
set LA = ( Line (A9,i) );
A203:now
(not i in ( Seg L )) by A202,XBOOLE_0:def 5;
then A204: (i > L or i < 1) by A202;
let j;
assume that
A205: 1 <= j
and
A206: j <= ( width A9 );
j in ( NAT ) by ORDINAL1:def 12;
then A207: j in ( Seg ( width A9 ) ) by A205,A206;
A208: i in ( dom A9 ) by A202,XBOOLE_0:def 5;
then A209: [ i,j ] in ( Indices A9 ) by A207,ZFMISC_1:87;
thus ( LA . j ) = ( A9 * (i,j) ) by A207,MATRIX_1:def 7
.= ( 0. K() ) by A180,A186,A199,A206,A208,A209,A204,FINSEQ_1:1
.= ( w0 . j ) by A207,FINSEQ_2:57;
end;
(( len LA ) = ( width A9 ) & ( len w0 ) = ( width A9 )) by CARD_1:def 7;
hence ( Line (A9,i) ) = ( ( width A9 ) |-> ( 0. K() ) ) by A203,FINSEQ_1:14;
end;
then ( the_rank_of A9 ) = ( the_rank_of ( Segm (A9,( Seg L ),( Seg ( width A9 ) )) ) ) by A187,A185,A186,CKB13:1;
then ( the_rank_of A9 ) <= ( card ( Seg L ) ) by A198,MATRIX13:74;
then A210: ( the_rank_of A9 ) <= L by FINSEQ_1:57;
then A211: r = L by A178,A200,XXREAL_0:1;
thus (for i holds ((i in ( dom A9 ) & i > r) implies ( Line (A9,i) ) = ( m() |-> ( 0. K() ) )))
proof
let i;
assume that
A212: i in ( dom A9 )
and
A213: i > r;
(not i in ( Seg L )) by A211,A213,FINSEQ_1:1;
then i in ( ( dom A9 ) \ ( Seg L ) ) by A212,XBOOLE_0:def 5;
hence thesis by A199,A201;
end;

take f;
thus thesis by A4,A181,A183,A184,A200,A210,MATRIX_1:23,XXREAL_0:1;
end;
end;
then consider A9 being (Matrix of n(),m(),K()),B9 being (Matrix of n(),m9(),K()) such that A214: P[ A9,B9 ] and A215: r = ( the_rank_of A9 ) and A216: (for i holds ((i in ( dom A9 ) & i > r) implies ( Line (A9,i) ) = ( m() |-> ( 0. K() ) ))) and A217: (ex f being (FinSequence of ( NAT )) st (((( len f ) = ( the_rank_of A9 ) & f is  one-to-one) & ( rng f ) c= ( Seg ( width A9 ) )) & (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ])))));
consider f being (FinSequence of ( NAT )) such that A218: ( len f ) = ( the_rank_of A9 ) and A219: f is  one-to-one and A220: ( rng f ) c= ( Seg ( width A9 ) ) and A221: (for i holds (for j holds (i in ( dom f ) implies PP[ f,i,j,A9 ]))) by A217;
(not ( 0 ) in ( rng f )) by A220;
then reconsider rngf = ( rng f ) as  without_zero  finite (Subset of ( NAT )) by A220,MEASURE6:def 2,XBOOLE_1:1;
A222: (n() = ( 0 ) or n() > ( 0 ));
set S = ( Segm (A9,( Seg ( card rngf ) ),rngf) );
A223: ( dom f ) = ( Seg r ) by A215,A218,FINSEQ_1:def 3;
take A9;
take B9;
take rngf;
( len A9 ) = n() by MATRIX_1:def 2;
then (( width A9 ) = ( 0 ) or ( width A9 ) = m()) by A222,MATRIX_1:23,MATRIX_1:def 3;
then ( Seg ( width A9 ) ) c= ( Seg m() ) by FINSEQ_1:5;
hence (rngf c= ( Seg m() ) & r = ( the_rank_of A9 )) by A215,A220,XBOOLE_1:1;
( dom f ),rngf are_equipotent  by A219,WELLORD2:def 4;
hence A224: ( card rngf ) = ( card ( dom f ) ) by CARD_1:5
.= ( card ( Seg r ) ) by A215,A218,FINSEQ_1:def 3
.= r by FINSEQ_1:57;
now
let i;
let j;
assume that
A225: (i in ( dom f ) & j in ( dom f ))
and
A226: i < j;
(( f . i ) = ( f /. i ) & ( f . j ) = ( f /. j )) by A225,PARTFUN1:def 6;
hence ( f . i ) < ( f . j ) by A221,A225,A226;
end;
then A227: ( Sgm rngf ) = f by A219,A220,CKB8:1;
thus P[ A9,B9 ] by A214;
A228: ( card ( Seg ( card rngf ) ) ) = ( card rngf ) by FINSEQ_1:57;
then A229: ( Indices S ) = [: ( Seg r ),( Seg r ) :] by A224,MATRIX_1:24;
now
let i being (Element of ( NAT ));
let j being (Element of ( NAT ));
assume that
A230: i in ( Seg r )
and
A231: j in ( Seg r )
and
A232: i <> j;
A233: i in ( ( dom f ) \ { j } ) by A223,A230,A232,ZFMISC_1:56;
A234: ( ( idseq r ) . i ) = i by A230,FINSEQ_2:49;
[ i,j ] in ( Indices S ) by A229,A230,A231,ZFMISC_1:87;
then ( S * (i,j) ) = ( A9 * (( ( Sgm ( Seg r ) ) . i ),( f . j )) ) by A224,A227,MATRIX13:def 1
.= ( A9 * (i,( f . j )) ) by A234,FINSEQ_3:48
.= ( A9 * (i,( f /. j )) ) by A223,A231,PARTFUN1:def 6;
hence ( S * (i,j) ) = ( 0. K() ) by A221,A223,A231,A233;
end;
hence S is  diagonal by A224,A228,MATRIX_7:def 2;
thus (for i holds (i in ( Seg ( card rngf ) ) implies ( A9 * (i,( ( Sgm rngf ) /. i )) ) <> ( 0. K() ))) by A221,A224,A227,A223;
thus (for i holds ((i in ( dom A9 ) & i > ( card rngf )) implies ( Line (A9,i) ) = ( m() |-> ( 0. K() ) ))) by A216,A224;
let i;
let j;
assume that
A235: i in ( Seg ( card rngf ) )
and
A236: j in ( Seg ( width A9 ) )
and
A237: j < ( ( Sgm rngf ) . i );
j < ( f /. i ) by A224,A227,A223,A235,A237,PARTFUN1:def 6;
hence thesis by A221,A224,A223,A235,A236;
end;
