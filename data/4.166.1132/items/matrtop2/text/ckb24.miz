environ
vocabularies ALGSTR_0,ARYTM_1,ARYTM_3,CARD_1,CARD_3,CLASSES1,ENTROPY1,EUCLID,FINSEQ_1,FINSEQ_2,FINSEQ_4,FINSET_1,FUNCT_1,FUNCT_2,FVSUM_1,INCSP_1,LMOD_7,MATRIX_1,MATRIX_3,MATRIX13,MATRLIN,MATRLIN2,MESFUNC1,NAT_1,NUMBERS,ORDINAL4,PARTFUN1,PBOOLE,PRE_TOPC,PRVECT_1,QC_LANG1,RANKNULL,RELAT_1,RLAFFIN1,RLSUB_1,RLVECT_1,RLVECT_2,RLVECT_3,RLVECT_5,RVSUM_1,SEMI_AF1,STRUCT_0,SUBSET_1,SUPINF_2,TARSKI,TREES_1,VALUED_0,VALUED_1,VECTSP_1,VECTSP10,XBOOLE_0,XXREAL_0;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,CARD_1,NUMBERS,XXREAL_0,NAT_1,FINSET_1,FUNCT_1,RELSET_1,PARTFUN1,VALUED_0,FUNCT_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,STRUCT_0,RLVECT_1,RLVECT_2,RLVECT_3,VECTSP_1,MATRIX_1,MATRIX_3,VECTSP_4,VECTSP_6,VECTSP_7,MATRIX13,RVSUM_1,ALGSTR_0,FVSUM_1,RANKNULL,BINOP_2,PRE_TOPC,MATRIX_6,MATRLIN,MATRLIN2,NAT_D,EUCLID,GROUP_1,MATRIX11,FINSEQOP,ENTROPY1,RLSUB_1,RUSUB_4,PRVECT_1,RLAFFIN1,MATRTOP1;
definitions EUCLID,FINSEQ_1,MATRIX13,MATRTOP1,STRUCT_0,TARSKI,VECTSP_1,XBOOLE_0;
theorems CARD_1,CARD_2,ENTROPY1,EUCLID,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FINSEQ_6,FUNCT_1,FUNCT_2,FVSUM_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_6,MATRIX13,MATRIXR1,MATRLIN,MATRLIN2,MATRPROB,MATRTOP1,NAT_1,ORDINAL1,PARTFUN1,PRE_POLY,RANKNULL,RELAT_1,RLAFFIN1,RLSUB_1,RLVECT_1,RLVECT_2,RLVECT_3,RLVECT_5,RVSUM_1,STRUCT_0,SUBSET_1,TARSKI,TOPREAL7,VECTSP_1,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,XBOOLE_0,XBOOLE_1,XREAL_0,XREAL_1,ZFMISC_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23;
schemes FINSEQ_1,FUNCT_2,NAT_1;
registrations CARD_1,EUCLID,FINSEQ_1,FINSEQ_2,FINSET_1,FUNCT_1,FUNCT_2,MATRIX13,MATRLIN2,MATRTOP1,MEMBERED,MONOID_0,NAT_1,NUMBERS,PRVECT_1,REALSET1,RELAT_1,RELSET_1,RLAFFIN1,RLVECT_3,RVSUM_1,STRUCT_0,RLVECT_2,VALUED_0,VECTSP_1,VECTSP_9,XBOOLE_0,XREAL_0,XXREAL_0,ZFMISC_1,CKB16;
constructors BINARITH,ENTROPY1,FVSUM_1,LAPLACE,MATRIX_6,MATRIX11,MATRIX13,MATRLIN2,MATRTOP1,MONOID_0,RANKNULL,REALSET1,RELSET_1,RLAFFIN1,RLVECT_3,RUSUB_5,SEQ_1,SQUARE_1,VECTSP10,MATRIX15,MEMBERED;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve n for Nat;
reserve m for Nat;
reserve M for (Matrix of n,m,( F_Real ));
theorem
Th18: ( rng ( Mx2Tran M ) ) = ( [#] ( Lin ( lines M ) ) )
proof
consider X being set such that A1: X c= ( dom M ) and A2: ( lines M ) = ( rng ( M | X ) ) and A3: ( M | X ) is  one-to-one by MATRTOP1:6;
set V = ( m -VectSp_over ( F_Real ) );
set TM = ( Mx2Tran M );
A5: ( len M ) = n by MATRIX_1:def 2;
then reconsider X as (Subset of ( Seg n )) by A1,FINSEQ_1:def 3;
hereby
let y being set;
assume y in ( rng TM );
then consider x being set such that A6: x in ( dom TM ) and A7: ( TM . x ) = y by FUNCT_1:def 3;
reconsider x as (Element of ( TOP-REAL n )) by A6;
consider L being (Linear_Combination of ( lines M )) such that A8: ( Sum L ) = y and (for i being Nat holds (i in X implies ( L . ( Line (M,i) ) ) = ( Sum ( Seq ( x | ( M " { ( Line (M,i) ) } ) ) ) ))) by A2,A3,A7,CKB21:1;
( Sum L ) in ( Lin ( lines M ) ) by VECTSP_7:7;
hence y in ( [#] ( Lin ( lines M ) ) ) by A8,STRUCT_0:def 5;
end;
let y being set;
assume y in ( [#] ( Lin ( lines M ) ) );
then y in ( Lin ( lines M ) ) by STRUCT_0:def 5;
then consider L being (Linear_Combination of ( lines M )) such that A9: y = ( Sum L ) by VECTSP_7:7;
defpred P[ set,set ]
 means
(($1 in X implies $2 = ( L . ( M . $1 ) )) & ((not $1 in X) implies $2 = ( 0 )));
A10: (for i being Nat holds (i in ( Seg n ) implies (ex x being set st P[ i,x ])))
proof
let i being Nat;
assume that
i in ( Seg n );
(i in X or (not i in X));
hence thesis;
end;
consider f being FinSequence such that A11: (( dom f ) = ( Seg n ) & (for j being Nat holds (j in ( Seg n ) implies P[ j,( f . j ) ]))) from FINSEQ_1:sch 1(A10);
A12: ( dom M ) = ( Seg n ) by A5,FINSEQ_1:def 3;
( rng f ) c= ( REAL )
proof
let z being set;
assume z in ( rng f );
then consider x being set such that A13: x in ( dom f ) and A14: ( f . x ) = z by FUNCT_1:def 3;
reconsider x as Nat by A13;
A15: P[ x,( f . x ) ] by A11,A13;
( M . x ) = ( Line (M,x) ) by A12,A11,A13,MATRIX_2:16;
then ( M . x ) in ( lines M ) by A11,A13,MATRIX13:103;
then reconsider Mx = ( M . x ) as (Element of V);
per cases ;
suppose (not x in X);

then ( f . x ) = ( 0 ) by A11,A13;
hence thesis by A14;
end;
suppose x in X;

thus thesis by A14,A15,XREAL_0:def 1;
end;
end;
then reconsider f as (FinSequence of ( REAL )) by FINSEQ_1:def 4;
( len f ) = n by A5,A11,FINSEQ_1:def 3;
then A16: f is n -element by CARD_1:def 7;
then consider K being (Linear_Combination of ( lines M )) such that A17: ( Sum K ) = ( TM . f ) and A18: (for i being Nat holds (i in X implies ( K . ( Line (M,i) ) ) = ( Sum ( Seq ( f | ( M " { ( Line (M,i) ) } ) ) ) ))) by A2,A3,CKB21:1;
now
let v being (Element of V);
per cases ;
suppose v in ( lines M );

then consider i being set such that A19: i in ( dom ( M | X ) ) and A20: ( ( M | X ) . i ) = v by A2,FUNCT_1:def 3;
A21: ( M . i ) = v by A19,A20,FUNCT_1:47;
set D = ( dom ( f | ( M " { v } ) ) );
( Seq ( f | ( M " { v } ) ) ) = ( @ ( @ ( Seq ( f | ( M " { v } ) ) ) ) );
then reconsider F = ( Seq ( f | ( M " { v } ) ) ) as (FinSequence of ( REAL ));
A22: ( rng ( Sgm D ) ) = D by FINSEQ_1:50;
then A23: ( dom F ) = ( dom ( Sgm D ) ) by RELAT_1:27;
A24: i in ( dom M ) by A19,RELAT_1:57;
A25: i in X by A19,RELAT_1:57;
reconsider i as Nat by A19;
( M . i ) = ( Line (M,i) ) by A24,MATRIX_2:16;
then A26: ( K . v ) = ( Sum ( Seq ( f | ( M " { v } ) ) ) ) by A18,A25,A21;
v in { v } by TARSKI:def 1;
then i in ( M " { v } ) by A24,A21,FUNCT_1:def 7;
then i in D by A11,A25,RELAT_1:57;
then consider j being set such that A27: j in ( dom ( Sgm D ) ) and A28: ( ( Sgm D ) . j ) = i by A22,FUNCT_1:def 3;
reconsider j as (Element of ( NAT )) by A27;
(( F . j ) = ( ( f | ( M " { v } ) ) . i ) & i in D) by A23,A27,A28,FUNCT_1:11,FUNCT_1:12;
then A29: ( F . j ) = ( f . i ) by FUNCT_1:47;
D c= ( dom f ) by RELAT_1:60;
then A30: ( Sgm D ) is  one-to-one by A11,FINSEQ_3:92;
now
let w being (Element of ( NAT ));
assume that
A31: w in ( dom F )
and
A32: w <> j;
A33: ( ( Sgm D ) . w ) in D by A22,A23,A31,FUNCT_1:def 3;
then ( ( Sgm D ) . w ) in ( M " { v } ) by RELAT_1:57;
then ( M . ( ( Sgm D ) . w ) ) in { v } by FUNCT_1:def 7;
then A34: ( M . ( ( Sgm D ) . w ) ) = v by TARSKI:def 1;
A35: (not ( ( Sgm D ) . w ) in X)
proof
assume ( ( Sgm D ) . w ) in X;
then A36: ( ( Sgm D ) . w ) in ( dom ( M | X ) ) by A12,RELAT_1:57;
then v = ( ( M | X ) . ( ( Sgm D ) . w ) ) by A34,FUNCT_1:47;
then i = ( ( Sgm D ) . w ) by A3,A19,A20,A36,FUNCT_1:def 4;
hence contradiction by A23,A30,A27,A28,A31,A32,FUNCT_1:def 4;
end;
( F . w ) = ( ( f | ( M " { v } ) ) . ( ( Sgm D ) . w ) ) by A31,FUNCT_1:12;
then A37: ( F . w ) = ( f . ( ( Sgm D ) . w ) ) by A33,FUNCT_1:47;
( ( Sgm D ) . w ) in ( dom f ) by A33,RELAT_1:57;
hence ( F . w ) = ( 0 ) by A11,A37,A35;
end;
then A38: F has_onlyone_value_in j by A23,A27,ENTROPY1:def 2;
( f . i ) = ( L . v ) by A11,A25,A21;
hence ( L . v ) = ( K . v ) by A26,A29,A38,ENTROPY1:13;
end;
suppose A39: (not v in ( lines M ));

( Carrier L ) c= ( lines M ) by VECTSP_6:def 4;
then (not v in ( Carrier L )) by A39;
then A40: ( L . v ) = ( 0. ( F_Real ) ) by VECTSP_6:2;
( Carrier K ) c= ( lines M ) by VECTSP_6:def 4;
then (not v in ( Carrier K )) by A39;
hence ( L . v ) = ( K . v ) by A40,VECTSP_6:2;
end;
end;
then A41: ( Sum K ) = ( Sum L ) by VECTSP_6:def 7;
(( dom TM ) = ( [#] ( TOP-REAL n ) ) & f is (Point of ( TOP-REAL n ))) by A16,CKB3:1,FUNCT_2:def 1;
hence thesis by A9,A17,A41,FUNCT_1:def 3;
end;
