environ
vocabularies NUMBERS,FINSEQ_1,ORDINAL4,XBOOLE_0,SUBSET_1,RELAT_1,BINTREE1,TREES_1,MARGREL1,TARSKI,ORDINAL1,CARD_1,ARYTM_3,PARTFUN1,FUNCT_1,XBOOLEAN,TREES_2,FINSEQ_2,TREES_4,ZFMISC_1,FUNCOP_1,MCART_1,FINSEQ_5,NAT_1,BINARITH,CAT_1,XXREAL_0,EUCLID,FINSET_1,POWER,ARYTM_1,BINARI_3,INT_1,ABIAN,BINTREE2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,MCART_1,NAT_1,NAT_D,ABIAN,SERIES_1,RELAT_1,MARGREL1,DOMAIN_1,FUNCT_1,PARTFUN1,FUNCT_2,BINOP_1,FINSET_1,FUNCOP_1,FINSEQ_1,FINSEQ_2,FINSEQ_5,BINARITH,BINARI_3,TREES_1,TREES_2,TREES_4,BINTREE1,EUCLID,XXREAL_0,CKB5;
definitions TARSKI,XBOOLE_0,EUCLID,FINSEQ_2,MARGREL1,XBOOLEAN,BINOP_1;
theorems TARSKI,MCART_1,NAT_1,NAT_2,WELLORD2,ZFMISC_1,FUNCT_1,FUNCT_2,CARD_1,CARD_2,POWER,FUNCOP_1,FINSEQ_1,FINSEQ_2,FINSEQ_4,FINSEQ_5,FINSEQ_6,BINARI_3,TREES_1,TREES_2,BINTREE1,XBOOLE_0,XBOOLE_1,XREAL_1,NAT_D,PARTFUN1,RELAT_1,ORDINAL1,XXREAL_0,XREAL_0,TREES_9,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11;
schemes FUNCT_2,NAT_1,FINSEQ_2,TREES_2,FUNCT_1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FINSET_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,MARGREL1,TREES_2,TREES_9,BINTREE1,FINSEQ_2,INT_1,CARD_1;
constructors WELLORD2,DOMAIN_1,XXREAL_0,NAT_1,NAT_D,FINSEQOP,SERIES_1,BINARITH,FINSEQ_5,TREES_9,ABIAN,EUCLID,BINTREE1,BINARI_3,ORDINAL1,RELSET_1,CKB5;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
scheme DecoratedBinTreeEx { A() -> non  empty set,a() -> (Element of A()),P[set,set,set] } : (ex D being  binary (DecoratedTree of A()) st ((( dom D ) = ( { ( 0 ),1 } * ) & ( D . ( {} ) ) = a()) & (for x being (Node of D) holds P[ ( D . x ),( D . ( x ^ <* ( 0 ) *> ) ),( D . ( x ^ <* 1 *> ) ) ])))
provided
A1: (for a being (Element of A()) holds (ex b,c being (Element of A()) st P[ a,b,c ]))
proof
defpred Q[ set,set ]
 means
(ex b,c being (Element of A()) st (P[ $1,b,c ] & $2 = [ b,c ]));
A2: (for e being set holds (e in A() implies (ex u being set st (u in [: A(),A() :] & Q[ e,u ]))))
proof
let e being set;
assume e in A();
then consider b,c being (Element of A()) such that A3: P[ e,b,c ] by A1;
take u = [ b,c ];
thus u in [: A(),A() :];
thus thesis by A3;
end;
consider f being Function such that A4: ( dom f ) = A() and A5: ( rng f ) c= [: A(),A() :] and A6: (for e being set holds (e in A() implies Q[ e,( f . e ) ])) from FUNCT_1:sch 5(A2);
deffunc F(set) = ( IFEQ (( $1 `2 ),( 0 ),( ( f . ( $1 `1 ) ) `1 ),( ( f . ( $1 `1 ) ) `2 )) );
A7: (for x being set holds (x in [: A(),( NAT ) :] implies F(x) in A()))
proof
let x being set;
assume x in [: A(),( NAT ) :];
then ( x `1 ) in A() by MCART_1:10;
then A8: ( f . ( x `1 ) ) in ( rng f ) by A4,FUNCT_1:def 3;
then A9: ( ( f . ( x `1 ) ) `2 ) in A() by A5,MCART_1:10;
A10: ( ( f . ( x `1 ) ) `1 ) in A() by A5,A8,MCART_1:10;
now
per cases ;
suppose ( x `2 ) = ( 0 );

hence thesis by A10,FUNCOP_1:def 8;
end;
suppose ( x `2 ) <> ( 0 );

hence thesis by A9,FUNCOP_1:def 8;
end;
end;
hence thesis;
end;
consider F being (Function of [: A(),( NAT ) :],A()) such that A11: (for x being set holds (x in [: A(),( NAT ) :] implies ( F . x ) = F(x))) from FUNCT_2:sch 2(A7);
deffunc F(set) = 2;
consider D being (DecoratedTree of A()) such that A12: ( D . ( {} ) ) = a() and A13: (for d being (Element of ( dom D )) holds (( succ d ) = { ( d ^ <* k *> ) where k is (Element of ( NAT )): k < F(( D . d )) } & (for n being (Element of ( NAT )) holds (n < F(( D . d )) implies ( D . ( d ^ <* n *> ) ) = ( F . (( D . d ),n) ))))) from TREES_2:sch 9;
now
let t being (Element of ( dom D ));
assume (not t in ( Leaves ( dom D ) ));
{ ( t ^ <* k *> ) where k is (Element of ( NAT )): k < 2 } = { ( t ^ <* ( 0 ) *> ),( t ^ <* 1 *> ) }
proof
thus { ( t ^ <* k *> ) where k is (Element of ( NAT )): k < 2 } c= { ( t ^ <* ( 0 ) *> ),( t ^ <* 1 *> ) }
proof
let v being set;
assume v in { ( t ^ <* k *> ) where k is (Element of ( NAT )): k < 2 };
then consider k being (Element of ( NAT )) such that A14: v = ( t ^ <* k *> ) and A15: k < 2;
(k = ( 0 ) or k = 1) by A15,NAT_1:23;
hence thesis by A14,TARSKI:def 2;
end;

let v being set;
assume v in { ( t ^ <* ( 0 ) *> ),( t ^ <* 1 *> ) };
then (v = ( t ^ <* ( 0 ) *> ) or v = ( t ^ <* 1 *> )) by TARSKI:def 2;
hence thesis;
end;
hence ( succ t ) = { ( t ^ <* ( 0 ) *> ),( t ^ <* 1 *> ) } by A13;
end;
then ( dom D ) is  binary by BINTREE1:def 2;
then reconsider D as  binary (DecoratedTree of A()) by BINTREE1:def 3;
take D;
now
let t being (Element of ( dom D ));
{ ( t ^ <* k *> ) where k is (Element of ( NAT )): k < 2 } = { ( t ^ <* ( 0 ) *> ),( t ^ <* 1 *> ) }
proof
thus { ( t ^ <* k *> ) where k is (Element of ( NAT )): k < 2 } c= { ( t ^ <* ( 0 ) *> ),( t ^ <* 1 *> ) }
proof
let v being set;
assume v in { ( t ^ <* k *> ) where k is (Element of ( NAT )): k < 2 };
then consider k being (Element of ( NAT )) such that A16: v = ( t ^ <* k *> ) and A17: k < 2;
(k = ( 0 ) or k = 1) by A17,NAT_1:23;
hence thesis by A16,TARSKI:def 2;
end;

let v being set;
assume v in { ( t ^ <* ( 0 ) *> ),( t ^ <* 1 *> ) };
then (v = ( t ^ <* ( 0 ) *> ) or v = ( t ^ <* 1 *> )) by TARSKI:def 2;
hence thesis;
end;
hence ( succ t ) = { ( t ^ <* ( 0 ) *> ),( t ^ <* 1 *> ) } by A13;
end;
hence ( dom D ) = ( { ( 0 ),1 } * ) by CKB11:1;
thus ( D . ( {} ) ) = a() by A12;
let x being (Node of D);
(for e being set holds (e in A() implies P[ e,( F . (e,( 0 )) ),( F . (e,1) ) ]))
proof
let e being set;
A18: ( [ e,( 0 ) ] `2 ) = ( 0 ) by MCART_1:7;
A19: ( [ e,1 ] `2 ) = 1 by MCART_1:7;
assume A20: e in A();
then consider b,c being (Element of A()) such that A21: P[ e,b,c ] and A22: ( f . e ) = [ b,c ] by A6;
[ e,1 ] in [: A(),( NAT ) :] by A20,ZFMISC_1:87;
then A23: ( F . [ e,1 ] ) = ( IFEQ (( [ e,1 ] `2 ),( 0 ),( ( f . ( [ e,1 ] `1 ) ) `1 ),( ( f . ( [ e,1 ] `1 ) ) `2 )) ) by A11
.= ( ( f . ( [ e,1 ] `1 ) ) `2 ) by A19,FUNCOP_1:def 8
.= ( ( f . e ) `2 ) by MCART_1:7
.= c by A22,MCART_1:7;
[ e,( 0 ) ] in [: A(),( NAT ) :] by A20,ZFMISC_1:87;
then ( F . [ e,( 0 ) ] ) = ( IFEQ (( [ e,( 0 ) ] `2 ),( 0 ),( ( f . ( [ e,( 0 ) ] `1 ) ) `1 ),( ( f . ( [ e,( 0 ) ] `1 ) ) `2 )) ) by A11
.= ( ( f . ( [ e,( 0 ) ] `1 ) ) `1 ) by A18,FUNCOP_1:def 8
.= ( ( f . e ) `1 ) by MCART_1:7
.= b by A22,MCART_1:7;
hence thesis by A21,A23;
end;
then P[ ( D . x ),( F . (( D . x ),( 0 )) ),( F . (( D . x ),1) ) ];
then P[ ( D . x ),( D . ( x ^ <* ( 0 ) *> ) ),( F . (( D . x ),1) ) ] by A13;
hence thesis by A13;
end;
