environ
vocabularies NUMBERS,FINSEQ_1,ORDINAL4,XBOOLE_0,SUBSET_1,RELAT_1,BINTREE1,TREES_1,MARGREL1,TARSKI,ORDINAL1,CARD_1,ARYTM_3,PARTFUN1,FUNCT_1,XBOOLEAN,TREES_2,FINSEQ_2,TREES_4,ZFMISC_1,FUNCOP_1,MCART_1,FINSEQ_5,NAT_1,BINARITH,CAT_1,XXREAL_0,EUCLID,FINSET_1,POWER,ARYTM_1,BINARI_3,INT_1,ABIAN,BINTREE2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,MCART_1,NAT_1,NAT_D,ABIAN,SERIES_1,RELAT_1,MARGREL1,DOMAIN_1,FUNCT_1,PARTFUN1,FUNCT_2,BINOP_1,FINSET_1,FUNCOP_1,FINSEQ_1,FINSEQ_2,FINSEQ_5,BINARITH,BINARI_3,TREES_1,TREES_2,TREES_4,BINTREE1,EUCLID,XXREAL_0,CKB5;
definitions TARSKI,XBOOLE_0,EUCLID,FINSEQ_2,MARGREL1,XBOOLEAN,BINOP_1;
theorems TARSKI,MCART_1,NAT_1,NAT_2,WELLORD2,ZFMISC_1,FUNCT_1,FUNCT_2,CARD_1,CARD_2,POWER,FUNCOP_1,FINSEQ_1,FINSEQ_2,FINSEQ_4,FINSEQ_5,FINSEQ_6,BINARI_3,TREES_1,TREES_2,BINTREE1,XBOOLE_0,XBOOLE_1,XREAL_1,NAT_D,PARTFUN1,RELAT_1,ORDINAL1,XXREAL_0,XREAL_0,TREES_9,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB14;
schemes FUNCT_2,NAT_1,FINSEQ_2,TREES_2,FUNCT_1,CKB12,CKB13;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FINSET_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,MARGREL1,TREES_2,TREES_9,BINTREE1,FINSEQ_2,INT_1,CARD_1;
constructors WELLORD2,DOMAIN_1,XXREAL_0,NAT_1,NAT_D,FINSEQOP,SERIES_1,BINARITH,FINSEQ_5,TREES_9,ABIAN,EUCLID,BINTREE1,BINARI_3,ORDINAL1,RELSET_1,CKB5;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
definition
let T being  binary Tree;
let n being non empty Nat;
func NumberOnLevel (n,T) -> (Function of ( T -level n ),( NAT ))
means
:Def1: (for t being (Element of T) holds (t in ( T -level n ) implies (for F being (Element of ( n -tuples_on ( BOOLEAN ) )) holds (F = ( Rev t ) implies ( it . t ) = ( ( Absval F ) + 1 )))));
existence
proof
defpred P[ set,set ]
 means
(ex t being (Element of T) st (t = $1 & (for F being (Tuple of n,( BOOLEAN )) holds (F = ( Rev t ) implies $2 = ( ( Absval F ) + 1 )))));
A1: (for e being set holds (e in ( T -level n ) implies (ex u being set st (u in ( NAT ) & P[ e,u ]))))
proof
let e being set;
assume e in ( T -level n );
then e in { w where w is (Element of T): ( len w ) = n } by TREES_2:def 6;
then consider t being (Element of T) such that A2: t = e and A3: ( len t ) = n;
( len ( Rev t ) ) = n by A3,FINSEQ_5:def 3;
then reconsider F1 = ( Rev t ) as (Element of ( n -tuples_on ( BOOLEAN ) )) by FINSEQ_2:92;
take u = ( ( Absval F1 ) + 1 );
thus u in ( NAT );
take t;
thus t = e by A2;
let F being (Tuple of n,( BOOLEAN ));
assume F = ( Rev t );
hence thesis;
end;
consider f being Function such that A4: (( dom f ) = ( T -level n ) & ( rng f ) c= ( NAT )) and A5: (for e being set holds (e in ( T -level n ) implies P[ e,( f . e ) ])) from FUNCT_1:sch 5(A1);
reconsider f as (Function of ( T -level n ),( NAT )) by A4,FUNCT_2:2;
take f;
let t being (Element of T);
assume t in ( T -level n );
then A6: (ex t1 being (Element of T) st (t1 = t & (for F being (Tuple of n,( BOOLEAN )) holds (F = ( Rev t1 ) implies ( f . t ) = ( ( Absval F ) + 1 ))))) by A5;
let F being (Element of ( n -tuples_on ( BOOLEAN ) ));
assume F = ( Rev t );
hence thesis by A6;
end;
uniqueness
proof
let f1 being (Function of ( T -level n ),( NAT )),f2 being (Function of ( T -level n ),( NAT ));
assume that
A7: (for t being (Element of T) holds (t in ( T -level n ) implies (for F being (Element of ( n -tuples_on ( BOOLEAN ) )) holds (F = ( Rev t ) implies ( f1 . t ) = ( ( Absval F ) + 1 )))))
and
A8: (for t being (Element of T) holds (t in ( T -level n ) implies (for F being (Element of ( n -tuples_on ( BOOLEAN ) )) holds (F = ( Rev t ) implies ( f2 . t ) = ( ( Absval F ) + 1 )))));
now
let x being set;
assume A9: x in ( T -level n );
then x in { w where w is (Element of T): ( len w ) = n } by TREES_2:def 6;
then consider t being (Element of T) such that A10: t = x and A11: ( len t ) = n;
( len ( Rev t ) ) = n by A11,FINSEQ_5:def 3;
then reconsider F = ( Rev t ) as (Element of ( n -tuples_on ( BOOLEAN ) )) by FINSEQ_2:92;
thus ( f1 . x ) = ( ( Absval F ) + 1 ) by A7,A9,A10
.= ( f2 . x ) by A8,A9,A10;
end;
hence f1 = f2 by FUNCT_2:12;
end;
end;
