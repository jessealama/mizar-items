environ
vocabularies NUMBERS,REAL_1,SUBSET_1,NAT_1,XXREAL_0,POWER,ARYTM_3,RELAT_1,CARD_1,SQUARE_1,SEQ_1,FUNCT_1,ARYTM_1,ASYMPT_0,FUNCT_2,INT_1,VALUED_1,TARSKI,XREAL_0,ORDINAL1,SEQ_2,ORDINAL2,COMPLEX1,CARD_3,SERIES_1,FUNCOP_1,REALSET1,VALUED_0,NEWTON,FINSEQ_1,FINSEQ_2,ORDINAL4,XBOOLE_0,ASYMPT_1;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,FUNCT_1,FUNCT_2,INT_1,NAT_1,VALUED_1,SEQ_1,SEQ_2,NEWTON,POWER,SERIES_1,FUNCOP_1,SQUARE_1,FINSEQ_1,FINSEQ_2,RVSUM_1,ASYMPT_0,CKB5,CKB9,CKB10,CKB33,CKB41;
definitions ASYMPT_0,SQUARE_1,VALUED_1,XCMPLX_0,CKB5,CKB9,CKB10,CKB33,CKB41;
theorems TARSKI,FUNCT_2,INT_1,NAT_1,SEQ_1,SQUARE_1,SEQ_2,ABSVALUE,FUNCOP_1,POWER,NEWTON,EULER_2,SERIES_1,SEQM_3,FINSEQ_1,PRE_FF,RVSUM_1,FINSEQ_2,ASYMPT_0,XREAL_0,XBOOLE_0,XCMPLX_0,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,NAT_D,VALUED_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB7,CKB8,CKB9,CKB10,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB76,CKB77,CKB78,CKB79,CKB80,CKB81,CKB82;
schemes FUNCT_2,SEQ_1,NAT_1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_2,ASYMPT_0,SQUARE_1,VALUED_0,VALUED_1,FUNCT_2,POWER,CKB6,CKB11,CKB12,CKB34,CKB42;
constructors PARTFUN1,DOMAIN_1,REAL_1,SQUARE_1,NAT_1,NAT_D,SEQ_2,SEQM_3,RVSUM_1,NEWTON,PREPOWER,SERIES_1,SEQ_1,ASYMPT_0,RELSET_1,FUNCOP_1,BINOP_2,CKB5,CKB9,CKB10,CKB33,CKB41;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
theorem
(for g being Real_Sequence holds ((for n holds (n > ( 0 ) implies ( g . n ) = ( n to_power n ))) implies (ex s being  eventually-positive Real_Sequence st ((s = g & ( Big_Oh ( seq_n! 1 ) ) c= ( Big_Oh s )) & (not ( Big_Oh ( seq_n! 1 ) ) = ( Big_Oh s ))))))
proof
set f = ( seq_n! 1 );
let g being Real_Sequence;
assume that
A1: (for n holds (n > ( 0 ) implies ( g . n ) = ( n to_power n )));
A2: g is  eventually-positive
proof
take 1;
let n;
assume A3: n >= 1;
then ( g . n ) = ( n to_power n ) by A1;
hence thesis by A3,POWER:34;
end;
set h = ( f /" g );
reconsider g as  eventually-positive Real_Sequence by A2;
deffunc F((Element of ( NAT ))) = ( ( h . $1 ) / ( h . ( $1 + 1 ) ) );
consider p being Real_Sequence such that A4: (for n holds ( p . n ) = F(n)) from SEQ_1:sch 1;
defpred P1[ Nat ]
 means
( p . $1 ) > 2;
A5: (for n holds (n > ( 0 ) implies ( p . n ) = ( ( ( n + 1 ) / ( n + 2 ) ) * ( ( ( n + 1 ) / n ) to_power n ) )))
proof
let n;
assume A6: n > ( 0 );
A7: ( ( n + 1 ) ! ) > ( 0 ) by NEWTON:17;
( p . n ) = ( ( h . n ) / ( h . ( n + 1 ) ) ) by A4
.= ( ( ( f . n ) / ( g . n ) ) / ( h . ( n + 1 ) ) ) by CKB13:1
.= ( ( ( ( n + 1 ) ! ) / ( g . n ) ) / ( h . ( n + 1 ) ) ) by CKB41:def 1
.= ( ( ( ( n + 1 ) ! ) / ( n to_power n ) ) / ( h . ( n + 1 ) ) ) by A1,A6
.= ( ( ( ( n + 1 ) ! ) / ( n to_power n ) ) / ( ( f . ( n + 1 ) ) / ( g . ( n + 1 ) ) ) ) by CKB13:1
.= ( ( ( ( n + 1 ) ! ) / ( n to_power n ) ) / ( ( ( ( n + 1 ) + 1 ) ! ) / ( g . ( n + 1 ) ) ) ) by CKB41:def 1
.= ( ( ( ( n + 1 ) ! ) / ( n to_power n ) ) / ( ( ( ( n + 1 ) + 1 ) ! ) / ( ( n + 1 ) to_power ( n + 1 ) ) ) ) by A1
.= ( ( ( ( n + 1 ) ! ) / ( ( ( n + 1 ) + 1 ) ! ) ) * ( ( ( n + 1 ) to_power ( n + 1 ) ) / ( n to_power n ) ) ) by CKB72:1
.= ( ( ( ( n + 1 ) ! ) / ( ( ( n + 1 ) + 1 ) * ( ( n + 1 ) ! ) ) ) * ( ( ( n + 1 ) to_power ( n + 1 ) ) / ( n to_power n ) ) ) by NEWTON:15
.= ( ( ( 1 / ( ( n + 1 ) + 1 ) ) * ( ( ( n + 1 ) ! ) / ( ( n + 1 ) ! ) ) ) * ( ( ( n + 1 ) to_power ( n + 1 ) ) / ( n to_power n ) ) ) by XCMPLX_1:103
.= ( ( ( 1 / ( ( n + 1 ) + 1 ) ) * 1 ) * ( ( ( n + 1 ) to_power ( n + 1 ) ) / ( n to_power n ) ) ) by A7,XCMPLX_1:60
.= ( ( 1 / ( n + 2 ) ) * ( ( ( ( n + 1 ) to_power n ) * ( ( n + 1 ) to_power 1 ) ) / ( n to_power n ) ) ) by POWER:27
.= ( ( 1 / ( n + 2 ) ) * ( ( ( ( n + 1 ) to_power n ) * ( n + 1 ) ) / ( n to_power n ) ) ) by POWER:25
.= ( ( 1 / ( n + 2 ) ) * ( ( ( ( n + 1 ) to_power n ) * ( n + 1 ) ) * ( ( n to_power n ) " ) ) )
.= ( ( 1 / ( n + 2 ) ) * ( ( ( ( n + 1 ) to_power n ) * ( ( n to_power n ) " ) ) * ( n + 1 ) ) )
.= ( ( 1 / ( n + 2 ) ) * ( ( ( ( n + 1 ) to_power n ) / ( n to_power n ) ) * ( n + 1 ) ) )
.= ( ( 1 / ( n + 2 ) ) * ( ( ( ( n + 1 ) / n ) to_power n ) * ( n + 1 ) ) ) by A6,POWER:31
.= ( ( ( n + 1 ) * ( 1 / ( n + 2 ) ) ) * ( ( ( n + 1 ) / n ) to_power n ) )
.= ( ( ( n + 1 ) / ( n + 2 ) ) * ( ( ( n + 1 ) / n ) to_power n ) );
hence thesis;
end;
A8: (for k being Nat holds ((k >= 4 & P1[ k ]) implies P1[ ( k + 1 ) ]))
proof
let k being Nat;
assume that
A9: k >= 4
and
A10: ( p . k ) > 2;
( ( k + 2 ) * ( ( k + 1 ) " ) ) > ( ( 0 ) * ( ( k + 1 ) " ) ) by XREAL_1:68;
then A11: ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) > ( 0 ) by POWER:34;
( ( k + 1 ) * ( k " ) ) > ( ( 0 ) * ( k " ) ) by A9,XREAL_1:68;
then ( ( ( k + 1 ) / k ) to_power k ) > ( 0 ) by POWER:34;
then A12: ( ( ( ( k + 1 ) / k ) to_power k ) * ( ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) " ) ) > ( ( 0 ) * ( ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) " ) ) by A11,XREAL_1:68;
A13: k in ( NAT ) by ORDINAL1:def 12;
A14:now
assume ( ( k + 1 ) * ( k + 3 ) ) >= ( ( k + 2 ) * ( k + 2 ) );
then ( ( ( k * k ) + ( 4 * k ) ) + 3 ) >= ( ( ( k * k ) + ( 2 * ( 2 * k ) ) ) + ( 2 ^2 ) );
hence contradiction by XREAL_1:6;
end;
then ( ( k + 1 ) * ( k + 3 ) ) < ( 1 * ( ( k + 2 ) * ( k + 2 ) ) );
then A15: ( ( ( k + 1 ) * ( k + 3 ) ) / ( ( k + 2 ) * ( k + 2 ) ) ) < 1 by XREAL_1:83;
( ( k + 1 ) * ( k + 3 ) ) > ( ( 0 ) * ( k + 3 ) ) by XREAL_1:68;
then A16: ( ( ( k + 1 ) * ( k + 3 ) ) * ( ( ( k + 2 ) * ( k + 2 ) ) " ) ) > ( ( 0 ) * ( ( ( k + 2 ) * ( k + 2 ) ) " ) ) by A14,XREAL_1:68;
k >= 1 by A9,XXREAL_0:2;
then ( ( ( k + 1 ) / k ) to_power k ) <= ( 1 * ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) ) by A13,CKB76:1;
then ( ( ( ( k + 1 ) / k ) to_power k ) / ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) ) <= 1 by A11,XREAL_1:79;
then A17: ( ( ( ( k + 1 ) * ( k + 3 ) ) / ( ( k + 2 ) * ( k + 2 ) ) ) * ( ( ( ( k + 1 ) / k ) to_power k ) / ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) ) ) < ( 1 * 1 ) by A12,A16,A15,XREAL_1:98;
( ( k + 2 ) * ( ( k + 3 ) " ) ) > ( ( 0 ) * ( ( k + 3 ) " ) ) by XREAL_1:68;
then A18: ( ( ( k + 2 ) / ( k + 3 ) ) * ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) ) > ( ( ( k + 2 ) / ( k + 3 ) ) * ( 0 ) ) by A11,XREAL_1:68;
A19: ( p . ( k + 1 ) ) = ( ( ( ( k + 1 ) + 1 ) / ( ( k + 1 ) + 2 ) ) * ( ( ( k + ( 1 + 1 ) ) / ( k + 1 ) ) to_power ( k + 1 ) ) ) by A5
.= ( ( ( k + 2 ) / ( k + 3 ) ) * ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) );
then ( ( p . k ) / ( p . ( k + 1 ) ) ) = ( ( ( ( k + 1 ) / ( k + 2 ) ) * ( ( ( k + 1 ) / k ) to_power k ) ) / ( ( ( k + 2 ) / ( k + 3 ) ) * ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) ) ) by A5,A9,A13
.= ( ( ( ( k + 1 ) / ( k + 2 ) ) / ( ( k + 2 ) / ( k + 3 ) ) ) * ( ( ( ( k + 1 ) / k ) to_power k ) / ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) ) ) by XCMPLX_1:76
.= ( ( ( ( k + 1 ) * ( k + 3 ) ) / ( ( k + 2 ) * ( k + 2 ) ) ) * ( ( ( ( k + 1 ) / k ) to_power k ) / ( ( ( k + 2 ) / ( k + 1 ) ) to_power ( k + 1 ) ) ) ) by XCMPLX_1:84;
then ( ( ( p . k ) / ( p . ( k + 1 ) ) ) * ( p . ( k + 1 ) ) ) < ( 1 * ( p . ( k + 1 ) ) ) by A19,A18,A17,XREAL_1:68;
then ( p . ( k + 1 ) ) > ( p . k ) by A19,A18,XCMPLX_1:87;
hence thesis by A10,XXREAL_0:2;
end;
defpred P[ Nat ]
 means
( h . $1 ) < ( 1 / ( $1 - 2 ) );
take g;
A20: (for n holds (n >= 1 implies ( h . n ) > ( 0 )))
proof
let n;
A21: ( ( n + 1 ) ! ) > ( 0 ) by NEWTON:17;
assume A22: n >= 1;
then ( n to_power n ) > ( 0 ) by POWER:34;
then A23: ( ( ( n + 1 ) ! ) * ( 1 / ( n to_power n ) ) ) > ( ( ( n + 1 ) ! ) * ( 0 ) ) by A21,XREAL_1:68;
( h . n ) = ( ( f . n ) / ( g . n ) ) by CKB13:1
.= ( ( ( n + 1 ) ! ) / ( g . n ) ) by CKB41:def 1
.= ( ( ( n + 1 ) ! ) / ( n to_power n ) ) by A1,A22;
hence thesis by A23;
end;
( p . 4 ) = ( ( ( 4 + 1 ) / ( 4 + 2 ) ) * ( ( ( 4 + 1 ) / 4 ) to_power 4 ) ) by A5
.= ( ( 5 / 6 ) * ( ( 5 to_power 4 ) / 256 ) ) by CKB71:1,POWER:31
.= ( ( 5 * ( 5 to_power 4 ) ) / ( 6 * 256 ) )
.= ( ( ( 5 to_power 1 ) * ( 5 to_power 4 ) ) / 1536 ) by POWER:25
.= ( ( 5 to_power ( 4 + 1 ) ) / 1536 ) by POWER:27
.= ( 3125 / 1536 ) by CKB70:1;
then A24: P1[ 4 ];
A25: (for n being Nat holds (n >= 4 implies P1[ n ])) from NAT_1:sch 8(A24,A8);
A26: 3 = ( 4 - 1 );
A27: (for k being Nat holds ((k >= 4 & P[ k ]) implies P[ ( k + 1 ) ]))
proof
let k being Nat;
assume that
A28: k >= 4
and
A29: ( h . k ) < ( 1 / ( k - 2 ) );
A30: k in ( NAT ) by ORDINAL1:def 12;
A31: ( h . ( k + 1 ) ) > ( 0 ) by A20,NAT_1:11;
( p . k ) > 2 by A25,A28;
then ( ( h . k ) / ( h . ( k + 1 ) ) ) > 2 by A4,A30;
then ( ( ( h . k ) / ( h . ( k + 1 ) ) ) * ( h . ( k + 1 ) ) ) > ( 2 * ( h . ( k + 1 ) ) ) by A31,XREAL_1:68;
then ( h . k ) > ( 2 * ( h . ( k + 1 ) ) ) by A31,XCMPLX_1:87;
then A32: ( ( h . k ) / 2 ) > ( h . ( k + 1 ) ) by XREAL_1:81;
A33: ( k - 1 ) >= 3 by A26,A28,XREAL_1:9;
k >= 3 by A28,XXREAL_0:2;
then ( 2 * ( k - 2 ) ) >= ( k - 1 ) by A30,CKB69:1;
then A34: ( 1 / ( 2 * ( k - 2 ) ) ) <= ( 1 / ( k - 1 ) ) by A33,XREAL_1:85;
( ( h . k ) * ( 1 / 2 ) ) < ( ( 1 / ( k - 2 ) ) * ( 1 / 2 ) ) by A29,XREAL_1:68;
then ( ( h . k ) / 2 ) < ( 1 / ( 2 * ( k - 2 ) ) ) by XCMPLX_1:102;
then ( ( h . k ) / 2 ) < ( 1 / ( k - 1 ) ) by A34,XXREAL_0:2;
hence thesis by A32,XXREAL_0:2;
end;
( h . 4 ) = ( ( f . 4 ) / ( g . 4 ) ) by CKB13:1
.= ( ( ( 4 + 1 ) ! ) / ( g . 4 ) ) by CKB41:def 1
.= ( 120 / 256 ) by A1,CKB67:1,CKB71:1;
then A35: P[ 4 ];
A36: (for n being Nat holds (n >= 4 implies P[ n ])) from NAT_1:sch 8(A35,A27);
A37:now
let p being  real number;
set N = [/ ( ( 1 / p ) + 4 ) \];
A38: [/ ( ( 1 / p ) + 4 ) \] >= ( ( 1 / p ) + 4 ) by INT_1:def 7;
assume A39: p > ( 0 );
then A40: ( 4 + ( 1 / p ) ) > 4 by XREAL_1:29;
then A41: N >= 4 by A38,XXREAL_0:2;
reconsider N as (Element of ( NAT )) by A38,A40,INT_1:3;
take N;
let n;
assume A42: n >= N;
then A43: n >= 4 by A41,XXREAL_0:2;
then n >= 1 by XXREAL_0:2;
then A44: ( h . n ) > ( 0 ) by A20;
A45: ( ( 1 / p ) + 2 ) > ( 1 / p ) by XREAL_1:29;
n >= ( ( ( 1 / p ) + 2 ) + 2 ) by A38,A42,XXREAL_0:2;
then ( n - 2 ) >= ( ( 1 / p ) + 2 ) by XREAL_1:19;
then ( n - 2 ) > ( 1 / p ) by A45,XXREAL_0:2;
then A46: ( 1 / ( n - 2 ) ) < ( 1 / ( 1 / p ) ) by A39,XREAL_1:88;
( h . n ) < ( 1 / ( n - 2 ) ) by A36,A43;
then ( h . n ) < p by A46,XXREAL_0:2;
hence ( abs ( ( h . n ) - ( 0 ) ) ) < p by A44,ABSVALUE:def 1;
end;
then A47: h is  convergent by SEQ_2:def 6;
then A48: ( lim h ) = ( 0 ) by A37,SEQ_2:def 7;
then (not g in ( Big_Oh f )) by A47,ASYMPT_0:16;
then A49: (not f in ( Big_Omega g )) by ASYMPT_0:19;
f in ( Big_Oh g ) by A47,A48,ASYMPT_0:16;
hence thesis by A49,CKB15:1;
end;
