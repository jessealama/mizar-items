environ
vocabularies UNIALG_1,NAT_1,XBOOLE_0,FINSEQ_1,ZFMISC_1,MCART_1,RELAT_1,FUNCT_1,FUNCT_2,PARTFUN1,FINSEQ_2,SUBSET_1,TARSKI,NUMBERS,STRUCT_0,CQC_SIM1,UNIALG_2,ORDINAL1,PBOOLE,FUNCOP_1,RLVECT_2,CARD_3,CARD_1,FINSEQ_4,FUNCT_5,PRALG_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,NUMBERS,NAT_1,STRUCT_0,RELAT_1,FUNCT_1,FINSEQ_1,FUNCT_2,BINOP_1,FUNCOP_1,MCART_1,DOMAIN_1,PARTFUN1,FINSEQ_2,FUNCT_4,FUNCT_5,CARD_3,MARGREL1,DTCONSTR,UNIALG_1,UNIALG_2,PBOOLE,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB14,CKB17,CKB21,CKB22,CKB23,CKB27,CKB29,CKB30,CKB31,CKB33,CKB35,CKB36,CKB37,CKB40,CKB43,CKB50,CKB51,CKB52;
definitions TARSKI,UNIALG_1,UNIALG_2,FUNCT_1,PBOOLE,XBOOLE_0,BINOP_1,FINSEQ_2,FUNCOP_1,PARTFUN1,MARGREL1,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB14,CKB17,CKB21,CKB22,CKB23,CKB27,CKB31,CKB33,CKB35,CKB37,CKB40,CKB43,CKB50,CKB51,CKB52;
theorems TARSKI,FUNCT_1,PARTFUN1,FINSEQ_1,FINSEQ_2,FUNCOP_1,UNIALG_1,DOMAIN_1,ZFMISC_1,MCART_1,UNIALG_2,FUNCT_2,PBOOLE,FUNCT_5,CARD_3,FUNCT_4,FINSEQ_3,RELAT_1,RELSET_1,ORDINAL1,XBOOLE_0,XBOOLE_1,MARGREL1,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB16,CKB17,CKB18,CKB19,CKB21,CKB22,CKB23,CKB27,CKB31,CKB33,CKB35,CKB37,CKB39,CKB40,CKB43,CKB50,CKB51,CKB52;
schemes FINSEQ_1,PARTFUN1,FUNCT_2,FUNCT_1,CLASSES1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,PARTFUN1,FUNCOP_1,FINSEQ_1,FINSEQ_2,CARD_3,PBOOLE,STRUCT_0,UNIALG_1,CARD_1,RELSET_1,MARGREL1,CKB15,CKB20,CKB24,CKB25,CKB26,CKB28,CKB32,CKB34,CKB38,CKB41,CKB42,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49;
constructors BINOP_1,DOMAIN_1,FUNCT_4,FUNCT_5,CARD_3,PBOOLE,UNIALG_2,DTCONSTR,STRUCT_0,RELSET_1,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB14,CKB17,CKB21,CKB22,CKB23,CKB27,CKB29,CKB30,CKB31,CKB33,CKB35,CKB36,CKB37,CKB40,CKB43,CKB50,CKB51,CKB52;
requirements BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
definition
let J being non empty set;
let A being  equal-signature  Univ_Alg-yielding (ManySortedSet of J);
let n being  natural number;
assume A1: n in ( dom ( ComSign A ) );
func ProdOp (A,n) ->  equal-arity (ManySortedOperation of ( Carrier A ))
means
(for j being (Element of J) holds (for o being (operation of ( A . j )) holds (( (the charact of ( A . j )) . n ) = o implies ( it . j ) = o)));
existence
proof
defpred P[ set,set ]
 means
(for j being (Element of J) holds ($1 = j implies (for o being (operation of ( A . j )) holds (( (the charact of ( A . j )) . n ) = o implies $2 = o))));
A2: (for x holds (x in J implies (ex y st P[ x,y ])))
proof
let x;
assume x in J;
then reconsider x1 = x as (Element of J);
n in ( dom ( signature ( A . x1 ) ) ) by A1,CKB33:def 1;
then n in ( Seg ( len ( signature ( A . x1 ) ) ) ) by FINSEQ_1:def 3;
then n in ( Seg ( len (the charact of ( A . x1 )) ) ) by UNIALG_1:def 4;
then n in ( dom (the charact of ( A . x1 )) ) by FINSEQ_1:def 3;
then reconsider o = ( (the charact of ( A . x1 )) . n ) as (operation of ( A . x1 )) by FUNCT_1:def 3;
take o;
let j being (Element of J);
assume A3: x = j;
let o1 being (operation of ( A . j ));
assume ( (the charact of ( A . j )) . n ) = o1;
hence thesis by A3;
end;
consider f being Function such that A4: (( dom f ) = J & (for x holds (x in J implies P[ x,( f . x ) ]))) from CLASSES1:sch 1(A2);
reconsider f as (ManySortedSet of J) by A4,PARTFUN1:def 2,RELAT_1:def 18;
(for x holds (x in ( dom f ) implies ( f . x ) is Function))
proof
let x;
assume x in ( dom f );
then reconsider x1 = x as (Element of J) by A4;
n in ( dom ( signature ( A . x1 ) ) ) by A1,CKB33:def 1;
then n in ( Seg ( len ( signature ( A . x1 ) ) ) ) by FINSEQ_1:def 3;
then n in ( Seg ( len (the charact of ( A . x1 )) ) ) by UNIALG_1:def 4;
then n in ( dom (the charact of ( A . x1 )) ) by FINSEQ_1:def 3;
then reconsider o = ( (the charact of ( A . x1 )) . n ) as (operation of ( A . x1 )) by FUNCT_1:def 3;
( f . x ) = o by A4;
hence thesis;
end;
then reconsider f as (ManySortedFunction of J) by FUNCOP_1:def 6;
(for j being (Element of J) holds ( f . j ) is  homogeneous  quasi_total non empty  homogeneous  quasi_total non empty (PartFunc of ( ( ( Carrier A ) . j ) * ),( ( Carrier A ) . j )))
proof
let j being (Element of J);
n in ( dom ( signature ( A . j ) ) ) by A1,CKB33:def 1;
then n in ( Seg ( len ( signature ( A . j ) ) ) ) by FINSEQ_1:def 3;
then n in ( Seg ( len (the charact of ( A . j )) ) ) by UNIALG_1:def 4;
then n in ( dom (the charact of ( A . j )) ) by FINSEQ_1:def 3;
then reconsider o = ( (the charact of ( A . j )) . n ) as (operation of ( A . j )) by FUNCT_1:def 3;
((ex R being 1-sorted st (R = ( A . j ) & ( ( Carrier A ) . j ) = (the carrier of R))) & ( f . j ) = o) by A4,CKB31:def 1;
hence thesis;
end;
then reconsider f as (ManySortedOperation of ( Carrier A )) by CKB35:def 1;
(for i,j being (Element of J) holds ( arity ( f . i ) ) = ( arity ( f . j ) ))
proof
let i being (Element of J),j being (Element of J);
A5: n in ( dom ( signature ( A . j ) ) ) by A1,CKB33:def 1;
then A6: n in ( Seg ( len ( signature ( A . j ) ) ) ) by FINSEQ_1:def 3;
then n in ( Seg ( len (the charact of ( A . j )) ) ) by UNIALG_1:def 4;
then n in ( dom (the charact of ( A . j )) ) by FINSEQ_1:def 3;
then reconsider o = ( (the charact of ( A . j )) . n ) as (operation of ( A . j )) by FUNCT_1:def 3;
A7: ( ( signature ( A . j ) ) . n ) = ( arity o ) by A5,UNIALG_1:def 4;
( dom A ) = J by PARTFUN1:def 2;
then A8: ( signature ( A . i ) ) = ( signature ( A . j ) ) by CKB27:def 1;
then n in ( Seg ( len (the charact of ( A . i )) ) ) by A6,UNIALG_1:def 4;
then n in ( dom (the charact of ( A . i )) ) by FINSEQ_1:def 3;
then reconsider o1 = ( (the charact of ( A . i )) . n ) as (operation of ( A . i )) by FUNCT_1:def 3;
(( arity ( f . j ) ) = ( arity o ) & ( f . i ) = o1) by A4;
hence thesis by A8,A5,A7,UNIALG_1:def 4;
end;
then reconsider f as  equal-arity (ManySortedOperation of ( Carrier A )) by CKB39:1;
take f;
let j being (Element of J);
let o being (operation of ( A . j ));
assume ( (the charact of ( A . j )) . n ) = o;
hence thesis by A4;
end;
uniqueness
proof
let O1 being  equal-arity (ManySortedOperation of ( Carrier A )),O2 being  equal-arity (ManySortedOperation of ( Carrier A ));
assume that
A9: (for j being (Element of J) holds (for o being (operation of ( A . j )) holds (( (the charact of ( A . j )) . n ) = o implies ( O1 . j ) = o)))
and
A10: (for j being (Element of J) holds (for o being (operation of ( A . j )) holds (( (the charact of ( A . j )) . n ) = o implies ( O2 . j ) = o)));
(for x holds (x in J implies ( O1 . x ) = ( O2 . x )))
proof
let x;
assume x in J;
then reconsider x1 = x as (Element of J);
n in ( dom ( signature ( A . x1 ) ) ) by A1,CKB33:def 1;
then n in ( Seg ( len ( signature ( A . x1 ) ) ) ) by FINSEQ_1:def 3;
then n in ( Seg ( len (the charact of ( A . x1 )) ) ) by UNIALG_1:def 4;
then n in ( dom (the charact of ( A . x1 )) ) by FINSEQ_1:def 3;
then reconsider o = ( (the charact of ( A . x1 )) . n ) as (operation of ( A . x1 )) by FUNCT_1:def 3;
( O1 . x1 ) = o by A9;
hence thesis by A10;
end;
hence thesis by PBOOLE:3;
end;
end;
