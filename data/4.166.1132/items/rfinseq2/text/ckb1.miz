environ
vocabularies NUMBERS,SUBSET_1,FINSEQ_1,CARD_1,XXREAL_0,RELAT_1,REAL_1,FUNCT_1,ARYTM_3,FUNCOP_1,ARYTM_1,RFINSEQ,CLASSES1,FUNCT_2,XBOOLE_0,VALUED_0,ORDINAL4,NAT_1,RFINSEQ2;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,NUMBERS,XXREAL_0,RELAT_1,FUNCT_1,FUNCT_2,FINSEQ_1,REAL_1,NAT_1,SEQ_1,RVSUM_1,FUNCOP_1,CLASSES1,RFINSEQ,INTEGRA2;
definitions INTEGRA2,RELAT_1;
theorems TARSKI,FINSEQ_1,FINSEQ_2,FINSEQ_3,NAT_1,FUNCT_1,FUNCT_2,RVSUM_1,RELAT_1,FUNCOP_1,RFINSEQ,INTEGRA2,XREAL_1,XXREAL_0,VALUED_1,CLASSES1;
schemes NAT_1;
registrations XBOOLE_0,FUNCT_1,RELSET_1,FUNCT_2,NUMBERS,XXREAL_0,NAT_1,MEMBERED,FINSEQ_1,RFINSEQ,INTEGRA2,VALUED_0,FINSET_1,CARD_1;
constructors FUNCOP_1,REAL_1,NAT_1,BINOP_2,SEQM_3,RFINSEQ,INTEGRA2,SEQ_1,RVSUM_1,CLASSES1,RELSET_1;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
definition
let f being (FinSequence of ( REAL ));
func max_p f -> (Element of ( NAT ))
means
:Def1: ((( len f ) = ( 0 ) implies it = ( 0 )) & (( len f ) > ( 0 ) implies ((it in ( dom f ) & (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds (((i in ( dom f ) & r1 = ( f . i )) & r2 = ( f . it )) implies r1 <= r2)))) & (for j being (Element of ( NAT )) holds ((j in ( dom f ) & ( f . j ) = ( f . it )) implies it <= j)))));
existence
proof
A1: ( dom f ) = ( Seg ( len f ) ) by FINSEQ_1:def 3;
per cases ;
suppose ( len f ) = ( 0 );

hence thesis;
end;
suppose A2: ( len f ) <> ( 0 );

defpred P[ (Element of ( NAT )) ]
 means
(ex n being (Element of ( NAT )) st ((($1 <> ( 0 ) implies (n <= $1 & n in ( dom f ))) & (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((i <= $1 & i in ( dom f )) & r1 = ( f . i )) & r2 = ( f . n )) implies r1 <= r2)))) & (for j being (Element of ( NAT )) holds (((j <= $1 & j in ( dom f )) & ( f . j ) = ( f . n )) implies n <= j))));
A3: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume P[ k ];
then consider n1 being (Element of ( NAT )) such that A4: (k <> ( 0 ) implies (n1 <= k & n1 in ( dom f ))) and A5: (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((i <= k & i in ( dom f )) & r1 = ( f . i )) & r2 = ( f . n1 )) implies r1 <= r2))) and A6: (for j being (Element of ( NAT )) holds (((j <= k & j in ( dom f )) & ( f . j ) = ( f . n1 )) implies n1 <= j));
per cases ;
suppose A7: k = ( 0 );

A8: ( dom f ) = ( Seg ( len f ) ) by FINSEQ_1:def 3;
A9: (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((i <= 1 & i in ( dom f )) & r1 = ( f . i )) & r2 = ( f . 1 )) implies r1 <= r2)))
proof
let i being (Element of ( NAT ));
let r1 being Real,r2 being Real;
assume that
A10: i <= 1
and
A11: i in ( dom f )
and
A12: (r1 = ( f . i ) & r2 = ( f . 1 ));
1 <= i by A11,FINSEQ_3:25;
hence thesis by A10,A12,XXREAL_0:1;
end;
( len f ) >= ( ( 0 ) + 1 ) by A2,NAT_1:13;
then A13: 1 in ( dom f ) by A8,FINSEQ_1:1;
(for j being (Element of ( NAT )) holds (((j <= 1 & j in ( dom f )) & ( f . j ) = ( f . 1 )) implies 1 <= j)) by A8,FINSEQ_1:1;
hence thesis by A7,A13,A9;
end;
suppose A14: k <> ( 0 );

now
per cases ;
case A15: ( f . n1 ) >= ( f . ( k + 1 ) );
A16: (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((i <= ( k + 1 ) & i in ( dom f )) & r1 = ( f . i )) & r2 = ( f . n1 )) implies r1 <= r2)))
proof
let i being (Element of ( NAT ));
let r1 being Real,r2 being Real;
assume that
A17: i <= ( k + 1 )
and
A18: i in ( dom f )
and
A19: (r1 = ( f . i ) & r2 = ( f . n1 ));
per cases ;
suppose i < ( k + 1 );

then i <= k by NAT_1:13;
hence thesis by A5,A18,A19;
end;
suppose i >= ( k + 1 );

hence thesis by A15,A17,A19,XXREAL_0:1;
end;
end;
A20: n1 <= ( k + 1 ) by A4,A14,NAT_1:13;
A21: (for j being (Element of ( NAT )) holds (((j <= ( k + 1 ) & j in ( dom f )) & ( f . j ) = ( f . n1 )) implies n1 <= j))
proof
let j being (Element of ( NAT ));
assume that
A22: j <= ( k + 1 )
and
A23: (j in ( dom f ) & ( f . j ) = ( f . n1 ));
now
per cases ;
case j < ( k + 1 );
then j <= k by NAT_1:13;
hence thesis by A6,A23;
end;
case j >= ( k + 1 );
hence thesis by A20,A22,XXREAL_0:1;
end;
end;
hence thesis;
end;
(( k + 1 ) <> ( 0 ) implies (n1 <= ( k + 1 ) & n1 in ( dom f ))) by A4,A14,NAT_1:13;
hence thesis by A16,A21;
end;
case A24: ( f . n1 ) < ( f . ( k + 1 ) );
now
per cases ;
case A25: ( k + 1 ) > ( len f );
A26: (for j being (Element of ( NAT )) holds (((j <= ( k + 1 ) & j in ( dom f )) & ( f . j ) = ( f . n1 )) implies n1 <= j))
proof
let j being (Element of ( NAT ));
assume that
j <= ( k + 1 )
and
A27: (j in ( dom f ) & ( f . j ) = ( f . n1 ));
per cases ;
suppose j < ( k + 1 );

then j <= k by NAT_1:13;
hence thesis by A6,A27;
end;
suppose j >= ( k + 1 );

then k < j by NAT_1:13;
hence thesis by A4,A14,XXREAL_0:2;
end;
end;
A28: k >= ( len f ) by A25,NAT_1:13;
A29: (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((i <= ( k + 1 ) & i in ( dom f )) & r1 = ( f . i )) & r2 = ( f . n1 )) implies r1 <= r2)))
proof
let i being (Element of ( NAT ));
let r1 being Real,r2 being Real;
assume that
i <= ( k + 1 )
and
A30: i in ( dom f )
and
A31: (r1 = ( f . i ) & r2 = ( f . n1 ));
i <= ( len f ) by A1,A30,FINSEQ_1:1;
then i <= k by A28,XXREAL_0:2;
hence thesis by A5,A30,A31;
end;
n1 <= ( len f ) by A1,A4,A14,FINSEQ_1:1;
then (( k + 1 ) <> ( 0 ) implies (n1 <= ( k + 1 ) & n1 in ( dom f ))) by A4,A14,A25,XXREAL_0:2;
hence thesis by A29,A26;
end;
case A32: ( k + 1 ) <= ( len f );
set n2 = ( k + 1 );
A33: (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((i <= ( k + 1 ) & i in ( dom f )) & r1 = ( f . i )) & r2 = ( f . n2 )) implies r1 <= r2)))
proof
let i being (Element of ( NAT ));
let r1 being Real,r2 being Real;
assume that
A34: i <= ( k + 1 )
and
A35: i in ( dom f )
and
A36: r1 = ( f . i )
and
A37: r2 = ( f . n2 );
per cases ;
suppose A38: i < ( k + 1 );

reconsider r3 = ( f . n1 ) as Real;
i <= k by A38,NAT_1:13;
then r1 <= r3 by A5,A35,A36;
hence thesis by A24,A37,XXREAL_0:2;
end;
suppose i >= ( k + 1 );

hence thesis by A34,A36,A37,XXREAL_0:1;
end;
end;
A39: (for j being (Element of ( NAT )) holds (((j <= ( k + 1 ) & j in ( dom f )) & ( f . j ) = ( f . n2 )) implies n2 <= j))
proof
let j being (Element of ( NAT ));
assume that
j <= ( k + 1 )
and
A40: (j in ( dom f ) & ( f . j ) = ( f . n2 ));
per cases ;
suppose j < ( k + 1 );

then j <= k by NAT_1:13;
hence thesis by A5,A24,A40;
end;
suppose j >= ( k + 1 );

hence thesis;
end;
end;
1 <= ( 1 + k ) by NAT_1:12;
then (( k + 1 ) <> ( 0 ) implies (n2 <= ( k + 1 ) & n2 in ( dom f ))) by A1,A32,FINSEQ_1:1;
hence thesis by A33,A39;
end;
end;
hence thesis;
end;
end;
hence thesis;
end;
end;
((for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((i <= ( 0 ) & i in ( dom f )) & r1 = ( f . i )) & r2 = ( f . 1 )) implies r1 <= r2))) & (for j being (Element of ( NAT )) holds (((j <= ( 0 ) & j in ( dom f )) & ( f . j ) = ( f . 1 )) implies 1 <= j))) by A1,FINSEQ_1:1;
then A41: P[ ( 0 ) ];
(for k being (Element of ( NAT )) holds P[ k ]) from NAT_1:sch 1(A41,A3);
then consider n1 being (Element of ( NAT )) such that A42: (( len f ) <> ( 0 ) implies (n1 <= ( len f ) & n1 in ( dom f ))) and A43: (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds ((((i <= ( len f ) & i in ( dom f )) & r1 = ( f . i )) & r2 = ( f . n1 )) implies r1 <= r2))) and A44: (for j being (Element of ( NAT )) holds (((j <= ( len f ) & j in ( dom f )) & ( f . j ) = ( f . n1 )) implies n1 <= j));
A45: (for j being (Element of ( NAT )) holds ((j in ( dom f ) & ( f . j ) = ( f . n1 )) implies n1 <= j))
proof
let j being (Element of ( NAT ));
assume that
A46: j in ( dom f )
and
A47: ( f . j ) = ( f . n1 );
j <= ( len f ) by A46,FINSEQ_3:25;
hence thesis by A44,A46,A47;
end;
(for i being (Element of ( NAT )) holds (for r1,r2 being Real holds (((i in ( dom f ) & r1 = ( f . i )) & r2 = ( f . n1 )) implies r1 <= r2)))
proof
let i being (Element of ( NAT ));
let r1 being Real,r2 being Real;
assume that
A48: i in ( dom f )
and
A49: (r1 = ( f . i ) & r2 = ( f . n1 ));
i <= ( len f ) by A48,FINSEQ_3:25;
hence thesis by A43,A48,A49;
end;
hence thesis by A2,A42,A45;
end;
end;
uniqueness
proof
thus (for m1,m2 being (Element of ( NAT )) holds (((((( len f ) = ( 0 ) implies m1 = ( 0 )) & (( len f ) > ( 0 ) implies ((m1 in ( dom f ) & (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds (((i in ( dom f ) & r1 = ( f . i )) & r2 = ( f . m1 )) implies r1 <= r2)))) & (for j being (Element of ( NAT )) holds ((j in ( dom f ) & ( f . j ) = ( f . m1 )) implies m1 <= j))))) & (( len f ) = ( 0 ) implies m2 = ( 0 ))) & (( len f ) > ( 0 ) implies ((m2 in ( dom f ) & (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds (((i in ( dom f ) & r1 = ( f . i )) & r2 = ( f . m2 )) implies r1 <= r2)))) & (for j being (Element of ( NAT )) holds ((j in ( dom f ) & ( f . j ) = ( f . m2 )) implies m2 <= j))))) implies m1 = m2))
proof
let m1 being (Element of ( NAT )),m2 being (Element of ( NAT ));
assume A50: ((((( len f ) = ( 0 ) implies m1 = ( 0 )) & (( len f ) > ( 0 ) implies ((m1 in ( dom f ) & (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds (((i in ( dom f ) & r1 = ( f . i )) & r2 = ( f . m1 )) implies r1 <= r2)))) & (for j being (Element of ( NAT )) holds ((j in ( dom f ) & ( f . j ) = ( f . m1 )) implies m1 <= j))))) & (( len f ) = ( 0 ) implies m2 = ( 0 ))) & (( len f ) > ( 0 ) implies ((m2 in ( dom f ) & (for i being (Element of ( NAT )) holds (for r1,r2 being Real holds (((i in ( dom f ) & r1 = ( f . i )) & r2 = ( f . m2 )) implies r1 <= r2)))) & (for j being (Element of ( NAT )) holds ((j in ( dom f ) & ( f . j ) = ( f . m2 )) implies m2 <= j)))));
then (( f . m2 ) <= ( f . m1 ) & ( f . m1 ) <= ( f . m2 ));
then ( f . m1 ) = ( f . m2 ) by XXREAL_0:1;
then (m1 <= m2 & m2 <= m1) by A50;
hence thesis by XXREAL_0:1;
end;

end;
end;
