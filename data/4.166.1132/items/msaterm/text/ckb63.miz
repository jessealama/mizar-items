environ
vocabularies FINSEQ_1,RELAT_1,SUBSET_1,NUMBERS,ARYTM_3,XXREAL_0,NAT_1,CARD_1,FUNCT_1,TARSKI,STRUCT_0,XBOOLE_0,MSUALG_1,PBOOLE,TREES_3,MSAFREE,DTCONSTR,LANG1,ZFMISC_1,TREES_4,TDGROUP,CARD_3,TREES_2,FINSET_1,MARGREL1,PARTFUN1,TREES_9,ORDINAL4,ORDINAL1,TREES_1,MCART_1,FUNCT_6,TREES_A,QC_LANG1,MSATERM;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,NAT_1,MCART_1,RELAT_1,STRUCT_0,FUNCT_1,PARTFUN1,FINSEQ_1,FINSEQ_2,FUNCT_2,FINSET_1,TREES_1,TREES_2,CARD_3,FUNCT_6,LANG1,TREES_3,TREES_4,TREES_9,PBOOLE,MSUALG_1,DTCONSTR,MSUALG_3,MSAFREE,XXREAL_0,CKB2,CKB4,CKB5,CKB6,CKB9,CKB10,CKB12,CKB23,CKB24,CKB25,CKB31,CKB47,CKB48,CKB52,CKB53,CKB55;
definitions TARSKI,PBOOLE,XBOOLE_0,CKB2,CKB6,CKB23,CKB24,CKB31,CKB47,CKB48,CKB53,CKB55;
theorems TARSKI,NAT_1,ZFMISC_1,MCART_1,CARD_3,FUNCT_1,FINSEQ_1,FUNCT_2,FINSEQ_3,FINSEQ_4,CARD_5,FUNCT_6,TREES_1,TREES_2,MODAL_1,TREES_3,TREES_4,LANG1,DTCONSTR,TREES_9,PBOOLE,MSUALG_1,MSAFREE,DOMAIN_1,RELAT_1,XBOOLE_0,FINSET_1,XREAL_1,ORDINAL1,PARTFUN1,FINSEQ_2,CKB1,CKB2,CKB6,CKB7,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62;
schemes TREES_2,CLASSES1,DTCONSTR,PBOOLE,CKB8,CKB11,CKB26;
registrations XBOOLE_0,RELAT_1,FUNCT_1,ORDINAL1,XREAL_0,FINSEQ_1,PBOOLE,TREES_2,TREES_3,TREES_9,STRUCT_0,DTCONSTR,MSUALG_1,MSUALG_2,MSAFREE,FINSET_1,TREES_1,RELSET_1,CKB3,CKB13;
constructors XXREAL_0,NAT_1,NAT_D,TREES_9,MSUALG_3,MSAFREE,RELSET_1,FINSEQ_2,CKB2,CKB5,CKB6,CKB12,CKB23,CKB24,CKB25,CKB31,CKB47,CKB48,CKB52,CKB53,CKB55;
requirements NUMERALS,BOOLE,SUBSET,ARITHM;
begin
Lm2:now
let n being (Element of ( NAT ));
let x being set;
let p being (FinSequence of x);
n >= ( 0 ) by NAT_1:2;
then A1: ( n + 1 ) >= ( ( 0 ) + 1 ) by XREAL_1:7;
assume n < ( len p );
then ( n + 1 ) <= ( len p ) by NAT_1:13;
then ( n + 1 ) in ( dom p ) by A1,FINSEQ_3:25;
then A2: ( p . ( n + 1 ) ) in ( rng p ) by FUNCT_1:def 3;
( rng p ) c= x by FINSEQ_1:def 4;
hence ( p . ( n + 1 ) ) in x by A2;
end;
reserve S for non  void non  empty ManySortedSign;
reserve A for  non-empty MSAlgebra over S;
reserve V for (Variables of A);
reserve t for (c-Term of A,V);
reserve f for (ManySortedFunction of V,(the Sorts of A));
theorem
Th38: (for vt being  finite DecoratedTree holds (vt is_an_evaluation_of t,f implies ( vt . ( {} ) ) in ( (the Sorts of A) . ( the_sort_of t ) )))
proof
defpred P[ (c-Term of A,V) ]
 means
(for vt being  finite DecoratedTree holds (vt is_an_evaluation_of $1,f implies ( vt . ( {} ) ) in ( (the Sorts of A) . ( the_sort_of $1 ) )));
A1:now
let s being (SortSymbol of S);
let v being (Element of ( V . s ));
thus P[ ( v -term A ) ]
proof
let vt being  finite DecoratedTree;
set t = ( v -term A );
assume A2: vt is_an_evaluation_of t,f;
( root-tree ( ( f . s ) . v ) ) is_an_evaluation_of t,f by CKB57:1;
then vt = ( root-tree ( ( f . s ) . v ) ) by A2,CKB62:1;
then A3: ( vt . ( {} ) ) = ( ( f . s ) . v ) by TREES_4:3;
s = ( the_sort_of t ) by CKB37:1;
hence thesis by A3;
end;

end;
A4:now
let o being (OperSymbol of S);
let p being (ArgumentSeq of o,A,V);
assume A5: (for t being (c-Term of A,V) holds (t in ( rng p ) implies P[ t ]));
thus P[ ( ( Sym (o,( (the Sorts of A) \/ V )) ) -tree p ) ]
proof
let vt being  finite DecoratedTree;
set t = ( ( Sym (o,( (the Sorts of A) \/ V )) ) -tree p );
A6: ( dom ( (the Sorts of A) * (the ResultSort of S) ) ) = (the carrier' of S) by PARTFUN1:def 2;
assume vt is_an_evaluation_of (t qua (c-Term of A,V)),f;
then consider q being  DTree-yielding FinSequence such that A7: ( len q ) = ( len p ) and A8: vt = ( ( ( Den (o,A) ) . ( roots q ) ) -tree q ) and A9: (for i being Nat holds (for t being (c-Term of A,V) holds ((i in ( dom p ) & t = ( p . i )) implies (ex vt being  finite DecoratedTree st (vt = ( q . i ) & vt is_an_evaluation_of t,f))))) by CKB60:1;
A10: ( vt . ( {} ) ) = ( ( Den (o,A) ) . ( roots q ) ) by A8,TREES_4:def 4;
now
A11: ( rng ( the_arity_of o ) ) c= (the carrier of S) by FINSEQ_1:def 4;
A12: ( dom (the Sorts of A) ) = (the carrier of S) by PARTFUN1:def 2;
A13: ( dom ( roots q ) ) = ( dom q ) by TREES_3:def 18;
hence A14: ( dom ( roots q ) ) = ( Seg ( len q ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( the_arity_of o ) ) ) by A7,CKB40:1
.= ( dom ( the_arity_of o ) ) by FINSEQ_1:def 3
.= ( dom ( (the Sorts of A) * ( the_arity_of o ) ) ) by A12,A11,RELAT_1:27;
let x being set;
assume A15: x in ( dom ( (the Sorts of A) * ( the_arity_of o ) ) );
then consider i being (Element of ( NAT )) such that A16: x = ( i + 1 ) and A17: i < ( len q ) by A13,A14,CKB1:1;
A18: (ex T being DecoratedTree st (T = ( q . ( i + 1 ) ) & ( ( roots q ) . ( i + 1 ) ) = ( T . ( {} ) ))) by A13,A14,A15,A16,TREES_3:def 18;
( i + 1 ) in ( dom p ) by A7,A17,CKB50:1;
then A19: (ex t being (c-Term of A,V) st (((t = ( p . ( i + 1 ) ) & t = ( (p qua (FinSequence of (( S -Terms ( (the Sorts of A) \/ V ) ) qua non  empty set))) /. ( i + 1 ) )) & ( the_sort_of t ) = ( ( the_arity_of o ) . ( i + 1 ) )) & ( the_sort_of t ) = ( ( the_arity_of o ) /. ( i + 1 ) ))) by CKB40:1;
reconsider t = ( p . ( i + 1 ) ) as (c-Term of A,V) by A7,A17,Lm2;
consider vt being  finite DecoratedTree such that A20: vt = ( q . ( i + 1 ) ) and A21: vt is_an_evaluation_of t,f by A7,A9,A17,CKB50:1;
( vt . ( {} ) ) in ( (the Sorts of A) . ( the_sort_of t ) ) by A5,A7,A17,A21,CKB50:1;
hence ( ( roots q ) . x ) in ( ( (the Sorts of A) * ( the_arity_of o ) ) . x ) by A15,A16,A18,A20,A19,FUNCT_1:12;
end;
then ( roots q ) in ( product ( (the Sorts of A) * ( the_arity_of o ) ) ) by CARD_3:9;
then ( roots q ) in ( ( (the Sorts of A) # ) . ( the_arity_of o ) ) by FINSEQ_2:def 5;
then A22: ( roots q ) in ( ( (the Sorts of A) # ) . ( (the Arity of S) . o ) ) by MSUALG_1:def 1;
( dom ( ( (the Sorts of A) # ) * (the Arity of S) ) ) = (the carrier' of S) by PARTFUN1:def 2;
then ( roots q ) in ( ( ( (the Sorts of A) # ) * (the Arity of S) ) . o ) by A22,FUNCT_1:12;
then A23: ( roots q ) in ( Args (o,A) ) by MSUALG_1:def 4;
( Result (o,A) ) = ( ( (the Sorts of A) * (the ResultSort of S) ) . o ) by MSUALG_1:def 5
.= ( (the Sorts of A) . ( (the ResultSort of S) . o ) ) by A6,FUNCT_1:12
.= ( (the Sorts of A) . ( the_result_sort_of o ) ) by MSUALG_1:def 2
.= ( (the Sorts of A) . ( the_sort_of (t qua (c-Term of A,V)) ) ) by CKB38:1;
hence thesis by A10,A23,FUNCT_2:5;
end;

end;
A24:now
let s being (SortSymbol of S);
let x being (Element of ( (the Sorts of A) . s ));
thus P[ ( x -term (A,V) ) ]
proof
let vt being  finite DecoratedTree;
set t = ( x -term (A,V) );
assume A25: vt is_an_evaluation_of t,f;
( root-tree x ) is_an_evaluation_of t,f by CKB56:1;
then vt = ( root-tree x ) by A25,CKB62:1;
then A26: ( vt . ( {} ) ) = x by TREES_4:3;
s = ( the_sort_of t ) by CKB33:1;
hence thesis by A26;
end;

end;
(for t being (c-Term of A,V) holds P[ t ]) from CKB26:sch 1(A24,A1,A4);
hence thesis;
end;
