environ
vocabularies NUMBERS,SUBSET_1,FUNCT_1,NAT_1,TARSKI,RELAT_1,AFINSQ_1,ARYTM_1,ARYTM_3,FINSEQ_1,XXREAL_0,CARD_1,XBOOLE_0,ORDINAL4,CARD_3,FINSOP_1,BINOP_2,INT_1,SERIES_1,VALUED_1,PREPOWER,NEWTON,POWER,NUMERAL1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,RELAT_1,FUNCT_1,NAT_1,ORDINAL1,XXREAL_0,AFINSQ_1,VALUED_1,RELSET_1,PARTFUN1,FUNCT_2,BINOP_1,BINOP_2,RECDEF_1,SERIES_1,NEWTON,PREPOWER,POWER,AFINSQ_2,NAT_D,CKB4,CKB5;
definitions TARSKI,CKB4,CKB5;
theorems TARSKI,FUNCT_1,NAT_1,RELAT_1,ORDINAL1,CARD_1,XREAL_1,XXREAL_0,AFINSQ_2,AFINSQ_1,FUNCT_2,NAT_2,INT_1,NEWTON,BINOP_2,SERIES_1,SEQ_1,PREPOWER,POWER,XCMPLX_1,PEPIN,PRE_FF,NAT_D,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10;
schemes NAT_1,AFINSQ_2,AFINSQ_1,STIRL2_1;
registrations XBOOLE_0,RELAT_1,ORDINAL1,XXREAL_0,XREAL_0,NAT_1,CARD_1,NUMBERS,INT_1,BINOP_2,MEMBERED,NEWTON,AFINSQ_1,VALUED_1,FUNCT_2,POWER,FINSET_1,AFINSQ_2,RELSET_1,VALUED_0,FUNCT_1;
constructors PREPOWER,SERIES_1,PARTFUN3,BINOM,SETWISEO,XXREAL_0,REAL_1,NAT_D,RECDEF_1,BINOP_2,RELSET_1,ORDINAL4,SEQ_1,AFINSQ_1,AFINSQ_2,BINOP_1,CKB4,CKB5;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
theorem
(for n being Nat holds (3 divides n iff 3 divides ( Sum ( digits (n,10) ) )))
proof
let n being Nat;
consider p being (XFinSequence of ( NAT )) such that A1: ( dom p ) = ( dom ( digits (n,10) ) ) and A2: (for i being Nat holds (i in ( dom p ) implies ( p . i ) = ( ( ( digits (n,10) ) . i ) * ( 10 |^ i ) ))) and A3: ( value (( digits (n,10) ),10) ) = ( Sum p ) by CKB4:def 1;
reconsider dop = ( dom p ) as (Element of ( NAT )) by ORDINAL1:def 12;
defpred Q[ set,set ]
 means
$2 = ( ( p . $1 ) mod 3 );
A4: (for k being Nat holds (k in dop implies (ex x being (Element of ( NAT )) st Q[ k,x ])));
consider p9 being (XFinSequence of ( NAT )) such that A5: (( dom p9 ) = dop & (for k being Nat holds (k in dop implies Q[ k,( p9 . k ) ]))) from STIRL2_1:sch 5(A4);
A6:now
let i being Nat;
reconsider dz = ( ( 10 |^ i ) - 1 ) as Nat by NAT_1:20,NEWTON:83;
reconsider dz as (Element of ( NAT )) by ORDINAL1:def 12;
(3 divides ( 3 * 3 ) & 9 divides dz) by CKB8:1,NAT_D:def 3;
then 3 divides dz by NAT_D:4;
then 3 divides ( ( ( digits (n,10) ) . i ) * dz ) by NAT_D:9;
then A7: ( ( ( ( digits (n,10) ) . i ) * dz ) mod 3 ) = ( 0 ) by PEPIN:6;
assume A8: i in ( dom p );
hence ( p9 . i ) = ( ( p . i ) mod 3 ) by A5
.= ( ( ( ( digits (n,10) ) . i ) * ( dz + 1 ) ) mod 3 ) by A2,A8
.= ( ( ( ( ( digits (n,10) ) . i ) * dz ) + ( ( digits (n,10) ) . i ) ) mod 3 )
.= ( ( (( 0 ) qua Nat) + ( ( digits (n,10) ) . i ) ) mod 3 ) by A7,NAT_D:22
.= ( ( ( digits (n,10) ) . i ) mod 3 );
end;
thus (3 divides n implies 3 divides ( Sum ( digits (n,10) ) ))
proof
assume 3 divides n;
then 3 divides ( Sum p ) by A3,CKB7:1;
then ( ( Sum p ) mod 3 ) = ( 0 ) by PEPIN:6;
then ( ( Sum p9 ) mod 3 ) = ( 0 ) by A5,CKB3:1;
then ( ( Sum ( digits (n,10) ) ) mod 3 ) = ( 0 ) by A1,A5,A6,CKB3:1;
hence thesis by PEPIN:6;
end;

assume 3 divides ( Sum ( digits (n,10) ) );
then ( ( Sum ( digits (n,10) ) ) mod 3 ) = ( 0 ) by PEPIN:6;
then ( ( Sum p9 ) mod 3 ) = ( 0 ) by A1,A5,A6,CKB3:1;
then ( ( Sum p ) mod 3 ) = ( 0 ) by A5,CKB3:1;
then 3 divides ( Sum p ) by PEPIN:6;
hence thesis by A3,CKB7:1;
end;
