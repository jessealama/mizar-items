environ
vocabularies NUMBERS,SUBSET_1,FUNCT_1,NAT_1,TARSKI,RELAT_1,AFINSQ_1,ARYTM_1,ARYTM_3,FINSEQ_1,XXREAL_0,CARD_1,XBOOLE_0,ORDINAL4,CARD_3,FINSOP_1,BINOP_2,INT_1,SERIES_1,VALUED_1,PREPOWER,NEWTON,POWER,NUMERAL1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,RELAT_1,FUNCT_1,NAT_1,ORDINAL1,XXREAL_0,AFINSQ_1,VALUED_1,RELSET_1,PARTFUN1,FUNCT_2,BINOP_1,BINOP_2,RECDEF_1,SERIES_1,NEWTON,PREPOWER,POWER,AFINSQ_2,NAT_D,CKB4,CKB5;
definitions TARSKI,CKB4,CKB5;
theorems TARSKI,FUNCT_1,NAT_1,RELAT_1,ORDINAL1,CARD_1,XREAL_1,XXREAL_0,AFINSQ_2,AFINSQ_1,FUNCT_2,NAT_2,INT_1,NEWTON,BINOP_2,SERIES_1,SEQ_1,PREPOWER,POWER,XCMPLX_1,PEPIN,PRE_FF,NAT_D,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8;
schemes NAT_1,AFINSQ_2,AFINSQ_1,STIRL2_1;
registrations XBOOLE_0,RELAT_1,ORDINAL1,XXREAL_0,XREAL_0,NAT_1,CARD_1,NUMBERS,INT_1,BINOP_2,MEMBERED,NEWTON,AFINSQ_1,VALUED_1,FUNCT_2,POWER,FINSET_1,AFINSQ_2,RELSET_1,VALUED_0,FUNCT_1;
constructors PREPOWER,SERIES_1,PARTFUN3,BINOM,SETWISEO,XXREAL_0,REAL_1,NAT_D,RECDEF_1,BINOP_2,RELSET_1,ORDINAL4,SEQ_1,AFINSQ_1,AFINSQ_2,BINOP_1,CKB4,CKB5;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
theorem
(for n,b being Nat holds (b > 1 implies (b divides n iff ( ( digits (n,b) ) . ( 0 ) ) = ( 0 ))))
proof
let n being Nat,b being Nat;
reconsider B = b as (Element of ( NAT )) by ORDINAL1:def 12;
consider d being (XFinSequence of ( NAT )) such that ( dom d ) = ( dom ( digits (n,b) ) ) and A1: (for i being Nat holds (i in ( dom d ) implies ( d . i ) = ( ( ( digits (n,b) ) . i ) * ( b |^ i ) ))) and A2: ( value (( digits (n,b) ),b) ) = ( Sum d ) by CKB4:def 1;
assume A3: b > 1;
thus (b divides n implies ( ( digits (n,b) ) . ( 0 ) ) = ( 0 ))
proof
A4: ( len ( digits (n,b) ) ) >= 1 by A3,CKB6:1;
assume A5: b divides n;
consider d being (XFinSequence of ( NAT )) such that A6: ( dom d ) = ( dom ( digits (n,b) ) ) and A7: (for i being Nat holds (i in ( dom d ) implies ( d . i ) = ( ( ( digits (n,b) ) . i ) * ( b |^ i ) ))) and A8: ( value (( digits (n,b) ),b) ) = ( Sum d ) by CKB4:def 1;
per cases  by A4,XXREAL_0:1;
suppose A9: ( len ( digits (n,b) ) ) = 1;

A10: b divides ( Sum d ) by A3,A5,A8,CKB7:1;
A11: ( 0 ) in ( dom ( digits (n,b) ) ) by A9,NAT_1:44;
( len d ) = 1 by A6,A9;
then d = <% ( d . ( 0 ) ) %> by AFINSQ_1:34;
then ( Sum d ) = ( d . ( 0 ) ) by AFINSQ_2:53
.= ( ( ( digits (n,b) ) . ( 0 ) ) * ( b |^ ( 0 ) ) ) by A6,A7,A11;
then A12: b divides ( ( ( digits (n,b) ) . ( 0 ) ) * 1 ) by A10,NEWTON:4;
per cases ;
suppose n = ( 0 );

then ( digits (n,b) ) = <% ( 0 ) %> by A3,CKB5:def 1;
hence thesis by AFINSQ_1:34;
end;
suppose n <> ( 0 );

then ( ( digits (n,b) ) . ( 0 ) ) < b by A3,A11,CKB5:def 1;
hence thesis by A12,NAT_D:7;
end;
end;
suppose A13: ( len ( digits (n,b) ) ) > 1;

then reconsider k = ( ( len ( digits (n,b) ) ) - 1 ) as (Element of ( NAT )) by NAT_1:21;
defpred P[ Nat,set ]
 means
$2 = ( d . ( $1 + 1 ) );
A14:now
let l being Nat;
assume l in ( dom <% ( d . ( 0 ) ) %> );
then l in 1 by AFINSQ_1:def 4;
then l < 1 by NAT_1:44;
then l = ( 0 ) by NAT_1:14;
hence ( d . l ) = ( <% ( d . ( 0 ) ) %> . l ) by AFINSQ_1:34;
end;
A15: (for u being Nat holds (u in k implies (ex x being (Element of ( NAT )) st P[ u,x ])));
consider d9 being (XFinSequence of ( NAT )) such that A16: (( dom d9 ) = k & (for x being Nat holds (x in k implies P[ x,( d9 . x ) ]))) from STIRL2_1:sch 5(A15);
now
let i being Nat;
assume A17: i in ( dom d9 );
then i < k by A16,NAT_1:44;
then ( i + 1 ) < ( k + 1 ) by XREAL_1:8;
then A18: ( i + 1 ) in ( dom d ) by A6,NAT_1:44;
( d9 . i ) = ( d . ( i + 1 ) ) by A16,A17
.= ( ( ( digits (n,b) ) . ( i + 1 ) ) * ( b |^ ( i + 1 ) ) ) by A7,A18
.= ( ( ( digits (n,b) ) . ( i + 1 ) ) * ( ( b |^ i ) * b ) ) by NEWTON:6
.= ( b * ( ( ( digits (n,b) ) . ( i + 1 ) ) * ( b |^ i ) ) );
hence b divides ( d9 . i ) by NAT_D:def 3;
end;
then b divides ( Sum d9 ) by CKB2:1;
then A19: ( ( Sum d9 ) mod B ) = ( 0 ) by A3,PEPIN:6;
A20:now
let l being Nat;
A21: ( ( len <% ( d . ( 0 ) ) %> ) + l ) = ( l + 1 ) by AFINSQ_1:34;
assume l in ( dom d9 );
hence ( d . ( ( len <% ( d . ( 0 ) ) %> ) + l ) ) = ( d9 . l ) by A16,A21;
end;
A22: ( 0 ) in ( dom ( digits (n,b) ) ) by A13,NAT_1:44;
( dom d ) = ( k + 1 ) by A6
.= ( ( len <% ( d . ( 0 ) ) %> ) + ( len d9 ) ) by A16,AFINSQ_1:33;
then d = ( <% ( d . ( 0 ) ) %> ^ d9 ) by A14,A20,AFINSQ_1:def 3;
then ( Sum d ) = ( ( Sum <% ( d . ( 0 ) ) %> ) + ( Sum d9 ) ) by AFINSQ_2:55;
then n = ( ( Sum <% ( d . ( 0 ) ) %> ) + ( Sum d9 ) ) by A3,A8,CKB7:1;
then n = ( ( d . ( 0 ) ) + ( Sum d9 ) ) by AFINSQ_2:53;
then ( ( ( d . ( 0 ) ) + ( Sum d9 ) ) mod B ) = ( 0 ) by A3,A5,PEPIN:6;
then ( ( d . ( 0 ) ) mod b ) = ( 0 ) by A19,NAT_D:17;
then B divides ( d . ( 0 ) ) by A3,PEPIN:6;
then b divides ( ( ( digits (n,b) ) . ( 0 ) ) * ( b |^ ( 0 ) ) ) by A6,A7,A22;
then A23: b divides ( ( ( digits (n,b) ) . ( 0 ) ) * 1 ) by NEWTON:4;
per cases ;
suppose n = ( 0 );

then ( digits (n,b) ) = <% ( 0 ) %> by A3,CKB5:def 1;
hence thesis by AFINSQ_1:34;
end;
suppose n <> ( 0 );

then ( ( digits (n,b) ) . ( 0 ) ) < b by A3,A22,CKB5:def 1;
hence thesis by A23,NAT_D:7;
end;
end;
end;

assume A24: ( ( digits (n,b) ) . ( 0 ) ) = ( 0 );
now
let i being Nat;
assume A25: i in ( dom d );
per cases ;
suppose i = ( 0 );

then ( d . i ) = ( ( ( digits (n,b) ) . ( 0 ) ) * ( b |^ ( 0 ) ) ) by A1,A25
.= ( ( ( digits (n,b) ) . ( 0 ) ) * 1 ) by NEWTON:4;
hence b divides ( d . i ) by A24,NAT_D:6;
end;
suppose i > ( 0 );

then consider j being Nat such that A26: ( j + 1 ) = i by NAT_1:6;
( d . i ) = ( ( ( digits (n,b) ) . i ) * ( b |^ ( j + 1 ) ) ) by A1,A25,A26
.= ( ( ( digits (n,b) ) . i ) * ( ( b |^ j ) * b ) ) by NEWTON:6
.= ( b * ( ( ( digits (n,b) ) . i ) * ( b |^ j ) ) );
hence b divides ( d . i ) by NAT_D:def 3;
end;
end;
then b divides ( value (( digits (n,b) ),b) ) by A2,CKB2:1;
hence thesis by A3,CKB7:1;
end;
