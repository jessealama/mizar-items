environ
vocabularies NUMBERS,REAL_1,SUBSET_1,NAT_1,XBOOLE_0,XXREAL_0,FINSET_1,TARSKI,CARD_1,ARYTM_3,XREAL_0,ORDINAL1,ARYTM_1,SEQ_1,FUNCT_1,FUNCOP_1,VALUED_1,RELAT_1,SEQ_2,ORDINAL2,COMPLEX1,LIMFUNC1,FUNCT_2,INT_1,POWER,NEWTON,ASYMPT_0;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,COMPLEX1,REAL_1,FUNCT_1,FUNCT_2,INT_1,NAT_1,VALUED_1,SEQ_1,SEQ_2,NEWTON,POWER,FUNCOP_1,XXREAL_2,FINSET_1,LIMFUNC1,XXREAL_0,CKB4,CKB11,CKB12,CKB13,CKB14,CKB15,CKB17,CKB18,CKB19,CKB20,CKB24,CKB25,CKB26,CKB27,CKB28,CKB31,CKB38,CKB53,CKB63,CKB73,CKB74,CKB75,CKB77,CKB78,CKB79;
definitions TARSKI,FUNCT_1,VALUED_1,CKB4,CKB11,CKB12,CKB13,CKB14,CKB15,CKB28,CKB31,CKB38,CKB53,CKB63,CKB73,CKB74,CKB75,CKB77,CKB78,CKB79;
theorems TARSKI,FUNCT_2,INT_1,NAT_1,SEQ_1,SEQ_2,ABSVALUE,LIMFUNC1,POWER,PRE_FF,XREAL_0,XBOOLE_0,XCMPLX_0,XCMPLX_1,FUNCOP_1,XREAL_1,COMPLEX1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_2,CKB4,CKB11,CKB12,CKB13,CKB14,CKB15,CKB28,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB76,CKB77,CKB78,CKB79;
schemes FUNCT_2,FINSEQ_1,NAT_1,CKB1,CKB2,CKB3;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,VALUED_0,VALUED_1,FUNCT_2,POWER,XXREAL_2,FUNCT_1,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB16,CKB21,CKB22,CKB23,CKB29,CKB30;
constructors REAL_1,NAT_1,SEQ_2,LIMFUNC1,NEWTON,POWER,SEQ_1,VALUED_1,PARTFUN1,XXREAL_2,RELSET_1,FUNCOP_1,CKB4,CKB11,CKB12,CKB13,CKB14,CKB15,CKB17,CKB18,CKB19,CKB20,CKB24,CKB25,CKB26,CKB27,CKB28,CKB31,CKB38,CKB53,CKB63,CKB73,CKB74,CKB75,CKB77,CKB78,CKB79;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve c for Real;
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve N for (Element of ( NAT ));
reserve N2 for (Element of ( NAT ));
reserve N3 for (Element of ( NAT ));
theorem
(for f being  eventually-nonnegative Real_Sequence holds ((ex b being (Element of ( NAT )) st (b >= 2 & f is_smooth_wrt b)) implies f is  smooth))
proof
let f being  eventually-nonnegative Real_Sequence;
given b being (Element of ( NAT )) such that
A1: b >= 2
and
A2: f is_smooth_wrt b;

A3: f is  eventually-nondecreasing by A2,CKB78:def 1;
then consider N3 such that A4: (for n holds (n >= N3 implies ( f . n ) <= ( f . ( n + 1 ) ))) by CKB15:def 1;
( f taken_every b ) in ( Big_Oh f ) by A2,CKB78:def 1;
then consider t being (Element of ( Funcs (( NAT ),( REAL )) )) such that A5: ( f taken_every b ) = t and A6: (ex c st (ex N st (c > ( 0 ) & (for n holds (n >= N implies (( t . n ) <= ( c * ( f . n ) ) & ( t . n ) >= ( 0 )))))));
consider c,N2 such that A7: c > ( 0 ) and A8: (for n holds (n >= N2 implies (( t . n ) <= ( c * ( f . n ) ) & ( t . n ) >= ( 0 )))) by A6;
set N = ( max (N2,N3) );
A9: N >= N2 by XXREAL_0:25;
A10: N >= N3 by XXREAL_0:25;
now
let a being (Element of ( NAT ));
set i = [/ ( log (b,a) ) \];
A11: [/ ( log (b,a) ) \] >= ( log (b,a) ) by INT_1:def 7;
A12: b > 1 by A1,XXREAL_0:2;
A13: b <> 1 by A1;
assume A14: a >= 2;
then a > 1 by XXREAL_0:2;
then ( log (b,a) ) > ( log (b,1) ) by A12,POWER:57;
then ( log (b,a) ) > ( 0 ) by A1,A13,POWER:51;
then reconsider i as (Element of ( NAT )) by A11,INT_1:3;
reconsider i1 = ( b |^ i ) as (Element of ( NAT ));
A15:now
let n;
defpred P[ (Element of ( NAT )) ]
 means
( f . ( ( b |^ $1 ) * n ) ) <= ( ( c |^ $1 ) * ( f . n ) );
a >= 1 by A14,XXREAL_0:2;
then A16: ( a * n ) >= ( 1 * n ) by XREAL_1:64;
( b to_power ( log (b,a) ) ) <= ( b to_power i ) by A12,A11,PRE_FF:8;
then a <= ( b |^ i ) by A1,A13,POWER:def 3;
then A17: ( a * n ) <= ( i1 * n ) by XREAL_1:64;
assume A18: n >= N;
then A19: n >= N2 by A9,XXREAL_0:2;
then A20: ( t . n ) <= ( c * ( f . n ) ) by A8;
A21:now
assume ( f . n ) < ( 0 );
then ( c * ( f . n ) ) < ( c * ( 0 ) ) by A7,XREAL_1:68;
hence contradiction by A8,A19,A20;
end;
A22: (for k holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k;
set m = ( ( b |^ k ) * n );
assume A23: ( f . m ) <= ( ( c |^ k ) * ( f . n ) );
reconsider m as (Element of ( NAT ));
( c * ( f . m ) ) <= ( c * ( ( c |^ k ) * ( f . n ) ) ) by A7,A23,XREAL_1:64;
then ( c * ( f . m ) ) <= ( ( c * ( c |^ k ) ) * ( f . n ) );
then ( c * ( f . m ) ) <= ( ( ( c to_power 1 ) * ( c to_power k ) ) * ( f . n ) ) by POWER:25;
then A24: ( c * ( f . m ) ) <= ( ( c to_power ( k + 1 ) ) * ( f . n ) ) by A7,POWER:27;
m >= N2
proof
per cases ;
suppose k = ( 0 );

then ( ( b |^ k ) * n ) = ( ( b to_power ( 0 ) ) * n )
.= ( 1 * n ) by POWER:24
.= n;
hence thesis by A9,A18,XXREAL_0:2;
end;
suppose k > ( 0 );

then ( b to_power k ) > 1 by A12,POWER:35;
then ( ( b |^ k ) * n ) >= ( 1 * n ) by XREAL_1:64;
hence thesis by A19,XXREAL_0:2;
end;
end;
then ( ( f taken_every b ) . m ) <= ( c * ( f . m ) ) by A5,A8;
then A25: ( f . ( b * m ) ) <= ( c * ( f . m ) ) by CKB77:def 1;
( f . ( ( b |^ ( k + 1 ) ) * n ) ) = ( f . ( ( b to_power ( k + 1 ) ) * n ) )
.= ( f . ( ( ( b to_power 1 ) * ( b to_power k ) ) * n ) ) by A1,POWER:27
.= ( f . ( ( b * ( b |^ k ) ) * n ) ) by POWER:25
.= ( f . ( b * ( ( b |^ k ) * n ) ) );
hence thesis by A25,A24,XXREAL_0:2;
end;
( f . ( ( b |^ ( 0 ) ) * n ) ) = ( f . ( ( b to_power ( 0 ) ) * n ) )
.= ( f . ( 1 * n ) ) by POWER:24
.= ( 1 * ( f . n ) )
.= ( ( c to_power ( 0 ) ) * ( f . n ) ) by POWER:24;
then A26: P[ ( 0 ) ];
(for k holds P[ k ]) from NAT_1:sch 1(A26,A22);
then ( f . ( ( b |^ i ) * n ) ) <= ( ( c |^ i ) * ( f . n ) );
then A27: ( ( f taken_every i1 ) . n ) <= ( ( c |^ i ) * ( f . n ) ) by CKB77:def 1;
A28: n >= N3 by A10,A18,XXREAL_0:2;
then ( a * n ) >= N3 by A16,XXREAL_0:2;
then ( f . ( a * n ) ) <= ( f . ( i1 * n ) ) by A4,A17,CKB33:1;
then ( ( f taken_every a ) . n ) <= ( f . ( i1 * n ) ) by CKB77:def 1;
then ( ( f taken_every a ) . n ) <= ( ( f taken_every i1 ) . n ) by CKB77:def 1;
hence ( ( f taken_every a ) . n ) <= ( ( c |^ i ) * ( f . n ) ) by A27,XXREAL_0:2;
( f . n ) <= ( f . ( a * n ) ) by A4,A28,A16,CKB33:1;
hence ( ( f taken_every a ) . n ) >= ( 0 ) by A21,CKB77:def 1;
end;
( c |^ i ) = ( c to_power i );
then (( f taken_every a ) is (Element of ( Funcs (( NAT ),( REAL )) )) & ( c |^ i ) > ( 0 )) by A7,FUNCT_2:8,POWER:34;
then ( f taken_every a ) in ( Big_Oh f ) by A15;
hence f is_smooth_wrt a by A3,CKB78:def 1;
end;
hence thesis by CKB79:def 1;
end;
