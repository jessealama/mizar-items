environ
vocabularies NUMBERS,SUBSET_1,RELAT_1,ORDINAL4,FINSEQ_1,XBOOLE_0,BINOP_1,FUNCT_1,FINSOP_1,SETWISEO,XXREAL_0,TARSKI,NAT_1,ARYTM_3,WELLORD1,FINSUB_1,SETFAM_1,ORDERS_1,FINSET_1,ZFMISC_1,CARD_1,FUNCT_3,PARTFUN1,ARROW,ORDINAL2,ORDINAL1,RELAT_2,ARYTM_1,FINSEQ_3,FUNCOP_1,PBOOLE,FUNCT_4,FINSEQ_2,CARD_3,MEMBER_1,VALUED_0,XREAL_0,FUNCT_2,BINOP_2,CLASSES1,PRE_POLY;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,ORDERS_1,RELAT_1,XXREAL_0,XCMPLX_0,RELAT_2,FUNCT_1,PBOOLE,RELSET_1,FINSET_1,FINSUB_1,SETWISEO,ORDINAL1,PARTFUN1,FUNCT_2,BINOP_2,FINSOP_1,FINSEQ_1,FINSEQ_4,FUNCT_3,BINOP_1,NAT_1,XREAL_0,FINSEQ_2,WELLORD1,CARD_3,WSIERP_1,FUNCOP_1,FUNCT_7,NAT_D,CLASSES1,VALUED_0,VALUED_1,ORDINAL2,SETFAM_1,DOMAIN_1,ARROW,FINSEQOP,CKB1,CKB3,CKB4,CKB5,CKB7,CKB21;
definitions TARSKI,XBOOLE_0,FUNCT_1,CARD_3,RELAT_2,PBOOLE,RELSET_1,WELLORD2,RELAT_1,BINOP_1,FINSEQ_2,VALUED_0,FUNCOP_1,SETFAM_1,SEQM_3,WELLORD1,SUBSET_1,CKB7;
theorems FUNCT_1,FINSET_1,FINSEQ_3,FINSEQ_4,ZFMISC_1,FINSEQ_1,FUNCT_2,FUNCOP_1,TARSKI,FUNCT_7,BINOP_1,RELAT_1,FINSEQ_2,CARD_3,RFINSEQ,RELSET_1,CARD_1,ORDINAL1,RVSUM_1,FINSEQ_5,NAT_1,PBOOLE,NAT_2,SUBSET_1,ORDERS_1,WELLSET1,WELLORD1,RELAT_2,ORDINAL3,FINSEQ_6,SETWISEO,SETWOP_2,CARD_2,FUNCT_5,FINSUB_1,PARTFUN2,XBOOLE_0,XBOOLE_1,PARTFUN1,BINOP_2,XREAL_1,XXREAL_0,VALUED_0,VALUED_1,NAT_D,SETFAM_1,ARROW,WELLORD2,FINSOP_1,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB16,CKB24;
schemes SETWISEO,FUNCT_2,FINSEQ_2,FINSEQ_1,PBOOLE,RELSET_1,FINSEQ_4,ORDINAL1,FUNCT_7,SUBSET_1,XBOOLE_0,BINOP_1,NAT_1,PRE_CIRC,CLASSES1,CKB14,CKB22;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCOP_1,ORDINAL3,FINSET_1,XXREAL_0,XREAL_0,NAT_1,BINOP_2,CARD_1,FINSEQ_1,FINSEQ_2,CARD_3,PARTFUN1,VALUED_0,VALUED_1,RELSET_1,FUNCT_2,SETFAM_1,FINSUB_1,CKB2,CKB6,CKB15,CKB17,CKB18,CKB19,CKB20,CKB23;
constructors WELLORD2,BINOP_1,SETWISEO,CARD_3,FINSEQOP,FINSOP_1,FINSEQ_4,RFINSEQ,RFUNCT_3,NAT_D,WSIERP_1,FUNCT_7,RECDEF_1,BINOP_2,CLASSES1,BINARITH,ARROW,TOLER_1,ORDINAL2,RELSET_1,ORDERS_1,RELAT_2,WELLORD1,DOMAIN_1,SETFAM_1,ORDINAL3,PBOOLE,CKB1,CKB3,CKB4,CKB5,CKB7,CKB21;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve A for set;
reserve x for set;
reserve y for set;
reserve z for set;
definition
let X being set;
let A being  finite (Subset of X);
let R being (Order of X);
assume A1: R linearly_orders A;
func SgmX (R,A) -> (FinSequence of X) means 
:Def2: (( rng it ) = A & (for n,m being Nat holds (((n in ( dom it ) & m in ( dom it )) & n < m) implies (( it /. n ) <> ( it /. m ) & [ ( it /. n ),( it /. m ) ] in R))));
existence
proof
per cases ;
suppose A2: A is  empty;

take ( <*> X );
thus thesis by A2;
end;
suppose A3: A is non  empty;

then reconsider X9 = X as non  empty set;
reconsider A1 = A as non  empty  finite (Subset of X9) by A3;
reconsider R9 = R as (Order of X9);
deffunc F(set) = $1;
deffunc V((Element of A1)) = { F(x) where x is (Element of A1): (x <=_ R9,$1 & x <> $1) };
deffunc U((Element of A1)) = ( ( card V($1) ) +^ 1 );
A4: (for x being (Element of A1) holds U(x) is (Element of ( NAT )))
proof
let a being (Element of A1);
defpred P[ (Element of A1) ]
 means
($1 <=_ R9,a & $1 <> a);
{ F(x) where x is (Element of A1): P[ x ] } is  finite from PRE_CIRC:sch 1;
then reconsider X = { F(x) where x is (Element of A1): P[ x ] } as  finite set;
reconsider n = ( card X ) as (Element of ( NAT ));
( n +^ 1 ) = ( n + 1 ) by CARD_2:36;
hence U(a) is (Element of ( NAT ));
end;
consider f being (Function of A1,( NAT )) such that A5: (for x being (Element of A1) holds ( f . x ) = U(x)) from FUNCT_2:sch 9(A4);
A6: (for x being (Element of A1) holds (not x in V(x)))
proof
let a being (Element of A1);
assume a in V(a);
then (ex x being (Element of A1) st ((x = a & x <=_ R9,a) & x <> a));
hence thesis;
end;
A7: (for x being (Element of A1) holds V(x) c= A1)
proof
let a being (Element of A1);
let y being set;
assume y in V(a);
then (ex x being (Element of A1) st ((x = y & x <=_ R9,a) & x <> a));
hence thesis;
end;
( rng f ) c= ( Seg ( card A1 ) )
proof
let y being set;
assume y in ( rng f );
then consider x1 being set such that A8: x1 in ( dom f ) and A9: y = ( f . x1 ) by FUNCT_1:def 3;
reconsider y1 = y as Nat by A9;
reconsider x2 = x1 as (Element of A1) by A8;
defpred P[ (Element of A1) ]
 means
($1 <=_ R9,x2 & $1 <> x2);
{ F(x) where x is (Element of A1): P[ x ] } is  finite from PRE_CIRC:sch 1;
then reconsider Vx2 = V(x2) as  finite set;
Vx2 <> A1 by A6;
then A10: ( card Vx2 ) <> ( card A1 ) by A7,CKB24:1;
( card Vx2 ) <= ( card A1 ) by A7,NAT_1:43;
then ( card Vx2 ) < ( card A1 ) by A10,XXREAL_0:1;
then A11: ( ( card Vx2 ) + 1 ) <= ( card A1 ) by NAT_1:13;
A12: y = ( ( card Vx2 ) +^ 1 ) by A5,A9
.= ( ( card Vx2 ) + 1 ) by CARD_2:36;
then ( (( 0 ) qua  natural number) + 1 ) <= y1 by XREAL_1:6;
hence thesis by A11,A12,FINSEQ_1:1;
end;
then reconsider f1 = f as (Function of A1,( Seg ( card A1 ) )) by FUNCT_2:6;
A13: ( R |_2 A ) c= R by XBOOLE_1:17;
A14: R is_connected_in A by A1,ORDERS_1:def 8;
then A15: ( R |_2 A ) is  connected by ORDERS_1:75;
( field ( R9 |_2 A1 ) ) = A by ORDERS_1:15;
then A16: ( R |_2 A ) is_connected_in A by A15,RELAT_2:def 14;
A17: R9 is_transitive_in A by A1,ORDERS_1:def 8;
A18: R9 is_antisymmetric_in A by A1,ORDERS_1:def 8;
(for x1,x2 being set holds (((x1 in A1 & x2 in A1) & ( f . x1 ) = ( f . x2 )) implies x1 = x2))
proof
let x1 being set;
let x2 being set;
assume that
A19: x1 in A1
and
A20: x2 in A1
and
A21: ( f . x1 ) = ( f . x2 );
reconsider x29 = x2 as (Element of A1) by A20;
reconsider x19 = x1 as (Element of A1) by A19;
defpred P[ (Element of A1) ]
 means
($1 <=_ R9,x19 & $1 <> x19);
{ F(x) where x is (Element of A1): P[ x ] } is  finite from PRE_CIRC:sch 1;
then reconsider Vx1 = V(x19) as  finite set;
defpred P[ (Element of A1) ]
 means
($1 <=_ R9,x29 & $1 <> x29);
{ F(x) where x is (Element of A1): P[ x ] } is  finite from PRE_CIRC:sch 1;
then reconsider Vx2 = V(x29) as  finite set;
A22: (for x1,x2 being (Element of A1) holds (x1 <=_ ( R |_2 A ),x2 implies V(x1) c= V(x2)))
proof
let x1 being (Element of A1);
let x2 being (Element of A1);
assume x1 <=_ ( R |_2 A ),x2;
then A23: [ x1,x2 ] in ( R |_2 A ) by ARROW:def 4;
let x;
assume x in V(x1);
then consider a being (Element of A) such that A24: a = x and A25: a <=_ R9,x1 and A26: a <> x1;
A27: [ a,x1 ] in R9 by A25,ARROW:def 4;
then [ a,x2 ] in R9 by A23,A13,A17,RELAT_2:def 8;
then A28: a <=_ R9,x2 by ARROW:def 4;
a <> x2 by A26,A27,A23,A13,A18,RELAT_2:def 4;
hence x in V(x2) by A24,A28;
end;
( f . x19 ) = ( ( card Vx1 ) +^ 1 ) by A5
.= ( ( card Vx1 ) + 1 ) by CARD_2:36;
then A29: ( ( card Vx1 ) + 1 ) = ( ( card Vx2 ) +^ 1 ) by A5,A21
.= ( ( card Vx2 ) + 1 ) by CARD_2:36;
now
per cases ;
suppose x19 = x29;

hence thesis;
end;
suppose x19 <> x29;

then A30: ([ x19,x29 ] in ( R |_2 A ) or [ x29,x19 ] in ( R |_2 A )) by A16,RELAT_2:def 6;
A31: (for x1,x2 being (Element of A1) holds ((x1 <> x2 & x1 <=_ ( R |_2 A ),x2) implies x1 in V(x2)))
proof
let x1 being (Element of A1);
let x2 being (Element of A1);
assume that
A32: x1 <> x2;
assume x1 <=_ ( R |_2 A ),x2;
then [ x1,x2 ] in ( R |_2 A ) by ARROW:def 4;
then x1 <=_ R9,x2 by A13,ARROW:def 4;
hence x1 in V(x2) by A32;
end;
A33:now
per cases  by A30,ARROW:def 4;
suppose x19 <=_ ( R |_2 A ),x29;

hence Vx1 = Vx2 by A29,CKB24:1,A22;
end;
suppose x29 <=_ ( R |_2 A ),x19;

hence Vx1 = Vx2 by A29,CKB24:1,A22;
end;
end;
now
assume A34: x19 <> x29;
then A35: ([ x19,x29 ] in ( R |_2 A ) or [ x29,x19 ] in ( R |_2 A )) by A16,RELAT_2:def 6;
per cases  by A35,ARROW:def 4;
suppose x19 <=_ ( R |_2 A ),x29;

hence contradiction by A33,A6,A34,A31;
end;
suppose x29 <=_ ( R |_2 A ),x19;

hence contradiction by A33,A6,A34,A31;
end;
end;
hence thesis;
end;
end;
hence thesis;
end;
then A36: f1 is  one-to-one by FUNCT_2:19;
A37: (for x1,x2 being (Element of A1) holds ((( f . x1 ) qua Nat) < ( f . x2 ) implies (x1 <=_ R9,x2 & x1 <> x2)))
proof
let x1 being (Element of A1);
let x2 being (Element of A1);
defpred P[ (Element of A1) ]
 means
($1 <=_ R9,x1 & $1 <> x1);
{ F(x) where x is (Element of A1): P[ x ] } is  finite from PRE_CIRC:sch 1;
then reconsider Vx1 = V(x1) as  finite set;
defpred P[ (Element of A1) ]
 means
($1 <=_ R9,x2 & $1 <> x2);
{ F(x) where x is (Element of A1): P[ x ] } is  finite from PRE_CIRC:sch 1;
then reconsider Vx2 = V(x2) as  finite set;
assume A38: ( f . x1 ) < ( f . x2 );
A39: ( f . x1 ) = ( ( card Vx1 ) +^ 1 ) by A5
.= ( ( card Vx1 ) + 1 ) by CARD_2:36;
( f . x2 ) = ( ( card Vx2 ) +^ 1 ) by A5
.= ( ( card Vx2 ) + 1 ) by CARD_2:36;
then A40: ( ( ( card Vx1 ) + 1 ) - 1 ) < ( ( ( card Vx2 ) + 1 ) - 1 ) by A39,A38,XREAL_1:9;
reconsider Cx2 = ( card Vx2 ) as Cardinal;
reconsider Cx1 = ( card Vx1 ) as Cardinal;
A41: ( card ( card Vx2 ) ) = ( card Vx2 );
( card ( card Vx1 ) ) = ( card Vx1 );
then Cx1 in Cx2 by A41,A40,NAT_1:41;
then ( Vx2 \ Vx1 ) <> ( {} ) by CARD_1:68;
then consider a being set such that A42: a in ( Vx2 \ Vx1 ) by XBOOLE_0:def 1;
A43: (not a in Vx1) by A42,XBOOLE_0:def 5;
A44: a in Vx2 by A42;
Vx2 c= A1 by A7;
then reconsider a as (Element of A1) by A44;
A45: (ex x being (Element of A1) st ((a = x & x <=_ R9,x2) & x <> x2)) by A44;
then A46: [ a,x2 ] in R9 by ARROW:def 4;
now
per cases  by A43;
suppose (not a <=_ R9,x1);

then A47: (not [ a,x1 ] in R9) by ARROW:def 4;
now
per cases ;
suppose x1 = a;

hence thesis by A45;
end;
suppose A48: x1 <> a;

then A49: [ x1,a ] in R9 by A14,A47,RELAT_2:def 6;
then [ x1,x2 ] in R9 by A46,A17,RELAT_2:def 8;
hence x1 <=_ R9,x2 by ARROW:def 4;
assume x1 = x2;
then a = x1 by A49,A46,A18,RELAT_2:def 4;
hence contradiction by A48;
end;
end;
hence thesis;
end;
suppose a = x1;

hence thesis by A45;
end;
end;
hence thesis;
end;
( card ( Seg ( card A1 ) ) ) = ( card A1 ) by FINSEQ_1:57;
then ( rng f1 ) = ( Seg ( card A1 ) ) by A36,FINSEQ_4:63;
then ( dom ( (f1 qua Function) " ) ) = ( Seg ( card A1 ) ) by A36,FUNCT_1:33;
then reconsider g1 = ( (f1 qua Function) " ) as FinSequence by FINSEQ_1:def 2;
A50: ( dom f1 ) = A by FUNCT_2:def 1;
then A51: ( rng g1 ) = A by A36,FUNCT_1:33;
then reconsider g = g1 as (FinSequence of X) by FINSEQ_1:def 4;
take g;
thus ( rng g ) = A by A36,A50,FUNCT_1:33;
let n being Nat;
let m being Nat;
assume that
A52: n in ( dom g )
and
A53: m in ( dom g )
and
A54: n < m;
reconsider gn = ( g . n ) as (Element of A1) by A51,A52,FUNCT_1:def 3;
n in ( rng f ) by A36,A52,FUNCT_1:33;
then A55: n = ( f . gn ) by A36,FUNCT_1:35;
reconsider gm = ( g . m ) as (Element of A1) by A51,A53,FUNCT_1:def 3;
A56: gm = ( g /. m ) by A53,PARTFUN1:def 6;
A57: m in ( rng f ) by A36,A53,FUNCT_1:33;
then m = ( f . gm ) by A36,FUNCT_1:35;
then gn <=_ R9,gm by A37,A54,A55;
then [ gn,gm ] in R by ARROW:def 4;
then A58: [ gn,gm ] in ( R |_2 A ) by XBOOLE_0:def 4;
gn = ( g /. n ) by A52,PARTFUN1:def 6;
hence thesis by A36,A54,A57,A55,A13,A58,A56,FUNCT_1:35;
end;
end;
uniqueness
proof
let p9 being (FinSequence of X);
let q9 being (FinSequence of X);
assume that
A59: ( rng p9 ) = A
and
A60: (for n,m being Nat holds (((n in ( dom p9 ) & m in ( dom p9 )) & n < m) implies (( p9 /. n ) <> ( p9 /. m ) & [ ( p9 /. n ),( p9 /. m ) ] in R)))
and
A61: ( rng q9 ) = A
and
A62: (for n,m being Nat holds (((n in ( dom q9 ) & m in ( dom q9 )) & n < m) implies (( q9 /. n ) <> ( q9 /. m ) & [ ( q9 /. n ),( q9 /. m ) ] in R)));
per cases ;
suppose A63: A is  empty;

then p9 is  empty by A59;
hence thesis by A61,A63;
end;
suppose A64: A is non  empty;

then reconsider X9 = X as non  empty set;
reconsider A9 = A as non  empty  finite (Subset of X9) by A64;
set E = ( <*> A9 );
defpred X[ (FinSequence of A9) ]
 means
(($1 is (FinSequence of A9) & (for n,m being Nat holds (((n in ( dom $1 ) & m in ( dom $1 )) & n < m) implies (( $1 /. n ) <> ( $1 /. m ) & [ ( $1 /. n ),( $1 /. m ) ] in R)))) implies (for q being (FinSequence of A9) holds ((( rng q ) = ( rng $1 ) & (for n,m being Nat holds (((n in ( dom q ) & m in ( dom q )) & n < m) implies (( q /. n ) <> ( q /. m ) & [ ( q /. n ),( q /. m ) ] in R)))) implies q = $1)));
reconsider p = p9,q = q9 as (FinSequence of A9) by A59,A61,FINSEQ_1:def 4;
A65: (for p being (FinSequence of A9) holds (for x being (Element of A9) holds (X[ p ] implies X[ (( p ^ <* x *> ) qua (FinSequence of A9)) ])))
proof
let p being (FinSequence of A9);
let x being (Element of A9);
assume A66: X[ p ];
assume ( p ^ <* x *> ) is (FinSequence of A9);
assume A67: (for n,m being Nat holds (((n in ( dom ( p ^ <* x *> ) ) & m in ( dom ( p ^ <* x *> ) )) & n < m) implies (( (( p ^ <* x *> ) qua (FinSequence of A9)) /. n ) <> ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. m ) & [ ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. n ),( (( p ^ <* x *> ) qua (FinSequence of A9)) /. m ) ] in R)));
let q being (FinSequence of A9);
assume that
A68: ( rng q ) = ( rng ( p ^ <* x *> ) )
and
A69: (for n,m being Nat holds (((n in ( dom q ) & m in ( dom q )) & n < m) implies (( q /. n ) <> ( q /. m ) & [ ( q /. n ),( q /. m ) ] in R)));
deffunc V(Nat) = ( q . $1 );
A70: q <> ( 0 ) by A68;
then consider n being Nat such that A71: ( len q ) = ( n + 1 ) by NAT_1:6;
reconsider n as (Element of ( NAT )) by ORDINAL1:def 12;
(ex q9 being FinSequence st (( len q9 ) = n & (for m being Nat holds (m in ( dom q9 ) implies ( q9 . m ) = V(m))))) from FINSEQ_1:sch 2;
then consider q9 being FinSequence such that A72: ( len q9 ) = n and A73: (for m being Nat holds (m in ( dom q9 ) implies ( q9 . m ) = ( q . m )));
1 in ( Seg 1 ) by FINSEQ_1:2,TARSKI:def 1;
then A74: 1 in ( dom <* x *> ) by FINSEQ_1:def 8;
A75: (ex m being (Element of A9) st (m = x & (for l being (Element of A9) holds ((l in ( rng ( p ^ <* x *> ) ) & l <> x) implies [ l,m ] in R))))
proof
reconsider m = x as (Element of A9);
take m;
thus m = x;
thus (for l being (Element of A9) holds ((l in ( rng ( p ^ <* x *> ) ) & l <> x) implies [ l,m ] in R))
proof
let l being (Element of A9);
assume that
A76: l in ( rng ( p ^ <* x *> ) )
and
A77: l <> x;
consider y such that A78: y in ( dom ( p ^ <* x *> ) ) and A79: l = ( ( p ^ <* x *> ) . y ) by A76,FUNCT_1:def 3;
A80: l = ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. y ) by A78,A79,PARTFUN1:def 6;
reconsider k = y as (Element of ( NAT )) by A78;
A81: k <> ( ( len p ) + 1 )
proof
assume k = ( ( len p ) + 1 );
then ( ( p ^ <* x *> ) . k ) = ( <* x *> . 1 ) by A74,FINSEQ_1:def 7
.= x by FINSEQ_1:def 8;
hence contradiction by A77,A79;
end;
A82: y in ( Seg ( len ( p ^ <* x *> ) ) ) by A78,FINSEQ_1:def 3;
then k <= ( len ( p ^ <* x *> ) ) by FINSEQ_1:1;
then k <= ( ( len p ) + ( len <* x *> ) ) by FINSEQ_1:22;
then k <= ( ( len p ) + 1 ) by FINSEQ_1:39;
then k < ( ( len p ) + 1 ) by A81,XXREAL_0:1;
then k < ( ( len p ) + ( len <* x *> ) ) by FINSEQ_1:39;
then A83: k < ( len ( p ^ <* x *> ) ) by FINSEQ_1:22;
1 <= k by A82,FINSEQ_1:1;
then ( 1 - ( len ( p ^ <* x *> ) ) ) < ( k - k ) by A83,XREAL_1:15;
then 1 < ( len ( p ^ <* x *> ) ) by XREAL_1:48;
then ( len ( p ^ <* x *> ) ) in ( Seg ( len ( p ^ <* x *> ) ) ) by FINSEQ_1:1;
then A84: ( len ( p ^ <* x *> ) ) in ( dom ( p ^ <* x *> ) ) by FINSEQ_1:def 3;
m = ( ( p ^ <* x *> ) . ( ( len p ) + 1 ) ) by FINSEQ_1:42
.= ( ( p ^ <* x *> ) . ( ( len p ) + ( len <* x *> ) ) ) by FINSEQ_1:39
.= ( ( p ^ <* x *> ) . ( len ( p ^ <* x *> ) ) ) by FINSEQ_1:22;
then m = ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. ( len ( p ^ <* x *> ) ) ) by A84,PARTFUN1:def 6;
hence thesis by A67,A78,A80,A83,A84;
end;

end;
A85: (for m being Nat holds (m in ( dom <* x *> ) implies ( q . ( ( len q9 ) + m ) ) = ( <* x *> . m )))
proof
let m being Nat;
assume m in ( dom <* x *> );
then A86: m in { 1 } by FINSEQ_1:2,FINSEQ_1:def 8;
A87: ( q . ( ( len q9 ) + m ) ) = x
proof
consider d1 being (Element of A9) such that A88: d1 = x and A89: (for l being (Element of A9) holds ((l in ( rng ( p ^ <* x *> ) ) & l <> x) implies [ l,d1 ] in R)) by A75;
reconsider d = d1 as (Element of A9);
( len q ) in ( Seg ( len q ) ) by A70,FINSEQ_1:3;
then A90: ( len q ) in ( dom q ) by FINSEQ_1:def 3;
then ( q . ( len q ) ) in ( rng q ) by FUNCT_1:def 3;
then reconsider k = ( q . ( len q ) ) as (Element of A9);
A91: k = ( q /. ( len q ) ) by A90,PARTFUN1:def 6;
( field R ) = X by ORDERS_1:12;
then A92: R is_antisymmetric_in X by RELAT_2:def 12;
assume ( q . ( ( len q9 ) + m ) ) <> x;
then A93: ( q . ( len q ) ) <> x by A71,A72,A86,TARSKI:def 1;
x in { x } by TARSKI:def 1;
then x in ( rng <* x *> ) by FINSEQ_1:38;
then x in ( ( rng p ) \/ ( rng <* x *> ) ) by XBOOLE_0:def 3;
then x in ( rng q ) by A68,FINSEQ_1:31;
then consider y such that A94: y in ( dom q ) and A95: x = ( q . y ) by FUNCT_1:def 3;
A96: y in ( Seg ( len q ) ) by A94,FINSEQ_1:def 3;
reconsider y as (Element of ( NAT )) by A94;
y <= ( len q ) by A96,FINSEQ_1:1;
then A97: y < ( len q ) by A93,A95,XXREAL_0:1;
( q . ( len q ) ) in ( rng ( p ^ <* x *> ) ) by A68,A90,FUNCT_1:def 3;
then A98: [ k,d ] in R by A93,A89;
A99: d = ( q /. y ) by A88,A94,A95,PARTFUN1:def 6;
then A100: [ d,k ] in R by A69,A94,A90,A97,A91;
k <> d by A69,A94,A90,A97,A91,A99;
hence contradiction by A98,A100,A92,RELAT_2:def 4;
end;
m = 1 by A86,TARSKI:def 1;
hence thesis by A87,FINSEQ_1:40;
end;
now
let x;
A101: n <= ( n + 1 ) by NAT_1:11;
assume x in ( rng q9 );
then consider y such that A102: y in ( dom q9 ) and A103: x = ( q9 . y ) by FUNCT_1:def 3;
A104: y in ( Seg ( len q9 ) ) by A102,FINSEQ_1:def 3;
reconsider y as (Element of ( NAT )) by A102;
y <= n by A72,A104,FINSEQ_1:1;
then A105: y <= ( n + 1 ) by A101,XXREAL_0:2;
1 <= y by A104,FINSEQ_1:1;
then y in ( dom q ) by A71,A105,FINSEQ_3:25;
then ( q . y ) in ( rng q ) by FUNCT_1:def 3;
then ( q . y ) in A9;
hence x in A9 by A73,A102,A103;
end;
then ( rng q9 ) c= A9 by TARSKI:def 3;
then reconsider f = q9 as (FinSequence of A9) by FINSEQ_1:def 4;
( dom q ) = ( Seg ( n + 1 ) ) by A71,FINSEQ_1:def 3
.= ( Seg ( ( len q9 ) + ( len <* x *> ) ) ) by A72,FINSEQ_1:39;
then A106: ( q9 ^ <* x *> ) = q by A73,A85,FINSEQ_1:def 7;
A107: (not x in ( rng p ))
proof
( ( len p ) + 1 ) = ( ( len p ) + ( len <* x *> ) ) by FINSEQ_1:39
.= ( len ( p ^ <* x *> ) ) by FINSEQ_1:22;
then ( ( len p ) + 1 ) in ( Seg ( len ( p ^ <* x *> ) ) ) by FINSEQ_1:4;
then A108: ( ( len p ) + 1 ) in ( dom ( p ^ <* x *> ) ) by FINSEQ_1:def 3;
assume x in ( rng p );
then consider y such that A109: y in ( dom p ) and A110: x = ( p . y ) by FUNCT_1:def 3;
A111: y in ( Seg ( len p ) ) by A109,FINSEQ_1:def 3;
A112: ( dom p ) c= ( dom ( p ^ <* x *> ) ) by FINSEQ_1:26;
reconsider y as (Element of ( NAT )) by A109;
x = ( (( p ^ <* x *> ) qua (FinSequence of A9)) . y ) by A109,A110,FINSEQ_1:def 7;
then A113: x = ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. y ) by A109,A112,PARTFUN1:def 6;
y <= ( len p ) by A111,FINSEQ_1:1;
then A114: y < ( ( len p ) + 1 ) by NAT_1:13;
x = ( (( p ^ <* x *> ) qua (FinSequence of A9)) . ( ( len p ) + 1 ) ) by FINSEQ_1:42;
then ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. y ) = ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. ( ( len p ) + 1 ) ) by A108,A113,PARTFUN1:def 6;
hence contradiction by A67,A109,A108,A112,A114;
end;
A115: (for z holds (z in ( ( ( rng p ) \/ { x } ) \ { x } ) iff z in ( rng p )))
proof
let z;
thus (z in ( ( ( rng p ) \/ { x } ) \ { x } ) implies z in ( rng p ))
proof
assume A116: z in ( ( ( rng p ) \/ { x } ) \ { x } );
then A117: (not z in { x }) by XBOOLE_0:def 5;
z in ( ( rng p ) \/ { x } ) by A116,XBOOLE_0:def 5;
hence thesis by A117,XBOOLE_0:def 3;
end;

assume A118: z in ( rng p );
then A119: z in ( ( rng p ) \/ { x } ) by XBOOLE_0:def 3;
(not z in { x }) by A107,A118,TARSKI:def 1;
hence thesis by A119,XBOOLE_0:def 5;
end;
( rng ( p ^ <* x *> ) ) = ( ( rng p ) \/ ( rng <* x *> ) ) by FINSEQ_1:31
.= ( ( rng p ) \/ { x } ) by FINSEQ_1:39;
then A120: ( rng p ) = ( ( rng ( p ^ <* x *> ) ) \ { x } ) by A115,TARSKI:1;
A121: (( rng f ) = ( rng p ) & (for l,m being Nat holds (((l in ( dom f ) & m in ( dom f )) & l < m) implies (( f /. l ) <> ( f /. m ) & [ ( f /. l ),( f /. m ) ] in R))))
proof
A122: (not x in ( rng f ))
proof
( ( len f ) + 1 ) = ( ( len f ) + ( len <* x *> ) ) by FINSEQ_1:39
.= ( len ( f ^ <* x *> ) ) by FINSEQ_1:22;
then ( ( len f ) + 1 ) in ( Seg ( len ( f ^ <* x *> ) ) ) by FINSEQ_1:4;
then A123: ( ( len f ) + 1 ) in ( dom ( f ^ <* x *> ) ) by FINSEQ_1:def 3;
assume x in ( rng f );
then consider y such that A124: y in ( dom f ) and A125: x = ( f . y ) by FUNCT_1:def 3;
A126: y in ( Seg ( len f ) ) by A124,FINSEQ_1:def 3;
A127: ( dom f ) c= ( dom ( f ^ <* x *> ) ) by FINSEQ_1:26;
reconsider y as (Element of ( NAT )) by A124;
x = ( q . y ) by A73,A124,A125;
then A128: x = ( q /. y ) by A106,A124,A127,PARTFUN1:def 6;
y <= ( len f ) by A126,FINSEQ_1:1;
then A129: y < ( ( len f ) + 1 ) by NAT_1:13;
x = ( q . ( ( len f ) + 1 ) ) by A106,FINSEQ_1:42;
then ( q /. y ) = ( q /. ( ( len f ) + 1 ) ) by A106,A123,A128,PARTFUN1:def 6;
hence contradiction by A69,A106,A124,A123,A127,A129;
end;
A130: (for z holds (z in ( ( ( rng f ) \/ { x } ) \ { x } ) iff z in ( rng f )))
proof
let z;
hereby
assume A131: z in ( ( ( rng f ) \/ { x } ) \ { x } );
then A132: (not z in { x }) by XBOOLE_0:def 5;
z in ( ( rng f ) \/ { x } ) by A131,XBOOLE_0:def 5;
hence z in ( rng f ) by A132,XBOOLE_0:def 3;
end;
assume A133: z in ( rng f );
then A134: z in ( ( rng f ) \/ { x } ) by XBOOLE_0:def 3;
(not z in { x }) by A122,A133,TARSKI:def 1;
hence thesis by A134,XBOOLE_0:def 5;
end;
( rng ( f ^ <* x *> ) ) = ( ( rng f ) \/ ( rng <* x *> ) ) by FINSEQ_1:31
.= ( ( rng f ) \/ { x } ) by FINSEQ_1:39;
hence ( rng f ) = ( rng p ) by A68,A106,A120,A130,TARSKI:1;
let l being Nat;
let m being Nat;
assume that
A135: l in ( dom f )
and
A136: m in ( dom f )
and
A137: l < m;
A138: ( f . m ) = ( f /. m ) by A136,PARTFUN1:def 6;
A139: ( dom f ) c= ( dom q ) by A106,FINSEQ_1:26;
then ( q . m ) = ( q /. m ) by A136,PARTFUN1:def 6;
then A140: ( f /. m ) = ( q /. m ) by A73,A136,A138;
A141: ( f . l ) = ( f /. l ) by A135,PARTFUN1:def 6;
( q . l ) = ( q /. l ) by A139,A135,PARTFUN1:def 6;
then ( f /. l ) = ( q /. l ) by A73,A135,A141;
hence thesis by A69,A139,A135,A136,A137,A140;
end;
(p is (FinSequence of A9) & (for l,m being Nat holds (((l in ( dom p ) & m in ( dom p )) & l < m) implies (( p /. l ) <> ( p /. m ) & [ ( p /. l ),( p /. m ) ] in R))))
proof
thus p is (FinSequence of A9);
let l being Nat;
let m being Nat;
assume that
A142: l in ( dom p )
and
A143: m in ( dom p )
and
A144: l < m;
A145: ( dom p ) c= ( dom ( p ^ <* x *> ) ) by FINSEQ_1:26;
( p . m ) = ( ( p ^ <* x *> ) . m ) by A143,FINSEQ_1:def 7;
then ( p . m ) = ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. m ) by A143,A145,PARTFUN1:def 6;
then A146: ( p /. m ) = ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. m ) by A143,PARTFUN1:def 6;
( p . l ) = ( ( p ^ <* x *> ) . l ) by A142,FINSEQ_1:def 7;
then ( p . l ) = ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. l ) by A142,A145,PARTFUN1:def 6;
then ( p /. l ) = ( (( p ^ <* x *> ) qua (FinSequence of A9)) /. l ) by A142,PARTFUN1:def 6;
hence thesis by A67,A142,A143,A144,A145,A146;
end;
hence thesis by A66,A106,A121;
end;
A147:now
let n being Nat;
let m being Nat;
assume that
A148: n in ( dom p )
and
A149: m in ( dom p )
and
A150: n < m;
A151: ( p /. m ) = ( p . m ) by A149,PARTFUN1:def 6
.= ( p9 /. m ) by A149,PARTFUN1:def 6;
( p /. n ) = ( p . n ) by A148,PARTFUN1:def 6
.= ( p9 /. n ) by A148,PARTFUN1:def 6;
hence (( p /. n ) <> ( p /. m ) & [ ( p /. n ),( p /. m ) ] in R) by A60,A148,A149,A150,A151;
end;
A152:now
let n being Nat;
let m being Nat;
assume that
A153: n in ( dom q )
and
A154: m in ( dom q )
and
A155: n < m;
A156: ( q /. m ) = ( q . m ) by A154,PARTFUN1:def 6
.= ( q9 /. m ) by A154,PARTFUN1:def 6;
( q /. n ) = ( q . n ) by A153,PARTFUN1:def 6
.= ( q9 /. n ) by A153,PARTFUN1:def 6;
hence (( q /. n ) <> ( q /. m ) & [ ( q /. n ),( q /. m ) ] in R) by A62,A153,A154,A155,A156;
end;
A157: X[ E ];
(for p being (FinSequence of A9) holds X[ p ]) from FINSEQ_2:sch 2(A157,A65);
hence thesis by A59,A61,A147,A152;
end;
end;
end;
