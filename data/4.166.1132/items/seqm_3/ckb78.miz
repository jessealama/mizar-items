environ
vocabularies NUMBERS,SUBSET_1,XREAL_0,ORDINAL1,SEQ_1,ARYTM_3,NAT_1,CARD_1,FUNCT_1,XXREAL_0,PARTFUN1,ORDINAL2,RELAT_1,TARSKI,VALUED_0,FUNCT_3,ARYTM_1,VALUED_1,XXREAL_2,REAL_1,COMPLEX1,FINSEQ_1,SEQM_3,XBOOLE_0,FINSEQ_3;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XREAL_0,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_3,FINSEQ_1,FINSEQ_3,VALUED_1,SEQ_1,SEQ_2,REAL_1,COMPLEX1,NAT_1,VALUED_0,XXREAL_0,CKB6,CKB7,CKB8,CKB9,CKB14,CKB36,CKB37,CKB38,CKB39,CKB73;
definitions TARSKI,SEQ_2,FUNCT_1,VALUED_0,VALUED_1,CKB6,CKB7,CKB8,CKB9,CKB14,CKB36,CKB37,CKB38,CKB39,CKB73;
theorems FUNCT_1,SEQ_1,SEQ_2,ABSVALUE,NAT_1,FUNCT_2,XREAL_1,XXREAL_0,ORDINAL1,VALUED_0,VALUED_1,RELAT_1,COMPLEX1,INT_1,FINSEQ_1,FINSEQ_3,XBOOLE_1,TARSKI,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB29,CKB30,CKB33,CKB34,CKB36,CKB37,CKB38,CKB39,CKB40,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB69,CKB70,CKB71,CKB72,CKB73,CKB77;
schemes NAT_1;
registrations XBOOLE_0,FUNCT_1,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,VALUED_0,FUNCT_2,VALUED_1,SEQ_2,RFUNCT_1,RELAT_1,NAT_1,FINSEQ_1,CARD_1,CKB27,CKB28,CKB31,CKB32,CKB35,CKB41,CKB68,CKB74,CKB75,CKB76;
constructors PARTFUN1,FUNCT_3,FUNCOP_1,XXREAL_0,REAL_1,NAT_1,COMPLEX1,VALUED_1,SEQ_1,SEQ_2,FINSEQ_1,RECDEF_1,RELSET_1,FINSEQ_3,CKB14;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve v for (FinSequence of ( REAL ));
reserve r for Real;
reserve s for Real;
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve i for (Element of ( NAT ));
reserve j for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
theorem
(((((v <> ( {} ) & ( rng v ) c= ( Seg n )) & ( v . 1 ) = 1) & ( v . ( len v ) ) = n) & (for k holds ((1 <= k & k <= ( ( len v ) - 1 )) implies (for r holds (for s holds ((r = ( v . k ) & s = ( v . ( k + 1 ) )) implies (( abs ( r - s ) ) = 1 or r = s))))))) implies ((for i holds (i in ( Seg n ) implies (ex k st (k in ( dom v ) & ( v . k ) = i)))) & (for m holds (for k holds (for i holds (for r holds ((((((m in ( dom v ) & ( v . m ) = i) & (for j holds ((j in ( dom v ) & ( v . j ) = i) implies j <= m))) & m < k) & k in ( dom v )) & r = ( v . k )) implies i < r)))))))
proof
assume that
A1: v <> ( {} )
and
A2: ( rng v ) c= ( Seg n )
and
A3: ( v . 1 ) = 1
and
A4: ( v . ( len v ) ) = n
and
A5: (for k holds ((1 <= k & k <= ( ( len v ) - 1 )) implies (for r holds (for s holds ((r = ( v . k ) & s = ( v . ( k + 1 ) )) implies (( abs ( r - s ) ) = 1 or r = s))))));
defpred P[ (Element of ( NAT )) ]
 means
($1 in ( Seg n ) implies (ex k st (k in ( dom v ) & ( v . k ) = $1)));
A6: ( ( 0 ) + 1 ) <= ( len v ) by A1,NAT_1:13;
then A7: ( len v ) in ( dom v ) by FINSEQ_3:25;
A8: (for i holds (P[ i ] implies P[ ( i + 1 ) ]))
proof
let i;
assume that
A9: (i in ( Seg n ) implies (ex k st (k in ( dom v ) & ( v . k ) = i)));
assume A10: ( i + 1 ) in ( Seg n );
now
per cases ;
suppose A11: i = ( 0 );

take k = 1;
thus (k in ( dom v ) & ( v . k ) = ( i + 1 )) by A3,A6,A11,FINSEQ_3:25;
end;
suppose A12: i <> ( 0 );

defpred R[ set ]
 means
($1 in ( dom v ) & ( v . $1 ) = i);
A13: (for k being Nat holds (R[ k ] implies k <= ( len v ))) by FINSEQ_3:25;
( i + 1 ) <= n by A10,FINSEQ_1:1;
then A14: i <= n by NAT_1:13;
A15: ( ( 0 ) + 1 ) <= i by A12,NAT_1:13;
then A16: (ex k being Nat st R[ k ]) by A9,A14,FINSEQ_1:1;
consider m being Nat such that A17: (R[ m ] & (for k being Nat holds (R[ k ] implies k <= m))) from NAT_1:sch 6(A13,A16);
A18: (for k holds (R[ k ] implies k <= m)) by A17;
reconsider m as (Element of ( NAT )) by ORDINAL1:def 12;
take k = ( m + 1 );
i in ( Seg n ) by A15,A14,FINSEQ_1:1;
hence (k in ( dom v ) & ( v . k ) = ( i + 1 )) by A1,A2,A4,A5,A10,A17,A18,CKB77:1;
end;
end;
hence thesis;
end;
A19: P[ ( 0 ) ] by FINSEQ_1:1;
thus (for i holds P[ i ]) from NAT_1:sch 1(A19,A8);
let m;
let k;
let i;
let r;
assume that
A20: m in ( dom v )
and
A21: ( v . m ) = i
and
A22: (for j holds ((j in ( dom v ) & ( v . j ) = i) implies j <= m))
and
A23: m < k
and
A24: k in ( dom v )
and
A25: r = ( v . k );
A26: (m <= ( len v ) & k <= ( len v )) by A20,A24,FINSEQ_3:25;
A27: 1 <= m by A20,FINSEQ_3:25;
A28: i in ( rng v ) by A20,A21,FUNCT_1:def 3;
then A29: i <= n by A2,FINSEQ_1:1;
now
per cases ;
suppose i = n;

then ( len v ) <= m by A4,A7,A22;
hence thesis by A23,A26,XXREAL_0:1;
end;
suppose A30: i <> n;

defpred P[ set ]
 means
(for j holds (for s holds ((((j = $1 & j > ( 0 )) & ( m + j ) in ( dom v )) & s = ( v . ( m + j ) )) implies i < s)));
i < n by A29,A30,XXREAL_0:1;
then (1 <= ( i + 1 ) & ( i + 1 ) <= n) by NAT_1:11,NAT_1:13;
then ( i + 1 ) in ( Seg n ) by FINSEQ_1:1;
then A31: ( v . ( m + 1 ) ) = ( i + 1 ) by A1,A2,A4,A5,A20,A21,A22,A28,CKB77:1;
A32: (for k holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k;
assume that
A33: P[ k ];
let j;
let s;
assume that
A34: j = ( k + 1 )
and
A35: j > ( 0 )
and
A36: ( m + j ) in ( dom v )
and
A37: s = ( v . ( m + j ) );
per cases ;
suppose k = ( 0 );

hence thesis by A31,A34,A37,NAT_1:13;
end;
suppose A38: k <> ( 0 );

m <= ( m + k ) by NAT_1:11;
then A39: 1 <= ( m + k ) by A27,XXREAL_0:2;
s in ( rng v ) by A36,A37,FUNCT_1:def 3;
then s in ( Seg n ) by A2;
then reconsider s1 = s as (Element of ( NAT ));
A40: ( m + ( k + 1 ) ) <= ( len v ) by A34,A36,FINSEQ_3:25;
( m + k ) <= ( ( m + k ) + 1 ) by NAT_1:11;
then ( m + k ) <= ( len v ) by A40,XXREAL_0:2;
then A41: ( m + k ) in ( dom v ) by A39,FINSEQ_3:25;
then ( v . ( m + k ) ) in ( rng v ) by FUNCT_1:def 3;
then ( v . ( m + k ) ) in ( Seg n ) by A2;
then reconsider r1 = ( v . ( m + k ) ) as (Element of ( NAT ));
A42: i < r1 by A33,A38,A41;
A43: ( ( m + k ) + 1 ) = ( m + ( k + 1 ) );
then A44: ( m + k ) <= ( ( len v ) - 1 ) by A40,XREAL_1:19;
now
per cases  by A5,A34,A37,A43,A39,A44;
suppose A45: ( abs ( r1 - s ) ) = 1;

now
per cases  by A45,CKB69:1;
suppose (r1 > s & r1 = ( s + 1 ));

then A46: i <= s1 by A42,NAT_1:13;
now
per cases  by A46,XXREAL_0:1;
case i < s;
hence thesis;
end;
case s = i;
then ( m + j ) <= m by A22,A36,A37;
then j <= ( m - m ) by XREAL_1:19;
hence contradiction by A35;
end;
end;
hence thesis;
end;
suppose (r1 < s & s = ( r1 + 1 ));

hence thesis by A42,XXREAL_0:2;
end;
end;
hence thesis;
end;
suppose r1 = s;

hence thesis by A33,A38,A41;
end;
end;
hence thesis;
end;
end;
reconsider l = ( k - m ) as (Element of ( NAT )) by A23,INT_1:5;
A47: (( 0 ) < ( k - m ) & ( m + l ) = k) by A23,XREAL_1:50;
A48: P[ ( 0 ) ];
(for k holds P[ k ]) from NAT_1:sch 1(A48,A32);
hence thesis by A24,A25,A47;
end;
end;
hence thesis;
end;
