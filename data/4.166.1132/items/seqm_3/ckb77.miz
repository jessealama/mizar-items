environ
vocabularies NUMBERS,SUBSET_1,XREAL_0,ORDINAL1,SEQ_1,ARYTM_3,NAT_1,CARD_1,FUNCT_1,XXREAL_0,PARTFUN1,ORDINAL2,RELAT_1,TARSKI,VALUED_0,FUNCT_3,ARYTM_1,VALUED_1,XXREAL_2,REAL_1,COMPLEX1,FINSEQ_1,SEQM_3,XBOOLE_0,FINSEQ_3;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XREAL_0,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_3,FINSEQ_1,FINSEQ_3,VALUED_1,SEQ_1,SEQ_2,REAL_1,COMPLEX1,NAT_1,VALUED_0,XXREAL_0,CKB6,CKB7,CKB8,CKB9,CKB14,CKB36,CKB37,CKB38,CKB39,CKB73;
definitions TARSKI,SEQ_2,FUNCT_1,VALUED_0,VALUED_1,CKB6,CKB7,CKB8,CKB9,CKB14,CKB36,CKB37,CKB38,CKB39,CKB73;
theorems FUNCT_1,SEQ_1,SEQ_2,ABSVALUE,NAT_1,FUNCT_2,XREAL_1,XXREAL_0,ORDINAL1,VALUED_0,VALUED_1,RELAT_1,COMPLEX1,INT_1,FINSEQ_1,FINSEQ_3,XBOOLE_1,TARSKI,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB29,CKB30,CKB33,CKB34,CKB36,CKB37,CKB38,CKB39,CKB40,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB69,CKB70,CKB71,CKB72,CKB73;
schemes NAT_1;
registrations XBOOLE_0,FUNCT_1,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,VALUED_0,FUNCT_2,VALUED_1,SEQ_2,RFUNCT_1,RELAT_1,NAT_1,FINSEQ_1,CARD_1,CKB27,CKB28,CKB31,CKB32,CKB35,CKB41,CKB68,CKB74,CKB75,CKB76;
constructors PARTFUN1,FUNCT_3,FUNCOP_1,XXREAL_0,REAL_1,NAT_1,COMPLEX1,VALUED_1,SEQ_1,SEQ_2,FINSEQ_1,RECDEF_1,RELSET_1,FINSEQ_3,CKB14;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve v for (FinSequence of ( REAL ));
reserve r for Real;
reserve s for Real;
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve i for (Element of ( NAT ));
reserve j for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
theorem
Th85: (((((((((v <> ( {} ) & ( rng v ) c= ( Seg n )) & ( v . ( len v ) ) = n) & (for k holds ((1 <= k & k <= ( ( len v ) - 1 )) implies (for r holds (for s holds ((r = ( v . k ) & s = ( v . ( k + 1 ) )) implies (( abs ( r - s ) ) = 1 or r = s))))))) & i in ( Seg n )) & ( i + 1 ) in ( Seg n )) & m in ( dom v )) & ( v . m ) = i) & (for k holds ((k in ( dom v ) & ( v . k ) = i) implies k <= m))) implies (( m + 1 ) in ( dom v ) & ( v . ( m + 1 ) ) = ( i + 1 )))
proof
assume that
A1: v <> ( {} )
and
A2: ( rng v ) c= ( Seg n )
and
A3: ( v . ( len v ) ) = n
and
A4: (for k holds ((1 <= k & k <= ( ( len v ) - 1 )) implies (for r holds (for s holds ((r = ( v . k ) & s = ( v . ( k + 1 ) )) implies (( abs ( r - s ) ) = 1 or r = s))))))
and
A5: i in ( Seg n )
and
A6: ( i + 1 ) in ( Seg n )
and
A7: m in ( dom v )
and
A8: ( v . m ) = i
and
A9: (for k holds ((k in ( dom v ) & ( v . k ) = i) implies k <= m));
A10: m <= ( len v ) by A7,FINSEQ_3:25;
( ( 0 ) + 1 ) <= ( len v ) by A1,NAT_1:13;
then A11: ( len v ) in ( dom v ) by FINSEQ_3:25;
reconsider r = ( v . ( m + 1 ) ) as Real;
A12: i <= n by A5,FINSEQ_1:1;
A13: 1 <= m by A7,FINSEQ_3:25;
A14: ( i + 1 ) <= n by A6,FINSEQ_1:1;
A15:now
assume (not ( m + 1 ) in ( dom v ));
then (1 > ( m + 1 ) or ( m + 1 ) > ( len v )) by FINSEQ_3:25;
then A16: ( len v ) <= m by NAT_1:11,NAT_1:13;
i < n by A14,NAT_1:13;
hence contradiction by A3,A8,A10,A16,XXREAL_0:1;
end;
then A17: ( m + 1 ) <= ( len v ) by FINSEQ_3:25;
then A18: m < ( len v ) by NAT_1:13;
A19: m <= ( ( len v ) - 1 ) by A17,XREAL_1:19;
now
per cases  by A4,A8,A13,A19;
case A20: ( abs ( i - r ) ) = 1;
now
per cases  by A20,CKB69:1;
case A21: (i > r & i = ( r + 1 ));
defpred P[ set ]
 means
(for k holds (for r holds ((((k = $1 & k > ( 0 )) & ( m + k ) in ( dom v )) & r = ( v . ( m + k ) )) implies r < i)));
A22: (for k holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k;
assume that
A23: P[ k ];
let j;
let s;
assume that
A24: j = ( k + 1 )
and
A25: j > ( 0 )
and
A26: ( m + j ) in ( dom v )
and
A27: s = ( v . ( m + j ) );
now
per cases ;
suppose k = ( 0 );

hence thesis by A21,A24,A27;
end;
suppose A28: k <> ( 0 );

A29: ( m + k ) <= ( ( m + k ) + 1 ) by NAT_1:11;
m <= ( m + k ) by NAT_1:11;
then A30: 1 <= ( m + k ) by A13,XXREAL_0:2;
A31: ( m + ( k + 1 ) ) <= ( len v ) by A24,A26,FINSEQ_3:25;
then ( m + k ) <= ( len v ) by A29,XXREAL_0:2;
then A32: ( m + k ) in ( dom v ) by A30,FINSEQ_3:25;
then ( v . ( m + k ) ) in ( rng v ) by FUNCT_1:def 3;
then ( v . ( m + k ) ) in ( Seg n ) by A2;
then reconsider r1 = ( v . ( m + k ) ) as (Element of ( NAT ));
A33: r1 < i by A23,A28,A32;
A34: ( m + k ) <= ( ( len v ) - 1 ) by A29,A31,XREAL_1:19;
now
per cases  by A4,A24,A27,A29,A30,A34;
suppose A35: ( abs ( r1 - s ) ) = 1;

now
per cases  by A35,CKB69:1;
suppose (r1 > s & r1 = ( s + 1 ));

hence thesis by A33,XXREAL_0:2;
end;
suppose (r1 < s & s = ( r1 + 1 ));

then A36: s <= i by A33,NAT_1:13;
now
per cases  by A36,XXREAL_0:1;
case s < i;
hence thesis;
end;
case s = i;
then ( m + j ) <= m by A9,A26,A27;
then j <= ( m - m ) by XREAL_1:19;
hence contradiction by A25;
end;
end;
hence thesis;
end;
end;
hence thesis;
end;
suppose r1 = s;

hence thesis by A23,A28,A32;
end;
end;
hence thesis;
end;
end;
hence thesis;
end;
reconsider l = ( ( len v ) - m ) as (Element of ( NAT )) by A18,INT_1:5;
A37: (( 0 ) < ( ( len v ) - m ) & ( m + l ) = ( len v )) by A17,XREAL_1:19;
A38: P[ ( 0 ) ];
(for k holds P[ k ]) from NAT_1:sch 1(A38,A22);
hence contradiction by A3,A11,A12,A37;
end;
case (i < r & r = ( i + 1 ));
hence thesis by A15;
end;
end;
hence thesis;
end;
case i = r;
then ( m + 1 ) <= m by A9,A15;
then 1 <= ( m - m ) by XREAL_1:19;
then 1 <= ( 0 );
hence contradiction;
end;
end;
hence thesis;
end;
