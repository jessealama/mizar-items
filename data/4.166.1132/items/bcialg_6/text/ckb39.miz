environ
vocabularies NUMBERS,BCIALG_1,SUBSET_1,INT_1,FUNCT_1,NAT_1,XBOOLE_0,ZFMISC_1,STRUCT_0,CARD_1,SUPINF_2,ARYTM_3,RELAT_1,NEWTON,COMPLEX1,XXREAL_0,WAYBEL15,ARYTM_1,GROUP_1,INT_2,UNIALG_2,CARD_FIL,RCOMP_1,BCIALG_2,REALSET1,MSSUBFAM,FUNCOP_1,MOD_4,GROUP_6,TARSKI,FUNCT_2,CHORD,WELLORD1,EQREL_1,ALG_1,CARD_3,BINOP_1,BCIALG_6;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,REALSET1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,BINOP_1,STRUCT_0,BCIALG_1,FUNCOP_1,NAT_1,NUMBERS,INT_2,XXREAL_0,BINOP_2,NAT_D,INT_1,BCIALG_2,EQREL_1,CKB1,CKB2,CKB3,CKB4,CKB32,CKB34;
definitions TARSKI,REALSET1,BINOP_1,STRUCT_0,BCIALG_1,FUNCT_1,BCIALG_2,XBOOLE_0,CKB2,CKB3,CKB4,CKB32,CKB34;
theorems TARSKI,FUNCT_1,FUNCT_2,FUNCOP_1,BINOP_1,ZFMISC_1,RELAT_1,XBOOLE_0,XBOOLE_1,BCIALG_1,GROUP_6,BCIALG_2,EQREL_1,RELSET_1,ABSVALUE,ORDINAL1,NAT_D,XREAL_1,INT_1,XCMPLX_1,INT_2,NAT_1,NEWTON,XXREAL_0,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38;
schemes BINOP_1,FUNCT_2,NAT_1,INT_1,CLASSES1;
registrations XBOOLE_0,RELSET_1,REALSET1,STRUCT_0,BCIALG_1,BCIALG_2,FUNCT_2,PARTFUN1,NAT_1,XREAL_0,ORDINAL1,XXREAL_0,INT_1;
constructors BINOP_1,REALSET1,BCIALG_2,REAL_1,BINOP_2,FINSEQOP,SUPINF_1,SEQ_1,NAT_D,RELSET_1,CKB1,CKB2,CKB3,CKB32,CKB34;
requirements BOOLE,SUBSET,NUMERALS,ARITHM,REAL;
begin
reserve X for BCI-algebra;
reserve x for (Element of X);
reserve m for Nat;
reserve n for Nat;
reserve i for Integer;
theorem
((((x is  finite-period & ( x |^ m ) is  finite-period) & ( ord x ) = n) & m > ( 0 )) implies ( ord ( x |^ m ) ) = ( n div ( m gcd n ) ))
proof
assume that
A1: x is  finite-period
and
A2: ( x |^ m ) is  finite-period
and
A3: ( ord x ) = n
and
A4: m > ( 0 );
reconsider b = ( ( x ` ) ` ) as (Element of ( AtomSet X )) by BCIALG_1:34;
A5: b is  finite-period by A1,CKB33:1;
( b \ x ) = ( 0. X ) by BCIALG_1:1;
then b <= x by BCIALG_1:def 11;
then x in ( BranchV b );
then A6: n = ( ord b ) by A1,A3,A5,CKB37:1;
then ( b |^ n ) in ( BCK-part X ) by A5,CKB34:def 1;
then A7: (ex z being (Element of X) st (z = ( b |^ n ) & ( 0. X ) <= z));
reconsider mgn = ( m gcd n ) as (Element of ( NAT ));
( m gcd n ) divides n by INT_2:21;
then consider vn being Nat such that A8: n = ( mgn * vn ) by NAT_D:def 3;
reconsider vn as (Element of ( NAT )) by ORDINAL1:def 12;
( m gcd n ) divides m by INT_2:21;
then consider i being Nat such that A9: m = ( mgn * i ) by NAT_D:def 3;
reconsider i as (Element of ( NAT )) by ORDINAL1:def 12;
A10: n = ( ( mgn * vn ) + ( 0 ) ) by A8;
A11: vn,i are_relative_prime 
proof
( i gcd vn ) divides i by NAT_D:def 5;
then consider b2 being Nat such that A12: i = ( ( i gcd vn ) * b2 ) by NAT_D:def 3;
m = ( ( ( m gcd n ) * ( i gcd vn ) ) * b2 ) by A9,A12;
then A13: ( ( m gcd n ) * ( i gcd vn ) ) divides m by NAT_D:def 3;
( i gcd vn ) divides vn by NAT_D:def 5;
then consider b1 being Nat such that A14: vn = ( ( i gcd vn ) * b1 ) by NAT_D:def 3;
n = ( ( ( m gcd n ) * ( i gcd vn ) ) * b1 ) by A8,A14;
then ( ( m gcd n ) * ( i gcd vn ) ) divides n by NAT_D:def 3;
then ( ( m gcd n ) * ( i gcd vn ) ) divides ( m gcd n ) by A13,NAT_D:def 5;
then consider c being Nat such that A15: ( m gcd n ) = ( ( ( m gcd n ) * ( i gcd vn ) ) * c ) by NAT_D:def 3;
A16: ( m gcd n ) <> ( 0 ) by A4,INT_2:5;
( ( m gcd n ) * 1 ) = ( ( m gcd n ) * ( ( i gcd vn ) * c ) ) by A15;
then 1 = ( i gcd vn ) by A16,NAT_1:15,XCMPLX_1:5;
hence thesis by INT_2:def 3;
end;
A17: (for mm being (Element of ( NAT )) holds ((( ( x |^ m ) |^ mm ) in ( BCK-part X ) & mm <> ( 0 )) implies vn <= mm))
proof
let mm being (Element of ( NAT ));
assume that
A18: ( ( x |^ m ) |^ mm ) in ( BCK-part X )
and
A19: mm <> ( 0 );
(ex z being (Element of X) st (z = ( ( x |^ m ) |^ mm ) & ( 0. X ) <= z)) by A18;
then ( ( ( x |^ m ) |^ mm ) ` ) = ( 0. X ) by BCIALG_1:def 11;
then ( ( ( x |^ m ) ` ) |^ mm ) = ( 0. X ) by CKB24:1;
then ( ( ( b |^ m ) ` ) |^ mm ) = ( 0. X ) by CKB27:1;
then ( ( ( b |^ m ) |^ mm ) ` ) = ( 0. X ) by CKB24:1;
then ( ( b |^ ( m * mm ) ) ` ) = ( 0. X ) by CKB30:1;
then ( 0. X ) <= ( b |^ ( m * mm ) ) by BCIALG_1:def 11;
then ( b |^ ( m * mm ) ) in ( BCK-part X );
then ( mgn * vn ) divides ( ( mgn * i ) * mm ) by A8,A9,A5,A6,CKB38:1;
then consider c being Nat such that A20: ( ( mgn * i ) * mm ) = ( ( mgn * vn ) * c ) by NAT_D:def 3;
A21: mgn <> ( 0 ) by A4,INT_2:5;
( mgn * ( i * mm ) ) = ( mgn * ( vn * c ) ) by A20;
then ( i * mm ) = ( vn * c ) by A21,XCMPLX_1:5;
then vn divides ( i * mm ) by NAT_D:def 3;
then vn divides mm by A11,INT_2:25;
then consider cc being Nat such that A22: mm = ( vn * cc ) by NAT_D:def 3;
cc <> ( 0 ) by A19,A22;
hence thesis by A22,NAT_1:24;
end;
( ( ( x |^ m ) |^ vn ) ` ) = ( ( ( x |^ m ) ` ) |^ vn ) by CKB24:1
.= ( ( ( b |^ m ) ` ) |^ vn ) by CKB27:1
.= ( ( ( b |^ m ) |^ vn ) ` ) by CKB24:1
.= ( ( b |^ ( ( mgn * i ) * vn ) ) ` ) by A9,CKB30:1
.= ( ( b |^ ( n * i ) ) ` ) by A8
.= ( ( ( b |^ n ) |^ i ) ` ) by CKB30:1
.= ( ( ( b |^ n ) ` ) |^ i ) by CKB24:1
.= ( ( 0. X ) |^ i ) by A7,BCIALG_1:def 11
.= ( 0. X ) by CKB11:1;
then ( 0. X ) <= ( ( x |^ m ) |^ vn ) by BCIALG_1:def 11;
then A23: ( ( x |^ m ) |^ vn ) in ( BCK-part X );
( n gcd m ) > ( 0 ) by A4,NEWTON:58;
then A24: ( n div mgn ) = vn by A10,NAT_D:def 1;
vn <> ( 0 ) by A1,A3,A8,CKB34:def 1;
hence thesis by A2,A24,A23,A17,CKB34:def 1;
end;
