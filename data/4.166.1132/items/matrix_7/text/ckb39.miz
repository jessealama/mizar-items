environ
vocabularies NUMBERS,NAT_1,FUNCT_2,FINSEQ_1,RELAT_1,FUNCT_1,TARSKI,MATRIX_2,FINSEQ_2,XBOOLE_0,SUBSET_1,XXREAL_0,ARYTM_3,JORDAN3,ORDINAL4,ARYTM_1,CARD_1,STRUCT_0,INT_1,CARD_3,GROUP_1,VECTSP_1,MATRIX_1,MATRIX_3,ALGSTR_0,SETWISEO,FINSUB_1,BINOP_1,FINSOP_1,ABIAN,TREES_1,SUPINF_2,FUNCOP_1,MESFUNC1,ZFMISC_1,QC_LANG1,PARTFUN1,FINSEQ_5,CLASSES1,RFINSEQ,MATRIX_7;
notations TARSKI,XBOOLE_0,SUBSET_1,XCMPLX_0,XXREAL_0,NAT_1,NAT_D,RELAT_1,FUNCT_1,BINOP_1,ZFMISC_1,CARD_1,NUMBERS,VECTSP_1,FUNCT_2,FUNCOP_1,SETWISEO,PARTFUN1,GROUP_4,FINSUB_1,NEWTON,FINSOP_1,SETWOP_2,FINSEQ_1,STRUCT_0,ALGSTR_0,MATRIX_2,MATRIX_3,FINSEQ_6,MATRIX_1,CLASSES1,RFINSEQ,FINSEQ_5,GROUP_1,CKB14,CKB18,CKB20,CKB23,CKB25,CKB27;
definitions TARSKI,XBOOLE_0,BINOP_1,FINSEQ_1,MATRIX_1,FINSEQ_2,GROUP_4,ALGSTR_0,RELAT_1,CKB18,CKB20,CKB25,CKB27;
theorems BINOP_1,RLVECT_1,MATRIX_3,VECTSP_1,MATRIX_1,GROUP_1,FUNCT_1,FINSEQ_1,NAT_1,MATRIX_2,FINSEQ_2,TARSKI,FINSOP_1,FVSUM_1,SETWISEO,FUNCT_2,XBOOLE_0,GROUP_4,ENUMSET1,ZFMISC_1,FINSEQ_6,XREAL_1,FINSEQ_5,INTEGRA2,FUNCOP_1,FINSUB_1,XBOOLE_1,RELAT_1,SUBSET_1,RFINSEQ,FINSEQ_3,XXREAL_0,ORDINAL1,NAT_D,PARTFUN1,XREAL_0,CLASSES1,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38;
schemes NAT_1,FUNCT_2,FINSEQ_1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,PARTFUN1,FUNCT_2,FINSUB_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,STRUCT_0,GROUP_1,VECTSP_1,MATRIX_2,FVSUM_1,FINSET_1,CARD_1,RELSET_1,FINSEQ_2;
constructors RELAT_2,PARTFUN1,SETWISEO,REAL_1,SQUARE_1,NAT_1,NAT_D,FINSOP_1,NEWTON,RFINSEQ,BINARITH,FINSEQ_5,ALGSTR_1,GROUP_4,MATRIX_3,FINSEQ_6,CLASSES1,RELSET_1,BINOP_1,CKB14,CKB18,CKB20,CKB23,CKB25,CKB27;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
reserve n for Nat;
theorem
Th31: (for K being Field holds (for R1,R2 being (FinSequence of K) holds (R1,R2 are_fiberwise_equipotent  implies ( (the multF of K) $$ R1 ) = ( (the multF of K) $$ R2 ))))
proof
let K being Field;
defpred P[ Nat ]
 means
(for f,g being (FinSequence of K) holds ((f,g are_fiberwise_equipotent  & ( len f ) = $1) implies ( (the multF of K) $$ f ) = ( (the multF of K) $$ g )));
let R1 being (FinSequence of K),R2 being (FinSequence of K);
assume A1: R1,R2 are_fiberwise_equipotent ;
A2: ( len R1 ) = ( len R1 );
A3: (for n holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
let n;
assume A4: P[ n ];
reconsider n1 = n as (Element of ( NAT )) by ORDINAL1:def 12;
let f being (FinSequence of K),g being (FinSequence of K);
assume that
A5: f,g are_fiberwise_equipotent 
and
A6: ( len f ) = ( n + 1 );
A7: ( rng f ) c= (the carrier of K) by FINSEQ_1:def 4;
( ( 0 ) + 1 ) <= ( n + 1 ) by NAT_1:13;
then A8: ( n + 1 ) in ( dom f ) by A6,FINSEQ_3:25;
then ( f . ( n + 1 ) ) in ( rng f ) by FUNCT_1:def 3;
then reconsider a = ( f . ( n + 1 ) ) as (Element of K) by A7;
( rng f ) = ( rng g ) by A5,CLASSES1:75;
then a in ( rng g ) by A8,FUNCT_1:def 3;
then consider m being Nat such that A9: m in ( dom g ) and A10: ( g . m ) = a by FINSEQ_2:10;
A11: g = ( ( g | m ) ^ ( g /^ m ) ) by RFINSEQ:8;
set gg = ( g /^ m );
set gm = ( g | m );
A12: 1 <= m by A9,FINSEQ_3:25;
then ( max (( 0 ),( m - 1 )) ) = ( m - 1 ) by FINSEQ_2:4;
then reconsider m1 = ( m - 1 ) as (Element of ( NAT )) by FINSEQ_2:5;
m in ( NAT ) by ORDINAL1:def 12;
then m in ( Seg m ) by A12;
then A13: ( gm . m ) = a by A9,A10,RFINSEQ:6;
A14: m = ( m1 + 1 );
then m1 <= m by NAT_1:11;
then A15: ( Seg m1 ) c= ( Seg m ) by FINSEQ_1:5;
m <= ( len g ) by A9,FINSEQ_3:25;
then ( len gm ) = m by FINSEQ_1:59;
then A16: gm = ( ( gm | m1 ) ^ <* a *> ) by A14,A13,RFINSEQ:7;
set fn = ( f | n1 );
A17: f = ( fn ^ <* a *> ) by A6,RFINSEQ:7;
A18: ( gm | m1 ) = ( g | ( ( Seg m ) /\ ( Seg m1 ) ) ) by RELAT_1:71
.= ( g | m1 ) by A15,XBOOLE_1:28;
now
let x being set;
( card ( Coim (f,x) ) ) = ( card ( Coim (g,x) ) ) by A5,CLASSES1:def 9;
then ( ( card ( fn " { x } ) ) + ( card ( <* a *> " { x } ) ) ) = ( card ( ( ( ( g | m1 ) ^ <* a *> ) ^ ( g /^ m ) ) " { x } ) ) by A11,A16,A18,A17,FINSEQ_3:57
.= ( ( card ( ( ( g | m1 ) ^ <* a *> ) " { x } ) ) + ( card ( ( g /^ m ) " { x } ) ) ) by FINSEQ_3:57
.= ( ( ( card ( ( g | m1 ) " { x } ) ) + ( card ( <* a *> " { x } ) ) ) + ( card ( ( g /^ m ) " { x } ) ) ) by FINSEQ_3:57
.= ( ( ( card ( ( g | m1 ) " { x } ) ) + ( card ( ( g /^ m ) " { x } ) ) ) + ( card ( <* a *> " { x } ) ) )
.= ( ( card ( ( ( g | m1 ) ^ ( g /^ m ) ) " { x } ) ) + ( card ( <* a *> " { x } ) ) ) by FINSEQ_3:57;
hence ( card ( Coim (fn,x) ) ) = ( card ( Coim (( ( g | m1 ) ^ ( g /^ m ) ),x) ) );
end;
then A19: fn,( ( g | m1 ) ^ ( g /^ m ) ) are_fiberwise_equipotent  by CLASSES1:def 9;
( len fn ) = n by A6,FINSEQ_1:59,NAT_1:11;
then ( (the multF of K) $$ fn ) = ( (the multF of K) $$ ( ( g | m1 ) ^ gg ) ) by A4,A19;
hence ( (the multF of K) $$ f ) = ( ( (the multF of K) $$ ( ( g | m1 ) ^ gg ) ) * ( (the multF of K) $$ <* a *> ) ) by A17,FINSOP_1:5
.= ( ( ( (the multF of K) $$ ( g | m1 ) ) * ( (the multF of K) $$ gg ) ) * ( (the multF of K) $$ <* a *> ) ) by FINSOP_1:5
.= ( ( ( (the multF of K) $$ ( g | m1 ) ) * ( (the multF of K) $$ <* a *> ) ) * ( (the multF of K) $$ gg ) ) by GROUP_1:def 3
.= ( ( (the multF of K) $$ gm ) * ( (the multF of K) $$ gg ) ) by A16,A18,FINSOP_1:5
.= ( (the multF of K) $$ g ) by A11,FINSOP_1:5;
end;
A20: P[ ( 0 ) ]
proof
let f being (FinSequence of K),g being (FinSequence of K);
assume (f,g are_fiberwise_equipotent  & ( len f ) = ( 0 ));
then A21: (( len g ) = ( 0 ) & f = ( <*> (the carrier of K) )) by RFINSEQ:3;
then g = ( <*> (the carrier of K) );
hence thesis by A21;
end;
(for n holds P[ n ]) from NAT_1:sch 2(A20,A3);
hence thesis by A1,A2;
end;
