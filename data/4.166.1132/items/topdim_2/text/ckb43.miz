environ
vocabularies NUMBERS,NAT_1,SETFAM_1,TREES_2,TARSKI,CARD_1,XBOOLE_0,FINSET_1,PEPIN,XXREAL_0,ORDINAL1,ARYTM_3,ARYTM_1,SUBSET_1,FUNCT_1,RELAT_1,INT_1,PCOMPS_1,PRE_TOPC,TOPDIM_1,WAYBEL23,RCOMP_1,PROB_1,TOPGEN_4,CARD_3,ZFMISC_1,STRUCT_0,RLVECT_3,TOPS_1,MCART_1,METRIZTS,EUCLID,XREAL_0,REAL_1,FINSEQ_1,METRIC_1,FINSEQ_2,RVSUM_1,SQUARE_1,COMPLEX1,RELAT_2,CONNSP_1,T_0TOPSP,FUNCOP_1,FUNCT_4,CARD_2;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,RELSET_1,MCART_1,ZFMISC_1,FUNCT_2,CARD_1,CANTOR_1,COMPLEX1,FINSET_1,ORDINAL1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,XXREAL_3,NAT_1,INT_1,SETFAM_1,DOMAIN_1,FUNCOP_1,TOPS_2,STRUCT_0,PRE_TOPC,METRIC_1,PCOMPS_1,CARD_3,PROB_1,KURATO_2,WAYBEL23,TOPS_1,T_0TOPSP,CARD_2,RVSUM_1,FINSEQ_1,FINSEQ_2,EUCLID,BORSUK_1,TOPGEN_4,FUNCT_4,SQUARE_1,CONNSP_1,TOPREAL9,ORDERS_4,METRIZTS,TOPDIM_1,CKB1,CKB4;
definitions STRUCT_0,SQUARE_1,EUCLID,PCOMPS_1,TOPS_1,TARSKI,METRIC_1,XBOOLE_0,TOPS_2,SETFAM_1,SUBSET_1,CARD_3,TOPDIM_1,CKB1,CKB4;
theorems ABSVALUE,FINSEQ_1,FINSEQ_2,FUNCT_1,FUNCT_2,RVSUM_1,TARSKI,XREAL_0,COMPLEX1,XREAL_1,XXREAL_0,FUNCOP_1,ORDINAL1,RELAT_1,PRE_TOPC,TOPMETR,EUCLID,METRIC_1,XBOOLE_0,TOPS_1,TOPS_2,TOPREAL7,PROB_1,ZFMISC_1,NAT_1,KURATO_2,INT_1,TOPGEN_1,XBOOLE_1,MCART_1,CARD_1,TOPGEN_4,SUBSET_1,TSEP_1,TSP_1,SETFAM_1,CARD_4,YELLOW_9,ORDERS_4,BORSUK_1,CARD_3,CARD_2,NECKLACE,BORSUK_3,TOPALG_3,JORDAN2C,TOPREAL9,JORDAN2B,JORDAN,STIRL2_1,FUNCT_4,ENUMSET1,XXREAL_3,CONNSP_1,WELLORD2,METRIZTS,PCOMPS_1,TOPDIM_1,YELLOW14,CKB1,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB20,CKB21,CKB22,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB35,CKB36,CKB37,CKB39,CKB40,CKB41,CKB42;
schemes FUNCT_2,NAT_1,CLASSES1,LMOD_7,BORSUK_2;
registrations REALSET1,PRE_TOPC,PCOMPS_1,NAT_1,XREAL_0,SUBSET_1,STRUCT_0,TOPS_1,XXREAL_0,YELLOW13,CARD_1,XBOOLE_0,FINSET_1,VALUED_0,RELAT_1,FUNCT_1,INT_1,CARD_3,TOPGEN_4,BORSUK_3,MEMBERED,XXREAL_3,METRIZTS,TOPDIM_1,EUCLID,ZFMISC_1,RELSET_1,CKB2,CKB3,CKB5,CKB6,CKB19,CKB23,CKB34,CKB38;
constructors TOPS_2,BORSUK_1,REAL_1,COMPLEX1,CANTOR_1,TOPGEN_4,WAYBEL23,TOPS_1,SQUARE_1,RVSUM_1,BORSUK_3,CARD_2,TSP_1,CONNSP_1,BINOP_2,TOPREAL9,ORDERS_4,XXREAL_3,METRIZTS,TOPDIM_1,FUNCOP_1,FUNCSDOM,PCOMPS_1,CKB1,CKB4;
requirements REAL,SUBSET,NUMERALS,ARITHM,BOOLE;
begin
reserve n for Nat;
reserve TM for  metrizable TopSpace;
reserve F for  finite (Subset-Family of TM);
reserve G for  finite (Subset-Family of TM);
theorem
(for TM holds ((TM is  second-countable  finite-ind & ( ind TM ) <= n) implies (for F holds ((F is  open & F is (Cover of TM)) implies (ex G st ((((G is  open & G is (Cover of TM)) & G is_finer_than F) & ( card G ) <= ( ( card F ) * ( n + 1 ) )) & ( order G ) <= n))))))
proof
let TM;
assume that
A1: TM is  second-countable  finite-ind
and
A2: ( ind TM ) <= n;
reconsider I = n as Integer;
consider G being  finite (Subset-Family of TM) such that A3: G is (Cover of TM) and A4: (G is  finite-ind & ( ind G ) <= ( 0 )) and A5: ( card G ) <= ( I + 1 ) and (for a,b being (Subset of TM) holds (((a in G & b in G) & a meets b) implies a = b)) by A1,A2,CKB16:1;
set cTM = (the carrier of TM);
let F being  finite (Subset-Family of TM);
assume that
A6: F is  open
and
A7: F is (Cover of TM);
( card ( ( n + 1 ) * ( card F ) ) ) = ( card ( card ( ( n + 1 ) * ( card F ) ) ) );
then A8: ( card ( ( n + 1 ) * ( card F ) ) ) = ( ( n + 1 ) * ( card F ) ) by CARD_1:40;
defpred P[ set,set ]
 means
(for A being (Subset of TM) holds (A = $1 implies (ex g being (Function of F,( bool cTM )) st (((($2 = ( rng g ) & ( rng g ) is  open) & ( rng g ) is (Cover of A)) & (for a being set holds (a in F implies ( g . a ) c= a))) & (for a,b being set holds (((a in F & b in F) & a <> b) implies ( g . a ) misses ( g . b )))))));
A9: (for x being set holds (x in G implies (ex y being set st (y in ( bool ( bool cTM ) ) & P[ x,y ]))))
proof
let x being set;
assume A10: x in G;
then reconsider A = x as (Subset of TM);
A11: ( TM | A ) is  second-countable by A1;
( [#] TM ) c= ( union F ) by A7,SETFAM_1:def 11;
then A c= ( union F ) by XBOOLE_1:1;
then A12: F is (Cover of A) by SETFAM_1:def 11;
(A is  finite-ind & ( ind A ) <= ( 0 )) by A4,A10,TOPDIM_1:11;
then consider g being (Function of F,( bool (the carrier of TM) )) such that A13: ((( rng g ) is  open & ( rng g ) is (Cover of A)) & ((for a being set holds (a in F implies ( g . a ) c= a)) & (for a,b being set holds (((a in F & b in F) & a <> b) implies ( g . a ) misses ( g . b ))))) by A6,A11,A12,CKB42:1;
take ( rng g );
thus thesis by A13;
end;
consider GG being (Function of G,( bool ( bool cTM ) )) such that A14: (for x being set holds (x in G implies P[ x,( GG . x ) ])) from FUNCT_2:sch 1(A9);
( union ( rng GG ) ) c= ( union ( bool ( bool cTM ) ) ) by ZFMISC_1:77;
then reconsider Ugg = ( Union GG ) as (Subset-Family of TM);
A15: ( dom GG ) = G by FUNCT_2:def 1;
A16: (for x being set holds (x in ( dom GG ) implies ( card ( GG . x ) ) c= ( card F )))
proof
let x being set;
assume A17: x in ( dom GG );
then reconsider A = x as (Subset of TM) by A15;
consider g being (Function of F,( bool cTM )) such that A18: ( GG . x ) = ( rng g ) and ( rng g ) is  open and ( rng g ) is (Cover of A) and (for a being set holds (a in F implies ( g . a ) c= a)) and (for a,b being set holds (((a in F & b in F) & a <> b) implies ( g . a ) misses ( g . b ))) by A14,A17;
( dom g ) = F by FUNCT_2:def 1;
hence thesis by A18,CARD_1:12;
end;
( card ( dom GG ) ) c= ( n + 1 ) by A5,A15,NAT_1:39;
then A19: ( card Ugg ) c= ( ( n + 1 ) *` ( card F ) ) by A16,CARD_2:86;
( card ( card ( n + 1 ) ) ) = ( card ( n + 1 ) );
then (( card ( card F ) ) = ( card F ) & ( card ( n + 1 ) ) = ( n + 1 )) by CARD_1:40;
then A20: ( ( n + 1 ) *` ( card F ) ) = ( ( n + 1 ) * ( card F ) ) by A8,CARD_2:39;
then reconsider Ugg as  finite (Subset-Family of TM) by A19;
take Ugg;
thus Ugg is  open
proof
let A being (Subset of TM);
assume A in Ugg;
then consider Y being set such that A21: A in Y and A22: Y in ( rng GG ) by TARSKI:def 4;
consider x being set such that A23: (x in ( dom GG ) & Y = ( GG . x )) by A22,FUNCT_1:def 3;
(ex g being (Function of F,( bool cTM )) st ((((Y = ( rng g ) & ( rng g ) is  open) & ( rng g ) is (Cover of x)) & (for a being set holds (a in F implies ( g . a ) c= a))) & (for a,b being set holds (((a in F & b in F) & a <> b) implies ( g . a ) misses ( g . b ))))) by A14,A15,A23;
hence thesis by A21,TOPS_2:def 1;
end;

( [#] TM ) c= ( union Ugg )
proof
A24: ( [#] TM ) c= ( union G ) by A3,SETFAM_1:def 11;
let x being set;
assume that
A25: x in ( [#] TM );
consider A being set such that A26: x in A and A27: A in G by A24,A25,TARSKI:def 4;
consider g being (Function of F,( bool cTM )) such that A28: ( GG . A ) = ( rng g ) and ( rng g ) is  open and A29: ( rng g ) is (Cover of A) and (for a being set holds (a in F implies ( g . a ) c= a)) and (for a,b being set holds (((a in F & b in F) & a <> b) implies ( g . a ) misses ( g . b ))) by A14,A27;
A c= ( union ( rng g ) ) by A29,SETFAM_1:def 11;
then consider y being set such that A30: x in y and A31: y in ( rng g ) by A26,TARSKI:def 4;
( GG . A ) in ( rng GG ) by A15,A27,FUNCT_1:def 3;
then y in Ugg by A28,A31,TARSKI:def 4;
hence thesis by A30,TARSKI:def 4;
end;
hence Ugg is (Cover of TM) by SETFAM_1:def 11;
thus Ugg is_finer_than F
proof
let A being set;
assume A in Ugg;
then consider Y being set such that A32: A in Y and A33: Y in ( rng GG ) by TARSKI:def 4;
consider x being set such that A34: (x in ( dom GG ) & Y = ( GG . x )) by A33,FUNCT_1:def 3;
consider g being (Function of F,( bool cTM )) such that A35: Y = ( rng g ) and ( rng g ) is  open and ( rng g ) is (Cover of x) and A36: (for a being set holds (a in F implies ( g . a ) c= a)) and (for a,b being set holds (((a in F & b in F) & a <> b) implies ( g . a ) misses ( g . b ))) by A14,A15,A34;
( dom g ) = F by FUNCT_2:def 1;
then (ex z being set st (z in F & ( g . z ) = A)) by A32,A35,FUNCT_1:def 3;
hence thesis by A36;
end;

thus ( card Ugg ) <= ( ( card F ) * ( n + 1 ) ) by A19,A20,NAT_1:39;
defpred Q[ set,set ]
 means
$1 in ( GG . $2 );
now
let H being  finite (Subset-Family of TM);
assume that
A37: H c= Ugg
and
A38: ( card H ) > ( n + 1 );
H is non empty by A38;
then consider XX being set such that A39: XX in H by XBOOLE_0:def 1;
A40: (for x being set holds (x in H implies (ex y being set st (y in G & Q[ x,y ]))))
proof
let A being set;
assume A in H;
then consider Y being set such that A41: A in Y and A42: Y in ( rng GG ) by A37,TARSKI:def 4;
(ex x being set st (x in ( dom GG ) & Y = ( GG . x ))) by A42,FUNCT_1:def 3;
hence thesis by A41;
end;
consider q being (Function of H,G) such that A43: (for x being set holds (x in H implies Q[ x,( q . x ) ])) from FUNCT_2:sch 1(A40);
(ex y being set st (y in G & Q[ XX,y ])) by A40,A39;
then A44: ( dom q ) = H by FUNCT_2:def 1;
assume ( meet H ) is non empty;
then consider x being set such that A45: x in ( meet H ) by XBOOLE_0:def 1;
(for x1,x2 being set holds (((x1 in ( dom q ) & x2 in ( dom q )) & ( q . x1 ) = ( q . x2 )) implies x1 = x2))
proof
let x1 being set,x2 being set;
assume that
A46: x1 in ( dom q )
and
A47: x2 in ( dom q )
and
A48: ( q . x1 ) = ( q . x2 );
(x in x1 & x in x2) by A45,A46,A47,SETFAM_1:def 1;
then A49: x1 meets x2 by XBOOLE_0:3;
( q . x1 ) in ( rng q ) by A46,FUNCT_1:def 3;
then ( q . x1 ) in G;
then consider g being (Function of F,( bool cTM )) such that A50: ( GG . ( q . x1 ) ) = ( rng g ) and ( rng g ) is  open and ( rng g ) is (Cover of ( q . x1 )) and (for a being set holds (a in F implies ( g . a ) c= a)) and A51: (for a,b being set holds (((a in F & b in F) & a <> b) implies ( g . a ) misses ( g . b ))) by A14;
A52: ( dom g ) = F by FUNCT_2:def 1;
x2 in ( GG . ( q . x1 ) ) by A43,A47,A48;
then A53: (ex y2 being set st (y2 in F & x2 = ( g . y2 ))) by A50,A52,FUNCT_1:def 3;
x1 in ( GG . ( q . x1 ) ) by A43,A46;
then (ex y1 being set st (y1 in F & x1 = ( g . y1 ))) by A50,A52,FUNCT_1:def 3;
hence thesis by A49,A51,A53;
end;
then A54: q is  one-to-one by FUNCT_1:def 4;
( rng q ) c= G;
then ( card H ) c= ( card G ) by A54,A44,CARD_1:10;
then ( card H ) <= ( card G ) by NAT_1:39;
hence contradiction by A5,A38,XXREAL_0:2;
end;
hence thesis by CKB9:1;
end;
