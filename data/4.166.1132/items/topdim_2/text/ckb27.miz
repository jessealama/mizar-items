environ
vocabularies NUMBERS,NAT_1,SETFAM_1,TREES_2,TARSKI,CARD_1,XBOOLE_0,FINSET_1,PEPIN,XXREAL_0,ORDINAL1,ARYTM_3,ARYTM_1,SUBSET_1,FUNCT_1,RELAT_1,INT_1,PCOMPS_1,PRE_TOPC,TOPDIM_1,WAYBEL23,RCOMP_1,PROB_1,TOPGEN_4,CARD_3,ZFMISC_1,STRUCT_0,RLVECT_3,TOPS_1,MCART_1,METRIZTS,EUCLID,XREAL_0,REAL_1,FINSEQ_1,METRIC_1,FINSEQ_2,RVSUM_1,SQUARE_1,COMPLEX1,RELAT_2,CONNSP_1,T_0TOPSP,FUNCOP_1,FUNCT_4,CARD_2;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,RELSET_1,MCART_1,ZFMISC_1,FUNCT_2,CARD_1,CANTOR_1,COMPLEX1,FINSET_1,ORDINAL1,NUMBERS,XXREAL_0,XREAL_0,REAL_1,XXREAL_3,NAT_1,INT_1,SETFAM_1,DOMAIN_1,FUNCOP_1,TOPS_2,STRUCT_0,PRE_TOPC,METRIC_1,PCOMPS_1,CARD_3,PROB_1,KURATO_2,WAYBEL23,TOPS_1,T_0TOPSP,CARD_2,RVSUM_1,FINSEQ_1,FINSEQ_2,EUCLID,BORSUK_1,TOPGEN_4,FUNCT_4,SQUARE_1,CONNSP_1,TOPREAL9,ORDERS_4,METRIZTS,TOPDIM_1,CKB1,CKB4;
definitions STRUCT_0,SQUARE_1,EUCLID,PCOMPS_1,TOPS_1,TARSKI,METRIC_1,XBOOLE_0,TOPS_2,SETFAM_1,SUBSET_1,CARD_3,TOPDIM_1,CKB1,CKB4;
theorems ABSVALUE,FINSEQ_1,FINSEQ_2,FUNCT_1,FUNCT_2,RVSUM_1,TARSKI,XREAL_0,COMPLEX1,XREAL_1,XXREAL_0,FUNCOP_1,ORDINAL1,RELAT_1,PRE_TOPC,TOPMETR,EUCLID,METRIC_1,XBOOLE_0,TOPS_1,TOPS_2,TOPREAL7,PROB_1,ZFMISC_1,NAT_1,KURATO_2,INT_1,TOPGEN_1,XBOOLE_1,MCART_1,CARD_1,TOPGEN_4,SUBSET_1,TSEP_1,TSP_1,SETFAM_1,CARD_4,YELLOW_9,ORDERS_4,BORSUK_1,CARD_3,CARD_2,NECKLACE,BORSUK_3,TOPALG_3,JORDAN2C,TOPREAL9,JORDAN2B,JORDAN,STIRL2_1,FUNCT_4,ENUMSET1,XXREAL_3,CONNSP_1,WELLORD2,METRIZTS,PCOMPS_1,TOPDIM_1,YELLOW14,CKB1,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB20,CKB21,CKB22,CKB24,CKB25,CKB26;
schemes FUNCT_2,NAT_1,CLASSES1,LMOD_7,BORSUK_2;
registrations REALSET1,PRE_TOPC,PCOMPS_1,NAT_1,XREAL_0,SUBSET_1,STRUCT_0,TOPS_1,XXREAL_0,YELLOW13,CARD_1,XBOOLE_0,FINSET_1,VALUED_0,RELAT_1,FUNCT_1,INT_1,CARD_3,TOPGEN_4,BORSUK_3,MEMBERED,XXREAL_3,METRIZTS,TOPDIM_1,EUCLID,ZFMISC_1,RELSET_1,CKB2,CKB3,CKB5,CKB6,CKB19,CKB23;
constructors TOPS_2,BORSUK_1,REAL_1,COMPLEX1,CANTOR_1,TOPGEN_4,WAYBEL23,TOPS_1,SQUARE_1,RVSUM_1,BORSUK_3,CARD_2,TSP_1,CONNSP_1,BINOP_2,TOPREAL9,ORDERS_4,XXREAL_3,METRIZTS,TOPDIM_1,FUNCOP_1,FUNCSDOM,PCOMPS_1,CKB1,CKB4;
requirements REAL,SUBSET,NUMERALS,ARITHM,BOOLE;
begin
reserve n for Nat;
reserve TM for  metrizable TopSpace;
reserve A for (Subset of TM);
reserve B for (Subset of TM);
reserve H for (Subset of TM);
reserve U for  open (Subset of TM);
reserve W for  open (Subset of TM);
reserve p for (Point of TM);
theorem
(for H holds (( TM | H ) is  second-countable implies ((H is  finite-ind & ( ind H ) <= n) iff (ex Bas being (Basis of TM) st (for A holds (A in Bas implies (( H /\ ( Fr A ) ) is  finite-ind & ( ind ( H /\ ( Fr A ) ) ) <= ( n - 1 ))))))))
proof
set cTM = ( [#] TM );
set TOP = (the topology of TM);
let M being (Subset of TM);
assume that
A1: ( TM | M ) is  second-countable;
hereby
defpred P[ set,set ]
 means
(for p being (Point of TM) holds (for A being (Subset of TM) holds ($1 = [ p,A ] implies (($2 in TOP & ((not p in A) implies $2 = ( {} TM ))) & (p in A implies (ex W being  open (Subset of TM) st ((((W = $2 & p in W) & W c= A) & ( M /\ ( Fr W ) ) is  finite-ind) & ( ind ( M /\ ( Fr W ) ) ) <= ( n - 1 ))))))));
assume A2: (M is  finite-ind & ( ind M ) <= n);
A3: (for x being set holds (x in [: cTM,TOP :] implies (ex y being set st P[ x,y ])))
proof
let x being set;
assume that
A4: x in [: cTM,TOP :];
consider p9,A9 being set such that A5: p9 in cTM and A6: A9 in TOP and A7: x = [ p9,A9 ] by A4,ZFMISC_1:def 2;
reconsider A9 as  open (Subset of TM) by A6,PRE_TOPC:def 2;
reconsider p9 as (Point of TM) by A5;
per cases ;
suppose A8: (not p9 in A9);

take ( {} TM );
let p being (Point of TM);
let A being (Subset of TM);
assume that
A9: x = [ p,A ];
p = p9 by A7,A9,ZFMISC_1:27;
hence thesis by A7,A8,A9,PRE_TOPC:def 2,ZFMISC_1:27;
end;
suppose p9 in A9;

then consider W being  open (Subset of TM) such that A10: (((p9 in W & W c= A9) & ( M /\ ( Fr W ) ) is  finite-ind) & ( ind ( M /\ ( Fr W ) ) ) <= ( n - 1 )) by A1,A2,CKB26:1;
take W;
let p being (Point of TM);
let A being (Subset of TM);
assume that
A11: x = [ p,A ];
(p = p9 & A = A9) by A7,A11,ZFMISC_1:27;
hence thesis by A10,PRE_TOPC:def 2;
end;
end;
consider f being Function such that A12: ( dom f ) = [: cTM,TOP :] and A13: (for x being set holds (x in [: cTM,TOP :] implies P[ x,( f . x ) ])) from CLASSES1:sch 1(A3);
A14: ( rng f ) c= TOP
proof
let y being set;
assume y in ( rng f );
then consider x being set such that A15: x in ( dom f ) and A16: ( f . x ) = y by FUNCT_1:def 3;
(ex p,A being set st ((p in cTM & A in TOP) & x = [ p,A ])) by A12,A15,ZFMISC_1:def 2;
hence thesis by A12,A13,A15,A16;
end;
then reconsider RNG = ( rng f ) as (Subset-Family of TM) by XBOOLE_1:1;
now
let A being (Subset of TM);
assume that
A17: A is  open;
A18: A in TOP by A17,PRE_TOPC:def 2;
let p being (Point of TM);
assume that
A19: p in A;
A20: [ p,A ] in [: cTM,TOP :] by A18,A19,ZFMISC_1:87;
then consider W being  open (Subset of TM) such that A21: ((W = ( f . [ p,A ] ) & p in W) & W c= A) and ( M /\ ( Fr W ) ) is  finite-ind and ( ind ( M /\ ( Fr W ) ) ) <= ( n - 1 ) by A13,A19;
reconsider W as (Subset of TM);
take W;
thus ((W in RNG & p in W) & W c= A) by A12,A20,A21,FUNCT_1:def 3;
end;
then reconsider RNG as (Basis of TM) by A14,YELLOW_9:32;
take RNG;
let B being (Subset of TM);
assume B in RNG;
then consider x being set such that A22: x in ( dom f ) and A23: ( f . x ) = B by FUNCT_1:def 3;
consider p,A being set such that A24: p in cTM and A25: A in TOP and A26: x = [ p,A ] by A12,A22,ZFMISC_1:def 2;
reconsider A as  open (Subset of TM) by A25,PRE_TOPC:def 2;
per cases ;
suppose p in A;

then (ex W being  open (Subset of TM) st ((((W = ( f . [ p,A ] ) & p in W) & W c= A) & ( M /\ ( Fr W ) ) is  finite-ind) & ( ind ( M /\ ( Fr W ) ) ) <= ( n - 1 ))) by A12,A13,A22,A26;
hence (( M /\ ( Fr B ) ) is  finite-ind & ( ind ( M /\ ( Fr B ) ) ) <= ( n - 1 )) by A23,A26;
end;
suppose (not p in A);

then B = ( {} TM ) by A12,A13,A22,A23,A24,A26;
then A27: ( Fr B ) = ( {} ) by TOPGEN_1:14;
( ( 0 ) - 1 ) <= ( n - 1 ) by XREAL_1:9;
hence (( M /\ ( Fr B ) ) is  finite-ind & ( ind ( M /\ ( Fr B ) ) ) <= ( n - 1 )) by A27,TOPDIM_1:6;
end;
end;
given B being (Basis of TM) such that
A28: (for A being (Subset of TM) holds (A in B implies (( M /\ ( Fr A ) ) is  finite-ind & ( ind ( M /\ ( Fr A ) ) ) <= ( n - 1 ))));

(for p being (Point of TM) holds (for U being  open (Subset of TM) holds (p in U implies (ex W being  open (Subset of TM) st (((p in W & W c= U) & ( M /\ ( Fr W ) ) is  finite-ind) & ( ind ( M /\ ( Fr W ) ) ) <= ( n - 1 ))))))
proof
let p being (Point of TM);
let U being  open (Subset of TM);
assume that
A29: p in U;
consider a being (Subset of TM) such that A30: a in B and A31: (p in a & a c= U) by A29,YELLOW_9:31;
B c= TOP by TOPS_2:64;
then reconsider a as  open (Subset of TM) by A30,PRE_TOPC:def 2;
take a;
thus thesis by A28,A30,A31;
end;
hence thesis by A1,CKB26:1;
end;
