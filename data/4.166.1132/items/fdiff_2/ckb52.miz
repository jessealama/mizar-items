environ
vocabularies NUMBERS,REAL_1,SUBSET_1,SEQ_1,FDIFF_1,FUNCT_1,RCOMP_1,PARTFUN1,ARYTM_1,VALUED_0,SEQ_2,ORDINAL2,CARD_1,RELAT_1,ARYTM_3,XREAL_0,ORDINAL1,XXREAL_0,COMPLEX1,NAT_1,TARSKI,VALUED_1,FUNCT_2,FUNCOP_1,XXREAL_1,FCONT_1,SQUARE_1,XBOOLE_0,ORDINAL4,LIMFUNC1;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,FUNCT_1,FUNCT_2,VALUED_0,VALUED_1,SEQ_1,RELSET_1,SEQ_2,PARTFUN1,SQUARE_1,PARTFUN2,RFUNCT_1,RCOMP_1,FCONT_1,FDIFF_1,LIMFUNC1,RECDEF_1,CKB1;
definitions TARSKI,XBOOLE_0,FDIFF_1,SQUARE_1,SUBSET_1,LIMFUNC1,PROB_1,VALUED_0,VALUED_1,SEQM_3;
theorems TARSKI,FUNCT_1,FUNCT_2,NAT_1,SEQ_1,SEQ_2,SEQM_3,SEQ_4,ABSVALUE,PARTFUN1,PARTFUN2,RCOMP_1,RFUNCT_1,RFUNCT_2,FCONT_1,FDIFF_1,SCHEME1,ROLLE,FCONT_3,FUNCT_3,RELAT_1,RELSET_1,XBOOLE_0,XBOOLE_1,XCMPLX_0,XCMPLX_1,COMPLEX1,FUNCOP_1,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_1,VALUED_0,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51;
schemes NAT_1,RECDEF_1,SEQ_1,SCHEME1,FUNCT_2,CKB11;
registrations ORDINAL1,RELSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,MEMBERED,SEQM_3,RCOMP_1,RFUNCT_2,FDIFF_1,FCONT_3,VALUED_0,VALUED_1,FUNCT_2,FUNCOP_1,SEQ_4;
constructors PARTFUN1,REAL_1,SQUARE_1,NAT_1,COMPLEX1,SEQ_2,SEQM_3,PROB_1,RCOMP_1,PARTFUN2,RFUNCT_1,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,SEQ_1,VALUED_1,RECDEF_1,RELSET_1,BINOP_2,RVSUM_1,CKB1;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve x0 for Real;
reserve g for Real;
reserve p for Real;
reserve n for (Element of ( NAT ));
reserve b for Real_Sequence;
reserve h for  convergent_to_0 Real_Sequence;
reserve c for  constant Real_Sequence;
theorem
(for f being  one-to-one (PartFunc of ( REAL ),( REAL )) holds (((( right_open_halfline p ) c= ( dom f ) & f is_differentiable_on ( right_open_halfline p )) & ((for x0 holds (x0 in ( right_open_halfline p ) implies ( 0 ) < ( diff (f,x0) ))) or (for x0 holds (x0 in ( right_open_halfline p ) implies ( diff (f,x0) ) < ( 0 ))))) implies ((( f | ( right_open_halfline p ) ) is  one-to-one & ( ( f | ( right_open_halfline p ) ) " ) is_differentiable_on ( dom ( ( f | ( right_open_halfline p ) ) " ) )) & (for x0 holds (x0 in ( dom ( ( f | ( right_open_halfline p ) ) " ) ) implies ( diff (( ( f | ( right_open_halfline p ) ) " ),x0) ) = ( 1 / ( diff (f,( ( ( f | ( right_open_halfline p ) ) " ) . x0 )) ) ))))))
proof
let f being  one-to-one (PartFunc of ( REAL ),( REAL ));
set l = ( right_open_halfline p );
assume that
A1: l c= ( dom f )
and
A2: f is_differentiable_on l
and
A3: ((for x0 holds (x0 in l implies ( 0 ) < ( diff (f,x0) ))) or (for x0 holds (x0 in l implies ( diff (f,x0) ) < ( 0 ))));
A4: ( rng ( f | l ) ) is  open by A1,A2,A3,CKB48:1;
set f1 = ( f | l );
thus f1 is  one-to-one;
A5: ( dom ( f1 " ) ) = ( rng f1 ) by FUNCT_1:33;
A6: ( rng ( f1 " ) ) = ( dom f1 ) by FUNCT_1:33;
A7: (for y0 being Real holds (y0 in ( dom ( f1 " ) ) implies (( f1 " ) is_differentiable_in y0 & ( diff (( f1 " ),y0) ) = ( 1 / ( diff (f,( ( f1 " ) . y0 )) ) ))))
proof
let y0 being Real;
assume A8: y0 in ( dom ( f1 " ) );
then consider x0 such that A9: x0 in ( dom f1 ) and A10: y0 = ( f1 . x0 ) by A5,PARTFUN1:3;
A11: (for h holds (for c holds ((( rng c ) = { y0 } & ( rng ( h + c ) ) c= ( dom ( f1 " ) )) implies (( ( h " ) (#) ( ( ( f1 " ) /* ( h + c ) ) - ( ( f1 " ) /* c ) ) ) is  convergent & ( lim ( ( h " ) (#) ( ( ( f1 " ) /* ( h + c ) ) - ( ( f1 " ) /* c ) ) ) ) = ( 1 / ( diff (f,( ( f1 " ) . y0 )) ) )))))
proof
A12: l c= ( dom f ) by A2,FDIFF_1:def 6;
(( f | l ) is  increasing or ( f | l ) is  decreasing) by A1,A2,A3,CKB38:1,CKB39:1;
then ( ( f1 " ) | ( f .: l ) ) is  continuous by A12,FCONT_3:19;
then A13: ( ( f1 " ) | ( rng f1 ) ) is  continuous by RELAT_1:115;
y0 in ( dom ( ( f1 " ) | ( rng f1 ) ) ) by A5,A8,RELAT_1:69;
then ( ( f1 " ) | ( rng f1 ) ) is_continuous_in y0 by A13,FCONT_1:def 2;
then A14: ( f1 " ) is_continuous_in y0 by A5,RELAT_1:68;
reconsider a = ( ( NAT ) --> ( ( f1 " ) . y0 ) ) as Real_Sequence by FUNCOP_1:45;
let h;
let c;
assume that
A15: ( rng c ) = { y0 }
and
A16: ( rng ( h + c ) ) c= ( dom ( f1 " ) );
A17: ( lim ( h + c ) ) = y0 by A15,CKB5:1;
reconsider a as  constant Real_Sequence;
defpred P[ (Element of ( NAT )), real number ]
 means
(for r1,r2 being  real number holds ((r1 = ( ( h + c ) . $1 ) & r2 = ( a . $1 )) implies ((r1 = ( f . ( r2 + $2 ) ) & ( r2 + $2 ) in ( dom f )) & ( r2 + $2 ) in ( dom ( f | l ) ))));
A18: (for n holds (ex r being Real st P[ n,r ]))
proof
let n;
( ( h + c ) . n ) in ( rng ( h + c ) ) by VALUED_0:28;
then consider g such that A19: g in ( dom f1 ) and A20: ( ( h + c ) . n ) = ( f1 . g ) by A5,A16,PARTFUN1:3;
take r = ( g - x0 );
let r1 being  real number,r2 being  real number;
assume that
A21: r1 = ( ( h + c ) . n )
and
A22: r2 = ( a . n );
A23: ( a . n ) = ( ( f1 " ) . ( f1 . x0 ) ) by A10,FUNCOP_1:7
.= x0 by A9,FUNCT_1:34;
hence r1 = ( f . ( r2 + r ) ) by A19,A20,A21,A22,FUNCT_1:47;
g in ( ( dom f ) /\ l ) by A19,RELAT_1:61;
hence thesis by A19,A23,A22,XBOOLE_0:def 4;
end;
consider b such that A24: (for n holds P[ n,( b . n ) ]) from FUNCT_2:sch 3(A18);
A25:now
let n;
A26: ( ( h + c ) . n ) = ( ( h + c ) . n );
then A27: ( ( a . n ) + ( b . n ) ) in ( dom f1 ) by A24;
thus ( ( ( ( f1 " ) /* ( h + c ) ) - a ) . n ) = ( ( ( ( f1 " ) /* ( h + c ) ) . n ) - ( a . n ) ) by RFUNCT_2:1
.= ( ( ( f1 " ) . ( ( h + c ) . n ) ) - ( a . n ) ) by A16,FUNCT_2:108
.= ( ( ( f1 " ) . ( f . ( ( a . n ) + ( b . n ) ) ) ) - ( a . n ) ) by A24
.= ( ( ( f1 " ) . ( f1 . ( ( a . n ) + ( b . n ) ) ) ) - ( a . n ) ) by A24,A26,FUNCT_1:47
.= ( ( ( a . n ) + ( b . n ) ) - ( a . n ) ) by A27,FUNCT_1:34
.= ( b . n );
end;
A28: ( h + c ) is  convergent by A15,CKB5:1;
then A29: ( ( f1 " ) /* ( h + c ) ) is  convergent by A16,A17,A14,FCONT_1:def 1;
then ( ( ( f1 " ) /* ( h + c ) ) - a ) is  convergent by SEQ_2:11;
then A30: b is  convergent by A25,FUNCT_2:63;
A31: ( lim a ) = ( a . ( 0 ) ) by SEQ_4:26
.= ( ( f1 " ) . y0 ) by FUNCOP_1:7;
( ( f1 " ) . y0 ) = ( lim ( ( f1 " ) /* ( h + c ) ) ) by A16,A28,A17,A14,FCONT_1:def 1;
then ( lim ( ( ( f1 " ) /* ( h + c ) ) - a ) ) = ( ( ( f1 " ) . y0 ) - ( ( f1 " ) . y0 ) ) by A29,A31,SEQ_2:12
.= ( 0 );
then A32: ( lim b ) = ( 0 ) by A25,FUNCT_2:63;
A33: ( rng ( b + a ) ) c= ( dom f )
proof
let x;
assume x in ( rng ( b + a ) );
then consider n such that A34: x = ( ( b + a ) . n ) by FUNCT_2:113;
A35: ( ( h + c ) . n ) = ( ( h + c ) . n );
x = ( ( a . n ) + ( b . n ) ) by A34,SEQ_1:7;
hence thesis by A24,A35;
end;
( ( f1 " ) . y0 ) in ( dom f1 ) by A6,A8,FUNCT_1:def 3;
then ( ( f1 " ) . y0 ) in ( ( dom f ) /\ l ) by RELAT_1:61;
then A36: ( ( f1 " ) . y0 ) in l by XBOOLE_0:def 4;
then A37: f is_differentiable_in ( ( f1 " ) . y0 ) by A2,FDIFF_1:9;
A38:now
let n;
( c . n ) in ( rng c ) by VALUED_0:28;
hence ( c . n ) = ( f1 . x0 ) by A10,A15,TARSKI:def 1;
end;
A39: ( 0 ) <> ( diff (f,( ( f1 " ) . y0 )) ) by A3,A36;
A40: h is  non-zero by FDIFF_1:def 1;
now
given n such that
A41: ( b . n ) = ( 0 );

( a . n ) = ( ( f1 " ) . ( f1 . x0 ) ) by A10,FUNCOP_1:7
.= x0 by A9,FUNCT_1:34;
then A42: ( f . ( ( a . n ) + ( b . n ) ) ) = ( f1 . x0 ) by A9,A41,FUNCT_1:47;
( ( h + c ) . n ) = ( ( h . n ) + ( c . n ) ) by SEQ_1:7
.= ( ( h . n ) + ( f1 . x0 ) ) by A38;
then ( ( h . n ) + ( f1 . x0 ) ) = ( f1 . x0 ) by A24,A42;
hence contradiction by A40,SEQ_1:5;
end;
then A43: b is  non-zero by SEQ_1:5;
then reconsider b as  convergent_to_0 Real_Sequence by A30,A32,FDIFF_1:def 1;
A44: ( b " ) is  non-zero by A43,SEQ_1:33;
A45: ( rng a ) = { ( ( f1 " ) . y0 ) }
proof
thus ( rng a ) c= { ( ( f1 " ) . y0 ) }
proof
let x;
assume x in ( rng a );
then (ex n st x = ( a . n )) by FUNCT_2:113;
then x = ( ( f1 " ) . y0 ) by FUNCOP_1:7;
hence thesis by TARSKI:def 1;
end;

let x;
assume x in { ( ( f1 " ) . y0 ) };
then x = ( ( f1 " ) . y0 ) by TARSKI:def 1;
then ( a . ( 0 ) ) = x by FUNCOP_1:7;
hence thesis by VALUED_0:28;
end;
A46: ( rng a ) c= ( dom f )
proof
let x;
assume x in ( rng a );
then x = ( ( f1 " ) . y0 ) by A45,TARSKI:def 1;
then x = x0 by A9,A10,FUNCT_1:34;
then x in ( ( dom f ) /\ l ) by A9,RELAT_1:61;
hence thesis by XBOOLE_0:def 4;
end;
now
let n;
A47: ( ( f1 " ) . y0 ) in ( rng ( f1 " ) ) by A8,FUNCT_1:def 3;
( c . n ) in ( rng c ) by VALUED_0:28;
then A48: ( c . n ) = y0 by A15,TARSKI:def 1;
thus ( ( f /* a ) . n ) = ( f . ( a . n ) ) by A46,FUNCT_2:108
.= ( f . ( ( f1 " ) . y0 ) ) by FUNCOP_1:7
.= ( f1 . ( ( f1 " ) . y0 ) ) by A6,A47,FUNCT_1:47
.= ( c . n ) by A5,A8,A48,FUNCT_1:35;
end;
then A49: ( f /* a ) = c by FUNCT_2:63;
now
let n;
( ( h + c ) . n ) = ( f . ( ( a . n ) + ( b . n ) ) ) by A24;
then ( ( h . n ) + ( c . n ) ) = ( f . ( ( a . n ) + ( b . n ) ) ) by SEQ_1:7;
hence ( h . n ) = ( ( f . ( ( b . n ) + ( a . n ) ) ) - ( ( f /* a ) . n ) ) by A49
.= ( ( f . ( ( b + a ) . n ) ) - ( ( f /* a ) . n ) ) by SEQ_1:7
.= ( ( ( f /* ( b + a ) ) . n ) - ( ( f /* a ) . n ) ) by A33,FUNCT_2:108
.= ( ( ( f /* ( b + a ) ) - ( f /* a ) ) . n ) by RFUNCT_2:1;
end;
then A50: h = ( ( f /* ( b + a ) ) - ( f /* a ) ) by FUNCT_2:63;
then ( ( f /* ( b + a ) ) - ( f /* a ) ) is  non-zero by FDIFF_1:def 1;
then A51: ( ( b " ) (#) ( ( f /* ( b + a ) ) - ( f /* a ) ) ) is  non-zero by A44,SEQ_1:35;
A52: ( rng c ) c= ( dom ( f1 " ) )
proof
let x;
assume x in ( rng c );
hence thesis by A8,A15,TARSKI:def 1;
end;
now
let n;
A53: ( ( h + c ) . n ) = ( ( h + c ) . n );
then A54: ( ( a . n ) + ( b . n ) ) in ( dom f1 ) by A24;
( c . n ) in ( rng c ) by VALUED_0:28;
then A55: ( c . n ) = y0 by A15,TARSKI:def 1;
thus ( ( ( h " ) (#) ( ( ( f1 " ) /* ( h + c ) ) - ( ( f1 " ) /* c ) ) ) . n ) = ( ( ( h " ) . n ) * ( ( ( ( f1 " ) /* ( h + c ) ) - ( ( f1 " ) /* c ) ) . n ) ) by SEQ_1:8
.= ( ( ( h " ) . n ) * ( ( ( ( f1 " ) /* ( h + c ) ) . n ) - ( ( ( f1 " ) /* c ) . n ) ) ) by RFUNCT_2:1
.= ( ( ( h " ) . n ) * ( ( ( f1 " ) . ( ( h + c ) . n ) ) - ( ( ( f1 " ) /* c ) . n ) ) ) by A16,FUNCT_2:108
.= ( ( ( h " ) . n ) * ( ( ( f1 " ) . ( f . ( ( a . n ) + ( b . n ) ) ) ) - ( ( ( f1 " ) /* c ) . n ) ) ) by A24
.= ( ( ( h " ) . n ) * ( ( ( f1 " ) . ( f1 . ( ( a . n ) + ( b . n ) ) ) ) - ( ( ( f1 " ) /* c ) . n ) ) ) by A24,A53,FUNCT_1:47
.= ( ( ( h " ) . n ) * ( ( ( a . n ) + ( b . n ) ) - ( ( ( f1 " ) /* c ) . n ) ) ) by A54,FUNCT_1:34
.= ( ( ( h " ) . n ) * ( ( ( a . n ) + ( b . n ) ) - ( ( f1 " ) . ( c . n ) ) ) ) by A52,FUNCT_2:108
.= ( ( ( h " ) . n ) * ( ( ( a . n ) + ( b . n ) ) - ( a . n ) ) ) by A55,FUNCOP_1:7
.= ( ( ( h " ) (#) ( ( b " ) " ) ) . n ) by SEQ_1:8
.= ( ( ( ( b " ) (#) ( ( f /* ( b + a ) ) - ( f /* a ) ) ) " ) . n ) by A50,SEQ_1:36;
end;
then A56: ( ( h " ) (#) ( ( ( f1 " ) /* ( h + c ) ) - ( ( f1 " ) /* c ) ) ) = ( ( ( b " ) (#) ( ( f /* ( b + a ) ) - ( f /* a ) ) ) " ) by FUNCT_2:63;
( diff (f,( ( f1 " ) . y0 )) ) = ( diff (f,( ( f1 " ) . y0 )) );
then A57: ( ( b " ) (#) ( ( f /* ( b + a ) ) - ( f /* a ) ) ) is  convergent by A45,A33,A37,CKB15:1;
A58: ( lim ( ( b " ) (#) ( ( f /* ( b + a ) ) - ( f /* a ) ) ) ) = ( diff (f,( ( f1 " ) . y0 )) ) by A45,A33,A37,CKB15:1;
hence ( ( h " ) (#) ( ( ( f1 " ) /* ( h + c ) ) - ( ( f1 " ) /* c ) ) ) is  convergent by A56,A51,A57,A39,SEQ_2:21;
thus ( lim ( ( h " ) (#) ( ( ( f1 " ) /* ( h + c ) ) - ( ( f1 " ) /* c ) ) ) ) = ( ( diff (f,( ( f1 " ) . y0 )) ) " ) by A56,A51,A57,A58,A39,SEQ_2:22
.= ( 1 / ( diff (f,( ( f1 " ) . y0 )) ) ) by XCMPLX_1:215;
end;
(ex N being (Neighbourhood of y0) st N c= ( dom ( f1 " ) )) by A4,A5,A8,RCOMP_1:18;
hence thesis by A11,CKB15:1;
end;
then (for y0 being Real holds (y0 in ( dom ( f1 " ) ) implies ( f1 " ) is_differentiable_in y0));
hence ( f1 " ) is_differentiable_on ( dom ( f1 " ) ) by A4,A5,FDIFF_1:9;
let x0;
assume x0 in ( dom ( f1 " ) );
hence thesis by A7;
end;
