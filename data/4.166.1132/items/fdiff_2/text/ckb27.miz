environ
vocabularies NUMBERS,REAL_1,SUBSET_1,SEQ_1,FDIFF_1,FUNCT_1,RCOMP_1,PARTFUN1,ARYTM_1,VALUED_0,SEQ_2,ORDINAL2,CARD_1,RELAT_1,ARYTM_3,XREAL_0,ORDINAL1,XXREAL_0,COMPLEX1,NAT_1,TARSKI,VALUED_1,FUNCT_2,FUNCOP_1,XXREAL_1,FCONT_1,SQUARE_1,XBOOLE_0,ORDINAL4,LIMFUNC1;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,FUNCT_1,FUNCT_2,VALUED_0,VALUED_1,SEQ_1,RELSET_1,SEQ_2,PARTFUN1,SQUARE_1,PARTFUN2,RFUNCT_1,RCOMP_1,FCONT_1,FDIFF_1,LIMFUNC1,RECDEF_1,CKB1;
definitions TARSKI,XBOOLE_0,FDIFF_1,SQUARE_1,SUBSET_1,LIMFUNC1,PROB_1,VALUED_0,VALUED_1,SEQM_3;
theorems TARSKI,FUNCT_1,FUNCT_2,NAT_1,SEQ_1,SEQ_2,SEQM_3,SEQ_4,ABSVALUE,PARTFUN1,PARTFUN2,RCOMP_1,RFUNCT_1,RFUNCT_2,FCONT_1,FDIFF_1,SCHEME1,ROLLE,FCONT_3,FUNCT_3,RELAT_1,RELSET_1,XBOOLE_0,XBOOLE_1,XCMPLX_0,XCMPLX_1,COMPLEX1,FUNCOP_1,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_1,VALUED_0,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26;
schemes NAT_1,RECDEF_1,SEQ_1,SCHEME1,FUNCT_2,CKB11;
registrations ORDINAL1,RELSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,MEMBERED,SEQM_3,RCOMP_1,RFUNCT_2,FDIFF_1,FCONT_3,VALUED_0,VALUED_1,FUNCT_2,FUNCOP_1,SEQ_4;
constructors PARTFUN1,REAL_1,SQUARE_1,NAT_1,COMPLEX1,SEQ_2,SEQM_3,PROB_1,RCOMP_1,PARTFUN2,RFUNCT_1,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,SEQ_1,VALUED_1,RECDEF_1,RELSET_1,BINOP_2,RVSUM_1,CKB1;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve x0 for Real;
reserve A for  open (Subset of ( REAL ));
reserve f for (PartFunc of ( REAL ),( REAL ));
theorem
((f is_differentiable_on A & (for x0 holds (x0 in A implies ( f . x0 ) <> ( 0 )))) implies (( f ^ ) is_differentiable_on A & ( ( f ^ ) `| A ) = ( - ( ( f `| A ) / ( f (#) f ) ) )))
proof
assume that
A1: f is_differentiable_on A
and
A2: (for x0 holds (x0 in A implies ( f . x0 ) <> ( 0 )));
A3:now
let x0;
assume A4: x0 in A;
hence A5: ( f . x0 ) <> ( 0 ) by A2;
thus f is_differentiable_in x0 by A1,A4,FDIFF_1:9;
hence ( f ^ ) is_differentiable_in x0 by A5,CKB19:1;
end;
then A6: (for x0 holds (x0 in A implies ( f ^ ) is_differentiable_in x0));
A7: A c= ( dom f ) by A1,FDIFF_1:9;
A8: A c= ( ( dom f ) \ ( f " { ( 0 ) } ) )
proof
let x;
assume A9: x in A;
then reconsider x9 = x as Real;
assume (not x in ( ( dom f ) \ ( f " { ( 0 ) } ) ));
then ((not x in ( dom f )) or x in ( f " { ( 0 ) } )) by XBOOLE_0:def 5;
then ( f . x9 ) in { ( 0 ) } by A7,A9,FUNCT_1:def 7;
then ( f . x9 ) = ( 0 ) by TARSKI:def 1;
hence contradiction by A2,A9;
end;
then A c= ( dom ( f ^ ) ) by RFUNCT_1:def 2;
hence A10: ( f ^ ) is_differentiable_on A by A6,FDIFF_1:9;
then A11: A = ( dom ( ( f ^ ) `| A ) ) by FDIFF_1:def 7;
A12:now
let x0;
A13: ( dom ( f `| A ) ) = A by A1,FDIFF_1:def 7;
assume A14: x0 in ( dom ( ( f ^ ) `| A ) );
then A15: f is_differentiable_in x0 by A3,A11;
A16: ( f . x0 ) <> ( 0 ) by A3,A11,A14;
then ( ( f . x0 ) * ( f . x0 ) ) <> ( 0 );
then ( ( f (#) f ) . x0 ) <> ( 0 ) by VALUED_1:5;
then (not ( ( f (#) f ) . x0 ) in { ( 0 ) }) by TARSKI:def 1;
then A17: (not x0 in ( ( f (#) f ) " { ( 0 ) } )) by FUNCT_1:def 7;
x0 in ( ( dom f ) /\ ( dom f ) ) by A7,A11,A14;
then x0 in ( dom ( f (#) f ) ) by VALUED_1:def 4;
then x0 in ( ( dom ( f (#) f ) ) \ ( ( f (#) f ) " { ( 0 ) } ) ) by A17,XBOOLE_0:def 5;
then x0 in ( ( dom ( f `| A ) ) /\ ( ( dom ( f (#) f ) ) \ ( ( f (#) f ) " { ( 0 ) } ) ) ) by A11,A14,A13,XBOOLE_0:def 4;
then A18: x0 in ( dom ( ( f `| A ) / ( f (#) f ) ) ) by RFUNCT_1:def 1;
thus ( ( ( f ^ ) `| A ) . x0 ) = ( diff (( f ^ ),x0) ) by A10,A11,A14,FDIFF_1:def 7
.= ( - ( ( diff (f,x0) ) / ( ( f . x0 ) ^2 ) ) ) by A16,A15,CKB19:1
.= ( - ( ( ( f `| A ) . x0 ) / ( ( f . x0 ) * ( f . x0 ) ) ) ) by A1,A11,A14,FDIFF_1:def 7
.= ( - ( ( ( f `| A ) . x0 ) / ( ( f (#) f ) . x0 ) ) ) by VALUED_1:5
.= ( - ( ( ( f `| A ) . x0 ) * ( ( ( f (#) f ) . x0 ) " ) ) ) by XCMPLX_0:def 9
.= ( - ( ( ( f `| A ) / ( f (#) f ) ) . x0 ) ) by A18,RFUNCT_1:def 1
.= ( ( - ( ( f `| A ) / ( f (#) f ) ) ) . x0 ) by VALUED_1:8;
end;
( dom ( - ( ( f `| A ) / ( f (#) f ) ) ) ) = ( dom ( ( f `| A ) / ( f (#) f ) ) ) by VALUED_1:8
.= ( ( dom ( f `| A ) ) /\ ( ( dom ( f (#) f ) ) \ ( ( f (#) f ) " { ( 0 ) } ) ) ) by RFUNCT_1:def 1
.= ( A /\ ( ( dom ( f (#) f ) ) \ ( ( f (#) f ) " { ( 0 ) } ) ) ) by A1,FDIFF_1:def 7
.= ( A /\ ( ( ( dom f ) /\ ( dom f ) ) \ ( ( f (#) f ) " { ( 0 ) } ) ) ) by VALUED_1:def 4
.= ( A /\ ( ( dom f ) \ ( f " { ( 0 ) } ) ) ) by CKB25:1
.= ( dom ( ( f ^ ) `| A ) ) by A8,A11,XBOOLE_1:28;
hence thesis by A12,PARTFUN1:5;
end;
