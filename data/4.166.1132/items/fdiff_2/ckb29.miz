environ
vocabularies NUMBERS,REAL_1,SUBSET_1,SEQ_1,FDIFF_1,FUNCT_1,RCOMP_1,PARTFUN1,ARYTM_1,VALUED_0,SEQ_2,ORDINAL2,CARD_1,RELAT_1,ARYTM_3,XREAL_0,ORDINAL1,XXREAL_0,COMPLEX1,NAT_1,TARSKI,VALUED_1,FUNCT_2,FUNCOP_1,XXREAL_1,FCONT_1,SQUARE_1,XBOOLE_0,ORDINAL4,LIMFUNC1;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,FUNCT_1,FUNCT_2,VALUED_0,VALUED_1,SEQ_1,RELSET_1,SEQ_2,PARTFUN1,SQUARE_1,PARTFUN2,RFUNCT_1,RCOMP_1,FCONT_1,FDIFF_1,LIMFUNC1,RECDEF_1,CKB1;
definitions TARSKI,XBOOLE_0,FDIFF_1,SQUARE_1,SUBSET_1,LIMFUNC1,PROB_1,VALUED_0,VALUED_1,SEQM_3;
theorems TARSKI,FUNCT_1,FUNCT_2,NAT_1,SEQ_1,SEQ_2,SEQM_3,SEQ_4,ABSVALUE,PARTFUN1,PARTFUN2,RCOMP_1,RFUNCT_1,RFUNCT_2,FCONT_1,FDIFF_1,SCHEME1,ROLLE,FCONT_3,FUNCT_3,RELAT_1,RELSET_1,XBOOLE_0,XBOOLE_1,XCMPLX_0,XCMPLX_1,COMPLEX1,FUNCOP_1,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_1,VALUED_0,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28;
schemes NAT_1,RECDEF_1,SEQ_1,SCHEME1,FUNCT_2,CKB11;
registrations ORDINAL1,RELSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,MEMBERED,SEQM_3,RCOMP_1,RFUNCT_2,FDIFF_1,FCONT_3,VALUED_0,VALUED_1,FUNCT_2,FUNCOP_1,SEQ_4;
constructors PARTFUN1,REAL_1,SQUARE_1,NAT_1,COMPLEX1,SEQ_2,SEQM_3,PROB_1,RCOMP_1,PARTFUN2,RFUNCT_1,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,SEQ_1,VALUED_1,RECDEF_1,RELSET_1,BINOP_2,RVSUM_1,CKB1;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve x0 for Real;
reserve r for Real;
reserve p for Real;
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve h for  convergent_to_0 Real_Sequence;
reserve c for  constant Real_Sequence;
reserve A for  open (Subset of ( REAL ));
reserve f for (PartFunc of ( REAL ),( REAL ));
theorem
Th24: ((A c= ( dom f ) & (for r holds (for p holds ((r in A & p in A) implies ( abs ( ( f . r ) - ( f . p ) ) ) <= ( ( r - p ) ^2 ))))) implies (f is_differentiable_on A & (for x0 holds (x0 in A implies ( diff (f,x0) ) = ( 0 )))))
proof
assume that
A1: A c= ( dom f )
and
A2: (for r holds (for p holds ((r in A & p in A) implies ( abs ( ( f . r ) - ( f . p ) ) ) <= ( ( r - p ) ^2 ))));
A3:now
let x0;
assume x0 in A;
then consider N being (Neighbourhood of x0) such that A4: N c= A by RCOMP_1:18;
A5: N c= ( dom f ) by A1,A4,XBOOLE_1:1;
(for h holds (for c holds ((( rng c ) = { x0 } & ( rng ( h + c ) ) c= ( dom f )) implies (( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) is  convergent & ( lim ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ) = ( 0 )))))
proof
reconsider a = ( ( NAT ) --> ( 0 ) ) as Real_Sequence by FUNCOP_1:45;
let h;
let c;
assume that
A6: ( rng c ) = { x0 }
and
A7: ( rng ( h + c ) ) c= ( dom f );
A8: ( lim ( h + c ) ) = x0 by A6,CKB5:1;
consider r being  real number such that A9: ( 0 ) < r and A10: N = ]. ( x0 - r ),( x0 + r ) .[ by RCOMP_1:def 6;
( h + c ) is  convergent by A6,CKB5:1;
then consider n such that A11: (for m holds (n <= m implies ( abs ( ( ( h + c ) . m ) - x0 ) ) < r)) by A8,A9,SEQ_2:def 7;
set hc = ( ( h + c ) ^\ n );
A12: ( rng hc ) c= A
proof
let x;
assume x in ( rng hc );
then consider m such that A13: x = ( hc . m ) by FUNCT_2:113;
x = ( ( h + c ) . ( m + n ) ) by A13,NAT_1:def 3;
then ( abs ( ( hc . m ) - x0 ) ) < r by A11,A13,NAT_1:12;
then x in N by A10,A13,RCOMP_1:1;
hence thesis by A4;
end;
A14: ( rng c ) c= ( dom f )
proof
let x;
assume x in ( rng c );
then A15: x = x0 by A6,TARSKI:def 1;
x0 in N by RCOMP_1:16;
hence thesis by A5,A15;
end;
set fn = ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ^\ n );
set h1 = ( h ^\ n );
A16: h1 is  convergent by FDIFF_1:def 1;
then A17: ( abs h1 ) is  convergent;
set c1 = ( c ^\ n );
A18: ( rng c1 ) c= A
proof
A19: ( rng c1 ) c= ( rng c ) by VALUED_0:21;
let x;
assume x in ( rng c1 );
then A20: x = x0 by A6,A19,TARSKI:def 1;
x0 in N by RCOMP_1:16;
hence thesis by A4,A20;
end;
h1 is  non-zero by FDIFF_1:def 1;
then A21: ( abs h1 ) is  non-zero by SEQ_1:53;
A22: (for m holds (( a . m ) <= ( ( abs fn ) . m ) & ( ( abs fn ) . m ) <= ( ( abs h1 ) . m )))
proof
let m;
A23: ( c1 . m ) in ( rng c1 ) by VALUED_0:28;
( hc . m ) in ( rng hc ) by VALUED_0:28;
then ( abs ( ( f . ( hc . m ) ) - ( f . ( c1 . m ) ) ) ) <= ( ( ( hc . m ) - ( c1 . m ) ) ^2 ) by A2,A12,A18,A23;
then A24: ( abs ( ( f . ( hc . m ) ) - ( f . ( c1 . m ) ) ) ) <= ( ( abs ( ( hc . m ) - ( c1 . m ) ) ) ^2 ) by COMPLEX1:75;
A25: ( ( ( ( abs h1 ) . m ) " ) * ( ( abs ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) . m ) ) = ( ( ( ( abs h1 ) " ) . m ) * ( ( abs ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) . m ) ) by VALUED_1:10
.= ( ( ( ( abs h1 ) " ) (#) ( abs ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) ) . m ) by SEQ_1:8
.= ( ( ( abs ( h1 " ) ) (#) ( abs ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) ) . m ) by SEQ_1:54
.= ( ( abs ( ( h1 " ) (#) ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) ) . m ) by SEQ_1:52
.= ( ( abs ( ( ( h " ) ^\ n ) (#) ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) ) . m ) by SEQM_3:18
.= ( ( abs ( ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) ^\ n ) ) . m ) by SEQM_3:19;
( 0 ) <= ( abs ( fn . m ) ) by COMPLEX1:46;
then ( a . m ) <= ( abs ( fn . m ) ) by FUNCOP_1:7;
hence ( a . m ) <= ( ( abs fn ) . m ) by SEQ_1:12;
A26: ( ( abs ( ( hc . m ) - ( c1 . m ) ) ) ^2 ) = ( ( abs ( ( ( h1 + c1 ) . m ) - ( c1 . m ) ) ) ^2 ) by SEQM_3:15
.= ( ( abs ( ( ( h1 . m ) + ( c1 . m ) ) - ( c1 . m ) ) ) ^2 ) by SEQ_1:7
.= ( ( ( abs h1 ) . m ) ^2 ) by SEQ_1:12
.= ( ( ( abs h1 ) . m ) * ( ( abs h1 ) . m ) );
( 0 ) <= ( abs ( h1 . m ) ) by COMPLEX1:46;
then A27: ( 0 ) <= ( ( abs h1 ) . m ) by SEQ_1:12;
A28: ( ( abs h1 ) . m ) <> ( 0 ) by A21,SEQ_1:5;
A29: ( ( ( ( abs h1 ) . m ) * ( ( abs h1 ) . m ) ) * ( ( ( abs h1 ) . m ) " ) ) = ( ( ( abs h1 ) . m ) * ( ( ( abs h1 ) . m ) * ( ( ( abs h1 ) . m ) " ) ) )
.= ( ( ( abs h1 ) . m ) * 1 ) by A28,XCMPLX_0:def 7
.= ( ( abs h1 ) . m );
( abs ( ( f . ( hc . m ) ) - ( f . ( c1 . m ) ) ) ) = ( abs ( ( ( f /* hc ) . m ) - ( f . ( c1 . m ) ) ) ) by A1,A12,FUNCT_2:108,XBOOLE_1:1
.= ( abs ( ( ( f /* hc ) . m ) - ( ( f /* c1 ) . m ) ) ) by A1,A18,FUNCT_2:108,XBOOLE_1:1
.= ( abs ( ( ( f /* hc ) - ( f /* c1 ) ) . m ) ) by RFUNCT_2:1
.= ( ( abs ( ( f /* hc ) - ( f /* c1 ) ) ) . m ) by SEQ_1:12
.= ( ( abs ( ( ( f /* ( h + c ) ) ^\ n ) - ( f /* c1 ) ) ) . m ) by A7,VALUED_0:27
.= ( ( abs ( ( ( f /* ( h + c ) ) ^\ n ) - ( ( f /* c ) ^\ n ) ) ) . m ) by A14,VALUED_0:27
.= ( ( abs ( ( ( f /* ( h + c ) ) - ( f /* c ) ) ^\ n ) ) . m ) by SEQM_3:17;
hence thesis by A24,A26,A27,A29,A25,XREAL_1:64;
end;
( lim h1 ) = ( 0 ) by FDIFF_1:def 1;
then A30: ( lim ( abs h1 ) ) = ( abs ( 0 ) ) by A16,SEQ_4:14
.= ( 0 ) by ABSVALUE:2;
A31: ( lim a ) = ( a . ( 0 ) ) by SEQ_4:26
.= ( 0 ) by FUNCOP_1:7;
then A32: ( lim ( abs fn ) ) = ( 0 ) by A17,A30,A22,SEQ_2:20;
A33: ( abs fn ) is  convergent by A31,A17,A30,A22,SEQ_2:19;
then A34: fn is  convergent by A32,SEQ_4:15;
hence ( ( h " ) (#) ( ( f /* ( h + c ) ) - ( f /* c ) ) ) is  convergent by SEQ_4:21;
( lim fn ) = ( 0 ) by A33,A32,SEQ_4:15;
hence thesis by A34,SEQ_4:22;
end;
hence (f is_differentiable_in x0 & ( diff (f,x0) ) = ( 0 )) by A5,CKB15:1;
end;
then (for x0 holds (x0 in A implies f is_differentiable_in x0));
hence f is_differentiable_on A by A1,FDIFF_1:9;
let x0;
assume x0 in A;
hence thesis by A3;
end;
