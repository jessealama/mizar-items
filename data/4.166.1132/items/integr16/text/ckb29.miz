environ
vocabularies INTEGRA1,INTEGRA2,FINSEQ_1,SEQ_1,SEQ_2,ORDINAL2,ARYTM_1,RELAT_1,FUNCT_1,PARTFUN1,XBOOLE_0,FUNCT_3,INTEGR15,REALSET1,XCMPLX_0,COMPLEX1,COMSEQ_1,SETWISEO,SUBSET_1,NUMBERS,ORDINAL1,CARD_1,ORDINAL4,NAT_1,TARSKI,CARD_3,MEASURE7,ARYTM_3,XREAL_0,BINOP_2,XXREAL_0,XXREAL_2,INTEGRA5,VALUED_1,REAL_1,XXREAL_1,FUNCT_2,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,COMPLEX1,NAT_1,RELAT_1,FUNCT_1,FUNCT_2,REAL_1,RCOMP_1,VALUED_1,RELSET_1,PARTFUN1,SEQ_1,SEQ_2,FINSEQ_1,FINSEQ_2,BINOP_2,BINOP_1,SETWOP_2,RVSUM_1,XXREAL_0,MEASURE5,INTEGRA1,INTEGRA2,INTEGRA3,INTEGRA5,INTEGR15,MESFUN6C,COMSEQ_1,COMSEQ_2,COMSEQ_3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB24,CKB28;
definitions XBOOLE_0,INTEGRA5,INTEGR15,FINSEQ_1,COMPLEX1,RVSUM_1,CKB6,CKB7,CKB8,CKB10,CKB24,CKB28;
theorems XBOOLE_0,XBOOLE_1,XCMPLX_0,XREAL_0,INTEGRA1,COMSEQ_3,RFUNCT_1,COMPLEX1,RELSET_1,BINOP_2,FINSOP_1,NAT_1,XXREAL_0,RELAT_1,ORDINAL1,XREAL_1,SEQ_2,FINSEQ_1,RVSUM_1,FUNCT_1,FUNCT_2,INTEGRA5,FINSEQ_3,INTEGRA6,INTEGR15,VALUED_1,MESFUN6C,CKB1,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28;
schemes FUNCT_2,FINSEQ_1,NAT_1;
registrations NUMBERS,XREAL_0,INTEGRA1,FUNCT_2,BINOP_2,MEMBERED,ORDINAL1,VALUED_0,RELSET_1,FINSEQ_1,MEASURE5,CKB2,CKB3,CKB13,CKB14;
constructors REAL_1,MONOID_0,MEASURE6,BINOP_2,SEQ_1,INTEGRA5,RELSET_1,INTEGR15,FINSOP_1,SETWISEO,COMSEQ_2,COMSEQ_3,MESFUN6C,SQUARE_1,SEQ_2,INTEGRA3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB24,CKB28;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
theorem
Th14: (for A being non  empty  closed_interval (Subset of ( REAL )) holds (for f being (Function of A,( COMPLEX )) holds (for T being (DivSequence of A) holds (for S being (middle_volume_Sequence of f,T) holds ((((f is  bounded & f is  integrable) & ( delta T ) is  convergent) & ( lim ( delta T ) ) = ( 0 )) implies (( middle_sum (f,S) ) is  convergent & ( lim ( middle_sum (f,S) ) ) = ( integral f )))))))
proof
let A being non  empty  closed_interval (Subset of ( REAL ));
let f being (Function of A,( COMPLEX ));
let T being (DivSequence of A);
let S being (middle_volume_Sequence of f,T);
assume that
A1: (f is  bounded & f is  integrable)
and
A2: (( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 ));
set seq = ( middle_sum (f,S) );
set xs = ( integral f );
A3: (( Re f ) is  bounded & ( Re f ) is  integrable) by A1,CKB24:def 1,CKB27:1;
A4: (( Im f ) is  bounded & ( Im f ) is  integrable) by A1,CKB24:def 1,CKB27:1;
reconsider xseq = seq as (Function of ( NAT ),( COMPLEX ));
(ex rseqi being Real_Sequence st (for k being (Element of ( NAT )) holds ((( rseqi . k ) = ( Re ( xseq . k ) ) & rseqi is  convergent) & ( Re xs ) = ( lim rseqi ))))
proof
reconsider pjinf = ( Re f ) as (Function of A,( REAL ));
defpred P[ (Element of ( NAT )),set ]
 means
$2 = ( Re ( S . $1 ) );
A5: (for x being (Element of ( NAT )) holds (ex y being (Element of ( ( REAL ) * )) st P[ x,y ]))
proof
let x being (Element of ( NAT ));
( Re ( S . x ) ) is (Element of ( ( REAL ) * )) by FINSEQ_1:def 11;
hence thesis;
end;
consider F being (Function of ( NAT ),( ( REAL ) * )) such that A6: (for x being (Element of ( NAT )) holds P[ x,( F . x ) ]) from FUNCT_2:sch 10(A5);
A7: (for x being (Element of ( NAT )) holds ( dom ( Re ( S . x ) ) ) = ( Seg ( len ( S . x ) ) ))
proof
let x being (Element of ( NAT ));
thus ( dom ( Re ( S . x ) ) ) = ( dom ( S . x ) ) by COMSEQ_3:def 3
.= ( Seg ( len ( S . x ) ) ) by FINSEQ_1:def 3;
end;
(for k being (Element of ( NAT )) holds ( F . k ) is (middle_volume of pjinf,( T . k )))
proof
let k being (Element of ( NAT ));
set Tk = ( T . k );
reconsider Fk = ( F . k ) as (FinSequence of ( REAL )) by FINSEQ_1:def 11;
A8: ( F . k ) = ( Re ( S . k ) ) by A6;
then A9: ( dom Fk ) = ( Seg ( len ( S . k ) ) ) by A7
.= ( Seg ( len Tk ) ) by CKB6:def 1;
then A10: ( dom Fk ) = ( dom Tk ) by FINSEQ_1:def 3;
A11:now
let j being Nat;
assume A12: j in ( dom Tk );
then consider r being (Element of ( COMPLEX )) such that A13: r in ( rng ( f | ( divset (( T . k ),j) ) ) ) and A14: ( ( S . k ) . j ) = ( r * ( vol ( divset (( T . k ),j) ) ) ) by CKB6:def 1;
reconsider v = ( Re r ) as (Element of ( REAL ));
take v;
consider t being set such that A15: t in ( dom ( f | ( divset (( T . k ),j) ) ) ) and A16: r = ( ( f | ( divset (( T . k ),j) ) ) . t ) by A13,FUNCT_1:def 3;
t in ( ( dom f ) /\ ( divset (( T . k ),j) ) ) by A15,RELAT_1:61;
then t in ( dom f ) by XBOOLE_0:def 4;
then A17: t in ( dom ( Re f ) ) by COMSEQ_3:def 3;
A18: ( dom ( f | ( divset (( T . k ),j) ) ) ) = ( ( dom f ) /\ ( divset (( T . k ),j) ) ) by RELAT_1:61
.= ( ( dom pjinf ) /\ ( divset (( T . k ),j) ) ) by COMSEQ_3:def 3
.= ( dom ( pjinf | ( divset (( T . k ),j) ) ) ) by RELAT_1:61;
( Re r ) = ( Re ( f . t ) ) by A15,A16,FUNCT_1:47
.= ( ( Re f ) . t ) by A17,COMSEQ_3:def 3
.= ( ( pjinf | ( divset (( T . k ),j) ) ) . t ) by A15,A18,FUNCT_1:47;
hence v in ( rng ( pjinf | ( divset (( T . k ),j) ) ) ) by A15,A18,FUNCT_1:3;
thus ( Fk . j ) = ( Re ( ( S . k ) . j ) ) by A8,A10,A12,COMSEQ_3:def 3
.= ( v * ( vol ( divset (( T . k ),j) ) ) ) by A14,CKB1:1;
end;
( len Fk ) = ( len Tk ) by A9,FINSEQ_1:def 3;
hence thesis by A11,INTEGR15:def 1;
end;
then reconsider pjis = F as (middle_volume_Sequence of pjinf,T) by INTEGR15:def 3;
reconsider rseqi = ( middle_sum (pjinf,pjis) ) as Real_Sequence;
A19: (for k being (Element of ( NAT )) holds ( rseqi . k ) = ( Re ( xseq . k ) ))
proof
let k being (Element of ( NAT ));
A20: ( Re ( S . k ) ) is (middle_volume of ( Re f ),( T . k )) by CKB15:1;
thus ( rseqi . k ) = ( middle_sum (pjinf,( pjis . k )) ) by INTEGR15:def 4
.= ( Re ( middle_sum (f,( S . k )) ) ) by A6,A20,CKB20:1
.= ( Re ( xseq . k ) ) by CKB10:def 1;
end;
take rseqi;
( lim ( middle_sum (pjinf,pjis) ) ) = ( integral pjinf ) by A2,A3,INTEGR15:9;
hence thesis by A2,A3,A19,COMPLEX1:12,INTEGR15:9;
end;
then consider rseqi being Real_Sequence such that A21: (for k being (Element of ( NAT )) holds ((( rseqi . k ) = ( Re ( xseq . k ) ) & rseqi is  convergent) & ( Re xs ) = ( lim rseqi )));
(ex iseqi being Real_Sequence st (for k being (Element of ( NAT )) holds ((( iseqi . k ) = ( Im ( xseq . k ) ) & iseqi is  convergent) & ( Im xs ) = ( lim iseqi ))))
proof
reconsider pjinf = ( Im f ) as (Function of A,( REAL ));
defpred P[ (Element of ( NAT )),set ]
 means
$2 = ( Im ( S . $1 ) );
A22: (for x being (Element of ( NAT )) holds (ex y being (Element of ( ( REAL ) * )) st P[ x,y ]))
proof
let x being (Element of ( NAT ));
( Im ( S . x ) ) is (Element of ( ( REAL ) * )) by FINSEQ_1:def 11;
hence thesis;
end;
consider F being (Function of ( NAT ),( ( REAL ) * )) such that A23: (for x being (Element of ( NAT )) holds P[ x,( F . x ) ]) from FUNCT_2:sch 10(A22);
A24: (for x being (Element of ( NAT )) holds ( dom ( Im ( S . x ) ) ) = ( Seg ( len ( S . x ) ) ))
proof
let x being (Element of ( NAT ));
( dom ( Im ( S . x ) ) ) = ( dom ( S . x ) ) by COMSEQ_3:def 4
.= ( Seg ( len ( S . x ) ) ) by FINSEQ_1:def 3;
hence thesis;
end;
(for k being (Element of ( NAT )) holds ( F . k ) is (middle_volume of pjinf,( T . k )))
proof
let k being (Element of ( NAT ));
reconsider Tk = ( T . k ) as FinSequence;
reconsider Fk = ( F . k ) as (FinSequence of ( REAL )) by FINSEQ_1:def 11;
A25: ( F . k ) = ( Im ( S . k ) ) by A23;
then A26: ( dom Fk ) = ( Seg ( len ( S . k ) ) ) by A24
.= ( Seg ( len Tk ) ) by CKB6:def 1;
then A27: ( dom Fk ) = ( dom Tk ) by FINSEQ_1:def 3;
A28:now
let j being Nat;
assume A29: j in ( dom Tk );
then consider r being (Element of ( COMPLEX )) such that A30: r in ( rng ( f | ( divset (( T . k ),j) ) ) ) and A31: ( ( S . k ) . j ) = ( r * ( vol ( divset (( T . k ),j) ) ) ) by CKB6:def 1;
reconsider v = ( Im r ) as (Element of ( REAL ));
take v;
consider t being set such that A32: t in ( dom ( f | ( divset (( T . k ),j) ) ) ) and A33: r = ( ( f | ( divset (( T . k ),j) ) ) . t ) by A30,FUNCT_1:def 3;
t in ( ( dom f ) /\ ( divset (( T . k ),j) ) ) by A32,RELAT_1:61;
then t in ( dom f ) by XBOOLE_0:def 4;
then A34: t in ( dom ( Im f ) ) by COMSEQ_3:def 4;
A35: ( dom ( f | ( divset (( T . k ),j) ) ) ) = ( ( dom f ) /\ ( divset (( T . k ),j) ) ) by RELAT_1:61
.= ( ( dom pjinf ) /\ ( divset (( T . k ),j) ) ) by COMSEQ_3:def 4
.= ( dom ( pjinf | ( divset (( T . k ),j) ) ) ) by RELAT_1:61;
( Im r ) = ( Im ( f . t ) ) by A32,A33,FUNCT_1:47
.= ( ( Im f ) . t ) by A34,COMSEQ_3:def 4
.= ( ( pjinf | ( divset (( T . k ),j) ) ) . t ) by A32,A35,FUNCT_1:47;
hence v in ( rng ( pjinf | ( divset (( T . k ),j) ) ) ) by A32,A35,FUNCT_1:3;
thus ( Fk . j ) = ( Im ( ( S . k ) . j ) ) by A25,A27,A29,COMSEQ_3:def 4
.= ( v * ( vol ( divset (( T . k ),j) ) ) ) by A31,CKB1:1;
end;
( len Fk ) = ( len Tk ) by A26,FINSEQ_1:def 3;
hence thesis by A28,INTEGR15:def 1;
end;
then reconsider pjis = F as (middle_volume_Sequence of pjinf,T) by INTEGR15:def 3;
reconsider iseqi = ( middle_sum (pjinf,pjis) ) as Real_Sequence;
A36: (for k being (Element of ( NAT )) holds ( iseqi . k ) = ( Im ( xseq . k ) ))
proof
let k being (Element of ( NAT ));
A37: ( Im ( S . k ) ) is (middle_volume of ( Im f ),( T . k )) by CKB15:1;
thus ( iseqi . k ) = ( middle_sum (pjinf,( pjis . k )) ) by INTEGR15:def 4
.= ( Im ( middle_sum (f,( S . k )) ) ) by A23,A37,CKB21:1
.= ( Im ( xseq . k ) ) by CKB10:def 1;
end;
take iseqi;
( lim ( middle_sum (pjinf,pjis) ) ) = ( integral pjinf ) by A2,A4,INTEGR15:9;
hence thesis by A2,A4,A36,COMPLEX1:12,INTEGR15:9;
end;
then consider iseqi being Real_Sequence such that A38: (for k being (Element of ( NAT )) holds ((( iseqi . k ) = ( Im ( xseq . k ) ) & iseqi is  convergent) & ( Im xs ) = ( lim iseqi )));
thus ( middle_sum (f,S) ) is  convergent by A21,A38,COMSEQ_3:38;
thus ( lim ( middle_sum (f,S) ) ) = ( ( lim rseqi ) + ( ( lim iseqi ) * ( <i> ) ) ) by A21,A38,COMSEQ_3:39
.= ( integral f ) by A21,A38,COMPLEX1:13;
end;
