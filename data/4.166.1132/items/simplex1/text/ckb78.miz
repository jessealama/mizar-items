environ
vocabularies ARYTM_1,ARYTM_3,XBOOLE_0,CARD_1,CARD_2,CLASSES1,COHSP_1,COMPLEX1,CONVEX1,CONVEX2,CONVEX3,FINSEQ_1,FINSET_1,FUNCT_1,MATROID0,MCART_1,ORDERS_1,PARTFUN1,PRE_TOPC,QC_LANG1,RELAT_1,RLVECT_1,RLVECT_2,SEMI_AF1,SETFAM_1,SGRAPH1,SUBSET_1,TARSKI,TOPS_1,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,SIMPLEX1,REAL_1,FUNCOP_1,NAT_1,FUNCT_2,STRUCT_0,XXREAL_0,NUMBERS,ORDINAL1,CARD_3,GLIB_000,FINSEQ_4;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,NUMBERS,NAT_1,XXREAL_3,XXREAL_0,ORDERS_1,CARD_1,REAL_1,FINSET_1,SETFAM_1,DOMAIN_1,RELAT_1,FUNCT_1,FUNCT_2,RELSET_1,FINSEQ_1,STRUCT_0,CLASSES1,RVSUM_1,RLVECT_1,RLVECT_2,CONVEX1,CONVEX2,CONVEX3,PRE_TOPC,RLAFFIN1,FUNCOP_1,PENCIL_1,MATROID0,MCART_1,CARD_2,COHSP_1,SIMPLEX0,RLAFFIN2,CKB3,CKB4,CKB5,CKB6,CKB8,CKB15,CKB23,CKB26,CKB27,CKB40,CKB41;
definitions MATROID0,ORDERS_1,ORDINAL1,RLAFFIN2,RLVECT_2,SETFAM_1,STRUCT_0,SIMPLEX0,TARSKI,TOPS_2,XBOOLE_0,XXREAL_3,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
theorems BORSUK_5,CARD_1,CARD_2,CARD_FIN,CLASSES1,COHSP_1,CONVEX1,CONVEX3,FINSEQ_1,FINSEQ_3,FUNCOP_1,FUNCT_1,FUNCT_2,INT_1,MATROID0,MCART_1,NAT_1,ORDINAL1,PENCIL_1,PRE_TOPC,RELAT_1,RELSET_2,RLTOPSP1,RLVECT_1,RLVECT_2,RVSUM_1,SETFAM_1,STIRL2_1,TARSKI,TOPS_2,WELLORD2,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,XXREAL_3,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB40,CKB41,CKB50,CKB52,CKB53,CKB54,CKB58,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB76,CKB77;
schemes CLASSES1,FUNCT_1,FUNCT_2,NAT_1,RELAT_1;
registrations CARD_1,FINSET_1,FUNCT_1,MEMBERED,NAT_1,RELAT_1,RLVECT_1,STRUCT_0,SUBSET_1,VALUED_0,XCMPLX_0,XREAL_0,XXREAL_0,XBOOLE_0,RLAFFIN1,SIMPLEX0,FUNCOP_1,INT_1,XXREAL_3,MATROID0,REALSET1,SETFAM_1,COHSP_1,RLAFFIN2,RELSET_1,ZFMISC_1,DILWORTH,RLVECT_2,CKB17,CKB22,CKB25,CKB38,CKB39,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB51,CKB55,CKB56,CKB57,CKB59,CKB60;
constructors BINOP_2,CONVEX1,CONVEX3,REAL_1,RVSUM_1,SEQ_1,SETFAM_1,RLAFFIN1,SIMPLEX0,TOPS_2,LEXBFS,XXREAL_2,BORSUK_1,COHSP_1,CARD_2,REARRAN1,RLAFFIN2,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve X for set;
reserve n for Nat;
reserve k for Nat;
reserve V for RealLinearSpace;
reserve Aff for  finite  affinely-independent (Subset of V);
reserve B for (Subset of V);
reserve S for  finite (Subset-Family of V);
reserve v for (Vertex of ( BCS (k,( Complex_of { Aff } )) ));
reserve F for (Function of ( Vertices ( BCS (k,( Complex_of { Aff } )) ) ),Aff);
theorem
Th46: (for F holds ((for v holds (for B holds ((B c= Aff & v in ( conv B )) implies ( F . v ) in B))) implies (ex n st ( card { S where S is (Simplex of ( ( card Aff ) - 1 ),( BCS (k,( Complex_of { Aff } )) )): ( F .: S ) = Aff } ) = ( ( 2 * n ) + 1 ))))
proof
reconsider O = 1 as  ext-real number;
reconsider Z = ( 0 ) as  ext-real number;
defpred P[ Nat ]
 means
(for A being  finite  affinely-independent (Subset of V) holds (( card A ) = $1 implies (for F being (Function of ( Vertices ( BCS (k,( Complex_of { A } )) ) ),A) holds ((for v being (Vertex of ( BCS (k,( Complex_of { A } )) )) holds (for B being (Subset of V) holds ((B c= A & v in ( conv B )) implies ( F . v ) in B))) implies (ex n st ( card { S where S is (Simplex of ( ( card A ) - 1 ),( BCS (k,( Complex_of { A } )) )): ( F .: S ) = A } ) = ( ( 2 * n ) + 1 ))))));
A1: (for m being Nat holds (P[ m ] implies P[ ( m + 1 ) ]))
proof
let m being Nat;
assume that
A2: P[ m ];
let A being  finite  affinely-independent (Subset of V);
assume that
A3: ( card A ) = ( m + 1 );
A is non  empty by A3;
then consider a being set such that A4: a in A by XBOOLE_0:def 1;
reconsider a as (Element of V) by A4;
A5: ( card ( A \ { a } ) ) = m by A3,A4,STIRL2_1:55;
reconsider Aa = ( A \ { a } ) as  finite  affinely-independent (Subset of V) by RLAFFIN1:43,XBOOLE_1:36;
set CAa = ( Complex_of { Aa } );
(the topology of CAa) = ( bool Aa ) by SIMPLEX0:4;
then A6: ( Vertices CAa ) = ( union ( bool Aa ) ) by SIMPLEX0:16
.= Aa by ZFMISC_1:81;
A7: (( [#] CAa ) = ( [#] V ) & |. CAa .| c= ( [#] V ));
then A8: ( Vertices CAa ) c= ( Vertices ( BCS (k,CAa) ) ) by CKB37:1;
set CA = ( Complex_of { A } );
let F being (Function of ( Vertices ( BCS (k,CA) ) ),A);
assume that
A9: (for v being (Vertex of ( BCS (k,CA) )) holds (for B being (Subset of V) holds ((B c= A & v in ( conv B )) implies ( F . v ) in B)));
set XX = { S where S is (Simplex of ( ( card A ) - 1 ),( BCS (k,CA) )): ( F .: S ) = A };
A10: XX c= (the topology of ( BCS (k,CA) ))
proof
let x;
assume x in XX;
then (ex S being (Simplex of ( ( card A ) - 1 ),( BCS (k,CA) )) st (S = x & A = ( F .: S )));
hence thesis by PRE_TOPC:def 2;
end;
then reconsider XX as (Subset-Family of ( BCS (k,CA) )) by XBOOLE_1:1;
reconsider XX as  simplex-like (Subset-Family of ( BCS (k,CA) )) by A10,SIMPLEX0:14;
A11: (( [#] CA ) = ( [#] V ) & |. CA .| c= ( [#] V ));
A12: ( A \ { a } ) c= A by XBOOLE_1:36;
(for x holds (x in { Aa } implies (ex y st (y in { A } & x c= y))))
proof
let x;
assume A13: x in { Aa };
take A;
thus thesis by A12,A13,TARSKI:def 1;
end;
then { Aa } is_finer_than { A } by SETFAM_1:def 2;
then CAa is (SubSimplicialComplex of CA) by SIMPLEX0:30;
then A14: ( BCS (k,CAa) ) is (SubSimplicialComplex of ( BCS (k,CA) )) by A11,A7,CKB35:1;
then A15: ( Vertices ( BCS (k,CAa) ) ) c= ( Vertices ( BCS (k,CA) ) ) by SIMPLEX0:31;
A16: (the topology of CA) = ( bool A ) by SIMPLEX0:4;
then A17: ( Vertices CA ) = ( union ( bool A ) ) by SIMPLEX0:16
.= A by ZFMISC_1:81;
A18: ( dom F ) = ( Vertices ( BCS (k,CA) ) ) by A4,FUNCT_2:def 1;
per cases ;
suppose A19: m = ( 0 );

A20: ( O - 1 ) = ( 0 ) by XXREAL_3:7;
then A21: ( degree CA ) = ( 0 ) by A3,A19,SIMPLEX0:26;
(k = ( 0 ) or k > ( 0 ));
then A22: ( BCS (k,CA) ) = CA by A11,A21,CKB28:1,CKB34:1;
then A23: ( dom F ) = ( Vertices CA ) by A4,FUNCT_2:def 1;
take ( 0 );
A in ( bool A ) by ZFMISC_1:def 1;
then reconsider A1 = A as (Simplex of CA) by A16,PRE_TOPC:def 2;
A24: A1 is (Simplex of ( 0 ),CA) by A3,A19,A20,SIMPLEX0:48;
(ex x st A = { x }) by A3,A19,CARD_2:42;
then A25: A = { a } by A4,TARSKI:def 1;
then ( conv A ) = A by RLAFFIN1:1;
then ( F . a ) in A by A4,A9,A17,A22;
then A26: ( F . a ) = a by A25,TARSKI:def 1;
A27: XX c= { A }
proof
let x;
assume x in XX;
then consider S being (Simplex of ( 0 ),CA) such that A28: x = S and ( F .: S ) = A by A3,A19,A22;
A29: S in (the topology of CA) by PRE_TOPC:def 2;
( card S ) = ( Z + 1 ) by A21,SIMPLEX0:def 18
.= 1 by XXREAL_3:4;
then S = A by A3,A16,A19,A29,CARD_FIN:1;
hence thesis by A28,TARSKI:def 1;
end;
( F .: A ) = ( Im (F,a) ) by A25,RELAT_1:def 16
.= A by A4,A17,A23,A25,A26,FUNCT_1:59;
then A in XX by A3,A19,A24,A22;
then XX = { A } by A27,ZFMISC_1:33;
hence thesis by CARD_1:30;
end;
suppose A30: m > ( 0 );

defpred P[ set,set ]
 means
$1 c= $2;
set XXA = { S where S is (Simplex of ( m - 1 ),( BCS (k,CA) )): (( F .: S ) = Aa & ( conv ( @ S ) ) misses ( Int A )) };
reconsider m1 = ( m - 1 ) as  ext-real number;
reconsider M = m as  ext-real number;
reconsider cA = ( card A ) as  ext-real number;
set YA = { S where S is (Simplex of m,( BCS (k,CA) )): Aa = ( F .: S ) };
A31: YA c= (the topology of ( BCS (k,CA) ))
proof
let x;
assume x in YA;
then (ex S being (Simplex of m,( BCS (k,CA) )) st (S = x & Aa = ( F .: S )));
hence thesis by PRE_TOPC:def 2;
end;
then reconsider YA as (Subset-Family of ( BCS (k,CA) )) by XBOOLE_1:1;
reconsider YA as  simplex-like (Subset-Family of ( BCS (k,CA) )) by A31,SIMPLEX0:14;
defpred P1[ set,set ]
 means
$2 c= $1;
set Xm1 = { S where S is (Simplex of ( m - 1 ),( BCS (k,CA) )): Aa = ( F .: S ) };
set Xm = { S where S is (Simplex of m,( BCS (k,CA) )): (not contradiction) };
consider R1 being Relation such that A32: (for x holds (for y holds ([ x,y ] in R1 iff ((x in Xm & y in Xm1) & P1[ x,y ])))) from RELAT_1:sch 1;
set DY = ( ( dom R1 ) \ YA );
A33: DY c= XX
proof
let x;
assume A34: x in DY;
then consider y such that A35: [ x,y ] in R1 by RELAT_1:def 4;
x in Xm by A32,A35;
then consider S being (Simplex of m,( BCS (k,CA) )) such that A36: x = S and (not contradiction);
(not x in YA) by A34,XBOOLE_0:def 5;
then A37: ( F .: S ) <> Aa by A36;
y in Xm1 by A32,A35;
then A38: (ex W being (Simplex of ( m - 1 ),( BCS (k,CA) )) st (y = W & Aa = ( F .: W )));
y c= x by A32,A35;
then Aa c= ( F .: S ) by A36,A38,RELAT_1:123;
then Aa c< ( F .: S ) by A37,XBOOLE_0:def 8;
then m < ( card ( F .: S ) ) by A5,CARD_2:48;
then A39: ( m + 1 ) <= ( card ( F .: S ) ) by NAT_1:13;
( card ( F .: S ) ) <= ( m + 1 ) by A3,NAT_1:43;
then ( F .: S ) = A by A3,A39,CARD_FIN:1,XXREAL_0:1;
hence thesis by A3,A36;
end;
set RDY = ( R1 | DY );
A40: ( RDY | ( ( dom RDY ) \ DY ) ) = ( {} )
proof
assume ( RDY | ( ( dom RDY ) \ DY ) ) <> ( {} );
then consider xy being set such that A41: xy in ( RDY | ( ( dom RDY ) \ DY ) ) by XBOOLE_0:def 1;
consider x,y such that A42: xy = [ x,y ] by A41,RELAT_1:def 1;
A43: x in ( ( dom RDY ) \ DY ) by A41,A42,RELAT_1:def 11;
then (( dom RDY ) c= DY & x in ( dom RDY )) by RELAT_1:58;
hence contradiction by A43,XBOOLE_0:def 5;
end;
A44: ( 2 *` ( card YA ) ) = ( ( card 2 ) *` ( card ( card YA ) ) ) by CKB36:1
.= ( card ( 2 * ( card YA ) ) ) by CARD_2:39;
A45: ( 2 * ( card YA ) ) in ( NAT ) by ORDINAL1:def 12;
( cA - 1 ) = ( ( m + 1 ) + ( - 1 ) ) by A3,XXREAL_3:def 2;
then A46: ( degree CA ) = m by SIMPLEX0:26;
consider R being Relation such that A47: (for x holds (for y holds ([ x,y ] in R iff ((x in Xm1 & y in Xm) & P[ x,y ])))) from RELAT_1:sch 1;
A48: ( card R ) = ( card R1 )
proof
deffunc F(set) = [ ( $1 `2 ),( $1 `1 ) ];
A49: (for x holds (x in R implies F(x) in R1))
proof
let z being set;
assume A50: z in R;
then (ex x st (ex y st z = [ x,y ])) by RELAT_1:def 1;
then A51: z = [ ( z `1 ),( z `2 ) ] by MCART_1:8;
then A52: ( z `2 ) in Xm by A47,A50;
(P[ ( z `1 ),( z `2 ) ] & ( z `1 ) in Xm1) by A47,A50,A51;
hence thesis by A32,A52;
end;
consider f being (Function of R,R1) such that A53: (for x holds (x in R implies ( f . x ) = F(x))) from FUNCT_2:sch 2(A49);
per cases ;
suppose A54: R1 is  empty;

R is  empty
proof
assume R is non  empty;
then (ex x st x in R) by XBOOLE_0:def 1;
hence thesis by A49,A54;
end;
hence thesis by A54;
end;
suppose R1 is non  empty;

then A55: ( dom f ) = R by FUNCT_2:def 1;
R1 c= ( rng f )
proof
let z being set;
assume A56: z in R1;
then (ex x st (ex y st z = [ x,y ])) by RELAT_1:def 1;
then A57: z = [ ( z `1 ),( z `2 ) ] by MCART_1:8;
then A58: ( z `2 ) in Xm1 by A32,A56;
(P1[ ( z `1 ),( z `2 ) ] & ( z `1 ) in Xm) by A32,A56,A57;
then A59: [ ( z `2 ),( z `1 ) ] in R by A47,A58;
( [ ( z `2 ),( z `1 ) ] `1 ) = ( z `2 ) by MCART_1:7;
then F([ ( z `2 ),( z `1 ) ]) = z by A57,MCART_1:7;
then z = ( f . [ ( z `2 ),( z `1 ) ] ) by A53,A59;
hence thesis by A55,A59,FUNCT_1:def 3;
end;
then A60: ( rng f ) = R1 by XBOOLE_0:def 10;
now
let x1 being set;
let x2 being set;
assume that
A61: x1 in R
and
A62: x2 in R
and
A63: ( f . x1 ) = ( f . x2 );
(( f . x1 ) = F(x1) & ( f . x2 ) = F(x2)) by A53,A61,A62;
then A64: (( x1 `2 ) = ( x2 `2 ) & ( x1 `1 ) = ( x2 `1 )) by A63,ZFMISC_1:27;
A65: (ex x st (ex y st x2 = [ x,y ])) by A62,RELAT_1:def 1;
(ex x st (ex y st x1 = [ x,y ])) by A61,RELAT_1:def 1;
hence x1 = [ ( x2 `1 ),( x2 `2 ) ] by A64,MCART_1:8
.= x2 by A65,MCART_1:8;
end;
then f is  one-to-one by A55,FUNCT_1:def 4;
then R,R1 are_equipotent  by A55,A60,WELLORD2:def 4;
hence thesis by CARD_1:5;
end;
end;
A66: (|. ( BCS (k,CAa) ) .| = |. CAa .| & |. CAa .| = ( conv Aa )) by CKB13:1,CKB16:1;
set DX = ( ( dom R ) \ XXA );
A67: DX c= (the topology of ( BCS (k,CA) ))
proof
let x;
assume x in DX;
then (ex y st [ x,y ] in R) by RELAT_1:def 4;
then x in Xm1 by A47;
then (ex S being (Simplex of ( m - 1 ),( BCS (k,CA) )) st (S = x & Aa = ( F .: S )));
hence thesis by PRE_TOPC:def 2;
end;
set RDX = ( R | DX );
reconsider DX as (Subset-Family of ( BCS (k,CA) )) by A67,XBOOLE_1:1;
reconsider DX as  simplex-like (Subset-Family of ( BCS (k,CA) )) by A67,SIMPLEX0:14;
A68: ( RDX | ( ( dom RDX ) \ DX ) ) = ( {} )
proof
assume ( RDX | ( ( dom RDX ) \ DX ) ) <> ( {} );
then consider xy being set such that A69: xy in ( RDX | ( ( dom RDX ) \ DX ) ) by XBOOLE_0:def 1;
consider x,y such that A70: xy = [ x,y ] by A69,RELAT_1:def 1;
A71: x in ( ( dom RDX ) \ DX ) by A69,A70,RELAT_1:def 11;
then (( dom RDX ) c= DX & x in ( dom RDX )) by RELAT_1:58;
hence contradiction by A71,XBOOLE_0:def 5;
end;
A72: ( m1 + 1 ) = ( ( m - 1 ) + 1 ) by XXREAL_3:def 2
.= m;
set FA = ( F | ( Vertices ( BCS (k,CAa) ) ) );
A73: ( dom FA ) = ( Vertices ( BCS (k,CAa) ) ) by A18,A14,RELAT_1:62,SIMPLEX0:31;
A74: ( Vertices ( BCS (k,CAa) ) ) is non  empty by A5,A6,A8,A30;
A75: (for v being (Vertex of ( BCS (k,CAa) )) holds (for B being (Subset of V) holds ((B c= Aa & v in ( conv B )) implies ( FA . v ) in B)))
proof
let v being (Vertex of ( BCS (k,CAa) ));
let B being (Subset of V);
assume A76: (B c= Aa & v in ( conv B ));
v in ( Vertices ( BCS (k,CAa) ) ) by A74;
then ( F . v ) in B by A9,A12,A15,A76,XBOOLE_1:1;
hence thesis by A73,A74,FUNCT_1:47;
end;
( rng FA ) c= Aa
proof
let y;
assume y in ( rng FA );
then consider x such that A77: x in ( dom FA ) and A78: ( FA . x ) = y by FUNCT_1:def 3;
reconsider v = x as (Element of ( BCS (k,CAa) )) by A73,A77;
v is  vertex-like by A73,A77,SIMPLEX0:def 4;
then consider S being (Subset of ( BCS (k,CAa) )) such that A79: S is  simplex-like and A80: v in S by SIMPLEX0:def 3;
A81: ( conv ( @ S ) ) c= |. ( BCS (k,CAa) ) .| by A79,CKB10:1;
S c= ( conv ( @ S ) ) by RLAFFIN1:2;
then A82: v in ( conv ( @ S ) ) by A80;
x in ( Vertices ( BCS (k,CAa) ) ) by A18,A14,A77,RELAT_1:62,SIMPLEX0:31;
hence thesis by A66,A75,A78,A81,A82;
end;
then reconsider FA as (Function of ( Vertices ( BCS (k,CAa) ) ),Aa) by A73,FUNCT_2:2;
set XXa = { S where S is (Simplex of ( m - 1 ),( BCS (k,CAa) )): ( FA .: S ) = Aa };
consider n such that A83: ( card XXa ) = ( ( 2 * n ) + 1 ) by A2,A5,A75;
A84: (( m - 1 ) <= ( m - ( 0 ) ) & ( - 1 ) <= ( m + ( - 1 ) )) by XREAL_1:10,XREAL_1:31;
A85: (for x holds (x in XXA implies ( card ( Im (R,x) ) ) = 1))
proof
let x;
assume x in XXA;
then consider S being (Simplex of ( m - 1 ),( BCS (k,CA) )) such that A86: x = S and A87: ( F .: S ) = Aa and A88: ( conv ( @ S ) ) misses ( Int A );
set XX = { S1 where S1 is (Simplex of m,( BCS (k,CA) )): S c= S1 };
A89: ( R .: { S } ) c= XX
proof
let w being set;
assume w in ( R .: { S } );
then consider s being set such that A90: [ s,w ] in R and A91: s in { S } by RELAT_1:def 13;
w in Xm by A47,A90;
then A92: (ex W being (Simplex of m,( BCS (k,CA) )) st (w = W & (not contradiction)));
(s = S & s c= w) by A47,A90,A91,TARSKI:def 1;
hence thesis by A92;
end;
XX c= ( R .: { S } )
proof
let w being set;
assume w in XX;
then consider W being (Simplex of m,( BCS (k,CA) )) such that A93: w = W and A94: S c= W;
(W in Xm & S in Xm1) by A87;
then (S in { S } & [ S,W ] in R) by A47,A94,TARSKI:def 1;
hence thesis by A93,RELAT_1:def 13;
end;
then A95: ( R .: { S } ) = XX by A89,XBOOLE_0:def 10;
( card XX ) = 1 by A3,A88,CKB77:1;
hence thesis by A86,A95,RELAT_1:def 16;
end;
A96: ( degree CA ) = ( degree ( BCS (k,CA) ) ) by A11,CKB63:1;
A97: ( M + 1 ) = ( m + 1 ) by XXREAL_3:def 2;
A98: (for x holds (x in YA implies ( card ( Im (R1,x) ) ) = 2))
proof
let x;
assume x in YA;
then consider S being (Simplex of m,( BCS (k,CA) )) such that A99: x = S and A100: Aa = ( F .: S );
set FS = ( F | S );
A101: ( rng FS ) = Aa by A100,RELAT_1:115;
A102: Aa is non  empty by A5,A30;
A103: S in { x } by A99,TARSKI:def 1;
A104: ( dom FS ) = S by A18,RELAT_1:62,SIMPLEX0:17;
A105: ( card S ) = ( m + 1 ) by A96,A46,A97,SIMPLEX0:def 18;
reconsider FS as (Function of S,Aa) by A101,A104,FUNCT_2:1;
FS is  onto by A101,FUNCT_2:def 3;
then consider b being set such that A106: b in Aa and A107: ( card ( FS " { b } ) ) = 2 and A108: (for x holds ((x in Aa & x <> b) implies ( card ( FS " { x } ) ) = 1)) by A5,A102,A105,CKB2:1;
consider a1,a2 being set such that A109: a1 <> a2 and A110: ( FS " { b } ) = { a1,a2 } by A107,CARD_2:60;
reconsider S1 = ( S \ { a1 } ),S2 = ( S \ { a2 } ) as (Simplex of ( BCS (k,CA) ));
A111: a1 in { a1,a2 } by TARSKI:def 2;
then A112: a1 in S2 by A109,A110,ZFMISC_1:56;
A113: ( card S1 ) = m by A105,A110,A111,STIRL2_1:55;
A114: a2 in { a1,a2 } by TARSKI:def 2;
then A115: ( card S2 ) = m by A105,A110,STIRL2_1:55;
then reconsider S1,S2 as (Simplex of ( m - 1 ),( BCS (k,CA) )) by A96,A84,A72,A46,A113,SIMPLEX0:def 18;
A116: { a1 } c= S by A110,A111,ZFMISC_1:31;
A117: ( FS . a2 ) = ( F . a2 ) by A104,A110,A114,FUNCT_1:47;
A118: { a2 } c= S by A110,A114,ZFMISC_1:31;
A119: ( R1 .: { x } ) c= { S1,S2 }
proof
let Y being set;
assume Y in ( R1 .: { x } );
then consider X being set such that A120: [ X,Y ] in R1 and A121: X in { x } by RELAT_1:def 13;
Y in Xm1 by A32,A120;
then consider W being (Simplex of ( m - 1 ),( BCS (k,CA) )) such that A122: Y = W and A123: Aa = ( F .: W );
X = x by A121,TARSKI:def 1;
then W c= S by A32,A99,A120,A122;
then A124: Aa = ( FS .: W ) by A123,RELAT_1:129;
then consider w being set such that A125: w in ( dom FS ) and A126: w in W and A127: ( FS . w ) = b by A106,FUNCT_1:def 6;
A128: { w } c= W by A126,ZFMISC_1:31;
A129: ( S \ { a1,a2 } ) c= W
proof
let s being set;
assume A130: s in ( S \ { a1,a2 } );
then A131: s in ( dom FS ) by A104,XBOOLE_0:def 5;
then A132: ( FS . s ) in Aa by A101,FUNCT_1:def 3;
then consider w being set such that A133: w in ( dom FS ) and A134: w in W and A135: ( FS . w ) = ( FS . s ) by A124,FUNCT_1:def 6;
(not s in ( FS " { b } )) by A110,A130,XBOOLE_0:def 5;
then (not ( FS . s ) in { b }) by A131,FUNCT_1:def 7;
then ( FS . s ) <> b by TARSKI:def 1;
then ( card ( FS " { ( FS . s ) } ) ) = 1 by A108,A132;
then consider z being set such that A136: ( FS " { ( FS . s ) } ) = { z } by CARD_2:42;
A137: ( FS . s ) in { ( FS . s ) } by TARSKI:def 1;
then A138: s in ( FS " { ( FS . s ) } ) by A131,FUNCT_1:def 7;
w in ( FS " { ( FS . s ) } ) by A133,A135,A137,FUNCT_1:def 7;
then w = z by A136,TARSKI:def 1;
hence thesis by A134,A136,A138,TARSKI:def 1;
end;
b in { b } by TARSKI:def 1;
then A139: w in ( FS " { b } ) by A125,A127,FUNCT_1:def 7;
A140: ( card W ) = m by A96,A84,A72,A46,SIMPLEX0:def 18;
A141: ( S /\ { a1 } ) = { a1 } by A116,XBOOLE_1:28;
A142: ( S /\ { a2 } ) = { a2 } by A118,XBOOLE_1:28;
per cases  by A110,A139,TARSKI:def 2;
suppose w = a1;

then ( ( S \ { a1,a2 } ) \/ { w } ) = ( S \ ( { a1,a2 } \ { a1 } ) ) by A141,XBOOLE_1:52
.= S2 by A109,ZFMISC_1:17;
then S2 = W by A115,A128,A129,A140,CARD_FIN:1,XBOOLE_1:8;
hence thesis by A122,TARSKI:def 2;
end;
suppose w = a2;

then ( ( S \ { a1,a2 } ) \/ { w } ) = ( S \ ( { a1,a2 } \ { a2 } ) ) by A142,XBOOLE_1:52
.= S1 by A109,ZFMISC_1:17;
then S1 = W by A113,A128,A129,A140,CARD_FIN:1,XBOOLE_1:8;
hence thesis by A122,TARSKI:def 2;
end;
end;
A143: S c= ( dom F ) by A18,SIMPLEX0:17;
A144: ( FS . a1 ) = ( F . a1 ) by A104,A110,A111,FUNCT_1:47;
A145: ( FS . a1 ) in { b } by A110,A111,FUNCT_1:def 7;
then A146: ( FS . a1 ) = b by TARSKI:def 1;
A147: ( FS . a2 ) in { b } by A110,A114,FUNCT_1:def 7;
then A148: ( FS . a2 ) = b by TARSKI:def 1;
A149: (a2 in S & a2 in S1) by A109,A110,A114,ZFMISC_1:56;
A150: Aa c= ( F .: S1 )
proof
let z being set;
assume A151: z in Aa;
per cases ;
suppose A152: z = b;

( FS . a2 ) in ( F .: S1 ) by A143,A117,A149,FUNCT_1:def 6;
hence thesis by A147,A152,TARSKI:def 1;
end;
suppose A153: z <> b;

consider c being set such that A154: c in ( dom F ) and A155: c in S and A156: z = ( F . c ) by A100,A151,FUNCT_1:def 6;
c in S1 by A144,A146,A153,A155,A156,ZFMISC_1:56;
hence thesis by A154,A156,FUNCT_1:def 6;
end;
end;
A157: S in Xm;
A158: (a1 in S & a1 in S2) by A109,A110,A111,ZFMISC_1:56;
A159: Aa c= ( F .: S2 )
proof
let z being set;
assume A160: z in Aa;
per cases ;
suppose A161: z = b;

( FS . a1 ) in ( F .: S2 ) by A144,A143,A158,FUNCT_1:def 6;
hence thesis by A145,A161,TARSKI:def 1;
end;
suppose A162: z <> b;

consider c being set such that A163: c in ( dom F ) and A164: c in S and A165: z = ( F . c ) by A100,A160,FUNCT_1:def 6;
c in S2 by A117,A148,A162,A164,A165,ZFMISC_1:56;
hence thesis by A163,A165,FUNCT_1:def 6;
end;
end;
( F .: S1 ) c= Aa by A100,RELAT_1:123,XBOOLE_1:36;
then Aa = ( F .: S1 ) by A150,XBOOLE_0:def 10;
then (( S \ { a1 } ) c= S & S1 in Xm1) by XBOOLE_1:36;
then [ S,S1 ] in R1 by A32,A157;
then A166: S1 in ( R1 .: { x } ) by A103,RELAT_1:def 13;
( F .: S2 ) c= Aa by A100,RELAT_1:123,XBOOLE_1:36;
then Aa = ( F .: S2 ) by A159,XBOOLE_0:def 10;
then (( S \ { a2 } ) c= S & S2 in Xm1) by XBOOLE_1:36;
then [ S,S2 ] in R1 by A32,A157;
then S2 in ( R1 .: { x } ) by A103,RELAT_1:def 13;
then { S1,S2 } c= ( R1 .: { x } ) by A166,ZFMISC_1:32;
then A167: ( R1 .: { x } ) = { S1,S2 } by A119,XBOOLE_0:def 10;
S1 <> S2 by A112,ZFMISC_1:56;
then ( card ( R1 .: { x } ) ) = 2 by A167,CARD_2:57;
hence thesis by RELAT_1:def 16;
end;
A168: ( M - 1 ) = ( m + ( - 1 ) ) by XXREAL_3:def 2;
XX c= DY
proof
let x;
assume x in XX;
then consider S being (Simplex of m,( BCS (k,CA) )) such that A169: x = S and A170: ( F .: S ) = A by A3;
set FS = ( F | S );
A171: ( rng FS ) = A by A170,RELAT_1:115;
A172: ( card A ) = ( card S ) by A3,A96,A46,A97,SIMPLEX0:def 18;
A173: ( dom FS ) = S by A18,RELAT_1:62,SIMPLEX0:17;
then reconsider FS as (Function of S,A) by A171,FUNCT_2:1;
consider s being set such that A174: (s in ( dom FS ) & ( FS . s ) = a) by A4,A171,FUNCT_1:def 3;
set Ss = ( S \ { s } );
FS is  onto by A171,FUNCT_2:def 3;
then A175: FS is  one-to-one by A172,STIRL2_1:60;
then A176: ( FS .: Ss ) = ( ( FS .: S ) \ ( FS .: { s } ) ) by FUNCT_1:64
.= ( A \ ( FS .: { s } ) ) by A171,A173,RELAT_1:113
.= ( A \ ( Im (FS,s) ) ) by RELAT_1:def 16
.= Aa by A174,FUNCT_1:59;
Ss,( FS .: Ss ) are_equipotent  by A173,A175,CARD_1:33,XBOOLE_1:36;
then A177: ( card Ss ) = m by A5,A176,CARD_1:5;
reconsider Ss as (Simplex of ( BCS (k,CA) ));
reconsider Ss as (Simplex of ( m - 1 ),( BCS (k,CA) )) by A168,A177,SIMPLEX0:48;
( FS .: Ss ) = ( F .: Ss ) by RELAT_1:129,XBOOLE_1:36;
then A178: Ss in Xm1 by A176;
(Ss c= S & S in Xm) by XBOOLE_1:36;
then [ S,Ss ] in R1 by A32,A178;
then A179: S in ( dom R1 ) by RELAT_1:def 4;
(for W being (Simplex of m,( BCS (k,CA) )) holds (S = W implies Aa <> ( F .: W ))) by A4,A170,ZFMISC_1:56;
then (not S in YA);
hence thesis by A169,A179,XBOOLE_0:def 5;
end;
then A180: DY = XX by A33,XBOOLE_0:def 10;
(for x holds (x in DY implies ( card ( Im (RDY,x) ) ) = 1))
proof
let x;
assume A181: x in DY;
then consider y such that A182: [ x,y ] in R1 by RELAT_1:def 4;
A183: (ex W being (Simplex of m,( BCS (k,CA) )) st (x = W & ( F .: W ) = A)) by A3,A180,A181;
x in Xm by A32,A182;
then consider S being (Simplex of m,( BCS (k,CA) )) such that A184: x = S and (not contradiction);
y in Xm1 by A32,A182;
then consider W being (Simplex of ( m - 1 ),( BCS (k,CA) )) such that A185: y = W and A186: Aa = ( F .: W );
A187: ( card S ) = ( m + 1 ) by A96,A46,A97,SIMPLEX0:def 18;
A188: ( RDY .: { x } ) c= { y }
proof
let u being set;
set FS = ( F | S );
assume u in ( RDY .: { x } );
then consider s being set such that A189: [ s,u ] in RDY and A190: s in { x } by RELAT_1:def 13;
A191: [ s,u ] in R1 by A189,RELAT_1:def 11;
then u in Xm1 by A32;
then consider U being (Simplex of ( m - 1 ),( BCS (k,CA) )) such that A192: u = U and A193: Aa = ( F .: U );
A194: ( dom FS ) = S by A18,RELAT_1:62,SIMPLEX0:17;
A195: ( rng FS ) = A by A183,A184,RELAT_1:115;
then reconsider FS as (Function of S,A) by A194,FUNCT_2:1;
A196: W c= S by A32,A182,A184,A185;
then A197: ( FS .: W ) = ( F .: W ) by RELAT_1:129;
s = S by A184,A190,TARSKI:def 1;
then A198: U c= S by A32,A191,A192;
then A199: ( FS .: U ) = ( F .: U ) by RELAT_1:129;
FS is  onto by A195,FUNCT_2:def 3;
then A200: FS is  one-to-one by A3,A187,STIRL2_1:60;
then A201: U c= W by A186,A193,A194,A197,A198,A199,FUNCT_1:87;
W c= U by A186,A193,A194,A196,A197,A199,A200,FUNCT_1:87;
then u = y by A185,A192,A201,XBOOLE_0:def 10;
hence thesis by TARSKI:def 1;
end;
(x in { x } & [ x,y ] in RDY) by A181,A182,RELAT_1:def 11,TARSKI:def 1;
then y in ( RDY .: { x } ) by RELAT_1:def 13;
then ( RDY .: { x } ) = { y } by A188,ZFMISC_1:33;
then ( Im (RDY,x) ) = { y } by RELAT_1:def 16;
hence thesis by CARD_1:30;
end;
then ( card RDY ) = ( ( card ( {} ) ) +` ( 1 *` ( card DY ) ) ) by A40,CKB1:1
.= ( 1 *` ( card DY ) ) by CARD_2:18
.= ( card DY ) by CARD_2:21;
then A202: ( card R1 ) = ( ( card ( card XX ) ) +` ( card ( 2 * ( card YA ) ) ) ) by A44,A98,A180,CKB1:1
.= ( card ( ( card XX ) + ( 2 * ( card YA ) ) ) ) by A45,CARD_2:38
.= ( ( card XX ) + ( 2 * ( card YA ) ) ) by CKB36:1;
A203: (|. ( BCS (k,CA) ) .| = |. CA .| & |. CA .| = ( conv A )) by CKB13:1,CKB16:1;
A204: XXA c= XXa
proof
let x;
assume x in XXA;
then consider S being (Simplex of ( m - 1 ),( BCS (k,CA) )) such that A205: x = S and A206: ( F .: S ) = Aa and A207: ( conv ( @ S ) ) misses ( Int A );
( conv ( @ S ) ) c= ( conv A ) by A203,CKB10:1;
then consider B being (Subset of V) such that A209: B c< A and A210: ( conv ( @ S ) ) c= ( conv B ) by A4,A207,RLAFFIN2:23;
A211: B c= A by A209,XBOOLE_0:def 8;
then reconsider B as  finite (Subset of V);
( card B ) < ( m + 1 ) by A3,A209,CARD_2:48;
then A212: ( card B ) <= m by NAT_1:13;
A213: Aa c= B
proof
let y;
assume y in Aa;
then consider v being set such that A214: v in ( dom F ) and A215: v in S and A216: ( F . v ) = y by A206,FUNCT_1:def 6;
S c= ( conv ( @ S ) ) by RLAFFIN1:2;
then v in ( conv ( @ S ) ) by A215;
hence thesis by A9,A210,A211,A214,A216;
end;
then ( card Aa ) <= ( card B ) by NAT_1:43;
then A217: Aa = B by A5,A212,A213,CARD_FIN:1,XXREAL_0:1;
A218: (the topology of ( BCS (k,CAa) )) c= (the topology of ( BCS (k,CA) )) by A14,SIMPLEX0:def 13;
A219: ( card S ) = m by A96,A84,A72,A46,SIMPLEX0:def 18;
then S is non  empty by A30;
then A220: ( ( center_of_mass V ) . S ) in ( Int ( @ S ) ) by RLAFFIN2:20;
( Int ( @ S ) ) c= ( conv ( @ S ) ) by RLAFFIN2:5;
then ( ( center_of_mass V ) . S ) in ( conv ( @ S ) ) by A220;
then consider w being (Subset of ( BCS (k,CAa) )) such that A221: w is  simplex-like and A222: ( ( center_of_mass V ) . S ) in ( conv ( @ w ) ) by A66,A210,A217,CKB8:def 1;
w in (the topology of ( BCS (k,CAa) )) by A221,PRE_TOPC:def 2;
then w in (the topology of ( BCS (k,CA) )) by A218;
then reconsider W = w as (Simplex of ( BCS (k,CA) )) by PRE_TOPC:def 2;
( Int ( @ S ) ) meets ( conv ( @ W ) ) by A220,A222,XBOOLE_0:3;
then A223: S c= w by CKB52:1;
then reconsider s = S as (Subset of ( BCS (k,CAa) )) by XBOOLE_1:1;
reconsider s as (Simplex of ( BCS (k,CAa) )) by A221,A223,MATROID0:1;
A224: ( FA .: s ) = Aa by A206,RELAT_1:129,SIMPLEX0:17;
s is (Simplex of ( m - 1 ),( BCS (k,CAa) )) by A168,A219,SIMPLEX0:48;
hence thesis by A205,A224;
end;
A225: ( degree CAa ) = ( m - 1 ) by A5,A168,SIMPLEX0:26;
XXa c= XXA
proof
A <> Aa by A3,A5;
then A226: Aa c< A by A12,XBOOLE_0:def 8;
let x;
assume x in XXa;
then consider S being (Simplex of ( m - 1 ),( BCS (k,CAa) )) such that A227: x = S and A228: ( FA .: S ) = Aa;
( m - 1 ) <= ( degree ( BCS (k,CAa) ) ) by A7,A225,CKB63:1;
then reconsider S1 = x as (Simplex of ( m - 1 ),( BCS (k,CA) )) by A14,A227,SIMPLEX0:49;
A229: ( FA .: S ) = ( F .: S ) by RELAT_1:129,SIMPLEX0:17;
( conv ( @ S ) ) c= ( conv Aa ) by A66,CKB10:1;
then ( conv ( @ S1 ) ) misses ( Int A ) by A226,A227,RLAFFIN2:7,XBOOLE_1:63;
hence thesis by A227,A228,A229;
end;
then A230: XXa = XXA by A204,XBOOLE_0:def 10;
A231: (( ( 2 * n ) + 1 ) in ( NAT ) & ( 2 * ( card DX ) ) in ( NAT )) by ORDINAL1:def 12;
(for x holds (x in DX implies ( card ( Im (RDX,x) ) ) = 2))
proof
let x;
assume A232: x in DX;
then (ex y st [ x,y ] in R) by RELAT_1:def 4;
then A233: x in Xm1 by A47;
then consider S being (Simplex of ( m - 1 ),( BCS (k,CA) )) such that A234: x = S and A235: Aa = ( F .: S );
set XX = { S1 where S1 is (Simplex of m,( BCS (k,CA) )): S c= S1 };
(not x in XXA) by A232,XBOOLE_0:def 5;
then ( conv ( @ S ) ) meets ( Int A ) by A234,A235;
then A236: ( card XX ) = 2 by A3,CKB77:1;
A237: ( RDX .: { S } ) c= XX
proof
let w being set;
assume w in ( RDX .: { S } );
then consider s being set such that A238: [ s,w ] in RDX and A239: s in { S } by RELAT_1:def 13;
A240: [ s,w ] in R by A238,RELAT_1:def 11;
then w in Xm by A47;
then A241: (ex W being (Simplex of m,( BCS (k,CA) )) st (w = W & (not contradiction)));
s = S by A239,TARSKI:def 1;
then S c= w by A47,A240;
hence thesis by A241;
end;
XX c= ( RDX .: { S } )
proof
let w being set;
assume w in XX;
then consider W being (Simplex of m,( BCS (k,CA) )) such that A242: w = W and A243: S c= W;
W in Xm;
then [ S,W ] in R by A47,A233,A234,A243;
then A244: [ S,W ] in RDX by A232,A234,RELAT_1:def 11;
S in { S } by TARSKI:def 1;
hence thesis by A242,A244,RELAT_1:def 13;
end;
then XX = ( RDX .: { S } ) by A237,XBOOLE_0:def 10;
hence thesis by A234,A236,RELAT_1:def 16;
end;
then ( card RDX ) = ( ( card ( RDX | ( ( dom RDX ) \ DX ) ) ) +` ( 2 *` ( card DX ) ) ) by CKB1:1
.= ( ( 0 ) +` ( 2 *` ( card DX ) ) ) by A68
.= ( 2 *` ( card DX ) ) by CARD_2:18;
then A245: ( card R ) = ( ( 2 *` ( card DX ) ) +` ( 1 *` ( card XXA ) ) ) by A85,CKB1:1
.= ( ( 2 *` ( card DX ) ) +` ( ( 2 * n ) + 1 ) ) by A83,A230,CARD_2:21
.= ( ( ( card 2 ) *` ( card ( card DX ) ) ) +` ( ( 2 * n ) + 1 ) ) by CKB36:1
.= ( ( card ( 2 * ( card DX ) ) ) +` ( ( 2 * n ) + 1 ) ) by CARD_2:39
.= ( ( card ( 2 * ( card DX ) ) ) +` ( card ( ( 2 * n ) + 1 ) ) ) by CKB36:1
.= ( card ( ( 2 * ( card DX ) ) + ( ( 2 * n ) + 1 ) ) ) by A231,CARD_2:38
.= ( ( 2 * ( card DX ) ) + ( ( 2 * n ) + 1 ) ) by CKB36:1;
then ( card XX ) = ( ( 2 * ( ( ( card DX ) + n ) - ( card YA ) ) ) + 1 ) by A48,A202;
then ( 2 * ( ( ( card DX ) + n ) - ( card YA ) ) ) >= ( - 1 ) by INT_1:7;
then ( ( ( card DX ) + n ) - ( card YA ) ) >= ( ( - 1 ) / 2 ) by XREAL_1:79;
then ( ( ( card DX ) + n ) - ( card YA ) ) > ( - 1 ) by XXREAL_0:2;
then ( ( ( card DX ) + n ) - ( card YA ) ) >= ( 0 ) by INT_1:8;
then reconsider cnc = ( ( ( card DX ) + n ) - ( card YA ) ) as (Element of ( NAT )) by INT_1:3;
take cnc;
thus thesis by A48,A202,A245;
end;
end;
A246: P[ (( 0 ) qua Nat) ]
proof
let A being  finite  affinely-independent (Subset of V);
assume that
A247: ( card A ) = ( 0 );
A248: A = ( {} ) by A247;
set C = ( Complex_of { A } );
A249: (|. C .| c= ( [#] V ) & ( [#] C ) = ( [#] V ));
let F being (Function of ( Vertices ( BCS (k,C) ) ),A);
assume that
(for v being (Vertex of ( BCS (k,C) )) holds (for B being (Subset of V) holds ((B c= A & v in ( conv B )) implies ( F . v ) in B)));
set X = { S where S is (Simplex of ( ( card A ) - 1 ),( BCS (k,C) )): ( F .: S ) = A };
take ( 0 );
A250: (k = ( 0 ) or k > ( 0 ));
A251: ( Z - 1 ) = ( - 1 ) by XXREAL_3:4;
then ( degree C ) = ( - 1 ) by A247,SIMPLEX0:26;
then A252: C = ( BCS (k,C) ) by A249,A250,CKB28:1,CKB34:1;
A253: (the topology of C) = ( bool A ) by SIMPLEX0:4;
A254: X c= { A }
proof
let x;
assume that
A255: x in X;
consider S being (Simplex of ( ( card A ) - 1 ),( BCS (k,C) )) such that A256: S = x and ( F .: S ) = A by A255;
S in (the topology of C) by A252,PRE_TOPC:def 2;
then S is  empty by A248,A253;
hence thesis by A248,A256,TARSKI:def 1;
end;
A in ( bool A ) by ZFMISC_1:def 1;
then reconsider A1 = A as (Simplex of C) by A253,PRE_TOPC:def 2;
A257: ( F .: A1 ) = A by A248;
A1 is (Simplex of ( - 1 ),C) by A247,A251,SIMPLEX0:48;
then A in X by A247,A252,A257;
then X = { A } by A254,ZFMISC_1:33;
hence thesis by CARD_1:30;
end;
(for k holds P[ k ]) from NAT_1:sch 2(A246,A1);
hence thesis;
end;
