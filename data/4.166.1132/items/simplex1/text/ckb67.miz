environ
vocabularies ARYTM_1,ARYTM_3,XBOOLE_0,CARD_1,CARD_2,CLASSES1,COHSP_1,COMPLEX1,CONVEX1,CONVEX2,CONVEX3,FINSEQ_1,FINSET_1,FUNCT_1,MATROID0,MCART_1,ORDERS_1,PARTFUN1,PRE_TOPC,QC_LANG1,RELAT_1,RLVECT_1,RLVECT_2,SEMI_AF1,SETFAM_1,SGRAPH1,SUBSET_1,TARSKI,TOPS_1,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,SIMPLEX1,REAL_1,FUNCOP_1,NAT_1,FUNCT_2,STRUCT_0,XXREAL_0,NUMBERS,ORDINAL1,CARD_3,GLIB_000,FINSEQ_4;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,NUMBERS,NAT_1,XXREAL_3,XXREAL_0,ORDERS_1,CARD_1,REAL_1,FINSET_1,SETFAM_1,DOMAIN_1,RELAT_1,FUNCT_1,FUNCT_2,RELSET_1,FINSEQ_1,STRUCT_0,CLASSES1,RVSUM_1,RLVECT_1,RLVECT_2,CONVEX1,CONVEX2,CONVEX3,PRE_TOPC,RLAFFIN1,FUNCOP_1,PENCIL_1,MATROID0,MCART_1,CARD_2,COHSP_1,SIMPLEX0,RLAFFIN2,CKB3,CKB4,CKB5,CKB6,CKB8,CKB15,CKB23,CKB26,CKB27,CKB40,CKB41;
definitions MATROID0,ORDERS_1,ORDINAL1,RLAFFIN2,RLVECT_2,SETFAM_1,STRUCT_0,SIMPLEX0,TARSKI,TOPS_2,XBOOLE_0,XXREAL_3,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
theorems BORSUK_5,CARD_1,CARD_2,CARD_FIN,CLASSES1,COHSP_1,CONVEX1,CONVEX3,FINSEQ_1,FINSEQ_3,FUNCOP_1,FUNCT_1,FUNCT_2,INT_1,MATROID0,MCART_1,NAT_1,ORDINAL1,PENCIL_1,PRE_TOPC,RELAT_1,RELSET_2,RLTOPSP1,RLVECT_1,RLVECT_2,RVSUM_1,SETFAM_1,STIRL2_1,TARSKI,TOPS_2,WELLORD2,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,XXREAL_3,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB40,CKB41,CKB50,CKB52,CKB53,CKB54,CKB58,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66;
schemes CLASSES1,FUNCT_1,FUNCT_2,NAT_1,RELAT_1;
registrations CARD_1,FINSET_1,FUNCT_1,MEMBERED,NAT_1,RELAT_1,RLVECT_1,STRUCT_0,SUBSET_1,VALUED_0,XCMPLX_0,XREAL_0,XXREAL_0,XBOOLE_0,RLAFFIN1,SIMPLEX0,FUNCOP_1,INT_1,XXREAL_3,MATROID0,REALSET1,SETFAM_1,COHSP_1,RLAFFIN2,RELSET_1,ZFMISC_1,DILWORTH,RLVECT_2,CKB17,CKB22,CKB25,CKB38,CKB39,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB51,CKB55,CKB56,CKB57,CKB59,CKB60;
constructors BINOP_2,CONVEX1,CONVEX3,REAL_1,RVSUM_1,SEQ_1,SETFAM_1,RLAFFIN1,SIMPLEX0,TOPS_2,LEXBFS,XXREAL_2,BORSUK_1,COHSP_1,CARD_2,REARRAN1,RLAFFIN2,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve n for Nat;
reserve V for RealLinearSpace;
reserve Aff for  finite  affinely-independent (Subset of V);
reserve Sf for  c=-linear  finite  finite-membered (Subset-Family of V);
theorem
Th36: ((Sf is  with_non-empty_elements & ( union Sf ) c= Aff) implies (( ( center_of_mass V ) .: Sf ) is (Simplex of ( ( card ( union Sf ) ) - 1 ),( BCS ( Complex_of { Aff } ) )) iff (for n holds ((( 0 ) < n & n <= ( card ( union Sf ) )) implies (ex x st (x in Sf & ( card x ) = n))))))
proof
reconsider N = ( 0 ) as Nat;
set U = ( union Sf );
assume that
A1: Sf is  with_non-empty_elements
and
A2: ( union Sf ) c= Aff;
set B = ( center_of_mass V );
set C = ( Complex_of { Aff } );
reconsider s = Sf as  c=-linear  finite (Subset-Family of C);
A3: (the topology of C) = ( bool Aff ) by SIMPLEX0:4;
( card U ) c= ( card Aff ) by A2,CARD_1:11;
then ( card U ) <= ( card Aff ) by NAT_1:39;
then A4: (( N - 1 ) <= ( ( card U ) - 1 ) & ( ( card U ) - 1 ) <= ( ( card Aff ) - 1 )) by XREAL_1:9;
(Sf c= ( bool U ) & ( bool U ) c= ( bool Aff )) by A2,ZFMISC_1:67,ZFMISC_1:82;
then A5: s c= (the topology of C) by A3,XBOOLE_1:1;
A6: s is  simplex-like
proof
let a being (Subset of C);
assume a in s;
hence thesis by A5,PRE_TOPC:def 2;
end;
then A7: ( card s ) = ( card ( B .: Sf ) ) by A1,CKB64:1;
( card Sf ) c= ( card U ) by A1,SIMPLEX0:10;
then A8: ( card Sf ) <= ( card U ) by NAT_1:39;
set BC = ( BCS C );
reconsider c = ( card Aff ) as  ext-real number;
A9: ( degree C ) = ( c - 1 ) by SIMPLEX0:26
.= ( ( card Aff ) + ( - 1 ) ) by XXREAL_3:def 2;
A10: |. C .| c= ( [#] C );
then A11: BC = ( subdivision (B,C) ) by CKB26:def 1;
then ( [#] BC ) = ( [#] C ) by SIMPLEX0:def 20;
then reconsider BS = ( B .: Sf ) as (Subset of BC);
A12: ( N - 1 ) <= ( ( card Aff ) - 1 ) by XREAL_1:9;
A13: ( degree BC ) = ( degree C ) by A10,CKB62:1;
thus (( ( center_of_mass V ) .: Sf ) is (Simplex of ( ( card U ) - 1 ),( BCS ( Complex_of { Aff } ) )) implies (for n holds ((( 0 ) < n & n <= ( card U )) implies (ex x st (x in Sf & ( card x ) = n)))))
proof
assume ( B .: Sf ) is (Simplex of ( ( card U ) - 1 ),BC);
then reconsider BS = ( B .: Sf ) as (Simplex of ( ( card U ) - 1 ),BC);
reconsider c1 = ( ( card U ) - 1 ) as  ext-real number;
let n;
reconsider s = Sf as (Subset-Family of U) by ZFMISC_1:82;
defpred P[ Nat ]
 means
($1 < ( card Sf ) implies (ex x being  finite set st (x in Sf & ( card x ) = ( ( card Sf ) - $1 ))));
assume that
A14: ( 0 ) < n
and
A15: n <= ( card U );
A16: ( ( card Sf ) - ( 0 ) ) > ( ( card Sf ) - n ) by A14,XREAL_1:6;
A17: ( card BS ) = ( c1 + 1 ) by A4,A9,A13,SIMPLEX0:def 18
.= ( ( ( card U ) - 1 ) + 1 ) by XXREAL_3:def 2
.= ( card U );
then A18: Sf is non empty by A7,A14,A15;
then consider s1 being (Subset-Family of U) such that A19: s c= s1 and s1 is  with_non-empty_elements  c=-linear and A20: ( card U ) = ( card s1 ) and A21: (for Z being set holds ((Z in s1 & ( card Z ) <> 1) implies (ex x st (x in Z & ( Z \ { x } ) in s1)))) by A1,SIMPLEX0:9,SIMPLEX0:13;
( card U ) = ( card Sf ) by A1,A6,A17,CKB64:1;
then A22: s = s1 by A19,A20,CARD_FIN:1;
A23: (for n holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
let n;
assume that
A24: P[ n ];
assume A25: ( n + 1 ) < ( card Sf );
then consider X being  finite set such that A26: X in Sf and A27: ( card X ) = ( ( card Sf ) - n ) by A24,NAT_1:13;
A28: ( ( n + 1 ) - n ) < ( ( card Sf ) - n ) by A25,XREAL_1:9;
then consider x such that A29: (x in X & ( X \ { x } ) in Sf) by A21,A22,A26,A27;
reconsider C = ( ( card X ) - 1 ) as (Element of ( NAT )) by A27,A28,NAT_1:20;
take ( X \ { x } );
( card X ) = ( C + 1 );
hence thesis by A27,A29,STIRL2_1:55;
end;
A30: P[ (( 0 ) qua Nat) ] by A7,A17,A18,SIMPLEX0:9;
A31: (for n holds P[ n ]) from NAT_1:sch 2(A30,A23);
( ( card Sf ) - n ) is Nat by A7,A15,A17,NAT_1:21;
then (ex x being  finite set st (x in Sf & ( card x ) = ( ( card Sf ) - ( ( card Sf ) - n ) ))) by A16,A31;
hence thesis;
end;

assume A32: (for n holds ((( 0 ) < n & n <= ( card U )) implies (ex x st (x in Sf & ( card x ) = n))));
per cases ;
suppose A33: U is  empty;

reconsider O = ( - 1 ) as  ext-real number;
A34: (O <= ( degree BC ) & ( 0 ) = ( O + 1 )) by A9,A10,A12,CKB62:1,SIMPLEX0:def 12,XXREAL_3:7;
Sf is  empty by A1,A33;
then A35: BS is  empty by RELAT_1:116;
then ( card BS ) = ( 0 );
hence thesis by A33,A34,A35,SIMPLEX0:def 18;
end;
suppose A36: U is non empty;

reconsider c1 = ( ( card U ) - 1 ) as  ext-real number;
consider x such that A37: x in Sf and ( card x ) = ( card U ) by A32,A36;
defpred P[ set,set ]
 means
( card $2 ) = $1;
A38: (for x holds (x in ( Seg ( card U ) ) implies (ex y st (y in Sf & P[ x,y ]))))
proof
let x;
assume that
A39: x in ( Seg ( card U ) );
reconsider n = x as Nat by A39;
(( 0 ) < n & n <= ( card U )) by A39,FINSEQ_1:1;
hence thesis by A32;
end;
consider f being (Function of ( Seg ( card U ) ),Sf) such that A40: (for x holds (x in ( Seg ( card U ) ) implies P[ x,( f . x ) ])) from FUNCT_2:sch 1(A38);
now
let x1 being set,x2 being set;
assume that
A41: x1 in ( dom f )
and
A42: (x2 in ( dom f ) & ( f . x1 ) = ( f . x2 ));
thus x1 = ( card ( f . x1 ) ) by A40,A41
.= x2 by A40,A42;
end;
then A43: (( rng f ) c= Sf & f is  one-to-one) by FUNCT_1:def 4;
( dom f ) = ( Seg ( card U ) ) by A37,FUNCT_2:def 1;
then (( card ( Seg ( card U ) ) ) = ( card U ) & ( card ( Seg ( card U ) ) ) c= ( card Sf )) by A43,CARD_1:10,FINSEQ_1:57;
then ( card U ) <= ( card Sf ) by NAT_1:39;
then A44: ( card BS ) = ( card U ) by A7,A8,XXREAL_0:1;
(BS is (Simplex of BC) & ( c1 + 1 ) = ( ( ( card U ) - 1 ) + 1 )) by A6,A11,SIMPLEX0:def 20,XXREAL_3:def 2;
hence thesis by A4,A9,A13,A44,SIMPLEX0:def 18;
end;
end;
