environ
vocabularies ARYTM_1,ARYTM_3,XBOOLE_0,CARD_1,CARD_2,CLASSES1,COHSP_1,COMPLEX1,CONVEX1,CONVEX2,CONVEX3,FINSEQ_1,FINSET_1,FUNCT_1,MATROID0,MCART_1,ORDERS_1,PARTFUN1,PRE_TOPC,QC_LANG1,RELAT_1,RLVECT_1,RLVECT_2,SEMI_AF1,SETFAM_1,SGRAPH1,SUBSET_1,TARSKI,TOPS_1,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,SIMPLEX1,REAL_1,FUNCOP_1,NAT_1,FUNCT_2,STRUCT_0,XXREAL_0,NUMBERS,ORDINAL1,CARD_3,GLIB_000,FINSEQ_4;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,NUMBERS,NAT_1,XXREAL_3,XXREAL_0,ORDERS_1,CARD_1,REAL_1,FINSET_1,SETFAM_1,DOMAIN_1,RELAT_1,FUNCT_1,FUNCT_2,RELSET_1,FINSEQ_1,STRUCT_0,CLASSES1,RVSUM_1,RLVECT_1,RLVECT_2,CONVEX1,CONVEX2,CONVEX3,PRE_TOPC,RLAFFIN1,FUNCOP_1,PENCIL_1,MATROID0,MCART_1,CARD_2,COHSP_1,SIMPLEX0,RLAFFIN2,CKB3,CKB4,CKB5,CKB6,CKB8,CKB15,CKB23,CKB26,CKB27,CKB40,CKB41;
definitions MATROID0,ORDERS_1,ORDINAL1,RLAFFIN2,RLVECT_2,SETFAM_1,STRUCT_0,SIMPLEX0,TARSKI,TOPS_2,XBOOLE_0,XXREAL_3,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
theorems BORSUK_5,CARD_1,CARD_2,CARD_FIN,CLASSES1,COHSP_1,CONVEX1,CONVEX3,FINSEQ_1,FINSEQ_3,FUNCOP_1,FUNCT_1,FUNCT_2,INT_1,MATROID0,MCART_1,NAT_1,ORDINAL1,PENCIL_1,PRE_TOPC,RELAT_1,RELSET_2,RLTOPSP1,RLVECT_1,RLVECT_2,RVSUM_1,SETFAM_1,STIRL2_1,TARSKI,TOPS_2,WELLORD2,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,XXREAL_3,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB40,CKB41,CKB50,CKB52,CKB53,CKB54,CKB58,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75;
schemes CLASSES1,FUNCT_1,FUNCT_2,NAT_1,RELAT_1;
registrations CARD_1,FINSET_1,FUNCT_1,MEMBERED,NAT_1,RELAT_1,RLVECT_1,STRUCT_0,SUBSET_1,VALUED_0,XCMPLX_0,XREAL_0,XXREAL_0,XBOOLE_0,RLAFFIN1,SIMPLEX0,FUNCOP_1,INT_1,XXREAL_3,MATROID0,REALSET1,SETFAM_1,COHSP_1,RLAFFIN2,RELSET_1,ZFMISC_1,DILWORTH,RLVECT_2,CKB17,CKB22,CKB25,CKB38,CKB39,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB51,CKB55,CKB56,CKB57,CKB59,CKB60;
constructors BINOP_2,CONVEX1,CONVEX3,REAL_1,RVSUM_1,SEQ_1,SETFAM_1,RLAFFIN1,SIMPLEX0,TOPS_2,LEXBFS,XXREAL_2,BORSUK_1,COHSP_1,CARD_2,REARRAN1,RLAFFIN2,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve X for set;
reserve n for Nat;
reserve V for RealLinearSpace;
reserve K for non void  affinely-independent  simplex-join-closed  total (SimplicialComplex of V);
reserve Af for  finite (Subset of V);
theorem
Th44: (for Af holds ((((K is (Subdivision of ( Complex_of { Af } )) & ( card Af ) = ( n + 1 )) & ( degree K ) = n) & (for S being (Simplex of ( n - 1 ),K) holds (for X holds (X = { S1 where S1 is (Simplex of n,K): S c= S1 } implies ((( conv ( @ S ) ) meets ( Int Af ) implies ( card X ) = 2) & (( conv ( @ S ) ) misses ( Int Af ) implies ( card X ) = 1)))))) implies (for S being (Simplex of ( n - 1 ),( BCS K )) holds (for X holds (X = { S1 where S1 is (Simplex of n,( BCS K )): S c= S1 } implies ((( conv ( @ S ) ) meets ( Int Af ) implies ( card X ) = 2) & (( conv ( @ S ) ) misses ( Int Af ) implies ( card X ) = 1)))))))
proof
let A being  finite (Subset of V);
assume that
A1: K is (Subdivision of ( Complex_of { A } ))
and
A2: ( card A ) = ( n + 1 )
and
A3: ( degree K ) = n
and
A4: (for S being (Simplex of ( n - 1 ),K) holds (for X being set holds (X = { S1 where S1 is (Simplex of n,K): S c= S1 } implies ((( conv ( @ S ) ) meets ( Int A ) implies ( card X ) = 2) & (( conv ( @ S ) ) misses ( Int A ) implies ( card X ) = 1)))));
|. ( Complex_of { A } ) .| = ( conv A ) by CKB13:1;
then A5: |. K .| = ( conv A ) by A1,CKB16:1;
A6: K is  finite-degree by A3,SIMPLEX0:def 12;
A7: A is  affinely-independent
proof
consider a being (Subset of K) such that A8: a is  simplex-like and A9: ( card a ) = ( ( degree K ) + 1 ) by A6,SIMPLEX0:def 12;
( conv ( @ a ) ) c= ( conv A ) by A5,A8,CKB10:1;
then A10: ( Affin ( @ a ) ) c= ( Affin A ) by RLAFFIN1:68;
( card A ) = ( card a ) by A2,A3,A9,XXREAL_3:def 2;
hence thesis by A8,A10,RLAFFIN1:80;
end;
set B = ( center_of_mass V );
reconsider Z = ( 0 ) as Nat;
set TK = ( the TopStruct of K );
reconsider n1 = ( n - 1 ) as  ext-real number;
let S being (Simplex of ( n - 1 ),( BCS K ));
let X being set;
assume that
A11: X = { S1 where S1 is (Simplex of n,( BCS K )): S c= S1 };
( [#] K ) = (the carrier of V) by SIMPLEX0:def 10;
then A12: |. K .| c= ( [#] K );
then A13: ( degree K ) = ( degree ( BCS K ) ) by CKB62:1;
then A14: (( n + ( - 1 ) ) >= ( - 1 ) & ( n - 1 ) <= ( degree ( BCS K ) )) by A3,XREAL_1:31,XREAL_1:146;
then A15: ( card S ) = ( n1 + 1 ) by SIMPLEX0:def 18;
then A16: ( card S ) = ( ( n - 1 ) + 1 ) by XXREAL_3:def 2;
A17: ( BCS K ) = ( subdivision (B,K) ) by A12,CKB26:def 1;
per cases ;
suppose A18: n = ( 0 );

then A19: TK = ( BCS K ) by A3,A12,CKB33:1;
then S in (the topology of K) by PRE_TOPC:def 2;
then reconsider s = S as (Simplex of K) by PRE_TOPC:def 2;
reconsider s as (Simplex of ( n - 1 ),K) by A3,A15,A18,SIMPLEX0:def 18;
set XX = { W where W is (Simplex of n,K): s c= W };
A20: ( @ S ) = ( @ s );
then A21: (( conv ( @ S ) ) meets ( Int A ) implies ( card XX ) = 2) by A4;
A22: XX c= X
proof
let x;
assume x in XX;
then consider W being (Simplex of n,K) such that A23: (x = W & S c= W);
W in (the topology of ( BCS K )) by A19,PRE_TOPC:def 2;
then reconsider w = W as (Simplex of ( BCS K )) by PRE_TOPC:def 2;
( card W ) = ( ( degree K ) + 1 ) by A3,SIMPLEX0:def 18;
then w is (Simplex of n,( BCS K )) by A3,A13,SIMPLEX0:def 18;
hence thesis by A11,A23;
end;
A24: X c= XX
proof
let x;
assume x in X;
then consider W being (Simplex of n,( BCS K )) such that A25: (x = W & S c= W) by A11;
W in (the topology of K) by A19,PRE_TOPC:def 2;
then reconsider w = W as (Simplex of K) by PRE_TOPC:def 2;
( card W ) = ( ( degree ( BCS K ) ) + 1 ) by A3,A13,SIMPLEX0:def 18;
then w is (Simplex of n,K) by A3,A13,SIMPLEX0:def 18;
hence thesis by A25;
end;
(( conv ( @ S ) ) misses ( Int A ) implies ( card XX ) = 1) by A4,A20;
hence thesis by A22,A24,A21,XBOOLE_0:def 10;
end;
suppose A26: n > ( 0 );

consider SS being  c=-linear  finite  simplex-like (Subset-Family of K) such that A27: S = ( B .: SS ) by A17,SIMPLEX0:def 20;
( SS \ { ( {} ) } ) c= SS by XBOOLE_1:36;
then reconsider SS1 = ( SS \ { ( {} ) } ) as  c=-linear  finite  simplex-like (Subset-Family of K) by TOPS_2:11;
A28: (SS1 c= ( bool ( @ ( union SS1 ) ) ) & ( bool ( @ ( union SS1 ) ) ) c= ( bool (the carrier of V) )) by ZFMISC_1:67,ZFMISC_1:82;
A29: (not ( {} ) in SS1) by ZFMISC_1:56;
then A30: SS1 is  with_non-empty_elements by SETFAM_1:def 8;
A31: ( dom B ) = ( ( bool (the carrier of V) ) \ { ( {} ) } ) by FUNCT_2:def 1;
then A32: ( SS /\ ( dom B ) ) = ( ( SS /\ ( bool (the carrier of V) ) ) \ { ( {} ) } ) by XBOOLE_1:49
.= ( SS1 /\ ( bool (the carrier of V) ) ) by XBOOLE_1:49
.= SS1 by A28,XBOOLE_1:1,XBOOLE_1:28;
then A33: ( B .: SS ) = ( B .: SS1 ) by RELAT_1:112;
then A34: ( card SS1 ) = n by A16,A27,A30,CKB64:1;
A35: S = ( B .: SS1 ) by A27,A32,RELAT_1:112;
A36: ( card SS1 ) = ( card S ) by A27,A30,A33,CKB64:1;
then A37: SS1 is non empty by A16,A26;
then A38: ( union SS1 ) in SS1 by SIMPLEX0:9;
then reconsider U = ( union SS1 ) as (Simplex of K) by TOPS_2:def 1;
( card SS1 ) c= ( card U ) by A30,SIMPLEX0:10;
then A39: n <= ( card U ) by A16,A36,NAT_1:39;
( card U ) <= ( ( degree K ) + 1 ) by SIMPLEX0:24;
then A40: ( card U ) <= ( n + 1 ) by A3,XXREAL_3:def 2;
A41: ( conv ( @ U ) ) c= ( conv A ) by A5,CKB10:1;
SS1 c= ( bool (the carrier of V) ) by A28,XBOOLE_1:1;
then A42: ( conv ( @ S ) ) c= ( conv ( @ U ) ) by A35,CONVEX1:30,RLAFFIN2:17;
per cases  by A39,A40,NAT_1:9;
suppose A43: ( card U ) = n;

set XX = { W where W is (Simplex of n,K): U c= W };
A44: U is (Simplex of ( n - 1 ),K) by A13,A14,A15,A16,A43,SIMPLEX0:def 18;
hereby
assume ( conv ( @ S ) ) meets ( Int A );
then ( conv ( @ U ) ) meets ( Int A ) by A42,XBOOLE_1:63;
then A45: ( card XX ) = 2 by A4,A44;
then XX is  finite;
then consider w1 being set,w2 being set such that A46: w1 <> w2 and A47: XX = { w1,w2 } by A45,CARD_2:60;
w2 in XX by A47,TARSKI:def 2;
then consider W2 being (Simplex of n,K) such that A48: w2 = W2 and A49: U c= W2;
A50: (SS1 is  with_non-empty_elements & S = ( B .: SS1 )) by A27,A29,A32,RELAT_1:112,SETFAM_1:def 8;
w1 in XX by A47,TARSKI:def 2;
then consider W1 being (Simplex of n,K) such that A51: w1 = W1 and A52: U c= W1;
A53: ( card W1 ) = ( ( degree K ) + 1 ) by A3,SIMPLEX0:def 18;
then A54: ( card W1 ) = ( n + 1 ) by A3,XXREAL_3:def 2;
then { W where W is (Simplex of n,( BCS K )): (S c= W & ( conv ( @ W ) ) c= ( conv ( @ W1 ) )) } = { ( S \/ ( B .: { W1 } ) ) } by A16,A27,A30,A33,A36,A43,A52,CKB74:1;
then ( S \/ ( B .: { W1 } ) ) in { W where W is (Simplex of n,( BCS K )): (S c= W & ( conv ( @ W ) ) c= ( conv ( @ W1 ) )) } by TARSKI:def 1;
then A55: (ex R being (Simplex of n,( BCS K )) st ((R = ( S \/ ( B .: { W1 } ) ) & S c= R) & ( conv ( @ R ) ) c= ( conv ( @ W1 ) )));
A56: ( S \/ ( B .: { W1 } ) ) <> ( S \/ ( B .: { W2 } ) )
proof
(for A being (Subset of K) holds (A in { W1 } implies A is  simplex-like)) by TARSKI:def 1;
then { W1 } is  simplex-like by TOPS_2:def 1;
then A57: ( SS1 \/ { W1 } ) is  simplex-like by TOPS_2:13;
A58: (( S \/ ( B .: { W1 } ) ) = ( B .: ( SS1 \/ { W1 } ) ) & ( S \/ ( B .: { W2 } ) ) = ( B .: ( SS1 \/ { W2 } ) )) by A35,RELAT_1:120;
W1 in { W1 } by TARSKI:def 1;
then A59: W1 in ( SS1 \/ { W1 } ) by XBOOLE_0:def 3;
(for A being (Subset of K) holds (A in { W2 } implies A is  simplex-like)) by TARSKI:def 1;
then { W2 } is  simplex-like by TOPS_2:def 1;
then A60: ( SS1 \/ { W2 } ) is  simplex-like by TOPS_2:13;
assume A61: ( S \/ ( B .: { W1 } ) ) = ( S \/ ( B .: { W2 } ) );
W1 is non empty by A3,A53;
then ( SS1 \/ { W1 } ) c= ( SS1 \/ { W2 } ) by A12,A30,A55,A60,A58,A57,A61,CKB65:1;
then (W1 in SS1 or W1 in { W2 }) by A59,XBOOLE_0:def 3;
then W1 c= U by A46,A48,A51,TARSKI:def 1,ZFMISC_1:74;
then W1 = U by A52,XBOOLE_0:def 10;
hence contradiction by A43,A54;
end;
A62: ( ( card SS1 ) + Z ) <= ( degree K ) by A3,A16,A27,A30,A33,CKB64:1;
A63: X c= { ( S \/ ( B .: { W1 } ) ),( S \/ ( B .: { W2 } ) ) }
proof
let x;
A64: (( n + 1 ) = ( ( degree K ) + 1 ) & n = ( ( ( degree K ) + 1 ) - 1 )) by A3,XXREAL_3:22,XXREAL_3:def 2;
assume x in X;
then consider W being (Simplex of n,( BCS K )) such that A65: x = W and A66: S c= W by A11;
consider T being  simplex-like  finite (Subset-Family of K) such that A67: T misses SS1 and A68: ( T \/ SS1 ) is  c=-linear  with_non-empty_elements and A69: ( card T ) = ( Z + 1 ) and A70: ( @ W ) = ( ( B .: SS1 ) \/ ( B .: T ) ) by A16,A36,A50,A62,A66,CKB73:1;
consider t being set such that A71: T = { t } by A69,CARD_2:42;
set TS = ( T \/ SS1 );
A72: ( card TS ) = ( n + 1 ) by A16,A36,A67,A69,CARD_2:40;
A73: ( union TS ) in TS by A68,A71,SIMPLEX0:9;
TS is  simplex-like by TOPS_2:13;
then reconsider UTS = ( union TS ) as (Simplex of K) by A73,TOPS_2:def 1;
( card TS ) c= ( card UTS ) by A68,SIMPLEX0:10;
then A74: ( card TS ) <= ( card UTS ) by NAT_1:39;
UTS in T
proof
assume (not UTS in T);
then UTS in SS1 by A73,XBOOLE_0:def 3;
then ( card UTS ) <= ( card U ) by NAT_1:43,ZFMISC_1:74;
hence contradiction by A43,A72,A74,NAT_1:13;
end;
then A75: UTS = t by A71,TARSKI:def 1;
( card UTS ) <= ( ( degree K ) + 1 ) by SIMPLEX0:24;
then ( card UTS ) <= ( n + 1 ) by A3,XXREAL_3:def 2;
then ( card UTS ) = ( n + 1 ) by A72,A74,XXREAL_0:1;
then A76: UTS is (Simplex of n,K) by A64,SIMPLEX0:48;
U c= UTS by XBOOLE_1:7,ZFMISC_1:77;
then UTS in XX by A76;
then (W = ( ( B .: SS1 ) \/ ( B .: { W1 } ) ) or W = ( ( B .: SS1 ) \/ ( B .: { W2 } ) )) by A47,A48,A51,A70,A71,A75,TARSKI:def 2;
hence thesis by A35,A65,TARSKI:def 2;
end;
( card W2 ) = ( ( degree K ) + 1 ) by A3,SIMPLEX0:def 18;
then ( card W2 ) = ( n + 1 ) by A3,XXREAL_3:def 2;
then { W where W is (Simplex of n,( BCS K )): (S c= W & ( conv ( @ W ) ) c= ( conv ( @ W2 ) )) } = { ( S \/ ( B .: { W2 } ) ) } by A16,A30,A35,A36,A43,A49,CKB74:1;
then ( S \/ ( B .: { W2 } ) ) in { W where W is (Simplex of n,( BCS K )): (S c= W & ( conv ( @ W ) ) c= ( conv ( @ W2 ) )) } by TARSKI:def 1;
then (ex R being (Simplex of n,( BCS K )) st ((R = ( S \/ ( B .: { W2 } ) ) & S c= R) & ( conv ( @ R ) ) c= ( conv ( @ W2 ) )));
then A77: ( S \/ ( B .: { W2 } ) ) in X by A11;
( S \/ ( B .: { W1 } ) ) in X by A11,A55;
then { ( S \/ ( B .: { W1 } ) ),( S \/ ( B .: { W2 } ) ) } c= X by A77,ZFMISC_1:32;
then X = { ( S \/ ( B .: { W1 } ) ),( S \/ ( B .: { W2 } ) ) } by A63,XBOOLE_0:def 10;
hence ( card X ) = 2 by A56,CARD_2:57;
end;
A78: (( conv ( @ S ) ) c= ( conv A ) & A is non empty) by A2,A41,A42,XBOOLE_1:1;
assume ( conv ( @ S ) ) misses ( Int A );
then consider BB being (Subset of V) such that A79: BB c< A and A80: ( conv ( @ S ) ) c= ( conv BB ) by A7,A78,RLAFFIN2:23;
A81: BB c= A by A79,XBOOLE_0:def 8;
then reconsider B1 = BB as  finite (Subset of V);
( card B1 ) < ( n + 1 ) by A2,A79,CARD_2:48;
then A82: ( card B1 ) <= n by NAT_1:13;
( Affin ( @ S ) ) c= ( Affin BB ) by A80,RLAFFIN1:68;
then n <= ( card B1 ) by A16,RLAFFIN1:79;
then ( card B1 ) = n by A82,XXREAL_0:1;
then ( card ( A \ BB ) ) = ( ( n + 1 ) - n ) by A2,A81,CARD_2:44;
then consider ab being set such that A83: ( A \ BB ) = { ab } by CARD_2:42;
U is non empty by A26,A43;
then ( @ U ) in ( dom B ) by A31,ZFMISC_1:56;
then A84: (S c= ( conv ( @ S ) ) & ( B . U ) in ( @ S )) by A35,A38,FUNCT_1:def 6,RLAFFIN1:2;
then ( B . U ) in ( conv ( @ S ) );
then A85: ( B . U ) in ( conv ( @ U ) ) by A42;
set BUU = ( ( B . U ) |-- ( @ U ) );
( @ U ) c= ( conv ( @ U ) ) by RLAFFIN1:2;
then A86: ( @ U ) c= ( conv A ) by A41,XBOOLE_1:1;
A87: ab in { ab } by TARSKI:def 1;
then reconsider ab as (Element of V) by A83;
A88: (SS1 is  with_non-empty_elements & S = ( B .: SS1 )) by A27,A29,A32,RELAT_1:112,SETFAM_1:def 8;
A89: ( conv ( @ U ) ) c= ( Affin ( @ U ) ) by RLAFFIN1:65;
then ( sum BUU ) = 1 by A85,RLAFFIN1:def 7;
then consider F being (FinSequence of ( REAL )),G being (FinSequence of (the carrier of V)) such that A90: ( ( ( Sum BUU ) |-- A ) . ab ) = ( Sum F ) and A91: ( len G ) = ( len F ) and G is  one-to-one and A92: ( rng G ) = ( Carrier BUU ) and A93: (for n holds (n in ( dom F ) implies ( F . n ) = ( ( BUU . ( G . n ) ) * ( ( ( G . n ) |-- A ) . ab ) ))) by A7,A86,RLAFFIN2:3;
A94: ( dom G ) = ( dom F ) by A91,FINSEQ_3:29;
U c= ( conv B1 )
proof
A95: ( Carrier BUU ) c= U by RLVECT_2:def 6;
A96:now
let i being Nat;
assume that
A97: i in ( dom F );
A98: ( F . i ) = ( ( BUU . ( G . i ) ) * ( ( ( G . i ) |-- A ) . ab ) ) by A93,A97;
A99: ( G . i ) in ( rng G ) by A94,A97,FUNCT_1:def 3;
then ( G . i ) in U by A92,A95;
then A100: ( ( ( G . i ) |-- A ) . ab ) >= ( 0 ) by A7,A86,RLAFFIN1:71;
( BUU . ( G . i ) ) = ( 1 / ( card U ) ) by A92,A95,A99,RLAFFIN2:18;
hence ( 0 ) <= ( F . i ) by A98,A100;
end;
( B . U ) in ( conv ( @ S ) ) by A84;
then A101: ( B . U ) in ( conv BB ) by A80;
assume (not U c= ( conv B1 ));
then consider t being set such that A102: t in U and A103: (not t in ( conv B1 )) by TARSKI:def 3;
A104: ( ( t |-- A ) . ab ) > ( 0 )
proof
( A \ { ab } ) c= B1
proof
let x;
assume x in ( A \ { ab } );
then (x in A & (not x in { ab })) by XBOOLE_0:def 5;
hence thesis by A83,XBOOLE_0:def 5;
end;
then A105: ( conv ( A \ { ab } ) ) c= ( conv B1 ) by RLAFFIN1:3;
assume A106: ( ( t |-- A ) . ab ) <= ( 0 );
( ( t |-- A ) . ab ) >= ( 0 ) by A7,A86,A102,RLAFFIN1:71;
then (for x holds (x in { ab } implies ( ( t |-- A ) . x ) = ( 0 ))) by A106,TARSKI:def 1;
then t in ( conv ( A \ { ab } ) ) by A7,A86,A102,RLAFFIN1:76;
hence contradiction by A103,A105;
end;
A107: ( BUU . t ) = ( 1 / ( card U ) ) by A102,RLAFFIN2:18;
then t in ( Carrier BUU ) by A102;
then consider n being set such that A108: n in ( dom G ) and A109: ( G . n ) = t by A92,FUNCT_1:def 3;
reconsider n as Nat by A108;
( F . n ) = ( ( BUU . t ) * ( ( t |-- A ) . ab ) ) by A93,A94,A108,A109;
then ( 0 ) < ( Sum F ) by A94,A96,A102,A104,A107,A108,RVSUM_1:85;
then A110: ( ( ( B . U ) |-- A ) . ab ) > ( 0 ) by A85,A89,A90,RLAFFIN1:def 7;
( Carrier ( ( B . U ) |-- BB ) ) c= BB by RLVECT_2:def 6;
then A111: (not ab in ( Carrier ( ( B . U ) |-- BB ) )) by A83,A87,XBOOLE_0:def 5;
( conv BB ) c= ( Affin BB ) by RLAFFIN1:65;
then ( ( B . U ) |-- A ) = ( ( B . U ) |-- BB ) by A7,A81,A101,RLAFFIN1:77;
hence contradiction by A111,A110;
end;
then ( conv ( @ U ) ) c= ( conv B1 ) by CONVEX1:30;
then ( conv ( @ U ) ) misses ( Int A ) by A79,RLAFFIN2:7,XBOOLE_1:63;
then ( card XX ) = 1 by A4,A44;
then consider w1 being set such that A112: XX = { w1 } by CARD_2:42;
w1 in XX by A112,TARSKI:def 1;
then consider W1 being (Simplex of n,K) such that A113: w1 = W1 and A114: U c= W1;
A115: ( ( card SS1 ) + Z ) <= ( degree K ) by A3,A16,A27,A30,A33,CKB64:1;
A116: X c= { ( S \/ ( B .: { W1 } ) ) }
proof
let x;
A117: ( n + 1 ) = ( ( degree K ) + 1 ) by A3,XXREAL_3:def 2;
assume x in X;
then consider W being (Simplex of n,( BCS K )) such that A118: x = W and A119: S c= W by A11;
consider T being  simplex-like  finite (Subset-Family of K) such that A120: T misses SS1 and A121: ( T \/ SS1 ) is  c=-linear  with_non-empty_elements and A122: ( card T ) = ( Z + 1 ) and A123: ( @ W ) = ( ( B .: SS1 ) \/ ( B .: T ) ) by A16,A36,A88,A115,A119,CKB73:1;
consider t being set such that A124: T = { t } by A122,CARD_2:42;
set TS = ( T \/ SS1 );
A125: ( card TS ) = ( n + 1 ) by A16,A36,A120,A122,CARD_2:40;
A126: ( union TS ) in TS by A121,A124,SIMPLEX0:9;
TS is  simplex-like by TOPS_2:13;
then reconsider UTS = ( union TS ) as (Simplex of K) by A126,TOPS_2:def 1;
( card TS ) c= ( card UTS ) by A121,SIMPLEX0:10;
then A127: ( card TS ) <= ( card UTS ) by NAT_1:39;
UTS in T
proof
assume (not UTS in T);
then UTS in SS1 by A126,XBOOLE_0:def 3;
then ( card UTS ) <= ( card U ) by NAT_1:43,ZFMISC_1:74;
hence contradiction by A43,A125,A127,NAT_1:13;
end;
then A128: UTS = t by A124,TARSKI:def 1;
( card UTS ) <= ( ( degree K ) + 1 ) by SIMPLEX0:24;
then ( card UTS ) <= ( n + 1 ) by A3,XXREAL_3:def 2;
then (( card UTS ) = ( n + 1 ) & SS1 c= TS) by A125,A127,XBOOLE_1:7,XXREAL_0:1;
then (U c= UTS & UTS is (Simplex of n,K)) by A3,A117,SIMPLEX0:def 18,ZFMISC_1:77;
then UTS in XX;
then W = ( ( B .: SS1 ) \/ ( B .: { W1 } ) ) by A112,A113,A123,A124,A128,TARSKI:def 1;
hence thesis by A35,A118,TARSKI:def 1;
end;
( card W1 ) = ( ( degree K ) + 1 ) by A3,SIMPLEX0:def 18;
then ( card W1 ) = ( n + 1 ) by A3,XXREAL_3:def 2;
then { W where W is (Simplex of n,( BCS K )): (S c= W & ( conv ( @ W ) ) c= ( conv ( @ W1 ) )) } = { ( S \/ ( B .: { W1 } ) ) } by A16,A27,A30,A33,A36,A43,A114,CKB74:1;
then ( S \/ ( B .: { W1 } ) ) in { W where W is (Simplex of n,( BCS K )): (S c= W & ( conv ( @ W ) ) c= ( conv ( @ W1 ) )) } by TARSKI:def 1;
then (ex R being (Simplex of n,( BCS K )) st ((R = ( S \/ ( B .: { W1 } ) ) & S c= R) & ( conv ( @ R ) ) c= ( conv ( @ W1 ) )));
then ( S \/ ( B .: { W1 } ) ) in X by A11;
then X = { ( S \/ ( B .: { W1 } ) ) } by A116,ZFMISC_1:33;
hence ( card X ) = 1 by CARD_1:30;
end;
suppose A129: ( card U ) = ( n + 1 );

A130: ( conv ( @ S ) ) meets ( Int A )
proof
U is non empty by A129;
then ( @ U ) in ( dom B ) by A31,ZFMISC_1:56;
then A131: (S c= ( conv ( @ S ) ) & ( B . U ) in ( @ S )) by A35,A38,FUNCT_1:def 6,RLAFFIN1:2;
then ( B . U ) in ( conv ( @ S ) );
then A132: ( B . U ) in ( conv ( @ U ) ) by A42;
set BUU = ( ( B . U ) |-- ( @ U ) );
assume A133: ( conv ( @ S ) ) misses ( Int A );
(( conv ( @ S ) ) c= ( conv A ) & A is non empty) by A2,A41,A42,XBOOLE_1:1;
then consider BB being (Subset of V) such that A134: BB c< A and A135: ( conv ( @ S ) ) c= ( conv BB ) by A7,A133,RLAFFIN2:23;
A136: BB c= A by A134,XBOOLE_0:def 8;
then reconsider B1 = BB as  finite (Subset of V);
( Affin ( @ S ) ) c= ( Affin BB ) by A135,RLAFFIN1:68;
then A137: n <= ( card B1 ) by A16,RLAFFIN1:79;
A138: ( card B1 ) < ( n + 1 ) by A2,A134,CARD_2:48;
then ( card B1 ) <= n by NAT_1:13;
then ( card B1 ) = n by A137,XXREAL_0:1;
then ( card ( A \ BB ) ) = ( ( n + 1 ) - n ) by A2,A136,CARD_2:44;
then consider ab being set such that A139: ( A \ BB ) = { ab } by CARD_2:42;
( @ U ) c= ( conv ( @ U ) ) by RLAFFIN1:2;
then A140: ( @ U ) c= ( conv A ) by A41,XBOOLE_1:1;
A141: ab in { ab } by TARSKI:def 1;
then reconsider ab as (Element of V) by A139;
A142: ( conv ( @ U ) ) c= ( Affin ( @ U ) ) by RLAFFIN1:65;
then ( sum BUU ) = 1 by A132,RLAFFIN1:def 7;
then consider F being (FinSequence of ( REAL )),G being (FinSequence of (the carrier of V)) such that A143: ( ( ( Sum BUU ) |-- A ) . ab ) = ( Sum F ) and A144: ( len G ) = ( len F ) and G is  one-to-one and A145: ( rng G ) = ( Carrier BUU ) and A146: (for n holds (n in ( dom F ) implies ( F . n ) = ( ( BUU . ( G . n ) ) * ( ( ( G . n ) |-- A ) . ab ) ))) by A7,A140,RLAFFIN2:3;
A147: ( dom G ) = ( dom F ) by A144,FINSEQ_3:29;
A148: ( A \ { ab } ) = ( A /\ BB ) by A139,XBOOLE_1:48
.= BB by A136,XBOOLE_1:28;
U c= ( conv B1 )
proof
A149: ( Carrier BUU ) c= U by RLVECT_2:def 6;
A150:now
let i being Nat;
assume that
A151: i in ( dom F );
A152: ( F . i ) = ( ( BUU . ( G . i ) ) * ( ( ( G . i ) |-- A ) . ab ) ) by A146,A151;
A153: ( G . i ) in ( rng G ) by A147,A151,FUNCT_1:def 3;
then ( G . i ) in U by A145,A149;
then A154: ( ( ( G . i ) |-- A ) . ab ) >= ( 0 ) by A7,A140,RLAFFIN1:71;
( BUU . ( G . i ) ) = ( 1 / ( card U ) ) by A145,A149,A153,RLAFFIN2:18;
hence ( 0 ) <= ( F . i ) by A152,A154;
end;
( B . U ) in ( conv ( @ S ) ) by A131;
then A155: ( B . U ) in ( conv BB ) by A135;
assume (not U c= ( conv B1 ));
then consider t being set such that A156: t in U and A157: (not t in ( conv B1 )) by TARSKI:def 3;
U c= ( conv ( @ U ) ) by RLAFFIN1:2;
then A158: t in ( conv ( @ U ) ) by A156;
A159: ( ( t |-- A ) . ab ) > ( 0 )
proof
assume A160: ( ( t |-- A ) . ab ) <= ( 0 );
( ( t |-- A ) . ab ) >= ( 0 ) by A7,A41,A158,RLAFFIN1:71;
then (for y holds (y in ( A \ B1 ) implies ( ( t |-- A ) . y ) = ( 0 ))) by A139,A160,TARSKI:def 1;
hence contradiction by A7,A41,A139,A148,A157,A158,RLAFFIN1:76;
end;
A161: ( BUU . t ) = ( 1 / ( card U ) ) by A156,RLAFFIN2:18;
then t in ( Carrier BUU ) by A156;
then consider n being set such that A162: n in ( dom G ) and A163: ( G . n ) = t by A145,FUNCT_1:def 3;
reconsider n as Nat by A162;
( F . n ) = ( ( BUU . t ) * ( ( t |-- A ) . ab ) ) by A146,A147,A162,A163;
then ( 0 ) < ( Sum F ) by A147,A150,A156,A159,A161,A162,RVSUM_1:85;
then A164: ( ( ( B . U ) |-- A ) . ab ) > ( 0 ) by A132,A142,A143,RLAFFIN1:def 7;
( Carrier ( ( B . U ) |-- BB ) ) c= BB by RLVECT_2:def 6;
then A165: (not ab in ( Carrier ( ( B . U ) |-- BB ) )) by A139,A141,XBOOLE_0:def 5;
( conv BB ) c= ( Affin BB ) by RLAFFIN1:65;
then ( ( B . U ) |-- A ) = ( ( B . U ) |-- BB ) by A7,A136,A155,RLAFFIN1:77;
hence contradiction by A165,A164;
end;
then ( conv ( @ U ) ) c= ( conv B1 ) by CONVEX1:30;
then ( Affin ( @ U ) ) c= ( Affin B1 ) by RLAFFIN1:68;
hence contradiction by A129,A138,RLAFFIN1:79;
end;
set XX = { S1 where S1 is (Simplex of n,( BCS K )): (S c= S1 & ( conv ( @ S1 ) ) c= ( conv ( @ U ) )) };
A166: ( card XX ) = 2 by A16,A30,A35,A36,A129,CKB75:1;
then XX is  finite;
then consider w1 being set,w2 being set such that w1 <> w2 and A167: XX = { w1,w2 } by A166,CARD_2:60;
w2 in XX by A167,TARSKI:def 2;
then consider W2 being (Simplex of n,( BCS K )) such that A168: w2 = W2 and A169: S c= W2 and ( conv ( @ W2 ) ) c= ( conv ( @ U ) );
w1 in XX by A167,TARSKI:def 2;
then consider W1 being (Simplex of n,( BCS K )) such that A170: w1 = W1 and A171: S c= W1 and ( conv ( @ W1 ) ) c= ( conv ( @ U ) );
A172: W1 in X by A11,A171;
A173: X c= XX
proof
let w being set;
assume w in X;
then consider W being (Simplex of n,( BCS K )) such that A174: w = W and A175: S c= W by A11;
( ( card SS1 ) + Z ) <= ( degree K ) by A3,A16,A27,A30,A33,CKB64:1;
then consider T being  simplex-like  finite (Subset-Family of K) such that T misses SS1 and A176: ( T \/ SS1 ) is  c=-linear  with_non-empty_elements and ( card T ) = ( Z + 1 ) and A177: ( @ W ) = ( ( B .: SS1 ) \/ ( B .: T ) ) by A27,A30,A33,A34,A175,CKB73:1;
reconsider TS = ( T \/ SS1 ) as  finite  simplex-like (Subset-Family of K) by TOPS_2:13;
A178: W = ( B .: ( @ TS ) ) by A177,RELAT_1:120;
( union TS ) in TS by A37,A176,SIMPLEX0:9;
then reconsider UTS = ( union TS ) as (Simplex of K) by TOPS_2:def 1;
( card UTS ) <= ( ( degree K ) + 1 ) by SIMPLEX0:24;
then A179: ( card UTS ) <= ( n + 1 ) by A3,XXREAL_3:def 2;
A180: U c= ( union TS ) by XBOOLE_1:7,ZFMISC_1:77;
then ( n + 1 ) <= ( card UTS ) by A129,NAT_1:43;
then UTS = U by A129,A179,A180,CARD_FIN:1,XXREAL_0:1;
then ( conv ( @ W ) ) c= ( conv ( @ U ) ) by A178,CONVEX1:30,RLAFFIN2:17;
hence thesis by A174,A175;
end;
W2 in X by A11,A169;
then XX c= X by A167,A170,A168,A172,ZFMISC_1:32;
hence thesis by A130,A166,A173,XBOOLE_0:def 10;
end;
end;
end;
