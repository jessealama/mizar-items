environ
vocabularies ARYTM_1,ARYTM_3,XBOOLE_0,CARD_1,CARD_2,CLASSES1,COHSP_1,COMPLEX1,CONVEX1,CONVEX2,CONVEX3,FINSEQ_1,FINSET_1,FUNCT_1,MATROID0,MCART_1,ORDERS_1,PARTFUN1,PRE_TOPC,QC_LANG1,RELAT_1,RLVECT_1,RLVECT_2,SEMI_AF1,SETFAM_1,SGRAPH1,SUBSET_1,TARSKI,TOPS_1,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,SIMPLEX1,REAL_1,FUNCOP_1,NAT_1,FUNCT_2,STRUCT_0,XXREAL_0,NUMBERS,ORDINAL1,CARD_3,GLIB_000,FINSEQ_4;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,NUMBERS,NAT_1,XXREAL_3,XXREAL_0,ORDERS_1,CARD_1,REAL_1,FINSET_1,SETFAM_1,DOMAIN_1,RELAT_1,FUNCT_1,FUNCT_2,RELSET_1,FINSEQ_1,STRUCT_0,CLASSES1,RVSUM_1,RLVECT_1,RLVECT_2,CONVEX1,CONVEX2,CONVEX3,PRE_TOPC,RLAFFIN1,FUNCOP_1,PENCIL_1,MATROID0,MCART_1,CARD_2,COHSP_1,SIMPLEX0,RLAFFIN2,CKB3,CKB4,CKB5,CKB6,CKB8,CKB15,CKB23,CKB26,CKB27,CKB40,CKB41;
definitions MATROID0,ORDERS_1,ORDINAL1,RLAFFIN2,RLVECT_2,SETFAM_1,STRUCT_0,SIMPLEX0,TARSKI,TOPS_2,XBOOLE_0,XXREAL_3,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
theorems BORSUK_5,CARD_1,CARD_2,CARD_FIN,CLASSES1,COHSP_1,CONVEX1,CONVEX3,FINSEQ_1,FINSEQ_3,FUNCOP_1,FUNCT_1,FUNCT_2,INT_1,MATROID0,MCART_1,NAT_1,ORDINAL1,PENCIL_1,PRE_TOPC,RELAT_1,RELSET_2,RLTOPSP1,RLVECT_1,RLVECT_2,RVSUM_1,SETFAM_1,STIRL2_1,TARSKI,TOPS_2,WELLORD2,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,XXREAL_3,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB40,CKB41,CKB50,CKB52,CKB53,CKB54,CKB58,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73;
schemes CLASSES1,FUNCT_1,FUNCT_2,NAT_1,RELAT_1;
registrations CARD_1,FINSET_1,FUNCT_1,MEMBERED,NAT_1,RELAT_1,RLVECT_1,STRUCT_0,SUBSET_1,VALUED_0,XCMPLX_0,XREAL_0,XXREAL_0,XBOOLE_0,RLAFFIN1,SIMPLEX0,FUNCOP_1,INT_1,XXREAL_3,MATROID0,REALSET1,SETFAM_1,COHSP_1,RLAFFIN2,RELSET_1,ZFMISC_1,DILWORTH,RLVECT_2,CKB17,CKB22,CKB25,CKB38,CKB39,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB51,CKB55,CKB56,CKB57,CKB59,CKB60;
constructors BINOP_2,CONVEX1,CONVEX3,REAL_1,RVSUM_1,SEQ_1,SETFAM_1,RLAFFIN1,SIMPLEX0,TOPS_2,LEXBFS,XXREAL_2,BORSUK_1,COHSP_1,CARD_2,REARRAN1,RLAFFIN2,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve V for RealLinearSpace;
reserve K for non  void  affinely-independent  simplex-join-closed  total (SimplicialComplex of V);
reserve Sk for  finite  simplex-like (Subset-Family of K);
reserve Ak for (Simplex of K);
theorem
Th42: ((((Sk is  c=-linear  with_non-empty_elements & ( card Sk ) = ( card ( union Sk ) )) & ( union Sk ) c= Ak) & ( card Ak ) = ( ( card Sk ) + 1 )) implies { S1 where S1 is (Simplex of ( card Sk ),( BCS K )): (( ( center_of_mass V ) .: Sk ) c= S1 & ( conv ( @ S1 ) ) c= ( conv ( @ Ak ) )) } = { ( ( ( center_of_mass V ) .: Sk ) \/ ( ( center_of_mass V ) .: { Ak } ) ) })
proof
set B = ( center_of_mass V );
assume that
A1: Sk is  c=-linear  with_non-empty_elements
and
A2: ( card Sk ) = ( card ( union Sk ) )
and
A3: ( union Sk ) c= Ak
and
A4: ( card Ak ) = ( ( card Sk ) + 1 );
( card ( Ak \ ( union Sk ) ) ) = ( ( ( card Sk ) + 1 ) - ( card Sk ) ) by A2,A3,A4,CARD_2:44
.= 1;
then consider v being set such that A5: ( Ak \ ( union Sk ) ) = { v } by CARD_2:42;
reconsider Ak1 = ( @ Ak ) as  affinely-independent  finite (Subset of V);
set C = ( Complex_of { Ak1 } );
reconsider c = ( card Ak ) as  ext-real number;
A6: ( degree C ) = ( c - 1 ) by SIMPLEX0:26
.= ( ( card Ak ) + ( - 1 ) ) by XXREAL_3:def 2
.= ( card Sk ) by A4;
reconsider Sk1 = ( @ Sk ) as  c=-linear  finite  finite-membered (Subset-Family of V) by A1;
set XX = { W where W is (Simplex of ( card Sk ),( BCS C )): ( B .: Sk ) c= W };
set YY = { W where W is (Simplex of ( card Sk ),( BCS K )): (( B .: Sk ) c= W & ( conv ( @ W ) ) c= ( conv ( @ Ak ) )) };
( [#] K ) = (the carrier of V) by SIMPLEX0:def 10;
then |. K .| c= ( [#] K );
then A7: ( subdivision (B,K) ) = ( BCS K ) by CKB26:def 1;
A8: C is (SubSimplicialComplex of K) by CKB7:1;
then (the topology of C) c= (the topology of K) by SIMPLEX0:def 13;
then A9: |. C .| c= |. K .| by CKB9:1;
A10: ( [#] C ) = ( [#] V );
then A11: ( degree C ) = ( degree ( BCS C ) ) by A9,CKB62:1;
( subdivision (B,C) ) = ( BCS C ) by A9,A10,CKB26:def 1;
then ( BCS C ) is (SubSimplicialComplex of ( BCS K )) by A7,A8,SIMPLEX0:58;
then A12: ( degree ( BCS C ) ) <= ( degree ( BCS K ) ) by SIMPLEX0:32;
A13: XX c= YY
proof
let x;
assume x in XX;
then consider W being (Simplex of ( card Sk ),( BCS C )) such that A14: (x = W & ( B .: Sk1 ) c= W);
W = ( @ W );
then reconsider w = W as (Simplex of ( BCS K )) by CKB72:1;
( card W ) = ( ( degree ( BCS C ) ) + 1 ) by A6,A11,SIMPLEX0:def 18;
then A15: w is (Simplex of ( card Sk ),( BCS K )) by A6,A11,A12,SIMPLEX0:def 18;
(( conv ( @ W ) ) c= ( conv ( @ Ak ) ) & ( @ w ) = w) by CKB72:1;
hence thesis by A14,A15;
end;
A16: ( [#] ( subdivision (B,C) ) ) = ( [#] C ) by SIMPLEX0:def 20;
A17: YY c= XX
proof
let x;
reconsider c1 = ( card Sk ) as  ext-real number;
assume x in YY;
then consider W being (Simplex of ( card Sk ),( BCS K )) such that A18: (W = x & ( B .: Sk ) c= W) and A19: ( conv ( @ W ) ) c= ( conv ( @ Ak ) );
reconsider w = ( @ W ) as (Subset of ( BCS C )) by A9,A16,CKB26:def 1;
reconsider cW = ( card W ) as  ext-real number;
( card W ) = ( c1 + 1 ) by A6,A11,A12,SIMPLEX0:def 18
.= ( ( card Sk ) + 1 ) by XXREAL_3:def 2;
then ( card Sk ) = ( ( card W ) + ( - 1 ) );
then A20: ( card Sk ) = ( cW - 1 ) by XXREAL_3:def 2;
w is  simplex-like by A19,CKB72:1;
then w is (Simplex of ( card Sk ),( BCS C )) by A20,SIMPLEX0:48;
hence thesis by A18;
end;
v in { v } by TARSKI:def 1;
then A21: (v in Ak1 & (not v in ( union Sk ))) by A5,XBOOLE_0:def 5;
Ak = ( Ak \/ ( union Sk ) ) by A3,XBOOLE_1:12
.= ( { v } \/ ( union Sk1 ) ) by A5,XBOOLE_1:39;
then XX = { ( ( B .: Sk1 ) \/ ( B .: { Ak } ) ) } by A1,A2,A21,CKB70:1;
hence thesis by A13,A17,XBOOLE_0:def 10;
end;
