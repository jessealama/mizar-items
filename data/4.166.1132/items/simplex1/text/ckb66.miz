environ
vocabularies ARYTM_1,ARYTM_3,XBOOLE_0,CARD_1,CARD_2,CLASSES1,COHSP_1,COMPLEX1,CONVEX1,CONVEX2,CONVEX3,FINSEQ_1,FINSET_1,FUNCT_1,MATROID0,MCART_1,ORDERS_1,PARTFUN1,PRE_TOPC,QC_LANG1,RELAT_1,RLVECT_1,RLVECT_2,SEMI_AF1,SETFAM_1,SGRAPH1,SUBSET_1,TARSKI,TOPS_1,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,SIMPLEX1,REAL_1,FUNCOP_1,NAT_1,FUNCT_2,STRUCT_0,XXREAL_0,NUMBERS,ORDINAL1,CARD_3,GLIB_000,FINSEQ_4;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,NUMBERS,NAT_1,XXREAL_3,XXREAL_0,ORDERS_1,CARD_1,REAL_1,FINSET_1,SETFAM_1,DOMAIN_1,RELAT_1,FUNCT_1,FUNCT_2,RELSET_1,FINSEQ_1,STRUCT_0,CLASSES1,RVSUM_1,RLVECT_1,RLVECT_2,CONVEX1,CONVEX2,CONVEX3,PRE_TOPC,RLAFFIN1,FUNCOP_1,PENCIL_1,MATROID0,MCART_1,CARD_2,COHSP_1,SIMPLEX0,RLAFFIN2,CKB3,CKB4,CKB5,CKB6,CKB8,CKB15,CKB23,CKB26,CKB27,CKB40,CKB41;
definitions MATROID0,ORDERS_1,ORDINAL1,RLAFFIN2,RLVECT_2,SETFAM_1,STRUCT_0,SIMPLEX0,TARSKI,TOPS_2,XBOOLE_0,XXREAL_3,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
theorems BORSUK_5,CARD_1,CARD_2,CARD_FIN,CLASSES1,COHSP_1,CONVEX1,CONVEX3,FINSEQ_1,FINSEQ_3,FUNCOP_1,FUNCT_1,FUNCT_2,INT_1,MATROID0,MCART_1,NAT_1,ORDINAL1,PENCIL_1,PRE_TOPC,RELAT_1,RELSET_2,RLTOPSP1,RLVECT_1,RLVECT_2,RVSUM_1,SETFAM_1,STIRL2_1,TARSKI,TOPS_2,WELLORD2,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,XXREAL_3,ZFMISC_1,RLAFFIN1,RLAFFIN2,SIMPLEX0,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB24,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB40,CKB41,CKB50,CKB52,CKB53,CKB54,CKB58,CKB61,CKB62,CKB63,CKB64,CKB65;
schemes CLASSES1,FUNCT_1,FUNCT_2,NAT_1,RELAT_1;
registrations CARD_1,FINSET_1,FUNCT_1,MEMBERED,NAT_1,RELAT_1,RLVECT_1,STRUCT_0,SUBSET_1,VALUED_0,XCMPLX_0,XREAL_0,XXREAL_0,XBOOLE_0,RLAFFIN1,SIMPLEX0,FUNCOP_1,INT_1,XXREAL_3,MATROID0,REALSET1,SETFAM_1,COHSP_1,RLAFFIN2,RELSET_1,ZFMISC_1,DILWORTH,RLVECT_2,CKB17,CKB22,CKB25,CKB38,CKB39,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB51,CKB55,CKB56,CKB57,CKB59,CKB60;
constructors BINOP_2,CONVEX1,CONVEX3,REAL_1,RVSUM_1,SEQ_1,SETFAM_1,RLAFFIN1,SIMPLEX0,TOPS_2,LEXBFS,XXREAL_2,BORSUK_1,COHSP_1,CARD_2,REARRAN1,RLAFFIN2,CKB5,CKB6,CKB8,CKB15,CKB26,CKB27,CKB40,CKB41;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve n for Nat;
reserve V for RealLinearSpace;
reserve Aff for  finite  affinely-independent (Subset of V);
reserve Bf for  finite (Subset of V);
reserve S for  finite (Subset-Family of V);
reserve T for  finite (Subset-Family of V);
theorem
Th35: (((S is  with_non-empty_elements & ( union S ) c= Aff) & ( ( ( card S ) + n ) + 1 ) <= ( card Aff )) implies ((Bf is (Simplex of ( n + ( card S ) ),( BCS ( Complex_of { Aff } ) )) & ( ( center_of_mass V ) .: S ) c= Bf) iff (ex T st ((((T misses S & ( T \/ S ) is  c=-linear  with_non-empty_elements) & ( card T ) = ( n + 1 )) & ( union T ) c= Aff) & Bf = ( ( ( center_of_mass V ) .: S ) \/ ( ( center_of_mass V ) .: T ) )))))
proof
set B = ( center_of_mass V );
set U = ( union S );
assume that
A1: S is  with_non-empty_elements
and
A2: U c= Aff
and
A3: ( ( ( card S ) + n ) + 1 ) <= ( card Aff );
set C = ( Complex_of { Aff } );
reconsider c = ( card Aff ) as  ext-real number;
set BTC = ( B | (the topology of C) );
set BC = ( BCS C );
A4: (the topology of C) = ( bool Aff ) by SIMPLEX0:4;
A5: ( degree C ) = ( c - 1 ) by SIMPLEX0:26
.= ( ( card Aff ) + ( - 1 ) ) by XXREAL_3:def 2;
reconsider c = ( ( card S ) + n ) as  ext-real number;
A6: |. C .| c= ( [#] C );
then A7: BC = ( subdivision (B,C) ) by CKB26:def 1;
( ( card S ) + n ) <= ( ( card Aff ) - 1 ) by A3,XREAL_1:19;
then A8: ( ( card S ) + n ) <= ( degree BC ) by A5,A6,CKB62:1;
hereby
A9: S c= (the topology of C)
proof
let x;
assume x in S;
then x c= U by ZFMISC_1:74;
then x c= Aff by A2,XBOOLE_1:1;
hence thesis by A4;
end;
then A10: ( B .: S ) = ( BTC .: S ) by RELAT_1:129;
(( dom B ) = ( ( bool (the carrier of V) ) \ { ( {} ) } ) & (not ( {} ) in S)) by A1,FUNCT_2:def 1;
then (( dom BTC ) = ( ( dom B ) /\ (the topology of C) ) & S c= ( dom B )) by RELAT_1:61,ZFMISC_1:34;
then A11: S c= ( dom BTC ) by A9,XBOOLE_1:19;
assume that
A12: Bf is (Simplex of ( n + ( card S ) ),( BCS ( Complex_of { Aff } ) ))
and
A13: ( B .: S ) c= Bf;
consider a being  c=-linear  finite  simplex-like (Subset-Family of C) such that A14: Bf = ( B .: a ) by A7,A12,SIMPLEX0:def 20;
( a /\ ( dom B ) ) c= a by XBOOLE_1:17;
then reconsider AA = ( a /\ ( dom B ) ) as  c=-linear  finite  simplex-like (Subset-Family of C) by TOPS_2:11,XBOOLE_1:1;
A15: ( B .: S ) c= ( B .: AA ) by A13,A14,RELAT_1:112;
reconsider T = ( AA \ S ) as (Subset-Family of V);
A16: AA c= (the topology of C) by SIMPLEX0:14;
then A17: ( B .: AA ) = ( BTC .: AA ) by RELAT_1:129;
A18: ( S \/ T ) = ( AA \/ S ) by XBOOLE_1:39
.= AA by A10,A11,A15,A17,FUNCT_1:87,XBOOLE_1:12;
T c= AA by XBOOLE_1:36;
then A19: T c= ( bool Aff ) by A4,A16,XBOOLE_1:1;
A20: (not ( {} ) in AA) by ZFMISC_1:56;
then (( B .: a ) = ( B .: ( a /\ ( dom B ) ) ) & AA is  with_non-empty_elements) by RELAT_1:112,SETFAM_1:def 8;
then A21: ( card Bf ) = ( card AA ) by A14,CKB64:1;
A22: Bf = ( B .: AA ) by A14,RELAT_1:112
.= ( ( B .: S ) \/ ( B .: T ) ) by A18,RELAT_1:120;
reconsider T as  finite (Subset-Family of V);
take T;
( card Bf ) = ( c + 1 ) by A8,A12,SIMPLEX0:def 18
.= ( ( ( card S ) + n ) + 1 ) by XXREAL_3:def 2;
then (( union ( bool Aff ) ) = Aff & ( ( card S ) + ( card ( AA \ S ) ) ) = ( ( ( card S ) + n ) + 1 )) by A18,A21,CARD_2:40,XBOOLE_1:79,ZFMISC_1:81;
hence ((((T misses S & ( T \/ S ) is  c=-linear  with_non-empty_elements) & ( card T ) = ( n + 1 )) & ( union T ) c= Aff) & Bf = ( ( B .: S ) \/ ( B .: T ) )) by A18,A19,A20,A22,SETFAM_1:def 8,XBOOLE_1:79,ZFMISC_1:77;
end;
given T being  finite (Subset-Family of V) such that
A23: T misses S
and
A24: ( T \/ S ) is  c=-linear  with_non-empty_elements
and
A25: ( card T ) = ( n + 1 )
and
A26: ( union T ) c= Aff
and
A27: Bf = ( ( ( center_of_mass V ) .: S ) \/ ( ( center_of_mass V ) .: T ) );

reconsider TS = ( T \/ S ) as (Subset-Family of C);
reconsider t = T as  finite (Subset-Family of V);
A28: ( card TS ) = ( ( card t ) + ( card S ) ) by A23,CARD_2:40
.= ( ( ( card S ) + n ) + 1 ) by A25;
( union ( T \/ S ) ) = ( ( union T ) \/ ( union S ) ) by ZFMISC_1:78;
then ( union ( T \/ S ) ) c= Aff by A2,A26,XBOOLE_1:8;
then (( T \/ S ) c= ( bool ( union ( T \/ S ) ) ) & ( bool ( union ( T \/ S ) ) ) c= ( bool Aff )) by ZFMISC_1:67,ZFMISC_1:82;
then A29: ( T \/ S ) c= (the topology of C) by A4,XBOOLE_1:1;
A30: TS is  simplex-like
proof
let a being (Subset of C);
thus thesis by A29,PRE_TOPC:def 2;
end;
( [#] BC ) = ( [#] C ) by A7,SIMPLEX0:def 20;
then reconsider BTS = ( B .: TS ) as (Simplex of BC) by A7,A24,A30,SIMPLEX0:def 20;
( card TS ) = ( card ( B .: TS ) ) by A24,A30,CKB64:1;
then A31: ( card BTS ) = ( c + 1 ) by A28,XXREAL_3:def 2;
BTS = Bf by A27,RELAT_1:120;
hence thesis by A8,A27,A31,SIMPLEX0:def 18,XBOOLE_1:7;
end;
