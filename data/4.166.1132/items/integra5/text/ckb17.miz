environ
vocabularies NUMBERS,SUBSET_1,REAL_1,INTEGRA1,FINSEQ_1,ORDINAL4,CARD_3,ARYTM_1,ARYTM_3,BINOP_2,RELAT_1,FUNCT_1,PARTFUN1,XXREAL_0,FINSEQ_2,NAT_1,XBOOLE_0,REALSET1,VALUED_1,TARSKI,XXREAL_2,XREAL_0,ORDINAL1,ORDINAL2,FCONT_2,INTEGRA2,FUNCT_3,SEQ_2,CARD_1,SEQ_1,COMPLEX1,MEASURE7,FDIFF_1,SEQ_4,XXREAL_1,ZFMISC_1,VALUED_0,SEQM_3,RCOMP_1,INTEGRA5,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,RELAT_1,COMPLEX1,XXREAL_2,ZFMISC_1,RELSET_1,FUNCT_2,RCOMP_1,PARTFUN1,MEASURE6,FINSEQ_1,FUNCOP_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQ_2,SEQ_2,SEQ_4,BINOP_2,REAL_1,NAT_1,FDIFF_1,RVSUM_1,MEASURE5,INTEGRA1,INTEGRA2,INTEGRA3,FCONT_1,FCONT_2,RFUNCT_2,XXREAL_0,CKB4,CKB5,CKB8,CKB9;
definitions VALUED_1,XXREAL_2,CKB8,CKB9;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,TARSKI,INTEGRA2,NAT_2,FINSEQ_2,RCOMP_1,FCONT_2,INTEGRA4,FCONT_1,ROLLE,RFUNCT_2,FDIFF_2,RELAT_1,XREAL_0,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_2,XXREAL_1,RELSET_1,INTEGRA3,MEASURE5,CKB1,CKB2,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16;
schemes FINSEQ_2;
registrations XBOOLE_0,RELAT_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FINSEQ_1,FINSEQ_2,RCOMP_1,INTEGRA1,VALUED_0,VALUED_1,FUNCT_2,FINSET_1,XXREAL_2,CARD_1,SEQ_2,RELSET_1,ZFMISC_1,MEASURE5;
constructors PARTFUN1,REAL_1,NAT_1,BINOP_2,COMPLEX1,RFUNCT_1,RFUNCT_2,FCONT_1,FCONT_2,FDIFF_1,ZFMISC_1,MEASURE6,INTEGRA2,SEQ_1,XXREAL_2,RVSUM_1,SEQ_4,RELSET_1,FUNCOP_1,SEQ_2,INTEGRA3,CKB5,CKB8,CKB9;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve r for Real;
reserve A for non  empty  closed_interval (Subset of ( REAL ));
reserve X for set;
theorem
Th13: (for f being (PartFunc of ( REAL ),( REAL )) holds ((((A c= X & f is_differentiable_on X) & ( f `| X ) is_integrable_on A) & ( ( f `| X ) | A ) is  bounded) implies ( integral (( f `| X ),A) ) = ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) )))
proof
let f being (PartFunc of ( REAL ),( REAL ));
assume that
A1: (A c= X & f is_differentiable_on X)
and
A2: ( f `| X ) is_integrable_on A
and
A3: ( ( f `| X ) | A ) is  bounded;
( ( f `| X ) || A ) is  integrable by A2,CKB8:def 1;
then A4: ( upper_integral ( ( f `| X ) || A ) ) = ( lower_integral ( ( f `| X ) || A ) ) by INTEGRA1:def 16;
A5: (for r being  real number holds (r in ( rng ( upper_sum_set ( ( f `| X ) || A ) ) ) implies ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) <= r))
proof
let r being  real number;
assume r in ( rng ( upper_sum_set ( ( f `| X ) || A ) ) );
then consider D being (Element of ( divs A )) such that A6: (D in ( dom ( upper_sum_set ( ( f `| X ) || A ) ) ) & r = ( ( upper_sum_set ( ( f `| X ) || A ) ) . D )) by PARTFUN1:3;
reconsider D as (Division of A) by INTEGRA1:def 3;
r = ( upper_sum (( ( f `| X ) || A ),D) ) by A6,FUNCT_2:def 1,INTEGRA1:def 10;
hence thesis by A1,A3,CKB16:1;
end;
( dom ( upper_sum_set ( ( f `| X ) || A ) ) ) = ( divs A ) by FUNCT_2:def 1,INTEGRA1:def 10;
then ( rng ( upper_sum_set ( ( f `| X ) || A ) ) ) is non  empty by RELAT_1:42;
then ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) <= ( lower_bound ( rng ( upper_sum_set ( ( f `| X ) || A ) ) ) ) by A5,SEQ_4:43;
then A7: ( upper_integral ( ( f `| X ) || A ) ) >= ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) by INTEGRA1:def 14;
A8: (for r being  real number holds (r in ( rng ( lower_sum_set ( ( f `| X ) || A ) ) ) implies r <= ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) )))
proof
let r being  real number;
assume r in ( rng ( lower_sum_set ( ( f `| X ) || A ) ) );
then consider D being (Element of ( divs A )) such that A9: (D in ( dom ( lower_sum_set ( ( f `| X ) || A ) ) ) & r = ( ( lower_sum_set ( ( f `| X ) || A ) ) . D )) by PARTFUN1:3;
reconsider D as (Division of A) by INTEGRA1:def 3;
r = ( lower_sum (( ( f `| X ) || A ),D) ) by A9,FUNCT_2:def 1,INTEGRA1:def 11;
hence thesis by A1,A3,CKB16:1;
end;
( dom ( lower_sum_set ( ( f `| X ) || A ) ) ) = ( divs A ) by FUNCT_2:def 1,INTEGRA1:def 11;
then ( rng ( lower_sum_set ( ( f `| X ) || A ) ) ) is non  empty by RELAT_1:42;
then ( upper_bound ( rng ( lower_sum_set ( ( f `| X ) || A ) ) ) ) <= ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) by A8,SEQ_4:45;
then ( upper_integral ( ( f `| X ) || A ) ) <= ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) by A4,INTEGRA1:def 15;
then ( upper_integral ( ( f `| X ) || A ) ) = ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) by A7,XXREAL_0:1;
hence thesis by INTEGRA1:def 17;
end;
