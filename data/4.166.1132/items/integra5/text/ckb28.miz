environ
vocabularies NUMBERS,SUBSET_1,REAL_1,INTEGRA1,FINSEQ_1,ORDINAL4,CARD_3,ARYTM_1,ARYTM_3,BINOP_2,RELAT_1,FUNCT_1,PARTFUN1,XXREAL_0,FINSEQ_2,NAT_1,XBOOLE_0,REALSET1,VALUED_1,TARSKI,XXREAL_2,XREAL_0,ORDINAL1,ORDINAL2,FCONT_2,INTEGRA2,FUNCT_3,SEQ_2,CARD_1,SEQ_1,COMPLEX1,MEASURE7,FDIFF_1,SEQ_4,XXREAL_1,ZFMISC_1,VALUED_0,SEQM_3,RCOMP_1,INTEGRA5,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,RELAT_1,COMPLEX1,XXREAL_2,ZFMISC_1,RELSET_1,FUNCT_2,RCOMP_1,PARTFUN1,MEASURE6,FINSEQ_1,FUNCOP_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQ_2,SEQ_2,SEQ_4,BINOP_2,REAL_1,NAT_1,FDIFF_1,RVSUM_1,MEASURE5,INTEGRA1,INTEGRA2,INTEGRA3,FCONT_1,FCONT_2,RFUNCT_2,XXREAL_0,CKB4,CKB5,CKB8,CKB9,CKB24,CKB25;
definitions VALUED_1,XXREAL_2,CKB8,CKB9,CKB24,CKB25;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,TARSKI,INTEGRA2,NAT_2,FINSEQ_2,RCOMP_1,FCONT_2,INTEGRA4,FCONT_1,ROLLE,RFUNCT_2,FDIFF_2,RELAT_1,XREAL_0,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_2,XXREAL_1,RELSET_1,INTEGRA3,MEASURE5,CKB1,CKB2,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27;
schemes FINSEQ_2;
registrations XBOOLE_0,RELAT_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FINSEQ_1,FINSEQ_2,RCOMP_1,INTEGRA1,VALUED_0,VALUED_1,FUNCT_2,FINSET_1,XXREAL_2,CARD_1,SEQ_2,RELSET_1,ZFMISC_1,MEASURE5;
constructors PARTFUN1,REAL_1,NAT_1,BINOP_2,COMPLEX1,RFUNCT_1,RFUNCT_2,FCONT_1,FCONT_2,FDIFF_1,ZFMISC_1,MEASURE6,INTEGRA2,SEQ_1,XXREAL_2,RVSUM_1,SEQ_4,RELSET_1,FUNCOP_1,SEQ_2,INTEGRA3,CKB5,CKB8,CKB9,CKB24,CKB25;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve A for non empty  closed_interval (Subset of ( REAL ));
theorem
(for f,g being (PartFunc of ( REAL ),( REAL )) holds (for X being  open (Subset of ( REAL )) holds (((((((f is_differentiable_on X & g is_differentiable_on X) & A c= X) & ( f `| X ) is_integrable_on A) & ( ( f `| X ) | A ) is  bounded) & ( g `| X ) is_integrable_on A) & ( ( g `| X ) | A ) is  bounded) implies ( integral (( ( f `| X ) (#) g ),A) ) = ( ( ( ( f . ( upper_bound A ) ) * ( g . ( upper_bound A ) ) ) - ( ( f . ( lower_bound A ) ) * ( g . ( lower_bound A ) ) ) ) - ( integral (( f (#) ( g `| X ) ),A) ) ))))
proof
let f being (PartFunc of ( REAL ),( REAL )),g being (PartFunc of ( REAL ),( REAL ));
let X being  open (Subset of ( REAL ));
assume that
A1: f is_differentiable_on X
and
A2: g is_differentiable_on X
and
A3: A c= X
and
A4: ( f `| X ) is_integrable_on A
and
A5: ( ( f `| X ) | A ) is  bounded
and
A6: ( g `| X ) is_integrable_on A
and
A7: ( ( g `| X ) | A ) is  bounded;
A8: ( ( f (#) g ) `| X ) = ( ( ( f `| X ) (#) g ) + ( f (#) ( g `| X ) ) ) by A1,A2,FDIFF_2:20;
( g | X ) is  continuous by A2,FDIFF_1:25;
then A9: ( g | A ) is  continuous by A3,FCONT_1:16;
X c= ( dom g ) by A2,FDIFF_1:def 6;
then A10: A c= ( dom g ) by A3,XBOOLE_1:1;
then A11: ( g || A ) is (Function of A,( REAL )) by CKB10:1,FUNCT_2:68;
X c= ( dom g ) by A2,FDIFF_1:def 6;
then g is_integrable_on A by A3,A9,CKB15:1,XBOOLE_1:1;
then A12: ( g || A ) is  integrable by CKB8:def 1;
A13: A c= ( dom ( g `| X ) ) by A2,A3,FDIFF_1:def 7;
then A14: ( ( g `| X ) || A ) is (Function of A,( REAL )) by CKB10:1,FUNCT_2:68;
( g | X ) is  continuous by A2,FDIFF_1:25;
then ( g | A ) is  bounded by A3,A10,CKB14:1,FCONT_1:16;
then A15: ( ( ( f `| X ) (#) g ) | ( A /\ A ) ) is  bounded by A5,RFUNCT_1:84;
then A16: ( ( ( ( f `| X ) (#) g ) || A ) | A ) is  bounded by CKB13:1;
( f | X ) is  continuous by A1,FDIFF_1:25;
then A17: ( f | A ) is  continuous by A3,FCONT_1:16;
X c= ( dom f ) by A1,FDIFF_1:def 6;
then f is_integrable_on A by A3,A17,CKB15:1,XBOOLE_1:1;
then A18: ( f || A ) is  integrable by CKB8:def 1;
A19: A c= ( dom ( f `| X ) ) by A1,A3,FDIFF_1:def 7;
then A20: ( ( f `| X ) || A ) is (Function of A,( REAL )) by CKB10:1,FUNCT_2:68;
A21: (( ( g `| X ) || A ) is  integrable & ( ( ( g `| X ) || A ) | A ) is  bounded) by A6,A7,CKB8:def 1,CKB13:1;
A22: (( ( f `| X ) || A ) is  integrable & ( ( ( f `| X ) || A ) | A ) is  bounded) by A4,A5,CKB8:def 1,CKB13:1;
( dom ( ( f `| X ) (#) g ) ) = ( ( dom ( f `| X ) ) /\ ( dom g ) ) by VALUED_1:def 4;
then A c= ( dom ( ( f `| X ) (#) g ) ) by A10,A19,XBOOLE_1:19;
then A23: ( ( ( f `| X ) (#) g ) || A ) is (Function of A,( REAL )) by CKB10:1,FUNCT_2:68;
X c= ( dom f ) by A1,FDIFF_1:def 6;
then A24: A c= ( dom f ) by A3,XBOOLE_1:1;
then A25: ( f || A ) is (Function of A,( REAL )) by CKB10:1,FUNCT_2:68;
( f | X ) is  continuous by A1,FDIFF_1:25;
then ( f | A ) is  bounded by A3,A24,CKB14:1,FCONT_1:16;
then A26: ( ( f (#) ( g `| X ) ) | ( A /\ A ) ) is  bounded by A7,RFUNCT_1:84;
then A27: ( ( ( f (#) ( g `| X ) ) || A ) | A ) is  bounded by CKB13:1;
( ( ( ( f `| X ) (#) g ) + ( f (#) ( g `| X ) ) ) | ( A /\ A ) ) is  bounded by A15,A26,RFUNCT_1:83;
then A28: ( ( ( f (#) g ) `| X ) | A ) is  bounded by A1,A2,FDIFF_2:20;
A29: (( ( f (#) g ) . ( upper_bound A ) ) = ( ( f . ( upper_bound A ) ) * ( g . ( upper_bound A ) ) ) & ( ( f (#) g ) . ( lower_bound A ) ) = ( ( f . ( lower_bound A ) ) * ( g . ( lower_bound A ) ) )) by VALUED_1:5;
( dom ( f (#) ( g `| X ) ) ) = ( ( dom f ) /\ ( dom ( g `| X ) ) ) by VALUED_1:def 4;
then A c= ( dom ( f (#) ( g `| X ) ) ) by A24,A13,XBOOLE_1:19;
then A30: ( ( f (#) ( g `| X ) ) || A ) is (Function of A,( REAL )) by CKB10:1,FUNCT_2:68;
( ( g || A ) | A ) is  bounded by A9,A10,CKB13:1,CKB14:1;
then ( ( ( f `| X ) || A ) (#) ( g || A ) ) is  integrable by A12,A11,A20,A22,INTEGRA4:29;
then A31: ( ( ( f `| X ) (#) g ) || A ) is  integrable by CKB6:1;
( ( f || A ) | A ) is  bounded by A17,A24,CKB13:1,CKB14:1;
then ( ( f || A ) (#) ( ( g `| X ) || A ) ) is  integrable by A18,A25,A14,A21,INTEGRA4:29;
then A32: ( ( f (#) ( g `| X ) ) || A ) is  integrable by CKB6:1;
then ( integral ( ( ( ( f `| X ) (#) g ) || A ) + ( ( f (#) ( g `| X ) ) || A ) ) ) = ( ( integral ( ( ( f `| X ) (#) g ) || A ) ) + ( integral ( ( f (#) ( g `| X ) ) || A ) ) ) by A31,A23,A16,A30,A27,INTEGRA1:57;
then A33: ( integral ( ( ( ( f `| X ) (#) g ) + ( f (#) ( g `| X ) ) ) || A ) ) = ( ( integral (( ( f `| X ) (#) g ),A) ) + ( integral (( f (#) ( g `| X ) ),A) ) ) by CKB7:1;
( ( ( ( f `| X ) (#) g ) || A ) + ( ( f (#) ( g `| X ) ) || A ) ) is  integrable by A31,A32,A23,A16,A30,A27,INTEGRA1:57;
then ( ( ( ( f `| X ) (#) g ) + ( f (#) ( g `| X ) ) ) || A ) is  integrable by CKB7:1;
then A34: ( ( f (#) g ) `| X ) is_integrable_on A by A8,CKB8:def 1;
( integral ( ( ( f (#) g ) `| X ) || A ) ) = ( integral (( ( f (#) g ) `| X ),A) )
.= ( ( ( f (#) g ) . ( upper_bound A ) ) - ( ( f (#) g ) . ( lower_bound A ) ) ) by A1,A2,A3,A34,A28,CKB17:1,FDIFF_2:20;
hence thesis by A8,A29,A33;
end;
