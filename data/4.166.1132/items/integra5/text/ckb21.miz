environ
vocabularies NUMBERS,SUBSET_1,REAL_1,INTEGRA1,FINSEQ_1,ORDINAL4,CARD_3,ARYTM_1,ARYTM_3,BINOP_2,RELAT_1,FUNCT_1,PARTFUN1,XXREAL_0,FINSEQ_2,NAT_1,XBOOLE_0,REALSET1,VALUED_1,TARSKI,XXREAL_2,XREAL_0,ORDINAL1,ORDINAL2,FCONT_2,INTEGRA2,FUNCT_3,SEQ_2,CARD_1,SEQ_1,COMPLEX1,MEASURE7,FDIFF_1,SEQ_4,XXREAL_1,ZFMISC_1,VALUED_0,SEQM_3,RCOMP_1,INTEGRA5,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,RELAT_1,COMPLEX1,XXREAL_2,ZFMISC_1,RELSET_1,FUNCT_2,RCOMP_1,PARTFUN1,MEASURE6,FINSEQ_1,FUNCOP_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQ_2,SEQ_2,SEQ_4,BINOP_2,REAL_1,NAT_1,FDIFF_1,RVSUM_1,MEASURE5,INTEGRA1,INTEGRA2,INTEGRA3,FCONT_1,FCONT_2,RFUNCT_2,XXREAL_0,CKB4,CKB5,CKB8,CKB9;
definitions VALUED_1,XXREAL_2,CKB8,CKB9;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,TARSKI,INTEGRA2,NAT_2,FINSEQ_2,RCOMP_1,FCONT_2,INTEGRA4,FCONT_1,ROLLE,RFUNCT_2,FDIFF_2,RELAT_1,XREAL_0,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_2,XXREAL_1,RELSET_1,INTEGRA3,MEASURE5,CKB1,CKB2,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20;
schemes FINSEQ_2;
registrations XBOOLE_0,RELAT_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FINSEQ_1,FINSEQ_2,RCOMP_1,INTEGRA1,VALUED_0,VALUED_1,FUNCT_2,FINSET_1,XXREAL_2,CARD_1,SEQ_2,RELSET_1,ZFMISC_1,MEASURE5;
constructors PARTFUN1,REAL_1,NAT_1,BINOP_2,COMPLEX1,RFUNCT_1,RFUNCT_2,FCONT_1,FCONT_2,FDIFF_1,ZFMISC_1,MEASURE6,INTEGRA2,SEQ_1,XXREAL_2,RVSUM_1,SEQ_4,RELSET_1,FUNCOP_1,SEQ_2,INTEGRA3,CKB5,CKB8,CKB9;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve x for Real;
reserve A for non empty  closed_interval (Subset of ( REAL ));
theorem
(for f being (PartFunc of ( REAL ),( REAL )) holds ((( f | A ) is  monotone & A c= ( dom f )) implies f is_integrable_on A))
proof
let f being (PartFunc of ( REAL ),( REAL ));
assume that
A1: ( f | A ) is  monotone
and
A2: A c= ( dom f );
per cases  by A1,RFUNCT_2:def 5;
suppose ( f | A ) is  non-decreasing;

hence thesis by A2,CKB20:1;
end;
suppose ( f | A ) is  non-increasing;

then A3: ( ( ( - 1 ) (#) f ) | A ) is  non-decreasing by RFUNCT_2:35;
A4: (( ( - f ) || A ) is  total & ( ( ( - f ) || A ) | A ) is  bounded)
proof
consider x such that A5: x in A by SUBSET_1:4;
A6: ( dom ( ( - f ) || A ) ) = ( ( dom ( - f ) ) /\ A ) by RELAT_1:61
.= ( ( dom f ) /\ A ) by VALUED_1:8
.= A by A2,XBOOLE_1:28;
hence ( ( - f ) || A ) is  total by PARTFUN1:def 2;
(( lower_bound A ) <= x & x <= ( upper_bound A )) by A5,INTEGRA2:1;
then A7: ( lower_bound A ) <= ( upper_bound A ) by XXREAL_0:2;
(for x being set holds (x in ( A /\ ( dom ( ( - f ) || A ) ) ) implies ( ( ( - f ) || A ) . x ) >= ( ( ( - f ) || A ) . ( lower_bound A ) )))
proof
let x being set;
assume x in ( A /\ ( dom ( ( - f ) || A ) ) );
then reconsider x as (Element of A);
A8: (x >= ( lower_bound A ) & ( ( - f ) . x ) = ( ( ( - f ) | A ) . x )) by A6,FUNCT_1:47,INTEGRA2:1;
( lower_bound A ) in A by A7,INTEGRA2:1;
then A9: ( ( - f ) . ( lower_bound A ) ) = ( ( ( - f ) | A ) . ( lower_bound A ) ) by A6,FUNCT_1:47;
A10: A = ( A /\ ( dom f ) ) by A2,XBOOLE_1:28
.= ( A /\ ( dom ( - f ) ) ) by VALUED_1:8;
then ( lower_bound A ) in ( A /\ ( dom ( - f ) ) ) by A7,INTEGRA2:1;
hence thesis by A3,A10,A8,A9,RFUNCT_2:24;
end;
then A11: ( ( ( - f ) || A ) | A ) is  bounded_below by RFUNCT_1:71;
(for x being set holds (x in ( A /\ ( dom ( ( - f ) || A ) ) ) implies ( ( ( - f ) || A ) . x ) <= ( ( ( - f ) || A ) . ( upper_bound A ) )))
proof
let x being set;
assume x in ( A /\ ( dom ( ( - f ) || A ) ) );
then reconsider x as (Element of A);
A12: (x <= ( upper_bound A ) & ( ( - f ) . x ) = ( ( ( - f ) | A ) . x )) by A6,FUNCT_1:47,INTEGRA2:1;
( upper_bound A ) in A by A7,INTEGRA2:1;
then A13: ( ( - f ) . ( upper_bound A ) ) = ( ( ( - f ) | A ) . ( upper_bound A ) ) by A6,FUNCT_1:47;
A14: A = ( A /\ ( dom f ) ) by A2,XBOOLE_1:28
.= ( A /\ ( dom ( - f ) ) ) by VALUED_1:8;
then ( upper_bound A ) in ( A /\ ( dom ( - f ) ) ) by A7,INTEGRA2:1;
hence thesis by A3,A14,A12,A13,RFUNCT_2:24;
end;
then ( ( ( - f ) || A ) | A ) is  bounded_above by RFUNCT_1:70;
hence thesis by A11;
end;
( dom f ) = ( dom ( - f ) ) by VALUED_1:8;
then ( - f ) is_integrable_on A by A2,A3,CKB20:1;
then ( ( - f ) || A ) is  integrable by CKB8:def 1;
then A15: ( ( - 1 ) (#) ( ( - f ) || A ) ) is  integrable by A4,INTEGRA2:31;
A16: ( dom ( ( - f ) || A ) ) = ( ( dom ( - f ) ) /\ A ) by RELAT_1:61
.= ( ( dom f ) /\ A ) by VALUED_1:8
.= A by A2,XBOOLE_1:28;
then A17: A = ( dom ( ( - 1 ) (#) ( ( - f ) || A ) ) ) by VALUED_1:def 5;
A18: ( dom ( f || A ) ) = ( ( dom f ) /\ A ) by RELAT_1:61;
then A19: ( dom ( f || A ) ) = A by A2,XBOOLE_1:28;
A20: ( dom ( ( - 1 ) (#) ( ( - f ) || A ) ) ) = A by A16,VALUED_1:def 5;
A21: (for z being (Element of A) holds (z in A implies ( ( ( - 1 ) (#) ( ( - f ) || A ) ) . z ) = ( ( f || A ) . z )))
proof
let z being (Element of A);
assume z in A;
( ( ( - f ) || A ) . z ) = ( ( - f ) . z ) by A16,FUNCT_1:47
.= ( - ( f . z ) ) by VALUED_1:8;
then ( ( ( - 1 ) (#) ( ( - f ) || A ) ) . z ) = ( ( - 1 ) * ( - ( f . z ) ) ) by A20,VALUED_1:def 5
.= ( f . z );
hence thesis by A19,FUNCT_1:47;
end;
A = ( dom ( f || A ) ) by A2,A18,XBOOLE_1:28;
then ( ( - 1 ) (#) ( ( - f ) || A ) ) = ( f || A ) by A21,A17,PARTFUN1:5;
hence thesis by A15,CKB8:def 1;
end;
end;
