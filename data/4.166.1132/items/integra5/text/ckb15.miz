environ
vocabularies NUMBERS,SUBSET_1,REAL_1,INTEGRA1,FINSEQ_1,ORDINAL4,CARD_3,ARYTM_1,ARYTM_3,BINOP_2,RELAT_1,FUNCT_1,PARTFUN1,XXREAL_0,FINSEQ_2,NAT_1,XBOOLE_0,REALSET1,VALUED_1,TARSKI,XXREAL_2,XREAL_0,ORDINAL1,ORDINAL2,FCONT_2,INTEGRA2,FUNCT_3,SEQ_2,CARD_1,SEQ_1,COMPLEX1,MEASURE7,FDIFF_1,SEQ_4,XXREAL_1,ZFMISC_1,VALUED_0,SEQM_3,RCOMP_1,INTEGRA5,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,RELAT_1,COMPLEX1,XXREAL_2,ZFMISC_1,RELSET_1,FUNCT_2,RCOMP_1,PARTFUN1,MEASURE6,FINSEQ_1,FUNCOP_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQ_2,SEQ_2,SEQ_4,BINOP_2,REAL_1,NAT_1,FDIFF_1,RVSUM_1,MEASURE5,INTEGRA1,INTEGRA2,INTEGRA3,FCONT_1,FCONT_2,RFUNCT_2,XXREAL_0,CKB4,CKB5,CKB8,CKB9;
definitions VALUED_1,XXREAL_2,CKB8,CKB9;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,TARSKI,INTEGRA2,NAT_2,FINSEQ_2,RCOMP_1,FCONT_2,INTEGRA4,FCONT_1,ROLLE,RFUNCT_2,FDIFF_2,RELAT_1,XREAL_0,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_2,XXREAL_1,RELSET_1,INTEGRA3,MEASURE5,CKB1,CKB2,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14;
schemes FINSEQ_2;
registrations XBOOLE_0,RELAT_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FINSEQ_1,FINSEQ_2,RCOMP_1,INTEGRA1,VALUED_0,VALUED_1,FUNCT_2,FINSET_1,XXREAL_2,CARD_1,SEQ_2,RELSET_1,ZFMISC_1,MEASURE5;
constructors PARTFUN1,REAL_1,NAT_1,BINOP_2,COMPLEX1,RFUNCT_1,RFUNCT_2,FCONT_1,FCONT_2,FDIFF_1,ZFMISC_1,MEASURE6,INTEGRA2,SEQ_1,XXREAL_2,RVSUM_1,SEQ_4,RELSET_1,FUNCOP_1,SEQ_2,INTEGRA3,CKB5,CKB8,CKB9;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve r for Real;
reserve r1 for Real;
reserve s for Real;
reserve x for Real;
reserve x1 for Real;
reserve x2 for Real;
reserve A for non  empty  closed_interval (Subset of ( REAL ));
theorem
Th11: (for f being (PartFunc of ( REAL ),( REAL )) holds ((A c= ( dom f ) & ( f | A ) is  continuous) implies f is_integrable_on A))
proof
let f being (PartFunc of ( REAL ),( REAL ));
assume A1: A c= ( dom f );
reconsider g = ( f | A ) as (PartFunc of A,( REAL )) by PARTFUN1:10;
A2: ( dom g ) = ( ( dom f ) /\ A ) by RELAT_1:61
.= A by A1,XBOOLE_1:28;
then A3: g is  total by PARTFUN1:def 2;
(for y being set holds (y in ( f .: A ) implies y in ( rng g )))
proof
let y being set;
assume y in ( f .: A );
then consider x being set such that x in ( dom f ) and A4: x in A and A5: y = ( f . x ) by FUNCT_1:def 6;
( g . x ) in ( rng g ) by A2,A4,FUNCT_1:def 3;
hence thesis by A2,A4,A5,FUNCT_1:47;
end;
then A6: ( f .: A ) c= ( rng g ) by TARSKI:def 3;
(for y being set holds (y in ( rng g ) implies y in ( f .: A )))
proof
let y being set;
assume y in ( rng g );
then consider x being set such that A7: x in ( dom g ) and A8: y = ( g . x ) by FUNCT_1:def 3;
( f . x ) in ( f .: A ) by A1,A2,A7,FUNCT_1:def 6;
hence thesis by A7,A8,FUNCT_1:47;
end;
then ( rng g ) c= ( f .: A ) by TARSKI:def 3;
then A9: ( rng g ) = ( f .: A ) by A6,XBOOLE_0:def 10;
assume A10: ( f | A ) is  continuous;
then ( f .: A ) is  bounded by A1,FCONT_1:29,RCOMP_1:10;
then A11: (( g | A ) is  bounded_above & ( g | A ) is  bounded_below) by A9,INTEGRA1:12,INTEGRA1:14;
reconsider g as (Function of A,( REAL )) by A3;
A12: ( f | A ) is  uniformly_continuous by A1,A10,FCONT_2:11;
(for T being (DivSequence of A) holds ((( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 )) implies ( ( lim ( upper_sum (g,T) ) ) - ( lim ( lower_sum (g,T) ) ) ) = ( 0 )))
proof
let T being (DivSequence of A);
reconsider osc = ( ( upper_sum (g,T) ) - ( lower_sum (g,T) ) ) as Real_Sequence;
assume A13: (( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 ));
A14: (for r being  real number holds (( 0 ) < r implies (ex n st (for m holds (n <= m implies ( abs ( ( osc . m ) - ( 0 ) ) ) < r)))))
proof
let r being  real number;
assume A15: r > ( 0 );
(ex r1 st (r1 > ( 0 ) & ( r1 * ( vol A ) ) < r))
proof
now
per cases  by INTEGRA1:9;
suppose A16: ( vol A ) = ( 0 );

consider r1 such that A17: r1 = 1;
( r1 * ( vol A ) ) < r by A15,A16;
hence thesis by A17;
end;
suppose A18: ( vol A ) > ( 0 );

then ( r / ( vol A ) ) > ( 0 ) by A15,XREAL_1:139;
then consider r1 being  real number such that A19: ( 0 ) < r1 and A20: r1 < ( r / ( vol A ) ) by XREAL_1:5;
reconsider r1 as Real by XREAL_0:def 1;
( r1 * ( vol A ) ) < r by A18,A20,XREAL_1:79;
hence thesis by A19;
end;
end;
hence thesis;
end;
then consider r1 such that A21: r1 > ( 0 ) and A22: ( r1 * ( vol A ) ) < r;
consider s such that A23: ( 0 ) < s and A24: (for x1 holds (for x2 holds (((x1 in ( dom ( f | A ) ) & x2 in ( dom ( f | A ) )) & ( abs ( x1 - x2 ) ) < s) implies ( abs ( ( f . x1 ) - ( f . x2 ) ) ) < r1))) by A12,A21,FCONT_2:1;
consider n such that A25: (for m holds (n <= m implies ( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) < s)) by A13,A23,SEQ_2:def 7;
A26: (for m holds (n <= m implies ( ( ( upper_sum (g,T) ) . m ) - ( ( lower_sum (g,T) ) . m ) ) <= ( r1 * ( vol A ) )))
proof
let m;
reconsider D = ( T . m ) as (Division of A);
( len ( upper_volume (g,D) ) ) = ( len D ) by INTEGRA1:def 6;
then reconsider UV = ( upper_volume (g,D) ) as (Element of ( ( len D ) -tuples_on ( REAL ) )) by FINSEQ_2:92;
( len ( lower_volume (g,D) ) ) = ( len D ) by INTEGRA1:def 7;
then reconsider LV = ( lower_volume (g,D) ) as (Element of ( ( len D ) -tuples_on ( REAL ) )) by FINSEQ_2:92;
reconsider OSC = ( UV - LV ) as (Element of ( ( len D ) -tuples_on ( REAL ) ));
( len ( upper_volume (( chi (A,A) ),D) ) ) = ( len D ) by INTEGRA1:def 6;
then reconsider VOL = ( upper_volume (( chi (A,A) ),D) ) as (Element of ( ( len D ) -tuples_on ( REAL ) )) by FINSEQ_2:92;
assume A27: n <= m;
A28: (for k holds (k in ( dom D ) implies ( ( ( upper_volume (g,D) ) . k ) - ( ( lower_volume (g,D) ) . k ) ) <= ( r1 * ( ( upper_volume (( chi (A,A) ),D) ) . k ) )))
proof
let k;
assume A29: k in ( dom D );
reconsider h = ( g | ( divset (D,k) ) ) as (PartFunc of ( divset (D,k) ),( REAL )) by PARTFUN1:10;
( dom g ) = A by PARTFUN1:def 2;
then ( ( dom g ) /\ ( divset (D,k) ) ) = ( divset (D,k) ) by A29,INTEGRA1:8,XBOOLE_1:28;
then ( dom h ) = ( divset (D,k) ) by RELAT_1:61;
then h is  total by PARTFUN1:def 2;
then reconsider h as (Function of ( divset (D,k) ),( REAL ));
A30: (for x1 holds (for x2 holds ((x1 in ( divset (D,k) ) & x2 in ( divset (D,k) )) implies ( abs ( ( h . x1 ) - ( h . x2 ) ) ) <= r1)))
proof
( ( upper_volume (( chi (A,A) ),D) ) . k ) = ( vol ( divset (D,k) ) ) by A29,INTEGRA1:20;
then A31: ( ( upper_volume (( chi (A,A) ),D) ) . k ) >= ( 0 ) by INTEGRA1:9;
k in ( Seg ( len D ) ) by A29,FINSEQ_1:def 3;
then k in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by INTEGRA1:def 6;
then k in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
then A32: ( ( upper_volume (( chi (A,A) ),D) ) . k ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by FUNCT_1:def 3;
( dom h ) = ( ( dom g ) /\ ( divset (D,k) ) ) by RELAT_1:61;
then A33: ( dom h ) c= ( dom g ) by XBOOLE_1:17;
let x1;
let x2;
assume that
A34: x1 in ( divset (D,k) )
and
A35: x2 in ( divset (D,k) );
A36: x2 in ( dom h ) by A35,PARTFUN1:def 2;
then ( g . x2 ) = ( h . x2 ) by FUNCT_1:47;
then A37: ( f . x2 ) = ( h . x2 ) by A36,A33,FUNCT_1:47;
A38: ( abs ( x1 - x2 ) ) <= ( ( delta T ) . m )
proof
now
per cases ;
suppose x1 >= x2;

then ( x1 - x2 ) >= ( 0 ) by XREAL_1:48;
then A39: ( abs ( x1 - x2 ) ) = ( x1 - x2 ) by ABSVALUE:def 1;
(x1 <= ( upper_bound ( divset (D,k) ) ) & x2 >= ( lower_bound ( divset (D,k) ) )) by A34,A35,INTEGRA2:1;
then ( abs ( x1 - x2 ) ) <= ( ( upper_bound ( divset (D,k) ) ) - ( lower_bound ( divset (D,k) ) ) ) by A39,XREAL_1:13;
then A40: ( abs ( x1 - x2 ) ) <= ( vol ( divset (D,k) ) ) by INTEGRA1:def 5;
k in ( Seg ( len D ) ) by A29,FINSEQ_1:def 3;
then k in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by INTEGRA1:def 6;
then k in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
then ( ( upper_volume (( chi (A,A) ),D) ) . k ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by FUNCT_1:def 3;
then ( ( upper_volume (( chi (A,A) ),D) ) . k ) <= ( max ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by XXREAL_2:def 8;
then A41: ( ( upper_volume (( chi (A,A) ),D) ) . k ) <= ( delta ( T . m ) ) by INTEGRA3:def 1;
( ( upper_volume (( chi (A,A) ),D) ) . k ) = ( vol ( divset (D,k) ) ) by A29,INTEGRA1:20;
then ( abs ( x1 - x2 ) ) <= ( delta ( T . m ) ) by A40,A41,XXREAL_0:2;
hence thesis by INTEGRA3:def 2;
end;
suppose x1 < x2;

then ( x1 - x2 ) < ( 0 ) by XREAL_1:49;
then ( abs ( x1 - x2 ) ) = ( - ( x1 - x2 ) ) by ABSVALUE:def 1;
then A42: ( abs ( x1 - x2 ) ) = ( x2 - x1 );
(x2 <= ( upper_bound ( divset (D,k) ) ) & x1 >= ( lower_bound ( divset (D,k) ) )) by A34,A35,INTEGRA2:1;
then ( abs ( x1 - x2 ) ) <= ( ( upper_bound ( divset (D,k) ) ) - ( lower_bound ( divset (D,k) ) ) ) by A42,XREAL_1:13;
then A43: ( abs ( x1 - x2 ) ) <= ( vol ( divset (D,k) ) ) by INTEGRA1:def 5;
k in ( Seg ( len D ) ) by A29,FINSEQ_1:def 3;
then k in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by INTEGRA1:def 6;
then k in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
then ( ( upper_volume (( chi (A,A) ),D) ) . k ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by FUNCT_1:def 3;
then ( ( upper_volume (( chi (A,A) ),D) ) . k ) <= ( max ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by XXREAL_2:def 8;
then A44: ( ( upper_volume (( chi (A,A) ),D) ) . k ) <= ( delta ( T . m ) ) by INTEGRA3:def 1;
( ( upper_volume (( chi (A,A) ),D) ) . k ) = ( vol ( divset (D,k) ) ) by A29,INTEGRA1:20;
then ( abs ( x1 - x2 ) ) <= ( delta ( T . m ) ) by A43,A44,XXREAL_0:2;
hence thesis by INTEGRA3:def 2;
end;
end;
hence thesis;
end;
( ( delta T ) . m ) = ( delta D ) by INTEGRA3:def 2
.= ( max ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by INTEGRA3:def 1;
then ( ( ( delta T ) . m ) - ( 0 ) ) >= ( 0 ) by A31,A32,XXREAL_2:def 8;
then A45: ( abs ( x1 - x2 ) ) <= ( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) by A38,ABSVALUE:def 1;
( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) < s by A25,A27;
then A46: ( abs ( x1 - x2 ) ) < s by A45,XXREAL_0:2;
A47: x1 in ( dom h ) by A34,PARTFUN1:def 2;
then ( g . x1 ) = ( h . x1 ) by FUNCT_1:47;
then ( f . x1 ) = ( h . x1 ) by A47,A33,FUNCT_1:47;
hence thesis by A24,A46,A47,A36,A33,A37;
end;
( vol ( divset (D,k) ) ) >= ( 0 ) by INTEGRA1:9;
then ( ( ( upper_bound ( rng ( g | ( divset (D,k) ) ) ) ) - ( lower_bound ( rng ( g | ( divset (D,k) ) ) ) ) ) * ( vol ( divset (D,k) ) ) ) <= ( r1 * ( vol ( divset (D,k) ) ) ) by A30,INTEGRA4:24,XREAL_1:64;
then ( ( ( upper_bound ( rng ( g | ( divset (D,k) ) ) ) ) * ( vol ( divset (D,k) ) ) ) - ( ( lower_bound ( rng ( g | ( divset (D,k) ) ) ) ) * ( vol ( divset (D,k) ) ) ) ) <= ( r1 * ( vol ( divset (D,k) ) ) );
then ( ( ( upper_volume (g,D) ) . k ) - ( ( lower_bound ( rng ( g | ( divset (D,k) ) ) ) ) * ( vol ( divset (D,k) ) ) ) ) <= ( r1 * ( vol ( divset (D,k) ) ) ) by A29,INTEGRA1:def 6;
then ( ( ( upper_volume (g,D) ) . k ) - ( ( lower_volume (g,D) ) . k ) ) <= ( r1 * ( vol ( divset (D,k) ) ) ) by A29,INTEGRA1:def 7;
hence thesis by A29,INTEGRA1:20;
end;
(for k being Nat holds (k in ( Seg ( len D ) ) implies ( OSC . k ) <= ( ( r1 * VOL ) . k )))
proof
let k being Nat;
assume k in ( Seg ( len D ) );
then A48: k in ( dom D ) by FINSEQ_1:def 3;
( OSC . k ) = ( ( ( upper_volume (g,D) ) . k ) - ( ( lower_volume (g,D) ) . k ) ) by RVSUM_1:27;
then ( OSC . k ) <= ( r1 * ( VOL . k ) ) by A28,A48;
hence thesis by RVSUM_1:45;
end;
then ( Sum OSC ) <= ( Sum ( r1 * VOL ) ) by RVSUM_1:82;
then ( Sum OSC ) <= ( r1 * ( Sum VOL ) ) by RVSUM_1:87;
then ( ( Sum UV ) - ( Sum LV ) ) <= ( r1 * ( Sum VOL ) ) by RVSUM_1:90;
then ( ( upper_sum (g,D) ) - ( Sum LV ) ) <= ( r1 * ( Sum VOL ) ) by INTEGRA1:def 8;
then ( ( upper_sum (g,D) ) - ( lower_sum (g,D) ) ) <= ( r1 * ( Sum VOL ) ) by INTEGRA1:def 9;
then ( ( upper_sum (g,D) ) - ( lower_sum (g,D) ) ) <= ( r1 * ( vol A ) ) by INTEGRA1:24;
then ( ( ( upper_sum (g,T) ) . m ) - ( lower_sum (g,D) ) ) <= ( r1 * ( vol A ) ) by INTEGRA2:def 2;
hence thesis by INTEGRA2:def 3;
end;
(for m holds (n <= m implies ( abs ( ( osc . m ) - ( 0 ) ) ) < r))
proof
let m;
reconsider D = ( T . m ) as (Division of A);
assume n <= m;
then ( ( ( upper_sum (g,T) ) . m ) - ( ( lower_sum (g,T) ) . m ) ) <= ( r1 * ( vol A ) ) by A26;
then A49: ( ( ( upper_sum (g,T) ) . m ) - ( ( lower_sum (g,T) ) . m ) ) < r by A22,XXREAL_0:2;
( upper_sum (g,D) ) >= ( lower_sum (g,D) ) by A11,INTEGRA1:28;
then ( ( upper_sum (g,T) ) . m ) >= ( lower_sum (g,D) ) by INTEGRA2:def 2;
then ( ( upper_sum (g,T) ) . m ) >= ( ( lower_sum (g,T) ) . m ) by INTEGRA2:def 3;
then A50: ( ( ( upper_sum (g,T) ) . m ) - ( ( lower_sum (g,T) ) . m ) ) >= ( 0 ) by XREAL_1:48;
( osc . m ) = ( ( ( upper_sum (g,T) ) . m ) + ( ( - ( lower_sum (g,T) ) ) . m ) ) by SEQ_1:7
.= ( ( ( upper_sum (g,T) ) . m ) + ( - ( ( lower_sum (g,T) ) . m ) ) ) by SEQ_1:10
.= ( ( ( upper_sum (g,T) ) . m ) - ( ( lower_sum (g,T) ) . m ) );
hence thesis by A49,A50,ABSVALUE:def 1;
end;
hence thesis;
end;
then osc is  convergent by SEQ_2:def 6;
then A51: ( lim osc ) = ( 0 ) by A14,SEQ_2:def 7;
(( upper_sum (g,T) ) is  convergent & ( lower_sum (g,T) ) is  convergent) by A11,A13,INTEGRA4:8,INTEGRA4:9;
hence thesis by A51,SEQ_2:12;
end;
then g is  integrable by A11,INTEGRA4:12;
hence thesis by CKB8:def 1;
end;
