environ
vocabularies NUMBERS,SUBSET_1,REAL_1,INTEGRA1,FINSEQ_1,ORDINAL4,CARD_3,ARYTM_1,ARYTM_3,BINOP_2,RELAT_1,FUNCT_1,PARTFUN1,XXREAL_0,FINSEQ_2,NAT_1,XBOOLE_0,REALSET1,VALUED_1,TARSKI,XXREAL_2,XREAL_0,ORDINAL1,ORDINAL2,FCONT_2,INTEGRA2,FUNCT_3,SEQ_2,CARD_1,SEQ_1,COMPLEX1,MEASURE7,FDIFF_1,SEQ_4,XXREAL_1,ZFMISC_1,VALUED_0,SEQM_3,RCOMP_1,INTEGRA5,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,RELAT_1,COMPLEX1,XXREAL_2,ZFMISC_1,RELSET_1,FUNCT_2,RCOMP_1,PARTFUN1,MEASURE6,FINSEQ_1,FUNCOP_1,VALUED_1,SEQ_1,RFUNCT_1,FINSEQ_2,SEQ_2,SEQ_4,BINOP_2,REAL_1,NAT_1,FDIFF_1,RVSUM_1,MEASURE5,INTEGRA1,INTEGRA2,INTEGRA3,FCONT_1,FCONT_2,RFUNCT_2,XXREAL_0,CKB4,CKB5,CKB8,CKB9;
definitions VALUED_1,XXREAL_2,CKB8,CKB9;
theorems SEQ_4,SUBSET_1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,TARSKI,INTEGRA2,NAT_2,FINSEQ_2,RCOMP_1,FCONT_2,INTEGRA4,FCONT_1,ROLLE,RFUNCT_2,FDIFF_2,RELAT_1,XREAL_0,FUNCT_2,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_2,XXREAL_1,RELSET_1,INTEGRA3,MEASURE5,CKB1,CKB2,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19;
schemes FINSEQ_2;
registrations XBOOLE_0,RELAT_1,NUMBERS,XXREAL_0,XREAL_0,MEMBERED,FINSEQ_1,FINSEQ_2,RCOMP_1,INTEGRA1,VALUED_0,VALUED_1,FUNCT_2,FINSET_1,XXREAL_2,CARD_1,SEQ_2,RELSET_1,ZFMISC_1,MEASURE5;
constructors PARTFUN1,REAL_1,NAT_1,BINOP_2,COMPLEX1,RFUNCT_1,RFUNCT_2,FCONT_1,FCONT_2,FDIFF_1,ZFMISC_1,MEASURE6,INTEGRA2,SEQ_1,XXREAL_2,RVSUM_1,SEQ_4,RELSET_1,FUNCOP_1,SEQ_2,INTEGRA3,CKB5,CKB8,CKB9;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve x for Real;
reserve A for non empty  closed_interval (Subset of ( REAL ));
theorem
Lm1: (for f being (PartFunc of ( REAL ),( REAL )) holds ((( f | A ) is  non-decreasing & A c= ( dom f )) implies f is_integrable_on A))
proof
let f being (PartFunc of ( REAL ),( REAL ));
assume that
A1: ( f | A ) is  non-decreasing
and
A2: A c= ( dom f );
A3: (for D being (Division of A) holds (for k holds (k in ( dom D ) implies (( 0 ) <= ( ( ( upper_volume (( f || A ),D) ) . k ) - ( ( lower_volume (( f || A ),D) ) . k ) ) & ( ( ( upper_volume (( f || A ),D) ) . k ) - ( ( lower_volume (( f || A ),D) ) . k ) ) <= ( ( ( f . ( upper_bound ( divset (D,k) ) ) ) - ( f . ( lower_bound ( divset (D,k) ) ) ) ) * ( delta D ) )))))
proof
let D being (Division of A);
let k;
assume A4: k in ( dom D );
then A5: (( ( upper_volume (( f || A ),D) ) . k ) = ( ( upper_bound ( rng ( ( f || A ) | ( divset (D,k) ) ) ) ) * ( vol ( divset (D,k) ) ) ) & ( ( lower_volume (( f || A ),D) ) . k ) = ( ( lower_bound ( rng ( ( f || A ) | ( divset (D,k) ) ) ) ) * ( vol ( divset (D,k) ) ) )) by INTEGRA1:def 6,INTEGRA1:def 7;
k in ( Seg ( len D ) ) by A4,FINSEQ_1:def 3;
then k in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by INTEGRA1:def 6;
then A6: k in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
( vol ( divset (D,k) ) ) = ( ( upper_volume (( chi (A,A) ),D) ) . k ) by A4,INTEGRA1:20;
then ( vol ( divset (D,k) ) ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by A6,FUNCT_1:def 3;
then ( vol ( divset (D,k) ) ) <= ( max ( rng ( upper_volume (( chi (A,A) ),D) ) ) ) by XXREAL_2:def 8;
then A7: ( vol ( divset (D,k) ) ) <= ( delta D ) by INTEGRA3:def 1;
A8: ( divset (D,k) ) c= A by A4,INTEGRA1:8;
then A9: ( divset (D,k) ) c= ( dom f ) by A2,XBOOLE_1:1;
( f | ( divset (D,k) ) ) is  non-decreasing by A1,A4,INTEGRA1:8,RFUNCT_2:30;
then A10: (( lower_bound ( rng ( f | ( divset (D,k) ) ) ) ) = ( f . ( lower_bound ( divset (D,k) ) ) ) & ( upper_bound ( rng ( f | ( divset (D,k) ) ) ) ) = ( f . ( upper_bound ( divset (D,k) ) ) )) by A9,CKB19:1;
( dom ( f | ( divset (D,k) ) ) ) = ( ( dom f ) /\ ( divset (D,k) ) ) by RELAT_1:61
.= ( divset (D,k) ) by A2,A8,XBOOLE_1:1,XBOOLE_1:28;
then A11: ( rng ( f | ( divset (D,k) ) ) ) <> ( {} ) by RELAT_1:42;
A12: ( rng ( f | ( divset (D,k) ) ) ) = ( rng ( ( f || A ) | ( divset (D,k) ) ) ) by A8,FUNCT_1:51;
( rng ( f | A ) ) is  bounded by A1,A2,CKB18:1;
then ( rng ( f | ( divset (D,k) ) ) ) is  bounded by A12,RELAT_1:70,XXREAL_2:45;
then A13: ( ( f . ( upper_bound ( divset (D,k) ) ) ) - ( f . ( lower_bound ( divset (D,k) ) ) ) ) >= ( 0 ) by A10,A11,SEQ_4:11,XREAL_1:48;
( vol ( divset (D,k) ) ) >= ( 0 ) by INTEGRA1:9;
then ( ( 0 ) * ( vol ( divset (D,k) ) ) ) <= ( ( ( f . ( upper_bound ( divset (D,k) ) ) ) - ( f . ( lower_bound ( divset (D,k) ) ) ) ) * ( vol ( divset (D,k) ) ) ) by A13;
hence ( 0 ) <= ( ( ( upper_volume (( f || A ),D) ) . k ) - ( ( lower_volume (( f || A ),D) ) . k ) ) by A10,A5,A12;
( ( ( upper_volume (( f || A ),D) ) . k ) - ( ( lower_volume (( f || A ),D) ) . k ) ) = ( ( ( f . ( upper_bound ( divset (D,k) ) ) ) - ( f . ( lower_bound ( divset (D,k) ) ) ) ) * ( vol ( divset (D,k) ) ) ) by A10,A5,A12;
hence thesis by A13,A7,XREAL_1:64;
end;
A14: (for D being (Division of A) holds (( ( upper_sum (( f || A ),D) ) - ( lower_sum (( f || A ),D) ) ) <= ( ( delta D ) * ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) & ( ( upper_sum (( f || A ),D) ) - ( lower_sum (( f || A ),D) ) ) >= ( 0 )))
proof
let D being (Division of A);
deffunc F(Nat) = ( f . ( upper_bound ( divset (D,$1) ) ) );
consider F1 being (FinSequence of ( REAL )) such that A15: (( len F1 ) = ( len D ) & (for i being Nat holds (i in ( dom F1 ) implies ( F1 . i ) = F(i)))) from FINSEQ_2:sch 1;
( ( len D ) - 1 ) in ( NAT )
proof
(ex j being Nat st ( len D ) = ( 1 + j )) by NAT_1:10,NAT_1:14;
hence thesis by ORDINAL1:def 12;
end;
then consider k1 being (Element of ( NAT )) such that A16: k1 = ( ( len D ) - 1 );
deffunc G(Nat) = ( f . ( lower_bound ( divset (D,$1) ) ) );
consider F2 being (FinSequence of ( REAL )) such that A17: (( len F2 ) = ( len D ) & (for i being Nat holds (i in ( dom F2 ) implies ( F2 . i ) = G(i)))) from FINSEQ_2:sch 1;
deffunc G(Nat) = ( f . ( upper_bound ( divset (D,$1) ) ) );
A18: ( dom F2 ) = ( Seg ( len D ) ) by A17,FINSEQ_1:def 3;
consider F being (FinSequence of ( REAL )) such that A19: (( len F ) = k1 & (for i being Nat holds (i in ( dom F ) implies ( F . i ) = G(i)))) from FINSEQ_2:sch 1;
A20: ( dom F ) = ( Seg k1 ) by A19,FINSEQ_1:def 3;
A21: (for i being Nat holds ((1 <= i & i <= ( len F2 )) implies ( F2 . i ) = ( ( <* ( f . ( lower_bound A ) ) *> ^ F ) . i )))
proof
let i being Nat;
assume that
A22: 1 <= i
and
A23: i <= ( len F2 );
per cases ;
suppose A24: i = 1;

A25: i in ( Seg ( len D ) ) by A17,A22,A23,FINSEQ_1:1;
then A26: i in ( dom D ) by FINSEQ_1:def 3;
( F2 . i ) = ( f . ( lower_bound ( divset (D,i) ) ) ) by A17,A18,A25
.= ( f . ( lower_bound A ) ) by A24,A26,INTEGRA1:def 4;
hence thesis by A24,FINSEQ_1:41;
end;
suppose A27: i <> 1;

then A28: i > 1 by A22,XXREAL_0:1;
then ( 1 + 1 ) <= i by NAT_1:13;
then A29: ( ( len <* ( f . ( lower_bound A ) ) *> ) + 1 ) <= i by FINSEQ_1:39;
A30: i in ( Seg ( len D ) ) by A17,A22,A23,FINSEQ_1:1;
then A31: i in ( dom D ) by FINSEQ_1:def 3;
then reconsider k2 = ( i - 1 ) as (Element of ( NAT )) by A27,INTEGRA1:7;
( 1 + 1 ) <= ( k2 + 1 ) by A28,NAT_1:13;
then A32: 1 <= k2 by XREAL_1:19;
( k2 + 1 ) <= ( len F2 ) by A23;
then A33: k2 <= ( ( len D ) - 1 ) by A17,XREAL_1:19;
then A34: k2 in ( Seg k1 ) by A16,A32,FINSEQ_1:1;
A35: ( upper_bound ( divset (D,k2) ) ) = ( D . ( i - 1 ) )
proof
( len D ) <= ( ( len D ) + 1 ) by NAT_1:13;
then ( ( len D ) - 1 ) <= ( len D ) by XREAL_1:20;
then k2 <= ( len D ) by A33,XXREAL_0:2;
then k2 in ( Seg ( len D ) ) by A32,FINSEQ_1:1;
then A36: k2 in ( dom D ) by FINSEQ_1:def 3;
per cases ;
suppose k2 = 1;

hence thesis by A36,INTEGRA1:def 4;
end;
suppose k2 <> 1;

hence thesis by A36,INTEGRA1:def 4;
end;
end;
( len F2 ) = ( 1 + ( ( len D ) - 1 ) ) by A17
.= ( ( len <* ( f . ( lower_bound A ) ) *> ) + ( len F ) ) by A16,A19,FINSEQ_1:39;
then A37: ( ( <* ( f . ( lower_bound A ) ) *> ^ F ) . i ) = ( F . ( i - ( len <* ( f . ( lower_bound A ) ) *> ) ) ) by A23,A29,FINSEQ_1:23
.= ( F . ( i - 1 ) ) by FINSEQ_1:39;
( F2 . i ) = ( f . ( lower_bound ( divset (D,i) ) ) ) by A17,A18,A30
.= ( f . ( D . ( i - 1 ) ) ) by A27,A31,INTEGRA1:def 4;
hence thesis by A19,A20,A37,A34,A35;
end;
end;
( len ( <* ( f . ( lower_bound A ) ) *> ^ F ) ) = ( ( len <* ( f . ( lower_bound A ) ) *> ) + ( len F ) ) by FINSEQ_1:22
.= ( 1 + ( ( len D ) - 1 ) ) by A16,A19,FINSEQ_1:39
.= ( len D );
then A38: F2 = ( <* ( f . ( lower_bound A ) ) *> ^ F ) by A17,A21,FINSEQ_1:14;
(( len ( upper_volume (( f || A ),D) ) ) = ( len D ) & ( len ( lower_volume (( f || A ),D) ) ) = ( len D )) by INTEGRA1:def 6,INTEGRA1:def 7;
then A39: ( Sum ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) ) = ( ( Sum ( upper_volume (( f || A ),D) ) ) - ( Sum ( lower_volume (( f || A ),D) ) ) ) by CKB2:1
.= ( ( upper_sum (( f || A ),D) ) - ( Sum ( lower_volume (( f || A ),D) ) ) ) by INTEGRA1:def 8
.= ( ( upper_sum (( f || A ),D) ) - ( lower_sum (( f || A ),D) ) ) by INTEGRA1:def 9;
A40: ( dom F1 ) = ( Seg ( len D ) ) by A15,FINSEQ_1:def 3;
A41: (for i being Nat holds ((1 <= i & i <= ( len F1 )) implies ( F1 . i ) = ( ( F ^ <* ( f . ( upper_bound A ) ) *> ) . i )))
proof
let i being Nat;
assume that
A42: 1 <= i
and
A43: i <= ( len F1 );
now
per cases ;
suppose i <= ( len F );

then i in ( Seg ( len F ) ) by A42,FINSEQ_1:1;
then A44: (( F . i ) = ( f . ( upper_bound ( divset (D,i) ) ) ) & i in ( dom F )) by A19,A20;
i in ( Seg ( len F1 ) ) by A42,A43,FINSEQ_1:1;
then ( F1 . i ) = ( f . ( upper_bound ( divset (D,i) ) ) ) by A15,A40;
hence thesis by A44,FINSEQ_1:def 7;
end;
suppose i > ( len F );

then A45: i >= ( ( len F ) + 1 ) by NAT_1:13;
then A46: i = ( ( len F ) + 1 ) by A15,A16,A19,A43,XXREAL_0:1;
A47: i in ( Seg ( len F1 ) ) by A42,A43,FINSEQ_1:1;
then A48: i in ( dom D ) by A15,FINSEQ_1:def 3;
A49: ( upper_bound ( divset (D,i) ) ) = ( D . i )
proof
now
per cases ;
suppose i = 1;

hence thesis by A48,INTEGRA1:def 4;
end;
suppose i <> 1;

hence thesis by A48,INTEGRA1:def 4;
end;
end;
hence thesis;
end;
( F1 . i ) = ( f . ( upper_bound ( divset (D,i) ) ) ) by A15,A40,A47;
then ( F1 . i ) = ( f . ( D . ( len D ) ) ) by A15,A16,A19,A43,A45,A49,XXREAL_0:1
.= ( f . ( upper_bound A ) ) by INTEGRA1:def 2;
hence thesis by A46,FINSEQ_1:42;
end;
end;
hence thesis;
end;
(( len ( upper_volume (( f || A ),D) ) ) = ( len D ) & ( len ( lower_volume (( f || A ),D) ) ) = ( len D )) by INTEGRA1:def 6,INTEGRA1:def 7;
then A50: ( len ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) ) = ( len D ) by CKB2:1;
A51: ( len ( F1 - F2 ) ) = ( len D ) by A15,A17,CKB2:1;
A52: (for k holds (k in ( dom ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) ) implies ( ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) . k ) <= ( ( ( delta D ) * ( F1 - F2 ) ) . k )))
proof
let k;
assume A53: k in ( dom ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) );
then k in ( Seg ( len ( F1 - F2 ) ) ) by A50,A51,FINSEQ_1:def 3;
then A54: k in ( dom ( F1 - F2 ) ) by FINSEQ_1:def 3;
A55: k in ( Seg ( len D ) ) by A50,A53,FINSEQ_1:def 3;
then k in ( dom D ) by FINSEQ_1:def 3;
then ( ( ( upper_volume (( f || A ),D) ) . k ) - ( ( lower_volume (( f || A ),D) ) . k ) ) <= ( ( ( f . ( upper_bound ( divset (D,k) ) ) ) - ( f . ( lower_bound ( divset (D,k) ) ) ) ) * ( delta D ) ) by A3;
then A56: ( ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) . k ) <= ( ( ( f . ( upper_bound ( divset (D,k) ) ) ) - ( f . ( lower_bound ( divset (D,k) ) ) ) ) * ( delta D ) ) by A53,VALUED_1:13;
(( F1 . k ) = ( f . ( upper_bound ( divset (D,k) ) ) ) & ( F2 . k ) = ( f . ( lower_bound ( divset (D,k) ) ) )) by A15,A40,A17,A18,A55;
then ( ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) . k ) <= ( ( delta D ) * ( ( F1 - F2 ) . k ) ) by A56,A54,VALUED_1:13;
hence thesis by RVSUM_1:44;
end;
( ( delta D ) * ( F1 - F2 ) ) = ( ( ( delta D ) multreal ) * ( F1 - F2 ) ) by RVSUM_1:def 7;
then ( len ( ( delta D ) * ( F1 - F2 ) ) ) = ( len ( F1 - F2 ) ) by FINSEQ_2:33;
then ( len ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) ) = ( len ( ( delta D ) * ( F1 - F2 ) ) ) by A15,A17,A50,CKB2:1;
then A57: ( Sum ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) ) <= ( Sum ( ( delta D ) * ( F1 - F2 ) ) ) by A52,CKB3:1;
( len ( F ^ <* ( f . ( upper_bound A ) ) *> ) ) = ( ( len F ) + ( len <* ( f . ( upper_bound A ) ) *> ) ) by FINSEQ_1:22
.= ( ( ( len D ) - 1 ) + 1 ) by A16,A19,FINSEQ_1:39
.= ( len D );
then F1 = ( F ^ <* ( f . ( upper_bound A ) ) *> ) by A15,A41,FINSEQ_1:14;
then ( Sum ( F1 - F2 ) ) = ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) by A38,CKB1:1;
hence ( ( upper_sum (( f || A ),D) ) - ( lower_sum (( f || A ),D) ) ) <= ( ( delta D ) * ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) by A39,A57,RVSUM_1:87;
(for k being Nat holds (k in ( dom ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) ) implies ( 0 ) <= ( ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) . k )))
proof
let k being Nat;
set r = ( ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) . k );
A58: (( len ( upper_volume (( f || A ),D) ) ) = ( len D ) & ( len ( lower_volume (( f || A ),D) ) ) = ( len D )) by INTEGRA1:def 6,INTEGRA1:def 7;
assume A59: k in ( dom ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) );
then k in ( Seg ( len ( ( upper_volume (( f || A ),D) ) - ( lower_volume (( f || A ),D) ) ) ) ) by FINSEQ_1:def 3;
then k in ( Seg ( len D ) ) by A58,CKB2:1;
then A60: k in ( dom D ) by FINSEQ_1:def 3;
r = ( ( ( upper_volume (( f || A ),D) ) . k ) - ( ( lower_volume (( f || A ),D) ) . k ) ) by A59,VALUED_1:13;
hence thesis by A3,A60;
end;
hence thesis by A39,RVSUM_1:84;
end;
A61: (( f || A ) is  total & ( ( f || A ) | A ) is  bounded)
proof
consider x such that A62: x in A by SUBSET_1:4;
A63: ( dom ( f || A ) ) = ( ( dom f ) /\ A ) by RELAT_1:61
.= A by A2,XBOOLE_1:28;
hence ( f || A ) is  total by PARTFUN1:def 2;
(( lower_bound A ) <= x & x <= ( upper_bound A )) by A62,INTEGRA2:1;
then A64: ( lower_bound A ) <= ( upper_bound A ) by XXREAL_0:2;
(for x being set holds (x in ( A /\ ( dom ( f || A ) ) ) implies ( ( f || A ) . x ) >= ( ( f || A ) . ( lower_bound A ) )))
proof
( lower_bound A ) in A by A64,INTEGRA2:1;
then A65: (( lower_bound A ) in ( A /\ ( dom f ) ) & ( f . ( lower_bound A ) ) = ( ( f | A ) . ( lower_bound A ) )) by A2,A63,FUNCT_1:47,XBOOLE_1:28;
let x being set;
assume A66: x in ( A /\ ( dom ( f || A ) ) );
then x in A;
then A67: x in ( A /\ ( dom f ) ) by A2,XBOOLE_1:28;
reconsider x as (Element of A) by A66;
(x >= ( lower_bound A ) & ( f . x ) = ( ( f | A ) . x )) by A63,FUNCT_1:47,INTEGRA2:1;
hence thesis by A1,A67,A65,RFUNCT_2:24;
end;
then A68: ( ( f || A ) | A ) is  bounded_below by RFUNCT_1:71;
(for x being set holds (x in ( A /\ ( dom ( f || A ) ) ) implies ( ( f || A ) . x ) <= ( ( f || A ) . ( upper_bound A ) )))
proof
( upper_bound A ) in A by A64,INTEGRA2:1;
then A69: (( upper_bound A ) in ( A /\ ( dom f ) ) & ( f . ( upper_bound A ) ) = ( ( f | A ) . ( upper_bound A ) )) by A2,A63,FUNCT_1:47,XBOOLE_1:28;
let x being set;
assume A70: x in ( A /\ ( dom ( f || A ) ) );
then x in A;
then A71: x in ( A /\ ( dom f ) ) by A2,XBOOLE_1:28;
reconsider x as (Element of A) by A70;
(x <= ( upper_bound A ) & ( f . x ) = ( ( f | A ) . x )) by A63,FUNCT_1:47,INTEGRA2:1;
hence thesis by A1,A71,A69,RFUNCT_2:24;
end;
then ( ( f || A ) | A ) is  bounded_above by RFUNCT_1:70;
hence thesis by A68;
end;
(for T being (DivSequence of A) holds ((( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 )) implies ( ( lim ( upper_sum (( f || A ),T) ) ) - ( lim ( lower_sum (( f || A ),T) ) ) ) = ( 0 )))
proof
let T being (DivSequence of A);
assume A72: (( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 ));
A73: (for r being  real number holds (( 0 ) < r implies (ex n st (for m holds (n <= m implies ( abs ( ( ( ( upper_sum (( f || A ),T) ) - ( lower_sum (( f || A ),T) ) ) . m ) - ( 0 ) ) ) < r)))))
proof
consider x such that A74: x in A by SUBSET_1:4;
A75: A = ( A /\ ( dom f ) ) by A2,XBOOLE_1:28;
let r being  real number;
assume A76: ( 0 ) < r;
(( lower_bound A ) <= x & x <= ( upper_bound A )) by A74,INTEGRA2:1;
then A77: ( lower_bound A ) <= ( upper_bound A ) by XXREAL_0:2;
then (( lower_bound A ) in A & ( upper_bound A ) in A) by INTEGRA2:1;
then A78: ( f . ( lower_bound A ) ) <= ( f . ( upper_bound A ) ) by A1,A77,A75,RFUNCT_2:24;
now
per cases  by A78,XXREAL_0:1;
suppose A79: ( f . ( lower_bound A ) ) = ( f . ( upper_bound A ) );

(for m holds (( 0 ) <= m implies ( abs ( ( ( ( upper_sum (( f || A ),T) ) - ( lower_sum (( f || A ),T) ) ) . m ) - ( 0 ) ) ) < r))
proof
let m;
assume ( 0 ) <= m;
reconsider D1 = ( T . m ) as (Division of A);
A80: ( ( ( upper_sum (( f || A ),T) ) - ( lower_sum (( f || A ),T) ) ) . m ) = ( ( ( upper_sum (( f || A ),T) ) . m ) + ( ( - ( lower_sum (( f || A ),T) ) ) . m ) ) by SEQ_1:7
.= ( ( ( upper_sum (( f || A ),T) ) . m ) + ( - ( ( lower_sum (( f || A ),T) ) . m ) ) ) by SEQ_1:10
.= ( ( upper_sum (( f || A ),D1) ) + ( - ( ( lower_sum (( f || A ),T) ) . m ) ) ) by INTEGRA2:def 2
.= ( ( upper_sum (( f || A ),D1) ) + ( - ( lower_sum (( f || A ),D1) ) ) ) by INTEGRA2:def 3;
(( ( upper_sum (( f || A ),D1) ) - ( lower_sum (( f || A ),D1) ) ) <= ( ( delta D1 ) * ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) & ( ( upper_sum (( f || A ),D1) ) - ( lower_sum (( f || A ),D1) ) ) >= ( 0 )) by A14;
hence thesis by A76,A79,A80,ABSVALUE:def 1;
end;
hence thesis;
end;
suppose ( f . ( lower_bound A ) ) < ( f . ( upper_bound A ) );

then A81: ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) > ( 0 ) by XREAL_1:50;
then ( r / ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) > ( 0 ) by A76,XREAL_1:139;
then consider n such that A82: (for m holds (n <= m implies ( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) < ( r / ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ))) by A72,SEQ_2:def 7;
A83: (for m holds (n <= m implies ( ( delta T ) . m ) < ( r / ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) )))
proof
let m;
assume n <= m;
then A84: ( abs ( ( ( delta T ) . m ) - ( 0 ) ) ) < ( r / ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) by A82;
( ( delta T ) . m ) <= ( abs ( ( delta T ) . m ) ) by ABSVALUE:4;
hence thesis by A84,XXREAL_0:2;
end;
(for m holds (n <= m implies ( abs ( ( ( ( upper_sum (( f || A ),T) ) - ( lower_sum (( f || A ),T) ) ) . m ) - ( 0 ) ) ) < r))
proof
let m;
reconsider D = ( T . m ) as (Division of A);
A85: ( abs ( ( upper_sum (( f || A ),D) ) - ( lower_sum (( f || A ),D) ) ) ) = ( abs ( ( ( ( upper_sum (( f || A ),T) ) . m ) - ( lower_sum (( f || A ),D) ) ) - ( 0 ) ) ) by INTEGRA2:def 2
.= ( abs ( ( ( ( upper_sum (( f || A ),T) ) . m ) - ( ( lower_sum (( f || A ),T) ) . m ) ) - ( 0 ) ) ) by INTEGRA2:def 3
.= ( abs ( ( ( ( upper_sum (( f || A ),T) ) . m ) + ( - ( ( lower_sum (( f || A ),T) ) . m ) ) ) - ( 0 ) ) )
.= ( abs ( ( ( ( upper_sum (( f || A ),T) ) . m ) + ( ( - ( lower_sum (( f || A ),T) ) ) . m ) ) - ( 0 ) ) ) by SEQ_1:10
.= ( abs ( ( ( ( upper_sum (( f || A ),T) ) - ( lower_sum (( f || A ),T) ) ) . m ) - ( 0 ) ) ) by SEQ_1:7;
assume n <= m;
then ( ( delta T ) . m ) < ( r / ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) by A83;
then ( ( ( delta T ) . m ) * ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) < r by A81,XREAL_1:79;
then A86: ( ( delta D ) * ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) < r by INTEGRA3:def 2;
( ( upper_sum (( f || A ),D) ) - ( lower_sum (( f || A ),D) ) ) <= ( ( delta D ) * ( ( f . ( upper_bound A ) ) - ( f . ( lower_bound A ) ) ) ) by A14;
then A87: ( ( upper_sum (( f || A ),D) ) - ( lower_sum (( f || A ),D) ) ) < r by A86,XXREAL_0:2;
( ( upper_sum (( f || A ),D) ) - ( lower_sum (( f || A ),D) ) ) >= ( 0 ) by A14;
hence thesis by A87,A85,ABSVALUE:def 1;
end;
hence thesis;
end;
end;
hence thesis;
end;
A88: (( upper_sum (( f || A ),T) ) is  convergent & ( lower_sum (( f || A ),T) ) is  convergent) by A61,A72,INTEGRA4:8,INTEGRA4:9;
then ( ( upper_sum (( f || A ),T) ) - ( lower_sum (( f || A ),T) ) ) is  convergent by SEQ_2:11;
then ( lim ( ( upper_sum (( f || A ),T) ) - ( lower_sum (( f || A ),T) ) ) ) = ( 0 ) by A73,SEQ_2:def 7;
hence thesis by A88,SEQ_2:12;
end;
then ( f || A ) is  integrable by A61,INTEGRA4:12;
hence thesis by CKB8:def 1;
end;
