environ
vocabularies NUMBERS,SUBSET_1,XREAL_0,ORDINAL1,PRE_TOPC,EUCLID,ARYTM_1,ARYTM_3,SUPINF_2,XBOOLE_0,JORDAN2C,RELAT_1,CARD_1,VALUED_0,FINSEQ_1,COMPLEX1,SQUARE_1,CARD_3,RVSUM_1,XXREAL_0,METRIC_1,NAT_1,TARSKI,STRUCT_0,REAL_1,RCOMP_1,XXREAL_2,CONVEX1,RLTOPSP1,FUNCT_1,UNIALG_1,MSSUBFAM,FUNCOP_1,ORDINAL2,JGRAPH_2,MCART_1,PROB_1,FINSEQ_2,FUNCT_3,POLYEQ_1,JGRAPH_6;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FUNCT_2,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,FINSEQ_1,FINSEQ_2,RVSUM_1,VALUED_0,SQUARE_1,QUIN_1,POLYEQ_1,STRUCT_0,PRE_TOPC,METRIC_1,TBSP_1,RLVECT_1,RLTOPSP1,EUCLID,JORDAN2C,JGRAPH_2,JGRAPH_6,GRCAT_1,CKB7,CKB8,CKB9,CKB42,CKB47;
definitions TARSKI,XBOOLE_0,RLTOPSP1,JORDAN1,SQUARE_1,EUCLID,VALUED_1,XCMPLX_0,ALGSTR_0,STRUCT_0,GRCAT_1,CKB7,CKB8,CKB9,CKB42,CKB47;
theorems JGRAPH_6,TOPRNS_1,XREAL_0,TARSKI,SUBSET_1,FUNCT_2,EUCLID,JGRAPH_2,XBOOLE_1,XBOOLE_0,FUNCOP_1,JORDAN2C,JORDAN1,SQUARE_1,XCMPLX_1,ABSVALUE,JGRAPH_1,QUIN_1,POLYEQ_1,TOPREAL3,METRIC_1,TOPREAL6,RVSUM_1,EUCLID_2,TBSP_1,GOBOARD6,REVROT_1,ENUMSET1,COMPLEX1,XREAL_1,XXREAL_0,RLTOPSP1,RLVECT_1,ORDINAL1,GRCAT_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB25,CKB26,CKB29,CKB30,CKB31,CKB38,CKB39,CKB42,CKB46,CKB47,CKB48,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB57,CKB58,CKB59,CKB60,CKB61;
registrations XBOOLE_0,XXREAL_0,XREAL_0,SQUARE_1,NAT_1,MEMBERED,STRUCT_0,METRIC_1,MONOID_0,EUCLID,TOPALG_2,VALUED_0,FINSEQ_1,FUNCT_1,RELAT_1,PRE_TOPC,TBSP_1,CKB23,CKB24,CKB27,CKB28,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB40,CKB41,CKB43,CKB44,CKB45,CKB49,CKB56;
constructors REAL_1,SQUARE_1,BINOP_2,COMPLEX1,QUIN_1,FINSEQOP,POLYEQ_1,BORSUK_1,TBSP_1,MONOID_0,TOPREAL1,JORDAN1,JORDAN2C,JGRAPH_2,JGRAPH_6,VALUED_0,CONVEX1,GRCAT_1,CKB7,CKB8,CKB9,CKB42,CKB47;
requirements NUMERALS,BOOLE,SUBSET,ARITHM,REAL;
begin
reserve n for (Element of ( NAT ));
reserve a for  real number;
reserve r for  real number;
reserve x for (Point of ( TOP-REAL n ));
reserve y for (Point of ( TOP-REAL n ));
reserve z for (Point of ( TOP-REAL n ));
theorem
Th38: (for S,T,Y being (Element of ( REAL n )) holds ((((((S = ( ( ( 1 / 2 ) * y ) + ( ( 1 / 2 ) * z ) ) & T = z) & Y = x) & y <> z) & y in ( Sphere (x,r) )) & z in ( cl_Ball (x,r) )) implies (ex e being (Point of ( TOP-REAL n )) st (((e <> y & { y,e } = ( ( halfline (y,z) ) /\ ( Sphere (x,r) ) )) & (z in ( Sphere (x,r) ) implies e = z)) & (((not z in ( Sphere (x,r) )) & a = ( ( ( - ( 2 * |( ( z - ( ( ( 1 / 2 ) * y ) + ( ( 1 / 2 ) * z ) ) ),( ( ( ( 1 / 2 ) * y ) + ( ( 1 / 2 ) * z ) ) - x ) )| ) ) + ( sqrt ( delta (( Sum ( sqr ( T - S ) ) ),( 2 * |( ( z - ( ( ( 1 / 2 ) * y ) + ( ( 1 / 2 ) * z ) ) ),( ( ( ( 1 / 2 ) * y ) + ( ( 1 / 2 ) * z ) ) - x ) )| ),( ( Sum ( sqr ( S - Y ) ) ) - ( r ^2 ) )) ) ) ) / ( 2 * ( Sum ( sqr ( T - S ) ) ) ) )) implies e = ( ( ( 1 - a ) * ( ( ( 1 / 2 ) * y ) + ( ( 1 / 2 ) * z ) ) ) + ( a * z ) ))))))
proof
let S being (Element of ( REAL n ));
let T being (Element of ( REAL n ));
let Y being (Element of ( REAL n ));
assume that
A1: ((S = ( ( ( 1 / 2 ) * y ) + ( ( 1 / 2 ) * z ) ) & T = z) & Y = x);
reconsider G = x as (Point of ( Euclid n )) by TOPREAL3:8;
set s = y;
set t = z;
set X = ( ( ( 1 / 2 ) * s ) + ( ( 1 / 2 ) * t ) );
assume that
A2: s <> t
and
A3: s in ( Sphere (x,r) )
and
A4: t in ( cl_Ball (x,r) );
A5: ( Ball (G,r) ) = ( Ball (x,r) ) by CKB16:1;
A6: ( Sphere (x,r) ) c= ( cl_Ball (x,r) ) by CKB20:1;
per cases ;
suppose A7: t in ( Sphere (x,r) );

take t;
thus thesis by A2,A3,A7,CKB60:1;
end;
suppose A8: (not t in ( Sphere (x,r) ));

A9:now
assume X = t;
then ( ( t - ( ( 1 / 2 ) * s ) ) - ( ( 1 / 2 ) * t ) ) = ( t - t ) by EUCLID:46
.= ( 0. ( TOP-REAL n ) ) by EUCLID:42;
then ( 0. ( TOP-REAL n ) ) = ( ( t - ( ( 1 / 2 ) * t ) ) - ( ( 1 / 2 ) * s ) ) by JORDAN2C:7
.= ( ( ( 1 * t ) - ( ( 1 / 2 ) * t ) ) - ( ( 1 / 2 ) * s ) ) by EUCLID:29
.= ( ( ( 1 - ( 1 / 2 ) ) * t ) - ( ( 1 / 2 ) * s ) ) by EUCLID:50
.= ( ( 1 / 2 ) * ( t - s ) ) by EUCLID:49;
then ( t - s ) = ( 0. ( TOP-REAL n ) ) by EUCLID:31;
hence contradiction by A2,EUCLID:43;
end;
( ( Ball (x,r) ) \/ ( Sphere (x,r) ) ) = ( cl_Ball (x,r) ) by CKB21:1;
then A10: t in ( Ball (G,r) ) by A4,A5,A8,XBOOLE_0:def 3;
set a = ( ( ( - ( 2 * |( ( t - X ),( X - x ) )| ) ) + ( sqrt ( delta (( Sum ( sqr ( T - S ) ) ),( 2 * |( ( t - X ),( X - x ) )| ),( ( Sum ( sqr ( S - Y ) ) ) - ( r ^2 ) )) ) ) ) / ( 2 * ( Sum ( sqr ( T - S ) ) ) ) );
A11: (( ( 1 / 2 ) + ( 1 / 2 ) ) = 1 & ( abs ( 1 / 2 ) ) = ( 1 / 2 )) by ABSVALUE:def 1;
( Ball (G,r) ) = ( Ball (x,r) ) by CKB16:1;
then X in ( Ball (G,r) ) by A3,A6,A11,A10,CKB31:1;
then consider e1 being (Point of ( TOP-REAL n )) such that A12: { e1 } = ( ( halfline (X,t) ) /\ ( Sphere (x,r) ) ) and A13: e1 = ( ( ( 1 - a ) * X ) + ( a * t ) ) by A1,A5,A9,CKB61:1;
take e1;
A14: e1 in { e1 } by TARSKI:def 1;
then e1 in ( halfline (X,t) ) by A12,XBOOLE_0:def 4;
then consider l being  real number such that A15: e1 = ( ( ( 1 - l ) * X ) + ( l * t ) ) and A16: ( 0 ) <= l by CKB48:1;
hereby
assume e1 = s;
then ( 0. ( TOP-REAL n ) ) = ( ( ( ( 1 - l ) * X ) + ( l * t ) ) - s ) by A15,EUCLID:42
.= ( ( ( ( ( 1 - l ) * ( ( 1 / 2 ) * s ) ) + ( ( 1 - l ) * ( ( 1 / 2 ) * t ) ) ) + ( l * t ) ) - s ) by EUCLID:32
.= ( ( ( ( 1 - l ) * ( ( 1 / 2 ) * s ) ) + ( ( ( 1 - l ) * ( ( 1 / 2 ) * t ) ) + ( l * t ) ) ) - s ) by EUCLID:26
.= ( ( ( ( 1 - l ) * ( ( 1 / 2 ) * s ) ) - s ) + ( ( ( 1 - l ) * ( ( 1 / 2 ) * t ) ) + ( l * t ) ) ) by JORDAN2C:7
.= ( ( ( ( 1 - l ) * ( ( 1 / 2 ) * s ) ) - ( 1 * s ) ) + ( ( ( 1 - l ) * ( ( 1 / 2 ) * t ) ) + ( l * t ) ) ) by EUCLID:29
.= ( ( ( ( ( 1 - l ) * ( 1 / 2 ) ) * s ) - ( 1 * s ) ) + ( ( ( 1 - l ) * ( ( 1 / 2 ) * t ) ) + ( l * t ) ) ) by EUCLID:30
.= ( ( ( ( ( 1 - l ) * ( 1 / 2 ) ) - 1 ) * s ) + ( ( ( 1 - l ) * ( ( 1 / 2 ) * t ) ) + ( l * t ) ) ) by EUCLID:50
.= ( ( ( ( - ( 1 / 2 ) ) - ( l * ( 1 / 2 ) ) ) * s ) + ( ( ( ( 1 - l ) * ( 1 / 2 ) ) * t ) + ( l * t ) ) ) by EUCLID:30
.= ( ( ( ( - ( 1 / 2 ) ) - ( l * ( 1 / 2 ) ) ) * s ) + ( ( ( ( 1 - l ) * ( 1 / 2 ) ) + l ) * t ) ) by EUCLID:33
.= ( ( ( ( - 1 ) * ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) ) * s ) + ( ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) * t ) )
.= ( ( ( - ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) ) * s ) + ( ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) * t ) )
.= ( ( ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) * t ) + ( - ( ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) * s ) ) ) by EUCLID:40
.= ( ( ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) * t ) - ( ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) * s ) )
.= ( ( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) * ( t - s ) ) by EUCLID:49;
then (( ( 1 / 2 ) + ( l * ( 1 / 2 ) ) ) = ( 0 ) or ( t - s ) = ( 0. ( TOP-REAL n ) )) by EUCLID:31;
hence contradiction by A2,A16,EUCLID:43;
end;
A17: s in ( halfline (s,t) ) by CKB50:1;
hereby
set o = ( ( 1 + l ) / 2 );
let m being set;
assume m in { s,e1 };
then A18: (m = s or m = e1) by TARSKI:def 2;
e1 = ( ( ( ( 1 - l ) * ( ( 1 / 2 ) * s ) ) + ( ( 1 - l ) * ( ( 1 / 2 ) * t ) ) ) + ( l * t ) ) by A15,EUCLID:32
.= ( ( ( ( ( 1 - l ) * ( 1 / 2 ) ) * s ) + ( ( 1 - l ) * ( ( 1 / 2 ) * t ) ) ) + ( l * t ) ) by EUCLID:30
.= ( ( ( ( ( 1 - l ) * ( 1 / 2 ) ) * s ) + ( ( ( 1 - l ) * ( 1 / 2 ) ) * t ) ) + ( l * t ) ) by EUCLID:30
.= ( ( ( ( 1 - l ) * ( 1 / 2 ) ) * s ) + ( ( ( ( 1 - l ) * ( 1 / 2 ) ) * t ) + ( l * t ) ) ) by EUCLID:26
.= ( ( ( ( 1 - l ) * ( 1 / 2 ) ) * s ) + ( ( ( ( 1 - l ) * ( 1 / 2 ) ) + l ) * t ) ) by EUCLID:33
.= ( ( ( 1 - o ) * s ) + ( o * t ) );
then A19: e1 in ( halfline (s,t) ) by A16;
e1 in ( Sphere (x,r) ) by A12,A14,XBOOLE_0:def 4;
hence m in ( ( halfline (s,t) ) /\ ( Sphere (x,r) ) ) by A3,A17,A18,A19,XBOOLE_0:def 4;
end;
hereby
let m being set;
assume A20: m in ( ( halfline (s,t) ) /\ ( Sphere (x,r) ) );
then A21: m in ( halfline (s,t) ) by XBOOLE_0:def 4;
A22: m in ( Sphere (x,r) ) by A20,XBOOLE_0:def 4;
per cases ;
suppose m in ( halfline (X,t) );

then m in ( ( halfline (X,t) ) /\ ( Sphere (x,r) ) ) by A22,XBOOLE_0:def 4;
then m = e1 by A12,TARSKI:def 1;
hence m in { s,e1 } by TARSKI:def 2;
end;
suppose A23: (not m in ( halfline (X,t) ));

consider M being  real number such that A24: m = ( ( ( 1 - M ) * s ) + ( M * t ) ) and A25: ( 0 ) <= M by A21,CKB48:1;
A26:now
set o = ( ( 2 * M ) - 1 );
assume M > 1;
then ( 2 * M ) > ( 2 * 1 ) by XREAL_1:68;
then A27: ( ( 2 * M ) - 1 ) > ( ( 2 * 1 ) - 1 ) by XREAL_1:14;
( ( ( 1 - o ) * X ) + ( o * t ) ) = ( ( ( ( 1 - o ) * ( ( 1 / 2 ) * s ) ) + ( ( 1 - o ) * ( ( 1 / 2 ) * t ) ) ) + ( o * t ) ) by EUCLID:32
.= ( ( ( ( ( 1 - o ) * ( 1 / 2 ) ) * s ) + ( ( 1 - o ) * ( ( 1 / 2 ) * t ) ) ) + ( o * t ) ) by EUCLID:30
.= ( ( ( ( ( 1 - o ) * ( 1 / 2 ) ) * s ) + ( ( ( 1 - o ) * ( 1 / 2 ) ) * t ) ) + ( o * t ) ) by EUCLID:30
.= ( ( ( ( 1 - o ) * ( 1 / 2 ) ) * s ) + ( ( ( ( 1 - o ) * ( 1 / 2 ) ) * t ) + ( o * t ) ) ) by EUCLID:26
.= ( ( ( ( 1 - o ) * ( 1 / 2 ) ) * s ) + ( ( ( ( 1 - o ) * ( 1 / 2 ) ) + o ) * t ) ) by EUCLID:33
.= m by A24;
hence contradiction by A23,A27;
end;
(|. ( t - x ) .| <= r & |. ( t - x ) .| <> r) by A4,A8,CKB11:1;
then |. ( t - x ) .| < r by XXREAL_0:1;
then t in ( Ball (x,r) );
then A28: ( ( LSeg (s,t) ) /\ ( Sphere (x,r) ) ) = { s } by A3,CKB57:1;
M is Real by XREAL_0:def 1;
then m in ( LSeg (s,t) ) by A24,A25,A26;
then m in { s } by A22,A28,XBOOLE_0:def 4;
then m = s by TARSKI:def 1;
hence m in { s,e1 } by TARSKI:def 2;
end;
end;
thus thesis by A8,A13;
end;
end;
