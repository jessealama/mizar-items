environ
vocabularies XBOOLE_0,ORDERS_2,FUNCT_1,NUMBERS,STRUCT_0,SUBSET_1,XXREAL_0,FINSET_1,TARSKI,CARD_1,FINSEQ_1,PRE_TOPC,RCOMP_1,SETFAM_1,TOPS_1,CARD_3,ORDINAL1,RELAT_2,WAYBEL_0,YELLOW_0,ORDINAL2,LATTICE3,LATTICES,EQREL_1,WAYBEL_6,WAYBEL_3,FINSUB_1,CARD_FIL,MSAFREE,RELAT_1,ARYTM_3,YELLOW_8,ORDERS_1,ZFMISC_1,XXREAL_2,YELLOW_1,TOPS_3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,CARD_1,NUMBERS,NAT_1,SETFAM_1,FUNCT_1,RELSET_1,FINSEQ_1,FINSET_1,FINSUB_1,DOMAIN_1,XXREAL_0,FUNCT_2,STRUCT_0,CARD_3,PRE_TOPC,ORDERS_2,TOPS_1,TOPS_2,TOPS_3,LATTICE3,YELLOW_0,YELLOW_1,WAYBEL_0,YELLOW_4,WAYBEL_3,WAYBEL_4,WAYBEL_6,YELLOW_8,CKB2,CKB3,CKB37;
definitions TARSKI,WAYBEL_0,PRE_TOPC,TOPS_2,YELLOW_4,WAYBEL_6,YELLOW_8,CARD_3,LATTICE3,XBOOLE_0,SUBSET_1,STRUCT_0,CKB2,CKB3,CKB37;
theorems CARD_1,FUNCT_2,LATTICE3,ORDERS_2,TARSKI,WAYBEL_0,WAYBEL_1,WAYBEL_3,WAYBEL_4,WAYBEL_6,YELLOW_0,YELLOW_1,YELLOW_3,YELLOW_4,ZFMISC_1,PRE_TOPC,WAYBEL_7,FUNCT_1,TOPS_1,TOPS_2,TOPS_3,CARD_2,YELLOW_8,MSSUBFAM,NAT_1,FINSEQ_1,FINSUB_1,RELAT_1,YELLOW_2,SETFAM_1,XBOOLE_0,XBOOLE_1,SUBSET_1,CARD_3,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB34,CKB35,CKB36,CKB37,CKB39,CKB40,CKB41,CKB42,CKB43;
schemes FUNCT_2,TREES_2,SETWISEO,NAT_1,RECDEF_1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FINSET_1,FINSUB_1,XREAL_0,CARD_1,FINSEQ_1,STRUCT_0,LATTICE3,YELLOW_0,PRE_TOPC,WAYBEL_0,YELLOW_1,WAYBEL_1,YELLOW_4,WAYBEL_3,YELLOW_6,WAYBEL_6,WAYBEL_7,YELLOW_8,SETWISEO,CARD_3,TOPS_1,CKB31,CKB32,CKB33,CKB38;
constructors SETFAM_1,DOMAIN_1,SETWISEO,XXREAL_0,NAT_1,NAT_D,TOPS_1,TOPS_2,TOPS_3,WAYBEL_1,YELLOW_3,YELLOW_4,WAYBEL_3,WAYBEL_4,WAYBEL_6,YELLOW_8,RELSET_1,CKB3,CKB37;
requirements NUMERALS,BOOLE,SUBSET;
begin
theorem
Th37: (for L being  lower-bounded  continuous LATTICE holds (for V being  Open  upper (Subset of L) holds (for F being (Filter of L) holds (for v being (Element of L) holds (((( V "/\" F ) c= V & v in V) & (ex A being non empty (GeneratorSet of F) st A is  countable)) implies (ex O being  Open (Filter of L) st ((O c= V & v in O) & F c= O)))))))
proof
let L being  lower-bounded  continuous LATTICE;
let V being  Open  upper (Subset of L);
let F being (Filter of L);
let v being (Element of L);
assume that
A1: ( V "/\" F ) c= V
and
A2: v in V;
reconsider V1 = V as non empty  Open  upper (Subset of L) by A2;
reconsider v1 = v as (Element of V1) by A2;
reconsider G = { x where x is (Element of L): ( V "/\" { x } ) c= V } as (Filter of L) by CKB27:1,CKB28:1,CKB29:1;
given A being non empty (GeneratorSet of F) such that
A3: A is  countable;

consider f being (Function of ( NAT ),A) such that A4: ( rng f ) = A by A3,CARD_3:96;
reconsider f as (Function of ( NAT ),(the carrier of L)) by FUNCT_2:7;
deffunc F((Element of ( NAT ))) = ( "/\" ({ ( f . m ) where m is (Element of ( NAT )): m <= $1 },L) );
consider g being (Function of ( NAT ),(the carrier of L)) such that A5: (for n being (Element of ( NAT )) holds ( g . n ) = F(n)) from FUNCT_2:sch 4;
defpred P[ (Element of ( NAT )),set,set ]
 means
(ex x1,y1 being (Element of V1) st (ex z1 being (Element of L) st (((x1 = $2 & y1 = $3) & z1 = ( g . ( $1 + 1 ) )) & y1 << ( x1 "/\" z1 ))));
A6: ( dom g ) = ( NAT ) by FUNCT_2:def 1;
then reconsider AA = ( rng g ) as non empty (Subset of L) by RELAT_1:42;
A7: AA is (GeneratorSet of F) by A4,A5,CKB43:1;
A8: F c= G
proof
let q being set;
assume A9: q in F;
then reconsider s = q as (Element of L);
A10: ( V "/\" { s } ) = { ( s "/\" t ) where t is (Element of L): t in V } by YELLOW_4:42;
( V "/\" { s } ) c= V
proof
let w being set;
assume w in ( V "/\" { s } );
then consider t being (Element of L) such that A11: w = ( s "/\" t ) and A12: t in V by A10;
( t "/\" s ) in ( V "/\" F ) by A9,A12;
hence thesis by A1,A11;
end;
hence thesis;
end;
A13: (for n being (Element of ( NAT )) holds (for x being (Element of V1) holds (ex y being (Element of V1) st P[ n,x,y ])))
proof
let n being (Element of ( NAT ));
let x being (Element of V1);
AA c= F by A7,CKB39:1;
then A14: AA c= G by A8,XBOOLE_1:1;
( g . ( n + 1 ) ) in AA by A6,FUNCT_1:def 3;
then ( g . ( n + 1 ) ) in G by A14;
then consider g1 being (Element of L) such that A15: ( g . ( n + 1 ) ) = g1 and A16: ( V "/\" { g1 } ) c= V;
g1 in { g1 } by TARSKI:def 1;
then ( x "/\" g1 ) in ( V "/\" { g1 } );
then (ex y1 being (Element of L) st (y1 in V & y1 << ( x "/\" g1 ))) by A16,WAYBEL_6:def 1;
hence thesis by A15;
end;
consider h being (Function of ( NAT ),V1) such that A17: ( h . ( 0 ) ) = v1 and A18: (for n being (Element of ( NAT )) holds P[ n,( h . n ),( h . ( n + 1 ) ) ]) from RECDEF_1:sch 2(A13);
A19: ( dom h ) = ( NAT ) by FUNCT_2:def 1;
then A20: ( h . ( 0 ) ) in ( rng h ) by FUNCT_1:def 3;
then reconsider R = ( rng h ) as non empty (Subset of L) by XBOOLE_1:1;
set O = ( uparrow ( fininfs R ) );
A21: R c= O by WAYBEL_0:62;
A22: (for x,y being (Element of L) holds (for n being (Element of ( NAT )) holds ((( h . n ) = x & ( h . ( n + 1 ) ) = y) implies y <= x)))
proof
let x being (Element of L),y being (Element of L);
let n being (Element of ( NAT ));
assume that
A23: (( h . n ) = x & ( h . ( n + 1 ) ) = y);
consider x1 being (Element of V1),y1 being (Element of V1),z1 being (Element of L) such that A24: (x1 = ( h . n ) & y1 = ( h . ( n + 1 ) )) and z1 = ( g . ( n + 1 ) ) and A25: y1 << ( x1 "/\" z1 ) by A18;
A26: ( x1 "/\" z1 ) <= x1 by YELLOW_0:23;
y1 <= ( x1 "/\" z1 ) by A25,WAYBEL_3:1;
hence thesis by A23,A24,A26,ORDERS_2:3;
end;
A27: (for x,y being (Element of L) holds (for n,m being (Element of ( NAT )) holds (((( h . n ) = x & ( h . m ) = y) & n <= m) implies y <= x)))
proof
defpred P[ (Element of ( NAT )) ]
 means
(for a being (Element of ( NAT )) holds (for s,t being (Element of L) holds (((t = ( h . a ) & s = ( h . $1 )) & a <= $1) implies s <= t)));
A28: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume that
A29: (for j being (Element of ( NAT )) holds (for s,t being (Element of L) holds (((t = ( h . j ) & s = ( h . k )) & j <= k) implies s <= t)));
( h . k ) in R by A19,FUNCT_1:def 3;
then reconsider s = ( h . k ) as (Element of L);
let a being (Element of ( NAT ));
let c being (Element of L),d being (Element of L);
assume that
A30: d = ( h . a )
and
A31: c = ( h . ( k + 1 ) )
and
A32: a <= ( k + 1 );
A33: c <= s by A22,A31;
per cases  by A32,NAT_1:8;
suppose a <= k;

then s <= d by A29,A30;
hence thesis by A33,ORDERS_2:3;
end;
suppose a = ( k + 1 );

hence thesis by A30,A31;
end;
end;
A34: P[ ( 0 ) ] by NAT_1:3;
A35: (for k being (Element of ( NAT )) holds P[ k ]) from NAT_1:sch 1(A34,A28);
let x being (Element of L),y being (Element of L);
let n being (Element of ( NAT )),m being (Element of ( NAT ));
assume ((( h . n ) = x & ( h . m ) = y) & n <= m);
hence thesis by A35;
end;
A36: (for x,y being (Element of L) holds ((x in R & y in R) implies (x <= y or y <= x)))
proof
let x being (Element of L),y being (Element of L);
assume that
A37: x in R
and
A38: y in R;
consider m being set such that A39: m in ( dom h ) and A40: y = ( h . m ) by A38,FUNCT_1:def 3;
reconsider m as (Element of ( NAT )) by A39;
consider n being set such that A41: n in ( dom h ) and A42: x = ( h . n ) by A37,FUNCT_1:def 3;
reconsider n as (Element of ( NAT )) by A41;
per cases ;
suppose m <= n;

hence thesis by A27,A42,A40;
end;
suppose n <= m;

hence thesis by A27,A42,A40;
end;
end;
A43: O is  Open
proof
let x being (Element of L);
assume x in O;
then consider y being (Element of L) such that A44: y <= x and A45: y in ( fininfs R ) by WAYBEL_0:def 16;
consider Y being  finite (Subset of R) such that A46: y = ( "/\" (Y,L) ) and  ex_inf_of Y,L by A45;
per cases ;
suppose Y <> ( {} );

then y in Y by A36,A46,CKB34:1;
then consider n being set such that A47: n in ( dom h ) and A48: ( h . n ) = y by FUNCT_1:def 3;
reconsider n as (Element of ( NAT )) by A47;
consider x1 being (Element of V1),y1 being (Element of V1),z1 being (Element of L) such that A49: x1 = ( h . n ) and A50: y1 = ( h . ( n + 1 ) ) and z1 = ( g . ( n + 1 ) ) and A51: y1 << ( x1 "/\" z1 ) by A18;
take y1;
y1 in R by A19,A50,FUNCT_1:def 3;
hence y1 in O by A21;
( x1 "/\" z1 ) <= x1 by YELLOW_0:23;
then y1 << x1 by A51,WAYBEL_3:2;
hence thesis by A44,A48,A49,WAYBEL_3:2;
end;
suppose A52: Y = ( {} );

consider b being set such that A53: b in R by XBOOLE_0:def 1;
reconsider b as (Element of L) by A53;
consider n being set such that A54: n in ( dom h ) and ( h . n ) = b by A53,FUNCT_1:def 3;
reconsider n as (Element of ( NAT )) by A54;
A55: x <= ( Top L ) by YELLOW_0:45;
consider x1 being (Element of V1),y1 being (Element of V1),z1 being (Element of L) such that x1 = ( h . n ) and A56: y1 = ( h . ( n + 1 ) ) and z1 = ( g . ( n + 1 ) ) and A57: y1 << ( x1 "/\" z1 ) by A18;
y = ( Top L ) by A46,A52,YELLOW_0:def 12;
then x = ( Top L ) by A44,A55,ORDERS_2:2;
then A58: x1 <= x by YELLOW_0:45;
take y1;
y1 in R by A19,A56,FUNCT_1:def 3;
hence y1 in O by A21;
( x1 "/\" z1 ) <= x1 by YELLOW_0:23;
then y1 << x1 by A57,WAYBEL_3:2;
hence thesis by A58,WAYBEL_3:2;
end;
end;
A59: (for n being (Element of ( NAT )) holds (for a,b being (Element of L) holds ((a = ( g . n ) & b = ( g . ( n + 1 ) )) implies b <= a)))
proof
let n being (Element of ( NAT ));
let a being (Element of L),b being (Element of L);
assume that
A60: (a = ( g . n ) & b = ( g . ( n + 1 ) ));
reconsider gn = { ( f . m ) where m is (Element of ( NAT )): m <= n },gn1 = { ( f . k ) where k is (Element of ( NAT )): k <= ( n + 1 ) } as non empty  finite (Subset of L) by CKB1:1;
A61: ( ex_inf_of gn,L &  ex_inf_of gn1,L) by YELLOW_0:55;
A62: gn c= gn1
proof
let i being set;
assume i in gn;
then consider k being (Element of ( NAT )) such that A63: i = ( f . k ) and A64: k <= n;
k <= ( n + 1 ) by A64,NAT_1:12;
hence thesis by A63;
end;
(a = ( "/\" (gn,L) ) & b = ( "/\" (gn1,L) )) by A5,A60;
hence thesis by A61,A62,YELLOW_0:35;
end;
A65: AA is_coarser_than R
proof
let a being (Element of L);
assume a in AA;
then consider x being set such that A66: x in ( dom g ) and A67: ( g . x ) = a by FUNCT_1:def 3;
reconsider x as (Element of ( NAT )) by A66;
consider x1 being (Element of V1),y1 being (Element of V1),z1 being (Element of L) such that x1 = ( h . x ) and A68: y1 = ( h . ( x + 1 ) ) and A69: z1 = ( g . ( x + 1 ) ) and A70: y1 << ( x1 "/\" z1 ) by A18;
(( x1 "/\" z1 ) <= z1 & y1 <= ( x1 "/\" z1 )) by A70,WAYBEL_3:1,YELLOW_0:23;
then A71: y1 <= z1 by ORDERS_2:3;
A72: ( h . ( x + 1 ) ) in R by A19,FUNCT_1:def 3;
z1 <= a by A59,A67,A69;
hence (ex b being (Element of L) st (b in R & b <= a)) by A68,A72,A71,ORDERS_2:3;
end;
reconsider O as  Open (Filter of L) by A43;
R is_coarser_than O by A21,CKB19:1;
then A73: AA c= O by A65,YELLOW_4:7,YELLOW_4:8;
take O;
thus O c= V
proof
let q being set;
assume q in O;
then reconsider q as (Element of O);
consider y being (Element of L) such that A74: y <= q and A75: y in ( fininfs R ) by WAYBEL_0:def 16;
consider Y being  finite (Subset of R) such that A76: y = ( "/\" (Y,L) ) and  ex_inf_of Y,L by A75;
per cases ;
suppose Y <> ( {} );

then y in Y by A36,A76,CKB34:1;
then consider n being set such that A77: n in ( dom h ) and A78: ( h . n ) = y by FUNCT_1:def 3;
reconsider n as (Element of ( NAT )) by A77;
(ex x1,y1 being (Element of V1) st (ex z1 being (Element of L) st (((x1 = ( h . n ) & y1 = ( h . ( n + 1 ) )) & z1 = ( g . ( n + 1 ) )) & y1 << ( x1 "/\" z1 )))) by A18;
hence thesis by A74,A78,WAYBEL_0:def 20;
end;
suppose A79: Y = ( {} );

A80: q <= ( Top L ) by YELLOW_0:45;
y = ( Top L ) by A76,A79,YELLOW_0:def 12;
then q = ( Top L ) by A74,A80,ORDERS_2:2;
hence thesis by CKB11:1;
end;
end;

thus v in O by A17,A20,A21;
( uparrow ( fininfs AA ) ) = F by A7,CKB37:def 1;
hence thesis by A73,WAYBEL_0:62;
end;
