environ
vocabularies ARYTM_1,ARYTM_3,XBOOLE_0,CARD_1,CONVEX1,CONVEX2,CONVEX3,FINSEQ_1,FINSEQ_2,FINSEQ_4,FINSET_1,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,MEMBERED,ORDERS_1,RELAT_1,RLVECT_1,RLVECT_2,RUSUB_4,SEMI_AF1,SETFAM_1,TARSKI,TOPS_1,RLAFFIN1,RLAFFIN2,ZFMISC_1,REAL_1,CARD_3,XXREAL_0,NAT_1,SUBSET_1,NUMBERS,ORDINAL1,STRUCT_0,SUPINF_2,ORDINAL4,VALUED_1,XREAL_0,PARTFUN1;
notations TARSKI,XBOOLE_0,SUBSET_1,ZFMISC_1,ORDINAL1,NUMBERS,NAT_1,XCMPLX_0,XXREAL_0,ORDERS_1,CARD_1,XREAL_0,REAL_1,FINSET_1,SETFAM_1,DOMAIN_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,RELSET_1,FINSEQ_1,STRUCT_0,FINSEQ_2,SEQ_1,FINSEQOP,RVSUM_1,RLVECT_1,RLVECT_2,RUSUB_4,CONVEX1,CONVEX2,CONVEX3,RLAFFIN1,FUNCT_4,FUNCOP_1,MEMBERED,XXREAL_2,CKB6,CKB19;
definitions ORDERS_1,RLVECT_2,TARSKI,XBOOLE_0,CKB6,CKB19;
theorems BORSUK_4,CARD_1,CARD_2,CARD_FIN,CONVEX1,CONVEX3,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,NAT_1,MEMBERED,PARTFUN1,RELAT_1,RLAFFIN1,RLTOPSP1,RUSUB_4,RLVECT_2,RLVECT_3,RLVECT_4,RVSUM_1,STIRL2_1,SIMPLEX0,TARSKI,WELLORD2,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_0,XREAL_1,XXREAL_0,XXREAL_2,ZFMISC_1,RLVECT_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31;
schemes FRAENKEL,FUNCT_2,NAT_1,RLVECT_4;
registrations CARD_1,FINSET_1,FINSEQ_2,FUNCT_2,MEMBERED,NAT_1,NUMBERS,RELAT_1,RLVECT_1,RLVECT_3,STRUCT_0,SUBSET_1,VALUED_0,XCMPLX_0,XREAL_0,XXREAL_0,XBOOLE_0,RLAFFIN1,SIMPLEX0,FUNCOP_1,XXREAL_3,REALSET1,SETFAM_1,XXREAL_2,ABIAN,PARTFUN1,RVSUM_1,FINSEQ_1,RELSET_1,DILWORTH,RLVECT_2,CKB8;
constructors BINOP_2,CONVEX1,CONVEX3,DOMAIN_1,FINSEQOP,REAL_1,RLVECT_3,RVSUM_1,RUSUB_5,SEQ_1,SETFAM_1,RLAFFIN1,SIMPLEX0,XXREAL_2,FUNCT_4,RELSET_1,PARTFUN1,CKB6,CKB19;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve r for Real;
reserve V for RealLinearSpace;
reserve v for (VECTOR of V);
reserve u for (VECTOR of V);
reserve w for (VECTOR of V);
reserve p for (VECTOR of V);
reserve A for (Subset of V);
theorem
(((v in ( conv A ) & u in ( conv A )) & v <> u) implies (ex p st (ex w st (ex r st ((((p in A & w in ( conv ( A \ { p } ) )) & ( 0 ) <= r) & r < 1) & ( ( r * u ) + ( ( 1 - r ) * w ) ) = v)))))
proof
reconsider Z = ( 0 ) as Real by XREAL_0:def 1;
assume that
A1: v in ( conv A )
and
A2: u in ( conv A )
and
A3: v <> u;
reconsider A1 = A as non empty (Subset of V) by A1;
A4: ( conv A1 ) = { ( Sum L ) where L is (Convex_Combination of A1): L in ( ConvexComb V ) } by CONVEX3:5;
then consider Lv being (Convex_Combination of A1) such that A5: v = ( Sum Lv ) and A6: Lv in ( ConvexComb V ) by A1;
set Cv = ( Carrier Lv );
A7: Cv c= A by RLVECT_2:def 6;
consider Lu being (Convex_Combination of A1) such that A8: u = ( Sum Lu ) and Lu in ( ConvexComb V ) by A2,A4;
set Cu = ( Carrier Lu );
A9: Cu c= A by RLVECT_2:def 6;
then A10: ( Cv \/ Cu ) c= A by A7,XBOOLE_1:8;
per cases ;
suppose (not Cu c= Cv);

then consider p being set such that A11: p in Cu and A12: (not p in Cv) by TARSKI:def 3;
reconsider p as (Element of V) by A11;
(( Carrier Lv ) <> ( {} ) & ( Carrier Lv ) c= ( A \ { p } )) by A7,A12,CONVEX1:21,ZFMISC_1:34;
then reconsider Ap = ( A \ { p } ) as non empty (Subset of V);
( Carrier Lv ) c= Ap by A7,A12,ZFMISC_1:34;
then reconsider LV = Lv as (Linear_Combination of Ap) by RLVECT_2:def 6;
take p;
take w = v;
take Z;
A13: ( ( Z * u ) + ( ( 1 - Z ) * w ) ) = ( ( 0. V ) + ( 1 * w ) ) by RLVECT_1:10
.= ( ( 0. V ) + w ) by RLVECT_1:def 8
.= v by RLVECT_1:4;
( Sum LV ) in { ( Sum K ) where K is (Convex_Combination of Ap): K in ( ConvexComb V ) } by A6;
hence thesis by A5,A9,A11,A13,CONVEX3:5;
end;
suppose A14: Cu c= Cv;

defpred P[ set,set ]
 means
(for r holds (for p being (Element of V) holds ((r = $2 & p = $1) implies ((r < ( 0 ) & ( Lv . p ) <> ( Lu . p )) & ( ( ( r * Lu ) + ( ( 1 - r ) * Lv ) ) . p ) = ( 0 )))));
set P = { r where r is (Element of ( REAL )): (ex p being (Element of V) st (P[ p,r ] & p in ( Cv \/ Cu ))) };
A15:now
let x;
assume x in P;
then (ex r being (Element of ( REAL )) st (r = x & (ex p being (Element of V) st (P[ p,r ] & p in ( Cv \/ Cu )))));
hence x is  real;
end;
A16: (for p being (Element of V) holds (for r,s being (Element of ( REAL )) holds ((P[ p,r ] & P[ p,s ]) implies r = s)))
proof
let p being (Element of V);
let r being (Element of ( REAL )),s being (Element of ( REAL ));
assume A17: P[ p,r ];
then A18: ( ( ( r * Lu ) + ( ( 1 - r ) * Lv ) ) . p ) = ( 0 );
A19: ( Lv . p ) <> ( Lu . p ) by A17;
assume P[ p,s ];
then ( ( ( s * Lu ) + ( ( 1 - s ) * Lv ) ) . p ) = ( 0 );
then s = ( ( ( Lv . p ) - ( 0 ) ) / ( ( Lv . p ) - ( Lu . p ) ) ) by A19,CKB30:1
.= r by A18,A19,CKB30:1;
hence thesis;
end;
(( sum Lu ) = 1 & ( sum Lv ) = 1) by RLAFFIN1:62;
then consider p being (Element of V) such that A20: ( Lu . p ) > ( Lv . p ) by A3,A5,A8,CKB29:1;
A21: ( Lv . p ) <> ( 0 )
proof
assume A22: ( Lv . p ) = ( 0 );
then (not p in Cu) by A14,RLVECT_2:19;
hence contradiction by A20,A22;
end;
then p in Cv;
then A23: p in ( Cv \/ Cu ) by XBOOLE_0:def 3;
set r = ( ( Lv . p ) / ( ( Lv . p ) - ( Lu . p ) ) );
A24: (r = ( ( ( Lv . p ) - Z ) / ( ( Lv . p ) - ( Lu . p ) ) ) & ( ( Lv . p ) - ( Lu . p ) ) < ( ( Lu . p ) - ( Lu . p ) )) by A20,XREAL_1:9;
( Lv . p ) > ( 0 ) by A21,RLAFFIN1:62;
then P[ p,r ] by A24,CKB30:1;
then A25: r in P by A23;
A26: ( Cv \/ Cu ) is  finite;
P is  finite from FRAENKEL:sch 28(A26,A16);
then reconsider P as  finite non empty  real-membered set by A15,A25,MEMBERED:def 3;
set M = ( max P );
M in P by XXREAL_2:def 8;
then consider r being (Element of ( REAL )) such that A27: M = r and A28: (ex p being (Element of V) st (P[ p,r ] & p in ( Cv \/ Cu )));
set Lw = ( ( r * Lu ) + ( ( 1 - r ) * Lv ) );
consider p being (Element of V) such that A29: P[ p,r ] and A30: p in ( Cv \/ Cu ) by A28;
set w = ( ( r * u ) + ( ( 1 - r ) * v ) );
set R = ( ( - r ) / ( 1 - r ) );
A31: ( Sum Lw ) = ( ( Sum ( r * Lu ) ) + ( Sum ( ( 1 - r ) * Lv ) ) ) by RLVECT_3:1
.= ( ( r * u ) + ( Sum ( ( 1 - r ) * Lv ) ) ) by A8,RLVECT_3:2
.= w by A5,RLVECT_3:2;
A32: (for z being (Element of V) holds ( 0 ) <= ( Lw . z ))
proof
let z being (Element of V);
A33: ( ( ( Z * Lu ) + ( ( 1 - Z ) * Lv ) ) . z ) = ( ( ( Z * Lu ) . z ) + ( ( ( 1 - Z ) * Lv ) . z ) ) by RLVECT_2:def 10
.= ( ( Z * ( Lu . z ) ) + ( ( ( 1 - Z ) * Lv ) . z ) ) by RLVECT_2:def 11
.= ( ( Z * ( Lu . z ) ) + ( ( 1 - ( 0 ) ) * ( Lv . z ) ) ) by RLVECT_2:def 11
.= ( Lv . z );
assume A34: ( 0 ) > ( Lw . z );
A35: ( Lw . z ) = ( ( ( r * Lu ) . z ) + ( ( ( 1 - r ) * Lv ) . z ) ) by RLVECT_2:def 10
.= ( ( r * ( Lu . z ) ) + ( ( ( 1 - r ) * Lv ) . z ) ) by RLVECT_2:def 11
.= ( ( r * ( Lu . z ) ) + ( ( 1 - r ) * ( Lv . z ) ) ) by RLVECT_2:def 11;
A36: ( Lv . z ) <> ( 0 )
proof
assume A37: ( Lv . z ) = ( 0 );
then (not z in Cu) by A14,RLVECT_2:19;
then ( Lu . z ) = ( 0 );
hence contradiction by A34,A35,A37;
end;
then z in Cv;
then A38: z in ( Cv \/ Cu ) by XBOOLE_0:def 3;
( Lv . z ) >= ( 0 ) by RLAFFIN1:62;
then consider rs being Real such that A39: ( ( ( rs * Lu ) + ( ( 1 - rs ) * Lv ) ) . z ) = ( 0 ) and A40: (r <= ( 0 ) implies (r <= rs & rs <= ( 0 ))) and (( 0 ) <= r implies (( 0 ) <= rs & rs <= r)) by A33,A34,CKB31:1;
rs <> ( 0 ) by A33,A36,A39;
then P[ z,rs ] by A29,A34,A35,A39,A40,RLAFFIN1:62;
then rs in P by A38;
then rs <= r by A27,XXREAL_2:def 8;
then rs = r by A28,A40,XXREAL_0:1;
hence contradiction by A34,A39;
end;
(( r * Lu ) is (Linear_Combination of A) & ( ( 1 - r ) * Lv ) is (Linear_Combination of A)) by RLVECT_2:44;
then Lw is (Linear_Combination of A) by RLVECT_2:38;
then A41: ( Carrier Lw ) c= A by RLVECT_2:def 6;
( Lw . p ) = ( 0 ) by A29;
then (not p in ( Carrier Lw )) by RLVECT_2:19;
then A42: ( Carrier Lw ) c= ( A \ { p } ) by A41,ZFMISC_1:34;
A43: ( sum Lw ) = ( ( sum ( r * Lu ) ) + ( sum ( ( 1 - r ) * Lv ) ) ) by RLAFFIN1:34
.= ( ( r * ( sum Lu ) ) + ( sum ( ( 1 - r ) * Lv ) ) ) by RLAFFIN1:35
.= ( ( r * 1 ) + ( sum ( ( 1 - r ) * Lv ) ) ) by RLAFFIN1:62
.= ( ( r * 1 ) + ( ( 1 - r ) * ( sum Lv ) ) ) by RLAFFIN1:35
.= ( ( r * 1 ) + ( ( 1 - r ) * 1 ) ) by RLAFFIN1:62
.= 1;
then Lw is  convex by A32,RLAFFIN1:62;
then ( Carrier Lw ) <> ( {} ) by CONVEX1:21;
then reconsider Ap = ( A \ { p } ) as non empty (Subset of V) by A42;
reconsider LW = Lw as (Linear_Combination of Ap) by A42,RLVECT_2:def 6;
A44: LW is  convex by A32,A43,RLAFFIN1:62;
then LW in ( ConvexComb V ) by CONVEX3:def 1;
then A45: ( Sum LW ) in { ( Sum K ) where K is (Convex_Combination of Ap): K in ( ConvexComb V ) } by A44;
take p;
take w;
take R;
A46: ( 0 ) > r by A29;
then A47: (( 1 + ( - r ) ) > ( ( 0 ) + ( - r ) ) & ( ( 1 + ( - r ) ) / ( 1 + ( - r ) ) ) = 1) by XCMPLX_1:60,XREAL_1:6;
( ( R * u ) + ( ( 1 - R ) * w ) ) = ( ( ( ( - r ) / ( 1 - r ) ) * u ) + ( ( ( ( 1 - r ) / ( 1 - r ) ) - ( ( - r ) / ( 1 - r ) ) ) * w ) ) by A46,XCMPLX_1:60
.= ( ( ( ( - r ) / ( 1 - r ) ) * u ) + ( ( ( ( 1 - r ) - ( - r ) ) / ( 1 - r ) ) * w ) ) by XCMPLX_1:120
.= ( ( ( ( - r ) / ( 1 - r ) ) * u ) + ( ( ( 1 / ( 1 - r ) ) * ( r * u ) ) + ( ( 1 / ( 1 - r ) ) * ( ( 1 - r ) * v ) ) ) ) by RLVECT_1:def 5
.= ( ( ( ( - r ) / ( 1 - r ) ) * u ) + ( ( ( ( 1 / ( 1 - r ) ) * r ) * u ) + ( ( 1 / ( 1 - r ) ) * ( ( 1 - r ) * v ) ) ) ) by RLVECT_1:def 7
.= ( ( ( ( - r ) / ( 1 - r ) ) * u ) + ( ( ( ( 1 / ( 1 - r ) ) * r ) * u ) + ( ( ( 1 / ( 1 - r ) ) * ( 1 - r ) ) * v ) ) ) by RLVECT_1:def 7
.= ( ( ( ( - r ) / ( 1 - r ) ) * u ) + ( ( ( ( r / ( 1 - r ) ) * 1 ) * u ) + ( ( ( 1 / ( 1 - r ) ) * ( 1 - r ) ) * v ) ) ) by XCMPLX_1:75
.= ( ( ( ( - r ) / ( 1 - r ) ) * u ) + ( ( ( r / ( 1 - r ) ) * u ) + ( 1 * v ) ) ) by A46,XCMPLX_1:87
.= ( ( ( ( ( - r ) / ( 1 - r ) ) * u ) + ( ( r / ( 1 - r ) ) * u ) ) + ( 1 * v ) ) by RLVECT_1:def 3
.= ( ( ( ( ( - r ) / ( 1 - r ) ) + ( r / ( 1 - r ) ) ) * u ) + ( 1 * v ) ) by RLVECT_1:def 6
.= ( ( ( ( ( - r ) + r ) / ( 1 - r ) ) * u ) + ( 1 * v ) ) by XCMPLX_1:62
.= ( ( ( ( 0 ) / ( 1 - r ) ) * u ) + v ) by RLVECT_1:def 8
.= ( ( 0. V ) + v ) by RLVECT_1:10
.= v by RLVECT_1:def 4;
hence thesis by A10,A30,A31,A45,A46,A47,CONVEX3:5,XREAL_1:74;
end;
end;
