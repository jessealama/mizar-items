environ
vocabularies MSUALG_1,GLIB_000,SUBSET_1,XBOOLE_0,UNIALG_2,STRUCT_0,RELAT_1,TARSKI,FUNCT_1,FUNCOP_1,PBOOLE,CARD_3,FINSEQ_1,MARGREL1,NAT_1,PARTFUN1,PRELAMB,MSAFREE,MSUALG_3,TREES_4,REALSET1,MSUALG_2,FINSET_1,PRALG_1,CARD_1,TREES_2,DTCONSTR,TREES_3,ZFMISC_1,LANG1,TDGROUP,TREES_1,MSAFREE2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NAT_1,CARD_1,RELAT_1,FUNCT_1,PARTFUN1,FINSET_1,FINSEQ_1,FUNCT_2,CARD_3,TREES_1,TREES_2,TREES_3,TREES_4,PBOOLE,STRUCT_0,MSUALG_1,FINSEQ_2,MSAFREE,MSUALG_2,FUNCOP_1,DTCONSTR,LANG1,PRE_POLY,RELSET_1,MSUALG_3,CKB1,CKB2,CKB3,CKB4,CKB9,CKB13,CKB14,CKB17,CKB19,CKB20,CKB22,CKB23,CKB25,CKB27;
definitions TARSKI,MSUALG_1,FINSET_1,MSUALG_2,FUNCT_1,STRUCT_0,PBOOLE,FUNCOP_1,CKB2,CKB3,CKB4,CKB9,CKB13,CKB14,CKB17,CKB19,CKB20,CKB22,CKB23,CKB25,CKB27;
theorems TARSKI,ZFMISC_1,FINSEQ_1,FINSEQ_3,FUNCT_1,FUNCT_2,TREES_3,TREES_4,SUBSET_1,CARD_3,FUNCOP_1,PBOOLE,MSUALG_1,MSUALG_2,MSAFREE,CARD_2,CARD_1,DTCONSTR,LANG1,PRE_CIRC,RELAT_1,RELSET_1,XBOOLE_0,XBOOLE_1,FINSET_1,PARTFUN1,FINSEQ_2,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB13,CKB14,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB25,CKB27,CKB29,CKB30,CKB31,CKB32;
schemes DOMAIN_1,PBOOLE,MSAFREE1,FUNCT_1;
registrations XBOOLE_0,FUNCT_1,RELSET_1,FUNCOP_1,FINSET_1,TREES_1,CARD_3,TREES_2,TREES_3,PRE_CIRC,STRUCT_0,DTCONSTR,RELAT_1,MSUALG_1,MSUALG_2,MSAFREE,ORDINAL1,PBOOLE,FINSEQ_1,CKB10,CKB11,CKB12,CKB15,CKB16,CKB24,CKB26,CKB28;
constructors XXREAL_0,NAT_1,MSUALG_3,MSAFREE,SEQ_4,RELSET_1,PRE_POLY,FINSEQ_2,CKB2,CKB3,CKB4,CKB9,CKB13,CKB14,CKB17,CKB19,CKB20,CKB22,CKB23,CKB25,CKB27;
requirements BOOLE,SUBSET;
begin
theorem
Th14: (for S being non void non empty ManySortedSign holds (for X being  non-empty (ManySortedSet of (the carrier of S)) holds (for o being (OperSymbol of S) holds (for p being  DTree-yielding FinSequence holds (( [ o,(the carrier of S) ] -tree p ) in ( (the Sorts of ( FreeMSA X )) . ( the_result_sort_of o ) ) implies (for i being Nat holds (i in ( dom ( the_arity_of o ) ) implies ( p . i ) in ( (the Sorts of ( FreeMSA X )) . ( ( the_arity_of o ) . i ) ))))))))
proof
let S being non void non empty ManySortedSign;
let X being  non-empty (ManySortedSet of (the carrier of S));
let o being (OperSymbol of S);
let p being  DTree-yielding FinSequence;
A1: ( FreeMSA X ) = MSAlgebra (# ( FreeSort X ),( FreeOper X ) #) by MSAFREE:def 14;
assume A2: ( [ o,(the carrier of S) ] -tree p ) in ( (the Sorts of ( FreeMSA X )) . ( the_result_sort_of o ) );
now
(the carrier of S) in { (the carrier of S) } by TARSKI:def 1;
then [ o,(the carrier of S) ] in [: (the carrier' of S),{ (the carrier of S) } :] by ZFMISC_1:87;
then reconsider nt = [ o,(the carrier of S) ] as (NonTerminal of ( DTConMSA X )) by MSAFREE:6;
set rso = ( the_result_sort_of o );
reconsider ao = ( the_arity_of o ) as (Element of ( (the carrier of S) * ));
let i being Nat;
assume A3: i in ( dom ( the_arity_of o ) );
then ( ao . i ) in ( rng ao ) by FUNCT_1:def 3;
then reconsider s = ( ao . i ) as (SortSymbol of S);
A4: ( (the Sorts of ( FreeMSA X )) . s ) = ( FreeSort (X,s) ) by A1,MSAFREE:def 11
.= ( FreeSort (X,( ( the_arity_of o ) /. i )) ) by A3,PARTFUN1:def 6;
( [ o,(the carrier of S) ] -tree p ) in ( FreeSort (X,rso) ) by A2,A1,MSAFREE:def 11;
then ( [ o,(the carrier of S) ] -tree p ) in { a where a is (Element of ( TS ( DTConMSA X ) )): ((ex x being set st (x in ( X . rso ) & a = ( root-tree [ x,rso ] ))) or (ex o being (OperSymbol of S) st ([ o,(the carrier of S) ] = ( a . ( {} ) ) & ( the_result_sort_of o ) = rso))) } by MSAFREE:def 10;
then consider a being (Element of ( TS ( DTConMSA X ) )) such that A5: a = ( [ o,(the carrier of S) ] -tree p ) and ((ex x being set st (x in ( X . rso ) & a = ( root-tree [ x,rso ] ))) or (ex o being (OperSymbol of S) st ([ o,(the carrier of S) ] = ( a . ( {} ) ) & ( the_result_sort_of o ) = rso)));
( a . ( {} ) ) = [ o,(the carrier of S) ] by A5,TREES_4:def 4;
then consider ts being (FinSequence of ( TS ( DTConMSA X ) )) such that A6: a = ( nt -tree ts ) and A7: nt ==> ( roots ts ) by DTCONSTR:10;
nt = ( Sym (o,X) ) by MSAFREE:def 9;
then A8: ts in ( ( ( ( FreeSort X ) # ) * (the Arity of S) ) . o ) by A7,MSAFREE:10;
(( dom p ) = ( Seg ( len p ) ) & ( dom ( the_arity_of o ) ) = ( Seg ( len ( the_arity_of o ) ) )) by FINSEQ_1:def 3;
then A9: i in ( dom p ) by A2,A3,CKB32:1;
reconsider ts as  DTree-yielding FinSequence;
ts = p by A5,A6,TREES_4:15;
hence ( p . i ) in ( (the Sorts of ( FreeMSA X )) . ( ( the_arity_of o ) . i ) ) by A9,A8,A4,MSAFREE:9;
end;
hence thesis;
end;
