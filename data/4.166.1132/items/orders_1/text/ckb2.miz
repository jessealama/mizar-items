environ
vocabularies FUNCT_1,XBOOLE_0,TARSKI,SUBSET_1,MCART_1,ZFMISC_1,RELAT_1,PARTFUN1,RELAT_2,ORDINAL1,WELLORD1,WELLORD2,SETFAM_1,FINSET_1,ORDERS_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,RELAT_2,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,MCART_1,ORDINAL1,WELLORD1,SETFAM_1,WELLORD2,FINSET_1;
definitions RELAT_2,TARSKI,WELLORD1,RELAT_1,ORDINAL1,XBOOLE_0;
theorems FUNCT_1,FUNCT_2,MCART_1,RELAT_1,RELAT_2,RELSET_1,TARSKI,WELLORD1,WELLORD2,ZFMISC_1,XBOOLE_0,XBOOLE_1,PARTFUN1,ORDINAL1,SETFAM_1,CKB1;
schemes FUNCT_1,XBOOLE_0,ORDINAL1,TARSKI,RELSET_1,RELAT_1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,ORDINAL1,PARTFUN1,FUNCT_2,FINSET_1,RELSET_1,WELLORD2,FUNCT_1;
constructors SETFAM_1,RELAT_2,WELLORD1,PARTFUN1,WELLORD2,FUNCT_2,FINSET_1,RELSET_1;
requirements BOOLE,SUBSET;
begin
reserve X for set;
reserve Y for set;
reserve x for set;
reserve x1 for set;
reserve x2 for set;
reserve y for set;
reserve y1 for set;
reserve y2 for set;
reserve z for set;
reserve f for Function;
reserve g for Function;
reserve h for Function;
reserve M for non  empty set;
definition
let M;
assume A1: (not ( {} ) in M);
mode Choice_Function of M
 -> (Function of M,( union M ))
means :Def1: (for X holds (X in M implies ( it . X ) in X));
existence
proof
deffunc FF(set) = ( $1 `2 );
set x = the (Element of M);
deffunc F(set) = [: { $1 },$1 :];
consider f such that A2: ( dom f ) = M and A3: (for X holds (X in M implies ( f . X ) = F(X))) from FUNCT_1:sch 3;
A4: x in M;
then reconsider N = ( rng f ) as non  empty set by A2,FUNCT_1:3;
A5:now
let X;
let Y;
assume that
A6: X in N
and
A7: Y in N
and
A8: X <> Y;
consider y such that A9: y in ( dom f ) and A10: ( f . y ) = Y by A7,FUNCT_1:def 3;
A11: Y = [: { y },y :] by A2,A3,A9,A10;
set z = the (Element of ( X /\ Y ));
assume X meets Y;
then A12: ( X /\ Y ) <> ( {} ) by XBOOLE_0:def 7;
consider x such that A13: x in ( dom f ) and A14: ( f . x ) = X by A6,FUNCT_1:def 3;
X = [: { x },x :] by A2,A3,A13,A14;
then consider x1,x2 such that z = [ x1,x2 ] and A15: x1 in ( { x } /\ { y } ) and x2 in ( x /\ y ) by A11,A12,ZFMISC_1:85;
x1 in { x } by A15,XBOOLE_0:def 4;
then A16: x1 = x by TARSKI:def 1;
x1 in { y } by A15,XBOOLE_0:def 4;
hence contradiction by A8,A14,A10,A16,TARSKI:def 1;
end;
now
let X;
assume X in N;
then consider y such that A17: y in ( dom f ) and A18: ( f . y ) = X by FUNCT_1:def 3;
A19: y <> ( {} ) by A1,A2,A17;
X = [: { y },y :] by A2,A3,A17,A18;
hence X <> ( {} ) by A19;
end;
then consider Choice being set such that A20: (for X holds (X in N implies (ex x st ( Choice /\ X ) = { x }))) by A5,WELLORD2:18;
defpred P[ set,set ]
 means
$2 in ( $1 /\ Choice );
A21: (for X holds (X in N implies (ex y st P[ X,y ])))
proof
let X;
assume X in N;
then consider x such that A22: ( Choice /\ X ) = { x } by A20;
take x;
thus thesis by A22,TARSKI:def 1;
end;
A23: (for X holds (for y1 holds (for y2 holds (((X in N & P[ X,y1 ]) & P[ X,y2 ]) implies y1 = y2))))
proof
let X;
let y1;
let y2;
assume that
A24: X in N
and
A25: y1 in ( X /\ Choice )
and
A26: y2 in ( X /\ Choice );
consider x such that A27: { x } = ( Choice /\ X ) by A20,A24;
x = y1 by A25,A27,TARSKI:def 1;
hence thesis by A26,A27,TARSKI:def 1;
end;
consider g such that A28: ( dom g ) = N and A29: (for X holds (X in N implies P[ X,( g . X ) ])) from FUNCT_1:sch 2(A23,A21);
A30: ( rng g ) c= ( union N )
proof
let x;
assume x in ( rng g );
then consider y such that A31: y in ( dom g ) and A32: ( g . y ) = x by FUNCT_1:def 3;
x in ( y /\ Choice ) by A28,A29,A31,A32;
then x in y by XBOOLE_0:def 4;
hence thesis by A28,A31,TARSKI:def 4;
end;
( f . x ) in ( rng f ) by A2,FUNCT_1:def 3;
then consider x1 such that A33: x1 in N;
consider x2 such that A34: x2 in ( dom f ) and A35: ( f . x2 ) = x1 by A33,FUNCT_1:def 3;
A36: x2 <> ( {} ) by A1,A2,A34;
reconsider f as (Function of M,N) by A2,FUNCT_2:def 1,RELSET_1:4;
consider h such that A37: ( dom h ) = ( union N ) and A38: (for x holds (x in ( union N ) implies ( h . x ) = FF(x))) from FUNCT_1:sch 3;
A39: ( rng h ) c= ( union M )
proof
let x;
assume x in ( rng h );
then consider y such that A40: y in ( dom h ) and A41: ( h . y ) = x by FUNCT_1:def 3;
consider Y such that A42: y in Y and A43: Y in N by A37,A40,TARSKI:def 4;
consider z such that A44: z in ( dom f ) and A45: ( f . z ) = Y by A43,FUNCT_1:def 3;
A46: Y = [: { z },z :] by A3,A44,A45;
then consider x1,x2 such that A47: y = [ x1,x2 ] by A42,RELAT_1:def 1;
A48: x2 in z by A42,A46,A47,ZFMISC_1:87;
x = ( [ x1,x2 ] `2 ) by A37,A38,A40,A41,A47;
then x in z by A48,MCART_1:7;
hence thesis by A44,TARSKI:def 4;
end;
x1 = [: { x2 },x2 :] by A2,A3,A34,A35;
then A49: ( union N ) <> ( {} ) by A33,A36,CKB1:1;
then reconsider g as (Function of N,( union N )) by A28,A30,FUNCT_2:def 1,RELSET_1:4;
( union M ) <> ( {} ) by A1,A4,CKB1:1;
then reconsider h as (Function of ( union N ),( union M )) by A37,A39,FUNCT_2:def 1,RELSET_1:4;
A50: ( dom ( g * f ) ) = M by A49,FUNCT_2:def 1;
reconsider F = ( h * ( g * f ) ) as (Function of M,( union M )) by A49;
take F;
let X;
assume A51: X in M;
then A52: ( f . X ) = [: { X },X :] by A3;
set fX = ( f . X );
A53: ( f . X ) in N by A2,A51,FUNCT_1:def 3;
then ( g . fX ) in ( rng g ) by A28,FUNCT_1:def 3;
then A54: ( h . ( g . fX ) ) = ( ( g . fX ) `2 ) by A38;
A55: ( g . fX ) in ( fX /\ Choice ) by A29,A53;
then consider x1,x2 such that A56: [ x1,x2 ] = ( g . fX ) by A52,RELAT_1:def 1;
( g . fX ) in fX by A55,XBOOLE_0:def 4;
then x2 in X by A52,A56,ZFMISC_1:87;
then A57: ( h . ( g . fX ) ) in X by A56,A54,MCART_1:7;
( ( g * f ) . X ) = ( g . fX ) by A2,A51,FUNCT_1:13;
hence thesis by A50,A51,A57,FUNCT_1:13;
end;
end;
