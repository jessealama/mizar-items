environ
vocabularies XBOOLE_0,STRUCT_0,MSUALG_1,RELAT_1,PBOOLE,MSAFREE,MSUALG_3,REALSET1,MEMBER_1,FUNCT_6,TARSKI,FUNCT_1,WELLORD1,MSUALG_2,PRALG_2,CARD_3,SUBSET_1,MSUALG_5,MSUALG_4,FUNCOP_1,RLVECT_2,PRALG_1,EQREL_1,CLOSURE2,SETFAM_1,FUNCT_4,ZFMISC_1,GROUP_6,NUMBERS,EQUATION,ZF_MODEL,ZF_LANG,MCART_1,PZFMISC1,MSAFREE2,FINSET_1,BIRKHOFF;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,SETFAM_1,RELAT_1,MCART_1,STRUCT_0,FUNCT_1,PBOOLE,RELSET_1,PARTFUN1,FUNCT_2,FINSET_1,CARD_3,FUNCT_6,FUNCOP_1,MSUALG_1,MSUALG_2,PRALG_3,MSUALG_3,MSAFREE,MSAFREE2,PRALG_2,MSUALG_4,PZFMISC1,MSSUBFAM,CLOSURE2,MSUALG_5,EQUATION,CKB1;
definitions FUNCT_1,RELAT_1,TARSKI,PBOOLE,MSUALG_3,PRALG_2,MSUALG_4,EQUATION,FUNCOP_1,PZFMISC1,CKB1;
theorems AUTALG_1,CARD_3,CLOSURE2,EXTENS_1,FUNCOP_1,FUNCT_1,FUNCT_2,MCART_1,MSAFREE,MSAFREE2,MSSCYC_1,MSSUBFAM,MSUALG_2,MSUALG_3,MSUALG_4,MSUALG_5,MSUALG_7,MSUALG_9,PBOOLE,PRALG_2,PRALG_3,EQUATION,RELAT_1,ZFMISC_1,SETFAM_1,PARTFUN1,CKB1,CKB2;
schemes DOMAIN_1,PBOOLE,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FUNCT_2,FUNCOP_1,PBOOLE,STRUCT_0,MSUALG_1,MSUALG_2,MSUALG_4,MSAFREE1,MSAFREE2,EXTENS_1,MSUALG_5,CLOSURE2,PRALG_3,MSUALG_9,EQUATION,MSSUBFAM,AUTALG_1;
constructors SETFAM_1,BINOP_1,PZFMISC1,MSSUBFAM,MSUALG_3,MSAFREE2,MSUALG_5,CLOSURE2,PRALG_3,EQUATION,RELSET_1,CKB1;
requirements SUBSET,BOOLE;
begin
scheme FinGenAlgInVar { S() -> non empty non void ManySortedSign,A() ->  strict  finitely-generated  non-empty MSAlgebra over S(),F() ->  non-empty MSAlgebra over S(),fi() -> (ManySortedFunction of ( (the carrier of S()) --> ( NAT ) ),(the Sorts of F())),P,Q[set] } : P[ A() ]
provided
A1: Q[ A() ]
and
A2: P[ F() ]
and
A3: (for C being  non-empty MSAlgebra over S() holds (for G being (ManySortedFunction of ( (the carrier of S()) --> ( NAT ) ),(the Sorts of C)) holds (Q[ C ] implies (ex h being (ManySortedFunction of F(),C) st (h is_homomorphism F(),C & G = ( h ** fi() ))))))
and
A4: (for A,B being  non-empty MSAlgebra over S() holds ((A,B are_isomorphic  & P[ A ]) implies P[ B ]))
and
A5: (for A being  non-empty MSAlgebra over S() holds (for R being (MSCongruence of A) holds (P[ A ] implies P[ ( QuotMSAlg (A,R) ) ])))
proof
set I = (the carrier of S());
set sA = (the Sorts of A());
consider Gen being (GeneratorSet of A()) such that A6: Gen is  finite-yielding by MSAFREE2:def 10;
reconsider Gen as  finite-yielding (ManySortedSubset of sA) by A6;
consider GEN being  non-empty  finite-yielding (ManySortedSubset of sA) such that A7: Gen c= GEN by MSUALG_9:7;
consider F being (ManySortedFunction of ( I --> ( NAT ) ),GEN) such that A8: F is  "onto" by MSUALG_9:12;
( I --> ( NAT ) ) is_transformable_to GEN
proof
let i being set;
assume i in I;
hence thesis;
end;
then reconsider G = F as (ManySortedFunction of ( I --> ( NAT ) ),sA) by EXTENS_1:5;
consider h being (ManySortedFunction of F(),A()) such that A9: h is_homomorphism F(),A() and A10: G = ( h ** fi() ) by A1,A3;
reconsider sI1 = (the Sorts of ( Image h )) as (MSSubset of ( Image h )) by PBOOLE:def 18;
A11: GEN is (GeneratorSet of A()) by A7,MSSCYC_1:21;
reconsider sI = (the Sorts of ( Image h )) as (MSSubset of A()) by MSUALG_2:def 9;
GEN is (ManySortedSubset of sI)
proof
let i being set;
assume i in I;
then reconsider s = i as (SortSymbol of S());
let g being set;
assume A12: g in ( GEN . i );
A13: ( ( I --> ( NAT ) ) . s ) = ( NAT ) by FUNCOP_1:7;
then reconsider fi = ( fi() . s ) as (Function of ( NAT ),( (the Sorts of F()) . s ));
( dom ( ( h . s ) * fi ) ) = ( NAT ) by FUNCT_2:def 1
.= ( dom fi ) by FUNCT_2:def 1;
then A14: ( rng fi ) c= ( dom ( h . s ) ) by FUNCT_1:15;
( rng ( F . s ) ) = ( GEN . s ) by A8,MSUALG_3:def 3;
then consider x being set such that A15: x in ( dom ( F . s ) ) and A16: g = ( ( F . s ) . x ) by A12,FUNCT_1:def 3;
( dom ( F . s ) ) = ( NAT ) by A13,FUNCT_2:def 1
.= ( dom fi ) by FUNCT_2:def 1;
then A17: ( fi . x ) in ( rng fi ) by A15,FUNCT_1:def 3;
g = ( ( ( h . s ) * fi ) . x ) by A10,A16,MSUALG_3:2
.= ( ( h . s ) . ( fi . x ) ) by A15,FUNCT_2:15;
then g in ( ( h . s ) .: ( (the Sorts of F()) . s ) ) by A17,A14,FUNCT_1:def 6;
then g in ( ( h .:.: (the Sorts of F()) ) . s ) by PBOOLE:def 20;
hence thesis by A9,MSUALG_3:def 12;
end;
then A18: ( GenMSAlg GEN ) is (MSSubAlgebra of ( GenMSAlg sI )) by EXTENS_1:17;
( GenMSAlg sI ) = ( GenMSAlg sI1 ) by EXTENS_1:18;
then ( GenMSAlg GEN ) is (MSSubAlgebra of ( Image h )) by A18,MSUALG_2:21;
then A() is (MSSubAlgebra of ( Image h )) by A11,MSAFREE:3;
then A() = ( Image h ) by MSUALG_2:7;
then A19: h is_epimorphism F(),A() by A9,MSUALG_3:19;
P[ ( QuotMSAlg (F(),( MSCng h )) ) ] by A2,A5;
hence thesis by A4,A19,MSUALG_4:6;
end;
