environ
vocabularies NUMBERS,ORDINAL1,XBOOLE_0,ALGSTR_0,WELLORD1,QUOFIELD,RELAT_1,FUNCT_1,SUBSET_1,STRUCT_0,ORDINAL2,TARSKI,ORDINAL3,PRE_POLY,ARYTM_3,CARD_1,PBOOLE,FINSET_1,VALUED_0,FUNCOP_1,RLVECT_1,LATTICES,BINOP_1,POLYNOM1,FINSEQ_1,CARD_3,PARTFUN1,FINSEQ_2,NAT_1,VECTSP_1,ZFMISC_1,GROUP_1,SUPINF_2,XXREAL_0,FINSEQ_3,ORDINAL4,ARYTM_1,ORDERS_1,MSSUBFAM,POLYNOM6;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,VALUED_0,VECTSP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,POLYNOM1,STRUCT_0,ALGSTR_0,NAT_1,NAT_D,ORDERS_1,PBOOLE,RLVECT_1,FINSET_1,FINSEQ_1,FINSEQ_2,ORDINAL1,ORDINAL2,ORDINAL3,GROUP_1,QUOFIELD,GRCAT_1,WSIERP_1,PRE_POLY,FVSUM_1,POLYNOM3,GROUP_6,XXREAL_0,MATRLIN,CKB1,CKB2,CKB7,CKB15;
definitions VECTSP_1,QUOFIELD,GRCAT_1,FUNCT_1,TARSKI,XBOOLE_0,STRUCT_0,VALUED_0,CKB7,CKB15;
theorems POLYNOM1,TOPGRP_1,FUNCT_2,PBOOLE,FUNCT_1,ORDINAL3,ORDINAL1,ORDINAL2,FINSEQ_3,FINSEQ_2,FVSUM_1,FINSEQ_1,RELAT_1,FUNCOP_1,POLYALG1,FINSEQ_5,VECTSP_1,FINSEQ_4,FINSET_1,TARSKI,POLYNOM2,MATRLIN,RLVECT_1,NAT_1,SUBSET_1,CARD_3,POLYNOM3,ORDERS_1,RVSUM_1,XBOOLE_0,XBOOLE_1,XREAL_1,GROUP_6,XXREAL_0,GROUP_1,PARTFUN1,NAT_D,PRE_POLY,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20;
schemes PBOOLE,FUNCT_2,FRAENKEL,FUNCT_1,RECDEF_1;
registrations FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,XREAL_0,FINSEQ_1,FINSEQ_2,STRUCT_0,VECTSP_1,QUOFIELD,PRE_POLY,POLYNOM1,POLYNOM2,VALUED_0,CARD_1,CKB4,CKB5,CKB14;
constructors ORDINAL3,XXREAL_0,BINARITH,WSIERP_1,GRCAT_1,GROUP_6,TRIANG_1,QUOFIELD,POLYNOM1,POLYNOM3,NAT_D,RELSET_1,MATRLIN,FVSUM_1,VFUNCT_1,CKB2,CKB7,CKB15;
requirements BOOLE,SUBSET,NUMERALS,REAL;
begin
reserve o1 for Ordinal;
reserve o2 for Ordinal;
theorem
Th14: (for b1 being (Element of ( Bags o1 )) holds (for b2 being (Element of ( Bags o2 )) holds (for G being (FinSequence of ( ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ) * )) holds ((( dom G ) = ( dom ( decomp b1 ) ) & (for i being Nat holds (i in ( dom ( decomp b1 ) ) implies (ex a19,b19 being (Element of ( Bags o1 )) st (ex Fk being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) st (((Fk = ( G /. i ) & ( ( decomp b1 ) /. i ) = <* a19,b19 *>) & ( len Fk ) = ( len ( decomp b2 ) )) & (for m being Nat holds (m in ( dom Fk ) implies (ex a199,b199 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. m ) = <* a199,b199 *> & ( Fk /. m ) = <* ( a19 +^ a199 ),( b19 +^ b199 ) *>)))))))))) implies ( decomp ( b1 +^ b2 ) ) = ( FlattenSeq G )))))
proof
let b1 being (Element of ( Bags o1 ));
let b2 being (Element of ( Bags o2 ));
let G being (FinSequence of ( ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ) * ));
assume that
A1: ( dom G ) = ( dom ( decomp b1 ) )
and
A2: (for i being Nat holds (i in ( dom ( decomp b1 ) ) implies (ex a19,b19 being (Element of ( Bags o1 )) st (ex Fk being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) st (((Fk = ( G /. i ) & ( ( decomp b1 ) /. i ) = <* a19,b19 *>) & ( len Fk ) = ( len ( decomp b2 ) )) & (for m being Nat holds (m in ( dom Fk ) implies (ex a199,b199 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. m ) = <* a199,b199 *> & ( Fk /. m ) = <* ( a19 +^ a199 ),( b19 +^ b199 ) *>)))))))));
defpred P[ set,Function ]
 means
(( dom $2 ) = ( dom ( G . $1 ) ) & (for j being Nat holds (j in ( dom $2 ) implies (ex p being (Element of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) st (p = ( ( G . $1 ) . j ) & ( $2 . j ) = ( p . 1 ))))));
A3: (for k being (Element of ( NAT )) holds (k in ( Seg ( len G ) ) implies (ex p being (Element of ( ( Bags ( o1 +^ o2 ) ) * )) st P[ k,p ])))
proof
let k being (Element of ( NAT ));
assume that
A4: k in ( Seg ( len G ) );
defpred Q[ set,set ]
 means
(ex q being (Element of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) st (q = ( ( G . k ) . $1 ) & $2 = ( q . 1 )));
A5: (for j being (Element of ( NAT )) holds (j in ( Seg ( len ( G . k ) ) ) implies (ex x being (Element of ( Bags ( o1 +^ o2 ) )) st Q[ j,x ])))
proof
k in ( dom G ) by A4,FINSEQ_1:def 3;
then A6: ( G . k ) in ( rng G ) by FUNCT_1:3;
( rng G ) c= ( ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ) * ) by FINSEQ_1:def 4;
then ( G . k ) is (Element of ( ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ) * )) by A6;
then reconsider Gk = ( G . k ) as (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ));
let j being (Element of ( NAT ));
assume j in ( Seg ( len ( G . k ) ) );
then j in ( dom ( G . k ) ) by FINSEQ_1:def 3;
then ( ( G . k ) . j ) = ( Gk /. j ) by PARTFUN1:def 6;
then reconsider q = ( ( G . k ) . j ) as (Element of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ));
(ex q1,q2 being (Element of ( Bags ( o1 +^ o2 ) )) st q = <* q1,q2 *>) by FINSEQ_2:100;
then reconsider x = ( q . 1 ) as (Element of ( Bags ( o1 +^ o2 ) )) by FINSEQ_1:44;
take x;
thus thesis;
end;
consider p being (FinSequence of ( Bags ( o1 +^ o2 ) )) such that A7: ( dom p ) = ( Seg ( len ( G . k ) ) ) and A8: (for j being (Element of ( NAT )) holds (j in ( Seg ( len ( G . k ) ) ) implies Q[ j,( p /. j ) ])) from RECDEF_1:sch 17(A5);
reconsider p as (Element of ( ( Bags ( o1 +^ o2 ) ) * )) by FINSEQ_1:def 11;
take p;
thus ( dom p ) = ( dom ( G . k ) ) by A7,FINSEQ_1:def 3;
let j being Nat;
assume A9: j in ( dom p );
then consider q being (Element of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) such that A10: q = ( ( G . k ) . j ) and A11: ( p /. j ) = ( q . 1 ) by A7,A8;
take q;
thus q = ( ( G . k ) . j ) by A10;
thus thesis by A9,A11,PARTFUN1:def 6;
end;
consider F being (FinSequence of ( ( Bags ( o1 +^ o2 ) ) * )) such that A12: ( dom F ) = ( Seg ( len G ) ) and A13: (for i being (Element of ( NAT )) holds (i in ( Seg ( len G ) ) implies P[ i,( F /. i ) ])) from RECDEF_1:sch 17(A3);
A14: ( dom ( Card F ) ) = ( dom F ) by CARD_3:def 2
.= ( dom G ) by A12,FINSEQ_1:def 3
.= ( dom ( Card G ) ) by CARD_3:def 2;
A15: ( dom ( divisors b1 ) ) = ( dom ( decomp b1 ) ) by PRE_POLY:def 17;
A16: (for i being Nat holds (i in ( dom ( divisors b1 ) ) implies (ex a19 being (Element of ( Bags o1 )) st (ex Fk being (FinSequence of ( Bags ( o1 +^ o2 ) )) st (((Fk = ( F /. i ) & ( ( divisors b1 ) /. i ) = a19) & ( len Fk ) = ( len ( divisors b2 ) )) & (for m being Nat holds (m in ( dom Fk ) implies (ex a199 being (Element of ( Bags o2 )) st (( ( divisors b2 ) /. m ) = a199 & ( Fk /. m ) = ( a19 +^ a199 ))))))))))
proof
let i being Nat;
reconsider Fk = ( F /. i ) as (FinSequence of ( Bags ( o1 +^ o2 ) ));
A17: ( dom ( decomp b2 ) ) = ( dom ( divisors b2 ) ) by PRE_POLY:def 17;
assume A18: i in ( dom ( divisors b1 ) );
then consider a19 being (Element of ( Bags o1 )),b19 being (Element of ( Bags o1 )),Gi being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) such that A19: Gi = ( G /. i ) and A20: ( ( decomp b1 ) /. i ) = <* a19,b19 *> and A21: ( len Gi ) = ( len ( decomp b2 ) ) and A22: (for m being Nat holds (m in ( dom Gi ) implies (ex a199,b199 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. m ) = <* a199,b199 *> & ( Gi /. m ) = <* ( a19 +^ a199 ),( b19 +^ b199 ) *>)))) by A2,A15;
take a19;
take Fk;
thus Fk = ( F /. i );
thus ( ( divisors b1 ) /. i ) = a19 by A15,A18,A20,PRE_POLY:70;
A23: i in ( Seg ( len G ) ) by A1,A15,A18,FINSEQ_1:def 3;
then A24: ( dom ( F /. i ) ) = ( dom ( G . i ) ) by A13;
hence ( len Fk ) = ( len ( G . i ) ) by FINSEQ_3:29
.= ( len ( decomp b2 ) ) by A1,A15,A18,A19,A21,PARTFUN1:def 6
.= ( len ( divisors b2 ) ) by A17,FINSEQ_3:29;
let m being Nat;
assume A25: m in ( dom Fk );
then consider p being (Element of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) such that A26: p = ( ( G . i ) . m ) and A27: ( ( F /. i ) . m ) = ( p . 1 ) by A13,A23;
A28: ( G . i ) = ( G /. i ) by A1,A15,A18,PARTFUN1:def 6;
then consider a199 being (Element of ( Bags o2 )),b199 being (Element of ( Bags o2 )) such that A29: ( ( decomp b2 ) /. m ) = <* a199,b199 *> and A30: ( Gi /. m ) = <* ( a19 +^ a199 ),( b19 +^ b199 ) *> by A19,A22,A24,A25;
A31: p = <* ( a19 +^ a199 ),( b19 +^ b199 ) *> by A19,A24,A28,A25,A30,A26,PARTFUN1:def 6;
take a199;
m in ( dom ( decomp b2 ) ) by A19,A21,A24,A28,A25,FINSEQ_3:29;
hence ( ( divisors b2 ) /. m ) = a199 by A29,PRE_POLY:70;
thus ( Fk /. m ) = ( Fk . m ) by A25,PARTFUN1:def 6
.= ( a19 +^ a199 ) by A27,A31,FINSEQ_1:44;
end;
( dom ( decomp b2 ) ) = ( dom ( divisors b2 ) ) by PRE_POLY:def 17;
then A32: ( len ( decomp b2 ) ) = ( len ( divisors b2 ) ) by FINSEQ_3:29;
A33: (for j being Nat holds (j in ( dom ( Card F ) ) implies ( ( Card F ) . j ) = ( ( Card G ) . j )))
proof
let j being Nat;
assume A34: j in ( dom ( Card F ) );
then A35: j in ( dom G ) by A14,CARD_3:def 2;
A36: ( dom ( Card F ) ) = ( dom F ) by CARD_3:def 2;
then A37: ( ( Card F ) . j ) = ( card ( F . j ) ) by A34,CARD_3:def 2;
j in ( dom ( decomp b1 ) ) by A1,A12,A34,A36,FINSEQ_1:def 3;
then A38: ((ex a19 being (Element of ( Bags o1 )) st (ex Fk being (FinSequence of ( Bags ( o1 +^ o2 ) )) st (((Fk = ( F /. j ) & ( ( divisors b1 ) /. j ) = a19) & ( len Fk ) = ( len ( divisors b2 ) )) & (for m being Nat holds (m in ( dom Fk ) implies (ex a199 being (Element of ( Bags o2 )) st (( ( divisors b2 ) /. m ) = a199 & ( Fk /. m ) = ( a19 +^ a199 )))))))) & (ex a29,b29 being (Element of ( Bags o1 )) st (ex Gk being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) st (((Gk = ( G /. j ) & ( ( decomp b1 ) /. j ) = <* a29,b29 *>) & ( len Gk ) = ( len ( decomp b2 ) )) & (for m being Nat holds (m in ( dom Gk ) implies (ex a299,b299 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. m ) = <* a299,b299 *> & ( Gk /. m ) = <* ( a29 +^ a299 ),( b29 +^ b299 ) *>)))))))) by A2,A15,A16;
( card ( F . j ) ) = ( card ( F /. j ) ) by A34,A36,PARTFUN1:def 6
.= ( card ( G . j ) ) by A32,A35,A38,PARTFUN1:def 6;
hence thesis by A35,A37,CARD_3:def 2;
end;
reconsider bb = ( b1 +^ b2 ) as (bag of ( o1 +^ o2 ));
reconsider FG = ( FlattenSeq G ) as (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ));
( len ( Card F ) ) = ( len ( Card G ) ) by A14,FINSEQ_3:29;
then A39: ( Card F ) = ( Card G ) by A33,FINSEQ_2:9;
then A40: ( len FG ) = ( len ( FlattenSeq F ) ) by PRE_POLY:28;
( dom ( decomp b1 ) ) = ( dom ( divisors b1 ) ) by PRE_POLY:def 17;
then ( dom F ) = ( dom ( divisors b1 ) ) by A1,A12,FINSEQ_1:def 3;
then A41: ( divisors ( b1 +^ b2 ) ) = ( FlattenSeq F ) by A16,CKB19:1;
A42: ( dom ( decomp b1 ) ) = ( dom ( divisors b1 ) ) by PRE_POLY:def 17;
A43: (for i being (Element of ( NAT )) holds (for p being (bag of ( o1 +^ o2 )) holds ((i in ( dom FG ) & p = ( ( divisors bb ) /. i )) implies ( FG /. i ) = <* p,( bb -' p ) *>)))
proof
let k being (Element of ( NAT ));
let p being (bag of ( o1 +^ o2 ));
assume that
A44: k in ( dom FG )
and
A45: p = ( ( divisors bb ) /. k );
consider i being (Element of ( NAT )),j being (Element of ( NAT )) such that A46: i in ( dom G ) and A47: j in ( dom ( G . i ) ) and A48: k = ( ( Sum ( Card ( G | ( i -' 1 ) ) ) ) + j ) and A49: ( ( G . i ) . j ) = ( FG . k ) by A44,PRE_POLY:29;
consider fa1 being (Element of ( Bags o1 )),Fk being (FinSequence of ( Bags ( o1 +^ o2 ) )) such that A50: Fk = ( F /. i ) and A51: ( ( divisors b1 ) /. i ) = fa1 and ( len Fk ) = ( len ( divisors b2 ) ) and A52: (for m being Nat holds (m in ( dom Fk ) implies (ex fa19 being (Element of ( Bags o2 )) st (( ( divisors b2 ) /. m ) = fa19 & ( Fk /. m ) = ( fa1 +^ fa19 ))))) by A1,A16,A42,A46;
consider a19 being (Element of ( Bags o1 )),b19 being (Element of ( Bags o1 )),Gi being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) such that A53: Gi = ( G /. i ) and A54: ( ( decomp b1 ) /. i ) = <* a19,b19 *> and A55: ( len Gi ) = ( len ( decomp b2 ) ) and A56: (for m being Nat holds (m in ( dom Gi ) implies (ex a199,b199 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. m ) = <* a199,b199 *> & ( Gi /. m ) = <* ( a19 +^ a199 ),( b19 +^ b199 ) *>)))) by A1,A2,A46;
A57: a19 = fa1 by A1,A46,A54,A51,PRE_POLY:70;
then A58: <* a19,b19 *> = <* a19,( b1 -' a19 ) *> by A1,A46,A54,A51,PRE_POLY:def 17;
A59: j in ( dom Gi ) by A46,A47,A53,PARTFUN1:def 6;
then consider a199 being (Element of ( Bags o2 )),b199 being (Element of ( Bags o2 )) such that A60: ( ( decomp b2 ) /. j ) = <* a199,b199 *> and A61: ( Gi /. j ) = <* ( a19 +^ a199 ),( b19 +^ b199 ) *> by A56;
reconsider b2a1 = ( b2 -' a199 ) as (Element of ( Bags o2 )) by PRE_POLY:def 12;
reconsider b1a1 = ( b1 -' a19 ) as (Element of ( Bags o1 )) by PRE_POLY:def 12;
k in ( dom ( FlattenSeq F ) ) by A40,A44,FINSEQ_3:29;
then consider i9 being (Element of ( NAT )),j9 being (Element of ( NAT )) such that A62: i9 in ( dom F ) and A63: j9 in ( dom ( F . i9 ) ) and A64: k = ( ( Sum ( Card ( F | ( i9 -' 1 ) ) ) ) + j9 ) and A65: ( ( F . i9 ) . j9 ) = ( ( FlattenSeq F ) . k ) by PRE_POLY:29;
A66: (( Card ( G | ( i -' 1 ) ) ) = ( ( Card G ) | ( i -' 1 ) ) & ( Card ( F | ( i9 -' 1 ) ) ) = ( ( Card F ) | ( i9 -' 1 ) )) by POLYNOM3:16;
then A67: i = i9 by A39,A46,A47,A48,A62,A63,A64,POLYNOM3:22;
A68: j = j9 by A39,A46,A47,A48,A62,A63,A64,A66,POLYNOM3:22;
then A69: j in ( dom Fk ) by A62,A63,A67,A50,PARTFUN1:def 6;
then consider fa19 being (Element of ( Bags o2 )) such that A70: ( ( divisors b2 ) /. j ) = fa19 and A71: ( Fk /. j ) = ( fa1 +^ fa19 ) by A52;
A72: j in ( dom ( decomp b2 ) ) by A55,A59,FINSEQ_3:29;
then A73: a199 = fa19 by A60,A70,PRE_POLY:70;
then A74: <* a199,b199 *> = <* a199,( b2 -' a199 ) *> by A60,A70,A72,PRE_POLY:def 17;
k in ( dom ( FlattenSeq F ) ) by A40,A44,FINSEQ_3:29;
then A75: p = ( ( F . i ) . j ) by A41,A45,A65,A67,A68,PARTFUN1:def 6
.= ( Fk . j ) by A62,A67,A50,PARTFUN1:def 6
.= ( a19 +^ a199 ) by A69,A71,A57,A73,PARTFUN1:def 6;
then A76: ( bb -' p ) = ( b1a1 +^ b2a1 ) by CKB20:1
.= ( b19 +^ b2a1 ) by A58,FINSEQ_1:77
.= ( b19 +^ b199 ) by A74,FINSEQ_1:77;
thus ( FG /. k ) = ( ( G . i ) . j ) by A44,A49,PARTFUN1:def 6
.= ( Gi . j ) by A46,A53,PARTFUN1:def 6
.= <* p,( bb -' p ) *> by A59,A61,A75,A76,PARTFUN1:def 6;
end;
( dom FG ) = ( dom ( divisors bb ) ) by A41,A40,FINSEQ_3:29;
hence thesis by A43,PRE_POLY:def 17;
end;
