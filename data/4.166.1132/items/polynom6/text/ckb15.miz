environ
vocabularies NUMBERS,ORDINAL1,XBOOLE_0,ALGSTR_0,WELLORD1,QUOFIELD,RELAT_1,FUNCT_1,SUBSET_1,STRUCT_0,ORDINAL2,TARSKI,ORDINAL3,PRE_POLY,ARYTM_3,CARD_1,PBOOLE,FINSET_1,VALUED_0,FUNCOP_1,RLVECT_1,LATTICES,BINOP_1,POLYNOM1,FINSEQ_1,CARD_3,PARTFUN1,FINSEQ_2,NAT_1,VECTSP_1,ZFMISC_1,GROUP_1,SUPINF_2,XXREAL_0,FINSEQ_3,ORDINAL4,ARYTM_1,ORDERS_1,MSSUBFAM,POLYNOM6;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,VALUED_0,VECTSP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,POLYNOM1,STRUCT_0,ALGSTR_0,NAT_1,NAT_D,ORDERS_1,PBOOLE,RLVECT_1,FINSET_1,FINSEQ_1,FINSEQ_2,ORDINAL1,ORDINAL2,ORDINAL3,GROUP_1,QUOFIELD,GRCAT_1,WSIERP_1,PRE_POLY,FVSUM_1,POLYNOM3,GROUP_6,XXREAL_0,MATRLIN,CKB1,CKB2,CKB7;
definitions VECTSP_1,QUOFIELD,GRCAT_1,FUNCT_1,TARSKI,XBOOLE_0,STRUCT_0,VALUED_0,CKB7;
theorems POLYNOM1,TOPGRP_1,FUNCT_2,PBOOLE,FUNCT_1,ORDINAL3,ORDINAL1,ORDINAL2,FINSEQ_3,FINSEQ_2,FVSUM_1,FINSEQ_1,RELAT_1,FUNCOP_1,POLYALG1,FINSEQ_5,VECTSP_1,FINSEQ_4,FINSET_1,TARSKI,POLYNOM2,MATRLIN,RLVECT_1,NAT_1,SUBSET_1,CARD_3,POLYNOM3,ORDERS_1,RVSUM_1,XBOOLE_0,XBOOLE_1,XREAL_1,GROUP_6,XXREAL_0,GROUP_1,PARTFUN1,NAT_D,PRE_POLY,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13;
schemes PBOOLE,FUNCT_2,FRAENKEL,FUNCT_1,RECDEF_1;
registrations FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,XREAL_0,FINSEQ_1,FINSEQ_2,STRUCT_0,VECTSP_1,QUOFIELD,PRE_POLY,POLYNOM1,POLYNOM2,VALUED_0,CARD_1,CKB4,CKB5,CKB14;
constructors ORDINAL3,XXREAL_0,BINARITH,WSIERP_1,GRCAT_1,GROUP_6,TRIANG_1,QUOFIELD,POLYNOM1,POLYNOM3,NAT_D,RELSET_1,MATRLIN,FVSUM_1,VFUNCT_1,CKB2,CKB7;
requirements BOOLE,SUBSET,NUMERALS,REAL;
begin
definition
let o1 being non empty Ordinal;
let o2 being non empty Ordinal;
let L being  right_zeroed  add-associative  right_complementable  well-unital  distributive non trivial doubleLoopStr;
let P being (Polynomial of o1,( Polynom-Ring (o2,L) ));
func Compress P -> (Polynomial of ( o1 +^ o2 ),L)
means
:Def2: (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds (ex b1 being (Element of ( Bags o1 )) st (ex b2 being (Element of ( Bags o2 )) st (ex Q1 being (Polynomial of o2,L) st ((Q1 = ( P . b1 ) & b = ( b1 +^ b2 )) & ( it . b ) = ( Q1 . b2 ))))));
existence
proof
deffunc F((Element of ( Bags o1 ))) = { ( $1 +^ b2 ) where b2 is (Element of ( Bags o2 )): (ex Q being (Polynomial of o2,L) st (Q = ( P . $1 ) & b2 in ( Support Q ))) };
defpred P[ (Element of ( Bags ( o1 +^ o2 ) )),(Element of L) ]
 means
(ex b1 being (Element of ( Bags o1 )) st (ex b2 being (Element of ( Bags o2 )) st (ex Q1 being (Polynomial of o2,L) st ((Q1 = ( P . b1 ) & $1 = ( b1 +^ b2 )) & $2 = ( Q1 . b2 )))));
set A = { F(b1) where b1 is (Element of ( Bags o1 )): b1 in ( Support P ) };
A1: (for B being set holds (B in A implies B is  finite))
proof
let B being set;
assume B in A;
then consider b1 being (Element of ( Bags o1 )) such that A2: B = { ( b1 +^ b2 ) where b2 is (Element of ( Bags o2 )): (ex Q being (Polynomial of o2,L) st (Q = ( P . b1 ) & b2 in ( Support Q ))) } and b1 in ( Support P );
deffunc F((Element of ( Bags o2 ))) = ( b1 +^ $1 );
reconsider Q0 = ( P . b1 ) as (Polynomial of o2,L) by POLYNOM1:def 10;
set B0 = { F(b2) where b2 is (Element of ( Bags o2 )): b2 in ( Support Q0 ) };
A3: B c= B0
proof
let x being set;
assume x in B;
then (ex b2 being (Element of ( Bags o2 )) st (x = ( b1 +^ b2 ) & (ex Q being (Polynomial of o2,L) st (Q = ( P . b1 ) & b2 in ( Support Q ))))) by A2;
hence thesis;
end;
A4: ( Support Q0 ) is  finite;
B0 is  finite from FRAENKEL:sch 21(A4);
hence thesis by A3;
end;
A5: (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds (ex u being (Element of L) st P[ b,u ]))
proof
let b being (Element of ( Bags ( o1 +^ o2 ) ));
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )) such that A6: b = ( b1 +^ b2 ) by CKB11:1;
reconsider Q1 = ( P . b1 ) as (Polynomial of o2,L) by POLYNOM1:def 10;
take ( Q1 . b2 );
take b1;
take b2;
take Q1;
thus thesis by A6;
end;
consider f being (Function of ( Bags ( o1 +^ o2 ) ),(the carrier of L)) such that A7: (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds P[ b,( f . b ) ]) from FUNCT_2:sch 3(A5);
reconsider f as (Series of ( o1 +^ o2 ),L);
A8: ( Support f ) = ( union A )
proof
thus ( Support f ) c= ( union A )
proof
let x being set;
assume A9: x in ( Support f );
then A10: ( f . x ) <> ( 0. L ) by POLYNOM1:def 3;
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )) such that A11: x = ( b1 +^ b2 ) by A9,CKB11:1;
consider Y being set such that A12: Y = { ( b1 +^ b29 ) where b29 is (Element of ( Bags o2 )): (ex Q being (Polynomial of o2,L) st (Q = ( P . b1 ) & b29 in ( Support Q ))) };
consider b19 being (Element of ( Bags o1 )),b29 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A13: Q1 = ( P . b19 ) and A14: ( b1 +^ b2 ) = ( b19 +^ b29 ) and A15: ( f . ( b1 +^ b2 ) ) = ( Q1 . b29 ) by A7;
A16: b1 = b19 by A14,CKB12:1;
now
assume ( P . b1 ) = ( 0. ( Polynom-Ring (o2,L) ) );
then Q1 = ( 0_ (o2,L) ) by A13,A16,POLYNOM1:def 10;
hence contradiction by A10,A11,A15,POLYNOM1:22;
end;
then b1 in ( Support P ) by POLYNOM1:def 3;
then A17: Y in A by A12;
b2 = b29 by A14,CKB12:1;
then b2 in ( Support Q1 ) by A10,A11,A15,POLYNOM1:def 3;
then x in Y by A11,A12,A13,A16;
hence thesis by A17,TARSKI:def 4;
end;

let x being set;
assume x in ( union A );
then consider Y being set such that A18: x in Y and A19: Y in A by TARSKI:def 4;
consider b1 being (Element of ( Bags o1 )) such that A20: Y = { ( b1 +^ b2 ) where b2 is (Element of ( Bags o2 )): (ex Q being (Polynomial of o2,L) st (Q = ( P . b1 ) & b2 in ( Support Q ))) } and b1 in ( Support P ) by A19;
consider b2 being (Element of ( Bags o2 )) such that A21: x = ( b1 +^ b2 ) and A22: (ex Q being (Polynomial of o2,L) st (Q = ( P . b1 ) & b2 in ( Support Q ))) by A18,A20;
consider Q being (Polynomial of o2,L) such that A23: Q = ( P . b1 ) and A24: b2 in ( Support Q ) by A22;
A25: ( Q . b2 ) <> ( 0. L ) by A24,POLYNOM1:def 3;
consider b19 being (Element of ( Bags o1 )),b29 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A26: Q1 = ( P . b19 ) and A27: ( b1 +^ b2 ) = ( b19 +^ b29 ) and A28: ( f . ( b1 +^ b2 ) ) = ( Q1 . b29 ) by A7;
A29: ( f . ( b1 +^ b2 ) ) = ( Q1 . b2 ) by A27,A28,CKB12:1;
Q1 = Q by A23,A26,A27,CKB12:1;
hence thesis by A21,A25,A29,POLYNOM1:def 3;
end;
A30: ( Support P ) is  finite by POLYNOM1:def 4;
A is  finite from FRAENKEL:sch 21(A30);
then ( union A ) is  finite by A1,FINSET_1:7;
then reconsider f as (Polynomial of ( o1 +^ o2 ),L) by A8,POLYNOM1:def 4;
take f;
let b being (Element of ( Bags ( o1 +^ o2 ) ));
consider b19 being (Element of ( Bags o1 )),b29 being (Element of ( Bags o2 )),Q19 being (Polynomial of o2,L) such that A31: Q19 = ( P . b19 ) and A32: b = ( b19 +^ b29 ) and A33: ( f . b ) = ( Q19 . b29 ) by A7;
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )) such that A34: b = ( b1 +^ b2 ) by CKB11:1;
reconsider Q1 = ( P . b1 ) as (Polynomial of o2,L) by POLYNOM1:def 10;
take b1;
take b2;
take Q1;
thus Q1 = ( P . b1 );
thus b = ( b1 +^ b2 ) by A34;
b1 = b19 by A34,A32,CKB12:1;
hence thesis by A34,A31,A32,A33,CKB12:1;
end;
uniqueness
proof
let w1 being (Polynomial of ( o1 +^ o2 ),L),w2 being (Polynomial of ( o1 +^ o2 ),L);
assume that
A35: (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds (ex b1 being (Element of ( Bags o1 )) st (ex b2 being (Element of ( Bags o2 )) st (ex Q1 being (Polynomial of o2,L) st ((Q1 = ( P . b1 ) & b = ( b1 +^ b2 )) & ( w1 . b ) = ( Q1 . b2 ))))))
and
A36: (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds (ex b1 being (Element of ( Bags o1 )) st (ex b2 being (Element of ( Bags o2 )) st (ex Q1 being (Polynomial of o2,L) st ((Q1 = ( P . b1 ) & b = ( b1 +^ b2 )) & ( w2 . b ) = ( Q1 . b2 ))))));
(for c being (Element of ( Bags ( o1 +^ o2 ) )) holds ( w1 . c ) = ( w2 . c ))
proof
let c being (Element of ( Bags ( o1 +^ o2 ) ));
consider c1 being (Element of ( Bags o1 )),c2 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A37: Q1 = ( P . c1 ) and A38: c = ( c1 +^ c2 ) and A39: ( w1 . c ) = ( Q1 . c2 ) by A35;
consider d1 being (Element of ( Bags o1 )),d2 being (Element of ( Bags o2 )),S1 being (Polynomial of o2,L) such that A40: S1 = ( P . d1 ) and A41: c = ( d1 +^ d2 ) and A42: ( w2 . c ) = ( S1 . d2 ) by A36;
c2 = d2 by A38,A41,CKB12:1;
hence thesis by A37,A38,A39,A40,A41,A42,CKB12:1;
end;
hence w1 = w2 by FUNCT_2:63;
end;
end;
