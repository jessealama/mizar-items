environ
vocabularies NUMBERS,ORDINAL1,XBOOLE_0,ALGSTR_0,WELLORD1,QUOFIELD,RELAT_1,FUNCT_1,SUBSET_1,STRUCT_0,ORDINAL2,TARSKI,ORDINAL3,PRE_POLY,ARYTM_3,CARD_1,PBOOLE,FINSET_1,VALUED_0,FUNCOP_1,RLVECT_1,LATTICES,BINOP_1,POLYNOM1,FINSEQ_1,CARD_3,PARTFUN1,FINSEQ_2,NAT_1,VECTSP_1,ZFMISC_1,GROUP_1,SUPINF_2,XXREAL_0,FINSEQ_3,ORDINAL4,ARYTM_1,ORDERS_1,MSSUBFAM,POLYNOM6;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,VALUED_0,VECTSP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,POLYNOM1,STRUCT_0,ALGSTR_0,NAT_1,NAT_D,ORDERS_1,PBOOLE,RLVECT_1,FINSET_1,FINSEQ_1,FINSEQ_2,ORDINAL1,ORDINAL2,ORDINAL3,GROUP_1,QUOFIELD,GRCAT_1,WSIERP_1,PRE_POLY,FVSUM_1,POLYNOM3,GROUP_6,XXREAL_0,MATRLIN,CKB1,CKB2,CKB7,CKB15;
definitions VECTSP_1,QUOFIELD,GRCAT_1,FUNCT_1,TARSKI,XBOOLE_0,STRUCT_0,VALUED_0,CKB7,CKB15;
theorems POLYNOM1,TOPGRP_1,FUNCT_2,PBOOLE,FUNCT_1,ORDINAL3,ORDINAL1,ORDINAL2,FINSEQ_3,FINSEQ_2,FVSUM_1,FINSEQ_1,RELAT_1,FUNCOP_1,POLYALG1,FINSEQ_5,VECTSP_1,FINSEQ_4,FINSET_1,TARSKI,POLYNOM2,MATRLIN,RLVECT_1,NAT_1,SUBSET_1,CARD_3,POLYNOM3,ORDERS_1,RVSUM_1,XBOOLE_0,XBOOLE_1,XREAL_1,GROUP_6,XXREAL_0,GROUP_1,PARTFUN1,NAT_D,PRE_POLY,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21;
schemes PBOOLE,FUNCT_2,FRAENKEL,FUNCT_1,RECDEF_1;
registrations FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,XREAL_0,FINSEQ_1,FINSEQ_2,STRUCT_0,VECTSP_1,QUOFIELD,PRE_POLY,POLYNOM1,POLYNOM2,VALUED_0,CARD_1,CKB4,CKB5,CKB14;
constructors ORDINAL3,XXREAL_0,BINARITH,WSIERP_1,GRCAT_1,GROUP_6,TRIANG_1,QUOFIELD,POLYNOM1,POLYNOM3,NAT_D,RELSET_1,MATRLIN,FVSUM_1,VFUNCT_1,CKB2,CKB7,CKB15;
requirements BOOLE,SUBSET,NUMERALS,REAL;
begin
theorem
(for o1,o2 being non empty Ordinal holds (for L being  Abelian  right_zeroed  add-associative  right_complementable  well-unital  distributive  associative  well-unital non trivial doubleLoopStr holds ( Polynom-Ring (o1,( Polynom-Ring (o2,L) )) ),( Polynom-Ring (( o1 +^ o2 ),L) ) are_isomorphic ))
proof
let o1 being non empty Ordinal,o2 being non empty Ordinal;
let L being  Abelian  right_zeroed  add-associative  right_complementable  well-unital  distributive  associative  well-unital non trivial non empty doubleLoopStr;
set P2 = ( Polynom-Ring (( o1 +^ o2 ),L) );
set P1 = ( Polynom-Ring (o1,( Polynom-Ring (o2,L) )) );
defpred R[ set,set ]
 means
(for P being (Polynomial of o1,( Polynom-Ring (o2,L) )) holds ($1 = P implies $2 = ( Compress P )));
reconsider 1P1 = ( 1_ P1 ) as (Polynomial of o1,( Polynom-Ring (o2,L) )) by POLYNOM1:def 10;
reconsider 1P2 = ( 1_ P2 ) as (Polynomial of ( o1 +^ o2 ),L) by POLYNOM1:def 10;
A1: (for x being (Element of P1) holds (ex u being (Element of P2) st R[ x,u ]))
proof
let x being (Element of P1);
reconsider Q = x as (Polynomial of o1,( Polynom-Ring (o2,L) )) by POLYNOM1:def 10;
reconsider u = ( Compress Q ) as (Element of P2) by POLYNOM1:def 10;
take u;
let P being (Polynomial of o1,( Polynom-Ring (o2,L) ));
assume x = P;
hence thesis;
end;
consider f being (Function of (the carrier of P1),(the carrier of P2)) such that A2: (for x being (Element of P1) holds R[ x,( f . x ) ]) from FUNCT_2:sch 3(A1);
reconsider f as (Function of P1,P2);
take f;
thus A3: f is  additive
proof
let x being (Element of P1),y being (Element of P1);
reconsider x9 = x,y9 = y as (Element of P1);
reconsider p = x9,q = y9 as (Polynomial of o1,( Polynom-Ring (o2,L) )) by POLYNOM1:def 10;
reconsider fp = ( f . x ),fq = ( f . y ),fpq = ( f . ( x + y ) ) as (Element of P2);
reconsider fp,fq,fpq as (Polynomial of ( o1 +^ o2 ),L) by POLYNOM1:def 10;
(for x being (bag of ( o1 +^ o2 )) holds ( fpq . x ) = ( ( fp . x ) + ( fq . x ) ))
proof
let b being (bag of ( o1 +^ o2 ));
reconsider b9 = b as (Element of ( Bags ( o1 +^ o2 ) )) by PRE_POLY:def 12;
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A4: Q1 = ( p . b1 ) and A5: b9 = ( b1 +^ b2 ) and A6: ( ( Compress p ) . b9 ) = ( Q1 . b2 ) by CKB15:def 1;
consider b19 being (Element of ( Bags o1 )),b29 being (Element of ( Bags o2 )),Q19 being (Polynomial of o2,L) such that A7: Q19 = ( q . b19 ) and A8: b9 = ( b19 +^ b29 ) and A9: ( ( Compress q ) . b9 ) = ( Q19 . b29 ) by CKB15:def 1;
consider b199 being (Element of ( Bags o1 )),b299 being (Element of ( Bags o2 )),Q199 being (Polynomial of o2,L) such that A10: Q199 = ( ( p + q ) . b199 ) and A11: b9 = ( b199 +^ b299 ) and A12: ( ( Compress ( p + q ) ) . b9 ) = ( Q199 . b299 ) by CKB15:def 1;
A13: b19 = b199 by A8,A11,CKB12:1;
reconsider b1 as (bag of o1);
A14: ( ( p + q ) . b1 ) = ( ( p . b1 ) + ( q . b1 ) ) by POLYNOM1:15;
b1 = b19 by A5,A8,CKB12:1;
then Q199 = ( Q1 + Q19 ) by A4,A7,A10,A13,A14,POLYNOM1:def 10;
then A15: ( Q199 . b2 ) = ( ( Q1 . b2 ) + ( Q19 . b2 ) ) by POLYNOM1:15;
A16: b29 = b299 by A8,A11,CKB12:1;
A17: b2 = b29 by A5,A8,CKB12:1;
( x + y ) = ( p + q ) by POLYNOM1:def 10;
hence ( fpq . b ) = ( ( Compress ( p + q ) ) . b9 ) by A2
.= ( ( ( Compress p ) . b9 ) + ( fq . b ) ) by A2,A6,A9,A12,A17,A16,A15
.= ( ( fp . b ) + ( fq . b ) ) by A2;
end;
hence ( f . ( x + y ) ) = ( fp + fq ) by POLYNOM1:16
.= ( ( f . x ) + ( f . y ) ) by POLYNOM1:def 10;
end;

now
let x being (Element of P1),y being (Element of P1);
reconsider x9 = x,y9 = y as (Element of P1);
reconsider p = x9,q = y9 as (Polynomial of o1,( Polynom-Ring (o2,L) )) by POLYNOM1:def 10;
reconsider fp = ( f . x ),fq = ( f . y ) as (Element of P2);
reconsider fp,fq as (Polynomial of ( o1 +^ o2 ),L) by POLYNOM1:def 10;
( f . ( x * y ) ) = ( f . ( p *' q ) ) by POLYNOM1:def 10;
then reconsider fpq9 = ( f . ( p *' q ) ) as (Polynomial of ( o1 +^ o2 ),L) by POLYNOM1:def 10;
A18: (for b being (bag of ( o1 +^ o2 )) holds (ex s being (FinSequence of (the carrier of L)) st ((( fpq9 . b ) = ( Sum s ) & ( len s ) = ( len ( decomp b ) )) & (for k being (Element of ( NAT )) holds (k in ( dom s ) implies (ex b1,b2 being (bag of ( o1 +^ o2 )) st (( ( decomp b ) /. k ) = <* b1,b2 *> & ( s /. k ) = ( ( fp . b1 ) * ( fq . b2 ) ))))))))
proof
reconsider x = ( p *' q ) as (Element of P1) by POLYNOM1:def 10;
let c being (bag of ( o1 +^ o2 ));
reconsider b = c as (Element of ( Bags ( o1 +^ o2 ) )) by PRE_POLY:def 12;
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )) such that A19: b = ( b1 +^ b2 ) by CKB11:1;
reconsider b1 as (bag of o1);
consider r being (FinSequence of (the carrier of ( Polynom-Ring (o2,L) ))) such that A20: ( ( p *' q ) . b1 ) = ( Sum r ) and A21: ( len r ) = ( len ( decomp b1 ) ) and A22: (for k being (Element of ( NAT )) holds (k in ( dom r ) implies (ex a19,b19 being (bag of o1) st (( ( decomp b1 ) /. k ) = <* a19,b19 *> & ( r /. k ) = ( ( p . a19 ) * ( q . b19 ) ))))) by POLYNOM1:def 9;
(for x being set holds (x in ( dom r ) implies ( r . x ) is Function))
proof
let x being set;
assume x in ( dom r );
then A23: ( r . x ) in ( rng r ) by FUNCT_1:3;
( rng r ) c= (the carrier of ( Polynom-Ring (o2,L) )) by FINSEQ_1:def 4;
hence thesis by A23,POLYNOM1:def 10;
end;
then reconsider rFF = r as  Function-yielding Function by FUNCOP_1:def 6;
deffunc F(set) = ( ( rFF . $1 ) . b2 );
consider rFFb2 being Function such that A24: ( dom rFFb2 ) = ( dom r ) and A25: (for i being set holds (i in ( dom r ) implies ( rFFb2 . i ) = F(i))) from FUNCT_1:sch 3;
(ex i being Nat st ( dom r ) = ( Seg i )) by FINSEQ_1:def 2;
then reconsider rFFb2 as FinSequence by A24,FINSEQ_1:def 2;
A26: ( rng rFFb2 ) c= (the carrier of L)
proof
let u being set;
A27: ( rng rFF ) c= (the carrier of ( Polynom-Ring (o2,L) )) by FINSEQ_1:def 4;
assume u in ( rng rFFb2 );
then consider x being set such that A28: x in ( dom rFFb2 ) and A29: u = ( rFFb2 . x ) by FUNCT_1:def 3;
( rFF . x ) in ( rng rFF ) by A24,A28,FUNCT_1:3;
then A30: ( rFF . x ) is (Function of ( Bags o2 ),(the carrier of L)) by A27,POLYNOM1:def 10;
then A31: ( rng ( rFF . x ) ) c= (the carrier of L) by RELAT_1:def 19;
( dom ( rFF . x ) ) = ( Bags o2 ) by A30,FUNCT_2:def 1;
then A32: ( ( rFF . x ) . b2 ) in ( rng ( rFF . x ) ) by FUNCT_1:3;
( rFFb2 . x ) = ( ( rFF . x ) . b2 ) by A24,A25,A28;
hence thesis by A29,A31,A32;
end;
defpred P[ set,set ]
 means
(ex a19,b19 being (bag of o1) st (ex Fk being (FinSequence of (the carrier of L)) st (ex pa19,qb19 being (Polynomial of o2,L) st (((((pa19 = ( p . a19 ) & qb19 = ( q . b19 )) & Fk = $2) & ( ( decomp b1 ) /. $1 ) = <* a19,b19 *>) & ( len Fk ) = ( len ( decomp b2 ) )) & (for m being Nat holds (m in ( dom Fk ) implies (ex a199,b199 being (bag of o2) st (( ( decomp b2 ) /. m ) = <* a199,b199 *> & ( Fk /. m ) = ( ( pa19 . a199 ) * ( qb19 . b199 ) )))))))));
A33: (for k being (Element of ( NAT )) holds (k in ( Seg ( len r ) ) implies (ex x being (Element of ( (the carrier of L) * )) st P[ k,x ])))
proof
let k being (Element of ( NAT ));
assume k in ( Seg ( len r ) );
then k in ( dom ( decomp b1 ) ) by A21,FINSEQ_1:def 3;
then consider a19 being (bag of o1),b19 being (bag of o1) such that A34: ( ( decomp b1 ) /. k ) = <* a19,b19 *> and b1 = ( a19 + b19 ) by PRE_POLY:68;
reconsider pa199 = ( p . a19 ),qb199 = ( q . b19 ) as (Element of ( Polynom-Ring (o2,L) ));
reconsider pa19 = pa199,qb19 = qb199 as (Polynomial of o2,L) by POLYNOM1:def 10;
defpred Q[ set,set ]
 means
(ex a199,b199 being (bag of o2) st (( ( decomp b2 ) /. $1 ) = <* a199,b199 *> & $2 = ( ( pa19 . a199 ) * ( qb19 . b199 ) )));
A35: (for k being (Element of ( NAT )) holds (k in ( Seg ( len ( decomp b2 ) ) ) implies (ex x being (Element of L) st Q[ k,x ])))
proof
let k being (Element of ( NAT ));
assume k in ( Seg ( len ( decomp b2 ) ) );
then k in ( dom ( decomp b2 ) ) by FINSEQ_1:def 3;
then consider a199 being (bag of o2),b199 being (bag of o2) such that A36: ( ( decomp b2 ) /. k ) = <* a199,b199 *> and b2 = ( a199 + b199 ) by PRE_POLY:68;
reconsider x = ( ( pa19 . a199 ) * ( qb19 . b199 ) ) as (Element of L);
take x;
take a199;
take b199;
thus thesis by A36;
end;
consider Fk being (FinSequence of (the carrier of L)) such that A37: ( dom Fk ) = ( Seg ( len ( decomp b2 ) ) ) and A38: (for k being (Element of ( NAT )) holds (k in ( Seg ( len ( decomp b2 ) ) ) implies Q[ k,( Fk /. k ) ])) from RECDEF_1:sch 17(A35);
reconsider x = Fk as (Element of ( (the carrier of L) * )) by FINSEQ_1:def 11;
take x;
take a19;
take b19;
take Fk;
take pa19;
take qb19;
thus ((pa19 = ( p . a19 ) & qb19 = ( q . b19 )) & Fk = x);
thus ( ( decomp b1 ) /. k ) = <* a19,b19 *> by A34;
thus ( len Fk ) = ( len ( decomp b2 ) ) by A37,FINSEQ_1:def 3;
let m being Nat;
assume m in ( dom Fk );
hence thesis by A37,A38;
end;
consider F being (FinSequence of ( (the carrier of L) * )) such that A39: ( dom F ) = ( Seg ( len r ) ) and A40: (for k being (Element of ( NAT )) holds (k in ( Seg ( len r ) ) implies P[ k,( F /. k ) ])) from RECDEF_1:sch 17(A33);
take s = ( FlattenSeq F );
A41: ( len ( Sum F ) ) = ( len F ) by MATRLIN:def 6;
reconsider rFFb2 as (FinSequence of (the carrier of L)) by A26,FINSEQ_1:def 4;
A42: ( f . x ) = ( Compress ( p *' q ) ) by A2;
A43: ( dom rFFb2 ) = ( dom F ) by A39,A24,FINSEQ_1:def 3
.= ( dom ( Sum F ) ) by A41,FINSEQ_3:29;
(for k being Nat holds (k in ( dom rFFb2 ) implies ( rFFb2 . k ) = ( ( Sum F ) . k )))
proof
let k being Nat;
assume that
A44: k in ( dom rFFb2 );
consider c1 being (bag of o1),d1 being (bag of o1) such that A45: ( ( decomp b1 ) /. k ) = <* c1,d1 *> and A46: ( r /. k ) = ( ( p . c1 ) * ( q . d1 ) ) by A22,A24,A44;
k in ( Seg ( len r ) ) by A24,A44,FINSEQ_1:def 3;
then consider a19 being (bag of o1),b19 being (bag of o1),Fk being (FinSequence of (the carrier of L)),pa19 being (Polynomial of o2,L),qb19 being (Polynomial of o2,L) such that A47: (pa19 = ( p . a19 ) & qb19 = ( q . b19 )) and A48: Fk = ( F /. k ) and A49: ( ( decomp b1 ) /. k ) = <* a19,b19 *> and A50: ( len Fk ) = ( len ( decomp b2 ) ) and A51: (for ki being Nat holds (ki in ( dom Fk ) implies (ex a199,b199 being (bag of o2) st (( ( decomp b2 ) /. ki ) = <* a199,b199 *> & ( Fk /. ki ) = ( ( pa19 . a199 ) * ( qb19 . b199 ) ))))) by A40;
A52: (c1 = a19 & d1 = b19) by A45,A49,FINSEQ_1:77;
consider s1 being (FinSequence of (the carrier of L)) such that A53: ( ( pa19 *' qb19 ) . b2 ) = ( Sum s1 ) and A54: ( len s1 ) = ( len ( decomp b2 ) ) and A55: (for ki being (Element of ( NAT )) holds (ki in ( dom s1 ) implies (ex x1,y2 being (bag of o2) st (( ( decomp b2 ) /. ki ) = <* x1,y2 *> & ( s1 /. ki ) = ( ( pa19 . x1 ) * ( qb19 . y2 ) ))))) by POLYNOM1:def 9;
A56: ( dom s1 ) = ( Seg ( len s1 ) ) by FINSEQ_1:def 3;
now
let ki being Nat;
assume A57: ki in ( dom s1 );
then A58: ( s1 /. ki ) = ( s1 . ki ) by PARTFUN1:def 6;
A59: ki in ( dom Fk ) by A50,A54,A56,A57,FINSEQ_1:def 3;
then consider a199 being (bag of o2),b199 being (bag of o2) such that A60: ( ( decomp b2 ) /. ki ) = <* a199,b199 *> and A61: ( Fk /. ki ) = ( ( pa19 . a199 ) * ( qb19 . b199 ) ) by A51;
consider x1 being (bag of o2),y2 being (bag of o2) such that A62: ( ( decomp b2 ) /. ki ) = <* x1,y2 *> and A63: ( s1 /. ki ) = ( ( pa19 . x1 ) * ( qb19 . y2 ) ) by A55,A57;
(x1 = a199 & y2 = b199) by A62,A60,FINSEQ_1:77;
hence ( s1 . ki ) = ( Fk . ki ) by A63,A59,A61,A58,PARTFUN1:def 6;
end;
then A64: s1 = Fk by A50,A54,FINSEQ_2:9;
A65: ( rFF . k ) = ( r /. k ) by A24,A44,PARTFUN1:def 6
.= ( pa19 *' qb19 ) by A46,A47,A52,POLYNOM1:def 10;
thus ( rFFb2 . k ) = ( ( rFF . k ) . b2 ) by A24,A25,A44
.= ( ( Sum F ) /. k ) by A43,A44,A48,A65,A53,A64,MATRLIN:def 6
.= ( ( Sum F ) . k ) by A43,A44,PARTFUN1:def 6;
end;
then A66: rFFb2 = ( Sum F ) by A43,FINSEQ_1:13;
reconsider Sr = ( Sum r ) as (Polynomial of o2,L) by POLYNOM1:def 10;
consider gg being (Function of ( NAT ),(the carrier of ( Polynom-Ring (o2,L) ))) such that A67: ( Sum r ) = ( gg . ( len r ) ) and A68: ( gg . ( 0 ) ) = ( 0. ( Polynom-Ring (o2,L) ) ) and A69: (for j being (Element of ( NAT )) holds (for v being (Element of ( Polynom-Ring (o2,L) )) holds ((j < ( len r ) & v = ( r . ( j + 1 ) )) implies ( gg . ( j + 1 ) ) = ( ( gg . j ) + v )))) by RLVECT_1:def 12;
defpred R[ Nat,set ]
 means
(for pp being (Polynomial of o2,L) holds (($1 <= ( len r ) & pp = ( gg . $1 )) implies $2 = ( pp . b2 )));
A70: (for x being (Element of ( NAT )) holds (ex y being (Element of L) st R[ x,y ]))
proof
let x being (Element of ( NAT ));
reconsider pp9 = ( gg . x ) as (Polynomial of o2,L) by POLYNOM1:def 10;
take y = ( pp9 . b2 );
let pp being (Polynomial of o2,L);
assume that
x <= ( len r )
and
A71: pp = ( gg . x );
thus thesis by A71;
end;
consider ff being (Function of ( NAT ),(the carrier of L)) such that A72: (for j being (Element of ( NAT )) holds R[ j,( ff . j ) ]) from FUNCT_2:sch 3(A70);
defpred VV[ set,set ]
 means
(ex a19,b19 being (Element of ( Bags o1 )) st (ex Fk being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) st (((Fk = $2 & ( ( decomp b1 ) /. $1 ) = <* a19,b19 *>) & ( len Fk ) = ( len ( decomp b2 ) )) & (for m being Nat holds (m in ( dom Fk ) implies (ex a199,b199 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. m ) = <* a199,b199 *> & ( Fk /. m ) = <* ( a19 +^ a199 ),( b19 +^ b199 ) *>)))))));
A73: (for i being (Element of ( NAT )) holds (i in ( Seg ( len r ) ) implies (ex x being (Element of ( ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ) * )) st VV[ i,x ])))
proof
let k being (Element of ( NAT ));
assume k in ( Seg ( len r ) );
then k in ( dom ( decomp b1 ) ) by A21,FINSEQ_1:def 3;
then consider a19 being (bag of o1),b19 being (bag of o1) such that A74: ( ( decomp b1 ) /. k ) = <* a19,b19 *> and b1 = ( a19 + b19 ) by PRE_POLY:68;
reconsider a19,b19 as (Element of ( Bags o1 )) by PRE_POLY:def 12;
defpred Q[ set,set ]
 means
(ex a199,b199 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. $1 ) = <* a199,b199 *> & $2 = <* ( a19 +^ a199 ),( b19 +^ b199 ) *>));
A75: (for k being (Element of ( NAT )) holds (k in ( Seg ( len ( decomp b2 ) ) ) implies (ex x being (Element of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) st Q[ k,x ])))
proof
let k being (Element of ( NAT ));
assume k in ( Seg ( len ( decomp b2 ) ) );
then k in ( dom ( decomp b2 ) ) by FINSEQ_1:def 3;
then consider a199 being (bag of o2),b199 being (bag of o2) such that A76: ( ( decomp b2 ) /. k ) = <* a199,b199 *> and b2 = ( a199 + b199 ) by PRE_POLY:68;
reconsider a199,b199 as (Element of ( Bags o2 )) by PRE_POLY:def 12;
reconsider x = <* ( a19 +^ a199 ),( b19 +^ b199 ) *> as (Element of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ));
take x;
take a199;
take b199;
thus thesis by A76;
end;
consider Fk being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) such that A77: ( dom Fk ) = ( Seg ( len ( decomp b2 ) ) ) and A78: (for k being (Element of ( NAT )) holds (k in ( Seg ( len ( decomp b2 ) ) ) implies Q[ k,( Fk /. k ) ])) from RECDEF_1:sch 17(A75);
reconsider x = Fk as (Element of ( ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ) * )) by FINSEQ_1:def 11;
take x;
take a19;
take b19;
take Fk;
thus Fk = x;
thus ( ( decomp b1 ) /. k ) = <* a19,b19 *> by A74;
thus ( len Fk ) = ( len ( decomp b2 ) ) by A77,FINSEQ_1:def 3;
let m being Nat;
assume m in ( dom Fk );
hence thesis by A77,A78;
end;
consider G being (FinSequence of ( ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) ) * )) such that A79: ( dom G ) = ( Seg ( len r ) ) and A80: (for i being (Element of ( NAT )) holds (i in ( Seg ( len r ) ) implies VV[ i,( G /. i ) ])) from RECDEF_1:sch 17(A73);
A81: (for i being Nat holds (i in ( Seg ( len r ) ) implies VV[ i,( G /. i ) ])) by A80;
A82: ( dom ( Card F ) ) = ( dom F ) by CARD_3:def 2;
A83: (for j being Nat holds (j in ( dom ( Card F ) ) implies ( ( Card F ) . j ) = ( ( Card G ) . j )))
proof
let j being Nat;
assume A84: j in ( dom ( Card F ) );
then A85: j in ( dom F ) by CARD_3:def 2;
then A86: ( ( Card F ) . j ) = ( card ( F . j ) ) by CARD_3:def 2;
A87: ((ex a19,b19 being (bag of o1) st (ex Fk being (FinSequence of (the carrier of L)) st (ex pa19,qb19 being (Polynomial of o2,L) st (((((pa19 = ( p . a19 ) & qb19 = ( q . b19 )) & Fk = ( F /. j )) & ( ( decomp b1 ) /. j ) = <* a19,b19 *>) & ( len Fk ) = ( len ( decomp b2 ) )) & (for m being Nat holds (m in ( dom Fk ) implies (ex a199,b199 being (bag of o2) st (( ( decomp b2 ) /. m ) = <* a199,b199 *> & ( Fk /. m ) = ( ( pa19 . a199 ) * ( qb19 . b199 ) ))))))))) & (ex a29,b29 being (Element of ( Bags o1 )) st (ex Gk being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) st (((Gk = ( G /. j ) & ( ( decomp b1 ) /. j ) = <* a29,b29 *>) & ( len Gk ) = ( len ( decomp b2 ) )) & (for m being Nat holds (m in ( dom Gk ) implies (ex a299,b299 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. m ) = <* a299,b299 *> & ( Gk /. m ) = <* ( a29 +^ a299 ),( b29 +^ b299 ) *>)))))))) by A39,A40,A80,A85;
( card ( F . j ) ) = ( card ( F /. j ) ) by A85,PARTFUN1:def 6
.= ( card ( G . j ) ) by A39,A79,A82,A84,A87,PARTFUN1:def 6;
hence thesis by A39,A79,A82,A84,A86,CARD_3:def 2;
end;
consider c1 being (Element of ( Bags o1 )),c2 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A88: Q1 = ( ( p *' q ) . c1 ) and A89: b = ( c1 +^ c2 ) and A90: ( ( Compress ( p *' q ) ) . b ) = ( Q1 . c2 ) by CKB15:def 1;
A91: c1 = b1 by A19,A89,CKB12:1;
then ( dom G ) = ( dom ( decomp c1 ) ) by A21,A79,FINSEQ_1:def 3;
then A92: ( decomp c ) = ( FlattenSeq G ) by A19,A79,A81,A91,CKB21:1;
A93: (for j being (Element of ( NAT )) holds (for v being (Element of L) holds ((j < ( len rFFb2 ) & v = ( rFFb2 . ( j + 1 ) )) implies ( ff . ( j + 1 ) ) = ( ( ff . j ) + v ))))
proof
let j being (Element of ( NAT ));
let v being (Element of L);
assume that
A94: j < ( len rFFb2 )
and
A95: v = ( rFFb2 . ( j + 1 ) );
reconsider w = ( r /. ( j + 1 ) ),pp = ( gg . j ),pp9 = ( gg . ( j + 1 ) ) as (Polynomial of o2,L) by POLYNOM1:def 10;
reconsider w1 = w,pp1 = pp,pp19 = pp9 as (Element of ( Polynom-Ring (o2,L) ));
reconsider w1,pp1,pp19 as (Element of ( Polynom-Ring (o2,L) ));
A96: j < ( len r ) by A24,A94,FINSEQ_3:29;
then A97: ( j + 1 ) <= ( len r ) by NAT_1:13;
then A98: w = ( r . ( j + 1 ) ) by FINSEQ_4:15,NAT_1:11;
then A99: pp19 = ( pp1 + w1 ) by A69,A96;
1 <= ( j + 1 ) by NAT_1:11;
then ( j + 1 ) in ( dom r ) by A97,FINSEQ_3:25;
then A100: ( w . b2 ) = v by A25,A95,A98;
( j + 1 ) <= ( len r ) by A96,NAT_1:13;
hence ( ff . ( j + 1 ) ) = ( pp9 . b2 ) by A72
.= ( ( pp + w ) . b2 ) by A99,POLYNOM1:def 10
.= ( ( pp . b2 ) + ( w . b2 ) ) by POLYNOM1:15
.= ( ( ff . j ) + v ) by A72,A96,A100;
end;
( gg . ( 0 ) ) = ( 0_ (o2,L) ) by A68,POLYNOM1:def 10;
then A101: ( ff . ( 0 ) ) = ( ( 0_ (o2,L) ) . b2 ) by A72,NAT_1:2
.= ( 0. L ) by POLYNOM1:22;
( len rFFb2 ) = ( len r ) by A24,FINSEQ_3:29;
then ( Sr . b2 ) = ( ff . ( len rFFb2 ) ) by A67,A72;
then A102: ( Sr . b2 ) = ( Sum rFFb2 ) by A101,A93,RLVECT_1:def 12;
(b1 = c1 & b2 = c2) by A19,A89,CKB12:1;
hence ( fpq9 . c ) = ( Sum s ) by A20,A88,A90,A66,A102,A42,POLYNOM1:14;
( dom ( Card G ) ) = ( dom G ) by CARD_3:def 2;
then ( len ( Card F ) ) = ( len ( Card G ) ) by A39,A79,A82,FINSEQ_3:29;
then A103: ( Card F ) = ( Card G ) by A83,FINSEQ_2:9;
hence A104: ( len s ) = ( len ( decomp c ) ) by A92,PRE_POLY:28;
let k being (Element of ( NAT ));
assume A105: k in ( dom s );
then consider i being (Element of ( NAT )),j being (Element of ( NAT )) such that A106: i in ( dom F ) and A107: j in ( dom ( F . i ) ) and A108: k = ( ( Sum ( Card ( F | ( i -' 1 ) ) ) ) + j ) and A109: ( ( F . i ) . j ) = ( ( FlattenSeq F ) . k ) by PRE_POLY:29;
A110: k in ( dom ( decomp c ) ) by A104,A105,FINSEQ_3:29;
then consider i9 being (Element of ( NAT )),j9 being (Element of ( NAT )) such that A111: i9 in ( dom G ) and A112: j9 in ( dom ( G . i9 ) ) and A113: k = ( ( Sum ( Card ( G | ( i9 -' 1 ) ) ) ) + j9 ) and A114: ( ( G . i9 ) . j9 ) = ( ( decomp c ) . k ) by A92,PRE_POLY:29;
( ( Sum ( ( Card F ) | ( i -' 1 ) ) ) + j ) = ( ( Sum ( Card ( F | ( i -' 1 ) ) ) ) + j ) by POLYNOM3:16
.= ( ( Sum ( ( Card G ) | ( i9 -' 1 ) ) ) + j9 ) by A108,A113,POLYNOM3:16;
then A115: (i = i9 & j = j9) by A103,A106,A107,A111,A112,POLYNOM3:22;
consider c1 being (bag of ( o1 +^ o2 )),c2 being (bag of ( o1 +^ o2 )) such that A116: ( ( decomp c ) /. k ) = <* c1,c2 *> and c = ( c1 + c2 ) by A110,PRE_POLY:68;
reconsider cc1 = c1,cc2 = c2 as (Element of ( Bags ( o1 +^ o2 ) )) by PRE_POLY:def 12;
consider cb1 being (Element of ( Bags o1 )),cb2 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A117: Q1 = ( p . cb1 ) and A118: cc1 = ( cb1 +^ cb2 ) and A119: ( ( Compress p ) . cc1 ) = ( Q1 . cb2 ) by CKB15:def 1;
consider a19 being (bag of o1),b19 being (bag of o1),Fk being (FinSequence of (the carrier of L)),pa19 being (Polynomial of o2,L),qb19 being (Polynomial of o2,L) such that A120: pa19 = ( p . a19 ) and A121: qb19 = ( q . b19 ) and A122: Fk = ( F /. i ) and A123: ( ( decomp b1 ) /. i ) = <* a19,b19 *> and ( len Fk ) = ( len ( decomp b2 ) ) and A124: (for m being Nat holds (m in ( dom Fk ) implies (ex a199,b199 being (bag of o2) st (( ( decomp b2 ) /. m ) = <* a199,b199 *> & ( Fk /. m ) = ( ( pa19 . a199 ) * ( qb19 . b199 ) ))))) by A39,A40,A106;
consider ga19 being (Element of ( Bags o1 )),gb19 being (Element of ( Bags o1 )),Gk being (FinSequence of ( 2 -tuples_on ( Bags ( o1 +^ o2 ) ) )) such that A125: Gk = ( G /. i ) and A126: ( ( decomp b1 ) /. i ) = <* ga19,gb19 *> and ( len Gk ) = ( len ( decomp b2 ) ) and A127: (for m being Nat holds (m in ( dom Gk ) implies (ex ga199,gb199 being (Element of ( Bags o2 )) st (( ( decomp b2 ) /. m ) = <* ga199,gb199 *> & ( Gk /. m ) = <* ( ga19 +^ ga199 ),( gb19 +^ gb199 ) *>)))) by A39,A80,A106;
A128: b19 = gb19 by A123,A126,FINSEQ_1:77;
A129: Gk = ( G . i ) by A39,A79,A106,A125,PARTFUN1:def 6;
then consider ga199 being (Element of ( Bags o2 )),gb199 being (Element of ( Bags o2 )) such that A130: ( ( decomp b2 ) /. j ) = <* ga199,gb199 *> and A131: ( Gk /. j ) = <* ( ga19 +^ ga199 ),( gb19 +^ gb199 ) *> by A112,A115,A127;
A132: <* c1,c2 *> = ( ( G . i ) . j ) by A110,A116,A114,A115,PARTFUN1:def 6
.= <* ( ga19 +^ ga199 ),( gb19 +^ gb199 ) *> by A112,A115,A129,A131,PARTFUN1:def 6;
then c1 = ( ga19 +^ ga199 ) by FINSEQ_1:77;
then A133: (cb1 = ga19 & cb2 = ga199) by A118,CKB12:1;
A134: a19 = ga19 by A123,A126,FINSEQ_1:77;
j in ( dom Fk ) by A106,A107,A122,PARTFUN1:def 6;
then consider a199 being (bag of o2),b199 being (bag of o2) such that A135: ( ( decomp b2 ) /. j ) = <* a199,b199 *> and A136: ( Fk /. j ) = ( ( pa19 . a199 ) * ( qb19 . b199 ) ) by A124;
a199 = ga199 by A130,A135,FINSEQ_1:77;
then A137: ( pa19 . a199 ) = ( fp . c1 ) by A2,A120,A117,A119,A133,A134;
take c1;
take c2;
thus ( ( decomp c ) /. k ) = <* c1,c2 *> by A116;
consider cb1 being (Element of ( Bags o1 )),cb2 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A138: Q1 = ( q . cb1 ) and A139: cc2 = ( cb1 +^ cb2 ) and A140: ( ( Compress q ) . cc2 ) = ( Q1 . cb2 ) by CKB15:def 1;
c2 = ( gb19 +^ gb199 ) by A132,FINSEQ_1:77;
then A141: (cb1 = gb19 & cb2 = gb199) by A139,CKB12:1;
A142: Fk = ( F . i ) by A106,A122,PARTFUN1:def 6;
b199 = gb199 by A130,A135,FINSEQ_1:77;
then A143: ( qb19 . b199 ) = ( fq . c2 ) by A2,A121,A128,A138,A140,A141;
thus ( s /. k ) = ( s . k ) by A105,PARTFUN1:def 6
.= ( ( fp . c1 ) * ( fq . c2 ) ) by A107,A109,A142,A136,A137,A143,PARTFUN1:def 6;
end;
thus ( f . ( x * y ) ) = ( f . ( p *' q ) ) by POLYNOM1:def 10
.= ( fp *' fq ) by A18,POLYNOM1:def 9
.= ( ( f . x ) * ( f . y ) ) by POLYNOM1:def 10;
end;
hence A144: f is  multiplicative by GROUP_6:def 6;
A145: (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds ( ( Compress 1P1 ) . b ) = ( 1P2 . b ))
proof
let b being (Element of ( Bags ( o1 +^ o2 ) ));
A146: ( 1P2 . b ) = ( ( 1_ (( o1 +^ o2 ),L) ) . b ) by POLYNOM1:31;
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A147: Q1 = ( 1P1 . b1 ) and A148: b = ( b1 +^ b2 ) and A149: ( ( Compress 1P1 ) . b ) = ( Q1 . b2 ) by CKB15:def 1;
per cases ;
suppose A150: b = ( EmptyBag ( o1 +^ o2 ) );

then A151: b1 = ( EmptyBag o1 ) by A148,CKB10:1;
A152: b2 = ( EmptyBag o2 ) by A148,A150,CKB10:1;
Q1 = ( ( 1_ (o1,( Polynom-Ring (o2,L) )) ) . b1 ) by A147,POLYNOM1:31
.= ( 1_ ( Polynom-Ring (o2,L) ) ) by A151,POLYNOM1:25;
then ( Q1 . b2 ) = ( ( 1_ (o2,L) ) . b2 ) by POLYNOM1:31
.= ( 1_ L ) by A152,POLYNOM1:25
.= ( 1P2 . b ) by A146,A150,POLYNOM1:25;
hence thesis by A149;
end;
suppose A153: b <> ( EmptyBag ( o1 +^ o2 ) );

then A154: (b1 <> ( EmptyBag o1 ) or b2 <> ( EmptyBag o2 )) by A148,CKB10:1;
now
per cases ;
suppose A155: b1 = ( EmptyBag o1 );

Q1 = ( ( 1_ (o1,( Polynom-Ring (o2,L) )) ) . b1 ) by A147,POLYNOM1:31
.= ( 1_ ( Polynom-Ring (o2,L) ) ) by A155,POLYNOM1:25
.= ( 1_ (o2,L) ) by POLYNOM1:31;
then ( Q1 . b2 ) = ( 0. L ) by A154,A155,POLYNOM1:25
.= ( 1P2 . b ) by A146,A153,POLYNOM1:25;
hence thesis by A149;
end;
suppose A156: b1 <> ( EmptyBag o1 );

Q1 = ( ( 1_ (o1,( Polynom-Ring (o2,L) )) ) . b1 ) by A147,POLYNOM1:31
.= ( 0. ( Polynom-Ring (o2,L) ) ) by A156,POLYNOM1:25
.= ( 0_ (o2,L) ) by POLYNOM1:def 10;
then ( Q1 . b2 ) = ( 0. L ) by POLYNOM1:22
.= ( 1P2 . b ) by A146,A153,POLYNOM1:25;
hence thesis by A149;
end;
end;
hence thesis;
end;
end;
( f . ( 1_ P1 ) ) = ( Compress 1P1 ) by A2
.= ( 1_ P2 ) by A145,FUNCT_2:63;
hence A157: f is  unity-preserving by GROUP_1:def 13;
thus f is  one-to-one
proof
let x1 being set,x2 being set;
assume x1 in ( dom f );
then reconsider x19 = x1 as (Element of P1) by FUNCT_2:def 1;
assume x2 in ( dom f );
then reconsider x29 = x2 as (Element of P1) by FUNCT_2:def 1;
reconsider x299 = x29 as (Polynomial of o1,( Polynom-Ring (o2,L) )) by POLYNOM1:def 10;
reconsider x199 = x19 as (Polynomial of o1,( Polynom-Ring (o2,L) )) by POLYNOM1:def 10;
A158: ( f . x29 ) = ( Compress x299 ) by A2;
then reconsider w2 = ( f . x29 ) as (Polynomial of ( o1 +^ o2 ),L);
A159: ( f . x19 ) = ( Compress x199 ) by A2;
then reconsider w1 = ( f . x19 ) as (Polynomial of ( o1 +^ o2 ),L);
assume A160: ( f . x1 ) = ( f . x2 );
now
let b1 being (Element of ( Bags o1 ));
reconsider x199b1 = ( x199 . b1 ),x299b1 = ( x299 . b1 ) as (Polynomial of o2,L) by POLYNOM1:def 10;
now
let b2 being (Element of ( Bags o2 ));
set b = ( b1 +^ b2 );
consider b19 being (Element of ( Bags o1 )),b29 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A161: Q1 = ( x199 . b19 ) and A162: b = ( b19 +^ b29 ) and A163: ( w1 . b ) = ( Q1 . b29 ) by A159,CKB15:def 1;
A164: (b1 = b19 & b2 = b29) by A162,CKB12:1;
consider c1 being (Element of ( Bags o1 )),c2 being (Element of ( Bags o2 )),Q19 being (Polynomial of o2,L) such that A165: Q19 = ( x299 . c1 ) and A166: b = ( c1 +^ c2 ) and A167: ( w2 . b ) = ( Q19 . c2 ) by A158,CKB15:def 1;
b1 = c1 by A166,CKB12:1;
hence ( x199b1 . b2 ) = ( x299b1 . b2 ) by A160,A161,A163,A165,A166,A167,A164,CKB12:1;
end;
hence ( x199 . b1 ) = ( x299 . b1 ) by FUNCT_2:63;
end;
hence thesis by FUNCT_2:63;
end;

thus f is  RingHomomorphism by A3,A144,A157;
thus ( rng f ) c= (the carrier of P2) by RELAT_1:def 19;
thus (the carrier of P2) c= ( rng f )
proof
defpred KK[ set,set ]
 means
(ex b1 being (Element of ( Bags o1 )) st (ex b2 being (Element of ( Bags o2 )) st ($1 = ( b1 +^ b2 ) & $2 = b1)));
let y being set;
assume y in (the carrier of P2);
then reconsider s = y as (Polynomial of ( o1 +^ o2 ),L) by POLYNOM1:def 10;
defpred K[ (Element of ( Bags o1 )),(Element of ( Polynom-Ring (o2,L) )) ]
 means
(ex h being Function st (h = $2 & (for b2 being (Element of ( Bags o2 )) holds (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds (b = ( $1 +^ b2 ) implies ( h . b2 ) = ( s . b ))))));
A168: (for x being (Element of ( Bags ( o1 +^ o2 ) )) holds (ex y being (Element of ( Bags o1 )) st KK[ x,y ]))
proof
let x being (Element of ( Bags ( o1 +^ o2 ) ));
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )) such that A169: x = ( b1 +^ b2 ) by CKB11:1;
reconsider y = b1 as (Element of ( Bags o1 ));
take y;
take b1;
take b2;
thus x = ( b1 +^ b2 ) by A169;
thus y = b1;
end;
consider kk being (Function of ( Bags ( o1 +^ o2 ) ),( Bags o1 )) such that A170: (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds KK[ b,( kk . b ) ]) from FUNCT_2:sch 3(A168);
A171: (for x being (Element of ( Bags o1 )) holds (ex y being (Element of ( Polynom-Ring (o2,L) )) st K[ x,y ]))
proof
defpred KK[ set,set ]
 means
(ex b1 being (Element of ( Bags o1 )) st (ex b2 being (Element of ( Bags o2 )) st ($1 = ( b1 +^ b2 ) & $2 = b2)));
let x being (Element of ( Bags o1 ));
reconsider b1 = x as (Element of ( Bags o1 ));
defpred L[ (Element of ( Bags o2 )),(Element of L) ]
 means
(for b being (Element of ( Bags ( o1 +^ o2 ) )) holds (b = ( b1 +^ $1 ) implies $2 = ( s . b )));
A172: (for p being (Element of ( Bags o2 )) holds (ex q being (Element of L) st L[ p,q ]))
proof
let p being (Element of ( Bags o2 ));
take ( s . ( b1 +^ p ) );
let b being (Element of ( Bags ( o1 +^ o2 ) ));
assume b = ( b1 +^ p );
hence thesis;
end;
consider t being (Function of ( Bags o2 ),(the carrier of L)) such that A173: (for b2 being (Element of ( Bags o2 )) holds L[ b2,( t . b2 ) ]) from FUNCT_2:sch 3(A172);
reconsider t as (Function of ( Bags o2 ),L);
A174: (for x being (Element of ( Bags ( o1 +^ o2 ) )) holds (ex y being (Element of ( Bags o2 )) st KK[ x,y ]))
proof
let x being (Element of ( Bags ( o1 +^ o2 ) ));
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )) such that A175: x = ( b1 +^ b2 ) by CKB11:1;
reconsider y = b2 as (Element of ( Bags o2 ));
take y;
take b1;
take b2;
thus x = ( b1 +^ b2 ) by A175;
thus y = b2;
end;
consider kk being (Function of ( Bags ( o1 +^ o2 ) ),( Bags o2 )) such that A176: (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds KK[ b,( kk . b ) ]) from FUNCT_2:sch 3(A174);
( Support t ) c= ( kk .: ( Support s ) )
proof
let x being set;
assume A177: x in ( Support t );
then reconsider b2 = x as (Element of ( Bags o2 ));
set b = ( b1 +^ b2 );
( t . x ) <> ( 0. L ) by A177,POLYNOM1:def 3;
then ( s . b ) <> ( 0. L ) by A173;
then A178: (( dom kk ) = ( Bags ( o1 +^ o2 ) ) & b in ( Support s )) by FUNCT_2:def 1,POLYNOM1:def 3;
(ex b19 being (Element of ( Bags o1 )) st (ex b29 being (Element of ( Bags o2 )) st (b = ( b19 +^ b29 ) & ( kk . b ) = b29))) by A176;
then x = ( kk . b ) by CKB12:1;
hence thesis by A178,FUNCT_1:def 6;
end;
then t is (Polynomial of o2,L) by POLYNOM1:def 4;
then reconsider t99 = t as (Element of ( Polynom-Ring (o2,L) )) by POLYNOM1:def 10;
reconsider t9 = t as Function;
take t99;
take t9;
thus t99 = t9;
let b2 being (Element of ( Bags o2 ));
let b being (Element of ( Bags ( o1 +^ o2 ) ));
assume b = ( x +^ b2 );
hence thesis by A173;
end;
consider g being (Function of ( Bags o1 ),(the carrier of ( Polynom-Ring (o2,L) ))) such that A179: (for x being (Element of ( Bags o1 )) holds K[ x,( g . x ) ]) from FUNCT_2:sch 3(A171);
reconsider g as (Function of ( Bags o1 ),( Polynom-Ring (o2,L) ));
A180: ( Support g ) c= ( kk .: ( Support s ) )
proof
let x being set;
assume A181: x in ( Support g );
then reconsider b1 = x as (Element of ( Bags o1 ));
consider h being Function such that A182: h = ( g . b1 ) and A183: (for b2 being (Element of ( Bags o2 )) holds (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds (b = ( b1 +^ b2 ) implies ( h . b2 ) = ( s . b )))) by A179;
reconsider h as (Polynomial of o2,L) by A182,POLYNOM1:def 10;
( g . b1 ) <> ( 0. ( Polynom-Ring (o2,L) ) ) by A181,POLYNOM1:def 3;
then ( g . b1 ) <> ( 0_ (o2,L) ) by POLYNOM1:def 10;
then consider b2 being (Element of ( Bags o2 )) such that A184: b2 in ( Support h ) by A182,POLYNOM2:17,SUBSET_1:4;
set b = ( b1 +^ b2 );
( h . b2 ) <> ( 0. L ) by A184,POLYNOM1:def 3;
then ( s . b ) <> ( 0. L ) by A183;
then A185: (( dom kk ) = ( Bags ( o1 +^ o2 ) ) & b in ( Support s )) by FUNCT_2:def 1,POLYNOM1:def 3;
(ex b19 being (Element of ( Bags o1 )) st (ex b29 being (Element of ( Bags o2 )) st (b = ( b19 +^ b29 ) & ( kk . b ) = b19))) by A170;
then x = ( kk . b ) by CKB12:1;
hence thesis by A185,FUNCT_1:def 6;
end;
then g is (Polynomial of o1,( Polynom-Ring (o2,L) )) by POLYNOM1:def 4;
then reconsider g as (Element of P1) by POLYNOM1:def 10;
reconsider g9 = g as (Polynomial of o1,( Polynom-Ring (o2,L) )) by A180,POLYNOM1:def 4;
now
let b being (Element of ( Bags ( o1 +^ o2 ) ));
consider b1 being (Element of ( Bags o1 )),b2 being (Element of ( Bags o2 )),Q1 being (Polynomial of o2,L) such that A186: ((Q1 = ( g9 . b1 ) & b = ( b1 +^ b2 )) & ( ( Compress g9 ) . b ) = ( Q1 . b2 )) by CKB15:def 1;
(ex h being Function st (h = ( g9 . b1 ) & (for b2 being (Element of ( Bags o2 )) holds (for b being (Element of ( Bags ( o1 +^ o2 ) )) holds (b = ( b1 +^ b2 ) implies ( h . b2 ) = ( s . b )))))) by A179;
hence ( s . b ) = ( ( Compress g9 ) . b ) by A186;
end;
then A187: y = ( Compress g9 ) by FUNCT_2:63
.= ( f . g ) by A2;
( dom f ) = (the carrier of P1) by FUNCT_2:def 1;
hence thesis by A187,FUNCT_1:3;
end;

end;
