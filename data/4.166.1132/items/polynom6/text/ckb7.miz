environ
vocabularies NUMBERS,ORDINAL1,XBOOLE_0,ALGSTR_0,WELLORD1,QUOFIELD,RELAT_1,FUNCT_1,SUBSET_1,STRUCT_0,ORDINAL2,TARSKI,ORDINAL3,PRE_POLY,ARYTM_3,CARD_1,PBOOLE,FINSET_1,VALUED_0,FUNCOP_1,RLVECT_1,LATTICES,BINOP_1,POLYNOM1,FINSEQ_1,CARD_3,PARTFUN1,FINSEQ_2,NAT_1,VECTSP_1,ZFMISC_1,GROUP_1,SUPINF_2,XXREAL_0,FINSEQ_3,ORDINAL4,ARYTM_1,ORDERS_1,MSSUBFAM,POLYNOM6;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,VALUED_0,VECTSP_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,POLYNOM1,STRUCT_0,ALGSTR_0,NAT_1,NAT_D,ORDERS_1,PBOOLE,RLVECT_1,FINSET_1,FINSEQ_1,FINSEQ_2,ORDINAL1,ORDINAL2,ORDINAL3,GROUP_1,QUOFIELD,GRCAT_1,WSIERP_1,PRE_POLY,FVSUM_1,POLYNOM3,GROUP_6,XXREAL_0,MATRLIN,CKB1,CKB2;
definitions VECTSP_1,QUOFIELD,GRCAT_1,FUNCT_1,TARSKI,XBOOLE_0,STRUCT_0,VALUED_0;
theorems POLYNOM1,TOPGRP_1,FUNCT_2,PBOOLE,FUNCT_1,ORDINAL3,ORDINAL1,ORDINAL2,FINSEQ_3,FINSEQ_2,FVSUM_1,FINSEQ_1,RELAT_1,FUNCOP_1,POLYALG1,FINSEQ_5,VECTSP_1,FINSEQ_4,FINSET_1,TARSKI,POLYNOM2,MATRLIN,RLVECT_1,NAT_1,SUBSET_1,CARD_3,POLYNOM3,ORDERS_1,RVSUM_1,XBOOLE_0,XBOOLE_1,XREAL_1,GROUP_6,XXREAL_0,GROUP_1,PARTFUN1,NAT_D,PRE_POLY,CKB3,CKB6;
schemes PBOOLE,FUNCT_2,FRAENKEL,FUNCT_1,RECDEF_1;
registrations FUNCT_1,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,XREAL_0,FINSEQ_1,FINSEQ_2,STRUCT_0,VECTSP_1,QUOFIELD,PRE_POLY,POLYNOM1,POLYNOM2,VALUED_0,CARD_1,CKB4,CKB5;
constructors ORDINAL3,XXREAL_0,BINARITH,WSIERP_1,GRCAT_1,GROUP_6,TRIANG_1,QUOFIELD,POLYNOM1,POLYNOM3,NAT_D,RELSET_1,MATRLIN,FVSUM_1,VFUNCT_1,CKB2;
requirements BOOLE,SUBSET,NUMERALS,REAL;
begin
definition
let o1 being Ordinal;
let o2 being Ordinal;
let a being (Element of ( Bags o1 ));
let b being (Element of ( Bags o2 ));
func a +^ b -> (Element of ( Bags ( o1 +^ o2 ) ))
means
:Def1: (for o being Ordinal holds ((o in o1 implies ( it . o ) = ( a . o )) & (o in ( ( o1 +^ o2 ) \ o1 ) implies ( it . o ) = ( b . ( o -^ o1 ) ))));
existence
proof
per cases ;
suppose A1: o2 = ( {} );

then reconsider a9 = a as (Element of ( Bags ( o1 +^ o2 ) )) by ORDINAL2:27;
take a9;
let o being Ordinal;
thus (o in o1 implies ( a9 . o ) = ( a . o ));
( o1 +^ o2 ) = o1 by A1,ORDINAL2:27;
hence thesis by XBOOLE_1:37;
end;
suppose o2 <> ( {} );

then reconsider o29 = o2 as non empty Ordinal;
defpred P[ set,set ]
 means
(ex o being Ordinal st ((o = $1 & (o in o1 implies $2 = ( a . o ))) & (o in ( ( o1 +^ o2 ) \ o1 ) implies $2 = ( b . ( o -^ o1 ) ))));
deffunc F((Element of o29)) = ( o1 +^ $1 );
set B = { F(o) where o is (Element of o29): o in ( support b ) };
set C = { ( o1 +^ o ) where o is (Element of o29): (not contradiction) };
A2: (for i being set holds (i in ( o1 +^ o2 ) implies (ex j being set st P[ i,j ])))
proof
let i being set;
assume that
A3: i in ( o1 +^ o2 );
reconsider o = i as Ordinal by A3;
A4: (o in o1 iff (not o in ( ( o1 +^ o2 ) \ o1 ))) by A3,XBOOLE_0:def 5;
per cases  by A3,XBOOLE_0:def 5;
suppose A5: o in o1;

take ( a . o );
take o;
thus thesis by A5,XBOOLE_0:def 5;
end;
suppose A6: o in ( ( o1 +^ o2 ) \ o1 );

take ( b . ( o -^ o1 ) );
thus thesis by A4,A6;
end;
end;
consider f being (ManySortedSet of ( o1 +^ o2 )) such that A7: (for i being set holds (i in ( o1 +^ o2 ) implies P[ i,( f . i ) ])) from PBOOLE:sch 3(A2);
A8: ( support f ) c= ( ( support a ) \/ B )
proof
let x being set;
assume x in ( support f );
then A9: ( f . x ) <> ( 0 ) by PRE_POLY:def 7;
then x in ( dom f ) by FUNCT_1:def 2;
then A10: x in ( o1 +^ o2 ) by PARTFUN1:def 2;
(for x being set holds (x in C iff (ex o being Ordinal st (x = ( o1 +^ o ) & o in o2))))
proof
let x being set;
thus (x in C implies (ex o being Ordinal st (x = ( o1 +^ o ) & o in o2)))
proof
assume x in C;
then (ex o9 being (Element of o29) st x = ( o1 +^ o9 ));
hence thesis;
end;

thus thesis;
end;
then A11: x in ( o1 \/ C ) by A10,CKB3:1;
per cases  by A11,XBOOLE_0:def 3;
suppose A12: x in o1;

P[ x,( f . x ) ] by A7,A10;
then x in ( support a ) by A9,A12,PRE_POLY:def 7;
hence thesis by XBOOLE_0:def 3;
end;
suppose x in C;

then (ex o9 being (Element of o29) st x = ( o1 +^ o9 ));
then consider o99 being Ordinal such that A13: x = ( o1 +^ o99 ) and A14: o99 in o2;
reconsider o = x as Ordinal by A13;
A15: o1 c= o by A13,ORDINAL3:24;
A16:now
per cases ;
suppose o = o1;

hence (not o in o1);
end;
suppose o <> o1;

then o1 c< o by A15,XBOOLE_0:def 8;
hence (not o in o1) by ORDINAL1:11;
end;
end;
A17: P[ x,( f . x ) ] by A7,A10;
(x in ( o1 +^ o2 ) & o99 = ( o -^ o1 )) by A13,A14,ORDINAL2:32,ORDINAL3:52;
then o99 in ( support b ) by A9,A16,A17,PRE_POLY:def 7,XBOOLE_0:def 5;
then x in B by A13,A14;
hence thesis by XBOOLE_0:def 3;
end;
end;
A18: ( support b ) is  finite;
B is  finite from FRAENKEL:sch 21(A18);
then A19: f is  finite-support by A8,PRE_POLY:def 8;
f is  natural-valued
proof
let x being set;
assume x in ( dom f );
then A20: x in ( o1 +^ o2 ) by PARTFUN1:def 2;
then reconsider o = x as Ordinal;
A21: (ex o9 being Ordinal st ((o9 = x & (o9 in o1 implies ( f . x ) = ( a . o9 ))) & (o9 in ( ( o1 +^ o2 ) \ o1 ) implies ( f . x ) = ( b . ( o9 -^ o1 ) )))) by A7,A20;
per cases  by A20,XBOOLE_0:def 5;
suppose o in o1;

hence thesis by A21;
end;
suppose o in ( ( o1 +^ o2 ) \ o1 );

hence thesis by A21;
end;
end;
then reconsider f as (Element of ( Bags ( o1 +^ o2 ) )) by A19,PRE_POLY:def 12;
take f;
let o being Ordinal;
thus (o in o1 implies ( f . o ) = ( a . o ))
proof
assume A22: o in o1;
o1 c= ( o1 +^ o2 ) by ORDINAL3:24;
then (ex p being Ordinal st ((p = o & (p in o1 implies ( f . o ) = ( a . p ))) & (p in ( ( o1 +^ o2 ) \ o1 ) implies ( f . o ) = ( b . ( p -^ o1 ) )))) by A7,A22;
hence thesis by A22;
end;

assume A23: o in ( ( o1 +^ o2 ) \ o1 );
then (ex p being Ordinal st ((p = o & (p in o1 implies ( f . o ) = ( a . p ))) & (p in ( ( o1 +^ o2 ) \ o1 ) implies ( f . o ) = ( b . ( p -^ o1 ) )))) by A7;
hence thesis by A23;
end;
end;
uniqueness
proof
let a1 being (Element of ( Bags ( o1 +^ o2 ) )),a2 being (Element of ( Bags ( o1 +^ o2 ) ));
assume that
A24: (for o being Ordinal holds ((o in o1 implies ( a1 . o ) = ( a . o )) & (o in ( ( o1 +^ o2 ) \ o1 ) implies ( a1 . o ) = ( b . ( o -^ o1 ) ))))
and
A25: (for o being Ordinal holds ((o in o1 implies ( a2 . o ) = ( a . o )) & (o in ( ( o1 +^ o2 ) \ o1 ) implies ( a2 . o ) = ( b . ( o -^ o1 ) ))));
A26: ( dom a1 ) = ( o1 +^ o2 ) by PARTFUN1:def 2;
A27: (for c being set holds (c in ( dom a1 ) implies ( a1 . c ) = ( a2 . c )))
proof
let c being set;
assume that
A28: c in ( dom a1 );
reconsider o = c as Ordinal by A26,A28;
A29: o1 c= ( o1 +^ o2 ) by ORDINAL3:24;
A30: ( ( ( o1 +^ o2 ) \ o1 ) \/ o1 ) = ( ( o1 +^ o2 ) \/ o1 ) by XBOOLE_1:39
.= ( o1 +^ o2 ) by A29,XBOOLE_1:12;
per cases  by A26,A28,A30,XBOOLE_0:def 3;
suppose A31: o in o1;

hence ( a1 . c ) = ( a . o ) by A24
.= ( a2 . c ) by A25,A31;
end;
suppose A32: o in ( ( o1 +^ o2 ) \ o1 );

hence ( a1 . c ) = ( b . ( o -^ o1 ) ) by A24
.= ( a2 . c ) by A25,A32;
end;
end;
( dom a1 ) = ( dom a2 ) by A26,PARTFUN1:def 2;
hence a1 = a2 by A27,FUNCT_1:2;
end;
end;
