environ
vocabularies NUMBERS,SUBSET_1,XBOOLE_0,XXREAL_0,NAT_1,ORDINAL1,CARD_1,TARSKI,ARYTM_3,ARYTM_1,FUNCT_1,RELAT_1,FUNCT_2,INT_1,FINSET_1,AFINSQ_1,BINOP_1,FINSEQ_1,FINSOP_1,CARD_3,BINOP_2,ZFMISC_1,NEWTON,REALSET1,STIRL2_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,RELAT_1,FUNCT_1,RELSET_1,ORDINAL1,SEQ_4,PARTFUN1,FINSET_1,AFINSQ_1,AFINSQ_2,XXREAL_0,FUNCT_2,NAT_1,INT_1,BINOP_1,BINOP_2,NEWTON,DOMAIN_1,CKB16,CKB17,CKB19,CKB32;
definitions TARSKI,XBOOLE_0,FUNCT_1,CKB19,CKB32;
theorems AFINSQ_1,TARSKI,FUNCT_1,XBOOLE_0,ZFMISC_1,RELAT_1,XBOOLE_1,NAT_1,FUNCT_2,AXIOMS,XCMPLX_1,CARD_2,INT_1,ORDINAL1,WELLORD2,FRAENKEL,SUBSET_1,ENUMSET1,CARD_1,BINOP_2,NEWTON,WSIERP_1,XREAL_1,XXREAL_0,XXREAL_2,AFINSQ_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55;
schemes FUNCT_2,NAT_1,INT_1,CKB29,CKB41,CKB42,CKB43,CKB56,CKB57;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCT_2,FINSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,MEMBERED,AFINSQ_1,CARD_1,VALUED_0,XXREAL_2,RELSET_1,AFINSQ_2,CKB9,CKB18;
constructors WELLORD2,DOMAIN_1,SETWISEO,REAL_1,BINOP_2,SEQ_4,NEWTON,AFINSQ_1,AFINSQ_2,RELSET_1,PARTFUN3,SEQ_1,BINOP_1,CKB16,CKB17,CKB19,CKB32;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve k for Nat;
reserve n for Nat;
reserve i for Nat;
reserve f for (Function of n,k);
reserve x for set;
theorem
Th55: ( k * ( n block k ) ) = ( card { f where f is (Function of ( n + 1 ),k): (f is  onto  "increasing & ( f " { ( f . n ) } ) <> { n }) } )
proof
now
per cases ;
suppose A1: k = ( 0 );

set F1 = { f where f is (Function of ( n + 1 ),k): f is  onto  "increasing };
set F = { f where f is (Function of ( n + 1 ),k): (f is  onto  "increasing & ( f " { ( f . n ) } ) <> { n }) };
A2: F c= F1
proof
let x;
assume x in F;
then (ex f being (Function of ( n + 1 ),k) st ((x = f & f is  onto  "increasing) & ( f " { ( f . n ) } ) <> { n }));
hence thesis;
end;
( card F1 ) = ( ( n + 1 ) block k );
then F1 is  empty by A1,CKB38:1;
hence thesis by A1,A2;
end;
suppose k > ( 0 );

then A3: k is non  empty;
set G1 = { g where g is (Function of ( n + 1 ),k): (g is  onto  "increasing & ( g " { ( g . n ) } ) <> { n }) };
defpred P[ set ]
 means
(ex f being (Function of ( n + 1 ),k) st ((f = $1 & f is  onto  "increasing) & ( f " { ( f . n ) } ) <> { n }));
n < ( n + 1 ) by NAT_1:13;
then A4: n in ( n + 1 ) by NAT_1:44;
( card k ),k are_equipotent  by CARD_1:def 2;
then consider f being Function such that A5: f is  one-to-one and A6: ( dom f ) = ( card k ) and A7: ( rng f ) = k by WELLORD2:def 4;
reconsider f as (Function of ( card k ),k) by A6,A7,FUNCT_2:1;
A8: f is  onto  one-to-one by A5,A7,FUNCT_2:def 3;
consider F being (XFinSequence of ( NAT )) such that A9: ( dom F ) = ( card k ) and A10: ( card { g where g is (Function of ( n + 1 ),k): P[ g ] } ) = ( Sum F ) and A11: (for i holds (i in ( dom F ) implies ( F . i ) = ( card { g where g is (Function of ( n + 1 ),k): (P[ g ] & ( g . n ) = ( f . i )) } ))) from CKB57:sch 1(A8,A3,A4);
A12: (for i being Nat holds (i in ( dom F ) implies ( F . i ) = ( n block k )))
proof
set F2 = { g where g is (Function of n,k): g is  onto  "increasing };
let i being Nat;
assume that
A13: i in ( dom F );
A14: ( f . i ) in ( rng f ) by A6,A9,A13,FUNCT_1:def 3;
k is (Subset of ( NAT )) by CKB8:1;
then reconsider fi = ( f . i ) as (Element of ( NAT )) by A7,A14;
A15: fi < k by A14,NAT_1:44;
set F1 = { g where g is (Function of ( n + 1 ),k): (P[ g ] & ( g . n ) = fi) };
set F = { g where g is (Function of ( n + 1 ),k): ((g is  onto  "increasing & ( g " { ( g . n ) } ) <> { n }) & ( g . n ) = fi) };
A16: F1 c= F
proof
let x;
assume x in F1;
then (ex g being (Function of ( n + 1 ),k) st ((x = g & P[ g ]) & ( g . n ) = fi));
hence thesis;
end;
F c= F1
proof
let x;
assume x in F;
then (ex g being (Function of ( n + 1 ),k) st (((x = g & g is  onto  "increasing) & ( g " { ( g . n ) } ) <> { n }) & ( g . n ) = fi));
hence thesis;
end;
then F = F1 by A16,XBOOLE_0:def 10;
then ( card F1 ) = ( card F2 ) by A15,CKB54:1;
hence thesis by A11,A13;
end;
then (for i being Nat holds (i in ( dom F ) implies ( F . i ) <= ( n block k )));
then A17: ( Sum F ) <= ( ( len F ) * ( n block k ) ) by AFINSQ_2:59;
set G = { g where g is (Function of ( n + 1 ),k): P[ g ] };
A18: G1 c= G
proof
let x;
assume x in G1;
then (ex g being (Function of ( n + 1 ),k) st ((x = g & g is  onto  "increasing) & ( g " { ( g . n ) } ) <> { n }));
hence thesis;
end;
A19: G c= G1
proof
let x;
assume x in G;
then (ex g being (Function of ( n + 1 ),k) st (x = g & P[ g ]));
hence thesis;
end;
(for i being Nat holds (i in ( dom F ) implies ( F . i ) >= ( n block k ))) by A12;
then A20: ( Sum F ) >= ( ( len F ) * ( n block k ) ) by AFINSQ_2:60;
( card k ) = k by CARD_1:def 2;
then ( Sum F ) = ( k * ( n block k ) ) by A9,A17,A20,XXREAL_0:1;
hence thesis by A10,A18,A19,XBOOLE_0:def 10;
end;
end;
hence thesis;
end;
