environ
vocabularies NUMBERS,FUNCT_1,RELAT_1,FUNCT_4,FUNCOP_1,XBOOLE_0,PRE_POLY,TARSKI,CARD_1,UPROOTS,CARD_3,ARYTM_3,FINSEQ_1,NAT_1,XXREAL_0,FINSET_1,SUBSET_1,FINSEQ_2,XREAL_0,ORDINAL1,ARYTM_1,GLIB_003,TREES_1,GLIB_000,GLIB_001,REAL_1,PBOOLE,ZFMISC_1,FUNCT_2,ABIAN,PARTFUN1,MCART_1,GLIB_002,WAYBEL_0,RELAT_2,RCOMP_1,GRAPH_1,GLIB_004;
notations TARSKI,XBOOLE_0,ZFMISC_1,ENUMSET1,CARD_1,NUMBERS,SUBSET_1,DOMAIN_1,MCART_1,XCMPLX_0,XXREAL_0,XREAL_0,REAL_1,RELAT_1,RELSET_1,PARTFUN1,FUNCT_1,FINSEQ_1,FINSEQ_2,SEQ_1,PBOOLE,FUNCT_2,RVSUM_1,ABIAN,ORDINAL1,UPROOTS,FINSET_1,NAT_1,FUNCOP_1,FUNCT_4,GLIB_000,GLIB_001,GLIB_002,GLIB_003,RFUNCT_3,PRE_POLY;
definitions TARSKI,GLIB_000,GLIB_003,RVSUM_1,FUNCOP_1;
theorems CARD_1,CARD_2,FUNCOP_1,ENUMSET1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSET_1,FUNCT_1,FUNCT_2,FUNCT_4,GLIB_000,GLIB_001,GLIB_002,GLIB_003,ABIAN,INT_1,JORDAN12,NAT_1,PARTFUN1,PBOOLE,RELAT_1,RVSUM_1,TARSKI,TREES_1,UPROOTS,XBOOLE_0,XBOOLE_1,XREAL_0,ZFMISC_1,XREAL_1,XXREAL_0,ORDINAL1,FINSOP_1,FUNCT_7,MCART_1,RELSET_1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10;
schemes NAT_1,SUBSET_1,RECDEF_1,GRAPH_5,CQC_SIM1,PBOOLE;
registrations XBOOLE_0,SUBSET_1,RELAT_1,PARTFUN1,FRAENKEL,FUNCT_1,ORDINAL1,FUNCOP_1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,CARD_1,UPROOTS,MEMBERED,GLIB_000,ABIAN,GLIB_001,GLIB_002,GLIB_003,VALUED_0,FUNCT_2,RELSET_1,PRE_POLY,INT_1;
constructors DOMAIN_1,BINOP_2,FINSOP_1,RVSUM_1,GRAPH_2,RFUNCT_3,UPROOTS,GLIB_002,GLIB_003,SEQ_1,XXREAL_2,RELSET_1,PBOOLE;
requirements ARITHM,BOOLE,NUMERALS,REAL,SUBSET;
begin
theorem
(for X,x being set holds (for b1,b2 being (Rbag of X) holds (for y being  real number holds (b2 = ( b1 +* ( x .--> y ) ) implies ( Sum b2 ) = ( ( ( Sum b1 ) + y ) - ( b1 . x ) )))))
proof
let X being set,x being set;
let b1 being (Rbag of X),b2 being (Rbag of X);
let y being  real number;
assume that
A1: b2 = ( b1 +* ( x .--> y ) );
(( dom ( x .--> y ) ) = { x } & ( dom b2 ) = ( ( dom b1 ) \/ ( dom ( x .--> y ) ) )) by A1,FUNCOP_1:13,FUNCT_4:def 1;
then { x } c= ( dom b2 ) by XBOOLE_1:7;
then { x } c= X by PARTFUN1:def 2;
then A2: x in X by ZFMISC_1:31;
set c = ( ( EmptyBag X ) +* ( x .--> y ) );
A3: ( dom c ) = ( ( dom ( EmptyBag X ) ) \/ ( dom ( x .--> y ) ) ) by FUNCT_4:def 1
.= ( X \/ ( dom ( x .--> y ) ) ) by PARTFUN1:def 2
.= ( X \/ { x } ) by FUNCOP_1:13
.= X by A2,ZFMISC_1:40;
set a = ( b1 +* ( x .--> ( 0 ) ) );
A4: ( dom a ) = ( ( dom b1 ) \/ ( dom ( x .--> ( 0 ) ) ) ) by FUNCT_4:def 1
.= ( X \/ ( dom ( x .--> ( 0 ) ) ) ) by PARTFUN1:def 2
.= ( X \/ { x } ) by FUNCOP_1:13
.= X by A2,ZFMISC_1:40;
set b = ( ( EmptyBag X ) +* ( x .--> ( b1 . x ) ) );
A5: ( dom b ) = ( ( dom ( EmptyBag X ) ) \/ ( dom ( x .--> ( b1 . x ) ) ) ) by FUNCT_4:def 1
.= ( X \/ ( dom ( x .--> ( b1 . x ) ) ) ) by PARTFUN1:def 2
.= ( X \/ { x } ) by FUNCOP_1:13
.= X by A2,ZFMISC_1:40;
( support b ) c= ( ( support ( EmptyBag X ) ) \/ { x } ) by CKB4:1;
then reconsider b as (Rbag of X) by A5,PARTFUN1:def 2,PRE_POLY:def 8,RELAT_1:def 18;
( support a ) c= ( ( support b1 ) \/ { x } ) by CKB4:1;
then reconsider a as (Rbag of X) by A4,PARTFUN1:def 2,PRE_POLY:def 8,RELAT_1:def 18;
( support c ) c= ( ( support ( EmptyBag X ) ) \/ { x } ) by CKB4:1;
then reconsider c as (Rbag of X) by A3,PARTFUN1:def 2,PRE_POLY:def 8,RELAT_1:def 18;
now
let i being set;
assume i in X;
A6: ( ( EmptyBag X ) . i ) = ( 0 ) by PRE_POLY:52;
per cases ;
suppose A7: i = x;

thus ( ( a + b ) . i ) = ( ( a . i ) + ( b . i ) ) by PRE_POLY:def 5
.= ( (( 0 ) qua Nat) + ( b . i ) ) by A7,FUNCT_7:94
.= ( b1 . i ) by A7,FUNCT_7:94;
end;
suppose A8: i <> x;

thus ( ( a + b ) . i ) = ( ( a . i ) + ( b . i ) ) by PRE_POLY:def 5
.= ( ( b1 . i ) + ( b . i ) ) by A8,FUNCT_4:83
.= ( ( b1 . i ) + (( 0 ) qua Nat) ) by A6,A8,FUNCT_4:83
.= ( b1 . i );
end;
end;
then A9: ( ( Sum b1 ) - ( Sum b ) ) = ( ( ( Sum a ) + ( Sum b ) ) - ( Sum b ) ) by PBOOLE:3,UPROOTS:15;
A10: (( Sum c ) = y & ( Sum b ) = ( b1 . x )) by CKB10:1;
now
let i being set;
assume i in X;
A11: ( ( EmptyBag X ) . i ) = ( 0 ) by PRE_POLY:52;
per cases ;
suppose A12: i = x;

hence ( b2 . i ) = y by A1,FUNCT_7:94
.= ( (( 0 ) qua Nat) + ( c . i ) ) by A12,FUNCT_7:94
.= ( ( a . i ) + ( c . i ) ) by A12,FUNCT_7:94
.= ( ( a + c ) . i ) by PRE_POLY:def 5;
end;
suppose A13: i <> x;

then A14: ( c . i ) = ( 0 ) by A11,FUNCT_4:83;
thus ( b2 . i ) = ( b1 . i ) by A1,A13,FUNCT_4:83
.= ( ( a . i ) + ( c . i ) ) by A13,A14,FUNCT_4:83
.= ( ( a + c ) . i ) by PRE_POLY:def 5;
end;
end;
hence ( Sum b2 ) = ( ( ( Sum b1 ) - ( Sum b ) ) + ( Sum c ) ) by A9,PBOOLE:3,UPROOTS:15
.= ( ( ( Sum b1 ) + y ) - ( b1 . x ) ) by A10;
end;
