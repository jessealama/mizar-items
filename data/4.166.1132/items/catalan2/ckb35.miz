environ
vocabularies NUMBERS,SUBSET_1,FUNCT_1,NAT_1,TARSKI,ORDINAL1,FINSET_1,RELAT_1,AFINSQ_1,ARYTM_1,ARYTM_3,FINSEQ_1,XXREAL_0,CARD_1,XBOOLE_0,ORDINAL4,CARD_3,FINSOP_1,FUNCOP_1,BINOP_2,FUNCT_2,XREAL_0,SEQ_1,SERIES_1,VALUED_1,SQUARE_1,COMPLEX1,PARTFUN3,ZFMISC_1,CARD_FIN,REALSET1,CATALAN1,REAL_1,ORDINAL2,SEQ_2,NEWTON,PREPOWER,FUNCT_3,CATALAN2;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,XREAL_0,NUMBERS,RELAT_1,FUNCT_1,REAL_1,NAT_1,FINSET_1,ORDINAL1,XXREAL_0,NAT_D,AFINSQ_1,SEQ_1,VALUED_1,RELSET_1,DOMAIN_1,FUNCT_2,FUNCOP_1,BINOP_1,BINOP_2,RECDEF_1,SERIES_1,PARTFUN3,AFINSQ_2,ZFMISC_1,SQUARE_1,NEWTON,STIRL2_1,CARD_FIN,CATALAN1,SEQ_2,PREPOWER,COMPLEX1,QUIN_1,CKB2,CKB26;
definitions TARSKI,XBOOLE_0,FUNCT_1,QUIN_1,SQUARE_1,CKB2,CKB26;
theorems CATALAN1,AFINSQ_1,TARSKI,XBOOLE_0,ZFMISC_1,RELAT_1,XBOOLE_1,NAT_1,FUNCT_2,XCMPLX_1,CARD_2,INT_1,ORDINAL1,WELLORD2,CARD_1,BINOP_2,NEWTON,XREAL_1,FUNCOP_1,STIRL2_1,FUNCT_1,CARD_FIN,SERIES_1,SEQ_1,SEQ_2,COMPLEX1,SQUARE_1,ABSVALUE,RSSPACE2,POWER,PREPOWER,WSIERP_1,FIB_NUM,TIETZE,XREAL_0,SERIES_2,XXREAL_0,NAT_D,AFINSQ_2,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB30,CKB31,CKB32,CKB33,CKB34;
schemes FUNCT_2,NAT_1,XBOOLE_0,STIRL2_1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCT_2,FUNCOP_1,FINSET_1,FRAENKEL,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,BINOP_2,CARD_1,AFINSQ_1,RELSET_1,VALUED_1,VALUED_0,MEMBERED,NEWTON,AFINSQ_2,CKB5,CKB8,CKB9,CKB29;
constructors QUIN_1,PREPOWER,SERIES_1,PARTFUN3,BINOM,WELLORD2,DOMAIN_1,SETWISEO,REAL_1,NAT_D,YELLOW20,RECDEF_1,BINOP_2,RELSET_1,ORDINAL4,SEQ_1,AFINSQ_1,SQUARE_1,CATALAN1,STIRL2_1,CARD_FIN,AFINSQ_2,ABIAN,SEQ_2,CKB2,CKB26;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve i for Nat;
reserve k for Nat;
reserve m for Nat;
reserve n for Nat;
reserve N for (Element of ( NAT ));
reserve p for (XFinSequence of ( NAT ));
reserve q for (XFinSequence of ( NAT ));
theorem
Th31: (( 2 * ( m + 1 ) ) <= n implies ( card ( ( Choose (n,( m + 1 ),1,( 0 )) ) \ ( Domin_0 (n,( m + 1 )) ) ) ) = ( card ( Choose (n,m,1,( 0 )) ) ))
proof
defpred P[ set,set ]
 means
(for p holds (for k holds (($1 = p & ( ( 2 * k ) + 1 ) = ( min* { N: ( 2 * ( Sum ( p | N ) ) ) > N } )) implies (ex r1,r2 being (XFinSequence of ( NAT )) st (((($2 = ( r1 ^ r2 ) & ( len r1 ) = ( ( 2 * k ) + 1 )) & ( len r1 ) = ( len ( p | ( ( 2 * k ) + 1 ) ) )) & p = ( ( p | ( ( 2 * k ) + 1 ) ) ^ r2 )) & (for o being Nat holds (o < ( ( 2 * k ) + 1 ) implies ( r1 . o ) = ( 1 - ( p . o ) ))))))));
assume A1: ( 2 * ( m + 1 ) ) <= n;
A2: ( card n ) = n by CARD_1:def 2;
A3: m <= ( m + m ) by XREAL_1:31;
m <= ( m + 1 ) by NAT_1:13;
then ( 2 * m ) <= ( 2 * ( m + 1 ) ) by XREAL_1:64;
then ( 2 * m ) <= n by A1,XXREAL_0:2;
then m <= n by A3,XXREAL_0:2;
then ( ( card n ) choose m ) > ( 0 ) by A2,CKB34:1;
then reconsider W = ( Choose (n,m,1,( 0 )) ) as non empty  finite set by CARD_1:27,CARD_FIN:16;
set Z = ( Domin_0 (n,( m + 1 )) );
set CH = ( Choose (n,( m + 1 ),1,( 0 )) );
A4: (for x holds (x in ( CH \ Z ) implies (ex y st (y in W & P[ x,y ]))))
proof
let x;
assume that
A5: x in ( CH \ Z );
x in CH by A5,XBOOLE_0:def 5;
then consider p being (XFinSequence of ( NAT )) such that A6: p = x and A7: ( dom p ) = n and A8: ( rng p ) c= { ( 0 ),1 } and A9: ( Sum p ) = ( m + 1 ) by CARD_FIN:40;
(not p in Z) by A5,A6,XBOOLE_0:def 5;
then (not p is  dominated_by_0) by A7,A9,CKB26:def 1;
then consider o being Nat such that A10: (((( ( 2 * o ) + 1 ) = ( min* { N: ( 2 * ( Sum ( p | N ) ) ) > N } ) & ( ( 2 * o ) + 1 ) <= ( dom p )) & o = ( Sum ( p | ( 2 * o ) ) )) & ( p . ( 2 * o ) ) = 1) by A8,CKB21:1;
set q = ( p | ( ( 2 * o ) + 1 ) );
consider r2 being (XFinSequence of ( NAT )) such that A11: p = ( q ^ r2 ) by CKB1:1;
( rng q ) c= ( rng p ) by RELAT_1:70;
then ( rng q ) c= { ( 0 ),1 } by A8,XBOOLE_1:1;
then consider r1 being (XFinSequence of ( NAT )) such that A12: ( len q ) = ( len r1 ) and A13: ( rng r1 ) c= { ( 0 ),1 } and A14: (for i holds (i <= ( len q ) implies ( ( Sum ( q | i ) ) + ( Sum ( r1 | i ) ) ) = ( 1 * i ))) and A15: (for i holds (i in ( len q ) implies ( r1 . i ) = ( 1 - ( q . i ) ))) by CKB33:1;
take R = ( r1 ^ r2 );
( len p ) = ( ( len r1 ) + ( len r2 ) ) by A12,A11,AFINSQ_1:17;
then A16: ( dom R ) = n by A7,AFINSQ_1:def 3;
( rng r2 ) c= ( rng p ) by A11,AFINSQ_1:25;
then ( rng r2 ) c= { ( 0 ),1 } by A8,XBOOLE_1:1;
then ( ( rng r1 ) \/ ( rng r2 ) ) c= { ( 0 ),1 } by A13,XBOOLE_1:8;
then A17: ( rng R ) c= { ( 0 ),1 } by AFINSQ_1:26;
(( q | ( dom q ) ) = q & ( r1 | ( dom r1 ) ) = r1) by RELAT_1:69;
then A18: ( ( Sum q ) + ( Sum r1 ) ) = ( 1 * ( len q ) ) by A12,A14;
A19: ( 2 * o ) < ( ( 2 * o ) + 1 ) by NAT_1:13;
then ( 2 * o ) c= ( ( 2 * o ) + 1 ) by NAT_1:39;
then A20: ( q | ( 2 * o ) ) = ( p | ( 2 * o ) ) by RELAT_1:74;
A21: ( ( 2 * o ) + 1 ) c= ( dom p ) by A10,NAT_1:39;
then A22: ( dom q ) = ( ( 2 * o ) + 1 ) by RELAT_1:62;
A23: ( len q ) = ( ( 2 * o ) + 1 ) by A21,RELAT_1:62;
then A24: q = ( ( q | ( 2 * o ) ) ^ <% ( q . ( 2 * o ) ) %> ) by AFINSQ_1:56;
( 2 * o ) in ( ( 2 * o ) + 1 ) by A19,NAT_1:44;
then ( q . ( 2 * o ) ) = ( p . ( 2 * o ) ) by A23,FUNCT_1:47;
then ( Sum q ) = ( ( Sum ( p | ( 2 * o ) ) ) + ( Sum <% ( p . ( 2 * o ) ) %> ) ) by A24,A20,AFINSQ_2:55;
then A25: ( Sum q ) = ( o + 1 ) by A10,AFINSQ_2:53;
( m + 1 ) = ( ( Sum q ) + ( Sum r2 ) ) by A9,A11,AFINSQ_2:55;
then ( ( Sum r1 ) + ( Sum r2 ) ) = ( ( ( m + 1 ) - ( ( 2 * o ) + 1 ) ) + ( 2 * o ) ) by A18,A22,A25;
then ( Sum ( r1 ^ r2 ) ) = m by AFINSQ_2:55;
hence R in W by A16,A17,CARD_FIN:40;
thus P[ x,R ]
proof
let p9 being (XFinSequence of ( NAT ));
let k;
assume that
A26: (x = p9 & ( ( 2 * k ) + 1 ) = ( min* { N: ( 2 * ( Sum ( p9 | N ) ) ) > N } ));
set q9 = ( p9 | ( ( 2 * k ) + 1 ) );
take r1;
take r2;
thus (((R = ( r1 ^ r2 ) & ( len r1 ) = ( ( 2 * k ) + 1 )) & ( len r1 ) = ( len q9 )) & p9 = ( q9 ^ r2 )) by A6,A10,A12,A11,A21,A26,RELAT_1:62;
thus (for i being Nat holds (i < ( ( 2 * k ) + 1 ) implies ( r1 . i ) = ( 1 - ( p9 . i ) )))
proof
let i being Nat;
assume i < ( ( 2 * k ) + 1 );
then A27: i in ( len q ) by A6,A10,A22,A26,NAT_1:44;
then ( r1 . i ) = ( 1 - ( q . i ) ) by A15;
hence thesis by A6,A26,A27,FUNCT_1:47;
end;

end;

end;
consider F being (Function of ( CH \ Z ),W) such that A28: (for x holds (x in ( CH \ Z ) implies P[ x,( F . x ) ])) from FUNCT_2:sch 1(A4);
W c= ( rng F )
proof
let x;
assume x in W;
then consider p such that A29: p = x and A30: ( dom p ) = n and A31: ( rng p ) c= { ( 0 ),1 } and A32: ( Sum p ) = m by CARD_FIN:40;
set M = { N: ( 2 * ( Sum ( p | N ) ) ) < N };
m < ( m + 1 ) by NAT_1:13;
then ( 2 * m ) < ( 2 * ( m + 1 ) ) by XREAL_1:68;
then ( 2 * m ) < n by A1,XXREAL_0:2;
then (( 2 * ( Sum ( p | n ) ) ) < n & n in ( NAT )) by A30,A32,ORDINAL1:def 12,RELAT_1:69;
then A33: n in M;
M c= ( NAT )
proof
let y;
assume y in M;
then (ex i being (Element of ( NAT )) st (i = y & ( 2 * ( Sum ( p | i ) ) ) < i));
hence thesis;
end;
then reconsider M as non empty (Subset of ( NAT )) by A33;
(ex k st ((( ( 2 * k ) + 1 ) = ( min* M ) & ( Sum ( p | ( ( 2 * k ) + 1 ) ) ) = k) & ( ( 2 * k ) + 1 ) <= ( dom p )))
proof
set mm = ( min* M );
mm in M by NAT_1:def 1;
then A34: (ex o being (Element of ( NAT )) st (mm = o & ( 2 * ( Sum ( p | o ) ) ) < o));
then reconsider m1 = ( mm - 1 ) as (Element of ( NAT )) by NAT_1:20;
A35: ( 2 * ( Sum ( p | mm ) ) ) < ( m1 + 1 ) by A34;
A36: m1 < ( m1 + 1 ) by NAT_1:13;
then m1 c= mm by NAT_1:39;
then A37: ( ( p | mm ) | m1 ) = ( p | m1 ) by RELAT_1:74;
mm <= ( dom p ) by A30,A33,NAT_1:def 1;
then A38: mm c= ( dom p ) by NAT_1:39;
then ( dom ( p | mm ) ) = mm by RELAT_1:62;
then m1 in ( dom ( p | mm ) ) by A36,NAT_1:44;
then A39: ( ( p | mm ) . m1 ) = ( p . m1 ) by FUNCT_1:47;
m1 < ( m1 + 1 ) by NAT_1:13;
then (not m1 in M) by NAT_1:def 1;
then ( 2 * ( Sum ( p | m1 ) ) ) >= m1;
then A40: (( Sum <% ( p . m1 ) %> ) = ( p . m1 ) & ( ( 2 * ( Sum ( p | m1 ) ) ) + ( 2 * ( p . m1 ) ) ) >= ( m1 + ( 0 ) )) by AFINSQ_2:53,XREAL_1:7;
reconsider S = ( Sum ( p | mm ) ) as (Element of ( NAT )) by ORDINAL1:def 12;
take S;
A41: mm <= ( dom p ) by A30,A33,NAT_1:def 1;
( len ( p | mm ) ) = ( m1 + 1 ) by A38,RELAT_1:62;
then ( p | mm ) = ( ( ( p | mm ) | m1 ) ^ <% ( ( p | mm ) . m1 ) %> ) by AFINSQ_1:56;
then ( Sum ( p | mm ) ) = ( ( Sum ( p | m1 ) ) + ( Sum <% ( p . m1 ) %> ) ) by A39,A37,AFINSQ_2:55;
hence thesis by A41,A40,A35,NAT_1:9;
end;
then consider k such that A42: ( ( 2 * k ) + 1 ) = ( min* M ) and A43: ( Sum ( p | ( ( 2 * k ) + 1 ) ) ) = k and A44: ( ( 2 * k ) + 1 ) <= ( dom p );
set k1 = ( ( 2 * k ) + 1 );
consider q such that A45: p = ( ( p | k1 ) ^ q ) by CKB1:1;
( rng ( p | k1 ) ) c= ( rng p ) by RELAT_1:70;
then ( rng ( p | k1 ) ) c= { ( 0 ),1 } by A31,XBOOLE_1:1;
then consider r being (XFinSequence of ( NAT )) such that A46: ( len r ) = ( len ( p | k1 ) ) and A47: ( rng r ) c= { ( 0 ),1 } and A48: (for i holds (i <= ( len ( p | k1 ) ) implies ( ( Sum ( ( p | k1 ) | i ) ) + ( Sum ( r | i ) ) ) = ( 1 * i ))) and A49: (for i holds (i in ( len ( p | k1 ) ) implies ( r . i ) = ( 1 - ( ( p | k1 ) . i ) ))) by CKB33:1;
set rq = ( r ^ q );
A50: ( dom rq ) = ( ( len ( p | k1 ) ) + ( len q ) ) by A46,AFINSQ_1:def 3;
A51: m = ( k + ( Sum q ) ) by A32,A43,A45,AFINSQ_2:55;
( dom rq ) = ( ( len ( p | k1 ) ) + ( len q ) ) by A46,AFINSQ_1:def 3;
then A52: ( dom rq ) = ( dom p ) by A45,AFINSQ_1:def 3;
(( ( p | k1 ) | ( dom ( p | k1 ) ) ) = ( p | k1 ) & ( r | ( dom r ) ) = r) by RELAT_1:69;
then A53: ( ( Sum ( p | k1 ) ) + ( Sum r ) ) = ( 1 * ( len ( p | k1 ) ) ) by A46,A48;
( rng q ) c= ( rng p ) by A45,AFINSQ_1:25;
then ( rng q ) c= { ( 0 ),1 } by A31,XBOOLE_1:1;
then ( ( rng r ) \/ ( rng q ) ) c= { ( 0 ),1 } by A47,XBOOLE_1:8;
then A54: ( rng rq ) c= { ( 0 ),1 } by AFINSQ_1:26;
A55: k1 c= ( dom p ) by A44,NAT_1:39;
then A56: ( len ( p | k1 ) ) = k1 by RELAT_1:62;
then A57: ( ( r ^ q ) | k1 ) = r by A46,AFINSQ_1:57;
A58: ( k1 + 1 ) > k1 by NAT_1:13;
then A59: k1 < ( 2 * ( Sum r ) ) by A43,A53,A56;
A60: ( 2 * ( Sum r ) ) > k1 by A43,A53,A56,A58;
then consider j being Nat such that A61: (((( ( 2 * j ) + 1 ) = ( min* { N: ( 2 * ( Sum ( rq | N ) ) ) > N } ) & ( ( 2 * j ) + 1 ) <= ( dom rq )) & j = ( Sum ( rq | ( 2 * j ) ) )) & ( rq . ( 2 * j ) ) = 1) by A54,A57,CKB3:1,CKB21:1;
set j1 = ( ( 2 * j ) + 1 );
A62: ( len ( ( p | k1 ) ^ q ) ) = ( ( len ( p | k1 ) ) + ( len q ) ) by AFINSQ_1:def 3;
(not rq is  dominated_by_0) by A60,A57,CKB3:1;
then A63: (not rq in Z) by CKB27:1;
set rqj = ( rq | ( ( 2 * j ) + 1 ) );
( Sum rq ) = ( ( Sum r ) + ( Sum q ) ) by AFINSQ_2:55;
then rq in CH by A30,A43,A53,A56,A52,A54,A51,CARD_FIN:40;
then A64: rq in ( CH \ Z ) by A63,XBOOLE_0:def 5;
then consider r1 being (XFinSequence of ( NAT )),r2 being (XFinSequence of ( NAT )) such that A65: ( F . rq ) = ( r1 ^ r2 ) and A66: ( len r1 ) = j1 and A67: (( len r1 ) = ( len rqj ) & rq = ( rqj ^ r2 )) and A68: (for i being Nat holds (i < j1 implies ( r1 . i ) = ( 1 - ( rq . i ) ))) by A28,A61;
A69: ( dom rq ) = ( ( len r1 ) + ( len r2 ) ) by A67,AFINSQ_1:def 3;
then A70: ( len ( r1 ^ r2 ) ) = ( len ( ( p | k1 ) ^ q ) ) by A50,A62,AFINSQ_1:17;
reconsider K = { N: ( 2 * ( Sum ( rq | N ) ) ) > N } as non empty (Subset of ( NAT )) by A61,NAT_1:def 1;
( rq | k1 ) = r by A46,A56,AFINSQ_1:57;
then k1 in K by A59;
then A71: k1 >= j1 by A61,NAT_1:def 1;
then j1 c= k1 by NAT_1:39;
then A72: ( ( p | k1 ) | j1 ) = ( p | j1 ) by RELAT_1:74;
j1 in K by A61,NAT_1:def 1;
then A73: (ex N st (N = j1 & ( 2 * ( Sum ( rq | N ) ) ) > N));
( ( Sum ( ( p | k1 ) | j1 ) ) + ( Sum ( r | j1 ) ) ) = ( j1 * 1 ) by A48,A56,A71;
then ( 2 * ( Sum ( r | j1 ) ) ) = ( ( 2 * j1 ) - ( 2 * ( Sum ( p | j1 ) ) ) ) by A72;
then ( j1 + ( j1 - ( 2 * ( Sum ( p | j1 ) ) ) ) ) > ( ( 2 * ( Sum ( p | j1 ) ) ) + ( j1 - ( 2 * ( Sum ( p | j1 ) ) ) ) ) by A46,A56,A71,A73,AFINSQ_1:58;
then j1 > ( 2 * ( Sum ( p | j1 ) ) ) by XREAL_1:6;
then j1 in M;
then j1 >= k1 by A42,NAT_1:def 1;
then A74: j1 = k1 by A71,XXREAL_0:1;
A75: ( len ( ( p | k1 ) ^ q ) ) = ( len rq ) by A50,AFINSQ_1:def 3;
now
let i being Nat;
assume that
A76: i < ( len ( r1 ^ r2 ) );
now
per cases ;
suppose A77: i < ( len r1 );

then A78: (i in ( dom r1 ) & ( r1 . i ) = ( 1 - ( rq . i ) )) by A66,A68,NAT_1:44;
A79: i in ( len r1 ) by A77,NAT_1:44;
A80: (( len r1 ) = ( len ( p | k1 ) ) & i in ( NAT )) by A55,A66,A74,ORDINAL1:def 12,RELAT_1:62;
then A81: ( r . i ) = ( 1 - ( ( p | k1 ) . i ) ) by A49,A79;
(( ( ( p | k1 ) ^ q ) . i ) = ( ( p | k1 ) . i ) & ( rq . i ) = ( r . i )) by A46,A79,A80,AFINSQ_1:def 3;
hence ( ( r1 ^ r2 ) . i ) = ( ( ( p | k1 ) ^ q ) . i ) by A81,A78,AFINSQ_1:def 3;
end;
suppose A82: i >= ( len r1 );

then A83: ( ( ( p | k1 ) ^ q ) . i ) = ( q . ( i - ( len r ) ) ) by A46,A56,A66,A74,A70,A76,AFINSQ_1:19;
(( ( r1 ^ r2 ) . i ) = ( r2 . ( i - ( len r1 ) ) ) & ( rq . i ) = ( q . ( i - ( len r ) ) )) by A46,A56,A66,A74,A70,A75,A76,A82,AFINSQ_1:19;
hence ( ( r1 ^ r2 ) . i ) = ( ( ( p | k1 ) ^ q ) . i ) by A67,A70,A75,A76,A82,A83,AFINSQ_1:19;
end;
end;
hence ( ( r1 ^ r2 ) . i ) = ( ( ( p | k1 ) ^ q ) . i );
end;
then A84: ( r1 ^ r2 ) = ( ( p | k1 ) ^ q ) by A69,A50,A62,AFINSQ_1:9,AFINSQ_1:17;
rq in ( dom F ) by A64,FUNCT_2:def 1;
hence thesis by A29,A45,A65,A84,FUNCT_1:3;
end;
then A85: ( rng F ) = W by XBOOLE_0:def 10;
A86: F is  one-to-one
proof
let x;
let y;
assume that
A87: x in ( dom F )
and
A88: y in ( dom F )
and
A89: ( F . x ) = ( F . y );
x in CH by A87,XBOOLE_0:def 5;
then consider p such that A90: p = x and A91: ( dom p ) = n and A92: ( rng p ) c= { ( 0 ),1 } and A93: ( Sum p ) = ( m + 1 ) by CARD_FIN:40;
(not p in Z) by A87,A90,XBOOLE_0:def 5;
then (not p is  dominated_by_0) by A91,A93,CKB26:def 1;
then consider k1 being Nat such that A94: (((( ( 2 * k1 ) + 1 ) = ( min* { N: ( 2 * ( Sum ( p | N ) ) ) > N } ) & ( ( 2 * k1 ) + 1 ) <= ( dom p )) & k1 = ( Sum ( p | ( 2 * k1 ) ) )) & ( p . ( 2 * k1 ) ) = 1) by A92,CKB21:1;
y in CH by A88,XBOOLE_0:def 5;
then consider q such that A95: q = y and A96: ( dom q ) = n and A97: ( rng q ) c= { ( 0 ),1 } and A98: ( Sum q ) = ( m + 1 ) by CARD_FIN:40;
(not q in Z) by A88,A95,XBOOLE_0:def 5;
then (not q is  dominated_by_0) by A96,A98,CKB26:def 1;
then consider k2 being Nat such that A99: (((( ( 2 * k2 ) + 1 ) = ( min* { N: ( 2 * ( Sum ( q | N ) ) ) > N } ) & ( ( 2 * k2 ) + 1 ) <= ( dom q )) & k2 = ( Sum ( q | ( 2 * k2 ) ) )) & ( q . ( 2 * k2 ) ) = 1) by A97,CKB21:1;
A100: ( len q ) = n by A96;
reconsider M = { N: ( 2 * ( Sum ( q | N ) ) ) > N } as non empty (Subset of ( NAT )) by A99,NAT_1:def 1;
set qk = ( q | ( ( 2 * k2 ) + 1 ) );
consider s1 being (XFinSequence of ( NAT )),s2 being (XFinSequence of ( NAT )) such that A101: ( F . y ) = ( s1 ^ s2 ) and A102: ( len s1 ) = ( ( 2 * k2 ) + 1 ) and A103: ( len s1 ) = ( len qk ) and A104: q = ( qk ^ s2 ) and A105: (for i being Nat holds (i < ( ( 2 * k2 ) + 1 ) implies ( s1 . i ) = ( 1 - ( q . i ) ))) by A28,A88,A95,A99;
A106: ( len q ) = ( ( len qk ) + ( len s2 ) ) by A104,AFINSQ_1:17;
then A107: ( len q ) = ( len ( s1 ^ s2 ) ) by A103,AFINSQ_1:17;
reconsider K = { N: ( 2 * ( Sum ( p | N ) ) ) > N } as non empty (Subset of ( NAT )) by A94,NAT_1:def 1;
set pk = ( p | ( ( 2 * k1 ) + 1 ) );
consider r1 being (XFinSequence of ( NAT )),r2 being (XFinSequence of ( NAT )) such that A108: ( F . x ) = ( r1 ^ r2 ) and A109: ( len r1 ) = ( ( 2 * k1 ) + 1 ) and A110: ( len r1 ) = ( len ( p | ( ( 2 * k1 ) + 1 ) ) ) and A111: p = ( ( p | ( ( 2 * k1 ) + 1 ) ) ^ r2 ) and A112: (for i being Nat holds (i < ( ( 2 * k1 ) + 1 ) implies ( r1 . i ) = ( 1 - ( p . i ) ))) by A28,A87,A90,A94;
assume x <> y;
then consider i being Nat such that A113: i < ( len p ) and A114: ( p . i ) <> ( q . i ) by A90,A91,A95,A96,A106,AFINSQ_1:9;
A115: ( len p ) = ( ( len pk ) + ( len r2 ) ) by A111,AFINSQ_1:17;
then A116: ( len p ) = ( len ( r1 ^ r2 ) ) by A110,AFINSQ_1:17;
now
per cases  by XXREAL_0:1;
suppose A117: k1 = k2;

now
per cases ;
suppose A118: i < ( len pk );

then i in ( len pk ) by NAT_1:44;
then A119: (( r1 . i ) = ( ( r1 ^ r2 ) . i ) & ( s1 . i ) = ( ( s1 ^ s2 ) . i )) by A109,A110,A102,A117,AFINSQ_1:def 3;
(( r1 . i ) = ( 1 - ( p . i ) ) & ( s1 . i ) = ( 1 - ( q . i ) )) by A109,A110,A112,A105,A117,A118;
hence contradiction by A89,A108,A101,A114,A119;
end;
suppose A120: i >= ( len pk );

then A121: ( ( s1 ^ s2 ) . i ) = ( s2 . ( i - ( len pk ) ) ) by A91,A109,A110,A96,A102,A107,A113,A117,AFINSQ_1:19;
(( p . i ) = ( r2 . ( i - ( len pk ) ) ) & ( q . i ) = ( s2 . ( i - ( len pk ) ) )) by A91,A109,A110,A111,A102,A103,A104,A100,A113,A117,A120,AFINSQ_1:19;
hence contradiction by A89,A108,A110,A101,A116,A113,A114,A120,A121,AFINSQ_1:19;
end;
end;
hence contradiction;
end;
suppose A122: k1 > k2;

( len s1 ) <= ( len p ) by A91,A96,A103,A106,NAT_1:11;
then A123: ( len s1 ) c= ( dom p ) by NAT_1:39;
( 2 * k2 ) < ( 2 * k1 ) by A122,XREAL_1:68;
then A124: ( len s1 ) < ( len r1 ) by A109,A102,XREAL_1:6;
then ( ( s1 ^ s2 ) | ( len s1 ) ) = ( r1 | ( len s1 ) ) by A89,A108,A101,AFINSQ_1:58;
then A125: s1 = ( r1 | ( len s1 ) ) by AFINSQ_1:57;
A126: (for k being Nat holds (k < ( len qk ) implies ( qk . k ) = ( ( p | ( len qk ) ) . k )))
proof
let k being Nat;
assume that
A127: k < ( len qk );
A128: k in ( len s1 ) by A103,A127,NAT_1:44;
then A129: k in ( ( dom q ) /\ ( len s1 ) ) by A91,A96,A123,XBOOLE_0:def 4;
k in ( ( dom p ) /\ ( len s1 ) ) by A123,A128,XBOOLE_0:def 4;
then A130: ( p . k ) = ( ( p | ( len qk ) ) . k ) by A103,FUNCT_1:48;
A131: k < ( len r1 ) by A103,A124,A127,XXREAL_0:2;
then A132: ( r1 . k ) = ( 1 - ( p . k ) ) by A109,A112;
k in ( dom r1 ) by A131,NAT_1:44;
then k in ( ( dom r1 ) /\ ( len s1 ) ) by A128,XBOOLE_0:def 4;
then A133: ( r1 . k ) = ( ( r1 | ( len s1 ) ) . k ) by FUNCT_1:48;
( s1 . k ) = ( 1 - ( q . k ) ) by A102,A103,A105,A127;
hence thesis by A102,A125,A132,A133,A129,A130,FUNCT_1:48;
end;
( ( 2 * k2 ) + 1 ) in M by A99,NAT_1:def 1;
then A134: (ex N st (( ( 2 * k2 ) + 1 ) = N & ( 2 * ( Sum ( q | N ) ) ) > N));
( len qk ) = ( len ( p | ( len qk ) ) ) by A103,A123,RELAT_1:62;
then qk = ( p | ( len qk ) ) by A126,AFINSQ_1:9;
then ( len qk ) in K by A102,A103,A134;
hence contradiction by A94,A109,A103,A124,NAT_1:def 1;
end;
suppose A135: k1 < k2;

( len r1 ) <= ( len q ) by A91,A110,A96,A115,NAT_1:11;
then A136: ( len r1 ) c= ( dom q ) by NAT_1:39;
( 2 * k1 ) < ( 2 * k2 ) by A135,XREAL_1:68;
then A137: ( len r1 ) < ( len s1 ) by A109,A102,XREAL_1:6;
then ( ( r1 ^ r2 ) | ( len r1 ) ) = ( s1 | ( len r1 ) ) by A89,A108,A101,AFINSQ_1:58;
then A138: r1 = ( s1 | ( len r1 ) ) by AFINSQ_1:57;
A139: (for k being Nat holds (k < ( len pk ) implies ( pk . k ) = ( ( q | ( len pk ) ) . k )))
proof
let k being Nat;
assume that
A140: k < ( len pk );
A141: k in ( len r1 ) by A110,A140,NAT_1:44;
then A142: k in ( ( dom p ) /\ ( len r1 ) ) by A91,A96,A136,XBOOLE_0:def 4;
k in ( ( dom q ) /\ ( len r1 ) ) by A136,A141,XBOOLE_0:def 4;
then A143: ( q . k ) = ( ( q | ( len pk ) ) . k ) by A110,FUNCT_1:48;
A144: k < ( len s1 ) by A110,A137,A140,XXREAL_0:2;
then A145: ( s1 . k ) = ( 1 - ( q . k ) ) by A102,A105;
k in ( dom s1 ) by A144,NAT_1:44;
then k in ( ( dom s1 ) /\ ( len r1 ) ) by A141,XBOOLE_0:def 4;
then A146: ( s1 . k ) = ( ( s1 | ( len r1 ) ) . k ) by FUNCT_1:48;
( r1 . k ) = ( 1 - ( p . k ) ) by A109,A110,A112,A140;
hence thesis by A109,A138,A145,A146,A142,A143,FUNCT_1:48;
end;
( ( 2 * k1 ) + 1 ) in K by A94,NAT_1:def 1;
then A147: (ex N st (( ( 2 * k1 ) + 1 ) = N & ( 2 * ( Sum ( p | N ) ) ) > N));
( len pk ) = ( len ( q | ( len pk ) ) ) by A110,A136,RELAT_1:62;
then pk = ( q | ( len pk ) ) by A139,AFINSQ_1:9;
then ( len pk ) in M by A109,A110,A147;
hence contradiction by A110,A99,A102,A137,NAT_1:def 1;
end;
end;
hence contradiction;
end;
( dom F ) = ( CH \ Z ) by FUNCT_2:def 1;
then ( CH \ Z ),W are_equipotent  by A86,A85,WELLORD2:def 4;
hence thesis by CARD_1:5;
end;
