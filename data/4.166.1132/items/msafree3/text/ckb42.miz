environ
vocabularies XBOOLE_0,STRUCT_0,MSUALG_1,CARD_3,RELAT_1,FUNCT_1,SUBSET_1,PBOOLE,MSUALG_3,TARSKI,FUNCT_6,MEMBER_1,CATALG_1,ZF_MODEL,MSUALG_2,MSAFREE,FUNCOP_1,CARD_1,LANG1,ZFMISC_1,TREES_4,MCART_1,MARGREL1,FINSEQ_1,MSATERM,UNIALG_2,DTCONSTR,FINSET_1,TREES_2,TREES_9,ZF_LANG1,TREES_3,TREES_A,NUMBERS,ARYTM_3,ORDINAL4,XXREAL_0,NAT_1,PARTFUN1,MSUALG_6,PRELAMB;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,DOMAIN_1,RELAT_1,FUNCT_1,RELSET_1,STRUCT_0,NUMBERS,NAT_1,MCART_1,FINSET_1,CARD_3,FINSEQ_1,FINSEQ_2,TREES_1,TREES_2,FUNCT_6,TREES_3,TREES_4,DTCONSTR,LANG1,PBOOLE,TREES_9,MSUALG_1,MSUALG_2,MSAFREE,FUNCOP_1,MSUALG_3,EQUATION,MSATERM,MSUALG_6,CATALG_1,XXREAL_0,CKB2,CKB4,CKB17,CKB18,CKB25,CKB27;
definitions TARSKI,XBOOLE_0,PBOOLE,MSUALG_2,MSUALG_6,CATALG_1,CKB4,CKB17,CKB18,CKB25,CKB27;
theorems TARSKI,ZFMISC_1,FUNCT_1,FUNCT_2,FINSEQ_1,FINSEQ_3,NAT_1,MCART_1,PBOOLE,RELAT_1,CARD_3,CARD_5,FUNCT_6,TREES_3,MSUALG_1,INSTALG1,TREES_4,PRE_CIRC,TREES_1,TREES_2,MSUALG_2,MSUALG_3,MSAFREE,MSATERM,EQUATION,MSUALG_6,XBOOLE_0,XBOOLE_1,ORDINAL1,PARTFUN1,TREES_9,FINSEQ_2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41;
schemes PBOOLE,MSATERM;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCOP_1,XREAL_0,FINSEQ_1,TREES_2,TREES_3,TREES_9,STRUCT_0,RELSET_1,MSUALG_1,MSUALG_2,MSUALG_3,MSAFREE,MSATERM,INDEX_1,MSUALG_6,MSUALG_9,INSTALG1,CATALG_1,PRE_CIRC,MSSUBFAM,PBOOLE,CKB1,CKB9,CKB13,CKB14,CKB15,CKB16;
constructors DOMAIN_1,XXREAL_0,NAT_1,TREES_9,MSSUBFAM,MSUALG_3,MSATERM,MSUALG_6,CATALG_1,EQUATION,SEQ_4,RELSET_1,FINSEQ_2,CKB4,CKB17,CKB18,CKB25,CKB27;
requirements BOOLE,SUBSET,NUMERALS;
begin
reserve x for set;
reserve y for set;
theorem
Th31: (for S being non void Signature holds (for X,Y being  non-empty (ManySortedSet of (the carrier of S)) holds (for t being (Term of S,Y) holds (( variables_in t ) c= X implies t is (Term of S,X)))))
proof
let S being non void Signature;
let X being  non-empty (ManySortedSet of (the carrier of S)),Y being  non-empty (ManySortedSet of (the carrier of S));
defpred P[ DecoratedTree ]
 means
(( Y variables_in $1 ) c= X implies $1 is (Term of S,X));
let t being (Term of S,Y);
A1: (for o being (OperSymbol of S) holds (for p being (ArgumentSeq of ( Sym (o,Y) )) holds ((for t being (Term of S,Y) holds (t in ( rng p ) implies P[ t ])) implies P[ ( [ o,(the carrier of S) ] -tree p ) ])))
proof
let o being (OperSymbol of S);
let p being (ArgumentSeq of ( Sym (o,Y) ));
assume that
A2: (for t being (Term of S,Y) holds ((t in ( rng p ) & ( Y variables_in t ) c= X) implies t is (Term of S,X)))
and
A3: ( Y variables_in ( [ o,(the carrier of S) ] -tree p ) ) c= X;
A4:now
let i being Nat;
assume A5: i in ( dom p );
then reconsider t = ( p . i ) as (Term of S,Y) by MSATERM:22;
A6: t in ( rng p ) by A5,FUNCT_1:def 3;
( Y variables_in t ) c= X
proof
let y;
assume y in (the carrier of S);
then reconsider s = y as (SortSymbol of S);
let x;
assume x in ( ( Y variables_in t ) . y );
then A7: x in ( ( Y variables_in ( [ o,(the carrier of S) ] -tree p ) ) . s ) by A6,CKB23:1;
( ( Y variables_in ( [ o,(the carrier of S) ] -tree p ) ) . s ) c= ( X . s ) by A3,PBOOLE:def 2;
hence thesis by A7;
end;
then reconsider t9 = t as (Term of S,X) by A2,A6;
take t9;
thus t9 = ( p . i );
( the_sort_of t ) = ( ( the_arity_of o ) . i ) by A5,MSATERM:23;
hence ( the_sort_of t9 ) = ( ( the_arity_of o ) . i ) by CKB41:1;
end;
( len p ) = ( len ( the_arity_of o ) ) by MSATERM:22;
then reconsider p as (ArgumentSeq of ( Sym (o,X) )) by A4,MSATERM:24;
( ( Sym (o,X) ) -tree p ) is (Term of S,X);
hence thesis by MSAFREE:def 9;
end;
assume ( variables_in t ) c= X;
then A8: ( Y variables_in t ) c= X by CKB26:1;
A9: (for s being (SortSymbol of S) holds (for x being (Element of ( Y . s )) holds P[ ( root-tree [ x,s ] ) ]))
proof
let s being (SortSymbol of S);
let x being (Element of ( Y . s ));
assume ( Y variables_in ( root-tree [ x,s ] ) ) c= X;
then A10: ( ( Y variables_in ( root-tree [ x,s ] ) ) . s ) c= ( X . s ) by PBOOLE:def 2;
( ( Y variables_in ( root-tree [ x,s ] ) ) . s ) = { x } by CKB22:1;
then x in ( X . s ) by A10,ZFMISC_1:31;
hence thesis by MSATERM:4;
end;
(for t being (Term of S,Y) holds P[ t ]) from MSATERM:sch 1(A9,A1);
hence thesis by A8;
end;
