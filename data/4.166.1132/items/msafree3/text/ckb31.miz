environ
vocabularies XBOOLE_0,STRUCT_0,MSUALG_1,CARD_3,RELAT_1,FUNCT_1,SUBSET_1,PBOOLE,MSUALG_3,TARSKI,FUNCT_6,MEMBER_1,CATALG_1,ZF_MODEL,MSUALG_2,MSAFREE,FUNCOP_1,CARD_1,LANG1,ZFMISC_1,TREES_4,MCART_1,MARGREL1,FINSEQ_1,MSATERM,UNIALG_2,DTCONSTR,FINSET_1,TREES_2,TREES_9,ZF_LANG1,TREES_3,TREES_A,NUMBERS,ARYTM_3,ORDINAL4,XXREAL_0,NAT_1,PARTFUN1,MSUALG_6,PRELAMB;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,DOMAIN_1,RELAT_1,FUNCT_1,RELSET_1,STRUCT_0,NUMBERS,NAT_1,MCART_1,FINSET_1,CARD_3,FINSEQ_1,FINSEQ_2,TREES_1,TREES_2,FUNCT_6,TREES_3,TREES_4,DTCONSTR,LANG1,PBOOLE,TREES_9,MSUALG_1,MSUALG_2,MSAFREE,FUNCOP_1,MSUALG_3,EQUATION,MSATERM,MSUALG_6,CATALG_1,XXREAL_0,CKB2,CKB4,CKB17,CKB18,CKB25,CKB27;
definitions TARSKI,XBOOLE_0,PBOOLE,MSUALG_2,MSUALG_6,CATALG_1,CKB4,CKB17,CKB18,CKB25,CKB27;
theorems TARSKI,ZFMISC_1,FUNCT_1,FUNCT_2,FINSEQ_1,FINSEQ_3,NAT_1,MCART_1,PBOOLE,RELAT_1,CARD_3,CARD_5,FUNCT_6,TREES_3,MSUALG_1,INSTALG1,TREES_4,PRE_CIRC,TREES_1,TREES_2,MSUALG_2,MSUALG_3,MSAFREE,MSATERM,EQUATION,MSUALG_6,XBOOLE_0,XBOOLE_1,ORDINAL1,PARTFUN1,TREES_9,FINSEQ_2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30;
schemes PBOOLE,MSATERM;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCOP_1,XREAL_0,FINSEQ_1,TREES_2,TREES_3,TREES_9,STRUCT_0,RELSET_1,MSUALG_1,MSUALG_2,MSUALG_3,MSAFREE,MSATERM,INDEX_1,MSUALG_6,MSUALG_9,INSTALG1,CATALG_1,PRE_CIRC,MSSUBFAM,PBOOLE,CKB1,CKB9,CKB13,CKB14,CKB15,CKB16;
constructors DOMAIN_1,XXREAL_0,NAT_1,TREES_9,MSSUBFAM,MSUALG_3,MSATERM,MSUALG_6,CATALG_1,EQUATION,SEQ_4,RELSET_1,FINSEQ_2,CKB4,CKB17,CKB18,CKB25,CKB27;
requirements BOOLE,SUBSET,NUMERALS;
begin
reserve x for set;
reserve y for set;
reserve z for set;
theorem
Th20: (for S being non  void Signature holds (for Y being  non-empty (ManySortedSet of (the carrier of S)) holds (for X being (ManySortedSet of (the carrier of S)) holds (for o being (OperSymbol of S) holds (for p being (ArgumentSeq of ( Sym (o,Y) )) holds (( ( Sym (o,Y) ) -tree p ) in ( ( S -Terms (X,Y) ) . ( the_result_sort_of o ) ) iff ( rng p ) c= ( Union ( S -Terms (X,Y) ) )))))))
proof
let S being non  void Signature;
let Y being  non-empty (ManySortedSet of (the carrier of S));
let X being (ManySortedSet of (the carrier of S));
let o being (OperSymbol of S);
let p being (ArgumentSeq of ( Sym (o,Y) ));
set s = ( the_result_sort_of o );
A1: ( dom ( S -Terms (X,Y) ) ) = (the carrier of S) by PARTFUN1:def 2;
A2: ( Sym (o,Y) ) = [ o,(the carrier of S) ] by MSAFREE:def 9;
A3: ( ( S -Terms (X,Y) ) . s ) = { t where t is (Term of S,Y): (( the_sort_of t ) = s & ( variables_in t ) c= X) } by CKB27:def 1;
hereby
assume ( ( Sym (o,Y) ) -tree p ) in ( ( S -Terms (X,Y) ) . s );
then consider t being (Term of S,Y) such that A4: ( [ o,(the carrier of S) ] -tree p ) = t and ( the_sort_of t ) = s and A5: ( variables_in t ) c= X by A3,A2;
thus ( rng p ) c= ( Union ( S -Terms (X,Y) ) )
proof
let y;
assume A6: y in ( rng p );
then consider x such that A7: x in ( dom p ) and A8: y = ( p . x ) by FUNCT_1:def 3;
reconsider x as Nat by A7;
reconsider q = ( p . x ) as (Term of S,Y) by A7,MSATERM:22;
A9: ( variables_in q ) c= X
proof
let z;
assume A10: z in (the carrier of S);
let a being set;
assume a in ( ( variables_in q ) . z );
then A11: a in ( ( variables_in t ) . z ) by A4,A6,A8,A10,CKB21:1;
( ( variables_in t ) . z ) c= ( X . z ) by A5,A10,PBOOLE:def 2;
hence thesis by A11;
end;
set sq = ( the_sort_of q );
( ( S -Terms (X,Y) ) . sq ) = { t9 where t9 is (Term of S,Y): (( the_sort_of t9 ) = sq & ( variables_in t9 ) c= X) } by CKB27:def 1;
then q in ( ( S -Terms (X,Y) ) . sq ) by A9;
hence thesis by A1,A8,CARD_5:2;
end;

end;
set t = ( ( Sym (o,Y) ) -tree p );
assume A12: ( rng p ) c= ( Union ( S -Terms (X,Y) ) );
A13: ( variables_in t ) c= X
proof
let z;
assume A14: z in (the carrier of S);
let x;
assume x in ( ( variables_in t ) . z );
then consider q being DecoratedTree such that A15: q in ( rng p ) and A16: x in ( ( S variables_in q ) . z ) by A2,A14,CKB21:1;
consider y such that A17: y in (the carrier of S) and A18: q in ( ( S -Terms (X,Y) ) . y ) by A1,A12,A15,CARD_5:2;
( ( S -Terms (X,Y) ) . y ) = { t9 where t9 is (Term of S,Y): (( the_sort_of t9 ) = y & ( variables_in t9 ) c= X) } by A17,CKB27:def 1;
then consider t9 being (Term of S,Y) such that A19: q = t9 and ( the_sort_of t9 ) = y and A20: ( variables_in t9 ) c= X by A18;
( ( variables_in t9 ) . z ) c= ( X . z ) by A14,A20,PBOOLE:def 2;
hence thesis by A16,A19;
end;
( the_sort_of t ) = s by MSATERM:20;
hence thesis by A3,A13;
end;
