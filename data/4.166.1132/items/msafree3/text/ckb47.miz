environ
vocabularies XBOOLE_0,STRUCT_0,MSUALG_1,CARD_3,RELAT_1,FUNCT_1,SUBSET_1,PBOOLE,MSUALG_3,TARSKI,FUNCT_6,MEMBER_1,CATALG_1,ZF_MODEL,MSUALG_2,MSAFREE,FUNCOP_1,CARD_1,LANG1,ZFMISC_1,TREES_4,MCART_1,MARGREL1,FINSEQ_1,MSATERM,UNIALG_2,DTCONSTR,FINSET_1,TREES_2,TREES_9,ZF_LANG1,TREES_3,TREES_A,NUMBERS,ARYTM_3,ORDINAL4,XXREAL_0,NAT_1,PARTFUN1,MSUALG_6,PRELAMB;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,DOMAIN_1,RELAT_1,FUNCT_1,RELSET_1,STRUCT_0,NUMBERS,NAT_1,MCART_1,FINSET_1,CARD_3,FINSEQ_1,FINSEQ_2,TREES_1,TREES_2,FUNCT_6,TREES_3,TREES_4,DTCONSTR,LANG1,PBOOLE,TREES_9,MSUALG_1,MSUALG_2,MSAFREE,FUNCOP_1,MSUALG_3,EQUATION,MSATERM,MSUALG_6,CATALG_1,XXREAL_0,CKB2,CKB4,CKB17,CKB18,CKB25,CKB27;
definitions TARSKI,XBOOLE_0,PBOOLE,MSUALG_2,MSUALG_6,CATALG_1,CKB4,CKB17,CKB18,CKB25,CKB27;
theorems TARSKI,ZFMISC_1,FUNCT_1,FUNCT_2,FINSEQ_1,FINSEQ_3,NAT_1,MCART_1,PBOOLE,RELAT_1,CARD_3,CARD_5,FUNCT_6,TREES_3,MSUALG_1,INSTALG1,TREES_4,PRE_CIRC,TREES_1,TREES_2,MSUALG_2,MSUALG_3,MSAFREE,MSATERM,EQUATION,MSUALG_6,XBOOLE_0,XBOOLE_1,ORDINAL1,PARTFUN1,TREES_9,FINSEQ_2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46;
schemes PBOOLE,MSATERM;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCOP_1,XREAL_0,FINSEQ_1,TREES_2,TREES_3,TREES_9,STRUCT_0,RELSET_1,MSUALG_1,MSUALG_2,MSUALG_3,MSAFREE,MSATERM,INDEX_1,MSUALG_6,MSUALG_9,INSTALG1,CATALG_1,PRE_CIRC,MSSUBFAM,PBOOLE,CKB1,CKB9,CKB13,CKB14,CKB15,CKB16;
constructors DOMAIN_1,XXREAL_0,NAT_1,TREES_9,MSSUBFAM,MSUALG_3,MSATERM,MSUALG_6,CATALG_1,EQUATION,SEQ_4,RELSET_1,FINSEQ_2,CKB4,CKB17,CKB18,CKB25,CKB27;
requirements BOOLE,SUBSET,NUMERALS;
begin
reserve x for set;
reserve z for set;
theorem
(for S being non  void Signature holds (for X being non  empty-yielding (ManySortedSet of (the carrier of S)) holds (for t being (Element of ( Free (S,X) )) holds (for s being (SortSymbol of S) holds ((x in ( ( S variables_in t ) . s ) implies [ x,s ] in ( rng t )) & ([ x,s ] in ( rng t ) implies (x in ( ( S variables_in t ) . s ) & x in ( X . s ))))))))
proof
let S being non  void Signature;
let X being non  empty-yielding (ManySortedSet of (the carrier of S));
let t being (Element of ( Free (S,X) ));
let s being (SortSymbol of S);
set Y = ( X \/ ( (the carrier of S) --> { ( 0 ) } ) );
hereby
assume x in ( ( S variables_in t ) . s );
then x in { ( a `1 ) where a is (Element of ( rng t )): ( a `2 ) = s } by CKB17:def 1;
then consider a being (Element of ( rng t )) such that A1: (x = ( a `1 ) & ( a `2 ) = s);
(t is (Term of S,Y) & a in ( rng t )) by CKB12:1;
hence [ x,s ] in ( rng t ) by A1,CKB46:1;
end;
assume A2: [ x,s ] in ( rng t );
then consider z such that A3: z in ( dom t ) and A4: [ x,s ] = ( t . z ) by FUNCT_1:def 3;
reconsider z as (Element of ( dom t )) by A3;
reconsider q = ( t | z ) as (Element of ( Free (S,X) )) by CKB45:1;
A5: [ x,s ] = ( q . ( {} ) ) by A4,TREES_9:35;
(( [ x,s ] `1 ) = x & ( [ x,s ] `2 ) = s) by MCART_1:7;
then A6: x in { ( a `1 ) where a is (Element of ( rng t )): ( a `2 ) = s } by A2;
A7: q is (Term of S,Y) by CKB12:1;
s in (the carrier of S);
then s <> (the carrier of S);
then (not s in { (the carrier of S) }) by TARSKI:def 1;
then (not [ x,s ] in [: (the carrier' of S),{ (the carrier of S) } :]) by ZFMISC_1:87;
then consider s9 being (SortSymbol of S),v being (Element of ( Y . s9 )) such that A8: [ x,s ] = [ v,s9 ] by A5,A7,MSATERM:2;
( S variables_in q ) c= X by CKB39:1;
then A9: ( ( S variables_in q ) . s9 ) c= ( X . s9 ) by PBOOLE:def 2;
q = ( root-tree [ v,s9 ] ) by A5,A7,A8,MSATERM:5;
then ( ( S variables_in q ) . s9 ) = { v } by CKB20:1;
then A10: v in ( X . s9 ) by A9,ZFMISC_1:31;
x = v by A8,ZFMISC_1:27;
hence thesis by A8,A10,A6,CKB17:def 1,ZFMISC_1:27;
end;
