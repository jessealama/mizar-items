environ
vocabularies ABIAN,AOFA_I00,ARYTM_1,ARYTM_3,CARD_1,CARD_3,CLASSES1,COMPLEX1,CONVEX1,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSEQ_4,FINSET_1,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,GLIB_000,INT_1,JORDAN2C,MATROID0,MEASURE5,MEMBERED,METRIC_1,NAT_1,NEWTON,NUMBERS,ORDERS_1,ORDINAL1,ORDINAL2,ORDINAL4,PARTFUN1,PCOMPS_1,PEPIN,POWER,PRE_TOPC,QC_LANG1,RCOMP_1,REAL_1,RELAT_1,RLAFFIN1,RLAFFIN2,RLVECT_1,RLVECT_2,RLVECT_5,RUSUB_4,SEMI_AF1,SEQ_4,SETFAM_1,SGRAPH1,SIMPLEX0,SIMPLEX1,SQUARE_1,STRUCT_0,SUBSET_1,SUPINF_2,TARSKI,TOPDIM_1,TOPMETR,TOPS_1,TOPS_2,VALUED_1,WEIERSTR,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_1,XXREAL_2,ZFMISC_1,SIMPLEX2;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,ZFMISC_1,RELAT_1,FUNCT_1,RELSET_1,FUNCT_2,PARTFUN1,FUNCOP_1,FUNCT_4,XXREAL_3,VALUED_1,NAT_1,PRE_TOPC,NUMBERS,XREAL_0,FINSEQ_1,BINOP_1,FINSEQ_2,TOPMETR,METRIC_1,EUCLID,FINSET_1,XXREAL_0,REAL_1,SETFAM_1,TOPS_2,INT_1,STRUCT_0,COMPTS_1,PCOMPS_1,RCOMP_1,WEIERSTR,SEQ_4,XXREAL_2,RVSUM_1,RLVECT_1,RUSUB_4,RLVECT_5,SIMPLEX0,RLAFFIN1,RLAFFIN2,SIMPLEX1,ORDERS_1,CARD_1,DOMAIN_1,PENCIL_1,CLASSES1,MATROID0,TBSP_1,MEMBERED,RLVECT_2,CONVEX1,TOPREAL9,COMPLEX1,NEWTON,POWER,JORDAN2C,SQUARE_1,BORSUK_1,CARD_3,EUCLID_9,TMAP_1,FINSEQOP,ABIAN,WAYBEL23,TOPDIM_1,TOPDIM_2,RLAFFIN3,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
definitions EUCLID,METRIC_1,ORDINAL1,PCOMPS_1,RLVECT_1,SIMPLEX0,SIMPLEX1,STRUCT_0,SUBSET_1,TARSKI,TBSP_1,XCMPLX_0,CARD_1,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
theorems ABIAN,ABSVALUE,BINOP_1,BORSUK_1,BORSUK_3,BORSUK_5,CARD_1,CARD_2,CLASSES1,COMPTS_1,CONVEX1,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,HAUSDORF,INT_1,JORDAN1K,JORDAN2B,JORDAN2C,MATROID0,MEMBERED,METRIC_1,NAT_1,NEWTON,ORDERS_1,ORDINAL1,PARTFUN1,PCOMPS_1,PCOMPS_2,POWER,PRE_TOPC,RCOMP_1,RELAT_1,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLVECT_1,RLVECT_2,RLVECT_3,RUSUB_4,RVSUM_1,SETFAM_1,SIMPLEX0,SIMPLEX1,TARSKI,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPGEN_5,TOPGRP_1,TOPMETR,TOPREAL3,TOPREAL6,TOPREAL7,TOPREAL9,TOPREALC,TOPS_1,TOPS_2,TOPS_3,TSEP_1,VALUED_1,WEIERSTR,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_0,XREAL_1,XXREAL_0,XXREAL_1,XXREAL_2,XXREAL_3,ZFMISC_1,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB45;
schemes FINSEQ_1,FRAENKEL,FUNCT_2,NAT_1,NAT_2,SUBSET_1;
registrations ASYMPT_0,BORSUK_1,BORSUK_2,CARD_1,COMPTS_1,DILWORTH,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSET_1,FUNCT_1,FUNCT_2,INT_1,JORDAN2B,JORDAN2C,MEMBERED,METRIZTS,MONOID_0,NAT_1,NEWTON,NUMBERS,PCOMPS_1,PRE_TOPC,RELAT_1,RELSET_1,RLAFFIN1,RLAFFIN3,SEQ_4,SIMPLEX0,SIMPLEX1,SPRECT_1,STRUCT_0,SUBSET_1,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPMETR,TOPREAL9,TOPREALC,TOPS_1,VALUED_0,VALUED_1,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_2,XXREAL_3,YELLOW13,JORDAN,CKB5,CKB9,CKB10,CKB11,CKB12,CKB23,CKB24,CKB25,CKB33,CKB43,CKB44;
constructors ABIAN,BINOP_2,COMPTS_1,CONVEX1,EUCLID_9,FINSEQOP,FUNCSDOM,JORDAN2C,LEXBFS,MONOID_0,NEWTON,POWER,REAL_1,RFINSEQ2,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLVECT_5,RUSUB_5,SEQ_1,SEQ_4,SIMPLEX1,SQUARE_1,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPREAL9,TOPS_2,WAYBEL23,WEIERSTR,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
requirements REAL,SUBSET,NUMERALS,ARITHM,BOOLE;
begin
reserve n for Nat;
reserve k for Nat;
reserve A for  affinely-independent (Subset of ( TOP-REAL n ));
theorem
Th23: (for A holds (( card A ) = ( n + 1 ) implies (for f being  continuous (Function of ( ( TOP-REAL n ) | ( conv A ) ),( ( TOP-REAL n ) | ( conv A ) )) holds (ex p being (Point of ( TOP-REAL n )) st (p in ( dom f ) & ( f . p ) = p)))))
proof
set TRn = ( TOP-REAL n );
let A being  affinely-independent (Subset of TRn);
assume that
A1: ( card A ) = ( n + 1 );
A2: A is non empty by A1;
set cA = ( conv A );
let f being  continuous (Function of ( TRn | cA ),( TRn | cA ));
reconsider cA as non empty (Subset of TRn) by A2;
set T = ( TRn | cA );
reconsider ff = f as  continuous (Function of T,T);
set E = the (Enumeration of A);
deffunc P(set) = { v where v is (Element of T): ( ( |-- (A,( E . $1 )) ) . ( f . v ) ) <= ( ( |-- (A,( E . $1 )) ) . v ) };
consider F being FinSequence such that A3: (( len F ) = ( card A ) & (for k holds (k in ( dom F ) implies ( F . k ) = P(k)))) from FINSEQ_1:sch 2;
( rng F ) c= ( bool (the carrier of T) )
proof
let y being set;
assume y in ( rng F );
then consider x being set such that A4: x in ( dom F ) and A5: ( F . x ) = y by FUNCT_1:def 3;
A6: P(x) c= (the carrier of T)
proof
let z being set;
assume z in P(x);
then (ex v being (Element of T) st (z = v & ( ( |-- (A,( E . x )) ) . ( f . v ) ) <= ( ( |-- (A,( E . x )) ) . v )));
hence thesis;
end;
( F . x ) = P(x) by A3,A4;
hence thesis by A5,A6;
end;
then reconsider F as (FinSequence of ( bool (the carrier of T) )) by FINSEQ_1:def 4;
A7: ( [#] T ) = cA by PRE_TOPC:def 5;
A8: ( dom f ) = (the carrier of T) by FUNCT_2:def 1;
now
let W being (Subset of T);
reconsider Z = ( 0 ) as  real number;
reconsider L = ]. ( -infty ),Z .] as (Subset of ( R^1 )) by TOPMETR:17;
assume W in ( rng F );
then consider i being set such that A9: i in ( dom F ) and A10: ( F . i ) = W by FUNCT_1:def 3;
reconsider AEi = ( |-- (A,( E . i )) ) as  continuous (Function of TRn,( R^1 )) by A1,RLAFFIN3:32;
set AT = ( AEi | T );
set Af = ( AT * ff );
set AfT = ( Af - AT );
A11: ( dom AfT ) = (the carrier of T) by FUNCT_2:def 1;
reconsider AfT as (Function of T,( R^1 )) by TOPMETR:17;
A12: ( dom AT ) = (the carrier of T) by FUNCT_2:def 1;
A13: AT = ( AEi | (the carrier of T) ) by A7,TMAP_1:def 3;
A14: ( dom Af ) = (the carrier of T) by FUNCT_2:def 1;
A15: ( AfT " L ) c= P(i)
proof
let x being set;
assume A16: x in ( AfT " L );
then reconsider v = x as (Point of T);
x in ( dom AfT ) by A16,FUNCT_1:def 7;
then A17: ( AfT . x ) = ( ( Af . x ) - ( AT . x ) ) by VALUED_1:13;
(( AfT . x ) in L & ( Af . x ) = ( AT . ( f . x ) )) by A14,A16,FUNCT_1:12,FUNCT_1:def 7;
then ( ( AT . ( f . x ) ) - ( AT . x ) ) <= ( 0 ) by A17,XXREAL_1:2;
then A18: ( AT . ( f . x ) ) <= ( AT . x ) by XREAL_1:50;
( f . x ) in ( dom AT ) by A14,A16,FUNCT_1:11;
then A19: ( AT . ( f . x ) ) = ( AEi . ( f . v ) ) by A13,FUNCT_1:47;
( AT . x ) = ( AEi . v ) by A12,A13,FUNCT_1:47;
hence thesis by A18,A19;
end;
A20: P(i) c= ( AfT " L )
proof
let x being set;
assume x in P(i);
then consider v being (Element of T) such that A21: x = v and A22: ( AEi . ( f . v ) ) <= ( AEi . v );
( f . v ) in ( rng f ) by A8,FUNCT_1:def 3;
then A23: ( AEi . ( f . v ) ) = ( AT . ( f . v ) ) by A12,A13,FUNCT_1:47;
( AEi . v ) = ( AT . v ) by A12,A13,FUNCT_1:47;
then ( Af . v ) <= ( AT . v ) by A14,A22,A23,FUNCT_1:12;
then ( ( Af . v ) - ( AT . v ) ) <= ( 0 ) by XREAL_1:47;
then ( AfT . v ) <= ( 0 ) by A11,VALUED_1:13;
then ( AfT . v ) in L by XXREAL_1:234;
hence thesis by A11,A21,FUNCT_1:def 7;
end;
L is  closed by BORSUK_5:41;
then A24: ( AfT " L ) is  closed by PRE_TOPC:def 6;
( F . i ) = P(i) by A3,A9;
hence W is  closed by A10,A15,A20,A24,XBOOLE_0:def 10;
end;
then A25: ( rng F ) is  closed by TOPS_2:def 2;
A26: ( dom E ) = ( Seg ( len E ) ) by FINSEQ_1:def 3;
A27: ( conv A ) c= ( Affin A ) by RLAFFIN1:65;
A28: ( rng E ) = A by RLAFFIN3:def 1;
then ( len E ) = ( card A ) by FINSEQ_4:62;
then A29: ( dom F ) = ( dom E ) by A3,FINSEQ_3:29;
(for S being (Subset of ( dom F )) holds ( conv ( E .: S ) ) c= ( union ( F .: S ) ))
proof
let S being (Subset of ( dom F ));
set ES = ( E .: S );
per cases ;
suppose S is  empty;

then ( conv ES ) is  empty;
hence thesis by XBOOLE_1:2;
end;
suppose A30: S is non empty;

let x being set;
set fx = ( f . x );
set xES = ( x |-- ES );
set fxA = ( fx |-- A );
set xA = ( x |-- A );
assume A31: x in ( conv ES );
A32: ( conv ES ) c= ( conv A ) by A28,RELAT_1:111,RLAFFIN1:3;
then reconsider v = x as (Point of T) by A7,A31;
A33: ( len ( fxA * E ) ) = ( len E ) by FINSEQ_2:33;
A34: ( len E ) = ( len ( xES * E ) ) by FINSEQ_2:33;
then reconsider fxAE = ( fxA * E ),xESE = ( xES * E ) as (Element of ( ( len E ) -tuples_on ( REAL ) )) by A33,FINSEQ_2:92;
A35: ( dom fxAE ) = ( Seg ( len E ) ) by A33,FINSEQ_1:def 3;
A36: ( conv ES ) c= ( Affin ES ) by RLAFFIN1:65;
then A37: xA = xES by A28,A31,RELAT_1:111,RLAFFIN1:77;
A38: ES c= A by A28,RELAT_1:111;
A39: ( Carrier xES ) c= ES by RLVECT_2:def 6;
ES is  affinely-independent by A28,RELAT_1:111,RLAFFIN1:43;
then (( sum xES ) = 1 & ( Carrier xES ) c= A) by A31,A36,A38,A39,RLAFFIN1:def 7,XBOOLE_1:1;
then A40: (( Carrier fxA ) c= A & 1 = ( Sum ( xES * E ) )) by A28,RLAFFIN1:30,RLVECT_2:def 6;
A41: fx in ( rng f ) by A7,A8,A31,A32,FUNCT_1:def 3;
then A42: fx in ( conv A ) by A7;
then ( sum fxA ) = 1 by A27,RLAFFIN1:def 7;
then A43: ( Sum fxAE ) = ( Sum xESE ) by A28,A40,RLAFFIN1:30;
A44: ( dom xESE ) = ( Seg ( len E ) ) by A34,FINSEQ_1:def 3;
per cases  by A43,RVSUM_1:83;
suppose (ex j being Nat st (j in ( Seg ( len E ) ) & ( fxAE . j ) < ( xESE . j )));

then consider j being Nat such that A45: j in ( Seg ( len E ) ) and A46: ( fxAE . j ) < ( xESE . j );
A47: ( fxAE . j ) = ( fxA . ( E . j ) ) by A35,A45,FUNCT_1:12;
A48: ( xESE . j ) = ( xES . ( E . j ) ) by A44,A45,FUNCT_1:12;
then ( xESE . j ) = ( ( |-- (A,( E . j )) ) . x ) by A31,A37,RLAFFIN3:def 3;
then A49: ( ( |-- (A,( E . j )) ) . ( f . v ) ) <= ( ( |-- (A,( E . j )) ) . v ) by A42,A46,A47,RLAFFIN3:def 3;
A50: ( E . j ) in ( dom fxA ) by A35,A45,FUNCT_1:11;
then ( 0 ) < ( xES . ( E . j ) ) by A7,A41,A46,A47,A48,RLAFFIN1:71;
then ( E . j ) in ( Carrier xES ) by A50,RLVECT_2:19;
then consider i being set such that A51: i in ( dom E ) and A52: i in S and A53: ( E . i ) = ( E . j ) by A39,FUNCT_1:def 6;
i = j by A26,A45,A51,A53,FUNCT_1:def 4;
then A54: ( F . j ) in ( F .: S ) by A52,FUNCT_1:def 6;
P(j) = ( F . j ) by A3,A26,A29,A45;
then x in ( F . j ) by A49;
hence thesis by A54,TARSKI:def 4;
end;
suppose A55: (for j being Nat holds (j in ( Seg ( len E ) ) implies ( fxAE . j ) <= ( xESE . j )));

consider j being set such that A56: j in S by A30,XBOOLE_0:def 1;
reconsider j as Nat by A56;
A57: ( fxAE . j ) <= ( xESE . j ) by A26,A29,A55,A56;
A58: P(j) = ( F . j ) by A3,A56;
( xESE . j ) = ( xES . ( E . j ) ) by A26,A29,A44,A56,FUNCT_1:12;
then A59: ( xESE . j ) = ( ( |-- (A,( E . j )) ) . x ) by A31,A37,RLAFFIN3:def 3;
( fxAE . j ) = ( fxA . ( E . j ) ) by A26,A29,A35,A56,FUNCT_1:12;
then ( ( |-- (A,( E . j )) ) . ( f . v ) ) <= ( ( |-- (A,( E . j )) ) . v ) by A42,A59,A57,RLAFFIN3:def 3;
then A60: x in ( F . j ) by A58;
( F . j ) in ( F .: S ) by A56,FUNCT_1:def 6;
hence thesis by A60,TARSKI:def 4;
end;
end;
end;
then ( meet ( rng F ) ) is non empty by A2,A3,A25,CKB45:1;
then consider v being set such that A61: v in ( meet ( rng F ) ) by XBOOLE_0:def 1;
A62: v in cA by A7,A61;
then reconsider v as (Element of TRn);
set fv = ( f . v );
set vA = ( v |-- A );
set fvA = ( fv |-- A );
A63: ( len ( fvA * E ) ) = ( len E ) by FINSEQ_2:33;
fv in ( rng f ) by A8,A61,FUNCT_1:def 3;
then A64: fv in cA by A7;
then (( Carrier fvA ) c= A & ( sum fvA ) = 1) by A27,RLAFFIN1:def 7,RLVECT_2:def 6;
then A65: (( Carrier vA ) c= A & 1 = ( Sum ( fvA * E ) )) by A28,RLAFFIN1:30,RLVECT_2:def 6;
A66: ( len E ) = ( len ( vA * E ) ) by FINSEQ_2:33;
then reconsider fvAE = ( fvA * E ),vAE = ( vA * E ) as (Element of ( ( len E ) -tuples_on ( REAL ) )) by A63,FINSEQ_2:92;
A67: ( dom fvAE ) = ( Seg ( len E ) ) by A63,FINSEQ_1:def 3;
A68: ( dom vAE ) = ( Seg ( len E ) ) by A66,FINSEQ_1:def 3;
A69: (for j being Nat holds (j in ( Seg ( len E ) ) implies ( fvAE . j ) <= ( vAE . j )))
proof
let j being Nat;
assume A70: j in ( Seg ( len E ) );
then (( F . j ) = P(j) & ( F . j ) in ( rng F )) by A3,A26,A29,FUNCT_1:def 3;
then v in P(j) by A61,SETFAM_1:def 1;
then A71: (ex w being (Element of T) st (w = v & ( ( |-- (A,( E . j )) ) . ( f . w ) ) <= ( ( |-- (A,( E . j )) ) . w )));
A72: ( ( |-- (A,( E . j )) ) . v ) = ( vA . ( E . j ) ) by RLAFFIN3:def 3
.= ( vAE . j ) by A68,A70,FUNCT_1:12;
( ( |-- (A,( E . j )) ) . fv ) = ( fvA . ( E . j ) ) by A64,RLAFFIN3:def 3
.= ( fvAE . j ) by A67,A70,FUNCT_1:12;
hence thesis by A71,A72;
end;
A73: ( Carrier vA ) c= A by RLVECT_2:def 6;
( sum vA ) = 1 by A27,A62,RLAFFIN1:def 7;
then A74: ( Sum fvAE ) = ( Sum vAE ) by A28,A65,RLAFFIN1:30;
A75: ( Carrier fvA ) c= A by RLVECT_2:def 6;
A76:now
let w being (Element of TRn);
per cases ;
suppose w in A;

then consider j being set such that A77: j in ( dom E ) and A78: ( E . j ) = w by A28,FUNCT_1:def 3;
A79: (( fvAE . j ) = ( fvA . w ) & ( vAE . j ) = ( vA . w )) by A77,A78,FUNCT_1:13;
(( fvAE . j ) <= ( vAE . j ) & ( fvAE . j ) >= ( vAE . j )) by A26,A74,A69,A77,RVSUM_1:83;
hence ( vA . w ) = ( fvA . w ) by A79,XXREAL_0:1;
end;
suppose A80: (not w in A);

then (not w in ( Carrier vA )) by A73;
then A81: ( vA . w ) = ( 0 ) by RLVECT_2:19;
(not w in ( Carrier fvA )) by A75,A80;
hence ( vA . w ) = ( fvA . w ) by A81,RLVECT_2:19;
end;
end;
A82: ( Sum vA ) = v by A27,A62,RLAFFIN1:def 7;
( Sum fvA ) = fv by A27,A64,RLAFFIN1:def 7;
then v = fv by A76,A82,RLVECT_2:def 9;
hence thesis by A8,A61;
end;
