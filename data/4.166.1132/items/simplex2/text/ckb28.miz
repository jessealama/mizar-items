environ
vocabularies ABIAN,AOFA_I00,ARYTM_1,ARYTM_3,CARD_1,CARD_3,CLASSES1,COMPLEX1,CONVEX1,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSEQ_4,FINSET_1,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,GLIB_000,INT_1,JORDAN2C,MATROID0,MEASURE5,MEMBERED,METRIC_1,NAT_1,NEWTON,NUMBERS,ORDERS_1,ORDINAL1,ORDINAL2,ORDINAL4,PARTFUN1,PCOMPS_1,PEPIN,POWER,PRE_TOPC,QC_LANG1,RCOMP_1,REAL_1,RELAT_1,RLAFFIN1,RLAFFIN2,RLVECT_1,RLVECT_2,RLVECT_5,RUSUB_4,SEMI_AF1,SEQ_4,SETFAM_1,SGRAPH1,SIMPLEX0,SIMPLEX1,SQUARE_1,STRUCT_0,SUBSET_1,SUPINF_2,TARSKI,TOPDIM_1,TOPMETR,TOPS_1,TOPS_2,VALUED_1,WEIERSTR,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_1,XXREAL_2,ZFMISC_1,SIMPLEX2;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,ZFMISC_1,RELAT_1,FUNCT_1,RELSET_1,FUNCT_2,PARTFUN1,FUNCOP_1,FUNCT_4,XXREAL_3,VALUED_1,NAT_1,PRE_TOPC,NUMBERS,XREAL_0,FINSEQ_1,BINOP_1,FINSEQ_2,TOPMETR,METRIC_1,EUCLID,FINSET_1,XXREAL_0,REAL_1,SETFAM_1,TOPS_2,INT_1,STRUCT_0,COMPTS_1,PCOMPS_1,RCOMP_1,WEIERSTR,SEQ_4,XXREAL_2,RVSUM_1,RLVECT_1,RUSUB_4,RLVECT_5,SIMPLEX0,RLAFFIN1,RLAFFIN2,SIMPLEX1,ORDERS_1,CARD_1,DOMAIN_1,PENCIL_1,CLASSES1,MATROID0,TBSP_1,MEMBERED,RLVECT_2,CONVEX1,TOPREAL9,COMPLEX1,NEWTON,POWER,JORDAN2C,SQUARE_1,BORSUK_1,CARD_3,EUCLID_9,TMAP_1,FINSEQOP,ABIAN,WAYBEL23,TOPDIM_1,TOPDIM_2,RLAFFIN3,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
definitions EUCLID,METRIC_1,ORDINAL1,PCOMPS_1,RLVECT_1,SIMPLEX0,SIMPLEX1,STRUCT_0,SUBSET_1,TARSKI,TBSP_1,XCMPLX_0,CARD_1,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
theorems ABIAN,ABSVALUE,BINOP_1,BORSUK_1,BORSUK_3,BORSUK_5,CARD_1,CARD_2,CLASSES1,COMPTS_1,CONVEX1,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,HAUSDORF,INT_1,JORDAN1K,JORDAN2B,JORDAN2C,MATROID0,MEMBERED,METRIC_1,NAT_1,NEWTON,ORDERS_1,ORDINAL1,PARTFUN1,PCOMPS_1,PCOMPS_2,POWER,PRE_TOPC,RCOMP_1,RELAT_1,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLVECT_1,RLVECT_2,RLVECT_3,RUSUB_4,RVSUM_1,SETFAM_1,SIMPLEX0,SIMPLEX1,TARSKI,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPGEN_5,TOPGRP_1,TOPMETR,TOPREAL3,TOPREAL6,TOPREAL7,TOPREAL9,TOPREALC,TOPS_1,TOPS_2,TOPS_3,TSEP_1,VALUED_1,WEIERSTR,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_0,XREAL_1,XXREAL_0,XXREAL_1,XXREAL_2,XXREAL_3,ZFMISC_1,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB26,CKB27;
schemes FINSEQ_1,FRAENKEL,FUNCT_2,NAT_1,NAT_2,SUBSET_1;
registrations ASYMPT_0,BORSUK_1,BORSUK_2,CARD_1,COMPTS_1,DILWORTH,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSET_1,FUNCT_1,FUNCT_2,INT_1,JORDAN2B,JORDAN2C,MEMBERED,METRIZTS,MONOID_0,NAT_1,NEWTON,NUMBERS,PCOMPS_1,PRE_TOPC,RELAT_1,RELSET_1,RLAFFIN1,RLAFFIN3,SEQ_4,SIMPLEX0,SIMPLEX1,SPRECT_1,STRUCT_0,SUBSET_1,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPMETR,TOPREAL9,TOPREALC,TOPS_1,VALUED_0,VALUED_1,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_2,XXREAL_3,YELLOW13,JORDAN,CKB5,CKB9,CKB10,CKB11,CKB12,CKB23,CKB24,CKB25;
constructors ABIAN,BINOP_2,COMPTS_1,CONVEX1,EUCLID_9,FINSEQOP,FUNCSDOM,JORDAN2C,LEXBFS,MONOID_0,NEWTON,POWER,REAL_1,RFINSEQ2,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLVECT_5,RUSUB_5,SEQ_1,SEQ_4,SIMPLEX1,SQUARE_1,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPREAL9,TOPS_2,WAYBEL23,WEIERSTR,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
requirements REAL,SUBSET,NUMERALS,ARITHM,BOOLE;
begin
reserve V for RealLinearSpace;
reserve Kv for non void (SimplicialComplex of V);
theorem
Th11: (for S being (Simplex of ( BCS Kv )) holds (for F being  c=-linear  finite  finite-membered (Subset-Family of V) holds (S = ( ( center_of_mass V ) .: F ) implies (for a1,a2 being (VECTOR of V) holds ((a1 in S & a2 in S) implies (ex b1,b2 being (VECTOR of V) st (ex r being Real st ((((b1 in ( Vertices ( BCS ( Complex_of { ( union F ) } ) ) ) & b2 in ( Vertices ( BCS ( Complex_of { ( union F ) } ) ) )) & ( a1 - a2 ) = ( r * ( b1 - b2 ) )) & ( 0 ) <= r) & r <= ( ( ( card ( union F ) ) - 1 ) / ( card ( union F ) ) )))))))))
proof
let S being (Simplex of ( BCS Kv ));
set cM = ( center_of_mass V );
let F being  c=-linear  finite  finite-membered (Subset-Family of V);
assume that
A1: S = ( cM .: F );
let a1 being (VECTOR of V),a2 being (VECTOR of V);
assume that
A2: a1 in S
and
A3: a2 in S;
consider A1 being set such that A4: A1 in ( dom cM ) and A5: A1 in F and A6: ( cM . A1 ) = a1 by A1,A2,FUNCT_1:def 6;
consider A2 being set such that A7: A2 in ( dom cM ) and A8: A2 in F and A9: ( cM . A2 ) = a2 by A1,A3,FUNCT_1:def 6;
A10: A1,A2 are_c=-comparable  by A5,A8,ORDINAL1:def 8;
set uF = ( union F );
set CuF = ( Complex_of { uF } );
A11: (for a1,a2 being (VECTOR of V) holds (for A1,A2 being set holds (((((((A1 c= A2 & A1 in ( dom cM )) & A1 in F) & ( cM . A1 ) = a1) & A1 in ( dom cM )) & A2 in F) & ( cM . A2 ) = a2) implies (ex b1,b2 being (VECTOR of V) st (ex r being Real st ((((b1 in ( Vertices ( BCS CuF ) ) & b2 in ( Vertices ( BCS CuF ) )) & ( a1 - a2 ) = ( r * ( b1 - b2 ) )) & ( 0 ) <= r) & r <= ( ( ( card uF ) - 1 ) / ( card uF ) )))))))
proof
let a1 being (VECTOR of V),a2 being (VECTOR of V);
A12: (the topology of CuF) = ( bool uF ) by SIMPLEX0:4;
let A1 being set,A2 being set;
assume that
A13: A1 c= A2
and
A14: A1 in ( dom cM )
and
A15: A1 in F
and
A16: ( cM . A1 ) = a1
and
A1 in ( dom cM )
and
A17: A2 in F
and
A18: ( cM . A2 ) = a2;
A19: A1 c= uF by A15,ZFMISC_1:74;
A20: A1 <> ( {} ) by A14,ORDERS_1:1;
then A21: uF is non empty by A19;
A22: A2 c= uF by A17,ZFMISC_1:74;
then reconsider A1,A2 as non empty  finite (Subset of V) by A13,A15,A17,A20;
set A21 = ( A2 \ A1 );
reconsider AA1 = { A1 },AA2 = { A21 } as (Subset-Family of CuF);
{ A1 } c= ( bool uF ) by A19,ZFMISC_1:31;
then A23: AA1 is  c=-linear  finite  simplex-like by A12,CKB27:1,SIMPLEX0:14;
A21 c= A2 by XBOOLE_1:36;
then A21 c= uF by A22,XBOOLE_1:1;
then { A21 } c= ( bool uF ) by ZFMISC_1:31;
then A24: AA2 is  c=-linear  finite  simplex-like by A12,CKB27:1,SIMPLEX0:14;
A25: |. CuF .| c= ( [#] V );
( [#] CuF ) = ( [#] V );
then A26: ( BCS CuF ) = ( subdivision (cM,CuF) ) by A25,SIMPLEX1:def 5;
A27: ( [#] ( subdivision (cM,CuF) ) ) = ( [#] CuF ) by SIMPLEX0:def 20;
then reconsider aa1 = { a1 } as (Subset of ( BCS CuF )) by A25,SIMPLEX1:def 5;
A28: a1 in aa1 by TARSKI:def 1;
then reconsider d1 = a1 as (Element of ( BCS CuF ));
A29: ( dom cM ) = ( BOOL (the carrier of V) ) by FUNCT_2:def 1;
( cM .: AA1 ) = ( Im (cM,A1) ) by RELAT_1:def 16
.= { a1 } by A14,A16,FUNCT_1:59;
then aa1 is  simplex-like by A23,A26,SIMPLEX0:def 20;
then A30: d1 is  vertex-like by A28,SIMPLEX0:def 3;
per cases ;
suppose A31: A1 = A2;

reconsider Z = ( 0 ) as Real by XREAL_0:def 1;
take b1 = a1;
take b2 = a1;
take Z;
( card uF ) >= 1 by A21,NAT_1:14;
then A32: ( ( card uF ) - 1 ) >= ( 1 - 1 ) by XREAL_1:6;
( a1 - a2 ) = ( 0. V ) by A16,A18,A31,RLVECT_1:5;
hence thesis by A30,A32,RLVECT_1:10,SIMPLEX0:def 4;
end;
suppose A1 <> A2;

then (not A2 c= A1) by A13,XBOOLE_0:def 10;
then reconsider A21 as non empty  finite (Subset of V) by XBOOLE_1:37;
A33: A21 in ( dom cM ) by A29,ORDERS_1:2;
then ( cM . A21 ) in ( rng cM ) by FUNCT_1:def 3;
then reconsider a21 = ( cM . A21 ) as (VECTOR of V);
reconsider aa2 = { a21 } as (Subset of ( BCS CuF )) by A25,A27,SIMPLEX1:def 5;
A34: a21 in aa2 by TARSKI:def 1;
then reconsider d2 = a21 as (Element of ( BCS CuF ));
( cM .: AA2 ) = ( Im (cM,A21) ) by RELAT_1:def 16
.= { a21 } by A33,FUNCT_1:59;
then aa2 is  simplex-like by A24,A26,SIMPLEX0:def 20;
then A35: d2 is  vertex-like by A34,SIMPLEX0:def 3;
set r1 = ( 1 / ( card A1 ) );
set r2 = ( 1 / ( card A2 ) );
set r21 = ( 1 / ( card A21 ) );
set r = ( ( card A21 ) / ( card A2 ) );
reconsider r1,r2,r21,r as Real by XREAL_0:def 1;
take a1;
take a21;
take r;
A36: ( r * r21 ) = ( ( ( card A21 ) * 1 ) / ( ( card A21 ) * ( card A2 ) ) ) by XCMPLX_1:76
.= r2 by XCMPLX_1:91;
consider L1 being (Linear_Combination of A1) such that A37: ( Sum L1 ) = ( r1 * ( Sum A1 ) ) and ( sum L1 ) = ( r1 * ( card A1 ) ) and A38: L1 = ( ( ZeroLC V ) +* ( A1 --> r1 ) ) by RLAFFIN2:15;
A39: ( Carrier L1 ) c= A1 by RLVECT_2:def 6;
A40: ( card A21 ) = ( ( 1 * ( card A2 ) ) - ( 1 * ( card A1 ) ) ) by A13,CARD_2:44;
then A41: ( r1 - r2 ) = ( ( ( card A21 ) * 1 ) / ( ( card A2 ) * ( card A1 ) ) ) by XCMPLX_1:130
.= ( r * r1 ) by XCMPLX_1:76;
consider L21 being (Linear_Combination of A21) such that A42: ( Sum L21 ) = ( r21 * ( Sum A21 ) ) and ( sum L21 ) = ( r21 * ( card A21 ) ) and A43: L21 = ( ( ZeroLC V ) +* ( A21 --> r21 ) ) by RLAFFIN2:15;
A44: ( Carrier L21 ) c= A21 by RLVECT_2:def 6;
consider L2 being (Linear_Combination of A2) such that A45: ( Sum L2 ) = ( r2 * ( Sum A2 ) ) and ( sum L2 ) = ( r2 * ( card A2 ) ) and A46: L2 = ( ( ZeroLC V ) +* ( A2 --> r2 ) ) by RLAFFIN2:15;
A47: ( Carrier L2 ) c= A2 by RLVECT_2:def 6;
(for v being (Element of V) holds ( ( L1 - L2 ) . v ) = ( ( r * ( L1 - L21 ) ) . v ))
proof
let v being (Element of V);
A48: ( dom ( A21 --> r21 ) ) = A21 by FUNCOP_1:13;
A49: ( ( L1 - L2 ) . v ) = ( ( L1 . v ) - ( L2 . v ) ) by RLVECT_2:54;
A50: ( dom ( A1 --> r1 ) ) = A1 by FUNCOP_1:13;
A51: ( dom ( A2 --> r2 ) ) = A2 by FUNCOP_1:13;
( ( r * ( L1 - L21 ) ) . v ) = ( r * ( ( L1 - L21 ) . v ) ) by RLVECT_2:def 11;
then A52: ( ( r * ( L1 - L21 ) ) . v ) = ( r * ( ( L1 . v ) - ( L21 . v ) ) ) by RLVECT_2:54;
per cases ;
suppose A53: v in A1;

then (not v in ( Carrier L21 )) by A44,XBOOLE_0:def 5;
then A54: ( L21 . v ) = ( 0 ) by RLVECT_2:19;
A55: (( ( A2 --> r2 ) . v ) = r2 & ( ( A1 --> r1 ) . v ) = r1) by A13,A53,FUNCOP_1:7;
( L1 . v ) = ( ( A1 --> r1 ) . v ) by A38,A50,A53,FUNCT_4:13;
hence thesis by A13,A41,A46,A49,A51,A52,A53,A54,A55,FUNCT_4:13;
end;
suppose A56: (v in A2 & (not v in A1));

then (not v in ( Carrier L1 )) by A39;
then A57: ( L1 . v ) = ( 0 ) by RLVECT_2:19;
( ( A2 --> r2 ) . v ) = r2 by A56,FUNCOP_1:7;
then A58: ( ( L1 - L2 ) . v ) = ( - r2 ) by A46,A49,A51,A56,A57,FUNCT_4:13;
A59: v in A21 by A56,XBOOLE_0:def 5;
then ( ( A21 --> r21 ) . v ) = r21 by FUNCOP_1:7;
then ( ( r * ( L1 - L21 ) ) . v ) = ( r * ( - r21 ) ) by A43,A48,A52,A57,A59,FUNCT_4:13;
hence thesis by A36,A58;
end;
suppose A60: ((not v in A1) & (not v in A2));

then (not v in ( Carrier L1 )) by A39;
then A61: ( L1 . v ) = ( 0 ) by RLVECT_2:19;
(not v in ( Carrier L21 )) by A44,A60,XBOOLE_0:def 5;
then A62: ( L21 . v ) = ( 0 ) by RLVECT_2:19;
(not v in ( Carrier L2 )) by A47,A60;
hence thesis by A49,A52,A62,A61,RLVECT_2:19;
end;
end;
then A63: ( L1 - L2 ) = ( r * ( L1 - L21 ) ) by RLVECT_2:def 9;
(( card A1 ) >= 1 & ( card A2 ) <= ( card uF )) by A17,NAT_1:14,NAT_1:43,ZFMISC_1:74;
then ( ( card A1 ) * ( card uF ) ) >= ( 1 * ( card A2 ) ) by XREAL_1:66;
then ( ( ( card A2 ) * ( card uF ) ) - ( ( card A1 ) * ( card uF ) ) ) <= ( ( ( card uF ) * ( card A2 ) ) - ( card A2 ) ) by XREAL_1:13;
then A64: ( ( card A21 ) * ( card uF ) ) <= ( ( ( card uF ) - 1 ) * ( card A2 ) ) by A40;
A65: ( Sum L21 ) = a21 by A42,RLAFFIN2:def 2;
A66: ( Sum L1 ) = a1 by A16,A37,RLAFFIN2:def 2;
( Sum L2 ) = a2 by A18,A45,RLAFFIN2:def 2;
then ( a1 - a2 ) = ( Sum ( r * ( L1 - L21 ) ) ) by A63,A66,RLVECT_3:4
.= ( r * ( Sum ( L1 - L21 ) ) ) by RLVECT_3:2
.= ( r * ( a1 - a21 ) ) by A65,A66,RLVECT_3:4;
hence thesis by A21,A30,A35,A64,SIMPLEX0:def 4,XREAL_1:102;
end;
end;
per cases  by A10,XBOOLE_0:def 9;
suppose A1 c= A2;

hence thesis by A4,A5,A6,A8,A9,A11;
end;
suppose A2 c= A1;

then consider b1 being (VECTOR of V),b2 being (VECTOR of V),r being Real such that A67: (b1 in ( Vertices ( BCS CuF ) ) & b2 in ( Vertices ( BCS CuF ) )) and A68: ( a2 - a1 ) = ( r * ( b1 - b2 ) ) and A69: (( 0 ) <= r & r <= ( ( ( card uF ) - 1 ) / ( card uF ) )) by A5,A6,A7,A8,A9,A11;
take b2;
take b1;
take r;
( a1 - a2 ) = ( - ( r * ( b1 - b2 ) ) ) by A68,RLVECT_1:33
.= ( r * ( - ( b1 - b2 ) ) ) by RLVECT_1:25
.= ( r * ( b2 - b1 ) ) by RLVECT_1:33;
hence thesis by A67,A69;
end;
end;
