environ
vocabularies ABIAN,AOFA_I00,ARYTM_1,ARYTM_3,CARD_1,CARD_3,CLASSES1,COMPLEX1,CONVEX1,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSEQ_4,FINSET_1,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,GLIB_000,INT_1,JORDAN2C,MATROID0,MEASURE5,MEMBERED,METRIC_1,NAT_1,NEWTON,NUMBERS,ORDERS_1,ORDINAL1,ORDINAL2,ORDINAL4,PARTFUN1,PCOMPS_1,PEPIN,POWER,PRE_TOPC,QC_LANG1,RCOMP_1,REAL_1,RELAT_1,RLAFFIN1,RLAFFIN2,RLVECT_1,RLVECT_2,RLVECT_5,RUSUB_4,SEMI_AF1,SEQ_4,SETFAM_1,SGRAPH1,SIMPLEX0,SIMPLEX1,SQUARE_1,STRUCT_0,SUBSET_1,SUPINF_2,TARSKI,TOPDIM_1,TOPMETR,TOPS_1,TOPS_2,VALUED_1,WEIERSTR,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_1,XXREAL_2,ZFMISC_1,SIMPLEX2;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,ZFMISC_1,RELAT_1,FUNCT_1,RELSET_1,FUNCT_2,PARTFUN1,FUNCOP_1,FUNCT_4,XXREAL_3,VALUED_1,NAT_1,PRE_TOPC,NUMBERS,XREAL_0,FINSEQ_1,BINOP_1,FINSEQ_2,TOPMETR,METRIC_1,EUCLID,FINSET_1,XXREAL_0,REAL_1,SETFAM_1,TOPS_2,INT_1,STRUCT_0,COMPTS_1,PCOMPS_1,RCOMP_1,WEIERSTR,SEQ_4,XXREAL_2,RVSUM_1,RLVECT_1,RUSUB_4,RLVECT_5,SIMPLEX0,RLAFFIN1,RLAFFIN2,SIMPLEX1,ORDERS_1,CARD_1,DOMAIN_1,PENCIL_1,CLASSES1,MATROID0,TBSP_1,MEMBERED,RLVECT_2,CONVEX1,TOPREAL9,COMPLEX1,NEWTON,POWER,JORDAN2C,SQUARE_1,BORSUK_1,CARD_3,EUCLID_9,TMAP_1,FINSEQOP,ABIAN,WAYBEL23,TOPDIM_1,TOPDIM_2,RLAFFIN3,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
definitions EUCLID,METRIC_1,ORDINAL1,PCOMPS_1,RLVECT_1,SIMPLEX0,SIMPLEX1,STRUCT_0,SUBSET_1,TARSKI,TBSP_1,XCMPLX_0,CARD_1,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
theorems ABIAN,ABSVALUE,BINOP_1,BORSUK_1,BORSUK_3,BORSUK_5,CARD_1,CARD_2,CLASSES1,COMPTS_1,CONVEX1,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,HAUSDORF,INT_1,JORDAN1K,JORDAN2B,JORDAN2C,MATROID0,MEMBERED,METRIC_1,NAT_1,NEWTON,ORDERS_1,ORDINAL1,PARTFUN1,PCOMPS_1,PCOMPS_2,POWER,PRE_TOPC,RCOMP_1,RELAT_1,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLVECT_1,RLVECT_2,RLVECT_3,RUSUB_4,RVSUM_1,SETFAM_1,SIMPLEX0,SIMPLEX1,TARSKI,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPGEN_5,TOPGRP_1,TOPMETR,TOPREAL3,TOPREAL6,TOPREAL7,TOPREAL9,TOPREALC,TOPS_1,TOPS_2,TOPS_3,TSEP_1,VALUED_1,WEIERSTR,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_0,XREAL_1,XXREAL_0,XXREAL_1,XXREAL_2,XXREAL_3,ZFMISC_1,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32;
schemes FINSEQ_1,FRAENKEL,FUNCT_2,NAT_1,NAT_2,SUBSET_1;
registrations ASYMPT_0,BORSUK_1,BORSUK_2,CARD_1,COMPTS_1,DILWORTH,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSET_1,FUNCT_1,FUNCT_2,INT_1,JORDAN2B,JORDAN2C,MEMBERED,METRIZTS,MONOID_0,NAT_1,NEWTON,NUMBERS,PCOMPS_1,PRE_TOPC,RELAT_1,RELSET_1,RLAFFIN1,RLAFFIN3,SEQ_4,SIMPLEX0,SIMPLEX1,SPRECT_1,STRUCT_0,SUBSET_1,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPMETR,TOPREAL9,TOPREALC,TOPS_1,VALUED_0,VALUED_1,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_2,XXREAL_3,YELLOW13,JORDAN,CKB5,CKB9,CKB10,CKB11,CKB12,CKB23,CKB24,CKB25,CKB33;
constructors ABIAN,BINOP_2,COMPTS_1,CONVEX1,EUCLID_9,FINSEQOP,FUNCSDOM,JORDAN2C,LEXBFS,MONOID_0,NEWTON,POWER,REAL_1,RFINSEQ2,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLVECT_5,RUSUB_5,SEQ_1,SEQ_4,SIMPLEX1,SQUARE_1,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPREAL9,TOPS_2,WAYBEL23,WEIERSTR,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
requirements REAL,SUBSET,NUMERALS,ARITHM,BOOLE;
begin
reserve n for Nat;
theorem
Th16: (for K being  bounded  finite-degree non void (SimplicialComplex of ( TOP-REAL n )) holds (|. K .| c= ( [#] K ) implies ( diameter ( BCS K ) ) <= ( ( ( degree K ) / ( ( degree K ) + 1 ) ) * ( diameter K ) )))
proof
set T = ( TOP-REAL n );
let K being  bounded  finite-degree non void (SimplicialComplex of T);
set BK = ( BCS K );
set cM = ( center_of_mass T );
set dK = ( degree K );
assume |. K .| c= ( [#] K );
then A2: ( BCS K ) = ( subdivision (cM,K) ) by SIMPLEX1:def 5;
(for A being (Subset of ( Euclid n )) holds (A is (Simplex of BK) implies ( diameter A ) <= ( ( dK / ( dK + 1 ) ) * ( diameter K ) )))
proof
let A being (Subset of ( Euclid n ));
reconsider ONE = 1 as  ext-real number;
assume A3: A is (Simplex of BK);
then reconsider a = A as (Simplex of BK);
consider S being  c=-linear  finite  simplex-like (Subset-Family of K) such that A4: A = ( cM .: S ) by A2,A3,SIMPLEX0:def 20;
A5: A is  bounded by A3,CKB8:1;
reconsider s = ( @ S ) as  c=-linear  finite  finite-membered (Subset-Family of T);
set Us = ( union s );
set C = ( Complex_of { Us } );
(( union S ) is  empty or ( union S ) in S) by SIMPLEX0:9,ZFMISC_1:2;
then A6: ( union S ) is  simplex-like by TOPS_2:def 1;
then A7: ( card ( union S ) ) <= ( ( degree K ) + ONE ) by SIMPLEX0:24;
A8: ( diameter K ) >= ( 0 ) by CKB16:1;
A9: (not ( {} ) in ( dom cM )) by ORDERS_1:1;
then A10: ( dom cM ) is  with_non-empty_elements by SETFAM_1:def 8;
A11: ( [#] T ) = ( [#] ( Euclid n ) ) by CKB26:1;
then reconsider US = Us as (Subset of ( Euclid n ));
A12: a in (the topology of BK) by PRE_TOPC:def 2;
per cases ;
suppose K is  empty-membered;

then A13: dK = ( - 1 ) by SIMPLEX0:22;
then (( - 1 ) <= ( degree BK ) & ( degree BK ) <= ( - 1 )) by A2,A10,SIMPLEX0:23,SIMPLEX0:52;
then ( degree BK ) = ( - 1 ) by XXREAL_0:1;
then BK is  empty-membered by SIMPLEX0:22;
then (the topology of BK) is  empty-membered by SIMPLEX0:def 7;
then A14: a = ( {} ) by A12,SETFAM_1:def 10;
( dK / ( dK + 1 ) ) = ( 0 ) by A13;
hence thesis by A14,TBSP_1:def 8;
end;
suppose K is non empty-membered;

then (( degree K ) >= ( - 1 ) & dK <> ( - 1 )) by SIMPLEX0:22,SIMPLEX0:23;
then dK > ( - 1 ) by XXREAL_0:1;
then A15: dK >= ( ( - 1 ) + 1 ) by INT_1:7;
then A16: ( ( dK / ( dK + 1 ) ) * ( diameter K ) ) >= ( 0 ) by A8;
per cases ;
suppose a is  empty;

hence thesis by A16,TBSP_1:def 8;
end;
suppose A17: a is non empty;

now
US is  bounded;
then Us is  Bounded by JORDAN2C:def 1;
then ( conv Us ) is  Bounded by CKB31:1;
then reconsider cUs = ( conv Us ) as  bounded (Subset of ( Euclid n )) by JORDAN2C:def 1;
let x being (Point of ( Euclid n )),y being (Point of ( Euclid n ));
assume that
A18: x in A
and
A19: y in A;
reconsider X = x,Y = y as (Element of T) by A11;
A20: (|. ( BCS C ) .| = |. C .| & |. C .| = ( conv Us )) by SIMPLEX1:8,SIMPLEX1:10;
consider p being set such that A21: p in ( dom cM ) and A22: p in s and ( cM . p ) = x by A4,A18,FUNCT_1:def 6;
p c= Us by A22,ZFMISC_1:74;
then A23: Us <> ( {} ) by A9,A21;
( card Us ) <= ( dK + 1 ) by A7,XXREAL_3:def 2;
then A24: ( ( dK + 1 ) " ) <= ( ( card Us ) " ) by A23,XREAL_1:85;
A25: ( diameter US ) <= ( diameter K ) by A6,CKB19:def 1;
A26: ( ( ( card Us ) - 1 ) / ( card Us ) ) = ( ( ( card Us ) / ( card Us ) ) - ( 1 / ( card Us ) ) )
.= ( 1 - ( 1 / ( card Us ) ) ) by A23,XCMPLX_1:60;
A27: ( diameter cUs ) = ( diameter US ) by CKB32:1;
consider b1 being (VECTOR of T),b2 being (VECTOR of T),r being Real such that A28: b1 in ( Vertices ( BCS C ) ) and A29: b2 in ( Vertices ( BCS C ) ) and A30: ( X - Y ) = ( r * ( b1 - b2 ) ) and A31: ( 0 ) <= r and A32: r <= ( ( ( card Us ) - 1 ) / ( card Us ) ) by A4,A17,A18,A19,CKB28:1;
reconsider B1 = b1,B2 = b2 as (Element of ( BCS C )) by A28,A29;
B1 is  vertex-like by A28,SIMPLEX0:def 4;
then consider S1 being (Subset of ( BCS C )) such that A33: S1 is  simplex-like and A34: B1 in S1 by SIMPLEX0:def 3;
A35: ( conv ( @ S1 ) ) c= |. ( BCS C ) .| by A33,SIMPLEX1:5;
B2 is  vertex-like by A29,SIMPLEX0:def 4;
then consider S2 being (Subset of ( BCS C )) such that A36: S2 is  simplex-like and A37: B2 in S2 by SIMPLEX0:def 3;
( @ S2 ) c= ( conv ( @ S2 ) ) by CONVEX1:41;
then A38: B2 in ( conv ( @ S2 ) ) by A37;
( @ S1 ) c= ( conv ( @ S1 ) ) by CONVEX1:41;
then A39: B1 in ( conv ( @ S1 ) ) by A34;
reconsider bb1 = b1,bb2 = b2 as (Point of ( Euclid n )) by A11;
( dK / ( dK + 1 ) ) = ( ( ( dK + 1 ) / ( dK + 1 ) ) - ( 1 / ( dK + 1 ) ) )
.= ( 1 - ( 1 / ( dK + 1 ) ) ) by A15,XCMPLX_1:60;
then ( ( ( card Us ) - 1 ) / ( card Us ) ) <= ( dK / ( dK + 1 ) ) by A24,A26,XREAL_1:10;
then A41: (( dist (bb1,bb2) ) >= ( 0 ) & r <= ( dK / ( dK + 1 ) )) by A32,XXREAL_0:2;
( conv ( @ S2 ) ) c= |. ( BCS C ) .| by A36,SIMPLEX1:5;
then ( dist (bb1,bb2) ) <= ( diameter US ) by A20,A27,A39,A38,A35,TBSP_1:def 8;
then A42: ( dist (bb1,bb2) ) <= ( diameter K ) by A25,XXREAL_0:2;
( dist (x,y) ) = |. ( x - y ) .| by EUCLID:def 6
.= |. ( X - Y ) .|
.= |. ( r * ( bb1 - bb2 ) ) .| by A30
.= ( ( abs r ) * |. ( bb1 - bb2 ) .| ) by EUCLID:11
.= ( r * |. ( bb1 - bb2 ) .| ) by A31,ABSVALUE:def 1
.= ( r * ( dist (bb1,bb2) ) ) by EUCLID:def 6;
hence ( dist (x,y) ) <= ( ( dK / ( dK + 1 ) ) * ( diameter K ) ) by A31,A42,A41,XREAL_1:66;
end;
hence thesis by A5,A17,TBSP_1:def 8;
end;
end;
end;
hence thesis by CKB19:def 1;
end;
