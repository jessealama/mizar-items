environ
vocabularies ABIAN,AOFA_I00,ARYTM_1,ARYTM_3,CARD_1,CARD_3,CLASSES1,COMPLEX1,CONVEX1,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSEQ_4,FINSET_1,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,GLIB_000,INT_1,JORDAN2C,MATROID0,MEASURE5,MEMBERED,METRIC_1,NAT_1,NEWTON,NUMBERS,ORDERS_1,ORDINAL1,ORDINAL2,ORDINAL4,PARTFUN1,PCOMPS_1,PEPIN,POWER,PRE_TOPC,QC_LANG1,RCOMP_1,REAL_1,RELAT_1,RLAFFIN1,RLAFFIN2,RLVECT_1,RLVECT_2,RLVECT_5,RUSUB_4,SEMI_AF1,SEQ_4,SETFAM_1,SGRAPH1,SIMPLEX0,SIMPLEX1,SQUARE_1,STRUCT_0,SUBSET_1,SUPINF_2,TARSKI,TOPDIM_1,TOPMETR,TOPS_1,TOPS_2,VALUED_1,WEIERSTR,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_1,XXREAL_2,ZFMISC_1,SIMPLEX2;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,ZFMISC_1,RELAT_1,FUNCT_1,RELSET_1,FUNCT_2,PARTFUN1,FUNCOP_1,FUNCT_4,XXREAL_3,VALUED_1,NAT_1,PRE_TOPC,NUMBERS,XREAL_0,FINSEQ_1,BINOP_1,FINSEQ_2,TOPMETR,METRIC_1,EUCLID,FINSET_1,XXREAL_0,REAL_1,SETFAM_1,TOPS_2,INT_1,STRUCT_0,COMPTS_1,PCOMPS_1,RCOMP_1,WEIERSTR,SEQ_4,XXREAL_2,RVSUM_1,RLVECT_1,RUSUB_4,RLVECT_5,SIMPLEX0,RLAFFIN1,RLAFFIN2,SIMPLEX1,ORDERS_1,CARD_1,DOMAIN_1,PENCIL_1,CLASSES1,MATROID0,TBSP_1,MEMBERED,RLVECT_2,CONVEX1,TOPREAL9,COMPLEX1,NEWTON,POWER,JORDAN2C,SQUARE_1,BORSUK_1,CARD_3,EUCLID_9,TMAP_1,FINSEQOP,ABIAN,WAYBEL23,TOPDIM_1,TOPDIM_2,RLAFFIN3,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
definitions EUCLID,METRIC_1,ORDINAL1,PCOMPS_1,RLVECT_1,SIMPLEX0,SIMPLEX1,STRUCT_0,SUBSET_1,TARSKI,TBSP_1,XCMPLX_0,CARD_1,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
theorems ABIAN,ABSVALUE,BINOP_1,BORSUK_1,BORSUK_3,BORSUK_5,CARD_1,CARD_2,CLASSES1,COMPTS_1,CONVEX1,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_4,HAUSDORF,INT_1,JORDAN1K,JORDAN2B,JORDAN2C,MATROID0,MEMBERED,METRIC_1,NAT_1,NEWTON,ORDERS_1,ORDINAL1,PARTFUN1,PCOMPS_1,PCOMPS_2,POWER,PRE_TOPC,RCOMP_1,RELAT_1,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLVECT_1,RLVECT_2,RLVECT_3,RUSUB_4,RVSUM_1,SETFAM_1,SIMPLEX0,SIMPLEX1,TARSKI,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPGEN_5,TOPGRP_1,TOPMETR,TOPREAL3,TOPREAL6,TOPREAL7,TOPREAL9,TOPREALC,TOPS_1,TOPS_2,TOPS_3,TSEP_1,VALUED_1,WEIERSTR,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_0,XREAL_1,XXREAL_0,XXREAL_1,XXREAL_2,XXREAL_3,ZFMISC_1,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42;
schemes FINSEQ_1,FRAENKEL,FUNCT_2,NAT_1,NAT_2,SUBSET_1;
registrations ASYMPT_0,BORSUK_1,BORSUK_2,CARD_1,COMPTS_1,DILWORTH,EUCLID,EUCLID_9,FINSEQ_1,FINSEQ_2,FINSET_1,FUNCT_1,FUNCT_2,INT_1,JORDAN2B,JORDAN2C,MEMBERED,METRIZTS,MONOID_0,NAT_1,NEWTON,NUMBERS,PCOMPS_1,PRE_TOPC,RELAT_1,RELSET_1,RLAFFIN1,RLAFFIN3,SEQ_4,SIMPLEX0,SIMPLEX1,SPRECT_1,STRUCT_0,SUBSET_1,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPMETR,TOPREAL9,TOPREALC,TOPS_1,VALUED_0,VALUED_1,XBOOLE_0,XREAL_0,XXREAL_0,XXREAL_2,XXREAL_3,YELLOW13,JORDAN,CKB5,CKB9,CKB10,CKB11,CKB12,CKB23,CKB24,CKB25,CKB33,CKB43,CKB44;
constructors ABIAN,BINOP_2,COMPTS_1,CONVEX1,EUCLID_9,FINSEQOP,FUNCSDOM,JORDAN2C,LEXBFS,MONOID_0,NEWTON,POWER,REAL_1,RFINSEQ2,RLAFFIN1,RLAFFIN2,RLAFFIN3,RLVECT_5,RUSUB_5,SEQ_1,SEQ_4,SIMPLEX1,SQUARE_1,TBSP_1,TMAP_1,TOPDIM_1,TOPDIM_2,TOPREAL9,TOPS_2,WAYBEL23,WEIERSTR,CKB1,CKB7,CKB15,CKB19,CKB21,CKB22;
requirements REAL,SUBSET,NUMERALS,ARITHM,BOOLE;
begin
reserve n for Nat;
theorem
Th22: (for A being non empty  affinely-independent (Subset of ( TOP-REAL n )) holds (for E being (Enumeration of A) holds (for F being (FinSequence of ( bool (the carrier of ( ( TOP-REAL n ) | ( conv A ) )) )) holds (((( len F ) = ( card A ) & ( rng F ) is  closed) & (for S being (Subset of ( dom F )) holds ( conv ( E .: S ) ) c= ( union ( F .: S ) ))) implies ( meet ( rng F ) ) is non empty))))
proof
set TRn = ( TOP-REAL n );
let A being non empty  affinely-independent (Subset of TRn);
set cA = ( conv A );
let E being (Enumeration of A);
let F being (FinSequence of ( bool (the carrier of ( TRn | cA )) ));
assume that
A1: ( len F ) = ( card A )
and
A2: ( rng F ) is  closed
and
A3: (for S being (Subset of ( dom F )) holds ( conv ( E .: S ) ) c= ( union ( F .: S ) ));
A4: F <> ( {} ) by A1;
A5: ( rng E ) = A by RLAFFIN3:def 1;
then ( len E ) = ( card A ) by FINSEQ_4:62;
then A6: ( dom E ) = ( dom F ) by A1,FINSEQ_3:29;
set En = ( Euclid n );
set Comp = ( Complex_of { A } );
defpred P[ set,set ]
 means
($1 in ( F . ( ( E " ) . $2 ) ) & (for B being (Subset of TRn) holds ((B c= A & $1 in ( conv B )) implies $2 in B)));
A7: ( TopSpaceMetr En ) = ( the TopStruct of TRn ) by EUCLID:def 8;
then reconsider CA = cA as non empty (Subset of ( TopSpaceMetr En ));
reconsider ca = cA as non empty (Subset of En) by A7;
A8: ( ( TopSpaceMetr En ) | CA ) = ( TopSpaceMetr ( En | ca ) ) by HAUSDORF:16;
then reconsider CrF = ( COMPLEMENT ( rng F ) ) as (Subset-Family of ( TopSpaceMetr ( En | ca ) )) by A7,PRE_TOPC:36;
CA is  compact by A7,COMPTS_1:23;
then A9: ( TopSpaceMetr ( En | ca ) ) is  compact by A8,COMPTS_1:3;
A10: ( ( TopSpaceMetr En ) | CA ) = ( TRn | cA ) by A7,PRE_TOPC:36;
assume ( meet ( rng F ) ) is  empty;
then ( [#] ( TRn | cA ) ) = ( ( meet ( rng F ) ) ` )
.= ( union CrF ) by A4,TOPS_2:7;
then A11: CrF is (Cover of ( TopSpaceMetr ( En | ca ) )) by A8,A10,SETFAM_1:45;
set L = the (Lebesgue_number of CrF);
A12: |. Comp .| c= ( [#] Comp );
then consider k being Nat such that A13: ( diameter ( BCS (k,Comp) ) ) < L by CKB36:1;
set Bcs = ( BCS (k,Comp) );
A14: |. Bcs .| = |. Comp .| by A12,SIMPLEX1:19;
A15: (the topology of Comp) = ( bool A ) by SIMPLEX0:4;
A16: (for x being set holds (x in ( Vertices Bcs ) implies (ex y being set st (y in A & P[ x,y ]))))
proof
let x being set;
assume A17: x in ( Vertices Bcs );
then reconsider v = x as (Element of Bcs);
v is  vertex-like by A17,SIMPLEX0:def 4;
then consider S being (Subset of Bcs) such that A18: S is  simplex-like and A19: v in S by SIMPLEX0:def 3;
( @ S ) c= ( conv ( @ S ) ) by RLAFFIN1:2;
then A20: v in ( conv ( @ S ) ) by A19;
( conv ( @ S ) ) c= |. Comp .| by A14,A18,SIMPLEX1:5;
then consider W being (Subset of Comp) such that A21: W is  simplex-like and A22: v in ( Int ( @ W ) ) by A20,SIMPLEX1:6;
A23: v in ( conv ( @ W ) ) by A22,RLAFFIN2:def 1;
A24: W in (the topology of Comp) by A21,PRE_TOPC:def 2;
then (( E " W ) c= ( dom E ) & ( E .: ( E " W ) ) = W) by A5,A15,FUNCT_1:77,RELAT_1:132;
then ( conv ( @ W ) ) c= ( union ( F .: ( E " W ) ) ) by A3,A6;
then consider Y being set such that A25: v in Y and A26: Y in ( F .: ( E " W ) ) by A23,TARSKI:def 4;
consider i being set such that i in ( dom F ) and A27: i in ( E " W ) and A28: ( F . i ) = Y by A26,FUNCT_1:def 6;
take y = ( E . i );
A29: y in W by A27,FUNCT_1:def 7;
i in ( dom E ) by A27,FUNCT_1:def 7;
hence (y in A & x in ( F . ( ( E " ) . y ) )) by A15,A24,A25,A28,A29,FUNCT_1:34;
let B being (Subset of TRn);
assume that
A30: B c= A
and
A31: x in ( conv B );
reconsider b = B as (Simplex of Comp) by A15,A30,PRE_TOPC:def 2;
( conv ( @ b ) ) meets ( Int ( @ W ) ) by A22,A31,XBOOLE_0:3;
then W c= b by A21,SIMPLEX1:26;
hence thesis by A29;
end;
consider G being (Function of ( Vertices Bcs ),A) such that A32: (for x being set holds (x in ( Vertices Bcs ) implies P[ x,( G . x ) ])) from FUNCT_2:sch 1(A16);
A33: |. Comp .| = ( conv A ) by SIMPLEX1:8;
then Bcs is  with_non-empty_element by A14,SIMPLEX1:7;
then (for v being (Vertex of Bcs) holds (for B being (Subset of TRn) holds ((B c= A & v in ( conv B )) implies ( G . v ) in B))) by A32;
then consider S being (Simplex of ( ( card A ) - 1 ),Bcs) such that A34: ( G .: S ) = A by SIMPLEX1:47;
A35: ( [#] Bcs ) = ( [#] Comp ) by A12,SIMPLEX1:18;
then reconsider SS = S as (Subset of En) by A7;
S is non empty by A34;
then consider s being set such that A36: s in S by XBOOLE_0:def 1;
A37: ( conv ( @ S ) ) c= cA by A14,A33,SIMPLEX1:5;
reconsider s as (Point of En) by A7,A35,A36;
A38: S c= ( conv ( @ S ) ) by RLAFFIN1:2;
then s in ( conv ( @ S ) ) by A36;
then reconsider ss = s as (Point of ( En | ca )) by A37,TOPMETR:def 2;
A39: SS is  bounded;
CrF is  open by A2,A8,A10,TOPS_2:9;
then consider CRF being (Subset of ( TopSpaceMetr ( En | ca ) )) such that A40: CRF in CrF and A41: ( Ball (ss,L) ) c= CRF by A9,A11,CKB1:def 1;
( CRF ` ) in ( rng F ) by A8,A10,A40,SETFAM_1:def 7;
then consider i being set such that A42: i in ( dom F ) and A43: ( F . i ) = ( CRF ` ) by FUNCT_1:def 3;
( E . i ) in A by A5,A6,A42,FUNCT_1:def 3;
then consider w being set such that A44: w in ( dom G ) and A45: w in S and A46: ( G . w ) = ( E . i ) by A34,FUNCT_1:def 6;
A47: w in ( conv ( @ S ) ) by A38,A45;
A48: ( conv ( @ S ) ) c= cA by A14,A33,SIMPLEX1:5;
then A49: (( [#] ( En | ca ) ) = ca & w in cA) by A47,TOPMETR:def 2;
reconsider SS = S as  bounded (Subset of En) by A39;
( diameter SS ) <= ( diameter ( BCS (k,Comp) ) ) by CKB19:def 1;
then A50: ( diameter SS ) < L by A13,XXREAL_0:2;
w in ( F . ( ( E " ) . ( G . w ) ) ) by A32,A44;
then A51: w in ( F . i ) by A6,A42,A46,FUNCT_1:34;
reconsider w as (Point of En) by A49;
reconsider ww = w as (Point of ( En | ca )) by A47,A48,TOPMETR:def 2;
( conv ( @ S ) ) c= ( cl_Ball (s,( diameter SS )) ) by A36,A38,CKB30:1;
then (( dist (s,w) ) = ( dist (ss,ww) ) & ( dist (s,w) ) <= ( diameter SS )) by A47,METRIC_1:12,TOPMETR:def 1;
then ( dist (ss,ww) ) < L by A50,XXREAL_0:2;
then ww in ( Ball (ss,L) ) by METRIC_1:11;
hence contradiction by A41,A43,A51,XBOOLE_0:def 5;
end;
