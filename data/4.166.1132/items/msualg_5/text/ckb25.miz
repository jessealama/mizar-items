environ
vocabularies NUMBERS,PBOOLE,RELAT_1,EQREL_1,TARSKI,XBOOLE_0,STRUCT_0,LATTICES,FUNCT_1,SUBSET_1,BINOP_1,MSUALG_4,ZFMISC_1,CARD_3,MSUALG_1,FINSEQ_1,MARGREL1,PARTFUN1,ARYTM_3,ORDINAL4,NAT_1,XXREAL_0,CARD_1,RELAT_2,ARYTM_1,NAT_LAT,REALSET1,XXREAL_2,MSUALG_5;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,RELAT_2,FUNCT_1,REALSET1,NUMBERS,XCMPLX_0,FINSEQ_2,STRUCT_0,PARTFUN1,FUNCT_2,RELSET_1,EQREL_1,BINOP_1,PBOOLE,MSUALG_1,MSUALG_3,MSUALG_4,LATTICES,NAT_LAT,CARD_3,FINSEQ_1,NAT_1,XXREAL_0,CKB1,CKB4,CKB6,CKB7,CKB9,CKB18;
definitions PBOOLE,BINOP_1,REALSET1,EQREL_1,FUNCOP_1,CKB1,CKB4,CKB7,CKB9,CKB18;
theorems BINOP_1,PBOOLE,MSUALG_4,EQREL_1,TARSKI,NAT_LAT,LATTICES,RELAT_1,RELAT_2,FUNCT_2,CARD_3,ZFMISC_1,MSUALG_1,FUNCT_1,MSUALG_3,FINSEQ_1,NAT_1,MSAFREE2,XBOOLE_0,XBOOLE_1,FINSEQ_3,XCMPLX_1,ORDERS_1,XREAL_1,XXREAL_0,PARTFUN1,FUNCOP_1,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB20,CKB21,CKB22,CKB23,CKB24;
schemes PBOOLE,BINOP_1,NAT_1,FINSEQ_1,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,PARTFUN1,XREAL_0,NAT_1,FINSEQ_1,EQREL_1,PBOOLE,STRUCT_0,LATTICES,NAT_LAT,PRALG_1,MSUALG_1,MSUALG_3,MSUALG_4,ORDINAL1,CARD_1,CKB5,CKB19;
constructors BINOP_1,XXREAL_0,NAT_1,NAT_D,EQREL_1,REALSET1,NAT_LAT,MSUALG_3,MSUALG_4,RELSET_1,PRALG_2,FUNCOP_1,FINSEQ_2,CKB1,CKB4,CKB7,CKB9,CKB18;
requirements NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve S for non  void non  empty ManySortedSign;
reserve A for  non-empty MSAlgebra over S;
definition
let S;
let A being  non-empty MSAlgebra over S;
func CongrLatt A ->  strict (SubLattice of ( EqRelLatt (the Sorts of A) )) means 
:Def6: (for x being set holds (x in (the carrier of it) iff x is (MSCongruence of A)));
existence
proof
set D = (the carrier of ( EqRelLatt (the Sorts of A) ));
set f = the (MSCongruence of A);
defpred P[ set ]
 means
$1 is (MSCongruence of A);
deffunc F((Element of S)) = ( bool [: ( (the Sorts of A) . $1 ),( (the Sorts of A) . $1 ) :] );
consider M2 being (ManySortedSet of (the carrier of S)) such that A1: (for i being (Element of (the carrier of S)) holds ( M2 . i ) = F(i)) from PBOOLE:sch 5;
consider B being set such that A2: (for x being set holds (x in B iff (x in ( product M2 ) & P[ x ]))) from XBOOLE_0:sch 1;
A3: (for C1 being (MSCongruence of A) holds C1 in ( product M2 ))
proof
let C1 being (MSCongruence of A);
A4:now
let x being set;
assume x in ( dom M2 );
then reconsider x9 = x as (Element of (the carrier of S)) by PARTFUN1:def 2;
A5: ( C1 . x9 ) is (Subset of [: ( (the Sorts of A) . x9 ),( (the Sorts of A) . x9 ) :]);
( M2 . x9 ) = ( bool [: ( (the Sorts of A) . x9 ),( (the Sorts of A) . x9 ) :] ) by A1;
hence ( C1 . x ) in ( M2 . x ) by A5;
end;
( dom C1 ) = (the carrier of S) by PARTFUN1:def 2
.= ( dom M2 ) by PARTFUN1:def 2;
hence thesis by A4,CARD_3:9;
end;
A6: (for x being set holds (x in B iff x is (MSCongruence of A)))
proof
let x being set;
thus (x in B implies x is (MSCongruence of A)) by A2;
thus (x is (MSCongruence of A) implies x in B)
proof
assume A7: x is (MSCongruence of A);
then x in ( product M2 ) by A3;
hence thesis by A2,A7;
end;

end;
then f in B;
then reconsider B as non  empty set;
set B1 = ( (the L_join of ( EqRelLatt (the Sorts of A) )) || B );
set B2 = ( (the L_meet of ( EqRelLatt (the Sorts of A) )) || B );
now
let x;
assume x in B;
then x is (MSCongruence of A) by A6;
hence x in (the carrier of ( EqRelLatt (the Sorts of A) )) by CKB18:def 1;
end;
then A8: B c= D by TARSKI:def 3;
then [: B,B :] c= [: D,D :] by ZFMISC_1:96;
then reconsider B1,B2 as (Function of [: B,B :],D) by FUNCT_2:32;
A9: ( dom B2 ) = [: B,B :] by FUNCT_2:def 1;
now
let x being set;
assume A10: x in [: B,B :];
then consider x1,x2 being set such that A11: x = [ x1,x2 ] by RELAT_1:def 1;
A12: x2 in B by A10,A11,ZFMISC_1:87;
x1 in B by A10,A11,ZFMISC_1:87;
then reconsider x19 = x1,x29 = x2 as (MSCongruence of A) by A6,A12;
A13: x29 in B by A6;
x19 in B by A6;
then [ x1,x2 ] in [: B,B :] by A13,ZFMISC_1:87;
then ( B2 . x ) = ( (the L_meet of ( EqRelLatt (the Sorts of A) )) . (x1,x2) ) by A11,FUNCT_1:49
.= ( x19 /\ x29 ) by CKB18:def 1;
then ( B2 . x ) is (MSCongruence of A) by CKB24:1;
hence ( B2 . x ) in B by A6;
end;
then reconsider B2 as (BinOp of B) by A9,FUNCT_2:3;
A14: ( dom B1 ) = [: B,B :] by FUNCT_2:def 1;
now
let x being set;
assume A15: x in [: B,B :];
then consider x1,x2 being set such that A16: x = [ x1,x2 ] by RELAT_1:def 1;
A17: x2 in B by A15,A16,ZFMISC_1:87;
x1 in B by A15,A16,ZFMISC_1:87;
then reconsider x19 = x1,x29 = x2 as (MSCongruence of A) by A6,A17;
A18: x29 in B by A6;
x19 in B by A6;
then [ x1,x2 ] in [: B,B :] by A18,ZFMISC_1:87;
then ( B1 . x ) = ( (the L_join of ( EqRelLatt (the Sorts of A) )) . (x1,x2) ) by A16,FUNCT_1:49
.= ( x19 "\/" x29 ) by CKB18:def 1;
then ( B1 . x ) is (MSCongruence of A) by CKB23:1;
hence ( B1 . x ) in B by A6;
end;
then reconsider B1 as (BinOp of B) by A14,FUNCT_2:3;
reconsider L = LattStr (# B,B1,B2 #) as non  empty LattStr;
A19: (for a,b being (MSCongruence of A) holds (( B1 . (a,b) ) = ( a "\/" b ) & ( B2 . (a,b) ) = ( a /\ b )))
proof
let a being (MSCongruence of A);
let b being (MSCongruence of A);
A20: b in B by A6;
a in B by A6;
then A21: [ a,b ] in [: B,B :] by A20,ZFMISC_1:87;
hence ( B1 . (a,b) ) = ( (the L_join of ( EqRelLatt (the Sorts of A) )) . (a,b) ) by FUNCT_1:49
.= ( a "\/" b ) by CKB18:def 1;
thus ( B2 . (a,b) ) = ( (the L_meet of ( EqRelLatt (the Sorts of A) )) . (a,b) ) by A21,FUNCT_1:49
.= ( a /\ b ) by CKB18:def 1;
end;
A22:now
let a being (Element of B);
let b being (Element of B);
reconsider a9 = a,b9 = b as (MSCongruence of A) by A6;
thus ( B1 . (a,b) ) = ( a9 "\/" b9 ) by A19
.= ( B1 . (b,a) ) by A19;
end;
A23: (for a,b being (Element of L) holds ( a "\/" b ) = ( b "\/" a ))
proof
let a being (Element of L);
let b being (Element of L);
thus ( a "\/" b ) = ( B1 . (a,b) ) by LATTICES:def 1
.= ( (the L_join of L) . (b,a) ) by A22
.= ( b "\/" a ) by LATTICES:def 1;
end;
A24:now
let a being (Element of B);
let b being (Element of B);
let c being (Element of B);
reconsider a9 = a,b9 = b,c9 = c as (MSCongruence of A) by A6;
reconsider e1 = ( b9 /\ c9 ) as (MSCongruence of A) by CKB24:1;
reconsider e2 = ( a9 /\ b9 ) as (MSCongruence of A) by CKB24:1;
thus ( B2 . (a,( B2 . (b,c) )) ) = ( B2 . (a,e1) ) by A19
.= ( a9 /\ ( b9 /\ c9 ) ) by A19
.= ( ( a9 /\ b9 ) /\ c9 ) by PBOOLE:29
.= ( B2 . (e2,c) ) by A19
.= ( B2 . (( B2 . (a,b) ),c) ) by A19;
end;
A25: (for a,b,c being (Element of L) holds ( a "/\" ( b "/\" c ) ) = ( ( a "/\" b ) "/\" c ))
proof
let a being (Element of L);
let b being (Element of L);
let c being (Element of L);
thus ( a "/\" ( b "/\" c ) ) = ( (the L_meet of L) . (a,( b "/\" c )) ) by LATTICES:def 2
.= ( B2 . (a,( B2 . (b,c) )) ) by LATTICES:def 2
.= ( (the L_meet of L) . (( (the L_meet of L) . (a,b) ),c) ) by A24
.= ( (the L_meet of L) . (( a "/\" b ),c) ) by LATTICES:def 2
.= ( ( a "/\" b ) "/\" c ) by LATTICES:def 2;
end;
A26:now
let a being (Element of B);
let b being (Element of B);
let c being (Element of B);
reconsider a9 = a,b9 = b,c9 = c as (MSCongruence of A) by A6;
reconsider d = ( b9 "\/" c9 ) as (MSCongruence of A) by CKB23:1;
reconsider e = ( a9 "\/" b9 ) as (MSCongruence of A) by CKB23:1;
thus ( B1 . (a,( B1 . (b,c) )) ) = ( B1 . (a,d) ) by A19
.= ( a9 "\/" ( b9 "\/" c9 ) ) by A19
.= ( ( a9 "\/" b9 ) "\/" c9 ) by CKB14:1
.= ( B1 . (e,c) ) by A19
.= ( B1 . (( B1 . (a,b) ),c) ) by A19;
end;
A27: (for a,b,c being (Element of L) holds ( a "\/" ( b "\/" c ) ) = ( ( a "\/" b ) "\/" c ))
proof
let a being (Element of L);
let b being (Element of L);
let c being (Element of L);
thus ( a "\/" ( b "\/" c ) ) = ( (the L_join of L) . (a,( b "\/" c )) ) by LATTICES:def 1
.= ( B1 . (a,( B1 . (b,c) )) ) by LATTICES:def 1
.= ( (the L_join of L) . (( (the L_join of L) . (a,b) ),c) ) by A26
.= ( (the L_join of L) . (( a "\/" b ),c) ) by LATTICES:def 1
.= ( ( a "\/" b ) "\/" c ) by LATTICES:def 1;
end;
A28:now
let a being (Element of B);
let b being (Element of B);
reconsider a9 = a,b9 = b as (MSCongruence of A) by A6;
thus ( B2 . (a,b) ) = ( b9 /\ a9 ) by A19
.= ( B2 . (b,a) ) by A19;
end;
A29: (for a,b being (Element of L) holds ( a "/\" b ) = ( b "/\" a ))
proof
let a being (Element of L);
let b being (Element of L);
thus ( a "/\" b ) = ( B2 . (a,b) ) by LATTICES:def 2
.= ( (the L_meet of L) . (b,a) ) by A28
.= ( b "/\" a ) by LATTICES:def 2;
end;
A30: (for a,b being (Element of L) holds ( a "/\" ( a "\/" b ) ) = a)
proof
let a being (Element of L);
let b being (Element of L);
A31: ( B2 . (a,( B1 . (a,b) )) ) = a
proof
reconsider a9 = a,b9 = b as (MSCongruence of A) by A6;
reconsider d = ( a9 "\/" b9 ) as (MSCongruence of A) by CKB23:1;
thus ( B2 . (a,( B1 . (a,b) )) ) = ( B2 . (a,d) ) by A19
.= ( a9 /\ ( a9 "\/" b9 ) ) by A19
.= a by CKB15:1;
end;
thus ( a "/\" ( a "\/" b ) ) = ( (the L_meet of L) . (a,( a "\/" b )) ) by LATTICES:def 2
.= a by A31,LATTICES:def 1;
end;
(for a,b being (Element of L) holds ( ( a "/\" b ) "\/" b ) = b)
proof
let a being (Element of L);
let b being (Element of L);
A32: ( B1 . (( B2 . (a,b) ),b) ) = b
proof
reconsider a9 = a,b9 = b as (MSCongruence of A) by A6;
reconsider EQR = ( a9 /\ b9 ) as (MSCongruence of A) by CKB24:1;
thus ( B1 . (( B2 . (a,b) ),b) ) = ( B1 . (( a9 /\ b9 ),b9) ) by A19
.= ( EQR "\/" b9 ) by A19
.= b by CKB16:1;
end;
thus ( ( a "/\" b ) "\/" b ) = ( (the L_join of L) . (( a "/\" b ),b) ) by LATTICES:def 1
.= b by A32,LATTICES:def 2;
end;
then L is  join-commutative  join-associative  meet-absorbing  meet-commutative  meet-associative  join-absorbing by A23,A27,A29,A25,A30,LATTICES:def 4,LATTICES:def 5,LATTICES:def 6,LATTICES:def 7,LATTICES:def 8,LATTICES:def 9;
then reconsider L as Lattice;
reconsider L as  strict (SubLattice of ( EqRelLatt (the Sorts of A) )) by A8,NAT_LAT:def 12;
take L;
thus thesis by A6;
end;
uniqueness
proof
let C1 being  strict (SubLattice of ( EqRelLatt (the Sorts of A) ));
let C2 being  strict (SubLattice of ( EqRelLatt (the Sorts of A) ));
assume that
A33: (for x being set holds (x in (the carrier of C1) iff x is (MSCongruence of A)))
and
A34: (for x being set holds (x in (the carrier of C2) iff x is (MSCongruence of A)));
A35:now
let x being set;
(x in (the carrier of C2) iff x is (MSCongruence of A)) by A34;
hence (x in (the carrier of C1) iff x in (the carrier of C2)) by A33;
end;
then A36: (the carrier of C1) = (the carrier of C2) by TARSKI:1;
then A37: (the L_join of C1) = ( (the L_join of ( EqRelLatt (the Sorts of A) )) || (the carrier of C2) ) by NAT_LAT:def 12
.= (the L_join of C2) by NAT_LAT:def 12;
(the L_meet of C1) = ( (the L_meet of ( EqRelLatt (the Sorts of A) )) || (the carrier of C2) ) by A36,NAT_LAT:def 12
.= (the L_meet of C2) by NAT_LAT:def 12;
hence thesis by A35,A37,TARSKI:1;
end;
end;
