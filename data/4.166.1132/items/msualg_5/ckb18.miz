environ
vocabularies NUMBERS,PBOOLE,RELAT_1,EQREL_1,TARSKI,XBOOLE_0,STRUCT_0,LATTICES,FUNCT_1,SUBSET_1,BINOP_1,MSUALG_4,ZFMISC_1,CARD_3,MSUALG_1,FINSEQ_1,MARGREL1,PARTFUN1,ARYTM_3,ORDINAL4,NAT_1,XXREAL_0,CARD_1,RELAT_2,ARYTM_1,NAT_LAT,REALSET1,XXREAL_2,MSUALG_5;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,RELAT_2,FUNCT_1,REALSET1,NUMBERS,XCMPLX_0,FINSEQ_2,STRUCT_0,PARTFUN1,FUNCT_2,RELSET_1,EQREL_1,BINOP_1,PBOOLE,MSUALG_1,MSUALG_3,MSUALG_4,LATTICES,NAT_LAT,CARD_3,FINSEQ_1,NAT_1,XXREAL_0,CKB1,CKB4,CKB6,CKB7,CKB9;
definitions PBOOLE,BINOP_1,REALSET1,EQREL_1,FUNCOP_1,CKB1,CKB4,CKB7,CKB9;
theorems BINOP_1,PBOOLE,MSUALG_4,EQREL_1,TARSKI,NAT_LAT,LATTICES,RELAT_1,RELAT_2,FUNCT_2,CARD_3,ZFMISC_1,MSUALG_1,FUNCT_1,MSUALG_3,FINSEQ_1,NAT_1,MSAFREE2,XBOOLE_0,XBOOLE_1,FINSEQ_3,XCMPLX_1,ORDERS_1,XREAL_1,XXREAL_0,PARTFUN1,FUNCOP_1,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17;
schemes PBOOLE,BINOP_1,NAT_1,FINSEQ_1,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,PARTFUN1,XREAL_0,NAT_1,FINSEQ_1,EQREL_1,PBOOLE,STRUCT_0,LATTICES,NAT_LAT,PRALG_1,MSUALG_1,MSUALG_3,MSUALG_4,ORDINAL1,CARD_1,CKB5;
constructors BINOP_1,XXREAL_0,NAT_1,NAT_D,EQREL_1,REALSET1,NAT_LAT,MSUALG_3,MSUALG_4,RELSET_1,PRALG_2,FUNCOP_1,FINSEQ_2,CKB1,CKB4,CKB7,CKB9;
requirements NUMERALS,REAL,BOOLE,SUBSET;
begin
definition
let I being non empty set;
let M being (ManySortedSet of I);
func EqRelLatt M ->  strict Lattice
means
:Def5: ((for x being set holds (x in (the carrier of it) iff x is (Equivalence_Relation of M))) & (for x,y being (Equivalence_Relation of M) holds (( (the L_meet of it) . (x,y) ) = ( x /\ y ) & ( (the L_join of it) . (x,y) ) = ( x "\/" y ))));
existence
proof
set f = the (Equivalence_Relation of M);
defpred P[ set ]
 means
$1 is (Equivalence_Relation of M);
deffunc F((Element of I)) = ( bool [: ( M . $1 ),( M . $1 ) :] );
consider M2 being (ManySortedSet of I) such that A1: (for i being (Element of I) holds ( M2 . i ) = F(i)) from PBOOLE:sch 5;
consider B being set such that A2: (for x being set holds (x in B iff (x in ( product M2 ) & P[ x ]))) from XBOOLE_0:sch 1;
A3: (for EqR being (Equivalence_Relation of M) holds EqR in ( product M2 ))
proof
let EqR being (Equivalence_Relation of M);
A4: (for x being set holds (x in ( dom M2 ) implies ( EqR . x ) in ( M2 . x )))
proof
let x being set;
assume x in ( dom M2 );
then reconsider x9 = x as (Element of I) by PARTFUN1:def 2;
A5: ( EqR . x9 ) is (Subset of [: ( M . x9 ),( M . x9 ) :]);
( M2 . x9 ) = ( bool [: ( M . x9 ),( M . x9 ) :] ) by A1;
hence thesis by A5;
end;
( dom EqR ) = I by PARTFUN1:def 2
.= ( dom M2 ) by PARTFUN1:def 2;
hence thesis by A4,CARD_3:9;
end;
then f in ( product M2 );
then reconsider B as non empty set by A2;
defpred Z[ (Element of B),(Element of B),(Element of B) ]
 means
(for x1,y1 being (Equivalence_Relation of M) holds ((x1 = $1 & y1 = $2) implies (ex EqR3 being (ManySortedRelation of M) st (EqR3 = ( x1 \/ y1 ) & $3 = ( EqCl EqR3 )))));
A6: (for x,y being (Element of B) holds (ex z being (Element of B) st Z[ x,y,z ]))
proof
let x being (Element of B),y being (Element of B);
reconsider x9 = x,y9 = y as (Equivalence_Relation of M) by A2;
set z = ( x9 "\/" y9 );
z in ( product M2 ) by A3;
then reconsider z as (Element of B) by A2;
take z;
let x1 being (Equivalence_Relation of M),y1 being (Equivalence_Relation of M);
assume that
A7: x1 = x
and
A8: y1 = y;
thus thesis by A7,A8,CKB9:def 1;
end;
consider B1 being (BinOp of B) such that A9: (for x,y being (Element of B) holds Z[ x,y,( B1 . (x,y) ) ]) from BINOP_1:sch 3(A6);
defpred Q[ (Element of B),(Element of B),(Element of B) ]
 means
(for x1,y1 being (Equivalence_Relation of M) holds ((x1 = $1 & y1 = $2) implies $3 = ( x1 /\ y1 )));
A10: (for x,y being (Element of B) holds (ex z being (Element of B) st Q[ x,y,z ]))
proof
let x being (Element of B),y being (Element of B);
reconsider x9 = x,y9 = y as (Equivalence_Relation of M) by A2;
set z = ( x9 /\ y9 );
(for i being set holds (i in I implies ( z . i ) is (Relation of ( M . i ))))
proof
let i being set;
assume i in I;
then reconsider i9 = i as (Element of I);
( z . i ) = ( ( x9 . i9 ) /\ ( y9 . i9 ) ) by PBOOLE:def 5;
hence thesis;
end;
then reconsider z as (ManySortedRelation of M) by MSUALG_4:def 1;
(for i being set holds (for R being (Relation of ( M . i )) holds ((i in I & ( z . i ) = R) implies R is (Equivalence_Relation of ( M . i )))))
proof
let i being set;
let R being (Relation of ( M . i ));
assume that
A11: i in I
and
A12: ( z . i ) = R;
reconsider i9 = i as (Element of I) by A11;
reconsider x199 = ( x9 . i9 ),y199 = ( y9 . i9 ) as (Relation of ( M . i ));
reconsider x99 = x199,y99 = y199 as (Equivalence_Relation of ( M . i )) by MSUALG_4:def 2;
R = ( x99 /\ y99 ) by A12,PBOOLE:def 5;
hence thesis;
end;
then reconsider z as (Equivalence_Relation of M) by MSUALG_4:def 2;
z in ( product M2 ) by A3;
then reconsider z as (Element of B) by A2;
take z;
thus thesis;
end;
consider B2 being (BinOp of B) such that A13: (for x,y being (Element of B) holds Q[ x,y,( B2 . (x,y) ) ]) from BINOP_1:sch 3(A10);
reconsider L = LattStr (# B,B1,B2 #) as non empty LattStr;
A14:now
let x being (Equivalence_Relation of M),y being (Equivalence_Relation of M);
A15: y in ( product M2 ) by A3;
x in ( product M2 ) by A3;
then reconsider x9 = x,y9 = y as (Element of B) by A2,A15;
(ex EqR3 being (ManySortedRelation of M) st (EqR3 = ( x \/ y ) & ( B1 . (x9,y9) ) = ( EqCl EqR3 ))) by A9;
hence ( B1 . (x,y) ) = ( x "\/" y ) by CKB9:def 1;
end;
A16:now
let a being (Element of B),b being (Element of B),c being (Element of B);
reconsider U1 = a,U2 = b,U3 = c as (Equivalence_Relation of M) by A2;
thus ( B1 . (a,( B1 . (b,c) )) ) = ( B1 . (a,( U2 "\/" U3 )) ) by A14
.= ( U1 "\/" ( U2 "\/" U3 ) ) by A14
.= ( ( U1 "\/" U2 ) "\/" U3 ) by CKB14:1
.= ( B1 . (( U1 "\/" U2 ),c) ) by A14
.= ( B1 . (( B1 . (a,b) ),c) ) by A14;
end;
A17: (for a,b,c being (Element of L) holds ( a "\/" ( b "\/" c ) ) = ( ( a "\/" b ) "\/" c ))
proof
let a being (Element of L),b being (Element of L),c being (Element of L);
reconsider x = a,y = b,z = c as (Element of B);
A18: ( (the L_join of L) . (a,b) ) = ( a "\/" b ) by LATTICES:def 1;
thus ( a "\/" ( b "\/" c ) ) = ( (the L_join of L) . (a,( b "\/" c )) ) by LATTICES:def 1
.= ( B1 . (x,( B1 . (y,z) )) ) by LATTICES:def 1
.= ( (the L_join of L) . (( (the L_join of L) . (a,b) ),c) ) by A16
.= ( ( a "\/" b ) "\/" c ) by A18,LATTICES:def 1;
end;
A19:now
let x being (Equivalence_Relation of M),y being (Equivalence_Relation of M);
A20: y in ( product M2 ) by A3;
x in ( product M2 ) by A3;
then reconsider x9 = x,y9 = y as (Element of B) by A2,A20;
A21: y9 = y;
x9 = x;
hence ( B2 . (x,y) ) = ( x /\ y ) by A13,A21;
end;
A22:now
let a being (Element of B),b being (Element of B),c being (Element of B);
reconsider U1 = a,U2 = b,U3 = c as (Equivalence_Relation of M) by A2;
reconsider EQR1 = ( U2 /\ U3 ) as (Equivalence_Relation of M) by CKB17:1;
reconsider EQR2 = ( U1 /\ U2 ) as (Equivalence_Relation of M) by CKB17:1;
thus ( B2 . (a,( B2 . (b,c) )) ) = ( B2 . (a,EQR1) ) by A19
.= ( U1 /\ ( U2 /\ U3 ) ) by A19
.= ( ( U1 /\ U2 ) /\ U3 ) by PBOOLE:29
.= ( B2 . (EQR2,c) ) by A19
.= ( B2 . (( B2 . (a,b) ),c) ) by A19;
end;
A23: (for a,b,c being (Element of L) holds ( a "/\" ( b "/\" c ) ) = ( ( a "/\" b ) "/\" c ))
proof
let a being (Element of L),b being (Element of L),c being (Element of L);
reconsider x = a,y = b,z = c as (Element of B);
A24: ( (the L_meet of L) . (a,b) ) = ( a "/\" b ) by LATTICES:def 2;
thus ( a "/\" ( b "/\" c ) ) = ( (the L_meet of L) . (a,( b "/\" c )) ) by LATTICES:def 2
.= ( B2 . (x,( B2 . (y,z) )) ) by LATTICES:def 2
.= ( (the L_meet of L) . (( (the L_meet of L) . (a,b) ),c) ) by A22
.= ( ( a "/\" b ) "/\" c ) by A24,LATTICES:def 2;
end;
A25:now
let a being (Element of B),b being (Element of B);
reconsider U1 = a,U2 = b as (Equivalence_Relation of M) by A2;
thus ( B1 . (a,b) ) = ( U1 "\/" U2 ) by A14
.= ( B1 . (b,a) ) by A14;
end;
A26: (for a,b being (Element of L) holds ( a "\/" b ) = ( b "\/" a ))
proof
let a being (Element of L),b being (Element of L);
reconsider x = a,y = b as (Element of B);
thus ( a "\/" b ) = ( B1 . (x,y) ) by LATTICES:def 1
.= ( (the L_join of L) . (b,a) ) by A25
.= ( b "\/" a ) by LATTICES:def 1;
end;
A27: (for a,b being (Element of L) holds ( ( a "/\" b ) "\/" b ) = b)
proof
let a being (Element of L),b being (Element of L);
reconsider x = a,y = b as (Element of B);
A28: ( B1 . (( B2 . (x,y) ),y) ) = y
proof
reconsider U1 = x,U2 = y as (Equivalence_Relation of M) by A2;
reconsider EQR = ( U1 /\ U2 ) as (Equivalence_Relation of M) by CKB17:1;
( B2 . (x,y) ) = ( U1 /\ U2 ) by A19;
hence ( B1 . (( B2 . (x,y) ),y) ) = ( EQR "\/" U2 ) by A14
.= y by CKB16:1;
end;
thus ( ( a "/\" b ) "\/" b ) = ( (the L_join of L) . (( a "/\" b ),b) ) by LATTICES:def 1
.= b by A28,LATTICES:def 2;
end;
A29:now
let a being (Element of B),b being (Element of B);
reconsider U1 = a,U2 = b as (Equivalence_Relation of M) by A2;
thus ( B2 . (a,b) ) = ( U2 /\ U1 ) by A19
.= ( B2 . (b,a) ) by A19;
end;
A30: (for a,b being (Element of L) holds ( a "/\" b ) = ( b "/\" a ))
proof
let a being (Element of L),b being (Element of L);
reconsider x = a,y = b as (Element of B);
thus ( a "/\" b ) = ( B2 . (x,y) ) by LATTICES:def 2
.= ( (the L_meet of L) . (b,a) ) by A29
.= ( b "/\" a ) by LATTICES:def 2;
end;
(for a,b being (Element of L) holds ( a "/\" ( a "\/" b ) ) = a)
proof
let a being (Element of L),b being (Element of L);
reconsider x = a,y = b as (Element of B);
A31: ( B2 . (x,( B1 . (x,y) )) ) = x
proof
reconsider U1 = x,U2 = y as (Equivalence_Relation of M) by A2;
( B1 . (x,y) ) = ( U1 "\/" U2 ) by A14;
hence ( B2 . (x,( B1 . (x,y) )) ) = ( U1 /\ ( U1 "\/" U2 ) ) by A19
.= x by CKB15:1;
end;
thus ( a "/\" ( a "\/" b ) ) = ( (the L_meet of L) . (a,( a "\/" b )) ) by LATTICES:def 2
.= a by A31,LATTICES:def 1;
end;
then L is  join-commutative  join-associative  meet-absorbing  meet-commutative  meet-associative  join-absorbing by A26,A17,A27,A30,A23,LATTICES:def 4,LATTICES:def 5,LATTICES:def 6,LATTICES:def 7,LATTICES:def 8,LATTICES:def 9;
then reconsider L as  strict Lattice;
take L;
thus (for x being set holds (x in (the carrier of L) iff x is (Equivalence_Relation of M)))
proof
let x being set;
thus (x in (the carrier of L) implies x is (Equivalence_Relation of M)) by A2;
thus (x is (Equivalence_Relation of M) implies x in (the carrier of L))
proof
assume A32: x is (Equivalence_Relation of M);
then x in ( product M2 ) by A3;
hence thesis by A2,A32;
end;

end;

thus thesis by A14,A19;
end;
uniqueness
proof
let S1 being  strict Lattice,S2 being  strict Lattice;
assume that
A33: (for x being set holds (x in (the carrier of S1) iff x is (Equivalence_Relation of M)))
and
A34: (for x,y being (Equivalence_Relation of M) holds (( (the L_meet of S1) . (x,y) ) = ( x /\ y ) & ( (the L_join of S1) . (x,y) ) = ( x "\/" y )))
and
A35: (for x being set holds (x in (the carrier of S2) iff x is (Equivalence_Relation of M)))
and
A36: (for x,y being (Equivalence_Relation of M) holds (( (the L_meet of S2) . (x,y) ) = ( x /\ y ) & ( (the L_join of S2) . (x,y) ) = ( x "\/" y )));
reconsider Z = (the carrier of S1) as non empty set;
now
let x being set;
(x is (Equivalence_Relation of M) iff x in (the carrier of S2)) by A35;
hence (x in (the carrier of S1) iff x in (the carrier of S2)) by A33;
end;
then A37: (the carrier of S1) = (the carrier of S2) by TARSKI:1;
A38:now
let x being (Element of Z),y being (Element of Z);
reconsider x1 = x,y1 = y as (Equivalence_Relation of M) by A33;
thus ( (the L_meet of S1) . (x,y) ) = ( x1 /\ y1 ) by A34
.= ( (the L_meet of S2) . (x,y) ) by A36;
thus ( (the L_join of S1) . (x,y) ) = ( x1 "\/" y1 ) by A34
.= ( (the L_join of S2) . (x,y) ) by A36;
end;
then (the L_meet of S1) = (the L_meet of S2) by A37,BINOP_1:2;
hence thesis by A37,A38,BINOP_1:2;
end;
end;
