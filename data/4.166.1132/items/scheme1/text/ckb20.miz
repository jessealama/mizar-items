environ
vocabularies NUMBERS,SUBSET_1,REAL_1,RELAT_1,ARYTM_3,INT_1,CARD_1,XXREAL_0,SEQ_1,VALUED_0,FUNCT_1,NAT_1,TARSKI,ORDINAL2,ARYTM_1,XBOOLE_0,PARTFUN1,ZFMISC_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,REAL_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,VALUED_0,SEQ_1,XXREAL_0,RECDEF_1;
definitions TARSKI,XBOOLE_0;
theorems ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,SEQM_3,PARTFUN1,RELSET_1,XBOOLE_1,NAT_D,ORDINAL1,XXREAL_0,CKB1,CKB2,CKB3,CKB4;
schemes NAT_1,FUNCT_2,RECDEF_1,SUBSET_1,CLASSES1,XBOOLE_0,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19;
registrations ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,SEQM_3,VALUED_0;
constructors PARTFUN1,XXREAL_0,NAT_1,NAT_D,SEQ_1,SEQM_3,RECDEF_1,MEMBERED,RELSET_1;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve z for set;
scheme PartFuncExCD3 { C,D,E() -> non empty set,P,Q,R[set,set],F,G,H(set,set) -> (Element of E()) } : (ex f being (PartFunc of [: C(),D() :],E()) st ((for c being (Element of C()) holds (for d being (Element of D()) holds ([ c,d ] in ( dom f ) iff ((P[ c,d ] or Q[ c,d ]) or R[ c,d ])))) & (for c being (Element of C()) holds (for r being (Element of D()) holds ([ c,r ] in ( dom f ) implies (((P[ c,r ] implies ( f . [ c,r ] ) = F(c,r)) & (Q[ c,r ] implies ( f . [ c,r ] ) = G(c,r))) & (R[ c,r ] implies ( f . [ c,r ] ) = H(c,r))))))))
provided
A1: (for c being (Element of C()) holds (for s being (Element of D()) holds (((P[ c,s ] implies (not Q[ c,s ])) & (P[ c,s ] implies (not R[ c,s ]))) & (Q[ c,s ] implies (not R[ c,s ])))))
proof
defpred X[ set,set ]
 means
(for c being (Element of C()) holds (for t being (Element of D()) holds ($1 = [ c,t ] implies (((P[ c,t ] implies $2 = F(c,t)) & (Q[ c,t ] implies $2 = G(c,t))) & (R[ c,t ] implies $2 = H(c,t))))));
defpred X[ set ]
 means
(for c being (Element of C()) holds (for d being (Element of D()) holds ($1 = [ c,d ] implies ((P[ c,d ] or Q[ c,d ]) or R[ c,d ]))));
consider T being set such that A2: (for z holds (z in T iff (z in [: C(),D() :] & X[ z ]))) from XBOOLE_0:sch 1;
A3: (for x1 being set holds (x1 in T implies (ex z st X[ x1,z ])))
proof
let x1 being set;
assume A4: x1 in T;
then x1 in [: C(),D() :] by A2;
then consider q9 being set,w9 being set such that A5: q9 in C() and A6: w9 in D() and A7: x1 = [ q9,w9 ] by ZFMISC_1:def 2;
reconsider w9 as (Element of D()) by A6;
reconsider q9 as (Element of C()) by A5;
now
per cases  by A2,A4,A7;
suppose A8: P[ q9,w9 ];

take z = F(q9,w9);
let c being (Element of C());
let d being (Element of D());
assume x1 = [ c,d ];
then (q9 = c & w9 = d) by A7,ZFMISC_1:27;
hence (((P[ c,d ] implies z = F(c,d)) & (Q[ c,d ] implies z = G(c,d))) & (R[ c,d ] implies z = H(c,d))) by A1,A8;
end;
suppose A9: Q[ q9,w9 ];

take z = G(q9,w9);
let c being (Element of C());
let d being (Element of D());
assume x1 = [ c,d ];
then (q9 = c & w9 = d) by A7,ZFMISC_1:27;
hence (((P[ c,d ] implies z = F(c,d)) & (Q[ c,d ] implies z = G(c,d))) & (R[ c,d ] implies z = H(c,d))) by A1,A9;
end;
suppose A10: R[ q9,w9 ];

take z = H(q9,w9);
let c being (Element of C());
let d being (Element of D());
assume x1 = [ c,d ];
then (q9 = c & w9 = d) by A7,ZFMISC_1:27;
hence (((P[ c,d ] implies z = F(c,d)) & (Q[ c,d ] implies z = G(c,d))) & (R[ c,d ] implies z = H(c,d))) by A1,A10;
end;
end;
hence thesis;
end;
consider f being Function such that A11: (( dom f ) = T & (for z holds (z in T implies X[ z,( f . z ) ]))) from CLASSES1:sch 1(A3);
A12: ( rng f ) c= E()
proof
let z;
assume z in ( rng f );
then consider x1 being set such that A13: x1 in ( dom f ) and A14: z = ( f . x1 ) by FUNCT_1:def 3;
x1 in [: C(),D() :] by A2,A11,A13;
then consider x,y such that A15: x in C() and A16: y in D() and A17: x1 = [ x,y ] by ZFMISC_1:def 2;
reconsider y as (Element of D()) by A16;
reconsider x as (Element of C()) by A15;
now
per cases  by A2,A11,A13,A17;
suppose P[ x,y ];

then ( f . [ x,y ] ) = F(x,y) by A11,A13,A17;
hence thesis by A14,A17;
end;
suppose Q[ x,y ];

then ( f . [ x,y ] ) = G(x,y) by A11,A13,A17;
hence thesis by A14,A17;
end;
suppose R[ x,y ];

then ( f . [ x,y ] ) = H(x,y) by A11,A13,A17;
hence thesis by A14,A17;
end;
end;
hence thesis;
end;
T c= [: C(),D() :]
proof
let z;
assume z in T;
hence thesis by A2;
end;
then reconsider f as (PartFunc of [: C(),D() :],E()) by A11,A12,RELSET_1:4;
take f;
thus (for c being (Element of C()) holds (for d being (Element of D()) holds ([ c,d ] in ( dom f ) iff ((P[ c,d ] or Q[ c,d ]) or R[ c,d ]))))
proof
let c being (Element of C());
let d being (Element of D());
thus ([ c,d ] in ( dom f ) implies ((P[ c,d ] or Q[ c,d ]) or R[ c,d ])) by A2,A11;
assume A18: ((P[ c,d ] or Q[ c,d ]) or R[ c,d ]);
A19:now
let i9 being (Element of C());
let o9 being (Element of D());
assume A20: [ c,d ] = [ i9,o9 ];
then c = i9 by ZFMISC_1:27;
hence ((P[ i9,o9 ] or Q[ i9,o9 ]) or R[ i9,o9 ]) by A18,A20,ZFMISC_1:27;
end;
[ c,d ] in [: C(),D() :] by ZFMISC_1:87;
hence thesis by A2,A11,A19;
end;

let c being (Element of C());
let d being (Element of D());
assume [ c,d ] in ( dom f );
hence thesis by A11;
end;
