environ
vocabularies NUMBERS,SUBSET_1,REAL_1,RELAT_1,ARYTM_3,INT_1,CARD_1,XXREAL_0,SEQ_1,VALUED_0,FUNCT_1,NAT_1,TARSKI,ORDINAL2,ARYTM_1,XBOOLE_0,PARTFUN1,ZFMISC_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,REAL_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,VALUED_0,SEQ_1,XXREAL_0,RECDEF_1;
definitions TARSKI,XBOOLE_0;
theorems ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,SEQM_3,PARTFUN1,RELSET_1,XBOOLE_1,NAT_D,ORDINAL1,XXREAL_0,CKB1,CKB2,CKB3,CKB4;
schemes NAT_1,FUNCT_2,RECDEF_1,SUBSET_1,CLASSES1,XBOOLE_0,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20;
registrations ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,SEQM_3,VALUED_0;
constructors PARTFUN1,XXREAL_0,NAT_1,NAT_D,SEQ_1,SEQM_3,RECDEF_1,MEMBERED,RELSET_1;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve z for set;
scheme PartFuncExCS2 { X,Y,Z() -> set,P,Q[set,set],F,G(set,set) -> set } : (ex f being (PartFunc of [: X(),Y() :],Z()) st ((for x holds (for y holds ([ x,y ] in ( dom f ) iff ((x in X() & y in Y()) & (P[ x,y ] or Q[ x,y ]))))) & (for x holds (for y holds ([ x,y ] in ( dom f ) implies ((P[ x,y ] implies ( f . [ x,y ] ) = F(x,y)) & (Q[ x,y ] implies ( f . [ x,y ] ) = G(x,y))))))))
provided
A1: (for x holds (for y holds ((x in X() & y in Y()) implies (P[ x,y ] implies (not Q[ x,y ])))))
and
A2: (for x holds (for y holds (((x in X() & y in Y()) & P[ x,y ]) implies F(x,y) in Z())))
and
A3: (for x holds (for y holds (((x in X() & y in Y()) & Q[ x,y ]) implies G(x,y) in Z())))
proof
defpred X[ set,set ]
 means
(for x holds (for y holds ($1 = [ x,y ] implies ((P[ x,y ] implies $2 = F(x,y)) & (Q[ x,y ] implies $2 = G(x,y))))));
defpred X[ set ]
 means
(for x holds (for y holds ($1 = [ x,y ] implies (P[ x,y ] or Q[ x,y ]))));
consider K being set such that A4: (for z holds (z in K iff (z in [: X(),Y() :] & X[ z ]))) from XBOOLE_0:sch 1;
A5: (for x1 being set holds (x1 in K implies (ex z st X[ x1,z ])))
proof
let x1 being set;
assume A6: x1 in K;
then x1 in [: X(),Y() :] by A4;
then consider n9,m9 being set such that A7: (n9 in X() & m9 in Y()) and A8: x1 = [ n9,m9 ] by ZFMISC_1:def 2;
now
per cases  by A4,A6,A8;
suppose A9: P[ n9,m9 ];

take z = F(n9,m9);
let x;
let y;
assume x1 = [ x,y ];
then (n9 = x & m9 = y) by A8,ZFMISC_1:27;
hence ((P[ x,y ] implies z = F(x,y)) & (Q[ x,y ] implies z = G(x,y))) by A1,A7,A9;
end;
suppose A10: Q[ n9,m9 ];

take z = G(n9,m9);
let x;
let y;
assume x1 = [ x,y ];
then (n9 = x & m9 = y) by A8,ZFMISC_1:27;
hence ((P[ x,y ] implies z = F(x,y)) & (Q[ x,y ] implies z = G(x,y))) by A1,A7,A10;
end;
end;
hence thesis;
end;
consider f being Function such that A11: (( dom f ) = K & (for z holds (z in K implies X[ z,( f . z ) ]))) from CLASSES1:sch 1(A5);
A12: ( rng f ) c= Z()
proof
let z;
assume z in ( rng f );
then consider x1 being set such that A13: x1 in ( dom f ) and A14: z = ( f . x1 ) by FUNCT_1:def 3;
x1 in [: X(),Y() :] by A4,A11,A13;
then consider x,y such that A15: (x in X() & y in Y()) and A16: x1 = [ x,y ] by ZFMISC_1:def 2;
now
per cases  by A4,A11,A13,A16;
suppose A17: P[ x,y ];

then ( f . [ x,y ] ) = F(x,y) by A11,A13,A16;
hence thesis by A2,A14,A15,A16,A17;
end;
suppose A18: Q[ x,y ];

then ( f . [ x,y ] ) = G(x,y) by A11,A13,A16;
hence thesis by A3,A14,A15,A16,A18;
end;
end;
hence thesis;
end;
K c= [: X(),Y() :]
proof
let z;
assume z in K;
hence thesis by A4;
end;
then reconsider f as (PartFunc of [: X(),Y() :],Z()) by A11,A12,RELSET_1:4;
take f;
thus (for x holds (for y holds ([ x,y ] in ( dom f ) iff ((x in X() & y in Y()) & (P[ x,y ] or Q[ x,y ])))))
proof
let x;
let y;
thus ([ x,y ] in ( dom f ) implies ((x in X() & y in Y()) & (P[ x,y ] or Q[ x,y ]))) by A4,A11,ZFMISC_1:87;
assume that
A19: (x in X() & y in Y())
and
A20: (P[ x,y ] or Q[ x,y ]);
A21:now
let z9 being set;
let q9 being set;
assume A22: [ x,y ] = [ z9,q9 ];
then x = z9 by ZFMISC_1:27;
hence (P[ z9,q9 ] or Q[ z9,q9 ]) by A20,A22,ZFMISC_1:27;
end;
[ x,y ] in [: X(),Y() :] by A19,ZFMISC_1:87;
hence thesis by A4,A11,A21;
end;

let x;
let y;
assume [ x,y ] in ( dom f );
hence thesis by A11;
end;
