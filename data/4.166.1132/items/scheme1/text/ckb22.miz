environ
vocabularies NUMBERS,SUBSET_1,REAL_1,RELAT_1,ARYTM_3,INT_1,CARD_1,XXREAL_0,SEQ_1,VALUED_0,FUNCT_1,NAT_1,TARSKI,ORDINAL2,ARYTM_1,XBOOLE_0,PARTFUN1,ZFMISC_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,REAL_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,VALUED_0,SEQ_1,XXREAL_0,RECDEF_1;
definitions TARSKI,XBOOLE_0;
theorems ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,SEQM_3,PARTFUN1,RELSET_1,XBOOLE_1,NAT_D,ORDINAL1,XXREAL_0,CKB1,CKB2,CKB3,CKB4;
schemes NAT_1,FUNCT_2,RECDEF_1,SUBSET_1,CLASSES1,XBOOLE_0,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21;
registrations ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,SEQM_3,VALUED_0;
constructors PARTFUN1,XXREAL_0,NAT_1,NAT_D,SEQ_1,SEQM_3,RECDEF_1,MEMBERED,RELSET_1;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve z for set;
scheme PartFuncExCS3 { X,Y,Z() -> set,P,Q,R[set,set],F,G,H(set,set) -> set } : (ex f being (PartFunc of [: X(),Y() :],Z()) st ((for x holds (for y holds ([ x,y ] in ( dom f ) iff ((x in X() & y in Y()) & ((P[ x,y ] or Q[ x,y ]) or R[ x,y ]))))) & (for x holds (for y holds ([ x,y ] in ( dom f ) implies (((P[ x,y ] implies ( f . [ x,y ] ) = F(x,y)) & (Q[ x,y ] implies ( f . [ x,y ] ) = G(x,y))) & (R[ x,y ] implies ( f . [ x,y ] ) = H(x,y))))))))
provided
A1: (for x holds (for y holds ((x in X() & y in Y()) implies (((P[ x,y ] implies (not Q[ x,y ])) & (P[ x,y ] implies (not R[ x,y ]))) & (Q[ x,y ] implies (not R[ x,y ]))))))
and
A2: (for x holds (for y holds ((x in X() & y in Y()) implies (P[ x,y ] implies F(x,y) in Z()))))
and
A3: (for x holds (for y holds ((x in X() & y in Y()) implies (Q[ x,y ] implies G(x,y) in Z()))))
and
A4: (for x holds (for y holds ((x in X() & y in Y()) implies (R[ x,y ] implies H(x,y) in Z()))))
proof
defpred X[ set,set ]
 means
(for x holds (for y holds ($1 = [ x,y ] implies (((P[ x,y ] implies $2 = F(x,y)) & (Q[ x,y ] implies $2 = G(x,y))) & (R[ x,y ] implies $2 = H(x,y))))));
defpred X[ set ]
 means
(for x holds (for y holds ($1 = [ x,y ] implies ((P[ x,y ] or Q[ x,y ]) or R[ x,y ]))));
consider L being set such that A5: (for z holds (z in L iff (z in [: X(),Y() :] & X[ z ]))) from XBOOLE_0:sch 1;
A6: (for x1 being set holds (x1 in L implies (ex z st X[ x1,z ])))
proof
let x1 being set;
assume A7: x1 in L;
then x1 in [: X(),Y() :] by A5;
then consider z9 being set,a9 being set such that A8: (z9 in X() & a9 in Y()) and A9: x1 = [ z9,a9 ] by ZFMISC_1:def 2;
now
per cases  by A5,A7,A9;
suppose A10: P[ z9,a9 ];

take z = F(z9,a9);
let x;
let y;
assume x1 = [ x,y ];
then (z9 = x & a9 = y) by A9,ZFMISC_1:27;
hence (((P[ x,y ] implies z = F(x,y)) & (Q[ x,y ] implies z = G(x,y))) & (R[ x,y ] implies z = H(x,y))) by A1,A8,A10;
end;
suppose A11: Q[ z9,a9 ];

take z = G(z9,a9);
let x;
let y;
assume x1 = [ x,y ];
then (z9 = x & a9 = y) by A9,ZFMISC_1:27;
hence (((P[ x,y ] implies z = F(x,y)) & (Q[ x,y ] implies z = G(x,y))) & (R[ x,y ] implies z = H(x,y))) by A1,A8,A11;
end;
suppose A12: R[ z9,a9 ];

take z = H(z9,a9);
let x;
let y;
assume x1 = [ x,y ];
then (z9 = x & a9 = y) by A9,ZFMISC_1:27;
hence (((P[ x,y ] implies z = F(x,y)) & (Q[ x,y ] implies z = G(x,y))) & (R[ x,y ] implies z = H(x,y))) by A1,A8,A12;
end;
end;
hence thesis;
end;
consider f being Function such that A13: (( dom f ) = L & (for z holds (z in L implies X[ z,( f . z ) ]))) from CLASSES1:sch 1(A6);
A14: ( rng f ) c= Z()
proof
let z;
assume z in ( rng f );
then consider x1 being set such that A15: x1 in ( dom f ) and A16: z = ( f . x1 ) by FUNCT_1:def 3;
x1 in [: X(),Y() :] by A5,A13,A15;
then consider x,y such that A17: (x in X() & y in Y()) and A18: x1 = [ x,y ] by ZFMISC_1:def 2;
now
per cases  by A5,A13,A15,A18;
suppose A19: P[ x,y ];

then ( f . [ x,y ] ) = F(x,y) by A13,A15,A18;
hence thesis by A2,A16,A17,A18,A19;
end;
suppose A20: Q[ x,y ];

then ( f . [ x,y ] ) = G(x,y) by A13,A15,A18;
hence thesis by A3,A16,A17,A18,A20;
end;
suppose A21: R[ x,y ];

then ( f . [ x,y ] ) = H(x,y) by A13,A15,A18;
hence thesis by A4,A16,A17,A18,A21;
end;
end;
hence thesis;
end;
L c= [: X(),Y() :]
proof
let z;
assume z in L;
hence thesis by A5;
end;
then reconsider f as (PartFunc of [: X(),Y() :],Z()) by A13,A14,RELSET_1:4;
take f;
thus (for x holds (for y holds ([ x,y ] in ( dom f ) iff ((x in X() & y in Y()) & ((P[ x,y ] or Q[ x,y ]) or R[ x,y ])))))
proof
let x;
let y;
thus ([ x,y ] in ( dom f ) implies ((x in X() & y in Y()) & ((P[ x,y ] or Q[ x,y ]) or R[ x,y ]))) by A5,A13,ZFMISC_1:87;
assume that
A22: (x in X() & y in Y())
and
A23: ((P[ x,y ] or Q[ x,y ]) or R[ x,y ]);
A24:now
let f9 being set,r9 being set;
assume A25: [ x,y ] = [ f9,r9 ];
then x = f9 by ZFMISC_1:27;
hence ((P[ f9,r9 ] or Q[ f9,r9 ]) or R[ f9,r9 ]) by A23,A25,ZFMISC_1:27;
end;
[ x,y ] in [: X(),Y() :] by A22,ZFMISC_1:87;
hence thesis by A5,A13,A24;
end;

let x;
let y;
assume [ x,y ] in ( dom f );
hence thesis by A13;
end;
