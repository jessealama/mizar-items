environ
vocabularies NUMBERS,SUBSET_1,REAL_1,RELAT_1,ARYTM_3,INT_1,CARD_1,XXREAL_0,SEQ_1,VALUED_0,FUNCT_1,NAT_1,TARSKI,ORDINAL2,ARYTM_1,XBOOLE_0,PARTFUN1,ZFMISC_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,REAL_1,NAT_1,NAT_D,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,VALUED_0,SEQ_1,XXREAL_0,RECDEF_1;
definitions TARSKI,XBOOLE_0;
theorems ZFMISC_1,NAT_1,FUNCT_1,FUNCT_2,SEQM_3,PARTFUN1,RELSET_1,XBOOLE_1,NAT_D,ORDINAL1,XXREAL_0,CKB1,CKB2,CKB3,CKB4;
schemes NAT_1,FUNCT_2,RECDEF_1,SUBSET_1,CLASSES1,XBOOLE_0;
registrations ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,SEQM_3,VALUED_0;
constructors PARTFUN1,XXREAL_0,NAT_1,NAT_D,SEQ_1,SEQM_3,RECDEF_1,MEMBERED,RELSET_1;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
reserve n for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve r for Real;
scheme ExRealSubseq { s() -> Real_Sequence,P[set] } : (ex q being Real_Sequence st ((q is (subsequence of s()) & (for n holds P[ ( q . n ) ])) & (for n holds ((for r holds (r = ( s() . n ) implies P[ r ])) implies (ex m st ( s() . n ) = ( q . m ))))))
provided
A1: (for n holds (ex m st (n <= m & P[ ( s() . m ) ])))
proof
defpred P[ set,set ]
 means
(for n holds (for m holds (($1 = n & $2 = m) implies ((n < m & P[ ( s() . m ) ]) & (for k holds ((n < k & P[ ( s() . k ) ]) implies m <= k))))));
defpred X[ set,set,set ]
 means
P[ $2,$3 ];
defpred X[ set ]
 means
P[ ( s() . $1 ) ];
(ex m1 being (Element of ( NAT )) st (( 0 ) <= m1 & P[ ( s() . m1 ) ])) by A1;
then A2: (ex m being Nat st X[ m ]);
consider M being Nat such that A3: (X[ M ] & (for n being Nat holds (X[ n ] implies M <= n))) from NAT_1:sch 5(A2);
reconsider M9 = M as (Element of ( NAT )) by ORDINAL1:def 12;
A4:now
let n;
consider m such that A5: (( n + 1 ) <= m & P[ ( s() . m ) ]) by A1;
take m;
thus (n < m & P[ ( s() . m ) ]) by A5,NAT_1:13;
end;
A6: (for n holds (for x being (Element of ( NAT )) holds (ex y being (Element of ( NAT )) st X[ n,x,y ])))
proof
let n;
let x being (Element of ( NAT ));
defpred X[ Nat ]
 means
(x < $1 & P[ ( s() . $1 ) ]);
(ex m being (Element of ( NAT )) st X[ m ]) by A4;
then A7: (ex m being Nat st X[ m ]);
consider l being Nat such that A8: (X[ l ] & (for k being Nat holds (X[ k ] implies l <= k))) from NAT_1:sch 5(A7);
reconsider l as (Element of ( NAT )) by ORDINAL1:def 12;
take l;
thus thesis by A8;
end;
consider F being (Function of ( NAT ),( NAT )) such that A9: (( F . ( 0 ) ) = M9 & (for n being (Element of ( NAT )) holds X[ n,( F . n ),( F . ( n + 1 ) ) ])) from RECDEF_1:sch 2(A6);
(( dom F ) = ( NAT ) & ( rng F ) c= ( REAL )) by FUNCT_2:def 1,XBOOLE_1:1;
then reconsider F as  natural-valued Real_Sequence by FUNCT_2:def 1,RELSET_1:4;
(for n holds ( F . n ) < ( F . ( n + 1 ) )) by A9;
then reconsider F as  increasing (sequence of ( NAT )) by SEQM_3:def 6;
A10: (for n holds (P[ ( s() . n ) ] implies (ex m st ( F . m ) = n)))
proof
defpred X[ set ]
 means
(P[ ( s() . $1 ) ] & (for m holds ( F . m ) <> $1));
assume (ex n st X[ n ]);
then A11: (ex n being Nat st X[ n ]);
consider M1 being Nat such that A12: (X[ M1 ] & (for n being Nat holds (X[ n ] implies M1 <= n))) from NAT_1:sch 5(A11);
defpred X[ Nat ]
 means
(($1 < M1 & P[ ( s() . $1 ) ]) & (ex m st ( F . m ) = $1));
A13: (ex n being Nat st X[ n ])
proof
take M;
(M <= M1 & M <> M1) by A3,A9,A12;
hence M < M1 by XXREAL_0:1;
thus P[ ( s() . M ) ] by A3;
take ( 0 );
thus thesis by A9;
end;
A14: (for n being Nat holds (X[ n ] implies n <= M1));
consider X being Nat such that A15: (X[ X ] & (for n being Nat holds (X[ n ] implies n <= X))) from NAT_1:sch 6(A14,A13);
A16: (for k holds ((X < k & k < M1) implies (not P[ ( s() . k ) ])))
proof
given k such that
A17: X < k
and
A18: (k < M1 & P[ ( s() . k ) ]);

now
per cases ;
suppose (ex m st ( F . m ) = k);

hence contradiction by A15,A17,A18;
end;
suppose (for m holds ( F . m ) <> k);

hence contradiction by A12,A18;
end;
end;
hence contradiction;
end;
consider m such that A19: ( F . m ) = X by A15;
A20: (X < ( F . ( m + 1 ) ) & P[ ( s() . ( F . ( m + 1 ) ) ) ]) by A9,A19;
M1 in ( NAT ) by ORDINAL1:def 12;
then A21: ( F . ( m + 1 ) ) <= M1 by A9,A12,A15,A19;
now
assume ( F . ( m + 1 ) ) <> M1;
then ( F . ( m + 1 ) ) < M1 by A21,XXREAL_0:1;
hence contradiction by A16,A20;
end;
hence contradiction by A12;
end;
take q = ( s() * F );
defpred X[ set ]
 means
P[ ( q . $1 ) ];
A22: (for k holds (X[ k ] implies X[ ( k + 1 ) ]))
proof
let k;
assume that
P[ ( q . k ) ];
P[ ( F . k ),( F . ( k + 1 ) ) ] by A9;
then P[ ( s() . ( F . ( k + 1 ) ) ) ];
hence thesis by FUNCT_2:15;
end;
thus q is (subsequence of s());
A23: X[ ( 0 ) ] by A3,A9,FUNCT_2:15;
thus (for n holds X[ n ]) from NAT_1:sch 1(A23,A22);
let n;
assume (for r holds (r = ( s() . n ) implies P[ r ]));
then consider m such that A24: ( F . m ) = n by A10;
take m;
thus thesis by A24,FUNCT_2:15;
end;
