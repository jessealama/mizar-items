environ
vocabularies XBOOLE_0,STRUCT_0,MSUALG_1,ALTCAT_1,MSALIMIT,SUBSET_1,FUNCT_1,CAT_1,RELAT_1,PBOOLE,ZFMISC_1,MCART_1,PUA2MSS1,RELAT_2,BINOP_1,TARSKI,MSUALG_6,FUNCT_2,PARTFUN1,NUMBERS,CARD_3,FUNCOP_1,PZFMISC1,MARGREL1,MEMBER_1,FUNCT_6,FINSEQ_4,MSUALG_3,MSINST_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,MCART_1,RELAT_1,FUNCT_1,STRUCT_0,FUNCT_2,MCART_2,RELSET_1,PARTFUN1,FINSEQ_2,CARD_3,BINOP_1,MULTOP_1,FUNCT_6,FUNCOP_1,PBOOLE,PZFMISC1,PRALG_1,MSUALG_1,MSUALG_3,ALTCAT_1,PRALG_2,PUA2MSS1,MSUALG_6,MSALIMIT,CKB1,CKB5,CKB11;
definitions ALTCAT_1,MSUALG_3,PBOOLE,TARSKI,XBOOLE_0,BINOP_1,CKB1,CKB5,CKB11;
theorems XBOOLE_0,ALTCAT_1,ALTCAT_2,AUTALG_1,CARD_3,CLOSURE1,FUNCOP_1,FUNCT_1,FUNCT_2,FUNCT_6,FUNCTOR0,MCART_1,MCART_2,MSSUBFAM,MSUALG_1,MSUALG_3,MSUALG_6,MSALIMIT,MULTOP_1,PARTFUN1,PBOOLE,PRALG_2,PUA2MSS1,RELAT_1,TARSKI,ZFMISC_1,PRALG_1,XBOOLE_1,PZFMISC1,FINSEQ_2,CKB1,CKB3,CKB5,CKB7,CKB8,CKB9,CKB10,CKB11;
schemes ALTCAT_1,MSSUBFAM,TARSKI;
registrations XBOOLE_0,SUBSET_1,FUNCT_1,RELSET_1,FUNCOP_1,RELAT_1,STRUCT_0,MSUALG_1,ALTCAT_1,MSUALG_6,MSALIMIT,MSSUBFAM,PBOOLE,CKB2,CKB4,CKB6;
constructors MCART_2,PZFMISC1,MSUALG_3,ALTCAT_1,PUA2MSS1,CLOSURE1,MSUALG_6,MSALIMIT,RELSET_1,CKB1,CKB5,CKB11;
requirements SUBSET,BOOLE;
begin
reserve A for non  empty set;
reserve S for non  void non  empty ManySortedSign;
reserve x for set;
definition
let S;
let A;
func MSAlgCat (S,A) ->  strict non  empty AltCatStr means 
:Def4: (((the carrier of it) = ( MSAlg_set (S,A) ) & (for i,j being (Element of ( MSAlg_set (S,A) )) holds ( (the Arrows of it) . (i,j) ) = ( MSAlg_morph (S,A,i,j) ))) & (for i,j,k being (object of it) holds (for f,g being  Function-yielding Function holds ((f in ( (the Arrows of it) . (i,j) ) & g in ( (the Arrows of it) . (j,k) )) implies ( ( (the Comp of it) . (i,j,k) ) . (g,f) ) = ( g ** f )))));
existence
proof
set c = ( MSAlg_set (S,A) );
deffunc F((Element of c),(Element of c)) = ( MSAlg_morph (S,A,$1,$2) );
consider M being (ManySortedSet of [: c,c :]) such that A1: (for i,j being (Element of c) holds ( M . (i,j) ) = F(i,j)) from ALTCAT_1:sch 2;
defpred P[ set,set,set ]
 means
(ex i,j,k being (Element of c) st ($3 = [ i,j,k ] & (for f,g being  Function-yielding Function holds (((f in ( M . (i,j) ) & g in ( M . (j,k) )) & $2 = [ g,f ]) implies $1 = ( g ** f )))));
A2: (for ijk being set holds (ijk in [: c,c,c :] implies (for x being set holds (x in ( {| M,M |} . ijk ) implies (ex y being set st (y in ( {| M |} . ijk ) & P[ y,x,ijk ]))))))
proof
let ijk being set;
assume ijk in [: c,c,c :];
then consider x1,x2,x3 being set such that A3: ((x1 in c & x2 in c) & x3 in c) and A4: ijk = [ x1,x2,x3 ] by MCART_1:68;
reconsider x1,x2,x3 as (Element of c) by A3;
let x being set;
A5: (( {| M,M |} . (x1,x2,x3) ) = ( {| M,M |} . [ x1,x2,x3 ] ) & ( {| M,M |} . (x1,x2,x3) ) = [: ( M . (x2,x3) ),( M . (x1,x2) ) :]) by ALTCAT_1:def 4,MULTOP_1:def 1;
A6: ( {| M |} . ijk ) = ( {| M |} . (x1,x2,x3) ) by A4,MULTOP_1:def 1;
assume A7: x in ( {| M,M |} . ijk );
then ( x `1 ) in ( M . (x2,x3) ) by A4,A5,MCART_1:10;
then ( x `1 ) in ( MSAlg_morph (S,A,x2,x3) ) by A1;
then consider M2,N2 being  strict  feasible MSAlgebra over S,g being (ManySortedFunction of M2,N2) such that A8: M2 = x2 and A9: N2 = x3 and A10: g = ( x `1 ) and A11: ((the Sorts of M2) is_transformable_to (the Sorts of N2) & g is_homomorphism M2,N2) by CKB11:def 1;
( x `2 ) in ( M . (x1,x2) ) by A4,A7,A5,MCART_1:10;
then ( x `2 ) in ( MSAlg_morph (S,A,x1,x2) ) by A1;
then consider M1,N1 being  strict  feasible MSAlgebra over S,f being (ManySortedFunction of M1,N1) such that A12: M1 = x1 and A13: N1 = x2 and A14: f = ( x `2 ) and A15: ((the Sorts of M1) is_transformable_to (the Sorts of N1) & f is_homomorphism M1,N1) by CKB11:def 1;
take y = ( g ** f );
reconsider f as (ManySortedFunction of M1,M2) by A8,A13;
((the Sorts of M1) is_transformable_to (the Sorts of N2) & (ex fg being (ManySortedFunction of M1,N2) st (fg = ( g ** f ) & fg is_homomorphism M1,N2))) by A8,A11,A13,A15,CKB10:1,AUTALG_1:10;
then (( {| M |} . (x1,x2,x3) ) = ( M . (x1,x3) ) & y in ( MSAlg_morph (S,A,x1,x3) )) by A9,A12,CKB11:def 1,ALTCAT_1:def 3;
hence y in ( {| M |} . ijk ) by A1,A6;
take x1;
take x2;
take x3;
thus ijk = [ x1,x2,x3 ] by A4;
let F being  Function-yielding Function;
let G being  Function-yielding Function;
assume that
F in ( M . (x1,x2) )
and
G in ( M . (x2,x3) )
and
A16: x = [ G,F ];
( x `1 ) = G by A16,MCART_1:7;
hence thesis by A10,A14,A16,MCART_1:7;
end;
consider F being (ManySortedFunction of {| M,M |},{| M |}) such that A17: (for ijk being set holds (ijk in [: c,c,c :] implies (ex f being (Function of ( {| M,M |} . ijk ),( {| M |} . ijk )) st (f = ( F . ijk ) & (for x being set holds (x in ( {| M,M |} . ijk ) implies P[ ( f . x ),x,ijk ])))))) from MSSUBFAM:sch 1(A2);
take EX = AltCatStr (# c,M,F #);
reconsider EX as non  empty AltCatStr;
(for i,j,k being (object of EX) holds (for f,g being  Function-yielding Function holds ((f in ( (the Arrows of EX) . (i,j) ) & g in ( (the Arrows of EX) . (j,k) )) implies ( ( (the Comp of EX) . (i,j,k) ) . (g,f) ) = ( g ** f ))))
proof
let i being (object of EX);
let j being (object of EX);
let k being (object of EX);
let f being  Function-yielding Function;
let g being  Function-yielding Function;
assume A18: (f in ( (the Arrows of EX) . (i,j) ) & g in ( (the Arrows of EX) . (j,k) ));
set x = [ g,f ];
set ijk = [ i,j,k ];
ijk in [: c,c,c :] by MCART_1:69;
then consider ff being (Function of ( {| M,M |} . ijk ),( {| M |} . ijk )) such that A19: ff = ( F . ijk ) and A20: (for x being set holds (x in ( {| M,M |} . ijk ) implies P[ ( ff . x ),x,ijk ])) by A17;
A21: ff = ( (the Comp of EX) . (i,j,k) ) by A19,MULTOP_1:def 1;
(( {| M,M |} . (i,j,k) ) = ( {| M,M |} . [ i,j,k ] ) & ( {| M,M |} . (i,j,k) ) = [: ( M . (j,k) ),( M . (i,j) ) :]) by ALTCAT_1:def 4,MULTOP_1:def 1;
then x in ( {| M,M |} . ijk ) by A18,ZFMISC_1:87;
then consider I,J,K being (Element of c) such that A22: ijk = [ I,J,K ] and A23: (for f,g being  Function-yielding Function holds (((f in ( M . (I,J) ) & g in ( M . (J,K) )) & x = [ g,f ]) implies ( ff . x ) = ( g ** f ))) by A20;
A24: K = k by A22,MCART_1:25;
(I = i & J = j) by A22,MCART_1:25;
hence thesis by A18,A23,A24,A21;
end;
hence thesis by A1;
end;
uniqueness
proof
reconsider c = ( MSAlg_set (S,A) ) as non  empty set;
let A1 being non  empty  strict AltCatStr;
let A2 being non  empty  strict AltCatStr;
assume that
A25: (the carrier of A1) = ( MSAlg_set (S,A) )
and
A26: (for i,j being (Element of ( MSAlg_set (S,A) )) holds ( (the Arrows of A1) . (i,j) ) = ( MSAlg_morph (S,A,i,j) ))
and
A27: (for i,j,k being (object of A1) holds (for f,g being  Function-yielding Function holds ((f in ( (the Arrows of A1) . (i,j) ) & g in ( (the Arrows of A1) . (j,k) )) implies ( ( (the Comp of A1) . (i,j,k) ) . (g,f) ) = ( g ** f ))))
and
A28: (the carrier of A2) = ( MSAlg_set (S,A) )
and
A29: (for i,j being (Element of ( MSAlg_set (S,A) )) holds ( (the Arrows of A2) . (i,j) ) = ( MSAlg_morph (S,A,i,j) ))
and
A30: (for i,j,k being (object of A2) holds (for f,g being  Function-yielding Function holds ((f in ( (the Arrows of A2) . (i,j) ) & g in ( (the Arrows of A2) . (j,k) )) implies ( ( (the Comp of A2) . (i,j,k) ) . (g,f) ) = ( g ** f ))));
reconsider CC1 = (the Comp of A1),CC2 = (the Comp of A2) as (ManySortedSet of [: c,c,c :]) by A25,A28;
reconsider AA1 = (the Arrows of A1),AA2 = (the Arrows of A2) as (ManySortedSet of [: c,c :]) by A25,A28;
A31:now
let i being (Element of c);
let j being (Element of c);
thus ( AA1 . (i,j) ) = ( MSAlg_morph (S,A,i,j) ) by A26
.= ( AA2 . (i,j) ) by A29;
end;
then A32: AA1 = AA2 by ALTCAT_1:7;
now
let i being set;
let j being set;
let k being set;
set ijk = [ i,j,k ];
A33: ( CC1 . (i,j,k) ) = ( CC1 . [ i,j,k ] ) by MULTOP_1:def 1;
assume A34: ((i in c & j in c) & k in c);
then reconsider i9 = i,j9 = j,k9 = k as (Element of c);
reconsider I9 = i,J9 = j,K9 = k as (object of A2) by A28,A34;
reconsider I = i,J = j,K = k as (object of A1) by A25,A34;
A35: ijk in [: c,c,c :] by A34,MCART_1:69;
A36: ( CC2 . (i,j,k) ) = ( CC2 . [ i,j,k ] ) by MULTOP_1:def 1;
thus ( CC1 . (i,j,k) ) = ( CC2 . (i,j,k) )
proof
reconsider Cj = ( CC2 . ijk ) as (Function of ( {| AA2,AA2 |} . ijk ),( {| AA2 |} . ijk )) by A28,A35,PBOOLE:def 15;
reconsider Ci = ( CC1 . ijk ) as (Function of ( {| AA1,AA1 |} . ijk ),( {| AA1 |} . ijk )) by A25,A35,PBOOLE:def 15;
per cases ;
suppose A37: ( {| AA1 |} . ijk ) <> ( {} );

A38: (for x being set holds (x in ( {| AA1,AA1 |} . ijk ) implies ( Ci . x ) = ( Cj . x )))
proof
let x being set;
assume A39: x in ( {| AA1,AA1 |} . ijk );
then x in ( {| AA1,AA1 |} . (i,j,k) ) by MULTOP_1:def 1;
then A40: x in [: ( AA1 . (j,k) ),( AA1 . (i,j) ) :] by A34,ALTCAT_1:def 4;
then A41: ( x `1 ) in ( AA1 . (j,k) ) by MCART_1:10;
then ( x `1 ) in ( MSAlg_morph (S,A,j9,k9) ) by A26;
then consider M2,N2 being  strict  feasible MSAlgebra over S,g being (ManySortedFunction of M2,N2) such that M2 = j9 and N2 = k9 and A42: g = ( x `1 ) and (the Sorts of M2) is_transformable_to (the Sorts of N2) and g is_homomorphism M2,N2 by CKB11:def 1;
x in ( {| AA2,AA2 |} . (i,j,k) ) by A32,A39,MULTOP_1:def 1;
then x in [: ( AA2 . (j,k) ),( AA2 . (i,j) ) :] by A34,ALTCAT_1:def 4;
then A43: (( x `1 ) in ( AA2 . (j,k) ) & ( x `2 ) in ( AA2 . (i,j) )) by MCART_1:10;
A44: ( x `2 ) in ( AA1 . (i,j) ) by A40,MCART_1:10;
then ( x `2 ) in ( MSAlg_morph (S,A,i9,j9) ) by A26;
then consider M1,N1 being  strict  feasible MSAlgebra over S,f being (ManySortedFunction of M1,N1) such that M1 = i9 and N1 = j9 and A45: f = ( x `2 ) and (the Sorts of M1) is_transformable_to (the Sorts of N1) and f is_homomorphism M1,N1 by CKB11:def 1;
A46: x = [ g,f ] by A40,A45,A42,MCART_1:21;
then ( Ci . x ) = ( ( (the Comp of A1) . (I,J,K) ) . (g,f) ) by MULTOP_1:def 1
.= ( g ** f ) by A27,A41,A44,A45,A42
.= ( ( (the Comp of A2) . (I9,J9,K9) ) . (g,f) ) by A30,A43,A45,A42
.= ( Cj . x ) by A46,MULTOP_1:def 1;
hence thesis;
end;
( {| AA2 |} . ijk ) <> ( {} ) by A31,A37,ALTCAT_1:7;
then A47: ( dom Cj ) = ( {| AA2,AA2 |} . ijk ) by FUNCT_2:def 1;
( dom Ci ) = ( {| AA1,AA1 |} . ijk ) by A37,FUNCT_2:def 1;
hence thesis by A32,A33,A36,A47,A38,FUNCT_1:2;
end;
suppose ( {| AA1 |} . ijk ) = ( {} );

then (Ci = ( {} ) & Cj = ( {} )) by A32;
hence thesis by A33,MULTOP_1:def 1;
end;
end;

end;
hence thesis by A25,A28,A32,ALTCAT_1:8;
end;
end;
