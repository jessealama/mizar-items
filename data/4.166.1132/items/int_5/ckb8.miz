environ
vocabularies NUMBERS,SUBSET_1,INT_1,NAT_1,FINSEQ_1,NEWTON,ARYTM_3,ARYTM_1,RELAT_1,CARD_1,FUNCT_1,CARD_3,FUNCOP_1,ORDINAL4,XBOOLE_0,TARSKI,XXREAL_0,FINSEQ_5,SQUARE_1,INT_2,COMPLEX1,ORDINAL1,ABIAN,FINSEQ_2,FUNCT_7,PARTFUN1,FINSET_1,RFINSEQ,CALCUL_2,REAL_1,ZFMISC_1,INT_5;
notations GROUP_4,INT_1,RVSUM_1,FINSET_1,ORDINAL1,CARD_1,NAT_D,INT_2,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,NAT_3,ABIAN,GR_CY_1,FINSEQ_5,FINSEQ_2,EULER_2,NEWTON,GOBRD10,FINSEQ_7,REAL_1,PEPIN,TARSKI,XBOOLE_0,SUBSET_1,XCMPLX_0,NUMBERS,XXREAL_0,NAT_1,DOMAIN_1,FINSEQ_1,RFINSEQ,FUNCOP_1,CALCUL_2,ZFMISC_1,CARD_3,WSIERP_1,BINOP_1,PROB_3,RECDEF_1,CKB4;
definitions INT_1,FUNCT_1,XCMPLX_0,SQUARE_1,FINSEQ_2,TARSKI,CALCUL_2,CARD_3,CKB4;
theorems FINSEQ_1,FINSEQ_7,RELAT_1,FINSEQ_3,FINSEQ_2,ABSVALUE,FINSEQ_5,EULER_2,INT_3,SEQ_2,FINSEQ_4,FUNCT_2,XBOOLE_0,NAT_3,NEWTON,INT_2,NAT_2,WSIERP_1,CARD_1,PEPIN,NAT_1,XCMPLX_1,XREAL_1,HEYTING3,ORDINAL1,EULER_1,XBOOLE_1,TARSKI,RVSUM_1,NUMBERS,INT_1,FUNCT_1,FUNCOP_1,XXREAL_0,NAT_D,HILBERT3,GOBRD10,SERIES_2,GRAPH_5,HILBERT2,RFINSEQ,ZFMISC_1,CARD_2,XREAL_0,FINSEQ_6,CALCUL_2,NAT_4,PROB_3,TOPREAL7,CARD_3,REAL_3,PRE_FF,INT_4,VALUED_1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7;
schemes NAT_1,FUNCT_2,RECDEF_1,FINSEQ_2,FUNCT_7,FINSEQ_1;
registrations XXREAL_0,MEMBERED,RELAT_1,FINSEQ_1,ORDINAL1,WSIERP_1,NUMBERS,XBOOLE_0,XREAL_0,NAT_1,INT_1,FINSET_1,NAT_3,RVSUM_1,FUNCT_1,CARD_1,NEWTON,SUBSET_1,VALUED_0,VALUED_1,FINSEQ_2,PRE_POLY,CARD_3,RELSET_1;
constructors BINARITH,ABIAN,WSIERP_1,PEPIN,UPROOTS,NAT_3,NAT_D,REALSET1,GR_CY_1,FINSEQ_5,GOBRD10,EULER_2,RFINSEQ,GROUP_4,FINSEQ_7,REAL_1,WELLORD2,CALCUL_2,SETFAM_1,PROB_3,SEQ_1,RECDEF_1,BINOP_1,BINOP_2,CLASSES1,RELSET_1,CKB4;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve d for Nat;
reserve n for Nat;
reserve fp for (FinSequence of ( INT ));
theorem
Th6: (( len fp ) = ( n + 2 ) implies (for a being Integer holds (ex fr being (FinSequence of ( INT )) st (ex r being Integer st ((( len fr ) = ( n + 1 ) & (for x being (Element of ( INT )) holds ( ( Poly-INT fp ) . x ) = ( ( ( x - a ) * ( ( Poly-INT fr ) . x ) ) + r ))) & ( fp . ( n + 2 ) ) = ( fr . ( n + 1 ) ))))))
proof
assume A1: ( len fp ) = ( n + 2 );
( ( n + 1 ) + 1 ) in ( Seg ( ( n + 1 ) + 1 ) ) by FINSEQ_1:4;
then ( n + 2 ) in ( dom fp ) by A1,FINSEQ_1:def 3;
then reconsider A = ( fp . ( n + 2 ) ) as (Element of ( INT )) by FINSEQ_2:11;
reconsider n1 = ( n + 1 ) as (Element of ( NAT ));
let a being Integer;
defpred P[ Nat,Integer,set ]
 means
$3 = ( ( fp . ( ( n + 2 ) - $1 ) ) + ( a * $2 ) );
A2: (for d being (Element of ( NAT )) holds ((1 <= d & d < n1) implies (for x being (Element of ( INT )) holds (ex y being (Element of ( INT )) st P[ d,x,y ]))))
proof
let d being (Element of ( NAT ));
assume that
1 <= d
and
d < n1;
let x being (Element of ( INT ));
set y = ( ( fp . ( ( n + 2 ) - d ) ) + ( a * x ) );
reconsider y as (Element of ( INT )) by INT_1:def 2;
take y;
thus thesis;
end;
consider p being (FinSequence of ( INT )) such that A3: ((( len p ) = n1 & (( p . 1 ) = A or n1 = ( 0 ))) & (for d being (Element of ( NAT )) holds ((1 <= d & d < n1) implies P[ d,( p . d ),( p . ( d + 1 ) ) ]))) from RECDEF_1:sch 4(A2);
take fr = ( Rev p );
take r = ( ( fp . 1 ) + ( a * ( fr . 1 ) ) );
A4: ( len fr ) = ( n + 1 ) by A3,FINSEQ_5:def 3;
(for x being (Element of ( INT )) holds ( ( Poly-INT fp ) . x ) = ( ( ( x - a ) * ( ( Poly-INT fr ) . x ) ) + r ))
proof
let x being (Element of ( INT ));
deffunc F(Nat) = ( ( fr . $1 ) * ( x |^ $1 ) );
deffunc FF(Nat) = ( ( a * ( fr . $1 ) ) * ( x |^ ( $1 -' 1 ) ) );
consider f1 being (FinSequence of ( INT )) such that A5: ( len f1 ) = ( len fp ) and A6: (for d holds (d in ( dom f1 ) implies ( f1 . d ) = ( ( fp . d ) * ( x |^ ( d -' 1 ) ) ))) and A7: ( ( Poly-INT fp ) . x ) = ( Sum f1 ) by CKB4:def 1;
A8: f1 <> ( {} ) by A1,A5;
then ( n + 2 ) in ( dom f1 ) by A1,A5,FINSEQ_5:6;
then ( f1 . ( n + 2 ) ) = ( ( fp . ( n + 2 ) ) * ( x |^ ( ( ( n + 1 ) + 1 ) -' 1 ) ) ) by A6;
then A9: ( f1 . ( n + 2 ) ) = ( ( fp . ( n + 2 ) ) * ( x |^ ( n + 1 ) ) ) by NAT_D:34;
( f1 . 1 ) = ( ( fp . 1 ) * ( x |^ ( 1 -' 1 ) ) ) by A6,A8,FINSEQ_5:6;
then ( f1 . 1 ) = ( ( fp . 1 ) * ( x |^ ( 0 ) ) ) by XREAL_1:232;
then A10: ( f1 . 1 ) = ( ( fp . 1 ) * 1 ) by NEWTON:4;
reconsider n as (Element of ( NAT )) by ORDINAL1:def 12;
consider f4 being FinSequence such that A11: (( len f4 ) = ( n + 1 ) & (for d being Nat holds (d in ( dom f4 ) implies ( f4 . d ) = F(d)))) from FINSEQ_1:sch 2;
A12: (for d being Nat holds (d in ( dom f4 ) implies ( f4 . d ) in ( INT )))
proof
let d being Nat;
reconsider d1 = d as (Element of ( NAT )) by ORDINAL1:def 12;
assume d in ( dom f4 );
then ( f4 . d1 ) = ( ( fr . d1 ) * ( x |^ d1 ) ) by A11;
hence thesis by INT_1:def 2;
end;
f4 <> ( {} ) by A11;
then ( n + 1 ) in ( dom f4 ) by A11,FINSEQ_5:6;
then ( f4 . ( n + 1 ) ) = ( ( fr . ( n + 1 ) ) * ( x |^ ( n + 1 ) ) ) by A11;
then A13: ( f4 . ( n + 1 ) ) = ( ( fp . ( n + 2 ) ) * ( x |^ ( n + 1 ) ) ) by A3,FINSEQ_5:62;
reconsider f4 as (FinSequence of ( INT )) by A12,FINSEQ_2:12;
consider f5 being FinSequence such that A14: (( len f5 ) = ( n + 1 ) & (for d being Nat holds (d in ( dom f5 ) implies ( f5 . d ) = FF(d)))) from FINSEQ_1:sch 2;
A15: (for d being Nat holds (d in ( dom f5 ) implies ( f5 . d ) in ( INT )))
proof
let d being Nat;
assume d in ( dom f5 );
then ( f5 . d ) = ( ( a * ( fr . d ) ) * ( x |^ ( d -' 1 ) ) ) by A14;
hence thesis by INT_1:def 2;
end;
f5 <> ( {} ) by A14;
then 1 in ( dom f5 ) by FINSEQ_5:6;
then ( f5 . 1 ) = ( ( a * ( fr . 1 ) ) * ( x |^ ( 1 -' 1 ) ) ) by A14;
then ( f5 . 1 ) = ( ( a * ( fr . 1 ) ) * ( x |^ ( 0 ) ) ) by XREAL_1:232;
then A16: ( f5 . 1 ) = ( ( a * ( fr . 1 ) ) * 1 ) by NEWTON:4;
reconsider f5 as (FinSequence of ( INT )) by A15,FINSEQ_2:12;
A17: f4 is (FinSequence of ( REAL )) by FINSEQ_3:117;
consider f2 being (FinSequence of ( INT )) such that A18: ( len f2 ) = ( len fr ) and A19: (for d holds (d in ( dom f2 ) implies ( f2 . d ) = ( ( fr . d ) * ( x |^ ( d -' 1 ) ) ))) and A20: ( ( Poly-INT fr ) . x ) = ( Sum f2 ) by CKB4:def 1;
set f3 = ( ( x - a ) * f2 );
A21: ( dom f3 ) = ( dom f2 ) by VALUED_1:def 5;
then A22: ( len f3 ) = ( len f2 ) by FINSEQ_3:29;
A23: ( dom f3 ) = ( dom f4 ) by A4,A18,A11,A21,FINSEQ_3:29;
A24: (for k being (Element of ( NAT )) holds (k in ( dom f3 ) implies ( f3 . k ) = ( ( ( fr . k ) * ( x |^ k ) ) - ( ( a * ( fr . k ) ) * ( x |^ ( k -' 1 ) ) ) )))
proof
let k being (Element of ( NAT ));
assume A25: k in ( dom f3 );
then A26: k >= 1 by FINSEQ_3:25;
A27: k in ( dom f2 ) by A25,VALUED_1:def 5;
thus ( f3 . k ) = ( ( x - a ) * ( f2 . k ) ) by A25,VALUED_1:def 5
.= ( ( x - a ) * ( ( fr . k ) * ( x |^ ( k -' 1 ) ) ) ) by A19,A27
.= ( ( ( fr . k ) * ( ( x |^ ( k -' 1 ) ) * x ) ) - ( ( a * ( fr . k ) ) * ( x |^ ( k -' 1 ) ) ) )
.= ( ( ( fr . k ) * ( x |^ ( ( k -' 1 ) + 1 ) ) ) - ( ( a * ( fr . k ) ) * ( x |^ ( k -' 1 ) ) ) ) by NEWTON:6
.= ( ( ( fr . k ) * ( x |^ k ) ) - ( ( a * ( fr . k ) ) * ( x |^ ( k -' 1 ) ) ) ) by A26,XREAL_1:235;
end;
A28: ( dom f3 ) = ( dom f5 ) by A4,A18,A14,A21,FINSEQ_3:29;
A29: (for d holds (d in ( dom f3 ) implies ( f3 . d ) = ( ( f4 . d ) - ( f5 . d ) )))
proof
let d;
assume A30: d in ( dom f3 );
then A31: ( f5 . d ) = ( ( a * ( fr . d ) ) * ( x |^ ( d -' 1 ) ) ) by A14,A28;
( f4 . d ) = ( ( fr . d ) * ( x |^ d ) ) by A11,A23,A30;
hence thesis by A24,A30,A31;
end;
f5 is (FinSequence of ( REAL )) by FINSEQ_3:117;
then consider f6 being (FinSequence of ( REAL )) such that A32: ( len f6 ) = ( ( len f3 ) - 1 ) and A33: (for d holds (d in ( dom f6 ) implies ( f6 . d ) = ( ( f4 . d ) - ( f5 . ( d + 1 ) ) ))) and A34: ( Sum f3 ) = ( ( ( Sum f6 ) + ( f4 . ( n + 1 ) ) ) - ( f5 . 1 ) ) by A4,A18,A11,A14,A22,A29,A17,CKB7:1;
A35: ( len f6 ) <= ( len f3 ) by A4,A18,A22,A32,XREAL_1:145;
then A36: ( dom f6 ) c= ( dom f3 ) by FINSEQ_3:30;
A37: (for d being (Element of ( NAT )) holds (d in ( dom f6 ) implies ( f6 . d ) = ( f1 . ( d + 1 ) )))
proof
let d being (Element of ( NAT ));
A38: ( dom f6 ) c= ( dom p ) by A3,A4,A18,A22,A35,FINSEQ_3:30;
assume A39: d in ( dom f6 );
then A40: d in ( Seg n ) by A4,A18,A22,A32,FINSEQ_1:def 3;
then A41: d <= n by FINSEQ_1:1;
then A42: ( n - d ) >= ( 0 ) by XREAL_1:48;
then reconsider d9 = ( ( n - d ) + 1 ) as (Element of ( NAT )) by INT_1:3;
d >= 1 by A40,FINSEQ_1:1;
then ( n - d ) <= ( n - 1 ) by XREAL_1:10;
then d9 <= ( ( n - 1 ) + 1 ) by XREAL_1:6;
then A43: d9 < ( n + 1 ) by XREAL_1:145;
d9 >= ( ( 0 ) + 1 ) by A42,XREAL_1:6;
then A44: ( p . ( d9 + 1 ) ) = ( ( fp . ( ( n + 2 ) - d9 ) ) + ( a * ( p . d9 ) ) ) by A3,A43;
d < ( n + 1 ) by A41,XREAL_1:145;
then A45: ( d + 1 ) in ( Seg ( n + 1 ) ) by FINSEQ_3:11;
then A46: ( d + 1 ) in ( dom f5 ) by A14,FINSEQ_1:def 3;
( d + ( 0 ) ) < ( n + 2 ) by A41,XREAL_1:8;
then ( d + 1 ) in ( Seg ( n + 2 ) ) by FINSEQ_3:11;
then A47: ( d + 1 ) in ( dom f1 ) by A1,A5,FINSEQ_1:def 3;
A48: ( d + 1 ) in ( dom p ) by A3,A45,FINSEQ_1:def 3;
thus ( f6 . d ) = ( ( f4 . d ) - ( f5 . ( d + 1 ) ) ) by A33,A39
.= ( ( ( fr . d ) * ( x |^ d ) ) - ( f5 . ( d + 1 ) ) ) by A11,A23,A36,A39
.= ( ( ( fr . d ) * ( x |^ d ) ) - ( ( a * ( fr . ( d + 1 ) ) ) * ( x |^ ( ( d + 1 ) -' 1 ) ) ) ) by A14,A46
.= ( ( ( fr . d ) * ( x |^ d ) ) - ( ( a * ( fr . ( d + 1 ) ) ) * ( x |^ d ) ) ) by NAT_D:34
.= ( ( ( fr . d ) - ( a * ( fr . ( d + 1 ) ) ) ) * ( x |^ d ) )
.= ( ( ( p . ( ( ( n + 1 ) - d ) + 1 ) ) - ( a * ( fr . ( d + 1 ) ) ) ) * ( x |^ d ) ) by A3,A39,A38,FINSEQ_5:58
.= ( ( ( p . ( ( ( n - d ) + 1 ) + 1 ) ) - ( a * ( p . ( ( ( n + 1 ) - ( d + 1 ) ) + 1 ) ) ) ) * ( x |^ d ) ) by A3,A48,FINSEQ_5:58
.= ( ( fp . ( d + 1 ) ) * ( x |^ ( ( d + 1 ) -' 1 ) ) ) by A44,NAT_D:34
.= ( f1 . ( d + 1 ) ) by A6,A47;
end;
f1 = ( ( <* ( f1 . 1 ) *> ^ f6 ) ^ <* ( f1 . ( n + 2 ) ) *> )
proof
set K = ( ( <* ( f1 . 1 ) *> ^ f6 ) ^ <* ( f1 . ( n + 2 ) ) *> );
A49: (for d being Nat holds (d in ( dom f1 ) implies ( f1 . d ) = ( K . d )))
proof
let d being Nat;
assume A50: d in ( dom f1 );
then A51: d >= 1 by FINSEQ_3:25;
A52: d <= ( n + 2 ) by A1,A5,A50,FINSEQ_3:25;
per cases  by A51,A52,XXREAL_0:1;
suppose A53: d = 1;

hence ( K . d ) = ( ( <* ( f1 . 1 ) *> ^ ( f6 ^ <* ( f1 . ( n + 2 ) ) *> ) ) . 1 ) by FINSEQ_1:32
.= ( f1 . d ) by A53,FINSEQ_1:41;
end;
suppose A54: (d > 1 & d < ( n + 2 ));

then ( d - 1 ) > ( 0 ) by XREAL_1:50;
then reconsider w = ( d - 1 ) as (Element of ( NAT )) by INT_1:3;
( d - 1 ) < ( ( n + 2 ) - 1 ) by A54,XREAL_1:9;
then A55: ( d - 1 ) <= ( ( n + 1 ) - 1 ) by INT_1:7;
( d - 1 ) >= ( ( 0 ) + 1 ) by A54,INT_1:7,XREAL_1:50;
then w in ( Seg n ) by A55,FINSEQ_1:1;
then A56: w in ( dom f6 ) by A4,A18,A22,A32,FINSEQ_1:def 3;
then A57: w in ( dom ( f6 ^ <* ( f1 . ( n + 2 ) ) *> ) ) by FINSEQ_2:15;
thus ( K . d ) = ( ( <* ( f1 . 1 ) *> ^ ( f6 ^ <* ( f1 . ( n + 2 ) ) *> ) ) . ( w + 1 ) ) by FINSEQ_1:32
.= ( ( f6 ^ <* ( f1 . ( n + 2 ) ) *> ) . w ) by A57,FINSEQ_3:103
.= ( f6 . w ) by A56,FINSEQ_1:def 7
.= ( f1 . ( w + 1 ) ) by A37,A56
.= ( f1 . d );
end;
suppose A58: d = ( n + 2 );

set K1 = ( <* ( f1 . 1 ) *> ^ f6 );
thus ( K . d ) = ( K . ( ( n + 1 ) + 1 ) ) by A58
.= ( K . ( ( len K1 ) + 1 ) ) by A4,A18,A22,A32,FINSEQ_5:8
.= ( f1 . d ) by A58,FINSEQ_1:42;
end;
end;
( len K ) = ( len ( <* ( f1 . 1 ) *> ^ ( f6 ^ <* ( f1 . ( n + 2 ) ) *> ) ) ) by FINSEQ_1:32
.= ( 1 + ( len ( f6 ^ <* ( f1 . ( n + 2 ) ) *> ) ) ) by FINSEQ_5:8
.= ( ( 1 + ( len f6 ) ) + 1 ) by FINSEQ_2:16
.= ( len f1 ) by A1,A4,A5,A18,A22,A32;
then ( dom f1 ) = ( dom K ) by FINSEQ_3:29;
hence thesis by A49,FINSEQ_1:13;
end;
then ( Sum f1 ) = ( Sum ( <* ( f1 . 1 ) *> ^ ( f6 ^ <* ( f1 . ( n + 2 ) ) *> ) ) ) by FINSEQ_1:32
.= ( ( f1 . 1 ) + ( Sum ( f6 ^ <* ( f1 . ( n + 2 ) ) *> ) ) ) by RVSUM_1:76
.= ( ( f1 . 1 ) + ( ( Sum f6 ) + ( f1 . ( n + 2 ) ) ) ) by RVSUM_1:74
.= ( ( Sum ( ( x - a ) * f2 ) ) + r ) by A10,A9,A13,A16,A34
.= ( ( ( x - a ) * ( ( Poly-INT fr ) . x ) ) + r ) by A20,RVSUM_1:87;
hence thesis by A7;
end;
hence thesis by A3,FINSEQ_5:62,FINSEQ_5:def 3;
end;
