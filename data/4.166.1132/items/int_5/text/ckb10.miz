environ
vocabularies NUMBERS,SUBSET_1,INT_1,NAT_1,FINSEQ_1,NEWTON,ARYTM_3,ARYTM_1,RELAT_1,CARD_1,FUNCT_1,CARD_3,FUNCOP_1,ORDINAL4,XBOOLE_0,TARSKI,XXREAL_0,FINSEQ_5,SQUARE_1,INT_2,COMPLEX1,ORDINAL1,ABIAN,FINSEQ_2,FUNCT_7,PARTFUN1,FINSET_1,RFINSEQ,CALCUL_2,REAL_1,ZFMISC_1,INT_5;
notations GROUP_4,INT_1,RVSUM_1,FINSET_1,ORDINAL1,CARD_1,NAT_D,INT_2,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,NAT_3,ABIAN,GR_CY_1,FINSEQ_5,FINSEQ_2,EULER_2,NEWTON,GOBRD10,FINSEQ_7,REAL_1,PEPIN,TARSKI,XBOOLE_0,SUBSET_1,XCMPLX_0,NUMBERS,XXREAL_0,NAT_1,DOMAIN_1,FINSEQ_1,RFINSEQ,FUNCOP_1,CALCUL_2,ZFMISC_1,CARD_3,WSIERP_1,BINOP_1,PROB_3,RECDEF_1,CKB4;
definitions INT_1,FUNCT_1,XCMPLX_0,SQUARE_1,FINSEQ_2,TARSKI,CALCUL_2,CARD_3,CKB4;
theorems FINSEQ_1,FINSEQ_7,RELAT_1,FINSEQ_3,FINSEQ_2,ABSVALUE,FINSEQ_5,EULER_2,INT_3,SEQ_2,FINSEQ_4,FUNCT_2,XBOOLE_0,NAT_3,NEWTON,INT_2,NAT_2,WSIERP_1,CARD_1,PEPIN,NAT_1,XCMPLX_1,XREAL_1,HEYTING3,ORDINAL1,EULER_1,XBOOLE_1,TARSKI,RVSUM_1,NUMBERS,INT_1,FUNCT_1,FUNCOP_1,XXREAL_0,NAT_D,HILBERT3,GOBRD10,SERIES_2,GRAPH_5,HILBERT2,RFINSEQ,ZFMISC_1,CARD_2,XREAL_0,FINSEQ_6,CALCUL_2,NAT_4,PROB_3,TOPREAL7,CARD_3,REAL_3,PRE_FF,INT_4,VALUED_1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9;
schemes NAT_1,FUNCT_2,RECDEF_1,FINSEQ_2,FUNCT_7,FINSEQ_1;
registrations XXREAL_0,MEMBERED,RELAT_1,FINSEQ_1,ORDINAL1,WSIERP_1,NUMBERS,XBOOLE_0,XREAL_0,NAT_1,INT_1,FINSET_1,NAT_3,RVSUM_1,FUNCT_1,CARD_1,NEWTON,SUBSET_1,VALUED_0,VALUED_1,FINSEQ_2,PRE_POLY,CARD_3,RELSET_1;
constructors BINARITH,ABIAN,WSIERP_1,PEPIN,UPROOTS,NAT_3,NAT_D,REALSET1,GR_CY_1,FINSEQ_5,GOBRD10,EULER_2,RFINSEQ,GROUP_4,FINSEQ_7,REAL_1,WELLORD2,CALCUL_2,SETFAM_1,PROB_3,SEQ_1,RECDEF_1,BINOP_1,BINOP_2,CLASSES1,RELSET_1,CKB4;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve r for Integer;
reserve a for Integer;
reserve x for Integer;
reserve d for Nat;
reserve e for Nat;
reserve k for Nat;
reserve n for Nat;
reserve fp for (FinSequence of ( INT ));
reserve fk for (FinSequence of ( INT ));
reserve p for Prime;
reserve fr for (FinSequence of ( INT ));
reserve f for (FinSequence of ( INT ));
theorem
Th8: (for fp holds (((( len fp ) = ( n + 1 ) & p > 2) & (not p divides ( fp . ( n + 1 ) ))) implies (for fr holds (((for d holds (d in ( dom fr ) implies ( ( ( Poly-INT fp ) . ( fr . d ) ) mod p ) = ( 0 ))) & (for d holds (for e holds (((d in ( dom fr ) & e in ( dom fr )) & d <> e) implies (not ( fr . d ),( fr . e ) are_congruent_mod p))))) implies ( len fr ) <= n))))
proof
defpred P[ Nat ]
 means
(for fp holds (((( len fp ) = ( $1 + 1 ) & p > 2) & (not p divides ( fp . ( $1 + 1 ) ))) implies (for fr holds (((for d holds (d in ( dom fr ) implies ( ( ( Poly-INT fp ) . ( fr . d ) ) mod p ) = ( 0 ))) & (for d holds (for e holds (((d in ( dom fr ) & e in ( dom fr )) & d <> e) implies (not ( fr . d ),( fr . e ) are_congruent_mod p))))) implies ( len fr ) <= $1))));
A1: (for n holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
let n;
assume A2: P[ n ];
let fp;
assume that
A3: ( len fp ) = ( ( n + 1 ) + 1 )
and
A4: p > 2
and
A5: (not p divides ( fp . ( ( n + 1 ) + 1 ) ));
per cases ;
suppose A6: (for x holds ( ( ( Poly-INT fp ) . x ) mod p ) <> ( 0 ));

assume (ex fr st (((for d holds (d in ( dom fr ) implies ( ( ( Poly-INT fp ) . ( fr . d ) ) mod p ) = ( 0 ))) & (for d holds (for e holds (((d in ( dom fr ) & e in ( dom fr )) & d <> e) implies (not ( fr . d ),( fr . e ) are_congruent_mod p))))) & ( len fr ) > ( n + 1 )));
then consider fr such that A7: (for d holds (d in ( dom fr ) implies ( ( ( Poly-INT fp ) . ( fr . d ) ) mod p ) = ( 0 ))) and (for d holds (for e holds (((d in ( dom fr ) & e in ( dom fr )) & d <> e) implies (not ( fr . d ),( fr . e ) are_congruent_mod p)))) and A8: ( len fr ) > ( n + 1 );
fr <> ( {} ) by A8;
then ( ( ( Poly-INT fp ) . ( fr . 1 ) ) mod p ) = ( 0 ) by A7,FINSEQ_5:6;
hence contradiction by A6;
end;
suppose (ex a being Integer st ( ( ( Poly-INT fp ) . a ) mod p ) = ( 0 ));

then consider a being Integer such that A9: ( ( ( Poly-INT fp ) . a ) mod p ) = ( 0 );
assume (ex f st (((for d holds (d in ( dom f ) implies ( ( ( Poly-INT fp ) . ( f . d ) ) mod p ) = ( 0 ))) & (for d holds (for e holds (((d in ( dom f ) & e in ( dom f )) & d <> e) implies (not ( f . d ),( f . e ) are_congruent_mod p))))) & ( len f ) > ( n + 1 )));
then consider f such that A10: (for d holds (d in ( dom f ) implies ( ( ( Poly-INT fp ) . ( f . d ) ) mod p ) = ( 0 ))) and A11: (for d holds (for e holds (((d in ( dom f ) & e in ( dom f )) & d <> e) implies (not ( f . d ),( f . e ) are_congruent_mod p)))) and A12: ( len f ) > ( n + 1 );
consider fk,r such that A13: ( len fk ) = ( n + 1 ) and A14: (for x being (Element of ( INT )) holds ( ( Poly-INT fp ) . x ) = ( ( ( x - a ) * ( ( Poly-INT fk ) . x ) ) + r )) and A15: ( fp . ( n + 2 ) ) = ( fk . ( n + 1 ) ) by A3,CKB8:1;
a is (Element of ( INT )) by INT_1:def 2;
then A16: ( ( ( Poly-INT fp ) . a ) mod p ) = ( ( ( ( a - a ) * ( ( Poly-INT fk ) . a ) ) + r ) mod p ) by A14
.= ( r mod p );
A17: (for d being (Element of ( NAT )) holds (d in ( dom f ) implies p divides ( ( ( f . d ) - a ) * ( ( Poly-INT fk ) . ( f . d ) ) )))
proof
let d being (Element of ( NAT ));
( f . d ) is (Element of ( INT )) by INT_1:def 2;
then A18: ( ( ( Poly-INT fp ) . ( f . d ) ) mod p ) = ( ( ( ( ( f . d ) - a ) * ( ( Poly-INT fk ) . ( f . d ) ) ) + r ) mod p ) by A14
.= ( ( ( ( ( ( f . d ) - a ) * ( ( Poly-INT fk ) . ( f . d ) ) ) mod p ) + ( r mod p ) ) mod p ) by NAT_D:66
.= ( ( ( ( f . d ) - a ) * ( ( Poly-INT fk ) . ( f . d ) ) ) mod p ) by A9,A16,NAT_D:65;
assume d in ( dom f );
then ( ( ( ( f . d ) - a ) * ( ( Poly-INT fk ) . ( f . d ) ) ) mod p ) = ( 0 ) by A10,A18;
hence thesis by INT_1:62;
end;
per cases ;
suppose A19: (for d holds (d in ( dom f ) implies (not p divides ( ( f . d ) - a ))));

(for d holds (d in ( dom f ) implies ( ( ( Poly-INT fk ) . ( f . d ) ) mod p ) = ( 0 )))
proof
let d;
assume A20: d in ( dom f );
then p divides ( ( ( f . d ) - a ) * ( ( Poly-INT fk ) . ( f . d ) ) ) by A17;
then (p divides ( ( f . d ) - a ) or p divides ( ( Poly-INT fk ) . ( f . d ) )) by CKB9:1;
hence thesis by A19,A20,INT_1:62;
end;
then ( len f ) <= n by A2,A4,A5,A13,A15,A11;
hence contradiction by A12,XREAL_1:145;
end;
suppose (ex d st (d in ( dom f ) & p divides ( ( f . d ) - a )));

then consider d9 being (Element of ( NAT )) such that A21: d9 in ( dom f ) and A22: p divides ( ( f . d9 ) - a );
set f9 = ( f - { ( f . d9 ) } );
A23: (for d holds (d in ( dom f9 ) implies (not p divides ( ( f9 . d ) - a ))))
proof
given k being Nat such that
A24: k in ( dom f9 )
and
A25: p divides ( ( f9 . k ) - a );

( f9 . k ) in ( rng f9 ) by A24,FUNCT_1:3;
then A26: ( f9 . k ) in ( ( rng f ) \ { ( f . d9 ) } ) by FINSEQ_3:65;
then ( f9 . k ) in ( rng f ) by XBOOLE_0:def 5;
then consider w being set such that A27: w in ( dom f ) and A28: ( f . w ) = ( f9 . k ) by FUNCT_1:def 3;
reconsider w as (Element of ( NAT )) by A27;
p divides ( ( ( f . w ) - a ) - ( ( f . d9 ) - a ) ) by A22,A25,A28,CKB1:1;
then p divides ( ( f . w ) - ( f . d9 ) );
then A29: ( f . w ),( f . d9 ) are_congruent_mod p by INT_2:15;
(not ( f9 . k ) in { ( f . d9 ) }) by A26,XBOOLE_0:def 5;
then w <> d9 by A28,TARSKI:def 1;
hence contradiction by A11,A21,A27,A29;
end;
A30: (for d holds (d in ( dom f9 ) implies ( ( ( Poly-INT fk ) . ( f9 . d ) ) mod p ) = ( 0 )))
proof
let d;
assume A31: d in ( dom f9 );
then ( f9 . d ) in ( rng f9 ) by FUNCT_1:3;
then ( f9 . d ) in ( ( rng f ) \ { ( f . d9 ) } ) by FINSEQ_3:65;
then ( f9 . d ) in ( rng f ) by XBOOLE_0:def 5;
then (ex w being set st (w in ( dom f ) & ( f . w ) = ( f9 . d ))) by FUNCT_1:def 3;
then p divides ( ( ( f9 . d ) - a ) * ( ( Poly-INT fk ) . ( f9 . d ) ) ) by A17;
then (p divides ( ( f9 . d ) - a ) or p divides ( ( Poly-INT fk ) . ( f9 . d ) )) by CKB9:1;
hence thesis by A23,A31,INT_1:62;
end;
A32: f is  one-to-one
proof
let x1 being set;
let x2 being set;
assume that
A33: x1 in ( dom f )
and
A34: x2 in ( dom f )
and
A35: ( f . x1 ) = ( f . x2 )
and
A36: x1 <> x2;
thus contradiction by A11,A33,A34,A35,A36,INT_1:11;
end;
then A37: f9 is  one-to-one by FINSEQ_3:87;
A38: (for d holds (for e holds (((d in ( dom f9 ) & e in ( dom f9 )) & d <> e) implies (not ( f9 . d ),( f9 . e ) are_congruent_mod p))))
proof
let d;
let e;
assume that
A39: d in ( dom f9 )
and
A40: e in ( dom f9 )
and
A41: d <> e;
( f9 . e ) in ( rng f9 ) by A40,FUNCT_1:3;
then ( f9 . e ) in ( ( rng f ) \ { ( f . d9 ) } ) by FINSEQ_3:65;
then ( f9 . e ) in ( rng f ) by XBOOLE_0:def 5;
then consider w2 being set such that A42: w2 in ( dom f ) and A43: ( f9 . e ) = ( f . w2 ) by FUNCT_1:def 3;
( f9 . d ) in ( rng f9 ) by A39,FUNCT_1:3;
then ( f9 . d ) in ( ( rng f ) \ { ( f . d9 ) } ) by FINSEQ_3:65;
then ( f9 . d ) in ( rng f ) by XBOOLE_0:def 5;
then consider w1 being set such that A44: w1 in ( dom f ) and A45: ( f9 . d ) = ( f . w1 ) by FUNCT_1:def 3;
reconsider w1,w2 as (Element of ( NAT )) by A44,A42;
w1 <> w2 by A37,A39,A40,A41,A45,A43,FUNCT_1:def 4;
hence thesis by A11,A44,A45,A42,A43;
end;
( f . d9 ) in ( rng f ) by A21,FUNCT_1:3;
then ( len f9 ) = ( ( len f ) - 1 ) by A32,FINSEQ_3:90;
then ( len f9 ) > ( ( n + 1 ) - 1 ) by A12,XREAL_1:9;
hence contradiction by A2,A4,A5,A13,A15,A30,A38;
end;
end;
end;
A46: P[ ( 0 ) ]
proof
let fp;
assume that
A47: ( len fp ) = ( ( 0 ) + 1 )
and
p > 2
and
A48: (not p divides ( fp . ( ( 0 ) + 1 ) ));
assume (ex fr st (((for d holds (d in ( dom fr ) implies ( ( ( Poly-INT fp ) . ( fr . d ) ) mod p ) = ( 0 ))) & (for d holds (for e holds (((d in ( dom fr ) & e in ( dom fr )) & d <> e) implies (not ( fr . d ),( fr . e ) are_congruent_mod p))))) & ( len fr ) > ( 0 )));
then consider fr such that A49: (for d holds (d in ( dom fr ) implies ( ( ( Poly-INT fp ) . ( fr . d ) ) mod p ) = ( 0 ))) and (for d holds (for e holds (((d in ( dom fr ) & e in ( dom fr )) & d <> e) implies (not ( fr . d ),( fr . e ) are_congruent_mod p)))) and A50: ( len fr ) > ( 0 );
fr <> ( {} ) by A50;
then A51: ( ( ( Poly-INT fp ) . ( fr . 1 ) ) mod p ) = ( 0 ) by A49,FINSEQ_5:6;
A52: ( fr . 1 ) in ( INT ) by INT_1:def 2;
( ( Poly-INT fp ) . ( fr . 1 ) ) = ( ( ( INT ) --> ( fp . 1 ) ) . ( fr . 1 ) ) by A47,CKB5:1
.= ( fp . 1 ) by A52,FUNCOP_1:7;
hence contradiction by A48,A51,CKB3:1;
end;
(for n holds P[ n ]) from NAT_1:sch 2(A46,A1);
hence thesis;
end;
