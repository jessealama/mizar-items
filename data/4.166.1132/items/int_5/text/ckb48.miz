environ
vocabularies NUMBERS,SUBSET_1,INT_1,NAT_1,FINSEQ_1,NEWTON,ARYTM_3,ARYTM_1,RELAT_1,CARD_1,FUNCT_1,CARD_3,FUNCOP_1,ORDINAL4,XBOOLE_0,TARSKI,XXREAL_0,FINSEQ_5,SQUARE_1,INT_2,COMPLEX1,ORDINAL1,ABIAN,FINSEQ_2,FUNCT_7,PARTFUN1,FINSET_1,RFINSEQ,CALCUL_2,REAL_1,ZFMISC_1,INT_5;
notations GROUP_4,INT_1,RVSUM_1,FINSET_1,ORDINAL1,CARD_1,NAT_D,INT_2,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,NAT_3,ABIAN,GR_CY_1,FINSEQ_5,FINSEQ_2,EULER_2,NEWTON,GOBRD10,FINSEQ_7,REAL_1,PEPIN,TARSKI,XBOOLE_0,SUBSET_1,XCMPLX_0,NUMBERS,XXREAL_0,NAT_1,DOMAIN_1,FINSEQ_1,RFINSEQ,FUNCOP_1,CALCUL_2,ZFMISC_1,CARD_3,WSIERP_1,BINOP_1,PROB_3,RECDEF_1,CKB4,CKB11,CKB29;
definitions INT_1,FUNCT_1,XCMPLX_0,SQUARE_1,FINSEQ_2,TARSKI,CALCUL_2,CARD_3,CKB4,CKB11,CKB29;
theorems FINSEQ_1,FINSEQ_7,RELAT_1,FINSEQ_3,FINSEQ_2,ABSVALUE,FINSEQ_5,EULER_2,INT_3,SEQ_2,FINSEQ_4,FUNCT_2,XBOOLE_0,NAT_3,NEWTON,INT_2,NAT_2,WSIERP_1,CARD_1,PEPIN,NAT_1,XCMPLX_1,XREAL_1,HEYTING3,ORDINAL1,EULER_1,XBOOLE_1,TARSKI,RVSUM_1,NUMBERS,INT_1,FUNCT_1,FUNCOP_1,XXREAL_0,NAT_D,HILBERT3,GOBRD10,SERIES_2,GRAPH_5,HILBERT2,RFINSEQ,ZFMISC_1,CARD_2,XREAL_0,FINSEQ_6,CALCUL_2,NAT_4,PROB_3,TOPREAL7,CARD_3,REAL_3,PRE_FF,INT_4,VALUED_1,PRE_POLY,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47;
schemes NAT_1,FUNCT_2,RECDEF_1,FINSEQ_2,FUNCT_7,FINSEQ_1;
registrations XXREAL_0,MEMBERED,RELAT_1,FINSEQ_1,ORDINAL1,WSIERP_1,NUMBERS,XBOOLE_0,XREAL_0,NAT_1,INT_1,FINSET_1,NAT_3,RVSUM_1,FUNCT_1,CARD_1,NEWTON,SUBSET_1,VALUED_0,VALUED_1,FINSEQ_2,PRE_POLY,CARD_3,RELSET_1;
constructors BINARITH,ABIAN,WSIERP_1,PEPIN,UPROOTS,NAT_3,NAT_D,REALSET1,GR_CY_1,FINSEQ_5,GOBRD10,EULER_2,RFINSEQ,GROUP_4,FINSEQ_7,REAL_1,WELLORD2,CALCUL_2,SETFAM_1,PROB_3,SEQ_1,RECDEF_1,BINOP_1,BINOP_2,CLASSES1,RELSET_1,CKB4,CKB11,CKB29;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for Integer;
reserve y for Integer;
reserve d for Nat;
reserve n for Nat;
reserve p for Prime;
theorem
Th42: (p > 2 implies ( Lege (2,p) ) = ( ( - 1 ) |^ ( ( ( p ^2 ) -' 1 ) div 8 ) ))
proof
set p9 = ( ( p -' 1 ) div 2 );
set I = ( idseq p9 );
set fp = ( 2 * I );
set nn = ( p div 8 );
A1: p > 1 by INT_2:def 4;
then A2: ( p - 1 ) = ( p -' 1 ) by XREAL_1:233;
A3: (for d holds (d in ( dom fp ) implies ( fp . d ) = ( 2 * d )))
proof
let d;
assume A4: d in ( dom fp );
then d in ( dom I ) by VALUED_1:def 5;
then d in ( Seg ( len I ) ) by FINSEQ_1:def 3;
then A5: d is (Element of ( Seg p9 )) by CARD_1:def 7;
thus ( fp . d ) = ( 2 * ( I . d ) ) by A4,VALUED_1:def 5
.= ( 2 * d ) by A5,FINSEQ_2:49;
end;
(for d being Nat holds (d in ( dom fp ) implies ( fp . d ) in ( NAT )))
proof
let d being Nat;
assume d in ( dom fp );
then ( fp . d ) = ( 2 * d ) by A3;
hence thesis;
end;
then reconsider fp as (FinSequence of ( NAT )) by FINSEQ_2:12;
set f = ( fp mod p );
set X = { k where k is (Element of ( NAT )): (k in ( rng f ) & k > ( p / 2 )) };
set m = ( card X );
( dom fp ) = ( dom I ) by VALUED_1:def 5;
then A6: ( len fp ) = ( len I ) by FINSEQ_3:29
.= p9 by CARD_1:def 7;
set Y = { d where d is (Element of ( NAT )): (d in ( dom f ) & ( f . d ) > ( p / 2 )) };
(for x being set holds (x in Y implies x in ( dom f )))
proof
let x being set;
assume x in Y;
then (ex k being (Element of ( NAT )) st ((x = k & k in ( dom f )) & ( f . k ) > ( p / 2 )));
hence thesis;
end;
then Y c= ( dom f ) by TARSKI:def 3;
then reconsider Y as  finite (Subset of ( NAT )) by XBOOLE_1:1;
set Z = ( seq (( p div 4 ),( p9 -' ( p div 4 ) )) );
A7: ( p mod 8 ) <= ( 8 - 1 ) by INT_1:52,NAT_D:1;
8 = ( 2 * 4 );
then A8: 2 divides 8 by NAT_D:def 3;
A9:now
assume ( p mod 8 ) = ( 0 );
then 8 divides p by PEPIN:6;
then p = 8 by INT_2:def 4;
hence contradiction by A8,NAT_4:12;
end;
(for x being set holds (x in X implies x in ( rng f )))
proof
let x being set;
assume x in X;
then (ex k being (Element of ( NAT )) st ((x = k & k in ( rng f )) & k > ( p / 2 )));
hence thesis;
end;
then A10: X c= ( rng f ) by TARSKI:def 3;
then reconsider X as  finite set;
( card X ) is (Element of ( NAT ));
then reconsider m as (Element of ( NAT ));
A11: ( len f ) = ( len fp ) by EULER_2:def 1;
then A12: ( dom f ) = ( dom fp ) by FINSEQ_3:29;
assume A13: p > 2;
then 2,p are_relative_prime  by EULER_1:2;
then A14: ( 2 gcd p ) = 1 by INT_2:def 3;
then A15: ( Lege (2,p) ) = ( ( - 1 ) |^ m ) by A13,CKB47:1;
p is  odd by A13,PEPIN:17;
then A16: ( p - 1 ) is  even by HILBERT3:2;
then A17: p9 = ( ( ( p -' 1 ) + 1 ) div 2 ) by A2,NAT_2:26
.= ( p div 2 ) by A1,XREAL_1:235;
then A18: f <> ( {} ) by A13,A6,A11,NAT_2:13;
then reconsider U = ( dom f ) as non  empty  finite (Subset of ( NAT ));
2 divides ( p -' 1 ) by A16,A2,PEPIN:22;
then A19: ( p -' 1 ) = ( 2 * p9 ) by NAT_D:3;
A20: (for d holds (d in ( dom f ) implies ( f . d ) = ( 2 * d )))
proof
let d;
assume A21: d in ( dom f );
then d <= p9 by A6,A11,FINSEQ_3:25;
then ( 2 * d ) <= ( p -' 1 ) by A19,XREAL_1:64;
then ( 2 * d ) < p by NAT_2:9,XXREAL_0:2;
hence ( 2 * d ) = ( ( 2 * d ) mod p ) by NAT_D:24
.= ( ( fp . d ) mod p ) by A3,A12,A21
.= ( f . d ) by A12,A21,EULER_2:def 1;
end;
A22: (for d1,d2,k1,k2 being Nat holds (((((1 <= d1 & d1 < d2) & d2 <= ( len f )) & k1 = ( f . d1 )) & k2 = ( f . d2 )) implies k1 < k2))
proof
let d1 being Nat;
let d2 being Nat;
let k1 being Nat;
let k2 being Nat;
assume that
A23: 1 <= d1
and
A24: d1 < d2
and
A25: d2 <= ( len f )
and
A26: k1 = ( f . d1 )
and
A27: k2 = ( f . d2 );
1 <= d2 by A23,A24,XXREAL_0:2;
then d2 in ( dom f ) by A25,FINSEQ_3:25;
then A28: k2 = ( 2 * d2 ) by A20,A27;
d1 <= ( len f ) by A24,A25,XXREAL_0:2;
then d1 in ( dom f ) by A23,FINSEQ_3:25;
then k1 = ( 2 * d1 ) by A20,A26;
hence thesis by A24,A28,XREAL_1:68;
end;
( rng f ) is non  empty non  empty (Subset of ( NAT )) by A18,FINSEQ_1:def 4;
then consider n1 being (Element of ( NAT )) such that A29: ( rng f ) c= ( ( Seg n1 ) \/ { ( 0 ) } ) by HEYTING3:1;
( rng f ) c= ( NAT ) by FINSEQ_1:def 4;
then reconsider X as  finite (Subset of ( NAT )) by A10,XBOOLE_1:1;
Z,( ( ( p -' 1 ) div 2 ) -' ( p div 4 ) ) are_equipotent  by CALCUL_2:6;
then A30: ( card Z ) = ( ( ( p -' 1 ) div 2 ) -' ( p div 4 ) ) by CARD_1:def 2;
(not ( 0 ) in ( rng f ))
proof
assume ( 0 ) in ( rng f );
then consider n being Nat such that A31: n in ( dom f ) and A32: ( f . n ) = ( 0 ) by FINSEQ_2:10;
( 2 * n ) = ( 0 ) by A20,A31,A32;
hence contradiction by A31,FINSEQ_3:25;
end;
then A33: { ( 0 ) } misses ( rng f ) by ZFMISC_1:50;
then ( rng f ) c= ( Seg n1 ) by A29,XBOOLE_1:73;
then A34: ( Sgm ( rng f ) ) = f by A22,FINSEQ_1:def 13;
A35: X,Y are_equipotent 
proof
deffunc F((Element of U)) = ( f . $1 );
set YY = { d where d is (Element of U): F(d) in X };
A36:now
let x being set;
assume x in X;
then consider y being (Element of ( NAT )) such that A37: y = x and A38: y in ( rng f ) and y > ( p / 2 );
consider d being Nat such that A39: d in U and A40: ( f . d ) = y by A38,FINSEQ_2:10;
reconsider d as (Element of U) by A39;
take d;
thus x = F(d) by A37,A40;
end;
A41: Y c= YY
proof
let x being set;
assume x in Y;
then A42: (ex d being (Element of ( NAT )) st ((d = x & d in ( dom f )) & ( f . d ) > ( p / 2 )));
then reconsider x as (Element of U);
reconsider f as (FinSequence of (( NAT ) qua set));
( f . x ) in ( rng f ) by FUNCT_1:3;
then F(x) in X by A42;
hence thesis;
end;
now
let x being set;
assume x in YY;
then consider d being (Element of U) such that A43: d = x and A44: ( f . d ) in X;
(ex k being (Element of ( NAT )) st ((k = ( f . d ) & k in ( rng f )) & k > ( p / 2 ))) by A44;
hence x in Y by A43;
end;
then A45: YY c= Y by TARSKI:def 3;
A46: (for d1,d2 being (Element of U) holds (F(d1) = F(d2) implies d1 = d2))
proof
let d1 being (Element of U);
let d2 being (Element of U);
assume A47: F(d1) = F(d2);
f is  one-to-one by A29,A33,A34,FINSEQ_3:92,XBOOLE_1:73;
hence thesis by A47,FUNCT_1:def 4;
end;
X,YY are_equipotent  from FUNCT_7:sch 3(A36,A46);
hence thesis by A41,A45,XBOOLE_0:def 10;
end;
( p div 2 ) < p by INT_1:56;
then ( ( p div 2 ) div 2 ) <= ( p div 2 ) by NAT_2:24;
then A48: ( p div ( 2 * 2 ) ) <= ( p div 2 ) by NAT_2:27;
A49: Z c= Y
proof
let x being set;
assume A50: x in Z;
then reconsider x as (Element of ( NAT ));
A51: x >= ( ( p div 4 ) + 1 ) by A50,CALCUL_2:1;
then ( ( p div 4 ) + x ) >= ( ( p div 4 ) + 1 ) by NAT_1:12;
then A52: x >= 1 by XREAL_1:6;
x <= ( ( ( ( p -' 1 ) div 2 ) -' ( p div 4 ) ) + ( p div 4 ) ) by A50,CALCUL_2:1;
then x <= ( ( p -' 1 ) div 2 ) by A17,A48,XREAL_1:235;
then A53: x in ( dom f ) by A6,A11,A52,FINSEQ_3:25;
x > ( p / 4 ) by A51,INT_1:29,XXREAL_0:2;
then ( 2 * x ) > ( 2 * ( p / 4 ) ) by XREAL_1:68;
then ( f . x ) > ( p / 2 ) by A20,A53;
hence thesis by A53;
end;
now
let x being set;
A54: ( p / 4 ) >= [\ ( p / 4 ) /] by INT_1:def 6;
assume x in Y;
then consider x1 being (Element of ( NAT )) such that A55: x1 = x and A56: x1 in ( dom f ) and A57: ( f . x1 ) > ( p / 2 );
( 2 * x1 ) > ( p / 2 ) by A20,A56,A57;
then x1 > ( ( p / 2 ) / 2 ) by XREAL_1:83;
then x1 > [\ ( p / 4 ) /] by A54,XXREAL_0:2;
then A58: x1 >= ( ( p div 4 ) + 1 ) by NAT_1:13;
x1 <= p9 by A6,A11,A56,FINSEQ_3:25;
then x1 <= ( ( p9 -' ( p div 4 ) ) + ( p div 4 ) ) by A17,A48,XREAL_1:235;
hence x in Z by A55,A58;
end;
then Y c= Z by TARSKI:def 3;
then Y = Z by A49,XBOOLE_0:def 10;
then A59: m = ( ( ( p -' 1 ) div 2 ) -' ( p div 4 ) ) by A30,A35,CARD_1:5;
A60:now
assume ( p mod 8 ) = 2;
then 8 divides ( p - 2 ) by PEPIN:8;
then 2 divides ( p - 2 ) by A8,INT_2:9;
then 2 divides ( - ( p - 2 ) ) by INT_2:10;
then 2 divides ( 2 - p );
then 2 divides p by CKB2:1;
hence contradiction by A13,NAT_4:12;
end;
A61:now
assume ( p mod 8 ) = 4;
then 8 divides ( p - 4 ) by PEPIN:8;
then 2 divides ( p - 4 ) by A8,INT_2:9;
then 2 divides ( - ( p - 4 ) ) by INT_2:10;
then A62: 2 divides ( 4 - p );
4 = ( 2 * 2 );
then 2 divides 4 by NAT_D:def 3;
then 2 divides p by A62,CKB2:1;
hence contradiction by A13,NAT_4:12;
end;
A63:now
assume ( p mod 8 ) = 6;
then 8 divides ( p - 6 ) by PEPIN:8;
then 2 divides ( p - 6 ) by A8,INT_2:9;
then 2 divides ( - ( p - 6 ) ) by INT_2:10;
then A64: 2 divides ( 6 - p );
6 = ( 2 * 3 );
then 2 divides 6 by NAT_D:def 3;
then 2 divides p by A64,CKB2:1;
hence contradiction by A13,NAT_4:12;
end;
per cases  by A9,A60,A61,A63,A7,NAT_1:31;
suppose ( p mod 8 ) = 1;

then A65: p = ( ( 8 * nn ) + 1 ) by NAT_D:2;
then ( p -' 1 ) = ( 2 * ( 4 * nn ) ) by A2;
then A66: ( ( p -' 1 ) div 2 ) = ( 4 * nn ) by NAT_D:18;
( p div 4 ) = ( ( ( 4 * ( 2 * nn ) ) + 1 ) div 4 ) by A65
.= ( ( 2 * nn ) + ( 1 div 4 ) ) by NAT_D:61
.= ( ( 2 * nn ) + ( 0 ) ) by NAT_D:27;
then m = ( ( 4 * nn ) - ( 2 * nn ) ) by A59,A66,XREAL_1:64,XREAL_1:233
.= ( 2 * nn );
then A67: ( Lege (2,p) ) = ( ( ( - 1 ) |^ 2 ) |^ nn ) by A15,NEWTON:9
.= ( ( 1 |^ 2 ) |^ nn ) by WSIERP_1:1
.= ( ( 1 ^2 ) |^ nn ) by NEWTON:81
.= 1 by NEWTON:10;
( ( ( p ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( ( 8 * nn ) ^2 ) + ( 2 * ( 8 * nn ) ) ) + 1 ) -' 1 ) div 8 ) by A65
.= ( ( 8 * ( ( 8 * ( nn ^2 ) ) + ( 2 * nn ) ) ) div 8 ) by NAT_D:34
.= ( ( 8 * ( nn ^2 ) ) + ( 2 * nn ) ) by NAT_D:18;
hence ( ( - 1 ) |^ ( ( ( p ^2 ) -' 1 ) div 8 ) ) = ( ( - 1 ) |^ ( 2 * ( ( 4 * ( nn ^2 ) ) + nn ) ) )
.= ( ( ( - 1 ) |^ 2 ) |^ ( ( 4 * ( nn ^2 ) ) + nn ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( ( 4 * ( nn ^2 ) ) + nn ) ) by WSIERP_1:1
.= ( 1 |^ ( ( 4 * ( nn ^2 ) ) + nn ) ) by NEWTON:10
.= ( Lege (2,p) ) by A67,NEWTON:10;
end;
suppose ( p mod 8 ) = 3;

then A68: p = ( ( 8 * nn ) + 3 ) by NAT_D:2;
then ( p -' 1 ) = ( 2 * ( ( 4 * nn ) + 1 ) ) by A2;
then A69: ( ( p -' 1 ) div 2 ) = ( ( 4 * nn ) + 1 ) by NAT_D:18;
A70: ( 4 * nn ) >= ( 2 * nn ) by XREAL_1:64;
( p div 4 ) = ( ( ( 4 * ( 2 * nn ) ) + 3 ) div 4 ) by A68
.= ( ( 2 * nn ) + ( 3 div 4 ) ) by NAT_D:61
.= ( ( 2 * nn ) + ( 0 ) ) by NAT_D:27;
then m = ( ( ( 4 * nn ) + 1 ) - ( 2 * nn ) ) by A59,A69,A70,NAT_1:12,XREAL_1:233
.= ( ( 2 * nn ) + 1 );
then A71: ( Lege (2,p) ) = ( ( ( - 1 ) |^ ( 2 * nn ) ) * ( - 1 ) ) by A15,NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ nn ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ nn ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ nn ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( - 1 );
( ( ( p ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( nn ^2 ) ) ) + ( 8 * ( 6 * nn ) ) ) + ( 3 * 3 ) ) - 1 ) div 8 ) by A68,NAT_1:12,XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( nn ^2 ) ) + ( 6 * nn ) ) + 1 ) ) div 8 )
.= ( ( ( 8 * ( nn ^2 ) ) + ( 6 * nn ) ) + 1 ) by NAT_D:18;
hence ( ( - 1 ) |^ ( ( ( p ^2 ) -' 1 ) div 8 ) ) = ( ( ( - 1 ) |^ ( 2 * ( ( 4 * ( nn ^2 ) ) + ( 3 * nn ) ) ) ) * ( - 1 ) ) by NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( ( 4 * ( nn ^2 ) ) + ( 3 * nn ) ) ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( ( 4 * ( nn ^2 ) ) + ( 3 * nn ) ) ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ ( ( 4 * ( nn ^2 ) ) + ( 3 * nn ) ) ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( Lege (2,p) ) by A71;
end;
suppose ( p mod 8 ) = 5;

then A72: p = ( ( 8 * nn ) + 5 ) by NAT_D:2;
then ( p -' 1 ) = ( 2 * ( ( 4 * nn ) + 2 ) ) by A2;
then A73: ( ( p -' 1 ) div 2 ) = ( ( 4 * nn ) + 2 ) by NAT_D:18;
A74: ( 4 * nn ) >= ( 2 * nn ) by XREAL_1:64;
( p div 4 ) = ( ( ( 4 * ( ( 2 * nn ) + 1 ) ) + 1 ) div 4 ) by A72
.= ( ( ( 2 * nn ) + 1 ) + ( 1 div 4 ) ) by NAT_D:61
.= ( ( ( 2 * nn ) + 1 ) + ( 0 ) ) by NAT_D:27;
then m = ( ( ( 4 * nn ) + 2 ) - ( ( 2 * nn ) + 1 ) ) by A59,A73,A74,XREAL_1:7,XREAL_1:233
.= ( ( 2 * nn ) + 1 );
then A75: ( Lege (2,p) ) = ( ( ( - 1 ) |^ ( 2 * nn ) ) * ( - 1 ) ) by A15,NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ nn ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ nn ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ nn ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( - 1 );
( ( ( p ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( nn ^2 ) ) ) + ( 8 * ( 10 * nn ) ) ) + 25 ) - 1 ) div 8 ) by A72,NAT_1:12,XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( nn ^2 ) ) + ( 10 * nn ) ) + 3 ) ) div 8 )
.= ( ( ( 8 * ( nn ^2 ) ) + ( 10 * nn ) ) + 3 ) by NAT_D:18;
hence ( ( - 1 ) |^ ( ( ( p ^2 ) -' 1 ) div 8 ) ) = ( ( - 1 ) |^ ( ( ( ( 2 * ( 4 * ( nn ^2 ) ) ) + ( 2 * ( 5 * nn ) ) ) + ( 2 * 1 ) ) + 1 ) )
.= ( ( ( - 1 ) |^ ( 2 * ( ( ( 4 * ( nn ^2 ) ) + ( 5 * nn ) ) + 1 ) ) ) * ( - 1 ) ) by NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( ( ( 4 * ( nn ^2 ) ) + ( 5 * nn ) ) + 1 ) ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( ( ( 4 * ( nn ^2 ) ) + ( 5 * nn ) ) + 1 ) ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ ( ( ( 4 * ( nn ^2 ) ) + ( 5 * nn ) ) + 1 ) ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( Lege (2,p) ) by A75;
end;
suppose ( p mod 8 ) = 7;

then A76: p = ( ( 8 * nn ) + 7 ) by NAT_D:2;
then ( p -' 1 ) = ( 2 * ( ( 4 * nn ) + 3 ) ) by A2;
then A77: ( ( p -' 1 ) div 2 ) = ( ( 4 * nn ) + 3 ) by NAT_D:18;
A78: ( 4 * nn ) >= ( 2 * nn ) by XREAL_1:64;
( p div 4 ) = ( ( ( 4 * ( ( 2 * nn ) + 1 ) ) + 3 ) div 4 ) by A76
.= ( ( ( 2 * nn ) + 1 ) + ( 3 div 4 ) ) by NAT_D:61
.= ( ( ( 2 * nn ) + 1 ) + ( 0 ) ) by NAT_D:27;
then m = ( ( ( 4 * nn ) + 3 ) - ( ( 2 * nn ) + 1 ) ) by A59,A77,A78,XREAL_1:7,XREAL_1:233
.= ( ( 2 * nn ) + 2 );
then A79: ( Lege (2,p) ) = ( ( - 1 ) |^ ( 2 * ( nn + 1 ) ) ) by A13,A14,CKB47:1
.= ( ( ( - 1 ) |^ 2 ) |^ ( nn + 1 ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( nn + 1 ) ) by WSIERP_1:1
.= ( 1 |^ ( nn + 1 ) ) by NEWTON:10
.= 1 by NEWTON:10;
( ( ( p ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( nn ^2 ) ) ) + ( 8 * ( 14 * nn ) ) ) + 49 ) - 1 ) div 8 ) by A76,NAT_1:12,XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( nn ^2 ) ) + ( 14 * nn ) ) + 6 ) ) div 8 )
.= ( ( ( 8 * ( nn ^2 ) ) + ( 14 * nn ) ) + 6 ) by NAT_D:18;
hence ( ( - 1 ) |^ ( ( ( p ^2 ) -' 1 ) div 8 ) ) = ( ( - 1 ) |^ ( 2 * ( ( ( 4 * ( nn ^2 ) ) + ( 7 * nn ) ) + 3 ) ) )
.= ( ( ( - 1 ) |^ 2 ) |^ ( ( ( 4 * ( nn ^2 ) ) + ( 7 * nn ) ) + 3 ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( ( ( 4 * ( nn ^2 ) ) + ( 7 * nn ) ) + 3 ) ) by WSIERP_1:1
.= ( 1 |^ ( ( ( 4 * ( nn ^2 ) ) + ( 7 * nn ) ) + 3 ) ) by NEWTON:10
.= ( Lege (2,p) ) by A79,NEWTON:10;
end;
end;
