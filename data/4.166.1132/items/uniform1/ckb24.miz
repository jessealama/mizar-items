environ
vocabularies NUMBERS,REAL_1,SUBSET_1,XXREAL_0,CARD_1,ARYTM_3,RELAT_1,XBOOLE_0,METRIC_1,FUNCT_1,FCONT_2,PARTFUN1,PRE_TOPC,PCOMPS_1,ORDINAL2,RCOMP_1,XREAL_0,ORDINAL1,STRUCT_0,TARSKI,SETFAM_1,FINSET_1,ZFMISC_1,TOPMETR,BORSUK_1,EUCLID,FINSEQ_1,ORDINAL4,COMPLEX1,ARYTM_1,XXREAL_1,VALUED_0,MEASURE5,NAT_1,INT_1,XXREAL_2;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,SETFAM_1,COMPLEX1,REAL_1,NAT_1,NAT_D,ORDINAL1,INT_1,RCOMP_1,FUNCT_1,PARTFUN1,FINSEQ_1,RELSET_1,FUNCT_2,SEQM_3,STRUCT_0,TOPMETR,PRE_TOPC,TOPS_2,COMPTS_1,EUCLID,FINSET_1,TBSP_1,METRIC_1,PCOMPS_1,CKB2,CKB20;
definitions TARSKI,ORDINAL1,EUCLID,PRE_TOPC,XCMPLX_0,CKB2,CKB20;
theorems TARSKI,RCOMP_1,TOPMETR,TOPS_1,METRIC_1,FUNCT_1,FUNCT_2,TBSP_1,NAT_1,FINSEQ_3,FINSEQ_1,ABSVALUE,PRE_TOPC,TOPS_2,FINSEQ_4,GOBOARD6,PCOMPS_1,SETFAM_1,SUBSET_1,COMPTS_1,SEQ_4,HEINE,INT_1,JORDAN2B,XBOOLE_0,XBOOLE_1,XREAL_0,FINSEQ_2,XCMPLX_1,FINSET_1,XREAL_1,XXREAL_0,PARTFUN1,XXREAL_1,EUCLID,SEQM_3,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23;
schemes FUNCT_2,DOMAIN_1,SUBSET_1,FINSEQ_1,NAT_1;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,STRUCT_0,METRIC_1,PCOMPS_1,EUCLID,TOPMETR,BORSUK_2,VALUED_0,FUNCT_2,BORSUK_1;
constructors SETFAM_1,REAL_1,NAT_1,COMPLEX1,RCOMP_1,BINARITH,TOPS_2,COMPTS_1,TBSP_1,TOPMETR,GOBOARD1,SEQ_1,SEQM_3,NAT_D,FUNCSDOM,PCOMPS_1,CKB2,CKB20;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve r1 for Real;
reserve r2 for Real;
reserve n for (Element of ( NAT ));
theorem
(for e being Real holds (for g being (Function of ( I[01] ),( TOP-REAL n )) holds (for p1,p2 being (Element of ( TOP-REAL n )) holds ((e > ( 0 ) & g is  continuous) implies (ex h being (FinSequence of ( REAL )) st (((((( h . 1 ) = 1 & ( h . ( len h ) ) = ( 0 )) & 5 <= ( len h )) & ( rng h ) c= (the carrier of ( I[01] ))) & h is  decreasing) & (for i being (Element of ( NAT )) holds (for Q being (Subset of ( I[01] )) holds (for W being (Subset of ( Euclid n )) holds ((((1 <= i & i < ( len h )) & Q = [. ( h /. ( i + 1 ) ),( h /. i ) .]) & W = ( g .: Q )) implies ( diameter W ) < e))))))))))
proof
let e being Real;
let g being (Function of ( I[01] ),( TOP-REAL n ));
let p1 being (Element of ( TOP-REAL n )),p2 being (Element of ( TOP-REAL n ));
A1: ( dom g ) = (the carrier of ( I[01] )) by FUNCT_2:def 1;
A2: ( the TopStruct of ( TOP-REAL n ) ) = ( TopSpaceMetr ( Euclid n ) ) by EUCLID:def 8;
then reconsider h = g as (Function of ( I[01] ),( TopSpaceMetr ( Euclid n ) ));
reconsider f = g as (Function of ( Closed-Interval-MSpace (( 0 ),1) ),( Euclid n )) by CKB11:1,EUCLID:67;
assume that
A3: e > ( 0 )
and
A4: g is  continuous;
A5: ( e / 2 ) > ( 0 ) by A3,XREAL_1:215;
h is  continuous by A4,A2,PRE_TOPC:33;
then f is  uniformly_continuous by CKB9:1,CKB8:1,TOPMETR:20;
then consider s1 being Real such that A6: ( 0 ) < s1 and A7: (for u1,u2 being (Element of ( Closed-Interval-MSpace (( 0 ),1) )) holds (( dist (u1,u2) ) < s1 implies ( dist (( f /. u1 ),( f /. u2 )) ) < ( e / 2 ))) by A5,CKB2:def 1;
set s = ( min (s1,( 1 / 2 )) );
defpred P[ Nat,set ]
 means
$2 = ( 1 - ( ( s / 2 ) * ( $1 - 1 ) ) );
A8: ( 0 ) <= s by A6,XXREAL_0:20;
then reconsider j = [/ ( 2 / s ) \] as (Element of ( NAT )) by INT_1:53;
A9: ( 2 / s ) <= j by INT_1:def 7;
A10: s <= s1 by XXREAL_0:17;
A11: (for u1,u2 being (Element of ( Closed-Interval-MSpace (( 0 ),1) )) holds (( dist (u1,u2) ) < s implies ( dist (( f /. u1 ),( f /. u2 )) ) < ( e / 2 )))
proof
let u1 being (Element of ( Closed-Interval-MSpace (( 0 ),1) )),u2 being (Element of ( Closed-Interval-MSpace (( 0 ),1) ));
assume ( dist (u1,u2) ) < s;
then ( dist (u1,u2) ) < s1 by A10,XXREAL_0:2;
hence thesis by A7;
end;
A12: ( 2 / s ) <= [/ ( 2 / s ) \] by INT_1:def 7;
then ( ( 2 / s ) - j ) <= ( 0 ) by XREAL_1:47;
then ( 1 + ( ( 2 / s ) - j ) ) <= ( 1 + ( 0 ) ) by XREAL_1:6;
then A13: ( ( s / 2 ) * ( 1 + ( ( 2 / s ) - j ) ) ) <= ( ( s / 2 ) * 1 ) by A8,XREAL_1:64;
A14: (for k being Nat holds (k in ( Seg j ) implies (ex x st P[ k,x ])));
consider p being FinSequence such that A15: (( dom p ) = ( Seg j ) & (for k being Nat holds (k in ( Seg j ) implies P[ k,( p . k ) ]))) from FINSEQ_1:sch 1(A14);
A16: ( Seg ( len p ) ) = ( Seg j ) by A15,FINSEQ_1:def 3;
( rng ( p ^ <* (( 0 ) qua Real) *> ) ) c= ( REAL )
proof
let y;
A17: ( len ( p ^ <* (( 0 ) qua Real) *> ) ) = ( ( len p ) + ( len <* (( 0 ) qua Real) *> ) ) by FINSEQ_1:22
.= ( ( len p ) + 1 ) by FINSEQ_1:40;
assume y in ( rng ( p ^ <* (( 0 ) qua Real) *> ) );
then consider x such that A18: x in ( dom ( p ^ <* (( 0 ) qua Real) *> ) ) and A19: y = ( ( p ^ <* (( 0 ) qua Real) *> ) . x ) by FUNCT_1:def 3;
reconsider nx = x as (Element of ( NAT )) by A18;
A20: ( dom ( p ^ <* (( 0 ) qua Real) *> ) ) = ( Seg ( len ( p ^ <* (( 0 ) qua Real) *> ) ) ) by FINSEQ_1:def 3;
then A21: nx <= ( len ( p ^ <* (( 0 ) qua Real) *> ) ) by A18,FINSEQ_1:1;
A22: 1 <= nx by A18,A20,FINSEQ_1:1;
A23: 1 <= nx by A18,A20,FINSEQ_1:1;
now
per cases ;
case nx < ( ( len p ) + 1 );
then A24: nx <= ( len p ) by NAT_1:13;
then nx in ( Seg j ) by A16,A22,FINSEQ_1:1;
then A25: ( p . nx ) = ( 1 - ( ( s / 2 ) * ( nx - 1 ) ) ) by A15;
y = ( p . nx ) by A19,A23,A24,FINSEQ_1:64;
hence thesis by A25;
end;
case nx >= ( ( len p ) + 1 );
then nx = ( ( len p ) + 1 ) by A21,A17,XXREAL_0:1;
then y = ( 0 ) by A19,CKB15:1;
hence thesis;
end;
end;
hence thesis;
end;
then reconsider h1 = ( p ^ <* (( 0 ) qua Real) *> ) as (FinSequence of ( REAL )) by FINSEQ_1:def 4;
A26: ( len h1 ) = ( ( len p ) + ( len <* (( 0 ) qua Real) *> ) ) by FINSEQ_1:22
.= ( ( len p ) + 1 ) by FINSEQ_1:40;
A27: ( len p ) = j by A15,FINSEQ_1:def 3;
A28: s <> ( 0 ) by A6,XXREAL_0:15;
then ( 2 / s ) >= ( 2 / ( 1 / 2 ) ) by A8,XREAL_1:118,XXREAL_0:17;
then 4 <= j by A9,XXREAL_0:2;
then A29: ( 4 + 1 ) <= ( ( len p ) + 1 ) by A27,XREAL_1:6;
A30: ( s / 2 ) > ( 0 ) by A8,A28,XREAL_1:215;
A31: (for i being (Element of ( NAT )) holds (for r1 holds (for r2 holds ((((1 <= i & i < ( len p )) & r1 = ( p . i )) & r2 = ( p . ( i + 1 ) )) implies (r1 > r2 & ( r1 - r2 ) = ( s / 2 ))))))
proof
let i being (Element of ( NAT ));
let r1;
let r2;
assume that
A32: (1 <= i & i < ( len p ))
and
A33: r1 = ( p . i )
and
A34: r2 = ( p . ( i + 1 ) );
i in ( Seg j ) by A16,A32,FINSEQ_1:1;
then A35: r1 = ( 1 - ( ( s / 2 ) * ( i - 1 ) ) ) by A15,A33;
(1 < ( i + 1 ) & ( i + 1 ) <= ( len p )) by A32,NAT_1:13;
then ( i + 1 ) in ( Seg j ) by A16,FINSEQ_1:1;
then A36: r2 = ( 1 - ( ( s / 2 ) * ( ( i + 1 ) - 1 ) ) ) by A15,A34;
i < ( i + 1 ) by NAT_1:13;
then ( i - 1 ) < ( ( i + 1 ) - 1 ) by XREAL_1:9;
then ( ( s / 2 ) * ( i - 1 ) ) < ( ( s / 2 ) * ( ( i + 1 ) - 1 ) ) by A30,XREAL_1:68;
hence r1 > r2 by A35,A36,XREAL_1:15;
thus thesis by A35,A36;
end;
( 0 ) < s by A6,XXREAL_0:15;
then ( 0 ) < j by A12,XREAL_1:139;
then A37: ( ( 0 ) + 1 ) <= j by NAT_1:13;
then 1 in ( Seg j ) by FINSEQ_1:1;
then ( p . 1 ) = ( 1 - ( ( s / 2 ) * ( 1 - 1 ) ) ) by A15
.= 1;
then A38: ( h1 . 1 ) = 1 by A37,A27,CKB16:1;
( 2 * s ) <> ( 0 ) by A6,XXREAL_0:15;
then A39: (( ( s / 2 ) * ( 2 / s ) ) = ( ( 2 * s ) / ( 2 * s ) ) & ( ( 2 * s ) / ( 2 * s ) ) = 1) by XCMPLX_1:60,XCMPLX_1:76;
then A40: ( 1 - ( ( s / 2 ) * ( j - 1 ) ) ) = ( ( s / 2 ) * ( 1 + ( ( 2 / s ) - [/ ( 2 / s ) \] ) ) );
A41: (for r1 holds (r1 = ( p . ( len p ) ) implies ( r1 - ( 0 ) ) <= ( s / 2 )))
proof
let r1;
assume A42: r1 = ( p . ( len p ) );
( len p ) in ( Seg j ) by A37,A27,FINSEQ_1:1;
then r1 = ( 1 - ( ( s / 2 ) * ( ( len p ) - 1 ) ) ) by A15,A42;
hence thesis by A13,A15,A40,FINSEQ_1:def 3;
end;
A43: (for i being (Element of ( NAT )) holds ((1 <= i & i < ( len h1 )) implies ( ( h1 /. i ) - ( h1 /. ( i + 1 ) ) ) <= ( s / 2 )))
proof
let i being (Element of ( NAT ));
assume that
A44: 1 <= i
and
A45: i < ( len h1 );
A46: ( i + 1 ) <= ( len h1 ) by A45,NAT_1:13;
A47: 1 < ( i + 1 ) by A44,NAT_1:13;
A48: i <= ( len p ) by A26,A45,NAT_1:13;
now
per cases ;
case A49: i < ( len p );
then ( i + 1 ) <= ( len p ) by NAT_1:13;
then A50: ( h1 . ( i + 1 ) ) = ( p . ( i + 1 ) ) by A47,FINSEQ_1:64;
A51: ( h1 . i ) = ( p . i ) by A44,A49,FINSEQ_1:64;
(( h1 . i ) = ( h1 /. i ) & ( h1 . ( i + 1 ) ) = ( h1 /. ( i + 1 ) )) by A44,A45,A46,A47,FINSEQ_4:15;
hence thesis by A31,A44,A49,A51,A50;
end;
case i >= ( len p );
then A52: i = ( len p ) by A48,XXREAL_0:1;
A53: ( h1 /. i ) = ( h1 . i ) by A44,A45,FINSEQ_4:15
.= ( p . i ) by A44,A48,FINSEQ_1:64;
( h1 /. ( i + 1 ) ) = ( h1 . ( i + 1 ) ) by A46,A47,FINSEQ_4:15
.= ( 0 ) by A52,CKB15:1;
hence thesis by A41,A52,A53;
end;
end;
hence thesis;
end;
[/ ( 2 / s ) \] < ( ( 2 / s ) + 1 ) by INT_1:def 7;
then ( [/ ( 2 / s ) \] - 1 ) < ( ( ( 2 / s ) + 1 ) - 1 ) by XREAL_1:9;
then A54: ( ( s / 2 ) * ( j - 1 ) ) < ( ( s / 2 ) * ( 2 / s ) ) by A30,XREAL_1:68;
A55: (for i being (Element of ( NAT )) holds (for r1 holds (((1 <= i & i <= ( len p )) & r1 = ( p . i )) implies ( 0 ) < r1)))
proof
let i being (Element of ( NAT ));
let r1;
assume that
A56: 1 <= i
and
A57: i <= ( len p )
and
A58: r1 = ( p . i );
( i - 1 ) <= ( j - 1 ) by A27,A57,XREAL_1:9;
then ( ( s / 2 ) * ( i - 1 ) ) <= ( ( s / 2 ) * ( j - 1 ) ) by A8,XREAL_1:64;
then ( ( s / 2 ) * ( i - 1 ) ) < 1 by A54,A39,XXREAL_0:2;
then A59: ( 1 - ( ( s / 2 ) * ( i - 1 ) ) ) > ( 1 - 1 ) by XREAL_1:10;
i in ( Seg j ) by A16,A56,A57,FINSEQ_1:1;
hence thesis by A15,A58,A59;
end;
A60: (for i being (Element of ( NAT )) holds ((1 <= i & i < ( len h1 )) implies ( h1 /. i ) > ( h1 /. ( i + 1 ) )))
proof
let i being (Element of ( NAT ));
assume that
A61: 1 <= i
and
A62: i < ( len h1 );
A63: 1 < ( i + 1 ) by A61,NAT_1:13;
A64: i <= ( len p ) by A26,A62,NAT_1:13;
A65: ( i + 1 ) <= ( len h1 ) by A62,NAT_1:13;
now
per cases ;
case A66: i < ( len p );
then ( i + 1 ) <= ( len p ) by NAT_1:13;
then A67: ( h1 . ( i + 1 ) ) = ( p . ( i + 1 ) ) by A63,FINSEQ_1:64;
A68: ( h1 . i ) = ( p . i ) by A61,A66,FINSEQ_1:64;
(( h1 . i ) = ( h1 /. i ) & ( h1 . ( i + 1 ) ) = ( h1 /. ( i + 1 ) )) by A61,A62,A65,A63,FINSEQ_4:15;
hence thesis by A31,A61,A66,A68,A67;
end;
case i >= ( len p );
then A69: i = ( len p ) by A64,XXREAL_0:1;
A70: ( h1 /. i ) = ( h1 . i ) by A61,A62,FINSEQ_4:15
.= ( p . i ) by A61,A64,FINSEQ_1:64;
( h1 /. ( i + 1 ) ) = ( h1 . ( i + 1 ) ) by A65,A63,FINSEQ_4:15
.= ( 0 ) by A69,CKB15:1;
hence thesis by A55,A61,A64,A70;
end;
end;
hence thesis;
end;
A71: ( e / 2 ) < e by A3,XREAL_1:216;
A72: (for i being (Element of ( NAT )) holds (for Q being (Subset of ( I[01] )) holds (for W being (Subset of ( Euclid n )) holds ((((1 <= i & i < ( len h1 )) & Q = [. ( h1 /. ( i + 1 ) ),( h1 /. i ) .]) & W = ( g .: Q )) implies ( diameter W ) < e))))
proof
let i being (Element of ( NAT ));
let Q being (Subset of ( I[01] ));
let W being (Subset of ( Euclid n ));
assume that
A73: (1 <= i & i < ( len h1 ))
and
A74: Q = [. ( h1 /. ( i + 1 ) ),( h1 /. i ) .]
and
A75: W = ( g .: Q );
( h1 /. i ) > ( h1 /. ( i + 1 ) ) by A60,A73;
then A76: Q <> ( {} ) by A74,XXREAL_1:1;
A77: (for x,y being (Point of ( Euclid n )) holds ((x in W & y in W) implies ( dist (x,y) ) <= ( e / 2 )))
proof
let x being (Point of ( Euclid n )),y being (Point of ( Euclid n ));
assume that
A78: x in W
and
A79: y in W;
consider x3 being set such that A80: x3 in ( dom g ) and A81: x3 in Q and A82: x = ( g . x3 ) by A75,A78,FUNCT_1:def 6;
reconsider x3 as (Element of ( Closed-Interval-MSpace (( 0 ),1) )) by A80,CKB10:1,TOPMETR:12;
reconsider r3 = x3 as Real by A74,A81;
A83: x = ( f /. x3 ) by A82;
consider y3 being set such that A84: y3 in ( dom g ) and A85: y3 in Q and A86: y = ( g . y3 ) by A75,A79,FUNCT_1:def 6;
reconsider y3 as (Element of ( Closed-Interval-MSpace (( 0 ),1) )) by A84,CKB10:1,TOPMETR:12;
reconsider s3 = y3 as Real by A74,A85;
A87: ( ( h1 /. i ) - ( h1 /. ( i + 1 ) ) ) <= ( s / 2 ) by A43,A73;
( abs ( r3 - s3 ) ) <= ( ( h1 /. i ) - ( h1 /. ( i + 1 ) ) ) by A74,A81,A85,CKB19:1;
then A88: ( abs ( r3 - s3 ) ) <= ( s / 2 ) by A87,XXREAL_0:2;
(( dist (x3,y3) ) = ( abs ( r3 - s3 ) ) & ( s / 2 ) < s) by A8,A28,HEINE:1,XREAL_1:216;
then (( f . y3 ) = ( f /. y3 ) & ( dist (x3,y3) ) < s) by A88,XXREAL_0:2;
hence thesis by A11,A86,A83;
end;
then W is  bounded by A5,TBSP_1:def 7;
then ( diameter W ) <= ( e / 2 ) by A1,A75,A76,A77,TBSP_1:def 8;
hence thesis by A71,XXREAL_0:2;
end;
( 0 ) in { r where r is Real: (( 0 ) <= r & r <= 1) };
then A89: ( 0 ) in [. ( 0 ),1 .] by RCOMP_1:def 1;
{ ( 0 ) } c= [. ( 0 ),1 .]
proof
let x being set;
assume x in { ( 0 ) };
hence thesis by A89,TARSKI:def 1;
end;
then A90: ( [. ( 0 ),1 .] \/ { ( 0 ) } ) = [. ( 0 ),1 .] by XBOOLE_1:12;
( Closed-Interval-TSpace (( 0 ),1) ) = ( TopSpaceMetr ( Closed-Interval-MSpace (( 0 ),1) ) ) by TOPMETR:def 7;
then A91: (the carrier of ( I[01] )) = (the carrier of ( Closed-Interval-MSpace (( 0 ),1) )) by TOPMETR:12,TOPMETR:20
.= [. (( 0 ) qua Real),(1 qua Real) .] by TOPMETR:10;
A92: ( rng p ) c= [. ( 0 ),1 .]
proof
let y being set;
assume y in ( rng p );
then consider x being set such that A93: x in ( dom p ) and A94: y = ( p . x ) by FUNCT_1:def 3;
reconsider nx = x as (Element of ( NAT )) by A93;
A95: ( p . nx ) = ( 1 - ( ( s / 2 ) * ( nx - 1 ) ) ) by A15,A93;
then reconsider ry = ( p . nx ) as Real;
A96: x in ( Seg ( len p ) ) by A93,FINSEQ_1:def 3;
then A97: 1 <= nx by FINSEQ_1:1;
then ( nx - 1 ) >= ( 1 - 1 ) by XREAL_1:9;
then A98: ( 1 - ( ( s / 2 ) * ( nx - 1 ) ) ) <= ( 1 - ( 0 ) ) by A8,XREAL_1:6;
nx <= ( len p ) by A96,FINSEQ_1:1;
then ( 0 ) < ry by A55,A97;
then y in { rs where rs is Real: (( 0 ) <= rs & rs <= 1) } by A94,A95,A98;
hence thesis by RCOMP_1:def 1;
end;
( rng <* (( 0 ) qua Real) *> ) = { ( 0 ) } by FINSEQ_1:38;
then ( rng h1 ) = ( ( rng p ) \/ { ( 0 ) } ) by FINSEQ_1:31;
then A99: ( rng h1 ) c= ( [. ( 0 ),1 .] \/ { ( 0 ) } ) by A92,XBOOLE_1:13;
( h1 . ( len h1 ) ) = ( 0 ) by A26,CKB15:1;
hence thesis by A26,A29,A38,A90,A99,A91,A60,A72,CKB22:1;
end;
