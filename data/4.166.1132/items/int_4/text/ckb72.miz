environ
vocabularies NUMBERS,INT_1,NAT_1,SUBSET_1,MEMBERED,XREAL_0,ORDINAL1,MEMBER_1,TARSKI,REAL_1,ARYTM_3,FUNCT_1,RELAT_1,FINSET_1,CARD_1,XBOOLE_0,ARYTM_1,INT_2,XXREAL_0,COMPLEX1,NEWTON,SQUARE_1,PARTFUN1,EQREL_1,RELAT_2,EULER_1,FINSEQ_1,FINSEQ_3,ORDINAL4,CARD_3,XCMPLX_0,PRE_POLY,NAT_3,UPROOTS,INT_4;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,NUMBERS,MEMBERED,ORDINAL1,XXREAL_0,XCMPLX_0,XREAL_0,INT_1,NAT_1,REAL_1,INT_2,NAT_D,NEWTON,SQUARE_1,RELAT_1,FUNCT_1,FINSEQ_1,RELSET_1,RVSUM_1,EULER_1,EQREL_1,RELAT_2,PARTFUN1,FINSET_1,POLYNOM2,NAT_3,UPROOTS,TREES_4,WSIERP_1,MEASURE6,INTEGRA2,RECDEF_1,CKB36,CKB67;
definitions FUNCT_1,INT_1,FINSEQ_1,XCMPLX_0,EULER_1,SQUARE_1,RELAT_2,PARTFUN1,CARD_1,TARSKI,XBOOLE_0,WELLORD2,CKB36,CKB67;
theorems RELAT_1,FINSEQ_3,FINSEQ_2,ABSVALUE,FINSEQ_5,EULER_2,INT_3,CARD_2,SEQ_2,RELAT_2,RELSET_1,EQREL_1,CARD_FIN,ORDERS_1,FINSEQ_4,AXIOMS,MOEBIUS1,XBOOLE_0,NAT_3,NEWTON,INT_2,WSIERP_1,CARD_1,PEPIN,NAT_1,XCMPLX_1,XREAL_1,ORDINAL1,EULER_1,FINSEQ_1,XBOOLE_1,TARSKI,ZFMISC_1,RVSUM_1,INT_1,FUNCT_1,RADIX_1,XXREAL_0,NAT_D,XREAL_0,INTEGRA2,VALUED_0,FUNCT_2,MEMBER_1,MEMBERED,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB38,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71;
schemes NAT_1,FINSEQ_1,FINSEQ_2,RELSET_1,GRAPH_5;
registrations RELAT_1,FINSEQ_1,CARD_1,PARTFUN1,NAT_1,INT_1,MEMBERED,FINSET_1,SEQM_3,NEWTON,NAT_3,XXREAL_0,NUMBERS,XBOOLE_0,XREAL_0,ORDINAL1,FUNCT_1,VALUED_0,UPROOTS,FUNCT_2,RELSET_1,CKB2,CKB9,CKB28,CKB37,CKB39;
constructors EULER_1,REAL_1,EQREL_1,WELLORD2,BINARITH,WSIERP_1,PEPIN,POLYNOM2,UPROOTS,NAT_3,NAT_D,MEASURE6,INTEGRA2,SEQ_1,RECDEF_1,RELSET_1,PBOOLE,CKB36,CKB67;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve b for (Element of ( NAT ));
reserve c for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
theorem
Th52: (for X being  finite (Subset of ( INT )) holds ((( card X ) = m & (for x,y being Integer holds (((x in X & y in X) & x <> y) implies (not [ x,y ] in ( Cong m ))))) implies X is_CRS_of m))
proof
let X being  finite (Subset of ( INT ));
assume that
A1: ( card X ) = m
and
A2: (for x,y being Integer holds (((x in X & y in X) & x <> y) implies (not [ x,y ] in ( Cong m ))));
per cases ;
suppose X is  empty;

hence thesis by A1,CKB70:1,CARD_1:27;
end;
suppose X is non empty;

then reconsider X as non empty  finite (Subset of ( INT ));
defpred P[ Nat,set ]
 means
$2 in ( Class (( Cong m ),( $1 -' 1 )) );
A3: X <> ( {} );
A4: (for a being Nat holds (a in ( Seg m ) implies (ex y being (Element of X) st P[ a,y ])))
proof
set Y = ( Segm m );
let a being Nat;
assume that
A5: a in ( Seg m );
a <= m by A5,FINSEQ_1:1;
then A6: ( a - 1 ) < m by XREAL_1:147;
consider fp being FinSequence such that A7: ( len fp ) = m and A8: (for b holds (b in ( dom fp ) implies ( fp . b ) in X)) and A9: fp is  one-to-one by A1,CKB71:1;
(for b being Nat holds (b in ( dom fp ) implies ( fp . b ) in X)) by A8;
then reconsider fp as (FinSequence of X) by FINSEQ_2:12;
defpred PP[ Nat,set ]
 means
( fp . $1 ) in ( Class (( Cong m ),$2) );
A10: (for c holds (c in ( Seg m ) implies (ex r being (Element of Y) st PP[ c,r ])))
proof
let c;
assume c in ( Seg m );
consider q being Integer,r being Integer such that A11: ( fp . c ) = ( ( m * q ) + r ) and A12: r >= ( 0 ) and A13: r < m by A1,CKB22:1;
( ( fp . c ) mod m ) = ( r mod m ) by A11,NAT_D:61;
then r,( fp . c ) are_congruent_mod m by A1,NAT_D:64;
then A14: [ r,( fp . c ) ] in ( Cong m ) by CKB36:def 1;
reconsider r as (Element of ( NAT )) by A12,INT_1:3;
reconsider r as (Element of Y) by A13,NAT_1:44;
take r;
thus thesis by A14,EQREL_1:18;
end;
reconsider Y as non empty set by A1,A3;
A15: (for c being Nat holds (c in ( Seg m ) implies (ex r being (Element of Y) st PP[ c,r ]))) by A10;
consider fr being (FinSequence of Y) such that A16: (( dom fr ) = ( Seg m ) & (for c being Nat holds (c in ( Seg m ) implies PP[ c,( fr . c ) ]))) from FINSEQ_1:sch 5(A15);
(for x1,x2 being set holds (((x1 in ( dom fr ) & x2 in ( dom fr )) & ( fr . x1 ) = ( fr . x2 )) implies x1 = x2))
proof
let x1 being set,x2 being set;
assume that
A17: x1 in ( dom fr )
and
A18: x2 in ( dom fr )
and
A19: ( fr . x1 ) = ( fr . x2 );
(( fp . x1 ) in ( Class (( Cong m ),( fr . x1 )) ) & ( fp . x2 ) in ( Class (( Cong m ),( fr . x1 )) )) by A16,A17,A18,A19;
then A20: [ ( fp . x1 ),( fp . x2 ) ] in ( Cong m ) by EQREL_1:22;
assume A21: x1 <> x2;
reconsider x1,x2 as (Element of ( NAT )) by A17,A18;
A22: x1 in ( dom fp ) by A7,A16,A17,FINSEQ_1:def 3;
then A23: ( fp . x1 ) in X by FINSEQ_2:11;
A24: x2 in ( dom fp ) by A7,A16,A18,FINSEQ_1:def 3;
then A25: ( fp . x2 ) in X by FINSEQ_2:11;
( fp . x1 ) <> ( fp . x2 ) by A9,A21,A22,A24,FUNCT_1:def 4;
hence contradiction by A2,A20,A23,A25;
end;
then fr is  one-to-one by FUNCT_1:def 4;
then A26: ( card ( rng fr ) ) = ( len fr ) by FINSEQ_4:62
.= m by A16,FINSEQ_1:def 3;
reconsider Y as  finite set;
a >= 1 by A5,FINSEQ_1:1;
then ( a -' 1 ) < m by A6,XREAL_1:233;
then A27: ( a -' 1 ) in Y by NAT_1:44;
m = { l where l is (Element of ( NAT )): l < m } by AXIOMS:4;
then Y is_CRS_of m by CKB68:1;
then ( card Y ) = m by CKB69:1;
then ( rng fr ) = Y by A26,CARD_FIN:1;
then consider w being set such that A28: w in ( dom fr ) and A29: ( fr . w ) = ( a -' 1 ) by A27,FUNCT_1:def 3;
reconsider w as (Element of ( NAT )) by A28;
w in ( dom fp ) by A7,A16,A28,FINSEQ_1:def 3;
then reconsider y = ( fp . w ) as (Element of X) by FINSEQ_2:11;
take y;
thus thesis by A16,A28,A29;
end;
consider fp being (FinSequence of X) such that A30: (( dom fp ) = ( Seg m ) & (for a being Nat holds (a in ( Seg m ) implies P[ a,( fp . a ) ]))) from FINSEQ_1:sch 5(A4);
A31: ( rng fp ) c= X by FINSEQ_1:def 4;
A32: ( len fp ) = m by A30,FINSEQ_1:def 3;
(for a,b being set holds (((a in ( dom fp ) & b in ( dom fp )) & ( fp . a ) = ( fp . b )) implies a = b))
proof
let a being set,b being set;
assume that
A33: a in ( dom fp )
and
A34: b in ( dom fp )
and
A35: ( fp . a ) = ( fp . b );
reconsider a,b as (Element of ( NAT )) by A33,A34;
A36: b >= 1 by A30,A34,FINSEQ_1:1;
A37: a >= 1 by A30,A33,FINSEQ_1:1;
then A38: ( ( a -' 1 ) - ( b -' 1 ) ) = ( ( a - 1 ) - ( b -' 1 ) ) by XREAL_1:233
.= ( ( a - 1 ) - ( b - 1 ) ) by A36,XREAL_1:233
.= ( a - b );
reconsider l = ( fp . a ),ll = ( fp . b ) as (Element of ( INT )) by A33,A34,FINSEQ_2:11;
( fp . b ) in ( Class (( Cong m ),( b -' 1 )) ) by A30,A34;
then [ ( b -' 1 ),( fp . b ) ] in ( Cong m ) by EQREL_1:18;
then ( b -' 1 ),ll are_congruent_mod m by CKB36:def 1;
then A39: l,( b -' 1 ) are_congruent_mod m by A35,INT_1:14;
b <= m by A30,A34,FINSEQ_1:1;
then ( a - b ) >= ( 1 - m ) by A37,XREAL_1:13;
then A40: ( a - b ) > ( - m ) by XREAL_1:145;
a <= m by A30,A33,FINSEQ_1:1;
then ( a - b ) <= ( m - 1 ) by A36,XREAL_1:13;
then ( a - b ) < m by XREAL_1:147;
then ( abs ( a - b ) ) < m by A40,SEQ_2:1;
then A41: ( abs ( a - b ) ) < ( abs m ) by ABSVALUE:def 1;
( fp . a ) in ( Class (( Cong m ),( a -' 1 )) ) by A30,A33;
then [ ( a -' 1 ),( fp . a ) ] in ( Cong m ) by EQREL_1:18;
then ( a -' 1 ),l are_congruent_mod m by CKB36:def 1;
then ( a -' 1 ),( b -' 1 ) are_congruent_mod m by A39,INT_1:15;
then A42: m divides ( a - b ) by A38,INT_2:15;
now
assume a <> b;
then ( a - b ) <> ( 0 );
hence contradiction by A42,A41,CKB15:1;
end;
hence thesis;
end;
then fp is  one-to-one by FUNCT_1:def 4;
then ( card X ) = ( card ( rng fp ) ) by A1,A32,FINSEQ_4:62;
then X = ( rng fp ) by A31,CARD_FIN:1;
hence thesis by A30,A32,CKB67:def 1;
end;
end;
