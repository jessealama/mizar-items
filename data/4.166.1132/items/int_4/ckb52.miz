environ
vocabularies NUMBERS,INT_1,NAT_1,SUBSET_1,MEMBERED,XREAL_0,ORDINAL1,MEMBER_1,TARSKI,REAL_1,ARYTM_3,FUNCT_1,RELAT_1,FINSET_1,CARD_1,XBOOLE_0,ARYTM_1,INT_2,XXREAL_0,COMPLEX1,NEWTON,SQUARE_1,PARTFUN1,EQREL_1,RELAT_2,EULER_1,FINSEQ_1,FINSEQ_3,ORDINAL4,CARD_3,XCMPLX_0,PRE_POLY,NAT_3,UPROOTS,INT_4;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,NUMBERS,MEMBERED,ORDINAL1,XXREAL_0,XCMPLX_0,XREAL_0,INT_1,NAT_1,REAL_1,INT_2,NAT_D,NEWTON,SQUARE_1,RELAT_1,FUNCT_1,FINSEQ_1,RELSET_1,RVSUM_1,EULER_1,EQREL_1,RELAT_2,PARTFUN1,FINSET_1,POLYNOM2,NAT_3,UPROOTS,TREES_4,WSIERP_1,MEASURE6,INTEGRA2,RECDEF_1,CKB36;
definitions FUNCT_1,INT_1,FINSEQ_1,XCMPLX_0,EULER_1,SQUARE_1,RELAT_2,PARTFUN1,CARD_1,TARSKI,XBOOLE_0,WELLORD2,CKB36;
theorems RELAT_1,FINSEQ_3,FINSEQ_2,ABSVALUE,FINSEQ_5,EULER_2,INT_3,CARD_2,SEQ_2,RELAT_2,RELSET_1,EQREL_1,CARD_FIN,ORDERS_1,FINSEQ_4,AXIOMS,MOEBIUS1,XBOOLE_0,NAT_3,NEWTON,INT_2,WSIERP_1,CARD_1,PEPIN,NAT_1,XCMPLX_1,XREAL_1,ORDINAL1,EULER_1,FINSEQ_1,XBOOLE_1,TARSKI,ZFMISC_1,RVSUM_1,INT_1,FUNCT_1,RADIX_1,XXREAL_0,NAT_D,XREAL_0,INTEGRA2,VALUED_0,FUNCT_2,MEMBER_1,MEMBERED,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB38,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51;
schemes NAT_1,FINSEQ_1,FINSEQ_2,RELSET_1,GRAPH_5;
registrations RELAT_1,FINSEQ_1,CARD_1,PARTFUN1,NAT_1,INT_1,MEMBERED,FINSET_1,SEQM_3,NEWTON,NAT_3,XXREAL_0,NUMBERS,XBOOLE_0,XREAL_0,ORDINAL1,FUNCT_1,VALUED_0,UPROOTS,FUNCT_2,RELSET_1,CKB2,CKB9,CKB28,CKB37,CKB39;
constructors EULER_1,REAL_1,EQREL_1,WELLORD2,BINARITH,WSIERP_1,PEPIN,POLYNOM2,UPROOTS,NAT_3,NAT_D,MEASURE6,INTEGRA2,SEQ_1,RECDEF_1,RELSET_1,PBOOLE,CKB36;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve fp for (FinSequence of ( NAT ));
reserve fp1 for (FinSequence of ( NAT ));
reserve b for (Element of ( NAT ));
reserve c for (Element of ( NAT ));
reserve a for Nat;
theorem
(((( len fp ) >= 2 & (for b holds (for c holds (((b in ( dom fp ) & c in ( dom fp )) & b <> c) implies ( ( fp . b ) gcd ( fp . c ) ) = 1)))) & (for b holds (b in ( dom fp ) implies ( fp . b ) <> ( 0 )))) implies (for fp1 holds (ex x being Integer st (for b holds (b in ( dom fp ) implies ( ( x - ( fp1 . b ) ) mod ( fp . b ) ) = ( 0 ))))))
proof
assume that
A1: ( len fp ) >= 2
and
A2: (for b holds (for c holds (((b in ( dom fp ) & c in ( dom fp )) & b <> c) implies ( ( fp . b ) gcd ( fp . c ) ) = 1)))
and
A3: (for b holds (b in ( dom fp ) implies ( fp . b ) <> ( 0 )));
consider fp2 being (FinSequence of ( NAT )),q being (Element of ( NAT )) such that A4: fp = ( fp2 ^ <* q *> ) by A1,FINSEQ_2:19;
deffunc F(Nat) = { l where l is (Element of ( NAT )): ( ( ( ( Product ( Del (fp,$1) ) ) * l ) - 1 ) mod ( fp . $1 ) ) = ( 0 ) };
defpred FF[ Nat,Nat ]
 means
$2 in F($1);
A5: (for a being Nat holds (a in ( Seg ( len fp ) ) implies (ex n being (Element of ( NAT )) st FF[ a,n ])))
proof
let a being Nat;
reconsider l = ( fp . a ) as Integer;
assume a in ( Seg ( len fp ) );
then A6: a in ( dom fp ) by FINSEQ_1:def 3;
then ( ( Product ( Del (fp,a) ) ) gcd ( fp . a ) ) = 1 by A1,A2,CKB45:1;
then A7: ( Product ( Del (fp,a) ) ),l are_relative_prime  by INT_2:def 3;
l <> ( 0 ) by A3,A6;
then consider n being Nat such that A8: ( ( ( ( Product ( Del (fp,a) ) ) * n ) - 1 ) mod l ) = ( 0 ) by A7,CKB25:1;
reconsider n as (Element of ( NAT )) by ORDINAL1:def 12;
take n;
thus thesis by A8;
end;
consider s being (FinSequence of ( NAT )) such that A9: (( dom s ) = ( Seg ( len fp ) ) & (for a being Nat holds (a in ( Seg ( len fp ) ) implies FF[ a,( s . a ) ]))) from FINSEQ_1:sch 5(A5);
let fp1;
set k = ( len fp2 );
deffunc P(Nat) = ( ( ( Product ( Del (fp,$1) ) ) * ( s . $1 ) ) * ( fp1 . $1 ) );
consider s1 being FinSequence such that A10: (( len s1 ) = ( k + 1 ) & (for a being Nat holds (a in ( dom s1 ) implies ( s1 . a ) = P(a)))) from FINSEQ_1:sch 2;
(for a being Nat holds (a in ( dom s1 ) implies ( s1 . a ) in ( NAT )))
proof
let a being Nat;
assume A11: a in ( dom s1 );
reconsider a as (Element of ( NAT )) by ORDINAL1:def 12;
( s1 . a ) = ( ( ( Product ( Del (fp,a) ) ) * ( s . a ) ) * ( fp1 . a ) ) by A10,A11;
hence thesis by ORDINAL1:def 12;
end;
then reconsider s1 as (FinSequence of ( NAT )) by FINSEQ_2:12;
set x = ( Sum s1 );
take x;
A12: ( len fp ) = ( k + 1 ) by A4,FINSEQ_2:16;
A13: (for a holds (for b holds (((a in ( dom fp ) & b in ( dom fp )) & a <> b) implies ( fp . b ) divides ( s1 . a ))))
proof
let a;
let b;
assume that
A14: a in ( dom fp )
and
A15: (b in ( dom fp ) & a <> b);
( len fp ) >= 1 by A1,XXREAL_0:2;
then ( fp . b ) divides ( ( Product ( Del (fp,a) ) ) * ( ( s . a ) * ( fp1 . a ) ) ) by A14,A15,CKB49:1,NAT_D:9;
then A16: ( fp . b ) divides ( ( ( Product ( Del (fp,a) ) ) * ( s . a ) ) * ( fp1 . a ) );
a in ( dom s1 ) by A12,A10,A14,FINSEQ_3:29;
hence thesis by A10,A16;
end;
A17: (for b holds (b in ( dom fp ) implies ( fp . b ) divides ( Sum ( Del (s1,b) ) )))
proof
let b;
assume A18: b in ( dom fp );
then b in ( Seg ( len s1 ) ) by A12,A10,FINSEQ_1:def 3;
then A19: b in ( dom s1 ) by FINSEQ_1:def 3;
then A20: ( ( len ( Del (s1,b) ) ) + 1 ) = ( k + 1 ) by A10,WSIERP_1:def 1;
(for a holds (a in ( dom ( Del (s1,b) ) ) implies ( fp . b ) divides ( ( Del (s1,b) ) . a )))
proof
let a;
assume A21: a in ( dom ( Del (s1,b) ) );
then A22: (a >= 1 & a <= k) by A20,FINSEQ_3:25;
( dom ( Del (s1,b) ) ) c= ( dom s1 ) by WSIERP_1:39;
then a in ( dom s1 ) by A21;
then a in ( Seg ( k + 1 ) ) by A10,FINSEQ_1:def 3;
then A23: a in ( dom fp ) by A12,FINSEQ_1:def 3;
per cases ;
suppose A24: a < b;

then ( ( Del (s1,b) ) . a ) = ( s1 . a ) by A19,WSIERP_1:def 1;
hence thesis by A13,A18,A23,A24;
end;
suppose A25: a >= b;

(( a + 1 ) <= ( k + 1 ) & ( a + 1 ) > 1) by A22,XREAL_1:6,XREAL_1:29;
then A26: ( a + 1 ) in ( dom fp ) by A12,FINSEQ_3:25;
(( ( Del (s1,b) ) . a ) = ( s1 . ( a + 1 ) ) & ( a + 1 ) > b) by A19,A25,WSIERP_1:def 1,XREAL_1:39;
hence thesis by A13,A18,A26;
end;
end;
hence thesis by CKB51:1;
end;
(for b holds (b in ( dom fp ) implies ( ( x - ( fp1 . b ) ) mod ( fp . b ) ) = ( 0 )))
proof
let b;
assume A27: b in ( dom fp );
then A28: ( fp . b ) <> ( 0 ) by A3;
A29: ( fp . b ) divides ( Sum ( Del (s1,b) ) ) by A17,A27;
A30: ( ( ( Sum ( Del (s1,b) ) ) + ( ( s1 . b ) - ( fp1 . b ) ) ) mod ( fp . b ) ) = ( ( ( s1 . b ) - ( fp1 . b ) ) mod ( fp . b ) )
proof
reconsider l = ( Sum ( Del (s1,b) ) ) as Integer;
A31: ( l mod ( fp . b ) ) = ( 0 ) by A29,A28,INT_1:62;
( ( ( Sum ( Del (s1,b) ) ) + ( ( s1 . b ) - ( fp1 . b ) ) ) mod ( fp . b ) ) = ( ( ( l mod ( fp . b ) ) + ( ( ( s1 . b ) - ( fp1 . b ) ) mod ( fp . b ) ) ) mod ( fp . b ) ) by NAT_D:66
.= ( ( ( s1 . b ) - ( fp1 . b ) ) mod ( fp . b ) ) by A31,NAT_D:65;
hence thesis;
end;
A32: (b >= 1 & b <= ( k + 1 )) by A12,A27,FINSEQ_3:25;
then A33: b in ( Seg ( k + 1 ) );
then b in ( dom s1 ) by A10,FINSEQ_1:def 3;
then A34: ( ( s1 . b ) - ( fp1 . b ) ) = ( ( ( ( Product ( Del (fp,b) ) ) * ( s . b ) ) * ( fp1 . b ) ) - ( 1 * ( fp1 . b ) ) ) by A10
.= ( ( ( ( Product ( Del (fp,b) ) ) * ( s . b ) ) - 1 ) * ( fp1 . b ) );
( s . b ) in F(b) by A12,A9,A33;
then A35: (ex ll being (Element of ( NAT )) st (ll = ( s . b ) & ( ( ( ( Product ( Del (fp,b) ) ) * ll ) - 1 ) mod ( fp . b ) ) = ( 0 )));
b in ( dom s1 ) by A10,A32,FINSEQ_3:25;
then ( ( x - ( fp1 . b ) ) mod ( fp . b ) ) = ( ( ( ( Sum ( Del (s1,b) ) ) + ( s1 . b ) ) - ( fp1 . b ) ) mod ( fp . b ) ) by WSIERP_1:20
.= ( 0 ) by A28,A34,A35,A30,CKB50:1;
hence thesis;
end;
hence thesis;
end;
