environ
vocabularies NUMBERS,XBOOLE_0,FUNCT_1,SUBSET_1,RELAT_1,XXREAL_0,CARD_1,FINSEQ_1,ORDERS_2,TOPS_2,FUNCT_2,FIN_TOPO,STRUCT_0,ARYTM_3,EQREL_1,XCMPLX_0,FINTOPO4,NAT_1,ARYTM_1,TARSKI,COMPLEX1,INT_1,ZFMISC_1,RELAT_2,FINTOPO5;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,NAT_D,RELAT_1,FUNCT_1,RELSET_1,EQREL_1,FUNCT_2,FINSEQ_1,STRUCT_0,FIN_TOPO,FINTOPO3,ENUMSET1,ORDERS_2,FINTOPO4,COMPLEX1,INT_1,CKB3,CKB12,CKB13,CKB14;
definitions TARSKI,FINSEQ_1,FIN_TOPO,RELAT_1,CKB3,CKB13,CKB14;
theorems NAT_1,NAT_2,ZFMISC_1,INT_1,FUNCT_1,FUNCT_2,FINSEQ_1,ABSVALUE,RELSET_1,XBOOLE_0,XBOOLE_1,UNIFORM1,FIN_TOPO,FINTOPO3,ENUMSET1,FINTOPO4,TARSKI,XREAL_1,COMPLEX1,XXREAL_0,ORDINAL1,XREAL_0,NAT_D,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB13,CKB14,CKB16,CKB17,CKB18;
schemes NAT_1,FUNCT_2;
registrations XBOOLE_0,SUBSET_1,RELSET_1,XXREAL_0,XREAL_0,REAL_1,NAT_1,INT_1,STRUCT_0,FIN_TOPO,ORDINAL1,FINSEQ_1,CKB15;
constructors ENUMSET1,REAL_1,NAT_1,EQREL_1,LIMFUNC1,FIN_TOPO,FINTOPO3,FINTOPO4,NAT_D,RELSET_1,CKB3,CKB12,CKB13,CKB14;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
definition
let n being (Element of ( NAT ));
let m being (Element of ( NAT ));
func Nbds2 (n,m) -> (Relation of [: ( Seg n ),( Seg m ) :]) means 
:Def4: (for x being set holds (x in [: ( Seg n ),( Seg m ) :] implies (for i,j being (Element of ( NAT )) holds (x = [ i,j ] implies ( Im (it,x) ) = ( [: { i },( Im (( Nbdl1 m ),j) ) :] \/ [: ( Im (( Nbdl1 n ),i) ),{ j } :] )))));
existence
proof
defpred P[ set,set ]
 means
(for i,j being (Element of ( NAT )) holds ($1 = [ i,j ] implies $2 = ( [: { i },( Im (( Nbdl1 m ),j) ) :] \/ [: ( Im (( Nbdl1 n ),i) ),{ j } :] )));
A1: (for x being set holds (x in [: ( Seg n ),( Seg m ) :] implies (ex y being set st (y in ( bool [: ( Seg n ),( Seg m ) :] ) & P[ x,y ]))))
proof
let x being set;
assume x in [: ( Seg n ),( Seg m ) :];
then consider u,y being set such that A2: u in ( Seg n ) and A3: y in ( Seg m ) and A4: x = [ u,y ] by ZFMISC_1:def 2;
reconsider i = u,j = y as (Element of ( NAT )) by A2,A3;
set y3 = ( [: { i },( Im (( Nbdl1 m ),j) ) :] \/ [: ( Im (( Nbdl1 n ),u) ),{ j } :] );
A5: y3 c= [: ( Seg n ),( Seg m ) :]
proof
let z being set;
assume A6: z in y3;
per cases  by A6,XBOOLE_0:def 3;
suppose z in [: { i },( Im (( Nbdl1 m ),j) ) :];

then consider x4,y4 being set such that A7: x4 in { i } and A8: (y4 in ( Im (( Nbdl1 m ),j) ) & z = [ x4,y4 ]) by ZFMISC_1:def 2;
x4 = i by A7,TARSKI:def 1;
hence thesis by A2,A8,ZFMISC_1:def 2;
end;
suppose z in [: ( Im (( Nbdl1 n ),u) ),{ j } :];

then consider x4,y4 being set such that A9: x4 in ( Im (( Nbdl1 n ),u) ) and A10: y4 in { j } and A11: z = [ x4,y4 ] by ZFMISC_1:def 2;
y4 in ( Seg m ) by A3,A10,TARSKI:def 1;
hence thesis by A9,A11,ZFMISC_1:def 2;
end;
end;
(for i4,j4 being (Element of ( NAT )) holds (x = [ i4,j4 ] implies y3 = ( [: { i4 },( Im (( Nbdl1 m ),j4) ) :] \/ [: ( Im (( Nbdl1 n ),i4) ),{ j4 } :] )))
proof
let i4 being (Element of ( NAT ));
let j4 being (Element of ( NAT ));
assume x = [ i4,j4 ];
then (i4 = u & j4 = y) by A4,ZFMISC_1:27;
hence thesis;
end;
hence thesis by A5;
end;
consider f being (Function of [: ( Seg n ),( Seg m ) :],( bool [: ( Seg n ),( Seg m ) :] )) such that A12: (for x being set holds (x in [: ( Seg n ),( Seg m ) :] implies P[ x,( f . x ) ])) from FUNCT_2:sch 1(A1);
consider R being (Relation of [: ( Seg n ),( Seg m ) :]) such that A13: (for i being set holds (i in [: ( Seg n ),( Seg m ) :] implies ( Im (R,i) ) = ( f . i ))) by FUNCT_2:93;
take R;
let x being set;
assume that
A14: x in [: ( Seg n ),( Seg m ) :];
let i being (Element of ( NAT ));
let j being (Element of ( NAT ));
assume that
A15: x = [ i,j ];
thus ( Im (R,x) ) = ( f . x ) by A13,A14
.= ( [: { i },( Im (( Nbdl1 m ),j) ) :] \/ [: ( Im (( Nbdl1 n ),i) ),{ j } :] ) by A12,A14,A15;
end;
uniqueness
proof
let f1 being (Relation of [: ( Seg n ),( Seg m ) :]);
let f2 being (Relation of [: ( Seg n ),( Seg m ) :]);
assume that
A16: (for x being set holds (x in [: ( Seg n ),( Seg m ) :] implies (for i,j being (Element of ( NAT )) holds (x = [ i,j ] implies ( Im (f1,x) ) = ( [: { i },( Im (( Nbdl1 m ),j) ) :] \/ [: ( Im (( Nbdl1 n ),i) ),{ j } :] )))))
and
A17: (for x being set holds (x in [: ( Seg n ),( Seg m ) :] implies (for i,j being (Element of ( NAT )) holds (x = [ i,j ] implies ( Im (f2,x) ) = ( [: { i },( Im (( Nbdl1 m ),j) ) :] \/ [: ( Im (( Nbdl1 n ),i) ),{ j } :] )))));
(for x being set holds (x in [: ( Seg n ),( Seg m ) :] implies ( Im (f1,x) ) = ( Im (f2,x) )))
proof
let x being set;
assume A18: x in [: ( Seg n ),( Seg m ) :];
then consider u,y being set such that A19: (u in ( Seg n ) & y in ( Seg m )) and A20: x = [ u,y ] by ZFMISC_1:def 2;
reconsider i = u,j = y as (Element of ( NAT )) by A19;
( Im (f1,x) ) = ( [: { i },( Im (( Nbdl1 m ),j) ) :] \/ [: ( Im (( Nbdl1 n ),u) ),{ j } :] ) by A16,A18,A20;
hence thesis by A17,A18,A20;
end;
hence f1 = f2 by RELSET_1:31;
end;
end;
