environ
vocabularies ORDERS_2,ARYTM_0,RELAT_1,SUBSET_1,XXREAL_0,XBOOLE_0,RELAT_2,STRUCT_0,LATTICE3,YELLOW_0,EQREL_1,LATTICES,REWRITE1,WAYBEL_0,TARSKI,FINSET_1,XXREAL_2,XBOOLEAN,FUNCT_1,CAT_1,WELLORD1,SEQM_3,WAYBEL_1,PBOOLE,WAYBEL_5,FUNCT_6,FUNCOP_1,FINSEQ_4,YELLOW_2,ORDINAL2,CARD_3,ZFMISC_1,YELLOW_7,CARD_1;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,RELAT_2,FUNCT_1,RELSET_1,FUNCT_2,FINSET_1,CARD_3,FUNCT_6,PRALG_1,PBOOLE,FUNCOP_1,STRUCT_0,ORDERS_2,LATTICE3,YELLOW_0,YELLOW_2,WAYBEL_1,WAYBEL_0,WAYBEL_5,CKB1,CKB50,CKB61;
definitions TARSKI,RELAT_2,ORDERS_2,LATTICE3,YELLOW_0,WAYBEL_0,WAYBEL_1,WAYBEL_5,XBOOLE_0,FUNCT_6,CKB50;
theorems RELAT_1,RELAT_2,FUNCT_1,FUNCT_2,CARD_3,ORDERS_2,LATTICE3,YELLOW_0,WAYBEL_0,YELLOW_2,WAYBEL_1,WAYBEL_5,PBOOLE,FUNCT_6,FUNCOP_1,PRALG_2,YELLOW_5,PRALG_1,XBOOLE_0,FUNCT_5,PARTFUN1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB49,CKB50,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB62,CKB63;
schemes CLASSES1,FUNCT_2;
registrations RELSET_1,FUNCOP_1,FINSET_1,CARD_3,PBOOLE,STRUCT_0,LATTICE3,YELLOW_0,WAYBEL_0,WAYBEL_1,WAYBEL_5,SUBSET_1,FUNCT_1,CARD_1,ORDINAL1,CKB9,CKB10,CKB11,CKB12,CKB23,CKB24,CKB25,CKB34,CKB46,CKB47,CKB48,CKB51,CKB52;
constructors DOMAIN_1,LATTICE3,PRALG_1,PRALG_2,ORDERS_3,WAYBEL_1,WAYBEL_5,RELSET_1,CKB50,CKB61;
requirements SUBSET,BOOLE,NUMERALS;
begin
theorem
Th48: (for L being  complete LATTICE holds (L is  completely-distributive iff (for J being non empty set holds (for K being  non-empty (ManySortedSet of J) holds (for F being (DoubleIndexedSet of K,L) holds ( Sup ( Infs F ) ) = ( Inf ( Sups ( Frege F ) ) ))))))
proof
let L being  complete LATTICE;
thus (L is  completely-distributive implies (for J being non empty set holds (for K being  non-empty (ManySortedSet of J) holds (for F being (DoubleIndexedSet of K,L) holds ( Sup ( Infs F ) ) = ( Inf ( Sups ( Frege F ) ) )))))
proof
assume that
L is  complete
and
A1: (for J being non empty set holds (for K being  non-empty (ManySortedSet of J) holds (for F being (DoubleIndexedSet of K,L) holds ( Inf ( Sups F ) ) = ( Sup ( Infs ( Frege F ) ) ))));
let J being non empty set;
let K being  non-empty (ManySortedSet of J);
let F being (DoubleIndexedSet of K,L);
A2: ( Inf ( Sups ( Frege F ) ) ) = ( Sup ( Infs ( Frege ( Frege F ) ) ) ) by A1;
A3: ( dom K ) = J by PARTFUN1:def 2;
A4: ( doms ( Frege F ) ) = ( ( product ( doms F ) ) --> J ) by CKB60:1;
A5: ( dom F ) = J by PARTFUN1:def 2;
A6: ( doms F ) = K by CKB60:1;
A7: ( dom ( Frege F ) ) = ( product ( doms F ) ) by PARTFUN1:def 2;
( rng ( Infs ( Frege ( Frege F ) ) ) ) is_<=_than ( Sup ( Infs F ) )
proof
reconsider J9 = ( product ( doms ( Frege F ) ) ) as non empty set;
let a being (Element of L);
reconsider K9 = ( J9 --> ( product ( doms F ) ) ) as (ManySortedSet of J9);
reconsider G = ( Frege ( Frege F ) ) as (DoubleIndexedSet of K9,L);
assume a in ( rng ( Infs ( Frege ( Frege F ) ) ) );
then consider g being (Element of J9) such that A8: a = ( Inf ( G . g ) ) by WAYBEL_5:14;
reconsider g9 = g as Function;
deffunc XX(set) = { ( f . ( g9 . f ) ) where f is (Element of ( product ( doms F ) )): ( g9 . f ) = $1 };
A9: ( dom ( ( product ( doms F ) ) --> J ) ) = ( product ( doms F ) ) by FUNCOP_1:13;
now
defpred P[ set,set ]
 means
$2 in ( ( K . $1 ) \ XX($1) );
assume A10: (for j being (Element of J) holds ( ( K . j ) \ XX(j) ) <> ( {} ));
A11:now
let j being set;
assume j in J;
then reconsider i = j as (Element of J);
set k = the (Element of ( ( K . i ) \ XX(j) ));
( ( K . i ) \ XX(i) ) <> ( {} ) by A10;
then k in ( ( K . i ) \ XX(i) );
hence (ex k being set st P[ j,k ]);
end;
consider h being Function such that A12: (( dom h ) = J & (for j being set holds (j in J implies P[ j,( h . j ) ]))) from CLASSES1:sch 1(A11);
now
let j being set;
assume j in J;
then ( h . j ) in ( ( K . j ) \ XX(j) ) by A12;
hence ( h . j ) in ( ( doms F ) . j ) by A6;
end;
then reconsider h as (Element of ( product ( doms F ) )) by A6,A3,A12,CARD_3:9;
( g9 . h ) in ( ( doms ( Frege F ) ) . h ) by A4,A9,CARD_3:9;
then reconsider j = ( g9 . h ) as (Element of J) by A4,FUNCOP_1:7;
(( h . ( g9 . h ) ) in XX(j) & ( h . j ) in ( ( K . j ) \ XX(j) )) by A12;
hence contradiction by XBOOLE_0:def 5;
end;
then consider j being (Element of J) such that A13: ( ( K . j ) \ XX(j) ) = ( {} );
A14: ( rng ( F . j ) ) c= ( rng ( G . g ) )
proof
let z being set;
assume z in ( rng ( F . j ) );
then consider u being set such that A15: u in ( dom ( F . j ) ) and A16: z = ( ( F . j ) . u ) by FUNCT_1:def 3;
reconsider u as (Element of ( K . j )) by A15;
u in XX(j) by A13,XBOOLE_0:def 5;
then consider f being (Element of ( product ( doms F ) )) such that A17: u = ( f . ( g9 . f ) ) and A18: ( g9 . f ) = j;
(( G . g ) = ( ( Frege F ) .. g9 ) & ( ( Frege F ) . f ) = ( F .. f )) by PRALG_2:def 2;
then ( ( G . g ) . f ) = ( ( F .. f ) . j ) by A7,A18,PRALG_1:def 17;
then A19: ( ( G . g ) . f ) = z by A5,A16,A17,A18,PRALG_1:def 17;
(( dom ( G . g ) ) = ( K9 . g ) & ( K9 . g ) = ( product ( doms F ) )) by FUNCOP_1:7,FUNCT_2:def 1;
hence thesis by A19,FUNCT_1:def 3;
end;
( ex_inf_of ( rng ( G . g ) ),L &  ex_inf_of ( rng ( F . j ) ),L) by YELLOW_0:17;
then ( inf ( rng ( G . g ) ) ) <= ( inf ( rng ( F . j ) ) ) by A14,YELLOW_0:35;
then a <= ( inf ( rng ( F . j ) ) ) by A8,YELLOW_2:def 6;
then A20: a <= ( Inf ( F . j ) ) by YELLOW_2:def 6;
( Inf ( F . j ) ) in ( rng ( Infs F ) ) by WAYBEL_5:14;
then ( Inf ( F . j ) ) <= ( sup ( rng ( Infs F ) ) ) by YELLOW_2:22;
then a <= ( sup ( rng ( Infs F ) ) ) by A20,ORDERS_2:3;
hence thesis by YELLOW_2:def 5;
end;
then ( sup ( rng ( Infs ( Frege ( Frege F ) ) ) ) ) <= ( Sup ( Infs F ) ) by YELLOW_0:32;
then A21: ( Sup ( Infs ( Frege ( Frege F ) ) ) ) <= ( Sup ( Infs F ) ) by YELLOW_2:def 5;
( Sup ( Infs F ) ) <= ( Inf ( Sups ( Frege F ) ) ) by CKB63:1;
hence thesis by A2,A21,ORDERS_2:2;
end;

assume A22: (for J being non empty set holds (for K being  non-empty (ManySortedSet of J) holds (for F being (DoubleIndexedSet of K,L) holds ( Sup ( Infs F ) ) = ( Inf ( Sups ( Frege F ) ) ))));
thus L is  complete;
let J being non empty set;
let K being  non-empty (ManySortedSet of J);
let F being (DoubleIndexedSet of K,L);
A23: ( dom K ) = J by PARTFUN1:def 2;
A24: ( doms ( Frege F ) ) = ( ( product ( doms F ) ) --> J ) by CKB60:1;
A25: ( dom F ) = J by PARTFUN1:def 2;
A26: ( doms F ) = K by CKB60:1;
A27: ( dom ( Frege F ) ) = ( product ( doms F ) ) by PARTFUN1:def 2;
( rng ( Sups ( Frege ( Frege F ) ) ) ) is_>=_than ( Inf ( Sups F ) )
proof
reconsider J9 = ( product ( doms ( Frege F ) ) ) as non empty set;
let a being (Element of L);
reconsider K9 = ( J9 --> ( product ( doms F ) ) ) as (ManySortedSet of J9);
reconsider G = ( Frege ( Frege F ) ) as (DoubleIndexedSet of K9,L);
assume a in ( rng ( Sups ( Frege ( Frege F ) ) ) );
then consider g being (Element of J9) such that A28: a = ( Sup ( G . g ) ) by WAYBEL_5:14;
reconsider g9 = g as Function;
deffunc XX(set) = { ( f . ( g9 . f ) ) where f is (Element of ( product ( doms F ) )): ( g9 . f ) = $1 };
A29: ( dom ( ( product ( doms F ) ) --> J ) ) = ( product ( doms F ) ) by FUNCOP_1:13;
now
defpred P[ set,set ]
 means
$2 in ( ( K . $1 ) \ XX($1) );
assume A30: (for j being (Element of J) holds ( ( K . j ) \ XX(j) ) <> ( {} ));
A31:now
let j being set;
assume j in J;
then reconsider i = j as (Element of J);
set k = the (Element of ( ( K . i ) \ XX(j) ));
( ( K . i ) \ XX(i) ) <> ( {} ) by A30;
then k in ( ( K . i ) \ XX(i) );
hence (ex k being set st P[ j,k ]);
end;
consider h being Function such that A32: (( dom h ) = J & (for j being set holds (j in J implies P[ j,( h . j ) ]))) from CLASSES1:sch 1(A31);
now
let j being set;
assume j in J;
then ( h . j ) in ( ( K . j ) \ XX(j) ) by A32;
hence ( h . j ) in ( ( doms F ) . j ) by A26;
end;
then reconsider h as (Element of ( product ( doms F ) )) by A26,A23,A32,CARD_3:9;
( g9 . h ) in ( ( doms ( Frege F ) ) . h ) by A24,A29,CARD_3:9;
then reconsider j = ( g9 . h ) as (Element of J) by A24,FUNCOP_1:7;
(( h . ( g9 . h ) ) in XX(j) & ( h . j ) in ( ( K . j ) \ XX(j) )) by A32;
hence contradiction by XBOOLE_0:def 5;
end;
then consider j being (Element of J) such that A33: ( ( K . j ) \ XX(j) ) = ( {} );
A34: ( rng ( F . j ) ) c= ( rng ( G . g ) )
proof
let z being set;
assume z in ( rng ( F . j ) );
then consider u being set such that A35: u in ( dom ( F . j ) ) and A36: z = ( ( F . j ) . u ) by FUNCT_1:def 3;
reconsider u as (Element of ( K . j )) by A35;
u in XX(j) by A33,XBOOLE_0:def 5;
then consider f being (Element of ( product ( doms F ) )) such that A37: u = ( f . ( g9 . f ) ) and A38: ( g9 . f ) = j;
(( G . g ) = ( ( Frege F ) .. g9 ) & ( ( Frege F ) . f ) = ( F .. f )) by PRALG_2:def 2;
then ( ( G . g ) . f ) = ( ( F .. f ) . j ) by A27,A38,PRALG_1:def 17;
then A39: ( ( G . g ) . f ) = z by A25,A36,A37,A38,PRALG_1:def 17;
(( dom ( G . g ) ) = ( K9 . g ) & ( K9 . g ) = ( product ( doms F ) )) by FUNCOP_1:7,FUNCT_2:def 1;
hence thesis by A39,FUNCT_1:def 3;
end;
( ex_sup_of ( rng ( G . g ) ),L &  ex_sup_of ( rng ( F . j ) ),L) by YELLOW_0:17;
then ( sup ( rng ( G . g ) ) ) >= ( sup ( rng ( F . j ) ) ) by A34,YELLOW_0:34;
then a >= ( sup ( rng ( F . j ) ) ) by A28,YELLOW_2:def 5;
then A40: a >= ( Sup ( F . j ) ) by YELLOW_2:def 5;
( Sup ( F . j ) ) in ( rng ( Sups F ) ) by WAYBEL_5:14;
then ( Sup ( F . j ) ) >= ( inf ( rng ( Sups F ) ) ) by YELLOW_2:22;
then a >= ( inf ( rng ( Sups F ) ) ) by A40,ORDERS_2:3;
hence thesis by YELLOW_2:def 6;
end;
then ( inf ( rng ( Sups ( Frege ( Frege F ) ) ) ) ) >= ( Inf ( Sups F ) ) by YELLOW_0:33;
then A41: ( Inf ( Sups ( Frege ( Frege F ) ) ) ) >= ( Inf ( Sups F ) ) by YELLOW_2:def 6;
(( Inf ( Sups F ) ) >= ( Sup ( Infs ( Frege F ) ) ) & ( Sup ( Infs ( Frege F ) ) ) = ( Inf ( Sups ( Frege ( Frege F ) ) ) )) by A22,WAYBEL_5:16;
hence thesis by A41,ORDERS_2:2;
end;
