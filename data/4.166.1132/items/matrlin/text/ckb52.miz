environ
vocabularies NUMBERS,NAT_1,XBOOLE_0,MATRIX_1,FINSEQ_3,RELAT_1,FINSEQ_1,TARSKI,ARYTM_3,XXREAL_0,CARD_1,TREES_1,FUNCT_1,INCSP_1,ORDINAL4,SUBSET_1,VECTSP_1,RLVECT_2,RLVECT_3,CARD_3,ARYTM_1,SUPINF_2,RLVECT_5,FINSET_1,STRUCT_0,RLSUB_1,ALGSTR_0,PARTFUN1,RLVECT_1,ZFMISC_1,QC_LANG1,FUNCT_2,VALUED_1,PRE_POLY,FINSEQ_2,RVSUM_1,FINSEQ_4,FVSUM_1,MATRLIN,MSSUBFAM,UNIALG_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,XCMPLX_0,NAT_1,MOD_2,FINSEQ_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCT_3,STRUCT_0,ALGSTR_0,MATRIX_1,MATRIX_3,FVSUM_1,RLVECT_1,VECTSP_1,VECTSP_4,VECTSP_6,VECTSP_7,FINSET_1,FINSEQ_3,FINSEQ_2,FINSEQOP,BINOP_1,XXREAL_0,PRE_POLY,GRCAT_1,CKB1,CKB6,CKB11,CKB13,CKB14,CKB15,CKB19,CKB21,CKB33,CKB34,CKB46;
definitions TARSKI,FVSUM_1,FUNCOP_1,ALGSTR_0,PRE_POLY,CKB11,CKB13,CKB14,CKB15,CKB19,CKB21,CKB46;
theorems TARSKI,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,VECTSP_1,VECTSP_4,VECTSP_6,VECTSP_7,RLVECT_1,FUNCT_1,FUNCT_2,FUNCT_3,MATRIX_1,MATRIX_2,MATRIX_3,MOD_2,ZFMISC_1,NAT_1,FVSUM_1,SUBSET_1,FINSEQOP,FUNCOP_1,RELAT_1,PARTFUN2,XBOOLE_0,XBOOLE_1,RLVECT_2,ORDINAL1,PARTFUN1,PRE_POLY,GRCAT_1,CKB2,CKB3,CKB4,CKB5,CKB7,CKB8,CKB9,CKB10,CKB11,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51;
schemes FINSEQ_1,FINSEQ_2,FUNCT_2,MATRIX_1,NAT_1,FINSEQ_4;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FUNCT_2,FINSET_1,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,STRUCT_0,VECTSP_1,MATRIX_1,CARD_1,VECTSP_7,MOD_2,GRCAT_1,PRE_POLY,RELAT_1,FUNCT_1,FINSEQ_4,CKB12,CKB32;
constructors PARTFUN1,BINOP_1,FUNCT_3,SQUARE_1,NAT_1,VECTSP_6,VECTSP_7,MOD_2,FVSUM_1,MATRIX_3,RELSET_1,PRE_POLY,GRCAT_1,CKB1,CKB6,CKB11,CKB13,CKB14,CKB15,CKB19,CKB21,CKB33,CKB34,CKB46;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve k for Nat;
reserve i for Nat;
reserve j for Nat;
reserve K for Field;
reserve a for (Element of K);
reserve V1 for  finite-dimensional (VectSp of K);
reserve V2 for  finite-dimensional (VectSp of K);
reserve f for (Function of V1,V2);
reserve b1 for (OrdBasis of V1);
reserve b2 for (OrdBasis of V2);
reserve d for (FinSequence of K);
theorem
Th42: (for a,d being (FinSequence of K) holds (( len a ) = ( len b1 ) implies (for j being Nat holds (((j in ( dom b2 ) & ( len d ) = ( len b1 )) & (for k holds (k in ( dom b1 ) implies ( d . k ) = ( ( ( f . ( b1 /. k ) ) |-- b2 ) /. j )))) implies (( len b1 ) > ( 0 ) implies ( ( ( Sum ( lmlt (a,( f * b1 )) ) ) |-- b2 ) /. j ) = ( Sum ( mlt (a,d) ) ))))))
proof
let a being (FinSequence of K);
let d being (FinSequence of K);
assume that
A1: ( len a ) = ( len b1 );
reconsider B3 = ( f * b1 ) as (FinSequence of V2);
deffunc V(Nat,Nat) = ( ( ( B3 /. $1 ) |-- b2 ) /. $2 );
consider M being (Matrix of ( len b1 ),( len b2 ),(the carrier of K)) such that A2: (for i holds (for j holds ([ i,j ] in ( Indices M ) implies ( M * (i,j) ) = V(i,j)))) from MATRIX_1:sch 1;
deffunc W(Nat) = ( Sum ( mlt (a,( Col (M,$1) )) ) );
consider dd being (FinSequence of K) such that A3: (( len dd ) = ( len b2 ) & (for j being Nat holds (j in ( dom dd ) implies ( dd /. j ) = W(j)))) from FINSEQ_4:sch 2;
let j being Nat;
assume that
A4: j in ( dom b2 );
A5: j in ( dom dd ) by A4,A3,FINSEQ_3:29;
assume that
A6: ( len d ) = ( len b1 )
and
A7: (for k holds (k in ( dom b1 ) implies ( d . k ) = ( ( ( f . ( b1 /. k ) ) |-- b2 ) /. j )));
A8: ( len ( Col (M,j) ) ) = ( len M ) by MATRIX_1:def 8
.= ( len d ) by A6,MATRIX_1:def 2;
( len M ) = ( len b1 ) by MATRIX_1:def 2;
then A9: ( dom M ) = ( dom b1 ) by FINSEQ_3:29;
A10: ( len b1 ) = ( len B3 ) by FINSEQ_2:33;
then A11: ( dom b1 ) = ( dom B3 ) by FINSEQ_3:29;
assume A12: ( len b1 ) > ( 0 );
then A13: ( width M ) = ( len b2 ) by MATRIX_1:23;
A14:now
let i;
assume that
A15: i in ( dom B3 );
A16:now
let j being Nat;
assume A17: j in ( dom ( ( B3 /. i ) |-- b2 ) );
then j in ( Seg ( len ( ( B3 /. i ) |-- b2 ) ) ) by FINSEQ_1:def 3;
then A18: j in ( Seg ( width M ) ) by A13,CKB46:def 1;
then [ i,j ] in [: ( dom M ),( Seg ( width M ) ) :] by A9,A11,A15,ZFMISC_1:87;
then A19: [ i,j ] in ( Indices M ) by MATRIX_1:def 4;
thus ( ( Line (M,i) ) . j ) = ( M * (i,j) ) by A18,MATRIX_1:def 7
.= ( ( ( B3 /. i ) |-- b2 ) /. j ) by A2,A19
.= ( ( ( B3 /. i ) |-- b2 ) . j ) by A17,PARTFUN1:def 6;
end;
A20: ( len ( Line (M,i) ) ) = ( width M ) by MATRIX_1:def 7
.= ( len ( ( B3 /. i ) |-- b2 ) ) by A13,CKB46:def 1;
thus ( B3 /. i ) = ( Sum ( lmlt (( ( B3 /. i ) |-- b2 ),b2) ) ) by CKB49:1
.= ( Sum ( lmlt (( Line (M,i) ),b2) ) ) by A20,A16,FINSEQ_2:9;
end;
( Seg ( len b2 ) ) = ( dom b2 ) by FINSEQ_1:def 3;
then A21: j in ( Seg ( width M ) ) by A4,A12,MATRIX_1:23;
A22:now
let i being Nat;
assume i in ( dom d );
then A23: i in ( dom b1 ) by A6,FINSEQ_3:29;
then A24: ( B3 /. i ) = ( B3 . i ) by A11,PARTFUN1:def 6
.= ( f . ( b1 . i ) ) by A23,FUNCT_1:13
.= ( f . ( b1 /. i ) ) by A23,PARTFUN1:def 6;
[ i,j ] in [: ( dom M ),( Seg ( width M ) ) :] by A9,A21,A23,ZFMISC_1:87;
then A25: [ i,j ] in ( Indices M ) by MATRIX_1:def 4;
thus ( ( Col (M,j) ) . i ) = ( M * (i,j) ) by A9,A23,MATRIX_1:def 8
.= ( ( ( f . ( b1 /. i ) ) |-- b2 ) /. j ) by A2,A24,A25
.= ( d . i ) by A7,A23;
end;
( len b2 ) > ( 0 ) by A4,CKB51:1;
hence ( ( ( Sum ( lmlt (a,( f * b1 )) ) ) |-- b2 ) /. j ) = ( ( ( Sum ( lmlt (dd,b2) ) ) |-- b2 ) /. j ) by A1,A12,A3,A10,A14,CKB45:1
.= ( dd /. j ) by A3,CKB50:1
.= ( Sum ( mlt (a,( Col (M,j) )) ) ) by A3,A5
.= ( Sum ( mlt (a,d) ) ) by A8,A22,FINSEQ_2:9;
end;
