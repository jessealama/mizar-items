environ
vocabularies NUMBERS,NAT_1,INT_1,RELAT_1,ARYTM_3,CARD_1,XXREAL_0,SUBSET_1,ARYTM_1,INT_2,COMPLEX1,ORDINAL1,ZFMISC_1,XBOOLE_0,FINSET_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,CARD_1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,INT_2,CKB1,CKB2,CKB3,CKB4,CKB7,CKB17,CKB18,CKB19,CKB20;
definitions CKB1,CKB2,CKB7,CKB17,CKB19;
theorems ORDINAL1,XCMPLX_1,XREAL_1,XXREAL_0,NAT_1,INT_1,INT_2,ABSVALUE,XREAL_0,CARD_1,ZFMISC_1,COMPLEX1,XCMPLX_0,TARSKI,CKB1,CKB2,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB19;
schemes NAT_1;
registrations XXREAL_0,XREAL_0,NAT_1,INT_1,ORDINAL1,XBOOLE_0,CARD_1,ZFMISC_1;
constructors XXREAL_0,NAT_1,INT_2,REAL_1,FINSET_1,CARD_1,CKB1,CKB2,CKB3,CKB4,CKB7,CKB18,CKB20;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve l for Nat;
reserve m for Nat;
reserve n for Nat;
scheme Euklides { Q(Nat) -> Nat,a,b() -> Nat } : (ex n being (Element of ( NAT )) st (Q(n) = ( a() gcd b() ) & Q(( n + 1 )) = ( 0 )))
provided
A1: (( 0 ) < b() & b() < a())
and
A2: (Q(( 0 )) = a() & Q(1) = b())
and
A3: (for n being (Element of ( NAT )) holds Q(( n + 2 )) = ( Q(n) mod Q(( n + 1 )) ))
proof
defpred P[ Nat ]
 means
(ex n being (Element of ( NAT )) st $1 = Q(n));
A4: (ex k being Nat st P[ k ]) by A2;
A5: (for k being Nat holds ((k <> ( 0 ) & P[ k ]) implies (ex n being Nat st (n < k & P[ n ]))))
proof
let k being Nat;
assume that
A6: k <> ( 0 )
and
A7: (ex n being (Element of ( NAT )) st k = Q(n));
consider n being (Element of ( NAT )) such that A8: k = Q(n) by A7;
reconsider Q = Q(( n + 1 )) as (Element of ( NAT )) by ORDINAL1:def 12;
A9: (n = ( 0 ) implies Q < k) by A1,A2,A8;
now
given m such that
A10: n = ( m + 1 );

reconsider m1 = m as (Element of ( NAT )) by ORDINAL1:def 12;
Q(( m1 + 2 )) = ( Q(m1) mod Q(( m1 + 1 )) ) by A3;
hence Q(( n + 1 )) < k by A6,A8,A10,CKB5:1;
take m = ( n + 1 );
thus Q(( n + 1 )) = Q(m);
end;
hence thesis by A9,NAT_1:6;
end;
A11: P[ ( 0 ) ] from NAT_1:sch 7(A4,A5);
defpred Q[ Nat ]
 means
( 0 ) = Q($1);
A12: (ex n being Nat st Q[ n ]) by A11;
consider k being Nat such that A13: (Q[ k ] & (for n being Nat holds (Q[ n ] implies k <= n))) from NAT_1:sch 5(A12);
consider n such that A14: k = ( n + 1 ) by A1,A2,A13,NAT_1:6;
reconsider n as (Element of ( NAT )) by ORDINAL1:def 12;
take n;
defpred PP[ Nat ]
 means
(Q(n) divides Q($1) & Q(n) divides Q(( $1 + 1 )));
PP[ n ] by A13,A14,CKB11:1;
then A15: (ex k being Nat st PP[ k ]);
A16: (for k being Nat holds ((k <> ( 0 ) & PP[ k ]) implies (ex m being Nat st (m < k & PP[ m ]))))
proof
let l being Nat;
assume that
A17: l <> ( 0 )
and
A18: Q(n) divides Q(l)
and
A19: Q(n) divides Q(( l + 1 ));
consider m such that A20: l = ( m + 1 ) by A17,NAT_1:6;
reconsider m as (Element of ( NAT )) by ORDINAL1:def 12;
take m;
A21: m <= ( m + 1 ) by NAT_1:11;
m <> ( m + 1 );
hence m < l by A20,A21,XXREAL_0:1;
A22:now
assume A23: Q(( m + 1 )) = ( 0 );
now
assume A24: ( m + 1 ) <> k;
k <= ( m + 1 ) by A13,A23;
then k < ( m + 1 ) by A24,XXREAL_0:1;
then A25: k <= m by NAT_1:13;
defpred Q[ Nat ]
 means
(k <= $1 implies Q($1) = ( 0 ));
A26: Q[ ( 0 ) ] by A13;
A27: (for m holds (Q[ m ] implies Q[ ( m + 1 ) ]))
proof
let m;
assume that
A28: (k <= m implies Q(m) = ( 0 ))
and
A29: k <= ( m + 1 );
now
assume k <> ( m + 1 );
then A30: k < ( m + 1 ) by A29,XXREAL_0:1;
then consider l such that A31: m = ( l + 1 ) by A1,A2,A28,NAT_1:6,NAT_1:13;
reconsider l as (Element of ( NAT )) by ORDINAL1:def 12;
Q(( l + 2 )) = ( Q(l) mod Q(( l + 1 )) ) by A3;
hence thesis by A28,A30,A31,CKB2:def 1,NAT_1:13;
end;
hence thesis by A13;
end;
(for m holds Q[ m ]) from NAT_1:sch 2(A26,A27);
then Q(m) = ( 0 ) by A25;
hence Q(n) divides Q(m) by CKB11:1;
end;
hence Q(n) divides Q(m) by A14;
end;
now
assume A32: Q(( m + 1 )) <> ( 0 );
Q(( m + 2 )) = ( Q(m) mod Q(( m + 1 )) ) by A3;
then A33: Q(m) = ( ( Q(( m + 1 )) * ( Q(m) div Q(( m + 1 )) ) ) + Q(( m + 2 )) ) by A32,INT_1:59;
Q(n) divides ( Q(( m + 1 )) * ( Q(m) div Q(( m + 1 )) ) ) by A18,A20,CKB14:1;
hence Q(n) divides Q(m) by A19,A20,A33,CKB13:1;
end;
hence Q(n) divides Q(m) by A22;
thus Q(n) divides Q(( m + 1 )) by A18,A20;
end;
now
PP[ ( 0 ) ] from NAT_1:sch 7(A15,A16);
hence (Q(n) divides a() & Q(n) divides b()) by A2;
let m;
defpred P1[ Nat ]
 means
(m divides Q($1) & m divides Q(( $1 + 1 )));
assume that
A34: m divides a()
and
A35: m divides b();
A36: P1[ ( 0 ) ] by A2,A34,A35;
A37: (for k being (Element of ( NAT )) holds (P1[ k ] implies P1[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume that
A38: m divides Q(k)
and
A39: m divides Q(( k + 1 ));
thus m divides Q(( k + 1 )) by A39;
Q(( k + 2 )) = ( Q(k) mod Q(( k + 1 )) ) by A3;
hence m divides Q(( ( k + 1 ) + 1 )) by A38,A39,CKB16:1;
end;
(for k being (Element of ( NAT )) holds P1[ k ]) from NAT_1:sch 1(A36,A37);
hence m divides Q(n);
end;
hence Q(n) = ( a() gcd b() ) by CKB19:def 1;
thus thesis by A13,A14;
end;
