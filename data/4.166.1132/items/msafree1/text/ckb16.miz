environ
vocabularies FUNCT_1,CARD_3,RELAT_1,TARSKI,XBOOLE_0,LANG1,SUBSET_1,DTCONSTR,TREES_4,FINSEQ_1,TDGROUP,TREES_3,TREES_2,STRUCT_0,MSUALG_1,PBOOLE,MSAFREE,ZFMISC_1,MARGREL1,PROB_2,NAT_1,PARTFUN1,MCART_1,MSUALG_3,MSAFREE1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NAT_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_2,STRUCT_0,MCART_1,FINSEQ_1,MULTOP_1,PROB_2,CARD_3,TREES_2,TREES_3,TREES_4,LANG1,DTCONSTR,PBOOLE,MSUALG_1,MSAFREE,MSUALG_3,CKB8,CKB10,CKB11;
definitions TARSKI,MSUALG_1,PBOOLE,PROB_2,CKB8,CKB10,CKB11;
theorems MSAFREE,MSUALG_3,LANG1,FINSEQ_1,CARD_3,PBOOLE,FUNCT_1,FUNCT_2,DTCONSTR,TARSKI,ZFMISC_1,PROB_2,CARD_5,RELAT_1,DOMAIN_1,MCART_1,XBOOLE_0,XBOOLE_1,PARTFUN1,FINSEQ_2,CKB1,CKB3,CKB4,CKB8,CKB9,CKB10,CKB11,CKB12;
schemes DTCONSTR,FUNCT_2,MULTOP_1,PBOOLE,CKB2;
registrations XBOOLE_0,FUNCT_1,RELSET_1,FINSEQ_1,RELAT_1,TREES_3,STRUCT_0,DTCONSTR,MSUALG_1,MSUALG_3,MSAFREE,ORDINAL1,PBOOLE,PRE_POLY,CKB5,CKB6,CKB7,CKB13,CKB14,CKB15;
constructors MULTOP_1,PROB_2,MSUALG_3,MSAFREE,RELSET_1,CAT_3,FINSEQ_2,CKB8,CKB10,CKB11;
requirements BOOLE,SUBSET;
begin
theorem
Th5: (for S being non void non empty ManySortedSign holds (for o being (OperSymbol of S) holds (for A1 being  non-empty  disjoint_valued MSAlgebra over S holds (for A2 being  non-empty MSAlgebra over S holds (for f being (ManySortedFunction of A1,A2) holds (for a being (Element of ( Args (o,A1) )) holds ( ( Flatten f ) * a ) = ( f # a )))))))
proof
let S being non void non empty ManySortedSign;
let o being (OperSymbol of S);
let A1 being  non-empty  disjoint_valued MSAlgebra over S;
let A2 being  non-empty MSAlgebra over S;
let f being (ManySortedFunction of A1,A2);
let a being (Element of ( Args (o,A1) ));
A1: ( dom (the Arity of S) ) = (the carrier' of S) by FUNCT_2:def 1;
set s = ( the_arity_of o );
a in ( ( ( (the Sorts of A1) # ) * (the Arity of S) ) . o );
then a in ( ( (the Sorts of A1) # ) . ( (the Arity of S) . o ) ) by A1,FUNCT_1:13;
then A2: a in ( product ( (the Sorts of A1) * s ) ) by FINSEQ_2:def 5;
then ( rng a ) c= ( Union ( (the Sorts of A1) * s ) ) by CKB1:1;
then (( union ( rng ( (the Sorts of A1) * s ) ) ) c= ( union ( rng (the Sorts of A1) ) ) & ( rng a ) c= ( union ( rng ( (the Sorts of A1) * s ) ) )) by CARD_3:def 4,RELAT_1:26,ZFMISC_1:77;
then ( rng a ) c= ( union ( rng (the Sorts of A1) ) ) by XBOOLE_1:1;
then ( rng a ) c= ( Union (the Sorts of A1) ) by CARD_3:def 4;
then ( rng a ) c= ( dom ( Flatten f ) ) by FUNCT_2:def 1;
then A3: ( dom ( ( Flatten f ) * a ) ) = ( dom a ) by RELAT_1:27;
A4: ( rng s ) c= (the carrier of S) by FINSEQ_1:def 4;
( dom (the Sorts of A1) ) = (the carrier of S) by PARTFUN1:def 2;
then A5: ( dom ( (the Sorts of A1) * s ) ) = ( dom s ) by A4,RELAT_1:27;
A6: ( dom a ) = ( dom ( (the Sorts of A1) * s ) ) by A2,CARD_3:9;
A7:now
let x being set;
assume A8: x in ( dom ( (the Sorts of A2) * s ) );
A9: ( dom ( (the Sorts of A2) * s ) ) c= ( dom s ) by RELAT_1:25;
then A10: ( (the Sorts of A2) . ( s . x ) ) = ( ( (the Sorts of A2) * s ) . x ) by A8,FUNCT_1:13;
( s . x ) in ( rng s ) by A9,A8,FUNCT_1:def 3;
then reconsider z = ( s . x ) as (SortSymbol of S) by A4;
( (the Sorts of A1) . ( s . x ) ) = ( ( (the Sorts of A1) * s ) . x ) by A9,A8,FUNCT_1:13;
then A11: ( a . x ) in ( (the Sorts of A1) . z ) by A2,A5,A9,A8,CARD_3:9;
( ( ( Flatten f ) * a ) . x ) = ( ( Flatten f ) . ( a . x ) ) by A6,A5,A9,A8,FUNCT_1:13
.= ( ( f . z ) . ( a . x ) ) by A11,CKB8:def 1;
hence ( ( ( Flatten f ) * a ) . x ) in ( ( (the Sorts of A2) * s ) . x ) by A10,A11,FUNCT_2:5;
end;
( dom (the Sorts of A2) ) = (the carrier of S) by PARTFUN1:def 2;
then ( dom s ) = ( dom ( (the Sorts of A2) * s ) ) by A4,RELAT_1:27;
then ( ( Flatten f ) * a ) in ( product ( (the Sorts of A2) * s ) ) by A3,A6,A5,A7,CARD_3:9;
then ( ( Flatten f ) * a ) in ( ( (the Sorts of A2) # ) . ( (the Arity of S) . o ) ) by FINSEQ_2:def 5;
then reconsider x = ( ( Flatten f ) * a ) as (Element of ( Args (o,A2) )) by A1,FUNCT_1:13;
now
let n being Nat;
assume A12: n in ( dom a );
then (( ( the_arity_of o ) /. n ) = ( s . n ) & ( a . n ) in ( ( (the Sorts of A1) * s ) . n )) by A2,A6,A5,CARD_3:9,PARTFUN1:def 6;
then A13: ( a . n ) in ( (the Sorts of A1) . ( ( the_arity_of o ) /. n ) ) by A6,A5,A12,FUNCT_1:13;
thus ( x . n ) = ( ( Flatten f ) . ( a . n ) ) by A12,FUNCT_1:13
.= ( ( f . ( ( the_arity_of o ) /. n ) ) . ( a . n ) ) by A13,CKB8:def 1;
end;
hence thesis by MSUALG_3:def 6;
end;
