environ
vocabularies NUMBERS,XREAL_0,ORDINAL1,NAT_1,INT_1,RAT_1,NEWTON,RELAT_1,ARYTM_1,ARYTM_3,XXREAL_0,CARD_1,PREPOWER,INT_2,COMPLEX1,SUBSET_1,FINSEQ_1,FUNCT_1,XBOOLE_0,ORDINAL4,TARSKI,VALUED_0,CARD_3,FINSEQ_3,REAL_1,SQUARE_1;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,INT_1,REAL_1,NAT_1,NAT_D,RAT_1,INT_2,XXREAL_0,VALUED_0,PREPOWER,SQUARE_1,FUNCT_1,FINSEQ_1,FINSEQ_3,SEQ_1,RVSUM_1,FINSEQ_4,NEWTON,TREES_4,CKB30,CKB31,CKB36,CKB37,CKB39,CKB42,CKB43;
definitions FINSEQ_1,TARSKI,SQUARE_1,RVSUM_1,CKB39;
theorems TARSKI,ABSVALUE,INT_1,NAT_1,INT_2,RAT_1,NEWTON,PREPOWER,SQUARE_1,FINSEQ_1,FINSEQ_2,FINSEQ_4,FUNCT_1,RVSUM_1,PRE_FF,CARD_4,FINSEQ_3,FINSEQ_5,XBOOLE_1,XCMPLX_0,XCMPLX_1,XREAL_1,CARD_1,XXREAL_0,ORDINAL1,FINSOP_1,NAT_D,XREAL_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB38,CKB39,CKB40,CKB41,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65;
schemes NAT_1,FINSEQ_1,FINSEQ_2;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,NUMBERS,SEQM_3,XXREAL_0,XREAL_0,SQUARE_1,NAT_1,INT_1,RAT_1,MEMBERED,FINSEQ_1,NEWTON,VALUED_0,CARD_1,CKB7,CKB29,CKB32,CKB33,CKB34,CKB35;
constructors REAL_1,SQUARE_1,NAT_1,NAT_D,BINOP_2,FINSEQ_3,FINSEQ_4,FINSOP_1,RVSUM_1,NEWTON,PREPOWER,TREES_4,SEQ_1,RELSET_1,CKB30,CKB31,CKB36,CKB37,CKB42,CKB43;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve a for Nat;
reserve b for Nat;
reserve c for Nat;
reserve d for Nat;
reserve m for Integer;
reserve n for Integer;
reserve m1 for Integer;
reserve n1 for Integer;
reserve fp for (FinSequence of ( NAT ));
reserve fr for (FinSequence of ( INT ));
reserve fr1 for (FinSequence of ( INT ));
reserve fr2 for (FinSequence of ( INT ));
theorem
((( len fp ) >= 2 & (for b holds (for c holds (((b in ( dom fp ) & c in ( dom fp )) & b <> c) implies ( ( fp . b ) gcd ( fp . c ) ) = 1)))) implies (for fr holds (( len fr ) = ( len fp ) implies (ex fr1 st (( len fr1 ) = ( len fp ) & (for b holds (b in ( dom fp ) implies ( ( ( fp . b ) * ( fr1 . b ) ) + ( fr . b ) ) = ( ( ( fp . 1 ) * ( fr1 . 1 ) ) + ( fr . 1 ) ))))))))
proof
defpred CC[ (FinSequence of ( NAT )) ]
 means
(for fr holds (( len fr ) = ( len $1 ) implies (ex fr1 st (( len fr1 ) = ( len $1 ) & (for b holds (b in ( dom $1 ) implies ( ( ( $1 . b ) * ( fr1 . b ) ) + ( fr . b ) ) = ( ( ( $1 . 1 ) * ( fr1 . 1 ) ) + ( fr . 1 ) )))))));
defpred RP[ (FinSequence of ( NAT )) ]
 means
(for b holds (for c holds (((b in ( dom $1 ) & c in ( dom $1 )) & b <> c) implies ( ( $1 . b ) gcd ( $1 . c ) ) = 1)));
defpred TH[ (FinSequence of ( NAT )) ]
 means
((( len $1 ) >= 2 & RP[ $1 ]) implies CC[ $1 ]);
A1:now
let fp;
let d being (Element of ( NAT ));
assume that
A2: TH[ fp ];
set k = ( len fp );
set fp1 = ( fp ^ <* d *> );
now
assume that
A3: ( len fp1 ) >= 2
and
A4: RP[ fp1 ];
A5: ( len fp1 ) = ( k + 1 ) by FINSEQ_2:16;
now
per cases  by A3,XXREAL_0:1;
suppose A6: ( len fp1 ) = 2;

now
let fr;
assume that
( len fr ) = ( len fp1 );
(1 in ( dom fp1 ) & 2 in ( dom fp1 )) by A6,FINSEQ_3:25;
then ( ( fp1 . 1 ) gcd ( fp1 . 2 ) ) = 1 by A4;
then ( ( fp1 . 1 ) gcd ( fp1 . 2 ) ) divides ( ( fr . 1 ) - ( fr . 2 ) ) by INT_2:12;
then consider m,n such that A7: ( ( ( fp1 . 1 ) * m ) + ( ( fp1 . 2 ) * n ) ) = ( ( fr . 1 ) - ( fr . 2 ) ) by CKB62:1;
reconsider x = ( - m ),y = n as (Element of ( INT )) by INT_1:def 2;
take fr1 = <* x,y *>;
thus ( len fr1 ) = ( len fp1 ) by A6,FINSEQ_1:44;
let b;
assume b in ( dom fp1 );
then A8: b in ( Seg ( len fp1 ) ) by FINSEQ_1:def 3;
now
per cases  by A6,A8,FINSEQ_1:2,TARSKI:def 2;
suppose b = 1;

hence ( ( ( fp1 . b ) * ( fr1 . b ) ) + ( fr . b ) ) = ( ( ( fp1 . 1 ) * ( fr1 . 1 ) ) + ( fr . 1 ) );
end;
suppose A9: b = 2;

A10: (( fr1 . 1 ) = ( - m ) & ( fr1 . 2 ) = n) by FINSEQ_1:44;
( ( ( fp1 . 2 ) * n ) - ( ( fp1 . 1 ) * ( - m ) ) ) = ( ( fr . 1 ) - ( fr . 2 ) ) by A7;
hence ( ( ( fp1 . b ) * ( fr1 . b ) ) + ( fr . b ) ) = ( ( ( fp1 . 1 ) * ( fr1 . 1 ) ) + ( fr . 1 ) ) by A9,A10,XCMPLX_1:34;
end;
end;
hence ( ( ( fp1 . b ) * ( fr1 . b ) ) + ( fr . b ) ) = ( ( ( fp1 . 1 ) * ( fr1 . 1 ) ) + ( fr . 1 ) );
end;
hence CC[ fp1 ];
end;
suppose A11: ( len fp1 ) > 2;

A12: RP[ fp ]
proof
A13: ( dom fp ) c= ( dom fp1 ) by FINSEQ_1:26;
let b;
let c;
assume that
A14: (b in ( dom fp ) & c in ( dom fp ))
and
A15: b <> c;
(( fp1 . b ) = ( fp . b ) & ( fp1 . c ) = ( fp . c )) by A14,FINSEQ_1:def 7;
hence thesis by A4,A14,A15,A13;
end;
A16: ( k + 1 ) > ( 1 + 1 ) by A11,FINSEQ_2:16;
then A17: k >= ( 1 + 1 ) by NAT_1:13;
now
let fr2;
assume A18: ( len fr2 ) = ( len fp1 );
then consider fr being (FinSequence of ( INT )),m being (Element of ( INT )) such that A19: fr2 = ( fr ^ <* m *> ) by FINSEQ_2:19;
A20: ( k + 1 ) = ( ( len fr ) + 1 ) by A5,A18,A19,FINSEQ_2:16;
then consider fr1 such that ( len fr1 ) = k and A21: (for b holds (b in ( dom fp ) implies ( ( ( fp . b ) * ( fr1 . b ) ) + ( fr . b ) ) = ( ( ( fp . 1 ) * ( fr1 . 1 ) ) + ( fr . 1 ) ))) by A2,A16,A12,NAT_1:13;
(a in ( dom fp ) implies ( ( fp . a ) gcd d ) = 1)
proof
A22: ( ( len fp ) + 1 ) in ( dom fp1 ) by A5,FINSEQ_5:6;
A23: (( dom fp ) c= ( dom fp1 ) & ( fp1 . ( ( len fp ) + 1 ) ) = d) by FINSEQ_1:26,FINSEQ_1:42;
assume A24: a in ( dom fp );
( ( len fp ) + 1 ) > ( len fp ) by NAT_1:13;
then A25: ( ( len fp ) + 1 ) <> a by A24,FINSEQ_3:25;
( fp1 . a ) = ( fp . a ) by A24,FINSEQ_1:def 7;
hence thesis by A4,A24,A23,A25,A22;
end;
then ( ( Product fp ) gcd d ) = 1 by CKB65:1;
then ( ( Product fp ) gcd d ) divides ( ( ( fr2 . ( k + 1 ) ) - ( ( fp . 1 ) * ( fr1 . 1 ) ) ) - ( fr2 . 1 ) ) by INT_2:12;
then consider m1,n1 such that A26: ( ( ( Product fp ) * m1 ) + ( d * n1 ) ) = ( ( ( fr2 . ( k + 1 ) ) - ( ( fp . 1 ) * ( fr1 . 1 ) ) ) - ( fr2 . 1 ) ) by CKB62:1;
reconsider x = ( - n1 ) as (Element of ( INT )) by INT_1:def 2;
deffunc F(Nat) = ( ( ( Product ( Del (fp,$1) ) ) * m1 ) + ( fr1 . $1 ) );
consider s2 being FinSequence such that A27: (( len s2 ) = k & (for a being Nat holds (a in ( dom s2 ) implies ( s2 . a ) = F(a)))) from FINSEQ_1:sch 2;
A28: (for a being Nat holds (a in ( dom s2 ) implies ( s2 . a ) in ( INT )))
proof
let a being Nat;
assume A29: a in ( dom s2 );
reconsider a as (Element of ( NAT )) by ORDINAL1:def 12;
( s2 . a ) = ( ( ( Product ( Del (fp,a) ) ) * m1 ) + ( fr1 . a ) ) by A27,A29;
hence thesis by INT_1:def 2;
end;
A30: ( dom s2 ) = ( Seg k ) by A27,FINSEQ_1:def 3;
reconsider s2 as (FinSequence of ( INT )) by A28,FINSEQ_2:12;
take fr3 = ( s2 ^ <* x *> );
thus ( len fr3 ) = ( len fp1 ) by A5,A27,FINSEQ_2:16;
let b;
assume that
A31: b in ( dom fp1 );
thus ( ( ( fp1 . b ) * ( fr3 . b ) ) + ( fr2 . b ) ) = ( ( ( fp1 . 1 ) * ( fr3 . 1 ) ) + ( fr2 . 1 ) )
proof
A32: (c in ( Seg k ) implies ( ( fp1 . c ) * ( fr3 . c ) ) = ( ( ( Product fp ) * m1 ) + ( ( fp . c ) * ( fr1 . c ) ) ))
proof
assume A33: c in ( Seg k );
then c in ( dom s2 ) by A27,FINSEQ_1:def 3;
then A34: ( fr3 . c ) = ( s2 . c ) by FINSEQ_1:def 7
.= ( ( ( Product ( Del (fp,c) ) ) * m1 ) + ( fr1 . c ) ) by A27,A30,A33;
A35: c in ( dom fp ) by A33,FINSEQ_1:def 3;
then ( fp . c ) = ( fp1 . c ) by FINSEQ_1:def 7;
hence ( ( fp1 . c ) * ( fr3 . c ) ) = ( ( ( ( fp . c ) * ( Product ( Del (fp,c) ) ) ) * m1 ) + ( ( fp . c ) * ( fr1 . c ) ) ) by A34
.= ( ( ( Product fp ) * m1 ) + ( ( fp . c ) * ( fr1 . c ) ) ) by A35,CKB48:1;
end;
A36: b in ( NAT ) by ORDINAL1:def 12;
A37: 1 <= b by A31,FINSEQ_3:25;
A38: b <= ( k + 1 ) by A5,A31,FINSEQ_3:25;
now
per cases  by A38,NAT_1:8;
suppose A39: b <= k;

then 1 <= k by A37,XXREAL_0:2;
then A40: 1 in ( Seg k );
then 1 in ( dom fr ) by A20,FINSEQ_1:def 3;
then A41: ( fr2 . 1 ) = ( fr . 1 ) by A19,FINSEQ_1:def 7;
A42: b in ( Seg k ) by A37,A36,A39;
then A43: b in ( dom fp ) by FINSEQ_1:def 3;
b in ( dom fr ) by A20,A42,FINSEQ_1:def 3;
then A44: ( fr2 . b ) = ( fr . b ) by A19,FINSEQ_1:def 7;
thus ( ( ( fp1 . b ) * ( fr3 . b ) ) + ( fr2 . b ) ) = ( ( ( ( Product fp ) * m1 ) + ( ( fp . b ) * ( fr1 . b ) ) ) + ( fr2 . b ) ) by A32,A42
.= ( ( ( Product fp ) * m1 ) + ( ( ( fp . b ) * ( fr1 . b ) ) + ( fr . b ) ) ) by A44
.= ( ( ( Product fp ) * m1 ) + ( ( ( fp . 1 ) * ( fr1 . 1 ) ) + ( fr . 1 ) ) ) by A21,A43
.= ( ( ( ( Product fp ) * m1 ) + ( ( fp . 1 ) * ( fr1 . 1 ) ) ) + ( fr . 1 ) )
.= ( ( ( fp1 . 1 ) * ( fr3 . 1 ) ) + ( fr2 . 1 ) ) by A32,A40,A41;
end;
suppose A45: b = ( k + 1 );

then A46: ( fp1 . b ) = d by FINSEQ_1:42;
A47: ( ( fr2 . b ) - ( ( ( fp . 1 ) * ( fr1 . 1 ) ) + ( fr2 . 1 ) ) ) = ( ( d * n1 ) + ( ( Product fp ) * m1 ) ) by A26,A45;
1 <= k by A17,XXREAL_0:2;
then 1 in ( Seg k );
then ( ( ( fp1 . 1 ) * ( fr3 . 1 ) ) + ( fr2 . 1 ) ) = ( ( ( ( Product fp ) * m1 ) + ( ( fp . 1 ) * ( fr1 . 1 ) ) ) + ( fr2 . 1 ) ) by A32
.= ( ( fr2 . b ) + ( d * ( - n1 ) ) ) by A47;
hence thesis by A27,A45,A46,FINSEQ_1:42;
end;
end;
hence thesis;
end;

end;
hence CC[ fp1 ];
end;
end;
hence CC[ fp1 ];
end;
hence TH[ fp1 ];
end;
A48: TH[ ( <*> ( NAT ) ) ];
(for fp holds TH[ fp ]) from FINSEQ_2:sch 2(A48,A1);
hence thesis;
end;
