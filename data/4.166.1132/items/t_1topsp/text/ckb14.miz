environ
vocabularies XBOOLE_0,PRE_TOPC,EQREL_1,STRUCT_0,SUBSET_1,BORSUK_1,RELAT_1,TARSKI,CARD_3,RCOMP_1,ZFMISC_1,SETFAM_1,ORDINAL2,FUNCT_1,T_1TOPSP;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,SETFAM_1,DOMAIN_1,STRUCT_0,PRE_TOPC,EQREL_1,TOPS_2,BORSUK_1,CKB4,CKB5,CKB10;
definitions TARSKI,PRE_TOPC,XBOOLE_0,STRUCT_0,CKB4,CKB5,CKB10;
theorems PRE_TOPC,TARSKI,SETFAM_1,EQREL_1,URYSOHN1,BORSUK_1,FUNCT_2,FUNCT_1,TOPS_2,RELSET_1,RELAT_1,XBOOLE_0,XBOOLE_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB7,CKB10,CKB11,CKB12,CKB13;
schemes CLASSES1;
registrations SUBSET_1,FUNCT_1,RELSET_1,FUNCT_2,EQREL_1,STRUCT_0,PRE_TOPC,BORSUK_1,CKB6,CKB8,CKB9;
constructors SETFAM_1,TOPS_2,BORSUK_1,URYSOHN1,CKB4,CKB5,CKB10;
requirements BOOLE,SUBSET;
begin
reserve y for set;
reserve w for set;
reserve T for non  empty TopSpace;
theorem
Th16: (for T,T1 being non  empty TopSpace holds (for f being  continuous (Function of T,T1) holds (T1 is  T_1 implies (ex h being  continuous (Function of ( T_1-reflex T ),T1) st f = ( h * ( T_1-reflect T ) )))))
proof
let T being non  empty TopSpace;
let T1 being non  empty TopSpace;
let f being  continuous (Function of T,T1);
set g = ( T_1-reflect T );
A1: ( dom g ) = (the carrier of T) by FUNCT_2:def 1;
defpred X[ set,set ]
 means
(for z being (Element of T1) holds ((z in ( rng f ) & $1 c= ( f " { z } )) implies $2 = ( f " { z } )));
assume A2: T1 is  T_1;
then reconsider fx = { ( f " { x } ) where x is (Element of T1): x in ( rng f ) } as (a_partition of (the carrier of T)) by CKB11:1;
A3: ( dom f ) = (the carrier of T) by FUNCT_2:def 1;
A4: (for y holds (y in (the carrier of ( T_1-reflex T )) implies (ex w st X[ y,w ])))
proof
let y;
assume y in (the carrier of ( T_1-reflex T ));
then y in ( Intersection ( Closed_Partitions T ) ) by BORSUK_1:def 7;
then consider x being (Element of T) such that A5: y = ( EqClass (x,( Intersection ( Closed_Partitions T ) )) ) by EQREL_1:42;
reconsider x as (Element of T);
set w = ( f " { ( f . x ) } );
take w;
let z being (Element of T1);
assume that
A6: z in ( rng f )
and
A7: y c= ( f " { z } );
reconsider fix = ( f . x ) as (Element of T1);
( f . x ) in ( rng f ) by A3,FUNCT_1:def 3;
then A8: ( f " { fix } ) in fx;
y is non  empty by A5,EQREL_1:def 6;
then A9: (ex z1 being set st z1 in y) by XBOOLE_0:def 1;
( f " { z } ) in fx by A6;
then A10: (w misses ( f " { z } ) or w = ( f " { z } )) by A8,EQREL_1:def 4;
y c= w by A2,A5,CKB12:1;
hence thesis by A7,A10,A9,XBOOLE_0:3;
end;
consider h1 being Function such that A11: (( dom h1 ) = (the carrier of ( T_1-reflex T )) & (for y holds (y in (the carrier of ( T_1-reflex T )) implies X[ y,( h1 . y ) ]))) from CLASSES1:sch 1(A4);
defpred X[ set,set ]
 means
(for z being (Element of T1) holds ((z in ( rng f ) & $1 = ( f " { z } )) implies $2 = z));
A12: (for y holds (y in fx implies (ex w st X[ y,w ])))
proof
let y being set;
assume y in fx;
then consider w being (Element of T1) such that A13: y = ( f " { w } ) and w in ( rng f );
take w;
let z being (Element of T1);
assume that
A14: z in ( rng f )
and
A15: y = ( f " { z } );
now
assume A16: z <> w;
consider v being set such that A17: v in ( dom f ) and A18: z = ( f . v ) by A14,FUNCT_1:def 3;
z in { z } by TARSKI:def 1;
then v in ( f " { w } ) by A13,A15,A17,A18,FUNCT_1:def 7;
then ( f . v ) in { w } by FUNCT_1:def 7;
hence contradiction by A16,A18,TARSKI:def 1;
end;
hence thesis;
end;
consider h2 being Function such that A19: (( dom h2 ) = fx & (for y holds (y in fx implies X[ y,( h2 . y ) ]))) from CLASSES1:sch 1(A12);
set h = ( h2 * h1 );
A20: ( dom h ) = (the carrier of ( T_1-reflex T ))
proof
thus ( dom h ) c= (the carrier of ( T_1-reflex T )) by A11,RELAT_1:25;
let z being set;
assume A21: z in (the carrier of ( T_1-reflex T ));
then consider w being (Element of T1) such that A22: w in ( rng f ) and A23: z c= ( f " { w } ) by A2,CKB13:1;
( h1 . z ) = ( f " { w } ) by A11,A21,A22,A23;
then ( h1 . z ) in ( dom h2 ) by A19,A22;
hence thesis by A11,A21,FUNCT_1:11;
end;
A24: ( dom ( h * g ) ) = (the carrier of T)
proof
thus ( dom ( h * g ) ) c= (the carrier of T) by A1,RELAT_1:25;
let y being set;
assume A25: y in (the carrier of T);
then ( g . y ) in ( rng g ) by A1,FUNCT_1:def 3;
hence thesis by A1,A20,A25,FUNCT_1:11;
end;
A26: (for x being set holds (x in ( dom f ) implies ( f . x ) = ( ( h * g ) . x )))
proof
let x being set;
assume A27: x in ( dom f );
then ( g . x ) in ( rng g ) by A1,FUNCT_1:def 3;
then ( g . x ) in (the carrier of ( T_1-reflex T ));
then ( g . x ) in ( Intersection ( Closed_Partitions T ) ) by BORSUK_1:def 7;
then consider y being (Element of T) such that A28: ( g . x ) = ( EqClass (y,( Intersection ( Closed_Partitions T ) )) ) by EQREL_1:42;
reconsider x as (Element of T) by A27;
reconsider fix = ( f . x ) as (Element of T1);
A29: x in ( EqClass (x,( Intersection ( Closed_Partitions T ) )) ) by EQREL_1:def 6;
g = ( proj ( Intersection ( Closed_Partitions T ) ) ) by BORSUK_1:def 8;
then x in ( g . x ) by EQREL_1:def 9;
then ( EqClass (x,( Intersection ( Closed_Partitions T ) )) ) meets ( EqClass (y,( Intersection ( Closed_Partitions T ) )) ) by A28,A29,XBOOLE_0:3;
then A30: ( g . x ) c= ( f " { fix } ) by A2,A28,CKB12:1,EQREL_1:41;
A31: fix in ( rng f ) by A27,FUNCT_1:def 3;
then A32: ( f " { fix } ) in fx;
( ( h * g ) . x ) = ( ( h2 * h1 ) . ( g . x ) ) by A24,FUNCT_1:12
.= ( h2 . ( h1 . ( g . x ) ) ) by A11,FUNCT_1:13
.= ( h2 . ( f " { fix } ) ) by A11,A31,A30
.= ( f . x ) by A19,A31,A32;
hence thesis;
end;
then A33: f = ( h * g ) by A3,A24,FUNCT_1:2;
A34: ( rng h2 ) c= (the carrier of T1)
proof
let y;
assume y in ( rng h2 );
then consider w being set such that A35: w in ( dom h2 ) and A36: y = ( h2 . w ) by FUNCT_1:def 3;
consider x being (Element of T1) such that A37: (w = ( f " { x } ) & x in ( rng f )) by A19,A35;
( h2 . w ) = x by A19,A35,A37;
hence thesis by A36;
end;
( rng h ) c= ( rng h2 )
proof
let z being set;
thus thesis by FUNCT_1:14;
end;
then ( rng h ) c= (the carrier of T1) by A34,XBOOLE_1:1;
then reconsider h as (Function of (the carrier of ( T_1-reflex T )),(the carrier of T1)) by A20,FUNCT_2:def 1,RELSET_1:4;
reconsider h as (Function of ( T_1-reflex T ),T1);
h is  continuous
proof
let y being (Subset of T1);
reconsider hy = ( h " y ) as (Subset of ( space ( Intersection ( Closed_Partitions T ) ) ));
( union hy ) c= (the carrier of T)
proof
let z1 being set;
assume z1 in ( union hy );
then consider z2 being set such that A38: z1 in z2 and A39: z2 in hy by TARSKI:def 4;
z2 in (the carrier of ( space ( Intersection ( Closed_Partitions T ) ) )) by A39;
then z2 in ( Intersection ( Closed_Partitions T ) ) by BORSUK_1:def 7;
hence thesis by A38;
end;
then reconsider uhy = ( union hy ) as (Subset of T);
assume y is  closed;
then ( ( h * g ) " y ) is  closed by A33,PRE_TOPC:def 6;
then ( g " ( h " y ) ) is  closed by RELAT_1:146;
then uhy is  closed by CKB1:1;
hence thesis by CKB2:1;
end;
then reconsider h as  continuous (Function of ( T_1-reflex T ),T1);
take h;
thus thesis by A3,A24,A26,FUNCT_1:2;
end;
