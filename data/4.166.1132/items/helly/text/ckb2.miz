environ
vocabularies NUMBERS,XBOOLE_0,FINSEQ_1,FUNCT_1,GRAPH_2,ARYTM_3,NAT_1,XXREAL_0,SUBSET_1,TREES_1,TARSKI,CARD_1,ORDINAL1,FINSET_1,MEMBERED,RELAT_1,ORDINAL4,GLIB_000,GLIB_001,ABIAN,ZFMISC_1,ARYTM_1,GRAPH_1,RCOMP_1,SETFAM_1,HELLY;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,FINSET_1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,SETFAM_1,FUNCT_1,FINSEQ_1,MEMBERED,NAT_1,TREES_1,XXREAL_2,ABIAN,GRAPH_2,GLIB_000,GLIB_001,GLIB_002;
definitions TARSKI,XBOOLE_0,GLIB_001;
theorems TARSKI,NAT_1,GRAPH_5,SETFAM_1,XBOOLE_0,XBOOLE_1,GRFUNC_1,FUNCT_1,ZFMISC_1,ORDINAL1,FINSEQ_1,FINSEQ_2,FINSEQ_3,INT_1,EULER_1,CARD_1,XREAL_1,XXREAL_0,CHORD,ABIAN,GLIB_000,GLIB_001,GLIB_002,MSSCYC_1,MEMBERED,GRAPH_2,XXREAL_2,FINSEQ_4,CKB1;
schemes NAT_1,FINSEQ_1;
registrations FINSET_1,XREAL_0,XXREAL_0,NAT_1,INT_1,RELAT_1,FINSEQ_1,ABIAN,MEMBERED,GLIB_000,GLIB_001,GLIB_002,XXREAL_2,CARD_1,FUNCT_1,XBOOLE_0;
constructors DOMAIN_1,SETFAM_1,NAT_1,GRAPH_2,GLIB_001,GLIB_002,XXREAL_2,RELSET_1,RAT_1;
requirements BOOLE,SUBSET,NUMERALS,ARITHM,REAL;
begin
definition
let p being FinSequence;
let q being FinSequence;
func maxPrefix (p,q) -> FinSequence means 
:Def1: ((it is_a_prefix_of p & it is_a_prefix_of q) & (for r being FinSequence holds ((r is_a_prefix_of p & r is_a_prefix_of q) implies r is_a_prefix_of it)));
existence
proof
deffunc F(set) = $1;
defpred P[ set ]
 means
(ex r being FinSequence st ((r c= p & r c= q) & ( len r ) = $1));
set S = { F(k) where k is (Element of ( NAT )): ((( 0 ) <= k & k <= ( len p )) & P[ k ]) };
A1: (for x being set holds (x in S implies x is  natural))
proof
let x being set;
assume x in S;
then (ex n being (Element of ( NAT )) st (((x = n & ( 0 ) <= n) & n <= ( len p )) & P[ n ]));
hence thesis;
end;
A2: S is  finite from FINSEQ_1:sch 6;
((( {} ) c= p & ( {} ) c= q) & ( len ( {} ) ) = ( 0 )) by XBOOLE_1:2;
then ( 0 ) in S;
then reconsider S as  finite non  empty  natural-membered set by A1,A2,MEMBERED:def 6;
set maxk = ( max S );
maxk in S by XXREAL_2:def 8;
then consider K being (Element of ( NAT )) such that A3: K = maxk and ( 0 ) <= K and K <= ( len p ) and A4: P[ K ];
consider R being FinSequence such that A5: R c= p and A6: R c= q and A7: ( len R ) = K by A4;
take R;
thus R c= p by A5;
thus R c= q by A6;
let r being FinSequence;
assume that
A8: r c= p
and
A9: r c= q;
( dom r ) c= ( dom p ) by A8,GRFUNC_1:2;
then ( len r ) <= ( len p ) by FINSEQ_3:30;
then ( len r ) in S by A8,A9;
then ( len r ) <= ( len R ) by A3,A7,XXREAL_2:def 8;
then A10: ( dom r ) c= ( dom R ) by FINSEQ_3:30;
now
let x being set;
assume A11: x in ( dom r );
hence ( r . x ) = ( p . x ) by A8,GRFUNC_1:2
.= ( R . x ) by A5,A10,A11,GRFUNC_1:2;
end;
hence thesis by A10,GRFUNC_1:2;
end;
uniqueness
proof
let it1 being FinSequence;
let it2 being FinSequence;
assume ((((it1 c= p & it1 c= q) & (for r being FinSequence holds ((r c= p & r c= q) implies r c= it1))) & it2 c= p) & (it2 c= q & (for r being FinSequence holds ((r c= p & r c= q) implies r c= it2))));
then (it1 c= it2 & it2 c= it1);
hence thesis by XBOOLE_0:def 10;
end;
commutativity;
end;
