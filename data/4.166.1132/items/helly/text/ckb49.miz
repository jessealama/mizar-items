environ
vocabularies NUMBERS,XBOOLE_0,FINSEQ_1,FUNCT_1,GRAPH_2,ARYTM_3,NAT_1,XXREAL_0,SUBSET_1,TREES_1,TARSKI,CARD_1,ORDINAL1,FINSET_1,MEMBERED,RELAT_1,ORDINAL4,GLIB_000,GLIB_001,ABIAN,ZFMISC_1,ARYTM_1,GRAPH_1,RCOMP_1,SETFAM_1,HELLY;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,FINSET_1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,SETFAM_1,FUNCT_1,FINSEQ_1,MEMBERED,NAT_1,TREES_1,XXREAL_2,ABIAN,GRAPH_2,GLIB_000,GLIB_001,GLIB_002,CKB2,CKB27,CKB28,CKB34;
definitions TARSKI,XBOOLE_0,GLIB_001,CKB2,CKB34;
theorems TARSKI,NAT_1,GRAPH_5,SETFAM_1,XBOOLE_0,XBOOLE_1,GRFUNC_1,FUNCT_1,ZFMISC_1,ORDINAL1,FINSEQ_1,FINSEQ_2,FINSEQ_3,INT_1,EULER_1,CARD_1,XREAL_1,XXREAL_0,CHORD,ABIAN,GLIB_000,GLIB_001,GLIB_002,MSSCYC_1,MEMBERED,GRAPH_2,XXREAL_2,FINSEQ_4,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB30,CKB32,CKB33,CKB34,CKB35,CKB36,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48;
schemes NAT_1,FINSEQ_1;
registrations FINSET_1,XREAL_0,XXREAL_0,NAT_1,INT_1,RELAT_1,FINSEQ_1,ABIAN,MEMBERED,GLIB_000,GLIB_001,GLIB_002,XXREAL_2,CARD_1,FUNCT_1,XBOOLE_0,CKB14,CKB29,CKB31,CKB37,CKB38;
constructors DOMAIN_1,SETFAM_1,NAT_1,GRAPH_2,GLIB_001,GLIB_002,XXREAL_2,RELSET_1,RAT_1,CKB2,CKB34;
requirements BOOLE,SUBSET,NUMERALS,ARITHM,REAL;
begin
theorem
Th40: (for T being _Tree holds (for a,b,c,d being (Vertex of T) holds (for P1,P2 being (Path of T) holds (((((P1 = ( T .pathBetween (a,b) ) & P2 = ( T .pathBetween (a,c) )) & (not P1 is_a_prefix_of P2)) & (not P2 is_a_prefix_of P1)) & d = ( P1 . ( len ( maxPrefix (P1,P2) ) ) )) implies ( ( ( T .pathBetween (d,b) ) .vertices() ) /\ ( ( T .pathBetween (d,c) ) .vertices() ) ) = { d }))))
proof
let T being _Tree;
let a being (Vertex of T),b being (Vertex of T),c being (Vertex of T),d being (Vertex of T);
let P1 being (Path of T),P2 being (Path of T);
assume that
A1: P1 = ( T .pathBetween (a,b) )
and
A2: P2 = ( T .pathBetween (a,c) )
and
A3: (not P1 c= P2)
and
A4: (not P2 c= P1)
and
A5: d = ( P1 . ( len ( maxPrefix (P1,P2) ) ) );
set Pad = ( T .pathBetween (a,d) );
set di = ( len ( maxPrefix (P1,P2) ) );
A6: ( P1 .first() ) = a by A1,CKB35:1;
A7: ( P2 .first() ) = a by A2,CKB35:1;
then reconsider di as  odd (Element of ( NAT )) by A6,CKB24:1;
A8: di <= ( di + 2 ) by NAT_1:11;
set Pdb = ( T .pathBetween (d,b) );
A9: ( Pdb .first() ) = d by CKB35:1;
set Pdc = ( T .pathBetween (d,c) );
A10: d = ( P2 . ( len ( maxPrefix (P1,P2) ) ) ) by A5,CKB8:1;
A11: di <= ( di + 2 ) by NAT_1:11;
( di + 2 ) <= ( len P2 ) by A4,A6,A7,CKB25:1;
then di <= ( len P2 ) by A11,XXREAL_0:2;
then d in ( P2 .vertices() ) by A10,GLIB_001:87;
then A12: P2 = ( Pad .append Pdc ) by A2,CKB45:1;
A13: ( Pad .last() ) = d by CKB35:1;
A14: ( Pdc . 1 ) = ( Pdc .first() )
.= d by CKB35:1;
A15: ( Pdc .first() ) = d by CKB35:1;
( di + 2 ) <= ( len P1 ) by A3,A6,A7,CKB25:1;
then A16: di <= ( len P1 ) by A8,XXREAL_0:2;
then d in ( P1 .vertices() ) by A5,GLIB_001:87;
then A17: P1 = ( Pad .append Pdb ) by A1,CKB45:1;
A18: 1 <= di by ABIAN:12;
then Pad = ( P1 .cut (( ( 2 * ( 0 ) ) + 1 ),di) ) by A5,A6,A16,CKB44:1;
then A19: ( ( len Pad ) + ( ( 2 * ( 0 ) ) + 1 ) ) = ( di + 1 ) by A16,A18,GLIB_001:36;
A20: ( Pdb . 1 ) = ( Pdb .first() )
.= d by CKB35:1;
thus ( ( Pdb .vertices() ) /\ ( Pdc .vertices() ) ) = { d }
proof
hereby
assume (not ( ( Pdb .vertices() ) /\ ( Pdc .vertices() ) ) c= { d });
then consider e being set such that A21: e in ( ( Pdb .vertices() ) /\ ( Pdc .vertices() ) ) and A22: (not e in { d }) by TARSKI:def 3;
A23: e in ( Pdb .vertices() ) by A21,XBOOLE_0:def 4;
A24: e in ( Pdc .vertices() ) by A21,XBOOLE_0:def 4;
reconsider e as (Vertex of T) by A21;
consider ebi being  odd (Element of ( NAT )) such that A25: ebi <= ( len Pdb ) and A26: e = ( Pdb . ebi ) by A23,GLIB_001:87;
set Pdeb = ( Pdb .cut (1,ebi) );
(1 <= ebi & ( ( 2 * ( 0 ) ) + 1 ) is  odd  odd (Element of ( NAT ))) by ABIAN:12;
then A27: Pdeb is_Walk_from d,e by A20,A25,A26,GLIB_001:37;
1 < ( len Pdeb )
proof
assume A28: 1 >= ( len Pdeb );
per cases  by A28,NAT_1:25;
suppose ( len Pdeb ) = ( 2 * ( 0 ) );

hence contradiction;
end;
suppose A29: ( len Pdeb ) = 1;

A30: ( Pdeb . 1 ) = d by A27,GLIB_001:17;
( Pdeb . 1 ) = e by A27,A29,GLIB_001:17;
hence contradiction by A22,A30,TARSKI:def 1;
end;
end;
then A31: ( ( ( 2 * ( 0 ) ) + 1 ) + 2 ) <= ( len Pdeb ) by CHORD:4;
then A32: 2 < ( len Pdeb ) by XXREAL_0:2;
consider eci being  odd (Element of ( NAT )) such that A33: eci <= ( len Pdc ) and A34: e = ( Pdc . eci ) by A24,GLIB_001:87;
set Pdec = ( Pdc .cut (1,eci) );
(1 <= eci & ( ( 2 * ( 0 ) ) + 1 ) is  odd  odd (Element of ( NAT ))) by ABIAN:12;
then A35: Pdec is_Walk_from d,e by A14,A33,A34,GLIB_001:37;
1 < ( len Pdec )
proof
assume A36: 1 >= ( len Pdec );
per cases  by A36,NAT_1:25;
suppose ( len Pdec ) = ( 2 * ( 0 ) );

hence contradiction;
end;
suppose A37: ( len Pdec ) = 1;

A38: ( Pdec . 1 ) = d by A35,GLIB_001:17;
( Pdec . 1 ) = e by A35,A37,GLIB_001:17;
hence contradiction by A22,A38,TARSKI:def 1;
end;
end;
then A39: ( ( ( 2 * ( 0 ) ) + 1 ) + 2 ) <= ( len Pdec ) by CHORD:4;
then A40: 2 < ( len Pdec ) by XXREAL_0:2;
( 1 + 2 ) in ( dom Pdeb ) by A31,FINSEQ_3:25;
then A41: ( Pdeb . ( 1 + 2 ) ) = ( Pdb . ( 1 + 2 ) ) by A25,GLIB_001:46;
( len Pdeb ) <= ( len Pdb ) by CKB11:1;
then 2 < ( len Pdb ) by A32,XXREAL_0:2;
then A42: ( P1 . ( di + 2 ) ) = ( Pdb . ( 1 + 2 ) ) by A9,A13,A17,A19,GLIB_001:33;
( len Pdec ) <= ( len Pdc ) by CKB11:1;
then 2 < ( len Pdc ) by A40,XXREAL_0:2;
then A43: ( P2 . ( di + 2 ) ) = ( Pdc . ( 1 + 2 ) ) by A15,A13,A12,A19,GLIB_001:33;
A44: ( 1 + 2 ) in ( dom Pdec ) by A39,FINSEQ_3:25;
( Pdeb . ( 1 + 2 ) ) = ( Pdec . ( 1 + 2 ) ) by A27,A35,CKB33:1;
hence contradiction by A3,A4,A6,A7,A33,A42,A41,A43,A44,CKB26:1,GLIB_001:46;
end;
(d in ( Pdb .vertices() ) & d in ( Pdc .vertices() )) by A9,A15,GLIB_001:88;
then d in ( ( Pdb .vertices() ) /\ ( Pdc .vertices() ) ) by XBOOLE_0:def 4;
hence thesis by ZFMISC_1:31;
end;

end;
