environ
vocabularies RLVECT_1,ALGSTR_1,ALGSTR_0,VECTSP_1,BINOP_1,LATTICES,VECTSP_2,ZFMISC_1,XBOOLE_0,STRUCT_0,POLYNOM1,VALUED_0,SUBSET_1,SUPINF_2,FUNCT_4,PRE_POLY,FUNCT_1,FUNCOP_1,RELAT_1,ORDINAL1,CARD_1,PARTFUN1,POLYNOM2,FINSEQ_1,CARD_3,NUMBERS,XXREAL_0,QC_LANG1,FINSET_1,ORDERS_1,ARYTM_3,NAT_1,MESFUNC1,QUOFIELD,GROUP_1,TARSKI,MSSUBFAM,ALGSEQ_1,CAT_3,XCMPLX_0,ORDINAL4,POLYNOM7;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,RELSET_1,FUNCT_1,FINSET_1,ORDINAL1,PARTFUN1,FUNCT_2,FUNCT_7,POLYNOM1,NUMBERS,XXREAL_0,DOMAIN_1,STRUCT_0,ALGSTR_0,FUNCT_4,NAT_1,ALGSTR_1,RLVECT_1,ORDERS_1,FINSEQ_1,FUNCOP_1,GROUP_1,QUOFIELD,GRCAT_1,VECTSP_2,POLYNOM2,VECTSP_1,GROUP_6,PRE_POLY,CKB2,CKB7,CKB14,CKB16,CKB19,CKB20,CKB21;
definitions FUNCOP_1,STRUCT_0,CKB2,CKB7,CKB14,CKB19,CKB20,CKB21;
theorems TARSKI,FINSEQ_1,FUNCT_1,FUNCT_2,RELAT_1,ZFMISC_1,VECTSP_1,POLYNOM1,STRUCT_0,QUOFIELD,FUNCT_7,FUNCT_4,FUNCOP_1,GRCAT_1,BINOM,FINSEQ_3,RLVECT_1,VECTSP_2,GROUP_1,NAT_1,FINSEQ_2,FINSEQ_5,MATRLIN,POLYNOM2,XBOOLE_0,REALSET1,XREAL_1,GROUP_6,XXREAL_0,ORDINAL1,PARTFUN1,PRE_POLY,CKB2,CKB5,CKB6,CKB7,CKB10,CKB11,CKB12,CKB13,CKB14,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26;
schemes FUNCT_2;
registrations XBOOLE_0,ORDINAL1,RELSET_1,FUNCOP_1,FINSET_1,XREAL_0,STRUCT_0,VECTSP_1,ALGSTR_1,POLYNOM1,POLYNOM2,ALGSTR_0,CARD_1,SUBSET_1,PRE_POLY,ZFMISC_1,FUNCT_1,CKB1,CKB3,CKB4,CKB8,CKB9,CKB15,CKB17;
constructors RFUNCT_3,REALSET2,GRCAT_1,GROUP_6,TRIANG_1,QUOFIELD,POLYNOM2,ALGSTR_1,RELSET_1,FUNCT_7,FVSUM_1,VFUNCT_1,CKB2,CKB7,CKB14,CKB19,CKB20,CKB21;
requirements NUMERALS,BOOLE,SUBSET,ARITHM;
begin
theorem
Th12: (for n being Ordinal holds (for L being  right_zeroed  add-associative  right_complementable  well-unital  distributive non  trivial doubleLoopStr holds (for m being (Monomial of n,L) holds (for x being (Function of n,L) holds ( eval (m,x) ) = ( ( coefficient m ) * ( eval (( term m ),x) ) )))))
proof
let n being Ordinal;
let L being  right_zeroed  add-associative  right_complementable  well-unital  distributive non  trivial doubleLoopStr;
let m being (Monomial of n,L);
let x being (Function of n,L);
consider y being (FinSequence of (the carrier of L)) such that A1: ( len y ) = ( len ( SgmX (( BagOrder n ),( Support m )) ) ) and A2: ( eval (m,x) ) = ( Sum y ) and A3: (for i being (Element of ( NAT )) holds ((1 <= i & i <= ( len y )) implies ( y /. i ) = ( ( ( m * ( SgmX (( BagOrder n ),( Support m )) ) ) /. i ) * ( eval (( ( ( SgmX (( BagOrder n ),( Support m )) ) /. i ) @ ),x) ) ))) by POLYNOM2:def 4;
consider b being (bag of n) such that A4: (for b9 being (bag of n) holds (b9 <> b implies ( m . b9 ) = ( 0. L ))) by CKB14:def 1;
now
per cases ;
case A5: ( m . b ) <> ( 0. L );
A6: (for u being set holds (u in ( Support m ) implies u in { b }))
proof
let u being set;
assume A7: u in ( Support m );
assume A8: (not u in { b });
reconsider u as (Element of ( Bags n )) by A7;
u <> b by A8,TARSKI:def 1;
then ( m . u ) = ( 0. L ) by A4;
hence thesis by A7,POLYNOM1:def 3;
end;
A9: (b in ( Bags n ) & ( dom m ) = ( Bags n )) by FUNCT_2:def 1,PRE_POLY:def 12;
reconsider sm = ( Support m ) as  finite (Subset of ( Bags n ));
set sg = ( SgmX (( BagOrder n ),sm) );
A10: ( BagOrder n ) linearly_orders sm by POLYNOM2:18;
(for u being set holds (u in { b } implies u in ( Support m )))
proof
let u being set;
assume A11: u in { b };
then u = b by TARSKI:def 1;
then reconsider u as (Element of ( Bags n )) by PRE_POLY:def 12;
( m . u ) <> ( 0. L ) by A5,A11,TARSKI:def 1;
hence thesis by POLYNOM1:def 3;
end;
then ( Support m ) = { b } by A6,TARSKI:1;
then A12: ( rng sg ) = { b } by A10,PRE_POLY:def 2;
then A13: b in ( rng sg ) by TARSKI:def 1;
then A14: 1 in ( dom sg ) by FINSEQ_3:31;
then A15: ( sg . 1 ) in ( rng sg ) by FUNCT_1:3;
then ( sg . 1 ) = b by A12,TARSKI:def 1;
then 1 in ( dom ( m * sg ) ) by A14,A9,FUNCT_1:11;
then A16: ( ( m * sg ) /. 1 ) = ( ( m * sg ) . 1 ) by PARTFUN1:def 6
.= ( m . ( sg . 1 ) ) by A14,FUNCT_1:13
.= ( m . b ) by A12,A15,TARSKI:def 1
.= ( coefficient m ) by A5,CKB20:def 1;
A17: (for u being set holds (u in ( dom sg ) implies u in { 1 }))
proof
let u being set;
assume A18: u in ( dom sg );
assume A19: (not u in { 1 });
reconsider u as (Element of ( NAT )) by A18;
( sg /. u ) = ( sg . u ) by A18,PARTFUN1:def 6;
then A20: ( sg /. u ) in ( rng sg ) by A18,FUNCT_1:3;
A21: u <> 1 by A19,TARSKI:def 1;
A22: 1 < u
proof
consider k being Nat such that A23: ( dom sg ) = ( Seg k ) by FINSEQ_1:def 2;
( Seg k ) = { l where l is (Element of ( NAT )): (1 <= l & l <= k) } by FINSEQ_1:def 1;
then (ex m9 being (Element of ( NAT )) st ((m9 = u & 1 <= m9) & m9 <= k)) by A18,A23;
hence thesis by A21,XXREAL_0:1;
end;
( sg /. 1 ) = ( sg . 1 ) by A13,A18,FINSEQ_3:31,PARTFUN1:def 6;
then ( sg /. 1 ) in ( rng sg ) by A14,FUNCT_1:3;
then ( sg /. 1 ) = b by A12,TARSKI:def 1
.= ( sg /. u ) by A12,A20,TARSKI:def 1;
hence thesis by A10,A14,A18,A22,PRE_POLY:def 2;
end;
(for u being set holds (u in { 1 } implies u in ( dom sg ))) by A14,TARSKI:def 1;
then A24: ( dom sg ) = ( Seg 1 ) by A17,FINSEQ_1:2,TARSKI:1;
then A25: 1 in ( dom sg ) by FINSEQ_1:2,TARSKI:def 1;
( sg /. 1 ) = ( sg . 1 ) by A14,PARTFUN1:def 6;
then ( sg /. 1 ) in ( rng sg ) by A25,FUNCT_1:3;
then A26: ( sg /. 1 ) = b by A12,TARSKI:def 1;
A27: ( len sg ) = 1 by A24,FINSEQ_1:def 3;
( dom y ) = ( Seg ( len y ) ) by FINSEQ_1:def 3
.= ( dom sg ) by A1,FINSEQ_1:def 3;
then ( y . 1 ) = ( y /. 1 ) by A25,PARTFUN1:def 6
.= ( ( ( m * sg ) /. 1 ) * ( eval (( ( sg /. 1 ) @ ),x) ) ) by A1,A3,A27
.= ( ( ( m * sg ) /. 1 ) * ( eval (b,x) ) ) by A26,POLYNOM2:def 3;
then y = <* ( ( coefficient m ) * ( eval (b,x) ) ) *> by A1,A27,A16,FINSEQ_1:40;
hence ( eval (m,x) ) = ( ( coefficient m ) * ( eval (b,x) ) ) by A2,RLVECT_1:44
.= ( ( coefficient m ) * ( eval (( term m ),x) ) ) by A5,CKB20:def 1;
end;
case A28: ( m . b ) = ( 0. L );
A29: ( Support m ) = ( {} )
proof
assume ( Support m ) <> ( {} );
then reconsider sm = ( Support m ) as non  empty (Subset of ( Bags n ));
set c = the (Element of sm);
( m . c ) <> ( 0. L ) by POLYNOM1:def 3;
hence thesis by A4,A28;
end;
then (( term m ) = ( EmptyBag n ) & ( m . ( EmptyBag n ) ) = ( 0. L )) by CKB20:def 1,POLYNOM1:def 3;
then A30: ( ( coefficient m ) * ( eval (( term m ),x) ) ) = ( 0. L ) by VECTSP_1:7;
consider y being (FinSequence of (the carrier of L)) such that A31: ( len y ) = ( len ( SgmX (( BagOrder n ),( Support m )) ) ) and A32: ( eval (m,x) ) = ( Sum y ) and (for i being (Element of ( NAT )) holds ((1 <= i & i <= ( len y )) implies ( y /. i ) = ( ( ( m * ( SgmX (( BagOrder n ),( Support m )) ) ) /. i ) * ( eval (( ( ( SgmX (( BagOrder n ),( Support m )) ) /. i ) @ ),x) ) ))) by POLYNOM2:def 4;
( BagOrder n ) linearly_orders ( Support m ) by POLYNOM2:18;
then ( rng ( SgmX (( BagOrder n ),( Support m )) ) ) = ( {} ) by A29,PRE_POLY:def 2;
then ( SgmX (( BagOrder n ),( Support m )) ) = ( {} ) by RELAT_1:41;
then y = ( <*> (the carrier of L) ) by A31;
hence thesis by A30,A32,RLVECT_1:43;
end;
end;
hence thesis;
end;
