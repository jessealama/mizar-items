environ
vocabularies NUMBERS,XREAL_0,ORDINAL1,INTEGRA1,SUBSET_1,PARTFUN1,XXREAL_0,ARYTM_3,XXREAL_1,ARYTM_1,TARSKI,RELAT_1,FUNCT_3,XBOOLE_0,FUNCT_1,MEASURE7,INTEGRA5,ORDINAL2,COMPLEX1,CARD_1,REALSET1,XXREAL_2,REAL_1,VALUED_1,FINSEQ_1,NAT_1,INTEGRA2,SEQ_2,INTEGRA4,INT_1,RFINSEQ,ORDINAL4,CARD_3,FCONT_1,FDIFF_1,RSSPACE,SEQ_1,FUNCT_2,FUNCOP_1,RCOMP_1,VALUED_0,SEQ_4,MEASURE5;
notations TARSKI,XBOOLE_0,SUBSET_1,RELAT_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,INT_1,FUNCT_1,PARTFUN1,FUNCT_2,FUNCOP_1,RCOMP_1,FINSEQ_1,VALUED_0,VALUED_1,SEQ_1,RFUNCT_1,SEQ_2,FDIFF_1,RFINSEQ,XXREAL_2,MEASURE6,RVSUM_1,MEASURE5,INTEGRA1,INTEGRA2,FCONT_1,RSSPACE,INTEGRA3,INTEGRA4,INTEGRA5,XXREAL_0,SEQ_4;
definitions TARSKI,XCMPLX_0,INTEGRA1,FINSEQ_1,INTEGRA5,INTEGRA3;
theorems ORDINAL1,PARTFUN1,INTEGRA1,RFUNCT_1,FUNCT_1,FINSEQ_1,RVSUM_1,SEQ_1,SEQ_2,FDIFF_1,ABSVALUE,NAT_1,INT_1,COMPLEX1,TARSKI,INTEGRA2,INTEGRA3,RFINSEQ,INTEGRA4,FINSEQ_2,FINSEQ_3,RCOMP_1,FCONT_1,XREAL_0,XXREAL_0,FUNCT_2,FINSEQ_5,XBOOLE_0,XBOOLE_1,XCMPLX_1,XREAL_1,INTEGRA5,RSSPACE,RELAT_1,VALUED_1,XXREAL_2,XXREAL_1,SEQM_3,FUNCOP_1,RELSET_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16;
schemes FUNCT_2,PARTFUN1,FINSEQ_2;
registrations XBOOLE_0,RELAT_1,ORDINAL1,FUNCT_2,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,RCOMP_1,FDIFF_1,SEQM_3,INTEGRA1,VALUED_0,VALUED_1,FINSET_1,XXREAL_2,CARD_1,RELSET_1,MEASURE5;
constructors PARTFUN1,REAL_1,NAT_1,BINOP_2,COMPLEX1,RFUNCT_1,RFUNCT_2,FCONT_1,FDIFF_1,RFINSEQ,RSSPACE,MEASURE6,INTEGRA2,INTEGRA4,INTEGRA5,SEQ_1,XXREAL_2,RVSUM_1,SEQ_4,RELSET_1,FUNCOP_1,SEQ_2,INTEGRA3;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve A for non empty  closed_interval (Subset of ( REAL ));
theorem
Th16: (( vol A ) > ( 0 ) implies (ex T being (DivSequence of A) st ((( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 )) & (for n being (Element of ( NAT )) holds (ex Tn being (Division of A) st (Tn divide_into_equal ( n + 1 ) & ( T . n ) = Tn))))))
proof
defpred P[ set,set ]
 means
(ex n being (Element of ( NAT )) st (ex e being (Division of A) st ((n = $1 & e = $2) & e divide_into_equal ( n + 1 ))));
assume A1: ( vol A ) > ( 0 );
A2: (for n being (Element of ( NAT )) holds (ex D being (Element of ( divs A )) st P[ n,D ]))
proof
let n being (Element of ( NAT ));
consider D being (Division of A) such that A3: (( len D ) = ( n + 1 ) & (for i being (Element of ( NAT )) holds (i in ( dom D ) implies ( D . i ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( n + 1 ) ) * i ) )))) by A1,CKB16:1;
reconsider D1 = D as (Element of ( divs A )) by INTEGRA1:def 3;
take D1;
D divide_into_equal ( n + 1 ) by A3,INTEGRA4:def 1;
hence thesis;
end;
consider T being (Function of ( NAT ),( divs A )) such that A4: (for n being (Element of ( NAT )) holds P[ n,( T . n ) ]) from FUNCT_2:sch 3(A2);
reconsider T as (DivSequence of A);
A5: (for n being (Element of ( NAT )) holds (ex Tn being (Division of A) st (Tn divide_into_equal ( n + 1 ) & ( T . n ) = Tn)))
proof
let n being (Element of ( NAT ));
(ex n1 being (Element of ( NAT )) st (ex Tn being (Division of A) st ((n1 = n & Tn = ( T . n )) & Tn divide_into_equal ( n1 + 1 )))) by A4;
hence thesis;
end;
A6: (for i being (Element of ( NAT )) holds ( ( delta T ) . i ) = ( ( vol A ) / ( i + 1 ) ))
proof
let i being (Element of ( NAT ));
(for x1 being set holds (x1 in ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) implies x1 in { ( ( vol A ) / ( i + 1 ) ) }))
proof
reconsider D = ( T . i ) as (Division of A);
let x1 being set;
assume x1 in ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) );
then consider k being (Element of ( NAT )) such that A7: k in ( dom ( upper_volume (( chi (A,A) ),( T . i )) ) ) and A8: ( ( upper_volume (( chi (A,A) ),( T . i )) ) . k ) = x1 by PARTFUN1:3;
k in ( Seg ( len ( upper_volume (( chi (A,A) ),( T . i )) ) ) ) by A7,FINSEQ_1:def 3;
then k in ( Seg ( len D ) ) by INTEGRA1:def 6;
then A9: k in ( dom D ) by FINSEQ_1:def 3;
A10: (ex n being (Element of ( NAT )) st (ex e being (Division of A) st ((n = i & e = D) & e divide_into_equal ( n + 1 )))) by A4;
A11: ( ( upper_bound ( divset (D,k) ) ) - ( lower_bound ( divset (D,k) ) ) ) = ( ( vol A ) / ( i + 1 ) )
proof
A12:now
A13: ( len D ) = ( i + 1 ) by A10,INTEGRA4:def 1;
assume A14: k = 1;
then ( upper_bound ( divset (D,k) ) ) = ( D . 1 ) by A9,INTEGRA1:def 4;
then ( upper_bound ( divset (D,k) ) ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( i + 1 ) ) * 1 ) ) by A10,A9,A14,A13,INTEGRA4:def 1;
then ( ( upper_bound ( divset (D,k) ) ) - ( lower_bound ( divset (D,k) ) ) ) = ( ( ( lower_bound A ) + ( ( vol A ) / ( i + 1 ) ) ) - ( lower_bound A ) ) by A9,A14,INTEGRA1:def 4;
hence thesis;
end;
now
assume A15: k <> 1;
then ( k - 1 ) in ( dom D ) by A9,INTEGRA1:7;
then A16: ( D . ( k - 1 ) ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( len D ) ) * ( k - 1 ) ) ) by A10,INTEGRA4:def 1;
A17: ( D . k ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( len D ) ) * k ) ) by A10,A9,INTEGRA4:def 1;
(( lower_bound ( divset (D,k) ) ) = ( D . ( k - 1 ) ) & ( upper_bound ( divset (D,k) ) ) = ( D . k )) by A9,A15,INTEGRA1:def 4;
hence thesis by A10,A16,A17,INTEGRA4:def 1;
end;
hence thesis by A12;
end;
x1 = ( vol ( divset (D,k) ) ) by A8,A9,INTEGRA1:20;
hence thesis by A11,TARSKI:def 1;
end;
then A18: ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) c= { ( ( vol A ) / ( i + 1 ) ) } by TARSKI:def 3;
(for x1 being set holds (x1 in { ( ( vol A ) / ( i + 1 ) ) } implies x1 in ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) )))
proof
reconsider D = ( T . i ) as (Division of A);
let x1 being set;
assume x1 in { ( ( vol A ) / ( i + 1 ) ) };
then A19: x1 = ( ( vol A ) / ( i + 1 ) ) by TARSKI:def 1;
A20: (ex n being (Element of ( NAT )) st (ex e being (Division of A) st ((n = i & e = D) & e divide_into_equal ( n + 1 )))) by A4;
( rng D ) <> ( {} );
then A21: 1 in ( dom D ) by FINSEQ_3:32;
then ( upper_bound ( divset (D,1) ) ) = ( D . 1 ) by INTEGRA1:def 4;
then ( upper_bound ( divset (D,1) ) ) = ( ( lower_bound A ) + ( ( ( vol A ) / ( len D ) ) * 1 ) ) by A21,A20,INTEGRA4:def 1;
then A22: ( vol ( divset (D,1) ) ) = ( ( ( lower_bound A ) + ( ( vol A ) / ( len D ) ) ) - ( lower_bound A ) ) by A21,INTEGRA1:def 4;
1 in ( Seg ( len D ) ) by A21,FINSEQ_1:def 3;
then 1 in ( Seg ( len ( upper_volume (( chi (A,A) ),D) ) ) ) by INTEGRA1:def 6;
then 1 in ( dom ( upper_volume (( chi (A,A) ),D) ) ) by FINSEQ_1:def 3;
then A23: ( ( upper_volume (( chi (A,A) ),D) ) . 1 ) in ( rng ( upper_volume (( chi (A,A) ),D) ) ) by FUNCT_1:def 3;
( ( upper_volume (( chi (A,A) ),D) ) . 1 ) = ( vol ( divset (D,1) ) ) by A21,INTEGRA1:20;
hence thesis by A19,A23,A20,A22,INTEGRA4:def 1;
end;
then { ( ( vol A ) / ( i + 1 ) ) } c= ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) by TARSKI:def 3;
then (( ( delta T ) . i ) = ( delta ( T . i ) ) & ( rng ( upper_volume (( chi (A,A) ),( T . i )) ) ) = { ( ( vol A ) / ( i + 1 ) ) }) by A18,INTEGRA3:def 2,XBOOLE_0:def 10;
then ( ( delta T ) . i ) in { ( ( vol A ) / ( i + 1 ) ) } by XXREAL_2:def 8;
hence thesis by TARSKI:def 1;
end;
A24: (for a being Real holds (( 0 ) < a implies (ex i being (Element of ( NAT )) st ( abs ( ( ( delta T ) . i ) - ( 0 ) ) ) < a)))
proof
let a being Real;
A25: ( vol A ) >= ( 0 ) by INTEGRA1:9;
reconsider i1 = ( [\ ( ( vol A ) / a ) /] + 1 ) as Integer;
assume A26: ( 0 ) < a;
then ( [\ ( ( vol A ) / a ) /] + 1 ) > ( 0 ) by A25,INT_1:29;
then reconsider i1 as (Element of ( NAT )) by INT_1:3;
i1 < ( i1 + 1 ) by NAT_1:13;
then ( ( vol A ) / a ) < ( 1 * ( i1 + 1 ) ) by INT_1:29,XXREAL_0:2;
then A27: ( ( vol A ) / ( i1 + 1 ) ) < ( 1 * a ) by A26,XREAL_1:113;
A28: ( ( delta T ) . i1 ) = ( ( vol A ) / ( i1 + 1 ) ) by A6;
( ( ( vol A ) / ( i1 + 1 ) ) - ( 0 ) ) = ( abs ( ( ( vol A ) / ( i1 + 1 ) ) - ( 0 ) ) ) by A25,ABSVALUE:def 1;
hence thesis by A27,A28;
end;
A29: (for i,j being (Element of ( NAT )) holds (i <= j implies ( ( delta T ) . i ) >= ( ( delta T ) . j )))
proof
let i being (Element of ( NAT )),j being (Element of ( NAT ));
assume i <= j;
then A30: ( i + 1 ) <= ( j + 1 ) by XREAL_1:6;
( vol A ) >= ( 0 ) by INTEGRA1:9;
then ( ( vol A ) / ( i + 1 ) ) >= ( ( vol A ) / ( j + 1 ) ) by A30,XREAL_1:118;
then ( ( delta T ) . i ) >= ( ( vol A ) / ( j + 1 ) ) by A6;
hence thesis by A6;
end;
A31: (for a being  real number holds (( 0 ) < a implies (ex i being (Element of ( NAT )) st (for j being (Element of ( NAT )) holds (i <= j implies ( abs ( ( ( delta T ) . j ) - ( 0 ) ) ) < a)))))
proof
let a being  real number;
assume A32: ( 0 ) < a;
a is Real by XREAL_0:def 1;
then consider i being (Element of ( NAT )) such that A33: ( abs ( ( ( delta T ) . i ) - ( 0 ) ) ) < a by A24,A32;
( ( delta T ) . i ) = ( delta ( T . i ) ) by INTEGRA3:def 2;
then ( ( delta T ) . i ) >= ( 0 ) by INTEGRA3:9;
then A34: ( ( delta T ) . i ) < a by A33,ABSVALUE:def 1;
now
let j being (Element of ( NAT ));
assume i <= j;
then ( ( delta T ) . j ) <= ( ( delta T ) . i ) by A29;
then A35: ( ( delta T ) . j ) < a by A34,XXREAL_0:2;
( ( delta T ) . j ) = ( delta ( T . j ) ) by INTEGRA3:def 2;
then ( ( delta T ) . j ) >= ( 0 ) by INTEGRA3:9;
hence ( abs ( ( ( delta T ) . j ) - ( 0 ) ) ) < a by A35,ABSVALUE:def 1;
end;
hence thesis;
end;
then A36: ( delta T ) is  convergent by SEQ_2:def 6;
then ( lim ( delta T ) ) = ( 0 ) by A31,SEQ_2:def 7;
hence thesis by A5,A36;
end;
