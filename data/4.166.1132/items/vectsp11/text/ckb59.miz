environ
vocabularies NUMBERS,NAT_1,VECTSP_1,SUBSET_1,MATRIX_1,FINSEQ_2,ZFMISC_1,RELAT_1,TARSKI,CARD_1,ARYTM_3,FUNCT_1,FREEALG,FINSET_1,FINSEQ_1,MESFUNC1,GROUP_1,SUPINF_2,LAPLACE,XBOOLE_0,MATRIX_2,ARYTM_1,XXREAL_0,POLYNOM1,POLYNOM2,MATRIX_3,CARD_3,AFINSQ_1,ORDINAL4,POLYNOM3,STRUCT_0,PARTFUN1,RANKNULL,RLSUB_1,RLVECT_5,PRVECT_1,RLVECT_3,ALGSTR_0,VECTSP10,MATRLIN,MATRLIN2,POLYNOM5,NEWTON,MONOID_0,BINOP_1,RLVECT_1,LATTICES,RLSUB_2,FINSEQ_4,MCART_1,RLVECT_2,VALUED_1,FUNCT_2,VECTSP11,MSSUBFAM,UNIALG_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,BINOP_1,STRUCT_0,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,NAT_D,GROUP_4,MATRIX_3,DOMAIN_1,MEASURE6,PRVECT_1,VECTSP_4,VECTSP_5,VECTSP_6,VECTSP_7,VECTSP_9,FINSEQOP,MATRIX13,MATRLIN,LAPLACE,MOD_2,RANKNULL,POLYNOM3,MONOID_0,ALGSEQ_1,POLYNOM4,POLYNOM5,MATRLIN2,GRCAT_1,CKB11,CKB14,CKB15,CKB25,CKB33;
definitions STRUCT_0,TARSKI,XBOOLE_0,RLVECT_1,FINSEQ_1,VECTSP_4,FVSUM_1,LAPLACE,MATRIX13,RANKNULL,VECTSP_6,MATRLIN2,CKB11,CKB14,CKB15,CKB25,CKB33;
theorems ZFMISC_1,RLVECT_1,MATRIX_1,MATRIX_3,VECTSP_1,NAT_1,FINSEQ_1,FINSEQ_3,FINSEQ_2,CARD_1,CARD_2,FINSEQOP,FINSOP_1,FUNCT_1,FUNCT_2,FVSUM_1,GROUP_1,LAPLACE,MATRIX13,MATRIXR2,MATRLIN,ORDINAL1,PARTFUN1,RELAT_1,STIRL2_1,STRUCT_0,TARSKI,VECTSP_4,VECTSP_5,VECTSP_6,VECTSP_7,VECTSP_9,VECTSP10,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,MOD_2,RANKNULL,MONOID_0,GROUP_4,SYSREL,SUBSET_1,FINSEQ_5,ALGSEQ_1,POLYNOM4,POLYNOM5,HILBASIS,MATRIXJ1,MATRLIN2,VALUED_0,NAT_D,GRCAT_1,RLVECT_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB11,CKB12,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58;
schemes NAT_1,FUNCT_2;
registrations XBOOLE_0,FUNCT_1,FINSET_1,STRUCT_0,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,FINSEQ_2,SEQM_3,MATRIX13,XREAL_0,VECTSP_9,RANKNULL,POLYNOM3,POLYNOM5,MONOID_0,CARD_1,RELSET_1,MOD_2,GRCAT_1,PRVECT_1,MATRLIN2,CKB10,CKB13,CKB31;
constructors FINSOP_1,XXREAL_0,GROUP_4,VECTSP_7,VECTSP_9,MATRIX13,REALSET1,LAPLACE,VECTSP_5,RANKNULL,MONOID_0,POLYNOM1,POLYNOM4,POLYNOM5,SEQ_1,MATRLIN2,BINOP_2,NAT_D,RELSET_1,GRCAT_1,MEASURE6,CKB11,CKB14,CKB15,CKB25,CKB33;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve K for Field;
reserve V1 for (VectSp of K);
reserve V2 for (VectSp of K);
reserve f for (linear-transformation of V1,V1);
reserve L for (Scalar of K);
reserve S for 1-sorted;
reserve F for (Function of S,S);
theorem
Th41: (for A being (Subset of V1) holds (for L being (Linear_Combination of V2) holds (for f being (linear-transformation of V1,V2) holds (( Carrier L ) c= ( f .: A ) implies (ex M being (Linear_Combination of A) st ( f . ( Sum M ) ) = ( Sum L ))))))
proof
let A being (Subset of V1);
let L being (Linear_Combination of V2);
let f being (linear-transformation of V1,V2);
assume that
A1: ( Carrier L ) c= ( f .: A );
set C = ( Carrier L );
consider F being (FinSequence of (the carrier of V2)) such that A2: F is  one-to-one and A3: ( rng F ) = ( Carrier L ) and A4: ( Sum L ) = ( Sum ( L (#) F ) ) by VECTSP_6:def 6;
defpred P[ set,set ]
 means
($2 in A & ( f . $2 ) = ( F . $1 ));
set D = ( dom F );
A5: (for x holds (x in D implies (ex y st (y in (the carrier of V1) & P[ x,y ]))))
proof
let x;
assume x in D;
then ( F . x ) in ( rng F ) by FUNCT_1:def 3;
then consider y such that y in ( dom f ) and A6: (y in A & ( f . y ) = ( F . x )) by A1,A3,FUNCT_1:def 6;
take y;
thus thesis by A6;
end;
consider p being (Function of D,(the carrier of V1)) such that A7: (for x holds (x in D implies P[ x,( p . x ) ])) from FUNCT_2:sch 1(A5);
A8: ( rng p ) c= (the carrier of V1) by RELAT_1:def 19;
A9: ( dom p ) = D by FUNCT_2:def 1;
D = ( Seg ( len F ) ) by FINSEQ_1:def 3;
then reconsider p as FinSequence by A9,FINSEQ_1:def 2;
reconsider p as (FinSequence of V1) by A8,FINSEQ_1:def 4;
A10:now
let x1 being set;
let x2 being set;
assume that
A11: (x1 in ( dom p ) & x2 in ( dom p ))
and
A12: ( p . x1 ) = ( p . x2 );
(( f . ( p . x1 ) ) = ( F . x1 ) & ( f . ( p . x2 ) ) = ( F . x2 )) by A7,A9,A11;
hence x1 = x2 by A2,A9,A11,A12,FUNCT_1:def 4;
end;
then A13: p is  one-to-one by FUNCT_1:def 4;
reconsider RNG = ( rng p ) as  finite (Subset of V1) by RELAT_1:def 19;
defpred Q[ set,set ]
 means
(($1 in ( rng p ) implies (for x holds ((x in D & ( p . x ) = $1) implies $2 = ( L . ( F . x ) )))) & ((not $1 in ( rng p )) implies $2 = ( 0. K )));
A14: (for x holds (x in (the carrier of V1) implies (ex y st (y in (the carrier of K) & Q[ x,y ]))))
proof
let x;
assume x in (the carrier of V1);
then reconsider v1 = x as (Vector of V1);
per cases ;
suppose A15: (not v1 in ( rng p ));

take ( 0. K );
thus thesis by A15;
end;
suppose A16: v1 in ( rng p );

then consider y such that A17: (y in ( dom p ) & ( p . y ) = v1) by FUNCT_1:def 3;
take ( L . ( F . y ) );
( L . ( F /. y ) ) in (the carrier of K);
hence thesis by A9,A10,A16,A17,PARTFUN1:def 6;
end;
end;
consider M being (Function of V1,K) such that A18: (for x holds (x in (the carrier of V1) implies Q[ x,( M . x ) ])) from FUNCT_2:sch 1(A14);
reconsider M as (Element of ( Funcs ((the carrier of V1),(the carrier of K)) )) by FUNCT_2:8;
(for v1 being (Element of V1) holds ((not v1 in RNG) implies ( M . v1 ) = ( 0. K ))) by A18;
then reconsider M as (Linear_Combination of V1) by VECTSP_6:def 1;
A19: ( Carrier M ) = RNG
proof
thus ( Carrier M ) c= RNG
proof
let x;
assume that
A20: x in ( Carrier M );
reconsider v1 = x as (Vector of V1) by A20;
( M . v1 ) <> ( 0. K ) by A20,VECTSP_6:2;
hence thesis by A18;
end;

let y;
assume that
A21: y in RNG;
reconsider v1 = y as (Vector of V1) by A21;
consider x such that A22: x in D and A23: ( p . x ) = v1 by A9,A21,FUNCT_1:def 3;
( F . x ) in C by A3,A22,FUNCT_1:def 3;
then A24: ( L . ( F . x ) ) <> ( 0. K ) by VECTSP_6:2;
( M . v1 ) = ( L . ( F . x ) ) by A18,A21,A22,A23;
hence thesis by A24;
end;
RNG c= A
proof
let y;
assume y in RNG;
then (ex x st (x in D & ( p . x ) = y)) by A9,FUNCT_1:def 3;
hence thesis by A7;
end;
then reconsider M as (Linear_Combination of A) by A19,VECTSP_6:def 4;
( len ( M (#) p ) ) = ( len p ) by VECTSP_6:def 5;
then A25: ( dom ( M (#) p ) ) = D by A9,FINSEQ_3:29;
( len ( L (#) F ) ) = ( len F ) by VECTSP_6:def 5;
then A26: ( dom ( L (#) F ) ) = D by FINSEQ_3:29;
A27:now
let x;
assume that
A28: x in D;
reconsider i = x as (Element of ( NAT )) by A28;
A29: ( F . i ) = ( F /. i ) by A28,PARTFUN1:def 6;
( p . i ) in RNG by A9,A28,FUNCT_1:def 3;
then A30: ( M . ( p . i ) ) = ( L . ( F . i ) ) by A18,A28;
A31: (( p /. i ) = ( p . i ) & ( f . ( p . i ) ) = ( F . i )) by A7,A9,A28,PARTFUN1:def 6;
thus ( ( f * ( M (#) p ) ) . x ) = ( f . ( ( M (#) p ) . i ) ) by A25,A28,FUNCT_1:13
.= ( f . ( ( M . ( p /. i ) ) * ( p /. i ) ) ) by A25,A28,VECTSP_6:def 5
.= ( ( L . ( F /. i ) ) * ( F /. i ) ) by A31,A29,A30,MOD_2:def 2
.= ( ( L (#) F ) . x ) by A26,A28,VECTSP_6:def 5;
end;
take M;
(( dom f ) = ( [#] V1 ) & ( rng ( M (#) p ) ) c= ( [#] V1 )) by FUNCT_2:def 1,RELAT_1:def 19;
then ( dom ( f * ( M (#) p ) ) ) = ( dom ( M (#) p ) ) by RELAT_1:27;
then ( f * ( M (#) p ) ) = ( L (#) F ) by A26,A25,A27,FUNCT_1:2;
hence ( Sum L ) = ( f . ( Sum ( M (#) p ) ) ) by A4,MATRLIN:16
.= ( f . ( Sum M ) ) by A13,A19,VECTSP_6:def 6;
end;
