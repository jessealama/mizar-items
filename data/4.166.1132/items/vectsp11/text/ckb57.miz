environ
vocabularies NUMBERS,NAT_1,VECTSP_1,SUBSET_1,MATRIX_1,FINSEQ_2,ZFMISC_1,RELAT_1,TARSKI,CARD_1,ARYTM_3,FUNCT_1,FREEALG,FINSET_1,FINSEQ_1,MESFUNC1,GROUP_1,SUPINF_2,LAPLACE,XBOOLE_0,MATRIX_2,ARYTM_1,XXREAL_0,POLYNOM1,POLYNOM2,MATRIX_3,CARD_3,AFINSQ_1,ORDINAL4,POLYNOM3,STRUCT_0,PARTFUN1,RANKNULL,RLSUB_1,RLVECT_5,PRVECT_1,RLVECT_3,ALGSTR_0,VECTSP10,MATRLIN,MATRLIN2,POLYNOM5,NEWTON,MONOID_0,BINOP_1,RLVECT_1,LATTICES,RLSUB_2,FINSEQ_4,MCART_1,RLVECT_2,VALUED_1,FUNCT_2,VECTSP11,MSSUBFAM,UNIALG_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,CARD_1,XCMPLX_0,ALGSTR_0,XXREAL_0,NAT_1,FINSET_1,RELAT_1,FUNCT_1,PARTFUN1,FUNCT_2,FINSEQ_1,BINOP_1,STRUCT_0,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_2,MATRIX_1,MATRIX_2,NAT_D,GROUP_4,MATRIX_3,DOMAIN_1,MEASURE6,PRVECT_1,VECTSP_4,VECTSP_5,VECTSP_6,VECTSP_7,VECTSP_9,FINSEQOP,MATRIX13,MATRLIN,LAPLACE,MOD_2,RANKNULL,POLYNOM3,MONOID_0,ALGSEQ_1,POLYNOM4,POLYNOM5,MATRLIN2,GRCAT_1,CKB11,CKB14,CKB15,CKB25,CKB33;
definitions STRUCT_0,TARSKI,XBOOLE_0,RLVECT_1,FINSEQ_1,VECTSP_4,FVSUM_1,LAPLACE,MATRIX13,RANKNULL,VECTSP_6,MATRLIN2,CKB11,CKB14,CKB15,CKB25,CKB33;
theorems ZFMISC_1,RLVECT_1,MATRIX_1,MATRIX_3,VECTSP_1,NAT_1,FINSEQ_1,FINSEQ_3,FINSEQ_2,CARD_1,CARD_2,FINSEQOP,FINSOP_1,FUNCT_1,FUNCT_2,FVSUM_1,GROUP_1,LAPLACE,MATRIX13,MATRIXR2,MATRLIN,ORDINAL1,PARTFUN1,RELAT_1,STIRL2_1,STRUCT_0,TARSKI,VECTSP_4,VECTSP_5,VECTSP_6,VECTSP_7,VECTSP_9,VECTSP10,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,MOD_2,RANKNULL,MONOID_0,GROUP_4,SYSREL,SUBSET_1,FINSEQ_5,ALGSEQ_1,POLYNOM4,POLYNOM5,HILBASIS,MATRIXJ1,MATRLIN2,VALUED_0,NAT_D,GRCAT_1,RLVECT_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB11,CKB12,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56;
schemes NAT_1,FUNCT_2;
registrations XBOOLE_0,FUNCT_1,FINSET_1,STRUCT_0,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,FINSEQ_2,SEQM_3,MATRIX13,XREAL_0,VECTSP_9,RANKNULL,POLYNOM3,POLYNOM5,MONOID_0,CARD_1,RELSET_1,MOD_2,GRCAT_1,PRVECT_1,MATRLIN2,CKB10,CKB13,CKB31;
constructors FINSOP_1,XXREAL_0,GROUP_4,VECTSP_7,VECTSP_9,MATRIX13,REALSET1,LAPLACE,VECTSP_5,RANKNULL,MONOID_0,POLYNOM1,POLYNOM4,POLYNOM5,SEQ_1,MATRLIN2,BINOP_2,NAT_D,RELSET_1,GRCAT_1,MEASURE6,CKB11,CKB14,CKB15,CKB25,CKB33;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve i for Nat;
reserve m for Nat;
reserve n for Nat;
reserve x for set;
reserve K for Field;
reserve V1 for (VectSp of K);
reserve f for (linear-transformation of V1,V1);
theorem
(for L1,L2 being (Scalar of K) holds (((f is  with_eigenvalues & L1 <> L2) & L2 is (eigenvalue of f)) implies (for I being (Linear_Compl of ( UnionKers ( f + ( ( - L1 ) * ( id V1 ) ) ) )) holds (for fI being (linear-transformation of I,I) holds (fI = ( f | I ) implies (((fI is  with_eigenvalues & (not L1 is (eigenvalue of fI))) & L2 is (eigenvalue of fI)) & ( UnionKers ( f + ( ( - L2 ) * ( id V1 ) ) ) ) is (Subspace of I)))))))
proof
let L1 being (Scalar of K),L2 being (Scalar of K);
assume that
A1: f is  with_eigenvalues
and
A2: L1 <> L2
and
A3: L2 is (eigenvalue of f);
set V = V1;
consider v being (Vector of V) such that A4: v <> ( 0. V ) and A5: ( f . v ) = ( L2 * v ) by A1,A3,CKB14:def 1;
set f1 = ( f + ( ( - L1 ) * ( id V ) ) );
set U = ( UnionKers f1 );
reconsider fU = ( f | U ) as (linear-transformation of U,U) by CKB41:1;
set f2 = ( f + ( ( - L2 ) * ( id V ) ) );
let I being (Linear_Compl of U);
let fI being (linear-transformation of I,I);
assume that
A6: fI = ( f | I );
A7:now
let v being (Vector of V);
assume v in ( UnionKers f2 );
then consider m such that A8: ( ( f2 |^ m ) . v ) = ( 0. V ) by CKB34:1;
set v1 = ( v |-- (I,U) );
set i1 = ( v1 `1 );
set u1 = ( v1 `2 );
A9: V is_the_direct_sum_of I,U by VECTSP_5:def 5;
then A10: v = ( i1 + u1 ) by VECTSP_5:def 6;
defpred P[ Nat ]
 means
( ( f2 |^ $1 ) . u1 ) = ( 0. V );
defpred Q[ Nat ]
 means
(for W being (Subspace of V) holds ((W = I or W = U) implies (for w being (Vector of V) holds (w in W implies ( ( f2 |^ $1 ) . w ) in W))));
set L21 = ( L2 - L1 );
set f21 = ( f2 + ( L21 * ( id V ) ) );
A11: (( 0. V ) in I & ( 0. V ) in U) by VECTSP_4:17;
A12: (for n holds (Q[ n ] implies Q[ ( n + 1 ) ]))
proof
let n;
assume that
A13: Q[ n ];
let W being (Subspace of V);
assume that
A14: (W = I or W = U);
let w being (Vector of V);
assume that
A15: w in W;
set fnw = ( ( f2 |^ n ) . w );
A16: fnw in W by A13,A14,A15;
A17:now
per cases  by A14;
suppose A18: W = I;

then reconsider F = fnw as (Vector of I) by A16,STRUCT_0:def 5;
( f . fnw ) = ( fI . F ) by A6,FUNCT_1:49;
hence ( f . fnw ) in W by A18,STRUCT_0:def 5;
end;
suppose A19: W = U;

then reconsider F = fnw as (Vector of U) by A16,STRUCT_0:def 5;
( f . fnw ) = ( fU . F ) by FUNCT_1:49;
hence ( f . fnw ) in W by A19,STRUCT_0:def 5;
end;
end;
( ( ( - L2 ) * ( id V ) ) . fnw ) = ( ( - L2 ) * ( ( id V ) . fnw ) ) by MATRLIN:def 4
.= ( ( - L2 ) * fnw ) by FUNCT_1:18;
then A20: ( ( ( - L2 ) * ( id V ) ) . fnw ) in W by A16,VECTSP_4:21;
A21: ( dom ( f2 |^ n ) ) = ( [#] V ) by FUNCT_2:def 1;
( ( f2 |^ ( n + 1 ) ) . w ) = ( ( ( f2 |^ 1 ) * ( f2 |^ n ) ) . w ) by CKB28:1
.= ( ( f2 |^ 1 ) . fnw ) by A21,FUNCT_1:13
.= ( ( f + ( ( - L2 ) * ( id V ) ) ) . fnw ) by CKB27:1
.= ( ( f . fnw ) + ( ( ( - L2 ) * ( id V ) ) . fnw ) ) by MATRLIN:def 3;
hence thesis by A17,A20,VECTSP_4:20;
end;
A22: ( ( 0. V ) + ( 0. V ) ) = ( 0. V ) by RLVECT_1:def 4
.= ( ( ( f2 |^ m ) . i1 ) + ( ( f2 |^ m ) . u1 ) ) by A10,A8,GRCAT_1:def 8;
A23: u1 in U by A9,VECTSP_5:def 6;
then consider n such that A24: ( ( f1 |^ n ) . u1 ) = ( 0. V ) by CKB34:1;
A25: Q[ ( 0 ) ]
proof
let W being (Subspace of V);
assume that
(W = I or W = U);
let w being (Vector of V);
assume that
A26: w in W;
( ( f2 |^ ( 0 ) ) . w ) = ( ( id V ) . w ) by CKB26:1
.= w by FUNCT_1:18;
hence thesis by A26;
end;
A27: (for n holds Q[ n ]) from NAT_1:sch 2(A25,A12);
then A28: ( ( f2 |^ m ) . u1 ) in U by A23;
A29: i1 in I by A9,VECTSP_5:def 6;
then ( ( f2 |^ m ) . i1 ) in I by A27;
then ( ( f2 |^ m ) . u1 ) = ( 0. V ) by A9,A28,A11,A22,VECTSP_5:48;
then A30: (ex m st P[ m ]);
consider MIN being Nat such that A31: P[ MIN ] and A32: (for n holds (P[ n ] implies MIN <= n)) from NAT_1:sch 5(A30);
assume A33: (not v is (Vector of I));
A34: u1 <> ( 0. V )
proof
assume u1 = ( 0. V );
then v = i1 by A10,RLVECT_1:def 4;
hence thesis by A29,A33,STRUCT_0:def 5;
end;
n <> ( 0 )
proof
assume n = ( 0 );
then ( 0. V ) = ( ( id V ) . u1 ) by A24,CKB26:1
.= u1 by FUNCT_1:18;
hence thesis by A34;
end;
then consider h being (linear-transformation of V,V) such that A35: ( f21 |^ n ) = ( ( f2 * h ) + ( ( L21 * ( id V ) ) |^ n ) ) and A36: (for i holds ( ( f2 |^ i ) * h ) = ( h * ( f2 |^ i ) )) by CKB56:1,NAT_1:14;
A37: ( dom ( f21 |^ n ) ) = ( [#] V ) by FUNCT_2:def 1;
MIN <> ( 0 )
proof
assume MIN = ( 0 );
then ( 0. V ) = ( ( id V ) . u1 ) by A31,CKB26:1
.= u1 by FUNCT_1:18;
hence thesis by A34;
end;
then reconsider M1 = ( MIN - 1 ) as (Element of ( NAT )) by NAT_1:20;
A38: ( ( f2 |^ M1 ) * ( f2 * h ) ) = ( ( ( f2 |^ M1 ) * f2 ) * h ) by RELAT_1:36
.= ( ( ( f2 |^ M1 ) * ( f2 |^ 1 ) ) * h ) by CKB27:1
.= ( ( f2 |^ ( M1 + 1 ) ) * h ) by CKB28:1
.= ( h * ( f2 |^ MIN ) ) by A36;
( dom ( ( L21 * ( id V ) ) |^ n ) ) = ( [#] V ) by FUNCT_2:def 1;
then A39: ( ( ( f2 |^ M1 ) * ( ( L21 * ( id V ) ) |^ n ) ) . u1 ) = ( ( f2 |^ M1 ) . ( ( ( L21 * ( id V ) ) |^ n ) . u1 ) ) by FUNCT_1:13
.= ( ( f2 |^ M1 ) . ( ( ( ( power K ) . (L21,n) ) * ( id V ) ) . u1 ) ) by CKB54:1
.= ( ( f2 |^ M1 ) . ( ( ( power K ) . (L21,n) ) * ( ( id V ) . u1 ) ) ) by MATRLIN:def 4
.= ( ( f2 |^ M1 ) . ( ( ( power K ) . (L21,n) ) * u1 ) ) by FUNCT_1:18
.= ( ( ( power K ) . (L21,n) ) * ( ( f2 |^ M1 ) . u1 ) ) by MOD_2:def 2;
A40: ( ( power K ) . (L21,n) ) <> ( 0. K )
proof
assume ( 0. K ) = ( ( power K ) . (L21,n) );
then ( 0. K ) = ( Product ( n |-> L21 ) ) by MATRIXJ1:5;
then A41: (ex k being (Element of ( NAT )) st (k in ( dom ( n |-> L21 ) ) & ( ( n |-> L21 ) . k ) = ( 0. K ))) by FVSUM_1:82;
( dom ( n |-> L21 ) ) = ( Seg n ) by FINSEQ_2:124;
then L21 = ( 0. K ) by A41,FINSEQ_2:57;
hence thesis by A2,VECTSP_1:19;
end;
( dom ( f2 |^ MIN ) ) = ( [#] V ) by FUNCT_2:def 1;
then A42: ( ( h * ( f2 |^ MIN ) ) . u1 ) = ( h . ( ( f2 |^ MIN ) . u1 ) ) by FUNCT_1:13
.= ( 0. V ) by A31,RANKNULL:9;
f21 = ( f + ( ( ( - L2 ) * ( id V ) ) + ( L21 * ( id V ) ) ) ) by CKB53:1
.= ( f + ( ( ( - L2 ) + L21 ) * ( id V ) ) ) by CKB55:1
.= ( f + ( ( ( ( - L2 ) + L2 ) - L1 ) * ( id V ) ) ) by RLVECT_1:def 3
.= ( f + ( ( ( 0. K ) + ( - L1 ) ) * ( id V ) ) ) by VECTSP_1:19
.= f1 by RLVECT_1:def 4;
then ( 0. V ) = ( ( f2 |^ M1 ) . ( ( f21 |^ n ) . u1 ) ) by A24,RANKNULL:9
.= ( ( ( f2 |^ M1 ) * ( ( f2 * h ) + ( ( L21 * ( id V ) ) |^ n ) ) ) . u1 ) by A35,A37,FUNCT_1:13
.= ( ( ( h * ( f2 |^ MIN ) ) + ( ( f2 |^ M1 ) * ( ( L21 * ( id V ) ) |^ n ) ) ) . u1 ) by A38,CKB52:1
.= ( ( 0. V ) + ( ( ( power K ) . (L21,n) ) * ( ( f2 |^ M1 ) . u1 ) ) ) by A42,A39,MATRLIN:def 3
.= ( ( ( power K ) . (L21,n) ) * ( ( f2 |^ M1 ) . u1 ) ) by RLVECT_1:def 4;
then ( ( f2 |^ M1 ) . u1 ) = ( 0. V ) by A40,VECTSP_1:15;
then ( M1 + 1 ) <= M1 by A32;
hence contradiction by NAT_1:13;
end;
v is (eigenvector of f,L2) by A1,A3,A5,CKB15:def 1;
then v in ( ker f2 ) by A1,A3,CKB24:1;
then ( 0. V ) = ( f2 . v ) by RANKNULL:10
.= ( ( f2 |^ 1 ) . v ) by CKB27:1;
then v in ( UnionKers f2 ) by CKB34:1;
then reconsider vI = v as (Vector of I) by A7;
A43: (( 0. V ) = ( 0. I ) & ( L2 * v ) = ( L2 * vI )) by VECTSP_4:11,VECTSP_4:14;
A44: ( f . v ) = ( fI . vI ) by A6,FUNCT_1:49;
hence A45: fI is  with_eigenvalues by A4,A5,A43,CKB11:def 1;
(not L1 is (eigenvalue of fI))
proof
assume L1 is (eigenvalue of fI);
then consider w being (Vector of I) such that A46: w <> ( 0. I ) and A47: ( fI . w ) = ( L1 * w ) by A45,CKB14:def 1;
w = ( 0. V ) by A6,A47,CKB47:1;
hence thesis by A46,VECTSP_4:11;
end;
hence ((not L1 is (eigenvalue of fI)) & L2 is (eigenvalue of fI)) by A4,A5,A43,A44,A45,CKB14:def 1;
(the carrier of ( UnionKers f2 )) c= (the carrier of I)
proof
let x;
assume x in (the carrier of ( UnionKers f2 ));
then A48: x in ( UnionKers f2 ) by STRUCT_0:def 5;
then x in V by VECTSP_4:9;
then reconsider v = x as (Vector of V) by STRUCT_0:def 5;
v is (Vector of I) by A7,A48;
hence thesis;
end;
hence thesis by VECTSP_4:27;
end;
