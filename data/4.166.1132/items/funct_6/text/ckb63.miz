environ
vocabularies FUNCT_1,SUBSET_1,NUMBERS,FUNCT_2,XBOOLE_0,CARD_3,FINSEQ_1,RELAT_1,FINSEQ_2,FUNCOP_1,TARSKI,ZFMISC_1,FUNCT_5,PARTFUN1,SETFAM_1,FINSEQ_4,MCART_1,FUNCT_6,ORDINAL1;
notations TARSKI,XBOOLE_0,ENUMSET1,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,MCART_1,SETFAM_1,FUNCT_2,BINOP_1,PARTFUN1,FUNCT_3,WELLORD2,FUNCOP_1,FUNCT_4,FUNCT_5,ORDINAL1,CARD_3,CKB18,CKB24,CKB25,CKB26,CKB33,CKB35,CKB43,CKB56,CKB62;
definitions TARSKI,FUNCT_1,WELLORD2,XBOOLE_0,BINOP_1,FUNCOP_1,CKB18,CKB24,CKB25,CKB26,CKB33,CKB35,CKB43,CKB56,CKB62;
theorems TARSKI,ENUMSET1,ZFMISC_1,MCART_1,FUNCT_1,SETFAM_1,FUNCT_2,FUNCT_3,FUNCOP_1,CARD_1,CARD_3,FUNCT_4,FUNCT_5,PARTFUN1,WELLORD2,RELAT_1,XBOOLE_0,XBOOLE_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62;
schemes FUNCT_1,PARTFUN1,CARD_3,CLASSES1,XBOOLE_0;
registrations XBOOLE_0,RELAT_1,FUNCT_1,FUNCT_2,FUNCOP_1,ORDINAL1,RELSET_1;
constructors ENUMSET1,SETFAM_1,PARTFUN1,WELLORD2,BINOP_1,FUNCT_3,FUNCOP_1,FUNCT_4,FUNCT_5,CARD_3,RELSET_1,CKB18,CKB24,CKB25,CKB26,CKB33,CKB35,CKB43,CKB56,CKB62;
requirements NUMERALS,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve z for set;
reserve a for set;
reserve b for set;
reserve X for set;
reserve f for Function;
reserve g for Function;
reserve h for Function;
theorem
Lm5: ((f <> ( {} ) & X <> ( {} )) implies ( product ( Funcs (X,f) ) ),( Funcs (X,( product f )) ) are_equipotent )
proof
defpred P[ set,set ]
 means
(ex g st ($1 = g & $2 = <: g :>));
assume that
A1: f <> ( {} )
and
A2: X <> ( {} );
A3: (for x holds (x in ( product ( Funcs (X,f) ) ) implies (ex y st P[ x,y ])))
proof
let x;
assume x in ( product ( Funcs (X,f) ) );
then (ex g st ((x = g & ( dom g ) = ( dom ( Funcs (X,f) ) )) & (for x holds (x in ( dom ( Funcs (X,f) ) ) implies ( g . x ) in ( ( Funcs (X,f) ) . x ))))) by CARD_3:def 5;
then reconsider g = x as Function;
reconsider y = <: g :> as set;
take y;
take g;
thus thesis;
end;
consider F being Function such that A4: (( dom F ) = ( product ( Funcs (X,f) ) ) & (for x holds (x in ( product ( Funcs (X,f) ) ) implies P[ x,( F . x ) ]))) from CLASSES1:sch 1(A3);
take F;
A5: (g in ( product ( Funcs (X,f) ) ) implies ((( dom <: g :> ) = X & ( SubFuncs ( rng g ) ) = ( rng g )) & ( rng <: g :> ) c= ( product f )))
proof
A6: ( g " ( rng g ) ) = ( dom g ) by RELAT_1:134;
A7: ( dom ( Funcs (X,f) ) ) = ( dom f ) by CKB62:def 1;
assume A8: g in ( product ( Funcs (X,f) ) );
then A9: ( dom g ) = ( dom ( Funcs (X,f) ) ) by CARD_3:9;
A10:now
let a being set;
assume a in ( rng g );
then consider z such that A11: z in ( dom g ) and A12: a = ( g . z ) by FUNCT_1:def 3;
(( g . z ) in ( ( Funcs (X,f) ) . z ) & ( ( Funcs (X,f) ) . z ) = ( Funcs (X,( f . z )) )) by A8,A9,A7,A11,CKB62:def 1,CARD_3:9;
hence a is Function by A12;
end;
then A13: ( SubFuncs ( rng g ) ) = ( rng g ) by CKB21:1;
A14:now
let z;
assume A15: z in ( dom f );
then (( g . z ) in ( ( Funcs (X,f) ) . z ) & ( ( Funcs (X,f) ) . z ) = ( Funcs (X,( f . z )) )) by A8,A7,CKB62:def 1,CARD_3:9;
then (ex h st ((( g . z ) = h & ( dom h ) = X) & ( rng h ) c= ( f . z ))) by FUNCT_2:def 2;
hence ( ( ( dom f ) --> X ) . z ) = ( proj1 ( g . z ) ) by A15,FUNCOP_1:7;
end;
( dom ( ( dom f ) --> X ) ) = ( dom f ) by FUNCOP_1:13;
then ( doms g ) = ( ( dom f ) --> X ) by A9,A7,A13,A6,A14,CKB24:def 1;
then ( meet ( doms g ) ) = X by A1,CKB32:1;
hence A16: (( dom <: g :> ) = X & ( SubFuncs ( rng g ) ) = ( rng g )) by A10,CKB21:1,CKB36:1;
let y;
assume y in ( rng <: g :> );
then consider x such that A17: x in ( dom <: g :> ) and A18: y = ( <: g :> . x ) by FUNCT_1:def 3;
reconsider h = y as Function by A17,A18,CKB37:1;
A19: ( dom h ) = ( dom f ) by A9,A7,A13,A6,A17,A18,CKB38:1;
now
let z;
assume A20: z in ( dom f );
then A21: ( ( uncurry g ) . (z,x) ) = ( h . z ) by A17,A18,A19,CKB38:1;
(( g . z ) in ( ( Funcs (X,f) ) . z ) & ( ( Funcs (X,f) ) . z ) = ( Funcs (X,( f . z )) )) by A8,A7,A20,CKB62:def 1,CARD_3:9;
then consider j being Function such that A22: ( g . z ) = j and A23: ( dom j ) = X and A24: ( rng j ) c= ( f . z ) by FUNCT_2:def 2;
A25: ( j . x ) in ( rng j ) by A16,A17,A23,FUNCT_1:def 3;
( ( uncurry g ) . (z,x) ) = ( j . x ) by A9,A7,A16,A17,A20,A22,A23,FUNCT_5:38;
hence ( h . z ) in ( f . z ) by A24,A21,A25;
end;
hence thesis by A19,CARD_3:def 5;
end;
thus F is  one-to-one
proof
let x;
let y;
assume that
A26: x in ( dom F )
and
A27: y in ( dom F )
and
A28: ( F . x ) = ( F . y )
and
A29: x <> y;
consider gy being Function such that A30: y = gy and A31: ( F . y ) = <: gy :> by A4,A27;
consider gx being Function such that A32: x = gx and A33: ( F . x ) = <: gx :> by A4,A26;
A34: ( dom gx ) = ( dom ( Funcs (X,f) ) ) by A4,A26,A32,CARD_3:9;
A35: ( dom ( Funcs (X,f) ) ) = ( dom f ) by CKB62:def 1;
A36: ( dom gy ) = ( dom ( Funcs (X,f) ) ) by A4,A27,A30,CARD_3:9;
now
let z;
assume A37: z in ( dom f );
then A38: ( ( Funcs (X,f) ) . z ) = ( Funcs (X,( f . z )) ) by CKB62:def 1;
( gy . z ) in ( ( Funcs (X,f) ) . z ) by A4,A27,A30,A35,A37,CARD_3:9;
then consider hy being Function such that A39: (( gy . z ) = hy & ( dom hy ) = X) and ( rng hy ) c= ( f . z ) by A38,FUNCT_2:def 2;
( gx . z ) in ( ( Funcs (X,f) ) . z ) by A4,A26,A32,A35,A37,CARD_3:9;
then consider hx being Function such that A40: (( gx . z ) = hx & ( dom hx ) = X) and ( rng hx ) c= ( f . z ) by A38,FUNCT_2:def 2;
A41: ( dom <: gx :> ) = X by A4,A5,A26,A32;
A42: (( SubFuncs ( rng gx ) ) = ( rng gx ) & ( gx " ( rng gx ) ) = ( dom gx )) by A4,A5,A26,A32,RELAT_1:134;
now
let b being set;
assume A43: b in X;
then reconsider fx = ( <: gx :> . b ) as Function by A41,CKB37:1;
A44: (( ( uncurry gx ) . (z,b) ) = ( hx . b ) & ( ( uncurry gy ) . (z,b) ) = ( hy . b )) by A34,A36,A35,A37,A40,A39,A43,FUNCT_5:38;
A45: ( dom fx ) = ( dom gx ) by A41,A42,A43,CKB38:1;
then ( fx . z ) = ( ( uncurry gx ) . (z,b) ) by A34,A35,A37,A41,A43,CKB38:1;
hence ( hx . b ) = ( hy . b ) by A28,A33,A31,A34,A35,A37,A41,A43,A45,A44,CKB38:1;
end;
hence ( gx . z ) = ( gy . z ) by A40,A39,FUNCT_1:2;
end;
hence thesis by A29,A32,A30,A34,A36,A35,FUNCT_1:2;
end;

thus ( dom F ) = ( product ( Funcs (X,f) ) ) by A4;
thus ( rng F ) c= ( Funcs (X,( product f )) )
proof
let y;
assume y in ( rng F );
then consider x such that A46: x in ( dom F ) and A47: y = ( F . x ) by FUNCT_1:def 3;
consider g such that A48: x = g and A49: y = <: g :> by A4,A46,A47;
(( dom <: g :> ) = X & ( rng <: g :> ) c= ( product f )) by A4,A5,A46,A48;
hence thesis by A49,FUNCT_2:def 2;
end;

let y;
assume y in ( Funcs (X,( product f )) );
then consider h such that A50: y = h and A51: ( dom h ) = X and A52: ( rng h ) c= ( product f ) by FUNCT_2:def 2;
set g = <: h :>;
A53: ( h " ( rng h ) ) = ( dom h ) by RELAT_1:134;
A54:now
let z;
assume A55: z in X;
then ( h . z ) in ( rng h ) by A51,FUNCT_1:def 3;
then A56: (ex j being Function st ((( h . z ) = j & ( dom j ) = ( dom f )) & (for x holds (x in ( dom f ) implies ( j . x ) in ( f . x ))))) by A52,CARD_3:def 5;
thus ( ( X --> ( dom f ) ) . z ) = ( dom f ) by A55,FUNCOP_1:7
.= ( ( doms h ) . z ) by A51,A55,A56,CKB27:1;
end;
A57: ( meet ( doms h ) ) = ( dom g ) by CKB36:1;
now
let z;
assume z in ( rng h );
then (ex j being Function st ((z = j & ( dom j ) = ( dom f )) & (for x holds (x in ( dom f ) implies ( j . x ) in ( f . x ))))) by A52,CARD_3:def 5;
hence z is Function;
end;
then A58: ( SubFuncs ( rng h ) ) = ( rng h ) by CKB21:1;
(( dom ( doms h ) ) = ( h " ( SubFuncs ( rng h ) ) ) & ( dom ( ( dom h ) --> ( dom f ) ) ) = ( dom h )) by CKB24:def 1,FUNCOP_1:13;
then ( X --> ( dom f ) ) = ( doms h ) by A51,A58,A53,A54,FUNCT_1:2;
then A59: ( dom g ) = ( dom f ) by A2,A57,CKB32:1;
A60:now
let z;
assume A61: z in ( dom f );
then reconsider i = ( g . z ) as Function by A59,CKB37:1;
A62: ( dom i ) = X by A51,A58,A53,A59,A61,CKB38:1;
( rng i ) c= ( f . z )
proof
let x;
assume x in ( rng i );
then consider a being set such that A63: a in ( dom i ) and A64: x = ( i . a ) by FUNCT_1:def 3;
( h . a ) in ( rng h ) by A51,A62,A63,FUNCT_1:def 3;
then consider j being Function such that A65: (( h . a ) = j & ( dom j ) = ( dom f )) and A66: (for x holds (x in ( dom f ) implies ( j . x ) in ( f . x ))) by A52,CARD_3:def 5;
( i . a ) = ( ( uncurry h ) . (a,z) ) by A59,A61,A63,CKB38:1
.= ( j . z ) by A51,A61,A62,A63,A65,FUNCT_5:38;
hence thesis by A61,A64,A66;
end;
then ( g . z ) in ( Funcs (X,( f . z )) ) by A62,FUNCT_2:def 2;
hence ( g . z ) in ( ( Funcs (X,f) ) . z ) by A61,CKB62:def 1;
end;
A67: ( meet ( doms g ) ) = ( dom <: g :> ) by CKB36:1;
( product f ) c= ( Funcs (( dom f ),( Union f )) ) by CKB1:1;
then A68: ( rng h ) c= ( Funcs (( dom f ),( Union f )) ) by A52,XBOOLE_1:1;
then A69: ( dom ( uncurry h ) ) = [: ( dom h ),( dom f ) :] by FUNCT_5:26;
( dom f ) = ( dom ( Funcs (X,f) ) ) by CKB62:def 1;
then A70: g in ( product ( Funcs (X,f) ) ) by A59,A60,CARD_3:def 5;
then A71: (ex g9 being Function st (g = g9 & ( F . g ) = <: g9 :>)) by A4;
( dom ( uncurry' h ) ) = [: ( dom f ),( dom h ) :] by A68,FUNCT_5:26;
then A72: ( ( uncurry' h ) | ([: ( meet ( doms h ) ),( dom h ) :] qua set) ) = ( uncurry' h ) by A57,A59,RELAT_1:68;
A73: (( uncurry' h ) = ( ~ ( uncurry h ) ) & ( curry ( ~ ( uncurry h ) ) ) = ( curry' ( uncurry h ) )) by FUNCT_5:def 3,FUNCT_5:def 4;
( dom <: g :> ) = X by A5,A70;
then A74: ( ( uncurry h ) | ([: ( meet ( doms g ) ),( dom g ) :] qua set) ) = ( uncurry h ) by A51,A59,A69,A67,RELAT_1:68;
( uncurry' ( curry' ( uncurry h ) ) ) = ( uncurry h ) by A69,FUNCT_5:49;
then <: g :> = h by A1,A68,A72,A74,A73,FUNCT_5:48;
hence thesis by A4,A50,A70,A71,FUNCT_1:def 3;
end;
