environ
vocabularies FUNCT_1,SUBSET_1,NUMBERS,FUNCT_2,XBOOLE_0,CARD_3,FINSEQ_1,RELAT_1,FINSEQ_2,FUNCOP_1,TARSKI,ZFMISC_1,FUNCT_5,PARTFUN1,SETFAM_1,FINSEQ_4,MCART_1,FUNCT_6,ORDINAL1;
notations TARSKI,XBOOLE_0,ENUMSET1,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,MCART_1,SETFAM_1,FUNCT_2,BINOP_1,PARTFUN1,FUNCT_3,WELLORD2,FUNCOP_1,FUNCT_4,FUNCT_5,ORDINAL1,CARD_3,CKB18,CKB24,CKB25,CKB26,CKB33,CKB35,CKB43,CKB56;
definitions TARSKI,FUNCT_1,WELLORD2,XBOOLE_0,BINOP_1,FUNCOP_1,CKB18,CKB24,CKB25,CKB26,CKB33,CKB35,CKB43,CKB56;
theorems TARSKI,ENUMSET1,ZFMISC_1,MCART_1,FUNCT_1,SETFAM_1,FUNCT_2,FUNCT_3,FUNCOP_1,CARD_1,CARD_3,FUNCT_4,FUNCT_5,PARTFUN1,WELLORD2,RELAT_1,XBOOLE_0,XBOOLE_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60;
schemes FUNCT_1,PARTFUN1,CARD_3,CLASSES1,XBOOLE_0;
registrations XBOOLE_0,RELAT_1,FUNCT_1,FUNCT_2,FUNCOP_1,ORDINAL1,RELSET_1;
constructors ENUMSET1,SETFAM_1,PARTFUN1,WELLORD2,BINOP_1,FUNCT_3,FUNCOP_1,FUNCT_4,FUNCT_5,CARD_3,RELSET_1,CKB18,CKB24,CKB25,CKB26,CKB33,CKB35,CKB43,CKB56;
requirements NUMERALS,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve z for set;
reserve a for set;
reserve b for set;
reserve X for set;
reserve f for Function;
reserve g for Function;
reserve h for Function;
theorem
( Funcs (( Union ( disjoin f ) ),X) ),( product ( Funcs (f,X) ) ) are_equipotent 
proof
defpred P[ set,set ]
 means
(ex g st (ex h st ((($1 = g & $2 = h) & ( dom h ) = ( dom f )) & (for y holds (y in ( dom f ) implies ((( f . y ) = ( {} ) implies ( h . y ) = ( {} )) & (( f . y ) <> ( {} ) implies ( h . y ) = ( ( curry' g ) . y ))))))));
A1: (for x holds (x in ( Funcs (( Union ( disjoin f ) ),X) ) implies (ex z st P[ x,z ])))
proof
defpred P[ set ]
 means
( f . $1 ) = ( {} );
deffunc F(set) = ( {} );
let x;
assume x in ( Funcs (( Union ( disjoin f ) ),X) );
then consider g such that A2: x = g and ( dom g ) = ( Union ( disjoin f ) ) and ( rng g ) c= X by FUNCT_2:def 2;
deffunc G(set) = ( ( curry' g ) . $1 );
(ex h st (( dom h ) = ( dom f ) & (for y holds (y in ( dom f ) implies ((P[ y ] implies ( h . y ) = F(y)) & ((not P[ y ]) implies ( h . y ) = G(y))))))) from PARTFUN1:sch 1;
hence thesis by A2;
end;
consider F being Function such that A3: (( dom F ) = ( Funcs (( Union ( disjoin f ) ),X) ) & (for x holds (x in ( Funcs (( Union ( disjoin f ) ),X) ) implies P[ x,( F . x ) ]))) from CLASSES1:sch 1(A1);
take F;
thus F is  one-to-one
proof
let x;
let y;
assume that
A4: x in ( dom F )
and
A5: y in ( dom F )
and
A6: ( F . x ) = ( F . y );
A7: (ex f2 being Function st ((y = f2 & ( dom f2 ) = ( Union ( disjoin f ) )) & ( rng f2 ) c= X)) by A3,A5,FUNCT_2:def 2;
consider g1,h1 being Function such that A8: x = g1 and A9: ( F . x ) = h1 and ( dom h1 ) = ( dom f ) and A10: (for y holds (y in ( dom f ) implies ((( f . y ) = ( {} ) implies ( h1 . y ) = ( {} )) & (( f . y ) <> ( {} ) implies ( h1 . y ) = ( ( curry' g1 ) . y ))))) by A3,A4;
consider g2,h2 being Function such that A11: y = g2 and A12: ( F . y ) = h2 and ( dom h2 ) = ( dom f ) and A13: (for y holds (y in ( dom f ) implies ((( f . y ) = ( {} ) implies ( h2 . y ) = ( {} )) & (( f . y ) <> ( {} ) implies ( h2 . y ) = ( ( curry' g2 ) . y ))))) by A3,A5;
A14: (ex f1 being Function st ((x = f1 & ( dom f1 ) = ( Union ( disjoin f ) )) & ( rng f1 ) c= X)) by A3,A4,FUNCT_2:def 2;
now
let z;
assume A15: z in ( Union ( disjoin f ) );
then A16: z = [ ( z `1 ),( z `2 ) ] by CARD_3:22;
A17: (( z `2 ) in ( dom f ) & ( z `1 ) in ( f . ( z `2 ) )) by A15,CARD_3:22;
then A18: ( h2 . ( z `2 ) ) = ( ( curry' g2 ) . ( z `2 ) ) by A13;
then reconsider g91 = ( h1 . ( z `2 ) ),g92 = ( h2 . ( z `2 ) ) as Function by A6,A7,A9,A11,A12,A15,A16,FUNCT_5:21;
A19: ( g2 . (( z `1 ),( z `2 )) ) = ( g92 . ( z `1 ) ) by A7,A11,A15,A16,A18,FUNCT_5:22;
( h1 . ( z `2 ) ) = ( ( curry' g1 ) . ( z `2 ) ) by A10,A17;
then ( g1 . (( z `1 ),( z `2 )) ) = ( g91 . ( z `1 ) ) by A14,A8,A15,A16,FUNCT_5:22;
hence ( g1 . z ) = ( g2 . z ) by A6,A9,A12,A16,A19;
end;
hence thesis by A14,A7,A8,A11,FUNCT_1:2;
end;

thus ( dom F ) = ( Funcs (( Union ( disjoin f ) ),X) ) by A3;
thus ( rng F ) c= ( product ( Funcs (f,X) ) )
proof
let y;
assume y in ( rng F );
then consider x such that A20: x in ( dom F ) and A21: y = ( F . x ) by FUNCT_1:def 3;
consider g,h such that A22: x = g and A23: ( F . x ) = h and A24: ( dom h ) = ( dom f ) and A25: (for y holds (y in ( dom f ) implies ((( f . y ) = ( {} ) implies ( h . y ) = ( {} )) & (( f . y ) <> ( {} ) implies ( h . y ) = ( ( curry' g ) . y ))))) by A3,A20;
A26: (ex f1 being Function st ((x = f1 & ( dom f1 ) = ( Union ( disjoin f ) )) & ( rng f1 ) c= X)) by A3,A20,FUNCT_2:def 2;
A27:now
let z;
assume z in ( dom ( Funcs (f,X) ) );
then A28: z in ( dom f ) by CKB56:def 1;
then A29: ( ( Funcs (f,X) ) . z ) = ( Funcs (( f . z ),X) ) by CKB56:def 1;
A30:now
set a = the (Element of ( f . z ));
assume A31: ( f . z ) <> ( {} );
(( [ a,z ] `1 ) = a & ( [ a,z ] `2 ) = z) by MCART_1:7;
then A32: [ a,z ] in ( Union ( disjoin f ) ) by A28,A31,CARD_3:22;
then reconsider k = ( ( curry' g ) . z ) as Function by A22,A26,FUNCT_5:21;
A33: z in ( dom ( curry' g ) ) by A22,A26,A32,FUNCT_5:21;
then ( rng k ) c= ( rng g ) by FUNCT_5:34;
then A34: ( rng k ) c= X by A22,A26,XBOOLE_1:1;
A35: ( dom k ) = ( proj1 ( ( dom g ) /\ [: ( proj1 ( dom g ) ),{ z } :] ) ) by A33,FUNCT_5:34;
A36: ( dom k ) = ( f . z )
proof
thus ( dom k ) c= ( f . z )
proof
let b being set;
assume b in ( dom k );
then consider c being set such that A37: [ b,c ] in ( ( dom g ) /\ [: ( proj1 ( dom g ) ),{ z } :] ) by A35,RELAT_1:def 4;
[ b,c ] in [: ( proj1 ( dom g ) ),{ z } :] by A37,XBOOLE_0:def 4;
then A38: c in { z } by ZFMISC_1:87;
A39: (( [ b,c ] `1 ) = b & ( [ b,c ] `2 ) = c) by MCART_1:7;
[ b,c ] in ( dom g ) by A37,XBOOLE_0:def 4;
then b in ( f . c ) by A22,A26,A39,CARD_3:22;
hence thesis by A38,TARSKI:def 1;
end;

let b being set;
assume that
A40: b in ( f . z );
A41: z in { z } by TARSKI:def 1;
(( [ b,z ] `1 ) = b & ( [ b,z ] `2 ) = z) by MCART_1:7;
then A42: [ b,z ] in ( dom g ) by A22,A26,A28,A40,CARD_3:22;
then b in ( proj1 ( dom g ) ) by RELAT_1:def 4;
then [ b,z ] in [: ( proj1 ( dom g ) ),{ z } :] by A41,ZFMISC_1:87;
then [ b,z ] in ( ( dom g ) /\ [: ( proj1 ( dom g ) ),{ z } :] ) by A42,XBOOLE_0:def 4;
hence thesis by A35,RELAT_1:def 4;
end;
( h . z ) = k by A25,A28,A31;
hence ( h . z ) in ( ( Funcs (f,X) ) . z ) by A29,A34,A36,FUNCT_2:def 2;
end;
now
assume ( f . z ) = ( {} );
then (( h . z ) = ( {} ) & ( ( Funcs (f,X) ) . z ) = { ( {} ) }) by A25,A28,A29,FUNCT_5:57;
hence ( h . z ) in ( ( Funcs (f,X) ) . z ) by TARSKI:def 1;
end;
hence ( h . z ) in ( ( Funcs (f,X) ) . z ) by A30;
end;
( dom h ) = ( dom ( Funcs (f,X) ) ) by A24,CKB56:def 1;
hence thesis by A21,A23,A27,CARD_3:def 5;
end;

let x;
assume x in ( product ( Funcs (f,X) ) );
then consider s being Function such that A43: x = s and A44: ( dom s ) = ( dom ( Funcs (f,X) ) ) and A45: (for z holds (z in ( dom ( Funcs (f,X) ) ) implies ( s . z ) in ( ( Funcs (f,X) ) . z ))) by CARD_3:def 5;
A46: ( dom s ) = ( dom f ) by A44,CKB56:def 1;
A47: ( uncurry' s ) = ( ~ ( uncurry s ) ) by FUNCT_5:def 4;
A48: ( dom ( uncurry' s ) ) = ( Union ( disjoin f ) )
proof
thus ( dom ( uncurry' s ) ) c= ( Union ( disjoin f ) )
proof
let z;
assume A49: z in ( dom ( uncurry' s ) );
then consider z1,z2 being set such that A50: z = [ z1,z2 ] by A47,CKB2:1;
A51: (( z `1 ) = z1 & ( z `2 ) = z2) by A50,MCART_1:7;
[ z2,z1 ] in ( dom ( uncurry s ) ) by A47,A49,A50,FUNCT_4:42;
then consider a being set,u being Function,b being set such that A52: [ z2,z1 ] = [ a,b ] and A53: a in ( dom s ) and A54: u = ( s . a ) and A55: b in ( dom u ) by FUNCT_5:def 2;
A56: (( [ a,b ] `1 ) = a & ( [ z2,z1 ] `1 ) = z2) by MCART_1:7;
(u in ( ( Funcs (f,X) ) . a ) & ( ( Funcs (f,X) ) . a ) = ( Funcs (( f . a ),X) )) by A44,A45,A46,A53,A54,CKB56:def 1;
then A57: (ex j being Function st ((u = j & ( dom j ) = ( f . z2 )) & ( rng j ) c= X)) by A52,A56,FUNCT_2:def 2;
(( [ a,b ] `2 ) = b & ( [ z2,z1 ] `2 ) = z1) by MCART_1:7;
hence thesis by A46,A50,A52,A53,A55,A51,A56,A57,CARD_3:22;
end;

let z;
assume A58: z in ( Union ( disjoin f ) );
then A59: (( z `1 ) in ( f . ( z `2 ) ) & z = [ ( z `1 ),( z `2 ) ]) by CARD_3:22;
A60: ( z `2 ) in ( dom f ) by A58,CARD_3:22;
then (( s . ( z `2 ) ) in ( ( Funcs (f,X) ) . ( z `2 ) ) & ( ( Funcs (f,X) ) . ( z `2 ) ) = ( Funcs (( f . ( z `2 ) ),X) )) by A44,A45,A46,CKB56:def 1;
then (ex j being Function st ((( s . ( z `2 ) ) = j & ( dom j ) = ( f . ( z `2 ) )) & ( rng j ) c= X)) by FUNCT_2:def 2;
hence thesis by A46,A60,A59,FUNCT_5:39;
end;
( rng ( uncurry' s ) ) c= X
proof
let d being set;
assume d in ( rng ( uncurry' s ) );
then consider z such that A61: z in ( dom ( uncurry' s ) ) and A62: d = ( ( uncurry' s ) . z ) by FUNCT_1:def 3;
consider z1,z2 being set such that A63: z = [ z1,z2 ] by A47,A61,CKB2:1;
[ z2,z1 ] in ( dom ( uncurry s ) ) by A47,A61,A63,FUNCT_4:42;
then consider a being set,u being Function,b being set such that A64: [ z2,z1 ] = [ a,b ] and A65: (a in ( dom s ) & u = ( s . a )) and A66: b in ( dom u ) by FUNCT_5:def 2;
A67: (( [ a,b ] `1 ) = a & ( [ z2,z1 ] `1 ) = z2) by MCART_1:7;
(u in ( ( Funcs (f,X) ) . a ) & ( ( Funcs (f,X) ) . a ) = ( Funcs (( f . a ),X) )) by A44,A45,A46,A65,CKB56:def 1;
then A68: (ex j being Function st ((u = j & ( dom j ) = ( f . z2 )) & ( rng j ) c= X)) by A64,A67,FUNCT_2:def 2;
A69: (( [ a,b ] `2 ) = b & ( [ z2,z1 ] `2 ) = z1) by MCART_1:7;
( ( uncurry' s ) . (b,a) ) = ( u . b ) by A65,A66,FUNCT_5:39;
then d in ( rng u ) by A62,A63,A64,A66,A67,A69,FUNCT_1:def 3;
hence thesis by A68;
end;
then A70: ( uncurry' s ) in ( dom F ) by A3,A48,FUNCT_2:def 2;
then consider g,h such that A71: ( uncurry' s ) = g and A72: ( F . ( uncurry' s ) ) = h and A73: ( dom h ) = ( dom f ) and A74: (for y holds (y in ( dom f ) implies ((( f . y ) = ( {} ) implies ( h . y ) = ( {} )) & (( f . y ) <> ( {} ) implies ( h . y ) = ( ( curry' g ) . y ))))) by A3;
now
let z;
assume A75: z in ( dom f );
then (( s . z ) in ( ( Funcs (f,X) ) . z ) & ( ( Funcs (f,X) ) . z ) = ( Funcs (( f . z ),X) )) by A44,A45,A46,CKB56:def 1;
then consider v being Function such that A76: ( s . z ) = v and A77: ( dom v ) = ( f . z ) and ( rng v ) c= X by FUNCT_2:def 2;
A78:now
set a = the (Element of ( f . z ));
assume A79: ( f . z ) <> ( {} );
then A80: [ a,z ] in ( dom ( uncurry' s ) ) by A46,A75,A76,A77,FUNCT_5:39;
then reconsider j = ( ( curry' ( uncurry' s ) ) . z ) as Function by FUNCT_5:21;
A81: j = ( ( curry ( ~ ( uncurry' s ) ) ) . z ) by FUNCT_5:def 3;
A82: ( ~ ( uncurry' s ) ) = ( uncurry s ) by CKB4:1;
then A83: [ z,a ] in ( dom ( uncurry s ) ) by A80,FUNCT_4:42;
A84: ( dom j ) = ( dom v )
proof
thus ( dom j ) c= ( dom v )
proof
let b being set;
assume b in ( dom j );
then [ z,b ] in ( dom ( uncurry s ) ) by A81,A82,A83,CKB60:1;
then consider a1 being set,g1 being Function,a2 being set such that A85: [ z,b ] = [ a1,a2 ] and a1 in ( dom s ) and A86: (g1 = ( s . a1 ) & a2 in ( dom g1 )) by FUNCT_5:def 2;
z = a1 by A85,ZFMISC_1:27;
hence thesis by A76,A85,A86,ZFMISC_1:27;
end;

let b being set;
assume b in ( dom v );
then [ z,b ] in ( dom ( uncurry s ) ) by A46,A75,A76,FUNCT_5:38;
hence thesis by A81,A82,FUNCT_5:20;
end;
now
let b being set;
assume b in ( f . z );
then A87: [ z,b ] in ( dom ( uncurry s ) ) by A77,A81,A82,A83,A84,CKB60:1;
then consider a1 being set,g1 being Function,a2 being set such that A88: [ z,b ] = [ a1,a2 ] and A89: ((a1 in ( dom s ) & g1 = ( s . a1 )) & a2 in ( dom g1 )) by FUNCT_5:def 2;
A90: ( j . b ) = ( ( uncurry s ) . (z,b) ) by A81,A82,A87,FUNCT_5:20;
(z = a1 & b = a2) by A88,ZFMISC_1:27;
hence ( j . b ) = ( v . b ) by A76,A89,A90,FUNCT_5:38;
end;
then v = j by A77,A84,FUNCT_1:2;
hence ( s . z ) = ( h . z ) by A71,A74,A75,A76,A79;
end;
(( f . z ) = ( {} ) implies (( s . z ) = ( {} ) & ( h . z ) = ( {} ))) by A74,A75,A76,A77;
hence ( s . z ) = ( h . z ) by A78;
end;
then h = s by A46,A73,FUNCT_1:2;
hence thesis by A43,A70,A72,FUNCT_1:def 3;
end;
