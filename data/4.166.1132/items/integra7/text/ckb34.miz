environ
vocabularies NUMBERS,XREAL_0,ORDINAL1,XBOOLE_0,PARTFUN1,SUBSET_1,FUNCT_1,RELAT_1,XXREAL_2,COMPLEX1,ARYTM_1,XXREAL_0,SEQ_4,ARYTM_3,REAL_1,FDIFF_1,RCOMP_1,TARSKI,VALUED_1,CARD_1,ORDINAL4,INTEGRA5,INTEGRA1,XXREAL_1,SQUARE_1,ORDINAL2,FUNCOP_1,FCONT_1,REALSET1,SIN_COS,PREPOWER,SEQFUNC,SEQ_1,SEQ_2,INTEGRA2,FUNCT_3,FINSEQ_1,FINSEQ_2,CARD_3,MEASURE7,NAT_1,INTEGRA7;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,XXREAL_0,XXREAL_2,COMPLEX1,REAL_1,NAT_1,FUNCOP_1,RELSET_1,FUNCT_2,RCOMP_1,PARTFUN1,PARTFUN2,FINSEQ_1,VALUED_1,SEQ_1,RFUNCT_1,SEQ_2,SEQ_4,SQUARE_1,PREPOWER,FCONT_1,FDIFF_1,FINSEQ_2,RVSUM_1,INTEGRA1,INTEGRA2,SEQFUNC,SIN_COS,TAYLOR_1,INTEGRA3,INTEGRA5,CKB11,CKB12;
definitions XCMPLX_0,SUBSET_1,INTEGRA1,INTEGRA5,VALUED_1,FDIFF_1,SQUARE_1,CKB11,CKB12;
theorems TARSKI,PARTFUN1,RVSUM_1,ZFMISC_1,PREPOWER,INTEGRA1,INTEGRA2,RFUNCT_1,FUNCT_1,SEQ_1,SEQ_2,FDIFF_1,SEQFUNC,ABSVALUE,XCMPLX_1,FINSEQ_1,FINSEQ_2,RCOMP_1,FCONT_1,FDIFF_2,RELAT_1,XREAL_0,XXREAL_0,PARTFUN2,FUNCT_2,XBOOLE_0,XBOOLE_1,SEQ_4,XREAL_1,COMPLEX1,INTEGRA4,INTEGRA5,SIN_COS,INTEGRA6,TAYLOR_1,VALUED_1,XXREAL_1,XXREAL_2,FUNCOP_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33;
schemes FUNCT_2,XBOOLE_0;
registrations XREAL_0,RELSET_1,FINSEQ_2,INTEGRA1,RCOMP_1,INT_1,ORDINAL1,MEMBERED,PREPOWER,XBOOLE_0,NUMBERS,VALUED_0,VALUED_1,FUNCT_2,XXREAL_2,SEQ_2,FCONT_3,MEASURE5;
constructors REAL_1,FDIFF_1,PARTFUN1,PARTFUN2,RFUNCT_1,INTEGRA2,LIMFUNC1,FCONT_1,PSCOMP_1,NAT_1,BINOP_2,INTEGRA5,SIN_COS,PREPOWER,TAYLOR_1,SQUARE_1,SEQ_1,XXREAL_2,RFUNCT_2,SEQFUNC,RVSUM_1,SEQ_4,RELSET_1,SEQ_2,COMPLEX1,INTEGRA3,CKB11,CKB12;
requirements NUMERALS,BOOLE,SUBSET,REAL,ARITHM;
begin
reserve a for  real number;
reserve b for  real number;
reserve r for  real number;
reserve x for set;
reserve n for (Element of ( NAT ));
theorem
(for H being (Functional_Sequence of ( REAL ),( REAL )) holds (for rseq being Real_Sequence holds (((a < b & (for n being (Element of ( NAT )) holds ((( H . n ) is_integrable_on [' a,b '] & ( ( H . n ) | [' a,b '] ) is  bounded) & ( rseq . n ) = ( integral (( H . n ),a,b) )))) & H is_unif_conv_on [' a,b ']) implies (((( ( lim (H,[' a,b ']) ) | [' a,b '] ) is  bounded & ( lim (H,[' a,b ']) ) is_integrable_on [' a,b ']) & rseq is  convergent) & ( lim rseq ) = ( integral (( lim (H,[' a,b ']) ),a,b) )))))
proof
let H being (Functional_Sequence of ( REAL ),( REAL ));
let rseq being Real_Sequence;
set AB = [' a,b '];
assume that
A1: a < b
and
A2: (for n being (Element of ( NAT )) holds ((( H . n ) is_integrable_on AB & ( ( H . n ) | AB ) is  bounded) & ( rseq . n ) = ( integral (( H . n ),a,b) )))
and
A3: H is_unif_conv_on AB;
consider T being (DivSequence of AB) such that A4: (( delta T ) is  convergent & ( lim ( delta T ) ) = ( 0 )) by INTEGRA4:11;
A5: AB common_on_dom H by A3,SEQFUNC:43;
A6: (for n being (Element of ( NAT )) holds (((((((( ( H . n ) || AB ) is (Function of AB,( REAL )) & ( ( ( H . n ) || AB ) | AB ) is  bounded) & ( lower_sum (( ( H . n ) || AB ),T) ) is  convergent) & ( lim ( lower_sum (( ( H . n ) || AB ),T) ) ) = ( lower_integral ( ( H . n ) || AB ) )) & ( upper_sum (( ( H . n ) || AB ),T) ) is  convergent) & ( lim ( upper_sum (( ( H . n ) || AB ),T) ) ) = ( upper_integral ( ( H . n ) || AB ) )) & ( lower_integral ( ( H . n ) || AB ) ) = ( upper_integral ( ( H . n ) || AB ) )) & ( rseq . n ) = ( integral ( ( H . n ) || AB ) )))
proof
let n being (Element of ( NAT ));
AB c= ( dom ( H . n ) ) by A5,SEQFUNC:def 9;
hence A7: ( ( H . n ) || AB ) is (Function of AB,( REAL )) by FUNCT_2:68,INTEGRA5:6;
thus ( ( ( H . n ) || AB ) | AB ) is  bounded by A2,INTEGRA5:9;
hence (((( lower_sum (( ( H . n ) || AB ),T) ) is  convergent & ( lim ( lower_sum (( ( H . n ) || AB ),T) ) ) = ( lower_integral ( ( H . n ) || AB ) )) & ( upper_sum (( ( H . n ) || AB ),T) ) is  convergent) & ( lim ( upper_sum (( ( H . n ) || AB ),T) ) ) = ( upper_integral ( ( H . n ) || AB ) )) by A4,A7,INTEGRA4:8,INTEGRA4:9;
( H . n ) is_integrable_on AB by A2;
then ( ( H . n ) || AB ) is  integrable by INTEGRA5:def 1;
hence ( lower_integral ( ( H . n ) || AB ) ) = ( upper_integral ( ( H . n ) || AB ) ) by INTEGRA1:def 16;
( rseq . n ) = ( integral (( H . n ),a,b) ) by A2;
then ( rseq . n ) = ( integral (( H . n ),AB) ) by A1,INTEGRA5:def 4;
hence thesis;
end;
set L1 = ( lower_integral ( ( lim (H,AB) ) || AB ) );
set K1 = ( upper_integral ( ( lim (H,AB) ) || AB ) );
A8: ( 0 ) < ( b - a ) by A1,XREAL_1:50;
consider K being (Element of ( NAT )) such that A9: (for n being (Element of ( NAT )) holds (for x being (Element of ( REAL )) holds ((n >= K & x in AB) implies ( abs ( ( ( H . n ) . x ) - ( ( lim (H,AB) ) . x ) ) ) < 1))) by A3,SEQFUNC:43;
( ( H . K ) | AB ) is  bounded by A2;
then consider r being  real number such that A10: (for c being set holds (c in ( AB /\ ( dom ( H . K ) ) ) implies ( abs ( ( H . K ) . c ) ) <= r)) by RFUNCT_1:73;
set H0 = ( ( lim (H,AB) ) || AB );
H is_point_conv_on AB by A3,SEQFUNC:22;
then A11: ( dom ( lim (H,AB) ) ) = AB by SEQFUNC:21;
then A12: H0 is (Function of AB,( REAL )) by FUNCT_2:68,INTEGRA5:6;
( dom ( lim (H,AB) ) ) c= ( dom ( H . K ) ) by A5,A11,SEQFUNC:def 9;
then A13: ( AB /\ ( dom ( lim (H,AB) ) ) ) c= ( AB /\ ( dom ( H . K ) ) ) by XBOOLE_1:26;
now
let c being set;
( ( lim (H,AB) ) . c ) = ( ( ( H . K ) . c ) - ( ( ( H . K ) . c ) - ( ( lim (H,AB) ) . c ) ) );
then A14: ( abs ( ( lim (H,AB) ) . c ) ) <= ( ( abs ( ( H . K ) . c ) ) + ( abs ( ( ( H . K ) . c ) - ( ( lim (H,AB) ) . c ) ) ) ) by COMPLEX1:57;
assume A15: c in ( AB /\ ( dom ( lim (H,AB) ) ) );
then c in AB by XBOOLE_0:def 4;
then A16: ( abs ( ( ( H . K ) . c ) - ( ( lim (H,AB) ) . c ) ) ) < 1 by A9;
( abs ( ( H . K ) . c ) ) <= r by A10,A13,A15;
then ( ( abs ( ( H . K ) . c ) ) + ( abs ( ( ( H . K ) . c ) - ( ( lim (H,AB) ) . c ) ) ) ) <= ( r + 1 ) by A16,XREAL_1:7;
hence ( abs ( ( lim (H,AB) ) . c ) ) <= ( r + 1 ) by A14,XXREAL_0:2;
end;
hence A17: ( ( lim (H,AB) ) | AB ) is  bounded by RFUNCT_1:73;
then A18: ( H0 | AB ) is  bounded_above by INTEGRA5:7;
A19: ( H0 | AB ) is  bounded_below by A17,INTEGRA5:8;
then A20: ( upper_sum (H0,T) ) is  convergent by A4,A18,A12,INTEGRA4:9;
A21: (for e being (Element of ( REAL )) holds (( 0 ) < e implies (ex N being (Element of ( NAT )) st (for n,k being (Element of ( NAT )) holds (N <= n implies ( abs ( ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) ) <= ( e * ( b - a ) ))))))
proof
let e being (Element of ( REAL ));
assume ( 0 ) < e;
then consider N being (Element of ( NAT )) such that A22: (for n being (Element of ( NAT )) holds (for x being (Element of ( REAL )) holds ((n >= N & x in AB) implies ( abs ( ( ( H . n ) . x ) - ( ( lim (H,AB) ) . x ) ) ) < e))) by A3,SEQFUNC:43;
take N;
now
let n being (Element of ( NAT ));
let k being (Element of ( NAT ));
reconsider Tk = ( T . k ) as (Division of AB);
set l0 = ( len Tk );
A23: ( dom Tk ) = ( Seg l0 ) by FINSEQ_1:def 3;
set Hn = ( ( H . n ) || AB );
( len ( upper_volume (Hn,( T . k )) ) ) = l0 by INTEGRA1:def 6;
then reconsider R1 = ( upper_volume (Hn,( T . k )) ) as (Element of ( l0 -tuples_on ( REAL ) )) by FINSEQ_2:92;
( len ( upper_volume (H0,( T . k )) ) ) = l0 by INTEGRA1:def 6;
then reconsider R2 = ( upper_volume (H0,( T . k )) ) as (Element of ( l0 -tuples_on ( REAL ) )) by FINSEQ_2:92;
( ( ( upper_sum (H0,T) ) . k ) - ( ( upper_sum (Hn,T) ) . k ) ) = ( ( upper_sum (H0,( T . k )) ) - ( ( upper_sum (Hn,T) ) . k ) ) by INTEGRA2:def 2;
then ( ( ( upper_sum (H0,T) ) . k ) - ( ( upper_sum (Hn,T) ) . k ) ) = ( ( upper_sum (H0,( T . k )) ) - ( upper_sum (Hn,( T . k )) ) ) by INTEGRA2:def 2;
then A24: ( ( ( upper_sum (H0,T) ) . k ) - ( ( upper_sum (Hn,T) ) . k ) ) = ( Sum ( R2 - R1 ) ) by RVSUM_1:90;
consider H1 being (Function of AB,( REAL )) such that A25: ( rng H1 ) = { e } and A26: ( H1 | AB ) is  bounded by INTEGRA4:5;
( len ( upper_volume (H1,( T . k )) ) ) = l0 by INTEGRA1:def 6;
then reconsider R3 = ( upper_volume (H1,( T . k )) ) as (Element of ( l0 -tuples_on ( REAL ) )) by FINSEQ_2:92;
A27: ( vol AB ) = ( b - a ) by A1,INTEGRA6:5;
( upper_bound ( rng H1 ) ) = e by A25,SEQ_4:9;
then A28: ( upper_sum (H1,( T . k )) ) <= ( e * ( b - a ) ) by A26,A27,INTEGRA1:27;
assume A29: N <= n;
A30: (for i being (Element of ( NAT )) holds (i in ( dom Tk ) implies (( ( R1 - R2 ) . i ) <= ( R3 . i ) & ( ( R2 - R1 ) . i ) <= ( R3 . i ))))
proof
let i being (Element of ( NAT ));
A31: ( 0 ) <= ( vol ( divset (( T . k ),i) ) ) by INTEGRA1:9;
assume A32: i in ( dom Tk );
A33: (( ( upper_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) - ( upper_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) ) <= ( upper_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) & ( ( upper_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) - ( upper_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) ) <= ( upper_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ))
proof
A34: ( divset (( T . k ),i) ) c= AB by A32,INTEGRA1:8;
then reconsider g = ( H0 | ( divset (( T . k ),i) ) ) as (Function of ( divset (( T . k ),i) ),( REAL )) by A12,FUNCT_2:32;
consider x0 being set such that A35: x0 in ( divset (( T . k ),i) ) by XBOOLE_0:def 1;
Hn is (Function of AB,( REAL )) by A6;
then reconsider f = ( Hn | ( divset (( T . k ),i) ) ) as (Function of ( divset (( T . k ),i) ),( REAL )) by A34,FUNCT_2:32;
A36: (for x being set holds (x in ( divset (( T . k ),i) ) implies ( abs ( ( f . x ) - ( g . x ) ) ) <= e))
proof
let x being set;
assume A37: x in ( divset (( T . k ),i) );
then ( abs ( ( f . x ) - ( g . x ) ) ) = ( abs ( ( Hn . x ) - ( g . x ) ) ) by FUNCT_1:49;
then ( abs ( ( f . x ) - ( g . x ) ) ) = ( abs ( ( Hn . x ) - ( H0 . x ) ) ) by A37,FUNCT_1:49;
then ( abs ( ( f . x ) - ( g . x ) ) ) = ( abs ( ( ( H . n ) . x ) - ( H0 . x ) ) ) by A34,A37,FUNCT_1:49;
then ( abs ( ( f . x ) - ( g . x ) ) ) = ( abs ( ( ( H . n ) . x ) - ( ( lim (H,AB) ) . x ) ) ) by A34,A37,FUNCT_1:49;
hence thesis by A22,A29,A34,A37;
end;
( Hn | AB ) is  bounded by A6;
then ( f | ( divset (( T . k ),i) ) ) is  bounded_above by A32,INTEGRA1:8,INTEGRA2:5;
then A38: ( rng f ) is  bounded_above by INTEGRA1:13;
( H1 . x0 ) in { e } by A25,A34,A35,FUNCT_2:4;
then ( H1 . x0 ) = e by TARSKI:def 1;
then A39: ( ( H1 | ( divset (( T . k ),i) ) ) . x0 ) = e by A35,FUNCT_1:49;
( H1 | ( divset (( T . k ),i) ) ) is (Function of ( divset (( T . k ),i) ),( REAL )) by A34,FUNCT_2:32;
then e in ( rng ( H1 | ( divset (( T . k ),i) ) ) ) by A35,A39,FUNCT_2:4;
then A40: { e } c= ( rng ( H1 | ( divset (( T . k ),i) ) ) ) by ZFMISC_1:31;
( rng ( H1 | ( divset (( T . k ),i) ) ) ) c= { e } by A25,RELAT_1:70;
then ( rng ( H1 | ( divset (( T . k ),i) ) ) ) = { e } by A40,XBOOLE_0:def 10;
then A41: e = ( upper_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) by SEQ_4:9;
( g | ( divset (( T . k ),i) ) ) is  bounded_above by A18,A32,INTEGRA1:8,INTEGRA2:5;
then A42: ( rng g ) is  bounded_above by INTEGRA1:13;
hence ( ( upper_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) - ( upper_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) ) <= ( upper_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) by A38,A41,A36,CKB1:1;
(for x being set holds (x in ( divset (( T . k ),i) ) implies ( abs ( ( g . x ) - ( f . x ) ) ) <= ( upper_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) )))
proof
let x being set;
assume x in ( divset (( T . k ),i) );
then ( abs ( ( f . x ) - ( g . x ) ) ) <= ( upper_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) by A41,A36;
hence thesis by COMPLEX1:60;
end;
hence thesis by A38,A42,CKB1:1;
end;
( ( R1 - R2 ) . i ) = ( ( R1 . i ) - ( R2 . i ) ) by RVSUM_1:27;
then ( ( R1 - R2 ) . i ) = ( ( ( upper_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) - ( ( upper_volume (H0,( T . k )) ) . i ) ) by A32,INTEGRA1:def 6;
then ( ( R1 - R2 ) . i ) = ( ( ( upper_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) - ( ( upper_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) ) by A32,INTEGRA1:def 6;
then ( ( R1 - R2 ) . i ) = ( ( ( upper_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) - ( upper_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) );
then ( ( R1 - R2 ) . i ) <= ( ( upper_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) by A33,A31,XREAL_1:64;
hence ( ( R1 - R2 ) . i ) <= ( R3 . i ) by A32,INTEGRA1:def 6;
( ( R2 - R1 ) . i ) = ( ( R2 . i ) - ( R1 . i ) ) by RVSUM_1:27;
then ( ( R2 - R1 ) . i ) = ( ( ( upper_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) - ( ( upper_volume (Hn,( T . k )) ) . i ) ) by A32,INTEGRA1:def 6;
then ( ( R2 - R1 ) . i ) = ( ( ( upper_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) - ( ( upper_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) ) by A32,INTEGRA1:def 6;
then ( ( R2 - R1 ) . i ) = ( ( ( upper_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) - ( upper_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) );
then ( ( R2 - R1 ) . i ) <= ( ( upper_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) by A33,A31,XREAL_1:64;
hence thesis by A32,INTEGRA1:def 6;
end;
then (for i being Nat holds (i in ( dom Tk ) implies ( ( R2 - R1 ) . i ) <= ( R3 . i )));
then ( ( ( upper_sum (H0,T) ) . k ) - ( ( upper_sum (Hn,T) ) . k ) ) <= ( Sum R3 ) by A23,A24,RVSUM_1:82;
then ( ( ( upper_sum (H0,T) ) . k ) - ( ( upper_sum (Hn,T) ) . k ) ) <= ( e * ( b - a ) ) by A28,XXREAL_0:2;
then A43: ( - ( e * ( b - a ) ) ) <= ( - ( ( ( upper_sum (H0,T) ) . k ) - ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) ) ) by XREAL_1:24;
( ( ( upper_sum (Hn,T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) = ( ( upper_sum (Hn,( T . k )) ) - ( ( upper_sum (H0,T) ) . k ) ) by INTEGRA2:def 2;
then ( ( ( upper_sum (Hn,T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) = ( ( upper_sum (Hn,( T . k )) ) - ( upper_sum (H0,( T . k )) ) ) by INTEGRA2:def 2;
then A44: ( ( ( upper_sum (Hn,T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) = ( Sum ( R1 - R2 ) ) by RVSUM_1:90;
(for i being Nat holds (i in ( Seg l0 ) implies ( ( R1 - R2 ) . i ) <= ( R3 . i ))) by A23,A30;
then ( ( ( upper_sum (Hn,T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) <= ( Sum R3 ) by A44,RVSUM_1:82;
then ( ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) <= ( e * ( b - a ) ) by A28,XXREAL_0:2;
hence ( abs ( ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) ) <= ( e * ( b - a ) ) by A43,ABSVALUE:5;
end;
hence thesis;
end;
A45: (for e being (Element of ( REAL )) holds (( 0 ) < e implies (ex N being (Element of ( NAT )) st (for n being (Element of ( NAT )) holds (N <= n implies ( abs ( ( upper_integral ( ( H . n ) || AB ) ) - ( upper_integral ( ( lim (H,AB) ) || AB ) ) ) ) <= e)))))
proof
let e being (Element of ( REAL ));
assume ( 0 ) < e;
then consider N being (Element of ( NAT )) such that A46: (for n,k being (Element of ( NAT )) holds (N <= n implies ( abs ( ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) ) <= ( ( e / ( b - a ) ) * ( b - a ) ))) by A21,A8,XREAL_1:139;
take N;
A47:now
let n being (Element of ( NAT ));
let k being (Element of ( NAT ));
assume N <= n;
then ( abs ( ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) ) <= ( ( e / ( b - a ) ) * ( b - a ) ) by A46;
hence ( abs ( ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) ) <= e by A8,XCMPLX_1:87;
end;
hereby
let n being (Element of ( NAT ));
assume A48: N <= n;
A49:now
let k being (Element of ( NAT ));
( abs ( ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( upper_sum (H0,T) ) . k ) ) ) <= e by A47,A48;
then ( abs ( ( ( upper_sum (( ( H . n ) || AB ),T) ) . k ) + ( ( - ( upper_sum (H0,T) ) ) . k ) ) ) <= e by SEQ_1:10;
then ( abs ( ( ( upper_sum (( ( H . n ) || AB ),T) ) + ( - ( upper_sum (H0,T) ) ) ) . k ) ) <= e by SEQ_1:7;
hence ( ( abs ( ( upper_sum (( ( H . n ) || AB ),T) ) - ( upper_sum (H0,T) ) ) ) . k ) <= e by SEQ_1:12;
end;
A50: ( upper_sum (( ( H . n ) || AB ),T) ) is  convergent by A6;
then ( lim ( ( upper_sum (( ( H . n ) || AB ),T) ) - ( upper_sum (H0,T) ) ) ) = ( ( lim ( upper_sum (( ( H . n ) || AB ),T) ) ) - ( lim ( upper_sum (H0,T) ) ) ) by A20,SEQ_2:12;
then ( lim ( ( upper_sum (( ( H . n ) || AB ),T) ) - ( upper_sum (H0,T) ) ) ) = ( ( upper_integral ( ( H . n ) || AB ) ) - ( lim ( upper_sum (H0,T) ) ) ) by A6;
then A51: ( lim ( ( upper_sum (( ( H . n ) || AB ),T) ) - ( upper_sum (H0,T) ) ) ) = ( ( upper_integral ( ( H . n ) || AB ) ) - ( upper_integral ( ( lim (H,AB) ) || AB ) ) ) by A4,A18,A19,A12,INTEGRA4:9;
A52: ( ( upper_sum (( ( H . n ) || AB ),T) ) - ( upper_sum (H0,T) ) ) is  convergent by A20,A50,SEQ_2:11;
then ( abs ( ( upper_sum (( ( H . n ) || AB ),T) ) - ( upper_sum (H0,T) ) ) ) is  convergent by SEQ_4:13;
then ( lim ( abs ( ( upper_sum (( ( H . n ) || AB ),T) ) - ( upper_sum (H0,T) ) ) ) ) <= e by A49,PREPOWER:2;
hence ( abs ( ( upper_integral ( ( H . n ) || AB ) ) - ( upper_integral ( ( lim (H,AB) ) || AB ) ) ) ) <= e by A52,A51,SEQ_4:14;
end;
end;
A53: ( lower_sum (H0,T) ) is  convergent by A4,A18,A19,A12,INTEGRA4:8;
A54: (for e being (Element of ( REAL )) holds (( 0 ) < e implies (ex N being (Element of ( NAT )) st (for n,k being (Element of ( NAT )) holds (N <= n implies ( abs ( ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) ) <= ( e * ( b - a ) ))))))
proof
let e being (Element of ( REAL ));
assume ( 0 ) < e;
then consider N being (Element of ( NAT )) such that A55: (for n being (Element of ( NAT )) holds (for x being (Element of ( REAL )) holds ((n >= N & x in AB) implies ( abs ( ( ( H . n ) . x ) - ( ( lim (H,AB) ) . x ) ) ) < e))) by A3,SEQFUNC:43;
take N;
hereby
let n being (Element of ( NAT ));
let k being (Element of ( NAT ));
set Hn = ( ( H . n ) || AB );
reconsider Tk = ( T . k ) as (Division of AB);
set l0 = ( len Tk );
consider H1 being (Function of AB,( REAL )) such that A56: ( rng H1 ) = { e } and A57: ( H1 | AB ) is  bounded by INTEGRA4:5;
A58: ( lower_sum (H1,( T . k )) ) <= ( upper_sum (H1,( T . k )) ) by A57,INTEGRA1:28;
( len ( lower_volume (H0,( T . k )) ) ) = l0 by INTEGRA1:def 7;
then reconsider R2 = ( lower_volume (H0,( T . k )) ) as (Element of ( l0 -tuples_on ( REAL ) )) by FINSEQ_2:92;
( len ( lower_volume (Hn,( T . k )) ) ) = l0 by INTEGRA1:def 7;
then reconsider R1 = ( lower_volume (Hn,( T . k )) ) as (Element of ( l0 -tuples_on ( REAL ) )) by FINSEQ_2:92;
( len ( lower_volume (H1,( T . k )) ) ) = l0 by INTEGRA1:def 7;
then reconsider R3 = ( lower_volume (H1,( T . k )) ) as (Element of ( l0 -tuples_on ( REAL ) )) by FINSEQ_2:92;
assume A59: N <= n;
A60: (for i being (Element of ( NAT )) holds (i in ( dom Tk ) implies (( ( R1 - R2 ) . i ) <= ( R3 . i ) & ( ( R2 - R1 ) . i ) <= ( R3 . i ))))
proof
let i being (Element of ( NAT ));
consider x0 being set such that A61: x0 in ( divset (( T . k ),i) ) by XBOOLE_0:def 1;
A62: ( rng ( H1 | ( divset (( T . k ),i) ) ) ) c= { e } by A56,RELAT_1:70;
assume A63: i in ( dom Tk );
then A64: ( divset (( T . k ),i) ) c= AB by INTEGRA1:8;
then reconsider g = ( H0 | ( divset (( T . k ),i) ) ) as (Function of ( divset (( T . k ),i) ),( REAL )) by A12,FUNCT_2:32;
Hn is (Function of AB,( REAL )) by A6;
then reconsider f = ( Hn | ( divset (( T . k ),i) ) ) as (Function of ( divset (( T . k ),i) ),( REAL )) by A64,FUNCT_2:32;
A65: ( 0 ) <= ( vol ( divset (( T . k ),i) ) ) by INTEGRA1:9;
( H1 . x0 ) in { e } by A56,A64,A61,FUNCT_2:4;
then ( H1 . x0 ) = e by TARSKI:def 1;
then A66: ( ( H1 | ( divset (( T . k ),i) ) ) . x0 ) = e by A61,FUNCT_1:49;
( H1 | ( divset (( T . k ),i) ) ) is (Function of ( divset (( T . k ),i) ),( REAL )) by A64,FUNCT_2:32;
then e in ( rng ( H1 | ( divset (( T . k ),i) ) ) ) by A61,A66,FUNCT_2:4;
then { e } c= ( rng ( H1 | ( divset (( T . k ),i) ) ) ) by ZFMISC_1:31;
then ( rng ( H1 | ( divset (( T . k ),i) ) ) ) = { e } by A62,XBOOLE_0:def 10;
then A67: e = ( lower_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) by SEQ_4:9;
A68:now
let x being set;
assume A69: x in ( divset (( T . k ),i) );
then ( abs ( ( f . x ) - ( g . x ) ) ) = ( abs ( ( Hn . x ) - ( g . x ) ) ) by FUNCT_1:49;
then ( abs ( ( f . x ) - ( g . x ) ) ) = ( abs ( ( Hn . x ) - ( H0 . x ) ) ) by A69,FUNCT_1:49;
then ( abs ( ( f . x ) - ( g . x ) ) ) = ( abs ( ( ( H . n ) . x ) - ( H0 . x ) ) ) by A64,A69,FUNCT_1:49;
then ( abs ( ( f . x ) - ( g . x ) ) ) = ( abs ( ( ( H . n ) . x ) - ( ( lim (H,AB) ) . x ) ) ) by A64,A69,FUNCT_1:49;
hence ( abs ( ( f . x ) - ( g . x ) ) ) <= e by A55,A59,A64,A69;
end;
( ( R2 - R1 ) . i ) = ( ( R2 . i ) - ( R1 . i ) ) by RVSUM_1:27;
then ( ( R2 - R1 ) . i ) = ( ( ( lower_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) - ( ( lower_volume (Hn,( T . k )) ) . i ) ) by A63,INTEGRA1:def 7;
then ( ( R2 - R1 ) . i ) = ( ( ( lower_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) - ( ( lower_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) ) by A63,INTEGRA1:def 7;
then A70: ( ( R2 - R1 ) . i ) = ( ( ( lower_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) - ( lower_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) );
( ( R1 - R2 ) . i ) = ( ( R1 . i ) - ( R2 . i ) ) by RVSUM_1:27;
then ( ( R1 - R2 ) . i ) = ( ( ( lower_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) - ( ( lower_volume (H0,( T . k )) ) . i ) ) by A63,INTEGRA1:def 7;
then ( ( R1 - R2 ) . i ) = ( ( ( lower_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) - ( ( lower_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) ) by A63,INTEGRA1:def 7;
then A71: ( ( R1 - R2 ) . i ) = ( ( ( lower_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) - ( lower_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) );
( Hn | AB ) is  bounded by A6;
then ( f | ( divset (( T . k ),i) ) ) is  bounded_below by A63,INTEGRA1:8,INTEGRA2:6;
then A72: ( rng f ) is  bounded_below by INTEGRA1:11;
( g | ( divset (( T . k ),i) ) ) is  bounded_below by A19,A63,INTEGRA1:8,INTEGRA2:6;
then A73: ( rng g ) is  bounded_below by INTEGRA1:11;
then ( ( lower_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) - ( lower_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) ) <= ( lower_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) by A72,A67,A68,CKB2:1;
then ( ( R1 - R2 ) . i ) <= ( ( lower_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) by A71,A65,XREAL_1:64;
hence ( ( R1 - R2 ) . i ) <= ( R3 . i ) by A63,INTEGRA1:def 7;
now
let x being set;
assume x in ( divset (( T . k ),i) );
then ( abs ( ( f . x ) - ( g . x ) ) ) <= ( lower_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) by A67,A68;
hence ( abs ( ( g . x ) - ( f . x ) ) ) <= ( lower_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) by COMPLEX1:60;
end;
then ( ( lower_bound ( rng ( H0 | ( divset (( T . k ),i) ) ) ) ) - ( lower_bound ( rng ( Hn | ( divset (( T . k ),i) ) ) ) ) ) <= ( lower_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) by A72,A73,CKB2:1;
then ( ( R2 - R1 ) . i ) <= ( ( lower_bound ( rng ( H1 | ( divset (( T . k ),i) ) ) ) ) * ( vol ( divset (( T . k ),i) ) ) ) by A70,A65,XREAL_1:64;
hence thesis by A63,INTEGRA1:def 7;
end;
( ( ( lower_sum (Hn,T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) = ( ( lower_sum (Hn,( T . k )) ) - ( ( lower_sum (H0,T) ) . k ) ) by INTEGRA2:def 3;
then ( ( ( lower_sum (Hn,T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) = ( ( lower_sum (Hn,( T . k )) ) - ( lower_sum (H0,( T . k )) ) ) by INTEGRA2:def 3;
then A74: ( ( ( lower_sum (Hn,T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) = ( Sum ( R1 - R2 ) ) by RVSUM_1:90;
A75: ( vol AB ) = ( b - a ) by A1,INTEGRA6:5;
( upper_bound ( rng H1 ) ) = e by A56,SEQ_4:9;
then ( upper_sum (H1,( T . k )) ) <= ( e * ( b - a ) ) by A57,A75,INTEGRA1:27;
then A76: ( lower_sum (H1,( T . k )) ) <= ( e * ( b - a ) ) by A58,XXREAL_0:2;
( ( ( lower_sum (H0,T) ) . k ) - ( ( lower_sum (Hn,T) ) . k ) ) = ( ( lower_sum (H0,( T . k )) ) - ( ( lower_sum (Hn,T) ) . k ) ) by INTEGRA2:def 3;
then ( ( ( lower_sum (H0,T) ) . k ) - ( ( lower_sum (Hn,T) ) . k ) ) = ( ( lower_sum (H0,( T . k )) ) - ( lower_sum (Hn,( T . k )) ) ) by INTEGRA2:def 3;
then A77: ( ( ( lower_sum (H0,T) ) . k ) - ( ( lower_sum (Hn,T) ) . k ) ) = ( Sum ( R2 - R1 ) ) by RVSUM_1:90;
A78: ( Seg l0 ) = ( dom Tk ) by FINSEQ_1:def 3;
then (for i being Nat holds (i in ( Seg l0 ) implies ( ( R2 - R1 ) . i ) <= ( R3 . i ))) by A60;
then ( ( ( lower_sum (H0,T) ) . k ) - ( ( lower_sum (Hn,T) ) . k ) ) <= ( Sum R3 ) by A77,RVSUM_1:82;
then ( ( ( lower_sum (H0,T) ) . k ) - ( ( lower_sum (Hn,T) ) . k ) ) <= ( e * ( b - a ) ) by A76,XXREAL_0:2;
then A79: ( - ( e * ( b - a ) ) ) <= ( - ( ( ( lower_sum (H0,T) ) . k ) - ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) ) ) by XREAL_1:24;
(for i being Nat holds (i in ( Seg l0 ) implies ( ( R1 - R2 ) . i ) <= ( R3 . i ))) by A78,A60;
then ( ( ( lower_sum (Hn,T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) <= ( lower_sum (H1,( T . k )) ) by A74,RVSUM_1:82;
then ( ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) <= ( e * ( b - a ) ) by A76,XXREAL_0:2;
hence ( abs ( ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) ) <= ( e * ( b - a ) ) by A79,ABSVALUE:5;
end;
end;
A80: (for e being (Element of ( REAL )) holds (( 0 ) < e implies (ex N being (Element of ( NAT )) st (for n,k being (Element of ( NAT )) holds (N <= n implies ( abs ( ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) ) <= e)))))
proof
let e being (Element of ( REAL ));
assume ( 0 ) < e;
then consider N being (Element of ( NAT )) such that A81: (for n,k being (Element of ( NAT )) holds (N <= n implies ( abs ( ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) ) <= ( ( e / ( b - a ) ) * ( b - a ) ))) by A54,A8,XREAL_1:139;
take N;
hereby
let n being (Element of ( NAT ));
let k being (Element of ( NAT ));
assume N <= n;
then ( abs ( ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) ) <= ( ( e / ( b - a ) ) * ( b - a ) ) by A81;
hence ( abs ( ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) ) <= e by A8,XCMPLX_1:87;
end;
end;
A82: (for e being (Element of ( REAL )) holds (( 0 ) < e implies (ex N being (Element of ( NAT )) st (for n being (Element of ( NAT )) holds (N <= n implies ( abs ( ( lower_integral ( ( H . n ) || AB ) ) - ( lower_integral ( ( lim (H,AB) ) || AB ) ) ) ) <= e)))))
proof
let e being (Element of ( REAL ));
assume ( 0 ) < e;
then consider N being (Element of ( NAT )) such that A83: (for n,k being (Element of ( NAT )) holds (N <= n implies ( abs ( ( ( lower_sum (( ( H . n ) || AB ),T) ) . k ) - ( ( lower_sum (H0,T) ) . k ) ) ) <= e)) by A80;
take N;
hereby
let n being (Element of ( NAT ));
set LHT = ( lower_sum (( ( H . n ) || AB ),T) );
assume A84: N <= n;
A85:now
let k being (Element of ( NAT ));
( abs ( ( LHT . k ) - ( ( lower_sum (H0,T) ) . k ) ) ) <= e by A83,A84;
then ( abs ( ( LHT . k ) + ( ( - ( lower_sum (H0,T) ) ) . k ) ) ) <= e by SEQ_1:10;
then ( abs ( ( LHT + ( - ( lower_sum (H0,T) ) ) ) . k ) ) <= e by SEQ_1:7;
hence ( ( abs ( LHT - ( lower_sum (H0,T) ) ) ) . k ) <= e by SEQ_1:12;
end;
A86: LHT is  convergent by A6;
then ( lim ( LHT - ( lower_sum (H0,T) ) ) ) = ( ( lim LHT ) - ( lim ( lower_sum (H0,T) ) ) ) by A53,SEQ_2:12;
then ( lim ( LHT - ( lower_sum (H0,T) ) ) ) = ( ( lower_integral ( ( H . n ) || AB ) ) - ( lim ( lower_sum (H0,T) ) ) ) by A6;
then A87: ( lim ( LHT - ( lower_sum (H0,T) ) ) ) = ( ( lower_integral ( ( H . n ) || AB ) ) - ( lower_integral ( ( lim (H,AB) ) || AB ) ) ) by A4,A18,A19,A12,INTEGRA4:8;
A88: ( LHT - ( lower_sum (H0,T) ) ) is  convergent by A53,A86,SEQ_2:11;
then ( abs ( LHT - ( lower_sum (H0,T) ) ) ) is  convergent by SEQ_4:13;
then ( lim ( abs ( LHT - ( lower_sum (H0,T) ) ) ) ) <= e by A85,PREPOWER:2;
hence ( abs ( ( lower_integral ( ( H . n ) || AB ) ) - ( lower_integral ( ( lim (H,AB) ) || AB ) ) ) ) <= e by A87,A88,SEQ_4:14;
end;
end;
A89:now
let e1 being (Element of ( REAL ));
set e = ( e1 / 2 );
assume A90: ( 0 ) < e1;
then A91: ( 0 ) < ( e1 / 2 ) by XREAL_1:215;
then consider N1 being (Element of ( NAT )) such that A92: (for n being (Element of ( NAT )) holds (N1 <= n implies ( abs ( ( upper_integral ( ( H . n ) || AB ) ) - ( upper_integral ( ( lim (H,AB) ) || AB ) ) ) ) <= ( e / 2 ))) by A45,XREAL_1:215;
consider N2 being (Element of ( NAT )) such that A93: (for n being (Element of ( NAT )) holds (N2 <= n implies ( abs ( ( lower_integral ( ( H . n ) || AB ) ) - ( lower_integral ( ( lim (H,AB) ) || AB ) ) ) ) <= ( e / 2 ))) by A82,A91,XREAL_1:215;
reconsider n = ( max (N1,N2) ) as (Element of ( NAT )) by XXREAL_0:16;
set K = ( upper_integral ( ( H . n ) || AB ) );
set L = ( lower_integral ( ( H . n ) || AB ) );
( abs ( L - L1 ) ) <= ( e / 2 ) by A93,XXREAL_0:25;
then A94: ( abs ( K - L1 ) ) <= ( e / 2 ) by A6;
( ( K - K1 ) - ( K - L1 ) ) = ( L1 - K1 );
then A95: ( abs ( L1 - K1 ) ) <= ( ( abs ( K - K1 ) ) + ( abs ( K - L1 ) ) ) by COMPLEX1:57;
( abs ( K - K1 ) ) <= ( e / 2 ) by A92,XXREAL_0:25;
then ( ( abs ( K - K1 ) ) + ( abs ( K - L1 ) ) ) <= ( ( e / 2 ) + ( e / 2 ) ) by A94,XREAL_1:7;
then A96: ( abs ( L1 - K1 ) ) <= e by A95,XXREAL_0:2;
( e1 / 2 ) < e1 by A90,XREAL_1:216;
hence ( abs ( L1 - K1 ) ) < e1 by A96,XXREAL_0:2;
end;
A97:now
assume K1 <> L1;
then ( 0 ) < ( abs ( L1 - K1 ) ) by COMPLEX1:62;
hence contradiction by A89;
end;
(H0 is  upper_integrable & H0 is  lower_integrable) by A18,A19,A12,INTEGRA4:10;
then ( ( lim (H,AB) ) || AB ) is  integrable by A97,INTEGRA1:def 16;
hence ( lim (H,AB) ) is_integrable_on AB by INTEGRA5:def 1;
A98: (for p being  real number holds (( 0 ) < p implies (ex n being (Element of ( NAT )) st (for m being (Element of ( NAT )) holds (n <= m implies ( abs ( ( rseq . m ) - ( integral (( lim (H,AB) ),a,b) ) ) ) < p)))))
proof
let p being  real number;
set e = ( p / 2 );
assume A99: ( 0 ) < p;
then consider N being (Element of ( NAT )) such that A100: (for n being (Element of ( NAT )) holds (N <= n implies ( abs ( ( upper_integral ( ( H . n ) || AB ) ) - ( upper_integral ( ( lim (H,AB) ) || AB ) ) ) ) <= e)) by A45,XREAL_1:215;
take N;
A101: ( p / 2 ) < p by A99,XREAL_1:216;
hereby
let n being (Element of ( NAT ));
( upper_integral ( ( H . n ) || AB ) ) = ( integral ( ( H . n ) || AB ) );
then A102: ( upper_integral ( ( H . n ) || AB ) ) = ( rseq . n ) by A6;
( upper_integral ( ( lim (H,AB) ) || AB ) ) = ( integral (( lim (H,AB) ),AB) );
then A103: ( upper_integral ( ( lim (H,AB) ) || AB ) ) = ( integral (( lim (H,AB) ),a,b) ) by A1,INTEGRA5:def 4;
assume N <= n;
then ( abs ( ( upper_integral ( ( H . n ) || AB ) ) - ( upper_integral ( ( lim (H,AB) ) || AB ) ) ) ) <= e by A100;
hence ( abs ( ( rseq . n ) - ( integral (( lim (H,AB) ),a,b) ) ) ) < p by A101,A102,A103,XXREAL_0:2;
end;
end;
hence rseq is  convergent by SEQ_2:def 6;
hence thesis by A98,SEQ_2:def 7;
end;
