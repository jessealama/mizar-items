environ
vocabularies NUMBERS,ALGSTR_0,STRUCT_0,SUBSET_1,BINOP_1,FUNCT_1,ZFMISC_1,XBOOLE_0,XREAL_0,ORDINAL1,RELAT_1,REAL_1,ARYTM_3,SUPINF_2,FUNCT_5,MCART_1,ARYTM_1,CARD_1,FINSEQ_1,ORDINAL4,CARD_3,TARSKI,XXREAL_0,FUNCOP_1,NAT_1,VALUED_0,RLVECT_1,PARTFUN1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,RELAT_1,FUNCT_1,FUNCT_2,BINOP_1,FUNCOP_1,REAL_1,FINSEQ_1,NAT_1,FUNCT_3,FUNCT_5,FINSEQ_4,STRUCT_0,ALGSTR_0,CKB1,CKB3,CKB5,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB20,CKB21,CKB25,CKB27;
definitions FUNCT_1,TARSKI,STRUCT_0,RELAT_1,ALGSTR_0,CKB5,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB25,CKB27;
theorems FUNCT_1,NAT_1,TARSKI,RELAT_1,STRUCT_0,XBOOLE_0,XBOOLE_1,FINSEQ_1,XCMPLX_0,FUNCOP_1,XREAL_1,XXREAL_0,ORDINAL1,ALGSTR_0,CARD_1,FINSEQ_3,XREAL_0,CKB4,CKB5,CKB6,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61;
schemes FINSEQ_1,FUNCT_2,NAT_1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,STRUCT_0,REAL_1,ALGSTR_0,FINSEQ_1,CARD_1,ZFMISC_1,FUNCT_1,RELAT_1,CKB1,CKB2,CKB7,CKB16,CKB17,CKB18,CKB19;
constructors BINOP_1,FUNCOP_1,XXREAL_0,REAL_1,NAT_1,FINSEQ_1,FUNCT_3,FUNCT_5,ALGSTR_0,REALSET1,RELSET_1,FINSEQ_4,VALUED_0,CKB1,CKB5,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB21;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
reserve V for non empty addLoopStr;
reserve f for (Function of ( NAT ),V);
reserve f9 for (Function of ( NAT ),V);
reserve v for (Element of V);
reserve u for (Element of V);
reserve j for (Element of ( NAT ));
reserve k for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
definition
let V;
let F being (the carrier of V) -valued FinSequence;
func Sum F -> (Element of V)
means
:Def15: (ex f st ((it = ( f . ( len F ) ) & ( f . ( 0 ) ) = ( 0. V )) & (for j holds (for v holds ((j < ( len F ) & v = ( F . ( j + 1 ) )) implies ( f . ( j + 1 ) ) = ( ( f . j ) + v ))))));
existence
proof
defpred P[ set ]
 means
(for F being (the carrier of V) -valued FinSequence holds (( len F ) = $1 implies (ex u st (ex f st ((u = ( f . ( len F ) ) & ( f . ( 0 ) ) = ( 0. V )) & (for j holds (for v holds ((j < ( len F ) & v = ( F . ( j + 1 ) )) implies ( f . ( j + 1 ) ) = ( ( f . j ) + v )))))))));
A23: (for n being (Element of ( NAT )) holds (P[ n ] implies P[ ( n + 1 ) ]))
proof
let n;
assume A1: (for F being (the carrier of V) -valued FinSequence holds (( len F ) = n implies (ex u st (ex f st ((u = ( f . ( len F ) ) & ( f . ( 0 ) ) = ( 0. V )) & (for j holds (for v holds ((j < ( len F ) & v = ( F . ( j + 1 ) )) implies ( f . ( j + 1 ) ) = ( ( f . j ) + v )))))))));
let F being (the carrier of V) -valued FinSequence;
A2: ( rng F ) c= (the carrier of V) by RELAT_1:def 19;
then reconsider F1 = F as (FinSequence of V) by FINSEQ_1:def 4;
reconsider G = ( F1 | ( Seg n ) ) as (FinSequence of V) by FINSEQ_1:18;
assume A3: ( len F ) = ( n + 1 );
then ( dom F ) = ( Seg ( n + 1 ) ) by FINSEQ_1:def 3;
then ( n + 1 ) in ( dom F ) by FINSEQ_1:4;
then ( F . ( n + 1 ) ) in ( rng F ) by FUNCT_1:def 3;
then reconsider u1 = ( F . ( n + 1 ) ) as (Element of V) by A2;
A4: n < ( n + 1 ) by NAT_1:13;
then consider u,f such that u = ( f . ( len G ) ) and A5: ( f . ( 0 ) ) = ( 0. V ) and A6: (for j holds (for v holds ((j < ( len G ) & v = ( G . ( j + 1 ) )) implies ( f . ( j + 1 ) ) = ( ( f . j ) + v )))) by A1,A3,FINSEQ_1:17;
defpred P[ set,set ]
 means
(for j holds ($1 = j implies ((j < ( n + 1 ) implies $2 = ( f . $1 )) & (( n + 1 ) <= j implies (for u holds (u = ( F . ( n + 1 ) ) implies $2 = ( ( f . ( len G ) ) + u )))))));
A7: (for k being (Element of (( NAT ) qua non empty set)) holds (ex v being (Element of V) st P[ k,v ]))
proof
let k being (Element of (( NAT ) qua non empty set));
reconsider i = k as (Element of ( NAT ));
A8:now
assume A9: ( n + 1 ) <= i;
take v = ( ( f . ( len G ) ) + u1 );
let j;
assume k = j;
hence (j < ( n + 1 ) implies v = ( f . k )) by A9;
assume ( n + 1 ) <= j;
let u2 being (Element of V);
assume u2 = ( F . ( n + 1 ) );
hence v = ( ( f . ( len G ) ) + u2 );
end;
now
assume A10: i < ( n + 1 );
take v = ( f . k );
let j;
assume that
A11: k = j;
thus (j < ( n + 1 ) implies v = ( f . k ));
thus (( n + 1 ) <= j implies (for u holds (u = ( F . ( n + 1 ) ) implies v = ( ( f . ( len G ) ) + u )))) by A10,A11;
end;
hence thesis by A8;
end;
consider f9 being (Function of (( NAT ) qua non empty set),(the carrier of V)) such that A12: (for k being (Element of (( NAT ) qua non empty set)) holds P[ k,( f9 . k ) ]) from FUNCT_2:sch 3(A7);
take z = ( f9 . ( n + 1 ) );
take f99 = f9;
thus z = ( f99 . ( len F ) ) by A3;
thus ( f99 . ( 0 ) ) = ( 0. V ) by A5,A12;
let j;
let v;
assume that
A13: j < ( len F )
and
A14: v = ( F . ( j + 1 ) );
A15: ( len G ) = n by A3,A4,FINSEQ_1:17;
A16:now
assume A17: j = n;
then ( f99 . ( j + 1 ) ) = ( ( f . j ) + v ) by A15,A12,A14;
hence ( f99 . ( j + 1 ) ) = ( ( f99 . j ) + v ) by A4,A12,A17;
end;
A18:now
assume A19: j < n;
then A20: ( j + 1 ) < ( n + 1 ) by XREAL_1:6;
(1 <= ( 1 + j ) & ( j + 1 ) <= n) by A19,NAT_1:11,NAT_1:13;
then ( j + 1 ) in ( Seg n ) by FINSEQ_1:1;
then A21: v = ( G . ( j + 1 ) ) by A14,FUNCT_1:49;
j < ( len G ) by A3,A4,A19,FINSEQ_1:17;
then A22: ( f . ( j + 1 ) ) = ( ( f . j ) + v ) by A6,A21;
j < ( n + 1 ) by A19,NAT_1:13;
then ( f . ( j + 1 ) ) = ( ( f9 . j ) + v ) by A12,A22;
hence ( f99 . ( j + 1 ) ) = ( ( f99 . j ) + v ) by A12,A20;
end;
j <= n by A3,A13,NAT_1:13;
hence ( f99 . ( j + 1 ) ) = ( ( f99 . j ) + v ) by A18,A16,XXREAL_0:1;
end;
A25: P[ ( 0 ) ]
proof
reconsider f = ( ( NAT ) --> ( 0. V ) ) as (Function of ( NAT ),(the carrier of V));
let F being (the carrier of V) -valued FinSequence;
assume A24: ( len F ) = ( 0 );
take u = ( f . ( len F ) );
take f9 = f;
thus (u = ( f9 . ( len F ) ) & ( f9 . ( 0 ) ) = ( 0. V )) by FUNCOP_1:7;
let j;
thus (for v holds ((j < ( len F ) & v = ( F . ( j + 1 ) )) implies ( f9 . ( j + 1 ) ) = ( ( f9 . j ) + v ))) by A24;
end;
(for n holds P[ n ]) from NAT_1:sch 1(A25,A23);
hence thesis;
end;
uniqueness
proof
let v1 being (Element of V),v2 being (Element of V);
given f such that
A26: v1 = ( f . ( len F ) )
and
A27: ( f . ( 0 ) ) = ( 0. V )
and
A28: (for j holds (for v holds ((j < ( len F ) & v = ( F . ( j + 1 ) )) implies ( f . ( j + 1 ) ) = ( ( f . j ) + v ))));

given f9 such that
A29: v2 = ( f9 . ( len F ) )
and
A30: ( f9 . ( 0 ) ) = ( 0. V )
and
A31: (for j holds (for v holds ((j < ( len F ) & v = ( F . ( j + 1 ) )) implies ( f9 . ( j + 1 ) ) = ( ( f9 . j ) + v ))));

defpred P[ (Element of ( NAT )) ]
 means
($1 <= ( len F ) implies ( f . $1 ) = ( f9 . $1 ));
now
A32: ( rng F ) c= (the carrier of V) by RELAT_1:def 19;
let k;
assume A33: (k <= ( len F ) implies ( f . k ) = ( f9 . k ));
assume A34: ( k + 1 ) <= ( len F );
(1 <= ( k + 1 ) & ( dom F ) = ( Seg ( len F ) )) by FINSEQ_1:def 3,NAT_1:11;
then ( k + 1 ) in ( dom F ) by A34,FINSEQ_1:1;
then ( F . ( k + 1 ) ) in ( rng F ) by FUNCT_1:def 3;
then reconsider u1 = ( F . ( k + 1 ) ) as (Element of V) by A32;
A35: k < ( len F ) by A34,NAT_1:13;
then ( f . ( k + 1 ) ) = ( ( f . k ) + u1 ) by A28;
hence ( f . ( k + 1 ) ) = ( f9 . ( k + 1 ) ) by A31,A33,A35;
end;
then A36: (for k holds (P[ k ] implies P[ ( k + 1 ) ]));
A37: P[ ( 0 ) ] by A27,A30;
(for k holds P[ k ]) from NAT_1:sch 1(A37,A36);
hence thesis by A26,A29;
end;
end;
