environ
vocabularies NUMBERS,REAL_1,SUBSET_1,RCOMP_1,SEQ_1,PARTFUN1,VALUED_0,SEQ_2,ORDINAL2,CARD_1,ARYTM_3,FUNCT_1,RELAT_1,FUNCOP_1,VALUED_1,FUNCT_2,NAT_1,TARSKI,ARYTM_1,XREAL_0,ORDINAL1,XXREAL_1,XBOOLE_0,XXREAL_0,COMPLEX1,FCONT_1,XXREAL_2,FDIFF_1;
notations TARSKI,XBOOLE_0,SUBSET_1,ORDINAL1,NUMBERS,XCMPLX_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,FUNCT_2,FUNCOP_1,VALUED_0,VALUED_1,SEQ_1,SEQ_2,RELSET_1,PARTFUN1,PARTFUN2,RCOMP_1,FCONT_1,XXREAL_0,CKB2,CKB4,CKB6,CKB7,CKB9,CKB16;
definitions TARSKI,FCONT_1,XBOOLE_0,VALUED_1,RCOMP_1,SUBSET_1,CKB2,CKB4,CKB7,CKB16;
theorems TARSKI,NAT_1,FUNCT_1,ABSVALUE,ZFMISC_1,SEQ_1,SEQ_2,SEQM_3,SEQ_4,PARTFUN1,PARTFUN2,RFUNCT_1,RFUNCT_2,RCOMP_1,FCONT_1,FUNCT_2,RELAT_1,XREAL_0,XBOOLE_0,XBOOLE_1,XCMPLX_0,XCMPLX_1,FUNCOP_1,XREAL_1,COMPLEX1,VALUED_1,VALUED_0,ORDINAL1,CKB1,CKB2,CKB4,CKB7,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16;
schemes SEQ_1;
registrations FUNCT_1,ORDINAL1,RELSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,MEMBERED,RCOMP_1,VALUED_0,VALUED_1,FUNCT_2,FUNCOP_1,SEQ_4,REALSET1,SETFAM_1,RELAT_1,ZFMISC_1,CARD_1,FINSET_1,CKB3,CKB5,CKB8;
constructors PARTFUN1,REAL_1,NAT_1,COMPLEX1,SEQ_2,SEQM_3,RCOMP_1,PARTFUN2,RFUNCT_2,FCONT_1,VALUED_1,SEQ_1,REALSET1,FINSET_1,SETFAM_1,RELSET_1,BINOP_2,RVSUM_1,CKB2,CKB4,CKB7,CKB16;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve x for Real;
reserve x0 for Real;
reserve g for Real;
reserve r for Real;
reserve r1 for Real;
reserve s for Real;
reserve p for Real;
reserve p1 for Real;
reserve n for (Element of ( NAT ));
reserve s1 for Real_Sequence;
reserve f for (PartFunc of ( REAL ),( REAL ));
reserve R for REST;
reserve R1 for REST;
reserve L for LINEAR;
reserve L1 for LINEAR;
definition
let f;
let x0 being  real number;
assume A1: f is_differentiable_in x0;
func diff (f,x0) -> Real means 
:Def6: (ex N being (Neighbourhood of x0) st (N c= ( dom f ) & (ex L st (ex R st (it = ( L . 1 ) & (for x holds (x in N implies ( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) ))))))));
existence
proof
consider N being (Neighbourhood of x0) such that A2: N c= ( dom f ) and A3: (ex L st (ex R st (for x holds (x in N implies ( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) ))))) by A1,CKB16:def 1;
consider L,R such that A4: (for x holds (x in N implies ( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) ))) by A3;
consider r such that A5: (for p holds ( L . p ) = ( r * p )) by CKB7:def 1;
take r;
( L . 1 ) = ( r * 1 ) by A5
.= r;
hence thesis by A2,A4;
end;
uniqueness
proof
let r;
let s;
assume that
A6: (ex N being (Neighbourhood of x0) st (N c= ( dom f ) & (ex L st (ex R st (r = ( L . 1 ) & (for x holds (x in N implies ( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) ))))))))
and
A7: (ex N being (Neighbourhood of x0) st (N c= ( dom f ) & (ex L st (ex R st (s = ( L . 1 ) & (for x holds (x in N implies ( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) ))))))));
consider N being (Neighbourhood of x0) such that N c= ( dom f ) and A8: (ex L st (ex R st (r = ( L . 1 ) & (for x holds (x in N implies ( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) )))))) by A6;
consider L,R such that A9: r = ( L . 1 ) and A10: (for x holds (x in N implies ( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) ))) by A8;
consider r1 such that A11: (for p holds ( L . p ) = ( r1 * p )) by CKB7:def 1;
consider N1 being (Neighbourhood of x0) such that N1 c= ( dom f ) and A12: (ex L st (ex R st (s = ( L . 1 ) & (for x holds (x in N1 implies ( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) )))))) by A7;
consider L1,R1 such that A13: s = ( L1 . 1 ) and A14: (for x holds (x in N1 implies ( ( f . x ) - ( f . x0 ) ) = ( ( L1 . ( x - x0 ) ) + ( R1 . ( x - x0 ) ) ))) by A12;
consider p1 such that A15: (for p holds ( L1 . p ) = ( p1 * p )) by CKB7:def 1;
consider N0 being (Neighbourhood of x0) such that A16: (N0 c= N & N0 c= N1) by RCOMP_1:17;
consider g being  real number such that A17: ( 0 ) < g and A18: N0 = ]. ( x0 - g ),( x0 + g ) .[ by RCOMP_1:def 6;
deffunc F((Element of ( NAT ))) = ( g / ( $1 + 2 ) );
consider s1 such that A19: (for n holds ( s1 . n ) = F(n)) from SEQ_1:sch 1;
now
let n;
( 0 ) <> ( g / ( n + 2 ) ) by A17,XREAL_1:139;
hence ( 0 ) <> ( s1 . n ) by A19;
end;
then A20: s1 is  non-zero by SEQ_1:5;
(s1 is  convergent & ( lim s1 ) = ( 0 )) by A19,SEQ_4:31;
then reconsider h = s1 as  convergent_to_0 Real_Sequence by A20,CKB2:def 1;
A21: (for n holds (ex x st ((x in N & x in N1) & ( h . n ) = ( x - x0 ))))
proof
let n;
take ( x0 + ( g / ( n + 2 ) ) );
( ( 0 ) + 1 ) < ( ( n + 1 ) + 1 ) by XREAL_1:6;
then ( g / ( n + 2 ) ) < ( g / 1 ) by A17,XREAL_1:76;
then A22: ( x0 + ( g / ( n + 2 ) ) ) < ( x0 + g ) by XREAL_1:6;
( 0 ) < ( g / ( n + 2 ) ) by A17,XREAL_1:139;
then ( x0 + ( - g ) ) < ( x0 + ( g / ( n + 2 ) ) ) by A17,XREAL_1:6;
then ( x0 + ( g / ( n + 2 ) ) ) in ]. ( x0 - g ),( x0 + g ) .[ by A22;
hence thesis by A16,A18,A19;
end;
A23: s = ( p1 * 1 ) by A13,A15;
A24: r = ( r1 * 1 ) by A9,A11;
A25:now
let x;
assume that
A26: x in N
and
A27: x in N1;
( ( f . x ) - ( f . x0 ) ) = ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) ) by A10,A26;
then ( ( L . ( x - x0 ) ) + ( R . ( x - x0 ) ) ) = ( ( L1 . ( x - x0 ) ) + ( R1 . ( x - x0 ) ) ) by A14,A27;
then ( ( r1 * ( x - x0 ) ) + ( R . ( x - x0 ) ) ) = ( ( L1 . ( x - x0 ) ) + ( R1 . ( x - x0 ) ) ) by A11;
hence ( ( r * ( x - x0 ) ) + ( R . ( x - x0 ) ) ) = ( ( s * ( x - x0 ) ) + ( R1 . ( x - x0 ) ) ) by A15,A24,A23;
end;
now
R1 is  total by CKB4:def 1;
then ( dom R1 ) = ( REAL ) by PARTFUN1:def 2;
then A28: ( rng h ) c= ( dom R1 );
let n being Nat;
R is  total by CKB4:def 1;
then ( dom R ) = ( REAL ) by PARTFUN1:def 2;
then A29: ( rng h ) c= ( dom R );
A30: n in ( NAT ) by ORDINAL1:def 12;
then (ex x st ((x in N & x in N1) & ( h . n ) = ( x - x0 ))) by A21;
then ( ( r * ( h . n ) ) + ( R . ( h . n ) ) ) = ( ( s * ( h . n ) ) + ( R1 . ( h . n ) ) ) by A25;
then A31: ( ( ( r * ( h . n ) ) / ( h . n ) ) + ( ( R . ( h . n ) ) / ( h . n ) ) ) = ( ( ( s * ( h . n ) ) + ( R1 . ( h . n ) ) ) / ( h . n ) ) by XCMPLX_1:62;
A32: ( ( R . ( h . n ) ) / ( h . n ) ) = ( ( R . ( h . n ) ) * ( ( h . n ) " ) ) by XCMPLX_0:def 9
.= ( ( R . ( h . n ) ) * ( ( h " ) . n ) ) by VALUED_1:10
.= ( ( ( R /* h ) . n ) * ( ( h " ) . n ) ) by A30,A29,FUNCT_2:108
.= ( ( ( h " ) (#) ( R /* h ) ) . n ) by A30,SEQ_1:8;
h is  non-zero by CKB2:def 1;
then A33: ( h . n ) <> ( 0 ) by A30,SEQ_1:5;
A34: ( ( R1 . ( h . n ) ) / ( h . n ) ) = ( ( R1 . ( h . n ) ) * ( ( h . n ) " ) ) by XCMPLX_0:def 9
.= ( ( R1 . ( h . n ) ) * ( ( h " ) . n ) ) by VALUED_1:10
.= ( ( ( R1 /* h ) . n ) * ( ( h " ) . n ) ) by A30,A28,FUNCT_2:108
.= ( ( ( h " ) (#) ( R1 /* h ) ) . n ) by A30,SEQ_1:8;
A35: ( ( s * ( h . n ) ) / ( h . n ) ) = ( s * ( ( h . n ) / ( h . n ) ) ) by XCMPLX_1:74
.= ( s * 1 ) by A33,XCMPLX_1:60
.= s;
( ( r * ( h . n ) ) / ( h . n ) ) = ( r * ( ( h . n ) / ( h . n ) ) ) by XCMPLX_1:74
.= ( r * 1 ) by A33,XCMPLX_1:60
.= r;
then ( r + ( ( R . ( h . n ) ) / ( h . n ) ) ) = ( s + ( ( R1 . ( h . n ) ) / ( h . n ) ) ) by A31,A35,XCMPLX_1:62;
then r = ( s + ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) ) by A32,A34;
hence ( r - s ) = ( ( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) . n ) by A30,RFUNCT_2:1;
end;
then (( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) is  constant & ( ( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) . 1 ) = ( r - s )) by VALUED_0:def 18;
then A36: ( lim ( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) ) = ( r - s ) by SEQ_4:25;
A37: (( ( h " ) (#) ( R1 /* h ) ) is  convergent & ( lim ( ( h " ) (#) ( R1 /* h ) ) ) = ( 0 )) by CKB4:def 1;
(( ( h " ) (#) ( R /* h ) ) is  convergent & ( lim ( ( h " ) (#) ( R /* h ) ) ) = ( 0 )) by CKB4:def 1;
then ( r - s ) = ( ( 0 ) - ( 0 ) ) by A36,A37,SEQ_2:12;
hence thesis;
end;
end;
