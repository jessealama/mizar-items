environ
vocabularies NUMBERS,ORDINAL1,INT_1,XREAL_0,RAT_1,PARTFUN1,PREPOWER,FUNCT_1,REAL_1,SUBSET_1,ARYTM_3,RELAT_1,CARD_1,NEWTON,COMPLEX1,XXREAL_0,FDIFF_1,ARYTM_1,RCOMP_1,TARSKI,XBOOLE_0,VALUED_1,SIN_COS,SEQ_2,ORDINAL2,FCONT_1,FUNCT_2,POWER,SERIES_1,REALSET1,NAT_1,CARD_3,LIMFUNC1,SEQFUNC,SEQ_1,XXREAL_1,TAYLOR_1,IRRAT_1;
notations TARSKI,XBOOLE_0,SUBSET_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,IRRAT_1,LIMFUNC1,RCOMP_1,FCONT_1,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,RAT_1,ORDINAL1,NUMBERS,REAL_1,NAT_1,INT_1,NEWTON,VALUED_1,PARTFUN2,SEQ_1,SEQ_2,SERIES_1,FDIFF_1,SEQFUNC,PREPOWER,POWER,SIN_COS,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
definitions SUBSET_1,LIMFUNC1,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
theorems XBOOLE_1,ABSVALUE,TARSKI,XBOOLE_0,PARTFUN1,PARTFUN2,XCMPLX_1,RELAT_1,CARD_4,RCOMP_1,SEQ_1,SEQ_2,SIN_COS,SERIES_1,FUNCT_1,NAT_1,INT_1,NEWTON,RAT_1,IRRAT_1,POWER,FCONT_1,FDIFF_1,FDIFF_2,ROLLE,SEQ_4,PREPOWER,FUNCT_2,XREAL_0,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_1,XXREAL_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB23,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37;
schemes SEQ_1,RECDEF_1,NAT_1,INT_1,PARTFUN2,FUNCT_2;
registrations XBOOLE_0,RELSET_1,PARTFUN1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,RAT_1,MEMBERED,RCOMP_1,NEWTON,PREPOWER,SIN_COS,VALUED_0,VALUED_1,FUNCT_2,XXREAL_2,ORDINAL1,SEQ_4,FCONT_3,ABIAN,CKB22,CKB24;
constructors PARTFUN1,ARYTM_0,REAL_1,NAT_1,SEQ_2,RCOMP_1,PARTFUN2,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,SEQFUNC,PREPOWER,COMSEQ_3,SIN_COS,SEQ_1,XXREAL_2,SERIES_1,VALUED_1,POWER,RELSET_1,ABIAN,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve n for  natural number;
reserve x for  real number;
reserve f for (PartFunc of ( REAL ),( REAL ));
theorem
Lm6: (for n being (Element of ( NAT )) holds (for l,b being Real holds (ex g being (PartFunc of ( REAL ),( REAL )) st (( dom g ) = ( [#] ( REAL ) ) & (for x being Real holds (( g . x ) = ( ( l * ( ( b - x ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) & (for x being Real holds (g is_differentiable_in x & ( diff (g,x) ) = ( - ( ( l * ( ( b - x ) |^ n ) ) / ( n ! ) ) )))))))))
proof
defpred X[ set ]
 means
$1 in ( REAL );
let n being (Element of ( NAT ));
let l being Real;
let b being Real;
deffunc U(Real) = ( ( l * ( ( b - $1 ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) );
consider g being (PartFunc of ( REAL ),( REAL )) such that A1: (for d being (Element of ( REAL )) holds (d in ( dom g ) iff X[ d ])) and A2: (for d being (Element of ( REAL )) holds (d in ( dom g ) implies ( g /. d ) = U(d))) from PARTFUN2:sch 2;
take g;
consider f being (PartFunc of ( REAL ),( REAL )) such that A3: ( dom f ) = ( [#] ( REAL ) ) and A4: (for x being Real holds ( f . x ) = ( b - x )) and A5: (for x being Real holds (f is_differentiable_in x & ( diff (f,x) ) = ( - 1 ))) by CKB37:1;
(( dom ( #Z ( n + 1 ) ) ) = ( REAL ) & ( rng f ) c= ( REAL )) by FUNCT_2:def 1;
then A6: ( dom ( ( #Z ( n + 1 ) ) * f ) ) = ( dom f ) by RELAT_1:27;
(for x being set holds (x in ( REAL ) implies x in ( dom g ))) by A1;
then A7: ( REAL ) c= ( dom g ) by TARSKI:def 3;
then A8: ( dom g ) = ( [#] ( REAL ) ) by XBOOLE_0:def 10;
A9: (for d being (Element of ( REAL )) holds ( g . d ) = ( ( l * ( ( b - d ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ))
proof
let d being (Element of ( REAL ));
( g /. d ) = ( ( l * ( ( b - d ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) by A2,A8;
hence thesis by A8,PARTFUN1:def 6;
end;
A10:now
let x being (Element of ( REAL ));
assume x in ( dom ( ( l / ( ( n + 1 ) ! ) ) (#) ( ( #Z ( n + 1 ) ) * f ) ) );
hence ( ( ( l / ( ( n + 1 ) ! ) ) (#) ( ( #Z ( n + 1 ) ) * f ) ) . x ) = ( ( l / ( ( n + 1 ) ! ) ) * ( ( ( #Z ( n + 1 ) ) * f ) . x ) ) by VALUED_1:def 5
.= ( ( l / ( ( n + 1 ) ! ) ) * ( ( ( #Z ( n + 1 ) ) * f ) /. x ) ) by A3,A6,PARTFUN1:def 6
.= ( ( l / ( ( n + 1 ) ! ) ) * ( ( #Z ( n + 1 ) ) /. ( f /. x ) ) ) by A3,A6,PARTFUN2:3
.= ( ( l / ( ( n + 1 ) ! ) ) * ( ( #Z ( n + 1 ) ) . ( f . x ) ) ) by A3,PARTFUN1:def 6
.= ( ( l / ( ( n + 1 ) ! ) ) * ( ( f . x ) #Z ( n + 1 ) ) ) by CKB1:def 1
.= ( ( l / ( ( n + 1 ) ! ) ) * ( ( f . x ) |^ ( n + 1 ) ) ) by PREPOWER:36
.= ( ( l / ( ( n + 1 ) ! ) ) * ( ( b - x ) |^ ( n + 1 ) ) ) by A4
.= ( ( l * ( ( b - x ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) by XCMPLX_1:74
.= ( g . x ) by A9;
end;
A11: (for x being Real holds (( ( #Z ( n + 1 ) ) * f ) is_differentiable_in x & ( diff (( ( #Z ( n + 1 ) ) * f ),x) ) = ( - ( ( n + 1 ) * ( ( b - x ) #Z n ) ) )))
proof
let x being Real;
A12: (f is_differentiable_in x & ( #Z ( n + 1 ) ) is_differentiable_in ( f . x )) by A5,CKB3:1;
hence ( ( #Z ( n + 1 ) ) * f ) is_differentiable_in x by FDIFF_2:13;
( diff (( #Z ( n + 1 ) ),( f . x )) ) = ( ( n + 1 ) * ( ( f . x ) #Z ( ( n + 1 ) - 1 ) ) ) by CKB3:1;
hence ( diff (( ( #Z ( n + 1 ) ) * f ),x) ) = ( ( ( n + 1 ) * ( ( f . x ) #Z ( ( n + 1 ) - 1 ) ) ) * ( diff (f,x) ) ) by A12,FDIFF_2:13
.= ( ( ( n + 1 ) * ( ( f . x ) #Z ( ( n + 1 ) - 1 ) ) ) * ( - 1 ) ) by A5
.= ( ( ( n + 1 ) * ( ( b - x ) #Z ( ( n + 1 ) - 1 ) ) ) * ( - 1 ) ) by A4
.= ( - ( ( n + 1 ) * ( ( b - x ) #Z n ) ) );
end;
A13:now
let x being Real;
A14: ( ( n + 1 ) / ( ( n + 1 ) ! ) ) = ( ( 1 * ( n + 1 ) ) / ( ( n ! ) * ( n + 1 ) ) ) by NEWTON:15
.= ( 1 / ( n ! ) ) by XCMPLX_1:91;
A15: ( ( #Z ( n + 1 ) ) * f ) is_differentiable_in x by A11;
hence ( ( l / ( ( n + 1 ) ! ) ) (#) ( ( #Z ( n + 1 ) ) * f ) ) is_differentiable_in x by FDIFF_1:15;
thus ( diff (( ( l / ( ( n + 1 ) ! ) ) (#) ( ( #Z ( n + 1 ) ) * f ) ),x) ) = ( ( l / ( ( n + 1 ) ! ) ) * ( diff (( ( #Z ( n + 1 ) ) * f ),x) ) ) by A15,FDIFF_1:15
.= ( ( ( diff (( ( #Z ( n + 1 ) ) * f ),x) ) / ( ( n + 1 ) ! ) ) * l ) by XCMPLX_1:75
.= ( l * ( ( - ( ( n + 1 ) * ( ( b - x ) #Z n ) ) ) / ( ( n + 1 ) ! ) ) ) by A11
.= ( l * ( ( - ( ( n + 1 ) * ( ( b - x ) |^ n ) ) ) / ( ( n + 1 ) ! ) ) ) by PREPOWER:36
.= ( ( l * ( - ( ( n + 1 ) * ( ( b - x ) |^ n ) ) ) ) / ( ( n + 1 ) ! ) ) by XCMPLX_1:74
.= ( ( ( - l ) * ( ( n + 1 ) * ( ( b - x ) |^ n ) ) ) / ( ( n + 1 ) ! ) )
.= ( ( - l ) * ( ( ( n + 1 ) * ( ( b - x ) |^ n ) ) / ( ( n + 1 ) ! ) ) ) by XCMPLX_1:74
.= ( ( - l ) * ( ( ( b - x ) |^ n ) * ( ( n + 1 ) / ( ( n + 1 ) ! ) ) ) ) by XCMPLX_1:74
.= ( ( - l ) * ( ( ( b - x ) |^ n ) / ( n ! ) ) ) by A14,XCMPLX_1:99
.= ( - ( l * ( ( ( b - x ) |^ n ) / ( n ! ) ) ) )
.= ( - ( ( l * ( ( b - x ) |^ n ) ) / ( n ! ) ) ) by XCMPLX_1:74;
end;
( dom ( ( l / ( ( n + 1 ) ! ) ) (#) ( ( #Z ( n + 1 ) ) * f ) ) ) = ( dom g ) by A8,A3,A6,VALUED_1:def 5;
then ( ( l / ( ( n + 1 ) ! ) ) (#) ( ( #Z ( n + 1 ) ) * f ) ) = g by A10,PARTFUN1:5;
hence thesis by A7,A9,A13,XBOOLE_0:def 10;
end;
