environ
vocabularies NUMBERS,ORDINAL1,INT_1,XREAL_0,RAT_1,PARTFUN1,PREPOWER,FUNCT_1,REAL_1,SUBSET_1,ARYTM_3,RELAT_1,CARD_1,NEWTON,COMPLEX1,XXREAL_0,FDIFF_1,ARYTM_1,RCOMP_1,TARSKI,XBOOLE_0,VALUED_1,SIN_COS,SEQ_2,ORDINAL2,FCONT_1,FUNCT_2,POWER,SERIES_1,REALSET1,NAT_1,CARD_3,LIMFUNC1,SEQFUNC,SEQ_1,XXREAL_1,TAYLOR_1,IRRAT_1;
notations TARSKI,XBOOLE_0,SUBSET_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,IRRAT_1,LIMFUNC1,RCOMP_1,FCONT_1,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,RAT_1,ORDINAL1,NUMBERS,REAL_1,NAT_1,INT_1,NEWTON,VALUED_1,PARTFUN2,SEQ_1,SEQ_2,SERIES_1,FDIFF_1,SEQFUNC,PREPOWER,POWER,SIN_COS,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
definitions SUBSET_1,LIMFUNC1,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
theorems XBOOLE_1,ABSVALUE,TARSKI,XBOOLE_0,PARTFUN1,PARTFUN2,XCMPLX_1,RELAT_1,CARD_4,RCOMP_1,SEQ_1,SEQ_2,SIN_COS,SERIES_1,FUNCT_1,NAT_1,INT_1,NEWTON,RAT_1,IRRAT_1,POWER,FCONT_1,FDIFF_1,FDIFF_2,ROLLE,SEQ_4,PREPOWER,FUNCT_2,XREAL_0,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_1,XXREAL_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB23,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44;
schemes SEQ_1,RECDEF_1,NAT_1,INT_1,PARTFUN2,FUNCT_2;
registrations XBOOLE_0,RELSET_1,PARTFUN1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,RAT_1,MEMBERED,RCOMP_1,NEWTON,PREPOWER,SIN_COS,VALUED_0,VALUED_1,FUNCT_2,XXREAL_2,ORDINAL1,SEQ_4,FCONT_3,ABIAN,CKB22,CKB24;
constructors PARTFUN1,ARYTM_0,REAL_1,NAT_1,SEQ_2,RCOMP_1,PARTFUN2,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,SEQFUNC,PREPOWER,COMSEQ_3,SIN_COS,SEQ_1,XXREAL_2,SERIES_1,VALUED_1,POWER,RELSET_1,ABIAN,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve n for  natural number;
reserve f for (PartFunc of ( REAL ),( REAL ));
theorem
Th27: (for n being (Element of ( NAT )) holds (for f being (PartFunc of ( REAL ),( REAL )) holds (for Z being (Subset of ( REAL )) holds ((Z c= ( dom f ) & f is_differentiable_on n,Z) implies (for a,b being Real holds ((((a < b & [. a,b .] c= Z) & ( ( ( diff (f,Z) ) . n ) | [. a,b .] ) is  continuous) & f is_differentiable_on ( n + 1 ),]. a,b .[) implies (ex c being Real st (c in ]. a,b .[ & ( f . b ) = ( ( ( Partial_Sums ( Taylor (f,Z,a,b) ) ) . n ) + ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) * ( ( b - a ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) )))))))))
proof
let n being (Element of ( NAT ));
let f being (PartFunc of ( REAL ),( REAL ));
let Z being (Subset of ( REAL ));
assume that
A1: (Z c= ( dom f ) & f is_differentiable_on n,Z);
let a being Real;
let b being Real;
assume that
A2: a < b
and
A3: (([. a,b .] c= Z & ( ( ( diff (f,Z) ) . n ) | [. a,b .] ) is  continuous) & f is_differentiable_on ( n + 1 ),]. a,b .[);
( b - a ) <> ( 0 ) by A2;
then A4: ( ( b - a ) |^ ( n + 1 ) ) <> ( 0 ) by CARD_4:3;
deffunc F(Real) = ( ( f . b ) - ( ( Partial_Sums ( Taylor (f,Z,$1,b) ) ) . n ) );
reconsider l = ( F(a) / ( ( ( b - a ) |^ ( n + 1 ) ) / ( ( n + 1 ) ! ) ) ) as Real;
consider g being (Function of ( REAL ),( REAL )) such that A5: (for x being Real holds ( g . x ) = ( ( ( f . b ) - ( ( Partial_Sums ( Taylor (f,Z,x,b) ) ) . n ) ) - ( ( l * ( ( b - x ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) )) by CKB44:1;
A6: ( ( ( f . b ) - ( ( Partial_Sums ( Taylor (f,Z,a,b) ) ) . n ) ) - ( ( l * ( ( b - a ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) = ( F(a) - ( ( F(a) / ( ( ( b - a ) |^ ( n + 1 ) ) / ( ( n + 1 ) ! ) ) ) * ( ( ( b - a ) |^ ( n + 1 ) ) / ( ( n + 1 ) ! ) ) ) ) by XCMPLX_1:74
.= ( F(a) - F(a) ) by A4,XCMPLX_1:50,XCMPLX_1:87
.= ( 0 );
then A7: ( g . a ) = ( 0 ) by A5;
A8: ( dom g ) = ( REAL ) by FUNCT_2:def 1;
then A9: ( g | [. a,b .] ) is  continuous by A1,A2,A3,A5,A6,CKB43:1;
(g is_differentiable_on ]. a,b .[ & ( g . b ) = ( 0 )) by A1,A2,A3,A5,A6,A8,CKB43:1;
then consider c being Real such that A10: c in ]. a,b .[ and A11: ( diff (g,c) ) = ( 0 ) by A2,A8,A7,A9,ROLLE:1;
c in { r where r is Real: (a < r & r < b) } by A10,RCOMP_1:def 2;
then (ex r being Real st ((c = r & a < r) & r < b));
then ( b - c ) <> ( 0 );
then A12: ( ( b - c ) |^ n ) <> ( 0 ) by CARD_4:3;
( dom g ) = ( REAL ) by FUNCT_2:def 1;
then ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) * ( ( b - c ) |^ n ) ) / ( n ! ) ) ) + ( ( l * ( ( b - c ) |^ n ) ) / ( n ! ) ) ) = ( 0 ) by A1,A2,A3,A5,A6,A10,A11,CKB43:1;
then ( ( ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) * ( ( b - c ) |^ n ) ) / ( n ! ) ) * ( n ! ) ) - ( ( ( l * ( ( b - c ) |^ n ) ) / ( n ! ) ) * ( n ! ) ) ) = ( 0 );
then ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) * ( ( b - c ) |^ n ) ) - ( ( ( l * ( ( b - c ) |^ n ) ) / ( n ! ) ) * ( n ! ) ) ) = ( 0 ) by XCMPLX_1:87;
then ( ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) * ( ( b - c ) |^ n ) ) - ( l * ( ( b - c ) |^ n ) ) ) / ( ( b - c ) |^ n ) ) = ( ( 0 ) / ( ( b - c ) |^ n ) ) by XCMPLX_1:87;
then ( ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) * ( ( b - c ) |^ n ) ) / ( ( b - c ) |^ n ) ) - ( ( l * ( ( b - c ) |^ n ) ) / ( ( b - c ) |^ n ) ) ) = ( 0 ) by XCMPLX_1:120;
then ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) - ( ( l * ( ( b - c ) |^ n ) ) / ( ( b - c ) |^ n ) ) ) = ( 0 ) by A12,XCMPLX_1:89;
then ( ( ( f . b ) - ( ( Partial_Sums ( Taylor (f,Z,a,b) ) ) . n ) ) - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) * ( ( b - a ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) = ( 0 ) by A6,A12,XCMPLX_1:89;
then ( f . b ) = ( ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . c ) * ( ( b - a ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) + ( ( Partial_Sums ( Taylor (f,Z,a,b) ) ) . n ) );
hence thesis by A10;
end;
