environ
vocabularies NUMBERS,ORDINAL1,INT_1,XREAL_0,RAT_1,PARTFUN1,PREPOWER,FUNCT_1,REAL_1,SUBSET_1,ARYTM_3,RELAT_1,CARD_1,NEWTON,COMPLEX1,XXREAL_0,FDIFF_1,ARYTM_1,RCOMP_1,TARSKI,XBOOLE_0,VALUED_1,SIN_COS,SEQ_2,ORDINAL2,FCONT_1,FUNCT_2,POWER,SERIES_1,REALSET1,NAT_1,CARD_3,LIMFUNC1,SEQFUNC,SEQ_1,XXREAL_1,TAYLOR_1,IRRAT_1;
notations TARSKI,XBOOLE_0,SUBSET_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,IRRAT_1,LIMFUNC1,RCOMP_1,FCONT_1,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,RAT_1,ORDINAL1,NUMBERS,REAL_1,NAT_1,INT_1,NEWTON,VALUED_1,PARTFUN2,SEQ_1,SEQ_2,SERIES_1,FDIFF_1,SEQFUNC,PREPOWER,POWER,SIN_COS,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
definitions SUBSET_1,LIMFUNC1,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
theorems XBOOLE_1,ABSVALUE,TARSKI,XBOOLE_0,PARTFUN1,PARTFUN2,XCMPLX_1,RELAT_1,CARD_4,RCOMP_1,SEQ_1,SEQ_2,SIN_COS,SERIES_1,FUNCT_1,NAT_1,INT_1,NEWTON,RAT_1,IRRAT_1,POWER,FCONT_1,FDIFF_1,FDIFF_2,ROLLE,SEQ_4,PREPOWER,FUNCT_2,XREAL_0,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_1,XXREAL_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB23,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52;
schemes SEQ_1,RECDEF_1,NAT_1,INT_1,PARTFUN2,FUNCT_2;
registrations XBOOLE_0,RELSET_1,PARTFUN1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,RAT_1,MEMBERED,RCOMP_1,NEWTON,PREPOWER,SIN_COS,VALUED_0,VALUED_1,FUNCT_2,XXREAL_2,ORDINAL1,SEQ_4,FCONT_3,ABIAN,CKB22,CKB24;
constructors PARTFUN1,ARYTM_0,REAL_1,NAT_1,SEQ_2,RCOMP_1,PARTFUN2,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,SEQFUNC,PREPOWER,COMSEQ_3,SIN_COS,SEQ_1,XXREAL_2,SERIES_1,VALUED_1,POWER,RELSET_1,ABIAN,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve n for  natural number;
reserve x for  real number;
reserve x0 for  real number;
reserve f for (PartFunc of ( REAL ),( REAL ));
theorem
(for n being (Element of ( NAT )) holds (for f being (PartFunc of ( REAL ),( REAL )) holds (for x0,r being Real holds (((]. ( x0 - r ),( x0 + r ) .[ c= ( dom f ) & ( 0 ) < r) & f is_differentiable_on ( n + 1 ),]. ( x0 - r ),( x0 + r ) .[) implies (for x being Real holds (x in ]. ( x0 - r ),( x0 + r ) .[ implies (ex s being Real st ((( 0 ) < s & s < 1) & ( f . x ) = ( ( ( Partial_Sums ( Taylor (f,]. ( x0 - r ),( x0 + r ) .[,x0,x) ) ) . n ) + ( ( ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) . ( x0 + ( s * ( x - x0 ) ) ) ) * ( ( x - x0 ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) )))))))))
proof
let n being (Element of ( NAT ));
let f being (PartFunc of ( REAL ),( REAL ));
let x0 being Real;
let r being Real;
assume that
A1: ]. ( x0 - r ),( x0 + r ) .[ c= ( dom f )
and
A2: ( 0 ) < r
and
A3: f is_differentiable_on ( n + 1 ),]. ( x0 - r ),( x0 + r ) .[;
let x being Real;
assume that
A4: x in ]. ( x0 - r ),( x0 + r ) .[;
now
per cases  by XXREAL_0:1;
case A5: x < x0;
( abs ( x0 - x0 ) ) = ( 0 ) by ABSVALUE:2;
then x0 in ]. ( x0 - r ),( x0 + r ) .[ by A2,RCOMP_1:1;
then A6: [. x,x0 .] c= ]. ( x0 - r ),( x0 + r ) .[ by A4,XXREAL_2:def 12;
n <= ( ( n + 1 ) - 1 );
then ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . n ) is_differentiable_on ]. ( x0 - r ),( x0 + r ) .[ by A3,CKB34:def 1;
then ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . n ) | ]. ( x0 - r ),( x0 + r ) .[ ) is  continuous by FDIFF_1:25;
then A7: ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . n ) | [. x,x0 .] ) is  continuous by A6,FCONT_1:16;
A8: f is_differentiable_on n,]. ( x0 - r ),( x0 + r ) .[ by A3,CKB35:1,NAT_1:11;
set t = ( x0 - x );
A9: t > ( 0 ) by A5,XREAL_1:50;
A10: ]. x,x0 .[ c= [. x,x0 .] by XXREAL_1:25;
then f is_differentiable_on ( n + 1 ),]. x,x0 .[ by A3,A6,CKB51:1,XBOOLE_1:1;
then consider c being Real such that A11: c in ]. x,x0 .[ and A12: ( f . x ) = ( ( ( Partial_Sums ( Taylor (f,]. ( x0 - r ),( x0 + r ) .[,x0,x) ) ) . n ) + ( ( ( ( ( diff (f,]. x,x0 .[) ) . ( n + 1 ) ) . c ) * ( ( x - x0 ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) by A1,A5,A6,A8,A7,CKB49:1;
take s = ( ( x0 - c ) / t );
A13: ( x0 + ( s * ( x - x0 ) ) ) = ( x0 - ( ( ( x0 - c ) / t ) * t ) )
.= ( x0 - ( x0 - c ) ) by A9,XCMPLX_1:87
.= c;
c in { p where p is Real: (( x0 - t ) < p & p < x0) } by A11,RCOMP_1:def 2;
then A14: (ex g being Real st ((g = c & ( x0 - t ) < g) & g < x0));
then ( 0 ) < ( x0 - c ) by XREAL_1:50;
then ( ( 0 ) / t ) < ( ( x0 - c ) / t ) by A9,XREAL_1:74;
hence ( 0 ) < s;
( ( x0 - t ) + t ) < ( c + t ) by A14,XREAL_1:8;
then ( x0 - c ) < t by XREAL_1:19;
then ( ( x0 - c ) / t ) < ( t / t ) by A9,XREAL_1:74;
hence s < 1 by A9,XCMPLX_1:60;
( ( ( diff (f,]. x,x0 .[) ) . ( n + 1 ) ) . c ) = ( ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) | ]. x,x0 .[ ) . c ) by A3,A6,A10,CKB50:1,XBOOLE_1:1
.= ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) . c ) by A11,FUNCT_1:49;
hence ( f . x ) = ( ( ( Partial_Sums ( Taylor (f,]. ( x0 - r ),( x0 + r ) .[,x0,x) ) ) . n ) + ( ( ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) . ( x0 + ( s * ( x - x0 ) ) ) ) * ( ( x - x0 ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) by A12,A13;
end;
case A15: x = x0;
set s = ( 1 / 2 );
take s;
thus (( 0 ) < s & s < 1);
set c = ( x0 + ( s * ( x - x0 ) ) );
thus ( ( ( Partial_Sums ( Taylor (f,]. ( x0 - r ),( x0 + r ) .[,x0,x) ) ) . n ) + ( ( ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) . ( x0 + ( s * ( x - x0 ) ) ) ) * ( ( x - x0 ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) = ( ( f . x ) + ( ( ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) . c ) * ( ( x - x ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) by A4,A15,CKB52:1
.= ( ( f . x ) + ( ( ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) . c ) * ( ( ( 0 ) |^ n ) * ( 0 ) ) ) / ( ( n + 1 ) ! ) ) ) by NEWTON:6
.= ( f . x );
end;
case A16: x > x0;
set t = ( x - x0 );
A17: f is_differentiable_on n,]. ( x0 - r ),( x0 + r ) .[ by A3,CKB35:1,NAT_1:11;
( abs ( x0 - x0 ) ) = ( 0 ) by ABSVALUE:2;
then x0 in ]. ( x0 - r ),( x0 + r ) .[ by A2,RCOMP_1:1;
then A18: [. x0,x .] c= ]. ( x0 - r ),( x0 + r ) .[ by A4,XXREAL_2:def 12;
n <= ( ( n + 1 ) - 1 );
then ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . n ) is_differentiable_on ]. ( x0 - r ),( x0 + r ) .[ by A3,CKB34:def 1;
then ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . n ) | ]. ( x0 - r ),( x0 + r ) .[ ) is  continuous by FDIFF_1:25;
then A19: ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . n ) | [. x0,x .] ) is  continuous by A18,FCONT_1:16;
A20: ]. x0,x .[ c= [. x0,x .] by XXREAL_1:25;
then f is_differentiable_on ( n + 1 ),]. x0,x .[ by A3,A18,CKB51:1,XBOOLE_1:1;
then consider c being Real such that A21: c in ]. x0,x .[ and A22: ( f . x ) = ( ( ( Partial_Sums ( Taylor (f,]. ( x0 - r ),( x0 + r ) .[,x0,x) ) ) . n ) + ( ( ( ( ( diff (f,]. x0,x .[) ) . ( n + 1 ) ) . c ) * ( ( x - x0 ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) by A1,A16,A18,A17,A19,CKB45:1;
take s = ( ( c - x0 ) / t );
A23: t > ( 0 ) by A16,XREAL_1:50;
then A24: ( x0 + ( s * ( x - x0 ) ) ) = ( x0 + ( c - x0 ) ) by XCMPLX_1:87
.= c;
c in { p where p is Real: (x0 < p & p < ( x0 + t )) } by A21,RCOMP_1:def 2;
then A25: (ex g being Real st ((g = c & x0 < g) & g < ( x0 + t )));
then ( 0 ) < ( c - x0 ) by XREAL_1:50;
then ( ( 0 ) / t ) < ( ( c - x0 ) / t ) by A23,XREAL_1:74;
hence ( 0 ) < s;
( c - x0 ) < t by A25,XREAL_1:19;
then ( ( c - x0 ) / t ) < ( t / t ) by A23,XREAL_1:74;
hence s < 1 by A23,XCMPLX_1:60;
( ( ( diff (f,]. x0,x .[) ) . ( n + 1 ) ) . c ) = ( ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) | ]. x0,x .[ ) . c ) by A3,A18,A20,CKB50:1,XBOOLE_1:1
.= ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) . c ) by A21,FUNCT_1:49;
hence ( f . x ) = ( ( ( Partial_Sums ( Taylor (f,]. ( x0 - r ),( x0 + r ) .[,x0,x) ) ) . n ) + ( ( ( ( ( diff (f,]. ( x0 - r ),( x0 + r ) .[) ) . ( n + 1 ) ) . ( x0 + ( s * ( x - x0 ) ) ) ) * ( ( x - x0 ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) by A22,A24;
end;
end;
hence thesis;
end;
