environ
vocabularies NUMBERS,ORDINAL1,INT_1,XREAL_0,RAT_1,PARTFUN1,PREPOWER,FUNCT_1,REAL_1,SUBSET_1,ARYTM_3,RELAT_1,CARD_1,NEWTON,COMPLEX1,XXREAL_0,FDIFF_1,ARYTM_1,RCOMP_1,TARSKI,XBOOLE_0,VALUED_1,SIN_COS,SEQ_2,ORDINAL2,FCONT_1,FUNCT_2,POWER,SERIES_1,REALSET1,NAT_1,CARD_3,LIMFUNC1,SEQFUNC,SEQ_1,XXREAL_1,TAYLOR_1,IRRAT_1;
notations TARSKI,XBOOLE_0,SUBSET_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,IRRAT_1,LIMFUNC1,RCOMP_1,FCONT_1,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,RAT_1,ORDINAL1,NUMBERS,REAL_1,NAT_1,INT_1,NEWTON,VALUED_1,PARTFUN2,SEQ_1,SEQ_2,SERIES_1,FDIFF_1,SEQFUNC,PREPOWER,POWER,SIN_COS,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
definitions SUBSET_1,LIMFUNC1,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
theorems XBOOLE_1,ABSVALUE,TARSKI,XBOOLE_0,PARTFUN1,PARTFUN2,XCMPLX_1,RELAT_1,CARD_4,RCOMP_1,SEQ_1,SEQ_2,SIN_COS,SERIES_1,FUNCT_1,NAT_1,INT_1,NEWTON,RAT_1,IRRAT_1,POWER,FCONT_1,FDIFF_1,FDIFF_2,ROLLE,SEQ_4,PREPOWER,FUNCT_2,XREAL_0,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_1,XXREAL_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB23,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45;
schemes SEQ_1,RECDEF_1,NAT_1,INT_1,PARTFUN2,FUNCT_2;
registrations XBOOLE_0,RELSET_1,PARTFUN1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,RAT_1,MEMBERED,RCOMP_1,NEWTON,PREPOWER,SIN_COS,VALUED_0,VALUED_1,FUNCT_2,XXREAL_2,ORDINAL1,SEQ_4,FCONT_3,ABIAN,CKB22,CKB24;
constructors PARTFUN1,ARYTM_0,REAL_1,NAT_1,SEQ_2,RCOMP_1,PARTFUN2,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,SEQFUNC,PREPOWER,COMSEQ_3,SIN_COS,SEQ_1,XXREAL_2,SERIES_1,VALUED_1,POWER,RELSET_1,ABIAN,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve x for  real number;
reserve y for  real number;
reserve f for (PartFunc of ( REAL ),( REAL ));
theorem
Lm10: (for f being (PartFunc of ( REAL ),( REAL )) holds (for Z being (Subset of ( REAL )) holds (Z c= ( dom f ) implies (for n being (Element of ( NAT )) holds (f is_differentiable_on n,Z implies (for a,b being Real holds ((((a < b & [. a,b .] c= Z) & ( ( ( diff (f,Z) ) . n ) | [. a,b .] ) is  continuous) & f is_differentiable_on ( n + 1 ),]. a,b .[) implies (for g being (PartFunc of ( REAL ),( REAL )) holds ((( dom g ) = Z & (for x being Real holds (x in Z implies ( g . x ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . n ) )))) implies (((( g . a ) = ( 0 ) & ( g | [. a,b .] ) is  continuous) & g is_differentiable_on ]. a,b .[) & (for x being Real holds (x in ]. a,b .[ implies ( diff (g,x) ) = ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) )))))))))))))
proof
let f being (PartFunc of ( REAL ),( REAL ));
let Z being (Subset of ( REAL ));
assume that
A1: Z c= ( dom f );
defpred P[ (Element of ( NAT )) ]
 means
(f is_differentiable_on $1,Z implies (for a,b being Real holds ((((a < b & [. a,b .] c= Z) & ( ( ( diff (f,Z) ) . $1 ) | [. a,b .] ) is  continuous) & f is_differentiable_on ( $1 + 1 ),]. a,b .[) implies (for g being (PartFunc of ( REAL ),( REAL )) holds ((( dom g ) = Z & (for x being Real holds (x in Z implies ( g . x ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . $1 ) )))) implies (((( g . a ) = ( 0 ) & ( g | [. a,b .] ) is  continuous) & g is_differentiable_on ]. a,b .[) & (for x being Real holds (x in ]. a,b .[ implies ( diff (g,x) ) = ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( $1 + 1 ) ) . x ) * ( ( a - x ) |^ $1 ) ) / ( $1 ! ) ) )))))))));
A2: (for k being (Element of ( NAT )) holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being (Element of ( NAT ));
assume that
A3: P[ k ];
assume A4: f is_differentiable_on ( k + 1 ),Z;
let a being Real;
let b being Real;
assume that
A5: a < b
and
A6: [. a,b .] c= Z
and
A7: ( ( ( diff (f,Z) ) . ( k + 1 ) ) | [. a,b .] ) is  continuous
and
A8: f is_differentiable_on ( ( k + 1 ) + 1 ),]. a,b .[;
k <= ( ( k + 1 ) - 1 );
then ( ( diff (f,Z) ) . k ) is_differentiable_on Z by A4,CKB34:def 1;
then ( ( ( diff (f,Z) ) . k ) | Z ) is  continuous by FDIFF_1:25;
then A9: ( ( ( diff (f,Z) ) . k ) | [. a,b .] ) is  continuous by A6,FCONT_1:16;
A10: ]. a,b .[ c= [. a,b .] by XXREAL_1:25;
then A11: ]. a,b .[ c= Z by A6,XBOOLE_1:1;
consider gk being (PartFunc of ( REAL ),( REAL )) such that A12: ( dom gk ) = Z and A13: (for x being Real holds (x in Z implies ( gk . x ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . k ) ))) by CKB39:1;
A14: f is_differentiable_on ( k + 1 ),]. a,b .[ by A8,CKB35:1,NAT_1:11;
then A15: gk is_differentiable_on ]. a,b .[ by A3,A4,A5,A6,A9,A12,A13,CKB35:1,NAT_1:11;
A16: ( gk | [. a,b .] ) is  continuous by A3,A4,A5,A6,A9,A14,A12,A13,CKB35:1,NAT_1:11;
now
k <= ( ( k + 1 ) - 1 );
then A17: ( ( diff (f,Z) ) . k ) is_differentiable_on Z by A4,CKB34:def 1;
k <= ( ( ( k + 1 ) + 1 ) - 1 ) by NAT_1:11;
then A18: ( ( diff (f,]. a,b .[) ) . k ) is_differentiable_on ]. a,b .[ by A8,CKB34:def 1;
A19: ( ( diff (f,Z) ) . ( k + 1 ) ) = ( ( ( diff (f,Z) ) . k ) `| Z ) by CKB33:def 1;
let gk1 being (PartFunc of ( REAL ),( REAL ));
assume that
A20: ( dom gk1 ) = Z
and
A21: (for x being Real holds (x in Z implies ( gk1 . x ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . ( k + 1 ) ) )));
A22: a in [. a,b .] by A5,XXREAL_1:1;
then ( gk1 . a ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,a,a) ) ) . ( k + 1 ) ) ) by A6,A21
.= ( ( f . a ) - ( ( ( Partial_Sums ( Taylor (f,Z,a,a) ) ) . k ) + ( ( Taylor (f,Z,a,a) ) . ( k + 1 ) ) ) ) by SERIES_1:def 1
.= ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,a,a) ) ) . k ) ) - ( ( Taylor (f,Z,a,a) ) . ( k + 1 ) ) )
.= ( ( gk . a ) - ( ( Taylor (f,Z,a,a) ) . ( k + 1 ) ) ) by A6,A13,A22
.= ( ( 0 ) - ( ( Taylor (f,Z,a,a) ) . ( k + 1 ) ) ) by A3,A4,A5,A6,A9,A14,A12,A13,CKB35:1,NAT_1:11
.= ( ( 0 ) - ( ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . a ) * ( ( a - a ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) ) ) by CKB36:def 1
.= ( ( 0 ) - ( ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . a ) * ( ( ( 0 ) |^ k ) * ( 0 ) ) ) / ( ( k + 1 ) ! ) ) ) by NEWTON:6
.= ( 0 );
hence ( gk1 . a ) = ( 0 );
consider h being (PartFunc of ( REAL ),( REAL )) such that A23: ( dom h ) = ( [#] ( REAL ) ) and A24: (for x being Real holds ( h . x ) = ( ( 1 * ( ( a - x ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) )) and A25: (for x being Real holds (h is_differentiable_in x & ( diff (h,x) ) = ( - ( ( 1 * ( ( a - x ) |^ k ) ) / ( k ! ) ) ))) by CKB38:1;
A26: ( dom ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) ) = ( ( dom ( ( diff (f,Z) ) . ( k + 1 ) ) ) /\ ( dom h ) ) by VALUED_1:def 4
.= ( Z /\ ( REAL ) ) by A23,A19,A17,FDIFF_1:def 7
.= Z by XBOOLE_1:28;
A27: ( dom ( gk - ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) ) ) = ( ( dom gk ) /\ ( dom ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) ) ) by VALUED_1:12
.= Z by A12,A26;
thus ( gk1 | [. a,b .] ) is  continuous
proof
set ghk = ( gk - ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) );
(for x being Real holds (x in ( REAL ) implies h is_differentiable_in x)) by A25;
then h is_differentiable_on ( REAL ) by A23,FDIFF_1:9;
then ( h | ( REAL ) ) is  continuous by FDIFF_1:25;
then A28: ( h | [. a,b .] ) is  continuous by FCONT_1:16;
now
let x being Real;
assume that
A29: x in Z;
thus ( gk1 . x ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . ( k + 1 ) ) ) by A21,A29
.= ( ( f . a ) - ( ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . k ) + ( ( Taylor (f,Z,x,a) ) . ( k + 1 ) ) ) ) by SERIES_1:def 1
.= ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . k ) ) - ( ( Taylor (f,Z,x,a) ) . ( k + 1 ) ) )
.= ( ( gk . x ) - ( ( Taylor (f,Z,x,a) ) . ( k + 1 ) ) ) by A13,A29
.= ( ( gk . x ) - ( ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) ) ) by CKB36:def 1
.= ( ( gk . x ) - ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . x ) * ( ( 1 * ( ( a - x ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) ) ) ) by XCMPLX_1:74
.= ( ( gk . x ) - ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . x ) * ( h . x ) ) ) by A24
.= ( ( gk . x ) - ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) . x ) ) by VALUED_1:5
.= ( ( gk - ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) ) . x ) by A27,A29,VALUED_1:13;
end;
then A30: gk1 = ghk by A20,A27,PARTFUN1:5;
[. a,b .] c= ( dom ( ( diff (f,Z) ) . ( k + 1 ) ) ) by A6,A19,A17,FDIFF_1:def 7;
then ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) | ( [. a,b .] /\ [. a,b .] ) ) is  continuous by A7,A23,A28,FCONT_1:19;
hence thesis by A6,A12,A16,A26,A30,FCONT_1:19;
end;

A31: ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) = ( ( ( diff (f,]. a,b .[) ) . k ) `| ]. a,b .[ ) by CKB33:def 1;
set gfh = ( gk - ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) );
A32: ( dom ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) ) = ( ( dom ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) ) /\ ( dom h ) ) by VALUED_1:def 4
.= ( ]. a,b .[ /\ ( REAL ) ) by A23,A31,A18,FDIFF_1:def 7
.= ]. a,b .[ by XBOOLE_1:28;
A33: ( dom ( gk - ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) ) ) = ( Z /\ ( dom ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) ) ) by A12,VALUED_1:12
.= ]. a,b .[ by A6,A10,A32,XBOOLE_1:1,XBOOLE_1:28;
A34: (for x being Real holds (x in ]. a,b .[ implies ( ( gk - ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) ) . x ) = ( ( gk - ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) ) . x )))
proof
let x being Real;
assume that
A35: x in ]. a,b .[;
thus ( ( gk - ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) ) . x ) = ( ( gk . x ) - ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) . x ) ) by A33,A35,VALUED_1:13
.= ( ( gk . x ) - ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( h . x ) ) ) by VALUED_1:5
.= ( ( gk . x ) - ( ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) | ]. a,b .[ ) . x ) * ( h . x ) ) ) by A4,A5,A6,A10,CKB40:1,XBOOLE_1:1
.= ( ( gk . x ) - ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . x ) * ( h . x ) ) ) by A35,FUNCT_1:49
.= ( ( gk . x ) - ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) . x ) ) by VALUED_1:5
.= ( ( gk - ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) ) . x ) by A11,A27,A35,VALUED_1:13;
end;
A36:now
let xx being set;
assume that
A37: xx in ( dom gfh );
reconsider x = xx as Real by A37;
thus ( gk1 . xx ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . ( k + 1 ) ) ) by A11,A21,A33,A37
.= ( ( f . a ) - ( ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . k ) + ( ( Taylor (f,Z,x,a) ) . ( k + 1 ) ) ) ) by SERIES_1:def 1
.= ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . k ) ) - ( ( Taylor (f,Z,x,a) ) . ( k + 1 ) ) )
.= ( ( gk . x ) - ( ( Taylor (f,Z,x,a) ) . ( k + 1 ) ) ) by A11,A13,A33,A37
.= ( ( gk . x ) - ( ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) ) ) by CKB36:def 1
.= ( ( gk . x ) - ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . x ) * ( ( 1 * ( ( a - x ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) ) ) ) by XCMPLX_1:74
.= ( ( gk . x ) - ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) . x ) * ( h . x ) ) ) by A24
.= ( ( gk . x ) - ( ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) . x ) ) by VALUED_1:5
.= ( ( gk - ( ( ( diff (f,Z) ) . ( k + 1 ) ) (#) h ) ) . x ) by A11,A27,A33,A37,VALUED_1:13
.= ( gfh . xx ) by A33,A34,A37;
end;
( k + 1 ) <= ( ( ( k + 1 ) + 1 ) - 1 );
then A38: ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) is_differentiable_on ]. a,b .[ by A8,CKB34:def 1;
(for x being Real holds (x in ]. a,b .[ implies h is_differentiable_in x)) by A25;
then A39: h is_differentiable_on ]. a,b .[ by A23,FDIFF_1:9;
then A40: ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) is_differentiable_on ]. a,b .[ by A32,A38,FDIFF_1:21;
then A41: gfh is_differentiable_on ]. a,b .[ by A15,A33,FDIFF_1:19;
( dom gfh ) = ( ( dom gk1 ) /\ ]. a,b .[ ) by A6,A10,A20,A33,XBOOLE_1:1,XBOOLE_1:28;
then A42: ( ( gk1 | ]. a,b .[ ) | ]. a,b .[ ) = ( gfh | ]. a,b .[ ) by A36,FUNCT_1:46;
then ( gfh | ]. a,b .[ ) = ( gk1 | ]. a,b .[ ) by FUNCT_1:51;
then (for x being Real holds (x in ]. a,b .[ implies ( gk1 | ]. a,b .[ ) is_differentiable_in x)) by A41,FDIFF_1:def 6;
hence A43: gk1 is_differentiable_on ]. a,b .[ by A11,A20,FDIFF_1:def 6;
now
let x being Real;
assume that
A44: x in ]. a,b .[;
thus ( diff (gk1,x) ) = ( ( gk1 `| ]. a,b .[ ) . x ) by A43,A44,FDIFF_1:def 7
.= ( ( ( gk1 | ]. a,b .[ ) `| ]. a,b .[ ) . x ) by A43,FDIFF_2:16
.= ( ( ( gfh | ]. a,b .[ ) `| ]. a,b .[ ) . x ) by A42,FUNCT_1:51
.= ( ( gfh `| ]. a,b .[ ) . x ) by A41,FDIFF_2:16
.= ( ( diff (gk,x) ) - ( diff (( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ),x) ) ) by A15,A33,A40,A44,FDIFF_1:19
.= ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) - ( diff (( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ),x) ) ) by A3,A4,A5,A6,A9,A14,A12,A13,A44,CKB35:1,NAT_1:11
.= ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) (#) h ) `| ]. a,b .[ ) . x ) ) by A40,A44,FDIFF_1:def 7
.= ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) - ( ( ( h . x ) * ( diff (( ( diff (f,]. a,b .[) ) . ( k + 1 ) ),x) ) ) + ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( diff (h,x) ) ) ) ) by A32,A38,A39,A44,FDIFF_1:21
.= ( ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) - ( ( h . x ) * ( diff (( ( diff (f,]. a,b .[) ) . ( k + 1 ) ),x) ) ) ) - ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( diff (h,x) ) ) )
.= ( ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) - ( ( ( 1 * ( ( a - x ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) ) * ( diff (( ( diff (f,]. a,b .[) ) . ( k + 1 ) ),x) ) ) ) - ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( diff (h,x) ) ) ) by A24
.= ( ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) - ( ( ( ( a - x ) |^ ( k + 1 ) ) / ( ( k + 1 ) ! ) ) * ( diff (( ( diff (f,]. a,b .[) ) . ( k + 1 ) ),x) ) ) ) - ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( - ( ( 1 * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) ) ) by A25
.= ( ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) + ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( 1 * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) ) - ( ( ( ( a - x ) |^ ( k + 1 ) ) / ( ( k + 1 ) ! ) ) * ( diff (( ( diff (f,]. a,b .[) ) . ( k + 1 ) ),x) ) ) )
.= ( ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) + ( ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) . x ) * ( ( a - x ) |^ k ) ) / ( k ! ) ) ) - ( ( ( ( a - x ) |^ ( k + 1 ) ) / ( ( k + 1 ) ! ) ) * ( diff (( ( diff (f,]. a,b .[) ) . ( k + 1 ) ),x) ) ) ) by XCMPLX_1:74
.= ( - ( ( ( ( a - x ) |^ ( k + 1 ) ) / ( ( k + 1 ) ! ) ) * ( diff (( ( diff (f,]. a,b .[) ) . ( k + 1 ) ),x) ) ) )
.= ( - ( ( ( ( a - x ) |^ ( k + 1 ) ) / ( ( k + 1 ) ! ) ) * ( ( ( ( diff (f,]. a,b .[) ) . ( k + 1 ) ) `| ]. a,b .[ ) . x ) ) ) by A38,A44,FDIFF_1:def 7
.= ( - ( ( ( ( a - x ) |^ ( k + 1 ) ) / ( ( k + 1 ) ! ) ) * ( ( ( diff (f,]. a,b .[) ) . ( ( k + 1 ) + 1 ) ) . x ) ) ) by CKB33:def 1
.= ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( ( k + 1 ) + 1 ) ) . x ) * ( ( a - x ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) ) ) by XCMPLX_1:74;
end;
hence (for x being Real holds (x in ]. a,b .[ implies ( diff (gk1,x) ) = ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( ( k + 1 ) + 1 ) ) . x ) * ( ( a - x ) |^ ( k + 1 ) ) ) / ( ( k + 1 ) ! ) ) )));
end;
hence thesis;
end;
A45: P[ ( 0 ) ]
proof
assume f is_differentiable_on ( 0 ),Z;
let a being Real;
let b being Real;
assume that
A46: a < b
and
A47: [. a,b .] c= Z
and
A48: ( ( ( diff (f,Z) ) . ( 0 ) ) | [. a,b .] ) is  continuous
and
A49: f is_differentiable_on ( ( 0 ) + 1 ),]. a,b .[;
A50: ]. a,b .[ c= [. a,b .] by XXREAL_1:25;
then A51: ]. a,b .[ c= Z by A47,XBOOLE_1:1;
let g being (PartFunc of ( REAL ),( REAL ));
assume that
A52: ( dom g ) = Z
and
A53: (for x being Real holds (x in Z implies ( g . x ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . ( 0 ) ) )));
A54: a in [. a,b .] by A46,XXREAL_1:1;
hence ( g . a ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,a,a) ) ) . ( 0 ) ) ) by A47,A53
.= ( ( f . a ) - ( ( Taylor (f,Z,a,a) ) . ( 0 ) ) ) by SERIES_1:def 1
.= ( ( f . a ) - ( ( ( ( ( diff (f,Z) ) . ( 0 ) ) . a ) * ( ( a - a ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by CKB36:def 1
.= ( ( f . a ) - ( ( ( ( f | Z ) . a ) * ( ( a - a ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by CKB33:def 1
.= ( ( f . a ) - ( ( ( f . a ) * ( ( a - a ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by A47,A54,FUNCT_1:49
.= ( ( f . a ) - ( ( f . a ) * 1 ) ) by NEWTON:4,NEWTON:12
.= ( 0 );
consider y being (PartFunc of ( REAL ),( REAL )) such that A55: ( dom y ) = ( [#] ( REAL ) ) and A56: (for x being Real holds ( y . x ) = ( ( f . a ) - x )) and A57: (for x being Real holds (y is_differentiable_in x & ( diff (y,x) ) = ( - 1 ))) by CKB37:1;
( rng f ) c= ( REAL );
then A58: ( dom ( y * f ) ) = ( dom f ) by A55,RELAT_1:27;
(for x being Real holds (x in ( REAL ) implies y is_differentiable_in x)) by A57;
then y is_differentiable_on ( REAL ) by A55,FDIFF_1:9;
then ( y | ( REAL ) ) is  continuous by FDIFF_1:25;
then A59: ( y | ( f .: [. a,b .] ) ) is  continuous by FCONT_1:16;
( rng f ) c= ( dom y ) by A55;
then A60: ( dom ( y * f ) ) = ( dom f ) by RELAT_1:27;
A61: [. a,b .] c= ( dom f ) by A1,A47,XBOOLE_1:1;
then A62: ]. a,b .[ c= ( dom f ) by A50,XBOOLE_1:1;
( 0 ) <= ( ( ( 0 ) + 1 ) - 1 );
then ( ( diff (f,]. a,b .[) ) . ( 0 ) ) is_differentiable_on ]. a,b .[ by A49,CKB34:def 1;
then ( f | ]. a,b .[ ) is_differentiable_on ]. a,b .[ by CKB33:def 1;
then (for x being Real holds (x in ]. a,b .[ implies ( f | ]. a,b .[ ) is_differentiable_in x)) by FDIFF_1:9;
then A63: f is_differentiable_on ]. a,b .[ by A62,FDIFF_1:def 6;
A64: (for x being Real holds (x in ]. a,b .[ implies (( y * f ) is_differentiable_in x & ( diff (( y * f ),x) ) = ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( ( 0 ) + 1 ) ) . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ))))
proof
A65: ( ( diff (f,]. a,b .[) ) . ( ( 0 ) + 1 ) ) = ( ( ( diff (f,]. a,b .[) ) . ( 0 ) ) `| ]. a,b .[ ) by CKB33:def 1
.= ( ( f | ]. a,b .[ ) `| ]. a,b .[ ) by CKB33:def 1
.= ( f `| ]. a,b .[ ) by A63,FDIFF_2:16;
let x being Real;
assume that
A66: x in ]. a,b .[;
A67: f is_differentiable_in x by A63,A66,FDIFF_1:9;
A68: y is_differentiable_in ( f . x ) by A57;
hence ( y * f ) is_differentiable_in x by A67,FDIFF_2:13;
A69: ( ( ( a - x ) |^ ( 0 ) ) / ( ( 0 ) ! ) ) = 1 by NEWTON:4,NEWTON:12;
thus ( diff (( y * f ),x) ) = ( ( diff (y,( f . x )) ) * ( diff (f,x) ) ) by A68,A67,FDIFF_2:13
.= ( ( diff (y,( f . x )) ) * ( ( f `| ]. a,b .[ ) . x ) ) by A63,A66,FDIFF_1:def 7
.= ( ( - 1 ) * ( ( ( diff (f,]. a,b .[) ) . ( ( 0 ) + 1 ) ) . x ) ) by A57,A65
.= ( - ( ( ( ( diff (f,]. a,b .[) ) . ( ( 0 ) + 1 ) ) . x ) * ( ( ( a - x ) |^ ( 0 ) ) / ( ( 0 ) ! ) ) ) ) by A69
.= ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( ( 0 ) + 1 ) ) . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by XCMPLX_1:74;
end;
then (for x being Real holds (x in ]. a,b .[ implies ( y * f ) is_differentiable_in x));
then A70: ( y * f ) is_differentiable_on ]. a,b .[ by A62,A60,FDIFF_1:9;
A71: ( dom ( ( y * f ) | [. a,b .] ) ) = ( ( dom ( y * f ) ) /\ [. a,b .] ) by RELAT_1:61
.= [. a,b .] by A1,A47,A58,XBOOLE_1:1,XBOOLE_1:28
.= ( Z /\ [. a,b .] ) by A47,XBOOLE_1:28
.= ( dom ( g | [. a,b .] ) ) by A52,RELAT_1:61;
A72:now
let xx being set;
assume that
A73: xx in ( dom ( g | [. a,b .] ) );
reconsider x = xx as Real by A73;
( dom ( g | [. a,b .] ) ) = ( ( dom g ) /\ [. a,b .] ) by RELAT_1:61;
then ( dom ( g | [. a,b .] ) ) c= [. a,b .] by XBOOLE_1:17;
then A74: x in [. a,b .] by A73;
thus ( ( g | [. a,b .] ) . xx ) = ( g . x ) by A73,FUNCT_1:47
.= ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . ( 0 ) ) ) by A47,A53,A74
.= ( ( f . a ) - ( ( Taylor (f,Z,x,a) ) . ( 0 ) ) ) by SERIES_1:def 1
.= ( ( f . a ) - ( ( ( ( ( diff (f,Z) ) . ( 0 ) ) . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by CKB36:def 1
.= ( ( f . a ) - ( ( ( ( f | Z ) . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by CKB33:def 1
.= ( ( f . a ) - ( ( ( f . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by A47,A74,FUNCT_1:49
.= ( ( f . a ) - ( ( f . x ) * 1 ) ) by NEWTON:4,NEWTON:12
.= ( y . ( f . x ) ) by A56
.= ( ( y * f ) . x ) by A61,A74,FUNCT_1:13
.= ( ( ( y * f ) | [. a,b .] ) . xx ) by A71,A73,FUNCT_1:47;
end;
( ( f | Z ) | [. a,b .] ) is  continuous by A48,CKB33:def 1;
then ( ( ( f | Z ) | [. a,b .] ) | [. a,b .] ) is  continuous by FCONT_1:15;
then ( ( f | [. a,b .] ) | [. a,b .] ) is  continuous by A47,FUNCT_1:51;
then ( f | [. a,b .] ) is  continuous by FCONT_1:15;
then ( ( y * f ) | [. a,b .] ) is  continuous by A59,FCONT_1:25;
hence ( g | [. a,b .] ) is  continuous by A71,A72,FUNCT_1:2;
A75: ( dom ( ( y * f ) | ]. a,b .[ ) ) = ( ( dom ( y * f ) ) /\ ]. a,b .[ ) by RELAT_1:61
.= ]. a,b .[ by A50,A61,A60,XBOOLE_1:1,XBOOLE_1:28
.= ( Z /\ ]. a,b .[ ) by A47,A50,XBOOLE_1:1,XBOOLE_1:28
.= ( dom ( g | ]. a,b .[ ) ) by A52,RELAT_1:61;
now
let xx being set;
assume that
A76: xx in ( dom ( g | ]. a,b .[ ) );
reconsider x = xx as Real by A76;
( dom ( g | ]. a,b .[ ) ) = ( ( dom g ) /\ ]. a,b .[ ) by RELAT_1:61;
then ( dom ( g | ]. a,b .[ ) ) c= ]. a,b .[ by XBOOLE_1:17;
then A77: x in ]. a,b .[ by A76;
A78: ( ( ( a - x ) |^ ( 0 ) ) / ( ( 0 ) ! ) ) = 1 by NEWTON:4,NEWTON:12;
thus ( ( g | ]. a,b .[ ) . xx ) = ( g . x ) by A76,FUNCT_1:47
.= ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . ( 0 ) ) ) by A53,A51,A77
.= ( ( f . a ) - ( ( Taylor (f,Z,x,a) ) . ( 0 ) ) ) by SERIES_1:def 1
.= ( ( f . a ) - ( ( ( ( ( diff (f,Z) ) . ( 0 ) ) . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by CKB36:def 1
.= ( ( f . a ) - ( ( ( ( f | Z ) . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by CKB33:def 1
.= ( ( f . a ) - ( ( ( f . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by A51,A77,FUNCT_1:49
.= ( ( f . a ) - ( ( f . x ) * ( ( ( a - x ) |^ ( 0 ) ) / ( ( 0 ) ! ) ) ) ) by XCMPLX_1:74
.= ( y . ( f . x ) ) by A56,A78
.= ( ( y * f ) . x ) by A62,A77,FUNCT_1:13
.= ( ( ( y * f ) | ]. a,b .[ ) . xx ) by A75,A76,FUNCT_1:47;
end;
then A79: ( g | ]. a,b .[ ) = ( ( y * f ) | ]. a,b .[ ) by A75,FUNCT_1:2;
then ( g | ]. a,b .[ ) is_differentiable_on ]. a,b .[ by A70,FDIFF_2:16;
then (for x being Real holds (x in ]. a,b .[ implies ( g | ]. a,b .[ ) is_differentiable_in x)) by FDIFF_1:9;
hence A80: g is_differentiable_on ]. a,b .[ by A52,A51,FDIFF_1:def 6;
now
let x being Real;
assume that
A81: x in ]. a,b .[;
thus g is_differentiable_in x by A80,A81,FDIFF_1:9;
thus ( diff (g,x) ) = ( ( g `| ]. a,b .[ ) . x ) by A80,A81,FDIFF_1:def 7
.= ( ( ( g | ]. a,b .[ ) `| ]. a,b .[ ) . x ) by A80,FDIFF_2:16
.= ( ( ( y * f ) `| ]. a,b .[ ) . x ) by A79,A70,FDIFF_2:16
.= ( diff (( y * f ),x) ) by A70,A81,FDIFF_1:def 7
.= ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( ( 0 ) + 1 ) ) . x ) * ( ( a - x ) |^ ( 0 ) ) ) / ( ( 0 ) ! ) ) ) by A64,A81;
end;
hence thesis;
end;
(for k being (Element of ( NAT )) holds P[ k ]) from NAT_1:sch 1(A45,A2);
hence thesis;
end;
