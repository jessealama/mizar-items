environ
vocabularies NUMBERS,ORDINAL1,INT_1,XREAL_0,RAT_1,PARTFUN1,PREPOWER,FUNCT_1,REAL_1,SUBSET_1,ARYTM_3,RELAT_1,CARD_1,NEWTON,COMPLEX1,XXREAL_0,FDIFF_1,ARYTM_1,RCOMP_1,TARSKI,XBOOLE_0,VALUED_1,SIN_COS,SEQ_2,ORDINAL2,FCONT_1,FUNCT_2,POWER,SERIES_1,REALSET1,NAT_1,CARD_3,LIMFUNC1,SEQFUNC,SEQ_1,XXREAL_1,TAYLOR_1,IRRAT_1;
notations TARSKI,XBOOLE_0,SUBSET_1,FUNCT_1,RELSET_1,PARTFUN1,FUNCT_2,IRRAT_1,LIMFUNC1,RCOMP_1,FCONT_1,XCMPLX_0,XXREAL_0,XREAL_0,COMPLEX1,RAT_1,ORDINAL1,NUMBERS,REAL_1,NAT_1,INT_1,NEWTON,VALUED_1,PARTFUN2,SEQ_1,SEQ_2,SERIES_1,FDIFF_1,SEQFUNC,PREPOWER,POWER,SIN_COS,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
definitions SUBSET_1,LIMFUNC1,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
theorems XBOOLE_1,ABSVALUE,TARSKI,XBOOLE_0,PARTFUN1,PARTFUN2,XCMPLX_1,RELAT_1,CARD_4,RCOMP_1,SEQ_1,SEQ_2,SIN_COS,SERIES_1,FUNCT_1,NAT_1,INT_1,NEWTON,RAT_1,IRRAT_1,POWER,FCONT_1,FDIFF_1,FDIFF_2,ROLLE,SEQ_4,PREPOWER,FUNCT_2,XREAL_0,XREAL_1,XXREAL_0,ORDINAL1,VALUED_1,XXREAL_1,XXREAL_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB23,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47;
schemes SEQ_1,RECDEF_1,NAT_1,INT_1,PARTFUN2,FUNCT_2;
registrations XBOOLE_0,RELSET_1,PARTFUN1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,INT_1,RAT_1,MEMBERED,RCOMP_1,NEWTON,PREPOWER,SIN_COS,VALUED_0,VALUED_1,FUNCT_2,XXREAL_2,ORDINAL1,SEQ_4,FCONT_3,ABIAN,CKB22,CKB24;
constructors PARTFUN1,ARYTM_0,REAL_1,NAT_1,SEQ_2,RCOMP_1,PARTFUN2,RFUNCT_2,FCONT_1,LIMFUNC1,FDIFF_1,SEQFUNC,PREPOWER,COMSEQ_3,SIN_COS,SEQ_1,XXREAL_2,SERIES_1,VALUED_1,POWER,RELSET_1,ABIAN,CKB1,CKB25,CKB26,CKB30,CKB33,CKB34,CKB36;
requirements SUBSET,REAL,BOOLE,NUMERALS,ARITHM;
begin
reserve n for  natural number;
reserve p for  real number;
reserve x for  real number;
reserve f for (PartFunc of ( REAL ),( REAL ));
theorem
Th28: (for n being (Element of ( NAT )) holds (for f being (PartFunc of ( REAL ),( REAL )) holds (for Z being (Subset of ( REAL )) holds ((Z c= ( dom f ) & f is_differentiable_on n,Z) implies (for a,b being Real holds ((((a < b & [. a,b .] c= Z) & ( ( ( diff (f,Z) ) . n ) | [. a,b .] ) is  continuous) & f is_differentiable_on ( n + 1 ),]. a,b .[) implies (for l being Real holds (for g being (PartFunc of ( REAL ),( REAL )) holds (((( dom g ) = ( [#] ( REAL ) ) & (for x being Real holds ( g . x ) = ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . n ) ) - ( ( l * ( ( a - x ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ))) & ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,b,a) ) ) . n ) ) - ( ( l * ( ( a - b ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) = ( 0 )) implies ((((g is_differentiable_on ]. a,b .[ & ( g . b ) = ( 0 )) & ( g . a ) = ( 0 )) & ( g | [. a,b .] ) is  continuous) & (for x being Real holds (x in ]. a,b .[ implies ( diff (g,x) ) = ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) + ( ( l * ( ( a - x ) |^ n ) ) / ( n ! ) ) )))))))))))))
proof
let n being (Element of ( NAT ));
let f being (PartFunc of ( REAL ),( REAL ));
let Z being (Subset of ( REAL ));
assume that
A1: (Z c= ( dom f ) & f is_differentiable_on n,Z);
let a being Real;
let b being Real;
assume that
A2: a < b
and
A3: [. a,b .] c= Z
and
A4: (( ( ( diff (f,Z) ) . n ) | [. a,b .] ) is  continuous & f is_differentiable_on ( n + 1 ),]. a,b .[);
let l being Real;
consider p being (PartFunc of ( REAL ),( REAL )) such that A5: ( dom p ) = ( [#] ( REAL ) ) and A6: (for x being Real holds ( p . x ) = ( ( l * ( ( a - x ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) )) and A7: (for x being Real holds (p is_differentiable_in x & ( diff (p,x) ) = ( - ( ( l * ( ( a - x ) |^ n ) ) / ( n ! ) ) ))) by CKB38:1;
consider h being (PartFunc of ( REAL ),( REAL )) such that A8: ( dom h ) = Z and A9: (for x being Real holds (x in Z implies ( h . x ) = ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . n ) ))) and A10: ( h . a ) = ( 0 ) and A11: ( h | [. a,b .] ) is  continuous and A12: h is_differentiable_on ]. a,b .[ and A13: (for x being Real holds (x in ]. a,b .[ implies ( diff (h,x) ) = ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) ))) by A1,A2,A3,A4,CKB47:1;
A14: [. a,b .] c= ( ( dom h ) /\ ( dom p ) ) by A3,A8,A5,XBOOLE_1:19;
let g being (PartFunc of ( REAL ),( REAL ));
assume that
A15: ( dom g ) = ( [#] ( REAL ) )
and
A16: (for x being Real holds ( g . x ) = ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,x,a) ) ) . n ) ) - ( ( l * ( ( a - x ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ))
and
A17: ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,b,a) ) ) . n ) ) - ( ( l * ( ( a - b ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) = ( 0 );
set hp = ( h - p );
A18: ( dom hp ) = ( ( dom h ) /\ ( dom p ) ) by VALUED_1:12
.= Z by A8,A5,XBOOLE_1:28;
A19: (for x being set holds (x in ( dom hp ) implies ( hp . x ) = ( g . x )))
proof
let x being set;
assume that
A20: x in ( dom hp );
reconsider xx = x as Real by A20;
thus ( hp . x ) = ( ( h . xx ) - ( p . xx ) ) by A20,VALUED_1:13
.= ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,xx,a) ) ) . n ) ) - ( p . xx ) ) by A9,A18,A20
.= ( ( ( f . a ) - ( ( Partial_Sums ( Taylor (f,Z,xx,a) ) ) . n ) ) - ( ( l * ( ( a - xx ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) by A6
.= ( g . x ) by A16;
end;
(for x being Real holds (x in ( REAL ) implies p is_differentiable_in x)) by A7;
then p is_differentiable_on ( REAL ) by A5,FDIFF_1:9;
then ( p | ( REAL ) ) is  continuous by FDIFF_1:25;
then A21: ( p | [. a,b .] ) is  continuous by FCONT_1:16;
]. a,b .[ c= [. a,b .] by XXREAL_1:25;
then A22: ]. a,b .[ c= Z by A3,XBOOLE_1:1;
A23: ( dom hp ) = ( ( dom g ) /\ Z ) by A15,A18,XBOOLE_1:28;
then A24: ( hp | ]. a,b .[ ) = ( ( g | Z ) | ]. a,b .[ ) by A19,FUNCT_1:46
.= ( g | ]. a,b .[ ) by A22,FUNCT_1:51;
A25: (for x being Real holds (x in ]. a,b .[ implies (hp is_differentiable_in x & ( diff (hp,x) ) = ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) + ( ( l * ( ( a - x ) |^ n ) ) / ( n ! ) ) ))))
proof
let x being Real;
assume that
A26: x in ]. a,b .[;
A27: h is_differentiable_in x by A12,A26,FDIFF_1:9;
A28: p is_differentiable_in x by A7;
hence hp is_differentiable_in x by A27,FDIFF_1:14;
thus ( diff (hp,x) ) = ( ( diff (h,x) ) - ( diff (p,x) ) ) by A27,A28,FDIFF_1:14
.= ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) - ( diff (p,x) ) ) by A13,A26
.= ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) - ( - ( ( l * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) ) by A7
.= ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) + ( ( l * ( ( a - x ) |^ n ) ) / ( n ! ) ) );
end;
then (for x being Real holds (x in ]. a,b .[ implies hp is_differentiable_in x));
then A29: hp is_differentiable_on ]. a,b .[ by A18,A22,FDIFF_1:9;
then (for x being Real holds (x in ]. a,b .[ implies ( hp | ]. a,b .[ ) is_differentiable_in x)) by FDIFF_1:def 6;
hence A30: g is_differentiable_on ]. a,b .[ by A15,A24,FDIFF_1:def 6;
thus ( g . b ) = ( 0 ) by A16,A17;
A31: a in [. a,b .] by A2,XXREAL_1:1;
then ( g . a ) = ( hp . a ) by A3,A18,A19
.= ( ( h . a ) - ( p . a ) ) by A3,A18,A31,VALUED_1:13
.= ( ( 0 ) - ( ( l * ( ( a - a ) |^ ( n + 1 ) ) ) / ( ( n + 1 ) ! ) ) ) by A10,A6
.= ( ( 0 ) - ( ( l * ( ( ( 0 ) |^ n ) * ( 0 ) ) ) / ( ( n + 1 ) ! ) ) ) by NEWTON:6
.= ( 0 );
hence ( g . a ) = ( 0 );
( hp | [. a,b .] ) = ( ( g | Z ) | [. a,b .] ) by A23,A19,FUNCT_1:46
.= ( g | [. a,b .] ) by A3,FUNCT_1:51;
hence ( g | [. a,b .] ) is  continuous by A11,A14,A21,FCONT_1:18;
thus (for x being Real holds (x in ]. a,b .[ implies ( diff (g,x) ) = ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) + ( ( l * ( ( a - x ) |^ n ) ) / ( n ! ) ) )))
proof
let x being Real;
assume that
A32: x in ]. a,b .[;
thus ( diff (g,x) ) = ( ( g `| ]. a,b .[ ) . x ) by A30,A32,FDIFF_1:def 7
.= ( ( ( g | ]. a,b .[ ) `| ]. a,b .[ ) . x ) by A30,FDIFF_2:16
.= ( ( hp `| ]. a,b .[ ) . x ) by A24,A29,FDIFF_2:16
.= ( diff (hp,x) ) by A29,A32,FDIFF_1:def 7
.= ( ( - ( ( ( ( ( diff (f,]. a,b .[) ) . ( n + 1 ) ) . x ) * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) + ( ( l * ( ( a - x ) |^ n ) ) / ( n ! ) ) ) by A25,A32;
end;

end;
