environ
vocabularies NUMBERS,SUBSET_1,GROUP_1,FINSEQ_1,GROUP_3,XXREAL_0,CARD_1,FUNCT_1,RLSUB_1,GROUP_2,RELAT_1,ARYTM_3,STRUCT_0,PRE_TOPC,GROUP_6,BINOP_1,TARSKI,XBOOLE_0,QC_LANG1,WELLORD1,NAT_1,FUNCT_2,ALGSTR_0,GRAPH_1,GRSOLV_1;
notations TARSKI,XBOOLE_0,SUBSET_1,NUMBERS,NAT_1,STRUCT_0,ALGSTR_0,BINOP_1,RELAT_1,FUNCT_1,RELSET_1,FUNCT_2,GR_CY_1,FINSEQ_1,GROUP_1,GROUP_2,GROUP_3,GROUP_6,XXREAL_0,CKB1;
definitions GROUP_2,RELAT_1,TARSKI,ALGSTR_0,CKB1;
theorems FINSEQ_1,BINOP_1,GROUP_2,GROUP_3,TARSKI,GROUP_6,FINSEQ_2,FUNCT_1,FUNCT_2,RELAT_1,XBOOLE_0,XBOOLE_1,NAT_1,GROUP_1,STRUCT_0,CKB1,CKB3,CKB4,CKB5,CKB6;
schemes FINSEQ_1;
registrations XBOOLE_0,FUNCT_1,RELSET_1,XREAL_0,FINSEQ_1,STRUCT_0,GROUP_2,GROUP_3,GROUP_6,GR_CY_1,ORDINAL1,CKB2;
constructors PARTFUN1,BINOP_1,FINSUB_1,XXREAL_0,REALSET1,GROUP_6,GR_CY_1,RELSET_1,CKB1;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
reserve i for (Element of ( NAT ));
theorem
(for G being  solvable  strict Group holds (for H being  strict (Subgroup of G) holds H is  solvable))
proof
let G being  solvable  strict Group;
let H being  strict (Subgroup of G);
consider F being (FinSequence of ( Subgroups G )) such that A1: ( len F ) > ( 0 ) and A2: ( F . 1 ) = ( (Omega). G ) and A3: ( F . ( len F ) ) = ( (1). G ) and A4: (for i holds ((i in ( dom F ) & ( i + 1 ) in ( dom F )) implies (for G1,G2 being  strict (Subgroup of G) holds ((G1 = ( F . i ) & G2 = ( F . ( i + 1 ) )) implies (G2 is  strict  normal  strict  normal (Subgroup of G1) & (for N being  normal (Subgroup of G1) holds (N = G2 implies ( G1 ./. N ) is  commutative))))))) by CKB1:def 1;
defpred P[ set,set ]
 means
(ex I being  strict (Subgroup of G) st (I = ( F . $1 ) & $2 = ( I /\ H )));
A5: (for k being Nat holds (k in ( Seg ( len F ) ) implies (ex x being (Element of ( Subgroups H )) st P[ k,x ])))
proof
let k being Nat;
assume k in ( Seg ( len F ) );
then k in ( dom F ) by FINSEQ_1:def 3;
then ( F . k ) in ( Subgroups G ) by FINSEQ_2:11;
then reconsider I = ( F . k ) as  strict (Subgroup of G) by GROUP_3:def 1;
reconsider x = ( I /\ H ) as  strict (Subgroup of H) by GROUP_2:88;
reconsider y = x as (Element of ( Subgroups H )) by GROUP_3:def 1;
take y;
take I;
thus thesis;
end;
consider R being (FinSequence of ( Subgroups H )) such that A6: (( dom R ) = ( Seg ( len F ) ) & (for i being Nat holds (i in ( Seg ( len F ) ) implies P[ i,( R . i ) ]))) from FINSEQ_1:sch 5(A5);
A7: (for i holds ((i in ( dom R ) & ( i + 1 ) in ( dom R )) implies (for H1,H2 being  strict (Subgroup of H) holds ((H1 = ( R . i ) & H2 = ( R . ( i + 1 ) )) implies (H2 is  strict  normal  strict  normal (Subgroup of H1) & (for N being  normal (Subgroup of H1) holds (N = H2 implies ( H1 ./. N ) is  commutative)))))))
proof
let i;
assume that
A8: i in ( dom R )
and
A9: ( i + 1 ) in ( dom R );
consider J being  strict (Subgroup of G) such that A10: J = ( F . ( i + 1 ) ) and A11: ( R . ( i + 1 ) ) = ( J /\ H ) by A6,A9;
consider I being  strict (Subgroup of G) such that A12: I = ( F . i ) and A13: ( R . i ) = ( I /\ H ) by A6,A8;
let H1 being  strict (Subgroup of H),H2 being  strict (Subgroup of H);
assume that
A14: H1 = ( R . i )
and
A15: H2 = ( R . ( i + 1 ) );
A16: (i in ( dom F ) & ( i + 1 ) in ( dom F )) by A6,A8,A9,FINSEQ_1:def 3;
then reconsider J1 = J as  strict  normal (Subgroup of I) by A4,A12,A10;
A17: (for N being  strict  normal (Subgroup of H1) holds (N = H2 implies ( H1 ./. N ) is  commutative))
proof
let N being  strict  normal (Subgroup of H1);
assume N = H2;
then consider G3 being (Subgroup of ( I ./. J1 )) such that A18: ( H1 ./. N ),G3 are_isomorphic  by A14,A15,A13,A11,CKB6:1;
consider h being (Homomorphism of ( H1 ./. N ),G3) such that A19: h is  bijective by A18,GROUP_6:def 11;
A20: h is  one-to-one by A19,FUNCT_2:def 4;
A21: ( I ./. J1 ) is  commutative by A4,A12,A10,A16;
now
let a being (Element of ( H1 ./. N )),b being (Element of ( H1 ./. N ));
consider a9 being (Element of G3) such that A22: a9 = ( h . a );
consider b9 being (Element of G3) such that A23: b9 = ( h . b );
(the multF of G3) is  commutative by A21,GROUP_3:2;
then A24: ( a9 * b9 ) = ( b9 * a9 ) by BINOP_1:def 2;
thus ( (the multF of ( H1 ./. N )) . (a,b) ) = ( ( h " ) . ( h . ( a * b ) ) ) by A20,FUNCT_2:26
.= ( ( h " ) . ( ( h . b ) * ( h . a ) ) ) by A22,A23,A24,GROUP_6:def 6
.= ( ( h " ) . ( h . ( b * a ) ) ) by GROUP_6:def 6
.= ( (the multF of ( H1 ./. N )) . (b,a) ) by A20,FUNCT_2:26;
end;
then (the multF of ( H1 ./. N )) is  commutative by BINOP_1:def 2;
hence thesis by GROUP_3:2;
end;
H2 = ( J1 /\ H ) by A15,A11;
hence thesis by A14,A13,A17,CKB3:1;
end;
A25: ( len R ) = ( len F ) by A6,FINSEQ_1:def 3;
A26: ( len R ) > ( 0 ) by A1,A6,FINSEQ_1:def 3;
A27: ( R . 1 ) = ( (Omega). H )
proof
1 <= ( len R ) by A26,NAT_1:14;
then 1 in ( Seg ( len F ) ) by A25,FINSEQ_1:1;
then (ex I being  strict (Subgroup of G) st (I = ( F . 1 ) & ( R . 1 ) = ( I /\ H ))) by A6;
hence thesis by A2,GROUP_2:86;
end;
take R;
( R . ( len R ) ) = ( (1). H )
proof
(ex I being  strict (Subgroup of G) st (I = ( F . ( len R ) ) & ( R . ( len R ) ) = ( I /\ H ))) by A1,A6,A25,FINSEQ_1:3;
hence ( R . ( len R ) ) = ( (1). G ) by A3,A25,GROUP_2:85
.= ( (1). H ) by GROUP_2:63;
end;
hence thesis by A1,A6,A27,A7,FINSEQ_1:def 3;
end;
