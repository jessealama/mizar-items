environ
vocabularies NUMBERS,NAT_1,XBOOLE_0,FINSEQ_1,FUNCT_1,RELAT_1,TARSKI,SUBSET_1,MARGREL1,FINSET_1,FINSEQ_2,CARD_3,CARD_1,SETFAM_1,STRUCT_0,ZFMISC_1,FUNCOP_1,XBOOLEAN,EQREL_1,ORDERS_2,WAYBEL23,YELLOW_0,LATTICES,ORDINAL2,WAYBEL_0,WAYBEL_3,WAYBEL_8,RCOMP_1,PRE_TOPC,RLVECT_3,CANTOR_1,YELLOW15;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NAT_1,SETFAM_1,DOMAIN_1,CARD_1,NUMBERS,FINSET_1,STRUCT_0,MARGREL1,RELAT_1,FUNCT_1,RELSET_1,FUNCT_2,FINSEQ_1,FINSEQ_2,FINSEQ_4,EQREL_1,FUNCOP_1,CARD_3,PRE_TOPC,TOPS_2,CANTOR_1,ORDERS_2,YELLOW_0,WAYBEL_0,WAYBEL_3,WAYBEL_8,WAYBEL23;
definitions TARSKI,FUNCT_1,XBOOLE_0,FINSEQ_2,MARGREL1,XBOOLEAN,STRUCT_0;
theorems TARSKI,SETFAM_1,ZFMISC_1,FINSET_1,RELAT_1,FUNCT_1,FUNCT_2,FUNCT_6,MSSUBFAM,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,EQREL_1,FUNCOP_1,CARD_1,CARD_4,T_0TOPSP,PRE_TOPC,TOPS_2,CANTOR_1,MSSCYC_1,YELLOW_0,YELLOW_8,YELLOW_9,WAYBEL_0,WAYBEL_3,WAYBEL_8,WAYBEL23,XBOOLE_0,XBOOLE_1,SUBSET_1,ORDINAL1,XBOOLEAN,CKB3,CKB4,CKB7;
schemes FUNCT_2,PRE_CIRC,FINSEQ_1,FRAENKEL,CKB1;
registrations SUBSET_1,FUNCT_1,RELSET_1,FINSET_1,FINSEQ_1,MARGREL1,FINSEQ_2,REALSET1,STRUCT_0,TOPS_1,LATTICE3,WAYBEL_0,WAYBEL_3,WAYBEL23,ORDINAL1,PRE_TOPC,ZFMISC_1,CARD_1,XBOOLE_0,RELAT_1,CKB2,CKB5,CKB6;
constructors SETFAM_1,XXREAL_0,FINSEQ_4,REALSET1,VALUAT_1,TOPS_2,CANTOR_1,WAYBEL_8,WAYBEL23,RELSET_1,FINSEQ_2;
requirements NUMERALS,REAL,SUBSET,BOOLE;
begin
definition
let X being set;
let p being (FinSequence of ( bool X ));
let q being (FinSequence of ( BOOLEAN ));
func MergeSequence (p,q) -> (FinSequence of ( bool X ))
means
:Def1: (( len it ) = ( len p ) & (for i being Nat holds (i in ( dom p ) implies ( it . i ) = ( IFEQ (( q . i ),( TRUE ),( p . i ),( X \ ( p . i ) )) ))));
existence
proof
deffunc F(Nat) = ( IFEQ (( q . $1 ),( TRUE ),( p . $1 ),( X \ ( p . $1 ) )) );
consider r being FinSequence such that A1: ( len r ) = ( len p ) and A2: (for i being Nat holds (i in ( dom r ) implies ( r . i ) = F(i))) from FINSEQ_1:sch 2;
( rng r ) c= ( bool X )
proof
let z being set;
assume z in ( rng r );
then consider i being Nat such that A3: i in ( dom r ) and A4: ( r . i ) = z by FINSEQ_2:10;
A5: z = ( IFEQ (( q . i ),( TRUE ),( p . i ),( X \ ( p . i ) )) ) by A2,A3,A4;
i in ( Seg ( len p ) ) by A1,A3,FINSEQ_1:def 3;
then A6: i in ( dom p ) by FINSEQ_1:def 3;
now
per cases ;
suppose ( q . i ) = ( TRUE );

then z = ( p . i ) by A5,FUNCOP_1:def 8;
hence thesis by A6,FINSEQ_2:11;
end;
suppose ( q . i ) <> ( TRUE );

then z = ( X \ ( p . i ) ) by A5,FUNCOP_1:def 8;
hence thesis;
end;
end;
hence thesis;
end;
then reconsider r as (FinSequence of ( bool X )) by FINSEQ_1:def 4;
take r;
( dom p ) = ( dom r ) by A1,FINSEQ_3:29;
hence thesis by A1,A2;
end;
uniqueness
proof
let r1 being (FinSequence of ( bool X )),r2 being (FinSequence of ( bool X ));
assume that
A7: ( len r1 ) = ( len p )
and
A8: (for i being Nat holds (i in ( dom p ) implies ( r1 . i ) = ( IFEQ (( q . i ),( TRUE ),( p . i ),( X \ ( p . i ) )) )))
and
A9: ( len r2 ) = ( len p )
and
A10: (for i being Nat holds (i in ( dom p ) implies ( r2 . i ) = ( IFEQ (( q . i ),( TRUE ),( p . i ),( X \ ( p . i ) )) )));
A11: ( dom r1 ) = ( Seg ( len p ) ) by A7,FINSEQ_1:def 3;
now
let i being Nat;
assume i in ( dom r1 );
then A12: i in ( dom p ) by A11,FINSEQ_1:def 3;
hence ( r1 . i ) = ( IFEQ (( q . i ),( TRUE ),( p . i ),( X \ ( p . i ) )) ) by A8
.= ( r2 . i ) by A10,A12;
end;
hence thesis by A7,A9,FINSEQ_2:9;
end;
end;
