environ
vocabularies NUMBERS,XBOOLE_0,NAT_1,XCMPLX_0,VECTSP_1,SUBSET_1,FINSEQ_1,MATRIX_1,CARD_1,TREES_1,XXREAL_0,MATRIX_2,QC_LANG1,RELAT_1,SUPINF_2,ARYTM_3,MATRIX_3,FUNCT_1,ZFMISC_1,FINSEQ_2,FUNCT_2,ARYTM_1,FINSET_1,TARSKI,SGRAPH1,CARD_3,ALGSTR_0,SETWISEO,ABIAN,FINSUB_1,BINOP_1,FINSOP_1,CARD_FIN,FUNCOP_1,FUNCT_4,MATRIX11,FINSEQ_5,INT_1,GROUP_1,ABSVALUE,RVSUM_1,STRUCT_0,INCSP_1,FVSUM_1,FREEALG,FINSEQ_3,LAPLACE,CLASSES1,AFINSQ_1,PRVECT_1,RLVECT_2,LMOD_7,VALUED_1,PARTFUN1,RLVECT_3,RLSUB_1,MESFUNC1,RLVECT_5,MATRIX13,RLVECT_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,NAT_D,FINSET_1,RELAT_1,RELSET_1,FUNCT_1,PARTFUN1,FUNCT_2,SETWOP_2,FINSEQ_1,BINOP_1,STRUCT_0,ALGSTR_0,FUNCOP_1,RLVECT_1,GROUP_1,VECTSP_1,SETWISEO,FINSEQ_2,MATRIX_1,FINSUB_1,MATRIX_2,FVSUM_1,FINSOP_1,GROUP_4,MATRIX_3,FINSEQ_7,FUNCT_4,SGRAPH1,NEWTON,FINSEQ_5,DOMAIN_1,MATRIX_6,MATRIX_7,MATRIX11,CARD_FIN,FINSEQ_3,LAPLACE,MEASURE6,PRVECT_1,VECTSP_4,VECTSP_6,VECTSP_7,MATRLIN,VECTSP_9,FINSEQOP,CKB17;
definitions RLVECT_1,FINSEQ_2,FINSEQ_1,TARSKI,MATRIX_1,FVSUM_1,GROUP_4,MATRIX_2,MATRIX_3,MATRIX_7,MATRIX11,LAPLACE,MEASURE6,VECTSP_1,VECTSP_7,FUNCT_1,RELAT_1,STRUCT_0,ALGSTR_0,FUNCOP_1,CKB17;
theorems NAT_D,CARD_1,CARD_2,CARD_FIN,COMPUT_1,ENUMSET1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FINSEQ_5,FINSOP_1,FINSUB_1,FRECHET,FUNCT_1,FUNCT_2,FUNCT_4,FUNCT_7,FUNCOP_1,FVSUM_1,GRAPH_2,GRAPH_5,GROUP_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_7,MATRIX_9,MATRIX11,MATRIXR1,NAT_1,ORDINAL1,PRVECT_1,RELAT_1,RLVECT_1,SETWISEO,SETWOP_2,SGRAPH1,STIRL2_1,TARSKI,VECTSP_1,VECTSP_2,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,VECTSP10,WELLORD2,XBOOLE_0,XBOOLE_1,XREAL_1,ZFMISC_1,XXREAL_0,FINSEQOP,STRUCT_0,MATRIXR2,PARTFUN1,MATRLIN,XREAL_0,MEASURE6,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40;
schemes FINSEQ_1,FINSEQ_2,FUNCT_1,FUNCT_2,NAT_1,PRE_POLY,MATRIX_1;
registrations SUBSET_1,FUNCT_1,FINSET_1,STRUCT_0,FVSUM_1,MATRIX_2,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,CARD_1,SGRAPH1,MATRIX_1,FUNCOP_1,MATRIX11,SETFAM_1,FINSEQ_2,PRVECT_1,MATRLIN,XREAL_0,XBOOLE_0,VALUED_0,VECTSP_7,RELSET_1;
constructors SETWISEO,FINSOP_1,ALGSTR_1,FVSUM_1,DOMAIN_1,SEQM_3,XXREAL_0,FINSEQ_5,GROUP_4,FINSEQ_7,WELLORD2,NEWTON,STIRL2_1,CARD_FIN,MATRIX_6,MATRIX_7,MATRIX11,LAPLACE,PRVECT_1,VECTSP_6,VECTSP_7,VECTSP_9,NAT_D,BINOP_2,MATRLIN,VALUED_0,RELSET_1,MEASURE6,SETFAM_1,CKB17;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve D for non  empty set;
reserve i for Nat;
reserve j for Nat;
reserve k for Nat;
reserve l for Nat;
reserve m for Nat;
reserve n for Nat;
reserve m9 for Nat;
reserve n9 for Nat;
reserve K for Field;
reserve p for (FinSequence of K);
reserve A9 for (Matrix of n9,m9,D);
reserve nt for (Element of ( n -tuples_on ( NAT ) ));
reserve nt1 for (Element of ( n -tuples_on ( NAT ) ));
reserve mt for (Element of ( m -tuples_on ( NAT ) ));
theorem
Th39: ((i in ( rng nt ) & [: ( rng nt ),( rng mt ) :] c= ( Indices A9 )) implies (ex nt1 st (( rng nt1 ) = ( ( ( rng nt ) \ { i } ) \/ { j } ) & ( Segm (( RLine (A9,i,( Line (A9,j) )) ),nt,mt) ) = ( Segm (A9,nt1,mt) ))))
proof
assume that
A1: i in ( rng nt )
and
A2: [: ( rng nt ),( rng mt ) :] c= ( Indices A9 );
defpred P[ set,set ]
 means
(for k holds (k = $1 implies ((( nt . k ) = i implies $2 = j) & (( nt . k ) <> i implies $2 = ( nt . k )))));
A3: (for k holds (k in ( Seg n ) implies (ex x being (Element of ( NAT )) st P[ k,x ])))
proof
let k;
assume that
k in ( Seg n );
per cases ;
suppose A4: ( nt . k ) = i;

reconsider J = j as (Element of ( NAT )) by ORDINAL1:def 12;
take J;
thus thesis by A4;
end;
suppose A5: ( nt . k ) <> i;

reconsider ntk = ( nt . k ) as (Element of ( NAT )) by ORDINAL1:def 12;
take ntk;
thus thesis by A5;
end;
end;
consider p being (FinSequence of ( NAT )) such that A6: ( dom p ) = ( Seg n ) and A7: (for k being Nat holds (k in ( Seg n ) implies P[ k,( p . k ) ])) from FINSEQ_1:sch 5(A3);
n in ( NAT ) by ORDINAL1:def 12;
then ( len p ) = n by A6,FINSEQ_1:def 3;
then reconsider p9 = p as (Element of ( n -tuples_on ( NAT ) )) by FINSEQ_2:92;
A8: ( rng p9 ) c= ( ( ( rng nt ) \ { i } ) \/ { j } )
proof
let y;
A9: ( dom nt ) = ( Seg n ) by FINSEQ_2:124;
assume y in ( rng p9 );
then consider x being set such that A10: x in ( dom p ) and A11: ( p . x ) = y by FUNCT_1:def 3;
consider k being (Element of ( NAT )) such that A12: x = k and 1 <= k and k <= n by A6,A10;
(( nt . k ) = i or ( nt . k ) <> i);
then ((( p . k ) = j & ( nt . k ) = i) or ((( p . k ) = ( nt . k ) & ( nt . k ) <> i) & ( nt . k ) in ( rng nt ))) by A6,A7,A10,A12,A9,FUNCT_1:def 3;
then (( p . k ) in { j } or (( p . k ) in ( rng nt ) & (not ( p . k ) in { i }))) by TARSKI:def 1;
then (( p . k ) in { j } or ( p . k ) in ( ( rng nt ) \ { i } )) by XBOOLE_0:def 5;
hence thesis by A11,A12,XBOOLE_0:def 3;
end;
take p9;
( ( ( rng nt ) \ { i } ) \/ { j } ) c= ( rng p9 )
proof
let y;
assume that
A13: y in ( ( ( rng nt ) \ { i } ) \/ { j } );
per cases  by A13,XBOOLE_0:def 3;
suppose A14: y in ( ( rng nt ) \ { i } );

then consider x being set such that A15: x in ( dom nt ) and A16: ( nt . x ) = y by FUNCT_1:def 3;
A17: ( dom nt ) = ( Seg n ) by FINSEQ_2:124;
then consider k being (Element of ( NAT )) such that A18: x = k and 1 <= k and k <= n by A15;
(not y in { i }) by A14,XBOOLE_0:def 5;
then y <> i by TARSKI:def 1;
then ( p . k ) = y by A7,A15,A16,A17,A18;
hence thesis by A6,A15,A17,A18,FUNCT_1:def 3;
end;
suppose y in { j };

then A19: y = j by TARSKI:def 1;
consider x being set such that A20: x in ( dom nt ) and A21: ( nt . x ) = i by A1,FUNCT_1:def 3;
A22: ( dom nt ) = ( Seg n ) by FINSEQ_2:124;
then consider k being (Element of ( NAT )) such that A23: x = k and 1 <= k and k <= n by A20;
( p . k ) = j by A7,A20,A21,A22,A23;
hence thesis by A6,A20,A22,A23,A19,FUNCT_1:def 3;
end;
end;
hence ( rng p9 ) = ( ( ( rng nt ) \ { i } ) \/ { j } ) by A8,XBOOLE_0:def 10;
set S = ( Segm (A9,p9,mt) );
set LA = ( Line (A9,j) );
set R = ( RLine (A9,i,LA) );
set SR = ( Segm (R,nt,mt) );
A24: ( Indices A9 ) = ( Indices R ) by MATRIX_1:26;
A25: ( len LA ) = ( width A9 ) by MATRIX_1:def 7;
A26: ( Indices S ) = ( Indices SR ) by MATRIX_1:26;
now
let k;
let l;
assume that
A27: [ k,l ] in ( Indices SR );
reconsider K = k,L = l as (Element of ( NAT )) by ORDINAL1:def 12;
A28: ( SR * (K,L) ) = ( R * (( nt . K ),( mt . L )) ) by A27,CKB17:def 1;
( Indices SR ) = [: ( Seg n ),( Seg ( width SR ) ) :] by MATRIX_1:25;
then A29: K in ( Seg n ) by A27,ZFMISC_1:87;
A30: (( nt . K ) = i or ( nt . K ) <> i);
A31: [ ( nt . K ),( mt . L ) ] in ( Indices A9 ) by A2,A24,A27,CKB18:1;
then ( mt . L ) in ( Seg ( width A9 ) ) by ZFMISC_1:87;
then (((( SR * (K,L) ) = ( LA . ( mt . L ) ) & ( p9 . K ) = j) & ( LA . ( mt . L ) ) = ( A9 * (j,( mt . L )) )) or (( SR * (K,L) ) = ( A9 * (( nt . K ),( mt . L )) ) & ( p9 . K ) = ( nt . K ))) by A7,A25,A31,A28,A30,A29,MATRIX11:def 3,MATRIX_1:def 7;
hence ( SR * (k,l) ) = ( S * (k,l) ) by A26,A27,CKB17:def 1;
end;
hence thesis by MATRIX_1:27;
end;
