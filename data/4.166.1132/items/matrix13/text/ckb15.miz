environ
vocabularies NUMBERS,XBOOLE_0,NAT_1,XCMPLX_0,VECTSP_1,SUBSET_1,FINSEQ_1,MATRIX_1,CARD_1,TREES_1,XXREAL_0,MATRIX_2,QC_LANG1,RELAT_1,SUPINF_2,ARYTM_3,MATRIX_3,FUNCT_1,ZFMISC_1,FINSEQ_2,FUNCT_2,ARYTM_1,FINSET_1,TARSKI,SGRAPH1,CARD_3,ALGSTR_0,SETWISEO,ABIAN,FINSUB_1,BINOP_1,FINSOP_1,CARD_FIN,FUNCOP_1,FUNCT_4,MATRIX11,FINSEQ_5,INT_1,GROUP_1,ABSVALUE,RVSUM_1,STRUCT_0,INCSP_1,FVSUM_1,FREEALG,FINSEQ_3,LAPLACE,CLASSES1,AFINSQ_1,PRVECT_1,RLVECT_2,LMOD_7,VALUED_1,PARTFUN1,RLVECT_3,RLSUB_1,MESFUNC1,RLVECT_5,MATRIX13,RLVECT_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,NAT_D,FINSET_1,RELAT_1,RELSET_1,FUNCT_1,PARTFUN1,FUNCT_2,SETWOP_2,FINSEQ_1,BINOP_1,STRUCT_0,ALGSTR_0,FUNCOP_1,RLVECT_1,GROUP_1,VECTSP_1,SETWISEO,FINSEQ_2,MATRIX_1,FINSUB_1,MATRIX_2,FVSUM_1,FINSOP_1,GROUP_4,MATRIX_3,FINSEQ_7,FUNCT_4,SGRAPH1,NEWTON,FINSEQ_5,DOMAIN_1,MATRIX_6,MATRIX_7,MATRIX11,CARD_FIN,FINSEQ_3,LAPLACE,MEASURE6,PRVECT_1,VECTSP_4,VECTSP_6,VECTSP_7,MATRLIN,VECTSP_9,FINSEQOP;
definitions RLVECT_1,FINSEQ_2,FINSEQ_1,TARSKI,MATRIX_1,FVSUM_1,GROUP_4,MATRIX_2,MATRIX_3,MATRIX_7,MATRIX11,LAPLACE,MEASURE6,VECTSP_1,VECTSP_7,FUNCT_1,RELAT_1,STRUCT_0,ALGSTR_0,FUNCOP_1;
theorems NAT_D,CARD_1,CARD_2,CARD_FIN,COMPUT_1,ENUMSET1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FINSEQ_5,FINSOP_1,FINSUB_1,FRECHET,FUNCT_1,FUNCT_2,FUNCT_4,FUNCT_7,FUNCOP_1,FVSUM_1,GRAPH_2,GRAPH_5,GROUP_1,LAPLACE,MATRIX_1,MATRIX_2,MATRIX_3,MATRIX_7,MATRIX_9,MATRIX11,MATRIXR1,NAT_1,ORDINAL1,PRVECT_1,RELAT_1,RLVECT_1,SETWISEO,SETWOP_2,SGRAPH1,STIRL2_1,TARSKI,VECTSP_1,VECTSP_2,VECTSP_4,VECTSP_6,VECTSP_7,VECTSP_9,VECTSP10,WELLORD2,XBOOLE_0,XBOOLE_1,XREAL_1,ZFMISC_1,XXREAL_0,FINSEQOP,STRUCT_0,MATRIXR2,PARTFUN1,MATRLIN,XREAL_0,MEASURE6,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14;
schemes FINSEQ_1,FINSEQ_2,FUNCT_1,FUNCT_2,NAT_1,PRE_POLY,MATRIX_1;
registrations SUBSET_1,FUNCT_1,FINSET_1,STRUCT_0,FVSUM_1,MATRIX_2,VECTSP_1,FUNCT_2,ORDINAL1,XXREAL_0,NAT_1,FINSEQ_1,RELAT_1,CARD_1,SGRAPH1,MATRIX_1,FUNCOP_1,MATRIX11,SETFAM_1,FINSEQ_2,PRVECT_1,MATRLIN,XREAL_0,XBOOLE_0,VALUED_0,VECTSP_7,RELSET_1;
constructors SETWISEO,FINSOP_1,ALGSTR_1,FVSUM_1,DOMAIN_1,SEQM_3,XXREAL_0,FINSEQ_5,GROUP_4,FINSEQ_7,WELLORD2,NEWTON,STIRL2_1,CARD_FIN,MATRIX_6,MATRIX_7,MATRIX11,LAPLACE,PRVECT_1,VECTSP_6,VECTSP_7,VECTSP_9,NAT_D,BINOP_2,MATRLIN,VALUED_0,RELSET_1,MEASURE6,SETFAM_1;
requirements ARITHM,NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve i for Nat;
reserve j for Nat;
reserve k for Nat;
reserve n for Nat;
reserve K for Field;
reserve M for (Matrix of n,K);
theorem
Th15: (for M being (Matrix of n,K) holds (for M1,M2 being (Upper_Triangular_Matrix of n,K) holds (M = ( M1 * M2 ) implies (M is (Upper_Triangular_Matrix of n,K) & ( diagonal_of_Matrix M ) = ( mlt (( diagonal_of_Matrix M1 ),( diagonal_of_Matrix M2 )) )))))
proof
let M being (Matrix of n,K);
reconsider N = n as (Element of ( NAT )) by ORDINAL1:def 12;
let M1 being (Upper_Triangular_Matrix of n,K);
let M2 being (Upper_Triangular_Matrix of n,K);
assume that
A1: M = ( M1 * M2 );
set SS = [: ( Seg n ),( Seg n ) :];
set KK = (the carrier of K);
A2: ( len M2 ) = n by MATRIX_1:24;
A3: ( width M1 ) = n by MATRIX_1:24;
now
set n0 = ( n |-> ( 0. K ) );
let i;
let j;
assume that
A4: [ i,j ] in ( Indices M )
and
A5: i > j;
set C = ( Col (M2,j) );
set L = ( Line (M1,i) );
reconsider L9 = L,C9 = C as (Element of ( N -tuples_on KK )) by MATRIX_1:24;
set m = ( mlt (L9,C9) );
A6: ( len m ) = n by CARD_1:def 7;
A7:now
let k;
assume that
A8: 1 <= k
and
A9: k <= n;
A10: k in ( NAT ) by ORDINAL1:def 12;
then A11: k in ( Seg n ) by A8,A9;
then A12: ( n0 . k ) = ( 0. K ) by FINSEQ_2:57;
A13: ( Indices M2 ) = SS by MATRIX_1:24;
A14: ( Indices M1 ) = SS by MATRIX_1:24;
A15: ( L . k ) = ( M1 * (i,k) ) by A3,A11,MATRIX_1:def 7;
A16: ( Indices M ) = SS by MATRIX_1:24;
then i in ( Seg n ) by A4,ZFMISC_1:87;
then A17: [ i,k ] in ( Indices M1 ) by A11,A14,ZFMISC_1:87;
j in ( Seg n ) by A4,A16,ZFMISC_1:87;
then A18: [ k,j ] in ( Indices M2 ) by A11,A13,ZFMISC_1:87;
A19: ( dom m ) = ( Seg n ) by A6,FINSEQ_1:def 3;
A20: k in ( Seg n ) by A8,A9,A10;
( dom M2 ) = ( Seg n ) by A2,FINSEQ_1:def 3;
then A21: ( C . k ) = ( M2 * (k,j) ) by A11,MATRIX_1:def 8;
per cases ;
suppose k <= j;

then k < i by A5,XXREAL_0:2;
then A22: ( M1 * (i,k) ) = ( 0. K ) by A17,MATRIX_2:def 3;
( m . k ) = ( ( M1 * (i,k) ) * ( M2 * (k,j) ) ) by A15,A21,A19,A20,FVSUM_1:60;
hence ( m . k ) = ( n0 . k ) by A12,A22,VECTSP_1:12;
end;
suppose k > j;

then A23: ( M2 * (k,j) ) = ( 0. K ) by A18,MATRIX_2:def 3;
( m . k ) = ( ( M1 * (i,k) ) * ( M2 * (k,j) ) ) by A15,A21,A19,A20,FVSUM_1:60;
hence ( m . k ) = ( n0 . k ) by A12,A23,VECTSP_1:12;
end;
end;
( len n0 ) = n by CARD_1:def 7;
then m = n0 by A6,A7,FINSEQ_1:14;
hence ( 0. K ) = ( L "*" C ) by MATRIX_3:11
.= ( M * (i,j) ) by A1,A3,A2,A4,MATRIX_3:def 4;
end;
hence M is (Upper_Triangular_Matrix of n,K) by MATRIX_2:def 3;
set D2 = ( diagonal_of_Matrix M2 );
set D1 = ( diagonal_of_Matrix M1 );
set DM = ( diagonal_of_Matrix M );
A24: ( len D2 ) = n by MATRIX_3:def 10;
( len D1 ) = n by MATRIX_3:def 10;
then reconsider D19 = D1,D29 = D2 as (Element of ( N -tuples_on KK )) by A24,FINSEQ_2:92;
set m = ( mlt (D19,D29) );
A25: ( len m ) = n by CARD_1:def 7;
A26:now
set aa = (the addF of K);
let i;
assume that
A27: 1 <= i
and
A28: i <= n;
i in ( NAT ) by ORDINAL1:def 12;
then A29: i in ( Seg n ) by A27,A28;
then A30: ( DM . i ) = ( M * (i,i) ) by MATRIX_3:def 10;
set C = ( Col (M2,i) );
set L = ( Line (M1,i) );
reconsider L9 = L,C9 = C as (Element of ( N -tuples_on KK )) by MATRIX_1:24;
set mLC = ( mlt (L9,C9) );
A31: aa is  having_a_unity by FVSUM_1:8;
( Indices M ) = SS by MATRIX_1:24;
then [ i,i ] in ( Indices M ) by A29,ZFMISC_1:87;
then A32: ( DM . i ) = ( L "*" C ) by A1,A3,A2,A30,MATRIX_3:def 4;
A33: ( D2 . i ) = ( M2 * (i,i) ) by A29,MATRIX_3:def 10;
A34: ( D1 . i ) = ( M1 * (i,i) ) by A29,MATRIX_3:def 10;
( len mLC ) = n by CARD_1:def 7;
then consider f being (Function of ( NAT ),KK) such that A35: ( f . 1 ) = ( mLC . 1 ) and A36: (for k being (Element of ( NAT )) holds ((( 0 ) <> k & k < n) implies ( f . ( k + 1 ) ) = ( aa . (( f . k ),( mLC . ( k + 1 ) )) ))) and A37: ( DM . i ) = ( f . n ) by A27,A28,A32,A31,FINSOP_1:def 1;
defpred P[ Nat ]
 means
((1 <= $1 & $1 <= n) implies (($1 < i implies ( f . $1 ) = ( 0. K )) & ($1 >= i implies ( f . $1 ) = ( m . i ))));
i in ( dom m ) by A25,A29,FINSEQ_1:def 3;
then A38: ( m . i ) = ( ( M1 * (i,i) ) * ( M2 * (i,i) ) ) by A34,A33,FVSUM_1:60;
A39: (for j holds (j in ( Seg n ) implies ((j <> i implies ( mLC . j ) = ( 0. K )) & (j = i implies ( mLC . j ) = ( m . i )))))
proof
i in ( NAT ) by ORDINAL1:def 12;
then A40: i in ( Seg n ) by A27,A28;
let j;
assume that
A41: j in ( Seg n );
A42: ( L . j ) = ( M1 * (i,j) ) by A3,A41,MATRIX_1:def 7;
( Indices M1 ) = SS by MATRIX_1:24;
then A43: [ i,j ] in ( Indices M1 ) by A41,A40,ZFMISC_1:87;
( dom M2 ) = ( Seg n ) by A2,FINSEQ_1:def 3;
then A44: ( C . j ) = ( M2 * (j,i) ) by A41,MATRIX_1:def 8;
( Indices M2 ) = SS by MATRIX_1:24;
then A45: [ j,i ] in ( Indices M2 ) by A41,A40,ZFMISC_1:87;
per cases ;
suppose A46: i <> j;

then (i < j or j < i) by XXREAL_0:1;
then A47: (( M1 * (i,j) ) = ( 0. K ) or ( M2 * (j,i) ) = ( 0. K )) by A43,A45,MATRIX_2:def 3;
( mLC . j ) = ( ( M1 * (i,j) ) * ( M2 * (j,i) ) ) by A41,A42,A44,FVSUM_1:61;
hence thesis by A46,A47,VECTSP_1:12;
end;
suppose i = j;

hence thesis by A38,A41,A42,A44,FVSUM_1:61;
end;
end;
A48: (for k holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k;
assume that
A49: P[ k ];
set k1 = ( k + 1 );
assume that
A50: 1 <= k1
and
A51: k1 <= n;
A52: k1 in ( Seg n ) by A50,A51;
per cases ;
suppose k = ( 0 );

then ((( f . k1 ) = ( 0. K ) & k1 < i) or (( f . k1 ) = ( mLC . k1 ) & k1 = i)) by A27,A39,A35,A52,XXREAL_0:1;
hence thesis by A39,A52;
end;
suppose A53: k > ( 0 );

A54: k in ( NAT ) by ORDINAL1:def 12;
k < n by A51,NAT_1:13;
then A55: ( f . k1 ) = ( aa . (( f . k ),( mLC . k1 )) ) by A36,A53,A54;
per cases  by XXREAL_0:1;
suppose A56: k1 < i;

then ( f . k1 ) = ( ( 0. K ) + ( 0. K ) ) by A39,A49,A51,A52,A53,A55,NAT_1:13,NAT_1:14;
hence thesis by A56,RLVECT_1:def 4;
end;
suppose A57: k1 = i;

then ( f . k1 ) = ( ( 0. K ) + ( ( M1 * (i,i) ) * ( M2 * (i,i) ) ) ) by A38,A39,A49,A51,A52,A53,A55,NAT_1:13,NAT_1:14;
hence thesis by A38,A57,RLVECT_1:def 4;
end;
suppose A58: k1 > i;

then ( f . k1 ) = ( ( ( M1 * (i,i) ) * ( M2 * (i,i) ) ) + ( 0. K ) ) by A38,A39,A49,A51,A52,A53,A55,NAT_1:13,NAT_1:14;
hence thesis by A38,A58,RLVECT_1:def 4;
end;
end;
end;
A59: 1 <= n by A27,A28,NAT_1:14;
A60: P[ ( 0 ) ];
(for k holds P[ k ]) from NAT_1:sch 2(A60,A48);
hence ( m . i ) = ( DM . i ) by A28,A37,A59;
end;
( len DM ) = n by MATRIX_3:def 10;
hence thesis by A25,A26,FINSEQ_1:14;
end;
