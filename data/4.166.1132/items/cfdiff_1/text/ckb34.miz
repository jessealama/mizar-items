environ
vocabularies NUMBERS,SUBSET_1,REAL_1,XREAL_0,ORDINAL1,CFUNCT_1,COMSEQ_1,PARTFUN1,ORDINAL2,NAT_1,FDIFF_1,VALUED_0,SEQ_2,CARD_1,SEQ_1,FUNCT_1,COMPLEX1,RELAT_1,ARYTM_3,XXREAL_0,ARYTM_1,FUNCOP_1,VALUED_1,FUNCT_2,TARSKI,RCOMP_1,XBOOLE_0,FCONT_1,CFCONT_1,XXREAL_2,CFDIFF_1;
notations TARSKI,SUBSET_1,ORDINAL1,FUNCT_1,NUMBERS,XCMPLX_0,XREAL_0,COMPLEX1,REAL_1,NAT_1,PARTFUN1,FUNCT_2,FUNCOP_1,VALUED_0,VALUED_1,SEQ_1,RELSET_1,SEQ_2,CFUNCT_1,COMSEQ_1,COMSEQ_2,COMSEQ_3,CFCONT_1,XXREAL_0,CKB1,CKB3,CKB13,CKB15,CKB16,CKB18,CKB29,CKB33;
definitions XCMPLX_0,XBOOLE_0,TARSKI,RELAT_1,COMSEQ_2,SEQM_3,CFCONT_1,SUBSET_1,FINSEQ_4,VALUED_0,VALUED_1,SEQ_2,COMPLEX1,FUNCT_2,CKB1,CKB3,CKB13,CKB16,CKB29,CKB33;
theorems TARSKI,NAT_1,FUNCT_1,FUNCT_2,ZFMISC_1,COMPLEX1,SEQ_1,SEQ_2,SEQ_4,NUMBERS,COMSEQ_1,COMSEQ_2,COMSEQ_3,CFUNCT_1,CFCONT_1,RELAT_1,XBOOLE_0,XBOOLE_1,PARTFUN1,PARTFUN2,XCMPLX_0,XCMPLX_1,XREAL_1,XXREAL_0,ORDINAL1,ABSVALUE,XREAL_0,FUNCOP_1,SUBSET_1,VALUED_1,VALUED_0,CKB1,CKB2,CKB3,CKB4,CKB6,CKB11,CKB12,CKB13,CKB16,CKB29,CKB30,CKB31,CKB32,CKB33;
schemes SEQ_1,COMSEQ_1,FUNCT_2;
registrations FUNCT_1,RELSET_1,FUNCT_2,MEMBERED,NUMBERS,ORDINAL1,XREAL_0,XXREAL_0,COMSEQ_2,NAT_1,VALUED_0,SEQ_4,VALUED_1,FUNCOP_1,CKB5,CKB7,CKB8,CKB9,CKB10,CKB14,CKB17,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28;
constructors PARTFUN1,REAL_1,NAT_1,VALUED_0,VALUED_1,SEQ_1,SEQ_2,FINSEQ_4,SEQM_3,PARTFUN2,SQUARE_1,COMSEQ_2,COMSEQ_3,CFCONT_1,XXREAL_0,CFUNCT_1,RELSET_1,CKB1,CKB3,CKB13,CKB16,CKB29,CKB33;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
reserve n for (Element of ( NAT ));
reserve a for Complex;
reserve a1 for Complex;
reserve b for Complex;
reserve b1 for Complex;
reserve x for Complex;
reserve z for Complex;
reserve z0 for Complex;
reserve f for (PartFunc of ( COMPLEX ),( COMPLEX ));
reserve R for C_REST;
reserve R1 for C_REST;
reserve L for C_LINEAR;
reserve L1 for C_LINEAR;
definition
let f;
let z0 being Complex;
assume A1: f is_differentiable_in z0;
func diff (f,z0) -> Complex means 
:Def7: (ex N being (Neighbourhood of z0) st (N c= ( dom f ) & (ex L st (ex R st (it = ( L /. ( 1r ) ) & (for z being Complex holds (z in N implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) ))))))));
existence
proof
consider N being (Neighbourhood of z0) such that A2: N c= ( dom f ) and A3: (ex L st (ex R st (for z holds (z in N implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) ))))) by A1,CKB33:def 1;
consider L,R such that A4: (for z being Complex holds (z in N implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) ))) by A3;
consider a being Complex such that A5: (for d being Complex holds ( L /. d ) = ( a * d )) by CKB16:def 1;
take a;
( L /. ( 1r ) ) = ( a * ( 1r ) ) by A5
.= a;
hence thesis by A2,A4;
end;
uniqueness
proof
set s0 = ( InvShift 2 );
let a being Complex;
let b being Complex;
assume that
A6: (ex N being (Neighbourhood of z0) st (N c= ( dom f ) & (ex L st (ex R st (a = ( L /. ( 1r ) ) & (for z holds (z in N implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) ))))))))
and
A7: (ex N being (Neighbourhood of z0) st (N c= ( dom f ) & (ex L st (ex R st (b = ( L /. ( 1r ) ) & (for z holds (z in N implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) ))))))));
consider N being (Neighbourhood of z0) such that N c= ( dom f ) and A8: (ex L st (ex R st (a = ( L /. ( 1r ) ) & (for z being Complex holds (z in N implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) )))))) by A6;
consider L,R such that A9: a = ( L /. ( 1r ) ) and A10: (for z being Complex holds (z in N implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) ))) by A8;
consider a1 such that A11: (for b holds ( L /. b ) = ( a1 * b )) by CKB16:def 1;
consider N1 being (Neighbourhood of z0) such that N1 c= ( dom f ) and A12: (ex L st (ex R st (b = ( L /. ( 1r ) ) & (for z holds (z in N1 implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) )))))) by A7;
consider L1,R1 such that A13: b = ( L1 /. ( 1r ) ) and A14: (for z holds (z in N1 implies ( ( f /. z ) - ( f /. z0 ) ) = ( ( L1 /. ( z - z0 ) ) + ( R1 /. ( z - z0 ) ) ))) by A12;
consider b1 such that A15: (for b holds ( L1 /. b ) = ( b1 * b )) by CKB16:def 1;
reconsider s0 as Complex_Sequence;
consider N0 being (Neighbourhood of z0) such that A16: (N0 c= N & N0 c= N1) by CKB32:1;
consider g being Real such that A17: ( 0 ) < g and A18: { y where y is Complex: |. ( y - z0 ) .| < g } c= N0 by CKB29:def 1;
set s1 = ( g (#) s0 );
A19:now
let n;
thus ( s1 . n ) = ( g * ( s0 . n ) ) by VALUED_1:6
.= ( g * ( 1 / ( n + 2 ) ) ) by CKB3:def 1
.= ( g / ( n + 2 ) );
end;
now
let n;
( s1 . n ) = ( g / ( n + 2 ) ) by A19;
hence ( 0 ) <> ( s1 . n ) by A17,XREAL_1:139;
end;
then A20: s1 is  non-zero by COMSEQ_1:4;
( lim s0 ) = ( 0 ) by CKB6:1;
then ( lim s1 ) = ( g * ( 0 ) ) by COMSEQ_2:18;
then reconsider h = s1 as  convergent_to_0 Complex_Sequence by A20,CKB1:def 1;
A21: (for n holds (ex x being Complex st ((x in N & x in N1) & ( h . n ) = ( x - z0 ))))
proof
let n;
( g / ( n + 2 ) ) in ( REAL );
then reconsider g0 = ( g / ( n + 2 ) ) as Complex by NUMBERS:11;
take x = ( z0 + g0 );
( ( 0 ) + 1 ) < ( ( n + 1 ) + 1 ) by XREAL_1:6;
then A22: ( g / ( n + 2 ) ) < ( g / 1 ) by A17,XREAL_1:76;
|. ( ( z0 + g0 ) - z0 ) .| = ( g / ( n + 2 ) ) by A17,ABSVALUE:def 1;
then x in { y where y is Complex: |. ( y - z0 ) .| < g } by A22;
then x in N0 by A18;
hence thesis by A16,A19;
end;
A23: a = ( a1 * ( 1r ) ) by A9,A11;
A24:now
let z being Complex;
assume that
A25: z in N
and
A26: z in N1;
( ( f /. z ) - ( f /. z0 ) ) = ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) ) by A10,A25;
then ( ( L /. ( z - z0 ) ) + ( R /. ( z - z0 ) ) ) = ( ( L1 /. ( z - z0 ) ) + ( R1 /. ( z - z0 ) ) ) by A14,A26;
then ( ( a1 * ( z - z0 ) ) + ( R /. ( z - z0 ) ) ) = ( ( L1 /. ( z - z0 ) ) + ( R1 /. ( z - z0 ) ) ) by A11;
then ( ( ( a1 * ( 1r ) ) * ( z - z0 ) ) + ( R /. ( z - z0 ) ) ) = ( ( ( b1 * ( 1r ) ) * ( z - z0 ) ) + ( R1 /. ( z - z0 ) ) ) by A15;
hence ( ( a * ( z - z0 ) ) + ( R /. ( z - z0 ) ) ) = ( ( b * ( z - z0 ) ) + ( R1 /. ( z - z0 ) ) ) by A13,A15,A23;
end;
now
( dom R1 ) = ( COMPLEX ) by PARTFUN1:def 2;
then A27: ( rng h ) c= ( dom R1 );
( dom R ) = ( COMPLEX ) by PARTFUN1:def 2;
then A28: ( rng h ) c= ( dom R );
let n being Nat;
A29: n in ( NAT ) by ORDINAL1:def 12;
then A30: ( h . n ) <> ( 0c ) by COMSEQ_1:4;
(ex x being Complex st ((x in N & x in N1) & ( h . n ) = ( x - z0 ))) by A21,A29;
then ( ( a * ( h . n ) ) + ( R /. ( h . n ) ) ) = ( ( b * ( h . n ) ) + ( R1 /. ( h . n ) ) ) by A24;
then A31: ( ( ( a * ( h . n ) ) / ( h . n ) ) + ( ( R /. ( h . n ) ) / ( h . n ) ) ) = ( ( ( b * ( h . n ) ) + ( R1 /. ( h . n ) ) ) / ( h . n ) ) by XCMPLX_1:62;
A32: ( ( b * ( h . n ) ) / ( h . n ) ) = ( b * ( ( h . n ) / ( h . n ) ) )
.= ( b * 1 ) by A30,XCMPLX_1:60
.= b;
A33: ( ( R1 /. ( h . n ) ) / ( h . n ) ) = ( ( R1 /. ( h . n ) ) * ( ( h " ) . n ) ) by VALUED_1:10
.= ( ( ( R1 /* h ) . n ) * ( ( h " ) . n ) ) by A29,A27,FUNCT_2:108
.= ( ( ( h " ) (#) ( R1 /* h ) ) . n ) by VALUED_1:5;
A34: ( ( a * ( h . n ) ) / ( h . n ) ) = ( a * ( ( h . n ) / ( h . n ) ) )
.= ( a * 1 ) by A30,XCMPLX_1:60
.= a;
( ( R /. ( h . n ) ) / ( h . n ) ) = ( ( R /. ( h . n ) ) * ( ( h " ) . n ) ) by VALUED_1:10
.= ( ( ( R /* h ) . n ) * ( ( h " ) . n ) ) by A29,A28,FUNCT_2:109
.= ( ( ( h " ) (#) ( R /* h ) ) . n ) by VALUED_1:5;
hence ( a - b ) = ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) + ( - ( ( ( h " ) (#) ( R /* h ) ) . n ) ) ) by A31,A34,A32,A33
.= ( ( ( ( h " ) (#) ( R1 /* h ) ) . n ) + ( ( - ( ( h " ) (#) ( R /* h ) ) ) . n ) ) by VALUED_1:8
.= ( ( ( ( h " ) (#) ( R1 /* h ) ) + ( - ( ( h " ) (#) ( R /* h ) ) ) ) . n ) by A29,VALUED_1:1;
end;
then (( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) is  constant & ( ( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) . 1 ) = ( a - b )) by VALUED_0:def 18;
then A35: ( lim ( ( ( h " ) (#) ( R1 /* h ) ) - ( ( h " ) (#) ( R /* h ) ) ) ) = ( a - b ) by CFCONT_1:28;
A36: (( ( h " ) (#) ( R1 /* h ) ) is  convergent & ( lim ( ( h " ) (#) ( R1 /* h ) ) ) = ( 0 )) by CKB13:def 1;
(( ( h " ) (#) ( R /* h ) ) is  convergent & ( lim ( ( h " ) (#) ( R /* h ) ) ) = ( 0 )) by CKB13:def 1;
then ( a - b ) = ( ( 0 ) - ( 0 ) ) by A35,A36,COMSEQ_2:26;
hence thesis;
end;
end;
