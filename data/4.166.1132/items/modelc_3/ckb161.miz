environ
vocabularies NUMBERS,NAT_1,XBOOLE_0,FINSEQ_1,MODELC_2,SUBSET_1,ZF_LANG,XREAL_0,ORDINAL1,FUNCT_1,RELAT_1,XXREAL_0,INT_1,ARYTM_3,ARYTM_1,CARD_1,STRUCT_0,TARSKI,XBOOLEAN,LATTICES,CAT_3,ORDINAL4,ZF_MODEL,MODELC_1,FINSET_1,SEQ_1,REAL_1,CARD_3,SERIES_1,ZFMISC_1,MSUALG_3,ORDERS_1,SUBSTUT1,FSM_1,FSM_2,VALUED_1,MODELC_3;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,FINSET_1,CARD_1,NUMBERS,XCMPLX_0,XREAL_0,REAL_1,XXREAL_0,NAT_1,RELAT_1,FUNCT_1,RELSET_1,FINSEQ_1,ORDERS_1,FUNCT_2,INT_1,SEQ_1,SERIES_1,PARTFUN1,STRUCT_0,MODELC_1,MODELC_2,RFINSEQ2,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB32,CKB33,CKB34,CKB35,CKB36,CKB38,CKB39,CKB40,CKB54,CKB55,CKB56,CKB64,CKB76,CKB77,CKB82,CKB106,CKB108,CKB114,CKB115,CKB132,CKB134,CKB138,CKB140,CKB142,CKB148,CKB149,CKB150,CKB151,CKB152,CKB153,CKB154,CKB155,CKB156,CKB157,CKB159,CKB160;
definitions TARSKI,MODELC_2,SERIES_1,CKB16,CKB17,CKB18,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB32,CKB33,CKB34,CKB35,CKB36,CKB38,CKB39,CKB40,CKB54,CKB55,CKB56,CKB64,CKB76,CKB77,CKB82,CKB106,CKB108,CKB114,CKB115,CKB132,CKB134,CKB138,CKB140,CKB142,CKB149,CKB150,CKB151,CKB152,CKB153,CKB154,CKB155,CKB156,CKB157,CKB159,CKB160;
theorems XBOOLE_0,ZFMISC_1,XBOOLE_1,TARSKI,FUNCT_1,FUNCT_2,FUNCT_7,WELLORD2,NAT_1,INT_1,ENUMSET1,XREAL_1,FINSEQ_1,ORDERS_1,XXREAL_0,MODELC_1,MODELC_2,ORDINAL1,SUBSET_1,FINSEQ_4,SERIES_1,CARD_1,CARD_2,SERIES_2,FINSET_1,RFINSEQ2,FINSEQ_3,SUBSET,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB16,CKB17,CKB18,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB75,CKB76,CKB77,CKB78,CKB79,CKB80,CKB81,CKB82,CKB83,CKB84,CKB85,CKB86,CKB87,CKB88,CKB89,CKB90,CKB91,CKB92,CKB93,CKB94,CKB95,CKB96,CKB97,CKB98,CKB99,CKB100,CKB101,CKB102,CKB103,CKB104,CKB105,CKB106,CKB108,CKB110,CKB111,CKB112,CKB113,CKB114,CKB115,CKB116,CKB117,CKB118,CKB119,CKB120,CKB121,CKB122,CKB123,CKB124,CKB125,CKB126,CKB127,CKB128,CKB131,CKB132,CKB133,CKB134,CKB135,CKB136,CKB137,CKB138,CKB139,CKB140,CKB142,CKB143,CKB144,CKB145,CKB146,CKB147,CKB149,CKB150,CKB151,CKB152,CKB153,CKB154,CKB155,CKB156,CKB157,CKB158,CKB159,CKB160;
schemes NAT_1,FUNCT_2,MODELC_2,TARSKI,FUNCT_1,FINSEQ_1,RECDEF_1;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,XXREAL_0,XREAL_0,NAT_1,INT_1,ORDERS_1,FINSET_1,MODELC_2,FINSEQ_1,NUMBERS,VALUED_0,MEMBERED,STRUCT_0,MODELC_1,CARD_1,RELSET_1,FUNCT_2,CKB19,CKB31,CKB53,CKB107,CKB109,CKB129,CKB130,CKB141,CKB148;
constructors KNASTER,MODELC_2,SERIES_1,REAL_1,NEWTON,RFINSEQ2,SEQ_1,RELSET_1,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB32,CKB33,CKB34,CKB35,CKB36,CKB38,CKB39,CKB40,CKB54,CKB55,CKB56,CKB64,CKB76,CKB77,CKB82,CKB106,CKB108,CKB114,CKB115,CKB132,CKB134,CKB138,CKB140,CKB142,CKB148,CKB149,CKB150,CKB151,CKB152,CKB153,CKB154,CKB155,CKB156,CKB157,CKB159,CKB160;
requirements REAL,NUMERALS,ARITHM,SUBSET,BOOLE;
begin
reserve k for Nat;
reserve L for FinSequence;
reserve w for (Element of ( Inf_seq ( AtomicFamily ) ));
reserve v for  neg-inner-most LTL-formula;
reserve U for (Choice_Function of ( BOOL ( Subformulae v ) ));
reserve N1 for  strict LTLnode over v;
reserve M1 for  strict LTLnode over v;
reserve s for  elementary  strict LTLnode over v;
theorem
Th69: (w |= ( * ( 'X' s ) ) implies (( chosen_next (w,v,U,s) ) is_next_of s & w |= ( * ( chosen_next (w,v,U,s) ) )))
proof
set LN = ( LTLNodes v );
set N = ( 'X' s );
assume A1: w |= ( * N );
set n = ( chosen_succ_end_num (w,v,U,N) );
set f = ( choice_succ_func (w,v,U) );
set nextnode = ( CastNode (( ( f |** n ) . N ),v) );
A2: N in LN by CKB106:def 1;
now
per cases ;
suppose A3: N is non elementary;

deffunc F(set) = ( CastNode (( ( f |** ( CastNat ( ( CastNat $1 ) - 1 ) ) ) . N ),v) );
set n1 = ( n + 1 );
(ex L st (( len L ) = n1 & (for k being Nat holds (k in ( dom L ) implies ( L . k ) = F(k))))) from FINSEQ_1:sch 2;
then consider L such that A4: ( len L ) = n1 and A5: (for k being Nat holds (k in ( dom L ) implies ( L . k ) = F(k)));
A6: ( Seg n1 ) = ( dom L ) by A4,FINSEQ_1:def 3;
A7: (for k holds ((1 <= k & k <= n1) implies ( L . k ) = ( CastNode (( ( f |** ( CastNat ( k - 1 ) ) ) . N ),v) )))
proof
let k;
assume (1 <= k & k <= n1);
then k in ( Seg n1 ) by FINSEQ_1:1;
then ( L . k ) = ( CastNode (( ( f |** ( CastNat ( ( CastNat k ) - 1 ) ) ) . N ),v) ) by A5,A6;
hence thesis by MODELC_2:def 1;
end;
(for k holds ((1 <= k & k < ( len L )) implies (ex N1 st (ex M1 st ((N1 = ( L . k ) & M1 = ( L . ( k + 1 ) )) & M1 is_succ_of N1)))))
proof
let k;
assume that
A8: 1 <= k
and
A9: k < ( len L );
set k1 = ( k - 1 );
reconsider k1 as Nat by A8,NAT_1:21;
set M1 = ( CastNode (( ( f |** ( k1 + 1 ) ) . N ),v) );
set kp = ( k + 1 );
(1 <= kp & kp <= n1) by A4,A8,A9,NAT_1:13;
then A10: ( L . ( k + 1 ) ) = ( CastNode (( ( f |** ( CastNat ( kp - 1 ) ) ) . N ),v) ) by A7
.= M1 by MODELC_2:def 1;
set N1 = ( CastNode (( ( f |** k1 ) . N ),v) );
( k - 1 ) < ( n1 - 1 ) by A4,A9,XREAL_1:14;
then A11: M1 is_succ_of N1 by A1,A3,CKB159:def 1;
( L . k ) = ( CastNode (( ( f |** ( CastNat k1 ) ) . N ),v) ) by A4,A7,A8,A9
.= N1 by MODELC_2:def 1;
hence thesis by A11,A10;
end;
then A12: L is_Finseq_for v by CKB36:def 1;
A13: 1 <= n1 by NAT_1:11;
then A14: ( L . ( len L ) ) = ( CastNode (( ( f |** ( CastNat ( n1 - 1 ) ) ) . N ),v) ) by A4,A7
.= nextnode by MODELC_2:def 1;
A15: nextnode = ( chosen_next (w,v,U,s) ) by A1,A3,CKB160:def 1;
( L . 1 ) = ( CastNode (( ( f |** ( CastNat ( 1 - 1 ) ) ) . N ),v) ) by A13,A7
.= ( CastNode (( ( f |** ( 0 ) ) . N ),v) ) by MODELC_2:def 1
.= ( CastNode (( ( id LN ) . N ),v) ) by FUNCT_7:84
.= ( CastNode (N,v) ) by A2,FUNCT_1:18
.= ( 'X' s ) by CKB33:def 1;
hence thesis by A1,A3,A15,A13,A4,A14,A12,CKB38:def 1,CKB159:def 1;
end;
suppose N is  elementary;

then (the LTLnew of N) = (the LTLnew of ( FinalNode v )) by CKB27:def 1;
then A16: ( chosen_next (w,v,U,s) ) = N by A1,CKB160:def 1;
set L = <* N *>;
A17: ( Seg 1 ) = ( dom L ) by FINSEQ_1:38;
A18: (for n being Nat holds (n in ( dom L ) implies ( L . n ) = N))
proof
let n being Nat;
assume n in ( dom L );
then n = 1 by A17,FINSEQ_1:2,TARSKI:def 1;
hence thesis by FINSEQ_1:40;
end;
(for k holds ((1 <= k & k < ( len L )) implies (ex N1 st (ex M1 st ((N1 = ( L . k ) & M1 = ( L . ( k + 1 ) )) & M1 is_succ_of N1))))) by FINSEQ_1:39;
then A19: L is_Finseq_for v by CKB36:def 1;
1 in ( Seg 1 ) by FINSEQ_1:1;
then (( len L ) = 1 & ( L . 1 ) = ( 'X' s )) by A17,A18,FINSEQ_1:39;
hence thesis by A1,A16,A19,CKB38:def 1;
end;
end;
hence thesis;
end;
