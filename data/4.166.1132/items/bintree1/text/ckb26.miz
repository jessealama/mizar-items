environ
vocabularies NUMBERS,XBOOLE_0,TREES_2,SUBSET_1,FUNCT_1,TREES_4,TREES_3,FINSEQ_1,TREES_1,ORDINAL1,ORDINAL4,CARD_1,XXREAL_0,ARYTM_3,FINSET_1,RELAT_1,TARSKI,TREES_A,LANG1,TDGROUP,DTCONSTR,STRUCT_0,ZFMISC_1,FUNCT_2,BINTREE1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,NAT_1,RELAT_1,STRUCT_0,MCART_1,FUNCT_1,RELSET_1,FUNCT_2,FINSEQ_1,FINSET_1,LANG1,TREES_1,TREES_2,TREES_3,TREES_4,DTCONSTR,PRE_POLY,XXREAL_0,CKB1,CKB4,CKB11,CKB20;
definitions DTCONSTR,CKB1,CKB4,CKB11,CKB20;
theorems TARSKI,NAT_1,MCART_1,ZFMISC_1,ENUMSET1,MODAL_1,RELSET_1,FUNCT_1,FUNCT_2,FINSEQ_1,FINSEQ_2,FINSEQ_3,LANG1,TREES_1,TREES_2,TREES_3,TREES_4,DTCONSTR,FINSET_1,RELAT_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB8,CKB9,CKB11,CKB15,CKB16,CKB17,CKB18,CKB20,CKB23;
schemes FUNCT_2,DTCONSTR,MULTOP_1,CKB22,CKB24,CKB25;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,MEMBERED,FINSEQ_1,TREES_2,TREES_3,STRUCT_0,DTCONSTR,FINSET_1,PRE_POLY,TREES_4,TREES_1,RELSET_1,CKB6,CKB7,CKB10,CKB12,CKB13,CKB14,CKB19,CKB21;
constructors DOMAIN_1,XXREAL_0,NAT_1,MEMBERED,FINSEQOP,DTCONSTR,RELSET_1,PRE_POLY,CKB1,CKB4,CKB11,CKB20;
requirements NUMERALS,REAL,SUBSET,BOOLE,ARITHM;
begin
scheme BinDTConstrUniqDef { G() ->  binary  with_terminals  with_nonterminals  with_useful_nonterminals non empty DTConstrStr,D() -> non empty set,f1,f2() -> (Function of ( TS G() ),D()),TermVal(set) -> (Element of D()),NTermVal(set,set,set,set,set) -> (Element of D()) } : f1() = f2()
provided
A1: ((for t being (Terminal of G()) holds ( f1() . ( root-tree t ) ) = TermVal(t)) & (for nt being (NonTerminal of G()) holds (for tl,tr being (Element of ( TS G() )) holds (for rtl,rtr being (Symbol of G()) holds (((rtl = ( root-label tl ) & rtr = ( root-label tr )) & nt ==> <* rtl,rtr *>) implies (for xl,xr being (Element of D()) holds ((xl = ( f1() . tl ) & xr = ( f1() . tr )) implies ( f1() . ( nt -tree (tl,tr) ) ) = NTermVal(nt,rtl,rtr,xl,xr))))))))
and
A2: ((for t being (Terminal of G()) holds ( f2() . ( root-tree t ) ) = TermVal(t)) & (for nt being (NonTerminal of G()) holds (for tl,tr being (Element of ( TS G() )) holds (for rtl,rtr being (Symbol of G()) holds (((rtl = ( root-label tl ) & rtr = ( root-label tr )) & nt ==> <* rtl,rtr *>) implies (for xl,xr being (Element of D()) holds ((xl = ( f2() . tl ) & xr = ( f2() . tr )) implies ( f2() . ( nt -tree (tl,tr) ) ) = NTermVal(nt,rtl,rtr,xl,xr))))))))
proof
deffunc BNTV((Symbol of G()),FinSequence,(FinSequence of D())) = NTermVal($1,( $2 . 1 ),( $2 . 2 ),( $3 . 1 ),( $3 . 2 ));
A3:now
thus (for t being (Symbol of G()) holds (t in ( Terminals G() ) implies ( f2() . ( root-tree t ) ) = TermVal(t))) by A2;
let nt being (Symbol of G());
let ts being (FinSequence of ( TS G() ));
set rts = ( roots ts );
set x = ( f2() * ts );
assume A4: nt ==> rts;
then consider tl being (Element of ( TS G() )),tr being (Element of ( TS G() )) such that A5: ( roots ts ) = <* ( root-label tl ),( root-label tr ) *> and A6: tl = ( ts . 1 ) and A7: tr = ( ts . 2 ) and A8: ( nt -tree ts ) = ( nt -tree (tl,tr) ) and tl in ( rng ts ) and tr in ( rng ts ) by CKB23:1;
A9: nt is (NonTerminal of G()) by A4,CKB23:1;
reconsider xr = ( f2() . tr ) as (Element of D());
2 in ( dom ts ) by A4,CKB23:1;
then A10: ( x . 2 ) = xr by A7,FUNCT_1:13;
reconsider xl = ( f2() . tl ) as (Element of D());
1 in ( dom ts ) by A4,CKB23:1;
then A11: ( x . 1 ) = xl by A6,FUNCT_1:13;
(( root-label tl ) = ( rts . 1 ) & ( root-label tr ) = ( rts . 2 )) by A5,FINSEQ_1:44;
hence ( f2() . ( nt -tree ts ) ) = BNTV(nt,rts,x) by A2,A4,A5,A8,A9,A11,A10;
end;
A12:now
thus (for t being (Symbol of G()) holds (t in ( Terminals G() ) implies ( f1() . ( root-tree t ) ) = TermVal(t))) by A1;
let nt being (Symbol of G());
let ts being (FinSequence of ( TS G() ));
set rts = ( roots ts );
set x = ( f1() * ts );
assume A13: nt ==> rts;
then consider tl being (Element of ( TS G() )),tr being (Element of ( TS G() )) such that A14: ( roots ts ) = <* ( root-label tl ),( root-label tr ) *> and A15: tl = ( ts . 1 ) and A16: tr = ( ts . 2 ) and A17: ( nt -tree ts ) = ( nt -tree (tl,tr) ) and tl in ( rng ts ) and tr in ( rng ts ) by CKB23:1;
A18: nt is (NonTerminal of G()) by A13,CKB23:1;
reconsider xr = ( f1() . tr ) as (Element of D());
2 in ( dom ts ) by A13,CKB23:1;
then A19: ( x . 2 ) = xr by A16,FUNCT_1:13;
reconsider xl = ( f1() . tl ) as (Element of D());
1 in ( dom ts ) by A13,CKB23:1;
then A20: ( x . 1 ) = xl by A15,FUNCT_1:13;
(( root-label tl ) = ( rts . 1 ) & ( root-label tr ) = ( rts . 2 )) by A14,FINSEQ_1:44;
hence ( f1() . ( nt -tree ts ) ) = BNTV(nt,rts,x) by A1,A13,A14,A17,A18,A20,A19;
end;
thus thesis from DTCONSTR:sch 9(A12,A3);
end;
