environ
vocabularies NUMBERS,XREAL_0,ORDINAL1,XXREAL_0,CARD_1,RELAT_1,ARYTM_1,INT_1,ARYTM_3,SIN_COS,FUNCT_1,XXREAL_1,XBOOLE_0,SUBSET_1,REAL_1,XCMPLX_0,COMPLEX1,COMPTRIG,TARSKI,PROB_2,SQUARE_1,FINSEQ_6,COMPLEX2;
notations TARSKI,SUBSET_1,SQUARE_1,RELAT_1,SEQ_1,RCOMP_1,SIN_COS,XXREAL_0,COMPTRIG,XREAL_0,ORDINAL1,NUMBERS,INT_1,XCMPLX_0,REAL_1,COMPLEX1,CKB30,CKB54,CKB65;
definitions SQUARE_1,XCMPLX_0,CKB30,CKB54,CKB65;
theorems SQUARE_1,COMPLEX1,SIN_COS,COMPTRIG,XCMPLX_0,XCMPLX_1,RFUNCT_2,SIN_COS2,XREAL_0,XBOOLE_0,INT_1,ABSVALUE,XREAL_1,XXREAL_0,XXREAL_1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB47,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB56,CKB57,CKB58,CKB59,CKB60,CKB61,CKB62,CKB63,CKB64,CKB65,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73;
registrations RELSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,INT_1,MEMBERED,SIN_COS,VALUED_0,XBOOLE_0;
constructors FUNCT_4,ARYTM_0,REAL_1,SQUARE_1,BINOP_2,SEQ_1,RCOMP_1,RFUNCT_2,COMSEQ_3,SIN_COS,COMPTRIG,PARTFUN1,RVSUM_1,RELSET_1,CKB30,CKB54,CKB65;
requirements BOOLE,SUBSET,REAL,NUMERALS,ARITHM;
begin
reserve a for (Element of ( COMPLEX ));
reserve b for (Element of ( COMPLEX ));
theorem
Th83: ((a <> ( 0 ) & b <> ( 0 )) implies (( cos ( angle (a,b) ) ) = ( ( Re ( a .|. b ) ) / ( |. a .| * |. b .| ) ) & ( sin ( angle (a,b) ) ) = ( - ( ( Im ( a .|. b ) ) / ( |. a .| * |. b .| ) ) )))
proof
assume that
A1: a <> ( 0 )
and
A2: b <> ( 0 );
A3: (|. a .| <> ( 0 ) & |. b .| <> ( 0 )) by A1,A2,COMPLEX1:45;
set ra = ( Rotate (a,( - ( Arg a ) )) );
set rb = ( Rotate (b,( - ( Arg a ) )) );
set r = ( - ( Arg a ) );
set mabi = ( ( |. a .| * |. b .| ) " );
A4: (|. a .| >= ( 0 ) & |. b .| >= ( 0 )) by COMPLEX1:46;
( angle (a,b) ) = ( angle (ra,rb) ) by A1,A2,CKB70:1;
then A5: ( angle (a,b) ) = ( angle (( |. a .| * mabi ),( rb * mabi )) ) by A3,A4,CKB68:1,SIN_COS:31
.= ( Arg ( rb * mabi ) ) by A4,CKB66:1;
A6: a = ( ( |. a .| * ( cos ( Arg a ) ) ) + ( ( |. a .| * ( sin ( Arg a ) ) ) * ( <i> ) ) ) by CKB12:1;
then ( Re a ) = ( |. a .| * ( cos ( Arg a ) ) ) by COMPLEX1:12;
then A7: ( cos ( Arg a ) ) = ( ( Re a ) / |. a .| ) by A1,COMPLEX1:45,XCMPLX_1:89;
( Im a ) = ( |. a .| * ( sin ( Arg a ) ) ) by A6,COMPLEX1:12;
then A8: ( sin ( Arg a ) ) = ( ( Im a ) / |. a .| ) by A1,COMPLEX1:45,XCMPLX_1:89;
A9: ( a .|. b ) = ( ( ( ( Re a ) * ( Re b ) ) + ( ( Im a ) * ( Im b ) ) ) + ( ( ( - ( ( Re a ) * ( Im b ) ) ) + ( ( Im a ) * ( Re b ) ) ) * ( <i> ) ) ) by CKB31:1;
then A10: ( Re ( a .|. b ) ) = ( ( ( Re a ) * ( Re b ) ) + ( ( Im a ) * ( Im b ) ) ) by COMPLEX1:12;
( Re rb ) = ( ( ( Re b ) * ( cos r ) ) - ( ( Im b ) * ( sin r ) ) ) by CKB60:1;
then A11: ( Re rb ) = ( ( ( Re b ) * ( cos r ) ) - ( ( Im b ) * ( - ( sin ( Arg a ) ) ) ) ) by SIN_COS:31
.= ( ( ( Re b ) * ( ( Re a ) / |. a .| ) ) + ( ( Im b ) * ( ( Im a ) / |. a .| ) ) ) by A7,A8,SIN_COS:31
.= ( ( Re ( a .|. b ) ) / |. a .| ) by A10;
A12: ( ( Im rb ) ^2 ) >= ( 0 ) by XREAL_1:63;
( Im rb ) = ( ( ( Re b ) * ( sin r ) ) + ( ( Im b ) * ( cos r ) ) ) by CKB60:1;
then A13: ( Im rb ) = ( ( ( Re b ) * ( - ( sin ( Arg a ) ) ) ) + ( ( Im b ) * ( cos r ) ) ) by SIN_COS:31
.= ( ( ( - ( Re b ) ) * ( ( Im a ) / |. a .| ) ) + ( ( Im b ) * ( ( Re a ) / |. a .| ) ) ) by A7,A8,SIN_COS:31
.= ( - ( ( - ( ( ( - ( Re b ) ) * ( Im a ) ) + ( ( Im b ) * ( Re a ) ) ) ) / |. a .| ) )
.= ( - ( ( Im ( a .|. b ) ) / |. a .| ) ) by A9,COMPLEX1:12;
set IT = ( rb * mabi );
set mab = ( |. a .| * |. b .| );
A14: (( mabi ^2 ) >= ( 0 ) & ( ( Re rb ) ^2 ) >= ( 0 )) by XREAL_1:63;
mabi = ( mabi + ( ( 0 ) * ( <i> ) ) );
then A15: (( Re mabi ) = mabi & ( Im mabi ) = ( 0 )) by COMPLEX1:12;
then A16: ( Re IT ) = ( ( ( Re rb ) * mabi ) - ( ( Im rb ) * ( 0 ) ) ) by COMPLEX1:9
.= ( ( Re rb ) * mabi );
A17: ( Im IT ) = ( ( ( Re rb ) * ( 0 ) ) + ( ( Im rb ) * mabi ) ) by A15,COMPLEX1:9
.= ( ( Im rb ) * mabi );
then A18: |. IT .| = ( sqrt ( ( ( ( Re rb ) * mabi ) ^2 ) + ( ( ( Im rb ) * mabi ) ^2 ) ) ) by A16,COMPLEX1:def 12
.= ( sqrt ( ( mabi ^2 ) * ( ( ( Re rb ) ^2 ) + ( ( Im rb ) ^2 ) ) ) )
.= ( ( sqrt ( mabi ^2 ) ) * ( sqrt ( ( ( Re rb ) ^2 ) + ( ( Im rb ) ^2 ) ) ) ) by A14,A12,SQUARE_1:29
.= ( mabi * ( sqrt ( ( ( Re rb ) ^2 ) + ( ( Im rb ) ^2 ) ) ) ) by A4,SQUARE_1:22
.= ( mabi * |. rb .| ) by COMPLEX1:def 12
.= ( mabi * |. b .| ) by CKB57:1;
A19: IT = ( ( |. IT .| * ( cos ( Arg IT ) ) ) + ( ( |. IT .| * ( sin ( Arg IT ) ) ) * ( <i> ) ) ) by CKB12:1;
then ( |. IT .| * ( cos ( Arg IT ) ) ) = ( ( Re rb ) * mabi ) by A16,COMPLEX1:12;
hence ( cos ( angle (a,b) ) ) = ( ( ( Re rb ) * mabi ) / |. IT .| ) by A3,A5,A18,XCMPLX_1:89
.= ( ( Re rb ) * ( mabi / |. IT .| ) )
.= ( ( ( Re ( a .|. b ) ) / |. a .| ) * ( ( mabi / mabi ) / |. b .| ) ) by A11,A18,XCMPLX_1:78
.= ( ( ( Re ( a .|. b ) ) / |. a .| ) * ( 1 / |. b .| ) ) by A3,XCMPLX_1:60
.= ( ( ( Re ( a .|. b ) ) * 1 ) / ( |. a .| * |. b .| ) ) by XCMPLX_1:76
.= ( ( Re ( a .|. b ) ) / mab );
( |. IT .| * ( sin ( Arg IT ) ) ) = ( ( Im rb ) * mabi ) by A19,A17,COMPLEX1:12;
hence ( sin ( angle (a,b) ) ) = ( ( ( Im rb ) * mabi ) / |. IT .| ) by A3,A5,A18,XCMPLX_1:89
.= ( ( Im rb ) * ( mabi / |. IT .| ) )
.= ( ( - ( ( Im ( a .|. b ) ) / |. a .| ) ) * ( ( mabi / mabi ) / |. b .| ) ) by A13,A18,XCMPLX_1:78
.= ( ( ( - ( Im ( a .|. b ) ) ) / |. a .| ) * ( 1 / |. b .| ) ) by A3,XCMPLX_1:60
.= ( ( ( - ( Im ( a .|. b ) ) ) * 1 ) / ( |. a .| * |. b .| ) ) by XCMPLX_1:76
.= ( - ( ( Im ( a .|. b ) ) / mab ) );
end;
