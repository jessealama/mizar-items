environ
vocabularies NUMBERS,TREES_1,SUBSET_1,FUNCT_1,XBOOLE_0,FINSEQ_1,ORDINAL4,XXREAL_0,ARYTM_3,RELAT_1,TARSKI,CARD_1,NAT_1,ORDINAL1,FINSET_1,REAL_1,ARYTM_1,ZFMISC_1,FUNCOP_1,TREES_2,AMISTD_3,FINSEQ_2,PARTFUN1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,ORDINAL1,RELAT_1,XCMPLX_0,FUNCT_1,PARTFUN1,REAL_1,NAT_1,CARD_1,NUMBERS,FINSEQ_1,FINSEQ_2,FINSET_1,RELSET_1,BINOP_1,FUNCT_2,FUNCOP_1,TREES_1,XXREAL_0,CKB7,CKB11,CKB13,CKB14,CKB15,CKB19,CKB33,CKB35,CKB51,CKB53,CKB56,CKB57,CKB61,CKB62,CKB64,CKB66,CKB75;
definitions RELAT_1,TARSKI,FUNCT_1,TREES_1,ORDINAL1,XBOOLE_0,BINOP_1,CKB7,CKB11,CKB13,CKB14,CKB15,CKB19,CKB33,CKB51,CKB61,CKB62,CKB66,CKB75;
theorems FUNCT_1,NAT_1,FINSEQ_1,TREES_1,TARSKI,ORDERS_1,ZFMISC_1,FINSET_1,CARD_1,CARD_2,WELLORD2,FUNCOP_1,FUNCT_2,RELAT_1,FINSEQ_2,ORDINAL1,XBOOLE_0,XBOOLE_1,XREAL_1,XXREAL_0,PARTFUN1,RELSET_1,CKB1,CKB2,CKB3,CKB4,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB27,CKB28,CKB30,CKB31,CKB33,CKB37,CKB38,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB47,CKB49,CKB50,CKB51,CKB58,CKB61,CKB62,CKB63,CKB66,CKB68,CKB69,CKB70,CKB71,CKB75;
schemes FUNCT_1,FRAENKEL,NAT_1,CARD_2,CLASSES1,DOMAIN_1,XBOOLE_0,CKB5,CKB25,CKB26,CKB46,CKB48,CKB59,CKB60,CKB72,CKB73;
registrations XBOOLE_0,SUBSET_1,RELAT_1,FUNCT_1,ORDINAL1,FUNCOP_1,FINSET_1,NUMBERS,XXREAL_0,XREAL_0,NAT_1,FINSEQ_1,TREES_1,CARD_1,RELSET_1,FINSEQ_2,DOMAIN_1,PARTFUN1,CKB12,CKB29,CKB32,CKB34,CKB36,CKB39,CKB52,CKB54,CKB55,CKB65,CKB67,CKB74,CKB76,CKB77,CKB78;
constructors WELLORD2,BINOP_1,FUNCOP_1,XXREAL_0,REAL_1,NAT_1,TREES_1,RELSET_1,FINSEQ_2,CKB11,CKB13,CKB14,CKB15,CKB19,CKB33,CKB51,CKB57,CKB61,CKB62,CKB64,CKB66,CKB75;
requirements NUMERALS,REAL,BOOLE,SUBSET,ARITHM;
begin
reserve x for set;
reserve y for set;
reserve f for Function;
reserve k for (Element of ( NAT ));
reserve m for (Element of ( NAT ));
reserve n for (Element of ( NAT ));
reserve p for (FinSequence of ( NAT ));
reserve x1 for set;
reserve x2 for set;
reserve w for (FinSequence of ( NAT ));
theorem
(for Z1,Z2 being Tree holds (for p being (FinSequence of ( NAT )) holds (p in Z1 implies (for v being (Element of ( Z1 with-replacement (p,Z2) )) holds (for w being (Element of Z2) holds (v = ( p ^ w ) implies ( succ v ),( succ w ) are_equipotent ))))))
proof
let Z1 being Tree;
let Z2 being Tree;
let p being (FinSequence of ( NAT ));
assume that
A1: p in Z1;
set T = ( Z1 with-replacement (p,Z2) );
let t being (Element of ( Z1 with-replacement (p,Z2) ));
let t2 being (Element of Z2);
assume A2: t = ( p ^ t2 );
then A3: p is_a_prefix_of t by TREES_1:1;
A4: (for n holds (( t ^ <* n *> ) in T iff ( t2 ^ <* n *> ) in Z2))
proof
let n;
A5: p is_a_proper_prefix_of ( t ^ <* n *> ) by A3,TREES_1:8;
A6: ( t ^ <* n *> ) = ( p ^ ( t2 ^ <* n *> ) ) by A2,FINSEQ_1:32;
thus (( t ^ <* n *> ) in T implies ( t2 ^ <* n *> ) in Z2)
proof
assume ( t ^ <* n *> ) in T;
then (ex w st (w in Z2 & ( t ^ <* n *> ) = ( p ^ w ))) by A1,A5,TREES_1:def 9;
hence thesis by A6,FINSEQ_1:33;
end;

assume ( t2 ^ <* n *> ) in Z2;
hence thesis by A1,A6,TREES_1:def 9;
end;
defpred P[ set,set ]
 means
(for n holds ($1 = ( t ^ <* n *> ) implies $2 = ( t2 ^ <* n *> )));
A7: (for x holds (x in ( succ t ) implies (ex y st P[ x,y ])))
proof
let x;
assume x in ( succ t );
then consider n such that A8: x = ( t ^ <* n *> ) and ( t ^ <* n *> ) in T;
take ( t2 ^ <* n *> );
let m;
assume x = ( t ^ <* m *> );
hence thesis by A8,FINSEQ_1:33;
end;
consider f being Function such that A9: (( dom f ) = ( succ t ) & (for x holds (x in ( succ t ) implies P[ x,( f . x ) ]))) from CLASSES1:sch 1(A7);
now
let x;
thus (x in ( rng f ) implies x in ( succ t2 ))
proof
assume x in ( rng f );
then consider y such that A10: y in ( dom f ) and A11: x = ( f . y ) by FUNCT_1:def 3;
consider n such that A12: y = ( t ^ <* n *> ) and A13: ( t ^ <* n *> ) in T by A9,A10;
A14: x = ( t2 ^ <* n *> ) by A9,A10,A11,A12;
( t2 ^ <* n *> ) in Z2 by A4,A13;
hence thesis by A14;
end;

assume x in ( succ t2 );
then consider n such that A15: x = ( t2 ^ <* n *> ) and A16: ( t2 ^ <* n *> ) in Z2;
( t ^ <* n *> ) in T by A4,A16;
then A17: ( t ^ <* n *> ) in ( dom f ) by A9;
then ( f . ( t ^ <* n *> ) ) = x by A9,A15;
hence x in ( rng f ) by A17,FUNCT_1:def 3;
end;
then A18: ( rng f ) = ( succ t2 ) by TARSKI:1;
f is  one-to-one
proof
let x1;
let x2;
assume that
A19: x1 in ( dom f )
and
A20: x2 in ( dom f )
and
A21: ( f . x1 ) = ( f . x2 );
consider m such that A22: x1 = ( t ^ <* m *> ) and ( t ^ <* m *> ) in T by A9,A19;
consider k such that A23: x2 = ( t ^ <* k *> ) and ( t ^ <* k *> ) in T by A9,A20;
( t2 ^ <* m *> ) = ( f . x1 ) by A9,A19,A22
.= ( t2 ^ <* k *> ) by A9,A20,A21,A23;
hence thesis by A22,A23,FINSEQ_1:33;
end;
hence thesis by A9,A18,WELLORD2:def 4;
end;
