environ
vocabularies XBOOLE_0,FUNCT_1,RELAT_1,TARSKI,PBOOLE,MEMBER_1,MSUALG_3,FUNCT_2,FUNCT_6,PZFMISC1,SUBSET_1,REALSET1,STRUCT_0,MSUALG_1,MSUALG_2,UNIALG_2,PARTFUN1,PRALG_2,CARD_3,RLVECT_2,PRELAMB,MSAFREE,FINSET_1,MSAFREE2,MSUALG_6,MARGREL1,NAT_1,GROUP_6,CLOSURE2,ZFMISC_1,FINSEQ_1,CARD_1,PRALG_3,FUNCT_4,FUNCOP_1,NUMBERS,ZF_LANG,MCART_1,ZF_MODEL,WELLORD1,MSUALG_4,EQUATION;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,NUMBERS,RELAT_1,FUNCT_1,PBOOLE,RELSET_1,PARTFUN1,STRUCT_0,FUNCT_2,MCART_1,FINSET_1,NAT_1,FINSEQ_1,FINSEQ_2,FUNCT_4,FUNCT_6,PZFMISC1,CARD_3,MSUALG_1,PRALG_2,FUNCOP_1,MSUALG_2,PRALG_3,MSUALG_3,MSUALG_4,MSAFREE,MSAFREE2,CLOSURE2,MSUALG_6,CKB7,CKB22;
definitions TARSKI,PBOOLE,PRALG_2,MSUALG_2,MSUALG_3,FINSET_1,MSAFREE,MSAFREE2,MSUALG_1,XBOOLE_0,PZFMISC1,CKB7,CKB22;
theorems MSUALG_1,EXTENS_1,MSAFREE2,MSSCYC_1,CARD_3,FUNCT_4,FUNCOP_1,FUNCT_1,FUNCT_2,MCART_1,MSAFREE,FINSEQ_1,CLOSURE2,FINSET_1,MSUALG_2,MSUALG_3,MSUALG_4,MSUALG_9,PBOOLE,PARTFUN1,MSUALG_6,AUTALG_1,MSSUBFAM,INSTALG1,PRALG_2,PRALG_3,RELAT_1,TARSKI,ZFMISC_1,RELSET_1,XBOOLE_0,XBOOLE_1,FUNCT_6,PZFMISC1,FINSEQ_2,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB28,CKB29,CKB30,CKB31;
schemes MSSUBFAM,PBOOLE,FUNCT_2,XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,ORDINAL1,RELSET_1,FUNCT_2,FUNCOP_1,FINSET_1,FINSEQ_1,STRUCT_0,MSUALG_1,MSUALG_2,RELAT_1,FUNCT_1,PRALG_2,MSUALG_3,MSAFREE,MSUALG_4,EXTENS_1,CLOSURE2,MSUALG_6,PRALG_3,MSUALG_9,MSSUBFAM,PBOOLE,AUTALG_1,CKB23,CKB24,CKB25,CKB26,CKB27;
constructors FUNCT_4,PZFMISC1,MSSUBFAM,MSUALG_3,MSAFREE2,CLOSURE2,MSUALG_6,PRALG_3,RELSET_1,FINSEQ_2,CKB7,CKB22;
requirements SUBSET,BOOLE;
begin
reserve S for non empty non void ManySortedSign;
theorem
Th27: (for I being non empty  finite set holds (for A being  non-empty MSAlgebra over S holds (for F being (MSAlgebra-Family of I,S) holds ((for i being (Element of I) holds (ex C being  strict  non-empty  finitely-generated (MSSubAlgebra of A) st C = ( F . i ))) implies (ex B being  strict  non-empty  finitely-generated (MSSubAlgebra of A) st (for i being (Element of I) holds ( F . i ) is (MSSubAlgebra of B)))))))
proof
let I being non empty  finite set;
let A being  non-empty MSAlgebra over S;
let F being (MSAlgebra-Family of I,S);
assume that
A1: (for i being (Element of I) holds (ex C being  strict  non-empty  finitely-generated (MSSubAlgebra of A) st C = ( F . i )));
set Z = { C where C is (Element of ( MSSub A )): (ex i being (Element of I) st (ex D being  strict  non-empty  finitely-generated (MSSubAlgebra of A) st (C = ( F . i ) & C = D))) };
set J = (the carrier of S);
set m = the (Element of I);
consider W being  strict  non-empty  finitely-generated (MSSubAlgebra of A) such that A2: W = ( F . m ) by A1;
W is (Element of ( MSSub A )) by MSUALG_2:def 19;
then W in Z by A2;
then reconsider Z as non empty set;
defpred P[ set,set ]
 means
(ex Q being  strict  non-empty (MSSubAlgebra of A) st (ex G being (GeneratorSet of Q) st (($1 = Q & $2 = G) & G is  non-empty  finite-yielding)));
A3: (for a being (Element of Z) holds (ex b being (Element of ( Bool (the Sorts of A) )) st P[ a,b ]))
proof
let a being (Element of Z);
a in Z;
then consider C being (Element of ( MSSub A )) such that A4: a = C and A5: (ex i being (Element of I) st (ex D being  strict  non-empty  finitely-generated (MSSubAlgebra of A) st (C = ( F . i ) & C = D)));
consider i being (Element of I),D being  strict  non-empty  finitely-generated (MSSubAlgebra of A) such that C = ( F . i ) and A6: C = D by A5;
consider G being (GeneratorSet of D) such that A7: G is  finite-yielding by MSAFREE2:def 10;
consider S being  non-empty  finite-yielding (ManySortedSubset of (the Sorts of D)) such that A8: G c= S by A7,MSUALG_9:7;
(the Sorts of D) is (MSSubset of A) by MSUALG_2:def 9;
then (S c= (the Sorts of D) & (the Sorts of D) c= (the Sorts of A)) by PBOOLE:def 18;
then S c= (the Sorts of A) by PBOOLE:13;
then S is (ManySortedSubset of (the Sorts of A)) by PBOOLE:def 18;
then reconsider b = S as (Element of ( Bool (the Sorts of A) )) by CLOSURE2:def 1;
reconsider S as (GeneratorSet of D) by A8,MSSCYC_1:21;
take b;
take D;
take S;
thus a = D by A4,A6;
thus thesis;
end;
consider f being (Function of Z,( Bool (the Sorts of A) )) such that A9: (for B being (Element of Z) holds P[ B,( f . B ) ]) from FUNCT_2:sch 3(A3);
deffunc F(set) = ( union { a where a is (Element of ( bool ( (the Sorts of A) . $1 ) )): (ex i being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . i ) ) & a = ( K . $1 )))) } );
consider SOR being (ManySortedSet of J) such that A10: (for j being set holds (j in J implies ( SOR . j ) = F(j))) from PBOOLE:sch 4;
SOR is (ManySortedSubset of (the Sorts of A))
proof
let j being set;
assume that
A11: j in J;
let q being set;
set UU = { a where a is (Element of ( bool ( (the Sorts of A) . j ) )): (ex i being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . i ) ) & a = ( K . j )))) };
assume q in ( SOR . j );
then q in ( union UU ) by A10,A11;
then consider w being set such that A12: q in w and A13: w in UU by TARSKI:def 4;
consider a being (Element of ( bool ( (the Sorts of A) . j ) )) such that A14: w = a and (ex i being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . i ) ) & a = ( K . j )))) by A13;
thus thesis by A12,A14;
end;
then reconsider SOR as (MSSubset of A);
SOR is  non-empty
proof
set i = the (Element of I);
consider C being  strict  non-empty  finitely-generated (MSSubAlgebra of A) such that A15: C = ( F . i ) by A1;
C is (Element of ( MSSub A )) by MSUALG_2:def 19;
then A16: ( F . i ) in Z by A15;
then A17: (ex Q being  strict  non-empty (MSSubAlgebra of A) st (ex G being (GeneratorSet of Q) st ((( F . i ) = Q & ( f . ( F . i ) ) = G) & G is  non-empty  finite-yielding))) by A9;
then reconsider G1 = ( f . ( F . i ) ) as  finite-yielding (Element of ( Bool (the Sorts of A) )) by A16,FUNCT_2:5;
let j being set;
assume that
A18: j in J;
consider q being set such that A19: q in ( G1 . j ) by A18,A17,XBOOLE_0:def 1;
set UU = { a where a is (Element of ( bool ( (the Sorts of A) . j ) )): (ex i being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . i ) ) & a = ( K . j )))) };
G1 c= (the Sorts of A) by PBOOLE:def 18;
then ( G1 . j ) c= ( (the Sorts of A) . j ) by A18,PBOOLE:def 2;
then ( G1 . j ) in UU;
then q in ( union UU ) by A19,TARSKI:def 4;
hence thesis by A10,A18;
end;
then reconsider SOR as  non-empty (MSSubset of A);
A20:now
set i = the (Element of I);
let j being set;
assume that
A21: j in J;
set UU = { a where a is (Element of ( bool ( (the Sorts of A) . j ) )): (ex i being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . i ) ) & a = ( K . j )))) };
consider C being  strict  non-empty  finitely-generated (MSSubAlgebra of A) such that A22: C = ( F . i ) by A1;
C is (Element of ( MSSub A )) by MSUALG_2:def 19;
then A23: ( F . i ) in Z by A22;
then (ex Q being  strict  non-empty (MSSubAlgebra of A) st (ex G being (GeneratorSet of Q) st ((( F . i ) = Q & ( f . ( F . i ) ) = G) & G is  non-empty  finite-yielding))) by A9;
then reconsider G1 = ( f . ( F . i ) ) as  finite-yielding (Element of ( Bool (the Sorts of A) )) by A23,FUNCT_2:5;
G1 c= (the Sorts of A) by PBOOLE:def 18;
then ( G1 . j ) c= ( (the Sorts of A) . j ) by A21,PBOOLE:def 2;
then ( G1 . j ) in UU;
hence UU is non empty;
end;
SOR is  finite-yielding
proof
let j being set;
assume that
A24: j in J;
set UU = { a where a is (Element of ( bool ( (the Sorts of A) . j ) )): (ex i being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . i ) ) & a = ( K . j )))) };
reconsider VV = UU as non empty set by A20,A24;
A25:now
defpred P[ set,set ]
 means
(ex L being (ManySortedSet of J) st (( f . ( F . $1 ) ) = L & $2 = ( L . j )));
consider r being FinSequence such that A26: ( rng r ) = I by FINSEQ_1:52;
A27: (for a being (Element of I) holds (ex b being (Element of VV) st P[ a,b ]))
proof
let a being (Element of I);
consider W being  strict  non-empty  finitely-generated (MSSubAlgebra of A) such that A28: W = ( F . a ) by A1;
W is (Element of ( MSSub A )) by MSUALG_2:def 19;
then A29: W in Z by A28;
then (ex Q being  strict  non-empty (MSSubAlgebra of A) st (ex G being (GeneratorSet of Q) st ((W = Q & ( f . W ) = G) & G is  non-empty  finite-yielding))) by A9;
then reconsider G1 = ( f . ( F . a ) ) as  finite-yielding (Element of ( Bool (the Sorts of A) )) by A28,A29,FUNCT_2:5;
G1 c= (the Sorts of A) by PBOOLE:def 18;
then ( G1 . j ) c= ( (the Sorts of A) . j ) by A24,PBOOLE:def 2;
then ( G1 . j ) in UU;
then reconsider b = ( G1 . j ) as (Element of VV);
take b;
take G1;
thus thesis;
end;
consider h being (Function of I,VV) such that A30: (for i being (Element of I) holds P[ i,( h . i ) ]) from FUNCT_2:sch 3(A27);
A31: ( rng r ) = ( dom h ) by A26,FUNCT_2:def 1;
then reconsider p = ( h * r ) as FinSequence by FINSEQ_1:16;
A32: VV c= ( rng p )
proof
let q being set;
assume q in VV;
then consider a being (Element of ( bool ( (the Sorts of A) . j ) )) such that A33: q = a and A34: (ex i being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . i ) ) & a = ( K . j ))));
consider i being (Element of I),K being (ManySortedSet of J) such that A35: (K = ( f . ( F . i ) ) & a = ( K . j )) by A34;
A36: (( rng p ) = ( rng h ) & ( dom h ) = I) by A31,FUNCT_2:def 1,RELAT_1:28;
(ex L being (ManySortedSet of J) st (( f . ( F . i ) ) = L & ( h . i ) = ( L . j ))) by A30;
hence thesis by A33,A35,A36,FUNCT_1:def 3;
end;
take p;
( rng p ) c= ( rng h )
proof
let q being set;
assume q in ( rng p );
hence thesis by FUNCT_1:14;
end;
then ( rng p ) c= VV by XBOOLE_1:1;
hence ( rng p ) = VV by A32,XBOOLE_0:def 10;
end;
(for x being set holds (x in UU implies x is  finite))
proof
let x being set;
assume x in UU;
then consider a being (Element of ( bool ( (the Sorts of A) . j ) )) such that A37: x = a and A38: (ex w being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . w ) ) & a = ( K . j ))));
consider w being (Element of I),K being (ManySortedSet of J) such that A39: (K = ( f . ( F . w ) ) & a = ( K . j )) by A38;
A40: (ex E being  strict  non-empty  finitely-generated (MSSubAlgebra of A) st E = ( F . w )) by A1;
then ( F . w ) is (Element of ( MSSub A )) by MSUALG_2:def 19;
then ( F . w ) in Z by A40;
then P[ ( F . w ),( f . ( F . w ) ) ] by A9;
hence thesis by A24,A37,A39,FINSET_1:def 4;
end;
then ( union UU ) is  finite by A25,FINSET_1:7;
hence thesis by A10,A24;
end;
then reconsider SOR as  non-empty  finite-yielding (MSSubset of A);
take ( GenMSAlg SOR );
let i being (Element of I);
consider C being  strict  non-empty  finitely-generated (MSSubAlgebra of A) such that A41: C = ( F . i ) by A1;
C is (Element of ( MSSub A )) by MSUALG_2:def 19;
then ( F . i ) in Z by A41;
then consider Q being  strict  non-empty (MSSubAlgebra of A),G being (GeneratorSet of Q) such that A42: ( F . i ) = Q and A43: ( f . ( F . i ) ) = G and A44: G is  non-empty  finite-yielding by A9;
(the Sorts of Q) is (MSSubset of A) by MSUALG_2:def 9;
then (G c= (the Sorts of Q) & (the Sorts of Q) c= (the Sorts of A)) by PBOOLE:def 18;
then A45: G c= (the Sorts of A) by PBOOLE:13;
then reconsider G1 = G as  non-empty (MSSubset of A) by A44,PBOOLE:def 18;
A46: G1 is (ManySortedSubset of SOR)
proof
let j being set;
assume that
A47: j in J;
set UU = { a where a is (Element of ( bool ( (the Sorts of A) . j ) )): (ex i being (Element of I) st (ex K being (ManySortedSet of J) st (K = ( f . ( F . i ) ) & a = ( K . j )))) };
( G1 . j ) c= ( (the Sorts of A) . j ) by A45,A47,PBOOLE:def 2;
then A48: ( G1 . j ) in UU by A43;
let q being set;
assume q in ( G1 . j );
then q in ( union UU ) by A48,TARSKI:def 4;
hence thesis by A10,A47;
end;
C = ( GenMSAlg G ) by A41,A42,MSAFREE:3
.= ( GenMSAlg G1 ) by EXTENS_1:18;
hence thesis by A41,A46,EXTENS_1:17;
end;
