environ
vocabularies XBOOLE_0,RELAT_2,ORDERS_2,STRUCT_0,CAT_1,YELLOW_0,SUBSET_1,RCOMP_1,WELLORD1,TARSKI,LATTICES,REWRITE1,WAYBEL_0,XXREAL_0,WAYBEL_3,WAYBEL_6,CARD_FIL,LATTICE3,EQREL_1,ORDINAL2,FINSET_1,ZFMISC_1,WAYBEL_4,MSSUBFAM,WAYBEL_7,INT_2,WAYBEL_1,FUNCT_1,GROUP_6,RELAT_1,BINOP_1,SEQM_3,YELLOW_1,FILTER_1,SETFAM_1,WAYBEL_8,CARD_1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,CARD_1,FINSET_1,RELAT_1,TOLER_1,FUNCT_1,RELSET_1,FUNCT_2,DOMAIN_1,RELAT_2,STRUCT_0,ORDERS_2,LATTICE3,QUANTAL1,YELLOW_0,YELLOW_1,YELLOW_2,WAYBEL_0,WAYBEL_1,WAYBEL_3,WAYBEL_4,WAYBEL_6,WAYBEL_7,CKB1,CKB6,CKB11,CKB12,CKB17;
definitions TARSKI,RELAT_2,ORDERS_2,YELLOW_2,STRUCT_0,CKB1,CKB6,CKB11,CKB12,CKB17;
theorems TARSKI,STRUCT_0,FINSET_1,FUNCT_1,FUNCT_2,ORDERS_2,LATTICE3,YELLOW_0,YELLOW_1,YELLOW_2,YELLOW_3,YELLOW_5,WAYBEL_0,WAYBEL_1,WAYBEL_3,WAYBEL_4,WAYBEL_6,WAYBEL_7,RELAT_1,YELLOW_7,XBOOLE_0,XBOOLE_1,RELAT_2,CKB1,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB11,CKB12,CKB13,CKB17,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB41,CKB42,CKB43,CKB44,CKB46,CKB47;
schemes SUBSET_1,FUNCT_1;
registrations XBOOLE_0,SUBSET_1,RELSET_1,FINSET_1,STRUCT_0,LATTICE3,YELLOW_0,WAYBEL_0,YELLOW_1,YELLOW_2,WAYBEL_1,WAYBEL_2,WAYBEL_3,WAYBEL_4,WAYBEL_6,CARD_1,ORDINAL1,CKB2,CKB10,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB45;
constructors DOMAIN_1,TOLER_1,QUANTAL1,ORDERS_3,WAYBEL_1,YELLOW_3,WAYBEL_3,WAYBEL_4,WAYBEL_6,WAYBEL_7,RELSET_1,PRALG_1,CKB1,CKB6,CKB11,CKB12,CKB17;
requirements SUBSET,BOOLE,NUMERALS;
begin
theorem
(for L being  algebraic  lower-bounded LATTICE holds (for c being  closure (Function of L,L) holds (c is  directed-sups-preserving implies ( c .: ( [#] ( CompactSublatt L ) ) ) = ( [#] ( CompactSublatt ( Image c ) ) ))))
proof
let L being  algebraic  lower-bounded LATTICE;
let c being  closure (Function of L,L);
assume A1: c is  directed-sups-preserving;
now
c is  idempotent by WAYBEL_1:def 13;
then A2: ( rng c ) = { x where x is (Element of L): x = ( c . x ) } by YELLOW_2:19;
c is  idempotent by WAYBEL_1:def 13;
then reconsider Imc = ( Image c ) as  complete LATTICE by A1,YELLOW_2:35;
let a9 being set;
assume A3: a9 in ( [#] ( CompactSublatt ( Image c ) ) );
A4: (the carrier of ( CompactSublatt Imc )) c= (the carrier of Imc) by YELLOW_0:def 13;
then reconsider a = a9 as (Element of Imc) by A3;
a is  compact by A3,CKB1:def 1;
then A5: a << a by WAYBEL_3:def 2;
a9 in (the carrier of Imc) by A3,A4;
then a in ( rng c ) by YELLOW_0:def 15;
then consider a1 being (Element of L) such that A6: a = a1 and A7: a1 = ( c . a1 ) by A2;
( compactbelow a1 ) is non  empty  directed non  empty  directed (Subset of L) by CKB12:def 1;
then A8: (c preserves_sup_of ( compactbelow a1 ) &  ex_sup_of ( compactbelow a1 ),L) by A1,WAYBEL_0:75,WAYBEL_0:def 37;
A9: c is  monotone by A1,YELLOW_2:16;
now
let z being set;
assume z in ( c .: ( compactbelow a1 ) );
then consider v being set such that A10: v in ( dom c ) and A11: v in ( compactbelow a1 ) and A12: z = ( c . v ) by FUNCT_1:def 6;
reconsider v9 = v as (Element of L) by A11;
A13: v in ( ( downarrow a1 ) /\ (the carrier of ( CompactSublatt L )) ) by A11,CKB8:1;
then v in ( downarrow a1 ) by XBOOLE_0:def 4;
then v9 <= a1 by WAYBEL_0:17;
then ( c . v9 ) <= a1 by A7,A9,WAYBEL_1:def 2;
then A14: z in ( downarrow a1 ) by A12,WAYBEL_0:17;
v in ( [#] ( CompactSublatt L ) ) by A13,XBOOLE_0:def 4;
then z in ( c .: ( [#] ( CompactSublatt L ) ) ) by A10,A12,FUNCT_1:def 6;
hence z in ( ( downarrow a1 ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ) by A14,XBOOLE_0:def 4;
end;
then A15: ( c .: ( compactbelow a1 ) ) c= ( ( downarrow a1 ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ) by TARSKI:def 3;
a = ( sup ( compactbelow a1 ) ) by A6,CKB11:def 1;
then A16: a = ( sup ( c .: ( compactbelow a1 ) ) ) by A6,A7,A8,WAYBEL_0:def 31;
( c .: ( compactbelow a1 ) ) c= ( rng c ) by RELAT_1:111;
then A17: ( c .: ( compactbelow a1 ) ) c= (the carrier of Imc) by YELLOW_0:def 15;
A18: ( ( downarrow a ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ) is non  empty  directed non  empty  directed (Subset of Imc)
proof
( ( c .: ( [#] ( CompactSublatt L ) ) ) /\ ( downarrow a ) ) is (Subset of Imc);
then reconsider D = ( ( downarrow a ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ) as (Subset of Imc);
A19: ( Bottom Imc ) <= a by YELLOW_0:44;
A20:now
let x being (Element of Imc);
let y being (Element of Imc);
assume that
A21: x in D
and
A22: y in D;
x in ( c .: ( [#] ( CompactSublatt L ) ) ) by A21,XBOOLE_0:def 4;
then consider d being set such that A23: d in ( dom c ) and A24: d in ( [#] ( CompactSublatt L ) ) and A25: x = ( c . d ) by FUNCT_1:def 6;
y in ( c .: ( [#] ( CompactSublatt L ) ) ) by A22,XBOOLE_0:def 4;
then consider e being set such that A26: e in ( dom c ) and A27: e in ( [#] ( CompactSublatt L ) ) and A28: y = ( c . e ) by FUNCT_1:def 6;
reconsider e as (Element of L) by A26;
y in ( downarrow a ) by A22,XBOOLE_0:def 4;
then y <= a by WAYBEL_0:17;
then A29: ( c . e ) <= a1 by A6,A28,YELLOW_0:59;
reconsider d as (Element of L) by A23;
A30: d <= ( d "\/" e ) by YELLOW_0:22;
x in ( downarrow a ) by A21,XBOOLE_0:def 4;
then x <= a by WAYBEL_0:17;
then ( c . d ) <= a1 by A6,A25,YELLOW_0:59;
then A31: ( ( c . d ) "\/" ( c . e ) ) <= a1 by A29,YELLOW_0:22;
( d "\/" e ) in (the carrier of L);
then ( d "\/" e ) in ( dom c ) by FUNCT_2:def 1;
then ( c . ( d "\/" e ) ) in ( rng c ) by FUNCT_1:def 3;
then reconsider z = ( c . ( d "\/" e ) ) as (Element of Imc) by YELLOW_0:def 15;
take z;
A32: ( id L ) <= c by WAYBEL_1:def 14;
then ( ( id L ) . e ) <= ( c . e ) by YELLOW_2:9;
then A33: e <= ( c . e ) by FUNCT_1:18;
( ( id L ) . d ) <= ( c . d ) by A32,YELLOW_2:9;
then d <= ( c . d ) by FUNCT_1:18;
then ( d "\/" e ) <= ( ( c . d ) "\/" ( c . e ) ) by A33,YELLOW_3:3;
then ( d "\/" e ) <= a1 by A31,ORDERS_2:3;
then ( c . ( d "\/" e ) ) <= a1 by A7,A9,WAYBEL_1:def 2;
then z <= a by A6,YELLOW_0:60;
then A34: z in ( downarrow a ) by WAYBEL_0:17;
A35: e <= ( d "\/" e ) by YELLOW_0:22;
then A36: ( c . e ) <= ( c . ( d "\/" e ) ) by A9,WAYBEL_1:def 2;
e is  compact by A27,CKB1:def 1;
then e << e by WAYBEL_3:def 2;
then A37: e << ( d "\/" e ) by A35,WAYBEL_3:2;
d is  compact by A24,CKB1:def 1;
then d << d by WAYBEL_3:def 2;
then d << ( d "\/" e ) by A30,WAYBEL_3:2;
then ( d "\/" e ) << ( d "\/" e ) by A37,WAYBEL_3:3;
then ( d "\/" e ) is  compact by WAYBEL_3:def 2;
then A38: ( d "\/" e ) in ( [#] ( CompactSublatt L ) ) by CKB1:def 1;
( d "\/" e ) in (the carrier of L);
then ( d "\/" e ) in ( dom c ) by FUNCT_2:def 1;
then z in ( c .: ( [#] ( CompactSublatt L ) ) ) by A38,FUNCT_1:def 6;
hence z in D by A34,XBOOLE_0:def 4;
( c . d ) <= ( c . ( d "\/" e ) ) by A9,A30,WAYBEL_1:def 2;
hence (x <= z & y <= z) by A25,A28,A36,YELLOW_0:60;
end;
( Bottom L ) is  compact by WAYBEL_3:15;
then (( dom c ) = (the carrier of L) & ( Bottom L ) in ( [#] ( CompactSublatt L ) )) by CKB1:def 1,FUNCT_2:def 1;
then A39: ( c . ( Bottom L ) ) in ( c .: ( [#] ( CompactSublatt L ) ) ) by FUNCT_1:def 6;
A40: ( ex_sup_of ( {} ),L & ( {} ) c= (the carrier of L)) by XBOOLE_1:2,YELLOW_0:42;
A41: ( {} ) c= (the carrier of Imc) by XBOOLE_1:2;
( c . ( Bottom L ) ) = ( c . ( "\/" (( {} ),L) ) ) by YELLOW_0:def 11
.= ( "\/" (( {} ),Imc) ) by A40,A41,WAYBEL_1:55
.= ( Bottom Imc ) by YELLOW_0:def 11;
then ( c . ( Bottom L ) ) in ( downarrow a ) by A19,WAYBEL_0:17;
hence thesis by A39,A20,WAYBEL_0:def 1,XBOOLE_0:def 4;
end;
A42: ( c .: ( [#] ( CompactSublatt L ) ) ) c= ( rng c ) by RELAT_1:111;
now
let z being set;
assume A43: z in ( ( downarrow a1 ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) );
then reconsider z1 = z as (Element of L);
A44: z in ( c .: ( [#] ( CompactSublatt L ) ) ) by A43,XBOOLE_0:def 4;
then reconsider z2 = z1 as (Element of Imc) by A42,YELLOW_0:def 15;
z in ( downarrow a1 ) by A43,XBOOLE_0:def 4;
then z1 <= a1 by WAYBEL_0:17;
then z2 <= a by A6,YELLOW_0:60;
then z in ( downarrow a ) by WAYBEL_0:17;
hence z in ( ( downarrow a ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ) by A44,XBOOLE_0:def 4;
end;
then A45: ( ( downarrow a1 ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ) c= ( ( downarrow a ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ) by TARSKI:def 3;
 ex_sup_of ( c .: ( compactbelow a1 ) ),L by A8,WAYBEL_0:def 31;
then A46: a = ( "\/" (( c .: ( compactbelow a1 ) ),Imc) ) by A6,A7,A17,A16,WAYBEL_1:55;
( ex_sup_of ( c .: ( compactbelow a1 ) ),Imc &  ex_sup_of ( ( downarrow a ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ),Imc) by YELLOW_0:17;
then a <= ( "\/" (( ( downarrow a ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ),Imc) ) by A46,A15,A45,XBOOLE_1:1,YELLOW_0:34;
then consider k being (Element of Imc) such that A47: k in ( ( downarrow a ) /\ ( c .: ( [#] ( CompactSublatt L ) ) ) ) and A48: a <= k by A5,A18,WAYBEL_3:def 1;
k in ( downarrow a ) by A47,XBOOLE_0:def 4;
then A49: k <= a by WAYBEL_0:17;
k in ( c .: ( [#] ( CompactSublatt L ) ) ) by A47,XBOOLE_0:def 4;
hence a9 in ( c .: ( [#] ( CompactSublatt L ) ) ) by A48,A49,ORDERS_2:2;
end;
then A50: ( [#] ( CompactSublatt ( Image c ) ) ) c= ( c .: ( [#] ( CompactSublatt L ) ) ) by TARSKI:def 3;
( c .: ( [#] ( CompactSublatt L ) ) ) c= ( [#] ( CompactSublatt ( Image c ) ) ) by A1,CKB46:1;
hence thesis by A50,XBOOLE_0:def 10;
end;
