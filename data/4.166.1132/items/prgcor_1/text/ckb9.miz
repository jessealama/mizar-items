environ
vocabularies NUMBERS,SUBSET_1,ARYTM_3,ARYTM_1,XXREAL_0,CARD_1,INT_1,RELAT_1,NAT_1,PARTFUN1,FUNCT_1,NEWTON,FINSEQ_1,FUNCOP_1,TARSKI,PRGCOR_1;
notations TARSKI,SUBSET_1,NUMBERS,XCMPLX_0,XXREAL_0,FUNCT_1,FINSEQ_1,INT_1,RELSET_1,FUNCOP_1,PARTFUN1,NAT_1,NAT_D,NEWTON;
definitions TARSKI;
theorems FINSEQ_1,NAT_1,FUNCT_1,XCMPLX_1,PRE_FF,INT_1,NEWTON,CARD_4,FINSEQ_3,FUNCOP_1,TARSKI,XREAL_1,XXREAL_0,ORDINAL1,NAT_D,WSIERP_1,XREAL_0,CKB1,CKB2,CKB3,CKB4,CKB5,CKB7,CKB8;
schemes NAT_1,FINSEQ_1;
registrations XBOOLE_0,ORDINAL1,RELSET_1,XXREAL_0,XREAL_0,NAT_1,INT_1,NEWTON,WSIERP_1,CKB6;
constructors XXREAL_0,REAL_1,NAT_1,NAT_D,NEWTON,BINARITH,RELSET_1;
requirements REAL,NUMERALS,BOOLE,SUBSET,ARITHM;
begin
definition
let n being Integer;
let m being Integer;
assume that
A1: n >= ( 0 )
and
A2: m > ( 0 );
func idiv1_prg (n,m) -> Integer means 
:Def1: (ex sm,sn,pn being (FinSequence of ( INT )) st ((((( len sm ) = ( n + 1 ) & ( len sn ) = ( n + 1 )) & ( len pn ) = ( n + 1 )) & (n < m implies it = ( 0 ))) & ((not n < m) implies (( sm . 1 ) = m & (ex i being Integer st ((((((((1 <= i & i <= n) & (for k being Integer holds ((1 <= k & k < i) implies (( sm . ( k + 1 ) ) = ( ( sm . k ) * 2 ) & (not ( sm . ( k + 1 ) ) > n))))) & ( sm . ( i + 1 ) ) = ( ( sm . i ) * 2 )) & ( sm . ( i + 1 ) ) > n) & ( pn . ( i + 1 ) ) = ( 0 )) & ( sn . ( i + 1 ) ) = n) & (for j being Integer holds ((1 <= j & j <= i) implies ((( sn . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm . ( ( i + 1 ) - j ) ) implies (( sn . ( ( i + 1 ) - j ) ) = ( ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) - ( sm . ( ( i + 1 ) - j ) ) ) & ( pn . ( ( i + 1 ) - j ) ) = ( ( ( pn . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 ))) & ((not ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm . ( ( i + 1 ) - j ) )) implies (( sn . ( ( i + 1 ) - j ) ) = ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) & ( pn . ( ( i + 1 ) - j ) ) = ( ( pn . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ))))))) & it = ( pn . 1 )))))));
existence
proof
reconsider n2 = n,m2 = m as (Element of ( NAT )) by A1,A2,INT_1:3;
per cases ;
suppose A3: n < m;

set ssm = ( ( Seg ( n2 + 1 ) ) --> 1 );
A4: ( dom ssm ) = ( Seg ( n2 + 1 ) ) by FUNCOP_1:13;
then reconsider ssm as FinSequence by FINSEQ_1:def 2;
A5: ( rng ssm ) c= { 1 } by FUNCOP_1:13;
( rng ssm ) c= ( INT )
proof
let y being set;
assume y in ( rng ssm );
then y = 1 by A5,TARSKI:def 1;
hence thesis by INT_1:def 2;
end;
then reconsider ssm as (FinSequence of ( INT )) by FINSEQ_1:def 4;
( len ssm ) = ( n + 1 ) by A4,FINSEQ_1:def 3;
hence thesis by A3;
end;
suppose A6: n >= m;

deffunc F3(Nat) = ( n2 div ( m2 * ( 2 |^ ( $1 -' 1 ) ) ) );
A7: ( m2 * ( 2 |^ ( 0 ) ) ) = ( m2 * 1 ) by NEWTON:4
.= m2;
(ex ppn being FinSequence st (( len ppn ) = ( n2 + 1 ) & (for k2 being Nat holds (k2 in ( dom ppn ) implies ( ppn . k2 ) = F3(k2))))) from FINSEQ_1:sch 2;
then consider ppn being FinSequence such that A8: ( len ppn ) = ( n + 1 ) and A9: (for k2 being Nat holds (k2 in ( dom ppn ) implies ( ppn . k2 ) = ( n2 div ( m2 * ( 2 |^ ( k2 -' 1 ) ) ) )));
A10: ( dom ppn ) = ( Seg ( n2 + 1 ) ) by A8,FINSEQ_1:def 3;
( rng ppn ) c= ( INT )
proof
let y being set;
assume y in ( rng ppn );
then consider x being set such that A11: x in ( dom ppn ) and A12: y = ( ppn . x ) by FUNCT_1:def 3;
reconsider n3 = x as (Element of ( NAT )) by A11;
( ppn . n3 ) = ( n2 div ( m2 * ( 2 |^ ( n3 -' 1 ) ) ) ) by A9,A11;
hence thesis by A12,INT_1:def 2;
end;
then reconsider ppn as (FinSequence of ( INT )) by FINSEQ_1:def 4;
n2 >= ( ( 0 ) + 1 ) by A2,A6,NAT_1:13;
then 1 < ( n2 + 1 ) by NAT_1:13;
then A13: 1 in ( Seg ( n2 + 1 ) ) by FINSEQ_1:1;
then A14: ( ppn . 1 ) = ( n2 div ( m2 * ( 2 |^ ( 1 -' 1 ) ) ) ) by A9,A10
.= ( n2 div m2 ) by A7,XREAL_1:232;
deffunc F(Nat) = ( n2 mod ( m2 * ( 2 |^ ( $1 -' 1 ) ) ) );
deffunc F1(Nat) = ( m2 * ( 2 |^ ( $1 -' 1 ) ) );
(ex ssm being FinSequence st (( len ssm ) = ( n2 + 1 ) & (for k2 being Nat holds (k2 in ( dom ssm ) implies ( ssm . k2 ) = F1(k2))))) from FINSEQ_1:sch 2;
then consider ssm being FinSequence such that A15: ( len ssm ) = ( n2 + 1 ) and A16: (for k2 being Nat holds (k2 in ( dom ssm ) implies ( ssm . k2 ) = ( m * ( 2 |^ ( k2 -' 1 ) ) )));
A17: ( dom ssm ) = ( Seg ( n2 + 1 ) ) by A15,FINSEQ_1:def 3;
A18: ( rng ssm ) c= ( INT )
proof
let y being set;
assume y in ( rng ssm );
then consider x being set such that A19: x in ( dom ssm ) and A20: y = ( ssm . x ) by FUNCT_1:def 3;
reconsider n = x as (Element of ( NAT )) by A19;
( ssm . n ) = ( m * ( 2 |^ ( n -' 1 ) ) ) by A16,A19;
hence thesis by A20,INT_1:def 2;
end;
(ex ssn being FinSequence st (( len ssn ) = ( n2 + 1 ) & (for k2 being Nat holds (k2 in ( dom ssn ) implies ( ssn . k2 ) = F(k2))))) from FINSEQ_1:sch 2;
then consider ssn being FinSequence such that A21: ( len ssn ) = ( n2 + 1 ) and A22: (for k2 being Nat holds (k2 in ( dom ssn ) implies ( ssn . k2 ) = ( n2 mod ( m2 * ( 2 |^ ( k2 -' 1 ) ) ) )));
A23: ( dom ssn ) = ( Seg ( n2 + 1 ) ) by A21,FINSEQ_1:def 3;
( rng ssn ) c= ( INT )
proof
let y being set;
assume y in ( rng ssn );
then consider x being set such that A24: x in ( dom ssn ) and A25: y = ( ssn . x ) by FUNCT_1:def 3;
reconsider n3 = x as (Element of ( NAT )) by A24;
( ssn . n3 ) = ( n2 mod ( m2 * ( 2 |^ ( n3 -' 1 ) ) ) ) by A22,A24;
hence thesis by A25,INT_1:def 2;
end;
then reconsider ssn as (FinSequence of ( INT )) by FINSEQ_1:def 4;
consider ii0 being (Element of ( NAT )) such that A26: (for k2 being (Element of ( NAT )) holds (k2 < ii0 implies ( m * ( 2 |^ k2 ) ) <= n2)) and A27: ( m2 * ( 2 |^ ii0 ) ) > n2 by A2,CKB7:1;
reconsider i0 = ii0 as Integer;
A28: ( ( 0 ) + 1 ) <= ( i0 + 1 ) by XREAL_1:7;
now
assume i0 = ( 0 );
then ( m2 * 1 ) > n2 by A27,NEWTON:4;
hence contradiction by A6;
end;
then A29: ii0 >= ( ( 0 ) + 1 ) by NAT_1:13;
then A30: ( i0 - 1 ) >= ( 0 ) by XREAL_1:48;
A31:now
( 1 + ( 0 ) ) <= m2 by A2,NAT_1:13;
then A32: ( 1 * ( 2 |^ n2 ) ) <= ( m2 * ( 2 |^ n2 ) ) by XREAL_1:64;
A33: ( n2 + 1 ) <= ( 2 |^ n2 ) by NEWTON:85;
assume i0 > n2;
then ( m * ( 2 |^ n2 ) ) <= n2 by A26;
then ( 2 |^ n2 ) <= n2 by A32,XXREAL_0:2;
hence contradiction by A33,NAT_1:13;
end;
then (1 <= ( 1 + ii0 ) & ( i0 + 1 ) <= ( n2 + 1 )) by NAT_1:11,XREAL_1:7;
then A34: ( ii0 + 1 ) in ( Seg ( n2 + 1 ) ) by FINSEQ_1:1;
reconsider k5 = ( m2 * ( 2 |^ ( ( ii0 + 1 ) -' 1 ) ) ) as (Element of ( NAT ));
A35: k5 > n2 by A27,NAT_D:34;
i0 < ( n2 + 1 ) by A31,NAT_1:13;
then ( ii0 + 1 ) <= ( n2 + 1 ) by NAT_1:13;
then ( ii0 + 1 ) in ( Seg ( n2 + 1 ) ) by A28,FINSEQ_1:1;
then ( ssn . ( i0 + 1 ) ) = ( n2 mod ( m2 * ( 2 |^ ( ( ii0 + 1 ) -' 1 ) ) ) ) by A22,A23;
then A36: ( ssn . ( i0 + 1 ) ) = n by A35,NAT_D:24;
( ( ii0 + 1 ) -' 1 ) = ( ( i0 - 1 ) + 1 ) by NAT_D:34
.= ( ( ii0 -' 1 ) + 1 ) by A30,XREAL_0:def 2;
then A37: ( 2 |^ ( ( ii0 + 1 ) -' 1 ) ) = ( ( 2 |^ ( ii0 -' 1 ) ) * 2 ) by NEWTON:6;
A38: 1 <= ( i0 + 1 ) by A29,NAT_1:13;
reconsider ssm as (FinSequence of ( INT )) by A18,FINSEQ_1:def 4;
A39: ( ssm . 1 ) = ( m * ( 2 |^ ( 1 -' 1 ) ) ) by A13,A16,A17
.= ( m * ( 2 |^ ( 0 ) ) ) by XREAL_1:232
.= ( m * 1 ) by NEWTON:4
.= m;
A40: ( ( ii0 + 1 ) -' 1 ) = ii0 by NAT_D:34;
then ( n2 div ( m2 * ( 2 |^ ( ( ii0 + 1 ) -' 1 ) ) ) ) = ( 0 ) by A27,NAT_D:27;
then A41: ( ppn . ( i0 + 1 ) ) = ( 0 ) by A9,A10,A34;
A42: (for j being Integer holds ((1 <= j & j <= i0) implies ((( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) >= ( ssm . ( ( i0 + 1 ) - j ) ) implies (( ssn . ( ( i0 + 1 ) - j ) ) = ( ( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) - ( ssm . ( ( i0 + 1 ) - j ) ) ) & ( ppn . ( ( i0 + 1 ) - j ) ) = ( ( ( ppn . ( ( i0 + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 ))) & ((not ( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) >= ( ssm . ( ( i0 + 1 ) - j ) )) implies (( ssn . ( ( i0 + 1 ) - j ) ) = ( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) & ( ppn . ( ( i0 + 1 ) - j ) ) = ( ( ppn . ( ( i0 + 1 ) - ( j - 1 ) ) ) * 2 ))))))
proof
let j being Integer;
assume that
A43: 1 <= j
and
A44: j <= i0;
reconsider jj = j as (Element of ( NAT )) by A43,INT_1:3;
A45: ( j - 1 ) >= ( 0 ) by A43,XREAL_1:48;
A46: ( i0 - j ) >= ( 0 ) by A44,XREAL_1:48;
then A47: ( ii0 -' jj ) = ( i0 - j ) by XREAL_0:def 2;
thus (( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) >= ( ssm . ( ( i0 + 1 ) - j ) ) implies (( ssn . ( ( i0 + 1 ) - j ) ) = ( ( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) - ( ssm . ( ( i0 + 1 ) - j ) ) ) & ( ppn . ( ( i0 + 1 ) - j ) ) = ( ( ( ppn . ( ( i0 + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 )))
proof
ii0 < ( ii0 + 1 ) by NAT_1:13;
then j < ( i0 + 1 ) by A44,XXREAL_0:2;
then ( ( i0 + 1 ) - j ) >= ( 0 ) by XREAL_1:48;
then A48: ( ( ii0 + 1 ) -' jj ) = ( ( i0 + 1 ) - j ) by XREAL_0:def 2;
( i0 + 1 ) <= ( n2 + j ) by A31,A43,XREAL_1:7;
then ( ( i0 + 1 ) - j ) <= ( ( n2 + j ) - j ) by XREAL_1:9;
then A49: ( ( ( ii0 + 1 ) -' jj ) + 1 ) <= ( n2 + 1 ) by A48,XREAL_1:7;
assume A50: ( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) >= ( ssm . ( ( i0 + 1 ) - j ) );
(( j + 1 ) <= ( i0 + 1 ) & j < ( j + 1 )) by A44,XREAL_1:7,XREAL_1:29;
then A51: j < ( i0 + 1 ) by XXREAL_0:2;
( jj -' 1 ) <= j by NAT_D:35;
then ( jj -' 1 ) < ( i0 + 1 ) by A51,XXREAL_0:2;
then A52: ( ( ii0 + 1 ) - ( jj -' 1 ) ) >= ( 0 ) by XREAL_1:48;
(( j + 1 ) <= ( i0 + 1 ) & jj < ( jj + 1 )) by A44,NAT_1:13,XREAL_1:7;
then A53: j < ( i0 + 1 ) by XXREAL_0:2;
( jj -' 1 ) <= jj by NAT_D:35;
then ( jj -' 1 ) < ( i0 + 1 ) by A53,XXREAL_0:2;
then A54: ( ( ii0 + 1 ) - ( jj -' 1 ) ) >= ( 0 ) by XREAL_1:48;
( 2 |^ ( ii0 -' jj ) ) <> ( 0 ) by CARD_4:3;
then A55: ( m2 * ( 2 |^ ( ii0 -' jj ) ) ) > ( m2 * ( 0 ) ) by A2,XREAL_1:68;
ii0 < ( ii0 + 1 ) by NAT_1:13;
then j < ( i0 + 1 ) by A44,XXREAL_0:2;
then A56: ( ( i0 + 1 ) - j ) > ( 0 ) by XREAL_1:50;
then A57: ( ( ii0 + 1 ) -' jj ) = ( ( i0 + 1 ) - j ) by XREAL_0:def 2;
then A58: ( ( ii0 + 1 ) -' jj ) >= ( ( 0 ) + 1 ) by A56,NAT_1:13;
then ( ( ( ii0 + 1 ) -' jj ) - 1 ) >= ( 0 ) by XREAL_1:48;
then A59: ( ( ( ii0 + 1 ) -' jj ) -' 1 ) = ( i0 - j ) by A57,XREAL_0:def 2;
(( ( ii0 + 1 ) -' jj ) <= ( i0 + 1 ) & ( i0 + 1 ) <= ( n2 + 1 )) by A31,NAT_D:35,XREAL_1:7;
then ( n2 + 1 ) >= ( ( ii0 + 1 ) -' jj ) by XXREAL_0:2;
then A60: ( ( ii0 + 1 ) -' jj ) in ( Seg ( n2 + 1 ) ) by A58,FINSEQ_1:1;
then A61: ( ssn . ( ( ii0 + 1 ) -' jj ) ) = ( n2 mod ( m2 * ( 2 |^ ( ( ( ii0 + 1 ) -' jj ) -' 1 ) ) ) ) by A22,A23;
( ( ii0 + 1 ) -' jj ) = ( ( i0 - j ) + 1 ) by A56,XREAL_0:def 2;
then ( ( ( ii0 + 1 ) -' jj ) - 1 ) >= ( 0 ) by A44,XREAL_1:48;
then A62: ( ( ( ii0 + 1 ) -' jj ) -' 1 ) = ( i0 - j ) by A57,XREAL_0:def 2
.= ( ii0 -' jj ) by A46,XREAL_0:def 2;
then A63: ( ssm . ( ( ii0 + 1 ) -' jj ) ) = ( m2 * ( 2 |^ ( ii0 -' jj ) ) ) by A16,A17,A60;
A64: ( jj -' 1 ) = ( j - 1 ) by A45,XREAL_0:def 2;
then A65: ( ( ii0 + 1 ) -' ( jj -' 1 ) ) = ( ( ( i0 + 1 ) - j ) + 1 ) by A52,XREAL_0:def 2;
then A66: ( ( ( ii0 + 1 ) -' ( jj -' 1 ) ) -' 1 ) = ( ( ii0 + 1 ) -' jj ) by A57,NAT_D:34;
1 <= ( ( ii0 + 1 ) -' ( jj -' 1 ) ) by A57,A65,NAT_1:11;
then A67: ( ( ii0 + 1 ) -' ( jj -' 1 ) ) in ( Seg ( n2 + 1 ) ) by A57,A65,A49,FINSEQ_1:1;
then A68: ( ssn . ( ( ii0 + 1 ) -' ( jj -' 1 ) ) ) = ( n2 mod ( m2 * ( 2 |^ ( ( ( ii0 + 1 ) -' ( jj -' 1 ) ) -' 1 ) ) ) ) by A22,A23;
( jj -' 1 ) = ( j - 1 ) by A45,XREAL_0:def 2;
then ( ( ii0 + 1 ) -' ( jj -' 1 ) ) = ( ( ( ii0 + 1 ) -' jj ) + 1 ) by A57,A54,XREAL_0:def 2;
then A69: ( ssn . ( ( ii0 + 1 ) -' ( jj -' 1 ) ) ) = ( n2 mod ( m2 * ( 2 |^ ( ( ii0 + 1 ) -' jj ) ) ) ) by A68,NAT_D:34;
A70: ( ( ii0 + 1 ) -' ( jj -' 1 ) ) = ( ( i0 + 1 ) - ( j - 1 ) ) by A64,A52,XREAL_0:def 2;
A71: ( m2 * ( 2 |^ ( ( ii0 + 1 ) -' jj ) ) ) = ( m2 * ( 2 |^ ( ( ii0 -' jj ) + 1 ) ) ) by A47,A56,XREAL_0:def 2
.= ( m2 * ( ( 2 |^ ( ii0 -' jj ) ) * 2 ) ) by NEWTON:6
.= ( 2 * ( m2 * ( 2 |^ ( ii0 -' jj ) ) ) );
( ( ii0 + 1 ) -' jj ) = ( ( i0 + 1 ) - j ) by A56,XREAL_0:def 2;
then A72: ( ( ssn . ( ( ii0 + 1 ) -' ( jj -' 1 ) ) ) - ( ssm . ( ( ii0 + 1 ) -' jj ) ) ) = ( n2 mod ( m2 * ( 2 |^ ( ii0 -' jj ) ) ) ) by A50,A65,A69,A71,A63,A55,CKB2:1;
( ppn . ( ( ii0 + 1 ) -' jj ) ) = ( n2 div ( m2 * ( 2 |^ ( ( ( ii0 + 1 ) -' jj ) -' 1 ) ) ) ) by A9,A10,A60
.= ( ( ( n2 div ( m2 * ( 2 |^ ( ( ( ii0 + 1 ) -' ( jj -' 1 ) ) -' 1 ) ) ) ) * 2 ) + 1 ) by A50,A57,A66,A70,A68,A62,A71,A63,A55,CKB3:1
.= ( ( ( ppn . ( ( ii0 + 1 ) -' ( jj -' 1 ) ) ) * 2 ) + 1 ) by A9,A10,A67;
hence thesis by A57,A65,A59,A61,A72,XREAL_0:def 2;
end;

thus ((not ( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) >= ( ssm . ( ( i0 + 1 ) - j ) )) implies (( ssn . ( ( i0 + 1 ) - j ) ) = ( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) & ( ppn . ( ( i0 + 1 ) - j ) ) = ( ( ppn . ( ( i0 + 1 ) - ( j - 1 ) ) ) * 2 )))
proof
(( j + 1 ) <= ( i0 + 1 ) & jj < ( jj + 1 )) by A44,NAT_1:13,XREAL_1:7;
then A73: j < ( i0 + 1 ) by XXREAL_0:2;
( jj -' 1 ) <= j by NAT_D:35;
then ( jj -' 1 ) < ( i0 + 1 ) by A73,XXREAL_0:2;
then A74: ( ( i0 + 1 ) - ( jj -' 1 ) ) >= ( 0 ) by XREAL_1:48;
(( j + 1 ) <= ( i0 + 1 ) & jj < ( jj + 1 )) by A44,NAT_1:13,XREAL_1:7;
then A75: j < ( i0 + 1 ) by XXREAL_0:2;
( jj -' 1 ) <= jj by NAT_D:35;
then ( jj -' 1 ) < ( i0 + 1 ) by A75,XXREAL_0:2;
then A76: ( ( i0 + 1 ) - ( jj -' 1 ) ) >= ( 0 ) by XREAL_1:48;
ii0 < ( ii0 + 1 ) by NAT_1:13;
then j < ( i0 + 1 ) by A44,XXREAL_0:2;
then ( ( i0 + 1 ) - j ) >= ( 0 ) by XREAL_1:48;
then A77: ( ( ii0 + 1 ) -' jj ) = ( ( i0 + 1 ) - j ) by XREAL_0:def 2;
( i0 + 1 ) <= ( n2 + j ) by A31,A43,XREAL_1:7;
then ( ( i0 + 1 ) - j ) <= ( ( n2 + j ) - j ) by XREAL_1:9;
then A78: ( ( ( ii0 + 1 ) -' jj ) + 1 ) <= ( n2 + 1 ) by A77,XREAL_1:7;
assume A79: (not ( ssn . ( ( i0 + 1 ) - ( j - 1 ) ) ) >= ( ssm . ( ( i0 + 1 ) - j ) ));
ii0 < ( ii0 + 1 ) by NAT_1:13;
then j < ( i0 + 1 ) by A44,XXREAL_0:2;
then A80: ( ( i0 + 1 ) - j ) > ( 0 ) by XREAL_1:50;
then A81: ( ( ii0 + 1 ) -' jj ) = ( ( i0 + 1 ) - j ) by XREAL_0:def 2;
then A82: ( ( ii0 + 1 ) -' jj ) >= ( ( 0 ) + 1 ) by A80,NAT_1:13;
then ( ( ( ii0 + 1 ) -' jj ) - 1 ) >= ( 0 ) by XREAL_1:48;
then A83: ( ( ( ii0 + 1 ) -' jj ) -' 1 ) = ( i0 - j ) by A81,XREAL_0:def 2;
(( ( ii0 + 1 ) -' jj ) <= ( ii0 + 1 ) & ( i0 + 1 ) <= ( n2 + 1 )) by A31,NAT_D:35,XREAL_1:7;
then ( n2 + 1 ) >= ( ( ii0 + 1 ) -' jj ) by XXREAL_0:2;
then A84: ( ( ii0 + 1 ) -' jj ) in ( Seg ( n2 + 1 ) ) by A82,FINSEQ_1:1;
then ( ssn . ( ( ii0 + 1 ) -' jj ) ) = ( n2 mod ( m2 * ( 2 |^ ( ( ( ii0 + 1 ) -' jj ) -' 1 ) ) ) ) by A22,A23;
then A85: ( ssn . ( ( ii0 + 1 ) -' jj ) ) = ( n2 mod ( m2 * ( 2 |^ ( ii0 -' jj ) ) ) ) by A83,XREAL_0:def 2;
( ( ii0 + 1 ) -' jj ) = ( ( i0 - j ) + 1 ) by A80,XREAL_0:def 2;
then ( ( ( ii0 + 1 ) -' jj ) - 1 ) >= ( 0 ) by A44,XREAL_1:48;
then A86: ( ( ( ii0 + 1 ) -' jj ) -' 1 ) = ( i0 - j ) by A81,XREAL_0:def 2
.= ( ii0 -' jj ) by A46,XREAL_0:def 2;
then A87: ( ssm . ( ( ii0 + 1 ) -' jj ) ) = ( m2 * ( 2 |^ ( ii0 -' jj ) ) ) by A16,A17,A84;
A88: ( jj -' 1 ) = ( j - 1 ) by A45,XREAL_0:def 2;
then A89: ( ( ii0 + 1 ) -' ( jj -' 1 ) ) = ( ( ( i0 + 1 ) - j ) + 1 ) by A76,XREAL_0:def 2;
then A90: ( ( ( ii0 + 1 ) -' ( jj -' 1 ) ) -' 1 ) = ( ( ii0 + 1 ) -' jj ) by A81,NAT_D:34;
1 <= ( ( ii0 + 1 ) -' ( jj -' 1 ) ) by A81,A89,NAT_1:11;
then A91: ( ( ii0 + 1 ) -' ( jj -' 1 ) ) in ( Seg ( n2 + 1 ) ) by A81,A89,A78,FINSEQ_1:1;
then A92: ( ssn . ( ( ii0 + 1 ) -' ( jj -' 1 ) ) ) = ( n2 mod ( m2 * ( 2 |^ ( ( ( ii0 + 1 ) -' ( jj -' 1 ) ) -' 1 ) ) ) ) by A22,A23;
( jj -' 1 ) = ( j - 1 ) by A45,XREAL_0:def 2;
then ( ( ii0 + 1 ) -' ( jj -' 1 ) ) = ( ( ( i0 + 1 ) - j ) + 1 ) by A74,XREAL_0:def 2
.= ( ( ( ii0 + 1 ) -' jj ) + 1 ) by A80,XREAL_0:def 2;
then A93: ( ssn . ( ( ii0 + 1 ) -' ( jj -' 1 ) ) ) = ( n2 mod ( m2 * ( 2 |^ ( ( ii0 + 1 ) -' jj ) ) ) ) by A92,NAT_D:34;
A94: ( ( ii0 + 1 ) -' ( jj -' 1 ) ) = ( ( i0 + 1 ) - ( j - 1 ) ) by A88,A76,XREAL_0:def 2;
A95: ( m2 * ( 2 |^ ( ( ii0 + 1 ) -' jj ) ) ) = ( m2 * ( 2 |^ ( ( ii0 -' jj ) + 1 ) ) ) by A47,A80,XREAL_0:def 2
.= ( m2 * ( ( 2 |^ ( ii0 -' jj ) ) * 2 ) ) by NEWTON:6
.= ( 2 * ( m2 * ( 2 |^ ( ii0 -' jj ) ) ) );
( ppn . ( ( ii0 + 1 ) -' jj ) ) = ( n2 div ( m2 * ( 2 |^ ( ( ( ii0 + 1 ) -' jj ) -' 1 ) ) ) ) by A9,A10,A84
.= ( ( n2 div ( m2 * ( 2 |^ ( ( ( ii0 + 1 ) -' ( jj -' 1 ) ) -' 1 ) ) ) ) * 2 ) by A79,A81,A90,A92,A94,A86,A95,A87,CKB5:1
.= ( ( ppn . ( ( ii0 + 1 ) -' ( jj -' 1 ) ) ) * 2 ) by A9,A10,A91;
hence thesis by A79,A81,A89,A85,A93,A95,A87,CKB4:1;
end;

end;
A96: (for k being (Element of ( NAT )) holds ((1 <= k & k < i0) implies (( ssm . ( k + 1 ) ) = ( ( ssm . k ) * 2 ) & (not ( ssm . ( k + 1 ) ) > n))))
proof
let k being (Element of ( NAT ));
assume that
A97: 1 <= k
and
A98: k < i0;
A99: k <= n2 by A31,A98,XXREAL_0:2;
then A100: ( k + 1 ) <= ( n2 + 1 ) by XREAL_1:7;
k <= ( n2 + 1 ) by A99,NAT_1:12;
then k in ( Seg ( n2 + 1 ) ) by A97,FINSEQ_1:1;
then A101: ( ssm . k ) = ( m * ( 2 |^ ( k -' 1 ) ) ) by A16,A17;
1 < ( k + 1 ) by A97,NAT_1:13;
then ( k + 1 ) in ( Seg ( n2 + 1 ) ) by A100,FINSEQ_1:1;
then A102: (( ( k + 1 ) -' 1 ) = k & ( ssm . ( k + 1 ) ) = ( m * ( 2 |^ ( ( k + 1 ) -' 1 ) ) )) by A16,A17,NAT_D:34;
A103: ( k - 1 ) >= ( 0 ) by A97,XREAL_1:48;
( ( k + 1 ) -' 1 ) = ( ( k - 1 ) + 1 ) by NAT_D:34
.= ( ( k -' 1 ) + 1 ) by A103,XREAL_0:def 2;
then ( 2 |^ ( ( k + 1 ) -' 1 ) ) = ( ( 2 |^ ( k -' 1 ) ) * 2 ) by NEWTON:6;
hence thesis by A26,A98,A102,A101;
end;
A104: (for k being Integer holds ((1 <= k & k < i0) implies (( ssm . ( k + 1 ) ) = ( ( ssm . k ) * 2 ) & (not ( ssm . ( k + 1 ) ) > n))))
proof
let k being Integer;
assume that
A105: 1 <= k
and
A106: k < i0;
reconsider kk = k as (Element of ( NAT )) by A105,INT_1:3;
( ssm . ( kk + 1 ) ) = ( ( ssm . kk ) * 2 ) by A96,A105,A106;
hence thesis by A96,A105,A106;
end;
i0 < ( n2 + 1 ) by A31,NAT_1:13;
then A107: ii0 in ( Seg ( n2 + 1 ) ) by A29,FINSEQ_1:1;
( i0 + 1 ) <= ( n2 + 1 ) by A31,XREAL_1:7;
then ( ii0 + 1 ) in ( Seg ( n2 + 1 ) ) by A38,FINSEQ_1:1;
then ( ssm . ( i0 + 1 ) ) = ( m * ( 2 |^ ( ( ii0 + 1 ) -' 1 ) ) ) by A16,A17;
then A108: ( ssm . ( i0 + 1 ) ) = ( ( m * ( 2 |^ ( ii0 -' 1 ) ) ) * 2 ) by A37
.= ( ( ssm . i0 ) * 2 ) by A16,A17,A107;
( ssm . ( i0 + 1 ) ) > n by A16,A17,A27,A40,A34;
hence thesis by A6,A15,A21,A8,A14,A39,A29,A31,A108,A104,A41,A36,A42;
end;
end;
uniqueness
proof
let t1 being Integer;
let t2 being Integer;
assume that
A109: (ex sm,sn,pn being (FinSequence of ( INT )) st ((((( len sm ) = ( n + 1 ) & ( len sn ) = ( n + 1 )) & ( len pn ) = ( n + 1 )) & (n < m implies t1 = ( 0 ))) & ((not n < m) implies (( sm . 1 ) = m & (ex i being Integer st ((((((((1 <= i & i <= n) & (for k being Integer holds ((1 <= k & k < i) implies (( sm . ( k + 1 ) ) = ( ( sm . k ) * 2 ) & (not ( sm . ( k + 1 ) ) > n))))) & ( sm . ( i + 1 ) ) = ( ( sm . i ) * 2 )) & ( sm . ( i + 1 ) ) > n) & ( pn . ( i + 1 ) ) = ( 0 )) & ( sn . ( i + 1 ) ) = n) & (for j being Integer holds ((1 <= j & j <= i) implies ((( sn . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm . ( ( i + 1 ) - j ) ) implies (( sn . ( ( i + 1 ) - j ) ) = ( ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) - ( sm . ( ( i + 1 ) - j ) ) ) & ( pn . ( ( i + 1 ) - j ) ) = ( ( ( pn . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 ))) & ((not ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm . ( ( i + 1 ) - j ) )) implies (( sn . ( ( i + 1 ) - j ) ) = ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) & ( pn . ( ( i + 1 ) - j ) ) = ( ( pn . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ))))))) & t1 = ( pn . 1 )))))))
and
A110: (ex sm,sn,pn being (FinSequence of ( INT )) st ((((( len sm ) = ( n + 1 ) & ( len sn ) = ( n + 1 )) & ( len pn ) = ( n + 1 )) & (n < m implies t2 = ( 0 ))) & ((not n < m) implies (( sm . 1 ) = m & (ex i being Integer st ((((((((1 <= i & i <= n) & (for k being Integer holds ((1 <= k & k < i) implies (( sm . ( k + 1 ) ) = ( ( sm . k ) * 2 ) & (not ( sm . ( k + 1 ) ) > n))))) & ( sm . ( i + 1 ) ) = ( ( sm . i ) * 2 )) & ( sm . ( i + 1 ) ) > n) & ( pn . ( i + 1 ) ) = ( 0 )) & ( sn . ( i + 1 ) ) = n) & (for j being Integer holds ((1 <= j & j <= i) implies ((( sn . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm . ( ( i + 1 ) - j ) ) implies (( sn . ( ( i + 1 ) - j ) ) = ( ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) - ( sm . ( ( i + 1 ) - j ) ) ) & ( pn . ( ( i + 1 ) - j ) ) = ( ( ( pn . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 ))) & ((not ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm . ( ( i + 1 ) - j ) )) implies (( sn . ( ( i + 1 ) - j ) ) = ( sn . ( ( i + 1 ) - ( j - 1 ) ) ) & ( pn . ( ( i + 1 ) - j ) ) = ( ( pn . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ))))))) & t2 = ( pn . 1 )))))));
consider sm1,sn1,pn1 being (FinSequence of ( INT )) such that ( len sm1 ) = ( n + 1 ) and ( len sn1 ) = ( n + 1 ) and ( len pn1 ) = ( n + 1 ) and A111: (n < m implies t1 = ( 0 )) and A112: ((not n < m) implies (( sm1 . 1 ) = m & (ex i being Integer st ((((((((1 <= i & i <= n) & (for k being Integer holds ((1 <= k & k < i) implies (( sm1 . ( k + 1 ) ) = ( ( sm1 . k ) * 2 ) & (not ( sm1 . ( k + 1 ) ) > n))))) & ( sm1 . ( i + 1 ) ) = ( ( sm1 . i ) * 2 )) & ( sm1 . ( i + 1 ) ) > n) & ( pn1 . ( i + 1 ) ) = ( 0 )) & ( sn1 . ( i + 1 ) ) = n) & (for j being Integer holds ((1 <= j & j <= i) implies ((( sn1 . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm1 . ( ( i + 1 ) - j ) ) implies (( sn1 . ( ( i + 1 ) - j ) ) = ( ( sn1 . ( ( i + 1 ) - ( j - 1 ) ) ) - ( sm1 . ( ( i + 1 ) - j ) ) ) & ( pn1 . ( ( i + 1 ) - j ) ) = ( ( ( pn1 . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 ))) & ((not ( sn1 . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm1 . ( ( i + 1 ) - j ) )) implies (( sn1 . ( ( i + 1 ) - j ) ) = ( sn1 . ( ( i + 1 ) - ( j - 1 ) ) ) & ( pn1 . ( ( i + 1 ) - j ) ) = ( ( pn1 . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ))))))) & t1 = ( pn1 . 1 ))))) by A109;
consider sm2,sn2,pn2 being (FinSequence of ( INT )) such that ( len sm2 ) = ( n + 1 ) and ( len sn2 ) = ( n + 1 ) and ( len pn2 ) = ( n + 1 ) and A113: (n < m implies t2 = ( 0 )) and A114: ((not n < m) implies (( sm2 . 1 ) = m & (ex i being Integer st ((((((((1 <= i & i <= n) & (for k being Integer holds ((1 <= k & k < i) implies (( sm2 . ( k + 1 ) ) = ( ( sm2 . k ) * 2 ) & (not ( sm2 . ( k + 1 ) ) > n))))) & ( sm2 . ( i + 1 ) ) = ( ( sm2 . i ) * 2 )) & ( sm2 . ( i + 1 ) ) > n) & ( pn2 . ( i + 1 ) ) = ( 0 )) & ( sn2 . ( i + 1 ) ) = n) & (for j being Integer holds ((1 <= j & j <= i) implies ((( sn2 . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm2 . ( ( i + 1 ) - j ) ) implies (( sn2 . ( ( i + 1 ) - j ) ) = ( ( sn2 . ( ( i + 1 ) - ( j - 1 ) ) ) - ( sm2 . ( ( i + 1 ) - j ) ) ) & ( pn2 . ( ( i + 1 ) - j ) ) = ( ( ( pn2 . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 ))) & ((not ( sn2 . ( ( i + 1 ) - ( j - 1 ) ) ) >= ( sm2 . ( ( i + 1 ) - j ) )) implies (( sn2 . ( ( i + 1 ) - j ) ) = ( sn2 . ( ( i + 1 ) - ( j - 1 ) ) ) & ( pn2 . ( ( i + 1 ) - j ) ) = ( ( pn2 . ( ( i + 1 ) - ( j - 1 ) ) ) * 2 ))))))) & t2 = ( pn2 . 1 ))))) by A110;
now
per cases ;
suppose n < m;

hence thesis by A111,A113;
end;
suppose A115: n >= m;

then consider i1 being Integer such that A116: 1 <= i1 and i1 <= n and A117: (for k being Integer holds ((1 <= k & k < i1) implies (( sm1 . ( k + 1 ) ) = ( ( sm1 . k ) * 2 ) & (not ( sm1 . ( k + 1 ) ) > n)))) and A118: ( sm1 . ( i1 + 1 ) ) = ( ( sm1 . i1 ) * 2 ) and A119: ( sm1 . ( i1 + 1 ) ) > n and A120: ( pn1 . ( i1 + 1 ) ) = ( 0 ) and A121: ( sn1 . ( i1 + 1 ) ) = n and A122: (for j being Integer holds ((1 <= j & j <= i1) implies ((( sn1 . ( ( i1 + 1 ) - ( j - 1 ) ) ) >= ( sm1 . ( ( i1 + 1 ) - j ) ) implies (( sn1 . ( ( i1 + 1 ) - j ) ) = ( ( sn1 . ( ( i1 + 1 ) - ( j - 1 ) ) ) - ( sm1 . ( ( i1 + 1 ) - j ) ) ) & ( pn1 . ( ( i1 + 1 ) - j ) ) = ( ( ( pn1 . ( ( i1 + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 ))) & ((not ( sn1 . ( ( i1 + 1 ) - ( j - 1 ) ) ) >= ( sm1 . ( ( i1 + 1 ) - j ) )) implies (( sn1 . ( ( i1 + 1 ) - j ) ) = ( sn1 . ( ( i1 + 1 ) - ( j - 1 ) ) ) & ( pn1 . ( ( i1 + 1 ) - j ) ) = ( ( pn1 . ( ( i1 + 1 ) - ( j - 1 ) ) ) * 2 )))))) and A123: t1 = ( pn1 . 1 ) by A112;
reconsider ii1 = i1 as (Element of ( NAT )) by A116,INT_1:3;
defpred P2[ (Element of ( NAT )) ]
 means
((1 <= $1 & $1 <= ( i1 + 1 )) implies ( sm1 . $1 ) = ( sm2 . $1 ));
defpred P4[ (Element of ( NAT )) ]
 means
((1 <= $1 & $1 <= ( i1 + 1 )) implies ( pn1 . ( ( ( ii1 + 1 ) + 1 ) -' $1 ) ) = ( pn2 . ( ( ( ii1 + 1 ) + 1 ) -' $1 ) ));
defpred P3[ (Element of ( NAT )) ]
 means
((1 <= $1 & $1 <= ( i1 + 1 )) implies ( sn1 . ( ( ( ii1 + 1 ) + 1 ) -' $1 ) ) = ( sn2 . ( ( ( ii1 + 1 ) + 1 ) -' $1 ) ));
consider i2 being Integer such that A124: 1 <= i2 and i2 <= n and A125: (for k being Integer holds ((1 <= k & k < i2) implies (( sm2 . ( k + 1 ) ) = ( ( sm2 . k ) * 2 ) & (not ( sm2 . ( k + 1 ) ) > n)))) and A126: ( sm2 . ( i2 + 1 ) ) = ( ( sm2 . i2 ) * 2 ) and A127: ( sm2 . ( i2 + 1 ) ) > n and A128: ( pn2 . ( i2 + 1 ) ) = ( 0 ) and A129: ( sn2 . ( i2 + 1 ) ) = n and A130: (for j being Integer holds ((1 <= j & j <= i2) implies ((( sn2 . ( ( i2 + 1 ) - ( j - 1 ) ) ) >= ( sm2 . ( ( i2 + 1 ) - j ) ) implies (( sn2 . ( ( i2 + 1 ) - j ) ) = ( ( sn2 . ( ( i2 + 1 ) - ( j - 1 ) ) ) - ( sm2 . ( ( i2 + 1 ) - j ) ) ) & ( pn2 . ( ( i2 + 1 ) - j ) ) = ( ( ( pn2 . ( ( i2 + 1 ) - ( j - 1 ) ) ) * 2 ) + 1 ))) & ((not ( sn2 . ( ( i2 + 1 ) - ( j - 1 ) ) ) >= ( sm2 . ( ( i2 + 1 ) - j ) )) implies (( sn2 . ( ( i2 + 1 ) - j ) ) = ( sn2 . ( ( i2 + 1 ) - ( j - 1 ) ) ) & ( pn2 . ( ( i2 + 1 ) - j ) ) = ( ( pn2 . ( ( i2 + 1 ) - ( j - 1 ) ) ) * 2 )))))) and A131: t2 = ( pn2 . 1 ) by A114,A115;
reconsider ii2 = i2 as (Element of ( NAT )) by A124,INT_1:3;
A132:now
assume A133: i2 < i1;
A134: (for k being Integer holds ((1 <= k & k <= ( i2 + 1 )) implies ( sm2 . k ) = ( sm1 . k )))
proof
defpred P[ (Element of ( NAT )) ]
 means
($1 < ( i2 + 1 ) implies ( sm2 . ( $1 + 1 ) ) = ( sm1 . ( $1 + 1 ) ));
let k being Integer;
assume that
A135: 1 <= k
and
A136: k <= ( i2 + 1 );
reconsider kh = k as (Element of ( NAT )) by A135,INT_1:3;
( k - 1 ) >= ( 0 ) by A135,XREAL_1:48;
then A137: ( kh -' 1 ) = ( k - 1 ) by XREAL_0:def 2;
then A138: ( ( kh -' 1 ) + 1 ) = k;
A139: (for e being (Element of ( NAT )) holds (P[ e ] implies P[ ( e + 1 ) ]))
proof
let e being (Element of ( NAT ));
assume A140: P[ e ];
per cases ;
suppose ( e + 1 ) < ( i2 + 1 );

then ( ( e + 1 ) + 1 ) <= ( ii2 + 1 ) by NAT_1:13;
then A141: ( ( ( e + 1 ) + 1 ) - 1 ) <= ( ( i2 + 1 ) - 1 ) by XREAL_1:9;
A142: ( ( 0 ) + 1 ) <= ( e + 1 ) by XREAL_1:7;
A143:now
per cases ;
case ( e + 1 ) < i2;
hence ( sm2 . ( ( e + 1 ) + 1 ) ) = ( ( sm2 . ( e + 1 ) ) * 2 ) by A125,A142;
end;
case ( e + 1 ) >= i2;
then ( e + 1 ) = i2 by A141,XXREAL_0:1;
hence ( sm2 . ( ( e + 1 ) + 1 ) ) = ( ( sm2 . ( e + 1 ) ) * 2 ) by A126;
end;
end;
A144: e < ( e + 1 ) by NAT_1:13;
( e + 1 ) < i1 by A133,A141,XXREAL_0:2;
hence thesis by A117,A140,A142,A144,A143,XXREAL_0:2;
end;
suppose ( e + 1 ) >= ( i2 + 1 );

hence thesis;
end;
end;
A145: P[ ( 0 ) ] by A112,A114,A115;
A146: (for e being (Element of ( NAT )) holds P[ e ]) from NAT_1:sch 1(A145,A139);
A147: ii2 < ( ii2 + 1 ) by NAT_1:13;
( k - 1 ) <= ( ( i2 + 1 ) - 1 ) by A136,XREAL_1:9;
then ( kh -' 1 ) < ( i2 + 1 ) by A137,A147,XXREAL_0:2;
hence thesis by A138,A146;
end;
( 0 ) <= ii2;
then ( ( 0 ) + 1 ) <= ( i2 + 1 ) by XREAL_1:7;
then ( sm2 . ( i2 + 1 ) ) = ( sm1 . ( i2 + 1 ) ) by A134;
hence contradiction by A117,A124,A127,A133;
end;
A148:now
assume A149: i1 < i2;
A150: (for k being Integer holds ((1 <= k & k <= ( i1 + 1 )) implies ( sm1 . k ) = ( sm2 . k )))
proof
defpred P[ (Element of ( NAT )) ]
 means
($1 < ( i1 + 1 ) implies ( sm1 . ( $1 + 1 ) ) = ( sm2 . ( $1 + 1 ) ));
let k being Integer;
assume that
A151: 1 <= k
and
A152: k <= ( i1 + 1 );
reconsider kh = k as (Element of ( NAT )) by A151,INT_1:3;
( k - 1 ) >= ( 0 ) by A151,XREAL_1:48;
then A153: ( kh -' 1 ) = ( k - 1 ) by XREAL_0:def 2;
then A154: ( ( kh -' 1 ) + 1 ) = k;
A155: (for e being (Element of ( NAT )) holds (P[ e ] implies P[ ( e + 1 ) ]))
proof
let e being (Element of ( NAT ));
assume A156: P[ e ];
per cases ;
suppose ( e + 1 ) < ( i1 + 1 );

then ( ( e + 1 ) + 1 ) <= ( ii1 + 1 ) by NAT_1:13;
then A157: ( ( ( e + 1 ) + 1 ) - 1 ) <= ( ( i1 + 1 ) - 1 ) by XREAL_1:9;
A158: ( ( 0 ) + 1 ) <= ( e + 1 ) by XREAL_1:7;
A159:now
per cases ;
case ( e + 1 ) < i1;
hence ( sm1 . ( ( e + 1 ) + 1 ) ) = ( ( sm1 . ( e + 1 ) ) * 2 ) by A117,A158;
end;
case ( e + 1 ) >= i1;
then ( e + 1 ) = i1 by A157,XXREAL_0:1;
hence ( sm1 . ( ( e + 1 ) + 1 ) ) = ( ( sm1 . ( e + 1 ) ) * 2 ) by A118;
end;
end;
A160: e < ( e + 1 ) by NAT_1:13;
( e + 1 ) < i2 by A149,A157,XXREAL_0:2;
hence thesis by A125,A156,A158,A160,A159,XXREAL_0:2;
end;
suppose ( e + 1 ) >= ( i1 + 1 );

hence thesis;
end;
end;
A161: P[ ( 0 ) ] by A112,A114,A115;
A162: (for e being (Element of ( NAT )) holds P[ e ]) from NAT_1:sch 1(A161,A155);
A163: ii1 < ( ii1 + 1 ) by NAT_1:13;
( k - 1 ) <= ( ( i1 + 1 ) - 1 ) by A152,XREAL_1:9;
then ( kh -' 1 ) < ( i1 + 1 ) by A153,A163,XXREAL_0:2;
hence thesis by A154,A162;
end;
( 0 ) <= ii1;
then ( ( 0 ) + 1 ) <= ( i1 + 1 ) by XREAL_1:7;
then ( sm1 . ( i1 + 1 ) ) = ( sm2 . ( i1 + 1 ) ) by A150;
hence contradiction by A116,A119,A125,A149;
end;
then A164: i1 = i2 by A132,XXREAL_0:1;
A165: ii1 < ( ii1 + 1 ) by NAT_1:13;
A166: (for kk being (Element of ( NAT )) holds (P2[ kk ] implies P2[ ( kk + 1 ) ]))
proof
let kk being (Element of ( NAT ));
assume A167: P2[ kk ];
((1 <= ( kk + 1 ) & ( kk + 1 ) <= ( i1 + 1 )) implies ( sm1 . ( kk + 1 ) ) = ( sm2 . ( kk + 1 ) ))
proof
assume that
1 <= ( kk + 1 )
and
A168: ( kk + 1 ) <= ( i1 + 1 );
per cases  by A168,XXREAL_0:1;
suppose A169: ( kk + 1 ) < ( i1 + 1 );

then A170: ( ( kk + 1 ) - 1 ) <= ( ( i2 + 1 ) - 1 ) by A164,XREAL_1:9;
now
per cases ;
case ( 0 ) < kk;
then A171: ( ( 0 ) + 1 ) <= kk by NAT_1:13;
A172:now
per cases ;
case kk < i2;
hence ( sm2 . ( kk + 1 ) ) = ( ( sm2 . kk ) * 2 ) by A125,A171;
end;
case kk >= i2;
then kk = i2 by A170,XXREAL_0:1;
hence ( sm2 . ( kk + 1 ) ) = ( ( sm2 . kk ) * 2 ) by A126;
end;
end;
kk < i1 by A169,XREAL_1:7;
hence thesis by A117,A165,A167,A171,A172,XXREAL_0:2;
end;
case ( 0 ) >= kk;
then kk = ( 0 );
hence thesis by A112,A114,A115;
end;
end;
hence thesis;
end;
suppose ( kk + 1 ) = ( i1 + 1 );

hence thesis by A116,A118,A126,A164,A167,NAT_1:13;
end;
end;
hence thesis;
end;
A173: P2[ ( 0 ) ];
A174: (for jj being (Element of ( NAT )) holds P2[ jj ]) from NAT_1:sch 1(A173,A166);
A175: (for jj being Integer holds ((1 <= jj & jj <= ( i1 + 1 )) implies ( sm1 . jj ) = ( sm2 . jj )))
proof
let jj being Integer;
assume that
A176: 1 <= jj
and
A177: jj <= ( i1 + 1 );
reconsider jj2 = jj as (Element of ( NAT )) by A176,INT_1:3;
( sm1 . jj2 ) = ( sm2 . jj2 ) by A174,A176,A177;
hence thesis;
end;
A178: (for kk being (Element of ( NAT )) holds (P3[ kk ] implies P3[ ( kk + 1 ) ]))
proof
let kk being (Element of ( NAT ));
assume A179: P3[ kk ];
((1 <= ( kk + 1 ) & ( kk + 1 ) <= ( i1 + 1 )) implies ( sn1 . ( ( ( ii1 + 1 ) + 1 ) -' ( kk + 1 ) ) ) = ( sn2 . ( ( ( ii1 + 1 ) + 1 ) -' ( kk + 1 ) ) ))
proof
assume that
1 <= ( kk + 1 )
and
A180: ( kk + 1 ) <= ( i1 + 1 );
A181: ( ( kk + 1 ) - 1 ) <= ( ( i2 + 1 ) - 1 ) by A164,A180,XREAL_1:9;
per cases ;
suppose A182: ( 0 ) < kk;

A183: kk < ( i1 + 1 ) by A164,A165,A181,XXREAL_0:2;
then ( ( i1 + 1 ) - kk ) > ( 0 ) by XREAL_1:50;
then A184: ( ( ii1 + 1 ) -' kk ) = ( ( i1 + 1 ) - kk ) by XREAL_0:def 2;
A185: ( ( 0 ) + 1 ) <= kk by A182,NAT_1:13;
then A186: ( kk - 1 ) >= ( 0 ) by XREAL_1:48;
( kk -' 1 ) <= kk by NAT_D:35;
then ( kk -' 1 ) < ( i1 + 1 ) by A183,XXREAL_0:2;
then ( ( i1 + 1 ) - ( kk -' 1 ) ) >= ( 0 ) by XREAL_1:48;
then A187: ( ( ii1 + 1 ) -' ( kk -' 1 ) ) = ( ( i1 + 1 ) - ( kk -' 1 ) ) by XREAL_0:def 2
.= ( ( i1 + 1 ) - ( kk - 1 ) ) by A186,XREAL_0:def 2;
now
per cases ;
case A188: kk <= i2;
ii1 < ( ii1 + 1 ) by NAT_1:13;
then kk < ( i1 + 1 ) by A164,A188,XXREAL_0:2;
then A189: ( ( i1 + 1 ) - kk ) > ( 0 ) by XREAL_1:50;
then ( ( ii1 + 1 ) -' kk ) = ( ( i1 + 1 ) - kk ) by XREAL_0:def 2;
then A190: ( ( ii1 + 1 ) -' kk ) >= ( ( 0 ) + 1 ) by A189,NAT_1:13;
A191: (( ( ii1 + 1 ) -' kk ) <= ( i1 + 1 ) & ( ( ( ii1 + 1 ) + 1 ) -' ( kk + 1 ) ) = ( ( ii1 + 1 ) -' kk )) by CKB1:1,NAT_D:35;
A192: ((not ( sn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) >= ( sm2 . ( ( ii1 + 1 ) -' kk ) )) implies (( sn2 . ( ( ii1 + 1 ) -' kk ) ) = ( sn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) & ( pn2 . ( ( ii1 + 1 ) -' kk ) ) = ( ( pn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) * 2 ))) by A130,A164,A185,A187,A184,A188;
( kk - 1 ) >= ( 0 ) by A185,XREAL_1:48;
then ( kk -' 1 ) = ( kk - 1 ) by XREAL_0:def 2;
then kk = ( ( kk -' 1 ) + 1 );
then A193: ( ( ( ii1 + 1 ) + 1 ) -' kk ) = ( ( ii1 + 1 ) -' ( kk -' 1 ) ) by CKB1:1;
A194: (( sn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) >= ( sm2 . ( ( ii1 + 1 ) -' kk ) ) implies (( sn2 . ( ( ii1 + 1 ) -' kk ) ) = ( ( sn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) - ( sm2 . ( ( ii1 + 1 ) -' kk ) ) ) & ( pn2 . ( ( ii1 + 1 ) -' kk ) ) = ( ( ( pn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) * 2 ) + 1 ))) by A130,A164,A185,A187,A184,A188;
A195: ((not ( sn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) >= ( sm1 . ( ( ii1 + 1 ) -' kk ) )) implies (( sn1 . ( ( ii1 + 1 ) -' kk ) ) = ( sn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) & ( pn1 . ( ( ii1 + 1 ) -' kk ) ) = ( ( pn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) * 2 ))) by A122,A164,A185,A187,A184,A188;
(( sn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) >= ( sm1 . ( ( ii1 + 1 ) -' kk ) ) implies (( sn1 . ( ( ii1 + 1 ) -' kk ) ) = ( ( sn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) - ( sm1 . ( ( ii1 + 1 ) -' kk ) ) ) & ( pn1 . ( ( ii1 + 1 ) -' kk ) ) = ( ( ( pn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) * 2 ) + 1 ))) by A122,A164,A185,A187,A184,A188;
hence thesis by A164,A175,A179,A182,A188,A195,A194,A192,A190,A193,A191,NAT_1:13;
end;
case kk > i2;
hence contradiction by A181;
end;
end;
hence thesis;
end;
suppose ( 0 ) >= kk;

then A196: kk = ( 0 );
( ( ( ii1 + 1 ) + 1 ) -' ( kk + 1 ) ) = ( ( ii1 + 1 ) -' kk ) by CKB1:1
.= ( ii1 + 1 ) by A196,NAT_D:40;
hence thesis by A121,A129,A148,A132,XXREAL_0:1;
end;
end;
hence thesis;
end;
A197: P3[ ( 0 ) ];
A198: (for jj being (Element of ( NAT )) holds P3[ jj ]) from NAT_1:sch 1(A197,A178);
A199: (for kk being (Element of ( NAT )) holds (P4[ kk ] implies P4[ ( kk + 1 ) ]))
proof
let kk being (Element of ( NAT ));
assume A200: P4[ kk ];
((1 <= ( kk + 1 ) & ( kk + 1 ) <= ( i1 + 1 )) implies ( pn1 . ( ( ( ii1 + 1 ) + 1 ) -' ( kk + 1 ) ) ) = ( pn2 . ( ( ( ii1 + 1 ) + 1 ) -' ( kk + 1 ) ) ))
proof
assume that
1 <= ( kk + 1 )
and
A201: ( kk + 1 ) <= ( i1 + 1 );
A202: ( ( kk + 1 ) - 1 ) <= ( ( i2 + 1 ) - 1 ) by A164,A201,XREAL_1:9;
per cases ;
suppose A203: ( 0 ) < kk;

A204: ( kk -' 1 ) < ( ( kk -' 1 ) + 1 ) by NAT_1:13;
kk < ( ii1 + 1 ) by A201,NAT_1:13;
then ( ( i1 + 1 ) - kk ) > ( 0 ) by XREAL_1:50;
then A205: ( ( ii1 + 1 ) -' kk ) = ( ( i1 + 1 ) - kk ) by XREAL_0:def 2;
A206: ( ( 0 ) + 1 ) <= kk by A203,NAT_1:13;
then A207: ( kk - 1 ) >= ( 0 ) by XREAL_1:48;
then ( kk - 1 ) = ( kk -' 1 ) by XREAL_0:def 2;
then ( kk -' 1 ) < i2 by A202,A204,XXREAL_0:2;
then ( kk -' 1 ) < ( i2 + 1 ) by A164,A165,XXREAL_0:2;
then ( ( i1 + 1 ) - ( kk -' 1 ) ) >= ( 0 ) by A164,XREAL_1:48;
then A208: ( ( ii1 + 1 ) -' ( kk -' 1 ) ) = ( ( i1 + 1 ) - ( kk -' 1 ) ) by XREAL_0:def 2
.= ( ( i1 + 1 ) - ( kk - 1 ) ) by A207,XREAL_0:def 2;
now
per cases ;
case A209: kk <= i2;
ii1 < ( ii1 + 1 ) by NAT_1:13;
then A210: kk < ( i1 + 1 ) by A164,A209,XXREAL_0:2;
then A211: ( ( i1 + 1 ) - kk ) > ( 0 ) by XREAL_1:50;
then ( ( ii1 + 1 ) -' kk ) = ( ( i1 + 1 ) - kk ) by XREAL_0:def 2;
then ( ( ii1 + 1 ) -' kk ) >= ( ( 0 ) + 1 ) by A211,NAT_1:13;
then A212: ( sm1 . ( ( ii1 + 1 ) -' kk ) ) = ( sm2 . ( ( ii1 + 1 ) -' kk ) ) by A175,NAT_D:35;
( kk - 1 ) >= ( 0 ) by A206,XREAL_1:48;
then ( kk -' 1 ) = ( kk - 1 ) by XREAL_0:def 2;
then kk = ( ( kk -' 1 ) + 1 );
then A213: ( ( ( ii1 + 1 ) + 1 ) -' kk ) = ( ( ii1 + 1 ) -' ( kk -' 1 ) ) by CKB1:1;
A214: ((not ( sn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) >= ( sm1 . ( ( ii1 + 1 ) -' kk ) )) implies (( sn1 . ( ( ii1 + 1 ) -' kk ) ) = ( sn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) & ( pn1 . ( ( ii1 + 1 ) -' kk ) ) = ( ( pn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) * 2 ))) by A122,A164,A206,A208,A205,A209;
A215: ( ( ( ii1 + 1 ) + 1 ) -' ( kk + 1 ) ) = ( ( ii1 + 1 ) -' kk ) by CKB1:1;
A216: ((not ( sn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) >= ( sm2 . ( ( ii1 + 1 ) -' kk ) )) implies (( sn2 . ( ( ii1 + 1 ) -' kk ) ) = ( sn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) & ( pn2 . ( ( ii1 + 1 ) -' kk ) ) = ( ( pn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) * 2 ))) by A130,A164,A206,A208,A205,A209;
A217: (( sn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) >= ( sm2 . ( ( ii1 + 1 ) -' kk ) ) implies (( sn2 . ( ( ii1 + 1 ) -' kk ) ) = ( ( sn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) - ( sm2 . ( ( ii1 + 1 ) -' kk ) ) ) & ( pn2 . ( ( ii1 + 1 ) -' kk ) ) = ( ( ( pn2 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) * 2 ) + 1 ))) by A130,A164,A206,A208,A205,A209;
(( sn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) >= ( sm1 . ( ( ii1 + 1 ) -' kk ) ) implies (( sn1 . ( ( ii1 + 1 ) -' kk ) ) = ( ( sn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) - ( sm1 . ( ( ii1 + 1 ) -' kk ) ) ) & ( pn1 . ( ( ii1 + 1 ) -' kk ) ) = ( ( ( pn1 . ( ( ii1 + 1 ) -' ( kk -' 1 ) ) ) * 2 ) + 1 ))) by A122,A164,A206,A208,A205,A209;
hence thesis by A198,A200,A206,A214,A217,A216,A210,A213,A212,A215;
end;
case kk > i2;
hence contradiction by A202;
end;
end;
hence thesis;
end;
suppose ( 0 ) >= kk;

then A218: kk = ( 0 );
( ( ( ii1 + 1 ) + 1 ) -' ( kk + 1 ) ) = ( ( ii1 + 1 ) -' kk ) by CKB1:1
.= ( i1 + 1 ) by A218,NAT_D:40;
hence thesis by A120,A128,A148,A132,XXREAL_0:1;
end;
end;
hence thesis;
end;
A219: P4[ ( 0 ) ];
A220: (for jj being (Element of ( NAT )) holds P4[ jj ]) from NAT_1:sch 1(A219,A199);
A221: (for jj being Integer holds ((1 <= jj & jj <= ( i1 + 1 )) implies ( pn1 . ( ( ( i1 + 1 ) + 1 ) - jj ) ) = ( pn2 . ( ( ( i1 + 1 ) + 1 ) - jj ) )))
proof
let jj being Integer;
assume that
A222: 1 <= jj
and
A223: jj <= ( i1 + 1 );
reconsider j2 = jj as (Element of ( NAT )) by A222,INT_1:3;
( ii1 + 1 ) < ( ( ii1 + 1 ) + 1 ) by NAT_1:13;
then jj < ( ( ii1 + 1 ) + 1 ) by A223,XXREAL_0:2;
then ( ( ( ii1 + 1 ) + 1 ) - j2 ) >= ( 0 ) by XREAL_1:48;
then ( ( ( ii1 + 1 ) + 1 ) -' j2 ) = ( ( ( ii1 + 1 ) + 1 ) - jj ) by XREAL_0:def 2;
hence thesis by A220,A222,A223;
end;
(1 <= ( 1 + ii1 ) & ( ( ( i1 + 1 ) + 1 ) - ( i1 + 1 ) ) = 1) by NAT_1:11;
hence thesis by A123,A131,A221;
end;
end;
hence thesis;
end;
end;
