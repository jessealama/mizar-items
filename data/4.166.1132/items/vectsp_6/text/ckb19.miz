environ
vocabularies NUMBERS,FINSEQ_1,SUBSET_1,RLVECT_1,ALGSTR_0,BINOP_1,VECTSP_1,LATTICES,XBOOLE_0,STRUCT_0,FUNCT_1,RLVECT_2,FUNCT_2,FINSET_1,SUPINF_2,FUNCOP_1,TARSKI,VALUED_1,NAT_1,RELAT_1,PARTFUN1,XXREAL_0,CARD_1,ORDINAL4,ARYTM_3,CARD_3,MESFUNC1,RLSUB_1,ARYTM_1,FINSEQ_4;
notations TARSKI,XBOOLE_0,SUBSET_1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,FINSET_1,PARTFUN1,FINSEQ_1,RELAT_1,FUNCT_1,FUNCT_2,FUNCOP_1,NAT_1,DOMAIN_1,STRUCT_0,ALGSTR_0,RLVECT_1,GROUP_1,VECTSP_1,FINSEQ_4,VFUNCT_1,VECTSP_4,CKB1,CKB2,CKB5,CKB7,CKB12;
definitions FUNCT_1,TARSKI,VECTSP_4,XBOOLE_0,RELAT_1,CKB1,CKB2,CKB5,CKB7,CKB12;
theorems CARD_1,CARD_2,ENUMSET1,FINSEQ_1,FINSEQ_2,FINSEQ_3,FINSEQ_4,FUNCT_1,FUNCT_2,RLVECT_1,RLVECT_2,TARSKI,VECTSP_1,VFUNCT_1,VECTSP_4,ZFMISC_1,NAT_1,RELAT_1,RELSET_1,XBOOLE_0,XBOOLE_1,XCMPLX_1,GROUP_1,FUNCOP_1,XREAL_1,PARTFUN1,CKB1,CKB2,CKB3,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18;
schemes FINSEQ_1,FUNCT_2,NAT_1;
registrations SUBSET_1,FUNCT_1,RELSET_1,FINSET_1,NUMBERS,MEMBERED,STRUCT_0,VECTSP_1,XXREAL_0,CARD_1,FINSEQ_1;
constructors PARTFUN1,DOMAIN_1,FUNCOP_1,XXREAL_0,NAT_1,MEMBERED,FINSEQ_4,VECTSP_4,RELSET_1,VFUNCT_1,CKB1,CKB2,CKB5,CKB7,CKB12;
requirements NUMERALS,REAL,BOOLE,SUBSET;
begin
reserve x for set;
reserve y for set;
reserve y1 for set;
reserve y2 for set;
reserve i for (Element of ( NAT ));
reserve GF for  add-associative  right_zeroed  right_complementable  Abelian  associative  well-unital  distributive non  empty doubleLoopStr;
reserve V for  Abelian  add-associative  right_zeroed  right_complementable  vector-distributive  scalar-distributive  scalar-associative  scalar-unital non  empty VectSpStr over GF;
reserve v1 for (Element of V);
reserve v2 for (Element of V);
reserve F for (FinSequence of V);
reserve f for (Function of V,GF);
reserve L for (Linear_Combination of V);
definition
let GF being non  empty addLoopStr;
let V being non  empty VectSpStr over GF;
let L being (Linear_Combination of V);
assume A1: V is  Abelian  add-associative  right_zeroed  right_complementable;
func Sum L -> (Element of V) means 
:Def9: (ex F being (FinSequence of (the carrier of V)) st ((F is  one-to-one & ( rng F ) = ( Carrier L )) & it = ( Sum ( L (#) F ) )));
existence
proof
consider F being FinSequence such that A2: ( rng F ) = ( Carrier L ) and A3: F is  one-to-one by FINSEQ_4:58;
reconsider F as (FinSequence of (the carrier of V)) by A2,FINSEQ_1:def 4;
take ( Sum ( L (#) F ) );
take F;
thus (F is  one-to-one & ( rng F ) = ( Carrier L )) by A2,A3;
thus thesis;
end;
uniqueness
proof
let v1 being (Element of V);
let v2 being (Element of V);
given F1 being (FinSequence of (the carrier of V)) such that
A4: F1 is  one-to-one
and
A5: ( rng F1 ) = ( Carrier L )
and
A6: v1 = ( Sum ( L (#) F1 ) );

given F2 being (FinSequence of (the carrier of V)) such that
A7: F2 is  one-to-one
and
A8: ( rng F2 ) = ( Carrier L )
and
A9: v2 = ( Sum ( L (#) F2 ) );

defpred P[ set,set ]
 means
{ $2 } = ( F1 " { ( F2 . $1 ) } );
A10: ( len F1 ) = ( len F2 ) by A4,A5,A7,A8,FINSEQ_1:48;
A11: ( dom F1 ) = ( Seg ( len F1 ) ) by FINSEQ_1:def 3;
A12: ( dom F2 ) = ( Seg ( len F2 ) ) by FINSEQ_1:def 3;
A13: (for x holds (x in ( dom F1 ) implies (ex y st (y in ( dom F1 ) & P[ x,y ]))))
proof
let x;
assume x in ( dom F1 );
then ( F2 . x ) in ( rng F1 ) by A5,A8,A10,A11,A12,FUNCT_1:def 3;
then consider y such that A14: ( F1 " { ( F2 . x ) } ) = { y } by A4,FUNCT_1:74;
take y;
y in ( F1 " { ( F2 . x ) } ) by A14,TARSKI:def 1;
hence y in ( dom F1 ) by FUNCT_1:def 7;
thus thesis by A14;
end;
consider f being (Function of ( dom F1 ),( dom F1 )) such that A15: (for x holds (x in ( dom F1 ) implies P[ x,( f . x ) ])) from FUNCT_2:sch 1(A13);
A16: ( rng f ) = ( dom F1 )
proof
thus ( rng f ) c= ( dom F1 ) by RELAT_1:def 19;
let y;
assume A17: y in ( dom F1 );
then ( F1 . y ) in ( rng F2 ) by A5,A8,FUNCT_1:def 3;
then consider x such that A18: x in ( dom F2 ) and A19: ( F2 . x ) = ( F1 . y ) by FUNCT_1:def 3;
( F1 " { ( F2 . x ) } ) = ( F1 " ( Im (F1,y) ) ) by A17,A19,FUNCT_1:59;
then ( F1 " { ( F2 . x ) } ) c= { y } by A4,FUNCT_1:82;
then { ( f . x ) } c= { y } by A10,A11,A12,A15,A18;
then A20: ( f . x ) = y by ZFMISC_1:18;
x in ( dom f ) by A10,A11,A12,A18,FUNCT_2:def 1;
hence thesis by A20,FUNCT_1:def 3;
end;
set G1 = ( L (#) F1 );
A21: ( len G1 ) = ( len F1 ) by CKB12:def 1;
A22: (( dom F1 ) = ( {} ) implies ( dom F1 ) = ( {} ));
A23: f is  one-to-one
proof
let y1;
let y2;
assume that
A24: y1 in ( dom f )
and
A25: y2 in ( dom f )
and
A26: ( f . y1 ) = ( f . y2 );
A27: y2 in ( dom F1 ) by A22,A25,FUNCT_2:def 1;
then A28: ( F1 " { ( F2 . y2 ) } ) = { ( f . y2 ) } by A15;
A29: y1 in ( dom F1 ) by A22,A24,FUNCT_2:def 1;
then ( F2 . y1 ) in ( rng F1 ) by A5,A8,A10,A11,A12,FUNCT_1:def 3;
then A30: { ( F2 . y1 ) } c= ( rng F1 ) by ZFMISC_1:31;
( F2 . y2 ) in ( rng F1 ) by A5,A8,A10,A11,A12,A27,FUNCT_1:def 3;
then A31: { ( F2 . y2 ) } c= ( rng F1 ) by ZFMISC_1:31;
( F1 " { ( F2 . y1 ) } ) = { ( f . y1 ) } by A15,A29;
then { ( F2 . y1 ) } = { ( F2 . y2 ) } by A26,A28,A30,A31,FUNCT_1:91;
then A32: ( F2 . y1 ) = ( F2 . y2 ) by ZFMISC_1:3;
(y1 in ( dom F2 ) & y2 in ( dom F2 )) by A10,A11,A12,A22,A24,A25,FUNCT_2:def 1;
hence thesis by A7,A32,FUNCT_1:def 4;
end;
set G2 = ( L (#) F2 );
A33: ( dom G2 ) = ( Seg ( len G2 ) ) by FINSEQ_1:def 3;
reconsider f as (Permutation of ( dom F1 )) by A16,A23,FUNCT_2:57;
(( dom F1 ) = ( Seg ( len F1 ) ) & ( dom G1 ) = ( Seg ( len G1 ) )) by FINSEQ_1:def 3;
then reconsider f as (Permutation of ( dom G1 )) by A21;
A34: ( len G2 ) = ( len F2 ) by CKB12:def 1;
A35: ( dom G1 ) = ( Seg ( len G1 ) ) by FINSEQ_1:def 3;
now
let i;
assume A36: i in ( dom G2 );
then A37: (( G2 . i ) = ( ( L . ( F2 /. i ) ) * ( F2 /. i ) ) & ( F2 . i ) = ( F2 /. i )) by A34,A12,A33,CKB12:def 1,PARTFUN1:def 6;
i in ( dom F2 ) by A34,A36,FINSEQ_3:29;
then reconsider u = ( F2 . i ) as (Element of V) by FINSEQ_2:11;
i in ( dom f ) by A10,A21,A34,A35,A33,A36,FUNCT_2:def 1;
then A38: ( f . i ) in ( dom F1 ) by A16,FUNCT_1:def 3;
then reconsider m = ( f . i ) as (Element of ( NAT )) by A11;
reconsider v = ( F1 . m ) as (Element of V) by A38,FINSEQ_2:11;
{ ( F1 . ( f . i ) ) } = ( Im (F1,( f . i )) ) by A38,FUNCT_1:59
.= ( F1 .: ( F1 " { ( F2 . i ) } ) ) by A10,A34,A11,A33,A15,A36;
then A39: u = v by FUNCT_1:75,ZFMISC_1:18;
( F1 . m ) = ( F1 /. m ) by A38,PARTFUN1:def 6;
hence ( G2 . i ) = ( G1 . ( f . i ) ) by A21,A11,A35,A38,A39,A37,CKB12:def 1;
end;
hence thesis by A1,A4,A5,A6,A7,A8,A9,A21,A34,FINSEQ_1:48,RLVECT_2:6;
end;
end;
