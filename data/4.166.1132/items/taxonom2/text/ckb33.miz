environ
vocabularies ORDERS_2,XBOOLE_0,SUBSET_1,ORDERS_1,XXREAL_0,YELLOW_1,RELAT_2,WELLORD2,RELAT_1,TARSKI,TREES_1,EQREL_1,TAXONOM1,SETFAM_1,ZFMISC_1,ABIAN,PRE_TOPC,LATTICES,ORDINAL1,PARTIT1,TAXONOM2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,RELAT_1,ORDINAL1,RELSET_1,STRUCT_0,ORDERS_2,EQREL_1,ABIAN,PARTIT1,ORDERS_1,YELLOW_1,TAXONOM1,CKB1,CKB2,CKB5,CKB10,CKB15,CKB16,CKB21,CKB24,CKB26;
definitions TARSKI,EQREL_1,TAXONOM1,SETFAM_1,XBOOLE_0,CKB1,CKB2,CKB10,CKB15,CKB16,CKB21,CKB24,CKB26;
theorems TARSKI,TAXONOM1,PARTIT1,EQREL_1,ZFMISC_1,ORDERS_2,ORDERS_1,RELAT_1,RELSET_1,SETFAM_1,REALSET1,ABIAN,YELLOW_1,WELLORD2,ORDINAL1,XBOOLE_0,XBOOLE_1,CKB1,CKB2,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31,CKB32;
schemes XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELSET_1,EQREL_1,YELLOW_1,CKB4,CKB11,CKB12,CKB17,CKB23;
constructors SETFAM_1,REALSET1,ABIAN,YELLOW_1,TAXONOM1,RELSET_1,CKB1,CKB2,CKB10,CKB15,CKB16,CKB21,CKB24,CKB26;
requirements BOOLE,SUBSET;
begin
reserve A for RelStr;
reserve X for non  empty set;
reserve x for set;
reserve y for set;
Lm4:now
let x being non  empty set;
A1: (ex a being set st a in x) by XBOOLE_0:def 1;
let y;
assume x c= y;
hence x meets y by A1,XBOOLE_0:3;
end;
theorem
Th19: (for h being non  empty set holds (h c= X implies (for Pmax being (a_partition of X) holds (((ex hy being set st (hy in Pmax & hy c= h)) & (for x holds (x in Pmax implies ((x c= h or h c= x) or h misses x)))) implies (for Pb being set holds ((for x holds (x in Pb iff (x in Pmax & x misses h))) implies ((( Pb \/ { h } ) is (a_partition of X) & Pmax is_finer_than ( Pb \/ { h } )) & (for Pmin being (a_partition of X) holds (Pmax is_finer_than Pmin implies (for hw being set holds ((hw in Pmin & h c= hw) implies ( Pb \/ { h } ) is_finer_than Pmin)))))))))))
proof
let h being non  empty set;
assume that
A1: h c= X;
A2: { h } c= ( bool X )
proof
let s being set;
assume s in { h };
then s = h by TARSKI:def 1;
hence thesis by A1;
end;
A3: h in { h } by TARSKI:def 1;
let Pmax being (a_partition of X);
assume that
A4: (ex hy being set st (hy in Pmax & hy c= h))
and
A5: (for x holds (x in Pmax implies ((x c= h or h c= x) or h misses x)));
A6:now
let s being set;
assume that
A7: s in Pmax
and
A8: h c= s;
consider hy being set such that A9: hy in Pmax and A10: hy c= h by A4;
hy <> ( {} ) by A9,EQREL_1:def 4;
then hy meets s by A8,A10,Lm4,XBOOLE_1:1;
then s = hy by A7,A9,EQREL_1:def 4;
hence h = s by A8,A10,XBOOLE_0:def 10;
end;
let Pb being set;
assume that
A11: (for x holds (x in Pb iff (x in Pmax & x misses h)));
set P = ( Pb \/ { h } );
A12: Pb c= P by XBOOLE_1:7;
A13: Pb c= Pmax
proof
let s being set;
assume s in Pb;
hence thesis by A11;
end;
A14:now
let A being (Subset of X);
assume that
A15: A in P;
now
per cases  by A15,XBOOLE_0:def 3;
suppose A in Pb;

then A in Pmax by A11;
hence A <> ( {} ) by EQREL_1:def 4;
end;
suppose A in { h };

hence A <> ( {} ) by TARSKI:def 1;
end;
end;
hence A <> ( {} );
thus (for B being (Subset of X) holds (B in P implies (A = B or A misses B)))
proof
let B being (Subset of X);
assume that
A16: B in P;
per cases  by A15,XBOOLE_0:def 3;
suppose A17: A in Pb;

per cases  by A16,XBOOLE_0:def 3;
suppose B in Pb;

hence thesis by A13,A17,EQREL_1:def 4;
end;
suppose B in { h };

then B = h by TARSKI:def 1;
hence thesis by A11,A17;
end;
end;
suppose A18: A in { h };

per cases  by A16,XBOOLE_0:def 3;
suppose A19: B in Pb;

A = h by A18,TARSKI:def 1;
hence thesis by A11,A19;
end;
suppose B in { h };

then B = h by TARSKI:def 1;
hence thesis by A18,TARSKI:def 1;
end;
end;
end;

end;
A20: { h } c= P by XBOOLE_1:7;
A21: ( union Pmax ) = X by EQREL_1:def 4;
A22: X c= ( union P )
proof
let s being set;
assume s in X;
then consider t being set such that A23: s in t and A24: t in Pmax by A21,TARSKI:def 4;
per cases ;
suppose t in Pb;

hence thesis by A12,A23,TARSKI:def 4;
end;
suppose (not t in Pb);

then A25: t meets h by A11,A24;
per cases  by A5,A24,A25;
suppose h c= t;

then t = h by A6,A24;
hence thesis by A3,A20,A23,TARSKI:def 4;
end;
suppose A26: t c= h;

h in { h } by TARSKI:def 1;
hence thesis by A20,A23,A26,TARSKI:def 4;
end;
end;
end;
Pb c= ( bool X ) by A13,XBOOLE_1:1;
then A27: P c= ( bool X ) by A2,XBOOLE_1:8;
( union P ) c= X
proof
let s being set;
assume s in ( union P );
then (ex t being set st (s in t & t in P)) by TARSKI:def 4;
hence thesis by A27;
end;
then ( union P ) = X by A22,XBOOLE_0:def 10;
hence ( Pb \/ { h } ) is (a_partition of X) by A27,A14,EQREL_1:def 4;
thus Pmax is_finer_than ( Pb \/ { h } )
proof
let x being set;
assume that
A28: x in Pmax;
per cases ;
suppose x c= h;

hence thesis by A3,A20;
end;
suppose A29: (not x c= h);

per cases  by A5,A28,A29;
suppose h c= x;

then h = x by A6,A28;
hence thesis by A3,A20;
end;
suppose h misses x;

then x in Pb by A11,A28;
hence thesis by A12;
end;
end;
end;

let Pmin being (a_partition of X);
assume that
A30: Pmax is_finer_than Pmin;
let hw being set;
assume that
A31: hw in Pmin
and
A32: h c= hw;
let s being set;
assume that
A33: s in P;
per cases  by A33,XBOOLE_0:def 3;
suppose s in Pb;

then s in Pmax by A11;
hence thesis by A30,SETFAM_1:def 2;
end;
suppose s in { h };

then s = h by TARSKI:def 1;
hence thesis by A31,A32;
end;
end;
