environ
vocabularies ORDERS_2,XBOOLE_0,SUBSET_1,ORDERS_1,XXREAL_0,YELLOW_1,RELAT_2,WELLORD2,RELAT_1,TARSKI,TREES_1,EQREL_1,TAXONOM1,SETFAM_1,ZFMISC_1,ABIAN,PRE_TOPC,LATTICES,ORDINAL1,PARTIT1,TAXONOM2;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,SETFAM_1,RELAT_1,ORDINAL1,RELSET_1,STRUCT_0,ORDERS_2,EQREL_1,ABIAN,PARTIT1,ORDERS_1,YELLOW_1,TAXONOM1,CKB1,CKB2,CKB5,CKB10,CKB15,CKB16,CKB21,CKB24,CKB26;
definitions TARSKI,EQREL_1,TAXONOM1,SETFAM_1,XBOOLE_0,CKB1,CKB2,CKB10,CKB15,CKB16,CKB21,CKB24,CKB26;
theorems TARSKI,TAXONOM1,PARTIT1,EQREL_1,ZFMISC_1,ORDERS_2,ORDERS_1,RELAT_1,RELSET_1,SETFAM_1,REALSET1,ABIAN,YELLOW_1,WELLORD2,ORDINAL1,XBOOLE_0,XBOOLE_1,CKB1,CKB2,CKB3,CKB6,CKB7,CKB8,CKB9,CKB10,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB24,CKB25,CKB26,CKB27,CKB28,CKB29,CKB30,CKB31;
schemes XBOOLE_0;
registrations XBOOLE_0,SUBSET_1,RELSET_1,EQREL_1,YELLOW_1,CKB4,CKB11,CKB12,CKB17,CKB23;
constructors SETFAM_1,REALSET1,ABIAN,YELLOW_1,TAXONOM1,RELSET_1,CKB1,CKB2,CKB10,CKB15,CKB16,CKB21,CKB24,CKB26;
requirements BOOLE,SUBSET;
begin
reserve A for RelStr;
reserve X for non  empty set;
reserve a for set;
reserve b for set;
reserve c for set;
reserve x for set;
reserve y for set;
theorem
Th18: (for h being non  empty set holds (for Pmin being (a_partition of X) holds (for hw being set holds ((hw in Pmin & h c= hw) implies (for PS being (a_partition of X) holds ((h in PS & (for x holds (x in PS implies ((x c= hw or hw c= x) or hw misses x)))) implies (for PT being set holds ((for a holds (a in PT iff (a in PS & a c= hw))) implies (( PT \/ ( Pmin \ { hw } ) ) is (a_partition of X) & ( PT \/ ( Pmin \ { hw } ) ) is_finer_than Pmin)))))))))
proof
let h being non  empty set;
let Pmin being (a_partition of X);
let hw being set;
assume that
A1: hw in Pmin
and
A2: h c= hw;
let PS being (a_partition of X);
assume that
A3: h in PS
and
A4: (for x holds (x in PS implies ((x c= hw or hw c= x) or hw misses x)));
let PT being set;
assume that
A5: (for a holds (a in PT iff (a in PS & a c= hw)));
A6: PT c= PS
proof
let a;
assume a in PT;
hence thesis by A5;
end;
A7: ( union PS ) = X by EQREL_1:def 4;
A8: ( union Pmin ) = X by EQREL_1:def 4;
set P = ( PT \/ ( Pmin \ { hw } ) );
A9: PT c= P by XBOOLE_1:7;
A10: ( Pmin \ { hw } ) c= P by XBOOLE_1:7;
A11: h in PT by A2,A3,A5;
A12: X c= ( union P )
proof
let a;
assume that
A13: a in X;
consider b such that A14: a in b and A15: b in Pmin by A8,A13,TARSKI:def 4;
per cases ;
suppose A16: b = hw;

consider c such that A17: a in c and A18: c in PS by A7,A13,TARSKI:def 4;
A19: hw meets c by A14,A16,A17,XBOOLE_0:3;
per cases  by A4,A18,A19;
suppose hw c= c;

then A20: h c= c by A2,XBOOLE_1:1;
h meets c
proof
A21: (ex x st x in h) by XBOOLE_0:def 1;
assume h misses c;
hence contradiction by A20,A21,XBOOLE_0:3;
end;
then h = c by A3,A18,EQREL_1:def 4;
hence thesis by A9,A11,A17,TARSKI:def 4;
end;
suppose c c= hw;

then c in PT by A5,A18;
hence thesis by A9,A17,TARSKI:def 4;
end;
end;
suppose b <> hw;

then (not b in { hw }) by TARSKI:def 1;
then b in ( Pmin \ { hw } ) by A15,XBOOLE_0:def 5;
hence thesis by A10,A14,TARSKI:def 4;
end;
end;
A22: ( Pmin \ { hw } ) c= Pmin by XBOOLE_1:36;
A23:now
let x;
let y;
assume that
A24: x in PT
and
A25: y in ( Pmin \ { hw } );
A26: y in Pmin by A25,XBOOLE_0:def 5;
(not y in { hw }) by A25,XBOOLE_0:def 5;
then A27: y <> hw by TARSKI:def 1;
A28: x c= hw by A5,A24;
now
assume x meets y;
then (ex a st (a in x & a in y)) by XBOOLE_0:3;
then hw meets y by A28,XBOOLE_0:3;
hence contradiction by A1,A26,A27,EQREL_1:def 4;
end;
hence x misses y;
end;
A29:now
let A being (Subset of X);
assume that
A30: A in P;
now
per cases  by A30,XBOOLE_0:def 3;
suppose A in PT;

hence A <> ( {} ) by A6,EQREL_1:def 4;
end;
suppose A in ( Pmin \ { hw } );

hence A <> ( {} ) by A22,EQREL_1:def 4;
end;
end;
hence A <> ( {} );
thus (for B being (Subset of X) holds (B in P implies (A = B or A misses B)))
proof
let B being (Subset of X);
assume that
A31: B in P;
per cases  by A30,XBOOLE_0:def 3;
suppose A32: A in PT;

per cases  by A31,XBOOLE_0:def 3;
suppose B in PT;

hence thesis by A6,A32,EQREL_1:def 4;
end;
suppose B in ( Pmin \ { hw } );

hence thesis by A23,A32;
end;
end;
suppose A33: A in ( Pmin \ { hw } );

per cases  by A31,XBOOLE_0:def 3;
suppose B in PT;

hence thesis by A23,A33;
end;
suppose B in ( Pmin \ { hw } );

hence thesis by A22,A33,EQREL_1:def 4;
end;
end;
end;

end;
PT c= ( bool X ) by A6,XBOOLE_1:1;
then A34: P c= ( bool X ) by XBOOLE_1:8;
( union P ) c= X
proof
let a;
assume a in ( union P );
then (ex b st (a in b & b in P)) by TARSKI:def 4;
hence thesis by A34;
end;
then ( union P ) = X by A12,XBOOLE_0:def 10;
hence ( PT \/ ( Pmin \ { hw } ) ) is (a_partition of X) by A34,A29,EQREL_1:def 4;
let a;
assume that
A35: a in P;
per cases  by A35,XBOOLE_0:def 3;
suppose a in PT;

then a c= hw by A5;
hence thesis by A1;
end;
suppose a in ( Pmin \ { hw } );

hence thesis by A22;
end;
end;
