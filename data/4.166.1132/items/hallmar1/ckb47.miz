environ
vocabularies NUMBERS,FINSET_1,CARD_1,XBOOLE_0,ARYTM_3,ARYTM_1,SUBSET_1,XXREAL_0,NAT_1,RELAT_1,FINSEQ_1,ZFMISC_1,FUNCT_1,TARSKI,FUNCT_4,HALLMAR1;
notations TARSKI,XBOOLE_0,ZFMISC_1,SUBSET_1,RELAT_1,FUNCT_1,CARD_1,NUMBERS,XCMPLX_0,XXREAL_0,NAT_1,FINSET_1,FINSEQ_1,FUNCT_2,FUNCT_7,CKB7,CKB17,CKB22,CKB23,CKB31,CKB32,CKB33,CKB42;
definitions TARSKI,XBOOLE_0,CKB7,CKB17,CKB22,CKB23,CKB31,CKB32,CKB33,CKB42;
theorems CARD_2,SPPOL_1,EULER_1,XBOOLE_1,ZFMISC_1,FUNCT_1,PARTFUN1,FINSET_1,PENCIL_1,CARD_1,TARSKI,NAT_1,XBOOLE_0,FINSEQ_1,FUNCT_7,FINSEQ_3,FINSEQ_5,TAXONOM1,RELAT_1,FUNCT_2,ENUMSET1,FINSEQ_2,REALSET1,XREAL_1,XXREAL_0,ORDINAL1,CKB1,CKB5,CKB7,CKB8,CKB9,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB17,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB26,CKB28,CKB29,CKB30,CKB31,CKB32,CKB33,CKB34,CKB35,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB46;
schemes NAT_1,FUNCT_2,XBOOLE_0,CKB2,CKB3;
registrations SUBSET_1,RELAT_1,FUNCT_1,FINSET_1,XXREAL_0,XREAL_0,FINSEQ_1,CHAIN_1,ORDINAL1,CARD_1,RELSET_1,CKB4,CKB6,CKB10,CKB24,CKB25,CKB27,CKB44,CKB45;
constructors XXREAL_0,REAL_1,NAT_1,FUNCT_7,RELSET_1,CKB7,CKB17,CKB22,CKB23,CKB31,CKB32,CKB33,CKB42;
requirements REAL,NUMERALS,SUBSET,BOOLE,ARITHM;
begin
theorem
Th29: (for F being  finite set holds (for A being (FinSequence of ( bool F )) holds (A is  Hall implies (for i being (Element of ( NAT )) holds (( card ( A . i ) ) >= 2 implies (ex x being set st (x in ( A . i ) & ( Cut (A,i,x) ) is  Hall)))))))
proof
let F being  finite set;
let A being (FinSequence of ( bool F ));
assume that
A1: A is  Hall;
let i being (Element of ( NAT ));
assume that
A2: ( card ( A . i ) ) >= 2;
2 c= ( card ( A . i ) ) by A2,NAT_1:39;
then reconsider Ai = ( A . i ) as non trivial  finite set by PENCIL_1:4;
consider x being set,y being set such that A3: x in Ai and A4: y in Ai and A5: x <> y by ZFMISC_1:def 10;
assume A6: (for z being set holds (z in ( A . i ) implies (not ( Cut (A,i,z) ) is  Hall)));
then (not ( Cut (A,i,x) ) is  Hall) by A3;
then consider JJ1 being  finite set such that A7: JJ1 c= ( dom ( Cut (A,i,x) ) ) and A8: ( card JJ1 ) > ( card ( union (( Cut (A,i,x) ),JJ1) ) ) by CKB23:def 1;
(ex J1 being  finite set st (((not i in J1) & J1 c= ( dom ( Cut (A,i,x) ) )) & ( card J1 ) >= ( card ( ( union (A,J1) ) \/ ( ( A . i ) \ { x } ) ) )))
proof
per cases ;
suppose A9: i in JJ1;

set J1 = ( JJ1 \ { i } );
A10: ( card J1 ) = ( ( card JJ1 ) - ( card { i } ) ) by A9,EULER_1:4
.= ( ( card JJ1 ) - 1 ) by CARD_1:30;
A11: (J1 c= ( dom ( Cut (A,i,x) ) ) & { i } misses J1) by A7,XBOOLE_1:1,XBOOLE_1:79;
( union (( Cut (A,i,x) ),JJ1) ) = ( ( union (A,( JJ1 \ { i } )) ) \/ ( ( A . i ) \ { x } ) ) by A7,A9,CKB21:1;
then ( card J1 ) >= ( card ( ( union (A,J1) ) \/ ( ( A . i ) \ { x } ) ) ) by A8,A10,SPPOL_1:1;
hence thesis by A11,ZFMISC_1:48;
end;
suppose A12: (not i in JJ1);

take J1 = JJ1;
A13: J1 c= ( dom A ) by A7,CKB17:def 1;
( card J1 ) > ( card ( union (A,J1) ) ) by A8,A12,CKB20:1;
hence thesis by A1,A13,CKB23:def 1;
end;
end;
then consider J1 being  finite set such that A14: (not i in J1) and A15: J1 c= ( dom ( Cut (A,i,x) ) ) and A16: ( card J1 ) >= ( card ( ( union (A,J1) ) \/ ( ( A . i ) \ { x } ) ) );
(not ( Cut (A,i,y) ) is  Hall) by A4,A6;
then consider JJ2 being  finite set such that A17: JJ2 c= ( dom ( Cut (A,i,y) ) ) and A18: ( card JJ2 ) > ( card ( union (( Cut (A,i,y) ),JJ2) ) ) by CKB23:def 1;
(ex J2 being  finite set st (((not i in J2) & J2 c= ( dom ( Cut (A,i,y) ) )) & ( card J2 ) >= ( card ( ( union (A,J2) ) \/ ( ( A . i ) \ { y } ) ) )))
proof
per cases ;
suppose A19: i in JJ2;

set J2 = ( JJ2 \ { i } );
A20: ( card J2 ) = ( ( card JJ2 ) - ( card { i } ) ) by A19,EULER_1:4
.= ( ( card JJ2 ) - 1 ) by CARD_1:30;
A21: (J2 c= ( dom ( Cut (A,i,y) ) ) & { i } misses J2) by A17,XBOOLE_1:1,XBOOLE_1:79;
( union (( Cut (A,i,y) ),JJ2) ) = ( ( union (A,( JJ2 \ { i } )) ) \/ ( ( A . i ) \ { y } ) ) by A17,A19,CKB21:1;
then ( card J2 ) >= ( card ( ( union (A,J2) ) \/ ( ( A . i ) \ { y } ) ) ) by A18,A20,SPPOL_1:1;
hence thesis by A21,ZFMISC_1:48;
end;
suppose A22: (not i in JJ2);

set J2 = JJ2;
take J2;
A23: J2 c= ( dom A ) by A17,CKB17:def 1;
( card J2 ) > ( card ( union (A,J2) ) ) by A18,A22,CKB20:1;
hence thesis by A1,A23,CKB23:def 1;
end;
end;
then consider J2 being  finite set such that A24: (not i in J2) and A25: J2 c= ( dom ( Cut (A,i,y) ) ) and A26: ( card J2 ) >= ( card ( ( union (A,J2) ) \/ ( ( A . i ) \ { y } ) ) );
reconsider L = ( { i } \/ ( J1 \/ J2 ) ) as  finite set;
A27: J2 c= ( dom A ) by A25,CKB17:def 1;
( ( union (A,( J1 \/ J2 )) ) \/ Ai ) c= ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) \/ ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) )
proof
let a being set;
assume A28: a in ( ( union (A,( J1 \/ J2 )) ) \/ Ai );
per cases  by A28,XBOOLE_0:def 3;
suppose a in ( union (A,( J1 \/ J2 )) );

then consider j being set such that A29: j in ( J1 \/ J2 ) and A30: (j in ( dom A ) & a in ( A . j )) by CKB7:def 1;
(j in J1 or j in J2) by A29,XBOOLE_0:def 3;
then (a in ( union (A,J1) ) or a in ( union (A,J2) )) by A30,CKB7:def 1;
then a in ( ( union (A,J1) ) \/ ( union (A,J2) ) ) by XBOOLE_0:def 3;
then a in ( ( ( union (A,J1) ) \/ ( union (A,J2) ) ) \/ ( ( Ai \ { x } ) \/ ( Ai \ { y } ) ) ) by XBOOLE_0:def 3;
then a in ( ( ( ( union (A,J1) ) \/ ( union (A,J2) ) ) \/ ( Ai \ { x } ) ) \/ ( Ai \ { y } ) ) by XBOOLE_1:4;
then a in ( ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) \/ ( union (A,J2) ) ) \/ ( Ai \ { y } ) ) by XBOOLE_1:4;
hence thesis by XBOOLE_1:4;
end;
suppose a in Ai;

then ((a in ( ( Ai \ { x } ) \/ ( Ai \ { y } ) ) or a in ( union (A,J1) )) or a in ( union (A,J2) )) by A3,A4,A5,CKB16:1;
then (a in ( ( ( Ai \ { x } ) \/ ( Ai \ { y } ) ) \/ ( union (A,J1) ) ) or a in ( union (A,J2) )) by XBOOLE_0:def 3;
then a in ( ( ( ( Ai \ { x } ) \/ ( Ai \ { y } ) ) \/ ( union (A,J1) ) ) \/ ( union (A,J2) ) ) by XBOOLE_0:def 3;
then a in ( ( ( union (A,J1) ) \/ ( union (A,J2) ) ) \/ ( ( Ai \ { x } ) \/ ( Ai \ { y } ) ) ) by XBOOLE_1:4;
then a in ( ( ( ( union (A,J1) ) \/ ( union (A,J2) ) ) \/ ( Ai \ { x } ) ) \/ ( Ai \ { y } ) ) by XBOOLE_1:4;
then a in ( ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) \/ ( union (A,J2) ) ) \/ ( Ai \ { y } ) ) by XBOOLE_1:4;
hence thesis by XBOOLE_1:4;
end;
end;
then A31: ( card ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) \/ ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) ) ) >= ( card ( ( union (A,( J1 \/ J2 )) ) \/ Ai ) ) by NAT_1:43;
( union (A,( J1 /\ J2 )) ) c= ( ( union (A,J1) ) /\ ( union (A,J2) ) )
proof
let x being set;
assume x in ( union (A,( J1 /\ J2 )) );
then consider j being set such that A32: j in ( J1 /\ J2 ) and A33: (j in ( dom A ) & x in ( A . j )) by CKB7:def 1;
j in J2 by A32,XBOOLE_0:def 4;
then A34: x in ( union (A,J2) ) by A33,CKB7:def 1;
j in J1 by A32,XBOOLE_0:def 4;
then x in ( union (A,J1) ) by A33,CKB7:def 1;
hence thesis by A34,XBOOLE_0:def 4;
end;
then ( card ( ( union (A,J1) ) /\ ( union (A,J2) ) ) ) >= ( card ( union (A,( J1 /\ J2 )) ) ) by NAT_1:43;
then A35: ( ( card ( ( union (A,( J1 \/ J2 )) ) \/ Ai ) ) + ( card ( ( union (A,J1) ) /\ ( union (A,J2) ) ) ) ) >= ( ( card ( Ai \/ ( union (A,( J1 \/ J2 )) ) ) ) + ( card ( union (A,( J1 /\ J2 )) ) ) ) by XREAL_1:7;
J1 c= ( dom A ) by A15,CKB17:def 1;
then A36: ( J1 \/ J2 ) c= ( dom A ) by A27,XBOOLE_1:8;
A37: i in ( dom A ) by A2,CARD_1:27,FUNCT_1:def 2;
then { i } c= ( dom A ) by ZFMISC_1:31;
then L c= ( dom A ) by A36,XBOOLE_1:8;
then ( card ( union (A,( { i } \/ ( J1 \/ J2 ) )) ) ) >= ( card ( { i } \/ ( J1 \/ J2 ) ) ) by A1,CKB23:def 1;
then A38: ( card ( union (A,( ( { i } \/ J1 ) \/ J2 )) ) ) >= ( card ( { i } \/ ( J1 \/ J2 ) ) ) by XBOOLE_1:4;
(not i in ( J1 \/ J2 )) by A14,A24,XBOOLE_0:def 3;
then A39: ( card ( { i } \/ ( J1 \/ J2 ) ) ) = ( ( card { i } ) + ( card ( J1 \/ J2 ) ) ) by CARD_2:40,ZFMISC_1:50;
(( J1 /\ J2 ) c= J1 & J1 c= ( dom A )) by A15,CKB17:def 1,XBOOLE_1:17;
then ( J1 /\ J2 ) c= ( dom A ) by XBOOLE_1:1;
then A40: ( card ( union (A,( J1 /\ J2 )) ) ) >= ( card ( J1 /\ J2 ) ) by A1,CKB23:def 1;
set S2 = ( ( union (A,J2) ) \/ ( ( A . i ) \ { y } ) );
set S1 = ( ( union (A,J1) ) \/ ( ( A . i ) \ { x } ) );
( ( card J1 ) + ( card J2 ) ) >= ( ( card S1 ) + ( card S2 ) ) by A16,A26,XREAL_1:7;
then A41: ( ( card J1 ) + ( card J2 ) ) >= ( ( card ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) \/ ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) ) ) + ( card ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) /\ ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) ) ) ) by CKB1:1;
( ( union (A,J1) ) /\ ( union (A,J2) ) ) c= ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) /\ ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) )
proof
let a being set;
assume A42: a in ( ( union (A,J1) ) /\ ( union (A,J2) ) );
then a in ( union (A,J2) ) by XBOOLE_0:def 4;
then A43: a in ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) by XBOOLE_0:def 3;
a in ( union (A,J1) ) by A42,XBOOLE_0:def 4;
then a in ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) by XBOOLE_0:def 3;
hence thesis by A43,XBOOLE_0:def 4;
end;
then ( card ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) /\ ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) ) ) >= ( card ( ( union (A,J1) ) /\ ( union (A,J2) ) ) ) by NAT_1:43;
then ( ( card ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) \/ ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) ) ) + ( card ( ( ( union (A,J1) ) \/ ( Ai \ { x } ) ) /\ ( ( union (A,J2) ) \/ ( Ai \ { y } ) ) ) ) ) >= ( ( card ( ( union (A,( J1 \/ J2 )) ) \/ Ai ) ) + ( card ( ( union (A,J1) ) /\ ( union (A,J2) ) ) ) ) by A31,XREAL_1:7;
then ( ( card J1 ) + ( card J2 ) ) >= ( ( card ( ( union (A,( J1 \/ J2 )) ) \/ Ai ) ) + ( card ( ( union (A,J1) ) /\ ( union (A,J2) ) ) ) ) by A41,XXREAL_0:2;
then A44: ( ( card J1 ) + ( card J2 ) ) >= ( ( card ( Ai \/ ( union (A,( J1 \/ J2 )) ) ) ) + ( card ( union (A,( J1 /\ J2 )) ) ) ) by A35,XXREAL_0:2;
( card ( union (A,( ( { i } \/ J1 ) \/ J2 )) ) ) = ( card ( Ai \/ ( union (A,( J1 \/ J2 )) ) ) ) by A37,CKB15:1;
then ( card ( Ai \/ ( union (A,( J1 \/ J2 )) ) ) ) >= ( 1 + ( card ( J1 \/ J2 ) ) ) by A38,A39,CARD_1:30;
then A45: ( ( card ( Ai \/ ( union (A,( J1 \/ J2 )) ) ) ) + ( card ( union (A,( J1 /\ J2 )) ) ) ) >= ( ( 1 + ( card ( J1 \/ J2 ) ) ) + ( card ( J1 /\ J2 ) ) ) by A40,XREAL_1:7;
( ( card ( J1 \/ J2 ) ) + ( card ( J1 /\ J2 ) ) ) = ( ( card J1 ) + ( card J2 ) ) by CKB1:1;
then ( ( 1 + ( card ( J1 \/ J2 ) ) ) + ( card ( J1 /\ J2 ) ) ) = ( 1 + ( ( card J1 ) + ( card J2 ) ) );
hence thesis by A44,A45,NAT_1:13;
end;
