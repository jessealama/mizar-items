environ
vocabularies NUMBERS,XBOOLE_0,SUBSET_1,FUNCT_1,CARD_1,XCMPLX_0,INT_2,ORDINAL1,XXREAL_0,ARYTM_3,FINSEQ_1,RELAT_1,ABIAN,NEWTON,NAT_3,PRE_POLY,NAT_1,UPROOTS,CARD_3,TARSKI,INT_1,FINSET_1,ARYTM_1,PYTHTRIP,ZFMISC_1,SQUARE_1,XREAL_0,REAL_1,SETFAM_1,PBOOLE,VALUED_0,FUNCOP_1,MOEBIUS1;
notations TARSKI,XBOOLE_0,SUBSET_1,FINSET_1,ZFMISC_1,ORDINAL1,CARD_1,NUMBERS,XCMPLX_0,XREAL_0,XXREAL_0,NEWTON,SETFAM_1,RELAT_1,FUNCT_1,FUNCT_2,FINSEQ_1,VALUED_0,SEQ_1,PBOOLE,SQUARE_1,RVSUM_1,BINOP_2,FUNCOP_1,XXREAL_2,NAT_3,DOMAIN_1,ABIAN,PYTHTRIP,UPROOTS,RECDEF_1,PRE_POLY,POLYNOM2,REAL_1,NAT_1,NAT_D,INT_2,CKB25,CKB27,CKB32,CKB42,CKB53,CKB58,CKB64,CKB73;
definitions TARSKI,XBOOLE_0,RVSUM_1,SQUARE_1,CKB25,CKB32,CKB42,CKB53,CKB58,CKB64,CKB73;
theorems XBOOLE_0,NAT_3,BAGORDER,NEWTON,INT_2,NAT_2,WSIERP_1,CARD_1,PEPIN,NAT_1,XCMPLX_1,XREAL_1,PYTHTRIP,ABIAN,ORDINAL1,EULER_1,XREAL_0,FINSEQ_1,XBOOLE_1,TARSKI,ZFMISC_1,RVSUM_1,FINSEQ_2,NUMBERS,INT_1,FUNCT_1,PBOOLE,UPROOTS,CARD_4,FUNCOP_1,RADIX_1,RELAT_1,FINSOP_1,XXREAL_0,NAT_D,VALUED_0,XXREAL_2,FUNCT_2,PARTFUN1,PRE_POLY,MEASURE6,CKB1,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB28,CKB29,CKB30,CKB32,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB57,CKB58,CKB61,CKB62,CKB63,CKB64,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB76,CKB77;
schemes FUNCT_2,CLASSES1,PRE_CIRC,SUBSET_1,NAT_1,CKB2;
registrations XBOOLE_0,FUNCT_1,ORDINAL1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,NEWTON,NAT_3,VALUED_0,XXREAL_2,CARD_1,FUNCT_2,UPROOTS,RELSET_1,PRE_POLY,REAL_1,CKB3,CKB17,CKB31,CKB33,CKB34,CKB35,CKB47,CKB56,CKB59,CKB60,CKB65,CKB75;
constructors SETFAM_1,NAT_D,FINSOP_1,ZFMISC_1,BINARITH,WSIERP_1,ABIAN,PEPIN,PYTHTRIP,POLYNOM2,UPROOTS,NAT_3,SEQ_1,RECDEF_1,BINOP_2,XXREAL_2,PRE_POLY,REAL_1,DOMAIN_1,RELSET_1,CKB25,CKB32,CKB42,CKB53,CKB58,CKB64,CKB73;
requirements NUMERALS,SUBSET,ARITHM,REAL,BOOLE;
begin
theorem
Th55: (for n being non zero  natural number holds ( Radical n ) divides n)
proof
defpred P[  natural number ]
 means
(for n being non zero  natural number holds (( support ( PFactors n ) ) c= ( Seg $1 ) implies ( Radical n ) divides n));
let n being non zero  natural number;
A1: (ex mS being (Element of ( NAT )) st ( support ( ppf n ) ) c= ( Seg mS )) by CKB19:1;
A2: ( support ( ppf n ) ) = ( support ( pfexp n ) ) by NAT_3:def 9
.= ( support ( PFactors n ) ) by CKB64:def 1;
A3: (for k being  natural number holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being  natural number;
assume A4: P[ k ];
let n being non zero  natural number;
assume that
A5: ( support ( PFactors n ) ) c= ( Seg ( k + 1 ) );
A6: ( support ( pfexp n ) ) = ( support ( PFactors n ) ) by CKB64:def 1;
per cases ;
suppose A7: (not ( support ( PFactors n ) ) c= ( Seg k ));

set p = ( k + 1 );
set e = ( p |-count n );
set s = ( p |^ e );
A8:now
assume A9: (not ( k + 1 ) in ( support ( PFactors n ) ));
( support ( PFactors n ) ) c= ( Seg k )
proof
let x being set;
assume A10: x in ( support ( PFactors n ) );
then reconsider m = x as  natural number;
m <= ( k + 1 ) by A5,A10,FINSEQ_1:1;
then m < ( k + 1 ) by A9,A10,XXREAL_0:1;
then A11: m <= k by NAT_1:13;
x is Prime by A6,A10,NAT_3:34;
then 1 <= m by INT_2:def 4;
hence thesis by A11,FINSEQ_1:1;
end;
hence contradiction by A7;
end;
then A12: p is Prime by A6,NAT_3:34;
then A13: p > 1 by INT_2:def 4;
then s divides n by NAT_3:def 7;
then consider t being Nat such that A14: n = ( s * t ) by NAT_D:def 3;
reconsider s,t as non zero  natural number by A14;
consider f being (FinSequence of ( COMPLEX )) such that A15: ( Product ( PFactors s ) ) = ( Product f ) and A16: f = ( ( PFactors s ) * ( canFS ( support ( PFactors s ) ) ) ) by NAT_3:def 5;
A17: ( dom ( PFactors s ) ) = ( SetPrimes ) by PARTFUN1:def 2;
A18: ( support ( ppf s ) ) = ( support ( pfexp s ) ) by NAT_3:def 9;
then A19: ( support ( ppf s ) ) = ( support ( PFactors s ) ) by CKB64:def 1;
( ( pfexp n ) . p ) = e by A12,NAT_3:def 8;
then A20: e <> ( 0 ) by A6,A8,PRE_POLY:def 7;
then A21: ( support ( ppf s ) ) = { p } by A12,A18,NAT_3:42;
then A22: p in ( support ( pfexp s ) ) by A18,TARSKI:def 1;
A23: ( support ( PFactors t ) ) c= ( Seg k )
proof
set f = ( p |-count t );
let x being set;
assume A24: x in ( support ( PFactors t ) );
then reconsider m = x as  natural number;
A25: x in ( support ( pfexp t ) ) by A24,CKB64:def 1;
A26:now
assume A27: m = p;
( ( pfexp t ) . p ) = f by A12,NAT_3:def 8;
then f <> ( 0 ) by A25,A27,PRE_POLY:def 7;
then f >= ( ( 0 ) + 1 ) by NAT_1:13;
then consider g being Nat such that A28: f = ( 1 + g ) by NAT_1:10;
( p |^ f ) divides t by A13,NAT_3:def 7;
then consider u being Nat such that A29: t = ( ( p |^ f ) * u ) by NAT_D:def 3;
reconsider g as (Element of ( NAT )) by ORDINAL1:def 12;
n = ( s * ( ( ( p |^ g ) * p ) * u ) ) by A14,A28,A29,NEWTON:6
.= ( ( s * p ) * ( ( p |^ g ) * u ) )
.= ( ( p |^ ( e + 1 ) ) * ( ( p |^ g ) * u ) ) by NEWTON:6;
then ( p |^ ( e + 1 ) ) divides n by NAT_D:def 3;
hence contradiction by A13,NAT_3:def 7;
end;
( support ( pfexp t ) ) c= ( support ( pfexp n ) ) by A14,NAT_3:45;
then ( support ( PFactors t ) ) c= ( support ( PFactors n ) ) by A6,CKB64:def 1;
then m in ( support ( PFactors n ) ) by A24;
then m <= ( k + 1 ) by A5,FINSEQ_1:1;
then m < p by A26,XXREAL_0:1;
then A30: m <= k by NAT_1:13;
x is Prime by A25,NAT_3:34;
then 1 <= m by INT_2:def 4;
hence thesis by A30,FINSEQ_1:1;
end;
then A31: ( Radical t ) divides t by A4;
( support ( PFactors s ) ) = { p } by A18,A21,CKB64:def 1;
then f = ( ( PFactors s ) * <* p *> ) by A16,UPROOTS:4
.= <* ( ( PFactors s ) . p ) *> by A8,A17,FINSEQ_2:34;
then ( Product ( PFactors s ) ) = ( ( PFactors s ) . p ) by A15,RVSUM_1:95
.= p by A22,CKB64:def 1;
then A32: ( Radical s ) divides s by A20,NAT_3:3;
reconsider s1 = s,t1 = t as non zero (Element of ( NAT )) by ORDINAL1:def 12;
( support ( ppf t ) ) = ( support ( pfexp t ) ) by NAT_3:def 9;
then A33: ( support ( ppf t ) ) = ( support ( PFactors t ) ) by CKB64:def 1;
A34:now
assume ( support ( ppf s ) ) meets ( support ( ppf t ) );
then consider x being set such that A35: x in ( support ( ppf s ) ) and A36: x in ( support ( ppf t ) ) by XBOOLE_0:3;
x in ( support ( pfexp t ) ) by A36,NAT_3:def 9;
then A37: x in ( support ( PFactors t ) ) by CKB64:def 1;
x = p by A21,A35,TARSKI:def 1;
then p <= k by A23,A37,FINSEQ_1:1;
hence contradiction by NAT_1:13;
end;
s1,t1 are_relative_prime 
proof
set u = ( s1 gcd t1 );
A38: u divides t1 by NAT_D:def 5;
u <> ( 0 ) by INT_2:5;
then A39: ( ( 0 ) + 1 ) <= u by NAT_1:13;
assume (not s1,t1 are_relative_prime );
then ( s1 gcd t1 ) <> 1 by INT_2:def 3;
then u > 1 by A39,XXREAL_0:1;
then u >= ( 1 + 1 ) by NAT_1:13;
then consider r being (Element of ( NAT )) such that A40: r is  prime and A41: r divides u by INT_2:31;
u divides s1 by NAT_D:def 5;
then r divides s1 by A41,NAT_D:4;
then r divides p by A40,NAT_3:5;
then (r = 1 or r = p) by A12,INT_2:def 4;
then p divides t1 by A40,A41,A38,INT_2:def 4,NAT_D:4;
then p in ( support ( pfexp t ) ) by A12,NAT_3:37;
then p in ( support ( PFactors t ) ) by CKB64:def 1;
then ( k + 1 ) <= k by A23,FINSEQ_1:1;
hence contradiction by NAT_1:13;
end;
then ( Radical n ) = ( Product ( ( PFactors s ) + ( PFactors t ) ) ) by A14,CKB71:1
.= ( ( Radical s ) * ( Radical t ) ) by A34,A19,A33,NAT_3:19;
hence thesis by A14,A32,A31,NAT_3:1;
end;
suppose ( support ( PFactors n ) ) c= ( Seg k );

hence thesis by A4;
end;
end;
A42: P[ ( 0 ) ]
proof
let n being non zero  natural number;
A43: ( {} ) c= ( support ( PFactors n ) ) by XBOOLE_1:2;
assume ( support ( PFactors n ) ) c= ( Seg ( 0 ) );
then ( support ( PFactors n ) ) = ( {} ) by A43,XBOOLE_0:def 10;
then ( PFactors n ) = ( EmptyBag ( SetPrimes ) ) by BAGORDER:19;
then ( Radical n ) = 1 by NAT_3:20;
hence thesis by NAT_D:6;
end;
(for k being  natural number holds P[ k ]) from NAT_1:sch 2(A42,A3);
hence thesis by A1,A2;
end;
