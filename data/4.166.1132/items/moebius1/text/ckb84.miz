environ
vocabularies NUMBERS,XBOOLE_0,SUBSET_1,FUNCT_1,CARD_1,XCMPLX_0,INT_2,ORDINAL1,XXREAL_0,ARYTM_3,FINSEQ_1,RELAT_1,ABIAN,NEWTON,NAT_3,PRE_POLY,NAT_1,UPROOTS,CARD_3,TARSKI,INT_1,FINSET_1,ARYTM_1,PYTHTRIP,ZFMISC_1,SQUARE_1,XREAL_0,REAL_1,SETFAM_1,PBOOLE,VALUED_0,FUNCOP_1,MOEBIUS1;
notations TARSKI,XBOOLE_0,SUBSET_1,FINSET_1,ZFMISC_1,ORDINAL1,CARD_1,NUMBERS,XCMPLX_0,XREAL_0,XXREAL_0,NEWTON,SETFAM_1,RELAT_1,FUNCT_1,FUNCT_2,FINSEQ_1,VALUED_0,SEQ_1,PBOOLE,SQUARE_1,RVSUM_1,BINOP_2,FUNCOP_1,XXREAL_2,NAT_3,DOMAIN_1,ABIAN,PYTHTRIP,UPROOTS,RECDEF_1,PRE_POLY,POLYNOM2,REAL_1,NAT_1,NAT_D,INT_2,CKB25,CKB27,CKB32,CKB42,CKB53,CKB58,CKB64,CKB73;
definitions TARSKI,XBOOLE_0,RVSUM_1,SQUARE_1,CKB25,CKB32,CKB42,CKB53,CKB58,CKB64,CKB73;
theorems XBOOLE_0,NAT_3,BAGORDER,NEWTON,INT_2,NAT_2,WSIERP_1,CARD_1,PEPIN,NAT_1,XCMPLX_1,XREAL_1,PYTHTRIP,ABIAN,ORDINAL1,EULER_1,XREAL_0,FINSEQ_1,XBOOLE_1,TARSKI,ZFMISC_1,RVSUM_1,FINSEQ_2,NUMBERS,INT_1,FUNCT_1,PBOOLE,UPROOTS,CARD_4,FUNCOP_1,RADIX_1,RELAT_1,FINSOP_1,XXREAL_0,NAT_D,VALUED_0,XXREAL_2,FUNCT_2,PARTFUN1,PRE_POLY,MEASURE6,CKB1,CKB4,CKB5,CKB6,CKB7,CKB8,CKB9,CKB10,CKB11,CKB12,CKB13,CKB14,CKB15,CKB16,CKB18,CKB19,CKB20,CKB21,CKB22,CKB23,CKB24,CKB25,CKB26,CKB28,CKB29,CKB30,CKB32,CKB36,CKB37,CKB38,CKB39,CKB40,CKB41,CKB42,CKB43,CKB44,CKB45,CKB46,CKB48,CKB49,CKB50,CKB51,CKB52,CKB53,CKB54,CKB55,CKB57,CKB58,CKB61,CKB62,CKB63,CKB64,CKB66,CKB67,CKB68,CKB69,CKB70,CKB71,CKB72,CKB73,CKB74,CKB76,CKB77,CKB78,CKB79,CKB80,CKB81,CKB82,CKB83;
schemes FUNCT_2,CLASSES1,PRE_CIRC,SUBSET_1,NAT_1,CKB2;
registrations XBOOLE_0,FUNCT_1,ORDINAL1,FINSET_1,NUMBERS,XCMPLX_0,XXREAL_0,XREAL_0,NAT_1,INT_1,MEMBERED,FINSEQ_1,NEWTON,NAT_3,VALUED_0,XXREAL_2,CARD_1,FUNCT_2,UPROOTS,RELSET_1,PRE_POLY,REAL_1,CKB3,CKB17,CKB31,CKB33,CKB34,CKB35,CKB47,CKB56,CKB59,CKB60,CKB65,CKB75;
constructors SETFAM_1,NAT_D,FINSOP_1,ZFMISC_1,BINARITH,WSIERP_1,ABIAN,PEPIN,PYTHTRIP,POLYNOM2,UPROOTS,NAT_3,SEQ_1,RECDEF_1,BINOP_2,XXREAL_2,PRE_POLY,REAL_1,DOMAIN_1,RELSET_1,CKB25,CKB32,CKB42,CKB53,CKB58,CKB64,CKB73;
requirements NUMERALS,SUBSET,ARITHM,REAL,BOOLE;
begin
reserve n for  natural number;
theorem
Th61: (for p being Prime holds (for n being non  zero  natural number holds ( p |-count ( Radical n ) ) <= 1))
proof
defpred P[  natural number ]
 means
(for n being non  zero  natural number holds (( support ( PFactors n ) ) c= ( Seg $1 ) implies (for p being Prime holds ( p |-count ( Radical n ) ) <= 1)));
let p being Prime;
let n being non  zero  natural number;
A1: (ex mS being (Element of ( NAT )) st ( support ( ppf n ) ) c= ( Seg mS )) by CKB19:1;
A2: ( support ( ppf n ) ) = ( support ( pfexp n ) ) by NAT_3:def 9
.= ( support ( PFactors n ) ) by CKB64:def 1;
A3: (for k being  natural number holds (P[ k ] implies P[ ( k + 1 ) ]))
proof
let k being  natural number;
assume A4: P[ k ];
let n being non  zero  natural number;
assume that
A5: ( support ( PFactors n ) ) c= ( Seg ( k + 1 ) );
A6: ( support ( pfexp n ) ) = ( support ( PFactors n ) ) by CKB64:def 1;
per cases ;
suppose A7: (not ( support ( PFactors n ) ) c= ( Seg k ));

let p being Prime;
reconsider r = ( k + 1 ) as non  zero (Element of ( NAT ));
set e = ( r |-count n );
set s = ( r |^ e );
A8:now
assume A9: (not ( k + 1 ) in ( support ( PFactors n ) ));
( support ( PFactors n ) ) c= ( Seg k )
proof
let x being set;
assume A10: x in ( support ( PFactors n ) );
then reconsider m = x as  natural number;
m <= ( k + 1 ) by A5,A10,FINSEQ_1:1;
then m < ( k + 1 ) by A9,A10,XXREAL_0:1;
then A11: m <= k by NAT_1:13;
x is Prime by A6,A10,NAT_3:34;
then 1 <= m by INT_2:def 4;
hence thesis by A11,FINSEQ_1:1;
end;
hence contradiction by A7;
end;
then A12: r is Prime by A6,NAT_3:34;
then A13: r > 1 by INT_2:def 4;
then s divides n by NAT_3:def 7;
then consider t being Nat such that A14: n = ( s * t ) by NAT_D:def 3;
reconsider s,t as non  zero  natural number by A14;
reconsider s1 = s,t1 = t as non  zero (Element of ( NAT )) by ORDINAL1:def 12;
A15: ( support ( ppf s ) ) = ( support ( pfexp s ) ) by NAT_3:def 9;
then A16: ( support ( ppf s ) ) = ( support ( PFactors s ) ) by CKB64:def 1;
A17: ( support ( PFactors t ) ) c= ( Seg k )
proof
set f = ( r |-count t );
let x being set;
assume A18: x in ( support ( PFactors t ) );
then reconsider m = x as  natural number;
A19: x in ( support ( pfexp t ) ) by A18,CKB64:def 1;
A20:now
assume A21: m = r;
( ( pfexp t ) . r ) = f by A12,NAT_3:def 8;
then f <> ( 0 ) by A19,A21,PRE_POLY:def 7;
then f >= ( ( 0 ) + 1 ) by NAT_1:13;
then consider g being Nat such that A22: f = ( 1 + g ) by NAT_1:10;
( r |^ f ) divides t by A13,NAT_3:def 7;
then consider u being Nat such that A23: t = ( ( r |^ f ) * u ) by NAT_D:def 3;
reconsider g as (Element of ( NAT )) by ORDINAL1:def 12;
n = ( s * ( ( ( r |^ g ) * r ) * u ) ) by A14,A22,A23,NEWTON:6
.= ( ( s * r ) * ( ( r |^ g ) * u ) )
.= ( ( r |^ ( e + 1 ) ) * ( ( r |^ g ) * u ) ) by NEWTON:6;
then ( r |^ ( e + 1 ) ) divides n by NAT_D:def 3;
hence contradiction by A13,NAT_3:def 7;
end;
( support ( pfexp t ) ) c= ( support ( pfexp n ) ) by A14,NAT_3:45;
then ( support ( PFactors t ) ) c= ( support ( PFactors n ) ) by A6,CKB64:def 1;
then m in ( support ( PFactors n ) ) by A18;
then m <= ( k + 1 ) by A5,FINSEQ_1:1;
then m < r by A20,XXREAL_0:1;
then A24: m <= k by NAT_1:13;
x is Prime by A19,NAT_3:34;
then 1 <= m by INT_2:def 4;
hence thesis by A24,FINSEQ_1:1;
end;
( ( pfexp n ) . r ) = e by A12,NAT_3:def 8;
then A25: e <> ( 0 ) by A6,A8,PRE_POLY:def 7;
A26: ( p |-count ( Radical s ) ) <= 1
proof
per cases ;
suppose A27: p = r;

A28: p > 1 by INT_2:def 4;
( Radical s ) = r by A25,A27,CKB77:1;
hence thesis by A27,A28,NAT_3:22;
end;
suppose p <> r;

then p,r are_relative_prime  by A12,INT_2:30;
then A29: (not p divides r) by PYTHTRIP:def 2;
A30: p > 1 by INT_2:def 4;
( p |-count s ) = ( e * ( p |-count r ) ) by NAT_3:32
.= ( e * ( 0 ) ) by A29,A30,NAT_3:27
.= ( 0 );
hence thesis by CKB78:1,NAT_3:30;
end;
end;
A31: ( support ( ppf s ) ) = { r } by A12,A25,A15,NAT_3:42;
A32:now
assume ( support ( ppf s ) ) meets ( support ( ppf t ) );
then consider x being set such that A33: x in ( support ( ppf s ) ) and A34: x in ( support ( ppf t ) ) by XBOOLE_0:3;
x in ( support ( pfexp t ) ) by A34,NAT_3:def 9;
then A35: x in ( support ( PFactors t ) ) by CKB64:def 1;
x = r by A31,A33,TARSKI:def 1;
then r <= k by A17,A35,FINSEQ_1:1;
hence contradiction by NAT_1:13;
end;
( support ( ppf t ) ) = ( support ( pfexp t ) ) by NAT_3:def 9;
then A36: ( support ( ppf t ) ) = ( support ( PFactors t ) ) by CKB64:def 1;
A37: (( p |-count ( Radical s ) ) = ( 0 ) or ( p |-count ( Radical t ) ) = ( 0 ))
proof
assume that
A38: ( p |-count ( Radical s ) ) <> ( 0 )
and
A39: ( p |-count ( Radical t ) ) <> ( 0 );
( p |-count t ) > ( 0 ) by A39,CKB78:1,NAT_3:30;
then ( ( PFactors t ) . p ) <> ( 0 ) by CKB70:1;
then A40: p in ( support ( PFactors t ) ) by PRE_POLY:def 7;
( p |-count s ) > ( 0 ) by A38,CKB78:1,NAT_3:30;
then ( ( PFactors s ) . p ) <> ( 0 ) by CKB70:1;
then p in ( support ( PFactors s ) ) by PRE_POLY:def 7;
hence thesis by A32,A16,A36,A40,XBOOLE_0:3;
end;
s1,t1 are_relative_prime 
proof
set u = ( s1 gcd t1 );
A41: u divides t1 by NAT_D:def 5;
u <> ( 0 ) by INT_2:5;
then A42: ( ( 0 ) + 1 ) <= u by NAT_1:13;
assume (not s1,t1 are_relative_prime );
then ( s1 gcd t1 ) <> 1 by INT_2:def 3;
then u > 1 by A42,XXREAL_0:1;
then u >= ( 1 + 1 ) by NAT_1:13;
then consider w being (Element of ( NAT )) such that A43: w is  prime and A44: w divides u by INT_2:31;
u divides s1 by NAT_D:def 5;
then w divides s1 by A44,NAT_D:4;
then w divides r by A43,NAT_3:5;
then (w = 1 or w = r) by A12,INT_2:def 4;
then r divides t1 by A43,A44,A41,INT_2:def 4,NAT_D:4;
then r in ( support ( pfexp t ) ) by A12,NAT_3:37;
then r in ( support ( PFactors t ) ) by CKB64:def 1;
then ( k + 1 ) <= k by A17,FINSEQ_1:1;
hence contradiction by NAT_1:13;
end;
then ( Radical n ) = ( Product ( ( PFactors s ) + ( PFactors t ) ) ) by A14,CKB71:1
.= ( ( Radical s ) * ( Radical t ) ) by A32,A16,A36,NAT_3:19;
then ( p |-count ( Radical n ) ) = ( ( p |-count ( Radical t ) ) + ( p |-count ( Radical s ) ) ) by NAT_3:28;
hence thesis by A4,A17,A37,A26;
end;
suppose ( support ( PFactors n ) ) c= ( Seg k );

hence thesis by A4;
end;
end;
A45: P[ ( 0 ) ]
proof
let n being non  zero  natural number;
assume A46: ( support ( PFactors n ) ) c= ( Seg ( 0 ) );
let p being Prime;
( {} ) c= ( support ( PFactors n ) ) by XBOOLE_1:2;
then ( support ( PFactors n ) ) = ( {} ) by A46,XBOOLE_0:def 10;
then A47: ( PFactors n ) = ( EmptyBag ( SetPrimes ) ) by BAGORDER:19;
(not p divides ( Radical n ))
proof
assume p divides ( Radical n );
then A48: p divides 1 by A47,NAT_3:20;
1 divides p by NAT_D:6;
then p = 1 by A48,NAT_D:5;
hence thesis by INT_2:def 4;
end;
hence thesis by CKB10:1;
end;
(for k being  natural number holds P[ k ]) from NAT_1:sch 2(A45,A3);
hence thesis by A1,A2;
end;
