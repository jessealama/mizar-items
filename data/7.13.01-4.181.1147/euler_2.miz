:: Euler's {T}heorem and Small {F}ermat's Theorem
::  by Yoshinori Fujisawa , Yasushi Fuwa and Hidetaka Shimizu
::
:: Received June 10, 1998
:: Copyright (c) 1998-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, NAT_1, INT_1, FINSEQ_1, ARYTM_3, XXREAL_0, CARD_1,
      SUBSET_1, ARYTM_1, INT_2, COMPLEX1, RELAT_1, TARSKI, FUNCT_1, CLASSES1,
      CARD_3, ORDINAL4, RFINSEQ, XBOOLE_0, NEWTON, EULER_1, FINSET_1;
 notations TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, XCMPLX_0, XXREAL_0, CARD_1,
      RELAT_1, FUNCT_1, RECDEF_1, INT_1, INT_2, FINSET_1, ORDINAL1, NAT_1,
      NAT_D, NEWTON, EULER_1, CLASSES1, RFINSEQ, RVSUM_1, FINSEQ_1, FINSEQ_3,
      TREES_4, WSIERP_1;
 constructors REAL_1, SQUARE_1, NAT_1, NAT_D, NEWTON, RFINSEQ, WSIERP_1,
      EULER_1, SEQ_1, RECDEF_1, CLASSES1, BINOP_2, RELSET_1;
 registrations FUNCT_1, ORDINAL1, RELSET_1, NUMBERS, XXREAL_0, XREAL_0, NAT_1,
      INT_1, FINSEQ_1, SEQM_3, NEWTON, XBOOLE_0, VALUED_0, FINSET_1, CARD_1;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, FUNCT_1, XBOOLE_0, RELAT_1;
 theorems INT_2, FINSEQ_1, NAT_1, ABSVALUE, INT_1, FUNCT_1, EULER_1, PREPOWER,
      RFINSEQ, FINSEQ_2, RVSUM_1, FINSEQ_3, NEWTON, RELAT_1, XBOOLE_1,
      XCMPLX_1, XREAL_1, FINSEQ_5, XXREAL_0, ORDINAL1, NAT_D, CLASSES1;
 schemes NAT_1, FINSEQ_1;

begin
L1: (for R9 being Integer holds (R9 < 1 iff R9 <= ( 0 )))
proof
let R9 being Integer;
L2: (R9 < 1 implies R9 <= ( 0 ))
proof
assume L3: R9 < 1;
assume L4: R9 > ( 0 );
reconsider D1 = R9 as (Element of ( NAT )) by L4 , INT_1:3;
L5: D1 >= 1 by L4 , NAT_1:14;
thus L6: contradiction by L5 , L3;
end;
thus L7: thesis by L2;
end;
L8: (for R1 being Nat holds (R1 <> ( 0 ) implies ( R1 - 1 ) >= ( 0 )))
proof
let R1 being Nat;
assume L9: R1 <> ( 0 );
L10: R1 >= 1 by L9 , NAT_1:14;
L11: ( R1 - 1 ) >= ( 1 - 1 ) by L10 , XREAL_1:9;
thus L12: thesis by L11;
end;
L13: (for R10 being Integer holds ( 1 gcd R10 ) = 1)
proof
let R10 being Integer;
thus L14: ( 1 gcd R10 ) = ( ( abs 1 ) gcd ( abs R10 ) ) by INT_2:34
.= ( 1 gcd ( abs R10 ) ) by ABSVALUE:def 1
.= 1 by NEWTON:51;
end;
theorem
L15: (for R1 being Nat holds (for R2 being Nat holds (R1 , (R2 qua Integer) are_relative_prime  iff R1 , R2 are_relative_prime )));
theorem
L16: (for R3 being Nat holds (for R9 being Integer holds (( R3 * R9 ) >= 1 implies R9 >= 1)))
proof
let R3 being Nat;
let R9 being Integer;
assume L17: ( R3 * R9 ) >= 1;
assume L18: R9 < 1;
L19: R9 <= ( 0 ) by L18 , L1;
thus L20: contradiction by L19 , L17;
end;
L21: (for R3 being Nat holds (for R10 being Integer holds ((( 1 - R3 ) <= R10 & R10 <= ( R3 - 1 ) & R3 divides R10) implies R10 = ( 0 ))))
proof
let R3 being Nat;
let R10 being Integer;
assume that
L22: ( 1 - R3 ) <= R10
and
L23: R10 <= ( R3 - 1 )
and
L24: R3 divides R10;
consider C1 being Integer such that L25: R10 = ( R3 * C1 ) by L24 , INT_1:def 3;
assume L26: R10 <> ( 0 );
L27:
now
per cases  by L26 , L25;
suppose L28: C1 > ( 0 );

reconsider D2 = C1 as (Element of ( NAT )) by L28 , INT_1:3;
L29: ( R3 * D2 ) >= R3 by L28 , NAT_1:14 , NEWTON:33;
L30: ( ( R3 * D2 ) + 1 ) > R3 by L29 , NAT_1:13;
thus L31: contradiction by L30 , L23 , L25 , XREAL_1:19;
end;
suppose L32: C1 < ( 0 );

reconsider D3 = ( C1 + 1 ) as Integer;
L33: 1 <= ( ( R3 * C1 ) + ( R3 * 1 ) ) by L22 , L25 , XREAL_1:20;
L34: 1 <= ( R3 * ( C1 + 1 ) ) by L33;
L35: D3 >= 1 by L34 , L16;
L36: ( 1 - 1 ) <= C1 by L35 , XREAL_1:20;
thus L37: contradiction by L36 , L32;
end;
end;
thus L39: contradiction by L27;
end;
theorem
L40: (for R1 being Nat holds (for R2 being Nat holds (for R3 being Nat holds ((R1 <> ( 0 ) & R2 <> ( 0 ) & R3 <> ( 0 ) & R1 , R3 are_relative_prime  & R2 , R3 are_relative_prime ) implies R3 , ( ( R1 * R2 ) mod R3 ) are_relative_prime ))))
proof
let R1 being Nat;
let R2 being Nat;
let R3 being Nat;
assume that
L41: R1 <> ( 0 )
and
L42: R2 <> ( 0 )
and
L43: R3 <> ( 0 )
and
L44: (R1 , R3 are_relative_prime  & R2 , R3 are_relative_prime );
L45: ( R1 * R2 ) , R3 are_relative_prime  by L41 , L43 , L44 , EULER_1:14;
L46: ( ( R1 * R2 ) gcd R3 ) = 1 by L45 , INT_2:def 3;
consider C2 being Nat such that L47: ( R1 * R2 ) = ( ( R3 * C2 ) + ( ( R1 * R2 ) mod R3 ) ) and L48: ( ( R1 * R2 ) mod R3 ) < R3 by L43 , NAT_D:def 2;
L49: ( R1 * R2 ) <> ( R1 * ( 0 ) ) by L41 , L42 , XCMPLX_1:5;
L50: ( ( ( R1 * R2 ) + ( ( - C2 ) * R3 ) ) gcd R3 ) = ( ( R1 * R2 ) gcd R3 ) by L49 , EULER_1:16;
thus L51: thesis by L50 , L47 , L46 , INT_2:def 3;
end;
theorem
L52: (for R1 being Nat holds (for R2 being Nat holds (for R3 being Nat holds (for R5 being Nat holds ((R3 > 1 & R3 , R5 are_relative_prime  & R5 = ( ( R1 * R2 ) mod R3 )) implies R3 , R2 are_relative_prime )))))
proof
let R1 being Nat;
let R2 being Nat;
let R3 being Nat;
let R5 being Nat;
assume that
L53: R3 > 1
and
L54: R3 , R5 are_relative_prime 
and
L55: R5 = ( ( R1 * R2 ) mod R3 );
set D4 = ( R3 gcd R2 );
L56: D4 divides R3 by NAT_D:def 5;
consider C3 being Nat such that L57: R3 = ( D4 * C3 ) by L56 , NAT_D:def 3;
L58: (D4 <> ( 0 ) & C3 <> ( 0 )) by L53 , L57;
reconsider D5 = C3 as (Element of ( NAT )) by ORDINAL1:def 12;
L59: D4 divides R2 by NAT_D:def 5;
consider C4 being Nat such that L60: R2 = ( D4 * C4 ) by L59 , NAT_D:def 3;
consider C5 being Nat such that L61: ( R1 * ( D4 * C4 ) ) = ( ( ( D4 * D5 ) * C5 ) + ( ( R1 * ( D4 * C4 ) ) mod ( D4 * D5 ) ) ) and L62: ( ( R1 * ( D4 * C4 ) ) mod ( D4 * D5 ) ) < ( D4 * D5 ) by L53 , L57 , NAT_D:def 2;
set D6 = ( ( R1 * C4 ) - ( D5 * C5 ) );
L63: ( ( R1 * ( D4 * C4 ) ) mod ( D4 * D5 ) ) = ( D4 * ( ( R1 * C4 ) - ( D5 * C5 ) ) ) by L61;
assume L64: (not R3 , R2 are_relative_prime );
L65: ( R3 gcd R2 ) <> 1 by L64 , INT_2:def 3;
L66: D4 <> ( - 1 ) by NAT_1:2;
L67: (D6 <> ( 0 ) implies ( R3 gcd R5 ) <> 1)
proof
assume L68: D6 <> ( 0 );
L69: ( R3 gcd R5 ) = ( D4 * ( D5 gcd D6 ) ) by L55 , L57 , L58 , L60 , L63 , EULER_1:15;
thus L70: thesis by L69 , L65 , L66 , INT_1:9;
end;
L71: (D6 = ( 0 ) implies ( R3 gcd R5 ) <> 1) by L53 , L55 , L57 , L60 , L63 , NEWTON:52;
thus L72: contradiction by L71 , L54 , L67 , INT_2:def 3;
end;
theorem
L73: (for R3 being Nat holds (for R5 being Nat holds ( ( R3 mod R5 ) mod R5 ) = ( R3 mod R5 )))
proof
let R3 being Nat;
let R5 being Nat;
per cases ;
suppose L74: R5 <> ( 0 );

L75: (ex B1 being Nat st (R3 = ( ( R5 * B1 ) + ( R3 mod R5 ) ) & ( R3 mod R5 ) < R5)) by L74 , NAT_D:def 2;
thus L76: thesis by L75 , NAT_D:24;
end;
suppose L77: R5 = ( 0 );

thus L78: ( ( R3 mod R5 ) mod R5 ) = ( 0 ) by L77 , NAT_D:def 2
.= ( R3 mod R5 ) by L77 , NAT_D:def 2;
end;
end;
theorem
L80: (for R3 being Nat holds (for R5 being Nat holds (for R6 being Nat holds ( ( R6 + R3 ) mod R5 ) = ( ( ( R6 mod R5 ) + ( R3 mod R5 ) ) mod R5 ))))
proof
let R3 being Nat;
let R5 being Nat;
let R6 being Nat;
thus L81: ( ( R6 + R3 ) mod R5 ) = ( ( ( R6 mod R5 ) + R3 ) mod R5 ) by NAT_D:22
.= ( ( ( R6 mod R5 ) + ( R3 mod R5 ) ) mod R5 ) by NAT_D:23;
end;
theorem
L82: (for R3 being Nat holds (for R5 being Nat holds (for R6 being Nat holds ( ( R6 * R3 ) mod R5 ) = ( ( R6 * ( R3 mod R5 ) ) mod R5 ))))
proof
let R3 being Nat;
let R5 being Nat;
let R6 being Nat;
per cases ;
suppose L83: R5 <> ( 0 );

consider C6 being Nat such that L84: R3 = ( ( R5 * C6 ) + ( R3 mod R5 ) ) and L85: ( R3 mod R5 ) < R5 by L83 , NAT_D:def 2;
L86: ( ( R6 * R3 ) mod R5 ) = ( ( ( ( R6 * C6 ) * R5 ) + ( R6 * ( R3 mod R5 ) ) ) mod R5 ) by L84;
thus L87: thesis by L86 , NAT_D:21;
end;
suppose L88: R5 = ( 0 );

thus L89: ( ( R6 * R3 ) mod R5 ) = ( 0 ) by L88 , NAT_D:def 2
.= ( ( R6 * ( R3 mod R5 ) ) mod R5 ) by L88 , NAT_D:def 2;
end;
end;
theorem
L91: (for R3 being Nat holds (for R5 being Nat holds (for R6 being Nat holds ( ( R6 * R3 ) mod R5 ) = ( ( ( R6 mod R5 ) * R3 ) mod R5 )))) by L82;
theorem
L92: (for R3 being Nat holds (for R5 being Nat holds (for R6 being Nat holds ( ( R6 * R3 ) mod R5 ) = ( ( ( R6 mod R5 ) * ( R3 mod R5 ) ) mod R5 ))))
proof
let R3 being Nat;
let R5 being Nat;
let R6 being Nat;
L93: ( ( R6 * R3 ) mod R5 ) = ( ( R6 * ( R3 mod R5 ) ) mod R5 ) by L82;
thus L94: thesis by L93 , L82;
end;
begin
definition
let R11 being (FinSequence of ( NAT ));
let R1 being Nat;
redefine func R1 * R11 -> (FinSequence of ( NAT ));

coherence
proof
L95: ( rng ( R1 * R11 ) ) c= ( NAT )
proof
let C7 being set;
assume L96: C7 in ( rng ( R1 * R11 ) );
consider C8 being set such that L97: C8 in ( dom ( R1 * R11 ) ) and L98: C7 = ( ( R1 * R11 ) . C8 ) by L96 , FUNCT_1:def 3;
reconsider D7 = C8 as (Element of ( NAT )) by L97;
L99: ( ( R1 * R11 ) . D7 ) = ( R1 * ( R11 . D7 ) ) by RVSUM_1:44;
thus L100: thesis by L99 , L98;
end;
thus L101: thesis by L95 , FINSEQ_1:def 4;
end;
end;
theorem
L103: (for B2 , B3 being (FinSequence of ( NAT )) holds (B2 , B3 are_fiberwise_equipotent  implies ( Product B2 ) = ( Product B3 )))
proof
let C9 , C10 being (FinSequence of ( NAT ));
defpred S1[ Nat ] means (for B4 , B5 being (FinSequence of ( NAT )) holds ((B4 , B5 are_fiberwise_equipotent  & ( len B4 ) = $1) implies ( Product B4 ) = ( Product B5 )));
L104: (for R5 being Nat holds (S1[ R5 ] implies S1[ ( R5 + 1 ) ]))
proof
let R5 being Nat;
assume L105: S1[ R5 ];
let C11 , C12 being (FinSequence of ( NAT ));
assume that
L106: C11 , C12 are_fiberwise_equipotent 
and
L107: ( len C11 ) = ( R5 + 1 );
reconsider D8 = ( C11 . ( R5 + 1 ) ) as (Element of ( NAT ));
L108: ( rng C11 ) = ( rng C12 ) by L106 , CLASSES1:75;
set D9 = ( C11 | R5 );
L109: C11 = ( D9 ^ <* D8 *> ) by L107 , RFINSEQ:7;
L110: ( ( 0 ) + 1 ) <= ( R5 + 1 ) by NAT_1:13;
L111: ( R5 + 1 ) in ( dom C11 ) by L110 , L107 , FINSEQ_3:25;
L112: D8 in ( rng C12 ) by L111 , L108 , FUNCT_1:def 3;
consider C13 being Nat such that L113: C13 in ( dom C12 ) and L114: ( C12 . C13 ) = D8 by L112 , FINSEQ_2:10;
reconsider D10 = C13 as (Element of ( NAT )) by ORDINAL1:def 12;
set D11 = ( C12 /^ D10 );
set D12 = ( C12 | D10 );
L115: D10 <= ( len C12 ) by L113 , FINSEQ_3:25;
L116: ( len D12 ) = D10 by L115 , FINSEQ_1:59;
L117: 1 <= D10 by L113 , FINSEQ_3:25;
L118: ( max (( 0 ) , ( D10 - 1 )) ) = ( D10 - 1 ) by L117 , FINSEQ_2:4;
reconsider D13 = ( D10 - 1 ) as (Element of ( NAT )) by L118 , FINSEQ_2:5;
L119: D10 = ( D13 + 1 );
L120: D13 <= D10 by L119 , NAT_1:11;
L121: ( Seg D13 ) c= ( Seg D10 ) by L120 , FINSEQ_1:5;
L122: D10 in ( Seg D10 ) by L117 , FINSEQ_1:1;
L123: ( D12 . D10 ) = D8 by L122 , L113 , L114 , RFINSEQ:6;
L124: D12 = ( ( D12 | D13 ) ^ <* D8 *> ) by L123 , L116 , L119 , RFINSEQ:7;
L125: C12 = ( ( C12 | D10 ) ^ ( C12 /^ D10 ) ) by RFINSEQ:8;
L126: ( D12 | D13 ) = ( D12 | ( Seg D13 ) ) by FINSEQ_1:def 15
.= ( ( C12 | ( Seg D10 ) ) | ( Seg D13 ) ) by FINSEQ_1:def 15
.= ( C12 | ( ( Seg D10 ) /\ ( Seg D13 ) ) ) by RELAT_1:71
.= ( C12 | ( Seg D13 ) ) by L121 , XBOOLE_1:28
.= ( C12 | D13 ) by FINSEQ_1:def 15;
L127:
now
let C14 being set;
L128: ( card ( Coim (C11 , C14) ) ) = ( card ( Coim (C12 , C14) ) ) by L106 , CLASSES1:def 9;
L129: ( ( card ( D9 " { C14 } ) ) + ( card ( <* D8 *> " { C14 } ) ) ) = ( card ( ( ( ( C12 | D13 ) ^ <* D8 *> ) ^ ( C12 /^ D10 ) ) " { C14 } ) ) by L128 , L125 , L124 , L126 , L109 , FINSEQ_3:57
.= ( ( card ( ( ( C12 | D13 ) ^ <* D8 *> ) " { C14 } ) ) + ( card ( ( C12 /^ D10 ) " { C14 } ) ) ) by FINSEQ_3:57
.= ( ( ( card ( ( C12 | D13 ) " { C14 } ) ) + ( card ( <* D8 *> " { C14 } ) ) ) + ( card ( ( C12 /^ D10 ) " { C14 } ) ) ) by FINSEQ_3:57
.= ( ( ( card ( ( C12 | D13 ) " { C14 } ) ) + ( card ( ( C12 /^ D10 ) " { C14 } ) ) ) + ( card ( <* D8 *> " { C14 } ) ) )
.= ( ( card ( ( ( C12 | D13 ) ^ ( C12 /^ D10 ) ) " { C14 } ) ) + ( card ( <* D8 *> " { C14 } ) ) ) by FINSEQ_3:57;
thus L130: ( card ( Coim (D9 , C14) ) ) = ( card ( Coim (( ( C12 | D13 ) ^ ( C12 /^ D10 ) ) , C14) ) ) by L129;
end;
L131: D9 , ( ( C12 | D13 ) ^ ( C12 /^ D10 ) ) are_fiberwise_equipotent  by L127 , CLASSES1:def 9;
L132: ( len D9 ) = R5 by L107 , FINSEQ_1:59 , NAT_1:11;
L133: ( Product D9 ) = ( Product ( ( C12 | D13 ) ^ D11 ) ) by L132 , L105 , L131;
thus L134: ( Product C11 ) = ( ( Product ( ( C12 | D13 ) ^ D11 ) ) * ( Product <* D8 *> ) ) by L133 , L109 , RVSUM_1:97
.= ( ( ( Product ( C12 | D13 ) ) * ( Product D11 ) ) * ( Product <* D8 *> ) ) by RVSUM_1:97
.= ( ( ( Product ( C12 | D13 ) ) * ( Product <* D8 *> ) ) * ( Product D11 ) )
.= ( ( Product D12 ) * ( Product D11 ) ) by L124 , L126 , RVSUM_1:97
.= ( Product C12 ) by L125 , RVSUM_1:97;
end;
assume L135: C9 , C10 are_fiberwise_equipotent ;
L136: ( len C9 ) = ( len C9 );
L137: S1[ ( 0 ) ]
proof
let C15 , C16 being (FinSequence of ( NAT ));
assume L138: (C15 , C16 are_fiberwise_equipotent  & ( len C15 ) = ( 0 ));
L139: (( len C16 ) = ( 0 ) & C15 = ( <*> ( NAT ) )) by L138 , RFINSEQ:3;
L140: C16 = ( <*> ( NAT ) ) by L139;
thus L141: thesis by L140 , L139;
end;
L142: (for R5 being Nat holds S1[ R5 ]) from NAT_1:sch 2(L137 , L104);
thus L143: thesis by L142 , L135 , L136;
end;
begin
definition
let C17 being (FinSequence of ( NAT ));
let C18 being Nat;
func C17 mod C18 -> (FinSequence of ( NAT )) means 
:L144: (( len it ) = ( len C17 ) & (for B6 being Nat holds (B6 in ( dom C17 ) implies ( it . B6 ) = ( ( C17 . B6 ) mod C18 ))));
existence
proof
deffunc H1(Nat) = ( ( C17 . $1 ) mod C18 );
consider C19 being FinSequence such that L145: ( len C19 ) = ( len C17 ) and L146: (for B7 being Nat holds (B7 in ( dom C19 ) implies ( C19 . B7 ) = H1(B7))) from FINSEQ_1:sch 2;
L147: ( rng C19 ) c= ( NAT )
proof
let C20 being set;
assume L148: C20 in ( rng C19 );
consider C21 being set such that L149: C21 in ( dom C19 ) and L150: C20 = ( C19 . C21 ) by L148 , FUNCT_1:def 3;
reconsider D14 = C21 as (Element of ( NAT )) by L149;
L151: ( C19 . D14 ) = ( ( C17 . D14 ) mod C18 ) by L146 , L149;
thus L152: thesis by L151 , L150;
end;
reconsider D15 = C19 as (FinSequence of ( NAT )) by L147 , FINSEQ_1:def 4;
take D15;
thus L153: ( len D15 ) = ( len C17 ) by L145;
let C22 being Nat;
assume L154: C22 in ( dom C17 );
L155: C22 in ( dom D15 ) by L154 , L145 , FINSEQ_3:29;
thus L156: thesis by L155 , L146;
end;
uniqueness
proof
let C23 , C24 being (FinSequence of ( NAT ));
assume that
L157: ( len C17 ) = ( len C23 )
and
L158: (for B8 being Nat holds (B8 in ( dom C17 ) implies ( C23 . B8 ) = ( ( C17 . B8 ) mod C18 )))
and
L159: ( len C17 ) = ( len C24 )
and
L160: (for B9 being Nat holds (B9 in ( dom C17 ) implies ( C24 . B9 ) = ( ( C17 . B9 ) mod C18 )));
L161:
now
let C25 being set;
assume that
L162: ( dom C17 ) = C25;
L163: (for B10 being Nat holds (B10 in C25 implies ( C23 . B10 ) = ( C24 . B10 )))
proof
given C26 being Nat such that
L164: C26 in C25
and
L165: ( C23 . C26 ) <> ( C24 . C26 );

L166: ( C23 . C26 ) <> ( ( C17 . C26 ) mod C18 ) by L160 , L162 , L164 , L165;
thus L167: contradiction by L166 , L158 , L162 , L164;
end;
L168: ( dom C17 ) = ( Seg ( len C17 ) ) by FINSEQ_1:def 3
.= ( dom C24 ) by L159 , FINSEQ_1:def 3;
L169: ( dom C17 ) = ( Seg ( len C17 ) ) by FINSEQ_1:def 3
.= ( dom C23 ) by L157 , FINSEQ_1:def 3;
thus L170: thesis by L169 , L162 , L168 , L163 , FINSEQ_1:13;
end;
thus L171: thesis by L161;
end;
end;
theorem
L173: (for R3 being Nat holds (for B11 being (FinSequence of ( NAT )) holds (R3 <> ( 0 ) implies ( ( Product ( B11 mod R3 ) ) mod R3 ) = ( ( Product B11 ) mod R3 ))))
proof
let R3 being Nat;
defpred S2[ Nat ] means (for B12 being (FinSequence of ( NAT )) holds ((R3 <> ( 0 ) & ( len B12 ) = $1) implies ( ( Product ( B12 mod R3 ) ) mod R3 ) = ( ( Product B12 ) mod R3 )));
let C27 being (FinSequence of ( NAT ));
assume L174: R3 <> ( 0 );
L175: ( len C27 ) is (Element of ( NAT ));
L176: (for R5 being Nat holds (S2[ R5 ] implies S2[ ( R5 + 1 ) ]))
proof
let R5 being Nat;
assume L177: S2[ R5 ];
let C28 being (FinSequence of ( NAT ));
assume that
L178: R3 <> ( 0 )
and
L179: ( len C28 ) = ( R5 + 1 );
reconsider D16 = ( C28 | R5 ) as (FinSequence of ( NAT ));
L180: ( len D16 ) = R5 by L179 , FINSEQ_1:59 , NAT_1:11;
L181: ( len ( C28 mod R3 ) ) = ( R5 + 1 ) by L179 , L144;
L182: ( len ( ( C28 mod R3 ) | R5 ) ) = R5 by L181 , FINSEQ_1:59 , NAT_1:11;
L183: R5 <= ( len C28 ) by L179 , NAT_1:11;
L184: (for B13 being Nat holds ((1 <= B13 & B13 <= ( len ( ( C28 mod R3 ) | R5 ) )) implies ( ( ( C28 mod R3 ) | R5 ) . B13 ) = ( ( D16 mod R3 ) . B13 )))
proof
let C29 being Nat;
assume that
L185: 1 <= C29
and
L186: C29 <= ( len ( ( C28 mod R3 ) | R5 ) );
L187: ( ( C28 | R5 ) . C29 ) = ( ( C28 | ( Seg R5 ) ) . C29 ) by FINSEQ_1:def 15;
L188: C29 in ( Seg R5 ) by L182 , L185 , L186 , FINSEQ_1:1;
L189: ( ( ( C28 mod R3 ) | ( Seg R5 ) ) . C29 ) = ( ( C28 mod R3 ) . C29 ) by L188 , FUNCT_1:49;
L190: C29 <= ( len C28 ) by L183 , L182 , L186 , XXREAL_0:2;
L191: C29 in ( dom C28 ) by L190 , L185 , FINSEQ_3:25;
L192: C29 in ( dom D16 ) by L180 , L182 , L185 , L186 , FINSEQ_3:25;
L193: ( ( D16 mod R3 ) . C29 ) = ( ( D16 . C29 ) mod R3 ) by L192 , L144
.= ( ( C28 . C29 ) mod R3 ) by L188 , L187 , FUNCT_1:49
.= ( ( C28 mod R3 ) . C29 ) by L191 , L144;
thus L194: thesis by L193 , L189 , FINSEQ_1:def 15;
end;
L195: ( ( 0 ) + 1 ) <= ( R5 + 1 ) by NAT_1:13;
L196: ( R5 + 1 ) in ( dom C28 ) by L195 , L179 , FINSEQ_3:25;
L197: ( ( C28 mod R3 ) . ( R5 + 1 ) ) = ( ( C28 . ( R5 + 1 ) ) mod R3 ) by L196 , L144;
L198: ( len ( ( C28 mod R3 ) | R5 ) ) = ( len ( D16 mod R3 ) ) by L180 , L182 , L144;
L199: ( ( C28 mod R3 ) | R5 ) = ( D16 mod R3 ) by L198 , L184 , FINSEQ_1:14;
L200: ( C28 mod R3 ) = ( ( D16 mod R3 ) ^ <* ( ( C28 . ( R5 + 1 ) ) mod R3 ) *> ) by L199 , L181 , L197 , RFINSEQ:7;
L201: ( ( Product ( C28 mod R3 ) ) mod R3 ) = ( ( ( Product ( D16 mod R3 ) ) * ( ( C28 . ( R5 + 1 ) ) mod R3 ) ) mod R3 ) by L200 , RVSUM_1:96
.= ( ( ( ( Product ( D16 mod R3 ) ) mod R3 ) * ( ( ( C28 . ( R5 + 1 ) ) mod R3 ) mod R3 ) ) mod R3 ) by L92
.= ( ( ( ( Product D16 ) mod R3 ) * ( ( ( C28 . ( R5 + 1 ) ) mod R3 ) mod R3 ) ) mod R3 ) by L177 , L178 , L180
.= ( ( ( ( Product D16 ) mod R3 ) * ( ( C28 . ( R5 + 1 ) ) mod R3 ) ) mod R3 ) by L73;
L202: ( ( Product C28 ) mod R3 ) = ( ( Product ( D16 ^ <* ( C28 . ( R5 + 1 ) ) *> ) ) mod R3 ) by L179 , RFINSEQ:7
.= ( ( ( Product D16 ) * ( C28 . ( R5 + 1 ) ) ) mod R3 ) by RVSUM_1:96;
thus L203: thesis by L202 , L201 , L92;
end;
L204: S2[ ( 0 ) ]
proof
let C30 being (FinSequence of ( NAT ));
assume that
L205: R3 <> ( 0 )
and
L206: ( len C30 ) = ( 0 );
L207: (C30 = ( <*> ( NAT ) ) & ( len ( C30 mod R3 ) ) = ( 0 )) by L206 , L144;
L208: ( C30 mod R3 ) = ( <*> ( NAT ) ) by L207;
thus L209: thesis by L208 , L207;
end;
L210: (for R5 being Nat holds S2[ R5 ]) from NAT_1:sch 2(L204 , L176);
thus L211: thesis by L210 , L174 , L175;
end;
theorem
L212: (for R1 being Nat holds (for R3 being Nat holds (for R5 being Nat holds ((R1 <> ( 0 ) & R3 > 1 & ( ( R1 * R5 ) mod R3 ) = ( R5 mod R3 ) & R3 , R5 are_relative_prime ) implies ( R1 mod R3 ) = 1))))
proof
let R1 being Nat;
let R3 being Nat;
let R5 being Nat;
assume that
L213: R1 <> ( 0 )
and
L214: R3 > 1
and
L215: ( ( R1 * R5 ) mod R3 ) = ( R5 mod R3 )
and
L216: R3 , R5 are_relative_prime ;
consider C31 being Nat such that L217: R5 = ( ( R3 * C31 ) + ( R5 mod R3 ) ) and L218: ( R5 mod R3 ) < R3 by L214 , NAT_D:def 2;
consider C32 being Nat such that L219: ( R1 * R5 ) = ( ( R3 * C32 ) + ( ( R1 * R5 ) mod R3 ) ) and L220: ( ( R1 * R5 ) mod R3 ) < R3 by L214 , NAT_D:def 2;
L221: ( ( R1 - 1 ) * R5 ) = ( R3 * ( C32 - C31 ) ) by L215 , L219 , L217;
L222: R3 divides ( ( R1 - 1 ) * R5 ) by L221 , INT_1:def 3;
reconsider D17 = ( R1 - 1 ) , D18 = R3 as Integer;
L223: D18 divides D17 by L216 , L222 , INT_2:25;
consider C33 being Integer such that L224: ( R1 - 1 ) = ( D18 * C33 ) by L223 , INT_1:def 3;
L225: ( R1 - 1 ) >= ( 0 ) by L213 , L8;
L226: C33 >= ( 0 ) by L225 , L214 , L224 , XREAL_1:158;
L227: R1 = ( ( D18 * C33 ) + 1 ) by L224;
reconsider D19 = C33 , D20 = D18 as (Element of ( NAT )) by L226 , INT_1:3;
L228: ( R1 mod D20 ) = ( ( ( ( D20 * D19 ) mod D20 ) + 1 ) mod D20 ) by L227 , NAT_D:22
.= ( ( ( 0 ) + 1 ) mod D20 ) by NAT_D:13
.= 1 by L214 , NAT_D:24;
thus L229: thesis by L228;
end;
theorem
L230: (for R3 being Nat holds (for R12 being (FinSequence of ( NAT )) holds ( ( R12 mod R3 ) mod R3 ) = ( R12 mod R3 )))
proof
let R3 being Nat;
let R12 being (FinSequence of ( NAT ));
L231: ( dom ( R12 mod R3 ) ) = ( Seg ( len ( R12 mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len R12 ) ) by L144
.= ( dom R12 ) by FINSEQ_1:def 3;
L232: (for B14 being set holds (B14 in ( dom R12 ) implies ( ( ( R12 mod R3 ) mod R3 ) . B14 ) = ( ( R12 mod R3 ) . B14 )))
proof
let C34 being set;
assume L233: C34 in ( dom R12 );
reconsider D21 = C34 as (Element of ( NAT )) by L233;
L234: ( ( ( R12 mod R3 ) mod R3 ) . D21 ) = ( ( ( R12 mod R3 ) . D21 ) mod R3 ) by L231 , L233 , L144
.= ( ( ( R12 . D21 ) mod R3 ) mod R3 ) by L233 , L144
.= ( ( R12 . D21 ) mod R3 ) by L73
.= ( ( R12 mod R3 ) . D21 ) by L233 , L144;
thus L235: thesis by L234;
end;
L236: ( dom ( ( R12 mod R3 ) mod R3 ) ) = ( Seg ( len ( ( R12 mod R3 ) mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( R12 mod R3 ) ) ) by L144
.= ( Seg ( len R12 ) ) by L144
.= ( dom R12 ) by FINSEQ_1:def 3;
thus L237: thesis by L236 , L231 , L232 , FUNCT_1:2;
end;
theorem
L238: (for R1 being Nat holds (for R3 being Nat holds (for R12 being (FinSequence of ( NAT )) holds ( ( R1 * ( R12 mod R3 ) ) mod R3 ) = ( ( R1 * R12 ) mod R3 ))))
proof
let R1 being Nat;
let R3 being Nat;
let R12 being (FinSequence of ( NAT ));
L239: ( dom ( R1 * R12 ) ) = ( Seg ( len ( R1 * R12 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len R12 ) ) by NEWTON:2
.= ( dom R12 ) by FINSEQ_1:def 3;
L240: ( dom ( R1 * ( R12 mod R3 ) ) ) = ( Seg ( len ( R1 * ( R12 mod R3 ) ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( R12 mod R3 ) ) ) by NEWTON:2
.= ( Seg ( len R12 ) ) by L144
.= ( dom R12 ) by FINSEQ_1:def 3;
L241: (for B15 being set holds (B15 in ( dom R12 ) implies ( ( ( R1 * ( R12 mod R3 ) ) mod R3 ) . B15 ) = ( ( ( R1 * R12 ) mod R3 ) . B15 )))
proof
let C35 being set;
assume L242: C35 in ( dom R12 );
reconsider D22 = C35 as (Element of ( NAT )) by L242;
L243: ( ( ( R1 * ( R12 mod R3 ) ) mod R3 ) . D22 ) = ( ( ( R1 * ( R12 mod R3 ) ) . D22 ) mod R3 ) by L240 , L242 , L144
.= ( ( R1 * ( ( R12 mod R3 ) . D22 ) ) mod R3 ) by RVSUM_1:44
.= ( ( R1 * ( ( R12 . D22 ) mod R3 ) ) mod R3 ) by L242 , L144
.= ( ( R1 * ( R12 . D22 ) ) mod R3 ) by L82
.= ( ( ( R1 * R12 ) . D22 ) mod R3 ) by RVSUM_1:44
.= ( ( ( R1 * R12 ) mod R3 ) . D22 ) by L239 , L242 , L144;
thus L244: thesis by L243;
end;
L245: ( dom ( ( R1 * R12 ) mod R3 ) ) = ( Seg ( len ( ( R1 * R12 ) mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( R1 * R12 ) ) ) by L144
.= ( Seg ( len R12 ) ) by NEWTON:2
.= ( dom R12 ) by FINSEQ_1:def 3;
L246: ( dom ( ( R1 * ( R12 mod R3 ) ) mod R3 ) ) = ( Seg ( len ( ( R1 * ( R12 mod R3 ) ) mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( R1 * ( R12 mod R3 ) ) ) ) by L144
.= ( Seg ( len ( R12 mod R3 ) ) ) by NEWTON:2
.= ( Seg ( len R12 ) ) by L144
.= ( dom R12 ) by FINSEQ_1:def 3;
thus L247: thesis by L246 , L245 , L241 , FUNCT_1:2;
end;
theorem
L248: (for R3 being Nat holds (for B16 , B17 being (FinSequence of ( NAT )) holds ( ( B16 ^ B17 ) mod R3 ) = ( ( B16 mod R3 ) ^ ( B17 mod R3 ) )))
proof
let R3 being Nat;
let C36 , C37 being (FinSequence of ( NAT ));
L249: ( dom ( ( C36 ^ C37 ) mod R3 ) ) = ( Seg ( len ( ( C36 ^ C37 ) mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( C36 ^ C37 ) ) ) by L144
.= ( dom ( C36 ^ C37 ) ) by FINSEQ_1:def 3;
L250: ( dom ( C37 mod R3 ) ) = ( Seg ( len ( C37 mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len C37 ) ) by L144
.= ( dom C37 ) by FINSEQ_1:def 3;
L251: ( dom ( C36 mod R3 ) ) = ( Seg ( len ( C36 mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len C36 ) ) by L144
.= ( dom C36 ) by FINSEQ_1:def 3;
L252: (for B18 being set holds (B18 in ( dom ( C36 ^ C37 ) ) implies ( ( ( C36 ^ C37 ) mod R3 ) . B18 ) = ( ( ( C36 mod R3 ) ^ ( C37 mod R3 ) ) . B18 )))
proof
let C38 being set;
assume L253: C38 in ( dom ( C36 ^ C37 ) );
reconsider D23 = C38 as (Element of ( NAT )) by L253;
L254:
now
per cases  by L253 , FINSEQ_1:25;
suppose L255: D23 in ( dom C36 );

L256: ( ( ( C36 ^ C37 ) mod R3 ) . D23 ) = ( ( ( C36 ^ C37 ) . D23 ) mod R3 ) by L253 , L144
.= ( ( C36 . D23 ) mod R3 ) by L255 , FINSEQ_1:def 7;
L257: ( ( ( C36 mod R3 ) ^ ( C37 mod R3 ) ) . D23 ) = ( ( C36 mod R3 ) . D23 ) by L251 , L255 , FINSEQ_1:def 7
.= ( ( C36 . D23 ) mod R3 ) by L255 , L144;
thus L258: ( ( ( C36 ^ C37 ) mod R3 ) . D23 ) = ( ( ( C36 mod R3 ) ^ ( C37 mod R3 ) ) . D23 ) by L257 , L256;
end;
suppose L259: (ex B19 being Nat st (B19 in ( dom C37 ) & D23 = ( ( len C36 ) + B19 )));

consider C39 being (Element of ( NAT )) such that L260: C39 in ( dom C37 ) and L261: D23 = ( ( len C36 ) + C39 ) by L259;
L262: ( ( ( C36 ^ C37 ) mod R3 ) . D23 ) = ( ( ( C36 ^ C37 ) . D23 ) mod R3 ) by L253 , L144
.= ( ( C37 . C39 ) mod R3 ) by L260 , L261 , FINSEQ_1:def 7;
L263: ( len ( C36 mod R3 ) ) = ( len C36 ) by L144;
L264: ( ( ( C36 mod R3 ) ^ ( C37 mod R3 ) ) . D23 ) = ( ( C37 mod R3 ) . C39 ) by L263 , L250 , L260 , L261 , FINSEQ_1:def 7
.= ( ( C37 . C39 ) mod R3 ) by L260 , L144;
thus L265: ( ( ( C36 ^ C37 ) mod R3 ) . D23 ) = ( ( ( C36 mod R3 ) ^ ( C37 mod R3 ) ) . D23 ) by L264 , L262;
end;
end;
thus L267: thesis by L254;
end;
L268: ( dom ( ( C36 mod R3 ) ^ ( C37 mod R3 ) ) ) = ( Seg ( len ( ( C36 mod R3 ) ^ ( C37 mod R3 ) ) ) ) by FINSEQ_1:def 3
.= ( Seg ( ( len ( C36 mod R3 ) ) + ( len ( C37 mod R3 ) ) ) ) by FINSEQ_1:22
.= ( Seg ( ( len C36 ) + ( len ( C37 mod R3 ) ) ) ) by L144
.= ( Seg ( ( len C36 ) + ( len C37 ) ) ) by L144
.= ( Seg ( len ( C36 ^ C37 ) ) ) by FINSEQ_1:22
.= ( dom ( C36 ^ C37 ) ) by FINSEQ_1:def 3;
thus L269: thesis by L268 , L249 , L252 , FUNCT_1:2;
end;
theorem
L270: (for R1 being Nat holds (for R3 being Nat holds (for B20 , B21 being (FinSequence of ( NAT )) holds ( ( R1 * ( B20 ^ B21 ) ) mod R3 ) = ( ( ( R1 * B20 ) mod R3 ) ^ ( ( R1 * B21 ) mod R3 ) ))))
proof
let R1 being Nat;
let R3 being Nat;
let C40 , C41 being (FinSequence of ( NAT ));
reconsider D24 = ( C40 ^ C41 ) as (FinSequence of ( NAT ));
L271: ( dom ( R1 * ( C40 ^ C41 ) ) ) = ( Seg ( len ( R1 * D24 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len D24 ) ) by NEWTON:2
.= ( dom ( C40 ^ C41 ) ) by FINSEQ_1:def 3;
L272: ( dom ( R1 * C41 ) ) = ( Seg ( len ( R1 * C41 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len C41 ) ) by NEWTON:2
.= ( dom C41 ) by FINSEQ_1:def 3;
L273: ( dom ( ( R1 * C41 ) mod R3 ) ) = ( Seg ( len ( ( R1 * C41 ) mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( R1 * C41 ) ) ) by L144
.= ( Seg ( len C41 ) ) by NEWTON:2
.= ( dom C41 ) by FINSEQ_1:def 3;
L274: ( dom ( R1 * C40 ) ) = ( Seg ( len ( R1 * C40 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len C40 ) ) by NEWTON:2
.= ( dom C40 ) by FINSEQ_1:def 3;
L275: ( dom ( ( R1 * C40 ) mod R3 ) ) = ( Seg ( len ( ( R1 * C40 ) mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( R1 * C40 ) ) ) by L144
.= ( Seg ( len C40 ) ) by NEWTON:2
.= ( dom C40 ) by FINSEQ_1:def 3;
L276: (for B22 being set holds (B22 in ( dom ( C40 ^ C41 ) ) implies ( ( ( R1 * ( C40 ^ C41 ) ) mod R3 ) . B22 ) = ( ( ( ( R1 * C40 ) mod R3 ) ^ ( ( R1 * C41 ) mod R3 ) ) . B22 )))
proof
reconsider D25 = ( C40 ^ C41 ) as (FinSequence of ( NAT ));
let C42 being set;
assume L277: C42 in ( dom ( C40 ^ C41 ) );
reconsider D26 = C42 as (Element of ( NAT )) by L277;
L278:
now
per cases  by L277 , FINSEQ_1:25;
suppose L279: D26 in ( dom C40 );

L280: ( ( ( R1 * ( C40 ^ C41 ) ) mod R3 ) . D26 ) = ( ( ( R1 * ( C40 ^ C41 ) ) . D26 ) mod R3 ) by L271 , L277 , L144
.= ( ( R1 * ( D25 . D26 ) ) mod R3 ) by RVSUM_1:44
.= ( ( R1 * ( C40 . D26 ) ) mod R3 ) by L279 , FINSEQ_1:def 7;
L281: ( ( ( ( R1 * C40 ) mod R3 ) ^ ( ( R1 * C41 ) mod R3 ) ) . D26 ) = ( ( ( R1 * C40 ) mod R3 ) . D26 ) by L275 , L279 , FINSEQ_1:def 7
.= ( ( ( R1 * C40 ) . D26 ) mod R3 ) by L274 , L279 , L144
.= ( ( R1 * ( C40 . D26 ) ) mod R3 ) by RVSUM_1:44;
thus L282: ( ( ( R1 * ( C40 ^ C41 ) ) mod R3 ) . D26 ) = ( ( ( ( R1 * C40 ) mod R3 ) ^ ( ( R1 * C41 ) mod R3 ) ) . D26 ) by L281 , L280;
end;
suppose L283: (ex B23 being Nat st (B23 in ( dom C41 ) & D26 = ( ( len C40 ) + B23 )));

consider C43 being (Element of ( NAT )) such that L284: C43 in ( dom C41 ) and L285: D26 = ( ( len C40 ) + C43 ) by L283;
L286: ( ( ( R1 * ( C40 ^ C41 ) ) mod R3 ) . D26 ) = ( ( ( R1 * ( C40 ^ C41 ) ) . D26 ) mod R3 ) by L271 , L277 , L144
.= ( ( R1 * ( D25 . D26 ) ) mod R3 ) by RVSUM_1:44
.= ( ( R1 * ( C41 . C43 ) ) mod R3 ) by L284 , L285 , FINSEQ_1:def 7;
L287: ( len ( ( R1 * C40 ) mod R3 ) ) = ( len ( R1 * C40 ) ) by L144
.= ( len C40 ) by NEWTON:2;
L288: ( ( ( ( R1 * C40 ) mod R3 ) ^ ( ( R1 * C41 ) mod R3 ) ) . D26 ) = ( ( ( R1 * C41 ) mod R3 ) . C43 ) by L287 , L273 , L284 , L285 , FINSEQ_1:def 7
.= ( ( ( R1 * C41 ) . C43 ) mod R3 ) by L272 , L284 , L144
.= ( ( R1 * ( C41 . C43 ) ) mod R3 ) by RVSUM_1:44;
thus L289: ( ( ( R1 * ( C40 ^ C41 ) ) mod R3 ) . D26 ) = ( ( ( ( R1 * C40 ) mod R3 ) ^ ( ( R1 * C41 ) mod R3 ) ) . D26 ) by L288 , L286;
end;
end;
thus L291: thesis by L278;
end;
L292: ( dom ( ( R1 * ( C40 ^ C41 ) ) mod R3 ) ) = ( Seg ( len ( ( R1 * D24 ) mod R3 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( R1 * D24 ) ) ) by L144
.= ( Seg ( len D24 ) ) by NEWTON:2
.= ( dom ( C40 ^ C41 ) ) by FINSEQ_1:def 3;
L293: ( dom ( ( ( R1 * C40 ) mod R3 ) ^ ( ( R1 * C41 ) mod R3 ) ) ) = ( Seg ( len ( ( ( R1 * C40 ) mod R3 ) ^ ( ( R1 * C41 ) mod R3 ) ) ) ) by FINSEQ_1:def 3
.= ( Seg ( ( len ( ( R1 * C40 ) mod R3 ) ) + ( len ( ( R1 * C41 ) mod R3 ) ) ) ) by FINSEQ_1:22
.= ( Seg ( ( len ( R1 * C40 ) ) + ( len ( ( R1 * C41 ) mod R3 ) ) ) ) by L144
.= ( Seg ( ( len ( R1 * C40 ) ) + ( len ( R1 * C41 ) ) ) ) by L144
.= ( Seg ( ( len C40 ) + ( len ( R1 * C41 ) ) ) ) by NEWTON:2
.= ( Seg ( ( len C40 ) + ( len C41 ) ) ) by NEWTON:2
.= ( Seg ( len ( C40 ^ C41 ) ) ) by FINSEQ_1:22
.= ( dom ( C40 ^ C41 ) ) by FINSEQ_1:def 3;
thus L294: thesis by L293 , L292 , L276 , FUNCT_1:2;
end;
theorem
L295: (for R1 being Nat holds (for R3 being Nat holds ((R1 <> ( 0 ) & R3 <> ( 0 ) & R1 , R3 are_relative_prime ) implies (for R2 being Nat holds ( R1 |^ R2 ) , R3 are_relative_prime ))))
proof
let R1 being Nat;
let R3 being Nat;
defpred S3[ Nat ] means ( R1 |^ $1 ) , R3 are_relative_prime ;
assume L296: (R1 <> ( 0 ) & R3 <> ( 0 ) & R1 , R3 are_relative_prime );
L297: (for R2 being Nat holds (S3[ R2 ] implies S3[ ( R2 + 1 ) ]))
proof
let R2 being Nat;
L298: ( R1 |^ ( R2 + 1 ) ) = ( ( R1 |^ R2 ) * ( R1 |^ 1 ) ) by NEWTON:8
.= ( ( R1 |^ R2 ) * R1 ) by NEWTON:5;
assume L299: ( R1 |^ R2 ) , R3 are_relative_prime ;
thus L300: thesis by L299 , L296 , L298 , EULER_1:14;
end;
L301: (( ( R1 |^ ( 0 ) ) gcd R3 ) = ( 1 gcd R3 ) & ( R3 gcd 1 ) = 1) by NEWTON:4 , NEWTON:51;
L302: S3[ ( 0 ) ] by L301 , INT_2:def 3;
L303: (for R2 being Nat holds S3[ R2 ]) from NAT_1:sch 2(L302 , L297);
thus L304: thesis by L303;
end;
begin
::$N Euler's Generalization of Fermat's Little Theorem
theorem
L305: (for R1 being Nat holds (for R3 being Nat holds ((R1 <> ( 0 ) & R3 > 1 & R1 , R3 are_relative_prime ) implies ( ( R1 |^ ( Euler R3 ) ) mod R3 ) = 1)))
proof
let R1 being Nat;
let R3 being Nat;
assume that
L306: R1 <> ( 0 )
and
L307: R3 > 1
and
L308: R1 , R3 are_relative_prime ;
set D27 = { B24 where B24 is (Element of ( NAT )) : (R3 , B24 are_relative_prime  & B24 >= 1 & B24 <= R3) };
L309: ( R1 |^ ( Euler R3 ) ) <> ( 0 ) by L306 , PREPOWER:5;
set D28 = { B25 where B25 is (Element of ( NAT )) : (ex B26 being (Element of ( NAT )) st (B25 = ( ( R1 * B26 ) mod R3 ) & B26 in D27)) };
L310: (for R4 being Nat holds (R4 in D27 implies ( ( R1 * R4 ) mod R3 ) in D27))
proof
let R4 being Nat;
assume L311: R4 in D27;
consider C44 being (Element of ( NAT )) such that L312: C44 = R4 and L313: R3 , C44 are_relative_prime  and L314: C44 >= 1 and L315: C44 <= R3 by L311;
L316: ( R1 * C44 ) , R3 are_relative_prime  by L306 , L307 , L308 , L313 , EULER_1:14;
L317: ( ( R1 * C44 ) mod R3 ) <> ( 0 )
proof
assume L318: ( ( R1 * C44 ) mod R3 ) = ( 0 );
consider C45 being Nat such that L319: ( R1 * C44 ) = ( ( R3 * C45 ) + ( 0 ) ) and L320: ( 0 ) < R3 by L318 , L307 , NAT_D:def 2;
L321: ( C45 gcd 1 ) = 1 by NEWTON:51;
L322: ( ( R3 * C45 ) gcd ( R3 * 1 ) ) = R3 by L321 , EULER_1:5;
thus L323: contradiction by L322 , L307 , L316 , L319 , INT_2:def 3;
end;
L324: ( ( R1 * C44 ) mod R3 ) >= 1 by L317 , NAT_1:14;
L325: ( ( R1 * C44 ) mod R3 ) <= R3 by L307 , NAT_D:1;
L326: R3 , ( ( R1 * C44 ) mod R3 ) are_relative_prime  by L306 , L307 , L308 , L313 , L314 , L40;
thus L327: thesis by L326 , L312 , L324 , L325;
end;
L328: D27 = D28
proof
thus L329: D27 c= D28
proof
let C46 being set;
assume L330: C46 in D27;
consider C47 being (Element of ( NAT )) such that L331: C46 = C47 and L332: R3 , C47 are_relative_prime  and L333: C47 >= 1 and L334: C47 <= R3 by L330;
consider C48 , C49 being Integer such that L335: ( ( C48 * R1 ) + ( C49 * R3 ) ) = C47 by L308 , EULER_1:10;
L336: C47 <> R3 by L307 , L332 , EULER_1:1;
L337: C47 < R3 by L336 , L334 , XXREAL_0:1;
L338: ( C47 mod R3 ) = C47 by L337 , NAT_D:24;
reconsider D29 = ( C48 mod R3 ) as (Element of ( NAT )) by INT_1:3 , NEWTON:64;
L339: ( C48 mod R3 ) <> ( 0 )
proof
assume L340: ( C48 mod R3 ) = ( 0 );
L341: ( 0 ) = ( C48 - ( ( C48 div R3 ) * R3 ) ) by L340 , L307 , INT_1:def 10;
L342: ( R3 gcd C47 ) = ( ( R3 * 1 ) gcd ( R3 * ( ( ( C48 div R3 ) * R1 ) + C49 ) ) ) by L341 , L335
.= ( R3 * ( 1 gcd ( ( ( C48 div R3 ) * R1 ) + C49 ) ) ) by L307 , EULER_1:15
.= ( R3 * 1 ) by L13
.= R3;
thus L343: contradiction by L342 , L307 , L332 , INT_2:def 3;
end;
L344: D29 >= 1 by L339 , NAT_1:14;
L345: C48 = ( ( ( C48 div R3 ) * R3 ) + ( C48 mod R3 ) ) by L307 , NEWTON:66;
reconsider D30 = ( ( ( C48 mod R3 ) * R1 ) + ( ( ( ( C48 div R3 ) * R1 ) + C49 ) * R3 ) ) as (Element of ( NAT )) by L345 , L335;
L346: D29 <= R3 by L307 , NEWTON:65;
L347: ( D30 mod R3 ) = ( ( D29 * R1 ) mod R3 ) by EULER_1:12;
L348: R3 , D29 are_relative_prime  by L347 , L307 , L332 , L338 , L335 , L345 , L52;
L349: D29 in D27 by L348 , L344 , L346;
thus L350: thesis by L349 , L331 , L338 , L335 , L345 , L347;
end;

let C50 being set;
assume L351: C50 in D28;
L352: (ex B27 being (Element of ( NAT )) st (C50 = B27 & (ex B28 being (Element of ( NAT )) st (B27 = ( ( R1 * B28 ) mod R3 ) & B28 in D27)))) by L351;
thus L353: thesis by L352 , L310;
end;
L354: (for R7 being Nat holds (for R8 being Nat holds ((R7 in D27 & R8 in D27 & R7 <> R8) implies ( ( R1 * R7 ) mod R3 ) <> ( ( R1 * R8 ) mod R3 ))))
proof
let R7 being Nat;
let R8 being Nat;
assume that
L355: R7 in D27
and
L356: R8 in D27
and
L357: R7 <> R8;
set D31 = ( ( R1 * R7 ) mod R3 );
set D32 = ( ( R1 * R8 ) mod R3 );
assume L358: ( ( R1 * R7 ) mod R3 ) = ( ( R1 * R8 ) mod R3 );
consider C51 being (Element of ( NAT )) such that L359: C51 = R8 and L360: R3 , C51 are_relative_prime  and L361: (C51 >= 1 & C51 <= R3) by L356;
L362: D32 = ( ( R1 * C51 ) - ( R3 * ( ( R1 * C51 ) div R3 ) ) ) by L307 , L359 , NEWTON:63;
consider C52 being (Element of ( NAT )) such that L363: C52 = R7 and L364: R3 , C52 are_relative_prime  and L365: (C52 >= 1 & C52 <= R3) by L355;
L366: D31 = ( ( R1 * C52 ) - ( R3 * ( ( R1 * C52 ) div R3 ) ) ) by L307 , L363 , NEWTON:63;
L367: ( 0 ) = ( ( R1 * ( C52 - C51 ) ) - ( R3 * ( ( ( R1 * C52 ) div R3 ) - ( ( R1 * C51 ) div R3 ) ) ) ) by L366 , L358 , L362;
L368: R3 divides ( R1 * ( C52 - C51 ) ) by L367 , INT_1:def 3;
reconsider D33 = R3 , D34 = ( C52 - C51 ) as Integer;
L369: (( 1 - D33 ) <= D34 & D34 <= ( D33 - 1 )) by L365 , L361 , XREAL_1:13;
L370: ( C52 - C51 ) = ( 0 ) by L369 , L308 , L368 , L21 , INT_2:25;
thus L371: contradiction by L370 , L357 , L363 , L359;
end;
reconsider D35 = ( Sgm D27 ) as (FinSequence of ( NAT ));
reconsider D36 = ( R1 * D35 ) as (FinSequence of ( NAT ));
reconsider D37 = ( D36 mod R3 ) as (FinSequence of ( NAT ));
L372: D27 c= ( Seg R3 )
proof
let C53 being set;
assume L373: C53 in D27;
L374: (ex B29 being (Element of ( NAT )) st (C53 = B29 & R3 , B29 are_relative_prime  & B29 >= 1 & B29 <= R3)) by L373;
thus L375: thesis by L374 , FINSEQ_1:1;
end;
reconsider D38 = D27 as  finite set by L372;
L376: ( dom D36 ) = ( Seg ( len D36 ) ) by FINSEQ_1:def 3
.= ( Seg ( len D35 ) ) by NEWTON:2;
L377: ( dom D35 ) = ( dom D36 ) by L376 , FINSEQ_1:def 3;
L378: ( dom D37 ) = ( Seg ( len D37 ) ) by FINSEQ_1:def 3
.= ( Seg ( len D36 ) ) by L144
.= ( Seg ( len D35 ) ) by NEWTON:2;
L379: ( dom D35 ) = ( dom D37 ) by L378 , FINSEQ_1:def 3;
L380: ( rng D37 ) = D28
proof
thus L381: ( rng D37 ) c= D28
proof
let C54 being set;
assume L382: C54 in ( rng D37 );
consider C55 being set such that L383: C55 in ( dom D37 ) and L384: C54 = ( D37 . C55 ) by L382 , FUNCT_1:def 3;
reconsider D39 = C55 as (Element of ( NAT )) by L383;
L385: ( D35 . D39 ) in ( rng D35 ) by L379 , L383 , FUNCT_1:def 3;
L386: ( D35 . D39 ) in D38 by L385 , L372 , FINSEQ_1:def 13;
L387: D39 in ( dom D35 ) by L378 , L383 , FINSEQ_1:def 3;
L388: ( D37 . D39 ) = ( ( D36 . D39 ) mod R3 ) by L387 , L377 , L144
.= ( ( R1 * ( D35 . D39 ) ) mod R3 ) by RVSUM_1:44;
thus L389: thesis by L388 , L384 , L386;
end;

let C56 being set;
assume L390: C56 in D28;
consider C57 being (Element of ( NAT )) such that L391: C56 = C57 and L392: (ex B30 being (Element of ( NAT )) st (C57 = ( ( R1 * B30 ) mod R3 ) & B30 in D38)) by L390;
consider C58 being (Element of ( NAT )) such that L393: C57 = ( ( R1 * C58 ) mod R3 ) and L394: C58 in D38 by L392;
L395: C58 in ( rng D35 ) by L372 , L394 , FINSEQ_1:def 13;
consider C59 being set such that L396: C59 in ( dom D35 ) and L397: C58 = ( D35 . C59 ) by L395 , FUNCT_1:def 3;
reconsider D40 = C59 as (Element of ( NAT )) by L396;
L398: ( D37 . D40 ) = ( ( D36 . D40 ) mod R3 ) by L377 , L396 , L144
.= C56 by L391 , L393 , L397 , RVSUM_1:44;
thus L399: thesis by L398 , L379 , L396 , FUNCT_1:def 3;
end;
L400: D37 is  one-to-one
proof
L401: D35 is  one-to-one by L372 , FINSEQ_3:92;
let C60 , C61 being set;
assume that
L402: C60 in ( dom D37 )
and
L403: C61 in ( dom D37 )
and
L404: ( D37 . C60 ) = ( D37 . C61 );
L405: C61 in ( dom D35 ) by L378 , L403 , FINSEQ_1:def 3;
reconsider D41 = C61 as (Element of ( NAT )) by L403;
L406: C60 in ( dom D35 ) by L378 , L402 , FINSEQ_1:def 3;
reconsider D42 = C60 as (Element of ( NAT )) by L402;
L407: (( D35 . D42 ) in ( rng D35 ) & ( D35 . D41 ) in ( rng D35 )) by L379 , L402 , L403 , FUNCT_1:def 3;
L408: ( D37 . D41 ) = ( ( D36 . D41 ) mod R3 ) by L377 , L405 , L144
.= ( ( R1 * ( D35 . D41 ) ) mod R3 ) by RVSUM_1:44;
L409: ( D37 . D42 ) = ( ( D36 . D42 ) mod R3 ) by L377 , L406 , L144
.= ( ( R1 * ( D35 . D42 ) ) mod R3 ) by RVSUM_1:44;
L410: (not (( D35 . D42 ) in D38 & ( D35 . D41 ) in D38 & ( D35 . D42 ) <> ( D35 . D41 ))) by L409 , L354 , L404 , L408;
thus L411: thesis by L410 , L372 , L406 , L405 , L407 , L401 , FINSEQ_1:def 13 , FUNCT_1:def 4;
end;
L412: (for B31 being set holds ( card ( Coim (D35 , B31) ) ) = ( card ( Coim (D37 , B31) ) ))
proof
let C62 being set;
L413:
now
per cases ;
suppose L414: C62 in D38;

L415: D35 is  one-to-one by L372 , FINSEQ_3:92;
L416: C62 in ( rng D35 ) by L372 , L414 , FINSEQ_1:def 13;
L417: ( len ( D35 - { C62 } ) ) = ( ( len D35 ) - 1 ) by L416 , L415 , FINSEQ_3:90;
L418: (( ( len ( D35 - { C62 } ) ) - ( len ( D35 - { C62 } ) ) ) = ( ( ( len D35 ) - ( card ( D35 " { C62 } ) ) ) - ( len ( D35 - { C62 } ) ) ) & ( len ( D37 - { C62 } ) ) = ( ( len D37 ) - ( card ( D37 " { C62 } ) ) )) by FINSEQ_3:59;
L419: ( len ( D37 - { C62 } ) ) = ( ( len D37 ) - 1 ) by L328 , L380 , L400 , L414 , FINSEQ_3:90;
thus L420: thesis by L419 , L417 , L418;
end;
suppose L421: (not C62 in D38);

L422: ((not C62 in ( rng D35 )) & ( D37 " { C62 } ) = ( {} )) by L421 , L328 , L372 , L380 , FINSEQ_1:def 13 , FUNCT_1:72;
thus L423: thesis by L422 , FUNCT_1:72;
end;
end;
thus L425: thesis by L413;
end;
L426: D35 , D37 are_fiberwise_equipotent  by L412 , CLASSES1:def 9;
L427: ( len D35 ) = ( len D37 ) by L426 , RFINSEQ:3;
L428: ( ( Product D37 ) mod R3 ) = ( ( ( R1 |^ ( len D37 ) ) * ( Product D35 ) ) mod R3 )
proof
defpred S4[ Nat ] means ($1 <= ( len D37 ) implies ( ( Product ( D37 | $1 ) ) mod R3 ) = ( ( ( R1 |^ ( len ( D37 | $1 ) ) ) * ( Product ( D35 | $1 ) ) ) mod R3 ));
L429: ( D37 | ( len D37 ) ) = ( D37 | ( Seg ( len D37 ) ) ) by FINSEQ_1:def 15;
L430: D37 = ( D37 | ( len D37 ) ) by L429 , FINSEQ_2:20;
L431: (for R5 being Nat holds (S4[ R5 ] implies S4[ ( R5 + 1 ) ]))
proof
let R5 being Nat;
L432:
now
per cases ;
suppose L433: ( R5 + 1 ) <= ( len D37 );

L434: ( len ( D35 | ( R5 + 1 ) ) ) = ( R5 + 1 ) by L433 , L427 , FINSEQ_1:59;
L435: ( D35 | ( R5 + 1 ) ) = ( ( ( D35 | ( R5 + 1 ) ) | R5 ) ^ <* ( ( D35 | ( R5 + 1 ) ) . ( R5 + 1 ) ) *> ) by L434 , RFINSEQ:7;
assume L436: S4[ R5 ];
L437: ( ( 0 ) + 1 ) <= ( R5 + 1 ) by NAT_1:13;
L438: ( R5 + 1 ) in ( dom D37 ) by L437 , L433 , FINSEQ_3:25;
L439: ( ( D37 | ( R5 + 1 ) ) . ( R5 + 1 ) ) = ( D37 . ( R5 + 1 ) ) by FINSEQ_3:112;
L440: ( ( D35 | ( R5 + 1 ) ) . ( R5 + 1 ) ) = ( D35 . ( R5 + 1 ) ) by FINSEQ_3:112;
L441: R5 <= ( R5 + 1 ) by NAT_1:11;
L442: ( len ( D37 | R5 ) ) = R5 by L441 , L433 , FINSEQ_1:59 , XXREAL_0:2;
L443: ( ( D35 | ( R5 + 1 ) ) | R5 ) = ( D35 | R5 ) by L441 , FINSEQ_5:77;
L444: ( ( D37 | ( R5 + 1 ) ) | R5 ) = ( D37 | R5 ) by L441 , FINSEQ_5:77;
L445: ( len ( D37 | ( R5 + 1 ) ) ) = ( R5 + 1 ) by L433 , FINSEQ_1:59;
L446: ( D37 | ( R5 + 1 ) ) = ( ( ( D37 | ( R5 + 1 ) ) | R5 ) ^ <* ( ( D37 | ( R5 + 1 ) ) . ( R5 + 1 ) ) *> ) by L445 , RFINSEQ:7;
L447: ( ( Product ( D37 | ( R5 + 1 ) ) ) mod R3 ) = ( ( ( Product ( D37 | R5 ) ) * ( D37 . ( R5 + 1 ) ) ) mod R3 ) by L446 , L444 , L439 , RVSUM_1:96
.= ( ( ( ( ( R1 |^ ( len ( D37 | R5 ) ) ) * ( Product ( D35 | R5 ) ) ) mod R3 ) * ( ( D37 . ( R5 + 1 ) ) mod R3 ) ) mod R3 ) by L433 , L436 , L441 , L92 , XXREAL_0:2
.= ( ( ( ( ( R1 |^ ( len ( D37 | R5 ) ) ) * ( Product ( D35 | R5 ) ) ) mod R3 ) * ( ( ( D36 . ( R5 + 1 ) ) mod R3 ) mod R3 ) ) mod R3 ) by L379 , L377 , L438 , L144
.= ( ( ( ( ( R1 |^ ( len ( D37 | R5 ) ) ) * ( Product ( D35 | R5 ) ) ) mod R3 ) * ( ( ( R1 * D35 ) . ( R5 + 1 ) ) mod R3 ) ) mod R3 ) by L73
.= ( ( ( ( R1 |^ ( len ( D37 | R5 ) ) ) * ( Product ( D35 | R5 ) ) ) * ( ( R1 * D35 ) . ( R5 + 1 ) ) ) mod R3 ) by L92
.= ( ( ( ( R1 |^ R5 ) * ( Product ( D35 | R5 ) ) ) * ( R1 * ( D35 . ( R5 + 1 ) ) ) ) mod R3 ) by L442 , RVSUM_1:44
.= ( ( ( ( R1 |^ R5 ) * R1 ) * ( ( Product ( D35 | R5 ) ) * ( D35 . ( R5 + 1 ) ) ) ) mod R3 )
.= ( ( ( R1 |^ ( len ( D37 | ( R5 + 1 ) ) ) ) * ( ( Product ( D35 | R5 ) ) * ( D35 . ( R5 + 1 ) ) ) ) mod R3 ) by L445 , NEWTON:6
.= ( ( ( R1 |^ ( len ( D37 | ( R5 + 1 ) ) ) ) * ( Product ( D35 | ( R5 + 1 ) ) ) ) mod R3 ) by L435 , L443 , L440 , RVSUM_1:96;
thus L448: S4[ ( R5 + 1 ) ] by L447;
end;
suppose L449: ( R5 + 1 ) > ( len D37 );

thus L450: thesis by L449;
end;
end;
thus L452: thesis by L432;
end;
L453: ( D35 | ( len D35 ) ) = ( D35 | ( Seg ( len D35 ) ) ) by FINSEQ_1:def 15;
L454: D35 = ( D35 | ( len D37 ) ) by L453 , L427 , FINSEQ_2:20;
L455: S4[ ( 0 ) ] by NEWTON:4 , RVSUM_1:94;
L456: (for R5 being Nat holds S4[ R5 ]) from NAT_1:sch 2(L455 , L431);
thus L457: thesis by L456 , L430 , L454;
end;
L458: ( Product D35 ) , R3 are_relative_prime 
proof
defpred S5[ Nat ] means ($1 <= ( len D35 ) implies ( Product ( D35 | $1 ) ) , R3 are_relative_prime );
L459: ( D35 | ( len D35 ) ) = D35 by FINSEQ_1:58;
L460: (for R5 being Nat holds (S5[ R5 ] implies S5[ ( R5 + 1 ) ]))
proof
let R5 being Nat;
L461:
now
per cases ;
suppose L462: ( len D35 ) >= ( R5 + 1 );

reconsider D43 = ( D35 | ( R5 + 1 ) ) as (FinSequence of ( NAT ));
reconsider D44 = ( D43 . ( R5 + 1 ) ) as (Element of ( NAT ));
L463: ( len D43 ) = ( R5 + 1 ) by L462 , FINSEQ_1:59;
L464: D43 = ( ( D43 | R5 ) ^ <* D44 *> ) by L463 , RFINSEQ:7;
reconsider D45 = ( Product ( D43 | R5 ) ) , D46 = D44 , D47 = R3 as Integer;
L465: R5 <= ( R5 + 1 ) by NAT_1:11;
L466: ( ( 0 ) + 1 ) <= ( R5 + 1 ) by XREAL_1:6;
L467: (( ( D35 | ( R5 + 1 ) ) . ( R5 + 1 ) ) = ( D35 . ( R5 + 1 ) ) & ( R5 + 1 ) in ( dom D35 )) by L466 , L462 , FINSEQ_3:25 , FINSEQ_3:112;
L468: ( ( D35 | ( R5 + 1 ) ) . ( R5 + 1 ) ) in ( rng D35 ) by L467 , FUNCT_1:def 3;
L469: ( rng D35 ) = D38 by L372 , FINSEQ_1:def 13;
L470: (ex B32 being (Element of ( NAT )) st (D44 = B32 & R3 , B32 are_relative_prime  & B32 >= 1 & B32 <= R3)) by L469 , L468;
assume L471: S5[ R5 ];
L472: D45 , D47 are_relative_prime  by L471 , L462 , L465 , FINSEQ_5:77 , XXREAL_0:2;
L473: ( D45 * D46 ) , D47 are_relative_prime  by L472 , L470 , INT_2:26;
thus L474: S5[ ( R5 + 1 ) ] by L473 , L464 , RVSUM_1:96;
end;
suppose L475: ( len D35 ) < ( R5 + 1 );

thus L476: thesis by L475;
end;
end;
thus L478: thesis by L461;
end;
L479: ( ( Product ( D35 | ( 0 ) ) ) gcd R3 ) = 1 by NEWTON:51 , RVSUM_1:94;
L480: S5[ ( 0 ) ] by L479 , INT_2:def 3;
L481: (for R5 being Nat holds S5[ R5 ]) from NAT_1:sch 2(L480 , L460);
thus L482: thesis by L481 , L459;
end;
L483: ( len D35 ) = ( card D38 ) by L372 , FINSEQ_3:39
.= ( Euler R3 ) by EULER_1:def 1;
L484: ( len D37 ) = ( Euler R3 ) by L483 , L426 , RFINSEQ:3;
L485: ( ( Product D35 ) mod R3 ) = ( ( Product D37 ) mod R3 ) by L426 , L103;
thus L486: thesis by L485 , L307 , L428 , L484 , L309 , L458 , L212;
end;
::$N Small Fermat's Theorem
theorem
L487: (for R1 being Nat holds (for R3 being Nat holds ((R1 <> ( 0 ) & R3 is  prime & R1 , R3 are_relative_prime ) implies ( ( R1 |^ R3 ) mod R3 ) = ( R1 mod R3 ))))
proof
let R1 being Nat;
let R3 being Nat;
assume that
L488: R1 <> ( 0 )
and
L489: R3 is  prime
and
L490: R1 , R3 are_relative_prime ;
L491: R3 > 1 by L489 , INT_2:def 4;
L492: ( R3 - 1 ) > ( 1 - 1 ) by L491 , XREAL_1:9;
reconsider D48 = ( R3 - 1 ) as (Element of ( NAT )) by L492 , INT_1:3;
L493: ( Euler R3 ) = ( R3 - 1 ) by L489 , EULER_1:20;
L494: ( ( ( R1 |^ D48 ) mod R3 ) * R1 ) = ( 1 * R1 ) by L493 , L488 , L490 , L491 , L305;
L495: (( D48 + 1 ) = R3 & ( ( ( R1 |^ D48 ) * R1 ) mod R3 ) = ( R1 mod R3 )) by L494 , L82;
thus L496: thesis by L495 , NEWTON:6;
end;
