:: Basic Concepts for Petri Nets with Boolean Markings.
:: Boolean Markings and the Firability/Firing of Transitions
::  by Pauline N. Kawamoto, Yasushi Fuwa and Yatsuka Nakamura
::
:: Received October 8, 1993
:: Copyright (c) 1993-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, XBOOLE_0, FUNCT_1, SUBSET_1, FUNCT_4, FUNCOP_1, RELAT_1,
      TARSKI, PETRI, FUNCT_2, MARGREL1, ARYTM_3, XBOOLEAN, FINSEQ_1, PARTFUN1,
      XXREAL_0, CARD_1, ORDINAL4, NAT_1, ARYTM_1, BOOLMARK, STRUCT_0, PNPROC_1;
 notations TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, XCMPLX_0, ORDINAL1, NAT_1,
      RELAT_1, FUNCT_1, PARTFUN1, FUNCT_2, DOMAIN_1, FUNCOP_1, FINSEQ_1,
      FUNCT_4, MARGREL1, PETRI, XXREAL_0, STRUCT_0;
 constructors DOMAIN_1, FUNCT_4, XREAL_0, NAT_1, MARGREL1, PETRI, RELSET_1;
 registrations XXREAL_0, XREAL_0, FINSEQ_1, MARGREL1, ORDINAL1, CARD_1,
      RELSET_1, STRUCT_0;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions PETRI, XBOOLE_0, XBOOLEAN, SUBSET_1;
 theorems SUBSET_1, TARSKI, ZFMISC_1, PETRI, FUNCT_1, FUNCOP_1, FUNCT_2,
      FUNCT_4, FINSEQ_1, FINSEQ_4, NAT_1, FINSEQ_2, FINSEQ_3, RELAT_1,
      RELSET_1, XBOOLE_0, XBOOLE_1, XREAL_1, XXREAL_0, ORDINAL1, PARTFUN1,
      SEQ_4;
 schemes FINSEQ_2, NAT_1;

begin
theorem
L1: (for B1 , B2 being non  empty set holds (for B3 being (Function of B1 , B2) holds (for B4 being (Subset of B1) holds (for B5 being (Element of B2) holds ( B3 +* ( B4 --> B5 ) ) is (Function of B1 , B2)))))
proof
let C1 , C2 being non  empty set;
let C3 being (Function of C1 , C2);
let C4 being (Subset of C1);
let C5 being (Element of C2);
L2: ( dom C3 ) = C1 by FUNCT_2:def 1;
L3: (( rng C3 ) c= C2 & ( rng ( C4 --> C5 ) ) c= { C5 }) by FUNCOP_1:13 , RELAT_1:def 19;
L4: ( ( rng C3 ) \/ ( rng ( C4 --> C5 ) ) ) c= ( C2 \/ { C5 } ) by L3 , XBOOLE_1:13;
L5: ( rng ( C3 +* ( C4 --> C5 ) ) ) c= ( ( rng C3 ) \/ ( rng ( C4 --> C5 ) ) ) by FUNCT_4:17;
L6: ( rng ( C3 +* ( C4 --> C5 ) ) ) c= ( C2 \/ { C5 } ) by L5 , L4 , XBOOLE_1:1;
L7: ( rng ( C3 +* ( C4 --> C5 ) ) ) c= C2 by L6 , ZFMISC_1:40;
L8: ( dom ( C3 +* ( C4 --> C5 ) ) ) = ( ( dom C3 ) \/ ( dom ( C4 --> C5 ) ) ) by FUNCT_4:def 1
.= ( ( [#] C1 ) \/ C4 ) by L2 , FUNCOP_1:13
.= C1 by SUBSET_1:11;
thus L9: thesis by L8 , L7 , FUNCT_2:def 1 , RELSET_1:4;
end;
theorem
L10: (for B6 , B7 being non  empty set holds (for B8 , B9 being (Subset of B6) holds (for B10 being (Function of B6 , B7) holds (( B10 .: B8 ) misses ( B10 .: B9 ) implies B8 misses B9))))
proof
let C6 , C7 being non  empty set;
let C8 , C9 being (Subset of C6);
let C10 being (Function of C6 , C7);
assume that
L11: ( ( C10 .: C8 ) /\ ( C10 .: C9 ) ) = ( {} );
assume L12: ( C8 /\ C9 ) <> ( {} );
consider C11 being (Element of C6) such that L13: C11 in ( C8 /\ C9 ) by L12 , SUBSET_1:4;
L14: C11 in C9 by L13 , XBOOLE_0:def 4;
L15: ( C10 . C11 ) in ( C10 .: C9 ) by L14 , FUNCT_2:35;
L16: C11 in C8 by L13 , XBOOLE_0:def 4;
L17: ( C10 . C11 ) in ( C10 .: C8 ) by L16 , FUNCT_2:35;
thus L18: contradiction by L17 , L11 , L15 , XBOOLE_0:def 4;
end;
theorem
L19: (for B11 , B12 being set holds (for B13 being Function holds (for B14 being set holds (B11 misses B12 implies ( ( B13 +* ( B11 --> B14 ) ) .: B12 ) = ( B13 .: B12 )))))
proof
let C12 , C13 being set;
let C14 being Function;
let C15 being set;
assume that
L20: ( C12 /\ C13 ) = ( {} )
and
L21: ( ( C14 +* ( C12 --> C15 ) ) .: C13 ) <> ( C14 .: C13 );
L22: ( dom ( C14 +* ( C12 --> C15 ) ) ) = ( ( dom C14 ) \/ ( dom ( C12 --> C15 ) ) ) by FUNCT_4:def 1;
L23: ( dom ( C12 --> C15 ) ) = C12 by FUNCOP_1:13;
L24: (not (for B15 being set holds (B15 in ( ( C14 +* ( C12 --> C15 ) ) .: C13 ) iff B15 in ( C14 .: C13 )))) by L21 , TARSKI:1;
L25:
now
per cases  by L24;
case L26: (ex B16 being set st (B16 in ( ( C14 +* ( C12 --> C15 ) ) .: C13 ) & (not B16 in ( C14 .: C13 ))));
consider C16 being set such that L27: C16 in ( ( C14 +* ( C12 --> C15 ) ) .: C13 ) and L28: (not C16 in ( C14 .: C13 )) by L26;
consider C17 being set such that L29: C17 in ( dom ( C14 +* ( C12 --> C15 ) ) ) and L30: C17 in C13 and L31: C16 = ( ( C14 +* ( C12 --> C15 ) ) . C17 ) by L27 , FUNCT_1:def 6;
L32: (not C17 in C12) by L20 , L30 , XBOOLE_0:def 4;
L33: (C17 in ( dom C14 ) & C16 = ( C14 . C17 )) by L32 , L22 , L23 , L29 , L31 , FUNCT_4:11 , XBOOLE_0:def 3;
thus L34: contradiction by L33 , L28 , L30 , FUNCT_1:def 6;
end;
case L35: (ex B17 being set st ((not B17 in ( ( C14 +* ( C12 --> C15 ) ) .: C13 )) & B17 in ( C14 .: C13 )));
consider C18 being set such that L36: (not C18 in ( ( C14 +* ( C12 --> C15 ) ) .: C13 )) and L37: C18 in ( C14 .: C13 ) by L35;
consider C19 being set such that L38: C19 in ( dom C14 ) and L39: C19 in C13 and L40: C18 = ( C14 . C19 ) by L37 , FUNCT_1:def 6;
L41: (not C19 in C12) by L20 , L39 , XBOOLE_0:def 4;
L42: C18 = ( ( C14 +* ( C12 --> C15 ) ) . C19 ) by L41 , L23 , L40 , FUNCT_4:11;
L43: C19 in ( dom ( C14 +* ( C12 --> C15 ) ) ) by L22 , L38 , XBOOLE_0:def 3;
thus L44: contradiction by L43 , L36 , L39 , L42 , FUNCT_1:def 6;
end;
end;
thus L46: thesis by L25;
end;
begin
definition
let C20 being PT_net_Str;
func Bool_marks_of C20 -> (FUNCTION_DOMAIN of (the carrier of C20) , ( BOOLEAN )) equals 
( Funcs ((the carrier of C20) , ( BOOLEAN )) );
correctness;
end;
definition
let C21 being PT_net_Str;
mode Boolean_marking of C21
 is (Element of ( Bool_marks_of C21 ));
end;
definition
let C22 being Petri_net;
let C23 being (Boolean_marking of C22);
let C24 being (transition of C22);
pred C24 is_firable_on C23
means
:L49: ( C23 .: ( *' { C24 } ) ) c= { ( TRUE ) }
;end;
notation
let C25 being Petri_net;
let C26 being (Boolean_marking of C25);
let C27 being (transition of C25);
antonym C27 is_not_firable_on C26 for C27 is_firable_on C26;
end;
definition
let C28 being Petri_net;
let C29 being (Boolean_marking of C28);
let C30 being (transition of C28);
func Firing (C30 , C29) -> (Boolean_marking of C28) equals 
( ( C29 +* ( ( *' { C30 } ) --> ( FALSE ) ) ) +* ( ( { C30 } *' ) --> ( TRUE ) ) );
coherence
proof
set D1 = ( ( C29 +* ( ( *' { C30 } ) --> ( FALSE ) ) ) +* ( ( { C30 } *' ) --> ( TRUE ) ) );
L52: ( C29 +* ( ( *' { C30 } ) --> ( FALSE ) ) ) is (Function of (the carrier of C28) , ( BOOLEAN )) by L1;
L53: D1 is (Function of (the carrier of C28) , ( BOOLEAN )) by L52 , L1;
thus L54: thesis by L53 , FUNCT_2:8;
end;
correctness;
end;
definition
let C31 being Petri_net;
let C32 being (Boolean_marking of C31);
let C33 being (FinSequence of (the carrier' of C31));
pred C33 is_firable_on C32
means
:L56: (C33 = ( {} ) or (ex B18 being (FinSequence of ( Bool_marks_of C31 )) st (( len C33 ) = ( len B18 ) & ( C33 /. 1 ) is_firable_on C32 & ( B18 /. 1 ) = ( Firing (( C33 /. 1 ) , C32) ) & (for B19 being (Element of ( NAT )) holds ((B19 < ( len C33 ) & B19 > ( 0 )) implies (( C33 /. ( B19 + 1 ) ) is_firable_on ( B18 /. B19 ) & ( B18 /. ( B19 + 1 ) ) = ( Firing (( C33 /. ( B19 + 1 ) ) , ( B18 /. B19 )) )))))))
;end;
notation
let C34 being Petri_net;
let C35 being (Boolean_marking of C34);
let C36 being (FinSequence of (the carrier' of C34));
antonym C36 is_not_firable_on C35 for C36 is_firable_on C35;
end;
definition
let C37 being Petri_net;
let C38 being (Boolean_marking of C37);
let C39 being (FinSequence of (the carrier' of C37));
func Firing (C39 , C38) -> (Boolean_marking of C37) means 
:L59: it = C38 if C39 = ( {} ) otherwise (ex B20 being (FinSequence of ( Bool_marks_of C37 )) st (( len C39 ) = ( len B20 ) & it = ( B20 /. ( len B20 ) ) & ( B20 /. 1 ) = ( Firing (( C39 /. 1 ) , C38) ) & (for B21 being (Element of ( NAT )) holds ((B21 < ( len C39 ) & B21 > ( 0 )) implies ( B20 /. ( B21 + 1 ) ) = ( Firing (( C39 /. ( B21 + 1 ) ) , ( B20 /. B21 )) )))));
existence
proof
defpred S1[ (Element of ( NAT )) ] means (for B22 being (FinSequence of (the carrier' of C37)) holds ($1 = ( len B22 ) implies ((B22 = ( {} ) implies (ex B23 being (Boolean_marking of C37) st B23 = C38)) & (B22 <> ( {} ) implies (ex B24 being (Boolean_marking of C37) st (ex B25 being (FinSequence of ( Bool_marks_of C37 )) st (( len B22 ) = ( len B25 ) & B24 = ( B25 /. ( len B25 ) ) & ( B25 /. 1 ) = ( Firing (( B22 /. 1 ) , C38) ) & (for B26 being (Element of ( NAT )) holds ((B26 < ( len B22 ) & B26 > ( 0 )) implies ( B25 /. ( B26 + 1 ) ) = ( Firing (( B22 /. ( B26 + 1 ) ) , ( B25 /. B26 )) ))))))))));
L60:
now
let C40 being (Element of ( NAT ));
assume L61: S1[ C40 ];
thus L62: S1[ ( C40 + 1 ) ]
proof
let C41 being (FinSequence of (the carrier' of C37));
assume that
L63: ( C40 + 1 ) = ( len C41 );
thus L64: (C41 = ( {} ) implies (ex B27 being (Boolean_marking of C37) st B27 = C38));
thus L65: (C41 <> ( {} ) implies (ex B28 being (Boolean_marking of C37) st (ex B29 being (FinSequence of ( Bool_marks_of C37 )) st (( len C41 ) = ( len B29 ) & B28 = ( B29 /. ( len B29 ) ) & ( B29 /. 1 ) = ( Firing (( C41 /. 1 ) , C38) ) & (for B30 being (Element of ( NAT )) holds ((B30 < ( len C41 ) & B30 > ( 0 )) implies ( B29 /. ( B30 + 1 ) ) = ( Firing (( C41 /. ( B30 + 1 ) ) , ( B29 /. B30 )) )))))))
proof
assume L66: C41 <> ( {} );
L67: ( len C41 ) <> ( 0 ) by L66;
consider C42 being (FinSequence of (the carrier' of C37)), C43 being (transition of C37) such that L68: C41 = ( C42 ^ <* C43 *> ) by L67 , FINSEQ_2:19;
L69: ( C40 + 1 ) = ( ( len C42 ) + 1 ) by L63 , L68 , FINSEQ_2:16;
per cases ;
suppose L70: C42 = ( {} );

take D2 = ( Firing (C43 , C38) );
take D3 = <* D2 *>;
L71: ( len C41 ) = ( ( len C42 ) + ( len <* C43 *> ) ) by L68 , FINSEQ_1:22
.= ( ( 0 ) + ( len <* C43 *> ) ) by L70
.= ( ( 0 ) + 1 ) by FINSEQ_1:39;
thus L72: ( len C41 ) = ( len D3 ) by L71 , FINSEQ_1:39;
thus L73: D2 = ( D3 /. ( len D3 ) ) by L72 , L71 , FINSEQ_4:16;
L74: C41 = <* C43 *> by L68 , L70 , FINSEQ_1:34;
L75: ( C41 /. 1 ) = C43 by L74 , FINSEQ_4:16;
thus L76: ( D3 /. 1 ) = ( Firing (( C41 /. 1 ) , C38) ) by L75 , FINSEQ_4:16;
let C44 being (Element of ( NAT ));
assume L77: (C44 < ( len C41 ) & C44 > ( 0 ));
thus L78: thesis by L77 , L71 , NAT_1:13;
end;
suppose L79: C42 <> ( {} );

L80: ( len C42 ) > ( 0 ) by L79 , NAT_1:3;
L81: ( ( 0 ) + 1 ) < ( ( len C42 ) + 1 ) by L80 , XREAL_1:6;
L82: 1 <= ( len C42 ) by L81 , NAT_1:13;
L83: 1 in ( dom C42 ) by L82 , FINSEQ_3:25;
L84: ( len C41 ) = ( ( len C42 ) + ( len <* C43 *> ) ) by L68 , FINSEQ_1:22
.= ( ( len C42 ) + 1 ) by FINSEQ_1:40;
consider C45 being (Boolean_marking of C37), C46 being (FinSequence of ( Bool_marks_of C37 )) such that L85: ( len C42 ) = ( len C46 ) and L86: C45 = ( C46 /. ( len C46 ) ) and L87: ( C46 /. 1 ) = ( Firing (( C42 /. 1 ) , C38) ) and L88: (for B31 being (Element of ( NAT )) holds ((B31 < ( len C42 ) & B31 > ( 0 )) implies ( C46 /. ( B31 + 1 ) ) = ( Firing (( C42 /. ( B31 + 1 ) ) , ( C46 /. B31 )) ))) by L61 , L69 , L79;
take D4 = ( Firing (C43 , C45) );
take D5 = ( C46 ^ <* D4 *> );
L89: ( len D5 ) = ( ( len C46 ) + ( len <* D4 *> ) ) by FINSEQ_1:22
.= ( ( len C46 ) + 1 ) by FINSEQ_1:40;
thus L90: ( len C41 ) = ( len D5 ) by L89 , L85 , L84;
thus L91: D4 = ( D5 /. ( len D5 ) ) by L89 , FINSEQ_4:67;
L92: ( ( 0 ) + 1 ) < ( ( len C46 ) + 1 ) by L85 , L80 , XREAL_1:6;
L93: 1 <= ( len C46 ) by L92 , NAT_1:13;
L94: 1 in ( dom C46 ) by L93 , FINSEQ_3:25;
thus L95: ( D5 /. 1 ) = ( C46 /. 1 ) by L94 , FINSEQ_4:68
.= ( Firing (( C41 /. 1 ) , C38) ) by L68 , L87 , L83 , FINSEQ_4:68;
let C47 being (Element of ( NAT ));
assume that
L96: C47 < ( len C41 )
and
L97: C47 > ( 0 );
thus L98: ( D5 /. ( C47 + 1 ) ) = ( Firing (( C41 /. ( C47 + 1 ) ) , ( D5 /. C47 )) )
proof
L99: (1 <= ( C47 + 1 ) & ( C47 + 1 ) <= ( ( len C42 ) + 1 )) by L84 , L96 , NAT_1:12 , NAT_1:13;
L100: (( Seg ( ( len C42 ) + 1 ) ) = ( ( Seg ( len C42 ) ) \/ { ( ( len C42 ) + 1 ) } ) & ( C47 + 1 ) in ( Seg ( ( len C42 ) + 1 ) )) by L99 , FINSEQ_1:1 , FINSEQ_1:9;
per cases  by L100 , XBOOLE_0:def 3;
suppose L101: ( C47 + 1 ) in ( Seg ( len C42 ) );

L102: ( C47 + 1 ) <= ( len C46 ) by L101 , L85 , FINSEQ_1:1;
L103: ( C47 + 1 ) <= ( ( len C46 ) + 1 ) by L102 , NAT_1:12;
L104: C47 <= ( len C46 ) by L103 , XREAL_1:6;
L105: ( ( 0 ) + 1 ) < ( C47 + 1 ) by L97 , XREAL_1:6;
L106: 1 <= C47 by L105 , NAT_1:13;
L107: C47 in ( dom C46 ) by L106 , L104 , FINSEQ_3:25;
L108: ( C47 + 1 ) <= ( len C42 ) by L101 , FINSEQ_1:1;
L109: C47 < ( len C42 ) by L108 , NAT_1:13;
L110: ( C46 /. ( C47 + 1 ) ) = ( Firing (( C42 /. ( C47 + 1 ) ) , ( C46 /. C47 )) ) by L109 , L88 , L97;
L111: ( C47 + 1 ) in ( dom C42 ) by L101 , FINSEQ_1:def 3;
L112: ( C42 /. ( C47 + 1 ) ) = ( C41 /. ( C47 + 1 ) ) by L111 , L68 , FINSEQ_4:68;
L113: ( C47 + 1 ) in ( dom C46 ) by L85 , L101 , FINSEQ_1:def 3;
L114: ( C46 /. ( C47 + 1 ) ) = ( D5 /. ( C47 + 1 ) ) by L113 , FINSEQ_4:68;
thus L115: thesis by L114 , L110 , L112 , L107 , FINSEQ_4:68;
end;
suppose L116: ( C47 + 1 ) in { ( ( len C42 ) + 1 ) };

L117: ( len C46 ) in ( dom C46 ) by L93 , FINSEQ_3:25;
L118: ( C47 + 1 ) = ( ( len C42 ) + 1 ) by L116 , TARSKI:def 1;
L119: (( D5 /. ( C47 + 1 ) ) = D4 & ( C41 /. ( C47 + 1 ) ) = C43) by L118 , L68 , L85 , FINSEQ_4:67;
thus L120: thesis by L119 , L85 , L86 , L118 , L117 , FINSEQ_4:68;
end;
end;

end;
end;

end;

end;
L63: S1[ ( 0 ) ];
L64: (for B32 being (Element of ( NAT )) holds S1[ B32 ]) from NAT_1:sch 1(L63 , L60);
thus L65: thesis by L64;
end;
uniqueness
proof
let C48 , C49 being (Boolean_marking of C37);
thus L66: ((C39 = ( {} ) & C48 = C38 & C49 = C38) implies C48 = C49);
assume L67: C39 <> ( {} );
given C50 being (FinSequence of ( Bool_marks_of C37 )) such that
L68: ( len C39 ) = ( len C50 )
and
L69: C48 = ( C50 /. ( len C50 ) )
and
L70: ( C50 /. 1 ) = ( Firing (( C39 /. 1 ) , C38) )
and
L71: (for B33 being (Element of ( NAT )) holds ((B33 < ( len C39 ) & B33 > ( 0 )) implies ( C50 /. ( B33 + 1 ) ) = ( Firing (( C39 /. ( B33 + 1 ) ) , ( C50 /. B33 )) )));

L72: ( dom C50 ) = ( Seg ( len C39 ) ) by L68 , FINSEQ_1:def 3;
given C51 being (FinSequence of ( Bool_marks_of C37 )) such that
L73: ( len C39 ) = ( len C51 )
and
L74: C49 = ( C51 /. ( len C51 ) )
and
L75: ( C51 /. 1 ) = ( Firing (( C39 /. 1 ) , C38) )
and
L76: (for B34 being (Element of ( NAT )) holds ((B34 < ( len C39 ) & B34 > ( 0 )) implies ( C51 /. ( B34 + 1 ) ) = ( Firing (( C39 /. ( B34 + 1 ) ) , ( C51 /. B34 )) )));

defpred S2[ (Element of ( NAT )) ] means ($1 in ( Seg ( len C39 ) ) implies ( C50 /. $1 ) = ( C51 /. $1 ));
L77:
now
let C52 being (Element of ( NAT ));
assume L78: S2[ C52 ];
L79:
now
assume L80: ( C52 + 1 ) in ( Seg ( len C39 ) );
per cases ;
suppose L81: C52 = ( 0 );

thus L82: ( C50 /. ( C52 + 1 ) ) = ( C51 /. ( C52 + 1 ) ) by L81 , L70 , L75;
end;
suppose L83: C52 <> ( 0 );

L84: C52 > ( 0 ) by L83 , NAT_1:3;
L85: (( C52 + 1 ) <= ( len C39 ) & C52 < ( C52 + 1 )) by L80 , FINSEQ_1:1 , XREAL_1:29;
L86: C52 < ( len C39 ) by L85 , XXREAL_0:2;
L87: 1 <= C52 by L83 , NAT_1:14;
thus L88: ( C50 /. ( C52 + 1 ) ) = ( Firing (( C39 /. ( C52 + 1 ) ) , ( C51 /. C52 )) ) by L87 , L71 , L78 , L86 , FINSEQ_1:1
.= ( C51 /. ( C52 + 1 ) ) by L76 , L84 , L86;
end;
end;
thus L90: S2[ ( C52 + 1 ) ] by L79;
end;
L91: S2[ ( 0 ) ] by FINSEQ_1:1;
L92: (for B35 being (Element of ( NAT )) holds S2[ B35 ]) from NAT_1:sch 1(L91 , L77);
L93:
now
let C53 being Nat;
assume L94: C53 in ( dom C50 );
L95: C53 in ( dom C51 ) by L94 , L73 , L72 , FINSEQ_1:def 3;
thus L96: ( C50 . C53 ) = ( C50 /. C53 ) by L94 , PARTFUN1:def 6
.= ( C51 /. C53 ) by L92 , L72 , L94
.= ( C51 . C53 ) by L95 , PARTFUN1:def 6;
end;
thus L97: C48 = C49 by L93 , L68 , L69 , L73 , L74 , FINSEQ_2:9;
end;
correctness;
end;
theorem
L99: (for B36 being non  empty set holds (for B37 being set holds (for B38 being Function holds ( ( B38 +* ( B36 --> B37 ) ) .: B36 ) = { B37 })))
proof
let C54 being non  empty set;
let C55 being set;
let C56 being Function;
L100:
now
let C57 being set;
thus L101: (C57 in ( ( C56 +* ( C54 --> C55 ) ) .: C54 ) implies C57 = C55)
proof
assume L102: C57 in ( ( C56 +* ( C54 --> C55 ) ) .: C54 );
consider C58 being set such that L103: C58 in ( dom ( C56 +* ( C54 --> C55 ) ) ) and L104: C58 in C54 and L105: C57 = ( ( C56 +* ( C54 --> C55 ) ) . C58 ) by L102 , FUNCT_1:def 6;
L106: C58 in ( dom ( C54 --> C55 ) ) by L104 , FUNCOP_1:13;
L107: C57 = ( ( C54 --> C55 ) . C58 ) by L106 , L105 , FUNCT_4:13;
thus L108: thesis by L107 , L104 , FUNCOP_1:7;
end;

consider C59 being set such that L109: C59 in C54 by XBOOLE_0:def 1;
L110: C59 in ( dom ( C54 --> C55 ) ) by L109 , FUNCOP_1:13;
L111: C59 in ( dom ( C56 +* ( C54 --> C55 ) ) ) by L110 , FUNCT_4:12;
L112: ( ( C54 --> C55 ) . C59 ) = C55 by L109 , FUNCOP_1:7;
L113: C55 = ( ( C56 +* ( C54 --> C55 ) ) . C59 ) by L112 , L110 , FUNCT_4:13;
thus L114: (C57 = C55 implies C57 in ( ( C56 +* ( C54 --> C55 ) ) .: C54 )) by L113 , L109 , L111 , FUNCT_1:def 6;
end;
thus L115: thesis by L100 , TARSKI:def 1;
end;
theorem
L116: (for B39 being Petri_net holds (for B40 being (Boolean_marking of B39) holds (for B41 being (transition of B39) holds (for B42 being (place of B39) holds (B42 in ( { B41 } *' ) implies ( ( Firing (B41 , B40) ) . B42 ) = ( TRUE ))))))
proof
let C60 being Petri_net;
let C61 being (Boolean_marking of C60);
let C62 being (transition of C60);
let C63 being (place of C60);
set D6 = ( ( C61 +* ( ( *' { C62 } ) --> ( FALSE ) ) ) +* ( ( { C62 } *' ) --> ( TRUE ) ) );
L117: ( [#] (the carrier of C60) ) = (the carrier of C60);
L118: (( dom C61 ) = (the carrier of C60) & ( dom ( ( *' { C62 } ) --> ( FALSE ) ) ) = ( *' { C62 } )) by FUNCT_2:def 1;
L119: ( dom ( ( { C62 } *' ) --> ( TRUE ) ) ) = ( { C62 } *' ) by FUNCT_2:def 1;
L120: ( dom D6 ) = ( ( dom ( C61 +* ( ( *' { C62 } ) --> ( FALSE ) ) ) ) \/ ( { C62 } *' ) ) by L119 , FUNCT_4:def 1
.= ( ( (the carrier of C60) \/ ( *' { C62 } ) ) \/ ( { C62 } *' ) ) by L118 , FUNCT_4:def 1
.= ( (the carrier of C60) \/ ( ( *' { C62 } ) \/ ( { C62 } *' ) ) ) by XBOOLE_1:4
.= (the carrier of C60) by L117 , SUBSET_1:11;
assume L121: C63 in ( { C62 } *' );
L122: ( ( ( C61 +* ( ( *' { C62 } ) --> ( FALSE ) ) ) +* ( ( { C62 } *' ) --> ( TRUE ) ) ) .: ( { C62 } *' ) ) = { ( TRUE ) } by L121 , L99;
L123: ( D6 . C63 ) in { ( TRUE ) } by L122 , L121 , L120 , FUNCT_1:def 6;
thus L124: thesis by L123 , TARSKI:def 1;
end;
L125:
now
let C64 being Petri_net;
let C65 being non  empty (Subset of (the carrier of C64));
set D7 = ( (( (the carrier of C64) --> ( TRUE ) ) qua Function) +* ( C65 --> ( FALSE ) ) );
L126: ( [#] (the carrier of C64) ) = (the carrier of C64);
L127: (( dom (( (the carrier of C64) --> ( TRUE ) ) qua Function) ) = (the carrier of C64) & ( dom ( C65 --> ( FALSE ) ) ) = C65) by FUNCOP_1:13;
L128: ( dom D7 ) = ( (the carrier of C64) \/ C65 ) by L127 , FUNCT_4:def 1
.= (the carrier of C64) by L126 , SUBSET_1:11;
L129: ( rng D7 ) c= ( ( rng ( (the carrier of C64) --> ( TRUE ) ) ) \/ ( rng ( C65 --> ( FALSE ) ) ) ) by FUNCT_4:17;
L130: ( rng ( C65 --> ( FALSE ) ) ) c= { ( FALSE ) } by FUNCOP_1:13;
L131: ( rng ( C65 --> ( FALSE ) ) ) c= ( BOOLEAN ) by L130 , XBOOLE_1:1;
L132: ( rng ( (the carrier of C64) --> ( TRUE ) ) ) c= { ( TRUE ) } by FUNCOP_1:13;
L133: ( rng ( (the carrier of C64) --> ( TRUE ) ) ) c= ( BOOLEAN ) by L132 , XBOOLE_1:1;
L134: ( ( rng ( (the carrier of C64) --> ( TRUE ) ) ) \/ ( rng ( C65 --> ( FALSE ) ) ) ) c= ( BOOLEAN ) by L133 , L131 , XBOOLE_1:8;
L135: ( rng D7 ) c= ( BOOLEAN ) by L134 , L129 , XBOOLE_1:1;
reconsider D8 = D7 as (Boolean_marking of C64) by L135 , L128 , FUNCT_2:def 2;
assume L136: (for B43 being (Boolean_marking of C64) holds (( B43 .: C65 ) = { ( FALSE ) } implies (for B44 being (transition of C64) holds (B44 is_firable_on B43 implies ( ( Firing (B44 , B43) ) .: C65 ) = { ( FALSE ) }))));
assume L137: (not C65 is  Deadlock-like);
L138: (not ( *' C65 ) c= ( C65 *' )) by L137 , PETRI:def 8;
consider C66 being (transition of C64) such that L139: C66 in ( *' C65 ) and L140: (not C66 in ( C65 *' )) by L138 , SUBSET_1:2;
L141: ( { C66 } *' ) meets C65 by L139 , PETRI:20;
consider C67 being set such that L142: C67 in ( ( { C66 } *' ) /\ C65 ) by L141 , XBOOLE_0:4;
L143: C67 in ( { C66 } *' ) by L142 , XBOOLE_0:def 4;
L144: ( ( Firing (C66 , D8) ) . C67 ) = ( TRUE ) by L143 , L116;
L145: C67 in C65 by L142 , XBOOLE_0:def 4;
L146: ( TRUE ) in ( ( Firing (C66 , D8) ) .: C65 ) by L145 , L144 , FUNCT_2:35;
L147: ( ( Firing (C66 , D8) ) .: C65 ) <> { ( FALSE ) } by L146 , TARSKI:def 1;
L148: C65 misses ( *' { C66 } ) by L140 , PETRI:19;
L149: ( (( (the carrier of C64) --> ( TRUE ) ) qua Function) .: ( *' { C66 } ) ) = ( D8 .: ( *' { C66 } ) ) by L148 , L19;
L150: (( rng ( (the carrier of C64) --> ( TRUE ) ) ) c= { ( TRUE ) } & ( ( (the carrier of C64) --> ( TRUE ) ) .: ( *' { C66 } ) ) c= ( rng ( (the carrier of C64) --> ( TRUE ) ) )) by FUNCOP_1:13 , RELAT_1:111;
L151: ( D8 .: ( *' { C66 } ) ) c= { ( TRUE ) } by L150 , L149 , XBOOLE_1:1;
L152: C66 is_firable_on D8 by L151 , L49;
L153: ( D8 .: C65 ) = { (( FALSE ) qua set) } by L99;
thus L154: contradiction by L153 , L136 , L152 , L147;
end;
theorem
L155: (for B45 being Petri_net holds (for B46 being non  empty (Subset of (the carrier of B45)) holds (B46 is  Deadlock-like iff (for B47 being (Boolean_marking of B45) holds (( B47 .: B46 ) = { ( FALSE ) } implies (for B48 being (transition of B45) holds (B48 is_firable_on B47 implies ( ( Firing (B48 , B47) ) .: B46 ) = { ( FALSE ) })))))))
proof
let C68 being Petri_net;
let C69 being non  empty (Subset of (the carrier of C68));
thus L156: (C69 is  Deadlock-like implies (for B49 being (Boolean_marking of C68) holds (( B49 .: C69 ) = { ( FALSE ) } implies (for B50 being (transition of C68) holds (B50 is_firable_on B49 implies ( ( Firing (B50 , B49) ) .: C69 ) = { ( FALSE ) })))))
proof
assume L157: C69 is  Deadlock-like;
L158: ( *' C69 ) is (Subset of ( C69 *' )) by L157 , PETRI:def 8;
let C70 being (Boolean_marking of C68);
assume that
L159: ( C70 .: C69 ) = { ( FALSE ) };
let C71 being (transition of C68);
assume L160: C71 is_firable_on C70;
L161: ( C70 .: ( *' { C71 } ) ) c= { ( TRUE ) } by L160 , L49;
L162: ( C70 .: ( *' { C71 } ) ) misses { ( FALSE ) } by L161 , XBOOLE_1:63 , ZFMISC_1:11;
L163: ( *' { C71 } ) misses C69 by L162 , L159 , L10;
L164: (not C71 in ( *' C69 )) by L163 , L158 , PETRI:19;
L165: ( { C71 } *' ) misses C69 by L164 , PETRI:20;
thus L166: ( ( Firing (C71 , C70) ) .: C69 ) = ( ( C70 +* ( ( *' { C71 } ) --> ( FALSE ) ) ) .: C69 ) by L165 , L19
.= { ( FALSE ) } by L159 , L162 , L10 , L19;
end;

thus L167: thesis by L125;
end;
theorem
L168: (for B51 being non  empty set holds (for B52 , B53 being (FinSequence of B51) holds (for B54 being (Element of ( NAT )) holds ((1 <= B54 & B54 <= ( len B52 )) implies ( ( B52 ^ B53 ) /. B54 ) = ( B52 /. B54 )))))
proof
let C72 being non  empty set;
let C73 , C74 being (FinSequence of C72);
let C75 being (Element of ( NAT ));
L169: ( len C73 ) <= ( ( len C73 ) + ( len C74 ) ) by NAT_1:11;
L170: (C75 <= ( len C73 ) implies C75 <= ( ( len C73 ) + ( len C74 ) )) by L169 , XXREAL_0:2;
L171: (C75 in ( dom C73 ) implies C75 in ( Seg ( len C73 ) )) by FINSEQ_1:def 3;
L172: (C75 in ( dom C73 ) implies (1 <= C75 & C75 <= ( len ( C73 ^ C74 ) ))) by L171 , L170 , FINSEQ_1:1 , FINSEQ_1:22;
L173: (C75 in ( dom C73 ) implies C75 in ( dom ( C73 ^ C74 ) )) by L172 , FINSEQ_3:25;
L174: (C75 in ( dom C73 ) implies ( C73 . C75 ) = ( C73 /. C75 )) by PARTFUN1:def 6;
L175: (C75 in ( dom C73 ) implies ( ( C73 ^ C74 ) . C75 ) = ( C73 /. C75 )) by L174 , FINSEQ_1:def 7;
L176: (C75 in ( dom C73 ) iff C75 in ( Seg ( len C73 ) )) by FINSEQ_1:def 3;
thus L177: thesis by L176 , L173 , L175 , FINSEQ_1:1 , PARTFUN1:def 6;
end;
theorem
L178: (for B55 being Petri_net holds (for B56 being (Boolean_marking of B55) holds (for B57 , B58 being (FinSequence of (the carrier' of B55)) holds ( Firing (( B57 ^ B58 ) , B56) ) = ( Firing (B58 , ( Firing (B57 , B56) )) ))))
proof
let C76 being Petri_net;
let C77 being (Boolean_marking of C76);
let C78 , C79 being (FinSequence of (the carrier' of C76));
L179:
now
per cases ;
case L180: (C78 = ( {} ) & C79 = ( {} ));
L181: ( C78 ^ C79 ) = ( {} ) by L180 , FINSEQ_1:34;
L182: ( Firing (C79 , ( Firing (C78 , C77) )) ) = ( Firing (C79 , C77) ) by L180 , L59
.= C77 by L180 , L59;
thus L183: thesis by L182 , L181 , L59;
end;
case L184: (C78 = ( {} ) & C79 <> ( {} ));
L185: ( Firing (( C78 ^ C79 ) , C77) ) = ( Firing (C79 , C77) ) by L184 , FINSEQ_1:34;
thus L186: thesis by L185 , L184 , L59;
end;
case L187: (C78 <> ( {} ) & C79 = ( {} ));
L188: ( Firing (( C78 ^ C79 ) , C77) ) = ( Firing (C78 , C77) ) by L187 , FINSEQ_1:34;
thus L189: thesis by L188 , L187 , L59;
end;
case L190: (C78 <> ( {} ) & C79 <> ( {} ));
consider C80 being (FinSequence of ( Bool_marks_of C76 )) such that L191: (( len C78 ) = ( len C80 ) & ( Firing (C78 , C77) ) = ( C80 /. ( len C80 ) )) and L192: ( C80 /. 1 ) = ( Firing (( C78 /. 1 ) , C77) ) and L193: (for B59 being (Element of ( NAT )) holds ((B59 < ( len C78 ) & B59 > ( 0 )) implies ( C80 /. ( B59 + 1 ) ) = ( Firing (( C78 /. ( B59 + 1 ) ) , ( C80 /. B59 )) ))) by L190 , L59;
consider C81 being (FinSequence of ( Bool_marks_of C76 )) such that L194: ( len ( C78 ^ C79 ) ) = ( len C81 ) and L195: ( Firing (( C78 ^ C79 ) , C77) ) = ( C81 /. ( len C81 ) ) and L196: ( C81 /. 1 ) = ( Firing (( ( C78 ^ C79 ) /. 1 ) , C77) ) and L197: (for B60 being (Element of ( NAT )) holds ((B60 < ( len ( C78 ^ C79 ) ) & B60 > ( 0 )) implies ( C81 /. ( B60 + 1 ) ) = ( Firing (( ( C78 ^ C79 ) /. ( B60 + 1 ) ) , ( C81 /. B60 )) ))) by L190 , L59;
defpred S3[ (Element of ( NAT )) ] means (( 1 + $1 ) <= ( len C78 ) implies ( C81 /. ( 1 + $1 ) ) = ( C80 /. ( 1 + $1 ) ));
L198: ( 0 ) < ( len C79 ) by L190 , NAT_1:3;
L199: ( ( 0 ) + ( len C78 ) ) < ( ( len C78 ) + ( len C79 ) ) by L198 , XREAL_1:6;
L200: ( len C78 ) < ( len ( C78 ^ C79 ) ) by L199 , FINSEQ_1:22;
L201:
now
let C82 being (Element of ( NAT ));
L202: ( 0 ) <= C82 by NAT_1:2;
assume L203: S3[ C82 ];
L204:
now
assume L205: ( 1 + ( C82 + 1 ) ) <= ( len C78 );
L206: ( ( C78 ^ C79 ) /. ( 1 + ( C82 + 1 ) ) ) = ( C78 /. ( 1 + ( C82 + 1 ) ) ) by L205 , L168 , NAT_1:11;
L207: ( 1 + C82 ) < ( len C78 ) by L205 , NAT_1:13;
L208: ( 1 + C82 ) < ( len ( C78 ^ C79 ) ) by L207 , L200 , XXREAL_0:2;
L209: ( C81 /. ( 1 + ( C82 + 1 ) ) ) = ( Firing (( C78 /. ( 1 + ( C82 + 1 ) ) ) , ( C80 /. ( 1 + C82 ) )) ) by L208 , L197 , L202 , L203 , L205 , L206 , NAT_1:13;
thus L210: ( C81 /. ( 1 + ( C82 + 1 ) ) ) = ( C80 /. ( 1 + ( C82 + 1 ) ) ) by L209 , L193 , L202 , L207;
end;
thus L211: S3[ ( C82 + 1 ) ] by L204;
end;
reconsider D9 = ( ( len C78 ) - 1 ) as (Element of ( NAT )) by L190 , NAT_1:3 , NAT_1:20;
let C83 being (Element of ( NAT ));
L212: ( len C79 ) > ( 0 ) by L190 , NAT_1:3;
L213: ( ( 0 ) + 1 ) <= ( len C79 ) by L212 , NAT_1:13;
consider C84 being (FinSequence of ( Bool_marks_of C76 )) such that L214: ( len C79 ) = ( len C84 ) and L215: ( Firing (C79 , ( Firing (C78 , C77) )) ) = ( C84 /. ( len C84 ) ) and L216: ( C84 /. 1 ) = ( Firing (( C79 /. 1 ) , ( Firing (C78 , C77) )) ) and L217: (for B61 being (Element of ( NAT )) holds ((B61 < ( len C79 ) & B61 > ( 0 )) implies ( C84 /. ( B61 + 1 ) ) = ( Firing (( C79 /. ( B61 + 1 ) ) , ( C84 /. B61 )) ))) by L190 , L59;
consider C85 being Nat such that L218: ( len C84 ) = ( C85 + 1 ) by L190 , L214 , NAT_1:6;
L219: S3[ ( 0 ) ] by L196 , L192 , L168;
L220: (for B62 being (Element of ( NAT )) holds S3[ B62 ]) from NAT_1:sch 1(L219 , L201);
defpred S4[ (Element of ( NAT )) ] means (( 1 + $1 ) <= ( len C79 ) implies ( C81 /. ( ( ( len C78 ) + 1 ) + $1 ) ) = ( C84 /. ( 1 + $1 ) ));
L221:
now
let C86 being (Element of ( NAT ));
assume L222: S4[ C86 ];
L223: ( 0 ) <= ( C86 + ( len C78 ) ) by NAT_1:2;
L224: (( ( ( ( len C78 ) + 1 ) + C86 ) + 1 ) = ( ( ( len C78 ) + 1 ) + ( C86 + 1 ) ) & ( 0 ) < ( ( ( len C78 ) + C86 ) + 1 )) by L223;
L225: ( 0 ) <= C86 by NAT_1:2;
L226:
now
assume L227: ( 1 + ( C86 + 1 ) ) <= ( len C79 );
L228: ( ( C78 ^ C79 ) /. ( ( len C78 ) + ( 1 + ( C86 + 1 ) ) ) ) = ( C79 /. ( 1 + ( C86 + 1 ) ) ) by L227 , NAT_1:11 , SEQ_4:136;
L229: ( 1 + C86 ) < ( len C79 ) by L227 , NAT_1:13;
L230: ( ( len C78 ) + ( 1 + C86 ) ) < ( ( len C78 ) + ( len C79 ) ) by L229 , XREAL_1:6;
L231: ( ( ( len C78 ) + 1 ) + C86 ) < ( len ( C78 ^ C79 ) ) by L230 , FINSEQ_1:22;
L232: ( C81 /. ( ( ( len C78 ) + 1 ) + ( C86 + 1 ) ) ) = ( Firing (( C79 /. ( 1 + ( C86 + 1 ) ) ) , ( C84 /. ( 1 + C86 ) )) ) by L231 , L197 , L224 , L222 , L227 , L228 , NAT_1:13;
thus L233: ( C81 /. ( ( ( len C78 ) + 1 ) + ( C86 + 1 ) ) ) = ( C84 /. ( 1 + ( C86 + 1 ) ) ) by L232 , L217 , L225 , L229;
end;
thus L234: S4[ ( C86 + 1 ) ] by L226;
end;
L235: ( len C78 ) > ( 0 ) by L190 , NAT_1:3;
L236: ( C81 /. ( ( ( len C78 ) + 1 ) + ( 0 ) ) ) = ( Firing (( ( C78 ^ C79 ) /. ( ( len C78 ) + 1 ) ) , ( C81 /. ( 1 + D9 ) )) ) by L235 , L197 , L200
.= ( Firing (( ( C78 ^ C79 ) /. ( ( len C78 ) + 1 ) ) , ( Firing (C78 , C77) )) ) by L191 , L220
.= ( C84 /. ( 1 + ( 0 ) ) ) by L216 , L213 , SEQ_4:136;
L237: S4[ ( 0 ) ] by L236;
L238: (for B63 being (Element of ( NAT )) holds S4[ B63 ]) from NAT_1:sch 1(L237 , L221);
reconsider D10 = C85 as (Element of ( NAT )) by ORDINAL1:def 12;
L239: ( C81 /. ( len C81 ) ) = ( C81 /. ( ( len C78 ) + ( 1 + D10 ) ) ) by L194 , L214 , L218 , FINSEQ_1:22
.= ( C81 /. ( ( ( len C78 ) + 1 ) + D10 ) )
.= ( C84 /. ( len C84 ) ) by L214 , L238 , L218;
thus L240: thesis by L239 , L195 , L215;
end;
end;
thus L242: thesis by L179;
end;
theorem
L243: (for B64 being Petri_net holds (for B65 being (Boolean_marking of B64) holds (for B66 , B67 being (FinSequence of (the carrier' of B64)) holds (( B66 ^ B67 ) is_firable_on B65 implies (B67 is_firable_on ( Firing (B66 , B65) ) & B66 is_firable_on B65)))))
proof
let C87 being Petri_net;
let C88 being (Boolean_marking of C87);
let C89 , C90 being (FinSequence of (the carrier' of C87));
assume L244: ( C89 ^ C90 ) is_firable_on C88;
L245:
now
per cases ;
case L246: (C89 = ( {} ) & C90 = ( {} ));
thus L247: thesis by L246 , L56;
end;
case L248: (C89 = ( {} ) & C90 <> ( {} ));
thus L249: C89 is_firable_on C88 by L248 , L56;
L250: ( C89 ^ C90 ) = C90 by L248 , FINSEQ_1:34;
thus L251: C90 is_firable_on ( Firing (C89 , C88) ) by L250 , L244 , L248 , L59;
end;
case L252: (C89 <> ( {} ) & C90 = ( {} ));
thus L253: C90 is_firable_on ( Firing (C89 , C88) ) by L252 , L56;
thus L254: C89 is_firable_on C88 by L244 , L252 , FINSEQ_1:34;
end;
case L255: (C89 <> ( {} ) & C90 <> ( {} ));
let C91 being (Element of ( NAT ));
L256: ( len C90 ) > ( 0 ) by L255 , NAT_1:3;
L257: ( ( 0 ) + 1 ) <= ( len C90 ) by L256 , NAT_1:13;
L258: ( C90 /. 1 ) = ( ( C89 ^ C90 ) /. ( ( len C89 ) + 1 ) ) by L257 , SEQ_4:136;
reconsider D11 = ( ( len C89 ) - 1 ) as (Element of ( NAT )) by L255 , NAT_1:3 , NAT_1:20;
consider C92 being (FinSequence of ( Bool_marks_of C87 )) such that L259: ( len C90 ) = ( len C92 ) and L260: ( Firing (C90 , ( Firing (C89 , C88) )) ) = ( C92 /. ( len C92 ) ) and L261: ( C92 /. 1 ) = ( Firing (( C90 /. 1 ) , ( Firing (C89 , C88) )) ) and L262: (for B68 being (Element of ( NAT )) holds ((B68 < ( len C90 ) & B68 > ( 0 )) implies ( C92 /. ( B68 + 1 ) ) = ( Firing (( C90 /. ( B68 + 1 ) ) , ( C92 /. B68 )) ))) by L255 , L59;
consider C93 being (FinSequence of ( Bool_marks_of C87 )) such that L263: ( len C89 ) = ( len C93 ) and L264: ( Firing (C89 , C88) ) = ( C93 /. ( len C93 ) ) and L265: ( C93 /. 1 ) = ( Firing (( C89 /. 1 ) , C88) ) and L266: (for B69 being (Element of ( NAT )) holds ((B69 < ( len C89 ) & B69 > ( 0 )) implies ( C93 /. ( B69 + 1 ) ) = ( Firing (( C89 /. ( B69 + 1 ) ) , ( C93 /. B69 )) ))) by L255 , L59;
consider C94 being Nat such that L267: ( len C93 ) = ( C94 + 1 ) by L255 , L263 , NAT_1:6;
reconsider D12 = C94 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C95 being (FinSequence of ( Bool_marks_of C87 )) such that L268: ( len ( C89 ^ C90 ) ) = ( len C95 ) and L269: ( ( C89 ^ C90 ) /. 1 ) is_firable_on C88 and L270: ( C95 /. 1 ) = ( Firing (( ( C89 ^ C90 ) /. 1 ) , C88) ) and L271: (for B70 being (Element of ( NAT )) holds ((B70 < ( len ( C89 ^ C90 ) ) & B70 > ( 0 )) implies (( ( C89 ^ C90 ) /. ( B70 + 1 ) ) is_firable_on ( C95 /. B70 ) & ( C95 /. ( B70 + 1 ) ) = ( Firing (( ( C89 ^ C90 ) /. ( B70 + 1 ) ) , ( C95 /. B70 )) )))) by L244 , L255 , L56;
defpred S5[ (Element of ( NAT )) ] means (( 1 + $1 ) <= ( len C89 ) implies ( C95 /. ( 1 + $1 ) ) = ( C93 /. ( 1 + $1 ) ));
L272: ( 0 ) < ( len C90 ) by L255 , NAT_1:3;
L273: ( ( 0 ) + ( len C89 ) ) < ( ( len C89 ) + ( len C90 ) ) by L272 , XREAL_1:6;
L274: ( len C89 ) < ( len ( C89 ^ C90 ) ) by L273 , FINSEQ_1:22;
L275:
now
let C96 being (Element of ( NAT ));
L276: ( 0 ) <= C96 by NAT_1:2;
assume L277: S5[ C96 ];
L278:
now
assume L279: ( 1 + ( C96 + 1 ) ) <= ( len C89 );
L280: ( ( C89 ^ C90 ) /. ( 1 + ( C96 + 1 ) ) ) = ( C89 /. ( 1 + ( C96 + 1 ) ) ) by L279 , L168 , NAT_1:11;
L281: ( 1 + C96 ) < ( len C89 ) by L279 , NAT_1:13;
L282: ( 1 + C96 ) < ( len ( C89 ^ C90 ) ) by L281 , L274 , XXREAL_0:2;
L283: ( C95 /. ( 1 + ( C96 + 1 ) ) ) = ( Firing (( C89 /. ( 1 + ( C96 + 1 ) ) ) , ( C93 /. ( 1 + C96 ) )) ) by L282 , L271 , L276 , L277 , L279 , L280 , NAT_1:13;
thus L284: ( C95 /. ( 1 + ( C96 + 1 ) ) ) = ( C93 /. ( 1 + ( C96 + 1 ) ) ) by L283 , L266 , L276 , L281;
end;
thus L285: S5[ ( C96 + 1 ) ] by L278;
end;
L286: S5[ ( 0 ) ] by L270 , L265 , L168;
L287: (for B71 being (Element of ( NAT )) holds S5[ B71 ]) from NAT_1:sch 1(L286 , L275);
L288:
now
let C97 being (Element of ( NAT ));
assume that
L289: C97 < ( len C89 )
and
L290: C97 > ( 0 );
consider C98 being Nat such that L291: C97 = ( C98 + 1 ) by L290 , NAT_1:6;
L292: (( C97 + 1 ) >= 1 & ( C97 + 1 ) <= ( len C89 )) by L289 , NAT_1:11 , NAT_1:13;
L293: ( C97 + 1 ) in ( dom C89 ) by L292 , FINSEQ_3:25;
L294: ( ( C89 ^ C90 ) /. ( C97 + 1 ) ) = ( C89 /. ( C97 + 1 ) ) by L293 , FINSEQ_4:68;
reconsider D13 = C98 as (Element of ( NAT )) by ORDINAL1:def 12;
L295: C97 = ( D13 + 1 ) by L291;
L296: ( C95 /. C97 ) = ( C93 /. C97 ) by L295 , L287 , L289;
L297: ( C97 + 1 ) <= ( len C89 ) by L289 , NAT_1:13;
L298: C97 < ( len ( C89 ^ C90 ) ) by L274 , L289 , XXREAL_0:2;
L299: ( C95 /. ( C97 + 1 ) ) = ( Firing (( ( C89 ^ C90 ) /. ( C97 + 1 ) ) , ( C95 /. C97 )) ) by L298 , L271 , L290;
thus L300: (( C89 /. ( C97 + 1 ) ) is_firable_on ( C93 /. C97 ) & ( C93 /. ( C97 + 1 ) ) = ( Firing (( C89 /. ( C97 + 1 ) ) , ( C93 /. C97 )) )) by L299 , L271 , L287 , L290 , L298 , L294 , L296 , L297;
end;
defpred S6[ (Element of ( NAT )) ] means (( 1 + $1 ) <= ( len C90 ) implies ( C95 /. ( ( ( len C89 ) + 1 ) + $1 ) ) = ( C92 /. ( 1 + $1 ) ));
L301:
now
let C99 being (Element of ( NAT ));
assume L302: S6[ C99 ];
L303: ( 0 ) <= ( C99 + ( len C89 ) ) by NAT_1:2;
L304: (( ( ( ( len C89 ) + 1 ) + C99 ) + 1 ) = ( ( ( len C89 ) + 1 ) + ( C99 + 1 ) ) & ( 0 ) < ( ( ( len C89 ) + C99 ) + 1 )) by L303;
L305: ( 0 ) <= C99 by NAT_1:2;
L306:
now
assume L307: ( 1 + ( C99 + 1 ) ) <= ( len C90 );
L308: ( ( C89 ^ C90 ) /. ( ( len C89 ) + ( 1 + ( C99 + 1 ) ) ) ) = ( C90 /. ( 1 + ( C99 + 1 ) ) ) by L307 , NAT_1:11 , SEQ_4:136;
L309: ( 1 + C99 ) < ( len C90 ) by L307 , NAT_1:13;
L310: ( ( len C89 ) + ( 1 + C99 ) ) < ( ( len C89 ) + ( len C90 ) ) by L309 , XREAL_1:6;
L311: ( ( ( len C89 ) + 1 ) + C99 ) < ( len ( C89 ^ C90 ) ) by L310 , FINSEQ_1:22;
L312: ( C95 /. ( ( ( len C89 ) + 1 ) + ( C99 + 1 ) ) ) = ( Firing (( C90 /. ( 1 + ( C99 + 1 ) ) ) , ( C92 /. ( 1 + C99 ) )) ) by L311 , L271 , L304 , L302 , L307 , L308 , NAT_1:13;
thus L313: ( C95 /. ( ( ( len C89 ) + 1 ) + ( C99 + 1 ) ) ) = ( C92 /. ( 1 + ( C99 + 1 ) ) ) by L312 , L262 , L305 , L309;
end;
thus L314: S6[ ( C99 + 1 ) ] by L306;
end;
L315: ( len C89 ) > ( 0 ) by L255 , NAT_1:3;
L316: ( C95 /. ( ( ( len C89 ) + 1 ) + ( 0 ) ) ) = ( Firing (( ( C89 ^ C90 ) /. ( ( len C89 ) + 1 ) ) , ( C95 /. ( 1 + D11 ) )) ) by L315 , L271 , L274
.= ( Firing (( ( C89 ^ C90 ) /. ( ( len C89 ) + 1 ) ) , ( Firing (C89 , C88) )) ) by L263 , L264 , L287
.= ( C92 /. ( 1 + ( 0 ) ) ) by L261 , L257 , SEQ_4:136;
L317: S6[ ( 0 ) ] by L316;
L318: (for B72 being (Element of ( NAT )) holds S6[ B72 ]) from NAT_1:sch 1(L317 , L301);
L319:
now
let C100 being (Element of ( NAT ));
assume that
L320: C100 < ( len C90 )
and
L321: C100 > ( 0 );
consider C101 being Nat such that L322: C100 = ( C101 + 1 ) by L321 , NAT_1:6;
reconsider D14 = C101 as (Element of ( NAT )) by ORDINAL1:def 12;
L323: ( ( ( len C89 ) + 1 ) + D14 ) = ( ( len C89 ) + ( D14 + 1 ) );
L324: ( C95 /. ( ( len C89 ) + C100 ) ) = ( C92 /. C100 ) by L323 , L318 , L320 , L322;
L325: (( C100 + 1 ) >= 1 & ( C100 + 1 ) <= ( len C90 )) by L320 , NAT_1:11 , NAT_1:13;
L326: ( C100 + 1 ) in ( dom C90 ) by L325 , FINSEQ_3:25;
L327: ( ( C89 ^ C90 ) /. ( ( ( len C89 ) + C100 ) + 1 ) ) = ( ( C89 ^ C90 ) /. ( ( len C89 ) + ( C100 + 1 ) ) )
.= ( C90 /. ( C100 + 1 ) ) by L326 , FINSEQ_4:69;
L328: (( ( ( len C89 ) + 1 ) + C100 ) = ( ( ( len C89 ) + C100 ) + 1 ) & ( C100 + 1 ) <= ( len C90 )) by L320 , NAT_1:13;
L329: ( len ( C89 ^ C90 ) ) = ( ( len C89 ) + ( len C90 ) ) by FINSEQ_1:22;
L330: ( ( len C89 ) + C100 ) < ( len ( C89 ^ C90 ) ) by L329 , L320 , XREAL_1:6;
L331: C100 < ( ( len C89 ) + C100 ) by L255 , NAT_1:3 , XREAL_1:29;
L332: ( C95 /. ( ( ( len C89 ) + C100 ) + 1 ) ) = ( Firing (( ( C89 ^ C90 ) /. ( ( ( len C89 ) + C100 ) + 1 ) ) , ( C95 /. ( ( len C89 ) + C100 ) )) ) by L331 , L271 , L321 , L330;
thus L333: (( C90 /. ( C100 + 1 ) ) is_firable_on ( C92 /. C100 ) & ( C92 /. ( C100 + 1 ) ) = ( Firing (( C90 /. ( C100 + 1 ) ) , ( C92 /. C100 )) )) by L332 , L271 , L318 , L321 , L330 , L331 , L327 , L324 , L328;
end;
L334: ( len C93 ) = ( D12 + 1 ) by L267;
L335: ( C95 /. ( len C93 ) ) = ( C93 /. ( len C93 ) ) by L334 , L263 , L287;
L336: ( C90 /. 1 ) is_firable_on ( C93 /. ( len C93 ) ) by L335 , L271 , L263 , L315 , L274 , L258;
thus L337: C90 is_firable_on ( Firing (C89 , C88) ) by L336 , L264 , L259 , L261 , L319 , L56;
L338: ( ( 0 ) + 1 ) <= ( len C89 ) by L315 , NAT_1:13;
L339: ( C89 /. 1 ) is_firable_on C88 by L338 , L269 , L168;
thus L340: C89 is_firable_on C88 by L339 , L263 , L265 , L288 , L56;
end;
end;
thus L342: thesis by L245;
end;
theorem
L343: (for B73 being Petri_net holds (for B74 being (Boolean_marking of B73) holds (for B75 being (transition of B73) holds (B75 is_firable_on B74 iff <* B75 *> is_firable_on B74))))
proof
let C102 being Petri_net;
let C103 being (Boolean_marking of C102);
let C104 being (transition of C102);
thus L344:now
set D15 = <* ( Firing (( <* C104 *> /. 1 ) , C103) ) *>;
L345: ( D15 /. 1 ) = ( Firing (( <* C104 *> /. 1 ) , C103) ) by FINSEQ_4:16;
L346:
now
L347: ( len <* C104 *> ) = ( ( 0 ) + 1 ) by FINSEQ_1:39;
let C105 being (Element of ( NAT ));
assume L348: (C105 < ( len <* C104 *> ) & C105 > ( 0 ));
thus L349: (( <* C104 *> /. ( C105 + 1 ) ) is_firable_on ( D15 /. C105 ) & ( D15 /. ( C105 + 1 ) ) = ( Firing (( <* C104 *> /. ( C105 + 1 ) ) , ( D15 /. C105 )) )) by L348 , L347 , NAT_1:13;
end;
assume L350: C104 is_firable_on C103;
L351: ( <* C104 *> /. 1 ) is_firable_on C103 by L350 , FINSEQ_4:16;
L352: ( len <* C104 *> ) = 1 by FINSEQ_1:39
.= ( len D15 ) by FINSEQ_1:39;
thus L353: <* C104 *> is_firable_on C103 by L352 , L351 , L345 , L346 , L56;
end;
assume L354: <* C104 *> is_firable_on C103;
L355: (ex B76 being (FinSequence of ( Bool_marks_of C102 )) st (( len <* C104 *> ) = ( len B76 ) & ( <* C104 *> /. 1 ) is_firable_on C103 & ( B76 /. 1 ) = ( Firing (( <* C104 *> /. 1 ) , C103) ) & (for B77 being (Element of ( NAT )) holds ((B77 < ( len <* C104 *> ) & B77 > ( 0 )) implies (( <* C104 *> /. ( B77 + 1 ) ) is_firable_on ( B76 /. B77 ) & ( B76 /. ( B77 + 1 ) ) = ( Firing (( <* C104 *> /. ( B77 + 1 ) ) , ( B76 /. B77 )) )))))) by L354 , L56;
thus L356: thesis by L355 , FINSEQ_4:16;
end;
theorem
L357: (for B78 being Petri_net holds (for B79 being (Boolean_marking of B78) holds (for B80 being (transition of B78) holds ( Firing (B80 , B79) ) = ( Firing (<* B80 *> , B79) ))))
proof
let C106 being Petri_net;
let C107 being (Boolean_marking of C106);
let C108 being (transition of C106);
set D16 = <* ( Firing (( <* C108 *> /. 1 ) , C107) ) *>;
L358: (( len <* C108 *> ) = 1 & ( <* C108 *> /. 1 ) = C108) by FINSEQ_1:39 , FINSEQ_4:16;
L359: ( D16 /. 1 ) = ( Firing (( <* C108 *> /. 1 ) , C107) ) by FINSEQ_4:16;
L360:
now
L361: ( len <* C108 *> ) = ( ( 0 ) + 1 ) by FINSEQ_1:39;
let C109 being (Element of ( NAT ));
assume L362: (C109 < ( len <* C108 *> ) & C109 > ( 0 ));
thus L363: ( D16 /. ( C109 + 1 ) ) = ( Firing (( <* C108 *> /. ( C109 + 1 ) ) , ( D16 /. C109 )) ) by L362 , L361 , NAT_1:13;
end;
L364: ( len <* C108 *> ) = 1 by FINSEQ_1:39
.= ( len D16 ) by FINSEQ_1:39;
thus L365: thesis by L364 , L358 , L359 , L360 , L59;
end;
theorem
L366: (for B81 being Petri_net holds (for B82 being non  empty (Subset of (the carrier of B81)) holds (B82 is  Deadlock-like iff (for B83 being (Boolean_marking of B81) holds (( B83 .: B82 ) = { ( FALSE ) } implies (for B84 being (FinSequence of (the carrier' of B81)) holds (B84 is_firable_on B83 implies ( ( Firing (B84 , B83) ) .: B82 ) = { ( FALSE ) })))))))
proof
let C110 being Petri_net;
let C111 being non  empty (Subset of (the carrier of C110));
set D17 = ( (( (the carrier of C110) --> ( TRUE ) ) qua Function) +* ( C111 --> ( FALSE ) ) );
L367: ( [#] (the carrier of C110) ) = (the carrier of C110);
L368: (( dom (( (the carrier of C110) --> ( TRUE ) ) qua Function) ) = (the carrier of C110) & ( dom ( C111 --> ( FALSE ) ) ) = C111) by FUNCOP_1:13;
L369: ( dom D17 ) = ( (the carrier of C110) \/ C111 ) by L368 , FUNCT_4:def 1
.= (the carrier of C110) by L367 , SUBSET_1:11;
L370: ( rng ( C111 --> ( FALSE ) ) ) c= { ( FALSE ) } by FUNCOP_1:13;
L371: ( rng ( C111 --> ( FALSE ) ) ) c= ( BOOLEAN ) by L370 , XBOOLE_1:1;
thus L372: (C111 is  Deadlock-like implies (for B85 being (Boolean_marking of C110) holds (( B85 .: C111 ) = { ( FALSE ) } implies (for B86 being (FinSequence of (the carrier' of C110)) holds (B86 is_firable_on B85 implies ( ( Firing (B86 , B85) ) .: C111 ) = { ( FALSE ) })))))
proof
assume L373: C111 is  Deadlock-like;
let C112 being (Boolean_marking of C110);
assume that
L374: ( C112 .: C111 ) = { ( FALSE ) };
defpred S7[ (FinSequence of (the carrier' of C110)) ] means ($1 is_firable_on C112 implies ( ( Firing ($1 , C112) ) .: C111 ) = { ( FALSE ) });
L375: ( *' C111 ) is (Subset of ( C111 *' )) by L373 , PETRI:def 8;
L376:
now
let C113 being (FinSequence of (the carrier' of C110));
let C114 being (transition of C110);
assume L377: S7[ C113 ];
thus L378: S7[ ( C113 ^ <* C114 *> ) ]
proof
L379: ( Firing (( C113 ^ <* C114 *> ) , C112) ) = ( Firing (<* C114 *> , ( Firing (C113 , C112) )) ) by L178;
L380: (ex B87 being (FinSequence of ( Bool_marks_of C110 )) st (( len <* C114 *> ) = ( len B87 ) & ( Firing (( C113 ^ <* C114 *> ) , C112) ) = ( B87 /. ( len B87 ) ) & ( B87 /. 1 ) = ( Firing (( <* C114 *> /. 1 ) , ( Firing (C113 , C112) )) ) & (for B88 being (Element of ( NAT )) holds ((B88 < ( len <* C114 *> ) & B88 > ( 0 )) implies ( B87 /. ( B88 + 1 ) ) = ( Firing (( <* C114 *> /. ( B88 + 1 ) ) , ( B87 /. B88 )) ))))) by L379 , L59;
L381: ( <* C114 *> /. 1 ) = C114 by FINSEQ_4:16;
L382: ( Firing (( C113 ^ <* C114 *> ) , C112) ) = ( ( ( Firing (C113 , C112) ) +* ( ( *' { C114 } ) --> ( FALSE ) ) ) +* ( ( { C114 } *' ) --> ( TRUE ) ) ) by L381 , L380 , FINSEQ_1:39;
assume L383: ( C113 ^ <* C114 *> ) is_firable_on C112;
L384: <* C114 *> is_firable_on ( Firing (C113 , C112) ) by L383 , L243;
L385: C114 is_firable_on ( Firing (C113 , C112) ) by L384 , L343;
L386: ( ( Firing (C113 , C112) ) .: ( *' { C114 } ) ) c= { ( TRUE ) } by L385 , L49;
L387: ( ( Firing (C113 , C112) ) .: ( *' { C114 } ) ) misses { ( FALSE ) } by L386 , XBOOLE_1:63 , ZFMISC_1:11;
L388: ( *' { C114 } ) misses C111 by L387 , L377 , L383 , L10 , L243;
L389: (not C114 in ( *' C111 )) by L388 , L375 , PETRI:19;
L390: ( { C114 } *' ) misses C111 by L389 , PETRI:20;
thus L391: ( ( Firing (( C113 ^ <* C114 *> ) , C112) ) .: C111 ) = ( ( ( Firing (C113 , C112) ) +* ( ( *' { C114 } ) --> ( FALSE ) ) ) .: C111 ) by L390 , L382 , L19
.= { ( FALSE ) } by L377 , L383 , L387 , L10 , L19 , L243;
end;

end;
L379: S7[ ( <*> (the carrier' of C110) ) ] by L374 , L59;
thus L380: (for B89 being (FinSequence of (the carrier' of C110)) holds S7[ B89 ]) from FINSEQ_2:sch 2(L379 , L376);
end;

L381: ( rng D17 ) c= ( ( rng ( (the carrier of C110) --> ( TRUE ) ) ) \/ ( rng ( C111 --> ( FALSE ) ) ) ) by FUNCT_4:17;
L382: ( rng ( (the carrier of C110) --> ( TRUE ) ) ) c= { ( TRUE ) } by FUNCOP_1:13;
L383: ( rng ( (the carrier of C110) --> ( TRUE ) ) ) c= ( BOOLEAN ) by L382 , XBOOLE_1:1;
L384: ( ( rng ( (the carrier of C110) --> ( TRUE ) ) ) \/ ( rng ( C111 --> ( FALSE ) ) ) ) c= ( BOOLEAN ) by L383 , L371 , XBOOLE_1:8;
L385: ( rng D17 ) c= ( BOOLEAN ) by L384 , L381 , XBOOLE_1:1;
reconsider D18 = D17 as (Boolean_marking of C110) by L385 , L369 , FUNCT_2:def 2;
assume L386: (for B90 being (Boolean_marking of C110) holds (( B90 .: C111 ) = { ( FALSE ) } implies (for B91 being (FinSequence of (the carrier' of C110)) holds (B91 is_firable_on B90 implies ( ( Firing (B91 , B90) ) .: C111 ) = { ( FALSE ) }))));
assume L387: (not ( *' C111 ) is (Subset of ( C111 *' )));
consider C115 being (transition of C110) such that L388: C115 in ( *' C111 ) and L389: (not C115 in ( C111 *' )) by L387 , SUBSET_1:2;
L390: C111 misses ( *' { C115 } ) by L389 , PETRI:19;
L391: ( (( (the carrier of C110) --> ( TRUE ) ) qua Function) .: ( *' { C115 } ) ) = ( D18 .: ( *' { C115 } ) ) by L390 , L19;
reconsider D19 = <* C115 *> as (FinSequence of (the carrier' of C110));
L392: ( { C115 } *' ) meets C111 by L388 , PETRI:20;
consider C116 being set such that L393: C116 in ( ( { C115 } *' ) /\ C111 ) by L392 , XBOOLE_0:4;
L394: C116 in ( { C115 } *' ) by L393 , XBOOLE_0:def 4;
L395: ( ( Firing (C115 , D18) ) . C116 ) = ( TRUE ) by L394 , L116;
L396: C116 in C111 by L393 , XBOOLE_0:def 4;
L397: ( TRUE ) in ( ( Firing (C115 , D18) ) .: C111 ) by L396 , L395 , FUNCT_2:35;
L398: ( ( Firing (C115 , D18) ) .: C111 ) <> { ( FALSE ) } by L397 , TARSKI:def 1;
L399: ( ( Firing (D19 , D18) ) .: C111 ) <> { ( FALSE ) } by L398 , L357;
L400: (( rng ( (the carrier of C110) --> ( TRUE ) ) ) c= { ( TRUE ) } & ( ( (the carrier of C110) --> ( TRUE ) ) .: ( *' { C115 } ) ) c= ( rng ( (the carrier of C110) --> ( TRUE ) ) )) by FUNCOP_1:13 , RELAT_1:111;
L401: ( D18 .: ( *' { C115 } ) ) c= { ( TRUE ) } by L400 , L391 , XBOOLE_1:1;
L402: C115 is_firable_on D18 by L401 , L49;
L403: D19 is_firable_on D18 by L402 , L343;
L404: ( D18 .: C111 ) = { (( FALSE ) qua set) } by L99;
thus L405: contradiction by L404 , L386 , L403 , L399;
end;
