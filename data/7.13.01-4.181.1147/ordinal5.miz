:: Epsilon Numbers and Cantor Normal Form
::  by Grzegorz Bancerek
::
:: Received October 20, 2009
:: Copyright (c) 2009-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, ORDINAL1, ORDINAL2, TARSKI, MATROID0, XBOOLE_0, CARD_1,
      FINSET_1, AFINSQ_1, ORDINAL4, RELAT_1, FUNCT_1, VALUED_0, CARD_3,
      SUBSET_1, ARYTM_3, NAT_1, XXREAL_0, NEWTON, ORDINAL3, FINSEQ_1, ORDINAL5;
 notations XBOOLE_0, TARSKI, RELAT_1, FUNCT_1, SUBSET_1, FINSET_1, NUMBERS,
      MATROID0, ORDINAL1, NAT_1, XXREAL_0, NEWTON, ORDINAL2, AFINSQ_1,
      ORDINAL3, ORDINAL4, CARD_3;
 constructors NEWTON, NAT_1, AFINSQ_1, ORDINAL3, CARD_3;
 registrations XBOOLE_0, RELAT_1, FUNCT_1, ORDINAL1, NAT_1, XXREAL_0, XREAL_0,
      ORDINAL2, ORDINAL4, CARD_1, CARD_5, CARD_LAR, NEWTON, AFINSQ_1, FINSET_1;
 requirements SUBSET, BOOLE, NUMERALS, ARITHM, REAL;
 definitions TARSKI, XBOOLE_0, ORDINAL2, CARD_3;
 theorems TARSKI, FUNCT_1, FINSET_1, NAT_1, ORDERS_1, AFINSQ_1, RELAT_1,
      ORDINAL1, ORDINAL2, ORDINAL3, ORDINAL4, CARD_2, CARD_3, CARD_5, XBOOLE_0,
      XBOOLE_1, ZFMISC_1, NEWTON, XXREAL_0, NAT_4, PEPIN, CARD_1, XREGULAR;
 schemes NAT_1, ORDINAL1, ORDINAL2, AFINSQ_1;

begin
theorem
L1: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (R1 c= ( succ R2 ) implies (R1 c= R2 or R1 = ( succ R2 )))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L2: R1 c= ( succ R2 );
assume L3: R1 c/= R2;
L4: R2 in R1 by L3 , ORDINAL1:16;
thus L5: R1 c= ( succ R2 ) by L2;
thus L6: thesis by L4 , ORDINAL1:21;
end;
registration
cluster ( omega ) ->  limit_ordinal;
coherence;
cluster  ->  Ordinal-yielding for  empty  empty  empty  empty set;
coherence
proof
let C1 being  empty set;
take ( 0 );
thus L7: thesis;
end;
end;
registration
cluster non  empty  finite for T-Sequence;
existence
proof
set D1 = the set;
take <% D1 %>;
thus L9: thesis;
end;
end;
registration
let C2 being T-Sequence;
let C3 being non  empty T-Sequence;
cluster ( C2 ^ C3 ) -> non  empty;
coherence
proof
L11: ( ( dom C2 ) +^ ( dom C3 ) ) <> ( 0 ) by ORDINAL3:26;
L12: ( dom ( C2 ^ C3 ) ) <> ( 0 ) by L11 , ORDINAL4:def 1;
thus L13: thesis by L12;
end;
cluster ( C3 ^ C2 ) -> non  empty;
coherence
proof
L14: ( ( dom C3 ) +^ ( dom C2 ) ) <> ( 0 ) by ORDINAL3:26;
L15: ( dom ( C3 ^ C2 ) ) <> ( 0 ) by L14 , ORDINAL4:def 1;
thus L16: thesis by L15;
end;
end;
theorem
L18: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R10 being T-Sequence holds (( dom R10 ) = ( R1 +^ R2 ) implies (ex R11 being T-Sequence st (ex R12 being T-Sequence st (R10 = ( R11 ^ R12 ) & ( dom R11 ) = R1 & ( dom R12 ) = R2)))))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R10 being T-Sequence;
assume L19: ( dom R10 ) = ( R1 +^ R2 );
set D2 = ( R10 | R1 );
L20: R1 c= ( R1 +^ R2 ) by ORDINAL3:24;
L21: ( dom D2 ) = R1 by L20 , L19 , RELAT_1:62;
deffunc H1(Ordinal) = ( R10 . ( R1 +^ $1 ) );
consider R12 being T-Sequence such that L22: (( dom R12 ) = R2 & (for R3 being  ordinal number holds (R3 in R2 implies ( R12 . R3 ) = H1(R3)))) from ORDINAL2:sch 2;
take D2;
take R12;
set D3 = ( D2 ^ R12 );
L23: ( dom R10 ) = ( dom D3 ) by L19 , L21 , L22 , ORDINAL4:def 1;
L24:
now
let C4 being set;
assume L25: C4 in ( dom R10 );
reconsider D4 = C4 as Ordinal by L25;
per cases  by L19 , L25 , ORDINAL3:38;
suppose L26: D4 in R1;

thus L27: ( R10 . C4 ) = ( D2 . D4 ) by L26 , FUNCT_1:49
.= ( D3 . C4 ) by L26 , L21 , ORDINAL4:def 1;
end;
suppose L28: (ex R3 being  ordinal number st (R3 in R2 & D4 = ( R1 +^ R3 )));

consider R3 being  ordinal number such that L29: (R3 in R2 & D4 = ( R1 +^ R3 )) by L28;
thus L30: ( R10 . C4 ) = ( R12 . R3 ) by L22 , L29
.= ( D3 . C4 ) by L29 , L21 , L22 , ORDINAL4:def 1;
end;
end;
thus L32: thesis by L24 , L20 , L22 , L23 , FUNCT_1:2 , L19 , RELAT_1:62;
end;
theorem
L33: (for R11 being T-Sequence holds (for R12 being T-Sequence holds (( rng R11 ) c= ( rng ( R11 ^ R12 ) ) & ( rng R12 ) c= ( rng ( R11 ^ R12 ) ))))
proof
let R11 being T-Sequence;
let R12 being T-Sequence;
set D5 = ( R11 ^ R12 );
L34: ( dom D5 ) = ( ( dom R11 ) +^ ( dom R12 ) ) by ORDINAL4:def 1;
L35: ( dom R11 ) c= ( dom D5 ) by L34 , ORDINAL3:24;
thus L36: ( rng R11 ) c= ( rng ( R11 ^ R12 ) )
proof
let R9 being set;
assume L37: R9 in ( rng R11 );
consider C5 being set such that L38: (C5 in ( dom R11 ) & R9 = ( R11 . C5 )) by L37 , FUNCT_1:def 3;
reconsider D6 = C5 as Ordinal by L38;
L39: (( D5 . D6 ) = R9 & D6 in ( dom D5 )) by L38 , L35 , ORDINAL4:def 1;
thus L40: thesis by L39 , FUNCT_1:def 3;
end;

let R9 being set;
assume L41: R9 in ( rng R12 );
consider C6 being set such that L42: (C6 in ( dom R12 ) & R9 = ( R12 . C6 )) by L41 , FUNCT_1:def 3;
reconsider D7 = C6 as Ordinal by L42;
L43: (( D5 . ( ( dom R11 ) +^ D7 ) ) = R9 & ( ( dom R11 ) +^ D7 ) in ( dom D5 )) by L34 , L42 , ORDINAL3:17 , ORDINAL4:def 1;
thus L44: thesis by L43 , FUNCT_1:def 3;
end;
theorem
L45: (for R11 being T-Sequence holds (for R12 being T-Sequence holds (( R11 ^ R12 ) is  Ordinal-yielding implies (R11 is  Ordinal-yielding & R12 is  Ordinal-yielding))))
proof
let R11 being T-Sequence;
let R12 being T-Sequence;
given R1 being  ordinal number such that
L46: ( rng ( R11 ^ R12 ) ) c= R1;

thus L47: R11 is  Ordinal-yielding
proof
take R1;
L48: ( rng R11 ) c= ( rng ( R11 ^ R12 ) ) by L33;
thus L49: thesis by L48 , L46 , XBOOLE_1:1;
end;

take R1;
L50: ( rng R12 ) c= ( rng ( R11 ^ R12 ) ) by L33;
thus L51: thesis by L50 , L46 , XBOOLE_1:1;
end;
definition
let C7 being T-Sequence;
attr C7 is  decreasing
means
(for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom C7 )) implies ( C7 . R2 ) in ( C7 . R1 ))));
attr C7 is  non-decreasing
means
:L52: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom C7 )) implies ( C7 . R1 ) c= ( C7 . R2 ))));
attr C7 is  non-increasing
means
(for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom C7 )) implies ( C7 . R2 ) c= ( C7 . R1 ))));
end;
registration
cluster  increasing ->  non-decreasing for Ordinal-Sequence;
coherence
proof
let C8 being Ordinal-Sequence;
assume that
L54: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom C8 )) implies ( C8 . R1 ) in ( C8 . R2 ))));
let R1 being  ordinal number;
let R2 being  ordinal number;
L55: (( C8 . R1 ) in ( C8 . R2 ) implies ( C8 . R1 ) c= ( C8 . R2 )) by ORDINAL1:def 2;
thus L56: thesis by L55 , L54;
end;
cluster  decreasing ->  non-increasing for Ordinal-Sequence;
coherence
proof
let C9 being Ordinal-Sequence;
assume that
L57: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom C9 )) implies ( C9 . R2 ) in ( C9 . R1 ))));
let R1 being  ordinal number;
let R2 being  ordinal number;
L58: (( C9 . R2 ) in ( C9 . R1 ) implies ( C9 . R2 ) c= ( C9 . R1 )) by ORDINAL1:def 2;
thus L59: thesis by L58 , L57;
end;
end;
theorem
L61: (for B1 being T-Sequence holds (B1 is  infinite iff ( omega ) c= ( dom B1 )))
proof
let C10 being T-Sequence;
L62: (C10 is  infinite iff ( dom C10 ) is  infinite) by FINSET_1:10;
thus L63: thesis by L62 , CARD_3:85;
end;
registration
cluster  decreasing ->  finite for T-Sequence;
coherence
proof
let C11 being T-Sequence;
assume that
L64: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom C11 )) implies ( C11 . R2 ) in ( C11 . R1 ))));
set D8 = ( C11 .: ( omega ) );
assume L65: C11 is  infinite;
L66: (( 0 ) in ( omega ) & ( omega ) c= ( dom C11 )) by L65 , L61;
L67: ( C11 . ( 0 ) ) in D8 by L66 , FUNCT_1:def 6;
consider C12 being set such that L68: (C12 in D8 & D8 misses C12) by L67 , XREGULAR:1;
consider C13 being set such that L69: (C13 in ( dom C11 ) & C13 in ( omega ) & C12 = ( C11 . C13 )) by L68 , FUNCT_1:def 6;
reconsider D9 = C13 as Ordinal by L69;
L70: ( succ D9 ) in ( omega ) by L69 , ORDINAL1:28;
L71: (D9 in ( succ D9 ) & ( succ D9 ) in ( dom C11 )) by L70 , L66 , ORDINAL1:6;
L72: (( C11 . ( succ D9 ) ) in C12 & ( C11 . ( succ D9 ) ) in D8) by L71 , L64 , L69 , L70 , FUNCT_1:def 6;
thus L73: thesis by L72 , L68 , XBOOLE_0:3;
end;
cluster  ->  decreasing  increasing for  empty  empty  empty  empty set;
coherence
proof
let C14 being  empty set;
thus L74: C14 is  decreasing
proof
let R1 being  ordinal number;
thus L75: thesis;
end;

let R1 being  ordinal number;
thus L76: thesis;
end;
end;
registration
let R1 being  ordinal number;
cluster <% R1 %> ->  Ordinal-yielding;
coherence
proof
take ( succ R1 );
let R9 being set;
assume L78: R9 in ( rng <% R1 %> );
L79: R9 in { R1 } by L78 , AFINSQ_1:33;
L80: R9 = R1 by L79 , TARSKI:def 1;
thus L81: thesis by L80 , ORDINAL1:6;
end;
end;
registration
let R1 being  ordinal number;
cluster <% R1 %> ->  decreasing  increasing;
coherence
proof
set D10 = <% R1 %>;
L83: (( dom <% R1 %> ) = 1 & ( <% R1 %> . ( 0 ) ) = R1) by AFINSQ_1:def 4;
thus L84: (for R3 being  ordinal number holds (for R2 being  ordinal number holds ((R3 in R2 & R2 in ( dom D10 )) implies ( D10 . R2 ) in ( D10 . R3 )))) by L83 , ORDINAL3:15 , TARSKI:def 1;
let R3 being  ordinal number;
let R2 being  ordinal number;
thus L85: thesis by L83 , ORDINAL3:15 , TARSKI:def 1;
end;
end;
registration
cluster  decreasing  increasing  non-decreasing  non-increasing  finite non  empty for Ordinal-Sequence;
existence
proof
set D11 = the  ordinal number;
take <% D11 %>;
thus L87: thesis;
end;
end;
theorem
L89: (for B2 being  non-decreasing Ordinal-Sequence holds (( dom B2 ) is non  empty implies ( Union B2 ) is_limes_of B2))
proof
let C15 being  non-decreasing Ordinal-Sequence;
assume that
L90: ( dom C15 ) is non  empty;
set D12 = the (Element of ( dom C15 ));
per cases ;
case L91: ( Union C15 ) = ( {} );
take D12;
thus L92: D12 in ( dom C15 ) by L90;
let R3 being  ordinal number;
assume L93: (D12 c= R3 & R3 in ( dom C15 ));
L94: ( C15 . R3 ) in ( rng C15 ) by L93 , FUNCT_1:def 3;
thus L95: ( C15 . R3 ) = ( {} ) by L94 , L91 , ORDERS_1:6;
end;
case L96: ( Union C15 ) <> ( {} );
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L97: (R2 in ( Union C15 ) & ( Union C15 ) in R3);
consider C16 being set such that L98: (C16 in ( dom C15 ) & R2 in ( C15 . C16 )) by L97 , CARD_5:2;
reconsider D13 = C16 as Ordinal by L98;
take D13;
thus L99: D13 in ( dom C15 ) by L98;
let C17 being Ordinal;
assume L100: (D13 c= C17 & C17 in ( dom C15 ));
L101: (D13 = C17 or D13 c< C17) by L100 , XBOOLE_0:def 8;
L102: (D13 = C17 or D13 in C17) by L101 , ORDINAL1:11;
L103: ( C15 . D13 ) c= ( C15 . C17 ) by L102 , L100 , L52;
thus L104: R2 in ( C15 . C17 ) by L103 , L98;
L105: ( C15 . C17 ) in ( rng C15 ) by L100 , FUNCT_1:def 3;
L106: ( C15 . C17 ) c= ( Union C15 ) by L105 , ZFMISC_1:74;
thus L107: ( C15 . C17 ) in R3 by L106 , L97 , ORDINAL1:12;
end;
end;
theorem
L109: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R7 being Nat holds (R1 in R2 implies ( R7 *^ ( exp (( omega ) , R1) ) ) in ( exp (( omega ) , R2) )))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R7 being Nat;
assume L110: R1 in R2;
L111: ( succ R1 ) c= R2 by L110 , ORDINAL1:21;
L112: ( exp (( omega ) , ( succ R1 )) ) c= ( exp (( omega ) , R2) ) by L111 , ORDINAL4:27;
L113: ( exp (( omega ) , ( succ R1 )) ) = ( ( omega ) *^ ( exp (( omega ) , R1) ) ) by ORDINAL2:44;
L114: R7 in ( omega ) by ORDINAL1:def 12;
L115: ( R7 *^ ( exp (( omega ) , R1) ) ) in ( ( omega ) *^ ( exp (( omega ) , R1) ) ) by L114 , ORDINAL3:19 , ORDINAL4:22;
thus L116: thesis by L115 , L112 , L113;
end;
theorem
L117: (for R1 being  ordinal number holds (for R8 being Ordinal-Sequence holds ((( 0 ) in R1 & (for R2 being  ordinal number holds (R2 in ( dom R8 ) implies ( R8 . R2 ) = ( exp (R1 , R2) )))) implies R8 is  non-decreasing)))
proof
let R1 being  ordinal number;
let R8 being Ordinal-Sequence;
assume L118: (( 0 ) in R1 & (for R2 being  ordinal number holds (R2 in ( dom R8 ) implies ( R8 . R2 ) = ( exp (R1 , R2) ))));
let R2 being  ordinal number;
let R4 being  ordinal number;
assume L119: (R2 in R4 & R4 in ( dom R8 ));
L120: R2 in ( dom R8 ) by L119 , ORDINAL1:10;
L121: (R2 c= R4 & ( R8 . R2 ) = ( exp (R1 , R2) ) & ( R8 . R4 ) = ( exp (R1 , R4) )) by L120 , L118 , L119 , ORDINAL1:def 2;
thus L122: thesis by L121 , L118 , ORDINAL4:27;
end;
theorem
L123: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 is  limit_ordinal & ( 0 ) in R2) implies ( exp (R1 , R2) ) is  limit_ordinal)))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L124: (R1 is  limit_ordinal & ( 0 ) in R2);
per cases  by ORDINAL3:8;
suppose L125: R1 = ( 0 );

thus L126: thesis by L125 , L124 , ORDINAL4:20;
end;
suppose L127: ( 0 ) in R1;

defpred S1[ Ordinal ] means (( 0 ) in $1 implies ( exp (R1 , $1) ) is  limit_ordinal);
L128: S1[ ( {} ) ];
L129: (for R3 being  ordinal number holds (S1[ R3 ] implies S1[ ( succ R3 ) ]))
proof
let R3 being  ordinal number;
L130: ( exp (R1 , ( succ R3 )) ) = ( R1 *^ ( exp (R1 , R3) ) ) by ORDINAL2:44;
thus L131: thesis by L130 , L124 , ORDINAL3:40;
end;
L132: (for R3 being  ordinal number holds ((R3 <> ( {} ) & R3 is  limit_ordinal & (for R2 being  ordinal number holds (R2 in R3 implies S1[ R2 ]))) implies S1[ R3 ]))
proof
let R3 being  ordinal number;
assume that
L133: (R3 <> ( {} ) & R3 is  limit_ordinal)
and
L134: (for R2 being  ordinal number holds (R2 in R3 implies S1[ R2 ]));
deffunc H2(Ordinal) = ( exp (R1 , $1) );
consider R8 being Ordinal-Sequence such that L135: (( dom R8 ) = R3 & (for R2 being  ordinal number holds (R2 in R3 implies ( R8 . R2 ) = H2(R2)))) from ORDINAL2:sch 3;
L136: ( exp (R1 , R3) ) = ( lim R8 ) by L133 , L135 , ORDINAL2:45;
L137: R8 is  non-decreasing by L127 , L135 , L117;
L138: ( Union R8 ) is_limes_of R8 by L137 , L133 , L135 , L89;
L139: ( exp (R1 , R3) ) = ( Union R8 ) by L138 , L136 , ORDINAL2:def 10;
L140: (for R4 being  ordinal number holds (R4 in ( exp (R1 , R3) ) implies ( succ R4 ) in ( exp (R1 , R3) )))
proof
let R4 being  ordinal number;
assume L141: R4 in ( exp (R1 , R3) );
consider C18 being set such that L142: (C18 in ( dom R8 ) & R4 in ( R8 . C18 )) by L141 , L139 , CARD_5:2;
reconsider D14 = C18 as Ordinal by L142;
L143: ( succ D14 ) in ( dom R8 ) by L133 , L135 , L142 , ORDINAL1:28;
L144: (( R8 . D14 ) = H2(D14) & ( R8 . ( succ D14 ) ) = H2(( succ D14 )) & S1[ ( succ D14 ) ]) by L143 , L134 , L135 , L142;
L145: H2(D14) c= H2(( succ D14 )) by L127 , ORDINAL3:1 , ORDINAL4:27;
L146: ( succ R4 ) in ( R8 . ( succ D14 ) ) by L145 , L144 , L142 , ORDINAL1:28 , ORDINAL3:8;
thus L147: ( succ R4 ) in ( exp (R1 , R3) ) by L146 , L139 , L143 , CARD_5:2;
end;
thus L148: S1[ R3 ] by L140 , ORDINAL1:28;
end;
L149: (for R3 being  ordinal number holds S1[ R3 ]) from ORDINAL2:sch 1(L128 , L129 , L132);
thus L150: thesis by L149 , L124;
end;
end;
theorem
L152: (for R1 being  ordinal number holds (for R8 being Ordinal-Sequence holds ((1 in R1 & (for R2 being  ordinal number holds (R2 in ( dom R8 ) implies ( R8 . R2 ) = ( exp (R1 , R2) )))) implies R8 is  increasing)))
proof
let R1 being  ordinal number;
let R8 being Ordinal-Sequence;
assume L153: (1 in R1 & (for R2 being  ordinal number holds (R2 in ( dom R8 ) implies ( R8 . R2 ) = ( exp (R1 , R2) ))));
let R2 being  ordinal number;
let R4 being  ordinal number;
assume L154: (R2 in R4 & R4 in ( dom R8 ));
L155: (( R8 . R2 ) = ( exp (R1 , R2) ) & ( R8 . R4 ) = ( exp (R1 , R4) )) by L154 , L153 , ORDINAL1:10;
thus L156: thesis by L155 , L153 , L154 , ORDINAL4:24;
end;
theorem
L157: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R9 being set holds ((( 0 ) in R1 & R2 is non  empty  limit_ordinal) implies (R9 in ( exp (R1 , R2) ) iff (ex R3 being  ordinal number st (R3 in R2 & R9 in ( exp (R1 , R3) ))))))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R9 being set;
assume L158: (( 0 ) in R1 & R2 is non  empty  limit_ordinal);
deffunc H3(Ordinal) = ( exp (R1 , $1) );
consider R8 being Ordinal-Sequence such that L159: (( dom R8 ) = R2 & (for R3 being  ordinal number holds (R3 in R2 implies ( R8 . R3 ) = H3(R3)))) from ORDINAL2:sch 3;
L160: R8 is  non-decreasing by L158 , L159 , L117;
L161: ( Union R8 ) is_limes_of R8 by L160 , L158 , L159 , L89;
L162: ( Union R8 ) = ( lim R8 ) by L161 , ORDINAL2:def 10
.= ( exp (R1 , R2) ) by L158 , L159 , ORDINAL2:45;
thus L163:now
assume L164: R9 in ( exp (R1 , R2) );
consider C19 being set such that L165: (C19 in ( dom R8 ) & R9 in ( R8 . C19 )) by L164 , L162 , CARD_5:2;
reconsider D15 = C19 as Ordinal by L165;
take D16 = D15;
thus L166: D16 in R2 by L159 , L165;
thus L167: R9 in ( exp (R1 , D16) ) by L159 , L165;
end;
given R3 being  ordinal number such that
L168: (R3 in R2 & R9 in ( exp (R1 , R3) ));

L169: ( R8 . R3 ) = H3(R3) by L159 , L168;
thus L170: R9 in ( exp (R1 , R2) ) by L169 , L159 , L162 , L168 , CARD_5:2;
end;
theorem
L171: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R3 being  ordinal number holds ((( 0 ) in R1 & ( exp (R1 , R2) ) in ( exp (R1 , R3) )) implies R2 in R3))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L172: (( 0 ) in R1 & ( exp (R1 , R2) ) in ( exp (R1 , R3) ));
assume L173: (not R2 in R3);
L174: ( exp (R1 , R3) ) c= ( exp (R1 , R2) ) by L173 , L172 , ORDINAL1:16 , ORDINAL4:27;
L175: ( exp (R1 , R2) ) in ( exp (R1 , R2) ) by L174 , L172;
thus L176: thesis by L175;
end;
begin
definition
let C20 , C21 being Ordinal;
func C20 |^|^ C21 -> Ordinal means 
:L177: (ex B3 being Ordinal-Sequence st (it = ( last B3 ) & ( dom B3 ) = ( succ C21 ) & ( B3 . ( {} ) ) = 1 & (for B4 being Ordinal holds (( succ B4 ) in ( succ C21 ) implies ( B3 . ( succ B4 ) ) = ( exp (C20 , ( B3 . B4 )) ))) & (for B5 being Ordinal holds ((B5 in ( succ C21 ) & B5 <> ( {} ) & B5 is  limit_ordinal) implies ( B3 . B5 ) = ( lim ( B3 | B5 ) )))));
correctness
proof
deffunc H4(Ordinal , Ordinal) = ( exp (C20 , $2) );
deffunc H5(Ordinal , Ordinal-Sequence) = ( lim $2 );
L178: ((ex B6 being Ordinal st (ex B7 being Ordinal-Sequence st (B6 = ( last B7 ) & ( dom B7 ) = ( succ C21 ) & ( B7 . ( {} ) ) = 1 & (for B8 being Ordinal holds (( succ B8 ) in ( succ C21 ) implies ( B7 . ( succ B8 ) ) = H4(B8 , ( B7 . B8 )))) & (for B9 being Ordinal holds ((B9 in ( succ C21 ) & B9 <> ( {} ) & B9 is  limit_ordinal) implies ( B7 . B9 ) = H5(B9 , ( B7 | B9 ))))))) & (for B10 , B11 being Ordinal holds (((ex B12 being Ordinal-Sequence st (B10 = ( last B12 ) & ( dom B12 ) = ( succ C21 ) & ( B12 . ( {} ) ) = 1 & (for B13 being Ordinal holds (( succ B13 ) in ( succ C21 ) implies ( B12 . ( succ B13 ) ) = H4(B13 , ( B12 . B13 )))) & (for B14 being Ordinal holds ((B14 in ( succ C21 ) & B14 <> ( {} ) & B14 is  limit_ordinal) implies ( B12 . B14 ) = H5(B14 , ( B12 | B14 )))))) & (ex B15 being Ordinal-Sequence st (B11 = ( last B15 ) & ( dom B15 ) = ( succ C21 ) & ( B15 . ( {} ) ) = 1 & (for B16 being Ordinal holds (( succ B16 ) in ( succ C21 ) implies ( B15 . ( succ B16 ) ) = H4(B16 , ( B15 . B16 )))) & (for B17 being Ordinal holds ((B17 in ( succ C21 ) & B17 <> ( {} ) & B17 is  limit_ordinal) implies ( B15 . B17 ) = H5(B17 , ( B15 | B17 ))))))) implies B10 = B11))) from ORDINAL2:sch 13;
thus L179: thesis by L178;
end;
end;
theorem
L181: (for R1 being  ordinal number holds ( R1 |^|^ ( 0 ) ) = 1)
proof
let R1 being  ordinal number;
deffunc H6(Ordinal) = ( R1 |^|^ $1 );
deffunc H7(Ordinal , Ordinal-Sequence) = ( lim $2 );
deffunc H8(Ordinal , Ordinal) = ( exp (R1 , $2) );
L182: (for R2 being  ordinal number holds (for R3 being  ordinal number holds (R3 = H6(R2) iff (ex B18 being Ordinal-Sequence st (R3 = ( last B18 ) & ( dom B18 ) = ( succ R2 ) & ( B18 . ( {} ) ) = 1 & (for R3 being  ordinal number holds (( succ R3 ) in ( succ R2 ) implies ( B18 . ( succ R3 ) ) = H8(R3 , ( B18 . R3 )))) & (for R3 being  ordinal number holds ((R3 in ( succ R2 ) & R3 <> ( {} ) & R3 is  limit_ordinal) implies ( B18 . R3 ) = H7(R3 , ( B18 | R3 ))))))))) by L177;
thus L183: H6(( {} )) = 1 from ORDINAL2:sch 14(L182);
end;
theorem
L184: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ( R1 |^|^ ( succ R2 ) ) = ( exp (R1 , ( R1 |^|^ R2 )) )))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
deffunc H9(Ordinal) = ( R1 |^|^ $1 );
deffunc H10(Ordinal , Ordinal-Sequence) = ( lim $2 );
deffunc H11(Ordinal , Ordinal) = ( exp (R1 , $2) );
L185: (for R2 being  ordinal number holds (for R3 being  ordinal number holds (R3 = H9(R2) iff (ex B19 being Ordinal-Sequence st (R3 = ( last B19 ) & ( dom B19 ) = ( succ R2 ) & ( B19 . ( {} ) ) = 1 & (for R3 being  ordinal number holds (( succ R3 ) in ( succ R2 ) implies ( B19 . ( succ R3 ) ) = H11(R3 , ( B19 . R3 )))) & (for R3 being  ordinal number holds ((R3 in ( succ R2 ) & R3 <> ( {} ) & R3 is  limit_ordinal) implies ( B19 . R3 ) = H10(R3 , ( B19 | R3 ))))))))) by L177;
L186: (for R2 being  ordinal number holds H9(( succ R2 )) = H11(R2 , H9(R2))) from ORDINAL2:sch 15(L185);
thus L187: thesis by L186;
end;
theorem
L188: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R2 <> ( {} ) & R2 is  limit_ordinal) implies (for B20 being Ordinal-Sequence holds ((( dom B20 ) = R2 & (for R3 being  ordinal number holds (R3 in R2 implies ( B20 . R3 ) = ( R1 |^|^ R3 )))) implies ( R1 |^|^ R2 ) = ( lim B20 ))))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L189: (R2 <> ( {} ) & R2 is  limit_ordinal);
deffunc H12(Ordinal) = ( R1 |^|^ $1 );
deffunc H13(Ordinal , Ordinal-Sequence) = ( lim $2 );
deffunc H14(Ordinal , Ordinal) = ( exp (R1 , $2) );
let C22 being Ordinal-Sequence;
assume that
L190: ( dom C22 ) = R2
and
L191: (for R3 being  ordinal number holds (R3 in R2 implies ( C22 . R3 ) = H12(R3)));
L192: (for R2 being  ordinal number holds (for R3 being  ordinal number holds (R3 = H12(R2) iff (ex B21 being Ordinal-Sequence st (R3 = ( last B21 ) & ( dom B21 ) = ( succ R2 ) & ( B21 . ( {} ) ) = 1 & (for R3 being  ordinal number holds (( succ R3 ) in ( succ R2 ) implies ( B21 . ( succ R3 ) ) = H14(R3 , ( B21 . R3 )))) & (for R3 being  ordinal number holds ((R3 in ( succ R2 ) & R3 <> ( {} ) & R3 is  limit_ordinal) implies ( B21 . R3 ) = H13(R3 , ( B21 | R3 ))))))))) by L177;
thus L193: H12(R2) = H13(R2 , C22) from ORDINAL2:sch 16(L192 , L189 , L190 , L191);
end;
theorem
L194: (for R1 being  ordinal number holds ( R1 |^|^ 1 ) = R1)
proof
let R1 being  ordinal number;
L195: ( ( 0 ) + 1 ) = ( succ ( 0 ) );
thus L196: ( R1 |^|^ 1 ) = ( exp (R1 , ( R1 |^|^ ( 0 ) )) ) by L195 , L184
.= ( exp (R1 , 1) ) by L181
.= R1 by ORDINAL2:46;
end;
theorem
L197: (for R1 being  ordinal number holds ( 1 |^|^ R1 ) = 1)
proof
let R1 being  ordinal number;
defpred S2[ Ordinal ] means ( 1 |^|^ $1 ) = 1;
L198: S2[ ( {} ) ] by L181;
L199: (for R1 being  ordinal number holds (S2[ R1 ] implies S2[ ( succ R1 ) ]))
proof
let C23 being Ordinal;
assume L200: S2[ C23 ];
thus L201: ( 1 |^|^ ( succ C23 ) ) = ( exp (1 , 1) ) by L200 , L184
.= 1 by ORDINAL2:46;
end;
L202: (for B22 being Ordinal holds ((B22 <> ( {} ) & B22 is  limit_ordinal & (for B23 being Ordinal holds (B23 in B22 implies S2[ B23 ]))) implies S2[ B22 ]))
proof
let C24 being Ordinal;
assume that
L203: (C24 <> ( {} ) & C24 is  limit_ordinal)
and
L204: (for B24 being Ordinal holds (B24 in C24 implies ( 1 |^|^ B24 ) = 1));
deffunc H15(Ordinal) = ( 1 |^|^ $1 );
consider C25 being Ordinal-Sequence such that L205: (( dom C25 ) = C24 & (for B25 being Ordinal holds (B25 in C24 implies ( C25 . B25 ) = H15(B25)))) from ORDINAL2:sch 3;
L206: ( 1 |^|^ C24 ) = ( lim C25 ) by L203 , L205 , L188;
L207: ( rng C25 ) c= { 1 }
proof
let C26 being set;
assume L208: C26 in ( rng C25 );
consider C27 being set such that L209: (C27 in ( dom C25 ) & C26 = ( C25 . C27 )) by L208 , FUNCT_1:def 3;
reconsider D17 = C27 as Ordinal by L209;
L210: C26 = ( 1 |^|^ D17 ) by L205 , L209
.= 1 by L204 , L205 , L209;
thus L211: C26 in { 1 } by L210 , TARSKI:def 1;
end;
L212:
now
thus L213: ( {} ) <> 1;
let R2 being  ordinal number;
let R3 being  ordinal number;
assume that
L214: (R2 in 1 & 1 in R3);
set D18 = the (Element of C24);
reconsider D19 = D18 as Ordinal;
take D20 = D19;
thus L215: D20 in ( dom C25 ) by L203 , L205;
let C28 being Ordinal;
assume L216: (D20 c= C28 & C28 in ( dom C25 ));
L217: ( C25 . C28 ) in ( rng C25 ) by L216 , FUNCT_1:def 3;
thus L218: (R2 in ( C25 . C28 ) & ( C25 . C28 ) in R3) by L217 , L207 , L214 , TARSKI:def 1;
end;
L219: 1 is_limes_of C25 by L212 , ORDINAL2:def 9;
thus L220: ( 1 |^|^ C24 ) = 1 by L219 , L206 , ORDINAL2:def 10;
end;
L221: (for R1 being  ordinal number holds S2[ R1 ]) from ORDINAL2:sch 1(L198 , L199 , L202);
thus L222: thesis by L221;
end;
theorem
L223: (for R1 being  ordinal number holds ( R1 |^|^ 2 ) = ( exp (R1 , R1) ))
proof
let R1 being  ordinal number;
L224: 2 = ( succ 1 );
thus L225: ( R1 |^|^ 2 ) = ( exp (R1 , ( R1 |^|^ 1 )) ) by L224 , L184
.= ( exp (R1 , R1) ) by L194;
end;
theorem
L226: (for R1 being  ordinal number holds ( R1 |^|^ 3 ) = ( exp (R1 , ( exp (R1 , R1) )) ))
proof
let R1 being  ordinal number;
L227: 3 = ( succ 2 );
thus L228: ( R1 |^|^ 3 ) = ( exp (R1 , ( R1 |^|^ 2 )) ) by L227 , L184
.= ( exp (R1 , ( exp (R1 , R1) )) ) by L223;
end;
theorem
L229: (for B26 being Nat holds (( ( 0 ) |^|^ ( 2 * B26 ) ) = 1 & ( ( 0 ) |^|^ ( ( 2 * B26 ) + 1 ) ) = ( 0 )))
proof
defpred S3[ Nat ] means (( ( 0 ) |^|^ ( 2 * $1 ) ) = 1 & ( ( 0 ) |^|^ ( ( 2 * $1 ) + 1 ) ) = ( 0 ));
L230: S3[ ( 0 ) ] by L181 , L194;
L231:
now
let C29 being Nat;
assume L232: S3[ C29 ];
thus L233: S3[ ( C29 + 1 ) ]
proof
thus L234: ( ( 0 ) |^|^ ( 2 * ( C29 + 1 ) ) ) = ( ( 0 ) |^|^ ( ( ( 2 * C29 ) + 1 ) + 1 ) )
.= ( ( 0 ) |^|^ ( succ ( ( 2 * C29 ) + 1 ) ) ) by NAT_1:def 2
.= ( exp (( 0 ) , ( 0 )) ) by L232 , L184
.= 1 by ORDINAL2:43;
thus L235: ( ( 0 ) |^|^ ( ( 2 * ( C29 + 1 ) ) + 1 ) ) = ( ( 0 ) |^|^ ( succ ( 2 * ( C29 + 1 ) ) ) ) by NAT_1:def 2
.= ( exp (( 0 ) , 1) ) by L234 , L184
.= ( 0 ) by ORDINAL2:46;
end;

end;
thus L234: (for B27 being Nat holds S3[ B27 ]) from NAT_1:sch 2(L230 , L231);
end;
theorem
L235: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R3 being  ordinal number holds ((R1 c= R2 & ( 0 ) in R3) implies ( R3 |^|^ R1 ) c= ( R3 |^|^ R2 )))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R3 being  ordinal number;
assume that
L236: R1 c= R2
and
L237: ( 0 ) in R3;
L238: (( succ ( 0 ) ) c= R3 & ( succ ( 0 ) ) = ( ( 0 ) + 1 )) by L237 , ORDINAL1:21;
L239: (1 c< R3 or 1 = R3) by L238 , XBOOLE_0:def 8;
per cases  by L239 , ORDINAL1:11;
suppose L240: R3 = 1;

L241: (( R3 |^|^ R1 ) = 1 & ( R3 |^|^ R2 ) = 1) by L240 , L197;
thus L242: thesis by L241;
end;
suppose L243: 1 in R3;

defpred S4[ Ordinal ] means (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 c= R2 & R2 c= $1) implies ( R3 |^|^ R1 ) c= ( R3 |^|^ R2 ))));
L244: S4[ ( {} ) ]
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L245: (R1 c= R2 & R2 c= ( {} ));
L246: R2 = ( {} ) by L245;
thus L247: thesis by L246 , L245;
end;
L248:
now
let R4 being  ordinal number;
assume that
L249: S4[ R4 ];
L250: ( R3 |^|^ ( succ R4 ) ) = ( exp (R3 , ( R3 |^|^ R4 )) ) by L184;
L251: ( R3 |^|^ R4 ) c= ( R3 |^|^ ( succ R4 ) ) by L250 , L243 , ORDINAL4:32;
thus L252: S4[ ( succ R4 ) ]
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume that
L253: (R1 c= R2 & R2 c= ( succ R4 ));
L254: R1 c= ( succ R4 ) by L253 , XBOOLE_1:1;
per cases  by L253 , L254 , L1;
suppose L255: R2 c= R4;

thus L256: thesis by L255 , L249 , L253;
end;
suppose L257: (R2 = ( succ R4 ) & R1 = ( succ R4 ));

thus L258: thesis by L257;
end;
suppose L259: (R2 = ( succ R4 ) & R1 c= R4);

L260: ( R3 |^|^ R1 ) c= ( R3 |^|^ R4 ) by L259 , L249;
thus L261: thesis by L260 , L251 , L259 , XBOOLE_1:1;
end;
end;

end;
L253:
now
let R4 being  ordinal number;
assume that
L254: (R4 <> ( {} ) & R4 is  limit_ordinal)
and
L255: (for R5 being  ordinal number holds (R5 in R4 implies S4[ R5 ]));
deffunc H16(Ordinal) = ( R3 |^|^ $1 );
consider C30 being Ordinal-Sequence such that L256: (( dom C30 ) = R4 & (for R5 being  ordinal number holds (R5 in R4 implies ( C30 . R5 ) = H16(R5)))) from ORDINAL2:sch 3;
L257: C30 is  non-decreasing
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L258: (R1 in R2 & R2 in ( dom C30 ));
L259: (R1 c= R2 & S4[ R2 ]) by L258 , L255 , L256 , ORDINAL1:def 2;
L260: (( R3 |^|^ R1 ) c= ( R3 |^|^ R2 ) & R1 in R4 & ( C30 . R2 ) = H16(R2)) by L259 , L256 , L258 , ORDINAL1:12;
thus L261: thesis by L260 , L256;
end;
L262: ( Union C30 ) is_limes_of C30 by L257 , L254 , L256 , L89;
L263: ( R3 |^|^ R4 ) = ( lim C30 ) by L254 , L256 , L188;
L264: ( R3 |^|^ R4 ) = ( Union C30 ) by L263 , L262 , ORDINAL2:def 10;
thus L265: S4[ R4 ]
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L266: (R1 c= R2 & R2 c= R4);
L267: ((R2 c< R4 or R2 = R4) & (R1 c< R2 or R1 = R2)) by L266 , XBOOLE_0:def 8;
per cases  by L267 , ORDINAL1:11;
suppose L268: R2 in R4;

thus L269: H16(R1) c= H16(R2) by L268 , L266 , L255;
end;
suppose L270: (R2 = R4 & R1 in R4);

L271: (( C30 . R1 ) in ( rng C30 ) & ( C30 . R1 ) = H16(R1)) by L270 , L256 , FUNCT_1:def 3;
thus L272: H16(R1) c= H16(R2) by L271 , L264 , L270 , ZFMISC_1:74;
end;
suppose L273: (R2 = R4 & R1 = R4);

thus L274: H16(R1) c= H16(R2) by L273;
end;
end;

end;
L266: (for R2 being  ordinal number holds S4[ R2 ]) from ORDINAL2:sch 1(L244 , L248 , L253);
thus L267: thesis by L266 , L236;
end;
end;
theorem
L269: (for R1 being  ordinal number holds (for R8 being Ordinal-Sequence holds ((( 0 ) in R1 & (for R2 being  ordinal number holds (R2 in ( dom R8 ) implies ( R8 . R2 ) = ( R1 |^|^ R2 )))) implies R8 is  non-decreasing)))
proof
let R1 being  ordinal number;
let R8 being Ordinal-Sequence;
assume that
L270: ( 0 ) in R1
and
L271: (for R2 being  ordinal number holds (R2 in ( dom R8 ) implies ( R8 . R2 ) = ( R1 |^|^ R2 )));
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L272: (R2 in R3 & R3 in ( dom R8 ));
L273: R2 c= R3 by L272 , ORDINAL1:def 2;
L274: (( R1 |^|^ R2 ) c= ( R1 |^|^ R3 ) & ( R1 |^|^ R3 ) = ( R8 . R3 )) by L273 , L270 , L271 , L272 , L235;
thus L275: ( R8 . R2 ) c= ( R8 . R3 ) by L274 , L271 , L272 , ORDINAL1:10;
end;
theorem
L276: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((( 0 ) in R1 & ( 0 ) in R2) implies R1 c= ( R1 |^|^ R2 ))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L277: (( 0 ) in R1 & ( 0 ) in R2);
defpred S5[ Ordinal ] means (( 0 ) in $1 implies R1 c= ( R1 |^|^ $1 ));
L278: S5[ ( 0 ) ];
L279:
now
let R2 being  ordinal number;
assume L280: S5[ R2 ];
L281: ( R1 |^|^ ( succ R2 ) ) = ( exp (R1 , ( R1 |^|^ R2 )) ) by L184;
L282: ( succ ( 0 ) ) = ( ( 0 ) + 1 );
thus L283: S5[ ( succ R2 ) ]
proof
per cases  by ORDINAL3:8;
suppose L284: ( 0 ) in R2;

L285: 1 c= ( R1 |^|^ R2 ) by L284 , L282 , L277 , L280 , ORDINAL1:21;
L286: ( exp (R1 , 1) ) c= ( exp (R1 , ( R1 |^|^ R2 )) ) by L285 , L277 , ORDINAL4:27;
thus L287: thesis by L286 , L281 , ORDINAL2:46;
end;
suppose L288: R2 = ( 0 );

L289: ( R1 |^|^ R2 ) = 1 by L288 , L181;
thus L290: thesis by L289 , L281 , ORDINAL2:46;
end;
end;

end;
L284:
now
let R3 being  ordinal number;
assume that
L285: (R3 <> ( {} ) & R3 is  limit_ordinal & (for R2 being  ordinal number holds (R2 in R3 implies S5[ R2 ])));
deffunc H17(Ordinal) = ( R1 |^|^ $1 );
consider C31 being Ordinal-Sequence such that L286: (( dom C31 ) = R3 & (for R2 being  ordinal number holds (R2 in R3 implies ( C31 . R2 ) = H17(R2)))) from ORDINAL2:sch 3;
L287: C31 is  non-decreasing
proof
let R5 being  ordinal number;
let R2 being  ordinal number;
assume L288: (R5 in R2 & R2 in ( dom C31 ));
L289: (( C31 . R2 ) = H17(R2) & R5 in R3) by L288 , L286 , ORDINAL1:10;
L290: (( C31 . R5 ) = H17(R5) & R5 c= R2) by L289 , L286 , L288 , ORDINAL1:def 2;
thus L291: thesis by L290 , L277 , L289 , L235;
end;
L292: ( Union C31 ) is_limes_of C31 by L287 , L285 , L286 , L89;
L293: ( lim C31 ) = H17(R3) by L285 , L286 , L188;
L294: H17(R3) = ( Union C31 ) by L293 , L292 , ORDINAL2:def 10;
thus L295: S5[ R3 ]
proof
assume L296: ( 0 ) in R3;
L297: ( succ ( 0 ) ) in R3 by L296 , L285 , ORDINAL1:28;
L298: (( C31 . 1 ) in ( rng C31 ) & ( C31 . 1 ) = H17(1) & H17(1) = R1) by L297 , L286 , L194 , FUNCT_1:def 3;
thus L299: thesis by L298 , L294 , ZFMISC_1:74;
end;

end;
L296: (for R2 being  ordinal number holds S5[ R2 ]) from ORDINAL2:sch 1(L278 , L279 , L284);
thus L297: thesis by L296 , L277;
end;
theorem
L298: (for R1 being  ordinal number holds (for R6 being Nat holds (for R7 being Nat holds ((1 in R1 & R6 < R7) implies ( R1 |^|^ R6 ) in ( R1 |^|^ R7 )))))
proof
let R1 being  ordinal number;
let R6 being Nat;
let R7 being Nat;
assume L299: (1 in R1 & R6 < R7);
L300: ( R6 + 1 ) <= R7 by L299 , NAT_1:13;
consider C32 being Nat such that L301: R7 = ( ( R6 + 1 ) + C32 ) by L300 , NAT_1:10;
defpred S6[ Nat ] means ( R1 |^|^ $1 ) in ( R1 |^|^ ( $1 + 1 ) );
defpred S7[ Nat ] means ( R1 |^|^ R6 ) in ( R1 |^|^ ( ( R6 + 1 ) + $1 ) );
L302: ( R1 |^|^ ( 0 ) ) = 1 by L181;
L303: S6[ ( 0 ) ] by L302 , L299 , L194;
L304:
now
let R7 being Nat;
assume L305: S6[ R7 ];
L306: (( succ R7 ) = ( R7 + 1 ) & ( succ ( R7 + 1 ) ) = ( ( R7 + 1 ) + 1 )) by NAT_1:38;
L307: (( R1 |^|^ ( R7 + 1 ) ) = ( exp (R1 , ( R1 |^|^ R7 )) ) & ( R1 |^|^ ( ( R7 + 1 ) + 1 ) ) = ( exp (R1 , ( R1 |^|^ ( R7 + 1 ) )) )) by L306 , L184;
thus L308: S6[ ( R7 + 1 ) ] by L307 , L305 , L299 , ORDINAL4:24;
end;
L309: (for R7 being Nat holds S6[ R7 ]) from NAT_1:sch 2(L303 , L304);
L310: S7[ ( 0 ) ] by L309;
L311:
now
let C33 being Nat;
assume L312: S7[ C33 ];
L313: ( R1 |^|^ ( ( R6 + 1 ) + C33 ) ) in ( R1 |^|^ ( ( ( R6 + 1 ) + C33 ) + 1 ) ) by L309;
thus L314: S7[ ( C33 + 1 ) ] by L313 , L312 , ORDINAL1:10;
end;
L315: (for B28 being Nat holds S7[ B28 ]) from NAT_1:sch 2(L310 , L311);
thus L316: thesis by L315 , L301;
end;
theorem
L317: (for R1 being  ordinal number holds (for R8 being Ordinal-Sequence holds ((1 in R1 & ( dom R8 ) c= ( omega ) & (for R2 being  ordinal number holds (R2 in ( dom R8 ) implies ( R8 . R2 ) = ( R1 |^|^ R2 )))) implies R8 is  increasing)))
proof
let R1 being  ordinal number;
let R8 being Ordinal-Sequence;
assume that
L318: 1 in R1
and
L319: ( dom R8 ) c= ( omega )
and
L320: (for B29 being Ordinal holds (B29 in ( dom R8 ) implies ( R8 . B29 ) = ( R1 |^|^ B29 )));
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L321: (R2 in R3 & R3 in ( dom R8 ));
L322: R2 in ( dom R8 ) by L321 , ORDINAL1:10;
reconsider D21 = R2 , D22 = R3 as (Element of ( omega )) by L319 , L321 , ORDINAL1:10;
L323: (( R8 . D21 ) = ( R1 |^|^ D21 ) & ( R8 . D22 ) = ( R1 |^|^ D22 ) & D21 < D22) by L320 , L321 , L322 , NAT_1:44;
thus L324: thesis by L323 , L318 , L298;
end;
theorem
L325: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((1 in R1 & 1 in R2) implies R1 in ( R1 |^|^ R2 ))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L326: 1 in R1;
assume L327: 1 in R2;
L328: ( succ 1 ) c= R2 by L327 , ORDINAL1:21;
L329: ( 0 ) in 1 by NAT_1:44;
L330: ( 0 ) in R1 by L329 , L326 , ORDINAL1:10;
L331: (( R1 |^|^ 1 ) in ( R1 |^|^ 2 ) & ( R1 |^|^ 2 ) c= ( R1 |^|^ R2 )) by L330 , L326 , L328 , L235 , L298;
L332: ( R1 |^|^ 1 ) in ( R1 |^|^ R2 ) by L331;
thus L333: R1 in ( R1 |^|^ R2 ) by L332 , L194;
end;
theorem
L334: (for B30 , B31 being Nat holds ( exp (B30 , B31) ) = ( B30 |^ B31 ))
proof
let C34 being Nat;
defpred S8[ Nat ] means ( exp (C34 , $1) ) = ( C34 |^ $1 );
L335: ( exp (C34 , ( 0 )) ) = 1 by ORDINAL2:43;
L336: S8[ ( 0 ) ] by L335 , NEWTON:4;
L337:
now
let C35 being Nat;
assume that
L338: S8[ C35 ];
reconsider D23 = C34 , D24 = ( C34 |^ C35 ) as (Element of ( NAT )) by ORDINAL1:def 12;
L339: ( C35 + 1 ) = ( succ C35 ) by NAT_1:38;
L340: ( exp (C34 , ( C35 + 1 )) ) = ( C34 *^ ( exp (C34 , C35) ) ) by L339 , ORDINAL2:44
.= ( D23 * D24 ) by L338 , CARD_2:37;
thus L341: S8[ ( C35 + 1 ) ] by L340 , NEWTON:6;
end;
thus L342: (for B32 being Nat holds S8[ B32 ]) from NAT_1:sch 2(L336 , L337);
end;
registration
let C36 , C37 being Nat;
cluster ( exp (C36 , C37) ) ->  natural;
coherence
proof
L343: ( exp (C36 , C37) ) = ( C36 |^ C37 ) by L334;
thus L344: thesis by L343;
end;
end;
registration
let C38 , C39 being Nat;
cluster ( C38 |^|^ C39 ) ->  natural;
coherence
proof
defpred S9[ Nat ] means ( C38 |^|^ $1 ) is  natural;
L346: S9[ ( 0 ) ] by L181;
L347:
now
let C40 being Nat;
assume L348: S9[ C40 ];
reconsider D25 = ( C38 |^|^ C40 ) as Nat by L348;
L349: ( C40 + 1 ) = ( succ C40 ) by NAT_1:38;
L350: ( C38 |^|^ ( C40 + 1 ) ) = ( exp (C38 , D25) ) by L349 , L184;
thus L351: S9[ ( C40 + 1 ) ] by L350;
end;
L352: (for B33 being Nat holds S9[ B33 ]) from NAT_1:sch 2(L346 , L347);
thus L353: thesis by L352;
end;
end;
theorem
L355: (for B34 , B35 being Nat holds (B34 > 1 implies ( B34 |^|^ B35 ) > B35))
proof
let C41 , C42 being Nat;
assume that
L356: C41 > 1;
defpred S10[ Nat ] means ( C41 |^|^ $1 ) > $1;
L357: S10[ ( 0 ) ] by L181;
L358:
now
let C43 being Nat;
assume that
L359: S10[ C43 ];
L360: ( succ C43 ) = ( C43 + 1 ) by NAT_1:38;
L361: ( C41 |^|^ ( C43 + 1 ) ) = ( exp (C41 , ( C41 |^|^ C43 )) ) by L360 , L184
.= ( C41 |^ ( C41 |^|^ C43 ) ) by L334;
L362: ( C41 |^|^ ( C43 + 1 ) ) > ( C41 |^ C43 ) by L361 , L356 , L359 , PEPIN:66;
L363: ( C41 |^ C43 ) > C43 by L356 , NAT_4:3;
L364: ( C41 |^ C43 ) >= ( C43 + 1 ) by L363 , NAT_1:13;
thus L365: S10[ ( C43 + 1 ) ] by L364 , L362 , XXREAL_0:2;
end;
L366: (for B36 being Nat holds S10[ B36 ]) from NAT_1:sch 2(L357 , L358);
thus L367: thesis by L366;
end;
theorem
L368: (for B37 being Nat holds (B37 > 1 implies ( B37 |^|^ ( omega ) ) = ( omega )))
proof
let C44 being Nat;
assume that
L369: C44 > 1;
deffunc H18(Ordinal) = ( C44 |^|^ $1 );
consider C45 being Ordinal-Sequence such that L370: (( dom C45 ) = ( omega ) & (for R2 being  ordinal number holds (R2 in ( omega ) implies ( C45 . R2 ) = H18(R2)))) from ORDINAL2:sch 3;
L371: ( rng C45 ) c= ( omega )
proof
let C46 being set;
assume L372: C46 in ( rng C45 );
consider C47 being set such that L373: (C47 in ( dom C45 ) & C46 = ( C45 . C47 )) by L372 , FUNCT_1:def 3;
reconsider D26 = C47 as (Element of ( omega )) by L370 , L373;
L374: C46 = ( C44 |^|^ D26 ) by L370 , L373;
thus L375: thesis by L374 , ORDINAL1:def 12;
end;
L376: ( C44 |^|^ ( omega ) ) = ( lim C45 ) by L370 , L188;
L377:
now
thus L378: ( {} ) <> ( omega );
let R2 being  ordinal number;
let R3 being  ordinal number;
assume that
L379: (R2 in ( omega ) & ( omega ) in R3);
reconsider D27 = R2 as (Element of ( omega )) by L379;
take D28 = ( C44 |^|^ D27 );
thus L380: D28 in ( dom C45 ) by L370 , ORDINAL1:def 12;
L381: D27 < D28 by L369 , L355;
L382: R2 in D28 by L381 , NAT_1:44;
let C48 being Ordinal;
assume L383: (D28 c= C48 & C48 in ( dom C45 ));
reconsider D29 = C48 as (Element of ( omega )) by L383 , L370;
L384: (D27 < D29 & D29 < ( C44 |^|^ D29 )) by L369 , L355 , L382 , L383 , NAT_1:44;
L385: (D27 < ( C44 |^|^ D29 ) & ( C45 . D29 ) = H18(D29)) by L384 , L370 , XXREAL_0:2;
L386: ( C45 . C48 ) in ( rng C45 ) by L383 , FUNCT_1:def 3;
thus L387: (R2 in ( C45 . C48 ) & ( C45 . C48 ) in R3) by L386 , L379 , L385 , L371 , NAT_1:44 , ORDINAL1:10;
end;
L388: ( omega ) is_limes_of C45 by L377 , ORDINAL2:def 9;
thus L389: ( C44 |^|^ ( omega ) ) = ( omega ) by L388 , L376 , ORDINAL2:def 10;
end;
theorem
L390: (for R1 being  ordinal number holds (1 in R1 implies ( R1 |^|^ ( omega ) ) is  limit_ordinal))
proof
let R1 being  ordinal number;
assume L391: 1 in R1;
deffunc H19(Ordinal) = ( R1 |^|^ $1 );
consider C49 being Ordinal-Sequence such that L392: (( dom C49 ) = ( omega ) & (for R2 being  ordinal number holds (R2 in ( omega ) implies ( C49 . R2 ) = H19(R2)))) from ORDINAL2:sch 3;
L393: C49 is  increasing
proof
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L394: (R2 in R3 & R3 in ( dom C49 ));
reconsider D30 = R2 , D31 = R3 as (Element of ( NAT )) by L394 , L392 , ORDINAL1:10;
L395: D30 < D31 by L394 , NAT_1:44;
L396: (( C49 . D30 ) = H19(D30) & H19(D30) in H19(D31)) by L395 , L391 , L392 , L298;
thus L397: thesis by L396 , L392;
end;
L398: (( lim C49 ) = ( sup C49 ) & ( sup C49 ) is  limit_ordinal) by L393 , L392 , ORDINAL4:8 , ORDINAL4:16;
thus L399: thesis by L398 , L392 , L188;
end;
theorem
L400: (for R1 being  ordinal number holds (( 0 ) in R1 implies ( exp (R1 , ( R1 |^|^ ( omega ) )) ) = ( R1 |^|^ ( omega ) )))
proof
let R1 being  ordinal number;
assume L401: ( 0 ) in R1;
L402: (1 = ( succ ( 0 ) ) & ( succ ( 0 ) ) c= R1) by L401 , ORDINAL1:21;
L403: (1 = R1 or 1 c< R1) by L402 , XBOOLE_0:def 8;
per cases  by L403 , ORDINAL1:11;
suppose L404: R1 = 1;

thus L405: ( exp (R1 , ( R1 |^|^ ( omega ) )) ) = 1 by L404 , ORDINAL2:46
.= ( R1 |^|^ ( omega ) ) by L404 , L197;
end;
suppose L406: 1 in R1;

deffunc H20(Ordinal) = ( R1 |^|^ $1 );
deffunc H21(Ordinal) = ( exp (R1 , $1) );
consider C50 being Ordinal-Sequence such that L407: (( dom C50 ) = ( omega ) & (for R1 being  ordinal number holds (R1 in ( omega ) implies ( C50 . R1 ) = H20(R1)))) from ORDINAL2:sch 3;
consider C51 being Ordinal-Sequence such that L408: (( dom C51 ) = ( R1 |^|^ ( omega ) ) & (for R2 being  ordinal number holds (R2 in ( R1 |^|^ ( omega ) ) implies ( C51 . R2 ) = H21(R2)))) from ORDINAL2:sch 3;
L409: ( 0 ) in 1 by NAT_1:44;
L410: (( 0 ) in R1 & ( 0 ) in ( omega )) by L409 , L406 , ORDINAL1:10;
L411: R1 c= ( R1 |^|^ ( omega ) ) by L410 , L276;
L412: C51 is  increasing  increasing  increasing  increasing Ordinal-Sequence by L406 , L408 , ORDINAL4:25;
L413: (( lim C51 ) = ( exp (R1 , ( R1 |^|^ ( omega ) )) ) & ( Union C51 ) is_limes_of C51) by L412 , L408 , L411 , L89 , ORDINAL2:45 , L406 , L390;
L414: ( exp (R1 , ( R1 |^|^ ( omega ) )) ) = ( Union C51 ) by L413 , ORDINAL2:def 10;
L415: C50 is  increasing  increasing  increasing  increasing Ordinal-Sequence by L406 , L407 , L317;
L416: (( lim C50 ) = ( R1 |^|^ ( omega ) ) & ( Union C50 ) is_limes_of C50) by L415 , L407 , L188 , L89;
L417: ( R1 |^|^ ( omega ) ) = ( Union C50 ) by L416 , ORDINAL2:def 10;
thus L418: ( exp (R1 , ( R1 |^|^ ( omega ) )) ) c= ( R1 |^|^ ( omega ) )
proof
let C52 being set;
assume L419: C52 in ( exp (R1 , ( R1 |^|^ ( omega ) )) );
consider C53 being set such that L420: (C53 in ( dom C51 ) & C52 in ( C51 . C53 )) by L419 , L414 , CARD_5:2;
consider C54 being set such that L421: (C54 in ( dom C50 ) & C53 in ( C50 . C54 )) by L408 , L417 , L420 , CARD_5:2;
reconsider D32 = C53 as Ordinal by L420;
reconsider D33 = C54 as (Element of ( omega )) by L407 , L421;
L422: ( exp (R1 , D32) ) in ( exp (R1 , ( C50 . D33 )) ) by L406 , L421 , ORDINAL4:24;
L423: ( succ D33 ) in ( omega ) by ORDINAL1:28;
L424: (( C51 . D32 ) = H21(D32) & ( C50 . D33 ) = H20(D33) & ( C50 . ( succ D33 ) ) = H20(( succ D33 ))) by L423 , L420 , L407 , L408;
L425: ( C51 . D32 ) in ( C50 . ( succ D33 ) ) by L424 , L422 , L184;
L426: C52 in ( C50 . ( succ D33 ) ) by L425 , L420 , ORDINAL1:10;
thus L427: thesis by L426 , L407 , L417 , L423 , CARD_5:2;
end;

thus L428: ( R1 |^|^ ( omega ) ) c= ( exp (R1 , ( R1 |^|^ ( omega ) )) ) by L406 , ORDINAL4:32;
end;
end;
theorem
L430: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((( 0 ) in R1 & ( omega ) c= R2) implies ( R1 |^|^ R2 ) = ( R1 |^|^ ( omega ) ))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L431: ( 0 ) in R1;
assume L432: ( omega ) c= R2;
L433: R2 = ( ( omega ) +^ ( R2 -^ ( omega ) ) ) by L432 , ORDINAL3:def 5;
defpred S11[ Ordinal ] means ( R1 |^|^ ( ( omega ) +^ $1 ) ) = ( R1 |^|^ ( omega ) );
L434: S11[ ( {} ) ] by ORDINAL2:27;
L435: (for R3 being  ordinal number holds (S11[ R3 ] implies S11[ ( succ R3 ) ]))
proof
let R3 being  ordinal number;
assume L436: S11[ R3 ];
L437: ( exp (R1 , ( R1 |^|^ ( ( omega ) +^ R3 ) )) ) = ( R1 |^|^ ( omega ) ) by L436 , L431 , L400;
thus L438: ( R1 |^|^ ( ( omega ) +^ ( succ R3 ) ) ) = ( R1 |^|^ ( succ ( ( omega ) +^ R3 ) ) ) by ORDINAL2:28
.= ( R1 |^|^ ( omega ) ) by L437 , L184;
end;
L439: (for R3 being  ordinal number holds ((R3 <> ( {} ) & R3 is  limit_ordinal & (for R2 being  ordinal number holds (R2 in R3 implies S11[ R2 ]))) implies S11[ R3 ]))
proof
let R3 being  ordinal number;
assume L440: (R3 <> ( {} ) & R3 is  limit_ordinal);
assume L441: (for R2 being  ordinal number holds (R2 in R3 implies S11[ R2 ]));
deffunc H22(Ordinal) = ( R1 |^|^ $1 );
consider R8 being Ordinal-Sequence such that L442: (( dom R8 ) = ( ( omega ) +^ R3 ) & (for R2 being  ordinal number holds (R2 in ( ( omega ) +^ R3 ) implies ( R8 . R2 ) = H22(R2)))) from ORDINAL2:sch 3;
L443: (( ( omega ) +^ R3 ) <> ( {} ) & ( ( omega ) +^ R3 ) is  limit_ordinal) by L440 , ORDINAL3:26 , ORDINAL3:29;
L444: ( R1 |^|^ ( ( omega ) +^ R3 ) ) = ( lim R8 ) by L443 , L442 , L188;
L445:
now
L446: R1 c= ( R1 |^|^ ( omega ) ) by L431 , L276;
thus L447: ( R1 |^|^ ( omega ) ) <> ( {} ) by L446 , L431;
let C55 , C56 being Ordinal;
assume L448: (C55 in ( R1 |^|^ ( omega ) ) & ( R1 |^|^ ( omega ) ) in C56);
take D34 = ( omega );
L449: (( ( omega ) +^ (( {} ) qua Ordinal) ) = ( omega ) & ( {} ) in R3) by L440 , ORDINAL2:27 , ORDINAL3:8;
thus L450: D34 in ( dom R8 ) by L449 , L442 , ORDINAL2:32;
let C57 being Ordinal;
assume L451: (D34 c= C57 & C57 in ( dom R8 ));
L452: ( C57 -^ D34 ) in ( ( ( omega ) +^ R3 ) -^ ( omega ) ) by L451 , L442 , ORDINAL3:53;
L453: ( C57 -^ D34 ) in R3 by L452 , ORDINAL3:52;
L454: S11[ ( C57 -^ D34 ) ] by L453 , L441;
L455: ( R1 |^|^ ( omega ) ) = ( R1 |^|^ C57 ) by L454 , L451 , ORDINAL3:def 5;
thus L456: (C55 in ( R8 . C57 ) & ( R8 . C57 ) in C56) by L455 , L442 , L448 , L451;
end;
L457: ( R1 |^|^ ( omega ) ) is_limes_of R8 by L445 , ORDINAL2:def 9;
thus L458: S11[ R3 ] by L457 , L444 , ORDINAL2:def 10;
end;
L459: (for R3 being  ordinal number holds S11[ R3 ]) from ORDINAL2:sch 1(L434 , L435 , L439);
thus L460: ( R1 |^|^ R2 ) = ( R1 |^|^ ( omega ) ) by L459 , L433;
end;
begin
L461: ( {} ) in ( omega ) by ORDINAL1:def 11;
scheme CriticalNumber2 { F1() -> Ordinal , F2() -> Ordinal-Sequence , F3(Ordinal) -> Ordinal } : (F1() c= ( Union F2() ) & F3(( Union F2() )) = ( Union F2() ) & (for R2 being  ordinal number holds ((F1() c= R2 & F3(R2) = R2) implies ( Union F2() ) c= R2)))
provided
L462: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (R1 in R2 implies F3(R1) in F3(R2))))
and
L463: (for R1 being  ordinal number holds (R1 is non  empty  limit_ordinal implies (for B38 being Ordinal-Sequence holds ((( dom B38 ) = R1 & (for R2 being  ordinal number holds (R2 in R1 implies ( B38 . R2 ) = F3(R2)))) implies F3(R1) is_limes_of B38))))
and
L464: (( dom F2() ) = ( omega ) & ( F2() . ( 0 ) ) = F1())
and
L465: (for R1 being  ordinal number holds (R1 in ( omega ) implies ( F2() . ( succ R1 ) ) = F3(( F2() . R1 ))))
proof
L466: F1() in ( rng F2() ) by L464 , FUNCT_1:def 3;
thus L467: F1() c= ( Union F2() ) by L466 , ZFMISC_1:74;
set D35 = F2();
L468:
now
defpred S12[ Ordinal ] means (not $1 c= F3($1));
assume L469: (ex R1 being  ordinal number st S12[ R1 ]);
consider R1 being  ordinal number such that L470: S12[ R1 ] and L471: (for R2 being  ordinal number holds (S12[ R2 ] implies R1 c= R2)) from ORDINAL1:sch 1(L469);
L472: F3(F3(R1)) in F3(R1) by L462 , L470 , ORDINAL1:16;
L473: (not F3(R1) c= F3(F3(R1))) by L472 , ORDINAL1:5;
thus L474: contradiction by L473 , L470 , L471;
end;
L475: F1() c= F3(F1()) by L468;
L476: (F1() c< F3(F1()) or F1() = F3(F1())) by L475 , XBOOLE_0:def 8;
per cases  by L476 , ORDINAL1:11;
suppose L477: F3(F1()) = F1();

L478: (for B39 being set holds (B39 in ( omega ) implies ( F2() . B39 ) = F1()))
proof
let C58 being set;
assume L479: C58 in ( omega );
reconsider D36 = C58 as (Element of ( omega )) by L479;
defpred S13[ Nat ] means ( F2() . $1 ) = F1();
L480: S13[ ( 0 ) ] by L464;
L481:
now
let C59 being Nat;
assume L482: S13[ C59 ];
L483: C59 in ( omega ) by ORDINAL1:def 12;
L484: ( F2() . ( succ C59 ) ) = F3(F1()) by L483 , L465 , L482;
thus L485: S13[ ( C59 + 1 ) ] by L484 , L477 , NAT_1:38;
end;
L486: (for B40 being Nat holds S13[ B40 ]) from NAT_1:sch 2(L480 , L481);
L487: S13[ D36 ] by L486;
thus L488: thesis by L487;
end;
L489: ( rng F2() ) = { F1() }
proof
thus L490: ( rng F2() ) c= { F1() }
proof
let C60 being set;
assume L491: C60 in ( rng F2() );
consider C61 being set such that L492: (C61 in ( dom F2() ) & C60 = ( F2() . C61 )) by L491 , FUNCT_1:def 3;
L493: C60 = F1() by L478 , L492 , L464;
thus L494: thesis by L493 , TARSKI:def 1;
end;

thus L495: thesis by L466 , ZFMISC_1:31;
end;
L496: ( Union F2() ) = F1() by L489 , ZFMISC_1:25;
thus L497: (F3(( Union F2() )) = ( Union F2() ) & (for R2 being  ordinal number holds ((F1() c= R2 & F3(R2) = R2) implies ( Union F2() ) c= R2))) by L496 , L477;
end;
suppose L498: F1() in F3(F1());

deffunc H23(Ordinal , Ordinal) = F3($2);
deffunc H24(Ordinal , T-Sequence) = ( {} );
L499:
now
let R1 being  ordinal number;
assume that
L500: ( succ R1 ) in ( omega );
L501: R1 in ( succ R1 ) by ORDINAL1:6;
thus L502: ( D35 . ( succ R1 ) ) = H23(R1 , ( D35 . R1 )) by L501 , L465 , L500 , ORDINAL1:10;
end;
L503: (for R1 being  ordinal number holds (R1 in ( omega ) implies (F1() c= ( D35 . R1 ) & ( D35 . R1 ) in ( D35 . ( succ R1 ) ))))
proof
let R1 being  ordinal number;
assume L504: R1 in ( omega );
reconsider D37 = R1 as (Element of ( omega )) by L504;
defpred S14[ Nat ] means (F1() c= ( D35 . $1 ) & ( D35 . $1 ) in ( D35 . ( succ $1 ) ));
L505: S14[ ( 0 ) ] by L498 , L464 , L465;
L506:
now
let C62 being Nat;
assume L507: S14[ C62 ];
L508: (( C62 + 1 ) = ( succ C62 ) & ( ( C62 + 1 ) + 1 ) = ( succ ( C62 + 1 ) ) & ( C62 + 1 ) in ( omega ) & ( ( C62 + 1 ) + 1 ) in ( omega )) by NAT_1:38;
L509: (( D35 . ( C62 + 1 ) ) = F3(( D35 . C62 )) & ( D35 . ( ( C62 + 1 ) + 1 ) ) = F3(( D35 . ( C62 + 1 ) ))) by L508 , L499;
L510: (( D35 . C62 ) c= ( D35 . ( C62 + 1 ) ) & ( D35 . ( C62 + 1 ) ) in ( D35 . ( ( C62 + 1 ) + 1 ) )) by L509 , L462 , L468 , L507 , L508;
thus L511: S14[ ( C62 + 1 ) ] by L510 , L507 , NAT_1:38 , XBOOLE_1:1;
end;
L512: (for B41 being Nat holds S14[ B41 ]) from NAT_1:sch 2(L505 , L506);
L513: S14[ D37 ] by L512;
thus L514: thesis by L513;
end;
deffunc H25(Ordinal) = F3($1);
consider C63 being Ordinal-Sequence such that L515: (( dom C63 ) = ( Union D35 ) & (for R1 being  ordinal number holds (R1 in ( Union D35 ) implies ( C63 . R1 ) = H25(R1)))) from ORDINAL2:sch 3;
L516: 1 = ( succ ( 0 ) );
L517: ( F2() . 1 ) = H25(F1()) by L516 , L464 , L465;
L518: H25(F1()) in ( rng D35 ) by L517 , L464 , FUNCT_1:def 3;
L519: H25(F1()) c= ( Union D35 ) by L518 , ZFMISC_1:74;
L520:
now
let R3 being  ordinal number;
assume L521: R3 in ( Union D35 );
consider C64 being set such that L522: (C64 in ( dom D35 ) & R3 in ( D35 . C64 )) by L521 , CARD_5:2;
reconsider D38 = C64 as (Element of ( omega )) by L464 , L522;
L523: (( succ R3 ) c= ( D35 . D38 ) & ( D35 . D38 ) in ( D35 . ( succ D38 ) )) by L503 , L522 , ORDINAL1:21;
L524: (( succ R3 ) in ( D35 . ( succ D38 ) ) & ( succ D38 ) in ( omega )) by L523 , ORDINAL1:12 , ORDINAL1:def 12;
thus L525: ( succ R3 ) in ( Union D35 ) by L524 , L464 , CARD_5:2;
end;
L526: ( Union D35 ) is  limit_ordinal by L520 , ORDINAL1:28;
L527: H25(( Union D35 )) is_limes_of C63 by L526 , L463 , L515 , L519 , L498;
L528: C63 is  increasing
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L529: (R1 in R2 & R2 in ( dom C63 ));
L530: (( C63 . R1 ) = H25(R1) & ( C63 . R2 ) = H25(R2)) by L529 , L515 , ORDINAL1:10;
thus L531: thesis by L530 , L462 , L529;
end;
L532: ( sup C63 ) = ( lim C63 ) by L528 , L515 , L519 , L526 , ORDINAL4:8 , L498
.= H25(( Union D35 )) by L527 , ORDINAL2:def 10;
thus L533: H25(( Union D35 )) c= ( Union D35 )
proof
let C65 being set;
assume L534: C65 in H25(( Union D35 ));
reconsider D39 = C65 as Ordinal by L534;
consider R2 being  ordinal number such that L535: (R2 in ( rng C63 ) & D39 c= R2) by L532 , L534 , ORDINAL2:21;
consider C66 being set such that L536: (C66 in ( dom C63 ) & R2 = ( C63 . C66 )) by L535 , FUNCT_1:def 3;
reconsider D40 = C66 as Ordinal by L536;
consider C67 being set such that L537: (C67 in ( dom D35 ) & D40 in ( D35 . C67 )) by L515 , L536 , CARD_5:2;
reconsider D41 = C67 as Ordinal by L537;
set D42 = ( D35 . D41 );
L538: ( succ D41 ) in ( omega ) by L464 , L537 , ORDINAL1:28;
L539: (( D35 . ( succ D41 ) ) = H25(D42) & ( D35 . ( succ D41 ) ) in ( rng D35 ) & R2 = H25(D40)) by L538 , L464 , L499 , L515 , L536 , FUNCT_1:def 3;
L540: (R2 in H25(D42) & H25(D42) c= ( Union D35 )) by L539 , L462 , L537 , ZFMISC_1:74;
thus L541: thesis by L540 , L535 , ORDINAL1:12;
end;

thus L542: ( Union F2() ) c= H25(( Union F2() )) by L468;
let R2 being  ordinal number;
assume L543: (F1() c= R2 & H25(R2) = R2);
L544: ( rng F2() ) c= R2
proof
let C68 being set;
assume L545: C68 in ( rng F2() );
consider C69 being set such that L546: (C69 in ( dom F2() ) & C68 = ( F2() . C69 )) by L545 , FUNCT_1:def 3;
reconsider D43 = C69 as (Element of ( omega )) by L464 , L546;
defpred S15[ Nat ] means ( F2() . $1 ) in R2;
L547: F1() <> R2 by L498 , L543;
L548: F1() c< R2 by L547 , L543 , XBOOLE_0:def 8;
L549: S15[ ( 0 ) ] by L548 , L464 , ORDINAL1:11;
L550:
now
let C70 being Nat;
assume L551: S15[ C70 ];
L552: (H25(( F2() . C70 )) in R2 & C70 in ( omega )) by L551 , L462 , L543 , ORDINAL1:def 12;
L553: ( F2() . ( succ C70 ) ) in R2 by L552 , L465;
thus L554: S15[ ( C70 + 1 ) ] by L553 , NAT_1:38;
end;
L555: (for B42 being Nat holds S15[ B42 ]) from NAT_1:sch 2(L549 , L550);
L556: S15[ D43 ] by L555;
thus L557: thesis by L556 , L546;
end;
L558: (( Union F2() ) c= ( union R2 ) & ( union R2 ) c= R2) by L544 , ORDINAL2:5 , ZFMISC_1:77;
thus L559: ( Union F2() ) c= R2 by L558 , XBOOLE_1:1;
end;
end;
scheme CriticalNumber3 { F4() -> Ordinal , F5(Ordinal) -> Ordinal } : (ex R1 being  ordinal number st (F4() in R1 & F5(R1) = R1))
provided
L561: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (R1 in R2 implies F5(R1) in F5(R2))))
and
L562: (for R1 being  ordinal number holds (R1 is non  empty  limit_ordinal implies (for B43 being Ordinal-Sequence holds ((( dom B43 ) = R1 & (for R2 being  ordinal number holds (R2 in R1 implies ( B43 . R2 ) = F5(R2)))) implies F5(R1) is_limes_of B43))))
proof
assume L563: (not thesis);
deffunc H26(Ordinal , Ordinal) = F5($2);
deffunc H27(Ordinal , T-Sequence) = ( {} );
consider C71 being Ordinal-Sequence such that L564: ( dom C71 ) = ( omega ) and L565: (( {} ) in ( omega ) implies ( C71 . ( {} ) ) = ( succ F4() )) and L566: (for R1 being  ordinal number holds (( succ R1 ) in ( omega ) implies ( C71 . ( succ R1 ) ) = H26(R1 , ( C71 . R1 )))) and L567: (for R1 being  ordinal number holds ((R1 in ( omega ) & R1 <> ( {} ) & R1 is  limit_ordinal) implies ( C71 . R1 ) = H27(R1 , ( C71 | R1 )))) from ORDINAL2:sch 11;
L568:
now
defpred S16[ Ordinal ] means (not $1 c= F5($1));
assume L569: (ex R1 being  ordinal number st S16[ R1 ]);
consider R1 being  ordinal number such that L570: S16[ R1 ] and L571: (for R2 being  ordinal number holds (S16[ R2 ] implies R1 c= R2)) from ORDINAL1:sch 1(L569);
L572: F5(F5(R1)) in F5(R1) by L561 , L570 , ORDINAL1:16;
L573: (not F5(R1) c= F5(F5(R1))) by L572 , ORDINAL1:5;
thus L574: contradiction by L573 , L570 , L571;
end;
L575:
now
let R1 being  ordinal number;
assume L576: F4() in R1;
L577: (R1 c= F5(R1) & R1 <> F5(R1)) by L576 , L563 , L568;
L578: R1 c< F5(R1) by L577 , XBOOLE_0:def 8;
thus L579: R1 in F5(R1) by L578 , ORDINAL1:11;
end;
L580: (for R1 being  ordinal number holds (R1 in ( omega ) implies F4() in ( C71 . R1 )))
proof
let R1 being  ordinal number;
assume L581: R1 in ( omega );
reconsider D44 = R1 as (Element of ( omega )) by L581;
defpred S17[ Nat ] means F4() in ( C71 . $1 );
L582: S17[ ( 0 ) ] by L565 , ORDINAL1:6;
L583:
now
let C72 being Nat;
assume L584: S17[ C72 ];
L585: (( C72 + 1 ) = ( succ C72 ) & ( C72 + 1 ) in ( omega )) by NAT_1:38;
L586: ( C71 . ( C72 + 1 ) ) = F5(( C71 . C72 )) by L585 , L566;
L587: ( C71 . C72 ) in ( C71 . ( C72 + 1 ) ) by L586 , L584 , L575;
thus L588: S17[ ( C72 + 1 ) ] by L587 , L584 , ORDINAL1:10;
end;
L589: (for B44 being Nat holds S17[ B44 ]) from NAT_1:sch 2(L582 , L583);
L590: S17[ D44 ] by L589;
thus L591: thesis by L590;
end;
L592: C71 is  increasing
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L593: (R1 in R2 & R2 in ( dom C71 ));
L594: (ex R3 being  ordinal number st (R2 = ( R1 +^ R3 ) & R3 <> ( {} ))) by L593 , ORDINAL3:28;
defpred S18[ Ordinal ] means ((( R1 +^ $1 ) in ( omega ) & $1 <> ( {} )) implies ( C71 . R1 ) in ( C71 . ( R1 +^ $1 ) ));
L595: S18[ ( {} ) ];
L596: (for R3 being  ordinal number holds (S18[ R3 ] implies S18[ ( succ R3 ) ]))
proof
let R3 being  ordinal number;
assume that
L597: ((( R1 +^ R3 ) in ( omega ) & R3 <> ( {} )) implies ( C71 . R1 ) in ( C71 . ( R1 +^ R3 ) ))
and
L598: (( R1 +^ ( succ R3 ) ) in ( omega ) & ( succ R3 ) <> ( {} ));
L599: (( R1 +^ R3 ) in ( succ ( R1 +^ R3 ) ) & ( R1 +^ ( succ R3 ) ) = ( succ ( R1 +^ R3 ) )) by ORDINAL1:6 , ORDINAL2:28;
reconsider D45 = ( C71 . ( R1 +^ R3 ) ) as Ordinal;
L600: ( R1 +^ R3 ) in ( omega ) by L598 , L599 , ORDINAL1:10;
L601: (( C71 . ( R1 +^ ( succ R3 ) ) ) = F5(D45) & D45 in F5(D45) & ( R1 +^ (( {} ) qua Ordinal) ) = R1) by L600 , L566 , L575 , L598 , L599 , L580 , ORDINAL2:27;
thus L602: thesis by L601 , L597 , L598 , L599 , ORDINAL1:10;
end;
L603: (for R2 being  ordinal number holds ((R2 <> ( {} ) & R2 is  limit_ordinal & (for R3 being  ordinal number holds (R3 in R2 implies S18[ R3 ]))) implies S18[ R2 ]))
proof
let R2 being  ordinal number;
assume that
L604: (R2 <> ( {} ) & R2 is  limit_ordinal)
and
L605: (for R3 being  ordinal number holds (R3 in R2 implies ((( R1 +^ R3 ) in ( omega ) & R3 <> ( {} )) implies ( C71 . R1 ) in ( C71 . ( R1 +^ R3 ) ))))
and
L606: (( R1 +^ R2 ) in ( omega ) & R2 <> ( {} ));
L607: ( R1 +^ R2 ) <> ( {} ) by L606 , ORDINAL3:26;
L608: (( R1 +^ R2 ) is  limit_ordinal & ( {} ) in ( R1 +^ R2 )) by L607 , L604 , ORDINAL3:8 , ORDINAL3:29;
thus L609: thesis by L608 , L606;
end;
L610: (for R3 being  ordinal number holds S18[ R3 ]) from ORDINAL2:sch 1(L595 , L596 , L603);
thus L611: thesis by L610 , L564 , L593 , L594;
end;
deffunc H28(Ordinal) = F5($1);
consider C73 being Ordinal-Sequence such that L612: (( dom C73 ) = ( sup C71 ) & (for R1 being  ordinal number holds (R1 in ( sup C71 ) implies ( C73 . R1 ) = H28(R1)))) from ORDINAL2:sch 3;
L613: (( succ F4() ) in ( rng C71 ) & ( sup ( rng C71 ) ) = ( sup C71 )) by L564 , L565 , L461 , FUNCT_1:def 3;
L614: (( sup C71 ) <> ( {} ) & ( sup C71 ) is  limit_ordinal) by L613 , L564 , L592 , ORDINAL2:19 , ORDINAL4:16;
L615: H28(( sup C71 )) is_limes_of C73 by L614 , L562 , L612;
L616: C73 is  increasing
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L617: (R1 in R2 & R2 in ( dom C73 ));
L618: (( C73 . R1 ) = H28(R1) & ( C73 . R2 ) = H28(R2)) by L617 , L612 , ORDINAL1:10;
thus L619: thesis by L618 , L561 , L617;
end;
L620: ( sup C73 ) = ( lim C73 ) by L616 , L612 , L614 , ORDINAL4:8
.= H28(( sup C71 )) by L615 , ORDINAL2:def 10;
L621: ( sup C73 ) c= ( sup C71 )
proof
let C74 being set;
assume L622: C74 in ( sup C73 );
reconsider D46 = C74 as Ordinal by L622;
consider R2 being  ordinal number such that L623: (R2 in ( rng C73 ) & D46 c= R2) by L622 , ORDINAL2:21;
consider C75 being set such that L624: (C75 in ( dom C73 ) & R2 = ( C73 . C75 )) by L623 , FUNCT_1:def 3;
reconsider D47 = C75 as Ordinal by L624;
consider R3 being  ordinal number such that L625: (R3 in ( rng C71 ) & D47 c= R3) by L612 , L624 , ORDINAL2:21;
consider C76 being set such that L626: (C76 in ( dom C71 ) & R3 = ( C71 . C76 )) by L625 , FUNCT_1:def 3;
reconsider D48 = C76 as Ordinal by L626;
L627: ( succ D48 ) in ( omega ) by L564 , L626 , ORDINAL1:28;
L628: (( C71 . ( succ D48 ) ) = H28(R3) & ( C71 . ( succ D48 ) ) in ( rng C71 ) & R2 = H28(D47)) by L627 , L564 , L566 , L612 , L624 , L626 , FUNCT_1:def 3;
L629: (D47 c< R3 iff (D47 <> R3 & D47 c= R3)) by XBOOLE_0:def 8;
L630: (H28(D47) in H28(R3) or D47 = R3) by L629 , L561 , L625 , ORDINAL1:11;
L631: (R2 c= H28(R3) & H28(R3) in ( sup C71 )) by L630 , L628 , ORDINAL1:def 2 , ORDINAL2:19;
L632: R2 in ( sup C71 ) by L631 , ORDINAL1:12;
thus L633: thesis by L632 , L623 , ORDINAL1:12;
end;
L634: ( C71 . ( 0 ) ) in ( rng C71 ) by L564 , FUNCT_1:def 3;
L635: (F4() in ( C71 . ( 0 ) ) & ( C71 . ( 0 ) ) in ( sup C71 )) by L634 , L580 , ORDINAL2:19;
L636: F4() in ( sup C71 ) by L635 , ORDINAL1:10;
thus L637: contradiction by L636 , L575 , L620 , L621 , ORDINAL1:5;
end;
begin
definition
let C77 being  ordinal number;
attr C77 is  epsilon
means
:L638: ( exp (( omega ) , C77) ) = C77;
end;
theorem
L640: (for R1 being  ordinal number holds (ex R2 being  ordinal number st (R1 in R2 & R2 is  epsilon)))
proof
let R1 being  ordinal number;
deffunc H29(Ordinal) = ( exp (( omega ) , $1) );
L641: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (R1 in R2 implies H29(R1) in H29(R2)))) by ORDINAL4:24;
L642:
now
let R1 being  ordinal number;
assume that
L643: R1 is non  empty  limit_ordinal;
let C78 being Ordinal-Sequence;
assume that
L644: (( dom C78 ) = R1 & (for R2 being  ordinal number holds (R2 in R1 implies ( C78 . R2 ) = H29(R2))));
L645: C78 is  non-decreasing
proof
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L646: (R2 in R3 & R3 in ( dom C78 ));
L647: (( C78 . R2 ) = H29(R2) & ( C78 . R3 ) = H29(R3)) by L646 , L644 , ORDINAL1:10;
L648: ( C78 . R2 ) in ( C78 . R3 ) by L647 , L646 , ORDINAL4:24;
thus L649: thesis by L648 , ORDINAL1:def 2;
end;
L650: (( Union C78 ) is_limes_of C78 & H29(R1) = ( lim C78 )) by L645 , L643 , L644 , L89 , ORDINAL2:45;
thus L651: H29(R1) is_limes_of C78 by L650 , ORDINAL2:def 10;
end;
consider R2 being  ordinal number such that L652: (R1 in R2 & H29(R2) = R2) from CriticalNumber3(L641 , L642);
take R2;
thus L653: R1 in R2 by L652;
thus L654: ( exp (( omega ) , R2) ) = R2 by L652;
end;
registration
cluster  epsilon for  ordinal  ordinal  ordinal  ordinal number;
existence
proof
L655: (ex R1 being  ordinal number st (( 0 ) in R1 & R1 is  epsilon)) by L640;
thus L656: thesis by L655;
end;
end;
definition
let C79 being Ordinal;
func first_epsilon_greater_than C79 ->  epsilon Ordinal means 
:L658: (C79 in it & (for B45 being  epsilon Ordinal holds (C79 in B45 implies it c= B45)));
existence
proof
defpred S19[ Ordinal ] means (C79 in $1 & $1 is  epsilon);
L659: (ex R3 being  ordinal number st S19[ R3 ]) by L640;
consider R3 being  ordinal number such that L660: (S19[ R3 ] & (for R2 being  ordinal number holds (S19[ R2 ] implies R3 c= R2))) from ORDINAL1:sch 1(L659);
reconsider D49 = R3 as  epsilon Ordinal by L660;
take D49;
thus L661: thesis by L660;
end;
uniqueness
proof
let C80 , C81 being  epsilon Ordinal;
assume that
L662: (C79 in C80 & (for B46 being  epsilon Ordinal holds (C79 in B46 implies C80 c= B46)))
and
L663: (C79 in C81 & (for B47 being  epsilon Ordinal holds (C79 in B47 implies C81 c= B47)));
thus L664: (C80 c= C81 & C81 c= C80) by L662 , L663;
end;
end;
theorem
L666: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (R1 c= R2 implies ( first_epsilon_greater_than R1 ) c= ( first_epsilon_greater_than R2 ))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L667: R1 c= R2;
L668: R2 in ( first_epsilon_greater_than R2 ) by L658;
L669: R1 in ( first_epsilon_greater_than R2 ) by L668 , L667 , ORDINAL1:12;
thus L670: thesis by L669 , L658;
end;
theorem
L671: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( first_epsilon_greater_than R1 )) implies ( first_epsilon_greater_than R2 ) = ( first_epsilon_greater_than R1 ))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L672: (R1 in R2 & R2 in ( first_epsilon_greater_than R1 ));
L673:
now
let C82 being  epsilon Ordinal;
assume L674: R2 in C82;
L675: R1 in C82 by L674 , L672 , ORDINAL1:10;
thus L676: ( first_epsilon_greater_than R1 ) c= C82 by L675 , L658;
end;
thus L677: ( first_epsilon_greater_than R2 ) = ( first_epsilon_greater_than R1 ) by L673 , L672 , L658;
end;
theorem
L678: ( first_epsilon_greater_than ( 0 ) ) = ( ( omega ) |^|^ ( omega ) )
proof
deffunc H30(Ordinal) = ( exp (( omega ) , $1) );
L679: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (R1 in R2 implies H30(R1) in H30(R2)))) by ORDINAL4:24;
L680:
now
let R1 being  ordinal number;
assume that
L681: R1 is non  empty  limit_ordinal;
let C83 being Ordinal-Sequence;
assume that
L682: (( dom C83 ) = R1 & (for R2 being  ordinal number holds (R2 in R1 implies ( C83 . R2 ) = H30(R2))));
L683: C83 is  non-decreasing
proof
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L684: (R2 in R3 & R3 in ( dom C83 ));
L685: (( C83 . R2 ) = H30(R2) & ( C83 . R3 ) = H30(R3)) by L684 , L682 , ORDINAL1:10;
L686: ( C83 . R2 ) in ( C83 . R3 ) by L685 , L684 , ORDINAL4:24;
thus L687: thesis by L686 , ORDINAL1:def 2;
end;
L688: (( Union C83 ) is_limes_of C83 & H30(R1) = ( lim C83 )) by L683 , L681 , L682 , L89 , ORDINAL2:45;
thus L689: H30(R1) is_limes_of C83 by L688 , ORDINAL2:def 10;
end;
deffunc H31(Ordinal , Ordinal) = H30($2);
deffunc H32(Ordinal , Ordinal-Sequence) = ( lim $2 );
consider C84 being Ordinal-Sequence such that L690: ( dom C84 ) = ( omega ) and L691: (( {} ) in ( omega ) implies ( C84 . ( {} ) ) = 1) and L692: (for R1 being  ordinal number holds (( succ R1 ) in ( omega ) implies ( C84 . ( succ R1 ) ) = H31(R1 , ( C84 . R1 )))) and L693: (for R1 being  ordinal number holds ((R1 in ( omega ) & R1 <> ( {} ) & R1 is  limit_ordinal) implies ( C84 . R1 ) = H32(R1 , ( C84 | R1 )))) from ORDINAL2:sch 11;
L694: (( dom C84 ) = ( omega ) & ( C84 . ( 0 ) ) = 1) by L690 , L691;
L695:
now
let R1 being  ordinal number;
assume L696: R1 in ( omega );
L697: ( succ R1 ) in ( omega ) by L696 , ORDINAL1:28;
thus L698: ( C84 . ( succ R1 ) ) = H30(( C84 . R1 )) by L697 , L692;
end;
L699: (1 c= ( Union C84 ) & H30(( Union C84 )) = ( Union C84 ) & (for R2 being  ordinal number holds ((1 c= R2 & H30(R2) = R2) implies ( Union C84 ) c= R2))) from CriticalNumber2(L679 , L680 , L694 , L695);
L700: ( Union C84 ) is  epsilon
proof
thus L701: H30(( Union C84 )) = ( Union C84 ) by L699;
end;
reconsider D50 = ( Union C84 ) as  epsilon Ordinal by L700;
defpred S20[ Nat ] means ( C84 . $1 ) = ( ( omega ) |^|^ $1 );
L702: S20[ ( 0 ) ] by L691 , L181;
L703: (for R7 being Nat holds (S20[ R7 ] implies S20[ ( R7 + 1 ) ]))
proof
let R7 being Nat;
assume that
L704: S20[ R7 ];
L705: (( R7 + 1 ) = ( succ R7 ) & R7 in ( omega )) by NAT_1:38 , ORDINAL1:def 12;
thus L706: ( C84 . ( R7 + 1 ) ) = H30(( C84 . R7 )) by L705 , L695
.= ( ( omega ) |^|^ ( R7 + 1 ) ) by L704 , L705 , L184;
end;
L707: (for R7 being Nat holds S20[ R7 ]) from NAT_1:sch 2(L702 , L703);
L708: (for R3 being  ordinal number holds (R3 in ( omega ) implies ( C84 . R3 ) = ( ( omega ) |^|^ R3 ))) by L707;
L709: ( ( omega ) |^|^ ( omega ) ) = ( lim C84 ) by L708 , L690 , L188;
L710: C84 is  non-decreasing
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L711: (R1 in R2 & R2 in ( dom C84 ));
reconsider D51 = R1 , D52 = R2 as (Element of ( omega )) by L711 , L690 , ORDINAL1:10;
L712: R1 c= R2 by L711 , ORDINAL1:def 2;
L713: ( ( omega ) |^|^ R1 ) c= ( ( omega ) |^|^ R2 ) by L712 , L235;
L714: ( C84 . D51 ) c= ( ( omega ) |^|^ D52 ) by L713 , L707;
thus L715: thesis by L714 , L707;
end;
L716: D50 is_limes_of C84 by L710 , L690 , L89;
L717: ( ( omega ) |^|^ ( omega ) ) = D50 by L716 , L709 , ORDINAL2:def 10;
L718: ( succ ( 0 ) ) = 1;
L719: ( 0 ) in 1 by L718 , ORDINAL1:6;
L720:
now
let C85 being  epsilon Ordinal;
assume L721: ( 0 ) in C85;
L722: (1 c= C85 & H30(C85) = C85) by L721 , L718 , L638 , ORDINAL1:21;
thus L723: D50 c= C85 by L722 , L699;
end;
thus L724: thesis by L720 , L717 , L719 , L658 , L699;
end;
theorem
L725: (for B48 being  epsilon Ordinal holds ( omega ) in B48)
proof
let C86 being  epsilon Ordinal;
L726: ( exp (( omega ) , C86) ) = C86 by L638;
L727: (( exp (( omega ) , ( 0 )) ) = 1 & ( exp (( omega ) , 1) ) = ( omega ) & 1 in ( omega )) by ORDINAL2:43 , ORDINAL2:46;
L728: (C86 <> ( 0 ) & C86 <> 1 & ( succ ( 0 ) ) = 1 & ( succ 1 ) = 2) by L727 , L638;
L729: ( 0 ) in C86 by L728 , ORDINAL3:8;
L730: 1 c= C86 by L729 , L728 , ORDINAL1:21;
L731: 1 c< C86 by L730 , L728 , XBOOLE_0:def 8;
L732: 1 in C86 by L731 , ORDINAL1:11;
thus L733: thesis by L732 , L726 , L727 , ORDINAL4:24;
end;
registration
cluster  epsilon -> non  empty  limit_ordinal for Ordinal;
coherence
proof
let C87 being Ordinal;
assume that
L734: C87 is  epsilon;
L735: ( exp (( omega ) , ( 0 )) ) = 1 by ORDINAL2:43;
thus L736: C87 is non  empty by L735 , L734 , L638;
L737: (( 0 ) in C87 & ( exp (( omega ) , C87) ) = C87) by L736 , L734 , L638 , ORDINAL3:8;
thus L738: thesis by L737 , L123;
end;
end;
theorem
L740: (for B49 being  epsilon Ordinal holds ( exp (( omega ) , ( exp (B49 , ( omega )) )) ) = ( exp (B49 , ( exp (B49 , ( omega )) )) ))
proof
let C88 being  epsilon Ordinal;
thus L741: ( exp (( omega ) , ( exp (C88 , ( omega )) )) ) = ( exp (( omega ) , ( exp (C88 , ( 1 +^ ( omega ) )) )) ) by CARD_2:74
.= ( exp (( omega ) , ( ( exp (C88 , ( omega )) ) *^ ( exp (C88 , 1) ) )) ) by ORDINAL4:30
.= ( exp (( omega ) , ( ( exp (C88 , ( omega )) ) *^ C88 )) ) by ORDINAL2:46
.= ( exp (( exp (( omega ) , C88) ) , ( exp (C88 , ( omega )) )) ) by ORDINAL4:31
.= ( exp (C88 , ( exp (C88 , ( omega )) )) ) by L638;
end;
theorem
L742: (for R7 being Nat holds (for B50 being  epsilon Ordinal holds (( 0 ) in R7 implies ( B50 |^|^ ( R7 + 2 ) ) = ( exp (( omega ) , ( B50 |^|^ ( R7 + 1 ) )) ))))
proof
let R7 being Nat;
let C89 being  epsilon Ordinal;
assume that
L743: ( 0 ) in R7;
L744: ( 0 ) in C89 by ORDINAL3:8;
L745: (( omega ) in C89 & C89 c= ( C89 |^|^ R7 )) by L744 , L743 , L276 , L725;
L746: ( omega ) c= ( C89 |^|^ R7 ) by L745 , ORDINAL1:def 2;
thus L747: ( C89 |^|^ ( R7 + 2 ) ) = ( C89 |^|^ ( ( R7 + 1 ) + 1 ) )
.= ( C89 |^|^ ( succ ( R7 + 1 ) ) ) by NAT_1:38
.= ( exp (C89 , ( C89 |^|^ ( R7 + 1 ) )) ) by L184
.= ( exp (( exp (( omega ) , C89) ) , ( C89 |^|^ ( R7 + 1 ) )) ) by L638
.= ( exp (( omega ) , ( ( C89 |^|^ ( R7 + 1 ) ) *^ C89 )) ) by ORDINAL4:31
.= ( exp (( omega ) , ( ( C89 |^|^ ( succ R7 ) ) *^ C89 )) ) by NAT_1:38
.= ( exp (( omega ) , ( ( exp (C89 , ( C89 |^|^ R7 )) ) *^ C89 )) ) by L184
.= ( exp (( omega ) , ( ( exp (C89 , ( C89 |^|^ R7 )) ) *^ ( exp (C89 , 1) ) )) ) by ORDINAL2:46
.= ( exp (( omega ) , ( exp (C89 , ( 1 +^ ( C89 |^|^ R7 ) )) )) ) by ORDINAL4:30
.= ( exp (( omega ) , ( exp (C89 , ( C89 |^|^ R7 )) )) ) by L746 , CARD_2:74
.= ( exp (( omega ) , ( C89 |^|^ ( succ R7 ) )) ) by L184
.= ( exp (( omega ) , ( C89 |^|^ ( R7 + 1 ) )) ) by NAT_1:38;
end;
theorem
L748: (for B51 being  epsilon Ordinal holds ( first_epsilon_greater_than B51 ) = ( B51 |^|^ ( omega ) ))
proof
let C90 being  epsilon Ordinal;
deffunc H33(Ordinal) = ( exp (( omega ) , $1) );
L749: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (R1 in R2 implies H33(R1) in H33(R2)))) by ORDINAL4:24;
L750:
now
let R1 being  ordinal number;
assume that
L751: R1 is non  empty  limit_ordinal;
let C91 being Ordinal-Sequence;
assume that
L752: (( dom C91 ) = R1 & (for R2 being  ordinal number holds (R2 in R1 implies ( C91 . R2 ) = H33(R2))));
L753: C91 is  non-decreasing
proof
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L754: (R2 in R3 & R3 in ( dom C91 ));
L755: (( C91 . R2 ) = H33(R2) & ( C91 . R3 ) = H33(R3)) by L754 , L752 , ORDINAL1:10;
L756: ( C91 . R2 ) in ( C91 . R3 ) by L755 , L754 , ORDINAL4:24;
thus L757: thesis by L756 , ORDINAL1:def 2;
end;
L758: (( Union C91 ) is_limes_of C91 & H33(R1) = ( lim C91 )) by L753 , L751 , L752 , L89 , ORDINAL2:45;
thus L759: H33(R1) is_limes_of C91 by L758 , ORDINAL2:def 10;
end;
deffunc H34(Ordinal , Ordinal) = H33($2);
deffunc H35(Ordinal , Ordinal-Sequence) = ( lim $2 );
consider C92 being Ordinal-Sequence such that L760: ( dom C92 ) = ( omega ) and L761: (( {} ) in ( omega ) implies ( C92 . ( {} ) ) = ( succ C90 )) and L762: (for R1 being  ordinal number holds (( succ R1 ) in ( omega ) implies ( C92 . ( succ R1 ) ) = H34(R1 , ( C92 . R1 )))) and L763: (for R1 being  ordinal number holds ((R1 in ( omega ) & R1 <> ( {} ) & R1 is  limit_ordinal) implies ( C92 . R1 ) = H35(R1 , ( C92 | R1 )))) from ORDINAL2:sch 11;
L764: (( dom C92 ) = ( omega ) & ( C92 . ( 0 ) ) = ( succ C90 )) by L760 , L761;
L765:
now
let R1 being  ordinal number;
assume L766: R1 in ( omega );
L767: ( succ R1 ) in ( omega ) by L766 , ORDINAL1:28;
thus L768: ( C92 . ( succ R1 ) ) = H33(( C92 . R1 )) by L767 , L762;
end;
L769: (( succ C90 ) c= ( Union C92 ) & H33(( Union C92 )) = ( Union C92 ) & (for R2 being  ordinal number holds ((( succ C90 ) c= R2 & H33(R2) = R2) implies ( Union C92 ) c= R2))) from CriticalNumber2(L749 , L750 , L764 , L765);
L770: ( Union C92 ) is  epsilon
proof
thus L771: H33(( Union C92 )) = ( Union C92 ) by L769;
end;
reconsider D53 = ( Union C92 ) as  epsilon Ordinal by L770;
L772:
now
L773: C90 in ( succ C90 ) by ORDINAL1:6;
thus L774: C90 in D53 by L773 , L769;
let C93 being  epsilon Ordinal;
assume L775: C90 in C93;
L776: (( succ C90 ) c= C93 & H33(C93) = C93) by L775 , L638 , ORDINAL1:21;
thus L777: D53 c= C93 by L776 , L769;
end;
L778: (( succ ( 0 ) ) = 1 & ( succ 1 ) = 2 & ( succ 2 ) = 3);
L779: ( C92 . 1 ) = H33(( succ C90 )) by L778 , L761 , L762
.= ( ( omega ) *^ H33(C90) ) by ORDINAL2:44
.= ( ( omega ) *^ C90 ) by L638;
L780: ( C92 . 2 ) = H33(( ( omega ) *^ C90 )) by L779 , L778 , L762
.= ( exp (H33(C90) , ( omega )) ) by ORDINAL4:31
.= ( exp (C90 , ( omega )) ) by L638;
L781: ( C92 . 3 ) = H33(( exp (C90 , ( omega )) )) by L780 , L778 , L762
.= ( exp (C90 , ( exp (C90 , ( omega )) )) ) by L740;
L782: (( C90 |^|^ ( 0 ) ) = 1 & ( C90 |^|^ 1 ) = C90 & ( C90 |^|^ 2 ) = ( exp (C90 , C90) )) by L181 , L194 , L223;
L783: (( omega ) in C90 & 1 in ( omega )) by L725;
L784: 1 in C90 by L783 , ORDINAL1:10;
L785: (( exp (C90 , 1) ) in ( exp (C90 , C90) ) & ( exp (C90 , 1) ) in ( exp (C90 , ( omega )) )) by L784 , ORDINAL4:24;
L786: (C90 in ( exp (C90 , C90) ) & C90 in ( exp (C90 , ( omega )) )) by L785 , ORDINAL2:46;
defpred S21[ Nat ] means (( C90 |^|^ $1 ) in ( C92 . ( $1 + 1 ) ) & ( C92 . $1 ) in ( C90 |^|^ ( $1 + 2 ) ));
L787: (C90 in ( exp (C90 , C90) ) & ( exp (C90 , C90) ) is  limit_ordinal) by L782 , L784 , L298 , L123 , ORDINAL3:8;
L788: S21[ ( 0 ) ] by L787 , L761 , L779 , L782 , ORDINAL1:28 , ORDINAL3:32;
L789: (for R7 being Nat holds (S21[ R7 ] implies S21[ ( R7 + 1 ) ]))
proof
let R7 being Nat;
assume that
L790: S21[ R7 ];
L791: (( R7 + 1 ) = ( succ R7 ) & ( ( R7 + 1 ) + 1 ) = ( succ ( R7 + 1 ) ) & R7 in ( omega ) & ( R7 + 1 ) in ( omega )) by NAT_1:38 , ORDINAL1:def 12;
L792: (( C92 . ( R7 + 1 ) ) = H33(( C92 . R7 )) & ( C92 . ( ( R7 + 1 ) + 1 ) ) = H33(( C92 . ( R7 + 1 ) ))) by L791 , L765;
thus L793: ( C90 |^|^ ( R7 + 1 ) ) in ( C92 . ( ( R7 + 1 ) + 1 ) )
proof
per cases  by NAT_1:23;
suppose L794: R7 = ( 0 );

thus L795: thesis by L794 , L780 , L194 , L786;
end;
suppose L796: R7 = 1;

thus L797: thesis by L796 , L781 , L782 , L784 , L786 , ORDINAL4:24;
end;
suppose L798: R7 >= 2;

consider C94 being Nat such that L799: R7 = ( 2 + C94 ) by L798 , NAT_1:10;
L800: (( 0 ) in ( C94 + 1 ) & ( C94 + 2 ) = ( ( C94 + 1 ) + 1 )) by NAT_1:44;
L801: H33(( C90 |^|^ ( C94 + 2 ) )) = ( C90 |^|^ ( ( C94 + 1 ) + 2 ) ) by L800 , L742;
thus L802: thesis by L801 , L792 , L799 , L790 , ORDINAL4:24;
end;
end;

L804: (( 0 ) in ( R7 + 1 ) & ( R7 + 2 ) = ( ( R7 + 1 ) + 1 )) by NAT_1:44;
L805: H33(( C90 |^|^ ( R7 + 2 ) )) = ( C90 |^|^ ( ( R7 + 1 ) + 2 ) ) by L804 , L742;
L806: H33(( C92 . R7 )) in ( C90 |^|^ ( ( R7 + 1 ) + 2 ) ) by L805 , L790 , ORDINAL4:24;
thus L807: ( C92 . ( R7 + 1 ) ) in ( C90 |^|^ ( ( R7 + 1 ) + 2 ) ) by L806 , L791 , L765;
end;
L808: (for R7 being Nat holds S21[ R7 ]) from NAT_1:sch 2(L788 , L789);
deffunc H36(Ordinal) = ( C90 |^|^ $1 );
consider C95 being Ordinal-Sequence such that L809: (( dom C95 ) = ( omega ) & (for R1 being  ordinal number holds (R1 in ( omega ) implies ( C95 . R1 ) = H36(R1)))) from ORDINAL2:sch 3;
L810: ( C90 |^|^ ( omega ) ) = ( lim C95 ) by L809 , L188;
L811: (1 in ( omega ) & ( omega ) in C90) by L725;
L812: 1 in C90 by L811 , ORDINAL1:10;
L813: C95 is  increasing  increasing  increasing  increasing Ordinal-Sequence by L812 , L809 , L317;
L814: ( Union C95 ) is_limes_of C95 by L813 , L809 , L89;
L815: ( C90 |^|^ ( omega ) ) = ( Union C95 ) by L814 , L810 , ORDINAL2:def 10;
L816: D53 = ( Union C95 )
proof
thus L817: D53 c= ( Union C95 )
proof
let C96 being set;
assume L818: C96 in D53;
consider C97 being set such that L819: (C97 in ( dom C92 ) & C96 in ( C92 . C97 )) by L818 , CARD_5:2;
reconsider D54 = C97 as (Element of ( omega )) by L760 , L819;
L820: (( C92 . D54 ) in ( C90 |^|^ ( D54 + 2 ) ) & ( C95 . ( D54 + 2 ) ) = H36(( D54 + 2 ))) by L808 , L809;
L821: ( C92 . D54 ) in ( Union C95 ) by L820 , L809 , CARD_5:2;
thus L822: thesis by L821 , L819 , ORDINAL1:10;
end;

let C98 being set;
assume L823: C98 in ( Union C95 );
consider C99 being set such that L824: (C99 in ( dom C95 ) & C98 in ( C95 . C99 )) by L823 , CARD_5:2;
reconsider D55 = C99 as (Element of ( omega )) by L809 , L824;
L825: (( D55 + 1 ) in ( omega ) & ( C90 |^|^ D55 ) in ( C92 . ( D55 + 1 ) ) & ( C95 . D55 ) = H36(D55)) by L808 , L809;
L826: ( C95 . D55 ) in ( Union C92 ) by L825 , L760 , CARD_5:2;
thus L827: thesis by L826 , L824 , ORDINAL1:10;
end;
thus L828: thesis by L816 , L772 , L815 , L658;
end;
definition
let C100 being Ordinal;
func epsilon_ C100 -> Ordinal means 
:L829: (ex B52 being Ordinal-Sequence st (it = ( last B52 ) & ( dom B52 ) = ( succ C100 ) & ( B52 . ( {} ) ) = ( ( omega ) |^|^ ( omega ) ) & (for B53 being Ordinal holds (( succ B53 ) in ( succ C100 ) implies ( B52 . ( succ B53 ) ) = ( ( B52 . B53 ) |^|^ ( omega ) ))) & (for B54 being Ordinal holds ((B54 in ( succ C100 ) & B54 <> ( {} ) & B54 is  limit_ordinal) implies ( B52 . B54 ) = ( lim ( B52 | B54 ) )))));
correctness
proof
deffunc H37(Ordinal , Ordinal) = ( $2 |^|^ ( omega ) );
deffunc H38(Ordinal , Ordinal-Sequence) = ( lim $2 );
L830: ((ex B55 being Ordinal st (ex B56 being Ordinal-Sequence st (B55 = ( last B56 ) & ( dom B56 ) = ( succ C100 ) & ( B56 . ( {} ) ) = ( ( omega ) |^|^ ( omega ) ) & (for B57 being Ordinal holds (( succ B57 ) in ( succ C100 ) implies ( B56 . ( succ B57 ) ) = H37(B57 , ( B56 . B57 )))) & (for B58 being Ordinal holds ((B58 in ( succ C100 ) & B58 <> ( {} ) & B58 is  limit_ordinal) implies ( B56 . B58 ) = H38(B58 , ( B56 | B58 ))))))) & (for B59 , B60 being Ordinal holds (((ex B61 being Ordinal-Sequence st (B59 = ( last B61 ) & ( dom B61 ) = ( succ C100 ) & ( B61 . ( {} ) ) = ( ( omega ) |^|^ ( omega ) ) & (for B62 being Ordinal holds (( succ B62 ) in ( succ C100 ) implies ( B61 . ( succ B62 ) ) = H37(B62 , ( B61 . B62 )))) & (for B63 being Ordinal holds ((B63 in ( succ C100 ) & B63 <> ( {} ) & B63 is  limit_ordinal) implies ( B61 . B63 ) = H38(B63 , ( B61 | B63 )))))) & (ex B64 being Ordinal-Sequence st (B60 = ( last B64 ) & ( dom B64 ) = ( succ C100 ) & ( B64 . ( {} ) ) = ( ( omega ) |^|^ ( omega ) ) & (for B65 being Ordinal holds (( succ B65 ) in ( succ C100 ) implies ( B64 . ( succ B65 ) ) = H37(B65 , ( B64 . B65 )))) & (for B66 being Ordinal holds ((B66 in ( succ C100 ) & B66 <> ( {} ) & B66 is  limit_ordinal) implies ( B64 . B66 ) = H38(B66 , ( B64 | B66 ))))))) implies B59 = B60))) from ORDINAL2:sch 13;
thus L831: thesis by L830;
end;
end;
theorem
L833: ( epsilon_ ( 0 ) ) = ( ( omega ) |^|^ ( omega ) )
proof
deffunc H39(Ordinal) = ( epsilon_ $1 );
deffunc H40(Ordinal , Ordinal-Sequence) = ( lim $2 );
deffunc H41(Ordinal , Ordinal) = ( $2 |^|^ ( omega ) );
L834: (for R2 being  ordinal number holds (for R3 being  ordinal number holds (R3 = H39(R2) iff (ex B67 being Ordinal-Sequence st (R3 = ( last B67 ) & ( dom B67 ) = ( succ R2 ) & ( B67 . ( {} ) ) = ( ( omega ) |^|^ ( omega ) ) & (for R3 being  ordinal number holds (( succ R3 ) in ( succ R2 ) implies ( B67 . ( succ R3 ) ) = H41(R3 , ( B67 . R3 )))) & (for R3 being  ordinal number holds ((R3 in ( succ R2 ) & R3 <> ( {} ) & R3 is  limit_ordinal) implies ( B67 . R3 ) = H40(R3 , ( B67 | R3 ))))))))) by L829;
thus L835: H39(( 0 )) = ( ( omega ) |^|^ ( omega ) ) from ORDINAL2:sch 14(L834);
end;
theorem
L836: (for R1 being  ordinal number holds ( epsilon_ ( succ R1 ) ) = ( ( epsilon_ R1 ) |^|^ ( omega ) ))
proof
let R1 being  ordinal number;
deffunc H42(Ordinal) = ( epsilon_ $1 );
deffunc H43(Ordinal , Ordinal-Sequence) = ( lim $2 );
deffunc H44(Ordinal , Ordinal) = ( $2 |^|^ ( omega ) );
L837: (for R2 being  ordinal number holds (for R3 being  ordinal number holds (R3 = H42(R2) iff (ex B68 being Ordinal-Sequence st (R3 = ( last B68 ) & ( dom B68 ) = ( succ R2 ) & ( B68 . ( {} ) ) = ( ( omega ) |^|^ ( omega ) ) & (for R3 being  ordinal number holds (( succ R3 ) in ( succ R2 ) implies ( B68 . ( succ R3 ) ) = H44(R3 , ( B68 . R3 )))) & (for R3 being  ordinal number holds ((R3 in ( succ R2 ) & R3 <> ( {} ) & R3 is  limit_ordinal) implies ( B68 . R3 ) = H43(R3 , ( B68 | R3 ))))))))) by L829;
L838: (for R2 being  ordinal number holds H42(( succ R2 )) = H44(R2 , H42(R2))) from ORDINAL2:sch 15(L837);
thus L839: thesis by L838;
end;
theorem
L840: (for R2 being  ordinal number holds ((R2 <> ( {} ) & R2 is  limit_ordinal) implies (for B69 being Ordinal-Sequence holds ((( dom B69 ) = R2 & (for R3 being  ordinal number holds (R3 in R2 implies ( B69 . R3 ) = ( epsilon_ R3 )))) implies ( epsilon_ R2 ) = ( lim B69 )))))
proof
let R2 being  ordinal number;
assume L841: (R2 <> ( {} ) & R2 is  limit_ordinal);
deffunc H45(Ordinal) = ( epsilon_ $1 );
deffunc H46(Ordinal , Ordinal-Sequence) = ( lim $2 );
deffunc H47(Ordinal , Ordinal) = ( $2 |^|^ ( omega ) );
let C101 being Ordinal-Sequence;
assume that
L842: ( dom C101 ) = R2
and
L843: (for R3 being  ordinal number holds (R3 in R2 implies ( C101 . R3 ) = H45(R3)));
L844: (for R2 being  ordinal number holds (for R3 being  ordinal number holds (R3 = H45(R2) iff (ex B70 being Ordinal-Sequence st (R3 = ( last B70 ) & ( dom B70 ) = ( succ R2 ) & ( B70 . ( {} ) ) = ( ( omega ) |^|^ ( omega ) ) & (for R3 being  ordinal number holds (( succ R3 ) in ( succ R2 ) implies ( B70 . ( succ R3 ) ) = H47(R3 , ( B70 . R3 )))) & (for R3 being  ordinal number holds ((R3 in ( succ R2 ) & R3 <> ( {} ) & R3 is  limit_ordinal) implies ( B70 . R3 ) = H46(R3 , ( B70 | R3 ))))))))) by L829;
thus L845: H45(R2) = H46(R2 , C101) from ORDINAL2:sch 16(L844 , L841 , L842 , L843);
end;
theorem
L846: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (R1 in R2 implies ( epsilon_ R1 ) in ( epsilon_ R2 ))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
defpred S22[ Ordinal ] means (1 in ( epsilon_ $1 ) & (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 c= $1) implies ( epsilon_ R1 ) in ( epsilon_ R2 )))));
L847: ( omega ) in ( epsilon_ ( 0 ) ) by L325 , L833;
L848: S22[ ( 0 ) ] by L847 , ORDINAL1:10;
L849: (for R3 being  ordinal number holds (S22[ R3 ] implies S22[ ( succ R3 ) ]))
proof
let R3 being  ordinal number;
assume L850: S22[ R3 ];
L851: ( epsilon_ ( succ R3 ) ) = ( ( epsilon_ R3 ) |^|^ ( omega ) ) by L836;
L852: ( epsilon_ R3 ) in ( epsilon_ ( succ R3 ) ) by L851 , L850 , L325;
thus L853: 1 in ( epsilon_ ( succ R3 ) ) by L852 , L850 , ORDINAL1:10;
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L854: (R1 in R2 & R2 c= ( succ R3 ));
L855: R1 c= R3 by L854 , ORDINAL1:22;
L856: ((R2 = ( succ R3 ) & (R1 = R3 or R1 c< R3)) or R2 c< ( succ R3 )) by L855 , L854 , XBOOLE_0:def 8;
per cases  by L856 , ORDINAL1:11;
suppose L857: R2 in ( succ R3 );

L858: R2 c= R3 by L857 , ORDINAL1:22;
thus L859: thesis by L858 , L850 , L854;
end;
suppose L860: (R2 = ( succ R3 ) & R1 in R3);

L861: ( epsilon_ R1 ) in ( epsilon_ R3 ) by L860 , L850;
thus L862: thesis by L861 , L852 , L860 , ORDINAL1:10;
end;
suppose L863: (R2 = ( succ R3 ) & R1 = R3);

thus L864: thesis by L863 , L850 , L851 , L325;
end;
end;
L866: (for R3 being  ordinal number holds ((R3 <> ( {} ) & R3 is  limit_ordinal & (for R2 being  ordinal number holds (R2 in R3 implies S22[ R2 ]))) implies S22[ R3 ]))
proof
let R3 being  ordinal number;
assume that
L867: (R3 <> ( {} ) & R3 is  limit_ordinal)
and
L868: (for R2 being  ordinal number holds (R2 in R3 implies S22[ R2 ]));
deffunc H48(Ordinal) = ( epsilon_ $1 );
consider R8 being Ordinal-Sequence such that L869: (( dom R8 ) = R3 & (for R2 being  ordinal number holds (R2 in R3 implies ( R8 . R2 ) = H48(R2)))) from ORDINAL2:sch 3;
L870: R8 is  increasing
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L871: (R1 in R2 & R2 in ( dom R8 ));
L872: R1 in R3 by L871 , L869 , ORDINAL1:10;
L873: (( R8 . R1 ) = H48(R1) & ( R8 . R2 ) = H48(R2) & S22[ R2 ]) by L872 , L868 , L869 , L871;
thus L874: thesis by L873 , L871;
end;
L875: ( Union R8 ) is_limes_of R8 by L870 , L867 , L869 , L89;
L876: ( Union R8 ) = ( lim R8 ) by L875 , ORDINAL2:def 10
.= ( epsilon_ R3 ) by L867 , L869 , L840;
L877: ( 0 ) in R3 by L867 , ORDINAL3:8;
L878: (1 in ( epsilon_ ( 0 ) ) & ( R8 . ( 0 ) ) = H48(( 0 ))) by L877 , L868 , L869;
thus L879: 1 in ( epsilon_ R3 ) by L878 , L869 , L876 , L877 , CARD_5:2;
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L880: (R1 in R2 & R2 c= R3);
L881: (R2 = R3 or R2 c< R3) by L880 , XBOOLE_0:def 8;
per cases  by L881 , ORDINAL1:11;
suppose L882: R2 in R3;

thus L883: ( epsilon_ R1 ) in ( epsilon_ R2 ) by L882 , L868 , L880;
end;
suppose L884: R2 = R3;

L885: (( succ R1 ) in R3 & R1 in ( succ R1 )) by L867 , L880 , ORDINAL1:6 , ORDINAL1:28;
L886: (H48(R1) in H48(( succ R1 )) & H48(( succ R1 )) = ( R8 . ( succ R1 ) ) & ( R8 . ( succ R1 ) ) in ( rng R8 )) by L885 , L868 , L869 , FUNCT_1:def 3;
L887: ( R8 . ( succ R1 ) ) c= ( Union R8 ) by L886 , ZFMISC_1:74;
thus L888: thesis by L887 , L876 , L884 , L886;
end;
end;
L890: (for R3 being  ordinal number holds S22[ R3 ]) from ORDINAL2:sch 1(L848 , L849 , L866);
thus L891: thesis by L890;
end;
theorem
L892: (for B71 being Ordinal-Sequence holds ((for R3 being  ordinal number holds (R3 in ( dom B71 ) implies ( B71 . R3 ) = ( epsilon_ R3 ))) implies B71 is  increasing))
proof
let R8 being Ordinal-Sequence;
assume L893: (for R3 being  ordinal number holds (R3 in ( dom R8 ) implies ( R8 . R3 ) = ( epsilon_ R3 )));
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L894: (R1 in R2 & R2 in ( dom R8 ));
L895: (( R8 . R1 ) = ( epsilon_ R1 ) & ( R8 . R2 ) = ( epsilon_ R2 )) by L894 , L893 , ORDINAL1:10;
thus L896: thesis by L895 , L894 , L846;
end;
theorem
L897: (for R2 being  ordinal number holds ((R2 <> ( {} ) & R2 is  limit_ordinal) implies (for B72 being Ordinal-Sequence holds ((( dom B72 ) = R2 & (for R3 being  ordinal number holds (R3 in R2 implies ( B72 . R3 ) = ( epsilon_ R3 )))) implies ( epsilon_ R2 ) = ( Union B72 )))))
proof
let R2 being  ordinal number;
assume L898: (R2 <> ( {} ) & R2 is  limit_ordinal);
let R8 being Ordinal-Sequence;
assume L899: (( dom R8 ) = R2 & (for R3 being  ordinal number holds (R3 in R2 implies ( R8 . R3 ) = ( epsilon_ R3 ))));
L900: R8 is  increasing  increasing  increasing  increasing Ordinal-Sequence by L899 , L892;
L901: ( Union R8 ) is_limes_of R8 by L900 , L898 , L899 , L89;
L902: ( Union R8 ) = ( lim R8 ) by L901 , ORDINAL2:def 10;
thus L903: thesis by L902 , L898 , L899 , L840;
end;
theorem
L904: (for R2 being  ordinal number holds (for R9 being set holds (R2 is non  empty  limit_ordinal implies (R9 in ( epsilon_ R2 ) iff (ex R3 being  ordinal number st (R3 in R2 & R9 in ( epsilon_ R3 )))))))
proof
let R2 being  ordinal number;
let R9 being set;
assume L905: R2 is non  empty  limit_ordinal;
deffunc H49(Ordinal) = ( epsilon_ $1 );
consider R8 being Ordinal-Sequence such that L906: (( dom R8 ) = R2 & (for R3 being  ordinal number holds (R3 in R2 implies ( R8 . R3 ) = H49(R3)))) from ORDINAL2:sch 3;
L907: ( Union R8 ) = ( epsilon_ R2 ) by L905 , L906 , L897;
thus L908:now
assume L909: R9 in ( epsilon_ R2 );
consider C102 being set such that L910: (C102 in ( dom R8 ) & R9 in ( R8 . C102 )) by L909 , L907 , CARD_5:2;
reconsider D56 = C102 as Ordinal by L910;
take D57 = D56;
thus L911: D57 in R2 by L906 , L910;
thus L912: R9 in ( epsilon_ D57 ) by L906 , L910;
end;
given R3 being  ordinal number such that
L913: (R3 in R2 & R9 in ( epsilon_ R3 ));

L914: ( R8 . R3 ) = H49(R3) by L906 , L913;
thus L915: R9 in ( epsilon_ R2 ) by L914 , L906 , L907 , L913 , CARD_5:2;
end;
theorem
L916: (for R1 being  ordinal number holds R1 c= ( epsilon_ R1 ))
proof
let R1 being  ordinal number;
defpred S23[ Ordinal ] means $1 c= ( epsilon_ $1 );
L917: S23[ ( 0 ) ];
L918: (for R2 being  ordinal number holds (S23[ R2 ] implies S23[ ( succ R2 ) ]))
proof
let R2 being  ordinal number;
assume L919: S23[ R2 ];
L920: ( epsilon_ R2 ) in ( epsilon_ ( succ R2 ) ) by L846 , ORDINAL1:6;
L921: R2 in ( epsilon_ ( succ R2 ) ) by L920 , L919 , ORDINAL1:12;
thus L922: thesis by L921 , ORDINAL1:21;
end;
L923: (for R3 being  ordinal number holds ((R3 <> ( {} ) & R3 is  limit_ordinal & (for R2 being  ordinal number holds (R2 in R3 implies S23[ R2 ]))) implies S23[ R3 ]))
proof
let R3 being  ordinal number;
assume that
L924: (R3 <> ( {} ) & R3 is  limit_ordinal)
and
L925: (for R2 being  ordinal number holds (R2 in R3 implies S23[ R2 ]));
let R9 being set;
assume L926: R9 in R3;
reconsider D58 = R9 as Ordinal by L926;
L927: (S23[ D58 ] & ( epsilon_ D58 ) in ( epsilon_ R3 )) by L925 , L926 , L846;
thus L928: thesis by L927 , ORDINAL1:12;
end;
L929: (for R2 being  ordinal number holds S23[ R2 ]) from ORDINAL2:sch 1(L917 , L918 , L923);
thus L930: thesis by L929;
end;
theorem
L931: (for B73 being non  empty set holds ((for R9 being set holds (R9 in B73 implies (R9 is  epsilon  epsilon  epsilon  epsilon Ordinal & (ex B74 being  epsilon Ordinal st (R9 in B74 & B74 in B73))))) implies ( union B73 ) is  epsilon  epsilon  epsilon  epsilon Ordinal))
proof
let C103 being non  empty set;
assume L932: (for R9 being set holds (R9 in C103 implies (R9 is  epsilon  epsilon  epsilon  epsilon Ordinal & (ex B75 being  epsilon Ordinal st (R9 in B75 & B75 in C103)))));
L933: (for R9 being set holds (R9 in C103 implies R9 is Ordinal)) by L932;
reconsider D59 = ( union C103 ) as Ordinal by L933 , ORDINAL1:23;
L934:
now
let R2 being  ordinal number;
assume L935: R2 in D59;
consider R9 being set such that L936: (R2 in R9 & R9 in C103) by L935 , TARSKI:def 4;
reconsider D60 = R9 as  epsilon Ordinal by L936 , L932;
L937: ( succ R2 ) in D60 by L936 , ORDINAL1:28;
thus L938: ( succ R2 ) in D59 by L937 , L936 , TARSKI:def 4;
end;
L939: D59 is  limit_ordinal by L934 , ORDINAL1:28;
set D61 = the (Element of C103);
L940: (ex B76 being  epsilon Ordinal st (D61 in B76 & B76 in C103)) by L932;
L941: D59 <> ( {} ) by L940 , TARSKI:def 4;
L942: D59 is  epsilon
proof
thus L943: ( exp (( omega ) , D59) ) c= D59
proof
let R9 being set;
assume L944: R9 in ( exp (( omega ) , D59) );
consider R2 being  ordinal number such that L945: (R2 in D59 & R9 in ( exp (( omega ) , R2) )) by L944 , L939 , L941 , L157;
consider C104 being set such that L946: (R2 in C104 & C104 in C103) by L945 , TARSKI:def 4;
reconsider D62 = C104 as  epsilon Ordinal by L932 , L946;
L947: ( exp (( omega ) , R2) ) in ( exp (( omega ) , D62) ) by L946 , ORDINAL4:24;
L948: ( exp (( omega ) , R2) ) in D62 by L947 , L638;
L949: R9 in D62 by L948 , L945 , ORDINAL1:10;
thus L950: thesis by L949 , L946 , TARSKI:def 4;
end;

thus L951: thesis by ORDINAL4:32;
end;
thus L952: thesis by L942;
end;
theorem
L953: (for B77 being non  empty set holds (((for R9 being set holds (R9 in B77 implies R9 is  epsilon  epsilon  epsilon  epsilon Ordinal)) & (for R1 being  ordinal number holds (R1 in B77 implies ( first_epsilon_greater_than R1 ) in B77))) implies ( union B77 ) is  epsilon  epsilon  epsilon  epsilon Ordinal))
proof
let C105 being non  empty set;
assume that
L954: (for R9 being set holds (R9 in C105 implies R9 is  epsilon  epsilon  epsilon  epsilon Ordinal))
and
L955: (for R1 being  ordinal number holds (R1 in C105 implies ( first_epsilon_greater_than R1 ) in C105));
L956:
now
let R9 being set;
assume L957: R9 in C105;
thus L958: R9 is  epsilon  epsilon  epsilon  epsilon Ordinal by L957 , L954;
reconsider D63 = R9 as Ordinal by L954 , L957;
take D64 = ( first_epsilon_greater_than D63 );
thus L959: (R9 in D64 & D64 in C105) by L955 , L957 , L658;
end;
thus L960: ( union C105 ) is  epsilon  epsilon  epsilon  epsilon Ordinal by L956 , L931;
end;
registration
let R1 being  ordinal number;
cluster ( epsilon_ R1 ) ->  epsilon;
coherence
proof
deffunc H50(Ordinal) = ( epsilon_ $1 );
defpred S24[ Ordinal ] means H50($1) is  epsilon;
L961: S24[ ( {} ) ] by L678 , L833;
L962: (for R2 being  ordinal number holds (S24[ R2 ] implies S24[ ( succ R2 ) ]))
proof
let R2 being  ordinal number;
assume L963: S24[ R2 ];
L964: ( first_epsilon_greater_than ( epsilon_ R2 ) ) = ( ( epsilon_ R2 ) |^|^ ( omega ) ) by L963 , L748
.= ( epsilon_ ( succ R2 ) ) by L836;
thus L965: thesis by L964;
end;
L966: (for R2 being  ordinal number holds ((R2 <> ( {} ) & R2 is  limit_ordinal & (for R3 being  ordinal number holds (R3 in R2 implies S24[ R3 ]))) implies S24[ R2 ]))
proof
let R2 being  ordinal number;
assume that
L967: (R2 <> ( {} ) & R2 is  limit_ordinal)
and
L968: (for R3 being  ordinal number holds (R3 in R2 implies S24[ R3 ]));
consider R8 being Ordinal-Sequence such that L969: (( dom R8 ) = R2 & (for R3 being  ordinal number holds (R3 in R2 implies ( R8 . R3 ) = H50(R3)))) from ORDINAL2:sch 3;
L970: H50(R2) = ( Union R8 ) by L967 , L969 , L897;
set D65 = ( rng R8 );
L971: ( 0 ) in R2 by L967 , ORDINAL3:8;
L972: ( R8 . ( 0 ) ) in ( rng R8 ) by L971 , L969 , FUNCT_1:def 3;
reconsider D66 = D65 as non  empty set by L972;
L973:
now
let R9 being set;
assume L974: R9 in D66;
consider C106 being set such that L975: (C106 in ( dom R8 ) & ( R8 . C106 ) = R9) by L974 , FUNCT_1:def 3;
reconsider D67 = C106 as Ordinal by L975;
L976: R9 = H50(D67) by L969 , L975;
thus L977: R9 is  epsilon  epsilon  epsilon  epsilon Ordinal by L976 , L968 , L969 , L975;
end;
L978:
now
let C107 being Ordinal;
assume L979: C107 in D66;
consider C108 being set such that L980: (C108 in ( dom R8 ) & ( R8 . C108 ) = C107) by L979 , FUNCT_1:def 3;
reconsider D68 = C108 as Ordinal by L980;
L981: ( succ D68 ) in R2 by L967 , L969 , L980 , ORDINAL1:28;
reconsider D69 = C107 as  epsilon Ordinal by L973 , L979;
L982: D69 = H50(D68) by L969 , L980;
L983: ( first_epsilon_greater_than D69 ) = ( H50(D68) |^|^ ( omega ) ) by L982 , L748
.= H50(( succ D68 )) by L836
.= ( R8 . ( succ D68 ) ) by L969 , L981;
thus L984: ( first_epsilon_greater_than C107 ) in D66 by L983 , L969 , L981 , FUNCT_1:def 3;
end;
thus L985: S24[ R2 ] by L978 , L970 , L973 , L953;
end;
L986: (for R1 being  ordinal number holds S24[ R1 ]) from ORDINAL2:sch 1(L961 , L962 , L966);
thus L987: thesis by L986;
end;
end;
::$N The ordinal indexing of epsilon numbers
theorem
L989: (for R1 being  ordinal number holds (R1 is  epsilon implies (ex R2 being  ordinal number st R1 = ( epsilon_ R2 ))))
proof
let R1 being  ordinal number;
defpred S25[ set ] means (ex R2 being  ordinal number st $1 = ( epsilon_ R2 ));
defpred S26[ Ordinal ] means (for B78 being  epsilon Ordinal holds (B78 in ( epsilon_ $1 ) implies S25[ B78 ]));
L990: S26[ ( {} ) ]
proof
let C109 being  epsilon Ordinal;
L991: ( 0 ) in C109 by ORDINAL3:8;
L992: ( first_epsilon_greater_than ( 0 ) ) c= C109 by L991 , L658;
L993: (C109 in ( epsilon_ ( 0 ) ) implies C109 in C109) by L992 , L678 , L833;
thus L994: thesis by L993;
end;
L995: (for R3 being  ordinal number holds (S26[ R3 ] implies S26[ ( succ R3 ) ]))
proof
let R3 being  ordinal number;
assume L996: S26[ R3 ];
let C110 being  epsilon Ordinal;
assume that
L997: C110 in ( epsilon_ ( succ R3 ) );
L998: ( epsilon_ ( succ R3 ) ) = ( ( epsilon_ R3 ) |^|^ ( omega ) ) by L836
.= ( first_epsilon_greater_than ( epsilon_ R3 ) ) by L748;
per cases  by ORDINAL1:14;
suppose L999: C110 in ( epsilon_ R3 );

thus L1000: S25[ C110 ] by L999 , L996;
end;
suppose L1001: C110 = ( epsilon_ R3 );

thus L1002: S25[ C110 ] by L1001;
end;
suppose L1003: ( epsilon_ R3 ) in C110;

L1004: ( epsilon_ ( succ R3 ) ) c= C110 by L1003 , L998 , L658;
L1005: C110 in C110 by L1004 , L997;
thus L1006: S25[ C110 ] by L1005;
end;
end;
L1008: (for R2 being  ordinal number holds ((R2 <> ( {} ) & R2 is  limit_ordinal & (for R3 being  ordinal number holds (R3 in R2 implies S26[ R3 ]))) implies S26[ R2 ]))
proof
let R2 being  ordinal number;
assume that
L1009: (R2 <> ( {} ) & R2 is  limit_ordinal)
and
L1010: (for R3 being  ordinal number holds (R3 in R2 implies S26[ R3 ]));
let C111 being  epsilon Ordinal;
assume L1011: C111 in ( epsilon_ R2 );
L1012: (ex R3 being  ordinal number st (R3 in R2 & C111 in ( epsilon_ R3 ))) by L1011 , L1009 , L904;
thus L1013: S25[ C111 ] by L1012 , L1010;
end;
L1014: (for R2 being  ordinal number holds S26[ R2 ]) from ORDINAL2:sch 1(L990 , L995 , L1008);
L1015: (R1 c= ( epsilon_ R1 ) & ( epsilon_ R1 ) in ( epsilon_ ( succ R1 ) )) by L846 , L916 , ORDINAL1:6;
thus L1016: thesis by L1015 , L1014 , ORDINAL1:12;
end;
begin
definition
let C112 being  finite Ordinal-Sequence;
func Sum^ C112 -> Ordinal means 
:L1017: (ex B79 being Ordinal-Sequence st (it = ( last B79 ) & ( dom B79 ) = ( succ ( dom C112 ) ) & ( B79 . ( 0 ) ) = ( 0 ) & (for B80 being Nat holds (B80 in ( dom C112 ) implies ( B79 . ( B80 + 1 ) ) = ( ( B79 . B80 ) +^ ( C112 . B80 ) )))));
correctness
proof
deffunc H51(Ordinal , Ordinal) = ( $2 +^ ( C112 . $1 ) );
deffunc H52(Ordinal , Ordinal-Sequence) = ( Union $2 );
set D70 = ( dom C112 );
L1018: ((ex B81 being Ordinal st (ex B82 being Ordinal-Sequence st (B81 = ( last B82 ) & ( dom B82 ) = ( succ D70 ) & ( B82 . ( {} ) ) = ( 0 ) & (for B83 being Ordinal holds (( succ B83 ) in ( succ D70 ) implies ( B82 . ( succ B83 ) ) = H51(B83 , ( B82 . B83 )))) & (for B84 being Ordinal holds ((B84 in ( succ D70 ) & B84 <> ( {} ) & B84 is  limit_ordinal) implies ( B82 . B84 ) = H52(B84 , ( B82 | B84 ))))))) & (for B85 , B86 being Ordinal holds (((ex B87 being Ordinal-Sequence st (B85 = ( last B87 ) & ( dom B87 ) = ( succ D70 ) & ( B87 . ( {} ) ) = ( 0 ) & (for B88 being Ordinal holds (( succ B88 ) in ( succ D70 ) implies ( B87 . ( succ B88 ) ) = H51(B88 , ( B87 . B88 )))) & (for B89 being Ordinal holds ((B89 in ( succ D70 ) & B89 <> ( {} ) & B89 is  limit_ordinal) implies ( B87 . B89 ) = H52(B89 , ( B87 | B89 )))))) & (ex B90 being Ordinal-Sequence st (B86 = ( last B90 ) & ( dom B90 ) = ( succ D70 ) & ( B90 . ( {} ) ) = ( 0 ) & (for B91 being Ordinal holds (( succ B91 ) in ( succ D70 ) implies ( B90 . ( succ B91 ) ) = H51(B91 , ( B90 . B91 )))) & (for B92 being Ordinal holds ((B92 in ( succ D70 ) & B92 <> ( {} ) & B92 is  limit_ordinal) implies ( B90 . B92 ) = H52(B92 , ( B90 | B92 ))))))) implies B85 = B86))) from ORDINAL2:sch 13;
consider R1 being  ordinal number, R8 being Ordinal-Sequence such that L1019: (R1 = ( last R8 ) & ( dom R8 ) = ( succ D70 ) & ( R8 . ( 0 ) ) = ( 0 ) & (for B93 being Ordinal holds (( succ B93 ) in ( succ D70 ) implies ( R8 . ( succ B93 ) ) = H51(B93 , ( R8 . B93 )))) & (for B94 being Ordinal holds ((B94 in ( succ D70 ) & B94 <> ( {} ) & B94 is  limit_ordinal) implies ( R8 . B94 ) = H52(B94 , ( R8 | B94 ))))) by L1018;
thus L1020:now
take D71 = R1;
take D72 = R8;
thus L1021: (D71 = ( last D72 ) & ( dom D72 ) = ( succ D70 ) & ( D72 . ( 0 ) ) = ( 0 )) by L1019;
let R7 being Nat;
assume L1022: R7 in ( dom C112 );
L1023: ( succ R7 ) c= ( dom C112 ) by L1022 , ORDINAL1:21;
L1024: (( succ R7 ) in ( succ D70 ) & ( R7 + 1 ) = ( succ R7 )) by L1023 , NAT_1:38 , ORDINAL1:22;
thus L1025: ( D72 . ( R7 + 1 ) ) = ( ( D72 . R7 ) +^ ( C112 . R7 ) ) by L1024 , L1019;
end;
let C113 , C114 being Ordinal;
given C115 being Ordinal-Sequence such that
L1026: (C113 = ( last C115 ) & ( dom C115 ) = ( succ ( dom C112 ) ) & ( C115 . ( 0 ) ) = ( 0 ) & (for B95 being Nat holds (B95 in ( dom C112 ) implies ( C115 . ( B95 + 1 ) ) = ( ( C115 . B95 ) +^ ( C112 . B95 ) ))));

given C116 being Ordinal-Sequence such that
L1027: (C114 = ( last C116 ) & ( dom C116 ) = ( succ ( dom C112 ) ) & ( C116 . ( 0 ) ) = ( 0 ) & (for B96 being Nat holds (B96 in ( dom C112 ) implies ( C116 . ( B96 + 1 ) ) = ( ( C116 . B96 ) +^ ( C112 . B96 ) ))));

reconsider D73 = D70 as  finite Ordinal;
L1028: (( succ D73 ) in ( omega ) & D73 in ( omega )) by CARD_1:61;
L1029: (for B97 being Ordinal holds (( succ B97 ) in ( succ D73 ) implies ( C115 . ( succ B97 ) ) = H51(B97 , ( C115 . B97 ))))
proof
let R3 being  ordinal number;
assume L1030: ( succ R3 ) in ( succ D73 );
L1031: R3 in D73 by L1030 , ORDINAL3:3;
reconsider D74 = R3 as (Element of ( omega )) by L1031;
L1032: ( C115 . ( D74 + 1 ) ) = H51(D74 , ( C115 . D74 )) by L1026 , L1031;
thus L1033: thesis by L1032 , NAT_1:38;
end;
L1034: (for B98 being Ordinal holds ((B98 in ( succ D73 ) & B98 <> ( {} ) & B98 is  limit_ordinal) implies ( C115 . B98 ) = H52(B98 , ( C115 | B98 ))))
proof
let C117 being Ordinal;
assume L1035: (C117 in ( succ D73 ) & C117 <> ( {} ) & C117 is  limit_ordinal);
L1036: ( 0 ) in C117 by L1035 , ORDINAL3:8;
L1037: (C117 in ( omega ) & ( omega ) c= C117) by L1036 , L1035 , L1028 , ORDINAL1:10 , ORDINAL1:def 11;
thus L1038: ( C115 . C117 ) = H52(C117 , ( C115 | C117 )) by L1037;
end;
L1039: (for B99 being Ordinal holds (( succ B99 ) in ( succ D73 ) implies ( C116 . ( succ B99 ) ) = H51(B99 , ( C116 . B99 ))))
proof
let R3 being  ordinal number;
assume L1040: ( succ R3 ) in ( succ D73 );
L1041: R3 in D73 by L1040 , ORDINAL3:3;
reconsider D75 = R3 as (Element of ( omega )) by L1041;
L1042: ( C116 . ( D75 + 1 ) ) = H51(D75 , ( C116 . D75 )) by L1027 , L1041;
thus L1043: thesis by L1042 , NAT_1:38;
end;
L1044: (for B100 being Ordinal holds ((B100 in ( succ D73 ) & B100 <> ( {} ) & B100 is  limit_ordinal) implies ( C116 . B100 ) = H52(B100 , ( C116 | B100 ))))
proof
let C118 being Ordinal;
assume L1045: (C118 in ( succ D73 ) & C118 <> ( {} ) & C118 is  limit_ordinal);
L1046: ( 0 ) in C118 by L1045 , ORDINAL3:8;
L1047: (C118 in ( omega ) & ( omega ) c= C118) by L1046 , L1045 , L1028 , ORDINAL1:10 , ORDINAL1:def 11;
thus L1048: thesis by L1047;
end;
thus L1049: thesis by L1044 , L1018 , L1026 , L1027 , L1029 , L1034 , L1039;
end;
end;
theorem
L1051: ( Sum^ ( {} ) ) = ( 0 )
proof
reconsider D76 = ( {} ) as  finite Ordinal-Sequence;
consider C119 being Ordinal-Sequence such that L1052: ( Sum^ D76 ) = ( last C119 ) and L1053: ( dom C119 ) = ( succ ( dom D76 ) ) and L1054: ( C119 . ( 0 ) ) = ( 0 ) and L1055: (for B101 being Nat holds (B101 in ( dom D76 ) implies ( C119 . ( B101 + 1 ) ) = ( ( C119 . B101 ) +^ ( D76 . B101 ) ))) by L1017;
L1056: (( dom C119 ) = ( succ ( 0 ) ) implies ( last C119 ) = ( C119 . ( 0 ) )) by ORDINAL2:6;
thus L1057: ( Sum^ ( {} ) ) = ( 0 ) by L1056 , L1052 , L1053 , L1054;
end;
theorem
L1058: (for R1 being  ordinal number holds ( Sum^ <% R1 %> ) = R1)
proof
let R1 being  ordinal number;
consider C120 being Ordinal-Sequence such that L1059: (( Sum^ <% R1 %> ) = ( last C120 ) & ( dom C120 ) = ( succ ( dom <% R1 %> ) ) & ( C120 . ( 0 ) ) = ( 0 ) & (for B102 being Nat holds (B102 in ( dom <% R1 %> ) implies ( C120 . ( B102 + 1 ) ) = ( ( C120 . B102 ) +^ ( <% R1 %> . B102 ) )))) by L1017;
L1060: (( dom <% R1 %> ) = 1 & ( <% R1 %> . ( 0 ) ) = R1) by AFINSQ_1:def 4;
L1061: ( 0 ) in 1 by NAT_1:44;
L1062: ( C120 . ( ( 0 ) + 1 ) ) = ( (( 0 ) qua Ordinal) +^ R1 ) by L1061 , L1059 , L1060
.= R1 by ORDINAL2:30;
thus L1063: thesis by L1062 , L1059 , L1060 , ORDINAL2:6;
end;
theorem
L1064: (for R1 being  ordinal number holds (for B103 being  finite Ordinal-Sequence holds ( Sum^ ( B103 ^ <% R1 %> ) ) = ( ( Sum^ B103 ) +^ R1 )))
proof
let R1 being  ordinal number;
let C121 being  finite Ordinal-Sequence;
consider C122 being Ordinal-Sequence such that L1065: (( Sum^ ( C121 ^ <% R1 %> ) ) = ( last C122 ) & ( dom C122 ) = ( succ ( dom ( C121 ^ <% R1 %> ) ) ) & ( C122 . ( 0 ) ) = ( 0 ) & (for B104 being Nat holds (B104 in ( dom ( C121 ^ <% R1 %> ) ) implies ( C122 . ( B104 + 1 ) ) = ( ( C122 . B104 ) +^ ( ( C121 ^ <% R1 %> ) . B104 ) )))) by L1017;
consider C123 being Ordinal-Sequence such that L1066: (( Sum^ C121 ) = ( last C123 ) & ( dom C123 ) = ( succ ( dom C121 ) ) & ( C123 . ( 0 ) ) = ( 0 ) & (for B105 being Nat holds (B105 in ( dom C121 ) implies ( C123 . ( B105 + 1 ) ) = ( ( C123 . B105 ) +^ ( C121 . B105 ) )))) by L1017;
L1067: ( dom <% R1 %> ) = 1 by AFINSQ_1:def 4;
L1068: (( dom ( C121 ^ <% R1 %> ) ) = ( ( dom C121 ) +^ 1 ) & ( ( dom C121 ) +^ 1 ) = ( succ ( dom C121 ) )) by L1067 , ORDINAL2:31 , ORDINAL4:def 1;
reconsider D77 = ( dom C121 ) as (Element of ( NAT )) by ORDINAL1:def 12;
L1069: ( dom C121 ) in ( succ ( dom C121 ) ) by ORDINAL1:6;
defpred S27[ Nat ] means ($1 in ( succ ( dom C121 ) ) implies ( C122 . $1 ) = ( C123 . $1 ));
L1070: S27[ ( 0 ) ] by L1065 , L1066;
L1071: (for R7 being Nat holds (S27[ R7 ] implies S27[ ( R7 + 1 ) ]))
proof
let R7 being Nat;
assume that
L1072: S27[ R7 ]
and
L1073: ( R7 + 1 ) in ( succ ( dom C121 ) );
L1074: ( R7 + 1 ) = ( succ R7 ) by NAT_1:38;
L1075: R7 in ( dom C121 ) by L1074 , L1073 , ORDINAL3:3;
L1076: R7 in ( succ ( dom C121 ) ) by L1075 , L1069 , ORDINAL1:10;
L1077: (( C123 . ( R7 + 1 ) ) = ( ( C123 . R7 ) +^ ( C121 . R7 ) ) & ( C122 . ( R7 + 1 ) ) = ( ( C122 . R7 ) +^ ( ( C121 ^ <% R1 %> ) . R7 ) )) by L1076 , L1065 , L1066 , L1068 , L1075;
thus L1078: thesis by L1077 , L1072 , L1075 , L1069 , ORDINAL1:10 , ORDINAL4:def 1;
end;
L1079: (for R7 being Nat holds S27[ R7 ]) from NAT_1:sch 2(L1070 , L1071);
thus L1080: ( Sum^ ( C121 ^ <% R1 %> ) ) = ( C122 . ( ( dom C121 ) +^ 1 ) ) by L1065 , L1068 , ORDINAL2:6
.= ( C122 . ( D77 + 1 ) ) by CARD_2:36
.= ( ( C122 . ( dom C121 ) ) +^ ( ( C121 ^ <% R1 %> ) . ( len C121 ) ) ) by L1065 , L1068 , ORDINAL1:6
.= ( ( C122 . ( dom C121 ) ) +^ R1 ) by AFINSQ_1:36
.= ( ( C123 . ( dom C121 ) ) +^ R1 ) by ORDINAL1:6 , L1079
.= ( ( Sum^ C121 ) +^ R1 ) by L1066 , ORDINAL2:6;
end;
theorem
L1081: (for R1 being  ordinal number holds (for B106 being  finite Ordinal-Sequence holds ( Sum^ ( <% R1 %> ^ B106 ) ) = ( R1 +^ ( Sum^ B106 ) )))
proof
let R1 being  ordinal number;
defpred S28[  finite T-Sequence ] means (for B107 being  finite Ordinal-Sequence holds (B107 = $1 implies ( Sum^ ( <% R1 %> ^ B107 ) ) = ( R1 +^ ( Sum^ B107 ) )));
L1082: ( Sum^ ( <% R1 %> ^ ( {} ) ) ) = R1 by L1058;
L1083: S28[ ( {} ) ] by L1082 , L1051 , ORDINAL2:27;
L1084: (for B108 being  finite T-Sequence holds (for R9 being set holds (S28[ B108 ] implies S28[ ( B108 ^ <% R9 %> ) ])))
proof
let C124 being  finite T-Sequence;
let R9 being set;
assume L1085: S28[ C124 ];
let C125 being  finite Ordinal-Sequence;
consider R2 being  ordinal number such that L1086: ( rng C125 ) c= R2 by ORDINAL2:def 4;
assume L1087: C125 = ( C124 ^ <% R9 %> );
L1088: ( rng C125 ) = ( ( rng C124 ) \/ ( rng <% R9 %> ) ) by L1087 , AFINSQ_1:26;
L1089: (( rng C124 ) c= R2 & ( rng <% R9 %> ) c= R2) by L1088 , L1086 , XBOOLE_1:11;
reconsider D78 = C124 as  finite Ordinal-Sequence by L1089 , ORDINAL2:def 4;
L1090: ( rng <% R9 %> ) = { R9 } by AFINSQ_1:33;
L1091: R9 in R2 by L1090 , L1089 , ZFMISC_1:31;
reconsider D79 = R9 as Ordinal by L1091;
thus L1092: ( Sum^ ( <% R1 %> ^ C125 ) ) = ( Sum^ ( ( <% R1 %> ^ D78 ) ^ <% D79 %> ) ) by L1087 , AFINSQ_1:27
.= ( ( Sum^ ( <% R1 %> ^ D78 ) ) +^ D79 ) by L1064
.= ( ( R1 +^ ( Sum^ D78 ) ) +^ D79 ) by L1085
.= ( R1 +^ ( ( Sum^ D78 ) +^ D79 ) ) by ORDINAL3:30
.= ( R1 +^ ( Sum^ C125 ) ) by L1087 , L1064;
end;
L1093: (for B109 being  finite T-Sequence holds S28[ B109 ]) from AFINSQ_1:sch 3(L1083 , L1084);
thus L1094: thesis by L1093;
end;
theorem
L1095: (for B110 being  finite Ordinal-Sequence holds ( B110 . ( 0 ) ) c= ( Sum^ B110 ))
proof
let C126 being  finite Ordinal-Sequence;
defpred S29[  finite T-Sequence ] means (for B111 being  finite Ordinal-Sequence holds ($1 = B111 implies ( B111 . ( 0 ) ) c= ( Sum^ B111 )));
L1096: S29[ ( {} ) ];
L1097: (for B112 being  finite T-Sequence holds (for R9 being set holds (S29[ B112 ] implies S29[ ( B112 ^ <% R9 %> ) ])))
proof
let C127 being  finite T-Sequence;
let R9 being set;
assume L1098: S29[ C127 ];
let C128 being  finite Ordinal-Sequence;
consider R2 being  ordinal number such that L1099: ( rng C128 ) c= R2 by ORDINAL2:def 4;
assume L1100: C128 = ( C127 ^ <% R9 %> );
L1101: ( rng C128 ) = ( ( rng C127 ) \/ ( rng <% R9 %> ) ) by L1100 , AFINSQ_1:26;
L1102: (( rng C127 ) c= R2 & ( rng <% R9 %> ) c= R2) by L1101 , L1099 , XBOOLE_1:11;
reconsider D80 = C127 as  finite Ordinal-Sequence by L1102 , ORDINAL2:def 4;
L1103: ( rng <% R9 %> ) = { R9 } by AFINSQ_1:33;
L1104: R9 in R2 by L1103 , L1102 , ZFMISC_1:31;
reconsider D81 = R9 as Ordinal by L1104;
per cases ;
suppose L1105: C127 = ( {} );

L1106: C128 = ( ( {} ) ^ <% D81 %> ) by L1105 , L1100;
L1107: C128 = <% D81 %> by L1106;
L1108: (( C128 . ( 0 ) ) = D81 & ( Sum^ C128 ) = D81) by L1107 , L1058 , AFINSQ_1:def 4;
thus L1109: ( C128 . ( 0 ) ) c= ( Sum^ C128 ) by L1108;
end;
suppose L1110: C127 <> ( {} );

L1111: (( 0 ) in ( dom D80 ) & ( Sum^ C128 ) = ( ( Sum^ D80 ) +^ D81 )) by L1110 , L1100 , L1064 , ORDINAL3:8;
L1112: (( C128 . ( 0 ) ) = ( D80 . ( 0 ) ) & ( D80 . ( 0 ) ) c= ( Sum^ D80 ) & ( Sum^ D80 ) c= ( Sum^ C128 )) by L1111 , L1098 , L1100 , ORDINAL3:24 , ORDINAL4:def 1;
thus L1113: ( C128 . ( 0 ) ) c= ( Sum^ C128 ) by L1112 , XBOOLE_1:1;
end;
end;
L1115: (for B113 being  finite T-Sequence holds S29[ B113 ]) from AFINSQ_1:sch 3(L1096 , L1097);
thus L1116: ( C126 . ( 0 ) ) c= ( Sum^ C126 ) by L1115;
end;
definition
let R1 being  ordinal number;
attr R1 is  Cantor-component
means
:L1117: (ex R2 being  ordinal number st (ex R7 being Nat st (( 0 ) in R7 & R1 = ( R7 *^ ( exp (( omega ) , R2) ) ))));
end;
registration
cluster  Cantor-component -> non  empty for Ordinal;
coherence
proof
let R1 being  ordinal number;
given R2 being  ordinal number , R7 being Nat such that
L1119: (( 0 ) in R7 & R1 = ( R7 *^ ( exp (( omega ) , R2) ) ));

L1120: ( exp (( omega ) , R2) ) <> ( 0 ) by ORDINAL4:22;
thus L1121: thesis by L1120 , L1119 , ORDINAL3:31;
end;
end;
registration
cluster  Cantor-component for Ordinal;
existence
proof
take ( 1 *^ ( exp (( omega ) , 1) ) );
take 1;
take 1;
thus L1123: thesis by NAT_1:44;
end;
end;
definition
let R1 being  ordinal number;
let R2 being  ordinal number;
func R2 -exponent R1 -> Ordinal means 
:L1125: (( exp (R2 , it) ) c= R1 & (for R3 being  ordinal number holds (( exp (R2 , R3) ) c= R1 implies R3 c= it))) if (1 in R2 & ( 0 ) in R1) otherwise it = ( 0 );
existence
proof
thus L1126:now
assume L1127: (1 in R2 & ( 0 ) in R1);
defpred S30[ Ordinal ] means R1 c= ( exp (R2 , $1) );
L1128: R1 c= ( exp (R2 , R1) ) by L1127 , ORDINAL4:32;
L1129: (ex R3 being  ordinal number st S30[ R3 ]) by L1128;
consider R3 being  ordinal number such that L1130: (S30[ R3 ] & (for R4 being  ordinal number holds (S30[ R4 ] implies R3 c= R4))) from ORDINAL1:sch 1(L1129);
L1131: ( 0 ) in 1 by NAT_1:44;
L1132: ( 0 ) in R2 by L1131 , L1127 , ORDINAL1:10;
per cases  by L1130 , XBOOLE_0:def 8;
suppose L1133: R1 = ( exp (R2 , R3) );

take D82 = R3;
thus L1134: ( exp (R2 , D82) ) c= R1 by L1133;
let R4 being  ordinal number;
assume L1135: (( exp (R2 , R4) ) c= R1 & R4 c/= D82);
L1136: D82 in R4 by L1135 , ORDINAL1:16;
L1137: R1 in ( exp (R2 , R4) ) by L1136 , L1127 , L1133 , ORDINAL4:24;
L1138: R1 in R1 by L1137 , L1135;
thus L1139: contradiction by L1138;
end;
suppose L1140: R1 c< ( exp (R2 , R3) );

L1141: R1 in ( exp (R2 , R3) ) by L1140 , ORDINAL1:11;
L1142: ( succ ( 0 ) ) c= R1 by L1127 , ORDINAL1:21;
L1143: (1 in ( exp (R2 , R3) ) & ( exp (R2 , ( 0 )) ) = 1) by L1142 , L1140 , ORDINAL1:11 , ORDINAL1:12 , ORDINAL2:43;
L1144: R3 <> ( 0 ) by L1143;
L1145:
now
assume L1146: R3 is  limit_ordinal;
consider R4 being  ordinal number such that L1147: (R4 in R3 & R1 in ( exp (R2 , R4) )) by L1146 , L1144 , L1132 , L1141 , L157;
L1148: S30[ R4 ] by L1147 , ORDINAL1:def 2;
L1149: R3 c= R4 by L1148 , L1130;
L1150: R4 in R4 by L1149 , L1147;
thus L1151: contradiction by L1150;
end;
consider R4 being  ordinal number such that L1152: R3 = ( succ R4 ) by L1145 , ORDINAL1:29;
take D83 = R4;
thus L1153: ( exp (R2 , D83) ) c= R1
proof
assume L1154: ( exp (R2 , D83) ) c/= R1;
L1155: R1 c= ( exp (R2 , D83) ) by L1154;
L1156: R3 c= D83 by L1155 , L1130;
L1157: D83 in D83 by L1156 , L1152 , ORDINAL1:21;
thus L1158: thesis by L1157;
end;

let R5 being  ordinal number;
assume L1159: (( exp (R2 , R5) ) c= R1 & R5 c/= D83);
L1160: D83 in R5 by L1159 , ORDINAL1:16;
L1161: R3 c= R5 by L1160 , L1152 , ORDINAL1:21;
L1162: ( exp (R2 , R3) ) c= ( exp (R2 , R5) ) by L1161 , L1127 , ORDINAL4:27;
L1163: R1 in ( exp (R2 , R5) ) by L1162 , L1141;
L1164: R1 in R1 by L1163 , L1159;
thus L1165: contradiction by L1164;
end;
end;
thus L1167: thesis;
end;
uniqueness
proof
let C129 , C130 being Ordinal;
thus L1168:now
assume that
L1169: (1 in R2 & ( 0 ) in R1)
and
L1170: (( exp (R2 , C129) ) c= R1 & (for R3 being  ordinal number holds (( exp (R2 , R3) ) c= R1 implies R3 c= C129)))
and
L1171: (( exp (R2 , C130) ) c= R1 & (for R3 being  ordinal number holds (( exp (R2 , R3) ) c= R1 implies R3 c= C130)));
thus L1172: C129 = C130
proof
thus L1173: C129 c= C130 by L1170 , L1171;
thus L1174: thesis by L1170 , L1171;
end;

end;
thus L1173: thesis;
end;
consistency;
end;
L1175: ( 0 ) in 1 by NAT_1:44;
theorem
L1176: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (1 in R2 implies R1 in ( exp (R2 , ( succ ( R2 -exponent R1 ) )) ))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L1177: 1 in R2;
per cases  by ORDINAL3:8;
suppose L1178: ( 0 ) in R1;

assume L1179: (not thesis);
L1180: ( exp (R2 , ( succ ( R2 -exponent R1 ) )) ) c= R1 by L1179 , ORDINAL1:16;
L1181: (( succ ( R2 -exponent R1 ) ) c= ( R2 -exponent R1 ) & ( R2 -exponent R1 ) in ( succ ( R2 -exponent R1 ) )) by L1180 , L1177 , L1178 , L1125 , ORDINAL1:6;
L1182: ( R2 -exponent R1 ) in ( R2 -exponent R1 ) by L1181;
thus L1183: contradiction by L1182;
end;
suppose L1184: R1 = ( 0 );

L1185: ( R2 -exponent R1 ) = ( 0 ) by L1184 , L1125;
L1186: ( exp (R2 , ( succ ( R2 -exponent R1 ) )) ) = R2 by L1185 , ORDINAL2:46;
thus L1187: thesis by L1186 , L1177 , L1184 , L1175 , ORDINAL1:10;
end;
end;
theorem
L1189: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R7 being Nat holds ((( 0 ) in R7 & R7 in R2) implies ( R2 -exponent ( R7 *^ ( exp (R2 , R1) ) ) ) = R1))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R7 being Nat;
assume L1190: (( 0 ) in R7 & R7 in R2);
L1191: ( succ ( 0 ) ) c= R7 by L1190 , ORDINAL1:21;
L1192: (( 1 *^ ( exp (R2 , R1) ) ) = ( exp (R2 , R1) ) & ( 1 *^ ( exp (R2 , R1) ) ) c= ( R7 *^ ( exp (R2 , R1) ) )) by L1191 , ORDINAL2:39 , ORDINAL2:41;
L1193: (( exp (R2 , R1) ) <> ( 0 ) & R7 <> ( 0 )) by L1190 , ORDINAL4:22;
L1194: ( 0 ) <> ( R7 *^ ( exp (R2 , R1) ) ) by L1193 , ORDINAL3:31;
L1195: (1 in R2 & ( 0 ) in ( R7 *^ ( exp (R2 , R1) ) )) by L1194 , L1191 , L1190 , ORDINAL1:12 , ORDINAL3:8;
L1196:
now
let R3 being  ordinal number;
assume L1197: (( exp (R2 , R3) ) c= ( R7 *^ ( exp (R2 , R1) ) ) & R3 c/= R1);
L1198: R1 in R3 by L1197 , ORDINAL1:16;
L1199: ( succ R1 ) c= R3 by L1198 , ORDINAL1:21;
L1200: ( exp (R2 , ( succ R1 )) ) c= ( exp (R2 , R3) ) by L1199 , L1190 , ORDINAL4:27;
L1201: ( exp (R2 , ( succ R1 )) ) = ( R2 *^ ( exp (R2 , R1) ) ) by ORDINAL2:44;
L1202: ( R2 *^ ( exp (R2 , R1) ) ) c= ( R7 *^ ( exp (R2 , R1) ) ) by L1201 , L1197 , L1200 , XBOOLE_1:1;
L1203: R2 c= R7 by L1202 , L1190 , ORDINAL4:22 , ORDINAL3:35;
L1204: R7 in R7 by L1203 , L1190;
thus L1205: contradiction by L1204;
end;
thus L1206: ( R2 -exponent ( R7 *^ ( exp (R2 , R1) ) ) ) = R1 by L1196 , L1192 , L1195 , L1125;
end;
theorem
L1207: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R3 being  ordinal number holds ((( 0 ) in R1 & 1 in R2 & R3 = ( R2 -exponent R1 )) implies ( R1 div^ ( exp (R2 , R3) ) ) in R2))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L1208: (( 0 ) in R1 & 1 in R2 & R3 = ( R2 -exponent R1 ));
set D84 = ( R1 div^ ( exp (R2 , R3) ) );
L1209: ( exp (R2 , R3) ) <> ( 0 ) by L1208 , ORDINAL4:22;
consider R4 being  ordinal number such that L1210: (R1 = ( ( D84 *^ ( exp (R2 , R3) ) ) +^ R4 ) & R4 in ( exp (R2 , R3) )) by L1209 , ORDINAL3:def 6;
assume L1211: (not D84 in R2);
L1212: ( R2 *^ ( exp (R2 , R3) ) ) c= ( D84 *^ ( exp (R2 , R3) ) ) by L1211 , ORDINAL1:16 , ORDINAL2:41;
L1213: (( exp (R2 , ( succ R3 )) ) c= ( D84 *^ ( exp (R2 , R3) ) ) & ( D84 *^ ( exp (R2 , R3) ) ) c= R1) by L1212 , L1210 , ORDINAL2:44 , ORDINAL3:24;
L1214: ( exp (R2 , ( succ R3 )) ) c= R1 by L1213 , XBOOLE_1:1;
L1215: (( succ R3 ) c= R3 & R3 in ( succ R3 )) by L1214 , L1208 , L1125 , ORDINAL1:6;
L1216: R3 in R3 by L1215;
thus L1217: contradiction by L1216;
end;
theorem
L1218: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R3 being  ordinal number holds ((( 0 ) in R1 & 1 in R2 & R3 = ( R2 -exponent R1 )) implies ( 0 ) in ( R1 div^ ( exp (R2 , R3) ) )))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L1219: (( 0 ) in R1 & 1 in R2 & R3 = ( R2 -exponent R1 ));
set D85 = ( R1 div^ ( exp (R2 , R3) ) );
L1220: ( exp (R2 , R3) ) <> ( 0 ) by L1219 , ORDINAL4:22;
consider R4 being  ordinal number such that L1221: (R1 = ( ( D85 *^ ( exp (R2 , R3) ) ) +^ R4 ) & R4 in ( exp (R2 , R3) )) by L1220 , ORDINAL3:def 6;
assume L1222: (not ( 0 ) in D85);
L1223: D85 = ( 0 ) by L1222 , ORDINAL3:8;
L1224: R1 = ( (( 0 ) qua Ordinal) +^ R4 ) by L1223 , L1221 , ORDINAL2:35
.= R4 by ORDINAL2:30;
L1225: ( exp (R2 , R3) ) c= R4 by L1224 , L1219 , L1125;
L1226: R4 in R4 by L1225 , L1221;
thus L1227: contradiction by L1226;
end;
theorem
L1228: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R3 being  ordinal number holds (R2 <> ( 0 ) implies ( R1 mod^ ( exp (R2 , R3) ) ) in ( exp (R2 , R3) )))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R3 being  ordinal number;
assume that
L1229: R2 <> ( 0 );
set D86 = ( R1 div^ ( exp (R2 , R3) ) );
L1230: ( exp (R2 , R3) ) <> ( 0 ) by L1229 , ORDINAL4:22;
consider R4 being  ordinal number such that L1231: (R1 = ( ( D86 *^ ( exp (R2 , R3) ) ) +^ R4 ) & R4 in ( exp (R2 , R3) )) by L1230 , ORDINAL3:def 6;
L1232: R4 = ( R1 -^ ( D86 *^ ( exp (R2 , R3) ) ) ) by L1231 , ORDINAL3:52
.= ( R1 mod^ ( exp (R2 , R3) ) ) by ORDINAL3:def 7;
thus L1233: thesis by L1232 , L1231;
end;
theorem
L1234: (for R1 being  ordinal number holds (( 0 ) in R1 implies (ex R7 being Nat st (ex R3 being  ordinal number st (R1 = ( ( R7 *^ ( exp (( omega ) , ( ( omega ) -exponent R1 )) ) ) +^ R3 ) & ( 0 ) in R7 & R3 in ( exp (( omega ) , ( ( omega ) -exponent R1 )) ))))))
proof
let R1 being  ordinal number;
assume L1235: ( 0 ) in R1;
set D87 = ( ( omega ) -exponent R1 );
set D88 = ( R1 div^ ( exp (( omega ) , D87) ) );
set D89 = ( R1 mod^ ( exp (( omega ) , D87) ) );
L1236: D88 in ( omega ) by L1235 , L1207;
reconsider D90 = D88 as Nat by L1236;
take D90;
take D89;
thus L1237: R1 = ( ( D90 *^ ( exp (( omega ) , D87) ) ) +^ D89 ) by ORDINAL3:65;
thus L1238: ( 0 ) in D90 by L1235 , L1218;
thus L1239: D89 in ( exp (( omega ) , D87) ) by L1228;
end;
theorem
L1240: (for R1 being  ordinal number holds (for R2 being  ordinal number holds (for R3 being  ordinal number holds ((1 in R3 & ( R3 -exponent R2 ) in ( R3 -exponent R1 )) implies R2 in R1))))
proof
let R1 being  ordinal number;
let R2 being  ordinal number;
let R3 being  ordinal number;
assume L1241: (1 in R3 & ( R3 -exponent R2 ) in ( R3 -exponent R1 ));
L1242: ( succ ( R3 -exponent R2 ) ) c= ( R3 -exponent R1 ) by L1241 , ORDINAL1:21;
L1243: ( exp (R3 , ( succ ( R3 -exponent R2 ) )) ) c= ( exp (R3 , ( R3 -exponent R1 )) ) by L1242 , L1241 , ORDINAL4:27;
L1244: ( 0 ) in R1 by L1241 , L1125;
L1245: R2 in ( exp (R3 , ( succ ( R3 -exponent R2 ) )) ) by L1241 , L1176;
L1246: (R2 in ( exp (R3 , ( R3 -exponent R1 )) ) & ( exp (R3 , ( R3 -exponent R1 )) ) c= R1) by L1245 , L1241 , L1243 , L1244 , L1125;
thus L1247: thesis by L1246;
end;
definition
let C131 being Ordinal-Sequence;
attr C131 is  Cantor-normal-form
means
:L1248: ((for R1 being  ordinal number holds (R1 in ( dom C131 ) implies ( C131 . R1 ) is  Cantor-component)) & (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom C131 )) implies ( ( omega ) -exponent ( C131 . R2 ) ) in ( ( omega ) -exponent ( C131 . R1 ) )))));
end;
registration
cluster  empty ->  Cantor-normal-form for Ordinal-Sequence;
coherence
proof
let R8 being Ordinal-Sequence;
assume L1250: R8 is  empty;
thus L1251: (for R1 being  ordinal number holds (R1 in ( dom R8 ) implies ( R8 . R1 ) is  Cantor-component)) by L1250;
thus L1252: thesis by L1250;
end;
cluster  Cantor-normal-form ->  decreasing for Ordinal-Sequence;
coherence
proof
let R8 being Ordinal-Sequence;
assume that
L1253: (for R1 being  ordinal number holds (R1 in ( dom R8 ) implies ( R8 . R1 ) is  Cantor-component))
and
L1254: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom R8 )) implies ( ( omega ) -exponent ( R8 . R2 ) ) in ( ( omega ) -exponent ( R8 . R1 ) ))));
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L1255: (R1 in R2 & R2 in ( dom R8 ));
L1256: ( ( omega ) -exponent ( R8 . R2 ) ) in ( ( omega ) -exponent ( R8 . R1 ) ) by L1255 , L1254;
thus L1257: thesis by L1256 , L1240;
end;
end;
theorem
L1259: (for R13 being  Cantor-normal-form Ordinal-Sequence holds (( Sum^ R13 ) = ( 0 ) implies R13 = ( {} )))
proof
let R13 being  Cantor-normal-form Ordinal-Sequence;
assume L1260: (( Sum^ R13 ) = ( 0 ) & R13 <> ( {} ));
L1261: ( 0 ) in ( dom R13 ) by L1260 , ORDINAL3:8;
reconsider D91 = ( R13 . ( 0 ) ) as  Cantor-component Ordinal by L1261 , L1248;
L1262: (( 0 ) in D91 & D91 c= ( Sum^ R13 )) by L1095 , ORDINAL3:8;
thus L1263: thesis by L1262 , L1260;
end;
theorem
L1264: (for R2 being  ordinal number holds (for R7 being Nat holds (( 0 ) in R7 implies <% ( R7 *^ ( exp (( omega ) , R2) ) ) %> is  Cantor-normal-form)))
proof
let R2 being  ordinal number;
let R7 being Nat;
assume L1265: ( 0 ) in R7;
set D92 = <% ( R7 *^ ( exp (( omega ) , R2) ) ) %>;
L1266: (( dom D92 ) = 1 & ( D92 . ( 0 ) ) = ( R7 *^ ( exp (( omega ) , R2) ) )) by AFINSQ_1:def 4;
thus L1267:now
let R1 being  ordinal number;
assume L1268: R1 in ( dom D92 );
L1269: (R1 = ( 0 ) & ( 0 ) in 1) by L1268 , L1266 , ORDINAL3:15 , TARSKI:def 1;
thus L1270: ( D92 . R1 ) is  Cantor-component by L1269 , L1265 , L1266 , L1117;
end;
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L1271: R1 in R2;
assume L1272: R2 in ( dom D92 );
thus L1273: ( ( omega ) -exponent ( D92 . R2 ) ) in ( ( omega ) -exponent ( D92 . R1 ) ) by L1272 , L1271 , L1266 , ORDINAL3:15 , TARSKI:def 1;
end;
registration
cluster non  empty  Cantor-normal-form for Ordinal-Sequence;
existence
proof
take D93 = <% ( 1 *^ ( exp (( omega ) , 1) ) ) %>;
thus L1274: D93 is non  empty;
L1275: ( 0 ) in 1 by NAT_1:44;
thus L1276: thesis by L1275 , L1264;
end;
end;
theorem
L1278: (for B114 , B115 being Ordinal-Sequence holds (( B114 ^ B115 ) is  Cantor-normal-form implies (B114 is  Cantor-normal-form & B115 is  Cantor-normal-form)))
proof
let C132 , C133 being Ordinal-Sequence;
set D94 = ( C132 ^ C133 );
assume that
L1279: (for R1 being  ordinal number holds (R1 in ( dom ( C132 ^ C133 ) ) implies ( ( C132 ^ C133 ) . R1 ) is  Cantor-component))
and
L1280: (for R1 being  ordinal number holds (for R2 being  ordinal number holds ((R1 in R2 & R2 in ( dom ( C132 ^ C133 ) )) implies ( ( omega ) -exponent ( ( C132 ^ C133 ) . R2 ) ) in ( ( omega ) -exponent ( ( C132 ^ C133 ) . R1 ) ))));
L1281: ( dom ( C132 ^ C133 ) ) = ( ( dom C132 ) +^ ( dom C133 ) ) by ORDINAL4:def 1;
L1282: ( dom C132 ) c= ( dom ( C132 ^ C133 ) ) by L1281 , ORDINAL3:24;
thus L1283: C132 is  Cantor-normal-form
proof
thus L1284:now
let R1 being  ordinal number;
assume L1285: R1 in ( dom C132 );
L1286: (( C132 . R1 ) = ( ( C132 ^ C133 ) . R1 ) & R1 in ( dom ( C132 ^ C133 ) )) by L1285 , L1282 , ORDINAL4:def 1;
thus L1287: ( C132 . R1 ) is  Cantor-component by L1286 , L1279;
end;
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L1288: (R1 in R2 & R2 in ( dom C132 ));
L1289: R1 in ( dom C132 ) by L1288 , ORDINAL1:10;
L1290: (( C132 . R1 ) = ( D94 . R1 ) & ( C132 . R2 ) = ( D94 . R2 ) & R2 in ( dom D94 )) by L1289 , L1282 , L1288 , ORDINAL4:def 1;
thus L1291: ( ( omega ) -exponent ( C132 . R2 ) ) in ( ( omega ) -exponent ( C132 . R1 ) ) by L1290 , L1280 , L1288;
end;

thus L1292:now
let R1 being  ordinal number;
assume L1293: R1 in ( dom C133 );
L1294: (( C133 . R1 ) = ( D94 . ( ( dom C132 ) +^ R1 ) ) & ( ( dom C132 ) +^ R1 ) in ( dom D94 )) by L1293 , L1281 , ORDINAL3:17 , ORDINAL4:def 1;
thus L1295: ( C133 . R1 ) is  Cantor-component by L1294 , L1279;
end;
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L1296: (R1 in R2 & R2 in ( dom C133 ));
L1297: R1 in ( dom C133 ) by L1296 , ORDINAL1:10;
L1298: (( C133 . R1 ) = ( D94 . ( ( dom C132 ) +^ R1 ) ) & ( C133 . R2 ) = ( D94 . ( ( dom C132 ) +^ R2 ) ) & ( ( dom C132 ) +^ R2 ) in ( dom D94 ) & ( ( dom C132 ) +^ R1 ) in ( ( dom C132 ) +^ R2 )) by L1297 , L1281 , L1296 , ORDINAL3:17 , ORDINAL4:def 1;
thus L1299: ( ( omega ) -exponent ( C133 . R2 ) ) in ( ( omega ) -exponent ( C133 . R1 ) ) by L1298 , L1280;
end;
theorem
L1300: (for R13 being  Cantor-normal-form Ordinal-Sequence holds (R13 <> ( {} ) implies (ex B116 being  Cantor-component Ordinal st (ex R14 being  Cantor-normal-form Ordinal-Sequence st R13 = ( <% B116 %> ^ R14 )))))
proof
let R13 being  Cantor-normal-form Ordinal-Sequence;
assume L1301: R13 <> ( {} );
consider C134 being Nat such that L1302: ( len R13 ) = ( C134 + 1 ) by L1301 , NAT_1:6;
reconsider D95 = C134 as (Element of ( NAT )) by ORDINAL1:def 12;
L1303: ( D95 + 1 ) = ( 1 +^ D95 ) by CARD_2:36;
consider R11 being T-Sequence, R12 being T-Sequence such that L1304: (R13 = ( R11 ^ R12 ) & ( dom R11 ) = 1 & ( dom R12 ) = D95) by L1303 , L1302 , L18;
reconsider D96 = R11 , D97 = R12 as Ordinal-Sequence by L1304 , L45;
L1305: ( D96 ^ D97 ) is  Cantor-normal-form by L1304;
reconsider D98 = D96 , D99 = D97 as  Cantor-normal-form Ordinal-Sequence by L1305 , L1278;
L1306: ( 0 ) in 1 by NAT_1:44;
reconsider D100 = ( D98 . ( 0 ) ) as  Cantor-component Ordinal by L1306 , L1304 , L1248;
take D100;
take D99;
L1307: ( len D98 ) = 1 by L1304;
thus L1308: thesis by L1307 , L1304 , AFINSQ_1:34;
end;
theorem
L1309: (for B117 being non  empty  Cantor-normal-form Ordinal-Sequence holds (for B118 being  Cantor-component Ordinal holds (( ( omega ) -exponent ( B117 . ( 0 ) ) ) in ( ( omega ) -exponent B118 ) implies ( <% B118 %> ^ B117 ) is  Cantor-normal-form)))
proof
let C135 being non  empty  Cantor-normal-form Ordinal-Sequence;
let C136 being  Cantor-component Ordinal;
assume that
L1310: ( ( omega ) -exponent ( C135 . ( 0 ) ) ) in ( ( omega ) -exponent C136 );
set D101 = ( <% C136 %> ^ C135 );
L1311: (( dom <% C136 %> ) = 1 & ( <% C136 %> . ( 0 ) ) = C136) by AFINSQ_1:def 4;
L1312: ( dom D101 ) = ( 1 +^ ( dom C135 ) ) by L1311 , ORDINAL4:def 1;
thus L1313:now
let R1 being  ordinal number;
assume L1314: R1 in ( dom D101 );
per cases  by L1312 , L1314 , ORDINAL3:38;
suppose L1315: R1 in 1;

L1316: R1 = ( 0 ) by L1315 , ORDINAL3:15 , TARSKI:def 1;
thus L1317: ( D101 . R1 ) is  Cantor-component by L1316 , L1311 , L1315 , ORDINAL4:def 1;
end;
suppose L1318: (ex R2 being  ordinal number st (R2 in ( dom C135 ) & R1 = ( 1 +^ R2 )));

consider R2 being  ordinal number such that L1319: (R2 in ( dom C135 ) & R1 = ( 1 +^ R2 )) by L1318;
L1320: ( D101 . R1 ) = ( C135 . R2 ) by L1311 , L1319 , ORDINAL4:def 1;
thus L1321: ( D101 . R1 ) is  Cantor-component by L1320 , L1319 , L1248;
end;
end;
let R1 being  ordinal number;
let R2 being  ordinal number;
assume L1323: (R1 in R2 & R2 in ( dom D101 ));
per cases ;
suppose L1324: (not R1 in 1);

L1325: 1 c= R1 by L1324 , ORDINAL1:16;
L1326: (1 in R2 & R1 in ( dom D101 ) & ( ( 1 +^ ( dom C135 ) ) -^ 1 ) = ( dom C135 )) by L1325 , L1323 , ORDINAL1:10 , ORDINAL1:12 , ORDINAL3:52;
L1327: (( R2 -^ 1 ) in ( dom C135 ) & ( R1 -^ 1 ) in ( dom C135 ) & ( R1 -^ 1 ) in ( R2 -^ 1 )) by L1326 , L1325 , L1312 , L1323 , ORDINAL3:53;
L1328: (R2 = ( 1 +^ ( R2 -^ 1 ) ) & R1 = ( 1 +^ ( R1 -^ 1 ) )) by L1325 , L1326 , ORDINAL3:51 , ORDINAL3:def 5;
L1329: (( D101 . R1 ) = ( C135 . ( R1 -^ 1 ) ) & ( D101 . R2 ) = ( C135 . ( R2 -^ 1 ) )) by L1328 , L1311 , L1327 , ORDINAL4:def 1;
thus L1330: thesis by L1329 , L1327 , L1248;
end;
suppose L1331: R1 in 1;

L1332: (( D101 . R1 ) = ( <% C136 %> . R1 ) & R1 = ( 0 )) by L1331 , L1311 , ORDINAL3:15 , ORDINAL4:def 1 , TARSKI:def 1;
L1333: ( succ ( 0 ) ) c= R2 by L1332 , L1323 , ORDINAL1:21;
L1334: ( R2 -^ 1 ) in ( ( 1 +^ ( dom C135 ) ) -^ 1 ) by L1333 , L1312 , L1323 , ORDINAL3:53;
L1335: (( R2 -^ 1 ) in ( dom C135 ) & R2 = ( 1 +^ ( R2 -^ 1 ) )) by L1334 , L1333 , ORDINAL3:52 , ORDINAL3:def 5;
L1336: ( D101 . R2 ) = ( C135 . ( R2 -^ 1 ) ) by L1335 , L1311 , ORDINAL4:def 1;
L1337: (( 0 ) in ( dom C135 ) & (( R2 -^ 1 ) = ( 0 ) or ( 0 ) in ( R2 -^ 1 ))) by ORDINAL3:8;
L1338: (( ( omega ) -exponent ( C135 . ( 0 ) ) ) = ( ( omega ) -exponent ( C135 . ( R2 -^ 1 ) ) ) or ( ( omega ) -exponent ( C135 . ( R2 -^ 1 ) ) ) in ( ( omega ) -exponent ( C135 . ( 0 ) ) )) by L1337 , L1335 , L1248;
thus L1339: thesis by L1338 , L1310 , L1311 , L1332 , L1336 , ORDINAL1:10;
end;
end;
::$N Existence of Cantor Normal Form for ordinal numbers
theorem
L1341: (for R1 being  ordinal number holds (ex B119 being  Cantor-normal-form Ordinal-Sequence st R1 = ( Sum^ B119 )))
proof
let R1 being  ordinal number;
defpred S31[ Ordinal ] means (( 0 ) in $1 implies (ex B120 being non  empty  Cantor-normal-form Ordinal-Sequence st $1 = ( Sum^ B120 )));
L1342: (for R1 being  ordinal number holds ((for R2 being  ordinal number holds (R2 in R1 implies S31[ R2 ])) implies S31[ R1 ]))
proof
let R1 being  ordinal number;
assume that
L1343: (for R2 being  ordinal number holds (R2 in R1 implies S31[ R2 ]))
and
L1344: ( 0 ) in R1;
consider R7 being Nat, R2 being  ordinal number such that L1345: (R1 = ( ( R7 *^ ( exp (( omega ) , ( ( omega ) -exponent R1 )) ) ) +^ R2 ) & ( 0 ) in R7 & R2 in ( exp (( omega ) , ( ( omega ) -exponent R1 )) )) by L1344 , L1234;
reconsider D102 = ( R7 *^ ( exp (( omega ) , ( ( omega ) -exponent R1 )) ) ) as  Cantor-component Ordinal by L1345 , L1117;
set D103 = ( ( omega ) -exponent R1 );
L1346: ( exp (( omega ) , D103) ) c= R1 by L1344 , L1125;
per cases  by ORDINAL3:8;
suppose L1347: R2 = ( 0 );

reconsider D104 = <% ( R7 *^ ( exp (( omega ) , ( ( omega ) -exponent R1 )) ) ) %> as non  empty  Cantor-normal-form Ordinal-Sequence by L1345 , L1264;
take D104;
thus L1348: R1 = ( R7 *^ ( exp (( omega ) , ( ( omega ) -exponent R1 )) ) ) by L1345 , L1347 , ORDINAL2:27
.= ( Sum^ D104 ) by L1058;
end;
suppose L1349: ( 0 ) in R2;

consider C137 being non  empty  Cantor-normal-form Ordinal-Sequence such that L1350: R2 = ( Sum^ C137 ) by L1349 , L1346 , L1343 , L1345;
L1351: ( C137 . ( 0 ) ) in ( exp (( omega ) , ( ( omega ) -exponent R1 )) ) by L1345 , L1350 , L1095 , ORDINAL1:12;
L1352: ( 0 ) in ( dom C137 ) by ORDINAL3:8;
L1353: ( C137 . ( 0 ) ) is  Cantor-component  Cantor-component  Cantor-component  Cantor-component Ordinal by L1352 , L1248;
L1354: ( 0 ) in ( C137 . ( 0 ) ) by L1353 , ORDINAL3:8;
L1355: ( exp (( omega ) , ( ( omega ) -exponent ( C137 . ( 0 ) ) )) ) c= ( C137 . ( 0 ) ) by L1354 , L1125;
L1356: ( exp (( omega ) , ( ( omega ) -exponent ( C137 . ( 0 ) ) )) ) in ( exp (( omega ) , ( ( omega ) -exponent R1 )) ) by L1355 , L1351 , ORDINAL1:12;
L1357: R7 in ( omega ) by ORDINAL1:def 12;
L1358: ( ( omega ) -exponent D102 ) = ( ( omega ) -exponent R1 ) by L1357 , L1345 , L1189;
reconsider D105 = ( <% D102 %> ^ C137 ) as non  empty  Cantor-normal-form Ordinal-Sequence by L1358 , L1356 , L1309 , L171;
take D105;
thus L1359: R1 = ( Sum^ D105 ) by L1345 , L1350 , L1081;
end;
end;
L1361: (for R2 being  ordinal number holds S31[ R2 ]) from ORDINAL1:sch 2(L1342);
per cases  by ORDINAL3:8;
suppose L1362: R1 = ( 0 );

reconsider D106 = ( {} ) as  Cantor-normal-form Ordinal-Sequence;
take D106;
thus L1363: thesis by L1362 , L1051;
end;
suppose L1364: ( 0 ) in R1;

L1365: (ex B121 being non  empty  Cantor-normal-form Ordinal-Sequence st R1 = ( Sum^ B121 )) by L1364 , L1361;
thus L1366: thesis by L1365;
end;
end;
