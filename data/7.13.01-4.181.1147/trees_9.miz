:: Subtrees
::  by Grzegorz Bancerek
::
:: Received November 25, 1994
:: Copyright (c) 1994-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies XBOOLE_0, TREES_3, SUBSET_1, FINSET_1, TREES_2, TREES_1, CARD_1,
      ARYTM_3, NAT_1, ORDINAL4, FINSEQ_1, ARYTM_1, RELAT_1, FUNCT_1, TARSKI,
      ORDINAL1, NUMBERS, XXREAL_0, ZFMISC_1, TREES_4, FUNCT_6, TREES_A,
      TREES_9, MCART_1;
 notations TARSKI, XBOOLE_0, ZFMISC_1,
      XTUPLE_0, SUBSET_1, CARD_1, NUMBERS, XCMPLX_0,
      RELAT_1, FUNCT_1, RELSET_1, FUNCT_2, FUNCT_6, ORDINAL1, NAT_1, BINOP_1,
      FINSET_1, FINSEQ_1, FINSEQ_2, TREES_1, TREES_2, TREES_3, TREES_4,
      MCART_1, XXREAL_0;
 constructors WELLORD2, XXREAL_0, XREAL_0, NAT_1, FINSEQ_2, TREES_4, RELSET_1,
      BINOP_1, FINSEQ_4, XTUPLE_0;
 registrations XBOOLE_0, RELAT_1, FUNCT_1, ORDINAL1, FINSET_1, XREAL_0,
      FINSEQ_1, TREES_1, TREES_2, TREES_3, PRE_CIRC, CARD_1, ZFMISC_1,
      REALSET1, BINOP_1, SUBSET_1, RELSET_1, NAT_1, TREES_A, XTUPLE_0;
 requirements NUMERALS, BOOLE, SUBSET, ARITHM, REAL;
 definitions TARSKI, XBOOLE_0, FUNCT_1, TREES_2, TREES_3, TREES_4, BINOP_1,
      XTUPLE_0;
 theorems TARSKI, AXIOMS, ZFMISC_1, NAT_1, WELLORD2, FUNCT_1, FUNCT_2,
      FINSEQ_1, FINSEQ_3, CARD_1, CARD_2, FUNCT_6, TREES_1, TREES_2, TREES_3,
      TREES_4, RELSET_1, RELAT_1, XBOOLE_0, XBOOLE_1, FINSET_1, XREAL_1,
      XXREAL_0, ORDINAL1, FINSEQ_2, TREES_A, MCART_1, FINSEQ_6, XTUPLE_0;
 schemes NAT_1, FUNCT_1, FINSEQ_1, CLASSES1, FUNCT_2, TREES_2;

begin
definition
let C1 being non  empty set;
let C2 being non  empty (DTree-set of C1);
let C3 being non  empty (Subset of C2);
redefine mode Element of C3
 -> (Element of C2);
coherence
proof
let C4 being (Element of C3);
thus L1: thesis;
end;
end;
registration
cluster  finite ->  finite-order for Tree;
coherence
proof
let C5 being Tree;
assume L3: C5 is  finite;
reconsider D1 = C5 as  finite Tree by L3;
take D2 = ( ( card D1 ) + 1 );
let C6 being (Element of C5);
deffunc H1(Nat) = ( C6 ^ <* ( $1 - 1 ) *> );
consider C7 being FinSequence such that L4: (( len C7 ) = D2 & (for B1 being Nat holds (B1 in ( dom C7 ) implies ( C7 . B1 ) = H1(B1)))) from FINSEQ_1:sch 2;
L5: ( dom C7 ) = ( Seg D2 ) by L4 , FINSEQ_1:def 3;
assume L6: ( C6 ^ <* D2 *> ) in C5;
L7: ( rng C7 ) c= ( succ C6 )
proof
let C8 being set;
assume L8: C8 in ( rng C7 );
consider C9 being set such that L9: C9 in ( dom C7 ) and L10: C8 = ( C7 . C9 ) by L8 , FUNCT_1:def 3;
reconsider D3 = C9 as (Element of ( NAT )) by L9;
L11: D3 >= 1 by L5 , L9 , FINSEQ_1:1;
consider C10 being Nat such that L12: D3 = ( 1 + C10 ) by L11 , NAT_1:10;
reconsider D4 = C10 as (Element of ( NAT )) by ORDINAL1:def 12;
L13: D4 <= D3 by L12 , NAT_1:11;
L14: D3 <= D2 by L5 , L9 , FINSEQ_1:1;
L15: D4 <= D2 by L14 , L13 , XXREAL_0:2;
L16: ( C6 ^ <* D4 *> ) in C5 by L15 , L6 , TREES_1:def 3;
L17: ( D3 - 1 ) = D4 by L12;
L18: C8 = ( C6 ^ <* D4 *> ) by L17 , L4 , L9 , L10;
thus L19: thesis by L18 , L16;
end;
L20: ( card ( succ C6 ) ) c= ( card C5 ) by CARD_1:11;
L21: C7 is  one-to-one
proof
let C11 , C12 being set;
assume that
L22: (C11 in ( dom C7 ) & C12 in ( dom C7 ))
and
L23: ( C7 . C11 ) = ( C7 . C12 );
reconsider D5 = C11 , D6 = C12 as (Element of ( NAT )) by L22;
L24: (( C7 . C11 ) = ( C6 ^ <* ( D5 - 1 ) *> ) & ( C7 . C12 ) = ( C6 ^ <* ( D6 - 1 ) *> )) by L4 , L22;
L25: <* ( D5 - 1 ) *> = <* ( D6 - 1 ) *> by L24 , L23 , FINSEQ_1:33;
L26: ( D5 - 1 ) = ( <* ( D6 - 1 ) *> . 1 ) by L25 , FINSEQ_1:40
.= ( D6 - 1 ) by FINSEQ_1:40;
thus L27: thesis by L26;
end;
L28: ( card ( dom C7 ) ) c= ( card ( succ C6 ) ) by L21 , L7 , CARD_1:10;
L29: ( card ( dom C7 ) ) c= ( card C5 ) by L28 , L20 , XBOOLE_1:1;
L30: ( card D1 ) <= D2 by NAT_1:11;
L31: ( card ( Seg D2 ) ) = D2 by FINSEQ_1:57;
L32: D2 <= ( card D1 ) by L31 , L5 , L29 , NAT_1:39;
L33: D2 = ( ( card D1 ) + ( 0 ) ) by L32 , L30 , XXREAL_0:1;
thus L34: contradiction by L33;
end;
end;
L36: (for B2 being set holds (for B3 being FinSequence holds (B2 in ( dom B3 ) implies (ex B4 being (Element of ( NAT )) st (B2 = ( B4 + 1 ) & B4 < ( len B3 ))))))
proof
let C13 being set;
let C14 being FinSequence;
assume L37: C13 in ( dom C14 );
reconsider D7 = C13 as (Element of ( NAT )) by L37;
L38: D7 >= 1 by L37 , FINSEQ_3:25;
consider C15 being Nat such that L39: D7 = ( 1 + C15 ) by L38 , NAT_1:10;
reconsider D8 = C15 as (Element of ( NAT )) by ORDINAL1:def 12;
take D8;
L40: D7 <= ( len C14 ) by L37 , FINSEQ_3:25;
thus L41: thesis by L40 , L39 , NAT_1:13;
end;
L42:
now
let C16 , C17 being FinSequence;
assume that
L43: ( len C16 ) = ( len C17 )
and
L44: (for B5 being (Element of ( NAT )) holds (B5 < ( len C16 ) implies ( C16 . ( B5 + 1 ) ) = ( C17 . ( B5 + 1 ) )));
L45:
now
let C18 being Nat;
assume L46: C18 in ( dom C16 );
L47: (ex B6 being (Element of ( NAT )) st (C18 = ( B6 + 1 ) & B6 < ( len C16 ))) by L46 , L36;
thus L48: ( C16 . C18 ) = ( C17 . C18 ) by L47 , L44;
end;
L49: ( dom C16 ) = ( dom C17 ) by L43 , FINSEQ_3:29;
thus L50: C16 = C17 by L49 , L45 , FINSEQ_1:13;
end;
L51: (for B7 being (Element of ( NAT )) holds (for B8 being FinSequence holds (B7 < ( len B8 ) implies (( B7 + 1 ) in ( dom B8 ) & ( B8 . ( B7 + 1 ) ) in ( rng B8 )))))
proof
let C19 being (Element of ( NAT ));
let C20 being FinSequence;
L52: C19 >= ( 0 ) by NAT_1:2;
L53: ( C19 + 1 ) >= ( ( 0 ) + 1 ) by L52 , XREAL_1:7;
assume L54: C19 < ( len C20 );
L55: ( C19 + 1 ) <= ( len C20 ) by L54 , NAT_1:13;
L56: ( C19 + 1 ) in ( dom C20 ) by L55 , L53 , FINSEQ_3:25;
thus L57: thesis by L56 , FUNCT_1:def 3;
end;
L58:
now
let C21 being FinSequence;
let C22 being set;
assume L59: C22 in ( rng C21 );
consider C23 being set such that L60: C23 in ( dom C21 ) and L61: C22 = ( C21 . C23 ) by L59 , FUNCT_1:def 3;
L62: (ex B9 being (Element of ( NAT )) st (C23 = ( B9 + 1 ) & B9 < ( len C21 ))) by L60 , L36;
thus L63: (ex B10 being (Element of ( NAT )) st (B10 < ( len C21 ) & C22 = ( C21 . ( B10 + 1 ) ))) by L62 , L61;
end;
theorem
L64: (for B11 being DecoratedTree holds ( B11 | ( <*> ( NAT ) ) ) = B11)
proof
let C24 being DecoratedTree;
L65: ( dom ( C24 | ( <*> ( NAT ) ) ) ) = ( ( dom C24 ) | ( <*> ( NAT ) ) ) by TREES_2:def 10;
L66:
now
let C25 being (FinSequence of ( NAT ));
assume L67: C25 in ( dom ( C24 | ( <*> ( NAT ) ) ) );
thus L68: ( ( C24 | ( <*> ( NAT ) ) ) . C25 ) = ( C24 . ( ( {} ) ^ C25 ) ) by L67 , L65 , TREES_2:def 10
.= ( C24 . C25 ) by FINSEQ_1:34;
end;
thus L69: thesis by L66 , L65 , TREES_1:31 , TREES_2:31;
end;
theorem
L70: (for B12 being Tree holds (for B13 , B14 being (FinSequence of ( NAT )) holds (( B13 ^ B14 ) in B12 implies ( B12 | ( B13 ^ B14 ) ) = ( ( B12 | B13 ) | B14 ))))
proof
let C26 being Tree;
let C27 , C28 being (FinSequence of ( NAT ));
assume L71: ( C27 ^ C28 ) in C26;
let C29 being (FinSequence of ( NAT ));
L72: C27 in C26 by L71 , TREES_1:21;
L73: C28 in ( C26 | C27 ) by L72 , L71 , TREES_1:def 6;
L74: (C29 in ( ( C26 | C27 ) | C28 ) iff ( C28 ^ C29 ) in ( C26 | C27 )) by L73 , TREES_1:def 6;
L75: ( ( C27 ^ C28 ) ^ C29 ) = ( C27 ^ ( C28 ^ C29 ) ) by FINSEQ_1:32;
L76: (C29 in ( C26 | ( C27 ^ C28 ) ) iff ( ( C27 ^ C28 ) ^ C29 ) in C26) by L71 , TREES_1:def 6;
thus L77: thesis by L76 , L72 , L75 , L74 , TREES_1:def 6;
end;
theorem
L78: (for B15 being DecoratedTree holds (for B16 , B17 being (FinSequence of ( NAT )) holds (( B16 ^ B17 ) in ( dom B15 ) implies ( B15 | ( B16 ^ B17 ) ) = ( ( B15 | B16 ) | B17 ))))
proof
let C30 being DecoratedTree;
let C31 , C32 being (FinSequence of ( NAT ));
L79: ( dom ( C30 | C31 ) ) = ( ( dom C30 ) | C31 ) by TREES_2:def 10;
L80: ( dom ( C30 | ( C31 ^ C32 ) ) ) = ( ( dom C30 ) | ( C31 ^ C32 ) ) by TREES_2:def 10;
assume L81: ( C31 ^ C32 ) in ( dom C30 );
L82: C31 in ( dom C30 ) by L81 , TREES_1:21;
L83: C32 in ( ( dom C30 ) | C31 ) by L82 , L81 , TREES_1:def 6;
L84:
now
let C33 being (FinSequence of ( NAT ));
L85: ( ( C31 ^ C32 ) ^ C33 ) = ( C31 ^ ( C32 ^ C33 ) ) by FINSEQ_1:32;
assume L86: C33 in ( dom ( C30 | ( C31 ^ C32 ) ) );
L87: ( ( C31 ^ C32 ) ^ C33 ) in ( dom C30 ) by L86 , L81 , L80 , TREES_1:def 6;
L88: ( C32 ^ C33 ) in ( ( dom C30 ) | C31 ) by L87 , L82 , L85 , TREES_1:def 6;
L89: C33 in ( ( ( dom C30 ) | C31 ) | C32 ) by L88 , L83 , TREES_1:def 6;
thus L90: ( ( C30 | ( C31 ^ C32 ) ) . C33 ) = ( C30 . ( ( C31 ^ C32 ) ^ C33 ) ) by L80 , L86 , TREES_2:def 10
.= ( ( C30 | C31 ) . ( C32 ^ C33 ) ) by L85 , L88 , TREES_2:def 10
.= ( ( ( C30 | C31 ) | C32 ) . C33 ) by L79 , L89 , TREES_2:def 10;
end;
L91: ( dom ( ( C30 | C31 ) | C32 ) ) = ( ( dom ( C30 | C31 ) ) | C32 ) by TREES_2:def 10;
thus L92: thesis by L91 , L81 , L79 , L80 , L84 , L70 , TREES_2:31;
end;
notation
let C34 being DecoratedTree;
synonym C34 is  root for C34 is  trivial;
end;
definition
let C35 being DecoratedTree;
redefine attr C35 is  root
means
:L94: ( dom C35 ) = ( elementary_tree ( 0 ) );
compatibility
proof
thus L95: (C35 is  root implies ( dom C35 ) = ( elementary_tree ( 0 ) ))
proof
L96: (not ( dom C35 ) is  empty);
L97: (not C35 is  empty) by L96;
assume L98: C35 is  root;
consider C36 being set such that L99: C35 = { C36 } by L98 , L97 , ZFMISC_1:131;
L100: C36 in C35 by L99 , TARSKI:def 1;
consider C37 , C38 being set such that L101: C36 = [ C37 , C38 ] by L100 , RELAT_1:def 1;
L102: (( {} ) in ( dom C35 ) & ( dom C35 ) = { C37 }) by L99 , L101 , RELAT_1:9 , TREES_1:22;
thus L103: ( dom C35 ) = ( elementary_tree ( 0 ) ) by L102 , TARSKI:def 1 , TREES_1:29;
end;

thus L104: thesis by TREES_1:29;
end;
end;
theorem
L106: (for B18 being DecoratedTree holds (B18 is  root iff ( {} ) in ( Leaves ( dom B18 ) )))
proof
let C39 being DecoratedTree;
reconsider D9 = ( {} ) as (Node of C39) by TREES_1:22;
thus L107:now
assume L108: C39 is  root;
L109: ( dom C39 ) = ( elementary_tree ( 0 ) ) by L108 , L94;
L110: (not ( D9 ^ <* ( 0 ) *> ) in ( dom C39 )) by L109 , TARSKI:def 1 , TREES_1:29;
thus L111: ( {} ) in ( Leaves ( dom C39 ) ) by L110 , TREES_1:54;
end;
assume L112: ( {} ) in ( Leaves ( dom C39 ) );
let C40 being (FinSequence of ( NAT ));
thus L113:now
assume that
L114: C40 in ( dom C39 )
and
L115: (not C40 in ( elementary_tree ( 0 ) ));
L116: C40 <> ( {} ) by L115 , TARSKI:def 1 , TREES_1:29;
consider C41 being (FinSequence of ( NAT )), C42 being (Element of ( NAT )) such that L117: C40 = ( <* C42 *> ^ C41 ) by L116 , FINSEQ_2:130;
L118: ( D9 ^ <* C42 *> ) = <* C42 *> by FINSEQ_1:34;
L119: <* C42 *> in ( dom C39 ) by L114 , L117 , TREES_1:21;
thus L120: contradiction by L119 , L112 , L118 , TREES_1:55;
end;
assume L121: C40 in ( elementary_tree ( 0 ) );
L122: C40 = ( {} ) by L121 , TARSKI:def 1 , TREES_1:29;
thus L123: thesis by L122 , TREES_1:22;
end;
theorem
L124: (for B19 being Tree holds (for B20 being (Element of B19) holds (( B19 | B20 ) = ( elementary_tree ( 0 ) ) iff B20 in ( Leaves B19 ))))
proof
let C43 being Tree;
let C44 being (Element of C43);
L125: (not <* ( 0 ) *> in ( elementary_tree ( 0 ) )) by TARSKI:def 1 , TREES_1:29;
thus L126:now
assume L127: ( C43 | C44 ) = ( elementary_tree ( 0 ) );
L128: (not ( C44 ^ <* ( 0 ) *> ) in C43) by L127 , L125 , TREES_1:def 6;
thus L129: C44 in ( Leaves C43 ) by L128 , TREES_1:54;
end;
assume L130: C44 in ( Leaves C43 );
let C45 being (FinSequence of ( NAT ));
thus L131:now
assume L132: C45 in ( C43 | C44 );
L133: ( C44 ^ C45 ) in C43 by L132 , TREES_1:def 6;
L134: (not C44 is_a_proper_prefix_of ( C44 ^ C45 )) by L133 , L130 , TREES_1:def 5;
L135: C44 is_a_prefix_of ( C44 ^ C45 ) by TREES_1:1;
L136: ( C44 ^ C45 ) = C44 by L135 , L134 , XBOOLE_0:def 8
.= ( C44 ^ ( {} ) ) by FINSEQ_1:34;
L137: C45 = ( {} ) by L136 , FINSEQ_1:33;
thus L138: C45 in ( elementary_tree ( 0 ) ) by L137 , TREES_1:22;
end;
assume L139: C45 in ( elementary_tree ( 0 ) );
L140: C45 = ( {} ) by L139 , TARSKI:def 1 , TREES_1:29;
thus L141: thesis by L140 , TREES_1:22;
end;
theorem
L142: (for B21 being DecoratedTree holds (for B22 being (Node of B21) holds (( B21 | B22 ) is  root iff B22 in ( Leaves ( dom B21 ) ))))
proof
let C46 being DecoratedTree;
let C47 being (Node of C46);
L143: ( dom ( C46 | C47 ) ) = ( ( dom C46 ) | C47 ) by TREES_2:def 10;
L144: (( C46 | C47 ) is  root iff ( dom ( C46 | C47 ) ) = ( elementary_tree ( 0 ) )) by L94;
thus L145: thesis by L144 , L143 , L124;
end;
registration
cluster  root for DecoratedTree;
existence
proof
take D10 = ( root-tree ( 0 ) );
thus L146: ( dom D10 ) = ( elementary_tree ( 0 ) ) by TREES_4:3;
end;
cluster  finite non  root for DecoratedTree;
existence
proof
take D11 = ( ( 0 ) -tree ( root-tree ( 0 ) ) );
L147: ( dom D11 ) = ( ^ ( dom ( root-tree ( 0 ) ) ) ) by TREES_4:13
.= ( elementary_tree 1 ) by TREES_3:67 , TREES_4:3;
thus L148: D11 is  finite by L147 , FINSET_1:10;
assume L149: ( dom D11 ) = ( elementary_tree ( 0 ) );
L150: ( root-tree ( D11 . ( {} ) ) ) = D11 by L149 , TREES_4:5
.= ( ( 0 ) -tree <* ( root-tree ( 0 ) ) *> );
thus L151: contradiction by L150 , TREES_4:17;
end;
end;
registration
let C48 being set;
cluster ( root-tree C48 ) ->  finite  root;
coherence
proof
L153: ( dom ( root-tree C48 ) ) = ( elementary_tree ( 0 ) ) by TREES_4:3;
thus L154: thesis by L153 , L94;
end;
end;
definition
let C49 being Tree;
attr C49 is  finite-branching
means
:L156: (for B23 being (Element of C49) holds ( succ B23 ) is  finite);
end;
registration
cluster  finite-order ->  finite-branching for Tree;
coherence
proof
let C50 being Tree;
assume L158: C50 is  finite-order;
reconsider D12 = C50 as  finite-order Tree by L158;
let C51 being (Element of C50);
reconsider D13 = C51 as (Element of D12);
L159: ( succ D13 ) is  finite;
thus L160: thesis by L159;
end;
end;
definition
let C52 being DecoratedTree;
attr C52 is  finite-order
means
:L162: ( dom C52 ) is  finite-order;
attr C52 is  finite-branching
means
:L163: ( dom C52 ) is  finite-branching;
end;
registration
cluster  finite ->  finite-order for DecoratedTree;
coherence
proof
let C53 being DecoratedTree;
assume L165: C53 is  finite;
thus L166: ( dom C53 ) is  finite-order by L165;
end;
cluster  finite-order ->  finite-branching for DecoratedTree;
coherence
proof
let C54 being DecoratedTree;
assume L167: ( dom C54 ) is  finite-order;
thus L168: ( dom C54 ) is  finite-branching by L167;
end;
end;
registration
let C55 being  finite-order DecoratedTree;
cluster ( dom C55 ) ->  finite-order;
coherence by L162;
end;
registration
let C56 being  finite-branching DecoratedTree;
cluster ( dom C56 ) ->  finite-branching;
coherence by L163;
end;
registration
let C57 being  finite-branching Tree;
let C58 being (Element of C57);
cluster ( succ C58 ) ->  finite;
coherence by L156;
end;
scheme FinOrdSet { F1(set) -> set , F2() ->  finite set } : (for B24 being (Element of ( NAT )) holds (F1(B24) in F2() iff B24 < ( card F2() )))
provided
L173: (for B25 being set holds (B25 in F2() implies (ex B26 being (Element of ( NAT )) st B25 = F1(B26))))
and
L174: (for B27 , B28 being (Element of ( NAT )) holds ((B27 < B28 & F1(B28) in F2()) implies F1(B27) in F2()))
and
L175: (for B29 , B30 being (Element of ( NAT )) holds (F1(B29) = F1(B30) implies B29 = B30))
proof
consider C59 being Function such that L176: (( dom C59 ) = ( card F2() ) & (for B31 being set holds (B31 in ( card F2() ) implies ( C59 . B31 ) = F1(B31)))) from FUNCT_1:sch 3;
defpred S1[ (Element of ( NAT )) ] means ($1 < ( card F2() ) implies F1($1) in F2());
L177: (for B32 being (Element of ( NAT )) holds (S1[ B32 ] implies S1[ ( B32 + 1 ) ]))
proof
let C60 being (Element of ( NAT ));
assume that
L178: (C60 < ( card F2() ) implies F1(C60) in F2())
and
L179: ( C60 + 1 ) < ( card F2() )
and
L180: (not F1(( C60 + 1 )) in F2());
consider C61 being Function such that L181: (( dom C61 ) = ( C60 + 1 ) & (for B33 being set holds (B33 in ( C60 + 1 ) implies ( C61 . B33 ) = F1(B33)))) from FUNCT_1:sch 3;
L182: ( C60 + 1 ) = { B34 where B34 is (Element of ( NAT )) : B34 < ( C60 + 1 ) } by AXIOMS:4;
L183: C60 <= ( C60 + 1 ) by NAT_1:11;
L184: ( rng C61 ) = F2()
proof
thus L185:now
let C62 being set;
assume L186: C62 in ( rng C61 );
consider C63 being set such that L187: C63 in ( C60 + 1 ) and L188: C62 = ( C61 . C63 ) by L186 , L181 , FUNCT_1:def 3;
consider C64 being (Element of ( NAT )) such that L189: C63 = C64 and L190: C64 < ( C60 + 1 ) by L182 , L187;
L191: C64 <= C60 by L190 , NAT_1:13;
L192: (C64 = C60 or C64 < C60) by L191 , XXREAL_0:1;
L193: F1(C64) in F2() by L192 , L174 , L178 , L179 , L183 , XXREAL_0:2;
thus L194: C62 in F2() by L193 , L181 , L187 , L188 , L189;
end;
let C65 being set;
assume L195: C65 in F2();
consider C66 being (Element of ( NAT )) such that L196: C65 = F1(C66) by L195 , L173;
L197:
now
assume L198: C66 >= ( C60 + 1 );
L199: (C66 = ( C60 + 1 ) or C66 > ( C60 + 1 )) by L198 , XXREAL_0:1;
thus L200: contradiction by L199 , L174 , L180 , L195 , L196;
end;
L201: C66 in ( C60 + 1 ) by L197 , L182;
L202: C65 = ( C61 . C66 ) by L201 , L181 , L196;
thus L203: thesis by L202 , L181 , L201 , FUNCT_1:def 3;
end;
L204: C61 is  one-to-one
proof
let C67 , C68 being set;
assume that
L205: C67 in ( dom C61 )
and
L206: C68 in ( dom C61 )
and
L207: ( C61 . C67 ) = ( C61 . C68 );
L208: ((ex B35 being (Element of ( NAT )) st (C67 = B35 & B35 < ( C60 + 1 ))) & (ex B36 being (Element of ( NAT )) st (C68 = B36 & B36 < ( C60 + 1 )))) by L181 , L182 , L205 , L206;
L209: (F1(C67) = F1(C68) implies C67 = C68) by L208 , L175;
L210: F1(C67) = ( C61 . C67 ) by L181 , L205;
thus L211: thesis by L210 , L181 , L206 , L207 , L209;
end;
L212: ( C60 + 1 ) , F2() are_equipotent  by L204 , L181 , L184 , WELLORD2:def 4;
thus L213: thesis by L212 , L179 , CARD_1:def 2;
end;
L214: ( card F2() ) = { B37 where B37 is (Element of ( NAT )) : B37 < ( card F2() ) } by AXIOMS:4;
L215: C59 is  one-to-one
proof
let C69 , C70 being set;
assume that
L216: C69 in ( dom C59 )
and
L217: C70 in ( dom C59 );
L218: ((ex B38 being (Element of ( NAT )) st (C69 = B38 & B38 < ( card F2() ))) & (ex B39 being (Element of ( NAT )) st (C70 = B39 & B39 < ( card F2() )))) by L176 , L214 , L216 , L217;
L219: (F1(C69) = F1(C70) implies C69 = C70) by L218 , L175;
L220: F1(C69) = ( C59 . C69 ) by L176 , L216;
thus L221: thesis by L220 , L176 , L217 , L219;
end;
L222: ( dom C59 ) , ( rng C59 ) are_equipotent  by L215 , WELLORD2:def 4;
reconsider D14 = ( rng C59 ) as  finite set by L222 , L176 , CARD_1:38;
L223: ( card ( rng C59 ) ) = ( card ( card F2() ) ) by L176 , L222 , CARD_1:5
.= ( card F2() );
L224:
now
given C71 being (Element of ( NAT )) such that
L225: C71 >= ( card F2() )
and
L226: F1(C71) in F2();

L227: (( card F2() ) < C71 or ( card F2() ) = C71) by L225 , XXREAL_0:1;
L228: F1(( card F2() )) in F2() by L227 , L174 , L226;
L229: ( rng C59 ) c= ( F2() \ { F1(( card F2() )) } )
proof
let C72 being set;
assume L230: C72 in ( rng C59 );
consider C73 being set such that L231: C73 in ( card F2() ) and L232: C72 = ( C59 . C73 ) by L230 , L176 , FUNCT_1:def 3;
consider C74 being (Element of ( NAT )) such that L233: C73 = C74 and L234: C74 < ( card F2() ) by L214 , L231;
L235: F1(C74) = C72 by L176 , L231 , L232 , L233;
L236:
now
assume L237: C72 in { F1(( card F2() )) };
L238: F1(C74) = F1(( card F2() )) by L237 , L235 , TARSKI:def 1;
thus L239: contradiction by L238 , L175 , L234;
end;
L240: F1(C74) in F2() by L174 , L228 , L234;
thus L241: thesis by L240 , L235 , L236 , XBOOLE_0:def 5;
end;
L242: ( card D14 ) <= ( card ( F2() \ { F1(( card F2() )) } ) ) by L229 , NAT_1:43;
L243: { F1(( card F2() )) } c= F2() by L228 , ZFMISC_1:31;
L244: ( card D14 ) <= ( ( card F2() ) - ( card { F1(( card F2() )) } ) ) by L243 , L242 , CARD_2:44;
L245: ( card D14 ) <= ( ( card D14 ) - 1 ) by L244 , L223 , CARD_2:42;
L246: ( ( card D14 ) + 1 ) <= ( ( ( card D14 ) - 1 ) + 1 ) by L245 , XREAL_1:7;
thus L247: contradiction by L246 , NAT_1:13;
end;
L248: S1[ ( 0 ) ]
proof
assume L249: ( 0 ) < ( card F2() );
reconsider D15 = F2() as non  empty set by L249;
set D16 = the (Element of D15);
consider C75 being (Element of ( NAT )) such that L250: D16 = F1(C75) by L173;
L251: (C75 = ( 0 ) or C75 > ( 0 )) by NAT_1:3;
thus L252: thesis by L251 , L174 , L250;
end;
L253: (for B40 being (Element of ( NAT )) holds S1[ B40 ]) from NAT_1:sch 1(L248 , L177);
thus L254: thesis by L253 , L224;
end;
theorem
L255: (for B41 being  finite-branching Tree holds (for B42 being (Element of B41) holds (for B43 being (Element of ( NAT )) holds (( B42 ^ <* B43 *> ) in ( succ B42 ) iff B43 < ( card ( succ B42 ) )))))
proof
let C76 being  finite-branching Tree;
let C77 being (Element of C76);
deffunc H2((Element of ( NAT ))) = ( C77 ^ <* $1 *> );
L256: (for B44 being set holds (B44 in ( succ C77 ) implies (ex B45 being (Element of ( NAT )) st B44 = H2(B45))))
proof
let C78 being set;
assume L257: C78 in ( succ C77 );
L258: (ex B46 being (Element of ( NAT )) st (C78 = H2(B46) & H2(B46) in C76)) by L257;
thus L259: thesis by L258;
end;
L260: (for B47 , B48 being (Element of ( NAT )) holds ((B47 < B48 & H2(B48) in ( succ C77 )) implies H2(B47) in ( succ C77 )))
proof
let C79 , C80 being (Element of ( NAT ));
assume L261: (C79 < C80 & ( C77 ^ <* C80 *> ) in ( succ C77 ));
L262: ( C77 ^ <* C79 *> ) in C76 by L261 , TREES_1:def 3;
thus L263: thesis by L262;
end;
L264: (for B49 , B50 being (Element of ( NAT )) holds (H2(B49) = H2(B50) implies B49 = B50))
proof
let C81 , C82 being (Element of ( NAT ));
assume L265: ( C77 ^ <* C81 *> ) = ( C77 ^ <* C82 *> );
thus L266: C81 = ( ( C77 ^ <* C82 *> ) . ( ( len C77 ) + 1 ) ) by L265 , FINSEQ_1:42
.= C82 by FINSEQ_1:42;
end;
thus L267: (for B51 being (Element of ( NAT )) holds (H2(B51) in ( succ C77 ) iff B51 < ( card ( succ C77 ) ))) from FinOrdSet(L256 , L260 , L264);
end;
definition
let C83 being  finite-branching Tree;
let C84 being (Element of C83);
func C84 succ ->  one-to-one (FinSequence of C83) means 
:L268: (( len it ) = ( card ( succ C84 ) ) & ( rng it ) = ( succ C84 ) & (for B52 being (Element of ( NAT )) holds (B52 < ( len it ) implies ( it . ( B52 + 1 ) ) = ( C84 ^ <* B52 *> ))));
existence
proof
deffunc H3(Nat) = ( C84 ^ <* ( $1 - 1 ) *> );
consider C85 being FinSequence such that L269: (( len C85 ) = ( card ( succ C84 ) ) & (for B53 being Nat holds (B53 in ( dom C85 ) implies ( C85 . B53 ) = H3(B53)))) from FINSEQ_1:sch 2;
L270: C85 is  one-to-one
proof
let C86 , C87 being set;
assume L271: (C86 in ( dom C85 ) & C87 in ( dom C85 ));
reconsider D17 = C86 , D18 = C87 as (Element of ( NAT )) by L271;
L272: (( ( C84 ^ <* ( D17 - 1 ) *> ) . ( ( len C84 ) + 1 ) ) = ( D17 - 1 ) & ( ( C84 ^ <* ( D18 - 1 ) *> ) . ( ( len C84 ) + 1 ) ) = ( D18 - 1 )) by FINSEQ_1:42;
L273: (( C85 . C86 ) = ( C84 ^ <* ( D17 - 1 ) *> ) & ( C85 . C87 ) = ( C84 ^ <* ( D18 - 1 ) *> )) by L269 , L271;
thus L274: thesis by L273 , L272;
end;
L275: (for B54 being (Element of ( NAT )) holds (B54 < ( len C85 ) implies ( C85 . ( B54 + 1 ) ) = ( C84 ^ <* B54 *> )))
proof
let C88 being (Element of ( NAT ));
assume L276: C88 < ( len C85 );
L277: ( C85 . ( C88 + 1 ) ) = ( C84 ^ <* ( ( C88 + 1 ) - 1 ) *> ) by L276 , L269 , L51;
thus L278: thesis by L277;
end;
L279: ( rng C85 ) c= ( succ C84 )
proof
let C89 being set;
assume L280: C89 in ( rng C85 );
consider C90 being (Element of ( NAT )) such that L281: C90 < ( len C85 ) and L282: C89 = ( C85 . ( C90 + 1 ) ) by L280 , L58;
L283: C89 = ( C84 ^ <* C90 *> ) by L275 , L281 , L282;
thus L284: thesis by L283 , L269 , L281 , L255;
end;
reconsider D19 = C85 as  one-to-one (FinSequence of ( succ C84 )) by L279 , L270 , FINSEQ_1:def 4;
take D19;
thus L285: (( len D19 ) = ( card ( succ C84 ) ) & ( rng D19 ) c= ( succ C84 )) by L269 , L279;
thus L286: ( succ C84 ) c= ( rng D19 )
proof
let C91 being set;
assume L287: C91 in ( succ C84 );
consider C92 being (Element of ( NAT )) such that L288: C91 = ( C84 ^ <* C92 *> ) and L289: ( C84 ^ <* C92 *> ) in C83 by L287;
L290: C92 < ( card ( succ C84 ) ) by L287 , L288 , L255;
L291: ( D19 . ( C92 + 1 ) ) = C91 by L290 , L269 , L275 , L288;
thus L292: thesis by L291 , L269 , L290 , L51;
end;

thus L293: thesis by L275;
end;
uniqueness
proof
let C93 , C94 being  one-to-one (FinSequence of C83);
assume that
L294: ( len C93 ) = ( card ( succ C84 ) )
and
L295: ( rng C93 ) = ( succ C84 )
and
L296: (for B55 being (Element of ( NAT )) holds (B55 < ( len C93 ) implies ( C93 . ( B55 + 1 ) ) = ( C84 ^ <* B55 *> )))
and
L297: ( len C94 ) = ( card ( succ C84 ) )
and
L298: ( rng C94 ) = ( succ C84 )
and
L299: (for B56 being (Element of ( NAT )) holds (B56 < ( len C94 ) implies ( C94 . ( B56 + 1 ) ) = ( C84 ^ <* B56 *> )));
L300: ( dom C93 ) = ( Seg ( card ( succ C84 ) ) ) by L294 , FINSEQ_1:def 3;
L301:
now
let C95 being Nat;
assume L302: C95 in ( Seg ( card ( succ C84 ) ) );
consider C96 being (Element of ( NAT )) such that L303: (C95 = ( C96 + 1 ) & C96 < ( len C93 )) by L302 , L300 , L36;
thus L304: ( C93 . C95 ) = ( C84 ^ <* C96 *> ) by L296 , L303
.= ( C94 . C95 ) by L294 , L297 , L299 , L303;
end;
L305: ( dom C94 ) = ( Seg ( card ( succ C84 ) ) ) by L297 , FINSEQ_1:def 3;
thus L306: thesis by L305 , L300 , L301 , FINSEQ_1:13;
end;
end;
definition
let C97 being  finite-branching DecoratedTree;
let C98 being FinSequence;
assume that
L308: C98 in ( dom C97 );
func succ (C97 , C98) -> FinSequence means 
:L309: (ex B57 being (Element of ( dom C97 )) st (B57 = C98 & it = ( C97 * ( B57 succ ) )));
existence
proof
reconsider D20 = C98 as (Element of ( dom C97 )) by L308;
L310: ( rng ( D20 succ ) ) c= ( dom C97 );
L311: ( dom ( C97 * ( D20 succ ) ) ) = ( dom ( D20 succ ) ) by L310 , RELAT_1:27
.= ( Seg ( len ( D20 succ ) ) ) by FINSEQ_1:def 3;
L312: ( C97 * ( D20 succ ) ) is FinSequence by L311 , FINSEQ_1:def 2;
thus L313: thesis by L312;
end;
uniqueness;
end;
theorem
L315: (for B58 being  finite-branching DecoratedTree holds (ex B59 being set st (ex B60 being  DTree-yielding FinSequence st B58 = ( B59 -tree B60 ))))
proof
let C99 being  finite-branching DecoratedTree;
take ( C99 . ( {} ) );
reconsider D21 = ( {} ) as (Node of C99) by TREES_1:22;
defpred S2[ set , set ] means (ex B61 being (Element of ( NAT )) st (( B61 + 1 ) = $1 & $2 = ( C99 | <* B61 *> )));
L316: ( ( dom C99 ) -level 1 ) = ( succ D21 ) by TREES_2:13;
reconsider D22 = ( ( dom C99 ) -level 1 ) as  finite set by L316;
reconsider D23 = ( {} ) as (Element of ( dom C99 )) by TREES_1:22;
L317: (for B62 being set holds (B62 in ( Seg ( card D22 ) ) implies (ex B63 being set st S2[ B62 , B63 ])))
proof
let C100 being set;
assume L318: C100 in ( Seg ( card D22 ) );
reconsider D24 = C100 as (Element of ( NAT )) by L318;
L319: D24 >= 1 by L318 , FINSEQ_1:1;
consider C101 being Nat such that L320: D24 = ( 1 + C101 ) by L319 , NAT_1:10;
reconsider D25 = C101 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D26 = ( C99 | <* D25 *> ) as set;
take D26;
take D25;
thus L321: thesis by L320;
end;
consider C102 being Function such that L322: ( dom C102 ) = ( Seg ( card D22 ) ) and L323: (for B64 being set holds (B64 in ( Seg ( card D22 ) ) implies S2[ B64 , ( C102 . B64 ) ])) from CLASSES1:sch 1(L317);
reconsider D27 = C102 as FinSequence by L322 , FINSEQ_1:def 2;
L324: ( len D27 ) = ( card D22 ) by L322 , FINSEQ_1:def 3;
L325:
now
let C103 being set;
assume L326: C103 in ( dom D27 );
L327: (ex B65 being (Element of ( NAT )) st (( B65 + 1 ) = C103 & ( D27 . C103 ) = ( C99 | <* B65 *> ))) by L326 , L322 , L323;
thus L328: ( D27 . C103 ) is DecoratedTree by L327;
end;
L329:
now
let C104 being (Element of ( NAT ));
thus L330: (( D23 ^ <* C104 *> ) = <* C104 *> & ( succ D23 ) = D22) by FINSEQ_1:34 , TREES_2:13;
thus L331: (<* C104 *> in D22 iff C104 < ( card D22 )) by L330 , L255;
end;
reconsider D28 = D27 as  DTree-yielding FinSequence by L325 , TREES_3:24;
L332: ( len ( doms D28 ) ) = ( len D28 ) by TREES_3:38;
L333:
now
let C105 being set;
thus L334:now
assume that
L335: C105 in ( dom C99 )
and
L336: C105 <> ( {} );
reconsider D29 = C105 as (Node of C99) by L335;
consider C106 being (FinSequence of ( NAT )), C107 being (Element of ( NAT )) such that L337: D29 = ( <* C107 *> ^ C106 ) by L336 , FINSEQ_2:130;
L338: <* C107 *> in ( dom C99 ) by L337 , TREES_1:21;
reconsider D30 = C106 as FinSequence;
take D31 = C107;
take D32 = D30;
L339: ( D23 ^ <* D31 *> ) = <* D31 *> by L329;
L340: <* D31 *> in D22 by L339 , L329 , L338;
thus L341: D31 < ( len ( doms D28 ) ) by L340 , L324 , L329 , L332;
L342: (( D31 + 1 ) in ( dom D28 ) & (ex B66 being (Element of ( NAT )) st (( B66 + 1 ) = ( D31 + 1 ) & ( D28 . ( D31 + 1 ) ) = ( C99 | <* B66 *> )))) by L341 , L322 , L323 , L332 , L51;
L343: ( ( doms D28 ) . ( D31 + 1 ) ) = ( dom ( C99 | <* D31 *> ) ) by L342 , FUNCT_6:22
.= ( ( dom C99 ) | <* D31 *> ) by TREES_2:def 10;
thus L344: (D32 in ( ( doms D28 ) . ( D31 + 1 ) ) & C105 = ( <* D31 *> ^ D32 )) by L343 , L337 , L338 , TREES_1:def 6;
end;
assume L345: (C105 = ( {} ) or (ex B67 being (Element of ( NAT )) st (ex B68 being FinSequence st (B67 < ( len ( doms D28 ) ) & B68 in ( ( doms D28 ) . ( B67 + 1 ) ) & C105 = ( <* B67 *> ^ B68 )))));
assume L346: (not C105 in ( dom C99 ));
consider C108 being (Element of ( NAT )), C109 being FinSequence such that L347: C108 < ( len ( doms D28 ) ) and L348: C109 in ( ( doms D28 ) . ( C108 + 1 ) ) and L349: C105 = ( <* C108 *> ^ C109 ) by L346 , L345 , TREES_1:22;
L350: (( C108 + 1 ) in ( dom D28 ) & (ex B69 being (Element of ( NAT )) st (( B69 + 1 ) = ( C108 + 1 ) & ( D28 . ( C108 + 1 ) ) = ( C99 | <* B69 *> )))) by L322 , L323 , L332 , L347 , L51;
L351: ( ( doms D28 ) . ( C108 + 1 ) ) = ( dom ( C99 | <* C108 *> ) ) by L350 , FUNCT_6:22
.= ( ( dom C99 ) | <* C108 *> ) by TREES_2:def 10;
reconsider D33 = C109 as (Element of ( ( dom C99 ) | <* C108 *> )) by L351 , L348;
L352: <* C108 *> in D22 by L324 , L329 , L332 , L347;
L353: ( <* C108 *> ^ D33 ) in ( dom C99 ) by L352 , TREES_1:def 6;
thus L354: contradiction by L353 , L346 , L349;
end;
L355: ( dom C99 ) = ( tree ( doms D28 ) ) by L333 , TREES_3:def 15;
take D28;
L356:
now
let C110 being (Element of ( NAT ));
assume L357: C110 < ( len D28 );
L358: (ex B70 being (Element of ( NAT )) st (( B70 + 1 ) = ( C110 + 1 ) & ( D28 . ( C110 + 1 ) ) = ( C99 | <* B70 *> ))) by L357 , L322 , L323 , L51;
thus L359: ( C99 | <* C110 *> ) = ( D28 . ( C110 + 1 ) ) by L358;
end;
thus L360: thesis by L356 , L355 , TREES_4:def 4;
end;
registration
let C111 being  finite DecoratedTree;
let C112 being (Node of C111);
cluster ( C111 | C112 ) ->  finite;
coherence;
end;
theorem
L362: (for B71 being  finite Tree holds (for B72 being (Element of B71) holds (B71 = ( B71 | B72 ) implies B72 = ( {} ))))
proof
let C113 being  finite Tree;
let C114 being (Element of C113);
L363: (C114 <> ( {} ) implies ( height C113 ) > ( height ( C113 | C114 ) )) by TREES_1:48;
thus L364: thesis by L363;
end;
registration
let C115 being non  empty set;
let C116 being non  empty (Subset of ( FinTrees C115 ));
cluster  ->  finite for (Element of C116);
coherence;
end;
begin
definition
let C117 being DecoratedTree;
func Subtrees C117 -> set equals 
{ ( C117 | B73 ) where B73 is (Node of C117) : (not contradiction) };
coherence;
end;
registration
let C118 being DecoratedTree;
cluster ( Subtrees C118 ) ->  constituted-DTrees non  empty;
coherence
proof
set D34 = the (Node of C118);
set D35 = { ( C118 | B74 ) where B74 is (Node of C118) : (not contradiction) };
L367: ( C118 | D34 ) in D35;
reconsider D36 = D35 as non  empty set by L367;
L368: D36 is  constituted-DTrees
proof
let C119 being set;
assume L369: C119 in D36;
L370: (ex B75 being (Node of C118) st C119 = ( C118 | B75 )) by L369;
thus L371: thesis by L370;
end;
thus L372: thesis by L368;
end;
end;
definition
let C120 being non  empty set;
let C121 being (DecoratedTree of C120);
redefine func Subtrees C121 -> non  empty (Subset of ( Trees C120 ));

coherence
proof
L374: ( Subtrees C121 ) c= ( Trees C120 )
proof
let C122 being set;
assume L375: C122 in ( Subtrees C121 );
L376: (ex B76 being (Node of C121) st C122 = ( C121 | B76 )) by L375;
thus L377: thesis by L376 , TREES_3:def 7;
end;
thus L378: thesis by L374;
end;
end;
definition
let C123 being non  empty set;
let C124 being  finite (DecoratedTree of C123);
redefine func Subtrees C124 -> non  empty (Subset of ( FinTrees C123 ));

coherence
proof
L380: ( Subtrees C124 ) c= ( FinTrees C123 )
proof
let C125 being set;
assume L381: C125 in ( Subtrees C124 );
L382: (ex B77 being (Node of C124) st C125 = ( (C124 qua (DecoratedTree of C123)) | B77 )) by L381;
reconsider D37 = C125 as  finite (DecoratedTree of C123) by L382;
L383: ( dom D37 ) is  finite;
thus L384: thesis by L383 , TREES_3:def 8;
end;
thus L385: thesis by L380;
end;
end;
registration
let C126 being  finite DecoratedTree;
cluster  ->  finite for (Element of ( Subtrees C126 ));
coherence
proof
let C127 being (Element of ( Subtrees C126 ));
L387: C127 in { ( C126 | B78 ) where B78 is (Node of C126) : (not contradiction) };
L388: (ex B79 being (Node of C126) st C127 = ( C126 | B79 )) by L387;
thus L389: thesis by L388;
end;
end;
theorem
L391: (for R1 being set holds (for R2 being DecoratedTree holds (R1 in ( Subtrees R2 ) iff (ex B80 being (Node of R2) st R1 = ( R2 | B80 )))));
theorem
L392: (for R2 being DecoratedTree holds R2 in ( Subtrees R2 ))
proof
let R2 being DecoratedTree;
reconsider D38 = ( {} ) as (Node of R2) by TREES_1:22;
L393: ( R2 | D38 ) = R2 by L64;
thus L394: thesis by L393;
end;
theorem
L395: (for R3 being DecoratedTree holds (for R4 being DecoratedTree holds ((R3 is  finite & ( Subtrees R3 ) = ( Subtrees R4 )) implies R3 = R4)))
proof
let R3 being DecoratedTree;
let R4 being DecoratedTree;
assume that
L396: R3 is  finite
and
L397: ( Subtrees R3 ) = ( Subtrees R4 );
reconsider D39 = R3 as  finite DecoratedTree by L396;
L398: R3 in ( Subtrees R4 ) by L397 , L392;
consider C128 being (Node of R4) such that L399: R3 = ( R4 | C128 ) by L398;
L400: R4 in ( Subtrees R3 ) by L397 , L392;
consider C129 being (Node of R3) such that L401: R4 = ( R3 | C129 ) by L400;
L402: ( dom ( R3 | C129 ) ) = ( ( dom R3 ) | C129 ) by TREES_2:def 10;
reconsider D40 = ( C129 ^ C128 ) as (Element of ( dom D39 )) by L402 , L401 , TREES_1:def 6;
L403: D39 = ( D39 | D40 ) by L399 , L401 , L78;
L404: ( dom D39 ) = ( ( dom D39 ) | D40 ) by L403 , TREES_2:def 10;
L405: C128 = ( {} ) by L404 , L362;
thus L406: thesis by L405 , L399 , L64;
end;
theorem
L407: (for R2 being DecoratedTree holds (for B81 being (Node of R2) holds ( Subtrees ( R2 | B81 ) ) c= ( Subtrees R2 )))
proof
let R2 being DecoratedTree;
let C130 being (Node of R2);
let C131 being set;
assume L408: C131 in ( Subtrees ( R2 | C130 ) );
consider C132 being (Node of ( R2 | C130 )) such that L409: C131 = ( ( R2 | C130 ) | C132 ) by L408;
L410: ( dom ( R2 | C130 ) ) = ( ( dom R2 ) | C130 ) by TREES_2:def 10;
reconsider D41 = ( C130 ^ C132 ) as (Node of R2) by L410 , TREES_1:def 6;
L411: C131 = ( R2 | D41 ) by L409 , L78;
thus L412: thesis by L411;
end;
definition
let C133 being DecoratedTree;
func FixedSubtrees C133 -> (Subset of [: ( dom C133 ) , ( Subtrees C133 ) :]) equals 
{ [ B82 , ( C133 | B82 ) ] where B82 is (Node of C133) : (not contradiction) };
coherence
proof
set D42 = { [ B83 , ( C133 | B83 ) ] where B83 is (Node of C133) : (not contradiction) };
L413: D42 c= [: ( dom C133 ) , ( Subtrees C133 ) :]
proof
let C134 being set;
assume L414: C134 in D42;
consider C135 being (Node of C133) such that L415: C134 = [ C135 , ( C133 | C135 ) ] by L414;
L416: ( C133 | C135 ) in ( Subtrees C133 );
thus L417: thesis by L416 , L415 , ZFMISC_1:87;
end;
thus L418: thesis by L413;
end;
end;
registration
let C136 being DecoratedTree;
cluster ( FixedSubtrees C136 ) -> non  empty;
coherence
proof
set D43 = the (Node of C136);
set D44 = { [ B84 , ( C136 | B84 ) ] where B84 is (Node of C136) : (not contradiction) };
L420: [ D43 , ( C136 | D43 ) ] in D44;
thus L421: thesis by L420;
end;
end;
theorem
L423: (for R1 being set holds (for R2 being DecoratedTree holds (R1 in ( FixedSubtrees R2 ) iff (ex B85 being (Node of R2) st R1 = [ B85 , ( R2 | B85 ) ]))));
theorem
L424: (for R2 being DecoratedTree holds [ ( {} ) , R2 ] in ( FixedSubtrees R2 ))
proof
let R2 being DecoratedTree;
reconsider D45 = ( {} ) as (Node of R2) by TREES_1:22;
L425: ( R2 | D45 ) = R2 by L64;
thus L426: thesis by L425;
end;
theorem
L427: (for R3 being DecoratedTree holds (for R4 being DecoratedTree holds (( FixedSubtrees R3 ) = ( FixedSubtrees R4 ) implies R3 = R4)))
proof
let R3 being DecoratedTree;
let R4 being DecoratedTree;
assume L428: ( FixedSubtrees R3 ) = ( FixedSubtrees R4 );
L429: [ ( {} ) , R3 ] in ( FixedSubtrees R4 ) by L428 , L424;
consider C137 being (Node of R4) such that L430: [ ( {} ) , R3 ] = [ C137 , ( R4 | C137 ) ] by L429;
L431: (( {} ) = C137 & R3 = ( R4 | C137 )) by L430 , XTUPLE_0:1;
thus L432: thesis by L431 , L64;
end;
definition
let C138 being DecoratedTree;
let C139 being set;
func C139 -Subtrees C138 -> (Subset of ( Subtrees C138 )) equals 
{ ( C138 | B86 ) where B86 is (Node of C138) : ((not B86 in ( Leaves ( dom C138 ) )) or ( C138 . B86 ) in C139) };
coherence
proof
set D46 = { ( C138 | B87 ) where B87 is (Node of C138) : ((not B87 in ( Leaves ( dom C138 ) )) or ( C138 . B87 ) in C139) };
L433: D46 c= ( Subtrees C138 )
proof
let C140 being set;
assume L434: C140 in D46;
L435: (ex B88 being (Node of C138) st (C140 = ( C138 | B88 ) & ((not B88 in ( Leaves ( dom C138 ) )) or ( C138 . B88 ) in C139))) by L434;
thus L436: thesis by L435;
end;
thus L437: thesis by L433;
end;
end;
theorem
L439: (for R1 being set holds (for R2 being DecoratedTree holds (for R5 being set holds (R1 in ( R5 -Subtrees R2 ) iff (ex B89 being (Node of R2) st (R1 = ( R2 | B89 ) & ((not B89 in ( Leaves ( dom R2 ) )) or ( R2 . B89 ) in R5)))))));
theorem
L440: (for R2 being DecoratedTree holds (for R5 being set holds (( R5 -Subtrees R2 ) is  empty iff (R2 is  root & (not ( R2 . ( {} ) ) in R5)))))
proof
let R2 being DecoratedTree;
let R5 being set;
reconsider D47 = ( {} ) as (Node of R2) by TREES_1:22;
thus L441:now
assume L442: ( R5 -Subtrees R2 ) is  empty;
L443: (not ( R2 | D47 ) in ( R5 -Subtrees R2 )) by L442;
L444: D47 in ( Leaves ( dom R2 ) ) by L443;
thus L445: (R2 is  root & (not ( R2 . ( {} ) ) in R5)) by L444 , L443 , L106;
end;
assume that
L446: R2 is  root
and
L447: (not ( R2 . ( {} ) ) in R5);
assume L448: (not ( R5 -Subtrees R2 ) is  empty);
reconsider D48 = ( R5 -Subtrees R2 ) as non  empty (Subset of ( Subtrees R2 )) by L448;
set D49 = the (Element of D48);
consider C141 being (Node of R2) such that L449: D49 = ( R2 | C141 ) and L450: ((not C141 in ( Leaves ( dom R2 ) )) or ( R2 . C141 ) in R5) by L439;
L451: ( dom R2 ) = { ( {} ) } by L446 , L94 , TREES_1:29;
L452: C141 = ( {} ) by L451 , TARSKI:def 1;
L453: ( D47 ^ <* ( 0 ) *> ) in ( dom R2 ) by L452 , L447 , L450 , TREES_1:54;
thus L454: contradiction by L453 , L451 , TARSKI:def 1;
end;
definition
let C142 being  finite DecoratedTree;
let C143 being set;
func C143 -ImmediateSubtrees C142 -> (Function of ( C143 -Subtrees C142 ) , ( ( Subtrees C142 ) * )) means 
(for B90 being DecoratedTree holds (B90 in ( C143 -Subtrees C142 ) implies (for B91 being (FinSequence of ( Subtrees C142 )) holds (B91 = ( it . B90 ) implies B90 = ( ( B90 . ( {} ) ) -tree B91 )))));
existence
proof
defpred S3[ set , set ] means (ex B92 being DecoratedTree st (ex B93 being (FinSequence of ( Subtrees C142 )) st (B93 = $2 & B92 = $1 & B92 = ( ( B92 . ( {} ) ) -tree B93 ))));
L455: (for R1 being set holds (R1 in ( C143 -Subtrees C142 ) implies (ex B94 being set st (B94 in ( ( Subtrees C142 ) * ) & S3[ R1 , B94 ]))))
proof
let C144 being set;
assume L456: C144 in ( C143 -Subtrees C142 );
reconsider D50 = C144 as (Element of ( Subtrees C142 )) by L456;
reconsider D51 = D50 as DecoratedTree;
consider C145 being (Node of C142) such that L457: D50 = ( C142 | C145 ) by L391;
consider C146 being set, C147 being  DTree-yielding FinSequence such that L458: D50 = ( C146 -tree C147 ) by L315;
L459: ( rng C147 ) c= ( Subtrees C142 )
proof
let C148 being set;
L460: ( dom ( C142 | C145 ) ) = ( ( dom C142 ) | C145 ) by TREES_2:def 10;
assume L461: C148 in ( rng C147 );
consider C149 being (Element of ( NAT )) such that L462: (C149 < ( len C147 ) & C148 = ( C147 . ( C149 + 1 ) )) by L461 , L58;
reconsider D52 = ( {} ) as (Node of ( D50 | <* C149 *> )) by TREES_1:22;
L463: C148 = ( D50 | <* C149 *> ) by L458 , L462 , TREES_4:def 4;
L464: ( <* C149 *> ^ D52 ) = <* C149 *> by FINSEQ_1:34;
L465: <* C149 *> in ( dom D50 ) by L464 , L458 , L462 , L463 , TREES_4:11;
reconsider D53 = ( C145 ^ <* C149 *> ) as (Node of C142) by L465 , L457 , L460 , TREES_1:def 6;
L466: C148 = ( C142 | D53 ) by L457 , L463 , L78;
thus L467: thesis by L466;
end;
reconsider D54 = C147 as (FinSequence of ( Subtrees C142 )) by L459 , FINSEQ_1:def 4;
reconsider D55 = D54 as set;
take D55;
thus L468: D55 in ( ( Subtrees C142 ) * ) by FINSEQ_1:def 11;
take D51;
take D54;
thus L469: thesis by L458 , TREES_4:def 4;
end;
consider C150 being Function such that L470: (( dom C150 ) = ( C143 -Subtrees C142 ) & ( rng C150 ) c= ( ( Subtrees C142 ) * ) & (for B95 being set holds (B95 in ( C143 -Subtrees C142 ) implies S3[ B95 , ( C150 . B95 ) ]))) from FUNCT_1:sch 5(L455);
reconsider D56 = C150 as (Function of ( C143 -Subtrees C142 ) , ( ( Subtrees C142 ) * )) by L470 , FUNCT_2:def 1 , RELSET_1:4;
take D56;
let C151 being DecoratedTree;
assume L471: C151 in ( C143 -Subtrees C142 );
L472: (ex B96 being DecoratedTree st (ex B97 being (FinSequence of ( Subtrees C142 )) st (B97 = ( D56 . C151 ) & B96 = C151 & B96 = ( ( B96 . ( {} ) ) -tree B97 )))) by L471 , L470;
thus L473: thesis by L472;
end;
uniqueness
proof
let C152 , C153 being (Function of ( C143 -Subtrees C142 ) , ( ( Subtrees C142 ) * ));
assume that
L474: ((for B98 being DecoratedTree holds (B98 in ( C143 -Subtrees C142 ) implies (for B99 being (FinSequence of ( Subtrees C142 )) holds (B99 = ( C152 . B98 ) implies B98 = ( ( B98 . ( {} ) ) -tree B99 ))))) & (for B100 being DecoratedTree holds (B100 in ( C143 -Subtrees C142 ) implies (for B101 being (FinSequence of ( Subtrees C142 )) holds (B101 = ( C153 . B100 ) implies B100 = ( ( B100 . ( {} ) ) -tree B101 ))))));
L475:
now
let C154 being set;
assume L476: C154 in ( C143 -Subtrees C142 );
reconsider D57 = C154 as (Element of ( Subtrees C142 )) by L476;
reconsider D58 = ( C152 . D57 ) , D59 = ( C153 . D57 ) as (Element of ( ( Subtrees C142 ) * )) by L476 , FUNCT_2:5;
L477: (D57 = ( ( D57 . ( {} ) ) -tree D58 ) & D57 = ( ( D57 . ( {} ) ) -tree D59 )) by L474 , L476;
thus L478: ( C152 . C154 ) = ( C153 . C154 ) by L477 , TREES_4:15;
end;
thus L479: C152 = C153 by L475 , FUNCT_2:12;
end;
end;
begin
definition
let C155 being  constituted-DTrees non  empty set;
func Subtrees C155 -> set equals 
{ ( B102 | B103 ) where B102 is (Element of C155) , B103 is (Node of B102) : (not contradiction) };
coherence;
end;
registration
let C156 being  constituted-DTrees non  empty set;
cluster ( Subtrees C156 ) ->  constituted-DTrees non  empty;
coherence
proof
set D60 = { ( B104 | B105 ) where B104 is (Element of C156) , B105 is (Node of B104) : (not contradiction) };
set D61 = the (Element of C156);
set D62 = the (Node of D61);
L482: ( D61 | D62 ) in D60;
reconsider D63 = D60 as non  empty set by L482;
L483: D63 is  constituted-DTrees
proof
let C157 being set;
assume L484: C157 in D63;
L485: (ex B106 being (Element of C156) st (ex B107 being (Node of B106) st C157 = ( B106 | B107 ))) by L484;
thus L486: thesis by L485;
end;
thus L487: thesis by L483;
end;
end;
definition
let C158 being non  empty set;
let C159 being non  empty (Subset of ( Trees C158 ));
redefine func Subtrees C159 -> non  empty (Subset of ( Trees C158 ));

coherence
proof
L489: ( Subtrees C159 ) c= ( Trees C158 )
proof
let C160 being set;
assume L490: C160 in ( Subtrees C159 );
L491: (ex B108 being (Element of C159) st (ex B109 being (Node of B108) st C160 = ( (B108 qua (Element of ( Trees C158 ))) | B109 ))) by L490;
thus L492: thesis by L491 , TREES_3:def 7;
end;
thus L493: thesis by L489;
end;
end;
definition
let C161 being non  empty set;
let C162 being non  empty (Subset of ( FinTrees C161 ));
redefine func Subtrees C162 -> non  empty (Subset of ( FinTrees C161 ));

coherence
proof
L495: ( Subtrees C162 ) c= ( FinTrees C161 )
proof
let C163 being set;
assume L496: C163 in ( Subtrees C162 );
L497: (ex B110 being (Element of C162) st (ex B111 being (Node of B110) st C163 = ( ((B110 qua (Element of ( FinTrees C161 ))) qua (DecoratedTree of C161)) | B111 ))) by L496;
reconsider D64 = C163 as  finite (DecoratedTree of C161) by L497;
L498: ( dom D64 ) is  finite;
thus L499: thesis by L498 , TREES_3:def 8;
end;
thus L500: thesis by L495;
end;
end;
theorem
L502: (for R1 being set holds (for R6 being non  empty  constituted-DTrees set holds (R1 in ( Subtrees R6 ) iff (ex B112 being (Element of R6) st (ex B113 being (Node of B112) st R1 = ( B112 | B113 ))))));
theorem
L503: (for R2 being DecoratedTree holds (for R6 being non  empty  constituted-DTrees set holds (R2 in R6 implies R2 in ( Subtrees R6 ))))
proof
let R2 being DecoratedTree;
let R6 being non  empty  constituted-DTrees set;
assume L504: R2 in R6;
reconsider D65 = R2 as (Element of R6) by L504;
reconsider D66 = ( {} ) as (Node of D65) by TREES_1:22;
L505: ( D65 | D66 ) = D65 by L64;
thus L506: thesis by L505;
end;
theorem
L507: (for R6 being non  empty  constituted-DTrees set holds (for R7 being non  empty  constituted-DTrees set holds (R6 c= R7 implies ( Subtrees R6 ) c= ( Subtrees R7 ))))
proof
let R6 being non  empty  constituted-DTrees set;
let R7 being non  empty  constituted-DTrees set;
assume L508: (for R1 being set holds (R1 in R6 implies R1 in R7));
let C164 being set;
assume L509: C164 in ( Subtrees R6 );
consider C165 being (Element of R6), C166 being (Node of C165) such that L510: C164 = ( C165 | C166 ) by L509;
reconsider D67 = C165 as (Element of R7) by L508;
reconsider D68 = C166 as (Node of D67);
L511: C164 = ( D67 | D68 ) by L510;
thus L512: thesis by L511;
end;
registration
let C167 being DecoratedTree;
cluster { C167 } ->  constituted-DTrees;
coherence by TREES_3:14;
end;
theorem
L514: (for R2 being DecoratedTree holds ( Subtrees { R2 } ) = ( Subtrees R2 ))
proof
let R2 being DecoratedTree;
thus L515:now
let R1 being set;
assume L516: R1 in ( Subtrees { R2 } );
consider C168 being (Element of { R2 }), C169 being (Node of C168) such that L517: R1 = ( C168 | C169 ) by L516;
L518: C168 = R2 by TARSKI:def 1;
thus L519: R1 in ( Subtrees R2 ) by L518 , L517;
end;
let R1 being set;
assume L520: R1 in ( Subtrees R2 );
L521: (R2 in { R2 } & (ex B114 being (Node of R2) st R1 = ( R2 | B114 ))) by L520 , TARSKI:def 1;
thus L522: thesis by L521;
end;
theorem
L523: (for R6 being non  empty  constituted-DTrees set holds ( Subtrees R6 ) = ( union { ( Subtrees B115 ) where B115 is (Element of R6) : (not contradiction) } ))
proof
let R6 being non  empty  constituted-DTrees set;
thus L524:now
let R1 being set;
assume L525: R1 in ( Subtrees R6 );
consider C170 being (Element of R6) such that L526: (ex B116 being (Node of C170) st R1 = ( C170 | B116 )) by L525;
L527: (( Subtrees C170 ) in { ( Subtrees B117 ) where B117 is (Element of R6) : (not contradiction) } & R1 in ( Subtrees C170 )) by L526;
thus L528: R1 in ( union { ( Subtrees B118 ) where B118 is (Element of R6) : (not contradiction) } ) by L527 , TARSKI:def 4;
end;
let R1 being set;
assume L529: R1 in ( union { ( Subtrees B119 ) where B119 is (Element of R6) : (not contradiction) } );
consider C171 being set such that L530: R1 in C171 and L531: C171 in { ( Subtrees B120 ) where B120 is (Element of R6) : (not contradiction) } by L529 , TARSKI:def 4;
consider C172 being (Element of R6) such that L532: C171 = ( Subtrees C172 ) by L531;
L533: (ex B121 being (Node of C172) st R1 = ( C172 | B121 )) by L530 , L532;
thus L534: thesis by L533;
end;
definition
let C173 being  constituted-DTrees non  empty set;
let C174 being set;
func C174 -Subtrees C173 -> (Subset of ( Subtrees C173 )) equals 
{ ( B122 | B123 ) where B122 is (Element of C173) , B123 is (Node of B122) : ((not B123 in ( Leaves ( dom B122 ) )) or ( B122 . B123 ) in C174) };
coherence
proof
set D69 = { ( B124 | B125 ) where B124 is (Element of C173) , B125 is (Node of B124) : ((not B125 in ( Leaves ( dom B124 ) )) or ( B124 . B125 ) in C174) };
L535: D69 c= ( Subtrees C173 )
proof
let C175 being set;
assume L536: C175 in D69;
L537: (ex B126 being (Element of C173) st (ex B127 being (Node of B126) st (C175 = ( B126 | B127 ) & ((not B127 in ( Leaves ( dom B126 ) )) or ( B126 . B127 ) in C174)))) by L536;
thus L538: thesis by L537;
end;
thus L539: thesis by L535;
end;
end;
theorem
L541: (for R1 being set holds (for R5 being set holds (for R6 being non  empty  constituted-DTrees set holds (R1 in ( R5 -Subtrees R6 ) iff (ex B128 being (Element of R6) st (ex B129 being (Node of B128) st (R1 = ( B128 | B129 ) & ((not B129 in ( Leaves ( dom B128 ) )) or ( B128 . B129 ) in R5))))))));
theorem
L542: (for R5 being set holds (for R6 being non  empty  constituted-DTrees set holds (( R5 -Subtrees R6 ) is  empty iff (for B130 being (Element of R6) holds (B130 is  root & (not ( B130 . ( {} ) ) in R5))))))
proof
let R5 being set;
let R6 being non  empty  constituted-DTrees set;
thus L543:now
assume L544: ( R5 -Subtrees R6 ) is  empty;
let C176 being (Element of R6);
reconsider D70 = ( {} ) as (Node of C176) by TREES_1:22;
L545: (not ( C176 | D70 ) in ( R5 -Subtrees R6 )) by L544;
L546: D70 in ( Leaves ( dom C176 ) ) by L545;
thus L547: (C176 is  root & (not ( C176 . ( {} ) ) in R5)) by L546 , L545 , L106;
end;
assume L548: (for B131 being (Element of R6) holds (B131 is  root & (not ( B131 . ( {} ) ) in R5)));
assume L549: (not ( R5 -Subtrees R6 ) is  empty);
reconsider D71 = ( R5 -Subtrees R6 ) as non  empty (Subset of ( Subtrees R6 )) by L549;
set D72 = the (Element of D71);
consider C177 being (Element of R6), C178 being (Node of C177) such that L550: D72 = ( C177 | C178 ) and L551: ((not C178 in ( Leaves ( dom C177 ) )) or ( C177 . C178 ) in R5) by L541;
reconsider D73 = ( {} ) as (Node of C177) by TREES_1:22;
L552: C177 is  root by L548;
L553: ( dom C177 ) = { ( {} ) } by L552 , L94 , TREES_1:29;
L554: C178 = ( {} ) by L553 , TARSKI:def 1;
L555: ( D73 ^ <* ( 0 ) *> ) in ( dom C177 ) by L554 , L548 , L551 , TREES_1:54;
thus L556: contradiction by L555 , L553 , TARSKI:def 1;
end;
theorem
L557: (for R2 being DecoratedTree holds (for R5 being set holds ( R5 -Subtrees { R2 } ) = ( R5 -Subtrees R2 )))
proof
let R2 being DecoratedTree;
let R5 being set;
thus L558:now
let R1 being set;
assume L559: R1 in ( R5 -Subtrees { R2 } );
consider C179 being (Element of { R2 }), C180 being (Node of C179) such that L560: (R1 = ( C179 | C180 ) & ((not C180 in ( Leaves ( dom C179 ) )) or ( C179 . C180 ) in R5)) by L559;
L561: C179 = R2 by TARSKI:def 1;
thus L562: R1 in ( R5 -Subtrees R2 ) by L561 , L560;
end;
let R1 being set;
assume L563: R1 in ( R5 -Subtrees R2 );
L564: (R2 in { R2 } & (ex B132 being (Node of R2) st (R1 = ( R2 | B132 ) & ((not B132 in ( Leaves ( dom R2 ) )) or ( R2 . B132 ) in R5)))) by L563 , TARSKI:def 1;
thus L565: thesis by L564;
end;
theorem
L566: (for R5 being set holds (for R6 being non  empty  constituted-DTrees set holds ( R5 -Subtrees R6 ) = ( union { ( R5 -Subtrees B133 ) where B133 is (Element of R6) : (not contradiction) } )))
proof
let R5 being set;
let R6 being non  empty  constituted-DTrees set;
thus L567:now
let R1 being set;
assume L568: R1 in ( R5 -Subtrees R6 );
consider C181 being (Element of R6) such that L569: (ex B134 being (Node of C181) st (R1 = ( C181 | B134 ) & ((not B134 in ( Leaves ( dom C181 ) )) or ( C181 . B134 ) in R5))) by L568;
L570: (( R5 -Subtrees C181 ) in { ( R5 -Subtrees B135 ) where B135 is (Element of R6) : (not contradiction) } & R1 in ( R5 -Subtrees C181 )) by L569;
thus L571: R1 in ( union { ( R5 -Subtrees B136 ) where B136 is (Element of R6) : (not contradiction) } ) by L570 , TARSKI:def 4;
end;
let R1 being set;
assume L572: R1 in ( union { ( R5 -Subtrees B137 ) where B137 is (Element of R6) : (not contradiction) } );
consider C182 being set such that L573: R1 in C182 and L574: C182 in { ( R5 -Subtrees B138 ) where B138 is (Element of R6) : (not contradiction) } by L572 , TARSKI:def 4;
consider C183 being (Element of R6) such that L575: C182 = ( R5 -Subtrees C183 ) by L574;
L576: (ex B139 being (Node of C183) st (R1 = ( C183 | B139 ) & ((not B139 in ( Leaves ( dom C183 ) )) or ( C183 . B139 ) in R5))) by L573 , L575;
thus L577: thesis by L576;
end;
definition
let C184 being non  empty  constituted-DTrees set;
assume that
L578: (for B140 being (Element of C184) holds B140 is  finite);
let C185 being set;
func C185 -ImmediateSubtrees C184 -> (Function of ( C185 -Subtrees C184 ) , ( ( Subtrees C184 ) * )) means 
(for B141 being DecoratedTree holds (B141 in ( C185 -Subtrees C184 ) implies (for B142 being (FinSequence of ( Subtrees C184 )) holds (B142 = ( it . B141 ) implies B141 = ( ( B141 . ( {} ) ) -tree B142 )))));
existence
proof
defpred S4[ set , set ] means (ex B143 being DecoratedTree st (ex B144 being (FinSequence of ( Subtrees C184 )) st (B144 = $2 & B143 = $1 & B143 = ( ( B143 . ( {} ) ) -tree B144 ))));
L579: (for R1 being set holds (R1 in ( C185 -Subtrees C184 ) implies (ex B145 being set st (B145 in ( ( Subtrees C184 ) * ) & S4[ R1 , B145 ]))))
proof
let C186 being set;
assume L580: C186 in ( C185 -Subtrees C184 );
reconsider D74 = C186 as (Element of ( Subtrees C184 )) by L580;
reconsider D75 = D74 as DecoratedTree;
consider C187 being (Element of C184), C188 being (Node of C187) such that L581: D74 = ( C187 | C188 ) by L502;
L582: C187 is  finite by L578;
consider C189 being set, C190 being  DTree-yielding FinSequence such that L583: D74 = ( C189 -tree C190 ) by L582 , L581 , L315;
L584: ( rng C190 ) c= ( Subtrees C184 )
proof
let C191 being set;
L585: ( dom ( C187 | C188 ) ) = ( ( dom C187 ) | C188 ) by TREES_2:def 10;
assume L586: C191 in ( rng C190 );
consider C192 being (Element of ( NAT )) such that L587: (C192 < ( len C190 ) & C191 = ( C190 . ( C192 + 1 ) )) by L586 , L58;
reconsider D76 = ( {} ) as (Node of ( D74 | <* C192 *> )) by TREES_1:22;
L588: C191 = ( D74 | <* C192 *> ) by L583 , L587 , TREES_4:def 4;
L589: ( <* C192 *> ^ D76 ) = <* C192 *> by FINSEQ_1:34;
L590: <* C192 *> in ( dom D74 ) by L589 , L583 , L587 , L588 , TREES_4:11;
reconsider D77 = ( C188 ^ <* C192 *> ) as (Node of C187) by L590 , L581 , L585 , TREES_1:def 6;
L591: C191 = ( C187 | D77 ) by L581 , L588 , L78;
thus L592: thesis by L591;
end;
reconsider D78 = C190 as (FinSequence of ( Subtrees C184 )) by L584 , FINSEQ_1:def 4;
reconsider D79 = D78 as set;
take D79;
thus L593: D79 in ( ( Subtrees C184 ) * ) by FINSEQ_1:def 11;
take D75;
take D78;
thus L594: thesis by L583 , TREES_4:def 4;
end;
consider C193 being Function such that L595: (( dom C193 ) = ( C185 -Subtrees C184 ) & ( rng C193 ) c= ( ( Subtrees C184 ) * ) & (for B146 being set holds (B146 in ( C185 -Subtrees C184 ) implies S4[ B146 , ( C193 . B146 ) ]))) from FUNCT_1:sch 5(L579);
reconsider D80 = C193 as (Function of ( C185 -Subtrees C184 ) , ( ( Subtrees C184 ) * )) by L595 , FUNCT_2:def 1 , RELSET_1:4;
take D80;
let C194 being DecoratedTree;
assume L596: C194 in ( C185 -Subtrees C184 );
L597: (ex B147 being DecoratedTree st (ex B148 being (FinSequence of ( Subtrees C184 )) st (B148 = ( D80 . C194 ) & B147 = C194 & B147 = ( ( B147 . ( {} ) ) -tree B148 )))) by L596 , L595;
thus L598: thesis by L597;
end;
uniqueness
proof
let C195 , C196 being (Function of ( C185 -Subtrees C184 ) , ( ( Subtrees C184 ) * ));
assume that
L599: ((for B149 being DecoratedTree holds (B149 in ( C185 -Subtrees C184 ) implies (for B150 being (FinSequence of ( Subtrees C184 )) holds (B150 = ( C195 . B149 ) implies B149 = ( ( B149 . ( {} ) ) -tree B150 ))))) & (for B151 being DecoratedTree holds (B151 in ( C185 -Subtrees C184 ) implies (for B152 being (FinSequence of ( Subtrees C184 )) holds (B152 = ( C196 . B151 ) implies B151 = ( ( B151 . ( {} ) ) -tree B152 ))))));
L600:
now
let C197 being set;
assume L601: C197 in ( C185 -Subtrees C184 );
reconsider D81 = C197 as (Element of ( Subtrees C184 )) by L601;
reconsider D82 = ( C195 . D81 ) , D83 = ( C196 . D81 ) as (Element of ( ( Subtrees C184 ) * )) by L601 , FUNCT_2:5;
L602: (D81 = ( ( D81 . ( {} ) ) -tree D82 ) & D81 = ( ( D81 . ( {} ) ) -tree D83 )) by L599 , L601;
thus L603: ( C195 . C197 ) = ( C196 . C197 ) by L602 , TREES_4:15;
end;
thus L604: C195 = C196 by L600 , FUNCT_2:12;
end;
end;
registration
let C198 being Tree;
cluster  empty for (Element of C198);
existence
proof
L606: ( {} ) in C198 by TREES_1:22;
thus L607: thesis by L606;
end;
end;
theorem
L609: (for B153 being  finite DecoratedTree holds (for B154 being (Element of ( dom B153 )) holds (( len ( succ (B153 , B154) ) ) = ( len ( B154 succ ) ) & ( dom ( succ (B153 , B154) ) ) = ( dom ( B154 succ ) ))))
proof
let C199 being  finite DecoratedTree;
let C200 being (Element of ( dom C199 ));
L610: ((ex B155 being (Element of ( dom C199 )) st (B155 = C200 & ( succ (C199 , C200) ) = ( C199 * ( B155 succ ) ))) & ( rng ( C200 succ ) ) c= ( dom C199 )) by L309;
L611: ( dom ( succ (C199 , C200) ) ) = ( dom ( C200 succ ) ) by L610 , RELAT_1:27;
thus L612: thesis by L611 , FINSEQ_3:29;
end;
theorem
L613: (for B156 being  FinTree-yielding FinSequence holds (for B157 being  empty (Element of ( tree B156 )) holds ( card ( succ B157 ) ) = ( len B156 )))
proof
let C201 being  FinTree-yielding FinSequence;
let C202 being  empty (Element of ( tree C201 ));
assume L614: (not thesis);
per cases  by L614 , XXREAL_0:1;
suppose L615: ( card ( succ C202 ) ) < ( len C201 );

L616: ( ( card ( succ C202 ) ) + 1 ) in ( dom C201 ) by L615 , L51;
reconsider D84 = ( C201 . ( ( card ( succ C202 ) ) + 1 ) ) as  finite Tree by L616 , TREES_3:23;
L617: ( C202 ^ <* ( card ( succ C202 ) ) *> ) = <* ( card ( succ C202 ) ) *> by FINSEQ_1:34;
L618: (C202 in D84 & ( <* ( card ( succ C202 ) ) *> ^ C202 ) = <* ( card ( succ C202 ) ) *>) by FINSEQ_1:34 , TREES_1:22;
L619: ( C202 ^ <* ( card ( succ C202 ) ) *> ) in ( tree C201 ) by L618 , L615 , L617 , TREES_3:def 15;
L620: ( C202 ^ <* ( card ( succ C202 ) ) *> ) in ( succ C202 ) by L619;
thus L621: contradiction by L620 , L255;
end;
suppose L622: ( card ( succ C202 ) ) > ( len C201 );

L623: ( C202 ^ <* ( len C201 ) *> ) in ( succ C202 ) by L622 , L255;
L624: ( C202 ^ <* ( len C201 ) *> ) in ( tree C201 ) by L623;
L625: <* ( len C201 ) *> in ( tree C201 ) by L624 , FINSEQ_1:34;
consider C203 being (Element of ( NAT )), C204 being FinSequence such that L626: C203 < ( len C201 ) and L627: C204 in ( C201 . ( C203 + 1 ) ) and L628: <* ( len C201 ) *> = ( <* C203 *> ^ C204 ) by L625 , TREES_3:def 15;
L629: ( len C201 ) = ( <* ( len C201 ) *> . 1 ) by FINSEQ_1:40
.= C203 by L628 , FINSEQ_1:41;
thus L630: contradiction by L629 , L626;
end;
end;
theorem
L632: (for B158 being  finite DecoratedTree holds (for B159 being set holds (for B160 being  DTree-yielding FinSequence holds (B158 = ( B159 -tree B160 ) implies (for B161 being  empty (Element of ( dom B158 )) holds ( succ (B158 , B161) ) = ( roots B160 ))))))
proof
let C205 being  finite DecoratedTree;
let C206 being set;
let C207 being  DTree-yielding FinSequence;
assume that
L633: C205 = ( C206 -tree C207 );
let C208 being  empty (Element of ( dom C205 ));
L634: ( len ( doms C207 ) ) = ( len C207 ) by TREES_3:38;
L635:
now
let C209 being set;
assume L636: C209 in ( dom ( doms C207 ) );
consider C210 being (Element of ( NAT )) such that L637: (C209 = ( C210 + 1 ) & C210 < ( len C207 )) by L636 , L634 , L36;
L638: ( C207 . C209 ) = ( C205 | <* C210 *> ) by L633 , L637 , TREES_4:def 4;
L639: (C208 in ( dom ( C205 | <* C210 *> ) ) & ( <* C210 *> ^ C208 ) = <* C210 *>) by FINSEQ_1:34 , TREES_1:22;
reconsider D85 = <* C210 *> as (Node of C205) by L639 , L633 , L637 , L638 , TREES_4:11;
L640: C209 in ( dom C207 ) by L637 , L51;
L641: ( ( doms C207 ) . C209 ) = ( dom ( C205 | D85 ) ) by L640 , L638 , FUNCT_6:22;
thus L642: ( ( doms C207 ) . C209 ) is  finite  finite  finite  finite Tree by L641;
end;
reconsider D86 = ( doms C207 ) as  FinTree-yielding FinSequence by L635 , TREES_3:23;
L643: ( dom C205 ) = ( tree D86 ) by L633 , TREES_4:10;
L644: (ex B162 being (Element of ( dom C205 )) st (B162 = C208 & ( succ (C205 , C208) ) = ( C205 * ( B162 succ ) ))) by L309;
L645: ( rng ( C208 succ ) ) c= ( dom C205 );
L646: ( dom ( succ (C205 , C208) ) ) = ( dom ( C208 succ ) ) by L645 , L644 , RELAT_1:27;
L647: ( len ( succ (C205 , C208) ) ) = ( len ( C208 succ ) ) by L646 , FINSEQ_3:29;
L648: ( len ( succ (C205 , C208) ) ) = ( card ( succ C208 ) ) by L647 , L268
.= ( len C207 ) by L634 , L643 , L613;
L649:
now
let C211 being (Element of ( NAT ));
assume L650: C211 < ( len C207 );
L651: ( C211 + 1 ) in ( dom C207 ) by L650 , L51;
L652: (( {} ) in ( ( dom C205 ) | <* C211 *> ) & (ex B163 being DecoratedTree st (B163 = ( C207 . ( C211 + 1 ) ) & ( ( roots C207 ) . ( C211 + 1 ) ) = ( B163 . ( {} ) )))) by L651 , TREES_1:22 , TREES_3:def 18;
L653: ( C207 . ( C211 + 1 ) ) = ( C205 | <* C211 *> ) by L633 , L650 , TREES_4:def 4;
L654: ( ( roots C207 ) . ( C211 + 1 ) ) = ( C205 . ( <* C211 *> ^ ( {} ) ) ) by L653 , L652 , TREES_1:22 , TREES_2:def 10;
L655: ( C211 + 1 ) in ( dom ( succ (C205 , C208) ) ) by L648 , L650 , L51;
L656: ( ( succ (C205 , C208) ) . ( C211 + 1 ) ) = ( C205 . ( ( C208 succ ) . ( C211 + 1 ) ) ) by L655 , L644 , FUNCT_1:12
.= ( C205 . ( C208 ^ <* C211 *> ) ) by L647 , L648 , L650 , L268
.= ( C205 . <* C211 *> ) by FINSEQ_1:34;
thus L657: ( ( succ (C205 , C208) ) . ( C211 + 1 ) ) = ( ( roots C207 ) . ( C211 + 1 ) ) by L656 , L654 , FINSEQ_1:34;
end;
L658: ( dom ( roots C207 ) ) = ( dom C207 ) by TREES_3:def 18;
L659: ( len ( roots C207 ) ) = ( len C207 ) by L658 , FINSEQ_3:29;
thus L660: thesis by L659 , L648 , L649 , L42;
end;
registration
let C212 being  finite-branching DecoratedTree;
let C213 being (Node of C212);
cluster ( C212 | C213 ) ->  finite-branching;
coherence
proof
let C214 being (Element of ( dom ( C212 | C213 ) ));
L661: ( dom ( C212 | C213 ) ) = ( ( dom C212 ) | C213 ) by TREES_2:def 10;
L662: C214 in ( ( dom C212 ) | C213 ) by L661;
reconsider D87 = ( C213 ^ C214 ) as (Element of ( dom C212 )) by L662 , TREES_1:def 6;
L663: ( dom C212 ) = ( ( dom C212 ) with-replacement (C213 , ( ( dom C212 ) | C213 )) ) by TREES_2:6;
L664: ( succ D87 ) , ( succ C214 ) are_equipotent  by L663 , L661 , TREES_2:37;
L665: ( card ( succ C214 ) ) = ( card ( succ D87 ) ) by L664 , CARD_1:5;
thus L666: thesis by L665;
end;
end;
theorem
L668: (for B164 being  finite-branching DecoratedTree holds (for B165 being (Node of B164) holds (for B166 being (Node of ( B164 | B165 )) holds ( succ (B164 , ( B165 ^ B166 )) ) = ( succ (( B164 | B165 ) , B166) ))))
proof
let C215 being  finite-branching DecoratedTree;
let C216 being (Node of C215);
let C217 being (Node of ( C215 | C216 ));
L669: ( dom ( C215 | C216 ) ) = ( ( dom C215 ) | C216 ) by TREES_2:def 10;
reconsider D88 = ( C216 ^ C217 ) as (Element of ( dom C215 )) by L669 , TREES_1:def 6;
reconsider D89 = C217 as (Element of ( dom ( C215 | C216 ) ));
L670: ( dom C215 ) = ( ( dom C215 ) with-replacement (C216 , ( ( dom C215 ) | C216 )) ) by TREES_2:6;
L671: ( succ D88 ) , ( succ D89 ) are_equipotent  by L670 , L669 , TREES_2:37;
L672: ( card ( succ D89 ) ) = ( card ( succ D88 ) ) by L671 , CARD_1:5;
L673: (ex B167 being (Element of ( dom ( C215 | C216 ) )) st (B167 = D89 & ( succ (( C215 | C216 ) , D89) ) = ( ( C215 | C216 ) * ( B167 succ ) ))) by L309;
L674: ( rng ( D89 succ ) ) c= ( dom ( C215 | C216 ) );
L675: ( dom ( succ (( C215 | C216 ) , D89) ) ) = ( dom ( D89 succ ) ) by L674 , L673 , RELAT_1:27;
L676: (ex B168 being (Element of ( dom C215 )) st (B168 = D88 & ( succ (C215 , D88) ) = ( C215 * ( B168 succ ) ))) by L309;
L677: ( rng ( D88 succ ) ) c= ( dom C215 );
L678: ( dom ( succ (C215 , D88) ) ) = ( dom ( D88 succ ) ) by L677 , L676 , RELAT_1:27;
L679: ( len ( D89 succ ) ) = ( card ( succ D89 ) ) by L268;
L680: ( len ( D88 succ ) ) = ( card ( succ D88 ) ) by L268;
L681: ( dom ( D88 succ ) ) = ( dom ( D89 succ ) ) by L680 , L679 , L672 , FINSEQ_3:29;
L682:
now
let C218 being Nat;
assume L683: C218 in ( dom ( D89 succ ) );
consider C219 being (Element of ( NAT )) such that L684: C218 = ( C219 + 1 ) and L685: C219 < ( len ( D89 succ ) ) by L683 , L36;
L686: ( D89 ^ <* C219 *> ) in ( succ D89 ) by L679 , L685 , L255;
thus L687: ( ( succ (C215 , D88) ) . C218 ) = ( C215 . ( ( D88 succ ) . C218 ) ) by L676 , L681 , L678 , L683 , FUNCT_1:12
.= ( C215 . ( D88 ^ <* C219 *> ) ) by L680 , L679 , L672 , L684 , L685 , L268
.= ( C215 . ( C216 ^ ( D89 ^ <* C219 *> ) ) ) by FINSEQ_1:32
.= ( ( C215 | C216 ) . ( D89 ^ <* C219 *> ) ) by L669 , L686 , TREES_2:def 10
.= ( ( C215 | C216 ) . ( ( D89 succ ) . C218 ) ) by L684 , L685 , L268
.= ( ( succ (( C215 | C216 ) , D89) ) . C218 ) by L673 , L675 , L683 , FUNCT_1:12;
end;
thus L688: thesis by L682 , L681 , L678 , L675 , FINSEQ_1:13;
end;
begin
theorem
L689: (for B169 being (Element of ( NAT )) holds (for B170 being FinSequence holds (ex B171 being FinSequence st (B171 = ( B170 | ( Seg B169 ) ) & B171 is_a_prefix_of B170))))
proof
let C220 being (Element of ( NAT ));
let C221 being FinSequence;
L690: ( C221 | ( Seg C220 ) ) is FinSequence by FINSEQ_1:15;
consider C222 being FinSequence such that L691: C222 = ( C221 | ( Seg C220 ) ) by L690;
L692: C222 is_a_prefix_of C221 by L691 , TREES_1:def 1;
thus L693: thesis by L692 , L691;
end;
theorem
L694: (for B172 being non  empty set holds (for B173 being (FinSequence of B172) holds (for B174 , B175 being FinSequence holds (for B176 being (Element of ( NAT )) holds ((( B176 + 1 ) <= ( len B173 ) & B174 = ( B173 | ( Seg ( B176 + 1 ) ) ) & B175 = ( B173 | ( Seg B176 ) )) implies (ex B177 being (Element of B172) st B174 = ( B175 ^ <* B177 *> )))))))
proof
let C223 being non  empty set;
let C224 being (FinSequence of C223);
let C225 , C226 being FinSequence;
let C227 being (Element of ( NAT ));
assume that
L695: ( C227 + 1 ) <= ( len C224 )
and
L696: C225 = ( C224 | ( Seg ( C227 + 1 ) ) )
and
L697: C226 = ( C224 | ( Seg C227 ) );
L698: C227 < ( len C224 ) by L695 , NAT_1:13;
L699: ( len C226 ) = C227 by L698 , L697 , FINSEQ_1:17;
L700: C226 is_a_prefix_of C224 by L697 , TREES_1:def 1;
L701: (ex B178 being FinSequence st C224 = ( C226 ^ B178 )) by L700 , TREES_1:1;
reconsider D90 = C226 as (FinSequence of C223) by L701 , FINSEQ_1:36;
L702: C225 is_a_prefix_of C224 by L696 , TREES_1:def 1;
L703: (ex B179 being FinSequence st C224 = ( C225 ^ B179 )) by L702 , TREES_1:1;
reconsider D91 = C225 as (FinSequence of C223) by L703 , FINSEQ_1:36;
L704: ( len C225 ) = ( C227 + 1 ) by L695 , L696 , FINSEQ_1:17;
L705:
now
assume L706: D91 is_a_prefix_of D90;
L707: ( C227 + 1 ) <= ( C227 + ( 0 ) ) by L706 , L704 , L699 , NAT_1:43;
thus L708: contradiction by L707 , XREAL_1:6;
end;
L709: D91 , D90 are_c=-comparable  by L703 , L701 , TREES_A:1;
L710: D90 is_a_prefix_of D91 by L709 , L705 , XBOOLE_0:def 9;
consider C228 being FinSequence such that L711: D91 = ( D90 ^ C228 ) by L710 , TREES_1:1;
reconsider D92 = C228 as (FinSequence of C223) by L711 , FINSEQ_1:36;
L712: ( len D92 ) = 1
proof
consider C229 being (Element of ( NAT )) such that L713: C229 = ( len D92 );
L714: ( C227 + 1 ) = ( C227 + C229 ) by L704 , L699 , L711 , L713 , FINSEQ_1:22;
thus L715: thesis by L714 , L713;
end;
consider C230 being set such that L716: C230 = ( D92 . 1 );
L717: 1 in { 1 } by TARSKI:def 1;
L718: 1 in ( dom D92 ) by L717 , L712 , FINSEQ_1:2 , FINSEQ_1:def 3;
L719: C230 in ( rng D92 ) by L718 , L716 , FUNCT_1:def 3;
L720: D92 = <* C230 *> by L712 , L716 , FINSEQ_1:40;
thus L721: thesis by L720 , L711 , L719;
end;
theorem
L722: (for B180 being non  empty set holds (for B181 being (FinSequence of B180) holds (for B182 being FinSequence holds ((1 <= ( len B181 ) & B182 = ( B181 | ( Seg 1 ) )) implies (ex B183 being (Element of B180) st B182 = <* B183 *>)))))
proof
let C231 being non  empty set;
let C232 being (FinSequence of C231);
let C233 being FinSequence;
assume that
L723: 1 <= ( len C232 )
and
L724: C233 = ( C232 | ( Seg 1 ) );
consider C234 being set such that L725: C234 = ( C233 . 1 );
L726: 1 in { 1 } by TARSKI:def 1;
L727: 1 in ( dom C233 ) by L726 , L723 , L724 , FINSEQ_1:2 , FINSEQ_1:17;
L728: C234 in ( rng C233 ) by L727 , L725 , FUNCT_1:def 3;
L729: ( len C233 ) = 1 by L723 , L724 , FINSEQ_1:17;
L730: C233 = <* C234 *> by L729 , L725 , FINSEQ_1:40;
L731: C233 is_a_prefix_of C232 by L724 , TREES_1:def 1;
L732: (ex B184 being FinSequence st C232 = ( C233 ^ B184 )) by L731 , TREES_1:1;
reconsider D93 = C233 as (FinSequence of C231) by L732 , FINSEQ_1:36;
L733: ( rng D93 ) c= C231;
thus L734: thesis by L733 , L730 , L728;
end;
theorem
L735: (for R8 being DecoratedTree holds (for R9 being (FinSequence of ( NAT )) holds ( R8 . R9 ) = ( ( R8 | R9 ) . ( {} ) )))
proof
let R8 being DecoratedTree;
let R9 being (FinSequence of ( NAT ));
L736: ( <*> ( NAT ) ) in ( ( dom R8 ) | R9 ) by TREES_1:22;
L737: ( ( R8 | R9 ) . ( <*> ( NAT ) ) ) = ( R8 . ( R9 ^ ( <*> ( NAT ) ) ) ) by L736 , TREES_2:def 10
.= ( R8 . R9 ) by FINSEQ_1:34;
thus L738: thesis by L737;
end;
theorem
L739: (for R10 being  finite-branching DecoratedTree holds (for R11 being (Element of ( dom R10 )) holds ( succ (R10 , R11) ) = ( R10 * ( R11 succ ) )))
proof
let R10 being  finite-branching DecoratedTree;
let R11 being (Element of ( dom R10 ));
L740: (ex B185 being (Element of ( dom R10 )) st (B185 = R11 & ( succ (R10 , R11) ) = ( R10 * ( B185 succ ) ))) by L309;
thus L741: thesis by L740;
end;
theorem
L742: (for R10 being  finite-branching DecoratedTree holds (for R11 being (Element of ( dom R10 )) holds ( dom ( R10 * ( R11 succ ) ) ) = ( dom ( R11 succ ) )))
proof
let R10 being  finite-branching DecoratedTree;
let R11 being (Element of ( dom R10 ));
L743: ( rng ( R11 succ ) ) c= ( dom R10 );
thus L744: thesis by L743 , RELAT_1:27;
end;
theorem
L745: (for R10 being  finite-branching DecoratedTree holds (for R11 being (Element of ( dom R10 )) holds ( dom ( succ (R10 , R11) ) ) = ( dom ( R11 succ ) )))
proof
let R10 being  finite-branching DecoratedTree;
let R11 being (Element of ( dom R10 ));
thus L746: ( dom ( succ (R10 , R11) ) ) = ( dom ( R10 * ( R11 succ ) ) ) by L739
.= ( dom ( R11 succ ) ) by L742;
end;
theorem
L747: (for R10 being  finite-branching DecoratedTree holds (for R11 being (Element of ( dom R10 )) holds (for R13 being (Element of ( NAT )) holds (( R11 ^ <* R13 *> ) in ( dom R10 ) iff ( R13 + 1 ) in ( dom ( R11 succ ) )))))
proof
let R10 being  finite-branching DecoratedTree;
let R11 being (Element of ( dom R10 ));
let R13 being (Element of ( NAT ));
L748:
now
assume L749: ( R11 ^ <* R13 *> ) in ( dom R10 );
L750: ( R11 ^ <* R13 *> ) in ( succ R11 ) by L749;
L751: R13 < ( card ( succ R11 ) ) by L750 , L255;
L752: R13 < ( len ( R11 succ ) ) by L751 , L268;
L753: ( R13 + 1 ) <= ( len ( R11 succ ) ) by L752 , NAT_1:13;
L754: ( 0 ) <= R13 by NAT_1:2;
L755: ( ( 0 ) + 1 ) <= ( R13 + 1 ) by L754 , XREAL_1:6;
L756: ( R13 + 1 ) in ( Seg ( len ( R11 succ ) ) ) by L755 , L753 , FINSEQ_1:1;
thus L757: ( R13 + 1 ) in ( dom ( R11 succ ) ) by L756 , FINSEQ_1:def 3;
end;
thus L758: (( R11 ^ <* R13 *> ) in ( dom R10 ) implies ( R13 + 1 ) in ( dom ( R11 succ ) )) by L748;
assume L759: ( R13 + 1 ) in ( dom ( R11 succ ) );
L760: ( R13 + 1 ) in ( Seg ( len ( R11 succ ) ) ) by L759 , FINSEQ_1:def 3;
L761: ( R13 + 1 ) <= ( len ( R11 succ ) ) by L760 , FINSEQ_1:1;
L762: R13 < ( len ( R11 succ ) ) by L761 , NAT_1:13;
L763: R13 < ( card ( succ R11 ) ) by L762 , L268;
L764: ( R11 ^ <* R13 *> ) in ( succ R11 ) by L763 , L255;
thus L765: thesis by L764;
end;
theorem
L766: (for R10 being  finite-branching DecoratedTree holds (for R12 being FinSequence holds (for R13 being (Element of ( NAT )) holds (( R12 ^ <* R13 *> ) in ( dom R10 ) implies ( R10 . ( R12 ^ <* R13 *> ) ) = ( ( succ (R10 , R12) ) . ( R13 + 1 ) )))))
proof
let R10 being  finite-branching DecoratedTree;
let R12 being FinSequence;
let R13 being (Element of ( NAT ));
assume L767: ( R12 ^ <* R13 *> ) in ( dom R10 );
L768: R12 is_a_prefix_of ( R12 ^ <* R13 *> ) by TREES_1:1;
L769: R12 in ( dom R10 ) by L768 , L767 , TREES_1:20;
consider C235 being (Element of ( dom R10 )) such that L770: C235 = R12 and L771: ( succ (R10 , R12) ) = ( R10 * ( C235 succ ) ) by L769 , L309;
L772: ( R13 + 1 ) in ( dom ( C235 succ ) ) by L767 , L770 , L747;
L773: ( R13 + 1 ) in ( Seg ( len ( C235 succ ) ) ) by L772 , FINSEQ_1:def 3;
L774: ( R13 + 1 ) <= ( len ( C235 succ ) ) by L773 , FINSEQ_1:1;
L775: R13 < ( len ( C235 succ ) ) by L774 , NAT_1:13;
L776: ( R13 + 1 ) in ( dom ( R10 * ( C235 succ ) ) ) by L772 , L742;
L777: ( ( succ (R10 , R12) ) . ( R13 + 1 ) ) = ( R10 . ( ( C235 succ ) . ( R13 + 1 ) ) ) by L776 , L771 , FUNCT_1:12
.= ( R10 . ( R12 ^ <* R13 *> ) ) by L770 , L775 , L268;
thus L778: thesis by L777;
end;
theorem
L779: (for R10 being  finite-branching DecoratedTree holds (for R15 being (Element of ( dom R10 )) holds (for R16 being (Element of ( dom R10 )) holds (R16 in ( succ R15 ) implies ( R10 . R16 ) in ( rng ( succ (R10 , R15) ) )))))
proof
let R10 being  finite-branching DecoratedTree;
let R15 being (Element of ( dom R10 ));
let R16 being (Element of ( dom R10 ));
assume L780: R16 in ( succ R15 );
consider R13 being (Element of ( NAT )) such that L781: R16 = ( R15 ^ <* R13 *> ) and L782: ( R15 ^ <* R13 *> ) in ( dom R10 ) by L780;
L783: ( R10 . R16 ) = ( ( succ (R10 , R15) ) . ( R13 + 1 ) ) by L781 , L766;
L784: ( dom ( succ (R10 , R15) ) ) = ( dom ( R10 * ( R15 succ ) ) ) by L739
.= ( dom ( R15 succ ) ) by L742;
L785: ( R13 + 1 ) in ( dom ( succ (R10 , R15) ) ) by L784 , L781 , L747;
thus L786: thesis by L785 , L783 , FUNCT_1:def 3;
end;
theorem
L787: (for R10 being  finite-branching DecoratedTree holds (for R15 being (Element of ( dom R10 )) holds (for R17 being set holds (R17 in ( rng ( succ (R10 , R15) ) ) implies (ex R16 being (Element of ( dom R10 )) st (R17 = ( R10 . R16 ) & R16 in ( succ R15 )))))))
proof
let R10 being  finite-branching DecoratedTree;
let R15 being (Element of ( dom R10 ));
let R17 being set;
consider C236 being Nat such that L788: ( dom ( succ (R10 , R15) ) ) = ( Seg C236 ) by FINSEQ_1:def 2;
assume L789: R17 in ( rng ( succ (R10 , R15) ) );
consider C237 being set such that L790: C237 in ( dom ( succ (R10 , R15) ) ) and L791: R17 = ( ( succ (R10 , R15) ) . C237 ) by L789 , FUNCT_1:def 3;
L792: ( Seg C236 ) = { R14 where R14 is (Element of ( NAT )) : (1 <= R14 & R14 <= C236) } by FINSEQ_1:def 1;
consider C238 being (Element of ( NAT )) such that L793: C237 = C238 and L794: 1 <= C238 and L795: C238 <= C236 by L792 , L790 , L788;
L796: C238 <> ( 0 ) by L794;
consider C239 being Nat such that L797: ( C239 + 1 ) = C238 by L796 , NAT_1:6;
reconsider D94 = C239 as (Element of ( NAT )) by ORDINAL1:def 12;
L798: ( D94 + 1 ) in ( dom ( R15 succ ) ) by L790 , L793 , L797 , L745;
L799: ( R15 ^ <* D94 *> ) in ( dom R10 ) by L798 , L747;
consider R16 being (Element of ( dom R10 )) such that L800: R16 = ( R15 ^ <* D94 *> ) by L799;
L801: R16 in ( succ R15 ) by L800;
L802: R17 = ( R10 . R16 ) by L791 , L793 , L797 , L800 , L766;
thus L803: thesis by L802 , L801;
end;
scheme ExDecTrees { F3() -> non  empty set , F4() -> (Element of F3()) , F5(set) -> (FinSequence of F3()) } : (ex B186 being  finite-branching (DecoratedTree of F3()) st (( B186 . ( {} ) ) = F4() & (for B187 being (Element of ( dom B186 )) holds (for B188 being (Element of F3()) holds (B188 = ( B186 . B187 ) implies ( succ (B186 , B187) ) = F5(B188))))))
proof
defpred S5[ set , set ] means ((( len F5($1) ) = ( 0 ) & $2 = ( {} )) or (( len F5($1) ) <> ( 0 ) & (ex R23 being (Element of ( NAT )) st (( R23 + 1 ) = ( len F5($1) ) & $2 = ( { ( 0 ) } \/ ( Seg R23 ) )))));
L804: (for R24 being set holds (R24 in F3() implies (ex R25 being set st S5[ R24 , R25 ])))
proof
let R24 being set;
assume that
L805: R24 in F3();
per cases ;
suppose L806: ( len F5(R24) ) = ( 0 );

thus L807: thesis by L806;
end;
suppose L808: ( len F5(R24) ) <> ( 0 );

consider C240 being Nat such that L809: ( C240 + 1 ) = ( len F5(R24) ) by L808 , NAT_1:6;
reconsider D95 = C240 as (Element of ( NAT )) by ORDINAL1:def 12;
L810: (ex R25 being set st R25 = ( { ( 0 ) } \/ ( Seg D95 ) ));
thus L811: thesis by L810 , L809;
end;
end;
L813: (ex B189 being Function st (( dom B189 ) = F3() & (for R24 being set holds (R24 in F3() implies S5[ R24 , ( B189 . R24 ) ])))) from CLASSES1:sch 1(L804);
consider C241 being Function such that L814: (for R24 being set holds (R24 in F3() implies ((( len F5(R24) ) = ( 0 ) & ( C241 . R24 ) = ( {} )) or (( len F5(R24) ) <> ( 0 ) & (ex R23 being (Element of ( NAT )) st (( R23 + 1 ) = ( len F5(R24) ) & ( C241 . R24 ) = ( { ( 0 ) } \/ ( Seg R23 ) ))))))) by L813;
deffunc H4(set) = ( C241 . $1 );
L815: (for R22 being (Element of ( NAT )) holds (for R24 being set holds (R24 in F3() implies (R22 in H4(R24) iff ( R22 + 1 ) in ( Seg ( len F5(R24) ) )))))
proof
let R22 being (Element of ( NAT ));
let R24 being set;
assume that
L816: R24 in F3();
L817:
now
assume L818: R22 in H4(R24);
consider R23 being (Element of ( NAT )) such that L819: ( R23 + 1 ) = ( len F5(R24) ) and L820: ( C241 . R24 ) = ( { ( 0 ) } \/ ( Seg R23 ) ) by L818 , L814 , L816;
L821: (( 0 ) <= R22 & R22 <= R23)
proof
per cases  by L818 , L820 , XBOOLE_0:def 3;
suppose L822: R22 in { ( 0 ) };

L823: R22 = ( 0 ) by L822 , TARSKI:def 1;
thus L824: thesis by L823 , NAT_1:2;
end;
suppose L825: R22 in ( Seg R23 );

L826: ( ( 0 ) + 1 ) <= R22 by L825 , FINSEQ_1:1;
thus L827: thesis by L826 , L825 , FINSEQ_1:1 , NAT_1:13;
end;
end;
L829: (( ( 0 ) + 1 ) <= ( R22 + 1 ) & ( R22 + 1 ) <= ( R23 + 1 )) by L821 , XREAL_1:6;
thus L830: ( R22 + 1 ) in ( Seg ( len F5(R24) ) ) by L829 , L819 , FINSEQ_1:1;
end;
thus L831: (R22 in H4(R24) implies ( R22 + 1 ) in ( Seg ( len F5(R24) ) )) by L817;
assume L832: ( R22 + 1 ) in ( Seg ( len F5(R24) ) );
L833: ( len F5(R24) ) <> ( 0 ) by L832;
consider R23 being (Element of ( NAT )) such that L834: ( R23 + 1 ) = ( len F5(R24) ) and L835: ( C241 . R24 ) = ( { ( 0 ) } \/ ( Seg R23 ) ) by L833 , L814 , L816;
L836: R22 in ( { ( 0 ) } \/ ( Seg R23 ) )
proof
per cases ;
suppose L837: R22 = ( 0 );

L838: R22 in { ( 0 ) } by L837 , TARSKI:def 1;
thus L839: thesis by L838 , XBOOLE_0:def 3;
end;
suppose L840: R22 <> ( 0 );

L841: ( 0 ) < R22 by L840 , NAT_1:3;
L842: ( ( 0 ) + 1 ) <= R22 by L841 , NAT_1:13;
L843: ( R22 + 1 ) <= ( len F5(R24) ) by L832 , FINSEQ_1:1;
L844: R22 <= R23 by L843 , L834 , XREAL_1:6;
L845: R22 in ( Seg R23 ) by L844 , L842 , FINSEQ_1:1;
thus L846: thesis by L845 , XBOOLE_0:def 3;
end;
end;
thus L848: thesis by L836 , L835;
end;
L849: (for R10 being  finite-branching DecoratedTree holds (for B190 being set holds (for B191 being (Element of ( dom R10 )) holds (B190 in F3() implies { ( B191 ^ <* R22 *> ) where R22 is (Element of ( NAT )) : R22 in H4(B190) } = { ( B191 ^ <* R23 *> ) where R23 is (Element of ( NAT )) : ( R23 + 1 ) in ( Seg ( len F5(B190) ) ) }))))
proof
let R10 being  finite-branching DecoratedTree;
let C242 being set;
let C243 being (Element of ( dom R10 ));
assume that
L850: C242 in F3();
thus L851: { ( C243 ^ <* R22 *> ) where R22 is (Element of ( NAT )) : R22 in H4(C242) } c= { ( C243 ^ <* R23 *> ) where R23 is (Element of ( NAT )) : ( R23 + 1 ) in ( Seg ( len F5(C242) ) ) }
proof
let C244 being set;
assume L852: C244 in { ( C243 ^ <* R22 *> ) where R22 is (Element of ( NAT )) : R22 in H4(C242) };
consider R22 being (Element of ( NAT )) such that L853: C244 = ( C243 ^ <* R22 *> ) and L854: R22 in H4(C242) by L852;
L855: ( R22 + 1 ) in ( Seg ( len F5(C242) ) ) by L815 , L850 , L854;
thus L856: thesis by L855 , L853;
end;

thus L857: { ( C243 ^ <* R23 *> ) where R23 is (Element of ( NAT )) : ( R23 + 1 ) in ( Seg ( len F5(C242) ) ) } c= { ( C243 ^ <* R22 *> ) where R22 is (Element of ( NAT )) : R22 in H4(C242) }
proof
let C245 being set;
assume L858: C245 in { ( C243 ^ <* R23 *> ) where R23 is (Element of ( NAT )) : ( R23 + 1 ) in ( Seg ( len F5(C242) ) ) };
consider R23 being (Element of ( NAT )) such that L859: C245 = ( C243 ^ <* R23 *> ) and L860: ( R23 + 1 ) in ( Seg ( len F5(C242) ) ) by L858;
L861: R23 in H4(C242) by L815 , L850 , L860;
thus L862: thesis by L861 , L859;
end;

end;
defpred S6[ set , set ] means (ex R24 being set st (ex R18 being (Element of ( NAT )) st (R24 in F3() & $1 = [ R24 , R18 ] & ((R18 in H4(R24) & $2 = ( F5(R24) . ( R18 + 1 ) )) or ((not R18 in H4(R24)) & $2 = F4())))));
L858: (for B192 being (Element of [: F3() , ( NAT ) :]) holds (ex B193 being (Element of F3()) st S6[ B192 , B193 ]))
proof
let C246 being (Element of [: F3() , ( NAT ) :]);
L859: (( C246 `1 ) in F3() & ( C246 `2 ) in ( NAT )) by MCART_1:10;
consider C247 being (Element of F3()), C248 being (Element of ( NAT )) such that L860: (C247 = ( C246 `1 ) & C248 = ( C246 `2 )) by L859;
L861: C246 = [ C247 , C248 ] by L860 , MCART_1:21;
per cases ;
suppose L862: C248 in H4(C247);

L863: ( C248 + 1 ) in ( Seg ( len F5(C247) ) ) by L862 , L815;
L864: ( C248 + 1 ) in ( dom F5(C247) ) by L863 , FINSEQ_1:def 3;
L865: ( F5(C247) . ( C248 + 1 ) ) in ( rng F5(C247) ) by L864 , FUNCT_1:def 3;
thus L866: thesis by L861 , L862 , L865;
end;
suppose L867: (not C248 in H4(C247));

thus L868: thesis by L867 , L861;
end;
end;
L870: (ex B194 being (Function of [: F3() , ( NAT ) :] , F3()) st (for B195 being (Element of [: F3() , ( NAT ) :]) holds S6[ B195 , ( B194 . B195 ) ])) from FUNCT_2:sch 3(L858);
consider C249 being (Function of [: F3() , ( NAT ) :] , F3()) such that L871: (for B196 being (Element of [: F3() , ( NAT ) :]) holds S6[ B196 , ( C249 . B196 ) ]) by L870;
L872: (for R18 being (Element of ( NAT )) holds (for R24 being set holds (for R23 being (Element of ( NAT )) holds ((( R23 + 1 ) = ( len F5(R24) ) & R24 in F3()) implies (R18 in H4(R24) iff (( 0 ) <= R18 & R18 <= R23))))))
proof
let R18 being (Element of ( NAT ));
let R24 being set;
let R23 being (Element of ( NAT ));
assume that
L873: ( R23 + 1 ) = ( len F5(R24) )
and
L874: R24 in F3();
thus L875: (R18 in H4(R24) implies (( 0 ) <= R18 & R18 <= R23))
proof
L876: (ex R22 being (Element of ( NAT )) st (( R22 + 1 ) = ( len F5(R24) ) & H4(R24) = ( { ( 0 ) } \/ ( Seg R22 ) ))) by L814 , L873 , L874;
assume L877: R18 in H4(R24);
per cases  by L873 , L877 , L876 , XBOOLE_0:def 3;
suppose L878: R18 in { ( 0 ) };

L879: R18 = ( 0 ) by L878 , TARSKI:def 1;
thus L880: thesis by L879 , NAT_1:2;
end;
suppose L881: R18 in ( Seg R23 );

L882: 1 <= R18 by L881 , FINSEQ_1:1;
thus L883: thesis by L882 , L881 , FINSEQ_1:1 , XXREAL_0:2;
end;
end;

thus L885: ((( 0 ) <= R18 & R18 <= R23) implies R18 in H4(R24))
proof
assume that
L886: ( 0 ) <= R18
and
L887: R18 <= R23;
L888: (ex R22 being (Element of ( NAT )) st (( R22 + 1 ) = ( len F5(R24) ) & H4(R24) = ( { ( 0 ) } \/ ( Seg R22 ) ))) by L814 , L873 , L874;
per cases ;
suppose L889: R18 = ( 0 );

L890: R18 in { ( 0 ) } by L889 , TARSKI:def 1;
thus L891: thesis by L890 , L888 , XBOOLE_0:def 3;
end;
suppose L892: R18 <> ( 0 );

L893: ( 0 ) < R18 by L892 , NAT_1:3;
L894: ( ( 0 ) + 1 ) <= R18 by L893 , NAT_1:13;
L895: R18 in ( Seg R23 ) by L894 , L887 , FINSEQ_1:1;
thus L896: thesis by L895 , L873 , L888 , XBOOLE_0:def 3;
end;
end;

end;
L886: (for B197 being (Element of F3()) holds (for R19 being (Element of ( NAT )) holds (for R20 being (Element of ( NAT )) holds ((R19 <= R20 & R20 in H4(B197)) implies R19 in H4(B197)))))
proof
let C250 being (Element of F3());
let R19 being (Element of ( NAT ));
let R20 being (Element of ( NAT ));
assume that
L887: R19 <= R20
and
L888: R20 in H4(C250);
L889: (ex R23 being (Element of ( NAT )) st (( R23 + 1 ) = ( len F5(C250) ) & ( C241 . C250 ) = ( { ( 0 ) } \/ ( Seg R23 ) ))) by L814 , L888;
consider R23 being (Element of ( NAT )) such that L890: ( R23 + 1 ) = ( len F5(C250) ) by L889;
L891: R20 <= R23 by L872 , L888 , L890;
L892: (( 0 ) <= R19 & R19 <= R23) by L891 , L887 , NAT_1:2 , XXREAL_0:2;
thus L893: thesis by L892 , L872 , L890;
end;
consider C251 being (DecoratedTree of F3()) such that L894: (( C251 . ( {} ) ) = F4() & (for B198 being (Element of ( dom C251 )) holds (( succ B198 ) = { ( B198 ^ <* R22 *> ) where R22 is (Element of ( NAT )) : R22 in H4(( C251 . B198 )) } & (for R18 being (Element of ( NAT )) holds (R18 in H4(( C251 . B198 )) implies ( C251 . ( B198 ^ <* R18 *> ) ) = ( C249 . (( C251 . B198 ) , R18) )))))) from TREES_2:sch 8(L886);
L895: (for B199 being (Element of ( dom C251 )) holds ( succ B199 ) is  finite)
proof
let C252 being (Element of ( dom C251 ));
defpred S7[ set , set ] means (ex R23 being (Element of ( NAT )) st (( R23 + 1 ) = $1 & $2 = ( C252 ^ <* R23 *> )));
L896: (for B200 being Nat holds (B200 in ( Seg ( len F5(( C251 . C252 )) ) ) implies (ex R24 being set st S7[ B200 , R24 ])))
proof
let C253 being Nat;
assume L897: C253 in ( Seg ( len F5(( C251 . C252 )) ) );
L898: C253 <> ( 0 ) by L897 , FINSEQ_1:1;
consider C254 being Nat such that L899: ( C254 + 1 ) = C253 by L898 , NAT_1:6;
reconsider D96 = C254 as (Element of ( NAT )) by ORDINAL1:def 12;
L900: (ex R24 being set st R24 = ( C252 ^ <* D96 *> ));
thus L901: thesis by L900 , L899;
end;
L902: (ex B201 being FinSequence st (( dom B201 ) = ( Seg ( len F5(( C251 . C252 )) ) ) & (for B202 being Nat holds (B202 in ( Seg ( len F5(( C251 . C252 )) ) ) implies S7[ B202 , ( B201 . B202 ) ])))) from FINSEQ_1:sch 1(L896);
consider C255 being FinSequence such that L903: ( dom C255 ) = ( Seg ( len F5(( C251 . C252 )) ) ) and L904: (for B203 being Nat holds (B203 in ( Seg ( len F5(( C251 . C252 )) ) ) implies S7[ B203 , ( C255 . B203 ) ])) by L902;
L905: (for R22 being (Element of ( NAT )) holds ((1 <= ( R22 + 1 ) & ( R22 + 1 ) <= ( len F5(( C251 . C252 )) )) implies ( C255 . ( R22 + 1 ) ) = ( C252 ^ <* R22 *> )))
proof
let R22 being (Element of ( NAT ));
assume L906: (1 <= ( R22 + 1 ) & ( R22 + 1 ) <= ( len F5(( C251 . C252 )) ));
L907: ( R22 + 1 ) in ( Seg ( len F5(( C251 . C252 )) ) ) by L906 , FINSEQ_1:1;
L908: (ex R23 being (Element of ( NAT )) st (( R23 + 1 ) = ( R22 + 1 ) & ( C255 . ( R22 + 1 ) ) = ( C252 ^ <* R23 *> ))) by L907 , L904;
thus L909: thesis by L908;
end;
L910: ( succ C252 ) = { ( C252 ^ <* R22 *> ) where R22 is (Element of ( NAT )) : R22 in H4(( C251 . C252 )) } by L894;
L911: ( succ C252 ) c= ( rng C255 )
proof
let R24 being set;
assume L912: R24 in ( succ C252 );
consider R22 being (Element of ( NAT )) such that L913: R24 = ( C252 ^ <* R22 *> ) and L914: R22 in H4(( C251 . C252 )) by L912 , L910;
L915: ( R22 + 1 ) in ( Seg ( len F5(( C251 . C252 )) ) ) by L815 , L914;
L916: (1 <= ( R22 + 1 ) & ( R22 + 1 ) <= ( len F5(( C251 . C252 )) )) by L915 , FINSEQ_1:1;
L917: ( C255 . ( R22 + 1 ) ) = ( C252 ^ <* R22 *> ) by L916 , L905;
thus L918: thesis by L917 , L903 , L913 , L915 , FUNCT_1:def 3;
end;
thus L919: thesis by L911;
end;
L920: ( dom C251 ) is  finite-branching by L895 , L156;
reconsider D97 = C251 as  finite-branching (DecoratedTree of F3()) by L920 , L163;
L921: (for R18 being (Element of ( NAT )) holds (for R24 being set holds ((R24 in F3() & R18 in H4(R24)) implies ( C249 . (R24 , R18) ) = ( F5(R24) . ( R18 + 1 ) ))))
proof
let R18 being (Element of ( NAT ));
let R24 being set;
assume that
L922: R24 in F3()
and
L923: R18 in H4(R24);
L924: (( [ R24 , R18 ] `1 ) = R24 & ( [ R24 , R18 ] `2 ) = R18);
L925: [ R24 , R18 ] in [: F3() , ( NAT ) :] by L924 , L922 , MCART_1:11;
consider C256 being (Element of [: F3() , ( NAT ) :]) such that L926: C256 = [ R24 , R18 ] by L925;
consider C257 being set, C258 being (Element of ( NAT )) such that L927: C257 in F3() and L928: C256 = [ C257 , C258 ] and L929: ((C258 in H4(C257) & ( C249 . C256 ) = ( F5(C257) . ( C258 + 1 ) )) or ((not C258 in H4(C257)) & ( C249 . C256 ) = F4())) by L871;
L930: C257 = R24 by L926 , L928 , XTUPLE_0:1;
thus L931: thesis by L930 , L923 , L926 , L928 , L929 , XTUPLE_0:1;
end;
L932:
now
let C259 being (Element of ( dom D97 ));
let C260 being (Element of F3());
assume that
L933: C260 = ( D97 . C259 );
L934: ( succ C259 ) = { ( C259 ^ <* R22 *> ) where R22 is (Element of ( NAT )) : R22 in H4(C260) } by L894 , L933;
L935: ( succ C259 ) = { ( C259 ^ <* R22 *> ) where R22 is (Element of ( NAT )) : ( R22 + 1 ) in ( Seg ( len F5(C260) ) ) } by L934 , L849;
L936: ( dom F5(C260) ) = ( Seg ( len F5(C260) ) ) by FINSEQ_1:def 3;
L937: ( dom ( C259 succ ) ) = ( Seg ( len ( C259 succ ) ) ) by FINSEQ_1:def 3;
L938: ( dom ( C259 succ ) ) c= ( dom F5(C260) )
proof
let C261 being set;
L939: ( Seg ( len ( C259 succ ) ) ) = { R22 where R22 is (Element of ( NAT )) : (1 <= R22 & R22 <= ( len ( C259 succ ) )) } by FINSEQ_1:def 1;
assume L940: C261 in ( dom ( C259 succ ) );
consider R23 being (Element of ( NAT )) such that L941: C261 = R23 and L942: 1 <= R23 and L943: R23 <= ( len ( C259 succ ) ) by L940 , L937 , L939;
L944: ( 0 ) <> R23 by L942;
consider C262 being Nat such that L945: R23 = ( C262 + 1 ) by L944 , NAT_1:6;
reconsider D98 = C262 as (Element of ( NAT )) by ORDINAL1:def 12;
L946: ( D98 + 1 ) in ( dom ( C259 succ ) ) by L937 , L939 , L942 , L943 , L945;
L947: ( C259 ^ <* D98 *> ) in ( dom D97 ) by L946 , L747;
L948: ( C259 ^ <* D98 *> ) in ( succ C259 ) by L947;
consider R22 being (Element of ( NAT )) such that L949: ( C259 ^ <* R22 *> ) = ( C259 ^ <* D98 *> ) and L950: ( R22 + 1 ) in ( Seg ( len F5(C260) ) ) by L948 , L935;
L951: <* R22 *> = <* D98 *> by L949 , FINSEQ_1:33;
thus L952: thesis by L951 , L936 , L941 , L945 , L950 , TREES_1:5;
end;
L953: ( dom F5(C260) ) c= ( dom ( C259 succ ) )
proof
let C263 being set;
L954: ( Seg ( len F5(C260) ) ) = { R22 where R22 is (Element of ( NAT )) : (1 <= R22 & R22 <= ( len F5(C260) )) } by FINSEQ_1:def 1;
assume L955: C263 in ( dom F5(C260) );
consider R23 being (Element of ( NAT )) such that L956: C263 = R23 and L957: 1 <= R23 and L958: R23 <= ( len F5(C260) ) by L955 , L936 , L954;
L959: ( 0 ) <> R23 by L957;
consider C264 being Nat such that L960: R23 = ( C264 + 1 ) by L959 , NAT_1:6;
reconsider D99 = C264 as (Element of ( NAT )) by ORDINAL1:def 12;
L961: ( D99 + 1 ) in ( Seg ( len F5(C260) ) ) by L954 , L957 , L958 , L960;
L962: ( C259 ^ <* D99 *> ) in ( succ C259 ) by L961 , L935;
thus L963: thesis by L962 , L956 , L960 , L747;
end;
L964: ( dom F5(C260) ) = ( dom ( C259 succ ) ) by L953 , L938 , XBOOLE_0:def 10;
L965: ( dom ( succ (D97 , C259) ) ) = ( dom F5(C260) ) by L964 , L745;
L966: (for B204 being Nat holds (B204 in ( dom ( succ (D97 , C259) ) ) implies ( ( succ (D97 , C259) ) . B204 ) = ( F5(C260) . B204 )))
proof
let C265 being Nat;
L967: ( Seg ( len F5(C260) ) ) = { R22 where R22 is (Element of ( NAT )) : (1 <= R22 & R22 <= ( len F5(C260) )) } by FINSEQ_1:def 1;
assume L968: C265 in ( dom ( succ (D97 , C259) ) );
L969: C265 in ( Seg ( len F5(C260) ) ) by L968 , L965 , FINSEQ_1:def 3;
L970: ( len F5(C260) ) <> ( 0 ) by L969;
consider R21 being (Element of ( NAT )) such that L971: ( R21 + 1 ) = ( len F5(( D97 . C259 )) ) and L972: ( C241 . ( D97 . C259 ) ) = ( { ( 0 ) } \/ ( Seg R21 ) ) by L970 , L814 , L933;
consider R22 being (Element of ( NAT )) such that L973: C265 = R22 and L974: 1 <= R22 and L975: R22 <= ( len F5(C260) ) by L969 , L967;
L976: ( 0 ) <> R22 by L974;
consider C266 being Nat such that L977: C265 = ( C266 + 1 ) by L976 , L973 , NAT_1:6;
reconsider D100 = C266 as (Element of ( NAT )) by ORDINAL1:def 12;
L978: D100 <= R21 by L933 , L973 , L975 , L977 , L971 , XREAL_1:6;
L979: D100 in ( { ( 0 ) } \/ ( Seg R21 ) )
proof
per cases ;
suppose L980: D100 = ( 0 );

L981: D100 in { ( 0 ) } by L980 , TARSKI:def 1;
thus L982: thesis by L981 , XBOOLE_0:def 3;
end;
suppose L983: D100 <> ( 0 );

L984: ( 0 ) < D100 by L983 , NAT_1:3;
L985: ( ( 0 ) + 1 ) <= D100 by L984 , NAT_1:13;
L986: D100 in ( Seg R21 ) by L985 , L978 , FINSEQ_1:1;
thus L987: thesis by L986 , XBOOLE_0:def 3;
end;
end;
L989: ( D100 + 1 ) in ( dom ( C259 succ ) ) by L968 , L977 , L745;
L990: ( C259 ^ <* D100 *> ) in ( dom D97 ) by L989 , L747;
L991: ( ( succ (D97 , C259) ) . ( D100 + 1 ) ) = ( D97 . ( C259 ^ <* D100 *> ) ) by L990 , L766
.= ( C249 . (( D97 . C259 ) , D100) ) by L894 , L972 , L979
.= ( F5(C260) . ( D100 + 1 ) ) by L921 , L933 , L972 , L979;
thus L992: thesis by L991 , L977;
end;
thus L993: ( succ (D97 , C259) ) = F5(C260) by L966 , L964 , L745 , FINSEQ_1:13;
end;
thus L994: thesis by L932 , L894;
end;
theorem
L995: (for B205 being Tree holds (for B206 being (Element of B205) holds ( ProperPrefixes B206 ) is  finite  finite  finite  finite (Chain of B205)))
proof
let C267 being Tree;
let C268 being (Element of C267);
L996: (( ProperPrefixes C268 ) c= C267 & (for B207 , B208 being (FinSequence of ( NAT )) holds ((B207 in ( ProperPrefixes C268 ) & B208 in ( ProperPrefixes C268 )) implies B207 , B208 are_c=-comparable ))) by TREES_1:18 , TREES_1:def 3;
thus L997: thesis by L996 , TREES_2:def 3;
end;
theorem
L998: (for B209 being Tree holds ( B209 -level ( 0 ) ) = { ( {} ) })
proof
let C269 being Tree;
L999: { ( {} ) } c= { B210 where B210 is (Element of C269) : ( len B210 ) = ( 0 ) }
proof
let R24 being set;
assume L1000: R24 in { ( {} ) };
L1001: R24 = ( {} ) by L1000 , TARSKI:def 1;
L1002: ( {} ) in C269 by TREES_1:22;
consider C270 being (Element of C269) such that L1003: C270 = ( {} ) by L1002;
L1004: ( len C270 ) = ( 0 ) by L1003;
thus L1005: thesis by L1004 , L1001 , L1003;
end;
L1006: { B211 where B211 is (Element of C269) : ( len B211 ) = ( 0 ) } c= { ( {} ) }
proof
let R24 being set;
assume L1007: R24 in { B212 where B212 is (Element of C269) : ( len B212 ) = ( 0 ) };
consider C271 being (Element of C269) such that L1008: C271 = R24 and L1009: ( len C271 ) = ( 0 ) by L1007;
L1010: C271 = ( {} ) by L1009;
thus L1011: thesis by L1010 , L1008 , TARSKI:def 1;
end;
thus L1012: thesis by L1006 , L999 , XBOOLE_0:def 10;
end;
theorem
L1013: (for R18 being (Element of ( NAT )) holds (for B213 being Tree holds ( B213 -level ( R18 + 1 ) ) = ( union { ( succ B214 ) where B214 is (Element of B213) : ( len B214 ) = R18 } )))
proof
let R18 being (Element of ( NAT ));
let C272 being Tree;
thus L1014: ( C272 -level ( R18 + 1 ) ) c= ( union { ( succ B215 ) where B215 is (Element of C272) : ( len B215 ) = R18 } )
proof
let R24 being set;
assume L1015: R24 in ( C272 -level ( R18 + 1 ) );
reconsider D101 = R24 as (Element of C272) by L1015;
L1016: ( D101 | ( Seg R18 ) ) is (FinSequence of ( NAT )) by FINSEQ_1:18;
consider C273 being (FinSequence of ( NAT )) such that L1017: C273 = ( D101 | ( Seg R18 ) ) by L1016;
L1018: C273 is_a_prefix_of D101 by L1017 , TREES_1:def 1;
reconsider D102 = C273 as (Element of C272) by L1018 , TREES_1:20;
L1019: (ex B216 being (Element of C272) st (D101 = B216 & ( len B216 ) = ( R18 + 1 ))) by L1015;
L1020: ( R18 + ( 0 ) ) <= ( R18 + 1 ) by XREAL_1:6;
L1021: ( len D102 ) = R18 by L1020 , L1019 , L1017 , FINSEQ_1:17;
L1022: ( succ D102 ) in { ( succ B217 ) where B217 is (Element of C272) : ( len B217 ) = R18 } by L1021;
L1023: ( Seg ( R18 + 1 ) ) = ( dom D101 ) by L1019 , FINSEQ_1:def 3;
L1024: D101 = ( D101 | ( Seg ( R18 + 1 ) ) ) by L1023 , RELAT_1:69;
L1025: (ex R23 being (Element of ( NAT )) st D101 = ( D102 ^ <* R23 *> )) by L1024 , L1019 , L1017 , L694;
L1026: D101 in ( succ D102 ) by L1025;
thus L1027: thesis by L1026 , L1022 , TARSKI:def 4;
end;

thus L1028: ( union { ( succ B218 ) where B218 is (Element of C272) : ( len B218 ) = R18 } ) c= ( C272 -level ( R18 + 1 ) )
proof
set D103 = { ( succ B219 ) where B219 is (Element of C272) : ( len B219 ) = R18 };
let R24 being set;
assume L1029: R24 in ( union D103 );
consider C274 being set such that L1030: R24 in C274 and L1031: C274 in D103 by L1029 , TARSKI:def 4;
consider C275 being (Element of C272) such that L1032: C274 = ( succ C275 ) and L1033: ( len C275 ) = R18 by L1031;
reconsider D104 = R24 as (Element of C272) by L1030 , L1032;
consider R22 being (Element of ( NAT )) such that L1034: D104 = ( C275 ^ <* R22 *> ) and L1035: ( C275 ^ <* R22 *> ) in C272 by L1030 , L1032;
L1036: ( len <* R22 *> ) = 1 by FINSEQ_1:40;
L1037: ( len D104 ) = ( R18 + 1 ) by L1036 , L1033 , L1034 , FINSEQ_1:22;
thus L1038: thesis by L1037;
end;

end;
theorem
L1029: (for B220 being  finite-branching Tree holds (for B221 being (Element of ( NAT )) holds ( B220 -level B221 ) is  finite))
proof
let C276 being  finite-branching Tree;
defpred S8[ (Element of ( NAT )) ] means ( C276 -level $1 ) is  finite;
L1030: (for R18 being (Element of ( NAT )) holds (S8[ R18 ] implies S8[ ( R18 + 1 ) ]))
proof
let R18 being (Element of ( NAT ));
assume that
L1031: ( C276 -level R18 ) is  finite;
set D105 = { ( succ B222 ) where B222 is (Element of C276) : ( len B222 ) = R18 };
L1032: D105 is  finite
proof
defpred S9[ set , set ] means (ex B223 being (Element of C276) st ($1 = B223 & $2 = ( succ B223 )));
L1033: (for R24 being set holds (R24 in ( C276 -level R18 ) implies (ex B224 being set st S9[ R24 , B224 ])))
proof
let R24 being set;
assume L1034: R24 in ( C276 -level R18 );
consider C277 being (Element of C276) such that L1035: C277 = R24 by L1034;
consider R25 being set such that L1036: R25 = ( succ C277 );
take R25;
take C277;
thus L1037: thesis by L1035 , L1036;
end;
consider C278 being Function such that L1038: (( dom C278 ) = ( C276 -level R18 ) & (for R24 being set holds (R24 in ( C276 -level R18 ) implies S9[ R24 , ( C278 . R24 ) ]))) from CLASSES1:sch 1(L1033);
L1039: D105 c= ( rng C278 )
proof
let R24 being set;
assume L1040: R24 in D105;
consider C279 being (Element of C276) such that L1041: R24 = ( succ C279 ) and L1042: ( len C279 ) = R18 by L1040;
L1043: C279 in ( C276 -level R18 ) by L1042;
L1044: (ex B225 being (Element of C276) st (C279 = B225 & ( C278 . C279 ) = ( succ B225 ))) by L1043 , L1038;
thus L1045: thesis by L1044 , L1038 , L1041 , L1043 , FUNCT_1:def 3;
end;
L1046: ( card ( rng C278 ) ) c= ( card ( dom C278 ) ) by CARD_1:12;
L1047: ( rng C278 ) is  finite by L1046 , L1031 , L1038;
thus L1048: thesis by L1047 , L1039;
end;
L1049: (for B226 being set holds (B226 in D105 implies B226 is  finite))
proof
let C280 being set;
assume L1050: C280 in D105;
L1051: (ex B227 being (Element of C276) st (C280 = ( succ B227 ) & ( len B227 ) = R18)) by L1050;
thus L1052: thesis by L1051;
end;
L1053: ( C276 -level ( R18 + 1 ) ) = ( union { ( succ B228 ) where B228 is (Element of C276) : ( len B228 ) = R18 } ) by L1013;
thus L1054: thesis by L1053 , L1032 , L1049 , FINSET_1:7;
end;
L1055: S8[ ( 0 ) ] by L998;
thus L1056: (for R18 being (Element of ( NAT )) holds S8[ R18 ]) from NAT_1:sch 1(L1055 , L1030);
end;
theorem
L1057: (for B229 being  finite-branching Tree holds (B229 is  finite iff (ex B230 being (Element of ( NAT )) st ( B229 -level B230 ) = ( {} ))))
proof
let C281 being  finite-branching Tree;
deffunc H5((Element of ( NAT ))) = ( C281 -level $1 );
L1058:
now
assume L1059: C281 is  finite;
L1060:
now
assume L1061: (not (ex B231 being (Element of ( NAT )) st ( C281 -level B231 ) = ( {} )));
L1062: (for R18 being (Element of ( NAT )) holds (ex B232 being  finite (Chain of C281) st ( card B232 ) = R18))
proof
let R18 being (Element of ( NAT ));
L1063: ( C281 -level R18 ) <> ( {} ) by L1061;
consider C282 being set such that L1064: C282 in ( C281 -level R18 ) by L1063 , XBOOLE_0:def 1;
consider C283 being (Element of C281) such that L1065: C282 = C283 and L1066: ( len C283 ) = R18 by L1064;
L1067: ( ProperPrefixes C283 ) is  finite  finite  finite  finite (Chain of C281) by L995;
consider C284 being  finite (Chain of C281) such that L1068: C284 = ( ProperPrefixes C283 ) by L1067;
L1069: ( card C284 ) = R18 by L1066 , L1068 , TREES_1:35;
thus L1070: thesis by L1069;
end;
L1071: (for B233 being (Element of C281) holds ( succ B233 ) is  finite);
L1072: (ex B234 being (Chain of C281) st (not B234 is  finite)) by L1071 , L1062 , TREES_2:29;
thus L1073: contradiction by L1072 , L1059;
end;
thus L1074: (ex B235 being (Element of ( NAT )) st ( C281 -level B235 ) = ( {} )) by L1060;
end;
thus L1075: (C281 is  finite implies (ex B236 being (Element of ( NAT )) st ( C281 -level B236 ) = ( {} ))) by L1058;
given R18 being (Element of ( NAT )) such that
L1076: ( C281 -level R18 ) = ( {} );

set D106 = { H5(B237) where B237 is (Element of ( NAT )) : B237 <= R18 };
L1077: C281 c= ( union D106 )
proof
let R24 being set;
assume L1078: R24 in C281;
reconsider D107 = R24 as (Element of C281) by L1078;
consider R23 being (Element of ( NAT )) such that L1079: R23 = ( len D107 );
L1080: D107 in H5(R23) by L1079;
L1081: ( len D107 ) < R18
proof
consider C285 being FinSequence such that L1082: C285 = ( D107 | ( Seg R18 ) ) and L1083: C285 is_a_prefix_of D107 by L689;
assume L1084: R18 <= ( len D107 );
L1085: ( len C285 ) = R18 by L1084 , L1082 , FINSEQ_1:17;
reconsider D108 = C285 as (Element of C281) by L1083 , TREES_1:20;
L1086: D108 in ( C281 -level R18 ) by L1085;
thus L1087: contradiction by L1086 , L1076;
end;
L1088: H5(R23) in D106 by L1081 , L1079;
thus L1089: thesis by L1088 , L1080 , TARSKI:def 4;
end;
L1090: D106 is  finite
proof
defpred S10[ set , set ] means (ex R21 being (Element of ( NAT )) st (ex R23 being (Element of ( NAT )) st (R23 = ( R21 + 1 ) & $1 = R23 & H5(R21) = $2)));
L1091: (for B238 being Nat holds (B238 in ( Seg ( R18 + 1 ) ) implies (ex R24 being set st S10[ B238 , R24 ])))
proof
let C286 being Nat;
assume L1092: C286 in ( Seg ( R18 + 1 ) );
L1093: ( 0 ) <> C286 by L1092 , FINSEQ_1:1;
consider C287 being Nat such that L1094: C286 = ( C287 + 1 ) by L1093 , NAT_1:6;
reconsider D109 = C287 as (Element of ( NAT )) by ORDINAL1:def 12;
consider R24 being set such that L1095: R24 = H5(D109);
take R24;
take D109;
take ( D109 + 1 );
thus L1096: thesis by L1094 , L1095;
end;
consider C288 being FinSequence such that L1097: (( dom C288 ) = ( Seg ( R18 + 1 ) ) & (for B239 being Nat holds (B239 in ( Seg ( R18 + 1 ) ) implies S10[ B239 , ( C288 . B239 ) ]))) from FINSEQ_1:sch 1(L1091);
L1098: (for R22 being (Element of ( NAT )) holds (( R22 + 1 ) in ( Seg ( R18 + 1 ) ) implies ( C288 . ( R22 + 1 ) ) = H5(R22)))
proof
let R22 being (Element of ( NAT ));
assume L1099: ( R22 + 1 ) in ( Seg ( R18 + 1 ) );
L1100: (ex R21 being (Element of ( NAT )) st (ex R23 being (Element of ( NAT )) st (R23 = ( R21 + 1 ) & ( R22 + 1 ) = R23 & H5(R21) = ( C288 . ( R22 + 1 ) )))) by L1099 , L1097;
thus L1101: thesis by L1100;
end;
L1102: D106 c= ( rng C288 )
proof
let R25 being set;
assume L1103: R25 in D106;
consider R23 being (Element of ( NAT )) such that L1104: R25 = H5(R23) and L1105: R23 <= R18 by L1103;
L1106: ( 0 ) <= R23 by NAT_1:2;
L1107: ( ( 0 ) + 1 ) <= ( R23 + 1 ) by L1106 , XREAL_1:6;
L1108: ( R23 + 1 ) <= ( R18 + 1 ) by L1105 , XREAL_1:6;
L1109: ( R23 + 1 ) in ( Seg ( R18 + 1 ) ) by L1108 , L1107 , FINSEQ_1:1;
L1110: ( C288 . ( R23 + 1 ) ) = H5(R23) by L1109 , L1098;
thus L1111: thesis by L1110 , L1097 , L1104 , L1109 , FUNCT_1:def 3;
end;
thus L1112: thesis by L1102;
end;
L1113: (for B240 being set holds (B240 in D106 implies B240 is  finite))
proof
let C289 being set;
assume L1114: C289 in D106;
L1115: (ex R23 being (Element of ( NAT )) st (C289 = H5(R23) & R23 <= R18)) by L1114;
thus L1116: thesis by L1115 , L1029;
end;
L1117: ( union D106 ) is  finite by L1113 , L1090 , FINSET_1:7;
thus L1118: thesis by L1117 , L1077;
end;
theorem
L1119: (for B241 being  finite-branching Tree holds ((not B241 is  finite) implies (ex B242 being (Chain of B241) st (not B242 is  finite))))
proof
let C290 being  finite-branching Tree;
assume that
L1120: (not C290 is  finite);
L1121: (for R18 being (Element of ( NAT )) holds (ex B243 being  finite (Chain of C290) st ( card B243 ) = R18))
proof
let R18 being (Element of ( NAT ));
L1122: ( C290 -level R18 ) <> ( {} ) by L1120 , L1057;
consider C291 being set such that L1123: C291 in ( C290 -level R18 ) by L1122 , XBOOLE_0:def 1;
L1124: (ex B244 being (Element of C290) st (C291 = B244 & ( len B244 ) = R18)) by L1123;
reconsider D110 = C291 as (Element of C290) by L1123;
L1125: ( ProperPrefixes D110 ) is  finite  finite  finite  finite (Chain of C290) by L995;
consider C292 being  finite (Chain of C290) such that L1126: C292 = ( ProperPrefixes D110 ) by L1125;
L1127: ( card C292 ) = R18 by L1124 , L1126 , TREES_1:35;
thus L1128: thesis by L1127;
end;
L1129: (for B245 being (Element of C290) holds ( succ B245 ) is  finite);
thus L1130: thesis by L1129 , L1121 , TREES_2:29;
end;
theorem
L1131: (for B246 being  finite-branching Tree holds ((not B246 is  finite) implies (ex B247 being (Branch of B246) st (not B247 is  finite))))
proof
let C293 being  finite-branching Tree;
assume L1132: (not C293 is  finite);
consider C294 being (Chain of C293) such that L1133: (not C294 is  finite) by L1132 , L1119;
consider C295 being (Branch of C293) such that L1134: C294 c= C295 by TREES_2:28;
L1135: (not C295 is  finite) by L1133 , L1134;
thus L1136: thesis by L1135;
end;
theorem
L1137: (for B248 being Tree holds (for B249 being (Chain of B248) holds (for B250 being (Element of B248) holds ((B250 in B249 & (not B249 is  finite)) implies (ex B251 being (Element of B248) st (B251 in B249 & B250 is_a_proper_prefix_of B251))))))
proof
let C296 being Tree;
let C297 being (Chain of C296);
let C298 being (Element of C296);
assume that
L1138: C298 in C297
and
L1139: (not C297 is  finite);
L1140:
now
assume L1141: (not (ex B252 being (Element of C296) st (B252 in C297 & C298 is_a_proper_prefix_of B252)));
L1142: (for B253 being (Element of C296) holds (B253 in C297 implies B253 is_a_prefix_of C298))
proof
let C299 being (Element of C296);
assume that
L1143: C299 in C297;
L1144:
now
assume L1145: (not C299 is_a_prefix_of C298);
L1146: C298 , C299 are_c=-comparable  by L1138 , L1143 , TREES_2:def 3;
L1147: C298 is_a_prefix_of C299 by L1146 , L1145 , XBOOLE_0:def 9;
L1148: C298 is_a_proper_prefix_of C299 by L1147 , L1145 , XBOOLE_0:def 8;
thus L1149: contradiction by L1148 , L1141 , L1143;
end;
thus L1150: thesis by L1144;
end;
L1151: C297 c= ( ( ProperPrefixes C298 ) \/ { C298 } )
proof
let C300 being set;
assume L1152: C300 in C297;
reconsider D111 = C300 as (Element of C296) by L1152;
L1153: D111 is_a_prefix_of C298 by L1142 , L1152;
L1154: D111 in ( ( ProperPrefixes C298 ) \/ { C298 } )
proof
per cases  by L1153 , XBOOLE_0:def 8;
suppose L1155: D111 is_a_proper_prefix_of C298;

L1156: D111 in ( ProperPrefixes C298 ) by L1155 , TREES_1:12;
thus L1157: thesis by L1156 , XBOOLE_0:def 3;
end;
suppose L1158: D111 = C298;

L1159: D111 in { C298 } by L1158 , TARSKI:def 1;
thus L1160: thesis by L1159 , XBOOLE_0:def 3;
end;
end;
thus L1162: thesis by L1154;
end;
thus L1163: contradiction by L1151 , L1139;
end;
thus L1164: thesis by L1140;
end;
theorem
L1165: (for B254 being Tree holds (for B255 being (Branch of B254) holds (for B256 being (Element of B254) holds ((B256 in B255 & (not B255 is  finite)) implies (ex B257 being (Element of B254) st (B257 in B255 & B257 in ( succ B256 )))))))
proof
let C301 being Tree;
let C302 being (Branch of C301);
let C303 being (Element of C301);
assume L1166: (C303 in C302 & (not C302 is  finite));
consider C304 being (Element of C301) such that L1167: C304 in C302 and L1168: C303 is_a_proper_prefix_of C304 by L1166 , L1137;
L1169: C303 is_a_prefix_of C304 by L1168 , XBOOLE_0:def 8;
consider C305 being FinSequence such that L1170: C304 = ( C303 ^ C305 ) by L1169 , TREES_1:1;
reconsider D112 = C305 as (FinSequence of ( NAT )) by L1170 , FINSEQ_1:36;
L1171: ( D112 | ( Seg 1 ) ) is (FinSequence of ( NAT )) by FINSEQ_1:18;
consider C306 being (FinSequence of ( NAT )) such that L1172: C306 = ( D112 | ( Seg 1 ) ) by L1171;
L1173: 1 <= ( len D112 )
proof
L1174: ( len C303 ) < ( len C304 ) by L1168 , TREES_1:6;
consider C307 being Nat such that L1175: ( ( len C303 ) + C307 ) = ( len C304 ) by L1174 , NAT_1:10;
L1176: C307 <> ( 0 ) by L1168 , L1175 , TREES_1:6;
L1177: ( 0 ) < C307 by L1176 , NAT_1:3;
L1178: ( ( 0 ) + 1 ) <= C307 by L1177 , NAT_1:13;
L1179: ( len C304 ) = ( ( len C303 ) + ( len D112 ) ) by L1170 , FINSEQ_1:22;
thus L1180: thesis by L1179 , L1175 , L1178;
end;
consider R18 being (Element of ( NAT )) such that L1181: C306 = <* R18 *> by L1173 , L1172 , L722;
L1182: C306 is_a_prefix_of D112 by L1172 , TREES_1:def 1;
L1183: ( C303 ^ C306 ) is_a_prefix_of C304 by L1182 , L1170 , FINSEQ_6:13;
L1184: ( C303 ^ <* R18 *> ) in C301 by L1170 , L1181 , L1182 , FINSEQ_6:13 , TREES_1:20;
consider C308 being (Element of C301) such that L1185: C308 = ( C303 ^ <* R18 *> ) by L1184;
L1186: C308 in ( succ C303 ) by L1185;
thus L1187: thesis by L1186 , L1167 , L1181 , L1183 , L1185 , TREES_2:25;
end;
theorem
L1188: (for B258 being (Function of ( NAT ) , ( NAT )) holds ((for R18 being (Element of ( NAT )) holds (( B258 . ( R18 + 1 ) ) qua (Element of ( NAT ))) <= (( B258 . R18 ) qua (Element of ( NAT )))) implies (ex R23 being (Element of ( NAT )) st (for R18 being (Element of ( NAT )) holds (R23 <= R18 implies ( B258 . R18 ) = ( B258 . R23 ))))))
proof
let C309 being (Function of ( NAT ) , ( NAT ));
assume that
L1189: (for R18 being (Element of ( NAT )) holds (( C309 . ( R18 + 1 ) ) qua (Element of ( NAT ))) <= (( C309 . R18 ) qua (Element of ( NAT ))));
L1190: (for R23 being (Element of ( NAT )) holds (for R22 being (Element of ( NAT )) holds (R23 <= R22 implies (( C309 . R22 ) qua (Element of ( NAT ))) <= (( C309 . R23 ) qua (Element of ( NAT ))))))
proof
defpred S11[ (Element of ( NAT )) ] means (for R23 being (Element of ( NAT )) holds (R23 <= $1 implies (( C309 . $1 ) qua (Element of ( NAT ))) <= (( C309 . R23 ) qua (Element of ( NAT )))));
L1191: (for R22 being (Element of ( NAT )) holds (S11[ R22 ] implies S11[ ( R22 + 1 ) ]))
proof
let R22 being (Element of ( NAT ));
assume that
L1192: S11[ R22 ];
L1193:
now
let R23 being (Element of ( NAT ));
assume L1194: R23 <= ( R22 + 1 );
per cases  by L1194 , NAT_1:8;
suppose L1195: R23 <= R22;

reconsider D113 = ( C309 . R22 ) , D114 = ( C309 . R23 ) , D115 = ( C309 . ( R22 + 1 ) ) as (Element of ( NAT ));
L1196: D115 <= D113 by L1189;
L1197: D113 <= D114 by L1192 , L1195;
thus L1198: (( C309 . ( R22 + 1 ) ) qua (Element of ( NAT ))) <= (( C309 . R23 ) qua (Element of ( NAT ))) by L1197 , L1196 , XXREAL_0:2;
end;
suppose L1199: R23 = ( R22 + 1 );

thus L1200: (( C309 . ( R22 + 1 ) ) qua (Element of ( NAT ))) <= (( C309 . R23 ) qua (Element of ( NAT ))) by L1199;
end;
end;
thus L1202: thesis by L1193;
end;
L1203: S11[ ( 0 ) ]
proof
let R23 being (Element of ( NAT ));
assume that
L1204: R23 <= ( 0 );
L1205: ( 0 ) <= R23 by NAT_1:2;
thus L1206: thesis by L1205 , L1204 , XXREAL_0:1;
end;
L1207: (for R22 being (Element of ( NAT )) holds S11[ R22 ]) from NAT_1:sch 1(L1203 , L1191);
let R23 being (Element of ( NAT ));
let R22 being (Element of ( NAT ));
assume L1208: R23 <= R22;
thus L1209: thesis by L1208 , L1207;
end;
defpred S12[ set ] means $1 in ( rng C309 );
L1210: (ex B259 being Nat st S12[ B259 ])
proof
consider R25 being set such that L1211: R25 = ( C309 . ( 0 ) );
reconsider D116 = R25 as (Element of ( NAT )) by L1211;
take D116;
L1212: ( dom C309 ) = ( NAT ) by FUNCT_2:def 1;
thus L1213: thesis by L1212 , L1211 , FUNCT_1:def 3;
end;
L1214: (ex B260 being Nat st (S12[ B260 ] & (for B261 being Nat holds (S12[ B261 ] implies B260 <= B261)))) from NAT_1:sch 5(L1210);
consider C310 being Nat such that L1215: C310 in ( rng C309 ) and L1216: (for B262 being Nat holds (B262 in ( rng C309 ) implies C310 <= B262)) by L1214;
consider R24 being set such that L1217: R24 in ( dom C309 ) and L1218: C310 = ( C309 . R24 ) by L1215 , FUNCT_1:def 3;
reconsider D117 = R24 as (Element of ( NAT )) by L1217;
L1219: ( dom C309 ) = ( NAT ) by FUNCT_2:def 1;
L1220: (for R22 being (Element of ( NAT )) holds (D117 <= R22 implies ( C309 . R22 ) = ( C309 . D117 )))
proof
let R22 being (Element of ( NAT ));
assume that
L1221: D117 <= R22;
L1222:
now
reconsider D118 = ( C309 . R22 ) , D119 = ( C309 . D117 ) as (Element of ( NAT ));
assume L1223: ( C309 . R22 ) <> ( C309 . D117 );
L1224: D118 <= D119 by L1190 , L1221;
L1225: D118 < D119 by L1224 , L1223 , XXREAL_0:1;
L1226: ( C309 . R22 ) in ( rng C309 ) by L1219 , FUNCT_1:def 3;
thus L1227: contradiction by L1226 , L1216 , L1218 , L1225;
end;
thus L1228: thesis by L1222;
end;
thus L1229: thesis by L1220;
end;
scheme FinDecTree { F6() -> non  empty set , F7() ->  finite-branching (DecoratedTree of F6()) , F8((Element of F6())) -> (Element of ( NAT )) } : F7() is  finite
provided
L1230: (for B263 , B264 being (Element of ( dom F7() )) holds (for B265 being (Element of F6()) holds ((B264 in ( succ B263 ) & B265 = ( F7() . B264 )) implies F8(B265) < F8(( F7() . B263 )))))
proof
L1231:
now
assume L1232: (not F7() is  finite);
L1233: (not ( dom F7() ) is  finite) by L1232 , FINSET_1:10;
consider C311 being (Branch of ( dom F7() )) such that L1234: (not C311 is  finite) by L1233 , L1131;
defpred S13[ set , set ] means (ex B266 , B267 being (Element of ( dom F7() )) st (B267 in ( succ B266 ) & B266 in C311 & B267 in C311 & $1 = ( F7() . B266 ) & $2 = ( F7() . B267 )));
defpred S14[ set ] means (ex B268 being (Element of ( dom F7() )) st (B268 in C311 & $1 = ( F7() . B268 )));
L1235: (for R24 being set holds ((R24 in F6() & S14[ R24 ]) implies (ex R25 being set st (R25 in F6() & S13[ R24 , R25 ] & S14[ R25 ]))))
proof
let R24 being set;
assume that
L1236: R24 in F6()
and
L1237: S14[ R24 ];
consider C312 being (Element of ( dom F7() )) such that L1238: C312 in C311 and L1239: R24 = ( F7() . C312 ) by L1237;
consider C313 being (Element of ( dom F7() )) such that L1240: (C313 in C311 & C313 in ( succ C312 )) by L1234 , L1238 , L1165;
L1241: (ex R25 being set st R25 = ( F7() . C313 ));
thus L1242: thesis by L1241 , L1238 , L1239 , L1240;
end;
L1243: ( {} ) in C311 by TREES_2:26;
L1244: S14[ ( F7() . ( {} ) ) ] by L1243;
L1245: (( F7() . ( {} ) ) in F6() & S14[ ( F7() . ( {} ) ) ]) by L1244;
L1246: (ex B269 being Function st (( dom B269 ) = ( NAT ) & ( rng B269 ) c= F6() & ( B269 . ( 0 ) ) = ( F7() . ( {} ) ) & (for R22 being (Element of ( NAT )) holds (S13[ ( B269 . R22 ) , ( B269 . ( R22 + 1 ) ) ] & S14[ ( B269 . R22 ) ])))) from TREES_2:sch 5(L1245 , L1235);
consider C314 being Function such that L1247: ( dom C314 ) = ( NAT ) and L1248: ( rng C314 ) c= F6() and L1249: ( C314 . ( 0 ) ) = ( F7() . ( {} ) ) and L1250: (for R22 being (Element of ( NAT )) holds ((ex B270 , B271 being (Element of ( dom F7() )) st (B271 in ( succ B270 ) & B270 in C311 & B271 in C311 & ( C314 . R22 ) = ( F7() . B270 ) & ( C314 . ( R22 + 1 ) ) = ( F7() . B271 ))) & (ex B272 being (Element of ( dom F7() )) st (B272 in C311 & ( C314 . R22 ) = ( F7() . B272 ))))) by L1246;
defpred S15[ set , set ] means (ex B273 being (Element of F6()) st (B273 = ( C314 . $1 ) & $2 = F8(B273)));
L1251: (for R24 being set holds (R24 in ( NAT ) implies (ex R25 being set st (R25 in ( NAT ) & S15[ R24 , R25 ]))))
proof
let R24 being set;
assume L1252: R24 in ( NAT );
reconsider D120 = R24 as (Element of ( NAT )) by L1252;
consider C315 being (Element of ( dom F7() )) such that L1253: C315 in C311 and L1254: ( C314 . D120 ) = ( F7() . C315 ) by L1250;
L1255: (ex R25 being set st R25 = F8(( F7() . C315 )));
thus L1256: thesis by L1255 , L1254;
end;
L1257: (ex B274 being (Function of ( NAT ) , ( NAT )) st (for R24 being set holds (R24 in ( NAT ) implies S15[ R24 , ( B274 . R24 ) ]))) from FUNCT_2:sch 1(L1251);
consider C316 being (Function of ( NAT ) , ( NAT )) such that L1258: (for R24 being set holds (R24 in ( NAT ) implies (ex B275 being (Element of F6()) st (B275 = ( C314 . R24 ) & ( C316 . R24 ) = F8(B275))))) by L1257;
L1259: (for R22 being (Element of ( NAT )) holds (ex B276 , B277 being (Element of ( dom F7() )) st (B277 in ( succ B276 ) & B276 in C311 & B277 in C311 & ( C316 . R22 ) = F8(( F7() . B276 )) & ( C316 . ( R22 + 1 ) ) = F8(( F7() . B277 )))))
proof
let R22 being (Element of ( NAT ));
L1260: (ex B278 , B279 being (Element of ( dom F7() )) st (B279 in ( succ B278 ) & B278 in C311 & B279 in C311 & ( C314 . R22 ) = ( F7() . B278 ) & ( C314 . ( R22 + 1 ) ) = ( F7() . B279 ))) by L1250;
L1261: ((ex B280 being (Element of F6()) st (B280 = ( C314 . R22 ) & ( C316 . R22 ) = F8(B280))) & (ex B281 being (Element of F6()) st (B281 = ( C314 . ( R22 + 1 ) ) & ( C316 . ( R22 + 1 ) ) = F8(B281)))) by L1258;
thus L1262: thesis by L1261 , L1260;
end;
L1263: (for R18 being (Element of ( NAT )) holds (ex B282 , B283 being (Element of ( dom F7() )) st (B283 in ( succ B282 ) & ( C316 . R18 ) = F8(( F7() . B282 )) & ( C316 . ( R18 + 1 ) ) = F8(( F7() . B283 )) & (( C316 . ( R18 + 1 ) ) qua (Element of ( NAT ))) < (( C316 . R18 ) qua (Element of ( NAT ))))))
proof
let R18 being (Element of ( NAT ));
L1264: (ex B284 , B285 being (Element of ( dom F7() )) st (B285 in ( succ B284 ) & B284 in C311 & B285 in C311 & ( C316 . R18 ) = F8(( F7() . B284 )) & ( C316 . ( R18 + 1 ) ) = F8(( F7() . B285 )))) by L1259;
thus L1265: thesis by L1264 , L1230;
end;
L1266: (for R18 being (Element of ( NAT )) holds (( C316 . ( R18 + 1 ) ) qua (Element of ( NAT ))) <= (( C316 . R18 ) qua (Element of ( NAT ))))
proof
let R18 being (Element of ( NAT ));
L1267: (ex B286 , B287 being (Element of ( dom F7() )) st (B287 in ( succ B286 ) & ( C316 . R18 ) = F8(( F7() . B286 )) & ( C316 . ( R18 + 1 ) ) = F8(( F7() . B287 )) & (( C316 . ( R18 + 1 ) ) qua (Element of ( NAT ))) < (( C316 . R18 ) qua (Element of ( NAT ))))) by L1263;
thus L1268: thesis by L1267;
end;
consider R23 being (Element of ( NAT )) such that L1269: (for R18 being (Element of ( NAT )) holds (R23 <= R18 implies ( C316 . R18 ) = ( C316 . R23 ))) by L1266 , L1188;
L1270: ( R23 + ( 0 ) ) <= ( R23 + 1 ) by XREAL_1:6;
L1271: (ex B288 , B289 being (Element of ( dom F7() )) st (B289 in ( succ B288 ) & ( C316 . R23 ) = F8(( F7() . B288 )) & ( C316 . ( R23 + 1 ) ) = F8(( F7() . B289 )) & (( C316 . ( R23 + 1 ) ) qua (Element of ( NAT ))) < (( C316 . R23 ) qua (Element of ( NAT ))))) by L1263;
thus L1272: contradiction by L1271 , L1269 , L1270;
end;
thus L1273: thesis by L1231;
end;
