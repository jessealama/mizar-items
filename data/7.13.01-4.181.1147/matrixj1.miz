:: Block Diagonal Matrices
::  by Karol P\c{a}k
::
:: Received May 13, 2008
:: Copyright (c) 2008-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, NAT_1, VECTSP_1, SUBSET_1, XBOOLE_0, MATRIX_1, FINSEQ_1,
      ALGSTR_0, RELAT_1, ARYTM_3, TARSKI, STRUCT_0, ZFMISC_1, ORDINAL4,
      XXREAL_0, FUNCT_1, PARTFUN1, FINSEQ_3, CARD_1, ARYTM_1, FINSEQ_2, CARD_3,
      GROUP_1, RFINSEQ, TREES_1, INCSP_1, MATRIX_2, MATRIX_3, SUPINF_2,
      LAPLACE, MATRIX11, MESFUNC1, RVSUM_1, MATHMORP, VALUED_1, FVSUM_1,
      MATRIXJ1;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, NUMBERS, CARD_1, XCMPLX_0,
      ALGSTR_0, XXREAL_0, ORDINAL1, NAT_1, RELAT_1, FUNCT_1, PARTFUN1,
      FINSEQ_1, STRUCT_0, RLVECT_1, GROUP_1, VECTSP_1, FINSEQ_2, MATRIX_1,
      MATRIX_2, FVSUM_1, NAT_D, GROUP_4, MATRIX_3, MATRIX11, FINSEQOP,
      MATRIX13, LAPLACE, RFINSEQ, WSIERP_1;
 constructors GROUP_4, MATRIX11, MATRIX13, LAPLACE, RFINSEQ, WSIERP_1, SEQ_1,
      REAL_1, BINARITH, RELSET_1, FVSUM_1;
 registrations XBOOLE_0, FINSET_1, STRUCT_0, VECTSP_1, ORDINAL1, XXREAL_0,
      NAT_1, FINSEQ_1, RELAT_1, FINSEQ_2, MATRIX13, XREAL_0, VALUED_0, CARD_1;
 requirements ARITHM, NUMERALS, REAL, BOOLE, SUBSET;
 definitions TARSKI, FINSEQ_1, MATRIX_1, LAPLACE, MATRIX13, FVSUM_1;
 theorems CARD_2, FINSEQ_1, FINSEQ_2, FINSEQ_3, FINSEQ_5, FINSEQ_6, FINSEQOP,
      FUNCT_1, FVSUM_1, GROUP_1, GROUP_4, GOBOARD1, LAPLACE, MATRIX_1,
      MATRIX_2, MATRIX_3, MATRIX_9, MATRIX11, MATRIX13, MATRIX15, MATRIXR2,
      NAT_1, ORDINAL1, PARTFUN1, POLYNOM3, PRGCOR_1, RELAT_1, RFINSEQ,
      RLVECT_1, RVSUM_1, TARSKI, VECTSP_1, XBOOLE_0, XBOOLE_1, XREAL_1,
      XXREAL_0, ZFMISC_1, MATRIX_4, FUNCT_2, FUNCOP_1, MATRIXR1, CARD_1, NAT_D;
 schemes FINSEQ_1, FINSEQ_2, NAT_1, MATRIX_1;

begin
L1: (for B1 being non  empty addLoopStr holds (for B2 , B3 being (FinSequence of B1) holds ( dom ( B2 + B3 ) ) = ( ( dom B2 ) /\ ( dom B3 ) )))
proof
let C1 being non  empty addLoopStr;
let C2 , C3 being (FinSequence of C1);
L2: ( rng C3 ) c= (the carrier of C1) by FINSEQ_1:def 4;
L3: ( rng C2 ) c= (the carrier of C1) by FINSEQ_1:def 4;
L4: [: ( rng C2 ) , ( rng C3 ) :] c= [: (the carrier of C1) , (the carrier of C1) :] by L3 , L2 , ZFMISC_1:96;
L5: [: ( rng C2 ) , ( rng C3 ) :] c= ( dom (the addF of C1) ) by L4 , FUNCT_2:def 1;
thus L6: thesis by L5 , FUNCOP_1:69;
end;
theorem
L7: (for B4 being non  empty addLoopStr holds (for B5 , B6 , B7 , B8 being (FinSequence of B4) holds (( len B5 ) = ( len B6 ) implies ( ( B5 + B6 ) ^ ( B7 + B8 ) ) = ( ( B5 ^ B7 ) + ( B6 ^ B8 ) ))))
proof
let C4 being non  empty addLoopStr;
let C5 , C6 , C7 , C8 being (FinSequence of C4);
assume that
L8: ( len C5 ) = ( len C6 );
L9: ( dom C5 ) = ( dom C6 ) by L8 , FINSEQ_3:29;
L10: ( dom C8 ) = ( Seg ( len C8 ) ) by FINSEQ_1:def 3;
L11: ( dom C7 ) = ( Seg ( len C7 ) ) by FINSEQ_1:def 3;
L12: ( dom ( C5 ^ C7 ) ) = ( Seg ( ( len C5 ) + ( len C7 ) ) ) by FINSEQ_1:def 7;
L13: ( dom ( C6 ^ C8 ) ) = ( Seg ( ( len C6 ) + ( len C8 ) ) ) by FINSEQ_1:def 7;
L14: ( dom ( C7 + C8 ) ) = ( ( dom C7 ) /\ ( dom C8 ) ) by L1;
L15: ( dom ( C5 + C6 ) ) = ( ( dom C5 ) /\ ( dom C6 ) ) by L1;
L16: ( len ( C5 + C6 ) ) = ( len C5 ) by L15 , L9 , FINSEQ_3:29;
L17: ( dom ( ( C5 ^ C7 ) + ( C6 ^ C8 ) ) ) = ( ( dom ( C5 ^ C7 ) ) /\ ( dom ( C6 ^ C8 ) ) ) by L1;
L18:
now
per cases ;
suppose L19: ( len C7 ) <= ( len C8 );

L20: ( Seg ( len C7 ) ) c= ( Seg ( len C8 ) ) by L19 , FINSEQ_1:5;
L21: ( dom ( C7 + C8 ) ) = ( dom C7 ) by L20 , L14 , L11 , L10 , XBOOLE_1:28;
L22: ( len ( C7 + C8 ) ) = ( len C7 ) by L21 , FINSEQ_3:29;
L23: ( ( len C5 ) + ( len C7 ) ) <= ( ( len C6 ) + ( len C8 ) ) by L8 , L19 , XREAL_1:7;
L24: ( dom ( C5 ^ C7 ) ) c= ( dom ( C6 ^ C8 ) ) by L23 , L12 , L13 , FINSEQ_1:5;
L25: ( dom ( ( C5 ^ C7 ) + ( C6 ^ C8 ) ) ) = ( dom ( C5 ^ C7 ) ) by L24 , L17 , XBOOLE_1:28;
thus L26: ( dom ( ( C5 + C6 ) ^ ( C7 + C8 ) ) ) = ( dom ( ( C5 ^ C7 ) + ( C6 ^ C8 ) ) ) by L25 , L16 , L12 , L22 , FINSEQ_1:def 7;
end;
suppose L27: ( len C7 ) > ( len C8 );

L28: ( Seg ( len C8 ) ) c= ( Seg ( len C7 ) ) by L27 , FINSEQ_1:5;
L29: ( dom ( C7 + C8 ) ) = ( dom C8 ) by L28 , L14 , L11 , L10 , XBOOLE_1:28;
L30: ( len ( C7 + C8 ) ) = ( len C8 ) by L29 , FINSEQ_3:29;
L31: ( ( len C5 ) + ( len C7 ) ) > ( ( len C6 ) + ( len C8 ) ) by L8 , L27 , XREAL_1:8;
L32: ( dom ( C6 ^ C8 ) ) c= ( dom ( C5 ^ C7 ) ) by L31 , L12 , L13 , FINSEQ_1:5;
L33: ( dom ( ( C5 ^ C7 ) + ( C6 ^ C8 ) ) ) = ( dom ( C6 ^ C8 ) ) by L32 , L17 , XBOOLE_1:28;
thus L34: ( dom ( ( C5 + C6 ) ^ ( C7 + C8 ) ) ) = ( dom ( ( C5 ^ C7 ) + ( C6 ^ C8 ) ) ) by L33 , L8 , L16 , L13 , L30 , FINSEQ_1:def 7;
end;
end;
L36:
now
let R1 being Nat;
assume that
L37: R1 in ( dom ( ( C5 + C6 ) ^ ( C7 + C8 ) ) );
L38:
now
per cases  by L37 , FINSEQ_1:25;
suppose L39: R1 in ( dom ( C5 + C6 ) );

L40: ( C6 . R1 ) = ( ( C6 ^ C8 ) . R1 ) by L39 , L15 , L9 , FINSEQ_1:def 7;
L41: ( C6 /. R1 ) = ( C6 . R1 ) by L15 , L9 , L39 , PARTFUN1:def 6;
L42: ( C5 . R1 ) = ( ( C5 ^ C7 ) . R1 ) by L15 , L9 , L39 , FINSEQ_1:def 7;
L43: ( C5 /. R1 ) = ( C5 . R1 ) by L15 , L9 , L39 , PARTFUN1:def 6;
thus L44: ( ( ( C5 + C6 ) ^ ( C7 + C8 ) ) . R1 ) = ( ( C5 + C6 ) . R1 ) by L39 , FINSEQ_1:def 7
.= ( ( C5 /. R1 ) + ( C6 /. R1 ) ) by L39 , L43 , L41 , FVSUM_1:17
.= ( ( ( C5 ^ C7 ) + ( C6 ^ C8 ) ) . R1 ) by L18 , L37 , L43 , L41 , L42 , L40 , FVSUM_1:17;
end;
suppose L45: (ex R4 being Nat st (R4 in ( dom ( C7 + C8 ) ) & R1 = ( ( len ( C5 + C6 ) ) + R4 )));

consider R4 being Nat such that L46: R4 in ( dom ( C7 + C8 ) ) and L47: R1 = ( ( len ( C5 + C6 ) ) + R4 ) by L45;
L48: R4 in ( dom C7 ) by L14 , L46 , XBOOLE_0:def 4;
L49: ( ( C5 ^ C7 ) . R1 ) = ( C7 . R4 ) by L48 , L16 , L47 , FINSEQ_1:def 7;
L50: ( C7 . R4 ) = ( C7 /. R4 ) by L48 , PARTFUN1:def 6;
L51: R4 in ( dom C8 ) by L14 , L46 , XBOOLE_0:def 4;
L52: ( ( C6 ^ C8 ) . R1 ) = ( C8 . R4 ) by L51 , L8 , L16 , L47 , FINSEQ_1:def 7;
L53: ( C8 . R4 ) = ( C8 /. R4 ) by L51 , PARTFUN1:def 6;
thus L54: ( ( ( C5 + C6 ) ^ ( C7 + C8 ) ) . R1 ) = ( ( C7 + C8 ) . R4 ) by L46 , L47 , FINSEQ_1:def 7
.= ( ( C7 /. R4 ) + ( C8 /. R4 ) ) by L46 , L50 , L53 , FVSUM_1:17
.= ( ( ( C5 ^ C7 ) + ( C6 ^ C8 ) ) . R1 ) by L18 , L37 , L50 , L53 , L49 , L52 , FVSUM_1:17;
end;
end;
thus L56: ( ( ( C5 + C6 ) ^ ( C7 + C8 ) ) . R1 ) = ( ( ( C5 ^ C7 ) + ( C6 ^ C8 ) ) . R1 ) by L38;
end;
thus L57: thesis by L36 , L18 , FINSEQ_1:13;
end;
theorem
L58: (for R1 being Nat holds (for R12 being non  empty set holds (for B9 , B10 being (FinSequence of R12) holds (R1 in ( dom B9 ) implies ( Del (( B9 ^ B10 ) , R1) ) = ( ( Del (B9 , R1) ) ^ B10 )))))
proof
let R1 being Nat;
let R12 being non  empty set;
let C9 , C10 being (FinSequence of R12);
assume that
L59: R1 in ( dom C9 );
set D1 = ( Del (C9 , R1) );
consider R3 being Nat such that L60: ( len C9 ) = ( R3 + 1 ) and L61: ( len D1 ) = R3 by L59 , FINSEQ_3:104;
set D2 = ( D1 ^ C10 );
set D3 = ( C9 ^ C10 );
set D4 = ( Del (D3 , R1) );
L62: ( Seg ( len D3 ) ) = ( dom D3 ) by FINSEQ_1:def 3;
L63: ( len D3 ) = ( ( len C9 ) + ( len C10 ) ) by FINSEQ_1:22;
L64: ( len C9 ) <= ( len D3 ) by L63 , NAT_1:12;
L65: ( Seg ( len C9 ) ) c= ( Seg ( len D3 ) ) by L64 , FINSEQ_1:5;
L66: ( len D3 ) = ( ( ( len C10 ) + R3 ) + 1 ) by L60 , L63;
L67: ( Seg ( len C9 ) ) = ( dom C9 ) by FINSEQ_1:def 3;
L68:
now
let R2 being Nat;
assume that
L69: 1 <= R2
and
L70: R2 <= ( R3 + ( len C10 ) );
L71:
now
per cases ;
suppose L72: R2 < R1;

L73: R1 <= ( len C9 ) by L59 , FINSEQ_3:25;
L74: R2 < ( len C9 ) by L73 , L72 , XXREAL_0:2;
L75: R2 in ( dom C9 ) by L74 , L69 , FINSEQ_3:25;
L76: R2 <= R3 by L60 , L74 , NAT_1:13;
L77: R2 in ( dom D1 ) by L76 , L61 , L69 , FINSEQ_3:25;
thus L78: ( D4 . R2 ) = ( D3 . R2 ) by L72 , FINSEQ_3:110
.= ( C9 . R2 ) by L75 , FINSEQ_1:def 7
.= ( D1 . R2 ) by L72 , FINSEQ_3:110
.= ( D2 . R2 ) by L77 , FINSEQ_1:def 7;
end;
suppose L79: R2 >= R1;

L80:
now
per cases ;
suppose L81: R2 <= R3;

L82: ( ( 0 ) + 1 ) <= ( R2 + 1 ) by XREAL_1:7;
L83: ( R2 + 1 ) <= ( len C9 ) by L60 , L81 , XREAL_1:7;
L84: ( R2 + 1 ) in ( dom C9 ) by L83 , L82 , FINSEQ_3:25;
L85: R2 in ( dom D1 ) by L61 , L69 , L81 , FINSEQ_3:25;
thus L86: ( D4 . R2 ) = ( D3 . ( R2 + 1 ) ) by L59 , L65 , L67 , L62 , L66 , L70 , L79 , FINSEQ_3:111
.= ( C9 . ( R2 + 1 ) ) by L84 , FINSEQ_1:def 7
.= ( D1 . R2 ) by L59 , L60 , L79 , L81 , FINSEQ_3:111
.= ( D2 . R2 ) by L85 , FINSEQ_1:def 7;
end;
suppose L87: R2 > R3;

L88: R2 >= ( len C9 ) by L87 , L60 , NAT_1:13;
L89: ( R2 + 1 ) > ( len C9 ) by L88 , NAT_1:13;
reconsider D5 = ( ( R2 + 1 ) - ( len C9 ) ) as (Element of ( NAT )) by L89 , NAT_1:21;
L90: ( R2 + 1 ) <= ( ( R3 + ( len C10 ) ) + 1 ) by L70 , XREAL_1:7;
L91: ( D5 + ( len C9 ) ) <= ( ( len C9 ) + ( len C10 ) ) by L90 , L60;
L92: D5 <= ( len C10 ) by L91 , XREAL_1:8;
L93: D5 <> ( 0 ) by L60 , L87;
L94: D5 >= 1 by L93 , NAT_1:14;
L95: D5 in ( dom C10 ) by L94 , L92 , FINSEQ_3:25;
thus L96: ( D4 . R2 ) = ( D3 . ( D5 + ( len C9 ) ) ) by L59 , L65 , L67 , L62 , L66 , L70 , L79 , FINSEQ_3:111
.= ( C10 . D5 ) by L95 , FINSEQ_1:def 7
.= ( D2 . ( R3 + D5 ) ) by L61 , L95 , FINSEQ_1:def 7
.= ( D2 . R2 ) by L60;
end;
end;
thus L98: ( D2 . R2 ) = ( D4 . R2 ) by L80;
end;
end;
thus L100: ( D2 . R2 ) = ( D4 . R2 ) by L71;
end;
L101: ( len D2 ) = ( ( len D1 ) + ( len C10 ) ) by FINSEQ_1:22;
L102: ( len D4 ) = ( R3 + ( len C10 ) ) by L59 , L65 , L67 , L62 , L66 , FINSEQ_3:109;
thus L103: thesis by L102 , L61 , L101 , L68 , FINSEQ_1:14;
end;
theorem
L104: (for R1 being Nat holds (for R12 being non  empty set holds (for B11 , B12 being (FinSequence of R12) holds (R1 in ( dom B12 ) implies ( Del (( B11 ^ B12 ) , ( R1 + ( len B11 ) )) ) = ( B11 ^ ( Del (B12 , R1) ) )))))
proof
let R1 being Nat;
let R12 being non  empty set;
let C11 , C12 being (FinSequence of R12);
assume that
L105: R1 in ( dom C12 );
set D6 = ( Del (C12 , R1) );
consider R3 being Nat such that L106: ( len C12 ) = ( R3 + 1 ) and L107: ( len D6 ) = R3 by L105 , FINSEQ_3:104;
set D7 = ( C11 ^ D6 );
set D8 = ( R1 + ( len C11 ) );
set D9 = ( C11 ^ C12 );
set D10 = ( Del (D9 , D8) );
L108: ( dom D9 ) = ( Seg ( len D9 ) ) by FINSEQ_1:def 3;
L109: ( len D9 ) = ( ( len C11 ) + ( len C12 ) ) by FINSEQ_1:22;
L110: ( len D9 ) = ( ( R3 + ( len C11 ) ) + 1 ) by L109 , L106;
L111: R1 in ( Seg ( len C12 ) ) by L105 , FINSEQ_1:def 3;
L112: R1 > ( 0 ) by L111 , FINSEQ_1:1;
L113:
now
let R2 being Nat;
assume that
L114: 1 <= R2
and
L115: R2 <= ( R3 + ( len C11 ) );
L116:
now
per cases ;
suppose L117: R2 <= ( len C11 );

L118: R2 in ( dom C11 ) by L117 , L114 , FINSEQ_3:25;
L119: ( ( 0 ) + ( len C11 ) ) < D8 by L112 , XREAL_1:8;
L120: R2 < D8 by L119 , L117 , XXREAL_0:2;
thus L121: ( D10 . R2 ) = ( D9 . R2 ) by L120 , FINSEQ_3:110
.= ( C11 . R2 ) by L118 , FINSEQ_1:def 7
.= ( D7 . R2 ) by L118 , FINSEQ_1:def 7;
end;
suppose L122: R2 > ( len C11 );

reconsider D11 = ( R2 - ( len C11 ) ) as (Element of ( NAT )) by L122 , NAT_1:21;
L123: 1 <= ( D11 + 1 ) by NAT_1:14;
L124: ( D11 + ( len C11 ) ) <= ( R3 + ( len C11 ) ) by L115;
L125: D11 <= R3 by L124 , XREAL_1:6;
L126: ( D11 + 1 ) <= ( len C12 ) by L125 , L106 , XREAL_1:7;
L127: ( D11 + 1 ) in ( dom C12 ) by L126 , L123 , FINSEQ_3:25;
L128: D11 <> ( 0 ) by L122;
L129: D11 >= 1 by L128 , NAT_1:14;
L130: D11 in ( dom D6 ) by L129 , L107 , L125 , FINSEQ_3:25;
L131: D11 <= ( len C12 ) by L106 , L125 , NAT_1:13;
L132: D11 in ( dom C12 ) by L131 , L129 , FINSEQ_3:25;
L133:
now
per cases ;
suppose L134: D11 < R1;

L135: ( D11 + ( len C11 ) ) < D8 by L134 , XREAL_1:8;
thus L136: ( D10 . R2 ) = ( D9 . ( D11 + ( len C11 ) ) ) by L135 , FINSEQ_3:110
.= ( C12 . D11 ) by L132 , FINSEQ_1:def 7
.= ( D6 . D11 ) by L134 , FINSEQ_3:110
.= ( D7 . ( D11 + ( len C11 ) ) ) by L130 , FINSEQ_1:def 7
.= ( D7 . R2 );
end;
suppose L137: D11 >= R1;

L138: ( D11 + ( len C11 ) ) >= D8 by L137 , XREAL_1:7;
thus L139: ( D10 . R2 ) = ( D9 . ( ( D11 + ( len C11 ) ) + 1 ) ) by L138 , L109 , L111 , L108 , L110 , L115 , FINSEQ_1:60 , FINSEQ_3:111
.= ( D9 . ( ( D11 + 1 ) + ( len C11 ) ) )
.= ( C12 . ( D11 + 1 ) ) by L127 , FINSEQ_1:def 7
.= ( D6 . D11 ) by L105 , L106 , L125 , L137 , FINSEQ_3:111
.= ( D7 . ( D11 + ( len C11 ) ) ) by L130 , FINSEQ_1:def 7
.= ( D7 . R2 );
end;
end;
thus L141: ( D7 . R2 ) = ( D10 . R2 ) by L133;
end;
end;
thus L143: ( D7 . R2 ) = ( D10 . R2 ) by L116;
end;
L144: ( len D7 ) = ( ( len C11 ) + ( len D6 ) ) by FINSEQ_1:22;
L145: ( len D10 ) = ( R3 + ( len C11 ) ) by L109 , L111 , L108 , L110 , FINSEQ_1:60 , FINSEQ_3:109;
thus L146: thesis by L145 , L107 , L144 , L113 , FINSEQ_1:14;
end;
theorem
L147: (for R1 being Nat holds (for R4 being Nat holds (for R12 being non  empty set holds (for R13 being (Element of R12) holds (R1 in ( Seg ( R4 + 1 ) ) implies ( Del (( ( R4 + 1 ) |-> R13 ) , R1) ) = ( R4 |-> R13 ))))))
proof
let R1 being Nat;
let R4 being Nat;
let R12 being non  empty set;
let R13 being (Element of R12);
set D12 = ( R4 + 1 );
set D13 = ( D12 |-> R13 );
set D14 = ( R4 |-> R13 );
set D15 = ( Del (D13 , R1) );
L148: ( len D13 ) = D12 by CARD_1:def 7;
L149: ( dom D13 ) = ( Seg ( len D13 ) ) by FINSEQ_1:def 3;
L150: ( len D14 ) = R4 by CARD_1:def 7;
assume L151: R1 in ( Seg ( R4 + 1 ) );
L152:
now
let R2 being Nat;
assume that
L153: 1 <= R2
and
L154: R2 <= R4;
L155: R2 <= D12 by L154 , NAT_1:13;
L156: R2 in ( Seg D12 ) by L155 , L153 , FINSEQ_1:1;
L157: R2 in ( Seg R4 ) by L153 , L154 , FINSEQ_1:1;
L158: ( R2 + 1 ) in ( Seg ( R4 + 1 ) ) by L157 , FINSEQ_1:60;
L159:
now
per cases ;
suppose L160: R2 < R1;

thus L161: ( D15 . R2 ) = ( D13 . R2 ) by L160 , FINSEQ_3:110
.= R13 by L156 , FINSEQ_2:57
.= ( D14 . R2 ) by L157 , FINSEQ_2:57;
end;
suppose L162: R2 >= R1;

thus L163: ( D15 . R2 ) = ( D13 . ( R2 + 1 ) ) by L162 , L151 , L148 , L149 , L154 , FINSEQ_3:111
.= R13 by L158 , FINSEQ_2:57
.= ( D14 . R2 ) by L157 , FINSEQ_2:57;
end;
end;
thus L165: ( D14 . R2 ) = ( D15 . R2 ) by L159;
end;
L166: ( len D15 ) = R4 by L151 , L148 , L149 , FINSEQ_3:109;
thus L167: thesis by L166 , L150 , L152 , FINSEQ_1:14;
end;
theorem
L168: (for R4 being Nat holds (for R8 being Field holds (for R9 being (Element of R8) holds ( Product ( R4 |-> R9 ) ) = ( ( power R8 ) . (R9 , R4) ))))
proof
let R4 being Nat;
let R8 being Field;
let R9 being (Element of R8);
defpred S1[ Nat ] means ( Product ( $1 |-> R9 ) ) = ( ( power R8 ) . (R9 , $1) );
L169: (for R5 being Nat holds (S1[ R5 ] implies S1[ ( R5 + 1 ) ]))
proof
let R5 being Nat;
assume that
L170: S1[ R5 ];
L171: R5 in ( NAT ) by ORDINAL1:def 12;
thus L172: ( Product ( ( R5 + 1 ) |-> R9 ) ) = ( ( Product ( R5 |-> R9 ) ) * ( Product ( 1 |-> R9 ) ) ) by L171 , FVSUM_1:83
.= ( ( Product ( R5 |-> R9 ) ) * ( Product <* R9 *> ) ) by FINSEQ_2:59
.= ( ( ( power R8 ) . (R9 , R5) ) * R9 ) by L170 , GROUP_4:9
.= ( ( power R8 ) . (R9 , ( R5 + 1 )) ) by L171 , GROUP_1:def 7;
end;
L173: ( ( 0 ) |-> R9 ) = ( <*> (the carrier of R8) );
L174: ( Product ( ( 0 ) |-> R9 ) ) = ( 1_ R8 ) by L173 , GROUP_4:8
.= ( ( power R8 ) . (R9 , ( 0 )) ) by GROUP_1:def 7;
L175: S1[ ( 0 ) ] by L174;
L176: (for R5 being Nat holds S1[ R5 ]) from NAT_1:sch 2(L175 , L169);
thus L177: thesis by L176;
end;
definition
let R24 being (FinSequence of ( NAT ));
let C13 being Nat;
assume that
L178: C13 in ( Seg ( Sum R24 ) );
func min (R24 , C13) -> (Element of ( NAT )) means 
:L179: (C13 <= ( Sum ( R24 | it ) ) & it in ( dom R24 ) & (for R2 being Nat holds (C13 <= ( Sum ( R24 | R2 ) ) implies it <= R2)));
existence
proof
defpred S2[ Nat ] means (C13 <= ( Sum ( R24 | $1 ) ) & $1 >= 1);
L180: ( R24 | ( len R24 ) ) = R24 by FINSEQ_1:58;
L181: C13 <= ( Sum R24 ) by L178 , FINSEQ_1:1;
L182: ( Sum R24 ) <> ( 0 ) by L178;
L183: ( len R24 ) >= 1 by L182 , FINSEQ_1:20 , RVSUM_1:72;
L184: (ex R5 being Nat st S2[ R5 ]) by L183 , L181 , L180;
consider R5 being Nat such that L185: S2[ R5 ] and L186: (for R4 being Nat holds (S2[ R4 ] implies R5 <= R4)) from NAT_1:sch 5(L184);
reconsider D16 = R5 as (Element of ( NAT )) by ORDINAL1:def 12;
take D16;
thus L187: C13 <= ( Sum ( R24 | D16 ) ) by L185;
L188: D16 <= ( len R24 ) by L183 , L181 , L180 , L186;
thus L189: D16 in ( dom R24 ) by L188 , L185 , FINSEQ_3:25;
let R2 being Nat;
assume that
L190: C13 <= ( Sum ( R24 | R2 ) );
per cases ;
suppose L191: R2 = ( 0 );

L192: ( R24 | R2 ) = ( <*> ( REAL ) ) by L191;
thus L193: thesis by L192 , L178 , L190 , FINSEQ_1:1 , RVSUM_1:72;
end;
suppose L194: R2 > ( 0 );

thus L195: thesis by L194 , L186 , L190 , NAT_1:14;
end;
end;
uniqueness
proof
let C14 , C15 being (Element of ( NAT ));
assume that
L197: C13 <= ( Sum ( R24 | C14 ) )
and
L198: C14 in ( dom R24 )
and
L199: (for R2 being Nat holds (C13 <= ( Sum ( R24 | R2 ) ) implies C14 <= R2))
and
L200: C13 <= ( Sum ( R24 | C15 ) )
and
L201: C15 in ( dom R24 )
and
L202: (for R2 being Nat holds (C13 <= ( Sum ( R24 | R2 ) ) implies C15 <= R2));
L203: C15 <= C14 by L197 , L202;
L204: C14 <= C15 by L199 , L200;
thus L205: thesis by L204 , L203 , XXREAL_0:1;
end;
end;
theorem
L207: (for R1 being Nat holds (for R24 being (FinSequence of ( NAT )) holds ((R1 in ( dom R24 ) & ( R24 . R1 ) <> ( 0 )) implies ( min (R24 , ( Sum ( R24 | R1 ) )) ) = R1)))
proof
let R1 being Nat;
let R24 being (FinSequence of ( NAT ));
assume that
L208: R1 in ( dom R24 )
and
L209: ( R24 . R1 ) <> ( 0 );
L210: R1 <= ( len R24 ) by L208 , FINSEQ_3:25;
L211: ( len ( R24 | R1 ) ) = R1 by L210 , FINSEQ_1:59;
L212: 1 <= R1 by L208 , FINSEQ_3:25;
L213: R1 in ( dom ( R24 | R1 ) ) by L212 , L211 , FINSEQ_3:25;
L214: ( Sum ( R24 | R1 ) ) >= ( ( R24 | R1 ) . R1 ) by L213 , POLYNOM3:4;
L215: ( Sum ( R24 | R1 ) ) <> ( 0 ) by L214 , L209 , L213 , FUNCT_1:47;
L216: ( Sum ( R24 | R1 ) ) >= 1 by L215 , NAT_1:14;
L217: ( R24 | ( len R24 ) ) = R24 by FINSEQ_1:58;
L218: ( Sum ( R24 | R1 ) ) <= ( Sum ( R24 | ( len R24 ) ) ) by L210 , L211 , POLYNOM3:18;
L219: ( Sum ( R24 | R1 ) ) in ( Seg ( Sum R24 ) ) by L218 , L217 , L216;
L220: ( min (R24 , ( Sum ( R24 | R1 ) )) ) <= R1 by L219 , L179;
thus L221: ( min (R24 , ( Sum ( R24 | R1 ) )) ) = R1
proof
assume L222: ( min (R24 , ( Sum ( R24 | R1 ) )) ) <> R1;
L223: ( min (R24 , ( Sum ( R24 | R1 ) )) ) < R1 by L222 , L220 , XXREAL_0:1;
reconsider D17 = ( R1 - 1 ) as (Element of ( NAT )) by L223 , NAT_1:20;
L224: ( min (R24 , ( Sum ( R24 | R1 ) )) ) < ( D17 + 1 ) by L220 , L222 , XXREAL_0:1;
L225: ( min (R24 , ( Sum ( R24 | R1 ) )) ) <= D17 by L224 , NAT_1:13;
L226: ( Sum ( R24 | ( min (R24 , ( Sum ( R24 | R1 ) )) ) ) ) <= ( Sum ( R24 | D17 ) ) by L225 , POLYNOM3:18;
L227: ( Sum ( R24 | R1 ) ) <= ( Sum ( R24 | ( min (R24 , ( Sum ( R24 | R1 ) )) ) ) ) by L219 , L179;
L228: ( Sum ( R24 | R1 ) ) <= ( Sum ( R24 | D17 ) ) by L227 , L226 , XXREAL_0:2;
L229: ( R24 | ( D17 + 1 ) ) = ( ( R24 | D17 ) ^ <* ( R24 . R1 ) *> ) by L208 , FINSEQ_5:10;
L230: ( Sum ( R24 | R1 ) ) = ( ( Sum ( R24 | D17 ) ) + ( R24 . R1 ) ) by L229 , RVSUM_1:74;
L231: ( Sum ( R24 | R1 ) ) >= ( Sum ( R24 | D17 ) ) by L230 , NAT_1:11;
L232: ( Sum ( R24 | R1 ) ) = ( Sum ( R24 | D17 ) ) by L231 , L228 , XXREAL_0:1;
thus L233: thesis by L232 , L209 , L230;
end;

end;
theorem
L222: (for R1 being Nat holds (for R24 being (FinSequence of ( NAT )) holds (R1 in ( Seg ( Sum R24 ) ) implies (( ( min (R24 , R1) ) -' 1 ) = ( ( min (R24 , R1) ) - 1 ) & ( Sum ( R24 | ( ( min (R24 , R1) ) -' 1 ) ) ) < R1))))
proof
let R1 being Nat;
let R24 being (FinSequence of ( NAT ));
set D18 = ( min (R24 , R1) );
assume L223: R1 in ( Seg ( Sum R24 ) );
L224: D18 in ( dom R24 ) by L223 , L179;
L225: 1 <= D18 by L224 , FINSEQ_3:25;
thus L226: ( D18 -' 1 ) = ( D18 - 1 ) by L225 , XREAL_1:233;
assume L227: ( Sum ( R24 | ( D18 -' 1 ) ) ) >= R1;
L228: ( D18 -' 1 ) >= ( D18 - ( 0 ) ) by L227 , L223 , L179;
thus L229: thesis by L228 , L226 , XREAL_1:10;
end;
theorem
L230: (for R1 being Nat holds (for R24 being (FinSequence of ( NAT )) holds (for R25 being (FinSequence of ( NAT )) holds (R1 in ( Seg ( Sum R24 ) ) implies ( min (( R24 ^ R25 ) , R1) ) = ( min (R24 , R1) )))))
proof
let R1 being Nat;
let R24 being (FinSequence of ( NAT ));
let R25 being (FinSequence of ( NAT ));
reconsider D19 = ( R24 ^ R25 ) as (FinSequence of ( NAT ));
assume L231: R1 in ( Seg ( Sum R24 ) );
L232: R1 <= ( Sum ( R24 | ( min (R24 , R1) ) ) ) by L231 , L179;
L233: ( Sum D19 ) = ( ( Sum R24 ) + ( Sum R25 ) ) by RVSUM_1:75;
L234: ( Sum D19 ) >= ( ( Sum R24 ) + ( 0 ) ) by L233 , XREAL_1:6;
L235: ( Seg ( Sum R24 ) ) c= ( Seg ( Sum D19 ) ) by L234 , FINSEQ_1:5;
L236: ( min (R24 , R1) ) in ( dom R24 ) by L231 , L179;
L237: ( min (R24 , R1) ) <= ( len R24 ) by L236 , FINSEQ_3:25;
L238: ( D19 | ( min (R24 , R1) ) ) = ( R24 | ( min (R24 , R1) ) ) by L237 , FINSEQ_5:22;
L239: ( min (D19 , R1) ) <= ( min (R24 , R1) ) by L238 , L231 , L235 , L232 , L179;
L240: ( D19 | ( min (D19 , R1) ) ) = ( R24 | ( min (D19 , R1) ) ) by L239 , L237 , FINSEQ_5:22 , XXREAL_0:2;
L241: R1 <= ( Sum ( R24 | ( min (D19 , R1) ) ) ) by L240 , L231 , L235 , L179;
L242: ( min (R24 , R1) ) <= ( min (D19 , R1) ) by L241 , L231 , L179;
thus L243: thesis by L242 , L239 , XXREAL_0:1;
end;
theorem
L244: (for R1 being Nat holds (for R24 being (FinSequence of ( NAT )) holds (for R25 being (FinSequence of ( NAT )) holds (R1 in ( ( Seg ( ( Sum R24 ) + ( Sum R25 ) ) ) \ ( Seg ( Sum R24 ) ) ) implies (( min (( R24 ^ R25 ) , R1) ) = ( ( min (R25 , ( R1 -' ( Sum R24 ) )) ) + ( len R24 ) ) & ( R1 -' ( Sum R24 ) ) = ( R1 - ( Sum R24 ) ))))))
proof
let R1 being Nat;
let R24 being (FinSequence of ( NAT ));
let R25 being (FinSequence of ( NAT ));
reconsider D20 = ( R24 ^ R25 ) as (FinSequence of ( NAT ));
assume L245: R1 in ( ( Seg ( ( Sum R24 ) + ( Sum R25 ) ) ) \ ( Seg ( Sum R24 ) ) );
L246: (not R1 in ( Seg ( Sum R24 ) )) by L245 , XBOOLE_0:def 5;
L247: (1 > R1 or R1 > ( Sum R24 )) by L246 , L245;
L248: ( Sum D20 ) = ( ( Sum R24 ) + ( Sum R25 ) ) by RVSUM_1:75;
L249: R1 in ( Seg ( Sum D20 ) ) by L248 , L245 , XBOOLE_0:def 5;
reconsider D21 = ( R1 - ( Sum R24 ) ) as (Element of ( NAT )) by L249 , L247 , FINSEQ_1:1 , NAT_1:21;
L250: R1 = ( D21 + ( Sum R24 ) );
L251: ( D20 | ( ( len R24 ) + ( min (R25 , D21) ) ) ) = ( R24 ^ ( R25 | ( min (R25 , D21) ) ) ) by FINSEQ_6:14;
L252: ( Sum ( D20 | ( ( len R24 ) + ( min (R25 , D21) ) ) ) ) = ( ( Sum R24 ) + ( Sum ( R25 | ( min (R25 , D21) ) ) ) ) by L251 , RVSUM_1:75;
L253: D21 <> ( 0 ) by L249 , L247 , FINSEQ_1:1;
L254: D21 in ( Seg ( Sum R25 ) ) by L253 , L248 , L249 , L250 , FINSEQ_1:61;
L255: D21 <= ( Sum ( R25 | ( min (R25 , D21) ) ) ) by L254 , L179;
L256: ( Sum ( D20 | ( ( len R24 ) + ( min (R25 , D21) ) ) ) ) >= ( ( Sum R24 ) + D21 ) by L255 , L252 , XREAL_1:7;
L257: ( ( len R24 ) + ( min (R25 , D21) ) ) >= ( min (D20 , R1) ) by L256 , L249 , L179;
L258: R1 <= ( Sum ( D20 | ( min (D20 , R1) ) ) ) by L249 , L179;
L259: ( min (D20 , R1) ) > ( len R24 )
proof
L260: ( R24 | ( len R24 ) ) = R24 by FINSEQ_1:58;
assume L261: ( min (D20 , R1) ) <= ( len R24 );
L262: ( Sum ( R24 | ( min (D20 , R1) ) ) ) <= ( Sum ( R24 | ( len R24 ) ) ) by L261 , POLYNOM3:18;
L263: ( D20 | ( min (D20 , R1) ) ) = ( R24 | ( min (D20 , R1) ) ) by L261 , FINSEQ_5:22;
thus L264: thesis by L263 , L249 , L258 , L247 , L262 , L260 , FINSEQ_1:1 , XXREAL_0:2;
end;
reconsider D22 = ( ( min (D20 , R1) ) - ( len R24 ) ) as (Element of ( NAT )) by L259 , NAT_1:21;
L265: ( D20 | ( ( len R24 ) + D22 ) ) = ( R24 ^ ( R25 | D22 ) ) by FINSEQ_6:14;
L266: R1 <= ( ( Sum R24 ) + ( Sum ( R25 | D22 ) ) ) by L265 , L258 , RVSUM_1:75;
L267: D21 <= ( ( ( Sum R24 ) + ( Sum ( R25 | D22 ) ) ) - ( Sum R24 ) ) by L266 , XREAL_1:9;
L268: D22 >= ( min (R25 , D21) ) by L267 , L254 , L179;
L269: ( D22 + ( len R24 ) ) >= ( ( min (R25 , D21) ) + ( len R24 ) ) by L268 , XREAL_1:7;
L270: D21 = ( R1 -' ( Sum R24 ) ) by L249 , L247 , FINSEQ_1:1 , XREAL_1:233;
thus L271: thesis by L270 , L269 , L257 , XXREAL_0:1;
end;
L272: (for R1 being Nat holds (for R24 being (FinSequence of ( NAT )) holds (R1 in ( dom R24 ) implies ( Sum ( R24 | R1 ) ) = ( ( Sum ( R24 | ( R1 -' 1 ) ) ) + ( R24 . R1 ) ))))
proof
let R1 being Nat;
let R24 being (FinSequence of ( NAT ));
set D23 = <* ( R24 /. R1 ) *>;
set D24 = ( R24 | ( R1 -' 1 ) );
assume L273: R1 in ( dom R24 );
L274: R1 >= 1 by L273 , FINSEQ_3:25;
L275: ( R1 -' 1 ) = ( R1 - 1 ) by L274 , XREAL_1:233;
L276: R1 = ( ( R1 -' 1 ) + 1 ) by L275;
L277: ( R24 /. R1 ) = ( R24 . R1 ) by L273 , PARTFUN1:def 6;
thus L278: ( ( Sum ( R24 | ( R1 -' 1 ) ) ) + ( R24 . R1 ) ) = ( Sum ( D24 ^ D23 ) ) by L277 , RVSUM_1:74
.= ( Sum ( R24 | R1 ) ) by L273 , L276 , L277 , FINSEQ_5:10;
end;
theorem
L279: (for R1 being Nat holds (for R2 being Nat holds (for R24 being (FinSequence of ( NAT )) holds ((R1 in ( dom R24 ) & R2 in ( Seg ( R24 /. R1 ) )) implies (( R2 + ( Sum ( R24 | ( R1 -' 1 ) ) ) ) in ( Seg ( Sum ( R24 | R1 ) ) ) & ( min (R24 , ( R2 + ( Sum ( R24 | ( R1 -' 1 ) ) ) )) ) = R1)))))
proof
let R1 being Nat;
let R2 being Nat;
let R24 being (FinSequence of ( NAT ));
assume that
L280: R1 in ( dom R24 )
and
L281: R2 in ( Seg ( R24 /. R1 ) );
set D25 = ( R24 /. R1 );
L282: D25 = ( R24 . R1 ) by L280 , PARTFUN1:def 6;
L283: ( D25 + ( Sum ( R24 | ( R1 -' 1 ) ) ) ) = ( Sum ( R24 | R1 ) ) by L282 , L280 , L272;
L284: ( R24 | ( len R24 ) ) = R24 by FINSEQ_1:58;
L285: R1 in ( NAT ) by ORDINAL1:def 12;
L286: R1 <= ( len R24 ) by L280 , FINSEQ_3:25;
L287: ( Sum ( R24 | R1 ) ) <= ( Sum ( R24 | ( len R24 ) ) ) by L286 , L285 , POLYNOM3:18;
L288: ( Seg ( Sum ( R24 | R1 ) ) ) c= ( Seg ( Sum R24 ) ) by L287 , L284 , FINSEQ_1:5;
set D26 = ( R2 + ( Sum ( R24 | ( R1 -' 1 ) ) ) );
L289: R2 <= D25 by L281 , FINSEQ_1:1;
L290: D26 <= ( D25 + ( Sum ( R24 | ( R1 -' 1 ) ) ) ) by L289 , XREAL_1:7;
L291: 1 <= R2 by L281 , FINSEQ_1:1;
L292: ( 1 + ( 0 ) ) <= D26 by L291 , XREAL_1:7;
thus L293: D26 in ( Seg ( Sum ( R24 | R1 ) ) ) by L292 , L283 , L290;
L294: R1 >= 1 by L280 , FINSEQ_3:25;
L295: ( R1 -' 1 ) = ( R1 - 1 ) by L294 , XREAL_1:233;
L296: R1 = ( ( R1 -' 1 ) + 1 ) by L295;
L297: R1 <= ( min (R24 , D26) )
proof
assume L298: R1 > ( min (R24 , D26) );
L299: ( min (R24 , D26) ) <= ( R1 -' 1 ) by L298 , L296 , NAT_1:13;
L300: ( Sum ( R24 | ( min (R24 , D26) ) ) ) <= ( Sum ( R24 | ( R1 -' 1 ) ) ) by L299 , POLYNOM3:18;
L301: ( 0 ) < R2 by L281 , FINSEQ_1:1;
L302: ( ( Sum ( R24 | ( R1 -' 1 ) ) ) + ( 0 ) ) < D26 by L301 , XREAL_1:8;
L303: ( Sum ( R24 | ( min (R24 , D26) ) ) ) < D26 by L302 , L300 , XXREAL_0:2;
thus L304: thesis by L303 , L293 , L288 , L179;
end;
L305: ( min (R24 , D26) ) <= R1 by L283 , L290 , L293 , L288 , L179;
thus L306: thesis by L305 , L297 , XXREAL_0:1;
end;
theorem
L307: (for R24 being (FinSequence of ( NAT )) holds (for R1 being Nat holds (for R2 being Nat holds ((R1 <= ( len R24 ) & R2 <= ( len R24 ) & ( Sum ( R24 | R1 ) ) = ( Sum ( R24 | R2 ) ) & (R1 in ( dom R24 ) implies ( R24 . R1 ) <> ( 0 )) & (R2 in ( dom R24 ) implies ( R24 . R2 ) <> ( 0 ))) implies R1 = R2))))
proof
let R24 being (FinSequence of ( NAT ));
L308:
now
let R1 being Nat;
let R2 being Nat;
assume that
L309: R1 <= ( len R24 )
and
L310: R2 <= ( len R24 )
and
L311: ( Sum ( R24 | R1 ) ) = ( Sum ( R24 | R2 ) )
and
L312: (R1 in ( dom R24 ) implies ( R24 . R1 ) <> ( 0 ))
and
L313: (R2 in ( dom R24 ) implies ( R24 . R2 ) <> ( 0 ));
assume L314: R1 > R2;
reconsider D27 = ( R1 - 1 ) as (Element of ( NAT )) by L314 , NAT_1:20;
L315: R2 in ( NAT ) by ORDINAL1:def 12;
L316: R1 = ( D27 + 1 );
L317: R2 <= D27 by L316 , L314 , NAT_1:13;
L318: ( Sum ( R24 | R2 ) ) <= ( Sum ( R24 | D27 ) ) by L317 , L315 , POLYNOM3:18;
L319: R1 >= 1 by L316 , NAT_1:14;
L320: R1 in ( dom R24 ) by L319 , L309 , FINSEQ_3:25;
L321: ( R24 | ( D27 + 1 ) ) = ( ( R24 | D27 ) ^ <* ( R24 . R1 ) *> ) by L320 , FINSEQ_5:10;
L322: ( Sum ( R24 | R2 ) ) = ( ( Sum ( R24 | D27 ) ) + ( R24 . R1 ) ) by L321 , L311 , RVSUM_1:74;
L323: ( Sum ( R24 | D27 ) ) <= ( Sum ( R24 | R2 ) ) by L322 , NAT_1:11;
L324: ( Sum ( R24 | D27 ) ) = ( Sum ( R24 | R2 ) ) by L323 , L318 , XXREAL_0:1;
thus L325: contradiction by L324 , L309 , L312 , L319 , L322 , FINSEQ_3:25;
end;
let R1 being Nat;
let R2 being Nat;
assume that
L326: R1 <= ( len R24 )
and
L327: R2 <= ( len R24 )
and
L328: ( Sum ( R24 | R1 ) ) = ( Sum ( R24 | R2 ) )
and
L329: (R1 in ( dom R24 ) implies ( R24 . R1 ) <> ( 0 ))
and
L330: (R2 in ( dom R24 ) implies ( R24 . R2 ) <> ( 0 ));
L331: R2 <= R1 by L308 , L326 , L327 , L328 , L329 , L330;
L332: R1 <= R2 by L308 , L326 , L327 , L328 , L329 , L330;
thus L333: thesis by L332 , L331 , XXREAL_0:1;
end;
begin
definition
let R12 being non  empty set;
let C16 being (FinSequence of ( ( R12 * ) * ));
attr C16 is  Matrix-yielding
means
:L334: (for R1 being Nat holds (R1 in ( dom C16 ) implies ( C16 . R1 ) is (Matrix of R12)));
end;
registration
let R12 being non  empty set;
cluster  Matrix-yielding for (FinSequence of ( ( R12 * ) * ));
existence
proof
reconsider D28 = ( <*> ( ( R12 * ) * ) ) as (FinSequence of ( ( R12 * ) * ));
take D28;
L336: (for R1 being Nat holds (R1 in ( dom D28 ) implies ( D28 . R1 ) is (Matrix of R12)));
thus L337: thesis by L336 , L334;
end;
end;
definition
let R12 being non  empty set;
mode FinSequence_of_Matrix of R12
 is  Matrix-yielding (FinSequence of ( ( R12 * ) * ));
end;
definition
let R8 being Field;
mode FinSequence_of_Matrix of R8
 is  Matrix-yielding (FinSequence of ( ( (the carrier of R8) * ) * ));
end;
theorem
L341: (for R12 being non  empty set holds ( {} ) is (FinSequence_of_Matrix of R12))
proof
let R12 being non  empty set;
set D29 = ( <*> ( ( R12 * ) * ) );
L342: (for R1 being Nat holds (R1 in ( dom D29 ) implies ( D29 . R1 ) is (Matrix of R12)));
thus L343: thesis by L342 , L334;
end;
definition
let R12 being non  empty set;
let R26 being (FinSequence_of_Matrix of R12);
let R6 being set;
redefine func R26 . R6 -> (Matrix of R12);

coherence
proof
per cases ;
suppose L344: R6 in ( dom R26 );

thus L345: thesis by L344 , L334;
end;
suppose L346: (not R6 in ( dom R26 ));

L347: ( R26 . R6 ) = ( {} ) by L346 , FUNCT_1:def 2;
thus L348: thesis by L347 , MATRIX_1:13;
end;
end;
end;
definition
let R12 being non  empty set;
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
redefine func R27 ^ R28 -> (FinSequence_of_Matrix of R12);

coherence
proof
L351: ( R27 ^ R28 ) is  Matrix-yielding
proof
let R1 being Nat;
assume that
L352: R1 in ( dom ( R27 ^ R28 ) );
per cases  by L352 , FINSEQ_1:25;
suppose L353: R1 in ( dom R27 );

L354: ( ( R27 ^ R28 ) . R1 ) = ( R27 . R1 ) by L353 , FINSEQ_1:def 7;
thus L355: thesis by L354;
end;
suppose L356: (ex R4 being Nat st (R4 in ( dom R28 ) & R1 = ( ( len R27 ) + R4 )));

consider R4 being Nat such that L357: R4 in ( dom R28 ) and L358: R1 = ( ( len R27 ) + R4 ) by L356;
L359: ( ( R27 ^ R28 ) . R1 ) = ( R28 . R4 ) by L357 , L358 , FINSEQ_1:def 7;
thus L360: thesis by L359;
end;
end;
thus L362: thesis by L351;
end;
end;
L364: (for R12 being non  empty set holds (for R16 being (Matrix of R12) holds <* R16 *> is  Matrix-yielding))
proof
let R12 being non  empty set;
let R16 being (Matrix of R12);
L365:
now
L366: ( <* R16 *> . 1 ) = R16 by FINSEQ_1:def 8;
L367: ( dom <* R16 *> ) = { 1 } by FINSEQ_1:2 , FINSEQ_1:def 8;
let R1 being Nat;
assume L368: R1 in ( dom <* R16 *> );
thus L369: ( <* R16 *> . R1 ) is (Matrix of R12) by L368 , L367 , L366 , TARSKI:def 1;
end;
thus L370: thesis by L365 , L334;
end;
definition
let R12 being non  empty set;
let R17 being (Matrix of R12);
redefine func <*R17 *> -> (FinSequence_of_Matrix of R12);

coherence by L364;
let R18 being (Matrix of R12);
redefine func <*R17 , R18 *> -> (FinSequence_of_Matrix of R12);

coherence
proof
reconsider D30 = <* R17 *> , D31 = <* R18 *> as (FinSequence_of_Matrix of R12) by L364;
L371: <* R17 , R18 *> = ( D30 ^ D31 );
thus L372: thesis by L371;
end;
end;
definition
let R12 being non  empty set;
let R4 being Nat;
let R26 being (FinSequence_of_Matrix of R12);
redefine func R26 | R4 -> (FinSequence_of_Matrix of R12);

coherence
proof
L374:
now
let R1 being Nat;
assume L375: R1 in ( dom ( R26 | R4 ) );
L376: ( ( R26 | R4 ) . R1 ) = ( R26 . R1 ) by L375 , FUNCT_1:47;
thus L377: ( ( R26 | R4 ) . R1 ) is (Matrix of R12) by L376;
end;
thus L378: thesis by L374 , L334;
end;
redefine func R26 /^ R4 -> (FinSequence_of_Matrix of R12);

coherence
proof
L379:
now
let R1 being Nat;
assume that
L380: R1 in ( dom ( R26 /^ R4 ) );
L381: ( R1 + R4 ) in ( dom R26 ) by L380 , FINSEQ_5:26;
L382: ( R26 . ( R4 + R1 ) ) = ( R26 /. ( R4 + R1 ) ) by L381 , PARTFUN1:def 6;
L383: ( ( R26 /^ R4 ) . R1 ) = ( ( R26 /^ R4 ) /. R1 ) by L380 , PARTFUN1:def 6;
thus L384: ( ( R26 /^ R4 ) . R1 ) is (Matrix of R12) by L383 , L380 , L382 , FINSEQ_5:27;
end;
thus L385: thesis by L379 , L334;
end;
end;
begin
definition
let R12 being non  empty set;
let R26 being (FinSequence_of_Matrix of R12);
func Len R26 -> (FinSequence of ( NAT )) means 
:L387: (( dom it ) = ( dom R26 ) & (for R1 being Nat holds (R1 in ( dom it ) implies ( it . R1 ) = ( len ( R26 . R1 ) ))));
existence
proof
deffunc H1(Nat) = ( len ( R26 . $1 ) );
consider C17 being (FinSequence of ( NAT )) such that L388: ( len C17 ) = ( len R26 ) and L389: (for R1 being Nat holds (R1 in ( dom C17 ) implies ( C17 . R1 ) = H1(R1))) from FINSEQ_2:sch 1;
take C17;
thus L390: thesis by L388 , L389 , FINSEQ_3:29;
end;
uniqueness
proof
let C18 , C19 being (FinSequence of ( NAT ));
assume that
L391: ( dom C18 ) = ( dom R26 )
and
L392: (for R1 being Nat holds (R1 in ( dom C18 ) implies ( C18 . R1 ) = ( len ( R26 . R1 ) )))
and
L393: ( dom C19 ) = ( dom R26 )
and
L394: (for R1 being Nat holds (R1 in ( dom C19 ) implies ( C19 . R1 ) = ( len ( R26 . R1 ) )));
L395:
now
let R6 being set;
assume that
L396: R6 in ( dom C18 );
reconsider D32 = R6 as (Element of ( NAT )) by L396;
thus L397: ( C18 . R6 ) = ( len ( R26 . D32 ) ) by L392 , L396
.= ( C19 . R6 ) by L391 , L393 , L394 , L396;
end;
thus L398: thesis by L395 , L391 , L393 , FUNCT_1:2;
end;
func Width R26 -> (FinSequence of ( NAT )) means 
:L399: (( dom it ) = ( dom R26 ) & (for R1 being Nat holds (R1 in ( dom it ) implies ( it . R1 ) = ( width ( R26 . R1 ) ))));
existence
proof
deffunc H2(Nat) = ( width ( R26 . $1 ) );
consider C20 being (FinSequence of ( NAT )) such that L400: ( len C20 ) = ( len R26 ) and L401: (for R1 being Nat holds (R1 in ( dom C20 ) implies ( C20 . R1 ) = H2(R1))) from FINSEQ_2:sch 1;
take C20;
thus L402: thesis by L400 , L401 , FINSEQ_3:29;
end;
uniqueness
proof
let C21 , C22 being (FinSequence of ( NAT ));
assume that
L403: ( dom C21 ) = ( dom R26 )
and
L404: (for R1 being Nat holds (R1 in ( dom C21 ) implies ( C21 . R1 ) = ( width ( R26 . R1 ) )))
and
L405: ( dom C22 ) = ( dom R26 )
and
L406: (for R1 being Nat holds (R1 in ( dom C22 ) implies ( C22 . R1 ) = ( width ( R26 . R1 ) )));
L407:
now
let R6 being set;
assume that
L408: R6 in ( dom C21 );
reconsider D33 = R6 as (Element of ( NAT )) by L408;
thus L409: ( C21 . R6 ) = ( width ( R26 . D33 ) ) by L404 , L408
.= ( C22 . R6 ) by L403 , L405 , L406 , L408;
end;
thus L410: thesis by L407 , L403 , L405 , FUNCT_1:2;
end;
end;
definition
let R12 being non  empty set;
let R26 being (FinSequence_of_Matrix of R12);
redefine func Len R26 -> (Element of ( ( len R26 ) -tuples_on ( NAT ) ));

coherence
proof
L412: ( dom ( Len R26 ) ) = ( dom R26 ) by L387;
L413: ( len ( Len R26 ) ) = ( len R26 ) by L412 , FINSEQ_3:29;
thus L414: thesis by L413 , FINSEQ_2:92;
end;
redefine func Width R26 -> (Element of ( ( len R26 ) -tuples_on ( NAT ) ));

coherence
proof
L415: ( dom ( Width R26 ) ) = ( dom R26 ) by L399;
L416: ( len ( Width R26 ) ) = ( len R26 ) by L415 , FINSEQ_3:29;
thus L417: thesis by L416 , FINSEQ_2:92;
end;
end;
theorem
L419: (for R12 being non  empty set holds (for R26 being (FinSequence_of_Matrix of R12) holds (( Sum ( Len R26 ) ) = ( 0 ) implies ( Sum ( Width R26 ) ) = ( 0 ))))
proof
let R12 being non  empty set;
let R26 being (FinSequence_of_Matrix of R12);
set D34 = ( Len R26 );
set D35 = ( Width R26 );
assume L420: ( Sum D34 ) = ( 0 );
per cases  by L420 , RVSUM_1:85;
suppose L421: (ex R1 being Nat st (R1 in ( dom D34 ) & ( 0 ) > ( D34 . R1 )));

thus L422: thesis by L421;
end;
suppose L423: (for R1 being Nat holds (R1 in ( dom D34 ) implies ( 0 ) >= ( D34 . R1 )));

set D36 = ( ( len R26 ) |-> ( 0 ) );
L424: ( len D35 ) = ( len R26 ) by CARD_1:def 7;
L425: ( dom D34 ) = ( dom R26 ) by L387;
L426: ( dom D35 ) = ( dom R26 ) by L399;
L427:
now
let R2 being Nat;
assume that
L428: 1 <= R2
and
L429: R2 <= ( len D35 );
L430: R2 in ( dom D35 ) by L428 , L429 , FINSEQ_3:25;
L431: ( D35 . R2 ) = ( width ( R26 . R2 ) ) by L430 , L399;
L432: R2 in ( Seg ( len R26 ) ) by L424 , L428 , L429 , FINSEQ_1:1;
L433: ( D36 . R2 ) = ( 0 ) by L432 , FINSEQ_2:57;
L434: ( 0 ) >= ( D34 . R2 ) by L423 , L426 , L425 , L430;
L435: ( D34 . R2 ) = ( len ( R26 . R2 ) ) by L426 , L425 , L430 , L387;
thus L436: ( D35 . R2 ) = ( D36 . R2 ) by L435 , L431 , L434 , L433 , MATRIX_1:def 3;
end;
L437: ( len D36 ) = ( len R26 ) by CARD_1:def 7;
L438: D35 = D36 by L437 , L424 , L427 , FINSEQ_1:14;
thus L439: thesis by L438 , RVSUM_1:81;
end;
end;
theorem
L441: (for R12 being non  empty set holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds ( Len ( R27 ^ R28 ) ) = ( ( Len R27 ) ^ ( Len R28 ) ))))
proof
let R12 being non  empty set;
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D37 = ( R27 ^ R28 );
L442: ( len D37 ) = ( ( len R27 ) + ( len R28 ) ) by FINSEQ_1:22;
L443: ( len R28 ) = ( len ( Len R28 ) ) by CARD_1:def 7;
L444: ( dom ( Len R28 ) ) = ( dom R28 ) by L443 , FINSEQ_3:29;
L445: ( len ( ( Len R27 ) ^ ( Len R28 ) ) ) = ( ( len R27 ) + ( len R28 ) ) by CARD_1:def 7;
L446: ( len ( Len D37 ) ) = ( len D37 ) by CARD_1:def 7;
L447: ( dom ( ( Len R27 ) ^ ( Len R28 ) ) ) = ( dom ( Len D37 ) ) by L446 , L442 , L445 , FINSEQ_3:29;
L448: ( len R27 ) = ( len ( Len R27 ) ) by CARD_1:def 7;
L449: ( dom ( Len R27 ) ) = ( dom R27 ) by L448 , FINSEQ_3:29;
L450:
now
let R5 being Nat;
assume that
L451: 1 <= R5
and
L452: R5 <= ( ( len R27 ) + ( len R28 ) );
L453: R5 in ( dom ( ( Len R27 ) ^ ( Len R28 ) ) ) by L445 , L451 , L452 , FINSEQ_3:25;
L454:
now
per cases  by L453 , FINSEQ_1:25;
suppose L455: R5 in ( dom ( Len R27 ) );

thus L456: ( ( ( Len R27 ) ^ ( Len R28 ) ) . R5 ) = ( ( Len R27 ) . R5 ) by L455 , FINSEQ_1:def 7
.= ( len ( R27 . R5 ) ) by L455 , L387
.= ( len ( D37 . R5 ) ) by L449 , L455 , FINSEQ_1:def 7
.= ( ( Len D37 ) . R5 ) by L447 , L453 , L387;
end;
suppose L457: (ex R4 being Nat st (R4 in ( dom ( Len R28 ) ) & R5 = ( ( len ( Len R27 ) ) + R4 )));

consider R4 being Nat such that L458: R4 in ( dom ( Len R28 ) ) and L459: R5 = ( ( len R27 ) + R4 ) by L457 , L448;
thus L460: ( ( ( Len R27 ) ^ ( Len R28 ) ) . R5 ) = ( ( Len R28 ) . R4 ) by L448 , L458 , L459 , FINSEQ_1:def 7
.= ( len ( R28 . R4 ) ) by L458 , L387
.= ( len ( D37 . R5 ) ) by L444 , L458 , L459 , FINSEQ_1:def 7
.= ( ( Len D37 ) . R5 ) by L447 , L453 , L387;
end;
end;
thus L462: ( ( Len D37 ) . R5 ) = ( ( ( Len R27 ) ^ ( Len R28 ) ) . R5 ) by L454;
end;
thus L463: thesis by L450 , L446 , L442 , L445 , FINSEQ_1:14;
end;
theorem
L464: (for R12 being non  empty set holds (for R16 being (Matrix of R12) holds ( Len <* R16 *> ) = <* ( len R16 ) *>))
proof
let R12 being non  empty set;
let R16 being (Matrix of R12);
set D38 = <* R16 *>;
L465: ( len D38 ) = 1 by FINSEQ_1:40;
L466: ( D38 . 1 ) = R16 by FINSEQ_1:40;
L467: ( len D38 ) = ( len ( Len D38 ) ) by CARD_1:def 7;
L468: ( dom ( Len D38 ) ) = ( Seg ( len D38 ) ) by FINSEQ_2:124;
L469: 1 in ( Seg 1 );
L470: ( ( Len D38 ) . 1 ) = ( len ( D38 . 1 ) ) by L469 , L465 , L468 , L387;
thus L471: thesis by L470 , L465 , L467 , L466 , FINSEQ_1:40;
end;
L472: (for R12 being non  empty set holds (for R16 being (Matrix of R12) holds ( Sum ( Len <* R16 *> ) ) = ( len R16 )))
proof
let R12 being non  empty set;
let R16 being (Matrix of R12);
L473: ( Len <* R16 *> ) = <* ( len R16 ) *> by L464;
thus L474: thesis by L473 , RVSUM_1:73;
end;
theorem
L475: (for R12 being non  empty set holds (for R17 being (Matrix of R12) holds (for R18 being (Matrix of R12) holds ( Sum ( Len <* R17 , R18 *> ) ) = ( ( len R17 ) + ( len R18 ) ))))
proof
let R12 being non  empty set;
let R17 being (Matrix of R12);
let R18 being (Matrix of R12);
thus L476: ( Sum ( Len <* R17 , R18 *> ) ) = ( Sum ( ( Len <* R17 *> ) ^ ( Len <* R18 *> ) ) ) by L441
.= ( ( Sum ( Len <* R17 *> ) ) + ( Sum ( Len <* R18 *> ) ) ) by RVSUM_1:75
.= ( ( len R17 ) + ( Sum ( Len <* R18 *> ) ) ) by L472
.= ( ( len R17 ) + ( len R18 ) ) by L472;
end;
theorem
L477: (for R4 being Nat holds (for R12 being non  empty set holds (for R27 being (FinSequence_of_Matrix of R12) holds ( Len ( R27 | R4 ) ) = ( ( Len R27 ) | R4 ))))
proof
let R4 being Nat;
let R12 being non  empty set;
let R27 being (FinSequence_of_Matrix of R12);
L478: ( len ( Len R27 ) ) = ( len R27 ) by CARD_1:def 7;
per cases ;
suppose L479: R4 >= ( len R27 );

L480: ( R27 | R4 ) = R27 by L479 , FINSEQ_1:58;
thus L481: thesis by L480 , L478 , L479 , FINSEQ_1:58;
end;
suppose L482: R4 < ( len R27 );

L483: R27 = ( ( R27 | R4 ) ^ ( R27 /^ R4 ) ) by RFINSEQ:8;
L484: ( Len R27 ) = ( ( Len ( R27 | R4 ) ) ^ ( Len ( R27 /^ R4 ) ) ) by L483 , L441;
L485: ( len ( R27 | R4 ) ) = R4 by L482 , FINSEQ_1:59;
L486: ( len ( Len ( R27 | R4 ) ) ) = R4 by L485 , CARD_1:def 7;
thus L487: thesis by L486 , L484 , FINSEQ_5:23;
end;
end;
theorem
L489: (for R12 being non  empty set holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds ( Width ( R27 ^ R28 ) ) = ( ( Width R27 ) ^ ( Width R28 ) ))))
proof
let R12 being non  empty set;
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D39 = ( R27 ^ R28 );
L490: ( len D39 ) = ( ( len R27 ) + ( len R28 ) ) by FINSEQ_1:22;
L491: ( len R28 ) = ( len ( Width R28 ) ) by CARD_1:def 7;
L492: ( dom ( Width R28 ) ) = ( dom R28 ) by L491 , FINSEQ_3:29;
L493: ( len ( ( Width R27 ) ^ ( Width R28 ) ) ) = ( ( len R27 ) + ( len R28 ) ) by CARD_1:def 7;
L494: ( len ( Width D39 ) ) = ( len D39 ) by CARD_1:def 7;
L495: ( dom ( ( Width R27 ) ^ ( Width R28 ) ) ) = ( dom ( Width D39 ) ) by L494 , L490 , L493 , FINSEQ_3:29;
L496: ( len R27 ) = ( len ( Width R27 ) ) by CARD_1:def 7;
L497: ( dom ( Width R27 ) ) = ( dom R27 ) by L496 , FINSEQ_3:29;
L498:
now
let R5 being Nat;
assume that
L499: 1 <= R5
and
L500: R5 <= ( ( len R27 ) + ( len R28 ) );
L501: R5 in ( dom ( ( Width R27 ) ^ ( Width R28 ) ) ) by L493 , L499 , L500 , FINSEQ_3:25;
L502:
now
per cases  by L501 , FINSEQ_1:25;
suppose L503: R5 in ( dom ( Width R27 ) );

thus L504: ( ( ( Width R27 ) ^ ( Width R28 ) ) . R5 ) = ( ( Width R27 ) . R5 ) by L503 , FINSEQ_1:def 7
.= ( width ( R27 . R5 ) ) by L503 , L399
.= ( width ( D39 . R5 ) ) by L497 , L503 , FINSEQ_1:def 7
.= ( ( Width D39 ) . R5 ) by L495 , L501 , L399;
end;
suppose L505: (ex R4 being Nat st (R4 in ( dom ( Width R28 ) ) & R5 = ( ( len ( Width R27 ) ) + R4 )));

consider R4 being Nat such that L506: R4 in ( dom ( Width R28 ) ) and L507: R5 = ( ( len R27 ) + R4 ) by L505 , L496;
thus L508: ( ( ( Width R27 ) ^ ( Width R28 ) ) . R5 ) = ( ( Width R28 ) . R4 ) by L496 , L506 , L507 , FINSEQ_1:def 7
.= ( width ( R28 . R4 ) ) by L506 , L399
.= ( width ( D39 . R5 ) ) by L492 , L506 , L507 , FINSEQ_1:def 7
.= ( ( Width D39 ) . R5 ) by L495 , L501 , L399;
end;
end;
thus L510: ( ( Width D39 ) . R5 ) = ( ( ( Width R27 ) ^ ( Width R28 ) ) . R5 ) by L502;
end;
thus L511: thesis by L498 , L494 , L490 , L493 , FINSEQ_1:14;
end;
theorem
L512: (for R12 being non  empty set holds (for R16 being (Matrix of R12) holds ( Width <* R16 *> ) = <* ( width R16 ) *>))
proof
let R12 being non  empty set;
let R16 being (Matrix of R12);
set D40 = <* R16 *>;
L513: ( len D40 ) = 1 by FINSEQ_1:40;
L514: ( D40 . 1 ) = R16 by FINSEQ_1:40;
L515: ( len D40 ) = ( len ( Width D40 ) ) by CARD_1:def 7;
L516: ( dom ( Width D40 ) ) = ( Seg ( len D40 ) ) by FINSEQ_2:124;
L517: 1 in ( Seg 1 );
L518: ( ( Width D40 ) . 1 ) = ( width ( D40 . 1 ) ) by L517 , L513 , L516 , L399;
thus L519: thesis by L518 , L513 , L515 , L514 , FINSEQ_1:40;
end;
L520: (for R12 being non  empty set holds (for R16 being (Matrix of R12) holds ( Sum ( Width <* R16 *> ) ) = ( width R16 )))
proof
let R12 being non  empty set;
let R16 being (Matrix of R12);
L521: ( Width <* R16 *> ) = <* ( width R16 ) *> by L512;
thus L522: thesis by L521 , RVSUM_1:73;
end;
theorem
L523: (for R12 being non  empty set holds (for R17 being (Matrix of R12) holds (for R18 being (Matrix of R12) holds ( Sum ( Width <* R17 , R18 *> ) ) = ( ( width R17 ) + ( width R18 ) ))))
proof
let R12 being non  empty set;
let R17 being (Matrix of R12);
let R18 being (Matrix of R12);
thus L524: ( Sum ( Width <* R17 , R18 *> ) ) = ( Sum ( ( Width <* R17 *> ) ^ ( Width <* R18 *> ) ) ) by L489
.= ( ( Sum ( Width <* R17 *> ) ) + ( Sum ( Width <* R18 *> ) ) ) by RVSUM_1:75
.= ( ( width R17 ) + ( Sum ( Width <* R18 *> ) ) ) by L520
.= ( ( width R17 ) + ( width R18 ) ) by L520;
end;
theorem
L525: (for R4 being Nat holds (for R12 being non  empty set holds (for R27 being (FinSequence_of_Matrix of R12) holds ( Width ( R27 | R4 ) ) = ( ( Width R27 ) | R4 ))))
proof
let R4 being Nat;
let R12 being non  empty set;
let R27 being (FinSequence_of_Matrix of R12);
L526: ( len ( Width R27 ) ) = ( len R27 ) by CARD_1:def 7;
per cases ;
suppose L527: R4 >= ( len R27 );

L528: ( R27 | R4 ) = R27 by L527 , FINSEQ_1:58;
thus L529: thesis by L528 , L526 , L527 , FINSEQ_1:58;
end;
suppose L530: R4 < ( len R27 );

L531: R27 = ( ( R27 | R4 ) ^ ( R27 /^ R4 ) ) by RFINSEQ:8;
L532: ( Width R27 ) = ( ( Width ( R27 | R4 ) ) ^ ( Width ( R27 /^ R4 ) ) ) by L531 , L489;
L533: ( len ( R27 | R4 ) ) = R4 by L530 , FINSEQ_1:59;
L534: ( len ( Width ( R27 | R4 ) ) ) = R4 by L533 , CARD_1:def 7;
thus L535: thesis by L534 , L532 , FINSEQ_5:23;
end;
end;
begin
definition
let R12 being non  empty set;
let C23 being (Element of R12);
let C24 being (FinSequence_of_Matrix of R12);
func block_diagonal (C24 , C23) -> (Matrix of R12) means 
:L537: (( len it ) = ( Sum ( Len C24 ) ) & ( width it ) = ( Sum ( Width C24 ) ) & (for R1 being Nat holds (for R2 being Nat holds ([ R1 , R2 ] in ( Indices it ) implies (((R2 <= ( Sum ( ( Width C24 ) | ( ( min (( Len C24 ) , R1) ) -' 1 ) ) ) or R2 > ( Sum ( ( Width C24 ) | ( min (( Len C24 ) , R1) ) ) )) implies ( it * (R1 , R2) ) = C23) & ((( Sum ( ( Width C24 ) | ( ( min (( Len C24 ) , R1) ) -' 1 ) ) ) < R2 & R2 <= ( Sum ( ( Width C24 ) | ( min (( Len C24 ) , R1) ) ) )) implies ( it * (R1 , R2) ) = ( ( C24 . ( min (( Len C24 ) , R1) ) ) * (( R1 -' ( Sum ( ( Len C24 ) | ( ( min (( Len C24 ) , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( ( Width C24 ) | ( ( min (( Len C24 ) , R1) ) -' 1 ) ) ) )) )))))));
existence
proof
set D41 = ( Sum ( Width C24 ) );
set D42 = ( Sum ( Len C24 ) );
set D43 = ( Len C24 );
set D44 = ( Width C24 );
defpred S3[ Nat , Nat , (Element of R12) ] means ((($2 <= ( Sum ( D44 | ( ( min (D43 , $1) ) -' 1 ) ) ) or $2 > ( Sum ( D44 | ( min (D43 , $1) ) ) )) implies $3 = C23) & ((( Sum ( D44 | ( ( min (D43 , $1) ) -' 1 ) ) ) < $2 & $2 <= ( Sum ( D44 | ( min (D43 , $1) ) ) )) implies $3 = ( ( C24 . ( min (D43 , $1) ) ) * (( $1 -' ( Sum ( D43 | ( ( min (D43 , $1) ) -' 1 ) ) ) ) , ( $2 -' ( Sum ( D44 | ( ( min (D43 , $1) ) -' 1 ) ) ) )) )));
L538: (for R1 being Nat holds (for R2 being Nat holds ([ R1 , R2 ] in [: ( Seg D42 ) , ( Seg D41 ) :] implies (ex B13 being (Element of R12) st S3[ R1 , R2 , B13 ]))))
proof
let R1 being Nat;
let R2 being Nat;
assume that
L539: [ R1 , R2 ] in [: ( Seg D42 ) , ( Seg D41 ) :];
per cases ;
suppose L540: (R2 <= ( Sum ( D44 | ( ( min (D43 , R1) ) -' 1 ) ) ) or R2 > ( Sum ( D44 | ( min (D43 , R1) ) ) ));

take C23;
thus L541: thesis by L540;
end;
suppose L542: (( Sum ( D44 | ( ( min (D43 , R1) ) -' 1 ) ) ) < R2 & R2 <= ( Sum ( D44 | ( min (D43 , R1) ) ) ));

take ( ( C24 . ( min (D43 , R1) ) ) * (( R1 -' ( Sum ( D43 | ( ( min (D43 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D44 | ( ( min (D43 , R1) ) -' 1 ) ) ) )) );
thus L543: thesis by L542;
end;
end;
consider C25 being (Matrix of D42 , D41 , R12) such that L545: (for R1 being Nat holds (for R2 being Nat holds ([ R1 , R2 ] in ( Indices C25 ) implies S3[ R1 , R2 , ( C25 * (R1 , R2) ) ]))) from MATRIX_1:sch 2(L538);
take C25;
per cases ;
suppose L546: D42 = ( 0 );

L547: D41 = ( 0 ) by L546 , L419;
thus L548: thesis by L547 , L546 , MATRIX_1:22;
end;
suppose L549: D42 > ( 0 );

thus L550: thesis by L549 , L545 , MATRIX_1:23;
end;
end;
uniqueness
proof
set D45 = ( Width C24 );
set D46 = ( Len C24 );
let C26 , C27 being (Matrix of R12);
assume that
L552: ( len C26 ) = ( Sum D46 )
and
L553: ( width C26 ) = ( Sum D45 )
and
L554: (for R1 being Nat holds (for R2 being Nat holds ([ R1 , R2 ] in ( Indices C26 ) implies (((R2 <= ( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) or R2 > ( Sum ( D45 | ( min (D46 , R1) ) ) )) implies ( C26 * (R1 , R2) ) = C23) & ((( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) < R2 & R2 <= ( Sum ( D45 | ( min (D46 , R1) ) ) )) implies ( C26 * (R1 , R2) ) = ( ( C24 . ( min (D46 , R1) ) ) * (( R1 -' ( Sum ( D46 | ( ( min (D46 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) )) ))))))
and
L555: ( len C27 ) = ( Sum D46 )
and
L556: ( width C27 ) = ( Sum D45 )
and
L557: (for R1 being Nat holds (for R2 being Nat holds ([ R1 , R2 ] in ( Indices C27 ) implies (((R2 <= ( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) or R2 > ( Sum ( D45 | ( min (D46 , R1) ) ) )) implies ( C27 * (R1 , R2) ) = C23) & ((( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) < R2 & R2 <= ( Sum ( D45 | ( min (D46 , R1) ) ) )) implies ( C27 * (R1 , R2) ) = ( ( C24 . ( min (D46 , R1) ) ) * (( R1 -' ( Sum ( D46 | ( ( min (D46 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) )) ))))));
L558: ( Indices C26 ) = [: ( Seg ( len C26 ) ) , ( Seg ( width C26 ) ) :] by FINSEQ_1:def 3
.= ( Indices C27 ) by L552 , L553 , L555 , L556 , FINSEQ_1:def 3;
L559:
now
let R1 being Nat;
let R2 being Nat;
assume that
L560: [ R1 , R2 ] in ( Indices C26 );
L561: (R2 <= ( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) or R2 > ( Sum ( D45 | ( min (D46 , R1) ) ) ) or (( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) < R2 & R2 <= ( Sum ( D45 | ( min (D46 , R1) ) ) )));
L562: ((( C26 * (R1 , R2) ) = C23 & ( C27 * (R1 , R2) ) = C23) or (( C26 * (R1 , R2) ) = ( ( C24 . ( min (D46 , R1) ) ) * (( R1 -' ( Sum ( D46 | ( ( min (D46 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) )) ) & ( C27 * (R1 , R2) ) = ( ( C24 . ( min (D46 , R1) ) ) * (( R1 -' ( Sum ( D46 | ( ( min (D46 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D45 | ( ( min (D46 , R1) ) -' 1 ) ) ) )) ))) by L561 , L554 , L557 , L558 , L560;
thus L563: ( C26 * (R1 , R2) ) = ( C27 * (R1 , R2) ) by L562;
end;
thus L564: thesis by L559 , L552 , L553 , L555 , L556 , MATRIX_1:21;
end;
end;
definition
let R12 being non  empty set;
let C28 being (Element of R12);
let C29 being (FinSequence_of_Matrix of R12);
redefine func block_diagonal (C29 , C28) -> (Matrix of ( Sum ( Len C29 ) ) , ( Sum ( Width C29 ) ) , R12);

coherence
proof
L566: ( width ( block_diagonal (C29 , C28) ) ) = ( Sum ( Width C29 ) ) by L537;
L567: ( len ( block_diagonal (C29 , C28) ) ) = ( Sum ( Len C29 ) ) by L537;
thus L568: thesis by L567 , L566 , MATRIX_2:7;
end;
end;
theorem
L570: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for B14 being (FinSequence_of_Matrix of R12) holds (B14 = ( {} ) implies ( block_diagonal (B14 , R13) ) = ( {} )))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let C30 being (FinSequence_of_Matrix of R12);
assume L571: C30 = ( {} );
L572: ( len ( Len C30 ) ) = ( 0 ) by L571 , CARD_1:def 7;
L573: ( Len C30 ) = ( <*> ( REAL ) ) by L572;
L574: ( 0 ) = ( len ( block_diagonal (C30 , R13) ) ) by L573 , L537 , RVSUM_1:72;
thus L575: thesis by L574;
end;
theorem
L576: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R17 being (Matrix of R12) holds (for R18 being (Matrix of R12) holds (for B15 being (Matrix of ( Sum ( Len <* R17 , R18 *> ) ) , ( Sum ( Width <* R17 , R18 *> ) ) , R12) holds (B15 = ( block_diagonal (<* R17 , R18 *> , R13) ) iff (for R1 being Nat holds ((R1 in ( dom R17 ) implies ( Line (B15 , R1) ) = ( ( Line (R17 , R1) ) ^ ( ( width R18 ) |-> R13 ) )) & (R1 in ( dom R18 ) implies ( Line (B15 , ( R1 + ( len R17 ) )) ) = ( ( ( width R17 ) |-> R13 ) ^ ( Line (R18 , R1) ) ))))))))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R17 being (Matrix of R12);
let R18 being (Matrix of R12);
let C31 being (Matrix of ( Sum ( Len <* R17 , R18 *> ) ) , ( Sum ( Width <* R17 , R18 *> ) ) , R12);
set D47 = <* R17 *>;
set D48 = <* R18 *>;
set D49 = <* R17 , R18 *>;
set D50 = ( block_diagonal (D49 , R13) );
set D51 = ( len R17 );
set D52 = ( len R18 );
set D53 = ( width R17 );
set D54 = ( width R18 );
L577: ( Sum <* D53 *> ) = D53 by RVSUM_1:73;
L578: ( len D50 ) = ( Sum ( Len D49 ) ) by L537;
L579: ( len D50 ) = ( D51 + D52 ) by L578 , L475;
L580: ( len D49 ) = ( len ( Len D49 ) ) by CARD_1:def 7;
L581: ( ( Len D49 ) | ( 0 ) ) = ( <*> ( REAL ) );
L582: ( ( Width D49 ) | ( 0 ) ) = ( <*> ( REAL ) );
L583: ( 1 -' 1 ) = ( 0 ) by XREAL_1:232;
L584: ( width D50 ) = ( Sum ( Width D49 ) ) by L537;
L585: ( width D50 ) = ( D53 + D54 ) by L584 , L523;
L586: ( len <* D53 *> ) = 1 by FINSEQ_1:40;
L587: ( len D47 ) = 1 by FINSEQ_1:40;
L588: ( Len D47 ) = <* D51 *> by L464;
L589: ( Len D49 ) = ( ( Len D47 ) ^ ( Len D48 ) ) by L441;
L590: ( ( Len D49 ) . 1 ) = D51 by L589 , L588 , FINSEQ_1:41;
L591: ( len <* D51 *> ) = 1 by FINSEQ_1:40;
L592: ( ( Len D49 ) | 1 ) = <* D51 *> by L591 , L589 , L588 , FINSEQ_5:23;
L593: ( Width D47 ) = <* D53 *> by L512;
L594: ( Sum <* D51 *> ) = D51 by RVSUM_1:73;
L595: ( Width D49 ) = ( ( Width D47 ) ^ ( Width D48 ) ) by L489;
L596: ( ( Width D49 ) | 1 ) = <* D53 *> by L595 , L593 , L586 , FINSEQ_5:23;
L597: ( Len D48 ) = <* D52 *> by L464;
L598: ( len ( Len D49 ) ) = ( 1 + 1 ) by L597 , L589 , L588 , L591 , FINSEQ_2:16;
L599: ( ( Len D49 ) . 2 ) = D52 by L589 , L588 , L597 , L591 , FINSEQ_1:42;
L600: ( len ( Width D49 ) ) = ( len D49 ) by CARD_1:def 7;
L601: ( ( Width D49 ) | 2 ) = ( Width D49 ) by L600 , L598 , L580 , FINSEQ_1:58;
L602: ( dom ( Len D49 ) ) = { 1 , 2 } by L598 , FINSEQ_1:2 , FINSEQ_1:def 3;
L603: 1 in ( dom ( Len D49 ) ) by L602 , TARSKI:def 2;
L604: ( ( Len D49 ) /. 1 ) = ( ( Len D49 ) . 1 ) by L603 , PARTFUN1:def 6;
L605: ( 2 -' 1 ) = ( 2 - 1 ) by XREAL_1:233;
L606: (( Sum ( Len D49 ) ) = ( 0 ) implies ( Sum ( Width D49 ) ) = ( 0 )) by L419;
L607: ( width C31 ) = ( D53 + D54 ) by L606 , L584 , L585 , MATRIX13:1;
L608: 2 in ( dom ( Len D49 ) ) by L602 , TARSKI:def 2;
L609: ( ( Len D49 ) /. 2 ) = ( ( Len D49 ) . 2 ) by L608 , PARTFUN1:def 6;
thus L610:now
assume L611: C31 = D50;
let R1 being Nat;
thus L612: (R1 in ( dom R17 ) implies ( Line (C31 , R1) ) = ( ( Line (R17 , R1) ) ^ ( D54 |-> R13 ) ))
proof
set D55 = ( D54 |-> R13 );
set D56 = ( Line (R17 , R1) );
set D57 = ( Line (C31 , R1) );
L613: D51 <= ( D51 + D52 ) by NAT_1:11;
L614: ( len D56 ) = D53 by CARD_1:def 7;
assume L615: R1 in ( dom R17 );
L616: 1 <= R1 by L615 , FINSEQ_3:25;
L617: R1 <= D51 by L615 , FINSEQ_3:25;
L618: R1 <= ( D51 + D52 ) by L617 , L613 , XXREAL_0:2;
L619: R1 in ( dom D50 ) by L618 , L579 , L616 , FINSEQ_3:25;
L620: ( len D55 ) = D54 by CARD_1:def 7;
L621: ( len ( D56 ^ D55 ) ) = ( ( len D56 ) + ( len D55 ) ) by FINSEQ_1:22;
L622: ( len D57 ) = ( D53 + D54 ) by L607 , CARD_1:def 7;
L623: R1 in ( Seg D51 ) by L615 , FINSEQ_1:def 3;
L624:
now
L625: ( min (( Len D49 ) , ( R1 + ( 0 ) )) ) = 1 by L603 , L583 , L590 , L604 , L581 , L623 , L279 , RVSUM_1:72;
let R2 being Nat;
assume that
L626: 1 <= R2
and
L627: R2 <= ( len D57 );
L628: R2 in ( Seg ( width D50 ) ) by L585 , L622 , L626 , L627 , FINSEQ_1:1;
L629: [ R1 , R2 ] in ( Indices D50 ) by L628 , L619 , ZFMISC_1:87;
L630: R2 in ( dom ( D56 ^ D55 ) ) by L622 , L614 , L620 , L621 , L626 , L627 , FINSEQ_3:25;
L631:
now
per cases ;
suppose L632: R2 <= D53;

L633: R2 in ( Seg ( width R17 ) ) by L632 , L626 , FINSEQ_1:1;
L634: R2 in ( dom D56 ) by L614 , L626 , L632 , FINSEQ_3:25;
thus L635: ( D57 . R2 ) = ( C31 * (R1 , R2) ) by L585 , L607 , L628 , MATRIX_1:def 7
.= ( ( D49 . 1 ) * (( R1 -' ( Sum ( ( Len D49 ) | ( 0 ) ) ) ) , ( R2 -' ( Sum ( ( Width D49 ) | ( 0 ) ) ) )) ) by L577 , L583 , L596 , L611 , L626 , L629 , L625 , L632 , L537 , RVSUM_1:72
.= ( ( D49 . 1 ) * (R1 , ( R2 -' ( 0 ) )) ) by NAT_D:40 , RVSUM_1:72
.= ( ( D49 . 1 ) * (R1 , R2) ) by NAT_D:40
.= ( R17 * (R1 , R2) ) by FINSEQ_1:41
.= ( D56 . R2 ) by L633 , MATRIX_1:def 7
.= ( ( D56 ^ D55 ) . R2 ) by L634 , FINSEQ_1:def 7;
end;
suppose L636: R2 > D53;

L637: ( dom D55 ) = ( Seg D54 ) by L620 , FINSEQ_1:def 3;
L638: (not R2 in ( dom D56 )) by L614 , L636 , FINSEQ_3:25;
consider R5 being Nat such that L639: R5 in ( dom D55 ) and L640: R2 = ( ( len D56 ) + R5 ) by L638 , L630 , FINSEQ_1:25;
thus L641: ( D57 . R2 ) = ( C31 * (R1 , R2) ) by L585 , L607 , L628 , MATRIX_1:def 7
.= R13 by L577 , L596 , L611 , L629 , L625 , L636 , L537
.= ( D55 . R5 ) by L639 , L637 , FINSEQ_2:57
.= ( ( D56 ^ D55 ) . R2 ) by L639 , L640 , FINSEQ_1:def 7;
end;
end;
thus L643: ( D57 . R2 ) = ( ( D56 ^ D55 ) . R2 ) by L631;
end;
thus L644: thesis by L624 , L622 , L614 , L620 , L621 , FINSEQ_1:14;
end;

thus L645: (R1 in ( dom R18 ) implies ( Line (C31 , ( R1 + D51 )) ) = ( ( D53 |-> R13 ) ^ ( Line (R18 , R1) ) ))
proof
set D58 = ( Line (R18 , R1) );
set D59 = ( D53 |-> R13 );
set D60 = ( Line (C31 , ( R1 + D51 )) );
L646: ( len D58 ) = D54 by CARD_1:def 7;
L647: ( len ( D59 ^ D58 ) ) = ( ( len D59 ) + ( len D58 ) ) by FINSEQ_1:22;
L648: ( len D59 ) = D53 by CARD_1:def 7;
L649: ( len D60 ) = ( D53 + D54 ) by L607 , CARD_1:def 7;
assume L650: R1 in ( dom R18 );
L651: R1 in ( Seg D52 ) by L650 , FINSEQ_1:def 3;
L652: ( D51 + R1 ) in ( Seg ( D51 + D52 ) ) by L651 , FINSEQ_1:60;
L653: ( D51 + R1 ) in ( dom D50 ) by L652 , L579 , FINSEQ_1:def 3;
L654:
now
L655: ( min (( Len D49 ) , ( R1 + D51 )) ) = 2 by L594 , L608 , L605 , L599 , L609 , L592 , L651 , L279;
let R2 being Nat;
assume that
L656: 1 <= R2
and
L657: R2 <= ( len D60 );
L658: R2 in ( Seg ( width D50 ) ) by L585 , L649 , L656 , L657 , FINSEQ_1:1;
L659: [ ( R1 + D51 ) , R2 ] in ( Indices D50 ) by L658 , L653 , ZFMISC_1:87;
L660: R2 in ( dom ( D59 ^ D58 ) ) by L649 , L646 , L648 , L647 , L656 , L657 , FINSEQ_3:25;
L661:
now
per cases ;
suppose L662: R2 <= D53;

L663: ( dom D59 ) = ( Seg D53 ) by L648 , FINSEQ_1:def 3;
L664: R2 in ( Seg D53 ) by L656 , L662 , FINSEQ_1:1;
thus L665: ( D60 . R2 ) = ( D50 * (( R1 + D51 ) , R2) ) by L611 , L658 , MATRIX_1:def 7
.= R13 by L577 , L605 , L596 , L659 , L655 , L662 , L537
.= ( D59 . R2 ) by L664 , FINSEQ_2:57
.= ( ( D59 ^ D58 ) . R2 ) by L664 , L663 , FINSEQ_1:def 7;
end;
suppose L666: R2 > D53;

L667: ( dom D58 ) = ( Seg D54 ) by L646 , FINSEQ_1:def 3;
L668: (not R2 in ( dom D59 )) by L648 , L666 , FINSEQ_3:25;
consider R5 being Nat such that L669: R5 in ( dom D58 ) and L670: R2 = ( D53 + R5 ) by L668 , L648 , L660 , FINSEQ_1:25;
thus L671: ( D60 . R2 ) = ( D50 * (( R1 + D51 ) , R2) ) by L611 , L658 , MATRIX_1:def 7
.= ( ( D49 . 2 ) * (( ( R1 + D51 ) -' D51 ) , ( R2 -' D53 )) ) by L584 , L585 , L577 , L594 , L605 , L592 , L596 , L601 , L649 , L657 , L659 , L655 , L666 , L537
.= ( ( D49 . 2 ) * (R1 , ( R2 -' D53 )) ) by NAT_D:34
.= ( ( D49 . ( ( len D47 ) + 1 ) ) * (R1 , R5) ) by L587 , L670 , NAT_D:34
.= ( R18 * (R1 , R5) ) by FINSEQ_1:42
.= ( D58 . R5 ) by L669 , L667 , MATRIX_1:def 7
.= ( ( D59 ^ D58 ) . R2 ) by L648 , L669 , L670 , FINSEQ_1:def 7;
end;
end;
thus L673: ( D60 . R2 ) = ( ( D59 ^ D58 ) . R2 ) by L661;
end;
thus L674: thesis by L654 , L649 , L646 , L648 , L647 , FINSEQ_1:14;
end;

end;
assume L646: (for R1 being Nat holds ((R1 in ( dom R17 ) implies ( Line (C31 , R1) ) = ( ( Line (R17 , R1) ) ^ ( D54 |-> R13 ) )) & (R1 in ( dom R18 ) implies ( Line (C31 , ( R1 + D51 )) ) = ( ( D53 |-> R13 ) ^ ( Line (R18 , R1) ) ))));
L647: ( Sum ( ( Width D49 ) | 2 ) ) = ( D53 + D54 ) by L601 , L523;
L648:
now
set D61 = ( D53 |-> R13 );
set D62 = ( D54 |-> R13 );
L649: ( Indices C31 ) = ( Indices D50 ) by MATRIX_1:26;
let R1 being Nat;
let R2 being Nat;
assume that
L650: [ R1 , R2 ] in ( Indices C31 );
L651: R1 in ( dom D50 ) by L650 , L649 , ZFMISC_1:87;
L652: 1 <= R1 by L651 , FINSEQ_3:25;
L653: R2 in ( Seg ( width D50 ) ) by L650 , L649 , ZFMISC_1:87;
L654: 1 <= R2 by L653 , FINSEQ_1:1;
L655: R1 in ( Seg ( D51 + D52 ) ) by L579 , L651 , FINSEQ_1:def 3;
set D63 = ( Line (R17 , R1) );
L656: ( len D63 ) = D53 by CARD_1:def 7;
L657: ( len D61 ) = D53 by CARD_1:def 7;
L658: ( len D62 ) = D54 by CARD_1:def 7;
L659: ( len ( D63 ^ D62 ) ) = ( ( len D63 ) + ( len D62 ) ) by FINSEQ_1:22;
L660: R2 <= ( width D50 ) by L653 , FINSEQ_1:1;
L661:
now
per cases ;
suppose L662: R1 <= D51;

L663: R1 in ( Seg D51 ) by L662 , L651 , L652;
L664: ( min (( Len D49 ) , ( R1 + ( 0 ) )) ) = 1 by L663 , L603 , L583 , L590 , L604 , L581 , L279 , RVSUM_1:72;
L665:
now
per cases ;
suppose L666: R2 <= D53;

L667: R2 in ( Seg ( width R17 ) ) by L666 , L654 , FINSEQ_1:1;
L668: R2 in ( dom D63 ) by L654 , L656 , L666 , FINSEQ_3:25;
thus L669: ( D50 * (R1 , R2) ) = ( ( D49 . 1 ) * (( R1 -' ( 0 ) ) , ( R2 -' ( 0 ) )) ) by L577 , L583 , L581 , L582 , L596 , L650 , L649 , L654 , L664 , L666 , L537 , RVSUM_1:72
.= ( ( D49 . 1 ) * (R1 , ( R2 -' ( 0 ) )) ) by NAT_D:40
.= ( ( D49 . 1 ) * (R1 , R2) ) by NAT_D:40
.= ( R17 * (R1 , R2) ) by FINSEQ_1:41
.= ( D63 . R2 ) by L667 , MATRIX_1:def 7
.= ( ( D63 ^ D62 ) . R2 ) by L668 , FINSEQ_1:def 7;
end;
suppose L670: R2 > D53;

L671: (not R2 in ( dom D63 )) by L670 , L656 , FINSEQ_3:25;
L672: ( dom D62 ) = ( Seg D54 ) by L658 , FINSEQ_1:def 3;
L673: ( dom ( D63 ^ D62 ) ) = ( Seg ( width D50 ) ) by L585 , L656 , L658 , L659 , FINSEQ_1:def 3;
consider R5 being Nat such that L674: R5 in ( dom D62 ) and L675: R2 = ( ( len D63 ) + R5 ) by L673 , L653 , L671 , FINSEQ_1:25;
thus L676: ( D50 * (R1 , R2) ) = R13 by L577 , L596 , L650 , L649 , L664 , L670 , L537
.= ( D62 . R5 ) by L674 , L672 , FINSEQ_2:57
.= ( ( D63 ^ D62 ) . R2 ) by L674 , L675 , FINSEQ_1:def 7;
end;
end;
L678: R1 in ( dom R17 ) by L652 , L662 , FINSEQ_3:25;
L679: ( Line (C31 , R1) ) = ( D63 ^ D62 ) by L678 , L646;
thus L680: ( C31 * (R1 , R2) ) = ( D50 * (R1 , R2) ) by L679 , L585 , L607 , L653 , L665 , MATRIX_1:def 7;
end;
suppose L681: R1 > D51;

reconsider D64 = ( R1 - D51 ) as (Element of ( NAT )) by L681 , NAT_1:21;
L682: D64 <> ( 0 ) by L681;
set D65 = ( Line (R18 , D64) );
L683: R1 = ( D64 + D51 );
L684: D64 in ( Seg D52 ) by L683 , L655 , L682 , FINSEQ_1:61;
L685: ( min (( Len D49 ) , ( D64 + D51 )) ) = 2 by L684 , L594 , L608 , L605 , L599 , L609 , L592 , L279;
L686:
now
per cases ;
suppose L687: R2 <= D53;

L688: R2 in ( Seg D53 ) by L687 , L654 , FINSEQ_1:1;
L689: R2 in ( dom D61 ) by L654 , L657 , L687 , FINSEQ_3:25;
thus L690: ( D50 * (R1 , R2) ) = R13 by L577 , L605 , L596 , L650 , L649 , L685 , L687 , L537
.= ( D61 . R2 ) by L688 , FINSEQ_2:57
.= ( ( D61 ^ D65 ) . R2 ) by L689 , FINSEQ_1:def 7;
end;
suppose L691: R2 > D53;

L692: ( len D65 ) = D54 by MATRIX_1:def 7;
L693: ( dom D62 ) = ( dom D65 ) by L692 , L658 , FINSEQ_3:29;
L694: (not R2 in ( dom D63 )) by L656 , L691 , FINSEQ_3:25;
L695: ( dom D62 ) = ( Seg D54 ) by L658 , FINSEQ_1:def 3;
L696: ( dom ( D63 ^ D62 ) ) = ( Seg ( width D50 ) ) by L585 , L656 , L658 , L659 , FINSEQ_1:def 3;
consider R5 being Nat such that L697: R5 in ( dom D62 ) and L698: R2 = ( D53 + R5 ) by L696 , L653 , L656 , L694 , FINSEQ_1:25;
thus L699: ( D50 * (R1 , R2) ) = ( ( D49 . 2 ) * (( ( D64 + D51 ) -' D51 ) , ( R2 -' D53 )) ) by L585 , L577 , L594 , L605 , L592 , L596 , L647 , L650 , L649 , L660 , L685 , L691 , L537
.= ( ( D49 . 2 ) * (D64 , ( R2 -' D53 )) ) by NAT_D:34
.= ( ( D49 . ( ( len D47 ) + 1 ) ) * (D64 , R5) ) by L587 , L698 , NAT_D:34
.= ( R18 * (D64 , R5) ) by FINSEQ_1:42
.= ( D65 . R5 ) by L697 , L695 , MATRIX_1:def 7
.= ( ( D61 ^ D65 ) . R2 ) by L657 , L697 , L698 , L693 , FINSEQ_1:def 7;
end;
end;
L701: ( Seg D52 ) = ( dom R18 ) by FINSEQ_1:def 3;
L702: ( Line (C31 , ( D64 + D51 )) ) = ( ( D53 |-> R13 ) ^ ( Line (R18 , D64) ) ) by L701 , L646 , L655 , L682 , FINSEQ_1:61;
thus L703: ( C31 * (R1 , R2) ) = ( D50 * (R1 , R2) ) by L702 , L585 , L607 , L653 , L686 , MATRIX_1:def 7;
end;
end;
thus L705: ( C31 * (R1 , R2) ) = ( D50 * (R1 , R2) ) by L661;
end;
thus L706: thesis by L648 , MATRIX_1:27;
end;
theorem
L707: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R17 being (Matrix of R12) holds (for R18 being (Matrix of R12) holds (for B16 being (Matrix of ( Sum ( Len <* R17 , R18 *> ) ) , ( Sum ( Width <* R17 , R18 *> ) ) , R12) holds (B16 = ( block_diagonal (<* R17 , R18 *> , R13) ) iff (for R1 being Nat holds ((R1 in ( Seg ( width R17 ) ) implies ( Col (B16 , R1) ) = ( ( Col (R17 , R1) ) ^ ( ( len R18 ) |-> R13 ) )) & (R1 in ( Seg ( width R18 ) ) implies ( Col (B16 , ( R1 + ( width R17 ) )) ) = ( ( ( len R17 ) |-> R13 ) ^ ( Col (R18 , R1) ) ))))))))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R17 being (Matrix of R12);
let R18 being (Matrix of R12);
let C32 being (Matrix of ( Sum ( Len <* R17 , R18 *> ) ) , ( Sum ( Width <* R17 , R18 *> ) ) , R12);
set D66 = <* R17 , R18 *>;
set D67 = ( block_diagonal (D66 , R13) );
L708: ( Seg ( len C32 ) ) = ( dom C32 ) by FINSEQ_1:def 3;
L709: ( Seg ( len R17 ) ) = ( dom R17 ) by FINSEQ_1:def 3;
L710: ( dom R18 ) = ( Seg ( len R18 ) ) by FINSEQ_1:def 3;
L711: ( Sum ( Len D66 ) ) = ( ( len R17 ) + ( len R18 ) ) by L475;
L712: (( Sum ( Len D66 ) ) = ( 0 ) implies ( Sum ( Width D66 ) ) = ( 0 )) by L419;
L713: ( len C32 ) = ( Sum ( Len D66 ) ) by L712 , MATRIX13:1;
L714: ( width C32 ) = ( Sum ( Width D66 ) ) by L712 , MATRIX13:1;
L715: ( Sum ( Width D66 ) ) = ( ( width R17 ) + ( width R18 ) ) by L523;
L716: ( width R17 ) <= ( width C32 ) by L715 , L714 , NAT_1:12;
L717: ( Seg ( width R17 ) ) c= ( Seg ( width C32 ) ) by L716 , FINSEQ_1:5;
thus L718: (C32 = D67 implies (for R1 being Nat holds ((R1 in ( Seg ( width R17 ) ) implies ( Col (C32 , R1) ) = ( ( Col (R17 , R1) ) ^ ( ( len R18 ) |-> R13 ) )) & (R1 in ( Seg ( width R18 ) ) implies ( Col (C32 , ( R1 + ( width R17 ) )) ) = ( ( ( len R17 ) |-> R13 ) ^ ( Col (R18 , R1) ) )))))
proof
L719: ( dom ( ( width R18 ) |-> R13 ) ) = ( Seg ( width R18 ) ) by FINSEQ_2:124;
L720: ( dom ( ( width R17 ) |-> R13 ) ) = ( Seg ( width R17 ) ) by FINSEQ_2:124;
set D68 = ( ( len R18 ) |-> R13 );
set D69 = ( ( len R17 ) |-> R13 );
assume L721: C32 = D67;
let R1 being Nat;
set D70 = ( Col (C32 , R1) );
set D71 = ( Col (R17 , R1) );
L722: ( len D70 ) = ( len C32 ) by CARD_1:def 7;
L723: ( dom D69 ) = ( Seg ( len R17 ) ) by FINSEQ_2:124;
L724: ( dom D68 ) = ( Seg ( len R18 ) ) by FINSEQ_2:124;
L725: ( len D71 ) = ( len R17 ) by CARD_1:def 7;
L726: ( dom D71 ) = ( dom R17 ) by L725 , FINSEQ_3:29;
L727: ( len D68 ) = ( len R18 ) by CARD_1:def 7;
L728: ( dom D68 ) = ( dom R18 ) by L727 , FINSEQ_3:29;
thus L729: (R1 in ( Seg ( width R17 ) ) implies D70 = ( D71 ^ D68 ))
proof
assume L730: R1 in ( Seg ( width R17 ) );
L731: ( len ( D71 ^ D68 ) ) = ( ( len D71 ) + ( len D68 ) ) by FINSEQ_1:22;
L732:
now
let R2 being Nat;
assume that
L733: 1 <= R2
and
L734: R2 <= ( len D70 );
L735: R2 in ( dom C32 ) by L722 , L733 , L734 , FINSEQ_3:25;
L736: ( D70 . R2 ) = ( ( Line (C32 , R2) ) . R1 ) by L735 , L717 , L730 , GOBOARD1:2;
L737: ( dom ( Line (R17 , R2) ) ) = ( Seg ( width R17 ) ) by FINSEQ_2:124;
L738: R2 in ( dom ( D71 ^ D68 ) ) by L713 , L711 , L722 , L725 , L727 , L731 , L733 , L734 , FINSEQ_3:25;
L739:
now
per cases  by L738 , FINSEQ_1:25;
suppose L740: R2 in ( dom D71 );

thus L741: ( D70 . R2 ) = ( ( ( Line (R17 , R2) ) ^ ( ( width R18 ) |-> R13 ) ) . R1 ) by L740 , L721 , L726 , L736 , L576
.= ( ( Line (R17 , R2) ) . R1 ) by L730 , L737 , FINSEQ_1:def 7
.= ( D71 . R2 ) by L726 , L730 , L740 , GOBOARD1:2
.= ( ( D71 ^ D68 ) . R2 ) by L740 , FINSEQ_1:def 7;
end;
suppose L742: (ex R5 being Nat st (R5 in ( dom D68 ) & R2 = ( ( len D71 ) + R5 )));

consider R5 being Nat such that L743: R5 in ( dom D68 ) and L744: R2 = ( ( len D71 ) + R5 ) by L742;
thus L745: ( D70 . R2 ) = ( ( ( ( width R17 ) |-> R13 ) ^ ( Line (R18 , R5) ) ) . R1 ) by L721 , L725 , L728 , L736 , L743 , L744 , L576
.= ( ( ( width R17 ) |-> R13 ) . R1 ) by L720 , L730 , FINSEQ_1:def 7
.= R13 by L730 , FINSEQ_2:57
.= ( D68 . R5 ) by L724 , L743 , FINSEQ_2:57
.= ( ( D71 ^ D68 ) . R2 ) by L743 , L744 , FINSEQ_1:def 7;
end;
end;
thus L747: ( ( D71 ^ D68 ) . R2 ) = ( D70 . R2 ) by L739;
end;
thus L748: thesis by L732 , L713 , L722 , L725 , L727 , L731 , L475 , FINSEQ_1:14;
end;

set D72 = ( Col (R18 , R1) );
set D73 = ( Col (C32 , ( R1 + ( width R17 ) )) );
L749: ( len D73 ) = ( len C32 ) by CARD_1:def 7;
L750: ( len D72 ) = ( len R18 ) by CARD_1:def 7;
L751: ( dom D72 ) = ( dom R18 ) by L750 , FINSEQ_3:29;
L752: ( len ( D69 ^ D72 ) ) = ( ( len D69 ) + ( len D72 ) ) by FINSEQ_1:22;
assume L753: R1 in ( Seg ( width R18 ) );
L754: ( len D69 ) = ( len R17 ) by CARD_1:def 7;
L755: ( dom D69 ) = ( dom R17 ) by L754 , FINSEQ_3:29;
L756:
now
L757: ( len ( ( width R17 ) |-> R13 ) ) = ( width R17 ) by CARD_1:def 7;
let R2 being Nat;
assume that
L758: 1 <= R2
and
L759: R2 <= ( len D73 );
L760: R2 in ( dom C32 ) by L749 , L758 , L759 , FINSEQ_3:25;
L761: ( R1 + ( width R17 ) ) in ( Seg ( width C32 ) ) by L714 , L715 , L753 , FINSEQ_1:60;
L762: ( D73 . R2 ) = ( ( Line (C32 , R2) ) . ( R1 + ( width R17 ) ) ) by L761 , L760 , GOBOARD1:2;
L763: ( len ( Line (R17 , R2) ) ) = ( width R17 ) by CARD_1:def 7;
L764: R2 in ( dom ( D69 ^ D72 ) ) by L713 , L711 , L749 , L750 , L754 , L752 , L758 , L759 , FINSEQ_3:25;
L765:
now
per cases  by L764 , FINSEQ_1:25;
suppose L766: R2 in ( dom D69 );

thus L767: ( D73 . R2 ) = ( ( ( Line (R17 , R2) ) ^ ( ( width R18 ) |-> R13 ) ) . ( R1 + ( width R17 ) ) ) by L766 , L721 , L755 , L762 , L576
.= ( ( ( width R18 ) |-> R13 ) . R1 ) by L719 , L753 , L763 , FINSEQ_1:def 7
.= R13 by L753 , FINSEQ_2:57
.= ( D69 . R2 ) by L723 , L766 , FINSEQ_2:57
.= ( ( D69 ^ D72 ) . R2 ) by L766 , FINSEQ_1:def 7;
end;
suppose L768: (ex R5 being Nat st (R5 in ( dom D72 ) & R2 = ( ( len D69 ) + R5 )));

consider R5 being Nat such that L769: R5 in ( dom D72 ) and L770: R2 = ( ( len D69 ) + R5 ) by L768;
L771: ( dom ( Line (R18 , R5) ) ) = ( Seg ( width R18 ) ) by FINSEQ_2:124;
thus L772: ( D73 . R2 ) = ( ( ( ( width R17 ) |-> R13 ) ^ ( Line (R18 , R5) ) ) . ( R1 + ( width R17 ) ) ) by L721 , L754 , L751 , L762 , L769 , L770 , L576
.= ( ( Line (R18 , R5) ) . R1 ) by L753 , L757 , L771 , FINSEQ_1:def 7
.= ( D72 . R5 ) by L751 , L753 , L769 , GOBOARD1:2
.= ( ( D69 ^ D72 ) . R2 ) by L769 , L770 , FINSEQ_1:def 7;
end;
end;
thus L774: ( ( D69 ^ D72 ) . R2 ) = ( D73 . R2 ) by L765;
end;
thus L775: thesis by L756 , L713 , L749 , L750 , L754 , L752 , L475 , FINSEQ_1:14;
end;

assume L776: (for R1 being Nat holds ((R1 in ( Seg ( width R17 ) ) implies ( Col (C32 , R1) ) = ( ( Col (R17 , R1) ) ^ ( ( len R18 ) |-> R13 ) )) & (R1 in ( Seg ( width R18 ) ) implies ( Col (C32 , ( R1 + ( width R17 ) )) ) = ( ( ( len R17 ) |-> R13 ) ^ ( Col (R18 , R1) ) ))));
L777: ( len R17 ) <= ( len C32 ) by L713 , L711 , NAT_1:12;
L778: ( Seg ( len R17 ) ) c= ( Seg ( len C32 ) ) by L777 , FINSEQ_1:5;
L779:
now
set D74 = ( ( width R18 ) |-> R13 );
set D75 = ( ( width R17 ) |-> R13 );
let R1 being Nat;
set D76 = ( Line (C32 , R1) );
set D77 = ( Line (C32 , ( R1 + ( len R17 ) )) );
set D78 = ( Line (R17 , R1) );
set D79 = ( Line (R18 , R1) );
L780: ( len D77 ) = ( width C32 ) by CARD_1:def 7;
L781: ( len D74 ) = ( width R18 ) by CARD_1:def 7;
L782: ( dom D74 ) = ( Seg ( width R18 ) ) by L781 , FINSEQ_1:def 3;
L783: ( len D76 ) = ( width C32 ) by CARD_1:def 7;
L784: ( dom D76 ) = ( Seg ( width C32 ) ) by L783 , FINSEQ_1:def 3;
L785: ( len D78 ) = ( width R17 ) by CARD_1:def 7;
L786: ( dom D78 ) = ( Seg ( width R17 ) ) by L785 , FINSEQ_1:def 3;
thus L787: (R1 in ( dom R17 ) implies D76 = ( D78 ^ D74 ))
proof
assume L788: R1 in ( dom R17 );
L789: ( len ( D78 ^ D74 ) ) = ( ( len D78 ) + ( len D74 ) ) by FINSEQ_1:22;
L790:
now
L791: ( dom ( ( len R17 ) |-> R13 ) ) = ( Seg ( len R17 ) ) by FINSEQ_2:124;
let R2 being Nat;
assume that
L792: 1 <= R2
and
L793: R2 <= ( len D76 );
L794: R2 in ( Seg ( width C32 ) ) by L784 , L792 , L793 , FINSEQ_3:25;
L795: ( D76 . R2 ) = ( ( Col (C32 , R2) ) . R1 ) by L794 , L778 , L708 , L709 , L788 , GOBOARD1:2;
L796: ( dom ( Col (R17 , R2) ) ) = ( Seg ( len R17 ) ) by FINSEQ_2:124;
L797: R2 in ( dom ( D78 ^ D74 ) ) by L714 , L715 , L783 , L785 , L781 , L789 , L792 , L793 , FINSEQ_3:25;
L798:
now
per cases  by L797 , FINSEQ_1:25;
suppose L799: R2 in ( dom D78 );

thus L800: ( D76 . R2 ) = ( ( ( Col (R17 , R2) ) ^ ( ( len R18 ) |-> R13 ) ) . R1 ) by L799 , L776 , L786 , L795
.= ( ( Col (R17 , R2) ) . R1 ) by L709 , L788 , L796 , FINSEQ_1:def 7
.= ( D78 . R2 ) by L786 , L788 , L799 , GOBOARD1:2
.= ( ( D78 ^ D74 ) . R2 ) by L799 , FINSEQ_1:def 7;
end;
suppose L801: (ex R4 being Nat st (R4 in ( dom D74 ) & R2 = ( ( len D78 ) + R4 )));

consider R4 being Nat such that L802: R4 in ( dom D74 ) and L803: R2 = ( ( len D78 ) + R4 ) by L801;
thus L804: ( D76 . R2 ) = ( ( ( ( len R17 ) |-> R13 ) ^ ( Col (R18 , R4) ) ) . R1 ) by L776 , L785 , L782 , L795 , L802 , L803
.= ( ( ( len R17 ) |-> R13 ) . R1 ) by L709 , L788 , L791 , FINSEQ_1:def 7
.= R13 by L709 , L788 , FINSEQ_2:57
.= ( D74 . R4 ) by L782 , L802 , FINSEQ_2:57
.= ( ( D78 ^ D74 ) . R2 ) by L802 , L803 , FINSEQ_1:def 7;
end;
end;
thus L806: ( D76 . R2 ) = ( ( D78 ^ D74 ) . R2 ) by L798;
end;
thus L807: thesis by L790 , L714 , L783 , L785 , L781 , L789 , L523 , FINSEQ_1:14;
end;

L808: ( len D79 ) = ( width R18 ) by CARD_1:def 7;
L809: ( dom D79 ) = ( Seg ( width R18 ) ) by L808 , FINSEQ_1:def 3;
L810: ( len D75 ) = ( width R17 ) by CARD_1:def 7;
L811: ( dom D75 ) = ( Seg ( width R17 ) ) by L810 , FINSEQ_1:def 3;
thus L812: (R1 in ( dom R18 ) implies D77 = ( D75 ^ D79 ))
proof
assume L813: R1 in ( dom R18 );
L814: ( len ( D75 ^ D79 ) ) = ( ( len D75 ) + ( len D79 ) ) by FINSEQ_1:22;
L815:
now
L816: ( len ( ( len R17 ) |-> R13 ) ) = ( len R17 ) by CARD_1:def 7;
L817: ( dom ( ( len R18 ) |-> R13 ) ) = ( Seg ( len R18 ) ) by FINSEQ_2:124;
L818: ( dom R18 ) = ( Seg ( len R18 ) ) by FINSEQ_1:def 3;
let R2 being Nat;
assume that
L819: 1 <= R2
and
L820: R2 <= ( len D77 );
L821: R2 in ( Seg ( width C32 ) ) by L783 , L780 , L784 , L819 , L820 , FINSEQ_3:25;
L822: ( D77 . R2 ) = ( ( Col (C32 , R2) ) . ( R1 + ( len R17 ) ) ) by L821 , L713 , L711 , L708 , L813 , L818 , FINSEQ_1:60 , GOBOARD1:2;
L823: ( len ( Col (R17 , R2) ) ) = ( len R17 ) by CARD_1:def 7;
L824: R2 in ( dom ( D75 ^ D79 ) ) by L714 , L715 , L780 , L808 , L810 , L814 , L819 , L820 , FINSEQ_3:25;
L825:
now
per cases  by L824 , FINSEQ_1:25;
suppose L826: R2 in ( dom D75 );

thus L827: ( D77 . R2 ) = ( ( ( Col (R17 , R2) ) ^ ( ( len R18 ) |-> R13 ) ) . ( R1 + ( len R17 ) ) ) by L826 , L776 , L811 , L822
.= ( ( ( len R18 ) |-> R13 ) . R1 ) by L710 , L813 , L823 , L817 , FINSEQ_1:def 7
.= R13 by L710 , L813 , FINSEQ_2:57
.= ( D75 . R2 ) by L811 , L826 , FINSEQ_2:57
.= ( ( D75 ^ D79 ) . R2 ) by L826 , FINSEQ_1:def 7;
end;
suppose L828: (ex R4 being Nat st (R4 in ( dom D79 ) & R2 = ( ( len D75 ) + R4 )));

consider R4 being Nat such that L829: R4 in ( dom D79 ) and L830: R2 = ( ( len D75 ) + R4 ) by L828;
L831: ( dom ( Col (R18 , R4) ) ) = ( Seg ( len R18 ) ) by FINSEQ_2:124;
thus L832: ( D77 . R2 ) = ( ( ( ( len R17 ) |-> R13 ) ^ ( Col (R18 , R4) ) ) . ( R1 + ( len R17 ) ) ) by L776 , L810 , L809 , L822 , L829 , L830
.= ( ( Col (R18 , R4) ) . R1 ) by L710 , L813 , L816 , L831 , FINSEQ_1:def 7
.= ( D79 . R4 ) by L809 , L813 , L829 , GOBOARD1:2
.= ( ( D75 ^ D79 ) . R2 ) by L829 , L830 , FINSEQ_1:def 7;
end;
end;
thus L834: ( D77 . R2 ) = ( ( D75 ^ D79 ) . R2 ) by L825;
end;
thus L835: thesis by L815 , L714 , L780 , L808 , L810 , L814 , L523 , FINSEQ_1:14;
end;

end;
thus L813: thesis by L779 , L576;
end;
theorem
L814: (for R12 being non  empty set holds (for R14 being (Element of R12) holds (for R15 being (Element of R12) holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds ( Indices ( block_diagonal (R27 , R14) ) ) is (Subset of ( Indices ( block_diagonal (( R27 ^ R28 ) , R15) ) )))))))
proof
let R12 being non  empty set;
let R14 being (Element of R12);
let R15 being (Element of R12);
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D80 = ( block_diagonal (R27 , R14) );
set D81 = ( block_diagonal (( R27 ^ R28 ) , R15) );
L815: ( Indices D80 ) c= ( Indices D81 )
proof
L816: ( ( Len R27 ) ^ ( Len R28 ) ) = ( Len ( R27 ^ R28 ) ) by L441;
L817: ( ( Sum ( Len R27 ) ) + ( Sum ( Len R28 ) ) ) = ( Sum ( Len ( R27 ^ R28 ) ) ) by L816 , RVSUM_1:75;
L818: ( ( 0 ) + ( Sum ( Len R27 ) ) ) <= ( Sum ( Len ( R27 ^ R28 ) ) ) by L817 , XREAL_1:6;
L819: ( Seg ( Sum ( Len R27 ) ) ) c= ( Seg ( Sum ( Len ( R27 ^ R28 ) ) ) ) by L818 , FINSEQ_1:5;
L820: ( dom D81 ) = ( Seg ( len D81 ) ) by FINSEQ_1:def 3;
L821: ( ( Width R27 ) ^ ( Width R28 ) ) = ( Width ( R27 ^ R28 ) ) by L489;
L822: ( ( Sum ( Width R27 ) ) + ( Sum ( Width R28 ) ) ) = ( Sum ( Width ( R27 ^ R28 ) ) ) by L821 , RVSUM_1:75;
L823: ( ( 0 ) + ( Sum ( Width R27 ) ) ) <= ( Sum ( Width ( R27 ^ R28 ) ) ) by L822 , XREAL_1:6;
L824: ( Seg ( Sum ( Width R27 ) ) ) c= ( Seg ( Sum ( Width ( R27 ^ R28 ) ) ) ) by L823 , FINSEQ_1:5;
L825: ( len D80 ) = ( Sum ( Len R27 ) ) by L537;
let R6 being set;
assume L826: R6 in ( Indices D80 );
L827: (ex B17 , B18 being set st (B17 in ( dom D80 ) & B18 in ( Seg ( width D80 ) ) & R6 = [ B17 , B18 ])) by L826 , ZFMISC_1:def 2;
L828: ( dom D80 ) = ( Seg ( len D80 ) ) by FINSEQ_1:def 3;
L829: ( width D80 ) = ( Sum ( Width R27 ) ) by L537;
L830: ( width D81 ) = ( Sum ( Width ( R27 ^ R28 ) ) ) by L537;
L831: ( len D81 ) = ( Sum ( Len ( R27 ^ R28 ) ) ) by L537;
thus L832: thesis by L831 , L827 , L828 , L820 , L825 , L830 , L829 , L819 , L824 , ZFMISC_1:87;
end;
thus L833: thesis by L815;
end;
theorem
L834: (for R1 being Nat holds (for R2 being Nat holds (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds ([ R1 , R2 ] in ( Indices ( block_diagonal (R27 , R13) ) ) implies ( ( block_diagonal (R27 , R13) ) * (R1 , R2) ) = ( ( block_diagonal (( R27 ^ R28 ) , R13) ) * (R1 , R2) ))))))))
proof
let R1 being Nat;
let R2 being Nat;
let R12 being non  empty set;
let R13 being (Element of R12);
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D82 = ( block_diagonal (R27 , R13) );
set D83 = ( Len R27 );
set D84 = ( Width R27 );
set D85 = ( Len R28 );
set D86 = ( Width R28 );
set D87 = ( R27 ^ R28 );
set D88 = ( Len D87 );
set D89 = ( Width D87 );
set D90 = ( block_diagonal (D87 , R13) );
L835: ( len R27 ) = ( len D84 ) by CARD_1:def 7;
L836: ( len D82 ) = ( Sum D83 ) by L537;
assume L837: [ R1 , R2 ] in ( Indices ( block_diagonal (R27 , R13) ) );
L838: R1 in ( dom D82 ) by L837 , ZFMISC_1:87;
L839: R1 in ( Seg ( len D82 ) ) by L838 , FINSEQ_1:def 3;
L840: ( min (D83 , R1) ) in ( dom D83 ) by L839 , L836 , L179;
L841: ( min (D83 , R1) ) <= ( len D83 ) by L840 , FINSEQ_3:25;
L842: ( D83 ^ D85 ) = D88 by L441;
L843: ( min (D83 , R1) ) = ( min (D88 , R1) ) by L842 , L839 , L836 , L230;
L844: ( dom D83 ) = ( dom R27 ) by L387;
L845: ( D84 ^ D86 ) = D89 by L489;
L846: ( D83 ^ D85 ) = D88 by L441;
L847: ( Indices D82 ) is (Subset of ( Indices D90 )) by L814;
L848: ( len D83 ) = ( len R27 ) by CARD_1:def 7;
L849: ( ( D84 ^ D86 ) | ( min (D88 , R1) ) ) = ( D84 | ( min (D83 , R1) ) ) by L848 , L843 , L841 , L835 , FINSEQ_5:22;
L850: ( ( min (D83 , R1) ) -' 1 ) <= ( min (D83 , R1) ) by NAT_D:35;
L851: ( ( D83 ^ D85 ) | ( ( min (D88 , R1) ) -' 1 ) ) = ( D83 | ( ( min (D83 , R1) ) -' 1 ) ) by L850 , L843 , L841 , FINSEQ_5:22 , XXREAL_0:2;
L852: ( ( D84 ^ D86 ) | ( ( min (D88 , R1) ) -' 1 ) ) = ( D84 | ( ( min (D83 , R1) ) -' 1 ) ) by L843 , L841 , L850 , L848 , L835 , FINSEQ_5:22 , XXREAL_0:2;
per cases ;
suppose L853: (R2 <= ( Sum ( D84 | ( ( min (D83 , R1) ) -' 1 ) ) ) or R2 > ( Sum ( D84 | ( min (D83 , R1) ) ) ));

L854: ( D82 * (R1 , R2) ) = R13 by L853 , L837 , L537;
thus L855: thesis by L854 , L837 , L847 , L849 , L852 , L845 , L853 , L537;
end;
suppose L856: (R2 > ( Sum ( D84 | ( ( min (D83 , R1) ) -' 1 ) ) ) & R2 <= ( Sum ( D84 | ( min (D83 , R1) ) ) ));

L857: ( D82 * (R1 , R2) ) = ( ( R27 . ( min (D83 , R1) ) ) * (( R1 -' ( Sum ( D83 | ( ( min (D83 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D84 | ( ( min (D83 , R1) ) -' 1 ) ) ) )) ) by L856 , L837 , L537;
L858: ( D90 * (R1 , R2) ) = ( ( D87 . ( min (D83 , R1) ) ) * (( R1 -' ( Sum ( D83 | ( ( min (D83 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D84 | ( ( min (D83 , R1) ) -' 1 ) ) ) )) ) by L837 , L847 , L843 , L849 , L852 , L851 , L845 , L846 , L856 , L537;
thus L859: thesis by L858 , L840 , L844 , L857 , FINSEQ_1:def 7;
end;
end;
theorem
L861: (for R1 being Nat holds (for R2 being Nat holds (for R12 being non  empty set holds (for R14 being (Element of R12) holds (for R15 being (Element of R12) holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds ([ R1 , R2 ] in ( Indices ( block_diagonal (R28 , R14) ) ) iff (R1 > ( 0 ) & R2 > ( 0 ) & [ ( R1 + ( Sum ( Len R27 ) ) ) , ( R2 + ( Sum ( Width R27 ) ) ) ] in ( Indices ( block_diagonal (( R27 ^ R28 ) , R15) ) ))))))))))
proof
let R1 being Nat;
let R2 being Nat;
let R12 being non  empty set;
let R14 being (Element of R12);
let R15 being (Element of R12);
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D91 = ( block_diagonal (R28 , R14) );
set D92 = ( block_diagonal (( R27 ^ R28 ) , R15) );
L862: ( dom D92 ) = ( Seg ( len D92 ) ) by FINSEQ_1:def 3;
L863: ( len D92 ) = ( Sum ( Len ( R27 ^ R28 ) ) ) by L537;
L864: ( ( Len R27 ) ^ ( Len R28 ) ) = ( Len ( R27 ^ R28 ) ) by L441;
L865: ( ( Sum ( Len R27 ) ) + ( Sum ( Len R28 ) ) ) = ( Sum ( Len ( R27 ^ R28 ) ) ) by L864 , RVSUM_1:75;
L866: ( len D91 ) = ( Sum ( Len R28 ) ) by L537;
L867: ( ( Width R27 ) ^ ( Width R28 ) ) = ( Width ( R27 ^ R28 ) ) by L489;
L868: ( ( Sum ( Width R27 ) ) + ( Sum ( Width R28 ) ) ) = ( Sum ( Width ( R27 ^ R28 ) ) ) by L867 , RVSUM_1:75;
L869: ( width D92 ) = ( Sum ( Width ( R27 ^ R28 ) ) ) by L537;
L870: ( width D91 ) = ( Sum ( Width R28 ) ) by L537;
L871: ( dom D91 ) = ( Seg ( len D91 ) ) by FINSEQ_1:def 3;
thus L872:now
assume L873: [ R1 , R2 ] in ( Indices D91 );
L874: R2 in ( Seg ( width D91 ) ) by L873 , ZFMISC_1:87;
L875: ( R2 + ( Sum ( Width R27 ) ) ) in ( Seg ( width D92 ) ) by L874 , L869 , L870 , L868 , FINSEQ_1:60;
L876: R1 in ( Seg ( len D91 ) ) by L871 , L873 , ZFMISC_1:87;
L877: ( R1 + ( Sum ( Len R27 ) ) ) in ( Seg ( len D92 ) ) by L876 , L863 , L866 , L865 , FINSEQ_1:60;
thus L878: (R1 > ( 0 ) & R2 > ( 0 ) & [ ( R1 + ( Sum ( Len R27 ) ) ) , ( R2 + ( Sum ( Width R27 ) ) ) ] in ( Indices D92 )) by L877 , L862 , L876 , L874 , L875 , FINSEQ_1:1 , ZFMISC_1:87;
end;
assume that
L879: R1 > ( 0 )
and
L880: R2 > ( 0 )
and
L881: [ ( R1 + ( Sum ( Len R27 ) ) ) , ( R2 + ( Sum ( Width R27 ) ) ) ] in ( Indices D92 );
L882: ( R1 + ( Sum ( Len R27 ) ) ) in ( Seg ( len D92 ) ) by L862 , L881 , ZFMISC_1:87;
L883: R1 in ( Seg ( len D91 ) ) by L882 , L863 , L866 , L865 , L879 , FINSEQ_1:61;
L884: ( R2 + ( Sum ( Width R27 ) ) ) in ( Seg ( width D92 ) ) by L881 , ZFMISC_1:87;
L885: R2 in ( Seg ( width D91 ) ) by L884 , L869 , L870 , L868 , L880 , FINSEQ_1:61;
L886: ( dom D91 ) = ( Seg ( len D91 ) ) by FINSEQ_1:def 3;
thus L887: thesis by L886 , L883 , L885 , ZFMISC_1:87;
end;
theorem
L888: (for R1 being Nat holds (for R2 being Nat holds (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds ([ R1 , R2 ] in ( Indices ( block_diagonal (R28 , R13) ) ) implies ( ( block_diagonal (R28 , R13) ) * (R1 , R2) ) = ( ( block_diagonal (( R27 ^ R28 ) , R13) ) * (( R1 + ( Sum ( Len R27 ) ) ) , ( R2 + ( Sum ( Width R27 ) ) )) ))))))))
proof
let R1 being Nat;
let R2 being Nat;
let R12 being non  empty set;
let R13 being (Element of R12);
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D93 = ( Len R27 );
set D94 = ( Width R27 );
set D95 = ( Len R28 );
set D96 = ( Width R28 );
set D97 = ( R27 ^ R28 );
set D98 = ( Len D97 );
set D99 = ( Width D97 );
set D100 = ( block_diagonal (R28 , R13) );
set D101 = ( block_diagonal (D97 , R13) );
L889: ( dom D101 ) = ( Seg ( len D101 ) ) by FINSEQ_1:def 3;
L890: ( len D101 ) = ( Sum D98 ) by L537;
L891: ( D93 ^ D95 ) = D98 by L441;
L892: ( Sum D98 ) = ( ( Sum D93 ) + ( Sum D95 ) ) by L891 , RVSUM_1:75;
assume L893: [ R1 , R2 ] in ( Indices D100 );
L894: R1 > ( 0 ) by L893 , L861;
L895: ( R1 + ( Sum D93 ) ) > ( ( 0 ) + ( Sum D93 ) ) by L894 , XREAL_1:6;
L896: (not ( R1 + ( Sum D93 ) ) in ( Seg ( Sum D93 ) )) by L895 , FINSEQ_1:1;
L897: [ ( R1 + ( Sum D93 ) ) , ( R2 + ( Sum D94 ) ) ] in ( Indices D101 ) by L893 , L861;
L898: ( R1 + ( Sum D93 ) ) in ( dom D101 ) by L897 , ZFMISC_1:87;
L899: ( R1 + ( Sum D93 ) ) in ( ( Seg ( ( Sum D93 ) + ( Sum D95 ) ) ) \ ( Seg ( Sum D93 ) ) ) by L898 , L892 , L889 , L890 , L896 , XBOOLE_0:def 5;
L900: ( min (D98 , ( R1 + ( Sum D93 ) )) ) = ( ( min (D95 , ( ( R1 + ( Sum D93 ) ) -' ( Sum D93 ) )) ) + ( len D93 ) ) by L899 , L891 , L244;
L901: ( len D100 ) = ( Sum D95 ) by L537;
L902: ( len D94 ) = ( len R27 ) by CARD_1:def 7;
L903: R1 in ( dom D100 ) by L893 , ZFMISC_1:87;
L904: R1 in ( Seg ( len D100 ) ) by L903 , FINSEQ_1:def 3;
L905: ( min (D95 , R1) ) in ( dom D95 ) by L904 , L901 , L179;
L906: ( min (D95 , R1) ) <= ( len D95 ) by L905 , FINSEQ_3:25;
L907: ( ( R1 + ( Sum D93 ) ) -' ( Sum D93 ) ) = ( ( R1 + ( Sum D93 ) ) - ( Sum D93 ) ) by L899 , L244;
L908: R2 in ( NAT ) by ORDINAL1:def 12;
L909: ( ( R2 + ( Sum D94 ) ) -' ( ( Sum D94 ) + ( Sum ( D96 | ( ( min (D95 , R1) ) -' 1 ) ) ) ) ) = ( R2 -' ( Sum ( D96 | ( ( min (D95 , R1) ) -' 1 ) ) ) ) by L908 , PRGCOR_1:1;
L910: ( len D95 ) = ( len R28 ) by CARD_1:def 7;
L911: R1 in ( NAT ) by ORDINAL1:def 12;
L912: ( ( R1 + ( Sum D93 ) ) -' ( ( Sum D93 ) + ( Sum ( D95 | ( ( min (D95 , R1) ) -' 1 ) ) ) ) ) = ( R1 -' ( Sum ( D95 | ( ( min (D95 , R1) ) -' 1 ) ) ) ) by L911 , PRGCOR_1:1;
L913: ( len R27 ) = ( len D93 ) by CARD_1:def 7;
L914: ( D94 ^ D96 ) = D99 by L489;
L915: ( D94 ^ ( D96 | ( min (D95 , R1) ) ) ) = ( D99 | ( min (D98 , ( R1 + ( Sum D93 ) )) ) ) by L914 , L902 , L913 , L900 , L907 , FINSEQ_6:14;
L916: ( ( Sum D94 ) + ( Sum ( D96 | ( min (D95 , R1) ) ) ) ) = ( Sum ( D99 | ( min (D98 , ( R1 + ( Sum D93 ) )) ) ) ) by L915 , RVSUM_1:75;
L917: ( min (D95 , R1) ) >= 1 by L905 , FINSEQ_3:25;
L918: ( ( ( min (D95 , R1) ) + ( len D93 ) ) -' 1 ) = ( ( ( min (D95 , R1) ) -' 1 ) + ( len D93 ) ) by L917 , NAT_D:38;
L919: ( D93 ^ ( D95 | ( ( min (D95 , R1) ) -' 1 ) ) ) = ( D98 | ( ( min (D98 , ( R1 + ( Sum D93 ) )) ) -' 1 ) ) by L918 , L891 , L900 , L907 , FINSEQ_6:14;
L920: ( ( Sum D93 ) + ( Sum ( D95 | ( ( min (D95 , R1) ) -' 1 ) ) ) ) = ( Sum ( D98 | ( ( min (D98 , ( R1 + ( Sum D93 ) )) ) -' 1 ) ) ) by L919 , RVSUM_1:75;
L921: ( D94 ^ ( D96 | ( ( min (D95 , R1) ) -' 1 ) ) ) = ( D99 | ( ( min (D98 , ( R1 + ( Sum D93 ) )) ) -' 1 ) ) by L914 , L902 , L913 , L900 , L907 , L918 , FINSEQ_6:14;
L922: ( ( Sum D94 ) + ( Sum ( D96 | ( ( min (D95 , R1) ) -' 1 ) ) ) ) = ( Sum ( D99 | ( ( min (D98 , ( R1 + ( Sum D93 ) )) ) -' 1 ) ) ) by L921 , RVSUM_1:75;
per cases ;
suppose L923: (R2 <= ( Sum ( D96 | ( ( min (D95 , R1) ) -' 1 ) ) ) or R2 > ( Sum ( D96 | ( min (D95 , R1) ) ) ));

L924: (( R2 + ( Sum D94 ) ) <= ( Sum ( D99 | ( ( min (D98 , ( R1 + ( Sum D93 ) )) ) -' 1 ) ) ) or ( R2 + ( Sum D94 ) ) > ( Sum ( D99 | ( min (D98 , ( R1 + ( Sum D93 ) )) ) ) )) by L923 , L916 , L922 , XREAL_1:7 , XREAL_1:8;
L925: ( D101 * (( R1 + ( Sum D93 ) ) , ( R2 + ( Sum D94 ) )) ) = R13 by L924 , L897 , L537;
thus L926: thesis by L925 , L893 , L923 , L537;
end;
suppose L927: (R2 > ( Sum ( D96 | ( ( min (D95 , R1) ) -' 1 ) ) ) & R2 <= ( Sum ( D96 | ( min (D95 , R1) ) ) ));

L928: ( R2 + ( Sum D94 ) ) <= ( Sum ( D99 | ( min (D98 , ( R1 + ( Sum D93 ) )) ) ) ) by L927 , L916 , XREAL_1:7;
L929: ( D100 * (R1 , R2) ) = ( ( R28 . ( min (D95 , R1) ) ) * (( R1 -' ( Sum ( D95 | ( ( min (D95 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D96 | ( ( min (D95 , R1) ) -' 1 ) ) ) )) ) by L893 , L927 , L537;
L930: ( R2 + ( Sum D94 ) ) > ( Sum ( D99 | ( ( min (D98 , ( R1 + ( Sum D93 ) )) ) -' 1 ) ) ) by L922 , L927 , XREAL_1:8;
L931: ( D101 * (( R1 + ( Sum D93 ) ) , ( R2 + ( Sum D94 ) )) ) = ( ( D97 . ( min (D98 , ( R1 + ( Sum D93 ) )) ) ) * (( R1 -' ( Sum ( D95 | ( ( min (D95 , R1) ) -' 1 ) ) ) ) , ( R2 -' ( Sum ( D96 | ( ( min (D95 , R1) ) -' 1 ) ) ) )) ) by L930 , L897 , L922 , L920 , L912 , L909 , L928 , L537;
thus L932: thesis by L931 , L913 , L910 , L917 , L906 , L900 , L907 , L929 , FINSEQ_1:65;
end;
end;
theorem
L934: (for R1 being Nat holds (for R2 being Nat holds (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds (([ R1 , R2 ] in ( Indices ( block_diagonal (( R27 ^ R28 ) , R13) ) ) & ((R1 <= ( Sum ( Len R27 ) ) & R2 > ( Sum ( Width R27 ) )) or (R1 > ( Sum ( Len R27 ) ) & R2 <= ( Sum ( Width R27 ) )))) implies ( ( block_diagonal (( R27 ^ R28 ) , R13) ) * (R1 , R2) ) = R13)))))))
proof
let R1 being Nat;
let R2 being Nat;
let R12 being non  empty set;
let R13 being (Element of R12);
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D102 = ( Len R27 );
set D103 = ( Width R27 );
set D104 = ( Len R28 );
set D105 = ( Width R28 );
set D106 = ( R27 ^ R28 );
set D107 = ( Len D106 );
set D108 = ( Width D106 );
set D109 = ( block_diagonal (D106 , R13) );
L935: ( dom D109 ) = ( Seg ( len D109 ) ) by FINSEQ_1:def 3;
L936: ( len D103 ) = ( len R27 ) by CARD_1:def 7;
L937: ( len D109 ) = ( Sum D107 ) by L537;
L938: ( len R27 ) = ( len D102 ) by CARD_1:def 7;
assume that
L939: [ R1 , R2 ] in ( Indices ( block_diagonal (( R27 ^ R28 ) , R13) ) )
and
L940: ((R1 <= ( Sum ( Len R27 ) ) & R2 > ( Sum ( Width R27 ) )) or (R1 > ( Sum ( Len R27 ) ) & R2 <= ( Sum ( Width R27 ) )));
L941: R1 in ( dom D109 ) by L939 , ZFMISC_1:87;
L942: 1 <= R1 by L941 , FINSEQ_3:25;
L943: ( D103 ^ D105 ) = D108 by L489;
L944: ( D102 ^ D104 ) = D107 by L441;
L945: ( Sum D107 ) = ( ( Sum D102 ) + ( Sum D104 ) ) by L944 , RVSUM_1:75;
per cases  by L940;
suppose L946: (R1 <= ( Sum ( Len R27 ) ) & R2 > ( Sum ( Width R27 ) ));

L947: R1 in ( Seg ( Sum D102 ) ) by L946 , L942 , FINSEQ_1:1;
L948: ( min (D102 , R1) ) in ( dom D102 ) by L947 , L179;
L949: ( min (D102 , R1) ) <= ( len D102 ) by L948 , FINSEQ_3:25;
L950: ( Sum ( D108 | ( min (D102 , R1) ) ) ) <= ( Sum ( D108 | ( len D102 ) ) ) by L949 , POLYNOM3:18;
L951: ( D108 | ( len D102 ) ) = D103 by L943 , L936 , L938 , FINSEQ_5:23;
L952: ( min (D107 , R1) ) = ( min (D102 , R1) ) by L944 , L947 , L230;
L953: ( Sum ( D108 | ( min (D107 , R1) ) ) ) < R2 by L952 , L946 , L951 , L950 , XXREAL_0:2;
thus L954: thesis by L953 , L939 , L537;
end;
suppose L955: (R1 > ( Sum D102 ) & R2 <= ( Sum D103 ));

L956: R1 in ( Seg ( Sum D107 ) ) by L935 , L937 , L939 , ZFMISC_1:87;
L957: (not R1 in ( Seg ( Sum D102 ) )) by L955 , FINSEQ_1:1;
L958: R1 in ( ( Seg ( ( Sum D102 ) + ( Sum D104 ) ) ) \ ( Seg ( Sum D102 ) ) ) by L957 , L945 , L956 , XBOOLE_0:def 5;
L959: ( R1 -' ( Sum D102 ) ) = ( R1 - ( Sum D102 ) ) by L958 , L244;
L960: R1 = ( ( R1 -' ( Sum D102 ) ) + ( Sum D102 ) ) by L959;
L961: ( R1 -' ( Sum D102 ) ) <> ( 0 ) by L955 , L959;
L962: ( R1 -' ( Sum D102 ) ) in ( Seg ( Sum D104 ) ) by L961 , L945 , L956 , L960 , FINSEQ_1:61;
L963: ( min (D104 , ( R1 -' ( Sum D102 ) )) ) in ( dom D104 ) by L962 , L179;
L964: ( min (D104 , ( R1 -' ( Sum D102 ) )) ) >= 1 by L963 , FINSEQ_3:25;
L965: ( min (D107 , R1) ) = ( ( min (D104 , ( R1 -' ( Sum D102 ) )) ) + ( len D102 ) ) by L944 , L958 , L244;
L966: ( ( min (D107 , R1) ) -' 1 ) = ( ( ( min (D104 , ( R1 -' ( Sum D102 ) )) ) -' 1 ) + ( len D102 ) ) by L965 , L964 , NAT_D:38;
L967: ( ( min (D107 , R1) ) -' 1 ) >= ( ( len D102 ) + ( 0 ) ) by L966 , XREAL_1:7;
L968: ( Sum ( D108 | ( ( min (D107 , R1) ) -' 1 ) ) ) >= ( Sum ( ( D103 ^ D105 ) | ( len D103 ) ) ) by L967 , L943 , L936 , L938 , POLYNOM3:18;
L969: ( ( D103 ^ D105 ) | ( len D103 ) ) = D103 by FINSEQ_5:23;
L970: ( Sum ( D108 | ( ( min (D107 , R1) ) -' 1 ) ) ) >= R2 by L969 , L955 , L968 , XXREAL_0:2;
thus L971: thesis by L970 , L939 , L537;
end;
end;
theorem
L973: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R26 being (FinSequence_of_Matrix of R12) holds (for R1 being Nat holds (for R2 being Nat holds (for R5 being Nat holds ((R1 in ( dom R26 ) & [ R2 , R5 ] in ( Indices ( R26 . R1 ) )) implies ([ ( R2 + ( Sum ( ( Len R26 ) | ( R1 -' 1 ) ) ) ) , ( R5 + ( Sum ( ( Width R26 ) | ( R1 -' 1 ) ) ) ) ] in ( Indices ( block_diagonal (R26 , R13) ) ) & ( ( R26 . R1 ) * (R2 , R5) ) = ( ( block_diagonal (R26 , R13) ) * (( R2 + ( Sum ( ( Len R26 ) | ( R1 -' 1 ) ) ) ) , ( R5 + ( Sum ( ( Width R26 ) | ( R1 -' 1 ) ) ) )) )))))))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R26 being (FinSequence_of_Matrix of R12);
let R1 being Nat;
let R2 being Nat;
let R5 being Nat;
assume that
L974: R1 in ( dom R26 )
and
L975: [ R2 , R5 ] in ( Indices ( R26 . R1 ) );
set D110 = ( R26 . R1 );
L976: R5 in ( Seg ( width D110 ) ) by L975 , ZFMISC_1:87;
set D111 = ( Len R26 );
L977: R1 in ( NAT ) by ORDINAL1:def 12;
L978: ( len R26 ) = ( len D111 ) by CARD_1:def 7;
L979: ( D111 | ( len R26 ) ) = D111 by L978 , FINSEQ_1:58;
L980: R1 <= ( len R26 ) by L974 , FINSEQ_3:25;
L981: ( Sum ( D111 | R1 ) ) <= ( Sum ( D111 | ( len R26 ) ) ) by L980 , L977 , POLYNOM3:18;
L982: ( Seg ( Sum ( D111 | R1 ) ) ) c= ( Seg ( Sum D111 ) ) by L981 , L979 , FINSEQ_1:5;
L983: ( dom R26 ) = ( dom D111 ) by L387;
L984: ( D111 . R1 ) = ( D111 /. R1 ) by L983 , L974 , PARTFUN1:def 6;
set D112 = ( Width R26 );
L985: ( dom R26 ) = ( dom D112 ) by L399;
L986: ( D112 . R1 ) = ( D112 /. R1 ) by L985 , L974 , PARTFUN1:def 6;
set D113 = ( R5 + ( Sum ( D112 | ( R1 -' 1 ) ) ) );
L987: ( D112 . R1 ) = ( width D110 ) by L974 , L985 , L399;
L988: D113 in ( Seg ( Sum ( D112 | R1 ) ) ) by L987 , L974 , L985 , L976 , L986 , L279;
L989: D113 <= ( Sum ( D112 | R1 ) ) by L988 , FINSEQ_1:1;
L990: ( len R26 ) = ( len D112 ) by CARD_1:def 7;
L991: ( D112 | ( len R26 ) ) = D112 by L990 , FINSEQ_1:58;
set D114 = ( block_diagonal (R26 , R13) );
L992: ( len D114 ) = ( Sum D111 ) by L537;
L993: ( width D114 ) = ( Sum D112 ) by L537;
set D115 = ( R2 + ( Sum ( D111 | ( R1 -' 1 ) ) ) );
L994: R2 in ( dom D110 ) by L975 , ZFMISC_1:87;
L995: R2 in ( Seg ( len D110 ) ) by L994 , FINSEQ_1:def 3;
L996: ( Sum ( D112 | R1 ) ) <= ( Sum ( D112 | ( len R26 ) ) ) by L980 , L977 , POLYNOM3:18;
L997: ( Seg ( Sum ( D112 | R1 ) ) ) c= ( Seg ( Sum D112 ) ) by L996 , L991 , FINSEQ_1:5;
L998: ( ( Sum ( D111 | ( R1 -' 1 ) ) ) + ( 0 ) ) <= D115 by XREAL_1:6;
L999: ( D115 -' ( Sum ( D111 | ( R1 -' 1 ) ) ) ) = ( D115 - ( Sum ( D111 | ( R1 -' 1 ) ) ) ) by L998 , XREAL_1:233;
L1000: ( D111 . R1 ) = ( len D110 ) by L974 , L983 , L387;
L1001: ( min (D111 , D115) ) = R1 by L1000 , L974 , L983 , L995 , L984 , L279;
L1002: D115 in ( Seg ( Sum ( D111 | R1 ) ) ) by L974 , L983 , L995 , L984 , L1000 , L279;
L1003: [ D115 , D113 ] in [: ( Seg ( len D114 ) ) , ( Seg ( width D114 ) ) :] by L1002 , L992 , L993 , L988 , L982 , L997 , ZFMISC_1:87;
thus L1004: [ D115 , D113 ] in ( Indices D114 ) by L1003 , FINSEQ_1:def 3;
L1005: ( 0 ) < R5 by L976 , FINSEQ_1:1;
L1006: ( ( Sum ( D112 | ( R1 -' 1 ) ) ) + ( 0 ) ) < D113 by L1005 , XREAL_1:6;
L1007: ( D113 -' ( Sum ( D112 | ( R1 -' 1 ) ) ) ) = ( D113 - ( Sum ( D112 | ( R1 -' 1 ) ) ) ) by L1006 , XREAL_1:233;
thus L1008: thesis by L1007 , L1001 , L1004 , L1006 , L989 , L999 , L537;
end;
theorem
L1009: (for R1 being Nat holds (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R26 being (FinSequence_of_Matrix of R12) holds (R1 in ( dom R26 ) implies ( R26 . R1 ) = ( Segm (( block_diagonal (R26 , R13) ) , ( ( Seg ( Sum ( ( Len R26 ) | R1 ) ) ) \ ( Seg ( Sum ( ( Len R26 ) | ( R1 -' 1 ) ) ) ) ) , ( ( Seg ( Sum ( ( Width R26 ) | R1 ) ) ) \ ( Seg ( Sum ( ( Width R26 ) | ( R1 -' 1 ) ) ) ) )) ))))))
proof
let R1 being Nat;
let R12 being non  empty set;
let R13 being (Element of R12);
let R26 being (FinSequence_of_Matrix of R12);
assume L1010: R1 in ( dom R26 );
set D116 = ( Len R26 );
set D117 = ( R26 . R1 );
L1011: ( dom R26 ) = ( dom D116 ) by L387;
L1012: ( len D117 ) = ( D116 . R1 ) by L1011 , L1010 , L387;
set D118 = ( Sum ( D116 | R1 ) );
set D119 = ( Sum ( D116 | ( R1 -' 1 ) ) );
L1013: ( D119 + ( D116 . R1 ) ) = D118 by L1010 , L1011 , L272;
reconsider D120 = D117 as (Matrix of ( len D117 ) , ( width D117 ) , R12) by MATRIX_2:7;
set D121 = ( block_diagonal (R26 , R13) );
set D122 = ( Width R26 );
set D123 = ( Sum ( D122 | ( R1 -' 1 ) ) );
set D124 = ( Sum ( D122 | R1 ) );
L1014: ( dom R26 ) = ( dom D122 ) by L399;
L1015: ( D123 + ( D122 . R1 ) ) = D124 by L1014 , L1010 , L272;
L1016: R1 in ( NAT ) by ORDINAL1:def 12;
L1017: D119 <= D118 by L1016 , NAT_D:35 , POLYNOM3:18;
L1018: ( Seg D119 ) c= ( Seg D118 ) by L1017 , FINSEQ_1:5;
L1019: ( card ( ( Seg D118 ) \ ( Seg D119 ) ) ) = ( ( card ( Seg D118 ) ) - ( card ( Seg D119 ) ) ) by L1018 , CARD_2:44
.= ( D118 - ( card ( Seg D119 ) ) ) by FINSEQ_1:57
.= ( ( D119 + ( D116 . R1 ) ) - D119 ) by L1013 , FINSEQ_1:57
.= ( len D117 ) by L1010 , L1011 , L387;
L1020: D123 <= D124 by L1016 , NAT_D:35 , POLYNOM3:18;
L1021: ( Seg D123 ) c= ( Seg D124 ) by L1020 , FINSEQ_1:5;
L1022: ( card ( ( Seg D124 ) \ ( Seg D123 ) ) ) = ( ( card ( Seg D124 ) ) - ( card ( Seg D123 ) ) ) by L1021 , CARD_2:44
.= ( D124 - ( card ( Seg D123 ) ) ) by FINSEQ_1:57
.= ( ( D123 + ( D122 . R1 ) ) - D123 ) by L1015 , FINSEQ_1:57
.= ( width D117 ) by L1010 , L1014 , L399;
L1023: ( width D117 ) = ( D122 . R1 ) by L1010 , L1014 , L399;
L1024:
now
L1025: ( Indices D120 ) = ( Indices ( Segm (D121 , ( ( Seg D118 ) \ ( Seg D119 ) ) , ( ( Seg D124 ) \ ( Seg D123 ) )) ) ) by L1019 , L1022 , MATRIX_1:26;
L1026: ( dom D120 ) = ( Seg ( D116 . R1 ) ) by L1012 , FINSEQ_1:def 3;
let R2 being Nat;
let R5 being Nat;
assume that
L1027: [ R2 , R5 ] in ( Indices D120 );
L1028: R5 in ( Seg ( D122 . R1 ) ) by L1023 , L1027 , ZFMISC_1:87;
L1029: ( ( Sgm ( ( Seg D124 ) \ ( Seg D123 ) ) ) . R5 ) = ( R5 + D123 ) by L1028 , L1015 , MATRIX15:8;
L1030: R2 in ( dom D120 ) by L1027 , ZFMISC_1:87;
L1031: ( ( Sgm ( ( Seg D118 ) \ ( Seg D119 ) ) ) . R2 ) = ( R2 + D119 ) by L1030 , L1013 , L1026 , MATRIX15:8;
thus L1032: ( ( Segm (D121 , ( ( Seg D118 ) \ ( Seg D119 ) ) , ( ( Seg D124 ) \ ( Seg D123 ) )) ) * (R2 , R5) ) = ( D121 * (( R2 + D119 ) , ( R5 + D123 )) ) by L1031 , L1027 , L1025 , L1029 , MATRIX13:def 1
.= ( D117 * (R2 , R5) ) by L1010 , L1027 , L973;
end;
thus L1033: thesis by L1024 , L1019 , L1022 , MATRIX_1:27;
end;
theorem
L1034: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R16 being (Matrix of R12) holds (for R26 being (FinSequence_of_Matrix of R12) holds R16 = ( Segm (( block_diagonal (( <* R16 *> ^ R26 ) , R13) ) , ( Seg ( len R16 ) ) , ( Seg ( width R16 ) )) )))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R16 being (Matrix of R12);
let R26 being (FinSequence_of_Matrix of R12);
set D125 = ( <* R16 *> ^ R26 );
set D126 = ( Len D125 );
set D127 = ( Width D125 );
L1035: ( Seg ( Sum ( D126 | ( 0 ) ) ) ) = ( {} ) by RVSUM_1:72;
L1036: ( Seg ( Sum ( D127 | ( 0 ) ) ) ) = ( {} ) by RVSUM_1:72;
L1037: ( Len <* R16 *> ) = <* ( len R16 ) *> by L464;
L1038: ( len <* ( len R16 ) *> ) = 1 by FINSEQ_1:39;
L1039: D126 = ( ( Len <* R16 *> ) ^ ( Len R26 ) ) by L441;
L1040: ( D126 | 1 ) = <* ( len R16 ) *> by L1039 , L1037 , L1038 , FINSEQ_5:23;
L1041: ( Sum ( D126 | 1 ) ) = ( len R16 ) by L1040 , RVSUM_1:73;
L1042: ( len <* ( width R16 ) *> ) = 1 by FINSEQ_1:39;
L1043: ( Width <* R16 *> ) = <* ( width R16 ) *> by L512;
L1044: ( D125 . 1 ) = R16 by FINSEQ_1:41;
L1045: 1 in ( Seg 1 );
L1046: 1 in ( dom <* R16 *> ) by L1045 , FINSEQ_1:38;
L1047: ( dom <* R16 *> ) c= ( dom D125 ) by FINSEQ_1:26;
L1048: D127 = ( ( Width <* R16 *> ) ^ ( Width R26 ) ) by L489;
L1049: ( D127 | 1 ) = <* ( width R16 ) *> by L1048 , L1043 , L1042 , FINSEQ_5:23;
L1050: ( 1 -' 1 ) = ( 0 ) by XREAL_1:232;
thus L1051: R16 = ( Segm (( block_diagonal (D125 , R13) ) , ( ( Seg ( Sum ( D126 | 1 ) ) ) \ ( {} ) ) , ( ( Seg ( Sum ( D127 | 1 ) ) ) \ ( {} ) )) ) by L1050 , L1035 , L1036 , L1046 , L1047 , L1044 , L1009
.= ( Segm (( block_diagonal (D125 , R13) ) , ( Seg ( len R16 ) ) , ( Seg ( width R16 ) )) ) by L1049 , L1041 , RVSUM_1:73;
end;
theorem
L1052: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R16 being (Matrix of R12) holds (for R26 being (FinSequence_of_Matrix of R12) holds R16 = ( Segm (( block_diagonal (( R26 ^ <* R16 *> ) , R13) ) , ( ( Seg ( ( len R16 ) + ( Sum ( Len R26 ) ) ) ) \ ( Seg ( Sum ( Len R26 ) ) ) ) , ( ( Seg ( ( width R16 ) + ( Sum ( Width R26 ) ) ) ) \ ( Seg ( Sum ( Width R26 ) ) ) )) )))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R16 being (Matrix of R12);
let R26 being (FinSequence_of_Matrix of R12);
set D128 = ( R26 ^ <* R16 *> );
set D129 = ( Len D128 );
set D130 = ( Width D128 );
set D131 = ( 1 + ( len R26 ) );
L1053: ( len D128 ) = D131 by FINSEQ_2:16;
L1054: ( len D129 ) = ( len D128 ) by CARD_1:def 7;
L1055: ( D129 | D131 ) = D129 by L1054 , L1053 , FINSEQ_1:58;
L1056: ( len D130 ) = ( len D128 ) by CARD_1:def 7;
L1057: ( D130 | D131 ) = D130 by L1056 , L1053 , FINSEQ_1:58;
L1058: D131 in ( Seg ( ( len R26 ) + 1 ) ) by FINSEQ_1:4;
L1059: D131 in ( dom D128 ) by L1058 , L1053 , FINSEQ_1:def 3;
L1060: D130 = ( ( Width R26 ) ^ ( Width <* R16 *> ) ) by L489;
L1061: ( len ( Width R26 ) ) = ( len R26 ) by CARD_1:def 7;
L1062: ( D130 | ( len R26 ) ) = ( Width R26 ) by L1061 , L1060 , FINSEQ_5:23;
L1063: ( Width <* R16 *> ) = <* ( width R16 ) *> by L512;
L1064: ( Sum D130 ) = ( ( Sum ( Width R26 ) ) + ( width R16 ) ) by L1063 , L1060 , RVSUM_1:74;
L1065: D129 = ( ( Len R26 ) ^ ( Len <* R16 *> ) ) by L441;
L1066: ( len ( Len R26 ) ) = ( len R26 ) by CARD_1:def 7;
L1067: ( D129 | ( len R26 ) ) = ( Len R26 ) by L1066 , L1065 , FINSEQ_5:23;
L1068: ( Len <* R16 *> ) = <* ( len R16 ) *> by L464;
L1069: ( Sum D129 ) = ( ( Sum ( Len R26 ) ) + ( len R16 ) ) by L1068 , L1065 , RVSUM_1:74;
L1070: ( D128 . D131 ) = R16 by FINSEQ_1:42;
L1071: ( D131 -' 1 ) = ( D131 - 1 ) by NAT_D:37;
thus L1072: thesis by L1071 , L1067 , L1062 , L1069 , L1064 , L1059 , L1070 , L1057 , L1055 , L1009;
end;
theorem
L1073: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R16 being (Matrix of R12) holds ( block_diagonal (<* R16 *> , R13) ) = R16)))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R16 being (Matrix of R12);
reconsider D132 = ( <*> ( ( R12 * ) * ) ) as  Matrix-yielding (FinSequence of ( ( R12 * ) * )) by L341;
set D133 = ( <* R16 *> ^ D132 );
set D134 = ( block_diagonal (<* R16 *> , R13) );
L1074: ( len D134 ) = ( Sum ( Len <* R16 *> ) ) by L537
.= ( len R16 ) by L472;
L1075: ( width D134 ) = ( Sum ( Width <* R16 *> ) ) by L537
.= ( width R16 ) by L520;
L1076: D133 = <* R16 *> by FINSEQ_1:34;
thus L1077: R16 = ( Segm (D134 , ( Seg ( len R16 ) ) , ( Seg ( width R16 ) )) ) by L1076 , L1034
.= D134 by L1074 , L1075 , MATRIX13:46;
end;
theorem
L1078: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds ( block_diagonal (( R27 ^ R28 ) , R13) ) = ( block_diagonal (( <* ( block_diagonal (R27 , R13) ) *> ^ R28 ) , R13) )))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D135 = ( R27 ^ R28 );
set D136 = ( block_diagonal (R27 , R13) );
set D137 = ( block_diagonal (R28 , R13) );
set D138 = ( block_diagonal (D135 , R13) );
set D139 = ( <* D136 *> ^ R28 );
set D140 = ( block_diagonal (D139 , R13) );
set D141 = ( Len R27 );
set D142 = ( Width R27 );
set D143 = ( Len R28 );
set D144 = ( Width R28 );
set D145 = ( Len D135 );
set D146 = ( Width D135 );
L1079: D145 = ( D141 ^ D143 ) by L441;
L1080: ( len D138 ) = ( Sum D145 ) by L537;
L1081: ( len D138 ) = ( ( Sum D141 ) + ( Sum D143 ) ) by L1080 , L1079 , RVSUM_1:75;
L1082: ( Len <* D136 *> ) = <* ( len D136 ) *> by L464;
L1083: ( Sum ( Len <* D136 *> ) ) = ( len D136 ) by L1082 , RVSUM_1:73;
L1084: ( block_diagonal (<* D136 *> , R13) ) = D136 by L1073;
L1085: ( Sum D142 ) = ( width D136 ) by L537;
L1086: ( Len D139 ) = ( ( Len <* D136 *> ) ^ D143 ) by L441;
L1087: D146 = ( D142 ^ D144 ) by L489;
L1088: ( len D140 ) = ( Sum ( Len D139 ) ) by L537;
L1089: ( len D140 ) = ( ( len D136 ) + ( Sum D143 ) ) by L1088 , L1086 , L1082 , RVSUM_1:76;
L1090: ( Width <* D136 *> ) = <* ( width D136 ) *> by L512;
L1091: ( Sum ( Width <* D136 *> ) ) = ( width D136 ) by L1090 , RVSUM_1:73;
L1092: ( Sum D141 ) = ( len D136 ) by L537;
L1093: ( width D136 ) = ( Sum D142 ) by L537;
L1094: ( width D138 ) = ( Sum D146 ) by L537;
L1095: ( width D138 ) = ( ( Sum D142 ) + ( Sum D144 ) ) by L1094 , L1087 , RVSUM_1:75;
L1096: ( Width D139 ) = ( ( Width <* D136 *> ) ^ D144 ) by L489;
L1097: ( len D136 ) = ( Sum D141 ) by L537;
L1098: ( width D140 ) = ( Sum ( Width D139 ) ) by L537;
L1099: ( width D140 ) = ( ( width D136 ) + ( Sum D144 ) ) by L1098 , L1096 , L1090 , RVSUM_1:76;
L1100: ( Indices D138 ) = [: ( Seg ( len D138 ) ) , ( Seg ( width D138 ) ) :] by FINSEQ_1:def 3
.= ( Indices D140 ) by L1081 , L1095 , L1097 , L1093 , L1089 , L1099 , FINSEQ_1:def 3;
L1101:
now
L1102: ( dom D138 ) = ( Seg ( len D138 ) ) by FINSEQ_1:def 3;
let R1 being Nat;
let R2 being Nat;
assume that
L1103: [ R1 , R2 ] in ( Indices D138 );
L1104: R1 in ( dom D138 ) by L1103 , ZFMISC_1:87;
L1105: 1 <= R1 by L1104 , L1102 , FINSEQ_1:1;
L1106: R2 in ( Seg ( width D138 ) ) by L1103 , ZFMISC_1:87;
L1107: 1 <= R2 by L1106 , FINSEQ_1:1;
L1108:
now
per cases ;
suppose L1109: (R1 <= ( Sum D141 ) & R2 <= ( Sum D142 ));

L1110: R1 in ( dom D136 ) by L1109 , L1092 , L1105 , FINSEQ_3:25;
L1111: R2 in ( Seg ( width D136 ) ) by L1085 , L1106 , L1107 , L1109;
L1112: [ R1 , R2 ] in ( Indices D136 ) by L1111 , L1110 , ZFMISC_1:87;
thus L1113: ( D138 * (R1 , R2) ) = ( D136 * (R1 , R2) ) by L1112 , L834
.= ( D140 * (R1 , R2) ) by L1084 , L1112 , L834;
end;
suppose L1114: ((R1 > ( Sum D141 ) & R2 <= ( Sum D142 )) or (R1 <= ( Sum D141 ) & R2 > ( Sum D142 )));

thus L1115: ( D138 * (R1 , R2) ) = R13 by L1114 , L1103 , L934
.= ( D140 * (R1 , R2) ) by L1097 , L1093 , L1083 , L1091 , L1100 , L1103 , L1114 , L934;
end;
suppose L1116: (R1 > ( Sum D141 ) & R2 > ( Sum D142 ));

reconsider D147 = ( R1 - ( Sum D141 ) ) , D148 = ( R2 - ( Sum D142 ) ) as (Element of ( NAT )) by L1116 , NAT_1:21;
L1117: D148 <> ( 0 ) by L1116;
L1118: R1 = ( D147 + ( Sum D141 ) );
L1119: R2 = ( D148 + ( Sum D142 ) );
L1120: D147 <> ( 0 ) by L1116;
L1121: [ D147 , D148 ] in ( Indices D137 ) by L1120 , L1103 , L1118 , L1119 , L1117 , L861;
thus L1122: ( D138 * (R1 , R2) ) = ( D137 * (D147 , D148) ) by L1121 , L1118 , L1119 , L888
.= ( D140 * (R1 , R2) ) by L1097 , L1093 , L1083 , L1091 , L1118 , L1119 , L1121 , L888;
end;
end;
thus L1124: ( D138 * (R1 , R2) ) = ( D140 * (R1 , R2) ) by L1108;
end;
thus L1125: thesis by L1101 , L1094 , L1087 , L1081 , L1097 , L1093 , L1089 , L1099 , MATRIX_1:21 , RVSUM_1:75;
end;
theorem
L1126: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R27 being (FinSequence_of_Matrix of R12) holds (for R28 being (FinSequence_of_Matrix of R12) holds ( block_diagonal (( R27 ^ R28 ) , R13) ) = ( block_diagonal (( R27 ^ <* ( block_diagonal (R28 , R13) ) *> ) , R13) )))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R27 being (FinSequence_of_Matrix of R12);
let R28 being (FinSequence_of_Matrix of R12);
set D149 = ( R27 ^ R28 );
set D150 = ( block_diagonal (R27 , R13) );
set D151 = ( block_diagonal (R28 , R13) );
set D152 = ( block_diagonal (D149 , R13) );
set D153 = ( R27 ^ <* D151 *> );
set D154 = ( block_diagonal (D153 , R13) );
set D155 = ( Len R27 );
set D156 = ( Width R27 );
set D157 = ( Len R28 );
set D158 = ( Width R28 );
set D159 = ( Len D149 );
set D160 = ( Width D149 );
L1127: D159 = ( D155 ^ D157 ) by L441;
L1128: ( len D152 ) = ( Sum D159 ) by L537;
L1129: ( len D152 ) = ( ( Sum D155 ) + ( Sum D157 ) ) by L1128 , L1127 , RVSUM_1:75;
L1130: ( Sum ( Width <* D151 *> ) ) = ( width D151 ) by L520;
L1131: ( Len D153 ) = ( D155 ^ ( Len <* D151 *> ) ) by L441;
L1132: ( len D154 ) = ( Sum ( Len D153 ) ) by L537;
L1133: ( len D154 ) = ( ( Sum ( Len <* D151 *> ) ) + ( Sum D155 ) ) by L1132 , L1131 , RVSUM_1:75;
L1134: ( Sum D155 ) = ( len D150 ) by L537;
L1135: D160 = ( D156 ^ D158 ) by L489;
L1136: ( Width D153 ) = ( D156 ^ ( Width <* D151 *> ) ) by L489;
L1137: ( width D154 ) = ( Sum ( Width D153 ) ) by L537;
L1138: ( width D154 ) = ( ( Sum ( Width <* D151 *> ) ) + ( Sum D156 ) ) by L1137 , L1136 , RVSUM_1:75;
L1139: ( Sum D156 ) = ( width D150 ) by L537;
L1140: ( len D151 ) = ( Sum D157 ) by L537;
L1141: ( width D152 ) = ( Sum D160 ) by L537;
L1142: ( width D152 ) = ( ( Sum D156 ) + ( Sum D158 ) ) by L1141 , L1135 , RVSUM_1:75;
L1143: ( Sum ( Len <* D151 *> ) ) = ( len D151 ) by L472;
L1144: ( block_diagonal (<* D151 *> , R13) ) = D151 by L1073;
L1145: ( width D151 ) = ( Sum D158 ) by L537;
L1146: ( Indices D152 ) = [: ( Seg ( len D152 ) ) , ( Seg ( width D152 ) ) :] by FINSEQ_1:def 3
.= ( Indices D154 ) by L1129 , L1142 , L1140 , L1145 , L1133 , L1138 , L1143 , L1130 , FINSEQ_1:def 3;
L1147:
now
L1148: ( dom D152 ) = ( Seg ( len D152 ) ) by FINSEQ_1:def 3;
let R1 being Nat;
let R2 being Nat;
assume that
L1149: [ R1 , R2 ] in ( Indices D152 );
L1150: R1 in ( dom D152 ) by L1149 , ZFMISC_1:87;
L1151: 1 <= R1 by L1150 , L1148 , FINSEQ_1:1;
L1152: R2 in ( Seg ( width D152 ) ) by L1149 , ZFMISC_1:87;
L1153: 1 <= R2 by L1152 , FINSEQ_1:1;
L1154:
now
per cases ;
suppose L1155: (R1 <= ( Sum D155 ) & R2 <= ( Sum D156 ));

L1156: R1 in ( dom D150 ) by L1155 , L1134 , L1151 , FINSEQ_3:25;
L1157: R2 in ( Seg ( width D150 ) ) by L1139 , L1152 , L1153 , L1155;
L1158: [ R1 , R2 ] in ( Indices D150 ) by L1157 , L1156 , ZFMISC_1:87;
thus L1159: ( D152 * (R1 , R2) ) = ( D150 * (R1 , R2) ) by L1158 , L834
.= ( D154 * (R1 , R2) ) by L1158 , L834;
end;
suppose L1160: ((R1 > ( Sum D155 ) & R2 <= ( Sum D156 )) or (R1 <= ( Sum D155 ) & R2 > ( Sum D156 )));

thus L1161: ( D152 * (R1 , R2) ) = R13 by L1160 , L1149 , L934
.= ( D154 * (R1 , R2) ) by L1146 , L1149 , L1160 , L934;
end;
suppose L1162: (R1 > ( Sum D155 ) & R2 > ( Sum D156 ));

reconsider D161 = ( R1 - ( Sum D155 ) ) , D162 = ( R2 - ( Sum D156 ) ) as (Element of ( NAT )) by L1162 , NAT_1:21;
L1163: D162 <> ( 0 ) by L1162;
L1164: R1 = ( D161 + ( Sum D155 ) );
L1165: R2 = ( D162 + ( Sum D156 ) );
L1166: D161 <> ( 0 ) by L1162;
L1167: [ D161 , D162 ] in ( Indices D151 ) by L1166 , L1149 , L1164 , L1165 , L1163 , L861;
thus L1168: ( D152 * (R1 , R2) ) = ( D151 * (D161 , D162) ) by L1167 , L1164 , L1165 , L888
.= ( D154 * (R1 , R2) ) by L1144 , L1164 , L1165 , L1167 , L888;
end;
end;
thus L1170: ( D152 * (R1 , R2) ) = ( D154 * (R1 , R2) ) by L1154;
end;
thus L1171: thesis by L1147 , L1141 , L1135 , L1129 , L1140 , L1145 , L1133 , L1138 , L1143 , L1130 , MATRIX_1:21 , RVSUM_1:75;
end;
theorem
L1172: (for R1 being Nat holds (for R3 being Nat holds (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R26 being (FinSequence_of_Matrix of R12) holds ((R1 in ( Seg ( Sum ( Len R26 ) ) ) & R3 = ( min (( Len R26 ) , R1) )) implies ( Line (( block_diagonal (R26 , R13) ) , R1) ) = ( ( ( ( Sum ( Width ( R26 | ( R3 -' 1 ) ) ) ) |-> R13 ) ^ ( Line (( R26 . R3 ) , ( R1 -' ( Sum ( Len ( R26 | ( R3 -' 1 ) ) ) ) )) ) ) ^ ( ( ( Sum ( Width R26 ) ) -' ( Sum ( Width ( R26 | R3 ) ) ) ) |-> R13 ) )))))))
proof
let R1 being Nat;
let R3 being Nat;
let R12 being non  empty set;
let R13 being (Element of R12);
let R26 being (FinSequence_of_Matrix of R12);
assume that
L1173: R1 in ( Seg ( Sum ( Len R26 ) ) )
and
L1174: R3 = ( min (( Len R26 ) , R1) );
set D163 = ( Len R26 );
L1175: ( ( D163 | R3 ) . R3 ) = ( D163 . R3 ) by FINSEQ_3:112;
set D164 = ( block_diagonal (( R26 /^ R3 ) , R13) );
set D165 = ( block_diagonal (( R26 | R3 ) , R13) );
L1176: ( len D165 ) = ( Sum ( Len ( R26 | R3 ) ) ) by L537
.= ( Sum ( D163 | R3 ) ) by L477;
L1177: R26 = ( ( R26 | R3 ) ^ ( R26 /^ R3 ) ) by RFINSEQ:8;
L1178: ( block_diagonal (R26 , R13) ) = ( block_diagonal (( ( R26 | R3 ) ^ <* D164 *> ) , R13) ) by L1177 , L1126
.= ( block_diagonal (<* D165 , D164 *> , R13) ) by L1078;
L1179: ( Sum ( Width R26 ) ) = ( width ( block_diagonal (<* D165 , D164 *> , R13) ) ) by L1178 , L537
.= ( Sum ( Width <* D165 , D164 *> ) ) by L537
.= ( ( width D165 ) + ( width D164 ) ) by L523
.= ( ( Sum ( Width ( R26 | R3 ) ) ) + ( width D164 ) ) by L537;
L1180: ( ( Sum ( Width R26 ) ) -' ( Sum ( Width ( R26 | R3 ) ) ) ) = ( ( ( Sum ( Width ( R26 | R3 ) ) ) + ( width D164 ) ) - ( Sum ( Width ( R26 | R3 ) ) ) ) by L1179 , NAT_1:11 , XREAL_1:233
.= ( width D164 );
L1181: ( Sum ( D163 | ( R3 -' 1 ) ) ) < R1 by L1173 , L1174 , L222;
L1182: ( R1 - ( Sum ( D163 | ( R3 -' 1 ) ) ) ) = ( R1 -' ( Sum ( D163 | ( R3 -' 1 ) ) ) ) by L1181 , XREAL_1:233;
L1183: R3 in ( dom D163 ) by L1173 , L1174 , L179;
L1184: 1 <= R3 by L1183 , FINSEQ_3:25;
L1185: ( R3 -' 1 ) = ( R3 - 1 ) by L1184 , XREAL_1:233;
L1186: R3 = ( ( R3 -' 1 ) + 1 ) by L1185;
L1187: ( R3 -' 1 ) <= R3 by L1186 , NAT_1:11;
L1188: ( Seg ( R3 -' 1 ) ) c= ( Seg R3 ) by L1187 , FINSEQ_1:5;
L1189: ( ( R26 | R3 ) | ( R3 -' 1 ) ) = ( R26 | ( R3 -' 1 ) ) by L1188 , RELAT_1:74;
L1190: R3 <= ( len D163 ) by L1183 , FINSEQ_3:25;
L1191: ( len ( D163 | R3 ) ) = R3 by L1190 , FINSEQ_1:59;
L1192: ( D163 | R3 ) = ( ( ( D163 | R3 ) | ( R3 -' 1 ) ) ^ <* ( ( D163 | R3 ) . R3 ) *> ) by L1191 , L1186 , FINSEQ_3:55;
L1193: ( ( D163 | R3 ) | ( R3 -' 1 ) ) = ( D163 | ( R3 -' 1 ) ) by L1188 , RELAT_1:74;
L1194: ( Sum ( D163 | R3 ) ) = ( ( Sum ( D163 | ( R3 -' 1 ) ) ) + ( D163 . R3 ) ) by L1193 , L1192 , L1175 , RVSUM_1:74
.= ( ( Sum ( D163 | ( R3 -' 1 ) ) ) + ( len ( R26 . R3 ) ) ) by L1183 , L387;
L1195: ( ( len ( R26 . R3 ) ) + ( Sum ( D163 | ( R3 -' 1 ) ) ) ) >= ( ( R1 -' ( Sum ( D163 | ( R3 -' 1 ) ) ) ) + ( Sum ( D163 | ( R3 -' 1 ) ) ) ) by L1194 , L1173 , L1174 , L1182 , L179;
L1196: ( len ( R26 . R3 ) ) >= ( R1 -' ( Sum ( D163 | ( R3 -' 1 ) ) ) ) by L1195 , XREAL_1:6;
L1197: ( R1 - ( Sum ( D163 | ( R3 -' 1 ) ) ) ) <> ( 0 ) by L1173 , L1174 , L222;
L1198: ( R1 -' ( Sum ( D163 | ( R3 -' 1 ) ) ) ) >= 1 by L1197 , L1182 , NAT_1:14;
L1199: ( R1 -' ( Sum ( D163 | ( R3 -' 1 ) ) ) ) in ( dom ( R26 . R3 ) ) by L1198 , L1196 , FINSEQ_3:25;
set D166 = ( block_diagonal (( R26 | ( R3 -' 1 ) ) , R13) );
L1200: ( ( R26 | R3 ) . R3 ) = ( R26 . R3 ) by FINSEQ_3:112;
L1201: ( width D166 ) = ( Sum ( Width ( R26 | ( R3 -' 1 ) ) ) ) by L537
.= ( Sum ( ( Width R26 ) | ( R3 -' 1 ) ) ) by L525;
L1202: 1 <= R1 by L1173 , FINSEQ_1:1;
L1203: R1 <= ( Sum ( D163 | R3 ) ) by L1173 , L1174 , L179;
L1204: R1 in ( dom D165 ) by L1203 , L1202 , L1176 , FINSEQ_3:25;
L1205: ( Line (( block_diagonal (R26 , R13) ) , R1) ) = ( ( Line (D165 , R1) ) ^ ( ( width D164 ) |-> R13 ) ) by L1204 , L1178 , L576;
L1206: ( dom D163 ) = ( dom R26 ) by L387;
L1207: R3 <= ( len R26 ) by L1206 , L1183 , FINSEQ_3:25;
L1208: ( len ( R26 | R3 ) ) = R3 by L1207 , FINSEQ_1:59;
L1209: ( R26 | R3 ) = ( ( ( R26 | R3 ) | ( R3 -' 1 ) ) ^ <* ( ( R26 | R3 ) . R3 ) *> ) by L1208 , L1186 , FINSEQ_3:55;
L1210: D165 = ( block_diagonal (<* D166 , ( R26 . R3 ) *> , R13) ) by L1209 , L1200 , L1189 , L1078;
L1211: ( len D166 ) = ( Sum ( Len ( R26 | ( R3 -' 1 ) ) ) ) by L537
.= ( Sum ( D163 | ( R3 -' 1 ) ) ) by L477;
L1212: ( ( ( Sum ( ( Width R26 ) | ( R3 -' 1 ) ) ) |-> R13 ) ^ ( Line (( R26 . R3 ) , ( R1 -' ( Sum ( D163 | ( R3 -' 1 ) ) ) )) ) ) = ( Line (D165 , ( ( Sum ( D163 | ( R3 -' 1 ) ) ) + ( R1 -' ( Sum ( D163 | ( R3 -' 1 ) ) ) ) )) ) by L1211 , L1199 , L1201 , L1210 , L576
.= ( Line (D165 , R1) ) by L1182;
L1213: ( Line (D165 , R1) ) = ( ( ( Sum ( Width ( R26 | ( R3 -' 1 ) ) ) ) |-> R13 ) ^ ( Line (( R26 . R3 ) , ( R1 -' ( Sum ( D163 | ( R3 -' 1 ) ) ) )) ) ) by L1212 , L525;
thus L1214: thesis by L1213 , L1180 , L1205 , L477;
end;
theorem
L1215: (for R1 being Nat holds (for R3 being Nat holds (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R26 being (FinSequence_of_Matrix of R12) holds ((R1 in ( Seg ( Sum ( Width R26 ) ) ) & R3 = ( min (( Width R26 ) , R1) )) implies ( Col (( block_diagonal (R26 , R13) ) , R1) ) = ( ( ( ( Sum ( Len ( R26 | ( R3 -' 1 ) ) ) ) |-> R13 ) ^ ( Col (( R26 . R3 ) , ( R1 -' ( Sum ( Width ( R26 | ( R3 -' 1 ) ) ) ) )) ) ) ^ ( ( ( Sum ( Len R26 ) ) -' ( Sum ( Len ( R26 | R3 ) ) ) ) |-> R13 ) )))))))
proof
let R1 being Nat;
let R3 being Nat;
let R12 being non  empty set;
let R13 being (Element of R12);
let R26 being (FinSequence_of_Matrix of R12);
assume that
L1216: R1 in ( Seg ( Sum ( Width R26 ) ) )
and
L1217: R3 = ( min (( Width R26 ) , R1) );
set D167 = ( Width R26 );
L1218: ( ( D167 | R3 ) . R3 ) = ( D167 . R3 ) by FINSEQ_3:112;
set D168 = ( block_diagonal (( R26 /^ R3 ) , R13) );
set D169 = ( block_diagonal (( R26 | R3 ) , R13) );
set D170 = ( Len R26 );
L1219: ( width D169 ) = ( Sum ( Width ( R26 | R3 ) ) ) by L537
.= ( Sum ( D167 | R3 ) ) by L525;
L1220: R26 = ( ( R26 | R3 ) ^ ( R26 /^ R3 ) ) by RFINSEQ:8;
L1221: ( block_diagonal (R26 , R13) ) = ( block_diagonal (( ( R26 | R3 ) ^ <* D168 *> ) , R13) ) by L1220 , L1126
.= ( block_diagonal (<* D169 , D168 *> , R13) ) by L1078;
L1222: ( Sum D170 ) = ( len ( block_diagonal (<* D169 , D168 *> , R13) ) ) by L1221 , L537
.= ( Sum ( Len <* D169 , D168 *> ) ) by L537
.= ( ( len D169 ) + ( len D168 ) ) by L475
.= ( ( Sum ( Len ( R26 | R3 ) ) ) + ( len D168 ) ) by L537;
L1223: ( ( Sum ( Len R26 ) ) -' ( Sum ( Len ( R26 | R3 ) ) ) ) = ( ( ( Sum ( Len ( R26 | R3 ) ) ) + ( len D168 ) ) - ( Sum ( Len ( R26 | R3 ) ) ) ) by L1222 , NAT_1:11 , XREAL_1:233
.= ( len D168 );
L1224: ( Sum ( D167 | ( R3 -' 1 ) ) ) < R1 by L1216 , L1217 , L222;
L1225: ( R1 - ( Sum ( D167 | ( R3 -' 1 ) ) ) ) = ( R1 -' ( Sum ( D167 | ( R3 -' 1 ) ) ) ) by L1224 , XREAL_1:233;
L1226: R3 in ( dom D167 ) by L1216 , L1217 , L179;
L1227: 1 <= R3 by L1226 , FINSEQ_3:25;
L1228: ( R3 -' 1 ) = ( R3 - 1 ) by L1227 , XREAL_1:233;
L1229: R3 = ( ( R3 -' 1 ) + 1 ) by L1228;
L1230: ( R3 -' 1 ) <= R3 by L1229 , NAT_1:11;
L1231: ( Seg ( R3 -' 1 ) ) c= ( Seg R3 ) by L1230 , FINSEQ_1:5;
L1232: ( ( R26 | R3 ) | ( R3 -' 1 ) ) = ( R26 | ( R3 -' 1 ) ) by L1231 , RELAT_1:74;
L1233: R3 <= ( len D167 ) by L1226 , FINSEQ_3:25;
L1234: ( len ( D167 | R3 ) ) = R3 by L1233 , FINSEQ_1:59;
L1235: ( D167 | R3 ) = ( ( ( D167 | R3 ) | ( R3 -' 1 ) ) ^ <* ( ( D167 | R3 ) . R3 ) *> ) by L1234 , L1229 , FINSEQ_3:55;
L1236: ( ( D167 | R3 ) | ( R3 -' 1 ) ) = ( D167 | ( R3 -' 1 ) ) by L1231 , RELAT_1:74;
L1237: ( Sum ( D167 | R3 ) ) = ( ( Sum ( D167 | ( R3 -' 1 ) ) ) + ( D167 . R3 ) ) by L1236 , L1235 , L1218 , RVSUM_1:74
.= ( ( Sum ( D167 | ( R3 -' 1 ) ) ) + ( width ( R26 . R3 ) ) ) by L1226 , L399;
L1238: ( ( width ( R26 . R3 ) ) + ( Sum ( D167 | ( R3 -' 1 ) ) ) ) >= ( ( R1 -' ( Sum ( D167 | ( R3 -' 1 ) ) ) ) + ( Sum ( D167 | ( R3 -' 1 ) ) ) ) by L1237 , L1216 , L1217 , L1225 , L179;
L1239: ( width ( R26 . R3 ) ) >= ( R1 -' ( Sum ( D167 | ( R3 -' 1 ) ) ) ) by L1238 , XREAL_1:6;
L1240: ( R1 - ( Sum ( D167 | ( R3 -' 1 ) ) ) ) <> ( 0 ) by L1216 , L1217 , L222;
L1241: ( R1 -' ( Sum ( D167 | ( R3 -' 1 ) ) ) ) >= 1 by L1240 , L1225 , NAT_1:14;
L1242: ( R1 -' ( Sum ( D167 | ( R3 -' 1 ) ) ) ) in ( Seg ( width ( R26 . R3 ) ) ) by L1241 , L1239;
set D171 = ( block_diagonal (( R26 | ( R3 -' 1 ) ) , R13) );
L1243: ( ( R26 | R3 ) . R3 ) = ( R26 . R3 ) by FINSEQ_3:112;
L1244: ( width D171 ) = ( Sum ( Width ( R26 | ( R3 -' 1 ) ) ) ) by L537
.= ( Sum ( D167 | ( R3 -' 1 ) ) ) by L525;
L1245: 1 <= R1 by L1216 , FINSEQ_1:1;
L1246: R1 <= ( Sum ( D167 | R3 ) ) by L1216 , L1217 , L179;
L1247: R1 in ( Seg ( width D169 ) ) by L1246 , L1245 , L1219 , FINSEQ_1:1;
L1248: ( Col (( block_diagonal (R26 , R13) ) , R1) ) = ( ( Col (D169 , R1) ) ^ ( ( len D168 ) |-> R13 ) ) by L1247 , L1221 , L707;
L1249: ( dom D167 ) = ( dom R26 ) by L399;
L1250: R3 <= ( len R26 ) by L1249 , L1226 , FINSEQ_3:25;
L1251: ( len ( R26 | R3 ) ) = R3 by L1250 , FINSEQ_1:59;
L1252: ( R26 | R3 ) = ( ( ( R26 | R3 ) | ( R3 -' 1 ) ) ^ <* ( ( R26 | R3 ) . R3 ) *> ) by L1251 , L1229 , FINSEQ_3:55;
L1253: D169 = ( block_diagonal (<* D171 , ( R26 . R3 ) *> , R13) ) by L1252 , L1243 , L1232 , L1078;
L1254: ( len D171 ) = ( Sum ( Len ( R26 | ( R3 -' 1 ) ) ) ) by L537
.= ( Sum ( D170 | ( R3 -' 1 ) ) ) by L477;
L1255: ( ( ( Sum ( D170 | ( R3 -' 1 ) ) ) |-> R13 ) ^ ( Col (( R26 . R3 ) , ( R1 -' ( Sum ( D167 | ( R3 -' 1 ) ) ) )) ) ) = ( Col (D169 , ( ( Sum ( D167 | ( R3 -' 1 ) ) ) + ( R1 -' ( Sum ( D167 | ( R3 -' 1 ) ) ) ) )) ) by L1254 , L1242 , L1244 , L1253 , L707
.= ( Col (D169 , R1) ) by L1225;
L1256: ( Col (D169 , R1) ) = ( ( ( Sum ( Len ( R26 | ( R3 -' 1 ) ) ) ) |-> R13 ) ^ ( Col (( R26 . R3 ) , ( R1 -' ( Sum ( D167 | ( R3 -' 1 ) ) ) )) ) ) by L1255 , L477;
thus L1257: thesis by L1256 , L1223 , L1248 , L525;
end;
theorem
L1258: (for R12 being non  empty set holds (for R14 being (Element of R12) holds (for R15 being (Element of R12) holds (for B19 , B20 , B21 , B22 being (Matrix of R12) holds ((( len B19 ) = ( len B21 ) & ( width B19 ) = ( width B21 ) & ( len B20 ) = ( len B22 ) & ( width B20 ) = ( width B22 ) & ( block_diagonal (<* B19 , B20 *> , R14) ) = ( block_diagonal (<* B21 , B22 *> , R15) )) implies (B19 = B21 & B20 = B22))))))
proof
let R12 being non  empty set;
let R14 being (Element of R12);
let R15 being (Element of R12);
let C33 , C34 , C35 , C36 being (Matrix of R12);
assume that
L1259: ( len C33 ) = ( len C35 )
and
L1260: ( width C33 ) = ( width C35 )
and
L1261: ( len C34 ) = ( len C36 )
and
L1262: ( width C34 ) = ( width C36 )
and
L1263: ( block_diagonal (<* C33 , C34 *> , R14) ) = ( block_diagonal (<* C35 , C36 *> , R15) );
set D172 = <* C35 *>;
set D173 = <* C33 *>;
L1264: ( Sum ( Width D173 ) ) = ( Sum <* ( width C33 ) *> ) by L512
.= ( Sum ( Width D172 ) ) by L1260 , L512;
set D174 = <* C36 *>;
set D175 = <* C34 *>;
thus L1265: C33 = ( Segm (( block_diagonal (( D173 ^ D175 ) , R14) ) , ( Seg ( len C33 ) ) , ( Seg ( width C33 ) )) ) by L1034
.= ( Segm (( block_diagonal (( D172 ^ D174 ) , R15) ) , ( Seg ( len C35 ) ) , ( Seg ( width C35 ) )) ) by L1259 , L1260 , L1263
.= C35 by L1034;
L1266: ( Sum ( Len D173 ) ) = ( Sum <* ( len C33 ) *> ) by L464
.= ( Sum ( Len D172 ) ) by L1259 , L464;
thus L1267: C34 = ( Segm (( block_diagonal (( D173 ^ D175 ) , R14) ) , ( ( Seg ( ( len C34 ) + ( Sum ( Len D173 ) ) ) ) \ ( Seg ( Sum ( Len D173 ) ) ) ) , ( ( Seg ( ( width C34 ) + ( Sum ( Width D173 ) ) ) ) \ ( Seg ( Sum ( Width D173 ) ) ) )) ) by L1052
.= C36 by L1261 , L1262 , L1263 , L1266 , L1264 , L1052;
end;
theorem
L1268: (for R12 being non  empty set holds (for R13 being (Element of R12) holds (for R16 being (Matrix of R12) holds (for R26 being (FinSequence_of_Matrix of R12) holds (R16 = ( {} ) implies (( block_diagonal (( R26 ^ <* R16 *> ) , R13) ) = ( block_diagonal (R26 , R13) ) & ( block_diagonal (( <* R16 *> ^ R26 ) , R13) ) = ( block_diagonal (R26 , R13) )))))))
proof
let R12 being non  empty set;
let R13 being (Element of R12);
let R16 being (Matrix of R12);
let R26 being (FinSequence_of_Matrix of R12);
set D176 = <* R16 *>;
set D177 = ( block_diagonal (R26 , R13) );
set D178 = <* D177 *>;
set D179 = ( block_diagonal (( D178 ^ D176 ) , R13) );
set D180 = ( block_diagonal (( D176 ^ D178 ) , R13) );
set D181 = ( block_diagonal (( R26 ^ D176 ) , R13) );
set D182 = ( block_diagonal (( D176 ^ R26 ) , R13) );
L1269: ( width D180 ) = ( Sum ( Width ( D176 ^ D178 ) ) ) by L537;
L1270: ( Len ( D178 ^ D176 ) ) = ( ( Len D178 ) ^ ( Len D176 ) ) by L441;
L1271: ( Sum ( Len D178 ) ) = ( len D177 ) by L472;
assume L1272: R16 = ( {} );
L1273: ( len R16 ) = ( 0 ) by L1272;
L1274: ( Sum ( Len D176 ) ) = ( 0 ) by L1273 , L472;
L1275: ( width R16 ) = ( 0 ) by L1272 , CARD_1:27 , MATRIX_1:def 3;
L1276: ( Sum ( Width D176 ) ) = ( 0 ) by L1275 , L520;
L1277: ( Sum ( Len D176 ) ) = ( len R16 ) by L472;
L1278: ( Seg ( Sum ( Width D176 ) ) ) = ( {} ) by L1276;
L1279: ( len D179 ) = ( Sum ( Len ( D178 ^ D176 ) ) ) by L537;
L1280: ( len D179 ) = ( ( len D177 ) + ( len R16 ) ) by L1279 , L1270 , L1277 , L1271 , RVSUM_1:75;
L1281: ( Len ( D176 ^ D178 ) ) = ( ( Len D176 ) ^ ( Len D178 ) ) by L441;
L1282: ( len D180 ) = ( Sum ( Len ( D176 ^ D178 ) ) ) by L537;
L1283: ( len D180 ) = ( ( len R16 ) + ( len D177 ) ) by L1282 , L1281 , L1277 , L1271 , RVSUM_1:75;
L1284: ( Width ( D176 ^ D178 ) ) = ( ( Width D176 ) ^ ( Width D178 ) ) by L489;
L1285: ( Width ( D178 ^ D176 ) ) = ( ( Width D178 ) ^ ( Width D176 ) ) by L489;
L1286: ( Sum ( Width D176 ) ) = ( width R16 ) by L520;
L1287: ( Sum ( Width D178 ) ) = ( width D177 ) by L520;
L1288: ( width D179 ) = ( Sum ( Width ( D178 ^ D176 ) ) ) by L537;
L1289: ( width D179 ) = ( ( width D177 ) + ( width R16 ) ) by L1288 , L1285 , L1286 , L1287 , RVSUM_1:75;
thus L1290: D181 = D179 by L1078
.= ( Segm (D179 , ( Seg ( len D179 ) ) , ( Seg ( width D179 ) )) ) by MATRIX13:46
.= D177 by L1273 , L1275 , L1280 , L1289 , L1034;
thus L1291: D182 = D180 by L1126
.= ( Segm (D180 , ( Seg ( len D180 ) ) , ( Seg ( width D180 ) )) ) by MATRIX13:46
.= ( Segm (D180 , ( ( Seg ( ( len D177 ) + ( Sum ( Len D176 ) ) ) ) \ ( Seg ( Sum ( Len D176 ) ) ) ) , ( ( Seg ( ( width D177 ) + ( Sum ( Width D176 ) ) ) ) \ ( Seg ( Sum ( Width D176 ) ) ) )) ) by L1273 , L1269 , L1284 , L1287 , L1283 , L1274 , L1276 , L1278 , RVSUM_1:75
.= D177 by L1052;
end;
theorem
L1292: (for R1 being Nat holds (for R8 being Field holds (for R9 being (Element of R8) holds (for R19 being (Matrix of R8) holds (for R29 being (FinSequence_of_Matrix of R8) holds ((R1 in ( dom R19 ) & ( width R19 ) = ( width ( DelLine (R19 , R1) ) )) implies ( DelLine (( block_diagonal (( <* R19 *> ^ R29 ) , R9) ) , R1) ) = ( block_diagonal (( <* ( DelLine (R19 , R1) ) *> ^ R29 ) , R9) )))))))
proof
let R1 being Nat;
let R8 being Field;
let R9 being (Element of R8);
let R19 being (Matrix of R8);
let R29 being (FinSequence_of_Matrix of R8);
assume that
L1293: R1 in ( dom R19 )
and
L1294: ( width R19 ) = ( width ( DelLine (R19 , R1) ) );
L1295: R1 in ( Seg ( len R19 ) ) by L1293 , FINSEQ_1:def 3;
set D183 = ( DelLine (R19 , R1) );
consider R3 being Nat such that L1296: ( len R19 ) = ( R3 + 1 ) and L1297: ( len D183 ) = R3 by L1293 , FINSEQ_3:104;
set D184 = ( block_diagonal (R29 , R9) );
set D185 = <* D183 *>;
set D186 = <* R19 *>;
set D187 = <* D184 *>;
set D188 = ( block_diagonal (<* R19 , D184 *> , R9) );
set D189 = ( block_diagonal (<* D183 , D184 *> , R9) );
L1298: ( Seg ( len D188 ) ) = ( dom D188 ) by FINSEQ_1:def 3;
L1299: ( len D188 ) = ( Sum ( Len ( D186 ^ D187 ) ) ) by L537;
L1300: ( len D188 ) = ( ( len R19 ) + ( len D184 ) ) by L1299 , L475;
L1301: ( len D188 ) >= ( len R19 ) by L1300 , NAT_1:11;
L1302: ( Seg ( len R19 ) ) c= ( Seg ( len D188 ) ) by L1301 , FINSEQ_1:5;
L1303: ( len D189 ) = ( Sum ( Len ( D185 ^ D187 ) ) ) by L537;
L1304: ( len D189 ) = ( R3 + ( len D184 ) ) by L1303 , L1297 , L475;
L1305: ( len D188 ) = ( ( R3 + ( len D184 ) ) + 1 ) by L1296 , L1300;
L1306: ( len D189 ) = ( ( len D183 ) + ( len D184 ) ) by L1303 , L475;
L1307:
now
L1308: ( R3 + ( len D184 ) ) <= ( len D188 ) by L1305 , NAT_1:11;
L1309: ( Seg ( R3 + ( len D184 ) ) ) c= ( Seg ( len D188 ) ) by L1308 , FINSEQ_1:5;
reconsider D190 = D183 as (Matrix of ( len D183 ) , ( width D183 ) , R8) by MATRIX_2:7;
reconsider D191 = R19 as (Matrix of ( len R19 ) , ( width R19 ) , R8) by MATRIX_2:7;
let R2 being Nat;
assume that
L1310: 1 <= R2
and
L1311: R2 <= ( R3 + ( len D184 ) );
L1312: R2 in ( Seg ( R3 + ( len D184 ) ) ) by L1310 , L1311 , FINSEQ_1:1;
L1313: 1 <= ( 1 + R2 ) by NAT_1:11;
L1314: ( R2 + 1 ) <= ( len D188 ) by L1305 , L1311 , XREAL_1:7;
L1315: ( R2 + 1 ) in ( Seg ( len D188 ) ) by L1314 , L1313;
L1316:
now
per cases ;
suppose L1317: R2 < R1;

L1318: R1 <= ( len R19 ) by L1295 , FINSEQ_1:1;
L1319: R2 < ( len R19 ) by L1318 , L1317 , XXREAL_0:2;
L1320: R2 <= R3 by L1319 , L1296 , NAT_1:13;
L1321: R2 in ( dom D183 ) by L1320 , L1297 , L1310 , FINSEQ_3:25;
L1322: R2 in ( dom R19 ) by L1310 , L1319 , FINSEQ_3:25;
L1323: R2 in ( Seg R3 ) by L1322 , L1310 , L1320;
L1324: R2 in ( Seg ( len R19 ) ) by L1310 , L1319 , FINSEQ_1:1;
L1325: ( Line (D191 , R2) ) = ( R19 . R2 ) by L1324 , MATRIX_2:8
.= ( D190 . R2 ) by L1317 , FINSEQ_3:110
.= ( Line (D183 , R2) ) by L1297 , L1323 , MATRIX_2:8;
thus L1326: ( ( Del (D188 , R1) ) . R2 ) = ( D188 . R2 ) by L1317 , FINSEQ_3:110
.= ( Line (D188 , R2) ) by L1299 , L1312 , L1309 , MATRIX_2:8
.= ( ( Line (D183 , R2) ) ^ ( ( width D184 ) |-> R9 ) ) by L1322 , L1325 , L576
.= ( Line (D189 , R2) ) by L1321 , L576
.= ( D189 . R2 ) by L1297 , L1303 , L1306 , L1312 , MATRIX_2:8;
end;
suppose L1327: R2 >= R1;

L1328: ( ( Del (D188 , R1) ) . R2 ) = ( D188 . ( R2 + 1 ) ) by L1327 , L1305 , L1302 , L1295 , L1298 , L1311 , FINSEQ_3:111
.= ( Line (D188 , ( R2 + 1 )) ) by L1299 , L1315 , MATRIX_2:8;
L1329:
now
per cases ;
suppose L1330: ( R2 + 1 ) <= ( len R19 );

L1331: ( R2 + 1 ) in ( dom R19 ) by L1330 , L1313 , FINSEQ_3:25;
L1332: R2 <= R3 by L1296 , L1330 , XREAL_1:8;
L1333: R2 in ( Seg R3 ) by L1332 , L1310 , FINSEQ_1:1;
L1334: R2 in ( dom D183 ) by L1297 , L1310 , L1332 , FINSEQ_3:25;
L1335: ( R2 + 1 ) in ( Seg ( len R19 ) ) by L1313 , L1330;
L1336: ( Line (D191 , ( R2 + 1 )) ) = ( R19 . ( R2 + 1 ) ) by L1335 , MATRIX_2:8
.= ( D190 . R2 ) by L1293 , L1296 , L1327 , L1332 , FINSEQ_3:111
.= ( Line (D183 , R2) ) by L1297 , L1333 , MATRIX_2:8;
thus L1337: ( ( Del (D188 , R1) ) . R2 ) = ( ( Line (D183 , R2) ) ^ ( ( width D184 ) |-> R9 ) ) by L1336 , L1328 , L1331 , L576
.= ( Line (D189 , R2) ) by L1334 , L576;
end;
suppose L1338: ( R2 + 1 ) > ( len R19 );

reconsider D192 = ( ( R2 + 1 ) - ( len R19 ) ) as (Element of ( NAT )) by L1338 , NAT_1:21;
L1339: D192 <> ( 0 ) by L1338;
L1340: D192 >= 1 by L1339 , NAT_1:14;
L1341: ( D192 + ( len R19 ) ) <= ( ( len D184 ) + ( len R19 ) ) by L1300 , L1305 , L1311 , XREAL_1:7;
L1342: D192 <= ( len D184 ) by L1341 , XREAL_1:8;
L1343: D192 in ( dom D184 ) by L1342 , L1340 , FINSEQ_3:25;
thus L1344: ( ( Del (D188 , R1) ) . R2 ) = ( Line (D188 , ( D192 + ( len R19 ) )) ) by L1328
.= ( ( ( width D183 ) |-> R9 ) ^ ( Line (D184 , D192) ) ) by L1294 , L1343 , L576
.= ( Line (D189 , ( D192 + ( len D183 ) )) ) by L1343 , L576
.= ( Line (D189 , R2) ) by L1296 , L1297;
end;
end;
thus L1346: ( ( Del (D188 , R1) ) . R2 ) = ( D189 . R2 ) by L1329 , L1297 , L1303 , L1306 , L1312 , MATRIX_2:8;
end;
end;
thus L1348: ( ( Del (D188 , R1) ) . R2 ) = ( D189 . R2 ) by L1316;
end;
L1349: ( block_diagonal (( D185 ^ R29 ) , R9) ) = D189 by L1126;
L1350: ( block_diagonal (( D186 ^ R29 ) , R9) ) = D188 by L1126;
L1351: ( len ( Del (D188 , R1) ) ) = ( R3 + ( len D184 ) ) by L1305 , L1302 , L1295 , L1298 , FINSEQ_3:109;
thus L1352: thesis by L1351 , L1304 , L1350 , L1349 , L1307 , FINSEQ_1:14;
end;
theorem
L1353: (for R1 being Nat holds (for R8 being Field holds (for R9 being (Element of R8) holds (for R19 being (Matrix of R8) holds (for R29 being (FinSequence_of_Matrix of R8) holds ((R1 in ( dom R19 ) & ( width R19 ) = ( width ( DelLine (R19 , R1) ) )) implies ( DelLine (( block_diagonal (( R29 ^ <* R19 *> ) , R9) ) , ( ( Sum ( Len R29 ) ) + R1 )) ) = ( block_diagonal (( R29 ^ <* ( DelLine (R19 , R1) ) *> ) , R9) )))))))
proof
let R1 being Nat;
let R8 being Field;
let R9 being (Element of R8);
let R19 being (Matrix of R8);
let R29 being (FinSequence_of_Matrix of R8);
assume that
L1354: R1 in ( dom R19 )
and
L1355: ( width R19 ) = ( width ( DelLine (R19 , R1) ) );
L1356: R1 in ( Seg ( len R19 ) ) by L1354 , FINSEQ_1:def 3;
set D193 = ( DelLine (R19 , R1) );
consider R3 being Nat such that L1357: ( len R19 ) = ( R3 + 1 ) and L1358: ( len D193 ) = R3 by L1354 , FINSEQ_3:104;
set D194 = ( ( Sum ( Len R29 ) ) + R1 );
set D195 = ( block_diagonal (R29 , R9) );
set D196 = <* D193 *>;
set D197 = <* R19 *>;
set D198 = <* D195 *>;
set D199 = ( block_diagonal (<* D195 , R19 *> , R9) );
set D200 = ( block_diagonal (<* D195 , D193 *> , R9) );
L1359: ( Seg ( len D199 ) ) = ( dom D199 ) by FINSEQ_1:def 3;
L1360: ( len D200 ) = ( Sum ( Len ( D198 ^ D196 ) ) ) by L537;
L1361: ( len D200 ) = ( R3 + ( len D195 ) ) by L1360 , L1358 , L475;
L1362: ( len D195 ) = ( Sum ( Len R29 ) ) by L537;
L1363: ( len D199 ) = ( Sum ( Len ( D198 ^ D197 ) ) ) by L537;
L1364: ( len D199 ) = ( ( len R19 ) + ( len D195 ) ) by L1363 , L475;
L1365: ( len D199 ) = ( ( R3 + ( len D195 ) ) + 1 ) by L1364 , L1357;
L1366: ( len D200 ) = ( ( len D193 ) + ( len D195 ) ) by L1360 , L475;
L1367:
now
L1368: ( R3 + ( len D195 ) ) <= ( len D199 ) by L1365 , NAT_1:11;
L1369: ( Seg ( R3 + ( len D195 ) ) ) c= ( Seg ( len D199 ) ) by L1368 , FINSEQ_1:5;
reconsider D201 = D193 as (Matrix of ( len D193 ) , ( width D193 ) , R8) by MATRIX_2:7;
reconsider D202 = R19 as (Matrix of ( len R19 ) , ( width R19 ) , R8) by MATRIX_2:7;
let R2 being Nat;
assume that
L1370: 1 <= R2
and
L1371: R2 <= ( R3 + ( len D195 ) );
L1372: R2 in ( Seg ( R3 + ( len D195 ) ) ) by L1370 , L1371 , FINSEQ_1:1;
L1373: 1 <= ( 1 + R2 ) by NAT_1:11;
L1374: ( R2 + 1 ) <= ( len D199 ) by L1365 , L1371 , XREAL_1:7;
L1375: ( R2 + 1 ) in ( Seg ( len D199 ) ) by L1374 , L1373;
L1376:
now
per cases ;
suppose L1377: R2 <= ( len D195 );

L1378: R2 in ( dom D195 ) by L1377 , L1370 , FINSEQ_3:25;
L1379: ( 0 ) < R1 by L1356 , FINSEQ_1:1;
L1380: ( R2 + ( 0 ) ) < ( ( len D195 ) + R1 ) by L1379 , L1377 , XREAL_1:8;
L1381: R2 < D194 by L1380 , L537;
thus L1382: ( ( Del (D199 , D194) ) . R2 ) = ( D199 . R2 ) by L1381 , FINSEQ_3:110
.= ( Line (D199 , R2) ) by L1363 , L1372 , L1369 , MATRIX_2:8
.= ( ( Line (D195 , R2) ) ^ ( ( width D193 ) |-> R9 ) ) by L1355 , L1378 , L576
.= ( Line (D200 , R2) ) by L1378 , L576
.= ( D200 . R2 ) by L1358 , L1360 , L1366 , L1372 , MATRIX_2:8;
end;
suppose L1383: R2 > ( len D195 );

reconsider D203 = ( R2 - ( len D195 ) ) as (Element of ( NAT )) by L1383 , NAT_1:21;
L1384: ( ( 0 ) + 1 ) <= ( D203 + 1 ) by NAT_1:13;
L1385: ( D203 + ( len D195 ) ) <= ( R3 + ( len D195 ) ) by L1371;
L1386: D203 <= R3 by L1385 , XREAL_1:8;
L1387: ( D203 + 1 ) <= ( len R19 ) by L1386 , L1357 , XREAL_1:7;
L1388: ( D203 + 1 ) in ( dom R19 ) by L1387 , L1384 , FINSEQ_3:25;
L1389: D203 <> ( 0 ) by L1383;
L1390: 1 <= D203 by L1389 , NAT_1:14;
L1391: D203 in ( dom D193 ) by L1390 , L1358 , L1386 , FINSEQ_3:25;
L1392: ( D203 + 1 ) in ( Seg ( len R19 ) ) by L1384 , L1387;
L1393: D203 in ( Seg ( len D193 ) ) by L1358 , L1390 , L1386;
L1394: D203 <= ( len R19 ) by L1357 , L1386 , NAT_1:13;
L1395: D203 in ( Seg ( len R19 ) ) by L1394 , L1390;
L1396: D203 in ( dom R19 ) by L1390 , L1394 , FINSEQ_3:25;
L1397:
now
per cases ;
suppose L1398: R2 < D194;

L1399: ( D203 + ( len D195 ) ) < ( R1 + ( len D195 ) ) by L1398 , L537;
L1400: D203 < R1 by L1399 , XREAL_1:7;
L1401: ( Line (R19 , D203) ) = ( D202 . D203 ) by L1395 , MATRIX_2:8
.= ( D201 . D203 ) by L1400 , FINSEQ_3:110
.= ( Line (D193 , D203) ) by L1393 , MATRIX_2:8;
thus L1402: ( ( Del (D199 , D194) ) . R2 ) = ( D199 . R2 ) by L1398 , FINSEQ_3:110
.= ( Line (D199 , ( D203 + ( len D195 ) )) ) by L1363 , L1372 , L1369 , MATRIX_2:8
.= ( ( ( width D195 ) |-> R9 ) ^ ( Line (D193 , D203) ) ) by L1396 , L1401 , L576
.= ( Line (D200 , ( D203 + ( len D195 ) )) ) by L1391 , L576;
end;
suppose L1403: R2 >= D194;

L1404: ( D203 + ( len D195 ) ) >= ( R1 + ( len D195 ) ) by L1403 , L537;
L1405: D203 >= R1 by L1404 , XREAL_1:8;
L1406: ( Line (R19 , ( 1 + D203 )) ) = ( D202 . ( 1 + D203 ) ) by L1392 , MATRIX_2:8
.= ( D201 . D203 ) by L1354 , L1357 , L1386 , L1405 , FINSEQ_3:111
.= ( Line (D193 , D203) ) by L1393 , MATRIX_2:8;
thus L1407: ( ( Del (D199 , D194) ) . R2 ) = ( D199 . ( R2 + 1 ) ) by L1362 , L1364 , L1365 , L1356 , L1359 , L1371 , L1403 , FINSEQ_1:60 , FINSEQ_3:111
.= ( Line (D199 , ( ( D203 + 1 ) + ( len D195 ) )) ) by L1363 , L1375 , MATRIX_2:8
.= ( ( ( width D195 ) |-> R9 ) ^ ( Line (D193 , D203) ) ) by L1388 , L1406 , L576
.= ( Line (D200 , ( D203 + ( len D195 ) )) ) by L1391 , L576;
end;
end;
thus L1409: ( ( Del (D199 , D194) ) . R2 ) = ( D200 . R2 ) by L1397 , L1358 , L1360 , L1366 , L1372 , MATRIX_2:8;
end;
end;
thus L1411: ( ( Del (D199 , ( R1 + ( Sum ( Len R29 ) ) )) ) . R2 ) = ( D200 . R2 ) by L1376;
end;
L1412: ( block_diagonal (( R29 ^ D196 ) , R9) ) = D200 by L1078;
L1413: ( block_diagonal (( R29 ^ D197 ) , R9) ) = D199 by L1078;
L1414: ( len ( Del (D199 , D194) ) ) = ( R3 + ( len D195 ) ) by L1362 , L1364 , L1365 , L1356 , L1359 , FINSEQ_1:60 , FINSEQ_3:109;
thus L1415: thesis by L1414 , L1361 , L1413 , L1412 , L1367 , FINSEQ_1:14;
end;
theorem
L1416: (for R1 being Nat holds (for R8 being Field holds (for R9 being (Element of R8) holds (for R19 being (Matrix of R8) holds (for R29 being (FinSequence_of_Matrix of R8) holds (R1 in ( Seg ( width R19 ) ) implies ( DelCol (( block_diagonal (( <* R19 *> ^ R29 ) , R9) ) , R1) ) = ( block_diagonal (( <* ( DelCol (R19 , R1) ) *> ^ R29 ) , R9) )))))))
proof
let R1 being Nat;
let R8 being Field;
let R9 being (Element of R8);
let R19 being (Matrix of R8);
let R29 being (FinSequence_of_Matrix of R8);
assume L1417: R1 in ( Seg ( width R19 ) );
set D204 = ( block_diagonal (R29 , R9) );
set D205 = ( DelCol (R19 , R1) );
set D206 = <* R19 *>;
set D207 = <* D205 *>;
set D208 = <* D204 *>;
set D209 = ( block_diagonal (<* R19 , D204 *> , R9) );
set D210 = ( block_diagonal (<* D205 , D204 *> , R9) );
L1418: ( len D205 ) = ( len R19 ) by MATRIX_2:def 5;
L1419: ( len D209 ) = ( Sum ( Len ( D206 ^ D208 ) ) ) by L537;
L1420: ( len D209 ) = ( ( len R19 ) + ( len D204 ) ) by L1419 , L475;
L1421: ( len D210 ) = ( Sum ( Len ( D207 ^ D208 ) ) ) by L537;
L1422: ( len D210 ) = ( ( len D205 ) + ( len D204 ) ) by L1421 , L475;
L1423:
now
reconsider D211 = D205 as (Matrix of ( len D205 ) , ( width D205 ) , R8) by MATRIX_2:7;
let R2 being Nat;
assume that
L1424: 1 <= R2
and
L1425: R2 <= ( len D210 );
L1426: R2 in ( Seg ( len D210 ) ) by L1424 , L1425 , FINSEQ_1:1;
L1427:
now
per cases ;
suppose L1428: R2 <= ( len R19 );

L1429: R2 in ( Seg ( len R19 ) ) by L1428 , L1424 , FINSEQ_1:1;
L1430: R2 in ( dom D205 ) by L1418 , L1424 , L1428 , FINSEQ_3:25;
L1431: ( dom ( Line (R19 , R2) ) ) = ( Seg ( width R19 ) ) by FINSEQ_2:124;
L1432: R2 in ( dom R19 ) by L1424 , L1428 , FINSEQ_3:25;
L1433: ( Line (D209 , R2) ) = ( ( Line (R19 , R2) ) ^ ( ( width D204 ) |-> R9 ) ) by L1432 , L576;
L1434: ( Del (( Line (R19 , R2) ) , R1) ) = ( D211 . R2 ) by L1432 , MATRIX_2:def 5
.= ( Line (D205 , R2) ) by L1418 , L1429 , MATRIX_2:8;
thus L1435: ( Del (( Line (D209 , R2) ) , R1) ) = ( ( Line (D205 , R2) ) ^ ( ( width D204 ) |-> R9 ) ) by L1434 , L1417 , L1433 , L1431 , L58
.= ( Line (D210 , R2) ) by L1430 , L576
.= ( D210 . R2 ) by L1421 , L1426 , MATRIX_2:8;
end;
suppose L1436: R2 > ( len R19 );

reconsider D212 = ( R2 - ( len R19 ) ) as (Element of ( NAT )) by L1436 , NAT_1:21;
L1437: D212 <> ( 0 ) by L1436;
L1438: D212 >= 1 by L1437 , NAT_1:14;
L1439: ( width R19 ) <> ( 0 ) by L1417;
reconsider D213 = ( ( width R19 ) - 1 ) as (Element of ( NAT )) by L1439 , NAT_1:14 , NAT_1:21;
L1440: ( dom ( ( width R19 ) |-> R9 ) ) = ( Seg ( width R19 ) ) by FINSEQ_2:124;
L1441: ( width D205 ) = ( ( D213 + 1 ) -' 1 ) by L1417 , LAPLACE:3
.= D213 by NAT_D:34;
L1442: ( D212 + ( len R19 ) ) <= ( ( len D204 ) + ( len R19 ) ) by L1422 , L1425 , MATRIX_2:def 5;
L1443: D212 <= ( len D204 ) by L1442 , XREAL_1:8;
L1444: D212 in ( dom D204 ) by L1443 , L1438 , FINSEQ_3:25;
L1445: ( Line (D209 , ( D212 + ( len R19 ) )) ) = ( ( ( width R19 ) |-> R9 ) ^ ( Line (D204 , D212) ) ) by L1444 , L576;
thus L1446: ( Del (( Line (D209 , R2) ) , R1) ) = ( ( Del (( ( D213 + 1 ) |-> R9 ) , R1) ) ^ ( Line (D204 , D212) ) ) by L1445 , L1417 , L1440 , L58
.= ( ( ( width D205 ) |-> R9 ) ^ ( Line (D204 , D212) ) ) by L1417 , L1441 , L147
.= ( Line (D210 , ( ( len R19 ) + D212 )) ) by L1418 , L1444 , L576
.= ( D210 . R2 ) by L1421 , L1426 , MATRIX_2:8;
end;
end;
L1448: R2 in ( dom D209 ) by L1418 , L1422 , L1420 , L1424 , L1425 , FINSEQ_3:25;
thus L1449: ( ( DelCol (D209 , R1) ) . R2 ) = ( D210 . R2 ) by L1448 , L1427 , MATRIX_2:def 5;
end;
L1450: ( block_diagonal (( D207 ^ R29 ) , R9) ) = D210 by L1126;
L1451: ( len ( DelCol (D209 , R1) ) ) = ( len D209 ) by MATRIX_2:def 5;
L1452: ( block_diagonal (( D206 ^ R29 ) , R9) ) = D209 by L1126;
thus L1453: thesis by L1452 , L1418 , L1451 , L1421 , L1420 , L1423 , L1450 , L475 , FINSEQ_1:14;
end;
theorem
L1454: (for R1 being Nat holds (for R8 being Field holds (for R9 being (Element of R8) holds (for R19 being (Matrix of R8) holds (for R29 being (FinSequence_of_Matrix of R8) holds (R1 in ( Seg ( width R19 ) ) implies ( DelCol (( block_diagonal (( R29 ^ <* R19 *> ) , R9) ) , ( R1 + ( Sum ( Width R29 ) ) )) ) = ( block_diagonal (( R29 ^ <* ( DelCol (R19 , R1) ) *> ) , R9) )))))))
proof
let R1 being Nat;
let R8 being Field;
let R9 being (Element of R8);
let R19 being (Matrix of R8);
let R29 being (FinSequence_of_Matrix of R8);
assume L1455: R1 in ( Seg ( width R19 ) );
set D214 = ( R1 + ( Sum ( Width R29 ) ) );
set D215 = ( block_diagonal (R29 , R9) );
set D216 = ( DelCol (R19 , R1) );
set D217 = <* R19 *>;
set D218 = <* D216 *>;
set D219 = <* D215 *>;
set D220 = ( block_diagonal (<* D215 , R19 *> , R9) );
set D221 = ( block_diagonal (<* D215 , D216 *> , R9) );
L1456: ( len D216 ) = ( len R19 ) by MATRIX_2:def 5;
L1457: ( len D220 ) = ( Sum ( Len ( D219 ^ D217 ) ) ) by L537;
L1458: ( len D220 ) = ( ( len D215 ) + ( len R19 ) ) by L1457 , L475;
L1459: ( width D215 ) = ( Sum ( Width R29 ) ) by L537;
L1460: ( len D221 ) = ( Sum ( Len ( D219 ^ D218 ) ) ) by L537;
L1461: ( len D221 ) = ( ( len D215 ) + ( len D216 ) ) by L1460 , L475;
L1462:
now
L1463: ( width R19 ) <> ( 0 ) by L1455;
L1464: ( width R19 ) >= 1 by L1463 , NAT_1:14;
L1465: ( ( width R19 ) -' 1 ) = ( ( width R19 ) - 1 ) by L1464 , XREAL_1:233;
L1466: ( width R19 ) = ( ( ( width R19 ) -' 1 ) + 1 ) by L1465;
L1467: ( dom ( ( width R19 ) |-> R9 ) ) = ( Seg ( width R19 ) ) by FINSEQ_2:124;
L1468: ( len ( ( width D215 ) |-> R9 ) ) = ( width D215 ) by CARD_1:def 7;
reconsider D222 = D216 as (Matrix of ( len D216 ) , ( width D216 ) , R8) by MATRIX_2:7;
let R2 being Nat;
assume that
L1469: 1 <= R2
and
L1470: R2 <= ( len D221 );
L1471: R2 in ( Seg ( len D221 ) ) by L1469 , L1470 , FINSEQ_1:1;
L1472: ( len ( Line (D215 , R2) ) ) = ( width D215 ) by MATRIX_1:def 7;
L1473:
now
per cases ;
suppose L1474: R2 <= ( len D215 );

L1475: R2 in ( dom D215 ) by L1474 , L1469 , FINSEQ_3:25;
L1476: ( Line (D220 , R2) ) = ( ( Line (D215 , R2) ) ^ ( ( width R19 ) |-> R9 ) ) by L1475 , L576;
thus L1477: ( Del (( Line (D220 , R2) ) , D214) ) = ( ( Line (D215 , R2) ) ^ ( Del (( ( width R19 ) |-> R9 ) , R1) ) ) by L1476 , L1455 , L1459 , L1467 , L1472 , L104
.= ( ( Line (D215 , R2) ) ^ ( ( ( width R19 ) -' 1 ) |-> R9 ) ) by L1455 , L1466 , L147
.= ( ( Line (D215 , R2) ) ^ ( ( width D216 ) |-> R9 ) ) by L1455 , LAPLACE:3
.= ( Line (D221 , R2) ) by L1475 , L576
.= ( D221 . R2 ) by L1460 , L1471 , MATRIX_2:8;
end;
suppose L1478: R2 > ( len D215 );

reconsider D223 = ( R2 - ( len D215 ) ) as (Element of ( NAT )) by L1478 , NAT_1:21;
L1479: D223 <> ( 0 ) by L1478;
L1480: D223 >= 1 by L1479 , NAT_1:14;
L1481: ( D223 + ( len D215 ) ) <= ( ( len D215 ) + ( len R19 ) ) by L1461 , L1470 , MATRIX_2:def 5;
L1482: D223 <= ( len R19 ) by L1481 , XREAL_1:8;
L1483: D223 in ( dom D216 ) by L1482 , L1456 , L1480 , FINSEQ_3:25;
L1484: D223 in ( Seg ( len R19 ) ) by L1480 , L1482;
L1485: D223 in ( dom R19 ) by L1480 , L1482 , FINSEQ_3:25;
L1486: ( Del (( Line (R19 , D223) ) , R1) ) = ( D222 . D223 ) by L1485 , MATRIX_2:def 5
.= ( Line (D216 , D223) ) by L1456 , L1484 , MATRIX_2:8;
L1487: ( dom ( Line (R19 , D223) ) ) = ( Seg ( width R19 ) ) by FINSEQ_2:124;
L1488: ( Line (D220 , ( D223 + ( len D215 ) )) ) = ( ( ( width D215 ) |-> R9 ) ^ ( Line (R19 , D223) ) ) by L1485 , L576;
thus L1489: ( Del (( Line (D220 , R2) ) , D214) ) = ( ( ( width D215 ) |-> R9 ) ^ ( Del (( Line (R19 , D223) ) , R1) ) ) by L1488 , L1455 , L1459 , L1468 , L1487 , L104
.= ( Line (D221 , ( ( len D215 ) + D223 )) ) by L1483 , L1486 , L576
.= ( D221 . R2 ) by L1460 , L1471 , MATRIX_2:8;
end;
end;
L1491: R2 in ( dom D220 ) by L1456 , L1461 , L1458 , L1469 , L1470 , FINSEQ_3:25;
thus L1492: ( ( DelCol (D220 , D214) ) . R2 ) = ( D221 . R2 ) by L1491 , L1473 , MATRIX_2:def 5;
end;
L1493: ( block_diagonal (( R29 ^ D218 ) , R9) ) = D221 by L1078;
L1494: ( len ( DelCol (D220 , D214) ) ) = ( len D220 ) by MATRIX_2:def 5;
L1495: ( block_diagonal (( R29 ^ D217 ) , R9) ) = D220 by L1078;
thus L1496: thesis by L1495 , L1456 , L1494 , L1460 , L1458 , L1462 , L1493 , L475 , FINSEQ_1:14;
end;
definition
let R12 being non  empty set;
let C37 being (FinSequence of ( ( R12 * ) * ));
attr C37 is  Square-Matrix-yielding
means
:L1497: (for R1 being Nat holds (R1 in ( dom C37 ) implies (ex R4 being Nat st ( C37 . R1 ) is (Matrix of R4 , R12))));
end;
registration
let R12 being non  empty set;
cluster  Square-Matrix-yielding for (FinSequence of ( ( R12 * ) * ));
existence
proof
reconsider D224 = ( <*> ( ( R12 * ) * ) ) as (FinSequence of ( ( R12 * ) * ));
take D224;
L1499: (for R1 being Nat holds (R1 in ( dom D224 ) implies (ex R4 being Nat st ( D224 . R1 ) is (Matrix of R4 , R12))));
thus L1500: thesis by L1499 , L1497;
end;
end;
registration
let R12 being non  empty set;
cluster  Square-Matrix-yielding ->  Matrix-yielding for (FinSequence of ( ( R12 * ) * ));
coherence
proof
let C38 being (FinSequence of ( ( R12 * ) * ));
assume that
L1502: C38 is  Square-Matrix-yielding;
let R1 being Nat;
assume L1503: R1 in ( dom C38 );
L1504: (ex R4 being Nat st ( C38 . R1 ) is (Matrix of R4 , R12)) by L1503 , L1502 , L1497;
thus L1505: thesis by L1504;
end;
end;
definition
let R12 being non  empty set;
mode FinSequence_of_Square-Matrix of R12
 is  Square-Matrix-yielding (FinSequence of ( ( R12 * ) * ));
end;
definition
let R8 being Field;
mode FinSequence_of_Square-Matrix of R8
 is  Square-Matrix-yielding (FinSequence of ( ( (the carrier of R8) * ) * ));
end;
theorem
L1509: (for R12 being non  empty set holds ( {} ) is (FinSequence_of_Square-Matrix of R12))
proof
let R12 being non  empty set;
set D225 = ( <*> ( ( R12 * ) * ) );
L1510: (for R1 being Nat holds (R1 in ( dom D225 ) implies (ex R4 being Nat st ( D225 . R1 ) is (Matrix of R4 , R12))));
thus L1511: thesis by L1510 , L1497;
end;
definition
let R12 being non  empty set;
let R33 being (FinSequence_of_Square-Matrix of R12);
let R6 being set;
redefine func R33 . R6 -> (Matrix of ( len ( R33 . R6 ) ) , R12);

coherence
proof
reconsider D226 = ( {} ) as (Matrix of ( 0 ) , R12) by MATRIX_1:13;
per cases ;
suppose L1512: R6 in ( dom R33 );

reconsider D227 = R6 as (Element of ( NAT )) by L1512;
consider R4 being Nat such that L1513: ( R33 . D227 ) is (Matrix of R4 , R12) by L1512 , L1497;
L1514: ( len ( R33 . D227 ) ) = R4 by L1513 , MATRIX_1:24;
thus L1515: thesis by L1514 , L1513;
end;
suppose L1516: (not R6 in ( dom R33 ));

L1517: ( len D226 ) = ( 0 );
L1518: ( R33 . R6 ) = D226 by L1516 , FUNCT_1:def 2;
thus L1519: thesis by L1518 , L1517;
end;
end;
end;
definition
let R12 being non  empty set;
let R34 being (FinSequence_of_Square-Matrix of R12);
let R35 being (FinSequence_of_Square-Matrix of R12);
redefine func R34 ^ R35 -> (FinSequence_of_Square-Matrix of R12);

coherence
proof
L1522: ( R34 ^ R35 ) is  Square-Matrix-yielding
proof
let R1 being Nat;
assume that
L1523: R1 in ( dom ( R34 ^ R35 ) );
take ( len ( ( R34 ^ R35 ) . R1 ) );
per cases  by L1523 , FINSEQ_1:25;
suppose L1524: R1 in ( dom R34 );

L1525: ( ( R34 ^ R35 ) . R1 ) = ( R34 . R1 ) by L1524 , FINSEQ_1:def 7;
thus L1526: thesis by L1525;
end;
suppose L1527: (ex R4 being Nat st (R4 in ( dom R35 ) & R1 = ( ( len R34 ) + R4 )));

consider R4 being Nat such that L1528: R4 in ( dom R35 ) and L1529: R1 = ( ( len R34 ) + R4 ) by L1527;
L1530: ( ( R34 ^ R35 ) . R1 ) = ( R35 . R4 ) by L1528 , L1529 , FINSEQ_1:def 7;
thus L1531: thesis by L1530;
end;
end;
thus L1533: thesis by L1522;
end;
end;
L1535: (for R4 being Nat holds (for R12 being non  empty set holds (for B23 being (Matrix of R4 , R12) holds <* B23 *> is (FinSequence_of_Square-Matrix of R12))))
proof
let R4 being Nat;
let R12 being non  empty set;
let C39 being (Matrix of R4 , R12);
L1536:
now
let R1 being Nat;
assume that
L1537: R1 in ( dom <* C39 *> );
take D228 = R4;
L1538: ( <* C39 *> . 1 ) = C39 by FINSEQ_1:def 8;
L1539: ( dom <* C39 *> ) = { 1 } by FINSEQ_1:2 , FINSEQ_1:def 8;
thus L1540: ( <* C39 *> . R1 ) is (Matrix of D228 , R12) by L1539 , L1537 , L1538 , TARSKI:def 1;
end;
thus L1541: thesis by L1536 , L1497;
end;
definition
let R12 being non  empty set;
let R4 being Nat;
let C40 being (Matrix of R4 , R12);
redefine func <*C40 *> -> (FinSequence_of_Square-Matrix of R12);

coherence by L1535;
end;
definition
let R12 being non  empty set;
let R4 being Nat;
let R3 being Nat;
let C41 being (Matrix of R4 , R12);
let C42 being (Matrix of R3 , R12);
redefine func <*C41 , C42 *> -> (FinSequence_of_Square-Matrix of R12);

coherence
proof
reconsider D229 = <* C41 *> , D230 = <* C42 *> as (FinSequence_of_Square-Matrix of R12);
L1543: <* C41 , C42 *> = ( D229 ^ D230 );
thus L1544: thesis by L1543;
end;
end;
definition
let R12 being non  empty set;
let R4 being Nat;
let R33 being (FinSequence_of_Square-Matrix of R12);
redefine func R33 | R4 -> (FinSequence_of_Square-Matrix of R12);

coherence
proof
L1546: ( R33 | R4 ) is  Square-Matrix-yielding
proof
let R1 being Nat;
assume that
L1547: R1 in ( dom ( R33 | R4 ) );
take D231 = ( len ( R33 . R1 ) );
thus L1548: ( ( R33 | R4 ) . R1 ) is (Matrix of D231 , R12) by L1547 , FUNCT_1:47;
end;
thus L1549: thesis by L1546;
end;
redefine func R33 /^ R4 -> (FinSequence_of_Square-Matrix of R12);

coherence
proof
L1550: ( R33 /^ R4 ) is  Square-Matrix-yielding
proof
let R1 being Nat;
assume that
L1551: R1 in ( dom ( R33 /^ R4 ) );
L1552: ( R1 + R4 ) in ( dom R33 ) by L1551 , FINSEQ_5:26;
L1553: ( R33 . ( R4 + R1 ) ) = ( R33 /. ( R4 + R1 ) ) by L1552 , PARTFUN1:def 6;
take D232 = ( len ( R33 . ( R4 + R1 ) ) );
L1554: ( ( R33 /^ R4 ) . R1 ) = ( ( R33 /^ R4 ) /. R1 ) by L1551 , PARTFUN1:def 6;
thus L1555: ( ( R33 /^ R4 ) . R1 ) is (Matrix of D232 , R12) by L1554 , L1551 , L1553 , FINSEQ_5:27;
end;
thus L1556: thesis by L1550;
end;
end;
theorem
L1558: (for R12 being non  empty set holds (for R33 being (FinSequence_of_Square-Matrix of R12) holds ( Len R33 ) = ( Width R33 )))
proof
let R12 being non  empty set;
let R33 being (FinSequence_of_Square-Matrix of R12);
set D233 = ( Len R33 );
set D234 = ( Width R33 );
L1559: ( dom D234 ) = ( dom R33 ) by L399;
L1560: ( dom D233 ) = ( dom R33 ) by L387;
L1561:
now
let R5 being Nat;
assume that
L1562: R5 in ( dom D233 );
thus L1563: ( D233 . R5 ) = ( len ( R33 . R5 ) ) by L1562 , L387
.= ( width ( R33 . R5 ) ) by MATRIX_1:24
.= ( D234 . R5 ) by L1560 , L1559 , L1562 , L399;
end;
thus L1564: thesis by L1561 , L1560 , L1559 , FINSEQ_1:13;
end;
definition
let R12 being non  empty set;
let C43 being (Element of R12);
let C44 being (FinSequence_of_Square-Matrix of R12);
redefine func block_diagonal (C44 , C43) -> (Matrix of ( Sum ( Len C44 ) ) , R12);

coherence
proof
L1565: ( block_diagonal (C44 , C43) ) is (Matrix of ( Sum ( Len C44 ) ) , ( Sum ( Width C44 ) ) , R12);
thus L1566: thesis by L1565 , L1558;
end;
end;
theorem
L1568: (for R1 being Nat holds (for R2 being Nat holds (for R4 being Nat holds (for R8 being Field holds (for R9 being (Element of R8) holds (for R36 being (FinSequence_of_Square-Matrix of R8) holds (for B24 being (Matrix of R4 , R8) holds ((R1 in ( dom B24 ) & R2 in ( Seg R4 )) implies ( Deleting (( block_diagonal (( <* B24 *> ^ R36 ) , R9) ) , R1 , R2) ) = ( block_diagonal (( <* ( Deleting (B24 , R1 , R2) ) *> ^ R36 ) , R9) )))))))))
proof
let R1 being Nat;
let R2 being Nat;
let R4 being Nat;
let R8 being Field;
let R9 being (Element of R8);
let R36 being (FinSequence_of_Square-Matrix of R8);
let C45 being (Matrix of R4 , R8);
assume that
L1569: R1 in ( dom C45 )
and
L1570: R2 in ( Seg R4 );
L1571: R4 <> ( 0 ) by L1570;
L1572: R4 >= 1 by L1571 , NAT_1:14;
set D235 = <* C45 *>;
set D236 = ( block_diagonal (R36 , R9) );
set D237 = <* D236 *>;
set D238 = ( Sum ( Len ( D235 ^ R36 ) ) );
set D239 = ( Sum ( Len ( D235 ^ D237 ) ) );
L1573: ( width C45 ) = R4 by MATRIX_1:24;
L1574: ( Width D235 ) = <* ( width C45 ) *> by L512;
L1575: ( Sum ( Width D235 ) ) = ( width C45 ) by L1574 , RVSUM_1:73;
L1576: ( Width D237 ) = <* ( width D236 ) *> by L512;
L1577: ( Len D235 ) = <* ( len C45 ) *> by L464;
L1578: ( Sum ( Len D235 ) ) = ( len C45 ) by L1577 , RVSUM_1:73;
L1579: ( Len ( D235 ^ D237 ) ) = ( ( Len D235 ) ^ ( Len D237 ) ) by L441;
L1580: D239 = ( ( len C45 ) + ( Sum ( Len D237 ) ) ) by L1579 , L1577 , RVSUM_1:76;
L1581: ( Len ( D235 ^ R36 ) ) = ( ( Len D235 ) ^ ( Len R36 ) ) by L441;
L1582: D238 = ( ( len C45 ) + ( Sum ( Len R36 ) ) ) by L1581 , L1577 , RVSUM_1:76;
L1583: ( Len ( D235 ^ D237 ) ) = ( Width ( D235 ^ D237 ) ) by L1558;
L1584: ( Width ( D235 ^ D237 ) ) = ( ( Width D235 ) ^ ( Width D237 ) ) by L489;
L1585: D239 = ( ( Sum ( Width D235 ) ) + ( width D236 ) ) by L1584 , L1576 , L1583 , RVSUM_1:74;
L1586: ( len D236 ) = ( Sum ( Len R36 ) ) by L537;
L1587: ( Len D237 ) = <* ( len D236 ) *> by L464;
L1588: ( Sum ( Len D237 ) ) = ( len D236 ) by L1587 , RVSUM_1:73;
L1589: ( len C45 ) = R4 by MATRIX_1:24;
L1590: ( dom C45 ) = ( Seg R4 ) by L1589 , FINSEQ_1:def 3;
per cases  by L1572 , XXREAL_0:1;
suppose L1591: R4 = 1;

L1592: R1 = 1 by L1591 , L1569 , L1590 , FINSEQ_1:2 , TARSKI:def 1;
L1593: R2 = 1 by L1570 , L1591 , FINSEQ_1:2 , TARSKI:def 1;
L1594: ( len ( Deleting (C45 , R1 , R2) ) ) = ( 1 -' 1 ) by L1569 , L1591 , LAPLACE:2
.= ( 0 ) by XREAL_1:232;
L1595: ( Deleting (C45 , R1 , R2) ) = ( {} ) by L1594;
thus L1596: ( Deleting (( block_diagonal (( D235 ^ R36 ) , R9) ) , R1 , R2) ) = ( Deleting (( block_diagonal (( D235 ^ D237 ) , R9) ) , R1 , R2) ) by L1586 , L1582 , L1580 , L1588 , L1126
.= ( Segm (( block_diagonal (( D235 ^ D237 ) , R9) ) , ( ( Seg D239 ) \ { R1 } ) , ( ( Seg D239 ) \ { R2 } )) ) by MATRIX13:58
.= D236 by L1589 , L1573 , L1580 , L1585 , L1588 , L1578 , L1575 , L1591 , L1592 , L1593 , L1052 , FINSEQ_1:2
.= ( block_diagonal (D237 , R9) ) by L1073
.= ( block_diagonal (( <* ( Deleting (C45 , R1 , R2) ) *> ^ D237 ) , R9) ) by L1595 , L1268
.= ( block_diagonal (( <* ( Deleting (C45 , R1 , R2) ) *> ^ R36 ) , R9) ) by L1126;
end;
suppose L1597: R4 > 1;

L1598: ( width C45 ) = ( width ( DelLine (C45 , R1) ) ) by L1597 , L1589 , LAPLACE:4;
thus L1599: ( Deleting (( block_diagonal (( D235 ^ R36 ) , R9) ) , R1 , R2) ) = ( DelCol (( DelLine (( block_diagonal (( D235 ^ R36 ) , R9) ) , R1) ) , R2) ) by MATRIX_2:def 6
.= ( DelCol (( block_diagonal (( <* ( DelLine (C45 , R1) ) *> ^ R36 ) , R9) ) , R2) ) by L1569 , L1598 , L1292
.= ( block_diagonal (( <* ( DelCol (( DelLine (C45 , R1) ) , R2) ) *> ^ R36 ) , R9) ) by L1570 , L1573 , L1598 , L1416
.= ( block_diagonal (( <* ( Deleting (C45 , R1 , R2) ) *> ^ R36 ) , R9) ) by MATRIX_2:def 6;
end;
end;
theorem
L1601: (for R1 being Nat holds (for R2 being Nat holds (for R4 being Nat holds (for R8 being Field holds (for R9 being (Element of R8) holds (for R36 being (FinSequence_of_Square-Matrix of R8) holds (for B25 being (Matrix of R4 , R8) holds ((R1 in ( dom B25 ) & R2 in ( Seg R4 )) implies ( Deleting (( block_diagonal (( R36 ^ <* B25 *> ) , R9) ) , ( R1 + ( Sum ( Len R36 ) ) ) , ( R2 + ( Sum ( Len R36 ) ) )) ) = ( block_diagonal (( R36 ^ <* ( Deleting (B25 , R1 , R2) ) *> ) , R9) )))))))))
proof
let R1 being Nat;
let R2 being Nat;
let R4 being Nat;
let R8 being Field;
let R9 being (Element of R8);
let R36 being (FinSequence_of_Square-Matrix of R8);
let C46 being (Matrix of R4 , R8);
assume that
L1602: R1 in ( dom C46 )
and
L1603: R2 in ( Seg R4 );
L1604: R4 <> ( 0 ) by L1603;
L1605: R4 >= 1 by L1604 , NAT_1:14;
set D240 = ( R2 + ( Sum ( Len R36 ) ) );
set D241 = ( R1 + ( Sum ( Len R36 ) ) );
set D242 = <* C46 *>;
set D243 = ( block_diagonal (R36 , R9) );
set D244 = <* D243 *>;
set D245 = ( Sum ( Len ( R36 ^ D242 ) ) );
set D246 = ( Sum ( Len ( D244 ^ D242 ) ) );
L1606: ( width C46 ) = R4 by MATRIX_1:24;
L1607: ( Len R36 ) = ( Width R36 ) by L1558;
L1608: ( len C46 ) = R4 by MATRIX_1:24;
L1609: ( dom C46 ) = ( Seg R4 ) by L1608 , FINSEQ_1:def 3;
L1610: ( Width D242 ) = <* ( width C46 ) *> by L512;
L1611: ( len D243 ) = ( Sum ( Len R36 ) ) by L537;
L1612: ( Len ( D244 ^ D242 ) ) = ( Width ( D244 ^ D242 ) ) by L1558;
L1613: ( Len D242 ) = <* ( len C46 ) *> by L464;
L1614: ( Sum ( Len D242 ) ) = ( len C46 ) by L1613 , RVSUM_1:73;
L1615: ( Len ( R36 ^ D242 ) ) = ( ( Len R36 ) ^ ( Len D242 ) ) by L441;
L1616: D245 = ( ( len C46 ) + ( Sum ( Len R36 ) ) ) by L1615 , L1613 , RVSUM_1:74;
L1617: ( Len ( D244 ^ D242 ) ) = ( ( Len D244 ) ^ ( Len D242 ) ) by L441;
L1618: D246 = ( ( len C46 ) + ( Sum ( Len D244 ) ) ) by L1617 , L1613 , RVSUM_1:74;
L1619: ( Width D244 ) = <* ( width D243 ) *> by L512;
L1620: ( Sum ( Width D244 ) ) = ( width D243 ) by L1619 , RVSUM_1:73;
L1621: ( Width ( D244 ^ D242 ) ) = ( ( Width D244 ) ^ ( Width D242 ) ) by L489;
L1622: D246 = ( ( Sum ( Width D242 ) ) + ( width D243 ) ) by L1621 , L1619 , L1612 , RVSUM_1:76;
L1623: ( Len D244 ) = <* ( len D243 ) *> by L464;
L1624: ( Sum ( Len D244 ) ) = ( len D243 ) by L1623 , RVSUM_1:73;
per cases  by L1605 , XXREAL_0:1;
suppose L1625: R4 = 1;

L1626: R1 = 1 by L1625 , L1602 , L1609 , FINSEQ_1:2 , TARSKI:def 1;
L1627: R2 = 1 by L1603 , L1625 , FINSEQ_1:2 , TARSKI:def 1;
L1628: ( len ( Deleting (C46 , R1 , R2) ) ) = ( 1 -' 1 ) by L1602 , L1625 , LAPLACE:2
.= ( 0 ) by XREAL_1:232;
L1629: ( Deleting (C46 , R1 , R2) ) = ( {} ) by L1628;
thus L1630: ( Deleting (( block_diagonal (( R36 ^ D242 ) , R9) ) , D241 , D240) ) = ( Deleting (( block_diagonal (( D244 ^ D242 ) , R9) ) , D241 , D240) ) by L1611 , L1616 , L1618 , L1624 , L1078
.= ( Segm (( block_diagonal (( D244 ^ D242 ) , R9) ) , ( ( Seg D246 ) \ { D241 } ) , ( ( Seg D246 ) \ { D240 } )) ) by MATRIX13:58
.= ( Segm (( block_diagonal (( D244 ^ D242 ) , R9) ) , ( Seg ( Sum ( Len D244 ) ) ) , ( ( Seg D246 ) \ { D240 } )) ) by L1608 , L1611 , L1618 , L1624 , L1625 , L1626 , FINSEQ_1:10
.= ( Segm (( block_diagonal (( D244 ^ D242 ) , R9) ) , ( Seg ( Sum ( Len D244 ) ) ) , ( Seg ( Sum ( Width D244 ) ) )) ) by L1608 , L1606 , L1611 , L1613 , L1610 , L1618 , L1622 , L1624 , L1614 , L1620 , L1625 , L1627 , FINSEQ_1:10
.= D243 by L1624 , L1620 , L1034
.= ( block_diagonal (D244 , R9) ) by L1073
.= ( block_diagonal (( D244 ^ <* ( Deleting (C46 , R1 , R2) ) *> ) , R9) ) by L1629 , L1268
.= ( block_diagonal (( R36 ^ <* ( Deleting (C46 , R1 , R2) ) *> ) , R9) ) by L1078;
end;
suppose L1631: R4 > 1;

L1632: ( width C46 ) = ( width ( DelLine (C46 , R1) ) ) by L1631 , L1608 , LAPLACE:4;
thus L1633: ( Deleting (( block_diagonal (( R36 ^ D242 ) , R9) ) , D241 , D240) ) = ( DelCol (( DelLine (( block_diagonal (( R36 ^ D242 ) , R9) ) , D241) ) , D240) ) by MATRIX_2:def 6
.= ( DelCol (( block_diagonal (( R36 ^ <* ( DelLine (C46 , R1) ) *> ) , R9) ) , D240) ) by L1602 , L1632 , L1353
.= ( block_diagonal (( R36 ^ <* ( DelCol (( DelLine (C46 , R1) ) , R2) ) *> ) , R9) ) by L1603 , L1606 , L1607 , L1632 , L1454
.= ( block_diagonal (( R36 ^ <* ( Deleting (C46 , R1 , R2) ) *> ) , R9) ) by MATRIX_2:def 6;
end;
end;
definition
let R8 being Field;
let R36 being (FinSequence_of_Square-Matrix of R8);
func Det R36 -> (FinSequence of R8) means 
:L1635: (( dom it ) = ( dom R36 ) & (for R1 being Nat holds (R1 in ( dom it ) implies ( it . R1 ) = ( Det ( R36 . R1 ) ))));
existence
proof
deffunc H3(Nat) = ( Det ( R36 . $1 ) );
consider C47 being (FinSequence of R8) such that L1636: ( len C47 ) = ( len R36 ) and L1637: (for R1 being Nat holds (R1 in ( dom C47 ) implies ( C47 . R1 ) = H3(R1))) from FINSEQ_2:sch 1;
take C47;
thus L1638: thesis by L1636 , L1637 , FINSEQ_3:29;
end;
uniqueness
proof
let C48 , C49 being (FinSequence of R8);
assume that
L1639: ( dom C48 ) = ( dom R36 )
and
L1640: (for R1 being Nat holds (R1 in ( dom C48 ) implies ( C48 . R1 ) = ( Det ( R36 . R1 ) )))
and
L1641: ( dom C49 ) = ( dom R36 )
and
L1642: (for R1 being Nat holds (R1 in ( dom C49 ) implies ( C49 . R1 ) = ( Det ( R36 . R1 ) )));
L1643:
now
let R6 being set;
assume that
L1644: R6 in ( dom C48 );
reconsider D247 = R6 as (Element of ( NAT )) by L1644;
thus L1645: ( C48 . R6 ) = ( Det ( R36 . D247 ) ) by L1640 , L1644
.= ( C49 . R6 ) by L1639 , L1641 , L1642 , L1644;
end;
thus L1646: thesis by L1643 , L1639 , L1641 , FUNCT_1:2;
end;
end;
definition
let R8 being Field;
let R36 being (FinSequence_of_Square-Matrix of R8);
redefine func Det R36 -> (Element of ( ( len R36 ) -tuples_on (the carrier of R8) ));

coherence
proof
L1648: ( dom ( Det R36 ) ) = ( dom R36 ) by L1635;
L1649: ( len ( Det R36 ) ) = ( len R36 ) by L1648 , FINSEQ_3:29;
thus L1650: thesis by L1649 , FINSEQ_2:92;
end;
end;
theorem
L1652: (for R4 being Nat holds (for R8 being Field holds (for R39 being (Matrix of R4 , R8) holds ( Det <* R39 *> ) = <* ( Det R39 ) *>)))
proof
let R4 being Nat;
let R8 being Field;
let R39 being (Matrix of R4 , R8);
set D248 = <* R39 *>;
L1653: ( len D248 ) = 1 by FINSEQ_1:40;
L1654: R4 = ( len R39 ) by MATRIX_1:def 2;
L1655: ( D248 . 1 ) = R39 by FINSEQ_1:40;
L1656: ( len D248 ) = ( len ( Det D248 ) ) by CARD_1:def 7;
L1657: ( dom ( Det D248 ) ) = ( Seg ( len D248 ) ) by FINSEQ_2:124;
L1658: 1 in ( Seg 1 );
L1659: ( ( Det D248 ) . 1 ) = ( Det ( D248 . 1 ) ) by L1658 , L1653 , L1657 , L1635;
thus L1660: thesis by L1659 , L1653 , L1656 , L1655 , L1654 , FINSEQ_1:40;
end;
theorem
L1661: (for R8 being Field holds (for R37 being (FinSequence_of_Square-Matrix of R8) holds (for R38 being (FinSequence_of_Square-Matrix of R8) holds ( Det ( R37 ^ R38 ) ) = ( ( Det R37 ) ^ ( Det R38 ) ))))
proof
let R8 being Field;
let R37 being (FinSequence_of_Square-Matrix of R8);
let R38 being (FinSequence_of_Square-Matrix of R8);
set D249 = ( R37 ^ R38 );
L1662: ( len D249 ) = ( ( len R37 ) + ( len R38 ) ) by FINSEQ_1:22;
L1663: ( len ( ( Det R37 ) ^ ( Det R38 ) ) ) = ( ( len R37 ) + ( len R38 ) ) by CARD_1:def 7;
L1664: ( len R38 ) = ( len ( Det R38 ) ) by CARD_1:def 7;
L1665: ( dom ( Det R38 ) ) = ( dom R38 ) by L1664 , FINSEQ_3:29;
L1666: ( len R37 ) = ( len ( Det R37 ) ) by CARD_1:def 7;
L1667: ( dom ( Det R37 ) ) = ( dom R37 ) by L1666 , FINSEQ_3:29;
L1668: ( len ( Det D249 ) ) = ( len D249 ) by CARD_1:def 7;
L1669: ( dom ( ( Det R37 ) ^ ( Det R38 ) ) ) = ( dom ( Det D249 ) ) by L1668 , L1662 , L1663 , FINSEQ_3:29;
L1670:
now
let R5 being Nat;
assume that
L1671: 1 <= R5
and
L1672: R5 <= ( ( len R37 ) + ( len R38 ) );
L1673: R5 in ( dom ( ( Det R37 ) ^ ( Det R38 ) ) ) by L1663 , L1671 , L1672 , FINSEQ_3:25;
L1674:
now
per cases  by L1673 , FINSEQ_1:25;
suppose L1675: R5 in ( dom ( Det R37 ) );

L1676: ( len ( R37 . R5 ) ) = ( len ( D249 . R5 ) ) by L1675 , L1667 , FINSEQ_1:def 7;
thus L1677: ( ( ( Det R37 ) ^ ( Det R38 ) ) . R5 ) = ( ( Det R37 ) . R5 ) by L1675 , FINSEQ_1:def 7
.= ( Det ( R37 . R5 ) ) by L1675 , L1635
.= ( Det ( D249 . R5 ) ) by L1667 , L1675 , L1676 , FINSEQ_1:def 7
.= ( ( Det D249 ) . R5 ) by L1669 , L1673 , L1635;
end;
suppose L1678: (ex R4 being Nat st (R4 in ( dom ( Det R38 ) ) & R5 = ( ( len ( Det R37 ) ) + R4 )));

consider R4 being Nat such that L1679: R4 in ( dom ( Det R38 ) ) and L1680: R5 = ( ( len R37 ) + R4 ) by L1678 , L1666;
L1681: ( len ( R38 . R4 ) ) = ( len ( D249 . R5 ) ) by L1665 , L1679 , L1680 , FINSEQ_1:def 7;
thus L1682: ( ( ( Det R37 ) ^ ( Det R38 ) ) . R5 ) = ( ( Det R38 ) . R4 ) by L1666 , L1679 , L1680 , FINSEQ_1:def 7
.= ( Det ( R38 . R4 ) ) by L1679 , L1635
.= ( Det ( D249 . R5 ) ) by L1665 , L1679 , L1680 , L1681 , FINSEQ_1:def 7
.= ( ( Det D249 ) . R5 ) by L1669 , L1673 , L1635;
end;
end;
thus L1684: ( ( Det D249 ) . R5 ) = ( ( ( Det R37 ) ^ ( Det R38 ) ) . R5 ) by L1674;
end;
thus L1685: thesis by L1670 , L1668 , L1662 , L1663 , FINSEQ_1:14;
end;
theorem
L1686: (for R4 being Nat holds (for R8 being Field holds (for R36 being (FinSequence_of_Square-Matrix of R8) holds ( Det ( R36 | R4 ) ) = ( ( Det R36 ) | R4 ))))
proof
let R4 being Nat;
let R8 being Field;
let R36 being (FinSequence_of_Square-Matrix of R8);
L1687: ( len ( Det R36 ) ) = ( len R36 ) by CARD_1:def 7;
per cases ;
suppose L1688: R4 >= ( len R36 );

L1689: ( R36 | R4 ) = R36 by L1688 , FINSEQ_1:58;
thus L1690: thesis by L1689 , L1687 , L1688 , FINSEQ_1:58;
end;
suppose L1691: R4 < ( len R36 );

L1692: R36 = ( ( R36 | R4 ) ^ ( R36 /^ R4 ) ) by RFINSEQ:8;
L1693: ( Det R36 ) = ( ( Det ( R36 | R4 ) ) ^ ( Det ( R36 /^ R4 ) ) ) by L1692 , L1661;
L1694: ( len ( R36 | R4 ) ) = R4 by L1691 , FINSEQ_1:59;
L1695: ( len ( Det ( R36 | R4 ) ) ) = R4 by L1694 , CARD_1:def 7;
thus L1696: thesis by L1695 , L1693 , FINSEQ_5:23;
end;
end;
theorem
L1698: (for R3 being Nat holds (for R4 being Nat holds (for R8 being Field holds (for R39 being (Matrix of R4 , R8) holds (for R40 being (Matrix of R3 , R8) holds ( Det ( block_diagonal (<* R39 , R40 *> , ( 0. R8 )) ) ) = ( ( Det R39 ) * ( Det R40 ) ))))))
proof
let R3 being Nat;
let R4 being Nat;
let R8 being Field;
let R39 being (Matrix of R4 , R8);
let R40 being (Matrix of R3 , R8);
defpred S4[ Nat ] means (for R4 being Nat holds (for R3 being Nat holds (for R39 being (Matrix of R4 , R8) holds (for R40 being (Matrix of R3 , R8) holds (R4 = $1 implies ( Det ( block_diagonal (<* R39 , R40 *> , ( 0. R8 )) ) ) = ( ( Det R39 ) * ( Det R40 ) ))))));
L1699: (for R1 being Nat holds (S4[ R1 ] implies S4[ ( R1 + 1 ) ]))
proof
let R1 being Nat;
assume that
L1700: S4[ R1 ];
set D250 = ( R1 + 1 );
let R4 being Nat;
let R3 being Nat;
let R39 being (Matrix of R4 , R8);
let R40 being (Matrix of R3 , R8);
assume that
L1701: R4 = D250;
L1702: 1 <= ( ( R1 + R3 ) + 1 ) by NAT_1:11;
L1703: 1 in ( Seg ( R4 + R3 ) ) by L1702 , L1701;
L1704: 1 <= D250 by NAT_1:11;
L1705: 1 in ( Seg R4 ) by L1704 , L1701;
set D251 = ( ( len R40 ) |-> ( 0. R8 ) );
reconsider D252 = R4 as (Element of ( NAT )) by ORDINAL1:def 12;
set D253 = ( Det R40 );
set D254 = ( LaplaceExpL (R39 , 1) );
set D255 = <* R39 , R40 *>;
reconsider D256 = R39 as (Matrix of R8);
set D257 = ( block_diagonal (D255 , ( 0. R8 )) );
set D258 = ( LaplaceExpL (D257 , 1) );
L1706: ( width R39 ) = R4 by MATRIX_1:24;
set D259 = ( D258 | R4 );
L1707: ( len D254 ) = R4 by LAPLACE:def 7;
set D260 = ( D258 /^ R4 );
L1708: D258 = ( ( D258 | R4 ) ^ ( D258 /^ R4 ) ) by RFINSEQ:8;
L1709: ( len R39 ) = R4 by MATRIX_1:24;
L1710: ( dom R39 ) = ( Seg R4 ) by L1709 , FINSEQ_1:def 3;
reconsider D261 = D254 as (Element of ( D252 -tuples_on (the carrier of R8) )) by L1707 , FINSEQ_2:92;
L1711: ( len R40 ) = R3 by MATRIX_1:24;
L1712: ( len D251 ) = R3 by L1711 , CARD_1:def 7;
L1713: ( Sum ( Len D255 ) ) = ( ( len R39 ) + ( len R40 ) ) by L475;
L1714: ( len D258 ) = ( R4 + R3 ) by L1713 , L1709 , L1711 , LAPLACE:def 7;
L1715: ( len D259 ) = R4 by L1714 , FINSEQ_1:59 , NAT_1:11;
L1716: ( width D257 ) = ( Sum ( Len D255 ) ) by MATRIX_1:24;
L1717:
now
L1718: R1 = ( R4 -' 1 ) by L1701 , NAT_D:34;
let R2 being Nat;
assume that
L1719: 1 <= R2
and
L1720: R2 <= R4;
L1721: ( len ( Delete (R39 , 1 , R2) ) ) = ( R4 -' 1 ) by MATRIX_1:def 2;
L1722: R2 in ( dom D259 ) by L1715 , L1719 , L1720 , FINSEQ_3:25;
L1723: R2 in ( ( dom D258 ) /\ ( Seg R4 ) ) by L1722 , RELAT_1:61;
L1724: R2 in ( dom D258 ) by L1723 , XBOOLE_0:def 4;
L1725: R2 in ( dom D261 ) by L1707 , L1719 , L1720 , FINSEQ_3:25;
L1726: ( ( R39 * (1 , R2) ) * ( Cofactor (R39 , 1 , R2) ) ) = ( D261 . R2 ) by L1725 , LAPLACE:def 7;
L1727: ( ( ( R1 + R3 ) + 1 ) -' 1 ) = ( R1 + R3 ) by NAT_D:34;
L1728: ( dom ( Line (R39 , 1) ) ) = ( Seg R4 ) by L1706 , FINSEQ_2:124;
L1729: ( dom D259 ) = ( Seg R4 ) by L1715 , FINSEQ_1:def 3;
L1730: ( dom D258 ) = ( Seg ( R4 + R3 ) ) by L1714 , FINSEQ_1:def 3;
L1731: ( Delete (D257 , 1 , R2) ) = ( Deleting (D257 , 1 , R2) ) by L1730 , L1713 , L1709 , L1711 , L1703 , L1724 , LAPLACE:def 1
.= ( block_diagonal (( <* ( Deleting (R39 , 1 , R2) ) *> ^ <* R40 *> ) , ( 0. R8 )) ) by L1705 , L1710 , L1722 , L1729 , L1568
.= ( block_diagonal (<* ( Delete (R39 , 1 , R2) ) , R40 *> , ( 0. R8 )) ) by L1705 , L1722 , L1729 , LAPLACE:def 1;
L1732: ( ( Minor (R39 , 1 , R2) ) * D253 ) = ( Det ( block_diagonal (<* ( Delete (R39 , 1 , R2) ) , R40 *> , ( 0. R8 )) ) ) by L1700 , L1701 , NAT_D:34
.= ( Minor (D257 , 1 , R2) ) by L1701 , L1713 , L1709 , L1711 , L1731 , L1718 , L1727 , L1721 , L475;
L1733: ( Cofactor (D257 , 1 , R2) ) = ( D253 * ( Cofactor (R39 , 1 , R2) ) ) by L1732 , GROUP_1:def 3;
L1734: ( D257 * (1 , R2) ) = ( ( Line (( block_diagonal (<* D256 , R40 *> , ( 0. R8 )) ) , 1) ) . R2 ) by L1716 , L1713 , L1709 , L1711 , L1724 , L1730 , MATRIX_1:def 7
.= ( ( ( Line (R39 , 1) ) ^ ( ( width R40 ) |-> ( 0. R8 ) ) ) . R2 ) by L1705 , L1710 , L576
.= ( ( Line (R39 , 1) ) . R2 ) by L1722 , L1729 , L1728 , FINSEQ_1:def 7
.= ( R39 * (1 , R2) ) by L1706 , L1722 , L1729 , MATRIX_1:def 7;
thus L1735: ( D259 . R2 ) = ( D258 . R2 ) by L1722 , FUNCT_1:47
.= ( ( R39 * (1 , R2) ) * ( D253 * ( Cofactor (R39 , 1 , R2) ) ) ) by L1724 , L1733 , L1734 , LAPLACE:def 7
.= ( D253 * ( ( R39 * (1 , R2) ) * ( Cofactor (R39 , 1 , R2) ) ) ) by GROUP_1:def 3
.= ( ( D253 * D261 ) . R2 ) by L1722 , L1729 , L1726 , FVSUM_1:51;
end;
L1736: R4 <= ( R4 + R3 ) by NAT_1:11;
L1737: ( len D260 ) = ( ( R4 + R3 ) - R4 ) by L1736 , L1714 , RFINSEQ:def 1;
L1738: ( width R40 ) = R3 by MATRIX_1:24;
L1739:
now
L1740: ( len ( Line (R39 , 1) ) ) = R4 by L1706 , CARD_1:def 7;
let R1 being Nat;
assume that
L1741: 1 <= R1
and
L1742: R1 <= R3;
L1743: R1 in ( Seg R3 ) by L1741 , L1742 , FINSEQ_1:1;
L1744: R1 in ( dom D251 ) by L1712 , L1741 , L1742 , FINSEQ_3:25;
L1745: R1 in ( dom D260 ) by L1737 , L1741 , L1742 , FINSEQ_3:25;
L1746: ( R4 + R1 ) in ( dom D258 ) by L1745 , FINSEQ_5:26;
L1747: ( dom D258 ) = ( Seg ( width D257 ) ) by L1716 , L1713 , L1709 , L1711 , L1714 , FINSEQ_1:def 3;
L1748: ( D257 * (1 , ( R1 + R4 )) ) = ( ( Line (( block_diagonal (<* D256 , R40 *> , ( 0. R8 )) ) , 1) ) . ( R1 + R4 ) ) by L1747 , L1746 , MATRIX_1:def 7
.= ( ( ( Line (R39 , 1) ) ^ D251 ) . ( R1 + R4 ) ) by L1711 , L1738 , L1705 , L1710 , L576
.= ( D251 . R1 ) by L1744 , L1740 , FINSEQ_1:def 7
.= ( 0. R8 ) by L1711 , L1743 , FINSEQ_2:57;
thus L1749: ( D260 . R1 ) = ( D260 /. R1 ) by L1745 , PARTFUN1:def 6
.= ( D258 /. ( R1 + R4 ) ) by L1745 , FINSEQ_5:27
.= ( D258 . ( R1 + R4 ) ) by L1746 , PARTFUN1:def 6
.= ( ( D257 * (1 , ( R1 + R4 )) ) * ( Cofactor (D257 , 1 , ( R1 + R4 )) ) ) by L1746 , LAPLACE:def 7
.= ( 0. R8 ) by L1748 , VECTSP_1:6
.= ( D251 . R1 ) by L1711 , L1743 , FINSEQ_2:57;
end;
L1750: ( D258 /^ R4 ) = ( ( len R40 ) |-> ( 0. R8 ) ) by L1739 , L1737 , L1712 , FINSEQ_1:14;
L1751: ( len ( D253 * D261 ) ) = D252 by L1707 , MATRIXR1:16;
L1752: ( D258 | R4 ) = ( D253 * D261 ) by L1751 , L1715 , L1717 , FINSEQ_1:14;
L1753: ( Sum D258 ) = ( ( Sum ( D253 * D261 ) ) + ( Sum ( ( len R40 ) |-> ( 0. R8 ) ) ) ) by L1752 , L1750 , L1708 , RLVECT_1:41
.= ( ( Sum ( D253 * D261 ) ) + ( Sum ( ( len R40 ) |-> ( ( 0. R8 ) * ( 0. R8 ) ) ) ) ) by VECTSP_1:6
.= ( ( Sum ( D253 * D261 ) ) + ( Sum ( ( 0. R8 ) * ( ( len R40 ) |-> ( 0. R8 ) ) ) ) ) by FVSUM_1:53
.= ( ( D253 * ( Sum D261 ) ) + ( Sum ( ( 0. R8 ) * ( ( len R40 ) |-> ( 0. R8 ) ) ) ) ) by FVSUM_1:73
.= ( ( D253 * ( Sum D261 ) ) + ( ( 0. R8 ) * ( Sum ( ( len R40 ) |-> ( 0. R8 ) ) ) ) ) by FVSUM_1:73
.= ( ( D253 * ( Sum D261 ) ) + ( 0. R8 ) ) by VECTSP_1:6
.= ( D253 * ( Sum D261 ) ) by RLVECT_1:def 4
.= ( D253 * ( Det R39 ) ) by L1705 , LAPLACE:25;
thus L1754: thesis by L1753 , L1713 , L1709 , L1711 , L1703 , LAPLACE:25;
end;
L1755: S4[ ( 0 ) ]
proof
let R4 being Nat;
let R3 being Nat;
let R39 being (Matrix of R4 , R8);
let R40 being (Matrix of R3 , R8);
assume that
L1756: R4 = ( 0 );
L1757: ( len R39 ) = R4 by MATRIX_1:def 2;
L1758: R39 = ( {} ) by L1757 , L1756;
L1759: ( block_diagonal (<* R39 , R40 *> , ( 0. R8 )) ) = ( block_diagonal (<* R40 *> , ( 0. R8 )) ) by L1758 , L1268
.= R40 by L1073;
L1760: ( len R40 ) = R3 by MATRIX_1:def 2;
L1761: ( Sum ( Len <* R39 , R40 *> ) ) = ( ( 0 ) + R3 ) by L1760 , L1756 , L1757 , L475;
thus L1762: ( Det ( block_diagonal (<* R39 , R40 *> , ( 0. R8 )) ) ) = ( ( Det R40 ) * ( 1_ R8 ) ) by L1761 , L1759 , VECTSP_1:def 6
.= ( ( Det R39 ) * ( Det R40 ) ) by L1756 , MATRIXR2:41;
end;
L1763: (for R1 being Nat holds S4[ R1 ]) from NAT_1:sch 2(L1755 , L1699);
thus L1764: thesis by L1763;
end;
theorem
L1765: (for R8 being Field holds (for R36 being (FinSequence_of_Square-Matrix of R8) holds ( Det ( block_diagonal (R36 , ( 0. R8 )) ) ) = ( Product ( Det R36 ) )))
proof
let R8 being Field;
let R36 being (FinSequence_of_Square-Matrix of R8);
defpred S5[ Nat ] means (for R36 being (FinSequence_of_Square-Matrix of R8) holds (( len R36 ) = $1 implies ( Det ( block_diagonal (R36 , ( 0. R8 )) ) ) = ( Product ( Det R36 ) )));
L1766: (for R4 being Nat holds (S5[ R4 ] implies S5[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume that
L1767: S5[ R4 ];
set D262 = ( R4 + 1 );
let R36 being (FinSequence_of_Square-Matrix of R8);
assume that
L1768: ( len R36 ) = D262;
set D263 = ( R36 | R4 );
L1769: ( len D263 ) = R4 by L1768 , FINSEQ_1:59 , NAT_1:11;
set D264 = ( R36 . D262 );
set D265 = ( block_diagonal (D263 , ( 0. R8 )) );
L1770: R36 = ( D263 ^ <* D264 *> ) by L1768 , FINSEQ_3:55;
L1771: ( block_diagonal (R36 , ( 0. R8 )) ) = ( block_diagonal (<* D265 , D264 *> , ( 0. R8 )) ) by L1770 , L1078;
L1772: ( Sum ( Len <* D265 , D264 *> ) ) = ( ( len D265 ) + ( len D264 ) ) by L475
.= ( ( Sum ( Len D263 ) ) + ( len D264 ) ) by L537
.= ( Sum ( ( Len D263 ) ^ <* ( len D264 ) *> ) ) by RVSUM_1:74
.= ( Sum ( ( Len D263 ) ^ ( Len <* D264 *> ) ) ) by L464
.= ( Sum ( Len R36 ) ) by L1770 , L441;
thus L1773: ( Det ( block_diagonal (R36 , ( 0. R8 )) ) ) = ( ( Det D265 ) * ( Det D264 ) ) by L1772 , L1771 , L1698
.= ( ( Product ( Det D263 ) ) * ( Det D264 ) ) by L1767 , L1769
.= ( Product ( ( Det D263 ) ^ <* ( Det D264 ) *> ) ) by GROUP_4:6
.= ( Product ( ( Det D263 ) ^ ( Det <* D264 *> ) ) ) by L1652
.= ( Product ( Det R36 ) ) by L1770 , L1661;
end;
L1774: S5[ ( 0 ) ]
proof
let R36 being (FinSequence_of_Square-Matrix of R8);
assume that
L1775: ( len R36 ) = ( 0 );
L1776: ( Len R36 ) = ( {} ) by L1775;
thus L1777: ( Det ( block_diagonal (R36 , ( 0. R8 )) ) ) = ( 1_ R8 ) by L1776 , MATRIXR2:41 , RVSUM_1:72
.= ( Product ( Det R36 ) ) by L1775 , FVSUM_1:80;
end;
L1778: (for R4 being Nat holds S5[ R4 ]) from NAT_1:sch 2(L1774 , L1766);
thus L1779: thesis by L1778;
end;
theorem
L1780: (for R4 being Nat holds (for R8 being Field holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds (for R39 being (Matrix of R4 , R8) holds ((( len R20 ) <> ( width R20 ) & R39 = ( block_diagonal (<* R20 , R21 *> , ( 0. R8 )) )) implies ( Det R39 ) = ( 0. R8 )))))))
proof
let R4 being Nat;
let R8 being Field;
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
let R39 being (Matrix of R4 , R8);
defpred S6[ Nat ] means (for R20 being (Matrix of R8) holds ((( len R20 ) <> ( width R20 ) & ( width R20 ) = $1) implies (for R4 being Nat holds (for R39 being (Matrix of R4 , R8) holds (R39 = ( block_diagonal (<* R20 , R21 *> , ( 0. R8 )) ) implies ( Det R39 ) = ( 0. R8 ))))));
L1781: (for R5 being Nat holds (S6[ R5 ] implies S6[ ( R5 + 1 ) ]))
proof
let R5 being Nat;
assume that
L1782: S6[ R5 ];
set D266 = ( R5 + 1 );
let R20 being (Matrix of R8);
assume that
L1783: ( len R20 ) <> ( width R20 )
and
L1784: ( width R20 ) = D266;
L1785: ( Sum ( Len <* R20 , R21 *> ) ) = ( ( len R20 ) + ( len R21 ) ) by L475;
L1786: 1 <= D266 by NAT_1:14;
L1787: 1 in ( Seg ( width R20 ) ) by L1786 , L1784;
L1788: ( len ( R20 ^ R21 ) ) = ( ( len R20 ) + ( len R21 ) ) by FINSEQ_1:22;
L1789: ( Sum ( Width <* R20 , R21 *> ) ) = ( ( width R20 ) + ( width R21 ) ) by L523;
let R4 being Nat;
let R39 being (Matrix of R4 , R8);
assume that
L1790: R39 = ( block_diagonal (<* R20 , R21 *> , ( 0. R8 )) );
L1791: ( len R39 ) = ( Sum ( Len <* R20 , R21 *> ) ) by L1790 , L537;
set D267 = ( LaplaceExpC (R39 , 1) );
L1792: R4 = ( len R39 ) by MATRIX_1:24;
L1793: ( len D267 ) = ( len R39 ) by L1792 , LAPLACE:def 8;
L1794: ( len R20 ) <> ( 0 ) by L1783 , MATRIX_1:def 3;
L1795: ( 1 + ( 0 ) ) <= ( len R39 ) by L1794 , L1791 , L1785 , NAT_1:14;
L1796: 1 in ( Seg R4 ) by L1795 , L1792;
L1797: ( width R39 ) = ( Sum ( Width <* R20 , R21 *> ) ) by L1790 , L537;
set D268 = ( ( len R39 ) |-> ( 0. R8 ) );
L1798: R4 = ( width R39 ) by MATRIX_1:24;
L1799: ( len R20 ) >= 1 by L1794 , NAT_1:14;
L1800:
now
let R1 being Nat;
assume that
L1801: 1 <= R1
and
L1802: R1 <= ( len R39 );
L1803: R1 in ( Seg R4 ) by L1792 , L1801 , L1802 , FINSEQ_1:1;
L1804: R1 in ( dom D267 ) by L1793 , L1801 , L1802 , FINSEQ_3:25;
L1805: ( D267 . R1 ) = ( ( R39 * (R1 , 1) ) * ( Cofactor (R39 , R1 , 1) ) ) by L1804 , LAPLACE:def 8;
L1806: ( R39 * (R1 , 1) ) = ( ( Line (R39 , R1) ) . 1 ) by L1798 , L1796 , MATRIX_1:def 7;
L1807: R1 in ( dom ( R20 ^ R21 ) ) by L1791 , L1785 , L1788 , L1801 , L1802 , FINSEQ_3:25;
L1808:
now
per cases  by L1807 , FINSEQ_1:25;
suppose L1809: R1 in ( dom R20 );

L1810:
now
per cases  by L1799 , XXREAL_0:1;
suppose L1811: ( len R20 ) = 1;

L1812: R5 <> ( 0 ) by L1811 , L1783 , L1784;
L1813: R5 in ( Seg R5 ) by L1812 , FINSEQ_1:3;
L1814: 1 <= R5 by L1813 , FINSEQ_1:1;
L1815: ( 1 + 1 ) <= D266 by L1814 , XREAL_1:7;
L1816: 2 in ( Seg D266 ) by L1815;
L1817: 1 <= R1 by L1809 , FINSEQ_3:25;
L1818: R1 <= 1 by L1809 , L1811 , FINSEQ_3:25;
L1819: R1 = 1 by L1818 , L1817 , XXREAL_0:1;
set D269 = ( ( Seg R4 ) \ { 1 } );
L1820: ( Seg 1 ) c= ( Seg R4 ) by L1792 , L1795 , FINSEQ_1:5;
L1821: ( card D269 ) = ( ( card ( Seg R4 ) ) - ( card ( Seg 1 ) ) ) by L1820 , CARD_2:44 , FINSEQ_1:2
.= ( ( card ( Seg R4 ) ) - 1 ) by FINSEQ_1:57
.= ( R4 - 1 ) by FINSEQ_1:57
.= ( R5 + ( width R21 ) ) by L1784 , L1798 , L1797 , L1789;
L1822: ( card D269 ) = ( ( ( R5 + ( width R21 ) ) + 1 ) -' 1 ) by L1821 , NAT_D:34
.= ( R4 -' 1 ) by L1784 , L1790 , L1798 , L1789 , L537;
L1823: ( 1 + ( 0 ) ) <= ( card D269 ) by L1821 , L1814 , XREAL_1:7;
L1824: 1 in ( Seg ( card D269 ) ) by L1823;
L1825: ( Delete (R39 , R1 , 1) ) = ( Deleting (R39 , R1 , 1) ) by L1796 , L1803 , LAPLACE:def 1
.= ( Segm (R39 , D269 , D269) ) by L1819 , MATRIX13:58;
L1826: ( Col (( Delete (R39 , R1 , 1) ) , 1) ) = ( ( Col (R39 , ( ( Sgm D269 ) . 1 )) ) * ( Sgm D269 ) ) by L1825 , L1792 , L1824 , MATRIX13:49 , XBOOLE_1:36;
L1827:
now
L1828: ( dom ( ( len R21 ) |-> ( 0. R8 ) ) ) = ( Seg ( len R21 ) ) by FINSEQ_2:124;
L1829: R4 = ( 1 + ( card D269 ) ) by L1784 , L1790 , L1798 , L1789 , L1821 , L537;
L1830: ( len ( Col (R20 , 2) ) ) = 1 by L1811 , CARD_1:def 7;
let C50 being (Element of ( NAT ));
assume that
L1831: C50 in ( Seg ( R4 -' 1 ) );
L1832: ( dom ( Sgm D269 ) ) = ( Seg ( card D269 ) ) by FINSEQ_3:40 , XBOOLE_1:36;
thus L1833: ( ( Col (( Delete (R39 , R1 , 1) ) , 1) ) . C50 ) = ( ( Col (R39 , ( ( Sgm D269 ) . 1 )) ) . ( ( Sgm D269 ) . C50 ) ) by L1832 , L1822 , L1826 , L1831 , FUNCT_1:13
.= ( ( Col (R39 , ( 1 + 1 )) ) . ( ( Sgm D269 ) . C50 ) ) by L1824 , L1829 , FINSEQ_1:2 , MATRIX15:8
.= ( ( Col (R39 , ( 1 + 1 )) ) . ( C50 + 1 ) ) by L1822 , L1831 , L1829 , FINSEQ_1:2 , MATRIX15:8
.= ( ( ( Col (R20 , 2) ) ^ ( ( len R21 ) |-> ( 0. R8 ) ) ) . ( C50 + 1 ) ) by L1784 , L1790 , L1816 , L707
.= ( ( ( len R21 ) |-> ( 0. R8 ) ) . C50 ) by L1784 , L1791 , L1792 , L1798 , L1797 , L1785 , L1789 , L1811 , L1821 , L1822 , L1831 , L1830 , L1828 , FINSEQ_1:def 7
.= ( 0. R8 ) by L1784 , L1791 , L1792 , L1798 , L1797 , L1785 , L1789 , L1811 , L1821 , L1822 , L1831 , FINSEQ_2:57;
end;
thus L1834: ( Det ( Delete (R39 , R1 , 1) ) ) = ( 0. R8 ) by L1827 , L1822 , L1824 , MATRIX_9:53;
end;
suppose L1835: ( len R20 ) > 1;

set D270 = ( DelLine (R20 , R1) );
set D271 = ( DelCol (D270 , 1) );
L1836: ( D266 -' 1 ) = R5 by NAT_D:34;
reconsider D272 = ( ( len R20 ) - 1 ) as (Element of ( NAT )) by L1835 , NAT_1:21;
L1837: ( len D271 ) = ( len D270 ) by MATRIX_2:def 5;
L1838: ( width R20 ) = ( width D270 ) by L1835 , LAPLACE:4;
L1839: ( width D271 ) = ( ( width R20 ) -' 1 ) by L1838 , L1787 , LAPLACE:3;
L1840: ( Delete (R39 , R1 , 1) ) = ( Deleting (R39 , R1 , 1) ) by L1796 , L1803 , LAPLACE:def 1
.= ( DelCol (( DelLine (R39 , R1) ) , 1) ) by MATRIX_2:def 6
.= ( DelCol (( block_diagonal (( <* D270 *> ^ <* R21 *> ) , ( 0. R8 )) ) , 1) ) by L1790 , L1809 , L1838 , L1292
.= ( block_diagonal (<* D271 , R21 *> , ( 0. R8 )) ) by L1787 , L1838 , L1416;
L1841: ( len R20 ) = ( D272 + 1 );
L1842: ( len D271 ) <> ( width D271 ) by L1841 , L1783 , L1784 , L1809 , L1839 , L1837 , L1836 , FINSEQ_3:109;
thus L1843: ( 0. R8 ) = ( Det ( Delete (R39 , R1 , 1) ) ) by L1842 , L1782 , L1784 , L1839 , L1840 , NAT_D:34;
end;
end;
L1845: ( 0. R8 ) = ( Cofactor (R39 , R1 , 1) ) by L1810 , VECTSP_1:6;
thus L1846: ( 0. R8 ) = ( D267 . R1 ) by L1845 , L1805 , VECTSP_1:6;
end;
suppose L1847: (ex R2 being Nat st (R2 in ( dom R21 ) & R1 = ( ( len R20 ) + R2 )));

L1848: ( dom ( ( width R20 ) |-> ( 0. R8 ) ) ) = ( Seg ( width R20 ) ) by FINSEQ_2:124;
consider R2 being Nat such that L1849: R2 in ( dom R21 ) and L1850: R1 = ( ( len R20 ) + R2 ) by L1847;
L1851: ( R39 * (R1 , 1) ) = ( ( ( ( width R20 ) |-> ( 0. R8 ) ) ^ ( Line (R21 , R2) ) ) . 1 ) by L1790 , L1806 , L1849 , L1850 , L576
.= ( ( ( width R20 ) |-> ( 0. R8 ) ) . 1 ) by L1787 , L1848 , FINSEQ_1:def 7
.= ( 0. R8 ) by L1787 , FINSEQ_2:57;
thus L1852: ( 0. R8 ) = ( D267 . R1 ) by L1851 , L1805 , VECTSP_1:6;
end;
end;
thus L1854: ( D267 . R1 ) = ( D268 . R1 ) by L1808 , L1792 , L1803 , FINSEQ_2:57;
end;
L1855: ( len D268 ) = ( len R39 ) by CARD_1:def 7;
L1856: D267 = D268 by L1855 , L1793 , L1800 , FINSEQ_1:14;
L1857: D267 = ( ( len R39 ) |-> ( ( 0. R8 ) * ( 0. R8 ) ) ) by L1856 , VECTSP_1:7;
L1858: ( Sum D267 ) = ( Sum ( ( 0. R8 ) * ( ( len R39 ) |-> ( 0. R8 ) ) ) ) by L1857 , FVSUM_1:53
.= ( ( 0. R8 ) * ( Sum ( ( len R39 ) |-> ( 0. R8 ) ) ) ) by FVSUM_1:73
.= ( 0. R8 ) by VECTSP_1:6;
thus L1859: thesis by L1858 , L1796 , LAPLACE:27;
end;
L1860: S6[ ( 0 ) ]
proof
let R20 being (Matrix of R8);
assume that
L1861: ( len R20 ) <> ( width R20 )
and
L1862: ( width R20 ) = ( 0 );
L1863: ( len R20 ) in ( Seg ( len R20 ) ) by L1861 , L1862 , FINSEQ_1:3;
L1864: ( Sum ( Width <* R20 , R21 *> ) ) = ( ( width R20 ) + ( width R21 ) ) by L523;
L1865: ( Sum ( Len <* R20 , R21 *> ) ) = ( ( len R20 ) + ( len R21 ) ) by L475;
L1866: ( len R20 ) <= ( ( len R20 ) + ( len R21 ) ) by NAT_1:11;
let R4 being Nat;
let R39 being (Matrix of R4 , R8);
assume that
L1867: R39 = ( block_diagonal (<* R20 , R21 *> , ( 0. R8 )) );
L1868: ( width R39 ) = ( Sum ( Width <* R20 , R21 *> ) ) by L1867 , L537;
L1869: ( len R39 ) = ( Sum ( Len <* R20 , R21 *> ) ) by L1867 , L537;
L1870: ( Seg ( len R20 ) ) c= ( Seg ( len R39 ) ) by L1869 , L1865 , L1866 , FINSEQ_1:5;
L1871: R4 = ( len R39 ) by MATRIX_1:def 2;
L1872: ( dom R20 ) = ( Seg ( len R20 ) ) by FINSEQ_1:def 3;
L1873: ( Line (R39 , ( len R20 )) ) = ( ( Line (R20 , ( len R20 )) ) ^ ( ( width R21 ) |-> ( 0. R8 ) ) ) by L1872 , L1867 , L1863 , L576
.= ( ( <*> (the carrier of R8) ) ^ ( ( width R21 ) |-> ( 0. R8 ) ) ) by L1862
.= ( ( width R21 ) |-> ( 0. R8 ) ) by FINSEQ_1:34
.= ( ( 0. R8 ) * ( Line (R39 , ( len R20 )) ) ) by L1862 , L1868 , L1864 , FVSUM_1:58;
thus L1874: ( Det R39 ) = ( Det ( RLine (R39 , ( len R20 ) , ( ( 0. R8 ) * ( Line (R39 , ( len R20 )) ) )) ) ) by L1873 , MATRIX11:30
.= ( ( 0. R8 ) * ( Det R39 ) ) by L1871 , L1863 , L1870 , MATRIX11:35
.= ( 0. R8 ) by VECTSP_1:6;
end;
L1875: (for R4 being Nat holds S6[ R4 ]) from NAT_1:sch 2(L1860 , L1781);
thus L1876: thesis by L1875;
end;
theorem
L1877: (for R4 being Nat holds (for R8 being Field holds (for R29 being (FinSequence_of_Matrix of R8) holds (( Len R29 ) <> ( Width R29 ) implies (for B26 being (Matrix of R4 , R8) holds (B26 = ( block_diagonal (R29 , ( 0. R8 )) ) implies ( Det B26 ) = ( 0. R8 )))))))
proof
let R4 being Nat;
let R8 being Field;
let R29 being (FinSequence_of_Matrix of R8);
set D273 = ( block_diagonal (R29 , ( 0. R8 )) );
defpred S7[ Nat ] means ($1 in ( Seg ( len R29 ) ) & ( ( Len R29 ) . $1 ) <> ( ( Width R29 ) . $1 ));
L1878: ( Seg ( len R29 ) ) = ( dom R29 ) by FINSEQ_1:def 3;
assume L1879: ( Len R29 ) <> ( Width R29 );
L1880: (ex R5 being Nat st S7[ R5 ]) by L1879 , FINSEQ_2:119;
consider R5 being Nat such that L1881: S7[ R5 ] and L1882: (for R4 being Nat holds (S7[ R4 ] implies R5 <= R4)) from NAT_1:sch 5(L1880);
L1883: 1 <= R5 by L1881 , FINSEQ_1:1;
reconsider D274 = ( R5 - 1 ) as (Element of ( NAT )) by L1883 , NAT_1:21;
set D275 = ( R29 | D274 );
L1884: ( len R29 ) = ( len ( Width R29 ) ) by CARD_1:def 7;
L1885: R5 in ( dom ( Width R29 ) ) by L1884 , L1881 , FINSEQ_1:def 3;
L1886: ( width ( R29 . R5 ) ) = ( ( Width R29 ) . R5 ) by L1885 , L399;
set D276 = ( block_diagonal (D275 , ( 0. R8 )) );
set D277 = ( block_diagonal (( R29 /^ R5 ) , ( 0. R8 )) );
set D278 = ( block_diagonal (<* ( R29 . R5 ) , D277 *> , ( 0. R8 )) );
L1887: ( D274 + 1 ) <= ( len R29 ) by L1881 , FINSEQ_1:1;
L1888: D274 < ( len R29 ) by L1887 , NAT_1:13;
L1889: ( len ( ( Width R29 ) | D274 ) ) = D274 by L1888 , L1884 , FINSEQ_1:59;
L1890: ( dom ( ( Width R29 ) | D274 ) ) = ( Seg D274 ) by L1889 , FINSEQ_1:def 3;
L1891: ( len R29 ) = ( len ( Len R29 ) ) by CARD_1:def 7;
L1892: ( len ( ( Len R29 ) | D274 ) ) = D274 by L1891 , L1888 , FINSEQ_1:59;
L1893: ( dom ( ( Len R29 ) | D274 ) ) = ( Seg D274 ) by L1892 , FINSEQ_1:def 3;
L1894: ( Seg D274 ) c= ( Seg ( len R29 ) ) by L1888 , FINSEQ_1:5;
L1895:
now
let R2 being Nat;
assume that
L1896: R2 in ( Seg D274 );
L1897: R2 <= D274 by L1896 , FINSEQ_1:1;
L1898: R2 < ( D274 + 1 ) by L1897 , NAT_1:13;
L1899: ( ( Len R29 ) . R2 ) = ( ( Width R29 ) . R2 ) by L1898 , L1882 , L1894 , L1896;
thus L1900: ( ( Len D275 ) . R2 ) = ( ( ( Len R29 ) | D274 ) . R2 ) by L477
.= ( ( Len R29 ) . R2 ) by L1893 , L1896 , FUNCT_1:47
.= ( ( ( Width R29 ) | D274 ) . R2 ) by L1890 , L1896 , L1899 , FUNCT_1:47
.= ( ( Width D275 ) . R2 ) by L525;
end;
L1901: ( len D275 ) = D274 by L1888 , FINSEQ_1:59;
reconsider D279 = D276 as (Matrix of ( Sum ( Len D275 ) ) , R8) by L1901 , L1895 , FINSEQ_2:119;
let C51 being (Matrix of R4 , R8);
assume L1902: C51 = D273;
L1903: C51 = ( block_diagonal (( ( R29 | ( D274 + 1 ) ) ^ ( R29 /^ R5 ) ) , ( 0. R8 )) ) by L1902 , RFINSEQ:8
.= ( block_diagonal (( ( D275 ^ <* ( R29 . R5 ) *> ) ^ ( R29 /^ R5 ) ) , ( 0. R8 )) ) by L1881 , L1878 , FINSEQ_5:10
.= ( block_diagonal (( D275 ^ ( <* ( R29 . R5 ) *> ^ ( R29 /^ R5 ) ) ) , ( 0. R8 )) ) by FINSEQ_1:32
.= ( block_diagonal (( <* D279 *> ^ ( <* ( R29 . R5 ) *> ^ ( R29 /^ R5 ) ) ) , ( 0. R8 )) ) by L1078
.= ( block_diagonal (( <* D279 *> ^ <* ( block_diagonal (( <* ( R29 . R5 ) *> ^ ( R29 /^ R5 ) ) , ( 0. R8 )) ) *> ) , ( 0. R8 )) ) by L1126
.= ( block_diagonal (<* D279 , D278 *> , ( 0. R8 )) ) by L1126;
L1904: ( len C51 ) = ( Sum ( Len <* D279 , D278 *> ) ) by L1903 , L537;
L1905: ( Sum ( Width <* D279 , D278 *> ) ) = ( ( width D279 ) + ( width D278 ) ) by L523;
L1906: ( width D279 ) = ( Sum ( Len D275 ) ) by MATRIX_1:24;
L1907: ( len D279 ) = ( Sum ( Len D275 ) ) by L537;
L1908: ( width C51 ) = R4 by MATRIX_1:24;
L1909: ( Sum ( Len <* D279 , D278 *> ) ) = ( ( len D279 ) + ( len D278 ) ) by L475;
L1910: ( len C51 ) = R4 by MATRIX_1:24;
L1911: ( width C51 ) = ( Sum ( Width <* D279 , D278 *> ) ) by L1903 , L537;
reconsider D280 = D278 as (Matrix of ( len D278 ) , R8) by L1911 , L1904 , L1910 , L1908 , L1909 , L1907 , L1906 , L1905 , MATRIX_2:7;
L1912: R5 in ( dom ( Len R29 ) ) by L1881 , L1891 , FINSEQ_1:def 3;
L1913: ( len ( R29 . R5 ) ) = ( ( Len R29 ) . R5 ) by L1912 , L387;
L1914: ( Det D280 ) = ( 0. R8 ) by L1913 , L1881 , L1886 , L1780;
thus L1915: ( Det C51 ) = ( ( Det D279 ) * ( 0. R8 ) ) by L1914 , L1903 , L1904 , L1910 , L1698
.= ( 0. R8 ) by VECTSP_1:6;
end;
begin
definition
let R8 being Field;
let C52 being (FinSequence of ( NAT ));
func 1. (R8 , C52) -> (FinSequence_of_Square-Matrix of R8) means 
:L1916: (( dom it ) = ( dom C52 ) & (for R1 being Nat holds (R1 in ( dom it ) implies ( it . R1 ) = ( 1. (R8 , ( C52 . R1 )) ))));
existence
proof
deffunc H4(Nat) = ( 1. (R8 , ( C52 . $1 )) );
consider C53 being FinSequence such that L1917: ( len C53 ) = ( len C52 ) and L1918: (for R5 being Nat holds (R5 in ( dom C53 ) implies ( C53 . R5 ) = H4(R5))) from FINSEQ_1:sch 2;
L1919: ( rng C53 ) c= ( ( (the carrier of R8) * ) * )
proof
let R7 being set;
assume L1920: R7 in ( rng C53 );
consider R6 being set such that L1921: R6 in ( dom C53 ) and L1922: ( C53 . R6 ) = R7 by L1920 , FUNCT_1:def 3;
reconsider D281 = R6 as Nat by L1921;
L1923: ( C53 . D281 ) = ( 1. (R8 , ( C52 . D281 )) ) by L1918 , L1921;
thus L1924: thesis by L1923 , L1922 , FINSEQ_1:def 11;
end;
reconsider D282 = C53 as (FinSequence of ( ( (the carrier of R8) * ) * )) by L1919 , FINSEQ_1:def 4;
L1925:
now
let R1 being Nat;
assume L1926: R1 in ( dom D282 );
L1927: ( D282 . R1 ) = ( 1. (R8 , ( C52 . R1 )) ) by L1926 , L1918;
thus L1928: ( D282 . R1 ) is (Matrix of R8) by L1927;
end;
reconsider D283 = D282 as (FinSequence_of_Matrix of R8) by L1925 , L334;
L1929:
now
let R1 being Nat;
assume L1930: R1 in ( dom D283 );
L1931: ( D283 . R1 ) = ( 1. (R8 , ( C52 . R1 )) ) by L1930 , L1918;
thus L1932: (ex R4 being Nat st ( D283 . R1 ) is (Matrix of R4 , R8)) by L1931;
end;
reconsider D284 = D283 as (FinSequence_of_Square-Matrix of R8) by L1929 , L1497;
take D284;
thus L1933: thesis by L1917 , L1918 , FINSEQ_3:29;
end;
uniqueness
proof
let C54 , C55 being (FinSequence_of_Square-Matrix of R8);
assume that
L1934: ( dom C54 ) = ( dom C52 )
and
L1935: (for R1 being Nat holds (R1 in ( dom C54 ) implies ( C54 . R1 ) = ( 1. (R8 , ( C52 . R1 )) )))
and
L1936: ( dom C55 ) = ( dom C52 )
and
L1937: (for R1 being Nat holds (R1 in ( dom C55 ) implies ( C55 . R1 ) = ( 1. (R8 , ( C52 . R1 )) )));
L1938:
now
let R1 being Nat;
assume that
L1939: R1 in ( dom C52 );
thus L1940: ( C54 . R1 ) = ( 1. (R8 , ( C52 . R1 )) ) by L1934 , L1935 , L1939
.= ( C55 . R1 ) by L1936 , L1937 , L1939;
end;
thus L1941: thesis by L1938 , L1934 , L1936 , FINSEQ_1:13;
end;
end;
theorem
L1943: (for R8 being Field holds (for R24 being (FinSequence of ( NAT )) holds (( Len ( 1. (R8 , R24) ) ) = R24 & ( Width ( 1. (R8 , R24) ) ) = R24)))
proof
let R8 being Field;
let R24 being (FinSequence of ( NAT ));
set D285 = ( 1. (R8 , R24) );
L1944: ( dom D285 ) = ( dom R24 ) by L1916;
L1945: ( dom ( Len D285 ) ) = ( dom D285 ) by L387;
L1946:
now
let R1 being Nat;
assume that
L1947: R1 in ( dom ( Len D285 ) );
thus L1948: ( ( Len D285 ) . R1 ) = ( len ( D285 . R1 ) ) by L1947 , L387
.= ( len ( 1. (R8 , ( R24 . R1 )) ) ) by L1945 , L1947 , L1916
.= ( R24 . R1 ) by MATRIX_1:24;
end;
thus L1949: ( Len D285 ) = R24 by L1946 , L1945 , L1944 , FINSEQ_1:13;
L1950: ( dom ( Width D285 ) ) = ( dom D285 ) by L399;
L1951:
now
let R1 being Nat;
assume that
L1952: R1 in ( dom ( Width D285 ) );
thus L1953: ( ( Width D285 ) . R1 ) = ( width ( D285 . R1 ) ) by L1952 , L399
.= ( width ( 1. (R8 , ( R24 . R1 )) ) ) by L1950 , L1952 , L1916
.= ( R24 . R1 ) by MATRIX_1:24;
end;
thus L1954: thesis by L1951 , L1950 , L1944 , FINSEQ_1:13;
end;
theorem
L1955: (for R8 being Field holds (for B27 being (Element of ( NAT )) holds ( 1. (R8 , <* B27 *>) ) = <* ( 1. (R8 , B27) ) *>))
proof
let R8 being Field;
let C56 being (Element of ( NAT ));
L1956: ( dom ( 1. (R8 , <* C56 *>) ) ) = ( dom <* C56 *> ) by L1916
.= ( Seg 1 ) by FINSEQ_1:38;
L1957: 1 in ( dom ( 1. (R8 , <* C56 *>) ) ) by L1956;
L1958: ( ( 1. (R8 , <* C56 *>) ) . 1 ) = ( 1. (R8 , ( <* C56 *> . 1 )) ) by L1957 , L1916
.= ( 1. (R8 , C56) ) by FINSEQ_1:40;
L1959: ( len ( 1. (R8 , <* C56 *>) ) ) = 1 by L1956 , FINSEQ_1:def 3;
thus L1960: thesis by L1959 , L1958 , FINSEQ_1:40;
end;
theorem
L1961: (for R8 being Field holds (for R24 being (FinSequence of ( NAT )) holds (for R25 being (FinSequence of ( NAT )) holds ( 1. (R8 , ( R24 ^ R25 )) ) = ( ( 1. (R8 , R24) ) ^ ( 1. (R8 , R25) ) ))))
proof
let R8 being Field;
let R24 being (FinSequence of ( NAT ));
let R25 being (FinSequence of ( NAT ));
set D286 = ( 1. (R8 , R24) );
set D287 = ( 1. (R8 , R25) );
set D288 = ( D286 ^ D287 );
set D289 = ( 1. (R8 , ( R24 ^ R25 )) );
L1962: ( len ( R24 ^ R25 ) ) = ( ( len R24 ) + ( len R25 ) ) by FINSEQ_1:22;
L1963: ( dom D289 ) = ( dom ( R24 ^ R25 ) ) by L1916;
L1964: ( dom D287 ) = ( dom R25 ) by L1916;
L1965: ( len D287 ) = ( len R25 ) by L1964 , FINSEQ_3:29;
L1966: ( dom D286 ) = ( dom R24 ) by L1916;
L1967: ( len D286 ) = ( len R24 ) by L1966 , FINSEQ_3:29;
L1968: ( len D288 ) = ( ( len D286 ) + ( len D287 ) ) by FINSEQ_1:22;
L1969:
now
let R1 being Nat;
assume that
L1970: 1 <= R1
and
L1971: R1 <= ( len D288 );
L1972: R1 in ( dom D289 ) by L1963 , L1967 , L1965 , L1968 , L1962 , L1970 , L1971 , FINSEQ_3:25;
L1973: ( D289 . R1 ) = ( 1. (R8 , ( ( R24 ^ R25 ) . R1 )) ) by L1972 , L1916;
L1974: R1 in ( dom D288 ) by L1970 , L1971 , FINSEQ_3:25;
L1975:
now
per cases  by L1974 , FINSEQ_1:25;
suppose L1976: R1 in ( dom D286 );

thus L1977: ( D289 . R1 ) = ( 1. (R8 , ( R24 . R1 )) ) by L1976 , L1966 , L1973 , FINSEQ_1:def 7
.= ( D286 . R1 ) by L1976 , L1916
.= ( D288 . R1 ) by L1976 , FINSEQ_1:def 7;
end;
suppose L1978: (ex R4 being Nat st (R4 in ( dom D287 ) & R1 = ( ( len D286 ) + R4 )));

consider R4 being Nat such that L1979: R4 in ( dom D287 ) and L1980: R1 = ( ( len D286 ) + R4 ) by L1978;
thus L1981: ( D289 . R1 ) = ( 1. (R8 , ( R25 . R4 )) ) by L1964 , L1967 , L1973 , L1979 , L1980 , FINSEQ_1:def 7
.= ( D287 . R4 ) by L1979 , L1916
.= ( D288 . R1 ) by L1979 , L1980 , FINSEQ_1:def 7;
end;
end;
thus L1983: ( D289 . R1 ) = ( D288 . R1 ) by L1975;
end;
L1984: ( len D289 ) = ( len ( R24 ^ R25 ) ) by L1963 , FINSEQ_3:29;
thus L1985: thesis by L1984 , L1967 , L1965 , L1962 , L1969 , FINSEQ_1:14 , FINSEQ_1:22;
end;
theorem
L1986: (for R4 being Nat holds (for R8 being Field holds (for R24 being (FinSequence of ( NAT )) holds ( 1. (R8 , ( R24 | R4 )) ) = ( ( 1. (R8 , R24) ) | R4 ))))
proof
let R4 being Nat;
let R8 being Field;
let R24 being (FinSequence of ( NAT ));
L1987: ( dom ( 1. (R8 , ( R24 | R4 )) ) ) = ( dom ( R24 | R4 ) ) by L1916;
L1988: ( len ( 1. (R8 , ( R24 | R4 )) ) ) = ( len ( R24 | R4 ) ) by L1987 , FINSEQ_3:29;
L1989: ( dom ( 1. (R8 , R24) ) ) = ( dom R24 ) by L1916;
L1990: ( len ( 1. (R8 , R24) ) ) = ( len R24 ) by L1989 , FINSEQ_3:29;
per cases ;
suppose L1991: R4 > ( len R24 );

L1992: ( R24 | R4 ) = R24 by L1991 , FINSEQ_1:58;
thus L1993: thesis by L1992 , L1990 , L1991 , FINSEQ_1:58;
end;
suppose L1994: R4 <= ( len R24 );

L1995: R24 = ( ( R24 | R4 ) ^ ( R24 /^ R4 ) ) by RFINSEQ:8;
L1996: ( 1. (R8 , R24) ) = ( ( 1. (R8 , ( R24 | R4 )) ) ^ ( 1. (R8 , ( R24 /^ R4 )) ) ) by L1995 , L1961;
L1997: ( len ( 1. (R8 , ( R24 | R4 )) ) ) = R4 by L1988 , L1994 , FINSEQ_1:59;
thus L1998: thesis by L1997 , L1996 , FINSEQ_5:23;
end;
end;
theorem
L2000: (for R1 being Nat holds (for R2 being Nat holds (for R8 being Field holds ( block_diagonal (<* ( 1. (R8 , R1) ) , ( 1. (R8 , R2) ) *> , ( 0. R8 )) ) = ( 1. (R8 , ( R1 + R2 )) ))))
proof
let R1 being Nat;
let R2 being Nat;
let R8 being Field;
set D290 = ( 1. (R8 , R1) );
set D291 = ( 1. (R8 , R2) );
set D292 = ( block_diagonal (<* D290 , D291 *> , ( 0. R8 )) );
L2001: ( len D290 ) = R1 by MATRIX_1:24;
L2002: ( Sum ( Len <* D291 *> ) ) = ( len D291 ) by L472;
L2003: ( len D291 ) = R2 by MATRIX_1:24;
L2004: ( Indices ( block_diagonal (<* D291 *> , ( 0. R8 )) ) ) = [: ( Seg R2 ) , ( Seg R2 ) :] by L2003 , L2002 , MATRIX_1:24;
L2005: ( Sum ( Len <* D290 , D291 *> ) ) = ( ( len D290 ) + ( len D291 ) ) by L475;
reconsider D293 = D292 as (Matrix of ( R1 + R2 ) , R8) by L2005 , L2001 , L2003;
L2006: ( Indices D293 ) = [: ( Seg ( R1 + R2 ) ) , ( Seg ( R1 + R2 ) ) :] by MATRIX_1:24;
L2007: ( Indices D291 ) = [: ( Seg R2 ) , ( Seg R2 ) :] by MATRIX_1:24;
L2008: ( width D290 ) = R1 by MATRIX_1:24;
L2009: ( Indices D290 ) = [: ( Seg R1 ) , ( Seg R1 ) :] by MATRIX_1:24;
L2010: ( Sum ( Width <* D290 *> ) ) = ( width D290 ) by L520;
L2011: ( Sum ( Len <* D290 *> ) ) = ( len D290 ) by L472;
L2012: ( Indices ( block_diagonal (<* D290 *> , ( 0. R8 )) ) ) = [: ( Seg R1 ) , ( Seg R1 ) :] by L2011 , L2001 , MATRIX_1:24;
L2013:
now
let R4 being Nat;
let R3 being Nat;
assume that
L2014: [ R4 , R3 ] in ( Indices D293 )
and
L2015: R4 <> R3;
L2016: R3 in ( Seg ( R1 + R2 ) ) by L2006 , L2014 , ZFMISC_1:87;
L2017: R3 >= 1 by L2016 , FINSEQ_1:1;
L2018: R4 in ( Seg ( R1 + R2 ) ) by L2006 , L2014 , ZFMISC_1:87;
L2019: R4 >= 1 by L2018 , FINSEQ_1:1;
L2020:
now
per cases ;
suppose L2021: (R4 <= R1 & R3 <= R1);

L2022: R3 in ( Seg R1 ) by L2021 , L2016 , L2017;
L2023: R4 in ( Seg R1 ) by L2018 , L2019 , L2021;
L2024: [ R4 , R3 ] in [: ( Seg R1 ) , ( Seg R1 ) :] by L2023 , L2022 , ZFMISC_1:87;
thus L2025: ( D293 * (R4 , R3) ) = ( ( block_diagonal (<* D290 *> , ( 0. R8 )) ) * (R4 , R3) ) by L2024 , L2002 , L2012 , L834
.= ( D290 * (R4 , R3) ) by L1073
.= ( 0. R8 ) by L2009 , L2015 , L2024 , MATRIX_1:def 11;
end;
suppose L2026: (R4 > R1 & R3 > R1);

L2027: ( R3 - R1 ) <> ( 0 ) by L2026;
L2028: ( R4 -' R1 ) = ( R4 - R1 ) by L2026 , XREAL_1:233;
L2029: R4 = ( ( R4 -' R1 ) + R1 ) by L2028;
L2030: ( R3 -' R1 ) = ( R3 - R1 ) by L2026 , XREAL_1:233;
L2031: R3 = ( ( R3 -' R1 ) + R1 ) by L2030;
L2032: ( R4 - R1 ) <> ( 0 ) by L2026;
L2033: [ ( R4 -' R1 ) , ( R3 -' R1 ) ] in [: ( Seg R2 ) , ( Seg R2 ) :] by L2032 , L2011 , L2010 , L2001 , L2008 , L2004 , L2014 , L2027 , L2029 , L2031 , L861;
thus L2034: ( D293 * (R4 , R3) ) = ( ( block_diagonal (<* D291 *> , ( 0. R8 )) ) * (( R4 -' R1 ) , ( R3 -' R1 )) ) by L2033 , L2011 , L2010 , L2001 , L2008 , L2004 , L2029 , L2031 , L888
.= ( D291 * (( R4 -' R1 ) , ( R3 -' R1 )) ) by L1073
.= ( 0. R8 ) by L2007 , L2015 , L2029 , L2031 , L2033 , MATRIX_1:def 11;
end;
suppose L2035: ((R4 <= R1 & R3 > R1) or (R4 > R1 & R3 <= R1));

thus L2036: ( D293 * (R4 , R3) ) = ( 0. R8 ) by L2035 , L2011 , L2010 , L2002 , L2001 , L2008 , L2014 , L934;
end;
end;
thus L2038: ( D293 * (R4 , R3) ) = ( 0. R8 ) by L2020;
end;
L2039:
now
let R4 being Nat;
assume that
L2040: [ R4 , R4 ] in ( Indices D293 );
L2041: R4 in ( Seg ( R1 + R2 ) ) by L2006 , L2040 , ZFMISC_1:87;
L2042: R4 >= 1 by L2041 , FINSEQ_1:1;
L2043:
now
per cases ;
suppose L2044: R4 <= R1;

L2045: R4 in ( Seg R1 ) by L2044 , L2041 , L2042;
L2046: [ R4 , R4 ] in [: ( Seg R1 ) , ( Seg R1 ) :] by L2045 , ZFMISC_1:87;
thus L2047: ( D293 * (R4 , R4) ) = ( ( block_diagonal (<* D290 *> , ( 0. R8 )) ) * (R4 , R4) ) by L2046 , L2002 , L2012 , L834
.= ( D290 * (R4 , R4) ) by L1073
.= ( 1_ R8 ) by L2009 , L2046 , MATRIX_1:def 11;
end;
suppose L2048: R4 > R1;

L2049: ( R4 -' R1 ) = ( R4 - R1 ) by L2048 , XREAL_1:233;
L2050: R4 = ( ( R4 -' R1 ) + R1 ) by L2049;
L2051: ( R4 - R1 ) <> ( 0 ) by L2048;
L2052: [ ( R4 -' R1 ) , ( R4 -' R1 ) ] in [: ( Seg R2 ) , ( Seg R2 ) :] by L2051 , L2011 , L2010 , L2001 , L2008 , L2004 , L2040 , L2050 , L861;
thus L2053: ( D293 * (R4 , R4) ) = ( ( block_diagonal (<* D291 *> , ( 0. R8 )) ) * (( R4 -' R1 ) , ( R4 -' R1 )) ) by L2052 , L2011 , L2010 , L2001 , L2008 , L2004 , L2050 , L888
.= ( D291 * (( R4 -' R1 ) , ( R4 -' R1 )) ) by L1073
.= ( 1_ R8 ) by L2007 , L2052 , MATRIX_1:def 11;
end;
end;
thus L2055: ( D293 * (R4 , R4) ) = ( 1_ R8 ) by L2043;
end;
thus L2056: thesis by L2039 , L2013 , MATRIX_1:def 11;
end;
theorem
L2057: (for R8 being Field holds (for R24 being (FinSequence of ( NAT )) holds ( block_diagonal (( 1. (R8 , R24) ) , ( 0. R8 )) ) = ( 1. (R8 , ( Sum R24 )) )))
proof
let R8 being Field;
let R24 being (FinSequence of ( NAT ));
defpred S8[ Nat ] means (for R24 being (FinSequence of ( NAT )) holds (( len R24 ) = $1 implies ( block_diagonal (( 1. (R8 , R24) ) , ( 0. R8 )) ) = ( 1. (R8 , ( Sum R24 )) )));
L2058: (for R4 being Nat holds (S8[ R4 ] implies S8[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume that
L2059: S8[ R4 ];
set D294 = ( R4 + 1 );
let R24 being (FinSequence of ( NAT ));
assume that
L2060: ( len R24 ) = D294;
L2061: ( len ( R24 | R4 ) ) = R4 by L2060 , FINSEQ_1:59 , NAT_1:11;
L2062: 1 <= D294 by NAT_1:11;
L2063: D294 in ( dom R24 ) by L2062 , L2060 , FINSEQ_3:25;
L2064: ( R24 /. D294 ) = ( R24 . D294 ) by L2063 , PARTFUN1:def 6;
L2065: R24 = ( ( R24 | R4 ) ^ <* ( R24 . D294 ) *> ) by L2060 , FINSEQ_3:55;
thus L2066: ( block_diagonal (( 1. (R8 , R24) ) , ( 0. R8 )) ) = ( block_diagonal (( ( 1. (R8 , ( R24 | R4 )) ) ^ ( 1. (R8 , <* ( R24 /. D294 ) *>) ) ) , ( 0. R8 )) ) by L2065 , L2064 , L1961
.= ( block_diagonal (( ( 1. (R8 , ( R24 | R4 )) ) ^ <* ( 1. (R8 , ( R24 . D294 )) ) *> ) , ( 0. R8 )) ) by L2064 , L1955
.= ( block_diagonal (( <* ( block_diagonal (( 1. (R8 , ( R24 | R4 )) ) , ( 0. R8 )) ) *> ^ <* ( 1. (R8 , ( R24 . D294 )) ) *> ) , ( 0. R8 )) ) by L1078
.= ( block_diagonal (<* ( 1. (R8 , ( Sum ( R24 | R4 ) )) ) , ( 1. (R8 , ( R24 . D294 )) ) *> , ( 0. R8 )) ) by L2059 , L2061
.= ( 1. (R8 , ( ( Sum ( R24 | R4 ) ) + ( R24 . D294 ) )) ) by L2000
.= ( 1. (R8 , ( Sum R24 )) ) by L2065 , RVSUM_1:74;
end;
L2067: S8[ ( 0 ) ]
proof
let R24 being (FinSequence of ( NAT ));
assume that
L2068: ( len R24 ) = ( 0 );
L2069: ( dom ( 1. (R8 , R24) ) ) = ( dom R24 ) by L1916;
L2070: ( len ( 1. (R8 , R24) ) ) = ( 0 ) by L2069 , L2068 , FINSEQ_3:29;
L2071: ( Sum ( Len ( 1. (R8 , R24) ) ) ) = ( 0 ) by L2070 , RVSUM_1:72;
L2072: R24 = ( {} ) by L2068;
thus L2073: thesis by L2072 , L2071 , MATRIX_1:35 , RVSUM_1:72;
end;
L2074: (for R4 being Nat holds S8[ R4 ]) from NAT_1:sch 2(L2067 , L2058);
L2075: S8[ ( len R24 ) ] by L2074;
thus L2076: thesis by L2075;
end;
begin
definition
let R8 being Field;
let R29 being (FinSequence_of_Matrix of R8);
let R41 being (FinSequence of R8);
func mlt (R41 , R29) -> (FinSequence_of_Matrix of R8) means 
:L2077: (( dom it ) = ( dom R29 ) & (for R1 being Nat holds (R1 in ( dom it ) implies ( it . R1 ) = ( ( R41 /. R1 ) * ( R29 . R1 ) ))));
existence
proof
deffunc H5(Nat) = ( ( R41 /. $1 ) * ( R29 . $1 ) );
consider C57 being FinSequence such that L2078: ( len C57 ) = ( len R29 ) and L2079: (for R5 being Nat holds (R5 in ( dom C57 ) implies ( C57 . R5 ) = H5(R5))) from FINSEQ_1:sch 2;
L2080: ( rng C57 ) c= ( ( (the carrier of R8) * ) * )
proof
let R7 being set;
assume L2081: R7 in ( rng C57 );
consider R6 being set such that L2082: R6 in ( dom C57 ) and L2083: ( C57 . R6 ) = R7 by L2081 , FUNCT_1:def 3;
reconsider D295 = R6 as Nat by L2082;
L2084: ( C57 . D295 ) = ( ( R41 /. D295 ) * ( R29 . D295 ) ) by L2079 , L2082;
thus L2085: thesis by L2084 , L2083 , FINSEQ_1:def 11;
end;
reconsider D296 = C57 as (FinSequence of ( ( (the carrier of R8) * ) * )) by L2080 , FINSEQ_1:def 4;
L2086:
now
let R1 being Nat;
assume L2087: R1 in ( dom D296 );
L2088: ( D296 . R1 ) = ( ( R41 /. R1 ) * ( R29 . R1 ) ) by L2087 , L2079;
thus L2089: ( D296 . R1 ) is (Matrix of R8) by L2088;
end;
reconsider D297 = D296 as (FinSequence_of_Matrix of R8) by L2086 , L334;
take D297;
thus L2090: thesis by L2078 , L2079 , FINSEQ_3:29;
end;
uniqueness
proof
let C58 , C59 being (FinSequence_of_Matrix of R8);
assume that
L2091: ( dom C58 ) = ( dom R29 )
and
L2092: (for R1 being Nat holds (R1 in ( dom C58 ) implies ( C58 . R1 ) = ( ( R41 /. R1 ) * ( R29 . R1 ) )))
and
L2093: ( dom C59 ) = ( dom R29 )
and
L2094: (for R1 being Nat holds (R1 in ( dom C59 ) implies ( C59 . R1 ) = ( ( R41 /. R1 ) * ( R29 . R1 ) )));
L2095:
now
let R1 being Nat;
assume that
L2096: R1 in ( dom R29 );
thus L2097: ( C58 . R1 ) = ( ( R41 /. R1 ) * ( R29 . R1 ) ) by L2091 , L2092 , L2096
.= ( C59 . R1 ) by L2093 , L2094 , L2096;
end;
thus L2098: thesis by L2095 , L2091 , L2093 , FINSEQ_1:13;
end;
end;
registration
let R8 being Field;
let R36 being (FinSequence_of_Square-Matrix of R8);
let R41 being (FinSequence of R8);
cluster ( mlt (R41 , R36) ) ->  Square-Matrix-yielding;
coherence
proof
set D298 = ( mlt (R41 , R36) );
let R1 being Nat;
assume L2100: R1 in ( dom D298 );
L2101: ( D298 . R1 ) = ( ( R41 /. R1 ) * ( R36 . R1 ) ) by L2100 , L2077;
consider R4 being Nat such that L2102: ( R36 . R1 ) is (Matrix of R4 , R8);
take R4;
L2103: ( len ( R36 . R1 ) ) = R4 by L2102 , MATRIX_1:24;
thus L2104: ( D298 . R1 ) is (Matrix of R4 , R8) by L2103 , L2101;
end;
end;
theorem
L2106: (for R8 being Field holds (for R29 being (FinSequence_of_Matrix of R8) holds (for R41 being (FinSequence of R8) holds (( Len ( mlt (R41 , R29) ) ) = ( Len R29 ) & ( Width ( mlt (R41 , R29) ) ) = ( Width R29 )))))
proof
let R8 being Field;
let R29 being (FinSequence_of_Matrix of R8);
let R41 being (FinSequence of R8);
set D299 = ( mlt (R41 , R29) );
L2107: ( dom ( Len D299 ) ) = ( dom D299 ) by L387;
L2108: ( dom D299 ) = ( dom R29 ) by L2077;
L2109: ( dom ( Len R29 ) ) = ( dom R29 ) by L387;
L2110:
now
let R1 being Nat;
assume that
L2111: R1 in ( dom ( Len D299 ) );
thus L2112: ( ( Len D299 ) . R1 ) = ( len ( D299 . R1 ) ) by L2111 , L387
.= ( len ( ( R41 /. R1 ) * ( R29 . R1 ) ) ) by L2107 , L2111 , L2077
.= ( len ( R29 . R1 ) ) by MATRIX_3:def 5
.= ( ( Len R29 ) . R1 ) by L2107 , L2109 , L2108 , L2111 , L387;
end;
thus L2113: ( Len D299 ) = ( Len R29 ) by L2110 , L2107 , L2109 , L2108 , FINSEQ_1:13;
L2114: ( dom ( Width D299 ) ) = ( dom D299 ) by L399;
L2115: ( dom ( Width R29 ) ) = ( dom R29 ) by L399;
L2116:
now
let R1 being Nat;
assume that
L2117: R1 in ( dom ( Width D299 ) );
thus L2118: ( ( Width D299 ) . R1 ) = ( width ( D299 . R1 ) ) by L2117 , L399
.= ( width ( ( R41 /. R1 ) * ( R29 . R1 ) ) ) by L2114 , L2117 , L2077
.= ( width ( R29 . R1 ) ) by MATRIX_3:def 5
.= ( ( Width R29 ) . R1 ) by L2115 , L2114 , L2108 , L2117 , L399;
end;
thus L2119: thesis by L2116 , L2115 , L2114 , L2108 , FINSEQ_1:13;
end;
theorem
L2120: (for R8 being Field holds (for R19 being (Matrix of R8) holds (for R41 being (FinSequence of R8) holds ( mlt (R41 , <* R19 *>) ) = <* ( ( R41 /. 1 ) * R19 ) *>)))
proof
let R8 being Field;
let R19 being (Matrix of R8);
let R41 being (FinSequence of R8);
L2121: ( dom ( mlt (R41 , <* R19 *>) ) ) = ( dom <* R19 *> ) by L2077
.= ( Seg 1 ) by FINSEQ_1:38;
L2122: 1 in ( dom ( mlt (R41 , <* R19 *>) ) ) by L2121;
L2123: ( ( mlt (R41 , <* R19 *>) ) . 1 ) = ( ( R41 /. 1 ) * ( <* R19 *> . 1 ) ) by L2122 , L2077
.= ( ( R41 /. 1 ) * R19 ) by FINSEQ_1:40;
L2124: ( len ( mlt (R41 , <* R19 *>) ) ) = 1 by L2121 , FINSEQ_1:def 3;
thus L2125: thesis by L2124 , L2123 , FINSEQ_1:40;
end;
theorem
L2126: (for R8 being Field holds (for R29 being (FinSequence_of_Matrix of R8) holds (for R31 being (FinSequence_of_Matrix of R8) holds (for R41 being (FinSequence of R8) holds (for R42 being (FinSequence of R8) holds ((( len R29 ) = ( len R41 ) & ( len R31 ) <= ( len R42 )) implies ( mlt (( R41 ^ R42 ) , ( R29 ^ R31 )) ) = ( ( mlt (R41 , R29) ) ^ ( mlt (R42 , R31) ) )))))))
proof
let R8 being Field;
let R29 being (FinSequence_of_Matrix of R8);
let R31 being (FinSequence_of_Matrix of R8);
let R41 being (FinSequence of R8);
let R42 being (FinSequence of R8);
assume that
L2127: ( len R29 ) = ( len R41 )
and
L2128: ( len R31 ) <= ( len R42 );
L2129: ( dom R29 ) = ( dom R41 ) by L2127 , FINSEQ_3:29;
L2130: ( dom R31 ) = ( Seg ( len R31 ) ) by FINSEQ_1:def 3;
L2131: ( dom R31 ) c= ( Seg ( len R42 ) ) by L2130 , L2128 , FINSEQ_1:5;
L2132: ( dom R31 ) c= ( dom R42 ) by L2131 , FINSEQ_1:def 3;
set D300 = ( mlt (R42 , R31) );
set D301 = ( mlt (R41 , R29) );
set D302 = ( R29 ^ R31 );
set D303 = ( R41 ^ R42 );
set D304 = ( mlt (D303 , D302) );
L2133: ( dom D302 ) = ( Seg ( len D302 ) ) by FINSEQ_1:def 3;
L2134: ( dom D304 ) = ( dom D302 ) by L2077;
L2135: ( dom D300 ) = ( dom R31 ) by L2077;
L2136: ( len D300 ) = ( len R31 ) by L2135 , FINSEQ_3:29;
L2137: ( dom D301 ) = ( dom R29 ) by L2077;
L2138: ( len D301 ) = ( len R29 ) by L2137 , FINSEQ_3:29;
L2139: ( len D302 ) = ( ( len R29 ) + ( len R31 ) ) by FINSEQ_1:22;
L2140: ( len D302 ) <= ( ( len R41 ) + ( len R42 ) ) by L2139 , L2127 , L2128 , XREAL_1:7;
L2141: ( dom D302 ) c= ( Seg ( ( len R41 ) + ( len R42 ) ) ) by L2140 , L2133 , FINSEQ_1:5;
L2142: ( dom D302 ) c= ( dom D303 ) by L2141 , FINSEQ_1:def 7;
L2143:
now
let R1 being Nat;
assume that
L2144: 1 <= R1
and
L2145: R1 <= ( len D302 );
L2146: R1 in ( dom D302 ) by L2144 , L2145 , FINSEQ_3:25;
L2147: ( D303 /. R1 ) = ( D303 . R1 ) by L2146 , L2142 , PARTFUN1:def 6;
L2148: ( D304 . R1 ) = ( ( D303 /. R1 ) * ( D302 . R1 ) ) by L2134 , L2146 , L2077;
L2149:
now
per cases  by L2146 , FINSEQ_1:25;
suppose L2150: R1 in ( dom R29 );

L2151: ( D302 . R1 ) = ( R29 . R1 ) by L2150 , FINSEQ_1:def 7;
L2152: ( R41 . R1 ) = ( R41 /. R1 ) by L2129 , L2150 , PARTFUN1:def 6;
L2153: ( D303 . R1 ) = ( R41 . R1 ) by L2129 , L2150 , FINSEQ_1:def 7;
thus L2154: ( D304 . R1 ) = ( D301 . R1 ) by L2153 , L2137 , L2148 , L2147 , L2150 , L2151 , L2152 , L2077
.= ( ( D301 ^ D300 ) . R1 ) by L2137 , L2150 , FINSEQ_1:def 7;
end;
suppose L2155: (ex R4 being Nat st (R4 in ( dom R31 ) & R1 = ( ( len R29 ) + R4 )));

consider R4 being Nat such that L2156: R4 in ( dom R31 ) and L2157: R1 = ( ( len R29 ) + R4 ) by L2155;
L2158: ( D302 . R1 ) = ( R31 . R4 ) by L2156 , L2157 , FINSEQ_1:def 7;
L2159: ( R42 /. R4 ) = ( R42 . R4 ) by L2132 , L2156 , PARTFUN1:def 6;
L2160: ( D303 . R1 ) = ( R42 . R4 ) by L2127 , L2132 , L2156 , L2157 , FINSEQ_1:def 7;
thus L2161: ( D304 . R1 ) = ( D300 . R4 ) by L2160 , L2135 , L2148 , L2147 , L2156 , L2158 , L2159 , L2077
.= ( ( D301 ^ D300 ) . R1 ) by L2135 , L2138 , L2156 , L2157 , FINSEQ_1:def 7;
end;
end;
thus L2163: ( D304 . R1 ) = ( ( D301 ^ D300 ) . R1 ) by L2149;
end;
L2164: ( len ( D301 ^ D300 ) ) = ( ( len D301 ) + ( len D300 ) ) by FINSEQ_1:22;
L2165: ( len D304 ) = ( len D302 ) by L2134 , FINSEQ_3:29;
thus L2166: thesis by L2165 , L2138 , L2136 , L2164 , L2143 , FINSEQ_1:14 , FINSEQ_1:22;
end;
L2167: (for R8 being Field holds (for R9 being (Element of R8) holds (for R10 being (Element of R8) holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds ( R9 * ( block_diagonal (<* R20 , R21 *> , R10) ) ) = ( block_diagonal (<* ( R9 * R20 ) , ( R9 * R21 ) *> , ( R9 * R10 )) ))))))
proof
let R8 being Field;
let R9 being (Element of R8);
let R10 being (Element of R8);
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
set D305 = ( R9 * R20 );
set D306 = ( R9 * R21 );
set D307 = ( R9 * R10 );
set D308 = ( block_diagonal (<* R20 , R21 *> , R10) );
L2168: ( width D306 ) = ( width R21 ) by MATRIX_3:def 5;
L2169: ( width D305 ) = ( width R20 ) by MATRIX_3:def 5;
L2170: ( Sum ( Width <* D305 , D306 *> ) ) = ( ( width R20 ) + ( width R21 ) ) by L2169 , L2168 , L523;
L2171: ( len D308 ) = ( Sum ( Len <* R20 , R21 *> ) ) by L537;
L2172: ( len D306 ) = ( len R21 ) by MATRIX_3:def 5;
L2173: ( dom D306 ) = ( dom R21 ) by L2172 , FINSEQ_3:29;
L2174: ( Sum ( Width <* R20 , R21 *> ) ) = ( ( width R20 ) + ( width R21 ) ) by L523;
L2175: ( Sum ( Len <* R20 , R21 *> ) ) = ( ( len R20 ) + ( len R21 ) ) by L475;
L2176: ( len D305 ) = ( len R20 ) by MATRIX_3:def 5;
L2177: ( dom D305 ) = ( dom R20 ) by L2176 , FINSEQ_3:29;
L2178:
now
let R1 being Nat;
thus L2179: (R1 in ( dom D305 ) implies ( Line (( R9 * D308 ) , R1) ) = ( ( Line (D305 , R1) ) ^ ( ( width D306 ) |-> D307 ) ))
proof
assume L2180: R1 in ( dom D305 );
L2181: 1 <= R1 by L2180 , FINSEQ_3:25;
L2182: R1 <= ( len R20 ) by L2176 , L2180 , FINSEQ_3:25;
L2183: ( len R20 ) <= ( len D308 ) by L2175 , L2171 , NAT_1:11;
L2184: R1 <= ( len D308 ) by L2183 , L2182 , XXREAL_0:2;
thus L2185: ( Line (( R9 * D308 ) , R1) ) = ( R9 * ( Line (D308 , R1) ) ) by L2184 , L2181 , MATRIXR1:20
.= ( R9 * ( ( Line (R20 , R1) ) ^ ( ( width R21 ) |-> R10 ) ) ) by L2177 , L2180 , L576
.= ( ( R9 * ( Line (R20 , R1) ) ) ^ ( R9 * ( ( width R21 ) |-> R10 ) ) ) by MATRIX15:4
.= ( ( Line (D305 , R1) ) ^ ( R9 * ( ( width R21 ) |-> R10 ) ) ) by L2181 , L2182 , MATRIXR1:20
.= ( ( Line (D305 , R1) ) ^ ( ( width D306 ) |-> D307 ) ) by L2168 , FVSUM_1:53;
end;

thus L2186: (R1 in ( dom D306 ) implies ( Line (( R9 * D308 ) , ( R1 + ( len D305 ) )) ) = ( ( ( width D305 ) |-> D307 ) ^ ( Line (D306 , R1) ) ))
proof
assume L2187: R1 in ( dom D306 );
L2188: 1 <= R1 by L2187 , FINSEQ_3:25;
L2189: ( ( 0 ) + 1 ) <= ( R1 + ( len R20 ) ) by L2188 , XREAL_1:7;
L2190: R1 <= ( len R21 ) by L2172 , L2187 , FINSEQ_3:25;
L2191: ( R1 + ( len R20 ) ) <= ( len D308 ) by L2190 , L2175 , L2171 , XREAL_1:7;
thus L2192: ( Line (( R9 * D308 ) , ( R1 + ( len D305 ) )) ) = ( R9 * ( Line (D308 , ( R1 + ( len R20 ) )) ) ) by L2191 , L2176 , L2189 , MATRIXR1:20
.= ( R9 * ( ( ( width R20 ) |-> R10 ) ^ ( Line (R21 , R1) ) ) ) by L2173 , L2187 , L576
.= ( ( R9 * ( ( width R20 ) |-> R10 ) ) ^ ( R9 * ( Line (R21 , R1) ) ) ) by MATRIX15:4
.= ( ( ( width R20 ) |-> D307 ) ^ ( R9 * ( Line (R21 , R1) ) ) ) by FVSUM_1:53
.= ( ( ( width D305 ) |-> D307 ) ^ ( Line (D306 , R1) ) ) by L2169 , L2188 , L2190 , MATRIXR1:20;
end;

end;
L2187: ( Sum ( Len <* D305 , D306 *> ) ) = ( ( len R20 ) + ( len R21 ) ) by L2176 , L2172 , L475;
thus L2188: thesis by L2187 , L2175 , L2170 , L2174 , L2178 , L576;
end;
theorem
L2189: (for R8 being Field holds (for R9 being (Element of R8) holds (for R10 being (Element of R8) holds (for R29 being (FinSequence_of_Matrix of R8) holds ( R9 * ( block_diagonal (R29 , R10) ) ) = ( block_diagonal (( mlt (( ( len R29 ) |-> R9 ) , R29) ) , ( R9 * R10 )) )))))
proof
let R8 being Field;
let R9 being (Element of R8);
let R10 being (Element of R8);
let R29 being (FinSequence_of_Matrix of R8);
defpred S9[ Nat ] means (for R9 being (Element of R8) holds (for R10 being (Element of R8) holds (for R29 being (FinSequence_of_Matrix of R8) holds (( len R29 ) = $1 implies ( R9 * ( block_diagonal (R29 , R10) ) ) = ( block_diagonal (( mlt (( ( len R29 ) |-> R9 ) , R29) ) , ( R9 * R10 )) )))));
L2190: (for R4 being Nat holds (S9[ R4 ] implies S9[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume that
L2191: S9[ R4 ];
set D309 = ( R4 + 1 );
let R9 being (Element of R8);
let R10 being (Element of R8);
let R29 being (FinSequence_of_Matrix of R8);
assume that
L2192: ( len R29 ) = D309;
L2193: R29 = ( ( R29 | R4 ) ^ <* ( R29 . D309 ) *> ) by L2192 , FINSEQ_3:55;
L2194: R4 <= D309 by NAT_1:13;
L2195: ( len ( R29 | R4 ) ) = R4 by L2194 , L2192 , FINSEQ_1:59;
L2196: 1 in ( Seg 1 );
L2197: 1 in ( dom <* R9 *> ) by L2196 , FINSEQ_1:def 8;
L2198: ( <* R9 *> . 1 ) = ( <* R9 *> /. 1 ) by L2197 , PARTFUN1:def 6;
L2199: ( <* R9 *> . 1 ) = R9 by FINSEQ_1:def 8;
L2200: ( len <* R9 *> ) = 1 by FINSEQ_1:39;
L2201: ( len <* ( R29 . D309 ) *> ) = 1 by FINSEQ_1:39;
L2202: ( len ( R4 |-> R9 ) ) = R4 by CARD_1:def 7;
L2203: ( D309 |-> R9 ) = ( ( R4 |-> R9 ) ^ <* R9 *> ) by FINSEQ_2:60;
thus L2204: ( block_diagonal (( mlt (( ( len R29 ) |-> R9 ) , R29) ) , ( R9 * R10 )) ) = ( block_diagonal (( ( mlt (( R4 |-> R9 ) , ( R29 | R4 )) ) ^ ( mlt (<* R9 *> , <* ( R29 . D309 ) *>) ) ) , ( R9 * R10 )) ) by L2203 , L2192 , L2193 , L2195 , L2202 , L2201 , L2200 , L2126
.= ( block_diagonal (( ( mlt (( R4 |-> R9 ) , ( R29 | R4 )) ) ^ <* ( R9 * ( R29 . D309 ) ) *> ) , ( R9 * R10 )) ) by L2198 , L2199 , L2120
.= ( block_diagonal (( <* ( block_diagonal (( mlt (( R4 |-> R9 ) , ( R29 | R4 )) ) , ( R9 * R10 )) ) *> ^ <* ( R9 * ( R29 . D309 ) ) *> ) , ( R9 * R10 )) ) by L1078
.= ( block_diagonal (<* ( R9 * ( block_diagonal (( R29 | R4 ) , R10) ) ) , ( R9 * ( R29 . D309 ) ) *> , ( R9 * R10 )) ) by L2191 , L2195
.= ( R9 * ( block_diagonal (<* ( block_diagonal (( R29 | R4 ) , R10) ) , ( R29 . D309 ) *> , R10) ) ) by L2167
.= ( R9 * ( block_diagonal (R29 , R10) ) ) by L2193 , L1078;
end;
L2205: S9[ ( 0 ) ]
proof
let R9 being (Element of R8);
let R10 being (Element of R8);
let R29 being (FinSequence_of_Matrix of R8);
assume that
L2206: ( len R29 ) = ( 0 );
L2207: ( dom ( mlt (( ( len R29 ) |-> R9 ) , R29) ) ) = ( dom R29 ) by L2077;
L2208: ( len ( mlt (( ( len R29 ) |-> R9 ) , R29) ) ) = ( len R29 ) by L2207 , FINSEQ_3:29;
L2209: ( Len ( mlt (( ( len R29 ) |-> R9 ) , R29) ) ) = ( {} ) by L2208 , L2206;
L2210: ( len ( block_diagonal (( mlt (( ( len R29 ) |-> R9 ) , R29) ) , ( R9 * R10 )) ) ) = ( 0 ) by L2209 , L537 , RVSUM_1:72;
L2211: ( block_diagonal (( mlt (( ( len R29 ) |-> R9 ) , R29) ) , ( R9 * R10 )) ) = ( {} ) by L2210;
L2212: ( Len R29 ) = ( {} ) by L2206;
L2213: ( len ( block_diagonal (R29 , R10) ) ) = ( 0 ) by L2212 , L537 , RVSUM_1:72;
L2214: ( len ( R9 * ( block_diagonal (R29 , R10) ) ) ) = ( 0 ) by L2213 , MATRIX_3:def 5;
thus L2215: thesis by L2214 , L2211;
end;
L2216: (for R4 being Nat holds S9[ R4 ]) from NAT_1:sch 2(L2205 , L2190);
thus L2217: thesis by L2216;
end;
definition
let R8 being Field;
let C60 , C61 being (FinSequence_of_Matrix of R8);
func C60 (+) C61 -> (FinSequence_of_Matrix of R8) means 
:L2218: (( dom it ) = ( dom C60 ) & (for R1 being Nat holds (R1 in ( dom it ) implies ( it . R1 ) = ( ( C60 . R1 ) + ( C61 . R1 ) ))));
existence
proof
deffunc H6(Nat) = ( ( C60 . $1 ) + ( C61 . $1 ) );
consider C62 being FinSequence such that L2219: ( len C62 ) = ( len C60 ) and L2220: (for R5 being Nat holds (R5 in ( dom C62 ) implies ( C62 . R5 ) = H6(R5))) from FINSEQ_1:sch 2;
L2221: ( rng C62 ) c= ( ( (the carrier of R8) * ) * )
proof
let R7 being set;
assume L2222: R7 in ( rng C62 );
consider R6 being set such that L2223: R6 in ( dom C62 ) and L2224: ( C62 . R6 ) = R7 by L2222 , FUNCT_1:def 3;
reconsider D310 = R6 as Nat by L2223;
L2225: ( C62 . D310 ) = ( ( C60 . D310 ) + ( C61 . D310 ) ) by L2220 , L2223;
thus L2226: thesis by L2225 , L2224 , FINSEQ_1:def 11;
end;
reconsider D311 = C62 as (FinSequence of ( ( (the carrier of R8) * ) * )) by L2221 , FINSEQ_1:def 4;
L2227:
now
let R1 being Nat;
assume L2228: R1 in ( dom D311 );
L2229: ( D311 . R1 ) = ( ( C60 . R1 ) + ( C61 . R1 ) ) by L2228 , L2220;
thus L2230: ( D311 . R1 ) is (Matrix of R8) by L2229;
end;
reconsider D312 = D311 as (FinSequence_of_Matrix of R8) by L2227 , L334;
take D312;
thus L2231: thesis by L2219 , L2220 , FINSEQ_3:29;
end;
uniqueness
proof
let C63 , C64 being (FinSequence_of_Matrix of R8);
assume that
L2232: ( dom C63 ) = ( dom C60 )
and
L2233: (for R1 being Nat holds (R1 in ( dom C63 ) implies ( C63 . R1 ) = ( ( C60 . R1 ) + ( C61 . R1 ) )))
and
L2234: ( dom C64 ) = ( dom C60 )
and
L2235: (for R1 being Nat holds (R1 in ( dom C64 ) implies ( C64 . R1 ) = ( ( C60 . R1 ) + ( C61 . R1 ) )));
L2236:
now
let R1 being Nat;
assume that
L2237: R1 in ( dom C60 );
thus L2238: ( C63 . R1 ) = ( ( C60 . R1 ) + ( C61 . R1 ) ) by L2232 , L2233 , L2237
.= ( C64 . R1 ) by L2234 , L2235 , L2237;
end;
thus L2239: thesis by L2236 , L2232 , L2234 , FINSEQ_1:13;
end;
end;
registration
let R8 being Field;
let R36 being (FinSequence_of_Square-Matrix of R8);
let R29 being (FinSequence_of_Matrix of R8);
cluster ( R36 (+) R29 ) ->  Square-Matrix-yielding;
coherence
proof
set D313 = ( R36 (+) R29 );
let R1 being Nat;
assume L2241: R1 in ( dom D313 );
L2242: ( D313 . R1 ) = ( ( R36 . R1 ) + ( R29 . R1 ) ) by L2241 , L2218;
consider R4 being Nat such that L2243: ( R36 . R1 ) is (Matrix of R4 , R8);
take R4;
L2244: ( len ( ( R36 . R1 ) + ( R29 . R1 ) ) ) = ( len ( R36 . R1 ) ) by MATRIX_3:def 3;
L2245: ( width ( ( R36 . R1 ) + ( R29 . R1 ) ) ) = ( width ( R36 . R1 ) ) by MATRIX_3:def 3;
L2246: ( width ( R36 . R1 ) ) = R4 by L2243 , MATRIX_1:24;
thus L2247: ( D313 . R1 ) is (Matrix of R4 , R8) by L2246 , L2243 , L2242 , L2244 , L2245 , MATRIX_1:24 , MATRIX_2:7;
end;
end;
theorem
L2249: (for R8 being Field holds (for R31 being (FinSequence_of_Matrix of R8) holds (for R32 being (FinSequence_of_Matrix of R8) holds (( Len ( R31 (+) R32 ) ) = ( Len R31 ) & ( Width ( R31 (+) R32 ) ) = ( Width R31 )))))
proof
let R8 being Field;
let R31 being (FinSequence_of_Matrix of R8);
let R32 being (FinSequence_of_Matrix of R8);
set D314 = ( R31 (+) R32 );
L2250: ( dom ( Len D314 ) ) = ( dom D314 ) by L387;
L2251: ( dom D314 ) = ( dom R31 ) by L2218;
L2252: ( dom ( Len R31 ) ) = ( dom R31 ) by L387;
L2253:
now
let R1 being Nat;
assume that
L2254: R1 in ( dom ( Len D314 ) );
thus L2255: ( ( Len D314 ) . R1 ) = ( len ( D314 . R1 ) ) by L2254 , L387
.= ( len ( ( R31 . R1 ) + ( R32 . R1 ) ) ) by L2250 , L2254 , L2218
.= ( len ( R31 . R1 ) ) by MATRIX_3:def 3
.= ( ( Len R31 ) . R1 ) by L2252 , L2250 , L2251 , L2254 , L387;
end;
thus L2256: ( Len D314 ) = ( Len R31 ) by L2253 , L2252 , L2250 , L2251 , FINSEQ_1:13;
L2257: ( dom ( Width D314 ) ) = ( dom D314 ) by L399;
L2258: ( dom ( Width R31 ) ) = ( dom R31 ) by L399;
L2259:
now
let R1 being Nat;
assume that
L2260: R1 in ( dom ( Width D314 ) );
thus L2261: ( ( Width D314 ) . R1 ) = ( width ( D314 . R1 ) ) by L2260 , L399
.= ( width ( ( R31 . R1 ) + ( R32 . R1 ) ) ) by L2257 , L2260 , L2218
.= ( width ( R31 . R1 ) ) by MATRIX_3:def 3
.= ( ( Width R31 ) . R1 ) by L2258 , L2257 , L2251 , L2260 , L399;
end;
thus L2262: thesis by L2259 , L2258 , L2257 , L2251 , FINSEQ_1:13;
end;
theorem
L2263: (for R8 being Field holds (for R29 being (FinSequence_of_Matrix of R8) holds (for R30 being (FinSequence_of_Matrix of R8) holds (for R31 being (FinSequence_of_Matrix of R8) holds (for R32 being (FinSequence_of_Matrix of R8) holds (( len R29 ) = ( len R30 ) implies ( ( R29 ^ R31 ) (+) ( R30 ^ R32 ) ) = ( ( R29 (+) R30 ) ^ ( R31 (+) R32 ) )))))))
proof
let R8 being Field;
let R29 being (FinSequence_of_Matrix of R8);
let R30 being (FinSequence_of_Matrix of R8);
let R31 being (FinSequence_of_Matrix of R8);
let R32 being (FinSequence_of_Matrix of R8);
set D315 = ( R29 (+) R30 );
set D316 = ( R31 (+) R32 );
set D317 = ( R29 ^ R31 );
set D318 = ( R30 ^ R32 );
L2264: ( len D317 ) = ( ( len R29 ) + ( len R31 ) ) by FINSEQ_1:22;
L2265: ( dom D315 ) = ( dom R29 ) by L2218;
L2266: ( len D315 ) = ( len R29 ) by L2265 , FINSEQ_3:29;
L2267: ( dom ( D317 (+) D318 ) ) = ( dom D317 ) by L2218;
L2268: ( len ( D317 (+) D318 ) ) = ( len D317 ) by L2267 , FINSEQ_3:29;
assume L2269: ( len R29 ) = ( len R30 );
L2270: ( len D318 ) = ( ( len R29 ) + ( len R32 ) ) by L2269 , FINSEQ_1:22;
L2271: ( len ( D315 ^ D316 ) ) = ( ( len D315 ) + ( len D316 ) ) by FINSEQ_1:22;
L2272: ( dom D316 ) = ( dom R31 ) by L2218;
L2273: ( dom R29 ) = ( dom R30 ) by L2269 , FINSEQ_3:29;
L2274:
now
let R1 being Nat;
assume that
L2275: 1 <= R1
and
L2276: R1 <= ( ( len R29 ) + ( len R31 ) );
L2277: R1 in ( dom ( D317 (+) D318 ) ) by L2267 , L2264 , L2275 , L2276 , FINSEQ_3:25;
L2278: ( ( D317 (+) D318 ) . R1 ) = ( ( D317 . R1 ) + ( D318 . R1 ) ) by L2277 , L2218;
L2279:
now
per cases  by L2267 , L2277 , FINSEQ_1:25;
suppose L2280: R1 in ( dom R29 );

thus L2281: ( ( D317 (+) D318 ) . R1 ) = ( ( R29 . R1 ) + ( D318 . R1 ) ) by L2280 , L2278 , FINSEQ_1:def 7
.= ( ( R29 . R1 ) + ( R30 . R1 ) ) by L2273 , L2280 , FINSEQ_1:def 7
.= ( D315 . R1 ) by L2265 , L2280 , L2218
.= ( ( D315 ^ D316 ) . R1 ) by L2265 , L2280 , FINSEQ_1:def 7;
end;
suppose L2282: (ex R4 being Nat st (R4 in ( dom R31 ) & R1 = ( ( len R29 ) + R4 )));

consider R4 being Nat such that L2283: R4 in ( dom R31 ) and L2284: R1 = ( ( len R29 ) + R4 ) by L2282;
L2285:
now
per cases ;
suppose L2286: R4 in ( dom R32 );

thus L2287: ( D318 . R1 ) = ( R32 . R4 ) by L2286 , L2269 , L2284 , FINSEQ_1:def 7;
end;
suppose L2288: (not R4 in ( dom R32 ));

L2289: (R4 < 1 or R4 > ( len R32 )) by L2288 , FINSEQ_3:25;
L2290: R1 > ( ( len R29 ) + ( len R32 ) ) by L2289 , L2283 , L2284 , FINSEQ_3:25 , XREAL_1:8;
L2291: (not R1 in ( dom D318 )) by L2290 , L2270 , FINSEQ_3:25;
thus L2292: ( D318 . R1 ) = ( {} ) by L2291 , FUNCT_1:def 2
.= ( R32 . R4 ) by L2288 , FUNCT_1:def 2;
end;
end;
thus L2294: ( ( D317 (+) D318 ) . R1 ) = ( ( R31 . R4 ) + ( R32 . R4 ) ) by L2285 , L2278 , L2283 , L2284 , FINSEQ_1:def 7
.= ( D316 . R4 ) by L2272 , L2283 , L2218
.= ( ( D315 ^ D316 ) . R1 ) by L2272 , L2266 , L2283 , L2284 , FINSEQ_1:def 7;
end;
end;
thus L2296: ( ( D317 (+) D318 ) . R1 ) = ( ( D315 ^ D316 ) . R1 ) by L2279;
end;
L2297: ( len D316 ) = ( len R31 ) by L2272 , FINSEQ_3:29;
thus L2298: thesis by L2297 , L2266 , L2268 , L2264 , L2271 , L2274 , FINSEQ_1:14;
end;
theorem
L2299: (for R8 being Field holds (for R19 being (Matrix of R8) holds (for R29 being (FinSequence_of_Matrix of R8) holds ( <* R19 *> (+) R29 ) = <* ( R19 + ( R29 . 1 ) ) *>)))
proof
let R8 being Field;
let R19 being (Matrix of R8);
let R29 being (FinSequence_of_Matrix of R8);
L2300: ( dom ( <* R19 *> (+) R29 ) ) = ( dom <* R19 *> ) by L2218;
L2301: ( len ( <* R19 *> (+) R29 ) ) = ( len <* R19 *> ) by L2300 , FINSEQ_3:29
.= 1 by FINSEQ_1:39;
L2302: ( dom ( <* R19 *> (+) R29 ) ) = { 1 } by L2301 , FINSEQ_1:2 , FINSEQ_1:def 3;
L2303: 1 in ( dom ( <* R19 *> (+) R29 ) ) by L2302 , TARSKI:def 1;
L2304: ( ( <* R19 *> (+) R29 ) . 1 ) = ( ( <* R19 *> . 1 ) + ( R29 . 1 ) ) by L2303 , L2218
.= ( R19 + ( R29 . 1 ) ) by FINSEQ_1:40;
thus L2305: thesis by L2304 , L2301 , FINSEQ_1:40;
end;
theorem
L2306: (for R8 being Field holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds ( <* R20 *> (+) <* R21 *> ) = <* ( R20 + R21 ) *>)))
proof
let R8 being Field;
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
thus L2307: ( <* R20 *> (+) <* R21 *> ) = <* ( R20 + ( <* R21 *> . 1 ) ) *> by L2299
.= <* ( R20 + R21 ) *> by FINSEQ_1:40;
end;
theorem
L2308: (for R8 being Field holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds (for R22 being (Matrix of R8) holds (for R23 being (Matrix of R8) holds ( <* R20 , R22 *> (+) <* R21 , R23 *> ) = <* ( R20 + R21 ) , ( R22 + R23 ) *>)))))
proof
let R8 being Field;
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
let R22 being (Matrix of R8);
let R23 being (Matrix of R8);
L2309: ( len <* R21 *> ) = 1 by FINSEQ_1:39;
L2310: ( len <* R20 *> ) = 1 by FINSEQ_1:39;
thus L2311: ( <* R20 , R22 *> (+) <* R21 , R23 *> ) = ( ( <* R20 *> (+) <* R21 *> ) ^ ( <* R22 *> (+) <* R23 *> ) ) by L2310 , L2309 , L2263
.= ( ( <* R20 *> (+) <* R21 *> ) ^ <* ( R22 + R23 ) *> ) by L2306
.= <* ( R20 + R21 ) , ( R22 + R23 ) *> by L2306;
end;
L2312: (for R1 being Nat holds (for R8 being Field holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds ((( width R20 ) = ( width R21 ) & R1 in ( dom R20 )) implies ( Line (( R20 + R21 ) , R1) ) = ( ( Line (R20 , R1) ) + ( Line (R21 , R1) ) ))))))
proof
let R1 being Nat;
let R8 being Field;
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
assume that
L2313: ( width R20 ) = ( width R21 )
and
L2314: R1 in ( dom R20 );
reconsider D319 = ( Line (R20 , R1) ) , D320 = ( Line (R21 , R1) ) as (Element of ( ( width R20 ) -tuples_on (the carrier of R8) )) by L2313;
per cases ;
suppose L2315: ( width R20 ) = ( 0 );

L2316: ( width ( R20 + R21 ) ) = ( 0 ) by L2315 , MATRIX_3:def 3;
L2317: ( Line (( R20 + R21 ) , R1) ) = ( <*> (the carrier of R8) ) by L2316
.= ( D319 + D320 ) by L2315;
thus L2318: thesis by L2317;
end;
suppose L2319: ( width R20 ) > ( 0 );

L2320: ( width R20 ) in ( Seg ( width R20 ) ) by L2319 , FINSEQ_1:3;
L2321: [ R1 , ( width R20 ) ] in ( Indices R20 ) by L2320 , L2314 , ZFMISC_1:87;
thus L2322: thesis by L2321 , L2313 , MATRIX_4:59;
end;
end;
theorem
L2324: (for R8 being Field holds (for R10 being (Element of R8) holds (for R11 being (Element of R8) holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds (for R22 being (Matrix of R8) holds (for R23 being (Matrix of R8) holds ((( len R20 ) = ( len R22 ) & ( len R21 ) = ( len R23 ) & ( width R20 ) = ( width R22 ) & ( width R21 ) = ( width R23 )) implies ( ( block_diagonal (<* R20 , R21 *> , R10) ) + ( block_diagonal (<* R22 , R23 *> , R11) ) ) = ( block_diagonal (( <* R20 , R21 *> (+) <* R22 , R23 *> ) , ( R10 + R11 )) )))))))))
proof
let R8 being Field;
let R10 being (Element of R8);
let R11 being (Element of R8);
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
let R22 being (Matrix of R8);
let R23 being (Matrix of R8);
assume that
L2325: ( len R20 ) = ( len R22 )
and
L2326: ( len R21 ) = ( len R23 )
and
L2327: ( width R20 ) = ( width R22 )
and
L2328: ( width R21 ) = ( width R23 );
set D321 = <* R22 , R23 *>;
set D322 = <* R20 , R21 *>;
set D323 = ( R21 + R23 );
set D324 = ( R20 + R22 );
set D325 = ( D322 (+) D321 );
set D326 = ( block_diagonal (D322 , R10) );
set D327 = ( block_diagonal (D321 , R11) );
set D328 = ( block_diagonal (D325 , ( R10 + R11 )) );
L2329: ( len ( D326 + D327 ) ) = ( len D326 ) by MATRIX_3:def 3;
L2330: ( width ( D326 + D327 ) ) = ( width D326 ) by MATRIX_3:def 3;
reconsider D329 = ( D326 + D327 ) as (Matrix of ( len D326 ) , ( width D326 ) , R8) by L2330 , L2329 , MATRIX_2:7;
L2331: ( len D324 ) = ( len R20 ) by MATRIX_3:def 3;
L2332: ( len D326 ) = ( Sum ( Len D322 ) ) by L537;
L2333: ( Sum ( Len D322 ) ) = ( ( len R20 ) + ( len R21 ) ) by L475;
L2334: ( len D323 ) = ( len R21 ) by MATRIX_3:def 3;
L2335: ( Sum ( Width D321 ) ) = ( ( width R22 ) + ( width R23 ) ) by L523;
L2336: ( len D328 ) = ( Sum ( Len D325 ) ) by L537;
L2337: ( width D327 ) = ( Sum ( Width D321 ) ) by L537;
L2338: ( width D326 ) = ( Sum ( Width D322 ) ) by L537;
L2339: ( width D323 ) = ( width R21 ) by MATRIX_3:def 3;
L2340: ( width D324 ) = ( width R20 ) by MATRIX_3:def 3;
L2341: ( Len D325 ) = ( Len D322 ) by L2249;
L2342: D325 = <* D324 , D323 *> by L2308;
L2343:
now
L2344: ( dom D326 ) = ( Seg ( len D326 ) ) by FINSEQ_1:def 3;
let R1 being Nat;
assume that
L2345: 1 <= R1
and
L2346: R1 <= ( len D328 );
L2347: R1 in ( Seg ( len D328 ) ) by L2345 , L2346 , FINSEQ_1:1;
L2348: ( D328 . R1 ) = ( Line (( block_diagonal (<* D324 , D323 *> , ( R10 + R11 )) ) , R1) ) by L2347 , L2342 , L2336 , MATRIX_2:8;
L2349: ( D329 . R1 ) = ( Line (( D326 + D327 ) , R1) ) by L2341 , L2332 , L2336 , L2347 , MATRIX_2:8;
L2350: ( dom ( R20 ^ R21 ) ) = ( Seg ( len D328 ) ) by L2333 , L2341 , L2336 , FINSEQ_1:def 7;
L2351:
now
per cases  by L2347 , L2350 , FINSEQ_1:25;
suppose L2352: R1 in ( dom R20 );

L2353: ( len ( Line (R22 , R1) ) ) = ( width R22 ) by CARD_1:def 7;
L2354: ( dom R20 ) = ( dom R22 ) by L2325 , FINSEQ_3:29;
L2355: ( len ( Line (R20 , R1) ) ) = ( width R20 ) by CARD_1:def 7;
L2356: ( dom R20 ) = ( dom D324 ) by L2331 , FINSEQ_3:29;
thus L2357: ( D328 . R1 ) = ( ( Line (D324 , R1) ) ^ ( ( width D323 ) |-> ( R10 + R11 ) ) ) by L2356 , L2348 , L2352 , L576
.= ( ( ( Line (R20 , R1) ) + ( Line (R22 , R1) ) ) ^ ( ( width D323 ) |-> ( R10 + R11 ) ) ) by L2327 , L2352 , L2312
.= ( ( ( Line (R20 , R1) ) + ( Line (R22 , R1) ) ) ^ ( ( ( width D323 ) |-> R10 ) + ( ( width D323 ) |-> R11 ) ) ) by FVSUM_1:20
.= ( ( ( Line (R20 , R1) ) ^ ( ( width R21 ) |-> R10 ) ) + ( ( Line (R22 , R1) ) ^ ( ( width R23 ) |-> R11 ) ) ) by L2327 , L2328 , L2339 , L2355 , L2353 , L7
.= ( ( Line (D326 , R1) ) + ( ( Line (R22 , R1) ) ^ ( ( width R23 ) |-> R11 ) ) ) by L2352 , L576
.= ( ( Line (D326 , R1) ) + ( Line (D327 , R1) ) ) by L2352 , L2354 , L576
.= ( D329 . R1 ) by L2327 , L2328 , L2335 , L2341 , L2332 , L2338 , L2337 , L2336 , L2347 , L2344 , L2349 , L2312 , L523;
end;
suppose L2358: (ex R4 being Nat st (R4 in ( dom R21 ) & R1 = ( ( len R20 ) + R4 )));

L2359: ( len ( ( width D324 ) |-> R10 ) ) = ( width D324 ) by CARD_1:def 7;
L2360: ( dom R21 ) = ( dom R23 ) by L2326 , FINSEQ_3:29;
L2361: ( len ( ( width D324 ) |-> R11 ) ) = ( width D324 ) by CARD_1:def 7;
consider R4 being Nat such that L2362: R4 in ( dom R21 ) and L2363: R1 = ( ( len R20 ) + R4 ) by L2358;
L2364: ( dom R21 ) = ( dom D323 ) by L2334 , FINSEQ_3:29;
thus L2365: ( D328 . R1 ) = ( ( ( width D324 ) |-> ( R10 + R11 ) ) ^ ( Line (D323 , R4) ) ) by L2364 , L2331 , L2348 , L2362 , L2363 , L576
.= ( ( ( width D324 ) |-> ( R10 + R11 ) ) ^ ( ( Line (R21 , R4) ) + ( Line (R23 , R4) ) ) ) by L2328 , L2362 , L2312
.= ( ( ( ( width D324 ) |-> R10 ) + ( ( width D324 ) |-> R11 ) ) ^ ( ( Line (R21 , R4) ) + ( Line (R23 , R4) ) ) ) by FVSUM_1:20
.= ( ( ( ( width D324 ) |-> R10 ) ^ ( Line (R21 , R4) ) ) + ( ( ( width D324 ) |-> R11 ) ^ ( Line (R23 , R4) ) ) ) by L2359 , L2361 , L7
.= ( ( Line (D326 , R1) ) + ( ( ( width R22 ) |-> R11 ) ^ ( Line (R23 , R4) ) ) ) by L2327 , L2340 , L2362 , L2363 , L576
.= ( ( Line (D326 , R1) ) + ( Line (D327 , R1) ) ) by L2325 , L2362 , L2363 , L2360 , L576
.= ( D329 . R1 ) by L2327 , L2328 , L2335 , L2341 , L2332 , L2338 , L2337 , L2336 , L2347 , L2344 , L2349 , L2312 , L523;
end;
end;
thus L2367: ( D328 . R1 ) = ( ( D326 + D327 ) . R1 ) by L2351;
end;
thus L2368: thesis by L2343 , L2341 , L2332 , L2336 , L2329 , FINSEQ_1:14;
end;
theorem
L2369: (for R8 being Field holds (for R10 being (Element of R8) holds (for R11 being (Element of R8) holds (for R37 being (FinSequence_of_Square-Matrix of R8) holds (for R38 being (FinSequence_of_Square-Matrix of R8) holds ((( Len R37 ) = ( Len R38 ) & ( Width R37 ) = ( Width R38 )) implies ( ( block_diagonal (R37 , R10) ) + ( block_diagonal (R38 , R11) ) ) = ( block_diagonal (( R37 (+) R38 ) , ( R10 + R11 )) )))))))
proof
let R8 being Field;
let R10 being (Element of R8);
let R11 being (Element of R8);
let R37 being (FinSequence_of_Square-Matrix of R8);
let R38 being (FinSequence_of_Square-Matrix of R8);
defpred S10[ Nat ] means (for R37 being (FinSequence_of_Square-Matrix of R8) holds (for R38 being (FinSequence_of_Square-Matrix of R8) holds (for R10 being (Element of R8) holds (for R11 being (Element of R8) holds ((( Len R37 ) = ( Len R38 ) & ( Width R37 ) = ( Width R38 ) & ( len R37 ) = $1) implies ( ( block_diagonal (R37 , R10) ) + ( block_diagonal (R38 , R11) ) ) = ( block_diagonal (( R37 (+) R38 ) , ( R10 + R11 )) ))))));
assume that
L2370: ( Len R37 ) = ( Len R38 )
and
L2371: ( Width R37 ) = ( Width R38 );
L2372: (for R4 being Nat holds (S10[ R4 ] implies S10[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume that
L2373: S10[ R4 ];
set D330 = ( R4 + 1 );
let R37 being (FinSequence_of_Square-Matrix of R8);
let R38 being (FinSequence_of_Square-Matrix of R8);
let R10 being (Element of R8);
let R11 being (Element of R8);
assume that
L2374: ( Len R37 ) = ( Len R38 )
and
L2375: ( Width R37 ) = ( Width R38 )
and
L2376: ( len R37 ) = D330;
L2377: D330 in ( Seg D330 ) by FINSEQ_1:4;
set D331 = ( R38 | R4 );
L2378: R37 = ( ( R37 | R4 ) ^ <* ( R37 . D330 ) *> ) by L2376 , FINSEQ_3:55;
set D332 = ( R37 | R4 );
set D333 = ( block_diagonal (D331 , R11) );
set D334 = ( block_diagonal (D332 , R10) );
L2379: ( len D332 ) = R4 by L2376 , FINSEQ_1:59 , NAT_1:11;
L2380: ( dom ( Len R37 ) ) = ( Seg D330 ) by L2376 , FINSEQ_2:124;
L2381: ( len ( R37 . D330 ) ) = ( ( Len R37 ) . D330 ) by L2380 , L2377 , L387
.= ( len ( R38 . D330 ) ) by L2374 , L2377 , L2380 , L387;
L2382: ( len R37 ) = ( len ( Len R38 ) ) by L2374 , CARD_1:def 7
.= ( len R38 ) by CARD_1:def 7;
L2383: ( len D331 ) = R4 by L2382 , L2376 , FINSEQ_1:59 , NAT_1:11;
L2384: ( dom ( Width R37 ) ) = ( Seg D330 ) by L2376 , FINSEQ_2:124;
L2385: ( width ( R37 . D330 ) ) = ( ( Width R37 ) . D330 ) by L2384 , L2377 , L399
.= ( width ( R38 . D330 ) ) by L2375 , L2377 , L2384 , L399;
L2386: ( Len D332 ) = ( ( Len R37 ) | R4 ) by L477
.= ( Len D331 ) by L2374 , L477;
L2387: ( len D334 ) = ( Sum ( Len D331 ) ) by L2386 , L537
.= ( len D333 ) by L537;
L2388: ( Width D332 ) = ( ( Width R37 ) | R4 ) by L525
.= ( Width D331 ) by L2375 , L525;
L2389: ( width D334 ) = ( Sum ( Width D331 ) ) by L2388 , L537
.= ( width D333 ) by L537;
L2390: R38 = ( ( R38 | R4 ) ^ <* ( R38 . D330 ) *> ) by L2376 , L2382 , FINSEQ_3:55;
thus L2391: ( ( block_diagonal (R37 , R10) ) + ( block_diagonal (R38 , R11) ) ) = ( ( block_diagonal (<* D334 , ( R37 . D330 ) *> , R10) ) + ( block_diagonal (( D331 ^ <* ( R38 . D330 ) *> ) , R11) ) ) by L2390 , L2378 , L1078
.= ( ( block_diagonal (<* D334 , ( R37 . D330 ) *> , R10) ) + ( block_diagonal (<* D333 , ( R38 . D330 ) *> , R11) ) ) by L1078
.= ( block_diagonal (( <* D334 , ( R37 . D330 ) *> (+) <* D333 , ( R38 . D330 ) *> ) , ( R10 + R11 )) ) by L2387 , L2389 , L2381 , L2385 , L2324
.= ( block_diagonal (<* ( D334 + D333 ) , ( ( R37 . D330 ) + ( R38 . D330 ) ) *> , ( R10 + R11 )) ) by L2308
.= ( block_diagonal (<* ( block_diagonal (( D332 (+) D331 ) , ( R10 + R11 )) ) , ( ( R37 . D330 ) + ( R38 . D330 ) ) *> , ( R10 + R11 )) ) by L2373 , L2379 , L2386 , L2388
.= ( block_diagonal (( ( D332 (+) D331 ) ^ <* ( ( R37 . D330 ) + ( R38 . D330 ) ) *> ) , ( R10 + R11 )) ) by L1078
.= ( block_diagonal (( ( D332 (+) D331 ) ^ ( <* ( R37 . D330 ) *> (+) <* ( R38 . D330 ) *> ) ) , ( R10 + R11 )) ) by L2306
.= ( block_diagonal (( R37 (+) R38 ) , ( R10 + R11 )) ) by L2379 , L2383 , L2378 , L2390 , L2263;
end;
L2392: S10[ ( 0 ) ]
proof
let R37 being (FinSequence_of_Square-Matrix of R8);
let R38 being (FinSequence_of_Square-Matrix of R8);
let R10 being (Element of R8);
let R11 being (Element of R8);
assume that
L2393: ( Len R37 ) = ( Len R38 )
and
L2394: ( Width R37 ) = ( Width R38 )
and
L2395: ( len R37 ) = ( 0 );
set D335 = ( block_diagonal (( R37 (+) R38 ) , ( R10 + R11 )) );
set D336 = ( block_diagonal (R38 , R11) );
set D337 = ( block_diagonal (R37 , R10) );
L2396: ( Len R37 ) = ( {} ) by L2395;
L2397: ( Len R37 ) = ( Len ( R37 (+) R38 ) ) by L2249;
L2398: ( len D335 ) = ( 0 ) by L2397 , L2396 , L537 , RVSUM_1:72;
L2399: D335 = ( {} ) by L2398;
L2400: ( len D337 ) = ( 0 ) by L2396 , L537 , RVSUM_1:72;
L2401: ( len ( D337 + D336 ) ) = ( 0 ) by L2400 , MATRIX_3:def 3;
thus L2402: thesis by L2401 , L2399;
end;
L2403: (for R4 being Nat holds S10[ R4 ]) from NAT_1:sch 2(L2392 , L2372);
thus L2404: thesis by L2403 , L2370 , L2371;
end;
definition
let R8 being Field;
let C65 , C66 being (FinSequence_of_Matrix of R8);
func C65 (#) C66 -> (FinSequence_of_Matrix of R8) means 
:L2405: (( dom it ) = ( dom C65 ) & (for R1 being Nat holds (R1 in ( dom it ) implies ( it . R1 ) = ( ( C65 . R1 ) * ( C66 . R1 ) ))));
existence
proof
deffunc H7(Nat) = ( ( C65 . $1 ) * ( C66 . $1 ) );
consider C67 being FinSequence such that L2406: ( len C67 ) = ( len C65 ) and L2407: (for R5 being Nat holds (R5 in ( dom C67 ) implies ( C67 . R5 ) = H7(R5))) from FINSEQ_1:sch 2;
L2408: ( rng C67 ) c= ( ( (the carrier of R8) * ) * )
proof
let R7 being set;
assume L2409: R7 in ( rng C67 );
consider R6 being set such that L2410: R6 in ( dom C67 ) and L2411: ( C67 . R6 ) = R7 by L2409 , FUNCT_1:def 3;
reconsider D338 = R6 as Nat by L2410;
L2412: ( C67 . D338 ) = ( ( C65 . D338 ) * ( C66 . D338 ) ) by L2407 , L2410;
thus L2413: thesis by L2412 , L2411 , FINSEQ_1:def 11;
end;
reconsider D339 = C67 as (FinSequence of ( ( (the carrier of R8) * ) * )) by L2408 , FINSEQ_1:def 4;
L2414:
now
let R1 being Nat;
assume L2415: R1 in ( dom D339 );
L2416: ( D339 . R1 ) = ( ( C65 . R1 ) * ( C66 . R1 ) ) by L2415 , L2407;
thus L2417: ( D339 . R1 ) is (Matrix of R8) by L2416;
end;
reconsider D340 = D339 as (FinSequence_of_Matrix of R8) by L2414 , L334;
take D340;
thus L2418: thesis by L2406 , L2407 , FINSEQ_3:29;
end;
uniqueness
proof
let C68 , C69 being (FinSequence_of_Matrix of R8);
assume that
L2419: ( dom C68 ) = ( dom C65 )
and
L2420: (for R1 being Nat holds (R1 in ( dom C68 ) implies ( C68 . R1 ) = ( ( C65 . R1 ) * ( C66 . R1 ) )))
and
L2421: ( dom C69 ) = ( dom C65 )
and
L2422: (for R1 being Nat holds (R1 in ( dom C69 ) implies ( C69 . R1 ) = ( ( C65 . R1 ) * ( C66 . R1 ) )));
L2423:
now
let R1 being Nat;
assume that
L2424: R1 in ( dom C65 );
thus L2425: ( C68 . R1 ) = ( ( C65 . R1 ) * ( C66 . R1 ) ) by L2419 , L2420 , L2424
.= ( C69 . R1 ) by L2421 , L2422 , L2424;
end;
thus L2426: thesis by L2423 , L2419 , L2421 , FINSEQ_1:13;
end;
end;
theorem
L2428: (for R8 being Field holds (for R31 being (FinSequence_of_Matrix of R8) holds (for R32 being (FinSequence_of_Matrix of R8) holds (( Width R31 ) = ( Len R32 ) implies (( Len ( R31 (#) R32 ) ) = ( Len R31 ) & ( Width ( R31 (#) R32 ) ) = ( Width R32 ))))))
proof
let R8 being Field;
let R31 being (FinSequence_of_Matrix of R8);
let R32 being (FinSequence_of_Matrix of R8);
assume L2429: ( Width R31 ) = ( Len R32 );
set D341 = ( R31 (#) R32 );
L2430: ( dom ( Len D341 ) ) = ( dom D341 ) by L387;
L2431: ( dom D341 ) = ( dom R31 ) by L2405;
L2432: ( dom ( Width R32 ) ) = ( dom R32 ) by L399;
L2433: ( dom ( Width R31 ) ) = ( dom R31 ) by L399;
L2434: ( dom ( Len R31 ) ) = ( dom R31 ) by L387;
L2435:
now
let R1 being Nat;
assume that
L2436: R1 in ( dom ( Len D341 ) );
L2437: ( width ( R31 . R1 ) ) = ( ( Width R31 ) . R1 ) by L2430 , L2433 , L2431 , L2436 , L399
.= ( len ( R32 . R1 ) ) by L2429 , L2430 , L2433 , L2431 , L2436 , L387;
thus L2438: ( ( Len D341 ) . R1 ) = ( len ( D341 . R1 ) ) by L2436 , L387
.= ( len ( ( R31 . R1 ) * ( R32 . R1 ) ) ) by L2430 , L2436 , L2405
.= ( len ( R31 . R1 ) ) by L2437 , MATRIX_3:def 4
.= ( ( Len R31 ) . R1 ) by L2434 , L2430 , L2431 , L2436 , L387;
end;
thus L2439: ( Len D341 ) = ( Len R31 ) by L2435 , L2434 , L2430 , L2431 , FINSEQ_1:13;
L2440: ( dom ( Width D341 ) ) = ( dom D341 ) by L399;
L2441: ( dom ( Len R32 ) ) = ( dom R32 ) by L387;
L2442:
now
let R1 being Nat;
assume that
L2443: R1 in ( dom ( Width D341 ) );
L2444: ( width ( R31 . R1 ) ) = ( ( Width R31 ) . R1 ) by L2433 , L2440 , L2431 , L2443 , L399
.= ( len ( R32 . R1 ) ) by L2429 , L2433 , L2440 , L2431 , L2443 , L387;
thus L2445: ( ( Width D341 ) . R1 ) = ( width ( D341 . R1 ) ) by L2443 , L399
.= ( width ( ( R31 . R1 ) * ( R32 . R1 ) ) ) by L2440 , L2443 , L2405
.= ( width ( R32 . R1 ) ) by L2444 , MATRIX_3:def 4
.= ( ( Width R32 ) . R1 ) by L2429 , L2433 , L2441 , L2440 , L2432 , L2431 , L2443 , L399;
end;
thus L2446: thesis by L2442 , L2429 , L2433 , L2441 , L2440 , L2432 , L2431 , FINSEQ_1:13;
end;
theorem
L2447: (for R8 being Field holds (for R29 being (FinSequence_of_Matrix of R8) holds (for R30 being (FinSequence_of_Matrix of R8) holds (for R31 being (FinSequence_of_Matrix of R8) holds (for R32 being (FinSequence_of_Matrix of R8) holds (( len R29 ) = ( len R30 ) implies ( ( R29 ^ R31 ) (#) ( R30 ^ R32 ) ) = ( ( R29 (#) R30 ) ^ ( R31 (#) R32 ) )))))))
proof
let R8 being Field;
let R29 being (FinSequence_of_Matrix of R8);
let R30 being (FinSequence_of_Matrix of R8);
let R31 being (FinSequence_of_Matrix of R8);
let R32 being (FinSequence_of_Matrix of R8);
set D342 = ( R29 (#) R30 );
set D343 = ( R31 (#) R32 );
set D344 = ( R29 ^ R31 );
set D345 = ( R30 ^ R32 );
L2448: ( len D344 ) = ( ( len R29 ) + ( len R31 ) ) by FINSEQ_1:22;
L2449: ( dom D342 ) = ( dom R29 ) by L2405;
L2450: ( len D342 ) = ( len R29 ) by L2449 , FINSEQ_3:29;
L2451: ( dom ( D344 (#) D345 ) ) = ( dom D344 ) by L2405;
L2452: ( len ( D344 (#) D345 ) ) = ( len D344 ) by L2451 , FINSEQ_3:29;
assume L2453: ( len R29 ) = ( len R30 );
L2454: ( len D345 ) = ( ( len R29 ) + ( len R32 ) ) by L2453 , FINSEQ_1:22;
L2455: ( len ( D342 ^ D343 ) ) = ( ( len D342 ) + ( len D343 ) ) by FINSEQ_1:22;
L2456: ( dom D343 ) = ( dom R31 ) by L2405;
L2457: ( dom R29 ) = ( dom R30 ) by L2453 , FINSEQ_3:29;
L2458:
now
let R1 being Nat;
assume that
L2459: 1 <= R1
and
L2460: R1 <= ( ( len R29 ) + ( len R31 ) );
L2461: R1 in ( dom ( D344 (#) D345 ) ) by L2451 , L2448 , L2459 , L2460 , FINSEQ_3:25;
L2462: ( ( D344 (#) D345 ) . R1 ) = ( ( D344 . R1 ) * ( D345 . R1 ) ) by L2461 , L2405;
L2463:
now
per cases  by L2451 , L2461 , FINSEQ_1:25;
suppose L2464: R1 in ( dom R29 );

thus L2465: ( ( D344 (#) D345 ) . R1 ) = ( ( R29 . R1 ) * ( D345 . R1 ) ) by L2464 , L2462 , FINSEQ_1:def 7
.= ( ( R29 . R1 ) * ( R30 . R1 ) ) by L2457 , L2464 , FINSEQ_1:def 7
.= ( D342 . R1 ) by L2449 , L2464 , L2405
.= ( ( D342 ^ D343 ) . R1 ) by L2449 , L2464 , FINSEQ_1:def 7;
end;
suppose L2466: (ex R4 being Nat st (R4 in ( dom R31 ) & R1 = ( ( len R29 ) + R4 )));

consider R4 being Nat such that L2467: R4 in ( dom R31 ) and L2468: R1 = ( ( len R29 ) + R4 ) by L2466;
L2469:
now
per cases ;
suppose L2470: R4 in ( dom R32 );

thus L2471: ( D345 . R1 ) = ( R32 . R4 ) by L2470 , L2453 , L2468 , FINSEQ_1:def 7;
end;
suppose L2472: (not R4 in ( dom R32 ));

L2473: (R4 < 1 or R4 > ( len R32 )) by L2472 , FINSEQ_3:25;
L2474: R1 > ( ( len R29 ) + ( len R32 ) ) by L2473 , L2467 , L2468 , FINSEQ_3:25 , XREAL_1:8;
L2475: (not R1 in ( dom D345 )) by L2474 , L2454 , FINSEQ_3:25;
thus L2476: ( D345 . R1 ) = ( {} ) by L2475 , FUNCT_1:def 2
.= ( R32 . R4 ) by L2472 , FUNCT_1:def 2;
end;
end;
thus L2478: ( ( D344 (#) D345 ) . R1 ) = ( ( R31 . R4 ) * ( R32 . R4 ) ) by L2469 , L2462 , L2467 , L2468 , FINSEQ_1:def 7
.= ( D343 . R4 ) by L2456 , L2467 , L2405
.= ( ( D342 ^ D343 ) . R1 ) by L2456 , L2450 , L2467 , L2468 , FINSEQ_1:def 7;
end;
end;
thus L2480: ( ( D344 (#) D345 ) . R1 ) = ( ( D342 ^ D343 ) . R1 ) by L2463;
end;
L2481: ( len D343 ) = ( len R31 ) by L2456 , FINSEQ_3:29;
thus L2482: thesis by L2481 , L2450 , L2452 , L2448 , L2455 , L2458 , FINSEQ_1:14;
end;
theorem
L2483: (for R8 being Field holds (for R19 being (Matrix of R8) holds (for R29 being (FinSequence_of_Matrix of R8) holds ( <* R19 *> (#) R29 ) = <* ( R19 * ( R29 . 1 ) ) *>)))
proof
let R8 being Field;
let R19 being (Matrix of R8);
let R29 being (FinSequence_of_Matrix of R8);
L2484: ( dom ( <* R19 *> (#) R29 ) ) = ( dom <* R19 *> ) by L2405;
L2485: ( len ( <* R19 *> (#) R29 ) ) = ( len <* R19 *> ) by L2484 , FINSEQ_3:29
.= 1 by FINSEQ_1:39;
L2486: ( dom ( <* R19 *> (#) R29 ) ) = { 1 } by L2485 , FINSEQ_1:2 , FINSEQ_1:def 3;
L2487: 1 in ( dom ( <* R19 *> (#) R29 ) ) by L2486 , TARSKI:def 1;
L2488: ( ( <* R19 *> (#) R29 ) . 1 ) = ( ( <* R19 *> . 1 ) * ( R29 . 1 ) ) by L2487 , L2405
.= ( R19 * ( R29 . 1 ) ) by FINSEQ_1:40;
thus L2489: thesis by L2488 , L2485 , FINSEQ_1:40;
end;
theorem
L2490: (for R8 being Field holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds ( <* R20 *> (#) <* R21 *> ) = <* ( R20 * R21 ) *>)))
proof
let R8 being Field;
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
thus L2491: ( <* R20 *> (#) <* R21 *> ) = <* ( R20 * ( <* R21 *> . 1 ) ) *> by L2483
.= <* ( R20 * R21 ) *> by FINSEQ_1:40;
end;
theorem
L2492: (for R8 being Field holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds (for R22 being (Matrix of R8) holds (for R23 being (Matrix of R8) holds ( <* R20 , R22 *> (#) <* R21 , R23 *> ) = <* ( R20 * R21 ) , ( R22 * R23 ) *>)))))
proof
let R8 being Field;
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
let R22 being (Matrix of R8);
let R23 being (Matrix of R8);
L2493: ( len <* R21 *> ) = 1 by FINSEQ_1:39;
L2494: ( len <* R20 *> ) = 1 by FINSEQ_1:39;
thus L2495: ( <* R20 , R22 *> (#) <* R21 , R23 *> ) = ( ( <* R20 *> (#) <* R21 *> ) ^ ( <* R22 *> (#) <* R23 *> ) ) by L2494 , L2493 , L2447
.= ( ( <* R20 *> (#) <* R21 *> ) ^ <* ( R22 * R23 ) *> ) by L2490
.= <* ( R20 * R21 ) , ( R22 * R23 ) *> by L2490;
end;
L2496: (for R1 being Nat holds (for R2 being Nat holds (for R8 being Field holds (for B28 , B29 being (Element of ( R1 -tuples_on (the carrier of R8) )) holds (for B30 , B31 being (Element of ( R2 -tuples_on (the carrier of R8) )) holds ( Sum ( mlt (( B28 ^ B30 ) , ( B29 ^ B31 )) ) ) = ( ( Sum ( mlt (B28 , B29) ) ) + ( Sum ( mlt (B30 , B31) ) ) ))))))
proof
let R1 being Nat;
let R2 being Nat;
let R8 being Field;
let C70 , C71 being (Element of ( R1 -tuples_on (the carrier of R8) ));
let C72 , C73 being (Element of ( R2 -tuples_on (the carrier of R8) ));
L2497: ( mlt (( C70 ^ C72 ) , ( C71 ^ C73 )) ) = ( ( mlt (C70 , C71) ) ^ ( mlt (C72 , C73) ) ) by FINSEQOP:11;
thus L2498: thesis by L2497 , RLVECT_1:41;
end;
theorem
L2499: (for R8 being Field holds (for R20 being (Matrix of R8) holds (for R21 being (Matrix of R8) holds (for R22 being (Matrix of R8) holds (for R23 being (Matrix of R8) holds ((( width R20 ) = ( len R22 ) & ( width R21 ) = ( len R23 )) implies ( ( block_diagonal (<* R20 , R21 *> , ( 0. R8 )) ) * ( block_diagonal (<* R22 , R23 *> , ( 0. R8 )) ) ) = ( block_diagonal (( <* R20 , R21 *> (#) <* R22 , R23 *> ) , ( 0. R8 )) )))))))
proof
let R8 being Field;
let R20 being (Matrix of R8);
let R21 being (Matrix of R8);
let R22 being (Matrix of R8);
let R23 being (Matrix of R8);
assume that
L2500: ( width R20 ) = ( len R22 )
and
L2501: ( width R21 ) = ( len R23 );
L2502: ( width ( R20 * R22 ) ) = ( width R22 ) by L2500 , MATRIX_3:def 4;
set D346 = <* R22 , R23 *>;
set D347 = <* R20 , R21 *>;
set D348 = <* R23 *>;
set D349 = <* R22 *>;
set D350 = <* R21 *>;
set D351 = <* R20 *>;
set D352 = ( D347 (#) D346 );
L2503: ( Len D346 ) = ( ( Len D349 ) ^ ( Len D348 ) ) by L441;
set D353 = ( block_diagonal (D346 , ( 0. R8 )) );
set D354 = ( block_diagonal (D347 , ( 0. R8 )) );
L2504: ( Sum ( Width D347 ) ) = ( width D354 ) by L537;
L2505: ( Sum ( Len D346 ) ) = ( len D353 ) by L537;
L2506: ( Width D351 ) = <* ( width R20 ) *> by L512;
set D355 = ( D354 * D353 );
set D356 = ( block_diagonal (D352 , ( 0. R8 )) );
L2507: ( Sum ( Len D352 ) ) = ( len D356 ) by L537;
L2508: ( Sum ( Width D352 ) ) = ( width D356 ) by L537;
L2509: ( Sum ( Len D347 ) ) = ( ( len R20 ) + ( len R21 ) ) by L475;
L2510: ( Sum ( Width D346 ) ) = ( ( width R22 ) + ( width R23 ) ) by L523;
L2511: ( len ( R21 * R23 ) ) = ( len R21 ) by L2501 , MATRIX_3:def 4;
L2512: D352 = <* ( R20 * R22 ) , ( R21 * R23 ) *> by L2492;
L2513: ( Width D350 ) = <* ( width R21 ) *> by L512;
L2514: ( Len D348 ) = <* ( len R23 ) *> by L464;
L2515: ( Len D349 ) = <* ( len R22 ) *> by L464;
L2516: ( Width D347 ) = ( ( Width D351 ) ^ ( Width D350 ) ) by L489;
L2517: ( Len D352 ) = ( Len D347 ) by L2516 , L2500 , L2501 , L2503 , L2506 , L2513 , L2515 , L2514 , L2428;
L2518: ( Width D352 ) = ( Width D346 ) by L2500 , L2501 , L2516 , L2503 , L2506 , L2513 , L2515 , L2514 , L2428;
L2519: ( Sum ( Len D347 ) ) = ( len D354 ) by L537;
L2520: ( len ( D354 * D353 ) ) = ( Sum ( Len D347 ) ) by L2519 , L2500 , L2501 , L2516 , L2503 , L2506 , L2513 , L2515 , L2514 , L2504 , L2505 , MATRIX_3:def 4;
L2521: ( len ( R20 * R22 ) ) = ( len R20 ) by L2500 , MATRIX_3:def 4;
L2522: ( Sum ( Width D346 ) ) = ( width D353 ) by L537;
L2523: ( width ( D354 * D353 ) ) = ( Sum ( Width D346 ) ) by L2522 , L2500 , L2501 , L2516 , L2503 , L2506 , L2513 , L2515 , L2514 , L2504 , L2505 , MATRIX_3:def 4;
L2524: ( width ( R21 * R23 ) ) = ( width R23 ) by L2501 , MATRIX_3:def 4;
L2525: ( Indices ( R20 * R22 ) ) = [: ( Seg ( len ( R20 * R22 ) ) ) , ( Seg ( width ( R20 * R22 ) ) ) :] by FINSEQ_1:def 3
.= [: ( dom R20 ) , ( Seg ( width R22 ) ) :] by L2502 , L2521 , FINSEQ_1:def 3;
L2526:
now
L2527: ( dom D356 ) = ( Seg ( len D356 ) ) by FINSEQ_1:def 3;
let R1 being Nat;
let R2 being Nat;
assume that
L2528: [ R1 , R2 ] in ( Indices D356 );
L2529: R2 in ( Seg ( width D356 ) ) by L2528 , ZFMISC_1:87;
L2530: R1 in ( dom D356 ) by L2528 , ZFMISC_1:87;
L2531: 1 <= R1 by L2530 , L2527 , FINSEQ_1:1;
L2532: ( Indices D356 ) = [: ( Seg ( len D356 ) ) , ( Seg ( width D356 ) ) :] by FINSEQ_1:def 3
.= ( Indices D355 ) by L2507 , L2508 , L2520 , L2523 , L2517 , L2518 , FINSEQ_1:def 3;
L2533: ( D355 * (R1 , R2) ) = ( ( Line (D354 , R1) ) "*" ( Col (D353 , R2) ) ) by L2532 , L2500 , L2501 , L2516 , L2503 , L2506 , L2513 , L2515 , L2514 , L2504 , L2505 , L2528 , MATRIX_3:def 4
.= ( Sum ( mlt (( Line (D354 , R1) ) , ( Col (D353 , R2) )) ) );
L2534: 1 <= R2 by L2529 , FINSEQ_1:1;
L2535:
now
per cases ;
suppose L2536: R1 <= ( len R20 );

L2537: R1 in ( dom ( R20 * R22 ) ) by L2536 , L2521 , L2531 , FINSEQ_3:25;
L2538: R1 in ( dom R20 ) by L2531 , L2536 , FINSEQ_3:25;
L2539: ( Line (D354 , R1) ) = ( ( Line (R20 , R1) ) ^ ( ( width R21 ) |-> ( 0. R8 ) ) ) by L2538 , L576;
L2540:
now
per cases ;
suppose L2541: R2 <= ( width R22 );

L2542: R2 in ( Seg ( width R22 ) ) by L2541 , L2534 , FINSEQ_1:1;
L2543: [ R1 , R2 ] in ( Indices ( R20 * R22 ) ) by L2542 , L2525 , L2538 , ZFMISC_1:87;
L2544: ( dom ( Line (( R20 * R22 ) , R1) ) ) = ( Seg ( width R22 ) ) by L2502 , FINSEQ_2:124;
L2545: ( Col (D353 , R2) ) = ( ( Col (R22 , R2) ) ^ ( ( len R23 ) |-> ( 0. R8 ) ) ) by L2542 , L707;
thus L2546: ( D355 * (R1 , R2) ) = ( ( Sum ( mlt (( Line (R20 , R1) ) , ( Col (R22 , R2) )) ) ) + ( Sum ( mlt (( ( width R21 ) |-> ( 0. R8 ) ) , ( ( len R23 ) |-> ( 0. R8 ) )) ) ) ) by L2545 , L2500 , L2501 , L2533 , L2539 , L2496
.= ( ( Sum ( mlt (( Line (R20 , R1) ) , ( Col (R22 , R2) )) ) ) + ( Sum ( ( 0. R8 ) * ( ( width R21 ) |-> ( 0. R8 ) ) ) ) ) by L2501 , FVSUM_1:66
.= ( ( Sum ( mlt (( Line (R20 , R1) ) , ( Col (R22 , R2) )) ) ) + ( ( 0. R8 ) * ( Sum ( ( width R21 ) |-> ( 0. R8 ) ) ) ) ) by FVSUM_1:73
.= ( ( Sum ( mlt (( Line (R20 , R1) ) , ( Col (R22 , R2) )) ) ) + ( 0. R8 ) ) by VECTSP_1:6
.= ( ( Line (R20 , R1) ) "*" ( Col (R22 , R2) ) ) by RLVECT_1:def 4
.= ( ( R20 * R22 ) * (R1 , R2) ) by L2500 , L2543 , MATRIX_3:def 4
.= ( ( Line (( R20 * R22 ) , R1) ) . R2 ) by L2502 , L2542 , MATRIX_1:def 7
.= ( ( ( Line (( R20 * R22 ) , R1) ) ^ ( ( width ( R21 * R23 ) ) |-> ( 0. R8 ) ) ) . R2 ) by L2542 , L2544 , FINSEQ_1:def 7
.= ( ( Line (D356 , R1) ) . R2 ) by L2512 , L2537 , L576
.= ( D356 * (R1 , R2) ) by L2529 , MATRIX_1:def 7;
end;
suppose L2547: R2 > ( width R22 );

reconsider D357 = ( R2 - ( width R22 ) ) as (Element of ( NAT )) by L2547 , NAT_1:21;
L2548: R2 = ( D357 + ( width R22 ) );
L2549: ( len ( Line (( R20 * R22 ) , R1) ) ) = ( width R22 ) by L2502 , CARD_1:def 7;
L2550: ( dom ( ( width ( R21 * R23 ) ) |-> ( 0. R8 ) ) ) = ( Seg ( width R23 ) ) by L2524 , FINSEQ_2:124;
L2551: D357 <> ( 0 ) by L2547;
L2552: D357 in ( Seg ( width R23 ) ) by L2551 , L2508 , L2518 , L2510 , L2529 , L2548 , FINSEQ_1:61;
L2553: ( Col (D353 , ( D357 + ( width R22 ) )) ) = ( ( ( len R22 ) |-> ( 0. R8 ) ) ^ ( Col (R23 , D357) ) ) by L2552 , L707;
thus L2554: ( D355 * (R1 , R2) ) = ( ( Sum ( mlt (( Line (R20 , R1) ) , ( ( len R22 ) |-> ( 0. R8 ) )) ) ) + ( Sum ( mlt (( ( width R21 ) |-> ( 0. R8 ) ) , ( Col (R23 , D357) )) ) ) ) by L2553 , L2500 , L2501 , L2533 , L2539 , L2496
.= ( ( Sum ( mlt (( Line (R20 , R1) ) , ( ( len R22 ) |-> ( 0. R8 ) )) ) ) + ( Sum ( ( 0. R8 ) * ( Col (R23 , D357) ) ) ) ) by L2501 , FVSUM_1:66
.= ( ( Sum ( ( 0. R8 ) * ( Line (R20 , R1) ) ) ) + ( Sum ( ( 0. R8 ) * ( Col (R23 , D357) ) ) ) ) by L2500 , FVSUM_1:66
.= ( ( Sum ( ( 0. R8 ) * ( Line (R20 , R1) ) ) ) + ( ( 0. R8 ) * ( Sum ( Col (R23 , D357) ) ) ) ) by FVSUM_1:73
.= ( ( ( 0. R8 ) * ( Sum ( Line (R20 , R1) ) ) ) + ( ( 0. R8 ) * ( Sum ( Col (R23 , D357) ) ) ) ) by FVSUM_1:73
.= ( ( ( 0. R8 ) * ( Sum ( Line (R20 , R1) ) ) ) + ( 0. R8 ) ) by VECTSP_1:6
.= ( ( 0. R8 ) + ( 0. R8 ) ) by VECTSP_1:6
.= ( 0. R8 ) by RLVECT_1:def 4
.= ( ( ( width ( R21 * R23 ) ) |-> ( 0. R8 ) ) . D357 ) by L2524 , L2552 , FINSEQ_2:57
.= ( ( ( Line (( R20 * R22 ) , R1) ) ^ ( ( width ( R21 * R23 ) ) |-> ( 0. R8 ) ) ) . ( D357 + ( width ( R20 * R22 ) ) ) ) by L2502 , L2552 , L2549 , L2550 , FINSEQ_1:def 7
.= ( ( Line (D356 , R1) ) . R2 ) by L2512 , L2502 , L2537 , L576
.= ( D356 * (R1 , R2) ) by L2529 , MATRIX_1:def 7;
end;
end;
thus L2556: ( D355 * (R1 , R2) ) = ( D356 * (R1 , R2) ) by L2540;
end;
suppose L2557: R1 > ( len R20 );

reconsider D358 = ( R1 - ( len R20 ) ) as (Element of ( NAT )) by L2557 , NAT_1:21;
L2558: R1 = ( D358 + ( len R20 ) );
L2559: ( dom R21 ) = ( dom ( R21 * R23 ) ) by L2511 , FINSEQ_3:29;
L2560: D358 <> ( 0 ) by L2557;
L2561: D358 in ( Seg ( len R21 ) ) by L2560 , L2507 , L2517 , L2509 , L2530 , L2527 , L2558 , FINSEQ_1:61;
L2562: D358 in ( dom R21 ) by L2561 , FINSEQ_1:def 3;
L2563: ( Line (D354 , ( D358 + ( len R20 ) )) ) = ( ( ( width R20 ) |-> ( 0. R8 ) ) ^ ( Line (R21 , D358) ) ) by L2562 , L576;
L2564:
now
per cases ;
suppose L2565: R2 <= ( width R22 );

L2566: ( dom ( ( width ( R20 * R22 ) ) |-> ( 0. R8 ) ) ) = ( Seg ( width R22 ) ) by L2502 , FINSEQ_2:124;
L2567: R2 in ( Seg ( width R22 ) ) by L2534 , L2565 , FINSEQ_1:1;
L2568: ( Col (D353 , R2) ) = ( ( Col (R22 , R2) ) ^ ( ( len R23 ) |-> ( 0. R8 ) ) ) by L2567 , L707;
thus L2569: ( D355 * (R1 , R2) ) = ( ( Sum ( mlt (( ( width R20 ) |-> ( 0. R8 ) ) , ( Col (R22 , R2) )) ) ) + ( Sum ( mlt (( Line (R21 , D358) ) , ( ( len R23 ) |-> ( 0. R8 ) )) ) ) ) by L2568 , L2500 , L2501 , L2533 , L2563 , L2496
.= ( ( Sum ( mlt (( ( width R20 ) |-> ( 0. R8 ) ) , ( Col (R22 , R2) )) ) ) + ( Sum ( ( 0. R8 ) * ( Line (R21 , D358) ) ) ) ) by L2501 , FVSUM_1:66
.= ( ( Sum ( ( 0. R8 ) * ( Col (R22 , R2) ) ) ) + ( Sum ( ( 0. R8 ) * ( Line (R21 , D358) ) ) ) ) by L2500 , FVSUM_1:66
.= ( ( Sum ( ( 0. R8 ) * ( Col (R22 , R2) ) ) ) + ( ( 0. R8 ) * ( Sum ( Line (R21 , D358) ) ) ) ) by FVSUM_1:73
.= ( ( ( 0. R8 ) * ( Sum ( Col (R22 , R2) ) ) ) + ( ( 0. R8 ) * ( Sum ( Line (R21 , D358) ) ) ) ) by FVSUM_1:73
.= ( ( ( 0. R8 ) * ( Sum ( Col (R22 , R2) ) ) ) + ( 0. R8 ) ) by VECTSP_1:6
.= ( ( 0. R8 ) + ( 0. R8 ) ) by VECTSP_1:6
.= ( 0. R8 ) by RLVECT_1:def 4
.= ( ( ( width ( R20 * R22 ) ) |-> ( 0. R8 ) ) . R2 ) by L2502 , L2567 , FINSEQ_2:57
.= ( ( ( ( width ( R20 * R22 ) ) |-> ( 0. R8 ) ) ^ ( Line (( R21 * R23 ) , D358) ) ) . R2 ) by L2567 , L2566 , FINSEQ_1:def 7
.= ( ( Line (D356 , ( D358 + ( len R20 ) )) ) . R2 ) by L2512 , L2521 , L2562 , L2559 , L576
.= ( D356 * (R1 , R2) ) by L2529 , MATRIX_1:def 7;
end;
suppose L2570: R2 > ( width R22 );

reconsider D359 = ( R2 - ( width R22 ) ) as (Element of ( NAT )) by L2570 , NAT_1:21;
L2571: R2 = ( D359 + ( width R22 ) );
L2572: D359 <> ( 0 ) by L2570;
L2573: D359 in ( Seg ( width R23 ) ) by L2572 , L2508 , L2518 , L2510 , L2529 , L2571 , FINSEQ_1:61;
L2574: [ D358 , D359 ] in ( Indices ( R21 * R23 ) ) by L2573 , L2524 , L2562 , L2559 , ZFMISC_1:87;
L2575: ( len ( ( width ( R20 * R22 ) ) |-> ( 0. R8 ) ) ) = ( width R22 ) by L2502 , CARD_1:def 7;
L2576: ( dom ( Line (( R21 * R23 ) , D358) ) ) = ( Seg ( width R23 ) ) by L2524 , FINSEQ_2:124;
L2577: ( Col (D353 , ( D359 + ( width R22 ) )) ) = ( ( ( len R22 ) |-> ( 0. R8 ) ) ^ ( Col (R23 , D359) ) ) by L2573 , L707;
thus L2578: ( D355 * (R1 , R2) ) = ( ( Sum ( mlt (( ( width R20 ) |-> ( 0. R8 ) ) , ( ( len R22 ) |-> ( 0. R8 ) )) ) ) + ( Sum ( mlt (( Line (R21 , D358) ) , ( Col (R23 , D359) )) ) ) ) by L2577 , L2500 , L2501 , L2533 , L2563 , L2496
.= ( ( Sum ( ( 0. R8 ) * ( ( width R20 ) |-> ( 0. R8 ) ) ) ) + ( Sum ( mlt (( Line (R21 , D358) ) , ( Col (R23 , D359) )) ) ) ) by L2500 , FVSUM_1:66
.= ( ( ( 0. R8 ) * ( Sum ( ( width R20 ) |-> ( 0. R8 ) ) ) ) + ( Sum ( mlt (( Line (R21 , D358) ) , ( Col (R23 , D359) )) ) ) ) by FVSUM_1:73
.= ( ( 0. R8 ) + ( Sum ( mlt (( Line (R21 , D358) ) , ( Col (R23 , D359) )) ) ) ) by VECTSP_1:6
.= ( ( Line (R21 , D358) ) "*" ( Col (R23 , D359) ) ) by RLVECT_1:def 4
.= ( ( R21 * R23 ) * (D358 , D359) ) by L2501 , L2574 , MATRIX_3:def 4
.= ( ( Line (( R21 * R23 ) , D358) ) . D359 ) by L2524 , L2573 , MATRIX_1:def 7
.= ( ( ( ( width ( R20 * R22 ) ) |-> ( 0. R8 ) ) ^ ( Line (( R21 * R23 ) , D358) ) ) . ( D359 + ( width R22 ) ) ) by L2573 , L2576 , L2575 , FINSEQ_1:def 7
.= ( ( Line (D356 , ( D358 + ( len R20 ) )) ) . R2 ) by L2512 , L2521 , L2562 , L2559 , L576
.= ( D356 * (R1 , R2) ) by L2529 , MATRIX_1:def 7;
end;
end;
thus L2580: ( D355 * (R1 , R2) ) = ( D356 * (R1 , R2) ) by L2564;
end;
end;
thus L2582: ( D356 * (R1 , R2) ) = ( D355 * (R1 , R2) ) by L2535;
end;
thus L2583: thesis by L2526 , L2507 , L2508 , L2520 , L2523 , L2517 , L2518 , MATRIX_1:21;
end;
theorem
L2584: (for R8 being Field holds (for R37 being (FinSequence_of_Square-Matrix of R8) holds (for R38 being (FinSequence_of_Square-Matrix of R8) holds (( Width R37 ) = ( Len R38 ) implies ( ( block_diagonal (R37 , ( 0. R8 )) ) * ( block_diagonal (R38 , ( 0. R8 )) ) ) = ( block_diagonal (( R37 (#) R38 ) , ( 0. R8 )) )))))
proof
let R8 being Field;
let R37 being (FinSequence_of_Square-Matrix of R8);
let R38 being (FinSequence_of_Square-Matrix of R8);
defpred S11[ Nat ] means (for R37 being (FinSequence_of_Square-Matrix of R8) holds (for R38 being (FinSequence_of_Square-Matrix of R8) holds ((( Width R37 ) = ( Len R38 ) & ( len R37 ) = $1) implies ( ( block_diagonal (R37 , ( 0. R8 )) ) * ( block_diagonal (R38 , ( 0. R8 )) ) ) = ( block_diagonal (( R37 (#) R38 ) , ( 0. R8 )) ))));
assume L2585: ( Width R37 ) = ( Len R38 );
L2586: (for R4 being Nat holds (S11[ R4 ] implies S11[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume that
L2587: S11[ R4 ];
set D360 = ( R4 + 1 );
let R37 being (FinSequence_of_Square-Matrix of R8);
let R38 being (FinSequence_of_Square-Matrix of R8);
assume that
L2588: ( Width R37 ) = ( Len R38 )
and
L2589: ( len R37 ) = D360;
L2590: D360 in ( Seg D360 ) by FINSEQ_1:4;
set D361 = ( R37 | R4 );
L2591: ( len D361 ) = R4 by L2589 , FINSEQ_1:59 , NAT_1:11;
set D362 = ( R38 | R4 );
L2592: ( len R37 ) = ( len ( Len R38 ) ) by L2588 , CARD_1:def 7
.= ( len R38 ) by CARD_1:def 7;
L2593: ( len D362 ) = R4 by L2592 , L2589 , FINSEQ_1:59 , NAT_1:11;
set D363 = ( block_diagonal (D362 , ( 0. R8 )) );
set D364 = ( block_diagonal (D361 , ( 0. R8 )) );
L2594: ( Width D361 ) = ( ( Width R37 ) | R4 ) by L525
.= ( Len D362 ) by L2588 , L477;
L2595: ( dom ( Width R37 ) ) = ( Seg D360 ) by L2589 , FINSEQ_2:124;
L2596: ( width ( R37 . D360 ) ) = ( ( Len R38 ) . D360 ) by L2595 , L2588 , L2590 , L399
.= ( len ( R38 . D360 ) ) by L2588 , L2590 , L2595 , L387;
L2597: R37 = ( ( R37 | R4 ) ^ <* ( R37 . D360 ) *> ) by L2589 , FINSEQ_3:55;
L2598: ( width D364 ) = ( Sum ( Width D361 ) ) by L537
.= ( len D363 ) by L2594 , L537;
L2599: R38 = ( ( R38 | R4 ) ^ <* ( R38 . D360 ) *> ) by L2589 , L2592 , FINSEQ_3:55;
thus L2600: ( ( block_diagonal (R37 , ( 0. R8 )) ) * ( block_diagonal (R38 , ( 0. R8 )) ) ) = ( ( block_diagonal (<* D364 , ( R37 . D360 ) *> , ( 0. R8 )) ) * ( block_diagonal (( D362 ^ <* ( R38 . D360 ) *> ) , ( 0. R8 )) ) ) by L2599 , L2597 , L1078
.= ( ( block_diagonal (<* D364 , ( R37 . D360 ) *> , ( 0. R8 )) ) * ( block_diagonal (<* D363 , ( R38 . D360 ) *> , ( 0. R8 )) ) ) by L1078
.= ( block_diagonal (( <* D364 , ( R37 . D360 ) *> (#) <* D363 , ( R38 . D360 ) *> ) , ( 0. R8 )) ) by L2598 , L2596 , L2499
.= ( block_diagonal (<* ( D364 * D363 ) , ( ( R37 . D360 ) * ( R38 . D360 ) ) *> , ( 0. R8 )) ) by L2492
.= ( block_diagonal (<* ( block_diagonal (( D361 (#) D362 ) , ( 0. R8 )) ) , ( ( R37 . D360 ) * ( R38 . D360 ) ) *> , ( 0. R8 )) ) by L2587 , L2591 , L2594
.= ( block_diagonal (( ( D361 (#) D362 ) ^ <* ( ( R37 . D360 ) * ( R38 . D360 ) ) *> ) , ( 0. R8 )) ) by L1078
.= ( block_diagonal (( ( D361 (#) D362 ) ^ ( <* ( R37 . D360 ) *> (#) <* ( R38 . D360 ) *> ) ) , ( 0. R8 )) ) by L2490
.= ( block_diagonal (( R37 (#) R38 ) , ( 0. R8 )) ) by L2591 , L2593 , L2597 , L2599 , L2447;
end;
L2601: S11[ ( 0 ) ]
proof
let R37 being (FinSequence_of_Square-Matrix of R8);
let R38 being (FinSequence_of_Square-Matrix of R8);
assume that
L2602: ( Width R37 ) = ( Len R38 )
and
L2603: ( len R37 ) = ( 0 );
L2604: ( Sum ( Width R37 ) ) = ( 0 ) by L2603 , RVSUM_1:72;
set D365 = ( block_diagonal (R38 , ( 0. R8 )) );
L2605: ( Len R38 ) = ( {} ) by L2602 , L2603;
L2606: ( len D365 ) = ( 0 ) by L2605 , L537 , RVSUM_1:72;
set D366 = ( block_diagonal (R37 , ( 0. R8 )) );
L2607: ( Sum ( Width R37 ) ) = ( width D366 ) by L537;
set D367 = ( block_diagonal (( R37 (#) R38 ) , ( 0. R8 )) );
L2608: ( Len R37 ) = ( {} ) by L2603;
L2609: ( Len R37 ) = ( Len ( R37 (#) R38 ) ) by L2602 , L2428;
L2610: ( len D367 ) = ( 0 ) by L2609 , L2608 , L537 , RVSUM_1:72;
L2611: D367 = ( {} ) by L2610;
L2612: ( len D366 ) = ( 0 ) by L2608 , L537 , RVSUM_1:72;
L2613: ( len ( D366 * D365 ) ) = ( 0 ) by L2612 , L2606 , L2607 , L2604 , MATRIX_3:def 4;
thus L2614: thesis by L2613 , L2611;
end;
L2615: (for R4 being Nat holds S11[ R4 ]) from NAT_1:sch 2(L2601 , L2586);
thus L2616: thesis by L2615 , L2585;
end;
