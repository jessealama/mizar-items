:: Replacement of Subtrees in a Tree
::  by Oleg Okhotnikov
::
:: Received October 1, 1995
:: Copyright (c) 1995-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies TREES_1, FINSEQ_1, NUMBERS, SUBSET_1, ORDINAL4, XBOOLE_0, TARSKI,
      RELAT_1, XXREAL_0, ARYTM_3, TREES_2, FUNCT_1, TREES_A;
 notations TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, XXREAL_0, ORDINAL1, NAT_1,
      RELAT_1, FUNCT_1, FINSEQ_1, TREES_1, TREES_2;
 constructors XXREAL_0, NAT_1, MEMBERED, TREES_2, RELSET_1, FINSEQ_2;
 registrations XBOOLE_0, RELSET_1, MEMBERED, FINSEQ_1, TREES_2;
 requirements NUMERALS, BOOLE, SUBSET;
 definitions TARSKI, XBOOLE_0, TREES_1, TREES_2, RELAT_1;
 theorems TARSKI, FUNCT_1, FINSEQ_1, TREES_1, TREES_2, XBOOLE_0, XBOOLE_1,
      RELAT_1;
 schemes TREES_2;

begin
theorem
L1: (for B1 , B2 , B3 , B4 being FinSequence holds (( B1 ^ B2 ) = ( B4 ^ B3 ) implies B1 , B4 are_c=-comparable ))
proof
let C1 , C2 , C3 , C4 being FinSequence;
assume L2: ( C1 ^ C2 ) = ( C4 ^ C3 );
L3: (C1 is_a_prefix_of ( C4 ^ C3 ) & C4 is_a_prefix_of ( C1 ^ C2 )) by L2 , TREES_1:1;
thus L4: thesis by L3 , L2 , TREES_2:1;
end;
definition
let R1 being Tree;
let R2 being Tree;
let R3 being (AntiChain_of_Prefixes of R1);
assume that
L5: R3 <> ( {} );
func tree (R1 , R3 , R2) -> Tree means 
:L6: (for R6 being (FinSequence of ( NAT )) holds (R6 in it iff ((R6 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R6)))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R3 & R7 in R2 & R6 = ( R5 ^ R7 )))))));
existence
proof
reconsider D1 = R3 as (Subset of R1) by TREES_1:def 11;
L7:
now
let R10 being set;
assume L8: R10 in D1;
reconsider D2 = R10 as FinSequence by L8 , TREES_1:def 10;
reconsider D3 = D2 as (Element of R1) by L8;
L9:
now
let R5 being (FinSequence of ( NAT ));
assume that
L10: R5 in R3;
per cases ;
suppose L11: R5 <> D3;

L12: (not R5 , D3 are_c=-comparable ) by L11 , L8 , L10 , TREES_1:def 10;
thus L13: (not R5 is_a_proper_prefix_of D3) by L12 , XBOOLE_1:104;
end;
suppose L14: R5 = D3;

thus L15: (not R5 is_a_proper_prefix_of D3) by L14;
end;
end;
thus L17: R10 in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } by L9;
end;
L18: R3 c= { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } by L7 , TARSKI:def 3;
reconsider D4 = { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } as non  empty set by L18 , L5 , XBOOLE_1:3;
consider R11 being set such that L19: R11 = { ( B5 ^ B6 ) where B5 is (Element of R1) , B6 is (Element of R2) : B5 in R3 };
reconsider D5 = ( D4 \/ R11 ) as non  empty set;
L20: (for R10 being set holds (R10 in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } implies (R10 is (FinSequence of ( NAT )) & R10 in ( ( NAT ) * ) & R10 in R1)))
proof
let R10 being set;
assume L21: R10 in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) };
L22: (ex R12 being (Element of R1) st (R10 = R12 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))))) by L21;
thus L23: R10 is (FinSequence of ( NAT )) by L22;
thus L24: thesis by L22 , FINSEQ_1:def 11;
end;
L25: D5 is  Tree-like
proof
thus L26: D5 c= ( ( NAT ) * )
proof
let R10 being set;
assume L27: R10 in D5;
L28: (R10 in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } or R10 in { ( B7 ^ B8 ) where B7 is (Element of R1) , B8 is (Element of R2) : B7 in R3 }) by L27 , L19 , XBOOLE_0:def 3;
L29:
now
assume L30: R10 in { ( B9 ^ B10 ) where B9 is (Element of R1) , B10 is (Element of R2) : B9 in R3 };
L31: (ex B11 being (Element of R1) st (ex B12 being (Element of R2) st (R10 = ( B11 ^ B12 ) & B11 in R3))) by L30;
thus L32: R10 is (FinSequence of ( NAT )) by L31;
end;
thus L33: thesis by L29 , L20 , L28 , FINSEQ_1:def 11;
end;

thus L34: (for R6 being (FinSequence of ( NAT )) holds (R6 in D5 implies ( ProperPrefixes R6 ) c= D5))
proof
let R6 being (FinSequence of ( NAT ));
assume that
L35: R6 in D5;
L36:
now
assume L37: R6 in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) };
L38: (ex R12 being (Element of R1) st (R6 = R12 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))))) by L37;
L39: ( ProperPrefixes R6 ) c= R1 by L38 , TREES_1:def 3;
thus L40: ( ProperPrefixes R6 ) c= D5
proof
let R10 being set;
assume L41: R10 in ( ProperPrefixes R6 );
consider R4 being FinSequence such that L42: R10 = R4 and L43: R4 is_a_proper_prefix_of R6 by L41 , TREES_1:def 2;
reconsider D6 = R4 as (Element of R1) by L39 , L41 , L42;
L44: (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of D6)))
proof
let R5 being (FinSequence of ( NAT ));
assume that
L45: R5 in R3;
L46: (ex R12 being (Element of R1) st (R6 = R12 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))))) by L37;
thus L47: thesis by L46 , L43 , L45 , XBOOLE_1:56;
end;
L48: R10 in { B13 where B13 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B13))) } by L44 , L42;
thus L49: thesis by L48 , XBOOLE_0:def 3;
end;

end;
L41:
now
assume L42: R6 in R11;
consider C5 being (Element of R1), C6 being (Element of R2) such that L43: R6 = ( C5 ^ C6 ) and L44: C5 in R3 by L42 , L19;
thus L45: ( ProperPrefixes R6 ) c= D5
proof
let R10 being set;
assume L46: R10 in ( ProperPrefixes R6 );
reconsider D7 = R10 as FinSequence by L46 , TREES_1:11;
L47: D7 is_a_proper_prefix_of ( C5 ^ C6 ) by L43 , L46 , TREES_1:12;
L48: D7 is_a_prefix_of ( C5 ^ C6 ) by L47 , XBOOLE_0:def 8;
consider C7 being FinSequence such that L49: ( C5 ^ C6 ) = ( D7 ^ C7 ) by L48 , TREES_1:1;
L50:
now
assume L51: ( len C5 ) <= ( len D7 );
consider C8 being FinSequence such that L52: ( C5 ^ C8 ) = D7 by L51 , L49 , FINSEQ_1:47;
L53: ( C5 ^ C6 ) = ( C5 ^ ( C8 ^ C7 ) ) by L49 , L52 , FINSEQ_1:32;
L54: C6 = ( C8 ^ C7 ) by L53 , FINSEQ_1:33;
L55: ( C6 | ( dom C8 ) ) = C8 by L54 , FINSEQ_1:21;
L56: ( C6 | ( Seg ( len C8 ) ) ) = C8 by L55 , FINSEQ_1:def 3;
reconsider D8 = C8 as (FinSequence of ( NAT )) by L56 , FINSEQ_1:18;
L57: D8 is_a_prefix_of C6 by L56 , TREES_1:def 1;
reconsider D9 = D8 as (Element of R2) by L57 , TREES_1:20;
L58: D7 = ( C5 ^ D9 ) by L52;
L59: D7 in { ( B14 ^ B15 ) where B14 is (Element of R1) , B15 is (Element of R2) : B14 in R3 } by L58 , L44;
thus L60: D7 in D5 by L59 , L19 , XBOOLE_0:def 3;
end;
L61:
now
assume L62: ( len D7 ) <= ( len C5 );
L63: (ex B16 being FinSequence st ( D7 ^ B16 ) = C5) by L62 , L49 , FINSEQ_1:47;
L64: ( C5 | ( dom D7 ) ) = D7 by L63 , FINSEQ_1:21;
L65: ( C5 | ( Seg ( len D7 ) ) ) = D7 by L64 , FINSEQ_1:def 3;
reconsider D10 = D7 as (FinSequence of ( NAT )) by L65 , FINSEQ_1:18;
L66: D10 is_a_prefix_of C5 by L65 , TREES_1:def 1;
reconsider D11 = D10 as (Element of R1) by L66 , TREES_1:20;
L67: (for R9 being (FinSequence of ( NAT )) holds (R9 in R3 implies (not R9 is_a_proper_prefix_of D11)))
proof
let R9 being (FinSequence of ( NAT ));
assume L68: R9 in R3;
assume L69: R9 is_a_proper_prefix_of D11;
L70: R9 is_a_prefix_of D11 by L69 , XBOOLE_0:def 8;
L71: R9 is_a_prefix_of C5 by L70 , L66 , XBOOLE_1:1;
L72: C5 , R9 are_c=-comparable  by L71 , XBOOLE_0:def 9;
per cases ;
suppose L73: C5 <> R9;

thus L74: contradiction by L73 , L44 , L68 , L72 , TREES_1:def 10;
end;
suppose L75: C5 = R9;

thus L76: contradiction by L75 , L66 , L69 , XBOOLE_0:def 8;
end;
end;
L78: D11 in { R12 where R12 is (Element of R1) : (for R9 being (FinSequence of ( NAT )) holds (R9 in R3 implies (not R9 is_a_proper_prefix_of R12))) } by L67;
thus L79: D7 in D5 by L78 , XBOOLE_0:def 3;
end;
thus L80: thesis by L61 , L50;
end;

end;
thus L46: thesis by L41 , L35 , L36 , XBOOLE_0:def 3;
end;

let R6 being (FinSequence of ( NAT ));
let R13 being (Element of ( NAT ));
let R14 being (Element of ( NAT ));
assume that
L47: ( R6 ^ <* R13 *> ) in D5
and
L48: R14 <= R13;
L49:
now
assume L50: ( R6 ^ <* R13 *> ) in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) };
L51: (ex B17 being (Element of R1) st (( R6 ^ <* R13 *> ) = B17 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B17))))) by L50;
reconsider D12 = ( R6 ^ <* R14 *> ) as (Element of R1) by L51 , L48 , TREES_1:def 3;
L52:
now
let R5 being (FinSequence of ( NAT ));
assume that
L53: R5 in R3;
assume L54: R5 is_a_proper_prefix_of D12;
L55: R5 is_a_prefix_of R6 by L54 , TREES_1:9;
L56: (ex B18 being (Element of R1) st (( R6 ^ <* R13 *> ) = B18 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B18))))) by L50;
thus L57: contradiction by L56 , L53 , L55 , TREES_1:8;
end;
L58: ( R6 ^ <* R14 *> ) in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } by L52;
thus L59: ( R6 ^ <* R14 *> ) in D5 by L58 , XBOOLE_0:def 3;
end;
L60:
now
assume L61: ( R6 ^ <* R13 *> ) in R11;
consider C9 being (Element of R1), C10 being (Element of R2) such that L62: ( R6 ^ <* R13 *> ) = ( C9 ^ C10 ) and L63: C9 in R3 by L61 , L19;
L64:
now
assume L65: ( len R6 ) <= ( len C9 );
consider C11 being FinSequence such that L66: ( R6 ^ C11 ) = C9 by L65 , L62 , FINSEQ_1:47;
L67: ( R6 ^ <* R13 *> ) = ( R6 ^ ( C11 ^ C10 ) ) by L62 , L66 , FINSEQ_1:32;
L68: <* R13 *> = ( C11 ^ C10 ) by L67 , FINSEQ_1:33;
L69:
now
assume L70: C11 = <* R13 *>;
reconsider D13 = ( R6 ^ <* R14 *> ) as (Element of R1) by L70 , L48 , L66 , TREES_1:def 3;
L71:
now
let R9 being (FinSequence of ( NAT ));
assume that
L72: R9 in R3;
assume L73: R9 is_a_proper_prefix_of D13;
L74: R9 is_a_prefix_of D13 by L73 , XBOOLE_0:def 8;
L75: ( len C9 ) = ( ( len R6 ) + ( len <* R13 *> ) ) by L66 , L70 , FINSEQ_1:22
.= ( ( len R6 ) + 1 ) by FINSEQ_1:40
.= ( ( len R6 ) + ( len <* R14 *> ) ) by FINSEQ_1:40
.= ( len D13 ) by FINSEQ_1:22;
per cases ;
suppose L76: R9 = C9;

thus L77: contradiction by L76 , L73 , L74 , L75 , TREES_1:2;
end;
suppose L78: R9 <> C9;

L79: (R6 is_a_prefix_of C9 & R9 is_a_prefix_of R6) by L66 , L73 , TREES_1:1 , TREES_1:9;
L80: R9 is_a_prefix_of C9 by L79 , XBOOLE_1:1;
L81: C9 , R9 are_c=-comparable  by L80 , XBOOLE_0:def 9;
thus L82: contradiction by L81 , L63 , L72 , L78 , TREES_1:def 10;
end;
end;
thus L84: ( R6 ^ <* R14 *> ) in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } by L71;
end;
L85:
now
assume that
L86: C10 = <* R13 *>
and
L87: C11 = ( {} );
L88: C10 = ( ( <*> ( NAT ) ) ^ C10 ) by FINSEQ_1:34;
L89: ( ( <*> ( NAT ) ) ^ <* R14 *> ) in R2 by L88 , L48 , L86 , TREES_1:def 3;
reconsider D14 = <* R14 *> as (Element of R2) by L89 , FINSEQ_1:34;
L90: ( R6 ^ <* R14 *> ) = ( C9 ^ D14 ) by L66 , L87 , FINSEQ_1:34;
thus L91: ( R6 ^ <* R14 *> ) in R11 by L90 , L19 , L63;
end;
thus L92: ( R6 ^ <* R14 *> ) in D5 by L85 , L68 , L69 , FINSEQ_1:88 , XBOOLE_0:def 3;
end;
L93:
now
assume L94: ( len C9 ) <= ( len R6 );
consider C12 being FinSequence such that L95: ( C9 ^ C12 ) = R6 by L94 , L62 , FINSEQ_1:47;
L96: ( C9 ^ ( C12 ^ <* R13 *> ) ) = ( C9 ^ C10 ) by L62 , L95 , FINSEQ_1:32;
L97: ( C12 ^ <* R13 *> ) = C10 by L96 , FINSEQ_1:33;
L98: ( C10 | ( dom C12 ) ) = C12 by L97 , FINSEQ_1:21;
L99: ( C10 | ( Seg ( len C12 ) ) ) = C12 by L98 , FINSEQ_1:def 3;
reconsider D15 = C12 as (FinSequence of ( NAT )) by L99 , FINSEQ_1:18;
reconsider D16 = ( D15 ^ <* R14 *> ) as (Element of R2) by L48 , L97 , TREES_1:def 3;
L100: ( R6 ^ <* R14 *> ) = ( C9 ^ D16 ) by L95 , FINSEQ_1:32;
L101: ( R6 ^ <* R14 *> ) in { ( B19 ^ B20 ) where B19 is (Element of R1) , B20 is (Element of R2) : B19 in R3 } by L100 , L63;
thus L102: ( R6 ^ <* R14 *> ) in D5 by L101 , L19 , XBOOLE_0:def 3;
end;
thus L103: ( R6 ^ <* R14 *> ) in D5 by L93 , L64;
end;
thus L104: ( R6 ^ <* R14 *> ) in D5 by L60 , L47 , L49 , XBOOLE_0:def 3;
end;
reconsider D17 = D5 as Tree by L25;
take D17;
let R6 being (FinSequence of ( NAT ));
thus L105: (R6 in D17 implies ((R6 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R6)))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R3 & R7 in R2 & R6 = ( R5 ^ R7 ))))))
proof
assume L106: R6 in D17;
L107:
now
assume L108: R6 in D4;
L109: (ex B21 being (Element of R1) st (R6 = B21 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B21))))) by L108;
thus L110: thesis by L109;
end;
L111:
now
assume L112: R6 in R11;
L113: (ex B22 being (Element of R1) st (ex B23 being (Element of R2) st (R6 = ( B22 ^ B23 ) & B22 in R3))) by L112 , L19;
thus L114: (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R3 & R7 in R2 & R6 = ( R5 ^ R7 )))) by L113;
end;
thus L115: thesis by L111 , L106 , L107 , XBOOLE_0:def 3;
end;

assume L116: ((R6 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R6)))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R3 & R7 in R2 & R6 = ( R5 ^ R7 )))));
L117: ((R6 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R6)))) implies R6 in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) });
L118:
now
given R5 being (FinSequence of ( NAT )) , R7 being (FinSequence of ( NAT )) such that
L119: (R5 in R3 & R7 in R2 & R6 = ( R5 ^ R7 ));

L120: R3 c= R1 by TREES_1:def 11;
thus L121: R6 in R11 by L120 , L19 , L119;
end;
thus L122: thesis by L118 , L116 , L117 , XBOOLE_0:def 3;
end;
uniqueness
proof
let C13 , C14 being Tree;
assume that
L123: (for R6 being (FinSequence of ( NAT )) holds (R6 in C13 iff ((R6 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R6)))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R3 & R7 in R2 & R6 = ( R5 ^ R7 )))))))
and
L124: (for R6 being (FinSequence of ( NAT )) holds (R6 in C14 iff ((R6 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R6)))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R3 & R7 in R2 & R6 = ( R5 ^ R7 )))))));
let C15 being (FinSequence of ( NAT ));
thus L125: (C15 in C13 implies C15 in C14)
proof
assume L126: C15 in C13;
reconsider D18 = C15 as (FinSequence of ( NAT ));
L127: ((D18 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of D18)))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R3 & R7 in R2 & D18 = ( R5 ^ R7 ))))) by L123 , L126;
thus L128: thesis by L127 , L124;
end;

assume L129: C15 in C14;
reconsider D19 = C15 as (FinSequence of ( NAT ));
L130: ((D19 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of D19)))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R3 & R7 in R2 & D19 = ( R5 ^ R7 ))))) by L124 , L129;
thus L131: thesis by L130 , L123;
end;
end;
theorem
L133: (for R1 being Tree holds (for R2 being Tree holds (for R3 being (AntiChain_of_Prefixes of R1) holds (R3 <> ( {} ) implies ( tree (R1 , R3 , R2) ) = ( { B24 where B24 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B24))) } \/ { ( B25 ^ B26 ) where B25 is (Element of R1) , B26 is (Element of R2) : B25 in R3 } )))))
proof
let R1 being Tree;
let R2 being Tree;
let R3 being (AntiChain_of_Prefixes of R1);
assume L134: R3 <> ( {} );
thus L135: ( tree (R1 , R3 , R2) ) c= ( { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } \/ { ( B27 ^ B28 ) where B27 is (Element of R1) , B28 is (Element of R2) : B27 in R3 } )
proof
let C16 being set;
assume L136: C16 in ( tree (R1 , R3 , R2) );
reconsider D20 = C16 as (FinSequence of ( NAT )) by L136 , TREES_1:19;
L137:
now
given R5 being (FinSequence of ( NAT )) , R7 being (FinSequence of ( NAT )) such that
L138: (R5 in R3 & R7 in R2 & D20 = ( R5 ^ R7 ));

L139: R3 c= R1 by TREES_1:def 11;
thus L140: C16 in { ( B29 ^ B30 ) where B29 is (Element of R1) , B30 is (Element of R2) : B29 in R3 } by L139 , L138;
end;
L141: ((D20 in R1 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of D20)))) implies C16 in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) });
thus L142: thesis by L141 , L134 , L136 , L137 , L6 , XBOOLE_0:def 3;
end;

let C17 being set;
assume that
L143: C17 in ( { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) } \/ { ( B31 ^ B32 ) where B31 is (Element of R1) , B32 is (Element of R2) : B31 in R3 } );
L144:
now
assume L145: C17 in { ( B33 ^ B34 ) where B33 is (Element of R1) , B34 is (Element of R2) : B33 in R3 };
L146: (ex B35 being (Element of R1) st (ex B36 being (Element of R2) st (C17 = ( B35 ^ B36 ) & B35 in R3))) by L145;
thus L147: thesis by L146 , L6;
end;
L148:
now
assume L149: C17 in { R12 where R12 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))) };
L150: (ex R12 being (Element of R1) st (C17 = R12 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of R12))))) by L149;
thus L151: thesis by L150 , L134 , L6;
end;
thus L152: thesis by L148 , L143 , L144 , XBOOLE_0:def 3;
end;
theorem
L153: (for R1 being Tree holds (for R3 being (AntiChain_of_Prefixes of R1) holds { B37 where B37 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B37))) } c= { B38 where B38 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B38))) }))
proof
let R1 being Tree;
let R3 being (AntiChain_of_Prefixes of R1);
let C18 being set;
assume L154: C18 in { B39 where B39 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B39))) };
consider C19 being (Element of R1) such that L155: C18 = C19 and L156: (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of C19))) by L154;
L157:
now
let R5 being (FinSequence of ( NAT ));
assume L158: R5 in R3;
L159: (not R5 is_a_prefix_of C19) by L158 , L156;
thus L160: (not R5 is_a_proper_prefix_of C19) by L159 , XBOOLE_0:def 8;
end;
thus L161: thesis by L157 , L155;
end;
theorem
L162: (for R1 being Tree holds (for R3 being (AntiChain_of_Prefixes of R1) holds R3 c= { B40 where B40 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B40))) }))
proof
let R1 being Tree;
let R3 being (AntiChain_of_Prefixes of R1);
let C20 being set;
assume L163: C20 in R3;
L164: (ex B41 being (Element of R1) st (C20 = B41 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B41)))))
proof
L165: R3 c= R1 by TREES_1:def 11;
consider C21 being (Element of R1) such that L166: C21 = C20 by L165 , L163;
L167:
now
let R5 being (FinSequence of ( NAT ));
assume that
L168: R5 in R3;
per cases ;
suppose L169: C21 = R5;

thus L170: (not R5 is_a_proper_prefix_of C21) by L169;
end;
suppose L171: C21 <> R5;

L172: (not C21 , R5 are_c=-comparable ) by L171 , L163 , L166 , L168 , TREES_1:def 10;
thus L173: (not R5 is_a_proper_prefix_of C21) by L172 , XBOOLE_1:104;
end;
end;
thus L175: thesis by L167 , L166;
end;
thus L176: thesis by L164;
end;
theorem
L177: (for R1 being Tree holds (for R3 being (AntiChain_of_Prefixes of R1) holds ( { B42 where B42 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B42))) } \ { B43 where B43 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B43))) } ) = R3))
proof
let R1 being Tree;
let R3 being (AntiChain_of_Prefixes of R1);
L178:
now
let C22 being set;
assume L179: C22 in ( { B44 where B44 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B44))) } \ { B45 where B45 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B45))) } );
L180: C22 in { B46 where B46 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B46))) } by L179;
L181: (not C22 in { B47 where B47 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B47))) }) by L179 , XBOOLE_0:def 5;
assume L182: (not C22 in R3);
L183: (ex B48 being (Element of R1) st (C22 = B48 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B48)))))
proof
consider C23 being (Element of R1) such that L184: C22 = C23 and L185: (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of C23))) by L180;
L186:
now
let R5 being (FinSequence of ( NAT ));
assume L187: R5 in R3;
L188: (not R5 is_a_proper_prefix_of C23) by L187 , L185;
per cases  by L188 , XBOOLE_0:def 8;
suppose L189: (not R5 is_a_prefix_of C23);

thus L190: (not R5 is_a_prefix_of C23) by L189;
end;
suppose L191: R5 = C23;

thus L192: (not R5 is_a_prefix_of C23) by L191 , L182 , L184 , L187;
end;
end;
thus L194: thesis by L186 , L184;
end;
thus L195: contradiction by L183 , L181;
end;
thus L196: ( { B49 where B49 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B49))) } \ { B50 where B50 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B50))) } ) c= R3 by L178 , TARSKI:def 3;
let C24 being set;
assume L197: C24 in R3;
L198: R3 c= { B51 where B51 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B51))) } by L162;
L199: (not C24 in { B52 where B52 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B52))) })
proof
assume L200: C24 in { B53 where B53 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B53))) };
L201: (ex B54 being (Element of R1) st (C24 = B54 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B54))))) by L200;
thus L202: contradiction by L201 , L197;
end;
thus L203: thesis by L199 , L197 , L198 , XBOOLE_0:def 5;
end;
theorem
L204: (for R1 being Tree holds (for R2 being Tree holds (for R3 being (AntiChain_of_Prefixes of R1) holds R3 c= { ( B55 ^ B56 ) where B55 is (Element of R1) , B56 is (Element of R2) : B55 in R3 })))
proof
let R1 being Tree;
let R2 being Tree;
let R3 being (AntiChain_of_Prefixes of R1);
L205:
now
let C25 being set;
assume L206: C25 in R3;
L207: R3 c= R1 by TREES_1:def 11;
consider C26 being (Element of R1) such that L208: C26 = C25 by L207 , L206;
L209: ( <*> ( NAT ) ) in R2 by TREES_1:22;
consider C27 being (Element of R2) such that L210: C27 = ( <*> ( NAT ) ) by L209;
L211: C26 = ( C26 ^ C27 ) by L210 , FINSEQ_1:34;
thus L212: C25 in { ( B57 ^ B58 ) where B57 is (Element of R1) , B58 is (Element of R2) : B57 in R3 } by L211 , L206 , L208;
end;
thus L213: thesis by L205 , TARSKI:def 3;
end;
theorem
L214: (for R1 being Tree holds (for R2 being Tree holds (for R3 being (AntiChain_of_Prefixes of R1) holds (R3 <> ( {} ) implies ( tree (R1 , R3 , R2) ) = ( { B59 where B59 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B59))) } \/ { ( B60 ^ B61 ) where B60 is (Element of R1) , B61 is (Element of R2) : B60 in R3 } )))))
proof
let R1 being Tree;
let R2 being Tree;
let R3 being (AntiChain_of_Prefixes of R1);
assume L215: R3 <> ( {} );
L216: ( tree (R1 , R3 , R2) ) = ( { B62 where B62 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B62))) } \/ { ( B63 ^ B64 ) where B63 is (Element of R1) , B64 is (Element of R2) : B63 in R3 } ) by L215 , L133;
thus L217: ( tree (R1 , R3 , R2) ) c= ( { B65 where B65 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B65))) } \/ { ( B66 ^ B67 ) where B66 is (Element of R1) , B67 is (Element of R2) : B66 in R3 } )
proof
let C28 being set;
assume L218: C28 in ( tree (R1 , R3 , R2) );
L219: C28 in ( { B68 where B68 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B68))) } \/ { ( B69 ^ B70 ) where B69 is (Element of R1) , B70 is (Element of R2) : B69 in R3 } ) by L218 , L215 , L133;
L220:
now
per cases ;
suppose L221: C28 in R3;

L222: R3 c= { ( B71 ^ B72 ) where B71 is (Element of R1) , B72 is (Element of R2) : B71 in R3 } by L204;
thus L223: (C28 in { B73 where B73 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B73))) } or C28 in { ( B74 ^ B75 ) where B74 is (Element of R1) , B75 is (Element of R2) : B74 in R3 }) by L222 , L221;
end;
suppose L224: (not C28 in R3);

L225:
now
per cases  by L219 , XBOOLE_0:def 3;
suppose L226: C28 in { B76 where B76 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B76))) };

L227: C28 in { B77 where B77 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B77))) }
proof
assume L228: (not C28 in { B78 where B78 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B78))) });
L229: ( { B79 where B79 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_proper_prefix_of B79))) } \ { B80 where B80 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B80))) } ) = R3 by L177;
thus L230: contradiction by L229 , L224 , L226 , L228 , XBOOLE_0:def 5;
end;
thus L231: (C28 in { B81 where B81 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B81))) } or C28 in { ( B82 ^ B83 ) where B82 is (Element of R1) , B83 is (Element of R2) : B82 in R3 }) by L227;
end;
suppose L232: C28 in { ( B84 ^ B85 ) where B84 is (Element of R1) , B85 is (Element of R2) : B84 in R3 };

thus L233: (C28 in { B86 where B86 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B86))) } or C28 in { ( B87 ^ B88 ) where B87 is (Element of R1) , B88 is (Element of R2) : B87 in R3 }) by L232;
end;
end;
thus L235: (C28 in { B89 where B89 is (Element of R1) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies (not R5 is_a_prefix_of B89))) } or C28 in { ( B90 ^ B91 ) where B90 is (Element of R1) , B91 is (Element of R2) : B90 in R3 }) by L225;
end;
end;
thus L237: thesis by L220 , XBOOLE_0:def 3;
end;

thus L238: thesis by L216 , L153 , XBOOLE_1:9;
end;
theorem
L239: (for R1 being Tree holds (for R2 being Tree holds (for R3 being (AntiChain_of_Prefixes of R1) holds (for R5 being (FinSequence of ( NAT )) holds (R5 in R3 implies R2 = ( ( tree (R1 , R3 , R2) ) | R5 ))))))
proof
let R1 being Tree;
let R2 being Tree;
let R3 being (AntiChain_of_Prefixes of R1);
let R5 being (FinSequence of ( NAT ));
assume L240: R5 in R3;
L241: (ex R6 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R6 in R3 & R7 in R2 & R5 = ( R6 ^ R7 ))))
proof
consider R6 being (FinSequence of ( NAT )) such that L242: R6 = R5;
consider R7 being (FinSequence of ( NAT )) such that L243: R7 = ( <*> ( NAT ) );
L244: R7 in R2 by L243 , TREES_1:22;
L245: R5 = ( R6 ^ R7 ) by L242 , L243 , FINSEQ_1:34;
thus L246: thesis by L245 , L240 , L242 , L244;
end;
L247: R5 in ( tree (R1 , R3 , R2) ) by L241 , L6;
let C29 being (FinSequence of ( NAT ));
thus L248: (C29 in R2 implies C29 in ( ( tree (R1 , R3 , R2) ) | R5 ))
proof
assume L249: C29 in R2;
L250: ( R5 ^ C29 ) in ( tree (R1 , R3 , R2) ) by L249 , L240 , L6;
thus L251: thesis by L250 , L247 , TREES_1:def 6;
end;

thus L252: (C29 in ( ( tree (R1 , R3 , R2) ) | R5 ) implies C29 in R2)
proof
assume L253: C29 in ( ( tree (R1 , R3 , R2) ) | R5 );
L254: ( R5 ^ C29 ) in ( tree (R1 , R3 , R2) ) by L253 , L247 , TREES_1:def 6;
L255:
now
assume that
L256: ( R5 ^ C29 ) in R1
and
L257: (for R7 being (FinSequence of ( NAT )) holds (R7 in R3 implies (not R7 is_a_proper_prefix_of ( R5 ^ C29 ))));
L258: (not R5 is_a_proper_prefix_of ( R5 ^ C29 )) by L240 , L257;
L259: R5 is_a_prefix_of ( R5 ^ C29 ) by TREES_1:1;
L260: ( R5 ^ C29 ) = R5 by L259 , L258 , XBOOLE_0:def 8
.= ( R5 ^ ( <*> ( NAT ) ) ) by FINSEQ_1:34;
L261: C29 = ( {} ) by L260 , FINSEQ_1:33;
thus L262: thesis by L261 , TREES_1:22;
end;
L263:
now
given R8 being (FinSequence of ( NAT )) , R7 being (FinSequence of ( NAT )) such that
L264: R8 in R3
and
L265: R7 in R2
and
L266: ( R5 ^ C29 ) = ( R8 ^ R7 );

L267:
now
assume L268: R8 <> R5;
L269: (not R8 , R5 are_c=-comparable ) by L268 , L240 , L264 , TREES_1:def 10;
thus L270: contradiction by L269 , L266 , L1;
end;
thus L271: thesis by L267 , L265 , L266 , FINSEQ_1:33;
end;
thus L272: thesis by L263 , L240 , L254 , L255 , L6;
end;

end;
registration
let R1 being Tree;
cluster non  empty for (AntiChain_of_Prefixes of R1);
existence
proof
set D21 = the (Element of R1);
consider C30 being set such that L253: C30 = { D21 };
L254: C30 is  AntiChain_of_Prefixes-like by L253 , TREES_1:36;
L255: C30 c= R1
proof
let C31 being set;
assume L256: C31 in C30;
L257: C31 = D21 by L256 , L253 , TARSKI:def 1;
thus L258: thesis by L257;
end;
reconsider D22 = C30 as (AntiChain_of_Prefixes of R1) by L255 , L254 , TREES_1:def 11;
take D22;
thus L259: thesis by L253;
end;
end;
definition
let R1 being Tree;
let C32 being (Element of R1);
redefine func {C32 } -> (AntiChain_of_Prefixes of R1);

correctness by TREES_1:39;
end;
theorem
L262: (for R1 being Tree holds (for R2 being Tree holds (for R12 being (Element of R1) holds ( tree (R1 , { R12 } , R2) ) = ( R1 with-replacement (R12 , R2) ))))
proof
let R1 being Tree;
let R2 being Tree;
let R12 being (Element of R1);
let R5 being (FinSequence of ( NAT ));
thus L263: (R5 in ( tree (R1 , { R12 } , R2) ) implies R5 in ( R1 with-replacement (R12 , R2) ))
proof
assume L264: R5 in ( tree (R1 , { R12 } , R2) );
L265:
now
assume L266: (R5 in R1 & (for R8 being (FinSequence of ( NAT )) holds (R8 in { R12 } implies (not R8 is_a_proper_prefix_of R5))));
L267: R12 in { R12 } by TARSKI:def 1;
thus L268: (R5 in R1 & (not R12 is_a_proper_prefix_of R5)) by L267 , L266;
end;
L269:
now
given R8 being (FinSequence of ( NAT )) such that
L270: (ex R7 being (FinSequence of ( NAT )) st (R8 in { R12 } & R7 in R2 & R5 = ( R8 ^ R7 )));

L271: R8 = R12 by L270 , TARSKI:def 1;
thus L272: (ex R7 being (FinSequence of ( NAT )) st (R7 in R2 & R5 = ( R12 ^ R7 ))) by L271 , L270;
end;
thus L273: thesis by L269 , L264 , L265 , L6 , TREES_1:def 9;
end;

assume L274: R5 in ( R1 with-replacement (R12 , R2) );
L275: ((R5 in R1 & (not R12 is_a_proper_prefix_of R5)) implies (R5 in R1 & (for R8 being (FinSequence of ( NAT )) holds (R8 in { R12 } implies (not R8 is_a_proper_prefix_of R5))))) by TARSKI:def 1;
L276:
now
assume L277: (ex R7 being (FinSequence of ( NAT )) st (R7 in R2 & R5 = ( R12 ^ R7 )));
thus L278: (ex R8 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R8 in { R12 } & R7 in R2 & R5 = ( R8 ^ R7 ))))
proof
take R12;
L279: R12 in { R12 } by TARSKI:def 1;
thus L280: thesis by L279 , L277;
end;

end;
thus L279: thesis by L276 , L274 , L275 , L6 , TREES_1:def 9;
end;
definition
let R15 being DecoratedTree;
let R17 being (AntiChain_of_Prefixes of ( dom R15 ));
let R16 being DecoratedTree;
assume L280: R17 <> ( {} );
func tree (R15 , R17 , R16) -> DecoratedTree means 
:L281: (( dom it ) = ( tree (( dom R15 ) , R17 , ( dom R16 )) ) & (for R6 being (FinSequence of ( NAT )) holds (R6 in ( tree (( dom R15 ) , R17 , ( dom R16 )) ) implies ((for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( it . R6 ) = ( R15 . R6 )))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( it . R6 ) = ( R16 . R7 ))))))));
existence
proof
defpred S1[ FinSequence , set ] means ((for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of $1) & $2 = ( R15 . $1 )))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & $1 = ( R5 ^ R7 ) & $2 = ( R16 . R7 )))));
L282: (for R6 being (FinSequence of ( NAT )) holds (R6 in ( tree (( dom R15 ) , R17 , ( dom R16 )) ) implies (ex R10 being set st S1[ R6 , R10 ])))
proof
let R6 being (FinSequence of ( NAT ));
assume L283: R6 in ( tree (( dom R15 ) , R17 , ( dom R16 )) );
L284: R6 in ( { B92 where B92 is (Element of ( dom R15 )) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies (not R5 is_a_prefix_of B92))) } \/ { ( B93 ^ B94 ) where B93 is (Element of ( dom R15 )) , B94 is (Element of ( dom R16 )) : B93 in R17 } ) by L283 , L280 , L214;
L285:
now
assume L286: R6 in { B95 where B95 is (Element of ( dom R15 )) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies (not R5 is_a_prefix_of B95))) };
consider R18 being (Element of ( dom R15 )) such that L287: (R6 = R18 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies (not R5 is_a_prefix_of R18)))) by L286;
take D23 = ( R15 . R18 );
L288: (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & D23 = ( R15 . R6 )))) by L287;
thus L289: thesis by L288;
end;
L290:
now
assume L291: R6 in { ( B96 ^ B97 ) where B96 is (Element of ( dom R15 )) , B97 is (Element of ( dom R16 )) : B96 in R17 };
consider C33 being (Element of ( dom R15 )), C34 being (Element of ( dom R16 )) such that L292: (R6 = ( C33 ^ C34 ) & C33 in R17) by L291;
take D24 = ( R16 . C34 );
L293: ((for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & D24 = ( R15 . R6 )))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & D24 = ( R16 . R7 ))))) by L292;
thus L294: thesis by L293;
end;
thus L295: thesis by L290 , L284 , L285 , XBOOLE_0:def 3;
end;
thus L296: (ex B98 being DecoratedTree st (( dom B98 ) = ( tree (( dom R15 ) , R17 , ( dom R16 )) ) & (for R5 being (FinSequence of ( NAT )) holds (R5 in ( tree (( dom R15 ) , R17 , ( dom R16 )) ) implies S1[ R5 , ( B98 . R5 ) ])))) from TREES_2:sch 6(L282);
end;
uniqueness
proof
let C35 , C36 being DecoratedTree;
assume that
L297: ( dom C35 ) = ( tree (( dom R15 ) , R17 , ( dom R16 )) )
and
L298: (for R6 being (FinSequence of ( NAT )) holds (R6 in ( tree (( dom R15 ) , R17 , ( dom R16 )) ) implies ((for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( C35 . R6 ) = ( R15 . R6 )))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( C35 . R6 ) = ( R16 . R7 )))))))
and
L299: ( dom C36 ) = ( tree (( dom R15 ) , R17 , ( dom R16 )) )
and
L300: (for R6 being (FinSequence of ( NAT )) holds (R6 in ( tree (( dom R15 ) , R17 , ( dom R16 )) ) implies ((for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( C36 . R6 ) = ( R15 . R6 )))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( C36 . R6 ) = ( R16 . R7 )))))));
L301:
now
let R6 being (FinSequence of ( NAT ));
assume that
L302: R6 in ( dom C35 )
and
L303: ( C35 . R6 ) <> ( C36 . R6 );
thus L304: contradiction
proof
per cases  by L297 , L298 , L302;
suppose L305: (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( C35 . R6 ) = ( R15 . R6 ))));

L306:
now
per cases  by L297 , L300 , L302;
suppose L307: (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( C36 . R6 ) = ( R15 . R6 ))));

consider C37 being set such that L308: C37 in R17 by L280 , XBOOLE_0:def 1;
L309: R17 c= ( dom R15 ) by TREES_1:def 11;
reconsider D25 = C37 as (Element of ( dom R15 )) by L309 , L308;
L310: (ex R9 being (FinSequence of ( NAT )) st R9 = D25);
L311: ( C35 . R6 ) = ( R15 . R6 ) by L310 , L305 , L308;
thus L312: contradiction by L311 , L303 , L307 , L308 , L310;
end;
suppose L313: (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( C36 . R6 ) = ( R16 . R7 ))));

consider R20 being (FinSequence of ( NAT )), R22 being (FinSequence of ( NAT )) such that L314: R20 in R17 and L315: R22 in ( dom R16 ) and L316: R6 = ( R20 ^ R22 ) and L317: ( C36 . R6 ) = ( R16 . R22 ) by L313;
L318: (not R20 is_a_prefix_of R6) by L305 , L314;
thus L319: contradiction by L318 , L316 , TREES_1:1;
end;
end;
thus L321: contradiction by L306;
end;
suppose L322: (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( C35 . R6 ) = ( R16 . R7 ))));

consider R19 being (FinSequence of ( NAT )), R21 being (FinSequence of ( NAT )) such that L323: R19 in R17 and L324: R21 in ( dom R16 ) and L325: R6 = ( R19 ^ R21 ) and L326: ( C35 . R6 ) = ( R16 . R21 ) by L322;
L327:
now
per cases  by L297 , L300 , L302;
suppose L328: (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( C36 . R6 ) = ( R15 . R6 ))));

L329: (not R19 is_a_prefix_of R6) by L328 , L323;
thus L330: contradiction by L329 , L325 , TREES_1:1;
end;
suppose L331: (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( C36 . R6 ) = ( R16 . R7 ))));

consider R20 being (FinSequence of ( NAT )), R22 being (FinSequence of ( NAT )) such that L332: R20 in R17 and L333: R22 in ( dom R16 ) and L334: R6 = ( R20 ^ R22 ) and L335: ( C36 . R6 ) = ( R16 . R22 ) by L331;
L336:
now
assume L337: R19 <> R20;
L338: R19 , R20 are_c=-comparable  by L325 , L334 , L1;
thus L339: contradiction by L338 , L323 , L332 , L337 , TREES_1:def 10;
end;
thus L340: contradiction by L336 , L303 , L325 , L326 , L334 , L335 , FINSEQ_1:33;
end;
end;
thus L342: contradiction by L327;
end;
end;

end;
thus L305: thesis by L301 , L297 , L299 , TREES_2:31;
end;
end;
theorem
L307: (for R15 being DecoratedTree holds (for R16 being DecoratedTree holds (for R17 being (AntiChain_of_Prefixes of ( dom R15 )) holds (R17 <> ( {} ) implies (for R6 being (FinSequence of ( NAT )) holds (R6 in ( dom ( tree (R15 , R17 , R16) ) ) implies ((for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R15 . R6 )))) or (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R16 . R7 )))))))))))
proof
let R15 being DecoratedTree;
let R16 being DecoratedTree;
let R17 being (AntiChain_of_Prefixes of ( dom R15 ));
assume L308: R17 <> ( {} );
let R6 being (FinSequence of ( NAT ));
assume L309: R6 in ( dom ( tree (R15 , R17 , R16) ) );
L310: R6 in ( tree (( dom R15 ) , R17 , ( dom R16 )) ) by L309 , L308 , L281;
thus L311: thesis by L310 , L281;
end;
theorem
L312: (for R5 being (FinSequence of ( NAT )) holds (for R15 being DecoratedTree holds (for R16 being DecoratedTree holds (R5 in ( dom R15 ) implies (for R6 being (FinSequence of ( NAT )) holds (R6 in ( dom ( R15 with-replacement (R5 , R16) ) ) implies (((not R5 is_a_prefix_of R6) & ( ( R15 with-replacement (R5 , R16) ) . R6 ) = ( R15 . R6 )) or (ex R7 being (FinSequence of ( NAT )) st (R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( ( R15 with-replacement (R5 , R16) ) . R6 ) = ( R16 . R7 ))))))))))
proof
let R5 being (FinSequence of ( NAT ));
let R15 being DecoratedTree;
let R16 being DecoratedTree;
assume L313: R5 in ( dom R15 );
let R6 being (FinSequence of ( NAT ));
assume L314: R6 in ( dom ( R15 with-replacement (R5 , R16) ) );
L315: R6 in ( ( dom R15 ) with-replacement (R5 , ( dom R16 )) ) by L314 , L313 , TREES_2:def 11;
thus L316: thesis by L315 , L313 , TREES_2:def 11;
end;
theorem
L317: (for R15 being DecoratedTree holds (for R16 being DecoratedTree holds (for R17 being (AntiChain_of_Prefixes of ( dom R15 )) holds (R17 <> ( {} ) implies (for R6 being (FinSequence of ( NAT )) holds ((R6 in ( dom ( tree (R15 , R17 , R16) ) ) & R6 in { B99 where B99 is (Element of ( dom R15 )) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies (not R5 is_a_prefix_of B99))) }) implies ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R15 . R6 )))))))
proof
let R15 being DecoratedTree;
let R16 being DecoratedTree;
let R17 being (AntiChain_of_Prefixes of ( dom R15 ));
assume L318: R17 <> ( {} );
let R6 being (FinSequence of ( NAT ));
assume that
L319: R6 in ( dom ( tree (R15 , R17 , R16) ) )
and
L320: R6 in { B100 where B100 is (Element of ( dom R15 )) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies (not R5 is_a_prefix_of B100))) };
L321: (ex B101 being (Element of ( dom R15 )) st (B101 = R6 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies (not R5 is_a_prefix_of B101))))) by L320;
per cases  by L319 , L307;
suppose L322: (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R15 . R6 ))));

consider C38 being set such that L323: C38 in R17 by L318 , XBOOLE_0:def 1;
L324: R17 c= ( dom R15 ) by TREES_1:def 11;
reconsider D26 = C38 as (Element of ( dom R15 )) by L324 , L323;
L325: (ex R9 being (FinSequence of ( NAT )) st R9 = D26);
thus L326: thesis by L325 , L322 , L323;
end;
suppose L327: (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R16 . R7 ))));

consider R5 being (FinSequence of ( NAT )), R7 being (FinSequence of ( NAT )) such that L328: R5 in R17 and L329: R7 in ( dom R16 ) and L330: R6 = ( R5 ^ R7 ) and L331: ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R16 . R7 ) by L327;
L332: (not R5 is_a_prefix_of R6) by L321 , L328;
thus L333: thesis by L332 , L330 , TREES_1:1;
end;
end;
theorem
L335: (for R5 being (FinSequence of ( NAT )) holds (for R15 being DecoratedTree holds (for R16 being DecoratedTree holds (R5 in ( dom R15 ) implies (for R6 being (FinSequence of ( NAT )) holds ((R6 in ( dom ( R15 with-replacement (R5 , R16) ) ) & R6 in { B102 where B102 is (Element of ( dom R15 )) : (not R5 is_a_prefix_of B102) }) implies ( ( R15 with-replacement (R5 , R16) ) . R6 ) = ( R15 . R6 )))))))
proof
let R5 being (FinSequence of ( NAT ));
let R15 being DecoratedTree;
let R16 being DecoratedTree;
assume L336: R5 in ( dom R15 );
let R6 being (FinSequence of ( NAT ));
assume that
L337: R6 in ( dom ( R15 with-replacement (R5 , R16) ) )
and
L338: R6 in { B103 where B103 is (Element of ( dom R15 )) : (not R5 is_a_prefix_of B103) };
per cases  by L336 , L337 , L312;
suppose L339: ((not R5 is_a_prefix_of R6) & ( ( R15 with-replacement (R5 , R16) ) . R6 ) = ( R15 . R6 ));

thus L340: thesis by L339;
end;
suppose L341: (ex R7 being (FinSequence of ( NAT )) st (R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( ( R15 with-replacement (R5 , R16) ) . R6 ) = ( R16 . R7 )));

L342: (ex B104 being (Element of ( dom R15 )) st (R6 = B104 & (not R5 is_a_prefix_of B104))) by L338;
thus L343: thesis by L342 , L341 , TREES_1:1;
end;
end;
theorem
L345: (for R15 being DecoratedTree holds (for R16 being DecoratedTree holds (for R17 being (AntiChain_of_Prefixes of ( dom R15 )) holds (for R6 being (FinSequence of ( NAT )) holds ((R6 in ( dom ( tree (R15 , R17 , R16) ) ) & R6 in { ( B105 ^ B106 ) where B105 is (Element of ( dom R15 )) , B106 is (Element of ( dom R16 )) : B105 in R17 }) implies (ex B107 being (Element of ( dom R15 )) st (ex B108 being (Element of ( dom R16 )) st (R6 = ( B107 ^ B108 ) & B107 in R17 & ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R16 . B108 )))))))))
proof
let R15 being DecoratedTree;
let R16 being DecoratedTree;
let R17 being (AntiChain_of_Prefixes of ( dom R15 ));
let R6 being (FinSequence of ( NAT ));
assume that
L346: R6 in ( dom ( tree (R15 , R17 , R16) ) )
and
L347: R6 in { ( B109 ^ B110 ) where B109 is (Element of ( dom R15 )) , B110 is (Element of ( dom R16 )) : B109 in R17 };
per cases  by L346 , L307;
suppose L348: (for R5 being (FinSequence of ( NAT )) holds (R5 in R17 implies ((not R5 is_a_prefix_of R6) & ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R15 . R6 ))));

consider C39 being (Element of ( dom R15 )), C40 being (Element of ( dom R16 )) such that L349: R6 = ( C39 ^ C40 ) and L350: C39 in R17 by L347;
L351:
now
assume L352: ( ( tree (R15 , R17 , R16) ) . R6 ) <> ( R16 . C40 );
L353: (not C39 is_a_prefix_of R6) by L348 , L350;
thus L354: contradiction by L353 , L349 , TREES_1:1;
end;
thus L355: thesis by L351 , L349 , L350;
end;
suppose L356: (ex R5 being (FinSequence of ( NAT )) st (ex R7 being (FinSequence of ( NAT )) st (R5 in R17 & R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R16 . R7 ))));

consider R5 being (FinSequence of ( NAT )), R7 being (FinSequence of ( NAT )) such that L357: R5 in R17 and L358: R7 in ( dom R16 ) and L359: R6 = ( R5 ^ R7 ) and L360: ( ( tree (R15 , R17 , R16) ) . R6 ) = ( R16 . R7 ) by L356;
consider C41 being (Element of ( dom R15 )), C42 being (Element of ( dom R16 )) such that L361: R6 = ( C41 ^ C42 ) and L362: C41 in R17 by L347;
L363:
now
assume L364: R5 <> C41;
L365: R5 , C41 are_c=-comparable  by L359 , L361 , L1;
thus L366: contradiction by L365 , L357 , L362 , L364 , TREES_1:def 10;
end;
thus L367: thesis by L363 , L357 , L358 , L359 , L360;
end;
end;
theorem
L369: (for R5 being (FinSequence of ( NAT )) holds (for R15 being DecoratedTree holds (for R16 being DecoratedTree holds (R5 in ( dom R15 ) implies (for R6 being (FinSequence of ( NAT )) holds ((R6 in ( dom ( R15 with-replacement (R5 , R16) ) ) & R6 in { ( R5 ^ B111 ) where B111 is (Element of ( dom R16 )) : B111 = B111 }) implies (ex B112 being (Element of ( dom R16 )) st (R6 = ( R5 ^ B112 ) & ( ( R15 with-replacement (R5 , R16) ) . R6 ) = ( R16 . B112 )))))))))
proof
let R5 being (FinSequence of ( NAT ));
let R15 being DecoratedTree;
let R16 being DecoratedTree;
assume L370: R5 in ( dom R15 );
let R6 being (FinSequence of ( NAT ));
assume that
L371: R6 in ( dom ( R15 with-replacement (R5 , R16) ) )
and
L372: R6 in { ( R5 ^ B113 ) where B113 is (Element of ( dom R16 )) : B113 = B113 };
per cases  by L370 , L371 , L312;
suppose L373: ((not R5 is_a_prefix_of R6) & ( ( R15 with-replacement (R5 , R16) ) . R6 ) = ( R15 . R6 ));

L374: (ex B114 being (Element of ( dom R16 )) st (R6 = ( R5 ^ B114 ) & B114 = B114)) by L372;
thus L375: thesis by L374 , L373 , TREES_1:1;
end;
suppose L376: (ex R7 being (FinSequence of ( NAT )) st (R7 in ( dom R16 ) & R6 = ( R5 ^ R7 ) & ( ( R15 with-replacement (R5 , R16) ) . R6 ) = ( R16 . R7 )));

thus L377: thesis by L376;
end;
end;
theorem
L379: (for R15 being DecoratedTree holds (for R16 being DecoratedTree holds (for R18 being (Element of ( dom R15 )) holds ( tree (R15 , { R18 } , R16) ) = ( R15 with-replacement (R18 , R16) ))))
proof
let R15 being DecoratedTree;
let R16 being DecoratedTree;
let R18 being (Element of ( dom R15 ));
L380: ( dom ( tree (R15 , { R18 } , R16) ) ) = ( tree (( dom R15 ) , { R18 } , ( dom R16 )) ) by L281
.= ( ( dom R15 ) with-replacement (R18 , ( dom R16 )) ) by L262
.= ( dom ( R15 with-replacement (R18 , R16) ) ) by TREES_2:def 11;
L381: (for R6 being (FinSequence of ( NAT )) holds (R6 in ( dom ( tree (R15 , { R18 } , R16) ) ) implies ( ( tree (R15 , { R18 } , R16) ) . R6 ) = ( ( R15 with-replacement (R18 , R16) ) . R6 )))
proof
let R6 being (FinSequence of ( NAT ));
assume L382: R6 in ( dom ( tree (R15 , { R18 } , R16) ) );
L383: R6 in ( tree (( dom R15 ) , { R18 } , ( dom R16 )) ) by L382 , L281;
L384: ( tree (( dom R15 ) , { R18 } , ( dom R16 )) ) = ( { B115 where B115 is (Element of ( dom R15 )) : (for R5 being (FinSequence of ( NAT )) holds (R5 in { R18 } implies (not R5 is_a_prefix_of B115))) } \/ { ( B116 ^ B117 ) where B116 is (Element of ( dom R15 )) , B117 is (Element of ( dom R16 )) : B116 in { R18 } } ) by L214;
per cases  by L383 , L384 , XBOOLE_0:def 3;
suppose L385: R6 in { B118 where B118 is (Element of ( dom R15 )) : (for R5 being (FinSequence of ( NAT )) holds (R5 in { R18 } implies (not R5 is_a_prefix_of B118))) };

consider C43 being (Element of ( dom R15 )) such that L386: R6 = C43 and L387: (for R5 being (FinSequence of ( NAT )) holds (R5 in { R18 } implies (not R5 is_a_prefix_of C43))) by L385;
consider R5 being (FinSequence of ( NAT )) such that L388: R5 = R18;
L389: R5 in { R18 } by L388 , TARSKI:def 1;
L390: (not R5 is_a_prefix_of C43) by L389 , L387;
L391: ((R6 in ( dom ( R15 with-replacement (R18 , R16) ) ) & R6 in { B119 where B119 is (Element of ( dom R15 )) : (not R5 is_a_prefix_of B119) }) implies ( ( R15 with-replacement (R18 , R16) ) . R6 ) = ( R15 . R6 )) by L388 , L335;
thus L392: thesis by L391 , L380 , L382 , L385 , L386 , L390 , L317;
end;
suppose L393: R6 in { ( B120 ^ B121 ) where B120 is (Element of ( dom R15 )) , B121 is (Element of ( dom R16 )) : B120 in { R18 } };

consider C44 being (Element of ( dom R15 )), C45 being (Element of ( dom R16 )) such that L394: R6 = ( C44 ^ C45 ) and L395: C44 in { R18 } by L393;
L396: R6 in { ( C44 ^ B122 ) where B122 is (Element of ( dom R16 )) : B122 = B122 } by L394;
consider C46 being (Element of ( dom R15 )), C47 being (Element of ( dom R16 )) such that L397: R6 = ( C46 ^ C47 ) and L398: C46 in { R18 } and L399: ( ( tree (R15 , { R18 } , R16) ) . R6 ) = ( R16 . C47 ) by L382 , L393 , L345;
L400: C46 = R18 by L398 , TARSKI:def 1;
L401: C44 = R18 by L395 , TARSKI:def 1;
L402: (ex B123 being (Element of ( dom R16 )) st (R6 = ( C44 ^ B123 ) & ( ( R15 with-replacement (C44 , R16) ) . R6 ) = ( R16 . B123 ))) by L401 , L380 , L382 , L396 , L369;
thus L403: thesis by L402 , L397 , L399 , L400 , L401 , FINSEQ_1:33;
end;
end;
thus L405: thesis by L381 , L380 , TREES_2:31;
end;
definition
let R23 being non  empty set;
let R24 being (DecoratedTree of R23);
let R26 being (AntiChain_of_Prefixes of ( dom R24 ));
let R25 being (DecoratedTree of R23);
assume L406: R26 <> ( {} );
func tree (R24 , R26 , R25) -> (DecoratedTree of R23) equals 
( tree (R24 , R26 , R25) );
coherence
proof
set D27 = ( tree (R24 , R26 , R25) );
L407: D27 is R23 -valued
proof
let C48 being set;
assume L408: C48 in ( rng D27 );
consider C49 being set such that L409: C49 in ( dom D27 ) and L410: C48 = ( D27 . C49 ) by L408 , FUNCT_1:def 3;
L411: C49 is (Element of ( dom D27 )) by L409;
reconsider D28 = C49 as (FinSequence of ( NAT )) by L411;
L412: ( dom D27 ) = ( tree (( dom R24 ) , R26 , ( dom R25 )) ) by L406 , L281;
L413: ( dom D27 ) = ( { B124 where B124 is (Element of ( dom R24 )) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R26 implies (not R5 is_a_prefix_of B124))) } \/ { ( B125 ^ B126 ) where B125 is (Element of ( dom R24 )) , B126 is (Element of ( dom R25 )) : B125 in R26 } ) by L412 , L406 , L214;
per cases  by L409 , L413 , XBOOLE_0:def 3;
suppose L414: D28 in { B127 where B127 is (Element of ( dom R24 )) : (for R5 being (FinSequence of ( NAT )) holds (R5 in R26 implies (not R5 is_a_prefix_of B127))) };

L415: ( ( tree (R24 , R26 , R25) ) . D28 ) = ( R24 . D28 ) by L414 , L406 , L409 , L317;
L416:
now
L417: (ex B128 being (Element of ( dom R24 )) st (D28 = B128 & (for R5 being (FinSequence of ( NAT )) holds (R5 in R26 implies (not R5 is_a_prefix_of B128))))) by L414;
thus L418: D28 in ( dom R24 ) by L417;
end;
L419: C48 in ( rng R24 ) by L416 , L410 , L415 , FUNCT_1:def 3;
L420: ( rng R24 ) c= R23 by RELAT_1:def 19;
thus L421: thesis by L420 , L419;
end;
suppose L422: D28 in { ( B129 ^ B130 ) where B129 is (Element of ( dom R24 )) , B130 is (Element of ( dom R25 )) : B129 in R26 };

L423: (ex B131 being (Element of ( dom R24 )) st (ex B132 being (Element of ( dom R25 )) st (D28 = ( B131 ^ B132 ) & B131 in R26 & ( ( tree (R24 , R26 , R25) ) . D28 ) = ( R25 . B132 )))) by L422 , L409 , L345;
thus L424: thesis by L423 , L410;
end;
end;
thus L426: thesis by L407;
end;
end;
