:: On the Representation of Natural Numbers in Positional Numeral Systems
::  by Adam Naumowicz
::
:: Received December 31, 2006
:: Copyright (c) 2006-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, SUBSET_1, FUNCT_1, NAT_1, TARSKI, RELAT_1, AFINSQ_1,
      ARYTM_1, ARYTM_3, FINSEQ_1, XXREAL_0, CARD_1, XBOOLE_0, ORDINAL4, CARD_3,
      FINSOP_1, BINOP_2, INT_1, SERIES_1, VALUED_1, PREPOWER, NEWTON, POWER,
      NUMERAL1;
 notations TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, RELAT_1, FUNCT_1, ORDINAL1,
      XXREAL_0, AFINSQ_1, VALUED_1, RELSET_1, FUNCT_2, BINOP_1, BINOP_2,
      RECDEF_1, SERIES_1, NEWTON, PREPOWER, POWER, AFINSQ_2, NAT_D;
 constructors PREPOWER, SERIES_1, PARTFUN3, BINOM, SETWISEO, REAL_1, NAT_D,
      RECDEF_1, BINOP_2, RELSET_1, SEQ_1, AFINSQ_2, BINOP_1;
 registrations XBOOLE_0, RELAT_1, ORDINAL1, XXREAL_0, XREAL_0, NAT_1, CARD_1,
      NUMBERS, INT_1, BINOP_2, MEMBERED, NEWTON, AFINSQ_1, VALUED_1, FUNCT_2,
      POWER, FINSET_1, AFINSQ_2, RELSET_1, VALUED_0, FUNCT_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI;
 theorems TARSKI, FUNCT_1, NAT_1, RELAT_1, ORDINAL1, CARD_1, XREAL_1, XXREAL_0,
      AFINSQ_2, AFINSQ_1, FUNCT_2, NAT_2, INT_1, NEWTON, BINOP_2, SERIES_1,
      SEQ_1, PREPOWER, POWER, XCMPLX_1, PEPIN, PRE_FF, NAT_D;
 schemes NAT_1, AFINSQ_2, AFINSQ_1, STIRL2_1;

begin
theorem
L1: (for B1 , B2 , B3 being Nat holds ( ( B1 (#) ( B2 GeoSeq ) ) | B3 ) is (XFinSequence of ( NAT )))
proof
let C1 , C2 , C3 being Nat;
set D1 = ( ( C1 (#) ( C2 GeoSeq ) ) | C3 );
L2: ( dom ( C1 (#) ( C2 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L3: C3 in ( dom ( C1 (#) ( C2 GeoSeq ) ) ) by L2 , ORDINAL1:def 12;
L4: C3 c= ( dom ( C1 (#) ( C2 GeoSeq ) ) ) by L3 , L2 , ORDINAL1:def 2;
L5: ( dom D1 ) = C3 by L4 , RELAT_1:62;
reconsider D2 = D1 as XFinSequence by L5 , ORDINAL1:def 7;
L6: ( rng D2 ) c= ( NAT )
proof
let C4 being set;
assume L7: C4 in ( rng D2 );
consider C5 being set such that L8: C5 in ( dom D1 ) and L9: C4 = ( D1 . C5 ) by L7 , FUNCT_1:def 3;
L10: C5 in ( dom ( C1 (#) ( C2 GeoSeq ) ) ) by L8 , RELAT_1:57;
reconsider D3 = C5 as (Element of ( NAT )) by L10;
L11: ( D1 . D3 ) = ( ( C1 (#) ( C2 GeoSeq ) ) . D3 ) by L8 , FUNCT_1:47
.= ( C1 * ( ( C2 GeoSeq ) . D3 ) ) by SEQ_1:9
.= ( C1 * ( C2 |^ D3 ) ) by PREPOWER:def 1;
thus L12: thesis by L11 , L9;
end;
thus L13: thesis by L6 , RELAT_1:def 19;
end;
theorem
L14: (for B4 being (XFinSequence of ( NAT )) holds (for B5 being Nat holds ((for B6 being Nat holds (B6 in ( dom B4 ) implies B5 divides ( B4 . B6 ))) implies B5 divides ( Sum B4 ))))
proof
let C6 being (XFinSequence of ( NAT ));
let C7 being Nat;
assume that
L15: (for B7 being Nat holds (B7 in ( dom C6 ) implies C7 divides ( C6 . B7 )));
per cases ;
suppose L16: ( len C6 ) = ( 0 );

L17: C6 = ( {} ) by L16;
L18: ( Sum C6 ) = ( 0 ) by L17;
thus L19: thesis by L18 , NAT_D:6;
end;
suppose L20: ( len C6 ) > ( 0 );

consider C8 being (Function of ( NAT ) , ( NAT )) such that L21: ( C8 . ( 0 ) ) = ( C6 . ( 0 ) ) and L22: (for B8 being Nat holds (( B8 + 1 ) < ( len C6 ) implies ( C8 . ( B8 + 1 ) ) = ( ( addnat ) . (( C8 . B8 ) , ( C6 . ( B8 + 1 ) )) ))) and L23: ( ( addnat ) "**" C6 ) = ( C8 . ( ( len C6 ) - 1 ) ) by L20 , AFINSQ_2:def 8;
defpred S1[ (Element of ( NAT )) ] means ($1 < ( len C6 ) implies C7 divides ( C8 . $1 ));
L24:
now
let C9 being (Element of ( NAT ));
assume L25: S1[ C9 ];
thus L26: S1[ ( C9 + 1 ) ]
proof
assume L27: ( C9 + 1 ) < ( len C6 );
L28: ( C9 + 1 ) in ( len C6 ) by L27 , NAT_1:44;
L29: C7 divides ( C6 . ( C9 + 1 ) ) by L28 , L15;
L30: ( C8 . ( C9 + 1 ) ) = ( ( addnat ) . (( C8 . C9 ) , ( C6 . ( C9 + 1 ) )) ) by L22 , L27
.= ( ( C8 . C9 ) + ( C6 . ( C9 + 1 ) ) ) by BINOP_2:def 23;
thus L31: thesis by L30 , L25 , L27 , L29 , NAT_1:13 , NAT_D:8;
end;

end;
reconsider D4 = ( ( len C6 ) - 1 ) as (Element of ( NAT )) by L20 , NAT_1:20;
L27: D4 < ( len C6 ) by XREAL_1:147;
L28: ( 0 ) in ( len C6 ) by L20 , NAT_1:44;
L29: S1[ ( 0 ) ] by L28 , L15 , L21;
L30: ( ( addnat ) "**" C6 ) = ( Sum C6 ) by AFINSQ_2:51;
L31: (for B9 being (Element of ( NAT )) holds S1[ B9 ]) from NAT_1:sch 1(L29 , L24);
thus L32: thesis by L31 , L23 , L27 , L30;
end;
end;
theorem
L34: (for B10 , B11 being (XFinSequence of ( NAT )) holds (for B12 being Nat holds ((( dom B10 ) = ( dom B11 ) & (for B13 being Nat holds (B13 in ( dom B10 ) implies ( B11 . B13 ) = ( ( B10 . B13 ) mod B12 )))) implies ( ( Sum B10 ) mod B12 ) = ( ( Sum B11 ) mod B12 ))))
proof
let C10 , C11 being (XFinSequence of ( NAT ));
let C12 being Nat;
assume that
L35: (( dom C10 ) = ( dom C11 ) & (for B14 being Nat holds (B14 in ( dom C10 ) implies ( C11 . B14 ) = ( ( C10 . B14 ) mod C12 ))));
defpred S2[ (XFinSequence of ( NAT )) ] means (for B15 being (XFinSequence of ( NAT )) holds ((( dom $1 ) = ( dom B15 ) & (for B16 being Nat holds (B16 in ( dom $1 ) implies ( B15 . B16 ) = ( ( $1 . B16 ) mod C12 )))) implies ( ( Sum $1 ) mod C12 ) = ( ( Sum B15 ) mod C12 )));
L36: (for B17 being (XFinSequence of ( NAT )) holds (for B18 being (Element of ( NAT )) holds (S2[ B17 ] implies S2[ ( B17 ^ <% B18 %> ) ])))
proof
let C13 being (XFinSequence of ( NAT ));
let C14 being (Element of ( NAT ));
assume L37: S2[ C13 ];
thus L38: S2[ ( C13 ^ <% C14 %> ) ]
proof
reconsider D5 = ( dom C13 ) as (Element of ( NAT )) by ORDINAL1:def 12;
defpred S3[ set , set ] means $2 = ( ( C13 . $1 ) mod C12 );
let C15 being (XFinSequence of ( NAT ));
assume that
L39: ( dom ( C13 ^ <% C14 %> ) ) = ( dom C15 )
and
L40: (for B19 being Nat holds (B19 in ( dom ( C13 ^ <% C14 %> ) ) implies ( C15 . B19 ) = ( ( ( C13 ^ <% C14 %> ) . B19 ) mod C12 )));
L41: (for B20 being Nat holds (B20 in D5 implies (ex B21 being (Element of ( NAT )) st S3[ B20 , B21 ])));
consider C16 being (XFinSequence of ( NAT )) such that L42: (( dom C16 ) = D5 & (for B22 being Nat holds (B22 in D5 implies S3[ B22 , ( C16 . B22 ) ]))) from STIRL2_1:sch 5(L41);
L43:
now
let C17 being Nat;
assume L44: C17 in ( dom C16 );
L45: C17 < ( dom C16 ) by L44 , NAT_1:44;
L46: C17 < ( ( len C13 ) + 1 ) by L45 , L42 , NAT_1:13;
L47: C17 < ( ( len C13 ) + ( len <% C14 %> ) ) by L46 , AFINSQ_1:33;
L48: C17 in ( ( len C13 ) + ( len <% C14 %> ) ) by L47 , NAT_1:44;
L49: C17 in ( dom ( C13 ^ <% C14 %> ) ) by L48 , AFINSQ_1:def 3;
thus L50: ( C15 . C17 ) = ( ( ( C13 ^ <% C14 %> ) . C17 ) mod C12 ) by L49 , L40
.= ( ( C13 . C17 ) mod C12 ) by L42 , L44 , AFINSQ_1:def 3
.= ( C16 . C17 ) by L42 , L44;
end;
L51:
now
let C18 being Nat;
assume L52: C18 in ( dom <% ( C14 mod C12 ) %> );
L53: C18 in 1 by L52 , AFINSQ_1:33;
L54: C18 < 1 by L53 , NAT_1:44;
L55: C18 = ( 0 ) by L54 , NAT_1:14;
L56: C18 in ( dom <% C14 %> ) by L53 , AFINSQ_1:33;
thus L57: ( C15 . ( ( len C16 ) + C18 ) ) = ( ( ( C13 ^ <% C14 %> ) . ( len C13 ) ) mod C12 ) by L56 , L40 , L42 , L55 , AFINSQ_1:23
.= ( C14 mod C12 ) by AFINSQ_1:36
.= ( <% ( C14 mod C12 ) %> . C18 ) by L55 , AFINSQ_1:34;
end;
L58: ( dom C15 ) = ( ( len C13 ) + ( len <% C14 %> ) ) by L39 , AFINSQ_1:def 3
.= ( ( dom C13 ) + 1 ) by AFINSQ_1:33
.= ( ( len C16 ) + ( len <% ( C14 mod C12 ) %> ) ) by L42 , AFINSQ_1:33;
L59: C15 = ( C16 ^ <% ( C14 mod C12 ) %> ) by L58 , L43 , L51 , AFINSQ_1:def 3;
thus L60: ( ( Sum ( C13 ^ <% C14 %> ) ) mod C12 ) = ( ( ( Sum C13 ) + ( Sum <% C14 %> ) ) mod C12 ) by AFINSQ_2:55
.= ( ( ( Sum C13 ) + C14 ) mod C12 ) by AFINSQ_2:53
.= ( ( ( ( Sum C13 ) mod C12 ) + C14 ) mod C12 ) by NAT_D:22
.= ( ( ( ( Sum C13 ) mod C12 ) + ( C14 mod C12 ) ) mod C12 ) by NAT_D:23
.= ( ( ( ( Sum C16 ) mod C12 ) + ( C14 mod C12 ) ) mod C12 ) by L37 , L42
.= ( ( ( Sum C16 ) + ( C14 mod C12 ) ) mod C12 ) by NAT_D:22
.= ( ( ( Sum C16 ) + ( Sum <% ( C14 mod C12 ) %> ) ) mod C12 ) by AFINSQ_2:53
.= ( ( Sum C15 ) mod C12 ) by L59 , AFINSQ_2:55;
end;

end;
L39: S2[ ( <%> ( NAT ) ) ]
proof
let C19 being (XFinSequence of ( NAT ));
assume that
L40: ( dom ( <%> ( NAT ) ) ) = ( dom C19 )
and
L41: (for B23 being Nat holds (B23 in ( dom ( <%> ( NAT ) ) ) implies ( C19 . B23 ) = ( ( ( <%> ( NAT ) ) . B23 ) mod C12 )));
L42: ( len C19 ) = ( 0 ) by L40;
thus L43: thesis by L42 , AFINSQ_1:15;
end;
L44: (for B24 being (XFinSequence of ( NAT )) holds S2[ B24 ]) from AFINSQ_2:sch 2(L39 , L36);
thus L45: thesis by L44 , L35;
end;
begin
definition
let C20 being (XFinSequence of ( NAT ));
let C21 being Nat;
func value (C20 , C21) -> Nat means 
:L46: (ex B25 being (XFinSequence of ( NAT )) st (( dom B25 ) = ( dom C20 ) & (for B26 being Nat holds (B26 in ( dom B25 ) implies ( B25 . B26 ) = ( ( C20 . B26 ) * ( C21 |^ B26 ) ))) & it = ( Sum B25 )));
existence
proof
deffunc H1(Nat) = ( ( C20 . $1 ) * ( C21 |^ $1 ) );
consider C22 being XFinSequence such that L47: (( len C22 ) = ( len C20 ) & (for B27 being Nat holds (B27 in ( len C20 ) implies ( C22 . B27 ) = H1(B27)))) from AFINSQ_1:sch 2;
L48: ( rng C22 ) c= ( NAT )
proof
let C23 being set;
assume L49: C23 in ( rng C22 );
consider C24 being set such that L50: C24 in ( dom C22 ) and L51: ( C22 . C24 ) = C23 by L49 , FUNCT_1:def 3;
reconsider D6 = C24 as (Element of ( NAT )) by L50;
L52: C23 = H1(D6) by L47 , L50 , L51;
thus L53: thesis by L52;
end;
reconsider D7 = C22 as (XFinSequence of ( NAT )) by L48 , RELAT_1:def 19;
take ( Sum D7 );
thus L54: thesis by L47;
end;
uniqueness
proof
let C25 , C26 being Nat;
given C27 being (XFinSequence of ( NAT )) such that
L55: ( dom C27 ) = ( dom C20 )
and
L56: (for B28 being Nat holds (B28 in ( dom C27 ) implies ( C27 . B28 ) = ( ( C20 . B28 ) * ( C21 |^ B28 ) )))
and
L57: C25 = ( Sum C27 );

given C28 being (XFinSequence of ( NAT )) such that
L58: ( dom C28 ) = ( dom C20 )
and
L59: (for B29 being Nat holds (B29 in ( dom C28 ) implies ( C28 . B29 ) = ( ( C20 . B29 ) * ( C21 |^ B29 ) )))
and
L60: C26 = ( Sum C28 );

L61:
now
let C29 being Nat;
assume L62: C29 in ( dom C20 );
thus L63: ( C27 . C29 ) = ( ( C20 . C29 ) * ( C21 |^ C29 ) ) by L62 , L55 , L56
.= ( C28 . C29 ) by L58 , L59 , L62;
end;
thus L64: thesis by L61 , L55 , L57 , L58 , L60 , AFINSQ_1:8;
end;
end;
definition
let C30 , C31 being Nat;
assume L66: C31 > 1;
::$N Unique Representation of Natural Numbers in Positional Numeral Systems
func digits (C30 , C31) -> (XFinSequence of ( NAT )) means 
:L67: (( value (it , C31) ) = C30 & ( it . ( ( len it ) - 1 ) ) <> ( 0 ) & (for B30 being Nat holds (B30 in ( dom it ) implies (( 0 ) <= ( it . B30 ) & ( it . B30 ) < C31)))) if C30 <> ( 0 ) otherwise it = <% ( 0 ) %>;
consistency;
existence
proof
reconsider D8 = <% ( 0 ) %> as (XFinSequence of ( NAT ));
reconsider D9 = C30 , D10 = C31 as (Element of ( NAT )) by ORDINAL1:def 12;
thus L68: (C30 <> ( 0 ) implies (ex B31 being (XFinSequence of ( NAT )) st (( value (B31 , C31) ) = C30 & ( B31 . ( ( len B31 ) - 1 ) ) <> ( 0 ) & (for B32 being Nat holds (B32 in ( dom B31 ) implies (( 0 ) <= ( B31 . B32 ) & ( B31 . B32 ) < C31))))))
proof
deffunc H2(Nat , (Element of ( NAT ))) = ( $2 div D10 );
consider C32 being (Function of ( NAT ) , ( NAT )) such that L69: (( C32 . ( 0 ) ) = D9 & (for B33 being Nat holds ( C32 . ( B33 + 1 ) ) = H2(B33 , (( C32 . B33 ) qua (Element of ( NAT )))))) from NAT_1:sch 12;
defpred S4[ Nat ] means ( C32 . $1 ) = ( 0 );
defpred S5[ Nat ] means (ex B34 being (Element of ( NAT )) st ( C32 . B34 ) = $1);
L70: (for B35 being Nat holds ((B35 <> ( 0 ) & S5[ B35 ]) implies (ex B36 being Nat st (B36 < B35 & S5[ B36 ]))))
proof
let C33 being Nat;
assume that
L71: C33 <> ( 0 )
and
L72: S5[ C33 ];
take D11 = ( C33 div C31 );
thus L73: D11 < C33 by L66 , L71 , INT_1:56;
consider C34 being (Element of ( NAT )) such that L74: ( C32 . C34 ) = C33 by L72;
take ( C34 + 1 );
thus L75: thesis by L69 , L74;
end;
L76: (ex B37 being Nat st S5[ B37 ]) by L69;
L77: S5[ ( 0 ) ] from NAT_1:sch 7(L76 , L70);
L78: (ex B38 being Nat st S4[ B38 ]) by L77;
consider C35 being Nat such that L79: (S4[ C35 ] & (for B39 being Nat holds (S4[ B39 ] implies C35 <= B39))) from NAT_1:sch 5(L78);
assume L80: C30 <> ( 0 );
consider C36 being Nat such that L81: ( C36 + 1 ) = C35 by L80 , L69 , L79 , NAT_1:6;
reconsider D12 = C36 as (Element of ( NAT )) by ORDINAL1:def 12;
L82: ( dom C32 ) = ( NAT ) by FUNCT_2:def 1;
L83: ( D12 + 1 ) c= ( dom C32 ) by L82 , ORDINAL1:def 2;
L84: ( dom ( C32 | ( D12 + 1 ) ) ) = ( D12 + 1 ) by L83 , RELAT_1:62;
reconsider D13 = ( C32 | ( D12 + 1 ) ) as (XFinSequence of ( NAT )) by L84 , ORDINAL1:def 7;
defpred S6[ Nat , Nat ] means $2 = ( ( D13 . $1 ) mod C31 );
L85: (for B40 being Nat holds (B40 in ( D12 + 1 ) implies (ex B41 being (Element of ( NAT )) st S6[ B40 , B41 ])));
consider C37 being (XFinSequence of ( NAT )) such that L86: (( dom C37 ) = ( D12 + 1 ) & (for B42 being Nat holds (B42 in ( D12 + 1 ) implies S6[ B42 , ( C37 . B42 ) ]))) from STIRL2_1:sch 5(L85);
L87:
now
let C38 being Nat;
assume that
L88: C35 <= C38;
assume L89: S4[ C38 ];
L90: ( C32 . ( C38 + 1 ) ) = ( ( 0 ) div C31 ) by L89 , L69;
thus L91: S4[ ( C38 + 1 ) ] by L90 , NAT_2:2;
end;
L92: S4[ C35 ] by L79;
L93: (for B43 being Nat holds (C35 <= B43 implies S4[ B43 ])) from NAT_1:sch 8(L92 , L87);
L94:
now
let C39 being (Element of ( NAT ));
assume L95: D12 < C39;
L96: C35 <= C39 by L95 , L81 , NAT_1:13;
thus L97: ( C32 . C39 ) = ( 0 ) by L96 , L93;
end;
deffunc H3(Nat) = ( ( C37 . $1 ) * ( C31 |^ $1 ) );
consider C40 being XFinSequence such that L98: (( len C40 ) = ( len C37 ) & (for B44 being Nat holds (B44 in ( len C37 ) implies ( C40 . B44 ) = H3(B44)))) from AFINSQ_1:sch 2;
L99: ( rng C40 ) c= ( NAT )
proof
let C41 being set;
assume L100: C41 in ( rng C40 );
consider C42 being set such that L101: C42 in ( dom C40 ) and L102: ( C40 . C42 ) = C41 by L100 , FUNCT_1:def 3;
reconsider D14 = C42 as (Element of ( NAT )) by L101;
L103: C41 = H3(D14) by L98 , L101 , L102;
thus L104: thesis by L103;
end;
reconsider D15 = C40 as (XFinSequence of ( NAT )) by L99 , RELAT_1:def 19;
consider C43 being (Function of ( NAT ) , ( NAT )) such that L105: ( C43 . ( 0 ) ) = ( D15 . ( 0 ) ) and L106: (for B45 being Nat holds (( B45 + 1 ) < ( len D15 ) implies ( C43 . ( B45 + 1 ) ) = ( ( addnat ) . (( C43 . B45 ) , ( D15 . ( B45 + 1 ) )) ))) and L107: ( ( addnat ) "**" D15 ) = ( C43 . ( ( len D15 ) - 1 ) ) by L86 , L98 , AFINSQ_2:def 8;
defpred S7[ (Element of ( NAT )) ] means ($1 < ( len D15 ) implies ( C43 . $1 ) = ( C30 - ( ( C32 . ( $1 + 1 ) ) * ( C31 |^ ( $1 + 1 ) ) ) ));
L108:
now
let C44 being (Element of ( NAT ));
assume L109: S7[ C44 ];
L110:
now
assume L111: ( C44 + 1 ) < ( len D15 );
L112: ( C44 + 1 ) in ( dom D15 ) by L111 , NAT_1:44;
thus L113: ( C43 . ( C44 + 1 ) ) = ( ( addnat ) . (( C43 . C44 ) , ( D15 . ( C44 + 1 ) )) ) by L106 , L111
.= ( ( C30 - ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) + ( D15 . ( C44 + 1 ) ) ) by L109 , L111 , BINOP_2:def 23 , NAT_1:13
.= ( ( C30 - ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) + ( ( C37 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) by L98 , L112
.= ( ( C30 - ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) + ( ( ( D13 . ( C44 + 1 ) ) mod C31 ) * ( C31 |^ ( C44 + 1 ) ) ) ) by L86 , L98 , L112
.= ( ( C30 - ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) + ( ( ( C32 . ( C44 + 1 ) ) mod C31 ) * ( C31 |^ ( C44 + 1 ) ) ) ) by L86 , L98 , L112 , FUNCT_1:49
.= ( ( C30 - ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) + ( ( ( C32 . ( C44 + 1 ) ) - ( C31 * ( ( C32 . ( C44 + 1 ) ) div D10 ) ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) by L66 , NEWTON:63
.= ( ( C30 - ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) + ( ( ( C32 . ( C44 + 1 ) ) - ( C31 * ( C32 . ( ( C44 + 1 ) + 1 ) ) ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) by L69
.= ( ( C30 - ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) + ( ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) - ( ( C32 . ( ( C44 + 1 ) + 1 ) ) * ( C31 * ( C31 |^ ( C44 + 1 ) ) ) ) ) )
.= ( ( C30 - ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) ) + ( ( ( C32 . ( C44 + 1 ) ) * ( C31 |^ ( C44 + 1 ) ) ) - ( ( C32 . ( ( C44 + 1 ) + 1 ) ) * ( C31 |^ ( ( C44 + 1 ) + 1 ) ) ) ) ) by NEWTON:6
.= ( C30 - ( ( C32 . ( ( C44 + 1 ) + 1 ) ) * ( C31 |^ ( ( C44 + 1 ) + 1 ) ) ) );
end;
thus L114: S7[ ( C44 + 1 ) ] by L110;
end;
reconsider D16 = ( ( len D15 ) - 1 ) as (Element of ( NAT )) by L86 , L98;
L115: ( 0 ) in ( D12 + 1 ) by NAT_1:44;
L116: ( D15 . ( 0 ) ) = ( ( C37 . ( 0 ) ) * ( C31 |^ ( 0 ) ) ) by L115 , L86 , L98
.= ( ( ( D13 . ( 0 ) ) mod C31 ) * ( C31 |^ ( 0 ) ) ) by L86 , L115
.= ( ( ( C32 . ( 0 ) ) mod C31 ) * ( C31 |^ ( 0 ) ) ) by L115 , FUNCT_1:49
.= ( ( C30 mod C31 ) * 1 ) by L69 , NEWTON:4
.= ( D9 - ( D10 * ( D9 div D10 ) ) ) by L66 , NEWTON:63
.= ( C30 - ( ( C30 div C31 ) * ( C31 |^ 1 ) ) ) by NEWTON:5
.= ( C30 - ( ( C32 . ( (( 0 ) qua Nat) + 1 ) ) * ( C31 |^ ( (( 0 ) qua Nat) + 1 ) ) ) ) by L69;
L117: S7[ ( 0 ) ] by L116 , L105;
L118: (for B46 being (Element of ( NAT )) holds S7[ B46 ]) from NAT_1:sch 1(L117 , L108);
L119: ( C43 . D16 ) = ( C30 - ( ( C32 . ( D12 + 1 ) ) * ( C31 |^ ( D12 + 1 ) ) ) ) by L118 , L86 , L98 , XREAL_1:44
.= C30 by L79 , L81;
L120: C30 = ( Sum D15 ) by L119 , L107 , AFINSQ_2:51;
L121: D12 < C35 by L81 , NAT_1:13;
L122: ( C32 . D12 ) <> ( 0 ) by L121 , L79;
take C37;
thus L123: ( value (C37 , C31) ) = C30 by L98 , L120 , L46;
L124: ( D13 . D12 ) = ( C32 . D12 ) by FUNCT_1:49 , NAT_1:45;
L125: (D12 < ( D12 + 1 ) & ( C32 . ( D12 + 1 ) ) = ( ( D13 . D12 ) div C31 )) by L124 , L69 , NAT_1:13;
L126: ( ( D13 . D12 ) div C31 ) = ( 0 ) by L125 , L94;
L127: ( C37 . ( ( len C37 ) - 1 ) ) = ( ( D13 . D12 ) mod C31 ) by L86 , NAT_1:45
.= ( D13 . D12 ) by L66 , L126 , NAT_2:12 , NAT_D:24;
thus L128: ( C37 . ( ( len C37 ) - 1 ) ) <> ( 0 ) by L127 , L122 , FUNCT_1:49 , NAT_1:45;
let C45 being Nat;
assume L129: C45 in ( dom C37 );
L130: ( C37 . C45 ) = ( ( D13 . C45 ) mod C31 ) by L129 , L86;
thus L131: thesis by L130 , L66 , NAT_D:1;
end;

assume L132: C30 = ( 0 );
take D8;
thus L133: thesis;
end;
uniqueness
proof
reconsider D17 = ( C31 - 1 ) as (Element of ( NAT )) by L66 , NAT_1:20;
let C46 , C47 being (XFinSequence of ( NAT ));
thus L134: ((C30 <> ( 0 ) & ( value (C46 , C31) ) = C30 & ( C46 . ( ( len C46 ) - 1 ) ) <> ( 0 ) & (for B47 being Nat holds (B47 in ( dom C46 ) implies (( 0 ) <= ( C46 . B47 ) & ( C46 . B47 ) < C31))) & ( value (C47 , C31) ) = C30 & ( C47 . ( ( len C47 ) - 1 ) ) <> ( 0 ) & (for B48 being Nat holds (B48 in ( dom C47 ) implies (( 0 ) <= ( C47 . B48 ) & ( C47 . B48 ) < C31)))) implies C46 = C47)
proof
L135: ( log (2 , C31) ) > ( log (2 , 1) ) by L66 , POWER:57;
L136: ( log (2 , C31) ) > ( 0 ) by L135 , POWER:51;
L137: ( log (2 , C31) ) > ( log (2 , 1) ) by L66 , POWER:57;
L138: ( log (2 , C31) ) > ( 0 ) by L137 , POWER:51;
L139: ( 1 - C31 ) <> ( 0 ) by L66;
L140: ( 1 - C31 ) <> ( 0 ) by L66;
reconsider D18 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( len C46 ) ) as (XFinSequence of ( NAT )) by L1;
assume L141: C30 <> ( 0 );
assume that
L142: ( value (C46 , C31) ) = C30
and
L143: ( C46 . ( ( len C46 ) - 1 ) ) <> ( 0 )
and
L144: (for B49 being Nat holds (B49 in ( dom C46 ) implies (( 0 ) <= ( C46 . B49 ) & ( C46 . B49 ) < C31)));
consider C48 being (XFinSequence of ( NAT )) such that L145: ( dom C48 ) = ( dom C46 ) and L146: (for B50 being Nat holds (B50 in ( dom C48 ) implies ( C48 . B50 ) = ( ( C46 . B50 ) * ( C31 |^ B50 ) ))) and L147: C30 = ( Sum C48 ) by L142 , L46;
L148: ( len C48 ) > ( 0 ) by L143 , L145 , FUNCT_1:def 2;
L149: ( ( len C46 ) - 1 ) in ( dom C46 ) by L143 , FUNCT_1:def 2;
reconsider D19 = ( ( len C46 ) - 1 ) as (Element of ( NAT )) by L149;
L150: ( 1 * ( C31 |^ D19 ) ) <= ( ( C46 . D19 ) * ( C31 |^ D19 ) ) by L143 , NAT_1:4 , NAT_1:14;
L151: ( C31 |^ D19 ) > ( 0 ) by L66 , PREPOWER:6;
L152: ( C48 . D19 ) = ( ( C46 . D19 ) * ( C31 |^ D19 ) ) by L145 , L146 , L149;
L153: ( ( C46 . D19 ) * ( C31 |^ D19 ) ) <= C30 by L152 , L145 , L147 , L149 , L148 , AFINSQ_2:61;
L154: ( C31 |^ D19 ) <= C30 by L153 , L150 , XXREAL_0:2;
L155: ( log (2 , ( C31 to_power D19 )) ) <= ( log (2 , C30) ) by L154 , L151 , PRE_FF:10;
L156: ( D19 * ( log (2 , C31) ) ) <= ( log (2 , C30) ) by L155 , L66 , POWER:55;
L157: ( ( D19 * ( log (2 , C31) ) ) / ( log (2 , C31) ) ) <= ( ( log (2 , C30) ) / ( log (2 , C31) ) ) by L156 , L138 , XREAL_1:72;
L158: D19 <= ( ( log (2 , C30) ) / ( log (2 , C31) ) ) by L157 , L138 , XCMPLX_1:89;
L159: D18 = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) | ( D19 + 1 ) );
L160: ( Sum D18 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D19 ) by L159 , AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D19 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D19 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D19 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ ( D19 + 1 ) ) ) / ( 1 - C31 ) ) ) )
.= ( - ( 1 - ( C31 |^ ( D19 + 1 ) ) ) ) by L140 , XCMPLX_1:87
.= ( ( C31 |^ ( D19 + 1 ) ) - 1 );
L161: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L162: ( len C48 ) = ( len D18 ) by L161 , L145 , RELAT_1:62;
L163: ( len C46 ) c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L161 , ORDINAL1:def 2;
L164: ( dom D18 ) = ( len C46 ) by L163 , RELAT_1:62;
L165: (for B51 being Nat holds (B51 in ( dom C48 ) implies ( C48 . B51 ) <= ( D18 . B51 )))
proof
let C49 being Nat;
reconsider D20 = C49 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L166: C49 in ( dom C48 );
L167: ( C48 . C49 ) = ( ( C46 . C49 ) * ( C31 |^ C49 ) ) by L166 , L146;
L168: ( C46 . C49 ) < ( D17 + 1 ) by L144 , L145 , L166;
L169: ( C46 . C49 ) <= D17 by L168 , NAT_1:13;
L170: ( D18 . D20 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D20 ) by L145 , L164 , L166 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D20 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D20 ) ) by PREPOWER:def 1;
thus L171: thesis by L170 , L169 , L167 , XREAL_1:64;
end;
assume that
L172: ( value (C47 , C31) ) = C30
and
L173: ( C47 . ( ( len C47 ) - 1 ) ) <> ( 0 )
and
L174: (for B52 being Nat holds (B52 in ( dom C47 ) implies (( 0 ) <= ( C47 . B52 ) & ( C47 . B52 ) < C31)));
consider C50 being (XFinSequence of ( NAT )) such that L175: ( dom C50 ) = ( dom C47 ) and L176: (for B53 being Nat holds (B53 in ( dom C50 ) implies ( C50 . B53 ) = ( ( C47 . B53 ) * ( C31 |^ B53 ) ))) and L177: C30 = ( Sum C50 ) by L172 , L46;
L178: ( ( len C47 ) - 1 ) in ( dom C47 ) by L173 , FUNCT_1:def 2;
reconsider D21 = ( ( len C47 ) - 1 ) as (Element of ( NAT )) by L178;
L179: ( 1 * ( C31 |^ D21 ) ) <= ( ( C47 . D21 ) * ( C31 |^ D21 ) ) by L173 , NAT_1:4 , NAT_1:14;
reconsider D22 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( len C47 ) ) as (XFinSequence of ( NAT )) by L1;
L180: D22 = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) | ( D21 + 1 ) );
L181: ( Sum D22 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D21 ) by L180 , AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D21 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D21 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D21 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ ( D21 + 1 ) ) ) / ( 1 - C31 ) ) ) )
.= ( - ( 1 - ( C31 |^ ( D21 + 1 ) ) ) ) by L139 , XCMPLX_1:87
.= ( ( C31 |^ ( D21 + 1 ) ) - 1 );
L182: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L183: ( len C47 ) c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L182 , ORDINAL1:def 2;
L184: ( dom D22 ) = ( len C47 ) by L183 , RELAT_1:62;
L185: (for B54 being Nat holds (B54 in ( dom C50 ) implies ( C50 . B54 ) <= ( D22 . B54 )))
proof
let C51 being Nat;
reconsider D23 = C51 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L186: C51 in ( dom C50 );
L187: ( C50 . C51 ) = ( ( C47 . C51 ) * ( C31 |^ C51 ) ) by L186 , L176;
L188: ( C47 . C51 ) < ( D17 + 1 ) by L174 , L175 , L186;
L189: ( C47 . C51 ) <= D17 by L188 , NAT_1:13;
L190: ( D22 . D23 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D23 ) by L175 , L184 , L186 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D23 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D23 ) ) by PREPOWER:def 1;
thus L191: thesis by L190 , L189 , L187 , XREAL_1:64;
end;
L192: ( len C50 ) > ( 0 ) by L173 , L175 , FUNCT_1:def 2;
L193: ( C31 |^ D21 ) > ( 0 ) by L66 , PREPOWER:6;
L194: ( C50 . D21 ) = ( ( C47 . D21 ) * ( C31 |^ D21 ) ) by L175 , L176 , L178;
L195: ( ( C47 . D21 ) * ( C31 |^ D21 ) ) <= C30 by L194 , L175 , L177 , L178 , L192 , AFINSQ_2:61;
L196: ( C31 |^ D21 ) <= C30 by L195 , L179 , XXREAL_0:2;
L197: ( log (2 , ( C31 to_power D21 )) ) <= ( log (2 , C30) ) by L196 , L193 , PRE_FF:10;
L198: ( D21 * ( log (2 , C31) ) ) <= ( log (2 , C30) ) by L197 , L66 , POWER:55;
L199: ( ( D21 * ( log (2 , C31) ) ) / ( log (2 , C31) ) ) <= ( ( log (2 , C30) ) / ( log (2 , C31) ) ) by L198 , L136 , XREAL_1:72;
L200: D21 <= ( ( log (2 , C30) ) / ( log (2 , C31) ) ) by L199 , L136 , XCMPLX_1:89;
L201: ( len C50 ) = ( len D22 ) by L175 , L182 , RELAT_1:62;
L202: C30 < ( ( ( C31 |^ ( D21 + 1 ) ) - 1 ) + 1 ) by L201 , L177 , L181 , L185 , AFINSQ_2:57 , XREAL_1:39;
L203: ( log (2 , C30) ) < ( log (2 , ( C31 to_power ( D21 + 1 ) )) ) by L202 , L141 , POWER:57;
L204: ( log (2 , C30) ) < ( ( D21 + 1 ) * ( log (2 , C31) ) ) by L203 , L66 , POWER:55;
L205: ( ( log (2 , C30) ) / ( log (2 , C31) ) ) < ( ( ( D21 + 1 ) * ( log (2 , C31) ) ) / ( log (2 , C31) ) ) by L204 , L136 , XREAL_1:74;
L206: ( ( log (2 , C30) ) / ( log (2 , C31) ) ) < ( D21 + 1 ) by L205 , L136 , XCMPLX_1:89;
L207: D19 < ( D21 + 1 ) by L206 , L158 , XXREAL_0:2;
L208: D19 <= D21 by L207 , NAT_1:13;
L209: C30 < ( ( ( C31 |^ ( D19 + 1 ) ) - 1 ) + 1 ) by L147 , L160 , L162 , L165 , AFINSQ_2:57 , XREAL_1:39;
L210: ( log (2 , C30) ) < ( log (2 , ( C31 to_power ( D19 + 1 ) )) ) by L209 , L141 , POWER:57;
L211: ( log (2 , C30) ) < ( ( D19 + 1 ) * ( log (2 , C31) ) ) by L210 , L66 , POWER:55;
L212: ( ( log (2 , C30) ) / ( log (2 , C31) ) ) < ( ( ( D19 + 1 ) * ( log (2 , C31) ) ) / ( log (2 , C31) ) ) by L211 , L138 , XREAL_1:74;
L213: ( ( log (2 , C30) ) / ( log (2 , C31) ) ) < ( D19 + 1 ) by L212 , L138 , XCMPLX_1:89;
L214: D21 < ( D19 + 1 ) by L213 , L200 , XXREAL_0:2;
L215: D21 <= D19 by L214 , NAT_1:13;
L216: D19 = D21 by L215 , L208 , XXREAL_0:1;
L217:
now
let C52 being set;
assume L218: C52 in ( dom C46 );
reconsider D24 = C52 as (Element of ( NAT )) by L218;
L219: D24 < ( D19 + 1 ) by L218 , NAT_1:44;
L220: D24 <= D19 by L219 , NAT_1:13;
L221: D24 < ( len C46 ) by L218 , NAT_1:44;
reconsider D25 = ( ( len C46 ) - D24 ) as (Element of ( NAT )) by L221 , NAT_1:21;
per cases  by L220 , XXREAL_0:1;
suppose L222: (D24 = ( 0 ) & D24 = D19);

L223: ( len C50 ) = 1 by L222 , L175 , L216;
L224: C50 = <% ( C50 . ( 0 ) ) %> by L223 , AFINSQ_1:34
.= <% ( ( C47 . ( 0 ) ) * ( C31 |^ ( 0 ) ) ) %> by L175 , L176 , L216 , L218 , L222
.= <% ( ( C47 . ( 0 ) ) * 1 ) %> by NEWTON:4;
L225: ( len C48 ) = 1 by L145 , L222;
L226: C48 = <% ( C48 . ( 0 ) ) %> by L225 , AFINSQ_1:34
.= <% ( ( C46 . ( 0 ) ) * ( C31 |^ ( 0 ) ) ) %> by L145 , L146 , L218 , L222
.= <% ( ( C46 . ( 0 ) ) * 1 ) %> by NEWTON:4;
thus L227: ( C46 . C52 ) = C30 by L226 , L147 , L222 , AFINSQ_2:53
.= ( C47 . C52 ) by L177 , L222 , L224 , AFINSQ_2:53;
end;
suppose L228: (D24 = ( 0 ) & D24 < D19);

reconsider D26 = ( <%> ( NAT ) ) as (XFinSequence of ( NAT ));
L229: ( len D26 ) = D24 by L228;
L230: ( Sum D26 ) = ( 0 );
L231: ( ( Sum D26 ) div ( C31 |^ D24 ) ) = ( 0 ) by L230 , NAT_2:2;
set D27 = C48;
L232: (for B55 being Nat holds (B55 in ( dom D26 ) implies ( C48 . B55 ) = ( D26 . B55 )));
L233: (( dom C48 ) = ( ( len D26 ) + ( len D27 ) ) & (for B56 being Nat holds (B56 in ( dom D27 ) implies ( C48 . ( ( len D26 ) + B56 ) ) = ( D27 . B56 )))) by L228 , L229;
L234: C48 = ( D26 ^ D27 ) by L233 , L232 , AFINSQ_1:def 3;
L235: C30 = ( ( Sum D26 ) + ( Sum D27 ) ) by L234 , L147 , AFINSQ_2:55;
reconsider D28 = ( C31 |^ D24 ) as (Element of ( NAT )) by ORDINAL1:def 12;
L236: D28 <> ( 0 ) by L66 , PREPOWER:5;
L237:
now
let C53 being Nat;
assume L238: C53 in ( dom <% ( C48 . D24 ) %> );
L239: C53 in 1 by L238 , AFINSQ_1:33;
L240: C53 < 1 by L239 , NAT_1:44;
L241: C53 = ( 0 ) by L240 , NAT_1:14;
thus L242: ( D27 . C53 ) = ( <% ( C48 . D24 ) %> . C53 ) by L241 , L228 , AFINSQ_1:def 4;
end;
reconsider D29 = ( D24 + 1 ) as (Element of ( NAT ));
L243: D29 <= D19 by L228 , NAT_1:13;
L244: D29 < ( len C46 ) by L243 , XREAL_1:147;
reconsider D30 = ( ( len C46 ) - D29 ) as (Element of ( NAT )) by L228;
defpred S8[ Nat , set ] means $2 = ( C48 . ( $1 + D29 ) );
reconsider D31 = ( C48 | D29 ) as (XFinSequence of ( NAT ));
L245: (for B57 being Nat holds (B57 in D30 implies (ex B58 being (Element of ( NAT )) st S8[ B57 , B58 ])));
consider C54 being (XFinSequence of ( NAT )) such that L246: (( dom C54 ) = D30 & (for B59 being Nat holds (B59 in D30 implies S8[ B59 , ( C54 . B59 ) ]))) from STIRL2_1:sch 5(L245);
L247: ( len C46 ) = ( len C48 ) by L145;
L248: ( len D31 ) = D29 by L247 , L244 , AFINSQ_1:11;
L249: ( dom C48 ) = ( ( len D31 ) + ( len C54 ) ) by L248 , L145 , L246;
L250:
now
let C55 being Nat;
reconsider D32 = C55 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L251: C55 in ( dom C54 );
L252: C55 < ( len C54 ) by L251 , NAT_1:44;
L253: ( D29 + C55 ) < ( dom C48 ) by L252 , L248 , L249 , XREAL_1:8;
L254: ( D29 + C55 ) in ( dom C48 ) by L253 , NAT_1:44;
L255: ( C48 . ( D29 + C55 ) ) = ( ( C46 . ( D29 + C55 ) ) * ( C31 |^ ( D29 + C55 ) ) ) by L254 , L146;
L256: ( C54 . D32 ) = ( ( C46 . ( D29 + C55 ) ) * ( C31 |^ ( D29 + C55 ) ) ) by L255 , L246 , L251
.= ( ( C46 . ( D29 + C55 ) ) * ( ( C31 |^ D29 ) * ( C31 |^ C55 ) ) ) by NEWTON:8
.= ( ( ( C46 . ( D29 + C55 ) ) * ( C31 |^ C55 ) ) * ( C31 |^ D29 ) );
thus L257: ( C31 |^ D29 ) divides ( C54 . C55 ) by L256 , NAT_D:def 3;
end;
L258: ( C31 |^ D29 ) divides ( Sum C54 ) by L250 , L14;
L259:
now
let C56 being Nat;
assume L260: C56 in ( dom C54 );
thus L261: ( D27 . ( ( len <% ( C48 . D24 ) %> ) + C56 ) ) = ( C48 . ( ( len D31 ) + C56 ) ) by L228 , L248 , AFINSQ_1:33
.= ( C54 . C56 ) by L246 , L248 , L260;
end;
L262: ( dom D27 ) = ( 1 + ( dom C54 ) ) by L145 , L228 , L246
.= ( ( len <% ( C48 . D24 ) %> ) + ( len C54 ) ) by AFINSQ_1:34;
L263: D27 = ( <% ( C48 . D24 ) %> ^ C54 ) by L262 , L237 , L259 , AFINSQ_1:def 3;
L264: ( Sum D27 ) = ( ( Sum <% ( C48 . D24 ) %> ) + ( Sum C54 ) ) by L263 , AFINSQ_2:55;
L265: ((for B60 being Nat holds (B60 in ( dom D31 ) implies ( C48 . B60 ) = ( D31 . B60 ))) & (for B61 being Nat holds (B61 in ( dom C54 ) implies ( C48 . ( ( len D31 ) + B61 ) ) = ( C54 . B61 )))) by L246 , L248 , FUNCT_1:47;
L266: C48 = ( D31 ^ C54 ) by L265 , L249 , AFINSQ_1:def 3;
L267: C30 = ( ( Sum D31 ) + ( Sum C54 ) ) by L266 , L147 , AFINSQ_2:55;
reconsider D33 = ( C31 |^ D29 ) as (Element of ( NAT )) by ORDINAL1:def 12;
consider C57 being Nat such that L268: ( C57 + 1 ) = D29;
L269:
now
let C58 being Nat;
reconsider D34 = C58 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L270: C58 in ( dom D27 );
L271: ( D27 . D34 ) = ( ( C46 . ( D24 + C58 ) ) * ( C31 |^ ( D24 + C58 ) ) ) by L270 , L146 , L228
.= ( ( C46 . ( D24 + C58 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ C58 ) ) ) by NEWTON:8
.= ( ( ( C46 . ( D24 + C58 ) ) * ( C31 |^ C58 ) ) * ( C31 |^ D24 ) );
thus L272: ( C31 |^ D24 ) divides ( D27 . C58 ) by L271 , NAT_D:def 3;
end;
L273: ( C31 |^ D24 ) divides ( Sum D27 ) by L269 , L14;
L274: ( ( Sum D27 ) mod ( C31 |^ D24 ) ) = ( 0 ) by L273 , L236 , PEPIN:6;
L275: ( C30 div ( C31 |^ D24 ) ) = ( ( ( Sum D27 ) div ( C31 |^ D24 ) ) + ( ( Sum D26 ) div ( C31 |^ D24 ) ) ) by L274 , L235 , NAT_D:19;
L276: ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) = ( Sum D27 ) by L275 , L231 , L273 , NAT_D:3;
reconsider D35 = ( <%> ( NAT ) ) as (XFinSequence of ( NAT ));
L277: ( len D35 ) = D24 by L228;
L278: ( Sum D35 ) = ( 0 );
L279: ( ( Sum D35 ) div ( C31 |^ D24 ) ) = ( 0 ) by L278 , NAT_2:2;
set D36 = C50;
L280: (for B62 being Nat holds (B62 in ( dom D35 ) implies ( C50 . B62 ) = ( D35 . B62 )));
L281: (( dom C50 ) = ( ( len D35 ) + ( len D36 ) ) & (for B63 being Nat holds (B63 in ( dom D36 ) implies ( C50 . ( ( len D35 ) + B63 ) ) = ( D36 . B63 )))) by L228 , L277;
L282: C50 = ( D35 ^ D36 ) by L281 , L280 , AFINSQ_1:def 3;
L283: C30 = ( ( Sum D35 ) + ( Sum D36 ) ) by L282 , L177 , AFINSQ_2:55;
reconsider D37 = ( C31 |^ D24 ) as (Element of ( NAT )) by ORDINAL1:def 12;
L284: D37 <> ( 0 ) by L66 , PREPOWER:5;
reconsider D38 = C57 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D39 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( D38 + 1 ) ) as (XFinSequence of ( NAT )) by L1;
L285: ( 1 - C31 ) <> ( 0 ) by L66;
L286: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L287: D29 c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L286 , ORDINAL1:def 2;
L288: ( len D31 ) = ( len D39 ) by L287 , L248 , L268 , RELAT_1:62;
L289: ( dom D39 ) = D29 by L268 , L287 , RELAT_1:62;
L290: (for B64 being Nat holds (B64 in ( dom D31 ) implies ( D31 . B64 ) <= ( D39 . B64 )))
proof
let C59 being Nat;
reconsider D40 = C59 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L291: C59 in ( dom D31 );
L292: C59 in D29 by L291 , L244 , L247 , AFINSQ_1:11;
L293: ( D39 . D40 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D40 ) by L292 , L289 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D40 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D40 ) ) by PREPOWER:def 1;
L294: ( dom D31 ) c= ( dom C48 ) by RELAT_1:60;
L295: ( C46 . C59 ) < ( D17 + 1 ) by L294 , L144 , L145 , L291;
L296: ( C46 . C59 ) <= D17 by L295 , NAT_1:13;
L297: ( D31 . C59 ) = ( C48 . C59 ) by L291 , FUNCT_1:47
.= ( ( C46 . C59 ) * ( C31 |^ C59 ) ) by L146 , L291 , L294;
thus L298: thesis by L297 , L293 , L296 , XREAL_1:64;
end;
L299: ( Sum D39 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D38 ) by AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D38 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D38 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D38 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ D29 ) ) / ( 1 - C31 ) ) ) ) by L268
.= ( - ( 1 - ( C31 |^ D29 ) ) ) by L285 , XCMPLX_1:87
.= ( ( C31 |^ D29 ) - 1 );
L300: ( Sum D31 ) < ( ( ( C31 |^ D29 ) - 1 ) + 1 ) by L299 , L288 , L290 , AFINSQ_2:57 , XREAL_1:145;
L301: ( ( Sum D31 ) div ( C31 |^ D29 ) ) = ( 0 ) by L300 , NAT_D:27;
L302: D33 <> ( 0 ) by L66 , PREPOWER:5;
L303: ( ( Sum C54 ) mod ( C31 |^ D29 ) ) = ( 0 ) by L302 , L258 , PEPIN:6;
L304: ( C30 div ( C31 |^ D29 ) ) = ( ( ( Sum C54 ) div ( C31 |^ D29 ) ) + ( ( Sum D31 ) div ( C31 |^ D29 ) ) ) by L303 , L267 , NAT_D:19;
L305: ( ( C30 div ( C31 |^ D29 ) ) * ( C31 |^ D29 ) ) = ( Sum C54 ) by L304 , L301 , L258 , NAT_D:3;
L306: ( C48 . D24 ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D29 ) ) * ( C31 |^ D29 ) ) ) by L305 , L276 , L264 , AFINSQ_2:53;
L307: ( ( C46 . D24 ) * ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D29 ) ) * ( C31 |^ D29 ) ) ) by L306 , L145 , L146 , L218;
L308: ( ( C46 . D24 ) * ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D29 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ 1 ) ) ) ) by L307 , NEWTON:8;
L309: ( ( C46 . D24 ) * ( C31 |^ D24 ) ) = ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D29 ) ) * ( C31 |^ 1 ) ) ) ) by L308;
L310: ( ( ( C31 |^ D24 ) * ( C46 . D24 ) ) / ( C31 |^ D24 ) ) = ( ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D29 ) ) * C31 ) ) ) / ( C31 |^ D24 ) ) by L309 , NEWTON:5;
L311: ( C46 . D24 ) = ( ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D29 ) ) * C31 ) ) ) / ( C31 |^ D24 ) ) by L310 , L236 , XCMPLX_1:89;
reconsider D41 = ( D24 + 1 ) as (Element of ( NAT ));
reconsider D42 = ( C50 | D41 ) as (XFinSequence of ( NAT ));
L312: ( len C47 ) = ( len C50 ) by L175;
L313:
now
let C60 being Nat;
reconsider D43 = C60 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L314: C60 in ( dom D36 );
L315: ( D36 . D43 ) = ( ( C47 . ( D24 + C60 ) ) * ( C31 |^ ( D24 + C60 ) ) ) by L314 , L176 , L228
.= ( ( C47 . ( D24 + C60 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ C60 ) ) ) by NEWTON:8
.= ( ( ( C47 . ( D24 + C60 ) ) * ( C31 |^ C60 ) ) * ( C31 |^ D24 ) );
thus L316: ( C31 |^ D24 ) divides ( D36 . C60 ) by L315 , NAT_D:def 3;
end;
L317: ( C31 |^ D24 ) divides ( Sum D36 ) by L313 , L14;
L318: ( ( Sum D36 ) mod ( C31 |^ D24 ) ) = ( 0 ) by L317 , L284 , PEPIN:6;
L319: ( C30 div ( C31 |^ D24 ) ) = ( ( ( Sum D36 ) div ( C31 |^ D24 ) ) + ( ( Sum D35 ) div ( C31 |^ D24 ) ) ) by L318 , L283 , NAT_D:19;
L320: ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) = ( Sum D36 ) by L319 , L279 , L317 , NAT_D:3;
L321:
now
let C61 being Nat;
assume L322: C61 in ( dom <% ( C50 . D24 ) %> );
L323: C61 in 1 by L322 , AFINSQ_1:33;
L324: C61 < 1 by L323 , NAT_1:44;
L325: C61 = ( 0 ) by L324 , NAT_1:14;
thus L326: ( D36 . C61 ) = ( <% ( C50 . D24 ) %> . C61 ) by L325 , L228 , AFINSQ_1:def 4;
end;
reconsider D44 = ( ( len C46 ) - D41 ) as (Element of ( NAT )) by L228;
defpred S9[ Nat , set ] means $2 = ( C50 . ( $1 + D41 ) );
L327: (for B65 being Nat holds (B65 in D44 implies (ex B66 being (Element of ( NAT )) st S9[ B65 , B66 ])));
consider C62 being (XFinSequence of ( NAT )) such that L328: (( dom C62 ) = D44 & (for B67 being Nat holds (B67 in D44 implies S9[ B67 , ( C62 . B67 ) ]))) from STIRL2_1:sch 5(L327);
L329: D41 <= D19 by L228 , NAT_1:13;
L330: D41 < ( len C46 ) by L329 , XREAL_1:147;
L331: ( len D42 ) = D41 by L330 , L216 , L312 , AFINSQ_1:11;
L332:
now
let C63 being Nat;
assume L333: C63 in ( dom C62 );
thus L334: ( D36 . ( ( len <% ( C50 . D24 ) %> ) + C63 ) ) = ( C50 . ( ( len D42 ) + C63 ) ) by L228 , L331 , AFINSQ_1:33
.= ( C62 . C63 ) by L328 , L331 , L333;
end;
reconsider D45 = ( C31 |^ D41 ) as (Element of ( NAT )) by ORDINAL1:def 12;
consider C64 being Nat such that L335: ( C64 + 1 ) = D41;
L336: ( dom C50 ) = ( ( len D42 ) + ( len C62 ) ) by L175 , L216 , L328 , L331;
L337:
now
let C65 being Nat;
reconsider D46 = C65 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L338: C65 in ( dom C62 );
L339: C65 < ( len C62 ) by L338 , NAT_1:44;
L340: ( D41 + C65 ) < ( dom C50 ) by L339 , L331 , L336 , XREAL_1:8;
L341: ( D41 + C65 ) in ( dom C50 ) by L340 , NAT_1:44;
L342: ( C50 . ( D41 + C65 ) ) = ( ( C47 . ( D41 + C65 ) ) * ( C31 |^ ( D41 + C65 ) ) ) by L341 , L176;
L343: ( C62 . D46 ) = ( ( C47 . ( D41 + C65 ) ) * ( C31 |^ ( D41 + C65 ) ) ) by L342 , L328 , L338
.= ( ( C47 . ( D41 + C65 ) ) * ( ( C31 |^ D41 ) * ( C31 |^ C65 ) ) ) by NEWTON:8
.= ( ( ( C47 . ( D41 + C65 ) ) * ( C31 |^ C65 ) ) * ( C31 |^ D41 ) );
thus L344: ( C31 |^ D41 ) divides ( C62 . C65 ) by L343 , NAT_D:def 3;
end;
L345: ( C31 |^ D41 ) divides ( Sum C62 ) by L337 , L14;
reconsider D47 = C64 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D48 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( D47 + 1 ) ) as (XFinSequence of ( NAT )) by L1;
L346: ( 1 - C31 ) <> ( 0 ) by L66;
L347: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L348: D41 c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L347 , ORDINAL1:def 2;
L349: ( len D42 ) = ( len D48 ) by L348 , L331 , L335 , RELAT_1:62;
L350: ( dom D48 ) = D41 by L335 , L348 , RELAT_1:62;
L351: (for B68 being Nat holds (B68 in ( dom D42 ) implies ( D42 . B68 ) <= ( D48 . B68 )))
proof
let C66 being Nat;
reconsider D49 = C66 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L352: C66 in ( dom D42 );
L353: C66 in D41 by L352 , L216 , L330 , L312 , AFINSQ_1:11;
L354: ( D48 . D49 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D49 ) by L353 , L350 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D49 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D49 ) ) by PREPOWER:def 1;
L355: ( dom D42 ) c= ( dom C50 ) by RELAT_1:60;
L356: ( C47 . C66 ) < ( D17 + 1 ) by L355 , L174 , L175 , L352;
L357: ( C47 . C66 ) <= D17 by L356 , NAT_1:13;
L358: ( D42 . C66 ) = ( C50 . C66 ) by L352 , FUNCT_1:47
.= ( ( C47 . C66 ) * ( C31 |^ C66 ) ) by L176 , L352 , L355;
thus L359: thesis by L358 , L354 , L357 , XREAL_1:64;
end;
L360: ( Sum D48 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D47 ) by AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D47 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D47 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D47 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ D41 ) ) / ( 1 - C31 ) ) ) ) by L335
.= ( - ( 1 - ( C31 |^ D41 ) ) ) by L346 , XCMPLX_1:87
.= ( ( C31 |^ D41 ) - 1 );
L361: ( Sum D42 ) < ( ( ( C31 |^ D41 ) - 1 ) + 1 ) by L360 , L349 , L351 , AFINSQ_2:57 , XREAL_1:145;
L362: ( ( Sum D42 ) div ( C31 |^ D41 ) ) = ( 0 ) by L361 , NAT_D:27;
L363: ((for B69 being Nat holds (B69 in ( dom D42 ) implies ( C50 . B69 ) = ( D42 . B69 ))) & (for B70 being Nat holds (B70 in ( dom C62 ) implies ( C50 . ( ( len D42 ) + B70 ) ) = ( C62 . B70 )))) by L328 , L331 , FUNCT_1:47;
L364: C50 = ( D42 ^ C62 ) by L363 , L336 , AFINSQ_1:def 3;
L365: C30 = ( ( Sum D42 ) + ( Sum C62 ) ) by L364 , L177 , AFINSQ_2:55;
L366: D45 <> ( 0 ) by L66 , PREPOWER:5;
L367: ( ( Sum C62 ) mod ( C31 |^ D41 ) ) = ( 0 ) by L366 , L345 , PEPIN:6;
L368: ( C30 div ( C31 |^ D41 ) ) = ( ( ( Sum C62 ) div ( C31 |^ D41 ) ) + ( ( Sum D42 ) div ( C31 |^ D41 ) ) ) by L367 , L365 , NAT_D:19;
L369: ( ( C30 div ( C31 |^ D41 ) ) * ( C31 |^ D41 ) ) = ( Sum C62 ) by L368 , L362 , L345 , NAT_D:3;
L370: ( dom D36 ) = ( 1 + ( dom C62 ) ) by L175 , L216 , L228 , L328
.= ( ( len <% ( C50 . D24 ) %> ) + ( len C62 ) ) by AFINSQ_1:34;
L371: D36 = ( <% ( C50 . D24 ) %> ^ C62 ) by L370 , L321 , L332 , AFINSQ_1:def 3;
L372: ( Sum D36 ) = ( ( Sum <% ( C50 . D24 ) %> ) + ( Sum C62 ) ) by L371 , AFINSQ_2:55;
L373: ( C50 . D24 ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D41 ) ) * ( C31 |^ D41 ) ) ) by L372 , L320 , L369 , AFINSQ_2:53;
L374: ( ( C47 . D24 ) * ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D41 ) ) * ( C31 |^ D41 ) ) ) by L373 , L175 , L176 , L216 , L218;
L375: ( ( C47 . D24 ) * ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D41 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ 1 ) ) ) ) by L374 , NEWTON:8;
L376: ( ( C47 . D24 ) * ( C31 |^ D24 ) ) = ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D41 ) ) * ( C31 |^ 1 ) ) ) ) by L375;
L377: ( ( ( C31 |^ D24 ) * ( C47 . D24 ) ) / ( C31 |^ D24 ) ) = ( ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D41 ) ) * C31 ) ) ) / ( C31 |^ D24 ) ) by L376 , NEWTON:5;
thus L378: ( C46 . C52 ) = ( C47 . C52 ) by L377 , L311 , L284 , XCMPLX_1:89;
end;
suppose L379: (D24 > ( 0 ) & D24 = D19);

set D50 = <% ( C48 . D24 ) %>;
reconsider D51 = ( C48 | D24 ) as (XFinSequence of ( NAT ));
L380: ( len C46 ) = ( len C48 ) by L145;
L381: ( len D51 ) = D24 by L380 , L221 , AFINSQ_1:11;
L382: ( len D50 ) = D25 by L379 , AFINSQ_1:34;
L383: ( dom C48 ) = ( ( len D51 ) + ( len D50 ) ) by L382 , L145 , L381;
L384: (for B71 being Nat holds (B71 in ( dom D50 ) implies ( C48 . ( ( len D51 ) + B71 ) ) = ( D50 . B71 )))
proof
let C67 being Nat;
assume L385: C67 in ( dom D50 );
L386: C67 < 1 by L385 , L379 , L382 , NAT_1:44;
L387: C67 = ( 0 ) by L386 , NAT_1:14;
thus L388: thesis by L387 , L381 , AFINSQ_1:34;
end;
L389:
now
let C68 being Nat;
reconsider D52 = C68 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L390: C68 in ( dom D50 );
L391: C68 < ( len D50 ) by L390 , NAT_1:44;
L392: ( D24 + C68 ) < ( dom C48 ) by L391 , L381 , L383 , XREAL_1:8;
L393: ( D24 + C68 ) in ( dom C48 ) by L392 , NAT_1:44;
L394: ( C48 . ( D24 + C68 ) ) = ( ( C46 . ( D24 + C68 ) ) * ( C31 |^ ( D24 + C68 ) ) ) by L393 , L146;
L395: ( D50 . D52 ) = ( ( C46 . ( D24 + C68 ) ) * ( C31 |^ ( D24 + C68 ) ) ) by L394 , L381 , L384 , L390
.= ( ( C46 . ( D24 + C68 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ C68 ) ) ) by NEWTON:8
.= ( ( ( C46 . ( D24 + C68 ) ) * ( C31 |^ C68 ) ) * ( C31 |^ D24 ) );
thus L396: ( C31 |^ D24 ) divides ( D50 . C68 ) by L395 , NAT_D:def 3;
end;
L397: ( C31 |^ D24 ) divides ( Sum D50 ) by L389 , L14;
reconsider D53 = ( C31 |^ D24 ) as (Element of ( NAT )) by ORDINAL1:def 12;
L398: ( 1 - C31 ) <> ( 0 ) by L66;
consider C69 being Nat such that L399: ( C69 + 1 ) = D24 by L379 , NAT_1:6;
reconsider D54 = C69 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D55 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( D54 + 1 ) ) as (XFinSequence of ( NAT )) by L1;
L400: ( Sum D55 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D54 ) by AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D54 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D54 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D54 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ D24 ) ) / ( 1 - C31 ) ) ) ) by L399
.= ( - ( 1 - ( C31 |^ D24 ) ) ) by L398 , XCMPLX_1:87
.= ( ( C31 |^ D24 ) - 1 );
consider C70 being Nat such that L401: ( C70 + 1 ) = D24 by L379 , NAT_1:6;
L402: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L403: D24 c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L402 , ORDINAL1:def 2;
L404: ( dom D55 ) = D24 by L403 , L399 , RELAT_1:62;
L405: (for B72 being Nat holds (B72 in ( dom D51 ) implies ( D51 . B72 ) <= ( D55 . B72 )))
proof
let C71 being Nat;
reconsider D56 = C71 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L406: C71 in ( dom D51 );
L407: C71 in D24 by L406 , L221 , L380 , AFINSQ_1:11;
L408: ( D55 . D56 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D56 ) by L407 , L404 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D56 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D56 ) ) by PREPOWER:def 1;
L409: ( dom D51 ) c= ( dom C48 ) by RELAT_1:60;
L410: ( C46 . C71 ) < ( D17 + 1 ) by L409 , L144 , L145 , L406;
L411: ( C46 . C71 ) <= D17 by L410 , NAT_1:13;
L412: ( D51 . C71 ) = ( C48 . C71 ) by L406 , FUNCT_1:47
.= ( ( C46 . C71 ) * ( C31 |^ C71 ) ) by L146 , L406 , L409;
thus L413: thesis by L412 , L408 , L411 , XREAL_1:64;
end;
L414: ( len D51 ) = ( len D55 ) by L381 , L399 , L403 , RELAT_1:62;
L415: ( Sum D51 ) < ( ( ( C31 |^ D24 ) - 1 ) + 1 ) by L414 , L400 , L405 , AFINSQ_2:57 , XREAL_1:145;
L416: ( ( Sum D51 ) div ( C31 |^ D24 ) ) = ( 0 ) by L415 , NAT_D:27;
L417: (for B73 being Nat holds (B73 in ( dom D51 ) implies ( C48 . B73 ) = ( D51 . B73 ))) by FUNCT_1:47;
L418: C48 = ( D51 ^ D50 ) by L417 , L383 , L384 , AFINSQ_1:def 3;
L419: C30 = ( ( Sum D51 ) + ( Sum D50 ) ) by L418 , L147 , AFINSQ_2:55;
L420: D53 <> ( 0 ) by L66 , PREPOWER:5;
L421: ( ( Sum D50 ) mod ( C31 |^ D24 ) ) = ( 0 ) by L420 , L397 , PEPIN:6;
L422: ( C30 div ( C31 |^ D24 ) ) = ( ( ( Sum D50 ) div ( C31 |^ D24 ) ) + ( ( Sum D51 ) div ( C31 |^ D24 ) ) ) by L421 , L419 , NAT_D:19;
L423: ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) = ( Sum D50 ) by L422 , L416 , L397 , NAT_D:3;
L424: ( C48 . D24 ) = ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) by L423 , AFINSQ_2:53;
L425: ( ( ( C46 . D24 ) * ( C31 |^ D24 ) ) / ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) / ( C31 |^ D24 ) ) by L424 , L145 , L146 , L218;
L426: ( C46 . D24 ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) / ( C31 |^ D24 ) ) by L425 , L420 , XCMPLX_1:89;
set D57 = <% ( C50 . D24 ) %>;
reconsider D58 = ( C50 | D24 ) as (XFinSequence of ( NAT ));
L427: ( len C47 ) = ( len C50 ) by L175;
L428: ( len D58 ) = D24 by L427 , L216 , L221 , AFINSQ_1:11;
L429: ( len D57 ) = D25 by L379 , AFINSQ_1:34;
L430: ( dom C50 ) = ( ( len D58 ) + ( len D57 ) ) by L429 , L175 , L216 , L428;
L431: (for B74 being Nat holds (B74 in ( dom D57 ) implies ( C50 . ( ( len D58 ) + B74 ) ) = ( D57 . B74 )))
proof
let C72 being Nat;
assume L432: C72 in ( dom D57 );
L433: C72 < 1 by L432 , L379 , L429 , NAT_1:44;
L434: C72 = ( 0 ) by L433 , NAT_1:14;
thus L435: thesis by L434 , L428 , AFINSQ_1:34;
end;
L436:
now
let C73 being Nat;
reconsider D59 = C73 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L437: C73 in ( dom D57 );
L438: C73 < ( len D57 ) by L437 , NAT_1:44;
L439: ( D24 + C73 ) < ( dom C50 ) by L438 , L428 , L430 , XREAL_1:8;
L440: ( D24 + C73 ) in ( dom C50 ) by L439 , NAT_1:44;
L441: ( C50 . ( D24 + C73 ) ) = ( ( C47 . ( D24 + C73 ) ) * ( C31 |^ ( D24 + C73 ) ) ) by L440 , L176;
L442: ( D57 . D59 ) = ( ( C47 . ( D24 + C73 ) ) * ( C31 |^ ( D24 + C73 ) ) ) by L441 , L428 , L431 , L437
.= ( ( C47 . ( D24 + C73 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ C73 ) ) ) by NEWTON:8
.= ( ( ( C47 . ( D24 + C73 ) ) * ( C31 |^ C73 ) ) * ( C31 |^ D24 ) );
thus L443: ( C31 |^ D24 ) divides ( D57 . C73 ) by L442 , NAT_D:def 3;
end;
L444: ( C31 |^ D24 ) divides ( Sum D57 ) by L436 , L14;
reconsider D60 = C70 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D61 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( D60 + 1 ) ) as (XFinSequence of ( NAT )) by L1;
reconsider D62 = ( C31 |^ D24 ) as (Element of ( NAT )) by ORDINAL1:def 12;
L445: ( 1 - C31 ) <> ( 0 ) by L66;
L446: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L447: D24 c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L446 , ORDINAL1:def 2;
L448: ( len D58 ) = ( len D61 ) by L447 , L428 , L401 , RELAT_1:62;
L449: ( dom D61 ) = D24 by L401 , L447 , RELAT_1:62;
L450: (for B75 being Nat holds (B75 in ( dom D58 ) implies ( D58 . B75 ) <= ( D61 . B75 )))
proof
let C74 being Nat;
reconsider D63 = C74 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L451: C74 in ( dom D58 );
L452: C74 in D24 by L451 , L216 , L221 , L427 , AFINSQ_1:11;
L453: ( D61 . D63 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D63 ) by L452 , L449 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D63 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D63 ) ) by PREPOWER:def 1;
L454: ( dom D58 ) c= ( dom C50 ) by RELAT_1:60;
L455: ( C47 . C74 ) < ( D17 + 1 ) by L454 , L174 , L175 , L451;
L456: ( C47 . C74 ) <= D17 by L455 , NAT_1:13;
L457: ( D58 . C74 ) = ( C50 . C74 ) by L451 , FUNCT_1:47
.= ( ( C47 . C74 ) * ( C31 |^ C74 ) ) by L176 , L451 , L454;
thus L458: thesis by L457 , L453 , L456 , XREAL_1:64;
end;
L459: ( Sum D61 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D60 ) by AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D60 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D60 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D60 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ D24 ) ) / ( 1 - C31 ) ) ) ) by L401
.= ( - ( 1 - ( C31 |^ D24 ) ) ) by L445 , XCMPLX_1:87
.= ( ( C31 |^ D24 ) - 1 );
L460: ( Sum D58 ) < ( ( ( C31 |^ D24 ) - 1 ) + 1 ) by L459 , L448 , L450 , AFINSQ_2:57 , XREAL_1:145;
L461: ( ( Sum D58 ) div ( C31 |^ D24 ) ) = ( 0 ) by L460 , NAT_D:27;
L462: (for B76 being Nat holds (B76 in ( dom D58 ) implies ( C50 . B76 ) = ( D58 . B76 ))) by FUNCT_1:47;
L463: C50 = ( D58 ^ D57 ) by L462 , L430 , L431 , AFINSQ_1:def 3;
L464: C30 = ( ( Sum D58 ) + ( Sum D57 ) ) by L463 , L177 , AFINSQ_2:55;
L465: D62 <> ( 0 ) by L66 , PREPOWER:5;
L466: ( ( Sum D57 ) mod ( C31 |^ D24 ) ) = ( 0 ) by L465 , L444 , PEPIN:6;
L467: ( C30 div ( C31 |^ D24 ) ) = ( ( ( Sum D57 ) div ( C31 |^ D24 ) ) + ( ( Sum D58 ) div ( C31 |^ D24 ) ) ) by L466 , L464 , NAT_D:19;
L468: ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) = ( Sum D57 ) by L467 , L461 , L444 , NAT_D:3;
L469: ( C50 . D24 ) = ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) by L468 , AFINSQ_2:53;
L470: ( ( ( C47 . D24 ) * ( C31 |^ D24 ) ) / ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) / ( C31 |^ D24 ) ) by L469 , L175 , L176 , L216 , L218;
thus L471: ( C46 . C52 ) = ( C47 . C52 ) by L470 , L426 , L465 , XCMPLX_1:89;
end;
suppose L472: (D24 > ( 0 ) & D24 < D19);

reconsider D64 = ( D24 + 1 ) as (Element of ( NAT ));
L473: D64 <= D19 by L472 , NAT_1:13;
L474: D64 < ( len C46 ) by L473 , XREAL_1:147;
reconsider D65 = ( C31 |^ D64 ) as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D66 = ( C48 | D64 ) as (XFinSequence of ( NAT ));
reconsider D67 = ( C31 |^ D24 ) as (Element of ( NAT )) by ORDINAL1:def 12;
defpred S10[ Nat , set ] means $2 = ( C48 . ( $1 + D24 ) );
consider C75 being Nat such that L475: ( C75 + 1 ) = D64;
reconsider D68 = C75 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D69 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( D68 + 1 ) ) as (XFinSequence of ( NAT )) by L1;
L476: ( len C46 ) = ( len C48 ) by L145;
L477: ( len D66 ) = D64 by L476 , L474 , AFINSQ_1:11;
L478: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L479: D64 c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L478 , ORDINAL1:def 2;
L480: ( len D66 ) = ( len D69 ) by L479 , L477 , L475 , RELAT_1:62;
L481: ( dom D69 ) = D64 by L475 , L479 , RELAT_1:62;
L482: (for B77 being Nat holds (B77 in ( dom D66 ) implies ( D66 . B77 ) <= ( D69 . B77 )))
proof
let C76 being Nat;
reconsider D70 = C76 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L483: C76 in ( dom D66 );
L484: C76 in D64 by L483 , L474 , L476 , AFINSQ_1:11;
L485: ( D69 . D70 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D70 ) by L484 , L481 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D70 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D70 ) ) by PREPOWER:def 1;
L486: ( dom D66 ) c= ( dom C48 ) by RELAT_1:60;
L487: ( C46 . C76 ) < ( D17 + 1 ) by L486 , L144 , L145 , L483;
L488: ( C46 . C76 ) <= D17 by L487 , NAT_1:13;
L489: ( D66 . C76 ) = ( C48 . C76 ) by L483 , FUNCT_1:47
.= ( ( C46 . C76 ) * ( C31 |^ C76 ) ) by L146 , L483 , L486;
thus L490: thesis by L489 , L485 , L488 , XREAL_1:64;
end;
L491: D19 < ( len C46 ) by XREAL_1:147;
reconsider D71 = ( ( len C46 ) - D64 ) as (Element of ( NAT )) by L491 , L473 , NAT_1:21 , XXREAL_0:2;
L492: (for B78 being Nat holds (B78 in D25 implies (ex B79 being (Element of ( NAT )) st S10[ B78 , B79 ])));
consider C77 being (XFinSequence of ( NAT )) such that L493: (( dom C77 ) = D25 & (for B80 being Nat holds (B80 in D25 implies S10[ B80 , ( C77 . B80 ) ]))) from STIRL2_1:sch 5(L492);
L494:
now
let C78 being Nat;
assume L495: C78 in ( dom <% ( C48 . D24 ) %> );
L496: C78 in 1 by L495 , AFINSQ_1:33;
L497: C78 < 1 by L496 , NAT_1:44;
L498: C78 = ( 0 ) by L497 , NAT_1:14;
L499: D25 > ( 0 ) by L221 , XREAL_1:50;
L500: C78 in ( dom C77 ) by L499 , L493 , L498 , NAT_1:44;
thus L501: ( C77 . C78 ) = ( C48 . ( C78 + D24 ) ) by L500 , L493
.= ( <% ( C48 . D24 ) %> . C78 ) by L498 , AFINSQ_1:def 4;
end;
defpred S11[ Nat , set ] means $2 = ( C48 . ( $1 + D64 ) );
L502: (for B81 being Nat holds (B81 in D71 implies (ex B82 being (Element of ( NAT )) st S11[ B81 , B82 ])));
consider C79 being (XFinSequence of ( NAT )) such that L503: (( dom C79 ) = D71 & (for B83 being Nat holds (B83 in D71 implies S11[ B83 , ( C79 . B83 ) ]))) from STIRL2_1:sch 5(L502);
reconsider D72 = ( C48 | D24 ) as (XFinSequence of ( NAT ));
L504: ( len C46 ) = ( len C48 ) by L145;
L505: ( len D72 ) = D24 by L504 , L221 , AFINSQ_1:11;
L506: ( dom C48 ) = ( ( len D72 ) + ( len C77 ) ) by L505 , L145 , L493;
L507:
now
let C80 being Nat;
reconsider D73 = C80 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L508: C80 in ( dom C77 );
L509: C80 < ( len C77 ) by L508 , NAT_1:44;
L510: ( D24 + C80 ) < ( dom C48 ) by L509 , L505 , L506 , XREAL_1:8;
L511: ( D24 + C80 ) in ( dom C48 ) by L510 , NAT_1:44;
L512: ( C48 . ( D24 + C80 ) ) = ( ( C46 . ( D24 + C80 ) ) * ( C31 |^ ( D24 + C80 ) ) ) by L511 , L146;
L513: ( C77 . D73 ) = ( ( C46 . ( D24 + C80 ) ) * ( C31 |^ ( D24 + C80 ) ) ) by L512 , L493 , L508
.= ( ( C46 . ( D24 + C80 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ C80 ) ) ) by NEWTON:8
.= ( ( ( C46 . ( D24 + C80 ) ) * ( C31 |^ C80 ) ) * ( C31 |^ D24 ) );
thus L514: ( C31 |^ D24 ) divides ( C77 . C80 ) by L513 , NAT_D:def 3;
end;
L515: ( C31 |^ D24 ) divides ( Sum C77 ) by L507 , L14;
L516: ((for B84 being Nat holds (B84 in ( dom D72 ) implies ( C48 . B84 ) = ( D72 . B84 ))) & (for B85 being Nat holds (B85 in ( dom C77 ) implies ( C48 . ( ( len D72 ) + B85 ) ) = ( C77 . B85 )))) by L493 , L505 , FUNCT_1:47;
L517: C48 = ( D72 ^ C77 ) by L516 , L506 , AFINSQ_1:def 3;
L518: C30 = ( ( Sum D72 ) + ( Sum C77 ) ) by L517 , L147 , AFINSQ_2:55;
consider C81 being Nat such that L519: ( C81 + 1 ) = D24 by L472 , NAT_1:6;
reconsider D74 = C81 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D75 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( D74 + 1 ) ) as (XFinSequence of ( NAT )) by L1;
L520: ( 1 - C31 ) <> ( 0 ) by L66;
L521: ( Sum D75 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D74 ) by AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D74 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D74 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D74 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ D24 ) ) / ( 1 - C31 ) ) ) ) by L519
.= ( - ( 1 - ( C31 |^ D24 ) ) ) by L520 , XCMPLX_1:87
.= ( ( C31 |^ D24 ) - 1 );
L522: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L523: D24 c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L522 , ORDINAL1:def 2;
L524: ( dom D75 ) = D24 by L523 , L519 , RELAT_1:62;
L525: (for B86 being Nat holds (B86 in ( dom D72 ) implies ( D72 . B86 ) <= ( D75 . B86 )))
proof
let C82 being Nat;
reconsider D76 = C82 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L526: C82 in ( dom D72 );
L527: C82 in D24 by L526 , L221 , L504 , AFINSQ_1:11;
L528: ( D75 . D76 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D76 ) by L527 , L524 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D76 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D76 ) ) by PREPOWER:def 1;
L529: ( dom D72 ) c= ( dom C48 ) by RELAT_1:60;
L530: ( C46 . C82 ) < ( D17 + 1 ) by L529 , L144 , L145 , L526;
L531: ( C46 . C82 ) <= D17 by L530 , NAT_1:13;
L532: ( D72 . C82 ) = ( C48 . C82 ) by L526 , FUNCT_1:47
.= ( ( C46 . C82 ) * ( C31 |^ C82 ) ) by L146 , L526 , L529;
thus L533: thesis by L532 , L528 , L531 , XREAL_1:64;
end;
L534:
now
let C83 being Nat;
assume L535: C83 in ( dom C79 );
L536: C83 < D71 by L535 , L503 , NAT_1:44;
L537: ( C83 + 1 ) < ( D71 + 1 ) by L536 , XREAL_1:8;
L538: ( C83 + 1 ) in ( dom C77 ) by L537 , L493 , NAT_1:44;
thus L539: ( C77 . ( ( len <% ( C48 . D24 ) %> ) + C83 ) ) = ( C77 . ( 1 + C83 ) ) by AFINSQ_1:33
.= ( C48 . ( ( len D72 ) + ( C83 + 1 ) ) ) by L493 , L505 , L538
.= ( C48 . ( ( len D66 ) + C83 ) ) by L505 , L477
.= ( C79 . C83 ) by L503 , L477 , L535;
end;
L540: ( dom C77 ) = ( 1 + ( dom C79 ) ) by L493 , L503
.= ( ( len <% ( C48 . D24 ) %> ) + ( len C79 ) ) by AFINSQ_1:34;
L541: C77 = ( <% ( C48 . D24 ) %> ^ C79 ) by L540 , L494 , L534 , AFINSQ_1:def 3;
L542: ( Sum C77 ) = ( ( Sum <% ( C48 . D24 ) %> ) + ( Sum C79 ) ) by L541 , AFINSQ_2:55;
defpred S12[ Nat , set ] means $2 = ( C50 . ( $1 + D24 ) );
L543: ( 1 - C31 ) <> ( 0 ) by L66;
consider C84 being Nat such that L544: ( C84 + 1 ) = D24 by L472 , NAT_1:6;
L545: ( dom C48 ) = ( ( len D66 ) + ( len C79 ) ) by L145 , L503 , L477;
L546:
now
let C85 being Nat;
reconsider D77 = C85 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L547: C85 in ( dom C79 );
L548: C85 < ( len C79 ) by L547 , NAT_1:44;
L549: ( D64 + C85 ) < ( dom C48 ) by L548 , L477 , L545 , XREAL_1:8;
L550: ( D64 + C85 ) in ( dom C48 ) by L549 , NAT_1:44;
L551: ( C48 . ( D64 + C85 ) ) = ( ( C46 . ( D64 + C85 ) ) * ( C31 |^ ( D64 + C85 ) ) ) by L550 , L146;
L552: ( C79 . D77 ) = ( ( C46 . ( D64 + C85 ) ) * ( C31 |^ ( D64 + C85 ) ) ) by L551 , L503 , L547
.= ( ( C46 . ( D64 + C85 ) ) * ( ( C31 |^ D64 ) * ( C31 |^ C85 ) ) ) by NEWTON:8
.= ( ( ( C46 . ( D64 + C85 ) ) * ( C31 |^ C85 ) ) * ( C31 |^ D64 ) );
thus L553: ( C31 |^ D64 ) divides ( C79 . C85 ) by L552 , NAT_D:def 3;
end;
L554: ( C31 |^ D64 ) divides ( Sum C79 ) by L546 , L14;
L555: ( len D72 ) = ( len D75 ) by L505 , L519 , L523 , RELAT_1:62;
L556: ( Sum D72 ) < ( ( ( C31 |^ D24 ) - 1 ) + 1 ) by L555 , L521 , L525 , AFINSQ_2:57 , XREAL_1:145;
L557: ( ( Sum D72 ) div ( C31 |^ D24 ) ) = ( 0 ) by L556 , NAT_D:27;
L558: ( 1 - C31 ) <> ( 0 ) by L66;
L559: ( Sum D69 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D68 ) by AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D68 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D68 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D68 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ D64 ) ) / ( 1 - C31 ) ) ) ) by L475
.= ( - ( 1 - ( C31 |^ D64 ) ) ) by L558 , XCMPLX_1:87
.= ( ( C31 |^ D64 ) - 1 );
L560: ( Sum D66 ) < ( ( ( C31 |^ D64 ) - 1 ) + 1 ) by L559 , L480 , L482 , AFINSQ_2:57 , XREAL_1:145;
L561: ( ( Sum D66 ) div ( C31 |^ D64 ) ) = ( 0 ) by L560 , NAT_D:27;
L562: ((for B87 being Nat holds (B87 in ( dom D66 ) implies ( C48 . B87 ) = ( D66 . B87 ))) & (for B88 being Nat holds (B88 in ( dom C79 ) implies ( C48 . ( ( len D66 ) + B88 ) ) = ( C79 . B88 )))) by L503 , L477 , FUNCT_1:47;
L563: C48 = ( D66 ^ C79 ) by L562 , L545 , AFINSQ_1:def 3;
L564: C30 = ( ( Sum D66 ) + ( Sum C79 ) ) by L563 , L147 , AFINSQ_2:55;
L565: D65 <> ( 0 ) by L66 , PREPOWER:5;
L566: ( ( Sum C79 ) mod ( C31 |^ D64 ) ) = ( 0 ) by L565 , L554 , PEPIN:6;
L567: ( C30 div ( C31 |^ D64 ) ) = ( ( ( Sum C79 ) div ( C31 |^ D64 ) ) + ( ( Sum D66 ) div ( C31 |^ D64 ) ) ) by L566 , L564 , NAT_D:19;
L568: ( ( C30 div ( C31 |^ D64 ) ) * ( C31 |^ D64 ) ) = ( Sum C79 ) by L567 , L561 , L554 , NAT_D:3;
L569: D67 <> ( 0 ) by L66 , PREPOWER:5;
L570: ( ( Sum C77 ) mod ( C31 |^ D24 ) ) = ( 0 ) by L569 , L515 , PEPIN:6;
L571: ( C30 div ( C31 |^ D24 ) ) = ( ( ( Sum C77 ) div ( C31 |^ D24 ) ) + ( ( Sum D72 ) div ( C31 |^ D24 ) ) ) by L570 , L518 , NAT_D:19;
L572: (( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) = ( Sum C77 ) & ( Sum <% ( C48 . D24 ) %> ) = ( C48 . D24 )) by L571 , L557 , L515 , AFINSQ_2:53 , NAT_D:3;
L573: ( ( C46 . D24 ) * ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D64 ) ) * ( C31 |^ D64 ) ) ) by L572 , L145 , L146 , L218 , L568 , L542;
L574: ( ( C46 . D24 ) * ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D64 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ 1 ) ) ) ) by L573 , NEWTON:8;
L575: ( ( C46 . D24 ) * ( C31 |^ D24 ) ) = ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D64 ) ) * ( C31 |^ 1 ) ) ) ) by L574;
L576: ( ( ( C31 |^ D24 ) * ( C46 . D24 ) ) / ( C31 |^ D24 ) ) = ( ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D64 ) ) * C31 ) ) ) / ( C31 |^ D24 ) ) by L575 , NEWTON:5;
L577: ( C46 . D24 ) = ( ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D64 ) ) * C31 ) ) ) / ( C31 |^ D24 ) ) by L576 , L569 , XCMPLX_1:89;
reconsider D78 = ( D24 + 1 ) as (Element of ( NAT ));
L578: D78 <= D19 by L472 , NAT_1:13;
L579: D78 < ( len C46 ) by L578 , XREAL_1:147;
reconsider D79 = C84 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D80 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( D79 + 1 ) ) as (XFinSequence of ( NAT )) by L1;
L580: ( 1 - C31 ) <> ( 0 ) by L66;
reconsider D81 = ( C31 |^ D78 ) as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D82 = ( C50 | D78 ) as (XFinSequence of ( NAT ));
reconsider D83 = ( C31 |^ D24 ) as (Element of ( NAT )) by ORDINAL1:def 12;
consider C86 being Nat such that L581: ( C86 + 1 ) = D78;
reconsider D84 = C86 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D85 = ( ( D17 (#) ( C31 GeoSeq ) ) | ( D84 + 1 ) ) as (XFinSequence of ( NAT )) by L1;
L582: ( len C47 ) = ( len C50 ) by L175;
L583: ( len D82 ) = D78 by L582 , L216 , L579 , AFINSQ_1:11;
L584: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L585: D78 c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L584 , ORDINAL1:def 2;
L586: ( len D82 ) = ( len D85 ) by L585 , L583 , L581 , RELAT_1:62;
L587: ( dom D85 ) = D78 by L581 , L585 , RELAT_1:62;
L588: (for B89 being Nat holds (B89 in ( dom D82 ) implies ( D82 . B89 ) <= ( D85 . B89 )))
proof
let C87 being Nat;
reconsider D86 = C87 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L589: C87 in ( dom D82 );
L590: C87 in D78 by L589 , L216 , L579 , L582 , AFINSQ_1:11;
L591: ( D85 . D86 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D86 ) by L590 , L587 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D86 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D86 ) ) by PREPOWER:def 1;
L592: ( dom D82 ) c= ( dom C50 ) by RELAT_1:60;
L593: ( C47 . C87 ) < ( D17 + 1 ) by L592 , L174 , L175 , L589;
L594: ( C47 . C87 ) <= D17 by L593 , NAT_1:13;
L595: ( D82 . C87 ) = ( C50 . C87 ) by L589 , FUNCT_1:47
.= ( ( C47 . C87 ) * ( C31 |^ C87 ) ) by L176 , L589 , L592;
thus L596: thesis by L595 , L591 , L594 , XREAL_1:64;
end;
L597: ( Sum D85 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D84 ) by AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D84 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D84 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D84 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ D78 ) ) / ( 1 - C31 ) ) ) ) by L581
.= ( - ( 1 - ( C31 |^ D78 ) ) ) by L580 , XCMPLX_1:87
.= ( ( C31 |^ D78 ) - 1 );
L598: ( Sum D82 ) < ( ( ( C31 |^ D78 ) - 1 ) + 1 ) by L597 , L586 , L588 , AFINSQ_2:57 , XREAL_1:145;
L599: ( ( Sum D82 ) div ( C31 |^ D78 ) ) = ( 0 ) by L598 , NAT_D:27;
L600: D19 < ( len C46 ) by XREAL_1:147;
reconsider D87 = ( ( len C46 ) - D78 ) as (Element of ( NAT )) by L600 , L578 , NAT_1:21 , XXREAL_0:2;
L601: (for B90 being Nat holds (B90 in D25 implies (ex B91 being (Element of ( NAT )) st S12[ B90 , B91 ])));
consider C88 being (XFinSequence of ( NAT )) such that L602: (( dom C88 ) = D25 & (for B92 being Nat holds (B92 in D25 implies S12[ B92 , ( C88 . B92 ) ]))) from STIRL2_1:sch 5(L601);
L603:
now
let C89 being Nat;
assume L604: C89 in ( dom <% ( C50 . D24 ) %> );
L605: C89 in 1 by L604 , AFINSQ_1:33;
L606: C89 < 1 by L605 , NAT_1:44;
L607: C89 = ( 0 ) by L606 , NAT_1:14;
L608: D25 > ( 0 ) by L221 , XREAL_1:50;
L609: C89 in ( dom C88 ) by L608 , L602 , L607 , NAT_1:44;
thus L610: ( C88 . C89 ) = ( C50 . ( C89 + D24 ) ) by L609 , L602
.= ( <% ( C50 . D24 ) %> . C89 ) by L607 , AFINSQ_1:def 4;
end;
defpred S13[ Nat , set ] means $2 = ( C50 . ( $1 + D78 ) );
L611: (for B93 being Nat holds (B93 in D87 implies (ex B94 being (Element of ( NAT )) st S13[ B93 , B94 ])));
consider C90 being (XFinSequence of ( NAT )) such that L612: (( dom C90 ) = D87 & (for B95 being Nat holds (B95 in D87 implies S13[ B95 , ( C90 . B95 ) ]))) from STIRL2_1:sch 5(L611);
L613: ( dom C50 ) = ( ( len D82 ) + ( len C90 ) ) by L175 , L216 , L612 , L583;
L614:
now
let C91 being Nat;
reconsider D88 = C91 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L615: C91 in ( dom C90 );
L616: C91 < ( len C90 ) by L615 , NAT_1:44;
L617: ( D78 + C91 ) < ( dom C50 ) by L616 , L583 , L613 , XREAL_1:8;
L618: ( D78 + C91 ) in ( dom C50 ) by L617 , NAT_1:44;
L619: ( C50 . ( D78 + C91 ) ) = ( ( C47 . ( D78 + C91 ) ) * ( C31 |^ ( D78 + C91 ) ) ) by L618 , L176;
L620: ( C90 . D88 ) = ( ( C47 . ( D78 + C91 ) ) * ( C31 |^ ( D78 + C91 ) ) ) by L619 , L612 , L615
.= ( ( C47 . ( D78 + C91 ) ) * ( ( C31 |^ D78 ) * ( C31 |^ C91 ) ) ) by NEWTON:8
.= ( ( ( C47 . ( D78 + C91 ) ) * ( C31 |^ C91 ) ) * ( C31 |^ D78 ) );
thus L621: ( C31 |^ D78 ) divides ( C90 . C91 ) by L620 , NAT_D:def 3;
end;
L622: ( C31 |^ D78 ) divides ( Sum C90 ) by L614 , L14;
L623: ((for B96 being Nat holds (B96 in ( dom D82 ) implies ( C50 . B96 ) = ( D82 . B96 ))) & (for B97 being Nat holds (B97 in ( dom C90 ) implies ( C50 . ( ( len D82 ) + B97 ) ) = ( C90 . B97 )))) by L612 , L583 , FUNCT_1:47;
L624: C50 = ( D82 ^ C90 ) by L623 , L613 , AFINSQ_1:def 3;
L625: C30 = ( ( Sum D82 ) + ( Sum C90 ) ) by L624 , L177 , AFINSQ_2:55;
L626: D81 <> ( 0 ) by L66 , PREPOWER:5;
L627: ( ( Sum C90 ) mod ( C31 |^ D78 ) ) = ( 0 ) by L626 , L622 , PEPIN:6;
L628: ( C30 div ( C31 |^ D78 ) ) = ( ( ( Sum C90 ) div ( C31 |^ D78 ) ) + ( ( Sum D82 ) div ( C31 |^ D78 ) ) ) by L627 , L625 , NAT_D:19;
L629: ( ( C30 div ( C31 |^ D78 ) ) * ( C31 |^ D78 ) ) = ( Sum C90 ) by L628 , L599 , L622 , NAT_D:3;
reconsider D89 = ( C50 | D24 ) as (XFinSequence of ( NAT ));
L630: ( len C47 ) = ( len C50 ) by L175;
L631: ( len D89 ) = D24 by L630 , L216 , L221 , AFINSQ_1:11;
L632: ( dom C50 ) = ( ( len D89 ) + ( len C88 ) ) by L631 , L175 , L216 , L602;
L633:
now
let C92 being Nat;
reconsider D90 = C92 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L634: C92 in ( dom C88 );
L635: C92 < ( len C88 ) by L634 , NAT_1:44;
L636: ( D24 + C92 ) < ( dom C50 ) by L635 , L631 , L632 , XREAL_1:8;
L637: ( D24 + C92 ) in ( dom C50 ) by L636 , NAT_1:44;
L638: ( C50 . ( D24 + C92 ) ) = ( ( C47 . ( D24 + C92 ) ) * ( C31 |^ ( D24 + C92 ) ) ) by L637 , L176;
L639: ( C88 . D90 ) = ( ( C47 . ( D24 + C92 ) ) * ( C31 |^ ( D24 + C92 ) ) ) by L638 , L602 , L634
.= ( ( C47 . ( D24 + C92 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ C92 ) ) ) by NEWTON:8
.= ( ( ( C47 . ( D24 + C92 ) ) * ( C31 |^ C92 ) ) * ( C31 |^ D24 ) );
thus L640: ( C31 |^ D24 ) divides ( C88 . C92 ) by L639 , NAT_D:def 3;
end;
L641: ( C31 |^ D24 ) divides ( Sum C88 ) by L633 , L14;
L642: ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) = ( NAT ) by FUNCT_2:def 1;
L643: D24 c= ( dom ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) by L642 , ORDINAL1:def 2;
L644: ( len D89 ) = ( len D80 ) by L643 , L631 , L544 , RELAT_1:62;
L645: ( dom D80 ) = D24 by L544 , L643 , RELAT_1:62;
L646: (for B98 being Nat holds (B98 in ( dom D89 ) implies ( D89 . B98 ) <= ( D80 . B98 )))
proof
let C93 being Nat;
reconsider D91 = C93 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L647: C93 in ( dom D89 );
L648: C93 in D24 by L647 , L216 , L221 , L630 , AFINSQ_1:11;
L649: ( D80 . D91 ) = ( ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) . D91 ) by L648 , L645 , FUNCT_1:47
.= ( ( C31 - 1 ) * ( ( C31 GeoSeq ) . D91 ) ) by SEQ_1:9
.= ( D17 * ( C31 |^ D91 ) ) by PREPOWER:def 1;
L650: ( dom D89 ) c= ( dom C50 ) by RELAT_1:60;
L651: ( C47 . C93 ) < ( D17 + 1 ) by L650 , L174 , L175 , L647;
L652: ( C47 . C93 ) <= D17 by L651 , NAT_1:13;
L653: ( D89 . C93 ) = ( C50 . C93 ) by L647 , FUNCT_1:47
.= ( ( C47 . C93 ) * ( C31 |^ C93 ) ) by L176 , L647 , L650;
thus L654: thesis by L653 , L649 , L652 , XREAL_1:64;
end;
L655: ( Sum D80 ) = ( ( Partial_Sums ( ( C31 - 1 ) (#) ( C31 GeoSeq ) ) ) . D79 ) by AFINSQ_2:56
.= ( ( ( C31 - 1 ) (#) ( Partial_Sums ( C31 GeoSeq ) ) ) . D79 ) by SERIES_1:9
.= ( ( C31 - 1 ) * ( ( Partial_Sums ( C31 GeoSeq ) ) . D79 ) ) by SEQ_1:9
.= ( ( C31 - 1 ) * ( ( 1 - ( C31 to_power ( D79 + 1 ) ) ) / ( 1 - C31 ) ) ) by L66 , SERIES_1:22
.= ( - ( ( 1 - C31 ) * ( ( 1 - ( C31 |^ D24 ) ) / ( 1 - C31 ) ) ) ) by L544
.= ( - ( 1 - ( C31 |^ D24 ) ) ) by L543 , XCMPLX_1:87
.= ( ( C31 |^ D24 ) - 1 );
L656: ( Sum D89 ) < ( ( ( C31 |^ D24 ) - 1 ) + 1 ) by L655 , L644 , L646 , AFINSQ_2:57 , XREAL_1:145;
L657: ( ( Sum D89 ) div ( C31 |^ D24 ) ) = ( 0 ) by L656 , NAT_D:27;
L658:
now
let C94 being Nat;
assume L659: C94 in ( dom C90 );
L660: C94 < D87 by L659 , L612 , NAT_1:44;
L661: ( C94 + 1 ) < ( D87 + 1 ) by L660 , XREAL_1:8;
L662: ( C94 + 1 ) in D25 by L661 , NAT_1:44;
thus L663: ( C88 . ( ( len <% ( C50 . D24 ) %> ) + C94 ) ) = ( C88 . ( 1 + C94 ) ) by AFINSQ_1:33
.= ( C50 . ( ( len D89 ) + ( C94 + 1 ) ) ) by L602 , L631 , L662
.= ( C50 . ( ( len D82 ) + C94 ) ) by L631 , L583
.= ( C90 . C94 ) by L612 , L583 , L659;
end;
L664: ( dom C88 ) = ( 1 + ( dom C90 ) ) by L602 , L612
.= ( ( len <% ( C50 . D24 ) %> ) + ( len C90 ) ) by AFINSQ_1:34;
L665: C88 = ( <% ( C50 . D24 ) %> ^ C90 ) by L664 , L603 , L658 , AFINSQ_1:def 3;
L666: ( Sum C88 ) = ( ( Sum <% ( C50 . D24 ) %> ) + ( Sum C90 ) ) by L665 , AFINSQ_2:55;
L667: ((for B99 being Nat holds (B99 in ( dom D89 ) implies ( C50 . B99 ) = ( D89 . B99 ))) & (for B100 being Nat holds (B100 in ( dom C88 ) implies ( C50 . ( ( len D89 ) + B100 ) ) = ( C88 . B100 )))) by L602 , L631 , FUNCT_1:47;
L668: C50 = ( D89 ^ C88 ) by L667 , L632 , AFINSQ_1:def 3;
L669: C30 = ( ( Sum D89 ) + ( Sum C88 ) ) by L668 , L177 , AFINSQ_2:55;
L670: D83 <> ( 0 ) by L66 , PREPOWER:5;
L671: ( ( Sum C88 ) mod ( C31 |^ D24 ) ) = ( 0 ) by L670 , L641 , PEPIN:6;
L672: ( C30 div ( C31 |^ D24 ) ) = ( ( ( Sum C88 ) div ( C31 |^ D24 ) ) + ( ( Sum D89 ) div ( C31 |^ D24 ) ) ) by L671 , L669 , NAT_D:19;
L673: ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) = ( Sum C88 ) by L672 , L657 , L641 , NAT_D:3;
L674: ( C50 . D24 ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D78 ) ) * ( C31 |^ D78 ) ) ) by L673 , L629 , L666 , AFINSQ_2:53;
L675: ( ( C47 . D24 ) * ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D78 ) ) * ( C31 |^ D78 ) ) ) by L674 , L175 , L176 , L216 , L218;
L676: ( ( C47 . D24 ) * ( C31 |^ D24 ) ) = ( ( ( C30 div ( C31 |^ D24 ) ) * ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D78 ) ) * ( ( C31 |^ D24 ) * ( C31 |^ 1 ) ) ) ) by L675 , NEWTON:8;
L677: ( ( C47 . D24 ) * ( C31 |^ D24 ) ) = ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D78 ) ) * ( C31 |^ 1 ) ) ) ) by L676;
L678: ( ( ( C31 |^ D24 ) * ( C47 . D24 ) ) / ( C31 |^ D24 ) ) = ( ( ( C31 |^ D24 ) * ( ( C30 div ( C31 |^ D24 ) ) - ( ( C30 div ( C31 |^ D78 ) ) * C31 ) ) ) / ( C31 |^ D24 ) ) by L677 , NEWTON:5;
thus L679: ( C46 . C52 ) = ( C47 . C52 ) by L678 , L577 , L670 , XCMPLX_1:89;
end;
end;
thus L681: thesis by L217 , L216 , FUNCT_1:2;
end;

assume that
L682: C30 = ( 0 )
and
L683: (C46 = <% ( 0 ) %> & C47 = <% ( 0 ) %>);
thus L684: thesis by L683;
end;
end;
theorem
L686: (for B101 , B102 being Nat holds (B102 > 1 implies ( len ( digits (B101 , B102) ) ) >= 1))
proof
let C95 , C96 being Nat;
assume L687: C96 > 1;
per cases ;
suppose L688: C95 = ( 0 );

L689: ( digits (C95 , C96) ) = <% ( 0 ) %> by L688 , L687 , L67;
thus L690: thesis by L689 , AFINSQ_1:33;
end;
suppose L691: C95 <> ( 0 );

L692: ( ( digits (C95 , C96) ) . ( ( len ( digits (C95 , C96) ) ) - 1 ) ) <> ( 0 ) by L691 , L687 , L67;
L693: ( ( len ( digits (C95 , C96) ) ) - 1 ) in ( dom ( digits (C95 , C96) ) ) by L692 , FUNCT_1:def 2;
thus L694: thesis by L693 , NAT_1:14;
end;
end;
theorem
L696: (for B103 , B104 being Nat holds (B104 > 1 implies ( value (( digits (B103 , B104) ) , B104) ) = B103))
proof
let C97 , C98 being Nat;
assume L697: C98 > 1;
per cases ;
suppose L698: C97 <> ( 0 );

thus L699: thesis by L698 , L697 , L67;
end;
suppose L700: C97 = ( 0 );

L701: ( digits (C97 , C98) ) = <% ( 0 ) %> by L700 , L697 , L67;
L702:
now
let C99 being Nat;
assume L703: C99 in ( dom <% ( 0 ) %> );
L704: C99 in { ( 0 ) } by L703 , AFINSQ_1:def 4 , CARD_1:49;
L705: C99 = ( 0 ) by L704 , TARSKI:def 1;
thus L706: ( <% ( 0 ) %> . C99 ) = ( ( 0 ) * ( C98 |^ C99 ) ) by L705 , AFINSQ_1:def 4
.= ( ( ( digits (C97 , C98) ) . C99 ) * ( C98 |^ C99 ) ) by L701 , L705 , AFINSQ_1:def 4;
end;
L707: ( value (( digits (C97 , C98) ) , C98) ) = ( Sum <% ( 0 ) %> ) by L702 , L701 , L46;
thus L708: thesis by L707 , L700 , AFINSQ_2:53;
end;
end;
begin
theorem
L710: (for B105 , B106 being Nat holds (B106 = ( ( 10 |^ B105 ) - 1 ) implies 9 divides B106))
proof
defpred S14[ Nat ] means (ex B107 being Nat st (B107 = ( ( 10 |^ $1 ) - 1 ) & 9 divides B107));
let C100 , C101 being Nat;
L711:
now
let C102 being Nat;
assume L712: S14[ C102 ];
consider C103 being Nat such that L713: C103 = ( ( 10 |^ C102 ) - 1 ) and L714: 9 divides C103 by L712;
consider C104 being Nat such that L715: C103 = ( 9 * C104 ) by L714 , NAT_D:def 3;
L716: 9 divides ( 9 * ( ( C104 * 10 ) + 1 ) ) by NAT_D:def 3;
L717: ( ( 10 |^ ( C102 + 1 ) ) - 1 ) = ( ( ( ( 9 * C104 ) + 1 ) * 10 ) - 1 ) by L713 , L715 , NEWTON:6
.= ( 9 * ( ( C104 * 10 ) + 1 ) );
thus L718: S14[ ( C102 + 1 ) ] by L717 , L716;
end;
L719: ( ( 10 |^ ( 0 ) ) - 1 ) = ( 1 - 1 ) by NEWTON:4
.= ( 0 );
L720: S14[ ( 0 ) ] by L719 , NAT_D:6;
L721: (for B108 being Nat holds S14[ B108 ]) from NAT_1:sch 2(L720 , L711);
L722: (ex B109 being Nat st (B109 = ( ( 10 |^ C100 ) - 1 ) & 9 divides B109)) by L721;
assume L723: C101 = ( ( 10 |^ C100 ) - 1 );
thus L724: thesis by L723 , L722;
end;
theorem
L725: (for B110 , B111 being Nat holds (B111 > 1 implies (B111 divides B110 iff ( ( digits (B110 , B111) ) . ( 0 ) ) = ( 0 ))))
proof
let C105 , C106 being Nat;
reconsider D92 = C106 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C107 being (XFinSequence of ( NAT )) such that L726: ( dom C107 ) = ( dom ( digits (C105 , C106) ) ) and L727: (for B112 being Nat holds (B112 in ( dom C107 ) implies ( C107 . B112 ) = ( ( ( digits (C105 , C106) ) . B112 ) * ( C106 |^ B112 ) ))) and L728: ( value (( digits (C105 , C106) ) , C106) ) = ( Sum C107 ) by L46;
assume L729: C106 > 1;
thus L730: (C106 divides C105 implies ( ( digits (C105 , C106) ) . ( 0 ) ) = ( 0 ))
proof
L731: ( len ( digits (C105 , C106) ) ) >= 1 by L729 , L686;
assume L732: C106 divides C105;
consider C108 being (XFinSequence of ( NAT )) such that L733: ( dom C108 ) = ( dom ( digits (C105 , C106) ) ) and L734: (for B113 being Nat holds (B113 in ( dom C108 ) implies ( C108 . B113 ) = ( ( ( digits (C105 , C106) ) . B113 ) * ( C106 |^ B113 ) ))) and L735: ( value (( digits (C105 , C106) ) , C106) ) = ( Sum C108 ) by L46;
per cases  by L731 , XXREAL_0:1;
suppose L736: ( len ( digits (C105 , C106) ) ) = 1;

L737: C106 divides ( Sum C108 ) by L729 , L732 , L735 , L696;
L738: ( 0 ) in ( dom ( digits (C105 , C106) ) ) by L736 , NAT_1:44;
L739: ( len C108 ) = 1 by L733 , L736;
L740: C108 = <% ( C108 . ( 0 ) ) %> by L739 , AFINSQ_1:34;
L741: ( Sum C108 ) = ( C108 . ( 0 ) ) by L740 , AFINSQ_2:53
.= ( ( ( digits (C105 , C106) ) . ( 0 ) ) * ( C106 |^ ( 0 ) ) ) by L733 , L734 , L738;
L742: C106 divides ( ( ( digits (C105 , C106) ) . ( 0 ) ) * 1 ) by L741 , L737 , NEWTON:4;
per cases ;
suppose L743: C105 = ( 0 );

L744: ( digits (C105 , C106) ) = <% ( 0 ) %> by L743 , L729 , L67;
thus L745: thesis by L744 , AFINSQ_1:34;
end;
suppose L746: C105 <> ( 0 );

L747: ( ( digits (C105 , C106) ) . ( 0 ) ) < C106 by L746 , L729 , L738 , L67;
thus L748: thesis by L747 , L742 , NAT_D:7;
end;
end;
suppose L750: ( len ( digits (C105 , C106) ) ) > 1;

reconsider D93 = ( ( len ( digits (C105 , C106) ) ) - 1 ) as (Element of ( NAT )) by L750 , NAT_1:21;
defpred S15[ Nat , set ] means $2 = ( C108 . ( $1 + 1 ) );
L751:
now
let C109 being Nat;
assume L752: C109 in ( dom <% ( C108 . ( 0 ) ) %> );
L753: C109 in 1 by L752 , AFINSQ_1:def 4;
L754: C109 < 1 by L753 , NAT_1:44;
L755: C109 = ( 0 ) by L754 , NAT_1:14;
thus L756: ( C108 . C109 ) = ( <% ( C108 . ( 0 ) ) %> . C109 ) by L755 , AFINSQ_1:34;
end;
L757: (for B114 being Nat holds (B114 in D93 implies (ex B115 being (Element of ( NAT )) st S15[ B114 , B115 ])));
consider C110 being (XFinSequence of ( NAT )) such that L758: (( dom C110 ) = D93 & (for B116 being Nat holds (B116 in D93 implies S15[ B116 , ( C110 . B116 ) ]))) from STIRL2_1:sch 5(L757);
L759:
now
let C111 being Nat;
assume L760: C111 in ( dom C110 );
L761: C111 < D93 by L760 , L758 , NAT_1:44;
L762: ( C111 + 1 ) < ( D93 + 1 ) by L761 , XREAL_1:8;
L763: ( C111 + 1 ) in ( dom C108 ) by L762 , L733 , NAT_1:44;
L764: ( C110 . C111 ) = ( C108 . ( C111 + 1 ) ) by L758 , L760
.= ( ( ( digits (C105 , C106) ) . ( C111 + 1 ) ) * ( C106 |^ ( C111 + 1 ) ) ) by L734 , L763
.= ( ( ( digits (C105 , C106) ) . ( C111 + 1 ) ) * ( ( C106 |^ C111 ) * C106 ) ) by NEWTON:6
.= ( C106 * ( ( ( digits (C105 , C106) ) . ( C111 + 1 ) ) * ( C106 |^ C111 ) ) );
thus L765: C106 divides ( C110 . C111 ) by L764 , NAT_D:def 3;
end;
L766: C106 divides ( Sum C110 ) by L759 , L14;
L767: ( ( Sum C110 ) mod D92 ) = ( 0 ) by L766 , L729 , PEPIN:6;
L768:
now
let C112 being Nat;
L769: ( ( len <% ( C108 . ( 0 ) ) %> ) + C112 ) = ( C112 + 1 ) by AFINSQ_1:34;
assume L770: C112 in ( dom C110 );
thus L771: ( C108 . ( ( len <% ( C108 . ( 0 ) ) %> ) + C112 ) ) = ( C110 . C112 ) by L770 , L758 , L769;
end;
L772: ( 0 ) in ( dom ( digits (C105 , C106) ) ) by L750 , NAT_1:44;
L773: ( dom C108 ) = ( D93 + 1 ) by L733
.= ( ( len <% ( C108 . ( 0 ) ) %> ) + ( len C110 ) ) by L758 , AFINSQ_1:33;
L774: C108 = ( <% ( C108 . ( 0 ) ) %> ^ C110 ) by L773 , L751 , L768 , AFINSQ_1:def 3;
L775: ( Sum C108 ) = ( ( Sum <% ( C108 . ( 0 ) ) %> ) + ( Sum C110 ) ) by L774 , AFINSQ_2:55;
L776: C105 = ( ( Sum <% ( C108 . ( 0 ) ) %> ) + ( Sum C110 ) ) by L775 , L729 , L735 , L696;
L777: C105 = ( ( C108 . ( 0 ) ) + ( Sum C110 ) ) by L776 , AFINSQ_2:53;
L778: ( ( ( C108 . ( 0 ) ) + ( Sum C110 ) ) mod D92 ) = ( 0 ) by L777 , L729 , L732 , PEPIN:6;
L779: ( ( C108 . ( 0 ) ) mod C106 ) = ( 0 ) by L778 , L767 , NAT_D:17;
L780: D92 divides ( C108 . ( 0 ) ) by L779 , L729 , PEPIN:6;
L781: C106 divides ( ( ( digits (C105 , C106) ) . ( 0 ) ) * ( C106 |^ ( 0 ) ) ) by L780 , L733 , L734 , L772;
L782: C106 divides ( ( ( digits (C105 , C106) ) . ( 0 ) ) * 1 ) by L781 , NEWTON:4;
per cases ;
suppose L783: C105 = ( 0 );

L784: ( digits (C105 , C106) ) = <% ( 0 ) %> by L783 , L729 , L67;
thus L785: thesis by L784 , AFINSQ_1:34;
end;
suppose L786: C105 <> ( 0 );

L787: ( ( digits (C105 , C106) ) . ( 0 ) ) < C106 by L786 , L729 , L772 , L67;
thus L788: thesis by L787 , L782 , NAT_D:7;
end;
end;
end;

assume L791: ( ( digits (C105 , C106) ) . ( 0 ) ) = ( 0 );
L792:
now
let C113 being Nat;
assume L793: C113 in ( dom C107 );
per cases ;
suppose L794: C113 = ( 0 );

L795: ( C107 . C113 ) = ( ( ( digits (C105 , C106) ) . ( 0 ) ) * ( C106 |^ ( 0 ) ) ) by L794 , L727 , L793
.= ( ( ( digits (C105 , C106) ) . ( 0 ) ) * 1 ) by NEWTON:4;
thus L796: C106 divides ( C107 . C113 ) by L795 , L791 , NAT_D:6;
end;
suppose L797: C113 > ( 0 );

consider C114 being Nat such that L798: ( C114 + 1 ) = C113 by L797 , NAT_1:6;
L799: ( C107 . C113 ) = ( ( ( digits (C105 , C106) ) . C113 ) * ( C106 |^ ( C114 + 1 ) ) ) by L727 , L793 , L798
.= ( ( ( digits (C105 , C106) ) . C113 ) * ( ( C106 |^ C114 ) * C106 ) ) by NEWTON:6
.= ( C106 * ( ( ( digits (C105 , C106) ) . C113 ) * ( C106 |^ C114 ) ) );
thus L800: C106 divides ( C107 . C113 ) by L799 , NAT_D:def 3;
end;
end;
L802: C106 divides ( value (( digits (C105 , C106) ) , C106) ) by L792 , L728 , L14;
thus L803: thesis by L802 , L729 , L696;
end;
theorem
L804: (for B117 being Nat holds (2 divides B117 iff 2 divides ( ( digits (B117 , 10) ) . ( 0 ) )))
proof
let C115 being Nat;
consider C116 being (XFinSequence of ( NAT )) such that L805: ( dom C116 ) = ( dom ( digits (C115 , 10) ) ) and L806: (for B118 being Nat holds (B118 in ( dom C116 ) implies ( C116 . B118 ) = ( ( ( digits (C115 , 10) ) . B118 ) * ( 10 |^ B118 ) ))) and L807: ( value (( digits (C115 , 10) ) , 10) ) = ( Sum C116 ) by L46;
thus L808: (2 divides C115 implies 2 divides ( ( digits (C115 , 10) ) . ( 0 ) ))
proof
L809: ( len ( digits (C115 , 10) ) ) >= 1 by L686;
assume L810: 2 divides C115;
consider C117 being (XFinSequence of ( NAT )) such that L811: ( dom C117 ) = ( dom ( digits (C115 , 10) ) ) and L812: (for B119 being Nat holds (B119 in ( dom C117 ) implies ( C117 . B119 ) = ( ( ( digits (C115 , 10) ) . B119 ) * ( 10 |^ B119 ) ))) and L813: ( value (( digits (C115 , 10) ) , 10) ) = ( Sum C117 ) by L46;
per cases  by L809 , XXREAL_0:1;
suppose L814: ( len ( digits (C115 , 10) ) ) = 1;

L815: ( 0 ) in ( dom ( digits (C115 , 10) ) ) by L814 , NAT_1:44;
L816: 2 divides ( Sum C117 ) by L810 , L813 , L696;
L817: ( len C117 ) = 1 by L811 , L814;
L818: C117 = <% ( C117 . ( 0 ) ) %> by L817 , AFINSQ_1:34;
L819: ( Sum C117 ) = ( C117 . ( 0 ) ) by L818 , AFINSQ_2:53
.= ( ( ( digits (C115 , 10) ) . ( 0 ) ) * ( 10 |^ ( 0 ) ) ) by L811 , L812 , L815;
L820: 2 divides ( ( ( digits (C115 , 10) ) . ( 0 ) ) * 1 ) by L819 , L816 , NEWTON:4;
thus L821: thesis by L820;
end;
suppose L822: ( len ( digits (C115 , 10) ) ) > 1;

reconsider D94 = ( ( len ( digits (C115 , 10) ) ) - 1 ) as (Element of ( NAT )) by L822 , NAT_1:21;
defpred S16[ Nat , set ] means $2 = ( C117 . ( $1 + 1 ) );
L823:
now
let C118 being Nat;
assume L824: C118 in ( dom <% ( C117 . ( 0 ) ) %> );
L825: C118 in 1 by L824 , AFINSQ_1:def 4;
L826: C118 < 1 by L825 , NAT_1:44;
L827: C118 = ( 0 ) by L826 , NAT_1:14;
thus L828: ( C117 . C118 ) = ( <% ( C117 . ( 0 ) ) %> . C118 ) by L827 , AFINSQ_1:34;
end;
L829: (for B120 being Nat holds (B120 in D94 implies (ex B121 being (Element of ( NAT )) st S16[ B120 , B121 ])));
consider C119 being (XFinSequence of ( NAT )) such that L830: (( dom C119 ) = D94 & (for B122 being Nat holds (B122 in D94 implies S16[ B122 , ( C119 . B122 ) ]))) from STIRL2_1:sch 5(L829);
L831:
now
let C120 being Nat;
assume L832: C120 in ( dom C119 );
L833: C120 < D94 by L832 , L830 , NAT_1:44;
L834: ( C120 + 1 ) < ( D94 + 1 ) by L833 , XREAL_1:8;
L835: ( C120 + 1 ) in ( dom C117 ) by L834 , L811 , NAT_1:44;
L836: ( C119 . C120 ) = ( C117 . ( C120 + 1 ) ) by L830 , L832
.= ( ( ( digits (C115 , 10) ) . ( C120 + 1 ) ) * ( 10 |^ ( C120 + 1 ) ) ) by L812 , L835
.= ( ( ( digits (C115 , 10) ) . ( C120 + 1 ) ) * ( ( 10 |^ C120 ) * 10 ) ) by NEWTON:6
.= ( 2 * ( ( ( ( digits (C115 , 10) ) . ( C120 + 1 ) ) * ( 10 |^ C120 ) ) * 5 ) );
thus L837: 2 divides ( C119 . C120 ) by L836 , NAT_D:def 3;
end;
L838: 2 divides ( Sum C119 ) by L831 , L14;
L839: ( ( Sum C119 ) mod 2 ) = ( 0 ) by L838 , PEPIN:6;
L840:
now
let C121 being Nat;
L841: ( ( len <% ( C117 . ( 0 ) ) %> ) + C121 ) = ( C121 + 1 ) by AFINSQ_1:34;
assume L842: C121 in ( dom C119 );
thus L843: ( C117 . ( ( len <% ( C117 . ( 0 ) ) %> ) + C121 ) ) = ( C119 . C121 ) by L842 , L830 , L841;
end;
L844: ( dom C117 ) = ( D94 + 1 ) by L811
.= ( ( len <% ( C117 . ( 0 ) ) %> ) + ( len C119 ) ) by L830 , AFINSQ_1:33;
L845: C117 = ( <% ( C117 . ( 0 ) ) %> ^ C119 ) by L844 , L823 , L840 , AFINSQ_1:def 3;
L846: ( Sum C117 ) = ( ( Sum <% ( C117 . ( 0 ) ) %> ) + ( Sum C119 ) ) by L845 , AFINSQ_2:55;
L847: C115 = ( ( Sum <% ( C117 . ( 0 ) ) %> ) + ( Sum C119 ) ) by L846 , L813 , L696;
L848: C115 = ( ( C117 . ( 0 ) ) + ( Sum C119 ) ) by L847 , AFINSQ_2:53;
L849: ( ( ( C117 . ( 0 ) ) + ( Sum C119 ) ) mod 2 ) = ( 0 ) by L848 , L810 , PEPIN:6;
L850: ( ( C117 . ( 0 ) ) mod 2 ) = ( 0 ) by L849 , L839 , NAT_D:17;
L851: 2 divides ( C117 . ( 0 ) ) by L850 , PEPIN:6;
L852: ( 0 ) in ( dom ( digits (C115 , 10) ) ) by L822 , NAT_1:44;
L853: 2 divides ( ( ( digits (C115 , 10) ) . ( 0 ) ) * ( 10 |^ ( 0 ) ) ) by L852 , L811 , L812 , L851;
L854: 2 divides ( ( ( digits (C115 , 10) ) . ( 0 ) ) * 1 ) by L853 , NEWTON:4;
thus L855: thesis by L854;
end;
end;

assume L857: 2 divides ( ( digits (C115 , 10) ) . ( 0 ) );
L858:
now
let C122 being Nat;
assume L859: C122 in ( dom C116 );
per cases ;
suppose L860: C122 = ( 0 );

L861: ( C116 . C122 ) = ( ( ( digits (C115 , 10) ) . ( 0 ) ) * ( 10 |^ ( 0 ) ) ) by L860 , L806 , L859
.= ( ( ( digits (C115 , 10) ) . ( 0 ) ) * 1 ) by NEWTON:4;
thus L862: 2 divides ( C116 . C122 ) by L861 , L857;
end;
suppose L863: C122 > ( 0 );

consider C123 being Nat such that L864: ( C123 + 1 ) = C122 by L863 , NAT_1:6;
L865: ( C116 . C122 ) = ( ( ( digits (C115 , 10) ) . C122 ) * ( 10 |^ ( C123 + 1 ) ) ) by L806 , L859 , L864
.= ( ( ( digits (C115 , 10) ) . C122 ) * ( ( 10 |^ C123 ) * 10 ) ) by NEWTON:6
.= ( 2 * ( ( ( ( digits (C115 , 10) ) . C122 ) * ( 10 |^ C123 ) ) * 5 ) );
thus L866: 2 divides ( C116 . C122 ) by L865 , NAT_D:def 3;
end;
end;
L868: 2 divides ( value (( digits (C115 , 10) ) , 10) ) by L858 , L807 , L14;
thus L869: thesis by L868 , L696;
end;
::$N Divisibility by 3 Rule
theorem
L870: (for B123 being Nat holds (3 divides B123 iff 3 divides ( Sum ( digits (B123 , 10) ) )))
proof
let C124 being Nat;
consider C125 being (XFinSequence of ( NAT )) such that L871: ( dom C125 ) = ( dom ( digits (C124 , 10) ) ) and L872: (for B124 being Nat holds (B124 in ( dom C125 ) implies ( C125 . B124 ) = ( ( ( digits (C124 , 10) ) . B124 ) * ( 10 |^ B124 ) ))) and L873: ( value (( digits (C124 , 10) ) , 10) ) = ( Sum C125 ) by L46;
reconsider D95 = ( dom C125 ) as (Element of ( NAT )) by ORDINAL1:def 12;
defpred S17[ set , set ] means $2 = ( ( C125 . $1 ) mod 3 );
L874: (for B125 being Nat holds (B125 in D95 implies (ex B126 being (Element of ( NAT )) st S17[ B125 , B126 ])));
consider C126 being (XFinSequence of ( NAT )) such that L875: (( dom C126 ) = D95 & (for B127 being Nat holds (B127 in D95 implies S17[ B127 , ( C126 . B127 ) ]))) from STIRL2_1:sch 5(L874);
L876:
now
let C127 being Nat;
reconsider D96 = ( ( 10 |^ C127 ) - 1 ) as Nat by NAT_1:20 , NEWTON:83;
reconsider D97 = D96 as (Element of ( NAT )) by ORDINAL1:def 12;
L877: (3 divides ( 3 * 3 ) & 9 divides D97) by L710 , NAT_D:def 3;
L878: 3 divides D97 by L877 , NAT_D:4;
L879: 3 divides ( ( ( digits (C124 , 10) ) . C127 ) * D97 ) by L878 , NAT_D:9;
L880: ( ( ( ( digits (C124 , 10) ) . C127 ) * D97 ) mod 3 ) = ( 0 ) by L879 , PEPIN:6;
assume L881: C127 in ( dom C125 );
thus L882: ( C126 . C127 ) = ( ( C125 . C127 ) mod 3 ) by L881 , L875
.= ( ( ( ( digits (C124 , 10) ) . C127 ) * ( D97 + 1 ) ) mod 3 ) by L872 , L881
.= ( ( ( ( ( digits (C124 , 10) ) . C127 ) * D97 ) + ( ( digits (C124 , 10) ) . C127 ) ) mod 3 )
.= ( ( (( 0 ) qua Nat) + ( ( digits (C124 , 10) ) . C127 ) ) mod 3 ) by L880 , NAT_D:22
.= ( ( ( digits (C124 , 10) ) . C127 ) mod 3 );
end;
thus L883: (3 divides C124 implies 3 divides ( Sum ( digits (C124 , 10) ) ))
proof
assume L884: 3 divides C124;
L885: 3 divides ( Sum C125 ) by L884 , L873 , L696;
L886: ( ( Sum C125 ) mod 3 ) = ( 0 ) by L885 , PEPIN:6;
L887: ( ( Sum C126 ) mod 3 ) = ( 0 ) by L886 , L875 , L34;
L888: ( ( Sum ( digits (C124 , 10) ) ) mod 3 ) = ( 0 ) by L887 , L871 , L875 , L876 , L34;
thus L889: thesis by L888 , PEPIN:6;
end;

assume L890: 3 divides ( Sum ( digits (C124 , 10) ) );
L891: ( ( Sum ( digits (C124 , 10) ) ) mod 3 ) = ( 0 ) by L890 , PEPIN:6;
L892: ( ( Sum C126 ) mod 3 ) = ( 0 ) by L891 , L871 , L875 , L876 , L34;
L893: ( ( Sum C125 ) mod 3 ) = ( 0 ) by L892 , L875 , L34;
L894: 3 divides ( Sum C125 ) by L893 , PEPIN:6;
thus L895: thesis by L894 , L873 , L696;
end;
theorem
L896: (for B128 being Nat holds (5 divides B128 iff 5 divides ( ( digits (B128 , 10) ) . ( 0 ) )))
proof
let C128 being Nat;
consider C129 being (XFinSequence of ( NAT )) such that L897: ( dom C129 ) = ( dom ( digits (C128 , 10) ) ) and L898: (for B129 being Nat holds (B129 in ( dom C129 ) implies ( C129 . B129 ) = ( ( ( digits (C128 , 10) ) . B129 ) * ( 10 |^ B129 ) ))) and L899: ( value (( digits (C128 , 10) ) , 10) ) = ( Sum C129 ) by L46;
thus L900: (5 divides C128 implies 5 divides ( ( digits (C128 , 10) ) . ( 0 ) ))
proof
L901: ( len ( digits (C128 , 10) ) ) >= 1 by L686;
assume L902: 5 divides C128;
consider C130 being (XFinSequence of ( NAT )) such that L903: ( dom C130 ) = ( dom ( digits (C128 , 10) ) ) and L904: (for B130 being Nat holds (B130 in ( dom C130 ) implies ( C130 . B130 ) = ( ( ( digits (C128 , 10) ) . B130 ) * ( 10 |^ B130 ) ))) and L905: ( value (( digits (C128 , 10) ) , 10) ) = ( Sum C130 ) by L46;
per cases  by L901 , XXREAL_0:1;
suppose L906: ( len ( digits (C128 , 10) ) ) = 1;

L907: ( 0 ) in ( dom ( digits (C128 , 10) ) ) by L906 , NAT_1:44;
L908: 5 divides ( Sum C130 ) by L902 , L905 , L696;
L909: ( len C130 ) = 1 by L903 , L906;
L910: C130 = <% ( C130 . ( 0 ) ) %> by L909 , AFINSQ_1:34;
L911: ( Sum C130 ) = ( C130 . ( 0 ) ) by L910 , AFINSQ_2:53
.= ( ( ( digits (C128 , 10) ) . ( 0 ) ) * ( 10 |^ ( 0 ) ) ) by L903 , L904 , L907;
L912: 5 divides ( ( ( digits (C128 , 10) ) . ( 0 ) ) * 1 ) by L911 , L908 , NEWTON:4;
thus L913: thesis by L912;
end;
suppose L914: ( len ( digits (C128 , 10) ) ) > 1;

reconsider D98 = ( ( len ( digits (C128 , 10) ) ) - 1 ) as (Element of ( NAT )) by L914 , NAT_1:21;
defpred S18[ Nat , set ] means $2 = ( C130 . ( $1 + 1 ) );
L915:
now
let C131 being Nat;
assume L916: C131 in ( dom <% ( C130 . ( 0 ) ) %> );
L917: C131 in 1 by L916 , AFINSQ_1:def 4;
L918: C131 < 1 by L917 , NAT_1:44;
L919: C131 = ( 0 ) by L918 , NAT_1:14;
thus L920: ( C130 . C131 ) = ( <% ( C130 . ( 0 ) ) %> . C131 ) by L919 , AFINSQ_1:34;
end;
L921: (for B131 being Nat holds (B131 in D98 implies (ex B132 being (Element of ( NAT )) st S18[ B131 , B132 ])));
consider C132 being (XFinSequence of ( NAT )) such that L922: (( dom C132 ) = D98 & (for B133 being Nat holds (B133 in D98 implies S18[ B133 , ( C132 . B133 ) ]))) from STIRL2_1:sch 5(L921);
L923:
now
let C133 being Nat;
assume L924: C133 in ( dom C132 );
L925: C133 < D98 by L924 , L922 , NAT_1:44;
L926: ( C133 + 1 ) < ( D98 + 1 ) by L925 , XREAL_1:8;
L927: ( C133 + 1 ) in ( dom C130 ) by L926 , L903 , NAT_1:44;
L928: ( C132 . C133 ) = ( C130 . ( C133 + 1 ) ) by L922 , L924
.= ( ( ( digits (C128 , 10) ) . ( C133 + 1 ) ) * ( 10 |^ ( C133 + 1 ) ) ) by L904 , L927
.= ( ( ( digits (C128 , 10) ) . ( C133 + 1 ) ) * ( ( 10 |^ C133 ) * 10 ) ) by NEWTON:6
.= ( 5 * ( ( ( ( digits (C128 , 10) ) . ( C133 + 1 ) ) * ( 10 |^ C133 ) ) * 2 ) );
thus L929: 5 divides ( C132 . C133 ) by L928 , NAT_D:def 3;
end;
L930: 5 divides ( Sum C132 ) by L923 , L14;
L931: ( ( Sum C132 ) mod 5 ) = ( 0 ) by L930 , PEPIN:6;
L932:
now
let C134 being Nat;
L933: ( ( len <% ( C130 . ( 0 ) ) %> ) + C134 ) = ( C134 + 1 ) by AFINSQ_1:34;
assume L934: C134 in ( dom C132 );
thus L935: ( C130 . ( ( len <% ( C130 . ( 0 ) ) %> ) + C134 ) ) = ( C132 . C134 ) by L934 , L922 , L933;
end;
L936: ( dom C130 ) = ( D98 + 1 ) by L903
.= ( ( len <% ( C130 . ( 0 ) ) %> ) + ( len C132 ) ) by L922 , AFINSQ_1:33;
L937: C130 = ( <% ( C130 . ( 0 ) ) %> ^ C132 ) by L936 , L915 , L932 , AFINSQ_1:def 3;
L938: ( Sum C130 ) = ( ( Sum <% ( C130 . ( 0 ) ) %> ) + ( Sum C132 ) ) by L937 , AFINSQ_2:55;
L939: C128 = ( ( Sum <% ( C130 . ( 0 ) ) %> ) + ( Sum C132 ) ) by L938 , L905 , L696;
L940: C128 = ( ( C130 . ( 0 ) ) + ( Sum C132 ) ) by L939 , AFINSQ_2:53;
L941: ( ( ( C130 . ( 0 ) ) + ( Sum C132 ) ) mod 5 ) = ( 0 ) by L940 , L902 , PEPIN:6;
L942: ( ( C130 . ( 0 ) ) mod 5 ) = ( 0 ) by L941 , L931 , NAT_D:17;
L943: 5 divides ( C130 . ( 0 ) ) by L942 , PEPIN:6;
L944: ( 0 ) in ( dom ( digits (C128 , 10) ) ) by L914 , NAT_1:44;
L945: 5 divides ( ( ( digits (C128 , 10) ) . ( 0 ) ) * ( 10 |^ ( 0 ) ) ) by L944 , L903 , L904 , L943;
L946: 5 divides ( ( ( digits (C128 , 10) ) . ( 0 ) ) * 1 ) by L945 , NEWTON:4;
thus L947: thesis by L946;
end;
end;

assume L949: 5 divides ( ( digits (C128 , 10) ) . ( 0 ) );
L950:
now
let C135 being Nat;
assume L951: C135 in ( dom C129 );
per cases ;
suppose L952: C135 = ( 0 );

L953: ( C129 . C135 ) = ( ( ( digits (C128 , 10) ) . ( 0 ) ) * ( 10 |^ ( 0 ) ) ) by L952 , L898 , L951
.= ( ( ( digits (C128 , 10) ) . ( 0 ) ) * 1 ) by NEWTON:4;
thus L954: 5 divides ( C129 . C135 ) by L953 , L949;
end;
suppose L955: C135 > ( 0 );

consider C136 being Nat such that L956: ( C136 + 1 ) = C135 by L955 , NAT_1:6;
L957: ( C129 . C135 ) = ( ( ( digits (C128 , 10) ) . C135 ) * ( 10 |^ ( C136 + 1 ) ) ) by L898 , L951 , L956
.= ( ( ( digits (C128 , 10) ) . C135 ) * ( ( 10 |^ C136 ) * 10 ) ) by NEWTON:6
.= ( 5 * ( ( ( ( digits (C128 , 10) ) . C135 ) * ( 10 |^ C136 ) ) * 2 ) );
thus L958: 5 divides ( C129 . C135 ) by L957 , NAT_D:def 3;
end;
end;
L960: 5 divides ( value (( digits (C128 , 10) ) , 10) ) by L950 , L899 , L14;
thus L961: thesis by L960 , L696;
end;
