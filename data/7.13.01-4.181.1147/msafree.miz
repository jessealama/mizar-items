:: Free Many Sorted Universal Algebra
::  by Beata Perkowska
::
:: Received April 27, 1994
:: Copyright (c) 1994-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies XBOOLE_0, FUNCT_1, RELAT_1, PBOOLE, SUBSET_1, CARD_3, REALSET1,
      TARSKI, ZFMISC_1, PARTFUN1, STRUCT_0, MSUALG_1, MSUALG_2, PRELAMB,
      MSUALG_3, FINSEQ_1, MARGREL1, LANG1, TDGROUP, DTCONSTR, TREES_3, TREES_4,
      NAT_1, TREES_2, MCART_1, UNIALG_2, QC_LANG1, GROUP_6, MSAFREE;
 notations TARSKI, XBOOLE_0, ZFMISC_1,
      XTUPLE_0, SUBSET_1, ORDINAL1, NAT_1, RELAT_1,
      RELSET_1, STRUCT_0, FUNCT_1, PARTFUN1, MCART_1, FUNCT_2, FINSEQ_1,
      PBOOLE, TREES_2, FINSEQ_2, CARD_3, LANG1, TREES_4, DTCONSTR, MSUALG_1,
      MSUALG_2, MSUALG_3;
 constructors XXREAL_0, NAT_1, NAT_D, CARD_3, FINSEQOP, DTCONSTR, MSUALG_3,
      RELSET_1, PBOOLE, XTUPLE_0;
 registrations XBOOLE_0, SUBSET_1, RELAT_1, FUNCT_1, ORDINAL1, FUNCOP_1,
      FINSEQ_1, PBOOLE, TREES_2, TREES_3, STRUCT_0, DTCONSTR, MSUALG_1,
      MSUALG_3, FUNCT_2, PARTFUN1, RELSET_1, PRE_POLY, XTUPLE_0;
 requirements NUMERALS, BOOLE, SUBSET;
 definitions TARSKI, XBOOLE_0, PBOOLE, MSUALG_3, XTUPLE_0;
 theorems TARSKI, FUNCT_1, FUNCT_2, MCART_1, ZFMISC_1, PBOOLE, CARD_3,
      MSUALG_1, MSUALG_2, MSUALG_3, RELAT_1, LANG1, DTCONSTR, FINSEQ_1,
      TREES_4, TREES_1, DOMAIN_1, RELSET_1, XBOOLE_0, XBOOLE_1, FUNCOP_1,
      TREES_3, PARTFUN1, FINSEQ_3, FINSEQ_2, XTUPLE_0;
 schemes CLASSES1, FUNCT_1, RELSET_1, DTCONSTR, XBOOLE_0;

begin
theorem
L1: (for B1 being set holds (for B2 being non  empty set holds (for B3 being (Function of B1 , ( B2 * )) holds (for B4 being (ManySortedSet of B2) holds (for B5 being (Element of ( B2 * )) holds (for B6 being set holds ((B6 in B1 & B5 = ( B3 . B6 )) implies ( ( ( B4 # ) * B3 ) . B6 ) = ( product ( B4 * B5 ) ))))))))
proof
let C1 being set;
let C2 being non  empty set;
let C3 being (Function of C1 , ( C2 * ));
let C4 being (ManySortedSet of C2);
let C5 being (Element of ( C2 * ));
let C6 being set;
assume L2: (C6 in C1 & C5 = ( C3 . C6 ));
L3: ( dom C3 ) = C1 by FUNCT_2:def 1;
L4: ( dom ( ( C4 # ) * C3 ) ) = ( dom C3 ) by L3 , PARTFUN1:def 2;
thus L5: ( ( ( C4 # ) * C3 ) . C6 ) = ( (( C4 # ) qua (ManySortedSet of ( C2 * ))) . C5 ) by L4 , L2 , L3 , FUNCT_1:12
.= ( product ( C4 * C5 ) ) by FINSEQ_2:def 5;
end;
definition
let C7 being set;
let C8 , C9 being (ManySortedSet of C7);
let C10 being (ManySortedSubset of C8);
let C11 being (ManySortedFunction of C8 , C9);
func C11 || C10 -> (ManySortedFunction of C10 , C9) means 
:L6: (for B7 being set holds (B7 in C7 implies (for B8 being (Function of ( C8 . B7 ) , ( C9 . B7 )) holds (B8 = ( C11 . B7 ) implies ( it . B7 ) = ( B8 | ( C10 . B7 ) )))));
existence
proof
defpred S1[ set , set ] means (for B9 being (Function of ( C8 . $1 ) , ( C9 . $1 )) holds (B9 = ( C11 . $1 ) implies $2 = ( B9 | ( C10 . $1 ) )));
L7: (for B10 being set holds (B10 in C7 implies (ex B11 being set st S1[ B10 , B11 ])))
proof
let C12 being set;
assume L8: C12 in C7;
reconsider D1 = ( C11 . C12 ) as (Function of ( C8 . C12 ) , ( C9 . C12 )) by L8 , PBOOLE:def 15;
take ( D1 | ( C10 . C12 ) );
thus L9: thesis;
end;
consider C13 being Function such that L10: (( dom C13 ) = C7 & (for B12 being set holds (B12 in C7 implies S1[ B12 , ( C13 . B12 ) ]))) from CLASSES1:sch 1(L7);
reconsider D2 = C13 as (ManySortedSet of C7) by L10 , PARTFUN1:def 2 , RELAT_1:def 18;
L11: (for B13 being set holds (B13 in C7 implies ( D2 . B13 ) is (Function of ( C10 . B13 ) , ( C9 . B13 ))))
proof
let C14 being set;
assume L12: C14 in C7;
reconsider D3 = ( C11 . C14 ) as (Function of ( C8 . C14 ) , ( C9 . C14 )) by L12 , PBOOLE:def 15;
L13: ( D2 . C14 ) = ( D3 | ( C10 . C14 ) ) by L10 , L12;
L14: C10 c= C8 by PBOOLE:def 18;
L15: ( C10 . C14 ) c= ( C8 . C14 ) by L14 , L12 , PBOOLE:def 2;
per cases ;
suppose L16: ( C9 . C14 ) is  empty;

L17: ( D2 . C14 ) = ( {} ) by L16 , L13;
L18:
now
per cases ;
suppose L19: ( C10 . C14 ) = ( {} );

thus L20: thesis by L19 , L17 , RELSET_1:12;
end;
suppose L21: ( C10 . C14 ) <> ( {} );

thus L22: thesis by L16 , L17 , FUNCT_2:def 1 , RELSET_1:12;
end;
end;
thus L24: thesis by L18;
end;
suppose L25: ( C9 . C14 ) is non  empty;

L26: ( dom D3 ) = ( C8 . C14 ) by L25 , FUNCT_2:def 1;
L27: ( rng ( D3 | ( C10 . C14 ) ) ) c= ( C9 . C14 ) by RELAT_1:def 19;
L28: ( dom ( D3 | ( C10 . C14 ) ) ) = ( ( dom D3 ) /\ ( C10 . C14 ) ) by RELAT_1:61
.= ( C10 . C14 ) by L15 , L26 , XBOOLE_1:28;
thus L29: thesis by L28 , L13 , L25 , L27 , FUNCT_2:def 1 , RELSET_1:4;
end;
end;
reconsider D4 = D2 as (ManySortedFunction of C10 , C9) by L11 , PBOOLE:def 15;
take D4;
thus L31: thesis by L10;
end;
uniqueness
proof
let C15 , C16 being (ManySortedFunction of C10 , C9);
assume that
L32: (for B14 being set holds (B14 in C7 implies (for B15 being (Function of ( C8 . B14 ) , ( C9 . B14 )) holds (B15 = ( C11 . B14 ) implies ( C15 . B14 ) = ( B15 | ( C10 . B14 ) )))))
and
L33: (for B16 being set holds (B16 in C7 implies (for B17 being (Function of ( C8 . B16 ) , ( C9 . B16 )) holds (B17 = ( C11 . B16 ) implies ( C16 . B16 ) = ( B17 | ( C10 . B16 ) )))));
L34: (for B18 being set holds (B18 in C7 implies ( C15 . B18 ) = ( C16 . B18 )))
proof
let C17 being set;
assume L35: C17 in C7;
reconsider D5 = ( C11 . C17 ) as (Function of ( C8 . C17 ) , ( C9 . C17 )) by L35 , PBOOLE:def 15;
L36: ( C15 . C17 ) = ( D5 | ( C10 . C17 ) ) by L32 , L35;
thus L37: thesis by L36 , L33 , L35;
end;
thus L38: thesis by L34 , PBOOLE:3;
end;
end;
definition
let C18 being set;
let C19 being (ManySortedSet of C18);
let C20 being set;
assume L40: C20 in C18;
func coprod (C20 , C19) -> set means 
:L41: (for B19 being set holds (B19 in it iff (ex B20 being set st (B20 in ( C19 . C20 ) & B19 = [ B20 , C20 ]))));
existence
proof
defpred S2[ set ] means (ex B21 being set st (B21 in ( C19 . C20 ) & $1 = [ B21 , C20 ]));
consider C21 being set such that L42: (for B22 being set holds (B22 in C21 iff (B22 in [: ( C19 . C20 ) , C18 :] & S2[ B22 ]))) from XBOOLE_0:sch 1;
take C21;
let C22 being set;
thus L43: (C22 in C21 implies (ex B23 being set st (B23 in ( C19 . C20 ) & C22 = [ B23 , C20 ]))) by L42;
given C23 being set such that
L44: (C23 in ( C19 . C20 ) & C22 = [ C23 , C20 ]);

L45: C22 in [: ( C19 . C20 ) , C18 :] by L40 , L44 , ZFMISC_1:87;
thus L46: thesis by L45 , L42 , L44;
end;
uniqueness
proof
let C24 , C25 being set;
assume that
L47: (for B24 being set holds (B24 in C24 iff (ex B25 being set st (B25 in ( C19 . C20 ) & B24 = [ B25 , C20 ]))))
and
L48: (for B26 being set holds (B26 in C25 iff (ex B27 being set st (B27 in ( C19 . C20 ) & B26 = [ B27 , C20 ]))));
thus L49: C24 c= C25
proof
let C26 being set;
assume L50: C26 in C24;
L51: (ex B28 being set st (B28 in ( C19 . C20 ) & C26 = [ B28 , C20 ])) by L50 , L47;
thus L52: thesis by L51 , L48;
end;

let C27 being set;
assume L53: C27 in C25;
L54: (ex B29 being set st (B29 in ( C19 . C20 ) & C27 = [ B29 , C20 ])) by L53 , L48;
thus L55: thesis by L54 , L47;
end;
end;
notation
let C28 being set;
let C29 being (ManySortedSet of C28);
synonym coprod C29 for disjoin C29;
end;
registration
let C30 being set;
let C31 being (ManySortedSet of C30);
cluster ( coprod C31 ) -> C30 -defined;
coherence
proof
L58: ( dom ( coprod C31 ) ) = ( dom C31 ) by CARD_3:def 3;
L59: ( dom ( coprod C31 ) ) = C30 by L58 , PARTFUN1:def 2;
thus L60: thesis by L59 , RELAT_1:def 18;
end;
end;
registration
let C32 being set;
let C33 being (ManySortedSet of C32);
cluster ( coprod C33 ) ->  total;
coherence
proof
L62: ( dom ( coprod C33 ) ) = ( dom C33 ) by CARD_3:def 3;
L63: ( dom ( coprod C33 ) ) = C32 by L62 , PARTFUN1:def 2;
thus L64: thesis by L63 , PARTFUN1:def 2;
end;
end;
definition
let C34 being set;
let C35 being (ManySortedSet of C34);
redefine func coprod C35 means 
:L66: (( dom it ) = C34 & (for B30 being set holds (B30 in C34 implies ( it . B30 ) = ( coprod (B30 , C35) ))));
compatibility
proof
let C36 being Function;
thus L67:now
assume L68: C36 = ( disjoin C35 );
thus L69: ( dom C36 ) = C34 by L68 , PARTFUN1:def 2;
let C37 being set;
assume L70: C37 in C34;
L71: C37 in ( dom C35 ) by L70 , PARTFUN1:def 2;
L72: ( C36 . C37 ) = [: ( C35 . C37 ) , { C37 } :] by L71 , L68 , CARD_3:def 3;
L73:
now
let C38 being set;
thus L74:now
assume L75: C38 in ( C36 . C37 );
consider C39 , C40 being set such that L76: C39 in ( C35 . C37 ) and L77: (C40 in { C37 } & C38 = [ C39 , C40 ]) by L75 , L72 , ZFMISC_1:def 2;
take D6 = C39;
thus L78: D6 in ( C35 . C37 ) by L76;
thus L79: C38 = [ D6 , C37 ] by L77 , TARSKI:def 1;
end;
given C41 being set such that
L80: (C41 in ( C35 . C37 ) & C38 = [ C41 , C37 ]);

L81: C37 in { C37 } by TARSKI:def 1;
thus L82: C38 in ( C36 . C37 ) by L81 , L72 , L80 , ZFMISC_1:def 2;
end;
thus L83: ( C36 . C37 ) = ( coprod (C37 , C35) ) by L73 , L70 , L41;
end;
assume that
L84: ( dom C36 ) = C34
and
L85: (for B31 being set holds (B31 in C34 implies ( C36 . B31 ) = ( coprod (B31 , C35) )));
L86: ( dom C36 ) = ( dom C35 ) by L84 , PARTFUN1:def 2;
L87:
now
let C42 being set;
assume L88: C42 in ( dom C35 );
L89: C42 in C34 by L88;
L90:
now
let C43 being set;
thus L91:now
assume L92: C43 in ( coprod (C42 , C35) );
L93: (ex B32 being set st (B32 in ( C35 . C42 ) & C43 = [ B32 , C42 ])) by L92 , L89 , L41;
L94: C42 in { C42 } by TARSKI:def 1;
thus L95: C43 in [: ( C35 . C42 ) , { C42 } :] by L94 , L93 , ZFMISC_1:def 2;
end;
assume L96: C43 in [: ( C35 . C42 ) , { C42 } :];
consider C44 , C45 being set such that L97: C44 in ( C35 . C42 ) and L98: C45 in { C42 } and L99: C43 = [ C44 , C45 ] by L96 , ZFMISC_1:def 2;
L100: C45 = C42 by L98 , TARSKI:def 1;
thus L101: C43 in ( coprod (C42 , C35) ) by L100 , L89 , L97 , L99 , L41;
end;
thus L102: ( C36 . C42 ) = ( coprod (C42 , C35) ) by L85 , L88
.= [: ( C35 . C42 ) , { C42 } :] by L90 , TARSKI:1;
end;
thus L103: thesis by L87 , L86 , CARD_3:def 3;
end;
end;
registration
let C46 being non  empty set;
let C47 being  non-empty (ManySortedSet of C46);
cluster ( coprod C47 ) ->  non-empty;
coherence
proof
L105:
now
let C48 being set;
assume L106: C48 in C46;
reconsider D7 = C48 as (Element of C46) by L106;
consider C49 being set such that L107: C49 in ( C47 . D7 ) by XBOOLE_0:def 1;
L108: ( ( coprod C47 ) . D7 ) = ( coprod (D7 , C47) ) by L66;
L109: [ C49 , D7 ] in ( ( coprod C47 ) . D7 ) by L108 , L107 , L41;
thus L110: ( ( coprod C47 ) . C48 ) is non  empty by L109;
end;
thus L111: thesis by L105 , PBOOLE:def 13;
end;
end;
registration
let C50 being non  empty set;
let C51 being  non-empty (ManySortedSet of C50);
cluster ( Union C51 ) -> non  empty;
coherence
proof
set D8 = the (Element of C50);
consider C52 being set such that L113: C52 in ( C51 . D8 ) by XBOOLE_0:def 1;
L114: ( dom C51 ) = C50 by PARTFUN1:def 2;
L115: ( C51 . D8 ) in ( rng C51 ) by L114 , FUNCT_1:def 3;
L116: C52 in ( union ( rng C51 ) ) by L115 , L113 , TARSKI:def 4;
thus L117: thesis by L116 , CARD_3:def 4;
end;
end;
theorem
L119: (for B33 being set holds (for B34 being (ManySortedSet of B33) holds (for B35 being set holds (B35 in B33 implies (( B34 . B35 ) <> ( {} ) iff ( ( coprod B34 ) . B35 ) <> ( {} ))))))
proof
let C53 being set;
let C54 being (ManySortedSet of C53);
let C55 being set;
assume L120: C55 in C53;
L121: ( ( coprod C54 ) . C55 ) = ( coprod (C55 , C54) ) by L120 , L66;
thus L122: (( C54 . C55 ) <> ( {} ) implies ( ( coprod C54 ) . C55 ) <> ( {} ))
proof
assume L123: ( C54 . C55 ) <> ( {} );
consider C56 being set such that L124: C56 in ( C54 . C55 ) by L123 , XBOOLE_0:def 1;
L125: [ C56 , C55 ] in ( ( coprod C54 ) . C55 ) by L120 , L121 , L124 , L41;
thus L126: thesis by L125;
end;

assume L127: ( ( coprod C54 ) . C55 ) <> ( {} );
consider C57 being set such that L128: C57 in ( coprod (C55 , C54) ) by L127 , L121 , XBOOLE_0:def 1;
L129: (ex B36 being set st (B36 in ( C54 . C55 ) & C57 = [ B36 , C55 ])) by L120 , L128 , L41;
thus L130: thesis by L129;
end;
begin
definition
let C58 being non  void non  empty ManySortedSign;
let C59 being MSAlgebra over C58;
mode GeneratorSet of C59
 -> (MSSubset of C59)
means :L131: (the Sorts of ( GenMSAlg it )) = (the Sorts of C59);
existence
proof
set D9 = (the Sorts of C59);
reconsider D10 = D9 as (MSSubset of C59) by PBOOLE:def 18;
take D10;
set D11 = ( GenMSAlg D10 );
L132: (the Sorts of D11) is (MSSubset of C59) by MSUALG_2:def 9;
L133: (the Sorts of D11) c= D10 by L132 , PBOOLE:def 18;
L134: D10 is (MSSubset of D11) by MSUALG_2:def 17;
L135: D10 c= (the Sorts of D11) by L134 , PBOOLE:def 18;
thus L136: thesis by L135 , L133 , PBOOLE:146;
end;
end;
theorem
L138: (for B37 being non  void non  empty ManySortedSign holds (for B38 being  strict  non-empty MSAlgebra over B37 holds (for B39 being (MSSubset of B38) holds (B39 is (GeneratorSet of B38) iff ( GenMSAlg B39 ) = B38))))
proof
let C60 being non  void non  empty ManySortedSign;
let C61 being  strict  non-empty MSAlgebra over C60;
let C62 being (MSSubset of C61);
thus L139: (C62 is (GeneratorSet of C61) implies ( GenMSAlg C62 ) = C61)
proof
reconsider D12 = C61 as (MSSubAlgebra of C61) by MSUALG_2:5;
assume L140: C62 is (GeneratorSet of C61);
L141: (the Sorts of ( GenMSAlg C62 )) = (the Sorts of D12) by L140 , L131;
thus L142: thesis by L141 , MSUALG_2:9;
end;

assume L143: ( GenMSAlg C62 ) = C61;
thus L144: thesis by L143 , L131;
end;
definition
let R1 being non  void non  empty ManySortedSign;
let R2 being MSAlgebra over R1;
let C63 being (GeneratorSet of R2);
attr C63 is  free
means
:L145: (for B40 being  non-empty MSAlgebra over R1 holds (for B41 being (ManySortedFunction of C63 , (the Sorts of B40)) holds (ex B42 being (ManySortedFunction of R2 , B40) st (B42 is_homomorphism R2 , B40 & ( B42 || C63 ) = B41))));
end;
definition
let C64 being non  void non  empty ManySortedSign;
let C65 being MSAlgebra over C64;
attr C65 is  free
means
:L147: (ex B43 being (GeneratorSet of C65) st B43 is  free);
end;
theorem
L149: (for B44 being non  void non  empty ManySortedSign holds (for B45 being (ManySortedSet of (the carrier of B44)) holds ( Union ( coprod B45 ) ) misses [: (the carrier' of B44) , { (the carrier of B44) } :]))
proof
let C66 being non  void non  empty ManySortedSign;
let C67 being (ManySortedSet of (the carrier of C66));
assume L150: ( ( Union ( coprod C67 ) ) /\ [: (the carrier' of C66) , { (the carrier of C66) } :] ) <> ( {} );
consider C68 being set such that L151: C68 in ( ( Union ( coprod C67 ) ) /\ [: (the carrier' of C66) , { (the carrier of C66) } :] ) by L150 , XBOOLE_0:def 1;
L152: C68 in ( Union ( coprod C67 ) ) by L151 , XBOOLE_0:def 4;
L153: C68 in ( union ( rng ( coprod C67 ) ) ) by L152 , CARD_3:def 4;
consider C69 being set such that L154: C68 in C69 and L155: C69 in ( rng ( coprod C67 ) ) by L153 , TARSKI:def 4;
consider C70 being set such that L156: C70 in ( dom ( coprod C67 ) ) and L157: ( ( coprod C67 ) . C70 ) = C69 by L155 , FUNCT_1:def 3;
reconsider D13 = C70 as (SortSymbol of C66) by L156;
L158: C69 = ( coprod (D13 , C67) ) by L157 , L66;
L159: (ex B46 being set st (B46 in ( C67 . D13 ) & C68 = [ B46 , D13 ])) by L158 , L154 , L41;
L160: C68 in [: (the carrier' of C66) , { (the carrier of C66) } :] by L151 , XBOOLE_0:def 4;
L161: D13 in { (the carrier of C66) } by L160 , L159 , ZFMISC_1:87;
L162: (D13 in (the carrier of C66) & D13 = (the carrier of C66)) by L161 , TARSKI:def 1;
thus L163: contradiction by L162;
end;
begin
definition
let C71 being non  void non  empty ManySortedSign;
let C72 being (ManySortedSet of (the carrier of C71));
func REL C72 -> (Relation of ( [: (the carrier' of C71) , { (the carrier of C71) } :] \/ ( Union ( coprod C72 ) ) ) , ( ( [: (the carrier' of C71) , { (the carrier of C71) } :] \/ ( Union ( coprod C72 ) ) ) * )) means 
:L164: (for B47 being (Element of ( [: (the carrier' of C71) , { (the carrier of C71) } :] \/ ( Union ( coprod C72 ) ) )) holds (for B48 being (Element of ( ( [: (the carrier' of C71) , { (the carrier of C71) } :] \/ ( Union ( coprod C72 ) ) ) * )) holds ([ B47 , B48 ] in it iff (B47 in [: (the carrier' of C71) , { (the carrier of C71) } :] & (for B49 being (OperSymbol of C71) holds ([ B49 , (the carrier of C71) ] = B47 implies (( len B48 ) = ( len ( the_arity_of B49 ) ) & (for B50 being set holds (B50 in ( dom B48 ) implies ((( B48 . B50 ) in [: (the carrier' of C71) , { (the carrier of C71) } :] implies (for B51 being (OperSymbol of C71) holds ([ B51 , (the carrier of C71) ] = ( B48 . B50 ) implies ( the_result_sort_of B51 ) = ( ( the_arity_of B49 ) . B50 )))) & (( B48 . B50 ) in ( Union ( coprod C72 ) ) implies ( B48 . B50 ) in ( coprod (( ( the_arity_of B49 ) . B50 ) , C72) ))))))))))));
existence
proof
set D14 = ( [: (the carrier' of C71) , { (the carrier of C71) } :] \/ ( Union ( coprod C72 ) ) );
defpred S3[ (Element of D14) , (Element of ( D14 * )) ] means ($1 in [: (the carrier' of C71) , { (the carrier of C71) } :] & (for B52 being (OperSymbol of C71) holds ([ B52 , (the carrier of C71) ] = $1 implies (( len $2 ) = ( len ( the_arity_of B52 ) ) & (for B53 being set holds (B53 in ( dom $2 ) implies ((( $2 . B53 ) in [: (the carrier' of C71) , { (the carrier of C71) } :] implies (for B54 being (OperSymbol of C71) holds ([ B54 , (the carrier of C71) ] = ( $2 . B53 ) implies ( the_result_sort_of B54 ) = ( ( the_arity_of B52 ) . B53 )))) & (( $2 . B53 ) in ( Union ( coprod C72 ) ) implies ( $2 . B53 ) in ( coprod (( ( the_arity_of B52 ) . B53 ) , C72) )))))))));
consider C73 being (Relation of D14 , ( D14 * )) such that L165: (for B55 being (Element of D14) holds (for B56 being (Element of ( D14 * )) holds ([ B55 , B56 ] in C73 iff S3[ B55 , B56 ]))) from RELSET_1:sch 2;
take C73;
let C74 being (Element of D14);
let C75 being (Element of ( D14 * ));
thus L166: ([ C74 , C75 ] in C73 implies (C74 in [: (the carrier' of C71) , { (the carrier of C71) } :] & (for B57 being (OperSymbol of C71) holds ([ B57 , (the carrier of C71) ] = C74 implies (( len C75 ) = ( len ( the_arity_of B57 ) ) & (for B58 being set holds (B58 in ( dom C75 ) implies ((( C75 . B58 ) in [: (the carrier' of C71) , { (the carrier of C71) } :] implies (for B59 being (OperSymbol of C71) holds ([ B59 , (the carrier of C71) ] = ( C75 . B58 ) implies ( the_result_sort_of B59 ) = ( ( the_arity_of B57 ) . B58 )))) & (( C75 . B58 ) in ( Union ( coprod C72 ) ) implies ( C75 . B58 ) in ( coprod (( ( the_arity_of B57 ) . B58 ) , C72) )))))))))) by L165;
assume L167: (C74 in [: (the carrier' of C71) , { (the carrier of C71) } :] & (for B60 being (OperSymbol of C71) holds ([ B60 , (the carrier of C71) ] = C74 implies (( len C75 ) = ( len ( the_arity_of B60 ) ) & (for B61 being set holds (B61 in ( dom C75 ) implies ((( C75 . B61 ) in [: (the carrier' of C71) , { (the carrier of C71) } :] implies (for B62 being (OperSymbol of C71) holds ([ B62 , (the carrier of C71) ] = ( C75 . B61 ) implies ( the_result_sort_of B62 ) = ( ( the_arity_of B60 ) . B61 )))) & (( C75 . B61 ) in ( Union ( coprod C72 ) ) implies ( C75 . B61 ) in ( coprod (( ( the_arity_of B60 ) . B61 ) , C72) )))))))));
thus L168: thesis by L167 , L165;
end;
uniqueness
proof
set D15 = ( [: (the carrier' of C71) , { (the carrier of C71) } :] \/ ( Union ( coprod C72 ) ) );
let C76 , C77 being (Relation of D15 , ( D15 * ));
assume that
L169: (for B63 being (Element of D15) holds (for B64 being (Element of ( D15 * )) holds ([ B63 , B64 ] in C76 iff (B63 in [: (the carrier' of C71) , { (the carrier of C71) } :] & (for B65 being (OperSymbol of C71) holds ([ B65 , (the carrier of C71) ] = B63 implies (( len B64 ) = ( len ( the_arity_of B65 ) ) & (for B66 being set holds (B66 in ( dom B64 ) implies ((( B64 . B66 ) in [: (the carrier' of C71) , { (the carrier of C71) } :] implies (for B67 being (OperSymbol of C71) holds ([ B67 , (the carrier of C71) ] = ( B64 . B66 ) implies ( the_result_sort_of B67 ) = ( ( the_arity_of B65 ) . B66 )))) & (( B64 . B66 ) in ( Union ( coprod C72 ) ) implies ( B64 . B66 ) in ( coprod (( ( the_arity_of B65 ) . B66 ) , C72) ))))))))))))
and
L170: (for B68 being (Element of D15) holds (for B69 being (Element of ( D15 * )) holds ([ B68 , B69 ] in C77 iff (B68 in [: (the carrier' of C71) , { (the carrier of C71) } :] & (for B70 being (OperSymbol of C71) holds ([ B70 , (the carrier of C71) ] = B68 implies (( len B69 ) = ( len ( the_arity_of B70 ) ) & (for B71 being set holds (B71 in ( dom B69 ) implies ((( B69 . B71 ) in [: (the carrier' of C71) , { (the carrier of C71) } :] implies (for B72 being (OperSymbol of C71) holds ([ B72 , (the carrier of C71) ] = ( B69 . B71 ) implies ( the_result_sort_of B72 ) = ( ( the_arity_of B70 ) . B71 )))) & (( B69 . B71 ) in ( Union ( coprod C72 ) ) implies ( B69 . B71 ) in ( coprod (( ( the_arity_of B70 ) . B71 ) , C72) ))))))))))));
L171: (for B73 , B74 being set holds ([ B73 , B74 ] in C76 iff [ B73 , B74 ] in C77))
proof
let C78 , C79 being set;
thus L172: ([ C78 , C79 ] in C76 implies [ C78 , C79 ] in C77)
proof
assume L173: [ C78 , C79 ] in C76;
reconsider D16 = C78 as (Element of D15) by L173 , ZFMISC_1:87;
reconsider D17 = C79 as (Element of ( D15 * )) by L173 , ZFMISC_1:87;
L174: [ D16 , D17 ] in C76 by L173;
L175: D16 in [: (the carrier' of C71) , { (the carrier of C71) } :] by L174 , L169;
L176: (for B75 being (OperSymbol of C71) holds ([ B75 , (the carrier of C71) ] = D16 implies (( len D17 ) = ( len ( the_arity_of B75 ) ) & (for B76 being set holds (B76 in ( dom D17 ) implies ((( D17 . B76 ) in [: (the carrier' of C71) , { (the carrier of C71) } :] implies (for B77 being (OperSymbol of C71) holds ([ B77 , (the carrier of C71) ] = ( D17 . B76 ) implies ( the_result_sort_of B77 ) = ( ( the_arity_of B75 ) . B76 )))) & (( D17 . B76 ) in ( Union ( coprod C72 ) ) implies ( D17 . B76 ) in ( coprod (( ( the_arity_of B75 ) . B76 ) , C72) )))))))) by L169 , L173;
thus L177: thesis by L176 , L170 , L175;
end;

assume L178: [ C78 , C79 ] in C77;
reconsider D18 = C78 as (Element of D15) by L178 , ZFMISC_1:87;
reconsider D19 = C79 as (Element of ( D15 * )) by L178 , ZFMISC_1:87;
L179: [ D18 , D19 ] in C77 by L178;
L180: D18 in [: (the carrier' of C71) , { (the carrier of C71) } :] by L179 , L170;
L181: (for B78 being (OperSymbol of C71) holds ([ B78 , (the carrier of C71) ] = D18 implies (( len D19 ) = ( len ( the_arity_of B78 ) ) & (for B79 being set holds (B79 in ( dom D19 ) implies ((( D19 . B79 ) in [: (the carrier' of C71) , { (the carrier of C71) } :] implies (for B80 being (OperSymbol of C71) holds ([ B80 , (the carrier of C71) ] = ( D19 . B79 ) implies ( the_result_sort_of B80 ) = ( ( the_arity_of B78 ) . B79 )))) & (( D19 . B79 ) in ( Union ( coprod C72 ) ) implies ( D19 . B79 ) in ( coprod (( ( the_arity_of B78 ) . B79 ) , C72) )))))))) by L170 , L178;
thus L182: thesis by L181 , L169 , L180;
end;
thus L183: thesis by L171 , RELAT_1:def 2;
end;
end;
theorem
L185: (for R3 being non  void non  empty ManySortedSign holds (for R4 being (ManySortedSet of (the carrier of R3)) holds (for R5 being (OperSymbol of R3) holds (for R6 being (Element of ( ( [: (the carrier' of R3) , { (the carrier of R3) } :] \/ ( Union ( coprod R4 ) ) ) * )) holds ([ [ R5 , (the carrier of R3) ] , R6 ] in ( REL R4 ) iff (( len R6 ) = ( len ( the_arity_of R5 ) ) & (for B81 being set holds (B81 in ( dom R6 ) implies ((( R6 . B81 ) in [: (the carrier' of R3) , { (the carrier of R3) } :] implies (for B82 being (OperSymbol of R3) holds ([ B82 , (the carrier of R3) ] = ( R6 . B81 ) implies ( the_result_sort_of B82 ) = ( ( the_arity_of R5 ) . B81 )))) & (( R6 . B81 ) in ( Union ( coprod R4 ) ) implies ( R6 . B81 ) in ( coprod (( ( the_arity_of R5 ) . B81 ) , R4) )))))))))))
proof
let R3 being non  void non  empty ManySortedSign;
let R4 being (ManySortedSet of (the carrier of R3));
let R5 being (OperSymbol of R3);
let R6 being (Element of ( ( [: (the carrier' of R3) , { (the carrier of R3) } :] \/ ( Union ( coprod R4 ) ) ) * ));
defpred S4[ (OperSymbol of R3) , (Element of ( ( [: (the carrier' of R3) , { (the carrier of R3) } :] \/ ( Union ( coprod R4 ) ) ) * )) ] means (( len $2 ) = ( len ( the_arity_of $1 ) ) & (for B83 being set holds (B83 in ( dom $2 ) implies ((( $2 . B83 ) in [: (the carrier' of R3) , { (the carrier of R3) } :] implies (for B84 being (OperSymbol of R3) holds ([ B84 , (the carrier of R3) ] = ( $2 . B83 ) implies ( the_result_sort_of B84 ) = ( ( the_arity_of $1 ) . B83 )))) & (( $2 . B83 ) in ( Union ( coprod R4 ) ) implies ( R6 . B83 ) in ( coprod (( ( the_arity_of $1 ) . B83 ) , R4) ))))));
set D20 = [ R5 , (the carrier of R3) ];
L186: (the carrier of R3) in { (the carrier of R3) } by TARSKI:def 1;
L187: D20 in [: (the carrier' of R3) , { (the carrier of R3) } :] by L186 , ZFMISC_1:87;
reconsider D21 = D20 as (Element of ( [: (the carrier' of R3) , { (the carrier of R3) } :] \/ ( Union ( coprod R4 ) ) )) by L187 , XBOOLE_0:def 3;
thus L188: ([ [ R5 , (the carrier of R3) ] , R6 ] in ( REL R4 ) implies S4[ R5 , R6 ])
proof
assume L189: [ [ R5 , (the carrier of R3) ] , R6 ] in ( REL R4 );
L190: (for B85 being (OperSymbol of R3) holds ([ B85 , (the carrier of R3) ] = D21 implies S4[ B85 , R6 ])) by L189 , L164;
thus L191: thesis by L190;
end;

assume L192: S4[ R5 , R6 ];
L193:
now
let C80 being (OperSymbol of R3);
assume L194: [ C80 , (the carrier of R3) ] = D21;
L195: C80 = R5 by L194 , XTUPLE_0:1;
thus L196: S4[ C80 , R6 ] by L195 , L192;
end;
thus L197: thesis by L193 , L187 , L164;
end;
definition
let C81 being non  void non  empty ManySortedSign;
let C82 being (ManySortedSet of (the carrier of C81));
func DTConMSA C82 -> DTConstrStr equals 
DTConstrStr (# ( [: (the carrier' of C81) , { (the carrier of C81) } :] \/ ( Union ( coprod C82 ) ) ) , ( REL C82 ) #);
correctness;
end;
registration
let C83 being non  void non  empty ManySortedSign;
let C84 being (ManySortedSet of (the carrier of C83));
cluster ( DTConMSA C84 ) ->  strict non  empty;
coherence;
end;
theorem
L200: (for B86 being non  void non  empty ManySortedSign holds (for B87 being (ManySortedSet of (the carrier of B86)) holds (( NonTerminals ( DTConMSA B87 ) ) c= [: (the carrier' of B86) , { (the carrier of B86) } :] & ( Union ( coprod B87 ) ) c= ( Terminals ( DTConMSA B87 ) ) & (B87 is  non-empty implies (( NonTerminals ( DTConMSA B87 ) ) = [: (the carrier' of B86) , { (the carrier of B86) } :] & ( Terminals ( DTConMSA B87 ) ) = ( Union ( coprod B87 ) ))))))
proof
let C85 being non  void non  empty ManySortedSign;
let C86 being (ManySortedSet of (the carrier of C85));
set D22 = ( DTConMSA C86 );
set D23 = ( [: (the carrier' of C85) , { (the carrier of C85) } :] \/ ( Union ( coprod (C86 qua (ManySortedSet of (the carrier of C85))) ) ) );
L201: (the carrier of D22) = ( ( Terminals D22 ) \/ ( NonTerminals D22 ) ) by LANG1:1;
thus L202: ( NonTerminals D22 ) c= [: (the carrier' of C85) , { (the carrier of C85) } :]
proof
let C87 being set;
assume L203: C87 in ( NonTerminals D22 );
L204: C87 in { B88 where B88 is (Symbol of D22) : (ex B89 being FinSequence st B88 ==> B89) } by L203 , LANG1:def 3;
consider C88 being (Symbol of D22) such that L205: C88 = C87 and L206: (ex B90 being FinSequence st C88 ==> B90) by L204;
consider C89 being FinSequence such that L207: C88 ==> C89 by L206;
L208: [ C88 , C89 ] in (the Rules of D22) by L207 , LANG1:def 1;
reconsider D24 = C89 as (Element of ( D23 * )) by L208 , ZFMISC_1:87;
reconsider D25 = C88 as (Element of D23);
L209: [ D25 , D24 ] in ( REL C86 ) by L207 , LANG1:def 1;
thus L210: thesis by L209 , L205 , L164;
end;

L211: ( Union ( coprod C86 ) ) misses [: (the carrier' of C85) , { (the carrier of C85) } :] by L149;
thus L212: ( Union ( coprod C86 ) ) c= ( Terminals ( DTConMSA C86 ) )
proof
let C90 being set;
assume L213: C90 in ( Union ( coprod C86 ) );
L214: C90 in D23 by L213 , XBOOLE_0:def 3;
L215: (C90 in ( Terminals D22 ) or C90 in ( NonTerminals D22 )) by L214 , L201 , XBOOLE_0:def 3;
thus L216: thesis by L215 , L211 , L202 , L213 , XBOOLE_0:3;
end;

assume L217: C86 is  non-empty;
thus L218: ( NonTerminals D22 ) c= [: (the carrier' of C85) , { (the carrier of C85) } :] by L202;
thus L219: [: (the carrier' of C85) , { (the carrier of C85) } :] c= ( NonTerminals D22 )
proof
let C91 being set;
assume L220: C91 in [: (the carrier' of C85) , { (the carrier of C85) } :];
consider C92 being (OperSymbol of C85), C93 being (Element of { (the carrier of C85) }) such that L221: C91 = [ C92 , C93 ] by L220 , DOMAIN_1:1;
set D26 = ( the_arity_of C92 );
defpred S5[ set , set ] means $2 in ( coprod (( D26 . $1 ) , C86) );
L222: (for B91 being set holds (B91 in ( Seg ( len D26 ) ) implies (ex B92 being set st S5[ B91 , B92 ])))
proof
let C94 being set;
assume L223: C94 in ( Seg ( len D26 ) );
L224: C94 in ( dom D26 ) by L223 , FINSEQ_1:def 3;
L225: ( D26 . C94 ) in ( rng D26 ) by L224 , FUNCT_1:def 3;
L226: ( rng D26 ) c= (the carrier of C85) by FINSEQ_1:def 4;
consider C95 being set such that L227: C95 in ( C86 . ( D26 . C94 ) ) by L226 , L217 , L225 , XBOOLE_0:def 1;
take [ C95 , ( D26 . C94 ) ];
thus L228: thesis by L225 , L226 , L227 , L41;
end;
consider C96 being Function such that L229: (( dom C96 ) = ( Seg ( len D26 ) ) & (for B93 being set holds (B93 in ( Seg ( len D26 ) ) implies S5[ B93 , ( C96 . B93 ) ]))) from CLASSES1:sch 1(L222);
reconsider D27 = C96 as FinSequence by L229 , FINSEQ_1:def 2;
L230: ( rng D27 ) c= D23
proof
let C97 being set;
L231: ( rng D26 ) c= (the carrier of C85) by FINSEQ_1:def 4;
assume L232: C97 in ( rng D27 );
consider C98 being set such that L233: C98 in ( dom D27 ) and L234: ( D27 . C98 ) = C97 by L232 , FUNCT_1:def 3;
L235: ( dom D26 ) = ( Seg ( len D26 ) ) by FINSEQ_1:def 3;
L236: ( D26 . C98 ) in ( rng D26 ) by L235 , L229 , L233 , FUNCT_1:def 3;
L237: ( dom ( coprod C86 ) ) = (the carrier of C85) by PARTFUN1:def 2;
L238: ( ( coprod C86 ) . ( D26 . C98 ) ) in ( rng ( coprod C86 ) ) by L237 , L236 , L231 , FUNCT_1:def 3;
L239: ( coprod (( D26 . C98 ) , C86) ) in ( rng ( coprod C86 ) ) by L238 , L236 , L231 , L66;
L240: C97 in ( coprod (( D26 . C98 ) , C86) ) by L229 , L233 , L234;
L241: C97 in ( union ( rng ( coprod C86 ) ) ) by L240 , L239 , TARSKI:def 4;
L242: C97 in ( Union ( coprod C86 ) ) by L241 , CARD_3:def 4;
thus L243: thesis by L242 , XBOOLE_0:def 3;
end;
reconsider D28 = D27 as (FinSequence of D23) by L230 , FINSEQ_1:def 4;
reconsider D29 = D28 as (Element of ( D23 * )) by FINSEQ_1:def 11;
L244:
now
let C99 being set;
assume L245: C99 in ( dom D29 );
L246: ( dom D26 ) = ( Seg ( len D26 ) ) by FINSEQ_1:def 3;
L247: ( D26 . C99 ) in ( rng D26 ) by L246 , L229 , L245 , FUNCT_1:def 3;
L248: ( rng D26 ) c= (the carrier of C85) by FINSEQ_1:def 4;
L249: ( dom ( coprod C86 ) ) = (the carrier of C85) by PARTFUN1:def 2;
L250: ( ( coprod C86 ) . ( D26 . C99 ) ) in ( rng ( coprod C86 ) ) by L249 , L247 , L248 , FUNCT_1:def 3;
L251: ( coprod (( D26 . C99 ) , C86) ) in ( rng ( coprod C86 ) ) by L250 , L247 , L248 , L66;
L252: S5[ C99 , ( D29 . C99 ) ] by L229 , L245;
L253: ( D29 . C99 ) in ( union ( rng ( coprod C86 ) ) ) by L252 , L251 , TARSKI:def 4;
L254: ( D29 . C99 ) in ( Union ( coprod C86 ) ) by L253 , CARD_3:def 4;
thus L255: (( D29 . C99 ) in [: (the carrier' of C85) , { (the carrier of C85) } :] implies (for B94 being (OperSymbol of C85) holds ([ B94 , (the carrier of C85) ] = ( D29 . C99 ) implies ( the_result_sort_of B94 ) = ( D26 . C99 )))) by L254 , L211 , XBOOLE_0:3;
assume L256: ( D29 . C99 ) in ( Union ( coprod C86 ) );
thus L257: ( D29 . C99 ) in ( coprod (( D26 . C99 ) , C86) ) by L229 , L245;
end;
L258: (the carrier of C85) = C93 by TARSKI:def 1;
reconsider D30 = [ C92 , (the carrier of C85) ] as (Element of (the carrier of D22)) by L258 , L220 , L221 , XBOOLE_0:def 3;
L259: ( len D29 ) = ( len D26 ) by L229 , FINSEQ_1:def 3;
L260: [ D30 , D29 ] in ( REL C86 ) by L259 , L244 , L185;
L261: D30 ==> D29 by L260 , LANG1:def 1;
L262: D30 in { B95 where B95 is (Symbol of D22) : (ex B96 being FinSequence st B95 ==> B96) } by L261;
thus L263: thesis by L262 , L221 , L258 , LANG1:def 3;
end;

L264: ( Terminals D22 ) misses ( NonTerminals D22 ) by DTCONSTR:8;
thus L265: ( Terminals D22 ) c= ( Union ( coprod C86 ) )
proof
let C100 being set;
assume L266: C100 in ( Terminals D22 );
L267: (C100 in D23 & (not C100 in [: (the carrier' of C85) , { (the carrier of C85) } :])) by L266 , L201 , L264 , L219 , XBOOLE_0:3 , XBOOLE_0:def 3;
thus L268: thesis by L267 , XBOOLE_0:def 3;
end;

thus L269: thesis by L212;
end;
registration
let C101 being non  void non  empty ManySortedSign;
let C102 being  non-empty (ManySortedSet of (the carrier of C101));
cluster ( DTConMSA C102 ) ->  with_terminals  with_nonterminals  with_useful_nonterminals;
coherence
proof
set D31 = ( DTConMSA C102 );
set D32 = ( [: (the carrier' of C101) , { (the carrier of C101) } :] \/ ( Union ( coprod (C102 qua (ManySortedSet of (the carrier of C101))) ) ) );
L270: ( Terminals D31 ) = ( Union ( coprod C102 ) ) by L200;
L271: ( NonTerminals D31 ) = [: (the carrier' of C101) , { (the carrier of C101) } :] by L200;
L272: ( Union ( coprod C102 ) ) misses [: (the carrier' of C101) , { (the carrier of C101) } :] by L149;
L273: (for B97 being (Symbol of D31) holds (B97 in ( NonTerminals D31 ) implies (ex B98 being (FinSequence of ( TS D31 )) st B97 ==> ( roots B98 ))))
proof
let C103 being (Symbol of D31);
assume L274: C103 in ( NonTerminals D31 );
consider C104 being (OperSymbol of C101), C105 being (Element of { (the carrier of C101) }) such that L275: C103 = [ C104 , C105 ] by L274 , L271 , DOMAIN_1:1;
set D33 = ( the_arity_of C104 );
defpred S6[ set , set ] means $2 in ( coprod (( D33 . $1 ) , C102) );
L276: (for B99 being set holds (B99 in ( Seg ( len D33 ) ) implies (ex B100 being set st S6[ B99 , B100 ])))
proof
let C106 being set;
assume L277: C106 in ( Seg ( len D33 ) );
L278: C106 in ( dom D33 ) by L277 , FINSEQ_1:def 3;
L279: ( D33 . C106 ) in ( rng D33 ) by L278 , FUNCT_1:def 3;
L280: ( rng D33 ) c= (the carrier of C101) by FINSEQ_1:def 4;
consider C107 being set such that L281: C107 in ( C102 . ( D33 . C106 ) ) by L280 , L279 , XBOOLE_0:def 1;
take [ C107 , ( D33 . C106 ) ];
thus L282: thesis by L279 , L280 , L281 , L41;
end;
consider C108 being Function such that L283: (( dom C108 ) = ( Seg ( len D33 ) ) & (for B101 being set holds (B101 in ( Seg ( len D33 ) ) implies S6[ B101 , ( C108 . B101 ) ]))) from CLASSES1:sch 1(L276);
reconsider D34 = C108 as FinSequence by L283 , FINSEQ_1:def 2;
L284: ( rng D34 ) c= D32
proof
let C109 being set;
L285: ( rng D33 ) c= (the carrier of C101) by FINSEQ_1:def 4;
assume L286: C109 in ( rng D34 );
consider C110 being set such that L287: C110 in ( dom D34 ) and L288: ( D34 . C110 ) = C109 by L286 , FUNCT_1:def 3;
L289: ( dom D33 ) = ( Seg ( len D33 ) ) by FINSEQ_1:def 3;
L290: ( D33 . C110 ) in ( rng D33 ) by L289 , L283 , L287 , FUNCT_1:def 3;
L291: ( dom ( coprod C102 ) ) = (the carrier of C101) by PARTFUN1:def 2;
L292: ( ( coprod C102 ) . ( D33 . C110 ) ) in ( rng ( coprod C102 ) ) by L291 , L290 , L285 , FUNCT_1:def 3;
L293: ( coprod (( D33 . C110 ) , C102) ) in ( rng ( coprod C102 ) ) by L292 , L290 , L285 , L66;
L294: C109 in ( coprod (( D33 . C110 ) , C102) ) by L283 , L287 , L288;
L295: C109 in ( union ( rng ( coprod C102 ) ) ) by L294 , L293 , TARSKI:def 4;
L296: C109 in ( Union ( coprod C102 ) ) by L295 , CARD_3:def 4;
thus L297: thesis by L296 , XBOOLE_0:def 3;
end;
reconsider D35 = D34 as (FinSequence of D32) by L284 , FINSEQ_1:def 4;
reconsider D36 = D35 as (Element of ( D32 * )) by FINSEQ_1:def 11;
deffunc H1(set) = ( root-tree ( D36 . $1 ) );
consider C111 being Function such that L298: (( dom C111 ) = ( dom D36 ) & (for R7 being set holds (R7 in ( dom D36 ) implies ( C111 . R7 ) = H1(R7)))) from FUNCT_1:sch 3;
reconsider D37 = C111 as FinSequence by L283 , L298 , FINSEQ_1:def 2;
L299: ( rng D37 ) c= ( TS D31 )
proof
let R7 being set;
L300: ( rng D33 ) c= (the carrier of C101) by FINSEQ_1:def 4;
assume L301: R7 in ( rng D37 );
consider C112 being set such that L302: C112 in ( dom D37 ) and L303: ( D37 . C112 ) = R7 by L301 , FUNCT_1:def 3;
L304: ( dom D33 ) = ( Seg ( len D33 ) ) by FINSEQ_1:def 3;
L305: ( D33 . C112 ) in ( rng D33 ) by L304 , L283 , L298 , L302 , FUNCT_1:def 3;
L306: ( dom ( coprod C102 ) ) = (the carrier of C101) by PARTFUN1:def 2;
L307: ( ( coprod C102 ) . ( D33 . C112 ) ) in ( rng ( coprod C102 ) ) by L306 , L305 , L300 , FUNCT_1:def 3;
L308: ( coprod (( D33 . C112 ) , C102) ) in ( rng ( coprod C102 ) ) by L307 , L305 , L300 , L66;
L309: ( D36 . C112 ) in ( rng D36 ) by L298 , L302 , FUNCT_1:def 3;
reconsider D38 = ( D36 . C112 ) as (Symbol of D31) by L309 , L284;
L310: S6[ C112 , ( D36 . C112 ) ] by L283 , L298 , L302;
L311: ( D36 . C112 ) in ( union ( rng ( coprod C102 ) ) ) by L310 , L308 , TARSKI:def 4;
L312: D38 in ( Terminals D31 ) by L311 , L270 , CARD_3:def 4;
L313: R7 = ( root-tree ( D36 . C112 ) ) by L298 , L302 , L303;
thus L314: thesis by L313 , L312 , DTCONSTR:def 1;
end;
reconsider D39 = D37 as (FinSequence of ( TS D31 )) by L299 , FINSEQ_1:def 4;
L315: (for R7 being set holds (R7 in ( dom D36 ) implies ( ( roots D39 ) . R7 ) = ( D36 . R7 )))
proof
let R7 being set;
assume L316: R7 in ( dom D36 );
reconsider D40 = R7 as Nat by L316;
L317: (( D39 . R7 ) = ( root-tree ( D36 . R7 ) ) & (ex B102 being DecoratedTree st (B102 = ( D39 . D40 ) & ( ( roots D39 ) . D40 ) = ( B102 . ( {} ) )))) by L298 , L316 , TREES_3:def 18;
thus L318: thesis by L317 , TREES_4:3;
end;
L319:
now
let C113 being set;
assume L320: C113 in ( dom D36 );
L321: ( dom D33 ) = ( Seg ( len D33 ) ) by FINSEQ_1:def 3;
L322: ( D33 . C113 ) in ( rng D33 ) by L321 , L283 , L320 , FUNCT_1:def 3;
L323: ( rng D33 ) c= (the carrier of C101) by FINSEQ_1:def 4;
L324: ( dom ( coprod C102 ) ) = (the carrier of C101) by PARTFUN1:def 2;
L325: ( ( coprod C102 ) . ( D33 . C113 ) ) in ( rng ( coprod C102 ) ) by L324 , L322 , L323 , FUNCT_1:def 3;
L326: ( coprod (( D33 . C113 ) , C102) ) in ( rng ( coprod C102 ) ) by L325 , L322 , L323 , L66;
L327: S6[ C113 , ( D36 . C113 ) ] by L283 , L320;
L328: ( D36 . C113 ) in ( union ( rng ( coprod C102 ) ) ) by L327 , L326 , TARSKI:def 4;
L329: ( D36 . C113 ) in ( Union ( coprod C102 ) ) by L328 , CARD_3:def 4;
thus L330: (( D36 . C113 ) in [: (the carrier' of C101) , { (the carrier of C101) } :] implies (for B103 being (OperSymbol of C101) holds ([ B103 , (the carrier of C101) ] = ( D36 . C113 ) implies ( the_result_sort_of B103 ) = ( D33 . C113 )))) by L329 , L272 , XBOOLE_0:3;
assume L331: ( D36 . C113 ) in ( Union ( coprod C102 ) );
thus L332: ( D36 . C113 ) in ( coprod (( D33 . C113 ) , C102) ) by L283 , L320;
end;
L333: ((the carrier of C101) = C105 & ( len D36 ) = ( len D33 )) by L283 , FINSEQ_1:def 3 , TARSKI:def 1;
L334: [ C103 , D36 ] in ( REL C102 ) by L333 , L275 , L319 , L185;
L335: C103 ==> D36 by L334 , LANG1:def 1;
take D39;
L336: ( dom ( roots D39 ) ) = ( dom D39 ) by TREES_3:def 18;
thus L337: thesis by L336 , L335 , L298 , L315 , FUNCT_1:2;
end;
thus L338: thesis by L273 , L270 , L271 , DTCONSTR:def 3 , DTCONSTR:def 4 , DTCONSTR:def 5;
end;
end;
theorem
L340: (for B104 being non  void non  empty ManySortedSign holds (for B105 being (ManySortedSet of (the carrier of B104)) holds (for B106 being set holds (((B106 in ( Terminals ( DTConMSA B105 ) ) & B105 is  non-empty) implies (ex B107 being (SortSymbol of B104) st (ex B108 being set st (B108 in ( B105 . B107 ) & B106 = [ B108 , B107 ])))) & (for B109 being (SortSymbol of B104) holds (for B110 being set holds (B110 in ( B105 . B109 ) implies [ B110 , B109 ] in ( Terminals ( DTConMSA B105 ) ))))))))
proof
let C114 being non  void non  empty ManySortedSign;
let C115 being (ManySortedSet of (the carrier of C114));
let C116 being set;
set D41 = ( DTConMSA C115 );
L341: ( Union ( coprod C115 ) ) c= ( Terminals ( DTConMSA C115 ) ) by L200;
L342: ( Union ( coprod C115 ) ) = ( union ( rng ( coprod C115 ) ) ) by CARD_3:def 4;
thus L343: ((C116 in ( Terminals D41 ) & C115 is  non-empty) implies (ex B111 being (SortSymbol of C114) st (ex B112 being set st (B112 in ( C115 . B111 ) & C116 = [ B112 , B111 ]))))
proof
assume that
L344: C116 in ( Terminals D41 )
and
L345: C115 is  non-empty;
L346: ( Terminals D41 ) = ( Union ( coprod C115 ) ) by L345 , L200;
consider C117 being set such that L347: C116 in C117 and L348: C117 in ( rng ( coprod C115 ) ) by L346 , L342 , L344 , TARSKI:def 4;
consider C118 being set such that L349: C118 in ( dom ( coprod C115 ) ) and L350: ( ( coprod C115 ) . C118 ) = C117 by L348 , FUNCT_1:def 3;
reconsider D42 = C118 as (SortSymbol of C114) by L349;
L351: ( ( coprod C115 ) . D42 ) = ( coprod (D42 , C115) ) by L66;
consider C119 being set such that L352: (C119 in ( C115 . D42 ) & C116 = [ C119 , D42 ]) by L351 , L347 , L350 , L41;
take D42;
take C119;
thus L353: thesis by L352;
end;

let C120 being (SortSymbol of C114);
let C121 being set;
assume that
L354: C121 in ( C115 . C120 );
set D43 = [ C121 , C120 ];
L355: ( dom ( coprod C115 ) ) = (the carrier of C114) by PARTFUN1:def 2;
L356: ( ( coprod C115 ) . C120 ) in ( rng ( coprod C115 ) ) by L355 , FUNCT_1:def 3;
L357: D43 in ( coprod (C120 , C115) ) by L354 , L41;
L358: D43 in ( ( coprod C115 ) . C120 ) by L357 , L66;
L359: D43 in ( Union ( coprod C115 ) ) by L358 , L342 , L356 , TARSKI:def 4;
thus L360: thesis by L359 , L341;
end;
definition
let C122 being non  void non  empty ManySortedSign;
let C123 being  non-empty (ManySortedSet of (the carrier of C122));
let C124 being (OperSymbol of C122);
func Sym (C124 , C123) -> (Symbol of ( DTConMSA C123 )) equals 
[ C124 , (the carrier of C122) ];
coherence
proof
L361: (the carrier of C122) in { (the carrier of C122) } by TARSKI:def 1;
L362: [ C124 , (the carrier of C122) ] in [: (the carrier' of C122) , { (the carrier of C122) } :] by L361 , ZFMISC_1:87;
L363: [ C124 , (the carrier of C122) ] in ( NonTerminals ( DTConMSA C123 ) ) by L362 , L200;
thus L364: thesis by L363;
end;
end;
definition
let C125 being non  void non  empty ManySortedSign;
let C126 being  non-empty (ManySortedSet of (the carrier of C125));
let C127 being (SortSymbol of C125);
func FreeSort (C126 , C127) -> (Subset of ( TS ( DTConMSA C126 ) )) equals 
{ B113 where B113 is (Element of ( TS ( DTConMSA C126 ) )) : ((ex B114 being set st (B114 in ( C126 . C127 ) & B113 = ( root-tree [ B114 , C127 ] ))) or (ex B115 being (OperSymbol of C125) st ([ B115 , (the carrier of C125) ] = ( B113 . ( {} ) ) & ( the_result_sort_of B115 ) = C127))) };
coherence
proof
set D44 = { B116 where B116 is (Element of ( TS ( DTConMSA C126 ) )) : ((ex B117 being set st (B117 in ( C126 . C127 ) & B116 = ( root-tree [ B117 , C127 ] ))) or (ex B118 being (OperSymbol of C125) st ([ B118 , (the carrier of C125) ] = ( B116 . ( {} ) ) & ( the_result_sort_of B118 ) = C127))) };
L366: D44 c= ( TS ( DTConMSA C126 ) )
proof
let C128 being set;
assume L367: C128 in D44;
L368: (ex B119 being (Element of ( TS ( DTConMSA C126 ) )) st (C128 = B119 & ((ex B120 being set st (B120 in ( C126 . C127 ) & B119 = ( root-tree [ B120 , C127 ] ))) or (ex B121 being (OperSymbol of C125) st ([ B121 , (the carrier of C125) ] = ( B119 . ( {} ) ) & ( the_result_sort_of B121 ) = C127))))) by L367;
thus L369: thesis by L368;
end;
thus L370: thesis by L366;
end;
end;
registration
let C129 being non  void non  empty ManySortedSign;
let C130 being  non-empty (ManySortedSet of (the carrier of C129));
let C131 being (SortSymbol of C129);
cluster ( FreeSort (C130 , C131) ) -> non  empty;
coherence
proof
L372: ( dom ( coprod C130 ) ) = (the carrier of C129) by PARTFUN1:def 2;
L373: ( ( coprod C130 ) . C131 ) in ( rng ( coprod C130 ) ) by L372 , FUNCT_1:def 3;
L374: ( coprod (C131 , C130) ) in ( rng ( coprod C130 ) ) by L373 , L66;
set D45 = { B122 where B122 is (Element of ( TS ( DTConMSA C130 ) )) : ((ex B123 being set st (B123 in ( C130 . C131 ) & B122 = ( root-tree [ B123 , C131 ] ))) or (ex B124 being (OperSymbol of C129) st ([ B124 , (the carrier of C129) ] = ( B122 . ( {} ) ) & ( the_result_sort_of B124 ) = C131))) };
consider C132 being set such that L375: C132 in ( C130 . C131 ) by XBOOLE_0:def 1;
set D46 = [ C132 , C131 ];
L376: ( Terminals ( DTConMSA C130 ) ) = ( Union ( coprod C130 ) ) by L200;
L377: D46 in ( coprod (C131 , C130) ) by L375 , L41;
L378: D46 in ( union ( rng ( coprod C130 ) ) ) by L377 , L374 , TARSKI:def 4;
L379: D46 in ( Terminals ( DTConMSA C130 ) ) by L378 , L376 , CARD_3:def 4;
reconsider D47 = D46 as (Symbol of ( DTConMSA C130 )) by L379;
reconsider D48 = ( root-tree D47 ) as (Element of ( TS ( DTConMSA C130 ) )) by L379 , DTCONSTR:def 1;
L380: D48 in D45 by L375;
thus L381: thesis by L380;
end;
end;
definition
let C133 being non  void non  empty ManySortedSign;
let C134 being  non-empty (ManySortedSet of (the carrier of C133));
func FreeSort C134 -> (ManySortedSet of (the carrier of C133)) means 
:L383: (for B125 being (SortSymbol of C133) holds ( it . B125 ) = ( FreeSort (C134 , B125) ));
existence
proof
deffunc H2((Element of C133)) = ( FreeSort (C134 , $1) );
consider C135 being Function such that L384: (( dom C135 ) = (the carrier of C133) & (for B126 being (Element of C133) holds ( C135 . B126 ) = H2(B126))) from FUNCT_1:sch 4;
reconsider D49 = C135 as (ManySortedSet of (the carrier of C133)) by L384 , PARTFUN1:def 2 , RELAT_1:def 18;
take D49;
thus L385: thesis by L384;
end;
uniqueness
proof
let C136 , C137 being (ManySortedSet of (the carrier of C133));
assume that
L386: (for B127 being (SortSymbol of C133) holds ( C136 . B127 ) = ( FreeSort (C134 , B127) ))
and
L387: (for B128 being (SortSymbol of C133) holds ( C137 . B128 ) = ( FreeSort (C134 , B128) ));
L388: (for B129 being set holds (B129 in (the carrier of C133) implies ( C136 . B129 ) = ( C137 . B129 )))
proof
let C138 being set;
assume L389: C138 in (the carrier of C133);
reconsider D50 = C138 as (SortSymbol of C133) by L389;
L390: ( C136 . D50 ) = ( FreeSort (C134 , D50) ) by L386;
thus L391: thesis by L390 , L387;
end;
thus L392: thesis by L388 , PBOOLE:3;
end;
end;
registration
let C139 being non  void non  empty ManySortedSign;
let C140 being  non-empty (ManySortedSet of (the carrier of C139));
cluster ( FreeSort C140 ) ->  non-empty;
coherence
proof
let C141 being set;
assume L394: C141 in (the carrier of C139);
reconsider D51 = C141 as (SortSymbol of C139) by L394;
L395: ( ( FreeSort C140 ) . D51 ) = ( FreeSort (C140 , D51) ) by L383;
thus L396: thesis by L395;
end;
end;
theorem
L398: (for B130 being non  void non  empty ManySortedSign holds (for B131 being  non-empty (ManySortedSet of (the carrier of B130)) holds (for B132 being (OperSymbol of B130) holds (for B133 being set holds (B133 in ( ( ( ( FreeSort B131 ) # ) * (the Arity of B130) ) . B132 ) implies B133 is (FinSequence of ( TS ( DTConMSA B131 ) )))))))
proof
let C142 being non  void non  empty ManySortedSign;
let C143 being  non-empty (ManySortedSet of (the carrier of C142));
let C144 being (OperSymbol of C142);
let C145 being set;
set D52 = ( DTConMSA C143 );
set D53 = ( the_arity_of C144 );
set D54 = (the carrier of C142);
L399: ( (the Arity of C142) . C144 ) = D53 by MSUALG_1:def 1;
L400: (( rng D53 ) c= D54 & ( dom ( FreeSort C143 ) ) = D54) by FINSEQ_1:def 4 , PARTFUN1:def 2;
L401: ( dom ( ( FreeSort C143 ) * D53 ) ) = ( dom D53 ) by L400 , RELAT_1:27;
assume L402: C145 in ( ( ( ( FreeSort C143 ) # ) * (the Arity of C142) ) . C144 );
L403: C145 in ( product ( ( FreeSort C143 ) * D53 ) ) by L402 , L399 , L1;
consider C146 being Function such that L404: C145 = C146 and L405: ( dom C146 ) = ( dom ( ( FreeSort C143 ) * D53 ) ) and L406: (for B134 being set holds (B134 in ( dom ( ( FreeSort C143 ) * D53 ) ) implies ( C146 . B134 ) in ( ( ( FreeSort C143 ) * D53 ) . B134 ))) by L403 , CARD_3:def 5;
L407: ( dom D53 ) = ( Seg ( len D53 ) ) by FINSEQ_1:def 3;
reconsider D55 = C146 as FinSequence by L407 , L405 , L401 , FINSEQ_1:def 2;
L408: ( rng D55 ) c= ( TS D52 )
proof
let C147 being set;
assume L409: C147 in ( rng D55 );
consider C148 being set such that L410: C148 in ( dom D55 ) and L411: ( D55 . C148 ) = C147 by L409 , FUNCT_1:def 3;
L412: C147 in ( ( ( FreeSort C143 ) * D53 ) . C148 ) by L405 , L406 , L410 , L411;
reconsider D56 = C148 as Nat by L410;
L413: ( ( ( FreeSort C143 ) * D53 ) . D56 ) = ( ( FreeSort C143 ) . ( D53 . D56 ) ) by L405 , L410 , FUNCT_1:12
.= ( ( FreeSort C143 ) . ( D53 /. D56 ) ) by L405 , L401 , L410 , PARTFUN1:def 6
.= ( FreeSort (C143 , ( D53 /. D56 )) ) by L383
.= { B135 where B135 is (Element of ( TS D52 )) : ((ex B136 being set st (B136 in ( C143 . ( D53 /. D56 ) ) & B135 = ( root-tree [ B136 , ( D53 /. D56 ) ] ))) or (ex B137 being (OperSymbol of C142) st ([ B137 , (the carrier of C142) ] = ( B135 . ( {} ) ) & ( the_result_sort_of B137 ) = ( D53 /. D56 )))) };
L414: (ex B138 being (Element of ( TS D52 )) st (C147 = B138 & ((ex B139 being set st (B139 in ( C143 . ( D53 /. D56 ) ) & B138 = ( root-tree [ B139 , ( D53 /. D56 ) ] ))) or (ex B140 being (OperSymbol of C142) st ([ B140 , (the carrier of C142) ] = ( B138 . ( {} ) ) & ( the_result_sort_of B140 ) = ( D53 /. D56 )))))) by L413 , L412;
thus L415: thesis by L414;
end;
reconsider D57 = D55 as (FinSequence of ( TS D52 )) by L408 , FINSEQ_1:def 4;
L416: D57 = C145 by L404;
thus L417: thesis by L416;
end;
theorem
L418: (for B141 being non  void non  empty ManySortedSign holds (for B142 being  non-empty (ManySortedSet of (the carrier of B141)) holds (for B143 being (OperSymbol of B141) holds (for B144 being (FinSequence of ( TS ( DTConMSA B142 ) )) holds (B144 in ( ( ( ( FreeSort B142 ) # ) * (the Arity of B141) ) . B143 ) iff (( dom B144 ) = ( dom ( the_arity_of B143 ) ) & (for B145 being Nat holds (B145 in ( dom B144 ) implies ( B144 . B145 ) in ( FreeSort (B142 , ( ( the_arity_of B143 ) /. B145 )) )))))))))
proof
let C149 being non  void non  empty ManySortedSign;
let C150 being  non-empty (ManySortedSet of (the carrier of C149));
let C151 being (OperSymbol of C149);
let C152 being (FinSequence of ( TS ( DTConMSA C150 ) ));
set D58 = (the Arity of C149);
set D59 = (the carrier of C149);
set D60 = ( the_arity_of C151 );
thus L419: (C152 in ( ( ( ( FreeSort C150 ) # ) * D58 ) . C151 ) implies (( dom C152 ) = ( dom ( the_arity_of C151 ) ) & (for B146 being Nat holds (B146 in ( dom C152 ) implies ( C152 . B146 ) in ( FreeSort (C150 , ( ( the_arity_of C151 ) /. B146 )) )))))
proof
L420: ( D58 . C151 ) = D60 by MSUALG_1:def 1;
L421: (( rng D60 ) c= D59 & ( dom ( FreeSort C150 ) ) = D59) by FINSEQ_1:def 4 , PARTFUN1:def 2;
L422: ( dom ( ( FreeSort C150 ) * D60 ) ) = ( dom D60 ) by L421 , RELAT_1:27;
assume L423: C152 in ( ( ( ( FreeSort C150 ) # ) * (the Arity of C149) ) . C151 );
L424: C152 in ( product ( ( FreeSort C150 ) * D60 ) ) by L423 , L420 , L1;
L425: ( dom C152 ) = ( dom ( ( FreeSort C150 ) * D60 ) ) by L424 , CARD_3:9;
thus L426: ( dom C152 ) = ( dom D60 ) by L425 , L421 , RELAT_1:27;
let C153 being Nat;
assume L427: C153 in ( dom C152 );
L428: ( ( ( FreeSort C150 ) * D60 ) . C153 ) = ( ( FreeSort C150 ) . ( D60 . C153 ) ) by L427 , L425 , FUNCT_1:12
.= ( ( FreeSort C150 ) . ( D60 /. C153 ) ) by L425 , L422 , L427 , PARTFUN1:def 6
.= ( FreeSort (C150 , ( D60 /. C153 )) ) by L383;
thus L429: thesis by L428 , L424 , L425 , L427 , CARD_3:9;
end;

assume that
L430: ( dom C152 ) = ( dom ( the_arity_of C151 ) )
and
L431: (for B147 being Nat holds (B147 in ( dom C152 ) implies ( C152 . B147 ) in ( FreeSort (C150 , ( ( the_arity_of C151 ) /. B147 )) )));
L432: (( rng D60 ) c= D59 & ( dom ( FreeSort C150 ) ) = D59) by FINSEQ_1:def 4 , PARTFUN1:def 2;
L433: ( dom C152 ) = ( dom ( ( FreeSort C150 ) * D60 ) ) by L432 , L430 , RELAT_1:27;
L434: (for B148 being set holds (B148 in ( dom ( ( FreeSort C150 ) * D60 ) ) implies ( C152 . B148 ) in ( ( ( FreeSort C150 ) * D60 ) . B148 )))
proof
let C154 being set;
assume L435: C154 in ( dom ( ( FreeSort C150 ) * D60 ) );
reconsider D61 = C154 as Nat by L435;
L436: ( FreeSort (C150 , ( D60 /. D61 )) ) = ( ( FreeSort C150 ) . ( D60 /. D61 ) ) by L383
.= ( ( FreeSort C150 ) . ( D60 . D61 ) ) by L430 , L433 , L435 , PARTFUN1:def 6
.= ( ( ( FreeSort C150 ) * D60 ) . C154 ) by L435 , FUNCT_1:12;
thus L437: thesis by L436 , L431 , L433 , L435;
end;
L438: ( D58 . C151 ) = D60 by MSUALG_1:def 1;
L439: ( ( ( ( FreeSort C150 ) # ) * D58 ) . C151 ) = ( product ( ( FreeSort C150 ) * D60 ) ) by L438 , L1;
thus L440: thesis by L439 , L433 , L434 , CARD_3:9;
end;
theorem
L441: (for B149 being non  void non  empty ManySortedSign holds (for B150 being  non-empty (ManySortedSet of (the carrier of B149)) holds (for B151 being (OperSymbol of B149) holds (for B152 being (FinSequence of ( TS ( DTConMSA B150 ) )) holds (( Sym (B151 , B150) ) ==> ( roots B152 ) iff B152 in ( ( ( ( FreeSort B150 ) # ) * (the Arity of B149) ) . B151 ))))))
proof
let C155 being non  void non  empty ManySortedSign;
let C156 being  non-empty (ManySortedSet of (the carrier of C155));
let C157 being (OperSymbol of C155);
let C158 being (FinSequence of ( TS ( DTConMSA C156 ) ));
set D62 = ( DTConMSA C156 );
set D63 = ( the_arity_of C157 );
set D64 = ( roots C158 );
set D65 = ( [: (the carrier' of C155) , { (the carrier of C155) } :] \/ ( Union ( coprod C156 ) ) );
L442: ( dom C158 ) = ( dom D64 ) by TREES_3:def 18;
thus L443: (( Sym (C157 , C156) ) ==> ( roots C158 ) implies C158 in ( ( ( ( FreeSort C156 ) # ) * (the Arity of C155) ) . C157 ))
proof
assume L444: ( Sym (C157 , C156) ) ==> ( roots C158 );
L445: [ [ C157 , (the carrier of C155) ] , ( roots C158 ) ] in ( REL C156 ) by L444 , LANG1:def 1;
reconsider D66 = ( roots C158 ) as (Element of ( ( [: (the carrier' of C155) , { (the carrier of C155) } :] \/ ( Union ( coprod C156 ) ) ) * )) by L445 , ZFMISC_1:87;
L446: ( dom C158 ) = ( dom D66 ) by TREES_3:def 18;
L447: (( dom D66 ) = ( Seg ( len D66 ) ) & ( Seg ( len D63 ) ) = ( dom D63 )) by FINSEQ_1:def 3;
L448: ( len D66 ) = ( len D63 ) by L445 , L185;
L449: (for B153 being Nat holds (B153 in ( dom C158 ) implies ( C158 . B153 ) in ( FreeSort (C156 , ( D63 /. B153 )) )))
proof
let C159 being Nat;
set D67 = ( D63 /. C159 );
assume L450: C159 in ( dom C158 );
consider C160 being DecoratedTree such that L451: C160 = ( C158 . C159 ) and L452: ( D66 . C159 ) = ( C160 . ( {} ) ) by L450 , TREES_3:def 18;
L453: (( rng C158 ) c= ( TS D62 ) & ( C158 . C159 ) in ( rng C158 )) by L450 , FINSEQ_1:def 4 , FUNCT_1:def 3;
reconsider D68 = C160 as (Element of ( TS D62 )) by L453 , L451;
L454: (( rng D66 ) c= ( [: (the carrier' of C155) , { (the carrier of C155) } :] \/ ( Union ( coprod C156 ) ) ) & ( D66 . C159 ) in ( rng D66 )) by L446 , L450 , FINSEQ_1:def 4 , FUNCT_1:def 3;
per cases  by L454 , XBOOLE_0:def 3;
suppose L455: ( D66 . C159 ) in [: (the carrier' of C155) , { (the carrier of C155) } :];

consider C161 being (OperSymbol of C155), C162 being (Element of { (the carrier of C155) }) such that L456: ( D66 . C159 ) = [ C161 , C162 ] by L455 , DOMAIN_1:1;
L457: C162 = (the carrier of C155) by TARSKI:def 1;
L458: ( the_result_sort_of C161 ) = ( D63 . C159 ) by L457 , L445 , L446 , L450 , L455 , L456 , L185
.= ( D63 /. C159 ) by L448 , L446 , L447 , L450 , PARTFUN1:def 6;
L459: ((ex B154 being set st (B154 in ( C156 . D67 ) & D68 = ( root-tree [ B154 , D67 ] ))) or (ex B155 being (OperSymbol of C155) st ([ B155 , (the carrier of C155) ] = ( D68 . ( {} ) ) & ( the_result_sort_of B155 ) = D67))) by L458 , L452 , L456 , L457;
thus L460: thesis by L459 , L451;
end;
suppose L461: ( D66 . C159 ) in ( Union ( coprod C156 ) );

L462: ( D66 . C159 ) in ( coprod (( D63 . C159 ) , C156) ) by L461 , L445 , L446 , L450 , L185;
L463: ( D66 . C159 ) in ( coprod (D67 , C156) ) by L462 , L448 , L446 , L447 , L450 , PARTFUN1:def 6;
L464: (ex B156 being set st (B156 in ( C156 . D67 ) & ( D66 . C159 ) = [ B156 , D67 ])) by L463 , L41;
reconsider D69 = ( D66 . C159 ) as (Terminal of D62) by L461 , L200;
L465: D68 = ( root-tree D69 ) by L452 , DTCONSTR:9;
thus L466: thesis by L465 , L451 , L464;
end;
end;
thus L468: thesis by L449 , L448 , L446 , L447 , L418;
end;

L469: ( dom D64 ) = ( Seg ( len D64 ) ) by FINSEQ_1:def 3;
reconsider D70 = D64 as (FinSequence of D65);
reconsider D71 = D70 as (Element of ( D65 * )) by FINSEQ_1:def 11;
assume L470: C158 in ( ( ( ( FreeSort C156 ) # ) * (the Arity of C155) ) . C157 );
L471: ( dom C158 ) = ( dom D63 ) by L470 , L418;
L472: ( Union ( coprod C156 ) ) misses [: (the carrier' of C155) , { (the carrier of C155) } :] by L149;
L473: (for B157 being set holds (B157 in ( dom D71 ) implies ((( D71 . B157 ) in [: (the carrier' of C155) , { (the carrier of C155) } :] implies (for B158 being (OperSymbol of C155) holds ([ B158 , (the carrier of C155) ] = ( D71 . B157 ) implies ( the_result_sort_of B158 ) = ( D63 . B157 )))) & (( D71 . B157 ) in ( Union ( coprod C156 ) ) implies ( D71 . B157 ) in ( coprod (( D63 . B157 ) , C156) )))))
proof
let C163 being set;
assume L474: C163 in ( dom D71 );
reconsider D72 = C163 as Nat by L474;
L475: (ex B159 being DecoratedTree st (B159 = ( C158 . D72 ) & ( D71 . D72 ) = ( B159 . ( {} ) ))) by L442 , L474 , TREES_3:def 18;
set D73 = ( D63 /. D72 );
L476: ( C158 . D72 ) in ( FreeSort (C156 , D73) ) by L470 , L442 , L474 , L418;
consider C164 being (Element of ( TS D62 )) such that L477: C164 = ( C158 . D72 ) and L478: ((ex B160 being set st (B160 in ( C156 . D73 ) & C164 = ( root-tree [ B160 , D73 ] ))) or (ex B161 being (OperSymbol of C155) st ([ B161 , (the carrier of C155) ] = ( C164 . ( {} ) ) & ( the_result_sort_of B161 ) = D73))) by L476;
L479: D73 = ( D63 . D72 ) by L471 , L442 , L474 , PARTFUN1:def 6;
thus L480: (( D71 . C163 ) in [: (the carrier' of C155) , { (the carrier of C155) } :] implies (for B162 being (OperSymbol of C155) holds ([ B162 , (the carrier of C155) ] = ( D71 . C163 ) implies ( the_result_sort_of B162 ) = ( D63 . C163 ))))
proof
assume L481: ( D71 . C163 ) in [: (the carrier' of C155) , { (the carrier of C155) } :];
L482:
now
L483: ( dom ( coprod C156 ) ) = (the carrier of C155) by PARTFUN1:def 2;
L484: ( ( coprod C156 ) . D73 ) in ( rng ( coprod C156 ) ) by L483 , FUNCT_1:def 3;
L485: ( coprod (D73 , C156) ) in ( rng ( coprod C156 ) ) by L484 , L66;
given C165 being set such that
L486: (C165 in ( C156 . D73 ) & C164 = ( root-tree [ C165 , D73 ] ));

L487: (( D71 . C163 ) = [ C165 , D73 ] & [ C165 , D73 ] in ( coprod (D73 , C156) )) by L477 , L475 , L486 , L41 , TREES_4:3;
L488: ( D71 . C163 ) in ( union ( rng ( coprod C156 ) ) ) by L487 , L485 , TARSKI:def 4;
L489: ( D71 . C163 ) in ( Union ( coprod C156 ) ) by L488 , CARD_3:def 4;
thus L490: contradiction by L489 , L472 , L481 , XBOOLE_0:3;
end;
let C166 being (OperSymbol of C155);
assume L491: [ C166 , (the carrier of C155) ] = ( D71 . C163 );
thus L492: thesis by L491 , L477 , L478 , L475 , L479 , L482 , XTUPLE_0:1;
end;

assume L493: ( D71 . C163 ) in ( Union ( coprod C156 ) );
L494:
now
given C167 being (OperSymbol of C155) such that
L495: [ C167 , (the carrier of C155) ] = ( C164 . ( {} ) )
and
L496: ( the_result_sort_of C167 ) = D73;

L497: (the carrier of C155) in { (the carrier of C155) } by TARSKI:def 1;
L498: [ C167 , (the carrier of C155) ] in [: (the carrier' of C155) , { (the carrier of C155) } :] by L497 , ZFMISC_1:87;
thus L499: contradiction by L498 , L472 , L477 , L475 , L493 , L495 , XBOOLE_0:3;
end;
consider C168 being set such that L500: C168 in ( C156 . D73 ) and L501: C164 = ( root-tree [ C168 , D73 ] ) by L494 , L478;
L502: ( D71 . C163 ) = [ C168 , D73 ] by L477 , L475 , L501 , TREES_4:3;
thus L503: thesis by L502 , L479 , L500 , L41;
end;
L504: ( len D71 ) = ( len D63 ) by L471 , L442 , L469 , FINSEQ_1:def 3;
L505: [ [ C157 , (the carrier of C155) ] , D71 ] in ( REL C156 ) by L504 , L473 , L185;
thus L506: thesis by L505 , LANG1:def 1;
end;
theorem
L507: (for B163 being non  void non  empty ManySortedSign holds (for B164 being  non-empty (ManySortedSet of (the carrier of B163)) holds ( union ( rng ( FreeSort B164 ) ) ) = ( TS ( DTConMSA B164 ) )))
proof
let C169 being non  void non  empty ManySortedSign;
let C170 being  non-empty (ManySortedSet of (the carrier of C169));
set D74 = ( DTConMSA C170 );
L508: ( dom ( FreeSort C170 ) ) = (the carrier of C169) by PARTFUN1:def 2;
thus L509: ( union ( rng ( FreeSort C170 ) ) ) c= ( TS D74 )
proof
let R7 being set;
assume L510: R7 in ( union ( rng ( FreeSort C170 ) ) );
consider C171 being set such that L511: R7 in C171 and L512: C171 in ( rng ( FreeSort C170 ) ) by L510 , TARSKI:def 4;
consider C172 being set such that L513: C172 in ( dom ( FreeSort C170 ) ) and L514: ( ( FreeSort C170 ) . C172 ) = C171 by L512 , FUNCT_1:def 3;
reconsider D75 = C172 as (SortSymbol of C169) by L513;
L515: C171 = ( FreeSort (C170 , D75) ) by L514 , L383
.= { B165 where B165 is (Element of ( TS D74 )) : ((ex B166 being set st (B166 in ( C170 . D75 ) & B165 = ( root-tree [ B166 , D75 ] ))) or (ex B167 being (OperSymbol of C169) st ([ B167 , (the carrier of C169) ] = ( B165 . ( {} ) ) & ( the_result_sort_of B167 ) = D75))) };
L516: (ex B168 being (Element of ( TS D74 )) st (B168 = R7 & ((ex B169 being set st (B169 in ( C170 . D75 ) & B168 = ( root-tree [ B169 , D75 ] ))) or (ex B170 being (OperSymbol of C169) st ([ B170 , (the carrier of C169) ] = ( B168 . ( {} ) ) & ( the_result_sort_of B170 ) = D75))))) by L515 , L511;
thus L517: thesis by L516;
end;

let R7 being set;
assume L518: R7 in ( TS D74 );
reconsider D76 = R7 as (Element of ( TS D74 )) by L518;
L519: (( rng D76 ) c= (the carrier of D74) & (the carrier of D74) = ( ( Terminals D74 ) \/ ( NonTerminals D74 ) )) by LANG1:1 , RELAT_1:def 19;
L520: ( {} ) in ( dom D76 ) by TREES_1:22;
L521: ( D76 . ( {} ) ) in ( rng D76 ) by L520 , FUNCT_1:def 3;
L522: ( NonTerminals D74 ) = [: (the carrier' of C169) , { (the carrier of C169) } :] by L200;
L523: ( Terminals D74 ) = ( Union ( coprod C170 ) ) by L200;
per cases  by L521 , L519 , XBOOLE_0:def 3;
suppose L524: ( D76 . ( {} ) ) in ( Terminals D74 );

reconsider D77 = ( D76 . ( {} ) ) as (Terminal of D74) by L524;
L525: D77 in ( union ( rng ( coprod C170 ) ) ) by L523 , L524 , CARD_3:def 4;
consider C173 being set such that L526: D77 in C173 and L527: C173 in ( rng ( coprod C170 ) ) by L525 , TARSKI:def 4;
consider C174 being set such that L528: C174 in ( dom ( coprod C170 ) ) and L529: ( ( coprod C170 ) . C174 ) = C173 by L527 , FUNCT_1:def 3;
reconsider D78 = C174 as (SortSymbol of C169) by L528;
L530: C173 = ( coprod (D78 , C170) ) by L529 , L66;
L531: (D76 = ( root-tree D77 ) & (ex B171 being set st (B171 in ( C170 . D78 ) & D77 = [ B171 , D78 ]))) by L530 , L526 , L41 , DTCONSTR:9;
L532: D76 in ( FreeSort (C170 , D78) ) by L531;
L533: D76 in ( ( FreeSort C170 ) . D78 ) by L532 , L383;
L534: ( ( FreeSort C170 ) . D78 ) in ( rng ( FreeSort C170 ) ) by L508 , FUNCT_1:def 3;
thus L535: thesis by L534 , L533 , TARSKI:def 4;
end;
suppose L536: ( D76 . ( {} ) ) in ( NonTerminals D74 );

reconsider D79 = ( D76 . ( {} ) ) as (NonTerminal of D74) by L536;
consider C175 being (OperSymbol of C169), C176 being (Element of { (the carrier of C169) }) such that L537: D79 = [ C175 , C176 ] by L522 , DOMAIN_1:1;
set D80 = ( the_result_sort_of C175 );
L538: C176 = (the carrier of C169) by TARSKI:def 1;
L539: D76 in ( FreeSort (C170 , D80) ) by L538 , L537;
L540: D76 in ( ( FreeSort C170 ) . D80 ) by L539 , L383;
L541: ( ( FreeSort C170 ) . D80 ) in ( rng ( FreeSort C170 ) ) by L508 , FUNCT_1:def 3;
thus L542: thesis by L541 , L540 , TARSKI:def 4;
end;
end;
theorem
L544: (for B172 being non  void non  empty ManySortedSign holds (for B173 being  non-empty (ManySortedSet of (the carrier of B172)) holds (for B174 , B175 being (SortSymbol of B172) holds (B174 <> B175 implies ( ( FreeSort B173 ) . B174 ) misses ( ( FreeSort B173 ) . B175 )))))
proof
let C177 being non  void non  empty ManySortedSign;
let C178 being  non-empty (ManySortedSet of (the carrier of C177));
let C179 , C180 being (SortSymbol of C177);
assume that
L545: C179 <> C180
and
L546: ( ( ( FreeSort C178 ) . C179 ) /\ ( ( FreeSort C178 ) . C180 ) ) <> ( {} );
consider R7 being set such that L547: R7 in ( ( ( FreeSort C178 ) . C179 ) /\ ( ( FreeSort C178 ) . C180 ) ) by L546 , XBOOLE_0:def 1;
set D81 = ( DTConMSA C178 );
L548: ( ( FreeSort C178 ) . C179 ) = ( FreeSort (C178 , C179) ) by L383;
L549: ( ( FreeSort C178 ) . C180 ) = ( FreeSort (C178 , C180) ) by L383;
L550: R7 in ( ( FreeSort C178 ) . C180 ) by L547 , XBOOLE_0:def 4;
consider C181 being (Element of ( TS D81 )) such that L551: C181 = R7 and L552: ((ex B176 being set st (B176 in ( C178 . C180 ) & C181 = ( root-tree [ B176 , C180 ] ))) or (ex B177 being (OperSymbol of C177) st ([ B177 , (the carrier of C177) ] = ( C181 . ( {} ) ) & ( the_result_sort_of B177 ) = C180))) by L550 , L549;
L553: R7 in ( ( FreeSort C178 ) . C179 ) by L547 , XBOOLE_0:def 4;
consider C182 being (Element of ( TS D81 )) such that L554: C182 = R7 and L555: ((ex B178 being set st (B178 in ( C178 . C179 ) & C182 = ( root-tree [ B178 , C179 ] ))) or (ex B179 being (OperSymbol of C177) st ([ B179 , (the carrier of C177) ] = ( C182 . ( {} ) ) & ( the_result_sort_of B179 ) = C179))) by L553 , L548;
per cases  by L555;
suppose L556: (ex B180 being set st (B180 in ( C178 . C179 ) & C182 = ( root-tree [ B180 , C179 ] )));

consider C183 being set such that L557: C183 in ( C178 . C179 ) and L558: C182 = ( root-tree [ C183 , C179 ] ) by L556;
L559:
now
per cases  by L552;
case L560: (ex B181 being set st (B181 in ( C178 . C180 ) & C181 = ( root-tree [ B181 , C180 ] )));
consider C184 being set such that L561: C184 in ( C178 . C180 ) and L562: C181 = ( root-tree [ C184 , C180 ] ) by L560;
L563: [ C183 , C179 ] = [ C184 , C180 ] by L554 , L551 , L558 , L562 , TREES_4:4;
thus L564: contradiction by L563 , L545 , XTUPLE_0:1;
end;
case L565: (ex B182 being (OperSymbol of C177) st ([ B182 , (the carrier of C177) ] = ( C181 . ( {} ) ) & ( the_result_sort_of B182 ) = C180));
consider C185 being (OperSymbol of C177) such that L566: [ C185 , (the carrier of C177) ] = ( C181 . ( {} ) ) and L567: ( the_result_sort_of C185 ) = C180 by L565;
L568: [ C185 , (the carrier of C177) ] = [ C183 , C179 ] by L554 , L551 , L558 , L566 , TREES_4:3;
L569: (the carrier of C177) = C179 by L568 , XTUPLE_0:1;
L570: (for B183 being set holds (not B183 in B183));
thus L571: contradiction by L570 , L569;
end;
end;
thus L573: contradiction by L559;
end;
suppose L574: (ex B184 being (OperSymbol of C177) st ([ B184 , (the carrier of C177) ] = ( C182 . ( {} ) ) & ( the_result_sort_of B184 ) = C179));

consider C186 being (OperSymbol of C177) such that L575: [ C186 , (the carrier of C177) ] = ( C182 . ( {} ) ) and L576: ( the_result_sort_of C186 ) = C179 by L574;
L577:
now
per cases  by L552;
case L578: (ex B185 being set st (B185 in ( C178 . C180 ) & C181 = ( root-tree [ B185 , C180 ] )));
consider C187 being set such that L579: C187 in ( C178 . C180 ) and L580: C181 = ( root-tree [ C187 , C180 ] ) by L578;
L581: [ C186 , (the carrier of C177) ] = [ C187 , C180 ] by L554 , L551 , L575 , L580 , TREES_4:3;
L582: (the carrier of C177) = C180 by L581 , XTUPLE_0:1;
L583: (for B186 being set holds (not B186 in B186));
thus L584: contradiction by L583 , L582;
end;
case L585: (ex B187 being (OperSymbol of C177) st ([ B187 , (the carrier of C177) ] = ( C181 . ( {} ) ) & ( the_result_sort_of B187 ) = C180));
thus L586: contradiction by L585 , L545 , L554 , L551 , L575 , L576 , XTUPLE_0:1;
end;
end;
thus L588: contradiction by L577;
end;
end;
definition
let C188 being non  void non  empty ManySortedSign;
let C189 being  non-empty (ManySortedSet of (the carrier of C188));
let C190 being (OperSymbol of C188);
func DenOp (C190 , C189) -> (Function of ( ( ( ( FreeSort C189 ) # ) * (the Arity of C188) ) . C190 ) , ( ( ( FreeSort C189 ) * (the ResultSort of C188) ) . C190 )) means 
:L590: (for B188 being (FinSequence of ( TS ( DTConMSA C189 ) )) holds (( Sym (C190 , C189) ) ==> ( roots B188 ) implies ( it . B188 ) = ( ( Sym (C190 , C189) ) -tree B188 )));
existence
proof
set D82 = ( ( ( ( FreeSort C189 ) # ) * (the Arity of C188) ) . C190 );
set D83 = ( ( ( FreeSort C189 ) * (the ResultSort of C188) ) . C190 );
set D84 = ( DTConMSA C189 );
set D85 = (the carrier' of C188);
set D86 = ( the_result_sort_of C190 );
set D87 = (the ResultSort of C188);
defpred S7[ set , set ] means (for B189 being (FinSequence of ( TS D84 )) holds (B189 = $1 implies $2 = ( ( Sym (C190 , C189) ) -tree B189 )));
L591: (for B190 being set holds (B190 in D82 implies (ex B191 being set st (B191 in D83 & S7[ B190 , B191 ]))))
proof
let C191 being set;
assume L592: C191 in D82;
reconsider D88 = C191 as (FinSequence of ( TS D84 )) by L592 , L398;
L593: ( Sym (C190 , C189) ) ==> ( roots D88 ) by L592 , L441;
reconsider D89 = ( ( Sym (C190 , C189) ) -tree D88 ) as (Element of ( TS D84 )) by L593 , DTCONSTR:def 1;
take D90 = ( ( Sym (C190 , C189) ) -tree D88 );
L594: C190 in D85;
L595: C190 in ( dom ( ( FreeSort C189 ) * D87 ) ) by L594 , PARTFUN1:def 2;
L596: D83 = ( ( FreeSort C189 ) . ( D87 . C190 ) ) by L595 , FUNCT_1:12
.= ( ( FreeSort C189 ) . D86 ) by MSUALG_1:def 2
.= ( FreeSort (C189 , D86) ) by L383;
L597: ( D89 . ( {} ) ) = ( Sym (C190 , C189) ) by TREES_4:def 4;
thus L598: D90 in D83 by L597 , L596;
thus L599: thesis;
end;
consider C192 being Function such that L600: (( dom C192 ) = D82 & ( rng C192 ) c= D83 & (for B192 being set holds (B192 in D82 implies S7[ B192 , ( C192 . B192 ) ]))) from FUNCT_1:sch 5(L591);
reconsider D91 = C192 as (Function of D82 , ( rng C192 )) by L600 , FUNCT_2:1;
reconsider D92 = D91 as (Function of D82 , D83) by L600 , FUNCT_2:2;
take D92;
let C193 being (FinSequence of ( TS D84 ));
assume L601: ( Sym (C190 , C189) ) ==> ( roots C193 );
L602: C193 in D82 by L601 , L441;
thus L603: thesis by L602 , L600;
end;
uniqueness
proof
set D93 = ( ( ( ( FreeSort C189 ) # ) * (the Arity of C188) ) . C190 );
set D94 = ( ( ( FreeSort C189 ) * (the ResultSort of C188) ) . C190 );
set D95 = ( DTConMSA C189 );
let C194 , C195 being (Function of D93 , D94);
assume that
L604: (for B193 being (FinSequence of ( TS D95 )) holds (( Sym (C190 , C189) ) ==> ( roots B193 ) implies ( C194 . B193 ) = ( ( Sym (C190 , C189) ) -tree B193 )))
and
L605: (for B194 being (FinSequence of ( TS D95 )) holds (( Sym (C190 , C189) ) ==> ( roots B194 ) implies ( C195 . B194 ) = ( ( Sym (C190 , C189) ) -tree B194 )));
L606: (for B195 being set holds (B195 in D93 implies ( C194 . B195 ) = ( C195 . B195 )))
proof
let C196 being set;
assume L607: C196 in D93;
reconsider D96 = C196 as (FinSequence of ( TS D95 )) by L607 , L398;
L608: ( Sym (C190 , C189) ) ==> ( roots D96 ) by L607 , L441;
L609: ( C194 . D96 ) = ( ( Sym (C190 , C189) ) -tree D96 ) by L608 , L604;
thus L610: thesis by L609 , L605 , L608;
end;
L611: (( dom C194 ) = D93 & ( dom C195 ) = D93) by FUNCT_2:def 1;
thus L612: thesis by L611 , L606 , FUNCT_1:2;
end;
end;
definition
let C197 being non  void non  empty ManySortedSign;
let C198 being  non-empty (ManySortedSet of (the carrier of C197));
func FreeOper C198 -> (ManySortedFunction of ( ( ( FreeSort C198 ) # ) * (the Arity of C197) ) , ( ( FreeSort C198 ) * (the ResultSort of C197) )) means 
:L614: (for B196 being (OperSymbol of C197) holds ( it . B196 ) = ( DenOp (B196 , C198) ));
existence
proof
defpred S8[ set , set ] means (for B197 being (OperSymbol of C197) holds ($1 = B197 implies $2 = ( DenOp (B197 , C198) )));
set D97 = (the carrier' of C197);
L615: (for B198 being set holds (B198 in D97 implies (ex B199 being set st S8[ B198 , B199 ])))
proof
let C199 being set;
assume L616: C199 in D97;
reconsider D98 = C199 as (OperSymbol of C197) by L616;
take ( DenOp (D98 , C198) );
thus L617: thesis;
end;
consider C200 being Function such that L618: (( dom C200 ) = D97 & (for B200 being set holds (B200 in D97 implies S8[ B200 , ( C200 . B200 ) ]))) from CLASSES1:sch 1(L615);
reconsider D99 = C200 as (ManySortedSet of D97) by L618 , PARTFUN1:def 2 , RELAT_1:def 18;
L619: (for B201 being set holds (B201 in ( dom D99 ) implies ( D99 . B201 ) is Function))
proof
let C201 being set;
assume L620: C201 in ( dom D99 );
reconsider D100 = C201 as (OperSymbol of C197) by L620;
L621: ( D99 . D100 ) = ( DenOp (D100 , C198) ) by L618;
thus L622: thesis by L621;
end;
reconsider D101 = D99 as (ManySortedFunction of D97) by L619 , FUNCOP_1:def 6;
L623: (for B202 being set holds (B202 in D97 implies ( D101 . B202 ) is (Function of ( ( ( ( FreeSort C198 ) # ) * (the Arity of C197) ) . B202 ) , ( ( ( FreeSort C198 ) * (the ResultSort of C197) ) . B202 ))))
proof
let C202 being set;
assume L624: C202 in D97;
reconsider D102 = C202 as (OperSymbol of C197) by L624;
L625: ( D101 . D102 ) = ( DenOp (D102 , C198) ) by L618;
thus L626: thesis by L625;
end;
reconsider D103 = D101 as (ManySortedFunction of ( ( ( FreeSort C198 ) # ) * (the Arity of C197) ) , ( ( FreeSort C198 ) * (the ResultSort of C197) )) by L623 , PBOOLE:def 15;
take D103;
let C203 being (OperSymbol of C197);
thus L627: thesis by L618;
end;
uniqueness
proof
let C204 , C205 being (ManySortedFunction of ( ( ( FreeSort C198 ) # ) * (the Arity of C197) ) , ( ( FreeSort C198 ) * (the ResultSort of C197) ));
assume that
L628: (for B203 being (OperSymbol of C197) holds ( C204 . B203 ) = ( DenOp (B203 , C198) ))
and
L629: (for B204 being (OperSymbol of C197) holds ( C205 . B204 ) = ( DenOp (B204 , C198) ));
L630: (for B205 being set holds (B205 in (the carrier' of C197) implies ( C204 . B205 ) = ( C205 . B205 )))
proof
let C206 being set;
assume L631: C206 in (the carrier' of C197);
reconsider D104 = C206 as (OperSymbol of C197) by L631;
L632: ( C204 . D104 ) = ( DenOp (D104 , C198) ) by L628;
thus L633: thesis by L632 , L629;
end;
thus L634: thesis by L630 , PBOOLE:3;
end;
end;
definition
let C207 being non  void non  empty ManySortedSign;
let C208 being  non-empty (ManySortedSet of (the carrier of C207));
func FreeMSA C208 -> MSAlgebra over C207 equals 
MSAlgebra (# ( FreeSort C208 ) , ( FreeOper C208 ) #);
coherence;
end;
registration
let C209 being non  void non  empty ManySortedSign;
let C210 being  non-empty (ManySortedSet of (the carrier of C209));
cluster ( FreeMSA C210 ) ->  strict  non-empty;
coherence by MSUALG_1:def 3;
end;
definition
let C211 being non  void non  empty ManySortedSign;
let C212 being  non-empty (ManySortedSet of (the carrier of C211));
let C213 being (SortSymbol of C211);
func FreeGen (C213 , C212) -> (Subset of ( ( FreeSort C212 ) . C213 )) means 
:L638: (for B206 being set holds (B206 in it iff (ex B207 being set st (B207 in ( C212 . C213 ) & B206 = ( root-tree [ B207 , C213 ] )))));
existence
proof
defpred S9[ set ] means (ex B208 being set st (B208 in ( C212 . C213 ) & $1 = ( root-tree [ B208 , C213 ] )));
set D105 = ( DTConMSA C212 );
consider C214 being set such that L639: (for R7 being set holds (R7 in C214 iff (R7 in ( ( FreeSort C212 ) . C213 ) & S9[ R7 ]))) from XBOOLE_0:sch 1;
L640: C214 c= ( ( FreeSort C212 ) . C213 )
proof
let R7 being set;
assume L641: R7 in C214;
thus L642: thesis by L641 , L639;
end;
reconsider D106 = C214 as (Subset of ( ( FreeSort C212 ) . C213 )) by L640;
L643: (for R7 being set holds (R7 in D106 iff S9[ R7 ]))
proof
L644: ( dom ( coprod C212 ) ) = (the carrier of C211) by PARTFUN1:def 2;
L645: ( ( coprod C212 ) . C213 ) in ( rng ( coprod C212 ) ) by L644 , FUNCT_1:def 3;
L646: ( coprod (C213 , C212) ) in ( rng ( coprod C212 ) ) by L645 , L66;
L647: ( Terminals D105 ) = ( Union ( coprod C212 ) ) by L200;
let R7 being set;
thus L648: (R7 in D106 implies S9[ R7 ]) by L639;
set D107 = { B209 where B209 is (Element of ( TS D105 )) : ((ex B210 being set st (B210 in ( C212 . C213 ) & B209 = ( root-tree [ B210 , C213 ] ))) or (ex B211 being (OperSymbol of C211) st ([ B211 , (the carrier of C211) ] = ( B209 . ( {} ) ) & ( the_result_sort_of B211 ) = C213))) };
assume L649: S9[ R7 ];
consider C215 being set such that L650: C215 in ( C212 . C213 ) and L651: R7 = ( root-tree [ C215 , C213 ] ) by L649;
L652: ( ( FreeSort C212 ) . C213 ) = ( FreeSort (C212 , C213) ) by L383;
set D108 = [ C215 , C213 ];
L653: D108 in ( coprod (C213 , C212) ) by L650 , L41;
L654: D108 in ( union ( rng ( coprod C212 ) ) ) by L653 , L646 , TARSKI:def 4;
L655: D108 in ( Terminals D105 ) by L654 , L647 , CARD_3:def 4;
reconsider D109 = D108 as (Symbol of D105) by L655;
reconsider D110 = ( root-tree D109 ) as (Element of ( TS D105 )) by L655 , DTCONSTR:def 1;
L656: D110 in D107 by L650;
thus L657: thesis by L656 , L639 , L649 , L651 , L652;
end;
thus L658: thesis by L643;
end;
uniqueness
proof
let C216 , C217 being (Subset of ( ( FreeSort C212 ) . C213 ));
assume that
L659: (for B212 being set holds (B212 in C216 iff (ex B213 being set st (B213 in ( C212 . C213 ) & B212 = ( root-tree [ B213 , C213 ] )))))
and
L660: (for B214 being set holds (B214 in C217 iff (ex B215 being set st (B215 in ( C212 . C213 ) & B214 = ( root-tree [ B215 , C213 ] )))));
thus L661: C216 c= C217
proof
let C218 being set;
assume L662: C218 in C216;
L663: (ex B216 being set st (B216 in ( C212 . C213 ) & C218 = ( root-tree [ B216 , C213 ] ))) by L662 , L659;
thus L664: thesis by L663 , L660;
end;

let C219 being set;
assume L665: C219 in C217;
L666: (ex B217 being set st (B217 in ( C212 . C213 ) & C219 = ( root-tree [ B217 , C213 ] ))) by L665 , L660;
thus L667: thesis by L666 , L659;
end;
end;
registration
let C220 being non  void non  empty ManySortedSign;
let C221 being  non-empty (ManySortedSet of (the carrier of C220));
let C222 being (SortSymbol of C220);
cluster ( FreeGen (C222 , C221) ) -> non  empty;
coherence
proof
consider R7 being set such that L669: R7 in ( C221 . C222 ) by XBOOLE_0:def 1;
L670: (ex B218 being set st (B218 in ( C221 . C222 ) & ( root-tree [ R7 , C222 ] ) = ( root-tree [ B218 , C222 ] ))) by L669;
thus L671: thesis by L670 , L638;
end;
end;
theorem
L673: (for B219 being non  void non  empty ManySortedSign holds (for B220 being  non-empty (ManySortedSet of (the carrier of B219)) holds (for B221 being (SortSymbol of B219) holds ( FreeGen (B221 , B220) ) = { ( root-tree B222 ) where B222 is (Symbol of ( DTConMSA B220 )) : (B222 in ( Terminals ( DTConMSA B220 ) ) & ( B222 `2 ) = B221) })))
proof
let C223 being non  void non  empty ManySortedSign;
let C224 being  non-empty (ManySortedSet of (the carrier of C223));
let C225 being (SortSymbol of C223);
set D111 = ( DTConMSA C224 );
set D112 = { ( root-tree B223 ) where B223 is (Symbol of D111) : (B223 in ( Terminals D111 ) & ( B223 `2 ) = C225) };
thus L674: ( FreeGen (C225 , C224) ) c= D112
proof
let C226 being set;
assume L675: C226 in ( FreeGen (C225 , C224) );
consider C227 being set such that L676: C227 in ( C224 . C225 ) and L677: C226 = ( root-tree [ C227 , C225 ] ) by L675 , L638;
L678: [ C227 , C225 ] in ( Terminals D111 ) by L676 , L340;
reconsider D113 = [ C227 , C225 ] as (Symbol of D111) by L678;
L679: ( D113 `2 ) = C225 by MCART_1:7;
thus L680: thesis by L679 , L677 , L678;
end;

let C228 being set;
assume L681: C228 in D112;
consider C229 being (Symbol of D111) such that L682: C228 = ( root-tree C229 ) and L683: C229 in ( Terminals D111 ) and L684: ( C229 `2 ) = C225 by L681;
consider C230 being (SortSymbol of C223), C231 being set such that L685: C231 in ( C224 . C230 ) and L686: C229 = [ C231 , C230 ] by L683 , L340;
L687: C225 = C230 by L684 , L686 , MCART_1:7;
thus L688: thesis by L687 , L682 , L685 , L686 , L638;
end;
definition
let C232 being non  void non  empty ManySortedSign;
let C233 being  non-empty (ManySortedSet of (the carrier of C232));
func FreeGen C233 -> (GeneratorSet of ( FreeMSA C233 )) means 
:L689: (for B224 being (SortSymbol of C232) holds ( it . B224 ) = ( FreeGen (B224 , C233) ));
existence
proof
deffunc H3((Element of C232)) = ( FreeGen ($1 , C233) );
set D114 = ( FreeMSA C233 );
set D115 = ( DTConMSA C233 );
consider C234 being Function such that L690: (( dom C234 ) = (the carrier of C232) & (for B225 being (Element of C232) holds ( C234 . B225 ) = H3(B225))) from FUNCT_1:sch 4;
reconsider D116 = C234 as (ManySortedSet of (the carrier of C232)) by L690 , PARTFUN1:def 2 , RELAT_1:def 18;
L691: D116 c= (the Sorts of D114)
proof
let R7 being set;
assume L692: R7 in (the carrier of C232);
reconsider D117 = R7 as (SortSymbol of C232) by L692;
L693: ( D116 . D117 ) = ( FreeGen (D117 , C233) ) by L690;
thus L694: thesis by L693;
end;
reconsider D118 = D116 as (MSSubset of D114) by L691 , PBOOLE:def 18;
L695: (the Sorts of ( GenMSAlg D118 )) = (the Sorts of D114)
proof
defpred S10[ set ] means $1 in ( union ( rng (the Sorts of ( GenMSAlg D118 )) ) );
L696: (the Sorts of ( GenMSAlg D118 )) is (MSSubset of D114) by MSUALG_2:def 9;
L697: (the Sorts of ( GenMSAlg D118 )) c= (the Sorts of D114) by L696 , PBOOLE:def 18;
L698: (for B226 being (Symbol of D115) holds (for B227 being (FinSequence of ( TS D115 )) holds ((B226 ==> ( roots B227 ) & (for B228 being (DecoratedTree of (the carrier of D115)) holds (B228 in ( rng B227 ) implies S10[ B228 ]))) implies S10[ ( B226 -tree B227 ) ])))
proof
set D119 = ( GenMSAlg D118 );
set D120 = ( [: (the carrier' of C232) , { (the carrier of C232) } :] \/ ( Union ( coprod (C233 qua (ManySortedSet of (the carrier of C232))) ) ) );
let C235 being (Symbol of D115);
let C236 being (FinSequence of ( TS D115 ));
assume that
L699: C235 ==> ( roots C236 )
and
L700: (for B229 being (DecoratedTree of (the carrier of D115)) holds (B229 in ( rng C236 ) implies S10[ B229 ]));
reconsider D121 = C235 as (Element of D120);
L701: [ C235 , ( roots C236 ) ] in (the Rules of D115) by L699 , LANG1:def 1;
reconsider D122 = ( roots C236 ) as (Element of ( D120 * )) by L701 , ZFMISC_1:87;
L702: [ D121 , D122 ] in ( REL C233 ) by L699 , LANG1:def 1;
L703: D121 in [: (the carrier' of C232) , { (the carrier of C232) } :] by L702 , L164;
consider C237 being (OperSymbol of C232), C238 being (Element of { (the carrier of C232) }) such that L704: D121 = [ C237 , C238 ] by L703 , DOMAIN_1:1;
set D123 = ( the_arity_of C237 );
set D124 = ( the_result_sort_of C237 );
L705: C238 = (the carrier of C232) by TARSKI:def 1;
L706: [ C235 , ( roots C236 ) ] in ( REL C233 ) by L699 , LANG1:def 1;
L707: ( len D122 ) = ( len D123 ) by L706 , L704 , L705 , L185;
reconsider D125 = (the Sorts of D119) as (MSSubset of D114) by MSUALG_2:def 9;
L708: ( dom D125 ) = (the carrier of C232) by PARTFUN1:def 2;
L709: ( dom ( roots C236 ) ) = ( dom C236 ) by TREES_3:def 18;
L710: ( rng D123 ) c= (the carrier of C232) by FINSEQ_1:def 4;
L711: ( dom ( D125 * D123 ) ) = ( dom D123 ) by L710 , L708 , RELAT_1:27;
L712: (( Seg ( len D122 ) ) = ( dom D122 ) & ( Seg ( len D123 ) ) = ( dom D123 )) by FINSEQ_1:def 3;
L713: ( dom C236 ) = ( dom D123 ) by L712 , L701 , L704 , L705 , L709 , L185;
L714: (for R7 being set holds (R7 in ( dom ( D125 * D123 ) ) implies ( C236 . R7 ) in ( ( D125 * D123 ) . R7 )))
proof
let R7 being set;
assume L715: R7 in ( dom ( D125 * D123 ) );
reconsider D126 = R7 as Nat by L715;
L716: ( C236 . D126 ) in ( rng C236 ) by L711 , L709 , L707 , L712 , L715 , FUNCT_1:def 3;
L717: ( rng C236 ) c= ( TS D115 ) by FINSEQ_1:def 4;
reconsider D127 = ( C236 . R7 ) as (Element of ( TS D115 )) by L717 , L716;
L718: S10[ D127 ] by L700 , L716;
consider C239 being set such that L719: D127 in C239 and L720: C239 in ( rng (the Sorts of D119) ) by L718 , TARSKI:def 4;
set D128 = ( D123 /. D126 );
set D129 = { B230 where B230 is (Element of ( TS D115 )) : ((ex B231 being set st (B231 in ( C233 . D128 ) & B230 = ( root-tree [ B231 , D128 ] ))) or (ex B232 being (OperSymbol of C232) st ([ B232 , (the carrier of C232) ] = ( B230 . ( {} ) ) & ( the_result_sort_of B232 ) = D128))) };
L721: D129 = ( FreeSort (C233 , D128) )
.= ( ( FreeSort C233 ) . D128 ) by L383;
L722: (ex B233 being DecoratedTree st (B233 = ( C236 . D126 ) & ( D122 . D126 ) = ( B233 . ( {} ) ))) by L711 , L709 , L707 , L712 , L715 , TREES_3:def 18;
consider C240 being set such that L723: C240 in ( dom (the Sorts of D119) ) and L724: ( (the Sorts of D119) . C240 ) = C239 by L720 , FUNCT_1:def 3;
reconsider D130 = C240 as (SortSymbol of C232) by L723;
L725: (( rng D122 ) c= ( [: (the carrier' of C232) , { (the carrier of C232) } :] \/ ( Union ( coprod C233 ) ) ) & ( D122 . D126 ) in ( rng D122 )) by L711 , L707 , L712 , L715 , FINSEQ_1:def 4 , FUNCT_1:def 3;
L726:
now
per cases  by L725 , XBOOLE_0:def 3;
suppose L727: ( D122 . D126 ) in [: (the carrier' of C232) , { (the carrier of C232) } :];

consider C241 being (OperSymbol of C232), C242 being (Element of { (the carrier of C232) }) such that L728: ( D122 . D126 ) = [ C241 , C242 ] by L727 , DOMAIN_1:1;
L729: C242 = (the carrier of C232) by TARSKI:def 1;
L730: ( the_result_sort_of C241 ) = ( D123 . D126 ) by L729 , L701 , L704 , L705 , L711 , L709 , L713 , L715 , L727 , L728 , L185
.= D128 by L711 , L715 , PARTFUN1:def 6;
thus L731: D127 in ( ( FreeSort C233 ) . D128 ) by L730 , L721 , L722 , L728 , L729;
end;
suppose L732: ( D122 . D126 ) in ( Union ( coprod C233 ) );

L733: ( D122 . D126 ) in ( coprod (( D123 . D126 ) , C233) ) by L732 , L701 , L704 , L705 , L711 , L709 , L713 , L715 , L185;
L734: ( D122 . D126 ) in ( coprod (D128 , C233) ) by L733 , L711 , L715 , PARTFUN1:def 6;
L735: (ex B234 being set st (B234 in ( C233 . D128 ) & ( D122 . D126 ) = [ B234 , D128 ])) by L734 , L41;
reconsider D131 = ( D122 . D126 ) as (Terminal of D115) by L732 , L200;
L736: D127 = ( root-tree D131 ) by L722 , DTCONSTR:9;
thus L737: D127 in ( ( FreeSort C233 ) . D128 ) by L736 , L721 , L735;
end;
end;
L739:
now
assume L740: D128 <> D130;
L741: ( ( FreeSort C233 ) . D130 ) misses ( ( FreeSort C233 ) . D128 ) by L740 , L544;
L742: ( (the Sorts of D119) . D130 ) c= ( (the Sorts of D114) . D130 ) by L697 , PBOOLE:def 2;
thus L743: contradiction by L742 , L719 , L724 , L726 , L741 , XBOOLE_0:3;
end;
L744: ( ( D125 * D123 ) . R7 ) = ( D125 . ( D123 . D126 ) ) by L715 , FUNCT_1:12
.= ( D125 . ( D123 /. D126 ) ) by L711 , L715 , PARTFUN1:def 6;
thus L745: thesis by L744 , L719 , L724 , L739;
end;
set D132 = (the Arity of C232);
set D133 = (the ResultSort of C232);
set D134 = ( ( D125 # ) * (the Arity of C232) );
set D135 = (the carrier' of C232);
L746: ( Den (C237 , D114) ) = ( ( FreeOper C233 ) . C237 ) by MSUALG_1:def 6
.= ( DenOp (C237 , C233) ) by L614;
L747: (( Sym (C237 , C233) ) = [ C237 , (the carrier of C232) ] & C235 = [ C237 , (the carrier of C232) ]) by L704 , TARSKI:def 1;
L748: ( D132 . C237 ) = D123 by MSUALG_1:def 1;
L749: ( D134 . C237 ) = ( product ( D125 * D123 ) ) by L748 , L1;
L750: C236 in ( D134 . C237 ) by L749 , L711 , L709 , L707 , L712 , L714 , CARD_3:9;
L751: ( dom ( DenOp (C237 , C233) ) ) = ( ( ( ( FreeSort C233 ) # ) * D132 ) . C237 ) by FUNCT_2:def 1;
L752: C236 in ( dom ( DenOp (C237 , C233) ) ) by L751 , L699 , L747 , L441;
L753: C236 in ( ( dom ( DenOp (C237 , C233) ) ) /\ ( D134 . C237 ) ) by L752 , L750 , XBOOLE_0:def 4;
L754: C236 in ( dom ( ( DenOp (C237 , C233) ) | ( D134 . C237 ) ) ) by L753 , RELAT_1:61;
L755: ( ( ( DenOp (C237 , C233) ) | ( D134 . C237 ) ) . C236 ) = ( ( DenOp (C237 , C233) ) . C236 ) by L754 , FUNCT_1:47
.= ( C235 -tree C236 ) by L699 , L747 , L590;
L756: ( C235 -tree C236 ) in ( rng ( ( Den (C237 , D114) ) | ( D134 . C237 ) ) ) by L755 , L746 , L754 , FUNCT_1:def 3;
L757: (( D133 . C237 ) = D124 & ( dom ( D125 * D133 ) ) = D135) by MSUALG_1:def 2 , PARTFUN1:def 2;
L758: ( ( D125 * D133 ) . C237 ) = ( D125 . D124 ) by L757 , FUNCT_1:12;
L759: D125 is  opers_closed by MSUALG_2:def 9;
L760: D125 is_closed_on C237 by L759 , MSUALG_2:def 6;
L761: ( rng ( ( Den (C237 , D114) ) | ( D134 . C237 ) ) ) c= ( ( D125 * D133 ) . C237 ) by L760 , MSUALG_2:def 5;
L762: ( D125 . D124 ) in ( rng D125 ) by L708 , FUNCT_1:def 3;
thus L763: thesis by L762 , L761 , L756 , L758 , TARSKI:def 4;
end;
L764: (for B235 being (Symbol of D115) holds (B235 in ( Terminals D115 ) implies S10[ ( root-tree B235 ) ]))
proof
let C243 being (Symbol of D115);
assume L765: C243 in ( Terminals D115 );
L766: C243 in ( Union ( coprod C233 ) ) by L765 , L200;
L767: C243 in ( union ( rng ( coprod C233 ) ) ) by L766 , CARD_3:def 4;
consider C244 being set such that L768: C243 in C244 and L769: C244 in ( rng ( coprod C233 ) ) by L767 , TARSKI:def 4;
consider C245 being set such that L770: C245 in ( dom ( coprod C233 ) ) and L771: ( ( coprod C233 ) . C245 ) = C244 by L769 , FUNCT_1:def 3;
reconsider D136 = C245 as (SortSymbol of C232) by L770;
L772: C244 = ( coprod (D136 , C233) ) by L771 , L66;
L773: (ex B236 being set st (B236 in ( C233 . D136 ) & C243 = [ B236 , D136 ])) by L772 , L768 , L41;
L774: ( root-tree C243 ) in ( FreeGen (D136 , C233) ) by L773 , L638;
L775: D118 is (MSSubset of ( GenMSAlg D118 )) by MSUALG_2:def 17;
L776: D118 c= (the Sorts of ( GenMSAlg D118 )) by L775 , PBOOLE:def 18;
L777: ( D118 . D136 ) c= ( (the Sorts of ( GenMSAlg D118 )) . D136 ) by L776 , PBOOLE:def 2;
L778: ( FreeGen (D136 , C233) ) c= ( (the Sorts of ( GenMSAlg D118 )) . D136 ) by L777 , L690;
L779: ( dom (the Sorts of ( GenMSAlg D118 )) ) = (the carrier of C232) by PARTFUN1:def 2;
L780: ( (the Sorts of ( GenMSAlg D118 )) . D136 ) in ( rng (the Sorts of ( GenMSAlg D118 )) ) by L779 , FUNCT_1:def 3;
thus L781: thesis by L780 , L778 , L774 , TARSKI:def 4;
end;
L782: (for B237 being (DecoratedTree of (the carrier of D115)) holds (B237 in ( TS D115 ) implies S10[ B237 ])) from DTCONSTR:sch 7(L764 , L698);
L783: ( union ( rng (the Sorts of D114) ) ) c= ( union ( rng (the Sorts of ( GenMSAlg D118 )) ) )
proof
set D137 = ( DTConMSA C233 );
let R7 being set;
assume L784: R7 in ( union ( rng (the Sorts of D114) ) );
consider C246 being set such that L785: R7 in C246 and L786: C246 in ( rng (the Sorts of D114) ) by L784 , TARSKI:def 4;
consider C247 being set such that L787: C247 in ( dom ( FreeSort C233 ) ) and L788: ( ( FreeSort C233 ) . C247 ) = C246 by L786 , FUNCT_1:def 3;
reconsider D138 = C247 as (SortSymbol of C232) by L787;
L789: C246 = ( FreeSort (C233 , D138) ) by L788 , L383
.= { B238 where B238 is (Element of ( TS D137 )) : ((ex B239 being set st (B239 in ( C233 . D138 ) & B238 = ( root-tree [ B239 , D138 ] ))) or (ex B240 being (OperSymbol of C232) st ([ B240 , (the carrier of C232) ] = ( B238 . ( {} ) ) & ( the_result_sort_of B240 ) = D138))) };
L790: (ex B241 being (Element of ( TS D137 )) st (B241 = R7 & ((ex B242 being set st (B242 in ( C233 . D138 ) & B241 = ( root-tree [ B242 , D138 ] ))) or (ex B243 being (OperSymbol of C232) st ([ B243 , (the carrier of C232) ] = ( B241 . ( {} ) ) & ( the_result_sort_of B243 ) = D138))))) by L789 , L785;
thus L791: thesis by L790 , L782;
end;
let C248 being (Element of C232);
reconsider D139 = C248 as (SortSymbol of C232);
thus L792: ( (the Sorts of ( GenMSAlg D118 )) . C248 ) c= ( (the Sorts of D114) . C248 ) by L697 , PBOOLE:def 2;
let C249 being set;
assume L793: C249 in ( (the Sorts of D114) . C248 );
L794: (the carrier of C232) = ( dom (the Sorts of D114) ) by PARTFUN1:def 2;
L795: ( (the Sorts of D114) . D139 ) in ( rng (the Sorts of D114) ) by L794 , FUNCT_1:def 3;
L796: C249 in ( union ( rng (the Sorts of D114) ) ) by L795 , L793 , TARSKI:def 4;
consider C250 being set such that L797: C249 in C250 and L798: C250 in ( rng (the Sorts of ( GenMSAlg D118 )) ) by L796 , L783 , TARSKI:def 4;
consider C251 being set such that L799: C251 in ( dom (the Sorts of ( GenMSAlg D118 )) ) and L800: ( (the Sorts of ( GenMSAlg D118 )) . C251 ) = C250 by L798 , FUNCT_1:def 3;
reconsider D140 = C251 as (SortSymbol of C232) by L799;
L801:
now
assume L802: D140 <> D139;
L803: ( ( FreeSort C233 ) . D139 ) misses ( ( FreeSort C233 ) . D140 ) by L802 , L544;
L804: ( ( ( FreeSort C233 ) . D139 ) /\ ( ( FreeSort C233 ) . D140 ) ) = ( {} ) by L803 , XBOOLE_0:def 7;
L805: ( (the Sorts of ( GenMSAlg D118 )) . D140 ) c= ( (the Sorts of D114) . D140 ) by L697 , PBOOLE:def 2;
thus L806: contradiction by L805 , L793 , L797 , L800 , L804 , XBOOLE_0:def 4;
end;
thus L807: thesis by L801 , L797 , L800;
end;
reconsider D141 = D118 as (GeneratorSet of D114) by L695 , L131;
take D141;
thus L808: thesis by L690;
end;
uniqueness
proof
let C252 , C253 being (GeneratorSet of ( FreeMSA C233 ));
assume that
L809: (for B244 being (SortSymbol of C232) holds ( C252 . B244 ) = ( FreeGen (B244 , C233) ))
and
L810: (for B245 being (SortSymbol of C232) holds ( C253 . B245 ) = ( FreeGen (B245 , C233) ));
L811: (for B246 being set holds (B246 in (the carrier of C232) implies ( C252 . B246 ) = ( C253 . B246 )))
proof
let C254 being set;
assume L812: C254 in (the carrier of C232);
reconsider D142 = C254 as (SortSymbol of C232) by L812;
L813: ( C252 . D142 ) = ( FreeGen (D142 , C233) ) by L809;
thus L814: thesis by L813 , L810;
end;
thus L815: thesis by L811 , PBOOLE:3;
end;
end;
theorem
L817: (for B247 being non  void non  empty ManySortedSign holds (for B248 being  non-empty (ManySortedSet of (the carrier of B247)) holds ( FreeGen B248 ) is  non-empty))
proof
let C255 being non  void non  empty ManySortedSign;
let C256 being  non-empty (ManySortedSet of (the carrier of C255));
let R7 being set;
assume L818: R7 in (the carrier of C255);
reconsider D143 = R7 as (SortSymbol of C255) by L818;
L819: ( ( FreeGen C256 ) . D143 ) = ( FreeGen (D143 , C256) ) by L689;
thus L820: thesis by L819;
end;
theorem
L821: (for B249 being non  void non  empty ManySortedSign holds (for B250 being  non-empty (ManySortedSet of (the carrier of B249)) holds ( union ( rng ( FreeGen B250 ) ) ) = { ( root-tree B251 ) where B251 is (Symbol of ( DTConMSA B250 )) : B251 in ( Terminals ( DTConMSA B250 ) ) }))
proof
let C257 being non  void non  empty ManySortedSign;
let C258 being  non-empty (ManySortedSet of (the carrier of C257));
set D144 = ( DTConMSA C258 );
set D145 = ( union ( rng ( FreeGen C258 ) ) );
set D146 = { ( root-tree B252 ) where B252 is (Symbol of D144) : B252 in ( Terminals D144 ) };
thus L822: D145 c= D146
proof
let R7 being set;
assume L823: R7 in D145;
consider C259 being set such that L824: R7 in C259 and L825: C259 in ( rng ( FreeGen C258 ) ) by L823 , TARSKI:def 4;
consider C260 being set such that L826: C260 in ( dom ( FreeGen C258 ) ) and L827: ( ( FreeGen C258 ) . C260 ) = C259 by L825 , FUNCT_1:def 3;
reconsider D147 = C260 as (SortSymbol of C257) by L826;
L828: C259 = ( FreeGen (D147 , C258) ) by L827 , L689
.= { ( root-tree B253 ) where B253 is (Symbol of D144) : (B253 in ( Terminals D144 ) & ( B253 `2 ) = D147) } by L673;
L829: (ex B254 being (Symbol of D144) st (R7 = ( root-tree B254 ) & B254 in ( Terminals D144 ) & ( B254 `2 ) = D147)) by L828 , L824;
thus L830: thesis by L829;
end;

let R7 being set;
assume L831: R7 in D146;
consider C261 being (Symbol of D144) such that L832: R7 = ( root-tree C261 ) and L833: C261 in ( Terminals D144 ) by L831;
consider C262 being (SortSymbol of C257), C263 being set such that L834: C263 in ( C258 . C262 ) and L835: C261 = [ C263 , C262 ] by L833 , L340;
L836: ( C261 `2 ) = C262 by L835 , MCART_1:7;
L837: R7 in { ( root-tree B255 ) where B255 is (Symbol of D144) : (B255 in ( Terminals D144 ) & ( B255 `2 ) = C262) } by L836 , L832 , L833;
L838: R7 in ( FreeGen (C262 , C258) ) by L837 , L673;
L839: R7 in ( ( FreeGen C258 ) . C262 ) by L838 , L689;
L840: ( dom ( FreeGen C258 ) ) = (the carrier of C257) by PARTFUN1:def 2;
L841: ( ( FreeGen C258 ) . C262 ) in ( rng ( FreeGen C258 ) ) by L840 , FUNCT_1:def 3;
thus L842: thesis by L841 , L839 , TARSKI:def 4;
end;
definition
let C264 being non  void non  empty ManySortedSign;
let C265 being  non-empty (ManySortedSet of (the carrier of C264));
let C266 being (SortSymbol of C264);
func Reverse (C266 , C265) -> (Function of ( FreeGen (C266 , C265) ) , ( C265 . C266 )) means 
:L843: (for B256 being (Symbol of ( DTConMSA C265 )) holds (( root-tree B256 ) in ( FreeGen (C266 , C265) ) implies ( it . ( root-tree B256 ) ) = ( B256 `1 )));
existence
proof
set D148 = ( FreeGen (C266 , C265) );
set D149 = ( DTConMSA C265 );
defpred S11[ set , set ] means (for B257 being (Symbol of D149) holds ($1 = ( root-tree B257 ) implies $2 = ( B257 `1 )));
L844: (for B258 being set holds (B258 in D148 implies (ex B259 being set st (B259 in ( C265 . C266 ) & S11[ B258 , B259 ]))))
proof
let C267 being set;
assume L845: C267 in D148;
L846: C267 in { ( root-tree B260 ) where B260 is (Symbol of D149) : (B260 in ( Terminals D149 ) & ( B260 `2 ) = C266) } by L845 , L673;
consider C268 being (Symbol of D149) such that L847: C267 = ( root-tree C268 ) and L848: C268 in ( Terminals D149 ) and L849: ( C268 `2 ) = C266 by L846;
consider C269 being (SortSymbol of C264), C270 being set such that L850: C270 in ( C265 . C269 ) and L851: C268 = [ C270 , C269 ] by L848 , L340;
take C270;
thus L852: C270 in ( C265 . C266 ) by L849 , L850 , L851 , MCART_1:7;
let C271 being (Symbol of D149);
assume L853: C267 = ( root-tree C271 );
L854: C268 = C271 by L853 , L847 , TREES_4:4;
thus L855: thesis by L854 , L851 , MCART_1:7;
end;
consider C272 being Function such that L856: (( dom C272 ) = D148 & ( rng C272 ) c= ( C265 . C266 ) & (for B261 being set holds (B261 in D148 implies S11[ B261 , ( C272 . B261 ) ]))) from FUNCT_1:sch 5(L844);
reconsider D150 = C272 as (Function of D148 , ( C265 . C266 )) by L856 , FUNCT_2:2;
take D150;
let C273 being (Symbol of D149);
assume L857: ( root-tree C273 ) in D148;
thus L858: thesis by L857 , L856;
end;
uniqueness
proof
set D151 = ( DTConMSA C265 );
set D152 = { ( root-tree B262 ) where B262 is (Symbol of D151) : (B262 in ( Terminals D151 ) & ( B262 `2 ) = C266) };
let C274 , C275 being (Function of ( FreeGen (C266 , C265) ) , ( C265 . C266 ));
assume that
L859: (for B263 being (Symbol of ( DTConMSA C265 )) holds (( root-tree B263 ) in ( FreeGen (C266 , C265) ) implies ( C274 . ( root-tree B263 ) ) = ( B263 `1 )))
and
L860: (for B264 being (Symbol of ( DTConMSA C265 )) holds (( root-tree B264 ) in ( FreeGen (C266 , C265) ) implies ( C275 . ( root-tree B264 ) ) = ( B264 `1 )));
L861: ( FreeGen (C266 , C265) ) = D152 by L673;
L862: (for B265 being set holds (B265 in D152 implies ( C274 . B265 ) = ( C275 . B265 )))
proof
let C276 being set;
assume L863: C276 in D152;
consider C277 being (Symbol of D151) such that L864: C276 = ( root-tree C277 ) and L865: C277 in ( Terminals D151 ) and L866: ( C277 `2 ) = C266 by L863;
L867: ( C274 . ( root-tree C277 ) ) = ( C277 `1 ) by L859 , L861 , L863 , L864;
thus L868: thesis by L867 , L860 , L861 , L863 , L864;
end;
L869: (( dom C274 ) = D152 & ( dom C275 ) = D152) by L861 , FUNCT_2:def 1;
thus L870: thesis by L869 , L862 , FUNCT_1:2;
end;
end;
definition
let C278 being non  void non  empty ManySortedSign;
let C279 being  non-empty (ManySortedSet of (the carrier of C278));
func Reverse C279 -> (ManySortedFunction of ( FreeGen C279 ) , C279) means 
:L872: (for B266 being (SortSymbol of C278) holds ( it . B266 ) = ( Reverse (B266 , C279) ));
existence
proof
defpred S12[ set , set ] means (for B267 being (SortSymbol of C278) holds (B267 = $1 implies $2 = ( Reverse (B267 , C279) )));
set D153 = (the carrier of C278);
set D154 = ( FreeGen C279 );
L873: (for B268 being set holds (B268 in D153 implies (ex B269 being set st S12[ B268 , B269 ])))
proof
let C280 being set;
assume L874: C280 in D153;
reconsider D155 = C280 as (SortSymbol of C278) by L874;
take ( Reverse (D155 , C279) );
let C281 being (SortSymbol of C278);
assume L875: C281 = C280;
thus L876: thesis by L875;
end;
consider C282 being Function such that L877: (( dom C282 ) = D153 & (for B270 being set holds (B270 in D153 implies S12[ B270 , ( C282 . B270 ) ]))) from CLASSES1:sch 1(L873);
reconsider D156 = C282 as (ManySortedSet of D153) by L877 , PARTFUN1:def 2 , RELAT_1:def 18;
L878: (for B271 being set holds (B271 in ( dom D156 ) implies ( D156 . B271 ) is Function))
proof
let C283 being set;
assume L879: C283 in ( dom D156 );
reconsider D157 = C283 as (SortSymbol of C278) by L879;
L880: ( D156 . D157 ) = ( Reverse (D157 , C279) ) by L877;
thus L881: thesis by L880;
end;
reconsider D158 = D156 as (ManySortedFunction of D153) by L878 , FUNCOP_1:def 6;
L882: (for B272 being set holds (B272 in D153 implies ( D158 . B272 ) is (Function of ( D154 . B272 ) , ( C279 . B272 ))))
proof
let C284 being set;
assume L883: C284 in D153;
reconsider D159 = C284 as (SortSymbol of C278) by L883;
L884: (( ( FreeGen C279 ) . D159 ) = ( FreeGen (D159 , C279) ) & ( D158 . C284 ) = ( Reverse (D159 , C279) )) by L877 , L689;
thus L885: thesis by L884;
end;
reconsider D160 = D158 as (ManySortedFunction of D154 , C279) by L882 , PBOOLE:def 15;
take D160;
let C285 being (SortSymbol of C278);
thus L886: thesis by L877;
end;
uniqueness
proof
let C286 , C287 being (ManySortedFunction of ( FreeGen C279 ) , C279);
assume that
L887: (for B273 being (SortSymbol of C278) holds ( C286 . B273 ) = ( Reverse (B273 , C279) ))
and
L888: (for B274 being (SortSymbol of C278) holds ( C287 . B274 ) = ( Reverse (B274 , C279) ));
L889: (for B275 being set holds (B275 in (the carrier of C278) implies ( C286 . B275 ) = ( C287 . B275 )))
proof
let C288 being set;
assume L890: C288 in (the carrier of C278);
reconsider D161 = C288 as (SortSymbol of C278) by L890;
L891: ( C286 . D161 ) = ( Reverse (D161 , C279) ) by L887;
thus L892: thesis by L891 , L888;
end;
thus L893: thesis by L889 , PBOOLE:3;
end;
end;
definition
let C289 being non  void non  empty ManySortedSign;
let C290 being  non-empty (ManySortedSet of (the carrier of C289));
let C291 being  non-empty (ManySortedSet of (the carrier of C289));
let C292 being (ManySortedFunction of ( FreeGen C290 ) , C291);
let C293 being (Symbol of ( DTConMSA C290 ));
assume L895: C293 in ( Terminals ( DTConMSA C290 ) );
func pi (C292 , C291 , C293) -> (Element of ( Union C291 )) means 
:L896: (for B276 being Function holds (B276 = ( C292 . ( C293 `2 ) ) implies it = ( B276 . ( root-tree C293 ) )));
existence
proof
set D162 = ( FreeGen C290 );
set D163 = ( DTConMSA C290 );
consider C294 being (SortSymbol of C289), C295 being set such that L897: C295 in ( C290 . C294 ) and L898: C293 = [ C295 , C294 ] by L895 , L340;
L899: ( D162 . C294 ) = ( FreeGen (C294 , C290) ) by L689;
L900: ( dom ( C292 . C294 ) ) = ( FreeGen (C294 , C290) ) by L899 , FUNCT_2:def 1
.= { ( root-tree B277 ) where B277 is (Symbol of D163) : (B277 in ( Terminals D163 ) & ( B277 `2 ) = C294) } by L673;
L901: ( C293 `2 ) = C294 by L898 , MCART_1:7;
L902: ( root-tree C293 ) in ( dom ( C292 . C294 ) ) by L901 , L895 , L900;
L903: ( ( C292 . C294 ) . ( root-tree C293 ) ) in ( rng ( C292 . C294 ) ) by L902 , FUNCT_1:def 3;
L904: ( dom C291 ) = (the carrier of C289) by PARTFUN1:def 2;
L905: (( rng ( C292 . C294 ) ) c= ( C291 . C294 ) & ( C291 . C294 ) in ( rng C291 )) by L904 , FUNCT_1:def 3 , RELAT_1:def 19;
L906: ( ( C292 . C294 ) . ( root-tree C293 ) ) in ( union ( rng C291 ) ) by L905 , L903 , TARSKI:def 4;
reconsider D164 = ( ( C292 . C294 ) . ( root-tree C293 ) ) as (Element of ( Union C291 )) by L906 , CARD_3:def 4;
take D164;
let C296 being Function;
assume L907: C296 = ( C292 . ( C293 `2 ) );
thus L908: thesis by L907 , L898 , MCART_1:7;
end;
uniqueness
proof
consider C297 being (SortSymbol of C289), C298 being set such that L909: C298 in ( C290 . C297 ) and L910: C293 = [ C298 , C297 ] by L895 , L340;
reconsider D165 = ( C292 . C297 ) as Function;
let C299 , C300 being (Element of ( Union C291 ));
assume that
L911: (for B278 being Function holds (B278 = ( C292 . ( C293 `2 ) ) implies C299 = ( B278 . ( root-tree C293 ) )))
and
L912: (for B279 being Function holds (B279 = ( C292 . ( C293 `2 ) ) implies C300 = ( B279 . ( root-tree C293 ) )));
L913: D165 = ( C292 . ( C293 `2 ) ) by L910 , MCART_1:7;
L914: C299 = ( D165 . ( root-tree C293 ) ) by L913 , L911;
thus L915: thesis by L914 , L912 , L913;
end;
end;
definition
let C301 being non  void non  empty ManySortedSign;
let C302 being  non-empty (ManySortedSet of (the carrier of C301));
let C303 being (Symbol of ( DTConMSA C302 ));
assume L917: (ex B280 being FinSequence st C303 ==> B280);
func @ (C302 , C303) -> (OperSymbol of C301) means 
:L918: [ it , (the carrier of C301) ] = C303;
existence
proof
set D166 = ( DTConMSA C302 );
set D167 = ( [: (the carrier' of C301) , { (the carrier of C301) } :] \/ ( Union ( coprod (C302 qua (ManySortedSet of (the carrier of C301))) ) ) );
reconsider D168 = C303 as (Element of D167);
consider C304 being FinSequence such that L919: C303 ==> C304 by L917;
L920: [ C303 , C304 ] in (the Rules of D166) by L919 , LANG1:def 1;
reconsider D169 = C304 as (Element of ( D167 * )) by L920 , ZFMISC_1:87;
L921: [ D168 , D169 ] in ( REL C302 ) by L919 , LANG1:def 1;
L922: D168 in [: (the carrier' of C301) , { (the carrier of C301) } :] by L921 , L164;
consider C305 being (OperSymbol of C301), C306 being (Element of { (the carrier of C301) }) such that L923: D168 = [ C305 , C306 ] by L922 , DOMAIN_1:1;
take C305;
thus L924: thesis by L923 , TARSKI:def 1;
end;
uniqueness by XTUPLE_0:1;
end;
definition
let C307 being non  void non  empty ManySortedSign;
let C308 being  non-empty MSAlgebra over C307;
let C309 being (OperSymbol of C307);
let C310 being FinSequence;
assume L926: C310 in ( Args (C309 , C308) );
func pi (C309 , C308 , C310) -> (Element of ( Union (the Sorts of C308) )) equals 
:L927: ( ( Den (C309 , C308) ) . C310 );
coherence
proof
set D170 = ( Den (C309 , C308) );
set D171 = (the Sorts of C308);
L928: ( dom D170 ) = ( Args (C309 , C308) ) by FUNCT_2:def 1;
L929: (( rng D170 ) c= ( Result (C309 , C308) ) & ( D170 . C310 ) in ( rng D170 )) by L928 , L926 , FUNCT_1:def 3 , RELAT_1:def 19;
L930: ( D170 . C310 ) in ( union ( rng D171 ) ) by L929 , TARSKI:def 4;
thus L931: thesis by L930 , CARD_3:def 4;
end;
end;
theorem
L933: (for B281 being non  void non  empty ManySortedSign holds (for B282 being  non-empty (ManySortedSet of (the carrier of B281)) holds ( FreeGen B282 ) is  free))
proof
let C311 being non  void non  empty ManySortedSign;
let C312 being  non-empty (ManySortedSet of (the carrier of C311));
set D172 = ( DTConMSA C312 );
set D173 = ( FreeMSA C312 );
set D174 = ( FreeGen C312 );
let C313 being  non-empty MSAlgebra over C311;
let C314 being (ManySortedFunction of D174 , (the Sorts of C313));
set D175 = (the Sorts of D173);
set D176 = (the Arity of C311);
set D177 = (the Sorts of C313);
set D178 = (the carrier' of C311);
set D179 = (the ResultSort of C311);
set D180 = ( Union (the Sorts of C313) );
deffunc H4((Symbol of D172)) = ( pi (C314 , (the Sorts of C313) , $1) );
deffunc H5((Symbol of D172) , FinSequence , FinSequence) = ( pi (( @ (C312 , $1) ) , C313 , $3) );
consider C315 being (Function of ( TS D172 ) , D180) such that L934: (for B283 being (Symbol of D172) holds (B283 in ( Terminals D172 ) implies ( C315 . ( root-tree B283 ) ) = H4(B283))) and L935: (for B284 being (Symbol of D172) holds (for B285 being (FinSequence of ( TS D172 )) holds (B284 ==> ( roots B285 ) implies ( C315 . ( B284 -tree B285 ) ) = H5(B284 , ( roots B285 ) , ( C315 * B285 ))))) from DTCONSTR:sch 8;
deffunc H6(set) = ( C315 | ( (the Sorts of D173) . $1 ) );
consider C316 being Function such that L936: (( dom C316 ) = (the carrier of C311) & (for B286 being set holds (B286 in (the carrier of C311) implies ( C316 . B286 ) = H6(B286)))) from FUNCT_1:sch 3;
reconsider D181 = C316 as (ManySortedSet of (the carrier of C311)) by L936 , PARTFUN1:def 2 , RELAT_1:def 18;
L937: (for B287 being set holds (B287 in ( dom D181 ) implies ( D181 . B287 ) is Function))
proof
let C317 being set;
assume L938: C317 in ( dom D181 );
L939: ( D181 . C317 ) = ( C315 | ( (the Sorts of D173) . C317 ) ) by L938 , L936;
thus L940: thesis by L939;
end;
reconsider D182 = D181 as (ManySortedFunction of (the carrier of C311)) by L937 , FUNCOP_1:def 6;
defpred S13[ set ] means (for B288 being (SortSymbol of C311) holds ($1 in ( (the Sorts of D173) . B288 ) implies ( ( D182 . B288 ) . $1 ) in ( (the Sorts of C313) . B288 )));
L941: (for B289 being (Symbol of D172) holds (for B290 being (FinSequence of ( TS D172 )) holds ((B289 ==> ( roots B290 ) & (for B291 being (DecoratedTree of (the carrier of D172)) holds (B291 in ( rng B290 ) implies S13[ B291 ]))) implies S13[ ( B289 -tree B290 ) ])))
proof
let C318 being (Symbol of D172);
let C319 being (FinSequence of ( TS D172 ));
assume that
L942: C318 ==> ( roots C319 )
and
L943: (for B292 being (DecoratedTree of (the carrier of D172)) holds (B292 in ( rng C319 ) implies S13[ B292 ]));
set D183 = ( C315 * C319 );
set D184 = ( @ (C312 , C318) );
set D185 = ( the_arity_of D184 );
set D186 = ( the_result_sort_of D184 );
set D187 = ( [: (the carrier' of C311) , { (the carrier of C311) } :] \/ ( Union ( coprod (C312 qua (ManySortedSet of (the carrier of C311))) ) ) );
set D188 = ( roots C319 );
L944: [ D184 , (the carrier of C311) ] = C318 by L942 , L918;
L945: [ [ D184 , (the carrier of C311) ] , D188 ] in (the Rules of D172) by L944 , L942 , LANG1:def 1;
L946: [ D184 , (the carrier of C311) ] = ( Sym (D184 , C312) );
L947: ( ( DenOp (D184 , C312) ) . C319 ) = ( C318 -tree C319 ) by L946 , L942 , L944 , L590;
L948: ( dom ( DenOp (D184 , C312) ) ) = ( ( ( ( FreeSort C312 ) # ) * D176 ) . D184 ) by FUNCT_2:def 1;
L949: C319 in ( dom ( DenOp (D184 , C312) ) ) by L948 , L942 , L944 , L946 , L441;
L950: (( rng ( DenOp (D184 , C312) ) ) c= ( ( ( FreeSort C312 ) * D179 ) . D184 ) & ( C318 -tree C319 ) in ( rng ( DenOp (D184 , C312) ) )) by L949 , L947 , FUNCT_1:def 3 , RELAT_1:def 19;
L951: ( C318 -tree C319 ) in ( ( D175 * D179 ) . D184 ) by L950;
set D189 = ( pi (D184 , C313 , D183) );
L952: ( rng D179 ) c= (the carrier of C311) by RELAT_1:def 19;
L953: ( rng D185 ) c= (the carrier of C311) by FINSEQ_1:def 4;
reconsider D190 = D188 as (Element of ( D187 * )) by L945 , ZFMISC_1:87;
L954: ( len D190 ) = ( len D185 ) by L945 , L185;
L955: ( dom D190 ) = ( Seg ( len D190 ) ) by FINSEQ_1:def 3;
L956: ( dom D175 ) = (the carrier of C311) by PARTFUN1:def 2;
L957: ( dom ( D175 * D185 ) ) = ( dom D185 ) by L956 , L953 , RELAT_1:27;
L958: D185 = ( D176 . D184 ) by MSUALG_1:def 1;
L959: ( dom D177 ) = (the carrier of C311) by PARTFUN1:def 2;
L960: ( dom ( D177 * D185 ) ) = ( dom D185 ) by L959 , L953 , RELAT_1:27;
L961: (( dom D190 ) = ( dom C319 ) & ( Seg ( len D185 ) ) = ( dom D185 )) by FINSEQ_1:def 3 , TREES_3:def 18;
L962: ( dom D183 ) = ( dom C319 ) by FINSEQ_3:120;
L963: ( dom D183 ) = ( dom ( D177 * D185 ) ) by L962 , L960 , L945 , L955 , L961 , L185;
L964: (for R7 being set holds (R7 in ( dom ( D177 * D185 ) ) implies ( D183 . R7 ) in ( ( D177 * D185 ) . R7 )))
proof
let R7 being set;
assume L965: R7 in ( dom ( D177 * D185 ) );
reconsider D191 = R7 as Nat by L965;
L966: ( C319 . D191 ) in ( rng C319 ) by L960 , L954 , L955 , L961 , L965 , FUNCT_1:def 3;
L967: ( rng C319 ) c= ( TS D172 ) by FINSEQ_1:def 4;
reconsider D192 = ( C319 . D191 ) as (Element of ( TS D172 )) by L967 , L966;
L968: ( D183 . D191 ) = ( C315 . ( C319 . D191 ) ) by L963 , L965 , FINSEQ_3:120;
L969: ( D185 . R7 ) in ( rng D185 ) by L960 , L965 , FUNCT_1:def 3;
reconsider D193 = ( D185 . R7 ) as (SortSymbol of C311) by L969 , L953;
L970: ( D182 . D193 ) = ( C315 | ( D175 . D193 ) ) by L936;
L971: ( dom D175 ) = (the carrier of C311) by PARTFUN1:def 2;
L972: ( D175 . D193 ) in ( rng D175 ) by L971 , FUNCT_1:def 3;
L973: ( dom C315 ) = ( TS D172 ) by FUNCT_2:def 1
.= ( union ( rng D175 ) ) by L507;
L974: ( dom ( D182 . D193 ) ) = ( D175 . D193 ) by L973 , L970 , L972 , RELAT_1:62 , ZFMISC_1:74;
L975: C319 in ( ( ( ( FreeSort C312 ) # ) * D176 ) . D184 ) by L942 , L944 , L946 , L441;
L976: C319 in ( product ( ( FreeSort C312 ) * D185 ) ) by L975 , L958 , L1;
L977: ( C319 . R7 ) in ( ( ( FreeSort C312 ) * D185 ) . R7 ) by L976 , L960 , L957 , L965 , CARD_3:9;
L978: ( C319 . R7 ) in ( ( FreeSort C312 ) . ( D185 . R7 ) ) by L977 , L960 , L957 , L965 , FUNCT_1:12;
L979: ( ( D182 . D193 ) . D192 ) in ( D177 . D193 ) by L978 , L943 , L966;
L980: ( C315 . D192 ) in ( D177 . D193 ) by L979 , L978 , L970 , L974 , FUNCT_1:47;
thus L981: thesis by L980 , L965 , L968 , FUNCT_1:12;
end;
L982: ( dom D177 ) = (the carrier of C311) by PARTFUN1:def 2;
L983: ( dom ( D177 * D179 ) ) = ( dom D179 ) by L982 , L952 , RELAT_1:27;
let C320 being (SortSymbol of C311);
L984: ( dom ( Den (D184 , C313) ) ) = ( Args (D184 , C313) ) by FUNCT_2:def 1;
L985: ( dom D179 ) = D178 by FUNCT_2:def 1;
L986: ( dom D175 ) = (the carrier of C311) by PARTFUN1:def 2;
L987: ( dom ( D175 * D179 ) ) = ( dom D179 ) by L986 , L952 , RELAT_1:27;
L988: ( C318 -tree C319 ) in ( D175 . ( D179 . D184 ) ) by L987 , L985 , L951 , FUNCT_1:12;
L989: ( C318 -tree C319 ) in ( D175 . D186 ) by L988 , MSUALG_1:def 2;
L990: ( Args (D184 , C313) ) = ( ( ( D177 # ) * D176 ) . D184 ) by MSUALG_1:def 4
.= ( product ( D177 * D185 ) ) by L958 , L1;
L991: D183 in ( Args (D184 , C313) ) by L990 , L962 , L960 , L954 , L955 , L961 , L964 , CARD_3:9;
L992: ( pi (D184 , C313 , D183) ) = ( ( Den (D184 , C313) ) . D183 ) by L991 , L927;
L993: (( rng ( Den (D184 , C313) ) ) c= ( Result (D184 , C313) ) & D189 in ( rng ( Den (D184 , C313) ) )) by L992 , L991 , L984 , FUNCT_1:def 3 , RELAT_1:def 19;
L994: D189 in ( Result (D184 , C313) ) by L993;
assume L995: ( C318 -tree C319 ) in ( D175 . C320 );
L996:
now
assume L997: D186 <> C320;
L998: ( ( FreeSort C312 ) . D186 ) meets ( ( FreeSort C312 ) . C320 ) by L989 , L995 , XBOOLE_0:3;
thus L999: contradiction by L998 , L997 , L544;
end;
L1000: ( C315 . ( C318 -tree C319 ) ) = D189 by L935 , L942;
L1001: D189 = ( ( C315 | ( D175 . D186 ) ) . ( C318 -tree C319 ) ) by L1000 , L989 , FUNCT_1:49;
L1002: ( Result (D184 , C313) ) = ( ( D177 * D179 ) . D184 ) by MSUALG_1:def 5
.= ( D177 . ( D179 . D184 ) ) by L983 , L985 , FUNCT_1:12
.= ( D177 . D186 ) by MSUALG_1:def 2;
thus L1003: thesis by L1002 , L936 , L994 , L1001 , L996;
end;
L1004: (for B293 being (Symbol of D172) holds (B293 in ( Terminals D172 ) implies S13[ ( root-tree B293 ) ]))
proof
let C321 being (Symbol of D172);
assume L1005: C321 in ( Terminals D172 );
consider C322 being (SortSymbol of C311), C323 being set such that L1006: C323 in ( C312 . C322 ) and L1007: C321 = [ C323 , C322 ] by L1005 , L340;
set D194 = { ( root-tree B294 ) where B294 is (Symbol of D172) : (B294 in ( Terminals D172 ) & ( B294 `2 ) = C322) };
set D195 = ( root-tree C321 );
L1008: ( C321 `2 ) = C322 by L1007 , MCART_1:7;
L1009: D195 in D194 by L1008 , L1005;
let C324 being (SortSymbol of C311);
reconsider D196 = ( C314 . C322 ) as (Function of ( D174 . C322 ) , ( D177 . C322 ));
L1010: ( dom D196 ) = ( D174 . C322 ) by FUNCT_2:def 1;
L1011: D194 = ( FreeGen (C322 , C312) ) by L673;
L1012: ( D174 . C322 ) = D194 by L1011 , L689;
L1013: (( rng D196 ) c= ( D177 . C322 ) & ( D196 . D195 ) in ( rng D196 )) by L1012 , L1009 , L1010 , FUNCT_1:def 3 , RELAT_1:def 19;
assume L1014: D195 in ( D175 . C324 );
L1015:
now
L1016: D195 in ( ( ( FreeSort C312 ) . C322 ) /\ ( ( FreeSort C312 ) . C324 ) ) by L1009 , L1011 , L1014 , XBOOLE_0:def 4;
L1017: ( ( FreeSort C312 ) . C322 ) meets ( ( FreeSort C312 ) . C324 ) by L1016 , XBOOLE_0:4;
assume L1018: C322 <> C324;
thus L1019: contradiction by L1018 , L1017 , L544;
end;
L1020: ( D182 . C322 ) = ( C315 | ( D175 . C322 ) ) by L936;
L1021: ( ( D182 . C322 ) . D195 ) = ( C315 . D195 ) by L1020 , L1009 , L1011 , FUNCT_1:49
.= ( pi (C314 , D177 , C321) ) by L934 , L1005
.= ( D196 . D195 ) by L1005 , L1008 , L896;
thus L1022: thesis by L1021 , L1013 , L1015;
end;
L1023: (for B295 being (DecoratedTree of (the carrier of D172)) holds (B295 in ( TS D172 ) implies S13[ B295 ])) from DTCONSTR:sch 7(L1004 , L941);
L1024: (for B296 being set holds (B296 in (the carrier of C311) implies ( D182 . B296 ) is (Function of ( (the Sorts of D173) . B296 ) , ( (the Sorts of C313) . B296 ))))
proof
let C325 being set;
assume L1025: C325 in (the carrier of C311);
reconsider D197 = C325 as (SortSymbol of C311) by L1025;
L1026: ( dom C315 ) = ( TS D172 ) by FUNCT_2:def 1
.= ( union ( rng D175 ) ) by L507;
L1027: ( dom D175 ) = (the carrier of C311) by PARTFUN1:def 2;
L1028: ( D175 . D197 ) in ( rng D175 ) by L1027 , FUNCT_1:def 3;
L1029: ( D182 . D197 ) = ( C315 | ( D175 . D197 ) ) by L936;
L1030: ( dom ( D182 . D197 ) ) = ( D175 . D197 ) by L1029 , L1026 , L1028 , RELAT_1:62 , ZFMISC_1:74;
L1031: ( D175 . D197 ) c= ( dom C315 ) by L1026 , L1028 , ZFMISC_1:74;
L1032: ( rng ( D182 . D197 ) ) c= ( D177 . D197 )
proof
let C326 being set;
assume L1033: C326 in ( rng ( D182 . D197 ) );
consider C327 being set such that L1034: C327 in ( dom ( D182 . D197 ) ) and L1035: ( ( D182 . D197 ) . C327 ) = C326 by L1033 , FUNCT_1:def 3;
reconsider D198 = C327 as (Element of ( TS D172 )) by L1031 , L1030 , L1034 , FUNCT_2:def 1;
L1036: D198 in ( D175 . D197 ) by L1029 , L1026 , L1028 , L1034 , RELAT_1:62 , ZFMISC_1:74;
thus L1037: thesis by L1036 , L1023 , L1035;
end;
thus L1038: thesis by L1032 , L1030 , FUNCT_2:def 1 , RELSET_1:4;
end;
reconsider D199 = D182 as (ManySortedFunction of D173 , C313) by L1024 , PBOOLE:def 15;
take D199;
thus L1039: D199 is_homomorphism D173 , C313
proof
L1040: (( rng D179 ) c= (the carrier of C311) & ( dom D175 ) = (the carrier of C311)) by PARTFUN1:def 2 , RELAT_1:def 19;
L1041: (( dom D179 ) = D178 & ( dom ( D175 * D179 ) ) = ( dom D179 )) by L1040 , FUNCT_2:def 1 , RELAT_1:27;
let C328 being (OperSymbol of C311);
assume that
L1042: ( Args (C328 , D173) ) <> ( {} );
let C329 being (Element of ( Args (C328 , D173) ));
set D200 = ( the_result_sort_of C328 );
set D201 = ( Den (C328 , D173) );
set D202 = ( Den (C328 , C313) );
set D203 = ( [: (the carrier' of C311) , { (the carrier of C311) } :] \/ ( Union ( coprod (C312 qua (ManySortedSet of (the carrier of C311))) ) ) );
set D204 = ( the_arity_of C328 );
L1043: D204 = ( D176 . C328 ) by MSUALG_1:def 1;
L1044: ( Args (C328 , D173) ) = ( ( ( ( FreeSort C312 ) # ) * D176 ) . C328 ) by MSUALG_1:def 4;
reconsider D205 = C329 as (FinSequence of ( TS D172 )) by L1044 , L398;
L1045: ( Sym (C328 , C312) ) ==> ( roots D205 ) by L1044 , L441;
L1046: ( @ (C312 , ( Sym (C328 , C312) )) ) = C328 by L1045 , L918;
L1047: ( dom ( C315 * D205 ) ) = ( dom D205 ) by FINSEQ_3:120;
L1048: C329 in ( ( ( ( FreeSort C312 ) # ) * D176 ) . C328 ) by L1044;
L1049: (for B297 being set holds (B297 in ( dom D205 ) implies ( ( C315 * D205 ) . B297 ) = ( ( D199 # C329 ) . B297 )))
proof
L1050: (( rng D204 ) c= (the carrier of C311) & ( dom D175 ) = (the carrier of C311)) by FINSEQ_1:def 4 , PARTFUN1:def 2;
L1051: ( dom ( D175 * D204 ) ) = ( dom D204 ) by L1050 , RELAT_1:27;
set D206 = ( roots D205 );
let C330 being set;
assume L1052: C330 in ( dom D205 );
reconsider D207 = C330 as Nat by L1052;
L1053: [ [ C328 , (the carrier of C311) ] , D206 ] in (the Rules of D172) by L1045 , LANG1:def 1;
reconsider D208 = D206 as (Element of ( D203 * )) by L1053 , ZFMISC_1:87;
L1054: ( len D208 ) = ( len D204 ) by L1053 , L185;
L1055: (( ( C315 * D205 ) . D207 ) = ( C315 . ( C329 . D207 ) ) & ( ( D199 # C329 ) . D207 ) = ( ( D199 . ( D204 /. D207 ) ) . ( C329 . D207 ) )) by L1047 , L1052 , FINSEQ_3:120 , MSUALG_3:def 6;
L1056: ( D199 . ( D204 /. D207 ) ) = ( C315 | ( D175 . ( D204 /. D207 ) ) ) by L936;
L1057: ( Seg ( len D208 ) ) = ( dom D208 ) by FINSEQ_1:def 3;
L1058: (( dom D208 ) = ( dom D205 ) & ( Seg ( len D204 ) ) = ( dom D204 )) by FINSEQ_1:def 3 , TREES_3:def 18;
L1059: D205 in ( product ( ( FreeSort C312 ) * D204 ) ) by L1048 , L1043 , L1;
L1060: ( D205 . D207 ) in ( ( ( FreeSort C312 ) * D204 ) . D207 ) by L1059 , L1052 , L1051 , L1054 , L1057 , L1058 , CARD_3:9;
L1061: ( ( ( FreeSort C312 ) * D204 ) . D207 ) = ( D175 . ( D204 . D207 ) ) by L1052 , L1051 , L1054 , L1057 , L1058 , FUNCT_1:12
.= ( D175 . ( D204 /. D207 ) ) by L1052 , L1054 , L1057 , L1058 , PARTFUN1:def 6;
thus L1062: thesis by L1061 , L1055 , L1056 , L1060 , FUNCT_1:49;
end;
L1063: ( dom ( D199 # C329 ) ) = ( dom D204 ) by MSUALG_3:6;
L1064: ( C315 * D205 ) = ( D199 # C329 ) by L1063 , L1047 , L1049 , FUNCT_1:2 , MSUALG_3:6;
L1065: ( D199 . D200 ) = ( C315 | ( D175 . D200 ) ) by L936;
L1066: ( dom ( DenOp (C328 , C312) ) ) = ( ( ( ( FreeSort C312 ) # ) * D176 ) . C328 ) by FUNCT_2:def 1;
L1067: ( ( DenOp (C328 , C312) ) . D205 ) = ( ( Sym (C328 , C312) ) -tree D205 ) by L1045 , L590;
L1068: (( rng ( DenOp (C328 , C312) ) ) c= ( ( ( FreeSort C312 ) * D179 ) . C328 ) & ( ( Sym (C328 , C312) ) -tree D205 ) in ( rng ( DenOp (C328 , C312) ) )) by L1067 , L1044 , L1066 , FUNCT_1:def 3 , RELAT_1:def 19;
L1069: ( ( Sym (C328 , C312) ) -tree D205 ) in ( ( D175 * D179 ) . C328 ) by L1068;
L1070: ( ( Sym (C328 , C312) ) -tree D205 ) in ( D175 . ( D179 . C328 ) ) by L1069 , L1041 , FUNCT_1:12;
L1071: ( ( Sym (C328 , C312) ) -tree D205 ) in ( D175 . D200 ) by L1070 , MSUALG_1:def 2;
L1072: ( dom D175 ) = (the carrier of C311) by PARTFUN1:def 2;
L1073: ( D175 . D200 ) in ( rng D175 ) by L1072 , FUNCT_1:def 3;
L1074: ( dom C315 ) = ( TS D172 ) by FUNCT_2:def 1
.= ( union ( rng D175 ) ) by L507;
L1075: ( dom ( D199 . D200 ) ) = ( D175 . D200 ) by L1074 , L1065 , L1073 , RELAT_1:62 , ZFMISC_1:74;
L1076: D201 = ( ( FreeOper C312 ) . C328 ) by MSUALG_1:def 6
.= ( DenOp (C328 , C312) ) by L614;
L1077: ( D201 . C329 ) = ( ( Sym (C328 , C312) ) -tree D205 ) by L1076 , L1045 , L590;
thus L1078: ( ( D199 . D200 ) . ( D201 . C329 ) ) = ( C315 . ( ( Sym (C328 , C312) ) -tree D205 ) ) by L1077 , L1071 , L1065 , L1075 , FUNCT_1:47
.= ( pi (( @ (C312 , ( Sym (C328 , C312) )) ) , C313 , ( C315 * D205 )) ) by L935 , L1045
.= ( D202 . ( D199 # C329 ) ) by L1046 , L1064 , L927;
end;

L1079: (for R7 being set holds (R7 in (the carrier of C311) implies ( ( D199 || D174 ) . R7 ) = ( C314 . R7 )))
proof
set D209 = ( D199 || D174 );
let R7 being set;
assume L1080: R7 in (the carrier of C311);
reconsider D210 = R7 as (SortSymbol of C311) by L1080;
L1081: ( dom ( D199 . D210 ) ) = ( D175 . D210 ) by FUNCT_2:def 1;
L1082: ( dom ( D209 . D210 ) ) = ( D174 . D210 ) by FUNCT_2:def 1;
L1083: ( D174 . D210 ) = ( FreeGen (D210 , C312) ) by L689;
L1084: ( D209 . D210 ) = ( ( D199 . D210 ) | ( D174 . D210 ) ) by L6;
L1085: (for B298 being set holds (B298 in ( D174 . D210 ) implies ( ( D209 . D210 ) . B298 ) = ( ( C314 . D210 ) . B298 )))
proof
let C331 being set;
L1086: ( D199 . D210 ) = ( C315 | ( D175 . D210 ) ) by L936;
assume L1087: C331 in ( D174 . D210 );
L1088: C331 in { ( root-tree B299 ) where B299 is (Symbol of D172) : (B299 in ( Terminals D172 ) & ( B299 `2 ) = D210) } by L1087 , L1083 , L673;
consider C332 being (Symbol of D172) such that L1089: (C331 = ( root-tree C332 ) & C332 in ( Terminals D172 )) and L1090: ( C332 `2 ) = D210 by L1088;
thus L1091: ( ( D209 . D210 ) . C331 ) = ( ( D199 . D210 ) . C331 ) by L1084 , L1082 , L1087 , FUNCT_1:47
.= ( C315 . C331 ) by L1081 , L1083 , L1087 , L1086 , FUNCT_1:47
.= ( pi (C314 , D177 , C332) ) by L934 , L1089
.= ( ( C314 . D210 ) . C331 ) by L1089 , L1090 , L896;
end;
L1092: ( dom ( C314 . D210 ) ) = ( D174 . D210 ) by FUNCT_2:def 1;
thus L1093: thesis by L1092 , L1082 , L1085 , FUNCT_1:2;
end;
thus L1094: thesis by L1079 , PBOOLE:3;
end;
theorem
L1095: (for B300 being non  void non  empty ManySortedSign holds (for B301 being  non-empty (ManySortedSet of (the carrier of B300)) holds ( FreeMSA B301 ) is  free))
proof
let C333 being non  void non  empty ManySortedSign;
let C334 being  non-empty (ManySortedSet of (the carrier of C333));
take ( FreeGen C334 );
thus L1096: thesis by L933;
end;
registration
let C335 being non  void non  empty ManySortedSign;
cluster  free  strict for  non-empty  non-empty  non-empty  non-empty MSAlgebra over C335;
existence
proof
set D211 = the  non-empty MSAlgebra over C335;
set D212 = (the Sorts of D211);
take ( FreeMSA D212 );
thus L1097: thesis by L1095;
end;
end;
registration
let C336 being non  void non  empty ManySortedSign;
let C337 being  free MSAlgebra over C336;
cluster  free for (GeneratorSet of C337);
existence by L147;
end;
theorem
L1100: (for B302 being non  void non  empty ManySortedSign holds (for B303 being  non-empty MSAlgebra over B302 holds (ex B304 being  strict  free  non-empty MSAlgebra over B302 st (ex B305 being (ManySortedFunction of B304 , B303) st B305 is_epimorphism B304 , B303))))
proof
let C338 being non  void non  empty ManySortedSign;
let C339 being  non-empty MSAlgebra over C338;
set D213 = (the Sorts of C339);
set D214 = ( FreeMSA D213 );
set D215 = ( FreeGen D213 );
reconsider D216 = D214 as  strict  free  non-empty MSAlgebra over C338 by L1095;
set D217 = ( Reverse D213 );
take D216;
L1101: D215 is  free by L933;
consider C340 being (ManySortedFunction of D214 , C339) such that L1102: C340 is_homomorphism D214 , C339 and L1103: ( C340 || D215 ) = D217 by L1101 , L145;
reconsider D218 = C340 as (ManySortedFunction of D216 , C339);
take D218;
thus L1104: D218 is_homomorphism D216 , C339 by L1102;
thus L1105: D218 is  "onto"
proof
let C341 being set;
assume L1106: C341 in (the carrier of C338);
reconsider D219 = C341 as (SortSymbol of C338) by L1106;
reconsider D220 = ( D218 . C341 ) as (Function of ( (the Sorts of D216) . D219 ) , ( D213 . D219 )) by PBOOLE:def 15;
L1107: ( D217 . D219 ) = ( D220 | ( D215 . D219 ) ) by L1103 , L6;
L1108: ( rng ( D217 . D219 ) ) c= ( rng D220 ) by L1107 , RELAT_1:70;
thus L1109: ( rng ( D218 . C341 ) ) c= ( D213 . C341 ) by L1107 , RELAT_1:def 19;
let C342 being set;
set D221 = ( DTConMSA D213 );
set D222 = [ C342 , D219 ];
assume L1110: C342 in ( D213 . C341 );
L1111: D222 in ( Terminals D221 ) by L1110 , L340;
reconsider D223 = D222 as (Symbol of D221) by L1111;
L1112: ( D223 `2 ) = D219 by MCART_1:7;
L1113: ( root-tree D223 ) in { ( root-tree B306 ) where B306 is (Symbol of D221) : (B306 in ( Terminals D221 ) & ( B306 `2 ) = D219) } by L1112 , L1111;
L1114: ( root-tree D223 ) in ( FreeGen (D219 , D213) ) by L1113 , L673;
L1115: ( D217 . D219 ) = ( Reverse (D219 , D213) ) by L872;
L1116: ( dom ( D217 . D219 ) ) = ( FreeGen (D219 , D213) ) by L1115 , FUNCT_2:def 1;
L1117: ( ( D217 . D219 ) . ( root-tree D223 ) ) in ( rng ( D217 . D219 ) ) by L1116 , L1114 , FUNCT_1:def 3;
L1118: ( ( D217 . D219 ) . ( root-tree D223 ) ) = ( D223 `1 ) by L1115 , L1114 , L843
.= C342 by MCART_1:7;
thus L1119: thesis by L1118 , L1108 , L1117;
end;

end;
theorem
L1106: (for B307 being non  void non  empty ManySortedSign holds (for B308 being  strict  non-empty MSAlgebra over B307 holds (ex B309 being  strict  free  non-empty MSAlgebra over B307 st (ex B310 being (ManySortedFunction of B309 , B308) st (B310 is_epimorphism B309 , B308 & ( Image B310 ) = B308)))))
proof
let C343 being non  void non  empty ManySortedSign;
let C344 being  strict  non-empty MSAlgebra over C343;
consider C345 being  strict  free  non-empty MSAlgebra over C343, C346 being (ManySortedFunction of C345 , C344) such that L1107: C346 is_epimorphism C345 , C344 by L1100;
L1108: C346 is_homomorphism C345 , C344 by L1107 , MSUALG_3:def 8;
L1109: ( Image C346 ) = C344 by L1108 , L1107 , MSUALG_3:19;
thus L1110: thesis by L1109 , L1107;
end;
