:: Uniqueness of factoring an integer and multiplicative group $Z/pZ^{*}$
::  by Hiroyuki Okazaki and Yasunari Shidama
::
:: Received January 31, 2008
:: Copyright (c) 2008-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, FUNCOP_1, CARD_1, FUNCT_4, FUNCT_1, RELAT_1, PBOOLE,
      PRE_POLY, VALUED_0, XBOOLE_0, ARYTM_3, NEWTON, TARSKI, FINSET_1, NAT_3,
      CARD_3, UPROOTS, FINSEQ_1, SUBSET_1, ORDINAL4, ARYTM_1, XXREAL_0,
      FUNCT_2, CLASSES1, PARTFUN1, INT_2, NAT_1, POWER, RVSUM_1, BINOP_1,
      BINOP_2, REALSET1, ZFMISC_1, INT_3, SUPINF_2, FUNCT_7, ALGSTR_0, GROUP_1,
      MESFUNC1, INT_1, COMPLEX1, VECTSP_1, POLYNOM1, HURWITZ, POLYNOM5,
      POLYNOM3, POLYNOM2, AFINSQ_1, STRUCT_0, GROUP_4, GROUP_2, GRAPH_1, INT_7;
 notations TARSKI, XBOOLE_0, SUBSET_1, ZFMISC_1, ORDINAL1, FINSET_1, RVSUM_1,
      CARD_1, CLASSES1, DOMAIN_1, NUMBERS, XCMPLX_0, XXREAL_0, NAT_1, POWER,
      RELAT_1, FUNCT_1, RELSET_1, PARTFUN1, FUNCT_2, FUNCOP_1, FINSEQ_1,
      FUNCT_4, STRUCT_0, ALGSTR_0, VFUNCT_1, GROUP_1, VECTSP_1, BINOP_1,
      PBOOLE, GROUP_2, ALGSEQ_1, WSIERP_1, POLYNOM3, POLYNOM4, UPROOTS, NAT_3,
      POLYNOM5, GROUP_4, GR_CY_1, INT_1, FUNCT_7, NEWTON, INT_2, INT_3,
      HURWITZ, VALUED_0, REALSET1, RECDEF_1, PRE_POLY, POLYNOM2;
 constructors REAL_1, NAT_D, NAT_3, SEQ_1, EUCLID, REALSET1, GROUP_4, GR_CY_1,
      INT_3, WSIERP_1, POLYNOM2, POLYNOM4, POLYNOM5, WELLORD2, POWER, ALGSTR_1,
      HURWITZ, UPROOTS, FUNCT_4, RECDEF_1, BINOP_2, CLASSES1, RELSET_1, PBOOLE,
      FUNCT_7, VFUNCT_1;
 registrations XBOOLE_0, STRUCT_0, FUNCT_1, XREAL_0, ORDINAL1, NAT_1, INT_1,
      GROUP_1, GROUP_2, FINSET_1, FINSEQ_1, FUNCT_2, GR_CY_1, ALGSTR_0,
      MEMBERED, VECTSP_1, INT_3, XXREAL_0, NEWTON, SUBSET_1, RELAT_1, CARD_1,
      ALGSTR_1, NAT_3, VALUED_0, POLYNOM3, POLYNOM4, POLYNOM5, UPROOTS,
      RELSET_1, PRE_POLY, VFUNCT_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions STRUCT_0, GROUP_1, INT_3, CARD_1, ALGSTR_0, BINOP_1, FINSEQ_1,
      POLYNOM3, HURWITZ, REALSET1, TARSKI;
 theorems TARSKI, XBOOLE_0, ZFMISC_1, ORDINAL1, FUNCT_1, FUNCT_2, VECTSP_1,
      INT_1, RELAT_1, RLVECT_1, ABSVALUE, GR_CY_1, FUNCT_7, NAT_1, INT_2,
      INT_3, PEPIN, NAT_D, XCMPLX_1, NUMBERS, PYTHTRIP, WSIERP_1, CARD_1,
      GROUP_1, GROUP_2, STRUCT_0, WELLORD2, XREAL_1, NEWTON, XXREAL_0, GR_CY_2,
      POWER, VALUED_0, ALGSEQ_1, NAT_3, UPROOTS, RVSUM_1, FINSEQ_4, FINSEQ_5,
      POLYNOM3, POLYNOM4, POLYNOM5, CARD_2, EULER_1, EULER_2, XBOOLE_1,
      FINSEQ_1, HURWITZ, GROUP_8, REALSET1, RELSET_1, FUNCT_4, FUNCOP_1,
      CLASSES1, PARTFUN1, PRE_POLY, FINSEQ_2;
 schemes NAT_1, PRE_CIRC, FUNCT_2, RECDEF_1;

begin
L1: (for R1 being set holds (for R2 being set holds (for R3 being set holds (for B1 being set holds (B1 <> R1 implies ( ( ( R2 --> ( 0 ) ) +* (R1 , R3) ) . B1 ) = ( 0 ))))))
proof
let R1 being set;
let R2 being set;
let R3 being set;
let C1 being set;
assume L2: C1 <> R1;
L3: ( dom ( R2 --> ( 0 ) ) ) = R2 by FUNCOP_1:13;
per cases ;
suppose L4: C1 in R2;

L5: ( ( ( R2 --> ( 0 ) ) +* (R1 , R3) ) . C1 ) = ( ( R2 --> ( 0 ) ) . C1 ) by L2 , FUNCT_7:32
.= ( 0 ) by L4 , FUNCOP_1:7;
thus L6: thesis by L5;
end;
suppose L7: (not C1 in R2);

L8: ( ( ( R2 --> ( 0 ) ) +* (R1 , R3) ) . C1 ) = ( ( R2 --> ( 0 ) ) . C1 ) by L2 , FUNCT_7:32
.= ( 0 ) by L3 , L7 , FUNCT_1:def 2;
thus L9: thesis by L8;
end;
end;
theorem
L11: (for R1 being set holds (for R2 being set holds (for B2 being (ManySortedSet of R2) holds (( support B2 ) = { R1 } implies B2 = ( ( R2 --> ( 0 ) ) +* (R1 , ( B2 . R1 )) )))))
proof
let R1 being set;
let R2 being set;
let C2 being (ManySortedSet of R2);
assume L12: ( support C2 ) = { R1 };
L13: (for R3 being set holds (R3 in ( dom C2 ) implies ( C2 . R3 ) = ( ( ( R2 --> ( 0 ) ) +* (R1 , ( C2 . R1 )) ) . R3 )))
proof
let C3 being set;
assume L14: C3 in ( dom C2 );
L15: C3 in R2 by L14;
L16: C3 in ( dom ( R2 --> ( 0 ) ) ) by L15 , FUNCOP_1:13;
per cases ;
suppose L17: R1 = C3;

thus L18: thesis by L17 , L16 , FUNCT_7:31;
end;
suppose L19: R1 <> C3;

L20: (not C3 in ( support C2 )) by L19 , L12 , TARSKI:def 1;
L21: ( C2 . C3 ) = ( 0 ) by L20 , PRE_POLY:def 7;
thus L22: thesis by L21 , L19 , L1;
end;
end;
L24: ( dom ( ( R2 --> ( 0 ) ) +* (R1 , ( C2 . R1 )) ) ) = ( dom ( R2 --> ( 0 ) ) ) by FUNCT_7:30
.= R2 by FUNCOP_1:13;
L25: ( dom C2 ) = ( dom ( ( R2 --> ( 0 ) ) +* (R1 , ( C2 . R1 )) ) ) by L24 , PARTFUN1:def 2;
thus L26: thesis by L25 , L13 , FUNCT_1:2;
end;
theorem
L27: (for B3 being set holds (for B4 , B5 , B6 being  real-valued (ManySortedSet of B3) holds ((( ( support B4 ) /\ ( support B5 ) ) = ( {} ) & ( ( support B4 ) \/ ( support B5 ) ) = ( support B6 ) & ( B4 | ( support B4 ) ) = ( B6 | ( support B4 ) ) & ( B5 | ( support B5 ) ) = ( B6 | ( support B5 ) )) implies ( B4 + B5 ) = B6)))
proof
let C4 being set;
let C5 , C6 , C7 being  real-valued (ManySortedSet of C4);
assume that
L28: ( ( support C5 ) /\ ( support C6 ) ) = ( {} )
and
L29: ( ( support C5 ) \/ ( support C6 ) ) = ( support C7 )
and
L30: ( C5 | ( support C5 ) ) = ( C7 | ( support C5 ) )
and
L31: ( C6 | ( support C6 ) ) = ( C7 | ( support C6 ) );
L32: (for B7 being set holds (B7 in C4 implies ( C7 . B7 ) = ( ( C5 . B7 ) + ( C6 . B7 ) )))
proof
let C8 being set;
assume L33: C8 in C4;
per cases ;
suppose L34: C8 in ( ( support C5 ) \/ ( support C6 ) );

L35:
now
per cases  by L34 , XBOOLE_0:def 3;
suppose L36: C8 in ( support C5 );

L37: (not C8 in ( support C6 )) by L36 , L28 , XBOOLE_0:def 4;
thus L38: ( C7 . C8 ) = ( ( C7 | ( support C5 ) ) . C8 ) by L36 , FUNCT_1:49
.= ( ( C5 . C8 ) + ( 0 ) ) by L30 , L36 , FUNCT_1:49
.= ( ( C5 . C8 ) + ( C6 . C8 ) ) by L37 , PRE_POLY:def 7;
end;
suppose L39: C8 in ( support C6 );

L40: (not C8 in ( support C5 )) by L39 , L28 , XBOOLE_0:def 4;
thus L41: ( C7 . C8 ) = ( ( C7 | ( support C6 ) ) . C8 ) by L39 , FUNCT_1:49
.= ( ( 0 ) + ( C6 . C8 ) ) by L31 , L39 , FUNCT_1:49
.= ( ( C5 . C8 ) + ( C6 . C8 ) ) by L40 , PRE_POLY:def 7;
end;
end;
thus L43: thesis by L35;
end;
suppose L44: (not C8 in ( ( support C5 ) \/ ( support C6 ) ));

L45: (not C8 in ( support C6 )) by L44 , XBOOLE_0:def 3;
L46: (not C8 in ( support C5 )) by L44 , XBOOLE_0:def 3;
thus L47: ( C7 . C8 ) = ( 0 ) by L29 , L44 , PRE_POLY:def 7
.= ( ( 0 ) + ( C6 . C8 ) ) by L45 , PRE_POLY:def 7
.= ( ( C5 . C8 ) + ( C6 . C8 ) ) by L46 , PRE_POLY:def 7;
end;
end;
thus L49: C7 = ( C5 + C6 ) by L32 , PRE_POLY:33;
end;
theorem
L50: (for B8 being set holds (for B9 , B10 being (ManySortedSet of B8) holds (( B9 | ( support B9 ) ) = ( B10 | ( support B10 ) ) implies B9 = B10)))
proof
let C9 being set;
let C10 , C11 being (ManySortedSet of C9);
L51: ( dom ( C10 | ( support C10 ) ) ) = ( ( dom C10 ) /\ ( support C10 ) ) by RELAT_1:61
.= ( support C10 ) by PRE_POLY:37 , XBOOLE_1:28;
L52: ( dom ( C11 | ( support C11 ) ) ) = ( ( dom C11 ) /\ ( support C11 ) ) by RELAT_1:61
.= ( support C11 ) by PRE_POLY:37 , XBOOLE_1:28;
assume L53: ( C10 | ( support C10 ) ) = ( C11 | ( support C11 ) );
L54: (for B11 being set holds (B11 in C9 implies ( C10 . B11 ) = ( C11 . B11 )))
proof
let C12 being set;
assume L55: C12 in C9;
per cases ;
suppose L56: C12 in ( support C10 );

thus L57: ( C10 . C12 ) = ( ( C10 | ( support C10 ) ) . C12 ) by L56 , FUNCT_1:49
.= ( C11 . C12 ) by L53 , L51 , L52 , L56 , FUNCT_1:49;
end;
suppose L58: (not C12 in ( support C10 ));

thus L59: ( C10 . C12 ) = ( 0 ) by L58 , PRE_POLY:def 7
.= ( C11 . C12 ) by L53 , L51 , L52 , L58 , PRE_POLY:def 7;
end;
end;
L61: ( dom C11 ) = C9 by PARTFUN1:def 2;
L62: ( dom C10 ) = C9 by PARTFUN1:def 2;
thus L63: thesis by L62 , L54 , L61 , FUNCT_1:2;
end;
theorem
L64: (for B12 being set holds (for B13 , B14 being (bag of B12) holds ((( support B13 ) = ( {} ) & ( support B14 ) = ( {} )) implies B13 = B14)))
proof
let C13 being set;
let C14 , C15 being (bag of C13);
assume that
L65: ( support C14 ) = ( {} )
and
L66: ( support C15 ) = ( {} );
L67: ( {} ) = ( ( dom C15 ) /\ ( {} ) )
.= ( dom ( C15 | ( support C15 ) ) ) by L66;
L68: ( dom ( C14 | ( support C14 ) ) ) = ( ( dom C14 ) /\ ( support C14 ) ) by RELAT_1:61
.= ( {} ) by L65;
L69: (for B15 being set holds (B15 in ( dom ( C14 | ( support C14 ) ) ) implies ( ( C14 | ( support C14 ) ) . B15 ) = ( ( C15 | ( support C15 ) ) . B15 ))) by L68;
thus L70: thesis by L69 , L68 , L67 , L50 , FUNCT_1:2;
end;
L71: (for B16 , B17 being (bag of ( SetPrimes )) holds ((( support B16 ) c= ( support B17 ) & ( B16 | ( support B16 ) ) = ( B17 | ( support B16 ) )) implies (ex B18 being (bag of ( SetPrimes )) st (( support B18 ) = ( ( support B17 ) \ ( support B16 ) ) & ( support B16 ) misses ( support B18 ) & ( B18 | ( support B18 ) ) = ( B17 | ( support B18 ) ) & ( B16 + B18 ) = B17))))
proof
deffunc H1(set) = ( 0 );
let C16 , C17 being (bag of ( SetPrimes ));
assume that
L72: ( support C16 ) c= ( support C17 )
and
L73: ( C16 | ( support C16 ) ) = ( C17 | ( support C16 ) );
deffunc H2(set) = ( C17 . $1 );
defpred S1[ set ] means $1 in ( ( support C17 ) \ ( support C16 ) );
L74: (for B19 being set holds (B19 in ( SetPrimes ) implies ((S1[ B19 ] implies H2(B19) in ( NAT )) & ((not S1[ B19 ]) implies H1(B19) in ( NAT )))));
consider C18 being (Function of ( SetPrimes ) , ( NAT )) such that L75: (for B20 being set holds (B20 in ( SetPrimes ) implies ((S1[ B20 ] implies ( C18 . B20 ) = H2(B20)) & ((not S1[ B20 ]) implies ( C18 . B20 ) = H1(B20))))) from FUNCT_2:sch 5(L74);
L76: (for B21 being set holds (B21 in ( SetPrimes ) implies (B21 in ( ( support C17 ) \ ( support C16 ) ) implies ( C18 . B21 ) <> ( 0 ))))
proof
let C19 being set;
assume that
L77: C19 in ( SetPrimes )
and
L78: C19 in ( ( support C17 ) \ ( support C16 ) );
L79: C19 in ( support C17 ) by L78 , XBOOLE_0:def 5;
L80: ( C17 . C19 ) <> ( 0 ) by L79 , PRE_POLY:def 7;
thus L81: thesis by L80 , L75 , L78;
end;
L82: (for B22 being set holds ((not B22 in ( SetPrimes )) implies ( C18 . B22 ) = ( 0 )))
proof
let C20 being set;
assume L83: (not C20 in ( SetPrimes ));
L84: (not C20 in ( dom C18 )) by L83;
thus L85: thesis by L84 , FUNCT_1:def 2;
end;
L86: (for B23 being set holds (B23 in ( ( support C17 ) \ ( support C16 ) ) iff ( C18 . B23 ) <> ( 0 )))
proof
let C21 being set;
per cases ;
suppose L87: C21 in ( SetPrimes );

thus L88: thesis by L87 , L75 , L76;
end;
suppose L89: (not C21 in ( SetPrimes ));

thus L90: thesis by L89 , L82;
end;
end;
L92: ( support C18 ) is  finite by L86 , PRE_POLY:def 7;
reconsider D1 = C18 as (bag of ( SetPrimes )) by L92 , PRE_POLY:def 8;
L93: ( ( support C16 ) \/ ( support D1 ) ) = ( ( support C16 ) \/ ( ( support C17 ) \ ( support C16 ) ) ) by L86 , PRE_POLY:def 7
.= ( ( support C16 ) \/ ( support C17 ) ) by XBOOLE_1:39
.= ( support C17 ) by L72 , XBOOLE_1:12;
L94: ( dom ( C18 | ( support C18 ) ) ) = ( ( dom C18 ) /\ ( support C18 ) ) by RELAT_1:61
.= ( support C18 ) by PRE_POLY:37 , XBOOLE_1:28;
L95: ( support C18 ) = ( ( support C17 ) \ ( support C16 ) ) by L86 , PRE_POLY:def 7;
L96: (for B24 being set holds (B24 in ( dom ( C18 | ( support C18 ) ) ) implies ( ( C18 | ( support C18 ) ) . B24 ) = ( ( C17 | ( support C18 ) ) . B24 )))
proof
let C22 being set;
assume L97: C22 in ( dom ( C18 | ( support C18 ) ) );
L98: ( ( C17 | ( support C18 ) ) . C22 ) = ( C17 . C22 ) by L97 , L94 , FUNCT_1:49;
L99: ( ( C18 | ( support C18 ) ) . C22 ) = ( C18 . C22 ) by L94 , L97 , FUNCT_1:49;
thus L100: thesis by L99 , L75 , L95 , L94 , L97 , L98;
end;
L101: ( dom ( C17 | ( support C18 ) ) ) = ( ( dom C17 ) /\ ( support C18 ) ) by RELAT_1:61
.= ( ( dom C17 ) /\ ( ( support C17 ) \ ( support C16 ) ) ) by L86 , PRE_POLY:def 7
.= ( ( ( dom C17 ) /\ ( support C17 ) ) \ ( support C16 ) ) by XBOOLE_1:49
.= ( ( support C17 ) \ ( support C16 ) ) by PRE_POLY:37 , XBOOLE_1:28
.= ( support C18 ) by L86 , PRE_POLY:def 7;
L102: ( C18 | ( support C18 ) ) = ( C17 | ( support C18 ) ) by L101 , L94 , L96 , FUNCT_1:def 11;
L103: ( support C16 ) misses ( support C18 )
proof
assume L104: ( support C16 ) meets ( support C18 );
L105: (ex B25 being set st (B25 in ( support C16 ) & B25 in ( support C18 ))) by L104 , XBOOLE_0:3;
thus L106: contradiction by L105 , L95 , XBOOLE_0:def 5;
end;
L107: ( ( support C16 ) /\ ( support C18 ) ) = ( {} ) by L103 , XBOOLE_0:def 7;
L108: ( C16 + D1 ) = C17 by L107 , L73 , L102 , L93 , L27;
thus L109: thesis by L108 , L95 , L103 , L102;
end;
L110: (for B26 being (bag of ( SetPrimes )) holds (for B27 being set holds (B27 c= ( support B26 ) implies (ex B28 , B29 being (bag of ( SetPrimes )) st (( support B28 ) = ( ( support B26 ) \ B27 ) & ( support B29 ) = B27 & ( support B28 ) misses ( support B29 ) & ( B28 | ( support B28 ) ) = ( B26 | ( support B28 ) ) & ( B29 | ( support B29 ) ) = ( B26 | ( support B29 ) ) & ( B28 + B29 ) = B26)))))
proof
let C23 being (bag of ( SetPrimes ));
let C24 being set;
set D2 = ( C23 +* ( C24 --> ( 0 ) ) );
L111: ( rng D2 ) c= ( ( rng C23 ) \/ ( rng ( C24 --> ( 0 ) ) ) ) by FUNCT_4:17;
L112: ( rng ( C24 --> ( 0 ) ) ) c= ( NAT ) by RELAT_1:def 19;
L113: ( rng C23 ) c= ( NAT ) by VALUED_0:def 6;
L114: ( ( rng C23 ) \/ ( rng ( C24 --> ( 0 ) ) ) ) c= ( NAT ) by L113 , L112 , XBOOLE_1:8;
L115: ( rng D2 ) c= ( NAT ) by L114 , L111 , XBOOLE_1:1;
set D3 = ( C23 +* ( ( ( SetPrimes ) \ C24 ) --> ( 0 ) ) );
L116: ( dom D3 ) = ( ( dom C23 ) \/ ( dom ( ( ( SetPrimes ) \ C24 ) --> ( 0 ) ) ) ) by FUNCT_4:def 1
.= ( ( dom C23 ) \/ ( ( SetPrimes ) \ C24 ) ) by FUNCOP_1:13
.= ( ( SetPrimes ) \/ ( ( SetPrimes ) \ C24 ) ) by PARTFUN1:def 2
.= ( SetPrimes ) by XBOOLE_1:12 , XBOOLE_1:36;
L117: ( rng D3 ) c= ( ( rng C23 ) \/ ( rng ( ( ( SetPrimes ) \ C24 ) --> ( 0 ) ) ) ) by FUNCT_4:17;
L118: ( rng ( ( ( SetPrimes ) \ C24 ) --> ( 0 ) ) ) c= ( NAT ) by RELAT_1:def 19;
L119: ( ( rng C23 ) \/ ( rng ( ( ( SetPrimes ) \ C24 ) --> ( 0 ) ) ) ) c= ( NAT ) by L118 , L113 , XBOOLE_1:8;
L120: ( rng D3 ) c= ( NAT ) by L119 , L117 , XBOOLE_1:1;
reconsider D4 = D3 as (Function of ( SetPrimes ) , ( NAT )) by L120 , L116 , FUNCT_2:def 1 , RELSET_1:4;
assume L121: C24 c= ( support C23 );
L122: (for R1 being set holds (((not R1 in C24) & R1 in ( SetPrimes )) implies ( D4 . R1 ) = ( 0 )))
proof
let R1 being set;
assume that
L123: (not R1 in C24)
and
L124: R1 in ( SetPrimes );
L125: R1 in ( ( SetPrimes ) \ C24 ) by L123 , L124 , XBOOLE_0:def 5;
L126: R1 in ( dom ( ( ( SetPrimes ) \ C24 ) --> ( 0 ) ) ) by L125 , FUNCOP_1:13;
L127: ( D4 . R1 ) = ( ( ( ( SetPrimes ) \ C24 ) --> ( 0 ) ) . R1 ) by L126 , FUNCT_4:13;
thus L128: thesis by L127 , L125 , FUNCOP_1:7;
end;
L129: ( dom ( C24 --> ( 0 ) ) ) = C24 by FUNCOP_1:13;
L130: ( dom D2 ) = ( ( dom C23 ) \/ C24 ) by L129 , FUNCT_4:def 1
.= ( ( SetPrimes ) \/ C24 ) by PARTFUN1:def 2
.= ( SetPrimes ) by L121 , XBOOLE_1:1 , XBOOLE_1:12;
reconsider D5 = D2 as (Function of ( SetPrimes ) , ( NAT )) by L130 , L115 , FUNCT_2:def 1 , RELSET_1:4;
L131: ( dom ( D5 | ( support D5 ) ) ) = ( ( dom D5 ) /\ ( support D5 ) ) by RELAT_1:61
.= ( support D5 ) by PRE_POLY:37 , XBOOLE_1:28;
L132: (for B30 being set holds ((not B30 in ( SetPrimes )) implies (( D4 . B30 ) = ( 0 ) & ( D5 . B30 ) = ( 0 ))))
proof
let C25 being set;
assume L133: (not C25 in ( SetPrimes ));
L134: (not C25 in ( dom D4 )) by L133;
L135: (not C25 in ( dom D5 )) by L133;
thus L136: thesis by L135 , L134 , FUNCT_1:def 2;
end;
L137: (for R1 being set holds (R1 in C24 implies ( D4 . R1 ) = ( C23 . R1 )))
proof
let R1 being set;
assume L138: R1 in C24;
L139: (not R1 in ( dom ( ( ( SetPrimes ) \ C24 ) --> ( 0 ) ) )) by L138 , XBOOLE_0:def 5;
thus L140: thesis by L139 , FUNCT_4:11;
end;
L141: (for B31 being set holds ((B31 in ( SetPrimes ) & B31 in C24) implies ( D4 . B31 ) <> ( 0 )))
proof
let C26 being set;
assume that
L142: C26 in ( SetPrimes )
and
L143: C26 in C24;
L144: ( C23 . C26 ) <> ( 0 ) by L121 , L143 , PRE_POLY:def 7;
thus L145: thesis by L144 , L137 , L143;
end;
L146: (for B32 being set holds (B32 in C24 iff ( D4 . B32 ) <> ( 0 )))
proof
let C27 being set;
L147:
now
per cases ;
suppose L148: C27 in ( SetPrimes );

thus L149: thesis by L148 , L122 , L141;
end;
suppose L150: (not C27 in ( SetPrimes ));

L151: C24 c= ( SetPrimes ) by L121 , XBOOLE_1:1;
thus L152: thesis by L151 , L132 , L150;
end;
end;
thus L154: thesis by L147;
end;
L155: ( support D4 ) = C24 by L146 , PRE_POLY:def 7;
reconsider D6 = D4 as (bag of ( SetPrimes )) by L155 , L121 , PRE_POLY:def 8;
L156: ( support C23 ) c= ( dom C23 ) by PRE_POLY:37;
L157: ( dom ( D4 | ( support D4 ) ) ) = ( ( dom D4 ) /\ ( support D4 ) ) by RELAT_1:61
.= ( support D4 ) by PRE_POLY:37 , XBOOLE_1:28
.= C24 by L146 , PRE_POLY:def 7;
L158: (for B33 being set holds (B33 in ( dom ( D4 | ( support D4 ) ) ) implies ( ( D4 | ( support D4 ) ) . B33 ) = ( ( C23 | ( support D4 ) ) . B33 )))
proof
let C28 being set;
assume L159: C28 in ( dom ( D4 | ( support D4 ) ) );
L160: ( ( C23 | ( support D4 ) ) . C28 ) = ( C23 . C28 ) by L159 , L155 , L157 , FUNCT_1:49;
L161: ( ( D4 | ( support D4 ) ) . C28 ) = ( D4 . C28 ) by L155 , L157 , L159 , FUNCT_1:49;
thus L162: thesis by L161 , L137 , L157 , L159 , L160;
end;
L163: ( dom ( C23 | ( support D4 ) ) ) = ( ( dom C23 ) /\ ( support D4 ) ) by RELAT_1:61
.= ( ( dom C23 ) /\ C24 ) by L146 , PRE_POLY:def 7
.= C24 by L121 , L156 , XBOOLE_1:1 , XBOOLE_1:28;
L164: ( D4 | ( support D4 ) ) = ( C23 | ( support D4 ) ) by L163 , L157 , L158 , FUNCT_1:def 11;
L165: (for R1 being set holds (R1 in C24 implies ( D5 . R1 ) = ( 0 )))
proof
let R1 being set;
assume L166: R1 in C24;
thus L167: ( D5 . R1 ) = ( ( C24 --> ( 0 ) ) . R1 ) by L166 , L129 , FUNCT_4:13
.= ( 0 ) by L166 , FUNCOP_1:7;
end;
L168: (for B34 being set holds (B34 in ( ( support C23 ) \ C24 ) iff ( D5 . B34 ) <> ( 0 )))
proof
let C29 being set;
per cases ;
suppose L169: C29 in C24;

thus L170: thesis by L169 , L165 , XBOOLE_0:def 5;
end;
suppose L171: (not C29 in C24);

L172: ( D5 . C29 ) = ( C23 . C29 ) by L171 , L129 , FUNCT_4:11;
per cases ;
suppose L173: C29 in ( support C23 );

thus L174: thesis by L173 , L171 , L172 , PRE_POLY:def 7 , XBOOLE_0:def 5;
end;
suppose L175: (not C29 in ( support C23 ));

thus L176: thesis by L175 , L172 , PRE_POLY:def 7 , XBOOLE_0:def 5;
end;
end;
end;
L179: ( support D5 ) = ( ( support C23 ) \ C24 ) by L168 , PRE_POLY:def 7;
reconsider D7 = D5 as (bag of ( SetPrimes )) by L179 , PRE_POLY:def 8;
L180: ( dom ( C23 | ( support D5 ) ) ) = ( ( dom C23 ) /\ ( support D5 ) ) by RELAT_1:61
.= ( ( dom C23 ) /\ ( ( support C23 ) \ C24 ) ) by L168 , PRE_POLY:def 7
.= ( ( ( dom C23 ) /\ ( support C23 ) ) \ C24 ) by XBOOLE_1:49
.= ( ( support C23 ) \ C24 ) by PRE_POLY:37 , XBOOLE_1:28
.= ( support D5 ) by L168 , PRE_POLY:def 7;
L181: ( ( support C23 ) \ C24 ) misses C24 by XBOOLE_1:79;
L182: ( ( support D5 ) /\ ( support D4 ) ) = ( {} ) by L181 , L155 , L179 , XBOOLE_0:def 7;
L183: (for B35 being set holds ((B35 in ( SetPrimes ) & B35 in ( support D5 )) implies ( C23 . B35 ) = ( D5 . B35 )))
proof
let C30 being set;
assume that
L184: C30 in ( SetPrimes )
and
L185: C30 in ( support D5 );
L186: (not C30 in C24) by L155 , L182 , L185 , XBOOLE_0:def 4;
thus L187: thesis by L186 , L129 , FUNCT_4:11;
end;
L188: (for B36 being set holds (B36 in ( dom ( D5 | ( support D5 ) ) ) implies ( ( D5 | ( support D5 ) ) . B36 ) = ( ( C23 | ( support D5 ) ) . B36 )))
proof
let C31 being set;
assume L189: C31 in ( dom ( D5 | ( support D5 ) ) );
L190: ( ( C23 | ( support D5 ) ) . C31 ) = ( C23 . C31 ) by L189 , L131 , FUNCT_1:49;
L191: ( ( D5 | ( support D5 ) ) . C31 ) = ( D5 . C31 ) by L131 , L189 , FUNCT_1:49;
thus L192: thesis by L191 , L131 , L183 , L189 , L190;
end;
L193: ( D5 | ( support D5 ) ) = ( C23 | ( support D5 ) ) by L188 , L131 , L180 , FUNCT_1:def 11;
L194: ( ( support D4 ) \/ ( support D5 ) ) = ( ( support D4 ) \/ ( ( support C23 ) \ ( support D4 ) ) ) by L146 , L179 , PRE_POLY:def 7
.= ( ( support D4 ) \/ ( support C23 ) ) by XBOOLE_1:39
.= ( support C23 ) by L121 , L155 , XBOOLE_1:12;
L195: ( D7 + D6 ) = C23 by L194 , L182 , L193 , L164 , L27;
thus L196: thesis by L195 , L155 , L179 , L193 , L164 , XBOOLE_1:79;
end;
definition
let C32 being (bag of ( SetPrimes ));
attr C32 is  prime-factorization-like
means
:L197: (for B37 being Prime holds (B37 in ( support C32 ) implies (ex B38 being Nat st (( 0 ) < B38 & ( C32 . B37 ) = ( B37 |^ B38 )))));
end;
registration
let C33 being non  empty Nat;
cluster ( ppf C33 ) ->  prime-factorization-like;
coherence
proof
let C34 being Prime;
assume L199: C34 in ( support ( ppf C33 ) );
L200: ( C34 |-count C33 ) <> ( 0 )
proof
assume L201: ( C34 |-count C33 ) = ( 0 );
L202: ( ( ppf C33 ) . C34 ) = ( 0 ) by L201 , NAT_3:55;
thus L203: contradiction by L202 , L199 , PRE_POLY:def 7;
end;
take ( C34 |-count C33 );
L204: C34 in ( support ( pfexp C33 ) ) by L199 , NAT_3:def 9;
thus L205: thesis by L204 , L200 , NAT_3:def 9;
end;
end;
theorem
L207: (for B39 , B40 being Prime holds (for B41 , B42 being Nat holds ((B39 divides ( B42 * ( B40 |^ B41 ) ) & B39 <> B40) implies B39 divides B42)))
proof
let C35 , C36 being Prime;
let C37 , C38 being Nat;
assume that
L208: C35 divides ( C38 * ( C36 |^ C37 ) )
and
L209: C35 <> C36;
L210: (C35 divides C38 or C35 divides ( C36 |^ C37 )) by L208 , NEWTON:80;
thus L211: thesis by L210 , L209 , NAT_3:6;
end;
L212: (for B43 being Prime holds (for B44 being (bag of ( SetPrimes )) holds ((B44 is  prime-factorization-like & B43 in ( support B44 )) implies (B43 divides ( Product B44 ) & (ex B45 being Nat st ( B43 |^ B45 ) divides ( Product B44 ))))))
proof
let C39 being Prime;
let C40 being (bag of ( SetPrimes ));
assume that
L213: C40 is  prime-factorization-like
and
L214: C39 in ( support C40 );
consider C41 being Nat such that L215: ( 0 ) < C41 and L216: ( C40 . C39 ) = ( C39 |^ C41 ) by L213 , L214 , L197;
L217: C39 divides ( C40 . C39 ) by L215 , L216 , NAT_3:3;
L218: ( rng C40 ) c= ( NAT ) by VALUED_0:def 6;
L219: C39 in ( rng ( canFS ( support C40 ) ) ) by L214 , FUNCT_2:def 3;
consider C42 being set such that L220: C42 in ( dom ( canFS ( support C40 ) ) ) and L221: C39 = ( ( canFS ( support C40 ) ) . C42 ) by L219 , FUNCT_1:def 3;
consider C43 being (FinSequence of ( COMPLEX )) such that L222: ( Product C40 ) = ( Product C43 ) and L223: C43 = ( C40 * ( canFS ( support C40 ) ) ) by NAT_3:def 5;
L224: ( rng C43 ) c= ( rng C40 ) by L223 , RELAT_1:26;
L225: ( rng C43 ) c= ( NAT ) by L224 , L218 , XBOOLE_1:1;
reconsider D8 = C43 as (FinSequence of ( NAT )) by L225 , FINSEQ_1:def 4;
L226: ( rng ( canFS ( support C40 ) ) ) = ( support C40 ) by FUNCT_2:def 3;
L227: ( support C40 ) c= ( dom C40 ) by PRE_POLY:37;
L228: ( dom D8 ) = ( dom ( canFS ( support C40 ) ) ) by L227 , L223 , L226 , RELAT_1:27;
L229: ( C40 . C39 ) = ( ( C40 * ( canFS ( support C40 ) ) ) . C42 ) by L228 , L223 , L220 , L221 , FUNCT_1:12;
L230: ( C40 . C39 ) in ( rng D8 ) by L229 , L223 , L228 , L220 , FUNCT_1:3;
L231: ( C39 |^ C41 ) divides ( Product D8 ) by L230 , L216 , NAT_3:7;
thus L232: thesis by L231 , L222 , L216 , L217 , NAT_D:4;
end;
L233: (for B46 being (FinSequence of ( NAT )) holds (for B47 being (Element of ( NAT )) holds (for B48 being (bag of ( SetPrimes )) holds ((B48 is  prime-factorization-like & ( B46 ^ <* B47 *> ) = ( B48 * ( canFS ( support B48 ) ) )) implies (ex B49 being (FinSequence of ( NAT )) st (ex B50 being Prime st (ex B51 being (Element of ( NAT )) st (ex B52 being (bag of ( SetPrimes )) st (( 0 ) < B51 & B52 is  prime-factorization-like & B50 in ( support B48 ) & ( support B52 ) = ( ( support B48 ) \ { B50 } ) & B47 = ( B50 |^ B51 ) & ( len B49 ) = ( len B46 ) & ( Product B46 ) = ( Product B49 ) & B49 = ( B52 * ( canFS ( support B52 ) ) ))))))))))
proof
deffunc H3(set) = ( 0 );
let C44 being (FinSequence of ( NAT ));
let C45 being (Element of ( NAT ));
let C46 being (bag of ( SetPrimes ));
assume that
L234: C46 is  prime-factorization-like
and
L235: ( C44 ^ <* C45 *> ) = ( C46 * ( canFS ( support C46 ) ) );
L236: ( rng ( canFS ( support C46 ) ) ) = ( support C46 ) by FUNCT_2:def 3;
L237: ( dom C46 ) = ( SetPrimes ) by PARTFUN1:def 2;
L238: ( dom ( C46 * ( canFS ( support C46 ) ) ) ) = ( dom ( canFS ( support C46 ) ) ) by L237 , L236 , RELAT_1:27;
L239: C44 = ( ( C46 * ( canFS ( support C46 ) ) ) | ( dom C44 ) ) by L235 , FINSEQ_1:21;
L240: ( dom C44 ) = ( ( dom ( C46 * ( canFS ( support C46 ) ) ) ) /\ ( dom C44 ) ) by L239 , RELAT_1:61;
L241: ( dom ( ( canFS ( support C46 ) ) | ( dom C44 ) ) ) = ( dom C44 ) by L240 , L238 , RELAT_1:62 , XBOOLE_1:17;
deffunc H4(set) = ( C46 . $1 );
L242: ( card ( support C46 ) ) = ( len ( canFS ( support C46 ) ) ) by UPROOTS:3;
L243: ( dom C46 ) = ( SetPrimes ) by PARTFUN1:def 2;
L244: ( dom ( C46 * ( canFS ( support C46 ) ) ) ) = ( dom ( canFS ( support C46 ) ) ) by L243 , L236 , RELAT_1:27;
L245: ( ( len C44 ) + 1 ) in ( Seg ( ( len C44 ) + 1 ) ) by FINSEQ_1:4;
L246: ( len <* C45 *> ) = 1 by FINSEQ_1:40;
L247: ( len ( C44 ^ <* C45 *> ) ) = ( ( len C44 ) + 1 ) by L246 , FINSEQ_1:22;
L248: ( ( len C44 ) + 1 ) in ( dom ( C46 * ( canFS ( support C46 ) ) ) ) by L247 , L235 , L245 , FINSEQ_1:def 3;
L249: C45 = ( ( C44 ^ <* C45 *> ) . ( ( len C44 ) + 1 ) ) by FINSEQ_1:42
.= ( C46 . ( ( canFS ( support C46 ) ) . ( ( len C44 ) + 1 ) ) ) by L235 , L244 , L248 , FUNCT_1:13;
L250: ( rng ( canFS ( support C46 ) ) ) = ( support C46 ) by FUNCT_2:def 3;
L251: ( ( canFS ( support C46 ) ) . ( ( len C44 ) + 1 ) ) in ( support C46 ) by L250 , L244 , L248 , FUNCT_1:3;
reconsider D9 = ( ( canFS ( support C46 ) ) . ( ( len C44 ) + 1 ) ) as Prime by L251 , NEWTON:def 6;
defpred S2[ set ] means $1 in ( ( support C46 ) \ { D9 } );
consider C47 being (ManySortedSet of ( SetPrimes )) such that L252: (for B53 being (Element of ( SetPrimes )) holds (B53 in ( SetPrimes ) implies ((S2[ B53 ] implies ( C47 . B53 ) = H4(B53)) & ((not S2[ B53 ]) implies ( C47 . B53 ) = H3(B53))))) from PRE_CIRC:sch 2;
L253: ( rng C47 ) c= ( NAT )
proof
let C48 being set;
assume L254: C48 in ( rng C47 );
consider C49 being set such that L255: C49 in ( dom C47 ) and L256: C48 = ( C47 . C49 ) by L254 , FUNCT_1:def 3;
reconsider D10 = C49 as (Element of ( SetPrimes )) by L255;
L257: ( C47 . D10 ) in ( NAT )
proof
per cases ;
suppose L258: D10 in ( ( support C46 ) \ { D9 } );

L259: ( C47 . D10 ) = ( C46 . D10 ) by L258 , L252;
thus L260: thesis by L259;
end;
suppose L261: (not D10 in ( ( support C46 ) \ { D9 } ));

L262: ( C47 . D10 ) = ( 0 ) by L261 , L252;
thus L263: thesis by L262;
end;
end;
thus L265: thesis by L257 , L256;
end;
L266:
now
let C50 being set;
assume L267: C50 in ( support C47 );
L268: C50 in ( dom C47 )
proof
assume L269: (not C50 in ( dom C47 ));
L270: ( C47 . C50 ) = ( {} ) by L269 , FUNCT_1:def 2;
thus L271: contradiction by L270 , L267 , PRE_POLY:def 7;
end;
reconsider D11 = C50 as (Element of ( SetPrimes )) by L268;
assume L272: (not C50 in ( ( support C46 ) \ { D9 } ));
L273: ( C47 . D11 ) <> ( 0 ) by L267 , PRE_POLY:def 7;
thus L274: contradiction by L273 , L252 , L272;
end;
L275: ( support C47 ) c= ( ( support C46 ) \ { D9 } ) by L266 , TARSKI:def 3;
L276:
now
let C51 being set;
assume L277: C51 in ( ( support C46 ) \ { D9 } );
L278: C51 in ( support C46 ) by L277 , XBOOLE_0:def 5;
reconsider D12 = C51 as (Element of ( SetPrimes )) by L277;
L279: ( C47 . D12 ) = ( C46 . D12 ) by L252 , L277;
L280: ( C47 . D12 ) <> ( 0 ) by L279 , L278 , PRE_POLY:def 7;
thus L281: C51 in ( support C47 ) by L280 , PRE_POLY:def 7;
end;
L282: ( ( support C46 ) \ { D9 } ) c= ( support C47 ) by L276 , TARSKI:def 3;
L283: ( support C47 ) = ( ( support C46 ) \ { D9 } ) by L282 , L275 , XBOOLE_0:def 10;
reconsider D13 = C47 as (bag of ( SetPrimes )) by L275 , L253 , PRE_POLY:def 8 , VALUED_0:def 6;
consider C52 being Nat such that L284: ( 0 ) < C52 and L285: ( C46 . D9 ) = ( D9 |^ C52 ) by L234 , L251 , L197;
reconsider D14 = C52 as (Element of ( NAT )) by ORDINAL1:def 12;
L286: ( rng ( canFS ( support C46 ) ) ) = ( support C46 ) by FUNCT_2:def 3;
L287: ( SetPrimes ) = ( dom C46 ) by PARTFUN1:def 2;
L288: ( card ( dom ( C46 * ( canFS ( support C46 ) ) ) ) ) = ( card ( dom ( canFS ( support C46 ) ) ) ) by L287 , L286 , RELAT_1:27
.= ( card ( Seg ( len ( canFS ( support C46 ) ) ) ) ) by FINSEQ_1:def 3
.= ( card ( len ( canFS ( support C46 ) ) ) ) by FINSEQ_1:55
.= ( len ( canFS ( support C46 ) ) );
L289: ( len ( canFS ( support C46 ) ) ) = ( card ( Seg ( len ( C44 ^ <* C45 *> ) ) ) ) by L288 , L235 , FINSEQ_1:def 3
.= ( card ( len ( C44 ^ <* C45 *> ) ) ) by FINSEQ_1:55
.= ( ( len C44 ) + 1 ) by L246 , FINSEQ_1:22;
L290: ( card ( ( support C46 ) \ { D9 } ) ) = ( ( card ( support C46 ) ) - ( card { D9 } ) ) by L244 , L250 , L248 , EULER_1:4 , FUNCT_1:3
.= ( ( card ( support C46 ) ) - 1 ) by CARD_1:30;
L291: ( len ( canFS ( support D13 ) ) ) = ( len C44 ) by L290 , L283 , L289 , L242 , UPROOTS:3;
L292: ( dom ( canFS ( support D13 ) ) ) = ( Seg ( len C44 ) ) by L291 , FINSEQ_1:def 3;
L293: ( dom ( canFS ( support D13 ) ) ) = ( dom C44 ) by L292 , FINSEQ_1:def 3;
L294:
now
let C53 being Prime;
assume L295: C53 in ( support D13 );
L296: ( ( support C46 ) \ { D9 } ) c= ( support C46 ) by XBOOLE_1:36;
consider C54 being Nat such that L297: ( 0 ) < C54 and L298: ( C46 . C53 ) = ( C53 |^ C54 ) by L296 , L234 , L283 , L295 , L197;
take D15 = C54;
thus L299: ( 0 ) < D15 by L297;
thus L300: ( D13 . C53 ) = ( C53 |^ D15 ) by L252 , L275 , L295 , L298;
end;
per cases ;
suppose L301: ( dom C44 ) = ( {} );

set D16 = ( D13 * ( canFS ( support D13 ) ) );
L302: C44 = ( {} ) by L301;
L303: ( Seg ( len ( canFS ( support D13 ) ) ) ) = ( dom ( canFS ( support D13 ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len C44 ) ) by L291 , FINSEQ_1:def 3
.= ( Seg ( 0 ) ) by L302;
L304: ( canFS ( support D13 ) ) = ( {} ) by L303;
L305: D16 = ( <*> ( NAT ) ) by L304;
reconsider D17 = D16 as (FinSequence of ( NAT )) by L305;
take D17;
take D9;
take D14;
take D13;
thus L306: thesis by L244 , L250 , L248 , L249 , L284 , L285 , L275 , L282 , L294 , L301 , L305 , L197 , FUNCT_1:3 , RELAT_1:41 , XBOOLE_0:def 10;
end;
suppose L307: ( dom C44 ) <> ( {} );

L308: ( rng ( canFS ( support C46 ) ) ) = ( support C46 ) by FUNCT_2:def 3;
L309:
now
let C55 being set;
assume L310: C55 in ( ( support C46 ) \ { D9 } );
L311: C55 in ( rng ( canFS ( support C46 ) ) ) by L310 , L308 , XBOOLE_0:def 5;
consider C56 being set such that L312: C56 in ( dom ( canFS ( support C46 ) ) ) and L313: C55 = ( ( canFS ( support C46 ) ) . C56 ) by L311 , FUNCT_1:def 3;
L314: C56 in ( dom C44 )
proof
assume L315: (not C56 in ( dom C44 ));
L316: (not C56 in ( Seg ( len C44 ) )) by L315 , FINSEQ_1:def 3;
L317: C56 in ( Seg ( ( len C44 ) + 1 ) ) by L289 , L312 , FINSEQ_1:def 3;
reconsider D18 = C56 as (Element of ( NAT )) by L312;
L318: 1 <= D18 by L317 , FINSEQ_1:1;
L319: ( len C44 ) < D18 by L318 , L316;
L320: ( ( len C44 ) + 1 ) <= D18 by L319 , NAT_1:13;
L321: D18 <= ( ( len C44 ) + 1 ) by L317 , FINSEQ_1:1;
L322: D18 = ( ( len C44 ) + 1 ) by L321 , L320 , XXREAL_0:1;
L323: C55 in { D9 } by L322 , L313 , TARSKI:def 1;
thus L324: contradiction by L323 , L310 , XBOOLE_0:def 5;
end;
L325: C56 in ( ( dom ( canFS ( support C46 ) ) ) /\ ( dom C44 ) ) by L314 , L312 , XBOOLE_0:def 4;
L326: C56 in ( dom ( ( canFS ( support C46 ) ) | ( dom C44 ) ) ) by L325 , RELAT_1:61;
L327: C55 = ( ( ( canFS ( support C46 ) ) | ( dom C44 ) ) . C56 ) by L313 , L314 , FUNCT_1:49;
thus L328: C55 in ( rng ( ( canFS ( support C46 ) ) | ( dom C44 ) ) ) by L327 , L326 , FUNCT_1:3;
end;
L329: ( ( support C46 ) \ { D9 } ) c= ( rng ( ( canFS ( support C46 ) ) | ( dom C44 ) ) ) by L309 , TARSKI:def 3;
L330:
now
let C57 being set;
assume L331: C57 in ( rng ( ( canFS ( support C46 ) ) | ( dom C44 ) ) );
consider C58 being set such that L332: C58 in ( dom ( ( canFS ( support C46 ) ) | ( dom C44 ) ) ) and L333: C57 = ( ( ( canFS ( support C46 ) ) | ( dom C44 ) ) . C58 ) by L331 , FUNCT_1:def 3;
L334: C57 = ( ( canFS ( support C46 ) ) . C58 ) by L332 , L333 , FUNCT_1:47;
L335: C58 in ( ( dom ( canFS ( support C46 ) ) ) /\ ( dom C44 ) ) by L332 , RELAT_1:61;
L336: C58 in ( dom ( canFS ( support C46 ) ) ) by L335 , XBOOLE_0:def 4;
L337: C58 in ( dom C44 ) by L335 , XBOOLE_0:def 4;
L338: C57 <> D9
proof
L339: ( ( len C44 ) + 1 ) in ( Seg ( ( len C44 ) + 1 ) ) by FINSEQ_1:4;
L340: ( ( len C44 ) + 1 ) in ( dom ( canFS ( support C46 ) ) ) by L339 , L289 , FINSEQ_1:def 3;
assume L341: C57 = D9;
L342: ( ( len C44 ) + 1 ) = C58 by L341 , L334 , L336 , L340 , FUNCT_1:def 4;
L343: ( ( len C44 ) + 1 ) in ( Seg ( len C44 ) ) by L342 , L337 , FINSEQ_1:def 3;
L344: ( ( len C44 ) + ( 0 ) ) < ( 1 + ( len C44 ) ) by XREAL_1:8;
thus L345: contradiction by L344 , L343 , FINSEQ_1:1;
end;
L346: (not C57 in { D9 }) by L338 , TARSKI:def 1;
L347: C57 in ( rng ( canFS ( support C46 ) ) ) by L334 , L336 , FUNCT_1:3;
thus L348: C57 in ( ( support C46 ) \ { D9 } ) by L347 , L346 , XBOOLE_0:def 5;
end;
L349: ( rng ( ( canFS ( support C46 ) ) | ( dom C44 ) ) ) c= ( ( support C46 ) \ { D9 } ) by L330 , TARSKI:def 3;
L350: ( rng ( ( canFS ( support C46 ) ) | ( dom C44 ) ) ) = ( ( support C46 ) \ { D9 } ) by L349 , L329 , XBOOLE_0:def 10;
reconsider D19 = ( ( canFS ( support C46 ) ) | ( dom C44 ) ) as (Function of ( dom C44 ) , ( ( support C46 ) \ { D9 } )) by L350 , L241 , FUNCT_2:1;
L351: D19 is  one-to-one by FUNCT_1:52;
L352: ( dom ( D19 " ) ) = ( ( support C46 ) \ { D9 } ) by L351 , L350 , FUNCT_1:33;
L353: ( ( support C46 ) \ { D9 } ) <> ( {} ) by L275 , L292 , L307 , FINSEQ_1:def 3;
L354: ( dom D19 ) = ( dom C44 ) by L353 , FUNCT_2:def 1;
L355: ( rng ( D19 " ) ) = ( dom C44 ) by L354 , L351 , FUNCT_1:33;
reconsider D20 = ( D19 " ) as (Function of ( ( support C46 ) \ { D9 } ) , ( dom C44 )) by L355 , L352 , FUNCT_2:1;
L356: ( rng ( canFS ( support D13 ) ) ) = ( support D13 ) by FUNCT_2:def 3;
L357: ( canFS ( support D13 ) ) is (Function of ( dom C44 ) , ( ( support C46 ) \ { D9 } )) by L356 , L283 , L293 , FUNCT_2:1;
reconsider D21 = ( D20 * ( canFS ( support D13 ) ) ) as (Function of ( dom C44 ) , ( dom C44 )) by L357 , L353 , FUNCT_2:13;
L358: D19 is  one-to-one by FUNCT_1:52;
L359: ( rng D21 ) = ( dom C44 ) by L282 , L352 , L355 , L356 , RELAT_1:28;
L360: D21 is  onto by L359 , FUNCT_2:def 3;
reconsider D22 = D21 as (Permutation of ( dom C44 )) by L360 , L358;
L361: ( ( ( canFS ( support C46 ) ) | ( dom C44 ) ) * D22 ) = ( ( ( ( canFS ( support C46 ) ) | ( dom C44 ) ) * D20 ) * ( canFS ( support D13 ) ) ) by RELAT_1:36
.= ( ( id ( support D13 ) ) * ( canFS ( support D13 ) ) ) by L283 , L353 , L350 , L358 , FUNCT_2:29
.= ( canFS ( support D13 ) ) by FUNCT_2:17;
L362: ( ( canFS ( support D13 ) ) * ( D22 " ) ) = ( ( ( canFS ( support C46 ) ) | ( dom C44 ) ) * ( D22 * ( D22 " ) ) ) by L361 , RELAT_1:36;
reconsider D23 = ( canFS ( support D13 ) ) as FinSequence;
reconsider D24 = ( D22 " ) as (Permutation of ( dom C44 ));
L363: ( rng D24 ) = ( dom D23 ) by L293 , FUNCT_2:def 3;
L364: ( dom ( D23 * D24 ) ) = ( dom D24 ) by L363 , RELAT_1:27
.= ( dom C44 ) by L307 , FUNCT_2:def 1;
set D25 = ( D13 * D23 );
L365: ( rng ( canFS ( support D13 ) ) ) = ( support D13 ) by FUNCT_2:def 3;
L366: ( SetPrimes ) = ( dom D13 ) by PARTFUN1:def 2;
L367: ( dom ( D13 * D23 ) ) = ( dom C44 ) by L366 , L293 , L365 , RELAT_1:27;
L368: ( dom D25 ) = ( Seg ( len C44 ) ) by L367 , FINSEQ_1:def 3;
L369: D25 is FinSequence by L368 , FINSEQ_1:def 2;
L370: ( rng ( D23 * D24 ) ) = ( rng D23 ) by L363 , RELAT_1:28
.= ( ( support C46 ) \ { D9 } ) by L283 , FUNCT_2:def 3;
L371: ( SetPrimes ) = ( dom D13 ) by PARTFUN1:def 2;
L372: ( dom C44 ) = ( dom ( D13 * ( D23 * D24 ) ) ) by L371 , L364 , L370 , RELAT_1:27;
L373: ( rng D22 ) = ( dom C44 ) by FUNCT_2:def 3;
L374: ( ( canFS ( support D13 ) ) * ( D22 " ) ) = ( ( ( canFS ( support C46 ) ) | ( dom C44 ) ) * ( id ( dom C44 ) ) ) by L373 , L307 , L362 , FUNCT_2:29;
L375:
now
let C59 being set;
L376: ( dom C44 ) c= ( dom ( C44 ^ <* C45 *> ) ) by FINSEQ_1:26;
assume L377: C59 in ( dom C44 );
L378: ( ( D23 * D24 ) . C59 ) in ( ( support C46 ) \ { D9 } ) by L377 , L364 , L370 , FUNCT_1:3;
thus L379: ( C44 . C59 ) = ( ( C44 ^ <* C45 *> ) . C59 ) by L377 , FINSEQ_1:def 7
.= ( C46 . ( ( canFS ( support C46 ) ) . C59 ) ) by L235 , L377 , L376 , FUNCT_1:12
.= ( C46 . ( ( ( canFS ( support C46 ) ) | ( dom C44 ) ) . C59 ) ) by L377 , FUNCT_1:49
.= ( C46 . ( ( D23 * D24 ) . C59 ) ) by L374 , FUNCT_2:17
.= ( D13 . ( ( D23 * D24 ) . C59 ) ) by L252 , L378
.= ( ( D13 * ( D23 * D24 ) ) . C59 ) by L372 , L377 , FUNCT_1:12;
end;
L380: C44 = ( D13 * ( D23 * D24 ) ) by L375 , L372 , FUNCT_1:2
.= ( D25 * D24 ) by RELAT_1:36;
L381: C44 , D25 are_fiberwise_equipotent  by L380 , L367 , CLASSES1:80;
L382: ( rng D25 ) c= ( NAT ) by VALUED_0:def 6;
reconsider D26 = D25 as (FinSequence of ( NAT )) by L382 , L369 , FINSEQ_1:def 4;
take D26;
take D9;
take D14;
take D13;
L383: ( Seg ( len D26 ) ) = ( dom C44 ) by L367 , FINSEQ_1:def 3;
thus L384: thesis by L383 , L244 , L250 , L248 , L249 , L284 , L285 , L275 , L282 , L294 , L381 , L197 , EULER_2:10 , FINSEQ_1:def 3 , FUNCT_1:3 , XBOOLE_0:def 10;
end;
end;
L386: (for B54 being (Element of ( NAT )) holds (for B55 being (FinSequence of ( NAT )) holds (for B56 being (bag of ( SetPrimes )) holds (for B57 being Prime holds ((( len B55 ) = B54 & B56 is  prime-factorization-like & ( Product B56 ) <> 1 & B57 divides ( Product B56 ) & ( Product B56 ) = ( Product B55 ) & B55 = ( B56 * ( canFS ( support B56 ) ) )) implies B57 in ( support B56 ))))))
proof
defpred S3[ (Element of ( NAT )) ] means (for B58 being (FinSequence of ( NAT )) holds (for B59 being (bag of ( SetPrimes )) holds (for B60 being Prime holds ((( len B58 ) = $1 & B59 is  prime-factorization-like & ( Product B59 ) <> 1 & B60 divides ( Product B59 ) & ( Product B59 ) = ( Product B58 ) & B58 = ( B59 * ( canFS ( support B59 ) ) )) implies B60 in ( support B59 )))));
L387: (for B61 being (Element of ( NAT )) holds (S3[ B61 ] implies S3[ ( B61 + 1 ) ]))
proof
let C60 being (Element of ( NAT ));
assume L388: S3[ C60 ];
thus L389: S3[ ( C60 + 1 ) ]
proof
L390: 1 <= ( C60 + 1 ) by NAT_1:11;
let C61 being (FinSequence of ( NAT ));
let C62 being (bag of ( SetPrimes ));
let C63 being Prime;
assume that
L391: ( len C61 ) = ( C60 + 1 )
and
L392: C62 is  prime-factorization-like
and
L393: ( Product C62 ) <> 1
and
L394: C63 divides ( Product C62 )
and
L395: ( Product C62 ) = ( Product C61 )
and
L396: C61 = ( C62 * ( canFS ( support C62 ) ) );
reconsider D27 = ( C61 | C60 ) as (FinSequence of ( NAT ));
reconsider D28 = ( C61 . ( C60 + 1 ) ) as (Element of ( NAT ));
L397: ( len D27 ) = C60 by L391 , FINSEQ_1:59 , NAT_1:11;
L398: C61 = ( ( C61 | C60 ) ^ <* ( C61 /. ( len C61 ) ) *> ) by L391 , FINSEQ_5:21
.= ( D27 ^ <* D28 *> ) by L391 , L390 , FINSEQ_4:15;
consider C64 being (FinSequence of ( NAT )), C65 being Prime, C66 being (Element of ( NAT )), C67 being (bag of ( SetPrimes )) such that L399: ( 0 ) < C66 and L400: C67 is  prime-factorization-like and L401: C65 in ( support C62 ) and L402: ( support C67 ) = ( ( support C62 ) \ { C65 } ) and L403: D28 = ( C65 |^ C66 ) and L404: ( len C64 ) = ( len D27 ) and L405: ( Product D27 ) = ( Product C64 ) and L406: C64 = ( C67 * ( canFS ( support C67 ) ) ) by L398 , L392 , L396 , L233;
L407: ( Product C61 ) = ( ( Product C64 ) * D28 ) by L398 , L405 , RVSUM_1:96;
L408: ( rng C64 ) c= ( COMPLEX ) by NUMBERS:20 , XBOOLE_1:1;
L409: C64 is (FinSequence of ( COMPLEX )) by L408 , FINSEQ_1:def 4;
L410: ( Product C67 ) = ( Product C64 ) by L409 , L406 , NAT_3:def 5;
L411:
now
per cases ;
suppose L412: ( Product C64 ) = 1;

L413: C63 <> 1 by INT_2:def 4;
L414: (ex B62 being (Element of ( NAT )) st C63 = ( C65 * B62 )) by L413 , L394 , L395 , L403 , L407 , L412 , PEPIN:32;
L415: C65 divides C63 by L414 , INT_1:def 3;
L416: C65 <> 1 by INT_2:def 4;
thus L417: thesis by L416 , L401 , L415 , INT_2:def 4;
end;
suppose L418: ( Product C64 ) <> 1;

per cases ;
suppose L419: C63 = C65;

thus L420: thesis by L419 , L401;
end;
suppose L421: C63 <> C65;

L422: ( support C67 ) c= ( support C62 ) by L402 , XBOOLE_1:36;
L423: C63 in ( support C67 ) by L388 , L394 , L395 , L397 , L400 , L403 , L404 , L406 , L407 , L410 , L418 , L421 , L207;
thus L424: thesis by L423 , L422;
end;
end;
end;
thus L427: thesis by L411;
end;

end;
L390: S3[ ( 0 ) ]
proof
let C68 being (FinSequence of ( NAT ));
let C69 being (bag of ( SetPrimes ));
let C70 being Prime;
assume L391: ( len C68 ) = ( 0 );
L392: C68 = ( <*> ( NAT ) ) by L391;
thus L393: thesis by L392 , RVSUM_1:94;
end;
L394: (for B63 being (Element of ( NAT )) holds S3[ B63 ]) from NAT_1:sch 1(L390 , L387);
thus L395: thesis by L394;
end;
theorem
L396: (for B64 being (FinSequence of ( NAT )) holds (for B65 being (bag of ( SetPrimes )) holds (for B66 being Prime holds ((B65 is  prime-factorization-like & ( Product B65 ) <> 1 & B66 divides ( Product B65 ) & ( Product B65 ) = ( Product B64 ) & B64 = ( B65 * ( canFS ( support B65 ) ) )) implies B66 in ( support B65 )))))
proof
let C71 being (FinSequence of ( NAT ));
let C72 being (bag of ( SetPrimes ));
let C73 being Prime;
assume that
L397: C72 is  prime-factorization-like
and
L398: ( Product C72 ) <> 1
and
L399: C73 divides ( Product C72 )
and
L400: ( Product C72 ) = ( Product C71 )
and
L401: C71 = ( C72 * ( canFS ( support C72 ) ) );
L402: ( len C71 ) is (Element of ( NAT ));
thus L403: thesis by L402 , L397 , L398 , L399 , L400 , L401 , L386;
end;
L404: (for B67 being Prime holds (for B68 being (bag of ( SetPrimes )) holds ((B68 is  prime-factorization-like & B67 divides ( Product B68 )) implies B67 in ( support B68 ))))
proof
let C74 being Prime;
let C75 being (bag of ( SetPrimes ));
assume that
L405: C75 is  prime-factorization-like
and
L406: C74 divides ( Product C75 );
per cases ;
suppose L407: ( Product C75 ) = 1;

L408: C74 <> 1 by INT_2:def 4;
thus L409: thesis by L408 , L406 , L407 , WSIERP_1:15;
end;
suppose L410: ( Product C75 ) <> 1;

L411: ( rng C75 ) c= ( NAT ) by VALUED_0:def 6;
consider C76 being (FinSequence of ( COMPLEX )) such that L412: ( Product C75 ) = ( Product C76 ) and L413: C76 = ( C75 * ( canFS ( support C75 ) ) ) by NAT_3:def 5;
L414: ( rng C76 ) c= ( rng C75 ) by L413 , RELAT_1:26;
L415: ( rng C76 ) c= ( NAT ) by L414 , L411 , XBOOLE_1:1;
reconsider D29 = C76 as (FinSequence of ( NAT )) by L415 , FINSEQ_1:def 4;
L416: ( Product C75 ) = ( Product D29 ) by L412;
thus L417: thesis by L416 , L405 , L406 , L410 , L413 , L396;
end;
end;
theorem
L419: (for B69 , B70 being (bag of ( SetPrimes )) holds ((( support B69 ) c= ( support B70 ) & ( B69 | ( support B69 ) ) = ( B70 | ( support B69 ) )) implies ( Product B69 ) divides ( Product B70 )))
proof
let C77 , C78 being (bag of ( SetPrimes ));
assume that
L420: ( support C77 ) c= ( support C78 )
and
L421: ( C77 | ( support C77 ) ) = ( C78 | ( support C77 ) );
consider C79 being (bag of ( SetPrimes )) such that L422: ( support C79 ) = ( ( support C78 ) \ ( support C77 ) ) and L423: ( support C77 ) misses ( support C79 ) and L424: ( C79 | ( support C79 ) ) = ( C78 | ( support C79 ) ) and L425: ( C77 + C79 ) = C78 by L420 , L421 , L71;
L426: ( ( Product C77 ) * ( Product C79 ) ) = ( Product C78 ) by L423 , L425 , NAT_3:19;
thus L427: thesis by L426 , INT_1:def 3;
end;
theorem
L428: (for B71 being (bag of ( SetPrimes )) holds (for B72 being Prime holds (B71 is  prime-factorization-like implies (B72 divides ( Product B71 ) iff B72 in ( support B71 ))))) by L212 , L404;
theorem
L429: (for B73 , B74 , B75 being non  empty Nat holds (B75 = ( B73 lcm B74 ) implies ( support ( ppf B75 ) ) = ( ( support ( ppf B73 ) ) \/ ( support ( ppf B74 ) ) )))
proof
let C80 , C81 , C82 being non  empty Nat;
assume L430: C82 = ( C80 lcm C81 );
L431: ( support ( ppf C80 ) ) = ( support ( pfexp C80 ) ) by NAT_3:def 9;
L432: ( ( support ( pfexp C80 ) ) \/ ( support ( pfexp C81 ) ) ) c= ( support ( max (( pfexp C80 ) , ( pfexp C81 )) ) )
proof
let C83 being set;
assume L433: C83 in ( ( support ( pfexp C80 ) ) \/ ( support ( pfexp C81 ) ) );
per cases  by L433 , XBOOLE_0:def 3;
suppose L434: C83 in ( support ( pfexp C80 ) );

L435: ( ( pfexp C80 ) . C83 ) <= ( ( max (( pfexp C80 ) , ( pfexp C81 )) ) . C83 )
proof
per cases ;
suppose L436: ( ( pfexp C80 ) . C83 ) <= ( ( pfexp C81 ) . C83 );

thus L437: thesis by L436 , NAT_3:def 4;
end;
suppose L438: ( ( pfexp C80 ) . C83 ) > ( ( pfexp C81 ) . C83 );

thus L439: thesis by L438 , NAT_3:def 4;
end;
end;
L441: ( ( pfexp C80 ) . C83 ) <> ( 0 ) by L434 , PRE_POLY:def 7;
L442: ( 0 ) < ( ( pfexp C80 ) . C83 ) by L441;
thus L443: thesis by L442 , L435 , PRE_POLY:def 7;
end;
suppose L444: C83 in ( support ( pfexp C81 ) );

L445: ( ( pfexp C81 ) . C83 ) <= ( ( max (( pfexp C80 ) , ( pfexp C81 )) ) . C83 )
proof
per cases ;
suppose L446: ( ( pfexp C80 ) . C83 ) <= ( ( pfexp C81 ) . C83 );

thus L447: thesis by L446 , NAT_3:def 4;
end;
suppose L448: ( ( pfexp C80 ) . C83 ) > ( ( pfexp C81 ) . C83 );

thus L449: thesis by L448 , NAT_3:def 4;
end;
end;
L451: ( ( pfexp C81 ) . C83 ) <> ( 0 ) by L444 , PRE_POLY:def 7;
L452: ( 0 ) < ( ( pfexp C81 ) . C83 ) by L451;
thus L453: thesis by L452 , L445 , PRE_POLY:def 7;
end;
end;
L455: ( support ( ppf C81 ) ) = ( support ( pfexp C81 ) ) by NAT_3:def 9;
L456: ( support ( ppf C82 ) ) = ( support ( pfexp C82 ) ) by NAT_3:def 9
.= ( support ( max (( pfexp C80 ) , ( pfexp C81 )) ) ) by L430 , NAT_3:54;
L457: ( support ( ppf C82 ) ) c= ( ( support ( ppf C80 ) ) \/ ( support ( ppf C81 ) ) ) by L456 , L431 , L455 , NAT_3:18;
thus L458: thesis by L457 , L456 , L431 , L455 , L432 , XBOOLE_0:def 10;
end;
theorem
L459: (for B76 being set holds (for B77 , B78 being (bag of B76) holds ( support ( min (B77 , B78) ) ) = ( ( support B77 ) /\ ( support B78 ) )))
proof
let C84 being set;
let C85 , C86 being (bag of C84);
set D30 = ( min (C85 , C86) );
L460: (for B79 being set holds (B79 in ( support ( min (C85 , C86) ) ) implies (B79 in ( support C85 ) & B79 in ( support C86 ))))
proof
let C87 being set;
assume L461: C87 in ( support ( min (C85 , C86) ) );
assume L462: ((not C87 in ( support C85 )) or (not C87 in ( support C86 )));
L463:
now
per cases ;
case L464: ( C85 . C87 ) <= ( C86 . C87 );
L465: (not C87 in ( support C85 ))
proof
assume L466: C87 in ( support C85 );
L467: ( C85 . C87 ) <> ( 0 ) by L466 , PRE_POLY:def 7;
L468: ( C86 . C87 ) = ( 0 ) by L462 , L466 , PRE_POLY:def 7;
thus L469: contradiction by L468 , L464 , L467;
end;
L470: ( D30 . C87 ) = ( C85 . C87 ) by L464 , NAT_3:def 3
.= ( 0 ) by L465 , PRE_POLY:def 7;
thus L471: contradiction by L470 , L461 , PRE_POLY:def 7;
end;
case L472: ( C86 . C87 ) < ( C85 . C87 );
L473: ( D30 . C87 ) = ( C86 . C87 ) by L472 , NAT_3:def 3
.= ( 0 ) by L462 , L472 , PRE_POLY:def 7;
thus L474: contradiction by L473 , L461 , PRE_POLY:def 7;
end;
end;
thus L476: thesis by L463;
end;
L477: (for B80 being set holds ((B80 in ( support C85 ) & B80 in ( support C86 )) implies B80 in ( support ( min (C85 , C86) ) )))
proof
let C88 being set;
assume that
L478: C88 in ( support C85 )
and
L479: C88 in ( support C86 );
L480: ( C86 . C88 ) <> ( 0 ) by L479 , PRE_POLY:def 7;
L481: (( D30 . C88 ) = ( C85 . C88 ) or ( D30 . C88 ) = ( C86 . C88 )) by NAT_3:def 3;
L482: ( C85 . C88 ) <> ( 0 ) by L478 , PRE_POLY:def 7;
thus L483: thesis by L482 , L480 , L481 , PRE_POLY:def 7;
end;
thus L484: thesis by L477 , L460 , XBOOLE_0:def 4;
end;
theorem
L485: (for B81 , B82 , B83 being non  empty Nat holds (B83 = ( B81 gcd B82 ) implies ( support ( ppf B83 ) ) = ( ( support ( ppf B81 ) ) /\ ( support ( ppf B82 ) ) )))
proof
let C89 , C90 , C91 being non  empty Nat;
assume L486: C91 = ( C89 gcd C90 );
L487: ( support ( ppf C89 ) ) = ( support ( pfexp C89 ) ) by NAT_3:def 9;
L488: ( support ( ppf C90 ) ) = ( support ( pfexp C90 ) ) by NAT_3:def 9;
L489: ( support ( ppf C91 ) ) = ( support ( pfexp C91 ) ) by NAT_3:def 9
.= ( support ( min (( pfexp C89 ) , ( pfexp C90 )) ) ) by L486 , NAT_3:53;
thus L490: thesis by L489 , L487 , L488 , L459;
end;
theorem
L491: (for B84 , B85 being (bag of ( SetPrimes )) holds ((B84 is  prime-factorization-like & B85 is  prime-factorization-like & ( support B84 ) misses ( support B85 )) implies ( Product B84 ) , ( Product B85 ) are_relative_prime ))
proof
let C92 , C93 being (bag of ( SetPrimes ));
assume that
L492: C92 is  prime-factorization-like
and
L493: C93 is  prime-factorization-like
and
L494: ( support C92 ) misses ( support C93 );
assume L495: (not ( Product C92 ) , ( Product C93 ) are_relative_prime );
consider C94 being  prime Nat such that L496: C94 divides ( Product C92 ) and L497: C94 divides ( Product C93 ) by L495 , PYTHTRIP:def 2;
L498: C94 in ( support C93 ) by L493 , L497 , L404;
L499: C94 in ( support C92 ) by L492 , L496 , L404;
thus L500: contradiction by L499 , L494 , L498 , XBOOLE_0:3;
end;
L501: (for B86 being Prime holds (for B87 being (Element of ( NAT )) holds (B87 <> ( 0 ) implies (ex B88 being (bag of ( SetPrimes )) st (B88 = ( ( ( SetPrimes ) --> ( 0 ) ) +* (B86 , B87) ) & ( support B88 ) = { B86 } & ( Product B88 ) = B87)))))
proof
let C95 being Prime;
let C96 being (Element of ( NAT ));
set D31 = ( ( ( SetPrimes ) --> ( 0 ) ) +* (C95 , C96) );
reconsider D32 = D31 as (ManySortedSet of ( SetPrimes ));
L502: ( dom ( ( SetPrimes ) --> ( 0 ) ) ) = ( SetPrimes ) by FUNCOP_1:13;
L503: C95 in ( dom ( ( SetPrimes ) --> ( 0 ) ) ) by L502 , NEWTON:def 6;
L504: ( D32 . C95 ) = C96 by L503 , FUNCT_7:31;
L505: (for R1 being set holds ((not R1 in { C95 }) implies ( D32 . R1 ) = ( 0 )))
proof
let C97 being set;
assume L506: (not C97 in { C95 });
L507: C97 <> C95 by L506 , TARSKI:def 1;
thus L508: thesis by L507 , L1;
end;
L509:
now
let C98 being set;
assume L510: C98 in ( support D32 );
L511: C98 in ( dom D32 )
proof
assume L512: (not C98 in ( dom D32 ));
L513: ( D32 . C98 ) = ( {} ) by L512 , FUNCT_1:def 2;
thus L514: contradiction by L513 , L510 , PRE_POLY:def 7;
end;
reconsider D33 = C98 as (Element of ( SetPrimes )) by L511;
assume L515: (not C98 in { C95 });
L516: ( D32 . D33 ) <> ( 0 ) by L510 , PRE_POLY:def 7;
thus L517: C98 in { C95 } by L516 , L505;
end;
L518: (for B89 being set holds (B89 in ( support D32 ) implies B89 in { C95 })) by L509;
L519: ( support D32 ) c= { C95 } by L518 , TARSKI:def 3;
assume L520: C96 <> ( 0 );
L521:
now
let C99 being set;
assume L522: C99 in { C95 };
L523: C99 = C95 by L522 , TARSKI:def 1;
thus L524: C99 in ( support D32 ) by L520 , L504 , L523 , PRE_POLY:def 7;
end;
L525: { C95 } c= ( support D32 ) by L521 , TARSKI:def 3;
L526: ( support D32 ) = { C95 } by L525 , L519 , XBOOLE_0:def 10;
reconsider D34 = D32 as (bag of ( SetPrimes )) by L519 , PRE_POLY:def 8;
L527: C95 in ( support D34 ) by L526 , TARSKI:def 1;
L528: C95 in ( dom D34 )
proof
assume L529: (not C95 in ( dom D34 ));
L530: ( D34 . C95 ) = ( {} ) by L529 , FUNCT_1:def 2;
thus L531: contradiction by L530 , L527 , PRE_POLY:def 7;
end;
take D34;
consider C100 being (FinSequence of ( COMPLEX )) such that L532: ( Product D34 ) = ( Product C100 ) and L533: C100 = ( D34 * ( canFS ( support D34 ) ) ) by NAT_3:def 5;
L534: C100 = ( D34 * <* C95 *> ) by L526 , L533 , UPROOTS:4;
L535: C100 = <* ( D34 . C95 ) *> by L534 , L528 , FINSEQ_2:34;
thus L536: thesis by L535 , L504 , L519 , L525 , L532 , RVSUM_1:95 , XBOOLE_0:def 10;
end;
L537: (for B90 being (bag of ( SetPrimes )) holds (for B91 being Prime holds ((B90 is  prime-factorization-like & B91 in ( support B90 ) & ( B90 . B91 ) = B91) implies (ex B92 , B93 being (bag of ( SetPrimes )) st (B92 is  prime-factorization-like & ( support B93 ) = { B91 } & ( Product B93 ) = B91 & ( support B92 ) = ( ( support B90 ) \ { B91 } ) & ( B92 | ( support B92 ) ) = ( B90 | ( support B92 ) ) & ( Product B90 ) = ( ( Product B92 ) * B91 ))))))
proof
let C101 being (bag of ( SetPrimes ));
let C102 being Prime;
assume that
L538: C101 is  prime-factorization-like
and
L539: C102 in ( support C101 )
and
L540: ( C101 . C102 ) = C102;
consider C103 being Nat such that L541: ( 0 ) < C103 and L542: ( C101 . C102 ) = ( C102 |^ C103 ) by L538 , L539 , L197;
consider C104 being Nat such that L543: C103 = ( C104 + 1 ) by L541 , NAT_1:6;
L544: C104 = ( 0 )
proof
assume L545: C104 <> ( 0 );
L546: ( ( 0 ) + 1 ) < ( C104 + 1 ) by L545 , XREAL_1:8;
L547: 1 < C102 by INT_2:def 4;
L548: ( C102 to_power 1 ) < ( C102 to_power C103 ) by L547 , L543 , L546 , POWER:39;
L549: ( C102 |^ 1 ) < ( C102 to_power C103 ) by L548 , POWER:41;
L550: ( C102 |^ 1 ) < ( C102 |^ C103 ) by L549 , POWER:41;
thus L551: contradiction by L550 , L540 , L542 , NEWTON:5;
end;
L552: { C102 } c= ( support C101 ) by L539 , ZFMISC_1:31;
consider C105 , C106 being (bag of ( SetPrimes )) such that L553: ( support C105 ) = ( ( support C101 ) \ { C102 } ) and L554: ( support C106 ) = { C102 } and L555: ( support C105 ) misses ( support C106 ) and L556: ( C105 | ( support C105 ) ) = ( C101 | ( support C105 ) ) and L557: ( C106 | ( support C106 ) ) = ( C101 | ( support C106 ) ) and L558: ( C105 + C106 ) = C101 by L552 , L110;
L559: C106 = ( ( ( SetPrimes ) --> ( 0 ) ) +* (C102 , ( C106 . C102 )) ) by L554 , L11;
L560:
now
let C107 being Prime;
assume L561: C107 in ( support C105 );
L562: ( support C105 ) c= ( support C101 ) by L553 , XBOOLE_1:36;
consider C108 being Nat such that L563: ( 0 ) < C108 and L564: ( C101 . C107 ) = ( C107 |^ C108 ) by L562 , L538 , L561 , L197;
take D35 = C108;
L565: ( C105 . C107 ) = ( ( C105 | ( support C105 ) ) . C107 ) by L561 , FUNCT_1:49
.= ( C101 . C107 ) by L556 , L561 , FUNCT_1:49;
thus L566: (( 0 ) < D35 & ( C105 . C107 ) = ( C107 |^ D35 )) by L565 , L563 , L564;
end;
L567: C105 is  prime-factorization-like by L560 , L197;
L568: C102 in ( support C106 ) by L554 , TARSKI:def 1;
L569: ( C106 . C102 ) = ( ( C106 | ( support C106 ) ) . C102 ) by L568 , FUNCT_1:49
.= ( C101 . C102 ) by L557 , L568 , FUNCT_1:49
.= C102 by L542 , L543 , L544 , NEWTON:5;
L570: (ex B94 being (bag of ( SetPrimes )) st (B94 = C106 & ( support B94 ) = { C102 } & ( Product B94 ) = C102)) by L569 , L559 , L501;
L571: ( ( Product C105 ) * ( Product C106 ) ) = ( Product C101 ) by L555 , L558 , NAT_3:19;
thus L572: thesis by L571 , L553 , L556 , L567 , L570;
end;
L573: (for B95 being (bag of ( SetPrimes )) holds (for B96 being Prime holds ((B95 is  prime-factorization-like & B96 in ( support B95 ) & ( B95 . B96 ) <> B96) implies (ex B97 , B98 being (bag of ( SetPrimes )) st (B97 is  prime-factorization-like & ( support B98 ) = { B96 } & ( Product B98 ) = B96 & ( support B97 ) = ( support B95 ) & ( B97 | ( ( support B97 ) \ { B96 } ) ) = ( B95 | ( ( support B97 ) \ { B96 } ) ) & ( B95 . B96 ) = ( ( B97 . B96 ) * B96 ) & ( Product B95 ) = ( ( Product B97 ) * B96 ))))))
proof
let C109 being (bag of ( SetPrimes ));
let C110 being Prime;
assume that
L574: C109 is  prime-factorization-like
and
L575: C110 in ( support C109 )
and
L576: ( C109 . C110 ) <> C110;
consider C111 being Nat such that L577: ( 0 ) < C111 and L578: ( C109 . C110 ) = ( C110 |^ C111 ) by L574 , L575 , L197;
consider C112 being Nat such that L579: C111 = ( C112 + 1 ) by L577 , NAT_1:6;
L580: C112 <> ( 0 ) by L576 , L578 , L579 , NEWTON:5;
L581: ( dom ( ( SetPrimes ) --> ( 0 ) ) ) = ( SetPrimes ) by FUNCOP_1:13;
L582: C110 in ( dom ( ( SetPrimes ) --> ( 0 ) ) ) by L581 , NEWTON:def 6;
set D36 = ( ( ( SetPrimes ) --> ( 0 ) ) +* (C110 , C110) );
L583: C110 is (Element of ( NAT )) by ORDINAL1:def 12;
L584: (ex B99 being (bag of ( SetPrimes )) st (B99 = D36 & ( support B99 ) = { C110 } & ( Product B99 ) = C110)) by L583 , L501;
L585: { C110 } c= ( support C109 ) by L575 , ZFMISC_1:31;
consider C113 , C114 being (bag of ( SetPrimes )) such that L586: ( support C113 ) = ( ( support C109 ) \ { C110 } ) and L587: ( support C114 ) = { C110 } and L588: ( support C113 ) misses ( support C114 ) and L589: ( C113 | ( support C113 ) ) = ( C109 | ( support C113 ) ) and L590: ( C114 | ( support C114 ) ) = ( C109 | ( support C114 ) ) and L591: ( C113 + C114 ) = C109 by L585 , L110;
L592: C110 in ( support C114 ) by L587 , TARSKI:def 1;
L593: ( C114 . C110 ) = ( ( C114 | ( support C114 ) ) . C110 ) by L592 , FUNCT_1:49
.= ( C109 . C110 ) by L590 , L592 , FUNCT_1:49;
L594: ( ( C114 . C110 ) / C110 ) = ( ( ( C110 |^ C112 ) * C110 ) / C110 ) by L593 , L578 , L579 , NEWTON:6
.= ( C110 |^ C112 ) by XCMPLX_1:89;
reconsider D37 = ( ( C114 . C110 ) / C110 ) as (Element of ( NAT )) by L594 , ORDINAL1:def 12;
set D38 = ( ( ( SetPrimes ) --> ( 0 ) ) +* (C110 , D37) );
L595: D37 <> ( 0 )
proof
assume L596: D37 = ( 0 );
L597: ( C114 . C110 ) = ( D37 * C110 ) by XCMPLX_1:87
.= ( 0 ) by L596;
thus L598: contradiction by L597 , L578 , L593;
end;
consider C115 being (bag of ( SetPrimes )) such that L599: C115 = D38 and L600: ( support C115 ) = { C110 } and L601: ( Product C115 ) = D37 by L595 , L501;
set D39 = ( C113 + C115 );
L602: C114 = ( ( ( SetPrimes ) --> ( 0 ) ) +* (C110 , ( C114 . C110 )) ) by L587 , L11;
L603:
now
let C116 being set;
L604: ( D39 . C116 ) = ( ( C113 . C116 ) + ( C115 . C116 ) ) by PRE_POLY:def 5;
assume L605: C116 in ( ( support D39 ) \ { C110 } );
L606: (not C116 in { C110 }) by L605 , XBOOLE_0:def 5;
L607: ( C115 . C116 ) = ( 0 ) by L606 , L600 , PRE_POLY:def 7;
L608: C116 in ( support D39 ) by L605 , XBOOLE_0:def 5;
L609: C116 in ( ( support C113 ) \/ ( support C115 ) ) by L608 , PRE_POLY:38;
L610: (C116 in ( support C113 ) or C116 in ( support C115 )) by L609 , XBOOLE_0:def 3;
L611: ( C113 . C116 ) = ( ( C113 | ( support C113 ) ) . C116 ) by L610 , L600 , L605 , FUNCT_1:49 , XBOOLE_0:def 5
.= ( C109 . C116 ) by L589 , L600 , L605 , L610 , FUNCT_1:49 , XBOOLE_0:def 5;
thus L612: ( D39 . C116 ) = ( C109 . C116 ) by L611 , L604 , L607;
end;
L613: ( dom D39 ) = ( SetPrimes ) by PARTFUN1:def 2
.= ( dom C109 ) by PARTFUN1:def 2;
L614: ( D39 | ( ( support D39 ) \ { C110 } ) ) = ( C109 | ( ( support D39 ) \ { C110 } ) ) by L613 , L603 , FUNCT_1:96;
L615: ( ( support C113 ) /\ ( support C114 ) ) = ( {} ) by L588 , XBOOLE_0:def 7;
L616:
now
let C117 being Prime;
L617: ( D39 . C117 ) = ( ( C113 . C117 ) + ( C115 . C117 ) ) by PRE_POLY:def 5;
assume L618: C117 in ( support D39 );
L619: C117 in ( ( support C113 ) \/ ( support C115 ) ) by L618 , PRE_POLY:38;
per cases  by L619 , XBOOLE_0:def 3;
suppose L620: C117 in ( support C113 );

L621: (not C117 in { C110 }) by L620 , L586 , XBOOLE_0:def 5;
L622: ( C115 . C117 ) = ( 0 ) by L621 , L600 , PRE_POLY:def 7;
L623: ( support C113 ) c= ( support C109 ) by L586 , XBOOLE_1:36;
L624: ( C113 . C117 ) = ( ( C113 | ( support C113 ) ) . C117 ) by L620 , FUNCT_1:49
.= ( C109 . C117 ) by L589 , L620 , FUNCT_1:49;
thus L625: (ex B100 being Nat st (( 0 ) < B100 & ( D39 . C117 ) = ( C117 |^ B100 ))) by L624 , L574 , L617 , L620 , L623 , L622 , L197;
end;
suppose L626: C117 in ( support C115 );

take D40 = C112;
thus L627: ( 0 ) < D40 by L580;
L628: C117 = C110 by L600 , L626 , TARSKI:def 1;
L629: (not C117 in ( support C113 )) by L587 , L615 , L600 , L626 , XBOOLE_0:def 4;
L630: ( D39 . C117 ) = ( ( C113 . C117 ) + ( C115 . C117 ) ) by PRE_POLY:def 5
.= ( ( 0 ) + ( C115 . C117 ) ) by L629 , PRE_POLY:def 7
.= ( C117 |^ D40 ) by L594 , L599 , L581 , L626 , L628 , FUNCT_7:31;
thus L631: ( D39 . C117 ) = ( C117 |^ D40 ) by L630;
end;
end;
L633: D39 is  prime-factorization-like by L616 , L197;
L634: C110 in { C110 } by TARSKI:def 1;
L635: (not C110 in ( support C113 )) by L634 , L586 , XBOOLE_0:def 5;
L636: ( D39 . C110 ) = ( ( C113 . C110 ) + ( C115 . C110 ) ) by PRE_POLY:def 5
.= ( ( 0 ) + ( C115 . C110 ) ) by L635 , PRE_POLY:def 7
.= D37 by L599 , L582 , FUNCT_7:31;
L637: ( C109 . C110 ) = ( ( D39 . C110 ) * C110 ) by L636 , L593 , XCMPLX_1:87;
L638: ( C114 . C110 ) = ( D37 * C110 ) by XCMPLX_1:87;
L639: (ex B101 being (bag of ( SetPrimes )) st (B101 = C114 & ( support B101 ) = { C110 } & ( Product B101 ) = ( D37 * C110 ))) by L638 , L578 , L593 , L602 , L501;
L640: ( Product C109 ) = ( ( Product C113 ) * ( ( Product C115 ) * C110 ) ) by L639 , L588 , L591 , L601 , NAT_3:19
.= ( ( ( Product C113 ) * ( Product C115 ) ) * C110 )
.= ( ( Product D39 ) * C110 ) by L587 , L588 , L600 , NAT_3:19;
L641: ( support D39 ) = ( ( ( support C109 ) \ { C110 } ) \/ { C110 } ) by L586 , L600 , PRE_POLY:38
.= ( ( support C109 ) \/ { C110 } ) by XBOOLE_1:39
.= ( support C109 ) by L585 , XBOOLE_1:12;
thus L642: thesis by L641 , L584 , L637 , L640 , L633 , L614;
end;
theorem
L643: (for B102 being (bag of ( SetPrimes )) holds (B102 is  prime-factorization-like implies ( Product B102 ) <> ( 0 )))
proof
let C118 being (bag of ( SetPrimes ));
assume L644: C118 is  prime-factorization-like;
L645: ( rng ( canFS ( support C118 ) ) ) = ( support C118 ) by FUNCT_2:def 3;
consider C119 being (FinSequence of ( COMPLEX )) such that L646: ( Product C118 ) = ( Product C119 ) and L647: C119 = ( C118 * ( canFS ( support C118 ) ) ) by NAT_3:def 5;
reconsider D41 = C119 as  complex-yielding FinSequence;
assume L648: ( Product C118 ) = ( 0 );
consider C120 being Nat such that L649: C120 in ( dom D41 ) and L650: ( D41 . C120 ) = ( 0 ) by L648 , L646 , RVSUM_1:103;
L651: C120 in ( dom ( canFS ( support C118 ) ) ) by L647 , L649 , FUNCT_1:11;
L652: ( ( canFS ( support C118 ) ) . C120 ) in ( support C118 ) by L651 , L645 , FUNCT_1:3;
reconsider D42 = ( ( canFS ( support C118 ) ) . C120 ) as Prime by L652 , NEWTON:def 6;
L653: (ex B103 being Nat st (( 0 ) < B103 & ( C118 . D42 ) = ( D42 |^ B103 ))) by L644 , L652 , L197;
thus L654: contradiction by L653 , L647 , L649 , L650 , FUNCT_1:12;
end;
theorem
L655: (for B104 being (bag of ( SetPrimes )) holds (B104 is  prime-factorization-like implies (( Product B104 ) = 1 iff ( support B104 ) = ( {} ))))
proof
let C121 being (bag of ( SetPrimes ));
assume L656: C121 is  prime-factorization-like;
L657:
now
assume L658: ( Product C121 ) = 1;
thus L659: ( support C121 ) = ( {} )
proof
assume L660: ( support C121 ) <> ( {} );
consider C122 being set such that L661: C122 in ( support C121 ) by L660 , XBOOLE_0:def 1;
L662: C122 in ( SetPrimes ) by L661;
reconsider D43 = C122 as (Element of ( NAT )) by L662;
reconsider D44 = D43 as Prime by L661 , NEWTON:def 6;
L663: D44 = 1 by L656 , L658 , L661 , L212 , WSIERP_1:15;
thus L664: contradiction by L663 , INT_2:def 4;
end;

end;
L660:
now
consider C123 being (FinSequence of ( COMPLEX )) such that L661: ( Product C121 ) = ( Product C123 ) and L662: C123 = ( C121 * ( canFS ( support C121 ) ) ) by NAT_3:def 5;
assume L663: ( support C121 ) = ( {} );
thus L664: ( Product C121 ) = 1 by L663 , L661 , L662 , RVSUM_1:94;
end;
thus L665: thesis by L660 , L657;
end;
L666: (for B105 being (Element of ( NAT )) holds (for B106 , B107 being (bag of ( SetPrimes )) holds ((B106 is  prime-factorization-like & B107 is  prime-factorization-like & ( Product B106 ) <= ( 2 |^ B105 ) & ( Product B106 ) = ( Product B107 )) implies B106 = B107)))
proof
defpred S4[ (Element of ( NAT )) ] means (for B108 , B109 being (bag of ( SetPrimes )) holds ((B108 is  prime-factorization-like & B109 is  prime-factorization-like & ( Product B108 ) <= ( 2 |^ $1 ) & ( Product B108 ) = ( Product B109 )) implies B108 = B109));
L667:
now
let C124 being (Element of ( NAT ));
assume L668: S4[ C124 ];
L669:
now
let C125 , C126 being (bag of ( SetPrimes ));
assume that
L670: C125 is  prime-factorization-like
and
L671: C126 is  prime-factorization-like
and
L672: ( Product C125 ) <= ( 2 |^ ( C124 + 1 ) )
and
L673: ( Product C125 ) = ( Product C126 );
L674:
now
per cases ;
suppose L675: ( support C125 ) = ( {} );

L676: ( Product C125 ) = 1 by L675 , L670 , L655;
L677: ( support C126 ) = ( {} ) by L676 , L671 , L673 , L655;
thus L678: C125 = C126 by L677 , L675 , L64;
end;
suppose L679: ( support C125 ) <> ( {} );

consider C127 being set such that L680: C127 in ( support C125 ) by L679 , XBOOLE_0:def 1;
reconsider D45 = C127 as Prime by L680 , NEWTON:def 6;
L681: D45 divides ( Product C125 ) by L670 , L680 , L212;
L682: D45 in ( support C126 ) by L681 , L671 , L673 , L404;
per cases ;
suppose L683: ( C125 . D45 ) <> D45;

consider C128 , C129 being (bag of ( SetPrimes )) such that L684: C128 is  prime-factorization-like and L685: ( support C129 ) = { D45 } and L686: ( Product C129 ) = D45 and L687: ( support C128 ) = ( support C125 ) and L688: ( C128 | ( ( support C128 ) \ { D45 } ) ) = ( C125 | ( ( support C128 ) \ { D45 } ) ) and L689: ( C125 . D45 ) = ( ( C128 . D45 ) * D45 ) and L690: ( Product C125 ) = ( ( Product C128 ) * D45 ) by L683 , L670 , L680 , L573;
per cases ;
suppose L691: ( C126 . D45 ) <> D45;

L692: 1 < D45 by INT_2:def 4;
L693: ( 1 + 1 ) <= D45 by L692 , NAT_1:13;
L694: ( ( 2 |^ ( C124 + 1 ) ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L693 , XREAL_1:118;
consider C130 , C131 being (bag of ( SetPrimes )) such that L695: C130 is  prime-factorization-like and L696: ( support C131 ) = { D45 } and L697: ( Product C131 ) = D45 and L698: ( support C130 ) = ( support C126 ) and L699: ( C130 | ( ( support C130 ) \ { D45 } ) ) = ( C126 | ( ( support C130 ) \ { D45 } ) ) and L700: ( C126 . D45 ) = ( ( C130 . D45 ) * D45 ) and L701: ( Product C126 ) = ( ( Product C130 ) * D45 ) by L671 , L673 , L681 , L691 , L404 , L573;
L702: ( ( ( Product C128 ) * D45 ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / D45 ) by L672 , L690 , XREAL_1:72;
L703: ( ( ( Product C128 ) * D45 ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L702 , L694 , XXREAL_0:2;
L704: ( Product C128 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L703 , XCMPLX_1:89;
L705: ( Product C128 ) <= ( ( ( 2 |^ C124 ) * ( 2 |^ 1 ) ) / 2 ) by L704 , NEWTON:8;
L706: ( Product C128 ) <= ( ( ( 2 |^ C124 ) * 2 ) / 2 ) by L705 , NEWTON:5;
L707: C128 = C130 by L706 , L668 , L673 , L684 , L690 , L695 , L701 , XCMPLX_1:5;
L708:
now
let C132 being set;
assume L709: C132 in ( support C125 );
per cases ;
suppose L710: (not C132 in { D45 });

L711: C132 in ( ( support C128 ) \ { D45 } ) by L710 , L687 , L709 , XBOOLE_0:def 5;
thus L712: ( C125 . C132 ) = ( ( C125 | ( ( support C128 ) \ { D45 } ) ) . C132 ) by L711 , FUNCT_1:49
.= ( C126 . C132 ) by L688 , L699 , L707 , L711 , FUNCT_1:49;
end;
suppose L713: C132 in { D45 };

thus L714: ( C125 . C132 ) = ( ( C128 . D45 ) * D45 ) by L713 , L689 , TARSKI:def 1
.= ( ( C130 . D45 ) * D45 ) by L668 , L673 , L684 , L690 , L695 , L701 , L706 , XCMPLX_1:5
.= ( C126 . C132 ) by L700 , L713 , TARSKI:def 1;
end;
end;
L716: ( dom C125 ) = ( SetPrimes ) by PARTFUN1:def 2
.= ( dom C126 ) by PARTFUN1:def 2;
L717: ( support C125 ) = ( support C126 ) by L668 , L673 , L684 , L687 , L690 , L695 , L698 , L701 , L706 , XCMPLX_1:5;
L718: ( C125 | ( support C125 ) ) = ( C126 | ( support C126 ) ) by L717 , L716 , L708 , FUNCT_1:96;
thus L719: C125 = C126 by L718 , L50;
end;
suppose L720: ( C126 . D45 ) = D45;

L721: 1 < D45 by INT_2:def 4;
L722: ( 1 + 1 ) <= D45 by L721 , NAT_1:13;
L723: ( ( 2 |^ ( C124 + 1 ) ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L722 , XREAL_1:118;
L724: ( ( ( Product C128 ) * D45 ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / D45 ) by L672 , L690 , XREAL_1:72;
L725: ( ( ( Product C128 ) * D45 ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L724 , L723 , XXREAL_0:2;
L726: ( Product C128 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L725 , XCMPLX_1:89;
L727: ( Product C128 ) <= ( ( ( 2 |^ C124 ) * ( 2 |^ 1 ) ) / 2 ) by L726 , NEWTON:8;
L728: ( Product C128 ) <= ( ( ( 2 |^ C124 ) * 2 ) / 2 ) by L727 , NEWTON:5;
L729: (ex B110 , B111 being (bag of ( SetPrimes )) st (B110 is  prime-factorization-like & ( support B111 ) = { D45 } & ( Product B111 ) = D45 & ( support B110 ) = ( ( support C126 ) \ { D45 } ) & ( B110 | ( support B110 ) ) = ( C126 | ( support B110 ) ) & ( Product C126 ) = ( ( Product B110 ) * D45 ))) by L671 , L673 , L681 , L720 , L404 , L537;
L730: ( support C125 ) = ( ( support C126 ) \ { D45 } ) by L729 , L668 , L673 , L684 , L687 , L690 , L728 , XCMPLX_1:5;
L731: (not D45 in { D45 }) by L730 , L680 , XBOOLE_0:def 5;
thus L732: C125 = C126 by L731 , TARSKI:def 1;
end;
end;
suppose L734: ( C125 . D45 ) = D45;

consider C133 , C134 being (bag of ( SetPrimes )) such that L735: C133 is  prime-factorization-like and L736: ( support C134 ) = { D45 } and L737: ( Product C134 ) = D45 and L738: ( support C133 ) = ( ( support C125 ) \ { D45 } ) and L739: ( C133 | ( support C133 ) ) = ( C125 | ( support C133 ) ) and L740: ( Product C125 ) = ( ( Product C133 ) * D45 ) by L734 , L670 , L680 , L537;
per cases ;
suppose L741: ( C126 . D45 ) <> D45;

L742: 1 < D45 by INT_2:def 4;
L743: ( 1 + 1 ) <= D45 by L742 , NAT_1:13;
L744: ( ( 2 |^ ( C124 + 1 ) ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L743 , XREAL_1:118;
L745: ( ( ( Product C133 ) * D45 ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / D45 ) by L672 , L740 , XREAL_1:72;
L746: ( ( ( Product C133 ) * D45 ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L745 , L744 , XXREAL_0:2;
L747: ( Product C133 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L746 , XCMPLX_1:89;
L748: ( Product C133 ) <= ( ( ( 2 |^ C124 ) * ( 2 |^ 1 ) ) / 2 ) by L747 , NEWTON:8;
L749: ( Product C133 ) <= ( ( ( 2 |^ C124 ) * 2 ) / 2 ) by L748 , NEWTON:5;
L750: (ex B112 , B113 being (bag of ( SetPrimes )) st (B112 is  prime-factorization-like & ( support B113 ) = { D45 } & ( Product B113 ) = D45 & ( support B112 ) = ( support C126 ) & ( B112 | ( ( support B112 ) \ { D45 } ) ) = ( C126 | ( ( support B112 ) \ { D45 } ) ) & ( C126 . D45 ) = ( ( B112 . D45 ) * D45 ) & ( Product C126 ) = ( ( Product B112 ) * D45 ))) by L671 , L673 , L681 , L741 , L404 , L573;
L751: ( ( support C125 ) \ { D45 } ) = ( support C126 ) by L750 , L668 , L673 , L735 , L738 , L740 , L749 , XCMPLX_1:5;
L752: (not D45 in { D45 }) by L751 , L682 , XBOOLE_0:def 5;
thus L753: C125 = C126 by L752 , TARSKI:def 1;
end;
suppose L754: ( C126 . D45 ) = D45;

L755: 1 < D45 by INT_2:def 4;
L756: ( 1 + 1 ) <= D45 by L755 , NAT_1:13;
L757: ( ( 2 |^ ( C124 + 1 ) ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L756 , XREAL_1:118;
consider C135 , C136 being (bag of ( SetPrimes )) such that L758: C135 is  prime-factorization-like and L759: ( support C136 ) = { D45 } and L760: ( Product C136 ) = D45 and L761: ( support C135 ) = ( ( support C126 ) \ { D45 } ) and L762: ( C135 | ( support C135 ) ) = ( C126 | ( support C135 ) ) and L763: ( Product C126 ) = ( ( Product C135 ) * D45 ) by L671 , L673 , L681 , L754 , L404 , L537;
L764: ( ( ( Product C133 ) * D45 ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / D45 ) by L672 , L740 , XREAL_1:72;
L765: ( ( ( Product C133 ) * D45 ) / D45 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L764 , L757 , XXREAL_0:2;
L766: ( Product C133 ) <= ( ( 2 |^ ( C124 + 1 ) ) / 2 ) by L765 , XCMPLX_1:89;
L767: ( Product C133 ) <= ( ( ( 2 |^ C124 ) * ( 2 |^ 1 ) ) / 2 ) by L766 , NEWTON:8;
L768: ( Product C133 ) <= ( ( ( 2 |^ C124 ) * 2 ) / 2 ) by L767 , NEWTON:5;
L769: ( ( support C125 ) \ { D45 } ) = ( ( support C126 ) \ { D45 } ) by L768 , L668 , L673 , L735 , L738 , L740 , L758 , L761 , L763 , XCMPLX_1:5;
L770: ( ( support C125 ) \/ { D45 } ) = ( ( ( support C126 ) \ { D45 } ) \/ { D45 } ) by L769 , XBOOLE_1:39;
L771: ( ( support C125 ) \/ { D45 } ) = ( ( support C126 ) \/ { D45 } ) by L770 , XBOOLE_1:39;
L772: C133 = C135 by L668 , L673 , L735 , L740 , L758 , L763 , L768 , XCMPLX_1:5;
L773:
now
let C137 being set;
assume L774: C137 in ( support C125 );
per cases ;
suppose L775: (not C137 in { D45 });

L776: C137 in ( support C133 ) by L775 , L738 , L774 , XBOOLE_0:def 5;
thus L777: ( C125 . C137 ) = ( ( C133 | ( support C133 ) ) . C137 ) by L776 , L739 , FUNCT_1:49
.= ( C126 . C137 ) by L762 , L772 , L776 , FUNCT_1:49;
end;
suppose L778: C137 in { D45 };

thus L779: ( C125 . C137 ) = D45 by L778 , L734 , TARSKI:def 1
.= ( C126 . C137 ) by L754 , L778 , TARSKI:def 1;
end;
end;
L781: { D45 } c= ( support C126 ) by L682 , ZFMISC_1:31;
L782: { D45 } c= ( support C125 ) by L680 , ZFMISC_1:31;
L783: ( support C125 ) = ( ( support C126 ) \/ { D45 } ) by L782 , L771 , XBOOLE_1:12;
L784: ( dom C125 ) = ( SetPrimes ) by PARTFUN1:def 2
.= ( dom C126 ) by PARTFUN1:def 2;
L785: ( C125 | ( support C125 ) ) = ( C126 | ( support C125 ) ) by L784 , L773 , FUNCT_1:96
.= ( C126 | ( support C126 ) ) by L781 , L783 , XBOOLE_1:12;
thus L786: C125 = C126 by L785 , L50;
end;
end;
end;
end;
thus L790: C125 = C126 by L674;
end;
thus L791: S4[ ( C124 + 1 ) ] by L669;
end;
L792: S4[ ( 0 ) ]
proof
let C138 , C139 being (bag of ( SetPrimes ));
assume that
L793: C138 is  prime-factorization-like
and
L794: C139 is  prime-factorization-like
and
L795: ( Product C138 ) <= ( 2 |^ ( 0 ) )
and
L796: ( Product C138 ) = ( Product C139 );
L797: ( Product C138 ) <> ( 0 ) by L793 , L643;
L798: ( ( 0 ) + 1 ) <= ( Product C138 ) by L797 , NAT_1:13;
L799: ( Product C138 ) <= 1 by L795 , NEWTON:4;
L800: ( Product C138 ) = 1 by L799 , L798 , XXREAL_0:1;
L801: ( support C138 ) = ( {} ) by L800 , L793 , L655;
L802: ( support C139 ) = ( {} ) by L794 , L796 , L800 , L655;
thus L803: thesis by L802 , L801 , L64;
end;
L804: (for B114 being (Element of ( NAT )) holds S4[ B114 ]) from NAT_1:sch 1(L792 , L667);
thus L805: thesis by L804;
end;
::$N Fundamental Theorem of Arithmetic (uniqueness)
theorem
L806: (for B115 , B116 being (bag of ( SetPrimes )) holds ((B115 is  prime-factorization-like & B116 is  prime-factorization-like & ( Product B115 ) = ( Product B116 )) implies B115 = B116))
proof
let C140 , C141 being (bag of ( SetPrimes ));
assume that
L807: C140 is  prime-factorization-like
and
L808: C141 is  prime-factorization-like
and
L809: ( Product C140 ) = ( Product C141 );
reconsider D46 = ( Product C140 ) as (Element of ( NAT ));
L810: D46 <= ( 2 |^ D46 ) by NEWTON:86;
thus L811: thesis by L810 , L807 , L808 , L809 , L666;
end;
theorem
L812: (for B117 being (bag of ( SetPrimes )) holds (for B118 being non  empty Nat holds ((B117 is  prime-factorization-like & B118 = ( Product B117 )) implies ( ppf B118 ) = B117)))
proof
let C142 being (bag of ( SetPrimes ));
let C143 being non  empty Nat;
assume that
L813: C142 is  prime-factorization-like
and
L814: C143 = ( Product C142 );
L815: ( Product ( ppf C143 ) ) = ( Product C142 ) by L814 , NAT_3:61;
thus L816: thesis by L815 , L813 , L806;
end;
theorem
L817: (for B119 , B120 being (Element of ( NAT )) holds ((1 <= B119 & 1 <= B120) implies (ex B121 , B122 being (Element of ( NAT )) st (( B119 lcm B120 ) = ( B122 * B121 ) & ( B122 gcd B121 ) = 1 & B122 divides B119 & B121 divides B120 & B122 <> ( 0 ) & B121 <> ( 0 )))))
proof
let C144 , C145 being (Element of ( NAT ));
assume that
L818: 1 <= C144
and
L819: 1 <= C145;
reconsider D47 = C144 , D48 = C145 as non  empty Nat by L818 , L819;
set D49 = ( C144 lcm C145 );
reconsider D50 = D49 as non  empty Nat by L818 , L819 , INT_2:4;
set D51 = { B123 where B123 is (Element of ( NAT )) : (B123 in ( support ( ppf D47 ) ) & ( ( pfexp D50 ) . B123 ) = ( ( pfexp D47 ) . B123 )) };
set D52 = ( ( support ( ppf D50 ) ) \ D51 );
L820: D51 c= ( support ( ppf D47 ) )
proof
let C146 being set;
assume L821: C146 in D51;
L822: (ex B124 being (Element of ( NAT )) st (C146 = B124 & B124 in ( support ( ppf D47 ) ) & ( ( pfexp D50 ) . B124 ) = ( ( pfexp D47 ) . B124 ))) by L821;
thus L823: thesis by L822;
end;
L824: (for B125 being set holds (B125 in D52 implies ( ( pfexp D50 ) . B125 ) = ( ( pfexp D48 ) . B125 )))
proof
let C147 being set;
L825: (( ( pfexp D47 ) . C147 ) > ( ( pfexp D48 ) . C147 ) implies ( ( max (( pfexp D47 ) , ( pfexp D48 )) ) . C147 ) = ( ( pfexp D47 ) . C147 )) by NAT_3:def 4;
assume L826: C147 in D52;
L827: (not C147 in D51) by L826 , XBOOLE_0:def 5;
L828: ( support ( ppf D47 ) ) = ( support ( pfexp D47 ) ) by NAT_3:def 9;
L829: (not ( ( pfexp D47 ) . C147 ) > ( ( pfexp D48 ) . C147 ))
proof
assume L830: ( ( pfexp D47 ) . C147 ) > ( ( pfexp D48 ) . C147 );
L831: ( ( pfexp D50 ) . C147 ) = ( ( pfexp D47 ) . C147 ) by L830 , L825 , NAT_3:54;
L832: C147 in ( support ( pfexp D47 ) ) by L830 , PRE_POLY:def 7;
L833: C147 in ( SetPrimes ) by L832;
thus L834: contradiction by L833 , L827 , L828 , L831 , L832;
end;
L835: (( ( pfexp D47 ) . C147 ) <= ( ( pfexp D48 ) . C147 ) implies ( ( max (( pfexp D47 ) , ( pfexp D48 )) ) . C147 ) = ( ( pfexp D48 ) . C147 )) by NAT_3:def 4;
thus L836: thesis by L835 , L829 , NAT_3:54;
end;
L837: ( Product ( ppf D48 ) ) = D48 by NAT_3:61;
L838: ( support ( ppf D50 ) ) = ( ( support ( ppf D47 ) ) \/ ( support ( ppf D48 ) ) ) by L429;
L839: ( support ( ppf D47 ) ) c= ( support ( ppf D50 ) ) by L838 , XBOOLE_1:7;
consider C148 , C149 being (bag of ( SetPrimes )) such that L840: ( support C148 ) = ( ( support ( ppf D50 ) ) \ D51 ) and L841: ( support C149 ) = D51 and L842: ( support C148 ) misses ( support C149 ) and L843: ( C148 | ( support C148 ) ) = ( ( ppf D50 ) | ( support C148 ) ) and L844: ( C149 | ( support C149 ) ) = ( ( ppf D50 ) | ( support C149 ) ) and L845: ( C148 + C149 ) = ( ppf D50 ) by L839 , L820 , L110 , XBOOLE_1:1;
reconsider D53 = ( Product C149 ) , D54 = ( Product C148 ) as (Element of ( NAT ));
L846: ( Product ( ppf D47 ) ) = D47 by NAT_3:61;
L847: D52 c= ( support ( ppf D48 ) )
proof
let C150 being set;
L848: (( ( pfexp D47 ) . C150 ) <= ( ( pfexp D48 ) . C150 ) implies ( ( max (( pfexp D47 ) , ( pfexp D48 )) ) . C150 ) = ( ( pfexp D48 ) . C150 )) by NAT_3:def 4;
L849: (( ( pfexp D47 ) . C150 ) > ( ( pfexp D48 ) . C150 ) implies ( ( max (( pfexp D47 ) , ( pfexp D48 )) ) . C150 ) = ( ( pfexp D47 ) . C150 )) by NAT_3:def 4;
assume L850: C150 in D52;
L851: C150 in ( SetPrimes ) by L850;
L852: C150 in ( support ( ppf D50 ) ) by L850 , XBOOLE_0:def 5;
L853: C150 in ( support ( pfexp D50 ) ) by L852 , NAT_3:def 9;
L854: (( ( pfexp D50 ) . C150 ) = ( ( pfexp D48 ) . C150 ) implies ( ( pfexp D48 ) . C150 ) <> ( 0 )) by L853 , PRE_POLY:def 7;
L855: (not C150 in D51) by L850 , XBOOLE_0:def 5;
L856: ((not C150 in ( support ( ppf D47 ) )) or ( ( pfexp D50 ) . C150 ) <> ( ( pfexp D47 ) . C150 )) by L855 , L851;
L857: ( support ( ppf D48 ) ) = ( support ( pfexp D48 ) ) by NAT_3:def 9;
thus L858: thesis by L857 , L838 , L852 , L856 , L848 , L849 , L854 , NAT_3:54 , PRE_POLY:def 7 , XBOOLE_0:def 3;
end;
L859: ( D51 \/ D52 ) = ( support ( ppf D50 ) ) by L839 , L820 , XBOOLE_1:1 , XBOOLE_1:45;
L860: D52 c= ( support ( ppf D50 ) ) by L859 , XBOOLE_1:7;
L861:
now
let C151 being set;
assume L862: C151 in D52;
reconsider D55 = C151 as Prime by L862 , NEWTON:def 6;
L863: C151 in ( support ( ppf D48 ) ) by L847 , L862;
L864: C151 in ( support ( pfexp D48 ) ) by L863 , NAT_3:def 9;
L865: C151 in ( support ( ppf D50 ) ) by L860 , L862;
L866: C151 in ( support ( pfexp D50 ) ) by L865 , NAT_3:def 9;
thus L867: ( ( ppf D50 ) . C151 ) = ( D55 |^ ( D55 |-count D50 ) ) by L866 , NAT_3:def 9
.= ( D55 |^ ( ( pfexp D50 ) . D55 ) ) by NAT_3:def 8
.= ( D55 |^ ( ( pfexp D48 ) . D55 ) ) by L824 , L862
.= ( D55 |^ ( D55 |-count D48 ) ) by NAT_3:def 8
.= ( ( ppf D48 ) . C151 ) by L864 , NAT_3:def 9;
end;
L868: ( dom ( ppf D50 ) ) = ( SetPrimes ) by PARTFUN1:def 2
.= ( dom ( ppf D48 ) ) by PARTFUN1:def 2;
L869: ( C148 | D52 ) = ( ( ppf D48 ) | D52 ) by L868 , L840 , L843 , L861 , FUNCT_1:96;
L870: D54 divides D48 by L869 , L847 , L837 , L840 , L419;
L871: ( D53 * D54 ) = ( Product ( ppf D50 ) ) by L842 , L845 , NAT_3:19
.= D50 by NAT_3:61;
L872: D54 <> ( 0 ) by L871;
L873:
now
let C152 being Prime;
assume L874: C152 in ( support C148 );
L875: C152 in ( support ( ppf D50 ) ) by L874 , L840 , XBOOLE_0:def 5;
L876: C152 in ( support ( pfexp D50 ) ) by L875 , NAT_3:def 9;
L877: ( ( ppf D50 ) . C152 ) = ( C152 |^ ( C152 |-count D50 ) ) by L876 , NAT_3:def 9;
L878: ( ( pfexp D50 ) . C152 ) <> ( 0 ) by L876 , NAT_3:36 , NAT_3:38;
L879: ( 0 ) < ( C152 |-count D50 ) by L878 , NAT_3:def 8;
L880: ( C148 . C152 ) = ( ( C148 | ( support C148 ) ) . C152 ) by L874 , FUNCT_1:49
.= ( ( ppf D50 ) . C152 ) by L843 , L874 , FUNCT_1:49;
thus L881: (ex B126 being Nat st (( 0 ) < B126 & ( C148 . C152 ) = ( C152 |^ B126 ))) by L880 , L877 , L879;
end;
L882: C148 is  prime-factorization-like by L873 , L197;
L883: D51 c= ( support ( ppf D50 ) ) by L839 , L820 , XBOOLE_1:1;
L884:
now
let C153 being Prime;
assume L885: C153 in ( support C149 );
L886: C153 in ( support ( ppf D50 ) ) by L885 , L883 , L841;
L887: C153 in ( support ( pfexp D50 ) ) by L886 , NAT_3:def 9;
L888: ( ( ppf D50 ) . C153 ) = ( C153 |^ ( C153 |-count D50 ) ) by L887 , NAT_3:def 9;
L889: ( ( pfexp D50 ) . C153 ) <> ( 0 ) by L887 , NAT_3:36 , NAT_3:38;
L890: ( 0 ) < ( C153 |-count D50 ) by L889 , NAT_3:def 8;
L891: ( C149 . C153 ) = ( ( C149 | ( support C149 ) ) . C153 ) by L885 , FUNCT_1:49
.= ( ( ppf D50 ) . C153 ) by L844 , L885 , FUNCT_1:49;
thus L892: (ex B127 being Nat st (( 0 ) < B127 & ( C149 . C153 ) = ( C153 |^ B127 ))) by L891 , L888 , L890;
end;
L893: C149 is  prime-factorization-like by L884 , L197;
L894: D53 , D54 are_relative_prime  by L893 , L842 , L882 , L491;
L895: ( D53 gcd D54 ) = 1 by L894 , INT_2:def 3;
L896: (for B128 being set holds (B128 in D51 implies ( ( pfexp D50 ) . B128 ) = ( ( pfexp D47 ) . B128 )))
proof
let C154 being set;
assume L897: C154 in D51;
L898: (ex B129 being (Element of ( NAT )) st (C154 = B129 & B129 in ( support ( ppf D47 ) ) & ( ( pfexp D50 ) . B129 ) = ( ( pfexp D47 ) . B129 ))) by L897;
thus L899: thesis by L898;
end;
L900:
now
let C155 being set;
assume L901: C155 in D51;
L902: C155 in ( support ( ppf D50 ) ) by L901 , L883;
reconsider D56 = C155 as Prime by L902 , NEWTON:def 6;
L903: C155 in ( support ( ppf D47 ) ) by L820 , L901;
L904: C155 in ( support ( pfexp D47 ) ) by L903 , NAT_3:def 9;
L905: C155 in ( support ( pfexp D50 ) ) by L902 , NAT_3:def 9;
thus L906: ( ( ppf D50 ) . C155 ) = ( D56 |^ ( D56 |-count D50 ) ) by L905 , NAT_3:def 9
.= ( D56 |^ ( ( pfexp D50 ) . D56 ) ) by NAT_3:def 8
.= ( D56 |^ ( ( pfexp D47 ) . D56 ) ) by L896 , L901
.= ( D56 |^ ( D56 |-count D47 ) ) by NAT_3:def 8
.= ( ( ppf D47 ) . C155 ) by L904 , NAT_3:def 9;
end;
L907: ( dom ( ppf D50 ) ) = ( SetPrimes ) by PARTFUN1:def 2
.= ( dom ( ppf D47 ) ) by PARTFUN1:def 2;
L908: ( C149 | D51 ) = ( ( ppf D47 ) | D51 ) by L907 , L841 , L844 , L900 , FUNCT_1:96;
L909: D53 <> ( 0 ) by L871;
thus L910: thesis by L909 , L820 , L846 , L841 , L908 , L871 , L870 , L872 , L895 , L419;
end;
begin
definition
let C156 being Nat;
assume L911: 1 < C156;
func Segm0 C156 -> non  empty  finite (Subset of ( NAT )) equals 
:L912: ( ( Segm C156 ) \ { ( 0 ) } );
correctness
proof
L913: (not 1 in { ( 0 ) }) by TARSKI:def 1;
L914: 1 in ( Segm C156 ) by L911 , NAT_1:44;
thus L915: thesis by L914 , L913 , XBOOLE_0:def 5;
end;
end;
theorem
L917: (for B130 being Nat holds (1 < B130 implies ( card ( Segm0 B130 ) ) = ( B130 - 1 )))
proof
let C157 being Nat;
L918: ( card ( Segm C157 ) ) = C157 by CARD_1:def 2;
assume L919: 1 < C157;
L920: ( 0 ) in ( Segm C157 ) by L919 , NAT_1:44;
L921: ( card { ( 0 ) } ) = 1 by CARD_1:30;
L922: ( Segm0 C157 ) = ( ( Segm C157 ) \ { ( 0 ) } ) by L919 , L912;
thus L923: thesis by L922 , L918 , L920 , L921 , EULER_1:4;
end;
definition
let C158 being Prime;
func multint0 C158 -> (BinOp of ( Segm0 C158 )) equals 
( ( multint C158 ) || ( Segm0 C158 ) );
coherence
proof
L924: 1 < C158 by INT_2:def 4;
L925: ( Segm0 C158 ) = ( ( Segm C158 ) \ { ( 0 ) } ) by L924 , L912;
reconsider D57 = ( Segm0 C158 ) as (Subset of ( Segm C158 )) by L925 , XBOOLE_1:36;
L926: ( multint C158 ) is (Presv of ( Segm C158 ) , D57)
proof
let C159 being set;
L927: ( 0 ) in ( Segm C158 ) by NAT_1:44;
assume L928: C159 in [: D57 , D57 :];
consider C160 , C161 being set such that L929: C160 in ( Segm0 C158 ) and L930: C161 in ( Segm0 C158 ) and L931: C159 = [ C160 , C161 ] by L928 , ZFMISC_1:def 2;
L932: C161 in ( ( Segm C158 ) \ { ( 0 ) } ) by L924 , L930 , L912;
reconsider D58 = C161 as (Element of ( INT.Ring C158 )) by L932 , XBOOLE_0:def 5;
L933: (not C161 in { ( 0 ) }) by L932 , XBOOLE_0:def 5;
L934: C161 <> ( 0 ) by L933 , TARSKI:def 1;
L935: C161 <> ( 0. ( INT.Ring C158 ) ) by L934 , L927 , FUNCT_7:def 1;
L936: C160 in ( ( Segm C158 ) \ { ( 0 ) } ) by L924 , L929 , L912;
reconsider D59 = C160 as (Element of ( INT.Ring C158 )) by L936 , XBOOLE_0:def 5;
set D60 = ( ( multint C158 ) . (C160 , C161) );
L937: D60 = ( D59 * D58 );
L938: (not C160 in { ( 0 ) }) by L936 , XBOOLE_0:def 5;
L939: C160 <> ( 0 ) by L938 , TARSKI:def 1;
L940: C160 <> ( 0. ( INT.Ring C158 ) ) by L939 , L927 , FUNCT_7:def 1;
L941: D60 <> ( In (( 0 ) , ( Segm C158 )) ) by L940 , L937 , L935 , VECTSP_1:12;
L942: D60 <> ( 0 ) by L941 , L937 , FUNCT_7:def 1;
L943: (not D60 in { ( 0 ) }) by L942 , TARSKI:def 1;
L944: D60 in ( ( Segm C158 ) \ { ( 0 ) } ) by L943 , L937 , XBOOLE_0:def 5;
thus L945: ( ( multint C158 ) . C159 ) in D57 by L944 , L924 , L931 , L912;
end;
thus L946: thesis by L926 , REALSET1:6;
end;
end;
L948: (for B131 being Prime holds (for B132 , B133 being (Element of multMagma (# ( Segm0 B131 ) , ( multint0 B131 ) #)) holds (for B134 , B135 being (Element of ( INT.Ring B131 )) holds ((B132 = B134 & B135 = B133) implies ( B134 * B135 ) = ( B132 * B133 )))))
proof
let C162 being Prime;
let C163 , C164 being (Element of multMagma (# ( Segm0 C162 ) , ( multint0 C162 ) #));
let C165 , C166 being (Element of ( INT.Ring C162 ));
assume that
L949: C163 = C165
and
L950: C166 = C164;
thus L951: ( C163 * C164 ) = ( ( multint C162 ) . [ C163 , C164 ] ) by FUNCT_1:49
.= ( C165 * C166 ) by L949 , L950;
end;
theorem
L952: (for B136 being Prime holds multMagma (# ( Segm0 B136 ) , ( multint0 B136 ) #) is  associative  commutative  Group-like)
proof
let C167 being Prime;
set D61 = multMagma (# ( Segm0 C167 ) , ( multint0 C167 ) #);
L953: (not 1 in { ( 0 ) }) by TARSKI:def 1;
L954: 1 < C167 by INT_2:def 4;
L955: 1 in ( Segm C167 ) by L954 , NAT_1:44;
L956: 1 in ( ( Segm C167 ) \ { ( 0 ) } ) by L955 , L953 , XBOOLE_0:def 5;
L957: 1 in ( Segm0 C167 ) by L956 , L954 , L912;
reconsider D62 = ( 1. ( INT.Ring C167 ) ) as (Element of D61) by L957 , L954 , INT_3:14;
L958: D61 is  associative
proof
let C168 , C169 , C170 being (Element of D61);
L959: C168 in ( Segm0 C167 );
L960: C168 in ( ( Segm C167 ) \ { ( 0 ) } ) by L959 , L954 , L912;
reconsider D63 = C168 as (Element of ( INT.Ring C167 )) by L960 , XBOOLE_0:def 5;
L961: C169 in ( Segm0 C167 );
L962: C169 in ( ( Segm C167 ) \ { ( 0 ) } ) by L961 , L954 , L912;
reconsider D64 = C169 as (Element of ( INT.Ring C167 )) by L962 , XBOOLE_0:def 5;
L963: C170 in ( Segm0 C167 );
L964: C170 in ( ( Segm C167 ) \ { ( 0 ) } ) by L963 , L954 , L912;
reconsider D65 = C170 as (Element of ( INT.Ring C167 )) by L964 , XBOOLE_0:def 5;
L965: ( C169 * C170 ) = ( D64 * D65 ) by L948;
L966: ( C168 * C169 ) = ( D63 * D64 ) by L948;
L967: ( ( C168 * C169 ) * C170 ) = ( ( D63 * D64 ) * D65 ) by L966 , L948
.= ( D63 * ( D64 * D65 ) ) by GROUP_1:def 3
.= ( C168 * ( C169 * C170 ) ) by L965 , L948;
thus L968: thesis by L967;
end;
L969:
now
let C171 being (Element of D61);
L970: C171 in ( Segm0 C167 );
L971: C171 in ( ( Segm C167 ) \ { ( 0 ) } ) by L970 , L954 , L912;
reconsider D66 = C171 as (Element of ( INT.Ring C167 )) by L971 , XBOOLE_0:def 5;
thus L972: ( C171 * D62 ) = ( D66 * ( 1_ ( INT.Ring C167 ) ) ) by L948
.= C171 by GROUP_1:def 4;
thus L973: ( D62 * C171 ) = ( ( 1_ ( INT.Ring C167 ) ) * D66 ) by L948
.= C171 by GROUP_1:def 4;
L974: (not C171 in { ( 0 ) }) by L971 , XBOOLE_0:def 5;
L975: D66 <> ( 0 ) by L974 , TARSKI:def 1;
L976: ( 0 ) in ( Segm C167 ) by NAT_1:44;
L977: D66 <> ( 0. ( INT.Ring C167 ) ) by L976 , L975 , FUNCT_7:def 1;
consider C172 being (Element of ( INT.Ring C167 )) such that L978: ( C172 * D66 ) = ( 1. ( INT.Ring C167 ) ) by L977 , VECTSP_1:def 9;
L979: C172 <> ( 0. ( INT.Ring C167 ) ) by L978 , VECTSP_1:6;
L980: C172 <> ( 0 ) by L979 , FUNCT_7:def 1;
L981: (not C172 in { ( 0 ) }) by L980 , TARSKI:def 1;
L982: C172 in ( ( Segm C167 ) \ { ( 0 ) } ) by L981 , XBOOLE_0:def 5;
reconsider D67 = C172 as (Element of D61) by L982 , L954 , L912;
L983: ( D67 * C171 ) = D62 by L978 , L948;
L984: ( C171 * D67 ) = D62 by L978 , L948;
thus L985: (ex B137 being (Element of D61) st (( C171 * B137 ) = D62 & ( B137 * C171 ) = D62)) by L984 , L983;
end;
L986: D61 is  commutative
proof
let C173 , C174 being (Element of D61);
L987: C173 in ( Segm0 C167 );
L988: C173 in ( ( Segm C167 ) \ { ( 0 ) } ) by L987 , L954 , L912;
reconsider D68 = C173 as (Element of ( INT.Ring C167 )) by L988 , XBOOLE_0:def 5;
L989: C174 in ( Segm0 C167 );
L990: C174 in ( ( Segm C167 ) \ { ( 0 ) } ) by L989 , L954 , L912;
reconsider D69 = C174 as (Element of ( INT.Ring C167 )) by L990 , XBOOLE_0:def 5;
L991: ( C173 * C174 ) = ( D68 * D69 ) by L948
.= ( C174 * C173 ) by L948;
thus L992: thesis by L991;
end;
thus L993: thesis by L986 , L969 , L958 , GROUP_1:def 2;
end;
definition
let C175 being Prime;
func Z/Z* C175 ->  commutative Group equals 
multMagma (# ( Segm0 C175 ) , ( multint0 C175 ) #);
correctness by L952;
end;
theorem
L995: (for B138 being Prime holds (for B139 , B140 being (Element of ( Z/Z* B138 )) holds (for B141 , B142 being (Element of ( INT.Ring B138 )) holds ((B139 = B141 & B140 = B142) implies ( B139 * B140 ) = ( B141 * B142 ))))) by L948;
theorem
L996: (for B143 being Prime holds (( 1_ ( Z/Z* B143 ) ) = 1 & ( 1_ ( Z/Z* B143 ) ) = ( 1. ( INT.Ring B143 ) )))
proof
let C176 being Prime;
L997: (not 1 in { ( 0 ) }) by TARSKI:def 1;
L998: 1 < C176 by INT_2:def 4;
L999: 1 in ( Segm C176 ) by L998 , NAT_1:44;
L1000: 1 in ( ( Segm C176 ) \ { ( 0 ) } ) by L999 , L997 , XBOOLE_0:def 5;
L1001: 1 in ( Segm0 C176 ) by L1000 , L998 , L912;
reconsider D70 = ( 1. ( INT.Ring C176 ) ) as (Element of ( Z/Z* C176 )) by L1001 , L998 , INT_3:14;
L1002:
now
let C177 being (Element of ( Z/Z* C176 ));
L1003: C177 in ( Segm0 C176 );
L1004: C177 in ( ( Segm C176 ) \ { ( 0 ) } ) by L1003 , L998 , L912;
reconsider D71 = C177 as (Element of ( INT.Ring C176 )) by L1004 , XBOOLE_0:def 5;
thus L1005: ( C177 * D70 ) = ( D71 * ( 1_ ( INT.Ring C176 ) ) ) by L948
.= C177 by GROUP_1:def 4;
thus L1006: ( D70 * C177 ) = ( ( 1_ ( INT.Ring C176 ) ) * D71 ) by L948
.= C177 by GROUP_1:def 4;
end;
L1007: D70 = ( 1_ ( Z/Z* C176 ) ) by L1002 , GROUP_1:def 4;
thus L1008: thesis by L1007 , L998 , INT_3:14;
end;
theorem
L1009: (for B144 being Prime holds (for B145 being (Element of ( Z/Z* B144 )) holds (for B146 being (Element of ( INT.Ring B144 )) holds (B145 = B146 implies ( B145 " ) = ( B146 " )))))
proof
let C178 being Prime;
let C179 being (Element of ( Z/Z* C178 ));
let C180 being (Element of ( INT.Ring C178 ));
assume L1010: C179 = C180;
L1011: ( 0 ) in ( Segm C178 ) by NAT_1:44;
set D72 = ( C180 " );
L1012: 1 < C178 by INT_2:def 4;
L1013: C179 in ( Segm0 C178 );
L1014: C179 in ( ( Segm C178 ) \ { ( 0 ) } ) by L1013 , L1012 , L912;
L1015: (not C179 in { ( 0 ) }) by L1014 , XBOOLE_0:def 5;
L1016: C180 <> ( 0 ) by L1015 , L1010 , TARSKI:def 1;
L1017: C180 <> ( 0. ( INT.Ring C178 ) ) by L1016 , L1011 , FUNCT_7:def 1;
L1018: ( C180 * D72 ) = ( 1. ( INT.Ring C178 ) ) by L1017 , VECTSP_1:def 10;
L1019: D72 <> ( 0. ( INT.Ring C178 ) ) by L1018 , VECTSP_1:6;
L1020: D72 <> ( 0 ) by L1019 , FUNCT_7:def 1;
L1021: (not D72 in { ( 0 ) }) by L1020 , TARSKI:def 1;
L1022: D72 in ( ( Segm C178 ) \ { ( 0 ) } ) by L1021 , XBOOLE_0:def 5;
reconsider D73 = D72 as (Element of ( Z/Z* C178 )) by L1022 , L1012 , L912;
L1023: ( C179 * D73 ) = ( C180 * D72 ) by L1010 , L948
.= ( 1. ( INT.Ring C178 ) ) by L1017 , VECTSP_1:def 10
.= ( 1_ ( Z/Z* C178 ) ) by L996;
thus L1024: thesis by L1023 , GROUP_1:def 5;
end;
registration
let C181 being Prime;
cluster ( Z/Z* C181 ) ->  finite;
coherence;
end;
theorem
L1026: (for B147 being Prime holds ( card ( Z/Z* B147 ) ) = ( B147 - 1 ))
proof
let C182 being Prime;
L1027: 1 < C182 by INT_2:def 4;
thus L1028: thesis by L1027 , L917;
end;
theorem
L1029: (for B148 being Group holds (for B149 being (Element of B148) holds (for B150 being Integer holds ((not B149 is  being_of_order_0) implies (ex B151 , B152 being (Element of ( NAT )) st (( B149 |^ B150 ) = ( B149 |^ B151 ) & B151 = ( ( B152 * ( ord B149 ) ) + B150 )))))))
proof
let C183 being Group;
let C184 being (Element of C183);
let C185 being Integer;
assume L1030: (not C184 is  being_of_order_0);
L1031: ( ord C184 ) <> ( 0 ) by L1030 , GROUP_1:def 11;
L1032: ( abs C185 ) <= ( ( abs C185 ) * ( ord C184 ) ) by L1031 , NAT_1:14 , XREAL_1:151;
L1033: ( 0 ) <= ( ( ( abs C185 ) * ( ord C184 ) ) + C185 )
proof
per cases ;
suppose L1034: C185 < ( 0 );

L1035: ( ( abs C185 ) + C185 ) <= ( ( ( abs C185 ) * ( ord C184 ) ) + C185 ) by L1032 , XREAL_1:6;
L1036: ( abs C185 ) = ( - C185 ) by L1034 , ABSVALUE:def 1;
thus L1037: thesis by L1036 , L1035;
end;
suppose L1038: ( 0 ) <= C185;

thus L1039: thesis by L1038;
end;
end;
L1041: ( ( ( abs C185 ) * ( ord C184 ) ) + C185 ) is (Element of ( NAT )) by L1033 , INT_1:3;
L1042: ( C184 |^ ( ( ( abs C185 ) * ( ord C184 ) ) + C185 ) ) = ( ( C184 |^ ( ( abs C185 ) * ( ord C184 ) ) ) * ( C184 |^ C185 ) ) by GROUP_1:33
.= ( ( ( C184 |^ ( ord C184 ) ) |^ ( abs C185 ) ) * ( C184 |^ C185 ) ) by GROUP_1:35
.= ( ( ( 1_ C183 ) |^ ( abs C185 ) ) * ( C184 |^ C185 ) ) by GROUP_1:41
.= ( ( 1_ C183 ) * ( C184 |^ C185 ) ) by GROUP_1:31
.= ( C184 |^ C185 ) by GROUP_1:def 4;
thus L1043: thesis by L1042 , L1041;
end;
theorem
L1044: (for B153 being  commutative Group holds (for B154 , B155 being (Element of B153) holds (for B156 , B157 being Nat holds ((B153 is  finite & ( ord B154 ) = B156 & ( ord B155 ) = B157 & ( B156 gcd B157 ) = 1) implies ( ord ( B154 * B155 ) ) = ( B156 * B157 )))))
proof
let C186 being  commutative Group;
let C187 , C188 being (Element of C186);
let C189 , C190 being Nat;
assume that
L1045: C186 is  finite
and
L1046: ( ord C187 ) = C189
and
L1047: ( ord C188 ) = C190
and
L1048: ( C189 gcd C190 ) = 1;
L1049: (not C188 is  being_of_order_0) by L1045 , GR_CY_1:6;
L1050: C190 <> ( 0 ) by L1049 , L1047 , GROUP_1:def 11;
L1051: (not ( C187 * C188 ) is  being_of_order_0) by L1045 , GR_CY_1:6;
L1052: ( ( C187 * C188 ) |^ ( C189 * C190 ) ) = ( ( C187 |^ ( C189 * C190 ) ) * ( C188 |^ ( C189 * C190 ) ) ) by GROUP_1:48
.= ( ( ( C187 |^ C189 ) |^ C190 ) * ( C188 |^ ( C189 * C190 ) ) ) by GROUP_1:35
.= ( ( ( C187 |^ C189 ) |^ C190 ) * ( ( C188 |^ C190 ) |^ C189 ) ) by GROUP_1:35
.= ( ( ( 1_ C186 ) |^ C190 ) * ( ( C188 |^ C190 ) |^ C189 ) ) by L1046 , GROUP_1:41
.= ( ( ( 1_ C186 ) |^ C190 ) * ( ( 1_ C186 ) |^ C189 ) ) by L1047 , GROUP_1:41
.= ( ( 1_ C186 ) * ( ( 1_ C186 ) |^ C189 ) ) by GROUP_1:31
.= ( ( 1_ C186 ) * ( 1_ C186 ) ) by GROUP_1:31
.= ( 1_ C186 ) by GROUP_1:def 4;
L1053: ( C190 * C189 ) is (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D74 = C189 , D75 = C190 as Integer;
L1054: D74 , D75 are_relative_prime  by L1048 , INT_2:def 3;
L1055: (not C187 is  being_of_order_0) by L1045 , GR_CY_1:6;
L1056: C189 <> ( 0 ) by L1055 , L1046 , GROUP_1:def 11;
L1057:
now
let C191 being Nat;
assume that
L1058: ( ( C187 * C188 ) |^ C191 ) = ( 1_ C186 )
and
L1059: C191 <> ( 0 );
reconsider D76 = C191 as Integer;
L1060: ( 1_ C186 ) = ( ( 1_ C186 ) |^ C189 ) by GROUP_1:31
.= ( ( C187 * C188 ) |^ ( C191 * C189 ) ) by L1058 , GROUP_1:35
.= ( ( C187 |^ ( C191 * C189 ) ) * ( C188 |^ ( C191 * C189 ) ) ) by GROUP_1:48
.= ( ( ( C187 |^ C189 ) |^ C191 ) * ( C188 |^ ( C191 * C189 ) ) ) by GROUP_1:35
.= ( ( ( 1_ C186 ) |^ C191 ) * ( C188 |^ ( C191 * C189 ) ) ) by L1046 , GROUP_1:41
.= ( ( 1_ C186 ) * ( C188 |^ ( C191 * C189 ) ) ) by GROUP_1:31
.= ( C188 |^ ( C191 * C189 ) ) by GROUP_1:def 4;
L1061: D75 divides D76 by L1060 , L1047 , L1054 , GROUP_1:44 , INT_2:25;
consider C192 being Integer such that L1062: D76 = ( D75 * C192 ) by L1061 , INT_1:def 3;
L1063: ( 1_ C186 ) = ( ( 1_ C186 ) |^ C190 ) by GROUP_1:31
.= ( ( C187 * C188 ) |^ ( C191 * C190 ) ) by L1058 , GROUP_1:35
.= ( ( C187 |^ ( C191 * C190 ) ) * ( C188 |^ ( C191 * C190 ) ) ) by GROUP_1:48
.= ( ( C187 |^ ( C191 * C190 ) ) * ( ( C188 |^ C190 ) |^ C191 ) ) by GROUP_1:35
.= ( ( C187 |^ ( C191 * C190 ) ) * ( ( 1_ C186 ) |^ C191 ) ) by L1047 , GROUP_1:41
.= ( ( C187 |^ ( C191 * C190 ) ) * ( 1_ C186 ) ) by GROUP_1:31
.= ( C187 |^ ( C191 * C190 ) ) by GROUP_1:def 4;
L1064: D74 divides D76 by L1063 , L1046 , L1054 , GROUP_1:44 , INT_2:25;
L1065: D74 divides C192 by L1064 , L1054 , L1062 , INT_2:25;
consider C193 being Integer such that L1066: C192 = ( D74 * C193 ) by L1065 , INT_1:def 3;
L1067: D76 = ( ( D75 * D74 ) * C193 ) by L1062 , L1066;
L1068: ( C191 / ( C190 * C189 ) ) = C193 by L1067 , L1056 , L1050 , XCMPLX_1:6 , XCMPLX_1:89;
L1069: C193 is (Element of ( NAT )) by L1068 , INT_1:3;
L1070: C193 <> ( 0 ) by L1059 , L1062 , L1066;
L1071: ( ( C190 * C189 ) * 1 ) <= ( ( C190 * C189 ) * C193 ) by L1070 , L1069 , NAT_1:14 , XREAL_1:64;
thus L1072: ( C190 * C189 ) <= C191 by L1071 , L1062 , L1066;
end;
L1073: ( C189 * C190 ) <> ( 0 ) by L1056 , L1050 , XCMPLX_1:6;
thus L1074: thesis by L1073 , L1051 , L1052 , L1053 , L1057 , GROUP_1:def 11;
end;
L1075: (for B158 being Field holds (for B159 being (Element of ( NAT )) holds (for B160 being  non-zero (Polynomial of B158) holds (( deg B160 ) = B159 implies (ex B161 being (Element of ( NAT )) st (B161 = ( card ( Roots B160 ) ) & B161 <= B159))))))
proof
let C194 being Field;
defpred S5[ Nat ] means (for B162 being  non-zero (Polynomial of C194) holds (( deg B162 ) = $1 implies (ex B163 being (Element of ( NAT )) st (B163 = ( card ( Roots B162 ) ) & B163 <= $1))));
L1076:
now
let C195 being (Element of ( NAT ));
assume L1077: S5[ C195 ];
L1078:
now
let C196 being  non-zero (Polynomial of C194);
L1079: C196 <> ( 0_. C194 ) by UPROOTS:def 5;
assume L1080: ( deg C196 ) = ( C195 + 1 );
thus L1081: (ex B164 being (Element of ( NAT )) st (B164 = ( card ( Roots C196 ) ) & B164 <= ( C195 + 1 )))
proof
per cases ;
suppose L1082: ( Roots C196 ) = ( {} );

thus L1083: thesis by L1082;
end;
suppose L1084: ( Roots C196 ) <> ( {} );

set D77 = ( Roots C196 );
consider C197 being set such that L1085: C197 in ( Roots C196 ) by L1084 , XBOOLE_0:def 1;
reconsider D78 = C197 as (Element of C194) by L1085;
set D79 = ( C196 div ( rpoly (1 , D78) ) );
L1086: D78 is_a_root_of C196 by L1085 , POLYNOM5:def 9;
L1087: ( rpoly (1 , D78) ) divides C196 by L1086 , HURWITZ:35;
L1088: ( 0_. C194 ) = ( C196 mod ( rpoly (1 , D78) ) ) by L1087 , HURWITZ:def 7;
L1089: ( D79 *' ( rpoly (1 , D78) ) ) = ( ( C196 - ( D79 *' ( rpoly (1 , D78) ) ) ) + ( D79 *' ( rpoly (1 , D78) ) ) ) by L1088 , POLYNOM3:28;
L1090: ( D79 *' ( rpoly (1 , D78) ) ) = ( C196 + ( ( - ( D79 *' ( rpoly (1 , D78) ) ) ) + ( D79 *' ( rpoly (1 , D78) ) ) ) ) by L1089 , POLYNOM3:26;
L1091: ( D79 *' ( rpoly (1 , D78) ) ) = ( C196 + ( ( D79 *' ( rpoly (1 , D78) ) ) - ( D79 *' ( rpoly (1 , D78) ) ) ) ) by L1090;
L1092: ( D79 *' ( rpoly (1 , D78) ) ) = ( C196 + ( 0_. C194 ) ) by L1091 , POLYNOM3:29;
L1093: C196 = ( D79 *' ( rpoly (1 , D78) ) ) by L1092 , POLYNOM3:28;
L1094: D79 <> ( 0_. C194 ) by L1093 , L1079 , POLYNOM3:34;
reconsider D80 = D79 as  non-zero (Polynomial of C194) by L1094 , UPROOTS:def 5;
set D81 = ( Roots D80 );
L1095: ( deg D80 ) = ( ( C195 + 1 ) - 1 ) by L1079 , L1080 , L1086 , HURWITZ:36
.= C195;
L1096: (ex B165 being (Element of ( NAT )) st (B165 = ( card ( Roots D80 ) ) & B165 <= C195)) by L1095 , L1077;
L1097: ( ( card D81 ) + 1 ) <= ( C195 + 1 ) by L1096 , XREAL_1:6;
L1098: ( Roots C196 ) c= ( ( Roots D80 ) \/ { D78 } )
proof
let C198 being set;
assume L1099: C198 in ( Roots C196 );
reconsider D82 = C198 as (Element of C194) by L1099;
L1100: D82 is_a_root_of C196 by L1099 , POLYNOM5:def 9;
L1101: ( eval (C196 , D82) ) = ( 0. C194 ) by L1100 , POLYNOM5:def 6;
L1102: ( ( eval (D80 , D82) ) * ( eval (( rpoly (1 , D78) ) , D82) ) ) = ( 0. C194 ) by L1101 , L1093 , POLYNOM4:24;
L1103: ( ( eval (D80 , D82) ) * ( D82 - D78 ) ) = ( 0. C194 ) by L1102 , HURWITZ:29;
L1104:
now
per cases ;
suppose L1105: D82 = D78;

L1106: C198 in { D78 } by L1105 , TARSKI:def 1;
thus L1107: thesis by L1106 , XBOOLE_0:def 3;
end;
suppose L1108: D82 <> D78;

L1109: ( D82 - D78 ) <> ( 0. C194 ) by L1108 , RLVECT_1:21;
L1110: ( eval (D80 , D82) ) = ( 0. C194 ) by L1109 , L1103 , VECTSP_1:12;
L1111: D82 is_a_root_of D80 by L1110 , POLYNOM5:def 6;
L1112: D82 in ( Roots D80 ) by L1111 , POLYNOM5:def 9;
thus L1113: thesis by L1112 , XBOOLE_0:def 3;
end;
end;
thus L1115: thesis by L1104;
end;
L1116: ( card D77 ) <= ( card ( D81 \/ { D78 } ) ) by L1098 , NAT_1:43;
L1117: ( card ( D81 \/ { D78 } ) ) <= ( ( card D81 ) + ( card { D78 } ) ) by CARD_2:43;
L1118: ( card ( D81 \/ { D78 } ) ) <= ( ( card D81 ) + 1 ) by L1117 , CARD_2:42;
L1119: ( card D77 ) <= ( ( card D81 ) + 1 ) by L1118 , L1116 , XXREAL_0:2;
thus L1120: thesis by L1119 , L1097 , XXREAL_0:2;
end;
end;

end;
thus L1082: S5[ ( C195 + 1 ) ] by L1078;
end;
L1083: S5[ ( 0 ) ]
proof
let C199 being  non-zero (Polynomial of C194);
assume L1084: ( deg C199 ) = ( 0 );
reconsider D83 = ( C199 . ( 0 ) ) as (Element of C194);
L1085: C199 <> ( 0_. C194 ) by UPROOTS:def 5;
L1086: ( C199 . ( 0 ) ) <> ( 0. C194 )
proof
assume L1087: ( C199 . ( 0 ) ) = ( 0. C194 );
L1088: C199 = <% ( 0. C194 ) %> by L1087 , L1084 , ALGSEQ_1:def 5;
thus L1089: contradiction by L1088 , L1085 , POLYNOM5:34;
end;
L1090:
now
let C200 being (Element of C194);
L1091: ( eval (<% D83 %> , C200) ) = ( eval (<% D83 , ( 0. C194 ) %> , C200) ) by POLYNOM5:43
.= D83 by POLYNOM5:45;
thus L1092: ( eval (<% D83 %> , C200) ) <> ( 0. C194 ) by L1091 , L1086;
end;
L1093: C199 = <% D83 %> by L1084 , ALGSEQ_1:def 5;
L1094: ( Roots C199 ) = ( {} )
proof
assume L1095: ( Roots C199 ) <> ( {} );
consider C201 being set such that L1096: C201 in ( Roots C199 ) by L1095 , XBOOLE_0:def 1;
reconsider D84 = C201 as (Element of C194) by L1096;
L1097: D84 is_a_root_of C199 by L1096 , POLYNOM5:def 9;
L1098: ( eval (<% D83 %> , D84) ) = ( 0. C194 ) by L1097 , L1093 , POLYNOM5:def 6;
thus L1099: contradiction by L1098 , L1090;
end;
thus L1100: thesis by L1094;
end;
L1101: (for B166 being (Element of ( NAT )) holds S5[ B166 ]) from NAT_1:sch 1(L1083 , L1076);
thus L1102: thesis by L1101;
end;
theorem
L1103: (for B167 being non  empty ZeroStr holds (for B168 being (Polynomial of B167) holds (( 0 ) <= ( deg B168 ) implies B168 is  non-zero)))
proof
let C202 being non  empty ZeroStr;
let C203 being (Polynomial of C202);
assume L1104: ( 0 ) <= ( deg C203 );
L1105: ( deg C203 ) <> ( - 1 ) by L1104;
L1106: C203 <> ( 0_. C202 ) by L1105 , HURWITZ:20;
thus L1107: thesis by L1106 , UPROOTS:def 5;
end;
theorem
L1108: (for B169 being Field holds (for B170 being (Polynomial of B169) holds (( 0 ) <= ( deg B170 ) implies (( Roots B170 ) is  finite  finite  finite  finite set & (ex B171 , B172 being (Element of ( NAT )) st (B172 = ( deg B170 ) & B171 = ( card ( Roots B170 ) ) & B171 <= B172))))))
proof
let C204 being Field;
let C205 being (Polynomial of C204);
assume L1109: ( 0 ) <= ( deg C205 );
reconsider D85 = ( deg C205 ) as (Element of ( NAT )) by L1109 , INT_1:3;
reconsider D86 = C205 as  non-zero (Polynomial of C204) by L1109 , L1103;
L1110: (ex B173 being (Element of ( NAT )) st (B173 = ( card ( Roots D86 ) ) & B173 <= D85)) by L1075;
thus L1111: thesis by L1110;
end;
theorem
L1112: (for B174 being Prime holds (for B175 being (Element of ( Z/Z* B174 )) holds (for B176 being (Element of ( INT.Ring B174 )) holds (B175 = B176 implies (for B177 being (Element of ( NAT )) holds ( ( power ( Z/Z* B174 ) ) . (B175 , B177) ) = ( ( power ( INT.Ring B174 ) ) . (B176 , B177) ))))))
proof
let C206 being Prime;
let C207 being (Element of ( Z/Z* C206 ));
let C208 being (Element of ( INT.Ring C206 ));
defpred S6[ Nat ] means ( ( power ( Z/Z* C206 ) ) . (C207 , $1) ) = ( ( power ( INT.Ring C206 ) ) . (C208 , $1) );
assume L1113: C207 = C208;
L1114:
now
let C209 being (Element of ( NAT ));
assume L1115: S6[ C209 ];
L1116: ( ( power ( Z/Z* C206 ) ) . (C207 , ( C209 + 1 )) ) = ( ( ( power ( Z/Z* C206 ) ) . (C207 , C209) ) * C207 ) by GROUP_1:def 7
.= ( ( ( power ( INT.Ring C206 ) ) . (C208 , C209) ) * C208 ) by L1113 , L1115 , L948
.= ( ( power ( INT.Ring C206 ) ) . (C208 , ( C209 + 1 )) ) by GROUP_1:def 7;
thus L1117: S6[ ( C209 + 1 ) ] by L1116;
end;
L1118: ( ( power ( Z/Z* C206 ) ) . (C207 , ( 0 )) ) = ( 1_ ( Z/Z* C206 ) ) by GROUP_1:def 7
.= ( 1_ ( INT.Ring C206 ) ) by L996
.= ( ( power ( INT.Ring C206 ) ) . (C208 , ( 0 )) ) by GROUP_1:def 7;
L1119: S6[ ( 0 ) ] by L1118;
L1120: (for B178 being (Element of ( NAT )) holds S6[ B178 ]) from NAT_1:sch 1(L1119 , L1114);
thus L1121: thesis by L1120;
end;
L1122: (for B179 being Prime holds (for B180 being Field holds (for B181 being Nat holds ((( 0 ) < B181 & B180 = ( INT.Ring B179 )) implies (ex B182 being (Polynomial of B180) st (( deg B182 ) = B181 & (for B183 being (Element of B180) holds (for B184 being (Element of ( Z/Z* B179 )) holds (for B185 being (Element of ( INT.Ring B179 )) holds ((B183 = B184 & B185 = ( B184 |^ B181 )) implies ( eval (B182 , B183) ) = ( B185 - ( 1_ ( INT.Ring B179 ) ) )))))))))))
proof
let C210 being Prime;
let C211 being Field;
let C212 being Nat;
assume that
L1123: ( 0 ) < C212
and
L1124: C211 = ( INT.Ring C210 );
set D87 = ( 1_. C211 );
reconsider D88 = C212 as (Element of ( NAT )) by ORDINAL1:def 12;
set D89 = ( ( <% ( 0. C211 ) , ( 1. C211 ) %> `^ D88 ) - ( 1_. C211 ) );
set D90 = ( <% ( 0. C211 ) , ( 1. C211 ) %> `^ D88 );
L1125:
now
let C213 being (Element of C211);
let C214 being (Element of ( Z/Z* C210 ));
let C215 being (Element of ( INT.Ring C210 ));
assume that
L1126: C213 = C214
and
L1127: C215 = ( C214 |^ C212 );
L1128: C215 = ( C214 |^ D88 ) by L1127
.= ( ( power C211 ) . (C213 , D88) ) by L1124 , L1126 , L1112;
thus L1129: ( eval (D89 , C213) ) = ( ( eval (D90 , C213) ) - ( eval (D87 , C213) ) ) by POLYNOM4:21
.= ( ( eval (( <% ( 0. C211 ) , ( 1. C211 ) %> `^ D88 ) , C213) ) - ( 1. C211 ) ) by POLYNOM4:18
.= ( ( ( power C211 ) . (( eval (<% ( 0. C211 ) , ( 1. C211 ) %> , C213) ) , D88) ) - ( 1. C211 ) ) by POLYNOM5:22
.= ( C215 - ( 1_ ( INT.Ring C210 ) ) ) by L1124 , L1128 , POLYNOM5:48;
end;
L1130: ( len ( 1_. C211 ) ) = 1 by POLYNOM4:4;
L1131: ( len <% ( 0. C211 ) , ( 1. C211 ) %> ) = 2 by POLYNOM5:40;
L1132: ( len ( <% ( 0. C211 ) , ( 1. C211 ) %> `^ D88 ) ) = ( ( ( C212 * 2 ) - C212 ) + 1 ) by L1131 , POLYNOM5:23
.= ( C212 + 1 );
L1133: ( ( 0 ) + 1 ) < ( C212 + 1 ) by L1123 , XREAL_1:8;
L1134: ( len ( <% ( 0. C211 ) , ( 1. C211 ) %> `^ D88 ) ) <> ( len ( - ( 1_. C211 ) ) ) by L1133 , L1132 , L1130 , POLYNOM4:8;
L1135: ( len D89 ) = ( max (( len ( <% ( 0. C211 ) , ( 1. C211 ) %> `^ D88 ) ) , ( len ( - ( 1_. C211 ) ) )) ) by L1134 , POLYNOM4:7
.= ( max (( C212 + 1 ) , 1) ) by L1132 , L1130 , POLYNOM4:8
.= ( C212 + 1 ) by L1133 , XXREAL_0:def 10;
L1136: ( deg D89 ) = C212 by L1135;
thus L1137: thesis by L1136 , L1125;
end;
theorem
L1138: (for B186 being Prime holds (for B187 , B188 being (Element of ( Z/Z* B186 )) holds (for B189 being Nat holds ((( 0 ) < B189 & ( ord B187 ) = B189 & ( B188 |^ B189 ) = 1) implies B188 is (Element of ( gr { B187 } ))))))
proof
let C216 being Prime;
let C217 , C218 being (Element of ( Z/Z* C216 ));
let C219 being Nat;
assume that
L1139: ( 0 ) < C219
and
L1140: ( ord C217 ) = C219
and
L1141: ( C218 |^ C219 ) = 1;
reconsider D91 = (the carrier of ( gr { C217 } )) as  finite set;
L1142: (ex B190 being  finite set st (B190 = (the carrier of ( gr { C217 } )) & ( card ( gr { C217 } ) ) = ( card B190 )));
reconsider D92 = ( INT.Ring C216 ) as  unital non  empty doubleLoopStr;
consider C220 being (Polynomial of D92) such that L1143: ( deg C220 ) = C219 and L1144: (for B191 being (Element of D92) holds (for B192 being (Element of ( Z/Z* C216 )) holds (for B193 being (Element of ( INT.Ring C216 )) holds ((B191 = B192 & B193 = ( B192 |^ C219 )) implies ( eval (C220 , B191) ) = ( B193 - ( 1_ ( INT.Ring C216 ) ) ))))) by L1139 , L1122;
consider C221 , C222 being (Element of ( NAT )) such that L1145: C222 = ( deg C220 ) and L1146: C221 = ( card ( Roots C220 ) ) and L1147: C221 <= C222 by L1143 , L1108;
assume L1148: (not C218 is (Element of ( gr { C217 } )));
L1149: ( card ( (the carrier of ( gr { C217 } )) \/ { C218 } ) ) = ( ( card D91 ) + 1 ) by L1148 , CARD_2:41
.= ( C222 + 1 ) by L1140 , L1143 , L1145 , L1142 , GR_CY_1:7;
L1150: ( card ( C222 + 1 ) ) = ( card ( (the carrier of ( gr { C217 } )) \/ { C218 } ) ) by L1149;
L1151: 1 < C216 by INT_2:def 4;
L1152: (for B194 being (Element of ( Z/Z* C216 )) holds (( B194 |^ C219 ) = 1 implies B194 in ( Roots C220 )))
proof
let C223 being (Element of ( Z/Z* C216 ));
assume L1153: ( C223 |^ C219 ) = 1;
L1154: ( C223 |^ C219 ) = ( 1_ ( Z/Z* C216 ) ) by L1153 , L996
.= ( 1_ ( INT.Ring C216 ) ) by L996;
L1155: ( C223 |^ C219 ) in ( Segm0 C216 );
L1156: ( C223 |^ C219 ) in ( ( Segm C216 ) \ { ( 0 ) } ) by L1155 , L1151 , L912;
reconsider D93 = ( C223 |^ C219 ) as (Element of ( INT.Ring C216 )) by L1156 , XBOOLE_0:def 5;
L1157: C223 in ( Segm0 C216 );
L1158: C223 in ( ( Segm C216 ) \ { ( 0 ) } ) by L1157 , L1151 , L912;
reconsider D94 = C223 as (Element of D92) by L1158 , XBOOLE_0:def 5;
L1159: ( eval (C220 , D94) ) = ( D93 - ( 1_ ( INT.Ring C216 ) ) ) by L1144
.= ( 0. D92 ) by L1154 , RLVECT_1:15;
L1160: D94 is_a_root_of C220 by L1159 , POLYNOM5:def 6;
thus L1161: thesis by L1160 , POLYNOM5:def 9;
end;
L1162: (the carrier of ( gr { C217 } )) c= ( Roots C220 )
proof
let C224 being set;
assume L1163: C224 in (the carrier of ( gr { C217 } ));
L1164: C224 in ( gr { C217 } ) by L1163 , STRUCT_0:def 5;
L1165: C224 in ( Z/Z* C216 ) by L1164 , GROUP_2:40;
reconsider D95 = C224 as (Element of ( Z/Z* C216 )) by L1165 , STRUCT_0:def 5;
L1166: D95 in ( gr { C217 } ) by L1163 , STRUCT_0:def 5;
consider C225 being Integer such that L1167: D95 = ( C217 |^ C225 ) by L1166 , GR_CY_1:5;
L1168: ( D95 |^ C219 ) = ( C217 |^ ( C225 * C219 ) ) by L1167 , GROUP_1:35
.= ( ( C217 |^ C219 ) |^ C225 ) by GROUP_1:35
.= ( ( 1_ ( Z/Z* C216 ) ) |^ C225 ) by L1140 , GROUP_1:41
.= ( 1_ ( Z/Z* C216 ) ) by GROUP_1:31
.= 1 by L996;
thus L1169: thesis by L1168 , L1152;
end;
L1170: C218 in ( Roots C220 ) by L1141 , L1152;
L1171: { C218 } c= ( Roots C220 ) by L1170 , ZFMISC_1:31;
L1172: ( (the carrier of ( gr { C217 } )) \/ { C218 } ) c= ( Roots C220 ) by L1171 , L1162 , XBOOLE_1:8;
L1173: ( card ( (the carrier of ( gr { C217 } )) \/ { C218 } ) ) c= ( card ( Roots C220 ) ) by L1172 , CARD_1:11;
L1174: ( card C221 ) = ( card ( Roots C220 ) ) by L1146;
L1175: ( C222 + 1 ) c= C221 by L1174 , L1173 , L1150 , CARD_1:41;
L1176: ( C222 + 1 ) <= C221 by L1175 , NAT_1:39;
thus L1177: contradiction by L1176 , L1147 , NAT_1:16 , XXREAL_0:2;
end;
theorem
L1178: (for B195 being Group holds (for B196 being (Element of B195) holds (for B197 , B198 being (Element of ( NAT )) holds ((B195 is  finite & ( ord B196 ) = ( B197 * B198 )) implies ( ord ( B196 |^ B197 ) ) = B198))))
proof
let C226 being Group;
let C227 being (Element of C226);
let C228 , C229 being (Element of ( NAT ));
assume that
L1179: C226 is  finite
and
L1180: ( ord C227 ) = ( C228 * C229 );
set D96 = ( C228 * C229 );
reconsider D97 = ( gr { C227 } ) as  strict (Subgroup of C226);
reconsider D98 = D97 as  finite  strict (Subgroup of C226) by L1179;
L1181: C227 in ( gr { C227 } ) by GR_CY_2:2;
reconsider D99 = C227 as (Element of D98) by L1181 , STRUCT_0:def 5;
L1182: ( gr { C227 } ) = ( gr { D99 } ) by GR_CY_2:3;
L1183: ( card D98 ) = D96 by L1179 , L1180 , GR_CY_1:7;
L1184: ( ord ( D99 |^ C228 ) ) = C229 by L1183 , L1182 , GR_CY_2:8;
thus L1185: thesis by L1184 , L1179 , GROUP_8:3 , GROUP_8:5;
end;
theorem
L1186: (for B199 being Prime holds ( Z/Z* B199 ) is  cyclic  cyclic  cyclic  cyclic Group)
proof
let C230 being Prime;
set D100 = the (Element of ( Z/Z* C230 ));
set D101 = ( Z/Z* C230 );
defpred S7[ Nat , (Element of D101) , (Element of D101) ] means ( ord $2 ) < ( ord $3 );
assume L1187: (not ( Z/Z* C230 ) is  cyclic  cyclic  cyclic  cyclic Group);
L1188: (for B200 being (Element of ( Z/Z* C230 )) holds ( ord B200 ) < ( card ( Z/Z* C230 ) ))
proof
let C231 being (Element of ( Z/Z* C230 ));
L1189: ( ord C231 ) <= ( card ( Z/Z* C230 ) ) by GR_CY_1:8 , NAT_D:7;
L1190: ( ord C231 ) <> ( card ( Z/Z* C230 ) ) by L1187 , GR_CY_1:19;
thus L1191: thesis by L1190 , L1189 , XXREAL_0:1;
end;
L1192: (for B201 being (Element of ( NAT )) holds (for B202 being (Element of D101) holds (ex B203 being (Element of D101) st S7[ B201 , B202 , B203 ])))
proof
let C232 being (Element of ( NAT ));
let C233 being (Element of D101);
set D102 = ( ord C233 );
L1193: D102 < ( card ( Z/Z* C230 ) ) by L1188;
L1194: ( card ( gr { C233 } ) ) <> ( card ( Z/Z* C230 ) ) by L1193 , GR_CY_1:7;
L1195: (the carrier of ( gr { C233 } )) c= (the carrier of ( Z/Z* C230 )) by GROUP_2:def 5;
L1196: (the carrier of ( gr { C233 } )) c< (the carrier of ( Z/Z* C230 )) by L1195 , L1194 , XBOOLE_0:def 8;
L1197: ( (the carrier of ( Z/Z* C230 )) \ (the carrier of ( gr { C233 } )) ) <> ( {} ) by L1196 , XBOOLE_1:105;
consider C234 being set such that L1198: C234 in ( (the carrier of ( Z/Z* C230 )) \ (the carrier of ( gr { C233 } )) ) by L1197 , XBOOLE_0:def 1;
reconsider D103 = C234 as (Element of D101) by L1198;
set D104 = ( ord D103 );
L1199:
now
set D105 = ( D104 lcm D102 );
L1200: 1 <= ( card ( gr { C233 } ) ) by GROUP_1:45;
L1201: 1 <= D102 by L1200 , GR_CY_1:7;
L1202: (not D104 divides D102)
proof
assume L1203: D104 divides D102;
consider C235 being Integer such that L1204: D102 = ( D104 * C235 ) by L1203 , INT_1:def 3;
L1205: ( D103 |^ D102 ) = ( ( D103 |^ D104 ) |^ C235 ) by L1204 , GROUP_1:35
.= ( ( 1_ ( Z/Z* C230 ) ) |^ C235 ) by GROUP_1:41
.= ( 1_ ( Z/Z* C230 ) ) by GROUP_1:31
.= 1 by L996;
L1206: D103 is (Element of ( gr { C233 } )) by L1205 , L1201 , L1138;
thus L1207: contradiction by L1206 , L1198 , XBOOLE_0:def 5;
end;
L1208: D102 <> D105 by L1202 , INT_2:18;
L1209: 1 <= ( card ( gr { D103 } ) ) by GROUP_1:45;
L1210: 1 <= D104 by L1209 , GR_CY_1:7;
consider C236 , C237 being (Element of ( NAT )) such that L1211: D105 = ( C237 * C236 ) and L1212: ( C237 gcd C236 ) = 1 and L1213: C237 divides D102 and L1214: C236 divides D104 and L1215: C237 <> ( 0 ) and L1216: C236 <> ( 0 ) by L1210 , L1201 , L817;
consider C238 being Integer such that L1217: D102 = ( C237 * C238 ) by L1213 , INT_1:def 3;
consider C239 being Integer such that L1218: D104 = ( C236 * C239 ) by L1214 , INT_1:def 3;
L1219: ( D104 / C236 ) = C239 by L1216 , L1218 , XCMPLX_1:89;
reconsider D106 = ( D104 / C236 ) as (Element of ( NAT )) by L1219 , INT_1:3;
L1220: D104 = ( ( D104 / C236 ) * C236 ) by L1216 , XCMPLX_1:87;
L1221: ( ord ( D103 |^ D106 ) ) = C236 by L1220 , L1178;
L1222: ( D102 / C237 ) = C238 by L1215 , L1217 , XCMPLX_1:89;
reconsider D107 = ( D102 / C237 ) as (Element of ( NAT )) by L1222 , INT_1:3;
L1223: D102 divides ( D104 lcm D102 ) by INT_2:18;
consider C240 being Integer such that L1224: D105 = ( D102 * C240 ) by L1223 , INT_1:def 3;
take D108 = ( ( C233 |^ D107 ) * ( D103 |^ D106 ) );
L1225: D102 = ( ( D102 / C237 ) * C237 ) by L1215 , XCMPLX_1:87;
L1226: ( ord ( C233 |^ D107 ) ) = C237 by L1225 , L1178;
L1227: ( ord D108 ) = ( C236 * C237 ) by L1226 , L1212 , L1221 , L1044;
L1228: ( D105 / D102 ) = C240 by L1201 , L1224 , XCMPLX_1:89;
L1229: C240 is (Element of ( NAT )) by L1228 , INT_1:3;
L1230: C240 <> ( 0 ) by L1201 , L1210 , L1224 , INT_2:4;
L1231: ( D102 * 1 ) <= ( D102 * C240 ) by L1230 , L1229 , NAT_1:14 , XREAL_1:64;
thus L1232: D102 < ( ord D108 ) by L1231 , L1211 , L1227 , L1208 , L1224 , XXREAL_0:1;
end;
thus L1233: thesis by L1199;
end;
consider C241 being (Function of ( NAT ) , (the carrier of D101)) such that L1234: (( C241 . ( 0 ) ) = D100 & (for B204 being (Element of ( NAT )) holds S7[ B204 , ( C241 . B204 ) , ( C241 . ( B204 + 1 ) ) ])) from RECDEF_1:sch 2(L1192);
deffunc H5((Element of ( NAT ))) = ( ord ( C241 . $1 ) );
consider C242 being (Function of ( NAT ) , ( NAT )) such that L1235: (for B205 being (Element of ( NAT )) holds ( C242 . B205 ) = H5(B205)) from FUNCT_2:sch 4;
L1236:
now
let C243 being (Element of ( NAT ));
L1237: ( C242 . ( C243 + 1 ) ) = ( ord ( C241 . ( C243 + 1 ) ) ) by L1235;
L1238: ( C242 . C243 ) = ( ord ( C241 . C243 ) ) by L1235;
thus L1239: ( C242 . C243 ) < ( C242 . ( C243 + 1 ) ) by L1238 , L1234 , L1237;
end;
L1240: (for B206 , B207 being (Element of ( NAT )) holds ( C242 . B206 ) < ( C242 . ( ( B206 + 1 ) + B207 ) ))
proof
let C244 being (Element of ( NAT ));
defpred S8[ Nat ] means ( C242 . C244 ) < ( C242 . ( ( C244 + 1 ) + $1 ) );
L1241:
now
let C245 being (Element of ( NAT ));
assume L1242: S8[ C245 ];
L1243: ( C242 . ( ( C244 + 1 ) + C245 ) ) < ( C242 . ( ( ( C244 + 1 ) + C245 ) + 1 ) ) by L1236;
thus L1244: S8[ ( C245 + 1 ) ] by L1243 , L1242 , XXREAL_0:2;
end;
L1245: S8[ ( 0 ) ] by L1236;
L1246: (for B208 being (Element of ( NAT )) holds S8[ B208 ]) from NAT_1:sch 1(L1245 , L1241);
thus L1247: thesis by L1246;
end;
L1248: (for B209 , B210 being (Element of ( NAT )) holds (B209 < B210 implies ( C242 . B209 ) < ( C242 . B210 )))
proof
let C246 , C247 being (Element of ( NAT ));
assume L1249: C246 < C247;
L1250: ( C247 - C246 ) is (Element of ( NAT )) by L1249 , INT_1:5;
reconsider D109 = ( C247 - C246 ) as Nat by L1250;
L1251: ( C247 - C246 ) <> ( 0 ) by L1249;
consider C248 being Nat such that L1252: D109 = ( C248 + 1 ) by L1251 , NAT_1:6;
reconsider D110 = C248 as (Element of ( NAT )) by ORDINAL1:def 12;
L1253: C247 = ( ( C246 + 1 ) + D110 ) by L1252;
thus L1254: thesis by L1253 , L1240;
end;
L1255:
now
let C249 , C250 being set;
assume that
L1256: C249 in ( NAT )
and
L1257: C250 in ( NAT )
and
L1258: ( C242 . C249 ) = ( C242 . C250 );
reconsider D111 = C249 , D112 = C250 as (Element of ( NAT )) by L1256 , L1257;
L1259: D112 <= D111 by L1248 , L1258;
L1260: D111 <= D112 by L1248 , L1258;
thus L1261: C250 = C249 by L1260 , L1259 , XXREAL_0:1;
end;
L1262: C242 is  one-to-one by L1255 , FUNCT_2:19;
L1263: ( dom C242 ) , ( rng C242 ) are_equipotent  by L1262 , WELLORD2:def 4;
L1264: ( card ( dom C242 ) ) = ( card ( rng C242 ) ) by L1263 , CARD_1:5;
L1265: ( card ( rng C242 ) ) = ( card ( NAT ) ) by L1264 , FUNCT_2:def 1;
L1266: ( rng C242 ) c= ( Segm ( card D101 ) )
proof
let C251 being set;
assume L1267: C251 in ( rng C242 );
consider C252 being set such that L1268: C252 in ( NAT ) and L1269: C251 = ( C242 . C252 ) by L1267 , FUNCT_2:11;
reconsider D113 = C252 as (Element of ( NAT )) by L1268;
reconsider D114 = ( C242 . D113 ) as (Element of ( NAT ));
L1270: ( C242 . D113 ) = ( ord ( C241 . D113 ) ) by L1235;
L1271: D114 < ( card D101 ) by L1270 , L1188;
thus L1272: thesis by L1271 , L1269 , ALGSEQ_1:1;
end;
thus L1273: contradiction by L1266 , L1265;
end;
