:: On Cosets in Segre's Product of Partial Linear Spaces
::  by Adam Naumowicz
::
:: Received August 14, 2001
:: Copyright (c) 2001-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, FINSEQ_1, NAT_1, FINSEQ_3, RELAT_1, ARYTM_1, ORDINAL4,
      RFINSEQ, SUBSET_1, TARSKI, XBOOLE_0, XXREAL_0, ARYTM_3, CARD_1, FUNCT_1,
      PARTFUN1, PRALG_1, PBOOLE, RLVECT_2, FUNCT_4, STRUCT_0, PENCIL_1, CARD_3,
      INTEGRA1, ZFMISC_1, PRE_TOPC, FUNCT_2, CAT_1, RCOMP_1, RELAT_2, PENCIL_2;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, NUMBERS, XCMPLX_0, ORDINAL1,
      NAT_1, RELAT_1, NAT_D, FUNCT_1, RELSET_1, PARTFUN1, FUNCT_2, STRUCT_0,
      XXREAL_0, RFINSEQ, CARD_1, FINSEQ_1, CARD_3, PRE_TOPC, PBOOLE, PZFMISC1,
      TOPS_2, T_0TOPSP, PRALG_1, FUNCT_7, PENCIL_1;
 constructors RFINSEQ, NAT_D, PZFMISC1, TOPS_2, T_0TOPSP, POLYNOM1, PENCIL_1,
      REAL_1, RELSET_1, PBOOLE, FUNCT_7;
 registrations XBOOLE_0, SUBSET_1, FUNCT_1, PARTFUN1, FUNCT_2, XXREAL_0,
      XREAL_0, NAT_1, STRUCT_0, BORSUK_2, PENCIL_1, ORDINAL1, FINSEQ_1,
      RELSET_1, PRE_POLY, ZFMISC_1;
 requirements REAL, BOOLE, SUBSET, NUMERALS, ARITHM;
 definitions TARSKI, PBOOLE, PENCIL_1, XBOOLE_0, STRUCT_0;
 theorems TARSKI, FUNCT_1, PBOOLE, CARD_3, CARD_1, FINSEQ_1, ZFMISC_1, NAT_1,
      FUNCT_7, YELLOW_6, PZFMISC1, PUA2MSS1, PRE_TOPC, FINSEQ_3, FUNCT_2,
      TOPGRP_1, TOPS_2, T_0TOPSP, RELAT_1, PENCIL_1, RFINSEQ, FINSEQ_4,
      FINSEQ_5, XBOOLE_0, XBOOLE_1, XREAL_1, XXREAL_0, PARTFUN1, XREAL_0,
      NAT_D;
 schemes FINSEQ_1, NAT_1, INT_1;

begin
definition
let C1 being set;
let C2 being (FinSequence of C1);
let C3 , C4 being Nat;
func Del (C2 , C3 , C4) -> (FinSequence of C1) equals 
( ( C2 | ( C3 -' 1 ) ) ^ ( C2 /^ C4 ) );
coherence;
end;
theorem
L2: (for B1 being set holds (for B2 being (FinSequence of B1) holds (for B3 , B4 being (Element of ( NAT )) holds ( rng ( Del (B2 , B3 , B4) ) ) c= ( rng B2 ))))
proof
let C5 being set;
let C6 being (FinSequence of C5);
let C7 , C8 being (Element of ( NAT ));
L3: ( rng ( C6 /^ C8 ) ) c= ( rng C6 )
proof
per cases ;
suppose L4: C5 is  empty;

L5: (C8 > ( len C6 ) implies thesis) by L4;
L6: (C8 <= ( len C6 ) implies thesis) by L4;
thus L7: thesis by L6 , L5;
end;
suppose L8: C5 is non  empty;

reconsider D1 = C5 as non  empty set by L8;
reconsider D2 = C6 as (FinSequence of D1);
L9: ( rng ( D2 /^ C8 ) ) c= ( rng D2 ) by FINSEQ_5:33;
thus L10: thesis by L9;
end;
end;
L12: ( rng ( C6 | ( C7 -' 1 ) ) ) = ( rng ( C6 | ( Seg ( C7 -' 1 ) ) ) ) by FINSEQ_1:def 15;
L13: ( rng ( C6 | ( C7 -' 1 ) ) ) c= ( rng C6 ) by L12 , RELAT_1:70;
L14: ( rng ( ( C6 | ( C7 -' 1 ) ) ^ ( C6 /^ C8 ) ) ) = ( ( rng ( C6 | ( C7 -' 1 ) ) ) \/ ( rng ( C6 /^ C8 ) ) ) by FINSEQ_1:31;
thus L15: thesis by L14 , L13 , L3 , XBOOLE_1:8;
end;
theorem
L16: (for B5 being set holds (for B6 being (FinSequence of B5) holds (for B7 , B8 being (Element of ( NAT )) holds ((B7 in ( dom B6 ) & B8 in ( dom B6 )) implies ( len ( Del (B6 , B7 , B8) ) ) = ( ( ( ( len B6 ) - B8 ) + B7 ) - 1 )))))
proof
let C9 being set;
let C10 being (FinSequence of C9);
let C11 , C12 being (Element of ( NAT ));
assume that
L17: C11 in ( dom C10 )
and
L18: C12 in ( dom C10 );
L19: C11 <= ( len C10 ) by L17 , FINSEQ_3:25;
L20: 1 <= C11 by L17 , FINSEQ_3:25;
L21: ( C11 - 1 ) >= ( 1 - 1 ) by L20 , XREAL_1:9;
L22: ( C11 -' 1 ) <= C11 by NAT_D:35;
L23: C12 <= ( len C10 ) by L18 , FINSEQ_3:25;
thus L24: ( len ( Del (C10 , C11 , C12) ) ) = ( ( len ( C10 | ( C11 -' 1 ) ) ) + ( len ( C10 /^ C12 ) ) ) by FINSEQ_1:22
.= ( ( C11 -' 1 ) + ( len ( C10 /^ C12 ) ) ) by L19 , L22 , FINSEQ_1:59 , XXREAL_0:2
.= ( ( C11 -' 1 ) + ( ( len C10 ) - C12 ) ) by L23 , RFINSEQ:def 1
.= ( ( C11 - 1 ) + ( ( len C10 ) - C12 ) ) by L21 , XREAL_0:def 2
.= ( ( ( ( len C10 ) - C12 ) + C11 ) - 1 );
end;
theorem
L25: (for B9 being set holds (for B10 being (FinSequence of B9) holds (for B11 , B12 being (Element of ( NAT )) holds ((B11 in ( dom B10 ) & B12 in ( dom B10 )) implies (( len ( Del (B10 , B11 , B12) ) ) = ( 0 ) implies (B11 = 1 & B12 = ( len B10 )))))))
proof
let C13 being set;
let C14 being (FinSequence of C13);
let C15 , C16 being (Element of ( NAT ));
assume that
L26: C15 in ( dom C14 )
and
L27: C16 in ( dom C14 )
and
L28: ( len ( Del (C14 , C15 , C16) ) ) = ( 0 );
L29: 1 <= C15 by L26 , FINSEQ_3:25;
L30: C16 <= ( len C14 ) by L27 , FINSEQ_3:25;
L31: ( ( len C14 ) - C16 ) >= ( 0 ) by L30 , XREAL_1:48;
L32: ( ( ( ( len C14 ) - C16 ) + C15 ) - 1 ) = ( 0 ) by L26 , L27 , L28 , L16;
L33: ( ( len C14 ) - C16 ) = ( 1 - C15 ) by L32;
L34: 1 >= C15 by L33 , L31 , XREAL_1:49;
thus L35: C15 = 1 by L34 , L29 , XXREAL_0:1;
thus L36: thesis by L35 , L32;
end;
theorem
L37: (for B13 being set holds (for B14 being (FinSequence of B13) holds (for B15 , B16 , B17 being (Element of ( NAT )) holds ((B15 in ( dom B14 ) & 1 <= B17 & B17 <= ( B15 - 1 )) implies ( ( Del (B14 , B15 , B16) ) . B17 ) = ( B14 . B17 )))))
proof
let C17 being set;
let C18 being (FinSequence of C17);
let C19 , C20 , C21 being (Element of ( NAT ));
assume that
L38: C19 in ( dom C18 )
and
L39: 1 <= C21
and
L40: C21 <= ( C19 - 1 );
L41: C19 <= ( len C18 ) by L38 , FINSEQ_3:25;
L42: C21 <= ( C19 -' 1 ) by L40 , XREAL_0:def 2;
L43: ( C19 -' 1 ) <= C19 by NAT_D:35;
L44: ( len ( C18 | ( C19 -' 1 ) ) ) = ( C19 -' 1 ) by L43 , L41 , FINSEQ_1:59 , XXREAL_0:2;
L45: C21 in ( dom ( C18 | ( C19 -' 1 ) ) ) by L44 , L39 , L42 , FINSEQ_3:25;
L46: ( C19 -' 1 ) <= ( len C18 ) by L41 , L43 , XXREAL_0:2;
L47: C21 <= ( len C18 ) by L46 , L42 , XXREAL_0:2;
L48: C21 in ( dom C18 ) by L47 , L39 , FINSEQ_3:25;
thus L49: ( ( Del (C18 , C19 , C20) ) . C21 ) = ( ( C18 | ( C19 -' 1 ) ) . C21 ) by L45 , FINSEQ_1:def 7
.= ( ( C18 | ( C19 -' 1 ) ) /. C21 ) by L45 , PARTFUN1:def 6
.= ( C18 /. C21 ) by L45 , FINSEQ_4:70
.= ( C18 . C21 ) by L48 , PARTFUN1:def 6;
end;
theorem
L50: (for B18 , B19 being FinSequence holds (for B20 being (Element of ( NAT )) holds (( ( len B18 ) + 1 ) <= B20 implies ( ( B18 ^ B19 ) . B20 ) = ( B19 . ( B20 - ( len B18 ) ) ))))
proof
let C22 , C23 being FinSequence;
let C24 being (Element of ( NAT ));
assume L51: ( ( len C22 ) + 1 ) <= C24;
per cases ;
suppose L52: C24 <= ( ( len C22 ) + ( len C23 ) );

thus L53: thesis by L52 , L51 , FINSEQ_1:23;
end;
suppose L54: (not C24 <= ( ( len C22 ) + ( len C23 ) ));

L55: ( C24 - ( len C22 ) ) > ( len C23 ) by L54 , XREAL_1:20;
L56: (not ( C24 - ( len C22 ) ) in ( dom C23 )) by L55 , FINSEQ_3:25;
L57: (not C24 <= ( len ( C22 ^ C23 ) )) by L54 , FINSEQ_1:22;
L58: (not C24 in ( dom ( C22 ^ C23 ) )) by L57 , FINSEQ_3:25;
thus L59: ( ( C22 ^ C23 ) . C24 ) = ( {} ) by L58 , FUNCT_1:def 2
.= ( C23 . ( C24 - ( len C22 ) ) ) by L56 , FUNCT_1:def 2;
end;
end;
theorem
L61: (for B21 being set holds (for B22 being (FinSequence of B21) holds (for B23 , B24 , B25 being (Element of ( NAT )) holds ((B23 in ( dom B22 ) & B24 in ( dom B22 ) & B23 <= B24 & B23 <= B25 & B25 <= ( ( ( ( len B22 ) - B24 ) + B23 ) - 1 )) implies ( ( Del (B22 , B23 , B24) ) . B25 ) = ( B22 . ( ( ( B24 -' B23 ) + B25 ) + 1 ) )))))
proof
let C25 being set;
let C26 being (FinSequence of C25);
let C27 , C28 , C29 being (Element of ( NAT ));
assume that
L62: C27 in ( dom C26 )
and
L63: C28 in ( dom C26 )
and
L64: C27 <= C28
and
L65: C27 <= C29
and
L66: C29 <= ( ( ( ( len C26 ) - C28 ) + C27 ) - 1 );
L67: ( C27 -' 1 ) <= C27 by NAT_D:35;
L68: ( C27 -' 1 ) <= C27 by NAT_D:35;
L69: C29 >= ( C27 -' 1 ) by L68 , L65 , XXREAL_0:2;
L70: ( C29 - ( C27 -' 1 ) ) >= ( ( C27 -' 1 ) - ( C27 -' 1 ) ) by L69 , XREAL_1:9;
L71: ( C29 - ( C27 -' 1 ) ) = ( C29 -' ( C27 -' 1 ) ) by L70 , XREAL_0:def 2;
L72: 1 <= C27 by L62 , FINSEQ_3:25;
L73: ( ( C27 -' 1 ) + 1 ) <= C29 by L72 , L65 , XREAL_1:235;
L74: ( C27 - 1 ) >= ( 1 - 1 ) by L72 , XREAL_1:9;
L75: ( C27 -' 1 ) = ( C27 - 1 ) by L74 , XREAL_0:def 2;
L76: ( C28 - C27 ) >= ( C27 - C27 ) by L64 , XREAL_1:9;
L77: ( C28 -' C27 ) = ( C28 - C27 ) by L76 , XREAL_0:def 2;
L78: C28 <= ( len C26 ) by L63 , FINSEQ_3:25;
L79: ( len ( C26 /^ C28 ) ) = ( ( len C26 ) - C28 ) by L78 , RFINSEQ:def 1;
L80: C29 <= ( ( ( len C26 ) - C28 ) + ( C27 - 1 ) ) by L66;
L81: ( C29 - ( C27 -' 1 ) ) <= ( ( len C26 ) - C28 ) by L80 , L75 , XREAL_1:20;
L82: 1 <= ( C29 - ( C27 -' 1 ) ) by L73 , XREAL_1:19;
L83: ( C29 - ( C27 -' 1 ) ) in ( dom ( C26 /^ C28 ) ) by L82 , L71 , L79 , L81 , FINSEQ_3:25;
L84: C27 <= ( len C26 ) by L62 , FINSEQ_3:25;
L85: ( len ( C26 | ( C27 -' 1 ) ) ) = ( C27 -' 1 ) by L84 , L67 , FINSEQ_1:59 , XXREAL_0:2;
thus L86: ( ( Del (C26 , C27 , C28) ) . C29 ) = ( ( C26 /^ C28 ) . ( C29 - ( C27 -' 1 ) ) ) by L85 , L73 , L50
.= ( C26 . ( C28 + ( C29 + ( 1 - C27 ) ) ) ) by L78 , L75 , L83 , RFINSEQ:def 1
.= ( C26 . ( ( ( C28 -' C27 ) + C29 ) + 1 ) ) by L77;
end;
scheme FinSeqOneToOne { F1 , F2 , F3() -> set , F4() -> (FinSequence of F3()) , P1[set , set] } : (ex B26 being  one-to-one (FinSequence of F3()) st (F1() = ( B26 . 1 ) & F2() = ( B26 . ( len B26 ) ) & ( rng B26 ) c= ( rng F4() ) & (for B27 being (Element of ( NAT )) holds ((1 <= B27 & B27 < ( len B26 )) implies P1[ ( B26 . B27 ) , ( B26 . ( B27 + 1 ) ) ]))))
provided
L87: (F1() = ( F4() . 1 ) & F2() = ( F4() . ( len F4() ) ))
and
L88: (for B28 being (Element of ( NAT )) holds (for B29 , B30 being set holds ((1 <= B28 & B28 < ( len F4() ) & B29 = ( F4() . B28 ) & B30 = ( F4() . ( B28 + 1 ) )) implies P1[ B29 , B30 ])))
proof
defpred S1[ Nat ] means (ex B31 being (FinSequence of F3()) st (( len B31 ) = $1 & F1() = ( B31 . 1 ) & F2() = ( B31 . ( len B31 ) ) & ( rng B31 ) c= ( rng F4() ) & (for B32 being (Element of ( NAT )) holds ((1 <= B32 & B32 < ( len B31 )) implies P1[ ( B31 . B32 ) , ( B31 . ( B32 + 1 ) ) ]))));
L89: (for B33 being (Element of ( NAT )) holds ((1 <= B33 & B33 < ( len F4() )) implies P1[ ( F4() . B33 ) , ( F4() . ( B33 + 1 ) ) ])) by L88;
L90: (ex B34 being Nat st S1[ B34 ]) by L89 , L87;
consider C30 being Nat such that L91: (S1[ C30 ] & (for B35 being Nat holds (S1[ B35 ] implies C30 <= B35))) from NAT_1:sch 5(L90);
consider C31 being (FinSequence of F3()) such that L92: ( len C31 ) = C30 and L93: F1() = ( C31 . 1 ) and L94: F2() = ( C31 . ( len C31 ) ) and L95: ( rng C31 ) c= ( rng F4() ) and L96: (for B36 being (Element of ( NAT )) holds ((1 <= B36 & B36 < ( len C31 )) implies P1[ ( C31 . B36 ) , ( C31 . ( B36 + 1 ) ) ])) by L91;
L97:
now
assume L98: (not C31 is  one-to-one);
consider C32 , C33 being set such that L99: C32 in ( dom C31 ) and L100: C33 in ( dom C31 ) and L101: ( C31 . C32 ) = ( C31 . C33 ) and L102: C32 <> C33 by L98 , FUNCT_1:def 4;
reconsider D3 = C32 , D4 = C33 as (Element of ( NAT )) by L99 , L100;
per cases  by L102 , XXREAL_0:1;
suppose L103: D3 < D4;

set D5 = ( Del (C31 , ( D3 + 1 ) , D4) );
L104: 1 <= D4 by L100 , FINSEQ_3:25;
L105: ( D3 + 1 ) >= 1 by NAT_1:11;
L106: D4 <= ( len C31 ) by L100 , FINSEQ_3:25;
L107: D3 < ( len C31 ) by L106 , L103 , XXREAL_0:2;
L108: ( D3 + 1 ) <= ( len C31 ) by L107 , NAT_1:13;
L109: ( D3 + 1 ) in ( dom C31 ) by L108 , L105 , FINSEQ_3:25;
L110: ( D3 + 1 ) <= D4 by L103 , NAT_1:13;
L111: ( D4 - ( D3 + 1 ) ) >= ( 0 ) by L110 , XREAL_1:48;
L112: (( rng D5 ) c= ( rng F4() ) & (for B37 being (Element of ( NAT )) holds ((1 <= B37 & B37 < ( len D5 )) implies P1[ ( D5 . B37 ) , ( D5 . ( B37 + 1 ) ) ])))
proof
L113: ( rng D5 ) c= ( rng C31 ) by L2;
thus L114: ( rng D5 ) c= ( rng F4() ) by L113 , L95 , XBOOLE_1:1;
let C34 being (Element of ( NAT ));
assume that
L115: 1 <= C34
and
L116: C34 < ( len D5 );
per cases  by XXREAL_0:1;
suppose L117: C34 < D3;

L118: ( C34 + 1 ) <= ( ( D3 + 1 ) - 1 ) by L117 , NAT_1:13;
L119: ( D5 . ( C34 + 1 ) ) = ( C31 . ( C34 + 1 ) ) by L118 , L109 , L37 , NAT_1:11;
L120: C34 <= ( ( D3 + 1 ) - 1 ) by L117;
L121: ( D5 . C34 ) = ( C31 . C34 ) by L120 , L109 , L115 , L37;
L122: C34 < ( len C31 ) by L107 , L117 , XXREAL_0:2;
thus L123: thesis by L122 , L96 , L115 , L121 , L119;
end;
suppose L124: C34 = D3;

L125:
now
assume L126: D4 = ( len C31 );
L127: D3 < ( ( ( ( len C31 ) - ( len C31 ) ) + ( D3 + 1 ) ) - 1 ) by L126 , L100 , L109 , L116 , L124 , L16;
thus L128: contradiction by L127;
end;
L129: D4 < ( len C31 ) by L125 , L106 , XXREAL_0:1;
L130: ( 0 ) < ( ( len C31 ) - D4 ) by L129 , XREAL_1:50;
L131: ( 0 ) < ( ( len C31 ) -' D4 ) by L130 , XREAL_0:def 2;
L132: ( ( 0 ) + 1 ) <= ( ( len C31 ) -' D4 ) by L131 , NAT_1:13;
L133: ( 1 - 1 ) <= ( ( ( len C31 ) -' D4 ) - 1 ) by L132 , XREAL_1:9;
L134: ( 0 ) <= ( ( ( len C31 ) - D4 ) - 1 ) by L133 , L130 , XREAL_0:def 2;
L135: ( ( C34 + 1 ) + ( 0 ) ) <= ( ( C34 + 1 ) + ( ( ( len C31 ) - D4 ) - 1 ) ) by L134 , XREAL_1:7;
L136: ( ( C34 + 1 ) + ( 0 ) ) <= ( ( ( C34 + 1 ) + ( ( len C31 ) - D4 ) ) - 1 ) by L135;
L137: ( D5 . ( C34 + 1 ) ) = ( C31 . ( ( ( D4 -' ( D3 + 1 ) ) + ( C34 + 1 ) ) + 1 ) ) by L136 , L100 , L110 , L109 , L124 , L61
.= ( C31 . ( D4 + 1 ) ) by L110 , L124 , XREAL_1:235;
L138: C34 <= ( ( D3 + 1 ) - 1 ) by L124;
L139: ( D5 . C34 ) = ( C31 . D4 ) by L138 , L101 , L109 , L115 , L124 , L37;
thus L140: thesis by L139 , L96 , L104 , L129 , L137;
end;
suppose L141: C34 > D3;

L142: ( D3 + 1 ) <= C34 by L141 , NAT_1:13;
L143: ( ( len C31 ) - D4 ) >= ( 0 ) by L106 , XREAL_1:48;
L144: C34 < ( ( ( ( len C31 ) - D4 ) + ( D3 + 1 ) ) - 1 ) by L100 , L109 , L116 , L16;
L145: C34 < ( ( ( ( len C31 ) -' D4 ) + ( D3 + 1 ) ) - 1 ) by L144 , L143 , XREAL_0:def 2;
L146: ( C34 + 1 ) <= ( ( ( len C31 ) -' D4 ) + D3 ) by L145 , NAT_1:13;
L147: ( C34 + 1 ) <= ( ( ( ( ( len C31 ) - D4 ) + D3 ) + 1 ) - 1 ) by L146 , L143 , XREAL_0:def 2;
L148: ( C34 + 1 ) <= ( ( ( ( len C31 ) - D4 ) + ( D3 + 1 ) ) - 1 ) by L147;
L149: C34 < ( ( ( ( ( len C31 ) -' D4 ) + D3 ) + 1 ) - 1 ) by L145;
L150: C34 < ( ( ( len C31 ) - D4 ) + D3 ) by L149 , L143 , XREAL_0:def 2;
L151: ( C34 - D3 ) < ( ( ( ( len C31 ) - D4 ) + D3 ) - D3 ) by L150 , XREAL_1:9;
L152: ( ( C34 - D3 ) + D4 ) < ( ( ( len C31 ) - D4 ) + D4 ) by L151 , XREAL_1:8;
L153: ( ( ( ( D4 - D3 ) - 1 ) + C34 ) + 1 ) < ( len C31 ) by L152;
L154: ( ( ( D4 -' ( D3 + 1 ) ) + C34 ) + 1 ) < ( len C31 ) by L153 , L111 , XREAL_0:def 2;
L155: C34 <= ( C34 + 1 ) by NAT_1:11;
L156: ( D3 + 1 ) <= ( C34 + 1 ) by L155 , L142 , XXREAL_0:2;
L157: ( D5 . ( C34 + 1 ) ) = ( C31 . ( ( ( D4 -' ( D3 + 1 ) ) + ( C34 + 1 ) ) + 1 ) ) by L156 , L100 , L110 , L109 , L148 , L61
.= ( C31 . ( ( ( ( D4 -' ( D3 + 1 ) ) + C34 ) + 1 ) + 1 ) );
L158: C34 <= ( ( ( ( len C31 ) - D4 ) + ( D3 + 1 ) ) - 1 ) by L100 , L109 , L116 , L16;
L159: ( D5 . C34 ) = ( C31 . ( ( ( D4 -' ( D3 + 1 ) ) + C34 ) + 1 ) ) by L158 , L100 , L110 , L109 , L142 , L61;
thus L160: thesis by L159 , L96 , L157 , L154 , NAT_1:11;
end;
end;
L162: F2() = ( D5 . ( len D5 ) )
proof
per cases ;
suppose L163: ( len D5 ) <= D3;

L164:
now
assume L165: ( len D5 ) = ( 0 );
L166: ( D3 + 1 ) = ( ( 0 ) + 1 ) by L165 , L100 , L109 , L25;
thus L167: contradiction by L166 , L99 , FINSEQ_3:24;
end;
L168: ( ( 0 ) + 1 ) <= ( len D5 ) by L164 , NAT_1:13;
L169: ( len D5 ) <= ( ( D3 + 1 ) - 1 ) by L163;
L170: ( D5 . ( len D5 ) ) = ( C31 . ( len D5 ) ) by L169 , L109 , L168 , L37;
L171: ( ( ( ( len C31 ) - D4 ) + ( D3 + 1 ) ) - 1 ) <= D3 by L100 , L109 , L163 , L16;
L172: ( ( ( ( ( len C31 ) - D4 ) + D3 ) + 1 ) - 1 ) <= D3 by L171;
L173: ( ( len C31 ) - D4 ) <= ( 0 ) by L172 , XREAL_1:29;
L174: ( len C31 ) <= D4 by L173 , XREAL_1:50;
L175: ( len C31 ) = D4 by L174 , L106 , XXREAL_0:1;
L176: D3 <= ( ( ( ( len C31 ) - D4 ) + ( D3 + 1 ) ) - 1 ) by L175;
thus L177: thesis by L176 , L94 , L100 , L101 , L109 , L175 , L170 , L16;
end;
suppose L178: ( len D5 ) > D3;

L179: ( D3 + 1 ) <= ( len D5 ) by L178 , NAT_1:13;
L180: ( len D5 ) = ( ( ( ( len C31 ) - D4 ) + ( D3 + 1 ) ) - 1 ) by L100 , L109 , L16;
thus L181: ( D5 . ( len D5 ) ) = ( C31 . ( ( ( D4 -' ( D3 + 1 ) ) + ( ( ( ( len C31 ) - D4 ) + ( D3 + 1 ) ) - 1 ) ) + 1 ) ) by L180 , L100 , L110 , L109 , L179 , L61
.= ( C31 . ( ( ( D4 - ( D3 + 1 ) ) + ( ( D3 + 1 ) + ( ( ( len C31 ) - D4 ) - 1 ) ) ) + 1 ) ) by L110 , XREAL_1:233
.= F2() by L94;
end;
end;
L183: 1 <= ( ( D3 + 1 ) - 1 ) by L99 , FINSEQ_3:25;
L184: F1() = ( D5 . 1 ) by L183 , L93 , L109 , L37;
L185: ( 0 ) < ( - ( - ( D4 - D3 ) ) ) by L103 , XREAL_1:50;
L186: ( - ( D4 - D3 ) ) < ( 0 ) by L185;
L187: ( ( len C31 ) + ( - ( D4 - D3 ) ) ) < ( ( len C31 ) + ( 0 ) ) by L186 , XREAL_1:8;
L188: ( ( ( ( len C31 ) - D4 ) + ( D3 + 1 ) ) - 1 ) < ( len C31 ) by L187;
L189: ( len D5 ) < ( len C31 ) by L188 , L100 , L109 , L16;
thus L190: contradiction by L189 , L91 , L92 , L184 , L162 , L112;
end;
suppose L191: D4 < D3;

set D6 = ( Del (C31 , ( D4 + 1 ) , D3) );
L192: 1 <= D3 by L99 , FINSEQ_3:25;
L193: ( D4 + 1 ) >= 1 by NAT_1:11;
L194: D3 <= ( len C31 ) by L99 , FINSEQ_3:25;
L195: D4 < ( len C31 ) by L194 , L191 , XXREAL_0:2;
L196: ( D4 + 1 ) <= ( len C31 ) by L195 , NAT_1:13;
L197: ( D4 + 1 ) in ( dom C31 ) by L196 , L193 , FINSEQ_3:25;
L198: ( D4 + 1 ) <= D3 by L191 , NAT_1:13;
L199: ( D3 - ( D4 + 1 ) ) >= ( 0 ) by L198 , XREAL_1:48;
L200: (( rng D6 ) c= ( rng F4() ) & (for B38 being (Element of ( NAT )) holds ((1 <= B38 & B38 < ( len D6 )) implies P1[ ( D6 . B38 ) , ( D6 . ( B38 + 1 ) ) ])))
proof
L201: ( rng D6 ) c= ( rng C31 ) by L2;
thus L202: ( rng D6 ) c= ( rng F4() ) by L201 , L95 , XBOOLE_1:1;
let C35 being (Element of ( NAT ));
assume that
L203: 1 <= C35
and
L204: C35 < ( len D6 );
per cases  by XXREAL_0:1;
suppose L205: C35 < D4;

L206: ( C35 + 1 ) <= ( ( D4 + 1 ) - 1 ) by L205 , NAT_1:13;
L207: ( D6 . ( C35 + 1 ) ) = ( C31 . ( C35 + 1 ) ) by L206 , L197 , L37 , NAT_1:11;
L208: C35 <= ( ( D4 + 1 ) - 1 ) by L205;
L209: ( D6 . C35 ) = ( C31 . C35 ) by L208 , L197 , L203 , L37;
L210: C35 < ( len C31 ) by L195 , L205 , XXREAL_0:2;
thus L211: thesis by L210 , L96 , L203 , L209 , L207;
end;
suppose L212: C35 = D4;

L213:
now
assume L214: D3 = ( len C31 );
L215: D4 < ( ( ( ( len C31 ) - ( len C31 ) ) + ( D4 + 1 ) ) - 1 ) by L214 , L99 , L197 , L204 , L212 , L16;
thus L216: contradiction by L215;
end;
L217: D3 < ( len C31 ) by L213 , L194 , XXREAL_0:1;
L218: ( 0 ) < ( ( len C31 ) - D3 ) by L217 , XREAL_1:50;
L219: ( 0 ) < ( ( len C31 ) -' D3 ) by L218 , XREAL_0:def 2;
L220: ( ( 0 ) + 1 ) <= ( ( len C31 ) -' D3 ) by L219 , NAT_1:13;
L221: ( 1 - 1 ) <= ( ( ( len C31 ) -' D3 ) - 1 ) by L220 , XREAL_1:9;
L222: ( 0 ) <= ( ( ( len C31 ) - D3 ) - 1 ) by L221 , L218 , XREAL_0:def 2;
L223: ( ( C35 + 1 ) + ( 0 ) ) <= ( ( C35 + 1 ) + ( ( ( len C31 ) - D3 ) - 1 ) ) by L222 , XREAL_1:7;
L224: ( ( C35 + 1 ) + ( 0 ) ) <= ( ( ( C35 + 1 ) + ( ( len C31 ) - D3 ) ) - 1 ) by L223;
L225: ( D6 . ( C35 + 1 ) ) = ( C31 . ( ( ( D3 -' ( D4 + 1 ) ) + ( C35 + 1 ) ) + 1 ) ) by L224 , L99 , L198 , L197 , L212 , L61
.= ( C31 . ( D3 + 1 ) ) by L198 , L212 , XREAL_1:235;
L226: C35 <= ( ( D4 + 1 ) - 1 ) by L212;
L227: ( D6 . C35 ) = ( C31 . D3 ) by L226 , L101 , L197 , L203 , L212 , L37;
thus L228: thesis by L227 , L96 , L192 , L217 , L225;
end;
suppose L229: C35 > D4;

L230: ( D4 + 1 ) <= C35 by L229 , NAT_1:13;
L231: ( ( len C31 ) - D3 ) >= ( 0 ) by L194 , XREAL_1:48;
L232: C35 < ( ( ( ( len C31 ) - D3 ) + ( D4 + 1 ) ) - 1 ) by L99 , L197 , L204 , L16;
L233: C35 < ( ( ( ( len C31 ) -' D3 ) + ( D4 + 1 ) ) - 1 ) by L232 , L231 , XREAL_0:def 2;
L234: ( C35 + 1 ) <= ( ( ( len C31 ) -' D3 ) + D4 ) by L233 , NAT_1:13;
L235: ( C35 + 1 ) <= ( ( ( ( ( len C31 ) - D3 ) + D4 ) + 1 ) - 1 ) by L234 , L231 , XREAL_0:def 2;
L236: ( C35 + 1 ) <= ( ( ( ( len C31 ) - D3 ) + ( D4 + 1 ) ) - 1 ) by L235;
L237: C35 < ( ( ( ( ( len C31 ) -' D3 ) + D4 ) + 1 ) - 1 ) by L233;
L238: C35 < ( ( ( len C31 ) - D3 ) + D4 ) by L237 , L231 , XREAL_0:def 2;
L239: ( C35 - D4 ) < ( ( ( ( len C31 ) - D3 ) + D4 ) - D4 ) by L238 , XREAL_1:9;
L240: ( ( C35 - D4 ) + D3 ) < ( ( ( len C31 ) - D3 ) + D3 ) by L239 , XREAL_1:8;
L241: ( ( ( ( D3 - D4 ) - 1 ) + C35 ) + 1 ) < ( len C31 ) by L240;
L242: ( ( ( D3 -' ( D4 + 1 ) ) + C35 ) + 1 ) < ( len C31 ) by L241 , L199 , XREAL_0:def 2;
L243: C35 <= ( C35 + 1 ) by NAT_1:11;
L244: ( D4 + 1 ) <= ( C35 + 1 ) by L243 , L230 , XXREAL_0:2;
L245: ( D6 . ( C35 + 1 ) ) = ( C31 . ( ( ( D3 -' ( D4 + 1 ) ) + ( C35 + 1 ) ) + 1 ) ) by L244 , L99 , L198 , L197 , L236 , L61
.= ( C31 . ( ( ( ( D3 -' ( D4 + 1 ) ) + C35 ) + 1 ) + 1 ) );
L246: C35 <= ( ( ( ( len C31 ) - D3 ) + ( D4 + 1 ) ) - 1 ) by L99 , L197 , L204 , L16;
L247: ( D6 . C35 ) = ( C31 . ( ( ( D3 -' ( D4 + 1 ) ) + C35 ) + 1 ) ) by L246 , L99 , L198 , L197 , L230 , L61;
thus L248: thesis by L247 , L96 , L245 , L242 , NAT_1:11;
end;
end;
L250: F2() = ( D6 . ( len D6 ) )
proof
per cases ;
suppose L251: ( len D6 ) <= D4;

L252:
now
assume L253: ( len D6 ) = ( 0 );
L254: ( D4 + 1 ) = ( ( 0 ) + 1 ) by L253 , L99 , L197 , L25;
thus L255: contradiction by L254 , L100 , FINSEQ_3:24;
end;
L256: ( ( 0 ) + 1 ) <= ( len D6 ) by L252 , NAT_1:13;
L257: ( len D6 ) <= ( ( D4 + 1 ) - 1 ) by L251;
L258: ( D6 . ( len D6 ) ) = ( C31 . ( len D6 ) ) by L257 , L197 , L256 , L37;
L259: ( ( ( ( len C31 ) - D3 ) + ( D4 + 1 ) ) - 1 ) <= D4 by L99 , L197 , L251 , L16;
L260: ( ( ( ( ( len C31 ) - D3 ) + D4 ) + 1 ) - 1 ) <= D4 by L259;
L261: ( ( len C31 ) - D3 ) <= ( 0 ) by L260 , XREAL_1:29;
L262: ( len C31 ) <= D3 by L261 , XREAL_1:50;
L263: ( len C31 ) = D3 by L262 , L194 , XXREAL_0:1;
L264: D4 <= ( ( ( ( len C31 ) - D3 ) + ( D4 + 1 ) ) - 1 ) by L263;
thus L265: thesis by L264 , L94 , L99 , L101 , L197 , L263 , L258 , L16;
end;
suppose L266: ( len D6 ) > D4;

L267: ( D4 + 1 ) <= ( len D6 ) by L266 , NAT_1:13;
L268: ( len D6 ) = ( ( ( ( len C31 ) - D3 ) + ( D4 + 1 ) ) - 1 ) by L99 , L197 , L16;
thus L269: ( D6 . ( len D6 ) ) = ( C31 . ( ( ( D3 -' ( D4 + 1 ) ) + ( ( ( ( len C31 ) - D3 ) + ( D4 + 1 ) ) - 1 ) ) + 1 ) ) by L268 , L99 , L198 , L197 , L267 , L61
.= ( C31 . ( ( ( D3 - ( D4 + 1 ) ) + ( ( D4 + 1 ) + ( ( ( len C31 ) - D3 ) - 1 ) ) ) + 1 ) ) by L198 , XREAL_1:233
.= F2() by L94;
end;
end;
L271: 1 <= ( ( D4 + 1 ) - 1 ) by L100 , FINSEQ_3:25;
L272: F1() = ( D6 . 1 ) by L271 , L93 , L197 , L37;
L273: ( 0 ) < ( - ( - ( D3 - D4 ) ) ) by L191 , XREAL_1:50;
L274: ( - ( D3 - D4 ) ) < ( 0 ) by L273;
L275: ( ( len C31 ) + ( - ( D3 - D4 ) ) ) < ( ( len C31 ) + ( 0 ) ) by L274 , XREAL_1:8;
L276: ( ( ( ( len C31 ) - D3 ) + ( D4 + 1 ) ) - 1 ) < ( len C31 ) by L275;
L277: ( len D6 ) < ( len C31 ) by L276 , L99 , L197 , L16;
thus L278: contradiction by L277 , L91 , L92 , L272 , L250 , L200;
end;
end;
thus L280: thesis by L97 , L93 , L94 , L95 , L96;
end;
begin
theorem
L281: (for B39 being non  empty set holds (for B40 being  1-sorted-yielding (ManySortedSet of B39) holds (for B41 being (ManySortedSubset of ( Carrier B40 )) holds (for B42 being (Element of B39) holds (for B43 being (Subset of ( B40 . B42 )) holds ( B41 +* (B42 , B43) ) is (ManySortedSubset of ( Carrier B40 )))))))
proof
let C36 being non  empty set;
let C37 being  1-sorted-yielding (ManySortedSet of C36);
let C38 being (ManySortedSubset of ( Carrier C37 ));
let C39 being (Element of C36);
let C40 being (Subset of ( C37 . C39 ));
L282: C38 c= ( Carrier C37 ) by PBOOLE:def 18;
L283: ( dom C38 ) = C36 by PARTFUN1:def 2;
L284: ( C38 +* (C39 , C40) ) c= ( Carrier C37 )
proof
let C41 being set;
assume L285: C41 in C36;
reconsider D7 = C41 as (Element of C36) by L285;
per cases ;
suppose L286: C41 = C39;

L287: ( ( C38 +* (C39 , C40) ) . D7 ) = C40 by L286 , L283 , FUNCT_7:31;
L288: ( ( C38 +* (C39 , C40) ) . D7 ) c= (the carrier of ( C37 . D7 )) by L287 , L286;
thus L289: thesis by L288 , YELLOW_6:2;
end;
suppose L290: C41 <> C39;

L291: ( ( C38 +* (C39 , C40) ) . C41 ) = ( C38 . D7 ) by L290 , FUNCT_7:32;
thus L292: thesis by L291 , L282 , PBOOLE:def 2;
end;
end;
thus L294: thesis by L284 , PBOOLE:def 18;
end;
definition
let C42 being non  empty set;
let C43 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of C42);
mode Segre-Coset of C43
 -> (Subset of ( Segre_Product C43 ))
means :L295: (ex B44 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C43 )) st (it = ( product B44 ) & ( B44 . ( indx B44 ) ) = ( [#] ( C43 . ( indx B44 ) ) )));
existence
proof
set D8 = the  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C43 ));
reconsider D9 = ( D8 +* (( indx D8 ) , ( [#] ( C43 . ( indx D8 ) ) )) ) as (ManySortedSubset of ( Carrier C43 )) by L281;
L296: ( dom ( Carrier C43 ) ) = C42 by PARTFUN1:def 2;
L297: ( dom C43 ) = C42 by PARTFUN1:def 2;
L298: ( C43 . ( indx D8 ) ) in ( rng C43 ) by L297 , FUNCT_1:3;
L299: ( C43 . ( indx D8 ) ) is non  trivial by L298 , PENCIL_1:def 17;
reconsider D10 = D9 as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C43 )) by L299 , PENCIL_1:27;
L300: D10 c= ( Carrier C43 ) by PBOOLE:def 18;
L301: (for B45 being set holds (B45 in C42 implies ( D10 . B45 ) c= ( ( Carrier C43 ) . B45 ))) by L300 , PBOOLE:def 2;
L302: ( dom D10 ) = C42 by PARTFUN1:def 2;
reconsider D11 = ( product D10 ) as (Subset of ( Segre_Product C43 )) by L302 , L296 , L301 , CARD_3:27;
take D11;
L303: ( dom D8 ) = C42 by PARTFUN1:def 2;
L304: ( D10 . ( indx D8 ) ) = ( [#] ( C43 . ( indx D8 ) ) ) by L303 , FUNCT_7:31;
L305: ( indx D10 ) = ( indx D8 ) by L304 , L299 , PENCIL_1:def 21;
thus L306: thesis by L305 , L304;
end;
end;
theorem
L308: (for B46 being non  empty set holds (for B47 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of B46) holds (for B48 , B49 being (Segre-Coset of B47) holds (2 c= ( card ( B48 /\ B49 ) ) implies B48 = B49))))
proof
let C44 being non  empty set;
let C45 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of C44);
let C46 , C47 being (Segre-Coset of C45);
consider C48 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C45 )) such that L309: C46 = ( product C48 ) and L310: ( C48 . ( indx C48 ) ) = ( [#] ( C45 . ( indx C48 ) ) ) by L295;
consider C49 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C45 )) such that L311: C47 = ( product C49 ) and L312: ( C49 . ( indx C49 ) ) = ( [#] ( C45 . ( indx C49 ) ) ) by L295;
assume L313: 2 c= ( card ( C46 /\ C47 ) );
L314: ( indx C48 ) = ( indx C49 ) by L313 , L309 , L311 , PENCIL_1:26;
L315:
now
let C50 being set;
assume L316: C50 in C44;
per cases ;
suppose L317: C50 <> ( indx C48 );

thus L318: ( C48 . C50 ) = ( C49 . C50 ) by L317 , L313 , L309 , L311 , PENCIL_1:26;
end;
suppose L319: C50 = ( indx C48 );

thus L320: ( C48 . C50 ) = ( C49 . C50 ) by L319 , L310 , L312 , L314;
end;
end;
L322: ( dom C49 ) = C44 by PARTFUN1:def 2;
L323: ( dom C48 ) = C44 by PARTFUN1:def 2;
thus L324: thesis by L323 , L309 , L311 , L322 , L315 , FUNCT_1:2;
end;
definition
let C51 being TopStruct;
let C52 , C53 being (Subset of C51);
pred C52 , C53 are_joinable 
means
:L325: (ex B50 being (FinSequence of ( bool (the carrier of C51) )) st (C52 = ( B50 . 1 ) & C53 = ( B50 . ( len B50 ) ) & (for B51 being (Subset of C51) holds (B51 in ( rng B50 ) implies B51 is  closed_under_lines  strong)) & (for B52 being (Element of ( NAT )) holds ((1 <= B52 & B52 < ( len B50 )) implies 2 c= ( card ( ( B50 . B52 ) /\ ( B50 . ( B52 + 1 ) ) ) )))))
;end;
theorem
L327: (for B53 being TopStruct holds (for B54 , B55 being (Subset of B53) holds (B54 , B55 are_joinable  implies (ex B56 being  one-to-one (FinSequence of ( bool (the carrier of B53) )) st (B54 = ( B56 . 1 ) & B55 = ( B56 . ( len B56 ) ) & (for B57 being (Subset of B53) holds (B57 in ( rng B56 ) implies B57 is  closed_under_lines  strong)) & (for B58 being (Element of ( NAT )) holds ((1 <= B58 & B58 < ( len B56 )) implies 2 c= ( card ( ( B56 . B58 ) /\ ( B56 . ( B58 + 1 ) ) ) ))))))))
proof
defpred S2[ set , set ] means 2 c= ( card ( $1 /\ $2 ) );
let C54 being TopStruct;
let C55 , C56 being (Subset of C54);
assume L328: C55 , C56 are_joinable ;
consider C57 being (FinSequence of ( bool (the carrier of C54) )) such that L329: (C55 = ( C57 . 1 ) & C56 = ( C57 . ( len C57 ) )) and L330: (for B59 being (Subset of C54) holds (B59 in ( rng C57 ) implies B59 is  closed_under_lines  strong)) and L331: (for B60 being (Element of ( NAT )) holds ((1 <= B60 & B60 < ( len C57 )) implies 2 c= ( card ( ( C57 . B60 ) /\ ( C57 . ( B60 + 1 ) ) ) ))) by L328 , L325;
L332: (for B61 being (Element of ( NAT )) holds (for B62 , B63 being set holds ((1 <= B61 & B61 < ( len C57 ) & B62 = ( C57 . B61 ) & B63 = ( C57 . ( B61 + 1 ) )) implies S2[ B62 , B63 ]))) by L331;
consider C58 being  one-to-one (FinSequence of ( bool (the carrier of C54) )) such that L333: (C55 = ( C58 . 1 ) & C56 = ( C58 . ( len C58 ) )) and L334: ( rng C58 ) c= ( rng C57 ) and L335: (for B64 being (Element of ( NAT )) holds ((1 <= B64 & B64 < ( len C58 )) implies S2[ ( C58 . B64 ) , ( C58 . ( B64 + 1 ) ) ])) from FinSeqOneToOne(L329 , L332);
take C58;
thus L336: thesis by L330 , L333 , L334 , L335;
end;
theorem
L337: (for B65 being TopStruct holds (for B66 being (Subset of B65) holds (B66 is  closed_under_lines  strong implies B66 , B66 are_joinable )))
proof
let C59 being TopStruct;
let C60 being (Subset of C59);
assume L338: C60 is  closed_under_lines  strong;
reconsider D12 = <* C60 *> as (FinSequence of ( bool (the carrier of C59) ));
take D12;
thus L339: C60 = ( D12 . 1 ) by FINSEQ_1:40;
L340: ( len D12 ) = 1 by FINSEQ_1:40;
thus L341: C60 = ( D12 . ( len D12 ) ) by L340 , FINSEQ_1:40;
thus L342: (for B67 being (Subset of C59) holds (B67 in ( rng D12 ) implies B67 is  closed_under_lines  strong))
proof
let C61 being (Subset of C59);
assume L343: C61 in ( rng D12 );
L344: C61 in { C60 } by L343 , FINSEQ_1:38;
thus L345: thesis by L344 , L338 , TARSKI:def 1;
end;

let C62 being (Element of ( NAT ));
assume that
L346: 1 <= C62
and
L347: C62 < ( len D12 );
thus L348: thesis by L346 , L347 , FINSEQ_1:40;
end;
theorem
L349: (for B68 being non  empty set holds (for B69 being  PLS-yielding (ManySortedSet of B68) holds (for B70 , B71 being (Subset of ( Segre_Product B69 )) holds ((B70 is non  trivial  closed_under_lines  strong & B71 is non  trivial  closed_under_lines  strong & B70 , B71 are_joinable ) implies (for B72 , B73 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B69 )) holds ((B70 = ( product B72 ) & B71 = ( product B73 )) implies (( indx B72 ) = ( indx B73 ) & (for B74 being set holds (B74 <> ( indx B72 ) implies ( B72 . B74 ) = ( B73 . B74 ))))))))))
proof
let C63 being non  empty set;
let C64 being  PLS-yielding (ManySortedSet of C63);
let C65 , C66 being (Subset of ( Segre_Product C64 ));
assume that
L350: C65 is non  trivial  closed_under_lines  strong
and
L351: C66 is non  trivial  closed_under_lines  strong
and
L352: C65 , C66 are_joinable ;
set D13 = ( bool (the carrier of ( Segre_Product C64 )) );
consider C67 being (FinSequence of D13) such that L353: C65 = ( C67 . 1 ) and L354: C66 = ( C67 . ( len C67 ) ) and L355: (for B75 being (Subset of ( Segre_Product C64 )) holds (B75 in ( rng C67 ) implies B75 is  closed_under_lines  strong)) and L356: (for B76 being (Element of ( NAT )) holds ((1 <= B76 & B76 < ( len C67 )) implies 2 c= ( card ( ( C67 . B76 ) /\ ( C67 . ( B76 + 1 ) ) ) ))) by L352 , L325;
L357: ( len C67 ) in ( dom C67 ) by L351 , L354 , FUNCT_1:def 2;
L358: 1 <= ( len C67 ) by L357 , FINSEQ_3:25;
consider C68 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C64 )) such that L359: C65 = ( product C68 ) and L360: (for B77 being (Subset of ( C64 . ( indx C68 ) )) holds (B77 = ( C68 . ( indx C68 ) ) implies B77 is  strong  closed_under_lines)) by L350 , PENCIL_1:29;
let C69 , C70 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C64 ));
assume that
L361: C65 = ( product C69 )
and
L362: C66 = ( product C70 );
defpred S3[ (Element of ( NAT )) ] means (for B78 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C64 )) holds (( C67 . $1 ) = ( product B78 ) implies (( indx C69 ) = ( indx B78 ) & (for B79 being set holds (B79 <> ( indx C69 ) implies ( C69 . B79 ) = ( B78 . B79 ))))));
L363: C68 = C69 by L361 , L359 , PUA2MSS1:2;
L364: (for B80 being (Element of ( NAT )) holds ((1 <= B80 & B80 < ( len C67 )) implies (S3[ B80 ] implies S3[ ( B80 + 1 ) ])))
proof
let C71 being (Element of ( NAT ));
assume that
L365: 1 <= C71
and
L366: C71 < ( len C67 );
L367: C71 in ( dom C67 ) by L365 , L366 , FINSEQ_3:25;
L368: ( C67 . C71 ) in ( rng C67 ) by L367 , FUNCT_1:3;
L369: 1 <= ( C71 + 1 ) by NAT_1:11;
L370: ( C71 + 1 ) <= ( len C67 ) by L366 , NAT_1:13;
L371: ( C71 + 1 ) in ( dom C67 ) by L370 , L369 , FINSEQ_3:25;
L372: ( C67 . ( C71 + 1 ) ) in ( rng C67 ) by L371 , FUNCT_1:3;
reconsider D14 = ( C67 . C71 ) , D15 = ( C67 . ( C71 + 1 ) ) as (Subset of ( Segre_Product C64 )) by L372 , L368;
L373: ( card ( D14 /\ D15 ) ) c= ( card D14 ) by CARD_1:11 , XBOOLE_1:17;
L374: 2 c= ( card ( D14 /\ D15 ) ) by L356 , L365 , L366;
L375: 2 c= ( card ( D14 /\ D15 ) ) by L356 , L365 , L366;
L376: 2 c= ( card D14 ) by L375 , L373 , XBOOLE_1:1;
L377: D14 is non  trivial  closed_under_lines  strong by L376 , L355 , L368 , PENCIL_1:4;
consider C72 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C64 )) such that L378: D14 = ( product C72 ) and L379: (for B81 being (Subset of ( C64 . ( indx C72 ) )) holds (B81 = ( C72 . ( indx C72 ) ) implies B81 is  strong  closed_under_lines)) by L377 , PENCIL_1:29;
assume L380: S3[ C71 ];
L381: ( indx C68 ) = ( indx C72 ) by L380 , L363 , L378;
L382:
now
let C73 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C64 ));
assume L383: ( C67 . ( C71 + 1 ) ) = ( product C73 );
thus L384: ( indx C69 ) = ( indx C73 ) by L383 , L363 , L378 , L381 , L374 , PENCIL_1:26;
thus L385: (for B82 being set holds (B82 <> ( indx C69 ) implies ( C69 . B82 ) = ( C73 . B82 )))
proof
let C74 being set;
assume L386: C74 <> ( indx C69 );
L387: C74 <> ( indx C72 ) by L386 , L380 , L378;
thus L388: ( C69 . C74 ) = ( C72 . C74 ) by L380 , L378 , L386
.= ( C73 . C74 ) by L378 , L374 , L383 , L387 , PENCIL_1:26;
end;

end;
thus L386: thesis by L382;
end;
L387: S3[ 1 ] by L361 , L353 , PUA2MSS1:2;
L388: (for B83 being (Element of ( NAT )) holds ((1 <= B83 & B83 <= ( len C67 )) implies S3[ B83 ])) from INT_1:sch 7(L387 , L364);
thus L389: thesis by L388 , L362 , L354 , L358;
end;
begin
theorem
L390: (for B84 being 1-sorted holds (for B85 being non  empty 1-sorted holds (for B86 being (Function of B84 , B85) holds (B86 is  bijective implies ( B86 " ) is  bijective))))
proof
let C75 being 1-sorted;
let C76 being non  empty 1-sorted;
let C77 being (Function of C75 , C76);
assume L391: C77 is  bijective;
L392: ( rng C77 ) = ( [#] C76 ) by L391 , FUNCT_2:def 3;
L393: ( rng ( C77 " ) ) = ( [#] C75 ) by L392 , L391 , TOPS_2:49;
L394: ( C77 " ) is  onto by L393 , FUNCT_2:def 3;
L395: ( C77 " ) is  one-to-one by L391 , L392 , TOPS_2:50;
thus L396: thesis by L395 , L394;
end;
definition
let C78 , C79 being TopStruct;
let C80 being (Function of C78 , C79);
attr C80 is  isomorphic
means
:L397: (C80 is  bijective  open & ( C80 " ) is  bijective  open);
end;
registration
let C81 being non  empty TopStruct;
cluster  isomorphic for (Function of C81 , C81);
existence
proof
take D16 = ( id C81 );
L399: ( D16 " ) = ( id C81 ) by TOPGRP_1:2;
thus L400: D16 is  isomorphic by L399 , L397;
end;
end;
definition
let C82 being non  empty TopStruct;
mode Collineation of C82
 is  isomorphic (Function of C82 , C82);
end;
definition
let C83 being non  empty non  void TopStruct;
let C84 being (Collineation of C83);
let C85 being (Block of C83);
redefine func C84 .: C85 -> (Block of C83);

coherence
proof
L403: C85 in (the topology of C83);
reconsider D17 = C85 as (Subset of C83) by L403;
L404: D17 is  open by PRE_TOPC:def 2;
L405: C84 is  open by L397;
L406: ( C84 .: D17 ) is  open by L405 , L404 , T_0TOPSP:def 2;
thus L407: thesis by L406 , PRE_TOPC:def 2;
end;
end;
definition
let C86 being non  empty non  void TopStruct;
let C87 being (Collineation of C86);
let C88 being (Block of C86);
redefine func C87 " C88 -> (Block of C86);

coherence
proof
L409: C88 in (the topology of C86);
reconsider D18 = C88 as (Subset of C86) by L409;
L410: D18 is  open by PRE_TOPC:def 2;
L411: C87 is  bijective by L397;
L412: ( C87 " ) = ( (C87 qua Function) " ) by L411 , TOPS_2:def 4;
L413: ( ( C87 " ) .: D18 ) = ( C87 " D18 ) by L412 , L411 , FUNCT_1:85;
L414: ( C87 " ) is  open by L397;
L415: ( ( C87 " ) .: D18 ) is  open by L414 , L410 , T_0TOPSP:def 2;
thus L416: thesis by L415 , L413 , PRE_TOPC:def 2;
end;
end;
theorem
L418: (for B87 being non  empty TopStruct holds (for B88 being (Collineation of B87) holds ( B88 " ) is (Collineation of B87)))
proof
let C89 being non  empty TopStruct;
let C90 being (Collineation of C89);
L419: ( C90 " ) is  bijective  open by L397;
L420: C90 is  bijective by L397;
L421: ( rng C90 ) = ( [#] C89 ) by L420 , FUNCT_2:def 3;
L422: ( ( C90 " ) " ) = C90 by L421 , L420 , TOPS_2:51;
L423: ( ( C90 " ) " ) is  open by L422 , L397;
L424: ( ( C90 " ) " ) is  bijective by L420 , L421 , TOPS_2:51;
thus L425: thesis by L424 , L419 , L423 , L397;
end;
theorem
L426: (for B89 being non  empty TopStruct holds (for B90 being (Collineation of B89) holds (for B91 being (Subset of B89) holds (B91 is non  trivial implies ( B90 .: B91 ) is non  trivial))))
proof
let C91 being non  empty TopStruct;
let C92 being (Collineation of C91);
let C93 being (Subset of C91);
assume L427: C93 is non  trivial;
L428: 2 c= ( card C93 ) by L427 , PENCIL_1:4;
consider C94 , C95 being set such that L429: C94 in C93 and L430: C95 in C93 and L431: C94 <> C95 by L428 , PENCIL_1:2;
L432: ( dom C92 ) = (the carrier of C91) by FUNCT_2:def 1;
L433: ( C92 . C94 ) in ( C92 .: C93 ) by L432 , L429 , FUNCT_1:def 6;
L434: ( C92 . C95 ) in ( C92 .: C93 ) by L432 , L430 , FUNCT_1:def 6;
L435: C92 is  bijective by L397;
L436: ( C92 . C94 ) <> ( C92 . C95 ) by L435 , L432 , L429 , L430 , L431 , FUNCT_1:def 4;
L437: 2 c= ( card ( C92 .: C93 ) ) by L436 , L433 , L434 , PENCIL_1:2;
thus L438: thesis by L437 , PENCIL_1:4;
end;
theorem
L439: (for B92 being non  empty TopStruct holds (for B93 being (Collineation of B92) holds (for B94 being (Subset of B92) holds (B94 is non  trivial implies ( B93 " B94 ) is non  trivial))))
proof
let C96 being non  empty TopStruct;
let C97 being (Collineation of C96);
let C98 being (Subset of C96);
assume L440: C98 is non  trivial;
L441: 2 c= ( card C98 ) by L440 , PENCIL_1:4;
consider C99 , C100 being set such that L442: C99 in C98 and L443: C100 in C98 and L444: C99 <> C100 by L441 , PENCIL_1:2;
L445: C97 is  bijective by L397;
L446: ( rng C97 ) = (the carrier of C96) by L445 , FUNCT_2:def 3;
consider C101 being set such that L447: C101 in ( dom C97 ) and L448: ( C97 . C101 ) = C99 by L446 , L442 , FUNCT_1:def 3;
consider C102 being set such that L449: C102 in ( dom C97 ) and L450: ( C97 . C102 ) = C100 by L446 , L443 , FUNCT_1:def 3;
L451: C102 in ( C97 " C98 ) by L443 , L449 , L450 , FUNCT_1:def 7;
L452: C101 in ( C97 " C98 ) by L442 , L447 , L448 , FUNCT_1:def 7;
L453: 2 c= ( card ( C97 " C98 ) ) by L452 , L444 , L448 , L450 , L451 , PENCIL_1:2;
thus L454: thesis by L453 , PENCIL_1:4;
end;
theorem
L455: (for B95 being non  empty non  void TopStruct holds (for B96 being (Collineation of B95) holds (for B97 being (Subset of B95) holds (B97 is  strong implies ( B96 .: B97 ) is  strong))))
proof
let C103 being non  empty non  void TopStruct;
let C104 being (Collineation of C103);
let C105 being (Subset of C103);
assume L456: C105 is  strong;
thus L457: ( C104 .: C105 ) is  strong
proof
let C106 , C107 being (Point of C103);
assume that
L458: C106 in ( C104 .: C105 )
and
L459: C107 in ( C104 .: C105 );
thus L460: C106 , C107 are_collinear 
proof
per cases ;
suppose L461: C106 = C107;

thus L462: thesis by L461 , PENCIL_1:def 1;
end;
suppose L463: C106 <> C107;

consider C108 being set such that L464: C108 in ( dom C104 ) and L465: C108 in C105 and L466: C107 = ( C104 . C108 ) by L459 , FUNCT_1:def 6;
consider C109 being set such that L467: C109 in ( dom C104 ) and L468: C109 in C105 and L469: C106 = ( C104 . C109 ) by L458 , FUNCT_1:def 6;
reconsider D19 = C109 , D20 = C108 as (Point of C103) by L467 , L464;
L470: D19 , D20 are_collinear  by L456 , L468 , L465 , PENCIL_1:def 3;
consider C110 being (Block of C103) such that L471: { D19 , D20 } c= C110 by L470 , L463 , L469 , L466 , PENCIL_1:def 1;
L472: D20 in C110 by L471 , ZFMISC_1:32;
L473: C107 in ( C104 .: C110 ) by L472 , L464 , L466 , FUNCT_1:def 6;
L474: D19 in C110 by L471 , ZFMISC_1:32;
L475: C106 in ( C104 .: C110 ) by L474 , L467 , L469 , FUNCT_1:def 6;
L476: { C106 , C107 } c= ( C104 .: C110 ) by L475 , L473 , ZFMISC_1:32;
thus L477: thesis by L476 , PENCIL_1:def 1;
end;
end;

end;

end;
theorem
L458: (for B98 being non  empty non  void TopStruct holds (for B99 being (Collineation of B98) holds (for B100 being (Subset of B98) holds (B100 is  strong implies ( B99 " B100 ) is  strong))))
proof
let C111 being non  empty non  void TopStruct;
let C112 being (Collineation of C111);
reconsider D21 = ( C112 " ) as (Collineation of C111) by L418;
let C113 being (Subset of C111);
assume L459: C113 is  strong;
L460: ( D21 .: C113 ) is  strong by L459 , L455;
L461: C112 is  bijective by L397;
L462: ( rng C112 ) = ( [#] C111 ) by L461 , FUNCT_2:def 3;
thus L463: thesis by L462 , L461 , L460 , TOPS_2:55;
end;
theorem
L464: (for B101 being non  empty non  void TopStruct holds (for B102 being (Collineation of B101) holds (for B103 being (Subset of B101) holds (B103 is  closed_under_lines implies ( B102 .: B103 ) is  closed_under_lines))))
proof
let C114 being non  empty non  void TopStruct;
let C115 being (Collineation of C114);
let C116 being (Subset of C114);
assume L465: C116 is  closed_under_lines;
thus L466: ( C115 .: C116 ) is  closed_under_lines
proof
let C117 being (Block of C114);
assume L467: 2 c= ( card ( C117 /\ ( C115 .: C116 ) ) );
consider C118 , C119 being set such that L468: C118 in ( C117 /\ ( C115 .: C116 ) ) and L469: C119 in ( C117 /\ ( C115 .: C116 ) ) and L470: C118 <> C119 by L467 , PENCIL_1:2;
L471: C119 in ( C115 .: C116 ) by L469 , XBOOLE_0:def 4;
consider C120 being set such that L472: C120 in ( dom C115 ) and L473: C120 in C116 and L474: C119 = ( C115 . C120 ) by L471 , FUNCT_1:def 6;
L475: C119 in C117 by L469 , XBOOLE_0:def 4;
L476: C120 in ( C115 " C117 ) by L475 , L472 , L474 , FUNCT_1:def 7;
L477: C120 in ( ( C115 " C117 ) /\ C116 ) by L476 , L473 , XBOOLE_0:def 4;
L478: C118 in ( C115 .: C116 ) by L468 , XBOOLE_0:def 4;
consider C121 being set such that L479: C121 in ( dom C115 ) and L480: C121 in C116 and L481: C118 = ( C115 . C121 ) by L478 , FUNCT_1:def 6;
L482: C118 in C117 by L468 , XBOOLE_0:def 4;
L483: C121 in ( C115 " C117 ) by L482 , L479 , L481 , FUNCT_1:def 7;
L484: C121 in ( ( C115 " C117 ) /\ C116 ) by L483 , L480 , XBOOLE_0:def 4;
L485: 2 c= ( card ( ( C115 " C117 ) /\ C116 ) ) by L484 , L470 , L481 , L474 , L477 , PENCIL_1:2;
L486: ( C115 " C117 ) c= C116 by L485 , L465 , PENCIL_1:def 2;
L487: ( C115 .: ( C115 " C117 ) ) c= ( C115 .: C116 ) by L486 , RELAT_1:123;
L488: C115 is  bijective by L397;
L489: ( rng C115 ) = (the carrier of C114) by L488 , FUNCT_2:def 3;
L490: C117 in (the topology of C114);
thus L491: thesis by L490 , L489 , L487 , FUNCT_1:77;
end;

end;
theorem
L467: (for B104 being non  empty non  void TopStruct holds (for B105 being (Collineation of B104) holds (for B106 being (Subset of B104) holds (B106 is  closed_under_lines implies ( B105 " B106 ) is  closed_under_lines))))
proof
let C122 being non  empty non  void TopStruct;
let C123 being (Collineation of C122);
reconsider D22 = ( C123 " ) as (Collineation of C122) by L418;
let C124 being (Subset of C122);
assume L468: C124 is  closed_under_lines;
L469: ( D22 .: C124 ) is  closed_under_lines by L468 , L464;
L470: C123 is  bijective by L397;
L471: ( rng C123 ) = ( [#] C122 ) by L470 , FUNCT_2:def 3;
thus L472: thesis by L471 , L470 , L469 , TOPS_2:55;
end;
theorem
L473: (for B107 being non  empty non  void TopStruct holds (for B108 being (Collineation of B107) holds (for B109 , B110 being (Subset of B107) holds ((B109 is non  trivial & B110 is non  trivial & B109 , B110 are_joinable ) implies ( B108 .: B109 ) , ( B108 .: B110 ) are_joinable ))))
proof
let C125 being non  empty non  void TopStruct;
let C126 being (Collineation of C125);
let C127 , C128 being (Subset of C125);
assume that
L474: C127 is non  trivial
and
L475: C128 is non  trivial
and
L476: C127 , C128 are_joinable ;
consider C129 being (FinSequence of ( bool (the carrier of C125) )) such that L477: C127 = ( C129 . 1 ) and L478: C128 = ( C129 . ( len C129 ) ) and L479: (for B111 being (Subset of C125) holds (B111 in ( rng C129 ) implies B111 is  closed_under_lines  strong)) and L480: (for B112 being (Element of ( NAT )) holds ((1 <= B112 & B112 < ( len C129 )) implies 2 c= ( card ( ( C129 . B112 ) /\ ( C129 . ( B112 + 1 ) ) ) ))) by L476 , L325;
deffunc H1(set) = ( C126 .: ( C129 . $1 ) );
consider C130 being FinSequence such that L481: (( len C130 ) = ( len C129 ) & (for B113 being Nat holds (B113 in ( dom C130 ) implies ( C130 . B113 ) = H1(B113)))) from FINSEQ_1:sch 2;
L482: ( dom C129 ) = ( Seg ( len C129 ) ) by FINSEQ_1:def 3;
L483: ( dom C130 ) = ( Seg ( len C130 ) ) by FINSEQ_1:def 3;
L484: ( rng C130 ) c= ( bool (the carrier of C125) )
proof
let C131 being set;
assume L485: C131 in ( rng C130 );
consider C132 being set such that L486: C132 in ( dom C130 ) and L487: C131 = ( C130 . C132 ) by L485 , FUNCT_1:def 3;
reconsider D23 = C132 as (Element of ( NAT )) by L486;
L488: ( C129 . D23 ) in ( rng C129 ) by L481 , L483 , L482 , L486 , FUNCT_1:3;
reconsider D24 = ( C129 . D23 ) as (Subset of C125) by L488;
L489: ( C130 . D23 ) = ( C126 .: D24 ) by L481 , L486;
thus L490: thesis by L489 , L487;
end;
reconsider D25 = C130 as (FinSequence of ( bool (the carrier of C125) )) by L484 , FINSEQ_1:def 4;
take D25;
L491: 1 in ( dom C129 ) by L474 , L477 , FUNCT_1:def 2;
thus L492: ( C126 .: C127 ) = ( D25 . 1 ) by L491 , L477 , L481 , L483 , L482;
L493: ( len C129 ) in ( dom C129 ) by L475 , L478 , FUNCT_1:def 2;
thus L494: ( C126 .: C128 ) = ( D25 . ( len D25 ) ) by L493 , L478 , L481 , L483 , L482;
thus L495: (for B114 being (Subset of C125) holds (B114 in ( rng D25 ) implies B114 is  closed_under_lines  strong))
proof
let C133 being (Subset of C125);
assume L496: C133 in ( rng D25 );
consider C134 being set such that L497: C134 in ( dom D25 ) and L498: C133 = ( D25 . C134 ) by L496 , FUNCT_1:def 3;
reconsider D26 = C134 as (Element of ( NAT )) by L497;
L499: ( C129 . D26 ) in ( rng C129 ) by L481 , L483 , L482 , L497 , FUNCT_1:3;
reconsider D27 = ( C129 . D26 ) as (Subset of C125) by L499;
L500: D27 in ( rng C129 ) by L481 , L483 , L482 , L497 , FUNCT_1:3;
L501: D27 is  strong  closed_under_lines by L500 , L479;
L502: ( D25 . D26 ) = ( C126 .: D27 ) by L481 , L497;
thus L503: thesis by L502 , L498 , L501 , L455 , L464;
end;

L504: C126 is  bijective by L397;
thus L505: (for B115 being (Element of ( NAT )) holds ((1 <= B115 & B115 < ( len D25 )) implies 2 c= ( card ( ( D25 . B115 ) /\ ( D25 . ( B115 + 1 ) ) ) )))
proof
let C135 being (Element of ( NAT ));
assume that
L506: 1 <= C135
and
L507: C135 < ( len D25 );
L508: ( ( C129 . C135 ) /\ ( C129 . ( C135 + 1 ) ) ) c= ( C129 . C135 ) by XBOOLE_1:17;
L509: C135 in ( dom C129 ) by L481 , L506 , L507 , FINSEQ_3:25;
L510: ( C129 . C135 ) in ( rng C129 ) by L509 , FUNCT_1:3;
reconsider D28 = ( ( C129 . C135 ) /\ ( C129 . ( C135 + 1 ) ) ) as (Subset of C125) by L510 , L508 , XBOOLE_1:1;
L511: 2 c= ( card ( ( C129 . C135 ) /\ ( C129 . ( C135 + 1 ) ) ) ) by L480 , L481 , L506 , L507;
L512: D28 is non  trivial by L511 , PENCIL_1:4;
L513: ( C126 .: D28 ) is non  trivial by L512 , L426;
L514: ( ( C126 .: ( C129 . C135 ) ) /\ ( C126 .: ( C129 . ( C135 + 1 ) ) ) ) is non  trivial by L513 , L504 , FUNCT_1:62;
L515: ( C135 + 1 ) <= ( len D25 ) by L507 , NAT_1:13;
L516: 1 <= ( C135 + 1 ) by L506 , NAT_1:13;
L517: ( C135 + 1 ) in ( dom D25 ) by L516 , L515 , FINSEQ_3:25;
L518: ( D25 . ( C135 + 1 ) ) = ( C126 .: ( C129 . ( C135 + 1 ) ) ) by L517 , L481;
L519: C135 in ( dom C129 ) by L481 , L506 , L507 , FINSEQ_3:25;
L520: ( D25 . C135 ) = ( C126 .: ( C129 . C135 ) ) by L519 , L481 , L483 , L482;
thus L521: thesis by L520 , L518 , L514 , PENCIL_1:4;
end;

end;
theorem
L506: (for B116 being non  empty non  void TopStruct holds (for B117 being (Collineation of B116) holds (for B118 , B119 being (Subset of B116) holds ((B118 is non  trivial & B119 is non  trivial & B118 , B119 are_joinable ) implies ( B117 " B118 ) , ( B117 " B119 ) are_joinable ))))
proof
let C136 being non  empty non  void TopStruct;
let C137 being (Collineation of C136);
let C138 , C139 being (Subset of C136);
reconsider D29 = ( C137 " ) as (Collineation of C136) by L418;
assume that
L507: C138 is non  trivial
and
L508: C139 is non  trivial
and
L509: C138 , C139 are_joinable ;
L510: C137 is  bijective by L397;
L511: ( rng C137 ) = ( [#] C136 ) by L510 , FUNCT_2:def 3;
L512: ( C137 " C139 ) = ( D29 .: C139 ) by L511 , L510 , TOPS_2:55;
L513: ( C137 " C138 ) = ( D29 .: C138 ) by L510 , L511 , TOPS_2:55;
thus L514: thesis by L513 , L512 , L507 , L508 , L509 , L473;
end;
theorem
L515: (for B120 being non  empty set holds (for B121 being  PLS-yielding (ManySortedSet of B120) holds ((for B122 being (Element of B120) holds ( B121 . B122 ) is  strongly_connected) implies (for B123 being (Subset of ( Segre_Product B121 )) holds (B123 is non  trivial  strong  closed_under_lines implies ( union { B124 where B124 is (Subset of ( Segre_Product B121 )) : (B124 is non  trivial  strong  closed_under_lines & B123 , B124 are_joinable ) } ) is (Segre-Coset of B121))))))
proof
let C140 being non  empty set;
let C141 being  PLS-yielding (ManySortedSet of C140);
assume L516: (for B125 being (Element of C140) holds ( C141 . B125 ) is  strongly_connected);
let C142 being (Subset of ( Segre_Product C141 ));
assume that
L517: C142 is non  trivial  strong  closed_under_lines;
consider C143 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C141 )) such that L518: C142 = ( product C143 ) and L519: (for B126 being (Subset of ( C141 . ( indx C143 ) )) holds (B126 = ( C143 . ( indx C143 ) ) implies B126 is  strong  closed_under_lines)) by L517 , PENCIL_1:29;
set D30 = ( [#] ( C141 . ( indx C143 ) ) );
set D31 = ( union { B127 where B127 is (Subset of ( Segre_Product C141 )) : (B127 is non  trivial  strong  closed_under_lines & C142 , B127 are_joinable ) } );
L520: D31 c= (the carrier of ( Segre_Product C141 ))
proof
let C144 being set;
assume L521: C144 in D31;
consider C145 being set such that L522: C144 in C145 and L523: C145 in { B128 where B128 is (Subset of ( Segre_Product C141 )) : (B128 is non  trivial  strong  closed_under_lines & C142 , B128 are_joinable ) } by L521 , TARSKI:def 4;
L524: (ex B129 being (Subset of ( Segre_Product C141 )) st (C145 = B129 & B129 is non  trivial  strong  closed_under_lines & C142 , B129 are_joinable )) by L523;
thus L525: thesis by L524 , L522;
end;
reconsider D32 = D31 as (Subset of ( Segre_Product C141 )) by L520;
L526: ( dom C141 ) = C140 by PARTFUN1:def 2;
L527: ( C141 . ( indx C143 ) ) in ( rng C141 ) by L526 , FUNCT_1:3;
L528: ( C141 . ( indx C143 ) ) is non  trivial by L527 , PENCIL_1:def 17;
reconsider D33 = ( C143 +* (( indx C143 ) , D30) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C141 )) by L528 , L281 , PENCIL_1:27;
L529: ( dom C143 ) = C140 by PARTFUN1:def 2;
L530: ( D33 . ( indx C143 ) ) = D30 by L529 , FUNCT_7:31;
L531: ( indx C143 ) = ( indx D33 ) by L530 , L528 , PENCIL_1:def 21;
L532: ( product D33 ) c= D32
proof
L533: C143 c= ( Carrier C141 ) by PBOOLE:def 18;
L534: ( C143 . ( indx C143 ) ) c= ( ( Carrier C141 ) . ( indx C143 ) ) by L533 , PBOOLE:def 2;
reconsider D34 = ( C143 . ( indx C143 ) ) as (Subset of ( C141 . ( indx C143 ) )) by L534 , YELLOW_6:2;
let C146 being set;
L535: ( dom C143 ) = C140 by PARTFUN1:def 2;
L536: ( C141 . ( indx C143 ) ) is  strongly_connected by L516;
assume L537: C146 in ( product D33 );
consider C147 being Function such that L538: C147 = C146 and L539: ( dom C147 ) = ( dom D33 ) and L540: (for B130 being set holds (B130 in ( dom D33 ) implies ( C147 . B130 ) in ( D33 . B130 ))) by L537 , CARD_3:def 5;
L541: ( dom D33 ) = C140 by PARTFUN1:def 2;
reconsider D35 = C147 as (ManySortedSet of C140) by L541 , L539 , PARTFUN1:def 2 , RELAT_1:def 18;
L542: ( D35 . ( indx C143 ) ) in ( D33 . ( indx C143 ) ) by L540 , L541;
reconsider D36 = ( D35 . ( indx C143 ) ) as (Point of ( C141 . ( indx C143 ) )) by L542 , L535 , FUNCT_7:31;
L543: D34 is non  trivial  strong  closed_under_lines by L519 , PENCIL_1:def 21;
consider C148 being (FinSequence of ( bool (the carrier of ( C141 . ( indx C143 ) )) )) such that L544: D34 = ( C148 . 1 ) and L545: D36 in ( C148 . ( len C148 ) ) and L546: (for B131 being (Subset of ( C141 . ( indx C143 ) )) holds (B131 in ( rng C148 ) implies B131 is  closed_under_lines  strong)) and L547: (for B132 being Nat holds ((1 <= B132 & B132 < ( len C148 )) implies 2 c= ( card ( ( C148 . B132 ) /\ ( C148 . ( B132 + 1 ) ) ) ))) by L543 , L536 , PENCIL_1:def 11;
L548: ( len C148 ) in ( dom C148 ) by L545 , FUNCT_1:def 2;
L549: 1 in ( dom C148 ) by L548 , FINSEQ_5:6 , RELAT_1:38;
L550: 1 in ( Seg ( len C148 ) ) by L549 , FINSEQ_1:def 3;
L551: ( C148 . ( len C148 ) ) is non  trivial
proof
reconsider D37 = ( ( len C148 ) - 1 ) as (Element of ( NAT )) by L548 , FINSEQ_3:26;
L552: 1 <= ( len C148 ) by L548 , FINSEQ_3:25;
per cases  by L552 , XXREAL_0:1;
suppose L553: ( len C148 ) = 1;

thus L554: thesis by L553 , L544 , PENCIL_1:def 21;
end;
suppose L555: ( len C148 ) > 1;

L556: ( 1 + 1 ) <= ( len C148 ) by L555 , NAT_1:13;
L557: ( 2 - 1 ) <= D37 by L556 , XREAL_1:9;
L558: ( card ( ( C148 . D37 ) /\ ( C148 . ( D37 + 1 ) ) ) ) c= ( card ( C148 . ( D37 + 1 ) ) ) by CARD_1:11 , XBOOLE_1:17;
L559: D37 < ( ( len C148 ) - ( 0 ) ) by XREAL_1:15;
L560: 2 c= ( card ( ( C148 . D37 ) /\ ( C148 . ( D37 + 1 ) ) ) ) by L559 , L547 , L557;
L561: 2 c= ( card ( C148 . ( D37 + 1 ) ) ) by L560 , L558 , XBOOLE_1:1;
thus L562: thesis by L561 , PENCIL_1:4;
end;
end;
reconsider D38 = ( C148 . ( len C148 ) ) as non  trivial set by L551;
L564: ( D33 . ( indx C143 ) ) = D30 by L535 , FUNCT_7:31;
L565: ( indx C143 ) = ( indx D33 ) by L564 , L528 , PENCIL_1:def 21;
reconsider D39 = ( D33 +* (( indx C143 ) , D38) ) as  Segre-like non  trivial-yielding (ManySortedSet of C140) by L565 , PENCIL_1:27;
L566: ( dom D35 ) = ( dom ( D33 +* (( indx C143 ) , ( C148 . ( len C148 ) )) ) ) by L539 , FUNCT_7:30;
deffunc H2(set) = ( product ( D33 +* (( indx C143 ) , ( C148 . $1 )) ) );
consider C149 being FinSequence such that L567: (( len C149 ) = ( len C148 ) & (for B133 being Nat holds (B133 in ( dom C149 ) implies ( C149 . B133 ) = H2(B133)))) from FINSEQ_1:sch 2;
L568: ( rng C149 ) c= ( bool (the carrier of ( Segre_Product C141 )) )
proof
let C150 being set;
L569: ( dom ( Carrier C141 ) ) = C140 by PARTFUN1:def 2;
assume L570: C150 in ( rng C149 );
consider C151 being set such that L571: C151 in ( dom C149 ) and L572: C150 = ( C149 . C151 ) by L570 , FUNCT_1:def 3;
reconsider D40 = C151 as (Element of ( NAT )) by L571;
L573: D40 in ( Seg ( len C148 ) ) by L567 , L571 , FINSEQ_1:def 3;
L574:
now
let C152 being set;
assume L575: C152 in C140;
L576: D40 in ( dom C148 ) by L573 , FINSEQ_1:def 3;
per cases ;
suppose L577: C152 <> ( indx C143 );

L578: ( ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) . C152 ) = ( D33 . C152 ) by L577 , FUNCT_7:32;
L579: ( ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) . C152 ) = ( C143 . C152 ) by L578 , L577 , FUNCT_7:32;
L580: C143 c= ( Carrier C141 ) by PBOOLE:def 18;
thus L581: ( ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) . C152 ) c= ( ( Carrier C141 ) . C152 ) by L580 , L575 , L579 , PBOOLE:def 2;
end;
suppose L582: C152 = ( indx C143 );

L583: ( ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) . C152 ) = ( C148 . D40 ) by L582 , L541 , FUNCT_7:31;
L584: ( ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) . C152 ) in ( rng C148 ) by L583 , L576 , FUNCT_1:3;
L585: ( ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) . C152 ) c= (the carrier of ( C141 . ( indx C143 ) )) by L584;
thus L586: ( ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) . C152 ) c= ( ( Carrier C141 ) . C152 ) by L585 , L582 , YELLOW_6:2;
end;
end;
L588: ( dom ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) ) = C140 by PARTFUN1:def 2;
L589: ( product ( D33 +* (( indx C143 ) , ( C148 . D40 )) ) ) c= ( product ( Carrier C141 ) ) by L588 , L569 , L574 , CARD_3:27;
L590: C150 c= ( product ( Carrier C141 ) ) by L589 , L567 , L571 , L572;
thus L591: thesis by L590;
end;
L592: ( dom C149 ) = ( Seg ( len C148 ) ) by L567 , FINSEQ_1:def 3;
reconsider D41 = C149 as (FinSequence of ( bool (the carrier of ( Segre_Product C141 )) )) by L568 , FINSEQ_1:def 4;
L593: ( len C148 ) in ( dom D41 ) by L548 , L567 , FINSEQ_3:29;
L594: ( D41 . ( len C148 ) ) in ( rng D41 ) by L593 , FUNCT_1:3;
reconsider D42 = ( D41 . ( len C148 ) ) as (Subset of ( Segre_Product C141 )) by L594;
L595:
now
let C153 being set;
assume L596: C153 in C140;
per cases ;
suppose L597: C153 <> ( indx C143 );

L598: ( ( D33 +* (( indx C143 ) , ( C148 . 1 )) ) . C153 ) = ( D33 . C153 ) by L597 , FUNCT_7:32;
thus L599: ( ( D33 +* (( indx C143 ) , ( C148 . 1 )) ) . C153 ) = ( C143 . C153 ) by L598 , L597 , FUNCT_7:32;
end;
suppose L600: C153 = ( indx C143 );

thus L601: ( ( D33 +* (( indx C143 ) , ( C148 . 1 )) ) . C153 ) = ( C143 . C153 ) by L600 , L541 , L544 , FUNCT_7:31;
end;
end;
L603: (for B134 being (Subset of ( Segre_Product C141 )) holds (B134 in ( rng D41 ) implies B134 is  closed_under_lines  strong))
proof
let C154 being (Subset of ( Segre_Product C141 ));
assume L604: C154 in ( rng D41 );
consider C155 being set such that L605: C155 in ( dom D41 ) and L606: C154 = ( D41 . C155 ) by L604 , FUNCT_1:def 3;
reconsider D43 = C155 as (Element of ( NAT )) by L605;
L607: D43 in ( Seg ( len C148 ) ) by L567 , L605 , FINSEQ_1:def 3;
L608: D43 in ( dom C148 ) by L607 , FINSEQ_1:def 3;
L609: ( C148 . D43 ) is non  trivial
proof
L610: D43 <= ( len C148 ) by L608 , FINSEQ_3:25;
per cases  by L608 , L610 , FINSEQ_3:25 , XXREAL_0:1;
suppose L611: (1 <= D43 & D43 = ( len C148 ));

thus L612: thesis by L611 , L551;
end;
suppose L613: (1 <= D43 & D43 < ( len C148 ));

L614: ( card ( ( C148 . D43 ) /\ ( C148 . ( D43 + 1 ) ) ) ) c= ( card ( C148 . D43 ) ) by CARD_1:11 , XBOOLE_1:17;
L615: 2 c= ( card ( ( C148 . D43 ) /\ ( C148 . ( D43 + 1 ) ) ) ) by L547 , L613;
L616: 2 c= ( card ( C148 . D43 ) ) by L615 , L614 , XBOOLE_1:1;
thus L617: thesis by L616 , PENCIL_1:4;
end;
end;
reconsider D44 = ( C148 . D43 ) as non  trivial set by L609;
L619: ( D33 +* (( indx C143 ) , ( C148 . D43 )) ) c= ( Carrier C141 )
proof
let C156 being set;
assume L620: C156 in C140;
per cases ;
suppose L621: C156 <> ( indx C143 );

L622: D33 c= ( Carrier C141 ) by PBOOLE:def 18;
L623: ( ( D33 +* (( indx C143 ) , ( C148 . D43 )) ) . C156 ) = ( D33 . C156 ) by L621 , FUNCT_7:32;
thus L624: thesis by L623 , L620 , L622 , PBOOLE:def 2;
end;
suppose L625: C156 = ( indx C143 );

L626: ( ( D33 +* (( indx C143 ) , ( C148 . D43 )) ) . C156 ) = ( C148 . D43 ) by L625 , L541 , FUNCT_7:31;
L627: ( ( D33 +* (( indx C143 ) , ( C148 . D43 )) ) . C156 ) in ( rng C148 ) by L626 , L608 , FUNCT_1:3;
L628: ( ( D33 +* (( indx C143 ) , ( C148 . D43 )) ) . C156 ) c= (the carrier of ( C141 . ( indx C143 ) )) by L627;
thus L629: thesis by L628 , L625 , YELLOW_6:2;
end;
end;
L631: ( D33 . ( indx C143 ) ) = D30 by L535 , FUNCT_7:31;
L632: ( indx C143 ) = ( indx D33 ) by L631 , L528 , PENCIL_1:def 21;
reconsider D45 = ( D33 +* (( indx C143 ) , D44) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C141 )) by L632 , L619 , PBOOLE:def 18 , PENCIL_1:27;
reconsider D46 = D45 as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C141 ));
L633: ( D46 . ( indx C143 ) ) = D44 by L541 , FUNCT_7:31;
L634: ( indx D46 ) = ( indx C143 ) by L633 , PENCIL_1:def 21;
L635:
now
let C157 being (Subset of ( C141 . ( indx D46 ) ));
assume L636: C157 = ( D46 . ( indx D46 ) );
L637: C157 in ( rng C148 ) by L636 , L608 , L633 , L634 , FUNCT_1:3;
thus L638: C157 is  strong  closed_under_lines by L637 , L546 , L634;
end;
L639: ( D41 . D43 ) = ( product ( D33 +* (( indx C143 ) , ( C148 . D43 )) ) ) by L567 , L605;
thus L640: thesis by L639 , L606 , L635 , PENCIL_1:29;
end;
L641: ( len C148 ) in ( Seg ( len C148 ) ) by L548 , FINSEQ_1:def 3;
L642: D42 = ( product D39 ) by L641 , L567 , L592;
L643: D42 is non  trivial  strong  closed_under_lines by L642 , L594 , L603;
L644: (for B135 being (Element of ( NAT )) holds ((1 <= B135 & B135 < ( len D41 )) implies 2 c= ( card ( ( D41 . B135 ) /\ ( D41 . ( B135 + 1 ) ) ) )))
proof
consider C158 being set such that L645: C158 in ( product D33 ) by XBOOLE_0:def 1;
let C159 being (Element of ( NAT ));
assume that
L646: 1 <= C159
and
L647: C159 < ( len D41 );
L648: C159 in ( Seg ( len C148 ) ) by L567 , L646 , L647 , FINSEQ_1:1;
L649: ( D41 . C159 ) = ( product ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) ) by L648 , L567 , L592;
L650: 2 c= ( card ( ( C148 . C159 ) /\ ( C148 . ( C159 + 1 ) ) ) ) by L547 , L567 , L646 , L647;
consider C160 , C161 being set such that L651: C160 in ( ( C148 . C159 ) /\ ( C148 . ( C159 + 1 ) ) ) and L652: C161 in ( ( C148 . C159 ) /\ ( C148 . ( C159 + 1 ) ) ) and L653: C160 <> C161 by L650 , PENCIL_1:2;
consider C162 being Function such that L654: C162 = C158 and L655: ( dom C162 ) = ( dom D33 ) and L656: (for B136 being set holds (B136 in ( dom D33 ) implies ( C162 . B136 ) in ( D33 . B136 ))) by L645 , CARD_3:def 5;
reconsider D47 = C162 as (ManySortedSet of C140) by L541 , L655 , PARTFUN1:def 2 , RELAT_1:def 18;
set D48 = ( D47 +* (( indx C143 ) , C160) );
set D49 = ( D47 +* (( indx C143 ) , C161) );
L657: ( C159 + 1 ) <= ( len D41 ) by L647 , NAT_1:13;
L658:
now
let C163 being set;
assume L659: C163 in ( dom ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) );
L660: C163 in C140 by L659;
L661: C163 in ( dom D47 ) by L660 , PARTFUN1:def 2;
per cases ;
suppose L662: C163 = ( indx C143 );

L663: ( D48 . C163 ) = C160 by L662 , L661 , FUNCT_7:31;
L664: ( D48 . C163 ) in ( C148 . C159 ) by L663 , L651 , XBOOLE_0:def 4;
thus L665: ( D48 . C163 ) in ( ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) . C163 ) by L664 , L541 , L662 , FUNCT_7:31;
end;
suppose L666: C163 <> ( indx C143 );

L667: ( D48 . C163 ) = ( D47 . C163 ) by L666 , FUNCT_7:32;
L668: ( D47 . C163 ) in ( D33 . C163 ) by L541 , L656 , L660;
thus L669: ( D48 . C163 ) in ( ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) . C163 ) by L668 , L666 , L667 , FUNCT_7:32;
end;
end;
L671: 1 <= ( C159 + 1 ) by L646 , NAT_1:13;
L672: ( C159 + 1 ) in ( Seg ( len C148 ) ) by L671 , L567 , L657 , FINSEQ_1:1;
L673: ( D41 . ( C159 + 1 ) ) = ( product ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) ) by L672 , L567 , L592;
L674:
now
let C164 being set;
assume L675: C164 in ( dom ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) );
L676: C164 in C140 by L675;
L677: C164 in ( dom D47 ) by L676 , PARTFUN1:def 2;
per cases ;
suppose L678: C164 = ( indx C143 );

L679: ( D49 . C164 ) = C161 by L678 , L677 , FUNCT_7:31;
L680: ( D49 . C164 ) in ( C148 . C159 ) by L679 , L652 , XBOOLE_0:def 4;
thus L681: ( D49 . C164 ) in ( ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) . C164 ) by L680 , L541 , L678 , FUNCT_7:31;
end;
suppose L682: C164 <> ( indx C143 );

L683: ( D49 . C164 ) = ( D47 . C164 ) by L682 , FUNCT_7:32;
L684: ( D47 . C164 ) in ( D33 . C164 ) by L541 , L656 , L676;
thus L685: ( D49 . C164 ) in ( ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) . C164 ) by L684 , L682 , L683 , FUNCT_7:32;
end;
end;
L687:
now
let C165 being set;
assume L688: C165 in ( dom ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) );
L689: C165 in C140 by L688;
L690: C165 in ( dom D47 ) by L689 , PARTFUN1:def 2;
per cases ;
suppose L691: C165 = ( indx C143 );

L692: ( D48 . C165 ) = C160 by L691 , L690 , FUNCT_7:31;
L693: ( D48 . C165 ) in ( C148 . ( C159 + 1 ) ) by L692 , L651 , XBOOLE_0:def 4;
thus L694: ( D48 . C165 ) in ( ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) . C165 ) by L693 , L541 , L691 , FUNCT_7:31;
end;
suppose L695: C165 <> ( indx C143 );

L696: ( D48 . C165 ) = ( D47 . C165 ) by L695 , FUNCT_7:32;
L697: ( D47 . C165 ) in ( D33 . C165 ) by L541 , L656 , L689;
thus L698: ( D48 . C165 ) in ( ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) . C165 ) by L697 , L695 , L696 , FUNCT_7:32;
end;
end;
L700: ( dom D48 ) = C140 by PARTFUN1:def 2
.= ( dom ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) ) by PARTFUN1:def 2;
L701: D48 in ( product ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) ) by L700 , L687 , CARD_3:9;
L702:
now
let C166 being set;
assume L703: C166 in ( dom ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) );
L704: C166 in C140 by L703;
L705: C166 in ( dom D47 ) by L704 , PARTFUN1:def 2;
per cases ;
suppose L706: C166 = ( indx C143 );

L707: ( D49 . C166 ) = C161 by L706 , L705 , FUNCT_7:31;
L708: ( D49 . C166 ) in ( C148 . ( C159 + 1 ) ) by L707 , L652 , XBOOLE_0:def 4;
thus L709: ( D49 . C166 ) in ( ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) . C166 ) by L708 , L541 , L706 , FUNCT_7:31;
end;
suppose L710: C166 <> ( indx C143 );

L711: ( D49 . C166 ) = ( D47 . C166 ) by L710 , FUNCT_7:32;
L712: ( D47 . C166 ) in ( D33 . C166 ) by L541 , L656 , L704;
thus L713: ( D49 . C166 ) in ( ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) . C166 ) by L712 , L710 , L711 , FUNCT_7:32;
end;
end;
L715: ( dom D49 ) = C140 by PARTFUN1:def 2
.= ( dom ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) ) by PARTFUN1:def 2;
L716: D49 in ( product ( D33 +* (( indx C143 ) , ( C148 . ( C159 + 1 ) )) ) ) by L715 , L702 , CARD_3:9;
L717: ( dom D49 ) = C140 by PARTFUN1:def 2
.= ( dom ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) ) by PARTFUN1:def 2;
L718: D49 in ( product ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) ) by L717 , L674 , CARD_3:9;
L719: D49 in ( ( D41 . C159 ) /\ ( D41 . ( C159 + 1 ) ) ) by L718 , L649 , L673 , L716 , XBOOLE_0:def 4;
L720: ( D48 . ( indx C143 ) ) = C160 by L541 , L655 , FUNCT_7:31;
L721: D48 <> D49 by L720 , L541 , L653 , L655 , FUNCT_7:31;
L722: ( dom D48 ) = C140 by PARTFUN1:def 2
.= ( dom ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) ) by PARTFUN1:def 2;
L723: D48 in ( product ( D33 +* (( indx C143 ) , ( C148 . C159 )) ) ) by L722 , L658 , CARD_3:9;
L724: D48 in ( ( D41 . C159 ) /\ ( D41 . ( C159 + 1 ) ) ) by L723 , L649 , L673 , L701 , XBOOLE_0:def 4;
thus L725: thesis by L724 , L721 , L719 , PENCIL_1:2;
end;
L726:
now
let C167 being set;
assume L727: C167 in ( dom ( D33 +* (( indx C143 ) , ( C148 . ( len C148 ) )) ) );
L728: C167 in C140 by L727;
per cases ;
suppose L729: C167 = ( indx C143 );

thus L730: ( D35 . C167 ) in ( ( D33 +* (( indx C143 ) , ( C148 . ( len C148 ) )) ) . C167 ) by L729 , L541 , L545 , FUNCT_7:31;
end;
suppose L731: C167 <> ( indx C143 );

L732: ( D35 . C167 ) in ( D33 . C167 ) by L540 , L541 , L728;
thus L733: ( D35 . C167 ) in ( ( D33 +* (( indx C143 ) , ( C148 . ( len C148 ) )) ) . C167 ) by L732 , L731 , FUNCT_7:32;
end;
end;
L735: ( dom ( D33 +* (( indx C143 ) , ( C148 . 1 )) ) ) = C140 by PARTFUN1:def 2;
L736: ( D33 +* (( indx C143 ) , ( C148 . 1 )) ) = C143 by L735 , L535 , L595 , FUNCT_1:2;
L737: C142 = ( D41 . 1 ) by L736 , L518 , L567 , L592 , L550;
L738: C142 , D42 are_joinable  by L737 , L567 , L603 , L644 , L325;
L739: D42 in { B137 where B137 is (Subset of ( Segre_Product C141 )) : (B137 is non  trivial  strong  closed_under_lines & C142 , B137 are_joinable ) } by L738 , L643;
L740: D42 = ( product ( D33 +* (( indx C143 ) , ( C148 . ( len C148 ) )) ) ) by L567 , L592 , L641;
L741: C146 in D42 by L740 , L538 , L566 , L726 , CARD_3:9;
thus L742: thesis by L741 , L739 , TARSKI:def 4;
end;
L743: ( dom C143 ) = C140 by PARTFUN1:def 2;
L744: ( D33 . ( indx D33 ) ) = ( [#] ( C141 . ( indx D33 ) ) ) by L743 , L531 , FUNCT_7:31;
L745: D32 c= ( product D33 )
proof
let C168 being set;
assume L746: C168 in D32;
consider C169 being set such that L747: C168 in C169 and L748: C169 in { B138 where B138 is (Subset of ( Segre_Product C141 )) : (B138 is non  trivial  strong  closed_under_lines & C142 , B138 are_joinable ) } by L746 , TARSKI:def 4;
consider C170 being (Subset of ( Segre_Product C141 )) such that L749: C169 = C170 and L750: C170 is non  trivial  strong  closed_under_lines and L751: C142 , C170 are_joinable  by L748;
reconsider D50 = C168 as (ManySortedSet of C140) by L747 , L749 , PENCIL_1:14;
consider C171 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C141 )) such that L752: C170 = ( product C171 ) and L753: (for B139 being (Subset of ( C141 . ( indx C171 ) )) holds (B139 = ( C171 . ( indx C171 ) ) implies B139 is  strong  closed_under_lines)) by L750 , PENCIL_1:29;
L754: ( dom C171 ) = C140 by PARTFUN1:def 2
.= ( dom D33 ) by PARTFUN1:def 2;
L755: ( dom C143 ) = C140 by PARTFUN1:def 2
.= ( dom D33 ) by PARTFUN1:def 2;
L756: (for B140 being set holds (B140 in ( dom D33 ) implies ( D50 . B140 ) in ( D33 . B140 )))
proof
let C172 being set;
assume L757: C172 in ( dom D33 );
reconsider D51 = C172 as (Element of C140) by L757;
per cases ;
suppose L758: C172 = ( indx C143 );

L759: C171 c= ( Carrier C141 ) by PBOOLE:def 18;
L760: ( C171 . D51 ) c= ( ( Carrier C141 ) . D51 ) by L759 , PBOOLE:def 2;
L761: ( C171 . D51 ) c= (the carrier of ( C141 . D51 )) by L760 , YELLOW_6:2;
L762: ( D50 . C172 ) in ( C171 . C172 ) by L747 , L749 , L752 , L754 , L757 , CARD_3:9;
L763: ( D50 . C172 ) in D30 by L762 , L758 , L761;
thus L764: thesis by L763 , L755 , L757 , L758 , FUNCT_7:31;
end;
suppose L765: C172 <> ( indx C143 );

L766: ( D50 . C172 ) in ( C171 . C172 ) by L747 , L749 , L752 , L754 , L757 , CARD_3:9;
L767: ( D50 . C172 ) in ( C143 . C172 ) by L766 , L517 , L518 , L750 , L751 , L752 , L765 , L349;
thus L768: thesis by L767 , L765 , FUNCT_7:32;
end;
end;
L770: ( dom D50 ) = C140 by PARTFUN1:def 2
.= ( dom D33 ) by PARTFUN1:def 2;
thus L771: thesis by L770 , L756 , CARD_3:9;
end;
L772: D32 = ( product D33 ) by L745 , L532 , XBOOLE_0:def 10;
thus L773: thesis by L772 , L744 , L295;
end;
theorem
L774: (for B141 being non  empty set holds (for B142 being  PLS-yielding (ManySortedSet of B141) holds ((for B143 being (Element of B141) holds ( B142 . B143 ) is  strongly_connected) implies (for B144 being set holds (B144 is (Segre-Coset of B142) iff (ex B145 being (Subset of ( Segre_Product B142 )) st (B145 is non  trivial  strong  closed_under_lines & B144 = ( union { B146 where B146 is (Subset of ( Segre_Product B142 )) : (B146 is non  trivial  strong  closed_under_lines & B145 , B146 are_joinable ) } ))))))))
proof
let C173 being non  empty set;
let C174 being  PLS-yielding (ManySortedSet of C173);
assume L775: (for B147 being (Element of C173) holds ( C174 . B147 ) is  strongly_connected);
let C175 being set;
thus L776: (C175 is (Segre-Coset of C174) implies (ex B148 being (Subset of ( Segre_Product C174 )) st (B148 is non  trivial  strong  closed_under_lines & C175 = ( union { B149 where B149 is (Subset of ( Segre_Product C174 )) : (B149 is non  trivial  strong  closed_under_lines & B148 , B149 are_joinable ) } ))))
proof
assume L777: C175 is (Segre-Coset of C174);
reconsider D52 = C175 as (Segre-Coset of C174) by L777;
consider C176 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C174 )) such that L778: D52 = ( product C176 ) and L779: ( C176 . ( indx C176 ) ) = ( [#] ( C174 . ( indx C176 ) ) ) by L295;
set D53 = the (Block of ( C174 . ( indx C176 ) ));
consider C177 being set such that L780: C177 in ( product C176 ) by XBOOLE_0:def 1;
L781: D53 in (the topology of ( C174 . ( indx C176 ) ));
reconsider D54 = D53 as (Subset of ( C174 . ( indx C176 ) )) by L781;
L782: (ex B150 being Function st (B150 = C177 & ( dom B150 ) = ( dom C176 ) & (for B151 being set holds (B151 in ( dom C176 ) implies ( B150 . B151 ) in ( C176 . B151 ))))) by L780 , CARD_3:def 5;
L783: ( dom C176 ) = C173 by PARTFUN1:def 2;
reconsider D55 = C177 as (ManySortedSet of C173) by L783 , L782 , PARTFUN1:def 2 , RELAT_1:def 18;
L784: (for B152 being set holds (B152 in C173 implies ( D55 . B152 ) is (Element of ( ( Carrier C174 ) . B152 ))))
proof
let C178 being set;
assume L785: C178 in C173;
L786: C176 c= ( Carrier C174 ) by PBOOLE:def 18;
L787: ( C176 . C178 ) c= ( ( Carrier C174 ) . C178 ) by L786 , L785 , PBOOLE:def 2;
L788: ( D55 . C178 ) in ( C176 . C178 ) by L783 , L782 , L785;
thus L789: thesis by L788 , L787;
end;
reconsider D56 = D55 as (Element of ( Carrier C174 )) by L784 , PBOOLE:def 14;
reconsider D57 = { D56 } as (ManySortedSubset of ( Carrier C174 )) by PENCIL_1:11;
reconsider D58 = ( D57 +* (( indx C176 ) , D54) ) as (ManySortedSubset of ( Carrier C174 )) by L281;
L790: 2 c= ( card D54 ) by PENCIL_1:def 6;
L791: D54 is non  trivial by L790 , PENCIL_1:4;
reconsider D59 = D58 as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C174 )) by L791 , PENCIL_1:9 , PENCIL_1:10;
L792: ( dom D57 ) = C173 by PARTFUN1:def 2;
L793: ( D59 . ( indx C176 ) ) = D54 by L792 , FUNCT_7:31;
L794: ( indx D59 ) = ( indx C176 ) by L793 , L791 , PENCIL_1:def 21;
reconsider D60 = ( product D59 ) as (Block of ( Segre_Product C174 )) by L794 , L793 , PENCIL_1:24;
L795: (for B153 being set holds (B153 in C173 implies ( D59 . B153 ) c= ( C176 . B153 )))
proof
let C179 being set;
assume L796: C179 in C173;
per cases ;
suppose L797: C179 <> ( indx C176 );

L798: ( D59 . C179 ) = ( D57 . C179 ) by L797 , FUNCT_7:32;
L799: ( D59 . C179 ) = { ( D56 . C179 ) } by L798 , L796 , PZFMISC1:def 1;
L800: ( D56 . C179 ) in ( C176 . C179 ) by L783 , L782 , L796;
thus L801: thesis by L800 , L799 , ZFMISC_1:31;
end;
suppose L802: C179 = ( indx C176 );

thus L803: thesis by L802 , L779 , L793;
end;
end;
L805: D60 in (the topology of ( Segre_Product C174 ));
reconsider D61 = D60 as (Subset of ( Segre_Product C174 )) by L805;
take D61;
thus L806: D61 is non  trivial  strong  closed_under_lines by PENCIL_1:20 , PENCIL_1:21;
reconsider D62 = ( union { B154 where B154 is (Subset of ( Segre_Product C174 )) : (B154 is non  trivial  strong  closed_under_lines & D61 , B154 are_joinable ) } ) as (Segre-Coset of C174) by L806 , L775 , L515;
L807: D61 , D61 are_joinable  by L806 , L337;
L808: D61 in { B155 where B155 is (Subset of ( Segre_Product C174 )) : (B155 is non  trivial  strong  closed_under_lines & D61 , B155 are_joinable ) } by L807 , L806;
L809: D61 c= D62
proof
let C180 being set;
assume L810: C180 in D61;
thus L811: thesis by L810 , L808 , TARSKI:def 4;
end;
L812: ( dom D59 ) = C173 by PARTFUN1:def 2;
L813: D61 c= C175 by L812 , L778 , L783 , L795 , CARD_3:27;
L814: D61 c= ( C175 /\ D62 ) by L813 , L809 , XBOOLE_1:19;
L815: ( card D61 ) c= ( card ( C175 /\ D62 ) ) by L814 , CARD_1:11;
L816: 2 c= ( card D60 ) by PENCIL_1:def 6;
L817: D52 = D62 by L816 , L815 , L308 , XBOOLE_1:1;
thus L818: thesis by L817;
end;

given C181 being (Subset of ( Segre_Product C174 )) such that
L819: C181 is non  trivial  strong  closed_under_lines
and
L820: C175 = ( union { B156 where B156 is (Subset of ( Segre_Product C174 )) : (B156 is non  trivial  strong  closed_under_lines & C181 , B156 are_joinable ) } );

thus L821: thesis by L775 , L819 , L820 , L515;
end;
theorem
L822: (for B157 being non  empty set holds (for B158 being  PLS-yielding (ManySortedSet of B157) holds ((for B159 being (Element of B157) holds ( B158 . B159 ) is  strongly_connected) implies (for B160 being (Segre-Coset of B158) holds (for B161 being (Collineation of ( Segre_Product B158 )) holds ( B161 .: B160 ) is (Segre-Coset of B158))))))
proof
let C182 being non  empty set;
let C183 being  PLS-yielding (ManySortedSet of C182);
assume L823: (for B162 being (Element of C182) holds ( C183 . B162 ) is  strongly_connected);
let C184 being (Segre-Coset of C183);
consider C185 being (Subset of ( Segre_Product C183 )) such that L824: C185 is non  trivial  strong  closed_under_lines and L825: C184 = ( union { B163 where B163 is (Subset of ( Segre_Product C183 )) : (B163 is non  trivial  strong  closed_under_lines & C185 , B163 are_joinable ) } ) by L823 , L774;
let C186 being (Collineation of ( Segre_Product C183 ));
reconsider D63 = ( C186 " ) as (Collineation of ( Segre_Product C183 )) by L418;
L826: ( dom C186 ) = (the carrier of ( Segre_Product C183 )) by FUNCT_2:def 1;
L827: ( dom D63 ) = (the carrier of ( Segre_Product C183 )) by FUNCT_2:def 1;
L828: C186 is  bijective by L397;
L829: ( rng C186 ) = (the carrier of ( Segre_Product C183 )) by L828 , FUNCT_2:def 3;
L830: ( rng C186 ) = ( [#] ( Segre_Product C183 ) ) by L828 , FUNCT_2:def 3;
L831: ( C186 .: C184 ) = ( union { B164 where B164 is (Subset of ( Segre_Product C183 )) : (B164 is non  trivial  strong  closed_under_lines & ( C186 .: C185 ) , B164 are_joinable ) } )
proof
L832: C185 c= ( C186 " ( C186 .: C185 ) ) by L826 , FUNCT_1:76;
L833: ( C186 " ( C186 .: C185 ) ) c= C185 by L828 , FUNCT_1:82;
L834: ( C186 " ( C186 .: C185 ) ) = C185 by L833 , L832 , XBOOLE_0:def 10;
thus L835: ( C186 .: C184 ) c= ( union { B165 where B165 is (Subset of ( Segre_Product C183 )) : (B165 is non  trivial  strong  closed_under_lines & ( C186 .: C185 ) , B165 are_joinable ) } )
proof
let C187 being set;
assume L836: C187 in ( C186 .: C184 );
consider C188 being set such that L837: C188 in ( dom C186 ) and L838: C188 in C184 and L839: C187 = ( C186 . C188 ) by L836 , FUNCT_1:def 6;
consider C189 being set such that L840: C188 in C189 and L841: C189 in { B166 where B166 is (Subset of ( Segre_Product C183 )) : (B166 is non  trivial  strong  closed_under_lines & C185 , B166 are_joinable ) } by L825 , L838 , TARSKI:def 4;
consider C190 being (Subset of ( Segre_Product C183 )) such that L842: C189 = C190 and L843: C190 is non  trivial  strong  closed_under_lines and L844: C185 , C190 are_joinable  by L841;
L845: ( C186 .: C185 ) , ( C186 .: C190 ) are_joinable  by L824 , L843 , L844 , L473;
L846: ( C186 .: C190 ) is non  trivial  strong  closed_under_lines by L843 , L426 , L455 , L464;
L847: ( C186 .: C190 ) in { B167 where B167 is (Subset of ( Segre_Product C183 )) : (B167 is non  trivial  strong  closed_under_lines & ( C186 .: C185 ) , B167 are_joinable ) } by L846 , L845;
L848: C187 in ( C186 .: C190 ) by L837 , L839 , L840 , L842 , FUNCT_1:def 6;
thus L849: thesis by L848 , L847 , TARSKI:def 4;
end;

let C191 being set;
assume L850: C191 in ( union { B168 where B168 is (Subset of ( Segre_Product C183 )) : (B168 is non  trivial  strong  closed_under_lines & ( C186 .: C185 ) , B168 are_joinable ) } );
consider C192 being set such that L851: C191 in C192 and L852: C192 in { B169 where B169 is (Subset of ( Segre_Product C183 )) : (B169 is non  trivial  strong  closed_under_lines & ( C186 .: C185 ) , B169 are_joinable ) } by L850 , TARSKI:def 4;
consider C193 being (Subset of ( Segre_Product C183 )) such that L853: C192 = C193 and L854: C193 is non  trivial  strong  closed_under_lines and L855: ( C186 .: C185 ) , C193 are_joinable  by L852;
L856: ( D63 .: C193 ) is non  trivial  strong  closed_under_lines by L854 , L426 , L455 , L464;
L857: ( C186 .: C185 ) is non  trivial  strong  closed_under_lines by L824 , L426 , L455 , L464;
L858: ( D63 .: ( C186 .: C185 ) ) , ( D63 .: C193 ) are_joinable  by L857 , L854 , L855 , L473;
L859: C185 , ( D63 .: C193 ) are_joinable  by L858 , L828 , L830 , L834 , TOPS_2:55;
L860: ( D63 .: C193 ) in { B170 where B170 is (Subset of ( Segre_Product C183 )) : (B170 is non  trivial  strong  closed_under_lines & C185 , B170 are_joinable ) } by L859 , L856;
L861: ( D63 . C191 ) in ( D63 .: C193 ) by L827 , L851 , L853 , FUNCT_1:def 6;
L862: ( D63 . C191 ) in C184 by L861 , L825 , L860 , TARSKI:def 4;
L863: C191 = ( C186 . ( ( (C186 qua Function) " ) . C191 ) ) by L828 , L829 , L851 , L853 , FUNCT_1:35;
L864: C191 = ( C186 . ( D63 . C191 ) ) by L863 , L828 , TOPS_2:def 4;
thus L865: thesis by L864 , L826 , L862 , FUNCT_1:def 6;
end;
L866: ( C186 .: C185 ) is non  trivial  strong  closed_under_lines by L824 , L426 , L455 , L464;
thus L867: thesis by L866 , L823 , L831 , L774;
end;
theorem
L868: (for B171 being non  empty set holds (for B172 being  PLS-yielding (ManySortedSet of B171) holds ((for B173 being (Element of B171) holds ( B172 . B173 ) is  strongly_connected) implies (for B174 being (Segre-Coset of B172) holds (for B175 being (Collineation of ( Segre_Product B172 )) holds ( B175 " B174 ) is (Segre-Coset of B172))))))
proof
let C194 being non  empty set;
let C195 being  PLS-yielding (ManySortedSet of C194);
assume that
L869: (for B176 being (Element of C194) holds ( C195 . B176 ) is  strongly_connected);
let C196 being (Segre-Coset of C195);
let C197 being (Collineation of ( Segre_Product C195 ));
reconsider D64 = ( C197 " ) as (Collineation of ( Segre_Product C195 )) by L418;
L870: C197 is  bijective by L397;
L871: ( rng C197 ) = ( [#] ( Segre_Product C195 ) ) by L870 , FUNCT_2:def 3;
L872: ( C197 " C196 ) = ( D64 .: C196 ) by L871 , L870 , TOPS_2:55;
thus L873: thesis by L872 , L869 , L822;
end;
