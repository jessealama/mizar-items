:: The Chinese Remainder Theorem
::  by Andrzej Kondracki
::
:: Received December 30, 1997
:: Copyright (c) 1997-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, XREAL_0, ORDINAL1, NAT_1, INT_1, RAT_1, NEWTON, RELAT_1,
      ARYTM_1, ARYTM_3, XXREAL_0, CARD_1, PREPOWER, INT_2, COMPLEX1, SUBSET_1,
      FINSEQ_1, FUNCT_1, XBOOLE_0, ORDINAL4, TARSKI, CARD_3, FINSEQ_3, REAL_1,
      SQUARE_1;
 notations TARSKI, XBOOLE_0, SUBSET_1, ORDINAL1, RELAT_1, NUMBERS, XCMPLX_0,
      XREAL_0, INT_1, REAL_1, NAT_1, NAT_D, RAT_1, INT_2, XXREAL_0, VALUED_0,
      PREPOWER, SQUARE_1, FUNCT_1, FINSEQ_1, FINSEQ_3, SEQ_1, RVSUM_1,
      FINSEQ_4, NEWTON, TREES_4;
 constructors REAL_1, SQUARE_1, NAT_1, NAT_D, BINOP_2, FINSEQ_3, FINSEQ_4,
      FINSOP_1, RVSUM_1, NEWTON, PREPOWER, TREES_4, SEQ_1, RELSET_1;
 registrations XBOOLE_0, SUBSET_1, RELAT_1, FUNCT_1, ORDINAL1, NUMBERS, SEQM_3,
      XXREAL_0, XREAL_0, SQUARE_1, NAT_1, INT_1, RAT_1, MEMBERED, FINSEQ_1,
      NEWTON, VALUED_0, CARD_1;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions VALUED_0, FINSEQ_1, TARSKI, SQUARE_1, RVSUM_1;
 theorems TARSKI, ABSVALUE, INT_1, NAT_1, INT_2, RAT_1, NEWTON, PREPOWER,
      SQUARE_1, FINSEQ_1, FINSEQ_2, FINSEQ_4, FUNCT_1, RVSUM_1, PRE_FF, CARD_4,
      FINSEQ_3, FINSEQ_5, XBOOLE_1, XCMPLX_0, XCMPLX_1, XREAL_1, CARD_1,
      XXREAL_0, ORDINAL1, FINSOP_1, NAT_D, XREAL_0;
 schemes NAT_1, FINSEQ_1, FINSEQ_2;

begin
theorem
L1: (for R1 being  real number holds (( R1 |^ 2 ) = ( R1 * R1 ) & ( ( - R1 ) |^ 2 ) = ( R1 |^ 2 )))
proof
let R1 being  real number;
L2: ( ( - R1 ) |^ 1 ) = ( - R1 ) by NEWTON:5;
L3: R1 = ( R1 |^ 1 ) by NEWTON:5;
L4: ( R1 |^ ( 1 + 1 ) ) = ( R1 * R1 ) by L3 , NEWTON:8;
L5: ( R1 |^ 2 ) = ( ( - R1 ) * ( - R1 ) ) by L4
.= ( ( - R1 ) |^ ( 1 + 1 ) ) by L2 , NEWTON:8;
thus L6: thesis by L5 , L3 , NEWTON:8;
end;
theorem
L7: (for R1 being  real number holds (for B1 being Nat holds (( ( - R1 ) |^ ( 2 * B1 ) ) = ( R1 |^ ( 2 * B1 ) ) & ( ( - R1 ) |^ ( ( 2 * B1 ) + 1 ) ) = ( - ( R1 |^ ( ( 2 * B1 ) + 1 ) ) ))))
proof
let R1 being  real number;
let C1 being Nat;
L8: ( ( - R1 ) |^ ( 2 * C1 ) ) = ( ( ( - R1 ) |^ 2 ) |^ C1 ) by NEWTON:9
.= ( ( R1 |^ 2 ) |^ C1 ) by L1
.= ( R1 |^ ( 2 * C1 ) ) by NEWTON:9;
L9: ( ( - R1 ) |^ ( ( 2 * C1 ) + 1 ) ) = ( ( ( - R1 ) |^ ( 2 * C1 ) ) * ( - R1 ) ) by NEWTON:6
.= ( - ( ( R1 |^ ( 2 * C1 ) ) * R1 ) ) by L8
.= ( - ( R1 |^ ( ( 2 * C1 ) + 1 ) ) ) by NEWTON:6;
thus L10: thesis by L9 , L8;
end;
theorem
L11: (for R1 being  real number holds (for R2 being  real number holds (for R7 being Nat holds ((R1 >= ( 0 ) & R2 >= ( 0 ) & R7 > ( 0 ) & ( R1 |^ R7 ) = ( R2 |^ R7 )) implies R1 = R2))))
proof
let R1 being  real number;
let R2 being  real number;
let R7 being Nat;
assume that
L12: R1 >= ( 0 )
and
L13: R2 >= ( 0 )
and
L14: R7 > ( 0 )
and
L15: ( R1 |^ R7 ) = ( R2 |^ R7 );
L16: R7 >= 1 by L14 , NAT_1:14;
L17: R1 = ( R7 -Root ( R1 |^ R7 ) ) by L16 , L12 , PREPOWER:19
.= R2 by L13 , L15 , L16 , PREPOWER:19;
thus L18: thesis by L17;
end;
L19: (for R1 being  real number holds (for R2 being  real number holds ((R1 >= ( 0 ) iff ( R1 + R2 ) >= R2) & (R1 > ( 0 ) iff ( R1 + R2 ) > R2) & (R1 >= ( 0 ) iff R2 >= ( R2 - R1 )) & (R1 > ( 0 ) iff R2 > ( R2 - R1 )))))
proof
let R1 being  real number;
let R2 being  real number;
L20: (R1 >= ( 0 ) iff ( R1 + R2 ) >= ( (( 0 ) qua Nat) + R2 )) by XREAL_1:6;
thus L21: (R1 >= ( 0 ) iff ( R1 + R2 ) >= R2) by L20;
L22: (R1 > ( 0 ) iff ( R1 + R2 ) > ( (( 0 ) qua Nat) + R2 )) by XREAL_1:6;
thus L23: (R1 > ( 0 ) iff ( R1 + R2 ) > R2) by L22;
thus L24: (R1 >= ( 0 ) iff R2 >= ( R2 - R1 )) by L20 , XREAL_1:20;
thus L25: thesis by L22 , XREAL_1:19;
end;
L26: (for R1 being  real number holds (for R2 being  real number holds (for R3 being  real number holds ((R1 >= ( 0 ) & R2 >= R3) implies (( R1 + R2 ) >= R3 & R2 >= ( R3 - R1 ))))))
proof
let R1 being  real number;
let R2 being  real number;
let R3 being  real number;
assume L27: (R1 >= ( 0 ) & R2 >= R3);
L28: ( R1 + R2 ) >= ( R3 + (( 0 ) qua Nat) ) by L27 , XREAL_1:7;
thus L29: thesis by L28 , XREAL_1:20;
end;
L30: (for R1 being  real number holds (for R2 being  real number holds (for R3 being  real number holds (((R1 >= ( 0 ) & R2 > R3) or (R1 > ( 0 ) & R2 >= R3)) implies (( R1 + R2 ) > R3 & R2 > ( R3 - R1 ))))))
proof
let R1 being  real number;
let R2 being  real number;
let R3 being  real number;
assume L31: ((R1 >= ( 0 ) & R2 > R3) or (R1 > ( 0 ) & R2 >= R3));
L32: ( R1 + R2 ) > ( R3 + (( 0 ) qua Nat) ) by L31 , XREAL_1:8;
thus L33: thesis by L32 , XREAL_1:19;
end;
registration
let R12 being Integer;
let R4 being Nat;
cluster ( R12 |^ R4 ) ->  integer;
coherence
proof
defpred S1[ Nat ] means ( R12 |^ $1 ) is Integer;
L34: (for R4 being Nat holds (S1[ R4 ] implies S1[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume L35: ( R12 |^ R4 ) is Integer;
reconsider D1 = ( R12 |^ R4 ) as Integer by L35;
L36: ( R12 |^ ( R4 + 1 ) ) = ( R12 * D1 ) by NEWTON:6;
thus L37: thesis by L36;
end;
L38: S1[ ( 0 ) ] by NEWTON:4;
L39: (for R4 being Nat holds S1[ R4 ]) from NAT_1:sch 2(L38 , L34);
thus L40: thesis by L39;
end;
end;
L42: (for R4 being Nat holds (ex R5 being Nat st (R4 = ( 2 * R5 ) or R4 = ( ( 2 * R5 ) + 1 ))))
proof
let R4 being Nat;
set D2 = ( R4 div 2 );
set D3 = ( R4 mod 2 );
L43: R4 = ( ( 2 * D2 ) + D3 ) by NAT_D:2;
L44: (R4 = ( ( 2 * D2 ) + (( 0 ) qua Nat) ) or R4 = ( ( 2 * D2 ) + 1 )) by L43 , NAT_1:23 , NAT_D:1;
thus L45: thesis by L44;
end;
theorem
L46: (for R12 being Integer holds (for R14 being Integer holds (for R15 being Integer holds ((R12 divides R14 & R12 divides R15) implies R12 divides ( R14 + R15 )))))
proof
let R12 being Integer;
let R14 being Integer;
let R15 being Integer;
assume that
L47: R12 divides R14
and
L48: R12 divides R15;
consider R16 being Integer such that L49: R14 = ( R12 * R16 ) by L47 , INT_1:def 3;
consider R17 being Integer such that L50: R15 = ( R12 * R17 ) by L48 , INT_1:def 3;
L51: ( R14 + R15 ) = ( R12 * ( R16 + R17 ) ) by L49 , L50;
thus L52: thesis by L51 , INT_1:def 3;
end;
theorem
L53: (for R12 being Integer holds (for R14 being Integer holds (for R15 being Integer holds (for R16 being Integer holds (for R17 being Integer holds ((R12 divides R14 & R12 divides R15) implies R12 divides ( ( R14 * R16 ) + ( R15 * R17 ) )))))))
proof
let R12 being Integer;
let R14 being Integer;
let R15 being Integer;
let R16 being Integer;
let R17 being Integer;
assume L54: (R12 divides R14 & R12 divides R15);
L55: (R12 divides ( R14 * R16 ) & R12 divides ( R15 * R17 )) by L54 , INT_2:2;
thus L56: thesis by L55 , L46;
end;
theorem
L57: (for R12 being Integer holds (for R14 being Integer holds (for R15 being Integer holds ((( R14 gcd R15 ) = 1 & ( R12 gcd R15 ) = 1) implies ( ( R14 * R12 ) gcd R15 ) = 1))))
proof
let R12 being Integer;
let R14 being Integer;
let R15 being Integer;
assume L58: (( R14 gcd R15 ) = 1 & ( R12 gcd R15 ) = 1);
L59: (R14 , R15 are_relative_prime  & R12 , R15 are_relative_prime ) by L58 , INT_2:def 3;
L60: ( R14 * R12 ) , R15 are_relative_prime  by L59 , INT_2:26;
thus L61: thesis by L60 , INT_2:def 3;
end;
theorem
L62: (for R4 being Nat holds (for R5 being Nat holds (for R6 being Nat holds ((( R4 gcd R5 ) = 1 & ( R6 gcd R5 ) = 1) implies ( ( R4 * R6 ) gcd R5 ) = 1)))) by L57;
theorem
L63: (for R14 being Integer holds (( ( 0 ) gcd R14 ) = ( abs R14 ) & ( 1 gcd R14 ) = 1))
proof
let R14 being Integer;
L64: ( R14 gcd 1 ) = ( ( abs R14 ) gcd ( abs 1 ) ) by INT_2:34
.= ( ( abs R14 ) gcd 1 ) by ABSVALUE:def 1
.= 1 by NEWTON:51;
L65: ( R14 gcd ( 0 ) ) = ( ( abs R14 ) gcd ( abs (( 0 ) qua Nat) ) ) by INT_2:34
.= ( ( abs R14 ) gcd ( 0 ) ) by ABSVALUE:2
.= ( abs R14 ) by NEWTON:52;
thus L66: thesis by L65 , L64;
end;
theorem
L67: (for R12 being Integer holds 1 , R12 are_relative_prime )
proof
let R12 being Integer;
L68: ( 1 gcd R12 ) = 1 by L63;
thus L69: thesis by L68 , INT_2:def 3;
end;
theorem
L70: (for R4 being Nat holds (for R12 being Integer holds (for R13 being Integer holds (R12 , R13 are_relative_prime  implies ( R12 |^ R4 ) , R13 are_relative_prime ))))
proof
let R4 being Nat;
let R12 being Integer;
let R13 being Integer;
defpred S2[ Nat ] means ( R12 |^ $1 ) , R13 are_relative_prime ;
assume L71: R12 , R13 are_relative_prime ;
L72: (for R4 being Nat holds (S2[ R4 ] implies S2[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume L73: ( R12 |^ R4 ) , R13 are_relative_prime ;
L74: ( R12 * ( R12 |^ R4 ) ) , R13 are_relative_prime  by L73 , L71 , INT_2:26;
thus L75: thesis by L74 , NEWTON:6;
end;
L76: ( R12 |^ ( 0 ) ) = 1 by NEWTON:4;
L77: S2[ ( 0 ) ] by L76 , L67;
L78: (for R4 being Nat holds S2[ R4 ]) from NAT_1:sch 2(L77 , L72);
thus L79: thesis by L78;
end;
theorem
L80: (for R4 being Nat holds (for R5 being Nat holds (for R12 being Integer holds (for R13 being Integer holds (R12 , R13 are_relative_prime  implies ( R12 |^ R4 ) , ( R13 |^ R5 ) are_relative_prime )))))
proof
let R4 being Nat;
let R5 being Nat;
let R12 being Integer;
let R13 being Integer;
assume L81: R12 , R13 are_relative_prime ;
L82: ( R12 |^ R4 ) , R13 are_relative_prime  by L81 , L70;
thus L83: thesis by L82 , L70;
end;
theorem
L84: (for R4 being Nat holds (for R5 being Nat holds (for R12 being Integer holds (for R13 being Integer holds (( R12 gcd R13 ) = 1 implies (( R12 gcd ( R13 |^ R5 ) ) = 1 & ( ( R12 |^ R4 ) gcd ( R13 |^ R5 ) ) = 1))))))
proof
let R4 being Nat;
let R5 being Nat;
let R12 being Integer;
let R13 being Integer;
assume L85: ( R12 gcd R13 ) = 1;
L86: R12 , R13 are_relative_prime  by L85 , INT_2:def 3;
L87: (R12 , ( R13 |^ R5 ) are_relative_prime  & ( R12 |^ R4 ) , ( R13 |^ R5 ) are_relative_prime ) by L86 , L70 , L80;
thus L88: thesis by L87 , INT_2:def 3;
end;
theorem
L89: (for R12 being Integer holds (for R14 being Integer holds (( abs R14 ) divides R12 iff R14 divides R12)))
proof
let R12 being Integer;
let R14 being Integer;
L90:
now
assume L91: R14 divides R12;
consider R13 being Integer such that L92: ( R14 * R13 ) = R12 by L91 , INT_1:def 3;
L93:
now
per cases ;
suppose L94: R14 >= ( 0 );

L95: ( ( abs R14 ) * R13 ) = R12 by L94 , L92 , ABSVALUE:def 1;
thus L96: ( abs R14 ) divides R12 by L95 , INT_1:def 3;
end;
suppose L97: R14 < ( 0 );

L98: ( ( abs R14 ) * ( - R13 ) ) = ( ( - R14 ) * ( - R13 ) ) by L97 , ABSVALUE:def 1
.= R12 by L92;
thus L99: ( abs R14 ) divides R12 by L98 , INT_1:def 3;
end;
end;
thus L101: ( abs R14 ) divides R12 by L93;
end;
L102:
now
assume L103: ( abs R14 ) divides R12;
consider R13 being Integer such that L104: ( ( abs R14 ) * R13 ) = R12 by L103 , INT_1:def 3;
L105:
now
per cases ;
suppose L106: R14 >= ( 0 );

L107: ( R14 * R13 ) = R12 by L106 , L104 , ABSVALUE:def 1;
thus L108: R14 divides R12 by L107 , INT_1:def 3;
end;
suppose L109: R14 < ( 0 );

L110: R12 = ( ( - R14 ) * R13 ) by L109 , L104 , ABSVALUE:def 1
.= ( R14 * ( - R13 ) );
thus L111: R14 divides R12 by L110 , INT_1:def 3;
end;
end;
thus L113: R14 divides R12 by L105;
end;
thus L114: thesis by L102 , L90;
end;
theorem
L115: (for R4 being Nat holds (for R5 being Nat holds (for R6 being Nat holds (R4 divides R5 implies ( R4 |^ R6 ) divides ( R5 |^ R6 )))))
proof
let R4 being Nat;
let R5 being Nat;
let R6 being Nat;
assume L116: R4 divides R5;
consider C2 being Nat such that L117: ( R4 * C2 ) = R5 by L116 , NAT_D:def 3;
L118: ( R5 |^ R6 ) = ( ( R4 |^ R6 ) * ( C2 |^ R6 ) ) by L117 , NEWTON:7;
thus L119: thesis by L118 , NAT_D:def 3;
end;
theorem
L120: (for R4 being Nat holds (R4 divides 1 implies R4 = 1))
proof
let R4 being Nat;
assume L121: R4 divides 1;
L122: R4 divides ( 1 + 1 ) by L121 , NAT_D:8;
thus L123: thesis by L122 , L121 , NEWTON:39;
end;
theorem
L124: (for R4 being Nat holds (for R5 being Nat holds (for R7 being Nat holds ((R7 divides R4 & ( R4 gcd R5 ) = 1) implies ( R7 gcd R5 ) = 1)))) by L120 , NEWTON:57;
L125: (for R4 being Nat holds (for R5 being Nat holds (R4 <> ( 0 ) implies (R4 divides R5 iff ( R5 / R4 ) is (Element of ( NAT ))))))
proof
let R4 being Nat;
let R5 being Nat;
assume L126: R4 <> ( 0 );
L127:
now
assume L128: R4 divides R5;
consider C3 being Nat such that L129: R5 = ( R4 * C3 ) by L128 , NAT_D:def 3;
reconsider D4 = C3 as (Element of ( NAT )) by ORDINAL1:def 12;
L130: R5 = ( R4 * D4 ) by L129;
thus L131: ( R5 / R4 ) is (Element of ( NAT )) by L130 , L126 , XCMPLX_1:89;
end;
L132:
now
assume L133: ( R5 / R4 ) is (Element of ( NAT ));
reconsider D5 = ( R5 / R4 ) as (Element of ( NAT )) by L133;
L134: R5 = ( R4 * D5 ) by L126 , XCMPLX_1:87;
thus L135: R4 divides R5 by L134 , NAT_D:def 3;
end;
thus L136: thesis by L132 , L127;
end;
theorem
L137: (for R12 being Integer holds (for R13 being Integer holds (R12 <> ( 0 ) implies (R12 divides R13 iff ( R13 / R12 ) is Integer))))
proof
let R12 being Integer;
let R13 being Integer;
assume L138: R12 <> ( 0 );
L139:
now
assume L140: ( R13 / R12 ) is Integer;
reconsider D6 = ( R13 / R12 ) as Integer by L140;
L141: R13 = ( R12 * D6 ) by L138 , XCMPLX_1:87;
thus L142: R12 divides R13 by L141 , INT_1:def 3;
end;
L143:
now
assume L144: R12 divides R13;
L145: (ex R14 being Integer st R13 = ( R12 * R14 )) by L144 , INT_1:def 3;
thus L146: ( R13 / R12 ) is Integer by L145 , L138 , XCMPLX_1:89;
end;
thus L147: thesis by L143 , L139;
end;
L148: (for R4 being Nat holds (for R5 being Nat holds (for R12 being Integer holds ((R5 <> ( 0 ) & ( R4 * R12 ) = R5) implies R12 is (Element of ( NAT ))))))
proof
let R4 being Nat;
let R5 being Nat;
let R12 being Integer;
assume that
L149: R5 <> ( 0 )
and
L150: ( R4 * R12 ) = R5;
L151: R4 divides (R5 qua Integer) by L150 , INT_1:def 3;
L152: R4 <> ( 0 ) by L149 , L150;
L153: R12 = ( R5 / R4 ) by L152 , L150 , XCMPLX_1:89;
thus L154: thesis by L153 , L151 , L152 , L125;
end;
L155: (for R4 being Nat holds (for R5 being Nat holds (for R6 being Nat holds (( R4 + R5 ) <= R6 implies (R4 <= R6 & R5 <= R6)))))
proof
let R4 being Nat;
let R5 being Nat;
let R6 being Nat;
L156: (R4 <= ( R4 + R5 ) & R5 <= ( R4 + R5 )) by NAT_1:11;
assume L157: ( R4 + R5 ) <= R6;
thus L158: thesis by L157 , L156 , XXREAL_0:2;
end;
theorem
L159: (for R4 being Nat holds (for R5 being Nat holds (for R6 being Nat holds (R4 <= ( R5 - R6 ) implies (R4 <= R5 & R6 <= R5)))))
proof
let R4 being Nat;
let R5 being Nat;
let R6 being Nat;
assume L160: R4 <= ( R5 - R6 );
L161: ( R4 + R6 ) <= R5 by L160 , XREAL_1:19;
thus L162: thesis by L161 , L155;
end;
L163: (for R12 being Integer holds (for R14 being Integer holds (R12 < R14 iff R12 <= ( R14 - 1 ))))
proof
let R12 being Integer;
let R14 being Integer;
L164:
now
assume L165: R12 <= ( R14 - 1 );
L166: ( R12 + 1 ) <= R14 by L165 , XREAL_1:19;
L167: R12 < ( R12 + 1 ) by XREAL_1:29;
thus L168: R12 < R14 by L167 , L166 , XXREAL_0:2;
end;
L169:
now
assume L170: R12 < R14;
L171: ( R12 + 1 ) <= R14 by L170 , INT_1:7;
thus L172: R12 <= ( R14 - 1 ) by L171 , XREAL_1:19;
end;
thus L173: thesis by L169 , L164;
end;
L174: (for R12 being Integer holds (for R14 being Integer holds (R12 < ( R14 + 1 ) iff R12 <= R14)))
proof
let R12 being Integer;
let R14 being Integer;
L175: (R12 < ( R14 + 1 ) iff ( R12 - 1 ) < R14) by XREAL_1:19;
thus L176: thesis by L175 , L163;
end;
definition
let C4 being non  empty set;
let C5 being non  empty (Subset of C4);
let C6 , C7 being (FinSequence of C5);
redefine func C6 ^ C7 -> (FinSequence of C5);

coherence
proof
thus L177: ( rng ( C6 ^ C7 ) ) c= C5 by FINSEQ_1:def 4;
end;
end;
registration
let R31 being (FinSequence of ( INT ));
cluster ( Product R31 ) ->  integer;
coherence
proof
defpred S3[ (FinSequence of ( INT )) ] means ( Product $1 ) is Integer;
L179:
now
let C8 being (FinSequence of ( INT ));
let C9 being (Element of ( INT ));
reconsider D7 = C9 as Integer;
assume L180: S3[ C8 ];
reconsider D8 = ( Product C8 ) as Integer by L180;
L181: ( Product ( C8 ^ <* C9 *> ) ) = ( D8 * D7 ) by RVSUM_1:96;
thus L182: S3[ ( C8 ^ <* C9 *> ) ] by L181;
end;
L183: S3[ ( <*> ( INT ) ) ] by RVSUM_1:94;
L184: (for R32 being (FinSequence of ( INT )) holds S3[ R32 ]) from FINSEQ_2:sch 2(L183 , L179);
thus L185: thesis by L184;
end;
end;
definition
let R30 being (FinSequence of ( NAT ));
redefine func Sum R30 -> (Element of ( NAT ));

coherence
proof
defpred S4[ set ] means (ex B2 being (FinSequence of ( NAT )) st (B2 = $1 & ( Sum B2 ) is (Element of ( NAT ))));
L187:
now
let R30 being (FinSequence of ( NAT ));
let C10 being (Element of ( NAT ));
assume L188: S4[ R30 ];
reconsider D9 = ( Sum R30 ) as (Element of ( NAT )) by L188;
L189: ( Sum ( R30 ^ <* C10 *> ) ) = ( D9 + C10 ) by RVSUM_1:74;
thus L190: S4[ ( R30 ^ <* C10 *> ) ] by L189;
end;
L191: S4[ ( <*> ( NAT ) ) ] by RVSUM_1:72;
L192: (for R30 being (FinSequence of ( NAT )) holds S4[ R30 ]) from FINSEQ_2:sch 2(L191 , L187);
L193: (ex B3 being (FinSequence of ( NAT )) st (B3 = R30 & ( Sum B3 ) is (Element of ( NAT )))) by L192;
thus L194: thesis by L193;
end;
end;
definition
let R30 being (FinSequence of ( NAT ));
redefine func Product R30 -> (Element of ( NAT ));

coherence
proof
defpred S5[ set ] means (ex B4 being (FinSequence of ( NAT )) st (B4 = $1 & ( Product B4 ) is (Element of ( NAT ))));
L196:
now
let R30 being (FinSequence of ( NAT ));
let C11 being (Element of ( NAT ));
assume L197: S5[ R30 ];
reconsider D10 = ( Product R30 ) as (Element of ( NAT )) by L197;
L198: ( Product ( R30 ^ <* C11 *> ) ) = ( D10 * C11 ) by RVSUM_1:96;
thus L199: S5[ ( R30 ^ <* C11 *> ) ] by L198;
end;
L200: S5[ ( <*> ( NAT ) ) ] by RVSUM_1:94;
L201: (for R30 being (FinSequence of ( NAT )) holds S5[ R30 ]) from FINSEQ_2:sch 2(L200 , L196);
L202: (ex B5 being (FinSequence of ( NAT )) st (B5 = R30 & ( Product B5 ) is (Element of ( NAT )))) by L201;
thus L203: thesis by L202;
end;
end;
L205: (for R4 being Nat holds (for R21 being FinSequence holds (R4 in ( dom R21 ) implies (ex R22 being FinSequence st (ex R23 being FinSequence st (R21 = ( ( R22 ^ <* ( R21 . R4 ) *> ) ^ R23 ) & ( len R22 ) = ( R4 - 1 ) & ( len R23 ) = ( ( len R21 ) - R4 )))))))
proof
let R4 being Nat;
let R21 being FinSequence;
assume L206: R4 in ( dom R21 );
L207: (R4 >= 1 & R4 <= ( len R21 )) by L206 , FINSEQ_3:25;
reconsider D11 = ( ( len R21 ) - R4 ) , D12 = ( R4 - 1 ) as (Element of ( NAT )) by L207 , INT_1:5;
L208: ( len R21 ) = ( R4 + D11 );
consider R24 being FinSequence, R23 being FinSequence such that L209: ( len R24 ) = R4 and L210: ( len R23 ) = D11 and L211: R21 = ( R24 ^ R23 ) by L208 , FINSEQ_2:22;
L212: R4 = ( D12 + 1 );
consider R22 being FinSequence, R26 being set such that L213: R24 = ( R22 ^ <* R26 *> ) by L212 , L209 , FINSEQ_2:18;
L214: ( ( len R22 ) + 1 ) = ( D12 + 1 ) by L209 , L213 , FINSEQ_2:16;
L215: R4 <> ( 0 ) by L206 , FINSEQ_3:25;
L216: R4 in ( dom R24 ) by L215 , L209 , CARD_1:27 , FINSEQ_5:6;
L217: ( R24 . R4 ) = ( R21 . R4 ) by L216 , L211 , FINSEQ_1:def 7;
L218: ( R21 . R4 ) = R26 by L217 , L213 , L214 , FINSEQ_1:42;
thus L219: thesis by L218 , L210 , L211 , L213 , L214;
end;
definition
let C12 being Nat;
let R21 being FinSequence;
redefine func Del (R21 , C12) means 
:L220: it = R21 if (not C12 in ( dom R21 )) otherwise (( ( len it ) + 1 ) = ( len R21 ) & (for R5 being Nat holds ((R5 < C12 implies ( it . R5 ) = ( R21 . R5 )) & (R5 >= C12 implies ( it . R5 ) = ( R21 . ( R5 + 1 ) )))));
compatibility
proof
let C13 being FinSequence;
thus L221: ((not C12 in ( dom R21 )) implies (C13 = ( Del (R21 , C12) ) iff C13 = R21)) by FINSEQ_3:104;
assume L222: C12 in ( dom R21 );
thus L223:now
assume L224: C13 = ( Del (R21 , C12) );
L225: (ex B6 being Nat st (( len R21 ) = ( B6 + 1 ) & ( len C13 ) = B6)) by L224 , L222 , FINSEQ_3:104;
thus L226: ( ( len C13 ) + 1 ) = ( len R21 ) by L225;
let R5 being Nat;
thus L227: (R5 < C12 implies ( C13 . R5 ) = ( R21 . R5 )) by L224 , FINSEQ_3:110;
assume L228: R5 >= C12;
per cases ;
suppose L229: R5 <= ( len C13 );

thus L230: ( C13 . R5 ) = ( R21 . ( R5 + 1 ) ) by L229 , L222 , L224 , L225 , L228 , FINSEQ_3:111;
end;
suppose L231: R5 > ( len C13 );

L232: (not R5 in ( dom C13 )) by L231 , FINSEQ_3:25;
L233: ( C13 . R5 ) = ( {} ) by L232 , FUNCT_1:def 2;
L234: ( R5 + 1 ) > ( ( len C13 ) + 1 ) by L231 , XREAL_1:6;
L235: (not ( R5 + 1 ) in ( dom R21 )) by L234 , L225 , FINSEQ_3:25;
thus L236: ( C13 . R5 ) = ( R21 . ( R5 + 1 ) ) by L235 , L233 , FUNCT_1:def 2;
end;
end;
assume that
L238: ( ( len C13 ) + 1 ) = ( len R21 )
and
L239: (for R5 being Nat holds ((R5 < C12 implies ( C13 . R5 ) = ( R21 . R5 )) & (R5 >= C12 implies ( C13 . R5 ) = ( R21 . ( R5 + 1 ) ))));
L240: (for B7 being Nat holds ((1 <= B7 & B7 <= ( len C13 )) implies ( C13 . B7 ) = ( ( Del (R21 , C12) ) . B7 )))
proof
let C14 being Nat;
assume that
L241: 1 <= C14
and
L242: C14 <= ( len C13 );
reconsider D13 = C14 as (Element of ( NAT )) by ORDINAL1:def 12;
per cases ;
suppose L243: D13 < C12;

L244: ( C13 . D13 ) = ( R21 . D13 ) by L243 , L239;
thus L245: thesis by L244 , L243 , FINSEQ_3:110;
end;
suppose L246: D13 >= C12;

L247: ( C13 . D13 ) = ( R21 . ( D13 + 1 ) ) by L246 , L239;
thus L248: thesis by L247 , L222 , L238 , L242 , L246 , FINSEQ_3:111;
end;
end;
L250: (ex B8 being Nat st (( len R21 ) = ( B8 + 1 ) & ( len ( Del (R21 , C12) ) ) = B8)) by L222 , FINSEQ_3:104;
thus L251: thesis by L250 , L238 , L240 , FINSEQ_1:14;
end;
correctness;
end;
L253: (for R4 being Nat holds (for R21 being FinSequence holds (for R22 being FinSequence holds (for R23 being FinSequence holds (for R26 being set holds ((R4 in ( dom R21 ) & R21 = ( ( R22 ^ <* R26 *> ) ^ R23 ) & ( len R22 ) = ( R4 - 1 )) implies ( Del (R21 , R4) ) = ( R22 ^ R23 )))))))
proof
let R4 being Nat;
let R21 being FinSequence;
let R22 being FinSequence;
let R23 being FinSequence;
let R26 being set;
assume that
L254: R4 in ( dom R21 )
and
L255: R21 = ( ( R22 ^ <* R26 *> ) ^ R23 )
and
L256: ( len R22 ) = ( R4 - 1 );
L257: ( ( len ( Del (R21 , R4) ) ) + 1 ) = ( len R21 ) by L254 , L220;
L258: ( len R21 ) = ( ( len ( R22 ^ <* R26 *> ) ) + ( len R23 ) ) by L255 , FINSEQ_1:22
.= ( ( ( len R22 ) + 1 ) + ( len R23 ) ) by FINSEQ_2:16
.= ( R4 + ( len R23 ) ) by L256;
L259: ( len ( Del (R21 , R4) ) ) = ( ( len R23 ) + ( len R22 ) ) by L258 , L256 , L257;
L260: ( len ( R22 ^ R23 ) ) = ( len ( Del (R21 , R4) ) ) by L259 , FINSEQ_1:22;
L261: ( len <* R26 *> ) = 1 by FINSEQ_1:39;
L262: R21 = ( R22 ^ ( <* R26 *> ^ R23 ) ) by L255 , FINSEQ_1:32;
L263: ( len R21 ) = ( ( R4 - 1 ) + ( len ( <* R26 *> ^ R23 ) ) ) by L262 , L256 , FINSEQ_1:22;
L264: ( len ( <* R26 *> ^ R23 ) ) = ( ( len R21 ) - ( R4 - 1 ) ) by L263;
L265:
now
let C15 being Nat;
assume that
L266: 1 <= C15
and
L267: C15 <= ( len ( Del (R21 , R4) ) );
L268:
now
per cases ;
suppose L269: C15 < R4;

L270: C15 <= ( R4 - 1 ) by L269 , L163;
L271: C15 in ( dom R22 ) by L270 , L256 , L266 , FINSEQ_3:25;
thus L272: ( ( R22 ^ R23 ) . C15 ) = ( R22 . C15 ) by L271 , FINSEQ_1:def 7
.= ( R21 . C15 ) by L262 , L271 , FINSEQ_1:def 7
.= ( ( Del (R21 , R4) ) . C15 ) by L254 , L269 , L220;
end;
suppose L273: C15 >= R4;

L274: C15 > ( R4 - 1 ) by L273 , L163;
L275: ( C15 + 1 ) > R4 by L274 , XREAL_1:19;
L276: ( ( C15 + 1 ) - R4 ) > ( 0 ) by L275 , XREAL_1:50;
L277: ( ( ( C15 + 1 ) - R4 ) + 1 ) > ( (( 0 ) qua Nat) + 1 ) by L276 , XREAL_1:6;
L278: ( C15 + 1 ) > ( R4 - 1 ) by L275 , XREAL_1:146 , XXREAL_0:2;
L279: ( ( C15 + 1 ) - ( R4 - 1 ) ) > ( 0 ) by L278 , XREAL_1:50;
reconsider D14 = ( ( C15 + 1 ) - ( R4 - 1 ) ) as (Element of ( NAT )) by L279 , INT_1:3;
L280: ( C15 + 1 ) <= ( len R21 ) by L257 , L267 , XREAL_1:6;
L281: ( ( C15 + 1 ) - ( R4 - 1 ) ) <= ( len ( <* R26 *> ^ R23 ) ) by L280 , L264 , XREAL_1:9;
thus L282: ( ( R22 ^ R23 ) . C15 ) = ( R23 . ( C15 - ( len R22 ) ) ) by L256 , L260 , L267 , L274 , FINSEQ_1:24
.= ( R23 . ( D14 - 1 ) ) by L256
.= ( ( <* R26 *> ^ R23 ) . D14 ) by L261 , L277 , L281 , FINSEQ_1:24
.= ( ( R22 ^ ( <* R26 *> ^ R23 ) ) . ( C15 + 1 ) ) by L256 , L262 , L278 , L280 , FINSEQ_1:24
.= ( ( Del (R21 , R4) ) . C15 ) by L254 , L262 , L273 , L220;
end;
end;
thus L284: ( ( R22 ^ R23 ) . C15 ) = ( ( Del (R21 , R4) ) . C15 ) by L268;
end;
thus L285: thesis by L265 , L260 , FINSEQ_1:14;
end;
L286: (for R4 being Nat holds (for R21 being FinSequence holds ( dom ( Del (R21 , R4) ) ) c= ( dom R21 )))
proof
let R4 being Nat;
let R21 being FinSequence;
L287:
now
assume L288: R4 in ( dom R21 );
L289: ( dom R21 ) = ( Seg ( len R21 ) ) by FINSEQ_1:def 3
.= ( Seg ( ( len ( Del (R21 , R4) ) ) + 1 ) ) by L288 , L220
.= ( ( Seg ( len ( Del (R21 , R4) ) ) ) \/ { ( ( len ( Del (R21 , R4) ) ) + 1 ) } ) by FINSEQ_1:9
.= ( ( dom ( Del (R21 , R4) ) ) \/ { ( ( len ( Del (R21 , R4) ) ) + 1 ) } ) by FINSEQ_1:def 3;
thus L290: thesis by L289 , XBOOLE_1:7;
end;
thus L291: thesis by L287 , L220;
end;
definition
let R25 being non  empty set;
let C16 being Nat;
let C17 being (FinSequence of R25);
redefine func Del (C17 , C16) -> (FinSequence of R25);

coherence
proof
L292: (( rng C17 ) c= R25 & ( rng ( Del (C17 , C16) ) ) c= ( rng C17 )) by FINSEQ_1:def 4 , FINSEQ_3:106;
thus L293: ( rng ( Del (C17 , C16) ) ) c= R25 by L292 , XBOOLE_1:1;
end;
end;
definition
let R25 being non  empty set;
let C18 being non  empty (Subset of R25);
let C19 being Nat;
let C20 being (FinSequence of C18);
redefine func Del (C20 , C19) -> (FinSequence of C18);

coherence
proof
thus L295: ( rng ( Del (C20 , C19) ) ) c= C18 by FINSEQ_1:def 4;
end;
end;
L297: (for R4 being Nat holds (for R22 being FinSequence holds (for R23 being FinSequence holds ((R4 <= ( len R22 ) implies ( Del (( R22 ^ R23 ) , R4) ) = ( ( Del (R22 , R4) ) ^ R23 )) & (R4 >= 1 implies ( Del (( R22 ^ R23 ) , ( ( len R22 ) + R4 )) ) = ( R22 ^ ( Del (R23 , R4) ) ))))))
proof
let R4 being Nat;
let R22 being FinSequence;
let R23 being FinSequence;
set D15 = ( R22 ^ R23 );
L298: ( len D15 ) = ( ( len R22 ) + ( len R23 ) ) by FINSEQ_1:22;
L299:
now
set D16 = ( R22 ^ ( Del (R23 , R4) ) );
set D17 = ( Del (D15 , ( ( len R22 ) + R4 )) );
assume L300: R4 >= 1;
L301:
now
per cases ;
suppose L302: R4 > ( len R23 );

L303: (not R4 in ( dom R23 )) by L302 , FINSEQ_3:25;
L304: ( ( len R22 ) + R4 ) > ( len D15 ) by L298 , L302 , XREAL_1:6;
L305: (not ( ( len R22 ) + R4 ) in ( dom D15 )) by L304 , FINSEQ_3:25;
thus L306: D17 = ( R22 ^ R23 ) by L305 , L220
.= D16 by L303 , L220;
end;
suppose L307: R4 <= ( len R23 );

L308: R4 in ( dom R23 ) by L307 , L300 , FINSEQ_3:25;
L309: ( R4 - 1 ) >= ( 0 ) by L300 , XREAL_1:48;
L310: ( ( len R22 ) + ( R4 - 1 ) ) >= ( len R22 ) by L309 , L19;
L311: ( ( len R22 ) + R4 ) >= 1 by L300 , NAT_1:12;
L312: ( ( len R22 ) + R4 ) <= ( len D15 ) by L298 , L307 , XREAL_1:6;
L313: ( ( len R22 ) + R4 ) in ( dom D15 ) by L312 , L311 , FINSEQ_3:25;
consider C21 , C22 being FinSequence such that L314: D15 = ( ( C21 ^ <* ( D15 . ( ( len R22 ) + R4 ) ) *> ) ^ C22 ) and L315: ( len C21 ) = ( ( ( len R22 ) + R4 ) - 1 ) and L316: ( len C22 ) = ( ( len D15 ) - ( ( len R22 ) + R4 ) ) by L313 , L205;
L317: D17 = ( C21 ^ C22 ) by L313 , L314 , L315 , L253;
L318: D15 = ( C21 ^ ( <* ( D15 . ( ( len R22 ) + R4 ) ) *> ^ C22 ) ) by L314 , FINSEQ_1:32;
consider C23 being FinSequence such that L319: ( R22 ^ C23 ) = C21 by L318 , L315 , L310 , FINSEQ_1:47;
L320: ( R22 ^ ( ( C23 ^ <* ( D15 . ( ( len R22 ) + R4 ) ) *> ) ^ C22 ) ) = ( ( R22 ^ ( C23 ^ <* ( D15 . ( ( len R22 ) + R4 ) ) *> ) ) ^ C22 ) by FINSEQ_1:32
.= D15 by L314 , L319 , FINSEQ_1:32;
L321: R23 = ( ( C23 ^ <* ( D15 . ( ( len R22 ) + R4 ) ) *> ) ^ C22 ) by L320 , FINSEQ_1:33;
L322: ( ( len R22 ) + ( R4 - 1 ) ) = ( ( len R22 ) + ( len C23 ) ) by L315 , L319 , FINSEQ_1:22;
L323: ( Del (R23 , R4) ) = ( C23 ^ C22 ) by L322 , L308 , L321 , L253;
thus L324: D17 = D16 by L323 , L317 , L319 , FINSEQ_1:32;
end;
end;
thus L326: D17 = D16 by L301;
end;
L327:
now
set D18 = <* ( D15 . R4 ) *>;
set D19 = ( ( Del (R22 , R4) ) ^ R23 );
set D20 = ( Del (D15 , R4) );
assume L328: R4 <= ( len R22 );
L329: ( len R22 ) <= ( len D15 ) by L298 , NAT_1:11;
L330: R4 <= ( len D15 ) by L329 , L328 , XXREAL_0:2;
L331:
now
per cases ;
suppose L332: R4 < 1;

L333: (not R4 in ( dom R22 )) by L332 , FINSEQ_3:25;
L334: (not R4 in ( dom D15 )) by L332 , FINSEQ_3:25;
thus L335: D20 = D15 by L334 , L220
.= D19 by L333 , L220;
end;
suppose L336: R4 >= 1;

L337: R4 in ( dom D15 ) by L336 , L330 , FINSEQ_3:25;
consider C24 , C25 being FinSequence such that L338: D15 = ( ( C24 ^ D18 ) ^ C25 ) and L339: ( len C24 ) = ( R4 - 1 ) and L340: ( len C25 ) = ( ( len D15 ) - R4 ) by L337 , L205;
L341: ( len ( C24 ^ D18 ) ) = ( ( R4 - 1 ) + 1 ) by L339 , FINSEQ_2:16
.= R4;
consider C26 being FinSequence such that L342: R22 = ( ( C24 ^ D18 ) ^ C26 ) by L341 , L328 , L338 , FINSEQ_1:47;
L343: ( ( C24 ^ D18 ) ^ C25 ) = ( ( C24 ^ D18 ) ^ ( C26 ^ R23 ) ) by L338 , L342 , FINSEQ_1:32;
L344: C25 = ( C26 ^ R23 ) by L343 , FINSEQ_1:33;
L345: R4 in ( dom R22 ) by L328 , L336 , FINSEQ_3:25;
L346: ( Del (R22 , R4) ) = ( C24 ^ C26 ) by L345 , L339 , L342 , L253;
thus L347: D20 = ( C24 ^ C25 ) by L337 , L338 , L339 , L253
.= D19 by L346 , L344 , FINSEQ_1:32;
end;
end;
thus L349: D20 = D19 by L331;
end;
thus L350: thesis by L327 , L299;
end;
L351: (for R21 being FinSequence holds (for R26 being set holds (( Del (( <* R26 *> ^ R21 ) , 1) ) = R21 & ( Del (( R21 ^ <* R26 *> ) , ( ( len R21 ) + 1 )) ) = R21)))
proof
let R21 being FinSequence;
let R26 being set;
L352: ( len <* R26 *> ) = 1 by FINSEQ_1:39;
L353: 1 in ( dom <* R26 *> ) by L352 , FINSEQ_3:25;
L354: ( ( len ( Del (<* R26 *> , 1) ) ) + 1 ) = 1 by L353 , L352 , L220;
L355: ( Del (<* R26 *> , 1) ) = ( {} ) by L354;
L356: (1 <= ( len <* R26 *> ) & ( ( {} ) ^ R21 ) = R21) by FINSEQ_1:34 , FINSEQ_1:39;
thus L357: ( Del (( <* R26 *> ^ R21 ) , 1) ) = R21 by L356 , L355 , L297;
L358: ( R21 ^ ( {} ) ) = R21 by FINSEQ_1:34;
thus L359: thesis by L358 , L355 , L297;
end;
theorem
L360: (for R27 being set holds (for R28 being set holds (for R29 being set holds (( Del (<* R27 *> , 1) ) = ( {} ) & ( Del (<* R27 , R28 *> , 1) ) = <* R28 *> & ( Del (<* R27 , R28 *> , 2) ) = <* R27 *> & ( Del (<* R27 , R28 , R29 *> , 1) ) = <* R28 , R29 *> & ( Del (<* R27 , R28 , R29 *> , 2) ) = <* R27 , R29 *> & ( Del (<* R27 , R28 , R29 *> , 3) ) = <* R27 , R28 *>))))
proof
let R27 being set;
let R28 being set;
let R29 being set;
thus L361: ( Del (<* R27 *> , 1) ) = ( Del (( <* R27 *> ^ ( {} ) ) , 1) ) by FINSEQ_1:34
.= ( {} ) by L351;
thus L362: ( Del (<* R27 , R28 *> , 1) ) = <* R28 *> by L351;
L363: ( len <* R27 *> ) = 1 by FINSEQ_1:39;
thus L364: ( Del (<* R27 , R28 *> , 2) ) = ( Del (( <* R27 *> ^ <* R28 *> ) , ( ( len <* R27 *> ) + 1 )) ) by L363
.= <* R27 *> by L351;
thus L365: ( Del (<* R27 , R28 , R29 *> , 1) ) = ( Del (( <* R27 *> ^ <* R28 , R29 *> ) , 1) ) by FINSEQ_1:43
.= <* R28 , R29 *> by L351;
L366: ( len <* R27 , R28 *> ) = 2 by FINSEQ_1:44;
thus L367: ( Del (<* R27 , R28 , R29 *> , 2) ) = <* R27 , R29 *> by L366 , L364 , L297;
L368: ( ( len <* R27 , R28 *> ) + 1 ) = 3 by L366;
thus L369: thesis by L368 , L351;
end;
L370: (for R21 being FinSequence holds (1 <= ( len R21 ) implies (R21 = ( <* ( R21 . 1 ) *> ^ ( Del (R21 , 1) ) ) & R21 = ( ( Del (R21 , ( len R21 )) ) ^ <* ( R21 . ( len R21 ) ) *> ))))
proof
let R21 being FinSequence;
set D21 = ( <* ( R21 . 1 ) *> ^ ( Del (R21 , 1) ) );
set D22 = ( ( Del (R21 , ( len R21 )) ) ^ <* ( R21 . ( len R21 ) ) *> );
L371: ( len <* ( R21 . 1 ) *> ) = 1 by FINSEQ_1:39;
assume L372: 1 <= ( len R21 );
L373: ( len R21 ) in ( dom R21 ) by L372 , FINSEQ_3:25;
L374: 1 in ( dom R21 ) by L372 , FINSEQ_3:25;
L375: ( len R21 ) = ( ( len <* ( R21 . 1 ) *> ) + ( len ( Del (R21 , 1) ) ) ) by L374 , L371 , L220
.= ( len D21 ) by FINSEQ_1:22;
L376: (for B9 being Nat holds ((1 <= B9 & B9 <= ( len R21 )) implies ( R21 . B9 ) = ( D21 . B9 )))
proof
let C27 being Nat;
assume that
L377: 1 <= C27
and
L378: C27 <= ( len R21 );
L379:
now
per cases  by L377 , XXREAL_0:1;
suppose L380: C27 = 1;

L381: 1 in ( dom <* ( R21 . 1 ) *> ) by L371 , FINSEQ_3:25;
thus L382: ( D21 . C27 ) = ( <* ( R21 . 1 ) *> . 1 ) by L381 , L380 , FINSEQ_1:def 7
.= ( R21 . C27 ) by L380 , FINSEQ_1:40;
end;
suppose L383: C27 > 1;

L384: ( C27 - 1 ) > ( 0 ) by L383 , XREAL_1:50;
reconsider D23 = ( C27 - 1 ) as (Element of ( NAT )) by L384 , INT_1:3;
L385: D23 >= 1 by L384 , NAT_1:14;
thus L386: ( D21 . C27 ) = ( ( Del (R21 , 1) ) . D23 ) by L371 , L375 , L378 , L383 , FINSEQ_1:24
.= ( R21 . ( D23 + 1 ) ) by L374 , L385 , L220
.= ( R21 . C27 );
end;
end;
thus L388: thesis by L379;
end;
thus L389: D21 = R21 by L376 , L375 , FINSEQ_1:14;
L390: ( len <* ( R21 . ( len R21 ) ) *> ) = 1 by FINSEQ_1:39;
L391: ( len R21 ) = ( ( len <* ( R21 . ( len R21 ) ) *> ) + ( len ( Del (R21 , ( len R21 )) ) ) ) by L390 , L373 , L220
.= ( len D22 ) by FINSEQ_1:22;
L392: ( ( len ( Del (R21 , ( len R21 )) ) ) + 1 ) = ( len R21 ) by L373 , L220;
L393: ( len ( Del (R21 , ( len R21 )) ) ) = ( ( len R21 ) - 1 ) by L392;
L394: (for B10 being Nat holds ((1 <= B10 & B10 <= ( len R21 )) implies ( R21 . B10 ) = ( D22 . B10 )))
proof
let C28 being Nat;
assume that
L395: 1 <= C28
and
L396: C28 <= ( len R21 );
L397:
now
per cases  by L396 , XXREAL_0:1;
suppose L398: C28 = ( len R21 );

reconsider D24 = ( C28 - ( C28 - 1 ) ) as (Element of ( NAT ));
thus L399: ( D22 . C28 ) = ( <* ( R21 . ( len R21 ) ) *> . D24 ) by L392 , L391 , L398 , FINSEQ_1:24 , XREAL_1:146
.= ( R21 . C28 ) by L398 , FINSEQ_1:40;
end;
suppose L400: C28 < ( len R21 );

L401: ( C28 + 1 ) <= ( len R21 ) by L400 , NAT_1:13;
L402: C28 <= ( len ( Del (R21 , ( len R21 )) ) ) by L401 , L393 , XREAL_1:19;
L403: C28 in ( dom ( Del (R21 , ( len R21 )) ) ) by L402 , L395 , FINSEQ_3:25;
thus L404: ( D22 . C28 ) = ( ( Del (R21 , ( len R21 )) ) . C28 ) by L403 , FINSEQ_1:def 7
.= ( R21 . C28 ) by L373 , L400 , L220;
end;
end;
thus L406: thesis by L397;
end;
thus L407: thesis by L394 , L391 , FINSEQ_1:14;
end;
L408: (for R4 being Nat holds (for R34 being (FinSequence of ( REAL )) holds (R4 in ( dom R34 ) implies ( ( Product ( Del (R34 , R4) ) ) * ( R34 . R4 ) ) = ( Product R34 ))))
proof
let R4 being Nat;
let R34 being (FinSequence of ( REAL ));
defpred S6[ Nat ] means ($1 in ( dom R34 ) implies ( ( R34 . $1 ) * ( Product ( Del (R34 , $1) ) ) ) = ( Product R34 ));
L409: (for R4 being Nat holds (S6[ R4 ] implies S6[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume that
L410: S6[ R4 ];
L411:
now
per cases ;
suppose L412: R4 = ( 0 );

thus L413: S6[ ( R4 + 1 ) ]
proof
assume L414: ( R4 + 1 ) in ( dom R34 );
L415: ( R4 + 1 ) <= ( len R34 ) by L414 , FINSEQ_3:25;
L416: ( <* ( R34 . 1 ) *> ^ ( Del (R34 , 1) ) ) = R34 by L415 , L412 , L370;
L417: ( Product R34 ) = ( ( Product <* ( R34 . 1 ) *> ) * ( Product ( Del (R34 , 1) ) ) ) by L416 , RVSUM_1:97
.= ( ( R34 . 1 ) * ( Product ( Del (R34 , 1) ) ) ) by RVSUM_1:95;
thus L418: thesis by L417 , L412;
end;

end;
suppose L414: (R4 > ( 0 ) & R4 < ( len R34 ));

L415: (( R4 + 1 ) >= 1 & ( R4 + 1 ) <= ( len R34 )) by L414 , NAT_1:11 , NAT_1:13;
L416: ( R4 + 1 ) in ( dom R34 ) by L415 , FINSEQ_3:25;
consider R22 being FinSequence, R23 being FinSequence such that L417: R34 = ( ( R22 ^ <* ( R34 . ( R4 + 1 ) ) *> ) ^ R23 ) and L418: ( len R22 ) = ( ( R4 + 1 ) - 1 ) and L419: ( len R23 ) = ( ( len R34 ) - ( R4 + 1 ) ) by L416 , L205;
L420: ( Del (R34 , ( R4 + 1 )) ) = ( R22 ^ R23 ) by L416 , L417 , L418 , L253;
reconsider D25 = R23 as (FinSequence of ( REAL )) by L417 , FINSEQ_1:36;
reconsider D26 = R22 as (FinSequence of ( REAL )) by L420 , FINSEQ_1:36;
L421: ( Product R34 ) = ( ( Product ( D26 ^ <* ( R34 . ( R4 + 1 ) ) *> ) ) * ( Product D25 ) ) by L417 , RVSUM_1:97
.= ( ( ( Product D26 ) * ( Product <* ( R34 . ( R4 + 1 ) ) *> ) ) * ( Product D25 ) ) by RVSUM_1:97
.= ( ( ( R34 . ( R4 + 1 ) ) * ( Product D26 ) ) * ( Product D25 ) ) by RVSUM_1:95
.= ( ( R34 . ( R4 + 1 ) ) * ( ( Product D26 ) * ( Product D25 ) ) );
thus L422: thesis by L421 , L420 , RVSUM_1:97;
end;
suppose L423: R4 >= ( len R34 );

L424: ( len R34 ) < ( R4 + 1 ) by L423 , NAT_1:13;
thus L425: thesis by L424 , FINSEQ_3:25;
end;
end;
thus L427: thesis by L411;
end;
L428: S6[ ( 0 ) ] by FINSEQ_3:25;
L429: (for R4 being Nat holds S6[ R4 ]) from NAT_1:sch 2(L428 , L409);
thus L430: thesis by L429;
end;
theorem
L431: (for R4 being Nat holds (for R34 being (FinSequence of ( REAL )) holds (R4 in ( dom R34 ) implies ( ( Sum ( Del (R34 , R4) ) ) + ( R34 . R4 ) ) = ( Sum R34 ))))
proof
let R4 being Nat;
let R34 being (FinSequence of ( REAL ));
defpred S7[ Nat ] means ($1 in ( dom R34 ) implies ( ( R34 . $1 ) + ( Sum ( Del (R34 , $1) ) ) ) = ( Sum R34 ));
L432: (for R4 being Nat holds (S7[ R4 ] implies S7[ ( R4 + 1 ) ]))
proof
let R4 being Nat;
assume that
L433: S7[ R4 ];
L434:
now
per cases ;
suppose L435: R4 = ( 0 );

thus L436: S7[ ( R4 + 1 ) ]
proof
assume L437: ( R4 + 1 ) in ( dom R34 );
L438: ( R4 + 1 ) <= ( len R34 ) by L437 , FINSEQ_3:25;
L439: ( <* ( R34 . 1 ) *> ^ ( Del (R34 , 1) ) ) = R34 by L438 , L435 , L370;
L440: ( Sum R34 ) = ( ( Sum <* ( R34 . 1 ) *> ) + ( Sum ( Del (R34 , 1) ) ) ) by L439 , RVSUM_1:75
.= ( ( R34 . 1 ) + ( Sum ( Del (R34 , 1) ) ) ) by FINSOP_1:11;
thus L441: thesis by L440 , L435;
end;

end;
suppose L437: (R4 > ( 0 ) & R4 < ( len R34 ));

L438: (( R4 + 1 ) >= 1 & ( R4 + 1 ) <= ( len R34 )) by L437 , NAT_1:11 , NAT_1:13;
L439: ( R4 + 1 ) in ( dom R34 ) by L438 , FINSEQ_3:25;
consider R22 being FinSequence, R23 being FinSequence such that L440: R34 = ( ( R22 ^ <* ( R34 . ( R4 + 1 ) ) *> ) ^ R23 ) and L441: ( len R22 ) = ( ( R4 + 1 ) - 1 ) and L442: ( len R23 ) = ( ( len R34 ) - ( R4 + 1 ) ) by L439 , L205;
L443: ( Del (R34 , ( R4 + 1 )) ) = ( R22 ^ R23 ) by L439 , L440 , L441 , L253;
reconsider D27 = R23 as (FinSequence of ( REAL )) by L440 , FINSEQ_1:36;
reconsider D28 = R22 as (FinSequence of ( REAL )) by L443 , FINSEQ_1:36;
L444: ( Sum R34 ) = ( ( Sum ( D28 ^ <* ( R34 . ( R4 + 1 ) ) *> ) ) + ( Sum D27 ) ) by L440 , RVSUM_1:75
.= ( ( ( Sum D28 ) + ( Sum <* ( R34 . ( R4 + 1 ) ) *> ) ) + ( Sum D27 ) ) by RVSUM_1:75
.= ( ( ( R34 . ( R4 + 1 ) ) + ( Sum D28 ) ) + ( Sum D27 ) ) by FINSOP_1:11
.= ( ( R34 . ( R4 + 1 ) ) + ( ( Sum D28 ) + ( Sum D27 ) ) );
thus L445: thesis by L444 , L443 , RVSUM_1:75;
end;
suppose L446: R4 >= ( len R34 );

L447: ( R4 + 1 ) > ( len R34 ) by L446 , NAT_1:13;
thus L448: thesis by L447 , FINSEQ_3:25;
end;
end;
thus L450: thesis by L434;
end;
L451: S7[ ( 0 ) ] by FINSEQ_3:25;
L452: (for R4 being Nat holds S7[ R4 ]) from NAT_1:sch 2(L451 , L432);
thus L453: thesis by L452;
end;
theorem
L454: (for R4 being Nat holds (for R30 being (FinSequence of ( NAT )) holds (R4 in ( dom R30 ) implies ( ( Product R30 ) / ( R30 . R4 ) ) is (Element of ( NAT )))))
proof
let R4 being Nat;
let R30 being (FinSequence of ( NAT ));
assume L455: R4 in ( dom R30 );
consider R22 being FinSequence, R23 being FinSequence such that L456: R30 = ( ( R22 ^ <* ( R30 . R4 ) *> ) ^ R23 ) and L457: ( len R22 ) = ( R4 - 1 ) and L458: ( len R23 ) = ( ( len R30 ) - R4 ) by L455 , L205;
per cases ;
suppose L459: ( R30 . R4 ) <> ( 0 );

reconsider D29 = R23 as (FinSequence of ( NAT )) by L456 , FINSEQ_1:36;
L460: ( R22 ^ <* ( R30 . R4 ) *> ) is (FinSequence of ( NAT )) by L456 , FINSEQ_1:36;
reconsider D30 = R22 as (FinSequence of ( NAT )) by L460 , FINSEQ_1:36;
L461: ( Product R30 ) = ( ( Product ( D30 ^ <* ( R30 . R4 ) *> ) ) * ( Product D29 ) ) by L456 , RVSUM_1:97
.= ( ( ( R30 . R4 ) * ( Product D30 ) ) * ( Product D29 ) ) by RVSUM_1:96
.= ( ( R30 . R4 ) * ( ( Product D30 ) * ( Product D29 ) ) );
thus L462: thesis by L461 , L459 , XCMPLX_1:89;
end;
suppose L463: ( R30 . R4 ) = ( 0 );

L464: ( ( Product R30 ) / ( R30 . R4 ) ) = ( ( Product R30 ) * ( ( R30 . R4 ) " ) ) by XCMPLX_0:def 9
.= ( ( Product R30 ) * (( 0 ) qua Nat) ) by L463
.= ( 0 );
thus L465: thesis by L464;
end;
end;
theorem
L467: (for R20 being Rational holds ( numerator R20 ) , ( denominator R20 ) are_relative_prime )
proof
let R20 being Rational;
set D31 = ( numerator R20 );
set D32 = ( denominator R20 );
reconsider D33 = ( D31 gcd D32 ) as (Element of ( NAT )) by INT_2:20;
L468: D33 divides D31 by INT_2:21;
L469: (ex R13 being Integer st D31 = ( D33 * R13 )) by L468 , INT_1:def 3;
L470: ( D31 gcd D32 ) divides D32 by INT_2:21;
consider C29 being Nat such that L471: D32 = ( D33 * C29 ) by L470 , NAT_D:def 3;
L472: D32 <> ( 0 ) by RAT_1:def 3;
L473: D33 <> ( 0 ) by L472 , INT_2:5;
L474: D33 >= ( (( 0 ) qua Nat) + 1 ) by L473 , NAT_1:13;
reconsider D34 = C29 as (Element of ( NAT )) by ORDINAL1:def 12;
L475: D32 = ( D33 * D34 ) by L471;
assume L476: (not D31 , D32 are_relative_prime );
L477: D33 <> 1 by L476 , INT_2:def 3;
L478: D33 > 1 by L477 , L474 , XXREAL_0:1;
thus L479: contradiction by L478 , L469 , L475 , RAT_1:29;
end;
theorem
L480: (for R4 being Nat holds (for R12 being Integer holds (for R20 being Rational holds ((R20 = ( R12 / R4 ) & R4 <> ( 0 ) & R12 , R4 are_relative_prime ) implies (R12 = ( numerator R20 ) & R4 = ( denominator R20 ))))))
proof
let R4 being Nat;
let R12 being Integer;
let R20 being Rational;
assume that
L481: (R20 = ( R12 / R4 ) & R4 <> ( 0 ))
and
L482: R12 , R4 are_relative_prime ;
L483: R4 in ( NAT ) by ORDINAL1:def 12;
consider C30 being (Element of ( NAT )) such that L484: (R12 = ( ( numerator R20 ) * C30 ) & R4 = ( ( denominator R20 ) * C30 )) by L483 , L481 , RAT_1:27;
L485: ( numerator R20 ) , ( denominator R20 ) are_relative_prime  by L467;
L486: ( R12 gcd R4 ) = ( abs C30 ) by L485 , L484 , INT_2:24;
L487: 1 = ( abs C30 ) by L486 , L482 , INT_2:def 3
.= C30 by ABSVALUE:def 1;
thus L488: thesis by L487 , L484;
end;
theorem
L489: (for R4 being Nat holds (for R5 being Nat holds ((ex R20 being Rational st R4 = ( R20 |^ R5 )) implies (ex R12 being Integer st R4 = ( R12 |^ R5 )))))
proof
let R4 being Nat;
let R5 being Nat;
given R20 being Rational such that
L490: R4 = ( R20 |^ R5 );

L491:
now
L492:
now
set D35 = ( denominator R20 );
set D36 = ( numerator R20 );
assume L493: R5 <> ( 0 );
consider C31 being Nat such that L494: ( C31 + 1 ) = R5 by L493 , NAT_1:6;
L495: D35 <> ( 0 ) by RAT_1:def 3;
L496: ( D35 |^ R5 ) <> ( 0 ) by L495 , CARD_4:3;
L497: ( D36 |^ R5 ) , D35 are_relative_prime  by L70 , L467;
L498: ( ( D36 |^ R5 ) gcd D35 ) = 1 by L497 , INT_2:def 3;
L499: R20 = ( D36 / D35 ) by RAT_1:15;
L500: R4 = ( ( D36 |^ R5 ) / ( D35 |^ R5 ) ) by L499 , L490 , PREPOWER:8;
L501: ( R4 * ( D35 |^ R5 ) ) = ( D36 |^ R5 ) by L500 , L496 , XCMPLX_1:87;
L502: ( D36 |^ R5 ) = ( R4 * ( ( D35 |^ C31 ) * D35 ) ) by L501 , L494 , NEWTON:6
.= ( ( R4 * ( D35 |^ C31 ) ) * D35 );
L503: D35 divides ( D36 |^ R5 ) by L502 , INT_1:def 3;
L504: (D35 = 1 or D35 = ( - 1 )) by L503 , L498 , INT_2:13 , INT_2:22;
thus L505: thesis by L504 , L490 , L499 , INT_2:7;
end;
L506:
now
assume L507: R5 = ( 0 );
L508: R4 = 1 by L507 , L490 , NEWTON:4;
L509: R4 = ( 1 |^ ( 0 ) ) by L508 , NEWTON:4;
thus L510: thesis by L509 , L507;
end;
thus L511: thesis by L506 , L492;
end;
thus L512: thesis by L491;
end;
theorem
L513: (for R4 being Nat holds (for R7 being Nat holds ((ex R20 being Rational st R4 = ( R20 |^ R7 )) implies (ex R5 being Nat st R4 = ( R5 |^ R7 )))))
proof
let R4 being Nat;
let R7 being Nat;
assume L514: (ex R20 being Rational st R4 = ( R20 |^ R7 ));
consider R12 being Integer such that L515: R4 = ( R12 |^ R7 ) by L514 , L489;
L516:
now
assume L517: R4 = ( 0 );
L518: R7 <> ( 0 ) by L517 , L515 , NEWTON:4;
L519: R4 = ( ( 0 ) |^ R7 ) by L518 , L517 , NAT_1:14 , NEWTON:11;
thus L520: thesis by L519;
end;
L521:
now
assume L522: R7 <> ( 0 );
L523:
now
consider R8 being Nat such that L524: (R7 = ( 2 * R8 ) or R7 = ( ( 2 * R8 ) + 1 )) by L42;
consider C32 being (Element of ( NAT )) such that L525: (R12 = C32 or R12 = ( - C32 )) by INT_1:2;
assume L526: (not R12 is (Element of ( NAT )));
L527:
now
assume L528: R7 = ( ( 2 * R8 ) + 1 );
L529: ( - ( C32 |^ R7 ) ) = R4 by L528 , L515 , L526 , L525 , L7;
thus L530: thesis by L529 , L516;
end;
L531:
now
assume L532: R7 = ( 2 * R8 );
L533: R4 = ( C32 |^ R7 ) by L532 , L515 , L525 , L7;
thus L534: thesis by L533;
end;
thus L535: thesis by L531 , L524 , L527;
end;
thus L536: thesis by L523 , L515;
end;
L537:
now
assume L538: R7 = ( 0 );
L539: R4 = 1 by L538 , L515 , NEWTON:4;
L540: R4 = ( 1 |^ ( 0 ) ) by L539 , NEWTON:4;
thus L541: thesis by L540 , L538;
end;
thus L542: thesis by L537 , L521;
end;
theorem
L543: (for R4 being Nat holds (for R5 being Nat holds (for R8 being Nat holds ((R8 > ( 0 ) & ( R4 |^ R8 ) divides ( R5 |^ R8 )) implies R4 divides R5))))
proof
let R4 being Nat;
let R5 being Nat;
let R8 being Nat;
assume that
L544: R8 > ( 0 )
and
L545: ( R4 |^ R8 ) divides ( R5 |^ R8 );
consider C33 being Nat such that L546: ( ( R4 |^ R8 ) * C33 ) = ( R5 |^ R8 ) by L545 , NAT_D:def 3;
L547: R4 in ( REAL ) by XREAL_0:def 1;
L548:
now
assume that
L549: R4 <> ( 0 )
and
L550: R5 <> ( 0 );
L551: ( R4 |^ R8 ) <> ( 0 ) by L547 , L549 , CARD_4:3;
L552: C33 = ( ( R5 |^ R8 ) / ( R4 |^ R8 ) ) by L551 , L546 , XCMPLX_1:89
.= ( ( R5 / R4 ) |^ R8 ) by PREPOWER:8;
consider R7 being Nat such that L553: C33 = ( R7 |^ R8 ) by L552 , L513;
L554: ( R5 |^ R8 ) = ( ( R4 * R7 ) |^ R8 ) by L546 , L553 , NEWTON:7;
L555: R5 = ( R4 * R7 ) by L554 , L544 , L11;
thus L556: thesis by L555 , NAT_D:def 3;
end;
L557: R5 in ( REAL ) by XREAL_0:def 1;
L558:
now
assume L559: R4 = ( 0 );
L560: ( 0 ) divides ( R5 |^ R8 ) by L559 , L544 , L545 , NAT_1:14 , NEWTON:11;
L561: (ex B11 being Nat st ( ( 0 ) * B11 ) = ( R5 |^ R8 )) by L560 , NAT_D:def 3;
thus L562: thesis by L561 , L557 , L559 , CARD_4:3;
end;
L563:
now
assume L564: R5 = ( 0 );
L565: ( R4 * (( 0 ) qua Nat) ) = R5 by L564;
thus L566: thesis by L565 , NAT_D:def 3;
end;
thus L567: thesis by L563 , L558 , L548;
end;
theorem
L568: (for R4 being Nat holds (for R5 being Nat holds (ex R14 being Integer st (ex R15 being Integer st ( R4 gcd R5 ) = ( ( R4 * R14 ) + ( R5 * R15 ) )))))
proof
let R4 being Nat;
let R5 being Nat;
L569: (for R6 being Nat holds (ex R14 being Integer st (ex R15 being Integer st ( ( 0 ) gcd R6 ) = ( ( ( 0 ) * R14 ) + ( R6 * R15 ) ))))
proof
let R6 being Nat;
take ( 0 );
take 1;
thus L570: thesis by NEWTON:52;
end;
L571:
now
per cases ;
suppose L572: R4 = ( 0 );

thus L573: thesis by L572 , L569;
end;
suppose L574: R5 = ( 0 );

L575: (ex R14 being Integer st (ex R15 being Integer st ( R4 gcd R5 ) = ( ( ( 0 ) * R14 ) + ( R4 * R15 ) ))) by L574 , L569;
thus L576: thesis by L575 , L574;
end;
suppose L577: (R4 <> ( 0 ) & R5 <> ( 0 ));

defpred S8[ set ] means (ex R14 being Integer st (ex R15 being Integer st ($1 = ( ( R4 * R14 ) + ( R5 * R15 ) ) & $1 <> ( 0 ))));
L578: ( R4 + R5 ) = ( ( R4 * 1 ) + ( R5 * 1 ) );
L579: (ex B12 being Nat st S8[ B12 ]) by L578 , L577;
consider C34 being Nat such that L580: (S8[ C34 ] & (for B13 being Nat holds (S8[ B13 ] implies C34 <= B13))) from NAT_1:sch 5(L579);
consider C35 , C36 being Nat such that L581: R4 = ( ( C34 * C35 ) + C36 ) and L582: C36 < C34 by L580 , NAT_1:17;
consider R14 being Integer, R15 being Integer such that L583: C34 = ( ( R4 * R14 ) + ( R5 * R15 ) ) by L580;
L584:
now
assume L585: C36 <> ( 0 );
L586: C36 = ( R4 - ( C34 * C35 ) ) by L581
.= ( ( R4 * ( 1 - ( R14 * C35 ) ) ) + ( R5 * ( - ( R15 * C35 ) ) ) ) by L583;
thus L587: contradiction by L586 , L580 , L582 , L585;
end;
consider C37 , C38 being Nat such that L588: R5 = ( ( C34 * C37 ) + C38 ) and L589: C38 < C34 by L580 , NAT_1:17;
L590:
now
assume L591: C38 <> ( 0 );
L592: C38 = ( R5 - ( C34 * C37 ) ) by L588
.= ( ( R5 * ( 1 - ( R15 * C37 ) ) ) + ( R4 * ( - ( R14 * C37 ) ) ) ) by L583;
thus L593: contradiction by L592 , L580 , L589 , L591;
end;
L594: C34 divides R5 by L590 , L588 , NAT_D:def 3;
L595: C34 divides R4 by L581 , L584 , NAT_D:def 3;
L596: C34 divides ( R4 gcd R5 ) by L595 , L594 , NAT_D:def 5;
L597: (( R4 gcd R5 ) divides R4 & ( R4 gcd R5 ) divides R5) by NAT_D:def 5;
L598: ( R4 gcd R5 ) divides (C34 qua Integer) by L597 , L583 , L53;
thus L599: thesis by L598 , L583 , L596 , NAT_D:5;
end;
end;
thus L601: thesis by L571;
end;
theorem
L602: (for R14 being Integer holds (for R15 being Integer holds (ex R16 being Integer st (ex R17 being Integer st ( R14 gcd R15 ) = ( ( R14 * R16 ) + ( R15 * R17 ) )))))
proof
let R14 being Integer;
let R15 being Integer;
L603: ( R14 gcd R15 ) = ( ( abs R14 ) gcd ( abs R15 ) ) by INT_2:34;
consider R16 being Integer, R17 being Integer such that L604: ( ( ( abs R14 ) * R16 ) + ( ( abs R15 ) * R17 ) ) = ( R14 gcd R15 ) by L603 , L568;
L605:
now
per cases ;
suppose L606: (R14 >= ( 0 ) & R15 >= ( 0 ));

L607: (( abs R14 ) = R14 & ( abs R15 ) = R15) by L606 , ABSVALUE:def 1;
thus L608: thesis by L607 , L604;
end;
suppose L609: (R14 >= ( 0 ) & R15 < ( 0 ));

L610: ( abs R15 ) = ( - R15 ) by L609 , ABSVALUE:def 1;
L611: ( R14 gcd R15 ) = ( ( R14 * R16 ) + ( R15 * ( - R17 ) ) ) by L610 , L604 , L609 , ABSVALUE:def 1;
thus L612: thesis by L611;
end;
suppose L613: (R14 < ( 0 ) & R15 >= ( 0 ));

L614: ( abs R14 ) = ( - R14 ) by L613 , ABSVALUE:def 1;
L615: ( R14 gcd R15 ) = ( ( R14 * ( - R16 ) ) + ( R15 * R17 ) ) by L614 , L604 , L613 , ABSVALUE:def 1;
thus L616: thesis by L615;
end;
suppose L617: (R14 < ( 0 ) & R15 < ( 0 ));

L618: (( abs R14 ) = ( - R14 ) & ( abs R15 ) = ( - R15 )) by L617 , ABSVALUE:def 1;
L619: ( R14 gcd R15 ) = ( ( R14 * ( - R16 ) ) + ( R15 * ( - R17 ) ) ) by L618 , L604;
thus L620: thesis by L619;
end;
end;
thus L622: thesis by L605;
end;
theorem
L623: (for R12 being Integer holds (for R14 being Integer holds (for R15 being Integer holds ((R14 divides ( R15 * R12 ) & ( R14 gcd R15 ) = 1) implies R14 divides R12))))
proof
let R12 being Integer;
let R14 being Integer;
let R15 being Integer;
assume that
L624: R14 divides ( R15 * R12 )
and
L625: ( R14 gcd R15 ) = 1;
consider R16 being Integer, R17 being Integer such that L626: ( ( R14 * R16 ) + ( R15 * R17 ) ) = 1 by L625 , L602;
L627: R12 = ( ( ( R14 * R16 ) + ( R15 * R17 ) ) * R12 ) by L626
.= ( ( R14 * ( R16 * R12 ) ) + ( ( R15 * R12 ) * R17 ) );
thus L628: thesis by L627 , L624 , L53;
end;
theorem
L629: (for B14 , B15 , B16 being Nat holds ((( B14 gcd B15 ) = 1 & B14 divides ( B15 * B16 )) implies B14 divides B16)) by L623;
theorem
L630: (for R4 being Nat holds (for R5 being Nat holds ((R4 <> ( 0 ) & R5 <> ( 0 )) implies (ex R6 being Nat st (ex R7 being Nat st ( R4 gcd R5 ) = ( ( R4 * R6 ) - ( R5 * R7 ) ))))))
proof
let R4 being Nat;
let R5 being Nat;
assume that
L631: R4 <> ( 0 )
and
L632: R5 <> ( 0 );
consider R14 being Integer, R15 being Integer such that L633: ( R4 gcd R5 ) = ( ( R4 * R14 ) + ( R5 * R15 ) ) by L568;
set D37 = ( [/ ( max (( - ( R14 / R5 ) ) , ( R15 / R4 )) ) \] + 1 );
L634: D37 > ( R15 / R4 ) by INT_1:32 , XXREAL_0:31;
L635: ( D37 * R4 ) > R15 by L634 , L631 , XREAL_1:77;
L636: ( ( D37 * R4 ) - R15 ) > ( 0 ) by L635 , XREAL_1:50;
L637: D37 > ( - ( R14 / R5 ) ) by INT_1:32 , XXREAL_0:31;
L638: D37 > ( ( - R14 ) / R5 ) by L637 , XCMPLX_1:187;
L639: ( D37 * R5 ) > ( - R14 ) by L638 , L632 , XREAL_1:77;
L640: ( ( D37 * R5 ) - ( - R14 ) ) > ( 0 ) by L639 , XREAL_1:50;
reconsider D38 = ( ( D37 * R5 ) + R14 ) , D39 = ( ( D37 * R4 ) - R15 ) as (Element of ( NAT )) by L640 , L636 , INT_1:3;
L641: ( ( R4 * D38 ) - ( R5 * D39 ) ) = ( ( ( R4 * R14 ) + (( 0 ) qua Nat) ) + ( R5 * R15 ) );
thus L642: thesis by L641 , L633;
end;
theorem
L643: (for R4 being Nat holds (for R5 being Nat holds (for R9 being Nat holds (for R10 being Nat holds ((R9 > ( 0 ) & R10 > ( 0 ) & ( R9 gcd R10 ) = 1 & ( R4 |^ R9 ) = ( R5 |^ R10 )) implies (ex R8 being Nat st (R4 = ( R8 |^ R10 ) & R5 = ( R8 |^ R9 ))))))))
proof
let R4 being Nat;
let R5 being Nat;
let R9 being Nat;
let R10 being Nat;
assume that
L644: R9 > ( 0 )
and
L645: R10 > ( 0 )
and
L646: ( R9 gcd R10 ) = 1
and
L647: ( R4 |^ R9 ) = ( R5 |^ R10 );
L648: R5 in ( REAL ) by XREAL_0:def 1;
L649: R4 in ( REAL ) by XREAL_0:def 1;
L650:
now
per cases ;
suppose L651: R4 = ( 0 );

L652: ( R4 |^ R9 ) = ( 0 ) by L651 , L644 , NAT_1:14 , NEWTON:11;
L653: R5 = ( ( 0 ) |^ R9 ) by L652 , L647 , L648 , L651 , CARD_4:3;
L654: R4 = ( ( 0 ) |^ R10 ) by L645 , L651 , CARD_4:3;
thus L655: thesis by L654 , L653;
end;
suppose L656: R5 = ( 0 );

L657: ( R5 |^ R10 ) = ( 0 ) by L656 , L645 , NAT_1:14 , NEWTON:11;
L658: R4 = ( ( 0 ) |^ R10 ) by L657 , L647 , L649 , L656 , CARD_4:3;
L659: R5 = ( ( 0 ) |^ R9 ) by L644 , L656 , CARD_4:3;
thus L660: thesis by L659 , L658;
end;
suppose L661: (R4 <> ( 0 ) & R5 <> ( 0 ));

consider R6 being Nat, R7 being Nat such that L662: ( ( R9 * R6 ) - ( R10 * R7 ) ) = 1 by L644 , L645 , L646 , L630;
reconsider D40 = ( ( R5 |^ R6 ) / ( R4 |^ R7 ) ) as Rational;
L663: R4 = ( R4 #Z 1 ) by PREPOWER:35
.= ( ( R4 |^ ( R9 * R6 ) ) / ( R4 |^ ( R7 * R10 ) ) ) by L661 , L662 , PREPOWER:43
.= ( ( ( R4 |^ R9 ) |^ R6 ) / ( R4 |^ ( R7 * R10 ) ) ) by NEWTON:9
.= ( ( ( R5 |^ R10 ) |^ R6 ) / ( ( R4 |^ R7 ) |^ R10 ) ) by L647 , NEWTON:9
.= ( ( R5 |^ ( R10 * R6 ) ) / ( ( R4 |^ R7 ) |^ R10 ) ) by NEWTON:9
.= ( ( ( R5 |^ R6 ) |^ R10 ) / ( ( R4 |^ R7 ) |^ R10 ) ) by NEWTON:9
.= ( D40 |^ R10 ) by PREPOWER:8;
consider R11 being Nat such that L664: R4 = ( R11 |^ R10 ) by L663 , L513;
L665: ( R5 |^ R10 ) = ( R11 |^ ( R9 * R10 ) ) by L647 , L664 , NEWTON:9
.= ( ( R11 |^ R9 ) |^ R10 ) by NEWTON:9;
L666: R5 = ( R11 |^ R9 ) by L665 , L645 , L11;
thus L667: thesis by L666 , L664;
end;
end;
thus L669: thesis by L650;
end;
theorem
L670: (for R12 being Integer holds (for R14 being Integer holds (for R15 being Integer holds ((ex R35 being Integer st (ex R36 being Integer st ( ( R14 * R35 ) + ( R15 * R36 ) ) = R12)) iff ( R14 gcd R15 ) divides R12))))
proof
let R12 being Integer;
let R14 being Integer;
let R15 being Integer;
L671:
now
assume L672: ( R14 gcd R15 ) divides R12;
L673:
now
consider R16 being Integer, R17 being Integer such that L674: ( R14 gcd R15 ) = ( ( R14 * R16 ) + ( R15 * R17 ) ) by L602;
consider R13 being Integer such that L675: ( ( R14 gcd R15 ) * R13 ) = R12 by L672 , INT_1:def 3;
L676: R12 = ( ( R14 * ( R16 * R13 ) ) + ( R15 * ( R17 * R13 ) ) ) by L675 , L674;
thus L677: (ex R35 being Integer st (ex R36 being Integer st ( ( R14 * R35 ) + ( R15 * R36 ) ) = R12)) by L676;
end;
thus L678: (ex R35 being Integer st (ex R36 being Integer st ( ( R14 * R35 ) + ( R15 * R36 ) ) = R12)) by L673;
end;
L679:
now
given R35 being Integer , R36 being Integer such that
L680: ( ( R14 * R35 ) + ( R15 * R36 ) ) = R12;

L681: (( R14 gcd R15 ) divides R14 & ( R14 gcd R15 ) divides R15) by INT_2:21;
thus L682: ( R14 gcd R15 ) divides R12 by L681 , L680 , L53;
end;
thus L683: thesis by L679 , L671;
end;
theorem
L684: (for R12 being Integer holds (for R14 being Integer holds (for R15 being Integer holds (for R16 being Integer holds (for R17 being Integer holds ((R14 <> ( 0 ) & R15 <> ( 0 ) & ( ( R14 * R16 ) + ( R15 * R17 ) ) = R12) implies (for R35 being Integer holds (for R36 being Integer holds (( ( R14 * R35 ) + ( R15 * R36 ) ) = R12 implies (ex R37 being Integer st (R35 = ( R16 + ( R37 * ( R15 / ( R14 gcd R15 ) ) ) ) & R36 = ( R17 - ( R37 * ( R14 / ( R14 gcd R15 ) ) ) ))))))))))))
proof
let R12 being Integer;
let R14 being Integer;
let R15 being Integer;
let R16 being Integer;
let R17 being Integer;
assume that
L685: R14 <> ( 0 )
and
L686: R15 <> ( 0 )
and
L687: ( ( R14 * R16 ) + ( R15 * R17 ) ) = R12;
consider R18 being Integer, R19 being Integer such that L688: R14 = ( ( R14 gcd R15 ) * R18 ) and L689: R15 = ( ( R14 gcd R15 ) * R19 ) and L690: R18 , R19 are_relative_prime  by L685 , INT_2:23;
L691: ( R14 gcd R15 ) <> ( 0 ) by L685 , INT_2:5;
L692: R18 = ( R14 / ( R14 gcd R15 ) ) by L691 , L688 , XCMPLX_1:89;
L693: R19 = ( R15 / ( R14 gcd R15 ) ) by L691 , L689 , XCMPLX_1:89;
L694: ( R19 gcd R18 ) = 1 by L690 , INT_2:def 3;
let R35 being Integer;
let R36 being Integer;
assume L695: ( ( R14 * R35 ) + ( R15 * R36 ) ) = R12;
L696: ( R14 * ( R35 - R16 ) ) = ( R15 * ( R17 - R36 ) ) by L695 , L687;
L697: ( R18 * ( R35 - R16 ) ) = ( ( R15 * ( R17 - R36 ) ) / ( R14 gcd R15 ) ) by L696 , L692 , XCMPLX_1:74
.= ( R19 * ( R17 - R36 ) ) by L693 , XCMPLX_1:74;
L698: R19 divides ( R18 * ( R35 - R16 ) ) by L697 , INT_1:def 3;
L699: R19 divides ( R35 - R16 ) by L698 , L694 , L623;
consider R37 being Integer such that L700: ( R19 * R37 ) = ( R35 - R16 ) by L699 , INT_1:def 3;
L701: R19 <> ( 0 ) by L686 , L689;
L702: R37 = ( ( R35 - R16 ) / R19 ) by L701 , L700 , XCMPLX_1:89;
L703: R18 <> ( 0 ) by L685 , L688;
L704: ( ( R35 - R16 ) / R19 ) = ( ( R17 - R36 ) / R18 ) by L703 , L701 , L697 , XCMPLX_1:94;
L705: ( R37 * R18 ) = ( R17 - R36 ) by L704 , L703 , L702 , XCMPLX_1:87;
L706: R36 = ( R17 - ( R37 * R18 ) ) by L705;
L707: R35 = ( R16 + ( R37 * R19 ) ) by L700;
thus L708: thesis by L707 , L692 , L693 , L706;
end;
theorem
L709: (for R4 being Nat holds (for R5 being Nat holds (for R6 being Nat holds (for R7 being Nat holds ((( R4 gcd R5 ) = 1 & ( R4 * R5 ) = ( R6 |^ R7 )) implies (ex R8 being Nat st (ex R9 being Nat st (R4 = ( R8 |^ R7 ) & R5 = ( R9 |^ R7 )))))))))
proof
let R4 being Nat;
let R5 being Nat;
let R6 being Nat;
let R7 being Nat;
assume that
L710: ( R4 gcd R5 ) = 1
and
L711: ( R4 * R5 ) = ( R6 |^ R7 );
set D41 = ( R4 gcd R6 );
L712: D41 divides R6 by NAT_D:def 5;
L713: ( D41 |^ R7 ) divides ( R6 |^ R7 ) by L712 , L115;
L714: D41 divides R4 by NAT_D:def 5;
L715: ( D41 gcd R5 ) = 1 by L714 , L710 , L120 , NEWTON:57;
L716: ( ( D41 |^ R7 ) gcd R5 ) = 1 by L715 , L84;
L717: ( D41 |^ R7 ) divides R4 by L716 , L711 , L713 , L623;
consider C39 being Nat such that L718: ( ( D41 |^ R7 ) * C39 ) = R4 by L717 , NAT_D:def 3;
reconsider D42 = C39 as (Element of ( NAT )) by ORDINAL1:def 12;
L719:
now
L720: R6 in ( REAL ) by XREAL_0:def 1;
assume L721: R7 <> ( 0 );
consider C40 being Nat such that L722: R7 = ( 1 + C40 ) by L721 , NAT_1:10 , NAT_1:14;
reconsider D43 = C40 as (Element of ( NAT )) by ORDINAL1:def 12;
L723: R7 >= 1 by L721 , NAT_1:14;
L724:
now
assume L725: D41 <> ( 0 );
L726: (R4 <> ( 0 ) or R6 <> ( 0 )) by L725 , INT_2:5;
L727: R4 <> ( 0 ) by L726 , L711 , L720 , CARD_4:3;
L728:
now
reconsider D44 = D41 as Real by XREAL_0:def 1;
assume L729: R6 <> ( 0 );
consider C41 , C42 being Integer such that L730: R4 = ( D41 * C41 ) and L731: ( D41 * C42 ) = R6 and L732: C41 , (C42 qua Integer) are_relative_prime  by L729 , INT_2:23;
reconsider D45 = C41 , D46 = C42 as (Element of ( NAT )) by L727 , L729 , L730 , L731 , L148;
L733: D45 = ( ( ( D41 |^ ( D43 + 1 ) ) * D42 ) / D41 ) by L718 , L722 , L725 , L730 , XCMPLX_1:89
.= ( ( ( D41 * ( D41 |^ D43 ) ) * D42 ) / D41 ) by NEWTON:6
.= ( ( D41 * ( ( D41 |^ D43 ) * D42 ) ) / D41 )
.= ( ( D41 |^ D43 ) * D42 ) by L725 , XCMPLX_1:89;
L734: D42 divides D45 by L733 , NAT_D:def 3;
L735: ( D45 gcd D46 ) = 1 by L732 , INT_2:def 3;
L736: ( D42 gcd D46 ) = 1 by L735 , L734 , L120 , NEWTON:57;
L737: ( D42 gcd ( D46 |^ R7 ) ) = 1 by L736 , L84;
L738: ( D44 |^ R7 ) <> ( 0 ) by L725 , CARD_4:3;
L739: D46 = ( R6 / D41 ) by L725 , L731 , XCMPLX_1:89;
L740: ( D46 |^ R7 ) = ( ( ( D41 |^ R7 ) * ( D42 * R5 ) ) / ( D41 |^ R7 ) ) by L739 , L711 , L718 , PREPOWER:8
.= ( D42 * R5 ) by L738 , XCMPLX_1:89;
L741: D42 divides ( D46 |^ R7 ) by L740 , NAT_D:def 3;
L742: D42 = 1 by L741 , L737 , NEWTON:49;
thus L743: thesis by L742 , L718 , L740;
end;
L744:
now
assume L745: ( 0 ) = R6;
L746: R5 = ( 0 ) by L745 , L711 , L723 , L726 , NEWTON:11 , XCMPLX_1:6;
L747: R4 = 1 by L746 , L710 , NEWTON:52;
L748: R4 = ( 1 |^ R7 ) by L747 , NEWTON:10;
L749: R5 = ( ( 0 ) |^ R7 ) by L721 , L746 , NAT_1:14 , NEWTON:11;
thus L750: thesis by L749 , L748;
end;
thus L751: thesis by L744 , L728;
end;
L752:
now
assume L753: D41 = ( 0 );
L754: R4 = ( 0 ) by L753 , INT_2:5;
L755: R5 = 1 by L754 , L710 , NEWTON:52;
L756: R5 = ( 1 |^ R7 ) by L755 , NEWTON:10;
L757: R4 = ( ( 0 ) |^ R7 ) by L721 , L754 , NAT_1:14 , NEWTON:11;
thus L758: thesis by L757 , L756;
end;
thus L759: thesis by L752 , L724;
end;
L760:
now
assume L761: R7 = ( 0 );
L762: ( R4 * R5 ) = 1 by L761 , L711 , NEWTON:4;
L763: R5 divides 1 by L762 , NAT_D:def 3;
L764: R5 = 1 by L763 , L120;
L765: R5 = ( 1 |^ ( 0 ) ) by L764 , NEWTON:4;
L766: R4 divides 1 by L762 , NAT_D:def 3;
L767: R4 = 1 by L766 , L120;
L768: R4 = ( 1 |^ ( 0 ) ) by L767 , NEWTON:4;
thus L769: thesis by L768 , L761 , L765;
end;
thus L770: thesis by L760 , L719;
end;
::$N Chinese Remainder Theorem
theorem
L771: (for R30 being (FinSequence of ( NAT )) holds (for R7 being Nat holds ((for R4 being Nat holds (R4 in ( dom R30 ) implies ( ( R30 . R4 ) gcd R7 ) = 1)) implies ( ( Product R30 ) gcd R7 ) = 1)))
proof
let R30 being (FinSequence of ( NAT ));
let R7 being Nat;
defpred S9[ set ] means (ex B17 being (FinSequence of ( NAT )) st (B17 = $1 & ((for R4 being Nat holds (R4 in ( dom B17 ) implies ( ( B17 . R4 ) gcd R7 ) = 1)) implies ( ( Product B17 ) gcd R7 ) = 1)));
L772:
now
let R30 being (FinSequence of ( NAT ));
let C43 being (Element of ( NAT ));
assume that
L773: S9[ R30 ];
thus L774: S9[ ( R30 ^ <* C43 *> ) ]
proof
set D47 = ( R30 ^ <* C43 *> );
take D47;
thus L775: D47 = ( R30 ^ <* C43 *> );
assume L776: (for R5 being Nat holds (R5 in ( dom D47 ) implies ( ( D47 . R5 ) gcd R7 ) = 1));
L777: ( dom R30 ) c= ( dom D47 ) by FINSEQ_1:26;
L778: (for R5 being Nat holds (R5 in ( dom R30 ) implies ( ( R30 . R5 ) gcd R7 ) = 1))
proof
let R5 being Nat;
assume L779: R5 in ( dom R30 );
L780: ( ( D47 . R5 ) gcd R7 ) = 1 by L779 , L776 , L777;
thus L781: thesis by L780 , L779 , FINSEQ_1:def 7;
end;
L782: ( len D47 ) in ( dom D47 ) by FINSEQ_5:6;
L783: (( len D47 ) = ( ( len R30 ) + 1 ) & ( ( D47 . ( len D47 ) ) gcd R7 ) = 1) by L782 , L776 , FINSEQ_2:16;
L784: ( C43 gcd R7 ) = 1 by L783 , FINSEQ_1:42;
L785: ( Product D47 ) = ( ( Product R30 ) * C43 ) by RVSUM_1:96;
thus L786: thesis by L785 , L773 , L778 , L784 , L57;
end;

end;
L775: S9[ ( <*> ( NAT ) ) ]
proof
take ( <*> ( NAT ) );
thus L776: thesis by NEWTON:51 , RVSUM_1:94;
end;
L777: (for R30 being (FinSequence of ( NAT )) holds S9[ R30 ]) from FINSEQ_2:sch 2(L775 , L772);
L778: (ex B18 being (FinSequence of ( NAT )) st (B18 = R30 & ((for R4 being Nat holds (R4 in ( dom B18 ) implies ( ( B18 . R4 ) gcd R7 ) = 1)) implies ( ( Product B18 ) gcd R7 ) = 1))) by L777;
thus L779: thesis by L778;
end;
theorem
L780: (for R30 being (FinSequence of ( NAT )) holds ((( len R30 ) >= 2 & (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( dom R30 ) & R6 in ( dom R30 ) & R5 <> R6) implies ( ( R30 . R5 ) gcd ( R30 . R6 ) ) = 1)))) implies (for R31 being (FinSequence of ( INT )) holds (( len R31 ) = ( len R30 ) implies (ex R32 being (FinSequence of ( INT )) st (( len R32 ) = ( len R30 ) & (for R5 being Nat holds (R5 in ( dom R30 ) implies ( ( ( R30 . R5 ) * ( R32 . R5 ) ) + ( R31 . R5 ) ) = ( ( ( R30 . 1 ) * ( R32 . 1 ) ) + ( R31 . 1 ) )))))))))
proof
let R30 being (FinSequence of ( NAT ));
defpred S10[ (FinSequence of ( NAT )) ] means (for R31 being (FinSequence of ( INT )) holds (( len R31 ) = ( len $1 ) implies (ex R32 being (FinSequence of ( INT )) st (( len R32 ) = ( len $1 ) & (for R5 being Nat holds (R5 in ( dom $1 ) implies ( ( ( $1 . R5 ) * ( R32 . R5 ) ) + ( R31 . R5 ) ) = ( ( ( $1 . 1 ) * ( R32 . 1 ) ) + ( R31 . 1 ) )))))));
defpred S11[ (FinSequence of ( NAT )) ] means (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( dom $1 ) & R6 in ( dom $1 ) & R5 <> R6) implies ( ( $1 . R5 ) gcd ( $1 . R6 ) ) = 1)));
defpred S12[ set ] means (ex B19 being (FinSequence of ( NAT )) st (B19 = $1 & ((( len B19 ) >= 2 & S11[ B19 ]) implies S10[ B19 ])));
L781:
now
let R30 being (FinSequence of ( NAT ));
let C44 being (Element of ( NAT ));
assume that
L782: S12[ R30 ];
set D48 = ( len R30 );
set D49 = ( R30 ^ <* C44 *> );
L783:
now
assume that
L784: ( len D49 ) >= 2
and
L785: S11[ D49 ];
L786: ( len D49 ) = ( D48 + 1 ) by FINSEQ_2:16;
L787:
now
per cases  by L784 , XXREAL_0:1;
suppose L788: ( len D49 ) = 2;

L789:
now
let R31 being (FinSequence of ( INT ));
assume that
L790: ( len R31 ) = ( len D49 );
L791: (1 in ( dom D49 ) & 2 in ( dom D49 )) by L788 , FINSEQ_3:25;
L792: ( ( D49 . 1 ) gcd ( D49 . 2 ) ) = 1 by L791 , L785;
L793: ( ( D49 . 1 ) gcd ( D49 . 2 ) ) divides ( ( R31 . 1 ) - ( R31 . 2 ) ) by L792 , INT_2:12;
consider R14 being Integer, R15 being Integer such that L794: ( ( ( D49 . 1 ) * R14 ) + ( ( D49 . 2 ) * R15 ) ) = ( ( R31 . 1 ) - ( R31 . 2 ) ) by L793 , L670;
reconsider D50 = ( - R14 ) , D51 = R15 as (Element of ( INT )) by INT_1:def 2;
take D52 = <* D50 , D51 *>;
thus L795: ( len D52 ) = ( len D49 ) by L788 , FINSEQ_1:44;
let R5 being Nat;
assume L796: R5 in ( dom D49 );
L797: R5 in ( Seg ( len D49 ) ) by L796 , FINSEQ_1:def 3;
L798:
now
per cases  by L788 , L797 , FINSEQ_1:2 , TARSKI:def 2;
suppose L799: R5 = 1;

thus L800: ( ( ( D49 . R5 ) * ( D52 . R5 ) ) + ( R31 . R5 ) ) = ( ( ( D49 . 1 ) * ( D52 . 1 ) ) + ( R31 . 1 ) ) by L799;
end;
suppose L801: R5 = 2;

L802: (( D52 . 1 ) = ( - R14 ) & ( D52 . 2 ) = R15) by FINSEQ_1:44;
L803: ( ( ( D49 . 2 ) * R15 ) - ( ( D49 . 1 ) * ( - R14 ) ) ) = ( ( R31 . 1 ) - ( R31 . 2 ) ) by L794;
thus L804: ( ( ( D49 . R5 ) * ( D52 . R5 ) ) + ( R31 . R5 ) ) = ( ( ( D49 . 1 ) * ( D52 . 1 ) ) + ( R31 . 1 ) ) by L803 , L801 , L802 , XCMPLX_1:34;
end;
end;
thus L806: ( ( ( D49 . R5 ) * ( D52 . R5 ) ) + ( R31 . R5 ) ) = ( ( ( D49 . 1 ) * ( D52 . 1 ) ) + ( R31 . 1 ) ) by L798;
end;
thus L807: S10[ D49 ] by L789;
end;
suppose L808: ( len D49 ) > 2;

L809: S11[ R30 ]
proof
L810: ( dom R30 ) c= ( dom D49 ) by FINSEQ_1:26;
let R5 being Nat;
let R6 being Nat;
assume that
L811: (R5 in ( dom R30 ) & R6 in ( dom R30 ))
and
L812: R5 <> R6;
L813: (( D49 . R5 ) = ( R30 . R5 ) & ( D49 . R6 ) = ( R30 . R6 )) by L811 , FINSEQ_1:def 7;
thus L814: thesis by L813 , L785 , L811 , L812 , L810;
end;
L815: ( D48 + 1 ) > ( 1 + 1 ) by L808 , FINSEQ_2:16;
L816: D48 >= ( 1 + 1 ) by L815 , NAT_1:13;
L817:
now
let R33 being (FinSequence of ( INT ));
assume L818: ( len R33 ) = ( len D49 );
consider C45 being (FinSequence of ( INT )), C46 being (Element of ( INT )) such that L819: R33 = ( C45 ^ <* C46 *> ) by L818 , FINSEQ_2:19;
L820: ( D48 + 1 ) = ( ( len C45 ) + 1 ) by L786 , L818 , L819 , FINSEQ_2:16;
consider R32 being (FinSequence of ( INT )) such that L821: ( len R32 ) = D48 and L822: (for R5 being Nat holds (R5 in ( dom R30 ) implies ( ( ( R30 . R5 ) * ( R32 . R5 ) ) + ( C45 . R5 ) ) = ( ( ( R30 . 1 ) * ( R32 . 1 ) ) + ( C45 . 1 ) ))) by L820 , L782 , L815 , L809 , NAT_1:13;
L823: (for R4 being Nat holds (R4 in ( dom R30 ) implies ( ( R30 . R4 ) gcd C44 ) = 1))
proof
let R4 being Nat;
L824: ( ( len R30 ) + 1 ) in ( dom D49 ) by L786 , FINSEQ_5:6;
L825: (( dom R30 ) c= ( dom D49 ) & ( D49 . ( ( len R30 ) + 1 ) ) = C44) by FINSEQ_1:26 , FINSEQ_1:42;
assume L826: R4 in ( dom R30 );
L827: ( ( len R30 ) + 1 ) > ( len R30 ) by NAT_1:13;
L828: ( ( len R30 ) + 1 ) <> R4 by L827 , L826 , FINSEQ_3:25;
L829: ( D49 . R4 ) = ( R30 . R4 ) by L826 , FINSEQ_1:def 7;
thus L830: thesis by L829 , L785 , L826 , L825 , L828 , L824;
end;
L831: ( ( Product R30 ) gcd C44 ) = 1 by L823 , L771;
L832: ( ( Product R30 ) gcd C44 ) divides ( ( ( R33 . ( D48 + 1 ) ) - ( ( R30 . 1 ) * ( R32 . 1 ) ) ) - ( R33 . 1 ) ) by L831 , INT_2:12;
consider R16 being Integer, R17 being Integer such that L833: ( ( ( Product R30 ) * R16 ) + ( C44 * R17 ) ) = ( ( ( R33 . ( D48 + 1 ) ) - ( ( R30 . 1 ) * ( R32 . 1 ) ) ) - ( R33 . 1 ) ) by L832 , L670;
reconsider D53 = ( - R17 ) as (Element of ( INT )) by INT_1:def 2;
deffunc H1(Nat) = ( ( ( Product ( Del (R30 , $1) ) ) * R16 ) + ( R32 . $1 ) );
consider C47 being FinSequence such that L834: (( len C47 ) = D48 & (for B20 being Nat holds (B20 in ( dom C47 ) implies ( C47 . B20 ) = H1(B20)))) from FINSEQ_1:sch 2;
L835: (for B21 being Nat holds (B21 in ( dom C47 ) implies ( C47 . B21 ) in ( INT )))
proof
let C48 being Nat;
assume L836: C48 in ( dom C47 );
reconsider D54 = C48 as (Element of ( NAT )) by ORDINAL1:def 12;
L837: ( C47 . D54 ) = ( ( ( Product ( Del (R30 , D54) ) ) * R16 ) + ( R32 . D54 ) ) by L834 , L836;
thus L838: thesis by L837 , INT_1:def 2;
end;
L839: ( dom C47 ) = ( Seg D48 ) by L834 , FINSEQ_1:def 3;
reconsider D55 = C47 as (FinSequence of ( INT )) by L835 , FINSEQ_2:12;
take D56 = ( D55 ^ <* D53 *> );
thus L840: ( len D56 ) = ( len D49 ) by L786 , L834 , FINSEQ_2:16;
let R5 being Nat;
assume that
L841: R5 in ( dom D49 );
thus L842: ( ( ( D49 . R5 ) * ( D56 . R5 ) ) + ( R33 . R5 ) ) = ( ( ( D49 . 1 ) * ( D56 . 1 ) ) + ( R33 . 1 ) )
proof
L843: (for R6 being Nat holds (R6 in ( Seg D48 ) implies ( ( D49 . R6 ) * ( D56 . R6 ) ) = ( ( ( Product R30 ) * R16 ) + ( ( R30 . R6 ) * ( R32 . R6 ) ) )))
proof
let R6 being Nat;
assume L844: R6 in ( Seg D48 );
L845: R6 in ( dom D55 ) by L844 , L834 , FINSEQ_1:def 3;
L846: ( D56 . R6 ) = ( D55 . R6 ) by L845 , FINSEQ_1:def 7
.= ( ( ( Product ( Del (R30 , R6) ) ) * R16 ) + ( R32 . R6 ) ) by L834 , L839 , L844;
L847: R6 in ( dom R30 ) by L844 , FINSEQ_1:def 3;
L848: ( R30 . R6 ) = ( D49 . R6 ) by L847 , FINSEQ_1:def 7;
thus L849: ( ( D49 . R6 ) * ( D56 . R6 ) ) = ( ( ( ( R30 . R6 ) * ( Product ( Del (R30 , R6) ) ) ) * R16 ) + ( ( R30 . R6 ) * ( R32 . R6 ) ) ) by L848 , L846
.= ( ( ( Product R30 ) * R16 ) + ( ( R30 . R6 ) * ( R32 . R6 ) ) ) by L847 , L408;
end;
L850: R5 in ( NAT ) by ORDINAL1:def 12;
L851: 1 <= R5 by L841 , FINSEQ_3:25;
L852: R5 <= ( D48 + 1 ) by L786 , L841 , FINSEQ_3:25;
L853:
now
per cases  by L852 , NAT_1:8;
suppose L854: R5 <= D48;

L855: 1 <= D48 by L854 , L851 , XXREAL_0:2;
L856: 1 in ( Seg D48 ) by L855;
L857: 1 in ( dom C45 ) by L856 , L820 , FINSEQ_1:def 3;
L858: ( R33 . 1 ) = ( C45 . 1 ) by L857 , L819 , FINSEQ_1:def 7;
L859: R5 in ( Seg D48 ) by L851 , L850 , L854;
L860: R5 in ( dom R30 ) by L859 , FINSEQ_1:def 3;
L861: R5 in ( dom C45 ) by L820 , L859 , FINSEQ_1:def 3;
L862: ( R33 . R5 ) = ( C45 . R5 ) by L861 , L819 , FINSEQ_1:def 7;
thus L863: ( ( ( D49 . R5 ) * ( D56 . R5 ) ) + ( R33 . R5 ) ) = ( ( ( ( Product R30 ) * R16 ) + ( ( R30 . R5 ) * ( R32 . R5 ) ) ) + ( R33 . R5 ) ) by L843 , L859
.= ( ( ( Product R30 ) * R16 ) + ( ( ( R30 . R5 ) * ( R32 . R5 ) ) + ( C45 . R5 ) ) ) by L862
.= ( ( ( Product R30 ) * R16 ) + ( ( ( R30 . 1 ) * ( R32 . 1 ) ) + ( C45 . 1 ) ) ) by L822 , L860
.= ( ( ( ( Product R30 ) * R16 ) + ( ( R30 . 1 ) * ( R32 . 1 ) ) ) + ( C45 . 1 ) )
.= ( ( ( D49 . 1 ) * ( D56 . 1 ) ) + ( R33 . 1 ) ) by L843 , L856 , L858;
end;
suppose L864: R5 = ( D48 + 1 );

L865: ( D49 . R5 ) = C44 by L864 , FINSEQ_1:42;
L866: ( ( R33 . R5 ) - ( ( ( R30 . 1 ) * ( R32 . 1 ) ) + ( R33 . 1 ) ) ) = ( ( C44 * R17 ) + ( ( Product R30 ) * R16 ) ) by L833 , L864;
L867: 1 <= D48 by L816 , XXREAL_0:2;
L868: 1 in ( Seg D48 ) by L867;
L869: ( ( ( D49 . 1 ) * ( D56 . 1 ) ) + ( R33 . 1 ) ) = ( ( ( ( Product R30 ) * R16 ) + ( ( R30 . 1 ) * ( R32 . 1 ) ) ) + ( R33 . 1 ) ) by L868 , L843
.= ( ( R33 . R5 ) + ( C44 * ( - R17 ) ) ) by L866;
thus L870: thesis by L869 , L834 , L864 , L865 , FINSEQ_1:42;
end;
end;
thus L872: thesis by L853;
end;

end;
thus L843: S10[ D49 ] by L817;
end;
end;
thus L845: S10[ D49 ] by L787;
end;
thus L846: S12[ D49 ] by L783;
end;
L847: S12[ ( <*> ( NAT ) ) ]
proof
take ( <*> ( NAT ) );
thus L848: thesis;
end;
L849: (for R30 being (FinSequence of ( NAT )) holds S12[ R30 ]) from FINSEQ_2:sch 2(L847 , L781);
L850: (ex B22 being (FinSequence of ( NAT )) st (B22 = R30 & ((( len B22 ) >= 2 & S11[ B22 ]) implies S10[ B22 ]))) by L849;
thus L851: thesis by L850;
end;
L852: (for R12 being Integer holds (for R14 being Integer holds (R12 divides R14 iff R12 divides ( abs R14 ))))
proof
let R12 being Integer;
let R14 being Integer;
per cases ;
suppose L853: R14 >= ( 0 );

thus L854: thesis by L853 , ABSVALUE:def 1;
end;
suppose L855: R14 < ( 0 );

L856: ( abs R14 ) = ( - R14 ) by L855 , ABSVALUE:def 1;
thus L857: thesis by L856 , INT_2:10;
end;
end;
L859: (for R14 being Integer holds (for R15 being Integer holds ( ( R14 * R15 ) mod R15 ) = ( 0 )))
proof
let R14 being Integer;
let R15 being Integer;
per cases ;
suppose L860: R15 <> ( 0 );

thus L861: ( ( R14 * R15 ) mod R15 ) = ( ( R14 * R15 ) - ( ( ( R14 * R15 ) div R15 ) * R15 ) ) by L860 , INT_1:def 10
.= ( ( R14 * R15 ) - ( [\ ( ( R14 * R15 ) / R15 ) /] * R15 ) ) by INT_1:def 9
.= ( ( R14 * R15 ) - ( [\ R14 /] * R15 ) ) by L860 , XCMPLX_1:89
.= ( ( R14 * R15 ) - ( R14 * R15 ) ) by INT_1:25
.= ( 0 );
end;
suppose L862: R15 = ( 0 );

thus L863: thesis by L862 , INT_1:def 10;
end;
end;
L865: (for R12 being Integer holds (for R14 being Integer holds (for R15 being Integer holds (( R12 mod R15 ) = ( R14 mod R15 ) implies ( ( R12 - R14 ) mod R15 ) = ( 0 )))))
proof
let R12 being Integer;
let R14 being Integer;
let R15 being Integer;
assume L866: ( R12 mod R15 ) = ( R14 mod R15 );
per cases ;
suppose L867: R15 <> ( 0 );

L868: ( R12 - ( ( R12 div R15 ) * R15 ) ) = ( R14 mod R15 ) by L867 , L866 , INT_1:def 10
.= ( R14 - ( ( R14 div R15 ) * R15 ) ) by L867 , INT_1:def 10;
L869: ( R12 - R14 ) = ( R15 * ( ( R12 div R15 ) - ( R14 div R15 ) ) ) by L868;
thus L870: thesis by L869 , L859;
end;
suppose L871: R15 = ( 0 );

thus L872: thesis by L871 , INT_1:def 10;
end;
end;
L874: (for R14 being Integer holds (for R15 being Integer holds ((R15 <> ( 0 ) & ( R14 mod R15 ) = ( 0 )) implies R15 divides R14)))
proof
let R14 being Integer;
let R15 being Integer;
assume L875: (R15 <> ( 0 ) & ( R14 mod R15 ) = ( 0 ));
L876: R14 = ( ( ( R14 div R15 ) * R15 ) + (( 0 ) qua Nat) ) by L875 , NEWTON:66
.= ( ( R14 div R15 ) * R15 );
thus L877: thesis by L876 , INT_1:def 3;
end;
L878: (for R35 being Integer holds ((1 < R35 implies (1 < ( sqrt R35 ) & ( sqrt R35 ) < R35)) & ((( 0 ) < R35 & R35 < 1) implies (( 0 ) < ( sqrt R35 ) & ( sqrt R35 ) < 1 & R35 < ( sqrt R35 )))))
proof
let R35 being Integer;
thus L879:now
assume L880: 1 < R35;
thus L881: 1 < ( sqrt R35 ) by L880 , SQUARE_1:18 , SQUARE_1:27;
L882: ( sqrt R35 ) < ( ( sqrt R35 ) ^2 ) by L881 , SQUARE_1:14;
thus L883: ( sqrt R35 ) < R35 by L882 , L880 , SQUARE_1:def 2;
end;
thus L884:now
assume that
L885: ( 0 ) < R35
and
L886: R35 < 1;
thus L887: ( 0 ) < ( sqrt R35 ) by L885 , SQUARE_1:17 , SQUARE_1:27;
thus L888: ( sqrt R35 ) < 1 by L885 , L886 , SQUARE_1:18 , SQUARE_1:27;
L889: ( ( sqrt R35 ) ^2 ) < ( sqrt R35 ) by L888 , L887 , SQUARE_1:13;
thus L890: R35 < ( sqrt R35 ) by L889 , L885 , SQUARE_1:def 2;
end;
end;
::$N Thue Theorem
theorem
L885: (for R4 being Nat holds (for R12 being Integer holds ((R4 <> ( 0 ) & ( R4 gcd R12 ) = 1) implies (ex R5 being Nat st (ex R8 being Nat st (( 0 ) <> R5 & ( 0 ) <> R8 & R5 <= ( sqrt R4 ) & R8 <= ( sqrt R4 ) & (R4 divides ( ( R12 * R5 ) + R8 ) or R4 divides ( ( R12 * R5 ) - R8 ))))))))
proof
let R4 being Nat;
let R12 being Integer;
assume that
L886: R4 <> ( 0 )
and
L887: ( R4 gcd R12 ) = 1;
L888: R4 >= 1 by L886 , NAT_1:14;
per cases  by L888 , XXREAL_0:1;
suppose L889: R4 = 1;

take D57 = 1;
take D58 = 1;
thus L890: (D57 <> ( 0 ) & D58 <> ( 0 ));
thus L891: (D57 <= ( sqrt R4 ) & D58 <= ( sqrt R4 )) by L889 , SQUARE_1:18;
thus L892: (R4 divides ( ( R12 * D57 ) + D58 ) or R4 divides ( ( R12 * D57 ) - D58 )) by L889 , INT_2:12;
end;
suppose L893: R4 > 1;

L894: ( sqrt R4 ) > ( 0 ) by L886 , SQUARE_1:25;
set D59 = [\ ( sqrt R4 ) /];
L895: D59 <= ( sqrt R4 ) by INT_1:def 6;
L896: ( sqrt R4 ) < R4 by L893 , L878;
L897: D59 < R4 by L896 , L895 , XXREAL_0:2;
set D60 = ( D59 + 1 );
L898: D59 > ( ( sqrt R4 ) - 1 ) by INT_1:def 6;
L899: ( sqrt R4 ) > 1 by L893 , SQUARE_1:18 , SQUARE_1:27;
L900: ( ( sqrt R4 ) - 1 ) > ( 0 ) by L899 , XREAL_1:50;
reconsider D61 = D59 as (Element of ( NAT )) by L900 , L898 , INT_1:3;
L901: ( D61 + 1 ) >= 1 by L19;
reconsider D62 = D60 as (Element of ( NAT )) by L901;
set D63 = ( D62 ^2 );
L902: D63 = ( D62 * D62 );
reconsider D64 = D63 as (Element of ( NAT )) by L902;
L903: ( ( D64 - 1 ) / D62 ) = ( D62 - ( 1 / D62 ) ) by L901 , XCMPLX_1:127;
deffunc H2(Nat) = ( 1 + ( ( ( R12 * ( ( $1 - 1 ) div D62 ) ) + ( ( $1 - 1 ) mod D62 ) ) mod R4 ) );
consider R21 being FinSequence such that L904: (( len R21 ) = D64 & (for B23 being Nat holds (B23 in ( dom R21 ) implies ( R21 . B23 ) = H2(B23)))) from FINSEQ_1:sch 2;
L905: ( rng R21 ) c= ( Seg R4 )
proof
let R26 being set;
assume L906: R26 in ( rng R21 );
consider C49 being Nat such that L907: (C49 in ( dom R21 ) & ( R21 . C49 ) = R26) by L906 , FINSEQ_2:10;
L908: R26 = ( 1 + ( ( ( R12 * ( ( C49 - 1 ) div D62 ) ) + ( ( C49 - 1 ) mod D62 ) ) mod R4 ) ) by L904 , L907;
reconsider D65 = R26 as Integer by L908;
L909: ( 0 ) <= ( ( ( R12 * ( ( C49 - 1 ) div D62 ) ) + ( ( C49 - 1 ) mod D62 ) ) mod R4 ) by NEWTON:64;
L910: 1 <= D65 by L909 , L908 , L19;
reconsider D66 = D65 as (Element of ( NAT )) by L908 , L909 , INT_1:3;
L911: ( ( ( R12 * ( ( C49 - 1 ) div D62 ) ) + ( ( C49 - 1 ) mod D62 ) ) mod R4 ) < R4 by L886 , NEWTON:65;
L912: D66 <= R4 by L911 , L908 , L174;
thus L913: thesis by L912 , L910;
end;
L914: ( sqrt R4 ) < D62 by L898 , XREAL_1:19;
L915: ( ( sqrt R4 ) ^2 ) < D64 by L914 , L894 , SQUARE_1:16;
L916: R4 < D64 by L915 , SQUARE_1:def 2;
L917: ( Seg R4 ) c= ( Seg D64 ) by L916 , FINSEQ_1:5;
L918: ( Seg D64 ) = ( dom R21 ) by L904 , FINSEQ_1:def 3;
L919: ( rng R21 ) <> ( dom R21 ) by L918 , L916 , L905 , FINSEQ_1:5;
L920: (not R21 is  one-to-one) by L919 , L918 , L905 , L917 , FINSEQ_4:59 , XBOOLE_1:1;
consider C50 , C51 being set such that L921: C50 in ( dom R21 ) and L922: C51 in ( dom R21 ) and L923: ( R21 . C50 ) = ( R21 . C51 ) and L924: C50 <> C51 by L920 , FUNCT_1:def 4;
reconsider D67 = C50 , D68 = C51 as (Element of ( NAT )) by L921 , L922;
set D69 = ( ( D67 - 1 ) div D62 );
set D70 = ( ( D68 - 1 ) div D62 );
set D71 = ( D69 - D70 );
set D72 = ( ( D67 - 1 ) mod D62 );
set D73 = ( ( D68 - 1 ) mod D62 );
set D74 = ( D72 - D73 );
L925: D72 >= ( 0 ) by NEWTON:64;
L926: (( R21 . D67 ) = ( 1 + ( ( ( R12 * D69 ) + D72 ) mod R4 ) ) & ( R21 . D68 ) = ( 1 + ( ( ( R12 * D70 ) + D73 ) mod R4 ) )) by L904 , L921 , L922;
L927: ( ( ( ( R12 * D69 ) + D72 ) - ( ( R12 * D70 ) + D73 ) ) mod R4 ) = ( 0 ) by L926 , L923 , L865 , XCMPLX_1:2;
L928: R4 divides ( ( ( R12 * D69 ) + D72 ) - ( ( R12 * D70 ) + D73 ) ) by L927 , L886 , L874;
L929: ( 1 / D62 ) > ( 0 ) by L898 , L900 , XREAL_1:139;
L930: ( ( D64 - 1 ) / D62 ) < D62 by L929 , L903 , L19;
L931: D70 = [\ ( ( D68 - 1 ) / D62 ) /] by INT_1:def 9;
L932: D70 <= ( ( D68 - 1 ) / D62 ) by L931 , INT_1:def 6;
L933: D68 <= D64 by L904 , L922 , FINSEQ_3:25;
L934: ( D68 - 1 ) <= ( D64 - 1 ) by L933 , XREAL_1:9;
L935: ( ( D68 - 1 ) / D62 ) <= ( ( D64 - 1 ) / D62 ) by L934 , XREAL_1:72;
L936: ( ( D68 - 1 ) / D62 ) < D62 by L935 , L930 , XXREAL_0:2;
L937: D70 < D62 by L936 , L932 , XXREAL_0:2;
L938: D70 <= D61 by L937 , L174;
set D75 = ( ( R12 * D71 ) + D74 );
L939: [\ ( 0 ) /] = ( 0 ) by INT_1:25;
L940: D69 = [\ ( ( D67 - 1 ) / D62 ) /] by INT_1:def 9;
L941: D69 <= ( ( D67 - 1 ) / D62 ) by L940 , INT_1:def 6;
L942: 1 <= D67 by L921 , FINSEQ_3:25;
L943: ( D67 - 1 ) >= ( 0 ) by L942 , XREAL_1:48;
L944: D69 >= ( 0 ) by L943 , L940 , L939 , PRE_FF:9;
L945: ( D70 - D69 ) <= D61 by L944 , L938 , L26;
L946: ( - ( D70 - D69 ) ) >= ( - D61 ) by L945 , XREAL_1:24;
L947: (D71 <> ( 0 ) or D74 <> ( 0 ))
proof
assume L948: (not thesis);
L949: ( D67 - 1 ) = ( ( D70 * D62 ) + D73 ) by L948 , L901 , NEWTON:66
.= ( D68 - 1 ) by L901 , NEWTON:66;
thus L950: contradiction by L949 , L924;
end;
L951: D67 <= D64 by L904 , L921 , FINSEQ_3:25;
L952: ( D67 - 1 ) <= ( D64 - 1 ) by L951 , XREAL_1:9;
L953: ( ( D67 - 1 ) / D62 ) <= ( ( D64 - 1 ) / D62 ) by L952 , XREAL_1:72;
L954: ( ( D67 - 1 ) / D62 ) < D62 by L953 , L930 , XXREAL_0:2;
L955: D69 < D62 by L954 , L941 , XXREAL_0:2;
L956: D69 <= D61 by L955 , L174;
L957: ( ( ( R12 * D69 ) + D72 ) - ( ( R12 * D70 ) + D73 ) ) = ( ( R12 * D71 ) + D74 );
L958: D73 < D62 by L898 , L900 , NEWTON:65;
L959: ( D73 - D72 ) < D62 by L958 , L925 , L30;
L960: ( D73 - D72 ) <= D61 by L959 , L174;
L961: ( - ( D73 - D72 ) ) >= ( - D61 ) by L960 , XREAL_1:24;
take D76 = ( abs D71 );
take D77 = ( abs D74 );
L962: D73 >= ( 0 ) by NEWTON:64;
L963: 1 <= D68 by L922 , FINSEQ_3:25;
L964: ( D68 - 1 ) >= ( 0 ) by L963 , XREAL_1:48;
L965: D70 >= ( 0 ) by L964 , L931 , L939 , PRE_FF:9;
L966: D71 <= D61 by L965 , L956 , L26;
L967: ( abs D71 ) <= D61 by L966 , L946 , ABSVALUE:5;
L968: ( abs D71 ) < R4 by L967 , L897 , XXREAL_0:2;
L969:
now
assume L970: D74 = ( 0 );
L971: R4 divides D71 by L970 , L886 , L887 , L927 , L957 , L874 , L623;
L972: R4 divides ( abs D71 ) by L971 , L852;
L973: ( abs D71 ) = ( 0 ) by L972 , L968 , NAT_D:7;
thus L974: contradiction by L973 , L947 , L970 , ABSVALUE:2;
end;
L975: D72 < D62 by L898 , L900 , NEWTON:65;
L976: D74 < D62 by L975 , L962 , L30;
L977: D74 <= D61 by L976 , L174;
L978: ( abs D74 ) <= D61 by L977 , L961 , ABSVALUE:5;
L979: ( abs D74 ) < R4 by L978 , L897 , XXREAL_0:2;
L980:
now
assume L981: D71 = ( 0 );
L982: R4 divides ( abs D74 ) by L981 , L928 , L852;
L983: ( abs D74 ) = ( 0 ) by L982 , L979 , NAT_D:7;
thus L984: contradiction by L983 , L947 , L981 , ABSVALUE:2;
end;
thus L985: (D76 <> ( 0 ) & D77 <> ( 0 )) by L980 , L969 , ABSVALUE:2;
thus L986: D76 <= ( sqrt R4 ) by L895 , L967 , XXREAL_0:2;
thus L987: D77 <= ( sqrt R4 ) by L895 , L978 , XXREAL_0:2;
L988: (D76 = D71 or D76 = ( - D71 )) by ABSVALUE:1;
L989: (D77 = D74 or D77 = ( - D74 )) by ABSVALUE:1;
L990: ( - D75 ) = ( ( R12 * ( - D71 ) ) + ( - D74 ) );
thus L991: thesis by L990 , L928 , L988 , L989 , INT_2:10;
end;
end;
theorem
L993: (for R4 being Nat holds (for R21 being FinSequence holds ( dom ( Del (R21 , R4) ) ) c= ( dom R21 ))) by L286;
theorem
L994: (for R21 being FinSequence holds (for R26 being set holds (( Del (( <* R26 *> ^ R21 ) , 1) ) = R21 & ( Del (( R21 ^ <* R26 *> ) , ( ( len R21 ) + 1 )) ) = R21))) by L351;
begin
theorem
L995: (for R12 being Integer holds (for R38 being Nat holds ((R38 > ( 0 ) & ( R12 mod R38 ) <> ( 0 )) implies ( - ( R12 div R38 ) ) = ( ( ( - R12 ) div R38 ) + 1 ))))
proof
let R12 being Integer;
let R38 being Nat;
assume L996: R38 > ( 0 );
assume L997: ( R12 mod R38 ) <> ( 0 );
L998: (not (R38 qua Integer) divides R12) by L997 , L996 , INT_1:62;
L999: (not ( R12 / R38 ) is Integer) by L998 , L996 , L137;
thus L1000: ( - ( R12 div R38 ) ) = ( - [\ ( R12 / R38 ) /] ) by INT_1:def 9
.= ( [\ ( ( - R12 ) / R38 ) /] + 1 ) by L999 , INT_1:63
.= ( ( ( - R12 ) div R38 ) + 1 ) by INT_1:def 9;
end;
theorem
L1001: (for R12 being Integer holds (for R38 being Nat holds ((R38 > ( 0 ) & ( R12 mod R38 ) = ( 0 )) implies ( - ( R12 div R38 ) ) = ( ( - R12 ) div R38 ))))
proof
let R12 being Integer;
let R38 being Nat;
assume L1002: R38 > ( 0 );
assume L1003: ( R12 mod R38 ) = ( 0 );
L1004: (R38 qua Integer) divides R12 by L1003 , L1002 , INT_1:62;
L1005: ( R12 / R38 ) is Integer by L1004 , L1002 , L137;
thus L1006: ( - ( R12 div R38 ) ) = ( - [\ ( R12 / R38 ) /] ) by INT_1:def 9
.= [\ ( ( - R12 ) / R38 ) /] by L1005 , INT_1:64
.= ( ( - R12 ) div R38 ) by INT_1:def 9;
end;
