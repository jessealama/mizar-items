:: Linear Congruence Relation and Complete Residue Systems
::  by Xiquan Liang , Li Yan and Junjie Zhao
::
:: Received August 28, 2007
:: Copyright (c) 2007-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, INT_1, NAT_1, SUBSET_1, MEMBERED, XREAL_0, ORDINAL1,
      MEMBER_1, TARSKI, REAL_1, ARYTM_3, FUNCT_1, RELAT_1, FINSET_1, CARD_1,
      XBOOLE_0, ARYTM_1, INT_2, XXREAL_0, COMPLEX1, NEWTON, SQUARE_1, PARTFUN1,
      EQREL_1, RELAT_2, EULER_1, FINSEQ_1, FINSEQ_3, ORDINAL4, CARD_3,
      XCMPLX_0, PRE_POLY, NAT_3, UPROOTS, INT_4;
 notations TARSKI, XBOOLE_0, SUBSET_1, CARD_1, NUMBERS, MEMBERED, ORDINAL1,
      XXREAL_0, XCMPLX_0, XREAL_0, INT_1, REAL_1, INT_2, NAT_D, NEWTON,
      SQUARE_1, RELAT_1, FUNCT_1, FINSEQ_1, RELSET_1, RVSUM_1, EULER_1,
      EQREL_1, RELAT_2, PARTFUN1, FINSET_1, POLYNOM2, NAT_3, UPROOTS, TREES_4,
      WSIERP_1, MEASURE6, INTEGRA2, RECDEF_1;
 constructors EULER_1, REAL_1, WELLORD2, BINARITH, WSIERP_1, PEPIN, POLYNOM2,
      UPROOTS, NAT_3, NAT_D, MEASURE6, INTEGRA2, SEQ_1, RECDEF_1, RELSET_1;
 registrations RELAT_1, FINSEQ_1, CARD_1, PARTFUN1, NAT_1, INT_1, MEMBERED,
      FINSET_1, SEQM_3, NEWTON, NAT_3, XXREAL_0, NUMBERS, XREAL_0, ORDINAL1,
      FUNCT_1, VALUED_0, UPROOTS, RELSET_1, PEPIN;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions FUNCT_1, INT_1, FINSEQ_1, XCMPLX_0, EULER_1, RELAT_2, PARTFUN1,
      CARD_1, TARSKI, XBOOLE_0, WELLORD2;
 theorems RELAT_1, FINSEQ_3, FINSEQ_2, ABSVALUE, FINSEQ_5, EULER_2, CARD_2,
      SEQ_2, RELAT_2, RELSET_1, EQREL_1, CARD_FIN, ORDERS_1, FINSEQ_4, AXIOMS,
      MOEBIUS1, XBOOLE_0, NAT_3, NEWTON, INT_2, WSIERP_1, CARD_1, PEPIN, NAT_1,
      XCMPLX_1, XREAL_1, ORDINAL1, EULER_1, FINSEQ_1, XBOOLE_1, TARSKI,
      ZFMISC_1, RVSUM_1, INT_1, FUNCT_1, XXREAL_0, NAT_D, XREAL_0, INTEGRA2,
      VALUED_0, FUNCT_2, MEMBER_1, MEMBERED, XTUPLE_0;
 schemes NAT_1, FINSEQ_1, FINSEQ_2, RELSET_1, GRAPH_5;

begin
theorem
L1: (for B1 being  real-membered set holds (for B2 being  real number holds B1 , ( B2 ++ B1 ) are_equipotent ))
proof
let C1 being  real-membered set;
let C2 being  real number;
deffunc H1(Real) = ( C2 + $1 );
consider C3 being Function such that L2: (( dom C3 ) = C1 & (for B3 being (Element of ( REAL )) holds (B3 in C1 implies ( C3 . B3 ) = H1(B3)))) from GRAPH_5:sch 1;
L3: ( rng C3 ) = ( C2 ++ C1 )
proof
thus L4: ( rng C3 ) c= ( C2 ++ C1 )
proof
let C4 being set;
assume L5: C4 in ( rng C3 );
consider C5 being set such that L6: C5 in ( dom C3 ) and L7: C4 = ( C3 . C5 ) by L5 , FUNCT_1:def 3;
reconsider D1 = C5 as  real number by L2 , L6;
reconsider D2 = D1 as Real by XREAL_0:def 1;
L8: ( C2 + D2 ) is  real;
reconsider D3 = C4 as Real by L8 , L2 , L6 , L7;
L9: D3 = ( C2 + D2 ) by L2 , L6 , L7;
thus L10: thesis by L9 , L2 , L6 , MEMBER_1:141;
end;

let R17 being set;
assume L11: R17 in ( C2 ++ C1 );
reconsider D4 = R17 as (Element of ( REAL )) by L11;
consider C6 being (Element of ( COMPLEX )) such that L12: D4 = ( C2 + C6 ) and L13: C6 in C1 by L11 , MEMBER_1:143;
L14: C1 c= ( REAL ) by MEMBERED:3;
reconsider D5 = C6 as (Element of ( REAL )) by L14 , L13;
L15: ( C3 . D5 ) = D4 by L2 , L13 , L12;
thus L16: thesis by L15 , L2 , L13 , FUNCT_1:def 3;
end;
take C3;
L17: C3 is  one-to-one
proof
let C7 , C8 being set;
assume that
L18: C7 in ( dom C3 )
and
L19: C8 in ( dom C3 )
and
L20: ( C3 . C7 ) = ( C3 . C8 );
reconsider D6 = C7 , D7 = C8 as Real by L2 , L18 , L19 , XREAL_0:def 1;
L21: ( C3 . D6 ) = ( C2 + D6 ) by L2 , L18;
L22: ( C2 + D6 ) = ( C2 + D7 ) by L21 , L2 , L19 , L20;
thus L23: thesis by L22;
end;
thus L24: thesis by L17 , L2 , L3;
end;
registration
let C9 being  finite  real-membered set;
let C10 being  real number;
cluster ( C10 ++ C9 ) ->  finite;
coherence by L1 , CARD_1:38;
end;
theorem
L26: (for B4 being  real-membered set holds (for B5 being  real number holds ( card B4 ) = ( card ( B5 ++ B4 ) )))
proof
let C11 being  real-membered set;
let C12 being  real number;
L27: C11 , ( C12 ++ C11 ) are_equipotent  by L1;
thus L28: thesis by L27 , CARD_1:5;
end;
L29: (for B6 being Integer holds (for B7 being (Subset of ( INT )) holds ( B6 ++ B7 ) c= ( INT )))
proof
let C13 being Integer;
let C14 being (Subset of ( INT ));
let C15 being set;
assume L30: C15 in ( C13 ++ C14 );
reconsider D8 = C15 as Real by L30;
consider C16 being (Element of ( COMPLEX )) such that L31: D8 = ( C13 + C16 ) and L32: C16 in C14 by L30 , MEMBER_1:143;
reconsider D9 = C16 as Integer by L32;
L33: D8 = ( C13 + D9 ) by L31;
thus L34: thesis by L33 , INT_1:def 2;
end;
L35: (for B8 being Integer holds (for B9 being (Subset of ( INT )) holds ( B8 ** B9 ) c= ( INT )))
proof
let C17 being Integer;
let C18 being (Subset of ( INT ));
let C19 being set;
assume L36: C19 in ( C17 ** C18 );
reconsider D10 = C19 as Real by L36;
consider C20 being (Element of ( COMPLEX )) such that L37: D10 = ( C17 * C20 ) and L38: C20 in C18 by L36 , MEMBER_1:195;
reconsider D11 = C20 as Integer by L38;
L39: D10 = ( C17 * D11 ) by L37;
thus L40: thesis by L39 , INT_1:def 2;
end;
L41: (for R4 being Integer holds (for B10 being (Subset of ( INT )) holds (for B11 being Integer holds (R4 in ( B11 ** B10 ) iff (ex B12 being Integer st (B12 in B10 & R4 = ( B11 * B12 )))))))
proof
let R4 being Integer;
let C21 being (Subset of ( INT ));
let C22 being Integer;
thus L42:now
assume L43: R4 in ( C22 ** C21 );
consider C23 being (Element of ( COMPLEX )) such that L44: R4 = ( C22 * C23 ) and L45: C23 in C21 by L43 , MEMBER_1:195;
reconsider D12 = C23 as Integer by L45;
take D13 = D12;
thus L46: (D13 in C21 & R4 = ( C22 * D13 )) by L45 , L44;
end;
given C24 being Integer such that
L47: (C24 in C21 & R4 = ( C22 * C24 ));

reconsider D14 = R4 as Real by XREAL_0:def 1;
reconsider D15 = C24 as Real by XREAL_0:def 1;
L48: (ex B13 being Real st (B13 in C21 & D14 = ( C22 * B13 )))
proof
take D15;
thus L49: thesis by L47;
end;
thus L50: thesis by L48 , MEMBER_1:193;
end;
theorem
L51: (for B14 being  real-membered set holds (for B15 being  real number holds (B15 <> ( 0 ) implies B14 , ( B15 ** B14 ) are_equipotent )))
proof
let C25 being  real-membered set;
let C26 being  real number;
deffunc H2(Real) = ( C26 * $1 );
consider C27 being Function such that L52: (( dom C27 ) = C25 & (for B16 being (Element of ( REAL )) holds (B16 in C25 implies ( C27 . B16 ) = H2(B16)))) from GRAPH_5:sch 1;
assume L53: C26 <> ( 0 );
L54: C27 is  one-to-one
proof
let C28 , C29 being set;
assume that
L55: (C28 in ( dom C27 ) & C29 in ( dom C27 ))
and
L56: ( C27 . C28 ) = ( C27 . C29 );
reconsider D16 = C28 , D17 = C29 as (Element of ( REAL )) by L52 , L55 , XREAL_0:def 1;
L57: (( C27 . D16 ) = ( C26 * D16 ) & ( C27 . D17 ) = ( C26 * D17 )) by L52 , L55;
thus L58: thesis by L57 , L53 , L56 , XCMPLX_1:5;
end;
take C27;
L59: ( rng C27 ) = ( C26 ** C25 )
proof
thus L60: ( rng C27 ) c= ( C26 ** C25 )
proof
let C30 being set;
assume L61: C30 in ( rng C27 );
consider C31 being set such that L62: C31 in ( dom C27 ) and L63: C30 = ( C27 . C31 ) by L61 , FUNCT_1:def 3;
reconsider D18 = C31 as Real by L52 , L62 , XREAL_0:def 1;
L64: C30 = ( C26 * D18 ) by L52 , L62 , L63;
thus L65: thesis by L64 , L52 , L62 , MEMBER_1:193;
end;

let R17 being set;
assume L66: R17 in ( C26 ** C25 );
reconsider D19 = R17 as (Element of ( REAL )) by L66;
consider C32 being (Element of ( COMPLEX )) such that L67: D19 = ( C26 * C32 ) and L68: C32 in C25 by L66 , MEMBER_1:195;
reconsider D20 = C32 as Real by L68 , XREAL_0:def 1;
L69: ( C27 . D20 ) = D19 by L52 , L68 , L67;
thus L70: thesis by L69 , L52 , L68 , FUNCT_1:def 3;
end;
thus L71: thesis by L59 , L52 , L54;
end;
theorem
L72: (for B17 being  real-membered set holds (for B18 being  real number holds (((B18 = ( 0 ) & B17 is non  empty) implies ( B18 ** B17 ) = { ( 0 ) }) & (( B18 ** B17 ) = { ( 0 ) } implies (B18 = ( 0 ) or B17 = { ( 0 ) })))))
proof
let C33 being  real-membered set;
let C34 being  real number;
thus L73: ((C34 = ( 0 ) & C33 is non  empty) implies ( C34 ** C33 ) = { ( 0 ) })
proof
assume that
L74: C34 = ( 0 )
and
L75: C33 is non  empty;
thus L76: ( C34 ** C33 ) c= { ( 0 ) }
proof
let C35 being set;
assume L77: C35 in ( C34 ** C33 );
reconsider D21 = C35 as Real by L77;
L78: (ex B19 being (Element of ( COMPLEX )) st (D21 = ( C34 * B19 ) & B19 in C33)) by L77 , MEMBER_1:195;
thus L79: thesis by L78 , L74 , TARSKI:def 1;
end;

L80: (( C34 ** C33 ) = ( {} ) or ( C34 ** C33 ) = { ( 0 ) }) by L76 , ZFMISC_1:33;
thus L81: thesis by L80 , L75 , INTEGRA2:7;
end;

assume that
L82: ( C34 ** C33 ) = { ( 0 ) }
and
L83: C34 <> ( 0 );
L84: C33 , ( C34 ** C33 ) are_equipotent  by L83 , L51;
consider C36 being set such that L85: C33 = { C36 } by L84 , L82 , CARD_1:28;
L86: C36 in C33 by L85 , TARSKI:def 1;
reconsider D22 = C36 as  real number by L86;
L87: ( C34 * D22 ) in ( C34 ** C33 ) by L86 , MEMBER_1:193;
L88: ( C34 * D22 ) = ( 0 ) by L87 , L82 , TARSKI:def 1;
thus L89: thesis by L88 , L83 , L85 , XCMPLX_1:6;
end;
registration
let C37 being  finite  real-membered set;
let C38 being  real number;
cluster ( C38 ** C37 ) ->  finite;
coherence
proof
per cases ;
suppose L90: C38 <> ( 0 );

thus L91: thesis by L90 , L51 , CARD_1:38;
end;
suppose L92: C38 = ( 0 );

per cases ;
suppose L93: C37 is  empty;

thus L94: thesis by L93 , INTEGRA2:7;
end;
suppose L95: C37 is non  empty;

thus L96: thesis by L95 , L92 , L72;
end;
end;
end;
end;
theorem
L100: (for B20 being  real-membered set holds (for B21 being  real number holds (B21 <> ( 0 ) implies ( card B20 ) = ( card ( B21 ** B20 ) ))))
proof
let C39 being  real-membered set;
let C40 being  real number;
assume L101: C40 <> ( 0 );
L102: C39 , ( C40 ** C39 ) are_equipotent  by L101 , L51;
thus L103: thesis by L102 , CARD_1:5;
end;
begin
L104: (for R6 being Integer holds (for R7 being Integer holds (for R8 being Integer holds ((R6 divides R7 & R6 divides R8) implies R6 divides ( R7 - R8 )))))
proof
let R6 being Integer;
let R7 being Integer;
let R8 being Integer;
assume that
L105: R6 divides R7
and
L106: R6 divides R8;
consider C41 being Integer such that L107: R7 = ( R6 * C41 ) by L105 , INT_1:def 3;
consider C42 being Integer such that L108: R8 = ( R6 * C42 ) by L106 , INT_1:def 3;
L109: ( R7 - R8 ) = ( R6 * ( C41 - C42 ) ) by L107 , L108;
thus L110: thesis by L109 , INT_1:def 3;
end;
L111: (for R1 being Integer holds (for R2 being Integer holds (for R9 being Integer holds ((R9 divides R1 & R9 divides ( R1 - R2 )) implies R9 divides R2))))
proof
let R1 being Integer;
let R2 being Integer;
let R9 being Integer;
assume that
L112: R9 divides R1
and
L113: R9 divides ( R1 - R2 );
L114: R2 = ( ( - ( R1 - R2 ) ) + R1 );
L115: R9 divides ( - ( R1 - R2 ) ) by L113 , INT_2:10;
thus L116: thesis by L115 , L112 , L114 , WSIERP_1:4;
end;
L117: (for R11 being Nat holds (for R13 being Nat holds ((R11 is  prime & R11 , R13 are_relative_prime ) implies (not R11 divides R13))))
proof
let R11 being Nat;
let R13 being Nat;
assume that
L118: R11 is  prime
and
L119: R11 , R13 are_relative_prime ;
assume L120: R11 divides R13;
L121: ( R13 gcd R11 ) = R11 by L120 , NEWTON:49;
L122: ( R13 gcd R11 ) > 1 by L121 , L118 , INT_2:def 4;
thus L123: contradiction by L122 , L119 , INT_2:def 3;
end;
L124: (for R11 being Nat holds (R11 > ( 0 ) implies R11 >= ( 1 + ( 0 ) ))) by NAT_1:13;
theorem
L125: (for R6 being Integer holds (for R9 being Integer holds ((R9 divides R6 & R6 <> ( 0 )) implies ( abs R9 ) <= ( abs R6 ))))
proof
let R6 being Integer;
let R9 being Integer;
assume L126: (R9 divides R6 & R6 <> ( 0 ));
L127: (( abs R6 ) <> ( 0 ) & ( abs R9 ) divides ( abs R6 )) by L126 , ABSVALUE:2 , INT_2:16;
thus L128: thesis by L127 , NAT_D:7;
end;
theorem
L129: (for R6 being Integer holds (for R7 being Integer holds (for R8 being Integer holds (R8 <> ( 0 ) implies (R6 divides R7 iff ( R6 * R8 ) divides ( R7 * R8 ))))))
proof
let R6 being Integer;
let R7 being Integer;
let R8 being Integer;
assume L130: R8 <> ( 0 );
thus L131: (R6 divides R7 implies ( R6 * R8 ) divides ( R7 * R8 ))
proof
assume L132: R6 divides R7;
consider C43 being Integer such that L133: R7 = ( R6 * C43 ) by L132 , INT_1:def 3;
L134: ( R7 * R8 ) = ( ( R6 * R8 ) * C43 ) by L133;
thus L135: thesis by L134 , INT_1:def 3;
end;

assume L136: ( R6 * R8 ) divides ( R7 * R8 );
consider C44 being Integer such that L137: ( R7 * R8 ) = ( ( R6 * R8 ) * C44 ) by L136 , INT_1:def 3;
L138: ( R7 * R8 ) = ( ( R6 * C44 ) * R8 ) by L137;
L139: R7 = ( R6 * C44 ) by L138 , L130 , XCMPLX_1:5;
thus L140: thesis by L139 , INT_1:def 3;
end;
theorem
L141: (for B22 , B23 , B24 being Nat holds (for B25 being (Element of ( NAT )) holds (( B22 mod B24 ) = ( B23 mod B24 ) implies ( ( B22 |^ B25 ) mod B24 ) = ( ( B23 |^ B25 ) mod B24 ))))
proof
let C45 , C46 , C47 being Nat;
let C48 being (Element of ( NAT ));
defpred S1[ Nat ] means ( ( C45 |^ $1 ) mod C47 ) = ( ( C46 |^ $1 ) mod C47 );
assume L142: ( C45 mod C47 ) = ( C46 mod C47 );
L143: (for B26 being (Element of ( NAT )) holds (S1[ B26 ] implies S1[ ( B26 + 1 ) ]))
proof
let C49 being (Element of ( NAT ));
assume L144: S1[ C49 ];
reconsider D23 = ( C45 |^ C49 ) , D24 = ( C46 |^ C49 ) , D25 = C45 , D26 = C46 , D27 = C47 as (Element of ( NAT )) by ORDINAL1:def 12;
L145: ( ( D25 |^ ( C49 + 1 ) ) mod D27 ) = ( ( ( D25 |^ C49 ) * D25 ) mod D27 ) by NEWTON:6
.= ( ( ( D23 mod D27 ) * ( D25 mod D27 ) ) mod D27 ) by EULER_2:9
.= ( ( D24 * D26 ) mod D27 ) by L142 , L144 , EULER_2:9
.= ( ( D26 |^ ( C49 + 1 ) ) mod D27 ) by NEWTON:6;
thus L146: thesis by L145;
end;
L147: ( C45 |^ ( 0 ) ) = 1 by NEWTON:4;
L148: S1[ ( 0 ) ] by L147 , NEWTON:4;
L149: (for B27 being (Element of ( NAT )) holds S1[ B27 ]) from NAT_1:sch 1(L148 , L143);
thus L150: thesis by L149;
end;
theorem
L151: (for R6 being Integer holds (for R7 being Integer holds (for R8 being Integer holds (for R9 being Integer holds ((( R6 * R9 ) , ( R7 * R9 ) are_congruent_mod R8 & R9 , R8 are_relative_prime ) implies R6 , R7 are_congruent_mod R8)))))
proof
let R6 being Integer;
let R7 being Integer;
let R8 being Integer;
let R9 being Integer;
assume that
L152: ( R6 * R9 ) , ( R7 * R9 ) are_congruent_mod R8
and
L153: R9 , R8 are_relative_prime ;
L154: R8 divides ( ( R6 * R9 ) - ( R7 * R9 ) ) by L152 , INT_2:15;
L155: R8 divides ( ( R6 - R7 ) * R9 ) by L154;
L156: R8 divides ( R6 - R7 ) by L155 , L153 , INT_2:25;
thus L157: thesis by L156 , INT_2:15;
end;
theorem
L158: (for R6 being Integer holds (for R7 being Integer holds (for R8 being Integer holds (for R10 being Nat holds (R6 , R7 are_congruent_mod R8 implies ( R6 * R10 ) , ( R7 * R10 ) are_congruent_mod ( R8 * R10 ))))))
proof
let R6 being Integer;
let R7 being Integer;
let R8 being Integer;
let R10 being Nat;
assume L159: R6 , R7 are_congruent_mod R8;
consider C50 being Integer such that L160: ( R8 * C50 ) = ( R6 - R7 ) by L159 , INT_1:def 5;
L161: ( ( R8 * R10 ) * C50 ) = ( ( R8 * C50 ) * R10 )
.= ( ( R6 + ( - R7 ) ) * R10 ) by L160
.= ( ( R6 * R10 ) - ( R7 * R10 ) );
thus L162: thesis by L161 , INT_1:def 5;
end;
theorem
L163: (for R6 being Integer holds (for R7 being Integer holds (for R8 being Integer holds (for R9 being Integer holds (R6 , R7 are_congruent_mod R9 implies ( R6 * R8 ) , ( R7 * R8 ) are_congruent_mod R9)))))
proof
let R6 being Integer;
let R7 being Integer;
let R8 being Integer;
let R9 being Integer;
assume L164: R6 , R7 are_congruent_mod R9;
L165: R9 divides ( R6 - R7 ) by L164 , INT_2:15;
L166: R9 divides ( ( R6 - R7 ) * R8 ) by L165 , INT_2:2;
L167: R9 divides ( ( R6 * R8 ) - ( R7 * R8 ) ) by L166;
thus L168: thesis by L167 , INT_2:15;
end;
theorem
L169: (for B28 being Integer holds ( 0 ) = ( ( 0 ) mod B28 ))
proof
let C51 being Integer;
per cases ;
suppose L170: C51 = ( 0 );

thus L171: thesis by L170 , INT_1:def 10;
end;
suppose L172: C51 <> ( 0 );

L173: ( ( 0 ) div C51 ) = ( 0 ) by INT_1:25;
L174: ( ( 0 ) mod C51 ) = ( ( 0 ) - ( C51 * (( 0 ) qua Nat) ) ) by L173 , L172 , INT_1:def 10;
thus L175: thesis by L174;
end;
end;
theorem
L177: (for R2 being Integer holds (R2 > ( 0 ) implies (for R1 being Integer holds (ex B29 , B30 being Integer st (R1 = ( ( R2 * B29 ) + B30 ) & B30 >= ( 0 ) & B30 < R2)))))
proof
let R2 being Integer;
assume L178: R2 > ( 0 );
let C52 being Integer;
per cases ;
suppose L179: C52 >= ( 0 );

L180: R2 in ( NAT ) by L178 , INT_1:3;
L181: C52 in ( NAT ) by L179 , INT_1:3;
consider C53 , C54 being Nat such that L182: (C52 = ( ( R2 * C53 ) + C54 ) & C54 < R2) by L181 , L178 , L180 , NAT_1:17;
take C53;
take C54;
thus L183: thesis by L182;
end;
suppose L184: C52 < ( 0 );

L185: R2 in ( NAT ) by L178 , INT_1:3;
L186: ( - C52 ) in ( NAT ) by L184 , INT_1:3;
consider C55 , C56 being Nat such that L187: ( - C52 ) = ( ( R2 * C55 ) + C56 ) and L188: C56 < R2 by L186 , L178 , L185 , NAT_1:17;
per cases ;
suppose L189: C56 = ( 0 );

take D28 = ( - C55 );
take D29 = ( 0 );
L190: C52 = ( R2 * ( - C55 ) ) by L187 , L189;
thus L191: C52 = ( ( R2 * D28 ) + D29 ) by L190;
thus L192: thesis by L178;
end;
suppose L193: C56 <> ( 0 );

take D30 = ( ( - C55 ) - 1 );
take D31 = ( R2 - C56 );
L194: C52 = ( ( R2 * ( ( - C55 ) - 1 ) ) + ( R2 - C56 ) ) by L187;
thus L195: C52 = ( ( R2 * D30 ) + D31 ) by L194;
thus L196: thesis by L188 , L193 , XREAL_1:44 , XREAL_1:50;
end;
end;
end;
theorem
L199: (for R6 being Integer holds (for R7 being Integer holds (for R8 being Integer holds (R6 , R7 are_congruent_mod R8 implies ( R6 gcd R8 ) = ( R7 gcd R8 )))))
proof
let R6 being Integer;
let R7 being Integer;
let R8 being Integer;
set D32 = ( R7 gcd R8 );
reconsider D33 = D32 as Nat;
assume L200: R6 , R7 are_congruent_mod R8;
L201: R8 divides ( R6 - R7 ) by L200 , INT_2:15;
consider C57 being Integer such that L202: ( R6 - R7 ) = ( R8 * C57 ) by L201 , INT_1:def 3;
L203: D33 = ( ( abs R7 ) gcd ( abs R8 ) ) by INT_2:34;
L204: D33 divides ( abs R7 ) by L203 , NAT_D:def 5;
L205: ( abs D33 ) divides ( abs R7 ) by L204 , ABSVALUE:def 1;
L206: D33 divides R7 by L205 , INT_2:16;
L207: R7 = ( R6 - ( R8 * C57 ) ) by L202;
L208: (for B31 being Nat holds ((B31 divides ( abs R6 ) & B31 divides ( abs R8 )) implies B31 divides D33))
proof
let C58 being Nat;
assume that
L209: C58 divides ( abs R6 )
and
L210: C58 divides ( abs R8 );
L211: ( abs C58 ) divides ( abs R8 ) by L210 , ABSVALUE:def 1;
L212: C58 divides R8 by L211 , INT_2:16;
L213: C58 divides ( R8 * C57 ) by L212 , INT_2:2;
L214: ( abs C58 ) divides ( abs R6 ) by L209 , ABSVALUE:def 1;
L215: C58 divides R6 by L214 , INT_2:16;
L216: C58 divides R7 by L215 , L207 , L213 , L104;
L217: ( abs C58 ) divides ( abs R7 ) by L216 , INT_2:16;
L218: C58 divides ( abs R7 ) by L217 , ABSVALUE:def 1;
thus L219: thesis by L218 , L203 , L210 , NAT_D:def 5;
end;
L220: D33 divides ( abs R8 ) by L203 , NAT_D:def 5;
L221: ( abs D33 ) divides ( abs R8 ) by L220 , ABSVALUE:def 1;
L222: D33 divides R8 by L221 , INT_2:16;
L223: D33 divides ( R8 * C57 ) by L222 , INT_2:2;
L224: R6 = ( ( R8 * C57 ) + R7 ) by L202;
L225: (( abs D33 ) = D33 & D33 divides R6) by L224 , L206 , L223 , ABSVALUE:def 1 , WSIERP_1:4;
L226: D33 divides ( abs R6 ) by L225 , INT_2:16;
L227: ( ( abs R6 ) gcd ( abs R8 ) ) = D33 by L226 , L220 , L208 , NAT_D:def 5;
thus L228: thesis by L227 , INT_2:34;
end;
theorem
L229: (for R1 being Integer holds (for R2 being Integer holds (for R3 being Integer holds (R1 , R3 are_relative_prime  implies (ex B32 being Integer st ( ( ( R1 * B32 ) - R2 ) mod R3 ) = ( 0 ))))))
proof
let R1 being Integer;
let R2 being Integer;
let R3 being Integer;
assume L230: R1 , R3 are_relative_prime ;
L231: ( R1 gcd R3 ) = 1 by L230 , INT_2:def 3;
consider C59 , C60 being Integer such that L232: 1 = ( ( C59 * R1 ) + ( C60 * R3 ) ) by L231 , NAT_D:68;
take ( R2 * C59 );
L233: ( ( ( ( R1 * R2 ) * C59 ) - R2 ) mod R3 ) = ( ( ( ( R1 * C59 ) - 1 ) * R2 ) mod R3 )
.= ( ( ( - ( R3 * C60 ) ) * R2 ) mod R3 ) by L232
.= ( ( ( 0 ) + ( R3 * ( ( - C60 ) * R2 ) ) ) mod R3 )
.= ( ( 0 ) mod R3 ) by NAT_D:61
.= ( 0 ) by L169;
thus L234: thesis by L233;
end;
theorem
L235: (for R1 being Integer holds (for R2 being Integer holds (for R3 being Integer holds ((R3 > ( 0 ) & R1 , R3 are_relative_prime ) implies (ex B33 being Nat st ( ( ( R1 * B33 ) - R2 ) mod R3 ) = ( 0 ))))))
proof
let R1 being Integer;
let R2 being Integer;
let R3 being Integer;
assume that
L236: R3 > ( 0 )
and
L237: R1 , R3 are_relative_prime ;
consider C61 being Integer such that L238: ( ( ( R1 * C61 ) - R2 ) mod R3 ) = ( 0 ) by L237 , L229;
consider C62 , C63 being Integer such that L239: C61 = ( ( R3 * C62 ) + C63 ) and L240: C63 >= ( 0 ) and L241: C63 < R3 by L236 , L177;
L242: ( ( ( R1 * C61 ) - R2 ) mod R3 ) = ( ( ( ( R1 * C62 ) * R3 ) + ( ( R1 * C63 ) - R2 ) ) mod R3 ) by L239
.= ( ( ( R1 * C63 ) - R2 ) mod R3 ) by EULER_1:12;
L243: C63 in ( NAT ) by L240 , INT_1:3;
reconsider D34 = C63 as Nat by L243;
take D34;
thus L244: thesis by L238 , L242;
end;
theorem
L245: (for R1 being Integer holds (for R2 being Integer holds (for R3 being Integer holds ((R3 <> ( 0 ) & (not ( R1 gcd R3 ) divides R2)) implies (not (ex B34 being Integer st ( ( ( R1 * B34 ) - R2 ) mod R3 ) = ( 0 )))))))
proof
let R1 being Integer;
let R2 being Integer;
let R3 being Integer;
assume that
L246: R3 <> ( 0 )
and
L247: (not ( R1 gcd R3 ) divides R2);
given R5 being Integer such that
L248: ( ( ( R1 * R5 ) - R2 ) mod R3 ) = ( 0 );

L249: ( R1 gcd R3 ) divides R3 by INT_2:21;
L250: (ex B35 being Integer st R3 = ( ( R1 gcd R3 ) * B35 )) by L249 , INT_1:def 3;
L251: ( ( ( R1 * R5 ) - R2 ) mod R3 ) = ( ( 0 ) mod R3 ) by L248 , L169;
L252: ( ( R1 * R5 ) - R2 ) , ( 0 ) are_congruent_mod R3 by L251 , L246 , NAT_D:64;
L253: ( ( R1 * R5 ) - R2 ) , ( 0 ) are_congruent_mod ( R1 gcd R3 ) by L252 , L250 , INT_1:20;
L254: ( R1 gcd R3 ) divides ( ( ( R1 * R5 ) - R2 ) - ( 0 ) ) by L253 , INT_2:15;
L255: ( R1 gcd R3 ) divides ( R1 * R5 ) by INT_2:2 , INT_2:21;
thus L256: contradiction by L255 , L247 , L254 , L111;
end;
theorem
L257: (for R1 being Integer holds (for R2 being Integer holds (for R3 being Integer holds ((R3 <> ( 0 ) & ( R1 gcd R3 ) divides R2) implies (ex B36 being Integer st ( ( ( R1 * B36 ) - R2 ) mod R3 ) = ( 0 ))))))
proof
let R1 being Integer;
let R2 being Integer;
let R3 being Integer;
assume that
L258: R3 <> ( 0 )
and
L259: ( R1 gcd R3 ) divides R2;
consider C64 , C65 being Integer such that L260: R1 = ( ( R1 gcd R3 ) * C64 ) and L261: R3 = ( ( R1 gcd R3 ) * C65 ) and L262: C64 , C65 are_relative_prime  by L258 , INT_2:23;
consider C66 being Integer such that L263: R2 = ( ( R1 gcd R3 ) * C66 ) by L259 , INT_1:def 3;
L264: C65 <> ( 0 ) by L258 , L261;
consider C67 being Integer such that L265: ( ( ( C64 * C67 ) - C66 ) mod C65 ) = ( 0 ) by L262 , L229;
take C67;
L266: ( ( ( C64 * C67 ) - C66 ) mod C65 ) = ( ( 0 ) mod C65 ) by L265 , L169;
L267: ( ( C64 * C67 ) - C66 ) , ( 0 ) are_congruent_mod C65 by L266 , L264 , NAT_D:64;
L268: ( ( ( C64 * C67 ) - C66 ) * ( R1 gcd R3 ) ) , ( ( R1 gcd R3 ) * (( 0 ) qua Nat) ) are_congruent_mod ( C65 * ( R1 gcd R3 ) ) by L267 , L158;
L269: ( ( ( R1 * C67 ) - R2 ) mod R3 ) = ( ( 0 ) mod R3 ) by L268 , L260 , L261 , L263 , NAT_D:64;
thus L270: thesis by L269 , L169;
end;
begin
theorem
L271: (for R11 being Nat holds (for R12 being Nat holds (for R13 being Nat holds ((R13 > ( 0 ) & R11 > ( 0 )) implies ( ( R11 * R12 ) mod ( R11 |^ R13 ) ) = ( R11 * ( R12 mod ( R11 |^ ( R13 -' 1 ) ) ) )))))
proof
let R11 being Nat;
let R12 being Nat;
let R13 being Nat;
assume that
L272: R13 > ( 0 )
and
L273: R11 > ( 0 );
L274: R13 >= ( ( 0 ) + 1 ) by L272 , NAT_1:13;
L275: ( R11 * ( R12 mod ( R11 |^ ( R13 -' 1 ) ) ) ) = ( R11 * ( R12 - ( ( R12 div ( R11 |^ ( R13 -' 1 ) ) ) * ( R11 |^ ( R13 -' 1 ) ) ) ) ) by L273 , NEWTON:63
.= ( ( R11 * R12 ) - ( ( R12 div ( R11 |^ ( R13 -' 1 ) ) ) * ( R11 * ( R11 |^ ( R13 -' 1 ) ) ) ) )
.= ( ( R11 * R12 ) - ( ( R12 div ( R11 |^ ( R13 -' 1 ) ) ) * ( R11 |^ ( ( R13 -' 1 ) + 1 ) ) ) ) by NEWTON:6
.= ( ( R11 * R12 ) - ( ( R12 div ( R11 |^ ( R13 -' 1 ) ) ) * ( R11 |^ R13 ) ) ) by L274 , XREAL_1:235;
L276: ( R11 * R12 ) = ( ( ( R12 div ( R11 |^ ( R13 -' 1 ) ) ) * ( R11 |^ R13 ) ) + ( R11 * ( R12 mod ( R11 |^ ( R13 -' 1 ) ) ) ) ) by L275;
L277: ( R11 * ( R12 mod ( R11 |^ ( R13 -' 1 ) ) ) ) < ( R11 * ( R11 |^ ( R13 -' 1 ) ) ) by L273 , NAT_D:1 , XREAL_1:68;
L278: ( R11 * ( R12 mod ( R11 |^ ( R13 -' 1 ) ) ) ) < ( R11 |^ ( ( R13 -' 1 ) + 1 ) ) by L277 , NEWTON:6;
L279: ( R11 * ( R12 mod ( R11 |^ ( R13 -' 1 ) ) ) ) < ( R11 |^ R13 ) by L278 , L274 , XREAL_1:235;
thus L280: thesis by L279 , L276 , NAT_D:def 2;
end;
theorem
L281: (for R11 being Nat holds (for R12 being Nat holds (for R13 being Nat holds ( ( R11 * R12 ) mod ( R11 * R13 ) ) = ( R11 * ( R12 mod R13 ) ))))
proof
let R11 being Nat;
let R12 being Nat;
let R13 being Nat;
per cases ;
suppose L282: R13 = ( 0 );

L283: ( R12 mod R13 ) = ( 0 ) by L282 , NAT_D:def 2;
thus L284: thesis by L283 , L282 , NAT_D:def 2;
end;
suppose L285: R13 > ( 0 );

L286: ( R11 * R12 ) = ( R11 * ( ( R13 * ( R12 div R13 ) ) + ( R12 mod R13 ) ) ) by L285 , NAT_D:2
.= ( ( ( R11 * R13 ) * ( R12 div R13 ) ) + ( R11 * ( R12 mod R13 ) ) );
per cases ;
suppose L287: R11 = ( 0 );

thus L288: thesis by L287 , NAT_D:def 2;
end;
suppose L289: R11 > ( 0 );

L290: ( R11 * ( R12 mod R13 ) ) < ( R11 * R13 ) by L289 , L285 , NAT_D:1 , XREAL_1:68;
thus L291: thesis by L290 , L286 , NAT_D:def 2;
end;
end;
end;
theorem
L294: (for R11 being Nat holds (for R12 being Nat holds (for R13 being Nat holds ((R13 > ( 0 ) & R11 is  prime & R11 , R12 are_relative_prime ) implies (not R11 divides ( R12 mod ( R11 |^ R13 ) ))))))
proof
let R11 being Nat;
let R12 being Nat;
let R13 being Nat;
assume that
L295: R13 > ( 0 )
and
L296: R11 is  prime
and
L297: R11 , R12 are_relative_prime ;
L298: R13 >= ( ( 0 ) + 1 ) by L295 , NAT_1:13;
L299: ( R11 |^ 1 ) divides ( R11 |^ R13 ) by L298 , NEWTON:89;
L300: R11 divides ( R11 |^ R13 ) by L299 , NEWTON:5;
L301: R11 divides ( ( R11 |^ R13 ) * ( R12 div ( R11 |^ R13 ) ) ) by L300 , NAT_D:9;
L302: R12 = ( ( ( R11 |^ R13 ) * ( R12 div ( R11 |^ R13 ) ) ) + ( R12 mod ( R11 |^ R13 ) ) ) by L296 , NAT_D:2;
thus L303: thesis by L302 , L296 , L297 , L301 , L117 , NAT_D:8;
end;
theorem
L304: (for B37 , B38 , B39 being Nat holds (B39 > ( 0 ) implies (( ( B37 - B38 ) mod B39 ) = ( 0 ) iff ( B37 mod B39 ) = ( B38 mod B39 ))))
proof
let C68 , C69 , C70 being Nat;
assume L305: C70 > ( 0 );
thus L306: (( ( C68 - C69 ) mod C70 ) = ( 0 ) implies ( C68 mod C70 ) = ( C69 mod C70 ))
proof
assume L307: ( ( C68 - C69 ) mod C70 ) = ( 0 );
L308: C70 divides ( C68 - C69 ) by L307 , L305 , INT_1:62;
consider C71 being Integer such that L309: ( C70 * C71 ) = ( C68 - C69 ) by L308 , INT_1:def 3;
per cases  by XXREAL_0:1;
suppose L310: C68 > C69;

L311: C71 > ( 0 ) by L310 , L309 , XREAL_1:50;
L312: C71 in ( NAT ) by L311 , INT_1:3;
reconsider D35 = C71 as Nat by L312;
L313: ( C68 mod C70 ) = ( ( ( C70 * D35 ) + C69 ) mod C70 ) by L309
.= ( C69 mod C70 ) by NAT_D:21;
thus L314: thesis by L313;
end;
suppose L315: C68 = C69;

thus L316: thesis by L315;
end;
suppose L317: C68 < C69;

L318: ( C69 - C68 ) = ( C70 * ( - C71 ) ) by L309;
L319: ( - C71 ) > ( 0 ) by L318 , L317 , XREAL_1:50;
L320: ( - C71 ) in ( NAT ) by L319 , INT_1:3;
reconsider D36 = ( - C71 ) as Nat by L320;
L321: ( C69 - C68 ) = ( C70 * D36 ) by L318;
L322: ( C69 mod C70 ) = ( ( ( C70 * D36 ) + C68 ) mod C70 ) by L321
.= ( C68 mod C70 ) by NAT_D:21;
thus L323: thesis by L322;
end;
end;

assume L325: ( C68 mod C70 ) = ( C69 mod C70 );
L326: C68 = ( ( C70 * ( C68 div C70 ) ) + ( C68 mod C70 ) ) by L305 , NAT_D:2
.= ( ( C70 * ( C68 div C70 ) ) + ( C69 - ( C70 * ( C69 div C70 ) ) ) ) by L305 , L325 , NEWTON:63
.= ( C69 + ( C70 * ( ( C68 div C70 ) - ( C69 div C70 ) ) ) );
L327: C70 divides ( C68 - C69 ) by L326 , INT_1:def 3;
thus L328: thesis by L327 , L305 , INT_1:62;
end;
theorem
L329: (for B40 , B41 , B42 being Nat holds (B42 > ( 0 ) implies (( B40 mod B42 ) = ( B41 mod B42 ) iff B42 divides ( B40 - B41 ))))
proof
let C72 , C73 , C74 being Nat;
assume L330: C74 > ( 0 );
thus L331: (( C72 mod C74 ) = ( C73 mod C74 ) implies C74 divides ( C72 - C73 ))
proof
assume L332: ( C72 mod C74 ) = ( C73 mod C74 );
L333: ( ( C72 - C73 ) mod C74 ) = ( 0 ) by L332 , L330 , L304;
thus L334: thesis by L333 , L330 , INT_1:62;
end;

assume L335: C74 divides ( C72 - C73 );
L336: ( ( C72 - C73 ) mod C74 ) = ( 0 ) by L335 , L330 , INT_1:62;
thus L337: thesis by L336 , L330 , L304;
end;
theorem
L338: (for R11 being Nat holds (for R12 being Nat holds (for R13 being Nat holds ((R13 > ( 0 ) & R11 is  prime & R11 , R12 are_relative_prime ) implies (not (ex B43 being Integer st ( ( ( R11 * ( B43 ^2 ) ) - R12 ) mod ( R11 |^ R13 ) ) = ( 0 )))))))
proof
let R11 being Nat;
let R12 being Nat;
let R13 being Nat;
assume that
L339: R13 > ( 0 )
and
L340: R11 is  prime
and
L341: R11 , R12 are_relative_prime ;
given R4 being Integer such that
L342: ( ( ( R11 * ( R4 ^2 ) ) - R12 ) mod ( R11 |^ R13 ) ) = ( 0 );

L343: ( ( R11 * ( R4 ^2 ) ) mod ( R11 |^ R13 ) ) = ( R12 mod ( R11 |^ R13 ) ) by L340 , L342 , L304;
L344: ( R11 * ( ( R4 ^2 ) mod ( R11 |^ ( R13 -' 1 ) ) ) ) = ( R12 mod ( R11 |^ R13 ) ) by L343 , L339 , L340 , L271;
L345: R11 divides ( R12 mod ( R11 |^ R13 ) ) by L344 , NAT_D:def 3;
thus L346: contradiction by L345 , L339 , L340 , L341 , L294;
end;
theorem
L347: (for R11 being Nat holds (for R12 being Nat holds (for R13 being Nat holds ((R13 > ( 0 ) & R11 is  prime & R11 , R12 are_relative_prime ) implies (not (ex B44 being Integer st ( ( ( R11 * B44 ) - R12 ) mod ( R11 |^ R13 ) ) = ( 0 )))))))
proof
let R11 being Nat;
let R12 being Nat;
let R13 being Nat;
assume that
L348: R13 > ( 0 )
and
L349: R11 is  prime
and
L350: R11 , R12 are_relative_prime ;
L351: R11 > 1 by L349 , INT_2:def 4;
given C75 being Integer such that
L352: ( ( ( R11 * C75 ) - R12 ) mod ( R11 |^ R13 ) ) = ( 0 );

per cases ;
suppose L353: C75 >= ( 0 );

L354: C75 in ( NAT ) by L353 , INT_1:3;
reconsider D37 = C75 as Nat by L354;
L355: ( ( R11 * D37 ) mod ( R11 |^ R13 ) ) = ( R12 mod ( R11 |^ R13 ) ) by L349 , L352 , L304;
L356: ( R11 * ( D37 mod ( R11 |^ ( R13 -' 1 ) ) ) ) = ( R12 mod ( R11 |^ R13 ) ) by L355 , L348 , L349 , L271;
L357: R11 divides ( R12 mod ( R11 |^ R13 ) ) by L356 , NAT_D:def 3;
thus L358: contradiction by L357 , L348 , L349 , L350 , L294;
end;
suppose L359: C75 < ( 0 );

L360: ( - C75 ) in ( NAT ) by L359 , INT_1:3;
reconsider D38 = ( - C75 ) as Nat by L360;
L361: R11 divides ( R11 * D38 ) by NAT_D:9;
L362: ( R11 |^ R13 ) divides ( ( R11 * C75 ) - R12 ) by L349 , L352 , INT_1:62;
L363: ( R11 |^ R13 ) divides ( ( - 1 ) * ( ( R11 * C75 ) - R12 ) ) by L362 , INT_2:2;
consider C76 being Integer such that L364: ( ( R11 * D38 ) + R12 ) = ( ( R11 |^ R13 ) * C76 ) by L363 , INT_1:def 3;
L365: C76 >= ( 0 ) by L349 , L364 , XREAL_1:132;
L366: C76 in ( NAT ) by L365 , INT_1:3;
reconsider D39 = C76 as Nat by L366;
L367: ( ( R11 * D38 ) + R12 ) = ( ( R11 |^ R13 ) * D39 ) by L364;
L368: ( R11 |^ R13 ) divides ( ( R11 * D38 ) + R12 ) by L367 , NAT_D:def 3;
L369: R11 divides ( R11 |^ R13 ) by L348 , NAT_3:3;
L370: R11 divides ( ( R11 * D38 ) + R12 ) by L369 , L368 , NAT_D:4;
reconsider D40 = R11 , D41 = R12 as (Element of ( NAT )) by ORDINAL1:def 12;
L371: ( D40 gcd D41 ) > 1 by L351 , L370 , L361 , NAT_D:10 , NEWTON:49;
thus L372: contradiction by L371 , L350 , INT_2:def 3;
end;
end;
begin
definition
let C77 being Integer;
func Cong C77 -> (Relation of ( INT )) means 
:L374: (for R4 being Integer holds (for R5 being Integer holds ([ R4 , R5 ] in it iff R4 , R5 are_congruent_mod C77)));
existence
proof
defpred S2[ (Element of ( INT )) , (Element of ( INT )) ] means $1 , $2 are_congruent_mod C77;
consider C78 being (Relation of ( INT ) , ( INT )) such that L375: (for B45 being (Element of ( INT )) holds (for B46 being (Element of ( INT )) holds ([ B45 , B46 ] in C78 iff S2[ B45 , B46 ]))) from RELSET_1:sch 2;
take C78;
let R4 being Integer;
let R5 being Integer;
L376: (for B47 , B48 being Integer holds ([ B47 , B48 ] in C78 iff B47 , B48 are_congruent_mod C77))
proof
let C79 , C80 being Integer;
reconsider D42 = C79 , D43 = C80 as (Element of ( INT )) by INT_1:def 2;
L377: ([ D42 , D43 ] in C78 iff S2[ D42 , D43 ]) by L375;
thus L378: thesis by L377;
end;
thus L379: thesis by L376;
end;
uniqueness
proof
let C81 , C82 being (Relation of ( INT ));
assume that
L380: (for R4 being Integer holds (for R5 being Integer holds ([ R4 , R5 ] in C81 iff R4 , R5 are_congruent_mod C77)))
and
L381: (for R4 being Integer holds (for R5 being Integer holds ([ R4 , R5 ] in C82 iff R4 , R5 are_congruent_mod C77)));
L382: (for R4 being Integer holds (for R5 being Integer holds ([ R4 , R5 ] in C81 iff [ R4 , R5 ] in C82)))
proof
let R4 being Integer;
let R5 being Integer;
L383: ([ R4 , R5 ] in C81 iff R4 , R5 are_congruent_mod C77) by L380;
thus L384: thesis by L383 , L381;
end;
thus L385: C81 c= C82
proof
let C83 being set;
assume L386: C83 in C81;
consider C84 , C85 being set such that L387: C83 = [ C84 , C85 ] and L388: (C84 in ( INT ) & C85 in ( INT )) by L386 , RELSET_1:2;
reconsider D44 = C84 , D45 = C85 as Integer by L388;
L389: [ D44 , D45 ] in C82 by L382 , L386 , L387;
thus L390: thesis by L389 , L387;
end;

let C86 being set;
assume L391: C86 in C82;
consider C87 , C88 being set such that L392: C86 = [ C87 , C88 ] and L393: (C87 in ( INT ) & C88 in ( INT )) by L391 , RELSET_1:2;
reconsider D46 = C87 , D47 = C88 as Integer by L393;
L394: [ D46 , D47 ] in C81 by L382 , L391 , L392;
thus L395: thesis by L394 , L392;
end;
end;
registration
let C89 being Integer;
cluster ( Cong C89 ) ->  total;
coherence
proof
thus L397: ( dom ( Cong C89 ) ) c= ( INT );
thus L398: ( INT ) c= ( dom ( Cong C89 ) )
proof
let C90 being set;
assume L399: C90 in ( INT );
reconsider D48 = C90 as Integer by L399;
L400: D48 , D48 are_congruent_mod C89 by INT_1:11;
L401: [ D48 , D48 ] in ( Cong C89 ) by L400 , L374;
thus L402: thesis by L401 , XTUPLE_0:def 12;
end;

end;
end;
L400: (for R3 being Integer holds ( Cong R3 ) is (Equivalence_Relation of ( INT )))
proof
let R3 being Integer;
L401: ( Cong R3 ) is_symmetric_in ( INT )
proof
let C91 , C92 being set;
assume that
L402: C91 in ( INT )
and
L403: C92 in ( INT )
and
L404: [ C91 , C92 ] in ( Cong R3 );
reconsider D49 = C92 as Integer by L403;
reconsider D50 = C91 as Integer by L402;
L405: D50 , D49 are_congruent_mod R3 by L404 , L374;
L406: D49 , D50 are_congruent_mod R3 by L405 , INT_1:14;
thus L407: thesis by L406 , L374;
end;
L408: ( Cong R3 ) is_transitive_in ( INT )
proof
let C93 , C94 , C95 being set;
assume that
L409: (C93 in ( INT ) & C94 in ( INT ) & C95 in ( INT ))
and
L410: ([ C93 , C94 ] in ( Cong R3 ) & [ C94 , C95 ] in ( Cong R3 ));
reconsider D51 = C93 , D52 = C94 , D53 = C95 as Integer by L409;
L411: (D51 , D52 are_congruent_mod R3 & D52 , D53 are_congruent_mod R3) by L410 , L374;
L412: D51 , D53 are_congruent_mod R3 by L411 , INT_1:15;
thus L413: thesis by L412 , L374;
end;
L414: ( field ( Cong R3 ) ) = ( INT ) by ORDERS_1:12;
thus L415: thesis by L414 , L401 , L408 , RELAT_2:def 11 , RELAT_2:def 16;
end;
registration
let C96 being Integer;
cluster ( Cong C96 ) ->  reflexive  symmetric  transitive;
coherence by L400;
end;
theorem
L417: (for R1 being Integer holds (for R2 being Integer holds (for R3 being Integer holds (for R4 being Integer holds ((R3 <> ( 0 ) & ( ( ( R1 * R4 ) - R2 ) mod R3 ) = ( 0 )) implies (for B49 being Integer holds (((R1 , R3 are_relative_prime  & ( ( ( R1 * B49 ) - R2 ) mod R3 ) = ( 0 )) implies B49 in ( Class (( Cong R3 ) , R4) )) & (B49 in ( Class (( Cong R3 ) , R4) ) implies ( ( ( R1 * B49 ) - R2 ) mod R3 ) = ( 0 )))))))))
proof
let R1 being Integer;
let R2 being Integer;
let R3 being Integer;
let R4 being Integer;
assume that
L418: R3 <> ( 0 )
and
L419: ( ( ( R1 * R4 ) - R2 ) mod R3 ) = ( 0 );
let C97 being Integer;
thus L420:now
assume that
L421: R1 , R3 are_relative_prime 
and
L422: ( ( ( R1 * C97 ) - R2 ) mod R3 ) = ( 0 );
L423: ( ( R1 * R4 ) - R2 ) , ( ( R1 * C97 ) - R2 ) are_congruent_mod R3 by L418 , L419 , L422 , NAT_D:64;
L424: ( ( ( R1 * R4 ) - R2 ) + R2 ) , ( R1 * C97 ) are_congruent_mod R3 by L423 , INT_1:19;
L425: R4 , C97 are_congruent_mod R3 by L424 , L421 , L151;
L426: [ R4 , C97 ] in ( Cong R3 ) by L425 , L374;
thus L427: C97 in ( Class (( Cong R3 ) , R4) ) by L426 , EQREL_1:18;
end;
assume L428: C97 in ( Class (( Cong R3 ) , R4) );
L429: [ R4 , C97 ] in ( Cong R3 ) by L428 , EQREL_1:18;
L430: R4 , C97 are_congruent_mod R3 by L429 , L374;
L431: ( R4 * R1 ) , ( C97 * R1 ) are_congruent_mod R3 by L430 , L163;
L432: ( ( ( R1 * R4 ) - R2 ) mod R3 ) = ( ( 0 ) mod R3 ) by L419 , L169;
L433: ( 0 ) , ( ( R1 * R4 ) - R2 ) are_congruent_mod R3 by L432 , L418 , NAT_D:64;
L434: ( ( 0 ) + R2 ) , ( R1 * R4 ) are_congruent_mod R3 by L433 , INT_1:19;
L435: ( ( 0 ) + R2 ) , ( R1 * C97 ) are_congruent_mod R3 by L434 , L431 , INT_1:15;
L436: ( 0 ) , ( ( R1 * C97 ) - R2 ) are_congruent_mod R3 by L435 , INT_1:19;
L437: ( ( ( R1 * C97 ) - R2 ) mod R3 ) = ( ( 0 ) mod R3 ) by L436 , NAT_D:64;
thus L438: thesis by L437 , L169;
end;
theorem
L439: (for B50 , B51 , B52 , B53 being Integer holds ((B52 <> ( 0 ) & B50 , B52 are_relative_prime  & ( ( ( B50 * B53 ) - B51 ) mod B52 ) = ( 0 )) implies (ex B54 being Integer st [ B53 , ( B51 * B54 ) ] in ( Cong B52 ))))
proof
let R1 being Integer;
let R2 being Integer;
let R3 being Integer;
let R4 being Integer;
assume that
L440: R3 <> ( 0 )
and
L441: R1 , R3 are_relative_prime 
and
L442: ( ( ( R1 * R4 ) - R2 ) mod R3 ) = ( 0 );
L443: ( R1 gcd R3 ) = 1 by L441 , INT_2:def 3;
consider C98 , C99 being Integer such that L444: 1 = ( ( C98 * R1 ) + ( C99 * R3 ) ) by L443 , NAT_D:68;
L445: ( ( ( R1 * R4 ) - R2 ) mod R3 ) = ( ( 0 ) mod R3 ) by L442 , L169;
L446: ( ( R1 * R4 ) - R2 ) , ( 0 ) are_congruent_mod R3 by L445 , L440 , NAT_D:64;
L447: ( ( ( R1 * R4 ) - R2 ) * C98 ) , ( ( 0 ) * C98 ) are_congruent_mod R3 by L446 , L163;
L448: ( ( R4 * ( R1 * C98 ) ) - ( R2 * C98 ) ) , ( 0 ) are_congruent_mod R3 by L447;
L449: ( ( R4 * ( 1 - ( C99 * R3 ) ) ) - ( R2 * C98 ) ) , ( 0 ) are_congruent_mod R3 by L448 , L444;
take D54 = C98;
L450: ( ( ( R4 - ( ( R4 * C99 ) * R3 ) ) - ( R2 * C98 ) ) mod R3 ) = ( ( ( R4 - ( R2 * C98 ) ) + ( ( ( - R4 ) * C99 ) * R3 ) ) mod R3 )
.= ( ( R4 - ( R2 * C98 ) ) mod R3 ) by NAT_D:61;
L451: ( ( R4 - ( R2 * C98 ) ) mod R3 ) = ( ( 0 ) mod R3 ) by L450 , L449 , NAT_D:64;
L452: ( 0 ) , ( R4 - ( R2 * C98 ) ) are_congruent_mod R3 by L451 , L440 , NAT_D:64;
L453: ( ( 0 ) + ( R2 * C98 ) ) , R4 are_congruent_mod R3 by L452 , INT_1:19;
L454: R4 , ( R2 * D54 ) are_congruent_mod R3 by L453 , INT_1:14;
thus L455: thesis by L454 , L374;
end;
theorem
L456: (for B55 , B56 being (Element of ( NAT )) holds ((B55 <> ( 0 ) & B56 > 1 & B55 , B56 are_relative_prime ) implies (for B57 , B58 being Integer holds (( ( ( B55 * B58 ) - B57 ) mod B56 ) = ( 0 ) implies [ B58 , ( B57 * ( B55 |^ ( ( Euler B56 ) -' 1 ) ) ) ] in ( Cong B56 )))))
proof
let C100 , C101 being (Element of ( NAT ));
assume that
L457: C100 <> ( 0 )
and
L458: C101 > 1
and
L459: C100 , C101 are_relative_prime ;
let C102 , C103 being Integer;
L460: ( ( C100 |^ ( Euler C101 ) ) mod C101 ) = 1 by L457 , L458 , L459 , EULER_2:18;
L461: ( C100 |^ ( Euler C101 ) ) = ( ( C101 * ( ( C100 |^ ( Euler C101 ) ) div C101 ) ) + 1 ) by L460 , L458 , NAT_D:2;
L462: C101 divides ( ( C100 |^ ( Euler C101 ) ) - 1 ) by L461 , INT_1:def 3;
L463: ( C100 |^ ( Euler C101 ) ) , 1 are_congruent_mod C101 by L462 , INT_2:15;
L464: ( ( C100 |^ ( Euler C101 ) ) * C103 ) , ( 1 * C103 ) are_congruent_mod C101 by L463 , L163;
L465: ( Euler C101 ) <> ( 0 )
proof
set D55 = { B59 where B59 is (Element of ( NAT )) : (C101 , B59 are_relative_prime  & B59 >= 1 & B59 <= C101) };
L466: ( 1 gcd C101 ) = 1 by NEWTON:51;
L467: C101 , 1 are_relative_prime  by L466 , INT_2:def 3;
L468: 1 in D55 by L467 , L458;
assume L469: ( Euler C101 ) = ( 0 );
thus L470: contradiction by L469 , L468;
end;
L471: ( ( ( Euler C101 ) -' 1 ) + 1 ) = ( ( ( Euler C101 ) - 1 ) + 1 ) by L465 , NAT_1:14 , XREAL_1:233
.= ( Euler C101 );
assume L472: ( ( ( C100 * C103 ) - C102 ) mod C101 ) = ( 0 );
L473: C101 divides ( ( ( C100 * C103 ) - C102 ) - ( 0 ) ) by L472 , L458 , INT_1:62;
L474: ( ( C100 * C103 ) - C102 ) , ( 0 ) are_congruent_mod C101 by L473 , INT_2:15;
L475: ( 0 ) , ( ( C100 * C103 ) - C102 ) are_congruent_mod C101 by L474 , INT_1:14;
L476: ( ( C100 |^ ( ( Euler C101 ) -' 1 ) ) * (( 0 ) qua Nat) ) , ( ( C100 |^ ( ( Euler C101 ) -' 1 ) ) * ( ( C100 * C103 ) - C102 ) ) are_congruent_mod C101 by L475 , L163;
L477: ( 0 ) , ( ( ( ( C100 |^ ( ( Euler C101 ) -' 1 ) ) * C100 ) * C103 ) - ( ( C100 |^ ( ( Euler C101 ) -' 1 ) ) * C102 ) ) are_congruent_mod C101 by L476;
L478: ( 0 ) , ( ( ( C100 |^ ( ( ( Euler C101 ) -' 1 ) + 1 ) ) * C103 ) - ( ( C100 |^ ( ( Euler C101 ) -' 1 ) ) * C102 ) ) are_congruent_mod C101 by L477 , NEWTON:6;
L479: ( ( 0 ) + ( ( C100 |^ ( ( Euler C101 ) -' 1 ) ) * C102 ) ) , ( ( C100 |^ ( Euler C101 ) ) * C103 ) are_congruent_mod C101 by L478 , L471 , INT_1:19;
L480: ( ( C100 |^ ( ( Euler C101 ) -' 1 ) ) * C102 ) , C103 are_congruent_mod C101 by L479 , L464 , INT_1:15;
L481: C103 , ( C102 * ( C100 |^ ( ( Euler C101 ) -' 1 ) ) ) are_congruent_mod C101 by L480 , INT_1:14;
thus L482: thesis by L481 , L374;
end;
theorem
L483: (for R1 being Integer holds (for R2 being Integer holds (for R3 being Integer holds ((R3 <> ( 0 ) & ( R1 gcd R3 ) divides R2) implies (ex B60 being (FinSequence of ( INT )) st (( len B60 ) = ( R1 gcd R3 ) & (for R14 being (Element of ( NAT )) holds (R14 in ( dom B60 ) implies ( ( ( R1 * ( B60 . R14 ) ) - R2 ) mod R3 ) = ( 0 ))) & (for R15 being (Element of ( NAT )) holds (for R16 being (Element of ( NAT )) holds ((R15 in ( dom B60 ) & R16 in ( dom B60 ) & R15 <> R16) implies (not ( B60 . R15 ) , ( B60 . R16 ) are_congruent_mod R3))))))))))
proof
let R1 being Integer;
let R2 being Integer;
let R3 being Integer;
assume that
L484: R3 <> ( 0 )
and
L485: ( R1 gcd R3 ) divides R2;
set D56 = ( R1 gcd R3 );
reconsider D57 = D56 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C104 , C105 being Integer such that L486: R1 = ( D57 * C104 ) and L487: R3 = ( D57 * C105 ) and L488: C104 , C105 are_relative_prime  by L484 , INT_2:23;
consider C106 being Integer such that L489: R2 = ( D57 * C106 ) by L485 , INT_1:def 3;
consider C107 being Integer such that L490: ( ( ( C104 * C107 ) - C106 ) mod C105 ) = ( 0 ) by L488 , L229;
deffunc H3(Nat) = ( C107 + ( ( $1 - 1 ) * C105 ) );
consider C108 being FinSequence such that L491: (( len C108 ) = D57 & (for B61 being Nat holds (B61 in ( dom C108 ) implies ( C108 . B61 ) = H3(B61)))) from FINSEQ_1:sch 2;
L492: (for B62 being Nat holds (B62 in ( dom C108 ) implies ( C108 . B62 ) in ( INT )))
proof
let C109 being Nat;
assume L493: C109 in ( dom C108 );
L494: ( C108 . C109 ) = ( C107 + ( ( C109 - 1 ) * C105 ) ) by L493 , L491;
thus L495: thesis by L494 , INT_1:def 2;
end;
reconsider D58 = C108 as (FinSequence of ( INT )) by L492 , FINSEQ_2:12;
L496: C105 <> ( 0 ) by L484 , L487;
L497: (for R15 being (Element of ( NAT )) holds (for R16 being (Element of ( NAT )) holds ((R15 in ( dom D58 ) & R16 in ( dom D58 ) & R15 <> R16) implies (not ( D58 . R15 ) , ( D58 . R16 ) are_congruent_mod R3))))
proof
let R15 being (Element of ( NAT ));
let R16 being (Element of ( NAT ));
assume that
L498: R15 in ( dom D58 )
and
L499: R16 in ( dom D58 )
and
L500: R15 <> R16;
assume L501: ( D58 . R15 ) , ( D58 . R16 ) are_congruent_mod R3;
L502: (( D58 . R15 ) = ( C107 + ( ( R15 - 1 ) * C105 ) ) & ( D58 . R16 ) = ( C107 + ( ( R16 - 1 ) * C105 ) )) by L491 , L498 , L499;
L503: R3 divides ( ( ( ( R15 - 1 ) * C105 ) + C107 ) - ( ( ( R16 - 1 ) * C105 ) + C107 ) ) by L502 , L501 , INT_2:15;
consider C110 being Integer such that L504: ( ( R15 - R16 ) * C105 ) = ( ( D57 * C105 ) * C110 ) by L503 , L487 , INT_1:def 3;
L505: ( ( R15 - R16 ) * C105 ) = ( ( D57 * C110 ) * C105 ) by L504;
L506: ( R15 - R16 ) = ( D57 * C110 ) by L505 , L496 , XCMPLX_1:5;
L507: D57 divides ( R15 - R16 ) by L506 , INT_1:def 3;
L508: R16 in ( Seg D57 ) by L491 , L499 , FINSEQ_1:def 3;
L509: R16 >= 1 by L508 , FINSEQ_1:1;
L510: R15 in ( Seg D57 ) by L491 , L498 , FINSEQ_1:def 3;
L511: R15 <= D57 by L510 , FINSEQ_1:1;
L512: ( R15 - R16 ) <= ( D57 - 1 ) by L511 , L509 , XREAL_1:13;
L513: ( R15 - R16 ) < D57 by L512 , XREAL_1:147;
L514: R16 <= D57 by L508 , FINSEQ_1:1;
L515: R15 >= 1 by L510 , FINSEQ_1:1;
L516: ( R15 - R16 ) >= ( 1 - D57 ) by L515 , L514 , XREAL_1:13;
L517: ( R15 - R16 ) > ( - D57 ) by L516 , XREAL_1:145;
L518: ( abs ( R15 - R16 ) ) < D57 by L517 , L513 , SEQ_2:1;
L519: ( R15 - R16 ) <> ( 0 ) by L500;
L520: ( abs D57 ) <= ( abs ( R15 - R16 ) ) by L519 , L507 , L125;
thus L521: contradiction by L520 , L518 , ABSVALUE:def 1;
end;
take D58;
L522: ( ( ( C104 * C107 ) - C106 ) mod C105 ) = ( ( 0 ) mod C105 ) by L490 , L169;
L523: ( ( C104 * C107 ) - C106 ) , ( 0 ) are_congruent_mod C105 by L522 , L496 , NAT_D:64;
L524: ( ( ( C104 * C107 ) - C106 ) * D57 ) , ( ( 0 ) * D57 ) are_congruent_mod ( C105 * D57 ) by L523 , L158;
L525: ( ( ( R1 * C107 ) - R2 ) mod R3 ) = ( ( 0 ) mod R3 ) by L524 , L486 , L487 , L489 , NAT_D:64;
L526: (for R14 being (Element of ( NAT )) holds (R14 in ( dom D58 ) implies ( ( ( R1 * ( D58 . R14 ) ) - R2 ) mod R3 ) = ( 0 )))
proof
let R14 being (Element of ( NAT ));
assume L527: R14 in ( dom D58 );
thus L528: ( ( ( R1 * ( D58 . R14 ) ) - R2 ) mod R3 ) = ( ( ( R1 * ( C107 + ( ( R14 - 1 ) * C105 ) ) ) - R2 ) mod R3 ) by L527 , L491
.= ( ( ( ( R1 * C107 ) - R2 ) + ( ( C104 * ( R14 - 1 ) ) * R3 ) ) mod R3 ) by L486 , L487
.= ( ( ( R1 * C107 ) - R2 ) mod R3 ) by NAT_D:61
.= ( 0 ) by L525 , L169;
end;
thus L529: thesis by L526 , L491 , L497;
end;
begin
theorem
L530: (for R18 being (FinSequence of ( NAT )) holds (for R22 being (Element of ( NAT )) holds (for R20 being (Element of ( NAT )) holds (for R23 being (Element of ( NAT )) holds ((R20 in ( dom R18 ) & ( len R18 ) = ( R23 + 1 )) implies ( Del (( R18 ^ <* R22 *> ) , R20) ) = ( ( Del (R18 , R20) ) ^ <* R22 *> ))))))
proof
let R18 being (FinSequence of ( NAT ));
let R22 being (Element of ( NAT ));
let R20 being (Element of ( NAT ));
let R23 being (Element of ( NAT ));
assume that
L531: R20 in ( dom R18 )
and
L532: ( len R18 ) = ( R23 + 1 );
L533: ( len ( Del (R18 , R20) ) ) = R23 by L531 , L532 , FINSEQ_3:109;
L534: ( len ( ( Del (R18 , R20) ) ^ <* R22 *> ) ) = ( R23 + 1 ) by L533 , FINSEQ_2:16;
L535: (( len ( R18 ^ <* R22 *> ) ) = ( ( R23 + 1 ) + 1 ) & R20 in ( dom ( R18 ^ <* R22 *> ) )) by L531 , L532 , FINSEQ_2:16 , FINSEQ_3:22;
L536: ( len ( Del (( R18 ^ <* R22 *> ) , R20) ) ) = ( len ( ( Del (R18 , R20) ) ^ <* R22 *> ) ) by L535 , L534 , FINSEQ_3:109;
L537: (for B63 being Nat holds ((1 <= B63 & B63 <= ( len ( Del (( R18 ^ <* R22 *> ) , R20) ) )) implies ( ( Del (( R18 ^ <* R22 *> ) , R20) ) . B63 ) = ( ( ( Del (R18 , R20) ) ^ <* R22 *> ) . B63 )))
proof
let C111 being Nat;
assume that
L538: 1 <= C111
and
L539: C111 <= ( len ( Del (( R18 ^ <* R22 *> ) , R20) ) );
L540: C111 in ( dom R18 ) by L532 , L534 , L536 , L538 , L539 , FINSEQ_3:25;
per cases ;
suppose L541: C111 < R20;

L542: R20 <= ( R23 + 1 ) by L531 , L532 , FINSEQ_3:25;
L543: C111 < ( R23 + 1 ) by L542 , L541 , XXREAL_0:2;
L544: C111 <= R23 by L543 , NAT_1:13;
L545: C111 in ( dom ( Del (R18 , R20) ) ) by L544 , L533 , L538 , FINSEQ_3:25;
L546: ( ( ( Del (R18 , R20) ) ^ <* R22 *> ) . C111 ) = ( ( Del (R18 , R20) ) . C111 ) by L545 , FINSEQ_1:def 7
.= ( R18 . C111 ) by L541 , FINSEQ_3:110;
set D59 = ( R18 ^ <* R22 *> );
L547: ( ( Del (D59 , R20) ) . C111 ) = ( D59 . C111 ) by L541 , FINSEQ_3:110
.= ( R18 . C111 ) by L540 , FINSEQ_1:def 7;
thus L548: thesis by L547 , L546;
end;
suppose L549: R20 <= C111;

L550: ( ( Del (( R18 ^ <* R22 *> ) , R20) ) . C111 ) = ( ( R18 ^ <* R22 *> ) . ( C111 + 1 ) ) by L549 , L534 , L535 , L536 , L539 , FINSEQ_3:111;
per cases  by L534 , L536 , L539 , NAT_1:8;
suppose L551: C111 <= R23;

L552: C111 in ( dom ( Del (R18 , R20) ) ) by L551 , L533 , L538 , FINSEQ_3:25;
L553: ( ( ( Del (R18 , R20) ) ^ <* R22 *> ) . C111 ) = ( ( Del (R18 , R20) ) . C111 ) by L552 , FINSEQ_1:def 7
.= ( R18 . ( C111 + 1 ) ) by L531 , L532 , L549 , L551 , FINSEQ_3:111;
L554: ( C111 + 1 ) >= 1 by NAT_1:11;
L555: ( C111 + 1 ) <= ( R23 + 1 ) by L551 , XREAL_1:6;
L556: ( C111 + 1 ) in ( dom R18 ) by L555 , L532 , L554 , FINSEQ_3:25;
thus L557: thesis by L556 , L550 , L553 , FINSEQ_1:def 7;
end;
suppose L558: C111 = ( R23 + 1 );

L559: ( ( Del (( R18 ^ <* R22 *> ) , R20) ) . C111 ) = R22 by L558 , L532 , L550 , FINSEQ_1:42;
thus L560: thesis by L559 , L533 , L558 , FINSEQ_1:42;
end;
end;
end;
thus L563: thesis by L537 , L534 , L535 , FINSEQ_1:14 , FINSEQ_3:109;
end;
theorem
L564: (for R18 being (FinSequence of ( NAT )) holds ((( len R18 ) >= 2 & (for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom R18 ) & R21 in ( dom R18 ) & R20 <> R21) implies ( ( R18 . R20 ) gcd ( R18 . R21 ) ) = 1)))) implies (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( ( Product ( Del (R18 , R20) ) ) gcd ( R18 . R20 ) ) = 1))))
proof
let R18 being (FinSequence of ( NAT ));
defpred S3[ (FinSequence of ( NAT )) ] means (for R20 being (Element of ( NAT )) holds (R20 in ( dom $1 ) implies ( ( Product ( Del ($1 , R20) ) ) gcd ( $1 . R20 ) ) = 1));
defpred S4[ (FinSequence of ( NAT )) ] means (for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom $1 ) & R21 in ( dom $1 ) & R20 <> R21) implies ( ( $1 . R20 ) gcd ( $1 . R21 ) ) = 1)));
defpred S5[ set ] means (ex B64 being (FinSequence of ( NAT )) st (B64 = $1 & ((( len B64 ) >= 2 & S4[ B64 ]) implies S3[ B64 ])));
L565:
now
let R18 being (FinSequence of ( NAT ));
let R22 being (Element of ( NAT ));
assume that
L566: S5[ R18 ];
set D60 = ( len R18 );
set D61 = ( R18 ^ <* R22 *> );
L567:
now
assume that
L568: ( len D61 ) >= 2
and
L569: S4[ D61 ];
L570: ( len D61 ) = ( D60 + 1 ) by FINSEQ_2:16;
L571:
now
per cases  by L568 , XXREAL_0:1;
suppose L572: ( len D61 ) = 2;

L573: (1 in ( dom D61 ) & 2 in ( dom D61 )) by L572 , FINSEQ_3:25;
L574: ( ( D61 . 2 ) gcd ( D61 . 1 ) ) = 1 by L573 , L569;
L575: D61 = <* ( D61 . 1 ) , ( D61 . 2 ) *> by L572 , FINSEQ_1:44;
L576: (for R20 being (Element of ( NAT )) holds (R20 in ( dom D61 ) implies ( ( Product ( Del (D61 , R20) ) ) gcd ( D61 . R20 ) ) = 1))
proof
let R20 being (Element of ( NAT ));
assume L577: R20 in ( dom D61 );
L578: R20 in ( Seg ( len D61 ) ) by L577 , FINSEQ_1:def 3;
per cases  by L572 , L578 , FINSEQ_1:2 , TARSKI:def 2;
suppose L579: R20 = 1;

thus L580: ( ( Product ( Del (D61 , R20) ) ) gcd ( D61 . R20 ) ) = ( ( Product <* ( D61 . 2 ) *> ) gcd ( D61 . 1 ) ) by L579 , L575 , WSIERP_1:19
.= 1 by L574 , RVSUM_1:95;
end;
suppose L581: R20 = 2;

thus L582: ( ( Product ( Del (D61 , R20) ) ) gcd ( D61 . R20 ) ) = ( ( Product <* ( D61 . 1 ) *> ) gcd ( D61 . 2 ) ) by L581 , L575 , WSIERP_1:19
.= 1 by L574 , RVSUM_1:95;
end;
end;
thus L584: S3[ D61 ] by L576;
end;
suppose L585: ( len D61 ) > 2;

L586: ( D60 + 1 ) > ( 1 + 1 ) by L585 , FINSEQ_2:16;
L587: D60 >= ( 1 + 1 ) by L586 , NAT_1:13;
consider C112 being Nat such that L588: D60 = ( C112 + 1 ) by L587 , NAT_1:6;
L589: S4[ R18 ]
proof
L590: ( dom R18 ) c= ( dom D61 ) by FINSEQ_1:26;
let R20 being (Element of ( NAT ));
let R21 being (Element of ( NAT ));
assume that
L591: (R20 in ( dom R18 ) & R21 in ( dom R18 ))
and
L592: R20 <> R21;
L593: (( D61 . R20 ) = ( R18 . R20 ) & ( D61 . R21 ) = ( R18 . R21 )) by L591 , FINSEQ_1:def 7;
thus L594: thesis by L593 , L569 , L591 , L592 , L590;
end;
L595: (for R24 being Nat holds (R24 in ( dom R18 ) implies ( ( R18 . R24 ) gcd R22 ) = 1))
proof
let R24 being Nat;
L596: ( ( len R18 ) + 1 ) in ( dom D61 ) by L570 , FINSEQ_5:6;
L597: (( dom R18 ) c= ( dom D61 ) & ( D61 . ( ( len R18 ) + 1 ) ) = R22) by FINSEQ_1:26 , FINSEQ_1:42;
assume L598: R24 in ( dom R18 );
L599: ( ( len R18 ) + 1 ) > ( len R18 ) by NAT_1:13;
L600: ( ( len R18 ) + 1 ) <> R24 by L599 , L598 , FINSEQ_3:25;
L601: ( D61 . R24 ) = ( R18 . R24 ) by L598 , FINSEQ_1:def 7;
thus L602: thesis by L601 , L569 , L598 , L597 , L600 , L596;
end;
reconsider D62 = C112 as (Element of ( NAT )) by ORDINAL1:def 12;
L603: D60 = ( D62 + 1 ) by L588;
L604: (for R20 being (Element of ( NAT )) holds (R20 in ( dom D61 ) implies ( ( Product ( Del (D61 , R20) ) ) gcd ( D61 . R20 ) ) = 1))
proof
let R20 being (Element of ( NAT ));
assume that
L605: R20 in ( dom D61 );
L606: R20 >= 1 by L605 , FINSEQ_3:25;
L607: R20 <= ( D60 + 1 ) by L570 , L605 , FINSEQ_3:25;
per cases  by L607 , NAT_1:8;
suppose L608: R20 <= D60;

L609: R20 in ( dom R18 ) by L608 , L606 , FINSEQ_3:25;
L610: (( ( Product ( Del (R18 , R20) ) ) gcd ( R18 . R20 ) ) = 1 & ( ( R18 . R20 ) gcd R22 ) = 1) by L609 , L566 , L586 , L589 , L595 , NAT_1:13;
L611: ( ( ( Product ( Del (R18 , R20) ) ) * R22 ) gcd ( R18 . R20 ) ) = 1 by L610 , WSIERP_1:7;
L612: ( ( Product ( ( Del (R18 , R20) ) ^ <* R22 *> ) ) gcd ( R18 . R20 ) ) = 1 by L611 , RVSUM_1:96;
L613: ( Del (D61 , R20) ) = ( ( Del (R18 , R20) ) ^ <* R22 *> ) by L603 , L609 , L530;
thus L614: thesis by L613 , L609 , L612 , FINSEQ_1:def 7;
end;
suppose L615: R20 = ( D60 + 1 );

thus L616: ( ( Product ( Del (D61 , R20) ) ) gcd ( D61 . R20 ) ) = ( ( Product ( Del (D61 , ( D60 + 1 )) ) ) gcd R22 ) by L615 , FINSEQ_1:42
.= ( ( Product R18 ) gcd R22 ) by WSIERP_1:40
.= 1 by L595 , WSIERP_1:36;
end;
end;
thus L618: S3[ D61 ] by L604;
end;
end;
thus L620: S3[ D61 ] by L571;
end;
thus L621: S5[ D61 ] by L567;
end;
L622: S5[ ( <*> ( NAT ) ) ]
proof
take ( <*> ( NAT ) );
thus L623: thesis;
end;
L624: (for R18 being (FinSequence of ( NAT )) holds S5[ R18 ]) from FINSEQ_2:sch 2(L622 , L565);
L625: (ex B65 being (FinSequence of ( NAT )) st (B65 = R18 & ((( len B65 ) >= 2 & S4[ B65 ]) implies S3[ B65 ]))) by L624;
thus L626: thesis by L625;
end;
theorem
L627: (for R18 being (FinSequence of ( NAT )) holds (for R24 being Nat holds (R24 in ( dom R18 ) implies ( R18 . R24 ) divides ( Product R18 ))))
proof
let R18 being (FinSequence of ( NAT ));
let R24 being Nat;
assume L628: R24 in ( dom R18 );
L629: ( R18 . R24 ) in ( rng R18 ) by L628 , FUNCT_1:3;
thus L630: thesis by L629 , NAT_3:7;
end;
theorem
L631: (for R11 being Nat holds (for R18 being (FinSequence of ( NAT )) holds (for R24 being Nat holds ((R24 in ( dom R18 ) & R11 divides ( R18 . R24 )) implies R11 divides ( Product R18 )))))
proof
let R11 being Nat;
let R18 being (FinSequence of ( NAT ));
let R24 being Nat;
assume that
L632: R24 in ( dom R18 )
and
L633: R11 divides ( R18 . R24 );
L634: ( R18 . R24 ) divides ( Product R18 ) by L632 , L627;
thus L635: thesis by L634 , L633 , NAT_D:4;
end;
theorem
L636: (for R18 being (FinSequence of ( NAT )) holds (for R23 being (Element of ( NAT )) holds (for R24 being Nat holds ((( len R18 ) = ( R23 + 1 ) & R24 >= 1 & R24 <= R23) implies ( ( Del (R18 , R24) ) . R23 ) = ( R18 . ( len R18 ) )))))
proof
let R18 being (FinSequence of ( NAT ));
let R23 being (Element of ( NAT ));
let R24 being Nat;
assume that
L637: ( len R18 ) = ( R23 + 1 )
and
L638: R24 >= 1
and
L639: R24 <= R23;
L640: R23 < ( R23 + 1 ) by XREAL_1:29;
L641: R24 < ( R23 + 1 ) by L640 , L639 , XXREAL_0:2;
L642: R24 in ( dom R18 ) by L641 , L637 , L638 , FINSEQ_3:25;
thus L643: thesis by L642 , L637 , L639 , WSIERP_1:def 1;
end;
theorem
L644: (for R18 being (FinSequence of ( NAT )) holds (for R24 being Nat holds (for R20 being (Element of ( NAT )) holds ((R24 in ( dom R18 ) & R20 in ( dom R18 ) & R24 <> R20 & ( len R18 ) >= 1) implies ( R18 . R20 ) divides ( Product ( Del (R18 , R24) ) )))))
proof
let R18 being (FinSequence of ( NAT ));
let R24 being Nat;
let R20 being (Element of ( NAT ));
assume that
L645: R24 in ( dom R18 )
and
L646: R20 in ( dom R18 )
and
L647: R24 <> R20
and
L648: ( len R18 ) >= 1;
consider C113 being Nat such that L649: ( len R18 ) = ( C113 + 1 ) by L648 , NAT_1:6;
L650: R24 <= ( C113 + 1 ) by L645 , L649 , FINSEQ_3:25;
L651: R24 >= 1 by L645 , FINSEQ_3:25;
L652: R20 >= 1 by L646 , FINSEQ_3:25;
L653: ( ( len ( Del (R18 , R24) ) ) + 1 ) = ( C113 + 1 ) by L645 , L649 , WSIERP_1:def 1;
L654: R20 <= ( C113 + 1 ) by L646 , L649 , FINSEQ_3:25;
per cases  by L650 , NAT_1:8;
suppose L655: R24 <= C113;

per cases  by L647 , XXREAL_0:1;
suppose L656: R20 < R24;

L657: R20 <= C113 by L656 , L655 , XXREAL_0:2;
L658: R20 in ( dom ( Del (R18 , R24) ) ) by L657 , L652 , L653 , FINSEQ_3:25;
L659: ( ( Del (R18 , R24) ) . R20 ) = ( R18 . R20 ) by L645 , L656 , WSIERP_1:def 1;
thus L660: thesis by L659 , L658 , L627;
end;
suppose L661: R24 < R20;

L662: R20 >= ( R24 + 1 ) by L661 , NAT_1:13;
L663: ( R20 - 1 ) >= R24 by L662 , XREAL_1:19;
L664: ( R20 -' 1 ) >= R24 by L663 , L652 , XREAL_1:233;
L665: ( ( Del (R18 , R24) ) . ( R20 -' 1 ) ) = ( R18 . ( ( R20 -' 1 ) + 1 ) ) by L664 , L645 , WSIERP_1:def 1;
L666: R20 > 1 by L651 , L661 , XXREAL_0:2;
L667: ( R20 - 1 ) > ( 0 ) by L666 , XREAL_1:50;
L668: ( R20 -' 1 ) > ( 0 ) by L667 , L652 , XREAL_1:233;
L669: ( R20 -' 1 ) >= 1 by L668 , L124;
L670: ( R20 - 1 ) <= ( ( C113 + 1 ) - 1 ) by L654 , XREAL_1:9;
L671: ( R20 -' 1 ) <= C113 by L670 , L652 , XREAL_1:233;
L672: ( R20 -' 1 ) in ( dom ( Del (R18 , R24) ) ) by L671 , L653 , L669 , FINSEQ_3:25;
L673: ( ( Del (R18 , R24) ) . ( R20 -' 1 ) ) divides ( Product ( Del (R18 , R24) ) ) by L672 , L627;
thus L674: thesis by L673 , L652 , L665 , XREAL_1:235;
end;
end;
suppose L676: R24 = ( C113 + 1 );

L677: R20 < ( C113 + 1 ) by L676 , L647 , L654 , XXREAL_0:1;
L678: R20 <= C113 by L677 , NAT_1:13;
L679: R20 in ( dom ( Del (R18 , R24) ) ) by L678 , L652 , L653 , FINSEQ_3:25;
L680: R20 < R24 by L647 , L654 , L676 , XXREAL_0:1;
L681: ( ( Del (R18 , R24) ) . R20 ) = ( R18 . R20 ) by L680 , L645 , WSIERP_1:def 1;
thus L682: thesis by L681 , L679 , L627;
end;
end;
L684: (for B66 , B67 being Integer holds (for B68 being Nat holds ((B68 > ( 0 ) & ( B66 mod B68 ) = ( 0 )) implies ( ( B66 * B67 ) mod B68 ) = ( 0 ))))
proof
let C114 , C115 being Integer;
let C116 being Nat;
assume that
L685: C116 > ( 0 )
and
L686: ( C114 mod C116 ) = ( 0 );
L687: C116 divides C114 by L685 , L686 , INT_1:62;
L688: C116 divides ( C114 * C115 ) by L687 , INT_2:2;
thus L689: thesis by L688 , L685 , INT_1:62;
end;
theorem
L690: (for R18 being (FinSequence of ( NAT )) holds (for R24 being Nat holds ((for B69 being Nat holds (B69 in ( dom R18 ) implies R24 divides ( R18 . B69 ))) implies R24 divides ( Sum R18 ))))
proof
let R18 being (FinSequence of ( NAT ));
let R24 being Nat;
defpred S6[ (FinSequence of ( NAT )) ] means (for B70 being Nat holds (B70 in ( dom $1 ) implies R24 divides ( $1 . B70 )));
defpred S7[ (FinSequence of ( NAT )) ] means R24 divides ( Sum $1 );
defpred S8[ set ] means (ex B71 being (FinSequence of ( NAT )) st (B71 = $1 & (S6[ B71 ] implies S7[ B71 ])));
L691:
now
let R18 being (FinSequence of ( NAT ));
let R22 being (Element of ( NAT ));
assume that
L692: S8[ R18 ];
set D63 = ( R18 ^ <* R22 *> );
L693:
now
assume L694: S6[ D63 ];
L695: S6[ R18 ]
proof
let C117 being Nat;
assume that
L696: C117 in ( dom R18 );
L697: (( dom R18 ) c= ( dom D63 ) & ( D63 . C117 ) = ( R18 . C117 )) by L696 , FINSEQ_1:26 , FINSEQ_1:def 7;
thus L698: thesis by L697 , L694 , L696;
end;
L699: ( len D63 ) in ( dom D63 ) by FINSEQ_5:6;
L700: R24 divides ( D63 . ( len D63 ) ) by L699 , L694;
L701: R24 divides ( D63 . ( ( len R18 ) + 1 ) ) by L700 , FINSEQ_2:16;
L702: R24 divides R22 by L701 , FINSEQ_1:42;
L703: R24 divides ( ( Sum R18 ) + R22 ) by L702 , L692 , L695 , NAT_D:8;
thus L704: S7[ D63 ] by L703 , RVSUM_1:74;
end;
thus L705: S8[ D63 ] by L693;
end;
L706: S8[ ( <*> ( NAT ) ) ] by NAT_D:6 , RVSUM_1:72;
L707: (for R18 being (FinSequence of ( NAT )) holds S8[ R18 ]) from FINSEQ_2:sch 2(L706 , L691);
L708: (ex B72 being (FinSequence of ( NAT )) st (B72 = R18 & (S6[ B72 ] implies S7[ B72 ]))) by L707;
thus L709: thesis by L708;
end;
theorem
L710: (for R18 being (FinSequence of ( NAT )) holds ((( len R18 ) >= 2 & (for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom R18 ) & R21 in ( dom R18 ) & R20 <> R21) implies ( ( R18 . R20 ) gcd ( R18 . R21 ) ) = 1))) & (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) <> ( 0 )))) implies (for R19 being (FinSequence of ( NAT )) holds (ex B73 being Integer st (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( ( B73 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 )))))))
proof
let R18 being (FinSequence of ( NAT ));
assume that
L711: ( len R18 ) >= 2
and
L712: (for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom R18 ) & R21 in ( dom R18 ) & R20 <> R21) implies ( ( R18 . R20 ) gcd ( R18 . R21 ) ) = 1)))
and
L713: (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) <> ( 0 )));
consider C118 being (FinSequence of ( NAT )), C119 being (Element of ( NAT )) such that L714: R18 = ( C118 ^ <* C119 *> ) by L711 , FINSEQ_2:19;
deffunc H4(Nat) = { B74 where B74 is (Element of ( NAT )) : ( ( ( ( Product ( Del (R18 , $1) ) ) * B74 ) - 1 ) mod ( R18 . $1 ) ) = ( 0 ) };
defpred S9[ Nat , Nat ] means $2 in H4($1);
L715: (for B75 being Nat holds (B75 in ( Seg ( len R18 ) ) implies (ex B76 being (Element of ( NAT )) st S9[ B75 , B76 ])))
proof
let C120 being Nat;
reconsider D64 = ( R18 . C120 ) as Integer;
assume L716: C120 in ( Seg ( len R18 ) );
L717: C120 in ( dom R18 ) by L716 , FINSEQ_1:def 3;
L718: ( ( Product ( Del (R18 , C120) ) ) gcd ( R18 . C120 ) ) = 1 by L717 , L711 , L712 , L564;
L719: ( Product ( Del (R18 , C120) ) ) , D64 are_relative_prime  by L718 , INT_2:def 3;
L720: D64 <> ( 0 ) by L713 , L717;
consider C121 being Nat such that L721: ( ( ( ( Product ( Del (R18 , C120) ) ) * C121 ) - 1 ) mod D64 ) = ( 0 ) by L720 , L719 , L235;
reconsider D65 = C121 as (Element of ( NAT )) by ORDINAL1:def 12;
take D65;
thus L722: thesis by L721;
end;
consider C122 being (FinSequence of ( NAT )) such that L723: (( dom C122 ) = ( Seg ( len R18 ) ) & (for B77 being Nat holds (B77 in ( Seg ( len R18 ) ) implies S9[ B77 , ( C122 . B77 ) ]))) from FINSEQ_1:sch 5(L715);
let R19 being (FinSequence of ( NAT ));
set D66 = ( len C118 );
deffunc H5(Nat) = ( ( ( Product ( Del (R18 , $1) ) ) * ( C122 . $1 ) ) * ( R19 . $1 ) );
consider C123 being FinSequence such that L724: (( len C123 ) = ( D66 + 1 ) & (for B78 being Nat holds (B78 in ( dom C123 ) implies ( C123 . B78 ) = H5(B78)))) from FINSEQ_1:sch 2;
L725: (for B79 being Nat holds (B79 in ( dom C123 ) implies ( C123 . B79 ) in ( NAT )))
proof
let C124 being Nat;
assume L726: C124 in ( dom C123 );
reconsider D67 = C124 as (Element of ( NAT )) by ORDINAL1:def 12;
L727: ( C123 . D67 ) = ( ( ( Product ( Del (R18 , D67) ) ) * ( C122 . D67 ) ) * ( R19 . D67 ) ) by L724 , L726;
thus L728: thesis by L727 , ORDINAL1:def 12;
end;
reconsider D68 = C123 as (FinSequence of ( NAT )) by L725 , FINSEQ_2:12;
set D69 = ( Sum D68 );
take D69;
L729: ( len R18 ) = ( D66 + 1 ) by L714 , FINSEQ_2:16;
L730: (for R24 being Nat holds (for R20 being (Element of ( NAT )) holds ((R24 in ( dom R18 ) & R20 in ( dom R18 ) & R24 <> R20) implies ( R18 . R20 ) divides ( D68 . R24 ))))
proof
let R24 being Nat;
let R20 being (Element of ( NAT ));
assume that
L731: R24 in ( dom R18 )
and
L732: (R20 in ( dom R18 ) & R24 <> R20);
L733: ( len R18 ) >= 1 by L711 , XXREAL_0:2;
L734: ( R18 . R20 ) divides ( ( Product ( Del (R18 , R24) ) ) * ( ( C122 . R24 ) * ( R19 . R24 ) ) ) by L733 , L731 , L732 , L644 , NAT_D:9;
L735: ( R18 . R20 ) divides ( ( ( Product ( Del (R18 , R24) ) ) * ( C122 . R24 ) ) * ( R19 . R24 ) ) by L734;
L736: R24 in ( dom D68 ) by L729 , L724 , L731 , FINSEQ_3:29;
thus L737: thesis by L736 , L724 , L735;
end;
L738: (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) divides ( Sum ( Del (D68 , R20) ) )))
proof
let R20 being (Element of ( NAT ));
assume L739: R20 in ( dom R18 );
L740: R20 in ( Seg ( len D68 ) ) by L739 , L729 , L724 , FINSEQ_1:def 3;
L741: R20 in ( dom D68 ) by L740 , FINSEQ_1:def 3;
L742: ( ( len ( Del (D68 , R20) ) ) + 1 ) = ( D66 + 1 ) by L741 , L724 , WSIERP_1:def 1;
L743: (for R24 being Nat holds (R24 in ( dom ( Del (D68 , R20) ) ) implies ( R18 . R20 ) divides ( ( Del (D68 , R20) ) . R24 )))
proof
let R24 being Nat;
assume L744: R24 in ( dom ( Del (D68 , R20) ) );
L745: (R24 >= 1 & R24 <= D66) by L744 , L742 , FINSEQ_3:25;
L746: ( dom ( Del (D68 , R20) ) ) c= ( dom D68 ) by WSIERP_1:39;
L747: R24 in ( dom D68 ) by L746 , L744;
L748: R24 in ( Seg ( D66 + 1 ) ) by L747 , L724 , FINSEQ_1:def 3;
L749: R24 in ( dom R18 ) by L748 , L729 , FINSEQ_1:def 3;
per cases ;
suppose L750: R24 < R20;

L751: ( ( Del (D68 , R20) ) . R24 ) = ( D68 . R24 ) by L750 , L741 , WSIERP_1:def 1;
thus L752: thesis by L751 , L730 , L739 , L749 , L750;
end;
suppose L753: R24 >= R20;

L754: (( R24 + 1 ) <= ( D66 + 1 ) & ( R24 + 1 ) > 1) by L745 , XREAL_1:6 , XREAL_1:29;
L755: ( R24 + 1 ) in ( dom R18 ) by L754 , L729 , FINSEQ_3:25;
L756: (( ( Del (D68 , R20) ) . R24 ) = ( D68 . ( R24 + 1 ) ) & ( R24 + 1 ) > R20) by L741 , L753 , WSIERP_1:def 1 , XREAL_1:39;
thus L757: thesis by L756 , L730 , L739 , L755;
end;
end;
thus L759: thesis by L743 , L690;
end;
L760: (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( ( D69 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 )))
proof
let R20 being (Element of ( NAT ));
assume L761: R20 in ( dom R18 );
L762: ( R18 . R20 ) <> ( 0 ) by L761 , L713;
L763: ( R18 . R20 ) divides ( Sum ( Del (D68 , R20) ) ) by L738 , L761;
L764: ( ( ( Sum ( Del (D68 , R20) ) ) + ( ( D68 . R20 ) - ( R19 . R20 ) ) ) mod ( R18 . R20 ) ) = ( ( ( D68 . R20 ) - ( R19 . R20 ) ) mod ( R18 . R20 ) )
proof
reconsider D70 = ( Sum ( Del (D68 , R20) ) ) as Integer;
L765: ( D70 mod ( R18 . R20 ) ) = ( 0 ) by L763 , L762 , INT_1:62;
L766: ( ( ( Sum ( Del (D68 , R20) ) ) + ( ( D68 . R20 ) - ( R19 . R20 ) ) ) mod ( R18 . R20 ) ) = ( ( ( D70 mod ( R18 . R20 ) ) + ( ( ( D68 . R20 ) - ( R19 . R20 ) ) mod ( R18 . R20 ) ) ) mod ( R18 . R20 ) ) by NAT_D:66
.= ( ( ( D68 . R20 ) - ( R19 . R20 ) ) mod ( R18 . R20 ) ) by L765 , NAT_D:65;
thus L767: thesis by L766;
end;
L768: (R20 >= 1 & R20 <= ( D66 + 1 )) by L729 , L761 , FINSEQ_3:25;
L769: R20 in ( Seg ( D66 + 1 ) ) by L768;
L770: R20 in ( dom D68 ) by L769 , L724 , FINSEQ_1:def 3;
L771: ( ( D68 . R20 ) - ( R19 . R20 ) ) = ( ( ( ( Product ( Del (R18 , R20) ) ) * ( C122 . R20 ) ) * ( R19 . R20 ) ) - ( 1 * ( R19 . R20 ) ) ) by L770 , L724
.= ( ( ( ( Product ( Del (R18 , R20) ) ) * ( C122 . R20 ) ) - 1 ) * ( R19 . R20 ) );
L772: ( C122 . R20 ) in H4(R20) by L729 , L723 , L769;
L773: (ex B80 being (Element of ( NAT )) st (B80 = ( C122 . R20 ) & ( ( ( ( Product ( Del (R18 , R20) ) ) * B80 ) - 1 ) mod ( R18 . R20 ) ) = ( 0 ))) by L772;
L774: R20 in ( dom D68 ) by L724 , L768 , FINSEQ_3:25;
L775: ( ( D69 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( ( ( ( Sum ( Del (D68 , R20) ) ) + ( D68 . R20 ) ) - ( R19 . R20 ) ) mod ( R18 . R20 ) ) by L774 , WSIERP_1:20
.= ( 0 ) by L762 , L771 , L773 , L764 , L684;
thus L776: thesis by L775;
end;
thus L777: thesis by L760;
end;
theorem
L778: (for R18 being (FinSequence of ( NAT )) holds (for R24 being Nat holds (((for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom R18 ) & R21 in ( dom R18 ) & R20 <> R21) implies ( ( R18 . R20 ) gcd ( R18 . R21 ) ) = 1))) & (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) divides R24))) implies ( Product R18 ) divides R24)))
proof
let R18 being (FinSequence of ( NAT ));
let R24 being Nat;
defpred S10[ (FinSequence of ( NAT )) ] means ((for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom $1 ) & R21 in ( dom $1 ) & R20 <> R21) implies ( ( $1 . R20 ) gcd ( $1 . R21 ) ) = 1))) & (for R20 being (Element of ( NAT )) holds (R20 in ( dom $1 ) implies ( $1 . R20 ) divides R24)));
defpred S11[ (FinSequence of ( NAT )) ] means ( Product $1 ) divides R24;
defpred S12[ set ] means (ex B81 being (FinSequence of ( NAT )) st (B81 = $1 & (S10[ B81 ] implies S11[ B81 ])));
L779:
now
let R18 being (FinSequence of ( NAT ));
let R22 being (Element of ( NAT ));
assume that
L780: S12[ R18 ];
set D71 = ( R18 ^ <* R22 *> );
L781: ( ( len R18 ) + 1 ) >= ( ( 0 ) + 1 ) by XREAL_1:6;
L782: ( len D71 ) >= 1 by L781 , FINSEQ_2:16;
L783:
now
assume L784: S10[ D71 ];
L785: (for R24 being Nat holds (R24 in ( dom R18 ) implies ( ( R18 . R24 ) gcd R22 ) = 1))
proof
let R24 being Nat;
L786: ( len D71 ) in ( dom D71 ) by L782 , FINSEQ_3:25;
assume L787: R24 in ( dom R18 );
L788: R24 <= ( len R18 ) by L787 , FINSEQ_3:25;
L789: R24 < ( ( len R18 ) + 1 ) by L788 , XREAL_1:39;
L790: R24 < ( len D71 ) by L789 , FINSEQ_2:16;
L791: R24 in ( dom D71 ) by L787 , FINSEQ_2:15;
L792: ( ( D71 . R24 ) gcd ( D71 . ( len D71 ) ) ) = 1 by L791 , L784 , L790 , L786;
L793: ( ( D71 . R24 ) gcd ( D71 . ( ( len R18 ) + 1 ) ) ) = 1 by L792 , FINSEQ_2:16;
L794: ( D71 . R24 ) = ( R18 . R24 ) by L787 , FINSEQ_1:def 7;
thus L795: thesis by L794 , L793 , FINSEQ_1:42;
end;
L796: ( ( Product R18 ) gcd R22 ) = 1 by L785 , WSIERP_1:36;
L797: ( Product R18 ) , R22 are_relative_prime  by L796 , INT_2:def 3;
L798: ( dom R18 ) c= ( dom D71 ) by FINSEQ_1:26;
L799: (for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom R18 ) & R21 in ( dom R18 ) & R20 <> R21) implies ( ( R18 . R20 ) gcd ( R18 . R21 ) ) = 1)))
proof
let R20 being (Element of ( NAT ));
let R21 being (Element of ( NAT ));
assume that
L800: (R20 in ( dom R18 ) & R21 in ( dom R18 ))
and
L801: R20 <> R21;
L802: (( D71 . R20 ) = ( R18 . R20 ) & ( D71 . R21 ) = ( R18 . R21 )) by L800 , FINSEQ_1:def 7;
thus L803: thesis by L802 , L784 , L798 , L800 , L801;
end;
L804: (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) divides R24))
proof
let R20 being (Element of ( NAT ));
assume L805: R20 in ( dom R18 );
L806: ( D71 . R20 ) = ( R18 . R20 ) by L805 , FINSEQ_1:def 7;
thus L807: thesis by L806 , L784 , L798 , L805;
end;
L808: ( len D71 ) in ( dom D71 ) by FINSEQ_5:6;
L809: ( D71 . ( len D71 ) ) divides R24 by L808 , L784;
L810: ( D71 . ( ( len R18 ) + 1 ) ) divides R24 by L809 , FINSEQ_2:16;
L811: R22 divides R24 by L810 , FINSEQ_1:42;
L812: ( ( Product R18 ) * R22 ) divides R24 by L811 , L780 , L799 , L804 , L797 , PEPIN:4;
thus L813: S11[ D71 ] by L812 , RVSUM_1:96;
end;
thus L814: S12[ D71 ] by L783;
end;
L815: S12[ ( <*> ( NAT ) ) ]
proof
take ( <*> ( NAT ) );
thus L816: thesis by NAT_D:6 , RVSUM_1:94;
end;
L817: (for R18 being (FinSequence of ( NAT )) holds S12[ R18 ]) from FINSEQ_2:sch 2(L815 , L779);
L818: (ex B82 being (FinSequence of ( NAT )) st (B82 = R18 & (S10[ B82 ] implies S11[ B82 ]))) by L817;
thus L819: thesis by L818;
end;
theorem
L820: (for R4 being Integer holds (for R5 being Integer holds (for R18 being (FinSequence of ( NAT )) holds (((for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom R18 ) & R21 in ( dom R18 ) & R20 <> R21) implies ( ( R18 . R20 ) gcd ( R18 . R21 ) ) = 1))) & (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) > ( 0 )))) implies (for R19 being (FinSequence of ( NAT )) holds ((for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies (( ( R4 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 ) & ( ( R5 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 )))) implies R4 , R5 are_congruent_mod ( Product R18 )))))))
proof
let R4 being Integer;
let R5 being Integer;
let R18 being (FinSequence of ( NAT ));
assume that
L821: (for R20 being (Element of ( NAT )) holds (for R21 being (Element of ( NAT )) holds ((R20 in ( dom R18 ) & R21 in ( dom R18 ) & R20 <> R21) implies ( ( R18 . R20 ) gcd ( R18 . R21 ) ) = 1)))
and
L822: (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) > ( 0 )));
let R19 being (FinSequence of ( NAT ));
assume that
L823: (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies (( ( R4 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 ) & ( ( R5 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 ))));
per cases ;
suppose L824: R4 >= R5;

L825: ( R4 - R5 ) in ( NAT ) by L824 , INT_1:3 , XREAL_1:48;
reconsider D72 = ( R4 - R5 ) as Nat by L825;
L826: (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) divides D72))
proof
let R20 being (Element of ( NAT ));
assume that
L827: R20 in ( dom R18 );
L828: ( R18 . R20 ) > ( 0 ) by L822 , L827;
L829: ( ( R5 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 ) by L823 , L827;
L830: ( R18 . R20 ) divides ( R5 - ( R19 . R20 ) ) by L829 , L828 , INT_1:62;
L831: ( ( R4 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 ) by L823 , L827;
L832: ( R18 . R20 ) divides ( R4 - ( R19 . R20 ) ) by L831 , L828 , INT_1:62;
L833: ( R18 . R20 ) divides ( ( R4 - ( R19 . R20 ) ) - ( R5 - ( R19 . R20 ) ) ) by L832 , L830 , L104;
consider C125 being Integer such that L834: ( R4 - R5 ) = ( ( R18 . R20 ) * C125 ) by L833 , INT_1:def 3;
L835: C125 >= ( 0 )
proof
assume L836: C125 < ( 0 );
L837: D72 < ( 0 ) by L836 , L822 , L827 , L834 , XREAL_1:132;
thus L838: contradiction by L837;
end;
L839: C125 in ( NAT ) by L835 , INT_1:3;
reconsider D73 = C125 as Nat by L839;
L840: D73 is Nat;
thus L841: thesis by L840 , L834 , NAT_D:def 3;
end;
L842: ( Product R18 ) divides D72 by L826 , L821 , L778;
thus L843: thesis by L842 , INT_2:15;
end;
suppose L844: R4 < R5;

L845: ( R5 - R4 ) > ( 0 ) by L844 , XREAL_1:50;
L846: ( R5 - R4 ) in ( NAT ) by L845 , INT_1:3;
reconsider D74 = ( R5 - R4 ) as Nat by L846;
L847: (for R20 being (Element of ( NAT )) holds (R20 in ( dom R18 ) implies ( R18 . R20 ) divides D74))
proof
let R20 being (Element of ( NAT ));
assume that
L848: R20 in ( dom R18 );
L849: ( R18 . R20 ) > ( 0 ) by L822 , L848;
L850: ( ( R5 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 ) by L823 , L848;
L851: ( R18 . R20 ) divides ( R5 - ( R19 . R20 ) ) by L850 , L849 , INT_1:62;
L852: ( ( R4 - ( R19 . R20 ) ) mod ( R18 . R20 ) ) = ( 0 ) by L823 , L848;
L853: ( R18 . R20 ) divides ( R4 - ( R19 . R20 ) ) by L852 , L849 , INT_1:62;
L854: ( R18 . R20 ) divides ( ( R5 - ( R19 . R20 ) ) - ( R4 - ( R19 . R20 ) ) ) by L853 , L851 , L104;
consider C126 being Integer such that L855: ( R5 - R4 ) = ( ( R18 . R20 ) * C126 ) by L854 , INT_1:def 3;
L856: D74 = ( ( R18 . R20 ) * C126 ) by L855;
L857: C126 >= ( 0 ) by L856 , L822 , L848 , XREAL_1:132;
L858: C126 in ( NAT ) by L857 , INT_1:3;
reconsider D75 = C126 as Nat by L858;
L859: D75 is Nat;
thus L860: thesis by L859 , L855 , NAT_D:def 3;
end;
L861: ( Product R18 ) divides D74 by L847 , L821 , L778;
L862: R5 , R4 are_congruent_mod ( Product R18 ) by L861 , INT_2:15;
thus L863: thesis by L862 , INT_1:14;
end;
end;
L865: (for R37 being Integer holds (for R38 being Integer holds ((R37 divides R38 implies ( R38 mod R37 ) = ( 0 )) & ((R37 <> ( 0 ) & ( R38 mod R37 ) = ( 0 )) implies R37 divides R38))))
proof
let R37 being Integer;
let R38 being Integer;
L866: (R37 divides R38 implies ( R38 mod R37 ) = ( 0 ))
proof
assume L867: R37 divides R38;
consider R25 being Integer such that L868: R38 = ( R37 * R25 ) by L867 , INT_1:def 3;
L869: ( R38 mod R37 ) = ( ( ( R37 * R25 ) + ( 0 ) ) mod R37 ) by L868
.= ( ( 0 ) mod R37 ) by EULER_1:12
.= ( 0 ) by L169;
thus L870: thesis by L869;
end;
L871: ((R37 <> ( 0 ) & ( R38 mod R37 ) = ( 0 )) implies R37 divides R38)
proof
assume that
L872: R37 <> ( 0 )
and
L873: ( R38 mod R37 ) = ( 0 );
L874: R38 = ( ( ( R38 div R37 ) * R37 ) + ( R38 mod R37 ) ) by L872 , INT_1:59
.= ( ( R38 div R37 ) * R37 ) by L873;
thus L875: thesis by L874 , INT_1:def 3;
end;
thus L876: thesis by L871 , L866;
end;
L877: (for R37 being Integer holds (for R38 being Integer holds (R37 divides R38 implies R38 = ( ( R38 div R37 ) * R37 ))))
proof
let R37 being Integer;
let R38 being Integer;
assume L878: R37 divides R38;
L879: ( R38 mod R37 ) = ( 0 ) by L878 , L865;
per cases ;
suppose L880: R37 = ( 0 );

thus L881: thesis by L880 , L878 , INT_2:3;
end;
suppose L882: R37 <> ( 0 );

thus L883: R38 = ( ( ( R38 div R37 ) * R37 ) + ( R38 mod R37 ) ) by L882 , INT_1:59
.= ( ( R38 div R37 ) * R37 ) by L879;
end;
end;
L885: (for R37 being Integer holds (for R38 being Integer holds ((R37 <> ( 0 ) or R38 <> ( 0 )) implies ( R37 div ( R37 gcd R38 ) ) , ( R38 div ( R37 gcd R38 ) ) are_relative_prime )))
proof
let R37 being Integer;
let R38 being Integer;
assume L886: (R37 <> ( 0 ) or R38 <> ( 0 ));
L887: ( R37 gcd R38 ) <> ( 0 ) by L886 , INT_2:5;
L888: R38 = ( ( R38 div ( R37 gcd R38 ) ) * ( R37 gcd R38 ) ) by L877 , INT_2:21;
consider C127 , C128 being Integer such that L889: R37 = ( ( R37 gcd R38 ) * C127 ) and L890: (R38 = ( ( R37 gcd R38 ) * C128 ) & C127 , C128 are_relative_prime ) by L886 , INT_2:23;
L891: R37 = ( ( R37 div ( R37 gcd R38 ) ) * ( R37 gcd R38 ) ) by L877 , INT_2:21;
L892: C127 = ( R37 div ( R37 gcd R38 ) ) by L891 , L887 , L889 , XCMPLX_1:5;
thus L893: thesis by L892 , L887 , L888 , L890 , XCMPLX_1:5;
end;
L894: (for R25 being Integer holds (for R37 being Integer holds (for R38 being Integer holds ((R37 divides R25 & R38 divides R25 & R37 , R38 are_relative_prime ) implies ( R37 * R38 ) divides R25))))
proof
let R25 being Integer;
let R37 being Integer;
let R38 being Integer;
assume that
L895: R37 divides R25
and
L896: (R38 divides R25 & R37 , R38 are_relative_prime );
consider R26 being Integer such that L897: R25 = ( R37 * R26 ) by L895 , INT_1:def 3;
L898: R38 divides R26 by L896 , L897 , INT_2:25;
consider R30 being Integer such that L899: R26 = ( R38 * R30 ) by L898 , INT_1:def 3;
L900: R25 = ( ( R37 * R38 ) * R30 ) by L897 , L899;
thus L901: thesis by L900 , INT_1:def 3;
end;
theorem
L902: (for R27 being Integer holds (for R28 being Integer holds (for R35 being Integer holds (for R36 being Integer holds ((R27 <> ( 0 ) & R28 <> ( 0 ) & R27 , R28 are_relative_prime ) implies (ex B83 being Integer st ((for R37 being Integer holds ((( ( R37 - R35 ) mod R27 ) = ( 0 ) & ( ( R37 - R36 ) mod R28 ) = ( 0 )) implies R37 , ( R35 + ( R27 * B83 ) ) are_congruent_mod ( R27 * R28 ))) & ( ( ( R27 * B83 ) - ( R36 - R35 ) ) mod R28 ) = ( 0 ))))))))
proof
let R27 being Integer;
let R28 being Integer;
let R35 being Integer;
let R36 being Integer;
assume that
L903: R27 <> ( 0 )
and
L904: R28 <> ( 0 )
and
L905: R27 , R28 are_relative_prime ;
consider C129 being Integer such that L906: ( ( ( R27 * C129 ) - ( R36 - R35 ) ) mod R28 ) = ( 0 ) by L905 , L229;
take C129;
L907: (for R37 being Integer holds ((( ( R37 - R35 ) mod R27 ) = ( 0 ) & ( ( R37 - R36 ) mod R28 ) = ( 0 )) implies R37 , ( R35 + ( R27 * C129 ) ) are_congruent_mod ( R27 * R28 )))
proof
let R37 being Integer;
assume that
L908: ( ( R37 - R35 ) mod R27 ) = ( 0 )
and
L909: ( ( R37 - R36 ) mod R28 ) = ( 0 );
set D76 = ( ( R37 - R35 ) div R27 );
L910: ( R37 - R35 ) = ( ( ( ( R37 - R35 ) div R27 ) * R27 ) + ( ( R37 - R35 ) mod R27 ) ) by L903 , INT_1:59
.= ( ( ( R37 - R35 ) div R27 ) * R27 ) by L908;
L911: ( ( R37 - R36 ) mod R28 ) = ( ( ( R27 * D76 ) - ( R36 - R35 ) ) mod R28 ) by L910;
L912: D76 in ( Class (( Cong R28 ) , C129) ) by L911 , L904 , L905 , L906 , L909 , L417;
L913: [ C129 , D76 ] in ( Cong R28 ) by L912 , EQREL_1:18;
L914: C129 , D76 are_congruent_mod R28 by L913 , L374;
L915: D76 , C129 are_congruent_mod R28 by L914 , INT_1:14;
L916: R28 divides ( D76 - C129 ) by L915 , INT_2:15;
consider C130 being Integer such that L917: ( D76 - C129 ) = ( R28 * C130 ) by L916 , INT_1:def 3;
L918: R37 = ( R35 + ( D76 * R27 ) ) by L910
.= ( R35 + ( ( C129 + ( R28 * C130 ) ) * R27 ) ) by L917
.= ( ( R35 + ( C129 * R27 ) ) + ( ( R27 * R28 ) * C130 ) );
L919: ( R27 * R28 ) divides ( R37 - ( R35 + ( C129 * R27 ) ) ) by L918 , INT_2:2;
thus L920: thesis by L919 , INT_2:15;
end;
thus L921: thesis by L907 , L906;
end;
theorem
L922: (for R27 being Integer holds (for R28 being Integer holds (for R35 being Integer holds (for R36 being Integer holds ((R27 <> ( 0 ) & R28 <> ( 0 ) & (not ( R27 gcd R28 ) divides ( R35 - R36 ))) implies (not (ex R37 being Integer st (( ( R37 - R35 ) mod R27 ) = ( 0 ) & ( ( R37 - R36 ) mod R28 ) = ( 0 )))))))))
proof
let R27 being Integer;
let R28 being Integer;
let R35 being Integer;
let R36 being Integer;
assume that
L923: R27 <> ( 0 )
and
L924: R28 <> ( 0 )
and
L925: (not ( R27 gcd R28 ) divides ( R35 - R36 ));
L926: ( R27 gcd R28 ) divides R28 by INT_2:21;
given R37 being Integer such that
L927: ( ( R37 - R35 ) mod R27 ) = ( 0 )
and
L928: ( ( R37 - R36 ) mod R28 ) = ( 0 );

L929: R28 divides ( R37 - R36 ) by L924 , L928 , L865;
L930: ( R27 gcd R28 ) divides ( R37 - R36 ) by L929 , L926 , INT_2:9;
L931: ( R27 gcd R28 ) divides R27 by INT_2:21;
L932: R27 divides ( R37 - R35 ) by L923 , L927 , L865;
L933: ( R27 gcd R28 ) divides ( R37 - R35 ) by L932 , L931 , INT_2:9;
L934: ( R27 gcd R28 ) divides ( ( R37 - R36 ) - ( R37 - R35 ) ) by L933 , L930 , L104;
thus L935: contradiction by L934 , L925;
end;
theorem
L936: (for R27 being Integer holds (for R28 being Integer holds (for R35 being Integer holds (for R36 being Integer holds ((R27 <> ( 0 ) & R28 <> ( 0 ) & ( R27 gcd R28 ) divides ( R36 - R35 )) implies (ex R30 being Integer st ((for R37 being Integer holds ((( ( R37 - R35 ) mod R27 ) = ( 0 ) & ( ( R37 - R36 ) mod R28 ) = ( 0 )) implies R37 , ( R35 + ( R27 * R30 ) ) are_congruent_mod ( R27 lcm R28 ))) & ( ( ( ( R27 div ( R27 gcd R28 ) ) * R30 ) - ( ( R36 - R35 ) div ( R27 gcd R28 ) ) ) mod ( R28 div ( R27 gcd R28 ) ) ) = ( 0 ))))))))
proof
let R27 being Integer;
let R28 being Integer;
let R35 being Integer;
let R36 being Integer;
assume that
L937: R27 <> ( 0 )
and
L938: R28 <> ( 0 )
and
L939: ( R27 gcd R28 ) divides ( R36 - R35 );
set D77 = ( R27 gcd R28 );
set D78 = ( R27 div D77 );
set D79 = ( R28 div D77 );
set D80 = ( ( R36 - R35 ) div D77 );
L940: D78 , D79 are_relative_prime  by L937 , L885;
consider R30 being Integer such that L941: ( ( ( D78 * R30 ) - D80 ) mod D79 ) = ( 0 ) by L940 , L229;
take R30;
L942: R27 = ( ( R27 div ( R27 gcd R28 ) ) * ( R27 gcd R28 ) ) by L877 , INT_2:21;
L943: R28 = ( ( R28 div ( R27 gcd R28 ) ) * ( R27 gcd R28 ) ) by L877 , INT_2:21;
L944: D77 <> ( 0 ) by L937 , INT_2:5;
L945: (for R37 being Integer holds ((( ( R37 - R35 ) mod R27 ) = ( 0 ) & ( ( R37 - R36 ) mod R28 ) = ( 0 )) implies R37 , ( R35 + ( R27 * R30 ) ) are_congruent_mod ( R27 lcm R28 )))
proof
let R37 being Integer;
assume that
L946: ( ( R37 - R35 ) mod R27 ) = ( 0 )
and
L947: ( ( R37 - R36 ) mod R28 ) = ( 0 );
set D81 = ( ( R37 - R35 ) div R27 );
L948: ( R37 - R35 ) = ( ( ( ( R37 - R35 ) div R27 ) * R27 ) + ( ( R37 - R35 ) mod R27 ) ) by L937 , INT_1:59
.= ( ( ( R37 - R35 ) div R27 ) * R27 ) by L946;
L949: ( R37 - ( ( R27 * R30 ) + R35 ) ) = ( R27 * ( ( ( R37 - R35 ) div R27 ) - R30 ) ) by L948;
L950: R27 divides ( R37 - ( ( R27 * R30 ) + R35 ) ) by L949 , INT_1:def 3;
L951: ( ( R37 - R36 ) mod R28 ) = ( ( ( R27 * D81 ) - ( R36 - R35 ) ) mod R28 ) by L948
.= ( ( ( ( D77 * D78 ) * D81 ) - ( D77 * D80 ) ) mod ( D77 * D79 ) ) by L939 , L942 , L943 , L877;
L952: ( D79 * D77 ) divides ( ( ( D78 * D81 ) - D80 ) * D77 ) by L951 , L938 , L943 , L947 , L865;
L953: D79 divides ( ( D78 * D81 ) - D80 ) by L952 , L944 , L129;
L954: ( ( ( D78 * D81 ) - D80 ) mod D79 ) = ( 0 ) by L953 , L865;
L955: D79 <> ( 0 ) by L938 , L943;
L956: R30 in ( Class (( Cong D79 ) , D81) ) by L955 , L940 , L941 , L954 , L417;
L957: [ D81 , R30 ] in ( Cong D79 ) by L956 , EQREL_1:18;
L958: D81 , R30 are_congruent_mod D79 by L957 , L374;
L959: D79 divides ( D81 - R30 ) by L958 , INT_2:15;
consider C131 being Integer such that L960: ( D81 - R30 ) = ( D79 * C131 ) by L959 , INT_1:def 3;
L961: R37 = ( R35 + ( D81 * R27 ) ) by L948
.= ( R35 + ( ( ( D79 * C131 ) + R30 ) * R27 ) ) by L960
.= ( ( ( R27 * R30 ) + R35 ) + ( ( C131 * D78 ) * R28 ) ) by L942 , L943;
L962: R28 divides ( R37 - ( ( R27 * R30 ) + R35 ) ) by L961 , INT_1:def 3;
L963: ( R27 lcm R28 ) divides ( R37 - ( ( R27 * R30 ) + R35 ) ) by L962 , L950 , INT_2:19;
thus L964: thesis by L963 , INT_2:15;
end;
thus L965: thesis by L945 , L941;
end;
theorem
L966: (for R27 being Integer holds (for R28 being Integer holds (for R32 being Integer holds (for R33 being Integer holds (for R35 being Integer holds (for R36 being Integer holds ((R27 <> ( 0 ) & R28 <> ( 0 ) & ( R32 gcd R27 ) divides R35 & ( R33 gcd R28 ) divides R36 & R27 , R28 are_relative_prime ) implies (ex B84 , B85 , B86 being Integer st ((for R37 being Integer holds ((( ( ( R32 * R37 ) - R35 ) mod R27 ) = ( 0 ) & ( ( ( R33 * R37 ) - R36 ) mod R28 ) = ( 0 )) implies R37 , ( B85 + ( ( R27 div ( R32 gcd R27 ) ) * B84 ) ) are_congruent_mod ( ( R27 div ( R32 gcd R27 ) ) * ( R28 div ( R33 gcd R28 ) ) ))) & ( ( ( ( R32 div ( R32 gcd R27 ) ) * B85 ) - ( R35 div ( R32 gcd R27 ) ) ) mod ( R27 div ( R32 gcd R27 ) ) ) = ( 0 ) & ( ( ( ( R33 div ( R33 gcd R28 ) ) * B86 ) - ( R36 div ( R33 gcd R28 ) ) ) mod ( R28 div ( R33 gcd R28 ) ) ) = ( 0 ) & ( ( ( ( R27 div ( R32 gcd R27 ) ) * B84 ) - ( B86 - B85 ) ) mod ( R28 div ( R33 gcd R28 ) ) ) = ( 0 ))))))))))
proof
let R27 being Integer;
let R28 being Integer;
let R32 being Integer;
let R33 being Integer;
let R35 being Integer;
let R36 being Integer;
assume that
L967: R27 <> ( 0 )
and
L968: R28 <> ( 0 )
and
L969: ( R32 gcd R27 ) divides R35
and
L970: ( R33 gcd R28 ) divides R36
and
L971: R27 , R28 are_relative_prime ;
set D82 = ( R33 gcd R28 );
L972: D82 <> ( 0 ) by L968 , INT_2:5;
set D83 = ( R32 gcd R27 );
L973: D83 <> ( 0 ) by L967 , INT_2:5;
L974: ( R32 div D83 ) , ( R27 div D83 ) are_relative_prime  by L967 , L885;
consider R30 being Integer such that L975: ( ( ( ( R32 div D83 ) * R30 ) - ( R35 div D83 ) ) mod ( R27 div D83 ) ) = ( 0 ) by L974 , L229;
L976: R36 = ( ( R36 div D82 ) * D82 ) by L970 , L877;
L977: R33 = ( ( R33 div D82 ) * D82 ) by L877 , INT_2:21;
L978: R28 = ( ( R28 div D82 ) * D82 ) by L877 , INT_2:21;
L979: ( R28 div D82 ) divides R28 by L978 , INT_1:def 3;
L980: ( R28 div D82 ) <> ( 0 ) by L968 , L978;
L981: R35 = ( ( R35 div D83 ) * D83 ) by L969 , L877;
L982: R32 = ( ( R32 div D83 ) * D83 ) by L877 , INT_2:21;
L983: ( R33 div D82 ) , ( R28 div D82 ) are_relative_prime  by L968 , L885;
consider C132 being Integer such that L984: ( ( ( ( R33 div D82 ) * C132 ) - ( R36 div D82 ) ) mod ( R28 div D82 ) ) = ( 0 ) by L983 , L229;
L985: R27 = ( ( R27 div D83 ) * D83 ) by L877 , INT_2:21;
L986: ( R27 div D83 ) divides R27 by L985 , INT_1:def 3;
L987: ( R27 div D83 ) , ( R28 div D82 ) are_relative_prime 
proof
reconsider D84 = ( ( R27 div D83 ) gcd ( R28 div D82 ) ) as (Element of ( NAT )) by ORDINAL1:def 12;
assume L988: (not ( R27 div D83 ) , ( R28 div D82 ) are_relative_prime );
L989: ( ( R27 div D83 ) gcd ( R28 div D82 ) ) <> 1 by L988 , INT_2:def 3;
L990: D84 divides ( R28 div D82 ) by INT_2:21;
L991: D84 divides R28 by L990 , L979 , INT_2:9;
L992: D84 divides ( R27 div D83 ) by INT_2:21;
L993: D84 divides R27 by L992 , L986 , INT_2:9;
L994: D84 divides ( R27 gcd R28 ) by L993 , L991 , INT_2:22;
L995: D84 divides 1 by L994 , L971 , INT_2:def 3;
thus L996: contradiction by L995 , L989 , WSIERP_1:15;
end;
consider C133 being Integer such that L997: ( ( ( ( R27 div D83 ) * C133 ) - ( C132 - R30 ) ) mod ( R28 div D82 ) ) = ( 0 ) by L987 , L229;
take C133;
take R30;
take C132;
L998: ( R27 div D83 ) <> ( 0 ) by L967 , L985;
L999: (for R37 being Integer holds ((( ( ( R32 * R37 ) - R35 ) mod R27 ) = ( 0 ) & ( ( ( R33 * R37 ) - R36 ) mod R28 ) = ( 0 )) implies R37 , ( R30 + ( ( R27 div ( R32 gcd R27 ) ) * C133 ) ) are_congruent_mod ( ( R27 div ( R32 gcd R27 ) ) * ( R28 div ( R33 gcd R28 ) ) )))
proof
let R37 being Integer;
assume that
L1000: ( ( ( R32 * R37 ) - R35 ) mod R27 ) = ( 0 )
and
L1001: ( ( ( R33 * R37 ) - R36 ) mod R28 ) = ( 0 );
L1002: ( ( R27 div D83 ) * D83 ) divides ( ( ( ( R32 div D83 ) * R37 ) - ( R35 div D83 ) ) * D83 ) by L967 , L985 , L981 , L982 , L1000 , L865;
L1003: ( R27 div D83 ) divides ( ( ( R32 div D83 ) * R37 ) - ( R35 div D83 ) ) by L1002 , L973 , L129;
L1004: ( ( ( ( R32 div D83 ) * R37 ) - ( R35 div D83 ) ) mod ( R27 div D83 ) ) = ( 0 ) by L1003 , L865;
L1005: R30 in ( Class (( Cong ( R27 div D83 ) ) , R37) ) by L1004 , L974 , L975 , L998 , L417;
L1006: [ R37 , R30 ] in ( Cong ( R27 div D83 ) ) by L1005 , EQREL_1:18;
L1007: R37 , R30 are_congruent_mod ( R27 div D83 ) by L1006 , L374;
L1008: ( R27 div D83 ) divides ( R37 - R30 ) by L1007 , INT_2:15;
L1009: ( ( R28 div D82 ) * D82 ) divides ( ( ( ( R33 div D82 ) * R37 ) - ( R36 div D82 ) ) * D82 ) by L968 , L978 , L976 , L977 , L1001 , L865;
L1010: ( R28 div D82 ) divides ( ( ( R33 div D82 ) * R37 ) - ( R36 div D82 ) ) by L1009 , L972 , L129;
L1011: ( ( ( ( R33 div D82 ) * R37 ) - ( R36 div D82 ) ) mod ( R28 div D82 ) ) = ( 0 ) by L1010 , L865;
L1012: C132 in ( Class (( Cong ( R28 div D82 ) ) , R37) ) by L1011 , L983 , L984 , L980 , L417;
L1013: [ R37 , C132 ] in ( Cong ( R28 div D82 ) ) by L1012 , EQREL_1:18;
L1014: R37 , C132 are_congruent_mod ( R28 div D82 ) by L1013 , L374;
L1015: ( R28 div D82 ) divides ( R37 - C132 ) by L1014 , INT_2:15;
L1016: ( R28 div D82 ) divides ( ( ( R27 div D83 ) * C133 ) - ( C132 - R30 ) ) by L980 , L997 , L865;
L1017: ( R28 div D82 ) divides ( ( R37 - C132 ) - ( ( ( ( R27 div D83 ) * C133 ) + R30 ) - C132 ) ) by L1016 , L1015 , L104;
L1018: ( R27 div D83 ) divides ( ( R27 div D83 ) * C133 ) by INT_2:2;
L1019: ( R27 div D83 ) divides ( ( R37 - R30 ) - ( ( R27 div D83 ) * C133 ) ) by L1018 , L1008 , L104;
L1020: ( ( R27 div D83 ) * ( R28 div D82 ) ) divides ( R37 - ( R30 + ( ( R27 div D83 ) * C133 ) ) ) by L1019 , L987 , L1017 , L894;
thus L1021: thesis by L1020 , INT_2:15;
end;
thus L1022: thesis by L999 , L975 , L984 , L997;
end;
theorem
L1023: (for R27 being Integer holds (for R28 being Integer holds (for R29 being Integer holds (for R32 being Integer holds (for R33 being Integer holds (for R34 being Integer holds ((R27 <> ( 0 ) & R28 <> ( 0 ) & R29 <> ( 0 ) & R27 , R28 are_relative_prime  & R27 , R29 are_relative_prime  & R28 , R29 are_relative_prime ) implies (ex R30 being Integer st (ex R31 being Integer st (for R37 being Integer holds ((( ( R37 - R32 ) mod R27 ) = ( 0 ) & ( ( R37 - R33 ) mod R28 ) = ( 0 ) & ( ( R37 - R34 ) mod R29 ) = ( 0 )) implies (R37 , ( ( R32 + ( R27 * R30 ) ) + ( ( R27 * R28 ) * R31 ) ) are_congruent_mod ( ( R27 * R28 ) * R29 ) & ( ( ( R27 * R30 ) - ( R33 - R32 ) ) mod R28 ) = ( 0 ) & ( ( ( ( R27 * R28 ) * R31 ) - ( ( R34 - R32 ) - ( R27 * R30 ) ) ) mod R29 ) = ( 0 )))))))))))))
proof
let R27 being Integer;
let R28 being Integer;
let R29 being Integer;
let R32 being Integer;
let R33 being Integer;
let R34 being Integer;
assume that
L1024: (R27 <> ( 0 ) & R28 <> ( 0 ))
and
L1025: R29 <> ( 0 )
and
L1026: R27 , R28 are_relative_prime 
and
L1027: (R27 , R29 are_relative_prime  & R28 , R29 are_relative_prime );
consider R30 being Integer such that L1028: (for R37 being Integer holds ((( ( R37 - R32 ) mod R27 ) = ( 0 ) & ( ( R37 - R33 ) mod R28 ) = ( 0 )) implies R37 , ( R32 + ( R27 * R30 ) ) are_congruent_mod ( R27 * R28 ))) and L1029: ( ( ( R27 * R30 ) - ( R33 - R32 ) ) mod R28 ) = ( 0 ) by L1024 , L1026 , L902;
L1030: ( R27 * R28 ) <> ( 0 ) by L1024 , XCMPLX_1:6;
consider R31 being Integer such that L1031: ((for R37 being Integer holds ((( ( R37 - ( R32 + ( R27 * R30 ) ) ) mod ( R27 * R28 ) ) = ( 0 ) & ( ( R37 - R34 ) mod R29 ) = ( 0 )) implies R37 , ( ( R32 + ( R27 * R30 ) ) + ( ( R27 * R28 ) * R31 ) ) are_congruent_mod ( ( R27 * R28 ) * R29 ))) & ( ( ( ( R27 * R28 ) * R31 ) - ( R34 - ( R32 + ( R27 * R30 ) ) ) ) mod R29 ) = ( 0 )) by L1030 , L1025 , L1027 , L902 , INT_2:26;
take R30;
take R31;
L1032: (for R37 being Integer holds ((( ( R37 - R32 ) mod R27 ) = ( 0 ) & ( ( R37 - R33 ) mod R28 ) = ( 0 ) & ( ( R37 - R34 ) mod R29 ) = ( 0 )) implies (R37 , ( ( R32 + ( R27 * R30 ) ) + ( ( R27 * R28 ) * R31 ) ) are_congruent_mod ( ( R27 * R28 ) * R29 ) & ( ( ( R27 * R30 ) - ( R33 - R32 ) ) mod R28 ) = ( 0 ) & ( ( ( ( R27 * R28 ) * R31 ) - ( ( R34 - R32 ) - ( R27 * R30 ) ) ) mod R29 ) = ( 0 ))))
proof
let R37 being Integer;
assume that
L1033: (( ( R37 - R32 ) mod R27 ) = ( 0 ) & ( ( R37 - R33 ) mod R28 ) = ( 0 ))
and
L1034: ( ( R37 - R34 ) mod R29 ) = ( 0 );
L1035: R37 , ( R32 + ( R27 * R30 ) ) are_congruent_mod ( R27 * R28 ) by L1028 , L1033;
L1036: ( R27 * R28 ) divides ( R37 - ( R32 + ( R27 * R30 ) ) ) by L1035 , INT_2:15;
L1037: ( ( R37 - ( R32 + ( R27 * R30 ) ) ) mod ( R27 * R28 ) ) = ( 0 ) by L1036 , L865;
thus L1038: thesis by L1037 , L1029 , L1031 , L1034;
end;
thus L1039: thesis by L1032;
end;
theorem
L1040: (for R27 being Integer holds (for R28 being Integer holds (for R29 being Integer holds (for R32 being Integer holds (for R33 being Integer holds (for R34 being Integer holds ((R27 <> ( 0 ) & R28 <> ( 0 ) & R29 <> ( 0 ) & ((not ( R27 gcd R28 ) divides ( R32 - R33 )) or (not ( R27 gcd R29 ) divides ( R32 - R34 )) or (not ( R28 gcd R29 ) divides ( R33 - R34 )))) implies (not (ex R37 being Integer st (( ( R37 - R32 ) mod R27 ) = ( 0 ) & ( ( R37 - R33 ) mod R28 ) = ( 0 ) & ( ( R37 - R34 ) mod R29 ) = ( 0 ))))))))))) by L922;
theorem
L1041: (for B87 , B88 , B89 being non  zero Nat holds ( ( B87 gcd B89 ) lcm ( B88 gcd B89 ) ) = ( ( B87 lcm B88 ) gcd B89 ))
proof
let C134 , C135 , C136 being non  zero Nat;
set D85 = ( C134 gcd C136 );
set D86 = ( C135 gcd C136 );
set D87 = ( C134 lcm C135 );
reconsider D88 = ( D87 gcd C136 ) as non  empty Nat by INT_2:5;
reconsider D89 = D87 as non  empty Nat by INT_2:4;
L1042: (D85 divides C136 & D86 divides C136) by NAT_D:def 5;
L1043: ( D85 lcm D86 ) divides C136 by L1042 , NAT_D:def 4;
L1044: (D86 divides C135 & C135 divides D89) by NAT_D:def 4 , NAT_D:def 5;
L1045: D86 divides D89 by L1044 , NAT_D:4;
L1046: (for B90 being Nat holds (B90 in ( support ( pfexp D88 ) ) implies (( ( ppf D88 ) . B90 ) divides C134 or ( ( ppf D88 ) . B90 ) divides C135)))
proof
let C137 being Nat;
assume that
L1047: C137 in ( support ( pfexp D88 ) )
and
L1048: (not ( ( ppf D88 ) . C137 ) divides C134)
and
L1049: (not ( ( ppf D88 ) . C137 ) divides C135);
L1050: (not ( C137 |^ ( C137 |-count D88 ) ) divides C135) by L1047 , L1049 , NAT_3:def 9;
L1051: C137 is Prime by L1047 , NAT_3:34;
L1052: (not ( C137 |^ ( C137 |-count D88 ) ) divides C134) by L1047 , L1048 , NAT_3:def 9;
L1053: ( C137 |-count D88 ) > ( C137 |-count D89 )
proof
L1054: ( C137 |-count D89 ) = ( ( pfexp D89 ) . C137 ) by L1051 , NAT_3:def 8
.= ( ( max (( pfexp C134 ) , ( pfexp C135 )) ) . C137 ) by NAT_3:54;
per cases ;
suppose L1055: ( ( pfexp C134 ) . C137 ) <= ( ( pfexp C135 ) . C137 );

L1056: ( C137 |-count D89 ) = ( ( pfexp C135 ) . C137 ) by L1055 , L1054 , NAT_3:def 4
.= ( C137 |-count C135 ) by L1051 , NAT_3:def 8;
thus L1057: thesis by L1056 , L1050 , L1051 , MOEBIUS1:9;
end;
suppose L1058: ( ( pfexp C134 ) . C137 ) > ( ( pfexp C135 ) . C137 );

L1059: ( C137 |-count D89 ) = ( ( pfexp C134 ) . C137 ) by L1058 , L1054 , NAT_3:def 4
.= ( C137 |-count C134 ) by L1051 , NAT_3:def 8;
thus L1060: thesis by L1059 , L1052 , L1051 , MOEBIUS1:9;
end;
end;
L1062: D88 divides D89 by NAT_D:def 5;
thus L1063: contradiction by L1062 , L1051 , L1053 , NAT_3:30;
end;
L1064: (for B91 being Nat holds (B91 in ( support ( pfexp D88 ) ) implies ( ( ppf D88 ) . B91 ) divides ( D85 lcm D86 )))
proof
L1065: D86 divides ( D85 lcm D86 ) by NAT_D:def 4;
let C138 being Nat;
L1066: D85 divides ( D85 lcm D86 ) by NAT_D:def 4;
assume L1067: C138 in ( support ( pfexp D88 ) );
L1068: C138 is Prime by L1067 , NAT_3:34;
L1069: D88 divides C136 by NAT_D:def 5;
L1070: ( C138 |-count D88 ) <= ( C138 |-count C136 ) by L1069 , L1068 , NAT_3:30;
L1071: ( C138 |^ ( C138 |-count D88 ) ) divides ( C138 |^ ( C138 |-count C136 ) ) by L1070 , NEWTON:89;
L1072: ( ( ppf D88 ) . C138 ) divides ( C138 |^ ( C138 |-count C136 ) ) by L1071 , L1067 , NAT_3:def 9;
L1073: C138 <> 1 by L1068 , INT_2:def 4;
L1074: ( C138 |^ ( C138 |-count C136 ) ) divides C136 by L1073 , NAT_3:def 7;
L1075: ( ( ppf D88 ) . C138 ) divides C136 by L1074 , L1072 , NAT_D:4;
per cases  by L1046 , L1067;
suppose L1076: ( ( ppf D88 ) . C138 ) divides C134;

L1077: ( ( ppf D88 ) . C138 ) divides D85 by L1076 , L1075 , NAT_D:def 5;
thus L1078: thesis by L1077 , L1066 , NAT_D:4;
end;
suppose L1079: ( ( ppf D88 ) . C138 ) divides C135;

L1080: ( ( ppf D88 ) . C138 ) divides D86 by L1079 , L1075 , NAT_D:def 5;
thus L1081: thesis by L1080 , L1065 , NAT_D:4;
end;
end;
L1083: ( Product ( ppf D88 ) ) divides ( D85 lcm D86 )
proof
set D90 = ( ppf D88 );
set D91 = ( canFS ( support D90 ) );
consider C139 being (FinSequence of ( COMPLEX )) such that L1084: ( Product D90 ) = ( Product C139 ) and L1085: C139 = ( D90 * D91 ) by NAT_3:def 5;
L1086: ( rng C139 ) c= ( NAT ) by L1085 , VALUED_0:def 6;
reconsider D92 = C139 as (FinSequence of ( NAT )) by L1086 , FINSEQ_1:def 4;
L1087: ( rng D91 ) = ( support D90 ) by FUNCT_2:def 3;
L1088: ( rng D91 ) c= ( NAT ) by L1087 , XBOOLE_1:1;
reconsider D93 = D91 as (FinSequence of ( NAT )) by L1088 , FINSEQ_1:def 4;
L1089: (for B92 , B93 being (Element of ( NAT )) holds ((B92 in ( dom D92 ) & B93 in ( dom D92 ) & B92 <> B93) implies ( ( D92 . B92 ) gcd ( D92 . B93 ) ) = 1))
proof
let C140 , C141 being (Element of ( NAT ));
assume that
L1090: C140 in ( dom D92 )
and
L1091: C141 in ( dom D92 )
and
L1092: C140 <> C141;
L1093: C140 in ( dom D93 ) by L1085 , L1090 , FUNCT_1:11;
L1094: ( D93 . C140 ) in ( support D90 ) by L1093 , L1087 , FUNCT_1:3;
L1095: ( D93 . C140 ) in ( support ( pfexp D88 ) ) by L1094 , NAT_3:def 9;
L1096: ( D93 . C140 ) is  prime by L1095 , NAT_3:34;
L1097: C141 in ( dom D93 ) by L1085 , L1091 , FUNCT_1:11;
L1098: ( D93 . C141 ) in ( support D90 ) by L1097 , L1087 , FUNCT_1:3;
L1099: ( D93 . C141 ) in ( support ( pfexp D88 ) ) by L1098 , NAT_3:def 9;
L1100: ( D93 . C141 ) is  prime by L1099 , NAT_3:34;
L1101: ( D92 . C141 ) = ( D90 . ( D93 . C141 ) ) by L1085 , L1091 , FUNCT_1:12;
L1102: ( D92 . C141 ) = ( ( D93 . C141 ) |^ ( ( D93 . C141 ) |-count D88 ) ) by L1101 , L1099 , NAT_3:def 9;
L1103: ( D92 . C140 ) = ( D90 . ( D93 . C140 ) ) by L1085 , L1090 , FUNCT_1:12;
L1104: ( D92 . C140 ) = ( ( D93 . C140 ) |^ ( ( D93 . C140 ) |-count D88 ) ) by L1103 , L1095 , NAT_3:def 9;
L1105: ( D93 . C140 ) <> ( D93 . C141 ) by L1092 , L1093 , L1097 , FUNCT_1:def 4;
L1106: ( D93 . C141 ) , ( ( D93 . C140 ) |^ ( ( D93 . C140 ) |-count D88 ) ) are_relative_prime  by L1105 , L1096 , L1100 , EULER_2:17 , INT_2:30;
L1107: ( D93 . C141 ) > ( 0 ) by L1099 , NAT_3:34;
L1108: ( D93 . C140 ) > ( 0 ) by L1095 , NAT_3:34;
L1109: ( ( D93 . C141 ) |^ ( ( D93 . C141 ) |-count D88 ) ) , ( ( D93 . C140 ) |^ ( ( D93 . C140 ) |-count D88 ) ) are_relative_prime  by L1108 , L1107 , L1106 , EULER_2:17;
thus L1110: thesis by L1109 , L1104 , L1102 , INT_2:def 3;
end;
L1111: (for B94 being (Element of ( NAT )) holds (B94 in ( dom D92 ) implies ( D92 . B94 ) divides ( D85 lcm D86 )))
proof
let C142 being (Element of ( NAT ));
assume L1112: C142 in ( dom D92 );
L1113: C142 in ( dom D93 ) by L1112 , L1085 , FUNCT_1:11;
L1114: ( D93 . C142 ) in ( support D90 ) by L1113 , L1087 , FUNCT_1:3;
L1115: ( D93 . C142 ) in ( support ( pfexp D88 ) ) by L1114 , NAT_3:def 9;
L1116: ( D90 . ( D93 . C142 ) ) divides ( D85 lcm D86 ) by L1115 , L1064;
thus L1117: thesis by L1116 , L1085 , L1112 , FUNCT_1:12;
end;
thus L1118: thesis by L1111 , L1084 , L1089 , L778;
end;
L1119: D88 divides ( D85 lcm D86 ) by L1083 , NAT_3:61;
L1120: (D85 divides C134 & C134 divides D89) by NAT_D:def 4 , NAT_D:def 5;
L1121: D85 divides D89 by L1120 , NAT_D:4;
L1122: ( D85 lcm D86 ) divides D89 by L1121 , L1045 , NAT_D:def 4;
L1123: ( D85 lcm D86 ) divides D88 by L1122 , L1043 , NAT_D:def 5;
thus L1124: thesis by L1123 , L1119 , NAT_D:5;
end;
theorem
L1125: (for R32 being Integer holds (for R33 being Integer holds (for R34 being Integer holds (for B95 , B96 , B97 being non  zero Nat holds (( B95 gcd B96 ) divides ( R32 - R33 ) implies (ex R30 being Integer st (ex R31 being Integer st (for R37 being Integer holds ((( ( R37 - R32 ) mod B95 ) = ( 0 ) & ( ( R37 - R33 ) mod B96 ) = ( 0 ) & ( ( R37 - R34 ) mod B97 ) = ( 0 )) implies (R37 , ( ( R32 + ( B95 * R30 ) ) + ( ( B95 lcm B96 ) * R31 ) ) are_congruent_mod ( ( B95 lcm B96 ) lcm B97 ) & ( ( ( ( B95 div ( B95 gcd B96 ) ) * R30 ) - ( ( R33 - R32 ) div ( B95 gcd B96 ) ) ) mod ( B96 div ( B95 gcd B96 ) ) ) = ( 0 ) & ( ( ( ( ( B95 lcm B96 ) div ( ( B95 lcm B96 ) gcd B97 ) ) * R31 ) - ( ( R34 - ( R32 + ( B95 * R30 ) ) ) div ( ( B95 lcm B96 ) gcd B97 ) ) ) mod ( B97 div ( ( B95 lcm B96 ) gcd B97 ) ) ) = ( 0 )))))))))))
proof
let R32 being Integer;
let R33 being Integer;
let R34 being Integer;
let C143 , C144 , C145 being non  zero Nat;
set D94 = ( C143 gcd C144 );
set D95 = ( C143 gcd C145 );
set D96 = ( C144 gcd C145 );
set D97 = ( C143 gcd C144 );
set D98 = ( C143 lcm C144 );
L1126: C144 divides ( C143 lcm C144 ) by NAT_D:def 4;
assume L1127: ( C143 gcd C144 ) divides ( R32 - R33 );
L1128: D94 divides ( - ( R32 - R33 ) ) by L1127 , INT_2:10;
consider R30 being Integer such that L1129: (for R37 being Integer holds ((( ( R37 - R32 ) mod C143 ) = ( 0 ) & ( ( R37 - R33 ) mod C144 ) = ( 0 )) implies R37 , ( R32 + ( C143 * R30 ) ) are_congruent_mod D98)) and L1130: ( ( ( ( C143 div D97 ) * R30 ) - ( ( R33 - R32 ) div D97 ) ) mod ( C144 div D97 ) ) = ( 0 ) by L1128 , L936;
take R30;
set D99 = ( R32 + ( C143 * R30 ) );
L1131: ( D98 div ( D98 gcd C145 ) ) , ( C145 div ( D98 gcd C145 ) ) are_relative_prime  by L885;
consider R31 being Integer such that L1132: ( ( ( ( D98 div ( D98 gcd C145 ) ) * R31 ) - ( ( R34 - D99 ) div ( D98 gcd C145 ) ) ) mod ( C145 div ( D98 gcd C145 ) ) ) = ( 0 ) by L1131 , L229;
take R31;
L1133: C143 divides ( C143 lcm C144 ) by NAT_D:def 4;
L1134: (for R37 being Integer holds ((( ( R37 - R32 ) mod C143 ) = ( 0 ) & ( ( R37 - R33 ) mod C144 ) = ( 0 ) & ( ( R37 - R34 ) mod C145 ) = ( 0 )) implies ( ( C143 lcm C144 ) gcd C145 ) divides ( D99 - R34 )))
proof
let R37 being Integer;
assume that
L1135: (( ( R37 - R32 ) mod C143 ) = ( 0 ) & ( ( R37 - R33 ) mod C144 ) = ( 0 ))
and
L1136: ( ( R37 - R34 ) mod C145 ) = ( 0 );
L1137: C145 divides ( R37 - R34 ) by L1136 , L865;
L1138: R37 , D99 are_congruent_mod D98 by L1129 , L1135;
L1139: D98 divides ( R37 - D99 ) by L1138 , INT_2:15;
L1140: D98 divides ( - ( R37 - D99 ) ) by L1139 , INT_2:10;
L1141: C143 divides ( D99 - R37 ) by L1140 , L1133 , INT_2:9;
consider C146 being Integer such that L1142: ( D99 - R37 ) = ( C143 * C146 ) by L1141 , INT_1:def 3;
L1143: D96 divides C145 by NAT_D:def 5;
L1144: D96 divides ( R37 - R34 ) by L1143 , L1137 , INT_2:9;
L1145: D95 divides C145 by NAT_D:def 5;
L1146: D95 divides ( R37 - R34 ) by L1145 , L1137 , INT_2:9;
L1147: C144 divides ( D99 - R37 ) by L1126 , L1140 , INT_2:9;
consider C147 being Integer such that L1148: ( D99 - R37 ) = ( C144 * C147 ) by L1147 , INT_1:def 3;
L1149: D96 divides C144 by NAT_D:def 5;
L1150: D96 divides ( C144 * C147 ) by L1149 , INT_2:2;
L1151: ( D99 - R34 ) = ( ( R37 - R34 ) + ( C144 * C147 ) ) by L1148;
L1152: D96 divides ( D99 - R34 ) by L1151 , L1150 , L1144 , WSIERP_1:4;
L1153: D95 divides C143 by NAT_D:def 5;
L1154: D95 divides ( C143 * C146 ) by L1153 , INT_2:2;
L1155: ( D99 - R34 ) = ( ( R37 - R34 ) + ( C143 * C146 ) ) by L1142;
L1156: D95 divides ( D99 - R34 ) by L1155 , L1154 , L1146 , WSIERP_1:4;
L1157: ( D95 lcm D96 ) divides ( D99 - R34 ) by L1156 , L1152 , INT_2:19;
thus L1158: thesis by L1157 , L1041;
end;
L1159: (for R37 being Integer holds ((( ( R37 - R32 ) mod C143 ) = ( 0 ) & ( ( R37 - R33 ) mod C144 ) = ( 0 ) & ( ( R37 - R34 ) mod C145 ) = ( 0 )) implies R37 , ( D99 + ( ( C143 lcm C144 ) * R31 ) ) are_congruent_mod ( ( C143 lcm C144 ) lcm C145 )))
proof
L1160: D98 <> ( 0 ) by INT_2:4;
let R37 being Integer;
assume that
L1161: (( ( R37 - R32 ) mod C143 ) = ( 0 ) & ( ( R37 - R33 ) mod C144 ) = ( 0 ))
and
L1162: ( ( R37 - R34 ) mod C145 ) = ( 0 );
L1163: ( ( C143 lcm C144 ) gcd C145 ) divides ( D99 - R34 ) by L1134 , L1161 , L1162;
L1164: ( D98 gcd C145 ) divides ( - ( D99 - R34 ) ) by L1163 , INT_2:10;
consider C148 being Integer such that L1165: (for R37 being Integer holds ((( ( R37 - D99 ) mod D98 ) = ( 0 ) & ( ( R37 - R34 ) mod C145 ) = ( 0 )) implies R37 , ( D99 + ( D98 * C148 ) ) are_congruent_mod ( D98 lcm C145 ))) and L1166: ( ( ( ( D98 div ( D98 gcd C145 ) ) * C148 ) - ( ( R34 - D99 ) div ( D98 gcd C145 ) ) ) mod ( C145 div ( D98 gcd C145 ) ) ) = ( 0 ) by L1164 , L1160 , L936;
L1167: C145 = ( ( C145 div ( D98 gcd C145 ) ) * ( D98 gcd C145 ) ) by L877 , INT_2:21;
L1168: ( C145 div ( D98 gcd C145 ) ) <> ( 0 ) by L1167;
L1169: C148 in ( Class (( Cong ( C145 div ( D98 gcd C145 ) ) ) , R31) ) by L1168 , L1131 , L1132 , L1166 , L417;
L1170: [ R31 , C148 ] in ( Cong ( C145 div ( D98 gcd C145 ) ) ) by L1169 , EQREL_1:18;
L1171: R31 , C148 are_congruent_mod ( C145 div ( D98 gcd C145 ) ) by L1170 , L374;
L1172: ( D98 * R31 ) , ( D98 * C148 ) are_congruent_mod ( D98 * ( C145 div ( D98 gcd C145 ) ) ) by L1171 , L158;
L1173: ( D98 * ( C145 div ( D98 gcd C145 ) ) ) = ( ( ( D98 div ( D98 gcd C145 ) ) * ( D98 gcd C145 ) ) * ( C145 div ( D98 gcd C145 ) ) ) by L877 , INT_2:21
.= ( C145 * ( D98 div ( D98 gcd C145 ) ) ) by L1167;
L1174: ( D98 * R31 ) , ( D98 * C148 ) are_congruent_mod C145 by L1173 , L1172 , INT_1:20;
L1175: C145 divides ( ( D98 * R31 ) - ( D98 * C148 ) ) by L1174 , INT_2:15;
L1176: D98 divides ( D98 * ( R31 - C148 ) ) by INT_2:2;
L1177: ( D98 lcm C145 ) divides ( ( ( D98 * R31 ) + D99 ) - ( ( D98 * C148 ) + D99 ) ) by L1176 , L1175 , INT_2:19;
L1178: ( ( D98 * R31 ) + D99 ) , ( ( D98 * C148 ) + D99 ) are_congruent_mod ( D98 lcm C145 ) by L1177 , INT_2:15;
L1179: ( ( D98 * C148 ) + D99 ) , ( ( D98 * R31 ) + D99 ) are_congruent_mod ( D98 lcm C145 ) by L1178 , INT_1:14;
L1180: R37 , D99 are_congruent_mod D98 by L1129 , L1161;
L1181: D98 divides ( R37 - D99 ) by L1180 , INT_2:15;
L1182: ( ( R37 - D99 ) mod D98 ) = ( 0 ) by L1181 , L865;
L1183: R37 , ( ( D98 * C148 ) + D99 ) are_congruent_mod ( D98 lcm C145 ) by L1182 , L1162 , L1165;
thus L1184: thesis by L1183 , L1179 , INT_1:15;
end;
thus L1185: thesis by L1159 , L1130 , L1132;
end;
begin
definition
let C149 being Nat;
let C150 being set;
pred C150 is_CRS_of C149
means
:L1186: (ex B98 being (FinSequence of ( INT )) st (C150 = ( rng B98 ) & ( len B98 ) = C149 & (for B99 being Nat holds (B99 in ( dom B98 ) implies ( B98 . B99 ) in ( Class (( Cong C149 ) , ( B99 -' 1 )) )))))
;end;
theorem
L1188: (for R42 being (Element of ( NAT )) holds { R39 where R39 is (Element of ( NAT )) : R39 < R42 } is_CRS_of R42)
proof
let R42 being (Element of ( NAT ));
deffunc H6(Nat) = ( $1 -' 1 );
consider C151 being FinSequence such that L1189: (( len C151 ) = R42 & (for B100 being Nat holds (B100 in ( dom C151 ) implies ( C151 . B100 ) = H6(B100)))) from FINSEQ_1:sch 2;
L1190: (for B101 being Nat holds (B101 in ( dom C151 ) implies ( C151 . B101 ) in ( INT )))
proof
let C152 being Nat;
assume L1191: C152 in ( dom C151 );
L1192: ( C151 . C152 ) = H6(C152) by L1191 , L1189;
thus L1193: thesis by L1192 , INT_1:def 2;
end;
reconsider D100 = C151 as (FinSequence of ( INT )) by L1190 , FINSEQ_2:12;
L1194: { R39 where R39 is (Element of ( NAT )) : R39 < R42 } = ( rng D100 )
proof
set D101 = { R39 where R39 is (Element of ( NAT )) : R39 < R42 };
L1195: ( rng D100 ) c= D101
proof
let C153 being set;
assume L1196: C153 in ( rng D100 );
consider C154 being set such that L1197: C154 in ( dom D100 ) and L1198: C153 = ( D100 . C154 ) by L1196 , FUNCT_1:def 3;
reconsider D102 = C154 as (Element of ( NAT )) by L1197;
L1199: D102 in ( Seg R42 ) by L1189 , L1197 , FINSEQ_1:def 3;
L1200: D102 <= R42 by L1199 , FINSEQ_1:1;
L1201: ( D102 - 1 ) < R42 by L1200 , XREAL_1:147;
L1202: D102 >= 1 by L1199 , FINSEQ_1:1;
L1203: ( D102 -' 1 ) < R42 by L1202 , L1201 , XREAL_1:233;
reconsider D103 = C153 as Integer by L1198;
L1204: D103 = ( D102 -' 1 ) by L1189 , L1197 , L1198;
thus L1205: thesis by L1204 , L1203;
end;
L1206: D101 c= ( rng D100 )
proof
let C155 being set;
assume L1207: C155 in D101;
consider C156 being (Element of ( NAT )) such that L1208: C156 = C155 and L1209: C156 < R42 by L1207;
L1210: (( C156 + 1 ) >= 1 & ( C156 + 1 ) <= R42) by L1209 , NAT_1:11 , NAT_1:13;
L1211: ( C156 + 1 ) in ( dom D100 ) by L1210 , L1189 , FINSEQ_3:25;
L1212: ( D100 . ( C156 + 1 ) ) = ( ( C156 + 1 ) -' 1 ) by L1211 , L1189
.= C156 by NAT_D:34;
thus L1213: thesis by L1212 , L1208 , L1211 , FUNCT_1:def 3;
end;
thus L1214: thesis by L1206 , L1195 , XBOOLE_0:def 10;
end;
L1215: (for B102 being Nat holds (B102 in ( dom D100 ) implies ( D100 . B102 ) in ( Class (( Cong R42 ) , ( B102 -' 1 )) )))
proof
let C157 being Nat;
L1216: ( C157 -' 1 ) , ( C157 -' 1 ) are_congruent_mod R42 by INT_1:11;
L1217: [ ( C157 -' 1 ) , ( C157 -' 1 ) ] in ( Cong R42 ) by L1216 , L374;
assume L1218: C157 in ( dom D100 );
L1219: ( D100 . C157 ) = ( C157 -' 1 ) by L1218 , L1189;
thus L1220: thesis by L1219 , L1217 , EQREL_1:18;
end;
thus L1221: thesis by L1215 , L1189 , L1194 , L1186;
end;
theorem
L1222: (for R42 being (Element of ( NAT )) holds (for B103 being  finite set holds (B103 is_CRS_of R42 implies (( card B103 ) = R42 & (for B104 , B105 being Integer holds ((B104 in B103 & B105 in B103 & B104 <> B105) implies (not [ B104 , B105 ] in ( Cong R42 ))))))))
proof
let R42 being (Element of ( NAT ));
let C158 being  finite set;
assume L1223: C158 is_CRS_of R42;
consider C159 being (FinSequence of ( INT )) such that L1224: C158 = ( rng C159 ) and L1225: ( len C159 ) = R42 and L1226: (for B106 being Nat holds (B106 in ( dom C159 ) implies ( C159 . B106 ) in ( Class (( Cong R42 ) , ( B106 -' 1 )) ))) by L1223 , L1186;
L1227: (for B107 , B108 being Integer holds ((B107 in C158 & B108 in C158 & B107 <> B108) implies (not [ B107 , B108 ] in ( Cong R42 ))))
proof
let C160 , C161 being Integer;
assume that
L1228: C160 in C158
and
L1229: C161 in C158
and
L1230: C160 <> C161;
consider C162 being set such that L1231: C162 in ( dom C159 ) and L1232: C160 = ( C159 . C162 ) by L1224 , L1228 , FUNCT_1:def 3;
reconsider D104 = C162 as (Element of ( NAT )) by L1231;
L1233: C160 in ( Class (( Cong R42 ) , ( D104 -' 1 )) ) by L1226 , L1231 , L1232;
L1234: [ ( D104 -' 1 ) , C160 ] in ( Cong R42 ) by L1233 , EQREL_1:18;
L1235: ( D104 -' 1 ) , C160 are_congruent_mod R42 by L1234 , L374;
consider C163 being set such that L1236: C163 in ( dom C159 ) and L1237: C161 = ( C159 . C163 ) by L1224 , L1229 , FUNCT_1:def 3;
reconsider D105 = C163 as (Element of ( NAT )) by L1236;
L1238: D105 in ( Seg R42 ) by L1225 , L1236 , FINSEQ_1:def 3;
L1239: D105 >= 1 by L1238 , FINSEQ_1:1;
L1240: C161 in ( Class (( Cong R42 ) , ( D105 -' 1 )) ) by L1226 , L1236 , L1237;
L1241: [ ( D105 -' 1 ) , C161 ] in ( Cong R42 ) by L1240 , EQREL_1:18;
L1242: ( D105 -' 1 ) , C161 are_congruent_mod R42 by L1241 , L374;
L1243: C161 , ( D105 -' 1 ) are_congruent_mod R42 by L1242 , INT_1:14;
assume L1244: [ C160 , C161 ] in ( Cong R42 );
L1245: C160 , C161 are_congruent_mod R42 by L1244 , L374;
L1246: C160 , ( D105 -' 1 ) are_congruent_mod R42 by L1245 , L1243 , INT_1:15;
L1247: ( D104 -' 1 ) , ( D105 -' 1 ) are_congruent_mod R42 by L1246 , L1235 , INT_1:15;
L1248: R42 divides ( ( D104 -' 1 ) - ( D105 -' 1 ) ) by L1247 , INT_2:15;
L1249: D104 in ( Seg R42 ) by L1225 , L1231 , FINSEQ_1:def 3;
L1250: D104 >= 1 by L1249 , FINSEQ_1:1;
L1251: D105 <= R42 by L1238 , FINSEQ_1:1;
L1252: ( D104 - D105 ) >= ( 1 - R42 ) by L1251 , L1250 , XREAL_1:13;
L1253: ( D104 - D105 ) > ( - R42 ) by L1252 , XREAL_1:145;
L1254: D104 <= R42 by L1249 , FINSEQ_1:1;
L1255: ( D104 - D105 ) <= ( R42 - 1 ) by L1254 , L1239 , XREAL_1:13;
L1256: ( D104 - D105 ) < R42 by L1255 , XREAL_1:147;
L1257: ( abs ( D104 - D105 ) ) < R42 by L1256 , L1253 , SEQ_2:1;
L1258: ( abs ( D104 - D105 ) ) < ( abs R42 ) by L1257 , ABSVALUE:def 1;
L1259: ( ( D104 -' 1 ) - ( D105 -' 1 ) ) = ( ( D104 - 1 ) - ( D105 -' 1 ) ) by L1250 , XREAL_1:233
.= ( ( D104 - 1 ) - ( D105 - 1 ) ) by L1239 , XREAL_1:233
.= ( D104 - D105 );
L1260:
now
assume L1261: D104 <> D105;
L1262: ( D104 - D105 ) <> ( 0 ) by L1261;
thus L1263: contradiction by L1262 , L1248 , L1259 , L1258 , L125;
end;
thus L1264: contradiction by L1260 , L1230 , L1232 , L1237;
end;
L1265: (for B109 , B110 being set holds ((B109 in ( dom C159 ) & B110 in ( dom C159 ) & ( C159 . B109 ) = ( C159 . B110 )) implies B109 = B110))
proof
let C164 , C165 being set;
assume that
L1266: C164 in ( dom C159 )
and
L1267: C165 in ( dom C159 )
and
L1268: ( C159 . C164 ) = ( C159 . C165 );
reconsider D106 = C164 , D107 = C165 as (Element of ( NAT )) by L1266 , L1267;
L1269: D107 in ( Seg R42 ) by L1225 , L1267 , FINSEQ_1:def 3;
L1270: D107 >= 1 by L1269 , FINSEQ_1:1;
reconsider D108 = ( C159 . D106 ) , D109 = ( C159 . D107 ) as (Element of ( INT )) by L1266 , L1267 , FINSEQ_2:11;
L1271: ( C159 . D107 ) in ( Class (( Cong R42 ) , ( D107 -' 1 )) ) by L1226 , L1267;
L1272: [ ( D107 -' 1 ) , ( C159 . D107 ) ] in ( Cong R42 ) by L1271 , EQREL_1:18;
L1273: ( D107 -' 1 ) , D109 are_congruent_mod R42 by L1272 , L374;
L1274: D108 , ( D107 -' 1 ) are_congruent_mod R42 by L1273 , L1268 , INT_1:14;
L1275: D106 in ( Seg R42 ) by L1225 , L1266 , FINSEQ_1:def 3;
L1276: D106 >= 1 by L1275 , FINSEQ_1:1;
L1277: ( ( D106 -' 1 ) - ( D107 -' 1 ) ) = ( ( D106 - 1 ) - ( D107 -' 1 ) ) by L1276 , XREAL_1:233
.= ( ( D106 - 1 ) - ( D107 - 1 ) ) by L1270 , XREAL_1:233
.= ( D106 - D107 );
L1278: D107 <= R42 by L1269 , FINSEQ_1:1;
L1279: ( D106 - D107 ) >= ( 1 - R42 ) by L1278 , L1276 , XREAL_1:13;
L1280: ( D106 - D107 ) > ( - R42 ) by L1279 , XREAL_1:145;
L1281: D106 <= R42 by L1275 , FINSEQ_1:1;
L1282: ( D106 - D107 ) <= ( R42 - 1 ) by L1281 , L1270 , XREAL_1:13;
L1283: ( D106 - D107 ) < R42 by L1282 , XREAL_1:147;
L1284: ( abs ( D106 - D107 ) ) < R42 by L1283 , L1280 , SEQ_2:1;
L1285: ( abs ( D106 - D107 ) ) < ( abs R42 ) by L1284 , ABSVALUE:def 1;
L1286: ( C159 . D106 ) in ( Class (( Cong R42 ) , ( D106 -' 1 )) ) by L1226 , L1266;
L1287: [ ( D106 -' 1 ) , ( C159 . D106 ) ] in ( Cong R42 ) by L1286 , EQREL_1:18;
L1288: ( D106 -' 1 ) , D108 are_congruent_mod R42 by L1287 , L374;
L1289: ( D106 -' 1 ) , ( D107 -' 1 ) are_congruent_mod R42 by L1288 , L1274 , INT_1:15;
L1290: R42 divides ( D106 - D107 ) by L1289 , L1277 , INT_2:15;
L1291:
now
assume L1292: D106 <> D107;
L1293: ( D106 - D107 ) <> ( 0 ) by L1292;
thus L1294: contradiction by L1293 , L1290 , L1285 , L125;
end;
thus L1295: thesis by L1291;
end;
L1296: C159 is  one-to-one by L1265 , FUNCT_1:def 4;
thus L1297: thesis by L1296 , L1224 , L1225 , L1227 , FINSEQ_4:62;
end;
theorem
L1298: (for R42 being (Element of ( NAT )) holds (( {} ) is_CRS_of R42 iff R42 = ( 0 )))
proof
let R42 being (Element of ( NAT ));
set D110 = ( <*> ( INT ) );
thus L1299: (( {} ) is_CRS_of R42 implies R42 = ( 0 )) by L1222 , CARD_1:27;
assume L1300: R42 = ( 0 );
L1301: ( len D110 ) = R42 by L1300;
L1302: (( {} ) = ( rng D110 ) & (for B111 being Nat holds (B111 in ( dom D110 ) implies ( D110 . B111 ) in ( Class (( Cong R42 ) , ( B111 -' 1 )) ))));
thus L1303: thesis by L1302 , L1301 , L1186;
end;
theorem
L1304: (for R42 being (Element of ( NAT )) holds (for B112 being  finite set holds (( card B112 ) = R42 implies (ex B113 being FinSequence st (( len B113 ) = R42 & (for R39 being (Element of ( NAT )) holds (R39 in ( dom B113 ) implies ( B113 . R39 ) in B112)) & B113 is  one-to-one)))))
proof
let R42 being (Element of ( NAT ));
defpred S13[ Nat ] means (for B114 being  finite set holds (( card B114 ) = $1 implies (ex B115 being FinSequence st (( len B115 ) = $1 & (for R39 being (Element of ( NAT )) holds (R39 in ( dom B115 ) implies ( B115 . R39 ) in B114)) & B115 is  one-to-one))));
let C166 being  finite set;
L1305: (for R42 being (Element of ( NAT )) holds (S13[ R42 ] implies S13[ ( R42 + 1 ) ]))
proof
let R42 being (Element of ( NAT ));
assume that
L1306: S13[ R42 ];
let C167 being  finite set;
assume L1307: ( card C167 ) = ( R42 + 1 );
consider C168 being set such that L1308: C168 in C167 by L1307 , CARD_1:27 , XBOOLE_0:def 1;
set D111 = ( C167 \ { C168 } );
L1309: ( card D111 ) = ( ( card C167 ) - ( card { C168 } ) ) by L1308 , EULER_1:4
.= ( ( R42 + 1 ) - 1 ) by L1307 , CARD_1:30
.= R42;
consider C169 being FinSequence such that L1310: ( len C169 ) = R42 and L1311: (for R39 being (Element of ( NAT )) holds (R39 in ( dom C169 ) implies ( C169 . R39 ) in D111)) and L1312: C169 is  one-to-one by L1309 , L1306;
set D112 = ( C169 ^ <* C168 *> );
L1313: ( len D112 ) = ( R42 + 1 ) by L1310 , FINSEQ_2:16;
L1314: (for B116 , B117 being set holds ((B116 in ( dom D112 ) & B117 in ( dom D112 ) & B116 <> B117) implies ( D112 . B116 ) <> ( D112 . B117 )))
proof
let C170 , C171 being set;
assume that
L1315: C170 in ( dom D112 )
and
L1316: C171 in ( dom D112 )
and
L1317: C170 <> C171;
L1318: C170 in ( Seg ( R42 + 1 ) ) by L1313 , L1315 , FINSEQ_1:def 3;
L1319: C171 in ( Seg ( R42 + 1 ) ) by L1313 , L1316 , FINSEQ_1:def 3;
reconsider D113 = C170 , D114 = C171 as (Element of ( NAT )) by L1315 , L1316;
per cases  by L1318 , FINSEQ_2:7;
suppose L1320: D113 in ( Seg R42 );

per cases  by L1319 , FINSEQ_2:7;
suppose L1321: D114 in ( Seg R42 );

L1322: D114 in ( dom C169 ) by L1321 , L1310 , FINSEQ_1:def 3;
L1323: ( D112 . D114 ) = ( C169 . D114 ) by L1322 , FINSEQ_1:def 7;
L1324: D113 in ( dom C169 ) by L1310 , L1320 , FINSEQ_1:def 3;
L1325: ( D112 . D113 ) = ( C169 . D113 ) by L1324 , FINSEQ_1:def 7;
thus L1326: thesis by L1325 , L1312 , L1317 , L1324 , L1322 , L1323 , FUNCT_1:def 4;
end;
suppose L1327: D114 = ( R42 + 1 );

L1328: D113 in ( dom C169 ) by L1310 , L1320 , FINSEQ_1:def 3;
L1329: (( C169 . D113 ) in D111 & ( D112 . D113 ) = ( C169 . D113 )) by L1328 , L1311 , FINSEQ_1:def 7;
L1330: (not ( D112 . D113 ) in { C168 }) by L1329 , XBOOLE_0:def 5;
L1331: ( D112 . D114 ) = C168 by L1310 , L1327 , FINSEQ_1:42;
thus L1332: thesis by L1331 , L1330 , TARSKI:def 1;
end;
end;
suppose L1334: D113 = ( R42 + 1 );

L1335: D114 in ( Seg R42 ) by L1334 , L1317 , L1319 , FINSEQ_2:7;
L1336: D114 in ( dom C169 ) by L1335 , L1310 , FINSEQ_1:def 3;
L1337: (( C169 . D114 ) in D111 & ( D112 . D114 ) = ( C169 . D114 )) by L1336 , L1311 , FINSEQ_1:def 7;
L1338: (not ( D112 . D114 ) in { C168 }) by L1337 , XBOOLE_0:def 5;
L1339: ( D112 . D114 ) <> C168 by L1338 , TARSKI:def 1;
thus L1340: thesis by L1339 , L1310 , L1334 , FINSEQ_1:42;
end;
end;
L1342: (for B118 , B119 being set holds ((B118 in ( dom D112 ) & B119 in ( dom D112 ) & ( D112 . B118 ) = ( D112 . B119 )) implies B118 = B119)) by L1314;
take D112;
L1343: (for R39 being (Element of ( NAT )) holds (R39 in ( dom D112 ) implies ( D112 . R39 ) in C167))
proof
let R39 being (Element of ( NAT ));
assume L1344: R39 in ( dom D112 );
L1345: R39 in ( Seg ( R42 + 1 ) ) by L1344 , L1313 , FINSEQ_1:def 3;
per cases  by L1345 , FINSEQ_2:7;
suppose L1346: R39 in ( Seg R42 );

L1347: R39 in ( dom C169 ) by L1346 , L1310 , FINSEQ_1:def 3;
L1348: ( D112 . R39 ) = ( C169 . R39 ) by L1347 , FINSEQ_1:def 7;
L1349: ( D112 . R39 ) in D111 by L1348 , L1311 , L1347;
thus L1350: thesis by L1349;
end;
suppose L1351: R39 = ( R42 + 1 );

thus L1352: thesis by L1351 , L1308 , L1310 , FINSEQ_1:42;
end;
end;
thus L1354: thesis by L1343 , L1310 , L1342 , FINSEQ_2:16 , FUNCT_1:def 4;
end;
L1355: S13[ ( 0 ) ]
proof
set D115 = ( <*> ( NAT ) );
let C172 being  finite set;
assume L1356: ( card C172 ) = ( 0 );
take D115;
thus L1357: ( len D115 ) = ( 0 );
thus L1358: thesis;
end;
L1359: (for R42 being (Element of ( NAT )) holds S13[ R42 ]) from NAT_1:sch 1(L1355 , L1305);
thus L1360: thesis by L1359;
end;
theorem
L1361: (for R42 being (Element of ( NAT )) holds (for B120 being  finite (Subset of ( INT )) holds ((( card B120 ) = R42 & (for B121 , B122 being Integer holds ((B121 in B120 & B122 in B120 & B121 <> B122) implies (not [ B121 , B122 ] in ( Cong R42 ))))) implies B120 is_CRS_of R42)))
proof
let R42 being (Element of ( NAT ));
let C173 being  finite (Subset of ( INT ));
assume that
L1362: ( card C173 ) = R42
and
L1363: (for B123 , B124 being Integer holds ((B123 in C173 & B124 in C173 & B123 <> B124) implies (not [ B123 , B124 ] in ( Cong R42 ))));
per cases ;
suppose L1364: C173 is  empty;

thus L1365: thesis by L1364 , L1362 , L1298 , CARD_1:27;
end;
suppose L1366: C173 is non  empty;

reconsider D116 = C173 as non  empty  finite (Subset of ( INT )) by L1366;
defpred S14[ Nat , set ] means $2 in ( Class (( Cong R42 ) , ( $1 -' 1 )) );
L1367: D116 <> ( {} );
L1368: (for B125 being Nat holds (B125 in ( Seg R42 ) implies (ex B126 being (Element of D116) st S14[ B125 , B126 ])))
proof
set D117 = ( Segm R42 );
let C174 being Nat;
assume that
L1369: C174 in ( Seg R42 );
L1370: C174 <= R42 by L1369 , FINSEQ_1:1;
L1371: ( C174 - 1 ) < R42 by L1370 , XREAL_1:147;
consider C175 being FinSequence such that L1372: ( len C175 ) = R42 and L1373: (for R40 being (Element of ( NAT )) holds (R40 in ( dom C175 ) implies ( C175 . R40 ) in D116)) and L1374: C175 is  one-to-one by L1362 , L1304;
L1375: (for B127 being Nat holds (B127 in ( dom C175 ) implies ( C175 . B127 ) in D116)) by L1373;
reconsider D118 = C175 as (FinSequence of D116) by L1375 , FINSEQ_2:12;
defpred S15[ Nat , set ] means ( D118 . $1 ) in ( Class (( Cong R42 ) , $2) );
L1376: (for R41 being (Element of ( NAT )) holds (R41 in ( Seg R42 ) implies (ex B128 being (Element of D117) st S15[ R41 , B128 ])))
proof
let R41 being (Element of ( NAT ));
assume L1377: R41 in ( Seg R42 );
consider C176 , C177 being Integer such that L1378: ( D118 . R41 ) = ( ( R42 * C176 ) + C177 ) and L1379: C177 >= ( 0 ) and L1380: C177 < R42 by L1362 , L177;
L1381: ( ( D118 . R41 ) mod R42 ) = ( C177 mod R42 ) by L1378 , NAT_D:61;
L1382: C177 , ( D118 . R41 ) are_congruent_mod R42 by L1381 , L1362 , NAT_D:64;
L1383: [ C177 , ( D118 . R41 ) ] in ( Cong R42 ) by L1382 , L374;
reconsider D119 = C177 as (Element of ( NAT )) by L1379 , INT_1:3;
reconsider D120 = D119 as (Element of D117) by L1380 , NAT_1:44;
take D120;
thus L1384: thesis by L1383 , EQREL_1:18;
end;
reconsider D121 = D117 as non  empty set by L1362 , L1367;
L1385: (for B129 being Nat holds (B129 in ( Seg R42 ) implies (ex B130 being (Element of D121) st S15[ B129 , B130 ]))) by L1376;
consider C178 being (FinSequence of D121) such that L1386: (( dom C178 ) = ( Seg R42 ) & (for B131 being Nat holds (B131 in ( Seg R42 ) implies S15[ B131 , ( C178 . B131 ) ]))) from FINSEQ_1:sch 5(L1385);
L1387: (for B132 , B133 being set holds ((B132 in ( dom C178 ) & B133 in ( dom C178 ) & ( C178 . B132 ) = ( C178 . B133 )) implies B132 = B133))
proof
let C179 , C180 being set;
assume that
L1388: C179 in ( dom C178 )
and
L1389: C180 in ( dom C178 )
and
L1390: ( C178 . C179 ) = ( C178 . C180 );
L1391: (( D118 . C179 ) in ( Class (( Cong R42 ) , ( C178 . C179 )) ) & ( D118 . C180 ) in ( Class (( Cong R42 ) , ( C178 . C179 )) )) by L1386 , L1388 , L1389 , L1390;
L1392: [ ( D118 . C179 ) , ( D118 . C180 ) ] in ( Cong R42 ) by L1391 , EQREL_1:22;
assume L1393: C179 <> C180;
reconsider D122 = C179 , D123 = C180 as (Element of ( NAT )) by L1388 , L1389;
L1394: D122 in ( dom D118 ) by L1372 , L1386 , L1388 , FINSEQ_1:def 3;
L1395: ( D118 . D122 ) in D116 by L1394 , FINSEQ_2:11;
L1396: D123 in ( dom D118 ) by L1372 , L1386 , L1389 , FINSEQ_1:def 3;
L1397: ( D118 . D123 ) in D116 by L1396 , FINSEQ_2:11;
L1398: ( D118 . D122 ) <> ( D118 . D123 ) by L1374 , L1393 , L1394 , L1396 , FUNCT_1:def 4;
thus L1399: contradiction by L1398 , L1363 , L1392 , L1395 , L1397;
end;
L1400: C178 is  one-to-one by L1387 , FUNCT_1:def 4;
L1401: ( card ( rng C178 ) ) = ( len C178 ) by L1400 , FINSEQ_4:62
.= R42 by L1386 , FINSEQ_1:def 3;
reconsider D124 = D121 as  finite set;
L1402: C174 >= 1 by L1369 , FINSEQ_1:1;
L1403: ( C174 -' 1 ) < R42 by L1402 , L1371 , XREAL_1:233;
L1404: ( C174 -' 1 ) in D124 by L1403 , NAT_1:44;
L1405: R42 = { B134 where B134 is (Element of ( NAT )) : B134 < R42 } by AXIOMS:4;
L1406: D124 is_CRS_of R42 by L1405 , L1188;
L1407: ( card D124 ) = R42 by L1406 , L1222;
L1408: ( rng C178 ) = D124 by L1407 , L1401 , CARD_FIN:1;
consider C181 being set such that L1409: C181 in ( dom C178 ) and L1410: ( C178 . C181 ) = ( C174 -' 1 ) by L1408 , L1404 , FUNCT_1:def 3;
reconsider D125 = C181 as (Element of ( NAT )) by L1409;
L1411: D125 in ( dom D118 ) by L1372 , L1386 , L1409 , FINSEQ_1:def 3;
reconsider D126 = ( D118 . D125 ) as (Element of D116) by L1411 , FINSEQ_2:11;
take D126;
thus L1412: thesis by L1386 , L1409 , L1410;
end;
consider C182 being (FinSequence of D116) such that L1413: (( dom C182 ) = ( Seg R42 ) & (for B135 being Nat holds (B135 in ( Seg R42 ) implies S14[ B135 , ( C182 . B135 ) ]))) from FINSEQ_1:sch 5(L1368);
L1414: ( rng C182 ) c= D116 by FINSEQ_1:def 4;
L1415: ( len C182 ) = R42 by L1413 , FINSEQ_1:def 3;
L1416: (for B136 , B137 being set holds ((B136 in ( dom C182 ) & B137 in ( dom C182 ) & ( C182 . B136 ) = ( C182 . B137 )) implies B136 = B137))
proof
let C183 , C184 being set;
assume that
L1417: C183 in ( dom C182 )
and
L1418: C184 in ( dom C182 )
and
L1419: ( C182 . C183 ) = ( C182 . C184 );
reconsider D127 = C183 , D128 = C184 as (Element of ( NAT )) by L1417 , L1418;
L1420: D128 >= 1 by L1413 , L1418 , FINSEQ_1:1;
L1421: D127 >= 1 by L1413 , L1417 , FINSEQ_1:1;
L1422: ( ( D127 -' 1 ) - ( D128 -' 1 ) ) = ( ( D127 - 1 ) - ( D128 -' 1 ) ) by L1421 , XREAL_1:233
.= ( ( D127 - 1 ) - ( D128 - 1 ) ) by L1420 , XREAL_1:233
.= ( D127 - D128 );
reconsider D129 = ( C182 . D127 ) , D130 = ( C182 . D128 ) as (Element of ( INT )) by L1417 , L1418 , FINSEQ_2:11;
L1423: ( C182 . D128 ) in ( Class (( Cong R42 ) , ( D128 -' 1 )) ) by L1413 , L1418;
L1424: [ ( D128 -' 1 ) , ( C182 . D128 ) ] in ( Cong R42 ) by L1423 , EQREL_1:18;
L1425: ( D128 -' 1 ) , D130 are_congruent_mod R42 by L1424 , L374;
L1426: D129 , ( D128 -' 1 ) are_congruent_mod R42 by L1425 , L1419 , INT_1:14;
L1427: D128 <= R42 by L1413 , L1418 , FINSEQ_1:1;
L1428: ( D127 - D128 ) >= ( 1 - R42 ) by L1427 , L1421 , XREAL_1:13;
L1429: ( D127 - D128 ) > ( - R42 ) by L1428 , XREAL_1:145;
L1430: D127 <= R42 by L1413 , L1417 , FINSEQ_1:1;
L1431: ( D127 - D128 ) <= ( R42 - 1 ) by L1430 , L1420 , XREAL_1:13;
L1432: ( D127 - D128 ) < R42 by L1431 , XREAL_1:147;
L1433: ( abs ( D127 - D128 ) ) < R42 by L1432 , L1429 , SEQ_2:1;
L1434: ( abs ( D127 - D128 ) ) < ( abs R42 ) by L1433 , ABSVALUE:def 1;
L1435: ( C182 . D127 ) in ( Class (( Cong R42 ) , ( D127 -' 1 )) ) by L1413 , L1417;
L1436: [ ( D127 -' 1 ) , ( C182 . D127 ) ] in ( Cong R42 ) by L1435 , EQREL_1:18;
L1437: ( D127 -' 1 ) , D129 are_congruent_mod R42 by L1436 , L374;
L1438: ( D127 -' 1 ) , ( D128 -' 1 ) are_congruent_mod R42 by L1437 , L1426 , INT_1:15;
L1439: R42 divides ( D127 - D128 ) by L1438 , L1422 , INT_2:15;
L1440:
now
assume L1441: D127 <> D128;
L1442: ( D127 - D128 ) <> ( 0 ) by L1441;
thus L1443: contradiction by L1442 , L1439 , L1434 , L125;
end;
thus L1444: thesis by L1440;
end;
L1445: C182 is  one-to-one by L1416 , FUNCT_1:def 4;
L1446: ( card D116 ) = ( card ( rng C182 ) ) by L1445 , L1362 , L1415 , FINSEQ_4:62;
L1447: D116 = ( rng C182 ) by L1446 , L1414 , CARD_FIN:1;
thus L1448: thesis by L1447 , L1413 , L1415 , L1186;
end;
end;
theorem
L1450: (for R42 being (Element of ( NAT )) holds (for R43 being Integer holds (for B138 being  finite (Subset of ( INT )) holds (B138 is_CRS_of R42 implies ( R43 ++ B138 ) is_CRS_of R42))))
proof
let R42 being (Element of ( NAT ));
let R43 being Integer;
let C185 being  finite (Subset of ( INT ));
assume L1451: C185 is_CRS_of R42;
L1452: ( card C185 ) = R42 by L1451 , L1222;
L1453: ( card ( R43 ++ C185 ) ) = R42 by L1452 , L26;
L1454: (for B139 , B140 being Integer holds ((B139 in ( R43 ++ C185 ) & B140 in ( R43 ++ C185 ) & B139 <> B140) implies (not [ B139 , B140 ] in ( Cong R42 ))))
proof
let C186 , C187 being Integer;
assume that
L1455: C186 in ( R43 ++ C185 )
and
L1456: C187 in ( R43 ++ C185 )
and
L1457: C186 <> C187;
consider C188 being (Element of ( COMPLEX )) such that L1458: C186 = ( R43 + C188 ) and L1459: C188 in C185 by L1455 , MEMBER_1:143;
consider C189 being (Element of ( COMPLEX )) such that L1460: C187 = ( R43 + C189 ) and L1461: C189 in C185 by L1456 , MEMBER_1:143;
reconsider D131 = C188 , D132 = C189 as Integer by L1459 , L1461;
assume L1462: [ C186 , C187 ] in ( Cong R42 );
L1463: C186 , C187 are_congruent_mod R42 by L1462 , L374;
L1464: R42 divides ( ( R43 + D131 ) - ( R43 + D132 ) ) by L1463 , L1458 , L1460 , INT_2:15;
L1465: R42 divides ( D131 - D132 ) by L1464;
L1466: D131 , D132 are_congruent_mod R42 by L1465 , INT_2:15;
L1467: (not [ D131 , D132 ] in ( Cong R42 )) by L1451 , L1457 , L1459 , L1458 , L1461 , L1460 , L1222;
thus L1468: contradiction by L1467 , L1466 , L374;
end;
L1469: ( R43 ++ C185 ) is (Subset of ( INT )) by L29;
thus L1470: thesis by L1469 , L1453 , L1454 , L1361;
end;
theorem
L1471: (for R42 being (Element of ( NAT )) holds (for R43 being Integer holds (for B141 being  finite (Subset of ( INT )) holds ((R43 , R42 are_relative_prime  & B141 is_CRS_of R42) implies ( R43 ** B141 ) is_CRS_of R42))))
proof
let R42 being (Element of ( NAT ));
let R43 being Integer;
let C190 being  finite (Subset of ( INT ));
assume that
L1472: R43 , R42 are_relative_prime 
and
L1473: C190 is_CRS_of R42;
L1474: ( card C190 ) = R42 by L1473 , L1222;
L1475: ( R43 ** C190 ) c= ( INT ) by L35;
per cases ;
suppose L1476: R43 = ( 0 );

L1477: ( R43 gcd R42 ) = ( abs R42 ) by L1476 , WSIERP_1:8
.= R42 by ABSVALUE:def 1;
L1478: R42 = 1 by L1477 , L1472 , INT_2:def 3;
L1479: (ex B142 being set st C190 = { B142 }) by L1478 , L1474 , CARD_2:42;
L1480: ( R43 ** C190 ) = { ( 0 ) } by L1479 , L1476 , L72;
L1481: (for B143 , B144 being Integer holds ((B143 in ( R43 ** C190 ) & B144 in ( R43 ** C190 ) & B143 <> B144) implies (not [ B143 , B144 ] in ( Cong R42 ))))
proof
let C191 , C192 being Integer;
assume that
L1482: C191 in ( R43 ** C190 )
and
L1483: (C192 in ( R43 ** C190 ) & C191 <> C192);
assume L1484: [ C191 , C192 ] in ( Cong R42 );
L1485: C191 = ( 0 ) by L1480 , L1482 , TARSKI:def 1;
thus L1486: contradiction by L1485 , L1480 , L1483 , TARSKI:def 1;
end;
L1487: ( card ( R43 ** C190 ) ) = R42 by L1478 , L1480 , CARD_2:42;
thus L1488: thesis by L1487 , L1475 , L1481 , L1361;
end;
suppose L1489: R43 <> ( 0 );

L1490: (for B145 , B146 being Integer holds ((B145 in ( R43 ** C190 ) & B146 in ( R43 ** C190 ) & B145 <> B146) implies (not [ B145 , B146 ] in ( Cong R42 ))))
proof
let C193 , C194 being Integer;
assume that
L1491: C193 in ( R43 ** C190 )
and
L1492: C194 in ( R43 ** C190 )
and
L1493: C193 <> C194;
consider C195 being Integer such that L1494: C195 in C190 and L1495: C194 = ( R43 * C195 ) by L1492 , L41;
consider C196 being Integer such that L1496: C196 in C190 and L1497: C193 = ( R43 * C196 ) by L1491 , L41;
L1498: (not [ C196 , C195 ] in ( Cong R42 )) by L1473 , L1493 , L1496 , L1497 , L1494 , L1495 , L1222;
L1499: (not C196 , C195 are_congruent_mod R42) by L1498 , L374;
assume L1500: [ C193 , C194 ] in ( Cong R42 );
L1501: ( R43 * C196 ) , ( R43 * C195 ) are_congruent_mod R42 by L1500 , L1497 , L1495 , L374;
thus L1502: contradiction by L1501 , L1472 , L1499 , L151;
end;
L1503: ( card ( R43 ** C190 ) ) = R42 by L1474 , L1489 , L100;
thus L1504: thesis by L1503 , L1475 , L1490 , L1361;
end;
end;
