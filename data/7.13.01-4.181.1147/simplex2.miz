:: Brouwer Fixed Point Theorem for Simplexes
::  by Karol P\kak
::
:: Received December 21, 2010
:: Copyright (c) 2010-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies ABIAN, AOFA_I00, ARYTM_1, ARYTM_3, CARD_1, CARD_3, CLASSES1,
      COMPLEX1, CONVEX1, EUCLID, EUCLID_9, FINSEQ_1, FINSEQ_2, FINSEQ_4,
      FINSET_1, FUNCOP_1, FUNCT_1, FUNCT_2, FUNCT_4, GLIB_000, INT_1, MATROID0,
      MEASURE5, MEMBERED, METRIC_1, NAT_1, NEWTON, NUMBERS, ORDERS_1, ORDINAL1,
      ORDINAL2, ORDINAL4, PARTFUN1, PCOMPS_1, PEPIN, POWER, PRE_TOPC, QC_LANG1,
      RCOMP_1, REAL_1, RELAT_1, RLAFFIN1, RLAFFIN2, RLVECT_1, RLVECT_2,
      RLVECT_5, RUSUB_4, SEMI_AF1, SEQ_4, SETFAM_1, SGRAPH1, SIMPLEX0,
      SIMPLEX1, SQUARE_1, STRUCT_0, SUBSET_1, SUPINF_2, TARSKI, TOPDIM_1,
      TOPMETR, TOPS_1, TOPS_2, VALUED_1, WEIERSTR, XBOOLE_0, XREAL_0, XXREAL_0,
      XXREAL_1, XXREAL_2, ZFMISC_1, SIMPLEX2;
 notations TARSKI, XBOOLE_0, SUBSET_1, ORDINAL1, ZFMISC_1, RELAT_1, FUNCT_1,
      RELSET_1, FUNCT_2, PARTFUN1, FUNCOP_1, FUNCT_4, XXREAL_3, VALUED_1,
      PRE_TOPC, NUMBERS, XREAL_0, FINSEQ_1, BINOP_1, FINSEQ_2, TOPMETR,
      METRIC_1, EUCLID, FINSET_1, XXREAL_0, REAL_1, SETFAM_1, TOPS_2, INT_1,
      STRUCT_0, COMPTS_1, PCOMPS_1, RCOMP_1, WEIERSTR, SEQ_4, XXREAL_2,
      RVSUM_1, RLVECT_1, RUSUB_4, RLVECT_5, SIMPLEX0, RLAFFIN1, RLAFFIN2,
      SIMPLEX1, ORDERS_1, CARD_1, DOMAIN_1, PENCIL_1, CLASSES1, RLTOPSP1,
      MATROID0, TBSP_1, MEMBERED, RLVECT_2, CONVEX1, TOPREAL9, COMPLEX1,
      NEWTON, POWER, SQUARE_1, BORSUK_1, CARD_3, EUCLID_9, TMAP_1, FINSEQOP,
      ABIAN, TOPDIM_1, TOPDIM_2, RLAFFIN3;
 constructors ABIAN, BINOP_2, COMPTS_1, CONVEX1, EUCLID_9, FINSEQOP, FUNCSDOM,
      MONOID_0, NEWTON, POWER, REAL_1, RFINSEQ2, RLAFFIN1, RLAFFIN2, RLAFFIN3,
      RLVECT_5, RUSUB_5, SEQ_1, SEQ_4, SIMPLEX1, SQUARE_1, TBSP_1, TMAP_1,
      TOPDIM_1, TOPDIM_2, TOPREAL9, TOPS_2, WAYBEL23, WEIERSTR;
 registrations ASYMPT_0, BORSUK_1, BORSUK_2, CARD_1, COMPTS_1, EUCLID,
      EUCLID_9, FINSEQ_1, FINSEQ_2, FINSET_1, FUNCT_1, FUNCT_2, INT_1,
      JORDAN2B, JORDAN2C, MEMBERED, METRIZTS, MONOID_0, NAT_1, NEWTON, NUMBERS,
      PCOMPS_1, PRE_TOPC, RELAT_1, RELSET_1, RLAFFIN1, RLAFFIN3, SEQ_4,
      SIMPLEX0, SIMPLEX1, STRUCT_0, SUBSET_1, TBSP_1, TMAP_1, TOPDIM_1,
      TOPDIM_2, TOPMETR, TOPREAL9, TOPREALC, TOPS_1, VALUED_0, VALUED_1,
      XBOOLE_0, XREAL_0, XXREAL_0, XXREAL_2, XXREAL_3, YELLOW13, JORDAN,
      ORDINAL1;
 requirements REAL, SUBSET, NUMERALS, ARITHM, BOOLE;
 definitions EUCLID, METRIC_1, ORDINAL1, PCOMPS_1, RLVECT_1, SIMPLEX0,
      SIMPLEX1, STRUCT_0, SUBSET_1, TARSKI, TBSP_1, XCMPLX_0;
 theorems ABIAN, ABSVALUE, BINOP_1, BORSUK_1, BORSUK_3, BORSUK_5, CARD_1,
      CARD_2, CLASSES1, COMPTS_1, CONVEX1, EUCLID, EUCLID_9, FINSEQ_1,
      FINSEQ_2, FINSEQ_3, FINSEQ_4, FUNCOP_1, FUNCT_1, FUNCT_2, FUNCT_4,
      HAUSDORF, INT_1, JORDAN1K, JORDAN2B, JORDAN2C, MATROID0, MEMBERED,
      METRIC_1, NAT_1, NEWTON, ORDERS_1, ORDINAL1, PARTFUN1, PCOMPS_1,
      PCOMPS_2, POWER, PRE_TOPC, RCOMP_1, RELAT_1, RLAFFIN1, RLAFFIN2,
      RLAFFIN3, RLVECT_1, RLVECT_2, RLVECT_3, RUSUB_4, RVSUM_1, SETFAM_1,
      SIMPLEX0, SIMPLEX1, TARSKI, TBSP_1, TMAP_1, TOPDIM_1, TOPDIM_2, TOPGEN_5,
      TOPGRP_1, TOPMETR, TOPREAL3, TOPREAL6, TOPREAL7, TOPREAL9, TOPREALC,
      TOPS_1, TOPS_2, TOPS_3, TSEP_1, VALUED_1, WEIERSTR, XBOOLE_0, XBOOLE_1,
      XCMPLX_1, XREAL_0, XREAL_1, XXREAL_0, XXREAL_1, XXREAL_2, XXREAL_3,
      ZFMISC_1, JORDAN5A;
 schemes FINSEQ_1, FRAENKEL, FUNCT_2, NAT_1, NAT_2, SUBSET_1;

begin
definition
let R1 being non  empty MetrSpace;
assume that
L1: ( TopSpaceMetr R1 ) is  compact;
let C1 being (Subset-Family of ( TopSpaceMetr R1 ));
assume that
L2: C1 is  open
and
L3: C1 is (Cover of ( TopSpaceMetr R1 ));
mode Lebesgue_number of C1
 ->  positive Real
means :L4: (for B1 being (Point of R1) holds (ex B2 being (Subset of ( TopSpaceMetr R1 )) st (B2 in C1 & ( Ball (B1 , it) ) c= B2)));
existence
proof
set D1 = ( TopSpaceMetr R1 );
consider C2 being (Subset-Family of D1) such that L5: C2 c= C1 and L6: C2 is (Cover of D1) and L7: C2 is  finite by L1 , L2 , L3 , COMPTS_1:def 1;
per cases ;
suppose L8: ( [#] D1 ) in C2;

take D2 = 1;
let C3 being (Point of R1);
take ( [#] D1 );
thus L9: thesis by L5 , L8;
end;
suppose L10: (not ( [#] D1 ) in C2);

set D3 = ( [#] D1 );
set D4 = ( Funcs (( [#] D1 ) , ( REAL )) );
consider C4 being FinSequence such that L11: ( rng C4 ) = C2 and L12: C4 is  one-to-one by L7 , FINSEQ_4:58;
defpred S1[ Nat , set , set ] means (for B3 , B4 being (Function of D1 , ( R^1 )) holds ((B3 = $2 & B4 = $3 & B3 is  continuous) implies (B4 is  continuous & (ex B5 being non  empty (Subset of D1) st (( B5 ` ) = ( C4 . ( $1 + 1 ) ) & (for B6 being (Point of D1) holds ( B4 . B6 ) = ( max (( B3 . B6 ) , ( ( dist_min B5 ) . B6 )) )))))));
L13: ( union C2 ) is non  empty by L6 , SETFAM_1:45;
L14: C4 is non  empty by L13 , L11 , ZFMISC_1:2;
L15: ( len C4 ) >= 1 by L14 , NAT_1:14;
L16: 1 in ( dom C4 ) by L15 , FINSEQ_3:25;
L17: ( C4 . 1 ) in ( rng C4 ) by L16 , FUNCT_1:def 3;
reconsider D5 = ( C4 . 1 ) as (Subset of D1) by L17 , L11;
L18: ( ( D5 ` ) ` ) <> ( [#] D1 ) by L10 , L11 , L16 , FUNCT_1:def 3;
L19: D5 is  open by L2 , L5 , L11 , L17 , TOPS_2:def 1;
reconsider D6 = ( D5 ` ) as non  empty  closed (Subset of D1) by L19 , L18;
reconsider D7 = ( dist_min D6 ) as (Element of D4) by FUNCT_2:8 , TOPMETR:17;
L20: (for B7 being Nat holds ((1 <= B7 & B7 < ( len C4 )) implies (for B8 being (Element of D4) holds (ex B9 being (Element of D4) st S1[ B7 , B8 , B9 ]))))
proof
let C5 being Nat;
assume that
L21: 1 <= C5
and
L22: C5 < ( len C4 );
let C6 being (Element of D4);
reconsider D8 = C6 as (Function of D1 , ( R^1 )) by TOPMETR:17;
per cases ;
suppose L23: (not D8 is  continuous);

take D9 = C6;
thus L24: thesis by L23;
end;
suppose L25: D8 is  continuous;

L26: (1 <= ( C5 + 1 ) & ( C5 + 1 ) <= ( len C4 )) by L22 , NAT_1:11 , NAT_1:13;
L27: ( C5 + 1 ) in ( dom C4 ) by L26 , FINSEQ_3:25;
L28: ( C4 . ( C5 + 1 ) ) in C2 by L27 , L11 , FUNCT_1:def 3;
reconsider D10 = ( C4 . ( C5 + 1 ) ) as (Subset of D1) by L28;
L29: ( ( D10 ` ) ` ) <> ( [#] D1 ) by L10 , L11 , L27 , FUNCT_1:def 3;
reconsider D11 = ( D10 ` ) as non  empty (Subset of D1) by L29;
L30: ( R^1 ) is (SubSpace of ( R^1 )) by TSEP_1:2;
consider C7 being  continuous (Function of D1 , ( R^1 )) such that L31: (for B10 being (Point of D1) holds ( C7 . B10 ) = ( max (( D8 . B10 ) , ( ( dist_min D11 ) . B10 )) )) by L30 , L25 , TOPGEN_5:50;
reconsider D12 = C7 as (Element of D4) by FUNCT_2:8 , TOPMETR:17;
take D12;
let C8 , C9 being (Function of D1 , ( R^1 ));
assume that
L32: C8 = C6
and
L33: C9 = D12
and
L34: C8 is  continuous;
thus L35: C9 is  continuous by L33;
take D11;
thus L36: thesis by L31 , L32 , L33;
end;
end;
consider C10 being (FinSequence of D4) such that L38: ( len C10 ) = ( len C4 ) and L39: (( C10 /. 1 ) = D7 or ( len C4 ) = ( 0 )) and L40: (for B11 being Nat holds ((1 <= B11 & B11 < ( len C4 )) implies S1[ B11 , ( C10 /. B11 ) , ( C10 /. ( B11 + 1 ) ) ])) from NAT_2:sch 1(L20);
L41: ( len C10 ) in ( dom C10 ) by L15 , L38 , FINSEQ_3:25;
L42: ( C10 /. ( len C10 ) ) is (Element of D4);
reconsider D13 = ( C10 /. ( len C10 ) ) as (Function of D1 , ( R^1 )) by L42 , TOPMETR:17;
reconsider D14 = ( rng D13 ) as (Subset of ( R^1 )) by RELAT_1:def 19;
set D15 = ( [#] D14 );
L43: D15 = ( rng D13 ) by WEIERSTR:def 1;
L44: ( dom C10 ) = ( dom C4 ) by L38 , FINSEQ_3:29;
defpred S2[ Nat ] means (for B12 being (Function of D1 , ( R^1 )) holds (($1 in ( dom C10 ) & B12 = ( C10 /. $1 )) implies (B12 is  continuous & (for B13 being Nat holds (for B14 being (Function of D1 , ( R^1 )) holds ((B13 <= $1 & B13 in ( dom C10 ) & B14 = ( C10 /. B13 )) implies (for B15 being (Point of D1) holds ( B14 . B15 ) <= ( B12 . B15 ))))))));
L45: (for B16 being Nat holds (S2[ B16 ] implies S2[ ( B16 + 1 ) ]))
proof
let C11 being Nat;
assume L46: S2[ C11 ];
let C12 being (Function of D1 , ( R^1 ));
assume that
L47: ( C11 + 1 ) in ( dom C10 )
and
L48: C12 = ( C10 /. ( C11 + 1 ) );
per cases ;
suppose L49: C11 = ( 0 );

thus L50: C12 is  continuous by L49 , L14 , L39 , L48;
let C13 being Nat;
let C14 being (Function of D1 , ( R^1 ));
assume that
L51: C13 <= ( C11 + 1 )
and
L52: C13 in ( dom C10 )
and
L53: C14 = ( C10 /. C13 );
L54: 1 <= C13 by L52 , FINSEQ_3:25;
thus L55: thesis by L54 , L48 , L49 , L51 , L53 , XXREAL_0:1;
end;
suppose L56: C11 > ( 0 );

reconsider D16 = ( C11 - 1 ) as (Element of ( NAT )) by L56 , NAT_1:20;
L57: ( C10 /. C11 ) is (Element of D4);
reconsider D17 = ( C10 /. C11 ) as (Function of D1 , ( R^1 )) by L57 , TOPMETR:17;
L58: ( C11 + 1 ) <= ( len C10 ) by L47 , FINSEQ_3:25;
L59: (1 <= ( D16 + 1 ) & C11 < ( len C10 )) by L58 , NAT_1:11 , NAT_1:13;
L60: C11 in ( dom C10 ) by L59 , FINSEQ_3:25;
L61: D17 is  continuous by L60 , L46;
thus L62: C12 is  continuous by L61 , L38 , L40 , L48 , L59;
consider C15 being non  empty (Subset of D1) such that L63: ( C15 ` ) = ( C4 . ( C11 + 1 ) ) and L64: (for B17 being (Point of D1) holds ( C12 . B17 ) = ( max (( D17 . B17 ) , ( ( dist_min C15 ) . B17 )) )) by L38 , L40 , L48 , L59 , L61;
let C16 being Nat;
let C17 being (Function of D1 , ( R^1 ));
assume that
L65: C16 <= ( C11 + 1 )
and
L66: C16 in ( dom C10 )
and
L67: C17 = ( C10 /. C16 );
let C18 being (Point of D1);
L68: ( C12 . C18 ) = ( max (( D17 . C18 ) , ( ( dist_min C15 ) . C18 )) ) by L64;
per cases  by L65 , NAT_1:8;
suppose L69: C16 <= C11;

L70: ( D17 . C18 ) <= ( C12 . C18 ) by L68 , XXREAL_0:25;
L71: ( C17 . C18 ) <= ( D17 . C18 ) by L46 , L60 , L66 , L67 , L69;
thus L72: thesis by L71 , L70 , XXREAL_0:2;
end;
suppose L73: C16 = ( C11 + 1 );

thus L74: thesis by L73 , L48 , L67;
end;
end;
end;
L77: S2[ ( 0 ) ] by FINSEQ_3:25;
L78: (for B18 being Nat holds S2[ B18 ]) from NAT_1:sch 2(L77 , L45);
L79: ( dom D13 ) = D3 by FUNCT_2:def 1;
L80: ( D13 .: D3 ) = ( rng D13 ) by L79 , RELAT_1:113;
L81: D14 is  compact by L80 , L1 , L41 , L78 , WEIERSTR:9;
L82: D15 is  compact by L81 , WEIERSTR:13;
reconsider D18 = D15 as non  empty  real-bounded (Subset of ( REAL )) by L81 , WEIERSTR:11 , WEIERSTR:def 1;
set D19 = ( lower_bound D18 );
L83: D19 in D18 by L82 , RCOMP_1:14;
consider C19 being set such that L84: C19 in ( dom D13 ) and L85: ( D13 . C19 ) = D19 by L83 , L43 , FUNCT_1:def 3;
L86: ( union C2 ) = ( [#] D1 ) by L6 , SETFAM_1:45;
consider C20 being set such that L87: C19 in C20 and L88: C20 in ( rng C4 ) by L86 , L11 , L84 , TARSKI:def 4;
reconsider D20 = C19 as (Point of D1) by L84;
consider C21 being set such that L89: C21 in ( dom C4 ) and L90: ( C4 . C21 ) = C20 by L88 , FUNCT_1:def 3;
reconsider D21 = C21 as Nat by L89;
L91: D21 <= ( len C4 ) by L89 , FINSEQ_3:25;
L92: 1 <= D21 by L89 , FINSEQ_3:25;
L93:
now
per cases  by L92 , XXREAL_0:1;
suppose L94: D21 = 1;

L95: (not D20 in D6) by L94 , L87 , L90 , XBOOLE_0:def 5;
L96: ( ( dist_min D6 ) . D20 ) <> ( 0 ) by L95 , HAUSDORF:9;
L97: ( ( dist_min D6 ) . D20 ) > ( 0 ) by L96 , JORDAN1K:9;
thus L98: ( 0 ) < D19 by L97 , L38 , L39 , L41 , L44 , L78 , L85 , L89 , L91 , L94;
end;
suppose L99: D21 > 1;

reconsider D22 = ( D21 - 1 ) as (Element of ( NAT )) by L99 , NAT_1:20;
L100: (( C10 /. D22 ) is (Element of D4) & ( C10 /. D21 ) is (Element of D4));
reconsider D23 = ( C10 /. D22 ) , D24 = ( C10 /. D21 ) as (Function of D1 , ( R^1 )) by L100 , TOPMETR:17;
L101: ( D22 + 1 ) > 1 by L99;
L102: (1 <= D22 & D22 < ( len C4 )) by L101 , L91 , NAT_1:13;
L103: D22 in ( dom C10 ) by L102 , L38 , FINSEQ_3:25;
L104: D23 is  continuous by L103 , L78;
L105: S1[ D22 , D23 , D24 ] by L40 , L44 , L78 , L89 , L102;
consider C22 being non  empty (Subset of D1) such that L106: ( C22 ` ) = ( C4 . D21 ) and L107: (for B19 being (Point of D1) holds ( D24 . B19 ) = ( max (( D23 . B19 ) , ( ( dist_min C22 ) . B19 )) )) by L105 , L104;
L108: ( C22 ` ) is  open by L2 , L5 , L11 , L88 , L90 , L106 , TOPS_2:def 1;
L109: C22 is  closed by L108 , TOPS_1:3;
L110: (not D20 in C22) by L87 , L90 , L106 , XBOOLE_0:def 5;
L111: ( ( dist_min C22 ) . D20 ) <> ( 0 ) by L110 , L109 , HAUSDORF:9;
L112: ( ( dist_min C22 ) . D20 ) > ( 0 ) by L111 , JORDAN1K:9;
L113: ( D24 . D20 ) = ( max (( D23 . D20 ) , ( ( dist_min C22 ) . D20 )) ) by L107;
L114: ( D24 . D20 ) > ( 0 ) by L113 , L112 , XXREAL_0:25;
thus L115: ( 0 ) < D19 by L114 , L38 , L41 , L44 , L78 , L85 , L89 , L91;
end;
end;
reconsider D25 = D19 as  positive Real by L93;
take D25;
let C23 being (Point of R1);
defpred S3[ Nat ] means ($1 in ( dom C10 ) & (for B20 being (Function of D1 , ( R^1 )) holds (( C10 /. $1 ) = B20 implies ( B20 . C23 ) >= D25)));
L117: ( D13 . C23 ) in D18 by L43 , L79 , FUNCT_1:def 3;
L118: S3[ ( len C10 ) ] by L117 , L15 , L38 , FINSEQ_3:25 , XXREAL_2:3;
L119: (ex B21 being Nat st S3[ B21 ]) by L118;
consider C24 being Nat such that L120: S3[ C24 ] and L121: (for B22 being Nat holds (S3[ B22 ] implies C24 <= B22)) from NAT_1:sch 5(L119);
L122: 1 <= C24 by L120 , FINSEQ_3:25;
L123: C24 <= ( len C10 ) by L120 , FINSEQ_3:25;
per cases  by L122 , XXREAL_0:1;
suppose L124: C24 = 1;

take D5;
thus L125: D5 in C1 by L5 , L11 , L17;
let C25 being set;
assume that
L126: C25 in ( Ball (C23 , D25) );
reconsider D26 = C25 as (Point of R1) by L126;
L127: ( dist (C23 , D26) ) < D25 by L126 , METRIC_1:11;
assume L128: (not C25 in D5);
L129: D26 in D6 by L128 , XBOOLE_0:def 5;
L130: ( ( dist_min D6 ) . C23 ) <= ( dist (C23 , D26) ) by L129 , HAUSDORF:13;
L131: ( ( dist_min D6 ) . C23 ) >= D25 by L14 , L39 , L120 , L124;
thus L132: contradiction by L131 , L127 , L130 , XXREAL_0:2;
end;
suppose L133: C24 > 1;

reconsider D27 = ( C24 - 1 ) as (Element of ( NAT )) by L133 , NAT_1:20;
L134: (( C10 /. D27 ) is (Element of D4) & ( C10 /. C24 ) is (Element of D4));
reconsider D28 = ( C10 /. D27 ) , D29 = ( C10 /. C24 ) as (Function of D1 , ( R^1 )) by L134 , TOPMETR:17;
L135: ( D27 + 1 ) > 1 by L133;
L136: (1 <= D27 & D27 < ( len C4 )) by L135 , L38 , L123 , NAT_1:13;
L137: D27 in ( dom C10 ) by L136 , L38 , FINSEQ_3:25;
L138: D28 is  continuous by L137 , L78;
L139: S1[ D27 , D28 , D29 ] by L40 , L78 , L120 , L136;
consider C26 being non  empty (Subset of D1) such that L140: ( C26 ` ) = ( C4 . C24 ) and L141: (for B23 being (Point of D1) holds ( D29 . B23 ) = ( max (( D28 . B23 ) , ( ( dist_min C26 ) . B23 )) )) by L139 , L138;
take ( C26 ` );
L142: ( C26 ` ) in C2 by L11 , L44 , L120 , L140 , FUNCT_1:def 3;
thus L143: ( C26 ` ) in C1 by L142 , L5;
let C27 being set;
assume that
L144: C27 in ( Ball (C23 , D25) );
reconsider D30 = C27 as (Point of R1) by L144;
assume L145: (not C27 in ( C26 ` ));
L146: D30 in C26 by L145 , XBOOLE_0:def 5;
L147: ( ( dist_min C26 ) . C23 ) <= ( dist (C23 , D30) ) by L146 , HAUSDORF:13;
L148: ( dist (C23 , D30) ) < D25 by L144 , METRIC_1:11;
L149: ( ( dist_min C26 ) . C23 ) < D25 by L148 , L147 , XXREAL_0:2;
L150: ( D29 . C23 ) >= D25 by L120;
L151: ( D29 . C23 ) = ( max (( D28 . C23 ) , ( ( dist_min C26 ) . C23 )) ) by L141;
L152: S3[ D27 ] by L151 , L38 , L136 , L149 , L150 , FINSEQ_3:25 , XXREAL_0:16;
L153: D27 >= ( D27 + 1 ) by L152 , L121;
thus L154: contradiction by L153 , NAT_1:13;
end;
end;
end;
end;
theorem
L158: (for R1 being non  empty MetrSpace holds (for R2 being  open (Subset-Family of ( TopSpaceMetr R1 )) holds (for R3 being  open (Subset-Family of ( TopSpaceMetr R1 )) holds (for R4 being (Lebesgue_number of R2) holds ((( TopSpaceMetr R1 ) is  compact & R2 is (Cover of ( TopSpaceMetr R1 )) & R2 c= R3) implies R4 is (Lebesgue_number of R3))))))
proof
let R1 being non  empty MetrSpace;
let R2 being  open (Subset-Family of ( TopSpaceMetr R1 ));
let R3 being  open (Subset-Family of ( TopSpaceMetr R1 ));
let R4 being (Lebesgue_number of R2);
assume that
L159: ( TopSpaceMetr R1 ) is  compact
and
L160: R2 is (Cover of ( TopSpaceMetr R1 ))
and
L161: R2 c= R3;
L162:
now
let C28 being (Point of R1);
L163: (ex B24 being (Subset of ( TopSpaceMetr R1 )) st (B24 in R2 & ( Ball (C28 , R4) ) c= B24)) by L159 , L160 , L4;
thus L164: (ex B25 being (Subset of ( TopSpaceMetr R1 )) st (B25 in R3 & ( Ball (C28 , R4) ) c= B25)) by L163 , L161;
end;
set D31 = ( TopSpaceMetr R1 );
L165: (( union R2 ) = ( [#] D31 ) & ( union R2 ) c= ( union R3 )) by L160 , L161 , SETFAM_1:45 , ZFMISC_1:77;
L166: R3 is (Cover of D31) by L165 , SETFAM_1:def 11;
thus L167: thesis by L166 , L159 , L162 , L4;
end;
theorem
L168: (for R1 being non  empty MetrSpace holds (for R2 being  open (Subset-Family of ( TopSpaceMetr R1 )) holds (for R3 being  open (Subset-Family of ( TopSpaceMetr R1 )) holds (for R4 being (Lebesgue_number of R2) holds ((( TopSpaceMetr R1 ) is  compact & R2 is (Cover of ( TopSpaceMetr R1 )) & R2 is_finer_than R3) implies R4 is (Lebesgue_number of R3))))))
proof
let R1 being non  empty MetrSpace;
let R2 being  open (Subset-Family of ( TopSpaceMetr R1 ));
let R3 being  open (Subset-Family of ( TopSpaceMetr R1 ));
let R4 being (Lebesgue_number of R2);
assume that
L169: ( TopSpaceMetr R1 ) is  compact
and
L170: R2 is (Cover of ( TopSpaceMetr R1 ))
and
L171: R2 is_finer_than R3;
set D32 = ( TopSpaceMetr R1 );
L172:
now
let C29 being (Point of R1);
consider C30 being (Subset of ( TopSpaceMetr R1 )) such that L173: C30 in R2 and L174: ( Ball (C29 , R4) ) c= C30 by L169 , L170 , L4;
consider C31 being set such that L175: C31 in R3 and L176: C30 c= C31 by L171 , L173 , SETFAM_1:def 2;
reconsider D33 = C31 as (Subset of D32) by L175;
take D34 = D33;
thus L177: (D34 in R3 & ( Ball (C29 , R4) ) c= D34) by L174 , L175 , L176 , XBOOLE_1:1;
end;
L178: (( union R2 ) = ( [#] D32 ) & ( union R2 ) c= ( union R3 )) by L170 , L171 , SETFAM_1:13 , SETFAM_1:45;
L179: R3 is (Cover of D32) by L178 , SETFAM_1:def 11;
thus L180: thesis by L179 , L169 , L172 , L4;
end;
theorem
L181: (for R1 being non  empty MetrSpace holds (for R2 being  open (Subset-Family of ( TopSpaceMetr R1 )) holds (for R4 being (Lebesgue_number of R2) holds (for B26 being  positive Real holds ((( TopSpaceMetr R1 ) is  compact & R2 is (Cover of ( TopSpaceMetr R1 )) & B26 <= R4) implies B26 is (Lebesgue_number of R2))))))
proof
let R1 being non  empty MetrSpace;
let R2 being  open (Subset-Family of ( TopSpaceMetr R1 ));
let R4 being (Lebesgue_number of R2);
let C32 being  positive Real;
assume that
L182: (( TopSpaceMetr R1 ) is  compact & R2 is (Cover of ( TopSpaceMetr R1 )))
and
L183: C32 <= R4;
L184:
now
let C33 being (Point of R1);
consider C34 being (Subset of ( TopSpaceMetr R1 )) such that L185: (C34 in R2 & ( Ball (C33 , R4) ) c= C34) by L182 , L4;
take D35 = C34;
L186: ( Ball (C33 , C32) ) c= ( Ball (C33 , R4) ) by L183 , PCOMPS_1:1;
thus L187: (D35 in R2 & ( Ball (C33 , C32) ) c= D35) by L186 , L185 , XBOOLE_1:1;
end;
thus L188: thesis by L184 , L182 , L4;
end;
begin
registration
let R9 being  Reflexive non  empty MetrStruct;
cluster  finite ->  bounded for (Subset of R9);
coherence
proof
let C35 being (Subset of R9);
per cases ;
suppose L189: C35 is  empty;

thus L190: thesis by L189;
end;
suppose L191: C35 is non  empty;

assume L192: C35 is  finite;
reconsider D36 = C35 as  finite non  empty (Subset of R9) by L192 , L191;
deffunc H1((Point of R9) , (Point of R9)) = ( dist ($1 , $2) );
consider C36 being set such that L193: C36 in D36 by XBOOLE_0:def 1;
set D37 = { H1(B27 , B28) where B27 is (Point of R9) , B28 is (Point of R9) : (B27 in D36 & B28 in D36) };
reconsider D38 = C36 as (Point of R9) by L193;
L194: H1(D38 , D38) in D37 by L193;
L195:
now
let C37 being set;
assume L196: C37 in D37;
L197: (ex B29 being (Point of R9) st (ex B30 being (Point of R9) st (C37 = H1(B29 , B30) & B29 in D36 & B30 in D36))) by L196;
thus L198: C37 is  real by L197;
end;
L199: D36 is  finite;
L200: D37 is  finite from FRAENKEL:sch 22(L199 , L199);
reconsider D39 = D37 as  real-membered non  empty  finite set by L200 , L194 , L195 , MEMBERED:def 3;
reconsider D40 = ( sup D39 ) as Real by XREAL_0:def 1;
reconsider D41 = ( D40 + 1 ) as Real;
take D41;
L201: (H1(D38 , D38) = ( 0 ) & H1(D38 , D38) <= D40) by L194 , METRIC_1:1 , XXREAL_2:4;
thus L202: ( 0 ) < D41 by L201;
let C38 , C39 being (Point of R9);
assume L203: (C38 in C35 & C39 in C35);
L204: H1(C38 , C39) in D39 by L203;
L205: H1(C38 , C39) <= D40 by L204 , XXREAL_2:4;
thus L206: thesis by L205 , XREAL_1:39;
end;
end;
end;
theorem
L209: (for R9 being  Reflexive non  empty MetrStruct holds (for B31 being  finite non  empty (Subset of R9) holds (ex B32 , B33 being (Point of R9) st (B32 in B31 & B33 in B31 & ( dist (B32 , B33) ) = ( diameter B31 )))))
proof
let R9 being  Reflexive non  empty MetrStruct;
let C40 being  finite non  empty (Subset of R9);
set D42 = the (Element of C40);
reconsider D43 = D42 as (Point of R9);
deffunc H2((Point of R9) , (Point of R9)) = ( dist ($1 , $2) );
set D44 = { H2(B34 , B35) where B34 is (Point of R9) , B35 is (Point of R9) : (B34 in C40 & B35 in C40) };
L210:
now
let C41 being set;
assume L211: C41 in D44;
L212: (ex B36 being (Point of R9) st (ex B37 being (Point of R9) st (C41 = H2(B36 , B37) & B36 in C40 & B37 in C40))) by L211;
thus L213: C41 is  real by L212;
end;
L214: H2(D43 , D43) in D44;
L215: C40 is  finite;
L216: D44 is  finite from FRAENKEL:sch 22(L215 , L215);
reconsider D45 = D44 as  real-membered non  empty  finite set by L216 , L210 , L214 , MEMBERED:def 3;
reconsider D46 = ( sup D45 ) as Real by XREAL_0:def 1;
L217: D46 in D45 by XXREAL_2:def 6;
consider C42 , C43 being (Point of R9) such that L218: (D46 = H2(C42 , C43) & C42 in C40 & C43 in C40) by L217;
L219:
now
let C44 , C45 being (Point of R9);
assume L220: (C44 in C40 & C45 in C40);
L221: H2(C44 , C45) in D45 by L220;
thus L222: H2(C44 , C45) <= D46 by L221 , XXREAL_2:4;
end;
L223: ( diameter C40 ) <= D46 by L219 , TBSP_1:def 8;
L224: D46 <= ( diameter C40 ) by L218 , TBSP_1:def 8;
thus L225: thesis by L224 , L218 , L223 , XXREAL_0:1;
end;
definition
let R9 being  Reflexive non  empty MetrStruct;
let R11 being SimplicialComplexStr;
attr R11 is R9 bounded
means
:L226: (ex R7 being  real number st (for R10 being (Subset of R9) holds (R10 in (the topology of R11) implies (R10 is  bounded & ( diameter R10 ) <= R7))));
end;
theorem
L228: (for R9 being  Reflexive non  empty MetrStruct holds (for R10 being (Subset of R9) holds (for B38 being non  void SimplicialComplexStr holds ((B38 is R9 bounded & R10 is (Simplex of B38)) implies R10 is  bounded))))
proof
let R9 being  Reflexive non  empty MetrStruct;
let R10 being (Subset of R9);
let C46 being non  void SimplicialComplexStr;
assume L229: C46 is R9 bounded;
L230: (ex B39 being  real number st (for R10 being (Subset of R9) holds (R10 in (the topology of C46) implies (R10 is  bounded & ( diameter R10 ) <= B39)))) by L229 , L226;
assume L231: R10 is (Simplex of C46);
L232: R10 in (the topology of C46) by L231 , PRE_TOPC:def 2;
thus L233: thesis by L232 , L230;
end;
registration
let R9 being  Reflexive non  empty MetrStruct;
let R8 being set;
cluster R9 bounded non  void for (SimplicialComplex of R8);
existence
proof
set D47 = the (Element of R9);
take D48 = ( Complex_of { ( {} R8 ) } );
L234: D48 is R9 bounded
proof
take D49 = ( diameter ( {} R9 ) );
let R10 being (Subset of R9);
L235: (the topology of D48) = ( bool ( {} R8 ) ) by SIMPLEX0:4;
assume L236: R10 in (the topology of D48);
thus L237: thesis by L236 , L235;
end;
thus L238: thesis by L234;
end;
end;
registration
let R9 being  Reflexive non  empty MetrStruct;
cluster R9 bounded non  void  subset-closed  finite-membered for SimplicialComplexStr;
existence
proof
take the R9 bounded non  void (SimplicialComplex of the set);
thus L240: thesis;
end;
end;
registration
let R9 being  Reflexive non  empty MetrStruct;
let R8 being set;
let C47 being R9 bounded (SimplicialComplexStr of R8);
cluster  -> R9 bounded for (SubSimplicialComplex of C47);
coherence
proof
let C48 being (SubSimplicialComplex of C47);
L242: (the topology of C48) c= (the topology of C47) by SIMPLEX0:def 13;
consider C49 being  real number such that L243: (for R10 being (Subset of R9) holds (R10 in (the topology of C47) implies (R10 is  bounded & ( diameter R10 ) <= C49))) by L226;
take C49;
let R10 being (Subset of R9);
assume L244: R10 in (the topology of C48);
thus L245: thesis by L244 , L242 , L243;
end;
end;
registration
let R9 being  Reflexive non  empty MetrStruct;
let R8 being set;
let C50 being R9 bounded  subset-closed (SimplicialComplexStr of R8);
let C51 being Integer;
cluster ( Skeleton_of (C50 , C51) ) -> R9 bounded;
coherence;
end;
theorem
L248: (for R9 being  Reflexive non  empty MetrStruct holds (for R11 being SimplicialComplexStr holds (R11 is  finite-vertices implies R11 is R9 bounded)))
proof
let R9 being  Reflexive non  empty MetrStruct;
let R11 being SimplicialComplexStr;
set D50 = ( Vertices R11 );
assume L249: R11 is  finite-vertices;
L250: D50 is  finite by L249 , SIMPLEX0:def 5;
reconsider D51 = ( D50 /\ ( [#] R9 ) ) as  finite (Subset of R9) by L250;
take ( diameter D51 );
let R10 being (Subset of R9);
assume L251: R10 in (the topology of R11);
reconsider D52 = R10 as (Subset of R11) by L251;
L252: D52 is  simplex-like by L251 , PRE_TOPC:def 2;
L253: R10 c= D50 by L252 , SIMPLEX0:17;
L254: R10 c= D51 by L253 , XBOOLE_1:19;
thus L255: thesis by L254 , TBSP_1:24;
end;
begin
L256: ( 0 ) in ( REAL ) by XREAL_0:def 1;
definition
let R9 being  Reflexive non  empty MetrStruct;
let C52 being SimplicialComplexStr;
assume that
L257: C52 is R9 bounded;
func diameter (R9 , C52) -> Real means 
:L258: ((for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= it)) & (for R7 being  real number holds ((for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= R7)) implies R7 >= it))) if (the topology of C52) meets ( bool ( [#] R9 ) ) otherwise it = ( 0 );
existence
proof
L259: ((the topology of C52) meets ( bool ( [#] R9 ) ) implies (ex B40 being Real st ((for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= B40)) & (for B41 being  real number holds ((for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= B41)) implies B41 >= B40)))))
proof
defpred S4[ (Subset of R9) ] means ($1 in (the topology of C52) & $1 is  bounded);
deffunc H3((Subset of R9)) = ( diameter $1 );
set D53 = { H3(B42) where B42 is (Subset of R9) : S4[ B42 ] };
L260:
now
let C53 being set;
assume L261: C53 in D53;
L262: (ex B43 being (Subset of R9) st (C53 = H3(B43) & S4[ B43 ])) by L261;
thus L263: C53 is  real by L262;
end;
reconsider D54 = D53 as  real-membered set by L260 , MEMBERED:def 3;
assume L264: (the topology of C52) meets ( bool ( [#] R9 ) );
consider C54 being set such that L265: C54 in (the topology of C52) and L266: C54 in ( bool ( [#] R9 ) ) by L264 , XBOOLE_0:3;
reconsider D55 = C54 as (Subset of R9) by L266;
consider C55 being  real number such that L267: (for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies (R10 is  bounded & H3(R10) <= C55))) by L257 , L226;
L268:
now
let C56 being  ext-real number;
assume L269: C56 in D54;
consider C57 being (Subset of R9) such that L270: (C56 = H3(C57) & S4[ C57 ]) by L269;
thus L271: C56 <= C55 by L267 , L270;
end;
L272: C55 is (UpperBound of D54) by L268 , XXREAL_2:def 1;
L273: D54 is  bounded_above by L272 , XXREAL_2:def 10;
L274: D55 is  bounded by L265 , L267;
L275: H3(D55) in D54 by L274 , L265;
reconsider D56 = ( sup D54 ) as Real by L275 , L273 , XXREAL_2:16;
take D56;
thus L276:now
let R10 being (Subset of R9);
assume L277: R10 in (the topology of C52);
L278: S4[ R10 ] by L277 , L267;
L279: H3(R10) in D54 by L278;
thus L280: H3(R10) <= D56 by L279 , XXREAL_2:4;
end;
let C58 being  real number;
assume that
L281: (for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= C58));
L282:
now
let C59 being  ext-real number;
assume L283: C59 in D54;
consider R10 being (Subset of R9) such that L284: (C59 = H3(R10) & S4[ R10 ]) by L283;
thus L285: C59 <= C58 by L281 , L284;
end;
L286: C58 is (UpperBound of D54) by L282 , XXREAL_2:def 1;
thus L287: thesis by L286 , XXREAL_2:def 3;
end;
thus L288: thesis by L259 , L256;
end;
uniqueness
proof
L289:
now
let C60 , C61 being Real;
assume that
L290: ((for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= C60)) & (for B44 being  real number holds ((for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= B44)) implies B44 >= C60)) & (for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= C61)) & (for B45 being  real number holds ((for R10 being (Subset of R9) holds (R10 in (the topology of C52) implies ( diameter R10 ) <= B45)) implies B45 >= C61)));
L291: (C60 <= C61 & C61 <= C60) by L290;
thus L292: C60 = C61 by L291 , XXREAL_0:1;
end;
thus L293: thesis by L289;
end;
consistency;
end;
theorem
L295: (for R9 being  Reflexive non  empty MetrStruct holds (for R11 being SimplicialComplexStr holds (R11 is R9 bounded implies ( 0 ) <= ( diameter (R9 , R11) ))))
proof
let R9 being  Reflexive non  empty MetrStruct;
let R11 being SimplicialComplexStr;
assume L296: R11 is R9 bounded;
per cases ;
suppose L297: (the topology of R11) meets ( bool ( [#] R9 ) );

consider C62 being set such that L298: C62 in (the topology of R11) and L299: C62 in ( bool ( [#] R9 ) ) by L297 , XBOOLE_0:3;
reconsider D57 = C62 as (Subset of R9) by L299;
L300: (ex B46 being  real number st (for R10 being (Subset of R9) holds (R10 in (the topology of R11) implies (R10 is  bounded & ( diameter R10 ) <= B46)))) by L296 , L226;
L301: ( diameter D57 ) >= ( 0 ) by L300 , L298 , TBSP_1:21;
thus L302: thesis by L301 , L296 , L297 , L298 , L258;
end;
suppose L303: (the topology of R11) misses ( bool ( [#] R9 ) );

thus L304: thesis by L303 , L296 , L258;
end;
end;
theorem
L306: (for R8 being set holds (for R9 being  Reflexive non  empty MetrStruct holds (for B47 being R9 bounded (SimplicialComplexStr of R8) holds (for B48 being (SubSimplicialComplex of B47) holds ( diameter (R9 , B48) ) <= ( diameter (R9 , B47) )))))
proof
let R8 being set;
let R9 being  Reflexive non  empty MetrStruct;
let C63 being R9 bounded (SimplicialComplexStr of R8);
let C64 being (SubSimplicialComplex of C63);
L307: (the topology of C64) c= (the topology of C63) by SIMPLEX0:def 13;
per cases ;
suppose L308: (the topology of C64) meets ( bool ( [#] R9 ) );

L309: (the topology of C63) meets ( bool ( [#] R9 ) ) by L308 , L307 , XBOOLE_1:63;
L310: (for R10 being (Subset of R9) holds (R10 in (the topology of C64) implies ( diameter R10 ) <= ( diameter (R9 , C63) ))) by L309 , L307 , L258;
thus L311: thesis by L310 , L308 , L258;
end;
suppose L312: (the topology of C64) misses ( bool ( [#] R9 ) );

L313: ( diameter (R9 , C64) ) = ( 0 ) by L312 , L258;
thus L314: thesis by L313 , L295;
end;
end;
theorem
L316: (for R8 being set holds (for R9 being  Reflexive non  empty MetrStruct holds (for B49 being R9 bounded  subset-closed (SimplicialComplexStr of R8) holds (for B50 being Integer holds ( diameter (R9 , ( Skeleton_of (B49 , B50) )) ) <= ( diameter (R9 , B49) )))))
proof
let R8 being set;
let R9 being  Reflexive non  empty MetrStruct;
set D58 = the Real;
let C65 being R9 bounded  subset-closed (SimplicialComplexStr of R8);
let C66 being Integer;
set D59 = ( Skeleton_of (C65 , C66) );
L317: (the topology of D59) c= (the topology of C65) by SIMPLEX0:def 13;
per cases ;
suppose L318: (the topology of D59) meets ( bool ( [#] R9 ) );

L319: (the topology of C65) meets ( bool ( [#] R9 ) ) by L318 , L317 , XBOOLE_1:63;
L320:
now
let R10 being (Subset of R9);
L321: ( the_family_of C65 ) is  subset-closed by MATROID0:def 3;
L322: (the topology of C65) is  subset-closed by L321 , MATROID0:def 1;
assume L323: R10 in (the topology of D59);
consider C67 being set such that L324: R10 c= C67 and L325: C67 in ( the_subsets_with_limited_card (( C66 + 1 ) , (the topology of C65)) ) by L323 , SIMPLEX0:2;
reconsider D60 = C67 as (Subset of C65) by L325;
L326: D60 in (the topology of C65) by L325 , SIMPLEX0:def 2;
L327: R10 in (the topology of C65) by L326 , L322 , L324 , CLASSES1:def 1;
thus L328: ( diameter R10 ) <= ( diameter (R9 , C65) ) by L327 , L319 , L258;
end;
thus L329: thesis by L320 , L318 , L258;
end;
suppose L330: (the topology of D59) misses ( bool ( [#] R9 ) );

L331: ( diameter (R9 , D59) ) = ( 0 ) by L330 , L258;
thus L332: thesis by L331 , L295;
end;
end;
definition
let R9 being  Reflexive non  empty MetrStruct;
let C68 being R9 bounded non  void  subset-closed SimplicialComplexStr;
redefine func diameter (R9 , C68) -> Real means 
:L334: ((for R10 being (Subset of R9) holds (R10 is (Simplex of C68) implies ( diameter R10 ) <= it)) & (for R7 being  real number holds ((for R10 being (Subset of R9) holds (R10 is (Simplex of C68) implies ( diameter R10 ) <= R7)) implies R7 >= it)));
coherence;
compatibility
proof
let C69 being Real;
L335: ( {} C68 ) is  simplex-like;
L336: ( {} R9 ) in (the topology of C68) by L335 , PRE_TOPC:def 2;
L337: (the topology of C68) meets ( bool ( [#] R9 ) ) by L336 , XBOOLE_0:3;
thus L338:now
assume L339: C69 = ( diameter (R9 , C68) );
thus L340:now
let R10 being (Subset of R9);
assume L341: R10 is (Simplex of C68);
L342: R10 in (the topology of C68) by L341 , PRE_TOPC:def 2;
thus L343: ( diameter R10 ) <= C69 by L342 , L337 , L339 , L258;
end;
let C70 being  real number;
assume L344: (for R10 being (Subset of R9) holds (R10 is (Simplex of C68) implies ( diameter R10 ) <= C70));
L345:
now
let R10 being (Subset of R9);
assume L346: R10 in (the topology of C68);
L347: R10 is (Simplex of C68) by L346 , PRE_TOPC:def 2;
thus L348: ( diameter R10 ) <= C70 by L347 , L344;
end;
thus L349: C70 >= C69 by L345 , L337 , L339 , L258;
end;
assume that
L350: (for R10 being (Subset of R9) holds (R10 is (Simplex of C68) implies ( diameter R10 ) <= C69))
and
L351: (for B51 being  real number holds ((for R10 being (Subset of R9) holds (R10 is (Simplex of C68) implies ( diameter R10 ) <= B51)) implies B51 >= C69));
L352:
now
let R10 being (Subset of R9);
assume L353: R10 in (the topology of C68);
L354: R10 is (Simplex of C68) by L353 , PRE_TOPC:def 2;
thus L355: ( diameter R10 ) <= C69 by L354 , L350;
end;
L356: ( diameter (R9 , C68) ) <= C69 by L352 , L337 , L258;
L357:
now
let R10 being (Subset of R9);
assume L358: R10 is (Simplex of C68);
L359: R10 in (the topology of C68) by L358 , PRE_TOPC:def 2;
thus L360: ( diameter R10 ) <= ( diameter (R9 , C68) ) by L359 , L337 , L258;
end;
L361: C69 <= ( diameter (R9 , C68) ) by L357 , L351;
thus L362: C69 = ( diameter (R9 , C68) ) by L361 , L356 , XXREAL_0:1;
end;
end;
theorem
L364: (for R9 being  Reflexive non  empty MetrStruct holds (for B52 being  finite (Subset of R9) holds ( diameter (R9 , ( Complex_of { B52 } )) ) = ( diameter B52 )))
proof
let R9 being  Reflexive non  empty MetrStruct;
let C71 being  finite (Subset of R9);
set D61 = ( Complex_of { C71 } );
reconsider D62 = D61 as R9 bounded non  void (SimplicialComplex of R9) by L248;
reconsider D63 = C71 as (Subset of D62);
L365: (the topology of D62) = ( bool C71 ) by SIMPLEX0:4;
L366:
now
let C72 being (Subset of R9);
assume L367: C72 is (Simplex of D62);
L368: C72 in ( bool C71 ) by L367 , L365 , PRE_TOPC:def 2;
thus L369: ( diameter C72 ) <= ( diameter C71 ) by L368 , TBSP_1:24;
end;
L370: ( diameter (R9 , D62) ) <= ( diameter C71 ) by L366 , L334;
L371: C71 c= C71;
L372: D63 is  simplex-like by L371 , L365 , PRE_TOPC:def 2;
L373: ( diameter C71 ) <= ( diameter (R9 , D62) ) by L372 , L334;
thus L374: thesis by L373 , L370 , XXREAL_0:1;
end;
definition
let R5 being Nat;
let C73 being (SimplicialComplexStr of ( TOP-REAL R5 ));
attr C73 is  bounded
means
:L375: C73 is ( Euclid R5 ) bounded;
func diameter C73 -> Real equals 
( diameter (( Euclid R5 ) , C73) );
coherence;
end;
registration
let R5 being Nat;
cluster  bounded -> ( Euclid R5 ) bounded for (SimplicialComplexStr of ( TOP-REAL R5 ));
coherence by L375;
cluster  bounded  affinely-independent  simplex-join-closed non  void  finite-degree  total for (SimplicialComplex of ( TOP-REAL R5 ));
existence
proof
set D64 = ( TOP-REAL R5 );
take D65 = ( Complex_of { ( {} ( TOP-REAL R5 ) ) } );
L377: D65 is ( Euclid R5 ) bounded by L248;
thus L378: thesis by L377 , L375;
end;
cluster  finite-vertices ->  bounded for (SimplicialComplexStr of ( TOP-REAL R5 ));
coherence
proof
let C74 being (SimplicialComplexStr of ( TOP-REAL R5 ));
assume L379: C74 is  finite-vertices;
L380: C74 is ( Euclid R5 ) bounded by L379 , L248;
thus L381: thesis by L380 , L375;
end;
end;
L383: (for R5 being Nat holds ( [#] ( TOP-REAL R5 ) ) = ( [#] ( Euclid R5 ) ))
proof
let R5 being Nat;
L384: ( the TopStruct of ( TOP-REAL R5 ) ) = ( TopSpaceMetr ( Euclid R5 ) ) by EUCLID:def 8;
thus L385: thesis by L384;
end;
begin
L386: (for B53 being set holds { B53 } is  c=-linear)
proof
let C75 being set;
let C76 , C77 being set;
assume that
L387: C76 in { C75 }
and
L388: C77 in { C75 };
L389: C76 = C75 by L387 , TARSKI:def 1;
thus L390: thesis by L389 , L388 , TARSKI:def 1;
end;
theorem
L391: (for R12 being RealLinearSpace holds (for R13 being non  void (SimplicialComplex of R12) holds (for B54 being (Simplex of ( BCS R13 )) holds (for B55 being  c=-linear  finite  finite-membered (Subset-Family of R12) holds (B54 = ( ( center_of_mass R12 ) .: B55 ) implies (for B56 , B57 being (VECTOR of R12) holds ((B56 in B54 & B57 in B54) implies (ex B58 , B59 being (VECTOR of R12) st (ex B60 being Real st (B58 in ( Vertices ( BCS ( Complex_of { ( union B55 ) } ) ) ) & B59 in ( Vertices ( BCS ( Complex_of { ( union B55 ) } ) ) ) & ( B56 - B57 ) = ( B60 * ( B58 - B59 ) ) & ( 0 ) <= B60 & B60 <= ( ( ( card ( union B55 ) ) - 1 ) / ( card ( union B55 ) ) )))))))))))
proof
let R12 being RealLinearSpace;
let R13 being non  void (SimplicialComplex of R12);
let C78 being (Simplex of ( BCS R13 ));
set D66 = ( center_of_mass R12 );
let C79 being  c=-linear  finite  finite-membered (Subset-Family of R12);
assume that
L392: C78 = ( D66 .: C79 );
let C80 , C81 being (VECTOR of R12);
assume that
L393: C80 in C78
and
L394: C81 in C78;
consider C82 being set such that L395: C82 in ( dom D66 ) and L396: C82 in C79 and L397: ( D66 . C82 ) = C80 by L392 , L393 , FUNCT_1:def 6;
consider C83 being set such that L398: C83 in ( dom D66 ) and L399: C83 in C79 and L400: ( D66 . C83 ) = C81 by L392 , L394 , FUNCT_1:def 6;
L401: C82 , C83 are_c=-comparable  by L396 , L399 , ORDINAL1:def 8;
set D67 = ( union C79 );
set D68 = ( Complex_of { D67 } );
L402: (for B61 , B62 being (VECTOR of R12) holds (for B63 , B64 being set holds ((B63 c= B64 & B63 in ( dom D66 ) & B63 in C79 & ( D66 . B63 ) = B61 & B63 in ( dom D66 ) & B64 in C79 & ( D66 . B64 ) = B62) implies (ex B65 , B66 being (VECTOR of R12) st (ex B67 being Real st (B65 in ( Vertices ( BCS D68 ) ) & B66 in ( Vertices ( BCS D68 ) ) & ( B61 - B62 ) = ( B67 * ( B65 - B66 ) ) & ( 0 ) <= B67 & B67 <= ( ( ( card D67 ) - 1 ) / ( card D67 ) )))))))
proof
let C84 , C85 being (VECTOR of R12);
L403: (the topology of D68) = ( bool D67 ) by SIMPLEX0:4;
let C86 , C87 being set;
assume that
L404: C86 c= C87
and
L405: C86 in ( dom D66 )
and
L406: C86 in C79
and
L407: ( D66 . C86 ) = C84
and
L408: C86 in ( dom D66 )
and
L409: C87 in C79
and
L410: ( D66 . C87 ) = C85;
L411: C86 c= D67 by L406 , ZFMISC_1:74;
L412: C86 <> ( {} ) by L405 , ORDERS_1:1;
L413: D67 is non  empty by L412 , L411;
L414: C87 c= D67 by L409 , ZFMISC_1:74;
reconsider D69 = C86 , D70 = C87 as non  empty  finite (Subset of R12) by L404 , L406 , L409 , L412;
set D71 = ( D70 \ D69 );
reconsider D72 = { D69 } , D73 = { D71 } as (Subset-Family of D68);
L415: { D69 } c= ( bool D67 ) by L411 , ZFMISC_1:31;
L416: D72 is  c=-linear  finite  simplex-like by L415 , L403 , L386 , SIMPLEX0:14;
L417: D71 c= D70 by XBOOLE_1:36;
L418: D71 c= D67 by L417 , L414 , XBOOLE_1:1;
L419: { D71 } c= ( bool D67 ) by L418 , ZFMISC_1:31;
L420: D73 is  c=-linear  finite  simplex-like by L419 , L403 , L386 , SIMPLEX0:14;
L421: |. D68 .| c= ( [#] R12 );
L422: ( [#] D68 ) = ( [#] R12 );
L423: ( BCS D68 ) = ( subdivision (D66 , D68) ) by L422 , L421 , SIMPLEX1:def 5;
L424: ( [#] ( subdivision (D66 , D68) ) ) = ( [#] D68 ) by SIMPLEX0:def 20;
reconsider D74 = { C84 } as (Subset of ( BCS D68 )) by L424 , L421 , SIMPLEX1:def 5;
L425: C84 in D74 by TARSKI:def 1;
reconsider D75 = C84 as (Element of ( BCS D68 )) by L425;
L426: ( dom D66 ) = ( BOOL (the carrier of R12) ) by FUNCT_2:def 1;
L427: ( D66 .: D72 ) = ( Im (D66 , D69) ) by RELAT_1:def 16
.= { C84 } by L405 , L407 , FUNCT_1:59;
L428: D74 is  simplex-like by L427 , L416 , L423 , SIMPLEX0:def 20;
L429: D75 is  vertex-like by L428 , L425 , SIMPLEX0:def 3;
per cases ;
suppose L430: D69 = D70;

reconsider D76 = ( 0 ) as Real by XREAL_0:def 1;
take D77 = C84;
take D78 = C84;
take D76;
L431: ( card D67 ) >= 1 by L413 , NAT_1:14;
L432: ( ( card D67 ) - 1 ) >= ( 1 - 1 ) by L431 , XREAL_1:6;
L433: ( C84 - C85 ) = ( 0. R12 ) by L407 , L410 , L430 , RLVECT_1:5;
thus L434: thesis by L433 , L429 , L432 , RLVECT_1:10 , SIMPLEX0:def 4;
end;
suppose L435: D69 <> D70;

L436: (not D70 c= D69) by L435 , L404 , XBOOLE_0:def 10;
reconsider D79 = D71 as non  empty  finite (Subset of R12) by L436 , XBOOLE_1:37;
L437: D79 in ( dom D66 ) by L426 , ORDERS_1:2;
L438: ( D66 . D79 ) in ( rng D66 ) by L437 , FUNCT_1:def 3;
reconsider D80 = ( D66 . D79 ) as (VECTOR of R12) by L438;
reconsider D81 = { D80 } as (Subset of ( BCS D68 )) by L421 , L424 , SIMPLEX1:def 5;
L439: D80 in D81 by TARSKI:def 1;
reconsider D82 = D80 as (Element of ( BCS D68 )) by L439;
L440: ( D66 .: D73 ) = ( Im (D66 , D79) ) by RELAT_1:def 16
.= { D80 } by L437 , FUNCT_1:59;
L441: D81 is  simplex-like by L440 , L420 , L423 , SIMPLEX0:def 20;
L442: D82 is  vertex-like by L441 , L439 , SIMPLEX0:def 3;
set D83 = ( 1 / ( card D69 ) );
set D84 = ( 1 / ( card D70 ) );
set D85 = ( 1 / ( card D79 ) );
set D86 = ( ( card D79 ) / ( card D70 ) );
reconsider D87 = D83 , D88 = D84 , D89 = D85 , D90 = D86 as Real by XREAL_0:def 1;
take C84;
take D80;
take D90;
L443: ( D90 * D89 ) = ( ( ( card D79 ) * 1 ) / ( ( card D79 ) * ( card D70 ) ) ) by XCMPLX_1:76
.= D88 by XCMPLX_1:91;
consider C88 being (Linear_Combination of D69) such that L444: ( Sum C88 ) = ( D87 * ( Sum D69 ) ) and L445: ( sum C88 ) = ( D87 * ( card D69 ) ) and L446: C88 = ( ( ZeroLC R12 ) +* ( D69 --> D87 ) ) by RLAFFIN2:15;
L447: ( Carrier C88 ) c= D69 by RLVECT_2:def 6;
L448: ( card D79 ) = ( ( 1 * ( card D70 ) ) - ( 1 * ( card D69 ) ) ) by L404 , CARD_2:44;
L449: ( D87 - D88 ) = ( ( ( card D79 ) * 1 ) / ( ( card D70 ) * ( card D69 ) ) ) by L448 , XCMPLX_1:130
.= ( D90 * D87 ) by XCMPLX_1:76;
consider C89 being (Linear_Combination of D79) such that L450: ( Sum C89 ) = ( D89 * ( Sum D79 ) ) and L451: ( sum C89 ) = ( D89 * ( card D79 ) ) and L452: C89 = ( ( ZeroLC R12 ) +* ( D79 --> D89 ) ) by RLAFFIN2:15;
L453: ( Carrier C89 ) c= D79 by RLVECT_2:def 6;
consider C90 being (Linear_Combination of D70) such that L454: ( Sum C90 ) = ( D88 * ( Sum D70 ) ) and L455: ( sum C90 ) = ( D88 * ( card D70 ) ) and L456: C90 = ( ( ZeroLC R12 ) +* ( D70 --> D88 ) ) by RLAFFIN2:15;
L457: ( Carrier C90 ) c= D70 by RLVECT_2:def 6;
L458: (for B68 being (Element of R12) holds ( ( C88 - C90 ) . B68 ) = ( ( D90 * ( C88 - C89 ) ) . B68 ))
proof
let C91 being (Element of R12);
L459: ( dom ( D79 --> D89 ) ) = D79 by FUNCOP_1:13;
L460: ( ( C88 - C90 ) . C91 ) = ( ( C88 . C91 ) - ( C90 . C91 ) ) by RLVECT_2:54;
L461: ( dom ( D69 --> D87 ) ) = D69 by FUNCOP_1:13;
L462: ( dom ( D70 --> D88 ) ) = D70 by FUNCOP_1:13;
L463: ( ( D90 * ( C88 - C89 ) ) . C91 ) = ( D90 * ( ( C88 - C89 ) . C91 ) ) by RLVECT_2:def 11;
L464: ( ( D90 * ( C88 - C89 ) ) . C91 ) = ( D90 * ( ( C88 . C91 ) - ( C89 . C91 ) ) ) by L463 , RLVECT_2:54;
per cases ;
suppose L465: C91 in D69;

L466: (not C91 in ( Carrier C89 )) by L465 , L453 , XBOOLE_0:def 5;
L467: ( C89 . C91 ) = ( 0 ) by L466 , RLVECT_2:19;
L468: (( ( D70 --> D88 ) . C91 ) = D88 & ( ( D69 --> D87 ) . C91 ) = D87) by L404 , L465 , FUNCOP_1:7;
L469: ( C88 . C91 ) = ( ( D69 --> D87 ) . C91 ) by L446 , L461 , L465 , FUNCT_4:13;
thus L470: thesis by L469 , L404 , L449 , L456 , L460 , L462 , L464 , L465 , L467 , L468 , FUNCT_4:13;
end;
suppose L471: (C91 in D70 & (not C91 in D69));

L472: (not C91 in ( Carrier C88 )) by L471 , L447;
L473: ( C88 . C91 ) = ( 0 ) by L472 , RLVECT_2:19;
L474: ( ( D70 --> D88 ) . C91 ) = D88 by L471 , FUNCOP_1:7;
L475: ( ( C88 - C90 ) . C91 ) = ( - D88 ) by L474 , L456 , L460 , L462 , L471 , L473 , FUNCT_4:13;
L476: C91 in D79 by L471 , XBOOLE_0:def 5;
L477: ( ( D79 --> D89 ) . C91 ) = D89 by L476 , FUNCOP_1:7;
L478: ( ( D90 * ( C88 - C89 ) ) . C91 ) = ( D90 * ( - D89 ) ) by L477 , L452 , L459 , L464 , L473 , L476 , FUNCT_4:13;
thus L479: thesis by L478 , L443 , L475;
end;
suppose L480: ((not C91 in D69) & (not C91 in D70));

L481: (not C91 in ( Carrier C88 )) by L480 , L447;
L482: ( C88 . C91 ) = ( 0 ) by L481 , RLVECT_2:19;
L483: (not C91 in ( Carrier C89 )) by L453 , L480 , XBOOLE_0:def 5;
L484: ( C89 . C91 ) = ( 0 ) by L483 , RLVECT_2:19;
L485: (not C91 in ( Carrier C90 )) by L457 , L480;
thus L486: thesis by L485 , L460 , L464 , L484 , L482 , RLVECT_2:19;
end;
end;
L488: ( C88 - C90 ) = ( D90 * ( C88 - C89 ) ) by L458 , RLVECT_2:def 9;
L489: (( card D69 ) >= 1 & ( card D70 ) <= ( card D67 )) by L409 , NAT_1:14 , NAT_1:43 , ZFMISC_1:74;
L490: ( ( card D69 ) * ( card D67 ) ) >= ( 1 * ( card D70 ) ) by L489 , XREAL_1:66;
L491: ( ( ( card D70 ) * ( card D67 ) ) - ( ( card D69 ) * ( card D67 ) ) ) <= ( ( ( card D67 ) * ( card D70 ) ) - ( card D70 ) ) by L490 , XREAL_1:13;
L492: ( ( card D79 ) * ( card D67 ) ) <= ( ( ( card D67 ) - 1 ) * ( card D70 ) ) by L491 , L448;
L493: ( Sum C89 ) = D80 by L450 , RLAFFIN2:def 2;
L494: ( Sum C88 ) = C84 by L407 , L444 , RLAFFIN2:def 2;
L495: ( Sum C90 ) = C85 by L410 , L454 , RLAFFIN2:def 2;
L496: ( C84 - C85 ) = ( Sum ( D90 * ( C88 - C89 ) ) ) by L495 , L488 , L494 , RLVECT_3:4
.= ( D90 * ( Sum ( C88 - C89 ) ) ) by RLVECT_3:2
.= ( D90 * ( C84 - D80 ) ) by L493 , L494 , RLVECT_3:4;
thus L497: thesis by L496 , L413 , L429 , L442 , L492 , SIMPLEX0:def 4 , XREAL_1:102;
end;
end;
per cases  by L401 , XBOOLE_0:def 9;
suppose L499: C82 c= C83;

thus L500: thesis by L499 , L395 , L396 , L397 , L399 , L400 , L402;
end;
suppose L501: C83 c= C82;

consider C92 , C93 being (VECTOR of R12), C94 being Real such that L502: (C92 in ( Vertices ( BCS D68 ) ) & C93 in ( Vertices ( BCS D68 ) )) and L503: ( C81 - C80 ) = ( C94 * ( C92 - C93 ) ) and L504: (( 0 ) <= C94 & C94 <= ( ( ( card D67 ) - 1 ) / ( card D67 ) )) by L501 , L396 , L397 , L398 , L399 , L400 , L402;
take C93;
take C92;
take C94;
L505: ( C80 - C81 ) = ( - ( C94 * ( C92 - C93 ) ) ) by L503 , RLVECT_1:33
.= ( C94 * ( - ( C92 - C93 ) ) ) by RLVECT_1:25
.= ( C94 * ( C93 - C92 ) ) by RLVECT_1:33;
thus L506: thesis by L505 , L502 , L504;
end;
end;
theorem
L508: (for R5 being Nat holds (for R8 being set holds (for B69 being  affinely-independent (Subset of ( TOP-REAL R5 )) holds (for B70 being (Enumeration of B69) holds (( ( dom B70 ) \ R8 ) is non  empty implies ( conv ( B70 .: R8 ) ) = ( meet { ( conv ( B69 \ { ( B70 . B71 ) } ) ) where B71 is (Element of ( NAT )) : B71 in ( ( dom B70 ) \ R8 ) } ))))))
proof
let R5 being Nat;
let R8 being set;
let C95 being  affinely-independent (Subset of ( TOP-REAL R5 ));
let C96 being (Enumeration of C95);
assume that
L509: ( ( dom C96 ) \ R8 ) is non  empty;
set D91 = ( dom C96 );
defpred S5[ Nat ] means ($1 <> ( 0 ) implies (for R8 being set holds (( card ( ( dom C96 ) \ R8 ) ) = $1 implies ( conv ( C95 \ ( C96 .: ( D91 \ R8 ) ) ) ) = ( meet { ( conv ( C95 \ { ( C96 . B72 ) } ) ) where B72 is (Element of ( NAT )) : B72 in ( ( dom C96 ) \ R8 ) } ))));
L510: ( rng C96 ) = C95 by RLAFFIN3:def 1;
L511: (for B73 being Nat holds (S5[ B73 ] implies S5[ ( B73 + 1 ) ]))
proof
deffunc H4(set) = ( conv ( C95 \ { ( C96 . $1 ) } ) );
let C97 being Nat;
assume L512: S5[ C97 ];
set D92 = ( C97 + 1 );
assume L513: D92 <> ( 0 );
let R8 being set;
set D93 = { H4(B74) where B74 is (Element of ( NAT )) : B74 in ( D91 \ R8 ) };
assume L514: ( card ( D91 \ R8 ) ) = D92;
L515: ( D91 \ R8 ) is non  empty by L514;
consider C98 being set such that L516: C98 in ( D91 \ R8 ) by L515 , XBOOLE_0:def 1;
L517: C98 in D91 by L516 , XBOOLE_0:def 5;
reconsider D94 = C98 as (Element of ( NAT )) by L516;
L518: ( C96 .: { D94 } ) = ( Im (C96 , D94) ) by RELAT_1:def 16
.= { ( C96 . D94 ) } by L517 , FUNCT_1:59;
per cases ;
suppose L519: C97 = ( 0 );

consider C99 being set such that L520: ( D91 \ R8 ) = { C99 } by L519 , L514 , CARD_2:42;
L521: C99 = D94 by L516 , L520 , TARSKI:def 1;
L522: D93 c= { H4(D94) }
proof
let C100 being set;
assume L523: C100 in D93;
L524: (ex B75 being (Element of ( NAT )) st (C100 = H4(B75) & B75 in ( D91 \ R8 ))) by L523;
L525: C100 = H4(D94) by L524 , L520 , L521 , TARSKI:def 1;
thus L526: thesis by L525 , TARSKI:def 1;
end;
L527: H4(D94) in D93 by L516;
L528: D93 = { H4(D94) } by L527 , L522 , ZFMISC_1:33;
L529: ( C96 .: ( D91 \ R8 ) ) = { ( C96 . D94 ) } by L516 , L518 , L520 , TARSKI:def 1;
thus L530: thesis by L529 , L528 , SETFAM_1:10;
end;
suppose L531: C97 > ( 0 );

set D95 = ( R8 \/ { D94 } );
set D96 = { H4(B76) where B76 is (Element of ( NAT )) : B76 in ( D91 \ D95 ) };
set D97 = the (Element of ( D91 \ D95 ));
L532: ( ( ( D91 \ R8 ) \ { D94 } ) \/ { D94 } ) = ( D91 \ R8 ) by L516 , ZFMISC_1:116;
L533: ( ( D91 \ R8 ) \ { D94 } ) = ( D91 \ D95 ) by XBOOLE_1:41;
L534: D96 c= D93
proof
let C101 being set;
assume L535: C101 in D96;
consider C102 being (Element of ( NAT )) such that L536: C101 = H4(C102) and L537: C102 in ( D91 \ D95 ) by L535;
L538: C102 in ( D91 \ R8 ) by L533 , L532 , L537 , XBOOLE_0:def 3;
thus L539: thesis by L538 , L536;
end;
L540: D94 in { D94 } by TARSKI:def 1;
L541: (not D94 in ( ( D91 \ R8 ) \ { D94 } )) by L540 , XBOOLE_0:def 5;
L542: ( ( card ( ( D91 \ R8 ) \ { D94 } ) ) + 1 ) = ( card ( D91 \ R8 ) ) by L541 , L532 , CARD_2:41;
L543: ( D91 \ D95 ) is non  empty by L542 , L514 , L531 , L533;
L544: D97 in ( D91 \ D95 ) by L543;
L545: H4(D97) in D96 by L544;
set D98 = H4(D94);
set D99 = { D98 };
set D100 = ( Complex_of { C95 } );
L546: (the topology of D100) = ( bool C95 ) by SIMPLEX0:4;
L547: D93 c= ( D96 \/ D99 )
proof
let C103 being set;
assume L548: C103 in D93;
consider C104 being (Element of ( NAT )) such that L549: C103 = H4(C104) and L550: C104 in ( D91 \ R8 ) by L548;
L551: (C104 in ( D91 \ D95 ) or C104 in { D94 }) by L533 , L532 , L550 , XBOOLE_0:def 3;
L552: (C104 in ( D91 \ D95 ) or C104 = D94) by L551 , TARSKI:def 1;
L553: (C103 in D96 or C103 in D99) by L552 , L549 , TARSKI:def 1;
thus L554: thesis by L553 , XBOOLE_0:def 3;
end;
L555: H4(D94) in D93 by L516;
L556: D99 c= D93 by L555 , ZFMISC_1:31;
L557: ( D96 \/ D99 ) c= D93 by L556 , L534 , XBOOLE_1:8;
reconsider D101 = ( C95 \ ( C96 .: ( D91 \ D95 ) ) ) , D102 = ( C95 \ { ( C96 . D94 ) } ) as (Subset of D100);
L558: ( C95 \ { ( C96 . D94 ) } ) c= C95 by XBOOLE_1:36;
L559: D102 is  simplex-like by L558 , L546 , PRE_TOPC:def 2;
L560: ( C95 \ ( C96 .: ( D91 \ D95 ) ) ) c= C95 by XBOOLE_1:36;
L561: D101 is  simplex-like by L560 , L546 , PRE_TOPC:def 2;
L562: ( ( conv ( @ D101 ) ) /\ ( conv ( @ D102 ) ) ) = ( conv ( @ ( D101 /\ D102 ) ) ) by L561 , L559 , SIMPLEX1:def 8;
L563: ( ( C96 .: ( D91 \ D95 ) ) \/ { ( C96 . D94 ) } ) = ( C96 .: ( ( D91 \ D95 ) \/ { D94 } ) ) by L518 , RELAT_1:120
.= ( C96 .: ( D91 \ R8 ) ) by L532 , XBOOLE_1:41;
L564: ( D101 /\ D102 ) = ( C95 \ ( C96 .: ( D91 \ R8 ) ) ) by L563 , XBOOLE_1:53;
L565: ( conv ( C95 \ ( C96 .: ( D91 \ D95 ) ) ) ) = ( meet D96 ) by L512 , L514 , L531 , L533 , L542;
L566: ( conv ( C95 \ ( C96 .: ( D91 \ R8 ) ) ) ) = ( ( meet D96 ) /\ ( meet D99 ) ) by L565 , L564 , L562 , SETFAM_1:10
.= ( meet ( D96 \/ D99 ) ) by L545 , SETFAM_1:9;
thus L567: thesis by L566 , L557 , L547 , XBOOLE_0:def 10;
end;
end;
L569: S5[ ( 0 ) ];
L570: (for B77 being Nat holds S5[ B77 ]) from NAT_1:sch 2(L569 , L511);
L571: S5[ ( card ( D91 \ R8 ) ) ] by L570;
L572: ( D91 \ ( D91 \ R8 ) ) = ( D91 /\ R8 ) by XBOOLE_1:48;
L573: ( C96 .: R8 ) = ( C96 .: ( D91 \ ( D91 \ R8 ) ) ) by L572 , RELAT_1:112
.= ( ( C96 .: D91 ) \ ( C96 .: ( D91 \ R8 ) ) ) by FUNCT_1:64
.= ( C95 \ ( C96 .: ( D91 \ R8 ) ) ) by L510 , RELAT_1:113;
thus L574: thesis by L573 , L509 , L571;
end;
theorem
L575: (for R5 being Nat holds (for R14 being (Subset of ( TOP-REAL R5 )) holds (for B78 being  bounded (Subset of ( Euclid R5 )) holds (B78 = R14 implies (for B79 being (Point of ( Euclid R5 )) holds (B79 in ( conv R14 ) implies ( conv R14 ) c= ( cl_Ball (B79 , ( diameter B78 )) )))))))
proof
let R5 being Nat;
let R14 being (Subset of ( TOP-REAL R5 ));
L576: R5 in ( NAT ) by ORDINAL1:def 12;
L577: ( the TopStruct of ( TOP-REAL R5 ) ) = ( TopSpaceMetr ( Euclid R5 ) ) by EUCLID:def 8;
let C105 being  bounded (Subset of ( Euclid R5 ));
assume that
L578: R14 = C105;
let C106 being (Point of ( Euclid R5 ));
assume that
L579: C106 in ( conv R14 );
L580: R14 c= ( cl_Ball (C106 , ( diameter C105 )) )
proof
let C107 being set;
assume L581: C107 in R14;
reconsider D103 = C107 as (Point of ( Euclid R5 )) by L581 , L578;
reconsider D104 = D103 as (Point of ( TOP-REAL R5 )) by L577;
L582: ( cl_Ball (D103 , ( diameter C105 )) ) = ( cl_Ball (D104 , ( diameter C105 )) ) by L576 , TOPREAL9:14;
L583: R14 c= ( cl_Ball (D103 , ( diameter C105 )) )
proof
let C108 being set;
assume L584: C108 in R14;
reconsider D105 = C108 as (Point of ( Euclid R5 )) by L584 , L578;
L585: ( dist (D103 , D105) ) <= ( diameter C105 ) by L578 , L581 , L584 , TBSP_1:def 8;
thus L586: thesis by L585 , METRIC_1:12;
end;
L587: ( conv R14 ) c= ( cl_Ball (D104 , ( diameter C105 )) ) by L583 , L582 , CONVEX1:30;
L588: ( dist (D103 , C106) ) <= ( diameter C105 ) by L587 , L579 , L582 , METRIC_1:12;
thus L589: thesis by L588 , METRIC_1:12;
end;
reconsider D106 = C106 as (Point of ( TOP-REAL R5 )) by L577;
L590: ( cl_Ball (C106 , ( diameter C105 )) ) = ( cl_Ball (D106 , ( diameter C105 )) ) by L576 , TOPREAL9:14;
thus L591: thesis by L590 , L580 , CONVEX1:30;
end;
theorem
L592: (for R5 being Nat holds (for R14 being (Subset of ( TOP-REAL R5 )) holds (R14 is  bounded iff ( conv R14 ) is  bounded)))
proof
let R5 being Nat;
let R14 being (Subset of ( TOP-REAL R5 ));
L593: ( the TopStruct of ( TOP-REAL R5 ) ) = ( TopSpaceMetr ( Euclid R5 ) ) by EUCLID:def 8;
reconsider D107 = ( conv R14 ) , D108 = R14 as (Subset of ( Euclid R5 )) by L593;
thus L594:now
assume L595: R14 is  bounded;
reconsider D109 = D108 as  bounded (Subset of ( Euclid R5 )) by L595 , JORDAN2C:11;
set D110 = ( diameter D109 );
L596:
now
let C109 , C110 being (Point of ( Euclid R5 ));
assume L597: C109 in D107;
L598: ( conv R14 ) c= ( cl_Ball (C109 , D110) ) by L597 , L575;
assume L599: C110 in D107;
L600: ( dist (C109 , C110) ) <= D110 by L599 , L598 , METRIC_1:12;
thus L601: ( dist (C109 , C110) ) <= ( D110 + 1 ) by L600 , XREAL_1:39;
end;
L602: D110 >= ( 0 ) by TBSP_1:21;
L603: D107 is  bounded by L602 , L596 , TBSP_1:def 7;
thus L604: ( conv R14 ) is  bounded by L603 , JORDAN2C:11;
end;
assume L605: ( conv R14 ) is  bounded;
L606: D107 is  bounded by L605 , JORDAN2C:11;
L607: D108 is  bounded by L606 , CONVEX1:41 , TBSP_1:14;
thus L608: thesis by L607 , JORDAN2C:11;
end;
theorem
L609: (for R5 being Nat holds (for R14 being (Subset of ( TOP-REAL R5 )) holds (for B80 , B81 being  bounded (Subset of ( Euclid R5 )) holds ((B81 = ( conv R14 ) & B80 = R14) implies ( diameter B80 ) = ( diameter B81 )))))
proof
let R5 being Nat;
let R14 being (Subset of ( TOP-REAL R5 ));
let C111 , C112 being  bounded (Subset of ( Euclid R5 ));
assume that
L610: C112 = ( conv R14 )
and
L611: C111 = R14;
per cases ;
suppose L612: C111 is  empty;

thus L613: thesis by L612 , L610 , L611;
end;
suppose L614: C111 is non  empty;

L615:
now
let C113 , C114 being (Point of ( Euclid R5 ));
assume L616: C113 in C112;
L617: ( conv R14 ) c= ( cl_Ball (C113 , ( diameter C111 )) ) by L616 , L610 , L611 , L575;
assume L618: C114 in C112;
thus L619: ( dist (C113 , C114) ) <= ( diameter C111 ) by L618 , L610 , L617 , METRIC_1:12;
end;
L620: ( diameter C112 ) <= ( diameter C111 ) by L615 , L610 , L611 , L614 , TBSP_1:def 8;
L621: ( diameter C111 ) <= ( diameter C112 ) by L610 , L611 , CONVEX1:41 , TBSP_1:24;
thus L622: thesis by L621 , L620 , XXREAL_0:1;
end;
end;
registration
let R5 being Nat;
let C115 being  bounded (SimplicialComplexStr of ( TOP-REAL R5 ));
cluster  ->  bounded for (SubdivisionStr of C115);
coherence
proof
let C116 being (SubdivisionStr of C115);
consider C117 being  real number such that L624: (for B82 being (Subset of ( Euclid R5 )) holds (B82 in (the topology of C115) implies (B82 is  bounded & ( diameter B82 ) <= C117))) by L226;
take C117;
let C118 being (Subset of ( Euclid R5 ));
assume L625: C118 in (the topology of C116);
reconsider D111 = C118 as (Subset of C116) by L625;
L626: D111 is  simplex-like by L625 , PRE_TOPC:def 2;
consider C119 being (Subset of C115) such that L627: C119 is  simplex-like and L628: ( conv ( @ D111 ) ) c= ( conv ( @ C119 ) ) by L626 , SIMPLEX1:def 4;
L629: ( [#] ( TOP-REAL R5 ) ) = ( [#] ( Euclid R5 ) ) by L383;
reconsider D112 = ( conv ( @ D111 ) ) as (Subset of ( Euclid R5 )) by L629;
L630: ( [#] C115 ) c= ( [#] ( TOP-REAL R5 ) ) by SIMPLEX0:def 9;
reconsider D113 = C119 as (Subset of ( Euclid R5 )) by L630 , L629 , XBOOLE_1:1;
L631: D113 in (the topology of C115) by L627 , PRE_TOPC:def 2;
L632: ( diameter D113 ) <= C117 by L631 , L624;
L633: D113 is  bounded by L624 , L631;
L634: ( @ C119 ) is  bounded by L633 , JORDAN2C:11;
L635: ( conv ( @ C119 ) ) is  bounded by L634 , L592;
reconsider D114 = ( conv ( @ C119 ) ) as  bounded (Subset of ( Euclid R5 )) by L635 , JORDAN2C:11;
L636: ( diameter D112 ) <= ( diameter D114 ) by L628 , TBSP_1:24;
L637: D112 c= D114 by L628;
L638: D112 is  bounded by L637 , TBSP_1:14;
L639: C118 is  bounded by L638 , CONVEX1:41 , TBSP_1:14;
L640: ( diameter D112 ) = ( diameter C118 ) by L639 , L638 , L609;
L641: ( diameter D114 ) = ( diameter D113 ) by L633 , L609;
thus L642: thesis by L641 , L636 , L638 , L640 , L632 , CONVEX1:41 , TBSP_1:14 , XXREAL_0:2;
end;
end;
theorem
L644: (for R5 being Nat holds (for B83 being  bounded  finite-degree non  void (SimplicialComplex of ( TOP-REAL R5 )) holds (|. B83 .| c= ( [#] B83 ) implies ( diameter ( BCS B83 ) ) <= ( ( ( degree B83 ) / ( ( degree B83 ) + 1 ) ) * ( diameter B83 ) ))))
proof
let R5 being Nat;
set D115 = ( TOP-REAL R5 );
let C120 being  bounded  finite-degree non  void (SimplicialComplex of D115);
set D116 = ( BCS C120 );
set D117 = ( center_of_mass D115 );
set D118 = ( degree C120 );
assume L645: |. C120 .| c= ( [#] C120 );
L646: ( BCS C120 ) = ( subdivision (D117 , C120) ) by L645 , SIMPLEX1:def 5;
L647: (for B84 being (Subset of ( Euclid R5 )) holds (B84 is (Simplex of D116) implies ( diameter B84 ) <= ( ( D118 / ( D118 + 1 ) ) * ( diameter C120 ) )))
proof
let C121 being (Subset of ( Euclid R5 ));
reconsider D119 = 1 as  ext-real number;
assume L648: C121 is (Simplex of D116);
reconsider D120 = C121 as (Simplex of D116) by L648;
consider C122 being  c=-linear  finite  simplex-like (Subset-Family of C120) such that L649: C121 = ( D117 .: C122 ) by L646 , L648 , SIMPLEX0:def 20;
L650: C121 is  bounded by L648 , L228;
reconsider D121 = ( @ C122 ) as  c=-linear  finite  finite-membered (Subset-Family of D115);
set D122 = ( union D121 );
set D123 = ( Complex_of { D122 } );
L651: (( union C122 ) is  empty or ( union C122 ) in C122) by SIMPLEX0:9 , ZFMISC_1:2;
L652: ( union C122 ) is  simplex-like by L651 , TOPS_2:def 1;
L653: ( card ( union C122 ) ) <= ( ( degree C120 ) + D119 ) by L652 , SIMPLEX0:24;
L654: ( diameter C120 ) >= ( 0 ) by L295;
L655: (not ( {} ) in ( dom D117 )) by ORDERS_1:1;
L656: ( dom D117 ) is  with_non-empty_elements by L655 , SETFAM_1:def 8;
L657: ( [#] D115 ) = ( [#] ( Euclid R5 ) ) by L383;
reconsider D124 = D122 as (Subset of ( Euclid R5 )) by L657;
L658: D120 in (the topology of D116) by PRE_TOPC:def 2;
per cases ;
suppose L659: C120 is  empty-membered;

L660: D118 = ( - 1 ) by L659 , SIMPLEX0:22;
L661: (( - 1 ) <= ( degree D116 ) & ( degree D116 ) <= ( - 1 )) by L660 , L646 , L656 , SIMPLEX0:23 , SIMPLEX0:52;
L662: ( degree D116 ) = ( - 1 ) by L661 , XXREAL_0:1;
L663: D116 is  empty-membered by L662 , SIMPLEX0:22;
L664: (the topology of D116) is  empty-membered by L663 , SIMPLEX0:def 7;
L665: D120 = ( {} ) by L664 , L658 , SETFAM_1:def 10;
L666: ( D118 / ( D118 + 1 ) ) = ( 0 ) by L660;
thus L667: thesis by L666 , L665 , TBSP_1:def 8;
end;
suppose L668: C120 is non  empty-membered;

L669: (( degree C120 ) >= ( - 1 ) & D118 <> ( - 1 )) by L668 , SIMPLEX0:22 , SIMPLEX0:23;
L670: D118 > ( - 1 ) by L669 , XXREAL_0:1;
L671: D118 >= ( ( - 1 ) + 1 ) by L670 , INT_1:7;
L672: ( ( D118 / ( D118 + 1 ) ) * ( diameter C120 ) ) >= ( 0 ) by L671 , L654;
per cases ;
suppose L673: D120 is  empty;

thus L674: thesis by L673 , L672 , TBSP_1:def 8;
end;
suppose L675: D120 is non  empty;

L676:
now
L677: D124 is  bounded;
L678: D122 is  bounded by L677 , JORDAN2C:11;
L679: ( conv D122 ) is  bounded by L678 , L592;
reconsider D125 = ( conv D122 ) as  bounded (Subset of ( Euclid R5 )) by L679 , JORDAN2C:11;
let C123 , C124 being (Point of ( Euclid R5 ));
assume that
L680: C123 in C121
and
L681: C124 in C121;
reconsider D126 = C123 , D127 = C124 as (Element of D115) by L657;
L682: (|. ( BCS D123 ) .| = |. D123 .| & |. D123 .| = ( conv D122 )) by SIMPLEX1:8 , SIMPLEX1:10;
consider C125 being set such that L683: C125 in ( dom D117 ) and L684: C125 in D121 and L685: ( D117 . C125 ) = C123 by L649 , L680 , FUNCT_1:def 6;
L686: C125 c= D122 by L684 , ZFMISC_1:74;
L687: D122 <> ( {} ) by L686 , L655 , L683;
L688: ( card D122 ) <= ( D118 + 1 ) by L653 , XXREAL_3:def 2;
L689: ( ( D118 + 1 ) " ) <= ( ( card D122 ) " ) by L688 , L687 , XREAL_1:85;
L690: ( diameter D124 ) <= ( diameter C120 ) by L652 , L334;
L691: ( ( ( card D122 ) - 1 ) / ( card D122 ) ) = ( ( ( card D122 ) / ( card D122 ) ) - ( 1 / ( card D122 ) ) )
.= ( 1 - ( 1 / ( card D122 ) ) ) by L687 , XCMPLX_1:60;
L692: ( diameter D125 ) = ( diameter D124 ) by L609;
consider C126 , C127 being (VECTOR of D115), C128 being Real such that L693: C126 in ( Vertices ( BCS D123 ) ) and L694: C127 in ( Vertices ( BCS D123 ) ) and L695: ( D126 - D127 ) = ( C128 * ( C126 - C127 ) ) and L696: ( 0 ) <= C128 and L697: C128 <= ( ( ( card D122 ) - 1 ) / ( card D122 ) ) by L649 , L675 , L680 , L681 , L391;
reconsider D128 = C126 , D129 = C127 as (Element of ( BCS D123 )) by L693 , L694;
L698: D128 is  vertex-like by L693 , SIMPLEX0:def 4;
consider C129 being (Subset of ( BCS D123 )) such that L699: C129 is  simplex-like and L700: D128 in C129 by L698 , SIMPLEX0:def 3;
L701: ( conv ( @ C129 ) ) c= |. ( BCS D123 ) .| by L699 , SIMPLEX1:5;
L702: D129 is  vertex-like by L694 , SIMPLEX0:def 4;
consider C130 being (Subset of ( BCS D123 )) such that L703: C130 is  simplex-like and L704: D129 in C130 by L702 , SIMPLEX0:def 3;
L705: ( @ C130 ) c= ( conv ( @ C130 ) ) by CONVEX1:41;
L706: D129 in ( conv ( @ C130 ) ) by L705 , L704;
L707: ( @ C129 ) c= ( conv ( @ C129 ) ) by CONVEX1:41;
L708: D128 in ( conv ( @ C129 ) ) by L707 , L700;
reconsider D130 = C126 , D131 = C127 as (Point of ( Euclid R5 )) by L657;
L709: ( D118 / ( D118 + 1 ) ) = ( ( ( D118 + 1 ) / ( D118 + 1 ) ) - ( 1 / ( D118 + 1 ) ) )
.= ( 1 - ( 1 / ( D118 + 1 ) ) ) by L671 , XCMPLX_1:60;
L710: ( ( ( card D122 ) - 1 ) / ( card D122 ) ) <= ( D118 / ( D118 + 1 ) ) by L709 , L689 , L691 , XREAL_1:10;
L711: (( dist (D130 , D131) ) >= ( 0 ) & C128 <= ( D118 / ( D118 + 1 ) )) by L710 , L697 , XXREAL_0:2;
L712: ( conv ( @ C130 ) ) c= |. ( BCS D123 ) .| by L703 , SIMPLEX1:5;
L713: ( dist (D130 , D131) ) <= ( diameter D124 ) by L712 , L682 , L692 , L708 , L706 , L701 , TBSP_1:def 8;
L714: ( dist (D130 , D131) ) <= ( diameter C120 ) by L713 , L690 , XXREAL_0:2;
L715: ( dist (C123 , C124) ) = |. ( C123 - C124 ) .| by EUCLID:def 6
.= |. ( D126 - D127 ) .|
.= |. ( C128 * ( D130 - D131 ) ) .| by L695
.= ( ( abs C128 ) * |. ( D130 - D131 ) .| ) by EUCLID:11
.= ( C128 * |. ( D130 - D131 ) .| ) by L696 , ABSVALUE:def 1
.= ( C128 * ( dist (D130 , D131) ) ) by EUCLID:def 6;
thus L716: ( dist (C123 , C124) ) <= ( ( D118 / ( D118 + 1 ) ) * ( diameter C120 ) ) by L715 , L696 , L714 , L711 , XREAL_1:66;
end;
thus L717: thesis by L676 , L650 , L675 , TBSP_1:def 8;
end;
end;
end;
thus L720: thesis by L647 , L334;
end;
theorem
L721: (for R5 being Nat holds (for R6 being Nat holds (for B85 being  bounded  finite-degree non  void (SimplicialComplex of ( TOP-REAL R5 )) holds (|. B85 .| c= ( [#] B85 ) implies ( diameter ( BCS (R6 , B85) ) ) <= ( ( ( ( degree B85 ) / ( ( degree B85 ) + 1 ) ) |^ R6 ) * ( diameter B85 ) )))))
proof
let R5 being Nat;
let R6 being Nat;
let C131 being  bounded  finite-degree non  void (SimplicialComplex of ( TOP-REAL R5 ));
set D132 = ( degree C131 );
set D133 = ( D132 / ( D132 + 1 ) );
defpred S6[ Nat ] means (( diameter ( BCS ($1 , C131) ) ) <= ( ( D133 |^ $1 ) * ( diameter C131 ) ) & ( BCS ($1 , C131) ) is  finite-degree & ( degree ( BCS ($1 , C131) ) ) <= D132);
assume L722: |. C131 .| c= ( [#] C131 );
L723: (for R6 being Nat holds (S6[ R6 ] implies S6[ ( R6 + 1 ) ]))
proof
let R6 being Nat;
set D134 = ( TOP-REAL R5 );
set D135 = ( BCS (R6 , C131) );
set D136 = ( center_of_mass D134 );
L724: ( degree C131 ) >= ( - 1 ) by SIMPLEX0:23;
assume L725: S6[ R6 ];
reconsider D137 = ( BCS (R6 , C131) ) as  bounded  finite-degree non  void (SimplicialComplex of ( TOP-REAL R5 )) by L725;
set D138 = ( degree D137 );
L726: ( degree D137 ) >= ( - 1 ) by SIMPLEX0:23;
L727: ( 0 ) <= ( diameter C131 ) by L295;
L728: ( 0 ) <= ( diameter D137 ) by L295;
L729: (|. D137 .| = |. C131 .| & ( [#] D137 ) = ( [#] C131 )) by L722 , SIMPLEX1:18 , SIMPLEX1:19;
L730: ( BCS D137 ) = ( subdivision (D136 , D137) ) by L729 , L722 , SIMPLEX1:def 5;
L731: ( BCS (( R6 + 1 ) , C131) ) = ( BCS D137 ) by L722 , SIMPLEX1:20;
L732: ( diameter ( BCS (( R6 + 1 ) , C131) ) ) <= ( ( D138 / ( D138 + 1 ) ) * ( diameter D137 ) ) by L731 , L722 , L729 , L644;
L733: (not ( {} ) in ( dom D136 )) by ORDERS_1:1;
L734: ( dom D136 ) is  with_non-empty_elements by L733 , SETFAM_1:def 8;
L735: ( degree ( BCS (( R6 + 1 ) , C131) ) ) <= D138 by L734 , L730 , L731 , SIMPLEX0:52;
per cases ;
suppose L736: (D138 = ( - 1 ) or D138 = ( 0 ));

L737: ( D138 / ( D138 + 1 ) ) = ( 0 ) by L736;
per cases ;
suppose L738: (D132 = ( 0 ) or D132 = ( - 1 ));

L739: ( D132 / ( D132 + 1 ) ) = ( 0 ) by L738;
L740: ( 0 ) = ( ( D132 / ( D132 + 1 ) ) |^ ( R6 + 1 ) ) by L739 , NAT_1:11 , NEWTON:11;
thus L741: thesis by L740 , L722 , L725 , L730 , L732 , L735 , L737 , SIMPLEX1:20 , XXREAL_0:2;
end;
suppose L742: (D132 <> ( 0 ) & D132 <> ( - 1 ));

L743: D132 > ( - 1 ) by L742 , L724 , XXREAL_0:1;
L744: D132 >= ( ( - 1 ) + 1 ) by L743 , INT_1:7;
L745: D133 > ( 0 ) by L744 , L742 , XREAL_1:139;
L746: ( D133 |^ ( R6 + 1 ) ) > ( 0 ) by L745 , NEWTON:83;
thus L747: thesis by L746 , L722 , L725 , L727 , L730 , L732 , L735 , L737 , SIMPLEX1:20 , XXREAL_0:2;
end;
end;
suppose L749: (D138 <> ( - 1 ) & D138 <> ( 0 ));

L750: D138 > ( - 1 ) by L749 , L726 , XXREAL_0:1;
L751: D138 >= ( ( - 1 ) + 1 ) by L750 , INT_1:7;
L752: ( D138 / ( D138 + 1 ) ) = ( ( ( D138 + 1 ) / ( D138 + 1 ) ) - ( 1 / ( D138 + 1 ) ) )
.= ( 1 - ( 1 / ( D138 + 1 ) ) ) by L751 , XCMPLX_1:60;
L753: D133 = ( ( ( D132 + 1 ) / ( D132 + 1 ) ) - ( 1 / ( D132 + 1 ) ) )
.= ( 1 - ( 1 / ( D132 + 1 ) ) ) by L725 , L751 , XCMPLX_1:60;
L754: ( D138 + 1 ) <= ( D132 + 1 ) by L725 , XREAL_1:6;
L755: ( 1 / ( D132 + 1 ) ) <= ( 1 / ( D138 + 1 ) ) by L754 , L751 , XREAL_1:85;
L756: ( ( degree D137 ) / ( ( degree D137 ) + 1 ) ) <= ( D132 / ( D132 + 1 ) ) by L755 , L752 , L753 , XREAL_1:10;
L757: ( ( ( degree D137 ) / ( ( degree D137 ) + 1 ) ) * ( diameter D137 ) ) <= ( ( D132 / ( D132 + 1 ) ) * ( ( ( D132 / ( D132 + 1 ) ) |^ R6 ) * ( diameter C131 ) ) ) by L756 , L725 , L728 , L751 , XREAL_1:66;
L758: ( ( D132 / ( D132 + 1 ) ) * ( ( ( D132 / ( D132 + 1 ) ) |^ R6 ) * ( diameter C131 ) ) ) = ( ( ( D132 / ( D132 + 1 ) ) * ( ( D132 / ( D132 + 1 ) ) |^ R6 ) ) * ( diameter C131 ) )
.= ( ( ( D132 / ( D132 + 1 ) ) |^ ( R6 + 1 ) ) * ( diameter C131 ) ) by NEWTON:6;
thus L759: thesis by L758 , L722 , L725 , L730 , L732 , L735 , L757 , SIMPLEX1:20 , XXREAL_0:2;
end;
end;
L761: ( D133 |^ (( 0 ) qua Nat) ) = 1 by NEWTON:4;
L762: S6[ ( 0 ) ] by L761 , L722 , SIMPLEX1:16;
L763: (for R6 being Nat holds S6[ R6 ]) from NAT_1:sch 2(L762 , L723);
thus L764: thesis by L763;
end;
theorem
L765: (for R5 being Nat holds (for B86 being  bounded  finite-degree non  void (SimplicialComplex of ( TOP-REAL R5 )) holds (|. B86 .| c= ( [#] B86 ) implies (for R7 being  real number holds (R7 > ( 0 ) implies (ex R6 being Nat st ( diameter ( BCS (R6 , B86) ) ) < R7))))))
proof
let R5 being Nat;
let C132 being  bounded  finite-degree non  void (SimplicialComplex of ( TOP-REAL R5 ));
assume that
L766: |. C132 .| c= ( [#] C132 );
set D139 = ( degree C132 );
let C133 being  real number;
assume that
L767: C133 > ( 0 );
set D140 = ( D139 / ( D139 + 1 ) );
per cases ;
suppose L768: (D139 = ( 0 ) or D139 = ( - 1 ));

L769: D140 = ( 0 ) by L768;
L770: (( diameter ( BCS C132 ) ) <= ( D140 * ( diameter C132 ) ) & ( BCS C132 ) = ( BCS (1 , C132) )) by L766 , L644 , SIMPLEX1:17;
thus L771: thesis by L770 , L767 , L769;
end;
suppose L772: ( diameter C132 ) = ( 0 );

L773: C132 = ( BCS (( 0 ) , C132) ) by L766 , SIMPLEX1:16;
thus L774: thesis by L773 , L767 , L772;
end;
suppose L775: (D139 <> ( 0 ) & D139 <> ( - 1 ) & ( diameter C132 ) <> ( 0 ));

L776: D139 >= ( - 1 ) by SIMPLEX0:23;
L777: D139 > ( - 1 ) by L776 , L775 , XXREAL_0:1;
L778: D139 >= ( ( - 1 ) + 1 ) by L777 , INT_1:7;
L779: D140 > ( 0 ) by L778 , L775 , XREAL_1:139;
L780: ( D139 + 1 ) > D139 by XREAL_1:29;
L781: D140 < 1 by L780 , L778 , XREAL_1:189;
L782: (D140 in ( REAL ) & ( C133 / ( diameter C132 ) ) in ( REAL )) by XREAL_0:def 1;
L783: ( diameter C132 ) > ( 0 ) by L775 , L295;
L784: ( C133 / ( diameter C132 ) ) > ( 0 ) by L783 , L767 , XREAL_1:139;
consider C134 being (Element of ( NAT )) such that L785: ( D140 to_power C134 ) < ( C133 / ( diameter C132 ) ) by L784 , L779 , L781 , L782 , TBSP_1:3;
L786: ( ( C133 / ( diameter C132 ) ) * ( diameter C132 ) ) = C133 by L775 , XCMPLX_1:87;
L787: ( diameter ( BCS (C134 , C132) ) ) <= ( ( D140 |^ C134 ) * ( diameter C132 ) ) by L766 , L721;
L788: ( D140 to_power C134 ) = ( D140 |^ C134 ) by POWER:41;
L789: ( ( D140 |^ C134 ) * ( diameter C132 ) ) < C133 by L788 , L783 , L785 , L786 , XREAL_1:68;
L790: ( diameter ( BCS (C134 , C132) ) ) < C133 by L789 , L787 , XXREAL_0:2;
thus L791: thesis by L790;
end;
end;
theorem
L793: (for B87 , B88 being (Element of ( NAT )) holds (ex B89 being (Function of [: ( TOP-REAL B87 ) , ( TOP-REAL B88 ) :] , ( TOP-REAL ( B87 + B88 ) )) st (B89 is  being_homeomorphism & (for B90 being (Element of ( TOP-REAL B87 )) holds (for B91 being (Element of ( TOP-REAL B88 )) holds ( B89 . (B90 , B91) ) = ( B90 ^ B91 ))))))
proof
let C135 , C136 being (Element of ( NAT ));
set D141 = ( TOP-REAL C135 );
set D142 = ( TOP-REAL C136 );
set D143 = ( TOP-REAL ( C135 + C136 ) );
set D144 = ( the TopStruct of D141 );
set D145 = ( the TopStruct of D142 );
set D146 = ( the TopStruct of D143 );
L794: D145 = ( TopSpaceMetr ( Euclid C136 ) ) by EUCLID:def 8;
L795: (D146 = ( TopSpaceMetr ( Euclid ( C135 + C136 ) ) ) & D144 = ( TopSpaceMetr ( Euclid C135 ) )) by EUCLID:def 8;
consider C137 being (Function of [: D144 , D145 :] , D146) such that L796: C137 is  being_homeomorphism and L797: (for B92 , B93 being FinSequence holds ([ B92 , B93 ] in ( dom C137 ) implies ( C137 . (B92 , B93) ) = ( B92 ^ B93 ))) by L795 , L794 , TOPREAL7:26;
L798: ( rng C137 ) = ( [#] D146 ) by L796 , TOPS_2:60;
L799: ( rng C137 ) = ( [#] D143 ) by L798;
L800: ( [#] [: D141 , D142 :] ) = [: ( [#] D141 ) , ( [#] D142 ) :] by BORSUK_1:def 2;
L801: [: D141 , D142 :] = ( [: D141 , D142 :] | ( [#] [: D141 , D142 :] ) ) by TSEP_1:3
.= [: ( D141 | ( [#] D141 ) ) , ( D142 | ( [#] D142 ) ) :] by L800 , BORSUK_3:22
.= [: D144 , ( D142 | ( [#] D142 ) ) :] by TSEP_1:93
.= [: D144 , D145 :] by TSEP_1:93;
reconsider D147 = C137 as (Function of [: D141 , D142 :] , D143) by L801;
L802:
now
let C138 being (Subset of [: D141 , D142 :]);
thus L803: ( D147 .: ( Cl C138 ) ) = ( Cl ( C137 .: C138 ) ) by L796 , L801 , TOPS_2:60
.= ( Cl ( D147 .: C138 ) ) by TOPS_3:80;
end;
take D147;
L804: D147 is  one-to-one by L796 , TOPS_2:60;
L805: ( dom D147 ) = ( [#] [: D141 , D142 :] ) by L796 , L801 , TOPS_2:60;
thus L806: D147 is  being_homeomorphism by L805 , L799 , L802 , L804 , TOPS_2:60;
let C139 being (Element of ( TOP-REAL C135 ));
let C140 being (Element of ( TOP-REAL C136 ));
L807: ( dom D147 ) = [: ( [#] D141 ) , ( [#] D142 ) :] by L800 , FUNCT_2:def 1;
L808: [ C139 , C140 ] in ( dom D147 ) by L807 , ZFMISC_1:87;
thus L809: thesis by L808 , L797;
end;
L810: (for B94 being Nat holds ( [#] ( TOP-REAL B94 ) ) = ( [#] ( TopSpaceMetr ( Euclid B94 ) ) ))
proof
let C141 being Nat;
L811: ( the TopStruct of ( TOP-REAL C141 ) ) = ( TopSpaceMetr ( Euclid C141 ) ) by EUCLID:def 8;
thus L812: thesis by L811;
end;
theorem
L813: (for B95 , B96 being (Element of ( NAT )) holds (for B97 being (Function of [: ( TOP-REAL B95 ) , ( TOP-REAL B96 ) :] , ( TOP-REAL ( B95 + B96 ) )) holds ((for B98 being (Element of ( TOP-REAL B95 )) holds (for B99 being (Element of ( TOP-REAL B96 )) holds ( B97 . (B98 , B99) ) = ( B98 ^ B99 ))) implies (for R7 being  real number holds (for B100 being (Point of ( Euclid B95 )) holds (for B101 being (Point of ( Euclid B96 )) holds (for B102 being (Point of ( Euclid ( B95 + B96 ) )) holds (B102 = ( B100 ^ B101 ) implies ( B97 .: [: ( OpenHypercube (B100 , R7) ) , ( OpenHypercube (B101 , R7) ) :] ) = ( OpenHypercube (B102 , R7) )))))))))
proof
let C142 , C143 being (Element of ( NAT ));
let C144 being (Function of [: ( TOP-REAL C142 ) , ( TOP-REAL C143 ) :] , ( TOP-REAL ( C142 + C143 ) ));
assume that
L814: (for B103 being (Element of ( TOP-REAL C142 )) holds (for B104 being (Element of ( TOP-REAL C143 )) holds ( C144 . (B103 , B104) ) = ( B103 ^ B104 )));
let C145 being  real number;
let C146 being (Point of ( Euclid C142 ));
let C147 being (Point of ( Euclid C143 ));
let C148 being (Point of ( Euclid ( C142 + C143 ) ));
assume that
L815: C148 = ( C146 ^ C147 );
set D148 = ( Intervals (C146 , C145) );
set D149 = ( Intervals (C147 , C145) );
set D150 = ( Intervals (C148 , C145) );
L816: ( OpenHypercube (C146 , C145) ) = ( product D148 ) by EUCLID_9:def 4;
L817: ( [#] ( TOP-REAL C142 ) ) = ( [#] ( TopSpaceMetr ( Euclid C142 ) ) ) by L810;
L818: ( [#] ( TOP-REAL C143 ) ) = ( [#] ( TopSpaceMetr ( Euclid C143 ) ) ) by L810;
L819: ( OpenHypercube (C147 , C145) ) = ( product D149 ) by EUCLID_9:def 4;
L820: ( D148 ^ D149 ) = D150 by L815 , RLAFFIN3:1;
L821: ( C144 .: [: ( product D148 ) , ( product D149 ) :] ) c= ( product D150 )
proof
let C149 being set;
assume L822: C149 in ( C144 .: [: ( product D148 ) , ( product D149 ) :] );
consider C150 being set such that L823: C150 in ( dom C144 ) and L824: C150 in [: ( product D148 ) , ( product D149 ) :] and L825: ( C144 . C150 ) = C149 by L822 , FUNCT_1:def 6;
consider C151 , C152 being set such that L826: C151 in ( product D148 ) and L827: C152 in ( product D149 ) and L828: C150 = [ C151 , C152 ] by L824 , ZFMISC_1:def 2;
reconsider D151 = C151 as (Element of ( TOP-REAL C142 )) by L816 , L817 , L826;
reconsider D152 = C152 as (Element of ( TOP-REAL C143 )) by L818 , L819 , L827;
L829: C149 = ( C144 . (D151 , D152) ) by L825 , L828 , BINOP_1:def 1
.= ( D151 ^ D152 ) by L814;
thus L830: C149 in ( product D150 ) by L829 , L820 , L826 , L827 , RLAFFIN3:2;
end;
L831: ( product D150 ) c= ( C144 .: [: ( product D148 ) , ( product D149 ) :] )
proof
let C153 being set;
assume L832: C153 in ( product D150 );
consider C154 , C155 being FinSequence such that L833: C153 = ( C154 ^ C155 ) and L834: (C154 in ( product D148 ) & C155 in ( product D149 )) by L832 , L820 , RLAFFIN3:2;
L835: [ C154 , C155 ] in [: ( product D148 ) , ( product D149 ) :] by L834 , ZFMISC_1:87;
L836: [ C154 , C155 ] in [: ( [#] ( TOP-REAL C142 ) ) , ( [#] ( TOP-REAL C143 ) ) :] by L816 , L818 , L817 , L819 , L834 , ZFMISC_1:87;
L837: [ C154 , C155 ] in ( [#] [: ( TOP-REAL C142 ) , ( TOP-REAL C143 ) :] ) by L836;
L838: [ C154 , C155 ] in ( dom C144 ) by L837 , FUNCT_2:def 1;
L839: C153 = ( C144 . (C154 , C155) ) by L814 , L816 , L818 , L817 , L819 , L833 , L834
.= ( C144 . [ C154 , C155 ] ) by BINOP_1:def 1;
thus L840: thesis by L839 , L835 , L838 , FUNCT_1:def 6;
end;
L841: ( OpenHypercube (C148 , C145) ) = ( product D150 ) by EUCLID_9:def 4;
thus L842: thesis by L841 , L816 , L819 , L821 , L831 , XBOOLE_0:def 10;
end;
theorem
L843: (for R5 being Nat holds (for R14 being (Subset of ( TOP-REAL R5 )) holds (R14 is  bounded iff (ex B105 being (Point of ( Euclid R5 )) st (ex R7 being  real number st R14 c= ( OpenHypercube (B105 , R7) ))))))
proof
let R5 being Nat;
let R14 being (Subset of ( TOP-REAL R5 ));
reconsider D153 = R14 as (Subset of ( Euclid R5 )) by TOPREAL3:8;
thus L844: (R14 is  bounded implies (ex B106 being (Point of ( Euclid R5 )) st (ex B107 being  real number st R14 c= ( OpenHypercube (B106 , B107) ))))
proof
assume L845: R14 is  bounded;
L846: D153 is  bounded by L845 , JORDAN2C:11;
per cases ;
suppose L847: R14 is  empty;

take D154 = the (Point of ( Euclid R5 ));
take D155 = the  real number;
thus L848: thesis by L847 , XBOOLE_1:2;
end;
suppose L849: R14 is non  empty;

consider C156 being set such that L850: C156 in D153 by L849 , XBOOLE_0:def 1;
reconsider D156 = C156 as (Element of ( Euclid R5 )) by L850;
consider C157 being Real such that L851: ( 0 ) < C157 and L852: (for B108 , B109 being (Point of ( Euclid R5 )) holds ((B108 in D153 & B109 in D153) implies ( dist (B108 , B109) ) <= C157)) by L846 , TBSP_1:def 7;
take D156;
take D157 = ( C157 + 1 );
L853: D153 c= ( Ball (D156 , D157) )
proof
let C158 being set;
assume L854: C158 in D153;
reconsider D158 = C158 as (Element of ( Euclid R5 )) by L854;
L855: ( dist (D156 , D158) ) < D157 by L850 , L852 , L854 , XREAL_1:39;
thus L856: thesis by L855 , METRIC_1:11;
end;
L857: ( Ball (D156 , D157) ) c= ( OpenHypercube (D156 , D157) ) by EUCLID_9:22;
thus L858: R14 c= ( OpenHypercube (D156 , D157) ) by L857 , L853 , XBOOLE_1:1;
end;
end;

given C159 being (Point of ( Euclid R5 )) , C160 being  real number such that
L860: R14 c= ( OpenHypercube (C159 , C160) );

per cases ;
suppose L861: R5 = ( 0 );

L862: ( OpenHypercube (C159 , C160) ) = { ( {} ) } by L861 , EUCLID_9:12;
L863: (D153 = ( {} ) or D153 = { ( 0 ) }) by L862 , L860 , ZFMISC_1:33;
thus L864: thesis by L863 , JORDAN2C:11;
end;
suppose L865: R5 <> ( 0 );

L866: ( OpenHypercube (C159 , C160) ) c= ( Ball (C159 , ( C160 * ( sqrt R5 ) )) ) by L865 , EUCLID_9:18;
L867: D153 is  bounded by L866 , L860 , TBSP_1:14 , XBOOLE_1:1;
thus L868: thesis by L867 , JORDAN2C:11;
end;
end;
L870: (for B110 being (Subset of ( TOP-REAL 1 )) holds ((B110 is  closed & B110 is  bounded) implies B110 is  compact))
proof
set D159 = ( TOP-REAL 1 );
let C161 being (Subset of D159);
assume that
L871: C161 is  closed
and
L872: C161 is  bounded;
consider C162 being Real such that L873: (for B111 being (Point of D159) holds (B111 in C161 implies |. B111 .| < C162)) by L872 , JORDAN2C:34;
reconsider D160 = [. ( - C162 ) , C162 .] as (Subset of ( R^1 )) by TOPMETR:17;
consider C163 being (Function of D159 , ( R^1 )) such that L874: (for B112 being (Element of D159) holds ( C163 . B112 ) = ( B112 /. 1 )) by JORDAN2B:1;
L875: C163 is  being_homeomorphism by L874 , JORDAN2B:28;
reconsider D161 = C163 as  one-to-one Function by L875 , TOPS_2:def 5;
L876: ( rng C163 ) = ( [#] ( R^1 ) ) by L875 , TOPS_2:def 5;
L877: C163 is  onto by L876 , FUNCT_2:def 3;
L878: ( C163 /" ) = ( D161 " ) by L877 , TOPS_2:def 4;
L879: ( ( C163 /" ) .: D160 ) = ( D161 " D160 ) by L878 , FUNCT_1:85;
L880: ( dom C163 ) = ( [#] D159 ) by L875 , TOPS_2:def 5;
L881: C161 c= ( D161 " D160 )
proof
let C164 being set;
assume L882: C164 in C161;
reconsider D162 = C164 as (Element of D159) by L882;
set D163 = ( D162 . 1 );
L883: ( len D162 ) = 1 by CARD_1:def 7;
L884: D162 = <* D163 *> by L883 , FINSEQ_1:40;
L885: |. D162 .| = ( abs D163 ) by L884 , TOPREALC:18;
L886: |. D162 .| < C162 by L873 , L882;
L887: (D163 <= C162 & ( - C162 ) <= D163) by L886 , L885 , ABSVALUE:5;
L888: D163 in D160 by L887 , XXREAL_1:1;
L889: (1 in ( Seg 1 ) & ( dom D162 ) = ( Seg 1 )) by L883 , FINSEQ_1:1 , FINSEQ_1:def 3;
L890: ( D162 /. 1 ) = D163 by L889 , PARTFUN1:def 6;
L891: ( C163 . D162 ) = ( D162 /. 1 ) by L874;
thus L892: thesis by L891 , L880 , L888 , L890 , FUNCT_1:def 7;
end;
L893: [. ( - C162 ) , C162 .] is  compact by RCOMP_1:6;
L894: D160 is  compact by L893 , JORDAN5A:25;
L895: ( C163 " ) is  continuous by L875 , TOPS_2:def 5;
L896: ( ( C163 /" ) .: D160 ) is  compact by L895 , L894 , WEIERSTR:8;
thus L897: thesis by L896 , L871 , L879 , L881 , COMPTS_1:9;
end;
L898: (for R5 being Nat holds (for B113 being (Subset of ( TOP-REAL R5 )) holds ((B113 is  closed & B113 is  bounded) implies B113 is  compact)))
proof
let R5 being Nat;
defpred S7[ Nat ] means (for B114 being (Subset of ( TOP-REAL $1 )) holds ((B114 is  closed & B114 is  bounded) implies B114 is  compact));
L899: (for B115 being Nat holds (S7[ B115 ] implies S7[ ( B115 + 1 ) ]))
proof
let C165 being Nat;
assume that
L900: S7[ C165 ];
per cases ;
suppose L901: C165 = ( 0 );

thus L902: thesis by L901 , L870;
end;
suppose L903: C165 <> ( 0 );

set D164 = ( C165 + 1 );
set D165 = ( TOP-REAL 1 );
set D166 = ( TOP-REAL C165 );
set D167 = ( TOP-REAL D164 );
let C166 being (Subset of D167);
assume that
L904: C166 is  closed
and
L905: C166 is  bounded;
consider C167 being (Point of ( Euclid D164 )), C168 being  real number such that L906: C166 c= ( OpenHypercube (C167 , C168) ) by L905 , L843;
L907: C165 in ( NAT ) by ORDINAL1:def 12;
consider C169 being (Function of [: D166 , D165 :] , D167) such that L908: C169 is  being_homeomorphism and L909: (for B116 being (Element of D166) holds (for B117 being (Element of D165) holds ( C169 . (B116 , B117) ) = ( B116 ^ B117 ))) by L907 , L793;
L910: (C169 is  one-to-one & ( dom C169 ) = ( [#] [: D166 , D165 :] )) by L908 , TOPGRP_1:24;
L911: ( len C167 ) = D164 by CARD_1:def 7;
consider C170 , C171 being FinSequence such that L912: ( len C170 ) = C165 and L913: ( len C171 ) = 1 and L914: C167 = ( C170 ^ C171 ) by L911 , FINSEQ_2:22;
L915: ( rng C167 ) c= ( REAL );
L916: C167 is (FinSequence of ( REAL )) by L915 , FINSEQ_1:def 4;
L917: C170 is (FinSequence of ( REAL )) by L916 , L914 , FINSEQ_1:36;
L918: C171 is (FinSequence of ( REAL )) by L914 , L916 , FINSEQ_1:36;
reconsider D168 = C170 as (Element of ( Euclid C165 )) by L912 , L917 , TOPREAL3:45;
reconsider D169 = C171 as (Element of ( Euclid 1 )) by L913 , L918 , TOPREAL3:45;
L919: C169 is  continuous by L908 , TOPS_2:def 5;
reconsider D170 = ( cl_Ball (D168 , ( C168 * ( sqrt C165 ) )) ) as (Subset of D166) by TOPREAL3:8;
reconsider D171 = ( cl_Ball (D169 , ( C168 * ( sqrt 1 ) )) ) as (Subset of D165) by TOPREAL3:8;
L920: (( Ball (D169 , ( C168 * ( sqrt 1 ) )) ) c= D171 & ( OpenHypercube (D169 , C168) ) c= ( Ball (D169 , ( C168 * ( sqrt 1 ) )) )) by EUCLID_9:18 , METRIC_1:14;
L921: ( OpenHypercube (D169 , C168) ) c= D171 by L920 , XBOOLE_1:1;
L922: (( Ball (D168 , ( C168 * ( sqrt C165 ) )) ) c= D170 & ( OpenHypercube (D168 , C168) ) c= ( Ball (D168 , ( C168 * ( sqrt C165 ) )) )) by L903 , EUCLID_9:18 , METRIC_1:14;
L923: ( OpenHypercube (D168 , C168) ) c= D170 by L922 , XBOOLE_1:1;
L924: [: ( OpenHypercube (D168 , C168) ) , ( OpenHypercube (D169 , C168) ) :] c= [: D170 , D171 :] by L923 , L921 , ZFMISC_1:96;
L925: ( cl_Ball (D169 , ( C168 * ( sqrt 1 ) )) ) is  bounded by TOPREAL6:59;
L926: D171 is  bounded by L925 , JORDAN2C:11;
L927: D171 is  compact by L926 , L870 , TOPREAL6:58;
L928: ( cl_Ball (D168 , ( C168 * ( sqrt C165 ) )) ) is  bounded by TOPREAL6:59;
L929: D170 is  bounded by L928 , JORDAN2C:11;
L930: D170 is  compact by L929 , L900 , L907 , TOPREAL6:58;
L931: [: D170 , D171 :] is  compact  compact  compact  compact (Subset of [: D166 , D165 :]) by L930 , L927 , BORSUK_3:23;
L932: ( rng C169 ) = ( [#] D167 ) by L908 , TOPGRP_1:24;
L933: ( C169 .: ( C169 " C166 ) ) = C166 by L932 , FUNCT_1:77;
L934: ( C169 .: [: ( OpenHypercube (D168 , C168) ) , ( OpenHypercube (D169 , C168) ) :] ) = ( OpenHypercube (C167 , C168) ) by L909 , L912 , L914 , L813;
L935: ( C169 " C166 ) c= [: ( OpenHypercube (D168 , C168) ) , ( OpenHypercube (D169 , C168) ) :] by L934 , L906 , L910 , L933 , FUNCT_1:87;
L936: ( C169 " C166 ) is  closed by L904 , L908 , TOPGRP_1:24;
L937: ( C169 " C166 ) is  compact by L936 , L924 , L931 , L935 , COMPTS_1:9 , XBOOLE_1:1;
thus L938: thesis by L937 , L919 , L933 , WEIERSTR:8;
end;
end;
L940: S7[ ( 0 ) ];
L941: (for R5 being Nat holds S7[ R5 ]) from NAT_1:sch 2(L940 , L899);
thus L942: thesis by L941;
end;
registration
let R5 being Nat;
cluster  closed  bounded ->  compact for (Subset of ( TOP-REAL R5 ));
coherence by L898;
end;
registration
let R5 being Nat;
let C172 being  affinely-independent (Subset of ( TOP-REAL R5 ));
cluster ( conv C172 ) ->  compact;
coherence
proof
L944: R5 in ( NAT ) by ORDINAL1:def 12;
L945: ( conv C172 ) is  bounded by L944 , L592;
thus L946: thesis by L945;
end;
end;
begin
theorem
L948: (for R5 being Nat holds (for B118 being non  empty  affinely-independent (Subset of ( TOP-REAL R5 )) holds (for B119 being (Enumeration of B118) holds (for B120 being (FinSequence of ( bool (the carrier of ( ( TOP-REAL R5 ) | ( conv B118 ) )) )) holds ((( len B120 ) = ( card B118 ) & ( rng B120 ) is  closed & (for B121 being (Subset of ( dom B120 )) holds ( conv ( B119 .: B121 ) ) c= ( union ( B120 .: B121 ) ))) implies ( meet ( rng B120 ) ) is non  empty)))))
proof
let R5 being Nat;
set D172 = ( TOP-REAL R5 );
let C173 being non  empty  affinely-independent (Subset of D172);
set D173 = ( conv C173 );
let C174 being (Enumeration of C173);
let C175 being (FinSequence of ( bool (the carrier of ( D172 | D173 )) ));
assume that
L949: ( len C175 ) = ( card C173 )
and
L950: ( rng C175 ) is  closed
and
L951: (for B122 being (Subset of ( dom C175 )) holds ( conv ( C174 .: B122 ) ) c= ( union ( C175 .: B122 ) ));
L952: C175 <> ( {} ) by L949;
L953: ( rng C174 ) = C173 by RLAFFIN3:def 1;
L954: ( len C174 ) = ( card C173 ) by L953 , FINSEQ_4:62;
L955: ( dom C174 ) = ( dom C175 ) by L954 , L949 , FINSEQ_3:29;
set D174 = ( Euclid R5 );
set D175 = ( Complex_of { C173 } );
defpred S8[ set , set ] means ($1 in ( C175 . ( ( C174 " ) . $2 ) ) & (for B123 being (Subset of D172) holds ((B123 c= C173 & $1 in ( conv B123 )) implies $2 in B123)));
L956: ( TopSpaceMetr D174 ) = ( the TopStruct of D172 ) by EUCLID:def 8;
reconsider D176 = D173 as non  empty (Subset of ( TopSpaceMetr D174 )) by L956;
reconsider D177 = D173 as non  empty (Subset of D174) by L956;
L957: ( ( TopSpaceMetr D174 ) | D176 ) = ( TopSpaceMetr ( D174 | D177 ) ) by HAUSDORF:16;
reconsider D178 = ( COMPLEMENT ( rng C175 ) ) as (Subset-Family of ( TopSpaceMetr ( D174 | D177 ) )) by L957 , L956 , PRE_TOPC:36;
L958: D176 is  compact by L956 , COMPTS_1:23;
L959: ( TopSpaceMetr ( D174 | D177 ) ) is  compact by L958 , L957 , COMPTS_1:3;
L960: ( ( TopSpaceMetr D174 ) | D176 ) = ( D172 | D173 ) by L956 , PRE_TOPC:36;
assume L961: ( meet ( rng C175 ) ) is  empty;
L962: ( [#] ( D172 | D173 ) ) = ( ( meet ( rng C175 ) ) ` ) by L961
.= ( union D178 ) by L952 , TOPS_2:7;
L963: D178 is (Cover of ( TopSpaceMetr ( D174 | D177 ) )) by L962 , L957 , L960 , SETFAM_1:45;
set D179 = the (Lebesgue_number of D178);
L964: |. D175 .| c= ( [#] D175 );
consider C176 being Nat such that L965: ( diameter ( BCS (C176 , D175) ) ) < D179 by L964 , L765;
set D180 = ( BCS (C176 , D175) );
L966: |. D180 .| = |. D175 .| by L964 , SIMPLEX1:19;
L967: (the topology of D175) = ( bool C173 ) by SIMPLEX0:4;
L968: (for B124 being set holds (B124 in ( Vertices D180 ) implies (ex B125 being set st (B125 in C173 & S8[ B124 , B125 ]))))
proof
let C177 being set;
assume L969: C177 in ( Vertices D180 );
reconsider D181 = C177 as (Element of D180) by L969;
L970: D181 is  vertex-like by L969 , SIMPLEX0:def 4;
consider C178 being (Subset of D180) such that L971: C178 is  simplex-like and L972: D181 in C178 by L970 , SIMPLEX0:def 3;
L973: ( @ C178 ) c= ( conv ( @ C178 ) ) by RLAFFIN1:2;
L974: D181 in ( conv ( @ C178 ) ) by L973 , L972;
L975: ( conv ( @ C178 ) ) c= |. D175 .| by L966 , L971 , SIMPLEX1:5;
consider C179 being (Subset of D175) such that L976: C179 is  simplex-like and L977: D181 in ( Int ( @ C179 ) ) by L975 , L974 , SIMPLEX1:6;
L978: D181 in ( conv ( @ C179 ) ) by L977 , RLAFFIN2:def 1;
L979: C179 in (the topology of D175) by L976 , PRE_TOPC:def 2;
L980: (( C174 " C179 ) c= ( dom C174 ) & ( C174 .: ( C174 " C179 ) ) = C179) by L979 , L953 , L967 , FUNCT_1:77 , RELAT_1:132;
L981: ( conv ( @ C179 ) ) c= ( union ( C175 .: ( C174 " C179 ) ) ) by L980 , L951 , L955;
consider C180 being set such that L982: D181 in C180 and L983: C180 in ( C175 .: ( C174 " C179 ) ) by L981 , L978 , TARSKI:def 4;
consider C181 being set such that L984: C181 in ( dom C175 ) and L985: C181 in ( C174 " C179 ) and L986: ( C175 . C181 ) = C180 by L983 , FUNCT_1:def 6;
take D182 = ( C174 . C181 );
L987: D182 in C179 by L985 , FUNCT_1:def 7;
L988: C181 in ( dom C174 ) by L985 , FUNCT_1:def 7;
thus L989: (D182 in C173 & C177 in ( C175 . ( ( C174 " ) . D182 ) )) by L988 , L967 , L979 , L982 , L986 , L987 , FUNCT_1:34;
let C182 being (Subset of D172);
assume that
L990: C182 c= C173
and
L991: C177 in ( conv C182 );
reconsider D183 = C182 as (Simplex of D175) by L967 , L990 , PRE_TOPC:def 2;
L992: ( conv ( @ D183 ) ) meets ( Int ( @ C179 ) ) by L977 , L991 , XBOOLE_0:3;
L993: C179 c= D183 by L992 , L976 , SIMPLEX1:26;
thus L994: thesis by L993 , L987;
end;
consider C183 being (Function of ( Vertices D180 ) , C173) such that L995: (for B126 being set holds (B126 in ( Vertices D180 ) implies S8[ B126 , ( C183 . B126 ) ])) from FUNCT_2:sch 1(L968);
L996: |. D175 .| = ( conv C173 ) by SIMPLEX1:8;
L997: D180 is  with_non-empty_element by L996 , L966 , SIMPLEX1:7;
L998: (for B127 being (Vertex of D180) holds (for B128 being (Subset of D172) holds ((B128 c= C173 & B127 in ( conv B128 )) implies ( C183 . B127 ) in B128))) by L997 , L995;
consider C184 being (Simplex of ( ( card C173 ) - 1 ) , D180) such that L999: ( C183 .: C184 ) = C173 by L998 , SIMPLEX1:47;
L1000: ( [#] D180 ) = ( [#] D175 ) by L964 , SIMPLEX1:18;
reconsider D184 = C184 as (Subset of D174) by L1000 , L956;
L1001: C184 is non  empty by L999;
consider C185 being set such that L1002: C185 in C184 by L1001 , XBOOLE_0:def 1;
L1003: ( conv ( @ C184 ) ) c= D173 by L966 , L996 , SIMPLEX1:5;
reconsider D185 = C185 as (Point of D174) by L956 , L1000 , L1002;
L1004: C184 c= ( conv ( @ C184 ) ) by RLAFFIN1:2;
L1005: D185 in ( conv ( @ C184 ) ) by L1004 , L1002;
reconsider D186 = D185 as (Point of ( D174 | D177 )) by L1005 , L1003 , TOPMETR:def 2;
L1006: D184 is  bounded;
L1007: D178 is  open by L950 , L957 , L960 , TOPS_2:9;
consider C186 being (Subset of ( TopSpaceMetr ( D174 | D177 ) )) such that L1008: C186 in D178 and L1009: ( Ball (D186 , D179) ) c= C186 by L1007 , L959 , L963 , L4;
L1010: ( C186 ` ) in ( rng C175 ) by L957 , L960 , L1008 , SETFAM_1:def 7;
consider C187 being set such that L1011: C187 in ( dom C175 ) and L1012: ( C175 . C187 ) = ( C186 ` ) by L1010 , FUNCT_1:def 3;
L1013: ( C174 . C187 ) in C173 by L953 , L955 , L1011 , FUNCT_1:def 3;
consider C188 being set such that L1014: C188 in ( dom C183 ) and L1015: C188 in C184 and L1016: ( C183 . C188 ) = ( C174 . C187 ) by L1013 , L999 , FUNCT_1:def 6;
L1017: C188 in ( conv ( @ C184 ) ) by L1004 , L1015;
L1018: ( conv ( @ C184 ) ) c= D173 by L966 , L996 , SIMPLEX1:5;
L1019: (( [#] ( D174 | D177 ) ) = D177 & C188 in D173) by L1018 , L1017 , TOPMETR:def 2;
reconsider D187 = C184 as  bounded (Subset of D174) by L1006;
L1020: ( diameter D187 ) <= ( diameter ( BCS (C176 , D175) ) ) by L334;
L1021: ( diameter D187 ) < D179 by L1020 , L965 , XXREAL_0:2;
L1022: C188 in ( C175 . ( ( C174 " ) . ( C183 . C188 ) ) ) by L995 , L1014;
L1023: C188 in ( C175 . C187 ) by L1022 , L955 , L1011 , L1016 , FUNCT_1:34;
reconsider D188 = C188 as (Point of D174) by L1019;
reconsider D189 = D188 as (Point of ( D174 | D177 )) by L1017 , L1018 , TOPMETR:def 2;
L1024: ( conv ( @ C184 ) ) c= ( cl_Ball (D185 , ( diameter D187 )) ) by L1002 , L1004 , L575;
L1025: (( dist (D185 , D188) ) = ( dist (D186 , D189) ) & ( dist (D185 , D188) ) <= ( diameter D187 )) by L1024 , L1017 , METRIC_1:12 , TOPMETR:def 1;
L1026: ( dist (D186 , D189) ) < D179 by L1025 , L1021 , XXREAL_0:2;
L1027: D189 in ( Ball (D186 , D179) ) by L1026 , METRIC_1:11;
thus L1028: contradiction by L1027 , L1009 , L1012 , L1023 , XBOOLE_0:def 5;
end;
theorem
L1029: (for R5 being Nat holds (for R15 being  affinely-independent (Subset of ( TOP-REAL R5 )) holds (( card R15 ) = ( R5 + 1 ) implies (for B129 being  continuous (Function of ( ( TOP-REAL R5 ) | ( conv R15 ) ) , ( ( TOP-REAL R5 ) | ( conv R15 ) )) holds (ex B130 being (Point of ( TOP-REAL R5 )) st (B130 in ( dom B129 ) & ( B129 . B130 ) = B130))))))
proof
let R5 being Nat;
set D190 = ( TOP-REAL R5 );
let C189 being  affinely-independent (Subset of D190);
assume that
L1030: ( card C189 ) = ( R5 + 1 );
L1031: C189 is non  empty by L1030;
set D191 = ( conv C189 );
let C190 being  continuous (Function of ( D190 | D191 ) , ( D190 | D191 ));
reconsider D192 = D191 as non  empty (Subset of D190) by L1031;
set D193 = ( D190 | D192 );
reconsider D194 = C190 as  continuous (Function of D193 , D193);
set D195 = the (Enumeration of C189);
deffunc H5(set) = { B131 where B131 is (Element of D193) : ( ( |-- (C189 , ( D195 . $1 )) ) . ( C190 . B131 ) ) <= ( ( |-- (C189 , ( D195 . $1 )) ) . B131 ) };
consider C191 being FinSequence such that L1032: (( len C191 ) = ( card C189 ) & (for R6 being Nat holds (R6 in ( dom C191 ) implies ( C191 . R6 ) = H5(R6)))) from FINSEQ_1:sch 2;
L1033: ( rng C191 ) c= ( bool (the carrier of D193) )
proof
let C192 being set;
assume L1034: C192 in ( rng C191 );
consider C193 being set such that L1035: C193 in ( dom C191 ) and L1036: ( C191 . C193 ) = C192 by L1034 , FUNCT_1:def 3;
L1037: H5(C193) c= (the carrier of D193)
proof
let C194 being set;
assume L1038: C194 in H5(C193);
L1039: (ex B132 being (Element of D193) st (C194 = B132 & ( ( |-- (C189 , ( D195 . C193 )) ) . ( C190 . B132 ) ) <= ( ( |-- (C189 , ( D195 . C193 )) ) . B132 ))) by L1038;
thus L1040: thesis by L1039;
end;
L1041: ( C191 . C193 ) = H5(C193) by L1032 , L1035;
thus L1042: thesis by L1041 , L1036 , L1037;
end;
reconsider D196 = C191 as (FinSequence of ( bool (the carrier of D193) )) by L1033 , FINSEQ_1:def 4;
L1043: ( [#] D193 ) = D192 by PRE_TOPC:def 5;
L1044: ( dom C190 ) = (the carrier of D193) by FUNCT_2:def 1;
L1045:
now
let C195 being (Subset of D193);
reconsider D197 = ( 0 ) as  real number;
reconsider D198 = ]. ( -infty ) , D197 .] as (Subset of ( R^1 )) by TOPMETR:17;
assume L1046: C195 in ( rng D196 );
consider C196 being set such that L1047: C196 in ( dom D196 ) and L1048: ( D196 . C196 ) = C195 by L1046 , FUNCT_1:def 3;
reconsider D199 = ( |-- (C189 , ( D195 . C196 )) ) as  continuous (Function of D190 , ( R^1 )) by L1030 , RLAFFIN3:32;
set D200 = ( D199 | D193 );
set D201 = ( D200 * D194 );
set D202 = ( D201 - D200 );
L1049: ( dom D202 ) = (the carrier of D193) by FUNCT_2:def 1;
reconsider D203 = D202 as (Function of D193 , ( R^1 )) by TOPMETR:17;
L1050: ( dom D200 ) = (the carrier of D193) by FUNCT_2:def 1;
L1051: D200 = ( D199 | (the carrier of D193) ) by L1043 , TMAP_1:def 3;
L1052: ( dom D201 ) = (the carrier of D193) by FUNCT_2:def 1;
L1053: ( D203 " D198 ) c= H5(C196)
proof
let C197 being set;
assume L1054: C197 in ( D203 " D198 );
reconsider D204 = C197 as (Point of D193) by L1054;
L1055: C197 in ( dom D203 ) by L1054 , FUNCT_1:def 7;
L1056: ( D203 . C197 ) = ( ( D201 . C197 ) - ( D200 . C197 ) ) by L1055 , VALUED_1:13;
L1057: (( D203 . C197 ) in D198 & ( D201 . C197 ) = ( D200 . ( C190 . C197 ) )) by L1052 , L1054 , FUNCT_1:12 , FUNCT_1:def 7;
L1058: ( ( D200 . ( C190 . C197 ) ) - ( D200 . C197 ) ) <= ( 0 ) by L1057 , L1056 , XXREAL_1:2;
L1059: ( D200 . ( C190 . C197 ) ) <= ( D200 . C197 ) by L1058 , XREAL_1:50;
L1060: ( C190 . C197 ) in ( dom D200 ) by L1052 , L1054 , FUNCT_1:11;
L1061: ( D200 . ( C190 . C197 ) ) = ( D199 . ( C190 . D204 ) ) by L1060 , L1051 , FUNCT_1:47;
L1062: ( D200 . C197 ) = ( D199 . D204 ) by L1050 , L1051 , FUNCT_1:47;
thus L1063: thesis by L1062 , L1059 , L1061;
end;
L1064: H5(C196) c= ( D203 " D198 )
proof
let C198 being set;
assume L1065: C198 in H5(C196);
consider C199 being (Element of D193) such that L1066: C198 = C199 and L1067: ( D199 . ( C190 . C199 ) ) <= ( D199 . C199 ) by L1065;
L1068: ( C190 . C199 ) in ( rng C190 ) by L1044 , FUNCT_1:def 3;
L1069: ( D199 . ( C190 . C199 ) ) = ( D200 . ( C190 . C199 ) ) by L1068 , L1050 , L1051 , FUNCT_1:47;
L1070: ( D199 . C199 ) = ( D200 . C199 ) by L1050 , L1051 , FUNCT_1:47;
L1071: ( D201 . C199 ) <= ( D200 . C199 ) by L1070 , L1052 , L1067 , L1069 , FUNCT_1:12;
L1072: ( ( D201 . C199 ) - ( D200 . C199 ) ) <= ( 0 ) by L1071 , XREAL_1:47;
L1073: ( D203 . C199 ) <= ( 0 ) by L1072 , L1049 , VALUED_1:13;
L1074: ( D203 . C199 ) in D198 by L1073 , XXREAL_1:234;
thus L1075: thesis by L1074 , L1049 , L1066 , FUNCT_1:def 7;
end;
L1076: D198 is  closed by BORSUK_5:41;
L1077: ( D203 " D198 ) is  closed by L1076 , PRE_TOPC:def 6;
L1078: ( D196 . C196 ) = H5(C196) by L1032 , L1047;
thus L1079: C195 is  closed by L1078 , L1048 , L1053 , L1064 , L1077 , XBOOLE_0:def 10;
end;
L1080: ( rng D196 ) is  closed by L1045 , TOPS_2:def 2;
L1081: ( dom D195 ) = ( Seg ( len D195 ) ) by FINSEQ_1:def 3;
L1082: ( conv C189 ) c= ( Affin C189 ) by RLAFFIN1:65;
L1083: ( rng D195 ) = C189 by RLAFFIN3:def 1;
L1084: ( len D195 ) = ( card C189 ) by L1083 , FINSEQ_4:62;
L1085: ( dom D196 ) = ( dom D195 ) by L1084 , L1032 , FINSEQ_3:29;
L1086: (for B133 being (Subset of ( dom D196 )) holds ( conv ( D195 .: B133 ) ) c= ( union ( D196 .: B133 ) ))
proof
let C200 being (Subset of ( dom D196 ));
set D205 = ( D195 .: C200 );
per cases ;
suppose L1087: C200 is  empty;

L1088: ( conv D205 ) is  empty by L1087;
thus L1089: thesis by L1088 , XBOOLE_1:2;
end;
suppose L1090: C200 is non  empty;

let C201 being set;
set D206 = ( C190 . C201 );
set D207 = ( C201 |-- D205 );
set D208 = ( D206 |-- C189 );
set D209 = ( C201 |-- C189 );
assume L1091: C201 in ( conv D205 );
L1092: ( conv D205 ) c= ( conv C189 ) by L1083 , RELAT_1:111 , RLAFFIN1:3;
reconsider D210 = C201 as (Point of D193) by L1092 , L1043 , L1091;
L1093: ( len ( D208 * D195 ) ) = ( len D195 ) by FINSEQ_2:33;
L1094: ( len D195 ) = ( len ( D207 * D195 ) ) by FINSEQ_2:33;
reconsider D211 = ( D208 * D195 ) , D212 = ( D207 * D195 ) as (Element of ( ( len D195 ) -tuples_on ( REAL ) )) by L1094 , L1093 , FINSEQ_2:92;
L1095: ( dom D211 ) = ( Seg ( len D195 ) ) by L1093 , FINSEQ_1:def 3;
L1096: ( conv D205 ) c= ( Affin D205 ) by RLAFFIN1:65;
L1097: D209 = D207 by L1096 , L1083 , L1091 , RELAT_1:111 , RLAFFIN1:77;
L1098: D205 c= C189 by L1083 , RELAT_1:111;
L1099: ( Carrier D207 ) c= D205 by RLVECT_2:def 6;
L1100: D205 is  affinely-independent by L1083 , RELAT_1:111 , RLAFFIN1:43;
L1101: (( sum D207 ) = 1 & ( Carrier D207 ) c= C189) by L1100 , L1091 , L1096 , L1098 , L1099 , RLAFFIN1:def 7 , XBOOLE_1:1;
L1102: (( Carrier D208 ) c= C189 & 1 = ( Sum ( D207 * D195 ) )) by L1101 , L1083 , RLAFFIN1:30 , RLVECT_2:def 6;
L1103: D206 in ( rng C190 ) by L1043 , L1044 , L1091 , L1092 , FUNCT_1:def 3;
L1104: D206 in ( conv C189 ) by L1103 , L1043;
L1105: ( sum D208 ) = 1 by L1104 , L1082 , RLAFFIN1:def 7;
L1106: ( Sum D211 ) = ( Sum D212 ) by L1105 , L1083 , L1102 , RLAFFIN1:30;
L1107: ( dom D212 ) = ( Seg ( len D195 ) ) by L1094 , FINSEQ_1:def 3;
per cases  by L1106 , RVSUM_1:83;
suppose L1108: (ex B134 being Nat st (B134 in ( Seg ( len D195 ) ) & ( D211 . B134 ) < ( D212 . B134 )));

consider C202 being Nat such that L1109: C202 in ( Seg ( len D195 ) ) and L1110: ( D211 . C202 ) < ( D212 . C202 ) by L1108;
L1111: ( D211 . C202 ) = ( D208 . ( D195 . C202 ) ) by L1095 , L1109 , FUNCT_1:12;
L1112: ( D212 . C202 ) = ( D207 . ( D195 . C202 ) ) by L1107 , L1109 , FUNCT_1:12;
L1113: ( D212 . C202 ) = ( ( |-- (C189 , ( D195 . C202 )) ) . C201 ) by L1112 , L1091 , L1097 , RLAFFIN3:def 3;
L1114: ( ( |-- (C189 , ( D195 . C202 )) ) . ( C190 . D210 ) ) <= ( ( |-- (C189 , ( D195 . C202 )) ) . D210 ) by L1113 , L1104 , L1110 , L1111 , RLAFFIN3:def 3;
L1115: ( D195 . C202 ) in ( dom D208 ) by L1095 , L1109 , FUNCT_1:11;
L1116: ( 0 ) < ( D207 . ( D195 . C202 ) ) by L1115 , L1043 , L1103 , L1110 , L1111 , L1112 , RLAFFIN1:71;
L1117: ( D195 . C202 ) in ( Carrier D207 ) by L1116 , L1115 , RLVECT_2:19;
consider C203 being set such that L1118: C203 in ( dom D195 ) and L1119: C203 in C200 and L1120: ( D195 . C203 ) = ( D195 . C202 ) by L1117 , L1099 , FUNCT_1:def 6;
L1121: C203 = C202 by L1081 , L1109 , L1118 , L1120 , FUNCT_1:def 4;
L1122: ( D196 . C202 ) in ( D196 .: C200 ) by L1121 , L1119 , FUNCT_1:def 6;
L1123: H5(C202) = ( D196 . C202 ) by L1032 , L1081 , L1085 , L1109;
L1124: C201 in ( D196 . C202 ) by L1123 , L1114;
thus L1125: thesis by L1124 , L1122 , TARSKI:def 4;
end;
suppose L1126: (for B135 being Nat holds (B135 in ( Seg ( len D195 ) ) implies ( D211 . B135 ) <= ( D212 . B135 )));

consider C204 being set such that L1127: C204 in C200 by L1090 , XBOOLE_0:def 1;
reconsider D213 = C204 as Nat by L1127;
L1128: ( D211 . D213 ) <= ( D212 . D213 ) by L1081 , L1085 , L1126 , L1127;
L1129: H5(D213) = ( D196 . D213 ) by L1032 , L1127;
L1130: ( D212 . D213 ) = ( D207 . ( D195 . D213 ) ) by L1081 , L1085 , L1107 , L1127 , FUNCT_1:12;
L1131: ( D212 . D213 ) = ( ( |-- (C189 , ( D195 . D213 )) ) . C201 ) by L1130 , L1091 , L1097 , RLAFFIN3:def 3;
L1132: ( D211 . D213 ) = ( D208 . ( D195 . D213 ) ) by L1081 , L1085 , L1095 , L1127 , FUNCT_1:12;
L1133: ( ( |-- (C189 , ( D195 . D213 )) ) . ( C190 . D210 ) ) <= ( ( |-- (C189 , ( D195 . D213 )) ) . D210 ) by L1132 , L1104 , L1131 , L1128 , RLAFFIN3:def 3;
L1134: C201 in ( D196 . D213 ) by L1133 , L1129;
L1135: ( D196 . D213 ) in ( D196 .: C200 ) by L1127 , FUNCT_1:def 6;
thus L1136: thesis by L1135 , L1134 , TARSKI:def 4;
end;
end;
end;
L1139: ( meet ( rng D196 ) ) is non  empty by L1086 , L1031 , L1032 , L1080 , L948;
consider C205 being set such that L1140: C205 in ( meet ( rng D196 ) ) by L1139 , XBOOLE_0:def 1;
L1141: C205 in D192 by L1043 , L1140;
reconsider D214 = C205 as (Element of D190) by L1141;
set D215 = ( C190 . D214 );
set D216 = ( D214 |-- C189 );
set D217 = ( D215 |-- C189 );
L1142: ( len ( D217 * D195 ) ) = ( len D195 ) by FINSEQ_2:33;
L1143: D215 in ( rng C190 ) by L1044 , L1140 , FUNCT_1:def 3;
L1144: D215 in D192 by L1143 , L1043;
L1145: (( Carrier D217 ) c= C189 & ( sum D217 ) = 1) by L1144 , L1082 , RLAFFIN1:def 7 , RLVECT_2:def 6;
L1146: (( Carrier D216 ) c= C189 & 1 = ( Sum ( D217 * D195 ) )) by L1145 , L1083 , RLAFFIN1:30 , RLVECT_2:def 6;
L1147: ( len D195 ) = ( len ( D216 * D195 ) ) by FINSEQ_2:33;
reconsider D218 = ( D217 * D195 ) , D219 = ( D216 * D195 ) as (Element of ( ( len D195 ) -tuples_on ( REAL ) )) by L1147 , L1142 , FINSEQ_2:92;
L1148: ( dom D218 ) = ( Seg ( len D195 ) ) by L1142 , FINSEQ_1:def 3;
L1149: ( dom D219 ) = ( Seg ( len D195 ) ) by L1147 , FINSEQ_1:def 3;
L1150: (for B136 being Nat holds (B136 in ( Seg ( len D195 ) ) implies ( D218 . B136 ) <= ( D219 . B136 )))
proof
let C206 being Nat;
assume L1151: C206 in ( Seg ( len D195 ) );
L1152: (( D196 . C206 ) = H5(C206) & ( D196 . C206 ) in ( rng D196 )) by L1151 , L1032 , L1081 , L1085 , FUNCT_1:def 3;
L1153: D214 in H5(C206) by L1152 , L1140 , SETFAM_1:def 1;
L1154: (ex B137 being (Element of D193) st (B137 = D214 & ( ( |-- (C189 , ( D195 . C206 )) ) . ( C190 . B137 ) ) <= ( ( |-- (C189 , ( D195 . C206 )) ) . B137 ))) by L1153;
L1155: ( ( |-- (C189 , ( D195 . C206 )) ) . D214 ) = ( D216 . ( D195 . C206 ) ) by RLAFFIN3:def 3
.= ( D219 . C206 ) by L1149 , L1151 , FUNCT_1:12;
L1156: ( ( |-- (C189 , ( D195 . C206 )) ) . D215 ) = ( D217 . ( D195 . C206 ) ) by L1144 , RLAFFIN3:def 3
.= ( D218 . C206 ) by L1148 , L1151 , FUNCT_1:12;
thus L1157: thesis by L1156 , L1154 , L1155;
end;
L1158: ( Carrier D216 ) c= C189 by RLVECT_2:def 6;
L1159: ( sum D216 ) = 1 by L1082 , L1141 , RLAFFIN1:def 7;
L1160: ( Sum D218 ) = ( Sum D219 ) by L1159 , L1083 , L1146 , RLAFFIN1:30;
L1161: ( Carrier D217 ) c= C189 by RLVECT_2:def 6;
L1162:
now
let C207 being (Element of D190);
per cases ;
suppose L1163: C207 in C189;

consider C208 being set such that L1164: C208 in ( dom D195 ) and L1165: ( D195 . C208 ) = C207 by L1163 , L1083 , FUNCT_1:def 3;
L1166: (( D218 . C208 ) = ( D217 . C207 ) & ( D219 . C208 ) = ( D216 . C207 )) by L1164 , L1165 , FUNCT_1:13;
L1167: (( D218 . C208 ) <= ( D219 . C208 ) & ( D218 . C208 ) >= ( D219 . C208 )) by L1081 , L1160 , L1150 , L1164 , RVSUM_1:83;
thus L1168: ( D216 . C207 ) = ( D217 . C207 ) by L1167 , L1166 , XXREAL_0:1;
end;
suppose L1169: (not C207 in C189);

L1170: (not C207 in ( Carrier D216 )) by L1169 , L1158;
L1171: ( D216 . C207 ) = ( 0 ) by L1170 , RLVECT_2:19;
L1172: (not C207 in ( Carrier D217 )) by L1161 , L1169;
thus L1173: ( D216 . C207 ) = ( D217 . C207 ) by L1172 , L1171 , RLVECT_2:19;
end;
end;
L1175: ( Sum D216 ) = D214 by L1082 , L1141 , RLAFFIN1:def 7;
L1176: ( Sum D217 ) = D215 by L1082 , L1144 , RLAFFIN1:def 7;
L1177: D214 = D215 by L1176 , L1162 , L1175 , RLVECT_2:def 9;
thus L1178: thesis by L1177 , L1044 , L1140;
end;
theorem
L1179: (for R5 being Nat holds (for R15 being  affinely-independent (Subset of ( TOP-REAL R5 )) holds (( card R15 ) = ( R5 + 1 ) implies (for B138 being  continuous (Function of ( ( TOP-REAL R5 ) | ( conv R15 ) ) , ( ( TOP-REAL R5 ) | ( conv R15 ) )) holds B138 is  with_fixpoint))))
proof
let R5 being Nat;
let C209 being  affinely-independent (Subset of ( TOP-REAL R5 ));
assume that
L1180: ( card C209 ) = ( R5 + 1 );
let C210 being  continuous (Function of ( ( TOP-REAL R5 ) | ( conv C209 ) ) , ( ( TOP-REAL R5 ) | ( conv C209 ) ));
consider C211 being (Point of ( TOP-REAL R5 )) such that L1181: (C211 in ( dom C210 ) & ( C210 . C211 ) = C211) by L1180 , L1029;
L1182: C211 is_a_fixpoint_of C210 by L1181 , ABIAN:def 3;
thus L1183: thesis by L1182 , ABIAN:def 5;
end;
theorem
L1184: (for R5 being Nat holds (for R15 being  affinely-independent (Subset of ( TOP-REAL R5 )) holds (( card R15 ) = ( R5 + 1 ) implies ( ind ( conv R15 ) ) = R5)))
proof
let R5 being Nat;
let R15 being  affinely-independent (Subset of ( TOP-REAL R5 ));
set D220 = ( TOP-REAL R5 );
assume L1185: ( card R15 ) = ( R5 + 1 );
set D221 = ( conv R15 );
L1186: ( ind D221 ) >= R5
proof
set D222 = the (Enumeration of R15);
assume L1187: ( ind D221 ) < R5;
L1188: R15 is non  empty by L1185;
reconsider D223 = D221 as non  empty (Subset of D220) by L1188;
L1189: ( ind D223 ) is  natural;
reconsider D224 = ( R5 - 1 ) as Nat by L1189 , L1187 , NAT_1:20;
deffunc H6(set) = ( D223 \ ( conv ( R15 \ { ( D222 . $1 ) } ) ) );
reconsider D225 = D223 as (Subset of ( the TopStruct of D220 ));
set D226 = ( D220 | D223 );
set D227 = (the carrier of D226);
L1190: (( the TopStruct of D220 ) = ( TopSpaceMetr ( Euclid R5 ) ) & ( the TopStruct of D226 ) = ( ( the TopStruct of D220 ) | D225 )) by EUCLID:def 8 , PRE_TOPC:36;
consider C212 being FinSequence such that L1191: (( len C212 ) = ( len D222 ) & (for R6 being Nat holds (R6 in ( dom C212 ) implies ( C212 . R6 ) = H6(R6)))) from FINSEQ_1:sch 2;
L1192: ( [#] D226 ) = D223 by PRE_TOPC:def 5;
L1193: ( rng C212 ) c= ( bool D227 )
proof
let C213 being set;
assume L1194: C213 in ( rng C212 );
consider C214 being set such that L1195: C214 in ( dom C212 ) and L1196: ( C212 . C214 ) = C213 by L1194 , FUNCT_1:def 3;
L1197: ( C212 . C214 ) = H6(C214) by L1191 , L1195;
L1198: ( C212 . C214 ) c= D223 by L1197 , XBOOLE_1:36;
thus L1199: thesis by L1198 , L1192 , L1196;
end;
reconsider D228 = ( rng C212 ) as  finite (Subset-Family of D226) by L1193;
L1200: ( rng D222 ) = R15 by RLAFFIN3:def 1;
L1201: ( len D222 ) = ( card R15 ) by L1200 , FINSEQ_4:62;
L1202: ( dom C212 ) = ( dom D222 ) by L1191 , FINSEQ_3:29;
L1203: (the carrier of D226) c= ( union D228 )
proof
let C215 being set;
assume L1204: C215 in (the carrier of D226);
assume L1205: (not C215 in ( union D228 ));
L1206:
now
let C216 being set;
assume L1207: C216 in R15;
consider C217 being set such that L1208: C217 in ( dom D222 ) and L1209: ( D222 . C217 ) = C216 by L1207 , L1200 , FUNCT_1:def 3;
reconsider D229 = C217 as Nat by L1208;
L1210: ( C212 . D229 ) = H6(D229) by L1191 , L1202 , L1208;
L1211: H6(D229) in D228 by L1210 , L1202 , L1208 , FUNCT_1:def 3;
L1212: (not C215 in H6(D229)) by L1211 , L1205 , TARSKI:def 4;
L1213: (( conv ( R15 \ { ( D222 . D229 ) } ) ) c= ( Affin ( R15 \ { ( D222 . D229 ) } ) ) & C215 in ( conv ( R15 \ { ( D222 . D229 ) } ) )) by L1212 , L1192 , L1204 , RLAFFIN1:65 , XBOOLE_0:def 5;
L1214: ( C215 |-- R15 ) = ( C215 |-- ( R15 \ { ( D222 . D229 ) } ) ) by L1213 , RLAFFIN1:77 , XBOOLE_1:36;
L1215: (( Carrier ( C215 |-- ( R15 \ { ( D222 . D229 ) } ) ) ) c= ( R15 \ { ( D222 . D229 ) } ) & ( D222 . D229 ) in { ( D222 . D229 ) }) by RLVECT_2:def 6 , TARSKI:def 1;
L1216: (not ( D222 . D229 ) in ( Carrier ( C215 |-- ( R15 \ { ( D222 . D229 ) } ) ) )) by L1215 , XBOOLE_0:def 5;
thus L1217: ( ( C215 |-- R15 ) . C216 ) = ( 0 ) by L1216 , L1207 , L1209 , L1214 , RLVECT_2:19;
end;
L1218: C215 in ( conv ( R15 \ R15 ) ) by L1206 , L1192 , L1204 , RLAFFIN1:76;
L1219: ( R15 \ R15 ) = ( {} ) by XBOOLE_1:37;
thus L1220: contradiction by L1219 , L1218;
end;
L1221: D228 is (Cover of D226) by L1203 , SETFAM_1:def 11;
L1222:
now
let C218 being (Subset of D226);
assume L1223: C218 in D228;
consider C219 being set such that L1224: (C219 in ( dom C212 ) & ( C212 . C219 ) = C218) by L1223 , FUNCT_1:def 3;
reconsider D230 = ( conv ( R15 \ { ( D222 . C219 ) } ) ) as (Subset of D226) by L1192 , RLAFFIN1:3 , XBOOLE_1:36;
L1225: ( R15 \ { ( D222 . C219 ) } ) is  affinely-independent by RLAFFIN1:43 , XBOOLE_1:36;
L1226: D230 is  closed by L1225 , TSEP_1:8;
L1227: C218 = ( D230 ` ) by L1192 , L1191 , L1224;
thus L1228: C218 is  open by L1227 , L1226;
end;
L1229: (( ind D226 ) = ( ind D223 ) & D228 is  open) by L1222 , TOPDIM_1:17 , TOPS_2:def 1;
L1230: ( ind D223 ) < ( D224 + 1 ) by L1187;
L1231: ( ind D223 ) <= D224 by L1230 , NAT_1:13;
consider C220 being  finite (Subset-Family of D226) such that L1232: C220 is  open and L1233: C220 is (Cover of D226) and L1234: C220 is_finer_than D228 and L1235: ( card C220 ) <= ( ( card D228 ) * ( D224 + 1 ) ) and L1236: ( order C220 ) <= D224 by L1231 , L1190 , L1229 , L1221 , TOPDIM_2:23;
defpred S9[ Nat , set , set ] means $3 = { B139 where B139 is (Subset of D226) : (B139 in C220 & (B139 c= ( C212 . ( $1 + 1 ) ) or B139 in $2)) };
defpred S10[ set ] means ($1 in C220 & $1 c= ( C212 . 1 ));
consider C221 being (Subset-Family of D226) such that L1237: (for B140 being set holds (B140 in C221 iff (B140 in ( bool D227 ) & S10[ B140 ]))) from SUBSET_1:sch 1;
L1238: (for B141 being Nat holds ((1 <= B141 & B141 < ( len D222 )) implies (for B142 being (Element of ( bool ( bool D227 ) )) holds (ex B143 being (Element of ( bool ( bool D227 ) )) st S9[ B141 , B142 , B143 ]))))
proof
let C222 being Nat;
assume that
L1239: 1 <= C222
and
L1240: C222 < ( len D222 );
let C223 being (Element of ( bool ( bool D227 ) ));
set D231 = { B144 where B144 is (Subset of D226) : (B144 in C220 & (B144 c= ( C212 . ( C222 + 1 ) ) or B144 in C223)) };
L1241: D231 c= ( bool D227 )
proof
let C224 being set;
assume L1242: C224 in D231;
L1243: (ex B145 being (Subset of D226) st (B145 = C224 & B145 in C220 & (B145 c= ( C212 . ( C222 + 1 ) ) or B145 in C223))) by L1242;
thus L1244: thesis by L1243;
end;
thus L1245: thesis by L1241;
end;
consider C225 being (FinSequence of ( bool ( bool D227 ) )) such that L1246: ( len C225 ) = ( len D222 ) and L1247: (( C225 /. 1 ) = C221 or ( len D222 ) = ( 0 )) and L1248: (for B146 being Nat holds ((1 <= B146 & B146 < ( len D222 )) implies S9[ B146 , ( C225 /. B146 ) , ( C225 /. ( B146 + 1 ) ) ])) from NAT_2:sch 1(L1238);
defpred S11[ Nat , set ] means (($1 = 1 implies $2 = ( union C221 )) & ($1 <> 1 implies $2 = ( union ( ( C225 . $1 ) \ ( C225 . ( $1 - 1 ) ) ) )));
L1249: (for B147 being Nat holds (B147 in ( Seg ( len D222 ) ) implies (ex B148 being set st S11[ B147 , B148 ])))
proof
let C226 being Nat;
L1250: (C226 = 1 or C226 <> 1);
thus L1251: thesis by L1250;
end;
consider C227 being FinSequence such that L1252: ( dom C227 ) = ( Seg ( len D222 ) ) and L1253: (for B149 being Nat holds (B149 in ( Seg ( len D222 ) ) implies S11[ B149 , ( C227 . B149 ) ])) from FINSEQ_1:sch 1(L1249);
L1254: ( dom C225 ) = ( Seg ( len D222 ) ) by L1246 , FINSEQ_1:def 3;
L1255: ( rng C227 ) c= ( bool D227 )
proof
let C228 being set;
assume L1256: C228 in ( rng C227 );
consider C229 being set such that L1257: C229 in ( dom C227 ) and L1258: ( C227 . C229 ) = C228 by L1256 , FUNCT_1:def 3;
reconsider D232 = C229 as Nat by L1257;
L1259: ( C225 . D232 ) in ( rng C225 ) by L1254 , L1252 , L1257 , FUNCT_1:def 3;
reconsider D233 = ( C225 . D232 ) as (Subset-Family of D226) by L1259;
L1260: (C228 = ( union C221 ) or C228 = ( union ( D233 \ ( C225 . ( D232 - 1 ) ) ) )) by L1252 , L1253 , L1257 , L1258;
thus L1261: thesis by L1260;
end;
reconsider D234 = C227 as (FinSequence of ( bool D227 )) by L1255 , FINSEQ_1:def 4;
L1262: R15 is non  empty  affinely-independent non  empty  affinely-independent non  empty  affinely-independent non  empty  affinely-independent (Subset of ( TOP-REAL R5 )) by L1185;
L1263: 1 <= ( R5 + 1 ) by NAT_1:11;
L1264: (the carrier of D226) c= ( union ( rng D234 ) )
proof
let C230 being set;
assume L1265: C230 in (the carrier of D226);
L1266: C230 in ( union C220 ) by L1265 , L1233 , SETFAM_1:45;
consider C231 being set such that L1267: C230 in C231 and L1268: C231 in C220 by L1266 , TARSKI:def 4;
consider C232 being set such that L1269: C232 in D228 and L1270: C231 c= C232 by L1234 , L1268 , SETFAM_1:def 2;
consider C233 being set such that L1271: C233 in ( dom C212 ) and L1272: ( C212 . C233 ) = C232 by L1269 , FUNCT_1:def 3;
reconsider D235 = C233 as Nat by L1271;
L1273: D235 >= 1 by L1271 , FINSEQ_3:25;
L1274: ( len D222 ) >= D235 by L1191 , L1271 , FINSEQ_3:25;
per cases  by L1273 , XXREAL_0:1;
suppose L1275: (D235 = 1 or C231 in C221);

L1276: 1 in ( Seg ( len D222 ) ) by L1185 , L1201 , L1263 , FINSEQ_1:1;
L1277: ( D234 . 1 ) = ( union C221 ) by L1276 , L1253;
L1278: C231 in C221 by L1237 , L1268 , L1270 , L1272 , L1275;
L1279: C230 in ( D234 . 1 ) by L1278 , L1267 , L1277 , TARSKI:def 4;
L1280: ( D234 . 1 ) in ( rng D234 ) by L1252 , L1276 , FUNCT_1:def 3;
thus L1281: thesis by L1280 , L1279 , TARSKI:def 4;
end;
suppose L1282: (D235 > 1 & (not C231 in C221));

defpred S12[ Nat ] means ($1 > 1 & $1 <= ( len D222 ) & C231 c= ( C212 . $1 ));
L1283: (ex B150 being Nat st S12[ B150 ]) by L1270 , L1272 , L1274 , L1282;
consider C234 being Nat such that L1284: (S12[ C234 ] & (for B151 being Nat holds (S12[ B151 ] implies C234 <= B151))) from NAT_1:sch 5(L1283);
reconsider D236 = ( C234 - 1 ) as (Element of ( NAT )) by L1284 , NAT_1:20;
defpred S13[ Nat ] means ((1 <= $1 & $1 <= D236) implies (not C231 in ( C225 /. $1 )));
L1285: ( D236 + 1 ) <= ( len D222 ) by L1284;
L1286: D236 < ( len D222 ) by L1285 , NAT_1:13;
L1287: (for B152 being Nat holds (S13[ B152 ] implies S13[ ( B152 + 1 ) ]))
proof
let C235 being Nat;
assume that
L1288: S13[ C235 ];
set D237 = ( C235 + 1 );
assume that
L1289: 1 <= D237
and
L1290: D237 <= D236;
L1291: C235 < D236 by L1290 , NAT_1:13;
L1292: C235 < ( len D222 ) by L1291 , L1286 , XXREAL_0:2;
per cases  by NAT_1:14;
suppose L1293: C235 = ( 0 );

thus L1294: thesis by L1293 , L1185 , L1200 , L1247 , L1282 , FINSEQ_4:62;
end;
suppose L1295: C235 >= 1;

assume L1296: C231 in ( C225 /. D237 );
L1297: ( C225 /. D237 ) = { B153 where B153 is (Subset of D226) : (B153 in C220 & (B153 c= ( C212 . D237 ) or B153 in ( C225 /. C235 ))) } by L1248 , L1292 , L1295;
L1298: (ex B154 being (Subset of D226) st (C231 = B154 & B154 in C220 & (B154 c= ( C212 . D237 ) or B154 in ( C225 /. C235 )))) by L1297 , L1296;
L1299: S12[ D237 ] by L1298 , L1286 , L1288 , L1290 , L1295 , NAT_1:13 , XXREAL_0:2;
L1300: C234 <= D237 by L1299 , L1284;
L1301: ( D236 + 1 ) <= D236 by L1300 , L1290 , XXREAL_0:2;
thus L1302: contradiction by L1301 , NAT_1:13;
end;
end;
L1304: S13[ ( 0 ) ];
L1305: (for R5 being Nat holds S13[ R5 ]) from NAT_1:sch 2(L1304 , L1287);
L1306: C234 in ( dom C225 ) by L1246 , L1284 , FINSEQ_3:25;
L1307: ( D234 . C234 ) in ( rng D234 ) by L1306 , L1254 , L1252 , FUNCT_1:def 3;
L1308: ( D236 + 1 ) > 1 by L1284;
L1309: D236 >= 1 by L1308 , NAT_1:13;
L1310: ( C225 /. C234 ) = { B155 where B155 is (Subset of D226) : (B155 in C220 & (B155 c= ( C212 . ( D236 + 1 ) ) or B155 in ( C225 /. D236 ))) } by L1309 , L1248 , L1286;
L1311: D236 in ( dom C225 ) by L1246 , L1309 , L1286 , FINSEQ_3:25;
L1312: ( C225 . D236 ) = ( C225 /. D236 ) by L1311 , PARTFUN1:def 6;
L1313: (not C231 in ( C225 . D236 )) by L1312 , L1309 , L1305;
L1314: ( C225 . C234 ) = ( C225 /. C234 ) by L1306 , PARTFUN1:def 6;
L1315: C231 in ( C225 . C234 ) by L1314 , L1268 , L1284 , L1310;
L1316: C231 in ( ( C225 . C234 ) \ ( C225 . D236 ) ) by L1315 , L1313 , XBOOLE_0:def 5;
L1317: C230 in ( union ( ( C225 . C234 ) \ ( C225 . D236 ) ) ) by L1316 , L1267 , TARSKI:def 4;
L1318: ( D234 . C234 ) = ( union ( ( C225 . C234 ) \ ( C225 . D236 ) ) ) by L1254 , L1253 , L1284 , L1306;
thus L1319: thesis by L1318 , L1317 , L1307 , TARSKI:def 4;
end;
end;
L1321: ( rng D234 ) is (Cover of D226) by L1264 , SETFAM_1:def 11;
L1322:
now
let C236 being (Subset of D226);
assume L1323: C236 in ( rng D234 );
consider C237 being set such that L1324: C237 in ( dom D234 ) and L1325: ( D234 . C237 ) = C236 by L1323 , FUNCT_1:def 3;
reconsider D238 = C237 as Nat by L1324;
L1326: D238 >= 1 by L1252 , L1324 , FINSEQ_1:1;
per cases  by L1326 , XXREAL_0:1;
suppose L1327: D238 = 1;

L1328: C221 c= C220
proof
let C238 being set;
assume L1329: C238 in C221;
thus L1330: thesis by L1329 , L1237;
end;
L1331: ( D234 . D238 ) = ( union C221 ) by L1252 , L1253 , L1324 , L1327;
thus L1332: C236 is  open by L1331 , L1232 , L1325 , L1328 , TOPS_2:11 , TOPS_2:19;
end;
suppose L1333: D238 > 1;

reconsider D239 = ( D238 - 1 ) as (Element of ( NAT )) by L1333 , NAT_1:20;
L1334: ( D239 + 1 ) > 1 by L1333;
L1335: D239 >= 1 by L1334 , NAT_1:13;
L1336: ( D239 + 1 ) <= ( len D222 ) by L1252 , L1324 , FINSEQ_1:1;
L1337: D239 < ( len D222 ) by L1336 , NAT_1:13;
L1338: D239 in ( dom C225 ) by L1337 , L1246 , L1335 , FINSEQ_3:25;
L1339: ( C225 . D239 ) = ( C225 /. D239 ) by L1338 , PARTFUN1:def 6;
L1340: S9[ D239 , ( C225 /. D239 ) , ( C225 /. ( D239 + 1 ) ) ] by L1248 , L1335 , L1337;
L1341: ( C225 /. D238 ) c= C220
proof
let C239 being set;
assume L1342: C239 in ( C225 /. D238 );
L1343: (ex B156 being (Subset of D226) st (C239 = B156 & B156 in C220 & (B156 c= ( C212 . D238 ) or B156 in ( C225 /. D239 )))) by L1342 , L1340;
thus L1344: thesis by L1343;
end;
L1345: ( C225 /. D238 ) is  open by L1341 , L1232 , TOPS_2:11;
L1346: ( ( C225 /. D238 ) \ ( C225 /. ( D238 - 1 ) ) ) is  open by L1345 , TOPS_2:15;
L1347: ( C225 . D238 ) = ( C225 /. D238 ) by L1254 , L1252 , L1324 , PARTFUN1:def 6;
L1348: C236 = ( union ( ( C225 . D238 ) \ ( C225 . ( D238 - 1 ) ) ) ) by L1252 , L1253 , L1324 , L1325 , L1333;
thus L1349: C236 is  open by L1348 , L1347 , L1346 , L1339 , TOPS_2:19;
end;
end;
L1351: ( rng D234 ) is  open by L1322 , TOPS_2:def 1;
L1352: D226 is  compact by COMPTS_1:3;
consider C240 being (Subset-Family of D226) such that L1353: C240 is  open and L1354: C240 is (Cover of D226) and L1355: ( clf C240 ) is_finer_than ( rng D234 ) and L1356: C240 is  locally_finite by L1352 , L1190 , L1321 , L1351 , PCOMPS_1:22 , PCOMPS_2:3;
set D240 = ( clf C240 );
defpred S14[ set , set ] means $2 = ( union { B157 where B157 is (Subset of D226) : (B157 in D240 & B157 c= ( D234 . $1 )) } );
L1357: (for B158 being Nat holds (B158 in ( Seg ( len D222 ) ) implies (ex B159 being (Element of ( bool D227 )) st S14[ B158 , B159 ])))
proof
let C241 being Nat;
set D241 = { B160 where B160 is (Subset of D226) : (B160 in D240 & B160 c= ( D234 . C241 )) };
L1358: D241 c= ( bool D227 )
proof
let C242 being set;
assume L1359: C242 in D241;
L1360: (ex B161 being (Subset of D226) st (B161 = C242 & B161 in D240 & B161 c= ( D234 . C241 ))) by L1359;
thus L1361: thesis by L1360;
end;
reconsider D242 = D241 as (Subset-Family of D226) by L1358;
L1362: ( union D242 ) is (Subset of D226);
thus L1363: thesis by L1362;
end;
consider C243 being (FinSequence of ( bool D227 )) such that L1364: (( dom C243 ) = ( Seg ( len D222 ) ) & (for B162 being Nat holds (B162 in ( Seg ( len D222 ) ) implies S14[ B162 , ( C243 . B162 ) ]))) from FINSEQ_1:sch 5(L1357);
L1365: (for B163 being Nat holds (B163 in ( dom C243 ) implies ( C243 . B163 ) c= ( D234 . B163 )))
proof
let C244 being Nat;
set D243 = { B164 where B164 is (Subset of D226) : (B164 in D240 & B164 c= ( D234 . C244 )) };
L1366:
now
let C245 being set;
assume L1367: C245 in D243;
L1368: (ex B165 being (Subset of D226) st (C245 = B165 & B165 in D240 & B165 c= ( D234 . C244 ))) by L1367;
thus L1369: C245 c= ( D234 . C244 ) by L1368;
end;
L1370: ( union D243 ) c= ( D234 . C244 ) by L1366 , ZFMISC_1:76;
assume L1371: C244 in ( dom C243 );
thus L1372: thesis by L1371 , L1364 , L1370;
end;
L1373: ( dom D222 ) = ( Seg ( len D222 ) ) by FINSEQ_1:def 3;
L1374: (for B166 being Nat holds (B166 in ( Seg ( len D222 ) ) implies ( D234 . B166 ) misses ( conv ( R15 \ { ( D222 . B166 ) } ) )))
proof
let C246 being Nat;
assume L1375: C246 in ( Seg ( len D222 ) );
L1376: C246 >= 1 by L1375 , FINSEQ_1:1;
L1377: S11[ C246 , ( D234 . C246 ) ] by L1253 , L1375;
assume L1378: ( D234 . C246 ) meets ( conv ( R15 \ { ( D222 . C246 ) } ) );
consider C247 being set such that L1379: C247 in ( D234 . C246 ) and L1380: C247 in ( conv ( R15 \ { ( D222 . C246 ) } ) ) by L1378 , XBOOLE_0:3;
per cases  by L1376 , XXREAL_0:1;
suppose L1381: C246 = 1;

consider C248 being set such that L1382: C247 in C248 and L1383: C248 in C221 by L1381 , L1377 , L1379 , TARSKI:def 4;
L1384: S10[ C248 ] by L1237 , L1383;
L1385: C248 c= H6(C246) by L1384 , L1191 , L1202 , L1373 , L1375 , L1381;
thus L1386: contradiction by L1385 , L1380 , L1382 , XBOOLE_0:def 5;
end;
suppose L1387: C246 > 1;

reconsider D244 = ( C246 - 1 ) as (Element of ( NAT )) by L1387 , NAT_1:20;
L1388: ( len D222 ) >= ( D244 + 1 ) by L1375 , FINSEQ_1:1;
L1389: ( len D222 ) > D244 by L1388 , NAT_1:13;
L1390: ( D244 + 1 ) > 1 by L1387;
L1391: D244 >= 1 by L1390 , NAT_1:13;
L1392: S9[ D244 , ( C225 /. D244 ) , ( C225 /. ( D244 + 1 ) ) ] by L1391 , L1248 , L1389;
L1393: D244 in ( dom C225 ) by L1246 , L1391 , L1389 , FINSEQ_3:25;
L1394: ( C225 /. D244 ) = ( C225 . D244 ) by L1393 , PARTFUN1:def 6;
L1395: ( C225 /. C246 ) = ( C225 . C246 ) by L1254 , L1375 , PARTFUN1:def 6;
consider C249 being set such that L1396: C247 in C249 and L1397: C249 in ( ( C225 . C246 ) \ ( C225 . ( C246 - 1 ) ) ) by L1377 , L1379 , L1387 , TARSKI:def 4;
L1398: C249 in ( C225 . C246 ) by L1397;
consider C250 being (Subset of D226) such that L1399: C249 = C250 and L1400: C250 in C220 and L1401: (C250 c= ( C212 . C246 ) or C250 in ( C225 . D244 )) by L1398 , L1392 , L1395 , L1394;
L1402: ( C212 . C246 ) = H6(C246) by L1191 , L1202 , L1373 , L1375;
thus L1403: contradiction by L1402 , L1380 , L1396 , L1397 , L1399 , L1401 , XBOOLE_0:def 5;
end;
end;
L1405: D227 c= ( union ( rng C243 ) )
proof
let C251 being set;
assume L1406: C251 in D227;
L1407: (( union C240 ) = D227 & ( union C240 ) c= ( union D240 )) by L1354 , PCOMPS_1:19 , SETFAM_1:45;
consider C252 being set such that L1408: C251 in C252 and L1409: C252 in D240 by L1407 , L1406 , TARSKI:def 4;
consider C253 being set such that L1410: C253 in ( rng D234 ) and L1411: C252 c= C253 by L1355 , L1409 , SETFAM_1:def 2;
consider C254 being set such that L1412: C254 in ( dom D234 ) and L1413: ( D234 . C254 ) = C253 by L1410 , FUNCT_1:def 3;
L1414: S14[ C254 , ( C243 . C254 ) ] by L1252 , L1364 , L1412;
L1415: ( C243 . C254 ) in ( rng C243 ) by L1252 , L1364 , L1412 , FUNCT_1:def 3;
L1416: C252 in { B167 where B167 is (Subset of D226) : (B167 in D240 & B167 c= ( D234 . C254 )) } by L1409 , L1411 , L1413;
L1417: C251 in ( C243 . C254 ) by L1416 , L1408 , L1414 , TARSKI:def 4;
thus L1418: thesis by L1417 , L1415 , TARSKI:def 4;
end;
L1419: ( rng C243 ) is (Cover of D226) by L1405 , SETFAM_1:def 11;
L1420: (for B168 being (Subset of ( dom C243 )) holds ( conv ( D222 .: B168 ) ) c= ( union ( C243 .: B168 ) ))
proof
let C255 being (Subset of ( dom C243 ));
L1421: ( rng C243 ) = ( C243 .: ( dom C243 ) ) by RELAT_1:113;
L1422: ( union ( rng C243 ) ) = D227 by L1419 , SETFAM_1:45;
per cases  by XBOOLE_0:def 10;
suppose L1423: C255 = ( dom C243 );

thus L1424: thesis by L1423 , L1192 , L1200 , L1373 , L1364 , L1421 , L1422 , RELAT_1:113;
end;
suppose L1425: (not ( dom C243 ) c= C255);

set D245 = { ( conv ( R15 \ { ( D222 . B169 ) } ) ) where B169 is (Element of ( NAT )) : B169 in ( ( dom D222 ) \ C255 ) };
L1426: ( ( dom C243 ) \ C255 ) is non  empty by L1425 , XBOOLE_1:37;
L1427: ( conv ( D222 .: C255 ) ) = ( meet D245 ) by L1426 , L1373 , L1364 , L508;
L1428: ( meet D245 ) misses ( union ( C243 .: ( ( dom D222 ) \ C255 ) ) )
proof
assume L1429: ( meet D245 ) meets ( union ( C243 .: ( ( dom D222 ) \ C255 ) ) );
consider C256 being set such that L1430: C256 in ( meet D245 ) and L1431: C256 in ( union ( C243 .: ( ( dom D222 ) \ C255 ) ) ) by L1429 , XBOOLE_0:3;
consider C257 being set such that L1432: C256 in C257 and L1433: C257 in ( C243 .: ( ( dom D222 ) \ C255 ) ) by L1431 , TARSKI:def 4;
consider C258 being set such that L1434: C258 in ( dom C243 ) and L1435: C258 in ( ( dom D222 ) \ C255 ) and L1436: ( C243 . C258 ) = C257 by L1433 , FUNCT_1:def 6;
reconsider D246 = C258 as (Element of ( NAT )) by L1434;
L1437: ( conv ( R15 \ { ( D222 . D246 ) } ) ) in D245 by L1435;
L1438: ( meet D245 ) c= ( conv ( R15 \ { ( D222 . D246 ) } ) ) by L1437 , SETFAM_1:7;
L1439: C257 c= ( D234 . D246 ) by L1365 , L1434 , L1436;
L1440: ( D234 . D246 ) meets ( conv ( R15 \ { ( D222 . D246 ) } ) ) by L1439 , L1430 , L1432 , L1438 , XBOOLE_0:3;
thus L1441: contradiction by L1440 , L1374 , L1364 , L1434;
end;
L1442: ( dom C243 ) = ( dom D222 ) by L1364 , FINSEQ_1:def 3;
L1443: ( rng C243 ) = ( C243 .: ( C255 \/ ( ( dom D222 ) \ C255 ) ) ) by L1442 , L1421 , XBOOLE_1:45
.= ( ( C243 .: C255 ) \/ ( C243 .: ( ( dom D222 ) \ C255 ) ) ) by RELAT_1:120;
L1444: ( ( union ( C243 .: C255 ) ) \/ ( union ( C243 .: ( ( dom D222 ) \ C255 ) ) ) ) = D223 by L1443 , L1192 , L1422 , ZFMISC_1:78;
L1445: ( conv ( D222 .: C255 ) ) c= D223 by L1200 , RELAT_1:111 , RLAFFIN1:3;
thus L1446: thesis by L1445 , L1427 , L1444 , L1428 , XBOOLE_1:73;
end;
end;
L1448: D240 is  locally_finite by L1356 , PCOMPS_1:18;
L1449:
now
let C259 being (Subset of D226);
assume L1450: C259 in ( rng C243 );
consider C260 being set such that L1451: (C260 in ( dom C243 ) & ( C243 . C260 ) = C259) by L1450 , FUNCT_1:def 3;
set D247 = { B170 where B170 is (Subset of D226) : (B170 in D240 & B170 c= ( D234 . C260 )) };
L1452: D247 c= D240
proof
let C261 being set;
assume L1453: C261 in D247;
L1454: (ex B171 being (Subset of D226) st (C261 = B171 & B171 in D240 & B171 c= ( D234 . C260 ))) by L1453;
thus L1455: thesis by L1454;
end;
reconsider D248 = D247 as (Subset-Family of D226) by L1452 , XBOOLE_1:1;
L1456: D248 is  closed by L1452 , PCOMPS_1:11 , TOPS_2:12;
L1457: ( union D248 ) is  closed by L1456 , L1448 , L1452 , PCOMPS_1:9 , PCOMPS_1:21;
thus L1458: C259 is  closed by L1457 , L1364 , L1451;
end;
L1459: ( rng C243 ) is  closed by L1449 , TOPS_2:def 2;
L1460: ( len C243 ) = ( card R15 ) by L1201 , L1364 , FINSEQ_1:def 3;
L1461: ( meet ( rng C243 ) ) is non  empty by L1460 , L1459 , L1262 , L1420 , L948;
consider C262 being set such that L1462: C262 in ( meet ( rng C243 ) ) by L1461 , XBOOLE_0:def 1;
defpred S15[ Nat , set ] means ($2 in C220 & C262 in $2 & $2 in ( C225 . $1 ) & ($1 <> 1 implies (not $2 in ( C225 . ( $1 - 1 ) ))));
L1463: (for B172 being Nat holds (B172 in ( Seg ( len D222 ) ) implies (ex B173 being (Element of ( bool D227 )) st S15[ B172 , B173 ])))
proof
let C263 being Nat;
assume L1464: C263 in ( Seg ( len D222 ) );
L1465: C263 >= 1 by L1464 , FINSEQ_1:1;
L1466: C263 <= ( len D222 ) by L1464 , FINSEQ_1:1;
L1467: (( C243 . C263 ) c= ( D234 . C263 ) & S11[ C263 , ( D234 . C263 ) ]) by L1253 , L1364 , L1365 , L1464;
L1468: ( C243 . C263 ) in ( rng C243 ) by L1364 , L1464 , FUNCT_1:def 3;
L1469: ( meet ( rng C243 ) ) c= ( C243 . C263 ) by L1468 , SETFAM_1:7;
L1470: C262 in ( C243 . C263 ) by L1469 , L1462;
per cases  by L1465 , XXREAL_0:1;
suppose L1471: C263 = 1;

L1472: 1 in ( dom C225 ) by L1185 , L1201 , L1254 , L1263 , FINSEQ_1:1;
L1473: ( C225 . 1 ) = C221 by L1472 , L1185 , L1200 , L1247 , FINSEQ_4:62 , PARTFUN1:def 6;
consider C264 being set such that L1474: C262 in C264 and L1475: C264 in C221 by L1470 , L1467 , L1471 , TARSKI:def 4;
L1476: C264 in C220 by L1237 , L1475;
thus L1477: thesis by L1476 , L1471 , L1474 , L1475 , L1473;
end;
suppose L1478: C263 > 1;

reconsider D249 = ( C263 - 1 ) as Nat by L1478 , NAT_1:20;
L1479: ( D249 + 1 ) = C263;
L1480: D249 < ( len D222 ) by L1479 , L1466 , NAT_1:13;
L1481: D249 >= 1 by L1478 , L1479 , NAT_1:13;
L1482: S9[ D249 , ( C225 /. D249 ) , ( C225 /. C263 ) ] by L1481 , L1248 , L1480;
L1483: ( C225 . C263 ) = ( C225 /. C263 ) by L1254 , L1464 , PARTFUN1:def 6;
consider C265 being set such that L1484: C262 in C265 and L1485: C265 in ( ( C225 . C263 ) \ ( C225 . ( C263 - 1 ) ) ) by L1470 , L1467 , L1478 , TARSKI:def 4;
L1486: (not C265 in ( C225 . ( C263 - 1 ) )) by L1485 , XBOOLE_0:def 5;
L1487: C265 in ( C225 . C263 ) by L1485;
L1488: (ex B174 being (Subset of D226) st (C265 = B174 & B174 in C220 & (B174 c= ( C212 . ( D249 + 1 ) ) or B174 in ( C225 /. D249 )))) by L1487 , L1482 , L1483;
thus L1489: thesis by L1488 , L1484 , L1485 , L1486;
end;
end;
consider C266 being (FinSequence of ( bool D227 )) such that L1491: (( dom C266 ) = ( Seg ( len D222 ) ) & (for B175 being Nat holds (B175 in ( Seg ( len D222 ) ) implies S15[ B175 , ( C266 . B175 ) ]))) from FINSEQ_1:sch 5(L1463);
L1492:
now
let C267 , C268 being Nat;
assume that
L1493: C267 in ( dom C266 )
and
L1494: C268 in ( dom C266 )
and
L1495: C267 < C268;
L1496: C268 <= ( len D222 ) by L1491 , L1494 , FINSEQ_1:1;
defpred S16[ Nat ] means ((C267 <= $1 & $1 < C268) implies ( C266 . C267 ) in ( C225 . $1 ));
L1497: S15[ C267 , ( C266 . C267 ) ] by L1491 , L1493;
L1498: 1 <= C267 by L1491 , L1493 , FINSEQ_1:1;
L1499: (for R6 being Nat holds (S16[ R6 ] implies S16[ ( R6 + 1 ) ]))
proof
let R6 being Nat;
assume L1500: S16[ R6 ];
set D250 = ( R6 + 1 );
assume that
L1501: C267 <= D250
and
L1502: D250 < C268;
L1503: R6 < C268 by L1502 , NAT_1:13;
per cases  by L1501 , NAT_1:8;
suppose L1504: C267 = D250;

thus L1505: thesis by L1504 , L1491 , L1493;
end;
suppose L1506: C267 <= R6;

L1507: (1 <= D250 & D250 <= ( len D222 )) by L1498 , L1496 , L1501 , L1502 , XXREAL_0:2;
L1508: D250 in ( dom C225 ) by L1507 , L1254 , FINSEQ_1:1;
L1509: R6 < ( len D222 ) by L1496 , L1503 , XXREAL_0:2;
L1510: 1 <= R6 by L1498 , L1506 , XXREAL_0:2;
L1511: R6 in ( dom C225 ) by L1510 , L1254 , L1509 , FINSEQ_1:1;
L1512: ( C225 . R6 ) = ( C225 /. R6 ) by L1511 , PARTFUN1:def 6;
L1513: S9[ R6 , ( C225 /. R6 ) , ( C225 /. D250 ) ] by L1248 , L1510 , L1509;
L1514: ( C225 . D250 ) = { B176 where B176 is (Subset of D226) : (B176 in C220 & (B176 c= ( C212 . D250 ) or B176 in ( C225 . R6 ))) } by L1513 , L1508 , L1512 , PARTFUN1:def 6;
thus L1515: thesis by L1514 , L1497 , L1500 , L1502 , L1506 , NAT_1:13;
end;
end;
L1517: S16[ ( 0 ) ] by L1497;
L1518: (for R6 being Nat holds S16[ R6 ]) from NAT_1:sch 2(L1517 , L1499);
reconsider D251 = ( C268 - 1 ) as Nat by L1495 , NAT_1:20;
assume L1519: ( C266 . C267 ) = ( C266 . C268 );
L1520: ( D251 + 1 ) = C268;
L1521: D251 < C268 by L1520 , NAT_1:13;
L1522: C268 <> 1 by L1491 , L1493 , L1495 , FINSEQ_1:1;
L1523: C267 <= D251 by L1495 , L1520 , NAT_1:13;
L1524: ( C266 . C267 ) in ( C225 . D251 ) by L1523 , L1521 , L1518;
thus L1525: contradiction by L1524 , L1491 , L1494 , L1519 , L1522;
end;
L1526:
now
let C269 , C270 being set;
assume L1527: (C269 in ( dom C266 ) & C270 in ( dom C266 ));
reconsider D252 = C269 , D253 = C270 as Nat by L1527;
assume L1528: ( C266 . C269 ) = ( C266 . C270 );
assume L1529: C269 <> C270;
L1530: (D252 > D253 or D252 < D253) by L1529 , XXREAL_0:1;
thus L1531: contradiction by L1530 , L1492 , L1527 , L1528;
end;
L1532: C266 is  one-to-one by L1526 , FUNCT_1:def 4;
L1533: ( card ( rng C266 ) ) = ( len C266 ) by L1532 , FINSEQ_4:62
.= ( len D222 ) by L1491 , FINSEQ_1:def 3
.= ( R5 + 1 ) by L1185 , L1200 , FINSEQ_4:62;
L1534: ( rng C266 ) is non  empty by L1533;
L1535:
now
let C271 being set;
assume L1536: C271 in ( rng C266 );
consider C272 being set such that L1537: (C272 in ( dom C266 ) & ( C266 . C272 ) = C271) by L1536 , FUNCT_1:def 3;
thus L1538: C262 in C271 by L1491 , L1537;
end;
L1539: ( rng C266 ) c= C220
proof
let C273 being set;
assume L1540: C273 in ( rng C266 );
consider C274 being set such that L1541: (C274 in ( dom C266 ) & ( C266 . C274 ) = C273) by L1540 , FUNCT_1:def 3;
thus L1542: thesis by L1491 , L1541;
end;
L1543: R5 < ( card ( rng C266 ) ) by L1533 , NAT_1:13;
L1544: ( card R5 ) in ( card ( card ( rng C266 ) ) ) by L1543 , NAT_1:41;
L1545: ( D224 + 1 ) in ( card ( rng C266 ) ) by L1544 , CARD_1:42;
L1546: ( meet ( rng C266 ) ) is  empty by L1545 , L1236 , L1539 , TOPDIM_2:2;
thus L1547: contradiction by L1546 , L1534 , L1535 , SETFAM_1:def 1;
end;
L1548: (( ind D221 ) <= ( ind D220 ) & ( ind D220 ) <= R5) by TOPDIM_1:20 , TOPDIM_2:21;
L1549: ( ind D221 ) <= R5 by L1548 , XXREAL_0:2;
thus L1550: thesis by L1549 , L1186 , XXREAL_0:1;
end;
theorem
L1551: (for R5 being Nat holds ( ind ( TOP-REAL R5 ) ) = R5)
proof
let R5 being Nat;
set D254 = ( TOP-REAL R5 );
consider C275 being  affinely-independent (Subset of D254) such that L1552: (( {} D254 ) c= C275 & C275 c= ( [#] D254 ) & ( Affin C275 ) = ( Affin ( [#] D254 ) )) by RLAFFIN1:60;
L1553: ( [#] D254 ) is  Affine by RUSUB_4:22;
L1554: (( dim D254 ) = R5 & ( Affin ( [#] D254 ) ) = ( [#] D254 )) by L1553 , RLAFFIN1:50 , RLAFFIN3:4;
L1555: ( card C275 ) = ( R5 + 1 ) by L1554 , L1552 , RLAFFIN3:6;
L1556: ( ind ( conv C275 ) ) = R5 by L1555 , L1184;
L1557: (( ind D254 ) >= R5 & ( ind D254 ) <= R5) by L1556 , TOPDIM_1:20 , TOPDIM_2:21;
thus L1558: thesis by L1557 , XXREAL_0:1;
end;
