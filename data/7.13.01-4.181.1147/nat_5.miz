:: The Perfect Number Theorem and Wilson's Theorem
::  by Marco Riccardi
::
:: Received March 3, 2009
:: Copyright (c) 2009-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, ORDINAL1, XCMPLX_0, INT_2, NAT_3, XXREAL_0, XBOOLE_0,
      NEWTON, ARYTM_3, ARYTM_1, NAT_1, RELAT_1, CARD_1, ABIAN, SUBSET_1,
      FINSET_1, FINSEQ_1, FUNCT_1, FINSEQ_3, TARSKI, CARD_3, ORDINAL4, FUNCT_2,
      FINSEQ_2, FUNCOP_1, MOEBIUS1, COMPLEX1, INT_1, REALSET1, SQUARE_1, INT_5,
      ZFMISC_1, POWER, REAL_1, PRE_POLY, UPROOTS, BHSP_5, CLASSES1, PARTFUN1,
      RFUNCT_3, BINOP_2, PROB_1, WAYBEL29, MSSUBFAM, TOPGEN_1, EULER_1, NAT_5;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, SETFAM_1, FUNCOP_1, RELAT_1,
      FUNCT_1, RELSET_1, PARTFUN1, MCART_1, FUNCT_2, ORDINAL1, CARD_1, NUMBERS,
      FINSEQ_1, FINSEQ_3, INT_1, INT_2, NAT_D, RVSUM_1, REAL_1, SQUARE_1,
      XXREAL_0, NEWTON,
      FINSEQ_2, ABIAN, PEPIN, INT_5, FINSEQOP, ENUMSET1, FINSET_1,
      COMPLEX1, NAT_3, DOMAIN_1, POWER, MOEBIUS1, BHSP_5, EULER_1, WSIERP_1,
      BINOP_1, RECDEF_1, EXTREAL1, UPROOTS, BINOP_2, FUNCT_3, RFUNCT_3,
      CLASSES1, PRE_POLY;
 constructors WELLORD2, REAL_1, NAT_D, BINOP_2, WSIERP_1, ABIAN, EULER_1,
      PEPIN, INT_5, RECDEF_1, MOEBIUS1, FINSEQOP, EXTREAL1, UPROOTS, NAT_3,
      REALSET1, POWER, BHSP_5, CALCUL_2, SUPINF_1, RFUNCT_3, CLASSES1, BINOP_1;
 registrations XBOOLE_0, RELSET_1, FINSET_1, NUMBERS, XCMPLX_0, XXREAL_0,
      XREAL_0, NAT_1, INT_1, MEMBERED, FINSEQ_1, RVSUM_1, VALUED_0, NEWTON,
      ABIAN, FUNCT_1, ZFMISC_1, SUBSET_1, MOEBIUS1, FUNCT_2, PRE_CIRC, DYNKIN,
      RELAT_1, SQUARE_1, CARD_1, PREPOWER, NAT_3, UPROOTS, PRE_POLY;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, NEWTON, FINSEQ_1, FINSEQ_3, EULER_1, MOEBIUS1;
 theorems XBOOLE_0, XBOOLE_1, XXREAL_0, XREAL_1, XCMPLX_1, NAT_1, NAT_D,
      RELAT_1, FUNCT_1, INT_1, INT_2, INT_4, INT_5, NEWTON, EULER_1, EULER_2,
      FINSEQ_1, FINSEQ_2, FINSEQ_3, FINSEQ_5, RVSUM_1, WSIERP_1, ORDINAL1,
      IDEA_1, INT_6, FIB_NUM3, POWER, PEPIN, SQUARE_1, CARD_1, CARD_2,
      ZFMISC_1, ALGSEQ_1, FINSEQ_4, JGRAPH_1, TARSKI, COMPLEX1, ABSVALUE,
      MOEBIUS1, CARD_3, MESFUNC3, FUNCT_2, EXTREAL1, FINSEQOP, FUNCOP_1,
      BAGORDER, RELSET_1, WELLORD2, PARTFUN1, BHSP_5, UPROOTS, RFINSEQ,
      BINOP_2, BINOP_1, FUNCT_3, RFUNCT_3, NAT_4, NAT_3, XREAL_0, ABIAN,
      ENUMSET1, MONOID_1, CLASSES1, PRE_POLY, XTUPLE_0;
 schemes NAT_1, FUNCT_1, FUNCT_2, BINOP_2, FINSEQ_1;

begin
L1: (for R5 being Nat holds (for R6 being non  zero Nat holds (for R7 being non  zero Nat holds (R5 is  prime implies ( R5 |-count ( R6 gcd R7 ) ) = ( min (( R5 |-count R6 ) , ( R5 |-count R7 )) )))))
proof
let R5 being Nat;
let R6 being non  zero Nat;
let R7 being non  zero Nat;
reconsider D1 = ( R6 gcd R7 ) as non  empty Nat by INT_2:5;
assume L2: R5 is  prime;
reconsider D2 = R5 as Prime by L2;
L3: D1 divides R6 by INT_2:def 2;
L4: ( D2 |-count D1 ) <= ( D2 |-count R6 ) by L3 , NAT_3:30;
L5: D1 divides R7 by INT_2:def 2;
L6: ( D2 |-count D1 ) <= ( D2 |-count R7 ) by L5 , NAT_3:30;
per cases ;
suppose L7: ( R5 |-count R6 ) <= ( R5 |-count R7 );

set D3 = ( D2 |^ ( D2 |-count R6 ) );
L8: ( D2 |^ ( R5 |-count R6 ) ) divides R7 by L7 , MOEBIUS1:9;
L9: R5 > 1 by L2 , INT_2:def 4;
L10: D3 divides R6 by L9 , NAT_3:def 7;
L11: D3 divides D1 by L10 , L8 , INT_2:def 2;
L12: ( D2 |-count D3 ) <= ( D2 |-count D1 ) by L11 , NAT_3:30;
L13: ( D2 |-count R6 ) <= ( D2 |-count D1 ) by L12 , L9 , NAT_3:25;
L14: ( R5 |-count ( R6 gcd R7 ) ) = ( R5 |-count R6 ) by L13 , L4 , XXREAL_0:1;
thus L15: thesis by L14 , L7 , XXREAL_0:def 9;
end;
suppose L16: (not ( R5 |-count R6 ) <= ( R5 |-count R7 ));

set D4 = ( D2 |^ ( D2 |-count R7 ) );
L17: ( D2 |^ ( R5 |-count R7 ) ) divides R6 by L16 , MOEBIUS1:9;
L18: R5 > 1 by L2 , INT_2:def 4;
L19: D4 divides R7 by L18 , NAT_3:def 7;
L20: D4 divides D1 by L19 , L17 , INT_2:def 2;
L21: ( D2 |-count D4 ) <= ( D2 |-count D1 ) by L20 , NAT_3:30;
L22: ( D2 |-count R7 ) <= ( D2 |-count D1 ) by L21 , L18 , NAT_3:25;
L23: ( R5 |-count ( R6 gcd R7 ) ) = ( R5 |-count R7 ) by L22 , L6 , XXREAL_0:1;
thus L24: thesis by L23 , L16 , XXREAL_0:def 9;
end;
end;
theorem
L26: (for R2 being Nat holds ( 2 |^ ( R2 + 1 ) ) < ( ( 2 |^ ( R2 + 2 ) ) - 1 ))
proof
let R2 being Nat;
defpred S1[ Nat ] means ( 2 |^ ( $1 + 1 ) ) < ( ( 2 |^ ( $1 + 2 ) ) - 1 );
L27: (for B1 being Nat holds (S1[ B1 ] implies S1[ ( B1 + 1 ) ]))
proof
let C1 being Nat;
assume L28: S1[ C1 ];
L29: ( ( 2 |^ ( C1 + 1 ) ) * 2 ) < ( ( ( 2 |^ ( C1 + 2 ) ) - 1 ) * 2 ) by L28 , XREAL_1:68;
L30: ( 2 |^ ( ( C1 + 1 ) + 1 ) ) < ( ( ( 2 |^ ( C1 + 2 ) ) * 2 ) - ( 1 * 2 ) ) by L29 , NEWTON:6;
L31: ( 2 |^ ( ( C1 + 1 ) + 1 ) ) < ( ( 2 |^ ( ( C1 + 2 ) + 1 ) ) - 2 ) by L30 , NEWTON:6;
L32: ( ( - 2 ) + ( 2 |^ ( ( C1 + 1 ) + 2 ) ) ) < ( ( - 1 ) + ( 2 |^ ( ( C1 + 1 ) + 2 ) ) ) by XREAL_1:8;
thus L33: S1[ ( C1 + 1 ) ] by L32 , L31 , XXREAL_0:2;
end;
L34: 2 < 3;
L35: ( 2 |^ 1 ) < ( ( 2 * 2 ) - 1 ) by L34 , NEWTON:5;
L36: ( 2 |^ 1 ) < ( ( ( 2 |^ 1 ) * 2 ) - 1 ) by L35 , NEWTON:5;
L37: ( 2 |^ 1 ) < ( ( 2 |^ ( 1 + 1 ) ) - 1 ) by L36 , NEWTON:6;
L38: S1[ ( 0 ) ] by L37;
L39: (for B2 being Nat holds S1[ B2 ]) from NAT_1:sch 2(L38 , L27);
thus L40: thesis by L39;
end;
theorem
L41: (for R6 being non  zero Nat holds (R6 is  even implies (ex R1 being Nat st (ex R3 being Nat st (R3 is  odd & R1 > ( 0 ) & R6 = ( ( 2 |^ R1 ) * R3 ))))))
proof
let R6 being non  zero Nat;
assume L42: R6 is  even;
set D5 = ( 2 |-count R6 );
L43: ( 2 |^ D5 ) divides R6 by NAT_3:def 7;
consider C2 being Nat such that L44: R6 = ( ( 2 |^ D5 ) * C2 ) by L43 , NAT_D:def 3;
take D5;
take C2;
L45:
now
reconsider D6 = C2 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L46: (not C2 is  odd);
consider C3 being (Element of ( NAT )) such that L47: D6 = ( 2 * C3 ) by L46 , ABIAN:def 2;
L48: R6 = ( ( ( 2 |^ D5 ) * 2 ) * C3 ) by L44 , L47
.= ( ( 2 |^ ( D5 + 1 ) ) * C3 ) by NEWTON:6;
L49: ( 2 |^ ( D5 + 1 ) ) divides R6 by L48 , NAT_D:def 3;
thus L50: contradiction by L49 , NAT_3:def 7;
end;
thus L51: C2 is  odd by L45;
L52:
now
assume L53: D5 = ( 0 );
L54: R6 = ( 1 * C2 ) by L53 , L44 , NEWTON:4;
thus L55: contradiction by L54 , L42 , L45;
end;
thus L56: D5 > ( 0 ) by L52;
thus L57: R6 = ( ( 2 |^ D5 ) * C2 ) by L44;
end;
theorem
L58: (for R1 being Nat holds (for R2 being Nat holds (for R3 being Nat holds ((R2 = ( 2 |^ R1 ) & R3 is  odd) implies R2 , R3 are_relative_prime ))))
proof
let R1 being Nat;
let R2 being Nat;
let R3 being Nat;
assume L59: R2 = ( 2 |^ R1 );
assume L60: R3 is  odd;
reconsider D7 = ( R2 gcd R3 ) as non  zero Nat by L60 , INT_2:5;
L61: (for B3 being (Element of ( NAT )) holds (B3 is  prime implies ( B3 |-count D7 ) = ( B3 |-count 1 )))
proof
reconsider D8 = R2 , D9 = R3 as non  zero Nat by L59 , L60;
let C4 being (Element of ( NAT ));
assume L62: C4 is  prime;
L63: ( min (( C4 |-count R2 ) , ( C4 |-count R3 )) ) = ( 0 )
proof
per cases ;
suppose L64: C4 = 2;

L65: (not C4 divides R3)
proof
assume L66: C4 divides R3;
consider C5 being Nat such that L67: R3 = ( C4 * C5 ) by L66 , NAT_D:def 3;
thus L68: contradiction by L60 , L64 , L67;
end;
L69: ( C4 |-count R3 ) = ( 0 ) by L65 , L64 , NAT_3:27;
thus L70: thesis by L69 , XXREAL_0:def 9;
end;
suppose L71: C4 <> 2;

L72: C4 <> 1 by L62 , INT_2:def 4;
L73: ( C4 |-count 2 ) = ( 0 ) by L72 , L71 , INT_2:28 , NAT_3:24;
L74: ( C4 |-count R2 ) = ( R1 * ( C4 |-count 2 ) ) by L59 , L62 , NAT_3:32
.= ( R1 * ( 0 ) ) by L73;
thus L75: thesis by L74 , XXREAL_0:def 9;
end;
end;
L77: (C4 > 1 & ( C4 |-count ( D8 gcd D9 ) ) = ( min (( C4 |-count D8 ) , ( C4 |-count D9 )) )) by L62 , L1 , INT_2:def 4;
thus L78: ( C4 |-count D7 ) = ( C4 |-count 1 ) by L77 , L63 , NAT_3:21;
end;
L79: ( R2 gcd R3 ) = 1 by L61 , NAT_4:21;
thus L80: R2 , R3 are_relative_prime  by L79 , INT_2:def 3;
end;
theorem
L81: (for R2 being Nat holds { R2 } is  finite  finite  finite  finite (Subset of ( NAT )))
proof
let R2 being Nat;
L82: R2 in ( NAT ) by ORDINAL1:def 12;
thus L83: { R2 } is  finite  finite  finite  finite (Subset of ( NAT )) by L82 , ZFMISC_1:31;
end;
theorem
L84: (for R2 being Nat holds (for R3 being Nat holds { R2 , R3 } is  finite  finite  finite  finite (Subset of ( NAT ))))
proof
let R2 being Nat;
let R3 being Nat;
L85: (R2 in ( NAT ) & R3 in ( NAT )) by ORDINAL1:def 12;
thus L86: { R2 , R3 } is  finite  finite  finite  finite (Subset of ( NAT )) by L85 , ZFMISC_1:32;
end;
L87: (for R2 being Nat holds (for R3 being Nat holds (for R4 being Nat holds { R2 , R3 , R4 } is  finite  finite  finite  finite (Subset of ( NAT )))))
proof
let R2 being Nat;
let R3 being Nat;
let R4 being Nat;
reconsider D10 = { R3 , R4 } as  finite (Subset of ( NAT )) by L84;
reconsider D11 = { R2 } as  finite (Subset of ( NAT )) by L81;
L88: { R2 , R3 , R4 } = ( D11 \/ D10 ) by ENUMSET1:2;
thus L89: { R2 , R3 , R4 } is  finite  finite  finite  finite (Subset of ( NAT )) by L88;
end;
L90: (for R1 being Nat holds (for R2 being Nat holds (for R3 being Nat holds (for R4 being Nat holds { R2 , R3 , R4 , R1 } is  finite  finite  finite  finite (Subset of ( NAT ))))))
proof
let R1 being Nat;
let R2 being Nat;
let R3 being Nat;
let R4 being Nat;
reconsider D12 = { R4 , R1 } as  finite (Subset of ( NAT )) by L84;
reconsider D13 = { R2 , R3 } as  finite (Subset of ( NAT )) by L84;
L91: { R2 , R3 , R4 , R1 } = ( D13 \/ D12 ) by ENUMSET1:5;
thus L92: { R2 , R3 , R4 , R1 } is  finite  finite  finite  finite (Subset of ( NAT )) by L91;
end;
theorem
L93: (for R2 being Nat holds (for R8 being FinSequence holds (R8 is  one-to-one implies ( Del (R8 , R2) ) is  one-to-one)))
proof
let R2 being Nat;
let R8 being FinSequence;
L94: ( dom R8 ) = ( Seg ( len R8 ) ) by FINSEQ_1:def 3;
L95: ( Sgm ( ( dom R8 ) \ { R2 } ) ) is  one-to-one by L94 , FINSEQ_3:92 , XBOOLE_1:36;
assume L96: R8 is  one-to-one;
thus L97: ( Del (R8 , R2) ) is  one-to-one by L96 , L95;
end;
theorem
L98: (for R2 being Nat holds (for R8 being FinSequence holds ((R8 is  one-to-one & R2 in ( dom R8 )) implies (not ( R8 . R2 ) in ( rng ( Del (R8 , R2) ) )))))
proof
let R2 being Nat;
let R8 being FinSequence;
assume L99: R8 is  one-to-one;
reconsider D14 = R2 as (Element of ( NAT )) by ORDINAL1:def 12;
L100: ( dom ( Del (R8 , D14) ) ) c= ( dom R8 ) by WSIERP_1:39;
assume L101: R2 in ( dom R8 );
consider C6 being Nat such that L102: ( len R8 ) = ( C6 + 1 ) and L103: ( len ( Del (R8 , R2) ) ) = C6 by L101 , FINSEQ_3:104;
assume L104: ( R8 . R2 ) in ( rng ( Del (R8 , R2) ) );
consider C7 being set such that L105: C7 in ( dom ( Del (R8 , R2) ) ) and L106: ( R8 . R2 ) = ( ( Del (R8 , R2) ) . C7 ) by L104 , FUNCT_1:def 3;
L107: C7 in ( Seg C6 ) by L103 , L105 , FINSEQ_1:def 3;
reconsider D15 = C7 as (Element of ( NAT )) by L105;
per cases ;
suppose L108: D15 < D14;

L109: ( R8 . R2 ) = ( R8 . D15 ) by L108 , L106 , FINSEQ_3:110;
thus L110: contradiction by L109 , L99 , L101 , L105 , L100 , L108 , FUNCT_1:def 4;
end;
suppose L111: D15 >= D14;

L112: ( D15 + 1 ) >= ( ( 0 ) + 1 ) by XREAL_1:6;
L113: D15 <= C6 by L107 , FINSEQ_1:1;
L114: ( D15 + 1 ) <= ( C6 + 1 ) by L113 , XREAL_1:6;
L115: ( D15 + 1 ) in ( Seg ( C6 + 1 ) ) by L114 , L112;
L116: ( D15 + 1 ) in ( dom R8 ) by L115 , L102 , FINSEQ_1:def 3;
L117: ( D15 + 1 ) <> R2 by L111 , NAT_1:13;
L118: ( R8 . R2 ) = ( R8 . ( D15 + 1 ) ) by L101 , L102 , L106 , L111 , L113 , FINSEQ_3:111;
thus L119: contradiction by L118 , L99 , L101 , L116 , L117 , FUNCT_1:def 4;
end;
end;
theorem
L121: (for R2 being Nat holds (for R8 being FinSequence holds (for R9 being set holds ((R9 in ( rng R8 ) & (not R9 in ( rng ( Del (R8 , R2) ) ))) implies R9 = ( R8 . R2 )))))
proof
let R2 being Nat;
let R8 being FinSequence;
let R9 being set;
reconsider D16 = R2 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L122: R9 in ( rng R8 );
consider C8 being set such that L123: C8 in ( dom R8 ) and L124: R9 = ( R8 . C8 ) by L122 , FUNCT_1:def 3;
L125: (for B4 being set holds (( card B4 ) = ( 0 ) implies B4 = ( {} )));
consider C9 being Nat such that L126: ( len R8 ) = ( C9 + 1 ) by L125 , L122 , NAT_1:6 , RELAT_1:38;
L127: C8 in ( Seg ( C9 + 1 ) ) by L123 , L126 , FINSEQ_1:def 3;
assume L128: (not R9 in ( rng ( Del (R8 , R2) ) ));
L129: R2 in ( dom R8 ) by L128 , L122 , FINSEQ_3:104;
L130: ( len ( Del (R8 , R2) ) ) = C9 by L129 , L126 , FINSEQ_3:109;
L131: R2 in ( Seg ( C9 + 1 ) ) by L126 , L129 , FINSEQ_1:def 3;
L132: 1 <= R2 by L131 , FINSEQ_1:1;
reconsider D17 = C8 as (Element of ( NAT )) by L123;
reconsider D18 = C9 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L133: (not R9 = ( R8 . R2 ));
L134: R2 <= ( C9 + 1 ) by L131 , FINSEQ_1:1;
per cases ;
suppose L135: D17 < D16;

L136: ( ( Del (R8 , D16) ) . D17 ) = ( R8 . D17 ) by L135 , FINSEQ_3:110;
L137: (not D17 in ( dom ( Del (R8 , R2) ) )) by L136 , L124 , L128 , FUNCT_1:def 3;
L138: (not D17 in ( Seg C9 )) by L137 , L130 , FINSEQ_1:def 3;
L139: (D17 < 1 or D17 > C9) by L138;
L140: D17 <= ( C9 + 1 ) by L127 , FINSEQ_1:1;
thus L141: contradiction by L140 , L127 , L134 , L135 , L139 , FINSEQ_1:1 , NAT_1:8;
end;
suppose L142: D17 >= D16;

set D19 = ( D17 -' 1 );
L143: D17 <= ( C9 + 1 ) by L127 , FINSEQ_1:1;
L144: ( D17 - 1 ) <= ( ( C9 + 1 ) - 1 ) by L143 , XREAL_1:9;
L145: D19 <= D18 by L144 , XREAL_0:def 2;
L146: D17 > D16 by L124 , L133 , L142 , XXREAL_0:1;
L147: D17 >= ( D16 + 1 ) by L146 , NAT_1:13;
L148: ( D17 - 1 ) >= ( ( D16 + 1 ) - 1 ) by L147 , XREAL_1:9;
L149: D19 >= D16 by L148 , XREAL_0:def 2;
L150: D19 >= 1 by L149 , L132 , XXREAL_0:2;
L151: D19 in ( Seg C9 ) by L150 , L145;
L152: D19 in ( dom ( Del (R8 , R2) ) ) by L151 , L130 , FINSEQ_1:def 3;
L153: D16 in ( dom R8 ) by L122 , L128 , FINSEQ_3:104;
L154: D16 <= D19 by L148 , XREAL_0:def 2;
L155: ( ( Del (R8 , D16) ) . D19 ) = ( R8 . ( D19 + 1 ) ) by L154 , L126 , L153 , L145 , FINSEQ_3:111;
L156: ( R8 . D17 ) <> ( R8 . ( D19 + 1 ) ) by L155 , L124 , L128 , L152 , FUNCT_1:def 3;
L157: ( R8 . D17 ) <> ( R8 . ( ( D17 - 1 ) + 1 ) ) by L156 , L148 , XREAL_0:def 2;
thus L158: contradiction by L157;
end;
end;
theorem
L160: (for R10 being set holds (for B5 being (FinSequence of ( NAT )) holds (for B6 being (FinSequence of R10) holds (( rng B5 ) c= ( dom B6 ) implies ( B6 * B5 ) is (FinSequence of R10)))))
proof
let R10 being set;
let C10 being (FinSequence of ( NAT ));
let C11 being (FinSequence of R10);
consider C12 being Nat such that L161: ( dom C10 ) = ( Seg C12 ) by FINSEQ_1:def 2;
assume L162: ( rng C10 ) c= ( dom C11 );
L163: ( dom ( C11 * C10 ) ) = ( Seg C12 ) by L162 , L161 , RELAT_1:27;
L164: ( C11 * C10 ) is FinSequence by L163 , FINSEQ_1:def 2;
L165: ( rng ( C11 * C10 ) ) c= R10;
thus L166: ( C11 * C10 ) is (FinSequence of R10) by L165 , L164 , FINSEQ_1:def 4;
end;
theorem
L167: (for R10 being set holds (for R11 being set holds (for R12 being (FinSequence of ( REAL )) holds (for R13 being (FinSequence of ( REAL )) holds (for R14 being (FinSequence of ( REAL )) holds ((( R10 \/ R11 ) = ( dom R12 ) & R10 misses R11 & R13 = ( R12 * ( Sgm R10 ) ) & R14 = ( R12 * ( Sgm R11 ) )) implies ( Sum R12 ) = ( ( Sum R13 ) + ( Sum R14 ) )))))))
proof
let R10 being set;
let R11 being set;
let R12 being (FinSequence of ( REAL ));
let R13 being (FinSequence of ( REAL ));
let R14 being (FinSequence of ( REAL ));
assume L168: ( R10 \/ R11 ) = ( dom R12 );
assume L169: R10 misses R11;
assume L170: R13 = ( R12 * ( Sgm R10 ) );
assume L171: R14 = ( R12 * ( Sgm R11 ) );
per cases ;
suppose L172: ( dom R12 ) = ( {} );

L173: R11 = ( {} ) by L172 , L168;
L174: R14 = ( {} ) by L173 , L171 , FINSEQ_3:43;
L175: R10 = ( {} ) by L168 , L172;
L176: R13 = ( {} ) by L175 , L170 , FINSEQ_3:43;
thus L177: thesis by L176 , L172 , L174 , RELAT_1:41 , RVSUM_1:72;
end;
suppose L178: ( dom R12 ) <> ( {} );

L179: ( dom R12 ) = ( Seg ( len R12 ) ) by FINSEQ_1:def 3;
reconsider D20 = ( id ( dom R12 ) ) as FinSequence by L179 , FINSEQ_2:48;
reconsider D21 = ( dom R12 ) as non  empty set by L178;
reconsider D22 = R12 as (FinSequence of ( ExtREAL )) by MESFUNC3:11;
L180: ( dom D22 ) = ( dom D20 ) by RELAT_1:45;
L181: R11 c= ( dom R12 ) by L168 , XBOOLE_1:7;
L182: ( rng ( Sgm R11 ) ) c= ( dom R12 ) by L181 , L179 , FINSEQ_1:def 13;
reconsider D23 = ( Sgm R11 ) as (FinSequence of D21) by L182 , FINSEQ_1:def 4;
L183: ( ( dom R12 ) \ R10 ) = R11 by L168 , L169 , XBOOLE_1:88;
L184: ( ( rng D20 ) \ R10 ) = R11 by L183 , RELAT_1:45;
L185: ( D20 " ( ( rng D20 ) \ R10 ) ) = R11 by L184 , L181 , FUNCT_2:94;
L186: R10 c= ( dom R12 ) by L168 , XBOOLE_1:7;
L187: ( rng ( Sgm R10 ) ) c= ( dom R12 ) by L186 , L179 , FINSEQ_1:def 13;
reconsider D24 = ( Sgm R10 ) as (FinSequence of D21) by L187 , FINSEQ_1:def 4;
L188: ( D20 " R10 ) = R10 by L186 , FUNCT_2:94;
reconsider D25 = ( ( Sgm R10 ) ^ ( Sgm R11 ) ) as (Permutation of ( dom D22 )) by L188 , L185 , L180 , FINSEQ_3:114;
L189: ( rng D25 ) c= ( dom R12 ) by FUNCT_2:def 3;
reconsider D26 = ( R12 * D25 ) as (FinSequence of ( REAL )) by L189 , L160;
reconsider D27 = R12 as (Function of D21 , ( REAL )) by FINSEQ_2:26;
reconsider D28 = D26 as (FinSequence of ( ExtREAL )) by MESFUNC3:11;
L190: (not ( -infty ) in ( rng D22 ));
L191: ( Sum D22 ) = ( Sum D28 ) by L190 , EXTREAL1:11;
L192: ( Sum R12 ) = ( Sum D28 ) by L191 , MESFUNC3:2;
L193: D26 = ( ( D27 * D24 ) ^ ( D27 * D23 ) ) by FINSEQOP:9;
L194: ( Sum D26 ) = ( ( Sum ( D27 * D24 ) ) + ( Sum ( D27 * D23 ) ) ) by L193 , RVSUM_1:75;
thus L195: ( Sum R12 ) = ( ( Sum R13 ) + ( Sum R14 ) ) by L194 , L170 , L171 , L192 , MESFUNC3:2;
end;
end;
theorem
L197: (for R10 being set holds (for R12 being (FinSequence of ( REAL )) holds (for R13 being (FinSequence of ( REAL )) holds ((R13 = ( R12 * ( Sgm R10 ) ) & ( ( dom R12 ) \ ( R12 " { ( 0 ) } ) ) c= R10 & R10 c= ( dom R12 )) implies ( Sum R12 ) = ( Sum R13 )))))
proof
let R10 being set;
let R12 being (FinSequence of ( REAL ));
let R13 being (FinSequence of ( REAL ));
assume L198: R13 = ( R12 * ( Sgm R10 ) );
set D29 = ( ( dom R12 ) \ R10 );
assume L199: ( ( dom R12 ) \ ( R12 " { ( 0 ) } ) ) c= R10;
assume L200: R10 c= ( dom R12 );
per cases ;
suppose L201: D29 = ( {} );

L202: ( R10 \ ( dom R12 ) ) = ( {} ) by L200 , XBOOLE_1:37;
L203: R10 = ( dom R12 ) by L202 , L201 , XBOOLE_1:32;
L204: R10 = ( Seg ( len R12 ) ) by L203 , FINSEQ_1:def 3;
L205: ( Sgm R10 ) = ( idseq ( len R12 ) ) by L204 , FINSEQ_3:48;
thus L206: thesis by L205 , L198 , FINSEQ_2:54;
end;
suppose L207: D29 <> ( {} );

set D30 = ( R12 * ( Sgm D29 ) );
L208: D29 c= ( dom R12 ) by XBOOLE_1:36;
L209: D29 c= ( Seg ( len R12 ) ) by L208 , FINSEQ_1:def 3;
L210: ( rng ( Sgm D29 ) ) c= ( dom R12 ) by L209 , L208 , FINSEQ_1:def 13;
reconsider D31 = D30 as (FinSequence of ( REAL )) by L210 , L160;
L211: R10 misses D29 by XBOOLE_1:79;
L212: D29 c= ( R12 " { ( 0 ) } )
proof
assume L213: (not D29 c= ( R12 " { ( 0 ) } ));
consider C13 being set such that L214: C13 in D29 and L215: (not C13 in ( R12 " { ( 0 ) } )) by L213 , TARSKI:def 3;
L216: C13 in ( dom R12 ) by L214 , XBOOLE_0:def 5;
L217: C13 in ( ( dom R12 ) \ ( R12 " { ( 0 ) } ) ) by L216 , L215 , XBOOLE_0:def 5;
L218: C13 in ( R10 /\ D29 ) by L217 , L199 , L214 , XBOOLE_0:def 4;
thus L219: contradiction by L218 , L211 , XBOOLE_0:def 7;
end;
L220: (for B7 being set holds (B7 in ( rng D31 ) iff B7 = ( 0 )))
proof
let C14 being set;
consider C15 being set such that L221: C15 in D29 by L207 , XBOOLE_0:def 1;
thus L222:now
assume L223: C14 in ( rng D31 );
consider C16 being set such that L224: C16 in ( dom D31 ) and L225: C14 = ( D31 . C16 ) by L223 , FUNCT_1:def 3;
L226: C16 in ( dom ( Sgm D29 ) ) by L224 , FUNCT_1:11;
L227: ( ( Sgm D29 ) . C16 ) in ( rng ( Sgm D29 ) ) by L226 , FUNCT_1:3;
L228: ( ( Sgm D29 ) . C16 ) in D29 by L227 , L209 , FINSEQ_1:def 13;
L229: ( R12 . ( ( Sgm D29 ) . C16 ) ) in { ( 0 ) } by L228 , L212 , FUNCT_1:def 7;
L230: ( D31 . C16 ) in { ( 0 ) } by L229 , L226 , FUNCT_1:13;
thus L231: C14 = ( 0 ) by L230 , L225 , TARSKI:def 1;
end;
assume L232: C14 = ( 0 );
L233: C15 in ( rng ( Sgm D29 ) ) by L209 , L221 , FINSEQ_1:def 13;
consider C17 being set such that L234: C17 in ( dom ( Sgm D29 ) ) and L235: C15 = ( ( Sgm D29 ) . C17 ) by L233 , FUNCT_1:def 3;
L236: ( R12 . C15 ) in { ( 0 ) } by L212 , L221 , FUNCT_1:def 7;
L237: ( R12 . ( ( Sgm D29 ) . C17 ) ) = C14 by L236 , L232 , L235 , TARSKI:def 1;
L238: ( D31 . C17 ) = C14 by L237 , L234 , FUNCT_1:13;
L239: C15 in ( dom R12 ) by L212 , L221 , FUNCT_1:def 7;
L240: C17 in ( dom D31 ) by L239 , L234 , L235 , FUNCT_1:11;
thus L241: C14 in ( rng D31 ) by L240 , L238 , FUNCT_1:def 3;
end;
L242: (( dom D31 ) = ( Seg ( len D31 ) ) & ( rng D31 ) = { ( 0 ) }) by L220 , FINSEQ_1:def 3 , TARSKI:def 1;
L243: D31 = ( ( Seg ( len D31 ) ) --> ( 0 ) ) by L242 , FUNCOP_1:9;
L244: D31 = ( ( len D31 ) |-> ( 0 ) ) by L243 , FINSEQ_2:def 2;
reconsider D32 = D31 as (FinSequence of ( NAT )) by L244;
L245: ( R10 \/ D29 ) = ( dom R12 ) by L200 , XBOOLE_1:45;
L246: ( Sum R12 ) = ( ( Sum R13 ) + ( Sum D32 ) ) by L245 , L198 , L167 , XBOOLE_1:79;
L247: ( Sum D32 ) = ( 0 ) by L244 , BAGORDER:4;
thus L248: ( Sum R12 ) = ( Sum R13 ) by L247 , L246;
end;
end;
theorem
L250: (for R12 being (FinSequence of ( REAL )) holds (for R13 being (FinSequence of ( REAL )) holds (R13 = ( R12 - { ( 0 ) } ) implies ( Sum R12 ) = ( Sum R13 ))))
proof
let R12 being (FinSequence of ( REAL ));
let R13 being (FinSequence of ( REAL ));
L251: ( ( dom R12 ) \ ( R12 " { ( 0 ) } ) ) c= ( dom R12 ) by XBOOLE_1:36;
assume L252: R13 = ( R12 - { ( 0 ) } );
thus L253: ( Sum R12 ) = ( Sum R13 ) by L252 , L251 , L197;
end;
theorem
L254: (for B8 being (FinSequence of ( NAT )) holds B8 is (FinSequence of ( REAL )))
proof
let C18 being (FinSequence of ( NAT ));
L255: (for B9 being Nat holds (B9 in ( dom C18 ) implies ( C18 . B9 ) in ( REAL )));
thus L256: thesis by L255 , FINSEQ_2:12;
end;
theorem
L257: (for R2 being Nat holds (for R3 being Nat holds (for R15 being Nat holds (for R17 being Nat holds ((R15 in ( NatDivisors R2 ) & R17 in ( NatDivisors R3 ) & R2 , R3 are_relative_prime ) implies R15 , R17 are_relative_prime )))))
proof
let R2 being Nat;
let R3 being Nat;
let R15 being Nat;
let R17 being Nat;
L258: ( R15 gcd R17 ) divides R17 by INT_2:def 2;
assume L259: R15 in ( NatDivisors R2 );
L260: R15 divides R2 by L259 , MOEBIUS1:39;
L261: ( R15 gcd R17 ) divides R15 by INT_2:def 2;
L262: ( R15 gcd R17 ) divides R2 by L261 , L260 , INT_2:9;
assume L263: R17 in ( NatDivisors R3 );
L264: R17 divides R3 by L263 , MOEBIUS1:39;
L265: ( R15 gcd R17 ) divides R3 by L264 , L258 , INT_2:9;
L266: ( 0 ) < R17 by L263 , MOEBIUS1:39;
L267: ( R15 gcd R17 ) <> ( 0 ) by L266 , INT_2:5;
L268: ( ( R15 gcd R17 ) + 1 ) > ( ( 0 ) + 1 ) by L267 , XREAL_1:8;
L269: ( R15 gcd R17 ) >= 1 by L268 , NAT_1:13;
assume L270: R2 , R3 are_relative_prime ;
assume L271: (not R15 , R17 are_relative_prime );
L272: ( R15 gcd R17 ) <> 1 by L271 , INT_2:def 3;
L273: ( R2 gcd R3 ) > ( 0 ) by L270 , INT_2:def 3;
L274: ( R15 gcd R17 ) <= ( R2 gcd R3 ) by L273 , L262 , L265 , INT_2:22 , INT_2:27;
L275: ( R2 gcd R3 ) <> 1 by L274 , L272 , L269 , XXREAL_0:1;
thus L276: contradiction by L275 , L270 , INT_2:def 3;
end;
theorem
L277: (for R2 being Nat holds (for R3 being Nat holds (for R15 being Nat holds (for R16 being Nat holds (for R17 being Nat holds (for R18 being Nat holds ((R15 in ( NatDivisors R2 ) & R17 in ( NatDivisors R3 ) & R16 in ( NatDivisors R2 ) & R18 in ( NatDivisors R3 ) & R2 , R3 are_relative_prime  & ( R15 * R17 ) = ( R16 * R18 )) implies (R15 = R16 & R17 = R18))))))))
proof
let R2 being Nat;
let R3 being Nat;
let R15 being Nat;
let R16 being Nat;
let R17 being Nat;
let R18 being Nat;
assume L278: R15 in ( NatDivisors R2 );
L279: R15 divides R2 by L278 , MOEBIUS1:39;
assume L280: R17 in ( NatDivisors R3 );
L281: R17 divides R3 by L280 , MOEBIUS1:39;
assume L282: R16 in ( NatDivisors R2 );
L283: R16 divides R2 by L282 , MOEBIUS1:39;
assume L284: R18 in ( NatDivisors R3 );
assume L285: R2 , R3 are_relative_prime ;
assume L286: ( R15 * R17 ) = ( R16 * R18 );
L287: R18 divides R3 by L284 , MOEBIUS1:39;
L288:
now
reconsider D33 = R17 , D34 = R18 as non  empty Nat by L280 , L284 , MOEBIUS1:39;
L289: ( R2 gcd R3 ) > ( 0 ) by L285 , INT_2:def 3;
reconsider D35 = R15 , D36 = R16 as non  empty Nat by L278 , L282 , MOEBIUS1:39;
assume L290: R15 <> R16;
consider C19 being (Element of ( NAT )) such that L291: C19 is  prime and L292: ( C19 |-count D35 ) <> ( C19 |-count D36 ) by L290 , NAT_4:21;
reconsider D37 = C19 as Prime by L291;
L293: ( ( D37 |-count D35 ) + ( D37 |-count D33 ) ) = ( D37 |-count ( D35 * D33 ) ) by NAT_3:28
.= ( ( D37 |-count D36 ) + ( D37 |-count D34 ) ) by L286 , NAT_3:28;
L294: (( D37 |-count D33 ) <> ( 0 ) or ( D37 |-count D34 ) <> ( 0 )) by L293 , L292;
L295: (D37 divides D33 or D37 divides D34) by L294 , MOEBIUS1:6;
L296: D37 divides R3 by L295 , L281 , L287 , INT_2:9;
L297: (( D37 |-count D35 ) <> ( 0 ) or ( D37 |-count D36 ) <> ( 0 )) by L292;
L298: (D37 divides D35 or D37 divides D36) by L297 , MOEBIUS1:6;
L299: D37 divides R2 by L298 , L279 , L283 , INT_2:9;
L300: D37 divides ( R2 gcd R3 ) by L299 , L296 , INT_2:def 2;
L301: D37 <= ( R2 gcd R3 ) by L300 , L289 , INT_2:27;
L302: D37 > 1 by INT_2:def 4;
thus L303: contradiction by L302 , L285 , L301 , INT_2:def 3;
end;
L304: ( 0 ) < R16 by L282 , MOEBIUS1:39;
assume L305: (not (R15 = R16 & R17 = R18));
thus L306: contradiction by L305 , L304 , L286 , L288 , XCMPLX_1:5;
end;
theorem
L307: (for R6 being non  zero Nat holds (for R7 being non  zero Nat holds (for R15 being Nat holds (for R17 being Nat holds ((R15 in ( NatDivisors R6 ) & R17 in ( NatDivisors R7 )) implies ( R15 * R17 ) in ( NatDivisors ( R6 * R7 ) ))))))
proof
let R6 being non  zero Nat;
let R7 being non  zero Nat;
let R15 being Nat;
let R17 being Nat;
reconsider D38 = ( R6 * R7 ) as non  empty Nat;
assume L308: R15 in ( NatDivisors R6 );
L309: ( 0 ) < R15 by L308 , MOEBIUS1:39;
L310: R15 divides R6 by L308 , MOEBIUS1:39;
assume L311: R17 in ( NatDivisors R7 );
L312: ( 0 ) < R17 by L311 , MOEBIUS1:39;
reconsider D39 = ( R15 * R17 ) as non  empty Nat by L312 , L309;
L313: R17 divides R7 by L311 , MOEBIUS1:39;
L314: (for B10 being (Element of ( NAT )) holds (B10 is  prime implies ( B10 |-count D39 ) <= ( B10 |-count D38 )))
proof
reconsider D40 = R15 , D41 = R17 as non  empty Nat by L308 , L311 , MOEBIUS1:39;
let C20 being (Element of ( NAT ));
assume L315: C20 is  prime;
reconsider D42 = C20 as Prime by L315;
L316: (( D42 |-count ( D40 * D41 ) ) = ( ( D42 |-count D40 ) + ( D42 |-count D41 ) ) & ( D42 |-count ( R6 * R7 ) ) = ( ( D42 |-count R6 ) + ( D42 |-count R7 ) )) by NAT_3:28;
L317: (( D42 |-count D40 ) <= ( D42 |-count R6 ) & ( D42 |-count D41 ) <= ( D42 |-count R7 )) by L310 , L313 , NAT_3:30;
thus L318: ( C20 |-count D39 ) <= ( C20 |-count D38 ) by L317 , L316 , XREAL_1:7;
end;
L319: (ex B11 being (Element of ( NAT )) st ( R6 * R7 ) = ( ( R15 * R17 ) * B11 )) by L314 , NAT_4:20;
L320: ( R15 * R17 ) divides ( R6 * R7 ) by L319 , NAT_D:def 3;
thus L321: ( R15 * R17 ) in ( NatDivisors ( R6 * R7 ) ) by L320 , L309 , L312;
end;
theorem
L322: (for R1 being Nat holds (for R6 being non  zero Nat holds (for R7 being non  zero Nat holds (R6 , R7 are_relative_prime  implies ( R1 gcd ( R6 * R7 ) ) = ( ( R1 gcd R6 ) * ( R1 gcd R7 ) )))))
proof
let R1 being Nat;
let R6 being non  zero Nat;
let R7 being non  zero Nat;
assume L323: R6 , R7 are_relative_prime ;
per cases ;
suppose L324: R1 = ( 0 );

thus L325: ( R1 gcd ( R6 * R7 ) ) = ( abs ( R6 * R7 ) ) by L324 , WSIERP_1:8
.= ( ( abs R6 ) * ( abs R7 ) ) by COMPLEX1:65
.= ( ( R1 gcd R6 ) * ( abs R7 ) ) by L324 , WSIERP_1:8
.= ( ( R1 gcd R6 ) * ( R1 gcd R7 ) ) by L324 , WSIERP_1:8;
end;
suppose L326: R1 <> ( 0 );

reconsider D43 = R1 as non  zero Nat by L326;
reconsider D44 = ( R1 gcd ( R6 * R7 ) ) as non  empty Nat by INT_2:5;
reconsider D45 = ( R1 gcd R6 ) , D46 = ( R1 gcd R7 ) as non  empty Nat by INT_2:5;
L327: (( R1 gcd R6 ) <> ( 0 ) & ( R1 gcd R7 ) <> ( 0 )) by INT_2:5;
reconsider D47 = ( ( R1 gcd R6 ) * ( R1 gcd R7 ) ) as non  empty Nat by L327;
L328: (for B12 being (Element of ( NAT )) holds (B12 is  prime implies ( B12 |-count D44 ) = ( B12 |-count D47 )))
proof
let C21 being (Element of ( NAT ));
assume L329: C21 is  prime;
reconsider D48 = C21 as Prime by L329;
L330: ( D48 |-count D44 ) = ( min (( D48 |-count D43 ) , ( D48 |-count ( R6 * R7 ) )) ) by L1
.= ( min (( D48 |-count R1 ) , ( ( D48 |-count R6 ) + ( D48 |-count R7 ) )) ) by NAT_3:28;
L331: ( R6 gcd R7 ) = 1 by L323 , INT_2:def 3;
L332: (D48 > 1 & ( D48 |-count 1 ) = ( min (( D48 |-count R6 ) , ( D48 |-count R7 )) )) by L331 , L1 , INT_2:def 4;
L333: ( min (( D48 |-count R6 ) , ( D48 |-count R7 )) ) = ( 0 ) by L332 , NAT_3:21;
L334: ( D48 |-count D47 ) = ( ( D48 |-count D45 ) + ( D48 |-count D46 ) ) by NAT_3:28
.= ( ( min (( D48 |-count D43 ) , ( D48 |-count R6 )) ) + ( D48 |-count D46 ) ) by L1
.= ( ( min (( D48 |-count D43 ) , ( D48 |-count R6 )) ) + ( min (( D48 |-count D43 ) , ( D48 |-count R7 )) ) ) by L1;
per cases  by L333 , XXREAL_0:15;
suppose L335: ( D48 |-count R6 ) = ( 0 );

L336: ( min (( D48 |-count R1 ) , ( D48 |-count R6 )) ) = ( D48 |-count R6 ) by L335 , XXREAL_0:def 9;
thus L337: ( C21 |-count D44 ) = ( C21 |-count D47 ) by L336 , L330 , L334 , L335;
end;
suppose L338: ( D48 |-count R7 ) = ( 0 );

L339: ( min (( D48 |-count R1 ) , ( D48 |-count R7 )) ) = ( D48 |-count R7 ) by L338 , XXREAL_0:def 9;
thus L340: ( C21 |-count D44 ) = ( C21 |-count D47 ) by L339 , L330 , L334 , L338;
end;
end;
thus L342: ( R1 gcd ( R6 * R7 ) ) = ( ( R1 gcd R6 ) * ( R1 gcd R7 ) ) by L328 , NAT_4:21;
end;
end;
theorem
L344: (for R1 being Nat holds (for R6 being non  zero Nat holds (for R7 being non  zero Nat holds ((R6 , R7 are_relative_prime  & R1 in ( NatDivisors ( R6 * R7 ) )) implies (ex R15 being Nat st (ex R17 being Nat st (R15 in ( NatDivisors R6 ) & R17 in ( NatDivisors R7 ) & R1 = ( R15 * R17 ))))))))
proof
let R1 being Nat;
let R6 being non  zero Nat;
let R7 being non  zero Nat;
assume L345: R6 , R7 are_relative_prime ;
set D49 = ( R1 gcd R7 );
set D50 = ( R1 gcd R6 );
assume L346: R1 in ( NatDivisors ( R6 * R7 ) );
take D50;
take D49;
L347: (D50 divides R6 & D50 > ( 0 )) by NAT_D:def 5 , NEWTON:58;
thus L348: D50 in ( NatDivisors R6 ) by L347;
L349: (D49 divides R7 & D49 > ( 0 )) by NAT_D:def 5 , NEWTON:58;
thus L350: D49 in ( NatDivisors R7 ) by L349;
L351: R1 divides ( R6 * R7 ) by L346 , MOEBIUS1:39;
thus L352: R1 = ( R1 gcd ( R6 * R7 ) ) by L351 , NEWTON:49
.= ( D50 * D49 ) by L345 , L322;
end;
theorem
L353: (for R2 being Nat holds (for R5 being Nat holds (R5 is  prime implies ( NatDivisors ( R5 |^ R2 ) ) = { ( R5 |^ B13 ) where B13 is (Element of ( NAT )) : B13 <= R2 })))
proof
let R2 being Nat;
let R5 being Nat;
assume L354: R5 is  prime;
L355: (for B14 being set holds (B14 in ( NatDivisors ( R5 |^ R2 ) ) iff B14 in { ( R5 |^ B15 ) where B15 is (Element of ( NAT )) : B15 <= R2 }))
proof
let C22 being set;
thus L356:now
assume L357: C22 in ( NatDivisors ( R5 |^ R2 ) );
reconsider D51 = C22 as Nat by L357;
L358: D51 divides ( R5 |^ R2 ) by L357 , MOEBIUS1:39;
L359: (ex B16 being (Element of ( NAT )) st (D51 = ( R5 |^ B16 ) & B16 <= R2)) by L358 , L354 , PEPIN:34;
thus L360: C22 in { ( R5 |^ B17 ) where B17 is (Element of ( NAT )) : B17 <= R2 } by L359;
end;
assume L361: C22 in { ( R5 |^ B18 ) where B18 is (Element of ( NAT )) : B18 <= R2 };
L362: (ex B19 being (Element of ( NAT )) st (C22 = ( R5 |^ B19 ) & B19 <= R2)) by L361;
reconsider D52 = C22 as Nat by L362;
L363: D52 divides ( R5 |^ R2 ) by L362 , NEWTON:89;
thus L364: C22 in ( NatDivisors ( R5 |^ R2 ) ) by L363 , L354 , L362 , MOEBIUS1:39;
end;
thus L365: thesis by L355 , TARSKI:1;
end;
theorem
L366: (for R4 being Nat holds (for R5 being Nat holds (for R15 being Nat holds (for R16 being Nat holds ((( 0 ) <> R4 & R5 > R4 & R5 > R15 & R5 > R16 & ( ( R4 * R15 ) mod R5 ) = ( ( R4 * R16 ) mod R5 ) & R5 is  prime) implies R15 = R16)))))
proof
let R4 being Nat;
let R5 being Nat;
let R15 being Nat;
let R16 being Nat;
assume that
L367: (R4 <> ( 0 ) & R5 > R4)
and
L368: R5 > R15
and
L369: R5 > R16;
assume L370: ( ( R4 * R15 ) mod R5 ) = ( ( R4 * R16 ) mod R5 );
assume L371: R5 is  prime;
L372: ( ( ( R4 * R15 ) - ( R4 * R16 ) ) mod R5 ) = ( 0 ) by L371 , L370 , INT_4:22;
L373: R5 divides ( R4 * ( R15 - R16 ) ) by L372 , L371 , INT_1:62;
per cases  by L371 , L373 , INT_5:7;
suppose L374: R5 divides R4;

thus L375: thesis by L374 , L367 , NAT_D:7;
end;
suppose L376: R5 divides ( R15 - R16 );

per cases ;
suppose L377: ( R15 - R16 ) > ( 0 );

L378: (R5 divides ( R15 -' R16 ) & ( R15 -' R16 ) > ( 0 )) by L377 , L376 , XREAL_0:def 2;
L379: R5 <= ( R15 -' R16 ) by L378 , NAT_D:7;
L380: ( R5 + R16 ) <= ( ( R15 -' R16 ) + R16 ) by L379 , XREAL_1:6;
L381: ( R5 + R16 ) <= ( ( R15 - R16 ) + R16 ) by L380 , L377 , XREAL_0:def 2;
L382: ( R5 + R16 ) < R5 by L381 , L368 , XXREAL_0:2;
L383: ( ( R5 + R16 ) - R5 ) < ( R5 - R5 ) by L382 , XREAL_1:9;
L384: R16 < ( 0 ) by L383;
thus L385: thesis by L384;
end;
suppose L386: ( R15 - R16 ) = ( 0 );

thus L387: thesis by L386;
end;
suppose L388: ( R15 - R16 ) < ( 0 );

L389: ( - ( R15 - R16 ) ) > ( 0 ) by L388;
L390: ( R16 - R15 ) > ( 0 ) by L389;
L391: ( R16 -' R15 ) > ( 0 ) by L390 , XREAL_0:def 2;
L392: R5 divides ( - ( R15 - R16 ) ) by L376 , INT_2:10;
L393: R5 divides ( R16 -' R15 ) by L392 , L390 , XREAL_0:def 2;
L394: R5 <= ( R16 -' R15 ) by L393 , L391 , NAT_D:7;
L395: ( R5 + R15 ) <= ( ( R16 -' R15 ) + R15 ) by L394 , XREAL_1:6;
L396: ( R5 + R15 ) <= ( ( R16 - R15 ) + R15 ) by L395 , L389 , XREAL_0:def 2;
L397: ( R5 + R15 ) < R5 by L396 , L369 , XXREAL_0:2;
L398: ( ( R5 + R15 ) - R5 ) < ( R5 - R5 ) by L397 , XREAL_1:9;
L399: R15 < ( 0 ) by L398;
thus L400: thesis by L399;
end;
end;
end;
theorem
L403: (for R5 being Nat holds (for R6 being non  zero Nat holds (for R7 being non  zero Nat holds (R5 is  prime implies ( R5 |-count ( R6 gcd R7 ) ) = ( min (( R5 |-count R6 ) , ( R5 |-count R7 )) ))))) by L1;
L404: (for R1 being Nat holds (for R3 being Nat holds (R1 < R3 iff R1 <= ( R3 - 1 ))))
proof
let R1 being Nat;
let R3 being Nat;
L405:
now
assume L406: R1 <= ( R3 - 1 );
L407: ( R1 + 1 ) <= R3 by L406 , XREAL_1:19;
L408: R1 < ( R1 + 1 ) by XREAL_1:29;
thus L409: R1 < R3 by L408 , L407 , XXREAL_0:2;
end;
L410:
now
assume L411: R1 < R3;
L412: ( R1 + 1 ) <= R3 by L411 , INT_1:7;
thus L413: R1 <= ( R3 - 1 ) by L412 , XREAL_1:19;
end;
thus L414: thesis by L410 , L405;
end;
L415: (for B20 being (Element of ( NAT )) holds (for B21 being FinSequence holds (B20 in ( dom B21 ) implies (ex B22 , B23 being FinSequence st (B21 = ( ( B22 ^ <* ( B21 . B20 ) *> ) ^ B23 ) & ( len B22 ) = ( B20 - 1 ) & ( len B23 ) = ( ( len B21 ) - B20 ))))))
proof
let C23 being (Element of ( NAT ));
let C24 being FinSequence;
assume L416: C23 in ( dom C24 );
L417: (C23 >= 1 & C23 <= ( len C24 )) by L416 , FINSEQ_3:25;
reconsider D53 = ( ( len C24 ) - C23 ) , D54 = ( C23 - 1 ) as (Element of ( NAT )) by L417 , INT_1:5;
L418: ( len C24 ) = ( C23 + D53 );
consider C25 , C26 being FinSequence such that L419: ( len C25 ) = C23 and L420: ( len C26 ) = D53 and L421: C24 = ( C25 ^ C26 ) by L418 , FINSEQ_2:22;
L422: C23 = ( D54 + 1 );
consider C27 being FinSequence, C28 being set such that L423: C25 = ( C27 ^ <* C28 *> ) by L422 , L419 , FINSEQ_2:18;
L424: ( ( len C27 ) + 1 ) = ( D54 + 1 ) by L419 , L423 , FINSEQ_2:16;
L425: C25 <> ( {} ) by L416 , L419 , FINSEQ_3:25;
L426: C23 in ( dom C25 ) by L425 , L419 , FINSEQ_5:6;
L427: ( C25 . C23 ) = ( C24 . C23 ) by L426 , L421 , FINSEQ_1:def 7;
L428: ( C24 . C23 ) = C28 by L427 , L423 , L424 , FINSEQ_1:42;
thus L429: thesis by L428 , L420 , L421 , L423 , L424;
end;
L430: (for B24 being (Element of ( NAT )) holds (for B25 , B26 , B27 being FinSequence holds (for B28 being set holds ((B24 in ( dom B25 ) & B25 = ( ( B26 ^ <* B28 *> ) ^ B27 ) & ( len B26 ) = ( B24 - 1 )) implies ( Del (B25 , B24) ) = ( B26 ^ B27 )))))
proof
let C29 being (Element of ( NAT ));
let C30 , C31 , C32 being FinSequence;
let C33 being set;
assume that
L431: C29 in ( dom C30 )
and
L432: C30 = ( ( C31 ^ <* C33 *> ) ^ C32 )
and
L433: ( len C31 ) = ( C29 - 1 );
L434: ( ( len ( Del (C30 , C29) ) ) + 1 ) = ( len C30 ) by L431 , WSIERP_1:def 1;
L435: ( len C30 ) = ( ( len ( C31 ^ <* C33 *> ) ) + ( len C32 ) ) by L432 , FINSEQ_1:22
.= ( ( ( len C31 ) + 1 ) + ( len C32 ) ) by FINSEQ_2:16
.= ( C29 + ( len C32 ) ) by L433;
L436: ( len ( Del (C30 , C29) ) ) = ( ( len C32 ) + ( len C31 ) ) by L435 , L433 , L434;
L437: ( len ( C31 ^ C32 ) ) = ( len ( Del (C30 , C29) ) ) by L436 , FINSEQ_1:22;
L438: ( len <* C33 *> ) = 1 by FINSEQ_1:39;
L439: C30 = ( C31 ^ ( <* C33 *> ^ C32 ) ) by L432 , FINSEQ_1:32;
L440: ( len C30 ) = ( ( C29 - 1 ) + ( len ( <* C33 *> ^ C32 ) ) ) by L439 , L433 , FINSEQ_1:22;
L441: ( len ( <* C33 *> ^ C32 ) ) = ( ( len C30 ) - ( C29 - 1 ) ) by L440;
L442:
now
let C34 being Nat;
assume that
L443: 1 <= C34
and
L444: C34 <= ( len ( Del (C30 , C29) ) );
L445:
now
per cases ;
suppose L446: C34 < C29;

L447: C34 <= ( C29 - 1 ) by L446 , L404;
L448: C34 in ( dom C31 ) by L447 , L433 , L443 , FINSEQ_3:25;
thus L449: ( ( C31 ^ C32 ) . C34 ) = ( C31 . C34 ) by L448 , FINSEQ_1:def 7
.= ( C30 . C34 ) by L439 , L448 , FINSEQ_1:def 7
.= ( ( Del (C30 , C29) ) . C34 ) by L431 , L446 , WSIERP_1:def 1;
end;
suppose L450: C34 >= C29;

L451: C34 > ( C29 - 1 ) by L450 , L404;
L452: ( C34 + 1 ) > C29 by L451 , XREAL_1:19;
L453: ( ( C34 + 1 ) - C29 ) > ( 0 ) by L452 , XREAL_1:50;
L454: ( ( ( C34 + 1 ) - C29 ) + 1 ) > ( (( 0 ) qua Nat) + 1 ) by L453 , XREAL_1:6;
L455: ( C34 + 1 ) > ( C29 - 1 ) by L452 , XREAL_1:146 , XXREAL_0:2;
L456: ( ( C34 + 1 ) - ( C29 - 1 ) ) > ( 0 ) by L455 , XREAL_1:50;
reconsider D55 = ( ( C34 + 1 ) - ( C29 - 1 ) ) as (Element of ( NAT )) by L456 , INT_1:3;
L457: ( C34 + 1 ) <= ( len C30 ) by L434 , L444 , XREAL_1:6;
L458: ( ( C34 + 1 ) - ( C29 - 1 ) ) <= ( len ( <* C33 *> ^ C32 ) ) by L457 , L441 , XREAL_1:9;
thus L459: ( ( C31 ^ C32 ) . C34 ) = ( C32 . ( C34 - ( len C31 ) ) ) by L433 , L437 , L444 , L451 , FINSEQ_1:24
.= ( C32 . ( D55 - 1 ) ) by L433
.= ( ( <* C33 *> ^ C32 ) . D55 ) by L438 , L454 , L458 , FINSEQ_1:24
.= ( ( C31 ^ ( <* C33 *> ^ C32 ) ) . ( C34 + 1 ) ) by L433 , L439 , L455 , L457 , FINSEQ_1:24
.= ( ( Del (C30 , C29) ) . C34 ) by L431 , L439 , L450 , WSIERP_1:def 1;
end;
end;
thus L461: ( ( C31 ^ C32 ) . C34 ) = ( ( Del (C30 , C29) ) . C34 ) by L445;
end;
thus L462: thesis by L442 , L437 , FINSEQ_1:14;
end;
L463: (for B29 being FinSequence holds (1 <= ( len B29 ) implies (B29 = ( <* ( B29 . 1 ) *> ^ ( Del (B29 , 1) ) ) & B29 = ( ( Del (B29 , ( len B29 )) ) ^ <* ( B29 . ( len B29 ) ) *> ))))
proof
let C35 being FinSequence;
set D56 = ( <* ( C35 . 1 ) *> ^ ( Del (C35 , 1) ) );
set D57 = ( ( Del (C35 , ( len C35 )) ) ^ <* ( C35 . ( len C35 ) ) *> );
L464: ( len <* ( C35 . 1 ) *> ) = 1 by FINSEQ_1:39;
assume L465: 1 <= ( len C35 );
L466: ( len C35 ) in ( dom C35 ) by L465 , FINSEQ_3:25;
L467: 1 in ( dom C35 ) by L465 , FINSEQ_3:25;
L468: ( len C35 ) = ( ( len <* ( C35 . 1 ) *> ) + ( len ( Del (C35 , 1) ) ) ) by L467 , L464 , WSIERP_1:def 1
.= ( len D56 ) by FINSEQ_1:22;
L469: (for B30 being Nat holds ((1 <= B30 & B30 <= ( len C35 )) implies ( C35 . B30 ) = ( D56 . B30 )))
proof
let C36 being Nat;
assume that
L470: 1 <= C36
and
L471: C36 <= ( len C35 );
L472:
now
per cases  by L470 , XXREAL_0:1;
suppose L473: C36 = 1;

L474: 1 in ( dom <* ( C35 . 1 ) *> ) by L464 , FINSEQ_3:25;
thus L475: ( D56 . C36 ) = ( <* ( C35 . 1 ) *> . 1 ) by L474 , L473 , FINSEQ_1:def 7
.= ( C35 . C36 ) by L473 , FINSEQ_1:40;
end;
suppose L476: C36 > 1;

L477: ( C36 - 1 ) > ( 0 ) by L476 , XREAL_1:50;
reconsider D58 = ( C36 - 1 ) as (Element of ( NAT )) by L477 , INT_1:3;
L478: D58 >= 1 by L477 , NAT_1:14;
thus L479: ( D56 . C36 ) = ( ( Del (C35 , 1) ) . D58 ) by L464 , L468 , L471 , L476 , FINSEQ_1:24
.= ( C35 . ( D58 + 1 ) ) by L467 , L478 , WSIERP_1:def 1
.= ( C35 . C36 );
end;
end;
thus L481: thesis by L472;
end;
thus L482: D56 = C35 by L469 , L468 , FINSEQ_1:14;
L483: ( len <* ( C35 . ( len C35 ) ) *> ) = 1 by FINSEQ_1:39;
L484: ( len C35 ) = ( ( len <* ( C35 . ( len C35 ) ) *> ) + ( len ( Del (C35 , ( len C35 )) ) ) ) by L483 , L466 , WSIERP_1:def 1
.= ( len D57 ) by FINSEQ_1:22;
L485: ( ( len ( Del (C35 , ( len C35 )) ) ) + 1 ) = ( len C35 ) by L466 , WSIERP_1:def 1;
L486: ( len ( Del (C35 , ( len C35 )) ) ) = ( ( len C35 ) - 1 ) by L485;
L487: (for B31 being Nat holds ((1 <= B31 & B31 <= ( len C35 )) implies ( C35 . B31 ) = ( D57 . B31 )))
proof
let C37 being Nat;
assume that
L488: 1 <= C37
and
L489: C37 <= ( len C35 );
L490:
now
per cases  by L489 , XXREAL_0:1;
suppose L491: C37 = ( len C35 );

reconsider D59 = ( C37 - ( C37 - 1 ) ) as (Element of ( NAT ));
thus L492: ( D57 . C37 ) = ( <* ( C35 . ( len C35 ) ) *> . D59 ) by L485 , L484 , L491 , FINSEQ_1:24 , XREAL_1:146
.= ( C35 . C37 ) by L491 , FINSEQ_1:40;
end;
suppose L493: C37 < ( len C35 );

L494: ( C37 + 1 ) <= ( len C35 ) by L493 , NAT_1:13;
L495: C37 <= ( len ( Del (C35 , ( len C35 )) ) ) by L494 , L486 , XREAL_1:19;
L496: C37 in ( dom ( Del (C35 , ( len C35 )) ) ) by L495 , L488 , FINSEQ_3:25;
thus L497: ( D57 . C37 ) = ( ( Del (C35 , ( len C35 )) ) . C37 ) by L496 , FINSEQ_1:def 7
.= ( C35 . C37 ) by L466 , L493 , WSIERP_1:def 1;
end;
end;
thus L499: thesis by L490;
end;
thus L500: D57 = C35 by L487 , L484 , FINSEQ_1:14;
end;
L501: (for B32 being (Element of ( NAT )) holds (for B33 being (FinSequence of ( REAL )) holds (B32 in ( dom B33 ) implies ( ( Product ( Del (B33 , B32) ) ) * ( B33 . B32 ) ) = ( Product B33 ))))
proof
let C38 being (Element of ( NAT ));
let C39 being (FinSequence of ( REAL ));
defpred S2[ Nat ] means ($1 in ( dom C39 ) implies ( ( C39 . $1 ) * ( Product ( Del (C39 , $1) ) ) ) = ( Product C39 ));
L502: (for B34 being (Element of ( NAT )) holds (S2[ B34 ] implies S2[ ( B34 + 1 ) ]))
proof
let C40 being (Element of ( NAT ));
assume that
L503: S2[ C40 ];
L504:
now
per cases ;
suppose L505: C40 = ( 0 );

thus L506: S2[ ( C40 + 1 ) ]
proof
assume L507: ( C40 + 1 ) in ( dom C39 );
L508: ( C40 + 1 ) <= ( len C39 ) by L507 , FINSEQ_3:25;
L509: ( <* ( C39 . 1 ) *> ^ ( Del (C39 , 1) ) ) = C39 by L508 , L505 , L463;
L510: ( Product C39 ) = ( ( Product <* ( C39 . 1 ) *> ) * ( Product ( Del (C39 , 1) ) ) ) by L509 , RVSUM_1:97
.= ( ( C39 . 1 ) * ( Product ( Del (C39 , 1) ) ) ) by RVSUM_1:95;
thus L511: thesis by L510 , L505;
end;

end;
suppose L507: (C40 > ( 0 ) & C40 < ( len C39 ));

L508: (( C40 + 1 ) >= 1 & ( C40 + 1 ) <= ( len C39 )) by L507 , NAT_1:11 , NAT_1:13;
L509: ( C40 + 1 ) in ( dom C39 ) by L508 , FINSEQ_3:25;
consider C41 , C42 being FinSequence such that L510: C39 = ( ( C41 ^ <* ( C39 . ( C40 + 1 ) ) *> ) ^ C42 ) and L511: ( len C41 ) = ( ( C40 + 1 ) - 1 ) and L512: ( len C42 ) = ( ( len C39 ) - ( C40 + 1 ) ) by L509 , L415;
L513: ( Del (C39 , ( C40 + 1 )) ) = ( C41 ^ C42 ) by L509 , L510 , L511 , L430;
reconsider D60 = C42 as (FinSequence of ( REAL )) by L510 , FINSEQ_1:36;
reconsider D61 = C41 as (FinSequence of ( REAL )) by L513 , FINSEQ_1:36;
L514: ( Product C39 ) = ( ( Product ( D61 ^ <* ( C39 . ( C40 + 1 ) ) *> ) ) * ( Product D60 ) ) by L510 , RVSUM_1:97
.= ( ( ( Product D61 ) * ( Product <* ( C39 . ( C40 + 1 ) ) *> ) ) * ( Product D60 ) ) by RVSUM_1:97
.= ( ( ( C39 . ( C40 + 1 ) ) * ( Product D61 ) ) * ( Product D60 ) ) by RVSUM_1:95
.= ( ( C39 . ( C40 + 1 ) ) * ( ( Product D61 ) * ( Product D60 ) ) );
thus L515: S2[ ( C40 + 1 ) ] by L514 , L513 , RVSUM_1:97;
end;
suppose L516: C40 >= ( len C39 );

L517: ( len C39 ) < ( C40 + 1 ) by L516 , NAT_1:13;
thus L518: S2[ ( C40 + 1 ) ] by L517 , FINSEQ_3:25;
end;
end;
thus L520: thesis by L504;
end;
L521: S2[ ( 0 ) ] by FINSEQ_3:25;
L522: (for B35 being (Element of ( NAT )) holds S2[ B35 ]) from NAT_1:sch 1(L521 , L502);
thus L523: thesis by L522;
end;
L524: (for R2 being Nat holds (( R2 + 2 ) is  prime implies (for R4 being Nat holds ((R4 in ( Seg R2 ) & R4 <> 1) implies (ex R1 being Nat st (R1 in ( Seg R2 ) & R1 <> 1 & R1 <> R4 & ( ( R4 * R1 ) mod ( R2 + 2 ) ) = 1))))))
proof
let R2 being Nat;
reconsider D62 = R2 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L525: ( R2 + 2 ) is  prime;
L526: 1 < ( D62 + 2 ) by L525 , INT_2:def 4;
let R4 being Nat;
reconsider D63 = R4 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L527: R4 in ( Seg R2 );
L528: D63 <> ( 0 ) by L527 , FINSEQ_1:1;
assume L529: R4 <> 1;
L530: R4 <= R2 by L527 , FINSEQ_1:1;
L531: R4 < ( R2 + 1 ) by L530 , NAT_1:13;
L532: ( 1 + R2 ) < ( 2 + R2 ) by XREAL_1:6;
L533: D63 < ( D62 + 2 ) by L532 , L531 , XXREAL_0:2;
consider C43 being (Element of ( NAT )) such that L534: ( ( C43 * D63 ) mod ( D62 + 2 ) ) = 1 and L535: C43 < ( D62 + 2 ) by L533 , L525 , L526 , L528 , IDEA_1:1;
take C43;
L536: C43 <> ( 0 ) by L534 , NAT_D:26;
L537: C43 >= ( ( 0 ) + 1 ) by L536 , NAT_1:13;
L538: 1 <= R4 by L527 , FINSEQ_1:1;
L539: ( 1 - 1 ) <= ( R4 - 1 ) by L538 , XREAL_1:9;
L540: R4 < ( R2 + 2 ) by L531 , L532 , XXREAL_0:2;
L541: ( R2 + 2 ) > 1 by L540 , L538 , XXREAL_0:2;
L542: ( R4 + 1 ) < ( ( R2 + 1 ) + 1 ) by L531 , XREAL_1:6;
L543: C43 <> ( R2 + 1 )
proof
assume L544: C43 = ( R2 + 1 );
L545: ( ( ( R2 + 1 ) * R4 ) mod ( R2 + 2 ) ) = ( 1 mod ( R2 + 2 ) ) by L544 , L534 , L541 , NAT_D:14
.= ( ( ( ( R2 + 2 ) * R4 ) + 1 ) mod ( R2 + 2 ) ) by NAT_D:21;
L546: ( 0 ) = ( ( ( ( ( R2 + 2 ) * R4 ) + 1 ) - ( ( R2 + 1 ) * R4 ) ) mod ( R2 + 2 ) ) by L545 , INT_4:22
.= ( R4 + 1 ) by L542 , NAT_D:24;
thus L547: contradiction by L546;
end;
L548: C43 < ( ( R2 + 1 ) + 1 ) by L535;
L549: C43 <= ( R2 + 1 ) by L548 , NAT_1:13;
L550: C43 < ( R2 + 1 ) by L549 , L543 , XXREAL_0:1;
L551: C43 <= R2 by L550 , NAT_1:13;
thus L552: C43 in ( Seg R2 ) by L551 , L537;
L553: ( R4 - 1 ) < ( ( R2 + 2 ) - 1 ) by L540 , XREAL_1:9;
L554: ( R4 - 1 ) < ( R2 + 2 ) by L553 , L532 , XXREAL_0:2;
L555: ( R4 -' 1 ) < ( R2 + 2 ) by L554 , XREAL_0:def 2;
thus L556: C43 <> 1
proof
assume L557: C43 = 1;
L558: ( ( 1 * R4 ) mod ( R2 + 2 ) ) = ( 1 mod ( R2 + 2 ) ) by L557 , L534 , L535 , NAT_D:14;
L559: ( 0 ) = ( ( R4 - 1 ) mod ( R2 + 2 ) ) by L558 , INT_4:22
.= ( ( R4 -' 1 ) mod ( R2 + 2 ) ) by L539 , XREAL_0:def 2
.= ( R4 -' 1 ) by L555 , NAT_D:24
.= ( R4 - 1 ) by L539 , XREAL_0:def 2;
thus L560: contradiction by L559 , L529;
end;

thus L561: C43 <> R4
proof
assume L562: C43 = R4;
L563: ( ( R4 * R4 ) mod ( R2 + 2 ) ) = ( 1 mod ( R2 + 2 ) ) by L562 , L534 , L541 , NAT_D:14;
L564: ( 0 ) = ( ( ( R4 * R4 ) - 1 ) mod ( R2 + 2 ) ) by L563 , INT_4:22;
L565: ( R2 + 2 ) divides ( ( R4 + 1 ) * ( R4 - 1 ) ) by L564 , INT_1:62;
per cases  by L525 , L565 , INT_5:7;
suppose L566: ( R2 + 2 ) divides ( R4 + 1 );

L567: ( R2 + 2 ) <= ( R4 + 1 ) by L566 , NAT_D:7;
L568: ( ( R2 + 2 ) - 1 ) <= ( ( R4 + 1 ) - 1 ) by L567 , XREAL_1:9;
thus L569: contradiction by L568 , L531;
end;
suppose L570: ( R2 + 2 ) divides ( R4 - 1 );

L571: ( R2 + 2 ) divides ( R4 -' 1 ) by L570 , L539 , XREAL_0:def 2;
per cases ;
suppose L572: R4 = 1;

thus L573: contradiction by L572 , L556 , L562;
end;
suppose L574: R4 <> 1;

L575: R4 > 1 by L574 , L538 , XXREAL_0:1;
L576: ( R4 - 1 ) > ( 1 - 1 ) by L575 , XREAL_1:9;
L577: ( R4 -' 1 ) > ( 0 ) by L576 , XREAL_0:def 2;
L578: ( R2 + 2 ) <= ( R4 -' 1 ) by L577 , L571 , NAT_D:7;
L579: ( R2 + 2 ) <= ( R4 - 1 ) by L578 , XREAL_0:def 2;
L580: ( ( R2 + 2 ) + 1 ) <= ( ( R4 - 1 ) + 1 ) by L579 , XREAL_1:6;
L581: ( R2 + 3 ) <= R2 by L580 , L530 , XXREAL_0:2;
L582: ( ( R2 + 3 ) - R2 ) <= ( R2 - R2 ) by L581 , XREAL_1:9;
L583: 3 <= ( 0 ) by L582;
thus L584: contradiction by L583;
end;
end;
end;

thus L587: ( ( R4 * C43 ) mod ( R2 + 2 ) ) = 1 by L534;
end;
L588: (for R2 being Nat holds (for B36 being (FinSequence of ( NAT )) holds ((( R2 + 2 ) is  prime & ( rng B36 ) c= ( Seg R2 ) & B36 is  one-to-one & (for R4 being Nat holds ((R4 in ( rng B36 ) & R4 <> 1) implies (ex R1 being Nat st (R1 in ( rng B36 ) & R1 <> 1 & R1 <> R4 & ( ( R4 * R1 ) mod ( R2 + 2 ) ) = 1))))) implies ( ( Product B36 ) mod ( R2 + 2 ) ) = 1)))
proof
let R2 being Nat;
defpred S3[ Nat ] means (for B37 being (FinSequence of ( NAT )) holds ((( len B37 ) = $1 & ( R2 + 2 ) is  prime & ( rng B37 ) c= ( Seg R2 ) & B37 is  one-to-one & (for R4 being Nat holds ((R4 in ( rng B37 ) & R4 <> 1) implies (ex R1 being Nat st (R1 in ( rng B37 ) & R1 <> 1 & R1 <> R4 & ( ( R4 * R1 ) mod ( R2 + 2 ) ) = 1))))) implies ( ( Product B37 ) mod ( R2 + 2 ) ) = 1));
let C44 being (FinSequence of ( NAT ));
set D64 = ( len C44 );
L589: (for B38 being Nat holds ((for B39 being Nat holds (B39 < B38 implies S3[ B39 ])) implies S3[ B38 ]))
proof
let C45 being Nat;
assume L590: (for B40 being Nat holds (B40 < C45 implies S3[ B40 ]));
thus L591: S3[ C45 ]
proof
let C46 being (FinSequence of ( NAT ));
assume L592: ( len C46 ) = C45;
assume L593: ( R2 + 2 ) is  prime;
assume L594: ( rng C46 ) c= ( Seg R2 );
assume L595: C46 is  one-to-one;
assume L596: (for R4 being Nat holds ((R4 in ( rng C46 ) & R4 <> 1) implies (ex R1 being Nat st (R1 in ( rng C46 ) & R1 <> 1 & R1 <> R4 & ( ( R4 * R1 ) mod ( R2 + 2 ) ) = 1))));
per cases ;
suppose L597: C45 = ( 0 );

L598: ( ( 0 ) + 1 ) < ( ( R2 + 1 ) + 1 ) by XREAL_1:6;
L599: C46 = ( <*> ( NAT ) ) by L592 , L597;
L600: ( Product C46 ) = 1 by L599 , RVSUM_1:94;
thus L601: ( ( Product C46 ) mod ( R2 + 2 ) ) = 1 by L600 , L598 , NAT_D:24;
end;
suppose L602: C45 <> ( 0 );

reconsider D65 = C46 as (FinSequence of ( REAL )) by FINSEQ_2:24;
L603: ( dom C46 ) <> ( {} ) by L592 , L602 , CARD_1:27 , RELAT_1:41;
consider C47 being set such that L604: C47 in ( dom C46 ) by L603 , XBOOLE_0:def 1;
reconsider D66 = C47 as (Element of ( NAT )) by L604;
L605: (ex B41 being Nat st (( len C46 ) = ( B41 + 1 ) & ( len ( Del (C46 , D66) ) ) = B41)) by L604 , FINSEQ_3:104;
L606: ( ( Product ( Del (D65 , D66) ) ) * ( D65 . D66 ) ) = ( Product C46 ) by L604 , L501;
L607: ( rng ( Del (C46 , D66) ) ) c= ( rng C46 ) by FINSEQ_3:106;
L608: ( rng ( Del (C46 , D66) ) ) c= ( Seg R2 ) by L607 , L594 , XBOOLE_1:1;
set D67 = ( len ( Del (C46 , D66) ) );
L609: ( ( 0 ) + D67 ) < ( 1 + D67 ) by XREAL_1:6;
L610: ( Del (C46 , D66) ) is  one-to-one by L595 , L93;
per cases ;
suppose L611: ( D65 . D66 ) = 1;

L612: (for R4 being Nat holds ((R4 in ( rng ( Del (C46 , D66) ) ) & R4 <> 1) implies (ex R1 being Nat st (R1 in ( rng ( Del (C46 , D66) ) ) & R1 <> 1 & R1 <> R4 & ( ( R4 * R1 ) mod ( R2 + 2 ) ) = 1))))
proof
let R4 being Nat;
assume L613: R4 in ( rng ( Del (C46 , D66) ) );
assume L614: R4 <> 1;
consider R1 being Nat such that L615: R1 in ( rng C46 ) and L616: R1 <> 1 and L617: (R1 <> R4 & ( ( R4 * R1 ) mod ( R2 + 2 ) ) = 1) by L614 , L596 , L607 , L613;
take R1;
thus L618: R1 in ( rng ( Del (C46 , D66) ) ) by L611 , L615 , L616 , L121;
thus L619: (R1 <> 1 & R1 <> R4 & ( ( R4 * R1 ) mod ( R2 + 2 ) ) = 1) by L616 , L617;
end;
thus L620: ( ( Product C46 ) mod ( R2 + 2 ) ) = 1 by L612 , L590 , L592 , L593 , L606 , L608 , L610 , L605 , L609 , L611;
end;
suppose L621: ( D65 . D66 ) <> 1;

set D68 = ( Del (C46 , D66) );
set D69 = ( C46 . D66 );
L622: D69 in ( rng C46 ) by L604 , FUNCT_1:3;
consider C48 being Nat such that L623: C48 in ( rng C46 ) and L624: C48 <> 1 and L625: C48 <> D69 and L626: ( ( D69 * C48 ) mod ( R2 + 2 ) ) = 1 by L622 , L596 , L621;
L627: C48 in ( rng D68 ) by L623 , L625 , L121;
consider C49 being set such that L628: C49 in ( dom D68 ) and L629: C48 = ( D68 . C49 ) by L627 , FUNCT_1:def 3;
reconsider D70 = C49 as (Element of ( NAT )) by L628;
L630: ( rng ( Del (D68 , D70) ) ) c= ( rng ( Del (D65 , D66) ) ) by FINSEQ_3:106;
L631: ( rng ( Del (D68 , D70) ) ) c= ( Seg R2 ) by L630 , L608 , XBOOLE_1:1;
L632: (for R4 being Nat holds ((R4 in ( rng ( Del (D68 , D70) ) ) & R4 <> 1) implies (ex R1 being Nat st (R1 in ( rng ( Del (D68 , D70) ) ) & R1 <> 1 & R1 <> R4 & ( ( R4 * R1 ) mod ( R2 + 2 ) ) = 1))))
proof
L633: 1 <= D69 by L594 , L622 , FINSEQ_1:1;
L634: ( ( 0 ) + R2 ) < ( 2 + R2 ) by XREAL_1:6;
L635: D69 <= R2 by L594 , L622 , FINSEQ_1:1;
L636: ( R2 + 2 ) > D69 by L635 , L634 , XXREAL_0:2;
L637: C48 <= R2 by L594 , L623 , FINSEQ_1:1;
L638: ( R2 + 2 ) > C48 by L637 , L634 , XXREAL_0:2;
let C50 being Nat;
L639: ( ( 0 ) + R2 ) < ( 2 + R2 ) by XREAL_1:6;
assume L640: C50 in ( rng ( Del (D68 , D70) ) );
L641: C50 in ( rng ( Del (D65 , D66) ) ) by L640 , L630;
L642: C50 in ( rng C46 ) by L641 , L607;
L643: C50 <= R2 by L642 , L594 , FINSEQ_1:1;
assume L644: C50 <> 1;
consider C51 being Nat such that L645: C51 in ( rng C46 ) and L646: (C51 <> 1 & C51 <> C50) and L647: ( ( C50 * C51 ) mod ( R2 + 2 ) ) = 1 by L644 , L596 , L607 , L641;
take C51;
L648: 1 <= C48 by L594 , L623 , FINSEQ_1:1;
thus L649: C51 in ( rng ( Del (D68 , D70) ) )
proof
assume L650: (not C51 in ( rng ( Del (D68 , D70) ) ));
per cases ;
suppose L651: C51 in ( rng D68 );

L652: C50 < ( R2 + 2 ) by L643 , L639 , XXREAL_0:2;
L653: ( ( C48 * D69 ) mod ( R2 + 2 ) ) = ( ( C48 * C50 ) mod ( R2 + 2 ) ) by L626 , L629 , L647 , L650 , L651 , L121;
L654: C50 = D69 by L653 , L593 , L648 , L638 , L636 , L652 , L366;
thus L655: contradiction by L654 , L595 , L604 , L630 , L640 , L98;
end;
suppose L656: (not C51 in ( rng D68 ));

L657: C50 < ( R2 + 2 ) by L643 , L639 , XXREAL_0:2;
L658: ( ( D69 * C48 ) mod ( R2 + 2 ) ) = ( ( D69 * C50 ) mod ( R2 + 2 ) ) by L626 , L645 , L647 , L656 , L121;
L659: ( D68 . D70 ) in ( rng ( Del (D68 , D70) ) ) by L658 , L593 , L629 , L640 , L633 , L638 , L636 , L657 , L366;
thus L660: contradiction by L659 , L595 , L628 , L93 , L98;
end;
end;

thus L662: (C51 <> 1 & C51 <> C50 & ( ( C50 * C51 ) mod ( R2 + 2 ) ) = 1) by L646 , L647;
end;
set D71 = ( len ( Del (D68 , D70) ) );
L663: ( ( 0 ) + D71 ) < ( 1 + D71 ) by XREAL_1:6;
L664: (ex B42 being Nat st (( len ( Del (D65 , D66) ) ) = ( B42 + 1 ) & ( len ( Del (D68 , D70) ) ) = B42)) by L628 , FINSEQ_3:104;
L665: D71 < C45 by L664 , L592 , L605 , L609 , L663 , XXREAL_0:2;
L666: ( Del (D68 , D70) ) is  one-to-one by L610 , L93;
L667: ( ( Product ( Del (D68 , D70) ) ) * ( D68 . D70 ) ) = ( Product D68 ) by L628 , L501;
L668: ( ( Product ( Del (D68 , D70) ) ) * ( C48 * D69 ) ) = ( Product C46 ) by L667 , L606 , L629;
thus L669: ( ( Product C46 ) mod ( R2 + 2 ) ) = ( ( ( Product ( Del (D68 , D70) ) ) * ( ( C48 * D69 ) mod ( R2 + 2 ) ) ) mod ( R2 + 2 ) ) by L668 , EULER_2:7
.= 1 by L590 , L593 , L626 , L631 , L666 , L632 , L665;
end;
end;
end;

end;
L592: (for B43 being Nat holds S3[ B43 ]) from NAT_1:sch 4(L589);
L593: S3[ D64 ] by L592;
thus L594: thesis by L593;
end;
begin
::$N Wilson's Theorem
theorem
L595: (for R2 being Nat holds (R2 is  prime iff (( ( ( ( R2 -' 1 ) ! ) + 1 ) mod R2 ) = ( 0 ) & R2 > 1)))
proof
let R2 being Nat;
thus L596: (R2 is  prime implies (( ( ( ( R2 -' 1 ) ! ) + 1 ) mod R2 ) = ( 0 ) & R2 > 1))
proof
assume L597: R2 is  prime;
per cases ;
suppose L598: R2 < 2;

L599: R2 < ( 1 + 1 ) by L598;
L600: R2 <= 1 by L599 , NAT_1:13;
thus L601: thesis by L600 , L597 , INT_2:def 4;
end;
suppose L602: R2 >= 2;

L603: ( R2 - 2 ) >= ( 2 - 2 ) by L602 , XREAL_1:9;
L604: ( ( R2 - 2 ) + 1 ) >= ( ( 0 ) + 1 ) by L603 , XREAL_1:6;
set D72 = ( R2 -' 2 );
L605: ( 2 + D72 ) > ( 1 + D72 ) by XREAL_1:6;
set D73 = ( Sgm ( Seg D72 ) );
L606: ( ( R2 * 1 ) mod R2 ) = ( 0 ) by NAT_D:13;
L607: D72 = ( R2 - 2 ) by L603 , XREAL_0:def 2;
L608: ( D72 + 1 ) = ( R2 - 1 ) by L607
.= ( R2 -' 1 ) by L604 , XREAL_0:def 2;
L609: (for B44 being Nat holds ((B44 in ( rng D73 ) & B44 <> 1) implies (ex B45 being Nat st (B45 in ( rng D73 ) & B45 <> 1 & B45 <> B44 & ( ( B44 * B45 ) mod ( D72 + 2 ) ) = 1))))
proof
let C52 being Nat;
assume L610: C52 in ( rng D73 );
L611: C52 in ( Seg D72 ) by L610 , FINSEQ_1:def 13;
assume L612: C52 <> 1;
consider C53 being Nat such that L613: (C53 in ( Seg D72 ) & C53 <> 1 & C53 <> C52 & ( ( C52 * C53 ) mod ( D72 + 2 ) ) = 1) by L612 , L597 , L607 , L611 , L524;
take C53;
thus L614: thesis by L613 , FINSEQ_1:def 13;
end;
L615: (( D72 ! ) = ( Product ( Sgm ( Seg D72 ) ) ) & ( rng D73 ) c= ( Seg D72 )) by FINSEQ_1:def 13 , FINSEQ_3:48;
L616: ( ( D72 ! ) mod ( D72 + 2 ) ) = 1 by L615 , L597 , L607 , L609 , L588 , FINSEQ_3:92;
L617: ( ( ( D72 + 1 ) ! ) mod ( D72 + 2 ) ) = ( ( ( D72 + 1 ) * ( D72 ! ) ) mod ( D72 + 2 ) ) by NEWTON:15
.= ( ( ( D72 + 1 ) * 1 ) mod ( D72 + 2 ) ) by L616 , EULER_2:7
.= ( D72 + 1 ) by L605 , NAT_D:24;
L618: ( ( ( ( ( D72 + 1 ) ! ) mod ( D72 + 2 ) ) + 1 ) mod ( D72 + 2 ) ) = ( 0 ) by L617 , L607 , L606;
thus L619: thesis by L618 , L597 , L607 , L608 , INT_2:def 4 , NAT_D:22;
end;
end;

thus L621: ((( ( ( ( R2 -' 1 ) ! ) + 1 ) mod R2 ) = ( 0 ) & R2 > 1) implies R2 is  prime)
proof
assume that
L622: ( ( ( ( R2 -' 1 ) ! ) + 1 ) mod R2 ) = ( 0 )
and
L623: R2 > 1;
L624: R2 >= ( 1 + 1 ) by L623 , NAT_1:13;
consider C54 being (Element of ( NAT )) such that L625: C54 is  prime and L626: C54 divides R2 by L624 , INT_2:31;
consider C55 being Nat such that L627: R2 = ( C54 * C55 ) by L626 , NAT_D:def 3;
L628: C54 <> 1 by L625 , INT_2:def 4;
L629: ( ( ( ( R2 -' 1 ) ! ) + 1 ) mod R2 ) = ( ( ( ( R2 -' 1 ) ! ) + 1 ) mod C54 ) by L622 , L623 , L625 , L627 , PEPIN:9;
L630: C54 divides ( ( ( R2 -' 1 ) ! ) + 1 ) by L629 , L622 , L625 , PEPIN:6;
L631: C54 > ( R2 -' 1 ) by L630 , L625 , L628 , NEWTON:42;
L632: C54 > ( R2 - 1 ) by L631 , XREAL_0:def 2;
L633: ( C54 + 1 ) > ( ( R2 - 1 ) + 1 ) by L632 , XREAL_1:6;
L634: C54 >= R2 by L633 , NAT_1:13;
L635: ( C54 / C54 ) >= ( ( C54 * C55 ) / C54 ) by L634 , L627 , XREAL_1:72;
L636: 1 >= ( ( C54 * C55 ) / C54 ) by L635 , L625 , XCMPLX_1:60;
L637: 1 >= ( C55 * ( C54 / C54 ) ) by L636 , XCMPLX_1:74;
L638: 1 >= ( C55 * 1 ) by L637 , L625 , XCMPLX_1:60;
assume L639: (not R2 is  prime);
L640: C55 <> ( 0 ) by L623 , L627;
L641: C55 >= ( ( 0 ) + 1 ) by L640 , NAT_1:13;
L642: C55 = 1 by L641 , L638 , XXREAL_0:1;
thus L643: contradiction by L642 , L639 , L625 , L627;
end;

end;
begin
::$N All Primes (1 mod 4) Equal the Sum of Two Squares
theorem
L622: (for R5 being Nat holds ((R5 is  prime & ( R5 mod 4 ) = 1) implies (ex R2 being Nat st (ex R3 being Nat st R5 = ( ( R2 ^2 ) + ( R3 ^2 ) )))))
proof
let R5 being Nat;
L623: ( 0 ) <= ( sqrt R5 ) by SQUARE_1:def 2;
reconsider D74 = [\ ( sqrt R5 ) /] as (Element of ( NAT )) by L623 , INT_1:3 , INT_1:54;
reconsider D75 = ( D74 + 1 ) as (Element of ( NAT ));
set D76 = ( Segm D75 );
L624: ( card D76 ) = ( card D75 ) by CARD_1:def 6
.= ( 1 + [\ ( sqrt R5 ) /] ) by CARD_1:def 2;
L625: ( ( sqrt R5 ) * ( card D76 ) ) < ( ( card D76 ) * ( card D76 ) ) by L624 , INT_1:29 , XREAL_1:68;
assume L626: R5 is  prime;
L627: R5 > 1 by L626 , INT_2:def 4;
L628: ( R5 + 1 ) > ( 1 + 1 ) by L627 , XREAL_1:6;
L629: R5 >= 2 by L628 , NAT_1:13;
L630: ( D74 ^2 ) <> R5
proof
assume L631: ( D74 ^2 ) = R5;
reconsider D77 = ( sqrt R5 ) as (Element of ( NAT )) by L631 , SQUARE_1:def 2;
L632: ( D77 ^2 ) = R5 by SQUARE_1:def 2;
L633: ( D77 * D77 ) = R5 by L632 , SQUARE_1:def 1;
L634: D77 divides R5 by L633 , INT_1:def 3;
per cases  by L626 , L634 , INT_2:def 4;
suppose L635: D77 = 1;

thus L636: contradiction by L635 , L626 , L633 , INT_2:def 4;
end;
suppose L637: D77 = R5;

L638: 1 = ( ( R5 * R5 ) / R5 ) by L637 , L626 , L633 , XCMPLX_1:60
.= ( R5 * ( R5 / R5 ) ) by XCMPLX_1:74
.= ( R5 * 1 ) by L626 , XCMPLX_1:60;
thus L639: contradiction by L638 , L626 , INT_2:def 4;
end;
end;
L641: D74 <= ( sqrt R5 ) by INT_1:def 6;
L642: ( D74 ^2 ) <= ( ( sqrt R5 ) ^2 ) by L641 , SQUARE_1:15;
L643: ( D74 ^2 ) <= R5 by L642 , SQUARE_1:def 2;
L644: ( D74 ^2 ) < R5 by L643 , L630 , XXREAL_0:1;
assume L645: ( R5 mod 4 ) = 1;
L646: R5 <> 2 by L645 , NAT_D:24;
L647: R5 > 2 by L646 , L629 , XXREAL_0:1;
L648: ( - 1 ) is_quadratic_residue_mod R5 by L647 , L626 , L645 , INT_5:37;
consider C56 being Integer such that L649: ( ( ( C56 ^2 ) - ( - 1 ) ) mod R5 ) = ( 0 ) by L648 , INT_5:def 2;
L650: ( 0 ) < ( sqrt R5 ) by L626 , SQUARE_1:25;
L651: ( ( sqrt R5 ) * ( sqrt R5 ) ) < ( ( card D76 ) * ( sqrt R5 ) ) by L650 , L624 , INT_1:29 , XREAL_1:68;
L652: ( ( sqrt R5 ) * ( sqrt R5 ) ) < ( ( card D76 ) * ( card D76 ) ) by L651 , L625 , XXREAL_0:2;
L653: ( sqrt ( R5 * R5 ) ) < ( ( card D76 ) * ( card D76 ) ) by L652 , SQUARE_1:29;
L654: ( sqrt ( R5 ^2 ) ) < ( ( card D76 ) * ( card D76 ) ) by L653 , SQUARE_1:def 1;
L655: R5 < ( ( card D76 ) * ( card D76 ) ) by L654 , SQUARE_1:22;
L656: R5 < ( card [: D76 , D76 :] ) by L655 , CARD_2:46;
L657: (for B46 being  integer number holds (ex B47 , B48 , B49 , B50 being Nat st (B47 in D76 & B48 in D76 & B49 in D76 & B50 in D76 & [ B47 , B49 ] <> [ B48 , B50 ] & ( ( B47 - ( B46 * B49 ) ) mod R5 ) = ( ( B48 - ( B46 * B50 ) ) mod R5 ))))
proof
set D78 = [: D76 , D76 :];
reconsider D79 = R5 as (Element of ( NAT )) by ORDINAL1:def 12;
let C57 being  integer number;
set D80 = ( Segm D79 );
defpred S4[ set , set ] means (ex B51 , B52 , B53 being (Element of ( NAT )) st ($1 = [ B51 , B52 ] & $2 = B53 & ( ( B51 - ( C57 * B52 ) ) mod R5 ) = B53));
L658: ( card D80 ) = ( card D79 ) by CARD_1:def 6
.= R5 by CARD_1:def 2;
L659: ( card D80 ) in ( card D78 ) by L658 , L656 , NAT_1:44;
L660: (for B54 being set holds (B54 in D78 implies (ex B55 being set st (B55 in D80 & S4[ B54 , B55 ]))))
proof
let C58 being set;
assume L661: C58 in D78;
consider C59 , C60 being set such that L662: (C59 in D76 & C60 in D76) and L663: C58 = [ C59 , C60 ] by L661 , ZFMISC_1:def 2;
reconsider D81 = C59 , D82 = C60 as (Element of ( NAT )) by L662;
set D83 = ( ( D81 - ( C57 * D82 ) ) mod R5 );
reconsider D84 = D83 as (Element of ( NAT )) by INT_1:3 , INT_1:57;
take D84;
L664: D84 < R5 by L626 , INT_1:58;
L665: D84 in R5 by L664 , NAT_1:44;
thus L666: D84 in D80 by L665 , CARD_1:def 6;
thus L667: S4[ C58 , D84 ] by L663;
end;
consider C61 being (Function of D78 , D80) such that L668: (for B56 being set holds (B56 in D78 implies S4[ B56 , ( C61 . B56 ) ])) from FUNCT_2:sch 1(L660);
L669: D80 <> ( {} ) by L626 , ALGSEQ_1:1;
consider C62 , C63 being set such that L670: C62 in D78 and L671: C63 in D78 and L672: C62 <> C63 and L673: ( C61 . C62 ) = ( C61 . C63 ) by L669 , L659 , FINSEQ_4:65;
consider C64 , C65 being set such that L674: (C64 in D76 & C65 in D76) and L675: C62 = [ C64 , C65 ] by L670 , ZFMISC_1:def 2;
reconsider D85 = C64 , D86 = C65 as Nat by L674;
consider C66 , C67 being set such that L676: (C66 in D76 & C67 in D76) and L677: C63 = [ C66 , C67 ] by L671 , ZFMISC_1:def 2;
reconsider D87 = C66 , D88 = C67 as Nat by L676;
take D85;
take D87;
take D86;
take D88;
thus L678: (D85 in D76 & D87 in D76 & D86 in D76 & D88 in D76) by L674 , L676;
thus L679: [ D85 , D86 ] <> [ D87 , D88 ] by L672 , L675 , L677;
consider C68 , C69 , C70 being (Element of ( NAT )) such that L680: C62 = [ C68 , C69 ] and L681: (( C61 . C62 ) = C70 & ( ( C68 - ( C57 * C69 ) ) mod R5 ) = C70) by L668 , L670;
L682: (C68 = D85 & C69 = D86) by L675 , L680 , XTUPLE_0:1;
consider C71 , C72 , C73 being (Element of ( NAT )) such that L683: C63 = [ C71 , C72 ] and L684: (( C61 . C63 ) = C73 & ( ( C71 - ( C57 * C72 ) ) mod R5 ) = C73) by L668 , L671;
L685: C71 = D87 by L677 , L683 , XTUPLE_0:1;
thus L686: ( ( D85 - ( C57 * D86 ) ) mod R5 ) = ( ( D87 - ( C57 * D88 ) ) mod R5 ) by L685 , L673 , L677 , L681 , L683 , L684 , L682 , XTUPLE_0:1;
end;
consider C74 , C75 , C76 , C77 being Nat such that L687: C74 in D76 and L688: C75 in D76 and L689: C76 in D76 and L690: C77 in D76 and L691: [ C74 , C76 ] <> [ C75 , C77 ] and L692: ( ( C74 - ( C56 * C76 ) ) mod R5 ) = ( ( C75 - ( C56 * C77 ) ) mod R5 ) by L657;
set D89 = ( C76 - C77 );
L693: ( 0 ) = ( ( ( ( ( C56 ^2 ) + 1 ) mod R5 ) * ( ( D89 ^2 ) mod R5 ) ) mod R5 ) by L649 , INT_4:12
.= ( ( ( ( C56 ^2 ) + 1 ) * ( D89 ^2 ) ) mod R5 ) by NAT_D:67
.= ( ( ( ( C56 ^2 ) * ( D89 ^2 ) ) + ( D89 ^2 ) ) mod R5 )
.= ( ( ( ( C56 * D89 ) ^2 ) + ( D89 ^2 ) ) mod R5 ) by SQUARE_1:9;
set D90 = ( C74 - C75 );
L694: ( ( D90 + ( C56 * D89 ) ) * ( D90 - ( C56 * D89 ) ) ) = ( ( D90 to_power 2 ) - ( ( C56 * D89 ) to_power 2 ) ) by FIB_NUM3:7
.= ( ( D90 ^2 ) - ( ( C56 * D89 ) to_power 2 ) ) by POWER:46
.= ( ( D90 ^2 ) - ( ( C56 * D89 ) ^2 ) ) by POWER:46;
L695: ( ( ( C74 - ( C56 * C76 ) ) mod R5 ) - ( ( C75 - ( C56 * C77 ) ) mod R5 ) ) = ( 0 ) by L692;
L696: ( ( ( C74 - ( C56 * C76 ) ) - ( C75 - ( C56 * C77 ) ) ) mod R5 ) = ( ( 0 ) mod R5 ) by L695 , INT_6:7;
L697: ( ( ( C74 - C75 ) - ( C56 * ( C76 - C77 ) ) ) mod R5 ) = ( 0 ) by L696 , INT_4:12;
L698: ( 0 ) = ( ( ( ( D90 + ( C56 * D89 ) ) mod R5 ) * ( ( D90 - ( C56 * D89 ) ) mod R5 ) ) mod R5 ) by L697 , INT_4:12
.= ( ( ( D90 ^2 ) - ( ( C56 * D89 ) ^2 ) ) mod R5 ) by L694 , NAT_D:67;
L699: ( 0 ) = ( ( ( ( ( D90 ^2 ) - ( ( C56 * D89 ) ^2 ) ) mod R5 ) + ( ( ( ( C56 * D89 ) ^2 ) + ( D89 ^2 ) ) mod R5 ) ) mod R5 ) by L698 , L693 , INT_4:12
.= ( ( ( ( D90 ^2 ) - ( ( C56 * D89 ) ^2 ) ) + ( ( ( C56 * D89 ) ^2 ) + ( D89 ^2 ) ) ) mod R5 ) by NAT_D:66
.= ( ( ( D90 ^2 ) + ( D89 ^2 ) ) mod R5 );
L700: R5 divides ( ( D90 ^2 ) + ( D89 ^2 ) ) by L699 , L626 , INT_1:62;
consider C78 being Integer such that L701: ( ( D90 ^2 ) + ( D89 ^2 ) ) = ( R5 * C78 ) by L700 , INT_1:def 3;
L702: ( R5 * C78 ) = ( ( |. D90 .| ^2 ) + ( D89 ^2 ) ) by L701 , COMPLEX1:75
.= ( ( ( abs D90 ) ^2 ) + ( ( abs D89 ) ^2 ) ) by COMPLEX1:75;
L703: C76 in D75 by L689 , CARD_1:def 6;
L704: C76 < D75 by L703 , NAT_1:44;
L705: C76 <= D74 by L704 , NAT_1:13;
L706: C75 in D75 by L688 , CARD_1:def 6;
L707: C75 < D75 by L706 , NAT_1:44;
L708: C75 <= D74 by L707 , NAT_1:13;
L709: C77 in D75 by L690 , CARD_1:def 6;
L710: C77 < D75 by L709 , NAT_1:44;
L711: C77 <= D74 by L710 , NAT_1:13;
L712: C74 in D75 by L687 , CARD_1:def 6;
L713: C74 < D75 by L712 , NAT_1:44;
L714: C74 <= D74 by L713 , NAT_1:13;
set D91 = ( abs D89 );
L715: (C76 in ( NAT ) & C77 in ( NAT )) by ORDINAL1:def 12;
set D92 = ( abs D90 );
L716: (C74 in ( NAT ) & C75 in ( NAT )) by ORDINAL1:def 12;
reconsider D93 = C74 , D94 = C75 , D95 = C76 , D96 = C77 as Real by L716 , L715;
L717: ( abs ( D95 - D96 ) ) <= ( D74 - ( 0 ) ) by L705 , L711 , JGRAPH_1:27;
L718: ( D91 ^2 ) <= ( D74 ^2 ) by L717 , SQUARE_1:15;
L719: ( D91 ^2 ) < R5 by L718 , L644 , XXREAL_0:2;
L720: ( abs ( D93 - D94 ) ) <= ( D74 - ( 0 ) ) by L714 , L708 , JGRAPH_1:27;
L721: ( D92 ^2 ) <= ( D74 ^2 ) by L720 , SQUARE_1:15;
L722: ( D92 ^2 ) < R5 by L721 , L644 , XXREAL_0:2;
L723: ( ( D92 ^2 ) + ( D91 ^2 ) ) < ( R5 + R5 ) by L722 , L719 , XREAL_1:8;
L724: ( ( C78 * R5 ) / R5 ) < ( ( 2 * R5 ) / R5 ) by L723 , L626 , L702 , XREAL_1:74;
L725: ( ( C78 * R5 ) / R5 ) < ( 2 * ( R5 / R5 ) ) by L724 , XCMPLX_1:74;
L726: ( C78 * ( R5 / R5 ) ) < ( 2 * ( R5 / R5 ) ) by L725 , XCMPLX_1:74;
L727: ( C78 * ( R5 / R5 ) ) < ( 2 * 1 ) by L726 , L626 , XCMPLX_1:60;
L728: ( C78 * 1 ) < 2 by L727 , L626 , XCMPLX_1:60;
L729: ( C78 + 1 ) <= 2 by L728 , INT_1:7;
L730: ( ( C78 + 1 ) - 1 ) <= ( 2 - 1 ) by L729 , XREAL_1:9;
take D92;
take D91;
L731: ( ( D92 ^2 ) + ( D91 ^2 ) ) <> ( 0 )
proof
assume L732: ( ( D92 ^2 ) + ( D91 ^2 ) ) = ( 0 );
L733: ( D91 ^2 ) = ( 0 ) by L732;
L734: ( D91 * D91 ) = ( 0 ) by L733 , SQUARE_1:def 1;
L735: D91 = ( 0 ) by L734;
L736: ( D95 - D96 ) = ( 0 ) by L735 , ABSVALUE:2;
L737: ( D92 ^2 ) = ( 0 ) by L732;
L738: ( D92 * D92 ) = ( 0 ) by L737 , SQUARE_1:def 1;
L739: D92 = ( 0 ) by L738;
L740: ( D93 - D94 ) = ( 0 ) by L739 , ABSVALUE:2;
thus L741: contradiction by L740 , L691 , L736;
end;
L742: C78 > ( 0 ) by L731 , L702;
L743: C78 >= ( ( 0 ) + 1 ) by L742 , INT_1:7;
L744: C78 = 1 by L743 , L730 , XXREAL_0:1;
thus L745: R5 = ( ( D92 ^2 ) + ( D91 ^2 ) ) by L744 , L702;
end;
begin
definition
let C79 being set;
let C80 being (Function of C79 , ( NAT ));
let C81 being  finite (Subset of C79);
redefine func C80 | C81 -> (bag of C81);

correctness;
end;
registration
let C82 being set;
let C83 being (Function of C82 , ( NAT ));
let C84 being  finite (Subset of C82);
cluster ( Sum ( C83 | C84 ) ) ->  natural for number;
correctness
proof
set D97 = ( C83 | C84 );
consider C85 being (FinSequence of ( REAL )) such that L747: ( Sum D97 ) = ( Sum C85 ) and L748: C85 = ( D97 * ( canFS ( support D97 ) ) ) by UPROOTS:def 3;
L749: ( rng C85 ) c= ( NAT )
proof
let C86 being set;
assume L750: C86 in ( rng C85 );
thus L751: C86 in ( NAT ) by L750 , L748 , ORDINAL1:def 12;
end;
reconsider D98 = C85 as (FinSequence of ( NAT )) by L749 , FINSEQ_1:def 4;
L752: ( Sum D98 ) is (Element of ( NAT ));
thus L753: thesis by L752 , L747;
end;
end;
theorem
L755: (for B57 being (Function of ( NAT ) , ( NAT )) holds (for B58 being (Function of ( NAT ) , ( REAL )) holds (for B59 being  finite (Subset of ( NAT )) holds ((B57 = B58 & (ex R1 being Nat st B59 c= ( Seg R1 ))) implies ( Sum ( B57 | B59 ) ) = ( Sum ( Func_Seq (B58 , ( Sgm B59 )) ) )))))
proof
let C87 being (Function of ( NAT ) , ( NAT ));
let C88 being (Function of ( NAT ) , ( REAL ));
let C89 being  finite (Subset of ( NAT ));
assume L756: C87 = C88;
reconsider D99 = C89 as  finite (Subset of C89) by ZFMISC_1:def 1;
assume L757: (ex R1 being Nat st C89 c= ( Seg R1 ));
reconsider D100 = ( C87 | D99 ) as (bag of C89);
L758: ( dom C87 ) = ( NAT ) by FUNCT_2:def 1;
L759: C89 = ( dom ( C87 | D99 ) ) by L758 , RELAT_1:62;
L760: ( support D100 ) c= D99 by L759 , PRE_POLY:37;
consider C90 being (FinSequence of ( REAL )) such that L761: C90 = ( D100 * ( canFS D99 ) ) and L762: ( Sum D100 ) = ( Sum C90 ) by L760 , UPROOTS:14;
L763: ( rng ( canFS C89 ) ) = C89 by FUNCT_2:def 3
.= ( dom D100 ) by L758 , RELAT_1:62;
L764: ( dom ( canFS C89 ) ) = ( dom C90 ) by L763 , L761 , RELAT_1:27;
L765: C90 , D100 are_fiberwise_equipotent  by L764 , L761 , L763 , CLASSES1:77;
L766: ( Sgm C89 ) is  one-to-one by L757 , FINSEQ_3:92;
L767: ( rng ( Sgm C89 ) ) = C89 by L757 , FINSEQ_1:def 13;
L768: ( C87 * ( Sgm C89 ) ) = ( C87 * ( C89 |` ( Sgm C89 ) ) ) by L767 , RELAT_1:94
.= ( ( C87 | C89 ) * ( Sgm C89 ) ) by MONOID_1:1;
L769: ( rng ( Sgm C89 ) ) = ( dom ( C87 | C89 ) ) by L757 , L759 , FINSEQ_1:def 13;
L770: ( dom ( Sgm C89 ) ) = ( dom ( ( C87 | C89 ) * ( Sgm C89 ) ) ) by L769 , RELAT_1:27;
L771: ( ( C87 | C89 ) * ( Sgm C89 ) ) , ( C87 | C89 ) are_fiberwise_equipotent  by L770 , L769 , L766 , CLASSES1:77;
L772: ( Func_Seq (C88 , ( Sgm C89 )) ) , ( C87 | C89 ) are_fiberwise_equipotent  by L771 , L756 , L768 , BHSP_5:def 4;
thus L773: ( Sum ( C87 | C89 ) ) = ( Sum ( Func_Seq (C88 , ( Sgm C89 )) ) ) by L772 , L762 , L765 , CLASSES1:76 , RFINSEQ:9;
end;
theorem
L774: (for B60 being non  empty set holds (for B61 being (PartFunc of B60 , ( REAL )) holds (for B62 being (Function of B60 , ( NAT )) holds (for B63 being  finite (Subset of B60) holds (B62 = B61 implies ( Sum ( B62 | B63 ) ) = ( Sum (B61 , B63) ))))))
proof
let C91 being non  empty set;
let C92 being (PartFunc of C91 , ( REAL ));
let C93 being (Function of C91 , ( NAT ));
let C94 being  finite (Subset of C91);
reconsider D101 = C94 as  finite (Subset of C94) by ZFMISC_1:def 1;
reconsider D102 = ( C93 | D101 ) as (bag of C94);
L775: ( dom ( C92 | C94 ) ) is  finite;
assume L776: C93 = C92;
L777: ( C93 | C94 ) , ( FinS (C92 , C94) ) are_fiberwise_equipotent  by L776 , L775 , RFUNCT_3:def 13;
L778: ( dom C93 ) = C91 by FUNCT_2:def 1;
L779: C94 = ( dom ( C93 | D101 ) ) by L778 , RELAT_1:62;
L780: ( support D102 ) c= D101 by L779 , PRE_POLY:37;
consider C95 being (FinSequence of ( REAL )) such that L781: C95 = ( D102 * ( canFS D101 ) ) and L782: ( Sum D102 ) = ( Sum C95 ) by L780 , UPROOTS:14;
L783: ( rng ( canFS C94 ) ) = C94 by FUNCT_2:def 3
.= ( dom D102 ) by L778 , RELAT_1:62;
L784: ( dom ( canFS C94 ) ) = ( dom C95 ) by L783 , L781 , RELAT_1:27;
L785: C95 , D102 are_fiberwise_equipotent  by L784 , L781 , L783 , CLASSES1:77;
L786: ( Sum C95 ) = ( Sum ( FinS (C92 , C94) ) ) by L785 , L777 , CLASSES1:76 , RFINSEQ:9;
thus L787: ( Sum ( C93 | C94 ) ) = ( Sum (C92 , C94) ) by L786 , L782 , RFUNCT_3:def 14;
end;
theorem
L788: (for R19 being set holds (for R21 being (Function of R19 , ( NAT )) holds (for R23 being  finite (Subset of R19) holds (for R24 being  finite (Subset of R19) holds (R23 misses R24 implies ( Sum ( R21 | ( R23 \/ R24 ) ) ) = ( ( Sum ( R21 | R23 ) ) + ( Sum ( R21 | R24 ) ) ))))))
proof
let R19 being set;
let R21 being (Function of R19 , ( NAT ));
let R23 being  finite (Subset of R19);
let R24 being  finite (Subset of R19);
assume L789: R23 misses R24;
per cases ;
suppose L790: R19 is  empty;

set D103 = ( EmptyBag ( {} ) );
L791: ( Sum D103 ) = ( 0 ) by UPROOTS:11;
L792: (R23 = ( {} ) & ( R21 | R23 ) = ( {} )) by L790;
thus L793: ( Sum ( R21 | ( R23 \/ R24 ) ) ) = ( ( Sum ( R21 | R23 ) ) + ( Sum ( R21 | R24 ) ) ) by L792 , L791;
end;
suppose L794: R19 is non  empty;

reconsider D104 = R19 as non  empty set by L794;
L795: [: D104 , ( NAT ) :] c= [: D104 , ( REAL ) :] by ZFMISC_1:95;
reconsider D105 = R21 as (PartFunc of D104 , ( REAL )) by L795 , XBOOLE_1:1;
L796: ( dom ( D105 | ( R23 \/ R24 ) ) ) is  finite;
thus L797: ( Sum ( R21 | ( R23 \/ R24 ) ) ) = ( Sum (D105 , ( R23 \/ R24 )) ) by L774
.= ( ( Sum (D105 , R23) ) + ( Sum (D105 , R24) ) ) by L789 , L796 , RFUNCT_3:83
.= ( ( Sum ( R21 | R23 ) ) + ( Sum (D105 , R24) ) ) by L774
.= ( ( Sum ( R21 | R23 ) ) + ( Sum ( R21 | R24 ) ) ) by L774;
end;
end;
theorem
L799: (for R19 being set holds (for R20 being set holds (for R21 being (Function of R19 , ( NAT )) holds (for R23 being  finite (Subset of R19) holds (R23 = { R20 } implies ( Sum ( R21 | R23 ) ) = ( R21 . R20 ))))))
proof
let R19 being set;
let R20 being set;
let R21 being (Function of R19 , ( NAT ));
let R23 being  finite (Subset of R19);
consider C96 being (FinSequence of ( REAL )) such that L800: ( Sum ( R21 | R23 ) ) = ( Sum C96 ) and L801: C96 = ( ( R21 | R23 ) * ( canFS ( support ( R21 | R23 ) ) ) ) by UPROOTS:def 3;
assume L802: R23 = { R20 };
L803: R20 in R23 by L802 , TARSKI:def 1;
L804: R20 in R19 by L803;
L805: R20 in ( dom R21 ) by L804 , FUNCT_2:def 1;
L806: R23 c= ( dom R21 ) by L805 , L802 , ZFMISC_1:31;
L807: ( dom ( R21 | R23 ) ) = R23 by L806 , RELAT_1:62;
L808: ( support ( R21 | R23 ) ) c= R23 by L807 , PRE_POLY:37;
per cases  by L802 , L808 , ZFMISC_1:33;
suppose L809: ( support ( R21 | R23 ) ) = ( {} );

L810:
now
assume L811: ( R21 . R20 ) <> ( 0 );
L812: ( ( R21 | R23 ) . R20 ) <> ( 0 ) by L811 , L803 , FUNCT_1:49;
thus L813: contradiction by L812 , L809 , PRE_POLY:def 7;
end;
thus L814: ( Sum ( R21 | R23 ) ) = ( R21 . R20 ) by L810 , L800 , L801 , L809 , RVSUM_1:72;
end;
suppose L815: ( support ( R21 | R23 ) ) = R23;

L816: ( canFS ( support ( R21 | R23 ) ) ) = <* R20 *> by L815 , L802 , UPROOTS:4;
L817: C96 = <* ( ( R21 | R23 ) . R20 ) *> by L816 , L803 , L807 , L801 , FINSEQ_2:34;
L818: C96 = <* ( R21 . R20 ) *> by L817 , L803 , FUNCT_1:49;
thus L819: ( Sum ( R21 | R23 ) ) = ( R21 . R20 ) by L818 , L800 , RVSUM_1:73;
end;
end;
L821: (for R19 being set holds (for R20 being set holds (for R21 being (Function of R19 , ( NAT )) holds (for R22 being (Function of R19 , ( NAT )) holds (for R23 being  finite (Subset of R19) holds (for R24 being  finite (Subset of R19) holds (R23 = { R20 } implies ( Sum ( ( ( multnat ) * [: R21 , R22 :] ) | [: R23 , R24 :] ) ) = ( ( R21 . R20 ) * ( Sum ( R22 | R24 ) ) ))))))))
proof
let R19 being set;
let R20 being set;
let R21 being (Function of R19 , ( NAT ));
let R22 being (Function of R19 , ( NAT ));
let R23 being  finite (Subset of R19);
let R24 being  finite (Subset of R19);
defpred S5[ Nat ] means (for B64 , B65 being set holds (for B66 , B67 being (Function of B64 , ( NAT )) holds (for B68 , B69 being  finite (Subset of B64) holds ((B68 = { B65 } & $1 = ( card B69 )) implies ( Sum ( ( ( multnat ) * [: B66 , B67 :] ) | [: B68 , B69 :] ) ) = ( ( B66 . B65 ) * ( Sum ( B67 | B69 ) ) )))));
L822: (for B70 being Nat holds ((for B71 being Nat holds (B71 < B70 implies S5[ B71 ])) implies S5[ B70 ]))
proof
let C97 being Nat;
assume L823: (for B72 being Nat holds (B72 < C97 implies S5[ B72 ]));
thus L824: S5[ C97 ]
proof
L825: (C97 = ( 0 ) or ( C97 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:8;
L826: (C97 = ( 0 ) or C97 >= 1) by L825 , NAT_1:13;
let C98 , C99 being set;
let C100 , C101 being (Function of C98 , ( NAT ));
let C102 , C103 being  finite (Subset of C98);
assume L827: C102 = { C99 };
assume L828: C97 = ( card C103 );
per cases  by L826 , XXREAL_0:1;
suppose L829: C97 = ( 0 );

set D106 = ( EmptyBag ( {} ) );
L830: ( Sum D106 ) = ( 0 ) by UPROOTS:11;
L831: C103 = ( {} ) by L828 , L829;
L832: (( C101 | C103 ) = ( {} ) & [: C102 , C103 :] = ( {} )) by L831;
thus L833: ( Sum ( ( ( multnat ) * [: C100 , C101 :] ) | [: C102 , C103 :] ) ) = ( ( C100 . C99 ) * ( Sum ( C101 | C103 ) ) ) by L832 , L831 , L830;
end;
suppose L834: C97 = 1;

set D107 = the set;
L835: ( card { D107 } ) = ( card C103 ) by L828 , L834 , CARD_1:30;
consider C104 being set such that L836: C103 = { C104 } by L835 , CARD_1:29;
set D108 = ( ( ( multnat ) * [: C100 , C101 :] ) | [: C102 , C103 :] );
consider C105 being (FinSequence of ( REAL )) such that L837: ( Sum D108 ) = ( Sum C105 ) and L838: C105 = ( D108 * ( canFS ( support D108 ) ) ) by UPROOTS:def 3;
L839: [: C102 , C103 :] = { [ C99 , C104 ] } by L827 , L836 , ZFMISC_1:29;
L840: [ C99 , C104 ] in [: C102 , C103 :] by L839 , TARSKI:def 1;
L841: [ C99 , C104 ] in [: C98 , C98 :] by L840;
L842: [ C99 , C104 ] in ( dom ( ( multnat ) * [: C100 , C101 :] ) ) by L841 , FUNCT_2:def 1;
L843: [: C102 , C103 :] c= ( dom ( ( multnat ) * [: C100 , C101 :] ) ) by L842 , L839 , ZFMISC_1:31;
L844: ( dom D108 ) = [: C102 , C103 :] by L843 , RELAT_1:62;
L845: ( support D108 ) c= [: C102 , C103 :] by L844 , PRE_POLY:37;
L846: ( Sum D108 ) = ( ( C100 . C99 ) * ( C101 . C104 ) )
proof
reconsider D109 = C98 as non  empty set by L827;
reconsider D110 = C99 , D111 = C104 as (Element of D109) by L827 , L836 , ZFMISC_1:31;
set D112 = ( C100 . C99 );
set D113 = ( C101 . C104 );
L847: ( ( C100 . C99 ) * ( C101 . C104 ) ) = ( ( multnat ) . (D112 , D113) ) by BINOP_2:def 24
.= ( ( multnat ) . [ ( C100 . D110 ) , ( C101 . D111 ) ] ) by BINOP_1:def 1
.= ( ( multnat ) . ( [: C100 , C101 :] . (D110 , D111) ) ) by FUNCT_3:75
.= ( ( multnat ) . ( [: C100 , C101 :] . [ C99 , C104 ] ) ) by BINOP_1:def 1
.= ( ( ( multnat ) * [: C100 , C101 :] ) . [ C99 , C104 ] ) by L842 , FUNCT_1:12
.= ( D108 . [ C99 , C104 ] ) by L840 , FUNCT_1:49;
per cases  by L839 , L845 , ZFMISC_1:33;
suppose L848: ( support D108 ) = ( {} );

L849: ( ( C100 . C99 ) * ( C101 . C104 ) ) = ( 0 ) by L848 , L847 , PRE_POLY:def 7;
thus L850: ( Sum D108 ) = ( ( C100 . C99 ) * ( C101 . C104 ) ) by L849 , L837 , L838 , L848 , RVSUM_1:72;
end;
suppose L851: ( support D108 ) = { [ C99 , C104 ] };

L852: ( canFS ( support D108 ) ) = <* [ C99 , C104 ] *> by L851 , UPROOTS:4;
L853: C105 = <* ( D108 . [ C99 , C104 ] ) *> by L852 , L838 , L840 , L844 , FINSEQ_2:34;
thus L854: ( Sum D108 ) = ( ( C100 . C99 ) * ( C101 . C104 ) ) by L853 , L837 , L847 , RVSUM_1:73;
end;
end;
thus L856: ( Sum ( ( ( multnat ) * [: C100 , C101 :] ) | [: C102 , C103 :] ) ) = ( ( C100 . C99 ) * ( Sum ( C101 | C103 ) ) ) by L846 , L836 , L799;
end;
suppose L857: C97 > 1;

L858: C103 <> ( {} ) by L857 , L828;
consider C106 being set such that L859: C106 in C103 by L858 , XBOOLE_0:def 1;
set D114 = { C106 };
set D115 = ( C103 \ D114 );
reconsider D116 = D114 as  finite (Subset of C98) by L859 , ZFMISC_1:31;
L860: ( card D116 ) < C97 by L857 , CARD_1:30;
L861: (( ( - 1 ) + C97 ) < ( ( 0 ) + C97 ) & ( Sum ( ( ( multnat ) * [: C100 , C101 :] ) | [: C102 , D116 :] ) ) = ( ( C100 . C99 ) * ( Sum ( C101 | D116 ) ) )) by L860 , L823 , L827 , XREAL_1:8;
L862: D115 misses D116 by XBOOLE_1:79;
L863: [: C102 , D115 :] misses [: C102 , D116 :] by L862 , ZFMISC_1:104;
L864: C106 in D116 by TARSKI:def 1;
L865: (not C106 in D115) by L864 , XBOOLE_0:def 5;
L866: ( card ( D115 \/ D116 ) ) = ( ( card D115 ) + 1 ) by L865 , CARD_2:41;
L867: ( D115 \/ D116 ) = ( C103 \/ { C106 } ) by XBOOLE_1:39
.= C103 by L859 , ZFMISC_1:40;
L868: [: C102 , C103 :] = ( [: C102 , D115 :] \/ [: C102 , D116 :] ) by L867 , ZFMISC_1:97;
thus L869: ( Sum ( ( ( multnat ) * [: C100 , C101 :] ) | [: C102 , C103 :] ) ) = ( ( Sum ( ( ( multnat ) * [: C100 , C101 :] ) | [: C102 , D115 :] ) ) + ( Sum ( ( ( multnat ) * [: C100 , C101 :] ) | [: C102 , D116 :] ) ) ) by L868 , L863 , L788
.= ( ( ( C100 . C99 ) * ( Sum ( C101 | D115 ) ) ) + ( ( C100 . C99 ) * ( Sum ( C101 | D116 ) ) ) ) by L823 , L827 , L828 , L866 , L867 , L861
.= ( ( C100 . C99 ) * ( ( Sum ( C101 | D115 ) ) + ( Sum ( C101 | D116 ) ) ) )
.= ( ( C100 . C99 ) * ( Sum ( C101 | C103 ) ) ) by L867 , L788 , XBOOLE_1:79;
end;
end;

end;
L825: (for B73 being Nat holds S5[ B73 ]) from NAT_1:sch 4(L822);
L826: S5[ ( card R24 ) ] by L825;
thus L827: thesis by L826;
end;
theorem
L828: (for R19 being set holds (for R21 being (Function of R19 , ( NAT )) holds (for R22 being (Function of R19 , ( NAT )) holds (for R23 being  finite (Subset of R19) holds (for R24 being  finite (Subset of R19) holds ( Sum ( ( ( multnat ) * [: R21 , R22 :] ) | [: R23 , R24 :] ) ) = ( ( Sum ( R21 | R23 ) ) * ( Sum ( R22 | R24 ) ) ))))))
proof
let R19 being set;
let R21 being (Function of R19 , ( NAT ));
let R22 being (Function of R19 , ( NAT ));
let R23 being  finite (Subset of R19);
let R24 being  finite (Subset of R19);
defpred S6[ Nat ] means (for B74 being set holds (for B75 , B76 being (Function of B74 , ( NAT )) holds (for B77 , B78 being  finite (Subset of B74) holds ($1 = ( card B77 ) implies ( Sum ( ( ( multnat ) * [: B75 , B76 :] ) | [: B77 , B78 :] ) ) = ( ( Sum ( B75 | B77 ) ) * ( Sum ( B76 | B78 ) ) )))));
L829: (for B79 being Nat holds ((for B80 being Nat holds (B80 < B79 implies S6[ B80 ])) implies S6[ B79 ]))
proof
let C107 being Nat;
assume L830: (for B81 being Nat holds (B81 < C107 implies S6[ B81 ]));
thus L831: S6[ C107 ]
proof
L832: (C107 = ( 0 ) or ( C107 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:8;
L833: (C107 = ( 0 ) or C107 >= 1) by L832 , NAT_1:13;
let C108 being set;
let C109 , C110 being (Function of C108 , ( NAT ));
let C111 , C112 being  finite (Subset of C108);
assume L834: C107 = ( card C111 );
per cases  by L833 , XXREAL_0:1;
suppose L835: C107 = ( 0 );

L836: C111 = ( {} ) by L835 , L834;
L837: [: C111 , C112 :] = ( {} ) by L836;
L838: ( EmptyBag ( {} ) ) = ( ( {} ) --> ( 0 ) )
.= ( {} );
L839: ( Sum ( C109 | C111 ) ) = ( 0 ) by L838 , L836 , RELAT_1:81 , UPROOTS:11;
thus L840: ( Sum ( ( ( multnat ) * [: C109 , C110 :] ) | [: C111 , C112 :] ) ) = ( ( Sum ( C109 | C111 ) ) * ( Sum ( C110 | C112 ) ) ) by L839 , L837 , L838 , RELAT_1:81 , UPROOTS:11;
end;
suppose L841: C107 = 1;

set D117 = the set;
L842: ( card { D117 } ) = ( card C111 ) by L834 , L841 , CARD_1:30;
consider C113 being set such that L843: C111 = { C113 } by L842 , CARD_1:29;
L844: ( Sum ( ( ( multnat ) * [: C109 , C110 :] ) | [: C111 , C112 :] ) ) = ( ( C109 . C113 ) * ( Sum ( C110 | C112 ) ) ) by L843 , L821;
thus L845: ( Sum ( ( ( multnat ) * [: C109 , C110 :] ) | [: C111 , C112 :] ) ) = ( ( Sum ( C109 | C111 ) ) * ( Sum ( C110 | C112 ) ) ) by L844 , L843 , L799;
end;
suppose L846: C107 > 1;

L847: C111 <> ( {} ) by L846 , L834;
consider C114 being set such that L848: C114 in C111 by L847 , XBOOLE_0:def 1;
set D118 = { C114 };
set D119 = ( C111 \ D118 );
reconsider D120 = D118 as  finite (Subset of C108) by L848 , ZFMISC_1:31;
L849: ( D119 \/ D120 ) = ( C111 \/ { C114 } ) by XBOOLE_1:39
.= C111 by L848 , ZFMISC_1:40;
L850: ( Sum ( C109 | C111 ) ) = ( ( Sum ( C109 | D119 ) ) + ( Sum ( C109 | D120 ) ) ) by L849 , L788 , XBOOLE_1:79;
L851: ( card D120 ) < C107 by L846 , CARD_1:30;
L852: (( ( - 1 ) + C107 ) < ( ( 0 ) + C107 ) & ( Sum ( ( ( multnat ) * [: C109 , C110 :] ) | [: D120 , C112 :] ) ) = ( ( Sum ( C109 | D120 ) ) * ( Sum ( C110 | C112 ) ) )) by L851 , L830 , XREAL_1:8;
L853: D119 misses D120 by XBOOLE_1:79;
L854: [: D119 , C112 :] misses [: D120 , C112 :] by L853 , ZFMISC_1:104;
L855: C114 in D120 by TARSKI:def 1;
L856: (not C114 in D119) by L855 , XBOOLE_0:def 5;
L857: ( card ( D119 \/ D120 ) ) = ( ( card D119 ) + 1 ) by L856 , CARD_2:41;
L858: [: C111 , C112 :] = ( [: D119 , C112 :] \/ [: D120 , C112 :] ) by L849 , ZFMISC_1:97;
thus L859: ( Sum ( ( ( multnat ) * [: C109 , C110 :] ) | [: C111 , C112 :] ) ) = ( ( Sum ( ( ( multnat ) * [: C109 , C110 :] ) | [: D119 , C112 :] ) ) + ( Sum ( ( ( multnat ) * [: C109 , C110 :] ) | [: D120 , C112 :] ) ) ) by L858 , L854 , L788
.= ( ( ( Sum ( C109 | D119 ) ) * ( Sum ( C110 | C112 ) ) ) + ( ( Sum ( C109 | D120 ) ) * ( Sum ( C110 | C112 ) ) ) ) by L830 , L834 , L857 , L849 , L852
.= ( ( Sum ( C109 | C111 ) ) * ( Sum ( C110 | C112 ) ) ) by L850;
end;
end;

end;
L832: (for B82 being Nat holds S6[ B82 ]) from NAT_1:sch 4(L829);
L833: S6[ ( card R23 ) ] by L832;
thus L834: thesis by L833;
end;
definition
let C115 being Nat;
func EXP C115 -> (Function of ( NAT ) , ( NAT )) means 
:L835: (for B83 being Nat holds ( it . B83 ) = ( B83 |^ C115 ));
existence
proof
reconsider D121 = C115 as (Element of ( NAT )) by ORDINAL1:def 12;
deffunc H1((Element of ( NAT ))) = ( $1 |^ D121 );
consider C116 being (Function of ( NAT ) , ( NAT )) such that L836: (for B84 being (Element of ( NAT )) holds ( C116 . B84 ) = H1(B84)) from FUNCT_2:sch 4;
take C116;
L837: (for B85 being Nat holds ( C116 . B85 ) = ( B85 |^ C115 ))
proof
let C117 being Nat;
reconsider D122 = C117 as (Element of ( NAT )) by ORDINAL1:def 12;
L838: ( C116 . D122 ) = H1(D122) by L836;
thus L839: ( C116 . C117 ) = ( C117 |^ C115 ) by L838;
end;
thus L840: thesis by L837;
end;
uniqueness
proof
let C118 , C119 being (Function of ( NAT ) , ( NAT ));
assume L841: (for B86 being Nat holds ( C118 . B86 ) = ( B86 |^ C115 ));
assume L842: (for B87 being Nat holds ( C119 . B87 ) = ( B87 |^ C115 ));
L843: (for B88 being set holds (B88 in ( NAT ) implies ( C118 . B88 ) = ( C119 . B88 )))
proof
let C120 being set;
assume L844: C120 in ( NAT );
reconsider D123 = C120 as Nat by L844;
L845: ( C118 . D123 ) = ( D123 |^ C115 ) by L841
.= ( C119 . D123 ) by L842;
thus L846: ( C118 . C120 ) = ( C119 . C120 ) by L845;
end;
thus L847: C118 = C119 by L843 , FUNCT_2:12;
end;
end;
definition
let C121 , C122 being Nat;
func sigma (C121 , C122) -> (Element of ( NAT )) means 
:L849: (for B89 being non  zero Nat holds (C122 = B89 implies it = ( Sum ( ( EXP C121 ) | ( NatDivisors B89 ) ) ))) if C122 <> ( 0 ) otherwise it = ( 0 );
correctness
proof
L850: (for B90 , B91 being (Element of ( NAT )) holds ((((not C122 <> ( 0 )) & B90 = ( 0 ) & B91 = ( 0 )) implies B90 = B91) & ((C122 <> ( 0 ) & (for B92 being non  zero Nat holds (C122 = B92 implies B90 = ( Sum ( ( EXP C121 ) | ( NatDivisors B92 ) ) ))) & (for B93 being non  zero Nat holds (C122 = B93 implies B91 = ( Sum ( ( EXP C121 ) | ( NatDivisors B93 ) ) )))) implies B90 = B91)))
proof
let C123 , C124 being (Element of ( NAT ));
thus L851: (((not C122 <> ( 0 )) & C123 = ( 0 ) & C124 = ( 0 )) implies C123 = C124);
assume L852: C122 <> ( 0 );
reconsider D124 = C122 as non  zero Nat by L852;
assume L853: (for B94 being non  zero Nat holds (C122 = B94 implies C123 = ( Sum ( ( EXP C121 ) | ( NatDivisors B94 ) ) )));
L854: C123 = ( Sum ( ( EXP C121 ) | ( NatDivisors D124 ) ) ) by L853;
assume L855: (for B95 being non  zero Nat holds (C122 = B95 implies C124 = ( Sum ( ( EXP C121 ) | ( NatDivisors B95 ) ) )));
thus L856: C123 = C124 by L855 , L854;
end;
L857: (C122 <> ( 0 ) implies (ex B96 being (Element of ( NAT )) st (for B97 being non  zero Nat holds (C122 = B97 implies B96 = ( Sum ( ( EXP C121 ) | ( NatDivisors B97 ) ) )))))
proof
assume L858: C122 <> ( 0 );
reconsider D125 = C122 as non  zero Nat by L858;
reconsider D126 = ( Sum ( ( EXP C121 ) | ( NatDivisors D125 ) ) ) as (Element of ( NAT )) by ORDINAL1:def 12;
take D126;
let C125 being non  zero Nat;
assume L859: C122 = C125;
thus L860: D126 = ( Sum ( ( EXP C121 ) | ( NatDivisors C125 ) ) ) by L859;
end;
thus L861: thesis by L857 , L850;
end;
end;
definition
let C126 being Nat;
func Sigma C126 -> (Function of ( NAT ) , ( NAT )) means 
:L863: (for B98 being Nat holds ( it . B98 ) = ( sigma (C126 , B98) ));
existence
proof
deffunc H2((Element of ( NAT ))) = ( sigma (C126 , $1) );
consider C127 being (Function of ( NAT ) , ( NAT )) such that L864: (for B99 being (Element of ( NAT )) holds ( C127 . B99 ) = H2(B99)) from FUNCT_2:sch 4;
take C127;
let C128 being Nat;
reconsider D127 = C128 as (Element of ( NAT )) by ORDINAL1:def 12;
thus L865: ( C127 . C128 ) = ( C127 . D127 )
.= ( sigma (C126 , C128) ) by L864;
end;
uniqueness
proof
let C129 , C130 being (Function of ( NAT ) , ( NAT ));
assume L866: (for B100 being Nat holds ( C129 . B100 ) = ( sigma (C126 , B100) ));
assume L867: (for B101 being Nat holds ( C130 . B101 ) = ( sigma (C126 , B101) ));
L868: (for B102 being set holds (B102 in ( NAT ) implies ( C129 . B102 ) = ( C130 . B102 )))
proof
let C131 being set;
assume L869: C131 in ( NAT );
reconsider D128 = C131 as Nat by L869;
thus L870: ( C129 . C131 ) = ( sigma (C126 , D128) ) by L866
.= ( C130 . C131 ) by L867;
end;
thus L871: C129 = C130 by L868 , FUNCT_2:12;
end;
end;
definition
let C132 being Nat;
func sigma C132 -> (Element of ( NAT )) equals 
( sigma (1 , C132) );
correctness;
end;
theorem
L874: (for R1 being Nat holds ( sigma (R1 , 1) ) = 1)
proof
let R1 being Nat;
set D129 = ( ( EXP R1 ) | ( NatDivisors 1 ) );
consider C133 being (FinSequence of ( REAL )) such that L875: ( Sum D129 ) = ( Sum C133 ) and L876: C133 = ( D129 * ( canFS ( support D129 ) ) ) by UPROOTS:def 3;
L877: 1 in ( NAT );
L878: 1 in ( dom ( EXP R1 ) ) by L877 , FUNCT_2:def 1;
L879: 1 in ( NatDivisors 1 );
L880: 1 in ( dom D129 ) by L879 , L878 , RELAT_1:57;
L881: ( D129 . 1 ) = ( ( EXP R1 ) . 1 ) by L880 , FUNCT_1:47
.= ( 1 |^ R1 ) by L835
.= 1 by NEWTON:10;
L882: ( support D129 ) c= ( dom D129 ) by PRE_POLY:37;
L883: (for B103 being set holds (B103 in ( support D129 ) iff B103 = 1))
proof
let C134 being set;
thus L884:now
assume L885: C134 in ( support D129 );
L886: C134 in ( NatDivisors 1 ) by L885 , L882 , RELAT_1:57;
thus L887: C134 = 1 by L886 , MOEBIUS1:41 , TARSKI:def 1;
end;
assume L888: C134 = 1;
thus L889: C134 in ( support D129 ) by L888 , L881 , PRE_POLY:def 7;
end;
L890: ( support D129 ) = { 1 } by L883 , TARSKI:def 1;
L891: C133 = ( D129 * <* 1 *> ) by L890 , L876 , UPROOTS:4
.= <* ( D129 . 1 ) *> by L880 , FINSEQ_2:34;
L892: ( Sum D129 ) = 1 by L891 , L881 , L875 , RVSUM_1:73;
thus L893: ( sigma (R1 , 1) ) = 1 by L892 , L849;
end;
theorem
L894: (for R2 being Nat holds (for R5 being Nat holds (R5 is  prime implies ( sigma ( R5 |^ R2 ) ) = ( ( ( R5 |^ ( R2 + 1 ) ) - 1 ) / ( R5 - 1 ) ))))
proof
let R2 being Nat;
let R5 being Nat;
defpred S7[ Nat ] means (for B104 being Nat holds (B104 is  prime implies ( sigma ( B104 |^ $1 ) ) = ( ( ( B104 |^ ( $1 + 1 ) ) - 1 ) / ( B104 - 1 ) )));
L895: (for B105 being Nat holds (S7[ B105 ] implies S7[ ( B105 + 1 ) ]))
proof
let C135 being Nat;
assume L896: S7[ C135 ];
thus L897: S7[ ( C135 + 1 ) ]
proof
let C136 being Nat;
reconsider D130 = ( C135 + 1 ) , D131 = C136 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L898: C136 is  prime;
reconsider D132 = ( NatDivisors ( C136 |^ C135 ) ) as  finite (Subset of ( NAT )) by L898;
reconsider D133 = ( C136 |^ C135 ) as non  zero Nat by L898;
L899: ( Sum ( ( EXP 1 ) | D132 ) ) = ( sigma (1 , D133) ) by L849
.= ( sigma ( C136 |^ C135 ) )
.= ( ( ( C136 |^ ( C135 + 1 ) ) - 1 ) / ( C136 - 1 ) ) by L896 , L898;
L900: ( D131 |^ D130 ) in ( NAT );
reconsider D134 = { ( C136 |^ ( C135 + 1 ) ) } as  finite (Subset of ( NAT )) by L900 , ZFMISC_1:31;
L901: C136 > 1 by L898 , INT_2:def 4;
L902: ( C136 - 1 ) > ( 1 - 1 ) by L901 , XREAL_1:14;
L903:
now
let C137 being set;
assume L904: C137 in ( D132 /\ D134 );
L905: C137 in D132 by L904 , XBOOLE_0:def 4;
L906: C137 in { ( C136 |^ B106 ) where B106 is (Element of ( NAT )) : B106 <= C135 } by L905 , L898 , L353;
consider C138 being (Element of ( NAT )) such that L907: C137 = ( C136 |^ C138 ) and L908: C138 <= C135 by L906;
L909: C137 in D134 by L904 , XBOOLE_0:def 4;
L910: ( C136 |^ ( C135 + 1 ) ) = ( C136 |^ C138 ) by L909 , L907 , TARSKI:def 1;
L911: ( C136 |-count ( C136 |^ ( C135 + 1 ) ) ) = C138 by L910 , L901 , NAT_3:25;
L912: ( C135 + 1 ) = C138 by L911 , L901 , NAT_3:25;
L913: ( ( C135 + 1 ) - C135 ) <= ( C135 - C135 ) by L912 , L908 , XREAL_1:9;
L914: 1 <= ( 0 ) by L913;
thus L915: contradiction by L914;
end;
L916: ( D132 /\ D134 ) = ( {} ) by L903 , XBOOLE_0:def 1;
L917: D132 misses D134 by L916 , XBOOLE_0:def 7;
reconsider D135 = ( C136 |^ ( C135 + 1 ) ) as non  zero Nat by L898;
L918: ( ( EXP 1 ) . ( C136 |^ ( C135 + 1 ) ) ) = ( ( C136 |^ ( C135 + 1 ) ) |^ 1 ) by L835
.= ( C136 |^ ( ( C135 + 1 ) * 1 ) ) by NEWTON:9
.= ( C136 |^ ( C135 + 1 ) );
L919: (for B107 being set holds (B107 in ( NatDivisors ( C136 |^ ( C135 + 1 ) ) ) iff B107 in ( ( NatDivisors ( C136 |^ C135 ) ) \/ { ( C136 |^ ( C135 + 1 ) ) } )))
proof
let C139 being set;
thus L920:now
assume L921: C139 in ( NatDivisors ( C136 |^ ( C135 + 1 ) ) );
L922: C139 in { ( C136 |^ B108 ) where B108 is (Element of ( NAT )) : B108 <= ( C135 + 1 ) } by L921 , L898 , L353;
consider C140 being (Element of ( NAT )) such that L923: C139 = ( C136 |^ C140 ) and L924: C140 <= ( C135 + 1 ) by L922;
per cases ;
suppose L925: C140 <= C135;

L926: C139 in { ( C136 |^ B109 ) where B109 is (Element of ( NAT )) : B109 <= C135 } by L925 , L923;
L927: C139 in ( NatDivisors ( C136 |^ C135 ) ) by L926 , L898 , L353;
thus L928: C139 in ( ( NatDivisors ( C136 |^ C135 ) ) \/ { ( C136 |^ ( C135 + 1 ) ) } ) by L927 , XBOOLE_0:def 3;
end;
suppose L929: C140 > C135;

L930: C140 >= ( C135 + 1 ) by L929 , NAT_1:13;
L931: C140 = ( C135 + 1 ) by L930 , L924 , XXREAL_0:1;
L932: C139 in { ( C136 |^ ( C135 + 1 ) ) } by L931 , L923 , TARSKI:def 1;
thus L933: C139 in ( ( NatDivisors ( C136 |^ C135 ) ) \/ { ( C136 |^ ( C135 + 1 ) ) } ) by L932 , XBOOLE_0:def 3;
end;
end;
assume L935: C139 in ( ( NatDivisors ( C136 |^ C135 ) ) \/ { ( C136 |^ ( C135 + 1 ) ) } );
per cases  by L935 , XBOOLE_0:def 3;
suppose L936: C139 in ( NatDivisors ( C136 |^ C135 ) );

L937: C139 in { ( C136 |^ B110 ) where B110 is (Element of ( NAT )) : B110 <= C135 } by L936 , L898 , L353;
consider C141 being (Element of ( NAT )) such that L938: C139 = ( C136 |^ C141 ) and L939: C141 <= C135 by L937;
L940: ( ( 0 ) + C135 ) <= ( 1 + C135 ) by XREAL_1:7;
L941: C141 <= ( C135 + 1 ) by L940 , L939 , XXREAL_0:2;
L942: C139 in { ( C136 |^ B111 ) where B111 is (Element of ( NAT )) : B111 <= ( C135 + 1 ) } by L941 , L938;
thus L943: C139 in ( NatDivisors ( C136 |^ ( C135 + 1 ) ) ) by L942 , L898 , L353;
end;
suppose L944: C139 in { ( C136 |^ ( C135 + 1 ) ) };

L945: C139 = ( C136 |^ D130 ) by L944 , TARSKI:def 1;
L946: C139 in { ( C136 |^ B112 ) where B112 is (Element of ( NAT )) : B112 <= ( C135 + 1 ) } by L945;
thus L947: C139 in ( NatDivisors ( C136 |^ ( C135 + 1 ) ) ) by L946 , L898 , L353;
end;
end;
L949: ( NatDivisors ( C136 |^ ( C135 + 1 ) ) ) = ( ( NatDivisors ( C136 |^ C135 ) ) \/ { ( C136 |^ ( C135 + 1 ) ) } ) by L919 , TARSKI:1;
L950: ( sigma (1 , D135) ) = ( Sum ( ( EXP 1 ) | ( D132 \/ D134 ) ) ) by L949 , L849
.= ( ( Sum ( ( EXP 1 ) | D132 ) ) + ( Sum ( ( EXP 1 ) | D134 ) ) ) by L917 , L788
.= ( ( Sum ( ( EXP 1 ) | D132 ) ) + ( ( EXP 1 ) . ( C136 |^ ( C135 + 1 ) ) ) ) by L799;
thus L951: ( sigma ( C136 |^ ( C135 + 1 ) ) ) = ( ( ( ( C136 |^ ( C135 + 1 ) ) - 1 ) / ( C136 - 1 ) ) + ( ( ( C136 |^ ( C135 + 1 ) ) * ( C136 - 1 ) ) / ( C136 - 1 ) ) ) by L950 , L902 , L918 , L899 , XCMPLX_1:89
.= ( ( ( ( C136 |^ ( C135 + 1 ) ) - 1 ) + ( ( C136 |^ ( C135 + 1 ) ) * ( C136 - 1 ) ) ) / ( C136 - 1 ) ) by XCMPLX_1:62
.= ( ( ( ( C136 |^ ( C135 + 1 ) ) * C136 ) - 1 ) / ( C136 - 1 ) )
.= ( ( ( C136 |^ ( ( C135 + 1 ) + 1 ) ) - 1 ) / ( C136 - 1 ) ) by NEWTON:6;
end;

end;
L898: S7[ ( 0 ) ]
proof
let C142 being Nat;
assume L899: C142 is  prime;
L900: C142 > 1 by L899 , INT_2:def 4;
L901: ( C142 - 1 ) > ( 1 - 1 ) by L900 , XREAL_1:14;
thus L902: ( sigma ( C142 |^ ( 0 ) ) ) = ( sigma 1 ) by NEWTON:4
.= 1 by L874
.= ( ( C142 - 1 ) / ( C142 - 1 ) ) by L901 , XCMPLX_1:60
.= ( ( ( C142 |^ ( ( 0 ) + 1 ) ) - 1 ) / ( C142 - 1 ) ) by NEWTON:5;
end;
L903: (for B113 being Nat holds S7[ B113 ]) from NAT_1:sch 2(L898 , L895);
thus L904: thesis by L903;
end;
theorem
L905: (for R3 being Nat holds (for R6 being non  zero Nat holds ((R3 divides R6 & R6 <> R3 & R3 <> 1) implies ( ( 1 + R3 ) + R6 ) <= ( sigma R6 ))))
proof
let R3 being Nat;
let R6 being non  zero Nat;
assume L906: R3 divides R6;
assume L907: R6 <> R3;
assume L908: R3 <> 1;
per cases ;
suppose L909: R6 = 1;

thus L910: thesis by L909 , L906 , L907 , WSIERP_1:15;
end;
suppose L911: R6 <> 1;

reconsider D136 = { R3 , R6 } as  finite (Subset of ( NAT )) by L84;
set D137 = { 1 };
L912:
now
let C143 being set;
assume L913: C143 in ( D137 /\ D136 );
L914: C143 in D137 by L913 , XBOOLE_0:def 4;
L915: C143 = 1 by L914 , TARSKI:def 1;
L916: C143 in D136 by L913 , XBOOLE_0:def 4;
thus L917: contradiction by L916 , L908 , L911 , L915 , TARSKI:def 2;
end;
L918: ( D137 /\ D136 ) = ( {} ) by L912 , XBOOLE_0:def 1;
L919: D137 misses D136 by L918 , XBOOLE_0:def 7;
reconsider D138 = { R6 } as  finite (Subset of ( NAT )) by L81;
reconsider D139 = { R3 } as  finite (Subset of ( NAT )) by L81;
reconsider D140 = { 1 , R3 , R6 } as  finite (Subset of ( NAT )) by L87;
set D141 = ( ( NatDivisors R6 ) \ D140 );
L920: ( ( 0 ) + ( Sum ( ( EXP 1 ) | D140 ) ) ) <= ( ( Sum ( ( EXP 1 ) | D141 ) ) + ( Sum ( ( EXP 1 ) | D140 ) ) ) by XREAL_1:7;
L921: (for B114 being set holds (B114 in D140 implies B114 in ( NatDivisors R6 )))
proof
let C144 being set;
assume L922: C144 in D140;
reconsider D142 = C144 as (Element of ( NAT )) by L922;
L923: (C144 = 1 or C144 = R3 or C144 = R6) by L922 , ENUMSET1:def 1;
L924: (D142 <> ( 0 ) & D142 divides R6) by L923 , L906 , INT_2:3 , NAT_D:6;
thus L925: C144 in ( NatDivisors R6 ) by L924;
end;
L926: D140 c= ( NatDivisors R6 ) by L921 , TARSKI:def 3;
L927: ( NatDivisors R6 ) = ( D140 \/ D141 ) by L926 , XBOOLE_1:45;
L928: ( sigma R6 ) = ( Sum ( ( EXP 1 ) | ( D140 \/ D141 ) ) ) by L927 , L849
.= ( ( Sum ( ( EXP 1 ) | D140 ) ) + ( Sum ( ( EXP 1 ) | D141 ) ) ) by L788 , XBOOLE_1:79;
L929:
now
let C145 being set;
assume L930: C145 in ( D139 /\ D138 );
L931: C145 in D139 by L930 , XBOOLE_0:def 4;
L932: C145 = R3 by L931 , TARSKI:def 1;
L933: C145 in D138 by L930 , XBOOLE_0:def 4;
thus L934: contradiction by L933 , L907 , L932 , TARSKI:def 1;
end;
L935: ( D139 /\ D138 ) = ( {} ) by L929 , XBOOLE_0:def 1;
L936: (D136 = ( D139 \/ D138 ) & D139 misses D138) by L935 , ENUMSET1:1 , XBOOLE_0:def 7;
L937: D140 = ( D137 \/ D136 ) by ENUMSET1:2;
L938: ( Sum ( ( EXP 1 ) | D140 ) ) = ( ( Sum ( ( EXP 1 ) | D137 ) ) + ( Sum ( ( EXP 1 ) | D136 ) ) ) by L937 , L919 , L788
.= ( ( ( EXP 1 ) . 1 ) + ( Sum ( ( EXP 1 ) | D136 ) ) ) by L799
.= ( ( ( EXP 1 ) . 1 ) + ( ( Sum ( ( EXP 1 ) | D139 ) ) + ( Sum ( ( EXP 1 ) | D138 ) ) ) ) by L936 , L788
.= ( ( ( EXP 1 ) . 1 ) + ( ( ( EXP 1 ) . R3 ) + ( Sum ( ( EXP 1 ) | D138 ) ) ) ) by L799
.= ( ( ( ( EXP 1 ) . 1 ) + ( ( EXP 1 ) . R3 ) ) + ( Sum ( ( EXP 1 ) | D138 ) ) )
.= ( ( ( ( EXP 1 ) . 1 ) + ( ( EXP 1 ) . R3 ) ) + ( ( EXP 1 ) . R6 ) ) by L799
.= ( ( ( 1 |^ 1 ) + ( ( EXP 1 ) . R3 ) ) + ( ( EXP 1 ) . R6 ) ) by L835
.= ( ( ( 1 |^ 1 ) + ( R3 |^ 1 ) ) + ( ( EXP 1 ) . R6 ) ) by L835
.= ( ( ( 1 |^ 1 ) + ( R3 |^ 1 ) ) + ( R6 |^ 1 ) ) by L835
.= ( ( 1 + ( R3 |^ 1 ) ) + ( R6 |^ 1 ) ) by NEWTON:5
.= ( ( 1 + R3 ) + ( R6 |^ 1 ) ) by NEWTON:5
.= ( ( 1 + R3 ) + R6 ) by NEWTON:5;
thus L939: ( ( 1 + R3 ) + R6 ) <= ( sigma R6 ) by L938 , L928 , L920;
end;
end;
theorem
L941: (for R1 being Nat holds (for R3 being Nat holds (for R6 being non  zero Nat holds ((R3 divides R6 & R1 divides R6 & R6 <> R3 & R6 <> R1 & R3 <> 1 & R1 <> 1 & R3 <> R1) implies ( ( ( 1 + R3 ) + R1 ) + R6 ) <= ( sigma R6 )))))
proof
let R1 being Nat;
let R3 being Nat;
let R6 being non  zero Nat;
assume L942: R3 divides R6;
assume L943: R1 divides R6;
assume L944: R6 <> R3;
assume L945: R6 <> R1;
assume L946: R3 <> 1;
assume L947: R1 <> 1;
assume L948: R3 <> R1;
per cases ;
suppose L949: R6 = 1;

thus L950: thesis by L949 , L942 , L944 , WSIERP_1:15;
end;
suppose L951: R6 <> 1;

reconsider D143 = { R3 , R1 , R6 } as  finite (Subset of ( NAT )) by L87;
set D144 = { 1 };
L952:
now
let C146 being set;
assume L953: C146 in ( D144 /\ D143 );
L954: C146 in D144 by L953 , XBOOLE_0:def 4;
L955: C146 = 1 by L954 , TARSKI:def 1;
L956: C146 in D143 by L953 , XBOOLE_0:def 4;
thus L957: contradiction by L956 , L946 , L947 , L951 , L955 , ENUMSET1:def 1;
end;
L958: ( D144 /\ D143 ) = ( {} ) by L952 , XBOOLE_0:def 1;
L959: D144 misses D143 by L958 , XBOOLE_0:def 7;
reconsider D145 = { R3 } as  finite (Subset of ( NAT )) by L81;
reconsider D146 = { R6 } as  finite (Subset of ( NAT )) by L81;
reconsider D147 = { R1 } as  finite (Subset of ( NAT )) by L81;
reconsider D148 = { R3 , R1 } as  finite (Subset of ( NAT )) by L84;
reconsider D149 = { 1 , R3 , R1 , R6 } as  finite (Subset of ( NAT )) by L90;
set D150 = ( ( NatDivisors R6 ) \ D149 );
L960: ( ( 0 ) + ( Sum ( ( EXP 1 ) | D149 ) ) ) <= ( ( Sum ( ( EXP 1 ) | D150 ) ) + ( Sum ( ( EXP 1 ) | D149 ) ) ) by XREAL_1:7;
L961:
now
let C147 being set;
assume L962: C147 in ( D145 /\ D147 );
L963: C147 in D145 by L962 , XBOOLE_0:def 4;
L964: C147 = R3 by L963 , TARSKI:def 1;
L965: C147 in D147 by L962 , XBOOLE_0:def 4;
thus L966: contradiction by L965 , L948 , L964 , TARSKI:def 1;
end;
L967: ( D145 /\ D147 ) = ( {} ) by L961 , XBOOLE_0:def 1;
L968: (D148 = ( D145 \/ D147 ) & D145 misses D147) by L967 , ENUMSET1:1 , XBOOLE_0:def 7;
L969: (for B115 being set holds (B115 in D149 implies B115 in ( NatDivisors R6 )))
proof
let C148 being set;
assume L970: C148 in D149;
reconsider D151 = C148 as (Element of ( NAT )) by L970;
L971: (C148 = 1 or C148 = R3 or C148 = R1 or C148 = R6) by L970 , ENUMSET1:def 2;
L972: (D151 <> ( 0 ) & D151 divides R6) by L971 , L942 , L943 , INT_2:3 , NAT_D:6;
thus L973: C148 in ( NatDivisors R6 ) by L972;
end;
L974: D149 c= ( NatDivisors R6 ) by L969 , TARSKI:def 3;
L975: ( NatDivisors R6 ) = ( D149 \/ D150 ) by L974 , XBOOLE_1:45;
L976: ( sigma R6 ) = ( Sum ( ( EXP 1 ) | ( D149 \/ D150 ) ) ) by L975 , L849
.= ( ( Sum ( ( EXP 1 ) | D149 ) ) + ( Sum ( ( EXP 1 ) | D150 ) ) ) by L788 , XBOOLE_1:79;
L977:
now
let C149 being set;
assume L978: C149 in ( D148 /\ D146 );
L979: C149 in D146 by L978 , XBOOLE_0:def 4;
L980: C149 = R6 by L979 , TARSKI:def 1;
L981: C149 in D148 by L978 , XBOOLE_0:def 4;
thus L982: contradiction by L981 , L944 , L945 , L980 , TARSKI:def 2;
end;
L983: ( D148 /\ D146 ) = ( {} ) by L977 , XBOOLE_0:def 1;
L984: (D143 = ( D148 \/ D146 ) & D148 misses D146) by L983 , ENUMSET1:3 , XBOOLE_0:def 7;
L985: D149 = ( D144 \/ D143 ) by ENUMSET1:4;
L986: ( Sum ( ( EXP 1 ) | D149 ) ) = ( ( Sum ( ( EXP 1 ) | D144 ) ) + ( Sum ( ( EXP 1 ) | D143 ) ) ) by L985 , L959 , L788
.= ( ( ( EXP 1 ) . 1 ) + ( Sum ( ( EXP 1 ) | D143 ) ) ) by L799
.= ( ( ( EXP 1 ) . 1 ) + ( ( Sum ( ( EXP 1 ) | D148 ) ) + ( Sum ( ( EXP 1 ) | D146 ) ) ) ) by L984 , L788
.= ( ( ( EXP 1 ) . 1 ) + ( ( ( Sum ( ( EXP 1 ) | D145 ) ) + ( Sum ( ( EXP 1 ) | D147 ) ) ) + ( Sum ( ( EXP 1 ) | D146 ) ) ) ) by L968 , L788
.= ( ( ( EXP 1 ) . 1 ) + ( ( ( ( EXP 1 ) . R3 ) + ( Sum ( ( EXP 1 ) | D147 ) ) ) + ( Sum ( ( EXP 1 ) | D146 ) ) ) ) by L799
.= ( ( ( ( EXP 1 ) . 1 ) + ( ( EXP 1 ) . R3 ) ) + ( ( Sum ( ( EXP 1 ) | D147 ) ) + ( Sum ( ( EXP 1 ) | D146 ) ) ) )
.= ( ( ( ( EXP 1 ) . 1 ) + ( ( EXP 1 ) . R3 ) ) + ( ( ( EXP 1 ) . R1 ) + ( Sum ( ( EXP 1 ) | D146 ) ) ) ) by L799
.= ( ( ( ( ( EXP 1 ) . 1 ) + ( ( EXP 1 ) . R3 ) ) + ( ( EXP 1 ) . R1 ) ) + ( Sum ( ( EXP 1 ) | D146 ) ) )
.= ( ( ( ( ( EXP 1 ) . 1 ) + ( ( EXP 1 ) . R3 ) ) + ( ( EXP 1 ) . R1 ) ) + ( ( EXP 1 ) . R6 ) ) by L799
.= ( ( ( ( 1 |^ 1 ) + ( ( EXP 1 ) . R3 ) ) + ( ( EXP 1 ) . R1 ) ) + ( ( EXP 1 ) . R6 ) ) by L835
.= ( ( ( ( 1 |^ 1 ) + ( R3 |^ 1 ) ) + ( ( EXP 1 ) . R1 ) ) + ( ( EXP 1 ) . R6 ) ) by L835
.= ( ( ( ( 1 |^ 1 ) + ( R3 |^ 1 ) ) + ( R1 |^ 1 ) ) + ( ( EXP 1 ) . R6 ) ) by L835
.= ( ( ( ( 1 |^ 1 ) + ( R3 |^ 1 ) ) + ( R1 |^ 1 ) ) + ( R6 |^ 1 ) ) by L835
.= ( ( ( 1 + ( R3 |^ 1 ) ) + ( R1 |^ 1 ) ) + ( R6 |^ 1 ) ) by NEWTON:5
.= ( ( ( 1 + R3 ) + ( R1 |^ 1 ) ) + ( R6 |^ 1 ) ) by NEWTON:5
.= ( ( ( 1 + R3 ) + R1 ) + ( R6 |^ 1 ) ) by NEWTON:5
.= ( ( ( 1 + R3 ) + R1 ) + R6 ) by NEWTON:5;
thus L987: ( ( ( 1 + R3 ) + R1 ) + R6 ) <= ( sigma R6 ) by L986 , L976 , L960;
end;
end;
theorem
L989: (for R3 being Nat holds (for R6 being non  zero Nat holds ((( sigma R6 ) = ( R6 + R3 ) & R3 divides R6 & R6 <> R3) implies (R3 = 1 & R6 is  prime))))
proof
let R3 being Nat;
let R6 being non  zero Nat;
assume L990: ( sigma R6 ) = ( R6 + R3 );
assume L991: R3 divides R6;
assume L992: R6 <> R3;
per cases ;
suppose L993: R6 = 1;

L994: 1 = ( 1 + R3 ) by L993 , L990 , L874;
thus L995: thesis by L994 , L991 , INT_2:3;
end;
suppose L996: R6 <> 1;

consider C150 being Nat such that L997: R6 = ( R3 * C150 ) by L991 , NAT_D:def 3;
L998: C150 <> R3
proof
assume L999: C150 = R3;
L1000: R3 <> 1 by L999 , L996 , L997;
L1001: ( ( 1 + R3 ) + R6 ) <= ( sigma R6 ) by L1000 , L991 , L992 , L905;
L1002: ( ( ( 1 + R3 ) + R6 ) - ( R3 + R6 ) ) <= ( ( R6 + R3 ) - ( R3 + R6 ) ) by L1001 , L990 , XREAL_1:9;
thus L1003: contradiction by L1002;
end;
L1004: C150 = R6
proof
L1005: (C150 divides R6 & C150 <> 1) by L992 , L997 , NAT_D:def 3;
assume L1006: C150 <> R6;
L1007: R3 <> 1 by L1006 , L997;
L1008: ( ( ( 1 + R3 ) + C150 ) + R6 ) <= ( sigma R6 ) by L1007 , L991 , L992 , L998 , L1006 , L1005 , L941;
L1009: ( ( ( ( 1 + R3 ) + C150 ) + R6 ) - ( R3 + R6 ) ) <= ( ( R6 + R3 ) - ( R3 + R6 ) ) by L1008 , L990 , XREAL_1:9;
L1010: ( 1 + C150 ) <= ( 0 ) by L1009;
thus L1011: contradiction by L1010;
end;
L1012: ( R6 / R6 ) = R3 by L1004 , L997 , XCMPLX_1:89;
thus L1013: R3 = 1 by L1012 , XCMPLX_1:60;
L1014: (for B116 being Nat holds ((not B116 divides R6) or B116 = 1 or B116 = R6))
proof
let C151 being Nat;
assume that
L1015: C151 divides R6
and
L1016: C151 <> 1;
assume L1017: C151 <> R6;
L1018: ( ( 1 + C151 ) + R6 ) <= ( R6 + 1 ) by L1017 , L990 , L1013 , L1015 , L1016 , L905;
L1019: ( ( ( 1 + C151 ) + R6 ) - ( 1 + R6 ) ) <= ( ( R6 + 1 ) - ( 1 + R6 ) ) by L1018 , XREAL_1:9;
L1020: C151 = ( 0 ) by L1019;
thus L1021: contradiction by L1020 , L1015 , INT_2:3;
end;
L1022: R6 > 1 by L996 , NAT_1:25;
thus L1023: R6 is  prime by L1022 , L1014 , INT_2:def 4;
end;
end;
definition
let C152 being (Function of ( NAT ) , ( NAT ));
attr C152 is  multiplicative
means
:L1025: (for B117 , B118 being non  zero Nat holds (B117 , B118 are_relative_prime  implies ( C152 . ( B117 * B118 ) ) = ( ( C152 . B117 ) * ( C152 . B118 ) )));
end;
theorem
L1027: (for B119 , B120 being (Function of ( NAT ) , ( NAT )) holds ((B119 is  multiplicative & (for R6 being non  zero Nat holds ( B120 . R6 ) = ( Sum ( B119 | ( NatDivisors R6 ) ) ))) implies B120 is  multiplicative))
proof
let C153 , C154 being (Function of ( NAT ) , ( NAT ));
assume L1028: C153 is  multiplicative;
assume L1029: (for R6 being non  zero Nat holds ( C154 . R6 ) = ( Sum ( C153 | ( NatDivisors R6 ) ) ));
L1030: (for B121 , B122 being non  zero Nat holds (B121 , B122 are_relative_prime  implies ( C154 . ( B121 * B122 ) ) = ( ( C154 . B121 ) * ( C154 . B122 ) )))
proof
let C155 , C156 being non  zero Nat;
set D152 = ( C153 | ( NatDivisors ( C155 * C156 ) ) );
set D153 = ( ( ( multnat ) * [: C153 , C153 :] ) | [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] );
consider C157 being (FinSequence of ( REAL )) such that L1031: ( Sum D152 ) = ( Sum C157 ) and L1032: C157 = ( D152 * ( canFS ( support D152 ) ) ) by UPROOTS:def 3;
set D154 = ( ( multnat ) | [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] );
set D155 = ( canFS ( support D153 ) );
set D156 = ( canFS ( support D152 ) );
consider C158 being (FinSequence of ( REAL )) such that L1033: ( Sum D153 ) = ( Sum C158 ) and L1034: C158 = ( D153 * ( canFS ( support D153 ) ) ) by UPROOTS:def 3;
L1035: ( dom ( multnat ) ) = [: ( NAT ) , ( NAT ) :] by FUNCT_2:def 1;
L1036: ( dom D154 ) = [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] by L1035 , RELAT_1:62;
assume L1037: C155 , C156 are_relative_prime ;
L1038: (for B123 , B124 being set holds ((B123 in ( dom D154 ) & B124 in ( dom D154 ) & ( D154 . B123 ) = ( D154 . B124 )) implies B123 = B124))
proof
let C159 , C160 being set;
assume L1039: C159 in ( dom D154 );
consider C161 , C162 being set such that L1040: (C161 in ( NatDivisors C155 ) & C162 in ( NatDivisors C156 )) and L1041: C159 = [ C161 , C162 ] by L1039 , ZFMISC_1:def 2;
reconsider D157 = C161 , D158 = C162 as (Element of ( NAT )) by L1040;
L1042: ( D154 . C159 ) = ( ( multnat ) . C159 ) by L1039 , FUNCT_1:47
.= ( ( multnat ) . (D157 , D158) ) by L1041 , BINOP_1:def 1
.= ( D157 * D158 ) by BINOP_2:def 24;
assume L1043: C160 in ( dom D154 );
consider C163 , C164 being set such that L1044: C163 in ( NatDivisors C155 ) and L1045: C164 in ( NatDivisors C156 ) and L1046: C160 = [ C163 , C164 ] by L1043 , ZFMISC_1:def 2;
reconsider D159 = C163 , D160 = C164 as (Element of ( NAT )) by L1044 , L1045;
assume L1047: ( D154 . C159 ) = ( D154 . C160 );
L1048: ( D154 . C160 ) = ( ( multnat ) . C160 ) by L1043 , FUNCT_1:47
.= ( ( multnat ) . (D159 , D160) ) by L1046 , BINOP_1:def 1
.= ( D159 * D160 ) by BINOP_2:def 24;
L1049: D157 = D159 by L1048 , L1037 , L1040 , L1044 , L1045 , L1047 , L1042 , L277;
thus L1050: C159 = C160 by L1049 , L1037 , L1040 , L1041 , L1045 , L1046 , L1047 , L1042 , L1048 , L277;
end;
reconsider D161 = D154 as  one-to-one Function by L1038 , FUNCT_1:def 4;
set D162 = ( ( ( D156 " ) * D161 ) * D155 );
L1051: ( support D153 ) c= ( dom D153 ) by PRE_POLY:37;
L1052: ( dom ( ( multnat ) * [: C153 , C153 :] ) ) = [: ( NAT ) , ( NAT ) :] by FUNCT_2:def 1;
L1053: ( dom D153 ) = [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] by L1052 , RELAT_1:62;
L1054: ( dom [: C153 , C153 :] ) = [: ( NAT ) , ( NAT ) :] by FUNCT_2:def 1;
L1055: (for B125 being set holds (B125 in ( support D153 ) implies B125 in ( dom ( ( D156 " ) * D161 ) )))
proof
let C165 being set;
L1056: ( rng D156 ) = ( support D152 ) by FUNCT_2:def 3;
assume L1057: C165 in ( support D153 );
L1058: ( D153 . C165 ) <> ( 0 ) by L1057 , PRE_POLY:def 7;
L1059: C165 in [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] by L1053 , L1051 , L1057;
consider C166 , C167 being set such that L1060: (C166 in ( NatDivisors C155 ) & C167 in ( NatDivisors C156 )) and L1061: C165 = [ C166 , C167 ] by L1053 , L1051 , L1057 , ZFMISC_1:def 2;
reconsider D163 = C166 , D164 = C167 as (Element of ( NAT )) by L1060;
L1062: D163 , D164 are_relative_prime  by L1037 , L1060 , L257;
reconsider D165 = D163 , D166 = D164 as non  zero Nat by L1060 , MOEBIUS1:39;
set D167 = ( ( D156 " ) . ( D163 * D164 ) );
set D168 = ( C153 . D163 );
set D169 = ( C153 . D164 );
L1063: ( D153 . C165 ) = ( ( ( multnat ) * [: C153 , C153 :] ) . C165 ) by L1053 , L1051 , L1057 , FUNCT_1:49
.= ( ( multnat ) . ( [: C153 , C153 :] . C165 ) ) by L1054 , L1059 , FUNCT_1:13
.= ( ( multnat ) . ( [: C153 , C153 :] . (D163 , D164) ) ) by L1061 , BINOP_1:def 1
.= ( ( multnat ) . [ ( C153 . D163 ) , ( C153 . D164 ) ] ) by FUNCT_3:75
.= ( ( multnat ) . (( C153 . D163 ) , ( C153 . D164 )) ) by BINOP_1:def 1
.= ( D168 * D169 ) by BINOP_2:def 24
.= ( C153 . ( D165 * D166 ) ) by L1028 , L1062 , L1025
.= ( ( C153 | ( NatDivisors ( C155 * C156 ) ) ) . ( D163 * D164 ) ) by L1060 , L307 , FUNCT_1:49;
L1064: ( D163 * D164 ) in ( rng D156 ) by L1063 , L1058 , L1056 , PRE_POLY:def 7;
L1065: ( D163 * D164 ) in ( dom ( D156 " ) ) by L1064 , FUNCT_1:33;
L1066: D167 in ( rng ( D156 " ) ) by L1065 , FUNCT_1:3;
L1067: D167 in ( dom D156 ) by L1066 , FUNCT_1:33;
L1068: ( D156 . D167 ) = ( D163 * D164 ) by L1064 , FUNCT_1:35
.= ( ( multnat ) . (D163 , D164) ) by BINOP_2:def 24
.= ( ( multnat ) . [ D163 , D164 ] ) by BINOP_1:def 1
.= ( D161 . C165 ) by L1053 , L1051 , L1057 , L1061 , FUNCT_1:49;
L1069: ( D161 . C165 ) in ( rng D156 ) by L1068 , L1067 , FUNCT_1:def 3;
L1070: ( D161 . C165 ) in ( dom ( D156 " ) ) by L1069 , FUNCT_1:33;
thus L1071: C165 in ( dom ( ( D156 " ) * D161 ) ) by L1070 , L1036 , L1053 , L1051 , L1057 , FUNCT_1:11;
end;
L1072: ( support D153 ) c= ( dom ( ( D156 " ) * D161 ) ) by L1055 , TARSKI:def 3;
L1073: ( rng D155 ) c= ( dom ( ( D156 " ) * D161 ) ) by L1072 , FUNCT_2:def 3;
L1074: ( dom ( ( ( D156 " ) * D161 ) * D155 ) ) = ( dom D155 ) by L1073 , RELAT_1:27;
L1075: ( rng D155 ) c= ( dom D153 ) by L1051 , FUNCT_2:def 3;
L1076: ( dom D162 ) = ( dom C158 ) by L1075 , L1034 , L1074 , RELAT_1:27;
L1077: (for B126 being set holds (B126 in ( dom C158 ) implies ( C158 . B126 ) = ( C157 . ( D162 . B126 ) )))
proof
let C168 being set;
set D170 = ( D155 . C168 );
L1078: ( ( D152 * D156 ) * ( ( D156 " ) * D161 ) ) = ( ( ( D152 * D156 ) * ( D156 " ) ) * D161 ) by RELAT_1:36
.= ( ( D152 * ( D156 * ( D156 " ) ) ) * D161 ) by RELAT_1:36
.= ( ( D152 * ( id ( rng D156 ) ) ) * D161 ) by FUNCT_1:39
.= ( ( D152 * ( id ( support D152 ) ) ) * D161 ) by FUNCT_2:def 3;
assume L1079: C168 in ( dom C158 );
L1080: C168 in ( dom D155 ) by L1079 , L1034 , FUNCT_1:11;
L1081: D170 in ( rng D155 ) by L1080 , FUNCT_1:3;
L1082: (( support D153 ) c= ( dom D153 ) & D170 in ( support D153 )) by L1081 , PRE_POLY:37;
consider C169 , C170 being set such that L1083: (C169 in ( NatDivisors C155 ) & C170 in ( NatDivisors C156 )) and L1084: D170 = [ C169 , C170 ] by L1082 , L1053 , ZFMISC_1:def 2;
reconsider D171 = C169 , D172 = C170 as (Element of ( NAT )) by L1083;
L1085: D171 , D172 are_relative_prime  by L1037 , L1083 , L257;
reconsider D173 = D171 , D174 = D172 as non  zero Nat by L1083 , MOEBIUS1:39;
set D175 = ( C153 . D171 );
set D176 = ( C153 . D172 );
L1086: D170 in [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] by L1053 , L1082;
L1087: ( D153 . D170 ) = ( ( ( multnat ) * [: C153 , C153 :] ) . D170 ) by L1053 , L1082 , FUNCT_1:49
.= ( ( multnat ) . ( [: C153 , C153 :] . D170 ) ) by L1054 , L1086 , FUNCT_1:13
.= ( ( multnat ) . ( [: C153 , C153 :] . (D171 , D172) ) ) by L1084 , BINOP_1:def 1
.= ( ( multnat ) . [ ( C153 . D171 ) , ( C153 . D172 ) ] ) by FUNCT_3:75
.= ( ( multnat ) . (( C153 . D171 ) , ( C153 . D172 )) ) by BINOP_1:def 1
.= ( D175 * D176 ) by BINOP_2:def 24
.= ( C153 . ( D173 * D174 ) ) by L1028 , L1085 , L1025;
L1088: ( D153 . D170 ) <> ( 0 ) by L1081 , PRE_POLY:def 7;
L1089: ( C153 . ( D173 * D174 ) ) = ( ( C153 | ( NatDivisors ( C155 * C156 ) ) ) . ( D171 * D172 ) ) by L1083 , L307 , FUNCT_1:49;
L1090: ( D171 * D172 ) in ( support D152 ) by L1089 , L1088 , L1087 , PRE_POLY:def 7;
L1091: ( D171 * D172 ) in ( dom ( id ( support D152 ) ) ) by L1090;
L1092: ( D161 . D170 ) = ( ( multnat ) . D170 ) by L1036 , L1053 , L1082 , FUNCT_1:47
.= ( ( multnat ) . (D171 , D172) ) by L1084 , BINOP_1:def 1
.= ( D171 * D172 ) by BINOP_2:def 24;
L1093: ( ( D152 * D156 ) . ( D162 . C168 ) ) = ( ( ( D152 * D156 ) * D162 ) . C168 ) by L1076 , L1079 , FUNCT_1:13
.= ( ( ( ( D152 * D156 ) * ( ( D156 " ) * D161 ) ) * D155 ) . C168 ) by RELAT_1:36
.= ( ( ( D152 * D156 ) * ( ( D156 " ) * D161 ) ) . ( D155 . C168 ) ) by L1080 , FUNCT_1:13;
L1094: ( ( ( D152 * ( id ( support D152 ) ) ) * D161 ) . D170 ) = ( ( D152 * ( id ( support D152 ) ) ) . ( D161 . D170 ) ) by L1036 , L1053 , L1082 , FUNCT_1:13
.= ( D152 . ( ( id ( support D152 ) ) . ( D171 * D172 ) ) ) by L1091 , L1092 , FUNCT_1:13
.= ( D152 . ( D171 * D172 ) ) by L1090 , FUNCT_1:18
.= ( D153 . D170 ) by L1083 , L1087 , L307 , FUNCT_1:49;
thus L1095: ( C158 . C168 ) = ( C157 . ( D162 . C168 ) ) by L1094 , L1032 , L1034 , L1080 , L1093 , L1078 , FUNCT_1:13;
end;
L1096: ( dom C153 ) = ( NAT ) by FUNCT_2:def 1;
L1097: ( dom D152 ) = ( NatDivisors ( C155 * C156 ) ) by L1096 , RELAT_1:62;
L1098: (for B127 being set holds (B127 in ( rng D156 ) implies B127 in ( rng ( D161 * D155 ) )))
proof
let C171 being set;
assume L1099: C171 in ( rng D156 );
L1100: C171 in ( support D152 ) by L1099;
L1101: ( support D152 ) c= ( dom D152 ) by PRE_POLY:37;
consider C172 , C173 being Nat such that L1102: (C172 in ( NatDivisors C155 ) & C173 in ( NatDivisors C156 )) and L1103: C171 = ( C172 * C173 ) by L1101 , L1037 , L1097 , L1100 , L344;
reconsider D177 = C172 , D178 = C173 as non  zero Nat by L1102 , MOEBIUS1:39;
reconsider D179 = C172 , D180 = C173 as (Element of ( NAT )) by ORDINAL1:def 12;
L1104: D179 , D180 are_relative_prime  by L1037 , L1102 , L257;
L1105: ( D152 . C171 ) <> ( 0 ) by L1099 , PRE_POLY:def 7;
L1106: [ D179 , D180 ] in [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] by L1102 , ZFMISC_1:def 2;
set D181 = ( ( D155 " ) . [ D179 , D180 ] );
L1107: [ D179 , D180 ] in [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] by L1102 , ZFMISC_1:def 2;
L1108: ( D152 . C171 ) = ( C153 . C171 ) by L1097 , L1100 , L1101 , FUNCT_1:49
.= ( ( C153 . D177 ) * ( C153 . D178 ) ) by L1028 , L1103 , L1104 , L1025
.= ( ( multnat ) . (( C153 . D179 ) , ( C153 . D180 )) ) by BINOP_2:def 24
.= ( ( multnat ) . [ ( C153 . D179 ) , ( C153 . D180 ) ] ) by BINOP_1:def 1
.= ( ( multnat ) . ( [: C153 , C153 :] . (D179 , D180) ) ) by FUNCT_3:75
.= ( ( multnat ) . ( [: C153 , C153 :] . [ D179 , D180 ] ) ) by BINOP_1:def 1
.= ( ( ( multnat ) * [: C153 , C153 :] ) . [ D179 , D180 ] ) by L1054 , FUNCT_1:13
.= ( D153 . [ D179 , D180 ] ) by L1107 , FUNCT_1:49;
L1109: [ D179 , D180 ] in ( support D153 ) by L1108 , L1105 , PRE_POLY:def 7;
L1110: [ D179 , D180 ] in ( rng D155 ) by L1109 , FUNCT_2:def 3;
L1111: [ D179 , D180 ] in ( dom ( D155 " ) ) by L1110 , FUNCT_1:33;
L1112: D181 in ( rng ( D155 " ) ) by L1111 , FUNCT_1:3;
L1113: D181 in ( dom D155 ) by L1112 , FUNCT_1:33;
L1114: C171 = ( ( multnat ) . (D179 , D180) ) by L1103 , BINOP_2:def 24
.= ( ( multnat ) . [ D179 , D180 ] ) by BINOP_1:def 1
.= ( ( ( multnat ) | [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] ) . [ D179 , D180 ] ) by L1106 , FUNCT_1:49
.= ( D161 . ( D155 . ( ( D155 " ) . [ D179 , D180 ] ) ) ) by L1110 , FUNCT_1:35
.= ( ( D161 * D155 ) . D181 ) by L1113 , FUNCT_1:13;
L1115: ( D155 . ( ( D155 " ) . [ D179 , D180 ] ) ) = [ D179 , D180 ] by L1110 , FUNCT_1:35;
L1116: D181 in ( dom ( D161 * D155 ) ) by L1115 , L1036 , L1106 , L1113 , FUNCT_1:11;
thus L1117: C171 in ( rng ( D161 * D155 ) ) by L1116 , L1114 , FUNCT_1:def 3;
end;
L1118: ( rng D156 ) c= ( rng ( D161 * D155 ) ) by L1098 , TARSKI:def 3;
L1119: ( dom ( D156 " ) ) c= ( rng ( D161 * D155 ) ) by L1118 , FUNCT_1:33;
L1120: ( rng ( ( D156 " ) * ( D161 * D155 ) ) ) = ( rng ( D156 " ) ) by L1119 , RELAT_1:28;
L1121: ( rng ( ( D156 " ) * ( D161 * D155 ) ) ) = ( dom D156 ) by L1120 , FUNCT_1:33;
L1122: ( support D152 ) c= ( dom D152 ) by PRE_POLY:37;
L1123: ( rng D156 ) c= ( dom D152 ) by L1122 , FUNCT_2:def 3;
L1124: ( dom ( D152 * D156 ) ) = ( dom D156 ) by L1123 , RELAT_1:27;
L1125: ( rng D162 ) = ( dom C157 ) by L1124 , L1032 , L1121 , RELAT_1:36;
L1126: (for B128 being set holds (B128 in ( dom C158 ) iff (B128 in ( dom D162 ) & ( D162 . B128 ) in ( dom C157 )))) by L1125 , L1076 , FUNCT_1:3;
L1127: C158 = ( C157 * D162 ) by L1126 , L1077 , FUNCT_1:10;
L1128: C157 , C158 are_fiberwise_equipotent  by L1127 , L1076 , L1125 , CLASSES1:77;
thus L1129: ( C154 . ( C155 * C156 ) ) = ( Sum ( C153 | ( NatDivisors ( C155 * C156 ) ) ) ) by L1029
.= ( Sum ( ( ( multnat ) * [: C153 , C153 :] ) | [: ( NatDivisors C155 ) , ( NatDivisors C156 ) :] ) ) by L1031 , L1033 , L1128 , RFINSEQ:9
.= ( ( Sum ( C153 | ( NatDivisors C155 ) ) ) * ( Sum ( C153 | ( NatDivisors C156 ) ) ) ) by L828
.= ( ( Sum ( C153 | ( NatDivisors C155 ) ) ) * ( C154 . C156 ) ) by L1029
.= ( ( C154 . C155 ) * ( C154 . C156 ) ) by L1029;
end;
thus L1130: C154 is  multiplicative by L1030 , L1025;
end;
theorem
L1131: (for R1 being Nat holds ( EXP R1 ) is  multiplicative)
proof
let R1 being Nat;
L1132: (for B129 , B130 being non  zero Nat holds (B129 , B130 are_relative_prime  implies ( ( EXP R1 ) . ( B129 * B130 ) ) = ( ( ( EXP R1 ) . B129 ) * ( ( EXP R1 ) . B130 ) )))
proof
let C174 , C175 being non  zero Nat;
assume L1133: C174 , C175 are_relative_prime ;
thus L1134: ( ( EXP R1 ) . ( C174 * C175 ) ) = ( ( C174 * C175 ) |^ R1 ) by L835
.= ( ( C174 |^ R1 ) * ( C175 |^ R1 ) ) by NEWTON:7
.= ( ( ( EXP R1 ) . C174 ) * ( C175 |^ R1 ) ) by L835
.= ( ( ( EXP R1 ) . C174 ) * ( ( EXP R1 ) . C175 ) ) by L835;
end;
thus L1135: ( EXP R1 ) is  multiplicative by L1132 , L1025;
end;
theorem
L1136: (for R1 being Nat holds ( Sigma R1 ) is  multiplicative)
proof
let R1 being Nat;
L1137: (for B131 being non  zero Nat holds ( ( Sigma R1 ) . B131 ) = ( Sum ( ( EXP R1 ) | ( NatDivisors B131 ) ) ))
proof
let C176 being non  zero Nat;
thus L1138: ( ( Sigma R1 ) . C176 ) = ( sigma (R1 , C176) ) by L863
.= ( Sum ( ( EXP R1 ) | ( NatDivisors C176 ) ) ) by L849;
end;
thus L1139: ( Sigma R1 ) is  multiplicative by L1137 , L1027 , L1131;
end;
theorem
L1140: (for R6 being non  zero Nat holds (for R7 being non  zero Nat holds (R6 , R7 are_relative_prime  implies ( sigma ( R6 * R7 ) ) = ( ( sigma R6 ) * ( sigma R7 ) ))))
proof
let R6 being non  zero Nat;
let R7 being non  zero Nat;
assume L1141: R6 , R7 are_relative_prime ;
L1142: ( Sigma 1 ) is  multiplicative by L1136;
thus L1143: ( sigma ( R6 * R7 ) ) = ( ( Sigma 1 ) . ( R6 * R7 ) ) by L863
.= ( ( ( Sigma 1 ) . R6 ) * ( ( Sigma 1 ) . R7 ) ) by L1141 , L1142 , L1025
.= ( ( sigma (1 , R6) ) * ( ( Sigma 1 ) . R7 ) ) by L863
.= ( ( sigma R6 ) * ( sigma R7 ) ) by L863;
end;
begin
definition
let C177 being non  zero Nat;
attr C177 is  perfect
means
:L1144: ( sigma C177 ) = ( 2 * C177 );
end;
theorem
L1146: (for R5 being Nat holds (for R6 being non  zero Nat holds ((( ( 2 |^ R5 ) -' 1 ) is  prime & R6 = ( ( 2 |^ ( R5 -' 1 ) ) * ( ( 2 |^ R5 ) -' 1 ) )) implies R6 is  perfect)))
proof
let R5 being Nat;
let R6 being non  zero Nat;
set D182 = ( 2 |^ ( R5 -' 1 ) );
set D183 = ( R5 -' 2 );
L1147: ( ( ( 2 |^ R5 ) - 1 ) |^ 2 ) = ( ( ( 2 |^ R5 ) - 1 ) |^ ( 1 + 1 ) )
.= ( ( ( ( 2 |^ R5 ) - 1 ) |^ 1 ) * ( ( 2 |^ R5 ) - 1 ) ) by NEWTON:6
.= ( ( ( 2 |^ R5 ) - 1 ) * ( ( 2 |^ R5 ) - 1 ) ) by NEWTON:5
.= ( ( ( 2 |^ R5 ) - 1 ) ^2 ) by SQUARE_1:def 1
.= ( ( ( ( 2 |^ R5 ) ^2 ) - ( ( 2 * ( 2 |^ R5 ) ) * 1 ) ) + ( 1 ^2 ) ) by SQUARE_1:5
.= ( ( ( ( 2 |^ R5 ) * ( 2 |^ R5 ) ) - ( 2 * ( 2 |^ R5 ) ) ) + ( 1 ^2 ) ) by SQUARE_1:def 1
.= ( ( ( ( 2 |^ R5 ) * ( 2 |^ R5 ) ) - ( 2 * ( 2 |^ R5 ) ) ) + ( 1 * 1 ) ) by SQUARE_1:def 1
.= ( ( ( 2 |^ R5 ) * ( ( 2 |^ R5 ) - 2 ) ) + 1 );
L1148: ( 2 |^ R5 ) > R5 by NEWTON:86;
L1149: ( 2 |^ R5 ) >= ( R5 + 1 ) by L1148 , NAT_1:13;
L1150: ( ( 2 |^ R5 ) - 2 ) >= ( ( R5 + 1 ) - 2 ) by L1149 , XREAL_1:9;
assume L1151: ( ( 2 |^ R5 ) -' 1 ) is  prime;
L1152:
now
assume L1153: R5 <= 1;
per cases  by L1153 , NAT_1:25;
suppose L1154: R5 = ( 0 );

L1155: ( ( 2 |^ R5 ) -' 1 ) = ( 1 -' 1 ) by L1154 , NEWTON:4
.= ( 1 - 1 ) by XREAL_0:def 2
.= ( 0 );
thus L1156: contradiction by L1155 , L1151;
end;
suppose L1157: R5 = 1;

L1158: ( ( 2 |^ R5 ) -' 1 ) = ( 2 -' 1 ) by L1157 , NEWTON:5
.= ( 2 - 1 ) by XREAL_0:def 2
.= 1;
thus L1159: contradiction by L1158 , L1151 , INT_2:def 4;
end;
end;
L1161: ( R5 - 1 ) > ( 1 - 1 ) by L1152 , XREAL_1:9;
L1162: ( R5 -' 1 ) = ( R5 - 1 ) by L1161 , XREAL_0:def 2;
L1163: R5 >= ( 1 + 1 ) by L1152 , NAT_1:13;
L1164: ( R5 - 2 ) >= ( 2 - 2 ) by L1163 , XREAL_1:9;
L1165: D183 = ( R5 - 2 ) by L1164 , XREAL_0:def 2;
L1166: R5 = ( D183 + 2 ) by L1165;
L1167: ( 2 |^ R5 ) > 1 by L1152 , NEWTON:86 , XXREAL_0:2;
L1168: ( ( 2 |^ R5 ) - 1 ) > ( 1 - 1 ) by L1167 , XREAL_1:9;
L1169: ( ( 2 |^ R5 ) - 1 ) = ( ( 2 |^ R5 ) -' 1 ) by L1168 , XREAL_0:def 2;
reconsider D184 = ( ( 2 |^ R5 ) -' 1 ) as non  zero Nat by L1168 , XREAL_0:def 2;
assume L1170: R6 = ( ( 2 |^ ( R5 -' 1 ) ) * ( ( 2 |^ R5 ) -' 1 ) );
L1171: ( R5 -' 1 ) = ( D183 + 1 ) by L1161 , L1165 , XREAL_0:def 2;
L1172: D182 , D184 are_relative_prime  by L1171 , L1151 , L1169 , L1166 , L26 , EULER_1:2;
L1173: ( sigma R6 ) = ( ( sigma D182 ) * ( sigma D184 ) ) by L1172 , L1170 , L1140
.= ( ( ( ( 2 |^ ( ( R5 -' 1 ) + 1 ) ) - 1 ) / ( 2 - 1 ) ) * ( sigma D184 ) ) by L894 , INT_2:28
.= ( ( sigma ( D184 |^ 1 ) ) * ( ( 2 |^ R5 ) -' 1 ) ) by L1162 , L1169 , NEWTON:5
.= ( ( ( ( D184 |^ ( 1 + 1 ) ) - 1 ) / ( D184 - 1 ) ) * ( ( 2 |^ R5 ) -' 1 ) ) by L1151 , L894
.= ( ( 2 |^ ( ( R5 -' 1 ) + 1 ) ) * ( ( 2 |^ R5 ) -' 1 ) ) by L1161 , L1162 , L1169 , L1147 , L1150 , XCMPLX_1:89
.= ( ( ( 2 |^ ( R5 -' 1 ) ) * 2 ) * ( ( 2 |^ R5 ) -' 1 ) ) by NEWTON:6
.= ( 2 * R6 ) by L1170;
thus L1174: R6 is  perfect by L1173 , L1144;
end;
::$N The Perfect Number Theorem
theorem
L1175: (for R6 being non  zero Nat holds ((R6 is  even & R6 is  perfect) implies (ex B132 being Nat st (( ( 2 |^ B132 ) -' 1 ) is  prime & R6 = ( ( 2 |^ ( B132 -' 1 ) ) * ( ( 2 |^ B132 ) -' 1 ) )))))
proof
let R6 being non  zero Nat;
assume L1176: R6 is  even;
consider C178 , C179 being Nat such that L1177: C179 is  odd and L1178: C178 > ( 0 ) and L1179: R6 = ( ( 2 |^ C178 ) * C179 ) by L1176 , L41;
reconsider D185 = C179 as non  zero Nat by L1177;
set D186 = ( C178 + 1 );
L1180: ( D186 - 1 ) = ( D186 -' 1 ) by XREAL_0:def 2;
L1181: ( ( 2 |^ D186 ) - 1 ) = ( ( ( 2 |^ ( ( D186 -' 1 ) + 1 ) ) - 2 ) + 1 ) by L1180
.= ( ( ( ( 2 |^ ( D186 -' 1 ) ) * 2 ) - 2 ) + 1 ) by NEWTON:6
.= ( ( 2 * ( ( 2 |^ ( D186 -' 1 ) ) - 1 ) ) + 1 );
assume L1182: R6 is  perfect;
L1183: ( sigma R6 ) = ( 2 * R6 ) by L1182 , L1144;
take D186;
L1184: ( ( 2 |^ D186 ) - 1 ) > ( D186 - 1 ) by NEWTON:86 , XREAL_1:14;
L1185: ( ( 2 |^ D186 ) - 1 ) = ( ( 2 |^ D186 ) -' 1 ) by L1184 , XREAL_0:def 2;
L1186: ( sigma ( 2 |^ ( D186 -' 1 ) ) ) = ( ( ( 2 |^ ( ( D186 -' 1 ) + 1 ) ) - 1 ) / ( 2 - 1 ) ) by L894 , INT_2:28
.= ( ( 2 |^ D186 ) - 1 ) by L1180;
L1187: ( ( ( 2 |^ D186 ) - 1 ) * ( sigma C179 ) ) = ( ( 2 * ( 2 |^ ( D186 -' 1 ) ) ) * C179 ) by L1186 , L1177 , L1179 , L1183 , L1180 , L58 , L1140
.= ( ( 2 |^ D186 ) * C179 ) by L1180 , NEWTON:6;
L1188: ( ( 2 |^ D186 ) -' 1 ) divides ( ( 2 |^ D186 ) * D185 ) by L1187 , L1185 , INT_1:def 3;
L1189: ( ( 2 |^ D186 ) -' 1 ) divides D185 by L1188 , L1185 , L1181 , L58 , EULER_1:13;
consider C180 being Nat such that L1190: C179 = ( ( ( 2 |^ D186 ) -' 1 ) * C180 ) by L1189 , NAT_D:def 3;
L1191: ( ( sigma C179 ) * ( ( 2 |^ D186 ) - 1 ) ) = ( ( ( 2 |^ D186 ) * C180 ) * ( ( 2 |^ D186 ) - 1 ) ) by L1185 , L1187 , L1190;
L1192: ( sigma D185 ) = ( ( ( ( 2 |^ D186 ) - 1 ) * C180 ) + C180 ) by L1191 , L1184 , XCMPLX_1:5
.= ( C179 + C180 ) by L1184 , L1190 , XREAL_0:def 2;
L1193: C180 divides C179 by L1190 , NAT_D:def 3;
L1194: C178 >= ( ( 0 ) + 1 ) by L1178 , NAT_1:13;
L1195: ( C178 + 1 ) >= ( 1 + 1 ) by L1194 , XREAL_1:7;
L1196: ( 2 |^ D186 ) > 2 by L1195 , NEWTON:86 , XXREAL_0:2;
L1197: ( ( 2 |^ D186 ) - 1 ) > ( 2 - 1 ) by L1196 , XREAL_1:14;
L1198: ( ( ( 2 |^ D186 ) -' 1 ) * D185 ) > ( 1 * D185 ) by L1197 , L1185 , XREAL_1:68;
L1199: C180 = 1 by L1198 , L1190 , L1193 , L1192 , L989;
thus L1200: ( ( 2 |^ D186 ) -' 1 ) is  prime by L1199 , L1185 , L1190 , L1193 , L1197 , L1192 , L989;
thus L1201: R6 = ( ( 2 |^ ( D186 -' 1 ) ) * ( ( 2 |^ D186 ) -' 1 ) ) by L1179 , L1180 , L1190 , L1199;
end;
begin
definition
func Euler_phi -> (Function of ( NAT ) , ( NAT )) means 
:L1202: (for B133 being (Element of ( NAT )) holds ( it . B133 ) = ( Euler B133 ));
existence
proof
L1203: (ex B134 being (Function of ( NAT ) , ( NAT )) st (for B135 being (Element of ( NAT )) holds ( B134 . B135 ) = ( Euler B135 ))) from FUNCT_2:sch 4;
thus L1204: thesis by L1203;
end;
uniqueness
proof
L1205: (for B136 , B137 being (Function of ( NAT ) , ( NAT )) holds (((for B138 being (Element of ( NAT )) holds ( B136 . B138 ) = ( Euler B138 )) & (for B139 being (Element of ( NAT )) holds ( B137 . B139 ) = ( Euler B139 ))) implies B136 = B137)) from BINOP_2:sch 1;
let C181 , C182 being (Function of ( NAT ) , ( NAT ));
assume L1206: ((for B140 being (Element of ( NAT )) holds ( C181 . B140 ) = ( Euler B140 )) & (for B141 being (Element of ( NAT )) holds ( C182 . B141 ) = ( Euler B141 )));
thus L1207: thesis by L1206 , L1205;
end;
end;
theorem
L1209: (for R6 being non  zero Nat holds ( Sum ( ( Euler_phi ) | ( NatDivisors R6 ) ) ) = R6)
proof
let R6 being non  zero Nat;
L1210: (( dom ( Euler_phi ) ) = ( NAT ) & ( rng ( Euler_phi ) ) c= ( REAL )) by FUNCT_2:def 1;
reconsider D187 = ( Euler_phi ) as (Function of ( NAT ) , ( REAL )) by L1210 , FUNCT_2:2;
set D188 = ( Seg R6 );
defpred S8[ set , set ] means $2 = { B142 where B142 is (Element of ( NAT )) : (ex B143 being Nat st (B142 in D188 & $1 in ( NatDivisors R6 ) & B143 = $1 & ( B142 gcd R6 ) = ( R6 / B143 ))) };
L1211: ( dom ( Euler_phi ) ) = ( NAT ) by FUNCT_2:def 1;
L1212: (for B144 being Nat holds (B144 in D188 implies (ex B145 being (Element of ( bool D188 )) st S8[ B144 , B145 ])))
proof
let C183 being Nat;
set D189 = { B146 where B146 is (Element of ( NAT )) : (ex B147 being Nat st (B146 in D188 & C183 in ( NatDivisors R6 ) & B147 = C183 & ( B146 gcd R6 ) = ( R6 / B147 ))) };
L1213: (for B148 being set holds (B148 in D189 implies B148 in D188))
proof
let C184 being set;
assume L1214: C184 in D189;
L1215: (ex B149 being (Element of ( NAT )) st (B149 = C184 & (ex B150 being Nat st (B149 in D188 & C183 in ( NatDivisors R6 ) & B150 = C183 & ( B149 gcd R6 ) = ( R6 / B150 ))))) by L1214;
thus L1216: C184 in D188 by L1215;
end;
reconsider D190 = D189 as (Element of ( bool D188 )) by L1213 , TARSKI:def 3;
assume L1217: C183 in D188;
take D190;
thus L1218: S8[ C183 , D190 ];
end;
consider C185 being (FinSequence of ( bool D188 )) such that L1219: (( dom C185 ) = D188 & (for B151 being Nat holds (B151 in D188 implies S8[ B151 , ( C185 . B151 ) ]))) from FINSEQ_1:sch 5(L1212);
L1220: ( NatDivisors R6 ) c= ( Seg R6 ) by MOEBIUS1:40;
L1221: ( rng ( Sgm ( NatDivisors R6 ) ) ) c= ( dom C185 ) by L1220 , L1219 , FINSEQ_1:def 13;
L1222: ( rng ( Sgm ( NatDivisors R6 ) ) ) c= ( dom ( Card C185 ) ) by L1221 , CARD_3:def 2;
reconsider D191 = ( ( Card C185 ) * ( Sgm ( NatDivisors R6 ) ) ) as (FinSequence of ( NAT )) by L1222 , L160;
L1223: ( NatDivisors R6 ) c= ( dom C185 ) by L1219 , MOEBIUS1:40;
L1224: ( dom ( ( Card C185 ) * ( Sgm ( NatDivisors R6 ) ) ) ) = ( dom ( Sgm ( NatDivisors R6 ) ) ) by L1222 , RELAT_1:27
.= ( dom ( ( Euler_phi ) * ( Sgm ( NatDivisors R6 ) ) ) ) by L1221 , L1211 , RELAT_1:27 , XBOOLE_1:1;
L1225: (for B152 being (Element of ( NAT )) holds (B152 in ( dom ( ( Card C185 ) * ( Sgm ( NatDivisors R6 ) ) ) ) implies ( ( ( Card C185 ) * ( Sgm ( NatDivisors R6 ) ) ) . B152 ) = ( ( ( Euler_phi ) * ( Sgm ( NatDivisors R6 ) ) ) . B152 )))
proof
let C186 being (Element of ( NAT ));
set D192 = ( ( Sgm ( NatDivisors R6 ) ) . C186 );
set D193 = { B153 where B153 is (Element of ( NAT )) : (D192 , B153 are_relative_prime  & B153 >= 1 & B153 <= D192) };
set D194 = { B154 where B154 is (Element of ( NAT )) : (ex B155 being Nat st (B154 in D188 & D192 in ( NatDivisors R6 ) & B155 = D192 & ( B154 gcd R6 ) = ( R6 / B155 ))) };
deffunc H3(Nat) = ( ( $1 * R6 ) / D192 );
L1226: (for B156 being set holds (B156 in D193 implies B156 in ( NAT )))
proof
let C187 being set;
assume L1227: C187 in D193;
L1228: (ex B157 being (Element of ( NAT )) st (C187 = B157 & D192 , B157 are_relative_prime  & B157 >= 1 & B157 <= D192)) by L1227;
thus L1229: C187 in ( NAT ) by L1228;
end;
assume L1230: C186 in ( dom ( ( Card C185 ) * ( Sgm ( NatDivisors R6 ) ) ) );
L1231: C186 in ( dom ( Sgm ( NatDivisors R6 ) ) ) by L1230 , FUNCT_1:11;
L1232: D192 in ( rng ( Sgm ( NatDivisors R6 ) ) ) by L1231 , FUNCT_1:3;
L1233: D192 in ( NatDivisors R6 ) by L1232 , L1220 , FINSEQ_1:def 13;
L1234: 1 <= D192 by L1233 , L1219 , L1223 , FINSEQ_1:1;
L1235: D192 , 1 are_relative_prime  by WSIERP_1:9;
L1236: 1 in D193 by L1235 , L1234;
reconsider D195 = D193 as non  empty (Subset of ( NAT )) by L1236 , L1226 , TARSKI:def 3;
consider C188 being Function such that L1237: (( dom C188 ) = D195 & (for B158 being (Element of D195) holds ( C188 . B158 ) = H3(B158))) from FUNCT_1:sch 4;
L1238: (for B159 being set holds (B159 in ( rng C188 ) iff B159 in D194))
proof
let C189 being set;
thus L1239:now
assume L1240: C189 in ( rng C188 );
consider C190 being set such that L1241: C190 in ( dom C188 ) and L1242: C189 = ( C188 . C190 ) by L1240 , FUNCT_1:def 3;
reconsider D196 = C190 as (Element of D195) by L1237 , L1241;
L1243: ( 0 ) < D192 by L1233 , MOEBIUS1:39;
L1244: D192 divides R6 by L1233 , MOEBIUS1:39;
consider C191 being Nat such that L1245: R6 = ( D192 * C191 ) by L1244 , NAT_D:def 3;
L1246: C189 = H3(D196) by L1237 , L1242
.= ( D196 * ( R6 / D192 ) ) by XCMPLX_1:74;
L1247: C189 = ( D196 * ( C191 / ( D192 / D192 ) ) ) by L1246 , L1245 , XCMPLX_1:77
.= ( D196 * ( C191 / 1 ) ) by L1243 , XCMPLX_1:60
.= ( D196 * C191 );
reconsider D197 = C189 as (Element of ( NAT )) by L1247;
L1248: D196 in D195;
consider C192 being (Element of ( NAT )) such that L1249: D196 = C192 and L1250: D192 , C192 are_relative_prime  and L1251: C192 >= 1 and L1252: C192 <= D192 by L1248;
L1253: ( D196 * C191 ) <= ( D192 * C191 ) by L1249 , L1252 , XREAL_1:64;
L1254: C191 <> ( 0 ) by L1245;
L1255: ( C191 + 1 ) > ( ( 0 ) + 1 ) by L1254 , XREAL_1:6;
L1256: 1 <= C191 by L1255 , NAT_1:13;
L1257: ( 1 * 1 ) <= ( D196 * C191 ) by L1256 , L1249 , L1251 , XREAL_1:66;
L1258: D197 in D188 by L1257 , L1245 , L1247 , L1253;
L1259: ( D192 gcd C192 ) = 1 by L1250 , INT_2:def 3;
L1260: ( R6 / D192 ) = ( C191 / ( D192 / D192 ) ) by L1245 , XCMPLX_1:77
.= ( C191 / 1 ) by L1243 , XCMPLX_1:60;
L1261: ( D197 gcd R6 ) = ( R6 / D192 ) by L1260 , L1249 , L1245 , L1247 , L1259 , EULER_1:5;
thus L1262: C189 in D194 by L1261 , L1233 , L1258;
end;
assume L1263: C189 in D194;
consider C193 being (Element of ( NAT )) such that L1264: C193 = C189 and L1265: (ex B160 being Nat st (C193 in D188 & D192 in ( NatDivisors R6 ) & B160 = D192 & ( C193 gcd R6 ) = ( R6 / B160 ))) by L1263;
L1266: ( C193 gcd R6 ) divides C193 by INT_2:def 2;
consider C194 being Nat such that L1267: C193 = ( ( C193 gcd R6 ) * C194 ) by L1266 , NAT_D:def 3;
L1268: C189 = ( ( C194 * R6 ) / D192 ) by L1264 , L1265 , L1267 , XCMPLX_1:74;
reconsider D198 = C194 as (Element of ( NAT )) by ORDINAL1:def 12;
L1269: D192 <> ( 0 ) by L1265 , MOEBIUS1:39;
L1270: ( D192 * ( C193 gcd R6 ) ) = ( R6 / ( D192 / D192 ) ) by L1265 , XCMPLX_1:81
.= ( R6 / 1 ) by L1269 , XCMPLX_1:60;
L1271: D192 , D198 are_relative_prime  by L1270 , L1265 , L1267 , L1269 , EULER_1:6;
L1272: D198 <> ( 0 ) by L1265 , L1267 , FINSEQ_1:1;
L1273: ( D198 + 1 ) > ( ( 0 ) + 1 ) by L1272 , XREAL_1:6;
L1274: D198 >= 1 by L1273 , NAT_1:13;
L1275: C193 <= R6 by L1265 , FINSEQ_1:1;
L1276: D198 <= D192 by L1275 , L1265 , L1267 , L1269 , L1270 , XREAL_1:68;
L1277: D198 in ( dom C188 ) by L1276 , L1237 , L1271 , L1274;
reconsider D199 = D198 as (Element of D195) by L1277 , L1237;
L1278: C189 = ( C188 . D199 ) by L1237 , L1268;
thus L1279: C189 in ( rng C188 ) by L1278 , L1237 , FUNCT_1:def 3;
end;
L1280: ( rng C188 ) = D194 by L1238 , TARSKI:1;
L1281: (for B161 , B162 being set holds ((B161 in ( dom C188 ) & B162 in ( dom C188 ) & ( C188 . B161 ) = ( C188 . B162 )) implies B161 = B162))
proof
let C195 , C196 being set;
assume L1282: C195 in ( dom C188 );
reconsider D200 = C195 as (Element of D195) by L1282 , L1237;
assume L1283: C196 in ( dom C188 );
reconsider D201 = C196 as (Element of D195) by L1283 , L1237;
assume L1284: ( C188 . C195 ) = ( C188 . C196 );
L1285: H3(D200) = ( C188 . D200 ) by L1237
.= H3(D201) by L1237 , L1284;
L1286: ( D200 * ( R6 / D192 ) ) = ( ( D200 * R6 ) / D192 ) by XCMPLX_1:74
.= ( D201 * ( R6 / D192 ) ) by L1285 , XCMPLX_1:74;
thus L1287: C195 = C196 by L1286 , L1234 , XCMPLX_1:5;
end;
L1288: C188 is  one-to-one by L1281 , FUNCT_1:def 4;
L1289: D195 , D194 are_equipotent  by L1288 , L1237 , L1280 , WELLORD2:def 4;
L1290: ( C185 . D192 ) = D194 by L1219 , L1223 , L1233;
L1291: ( card ( C185 . D192 ) ) = ( card D195 ) by L1290 , L1289 , CARD_1:5;
L1292: ( ( Card C185 ) . D192 ) = ( Euler D192 ) by L1291 , L1223 , L1233 , CARD_3:def 2;
L1293: ( ( Card C185 ) . D192 ) = ( ( Euler_phi ) . D192 ) by L1292 , L1202;
L1294: ( ( ( Card C185 ) * ( Sgm ( NatDivisors R6 ) ) ) . C186 ) = ( ( Card C185 ) . D192 ) by L1230 , FUNCT_1:12;
thus L1295: thesis by L1294 , L1224 , L1230 , L1293 , FUNCT_1:12;
end;
L1296: ( ( Card C185 ) * ( Sgm ( NatDivisors R6 ) ) ) = ( ( Euler_phi ) * ( Sgm ( NatDivisors R6 ) ) ) by L1225 , L1224 , PARTFUN1:5;
set D202 = ( len C185 );
L1297: ( Func_Seq (( Euler_phi ) , ( Sgm ( NatDivisors R6 ) )) ) = ( ( Euler_phi ) * ( Sgm ( NatDivisors R6 ) ) ) by BHSP_5:def 4
.= ( Func_Seq (D187 , ( Sgm ( NatDivisors R6 ) )) ) by BHSP_5:def 4;
L1298: (for B163 being set holds (B163 in ( NatDivisors R6 ) iff (B163 in ( Seg R6 ) & (not B163 in ( ( Card C185 ) " { ( 0 ) } )))))
proof
reconsider D203 = ( 0 ) as (Element of ( NAT ));
let C197 being set;
L1299: D203 in { ( 0 ) } by TARSKI:def 1;
thus L1300:now
assume L1301: C197 in ( NatDivisors R6 );
reconsider D204 = C197 as (Element of ( NAT )) by L1301;
thus L1302: C197 in ( Seg R6 ) by L1220 , L1301;
assume L1303: C197 in ( ( Card C185 ) " { ( 0 ) } );
consider C198 being set such that L1304: ([ C197 , C198 ] in ( Card C185 ) & C198 in { ( 0 ) }) by L1303 , RELAT_1:def 14;
L1305: (C198 = ( 0 ) & C198 = ( ( Card C185 ) . C197 )) by L1304 , FUNCT_1:1 , TARSKI:def 1;
L1306: ( card ( C185 . C197 ) ) = ( {} ) by L1305 , L1219 , L1220 , L1301 , CARD_3:def 2;
L1307: ( C185 . C197 ) = ( {} ) by L1306;
L1308: D204 divides R6 by L1301 , MOEBIUS1:39;
consider C199 being Nat such that L1309: R6 = ( D204 * C199 ) by L1308 , NAT_D:def 3;
L1310: C199 <> ( 0 ) by L1309;
L1311: ( ( 0 ) + 1 ) < ( C199 + 1 ) by L1310 , XREAL_1:6;
L1312: 1 <= C199 by L1311 , NAT_1:13;
L1313: C199 divides R6 by L1309 , NAT_D:def 3;
L1314: C199 <= R6 by L1313 , NAT_D:7;
L1315: C199 in D188 by L1314 , L1312 , FINSEQ_1:1;
L1316: D204 <> ( 0 ) by L1309;
L1317: R6 = ( D204 * ( C199 gcd R6 ) ) by L1309 , L1313 , NEWTON:49;
L1318: ( R6 / D204 ) = ( ( C199 gcd R6 ) * ( D204 / D204 ) ) by L1317 , XCMPLX_1:74
.= ( ( C199 gcd R6 ) * 1 ) by L1316 , XCMPLX_1:60;
L1319: C199 in { B164 where B164 is (Element of ( NAT )) : (ex B165 being Nat st (B164 in D188 & D204 in ( NatDivisors R6 ) & B165 = D204 & ( B164 gcd R6 ) = ( R6 / B165 ))) } by L1318 , L1301 , L1315;
thus L1320: contradiction by L1319 , L1219 , L1220 , L1301 , L1307;
end;
assume L1321: C197 in ( Seg R6 );
reconsider D205 = C197 as (Element of ( NAT )) by L1321;
L1322: ( C185 . D205 ) = { B166 where B166 is (Element of ( NAT )) : (ex B167 being Nat st (B166 in D188 & D205 in ( NatDivisors R6 ) & B167 = D205 & ( B166 gcd R6 ) = ( R6 / B167 ))) } by L1219 , L1321;
assume L1323: (not C197 in ( ( Card C185 ) " { ( 0 ) } ));
assume L1324: (not C197 in ( NatDivisors R6 ));
L1325: ( C185 . D205 ) = ( {} )
proof
assume L1326: ( C185 . D205 ) <> ( {} );
consider C200 being set such that L1327: C200 in ( C185 . D205 ) by L1326 , XBOOLE_0:def 1;
L1328: (ex B168 being (Element of ( NAT )) st (C200 = B168 & (ex B169 being Nat st (B168 in D188 & D205 in ( NatDivisors R6 ) & B169 = D205 & ( B168 gcd R6 ) = ( R6 / B169 ))))) by L1322 , L1327;
thus L1329: contradiction by L1328 , L1324;
end;
L1330: D203 = ( ( Card C185 ) . C197 ) by L1325 , L1219 , L1321 , CARD_1:27 , CARD_3:def 2;
L1331: C197 in ( dom ( Card C185 ) ) by L1219 , L1321 , CARD_3:def 2;
L1332: [ D205 , D203 ] in ( Card C185 ) by L1331 , L1330 , FUNCT_1:1;
thus L1333: contradiction by L1332 , L1323 , L1299 , RELSET_1:30;
end;
reconsider D206 = ( Card C185 ) as (FinSequence of ( REAL )) by L254;
reconsider D207 = D191 as (FinSequence of ( REAL )) by L254;
L1334: ( NatDivisors R6 ) c= ( Seg R6 ) by MOEBIUS1:40;
L1335: ( Seg R6 ) = ( dom ( Card C185 ) ) by L1219 , CARD_3:def 2;
L1336: D207 = ( D206 - { ( 0 ) } ) by L1335 , L1298 , XBOOLE_0:def 5;
L1337: ( Sum D207 ) = ( Sum D206 ) by L1336 , L250;
L1338: (for B170 , B171 being Nat holds ((B170 in ( dom C185 ) & B171 in ( dom C185 ) & B170 <> B171) implies ( C185 . B170 ) misses ( C185 . B171 )))
proof
let C201 , C202 being Nat;
assume L1339: C201 in ( dom C185 );
L1340: ( C185 . C201 ) = { B172 where B172 is (Element of ( NAT )) : (ex B173 being Nat st (B172 in D188 & C201 in ( NatDivisors R6 ) & B173 = C201 & ( B172 gcd R6 ) = ( R6 / B173 ))) } by L1339 , L1219;
assume L1341: C202 in ( dom C185 );
L1342: ( C185 . C202 ) = { B174 where B174 is (Element of ( NAT )) : (ex B175 being Nat st (B174 in D188 & C202 in ( NatDivisors R6 ) & B175 = C202 & ( B174 gcd R6 ) = ( R6 / B175 ))) } by L1341 , L1219;
assume L1343: C201 <> C202;
assume L1344: (not ( C185 . C201 ) misses ( C185 . C202 ));
L1345: ( ( C185 . C201 ) /\ ( C185 . C202 ) ) <> ( {} ) by L1344 , XBOOLE_0:def 7;
consider C203 being set such that L1346: C203 in ( ( C185 . C201 ) /\ ( C185 . C202 ) ) by L1345 , XBOOLE_0:def 1;
L1347: C203 in ( C185 . C201 ) by L1346 , XBOOLE_0:def 4;
L1348: (ex B176 being (Element of ( NAT )) st (C203 = B176 & (ex B177 being Nat st (B176 in D188 & C201 in ( NatDivisors R6 ) & B177 = C201 & ( B176 gcd R6 ) = ( R6 / B177 ))))) by L1347 , L1340;
L1349: C203 in ( C185 . C202 ) by L1346 , XBOOLE_0:def 4;
L1350: (ex B178 being (Element of ( NAT )) st (C203 = B178 & (ex B179 being Nat st (B178 in D188 & C202 in ( NatDivisors R6 ) & B179 = C202 & ( B178 gcd R6 ) = ( R6 / B179 ))))) by L1349 , L1342;
L1351: C201 = ( R6 / ( R6 / C202 ) ) by L1350 , L1348 , XCMPLX_1:52;
thus L1352: contradiction by L1351 , L1343 , XCMPLX_1:52;
end;
L1353: (for B180 being set holds (B180 in ( union ( rng C185 ) ) iff B180 in D188))
proof
let C204 being set;
thus L1354: (C204 in ( union ( rng C185 ) ) implies C204 in D188);
assume L1355: C204 in D188;
reconsider D208 = C204 as Nat by L1355;
L1356: ( D208 gcd R6 ) divides R6 by NAT_D:def 5;
consider C205 being Nat such that L1357: R6 = ( ( D208 gcd R6 ) * C205 ) by L1356 , NAT_D:def 3;
L1358: ( 0 ) < C205 by L1357;
L1359: ( ( 0 ) + 1 ) < ( C205 + 1 ) by L1358 , XREAL_1:6;
L1360: 1 <= C205 by L1359 , NAT_1:13;
L1361: C205 divides R6 by L1357 , NAT_D:def 3;
L1362: C205 in ( NatDivisors R6 ) by L1361 , L1358 , MOEBIUS1:39;
set D209 = ( C185 . C205 );
L1363: C205 <> ( 0 ) by L1357;
L1364: C205 <= R6 by L1361 , NAT_D:7;
L1365: C205 in ( dom C185 ) by L1364 , L1219 , L1360 , FINSEQ_1:1;
L1366: D209 in ( rng C185 ) by L1365 , FUNCT_1:3;
L1367: ( C185 . C205 ) = { B181 where B181 is (Element of ( NAT )) : (ex B182 being Nat st (B181 in D188 & C205 in ( NatDivisors R6 ) & B182 = C205 & ( B181 gcd R6 ) = ( R6 / B182 ))) } by L1219 , L1365;
L1368: ( R6 / C205 ) = ( ( D208 gcd R6 ) * ( C205 / C205 ) ) by L1357 , XCMPLX_1:74
.= ( ( D208 gcd R6 ) * 1 ) by L1363 , XCMPLX_1:60;
L1369: C204 in D209 by L1368 , L1355 , L1362 , L1367;
thus L1370: C204 in ( union ( rng C185 ) ) by L1369 , L1366 , TARSKI:def 4;
end;
L1371: ( len C185 ) = D202;
L1372: ( card ( union ( rng C185 ) ) ) = ( Sum ( Card C185 ) ) by L1371 , L1338 , INT_5:48;
L1373: ( card D188 ) = ( Sum ( Card C185 ) ) by L1372 , L1353 , TARSKI:1;
L1374: ( card D188 ) = ( card R6 ) by FINSEQ_1:55;
L1375: R6 = ( Sum ( Card C185 ) ) by L1374 , L1373 , CARD_1:def 2;
L1376: ( Sum ( Func_Seq (( Euler_phi ) , ( Sgm ( NatDivisors R6 ) )) ) ) = R6 by L1375 , L1337 , L1296 , BHSP_5:def 4;
thus L1377: thesis by L1376 , L1297 , L1334 , L755;
end;
