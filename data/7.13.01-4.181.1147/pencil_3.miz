:: On the Characterization of Collineations of the Segre Product of Strongly
:: Connected Partial Linear Spaces
::  by Adam Naumowicz
::
:: Received October 18, 2004
:: Copyright (c) 2004-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, XBOOLE_0, STRUCT_0, PRE_TOPC, PENCIL_2, PENCIL_1,
      FUNCT_1, RELAT_1, TARSKI, SUBSET_1, PRALG_1, PBOOLE, ZFMISC_1, RELAT_2,
      FINSEQ_1, NAT_1, XXREAL_0, ARYTM_3, CARD_1, ARYTM_1, WAYBEL_3, RLVECT_2,
      CARD_3, INTEGRA1, FUNCT_4, FINSET_1, FDIFF_1, PARSP_1, GRAPH_2, FUNCT_2,
      CAT_1, RCOMP_1, FUNCOP_1, PENCIL_3;
 notations TARSKI, XBOOLE_0, ZFMISC_1, XCMPLX_0, XXREAL_0, NUMBERS, ORDINAL1,
      NAT_1, RELAT_1, SUBSET_1, FUNCT_1, FUNCT_2, FUNCOP_1, RELSET_1, CARD_1,
      FINSET_1, FINSEQ_1, CARD_3, DOMAIN_1, STRUCT_0, PRE_TOPC, PBOOLE,
      PZFMISC1, T_0TOPSP, PRALG_1, WAYBEL_3, PENCIL_1, FUNCT_7, PENCIL_2,
      TOPS_2, GRAPH_2;
 constructors PZFMISC1, TOPS_2, REALSET2, T_0TOPSP, GRAPH_2, PENCIL_2,
      RELSET_1, PBOOLE, FUNCT_7, PRE_POLY;
 registrations XBOOLE_0, SUBSET_1, RELSET_1, FUNCT_2, XXREAL_0, XREAL_0, NAT_1,
      CARD_1, PBOOLE, STRUCT_0, PENCIL_1, ORDINAL1, FUNCT_1, RELAT_1, FINSEQ_1,
      ZFMISC_1, PRE_POLY;
 requirements REAL, BOOLE, SUBSET, NUMERALS, ARITHM;
 definitions TARSKI, XBOOLE_0, PBOOLE, FUNCT_1, T_0TOPSP, STRUCT_0, RELAT_1;
 theorems XBOOLE_0, ZFMISC_1, FUNCT_1, FINSEQ_1, FINSEQ_3, NAT_1, CARD_3,
      PBOOLE, PRE_TOPC, FUNCT_7, PRALG_1, PZFMISC1, TARSKI, FUNCT_2, TOPS_2,
      PENCIL_1, PENCIL_2, CARD_1, XBOOLE_1, PUA2MSS1, FINSET_1, CARD_2,
      GRAPH_2, FUNCOP_1, RELAT_1, RELSET_1, XREAL_1, XXREAL_0, ORDINAL1,
      PARTFUN1;
 schemes TRANSGEO, NAT_1, FINSEQ_2, PENCIL_2, FINSEQ_1, PBOOLE, CLASSES1;

begin
theorem
L1: (for B1 being non  empty non  void TopStruct holds (for B2 being (Collineation of B1) holds (for B3 , B4 being (Point of B1) holds (B3 , B4 are_collinear  implies ( B2 . B3 ) , ( B2 . B4 ) are_collinear ))))
proof
let C1 being non  empty non  void TopStruct;
let C2 being (Collineation of C1);
L2: ( dom C2 ) = (the carrier of C1) by FUNCT_2:def 1;
let C3 , C4 being (Point of C1);
assume L3: C3 , C4 are_collinear ;
per cases ;
suppose L4: C3 = C4;

thus L5: thesis by L4 , PENCIL_1:def 1;
end;
suppose L6: C3 <> C4;

consider C5 being (Block of C1) such that L7: { C3 , C4 } c= C5 by L6 , L3 , PENCIL_1:def 1;
L8: C4 in C5 by L7 , ZFMISC_1:32;
L9: ( C2 . C4 ) in ( C2 .: C5 ) by L8 , L2 , FUNCT_1:def 6;
L10: C3 in C5 by L7 , ZFMISC_1:32;
L11: ( C2 . C3 ) in ( C2 .: C5 ) by L10 , L2 , FUNCT_1:def 6;
L12: { ( C2 . C3 ) , ( C2 . C4 ) } c= ( C2 .: C5 ) by L11 , L9 , ZFMISC_1:32;
thus L13: thesis by L12 , PENCIL_1:def 1;
end;
end;
theorem
L15: (for B5 being non  empty set holds (for B6 being (Element of B5) holds (for B7 being  non-Trivial-yielding  1-sorted-yielding (ManySortedSet of B5) holds ( B7 . B6 ) is non  trivial)))
proof
let C6 being non  empty set;
let C7 being (Element of C6);
let C8 being  non-Trivial-yielding  1-sorted-yielding (ManySortedSet of C6);
L16: ( dom C8 ) = C6 by PARTFUN1:def 2;
L17: ( C8 . C7 ) in ( rng C8 ) by L16 , FUNCT_1:3;
thus L18: thesis by L17 , PENCIL_1:def 17;
end;
theorem
L19: (for B8 being non  void  identifying_close_blocks TopStruct holds (B8 is  strongly_connected implies B8 is  without_isolated_points))
proof
let C9 being non  void  identifying_close_blocks TopStruct;
assume L20: C9 is  strongly_connected;
L21:
now
consider C10 being set such that L22: C10 in (the topology of C9) by XBOOLE_0:def 1;
reconsider D1 = C10 as (Block of C9) by L22;
reconsider D2 = D1 as (Subset of C9) by L22;
let C11 being (Point of C9);
L23: D2 is  closed_under_lines  strong by PENCIL_1:20 , PENCIL_1:21;
consider C12 being (FinSequence of ( bool (the carrier of C9) )) such that L24: D1 = ( C12 . 1 ) and L25: C11 in ( C12 . ( len C12 ) ) and L26: (for B9 being (Subset of C9) holds (B9 in ( rng C12 ) implies B9 is  closed_under_lines  strong)) and L27: (for B10 being Nat holds ((1 <= B10 & B10 < ( len C12 )) implies 2 c= ( card ( ( C12 . B10 ) /\ ( C12 . ( B10 + 1 ) ) ) ))) by L23 , L20 , PENCIL_1:def 11;
L28: ( len C12 ) in ( dom C12 ) by L25 , FUNCT_1:def 2;
reconsider D3 = ( ( len C12 ) - 1 ) as Nat by L28 , FINSEQ_3:26;
L29: ( C12 . ( len C12 ) ) in ( rng C12 ) by L28 , FUNCT_1:3;
reconsider D4 = ( C12 . ( len C12 ) ) as (Subset of C9) by L29;
L30: D4 is  closed_under_lines  strong by L26 , L29;
per cases ;
suppose L31: C11 in D1;

thus L32: (ex B11 being (Block of C9) st C11 in B11) by L31;
end;
suppose L33: (not C11 in D1);

L34: 1 <= ( len C12 ) by L28 , FINSEQ_3:25;
L35: 1 < ( ( ( len C12 ) - 1 ) + 1 ) by L34 , L24 , L25 , L33 , XXREAL_0:1;
L36: (1 <= D3 & D3 < ( len C12 )) by L35 , NAT_1:13;
L37: 2 c= ( card ( ( C12 . D3 ) /\ ( C12 . ( D3 + 1 ) ) ) ) by L36 , L27;
consider C13 being set such that L38: C13 in ( ( C12 . D3 ) /\ ( C12 . ( len C12 ) ) ) and L39: C13 <> C11 by L37 , PENCIL_1:3;
L40: C13 in D4 by L38 , XBOOLE_0:def 4;
reconsider D5 = C13 as (Point of C9) by L40;
L41: C11 , D5 are_collinear  by L25 , L30 , L40 , PENCIL_1:def 3;
consider C14 being (Block of C9) such that L42: { C11 , D5 } c= C14 by L41 , L39 , PENCIL_1:def 1;
L43: C11 in C14 by L42 , ZFMISC_1:32;
thus L44: (ex B12 being (Block of C9) st C11 in B12) by L43;
end;
end;
thus L46: thesis by L21 , PENCIL_1:def 9;
end;
theorem
L47: (for B13 being non  empty non  void  identifying_close_blocks TopStruct holds (B13 is  strongly_connected implies B13 is  connected))
proof
let C15 being non  empty non  void  identifying_close_blocks TopStruct;
assume L48: C15 is  strongly_connected;
L49: C15 is  without_isolated_points by L48 , L19;
thus L50: thesis by L49 , L48 , PENCIL_1:28;
end;
theorem
L51: (for B14 being non  void non  degenerated TopStruct holds (for B15 being (Block of B14) holds (ex B16 being (Point of B14) st (not B16 in B15))))
proof
let C16 being non  void non  degenerated TopStruct;
let C17 being (Block of C16);
L52: C17 in (the topology of C16);
L53:
now
assume L54: ( [#] C16 ) c= C17;
L55: ( [#] C16 ) = C17 by L54 , L52 , XBOOLE_0:def 10;
thus L56: contradiction by L55 , PENCIL_1:def 5;
end;
consider C18 being set such that L57: C18 in ( [#] C16 ) and L58: (not C18 in C17) by L53 , TARSKI:def 3;
reconsider D6 = C18 as (Point of C16) by L57;
take D6;
thus L59: thesis by L58;
end;
theorem
L60: (for B17 being non  empty set holds (for B18 being  non-Empty  TopStruct-yielding (ManySortedSet of B17) holds (for B19 being (Point of ( Segre_Product B18 )) holds B19 is (Element of ( Carrier B18 )))))
proof
let C19 being non  empty set;
let C20 being  non-Empty  TopStruct-yielding (ManySortedSet of C19);
let C21 being (Point of ( Segre_Product C20 ));
L61: ( Segre_Product C20 ) = TopStruct (# ( product ( Carrier C20 ) ) , ( Segre_Blocks C20 ) #) by PENCIL_1:def 23;
consider C22 being Function such that L62: C22 = C21 and L63: ( dom C22 ) = ( dom ( Carrier C20 ) ) and L64: (for B20 being set holds (B20 in ( dom ( Carrier C20 ) ) implies ( C22 . B20 ) in ( ( Carrier C20 ) . B20 ))) by L61 , CARD_3:def 5;
L65: ( dom C22 ) = C19 by L63 , PARTFUN1:def 2;
reconsider D7 = C22 as (ManySortedSet of C19) by L65 , PARTFUN1:def 2 , RELAT_1:def 18;
L66: (for B21 being set holds (B21 in C19 implies ( D7 . B21 ) is (Element of ( ( Carrier C20 ) . B21 )))) by L63 , L64 , L65;
thus L67: thesis by L66 , L62 , PBOOLE:def 14;
end;
theorem
L68: (for B22 being non  empty set holds (for B23 being  1-sorted-yielding (ManySortedSet of B22) holds (for B24 being (Element of B22) holds ( ( Carrier B23 ) . B24 ) = ( [#] ( B23 . B24 ) ))))
proof
let C23 being non  empty set;
let C24 being  1-sorted-yielding (ManySortedSet of C23);
let C25 being (Element of C23);
L69: (ex B25 being 1-sorted st (B25 = ( C24 . C25 ) & ( ( Carrier C24 ) . C25 ) = (the carrier of B25))) by PRALG_1:def 13;
thus L70: thesis by L69;
end;
theorem
L71: (for B26 being non  empty set holds (for B27 being (Element of B26) holds (for B28 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of B26) holds (ex B29 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B28 )) st (( indx B29 ) = B27 & ( product B29 ) is (Segre-Coset of B28))))))
proof
let C26 being non  empty set;
let C27 being (Element of C26);
let C28 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of C26);
set D8 = the (Point of ( Segre_Product C28 ));
L72: ( dom C28 ) = C26 by PARTFUN1:def 2;
L73: ( C28 . C27 ) in ( rng C28 ) by L72 , FUNCT_1:3;
L74: ( C28 . C27 ) is non  trivial by L73 , PENCIL_1:def 18;
reconsider D9 = ( [#] ( C28 . C27 ) ) as non  trivial set by L74;
reconsider D10 = D8 as (Element of ( Carrier C28 )) by L60;
reconsider D11 = { D10 } as (ManySortedSubset of ( Carrier C28 )) by PENCIL_1:11;
reconsider D12 = ( D11 +* (C27 , D9) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C28 )) by PENCIL_1:9 , PENCIL_1:10 , PENCIL_2:7;
take D12;
L75: ( dom D11 ) = C26 by PARTFUN1:def 2;
L76: ( D12 . C27 ) = D9 by L75 , FUNCT_7:31;
thus L77: ( indx D12 ) = C27 by L76 , PENCIL_1:def 21;
L78: ( product D12 ) c= (the carrier of ( Segre_Product C28 ))
proof
let C29 being set;
assume L79: C29 in ( product D12 );
consider C30 being Function such that L80: C29 = C30 and L81: ( dom C30 ) = ( dom D12 ) and L82: (for B30 being set holds (B30 in ( dom D12 ) implies ( C30 . B30 ) in ( D12 . B30 ))) by L79 , CARD_3:def 5;
L83: ( dom ( Carrier C28 ) ) = C26 by PARTFUN1:def 2;
L84: ( dom C30 ) = ( dom ( Carrier C28 ) ) by L83 , L81 , PARTFUN1:def 2;
L85:
now
let C31 being set;
assume L86: C31 in ( dom ( Carrier C28 ) );
reconsider D13 = C31 as (Element of C26) by L86;
L87: ( C30 . C31 ) in ( D12 . C31 ) by L81 , L82 , L84 , L86;
per cases ;
suppose L88: D13 = C27;

thus L89: ( C30 . C31 ) in ( ( Carrier C28 ) . C31 ) by L88 , L76 , L87 , L68;
end;
suppose L90: D13 <> C27;

L91: C26 = ( dom C28 ) by PARTFUN1:def 2;
L92: ( C28 . D13 ) in ( rng C28 ) by L91 , FUNCT_1:3;
L93: ( C28 . D13 ) is non  trivial by L92 , PENCIL_1:def 18;
reconsider D14 = (the carrier of ( C28 . D13 )) as non  trivial set by L93;
L94: ( C30 . D13 ) in ( D11 . D13 ) by L87 , L90 , FUNCT_7:32;
L95: ( C30 . D13 ) in { ( D10 . D13 ) } by L94 , PZFMISC1:def 1;
L96: ( C30 . D13 ) = ( D10 . D13 ) by L95 , TARSKI:def 1;
L97: ( C30 . D13 ) is (Element of ( ( Carrier C28 ) . D13 )) by L96 , PBOOLE:def 14;
L98: D14 is non  empty;
L99: ( [#] ( C28 . D13 ) ) is non  empty by L98;
L100: ( ( Carrier C28 ) . D13 ) is non  empty by L99 , L68;
thus L101: ( C30 . C31 ) in ( ( Carrier C28 ) . C31 ) by L100 , L97;
end;
end;
L103: ( Segre_Product C28 ) = TopStruct (# ( product ( Carrier C28 ) ) , ( Segre_Blocks C28 ) #) by PENCIL_1:def 23;
thus L104: thesis by L103 , L80 , L84 , L85 , CARD_3:def 5;
end;
thus L105: thesis by L78 , L76 , L77 , PENCIL_2:def 2;
end;
theorem
L106: (for B31 being non  empty set holds (for B32 being (Element of B31) holds (for B33 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of B31) holds (for B34 being (Point of ( Segre_Product B33 )) holds (ex B35 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B33 )) st (( indx B35 ) = B32 & ( product B35 ) is (Segre-Coset of B33) & B34 in ( product B35 )))))))
proof
let C32 being non  empty set;
let C33 being (Element of C32);
let C34 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of C32);
let C35 being (Point of ( Segre_Product C34 ));
L107: ( dom C34 ) = C32 by PARTFUN1:def 2;
L108: ( C34 . C33 ) in ( rng C34 ) by L107 , FUNCT_1:3;
L109: ( C34 . C33 ) is non  trivial by L108 , PENCIL_1:def 18;
reconsider D15 = ( [#] ( C34 . C33 ) ) as non  trivial set by L109;
reconsider D16 = C35 as (Element of ( Carrier C34 )) by L60;
reconsider D17 = { D16 } as (ManySortedSubset of ( Carrier C34 )) by PENCIL_1:11;
reconsider D18 = ( D17 +* (C33 , D15) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C34 )) by PENCIL_1:9 , PENCIL_1:10 , PENCIL_2:7;
take D18;
L110: ( dom D17 ) = C32 by PARTFUN1:def 2;
L111: ( D18 . C33 ) = D15 by L110 , FUNCT_7:31;
thus L112: ( indx D18 ) = C33 by L111 , PENCIL_1:def 21;
L113: ( product D18 ) c= (the carrier of ( Segre_Product C34 ))
proof
let C36 being set;
assume L114: C36 in ( product D18 );
consider C37 being Function such that L115: C36 = C37 and L116: ( dom C37 ) = ( dom D18 ) and L117: (for B36 being set holds (B36 in ( dom D18 ) implies ( C37 . B36 ) in ( D18 . B36 ))) by L114 , CARD_3:def 5;
L118: ( dom ( Carrier C34 ) ) = C32 by PARTFUN1:def 2;
L119: ( dom C37 ) = ( dom ( Carrier C34 ) ) by L118 , L116 , PARTFUN1:def 2;
L120:
now
let C38 being set;
assume L121: C38 in ( dom ( Carrier C34 ) );
reconsider D19 = C38 as (Element of C32) by L121;
L122: ( C37 . C38 ) in ( D18 . C38 ) by L116 , L117 , L119 , L121;
per cases ;
suppose L123: D19 = C33;

thus L124: ( C37 . C38 ) in ( ( Carrier C34 ) . C38 ) by L123 , L111 , L122 , L68;
end;
suppose L125: D19 <> C33;

L126: C32 = ( dom C34 ) by PARTFUN1:def 2;
L127: ( C34 . D19 ) in ( rng C34 ) by L126 , FUNCT_1:3;
L128: ( C34 . D19 ) is non  trivial by L127 , PENCIL_1:def 18;
reconsider D20 = (the carrier of ( C34 . D19 )) as non  trivial set by L128;
L129: ( C37 . D19 ) in ( D17 . D19 ) by L122 , L125 , FUNCT_7:32;
L130: ( C37 . D19 ) in { ( D16 . D19 ) } by L129 , PZFMISC1:def 1;
L131: ( C37 . D19 ) = ( D16 . D19 ) by L130 , TARSKI:def 1;
L132: ( C37 . D19 ) is (Element of ( ( Carrier C34 ) . D19 )) by L131 , PBOOLE:def 14;
L133: D20 is non  empty;
L134: ( [#] ( C34 . D19 ) ) is non  empty by L133;
L135: ( ( Carrier C34 ) . D19 ) is non  empty by L134 , L68;
thus L136: ( C37 . C38 ) in ( ( Carrier C34 ) . C38 ) by L135 , L132;
end;
end;
L138: ( Segre_Product C34 ) = TopStruct (# ( product ( Carrier C34 ) ) , ( Segre_Blocks C34 ) #) by PENCIL_1:def 23;
thus L139: thesis by L138 , L115 , L119 , L120 , CARD_3:def 5;
end;
thus L140: ( product D18 ) is (Segre-Coset of C34) by L113 , L111 , L112 , PENCIL_2:def 2;
L141: ( dom D17 ) = C32 by PARTFUN1:def 2;
L142:
now
let C39 being set;
assume L143: C39 in C32;
reconsider D21 = C39 as (Element of C32) by L143;
L144: ( dom C34 ) = C32 by PARTFUN1:def 2;
L145: ( C34 . C39 ) in ( rng C34 ) by L144 , L143 , FUNCT_1:def 3;
L146: ( C34 . C39 ) is non  trivial non  trivial non  trivial non  trivial 1-sorted by L145 , PENCIL_1:def 18;
reconsider D22 = (the carrier of ( C34 . D21 )) as non  trivial set by L146;
L147: D22 is non  empty;
per cases ;
suppose L148: C39 = C33;

L149: ( D16 . D21 ) is (Element of ( ( Carrier C34 ) . D21 )) by PBOOLE:def 14;
L150: ( D16 . D21 ) is (Element of ( [#] ( C34 . D21 ) )) by L149 , L68;
L151: ( D16 . D21 ) in (the carrier of ( C34 . D21 )) by L150 , L147;
thus L152: ( D16 . C39 ) in ( ( D17 +* (C33 , D15) ) . C39 ) by L151 , L141 , L148 , FUNCT_7:31;
end;
suppose L153: C39 <> C33;

L154: ( ( D17 +* (C33 , D15) ) . C39 ) = ( D17 . C39 ) by L153 , FUNCT_7:32;
L155: ( ( D17 +* (C33 , D15) ) . C39 ) = { ( D16 . C39 ) } by L154 , L143 , PZFMISC1:def 1;
thus L156: ( D16 . C39 ) in ( ( D17 +* (C33 , D15) ) . C39 ) by L155 , TARSKI:def 1;
end;
end;
L158: (( dom D16 ) = C32 & ( dom ( D17 +* (C33 , D15) ) ) = C32) by PARTFUN1:def 2;
thus L159: thesis by L158 , L142 , CARD_3:9;
end;
theorem
L160: (for B37 being non  empty set holds (for B38 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of B37) holds (for B39 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B38 )) holds (( product B39 ) is (Segre-Coset of B38) implies ( B39 . ( indx B39 ) ) = ( [#] ( B38 . ( indx B39 ) ) )))))
proof
let C40 being non  empty set;
let C41 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of C40);
let C42 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C41 ));
assume L161: ( product C42 ) is (Segre-Coset of C41);
consider C43 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C41 )) such that L162: ( product C42 ) = ( product C43 ) and L163: ( C43 . ( indx C43 ) ) = ( [#] ( C41 . ( indx C43 ) ) ) by L161 , PENCIL_2:def 2;
L164: C42 = C43 by L162 , PUA2MSS1:2;
thus L165: thesis by L164 , L163;
end;
theorem
L166: (for B40 being non  empty set holds (for B41 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of B40) holds (for B42 , B43 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B41 )) holds ((( product B42 ) is (Segre-Coset of B41) & ( product B43 ) is (Segre-Coset of B41) & ( indx B42 ) = ( indx B43 ) & ( product B42 ) meets ( product B43 )) implies B42 = B43))))
proof
let C44 being non  empty set;
let C45 being  non-Trivial-yielding  TopStruct-yielding (ManySortedSet of C44);
let C46 , C47 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C45 ));
assume that
L167: (( product C46 ) is (Segre-Coset of C45) & ( product C47 ) is (Segre-Coset of C45))
and
L168: ( indx C46 ) = ( indx C47 )
and
L169: ( product C46 ) meets ( product C47 );
reconsider D23 = ( product C46 ) , D24 = ( product C47 ) as (Segre-Coset of C45) by L167;
L170: ( D23 /\ D24 ) <> ( {} ) by L169 , XBOOLE_0:def 7;
consider C48 being set such that L171: C48 in ( D23 /\ D24 ) by L170 , XBOOLE_0:def 1;
L172: C48 in D24 by L171 , XBOOLE_0:def 4;
L173: C48 in D23 by L171 , XBOOLE_0:def 4;
reconsider D25 = C48 as (Element of ( Carrier C45 )) by L171 , L60;
consider C49 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C45 )) such that L174: D23 = ( product C49 ) and L175: ( C49 . ( indx C49 ) ) = ( [#] ( C45 . ( indx C49 ) ) ) by PENCIL_2:def 2;
consider C50 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C45 )) such that L176: D24 = ( product C50 ) and L177: ( C50 . ( indx C50 ) ) = ( [#] ( C45 . ( indx C50 ) ) ) by PENCIL_2:def 2;
L178: C50 = C47 by L176 , PUA2MSS1:2;
L179: ( dom C46 ) = C44 by PARTFUN1:def 2
.= ( dom C47 ) by PARTFUN1:def 2;
L180: C49 = C46 by L174 , PUA2MSS1:2;
L181:
now
let C51 being set;
assume L182: C51 in ( dom C46 );
reconsider D26 = C51 as (Element of C44) by L182;
per cases ;
suppose L183: D26 = ( indx C46 );

thus L184: ( C46 . C51 ) = ( C47 . C51 ) by L183 , L168 , L175 , L177 , L180 , L178;
end;
suppose L185: D26 <> ( indx C46 );

L186: ( C46 . D26 ) is non  empty  trivial by L185 , PENCIL_1:def 21;
L187: ( C46 . D26 ) is 1 -element by L186;
consider C52 being set such that L188: ( C46 . D26 ) = { C52 } by L187 , ZFMISC_1:131;
L189: ( C47 . D26 ) is non  empty  trivial by L168 , L185 , PENCIL_1:def 21;
L190: ( C47 . D26 ) is 1 -element by L189;
consider C53 being set such that L191: ( C47 . D26 ) = { C53 } by L190 , ZFMISC_1:131;
L192: ( D25 . D26 ) in ( C47 . D26 ) by L172 , L179 , L182 , CARD_3:9;
L193: ( D25 . D26 ) in ( C46 . D26 ) by L173 , L182 , CARD_3:9;
L194: C52 = ( D25 . D26 ) by L193 , L188 , TARSKI:def 1
.= C53 by L191 , L192 , TARSKI:def 1;
thus L195: ( C46 . C51 ) = ( C47 . C51 ) by L194 , L188 , L191;
end;
end;
thus L197: thesis by L181 , L179 , FUNCT_1:2;
end;
theorem
L198: (for B44 being non  empty set holds (for B45 being  PLS-yielding (ManySortedSet of B44) holds (for B46 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B45 )) holds (for B47 being (Block of ( B45 . ( indx B46 ) )) holds ( product ( B46 +* (( indx B46 ) , B47) ) ) is (Block of ( Segre_Product B45 ))))))
proof
let C54 being non  empty set;
let C55 being  PLS-yielding (ManySortedSet of C54);
let C56 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C55 ));
let C57 being (Block of ( C55 . ( indx C56 ) ));
L199: C57 in (the topology of ( C55 . ( indx C56 ) ));
reconsider D27 = C57 as (Subset of ( C55 . ( indx C56 ) )) by L199;
L200:
now
let C58 being (Element of C54);
assume L201: C58 <> ( indx C56 );
L202: ( ( C56 +* (( indx C56 ) , D27) ) . C58 ) = ( C56 . C58 ) by L201 , FUNCT_7:32;
thus L203: ( ( C56 +* (( indx C56 ) , D27) ) . C58 ) is 1 -element by L202 , L201 , PENCIL_1:12;
end;
L204: 2 c= ( card C57 ) by PENCIL_1:def 6;
L205: D27 is non  trivial by L204 , PENCIL_1:4;
reconsider D28 = ( C56 +* (( indx C56 ) , D27) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C55 )) by L205 , L200 , PENCIL_1:9 , PENCIL_1:def 20 , PENCIL_2:7;
L206:
now
assume L207: ( indx D28 ) <> ( indx C56 );
L208: ( D28 . ( indx D28 ) ) is 1 -element by L207 , L200;
thus L209: contradiction by L208 , PENCIL_1:def 21;
end;
L210: ( dom C56 ) = C54 by PARTFUN1:def 2;
L211: ( D28 . ( indx D28 ) ) = D27 by L210 , L206 , FUNCT_7:31;
thus L212: thesis by L211 , L206 , PENCIL_1:24;
end;
theorem
L213: (for B48 being non  empty set holds (for B49 being  PLS-yielding (ManySortedSet of B48) holds (for B50 being (Element of B48) holds (for B51 being (Point of ( B49 . B50 )) holds (for B52 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B49 )) holds (B50 <> ( indx B52 ) implies ( B52 +* (B50 , { B51 }) ) is  Segre-like non  trivial-yielding  Segre-like non  trivial-yielding  Segre-like non  trivial-yielding  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B49 ))))))))
proof
let C59 being non  empty set;
let C60 being  PLS-yielding (ManySortedSet of C59);
let C61 being (Element of C59);
let C62 being (Point of ( C60 . C61 ));
let C63 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C60 ));
L214:
now
let C64 being (Element of C59);
L215: ( dom C63 ) = C59 by PARTFUN1:def 2;
assume L216: C64 <> ( indx C63 );
per cases ;
suppose L217: C64 = C61;

thus L218: ( ( C63 +* (C61 , { C62 }) ) . C64 ) is 1 -element by L217 , L215 , FUNCT_7:31;
end;
suppose L219: C64 <> C61;

L220: ( ( C63 +* (C61 , { C62 }) ) . C64 ) = ( C63 . C64 ) by L219 , FUNCT_7:32;
thus L221: ( ( C63 +* (C61 , { C62 }) ) . C64 ) is 1 -element by L220 , L216 , PENCIL_1:12;
end;
end;
L223: ( C63 +* (C61 , { C62 }) ) c= ( Carrier C60 )
proof
let C65 being set;
assume L224: C65 in C59;
reconsider D29 = C65 as (Element of C59) by L224;
L225: D29 in ( dom C63 ) by L224 , PARTFUN1:def 2;
per cases ;
suppose L226: C65 = C61;

L227: ( ( C63 +* (C61 , { C62 }) ) . D29 ) = { C62 } by L226 , L225 , FUNCT_7:31;
L228: ( ( C63 +* (C61 , { C62 }) ) . D29 ) c= ( [#] ( C60 . D29 ) ) by L227 , L226;
thus L229: thesis by L228 , L68;
end;
suppose L230: C65 <> C61;

L231: C63 c= ( Carrier C60 ) by PBOOLE:def 18;
L232: ( ( C63 +* (C61 , { C62 }) ) . D29 ) = ( C63 . D29 ) by L230 , FUNCT_7:32;
thus L233: thesis by L232 , L231 , PBOOLE:def 2;
end;
end;
assume L235: C61 <> ( indx C63 );
L236: ( ( C63 +* (C61 , { C62 }) ) . ( indx C63 ) ) = ( C63 . ( indx C63 ) ) by L235 , FUNCT_7:32;
L237: ( ( C63 +* (C61 , { C62 }) ) . ( indx C63 ) ) is non  trivial by L236 , PENCIL_1:def 21;
L238: ( dom ( C63 +* (C61 , { C62 }) ) ) = C59 by PARTFUN1:def 2;
L239: ( ( C63 +* (C61 , { C62 }) ) . ( indx C63 ) ) in ( rng ( C63 +* (C61 , { C62 }) ) ) by L238 , FUNCT_1:3;
thus L240: thesis by L239 , L223 , L214 , L237 , PBOOLE:def 18 , PENCIL_1:def 16 , PENCIL_1:def 20;
end;
theorem
L241: (for B53 being non  empty set holds (for B54 being  PLS-yielding (ManySortedSet of B53) holds (for B55 being (Element of B53) holds (for B56 being (Subset of ( B54 . B55 )) holds (for B57 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B54 )) holds ( product ( B57 +* (B55 , B56) ) ) is (Subset of ( Segre_Product B54 )))))))
proof
let C66 being non  empty set;
let C67 being  PLS-yielding (ManySortedSet of C66);
let C68 being (Element of C66);
let C69 being (Subset of ( C67 . C68 ));
let C70 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C67 ));
L242: ( dom ( C70 +* (C68 , C69) ) ) = C66 by PARTFUN1:def 2
.= ( dom ( Carrier C67 ) ) by PARTFUN1:def 2;
L243:
now
let C71 being set;
assume L244: C71 in ( dom ( C70 +* (C68 , C69) ) );
L245: C71 in C66 by L244;
L246: C71 in ( dom C70 ) by L245 , PARTFUN1:def 2;
per cases ;
suppose L247: C71 = C68;

L248: ( ( C70 +* (C68 , C69) ) . C71 ) = C69 by L247 , L246 , FUNCT_7:31;
L249: ( ( C70 +* (C68 , C69) ) . C71 ) c= ( [#] ( C67 . C68 ) ) by L248;
thus L250: ( ( C70 +* (C68 , C69) ) . C71 ) c= ( ( Carrier C67 ) . C71 ) by L249 , L247 , L68;
end;
suppose L251: C71 <> C68;

L252: C70 c= ( Carrier C67 ) by PBOOLE:def 18;
L253: ( ( C70 +* (C68 , C69) ) . C71 ) = ( C70 . C71 ) by L251 , FUNCT_7:32;
thus L254: ( ( C70 +* (C68 , C69) ) . C71 ) c= ( ( Carrier C67 ) . C71 ) by L253 , L245 , L252 , PBOOLE:def 2;
end;
end;
L256: ( Segre_Product C67 ) = TopStruct (# ( product ( Carrier C67 ) ) , ( Segre_Blocks C67 ) #) by PENCIL_1:def 23;
thus L257: thesis by L256 , L242 , L243 , CARD_3:27;
end;
theorem
L258: (for B58 being non  empty set holds (for B59 being (ManySortedSet of B58) holds (for B60 being (Element of B58) holds ( { B59 } . B60 ) is 1 -element)))
proof
let C72 being non  empty set;
let C73 being (ManySortedSet of C72);
let C74 being (Element of C72);
L259: ( { C73 } . C74 ) = { ( C73 . C74 ) } by PZFMISC1:def 1;
thus L260: thesis by L259;
end;
theorem
L261: (for B61 being non  empty set holds (for B62 being (Element of B61) holds (for B63 being  PLS-yielding (ManySortedSet of B61) holds (for B64 being (Block of ( B63 . B62 )) holds (for B65 being (Element of ( Carrier B63 )) holds ( product ( { B65 } +* (B62 , B64) ) ) is (Block of ( Segre_Product B63 )))))))
proof
let C75 being non  empty set;
let C76 being (Element of C75);
let C77 being  PLS-yielding (ManySortedSet of C75);
let C78 being (Block of ( C77 . C76 ));
let C79 being (Element of ( Carrier C77 ));
reconsider D30 = { C79 } as (ManySortedSubset of ( Carrier C77 )) by PENCIL_1:11;
L262: C78 in (the topology of ( C77 . C76 ));
reconsider D31 = C78 as (Subset of ( C77 . C76 )) by L262;
L263:
now
let C80 being (Element of C75);
assume L264: C80 <> C76;
L265: ( ( { C79 } +* (C76 , D31) ) . C80 ) = ( { C79 } . C80 ) by L264 , FUNCT_7:32;
thus L266: ( ( { C79 } +* (C76 , D31) ) . C80 ) is 1 -element by L265 , L258;
end;
L267: 2 c= ( card C78 ) by PENCIL_1:def 6;
L268: D31 is non  trivial by L267 , PENCIL_1:4;
reconsider D32 = ( D30 +* (C76 , D31) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C77 )) by L268 , L263 , PENCIL_1:9 , PENCIL_1:def 20 , PENCIL_2:7;
L269:
now
assume L270: ( indx D32 ) <> C76;
L271: ( D32 . ( indx D32 ) ) is 1 -element by L270 , L263;
thus L272: contradiction by L271 , PENCIL_1:def 21;
end;
L273: ( dom { C79 } ) = C75 by PARTFUN1:def 2;
L274: ( D32 . ( indx D32 ) ) = D31 by L273 , L269 , FUNCT_7:31;
thus L275: thesis by L274 , L269 , PENCIL_1:24;
end;
theorem
L276: (for B66 being non  empty set holds (for B67 being  PLS-yielding (ManySortedSet of B66) holds (for B68 , B69 being (Point of ( Segre_Product B67 )) holds (B68 <> B69 implies (B68 , B69 are_collinear  iff (for B70 , B71 being (ManySortedSet of B66) holds ((B70 = B68 & B71 = B69) implies (ex B72 being (Element of B66) st ((for B73 , B74 being (Point of ( B67 . B72 )) holds ((B73 = ( B70 . B72 ) & B74 = ( B71 . B72 )) implies (B73 <> B74 & B73 , B74 are_collinear ))) & (for B75 being (Element of B66) holds (B75 <> B72 implies ( B70 . B75 ) = ( B71 . B75 ))))))))))))
proof
let C81 being non  empty set;
let C82 being  PLS-yielding (ManySortedSet of C81);
let C83 , C84 being (Point of ( Segre_Product C82 ));
assume L277: C83 <> C84;
thus L278: (C83 , C84 are_collinear  implies (for B76 , B77 being (ManySortedSet of C81) holds ((B76 = C83 & B77 = C84) implies (ex B78 being (Element of C81) st ((for B79 , B80 being (Point of ( C82 . B78 )) holds ((B79 = ( B76 . B78 ) & B80 = ( B77 . B78 )) implies (B79 <> B80 & B79 , B80 are_collinear ))) & (for B81 being (Element of C81) holds (B81 <> B78 implies ( B76 . B81 ) = ( B77 . B81 ))))))))
proof
assume L279: C83 , C84 are_collinear ;
consider C85 being (Block of ( Segre_Product C82 )) such that L280: { C83 , C84 } c= C85 by L279 , L277 , PENCIL_1:def 1;
let C86 , C87 being (ManySortedSet of C81);
assume that
L281: C86 = C83
and
L282: C87 = C84;
L283: C87 in C85 by L280 , L282 , ZFMISC_1:32;
consider C88 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C82 )) such that L284: C85 = ( product C88 ) and L285: ( C88 . ( indx C88 ) ) is (Block of ( C82 . ( indx C88 ) )) by PENCIL_1:24;
take D33 = ( indx C88 );
L286: C86 in C85 by L280 , L281 , ZFMISC_1:32;
thus L287: (for B82 , B83 being (Point of ( C82 . D33 )) holds ((B82 = ( C86 . D33 ) & B83 = ( C87 . D33 )) implies (B82 <> B83 & B82 , B83 are_collinear )))
proof
reconsider D34 = ( C88 . ( indx C88 ) ) as (Block of ( C82 . ( indx C88 ) )) by L285;
let C89 , C90 being (Point of ( C82 . D33 ));
L288: (ex B84 being Function st (B84 = C86 & ( dom B84 ) = ( dom C88 ) & (for B85 being set holds (B85 in ( dom C88 ) implies ( B84 . B85 ) in ( C88 . B85 ))))) by L284 , L286 , CARD_3:def 5;
L289: (ex B86 being Function st (B86 = C87 & ( dom B86 ) = ( dom C88 ) & (for B87 being set holds (B87 in ( dom C88 ) implies ( B86 . B87 ) in ( C88 . B87 ))))) by L284 , L283 , CARD_3:def 5;
assume L290: (C89 = ( C86 . D33 ) & C90 = ( C87 . D33 ));
L291:
now
assume L292: C89 = C90;
L293:
now
let C91 being set;
assume L294: C91 in ( dom C86 );
reconsider D35 = C91 as (Element of C81) by L294;
per cases ;
suppose L295: D35 = D33;

thus L296: ( C86 . C91 ) = ( C87 . C91 ) by L295 , L290 , L292;
end;
suppose L297: D35 <> D33;

L298: ( C88 . D35 ) is 1 -element by L297 , PENCIL_1:12;
consider C92 being set such that L299: ( C88 . D35 ) = { C92 } by L298 , ZFMISC_1:131;
L300: ( C86 . C91 ) in { C92 } by L288 , L294 , L299;
L301: ( C86 . C91 ) = C92 by L300 , TARSKI:def 1;
L302: ( C87 . C91 ) in { C92 } by L288 , L289 , L294 , L299;
thus L303: ( C86 . C91 ) = ( C87 . C91 ) by L302 , L301 , TARSKI:def 1;
end;
end;
L305: ( dom C86 ) = C81 by PARTFUN1:def 2
.= ( dom C87 ) by PARTFUN1:def 2;
thus L306: contradiction by L305 , L277 , L281 , L282 , L293 , FUNCT_1:2;
end;
thus L307: C89 <> C90 by L291;
L308: ( dom C88 ) = C81 by PARTFUN1:def 2;
L309: ( C87 . D33 ) in D34 by L308 , L289;
L310: ( C86 . D33 ) in D34 by L288 , L308;
L311: { C89 , C90 } c= D34 by L310 , L290 , L309 , ZFMISC_1:32;
thus L312: thesis by L311 , PENCIL_1:def 1;
end;

let C93 being (Element of C81);
assume L313: C93 <> D33;
thus L314: thesis by L313 , L284 , L286 , L283 , PENCIL_1:23;
end;

reconsider D36 = C83 , D37 = C84 as (Element of ( Carrier C82 )) by L60;
assume L315: (for B88 , B89 being (ManySortedSet of C81) holds ((B88 = C83 & B89 = C84) implies (ex B90 being (Element of C81) st ((for B91 , B92 being (Point of ( C82 . B90 )) holds ((B91 = ( B88 . B90 ) & B92 = ( B89 . B90 )) implies (B91 <> B92 & B91 , B92 are_collinear ))) & (for B93 being (Element of C81) holds (B93 <> B90 implies ( B88 . B93 ) = ( B89 . B93 )))))));
consider C94 being (Element of C81) such that L316: (for B94 , B95 being (Point of ( C82 . C94 )) holds ((B94 = ( D36 . C94 ) & B95 = ( D37 . C94 )) implies (B94 <> B95 & B94 , B95 are_collinear ))) and L317: (for B96 being (Element of C81) holds (B96 <> C94 implies ( D36 . B96 ) = ( D37 . B96 ))) by L315;
L318: ( D37 . C94 ) is (Element of ( ( Carrier C82 ) . C94 )) by PBOOLE:def 14;
L319: ( D37 . C94 ) is (Element of ( [#] ( C82 . C94 ) )) by L318 , L68;
reconsider D38 = ( D37 . C94 ) as (Point of ( C82 . C94 )) by L319;
L320: ( D36 . C94 ) is (Element of ( ( Carrier C82 ) . C94 )) by PBOOLE:def 14;
L321: ( D36 . C94 ) is (Element of ( [#] ( C82 . C94 ) )) by L320 , L68;
reconsider D39 = ( D36 . C94 ) as (Point of ( C82 . C94 )) by L321;
L322: D39 , D38 are_collinear  by L316;
per cases  by L322 , PENCIL_1:def 1;
suppose L323: D39 = D38;

thus L324: thesis by L323 , L316;
end;
suppose L325: (ex B97 being (Block of ( C82 . C94 )) st { D39 , D38 } c= B97);

consider C95 being (Block of ( C82 . C94 )) such that L326: { D39 , D38 } c= C95 by L325;
reconsider D40 = ( product ( { D36 } +* (C94 , C95) ) ) as (Block of ( Segre_Product C82 )) by L261;
L327: ( dom ( { D36 } +* (C94 , C95) ) ) = C81 by PARTFUN1:def 2;
L328: ( dom { D36 } ) = ( dom ( { D36 } +* (C94 , C95) ) ) by L327 , PARTFUN1:def 2;
L329: (for B98 being set holds (B98 in ( dom ( { D36 } +* (C94 , C95) ) ) implies ( D37 . B98 ) in ( ( { D36 } +* (C94 , C95) ) . B98 )))
proof
let C96 being set;
assume L330: C96 in ( dom ( { D36 } +* (C94 , C95) ) );
reconsider D41 = C96 as (Element of C81) by L330;
per cases ;
suppose L331: D41 = C94;

L332: ( ( { D36 } +* (C94 , C95) ) . C96 ) = C95 by L331 , L328 , L330 , FUNCT_7:31;
thus L333: thesis by L332 , L326 , L331 , ZFMISC_1:32;
end;
suppose L334: D41 <> C94;

L335: ( ( { D36 } +* (C94 , C95) ) . C96 ) = ( { D36 } . C96 ) by L334 , FUNCT_7:32;
L336: ( ( { D36 } +* (C94 , C95) ) . C96 ) = { ( D36 . C96 ) } by L335 , L330 , PZFMISC1:def 1;
L337: ( ( { D36 } +* (C94 , C95) ) . C96 ) = { ( D37 . D41 ) } by L336 , L317 , L334;
thus L338: thesis by L337 , TARSKI:def 1;
end;
end;
L340: (for B99 being set holds (B99 in ( dom ( { D36 } +* (C94 , C95) ) ) implies ( D36 . B99 ) in ( ( { D36 } +* (C94 , C95) ) . B99 )))
proof
let C97 being set;
assume L341: C97 in ( dom ( { D36 } +* (C94 , C95) ) );
per cases ;
suppose L342: C97 = C94;

L343: ( ( { D36 } +* (C94 , C95) ) . C97 ) = C95 by L342 , L328 , L341 , FUNCT_7:31;
thus L344: thesis by L343 , L326 , L342 , ZFMISC_1:32;
end;
suppose L345: C97 <> C94;

L346: ( ( { D36 } +* (C94 , C95) ) . C97 ) = ( { D36 } . C97 ) by L345 , FUNCT_7:32;
L347: ( ( { D36 } +* (C94 , C95) ) . C97 ) = { ( D36 . C97 ) } by L346 , L341 , PZFMISC1:def 1;
thus L348: thesis by L347 , TARSKI:def 1;
end;
end;
L350: ( dom D37 ) = ( dom ( { D36 } +* (C94 , C95) ) ) by L327 , PARTFUN1:def 2;
L351: C84 in D40 by L350 , L329 , CARD_3:def 5;
L352: ( dom D36 ) = ( dom ( { D36 } +* (C94 , C95) ) ) by L327 , PARTFUN1:def 2;
L353: C83 in D40 by L352 , L340 , CARD_3:def 5;
L354: { C83 , C84 } c= D40 by L353 , L351 , ZFMISC_1:32;
thus L355: thesis by L354 , PENCIL_1:def 1;
end;
end;
theorem
L357: (for B100 being non  empty set holds (for B101 being  PLS-yielding (ManySortedSet of B100) holds (for B102 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B101 )) holds (for B103 being (Point of ( B101 . ( indx B102 ) )) holds (ex B104 being (ManySortedSet of B100) st (B104 in ( product B102 ) & { (( B104 +* (( indx B102 ) , B103) ) qua set) } = ( product ( B102 +* (( indx B102 ) , { B103 }) ) )))))))
proof
let C98 being non  empty set;
let C99 being  PLS-yielding (ManySortedSet of C98);
let C100 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C99 ));
set D42 = ( indx C100 );
let C101 being (Point of ( C99 . D42 ));
consider C102 being set such that L358: C102 in ( product C100 ) by XBOOLE_0:def 1;
L359: (ex B105 being Function st (B105 = C102 & ( dom B105 ) = ( dom C100 ) & (for B106 being set holds (B106 in ( dom C100 ) implies ( B105 . B106 ) in ( C100 . B106 ))))) by L358 , CARD_3:def 5;
L360: ( dom C100 ) = C98 by PARTFUN1:def 2;
reconsider D43 = C102 as (ManySortedSet of C98) by L360 , L359 , PARTFUN1:def 2 , RELAT_1:def 18;
take D44 = D43;
thus L361: D44 in ( product C100 ) by L358;
set D45 = ( D43 +* (D42 , C101) );
thus L362: { (( D44 +* (D42 , C101) ) qua set) } = ( product ( C100 +* (D42 , { C101 }) ) )
proof
thus L363: { (( D44 +* (D42 , C101) ) qua set) } c= ( product ( C100 +* (D42 , { C101 }) ) )
proof
L364:
now
let C103 being set;
assume L365: C103 in ( dom ( C100 +* (D42 , { C101 }) ) );
L366: C103 in C98 by L365;
L367: C103 in ( dom D43 ) by L366 , PARTFUN1:def 2;
per cases ;
suppose L368: C103 = D42;

L369: ( D45 . C103 ) = C101 by L368 , L367 , FUNCT_7:31;
L370: ( D45 . C103 ) in { C101 } by L369 , TARSKI:def 1;
thus L371: ( D45 . C103 ) in ( ( C100 +* (D42 , { C101 }) ) . C103 ) by L370 , L360 , L368 , FUNCT_7:31;
end;
suppose L372: C103 <> D42;

L373: ( D45 . C103 ) = ( D43 . C103 ) by L372 , FUNCT_7:32;
L374: ( D45 . C103 ) in ( C100 . C103 ) by L373 , L358 , L360 , L366 , CARD_3:9;
thus L375: ( D45 . C103 ) in ( ( C100 +* (D42 , { C101 }) ) . C103 ) by L374 , L372 , FUNCT_7:32;
end;
end;
let C104 being set;
assume L377: C104 in { (( D44 +* (D42 , C101) ) qua set) };
L378: C104 = D45 by L377 , TARSKI:def 1;
L379: ( dom D45 ) = C98 by PARTFUN1:def 2
.= ( dom ( C100 +* (D42 , { C101 }) ) ) by PARTFUN1:def 2;
thus L380: thesis by L379 , L378 , L364 , CARD_3:9;
end;

let C105 being set;
assume L381: C105 in ( product ( C100 +* (D42 , { C101 }) ) );
consider C106 being Function such that L382: C106 = C105 and L383: ( dom C106 ) = ( dom ( C100 +* (D42 , { C101 }) ) ) and L384: (for B107 being set holds (B107 in ( dom ( C100 +* (D42 , { C101 }) ) ) implies ( C106 . B107 ) in ( ( C100 +* (D42 , { C101 }) ) . B107 ))) by L381 , CARD_3:def 5;
L385:
now
let C107 being set;
assume L386: C107 in ( dom C106 );
L387: C107 in C98 by L386 , L383;
reconsider D46 = C107 as (Element of C98) by L383 , L386;
L388: ( C106 . C107 ) in ( ( C100 +* (D42 , { C101 }) ) . C107 ) by L383 , L384 , L386;
per cases ;
suppose L389: D46 = D42;

L390: ( C106 . C107 ) in { C101 } by L389 , L360 , L388 , FUNCT_7:31;
L391: ( C106 . C107 ) = C101 by L390 , TARSKI:def 1;
thus L392: ( C106 . C107 ) = ( D45 . C107 ) by L391 , L359 , L360 , L389 , FUNCT_7:31;
end;
suppose L393: D46 <> D42;

L394: ( C100 . D46 ) is non  empty  trivial by L393 , PENCIL_1:def 21;
L395: ( C100 . D46 ) is 1 -element by L394;
consider C108 being set such that L396: ( C100 . C107 ) = { C108 } by L395 , ZFMISC_1:131;
L397: ( C106 . C107 ) in ( C100 . C107 ) by L388 , L393 , FUNCT_7:32;
L398: ( C106 . C107 ) = C108 by L397 , L396 , TARSKI:def 1;
L399: ( D45 . C107 ) = ( D43 . C107 ) by L393 , FUNCT_7:32;
L400: ( D45 . C107 ) in { C108 } by L399 , L359 , L360 , L387 , L396;
thus L401: ( C106 . C107 ) = ( D45 . C107 ) by L400 , L398 , TARSKI:def 1;
end;
end;
L403: ( dom C106 ) = C98 by L383 , PARTFUN1:def 2
.= ( dom D45 ) by PARTFUN1:def 2;
L404: C106 = D45 by L403 , L385 , FUNCT_1:2;
thus L405: thesis by L404 , L382 , TARSKI:def 1;
end;

end;
definition
let C109 being  finite non  empty set;
let C110 , C111 being (ManySortedSet of C109);
func diff (C110 , C111) -> Nat equals 
( card { B108 where B108 is (Element of C109) : ( C110 . B108 ) <> ( C111 . B108 ) } );
correctness
proof
L363: { B109 where B109 is (Element of C109) : ( C110 . B109 ) <> ( C111 . B109 ) } c= C109
proof
let C112 being set;
assume L364: C112 in { B110 where B110 is (Element of C109) : ( C110 . B110 ) <> ( C111 . B110 ) };
L365: (ex B111 being (Element of C109) st (C112 = B111 & ( C110 . B111 ) <> ( C111 . B111 ))) by L364;
thus L366: thesis by L365;
end;
reconsider D47 = { B112 where B112 is (Element of C109) : ( C110 . B112 ) <> ( C111 . B112 ) } as  finite set by L363 , FINSET_1:1;
L367: ( card D47 ) = ( card D47 );
thus L368: thesis by L367;
end;
end;
theorem
L370: (for B113 being  finite non  empty set holds (for B114 , B115 being (ManySortedSet of B113) holds (for B116 being (Element of B113) holds (( B114 . B116 ) <> ( B115 . B116 ) implies ( diff (B114 , B115) ) = ( ( diff (B114 , ( B115 +* (B116 , ( B114 . B116 )) )) ) + 1 )))))
proof
let C113 being  finite non  empty set;
let C114 , C115 being (ManySortedSet of C113);
let C116 being (Element of C113);
set D48 = ( C115 +* (C116 , ( C114 . C116 )) );
L371: { B117 where B117 is (Element of C113) : ( C114 . B117 ) <> ( C115 . B117 ) } c= C113
proof
let C117 being set;
assume L372: C117 in { B118 where B118 is (Element of C113) : ( C114 . B118 ) <> ( C115 . B118 ) };
L373: (ex B119 being (Element of C113) st (C117 = B119 & ( C114 . B119 ) <> ( C115 . B119 ))) by L372;
thus L374: thesis by L373;
end;
reconsider D49 = { B120 where B120 is (Element of C113) : ( C114 . B120 ) <> ( C115 . B120 ) } as  finite set by L371 , FINSET_1:1;
L375: { B121 where B121 is (Element of C113) : ( C114 . B121 ) <> ( D48 . B121 ) } c= C113
proof
let C118 being set;
assume L376: C118 in { B122 where B122 is (Element of C113) : ( C114 . B122 ) <> ( D48 . B122 ) };
L377: (ex B123 being (Element of C113) st (C118 = B123 & ( C114 . B123 ) <> ( D48 . B123 ))) by L376;
thus L378: thesis by L377;
end;
reconsider D50 = { B124 where B124 is (Element of C113) : ( C114 . B124 ) <> ( D48 . B124 ) } as  finite set by L375 , FINSET_1:1;
assume L379: ( C114 . C116 ) <> ( C115 . C116 );
L380: D49 = ( D50 \/ { C116 } )
proof
thus L381: D49 c= ( D50 \/ { C116 } )
proof
let C119 being set;
assume L382: C119 in D49;
consider C120 being (Element of C113) such that L383: C119 = C120 and L384: ( C114 . C120 ) <> ( C115 . C120 ) by L382;
per cases ;
suppose L385: C120 = C116;

L386: C119 in { C116 } by L385 , L383 , TARSKI:def 1;
thus L387: thesis by L386 , XBOOLE_0:def 3;
end;
suppose L388: C120 <> C116;

L389: ( D48 . C120 ) = ( C115 . C120 ) by L388 , FUNCT_7:32;
L390: C120 in D50 by L389 , L384;
thus L391: thesis by L390 , L383 , XBOOLE_0:def 3;
end;
end;

let C121 being set;
assume L393: C121 in ( D50 \/ { C116 } );
per cases  by L393 , XBOOLE_0:def 3;
suppose L394: C121 in D50;

consider C122 being (Element of C113) such that L395: C121 = C122 and L396: ( C114 . C122 ) <> ( D48 . C122 ) by L394;
L397:
now
assume L398: ( C114 . C122 ) = ( C115 . C122 );
L399: C122 = C116 by L398 , L396 , FUNCT_7:32;
thus L400: contradiction by L399 , L379 , L398;
end;
thus L401: thesis by L397 , L395;
end;
suppose L402: C121 in { C116 };

L403: C121 = C116 by L402 , TARSKI:def 1;
thus L404: thesis by L403 , L379;
end;
end;
L406:
now
assume L407: C116 in D50;
L408: (ex B125 being (Element of C113) st (B125 = C116 & ( C114 . B125 ) <> ( D48 . B125 ))) by L407;
L409: ( dom C115 ) = C113 by PARTFUN1:def 2;
thus L410: contradiction by L409 , L408 , FUNCT_7:31;
end;
thus L411: thesis by L406 , L380 , CARD_2:41;
end;
begin
definition
let C123 being non  empty set;
let C124 being  PLS-yielding (ManySortedSet of C123);
let C125 , C126 being (Segre-Coset of C124);
pred C125 '||' C126
means
:L412: (for B126 being (Point of ( Segre_Product C124 )) holds (B126 in C125 implies (ex B127 being (Point of ( Segre_Product C124 )) st (B127 in C126 & B126 , B127 are_collinear ))))
;end;
theorem
L414: (for B128 being non  empty set holds (for B129 being  PLS-yielding (ManySortedSet of B128) holds (for B130 , B131 being (Segre-Coset of B129) holds (B130 '||' B131 implies (for B132 being (Collineation of ( Segre_Product B129 )) holds (for B133 , B134 being (Segre-Coset of B129) holds ((B133 = ( B132 .: B130 ) & B134 = ( B132 .: B131 )) implies B133 '||' B134)))))))
proof
let C127 being non  empty set;
let C128 being  PLS-yielding (ManySortedSet of C127);
let C129 , C130 being (Segre-Coset of C128);
assume that
L415: C129 '||' C130;
let C131 being (Collineation of ( Segre_Product C128 ));
let C132 , C133 being (Segre-Coset of C128);
assume that
L416: C132 = ( C131 .: C129 )
and
L417: C133 = ( C131 .: C130 );
let C134 being (Point of ( Segre_Product C128 ));
assume L418: C134 in C132;
consider C135 being set such that L419: C135 in ( dom C131 ) and L420: C135 in C129 and L421: C134 = ( C131 . C135 ) by L418 , L416 , FUNCT_1:def 6;
reconsider D51 = C135 as (Point of ( Segre_Product C128 )) by L419;
consider C136 being (Point of ( Segre_Product C128 )) such that L422: C136 in C130 and L423: D51 , C136 are_collinear  by L415 , L420 , L412;
take D52 = ( C131 . C136 );
L424: ( dom C131 ) = (the carrier of ( Segre_Product C128 )) by FUNCT_2:def 1;
thus L425: D52 in C133 by L424 , L417 , L422 , FUNCT_1:def 6;
per cases ;
suppose L426: D51 = C136;

thus L427: thesis by L426 , L421 , PENCIL_1:def 1;
end;
suppose L428: D51 <> C136;

consider C137 being (Block of ( Segre_Product C128 )) such that L429: { D51 , C136 } c= C137 by L428 , L423 , PENCIL_1:def 1;
reconsider D53 = ( C131 .: C137 ) as (Block of ( Segre_Product C128 ));
L430: C136 in C137 by L429 , ZFMISC_1:32;
L431: D52 in D53 by L430 , L424 , FUNCT_1:def 6;
L432: D51 in C137 by L429 , ZFMISC_1:32;
L433: C134 in D53 by L432 , L419 , L421 , FUNCT_1:def 6;
L434: { C134 , D52 } c= D53 by L433 , L431 , ZFMISC_1:32;
thus L435: thesis by L434 , PENCIL_1:def 1;
end;
end;
theorem
L437: (for B135 being non  empty set holds (for B136 being  PLS-yielding (ManySortedSet of B135) holds (for B137 , B138 being (Segre-Coset of B136) holds (B137 misses B138 implies (B137 '||' B138 iff (for B139 , B140 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B136 )) holds ((B137 = ( product B139 ) & B138 = ( product B140 )) implies (( indx B139 ) = ( indx B140 ) & (ex B141 being (Element of B135) st (B141 <> ( indx B139 ) & (for B142 being (Element of B135) holds (B142 <> B141 implies ( B139 . B142 ) = ( B140 . B142 ))) & (for B143 , B144 being (Point of ( B136 . B141 )) holds ((( B139 . B141 ) = { B143 } & ( B140 . B141 ) = { B144 }) implies B143 , B144 are_collinear ))))))))))))
proof
let C138 being non  empty set;
let C139 being  PLS-yielding (ManySortedSet of C138);
let C140 , C141 being (Segre-Coset of C139);
consider C142 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C139 )) such that L438: C140 = ( product C142 ) and L439: ( C142 . ( indx C142 ) ) = ( [#] ( C139 . ( indx C142 ) ) ) by PENCIL_2:def 2;
assume L440: C140 misses C141;
thus L441: (C140 '||' C141 implies (for B145 , B146 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C139 )) holds ((C140 = ( product B145 ) & C141 = ( product B146 )) implies (( indx B145 ) = ( indx B146 ) & (ex B147 being (Element of C138) st (B147 <> ( indx B145 ) & (for B148 being (Element of C138) holds (B148 <> B147 implies ( B145 . B148 ) = ( B146 . B148 ))) & (for B149 , B150 being (Point of ( C139 . B147 )) holds ((( B145 . B147 ) = { B149 } & ( B146 . B147 ) = { B150 }) implies B149 , B150 are_collinear ))))))))
proof
assume L442: C140 '||' C141;
consider C143 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C139 )) such that L443: C141 = ( product C143 ) and L444: ( C143 . ( indx C143 ) ) = ( [#] ( C139 . ( indx C143 ) ) ) by PENCIL_2:def 2;
consider C144 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C139 )) such that L445: C140 = ( product C144 ) and L446: ( C144 . ( indx C144 ) ) = ( [#] ( C139 . ( indx C144 ) ) ) by PENCIL_2:def 2;
let C145 , C146 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C139 ));
assume that
L447: C140 = ( product C145 )
and
L448: C141 = ( product C146 );
L449: C145 = C144 by L447 , L445 , PUA2MSS1:2;
thus L450: ( indx C145 ) = ( indx C146 )
proof
assume L451: ( indx C145 ) <> ( indx C146 );
L452: ( C146 . ( indx C145 ) ) is 1 -element by L451 , PENCIL_1:12;
consider C147 being set such that L453: ( C146 . ( indx C145 ) ) = { C147 } by L452 , ZFMISC_1:131;
set D54 = the (Block of ( C139 . ( indx C145 ) ));
consider C148 being set such that L454: C148 in C140 by L447 , XBOOLE_0:def 1;
reconsider D55 = C148 as (Point of ( Segre_Product C139 )) by L454;
reconsider D56 = D55 as (Element of ( Carrier C139 )) by L60;
L455: D54 in (the topology of ( C139 . ( indx C145 ) ));
L456: (2 c= ( card D54 ) & ( card D54 ) c= ( card (the carrier of ( C139 . ( indx C145 ) )) )) by L455 , CARD_1:11 , PENCIL_1:def 6;
consider C149 being set such that L457: C149 in (the carrier of ( C139 . ( indx C145 ) )) and L458: C149 <> C147 by L456 , PENCIL_1:3 , XBOOLE_1:1;
reconsider D57 = C149 as (Point of ( C139 . ( indx C145 ) )) by L457;
reconsider D58 = ( D56 +* (( indx C145 ) , D57) ) as (Point of ( Segre_Product C139 )) by PENCIL_1:25;
reconsider D59 = D58 as (Element of ( Carrier C139 )) by L60;
L459: ( dom D59 ) = C138 by PARTFUN1:def 2
.= ( dom C145 ) by PARTFUN1:def 2;
L460:
now
let C150 being set;
assume L461: C150 in ( dom D59 );
L462: C150 in C138 by L461;
L463: C150 in ( dom D56 ) by L462 , PARTFUN1:def 2;
per cases ;
suppose L464: C150 = ( indx C145 );

L465: ( D59 . C150 ) = D57 by L464 , L463 , FUNCT_7:31;
thus L466: ( D59 . C150 ) in ( C145 . C150 ) by L465 , L446 , L449 , L464;
end;
suppose L467: C150 <> ( indx C145 );

L468: ( D59 . C150 ) = ( D56 . C150 ) by L467 , FUNCT_7:32;
L469: (ex B151 being Function st (B151 = D56 & ( dom B151 ) = ( dom C145 ) & (for B152 being set holds (B152 in ( dom C145 ) implies ( B151 . B152 ) in ( C145 . B152 ))))) by L447 , L454 , CARD_3:def 5;
thus L470: ( D59 . C150 ) in ( C145 . C150 ) by L469 , L459 , L461 , L468;
end;
end;
L472: D58 in C140 by L460 , L447 , L459 , CARD_3:def 5;
consider C151 being (Point of ( Segre_Product C139 )) such that L473: C151 in C141 and L474: D58 , C151 are_collinear  by L472 , L442 , L412;
reconsider D60 = C151 as (Element of ( Carrier C139 )) by L60;
per cases ;
suppose L475: C151 = D58;

L476: C151 in ( C140 /\ C141 ) by L475 , L472 , L473 , XBOOLE_0:def 4;
thus L477: contradiction by L476 , L440 , XBOOLE_0:def 7;
end;
suppose L478: C151 <> D58;

consider C152 being (Element of C138) such that L479: (for B153 , B154 being (Point of ( C139 . C152 )) holds ((B153 = ( D59 . C152 ) & B154 = ( D60 . C152 )) implies (B153 <> B154 & B153 , B154 are_collinear ))) and L480: (for B155 being (Element of C138) holds (B155 <> C152 implies ( D59 . B155 ) = ( D60 . B155 ))) by L478 , L474 , L276;
L481: ( dom D60 ) = C138 by PARTFUN1:def 2
.= ( dom C145 ) by PARTFUN1:def 2;
L482:
now
let C153 being set;
assume L483: C153 in ( dom D60 );
reconsider D61 = C153 as (Element of C138) by L483;
per cases ;
suppose L484: C153 = ( indx C145 );

reconsider D62 = C153 as (Element of C138) by L483;
L485: ( D60 . D62 ) is (Element of ( ( Carrier C139 ) . D62 )) by PBOOLE:def 14;
L486: ( D60 . D62 ) is (Element of ( [#] ( C139 . D62 ) )) by L485 , L68;
thus L487: ( D60 . C153 ) in ( C145 . C153 ) by L486 , L446 , L449 , L484;
end;
suppose L488: C153 <> ( indx C145 );

L489: ((ex B156 being Function st (B156 = D60 & ( dom B156 ) = ( dom C146 ) & (for B157 being set holds (B157 in ( dom C146 ) implies ( B156 . B157 ) in ( C146 . B157 ))))) & ( dom C146 ) = C138) by L448 , L473 , CARD_3:def 5 , PARTFUN1:def 2;
L490: ( D60 . ( indx C145 ) ) in ( C146 . ( indx C145 ) ) by L489;
L491: ( D60 . ( indx C145 ) ) = C147 by L490 , L453 , TARSKI:def 1;
L492: ( dom D56 ) = C138 by PARTFUN1:def 2;
L493: ( D59 . ( indx C145 ) ) = D57 by L492 , FUNCT_7:31;
L494: C152 = ( indx C145 ) by L493 , L458 , L480 , L491;
L495: ( D60 . D61 ) = ( D59 . D61 ) by L494 , L480 , L488;
L496: ( D59 . C153 ) = ( D56 . C153 ) by L488 , FUNCT_7:32;
L497: (ex B158 being Function st (B158 = D56 & ( dom B158 ) = ( dom C145 ) & (for B159 being set holds (B159 in ( dom C145 ) implies ( B158 . B159 ) in ( C145 . B159 ))))) by L447 , L454 , CARD_3:def 5;
thus L498: ( D60 . C153 ) in ( C145 . C153 ) by L497 , L481 , L483 , L495 , L496;
end;
end;
L500: C151 in C140 by L482 , L447 , L481 , CARD_3:def 5;
L501: C151 in ( C140 /\ C141 ) by L500 , L473 , XBOOLE_0:def 4;
thus L502: contradiction by L501 , L440 , XBOOLE_0:def 7;
end;
end;

L504: C146 = C143 by L448 , L443 , PUA2MSS1:2;
thus L505: (ex B160 being (Element of C138) st (B160 <> ( indx C145 ) & (for B161 being (Element of C138) holds (B161 <> B160 implies ( C145 . B161 ) = ( C146 . B161 ))) & (for B162 , B163 being (Point of ( C139 . B160 )) holds ((( C145 . B160 ) = { B162 } & ( C146 . B160 ) = { B163 }) implies B162 , B163 are_collinear ))))
proof
consider C154 being set such that L506: C154 in C140 by L447 , XBOOLE_0:def 1;
reconsider D63 = C154 as (Point of ( Segre_Product C139 )) by L506;
consider C155 being (Point of ( Segre_Product C139 )) such that L507: C155 in C141 and L508: D63 , C155 are_collinear  by L442 , L506 , L412;
reconsider D64 = C155 as (Element of ( Carrier C139 )) by L60;
reconsider D65 = D63 as (Element of ( Carrier C139 )) by L60;
L509:
now
assume L510: D63 = C155;
L511: ( C140 /\ C141 ) <> ( {} ) by L510 , L506 , L507 , XBOOLE_0:def 4;
thus L512: contradiction by L511 , L440 , XBOOLE_0:def 7;
end;
consider C156 being (Element of C138) such that L513: (for B164 , B165 being (Point of ( C139 . C156 )) holds ((B164 = ( D65 . C156 ) & B165 = ( D64 . C156 )) implies (B164 <> B165 & B164 , B165 are_collinear ))) and L514: (for B166 being (Element of C138) holds (B166 <> C156 implies ( D65 . B166 ) = ( D64 . B166 ))) by L509 , L508 , L276;
take C156;
L515:
now
assume L516: C156 = ( indx C145 );
L517:
now
let C157 being set;
assume L518: C157 in ( dom C145 );
reconsider D66 = C157 as (Element of C138) by L518;
per cases ;
suppose L519: D66 = C156;

L520: ( D64 . D66 ) is (Element of ( ( Carrier C139 ) . D66 )) by PBOOLE:def 14;
L521: ( D64 . D66 ) is (Element of ( [#] ( C139 . D66 ) )) by L520 , L68;
thus L522: ( D64 . C157 ) in ( C145 . C157 ) by L521 , L446 , L449 , L516 , L519;
end;
suppose L523: D66 <> C156;

L524: ( C145 . D66 ) is 1 -element by L523 , L516 , PENCIL_1:12;
consider C158 being set such that L525: ( C145 . D66 ) = { C158 } by L524 , ZFMISC_1:131;
L526: ( D65 . D66 ) in ( C145 . D66 ) by L447 , L506 , L518 , CARD_3:9;
L527: C158 = ( D65 . D66 ) by L526 , L525 , TARSKI:def 1
.= ( D64 . D66 ) by L514 , L523;
thus L528: ( D64 . C157 ) in ( C145 . C157 ) by L527 , L525 , TARSKI:def 1;
end;
end;
L530: ( dom D64 ) = C138 by PARTFUN1:def 2
.= ( dom C145 ) by PARTFUN1:def 2;
L531: D64 in C140 by L530 , L447 , L517 , CARD_3:9;
L532: ( C140 /\ C141 ) <> ( {} ) by L531 , L507 , XBOOLE_0:def 4;
thus L533: contradiction by L532 , L440 , XBOOLE_0:def 7;
end;
thus L534: C156 <> ( indx C145 ) by L515;
thus L535: (for B167 being (Element of C138) holds (B167 <> C156 implies ( C145 . B167 ) = ( C146 . B167 )))
proof
let C159 being (Element of C138);
assume L536: C159 <> C156;
per cases ;
suppose L537: C159 = ( indx C145 );

thus L538: thesis by L537 , L446 , L444 , L449 , L504 , L450;
end;
suppose L539: C159 <> ( indx C145 );

L540: ( C146 . C159 ) is 1 -element by L539 , L450 , PENCIL_1:12;
L541: (ex B168 being set st ( C146 . C159 ) = { B168 }) by L540 , ZFMISC_1:131;
L542: ( dom C146 ) = C138 by PARTFUN1:def 2;
L543: ( D64 . C159 ) in ( C146 . C159 ) by L542 , L448 , L507 , CARD_3:9;
L544: ( C145 . C159 ) is 1 -element by L539 , PENCIL_1:12;
consider C160 being set such that L545: ( C145 . C159 ) = { C160 } by L544 , ZFMISC_1:131;
L546: ( dom C145 ) = C138 by PARTFUN1:def 2;
L547: ( D65 . C159 ) in ( C145 . C159 ) by L546 , L447 , L506 , CARD_3:9;
L548: C160 = ( D65 . C159 ) by L547 , L545 , TARSKI:def 1
.= ( D64 . C159 ) by L514 , L536;
thus L549: thesis by L548 , L545 , L541 , L543 , TARSKI:def 1;
end;
end;

let C161 , C162 being (Point of ( C139 . C156 ));
assume that
L551: ( C145 . C156 ) = { C161 }
and
L552: ( C146 . C156 ) = { C162 };
L553: ( dom C143 ) = C138 by PARTFUN1:def 2;
L554: ( D64 . C156 ) in ( C146 . C156 ) by L553 , L443 , L504 , L507 , CARD_3:9;
L555: C162 = ( D64 . C156 ) by L554 , L552 , TARSKI:def 1;
L556: ( dom C144 ) = C138 by PARTFUN1:def 2;
L557: ( D65 . C156 ) in ( C145 . C156 ) by L556 , L445 , L449 , L506 , CARD_3:9;
L558: C161 = ( D65 . C156 ) by L557 , L551 , TARSKI:def 1;
thus L559: thesis by L558 , L513 , L555;
end;

end;

consider C163 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C139 )) such that L506: C141 = ( product C163 ) and L507: ( C163 . ( indx C163 ) ) = ( [#] ( C139 . ( indx C163 ) ) ) by PENCIL_2:def 2;
assume L508: (for B169 , B170 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C139 )) holds ((C140 = ( product B169 ) & C141 = ( product B170 )) implies (( indx B169 ) = ( indx B170 ) & (ex B171 being (Element of C138) st (B171 <> ( indx B169 ) & (for B172 being (Element of C138) holds (B172 <> B171 implies ( B169 . B172 ) = ( B170 . B172 ))) & (for B173 , B174 being (Point of ( C139 . B171 )) holds ((( B169 . B171 ) = { B173 } & ( B170 . B171 ) = { B174 }) implies B173 , B174 are_collinear )))))));
consider C164 being (Element of C138) such that L509: C164 <> ( indx C142 ) and L510: (for B175 being (Element of C138) holds (B175 <> C164 implies ( C142 . B175 ) = ( C163 . B175 ))) and L511: (for B176 , B177 being (Point of ( C139 . C164 )) holds ((( C142 . C164 ) = { B176 } & ( C163 . C164 ) = { B177 }) implies B176 , B177 are_collinear )) by L508 , L438 , L506;
L512: ( indx C142 ) = ( indx C163 ) by L508 , L438 , L506;
L513: ( C163 . C164 ) is 1 -element by L512 , L509 , PENCIL_1:12;
consider C165 being set such that L514: ( C163 . C164 ) = { C165 } by L513 , ZFMISC_1:131;
L515: C163 c= ( Carrier C139 ) by PBOOLE:def 18;
L516: ( C163 . C164 ) c= ( ( Carrier C139 ) . C164 ) by L515 , PBOOLE:def 2;
L517: { C165 } c= ( [#] ( C139 . C164 ) ) by L516 , L514 , L68;
reconsider D67 = C165 as (Point of ( C139 . C164 )) by L517 , ZFMISC_1:31;
L518: ( C142 . C164 ) is 1 -element by L509 , PENCIL_1:12;
consider C166 being set such that L519: ( C142 . C164 ) = { C166 } by L518 , ZFMISC_1:131;
L520: C142 c= ( Carrier C139 ) by PBOOLE:def 18;
L521: ( C142 . C164 ) c= ( ( Carrier C139 ) . C164 ) by L520 , PBOOLE:def 2;
L522: { C166 } c= ( [#] ( C139 . C164 ) ) by L521 , L519 , L68;
reconsider D68 = C166 as (Point of ( C139 . C164 )) by L522 , ZFMISC_1:31;
L523:
now
assume L524: D68 = D67;
L525:
now
let C167 being set;
assume L526: C167 in ( dom C142 );
reconsider D69 = C167 as (Element of C138) by L526;
per cases ;
suppose L527: D69 = C164;

thus L528: ( C142 . C167 ) = ( C163 . C167 ) by L527 , L519 , L514 , L524;
end;
suppose L529: D69 <> C164;

thus L530: ( C142 . C167 ) = ( C163 . C167 ) by L529 , L510;
end;
end;
L532: ( dom C142 ) = C138 by PARTFUN1:def 2
.= ( dom C163 ) by PARTFUN1:def 2;
L533: C142 = C163 by L532 , L525 , FUNCT_1:2;
L534: ( C140 /\ C140 ) = ( {} ) by L533 , L440 , L438 , L506 , XBOOLE_0:def 7;
thus L535: contradiction by L534 , L438;
end;
L536: D68 , D67 are_collinear  by L511 , L519 , L514;
consider C168 being (Block of ( C139 . C164 )) such that L537: { D68 , D67 } c= C168 by L536 , L523 , PENCIL_1:def 1;
let C169 being (Point of ( Segre_Product C139 ));
reconsider D70 = C169 as (Element of ( Carrier C139 )) by L60;
reconsider D71 = ( D70 +* (C164 , D67) ) as (Point of ( Segre_Product C139 )) by PENCIL_1:25;
reconsider D72 = D71 as (ManySortedSet of C138);
assume L538: C169 in C140;
L539: (ex B178 being Function st (B178 = C169 & ( dom B178 ) = ( dom C142 ) & (for B179 being set holds (B179 in ( dom C142 ) implies ( B178 . B179 ) in ( C142 . B179 ))))) by L538 , L438 , CARD_3:def 5;
L540:
now
let C170 being set;
assume L541: C170 in ( dom C163 );
reconsider D73 = C170 as (Element of C138) by L541;
per cases ;
suppose L542: D73 = C164;

L543: ( dom D70 ) = C138 by PARTFUN1:def 2;
L544: ( D72 . C170 ) = D67 by L543 , L542 , FUNCT_7:31;
thus L545: ( D72 . C170 ) in ( C163 . C170 ) by L544 , L514 , L542 , TARSKI:def 1;
end;
suppose L546: D73 <> C164;

L547: (( dom D70 ) = C138 & ( D72 . D73 ) = ( D70 . D73 )) by L546 , FUNCT_7:32 , PARTFUN1:def 2;
L548: ( D72 . D73 ) in ( C142 . D73 ) by L547 , L539;
thus L549: ( D72 . C170 ) in ( C163 . C170 ) by L548 , L510 , L546;
end;
end;
take D71;
L551: ( dom D72 ) = C138 by PARTFUN1:def 2
.= ( dom C163 ) by PARTFUN1:def 2;
thus L552: D71 in C141 by L551 , L506 , L540 , CARD_3:def 5;
reconsider D74 = ( product ( { D70 } +* (C164 , C168) ) ) as (Block of ( Segre_Product C139 )) by L261;
L553:
now
let C171 being set;
assume L554: C171 in ( dom D72 );
L555: C171 in C138 by L554;
L556: (C171 in ( dom { D70 } ) & C171 in ( dom D70 )) by L555 , PARTFUN1:def 2;
per cases ;
suppose L557: C171 = C164;

L558: (( D72 . C171 ) = D67 & C168 = ( ( { D70 } +* (C164 , C168) ) . C171 )) by L557 , L556 , FUNCT_7:31;
thus L559: ( D72 . C171 ) in ( ( { D70 } +* (C164 , C168) ) . C171 ) by L558 , L537 , ZFMISC_1:32;
end;
suppose L560: C171 <> C164;

L561: ( { D70 } . C171 ) = ( ( { D70 } +* (C164 , C168) ) . C171 ) by L560 , FUNCT_7:32;
L562: { ( D70 . C171 ) } = ( ( { D70 } +* (C164 , C168) ) . C171 ) by L561 , L555 , PZFMISC1:def 1;
L563: ( D72 . C171 ) = ( D70 . C171 ) by L560 , FUNCT_7:32;
thus L564: ( D72 . C171 ) in ( ( { D70 } +* (C164 , C168) ) . C171 ) by L563 , L562 , TARSKI:def 1;
end;
end;
L566: ( dom D72 ) = C138 by PARTFUN1:def 2
.= ( dom ( { D70 } +* (C164 , C168) ) ) by PARTFUN1:def 2;
L567: D71 in D74 by L566 , L553 , CARD_3:def 5;
L568:
now
let C172 being set;
assume L569: C172 in ( dom D70 );
L570: C172 in C138 by L569;
L571: C172 in ( dom { D70 } ) by L570 , PARTFUN1:def 2;
per cases ;
suppose L572: C172 = C164;

L573: ( D70 . C172 ) in ( C142 . C172 ) by L539 , L569;
L574: ( D70 . C172 ) = D68 by L573 , L519 , L572 , TARSKI:def 1;
L575: C168 = ( ( { D70 } +* (C164 , C168) ) . C172 ) by L571 , L572 , FUNCT_7:31;
thus L576: ( D70 . C172 ) in ( ( { D70 } +* (C164 , C168) ) . C172 ) by L575 , L537 , L574 , ZFMISC_1:32;
end;
suppose L577: C172 <> C164;

L578: ( { D70 } . C172 ) = ( ( { D70 } +* (C164 , C168) ) . C172 ) by L577 , FUNCT_7:32;
L579: { ( D70 . C172 ) } = ( ( { D70 } +* (C164 , C168) ) . C172 ) by L578 , L570 , PZFMISC1:def 1;
thus L580: ( D70 . C172 ) in ( ( { D70 } +* (C164 , C168) ) . C172 ) by L579 , TARSKI:def 1;
end;
end;
L582: ( dom D70 ) = C138 by PARTFUN1:def 2
.= ( dom ( { D70 } +* (C164 , C168) ) ) by PARTFUN1:def 2;
L583: C169 in D74 by L582 , L568 , CARD_3:def 5;
L584: { C169 , D71 } c= D74 by L583 , L567 , ZFMISC_1:32;
thus L585: thesis by L584 , PENCIL_1:def 1;
end;
theorem
L586: (for B180 being  finite non  empty set holds (for B181 being  PLS-yielding (ManySortedSet of B180) holds ((for B182 being (Element of B180) holds ( B181 . B182 ) is  connected) implies (for B183 being (Element of B180) holds (for B184 being (Point of ( B181 . B183 )) holds (for B185 , B186 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B181 )) holds ((( product B186 ) is (Segre-Coset of B181) & B185 = ( B186 +* (B183 , { B184 }) ) & (not B184 in ( B186 . B183 ))) implies (ex B187 being (FinSequence of ( bool (the carrier of ( Segre_Product B181 )) )) st (( B187 . 1 ) = ( product B185 ) & ( B187 . ( len B187 ) ) = ( product B186 ) & (for B188 being Nat holds (B188 in ( dom B187 ) implies ( B187 . B188 ) is (Segre-Coset of B181))) & (for B189 being Nat holds ((1 <= B189 & B189 < ( len B187 )) implies (for B190 , B191 being (Segre-Coset of B181) holds ((B190 = ( B187 . B189 ) & B191 = ( B187 . ( B189 + 1 ) )) implies (B190 misses B191 & B190 '||' B191))))))))))))))
proof
let C173 being  finite non  empty set;
let C174 being  PLS-yielding (ManySortedSet of C173);
assume that
L587: (for B192 being (Element of C173) holds ( C174 . B192 ) is  connected);
let C175 being (Element of C173);
let C176 being (Point of ( C174 . C175 ));
let C177 , C178 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C174 ));
assume that
L588: ( product C178 ) is (Segre-Coset of C174)
and
L589: C177 = ( C178 +* (C175 , { C176 }) )
and
L590: (not C176 in ( C178 . C175 ));
defpred S1[ set , set ] means (for B193 , B194 being (Point of ( C174 . C175 )) holds (($1 = B193 & $2 = B194) implies B193 , B194 are_collinear ));
L591:
now
assume L592: C175 = ( indx C178 );
L593: ( C178 . C175 ) = ( [#] ( C174 . C175 ) ) by L592 , L588 , L160;
thus L594: contradiction by L593 , L590;
end;
L595: ( C178 . C175 ) is 1 -element by L591 , PENCIL_1:12;
consider C179 being set such that L596: ( C178 . C175 ) = { C179 } by L595 , ZFMISC_1:131;
L597: C178 c= ( Carrier C174 ) by PBOOLE:def 18;
L598: ( C178 . C175 ) c= ( ( Carrier C174 ) . C175 ) by L597 , PBOOLE:def 2;
L599: { C179 } c= ( [#] ( C174 . C175 ) ) by L598 , L596 , L68;
reconsider D75 = C179 as (Point of ( C174 . C175 )) by L599 , ZFMISC_1:31;
L600: ( C174 . C175 ) is  connected by L587;
consider C180 being (FinSequence of (the carrier of ( C174 . C175 ))) such that L601: (C176 = ( C180 . 1 ) & D75 = ( C180 . ( len C180 ) )) and L602: (for B195 being Nat holds ((1 <= B195 & B195 < ( len C180 )) implies (for B196 , B197 being (Point of ( C174 . C175 )) holds ((B196 = ( C180 . B195 ) & B197 = ( C180 . ( B195 + 1 ) )) implies B196 , B197 are_collinear )))) by L600 , PENCIL_1:def 10;
L603: (for B198 being (Element of ( NAT )) holds (for B199 , B200 being set holds ((1 <= B198 & B198 < ( len C180 ) & B199 = ( C180 . B198 ) & B200 = ( C180 . ( B198 + 1 ) )) implies S1[ B199 , B200 ]))) by L602;
consider C181 being  one-to-one (FinSequence of (the carrier of ( C174 . C175 ))) such that L604: (C176 = ( C181 . 1 ) & D75 = ( C181 . ( len C181 ) ) & ( rng C181 ) c= ( rng C180 ) & (for B201 being (Element of ( NAT )) holds ((1 <= B201 & B201 < ( len C181 )) implies S1[ ( C181 . B201 ) , ( C181 . ( B201 + 1 ) ) ]))) from PENCIL_2:sch 1(L601 , L603);
L605:
now
assume L606: C181 = ( {} );
L607: ( dom C181 ) = ( {} ) by L606;
L608: (( C181 . 1 ) = ( {} ) & ( C181 . ( len C181 ) ) = ( {} )) by L607 , FUNCT_1:def 2;
thus L609: contradiction by L608 , L590 , L596 , L604 , TARSKI:def 1;
end;
deffunc H1(set) = ( product ( C178 +* (C175 , { ( C181 . $1 ) }) ) );
consider C182 being FinSequence such that L610: (( len C182 ) = ( len C181 ) & (for B202 being Nat holds (B202 in ( dom C182 ) implies ( C182 . B202 ) = H1(B202)))) from FINSEQ_1:sch 2;
L611: ( rng C182 ) c= ( bool (the carrier of ( Segre_Product C174 )) )
proof
let C183 being set;
assume L612: C183 in ( rng C182 );
consider C184 being set such that L613: C184 in ( dom C182 ) and L614: ( C182 . C184 ) = C183 by L612 , FUNCT_1:def 3;
reconsider D76 = C184 as (Element of ( NAT )) by L613;
L615: ( dom C182 ) = ( dom C181 ) by L610 , FINSEQ_3:29;
L616: ( C181 . D76 ) in ( rng C181 ) by L615 , L613 , FUNCT_1:3;
L617: { ( C181 . D76 ) } is (Subset of ( C174 . C175 )) by L616 , ZFMISC_1:31;
L618: ( product ( C178 +* (C175 , { ( C181 . D76 ) }) ) ) is (Subset of ( Segre_Product C174 )) by L617 , L241;
L619: ( C182 . D76 ) = ( product ( C178 +* (C175 , { ( C181 . D76 ) }) ) ) by L610 , L613;
thus L620: thesis by L619 , L614 , L618;
end;
reconsider D77 = C182 as (FinSequence of ( bool (the carrier of ( Segre_Product C174 )) )) by L611 , FINSEQ_1:def 4;
take D77;
L621: ( dom C182 ) = ( Seg ( len C181 ) ) by L610 , FINSEQ_1:def 3;
L622: ( dom C181 ) = ( Seg ( len C181 ) ) by FINSEQ_1:def 3;
thus L623: ( D77 . 1 ) = ( product C177 ) by L622 , L589 , L604 , L610 , L621 , L605 , FINSEQ_3:32;
L624: ( D77 . ( len D77 ) ) = ( product ( C178 +* (C175 , { ( C181 . ( len C181 ) ) }) ) ) by L610 , L621 , L605 , FINSEQ_1:3;
thus L625: ( D77 . ( len D77 ) ) = ( product C178 ) by L624 , L596 , L604 , FUNCT_7:35;
thus L626: (for B203 being Nat holds (B203 in ( dom D77 ) implies ( D77 . B203 ) is (Segre-Coset of C174)))
proof
let C185 being Nat;
assume L627: C185 in ( dom D77 );
L628: C185 in ( Seg ( len C181 ) ) by L627 , L610 , FINSEQ_1:def 3;
L629: C185 in ( dom C181 ) by L628 , FINSEQ_1:def 3;
L630: ( C181 . C185 ) in ( rng C181 ) by L629 , FUNCT_1:3;
reconsider D78 = ( C181 . C185 ) as (Point of ( C174 . C175 )) by L630;
reconsider D79 = ( C178 +* (C175 , { D78 }) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C174 )) by L591 , L213;
L631: ( D79 . ( indx C178 ) ) = ( C178 . ( indx C178 ) ) by L591 , FUNCT_7:32;
L632: ( D79 . ( indx C178 ) ) is non  trivial by L631 , PENCIL_1:def 21;
L633: ( indx D79 ) = ( indx C178 ) by L632 , PENCIL_1:def 21;
L634: ( D79 . ( indx D79 ) ) = ( C178 . ( indx C178 ) ) by L633 , L591 , FUNCT_7:32
.= ( [#] ( C174 . ( indx D79 ) ) ) by L588 , L633 , L160;
L635: ( D77 . C185 ) = ( product D79 ) by L610 , L627;
L636: ( D77 . C185 ) is (Subset of ( Segre_Product C174 )) by L635 , L241;
thus L637: thesis by L636 , L635 , L634 , PENCIL_2:def 2;
end;

L638: ( dom C178 ) = C173 by PARTFUN1:def 2;
thus L639: (for B204 being Nat holds ((1 <= B204 & B204 < ( len D77 )) implies (for B205 , B206 being (Segre-Coset of C174) holds ((B205 = ( D77 . B204 ) & B206 = ( D77 . ( B204 + 1 ) )) implies (B205 misses B206 & B205 '||' B206)))))
proof
let C186 being Nat;
assume L640: (1 <= C186 & C186 < ( len D77 ));
let C187 , C188 being (Segre-Coset of C174);
assume that
L641: C187 = ( D77 . C186 )
and
L642: C188 = ( D77 . ( C186 + 1 ) );
reconsider D80 = C186 as (Element of ( NAT )) by ORDINAL1:def 12;
L643: D80 in ( dom D77 ) by L640 , FINSEQ_3:25;
L644: D80 in ( Seg ( len C181 ) ) by L643 , L610 , FINSEQ_1:def 3;
L645: D80 in ( dom C181 ) by L644 , FINSEQ_1:def 3;
L646: ( C181 . D80 ) in ( rng C181 ) by L645 , FUNCT_1:3;
reconsider D81 = ( C181 . D80 ) as (Point of ( C174 . C175 )) by L646;
reconsider D82 = ( C178 +* (C175 , { D81 }) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C174 )) by L591 , L213;
L647: D80 in ( dom D77 ) by L640 , FINSEQ_3:25;
L648: ( D77 . D80 ) = ( product D82 ) by L647 , L610;
L649: (1 <= ( D80 + 1 ) & ( D80 + 1 ) <= ( len D77 )) by L640 , NAT_1:13;
L650: ( D80 + 1 ) in ( dom D77 ) by L649 , FINSEQ_3:25;
L651: ( D80 + 1 ) in ( Seg ( len C181 ) ) by L650 , L610 , FINSEQ_1:def 3;
L652: ( D80 + 1 ) in ( dom C181 ) by L651 , FINSEQ_1:def 3;
L653: ( C181 . ( D80 + 1 ) ) in ( rng C181 ) by L652 , FUNCT_1:3;
reconsider D83 = ( C181 . ( D80 + 1 ) ) as (Point of ( C174 . C175 )) by L653;
reconsider D84 = ( C178 +* (C175 , { D83 }) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C174 )) by L591 , L213;
L654: (1 <= ( D80 + 1 ) & ( D80 + 1 ) <= ( len D77 )) by L640 , NAT_1:13;
L655: ( D80 + 1 ) in ( dom D77 ) by L654 , FINSEQ_3:25;
L656: ( D80 + 1 ) in ( Seg ( len C181 ) ) by L655 , L610 , FINSEQ_1:def 3;
L657: ( D77 . ( D80 + 1 ) ) = ( product D84 ) by L610 , L655;
L658: D80 in ( Seg ( len C181 ) ) by L610 , L647 , FINSEQ_1:def 3;
thus L659: C187 misses C188
proof
L660: D80 <> ( D80 + 1 );
assume L661: ( C187 /\ C188 ) <> ( {} );
consider C189 being set such that L662: C189 in ( C187 /\ C188 ) by L661 , XBOOLE_0:def 1;
L663: C189 in C188 by L662 , XBOOLE_0:def 4;
consider C190 being Function such that L664: C190 = C189 and L665: ( dom C190 ) = ( dom ( C178 +* (C175 , { ( C181 . ( D80 + 1 ) ) }) ) ) and L666: (for B207 being set holds (B207 in ( dom ( C178 +* (C175 , { ( C181 . ( D80 + 1 ) ) }) ) ) implies ( C190 . B207 ) in ( ( C178 +* (C175 , { ( C181 . ( D80 + 1 ) ) }) ) . B207 ))) by L663 , L642 , L657 , CARD_3:def 5;
L667: ( dom ( C178 +* (C175 , { ( C181 . ( D80 + 1 ) ) }) ) ) = C173 by PARTFUN1:def 2;
L668: ( C190 . C175 ) in ( ( C178 +* (C175 , { ( C181 . ( D80 + 1 ) ) }) ) . C175 ) by L667 , L666;
L669: ( C190 . C175 ) in { ( C181 . ( D80 + 1 ) ) } by L668 , L638 , FUNCT_7:31;
L670: ( C190 . C175 ) = ( C181 . ( D80 + 1 ) ) by L669 , TARSKI:def 1;
L671: C189 in C187 by L662 , XBOOLE_0:def 4;
consider C191 being Function such that L672: C191 = C189 and L673: ( dom C191 ) = ( dom ( C178 +* (C175 , { ( C181 . D80 ) }) ) ) and L674: (for B208 being set holds (B208 in ( dom ( C178 +* (C175 , { ( C181 . D80 ) }) ) ) implies ( C191 . B208 ) in ( ( C178 +* (C175 , { ( C181 . D80 ) }) ) . B208 ))) by L671 , L641 , L648 , CARD_3:def 5;
L675: ( dom ( C178 +* (C175 , { ( C181 . D80 ) }) ) ) = C173 by PARTFUN1:def 2;
L676: ( C191 . C175 ) in ( ( C178 +* (C175 , { ( C181 . D80 ) }) ) . C175 ) by L675 , L674;
L677: ( C191 . C175 ) in { ( C181 . D80 ) } by L676 , L638 , FUNCT_7:31;
L678: ( C191 . C175 ) = ( C181 . D80 ) by L677 , TARSKI:def 1;
L679: (D80 in ( dom C181 ) & ( D80 + 1 ) in ( dom C181 )) by L658 , L656 , FINSEQ_1:def 3;
thus L680: contradiction by L679 , L672 , L664 , L678 , L670 , L660 , FUNCT_1:def 4;
end;

L681:
now
let C192 , C193 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C174 ));
assume that
L682: C187 = ( product C192 )
and
L683: C188 = ( product C193 );
L684: C193 = ( C178 +* (C175 , { ( C181 . ( D80 + 1 ) ) }) ) by L642 , L657 , L683 , PUA2MSS1:2;
L685: ( C193 . ( indx C178 ) ) = ( C178 . ( indx C178 ) ) by L684 , L591 , FUNCT_7:32;
L686: ( C193 . ( indx C178 ) ) is non  trivial by L685 , PENCIL_1:def 21;
L687: C192 = ( C178 +* (C175 , { ( C181 . D80 ) }) ) by L641 , L648 , L682 , PUA2MSS1:2;
L688: ( C192 . ( indx C178 ) ) = ( C178 . ( indx C178 ) ) by L687 , L591 , FUNCT_7:32;
L689: ( C192 . ( indx C178 ) ) is non  trivial by L688 , PENCIL_1:def 21;
L690: ( indx C192 ) = ( indx C178 ) by L689 , PENCIL_1:def 21;
thus L691: ( indx C192 ) = ( indx C193 ) by L690 , L686 , PENCIL_1:def 21;
take D85 = C175;
thus L692: D85 <> ( indx C192 ) by L591 , L689 , PENCIL_1:def 21;
thus L693: (for B209 being (Element of C173) holds (B209 <> D85 implies ( C192 . B209 ) = ( C193 . B209 )))
proof
let C194 being (Element of C173);
assume L694: C194 <> D85;
thus L695: ( C192 . C194 ) = ( C178 . C194 ) by L694 , L687 , FUNCT_7:32
.= ( C193 . C194 ) by L684 , L694 , FUNCT_7:32;
end;

thus L696: (for B210 , B211 being (Point of ( C174 . D85 )) holds ((( C192 . D85 ) = { B210 } & ( C193 . D85 ) = { B211 }) implies B210 , B211 are_collinear ))
proof
let C195 , C196 being (Point of ( C174 . D85 ));
assume that
L697: ( C192 . D85 ) = { C195 }
and
L698: ( C193 . D85 ) = { C196 };
L699: ( C193 . D85 ) = { ( C181 . ( D80 + 1 ) ) } by L638 , L684 , FUNCT_7:31;
L700: ( C181 . ( D80 + 1 ) ) = C196 by L699 , L698 , ZFMISC_1:3;
L701: ( C192 . D85 ) = { ( C181 . D80 ) } by L638 , L687 , FUNCT_7:31;
L702: ( C181 . D80 ) = C195 by L701 , L697 , ZFMISC_1:3;
thus L703: thesis by L702 , L604 , L610 , L640 , L700;
end;

end;
thus L697: thesis by L681 , L659 , L437;
end;

end;
theorem
L640: (for B212 being  finite non  empty set holds (for B213 being  PLS-yielding (ManySortedSet of B212) holds ((for B214 being (Element of B212) holds ( B213 . B214 ) is  connected) implies (for B215 , B216 being (Segre-Coset of B213) holds (B215 misses B216 implies (for B217 , B218 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B213 )) holds ((B215 = ( product B217 ) & B216 = ( product B218 )) implies (( indx B217 ) = ( indx B218 ) iff (ex B219 being (FinSequence of ( bool (the carrier of ( Segre_Product B213 )) )) st (( B219 . 1 ) = B215 & ( B219 . ( len B219 ) ) = B216 & (for B220 being Nat holds (B220 in ( dom B219 ) implies ( B219 . B220 ) is (Segre-Coset of B213))) & (for B221 being Nat holds ((1 <= B221 & B221 < ( len B219 )) implies (for B222 , B223 being (Segre-Coset of B213) holds ((B222 = ( B219 . B221 ) & B223 = ( B219 . ( B221 + 1 ) )) implies (B222 misses B223 & B222 '||' B223)))))))))))))))
proof
let C197 being  finite non  empty set;
let C198 being  PLS-yielding (ManySortedSet of C197);
assume L641: (for B224 being (Element of C197) holds ( C198 . B224 ) is  connected);
let C199 , C200 being (Segre-Coset of C198);
assume that
L642: C199 misses C200;
let C201 , C202 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 ));
assume that
L643: C199 = ( product C201 )
and
L644: C200 = ( product C202 );
thus L645: (( indx C201 ) = ( indx C202 ) implies (ex B225 being (FinSequence of ( bool (the carrier of ( Segre_Product C198 )) )) st (( B225 . 1 ) = C199 & ( B225 . ( len B225 ) ) = C200 & (for B226 being Nat holds (B226 in ( dom B225 ) implies ( B225 . B226 ) is (Segre-Coset of C198))) & (for B227 being Nat holds ((1 <= B227 & B227 < ( len B225 )) implies (for B228 , B229 being (Segre-Coset of C198) holds ((B228 = ( B225 . B227 ) & B229 = ( B225 . ( B227 + 1 ) )) implies (B228 misses B229 & B228 '||' B229))))))))
proof
defpred S2[ Nat ] means (for B230 , B231 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 )) holds ((( indx B230 ) = ( indx B231 ) & ( product B230 ) is (Segre-Coset of C198) & ( product B231 ) is (Segre-Coset of C198) & ( product B230 ) misses ( product B231 ) & ( diff (B230 , B231) ) = $1) implies (ex B232 being (FinSequence of ( bool (the carrier of ( Segre_Product C198 )) )) st (( B232 . 1 ) = ( product B230 ) & ( B232 . ( len B232 ) ) = ( product B231 ) & (for B233 being Nat holds (B233 in ( dom B232 ) implies ( B232 . B233 ) is (Segre-Coset of C198))) & (for B234 being Nat holds ((1 <= B234 & B234 < ( len B232 )) implies (for B235 , B236 being (Segre-Coset of C198) holds ((B235 = ( B232 . B234 ) & B236 = ( B232 . ( B234 + 1 ) )) implies (B235 misses B236 & B235 '||' B236)))))))));
L646:
now
let C203 being Nat;
assume L647: S2[ C203 ];
thus L648: S2[ ( C203 + 1 ) ]
proof
let C204 , C205 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 ));
assume that
L649: ( indx C204 ) = ( indx C205 )
and
L650: ( product C204 ) is (Segre-Coset of C198)
and
L651: ( product C205 ) is (Segre-Coset of C198)
and
L652: ( product C204 ) misses ( product C205 )
and
L653: ( diff (C204 , C205) ) = ( C203 + 1 );
L654: { B237 where B237 is (Element of C197) : ( C204 . B237 ) <> ( C205 . B237 ) } <> ( {} ) by L653;
consider C206 being set such that L655: C206 in { B238 where B238 is (Element of C197) : ( C204 . B238 ) <> ( C205 . B238 ) } by L654 , XBOOLE_0:def 1;
consider C207 being (Element of C197) such that L656: C206 = C207 and L657: ( C204 . C207 ) <> ( C205 . C207 ) by L655;
L658: ( C205 . ( indx C204 ) ) = ( [#] ( C198 . ( indx C204 ) ) ) by L649 , L651 , L160;
L659: C207 <> ( indx C204 ) by L658 , L650 , L657 , L160;
L660: ( C204 . C207 ) is 1 -element by L659 , PENCIL_1:12;
consider C208 being set such that L661: ( C204 . C207 ) = { C208 } by L660 , ZFMISC_1:131;
L662: C204 c= ( Carrier C198 ) by PBOOLE:def 18;
L663: { C208 } c= ( ( Carrier C198 ) . C207 ) by L662 , L661 , PBOOLE:def 2;
L664: C208 in ( ( Carrier C198 ) . C207 ) by L663 , ZFMISC_1:31;
L665: C208 in ( [#] ( C198 . C207 ) ) by L664 , L68;
reconsider D86 = C208 as (Point of ( C198 . C207 )) by L665;
reconsider D87 = ( C205 +* (C207 , { D86 }) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 )) by L649 , L659 , L213;
L666: ( D87 . ( indx C204 ) ) = ( [#] ( C198 . ( indx C204 ) ) ) by L658 , L659 , FUNCT_7:32;
L667: ( C205 . C207 ) is 1 -element by L649 , L659 , PENCIL_1:12;
L668: (ex B239 being set st ( C205 . C207 ) = { B239 }) by L667 , ZFMISC_1:131;
L669: ( C198 . ( indx C204 ) ) is non  trivial by L15;
L670: ( indx D87 ) = ( indx C204 ) by L669 , L666 , PENCIL_1:def 21;
L671: ( product D87 ) is (Subset of ( Segre_Product C198 )) by L241;
L672: ( product D87 ) is (Segre-Coset of C198) by L671 , L666 , L670 , PENCIL_2:def 2;
per cases ;
suppose L673: ( product C204 ) misses ( product D87 );

L674: ( diff (C204 , C205) ) = ( ( diff (C204 , D87) ) + 1 ) by L657 , L661 , L370;
consider C209 being (FinSequence of ( bool (the carrier of ( Segre_Product C198 )) )) such that L675: ( C209 . 1 ) = ( product C204 ) and L676: ( C209 . ( len C209 ) ) = ( product D87 ) and L677: (for B240 being Nat holds (B240 in ( dom C209 ) implies ( C209 . B240 ) is (Segre-Coset of C198))) and L678: (for B241 being Nat holds ((1 <= B241 & B241 < ( len C209 )) implies (for B242 , B243 being (Segre-Coset of C198) holds ((B242 = ( C209 . B241 ) & B243 = ( C209 . ( B241 + 1 ) )) implies (B242 misses B243 & B242 '||' B243))))) by L674 , L647 , L650 , L653 , L670 , L672 , L673;
L679: (not D86 in ( C205 . C207 )) by L657 , L661 , L668 , TARSKI:def 1;
consider C210 being (FinSequence of ( bool (the carrier of ( Segre_Product C198 )) )) such that L680: ( C210 . 1 ) = ( product D87 ) and L681: ( C210 . ( len C210 ) ) = ( product C205 ) and L682: (for B244 being Nat holds (B244 in ( dom C210 ) implies ( C210 . B244 ) is (Segre-Coset of C198))) and L683: (for B245 being Nat holds ((1 <= B245 & B245 < ( len C210 )) implies (for B246 , B247 being (Segre-Coset of C198) holds ((B246 = ( C210 . B245 ) & B247 = ( C210 . ( B245 + 1 ) )) implies (B246 misses B247 & B246 '||' B247))))) by L679 , L641 , L651 , L586;
L684:
now
L685: ( dom C205 ) = C197 by PARTFUN1:def 2;
L686: ( D87 . C207 ) = { D86 } by L685 , FUNCT_7:31;
assume L687: ( len C210 ) = 1;
thus L688: contradiction by L687 , L657 , L661 , L680 , L681 , L686 , PUA2MSS1:2;
end;
reconsider D88 = ( C209 ^' C210 ) as (FinSequence of ( bool (the carrier of ( Segre_Product C198 )) ));
take D88;
L689: 1 in ( dom C209 ) by L675 , FUNCT_1:def 2;
L690: 1 <= ( len C209 ) by L689 , FINSEQ_3:25;
thus L691: ( D88 . 1 ) = ( product C204 ) by L690 , L675 , GRAPH_2:14;
L692: 1 in ( dom C210 ) by L680 , FUNCT_1:def 2;
L693: 1 <= ( len C210 ) by L692 , FINSEQ_3:25;
L694: ( len C210 ) > 1 by L693 , L684 , XXREAL_0:1;
thus L695: ( D88 . ( len D88 ) ) = ( product C205 ) by L694 , L681 , GRAPH_2:16;
thus L696: (for B248 being Nat holds (B248 in ( dom D88 ) implies ( D88 . B248 ) is (Segre-Coset of C198)))
proof
let C211 being Nat;
L697: ( rng D88 ) c= ( ( rng C209 ) \/ ( rng C210 ) ) by GRAPH_2:17;
assume L698: C211 in ( dom D88 );
L699: ( D88 . C211 ) in ( rng D88 ) by L698 , FUNCT_1:3;
per cases  by L699 , L697 , XBOOLE_0:def 3;
suppose L700: ( D88 . C211 ) in ( rng C209 );

consider C212 being set such that L701: C212 in ( dom C209 ) and L702: ( D88 . C211 ) = ( C209 . C212 ) by L700 , FUNCT_1:def 3;
thus L703: thesis by L677 , L701 , L702;
end;
suppose L704: ( D88 . C211 ) in ( rng C210 );

consider C213 being set such that L705: C213 in ( dom C210 ) and L706: ( D88 . C211 ) = ( C210 . C213 ) by L704 , FUNCT_1:def 3;
thus L707: thesis by L682 , L705 , L706;
end;
end;

thus L709: (for B249 being Nat holds ((1 <= B249 & B249 < ( len D88 )) implies (for B250 , B251 being (Segre-Coset of C198) holds ((B250 = ( D88 . B249 ) & B251 = ( D88 . ( B249 + 1 ) )) implies (B250 misses B251 & B250 '||' B251)))))
proof
let C214 being Nat;
assume that
L710: 1 <= C214
and
L711: C214 < ( len D88 );
let C215 , C216 being (Segre-Coset of C198);
assume that
L712: C215 = ( D88 . C214 )
and
L713: C216 = ( D88 . ( C214 + 1 ) );
reconsider D89 = C214 as (Element of ( NAT )) by ORDINAL1:def 12;
per cases ;
suppose L714: D89 < ( len C209 );

L715: ( D89 + 1 ) <= ( len C209 ) by L714 , NAT_1:13;
L716: C216 = ( C209 . ( D89 + 1 ) ) by L715 , L713 , GRAPH_2:14 , NAT_1:11;
L717: C215 = ( C209 . D89 ) by L710 , L712 , L714 , GRAPH_2:14;
thus L718: thesis by L717 , L678 , L710 , L714 , L716;
end;
suppose L719: D89 >= ( len C209 );

consider C217 being Nat such that L720: D89 = ( ( len C209 ) + C217 ) by L719 , NAT_1:10;
L721: C210 <> ( {} ) by L692;
reconsider D90 = C217 as (Element of ( NAT )) by ORDINAL1:def 12;
per cases ;
suppose L722: D90 > ( 0 );

L723: ( ( ( len C209 ) + D90 ) + 1 ) < ( ( len D88 ) + 1 ) by L711 , L720 , XREAL_1:6;
L724: ( ( len C209 ) + ( D90 + 1 ) ) < ( ( len C209 ) + ( len C210 ) ) by L723 , L721 , GRAPH_2:13;
L725: ( D90 + 1 ) < ( len C210 ) by L724 , XREAL_1:6;
L726: D90 < ( len C210 ) by L725 , NAT_1:13;
L727: C216 = ( D88 . ( ( len C209 ) + ( D90 + 1 ) ) ) by L713 , L720;
L728: C216 = ( C210 . ( ( D90 + 1 ) + 1 ) ) by L727 , L725 , GRAPH_2:15 , NAT_1:11;
L729: ( ( 0 ) + 1 ) <= D90 by L722 , NAT_1:13;
L730: C215 = ( C210 . ( D90 + 1 ) ) by L729 , L712 , L720 , L726 , GRAPH_2:15;
L731: (1 <= ( D90 + 1 ) & ( D90 + 1 ) < ( len C210 )) by L724 , NAT_1:11 , XREAL_1:6;
thus L732: thesis by L731 , L683 , L730 , L728;
end;
suppose L733: D90 = ( 0 );

L734: (C215 = ( C210 . 1 ) & C216 = ( C210 . ( 1 + 1 ) )) by L733 , L676 , L680 , L694 , L710 , L712 , L713 , L720 , GRAPH_2:14 , GRAPH_2:15;
thus L735: thesis by L734 , L683 , L694;
end;
end;
end;

end;
suppose L710: ( product C204 ) meets ( product D87 );

L711: (not D86 in ( C205 . C207 )) by L657 , L661 , L668 , TARSKI:def 1;
thus L712: thesis by L711 , L641 , L650 , L651 , L670 , L672 , L710 , L166 , L586;
end;
end;

end;
L649: S2[ ( 0 ) ]
proof
let C218 , C219 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 ));
assume that
L650: ( indx C218 ) = ( indx C219 )
and
L651: ( product C218 ) is (Segre-Coset of C198)
and
L652: ( product C219 ) is (Segre-Coset of C198)
and
L653: ( product C218 ) misses ( product C219 )
and
L654: ( diff (C218 , C219) ) = ( 0 );
L655:
now
let C220 being set;
assume L656: C220 in ( dom C218 );
reconsider D91 = C220 as (Element of C197) by L656;
assume L657: ( C218 . C220 ) <> ( C219 . C220 );
L658: D91 in { B252 where B252 is (Element of C197) : ( C218 . B252 ) <> ( C219 . B252 ) } by L657;
thus L659: contradiction by L658 , L654;
end;
L660: ( dom C218 ) = C197 by PARTFUN1:def 2
.= ( dom C219 ) by PARTFUN1:def 2;
thus L661: thesis by L660 , L653 , L655 , FUNCT_1:2;
end;
L662: (for B253 being Nat holds S2[ B253 ]) from NAT_1:sch 2(L649 , L646);
L663: S2[ ( diff (C201 , C202) ) ] by L662;
assume L664: ( indx C201 ) = ( indx C202 );
consider C221 being (FinSequence of ( bool (the carrier of ( Segre_Product C198 )) )) such that L665: (( C221 . 1 ) = ( product C201 ) & ( C221 . ( len C221 ) ) = ( product C202 )) and L666: ((for B254 being Nat holds (B254 in ( dom C221 ) implies ( C221 . B254 ) is (Segre-Coset of C198))) & (for B255 being Nat holds ((1 <= B255 & B255 < ( len C221 )) implies (for B256 , B257 being (Segre-Coset of C198) holds ((B256 = ( C221 . B255 ) & B257 = ( C221 . ( B255 + 1 ) )) implies (B256 misses B257 & B256 '||' B257)))))) by L664 , L642 , L643 , L644 , L663;
take C221;
thus L667: (( C221 . 1 ) = C199 & ( C221 . ( len C221 ) ) = C200) by L643 , L644 , L665;
thus L668: thesis by L666;
end;

given C222 being (FinSequence of ( bool (the carrier of ( Segre_Product C198 )) )) such that
L669: ( C222 . 1 ) = C199
and
L670: ( C222 . ( len C222 ) ) = C200
and
L671: (for B258 being Nat holds (B258 in ( dom C222 ) implies ( C222 . B258 ) is (Segre-Coset of C198)))
and
L672: (for B259 being Nat holds ((1 <= B259 & B259 < ( len C222 )) implies (for B260 , B261 being (Segre-Coset of C198) holds ((B260 = ( C222 . B259 ) & B261 = ( C222 . ( B259 + 1 ) )) implies (B260 misses B261 & B260 '||' B261)))));

defpred S3[ Nat ] means (for B262 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 )) holds (( product B262 ) = ( C222 . $1 ) implies ( indx C201 ) = ( indx B262 )));
L673:
now
let C223 being Nat;
assume L674: S3[ C223 ];
thus L675: S3[ ( C223 + 1 ) ]
proof
let C224 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 ));
assume that
L676: ( product C224 ) = ( C222 . ( C223 + 1 ) );
L677: ( C223 + 1 ) in ( dom C222 ) by L676 , FUNCT_1:def 2;
L678: ( C223 + 1 ) <= ( len C222 ) by L677 , FINSEQ_3:25;
per cases ;
suppose L679: C223 = ( 0 );

thus L680: thesis by L679 , L643 , L669 , L676 , PUA2MSS1:2;
end;
suppose L681: ( 0 ) < C223;

L682: ( ( 0 ) + 1 ) < ( C223 + 1 ) by L681 , XREAL_1:6;
L683: 1 <= C223 by L682 , NAT_1:13;
L684: C223 <= ( len C222 ) by L678 , NAT_1:13;
L685: C223 in ( dom C222 ) by L684 , L683 , FINSEQ_3:25;
reconsider D92 = ( C222 . C223 ) as (Segre-Coset of C198) by L685 , L671;
reconsider D93 = ( C222 . ( C223 + 1 ) ) as (Segre-Coset of C198) by L671 , L677;
consider C225 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 )) such that L686: D92 = ( product C225 ) and L687: ( C225 . ( indx C225 ) ) = ( [#] ( C198 . ( indx C225 ) ) ) by PENCIL_2:def 2;
L688: C223 < ( len C222 ) by L678 , NAT_1:13;
L689: (D92 misses D93 & D92 '||' D93) by L688 , L672 , L683;
L690: ( indx C201 ) = ( indx C225 ) by L674 , L686;
thus L691: thesis by L690 , L676 , L686 , L689 , L437;
end;
end;

end;
L676: S3[ ( 0 ) ]
proof
L677: (not ( 0 ) in ( dom C222 )) by FINSEQ_3:24;
let C226 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C198 ));
assume L678: ( product C226 ) = ( C222 . ( 0 ) );
thus L679: thesis by L678 , L677 , FUNCT_1:def 2;
end;
L680: (for B263 being Nat holds S3[ B263 ]) from NAT_1:sch 2(L676 , L673);
thus L681: thesis by L680 , L644 , L670;
end;
theorem
L682: (for B264 being  finite non  empty set holds (for B265 being  PLS-yielding (ManySortedSet of B264) holds ((for B266 being (Element of B264) holds ( B265 . B266 ) is  strongly_connected) implies (for B267 being (Collineation of ( Segre_Product B265 )) holds (for B268 , B269 being (Segre-Coset of B265) holds (for B270 , B271 , B272 , B273 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B265 )) holds ((B268 = ( product B270 ) & B269 = ( product B271 ) & ( B267 .: B268 ) = ( product B272 ) & ( B267 .: B269 ) = ( product B273 )) implies (( indx B270 ) = ( indx B271 ) implies ( indx B272 ) = ( indx B273 )))))))))
proof
let C227 being  finite non  empty set;
let C228 being  PLS-yielding (ManySortedSet of C227);
assume that
L683: (for B274 being (Element of C227) holds ( C228 . B274 ) is  strongly_connected);
L684:
now
let C229 being (Element of C227);
L685: ( C228 . C229 ) is  strongly_connected by L683;
thus L686: ( C228 . C229 ) is  connected by L685 , L47;
end;
let C230 being (Collineation of ( Segre_Product C228 ));
let C231 , C232 being (Segre-Coset of C228);
let C233 , C234 , C235 , C236 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C228 ));
assume that
L687: C231 = ( product C233 )
and
L688: C232 = ( product C234 )
and
L689: (( C230 .: C231 ) = ( product C235 ) & ( C230 .: C232 ) = ( product C236 ));
assume L690: ( indx C233 ) = ( indx C234 );
per cases ;
suppose L691: C231 misses C232;

reconsider D94 = ( C230 .: C231 ) , D95 = ( C230 .: C232 ) as (Segre-Coset of C228) by L683 , PENCIL_2:24;
L692: C230 is  bijective  bijective  bijective  bijective (Function of (the carrier of ( Segre_Product C228 )) , (the carrier of ( Segre_Product C228 ))) by PENCIL_2:def 4;
L693: D94 misses D95 by L692 , L691 , FUNCT_1:66;
consider C237 being (FinSequence of ( bool (the carrier of ( Segre_Product C228 )) )) such that L694: ( C237 . 1 ) = C231 and L695: ( C237 . ( len C237 ) ) = C232 and L696: (for B275 being Nat holds (B275 in ( dom C237 ) implies ( C237 . B275 ) is (Segre-Coset of C228))) and L697: (for B276 being Nat holds ((1 <= B276 & B276 < ( len C237 )) implies (for B277 , B278 being (Segre-Coset of C228) holds ((B277 = ( C237 . B276 ) & B278 = ( C237 . ( B276 + 1 ) )) implies (B277 misses B278 & B277 '||' B278))))) by L684 , L687 , L688 , L690 , L691 , L640;
deffunc H2(Nat) = ( C230 .: ( C237 . $1 ) );
consider C238 being (FinSequence of ( bool (the carrier of ( Segre_Product C228 )) )) such that L698: (( len C238 ) = ( len C237 ) & (for B279 being Nat holds (B279 in ( dom C238 ) implies ( C238 . B279 ) = H2(B279)))) from FINSEQ_2:sch 1;
L699: ( dom C238 ) = ( Seg ( len C237 ) ) by L698 , FINSEQ_1:def 3;
L700: (for B280 being Nat holds ((1 <= B280 & B280 < ( len C238 )) implies (for B281 , B282 being (Segre-Coset of C228) holds ((B281 = ( C238 . B280 ) & B282 = ( C238 . ( B280 + 1 ) )) implies (B281 misses B282 & B281 '||' B282)))))
proof
let C239 being Nat;
L701: C230 is  bijective  bijective  bijective  bijective (Function of (the carrier of ( Segre_Product C228 )) , (the carrier of ( Segre_Product C228 ))) by PENCIL_2:def 4;
assume L702: (1 <= C239 & C239 < ( len C238 ));
L703: C239 in ( dom C237 ) by L702 , L698 , FINSEQ_3:25;
reconsider D96 = ( C237 . C239 ) as (Segre-Coset of C228) by L703 , L696;
L704: (1 <= ( C239 + 1 ) & ( C239 + 1 ) <= ( len C238 )) by L702 , NAT_1:13;
L705: ( C239 + 1 ) in ( dom C237 ) by L704 , L698 , FINSEQ_3:25;
reconsider D97 = ( C237 . ( C239 + 1 ) ) as (Segre-Coset of C228) by L705 , L696;
let C240 , C241 being (Segre-Coset of C228);
assume that
L706: C240 = ( C238 . C239 )
and
L707: C241 = ( C238 . ( C239 + 1 ) );
L708: C239 in ( Seg ( len C237 ) ) by L698 , L702 , FINSEQ_1:1;
L709: C240 = ( C230 .: ( C237 . C239 ) ) by L708 , L698 , L699 , L706;
L710: (1 <= ( C239 + 1 ) & ( C239 + 1 ) <= ( len C238 )) by L702 , NAT_1:13;
L711: ( C239 + 1 ) in ( Seg ( len C237 ) ) by L710 , L698 , FINSEQ_1:1;
L712: C241 = ( C230 .: ( C237 . ( C239 + 1 ) ) ) by L711 , L698 , L699 , L707;
L713: D96 misses D97 by L697 , L698 , L702;
thus L714: C240 misses C241 by L713 , L709 , L712 , L701 , FUNCT_1:66;
L715: D96 '||' D97 by L697 , L698 , L702;
thus L716: thesis by L715 , L709 , L712 , L414;
end;
L717: (for B283 being Nat holds (B283 in ( dom C238 ) implies ( C238 . B283 ) is (Segre-Coset of C228)))
proof
let C242 being Nat;
assume L718: C242 in ( dom C238 );
L719: C242 in ( Seg ( len C237 ) ) by L718 , L698 , FINSEQ_1:def 3;
L720: C242 in ( dom C237 ) by L719 , FINSEQ_1:def 3;
reconsider D98 = ( C237 . C242 ) as (Segre-Coset of C228) by L720 , L696;
L721: ( C238 . C242 ) = ( C230 .: D98 ) by L698 , L718;
thus L722: thesis by L721 , L683 , PENCIL_2:24;
end;
L723: ( len C238 ) in ( dom C237 ) by L688 , L695 , L698 , FUNCT_1:def 2;
L724: ( len C238 ) in ( Seg ( len C237 ) ) by L723 , FINSEQ_1:def 3;
L725: ( C238 . ( len C238 ) ) = ( C230 .: C232 ) by L724 , L695 , L698 , L699;
L726: 1 in ( dom C237 ) by L687 , L694 , FUNCT_1:def 2;
L727: 1 in ( Seg ( len C237 ) ) by L726 , FINSEQ_1:def 3;
L728: ( C238 . 1 ) = ( C230 .: C231 ) by L727 , L694 , L698 , L699;
thus L729: thesis by L728 , L684 , L689 , L725 , L717 , L700 , L693 , L640;
end;
suppose L730: C231 meets C232;

L731: C231 = C232 by L730 , L687 , L688 , L690 , L166;
thus L732: thesis by L731 , L689 , PUA2MSS1:2;
end;
end;
theorem
L734: (for B284 being  finite non  empty set holds (for B285 being  PLS-yielding (ManySortedSet of B284) holds ((for B286 being (Element of B284) holds ( B285 . B286 ) is  strongly_connected) implies (for B287 being (Collineation of ( Segre_Product B285 )) holds (ex B288 being (Permutation of B284) st (for B289 , B290 being (Element of B284) holds (( B288 . B289 ) = B290 iff (for B291 being (Segre-Coset of B285) holds (for B292 , B293 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B285 )) holds ((B291 = ( product B292 ) & ( B287 .: B291 ) = ( product B293 )) implies (( indx B292 ) = B289 implies ( indx B293 ) = B290)))))))))))
proof
let C243 being  finite non  empty set;
let C244 being  PLS-yielding (ManySortedSet of C243);
assume L735: (for B294 being (Element of C243) holds ( C244 . B294 ) is  strongly_connected);
let C245 being (Collineation of ( Segre_Product C244 ));
defpred S4[ set , set ] means (for B295 being (Segre-Coset of C244) holds (for B296 , B297 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) holds ((B295 = ( product B296 ) & ( C245 .: B295 ) = ( product B297 )) implies (( indx B296 ) = $1 implies ( indx B297 ) = $2))));
L736: (for B298 , B299 , B300 being (Element of C243) holds ((S4[ B298 , B299 ] & S4[ B300 , B299 ]) implies B298 = B300))
proof
reconsider D99 = ( C245 " ) as (Collineation of ( Segre_Product C244 )) by PENCIL_2:13;
let C246 , C247 , C248 being (Element of C243);
assume that
L737: (for B301 being (Segre-Coset of C244) holds (for B302 , B303 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) holds ((B301 = ( product B302 ) & ( C245 .: B301 ) = ( product B303 )) implies (( indx B302 ) = C246 implies ( indx B303 ) = C247))))
and
L738: (for B304 being (Segre-Coset of C244) holds (for B305 , B306 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) holds ((B304 = ( product B305 ) & ( C245 .: B304 ) = ( product B306 )) implies (( indx B305 ) = C248 implies ( indx B306 ) = C247))));
consider C249 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) such that L739: ( indx C249 ) = C246 and L740: ( product C249 ) is (Segre-Coset of C244) by L71;
reconsider D100 = ( product C249 ) as (Segre-Coset of C244) by L740;
reconsider D101 = ( C245 .: D100 ) as (Segre-Coset of C244) by L735 , PENCIL_2:24;
consider C250 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) such that L741: D101 = ( product C250 ) and L742: ( C250 . ( indx C250 ) ) = ( [#] ( C244 . ( indx C250 ) ) ) by PENCIL_2:def 2;
consider C251 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) such that L743: ( indx C251 ) = C248 and L744: ( product C251 ) is (Segre-Coset of C244) by L71;
reconsider D102 = ( product C251 ) as (Segre-Coset of C244) by L744;
reconsider D103 = ( C245 .: D102 ) as (Segre-Coset of C244) by L735 , PENCIL_2:24;
consider C252 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) such that L745: D103 = ( product C252 ) and L746: ( C252 . ( indx C252 ) ) = ( [#] ( C244 . ( indx C252 ) ) ) by PENCIL_2:def 2;
L747: ( indx C252 ) = C247 by L738 , L743 , L745;
L748: C245 is  bijective by PENCIL_2:def 4;
L749: D99 = ( (C245 qua Function) " ) by L748 , TOPS_2:def 4;
L750: ( D99 .: D103 ) = ( C245 " D103 ) by L749 , L748 , FUNCT_1:85;
L751: ( D99 .: D101 ) = ( C245 " D101 ) by L748 , L749 , FUNCT_1:85;
L752: ( dom C245 ) = (the carrier of ( Segre_Product C244 )) by FUNCT_2:def 1;
L753: D102 c= ( D99 .: D103 ) by L752 , L750 , FUNCT_1:76;
L754: ( D99 .: D103 ) c= D102 by L748 , L750 , FUNCT_1:82;
L755: D102 = ( D99 .: D103 ) by L754 , L753 , XBOOLE_0:def 10;
L756: ( dom C245 ) = (the carrier of ( Segre_Product C244 )) by FUNCT_2:def 1;
L757: D100 c= ( D99 .: D101 ) by L756 , L751 , FUNCT_1:76;
L758: ( D99 .: D101 ) c= D100 by L748 , L751 , FUNCT_1:82;
L759: D100 = ( D99 .: D101 ) by L758 , L757 , XBOOLE_0:def 10;
L760: ( indx C250 ) = C247 by L737 , L739 , L741;
thus L761: thesis by L760 , L735 , L739 , L741 , L743 , L745 , L747 , L759 , L755 , L682;
end;
L762: (for B307 being (Element of C243) holds (ex B308 being (Element of C243) st S4[ B308 , B307 ]))
proof
set D104 = the (Point of ( Segre_Product C244 ));
reconsider D105 = D104 as (Element of ( Carrier C244 )) by L60;
let C253 being (Element of C243);
reconsider D106 = { D105 } as (ManySortedSubset of ( Carrier C244 )) by PENCIL_1:11;
L763: ( dom C244 ) = C243 by PARTFUN1:def 2;
L764: ( C244 . C253 ) in ( rng C244 ) by L763 , FUNCT_1:3;
L765: ( C244 . C253 ) is non  trivial by L764 , PENCIL_1:def 18;
reconsider D107 = ( [#] ( C244 . C253 ) ) as non  trivial set by L765;
reconsider D108 = ( D106 +* (C253 , D107) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) by PENCIL_1:9 , PENCIL_1:10 , PENCIL_2:7;
L766: ( dom D106 ) = C243 by PARTFUN1:def 2;
L767: ( D108 . C253 ) = D107 by L766 , FUNCT_7:31;
L768: ( indx D108 ) = C253 by L767 , PENCIL_1:def 21;
L769: ( product D108 ) c= (the carrier of ( Segre_Product C244 ))
proof
let C254 being set;
assume L770: C254 in ( product D108 );
consider C255 being Function such that L771: C254 = C255 and L772: ( dom C255 ) = ( dom D108 ) and L773: (for B309 being set holds (B309 in ( dom D108 ) implies ( C255 . B309 ) in ( D108 . B309 ))) by L770 , CARD_3:def 5;
L774: ( dom ( Carrier C244 ) ) = C243 by PARTFUN1:def 2;
L775: ( dom C255 ) = ( dom ( Carrier C244 ) ) by L774 , L772 , PARTFUN1:def 2;
L776:
now
let C256 being set;
assume L777: C256 in ( dom ( Carrier C244 ) );
reconsider D109 = C256 as (Element of C243) by L777;
L778: ( C255 . C256 ) in ( D108 . C256 ) by L772 , L773 , L775 , L777;
per cases ;
suppose L779: D109 = C253;

thus L780: ( C255 . C256 ) in ( ( Carrier C244 ) . C256 ) by L779 , L767 , L778 , L68;
end;
suppose L781: D109 <> C253;

L782: ( C255 . D109 ) in ( D106 . D109 ) by L781 , L778 , FUNCT_7:32;
L783: ( C255 . D109 ) in { ( D105 . D109 ) } by L782 , PZFMISC1:def 1;
L784: ( C255 . D109 ) = ( D105 . D109 ) by L783 , TARSKI:def 1;
L785: ( C255 . D109 ) is (Element of ( ( Carrier C244 ) . D109 )) by L784 , PBOOLE:def 14;
L786: ( [#] ( C244 . D109 ) ) is non  empty;
L787: ( ( Carrier C244 ) . D109 ) is non  empty by L786 , L68;
thus L788: ( C255 . C256 ) in ( ( Carrier C244 ) . C256 ) by L787 , L785;
end;
end;
L790: ( Segre_Product C244 ) = TopStruct (# ( product ( Carrier C244 ) ) , ( Segre_Blocks C244 ) #) by PENCIL_1:def 23;
thus L791: thesis by L790 , L771 , L775 , L776 , CARD_3:def 5;
end;
reconsider D110 = ( product D108 ) as (Segre-Coset of C244) by L769 , L767 , L768 , PENCIL_2:def 2;
reconsider D111 = ( C245 " D110 ) as (Segre-Coset of C244) by L735 , PENCIL_2:25;
consider C257 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) such that L792: D111 = ( product C257 ) and L793: ( C257 . ( indx C257 ) ) = ( [#] ( C244 . ( indx C257 ) ) ) by PENCIL_2:def 2;
take D112 = ( indx C257 );
let C258 being (Segre-Coset of C244);
let C259 , C260 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 ));
L794: C245 is  bijective by PENCIL_2:def 4;
L795: ( rng C245 ) = (the carrier of ( Segre_Product C244 )) by L794 , FUNCT_2:def 3;
L796: ( C245 .: D111 ) = ( product D108 ) by L795 , FUNCT_1:77;
assume L797: (C258 = ( product C259 ) & ( C245 .: C258 ) = ( product C260 ) & ( indx C259 ) = D112);
thus L798: thesis by L797 , L735 , L768 , L792 , L796 , L682;
end;
L799: (for B310 being (Element of C243) holds (ex B311 being (Element of C243) st S4[ B310 , B311 ]))
proof
set D113 = the (Point of ( Segre_Product C244 ));
reconsider D114 = D113 as (Element of ( Carrier C244 )) by L60;
let C261 being (Element of C243);
reconsider D115 = { D114 } as (ManySortedSubset of ( Carrier C244 )) by PENCIL_1:11;
L800: ( dom C244 ) = C243 by PARTFUN1:def 2;
L801: ( C244 . C261 ) in ( rng C244 ) by L800 , FUNCT_1:3;
L802: ( C244 . C261 ) is non  trivial by L801 , PENCIL_1:def 18;
reconsider D116 = ( [#] ( C244 . C261 ) ) as non  trivial set by L802;
reconsider D117 = ( D115 +* (C261 , D116) ) as  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) by PENCIL_1:9 , PENCIL_1:10 , PENCIL_2:7;
L803: ( dom D115 ) = C243 by PARTFUN1:def 2;
L804: ( D117 . C261 ) = D116 by L803 , FUNCT_7:31;
L805: ( indx D117 ) = C261 by L804 , PENCIL_1:def 21;
L806: ( product D117 ) c= (the carrier of ( Segre_Product C244 ))
proof
let C262 being set;
assume L807: C262 in ( product D117 );
consider C263 being Function such that L808: C262 = C263 and L809: ( dom C263 ) = ( dom D117 ) and L810: (for B312 being set holds (B312 in ( dom D117 ) implies ( C263 . B312 ) in ( D117 . B312 ))) by L807 , CARD_3:def 5;
L811: ( dom ( Carrier C244 ) ) = C243 by PARTFUN1:def 2;
L812: ( dom C263 ) = ( dom ( Carrier C244 ) ) by L811 , L809 , PARTFUN1:def 2;
L813:
now
let C264 being set;
assume L814: C264 in ( dom ( Carrier C244 ) );
reconsider D118 = C264 as (Element of C243) by L814;
L815: ( C263 . C264 ) in ( D117 . C264 ) by L809 , L810 , L812 , L814;
per cases ;
suppose L816: D118 = C261;

thus L817: ( C263 . C264 ) in ( ( Carrier C244 ) . C264 ) by L816 , L804 , L815 , L68;
end;
suppose L818: D118 <> C261;

L819: ( C263 . D118 ) in ( D115 . D118 ) by L818 , L815 , FUNCT_7:32;
L820: ( C263 . D118 ) in { ( D114 . D118 ) } by L819 , PZFMISC1:def 1;
L821: ( C263 . D118 ) = ( D114 . D118 ) by L820 , TARSKI:def 1;
L822: ( C263 . D118 ) is (Element of ( ( Carrier C244 ) . D118 )) by L821 , PBOOLE:def 14;
L823: ( [#] ( C244 . D118 ) ) is non  empty;
L824: ( ( Carrier C244 ) . D118 ) is non  empty by L823 , L68;
thus L825: ( C263 . C264 ) in ( ( Carrier C244 ) . C264 ) by L824 , L822;
end;
end;
L827: ( Segre_Product C244 ) = TopStruct (# ( product ( Carrier C244 ) ) , ( Segre_Blocks C244 ) #) by PENCIL_1:def 23;
thus L828: thesis by L827 , L808 , L812 , L813 , CARD_3:def 5;
end;
reconsider D119 = ( product D117 ) as (Segre-Coset of C244) by L806 , L804 , L805 , PENCIL_2:def 2;
reconsider D120 = ( C245 .: D119 ) as (Segre-Coset of C244) by L735 , PENCIL_2:24;
consider C265 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) such that L829: D120 = ( product C265 ) and L830: ( C265 . ( indx C265 ) ) = ( [#] ( C244 . ( indx C265 ) ) ) by PENCIL_2:def 2;
take ( indx C265 );
let C266 being (Segre-Coset of C244);
let C267 , C268 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 ));
assume L831: (C266 = ( product C267 ) & ( C245 .: C266 ) = ( product C268 ) & ( indx C267 ) = C261);
thus L832: thesis by L831 , L735 , L805 , L829 , L682;
end;
L833: (for B313 , B314 , B315 being (Element of C243) holds ((S4[ B313 , B314 ] & S4[ B313 , B315 ]) implies B314 = B315))
proof
let C269 , C270 , C271 being (Element of C243);
assume that
L834: (for B316 being (Segre-Coset of C244) holds (for B317 , B318 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) holds ((B316 = ( product B317 ) & ( C245 .: B316 ) = ( product B318 )) implies (( indx B317 ) = C269 implies ( indx B318 ) = C270))))
and
L835: (for B319 being (Segre-Coset of C244) holds (for B320 , B321 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) holds ((B319 = ( product B320 ) & ( C245 .: B319 ) = ( product B321 )) implies (( indx B320 ) = C269 implies ( indx B321 ) = C271))));
consider C272 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) such that L836: ( indx C272 ) = C269 and L837: ( product C272 ) is (Segre-Coset of C244) by L71;
reconsider D121 = ( product C272 ) as (Segre-Coset of C244) by L837;
reconsider D122 = ( C245 .: D121 ) as (Segre-Coset of C244) by L735 , PENCIL_2:24;
consider C273 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C244 )) such that L838: D122 = ( product C273 ) and L839: ( C273 . ( indx C273 ) ) = ( [#] ( C244 . ( indx C273 ) ) ) by PENCIL_2:def 2;
L840: ( indx C273 ) = C270 by L834 , L836 , L838;
thus L841: thesis by L840 , L835 , L836 , L838;
end;
thus L842: (ex B322 being (Permutation of C243) st (for B323 , B324 being (Element of C243) holds (( B322 . B323 ) = B324 iff S4[ B323 , B324 ]))) from TRANSGEO:sch 1(L799 , L762 , L736 , L833);
end;
definition
let C274 being  finite non  empty set;
let C275 being  PLS-yielding (ManySortedSet of C274);
assume that
L843: (for B325 being (Element of C274) holds ( C275 . B325 ) is  strongly_connected);
let C276 being (Collineation of ( Segre_Product C275 ));
func permutation_of_indices C276 -> (Permutation of C274) means 
:L844: (for B326 , B327 being (Element of C274) holds (( it . B326 ) = B327 iff (for B328 being (Segre-Coset of C275) holds (for B329 , B330 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C275 )) holds ((B328 = ( product B329 ) & ( C276 .: B328 ) = ( product B330 )) implies (( indx B329 ) = B326 implies ( indx B330 ) = B327))))));
existence by L843 , L734;
uniqueness
proof
let C277 , C278 being (Permutation of C274);
assume that
L845: (for B331 , B332 being (Element of C274) holds (( C277 . B331 ) = B332 iff (for B333 being (Segre-Coset of C275) holds (for B334 , B335 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C275 )) holds ((B333 = ( product B334 ) & ( C276 .: B333 ) = ( product B335 )) implies (( indx B334 ) = B331 implies ( indx B335 ) = B332))))))
and
L846: (for B336 , B337 being (Element of C274) holds (( C278 . B336 ) = B337 iff (for B338 being (Segre-Coset of C275) holds (for B339 , B340 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C275 )) holds ((B338 = ( product B339 ) & ( C276 .: B338 ) = ( product B340 )) implies (( indx B339 ) = B336 implies ( indx B340 ) = B337))))));
L847:
now
let C279 being set;
assume L848: C279 in C274;
reconsider D123 = C279 as (Element of C274) by L848;
reconsider D124 = ( C278 . D123 ) as (Element of C274);
reconsider D125 = ( C277 . D123 ) as (Element of C274);
consider C280 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C275 )) such that L849: ( indx C280 ) = D123 and L850: ( product C280 ) is (Segre-Coset of C275) by L71;
reconsider D126 = ( product C280 ) as (Segre-Coset of C275) by L850;
reconsider D127 = ( C276 .: D126 ) as (Segre-Coset of C275) by L843 , PENCIL_2:24;
consider C281 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C275 )) such that L851: D127 = ( product C281 ) and L852: ( C281 . ( indx C281 ) ) = ( [#] ( C275 . ( indx C281 ) ) ) by PENCIL_2:def 2;
L853: D125 = ( indx C281 ) by L845 , L849 , L851
.= D124 by L846 , L849 , L851;
thus L854: ( C277 . C279 ) = ( C278 . C279 ) by L853;
end;
L855: (( dom C277 ) = C274 & ( dom C278 ) = C274) by FUNCT_2:def 1;
thus L856: C277 = C278 by L855 , L847 , FUNCT_1:2;
end;
end;
begin
definition
let C282 being  finite non  empty set;
let C283 being  PLS-yielding (ManySortedSet of C282);
assume that
L858: (for B341 being (Element of C282) holds ( C283 . B341 ) is  strongly_connected);
let C284 being (Collineation of ( Segre_Product C283 ));
let C285 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C283 ));
assume that
L859: ( product C285 ) is (Segre-Coset of C283);
func canonical_embedding (C284 , C285) -> (Function of ( C283 . ( indx C285 ) ) , ( C283 . ( ( permutation_of_indices C284 ) . ( indx C285 ) ) )) means 
:L860: (it is  isomorphic & (for B342 being (ManySortedSet of C282) holds ((B342 is (Point of ( Segre_Product C283 )) & B342 in ( product C285 )) implies (for B343 being (ManySortedSet of C282) holds (B343 = ( C284 . B342 ) implies ( B343 . ( ( permutation_of_indices C284 ) . ( indx C285 ) ) ) = ( it . ( B342 . ( indx C285 ) ) ))))));
existence
proof
reconsider D128 = ( product C285 ) as (Segre-Coset of C283) by L859;
set D129 = ( permutation_of_indices C284 );
set D130 = ( indx C285 );
defpred S5[ set , set ] means (for B344 being (ManySortedSet of C282) holds (B344 in ( C284 .: ( product ( C285 +* (D130 , { $1 }) ) ) ) implies $2 = ( B344 . ( D129 . D130 ) )));
set D131 = (the carrier of ( C283 . D130 ));
set D132 = D129;
reconsider D133 = ( C284 .: D128 ) as (Segre-Coset of C283) by L858 , PENCIL_2:24;
consider C286 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C283 )) such that L861: ( product C286 ) = D133 and L862: ( C286 . ( indx C286 ) ) = ( [#] ( C283 . ( indx C286 ) ) ) by PENCIL_2:def 2;
set D134 = ( indx C286 );
L863: C284 is  bijective by PENCIL_2:def 4;
L864: ( C284 " D133 ) c= D128 by L863 , FUNCT_1:82;
L865: ( Segre_Product C283 ) = TopStruct (# ( product ( Carrier C283 ) ) , ( Segre_Blocks C283 ) #) by PENCIL_1:def 23;
L866: (for B345 being set holds (B345 in D131 implies (ex B346 being set st S5[ B345 , B346 ])))
proof
let C287 being set;
consider C288 being set such that L867: C288 in D128 by XBOOLE_0:def 1;
L868: (ex B347 being Function st (B347 = C288 & ( dom B347 ) = ( dom C285 ) & (for B348 being set holds (B348 in ( dom C285 ) implies ( B347 . B348 ) in ( C285 . B348 ))))) by L867 , CARD_3:def 5;
L869: ( dom C285 ) = C282 by PARTFUN1:def 2;
reconsider D135 = C288 as (ManySortedSet of C282) by L869 , L868 , PARTFUN1:def 2 , RELAT_1:def 18;
set D136 = ( D135 +* (D130 , C287) );
L870: { (D136 qua set) } = ( product ( C285 +* (D130 , { C287 }) ) )
proof
thus L871: { (D136 qua set) } c= ( product ( C285 +* (D130 , { C287 }) ) )
proof
L872:
now
let C289 being set;
assume L873: C289 in ( dom ( C285 +* (D130 , { C287 }) ) );
L874: C289 in C282 by L873;
L875: C289 in ( dom D135 ) by L874 , PARTFUN1:def 2;
per cases ;
suppose L876: C289 = D130;

L877: ( D136 . C289 ) = C287 by L876 , L875 , FUNCT_7:31;
L878: ( D136 . C289 ) in { C287 } by L877 , TARSKI:def 1;
thus L879: ( D136 . C289 ) in ( ( C285 +* (D130 , { C287 }) ) . C289 ) by L878 , L869 , L876 , FUNCT_7:31;
end;
suppose L880: C289 <> D130;

L881: ( D136 . C289 ) = ( D135 . C289 ) by L880 , FUNCT_7:32;
L882: ( D136 . C289 ) in ( C285 . C289 ) by L881 , L867 , L869 , L874 , CARD_3:9;
thus L883: ( D136 . C289 ) in ( ( C285 +* (D130 , { C287 }) ) . C289 ) by L882 , L880 , FUNCT_7:32;
end;
end;
let C290 being set;
assume L885: C290 in { (D136 qua set) };
L886: C290 = D136 by L885 , TARSKI:def 1;
L887: ( dom D136 ) = C282 by PARTFUN1:def 2
.= ( dom ( C285 +* (D130 , { C287 }) ) ) by PARTFUN1:def 2;
thus L888: thesis by L887 , L886 , L872 , CARD_3:9;
end;

let C291 being set;
assume L889: C291 in ( product ( C285 +* (D130 , { C287 }) ) );
consider C292 being Function such that L890: C292 = C291 and L891: ( dom C292 ) = ( dom ( C285 +* (D130 , { C287 }) ) ) and L892: (for B349 being set holds (B349 in ( dom ( C285 +* (D130 , { C287 }) ) ) implies ( C292 . B349 ) in ( ( C285 +* (D130 , { C287 }) ) . B349 ))) by L889 , CARD_3:def 5;
L893:
now
let C293 being set;
assume L894: C293 in ( dom C292 );
L895: C293 in C282 by L894 , L891;
reconsider D137 = C293 as (Element of C282) by L891 , L894;
L896: ( C292 . C293 ) in ( ( C285 +* (D130 , { C287 }) ) . C293 ) by L891 , L892 , L894;
per cases ;
suppose L897: D137 = D130;

L898: ( C292 . C293 ) in { C287 } by L897 , L869 , L896 , FUNCT_7:31;
L899: ( C292 . C293 ) = C287 by L898 , TARSKI:def 1;
thus L900: ( C292 . C293 ) = ( D136 . C293 ) by L899 , L868 , L869 , L897 , FUNCT_7:31;
end;
suppose L901: D137 <> D130;

L902: ( C285 . D137 ) is non  empty  trivial by L901 , PENCIL_1:def 21;
L903: ( C285 . D137 ) is 1 -element by L902;
consider C294 being set such that L904: ( C285 . C293 ) = { C294 } by L903 , ZFMISC_1:131;
L905: ( C292 . C293 ) in ( C285 . C293 ) by L896 , L901 , FUNCT_7:32;
L906: ( C292 . C293 ) = C294 by L905 , L904 , TARSKI:def 1;
L907: ( D136 . C293 ) = ( D135 . C293 ) by L901 , FUNCT_7:32;
L908: ( D136 . C293 ) in { C294 } by L907 , L868 , L869 , L895 , L904;
thus L909: ( C292 . C293 ) = ( D136 . C293 ) by L908 , L906 , TARSKI:def 1;
end;
end;
L911: ( dom C292 ) = C282 by L891 , PARTFUN1:def 2
.= ( dom D136 ) by PARTFUN1:def 2;
L912: C292 = D136 by L911 , L893 , FUNCT_1:2;
thus L913: thesis by L912 , L890 , TARSKI:def 1;
end;
assume L914: C287 in D131;
L915:
now
let C295 being set;
assume L916: C295 in ( dom ( Carrier C283 ) );
reconsider D138 = C295 as (Element of C282) by L916;
per cases ;
suppose L917: D138 = D130;

L918: ( D136 . D138 ) in ( [#] ( C283 . D130 ) ) by L917 , L914 , L868 , L869 , FUNCT_7:31;
thus L919: ( D136 . C295 ) in ( ( Carrier C283 ) . C295 ) by L918 , L917 , L68;
end;
suppose L920: D138 <> D130;

L921: C285 c= ( Carrier C283 ) by PBOOLE:def 18;
L922: ( C285 . C295 ) c= ( ( Carrier C283 ) . C295 ) by L921 , L916 , PBOOLE:def 2;
L923: ( D136 . D138 ) = ( D135 . D138 ) by L920 , FUNCT_7:32;
L924: ( D136 . D138 ) in ( C285 . D138 ) by L923 , L867 , L869 , CARD_3:9;
thus L925: ( D136 . C295 ) in ( ( Carrier C283 ) . C295 ) by L924 , L922;
end;
end;
L927: ( dom D136 ) = C282 by PARTFUN1:def 2
.= ( dom ( Carrier C283 ) ) by PARTFUN1:def 2;
reconsider D139 = D136 as (Point of ( Segre_Product C283 )) by L927 , L865 , L915 , CARD_3:9;
reconsider D140 = ( C284 . D139 ) as (ManySortedSet of C282) by PENCIL_1:14;
take ( D140 . ( D129 . D130 ) );
L928: ( dom C284 ) = (the carrier of ( Segre_Product C283 )) by FUNCT_2:def 1;
L929: D139 in ( dom C284 ) by L928;
L930: ( Im (C284 , D136) ) = { ( C284 . D136 ) } by L929 , FUNCT_1:59;
let C296 being (ManySortedSet of C282);
assume L931: C296 in ( C284 .: ( product ( C285 +* (D130 , { C287 }) ) ) );
thus L932: thesis by L931 , L870 , L930 , TARSKI:def 1;
end;
consider C297 being Function such that L933: (( dom C297 ) = D131 & (for B350 being set holds (B350 in D131 implies S5[ B350 , ( C297 . B350 ) ]))) from CLASSES1:sch 1(L866);
L934: ( dom C284 ) = (the carrier of ( Segre_Product C283 )) by FUNCT_2:def 1;
L935: D128 c= ( C284 " D133 ) by L934 , FUNCT_1:76;
L936: ( C284 " D133 ) = D128 by L935 , L864 , XBOOLE_0:def 10;
L937: ( rng C297 ) c= (the carrier of ( C283 . ( D132 . D130 ) ))
proof
let C298 being set;
assume L938: C298 in ( rng C297 );
consider C299 being set such that L939: C299 in ( dom C297 ) and L940: C298 = ( C297 . C299 ) by L938 , FUNCT_1:def 3;
reconsider D141 = C299 as (Point of ( C283 . D130 )) by L933 , L939;
consider C300 being (ManySortedSet of C282) such that L941: C300 in ( product C285 ) and L942: { (( C300 +* (D130 , D141) ) qua set) } = ( product ( C285 +* (D130 , { D141 }) ) ) by L357;
reconsider D142 = ( C300 +* (D130 , D141) ) as (Point of ( Segre_Product C283 )) by L859 , L941 , PENCIL_1:25;
reconsider D143 = ( C284 . D142 ) as (ManySortedSet of C282) by PENCIL_1:14;
L943: ( Im (C284 , ( C300 +* (D130 , D141) )) ) = { ( C284 . D142 ) } by L934 , FUNCT_1:59;
L944: D143 in ( C284 .: ( product ( C285 +* (D130 , { D141 }) ) ) ) by L943 , L942 , TARSKI:def 1;
L945: ( D129 . D130 ) in C282;
L946: ( D129 . D130 ) in ( dom ( Carrier C283 ) ) by L945 , PARTFUN1:def 2;
L947: ( D143 . ( D129 . D130 ) ) in ( ( Carrier C283 ) . ( D129 . D130 ) ) by L946 , L865 , CARD_3:9;
L948: ( D143 . ( D129 . D130 ) ) in ( [#] ( C283 . ( D129 . D130 ) ) ) by L947 , L68;
thus L949: thesis by L948 , L933 , L940 , L944;
end;
reconsider D144 = C297 as (Function of ( C283 . D130 ) , ( C283 . ( D132 . D130 ) )) by L937 , L933 , FUNCT_2:def 1 , RELSET_1:4;
set D145 = D144;
L950: ( indx C286 ) = ( D129 . D130 ) by L858 , L861 , L844;
L951: D145 is  one-to-one
proof
let C301 , C302 being set;
assume that
L952: (C301 in ( dom D145 ) & C302 in ( dom D145 ))
and
L953: ( D145 . C301 ) = ( D145 . C302 );
reconsider D146 = C301 , D147 = C302 as (Point of ( C283 . D130 )) by L952;
consider C303 being (ManySortedSet of C282) such that L954: C303 in ( product C285 ) and L955: { (( C303 +* (D130 , D146) ) qua set) } = ( product ( C285 +* (D130 , { D146 }) ) ) by L357;
reconsider D148 = ( C303 +* (D130 , D146) ) as (Point of ( Segre_Product C283 )) by L859 , L954 , PENCIL_1:25;
reconsider D149 = ( C284 . D148 ) as (ManySortedSet of C282) by PENCIL_1:14;
consider C304 being (ManySortedSet of C282) such that L956: C304 in ( product C285 ) and L957: { (( C304 +* (D130 , D147) ) qua set) } = ( product ( C285 +* (D130 , { D147 }) ) ) by L357;
L958: ( dom C285 ) = C282 by PARTFUN1:def 2;
L959: ( dom C303 ) = C282 by PARTFUN1:def 2;
L960:
now
let C305 being set;
assume L961: C305 in C282;
per cases ;
suppose L962: C305 = ( indx C285 );

L963: ( ( C303 +* (D130 , D146) ) . C305 ) = D146 by L962 , L959 , FUNCT_7:31;
L964: ( ( C303 +* (D130 , D146) ) . C305 ) in ( [#] ( C283 . D130 ) ) by L963;
thus L965: ( ( C303 +* (D130 , D146) ) . C305 ) in ( C285 . C305 ) by L964 , L859 , L962 , L160;
end;
suppose L966: C305 <> ( indx C285 );

L967: ( ( C303 +* (D130 , D146) ) . C305 ) = ( C303 . C305 ) by L966 , FUNCT_7:32;
thus L968: ( ( C303 +* (D130 , D146) ) . C305 ) in ( C285 . C305 ) by L967 , L954 , L958 , L961 , CARD_3:9;
end;
end;
L970: ( dom ( C303 +* (D130 , D146) ) ) = C282 by PARTFUN1:def 2;
L971: D148 in ( product C285 ) by L970 , L958 , L960 , CARD_3:9;
L972: D149 in D133 by L971 , L934 , FUNCT_1:def 6;
reconsider D150 = ( C304 +* (D130 , D147) ) as (Point of ( Segre_Product C283 )) by L859 , L956 , PENCIL_1:25;
reconsider D151 = ( C284 . D150 ) as (ManySortedSet of C282) by PENCIL_1:14;
L973: ( Im (C284 , ( C304 +* (D130 , D147) )) ) = { ( C284 . D150 ) } by L934 , FUNCT_1:59;
L974: D151 in ( C284 .: ( product ( C285 +* (D130 , { D147 }) ) ) ) by L973 , L957 , TARSKI:def 1;
L975: ( D144 . D147 ) = ( D151 . ( D129 . D130 ) ) by L974 , L933;
L976: ( dom C303 ) = C282 by PARTFUN1:def 2;
L977: ( ( C303 +* (D130 , D146) ) . D130 ) = D146 by L976 , FUNCT_7:31;
L978: ( dom C285 ) = C282 by PARTFUN1:def 2;
L979: ( dom C304 ) = C282 by PARTFUN1:def 2;
L980:
now
let C306 being set;
assume L981: C306 in C282;
per cases ;
suppose L982: C306 = ( indx C285 );

L983: ( ( C304 +* (D130 , D147) ) . C306 ) = D147 by L982 , L979 , FUNCT_7:31;
L984: ( ( C304 +* (D130 , D147) ) . C306 ) in ( [#] ( C283 . D130 ) ) by L983;
thus L985: ( ( C304 +* (D130 , D147) ) . C306 ) in ( C285 . C306 ) by L984 , L859 , L982 , L160;
end;
suppose L986: C306 <> ( indx C285 );

L987: ( ( C304 +* (D130 , D147) ) . C306 ) = ( C304 . C306 ) by L986 , FUNCT_7:32;
thus L988: ( ( C304 +* (D130 , D147) ) . C306 ) in ( C285 . C306 ) by L987 , L956 , L978 , L981 , CARD_3:9;
end;
end;
L990: ( dom ( C304 +* (D130 , D147) ) ) = C282 by PARTFUN1:def 2;
L991: D150 in ( product C285 ) by L990 , L978 , L980 , CARD_3:9;
L992: D151 in D133 by L991 , L934 , FUNCT_1:def 6;
L993: ( Im (C284 , ( C303 +* (D130 , D146) )) ) = { ( C284 . D148 ) } by L934 , FUNCT_1:59;
L994: D149 in ( C284 .: ( product ( C285 +* (D130 , { D146 }) ) ) ) by L993 , L955 , TARSKI:def 1;
L995:
now
let C307 being set;
assume L996: C307 in C282;
reconsider D152 = C307 as (Element of C282) by L996;
per cases ;
suppose L997: D152 = ( indx C286 );

thus L998: ( D149 . C307 ) = ( D151 . C307 ) by L997 , L950 , L933 , L953 , L994 , L975;
end;
suppose L999: D152 <> ( indx C286 );

thus L1000: ( D149 . C307 ) = ( D151 . C307 ) by L999 , L861 , L972 , L992 , PENCIL_1:23;
end;
end;
L1002: ( dom C304 ) = C282 by PARTFUN1:def 2;
L1003: ( ( C304 +* (D130 , D147) ) . D130 ) = D147 by L1002 , FUNCT_7:31;
L1004: (( dom D149 ) = C282 & ( dom D151 ) = C282) by PARTFUN1:def 2;
L1005: D149 = D151 by L1004 , L995 , FUNCT_1:2;
thus L1006: thesis by L1005 , L934 , L863 , L977 , L1003 , FUNCT_1:def 4;
end;
L1007: C284 is  bijective by PENCIL_2:def 4;
L1008: ( rng C284 ) = (the carrier of ( Segre_Product C283 )) by L1007 , FUNCT_2:def 3;
L1009: ( C284 " ) = ( (C284 qua Function) " ) by L863 , TOPS_2:def 4;
L1010: (the carrier of ( C283 . ( D132 . D130 ) )) c= ( rng D145 )
proof
let C308 being set;
assume L1011: C308 in (the carrier of ( C283 . ( D132 . D130 ) ));
reconsider D153 = C308 as (Point of ( C283 . ( D132 . D130 ) )) by L1011;
consider C309 being (ManySortedSet of C282) such that L1012: C309 in ( product C286 ) and L1013: { (( C309 +* (( indx C286 ) , D153) ) qua set) } = ( product ( C286 +* (( indx C286 ) , { D153 }) ) ) by L950 , L357;
reconsider D154 = ( C309 +* (( indx C286 ) , D153) ) as (Point of ( Segre_Product C283 )) by L861 , L950 , L1012 , PENCIL_1:25;
reconsider D155 = D154 as (ManySortedSet of C282);
reconsider D156 = ( ( C284 " ) . D154 ) as (ManySortedSet of C282) by PENCIL_1:14;
L1014: D154 = ( C284 . ( ( C284 " ) . D154 ) ) by L1008 , L863 , L1009 , FUNCT_1:35;
L1015: ( dom C285 ) = C282 by PARTFUN1:def 2;
L1016:
now
let C310 being set;
assume L1017: C310 in C282;
reconsider D157 = C310 as (Element of C282) by L1017;
per cases ;
suppose L1018: D157 = D130;

L1019: ( ( C285 +* (D130 , { ( D156 . D130 ) }) ) . D157 ) = { ( D156 . C310 ) } by L1018 , L1015 , FUNCT_7:31;
thus L1020: ( D156 . C310 ) in ( ( C285 +* (D130 , { ( D156 . D130 ) }) ) . C310 ) by L1019 , TARSKI:def 1;
end;
suppose L1021: D157 <> D130;

L1022: ( ( C285 +* (D130 , { ( D156 . D130 ) }) ) . D157 ) = ( C285 . D157 ) by L1021 , FUNCT_7:32;
L1023: ( dom C286 ) = C282 by PARTFUN1:def 2;
L1024: ( dom C309 ) = C282 by PARTFUN1:def 2;
L1025:
now
let C311 being set;
assume L1026: C311 in C282;
per cases ;
suppose L1027: C311 = ( indx C286 );

L1028: ( D155 . C311 ) = D153 by L1027 , L1024 , FUNCT_7:31;
L1029: ( D155 . C311 ) in (the carrier of ( C283 . ( D132 . D130 ) )) by L1028;
thus L1030: ( D155 . C311 ) in ( C286 . C311 ) by L1029 , L858 , L861 , L862 , L1027 , L844;
end;
suppose L1031: C311 <> ( indx C286 );

L1032: ( D155 . C311 ) = ( C309 . C311 ) by L1031 , FUNCT_7:32;
thus L1033: ( D155 . C311 ) in ( C286 . C311 ) by L1032 , L1012 , L1023 , L1026 , CARD_3:9;
end;
end;
L1035: ( dom D155 ) = C282 by PARTFUN1:def 2;
L1036: D154 in ( product C286 ) by L1035 , L1023 , L1025 , CARD_3:9;
consider C312 being set such that L1037: C312 in ( dom C284 ) and L1038: C312 in D128 and L1039: D154 = ( C284 . C312 ) by L1036 , L861 , FUNCT_1:def 6;
L1040: D156 = C312 by L934 , L863 , L1014 , L1037 , L1039 , FUNCT_1:def 4;
thus L1041: ( D156 . C310 ) in ( ( C285 +* (D130 , { ( D156 . D130 ) }) ) . C310 ) by L1040 , L1015 , L1022 , L1038 , CARD_3:9;
end;
end;
L1043: C282 = ( dom ( Carrier C283 ) ) by PARTFUN1:def 2;
L1044: ( D156 . D130 ) in ( ( Carrier C283 ) . D130 ) by L1043 , L865 , CARD_3:9;
L1045: ( D156 . D130 ) in ( [#] ( C283 . D130 ) ) by L1044 , L68;
L1046: (( dom D156 ) = C282 & ( dom ( C285 +* (D130 , { ( D156 . D130 ) }) ) ) = C282) by PARTFUN1:def 2;
L1047: D156 in ( product ( C285 +* (D130 , { ( D156 . D130 ) }) ) ) by L1046 , L1016 , CARD_3:9;
L1048: ( C309 +* (( indx C286 ) , D153) ) in ( C284 .: ( product ( C285 +* (D130 , { ( D156 . D130 ) }) ) ) ) by L1047 , L934 , L1014 , FUNCT_1:def 6;
L1049: (( dom C309 ) = C282 & ( D145 . ( D156 . D130 ) ) = ( ( C309 +* (( indx C286 ) , D153) ) . ( D129 . D130 ) )) by L1048 , L933 , L1045 , PARTFUN1:def 2;
L1050: (( dom D145 ) = (the carrier of ( C283 . D130 )) & ( D145 . ( D156 . D130 ) ) = C308) by L1049 , L950 , FUNCT_2:def 1 , FUNCT_7:31;
thus L1051: thesis by L1050 , L1045 , FUNCT_1:3;
end;
L1052: ( rng D145 ) = (the carrier of ( C283 . ( D132 . D130 ) )) by L1010 , XBOOLE_0:def 10;
L1053: D145 is  onto by L1052 , FUNCT_2:def 3;
L1054: ( D145 " ) = ( (D145 qua Function) " ) by L1053 , L951 , TOPS_2:def 4;
L1055: ( D145 " ) is  open
proof
let C313 being (Subset of ( C283 . ( D132 . D130 ) ));
assume L1056: C313 is  open;
reconsider D158 = C313 as (Block of ( C283 . ( D132 . D130 ) )) by L1056 , PRE_TOPC:def 2;
reconsider D159 = ( product ( C286 +* (D134 , D158) ) ) as (Block of ( Segre_Product C283 )) by L950 , L198;
reconsider D160 = ( C284 " D159 ) as (Block of ( Segre_Product C283 ));
consider C314 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C283 )) such that L1057: D160 = ( product C314 ) and L1058: ( C314 . ( indx C314 ) ) is (Block of ( C283 . ( indx C314 ) )) by PENCIL_1:24;
L1059: ( dom C286 ) = C282 by PARTFUN1:def 2;
L1060:
now
let C315 being set;
assume L1061: C315 in C282;
per cases ;
suppose L1062: C315 = D134;

L1063: ( ( C286 +* (D134 , D158) ) . C315 ) = D158 by L1062 , L1059 , FUNCT_7:31;
L1064: ( ( C286 +* (D134 , D158) ) . C315 ) c= (the carrier of ( C283 . ( D132 . D130 ) )) by L1063;
thus L1065: ( ( C286 +* (D134 , D158) ) . C315 ) c= ( C286 . C315 ) by L1064 , L858 , L861 , L862 , L1062 , L844;
end;
suppose L1066: C315 <> D134;

thus L1067: ( ( C286 +* (D134 , D158) ) . C315 ) c= ( C286 . C315 ) by L1066 , FUNCT_7:32;
end;
end;
L1069: ( dom ( C286 +* (D134 , D158) ) ) = C282 by PARTFUN1:def 2;
L1070: D159 c= ( product C286 ) by L1069 , L1059 , L1060 , CARD_3:27;
L1071: ( ( product C285 ) /\ ( product C314 ) ) = D160 by L1070 , L861 , L936 , L1057 , RELAT_1:143 , XBOOLE_1:28;
L1072: 2 c= ( card ( ( product C285 ) /\ ( product C314 ) ) ) by L1071 , PENCIL_1:def 6;
L1073: ( indx C314 ) = D130 by L1072 , PENCIL_1:26;
L1074: ( D145 " D158 ) = ( C314 . ( indx C314 ) )
proof
thus L1075: ( D145 " D158 ) c= ( C314 . ( indx C314 ) )
proof
let C316 being set;
L1076: ( dom C286 ) = C282 by PARTFUN1:def 2;
assume L1077: C316 in ( D145 " D158 );
reconsider D161 = C316 as (Point of ( C283 . D130 )) by L1077;
consider C317 being (ManySortedSet of C282) such that L1078: C317 in ( product C285 ) and L1079: { (( C317 +* (D130 , D161) ) qua set) } = ( product ( C285 +* (D130 , { D161 }) ) ) by L357;
reconsider D162 = ( C317 +* (D130 , D161) ) as (Point of ( Segre_Product C283 )) by L859 , L1078 , PENCIL_1:25;
reconsider D163 = ( C284 . D162 ) as (ManySortedSet of C282) by PENCIL_1:14;
L1080: ( Im (C284 , ( C317 +* (D130 , D161) )) ) = { ( C284 . D162 ) } by L934 , FUNCT_1:59;
L1081: D163 in ( C284 .: ( product ( C285 +* (D130 , { D161 }) ) ) ) by L1080 , L1079 , TARSKI:def 1;
L1082: ( product ( C285 +* (D130 , { D161 }) ) ) c= ( product C285 )
proof
let C318 being set;
L1083: ( dom C285 ) = C282 by PARTFUN1:def 2;
assume L1084: C318 in ( product ( C285 +* (D130 , { D161 }) ) );
consider C319 being Function such that L1085: C318 = C319 and L1086: ( dom C319 ) = ( dom ( C285 +* (D130 , { D161 }) ) ) and L1087: (for B351 being set holds (B351 in ( dom ( C285 +* (D130 , { D161 }) ) ) implies ( C319 . B351 ) in ( ( C285 +* (D130 , { D161 }) ) . B351 ))) by L1084 , CARD_3:def 5;
L1088: ( dom C319 ) = C282 by L1086 , PARTFUN1:def 2;
L1089:
now
let C320 being set;
assume L1090: C320 in C282;
L1091: ( C319 . C320 ) in ( ( C285 +* (D130 , { D161 }) ) . C320 ) by L1090 , L1086 , L1087 , L1088;
per cases ;
suppose L1092: C320 = D130;

L1093: ( C319 . C320 ) in { D161 } by L1092 , L1083 , L1091 , FUNCT_7:31;
L1094: ( C319 . C320 ) in ( [#] ( C283 . D130 ) ) by L1093;
thus L1095: ( C319 . C320 ) in ( C285 . C320 ) by L1094 , L859 , L1092 , L160;
end;
suppose L1096: C320 <> D130;

thus L1097: ( C319 . C320 ) in ( C285 . C320 ) by L1096 , L1091 , FUNCT_7:32;
end;
end;
thus L1099: thesis by L1089 , L1085 , L1088 , L1083 , CARD_3:9;
end;
L1100: ( C284 .: ( product ( C285 +* (D130 , { D161 }) ) ) ) c= ( product C286 ) by L1082 , L861 , RELAT_1:123;
L1101: ( D145 . C316 ) in D158 by L1077 , FUNCT_1:def 7;
L1102: ( D163 . ( D129 . D130 ) ) in D158 by L1101 , L933 , L1081;
L1103:
now
let C321 being set;
assume L1104: C321 in C282;
per cases ;
suppose L1105: C321 = D134;

thus L1106: ( D163 . C321 ) in ( ( C286 +* (D134 , D158) ) . C321 ) by L1105 , L950 , L1102 , L1076 , FUNCT_7:31;
end;
suppose L1107: C321 <> D134;

L1108: ( ( C286 +* (D134 , D158) ) . C321 ) = ( C286 . C321 ) by L1107 , FUNCT_7:32;
thus L1109: ( D163 . C321 ) in ( ( C286 +* (D134 , D158) ) . C321 ) by L1108 , L1081 , L1100 , L1076 , L1104 , CARD_3:9;
end;
end;
L1111: (( dom D163 ) = C282 & ( dom ( C286 +* (D134 , D158) ) ) = C282) by PARTFUN1:def 2;
L1112: D163 in D159 by L1111 , L1103 , CARD_3:9;
L1113: (( dom C314 ) = C282 & D162 in D160) by L1112 , L934 , FUNCT_1:def 7 , PARTFUN1:def 2;
L1114: (( dom C317 ) = C282 & ( ( C317 +* (D130 , D161) ) . D130 ) in ( C314 . D130 )) by L1113 , L1057 , CARD_3:9 , PARTFUN1:def 2;
thus L1115: thesis by L1114 , L1073 , FUNCT_7:31;
end;

let C322 being set;
assume L1116: C322 in ( C314 . ( indx C314 ) );
L1117: ( C314 . ( indx C314 ) ) in (the topology of ( C283 . D130 )) by L1058 , L1073;
reconsider D164 = C322 as (Point of ( C283 . D130 )) by L1117 , L1116;
consider C323 being (ManySortedSet of C282) such that L1118: C323 in ( product C285 ) and L1119: { (( C323 +* (D130 , D164) ) qua set) } = ( product ( C285 +* (D130 , { D164 }) ) ) by L357;
reconsider D165 = ( C323 +* (D130 , D164) ) as (Point of ( Segre_Product C283 )) by L859 , L1118 , PENCIL_1:25;
reconsider D166 = ( C284 . D165 ) as (ManySortedSet of C282) by PENCIL_1:14;
L1120: ( dom C285 ) = C282 by PARTFUN1:def 2;
L1121: ( dom C323 ) = C282 by PARTFUN1:def 2;
L1122:
now
let C324 being set;
assume L1123: C324 in C282;
per cases ;
suppose L1124: C324 = D130;

thus L1125: ( ( C323 +* (D130 , D164) ) . C324 ) in ( C314 . C324 ) by L1124 , L1073 , L1116 , L1121 , FUNCT_7:31;
end;
suppose L1126: C324 <> D130;

L1127: ( ( C323 +* (D130 , D164) ) . C324 ) = ( C323 . C324 ) by L1126 , FUNCT_7:32;
L1128: ( ( C323 +* (D130 , D164) ) . C324 ) in ( C285 . C324 ) by L1127 , L1118 , L1120 , L1123 , CARD_3:9;
thus L1129: ( ( C323 +* (D130 , D164) ) . C324 ) in ( C314 . C324 ) by L1128 , L1072 , L1126 , PENCIL_1:26;
end;
end;
L1131: (( dom ( C323 +* (D130 , D164) ) ) = C282 & ( dom C314 ) = C282) by PARTFUN1:def 2;
L1132: D165 in D160 by L1131 , L1057 , L1122 , CARD_3:9;
L1133: (( dom ( C286 +* (D134 , D158) ) ) = C282 & D166 in D159) by L1132 , FUNCT_1:def 7 , PARTFUN1:def 2;
L1134: (( dom C286 ) = C282 & ( D166 . D134 ) in ( ( C286 +* (D134 , D158) ) . D134 )) by L1133 , CARD_3:9 , PARTFUN1:def 2;
L1135: ( D166 . ( D129 . D130 ) ) in D158 by L1134 , L950 , FUNCT_7:31;
L1136: ( Im (C284 , ( C323 +* (D130 , D164) )) ) = { ( C284 . D165 ) } by L934 , FUNCT_1:59;
L1137: D166 in ( C284 .: ( product ( C285 +* (D130 , { D164 }) ) ) ) by L1136 , L1119 , TARSKI:def 1;
L1138: ( D145 . D164 ) = ( D166 . ( D129 . D130 ) ) by L1137 , L933;
thus L1139: thesis by L1138 , L933 , L1135 , FUNCT_1:def 7;
end;
L1140: ( ( D145 " ) .: D158 ) is (Block of ( C283 . D130 )) by L1074 , L951 , L1054 , L1058 , L1073 , FUNCT_1:85;
thus L1141: thesis by L1140 , PRE_TOPC:def 2;
end;
L1142: D145 is  open
proof
let C325 being (Subset of ( C283 . D130 ));
assume L1143: C325 is  open;
reconsider D167 = C325 as (Block of ( C283 . D130 )) by L1143 , PRE_TOPC:def 2;
reconsider D168 = ( product ( C285 +* (D130 , D167) ) ) as (Block of ( Segre_Product C283 )) by L198;
reconsider D169 = ( C284 .: D168 ) as (Block of ( Segre_Product C283 ));
consider C326 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C283 )) such that L1144: D169 = ( product C326 ) and L1145: ( C326 . ( indx C326 ) ) is (Block of ( C283 . ( indx C326 ) )) by PENCIL_1:24;
L1146: ( dom C285 ) = C282 by PARTFUN1:def 2;
L1147:
now
let C327 being set;
assume L1148: C327 in C282;
per cases ;
suppose L1149: C327 = D130;

L1150: ( ( C285 +* (D130 , D167) ) . C327 ) = D167 by L1149 , L1146 , FUNCT_7:31;
L1151: ( ( C285 +* (D130 , D167) ) . C327 ) c= ( [#] ( C283 . D130 ) ) by L1150;
thus L1152: ( ( C285 +* (D130 , D167) ) . C327 ) c= ( C285 . C327 ) by L1151 , L859 , L1149 , L160;
end;
suppose L1153: C327 <> D130;

thus L1154: ( ( C285 +* (D130 , D167) ) . C327 ) c= ( C285 . C327 ) by L1153 , FUNCT_7:32;
end;
end;
L1156: ( dom ( C285 +* (D130 , D167) ) ) = C282 by PARTFUN1:def 2;
L1157: D168 c= ( product C285 ) by L1156 , L1146 , L1147 , CARD_3:27;
L1158: ( ( product C286 ) /\ ( product C326 ) ) = D169 by L1157 , L861 , L1144 , RELAT_1:123 , XBOOLE_1:28;
L1159: 2 c= ( card ( ( product C286 ) /\ ( product C326 ) ) ) by L1158 , PENCIL_1:def 6;
L1160: ( indx C326 ) = ( D132 . D130 ) by L1159 , L950 , PENCIL_1:26;
L1161: ( dom C326 ) = C282 by PARTFUN1:def 2;
L1162: ( D145 .: D167 ) = ( C326 . ( indx C326 ) )
proof
thus L1163: ( D145 .: D167 ) c= ( C326 . ( indx C326 ) )
proof
let C328 being set;
L1164: ( dom C285 ) = C282 by PARTFUN1:def 2;
assume L1165: C328 in ( D145 .: D167 );
consider C329 being set such that L1166: C329 in ( dom D145 ) and L1167: C329 in D167 and L1168: C328 = ( D145 . C329 ) by L1165 , FUNCT_1:def 6;
reconsider D170 = C329 as (Point of ( C283 . D130 )) by L1166;
consider C330 being (ManySortedSet of C282) such that L1169: C330 in ( product C285 ) and L1170: { (( C330 +* (( indx C285 ) , D170) ) qua set) } = ( product ( C285 +* (( indx C285 ) , { D170 }) ) ) by L357;
reconsider D171 = ( C330 +* (( indx C285 ) , D170) ) as (Point of ( Segre_Product C283 )) by L859 , L1169 , PENCIL_1:25;
reconsider D172 = ( C284 . D171 ) as (ManySortedSet of C282) by PENCIL_1:14;
L1171: ( Im (C284 , ( C330 +* (( indx C285 ) , D170) )) ) = { ( C284 . D171 ) } by L934 , FUNCT_1:59;
L1172: D172 in ( C284 .: ( product ( C285 +* (( indx C285 ) , { D170 }) ) ) ) by L1171 , L1170 , TARSKI:def 1;
L1173: ( D145 . D170 ) = ( D172 . ( D129 . D130 ) ) by L1172 , L933;
L1174: ( dom C330 ) = C282 by PARTFUN1:def 2;
L1175:
now
let C331 being set;
assume L1176: C331 in C282;
per cases ;
suppose L1177: C331 = D130;

L1178: ( ( C330 +* (D130 , D170) ) . C331 ) = D170 by L1177 , L1174 , FUNCT_7:31;
thus L1179: ( ( C330 +* (D130 , D170) ) . C331 ) in ( ( C285 +* (D130 , D167) ) . C331 ) by L1178 , L1167 , L1164 , L1177 , FUNCT_7:31;
end;
suppose L1180: C331 <> D130;

L1181: ( ( C330 +* (D130 , D170) ) . C331 ) = ( C330 . C331 ) by L1180 , FUNCT_7:32;
L1182: ( ( C330 +* (D130 , D170) ) . C331 ) in ( C285 . C331 ) by L1181 , L1169 , L1164 , L1176 , CARD_3:9;
thus L1183: ( ( C330 +* (D130 , D170) ) . C331 ) in ( ( C285 +* (D130 , D167) ) . C331 ) by L1182 , L1180 , FUNCT_7:32;
end;
end;
L1185: (( dom ( C330 +* (D130 , D170) ) ) = C282 & ( dom ( C285 +* (D130 , D167) ) ) = C282) by PARTFUN1:def 2;
L1186: D171 in D168 by L1185 , L1175 , CARD_3:9;
L1187: D172 in ( product C326 ) by L1186 , L934 , L1144 , FUNCT_1:def 6;
thus L1188: thesis by L1187 , L1161 , L1160 , L1168 , L1173 , CARD_3:9;
end;

let C332 being set;
assume L1189: C332 in ( C326 . ( indx C326 ) );
L1190: ( C326 . ( indx C326 ) ) in (the topology of ( C283 . ( D129 . D130 ) )) by L1145 , L1160;
reconsider D173 = C332 as (Point of ( C283 . ( D129 . D130 ) )) by L1190 , L1189;
consider C333 being (ManySortedSet of C282) such that L1191: C333 in ( product C326 ) and L1192: { (( C333 +* (( D129 . D130 ) , D173) ) qua set) } = ( product ( C326 +* (( D129 . D130 ) , { D173 }) ) ) by L1160 , L357;
L1193: D169 in (the topology of ( Segre_Product C283 ));
reconsider D174 = ( C333 +* (( D129 . D130 ) , D173) ) as (Point of ( Segre_Product C283 )) by L1193 , L1144 , L1191 , PENCIL_1:25;
reconsider D175 = ( ( C284 " ) . D174 ) as (ManySortedSet of C282) by PENCIL_1:14;
L1194: ( dom C326 ) = C282 by PARTFUN1:def 2;
L1195: ( dom C333 ) = C282 by PARTFUN1:def 2;
L1196:
now
let C334 being set;
assume L1197: C334 in C282;
per cases ;
suppose L1198: C334 = ( D129 . D130 );

thus L1199: ( ( C333 +* (( D129 . D130 ) , D173) ) . C334 ) in ( C326 . C334 ) by L1198 , L1160 , L1189 , L1195 , FUNCT_7:31;
end;
suppose L1200: C334 <> ( D129 . D130 );

L1201: ( ( C333 +* (( D129 . D130 ) , D173) ) . C334 ) = ( C333 . C334 ) by L1200 , FUNCT_7:32;
thus L1202: ( ( C333 +* (( D129 . D130 ) , D173) ) . C334 ) in ( C326 . C334 ) by L1201 , L1191 , L1194 , L1197 , CARD_3:9;
end;
end;
L1204: D174 = ( C284 . D175 ) by L1008 , L863 , L1009 , FUNCT_1:35;
L1205: ( dom ( C333 +* (( D129 . D130 ) , D173) ) ) = C282 by PARTFUN1:def 2;
L1206: D174 in ( C284 .: D168 ) by L1205 , L1144 , L1194 , L1196 , CARD_3:9;
L1207: (ex B352 being set st (B352 in ( dom C284 ) & B352 in D168 & D174 = ( C284 . B352 ))) by L1206 , FUNCT_1:def 6;
L1208: D175 in D168 by L1207 , L934 , L863 , L1204 , FUNCT_1:def 4;
L1209: ( dom ( C285 +* (D130 , D167) ) ) = C282 by PARTFUN1:def 2;
L1210: ( D175 . D130 ) in ( ( C285 +* (D130 , D167) ) . D130 ) by L1209 , L1208 , CARD_3:9;
L1211: ( D175 . D130 ) in D167 by L1210 , L1146 , FUNCT_7:31;
reconsider D176 = ( D175 . D130 ) as (Point of ( C283 . D130 )) by L1211;
consider C335 being (ManySortedSet of C282) such that L1212: C335 in ( product C285 ) and L1213: { (( C335 +* (D130 , D176) ) qua set) } = ( product ( C285 +* (D130 , { D176 }) ) ) by L357;
L1214: ( dom C335 ) = C282 by PARTFUN1:def 2;
L1215:
now
let C336 being set;
assume L1216: C336 in C282;
per cases ;
suppose L1217: C336 = D130;

thus L1218: ( ( C335 +* (D130 , D176) ) . C336 ) = ( D175 . C336 ) by L1217 , L1214 , FUNCT_7:31;
end;
suppose L1219: C336 <> D130;

L1220: ( ( C335 +* (D130 , D176) ) . C336 ) = ( C335 . C336 ) by L1219 , FUNCT_7:32;
thus L1221: ( ( C335 +* (D130 , D176) ) . C336 ) = ( D175 . C336 ) by L1220 , L1157 , L1208 , L1212 , L1219 , PENCIL_1:23;
end;
end;
L1223: (( dom D175 ) = C282 & ( dom ( C335 +* (D130 , D176) ) ) = C282) by PARTFUN1:def 2;
L1224: ( C335 +* (D130 , D176) ) = D175 by L1223 , L1215 , FUNCT_1:2;
L1225: ( Im (C284 , ( C335 +* (D130 , D176) )) ) = { ( C284 . D175 ) } by L1224 , L934 , FUNCT_1:59;
L1226: D174 in ( C284 .: ( product ( C285 +* (D130 , { D176 }) ) ) ) by L1225 , L1204 , L1213 , TARSKI:def 1;
L1227: ( D145 . ( D175 . D130 ) ) = ( ( C333 +* (( D129 . D130 ) , D173) ) . ( D129 . D130 ) ) by L1226 , L933;
L1228: ( D145 . ( D175 . D130 ) ) = C332 by L1227 , L1195 , FUNCT_7:31;
thus L1229: thesis by L1228 , L933 , L1211 , FUNCT_1:def 6;
end;
thus L1230: thesis by L1162 , L1145 , L1160 , PRE_TOPC:def 2;
end;
take D144;
L1231: D145 is  onto by L1052 , FUNCT_2:def 3;
L1232: ( D145 " ) is  bijective by L1231 , L951 , PENCIL_2:12;
thus L1233: D145 is  isomorphic by L1232 , L951 , L1231 , L1142 , L1055 , PENCIL_2:def 4;
let C337 being (ManySortedSet of C282);
assume that
L1234: C337 is (Point of ( Segre_Product C283 ))
and
L1235: C337 in ( product C285 );
L1236: ( dom ( Carrier C283 ) ) = C282 by PARTFUN1:def 2;
L1237: ( C337 . D130 ) in ( ( Carrier C283 ) . D130 ) by L1236 , L865 , L1234 , CARD_3:9;
L1238: ( C337 . D130 ) in ( [#] ( C283 . D130 ) ) by L1237 , L68;
reconsider D177 = ( C337 . D130 ) as (Point of ( C283 . D130 )) by L1238;
L1239: ( dom C285 ) = C282 by PARTFUN1:def 2;
L1240:
now
let C338 being set;
assume L1241: C338 in C282;
per cases ;
suppose L1242: C338 = D130;

L1243: ( ( C285 +* (D130 , { D177 }) ) . C338 ) = { D177 } by L1242 , L1239 , FUNCT_7:31;
thus L1244: ( C337 . C338 ) in ( ( C285 +* (D130 , { D177 }) ) . C338 ) by L1243 , L1242 , TARSKI:def 1;
end;
suppose L1245: C338 <> D130;

L1246: ( ( C285 +* (D130 , { D177 }) ) . C338 ) = ( C285 . C338 ) by L1245 , FUNCT_7:32;
thus L1247: ( C337 . C338 ) in ( ( C285 +* (D130 , { D177 }) ) . C338 ) by L1246 , L1235 , L1239 , L1241 , CARD_3:9;
end;
end;
L1249: (( dom C337 ) = C282 & ( dom ( C285 +* (D130 , { D177 }) ) ) = C282) by PARTFUN1:def 2;
L1250: C337 in ( product ( C285 +* (D130 , { D177 }) ) ) by L1249 , L1240 , CARD_3:9;
let C339 being (ManySortedSet of C282);
assume L1251: C339 = ( C284 . C337 );
L1252: C339 in ( C284 .: ( product ( C285 +* (D130 , { D177 }) ) ) ) by L1251 , L934 , L1234 , L1250 , FUNCT_1:def 6;
thus L1253: thesis by L1252 , L933;
end;
uniqueness
proof
set D178 = ( indx C285 );
set D179 = ( permutation_of_indices C284 );
let C340 , C341 being (Function of ( C283 . D178 ) , ( C283 . ( ( permutation_of_indices C284 ) . D178 ) ));
assume that
L1254: C340 is  isomorphic
and
L1255: (for B353 being (ManySortedSet of C282) holds ((B353 is (Point of ( Segre_Product C283 )) & B353 in ( product C285 )) implies (for B354 being (ManySortedSet of C282) holds (B354 = ( C284 . B353 ) implies ( B354 . ( D179 . D178 ) ) = ( C340 . ( B353 . D178 ) )))))
and
L1256: C341 is  isomorphic
and
L1257: (for B355 being (ManySortedSet of C282) holds ((B355 is (Point of ( Segre_Product C283 )) & B355 in ( product C285 )) implies (for B356 being (ManySortedSet of C282) holds (B356 = ( C284 . B355 ) implies ( B356 . ( D179 . D178 ) ) = ( C341 . ( B355 . D178 ) )))));
L1258:
now
let C342 being set;
consider C343 being set such that L1259: C343 in ( product C285 ) by XBOOLE_0:def 1;
assume L1260: C342 in ( dom C340 );
reconsider D180 = C342 as (Point of ( C283 . D178 )) by L1260;
reconsider D181 = C343 as (Point of ( Segre_Product C283 )) by L859 , L1259;
reconsider D182 = D181 as (ManySortedSet of C282) by PENCIL_1:14;
set D183 = ( D182 +* (D178 , D180) );
reconsider D184 = D183 as (Point of ( Segre_Product C283 )) by PENCIL_1:25;
L1261: ( dom C285 ) = C282 by PARTFUN1:def 2;
L1262: ( dom D182 ) = C282 by PARTFUN1:def 2;
L1263:
now
let C344 being set;
assume L1264: C344 in C282;
per cases ;
suppose L1265: C344 = D178;

L1266: ( D183 . C344 ) = D180 by L1265 , L1262 , FUNCT_7:31;
L1267: ( D183 . C344 ) in ( [#] ( C283 . D178 ) ) by L1266;
thus L1268: ( D183 . C344 ) in ( C285 . C344 ) by L1267 , L859 , L1265 , L160;
end;
suppose L1269: C344 <> D178;

L1270: ( D183 . C344 ) = ( D182 . C344 ) by L1269 , FUNCT_7:32;
thus L1271: ( D183 . C344 ) in ( C285 . C344 ) by L1270 , L1259 , L1261 , L1264 , CARD_3:9;
end;
end;
reconsider D185 = ( C284 . D184 ) as (ManySortedSet of C282) by PENCIL_1:14;
L1273: ( dom D182 ) = C282 by PARTFUN1:def 2;
L1274: ( D183 . D178 ) = C342 by L1273 , FUNCT_7:31;
L1275: ( dom D183 ) = C282 by PARTFUN1:def 2;
L1276: D183 in ( product C285 ) by L1275 , L1261 , L1263 , CARD_3:9;
L1277: ( C341 . ( D183 . D178 ) ) = ( D185 . ( D179 . D178 ) ) by L1276 , L1257;
thus L1278: ( C340 . C342 ) = ( C341 . C342 ) by L1277 , L1255 , L1276 , L1274;
end;
L1279: ( dom C340 ) = (the carrier of ( C283 . D178 )) by FUNCT_2:def 1
.= ( dom C341 ) by FUNCT_2:def 1;
thus L1280: C340 = C341 by L1279 , L1258 , FUNCT_1:2;
end;
end;
theorem
L1282: (for B357 being  finite non  empty set holds (for B358 being  PLS-yielding (ManySortedSet of B357) holds ((for B359 being (Element of B357) holds ( B358 . B359 ) is  strongly_connected) implies (for B360 being (Collineation of ( Segre_Product B358 )) holds (for B361 , B362 being (Segre-Coset of B358) holds ((B361 misses B362 & B361 '||' B362) implies (for B363 , B364 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B358 )) holds ((( product B363 ) = B361 & ( product B364 ) = B362) implies ( canonical_embedding (B360 , B363) ) = ( canonical_embedding (B360 , B364) )))))))))
proof
let C345 being  finite non  empty set;
let C346 being  PLS-yielding (ManySortedSet of C345);
assume that
L1283: (for B365 being (Element of C345) holds ( C346 . B365 ) is  strongly_connected);
let C347 being (Collineation of ( Segre_Product C346 ));
let C348 , C349 being (Segre-Coset of C346);
assume that
L1284: C348 misses C349
and
L1285: C348 '||' C349;
let C350 , C351 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C346 ));
assume that
L1286: ( product C350 ) = C348
and
L1287: ( product C351 ) = C349;
L1288: ( indx C350 ) = ( indx C351 ) by L1284 , L1285 , L1286 , L1287 , L437;
reconsider D186 = ( C347 .: C348 ) , D187 = ( C347 .: C349 ) as (Segre-Coset of C346) by L1283 , PENCIL_2:24;
L1289: C347 is  bijective by PENCIL_2:def 4;
L1290: D186 misses D187 by L1289 , L1284 , FUNCT_1:66;
set D188 = ( indx C350 );
consider C352 being (Element of C345) such that L1291: C352 <> ( indx C350 ) and L1292: (for B366 being (Element of C345) holds (B366 <> C352 implies ( C350 . B366 ) = ( C351 . B366 ))) and L1293: (for B367 , B368 being (Point of ( C346 . C352 )) holds ((( C350 . C352 ) = { B367 } & ( C351 . C352 ) = { B368 }) implies B367 , B368 are_collinear )) by L1284 , L1285 , L1286 , L1287 , L437;
consider C353 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C346 )) such that L1294: ( product C353 ) = D187 and L1295: ( C353 . ( indx C353 ) ) = ( [#] ( C346 . ( indx C353 ) ) ) by PENCIL_2:def 2;
consider C354 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C346 )) such that L1296: ( product C354 ) = D186 and L1297: ( C354 . ( indx C354 ) ) = ( [#] ( C346 . ( indx C354 ) ) ) by PENCIL_2:def 2;
L1298: D186 '||' D187 by L1285 , L414;
L1299: ( indx C354 ) = ( indx C353 ) by L1298 , L1290 , L1296 , L1294 , L437;
set D189 = ( indx C354 );
L1300: ( dom C347 ) = (the carrier of ( Segre_Product C346 )) by FUNCT_2:def 1;
L1301: ( dom C350 ) = C345 by PARTFUN1:def 2;
L1302:
now
L1303: ( C351 . C352 ) is  trivial by L1288 , L1291 , PENCIL_1:def 21;
consider C355 being set such that L1304: ( C351 . C352 ) = { C355 } by L1303 , ZFMISC_1:131;
L1305: C351 c= ( Carrier C346 ) by PBOOLE:def 18;
L1306: ( C351 . C352 ) c= ( ( Carrier C346 ) . C352 ) by L1305 , PBOOLE:def 2;
L1307: { C355 } c= ( [#] ( C346 . C352 ) ) by L1306 , L1304 , L68;
let C356 being set;
consider C357 being set such that L1308: C357 in ( product C350 ) by XBOOLE_0:def 1;
assume L1309: C356 in (the carrier of ( C346 . D188 ));
reconsider D190 = C356 as (Point of ( C346 . D188 )) by L1309;
reconsider D191 = C357 as (Point of ( Segre_Product C346 )) by L1286 , L1308;
reconsider D192 = D191 as (ManySortedSet of C345) by PENCIL_1:14;
set D193 = ( D192 +* (D188 , D190) );
reconsider D194 = D193 as (Point of ( Segre_Product C346 )) by PENCIL_1:25;
L1310: ( C350 . C352 ) is  trivial by L1291 , PENCIL_1:def 21;
consider C358 being set such that L1311: ( C350 . C352 ) = { C358 } by L1310 , ZFMISC_1:131;
L1312: C350 c= ( Carrier C346 ) by PBOOLE:def 18;
L1313: ( C350 . C352 ) c= ( ( Carrier C346 ) . C352 ) by L1312 , PBOOLE:def 2;
L1314: { C358 } c= ( [#] ( C346 . C352 ) ) by L1313 , L1311 , L68;
reconsider D195 = C358 as (Point of ( C346 . C352 )) by L1314 , ZFMISC_1:31;
reconsider D196 = C355 as (Point of ( C346 . C352 )) by L1307 , ZFMISC_1:31;
set D197 = ( D193 +* (C352 , D196) );
L1315: D193 is (Point of ( Segre_Product C346 )) by PENCIL_1:25;
reconsider D198 = D197 as (Point of ( Segre_Product C346 )) by L1315 , PENCIL_1:25;
per cases ;
suppose L1316: D195 <> D196;

L1317: ( D193 . C352 ) = ( D192 . C352 ) by L1291 , FUNCT_7:32;
L1318: ( D193 . C352 ) in ( C350 . C352 ) by L1317 , L1301 , L1308 , CARD_3:9;
L1319: ( D193 . C352 ) = D195 by L1318 , L1311 , TARSKI:def 1;
L1320: ( dom D193 ) = C345 by PARTFUN1:def 2;
L1321: ( D197 . C352 ) = D196 by L1320 , FUNCT_7:31;
L1322:
now
let C359 , C360 being (ManySortedSet of C345);
assume that
L1323: (C359 = D194 & C360 = D198);
take D199 = C352;
thus L1324: (for B369 , B370 being (Point of ( C346 . D199 )) holds ((B369 = ( C359 . D199 ) & B370 = ( C360 . D199 )) implies (B369 <> B370 & B369 , B370 are_collinear ))) by L1293 , L1311 , L1304 , L1316 , L1319 , L1321 , L1323;
let C361 being (Element of C345);
assume L1325: C361 <> D199;
thus L1326: ( C359 . C361 ) = ( C360 . C361 ) by L1325 , L1323 , FUNCT_7:32;
end;
L1327: D194 , D198 are_collinear  by L1322 , L1316 , L1319 , L1321 , L276;
L1328: ( C347 . D194 ) , ( C347 . D198 ) are_collinear  by L1327 , L1;
reconsider D200 = ( C347 . D194 ) , D201 = ( C347 . D198 ) as (ManySortedSet of C345) by PENCIL_1:14;
L1329: ( dom C350 ) = C345 by PARTFUN1:def 2;
L1330: ( dom D192 ) = C345 by PARTFUN1:def 2;
L1331:
now
let C362 being set;
assume L1332: C362 in C345;
per cases ;
suppose L1333: C362 = D188;

L1334: (( D193 . C362 ) = D190 & ( C350 . C362 ) = ( [#] ( C346 . D188 ) )) by L1333 , L1286 , L1330 , L160 , FUNCT_7:31;
thus L1335: ( D193 . C362 ) in ( C350 . C362 ) by L1334;
end;
suppose L1336: C362 <> D188;

L1337: ( D193 . C362 ) = ( D192 . C362 ) by L1336 , FUNCT_7:32;
thus L1338: ( D193 . C362 ) in ( C350 . C362 ) by L1337 , L1308 , L1329 , L1332 , CARD_3:9;
end;
end;
L1340: ( dom D193 ) = C345 by PARTFUN1:def 2;
L1341: D193 in ( product C350 ) by L1340 , L1329 , L1331 , CARD_3:9;
L1342:
now
let C363 being set;
assume L1343: C363 in C345;
per cases ;
suppose L1344: C363 = C352;

L1345: ( D197 . C363 ) = D196 by L1344 , L1340 , FUNCT_7:31;
thus L1346: ( D197 . C363 ) in ( C351 . C363 ) by L1345 , L1304 , L1344 , TARSKI:def 1;
end;
suppose L1347: C363 <> C352;

L1348: ( D197 . C363 ) = ( D193 . C363 ) by L1347 , FUNCT_7:32;
L1349: ( D197 . C363 ) in ( C350 . C363 ) by L1348 , L1331 , L1343;
thus L1350: ( D197 . C363 ) in ( C351 . C363 ) by L1349 , L1292 , L1343 , L1347;
end;
end;
L1352: (( dom D197 ) = C345 & ( dom C351 ) = C345) by PARTFUN1:def 2;
L1353: D197 in ( product C351 ) by L1352 , L1342 , CARD_3:9;
L1354: ( ( canonical_embedding (C347 , C351) ) . ( D197 . D188 ) ) = ( D201 . ( ( permutation_of_indices C347 ) . D188 ) ) by L1353 , L1283 , L1287 , L1288 , L860;
L1355: ( C347 . D194 ) <> ( C347 . D198 ) by L1300 , L1289 , L1316 , L1319 , L1321 , FUNCT_1:def 4;
L1356:
now
consider C364 being (Element of C345) such that L1357: (for B371 , B372 being (Point of ( C346 . C364 )) holds ((B371 = ( D200 . C364 ) & B372 = ( D201 . C364 )) implies (B371 <> B372 & B371 , B372 are_collinear ))) and L1358: (for B373 being (Element of C345) holds (B373 <> C364 implies ( D200 . B373 ) = ( D201 . B373 ))) by L1355 , L1328 , L276;
assume L1359: ( D200 . D189 ) <> ( D201 . D189 );
L1360: D189 = C364 by L1359 , L1358;
L1361: ( dom C353 ) = C345 by PARTFUN1:def 2;
L1362: D200 in D186 by L1300 , L1286 , L1341 , FUNCT_1:def 6;
L1363: ( dom C354 ) = C345 by PARTFUN1:def 2;
L1364:
now
let C365 being set;
assume L1365: C365 in C345;
reconsider D202 = C365 as (Element of C345) by L1365;
per cases ;
suppose L1366: D202 = D189;

thus L1367: ( D200 . C365 ) in ( C353 . C365 ) by L1366 , L1296 , L1297 , L1295 , L1299 , L1362 , L1363 , CARD_3:9;
end;
suppose L1368: D202 <> D189;

L1369: ( D200 . D202 ) = ( D201 . D202 ) by L1368 , L1358 , L1360;
L1370: D201 in ( product C353 ) by L1300 , L1287 , L1294 , L1353 , FUNCT_1:def 6;
thus L1371: ( D200 . C365 ) in ( C353 . C365 ) by L1370 , L1361 , L1369 , CARD_3:9;
end;
end;
L1373: ( dom D200 ) = C345 by PARTFUN1:def 2;
L1374: D200 in ( product C353 ) by L1373 , L1361 , L1364 , CARD_3:9;
L1375: D200 in ( ( product C354 ) /\ ( product C353 ) ) by L1374 , L1296 , L1362 , XBOOLE_0:def 4;
thus L1376: contradiction by L1375 , L1290 , L1296 , L1294 , XBOOLE_0:def 7;
end;
L1377: D189 = ( ( permutation_of_indices C347 ) . D188 ) by L1283 , L1286 , L1296 , L844;
L1378: ( dom D192 ) = C345 by PARTFUN1:def 2;
L1379: ( D193 . D188 ) = C356 by L1378 , FUNCT_7:31;
L1380: ( D197 . D188 ) = C356 by L1379 , L1291 , FUNCT_7:32;
thus L1381: ( ( canonical_embedding (C347 , C350) ) . C356 ) = ( ( canonical_embedding (C347 , C351) ) . C356 ) by L1380 , L1283 , L1286 , L1377 , L1341 , L1354 , L1356 , L1379 , L860;
end;
suppose L1382: D195 = D196;

L1383:
now
let C366 being set;
assume L1384: C366 in C345;
reconsider D203 = C366 as (Element of C345) by L1384;
per cases ;
suppose L1385: C352 = D203;

thus L1386: ( C350 . C366 ) = ( C351 . C366 ) by L1385 , L1311 , L1304 , L1382;
end;
suppose L1387: C352 <> D203;

thus L1388: ( C350 . C366 ) = ( C351 . C366 ) by L1387 , L1292;
end;
end;
L1390: (( dom C350 ) = C345 & ( dom C351 ) = C345) by PARTFUN1:def 2;
thus L1391: ( ( canonical_embedding (C347 , C350) ) . C356 ) = ( ( canonical_embedding (C347 , C351) ) . C356 ) by L1390 , L1383 , FUNCT_1:2;
end;
end;
L1393: (( dom ( canonical_embedding (C347 , C350) ) ) = (the carrier of ( C346 . D188 )) & ( dom ( canonical_embedding (C347 , C351) ) ) = (the carrier of ( C346 . D188 ))) by L1288 , FUNCT_2:def 1;
thus L1394: thesis by L1393 , L1302 , FUNCT_1:2;
end;
theorem
L1395: (for B374 being  finite non  empty set holds (for B375 being  PLS-yielding (ManySortedSet of B374) holds ((for B376 being (Element of B374) holds ( B375 . B376 ) is  strongly_connected) implies (for B377 being (Collineation of ( Segre_Product B375 )) holds (for B378 , B379 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier B375 )) holds ((( product B378 ) is (Segre-Coset of B375) & ( product B379 ) is (Segre-Coset of B375) & ( indx B378 ) = ( indx B379 )) implies ( canonical_embedding (B377 , B378) ) = ( canonical_embedding (B377 , B379) )))))))
proof
let C367 being  finite non  empty set;
let C368 being  PLS-yielding (ManySortedSet of C367);
assume that
L1396: (for B380 being (Element of C367) holds ( C368 . B380 ) is  strongly_connected);
L1397:
now
let C369 being (Element of C367);
L1398: ( C368 . C369 ) is  strongly_connected by L1396;
thus L1399: ( C368 . C369 ) is  connected by L1398 , L47;
end;
let C370 being (Collineation of ( Segre_Product C368 ));
let C371 , C372 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C368 ));
assume that
L1400: (( product C371 ) is (Segre-Coset of C368) & ( product C372 ) is (Segre-Coset of C368))
and
L1401: ( indx C371 ) = ( indx C372 );
reconsider D204 = ( product C371 ) , D205 = ( product C372 ) as (Segre-Coset of C368) by L1400;
per cases ;
suppose L1402: D204 misses D205;

consider C373 being (FinSequence of ( bool (the carrier of ( Segre_Product C368 )) )) such that L1403: ( C373 . 1 ) = D204 and L1404: ( C373 . ( len C373 ) ) = D205 and L1405: (for B381 being Nat holds (B381 in ( dom C373 ) implies ( C373 . B381 ) is (Segre-Coset of C368))) and L1406: (for B382 being Nat holds ((1 <= B382 & B382 < ( len C373 )) implies (for B383 , B384 being (Segre-Coset of C368) holds ((B383 = ( C373 . B382 ) & B384 = ( C373 . ( B382 + 1 ) )) implies (B383 misses B384 & B383 '||' B384))))) by L1402 , L1397 , L1401 , L640;
defpred S6[ Nat ] means ($1 in ( dom C373 ) implies (for B385 being (Segre-Coset of C368) holds (B385 = ( C373 . $1 ) implies (for B386 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C368 )) holds (B385 = ( product B386 ) implies ( canonical_embedding (C370 , C371) ) = ( canonical_embedding (C370 , B386) ))))));
L1407:
now
let C374 being Nat;
assume L1408: S6[ C374 ];
thus L1409: S6[ ( C374 + 1 ) ]
proof
assume L1410: ( C374 + 1 ) in ( dom C373 );
L1411: ( C374 + 1 ) <= ( len C373 ) by L1410 , FINSEQ_3:25;
L1412: C374 < ( len C373 ) by L1411 , NAT_1:13;
let C375 being (Segre-Coset of C368);
assume that
L1413: C375 = ( C373 . ( C374 + 1 ) );
let C376 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C368 ));
assume that
L1414: C375 = ( product C376 );
per cases  by NAT_1:14;
suppose L1415: C374 = ( 0 );

thus L1416: thesis by L1415 , L1403 , L1413 , L1414 , PUA2MSS1:2;
end;
suppose L1417: 1 <= C374;

L1418: C374 in ( dom C373 ) by L1417 , L1412 , FINSEQ_3:25;
reconsider D206 = ( C373 . C374 ) as (Segre-Coset of C368) by L1418 , L1405;
consider C377 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C368 )) such that L1419: ( product C377 ) = D206 and L1420: ( C377 . ( indx C377 ) ) = ( [#] ( C368 . ( indx C377 ) ) ) by PENCIL_2:def 2;
L1421: (D206 misses C375 & D206 '||' C375) by L1406 , L1412 , L1413 , L1417;
L1422: ( canonical_embedding (C370 , C377) ) = ( canonical_embedding (C370 , C376) ) by L1421 , L1396 , L1414 , L1419 , L1282;
thus L1423: thesis by L1422 , L1408 , L1412 , L1417 , L1419 , FINSEQ_3:25;
end;
end;

end;
L1410: S6[ ( 0 ) ] by FINSEQ_3:24;
L1411: (for B387 being Nat holds S6[ B387 ]) from NAT_1:sch 2(L1410 , L1407);
L1412: S6[ ( len C373 ) ] by L1411;
L1413: 1 in ( dom C373 ) by L1403 , FUNCT_1:def 2;
L1414: 1 <= ( len C373 ) by L1413 , FINSEQ_3:25;
thus L1415: thesis by L1414 , L1404 , L1412 , FINSEQ_3:25;
end;
suppose L1416: D204 meets D205;

thus L1417: thesis by L1416 , L1401 , L166;
end;
end;
definition
let C378 being  finite non  empty set;
let C379 being  PLS-yielding (ManySortedSet of C378);
assume that
L1419: (for B388 being (Element of C378) holds ( C379 . B388 ) is  strongly_connected);
let C380 being (Collineation of ( Segre_Product C379 ));
let C381 being (Element of C378);
func canonical_embedding (C380 , C381) -> (Function of ( C379 . C381 ) , ( C379 . ( ( permutation_of_indices C380 ) . C381 ) )) means 
:L1420: (for B389 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C379 )) holds ((( product B389 ) is (Segre-Coset of C379) & ( indx B389 ) = C381) implies it = ( canonical_embedding (C380 , B389) )));
existence
proof
consider C382 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C379 )) such that L1421: ( indx C382 ) = C381 and L1422: ( product C382 ) is (Segre-Coset of C379) by L71;
reconsider D207 = ( canonical_embedding (C380 , C382) ) as (Function of ( C379 . C381 ) , ( C379 . ( ( permutation_of_indices C380 ) . C381 ) )) by L1421;
take D207;
let C383 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C379 ));
assume L1423: (( product C383 ) is (Segre-Coset of C379) & ( indx C383 ) = C381);
thus L1424: thesis by L1423 , L1419 , L1421 , L1422 , L1395;
end;
uniqueness
proof
let C384 , C385 being (Function of ( C379 . C381 ) , ( C379 . ( ( permutation_of_indices C380 ) . C381 ) ));
assume that
L1425: (for B390 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C379 )) holds ((( product B390 ) is (Segre-Coset of C379) & ( indx B390 ) = C381) implies C384 = ( canonical_embedding (C380 , B390) )))
and
L1426: (for B391 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C379 )) holds ((( product B391 ) is (Segre-Coset of C379) & ( indx B391 ) = C381) implies C385 = ( canonical_embedding (C380 , B391) )));
consider C386 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C379 )) such that L1427: (( indx C386 ) = C381 & ( product C386 ) is (Segre-Coset of C379)) by L71;
thus L1428: C384 = ( canonical_embedding (C380 , C386) ) by L1425 , L1427
.= C385 by L1426 , L1427;
end;
end;
theorem
L1430: (for B392 being  finite non  empty set holds (for B393 being  PLS-yielding (ManySortedSet of B392) holds ((for B394 being (Element of B392) holds ( B393 . B394 ) is  strongly_connected) implies (for B395 being (Collineation of ( Segre_Product B393 )) holds (ex B396 being (Permutation of B392) st (ex B397 being  Function-yielding (ManySortedSet of B392) st (for B398 being (Element of B392) holds (( B397 . B398 ) is (Function of ( B393 . B398 ) , ( B393 . ( B396 . B398 ) )) & (for B399 being (Function of ( B393 . B398 ) , ( B393 . ( B396 . B398 ) )) holds (B399 = ( B397 . B398 ) implies B399 is  isomorphic)) & (for B400 being (Point of ( Segre_Product B393 )) holds (for B401 being (ManySortedSet of B392) holds (B401 = B400 implies (for B402 being (ManySortedSet of B392) holds (B402 = ( B395 . B400 ) implies (for B403 being (Function of ( B393 . B398 ) , ( B393 . ( B396 . B398 ) )) holds (B403 = ( B397 . B398 ) implies ( B402 . ( B396 . B398 ) ) = ( B403 . ( B401 . B398 ) ))))))))))))))))
proof
let C387 being  finite non  empty set;
let C388 being  PLS-yielding (ManySortedSet of C387);
assume that
L1431: (for B404 being (Element of C387) holds ( C388 . B404 ) is  strongly_connected);
let C389 being (Collineation of ( Segre_Product C388 ));
set D208 = ( permutation_of_indices C389 );
take D208;
defpred S7[ set , set ] means (for B405 being (Element of C387) holds (B405 = $1 implies $2 = ( canonical_embedding (C389 , B405) )));
L1432: (for B406 being set holds (B406 in C387 implies (ex B407 being set st S7[ B406 , B407 ])))
proof
let C390 being set;
assume L1433: C390 in C387;
reconsider D209 = C390 as (Element of C387) by L1433;
L1434: S7[ D209 , ( canonical_embedding (C389 , D209) ) ];
thus L1435: thesis by L1434;
end;
consider C391 being (ManySortedSet of C387) such that L1436: (for B408 being set holds (B408 in C387 implies S7[ B408 , ( C391 . B408 ) ])) from PBOOLE:sch 3(L1432);
L1437:
now
let C392 being set;
assume L1438: C392 in ( dom C391 );
reconsider D210 = C392 as (Element of C387) by L1438;
L1439: ( C391 . D210 ) = ( canonical_embedding (C389 , D210) ) by L1436;
thus L1440: ( C391 . C392 ) is Function by L1439;
end;
reconsider D211 = C391 as  Function-yielding (ManySortedSet of C387) by L1437 , FUNCOP_1:def 6;
take D211;
let C393 being (Element of C387);
L1441: ( D211 . C393 ) = ( canonical_embedding (C389 , C393) ) by L1436;
thus L1442: (( D211 . C393 ) is (Function of ( C388 . C393 ) , ( C388 . ( D208 . C393 ) )) & (for B409 being (Function of ( C388 . C393 ) , ( C388 . ( D208 . C393 ) )) holds (B409 = ( D211 . C393 ) implies B409 is  isomorphic)))
proof
thus L1443: ( D211 . C393 ) is (Function of ( C388 . C393 ) , ( C388 . ( D208 . C393 ) )) by L1441;
let C394 being (Function of ( C388 . C393 ) , ( C388 . ( D208 . C393 ) ));
assume L1444: C394 = ( D211 . C393 );
consider C395 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C388 )) such that L1445: (( indx C395 ) = C393 & ( product C395 ) is (Segre-Coset of C388)) by L71;
L1446: ( D211 . C393 ) = ( canonical_embedding (C389 , C395) ) by L1431 , L1441 , L1445 , L1420;
thus L1447: thesis by L1446 , L1431 , L1444 , L1445 , L860;
end;

let C396 being (Point of ( Segre_Product C388 ));
let C397 being (ManySortedSet of C387);
assume that
L1448: C397 = C396;
consider C398 being  Segre-like non  trivial-yielding (ManySortedSubset of ( Carrier C388 )) such that L1449: (( indx C398 ) = C393 & ( product C398 ) is (Segre-Coset of C388)) and L1450: C397 in ( product C398 ) by L1448 , L106;
let C399 being (ManySortedSet of C387);
assume that
L1451: C399 = ( C389 . C396 );
let C400 being (Function of ( C388 . C393 ) , ( C388 . ( D208 . C393 ) ));
assume L1452: C400 = ( D211 . C393 );
L1453: C400 = ( canonical_embedding (C389 , C398) ) by L1452 , L1431 , L1441 , L1449 , L1420;
thus L1454: thesis by L1453 , L1431 , L1448 , L1451 , L1449 , L1450 , L860;
end;
