:: Gauss Lemma and Law of Quadratic Reciprocity
::  by Li Yan , Xiquan Liang and Junjie Zhao
::
:: Received October 9, 2007
:: Copyright (c) 2007-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, SUBSET_1, INT_1, NAT_1, FINSEQ_1, NEWTON, ARYTM_3,
      ARYTM_1, RELAT_1, CARD_1, FUNCT_1, CARD_3, FUNCOP_1, ORDINAL4, XBOOLE_0,
      TARSKI, XXREAL_0, FINSEQ_5, SQUARE_1, INT_2, COMPLEX1, ABIAN, FINSEQ_2,
      FUNCT_7, PARTFUN1, FINSET_1, RFINSEQ, CALCUL_2, REAL_1, ZFMISC_1, INT_5;
 notations GROUP_4, INT_1, RVSUM_1, FINSET_1, ORDINAL1, CARD_1, NAT_D, INT_2,
      FUNCT_1, RELSET_1, PARTFUN1, FUNCT_2, NAT_3, ABIAN, GR_CY_1, FINSEQ_5,
      FINSEQ_2, EULER_2, NEWTON, FINSEQ_7, REAL_1, PEPIN, TARSKI, XBOOLE_0,
      SUBSET_1, XCMPLX_0, NUMBERS, XXREAL_0, NAT_1, DOMAIN_1, FINSEQ_1,
      RFINSEQ, FUNCOP_1, CALCUL_2, ZFMISC_1, CARD_3, WSIERP_1, BINOP_1,
      RECDEF_1;
 constructors ABIAN, WSIERP_1, PEPIN, NAT_3, NAT_D, REALSET1, GR_CY_1,
      FINSEQ_5, EULER_2, RFINSEQ, GROUP_4, FINSEQ_7, REAL_1, WELLORD2,
      CALCUL_2, PROB_3, SEQ_1, RECDEF_1, BINOP_1, BINOP_2, CLASSES1;
 registrations XXREAL_0, MEMBERED, RELAT_1, FINSEQ_1, ORDINAL1, WSIERP_1,
      NUMBERS, XBOOLE_0, XREAL_0, NAT_1, INT_1, FINSET_1, NAT_3, RVSUM_1,
      FUNCT_1, CARD_1, NEWTON, SUBSET_1, VALUED_0, VALUED_1, FINSEQ_2,
      PRE_POLY, RELSET_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions INT_1, FUNCT_1, XCMPLX_0, SQUARE_1, FINSEQ_2, TARSKI, CALCUL_2,
      CARD_3;
 theorems FINSEQ_1, FINSEQ_7, RELAT_1, FINSEQ_3, FINSEQ_2, ABSVALUE, FINSEQ_5,
      EULER_2, SEQ_2, FINSEQ_4, FUNCT_2, XBOOLE_0, NAT_3, NEWTON, INT_2, NAT_2,
      WSIERP_1, CARD_1, PEPIN, NAT_1, XCMPLX_1, XREAL_1, HEYTING3, ORDINAL1,
      EULER_1, XBOOLE_1, TARSKI, RVSUM_1, NUMBERS, INT_1, FUNCT_1, FUNCOP_1,
      XXREAL_0, NAT_D, HILBERT3, SERIES_2, GRAPH_5, HILBERT2, RFINSEQ,
      ZFMISC_1, CARD_2, XREAL_0, FINSEQ_6, CALCUL_2, NAT_4, PROB_3, TOPREAL7,
      CARD_3, REAL_3, PRE_FF, INT_4, VALUED_1, PRE_POLY, XTUPLE_0;
 schemes NAT_1, FUNCT_2, RECDEF_1, FINSEQ_2, FUNCT_7, FINSEQ_1;

begin
theorem
L1: (for R2 being Integer holds (for R3 being Integer holds (for R4 being Integer holds ((R2 divides R3 & R2 divides R4) implies R2 divides ( R3 - R4 )))))
proof
let R2 being Integer;
let R3 being Integer;
let R4 being Integer;
assume that
L2: R2 divides R3
and
L3: R2 divides R4;
consider R5 being Integer such that L4: R3 = ( R2 * R5 ) by L2 , INT_1:def 3;
consider R6 being Integer such that L5: R4 = ( R2 * R6 ) by L3 , INT_1:def 3;
L6: ( R3 - R4 ) = ( R2 * ( R5 - R6 ) ) by L4 , L5;
thus L7: thesis by L6 , INT_1:def 3;
end;
theorem
L8: (for R1 being Integer holds (for R9 being Integer holds (for R10 being Integer holds ((R1 divides R9 & R1 divides ( R9 - R10 )) implies R1 divides R10))))
proof
let R1 being Integer;
let R9 being Integer;
let R10 being Integer;
assume that
L9: R1 divides R9
and
L10: R1 divides ( R9 - R10 );
L11: R10 = ( ( - ( R9 - R10 ) ) + R9 );
L12: R1 divides ( - ( R9 - R10 ) ) by L10 , INT_2:10;
thus L13: thesis by L12 , L9 , L11 , WSIERP_1:4;
end;
L14: (for R11 being Integer holds (for R12 being Integer holds ((R11 divides R12 implies ( R12 mod R11 ) = ( 0 )) & ((R11 <> ( 0 ) & ( R12 mod R11 ) = ( 0 )) implies R11 divides R12))))
proof
let R11 being Integer;
let R12 being Integer;
thus L15: (R11 divides R12 implies ( R12 mod R11 ) = ( 0 ))
proof
assume L16: R11 divides R12;
consider R1 being Integer such that L17: R12 = ( R11 * R1 ) by L16 , INT_1:def 3;
L18: ( R12 mod R11 ) = ( ( ( R11 * R1 ) + ( 0 ) ) mod R11 ) by L17
.= ( ( 0 ) mod R11 ) by EULER_1:12
.= ( 0 ) by INT_4:12;
thus L19: thesis by L18;
end;

assume that
L20: R11 <> ( 0 )
and
L21: ( R12 mod R11 ) = ( 0 );
L22: R12 = ( ( ( R12 div R11 ) * R11 ) + ( R12 mod R11 ) ) by L20 , INT_1:59
.= ( ( R12 div R11 ) * R11 ) by L21;
thus L23: thesis by L22 , INT_1:def 3;
end;
definition
let R17 being (FinSequence of ( INT ));
func Poly-INT R17 -> (Function of ( INT ) , ( INT )) means 
:L24: (for B1 being (Element of ( INT )) holds (ex B2 being (FinSequence of ( INT )) st (( len B2 ) = ( len R17 ) & (for R13 being Nat holds (R13 in ( dom B2 ) implies ( B2 . R13 ) = ( ( R17 . R13 ) * ( B1 |^ ( R13 -' 1 ) ) ))) & ( it . B1 ) = ( Sum B2 ))));
existence
proof
defpred S1[ (Element of ( INT )) , set ] means (ex B3 being (FinSequence of ( INT )) st (( len B3 ) = ( len R17 ) & (for R13 being Nat holds (R13 in ( dom B3 ) implies ( B3 . R13 ) = ( ( R17 . R13 ) * ( $1 |^ ( R13 -' 1 ) ) ))) & $2 = ( Sum B3 )));
L25: (for B4 being (Element of ( INT )) holds (ex B5 being (Element of ( INT )) st S1[ B4 , B5 ]))
proof
let C1 being (Element of ( INT ));
deffunc H1(Nat) = ( ( R17 . $1 ) * ( C1 |^ ( $1 -' 1 ) ) );
consider C2 being FinSequence such that L26: (( len C2 ) = ( len R17 ) & (for B6 being Nat holds (B6 in ( dom C2 ) implies ( C2 . B6 ) = H1(B6)))) from FINSEQ_1:sch 2;
L27: (for B7 being Nat holds (B7 in ( dom C2 ) implies ( C2 . B7 ) in ( INT )))
proof
let C3 being Nat;
assume L28: C3 in ( dom C2 );
L29: ( C2 . C3 ) = ( ( R17 . C3 ) * ( C1 |^ ( C3 -' 1 ) ) ) by L28 , L26;
thus L30: thesis by L29 , INT_1:def 2;
end;
reconsider D1 = C2 as (FinSequence of ( INT )) by L27 , FINSEQ_2:12;
take ( Sum D1 );
take D1;
thus L31: thesis by L26;
end;
consider C4 being (Function of ( INT ) , ( INT )) such that L32: (for B8 being (Element of ( INT )) holds S1[ B8 , ( C4 . B8 ) ]) from FUNCT_2:sch 3(L25);
take C4;
thus L33: thesis by L32;
end;
uniqueness
proof
let C5 being (Function of ( INT ) , ( INT ));
let C6 being (Function of ( INT ) , ( INT ));
assume that
L34: (for B9 being (Element of ( INT )) holds (ex B10 being (FinSequence of ( INT )) st (( len B10 ) = ( len R17 ) & (for R13 being Nat holds (R13 in ( dom B10 ) implies ( B10 . R13 ) = ( ( R17 . R13 ) * ( B9 |^ ( R13 -' 1 ) ) ))) & ( C5 . B9 ) = ( Sum B10 ))))
and
L35: (for B11 being (Element of ( INT )) holds (ex B12 being (FinSequence of ( INT )) st (( len B12 ) = ( len R17 ) & (for R13 being Nat holds (R13 in ( dom B12 ) implies ( B12 . R13 ) = ( ( R17 . R13 ) * ( B11 |^ ( R13 -' 1 ) ) ))) & ( C6 . B11 ) = ( Sum B12 ))));
L36: (for B13 being (Element of ( INT )) holds ( C5 . B13 ) = ( C6 . B13 ))
proof
let C7 being (Element of ( INT ));
consider C8 being (FinSequence of ( INT )) such that L37: ( len C8 ) = ( len R17 ) and L38: (for R13 being Nat holds (R13 in ( dom C8 ) implies ( C8 . R13 ) = ( ( R17 . R13 ) * ( C7 |^ ( R13 -' 1 ) ) ))) and L39: ( C5 . C7 ) = ( Sum C8 ) by L34;
consider C9 being (FinSequence of ( INT )) such that L40: ( len C9 ) = ( len R17 ) and L41: (for R13 being Nat holds (R13 in ( dom C9 ) implies ( C9 . R13 ) = ( ( R17 . R13 ) * ( C7 |^ ( R13 -' 1 ) ) ))) and L42: ( C6 . C7 ) = ( Sum C9 ) by L35;
L43: ( dom C8 ) = ( dom C9 ) by L37 , L40 , FINSEQ_3:29;
L44: (for B14 being Nat holds (B14 in ( dom C8 ) implies ( C8 . B14 ) = ( C9 . B14 )))
proof
let C10 being Nat;
assume L45: C10 in ( dom C8 );
thus L46: ( C9 . C10 ) = ( ( R17 . C10 ) * ( C7 |^ ( C10 -' 1 ) ) ) by L45 , L41 , L43
.= ( C8 . C10 ) by L38 , L45;
end;
thus L47: thesis by L44 , L39 , L42 , L43 , FINSEQ_1:13;
end;
thus L48: thesis by L36 , FUNCT_2:63;
end;
end;
theorem
L50: (for R17 being (FinSequence of ( INT )) holds (( len R17 ) = 1 implies ( Poly-INT R17 ) = ( ( INT ) --> ( R17 . 1 ) )))
proof
let R17 being (FinSequence of ( INT ));
assume L51: ( len R17 ) = 1;
L52: (for B15 being set holds (B15 in ( dom ( Poly-INT R17 ) ) implies ( ( Poly-INT R17 ) . B15 ) = ( R17 . 1 )))
proof
let C11 being set;
assume L53: C11 in ( dom ( Poly-INT R17 ) );
reconsider D2 = C11 as (Element of ( INT )) by L53;
consider C12 being (FinSequence of ( INT )) such that L54: ( len C12 ) = ( len R17 ) and L55: (for R13 being Nat holds (R13 in ( dom C12 ) implies ( C12 . R13 ) = ( ( R17 . R13 ) * ( D2 |^ ( R13 -' 1 ) ) ))) and L56: ( ( Poly-INT R17 ) . D2 ) = ( Sum C12 ) by L24;
L57: 1 in ( dom C12 ) by L51 , L54 , FINSEQ_3:25;
L58: ( C12 . 1 ) = ( ( R17 . 1 ) * ( D2 |^ ( 1 -' 1 ) ) ) by L57 , L55
.= ( ( R17 . 1 ) * ( D2 |^ ( 0 ) ) ) by XREAL_1:232
.= ( ( R17 . 1 ) * 1 ) by NEWTON:4;
L59: C12 = <* ( C12 . 1 ) *> by L51 , L54 , FINSEQ_1:40;
thus L60: thesis by L59 , L56 , L58 , RVSUM_1:73;
end;
L61: ( Poly-INT R17 ) = ( ( dom ( Poly-INT R17 ) ) --> ( R17 . 1 ) ) by L52 , FUNCOP_1:11;
thus L62: thesis by L61 , FUNCT_2:def 1;
end;
theorem
L63: (for R17 being (FinSequence of ( INT )) holds (( len R17 ) = 1 implies (for B16 being (Element of ( INT )) holds ( ( Poly-INT R17 ) . B16 ) = ( R17 . 1 ))))
proof
let R17 being (FinSequence of ( INT ));
assume L64: ( len R17 ) = 1;
let C13 being (Element of ( INT ));
consider C14 being (FinSequence of ( INT )) such that L65: ( len C14 ) = ( len R17 ) and L66: (for R13 being Nat holds (R13 in ( dom C14 ) implies ( C14 . R13 ) = ( ( R17 . R13 ) * ( C13 |^ ( R13 -' 1 ) ) ))) and L67: ( ( Poly-INT R17 ) . C13 ) = ( Sum C14 ) by L24;
L68: 1 in ( dom C14 ) by L64 , L65 , FINSEQ_3:25;
L69: ( C14 . 1 ) = ( ( R17 . 1 ) * ( C13 |^ ( 1 -' 1 ) ) ) by L68 , L66
.= ( ( R17 . 1 ) * ( C13 |^ ( 0 ) ) ) by XREAL_1:232
.= ( ( R17 . 1 ) * 1 ) by NEWTON:4;
L70: C14 = <* ( C14 . 1 ) *> by L64 , L65 , FINSEQ_1:40;
thus L71: thesis by L70 , L67 , L69 , RVSUM_1:73;
end;
theorem
L72: (for R16 being Nat holds (for R19 being (FinSequence of ( REAL )) holds (for R20 being (FinSequence of ( REAL )) holds (for R21 being (FinSequence of ( REAL )) holds ((( len R19 ) = ( R16 + 1 ) & ( len R20 ) = ( len R19 ) & ( len R21 ) = ( len R19 ) & (for R13 being Nat holds (R13 in ( dom R19 ) implies ( R19 . R13 ) = ( ( R20 . R13 ) - ( R21 . R13 ) )))) implies (ex R23 being (FinSequence of ( REAL )) st (( len R23 ) = ( ( len R19 ) - 1 ) & (for R13 being Nat holds (R13 in ( dom R23 ) implies ( R23 . R13 ) = ( ( R20 . R13 ) - ( R21 . ( R13 + 1 ) ) ))) & ( Sum R19 ) = ( ( ( Sum R23 ) + ( R20 . ( R16 + 1 ) ) ) - ( R21 . 1 ) ))))))))
proof
let R16 being Nat;
defpred S2[ Nat ] means (for R19 being (FinSequence of ( REAL )) holds (for R20 being (FinSequence of ( REAL )) holds (for R21 being (FinSequence of ( REAL )) holds ((( len R19 ) = ( $1 + 1 ) & ( len R20 ) = ( len R19 ) & ( len R21 ) = ( len R19 ) & (for R13 being Nat holds (R13 in ( dom R19 ) implies ( R19 . R13 ) = ( ( R20 . R13 ) - ( R21 . R13 ) )))) implies (ex R23 being (FinSequence of ( REAL )) st (( len R23 ) = ( ( len R19 ) - 1 ) & (for R13 being Nat holds (R13 in ( dom R23 ) implies ( R23 . R13 ) = ( ( R20 . R13 ) - ( R21 . ( R13 + 1 ) ) ))) & ( Sum R19 ) = ( ( ( Sum R23 ) + ( R20 . ( $1 + 1 ) ) ) - ( R21 . 1 ) )))))));
L73: (for R16 being Nat holds (S2[ R16 ] implies S2[ ( R16 + 1 ) ]))
proof
let R16 being Nat;
assume L74: S2[ R16 ];
let R19 being (FinSequence of ( REAL ));
let R20 being (FinSequence of ( REAL ));
let R21 being (FinSequence of ( REAL ));
assume that
L75: ( len R19 ) = ( ( R16 + 1 ) + 1 )
and
L76: ( len R20 ) = ( len R19 )
and
L77: ( len R21 ) = ( len R19 )
and
L78: (for R13 being Nat holds (R13 in ( dom R19 ) implies ( R19 . R13 ) = ( ( R20 . R13 ) - ( R21 . R13 ) )));
set D3 = ( R20 | ( Seg ( R16 + 1 ) ) );
reconsider D4 = D3 as (FinSequence of ( REAL )) by FINSEQ_1:18;
L79: ( len D4 ) = ( R16 + 1 ) by L75 , L76 , FINSEQ_3:53;
set D5 = ( R21 | ( Seg ( R16 + 1 ) ) );
reconsider D6 = D5 as (FinSequence of ( REAL )) by FINSEQ_1:18;
L80: R21 = ( D6 ^ <* ( R21 . ( ( R16 + 1 ) + 1 ) ) *> ) by L75 , L77 , FINSEQ_3:55;
L81: ( len D6 ) = ( R16 + 1 ) by L75 , L77 , FINSEQ_3:53;
L82: D6 <> ( {} ) by L81;
L83: 1 in ( dom D6 ) by L82 , FINSEQ_5:6;
L84: ( D6 . 1 ) = ( R21 . 1 ) by L83 , L80 , FINSEQ_1:def 7;
L85: R20 = ( D4 ^ <* ( R20 . ( ( R16 + 1 ) + 1 ) ) *> ) by L75 , L76 , FINSEQ_3:55;
L86: ( ( R16 + 1 ) + 1 ) in ( Seg ( ( R16 + 1 ) + 1 ) ) by FINSEQ_1:4;
L87: ( ( R16 + 1 ) + 1 ) in ( dom R19 ) by L86 , L75 , FINSEQ_1:def 3;
L88: ( R19 . ( ( R16 + 1 ) + 1 ) ) = ( ( R20 . ( ( R16 + 1 ) + 1 ) ) - ( R21 . ( ( R16 + 1 ) + 1 ) ) ) by L87 , L78;
set D7 = ( R19 | ( Seg ( R16 + 1 ) ) );
reconsider D8 = D7 as (FinSequence of ( REAL )) by FINSEQ_1:18;
L89: ( dom D8 ) = ( Seg ( R16 + 1 ) ) by L75 , FINSEQ_3:54;
L90: ( len D8 ) = ( R16 + 1 ) by L89 , FINSEQ_1:def 3;
L91: R19 = ( D8 ^ <* ( R19 . ( ( R16 + 1 ) + 1 ) ) *> ) by L75 , FINSEQ_3:55;
L92: (for R13 being Nat holds (R13 in ( dom D8 ) implies ( D8 . R13 ) = ( ( D4 . R13 ) - ( D6 . R13 ) )))
proof
let R13 being Nat;
L93: ( dom D8 ) c= ( dom R19 ) by L91 , FINSEQ_1:26;
assume L94: R13 in ( dom D8 );
L95: R13 in ( dom D6 ) by L94 , L89 , L81 , FINSEQ_1:def 3;
L96: R13 in ( dom D4 ) by L89 , L79 , L94 , FINSEQ_1:def 3;
L97: ( R20 . R13 ) = ( D4 . R13 ) by L96 , L85 , FINSEQ_1:def 7;
L98: ( D8 . R13 ) = ( R19 . R13 ) by L91 , L94 , FINSEQ_1:def 7
.= ( ( R20 . R13 ) - ( R21 . R13 ) ) by L78 , L94 , L93;
thus L99: thesis by L98 , L80 , L95 , L97 , FINSEQ_1:def 7;
end;
L100: D4 <> ( {} ) by L79;
L101: ( R16 + 1 ) in ( dom D4 ) by L100 , L79 , FINSEQ_5:6;
L102: ( D4 . ( R16 + 1 ) ) = ( R20 . ( R16 + 1 ) ) by L101 , L85 , FINSEQ_1:def 7;
consider C15 being (FinSequence of ( REAL )) such that L103: ( len C15 ) = ( ( len D8 ) - 1 ) and L104: (for R13 being Nat holds (R13 in ( dom C15 ) implies ( C15 . R13 ) = ( ( D4 . R13 ) - ( D6 . ( R13 + 1 ) ) ))) and L105: ( Sum D8 ) = ( ( ( Sum C15 ) + ( R20 . ( R16 + 1 ) ) ) - ( R21 . 1 ) ) by L102 , L74 , L90 , L79 , L81 , L92 , L84;
take D9 = ( C15 ^ <* ( ( R20 . ( R16 + 1 ) ) - ( R21 . ( R16 + 2 ) ) ) *> );
L106: ( ( R20 . ( R16 + 1 ) ) - ( R21 . ( R16 + 2 ) ) ) is (Element of ( REAL )) by XREAL_0:def 1;
L107: <* ( ( R20 . ( R16 + 1 ) ) - ( R21 . ( R16 + 2 ) ) ) *> is (FinSequence of ( REAL )) by L106 , FINSEQ_1:74;
reconsider D10 = D9 as (FinSequence of ( REAL )) by L107 , FINSEQ_1:75;
L108: ( Sum R19 ) = ( ( ( ( Sum C15 ) + ( R20 . ( R16 + 1 ) ) ) - ( R21 . 1 ) ) + ( R19 . ( ( R16 + 1 ) + 1 ) ) ) by L91 , L105 , RVSUM_1:74
.= ( ( ( ( Sum C15 ) + ( ( R20 . ( R16 + 1 ) ) - ( R21 . ( R16 + 2 ) ) ) ) + ( R20 . ( ( R16 + 1 ) + 1 ) ) ) - ( R21 . 1 ) ) by L88
.= ( ( ( Sum D10 ) + ( R20 . ( ( R16 + 1 ) + 1 ) ) ) - ( R21 . 1 ) ) by RVSUM_1:74;
L109: ( ( len C15 ) + 1 ) = ( R16 + 1 ) by L89 , L103 , FINSEQ_1:def 3;
L110: (for R13 being Nat holds (R13 in ( dom D10 ) implies ( D10 . R13 ) = ( ( R20 . R13 ) - ( R21 . ( R13 + 1 ) ) )))
proof
let R13 being Nat;
assume L111: R13 in ( dom D10 );
L112: R13 in ( Seg ( len D10 ) ) by L111 , FINSEQ_1:def 3;
L113: R13 in ( Seg ( ( len C15 ) + 1 ) ) by L112 , FINSEQ_2:16;
L114: R13 in ( ( Seg ( len C15 ) ) \/ { ( ( len C15 ) + 1 ) } ) by L113 , FINSEQ_1:9;
L115: (R13 in ( Seg ( len C15 ) ) or R13 in { ( ( len C15 ) + 1 ) }) by L114 , XBOOLE_0:def 3;
per cases  by L115 , TARSKI:def 1;
suppose L116: R13 in ( Seg ( len C15 ) );

L117: ( R13 + 1 ) in ( Seg ( ( len C15 ) + 1 ) ) by L116 , FINSEQ_1:60;
L118: ( R13 + 1 ) in ( Seg ( len D6 ) ) by L117 , L75 , L77 , L90 , L103 , FINSEQ_3:53;
L119: ( R13 + 1 ) in ( dom D6 ) by L118 , FINSEQ_1:def 3;
L120: R13 in ( dom C15 ) by L116 , FINSEQ_1:def 3;
L121: ( len C15 ) <= ( len D4 ) by L90 , L79 , L103 , XREAL_1:147;
L122: ( dom C15 ) c= ( dom D4 ) by L121 , FINSEQ_3:30;
L123: ( R20 . R13 ) = ( D4 . R13 ) by L122 , L85 , L120 , FINSEQ_1:def 7;
L124: ( D10 . R13 ) = ( C15 . R13 ) by L120 , FINSEQ_1:def 7
.= ( ( D4 . R13 ) - ( D6 . ( R13 + 1 ) ) ) by L104 , L120;
thus L125: thesis by L124 , L80 , L123 , L119 , FINSEQ_1:def 7;
end;
suppose L126: R13 = ( ( len C15 ) + 1 );

L127: 1 in ( Seg 1 ) by FINSEQ_1:2 , TARSKI:def 1;
L128: 1 in ( dom <* ( ( R20 . ( R16 + 1 ) ) - ( R21 . ( R16 + 2 ) ) ) *> ) by L127 , FINSEQ_1:38;
L129: ( D10 . R13 ) = ( <* ( ( R20 . ( R16 + 1 ) ) - ( R21 . ( R16 + 2 ) ) ) *> . 1 ) by L128 , L126 , FINSEQ_1:def 7
.= ( ( R20 . R13 ) - ( R21 . ( R13 + 1 ) ) ) by L109 , L126 , FINSEQ_1:40;
thus L130: thesis by L129;
end;
end;
L132: ( len D10 ) = ( ( len C15 ) + 1 ) by FINSEQ_2:16
.= ( ( len R19 ) - 1 ) by L75 , L89 , L103 , FINSEQ_1:def 3;
thus L133: thesis by L132 , L110 , L108;
end;
L134: S2[ ( 0 ) ]
proof
let R19 being (FinSequence of ( REAL ));
let R20 being (FinSequence of ( REAL ));
let R21 being (FinSequence of ( REAL ));
assume that
L135: ( len R19 ) = ( ( 0 ) + 1 )
and
L136: ( len R20 ) = ( len R19 )
and
L137: ( len R21 ) = ( len R19 )
and
L138: (for R13 being Nat holds (R13 in ( dom R19 ) implies ( R19 . R13 ) = ( ( R20 . R13 ) - ( R21 . R13 ) )));
take ( <*> ( REAL ) );
L139: ( ( 0 ) + 1 ) in ( Seg ( ( 0 ) + 1 ) ) by FINSEQ_1:4;
L140: 1 in ( dom R19 ) by L139 , L135 , FINSEQ_1:def 3;
L141: ( R19 . 1 ) = ( ( R20 . 1 ) - ( R21 . 1 ) ) by L140 , L138;
L142: R19 = <* ( ( R20 . 1 ) - ( R21 . 1 ) ) *> by L141 , L135 , FINSEQ_1:40;
thus L143: thesis by L142 , L135 , RVSUM_1:72 , RVSUM_1:73;
end;
L144: (for R16 being Nat holds S2[ R16 ]) from NAT_1:sch 2(L134 , L73);
thus L145: thesis by L144;
end;
theorem
L146: (for R16 being Nat holds (for R17 being (FinSequence of ( INT )) holds (( len R17 ) = ( R16 + 2 ) implies (for B17 being Integer holds (ex B18 being (FinSequence of ( INT )) st (ex B19 being Integer st (( len B18 ) = ( R16 + 1 ) & (for B20 being (Element of ( INT )) holds ( ( Poly-INT R17 ) . B20 ) = ( ( ( B20 - B17 ) * ( ( Poly-INT B18 ) . B20 ) ) + B19 )) & ( R17 . ( R16 + 2 ) ) = ( B18 . ( R16 + 1 ) ))))))))
proof
let R16 being Nat;
let R17 being (FinSequence of ( INT ));
assume L147: ( len R17 ) = ( R16 + 2 );
L148: ( ( R16 + 1 ) + 1 ) in ( Seg ( ( R16 + 1 ) + 1 ) ) by FINSEQ_1:4;
L149: ( R16 + 2 ) in ( dom R17 ) by L148 , L147 , FINSEQ_1:def 3;
reconsider D11 = ( R17 . ( R16 + 2 ) ) as (Element of ( INT )) by L149 , FINSEQ_2:11;
reconsider D12 = ( R16 + 1 ) as (Element of ( NAT ));
let C16 being Integer;
defpred S3[ Nat , Integer , set ] means $3 = ( ( R17 . ( ( R16 + 2 ) - $1 ) ) + ( C16 * $2 ) );
L150: (for B21 being (Element of ( NAT )) holds ((1 <= B21 & B21 < D12) implies (for B22 being (Element of ( INT )) holds (ex B23 being (Element of ( INT )) st S3[ B21 , B22 , B23 ]))))
proof
let C17 being (Element of ( NAT ));
assume that
L151: 1 <= C17
and
L152: C17 < D12;
let C18 being (Element of ( INT ));
set D13 = ( ( R17 . ( ( R16 + 2 ) - C17 ) ) + ( C16 * C18 ) );
reconsider D14 = D13 as (Element of ( INT )) by INT_1:def 2;
take D14;
thus L153: thesis;
end;
consider C19 being (FinSequence of ( INT )) such that L154: (( len C19 ) = D12 & (( C19 . 1 ) = D11 or D12 = ( 0 )) & (for B24 being (Element of ( NAT )) holds ((1 <= B24 & B24 < D12) implies S3[ B24 , ( C19 . B24 ) , ( C19 . ( B24 + 1 ) ) ]))) from RECDEF_1:sch 4(L150);
take D15 = ( Rev C19 );
take D16 = ( ( R17 . 1 ) + ( C16 * ( D15 . 1 ) ) );
L155: ( len D15 ) = ( R16 + 1 ) by L154 , FINSEQ_5:def 3;
L156: (for B25 being (Element of ( INT )) holds ( ( Poly-INT R17 ) . B25 ) = ( ( ( B25 - C16 ) * ( ( Poly-INT D15 ) . B25 ) ) + D16 ))
proof
let C20 being (Element of ( INT ));
deffunc H2(Nat) = ( ( D15 . $1 ) * ( C20 |^ $1 ) );
deffunc H3(Nat) = ( ( C16 * ( D15 . $1 ) ) * ( C20 |^ ( $1 -' 1 ) ) );
consider C21 being (FinSequence of ( INT )) such that L157: ( len C21 ) = ( len R17 ) and L158: (for R13 being Nat holds (R13 in ( dom C21 ) implies ( C21 . R13 ) = ( ( R17 . R13 ) * ( C20 |^ ( R13 -' 1 ) ) ))) and L159: ( ( Poly-INT R17 ) . C20 ) = ( Sum C21 ) by L24;
L160: C21 <> ( {} ) by L147 , L157;
L161: ( R16 + 2 ) in ( dom C21 ) by L160 , L147 , L157 , FINSEQ_5:6;
L162: ( C21 . ( R16 + 2 ) ) = ( ( R17 . ( R16 + 2 ) ) * ( C20 |^ ( ( ( R16 + 1 ) + 1 ) -' 1 ) ) ) by L161 , L158;
L163: ( C21 . ( R16 + 2 ) ) = ( ( R17 . ( R16 + 2 ) ) * ( C20 |^ ( R16 + 1 ) ) ) by L162 , NAT_D:34;
L164: ( C21 . 1 ) = ( ( R17 . 1 ) * ( C20 |^ ( 1 -' 1 ) ) ) by L158 , L160 , FINSEQ_5:6;
L165: ( C21 . 1 ) = ( ( R17 . 1 ) * ( C20 |^ ( 0 ) ) ) by L164 , XREAL_1:232;
L166: ( C21 . 1 ) = ( ( R17 . 1 ) * 1 ) by L165 , NEWTON:4;
reconsider D17 = R16 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C22 being FinSequence such that L167: (( len C22 ) = ( D17 + 1 ) & (for B26 being Nat holds (B26 in ( dom C22 ) implies ( C22 . B26 ) = H2(B26)))) from FINSEQ_1:sch 2;
L168: (for B27 being Nat holds (B27 in ( dom C22 ) implies ( C22 . B27 ) in ( INT )))
proof
let C23 being Nat;
reconsider D18 = C23 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L169: C23 in ( dom C22 );
L170: ( C22 . D18 ) = ( ( D15 . D18 ) * ( C20 |^ D18 ) ) by L169 , L167;
thus L171: thesis by L170 , INT_1:def 2;
end;
L172: C22 <> ( {} ) by L167;
L173: ( D17 + 1 ) in ( dom C22 ) by L172 , L167 , FINSEQ_5:6;
L174: ( C22 . ( D17 + 1 ) ) = ( ( D15 . ( D17 + 1 ) ) * ( C20 |^ ( D17 + 1 ) ) ) by L173 , L167;
L175: ( C22 . ( D17 + 1 ) ) = ( ( R17 . ( D17 + 2 ) ) * ( C20 |^ ( D17 + 1 ) ) ) by L174 , L154 , FINSEQ_5:62;
reconsider D19 = C22 as (FinSequence of ( INT )) by L168 , FINSEQ_2:12;
consider C24 being FinSequence such that L176: (( len C24 ) = ( D17 + 1 ) & (for B28 being Nat holds (B28 in ( dom C24 ) implies ( C24 . B28 ) = H3(B28)))) from FINSEQ_1:sch 2;
L177: (for B29 being Nat holds (B29 in ( dom C24 ) implies ( C24 . B29 ) in ( INT )))
proof
let C25 being Nat;
assume L178: C25 in ( dom C24 );
L179: ( C24 . C25 ) = ( ( C16 * ( D15 . C25 ) ) * ( C20 |^ ( C25 -' 1 ) ) ) by L178 , L176;
thus L180: thesis by L179 , INT_1:def 2;
end;
L181: C24 <> ( {} ) by L176;
L182: 1 in ( dom C24 ) by L181 , FINSEQ_5:6;
L183: ( C24 . 1 ) = ( ( C16 * ( D15 . 1 ) ) * ( C20 |^ ( 1 -' 1 ) ) ) by L182 , L176;
L184: ( C24 . 1 ) = ( ( C16 * ( D15 . 1 ) ) * ( C20 |^ ( 0 ) ) ) by L183 , XREAL_1:232;
L185: ( C24 . 1 ) = ( ( C16 * ( D15 . 1 ) ) * 1 ) by L184 , NEWTON:4;
reconsider D20 = C24 as (FinSequence of ( INT )) by L177 , FINSEQ_2:12;
L186: D19 is (FinSequence of ( REAL )) by FINSEQ_3:117;
consider C26 being (FinSequence of ( INT )) such that L187: ( len C26 ) = ( len D15 ) and L188: (for R13 being Nat holds (R13 in ( dom C26 ) implies ( C26 . R13 ) = ( ( D15 . R13 ) * ( C20 |^ ( R13 -' 1 ) ) ))) and L189: ( ( Poly-INT D15 ) . C20 ) = ( Sum C26 ) by L24;
set D21 = ( ( C20 - C16 ) * C26 );
L190: ( dom D21 ) = ( dom C26 ) by VALUED_1:def 5;
L191: ( len D21 ) = ( len C26 ) by L190 , FINSEQ_3:29;
L192: ( dom D21 ) = ( dom D19 ) by L155 , L187 , L167 , L190 , FINSEQ_3:29;
L193: (for B30 being (Element of ( NAT )) holds (B30 in ( dom D21 ) implies ( D21 . B30 ) = ( ( ( D15 . B30 ) * ( C20 |^ B30 ) ) - ( ( C16 * ( D15 . B30 ) ) * ( C20 |^ ( B30 -' 1 ) ) ) )))
proof
let C27 being (Element of ( NAT ));
assume L194: C27 in ( dom D21 );
L195: C27 >= 1 by L194 , FINSEQ_3:25;
L196: C27 in ( dom C26 ) by L194 , VALUED_1:def 5;
thus L197: ( D21 . C27 ) = ( ( C20 - C16 ) * ( C26 . C27 ) ) by L194 , VALUED_1:def 5
.= ( ( C20 - C16 ) * ( ( D15 . C27 ) * ( C20 |^ ( C27 -' 1 ) ) ) ) by L188 , L196
.= ( ( ( D15 . C27 ) * ( ( C20 |^ ( C27 -' 1 ) ) * C20 ) ) - ( ( C16 * ( D15 . C27 ) ) * ( C20 |^ ( C27 -' 1 ) ) ) )
.= ( ( ( D15 . C27 ) * ( C20 |^ ( ( C27 -' 1 ) + 1 ) ) ) - ( ( C16 * ( D15 . C27 ) ) * ( C20 |^ ( C27 -' 1 ) ) ) ) by NEWTON:6
.= ( ( ( D15 . C27 ) * ( C20 |^ C27 ) ) - ( ( C16 * ( D15 . C27 ) ) * ( C20 |^ ( C27 -' 1 ) ) ) ) by L195 , XREAL_1:235;
end;
L198: ( dom D21 ) = ( dom D20 ) by L155 , L187 , L176 , L190 , FINSEQ_3:29;
L199: (for R13 being Nat holds (R13 in ( dom D21 ) implies ( D21 . R13 ) = ( ( D19 . R13 ) - ( D20 . R13 ) )))
proof
let R13 being Nat;
assume L200: R13 in ( dom D21 );
L201: ( D20 . R13 ) = ( ( C16 * ( D15 . R13 ) ) * ( C20 |^ ( R13 -' 1 ) ) ) by L200 , L176 , L198;
L202: ( D19 . R13 ) = ( ( D15 . R13 ) * ( C20 |^ R13 ) ) by L167 , L192 , L200;
thus L203: thesis by L202 , L193 , L200 , L201;
end;
L204: D20 is (FinSequence of ( REAL )) by FINSEQ_3:117;
consider C28 being (FinSequence of ( REAL )) such that L205: ( len C28 ) = ( ( len D21 ) - 1 ) and L206: (for R13 being Nat holds (R13 in ( dom C28 ) implies ( C28 . R13 ) = ( ( D19 . R13 ) - ( D20 . ( R13 + 1 ) ) ))) and L207: ( Sum D21 ) = ( ( ( Sum C28 ) + ( D19 . ( D17 + 1 ) ) ) - ( D20 . 1 ) ) by L204 , L155 , L187 , L167 , L176 , L191 , L199 , L186 , L72;
L208: ( len C28 ) <= ( len D21 ) by L155 , L187 , L191 , L205 , XREAL_1:145;
L209: ( dom C28 ) c= ( dom D21 ) by L208 , FINSEQ_3:30;
L210: (for B31 being (Element of ( NAT )) holds (B31 in ( dom C28 ) implies ( C28 . B31 ) = ( C21 . ( B31 + 1 ) )))
proof
let C29 being (Element of ( NAT ));
L211: ( dom C28 ) c= ( dom C19 ) by L154 , L155 , L187 , L191 , L208 , FINSEQ_3:30;
assume L212: C29 in ( dom C28 );
L213: C29 in ( Seg D17 ) by L212 , L155 , L187 , L191 , L205 , FINSEQ_1:def 3;
L214: C29 <= D17 by L213 , FINSEQ_1:1;
L215: ( D17 - C29 ) >= ( 0 ) by L214 , XREAL_1:48;
reconsider D22 = ( ( D17 - C29 ) + 1 ) as (Element of ( NAT )) by L215 , INT_1:3;
L216: C29 >= 1 by L213 , FINSEQ_1:1;
L217: ( D17 - C29 ) <= ( D17 - 1 ) by L216 , XREAL_1:10;
L218: D22 <= ( ( D17 - 1 ) + 1 ) by L217 , XREAL_1:6;
L219: D22 < ( D17 + 1 ) by L218 , XREAL_1:145;
L220: D22 >= ( ( 0 ) + 1 ) by L215 , XREAL_1:6;
L221: ( C19 . ( D22 + 1 ) ) = ( ( R17 . ( ( D17 + 2 ) - D22 ) ) + ( C16 * ( C19 . D22 ) ) ) by L220 , L154 , L219;
L222: C29 < ( D17 + 1 ) by L214 , XREAL_1:145;
L223: ( C29 + 1 ) in ( Seg ( D17 + 1 ) ) by L222 , FINSEQ_3:11;
L224: ( C29 + 1 ) in ( dom D20 ) by L223 , L176 , FINSEQ_1:def 3;
L225: ( C29 + ( 0 ) ) < ( D17 + 2 ) by L214 , XREAL_1:8;
L226: ( C29 + 1 ) in ( Seg ( D17 + 2 ) ) by L225 , FINSEQ_3:11;
L227: ( C29 + 1 ) in ( dom C21 ) by L226 , L147 , L157 , FINSEQ_1:def 3;
L228: ( C29 + 1 ) in ( dom C19 ) by L154 , L223 , FINSEQ_1:def 3;
thus L229: ( C28 . C29 ) = ( ( D19 . C29 ) - ( D20 . ( C29 + 1 ) ) ) by L206 , L212
.= ( ( ( D15 . C29 ) * ( C20 |^ C29 ) ) - ( D20 . ( C29 + 1 ) ) ) by L167 , L192 , L209 , L212
.= ( ( ( D15 . C29 ) * ( C20 |^ C29 ) ) - ( ( C16 * ( D15 . ( C29 + 1 ) ) ) * ( C20 |^ ( ( C29 + 1 ) -' 1 ) ) ) ) by L176 , L224
.= ( ( ( D15 . C29 ) * ( C20 |^ C29 ) ) - ( ( C16 * ( D15 . ( C29 + 1 ) ) ) * ( C20 |^ C29 ) ) ) by NAT_D:34
.= ( ( ( D15 . C29 ) - ( C16 * ( D15 . ( C29 + 1 ) ) ) ) * ( C20 |^ C29 ) )
.= ( ( ( C19 . ( ( ( D17 + 1 ) - C29 ) + 1 ) ) - ( C16 * ( D15 . ( C29 + 1 ) ) ) ) * ( C20 |^ C29 ) ) by L154 , L212 , L211 , FINSEQ_5:58
.= ( ( ( C19 . ( ( ( D17 - C29 ) + 1 ) + 1 ) ) - ( C16 * ( C19 . ( ( ( D17 + 1 ) - ( C29 + 1 ) ) + 1 ) ) ) ) * ( C20 |^ C29 ) ) by L154 , L228 , FINSEQ_5:58
.= ( ( R17 . ( C29 + 1 ) ) * ( C20 |^ ( ( C29 + 1 ) -' 1 ) ) ) by L221 , NAT_D:34
.= ( C21 . ( C29 + 1 ) ) by L158 , L227;
end;
L230: C21 = ( ( <* ( C21 . 1 ) *> ^ C28 ) ^ <* ( C21 . ( D17 + 2 ) ) *> )
proof
set D23 = ( ( <* ( C21 . 1 ) *> ^ C28 ) ^ <* ( C21 . ( D17 + 2 ) ) *> );
L231: (for B32 being Nat holds (B32 in ( dom C21 ) implies ( C21 . B32 ) = ( D23 . B32 )))
proof
let C30 being Nat;
assume L232: C30 in ( dom C21 );
L233: C30 >= 1 by L232 , FINSEQ_3:25;
L234: C30 <= ( D17 + 2 ) by L147 , L157 , L232 , FINSEQ_3:25;
per cases  by L233 , L234 , XXREAL_0:1;
suppose L235: C30 = 1;

thus L236: ( D23 . C30 ) = ( ( <* ( C21 . 1 ) *> ^ ( C28 ^ <* ( C21 . ( D17 + 2 ) ) *> ) ) . 1 ) by L235 , FINSEQ_1:32
.= ( C21 . C30 ) by L235 , FINSEQ_1:41;
end;
suppose L237: (C30 > 1 & C30 < ( D17 + 2 ));

L238: ( C30 - 1 ) > ( 0 ) by L237 , XREAL_1:50;
reconsider D24 = ( C30 - 1 ) as (Element of ( NAT )) by L238 , INT_1:3;
L239: ( C30 - 1 ) < ( ( D17 + 2 ) - 1 ) by L237 , XREAL_1:9;
L240: ( C30 - 1 ) <= ( ( D17 + 1 ) - 1 ) by L239 , INT_1:7;
L241: ( C30 - 1 ) >= ( ( 0 ) + 1 ) by L237 , INT_1:7 , XREAL_1:50;
L242: D24 in ( Seg D17 ) by L241 , L240 , FINSEQ_1:1;
L243: D24 in ( dom C28 ) by L242 , L155 , L187 , L191 , L205 , FINSEQ_1:def 3;
L244: D24 in ( dom ( C28 ^ <* ( C21 . ( D17 + 2 ) ) *> ) ) by L243 , FINSEQ_2:15;
thus L245: ( D23 . C30 ) = ( ( <* ( C21 . 1 ) *> ^ ( C28 ^ <* ( C21 . ( D17 + 2 ) ) *> ) ) . ( D24 + 1 ) ) by FINSEQ_1:32
.= ( ( C28 ^ <* ( C21 . ( D17 + 2 ) ) *> ) . D24 ) by L244 , FINSEQ_3:103
.= ( C28 . D24 ) by L243 , FINSEQ_1:def 7
.= ( C21 . ( D24 + 1 ) ) by L210 , L243
.= ( C21 . C30 );
end;
suppose L246: C30 = ( D17 + 2 );

set D25 = ( <* ( C21 . 1 ) *> ^ C28 );
thus L247: ( D23 . C30 ) = ( D23 . ( ( D17 + 1 ) + 1 ) ) by L246
.= ( D23 . ( ( len D25 ) + 1 ) ) by L155 , L187 , L191 , L205 , FINSEQ_5:8
.= ( C21 . C30 ) by L246 , FINSEQ_1:42;
end;
end;
L249: ( len D23 ) = ( len ( <* ( C21 . 1 ) *> ^ ( C28 ^ <* ( C21 . ( D17 + 2 ) ) *> ) ) ) by FINSEQ_1:32
.= ( 1 + ( len ( C28 ^ <* ( C21 . ( D17 + 2 ) ) *> ) ) ) by FINSEQ_5:8
.= ( ( 1 + ( len C28 ) ) + 1 ) by FINSEQ_2:16
.= ( len C21 ) by L147 , L155 , L157 , L187 , L191 , L205;
L250: ( dom C21 ) = ( dom D23 ) by L249 , FINSEQ_3:29;
thus L251: thesis by L250 , L231 , FINSEQ_1:13;
end;
L252: ( Sum C21 ) = ( Sum ( <* ( C21 . 1 ) *> ^ ( C28 ^ <* ( C21 . ( D17 + 2 ) ) *> ) ) ) by L230 , FINSEQ_1:32
.= ( ( C21 . 1 ) + ( Sum ( C28 ^ <* ( C21 . ( D17 + 2 ) ) *> ) ) ) by RVSUM_1:76
.= ( ( C21 . 1 ) + ( ( Sum C28 ) + ( C21 . ( D17 + 2 ) ) ) ) by RVSUM_1:74
.= ( ( Sum ( ( C20 - C16 ) * C26 ) ) + D16 ) by L166 , L163 , L175 , L185 , L207
.= ( ( ( C20 - C16 ) * ( ( Poly-INT D15 ) . C20 ) ) + D16 ) by L189 , RVSUM_1:87;
thus L253: thesis by L252 , L159;
end;
thus L254: thesis by L156 , L154 , FINSEQ_5:62 , FINSEQ_5:def 3;
end;
theorem
L255: (for R1 being Integer holds (for R7 being Integer holds (for R22 being Prime holds (R22 divides ( R1 * R7 ) implies (R22 divides R1 or R22 divides R7)))))
proof
let R1 being Integer;
let R7 being Integer;
let R22 being Prime;
assume L256: R22 divides ( R1 * R7 );
per cases ;
suppose L257: (R1 >= ( 0 ) & R7 >= ( 0 ));

reconsider D26 = R1 , D27 = R7 as (Element of ( NAT )) by L257 , INT_1:3;
L258: R22 divides ( D26 * D27 ) by L256;
thus L259: thesis by L258 , NEWTON:80;
end;
suppose L260: (R1 >= ( 0 ) & R7 < ( 0 ));

reconsider D28 = R1 , D29 = ( - R7 ) as (Element of ( NAT )) by L260 , INT_1:3;
L261: R22 divides ( - ( D28 * R7 ) ) by L256 , INT_2:10;
L262: R22 divides ( D28 * D29 ) by L261;
L263: (R22 divides D28 or R22 divides D29) by L262 , NEWTON:80;
thus L264: thesis by L263 , INT_2:10;
end;
suppose L265: (R1 < ( 0 ) & R7 >= ( 0 ));

reconsider D30 = ( - R1 ) , D31 = R7 as (Element of ( NAT )) by L265 , INT_1:3;
L266: R22 divides ( - ( R1 * D31 ) ) by L256 , INT_2:10;
L267: R22 divides ( D30 * D31 ) by L266;
L268: (R22 divides D30 or R22 divides D31) by L267 , NEWTON:80;
thus L269: thesis by L268 , INT_2:10;
end;
suppose L270: (R1 < ( 0 ) & R7 < ( 0 ));

reconsider D32 = ( - R1 ) , D33 = ( - R7 ) as (Element of ( NAT )) by L270 , INT_1:3;
L271: R22 divides ( D32 * D33 ) by L256;
L272: (R22 divides D32 or R22 divides D33) by L271 , NEWTON:80;
thus L273: thesis by L272 , INT_2:10;
end;
end;
theorem
L275: (for R16 being Nat holds (for R22 being Prime holds (for R17 being (FinSequence of ( INT )) holds ((( len R17 ) = ( R16 + 1 ) & R22 > 2 & (not R22 divides ( R17 . ( R16 + 1 ) ))) implies (for R24 being (FinSequence of ( INT )) holds (((for R13 being Nat holds (R13 in ( dom R24 ) implies ( ( ( Poly-INT R17 ) . ( R24 . R13 ) ) mod R22 ) = ( 0 ))) & (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom R24 ) & R14 in ( dom R24 ) & R13 <> R14) implies (not ( R24 . R13 ) , ( R24 . R14 ) are_congruent_mod R22))))) implies ( len R24 ) <= R16))))))
proof
let R16 being Nat;
let R22 being Prime;
defpred S4[ Nat ] means (for R17 being (FinSequence of ( INT )) holds ((( len R17 ) = ( $1 + 1 ) & R22 > 2 & (not R22 divides ( R17 . ( $1 + 1 ) ))) implies (for R24 being (FinSequence of ( INT )) holds (((for R13 being Nat holds (R13 in ( dom R24 ) implies ( ( ( Poly-INT R17 ) . ( R24 . R13 ) ) mod R22 ) = ( 0 ))) & (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom R24 ) & R14 in ( dom R24 ) & R13 <> R14) implies (not ( R24 . R13 ) , ( R24 . R14 ) are_congruent_mod R22))))) implies ( len R24 ) <= $1))));
L276: (for R16 being Nat holds (S4[ R16 ] implies S4[ ( R16 + 1 ) ]))
proof
let R16 being Nat;
assume L277: S4[ R16 ];
let R17 being (FinSequence of ( INT ));
assume that
L278: ( len R17 ) = ( ( R16 + 1 ) + 1 )
and
L279: R22 > 2
and
L280: (not R22 divides ( R17 . ( ( R16 + 1 ) + 1 ) ));
per cases ;
suppose L281: (for R11 being Integer holds ( ( ( Poly-INT R17 ) . R11 ) mod R22 ) <> ( 0 ));

assume L282: (ex R24 being (FinSequence of ( INT )) st ((for R13 being Nat holds (R13 in ( dom R24 ) implies ( ( ( Poly-INT R17 ) . ( R24 . R13 ) ) mod R22 ) = ( 0 ))) & (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom R24 ) & R14 in ( dom R24 ) & R13 <> R14) implies (not ( R24 . R13 ) , ( R24 . R14 ) are_congruent_mod R22)))) & ( len R24 ) > ( R16 + 1 )));
consider R24 being (FinSequence of ( INT )) such that L283: (for R13 being Nat holds (R13 in ( dom R24 ) implies ( ( ( Poly-INT R17 ) . ( R24 . R13 ) ) mod R22 ) = ( 0 ))) and L284: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom R24 ) & R14 in ( dom R24 ) & R13 <> R14) implies (not ( R24 . R13 ) , ( R24 . R14 ) are_congruent_mod R22)))) and L285: ( len R24 ) > ( R16 + 1 ) by L282;
L286: R24 <> ( {} ) by L285;
L287: ( ( ( Poly-INT R17 ) . ( R24 . 1 ) ) mod R22 ) = ( 0 ) by L286 , L283 , FINSEQ_5:6;
thus L288: contradiction by L287 , L281;
end;
suppose L289: (ex B33 being Integer st ( ( ( Poly-INT R17 ) . B33 ) mod R22 ) = ( 0 ));

consider C31 being Integer such that L290: ( ( ( Poly-INT R17 ) . C31 ) mod R22 ) = ( 0 ) by L289;
assume L291: (ex R25 being (FinSequence of ( INT )) st ((for R13 being Nat holds (R13 in ( dom R25 ) implies ( ( ( Poly-INT R17 ) . ( R25 . R13 ) ) mod R22 ) = ( 0 ))) & (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom R25 ) & R14 in ( dom R25 ) & R13 <> R14) implies (not ( R25 . R13 ) , ( R25 . R14 ) are_congruent_mod R22)))) & ( len R25 ) > ( R16 + 1 )));
consider R25 being (FinSequence of ( INT )) such that L292: (for R13 being Nat holds (R13 in ( dom R25 ) implies ( ( ( Poly-INT R17 ) . ( R25 . R13 ) ) mod R22 ) = ( 0 ))) and L293: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom R25 ) & R14 in ( dom R25 ) & R13 <> R14) implies (not ( R25 . R13 ) , ( R25 . R14 ) are_congruent_mod R22)))) and L294: ( len R25 ) > ( R16 + 1 ) by L291;
consider R18 being (FinSequence of ( INT )), R8 being Integer such that L295: ( len R18 ) = ( R16 + 1 ) and L296: (for B34 being (Element of ( INT )) holds ( ( Poly-INT R17 ) . B34 ) = ( ( ( B34 - C31 ) * ( ( Poly-INT R18 ) . B34 ) ) + R8 )) and L297: ( R17 . ( R16 + 2 ) ) = ( R18 . ( R16 + 1 ) ) by L278 , L146;
L298: C31 is (Element of ( INT )) by INT_1:def 2;
L299: ( ( ( Poly-INT R17 ) . C31 ) mod R22 ) = ( ( ( ( C31 - C31 ) * ( ( Poly-INT R18 ) . C31 ) ) + R8 ) mod R22 ) by L298 , L296
.= ( R8 mod R22 );
L300: (for B35 being (Element of ( NAT )) holds (B35 in ( dom R25 ) implies R22 divides ( ( ( R25 . B35 ) - C31 ) * ( ( Poly-INT R18 ) . ( R25 . B35 ) ) )))
proof
let C32 being (Element of ( NAT ));
L301: ( R25 . C32 ) is (Element of ( INT )) by INT_1:def 2;
L302: ( ( ( Poly-INT R17 ) . ( R25 . C32 ) ) mod R22 ) = ( ( ( ( ( R25 . C32 ) - C31 ) * ( ( Poly-INT R18 ) . ( R25 . C32 ) ) ) + R8 ) mod R22 ) by L301 , L296
.= ( ( ( ( ( ( R25 . C32 ) - C31 ) * ( ( Poly-INT R18 ) . ( R25 . C32 ) ) ) mod R22 ) + ( R8 mod R22 ) ) mod R22 ) by NAT_D:66
.= ( ( ( ( R25 . C32 ) - C31 ) * ( ( Poly-INT R18 ) . ( R25 . C32 ) ) ) mod R22 ) by L290 , L299 , NAT_D:65;
assume L303: C32 in ( dom R25 );
L304: ( ( ( ( R25 . C32 ) - C31 ) * ( ( Poly-INT R18 ) . ( R25 . C32 ) ) ) mod R22 ) = ( 0 ) by L303 , L292 , L302;
thus L305: thesis by L304 , INT_1:62;
end;
per cases ;
suppose L306: (for R13 being Nat holds (R13 in ( dom R25 ) implies (not R22 divides ( ( R25 . R13 ) - C31 ))));

L307: (for R13 being Nat holds (R13 in ( dom R25 ) implies ( ( ( Poly-INT R18 ) . ( R25 . R13 ) ) mod R22 ) = ( 0 )))
proof
let R13 being Nat;
assume L308: R13 in ( dom R25 );
L309: R22 divides ( ( ( R25 . R13 ) - C31 ) * ( ( Poly-INT R18 ) . ( R25 . R13 ) ) ) by L308 , L300;
L310: (R22 divides ( ( R25 . R13 ) - C31 ) or R22 divides ( ( Poly-INT R18 ) . ( R25 . R13 ) )) by L309 , L255;
thus L311: thesis by L310 , L306 , L308 , INT_1:62;
end;
L312: ( len R25 ) <= R16 by L307 , L277 , L279 , L280 , L295 , L297 , L293;
thus L313: contradiction by L312 , L294 , XREAL_1:145;
end;
suppose L314: (ex R13 being Nat st (R13 in ( dom R25 ) & R22 divides ( ( R25 . R13 ) - C31 )));

consider C33 being (Element of ( NAT )) such that L315: C33 in ( dom R25 ) and L316: R22 divides ( ( R25 . C33 ) - C31 ) by L314;
set D34 = ( R25 - { ( R25 . C33 ) } );
L317: (for R13 being Nat holds (R13 in ( dom D34 ) implies (not R22 divides ( ( D34 . R13 ) - C31 ))))
proof
given C34 being Nat such that
L318: C34 in ( dom D34 )
and
L319: R22 divides ( ( D34 . C34 ) - C31 );

L320: ( D34 . C34 ) in ( rng D34 ) by L318 , FUNCT_1:3;
L321: ( D34 . C34 ) in ( ( rng R25 ) \ { ( R25 . C33 ) } ) by L320 , FINSEQ_3:65;
L322: ( D34 . C34 ) in ( rng R25 ) by L321 , XBOOLE_0:def 5;
consider C35 being set such that L323: C35 in ( dom R25 ) and L324: ( R25 . C35 ) = ( D34 . C34 ) by L322 , FUNCT_1:def 3;
reconsider D35 = C35 as (Element of ( NAT )) by L323;
L325: R22 divides ( ( ( R25 . D35 ) - C31 ) - ( ( R25 . C33 ) - C31 ) ) by L316 , L319 , L324 , L1;
L326: R22 divides ( ( R25 . D35 ) - ( R25 . C33 ) ) by L325;
L327: ( R25 . D35 ) , ( R25 . C33 ) are_congruent_mod R22 by L326 , INT_2:15;
L328: (not ( D34 . C34 ) in { ( R25 . C33 ) }) by L321 , XBOOLE_0:def 5;
L329: D35 <> C33 by L328 , L324 , TARSKI:def 1;
thus L330: contradiction by L329 , L293 , L315 , L323 , L327;
end;
L331: (for R13 being Nat holds (R13 in ( dom D34 ) implies ( ( ( Poly-INT R18 ) . ( D34 . R13 ) ) mod R22 ) = ( 0 )))
proof
let R13 being Nat;
assume L332: R13 in ( dom D34 );
L333: ( D34 . R13 ) in ( rng D34 ) by L332 , FUNCT_1:3;
L334: ( D34 . R13 ) in ( ( rng R25 ) \ { ( R25 . C33 ) } ) by L333 , FINSEQ_3:65;
L335: ( D34 . R13 ) in ( rng R25 ) by L334 , XBOOLE_0:def 5;
L336: (ex B36 being set st (B36 in ( dom R25 ) & ( R25 . B36 ) = ( D34 . R13 ))) by L335 , FUNCT_1:def 3;
L337: R22 divides ( ( ( D34 . R13 ) - C31 ) * ( ( Poly-INT R18 ) . ( D34 . R13 ) ) ) by L336 , L300;
L338: (R22 divides ( ( D34 . R13 ) - C31 ) or R22 divides ( ( Poly-INT R18 ) . ( D34 . R13 ) )) by L337 , L255;
thus L339: thesis by L338 , L317 , L332 , INT_1:62;
end;
L340: R25 is  one-to-one
proof
let C36 , C37 being set;
assume that
L341: C36 in ( dom R25 )
and
L342: C37 in ( dom R25 )
and
L343: ( R25 . C36 ) = ( R25 . C37 )
and
L344: C36 <> C37;
thus L345: contradiction by L293 , L341 , L342 , L343 , L344 , INT_1:11;
end;
L346: D34 is  one-to-one by L340 , FINSEQ_3:87;
L347: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom D34 ) & R14 in ( dom D34 ) & R13 <> R14) implies (not ( D34 . R13 ) , ( D34 . R14 ) are_congruent_mod R22))))
proof
let R13 being Nat;
let R14 being Nat;
assume that
L348: R13 in ( dom D34 )
and
L349: R14 in ( dom D34 )
and
L350: R13 <> R14;
L351: ( D34 . R14 ) in ( rng D34 ) by L349 , FUNCT_1:3;
L352: ( D34 . R14 ) in ( ( rng R25 ) \ { ( R25 . C33 ) } ) by L351 , FINSEQ_3:65;
L353: ( D34 . R14 ) in ( rng R25 ) by L352 , XBOOLE_0:def 5;
consider C38 being set such that L354: C38 in ( dom R25 ) and L355: ( D34 . R14 ) = ( R25 . C38 ) by L353 , FUNCT_1:def 3;
L356: ( D34 . R13 ) in ( rng D34 ) by L348 , FUNCT_1:3;
L357: ( D34 . R13 ) in ( ( rng R25 ) \ { ( R25 . C33 ) } ) by L356 , FINSEQ_3:65;
L358: ( D34 . R13 ) in ( rng R25 ) by L357 , XBOOLE_0:def 5;
consider C39 being set such that L359: C39 in ( dom R25 ) and L360: ( D34 . R13 ) = ( R25 . C39 ) by L358 , FUNCT_1:def 3;
reconsider D36 = C39 , D37 = C38 as (Element of ( NAT )) by L359 , L354;
L361: D36 <> D37 by L346 , L348 , L349 , L350 , L360 , L355 , FUNCT_1:def 4;
thus L362: thesis by L361 , L293 , L359 , L360 , L354 , L355;
end;
L363: ( R25 . C33 ) in ( rng R25 ) by L315 , FUNCT_1:3;
L364: ( len D34 ) = ( ( len R25 ) - 1 ) by L363 , L340 , FINSEQ_3:90;
L365: ( len D34 ) > ( ( R16 + 1 ) - 1 ) by L364 , L294 , XREAL_1:9;
thus L366: contradiction by L365 , L277 , L279 , L280 , L295 , L297 , L331 , L347;
end;
end;
end;
L369: S4[ ( 0 ) ]
proof
let R17 being (FinSequence of ( INT ));
assume that
L370: ( len R17 ) = ( ( 0 ) + 1 )
and
L371: R22 > 2
and
L372: (not R22 divides ( R17 . ( ( 0 ) + 1 ) ));
assume L373: (ex R24 being (FinSequence of ( INT )) st ((for R13 being Nat holds (R13 in ( dom R24 ) implies ( ( ( Poly-INT R17 ) . ( R24 . R13 ) ) mod R22 ) = ( 0 ))) & (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom R24 ) & R14 in ( dom R24 ) & R13 <> R14) implies (not ( R24 . R13 ) , ( R24 . R14 ) are_congruent_mod R22)))) & ( len R24 ) > ( 0 )));
consider R24 being (FinSequence of ( INT )) such that L374: (for R13 being Nat holds (R13 in ( dom R24 ) implies ( ( ( Poly-INT R17 ) . ( R24 . R13 ) ) mod R22 ) = ( 0 ))) and L375: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom R24 ) & R14 in ( dom R24 ) & R13 <> R14) implies (not ( R24 . R13 ) , ( R24 . R14 ) are_congruent_mod R22)))) and L376: ( len R24 ) > ( 0 ) by L373;
L377: R24 <> ( {} ) by L376;
L378: ( ( ( Poly-INT R17 ) . ( R24 . 1 ) ) mod R22 ) = ( 0 ) by L377 , L374 , FINSEQ_5:6;
L379: ( R24 . 1 ) in ( INT ) by INT_1:def 2;
L380: ( ( Poly-INT R17 ) . ( R24 . 1 ) ) = ( ( ( INT ) --> ( R17 . 1 ) ) . ( R24 . 1 ) ) by L370 , L50
.= ( R17 . 1 ) by L379 , FUNCOP_1:7;
thus L381: contradiction by L380 , L372 , L378 , L14;
end;
L382: (for R16 being Nat holds S4[ R16 ]) from NAT_1:sch 2(L369 , L276);
thus L383: thesis by L382;
end;
definition
let C40 being Integer;
let C41 being Nat;
pred C40 is_quadratic_residue_mod C41
means
:L384: (ex B37 being Integer st ( ( ( B37 ^2 ) - C40 ) mod C41 ) = ( 0 ))
;end;
theorem
L386: (for R9 being Integer holds (for R27 being Nat holds ( R9 ^2 ) is_quadratic_residue_mod R27))
proof
let R9 being Integer;
let R27 being Nat;
L387: ( ( ( R9 ^2 ) - ( R9 ^2 ) ) mod R27 ) = ( 0 ) by INT_4:12;
thus L388: thesis by L387 , L384;
end;
theorem
L389: 1 is_quadratic_residue_mod 2
proof
L390: ( 1 ^2 ) is_quadratic_residue_mod 2 by L386;
thus L391: thesis by L390;
end;
theorem
L392: (for R1 being Integer holds (for R7 being Integer holds (for R27 being Nat holds ((R1 is_quadratic_residue_mod R27 & R1 , R7 are_congruent_mod R27) implies R7 is_quadratic_residue_mod R27))))
proof
let R1 being Integer;
let R7 being Integer;
let R27 being Nat;
assume that
L393: R1 is_quadratic_residue_mod R27
and
L394: R1 , R7 are_congruent_mod R27;
consider C42 being Integer such that L395: ( ( ( C42 ^2 ) - R1 ) mod R27 ) = ( 0 ) by L393 , L384;
L396: R27 divides ( R1 - R7 ) by L394 , INT_2:15;
L397: ( ( R1 - R7 ) mod R27 ) = ( 0 ) by L396 , L14;
L398: ( ( ( C42 ^2 ) - R7 ) mod R27 ) = ( ( ( ( C42 ^2 ) - R1 ) + ( R1 - R7 ) ) mod R27 )
.= ( ( ( ( ( C42 ^2 ) - R1 ) mod R27 ) + ( ( R1 - R7 ) mod R27 ) ) mod R27 ) by NAT_D:66
.= ( 0 ) by L395 , L397 , NAT_D:65;
thus L399: thesis by L398 , L384;
end;
L400: (for R1 being Integer holds (for R22 being Prime holds (R1 , R22 are_relative_prime  or R22 divides R1)))
proof
let R1 being Integer;
let R22 being Prime;
per cases ;
suppose L401: R1 >= ( 0 );

reconsider D38 = R1 as (Element of ( NAT )) by L401 , INT_1:3;
L402: (D38 , R22 are_relative_prime  or ( D38 gcd R22 ) = R22) by PEPIN:2;
thus L403: thesis by L402 , NAT_D:def 5;
end;
suppose L404: R1 < ( 0 );

reconsider D39 = ( - R1 ) as (Element of ( NAT )) by L404 , INT_1:3;
L405: (D39 , R22 are_relative_prime  or ( D39 gcd R22 ) = R22) by PEPIN:2;
per cases  by L405 , NAT_D:def 5;
suppose L406: D39 , R22 are_relative_prime ;

L407: D39 = ( abs R1 ) by L404 , ABSVALUE:def 1;
L408: ( R1 gcd R22 ) = ( D39 gcd ( abs R22 ) ) by L407 , INT_2:34
.= ( D39 gcd R22 ) by ABSVALUE:def 1
.= 1 by L406 , INT_2:def 3;
thus L409: thesis by L408 , INT_2:def 3;
end;
suppose L410: R22 divides D39;

consider C43 being Nat such that L411: D39 = ( R22 * C43 ) by L410 , NAT_D:def 3;
L412: R1 = ( R22 * ( - C43 ) ) by L411;
thus L413: thesis by L412 , INT_1:def 3;
end;
end;
end;
theorem
L416: (for R1 being Integer holds (for R7 being Integer holds (R1 divides R7 implies ( R1 gcd R7 ) = ( abs R1 ))))
proof
let R1 being Integer;
let R7 being Integer;
assume L417: R1 divides R7;
L418: ( abs R1 ) divides ( abs R7 ) by L417 , INT_2:16;
L419: ( ( abs R1 ) gcd ( abs R7 ) ) = ( abs R1 ) by L418 , NEWTON:49;
thus L420: thesis by L419 , INT_2:34;
end;
theorem
L421: (for R16 being Nat holds (for B38 , B39 , B40 being Integer holds (( B38 mod B40 ) = ( B39 mod B40 ) implies ( ( B38 |^ R16 ) mod B40 ) = ( ( B39 |^ R16 ) mod B40 ))))
proof
let R16 being Nat;
let C44 , C45 , C46 being Integer;
defpred S5[ Nat ] means ( ( C44 |^ $1 ) mod C46 ) = ( ( C45 |^ $1 ) mod C46 );
assume L422: ( C44 mod C46 ) = ( C45 mod C46 );
L423: (for B41 being (Element of ( NAT )) holds (S5[ B41 ] implies S5[ ( B41 + 1 ) ]))
proof
let C47 being (Element of ( NAT ));
assume L424: S5[ C47 ];
thus L425: ( ( C44 |^ ( C47 + 1 ) ) mod C46 ) = ( ( ( C44 |^ C47 ) * C44 ) mod C46 ) by NEWTON:6
.= ( ( ( ( C45 |^ C47 ) mod C46 ) * ( C45 mod C46 ) ) mod C46 ) by L422 , L424 , NAT_D:67
.= ( ( ( C45 |^ C47 ) * C45 ) mod C46 ) by NAT_D:67
.= ( ( C45 |^ ( C47 + 1 ) ) mod C46 ) by NEWTON:6;
end;
L426: ( C44 |^ ( 0 ) ) = 1 by NEWTON:4;
L427: S5[ ( 0 ) ] by L426 , NEWTON:4;
L428: (for B42 being (Element of ( NAT )) holds S5[ B42 ]) from NAT_1:sch 1(L427 , L423);
L429: (for R16 being Nat holds S5[ R16 ])
proof
let R16 being Nat;
L430: R16 in ( NAT ) by ORDINAL1:def 12;
thus L431: thesis by L430 , L428;
end;
thus L432: thesis by L429;
end;
theorem
L433: (for R9 being Integer holds (for R11 being Integer holds (for R22 being Prime holds ((( R9 gcd R22 ) = 1 & ( ( ( R11 ^2 ) - R9 ) mod R22 ) = ( 0 )) implies R11 , R22 are_relative_prime ))))
proof
let R9 being Integer;
let R11 being Integer;
let R22 being Prime;
assume that
L434: ( R9 gcd R22 ) = 1
and
L435: ( ( ( R11 ^2 ) - R9 ) mod R22 ) = ( 0 );
assume L436: (not R11 , R22 are_relative_prime );
L437: R22 divides ( R11 ^2 ) by L436 , L400 , INT_2:2;
L438: R22 divides ( ( R11 ^2 ) - R9 ) by L435 , L14;
L439: R22 divides ( ( R11 ^2 ) - ( ( R11 ^2 ) - R9 ) ) by L438 , L437 , L1;
L440: ( R22 gcd R9 ) = ( abs R22 ) by L439 , L416
.= R22 by ABSVALUE:def 1;
thus L441: contradiction by L440 , L434 , INT_2:def 4;
end;
theorem
L442: (for R9 being Integer holds (for R22 being Prime holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & R9 is_quadratic_residue_mod R22) implies (ex B43 , B44 being Integer st (( ( ( B43 ^2 ) - R9 ) mod R22 ) = ( 0 ) & ( ( ( B44 ^2 ) - R9 ) mod R22 ) = ( 0 ) & (not B43 , B44 are_congruent_mod R22))))))
proof
let R9 being Integer;
let R22 being Prime;
assume that
L443: R22 > 2
and
L444: ( R9 gcd R22 ) = 1
and
L445: R9 is_quadratic_residue_mod R22;
consider R11 being Integer such that L446: ( ( ( R11 ^2 ) - R9 ) mod R22 ) = ( 0 ) by L445 , L384;
take R11;
take ( - R11 );
L447: (not R11 , ( - R11 ) are_congruent_mod R22)
proof
assume L448: R11 , ( - R11 ) are_congruent_mod R22;
L449: R22 divides ( R11 - ( - R11 ) ) by L448 , INT_2:15;
L450: R22 divides ( 2 * R11 ) by L449;
L451: 2 , R22 are_relative_prime  by L443 , INT_2:28 , INT_2:30;
L452: ( 2 gcd R22 ) = 1 by L451 , INT_2:def 3;
L453: R22 divides R11 by L452 , L450 , WSIERP_1:29;
consider C48 being Integer such that L454: R11 = ( R22 * C48 ) by L453 , INT_1:def 3;
L455: ( R11 gcd R22 ) = ( ( R22 * C48 ) gcd ( R22 * 1 ) ) by L454
.= ( R22 * ( C48 gcd 1 ) ) by EULER_1:15
.= ( R22 * 1 ) by WSIERP_1:8;
L456: ( R11 gcd R22 ) <> 1 by L455 , INT_2:def 4;
L457: (not R11 , R22 are_relative_prime ) by L456 , INT_2:def 3;
thus L458: contradiction by L457 , L444 , L446 , L433;
end;
thus L459: thesis by L447 , L446;
end;
theorem
L460: (for R22 being Prime holds (R22 > 2 implies (ex B45 being (FinSequence of ( NAT )) st (( len B45 ) = ( ( R22 -' 1 ) div 2 ) & (for R13 being Nat holds (R13 in ( dom B45 ) implies ( ( B45 . R13 ) gcd R22 ) = 1)) & (for R13 being Nat holds (R13 in ( dom B45 ) implies ( B45 . R13 ) is_quadratic_residue_mod R22)) & (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom B45 ) & R14 in ( dom B45 ) & R13 <> R14) implies (not ( B45 . R13 ) , ( B45 . R14 ) are_congruent_mod R22))))))))
proof
let R22 being Prime;
deffunc H4(Nat) = ( $1 ^2 );
consider C49 being FinSequence such that L461: (( len C49 ) = ( ( R22 -' 1 ) div 2 ) & (for B46 being Nat holds (B46 in ( dom C49 ) implies ( C49 . B46 ) = H4(B46)))) from FINSEQ_1:sch 2;
L462: (for B47 being Nat holds (B47 in ( dom C49 ) implies ( C49 . B47 ) in ( NAT )))
proof
let C50 being Nat;
assume L463: C50 in ( dom C49 );
L464: ( C49 . C50 ) = ( C50 ^2 ) by L463 , L461;
thus L465: thesis by L464;
end;
reconsider D40 = C49 as (FinSequence of ( NAT )) by L462 , FINSEQ_2:12;
L466: R22 > 1 by INT_2:def 4;
L467: ( R22 -' 1 ) = ( R22 - 1 ) by L466 , XREAL_1:233;
assume L468: R22 > 2;
L469: R22 is  odd by L468 , PEPIN:17;
L470: ( R22 - 1 ) is  even by L469 , HILBERT3:2;
L471: 2 divides ( R22 -' 1 ) by L470 , L467 , PEPIN:22;
L472: ( ( R22 -' 1 ) mod 2 ) = ( 0 ) by L471 , PEPIN:6;
L473: ( ( R22 -' 1 ) div 2 ) = ( ( R22 -' 1 ) / 2 ) by L472 , PEPIN:63;
L474: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom D40 ) & R14 in ( dom D40 ) & R13 <> R14) implies (not ( D40 . R13 ) , ( D40 . R14 ) are_congruent_mod R22))))
proof
L475: ( R22 - 1 ) > ( 0 ) by L466 , XREAL_1:50;
L476: ( ( R22 - 1 ) / 2 ) < ( ( R22 - 1 ) / 1 ) by L475 , XREAL_1:76;
L477: ( ( R22 -' 1 ) div 2 ) < R22 by L476 , L467 , L473 , XREAL_1:147;
L478: ( ( ( R22 -' 1 ) div 2 ) - 1 ) < R22 by L477 , XREAL_1:147;
let R13 being Nat;
let R14 being Nat;
assume that
L479: R13 in ( dom D40 )
and
L480: R14 in ( dom D40 )
and
L481: R13 <> R14;
L482: R14 in ( Seg ( ( R22 -' 1 ) div 2 ) ) by L461 , L480 , FINSEQ_1:def 3;
L483: R14 <= ( ( R22 -' 1 ) div 2 ) by L482 , FINSEQ_1:1;
L484: R13 in ( Seg ( ( R22 -' 1 ) div 2 ) ) by L461 , L479 , FINSEQ_1:def 3;
L485: R13 >= 1 by L484 , FINSEQ_1:1;
L486: ( 1 - ( ( R22 -' 1 ) div 2 ) ) <= ( R13 - R14 ) by L485 , L483 , XREAL_1:13;
L487: ( - ( ( ( R22 -' 1 ) div 2 ) - 1 ) ) <= ( R13 - R14 ) by L486;
L488: R13 <= ( ( R22 -' 1 ) div 2 ) by L484 , FINSEQ_1:1;
L489: ( R13 + R14 ) <= ( ( ( R22 -' 1 ) div 2 ) + ( ( R22 -' 1 ) div 2 ) ) by L488 , L483 , XREAL_1:7;
L490: ( R13 + R14 ) < R22 by L489 , L467 , L473 , XREAL_1:147;
L491: ( R13 + R14 ) , R22 are_relative_prime  by L490 , L485 , EULER_1:2;
L492: ( ( R13 + R14 ) gcd R22 ) = 1 by L491 , INT_2:def 3;
assume L493: ( D40 . R13 ) , ( D40 . R14 ) are_congruent_mod R22;
L494: R22 divides ( ( D40 . R13 ) - ( D40 . R14 ) ) by L493 , INT_2:15;
L495: R22 divides ( ( R13 ^2 ) - ( D40 . R14 ) ) by L494 , L461 , L479;
L496: R22 divides ( ( R13 ^2 ) - ( R14 ^2 ) ) by L495 , L461 , L480;
L497: R22 divides ( ( R13 - R14 ) * ( R13 + R14 ) ) by L496;
L498: ( R13 - R14 ) <> ( 0 ) by L481;
L499: ( abs R22 ) <= ( abs ( R13 - R14 ) ) by L498 , L492 , L497 , INT_4:6 , WSIERP_1:29;
L500: R22 <= ( abs ( R13 - R14 ) ) by L499 , ABSVALUE:def 1;
L501: R14 >= 1 by L482 , FINSEQ_1:1;
L502: ( R13 - R14 ) <= ( ( ( R22 -' 1 ) div 2 ) - 1 ) by L501 , L488 , XREAL_1:13;
L503: ( abs ( R13 - R14 ) ) <= ( ( ( R22 -' 1 ) div 2 ) - 1 ) by L502 , L487 , ABSVALUE:5;
thus L504: contradiction by L503 , L500 , L478 , XXREAL_0:2;
end;
L505: (for R13 being Nat holds (R13 in ( dom D40 ) implies ( R13 gcd R22 ) = 1))
proof
let R13 being Nat;
L506: ( 1 * R13 ) <= ( 2 * R13 ) by XREAL_1:64;
assume L507: R13 in ( dom D40 );
L508: R13 in ( Seg ( ( R22 -' 1 ) div 2 ) ) by L507 , L461 , FINSEQ_1:def 3;
L509: R13 <= ( ( R22 -' 1 ) div 2 ) by L508 , FINSEQ_1:1;
L510: ( 2 * R13 ) <= ( ( ( R22 -' 1 ) / 2 ) * 2 ) by L509 , L473 , XREAL_1:64;
L511: R13 <= ( R22 -' 1 ) by L510 , L506 , XXREAL_0:2;
L512: R13 < R22 by L511 , L467 , XREAL_1:147;
L513: R13 >= 1 by L508 , FINSEQ_1:1;
L514: R13 , R22 are_relative_prime  by L513 , L512 , EULER_1:2;
thus L515: thesis by L514 , INT_2:def 3;
end;
L516: (for R13 being Nat holds (R13 in ( dom D40 ) implies ( ( D40 . R13 ) gcd R22 ) = 1))
proof
let R13 being Nat;
assume L517: R13 in ( dom D40 );
L518: ( R13 gcd R22 ) = 1 by L517 , L505;
L519: ( ( R13 ^2 ) gcd R22 ) = 1 by L518 , WSIERP_1:7;
thus L520: thesis by L519 , L461 , L517;
end;
take D40;
L521: (for R13 being Nat holds (R13 in ( dom D40 ) implies ( D40 . R13 ) is_quadratic_residue_mod R22))
proof
let R13 being Nat;
assume L522: R13 in ( dom D40 );
L523: ( R13 ^2 ) is_quadratic_residue_mod R22 by L386;
thus L524: thesis by L523 , L461 , L522;
end;
thus L525: thesis by L521 , L461 , L516 , L474;
end;
theorem
L526: (for R9 being Integer holds (for R22 being Prime holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & R9 is_quadratic_residue_mod R22) implies ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = 1)))
proof
let R9 being Integer;
let R22 being Prime;
assume that
L527: R22 > 2
and
L528: ( R9 gcd R22 ) = 1
and
L529: R9 is_quadratic_residue_mod R22;
consider C51 being Integer such that L530: ( ( ( C51 ^2 ) - R9 ) mod R22 ) = ( 0 ) by L529 , L384;
L531: R22 > 1 by INT_2:def 4;
L532: R22 is  odd by L527 , PEPIN:17;
L533: ( R22 - 1 ) is  even by L532 , HILBERT3:2;
L534: ( R22 -' 1 ) is  even by L533 , L531 , XREAL_1:233;
L535: 2 divides ( R22 -' 1 ) by L534 , PEPIN:22;
L536: ( R22 -' 1 ) = ( 2 * ( ( R22 -' 1 ) div 2 ) ) by L535 , NAT_D:3;
L537: R22 divides ( ( C51 ^2 ) - R9 ) by L530 , INT_1:62;
L538: ( C51 ^2 ) , R9 are_congruent_mod R22 by L537 , INT_2:15;
L539: ( R9 mod R22 ) = ( ( C51 ^2 ) mod R22 ) by L538 , NAT_D:64;
L540: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( ( ( C51 ^2 ) |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) by L539 , L421
.= ( ( ( C51 |^ 2 ) |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) by NEWTON:81
.= ( ( C51 |^ ( R22 -' 1 ) ) mod R22 ) by L536 , NEWTON:9;
L541: C51 , R22 are_relative_prime  by L528 , L530 , L433;
per cases ;
suppose L542: C51 >= ( 0 );

reconsider D41 = C51 as (Element of ( NAT )) by L542 , INT_1:3;
L543: D41 , R22 are_relative_prime  by L528 , L530 , L433;
thus L544: thesis by L543 , L540 , PEPIN:37;
end;
suppose L545: C51 < ( 0 );

reconsider D42 = ( - C51 ) as (Element of ( NAT )) by L545 , INT_1:3;
L546: ( abs R22 ) = R22 by ABSVALUE:def 1;
L547: ( D42 gcd R22 ) = ( ( abs C51 ) gcd R22 ) by L545 , ABSVALUE:def 1
.= ( C51 gcd R22 ) by L546 , INT_2:34
.= 1 by L541 , INT_2:def 3;
L548: D42 , R22 are_relative_prime  by L547 , INT_2:def 3;
L549: ( ( D42 |^ ( R22 -' 1 ) ) mod R22 ) = 1 by L548 , PEPIN:37;
L550: ( ( C51 |^ ( R22 -' 1 ) ) mod R22 ) = ( ( ( C51 |^ 2 ) |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) by L536 , NEWTON:9
.= ( ( ( ( - C51 ) |^ 2 ) |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) by WSIERP_1:1
.= 1 by L536 , L549 , NEWTON:9;
thus L551: thesis by L550 , L540;
end;
end;
theorem
L553: (for R22 being Prime holds (for R26 being Nat holds ((R22 > 2 & ( R26 gcd R22 ) = 1 & (not R26 is_quadratic_residue_mod R22)) implies ( ( R26 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( R22 - 1 ))))
proof
let R22 being Prime;
let R26 being Nat;
assume that
L554: R22 > 2
and
L555: ( R26 gcd R22 ) = 1
and
L556: (not R26 is_quadratic_residue_mod R22);
reconsider D43 = R26 as (Element of ( NAT )) by ORDINAL1:def 12;
L557: R22 > 1 by INT_2:def 4;
L558: ( 1 mod R22 ) = 1 by L557 , NAT_D:14;
L559: R22 is  odd by L554 , PEPIN:17;
L560: ( R22 - 1 ) is  even by L559 , HILBERT3:2;
L561: ( R22 -' 1 ) is  even by L560 , L557 , XREAL_1:233;
L562: 2 divides ( R22 -' 1 ) by L561 , PEPIN:22;
L563: ( R22 -' 1 ) = ( 2 * ( ( R22 -' 1 ) div 2 ) ) by L562 , NAT_D:3;
L564: ( ( D43 |^ ( R22 -' 1 ) ) - 1 ) = ( ( ( D43 |^ ( ( R22 -' 1 ) div 2 ) ) |^ 2 ) - 1 ) by L563 , NEWTON:9
.= ( ( ( D43 |^ ( ( R22 -' 1 ) div 2 ) ) ^2 ) - 1 ) by NEWTON:81
.= ( ( ( D43 |^ ( ( R22 -' 1 ) div 2 ) ) + 1 ) * ( ( D43 |^ ( ( R22 -' 1 ) div 2 ) ) - 1 ) );
L565: D43 , R22 are_relative_prime  by L555 , INT_2:def 3;
L566: ( ( D43 |^ ( R22 -' 1 ) ) mod R22 ) = 1 by L565 , PEPIN:37;
L567: ( ( ( D43 |^ ( R22 -' 1 ) ) - 1 ) mod R22 ) = ( 0 ) by L566 , L558 , INT_4:22;
L568: R22 divides ( ( ( D43 |^ ( ( R22 -' 1 ) div 2 ) ) + 1 ) * ( ( D43 |^ ( ( R22 -' 1 ) div 2 ) ) - 1 ) ) by L567 , L564 , L14;
L569: ( R22 - 1 ) > ( 2 - 1 ) by L554 , XREAL_1:9;
L570: ( R22 - 1 ) >= ( 1 + 1 ) by L569 , INT_1:7;
L571: ( R22 -' 1 ) >= 2 by L570 , L557 , XREAL_1:233;
L572: ( ( R22 -' 1 ) div 2 ) >= ( 2 div 2 ) by L571 , NAT_2:24;
L573: ( ( R22 -' 1 ) div 2 ) >= 1 by L572 , PEPIN:44;
per cases  by L573 , XXREAL_0:1;
suppose L574: ( ( R22 -' 1 ) div 2 ) = 1;

L575:
now
assume L576: R22 divides ( D43 - 1 );
L577: R22 divides ( - ( D43 - 1 ) ) by L576 , INT_2:10;
L578: ( ( ( 1 ^2 ) - D43 ) mod R22 ) = ( 0 ) by L577 , L14;
thus L579: contradiction by L578 , L556 , L384;
end;
L580: R22 divides ( ( D43 + 1 ) * ( ( D43 |^ 1 ) - 1 ) ) by L568 , L574 , NEWTON:5;
L581: R22 divides ( ( D43 + 1 ) * ( D43 - 1 ) ) by L580 , NEWTON:5;
L582: R22 divides ( D43 - ( - 1 ) ) by L581 , L575 , L255;
L583: D43 , ( - 1 ) are_congruent_mod R22 by L582 , INT_2:15;
L584: ( D43 mod R22 ) = ( ( - 1 ) mod R22 ) by L583 , NAT_D:64;
L585: ( - R22 ) < ( - 2 ) by L554 , XREAL_1:24;
L586: ( - R22 ) < ( ( - 2 ) + 1 ) by L585 , XREAL_1:39;
L587: ( D43 mod R22 ) = ( R22 - 1 ) by L586 , L584 , NAT_D:63;
thus L588: thesis by L587 , L574 , NEWTON:5;
end;
suppose L589: ( ( R22 -' 1 ) div 2 ) > 1;

set D44 = ( ( R22 -' 1 ) div 2 );
L590: ( 0 ) is (Element of ( INT )) by INT_1:def 2;
L591: ( ( D44 -' 1 ) |-> ( 0 ) ) is (FinSequence of ( INT )) by L590 , FINSEQ_2:63;
set D45 = ( <* ( - 1 ) *> ^ ( ( D44 -' 1 ) |-> ( 0 ) ) );
L592: ( len ( ( D44 -' 1 ) |-> ( 0 ) ) ) = ( D44 -' 1 ) by CARD_1:def 7;
L593: ( len D45 ) = ( 1 + ( D44 -' 1 ) ) by CARD_1:def 7
.= D44 by L589 , XREAL_1:235;
set D46 = ( ( <* ( - 1 ) *> ^ ( ( D44 -' 1 ) |-> ( 0 ) ) ) ^ <* 1 *> );
L594: 1 is (Element of ( INT )) by INT_1:def 2;
L595: <* 1 *> is (FinSequence of ( INT )) by L594 , FINSEQ_1:74;
L596: ( - 1 ) is (Element of ( INT )) by INT_1:def 2;
L597: <* ( - 1 ) *> is (FinSequence of ( INT )) by L596 , FINSEQ_1:74;
L598: ( <* ( - 1 ) *> ^ ( ( D44 -' 1 ) |-> ( 0 ) ) ) is (FinSequence of ( INT )) by L597 , L591 , FINSEQ_1:75;
reconsider D47 = D46 as (FinSequence of ( INT )) by L598 , L595 , FINSEQ_1:75;
L599: ( len D47 ) = ( len ( <* ( - 1 ) *> ^ ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* 1 *> ) ) ) by FINSEQ_1:32
.= ( 1 + ( len ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* 1 *> ) ) ) by FINSEQ_5:8
.= ( 1 + ( ( D44 -' 1 ) + 1 ) ) by CARD_1:def 7
.= ( 1 + D44 ) by L589 , XREAL_1:235;
L600: ( D47 . 1 ) = ( ( <* ( - 1 ) *> ^ ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* 1 *> ) ) . 1 ) by FINSEQ_1:32
.= ( - 1 ) by FINSEQ_1:41;
L601: (for B48 being (Element of ( INT )) holds ( ( Poly-INT D47 ) . B48 ) = ( ( B48 |^ D44 ) - 1 ))
proof
let C52 being (Element of ( INT ));
consider R24 being (FinSequence of ( INT )) such that L602: ( len R24 ) = ( len D47 ) and L603: (for R13 being Nat holds (R13 in ( dom R24 ) implies ( R24 . R13 ) = ( ( D47 . R13 ) * ( C52 |^ ( R13 -' 1 ) ) ))) and L604: ( ( Poly-INT D47 ) . C52 ) = ( Sum R24 ) by L24;
L605: R24 = ( ( <* ( - 1 ) *> ^ ( ( D44 -' 1 ) |-> ( 0 ) ) ) ^ <* ( C52 |^ D44 ) *> )
proof
set D48 = ( ( <* ( - 1 ) *> ^ ( ( D44 -' 1 ) |-> ( 0 ) ) ) ^ <* ( C52 |^ D44 ) *> );
L606: (for B49 being Nat holds (B49 in ( dom R24 ) implies ( R24 . B49 ) = ( D48 . B49 )))
proof
let C53 being Nat;
assume L607: C53 in ( dom R24 );
L608: C53 in ( Seg ( D44 + 1 ) ) by L607 , L599 , L602 , FINSEQ_1:def 3;
L609: C53 >= 1 by L608 , FINSEQ_1:1;
L610: C53 <= ( D44 + 1 ) by L608 , FINSEQ_1:1;
per cases  by L609 , L610 , XXREAL_0:1;
suppose L611: C53 = 1;

L612: ( R24 . 1 ) = ( ( D47 . 1 ) * ( C52 |^ ( 1 -' 1 ) ) ) by L611 , L603 , L607
.= ( ( D47 . 1 ) * ( C52 |^ ( 0 ) ) ) by XREAL_1:232
.= ( ( D47 . 1 ) * 1 ) by NEWTON:4
.= ( - 1 ) by L600;
L613: ( D48 . 1 ) = ( ( <* ( - 1 ) *> ^ ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* ( C52 |^ D44 ) *> ) ) . 1 ) by FINSEQ_1:32
.= ( R24 . 1 ) by L612 , FINSEQ_1:41;
thus L614: thesis by L613 , L611;
end;
suppose L615: (C53 > 1 & C53 < ( D44 + 1 ));

L616: ( C53 - 1 ) > ( 0 ) by L615 , XREAL_1:50;
reconsider D49 = ( C53 - 1 ) as (Element of ( NAT )) by L616 , INT_1:3;
L617: ( C53 - 1 ) < ( ( D44 + 1 ) - 1 ) by L615 , XREAL_1:9;
L618: D49 <= ( D44 -' 1 ) by L617 , NAT_D:49;
L619: D49 >= ( ( 0 ) + 1 ) by L615 , INT_1:7 , XREAL_1:50;
L620: ( ( ( D44 -' 1 ) |-> ( 0 ) ) . D49 ) = ( 0 );
L621: D49 in ( Seg ( D44 -' 1 ) ) by L618 , L619 , FINSEQ_1:1;
L622: D49 in ( dom ( ( D44 -' 1 ) |-> ( 0 ) ) ) by L621 , L592 , FINSEQ_1:def 3;
L623: D49 in ( dom ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* 1 *> ) ) by L622 , FINSEQ_2:15;
L624: D49 in ( dom ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* ( C52 |^ D44 ) *> ) ) by L622 , FINSEQ_2:15;
L625: ( D47 . C53 ) = ( ( <* ( - 1 ) *> ^ ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* 1 *> ) ) . ( D49 + 1 ) ) by FINSEQ_1:32
.= ( ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* 1 *> ) . D49 ) by L623 , FINSEQ_3:103
.= ( 0 ) by L620 , L622 , FINSEQ_1:def 7;
thus L626: ( D48 . C53 ) = ( ( <* ( - 1 ) *> ^ ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* ( C52 |^ D44 ) *> ) ) . ( D49 + 1 ) ) by FINSEQ_1:32
.= ( ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* ( C52 |^ D44 ) *> ) . D49 ) by L624 , FINSEQ_3:103
.= ( ( D47 . C53 ) * ( C52 |^ ( C53 -' 1 ) ) ) by L620 , L622 , L625 , FINSEQ_1:def 7
.= ( R24 . C53 ) by L603 , L607;
end;
suppose L627: C53 = ( D44 + 1 );

L628: C53 in ( dom D47 ) by L627 , L599 , FINSEQ_5:6;
L629: C53 in ( dom R24 ) by L628 , L602 , FINSEQ_3:29;
L630: ( D47 . C53 ) = 1 by L593 , L627 , FINSEQ_1:42;
thus L631: ( R24 . C53 ) = ( 1 * ( C52 |^ ( ( D44 + 1 ) -' 1 ) ) ) by L630 , L603 , L627 , L629
.= ( C52 |^ D44 ) by NAT_D:34
.= ( D48 . C53 ) by L593 , L627 , FINSEQ_1:42;
end;
end;
L633: ( len D48 ) = ( len ( <* ( - 1 ) *> ^ ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* ( C52 |^ D44 ) *> ) ) ) by FINSEQ_1:32
.= ( 1 + ( len ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* ( C52 |^ D44 ) *> ) ) ) by FINSEQ_5:8
.= ( 1 + ( ( D44 -' 1 ) + 1 ) ) by CARD_1:def 7
.= ( len R24 ) by L589 , L599 , L602 , XREAL_1:235;
L634: ( dom R24 ) = ( dom D48 ) by L633 , FINSEQ_3:29;
thus L635: thesis by L634 , L606 , FINSEQ_1:13;
end;
L636: ( Sum R24 ) = ( Sum ( <* ( - 1 ) *> ^ ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* ( C52 |^ D44 ) *> ) ) ) by L605 , FINSEQ_1:32
.= ( ( - 1 ) + ( Sum ( ( ( D44 -' 1 ) |-> ( 0 ) ) ^ <* ( C52 |^ D44 ) *> ) ) ) by RVSUM_1:76
.= ( ( - 1 ) + ( ( Sum ( ( D44 -' 1 ) |-> ( 0 ) ) ) + ( C52 |^ D44 ) ) ) by RVSUM_1:74
.= ( ( - 1 ) + ( ( ( D44 -' 1 ) * ( 0 ) ) + ( C52 |^ D44 ) ) ) by RVSUM_1:80;
thus L637: thesis by L636 , L604;
end;
consider C54 being (FinSequence of ( NAT )) such that L638: ( len C54 ) = D44 and L639: (for R13 being Nat holds (R13 in ( dom C54 ) implies ( ( C54 . R13 ) gcd R22 ) = 1)) and L640: (for R13 being Nat holds (R13 in ( dom C54 ) implies ( C54 . R13 ) is_quadratic_residue_mod R22)) and L641: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom C54 ) & R14 in ( dom C54 ) & R13 <> R14) implies (not ( C54 . R13 ) , ( C54 . R14 ) are_congruent_mod R22)))) by L554 , L460;
L642: ( D47 . ( D44 + 1 ) ) = 1 by L593 , FINSEQ_1:42;
L643:
now
assume L644: R22 divides ( ( D43 |^ D44 ) - 1 );
L645: ( ( ( D43 |^ D44 ) - 1 ) mod R22 ) = ( 0 ) by L644 , L14;
reconsider D50 = D43 as (Element of ( INT )) by INT_1:def 2;
set D51 = ( C54 ^ <* D50 *> );
L646: <* D50 *> is (FinSequence of ( NAT )) by FINSEQ_1:74;
reconsider D52 = D51 as (FinSequence of ( NAT )) by L646 , FINSEQ_1:75;
L647: ( len D52 ) = ( D44 + 1 ) by L638 , FINSEQ_2:16;
L648: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom D52 ) & R14 in ( dom D52 ) & R13 <> R14) implies (not ( D52 . R13 ) , ( D52 . R14 ) are_congruent_mod R22))))
proof
let R13 being Nat;
let R14 being Nat;
assume that
L649: R13 in ( dom D52 )
and
L650: R14 in ( dom D52 )
and
L651: R13 <> R14;
L652: R14 >= 1 by L650 , FINSEQ_3:25;
L653: R13 <= ( D44 + 1 ) by L647 , L649 , FINSEQ_3:25;
L654: R14 <= ( D44 + 1 ) by L647 , L650 , FINSEQ_3:25;
per cases  by L649 , L653 , FINSEQ_3:25 , XXREAL_0:1;
suppose L655: (R13 >= 1 & R13 < ( D44 + 1 ));

L656: R13 <= D44 by L655 , NAT_1:13;
L657: R13 in ( dom C54 ) by L656 , L638 , L655 , FINSEQ_3:25;
L658: ( D52 . R13 ) = ( C54 . R13 ) by L657 , FINSEQ_1:def 7;
per cases  by L650 , L654 , FINSEQ_3:25 , XXREAL_0:1;
suppose L659: (R14 >= 1 & R14 < ( D44 + 1 ));

L660: R14 <= D44 by L659 , NAT_1:13;
L661: R14 in ( dom C54 ) by L660 , L638 , L659 , FINSEQ_3:25;
L662: (not ( C54 . R13 ) , ( C54 . R14 ) are_congruent_mod R22) by L661 , L641 , L651 , L657;
thus L663: thesis by L662 , L658 , L661 , FINSEQ_1:def 7;
end;
suppose L664: R14 = ( D44 + 1 );

L665: (not ( D52 . R13 ) , D50 are_congruent_mod R22)
proof
L666: ( D52 . R13 ) is_quadratic_residue_mod R22 by L640 , L657 , L658;
consider C55 being Integer such that L667: ( ( ( C55 ^2 ) - ( D52 . R13 ) ) mod R22 ) = ( 0 ) by L666 , L384;
assume L668: ( D52 . R13 ) , D50 are_congruent_mod R22;
L669: R22 divides ( ( D52 . R13 ) - D50 ) by L668 , INT_2:15;
L670: R22 divides ( ( C55 ^2 ) - ( D52 . R13 ) ) by L667 , INT_1:62;
L671: R22 divides ( ( ( C55 ^2 ) - ( D52 . R13 ) ) + ( ( D52 . R13 ) - D50 ) ) by L670 , L669 , WSIERP_1:4;
L672: ( ( ( C55 ^2 ) - D50 ) mod R22 ) = ( 0 ) by L671 , INT_1:62;
thus L673: contradiction by L672 , L556 , L384;
end;
thus L674: thesis by L665 , L638 , L664 , FINSEQ_1:42;
end;
end;
suppose L676: R13 = ( D44 + 1 );

L677: R14 <= D44 by L676 , L651 , L654 , NAT_1:8;
L678: R14 in ( dom C54 ) by L677 , L638 , L652 , FINSEQ_3:25;
L679: ( D52 . R14 ) = ( C54 . R14 ) by L678 , FINSEQ_1:def 7;
L680: ( D52 . R14 ) is_quadratic_residue_mod R22 by L679 , L640 , L678;
consider C56 being Integer such that L681: ( ( ( C56 ^2 ) - ( D52 . R14 ) ) mod R22 ) = ( 0 ) by L680 , L384;
L682: R22 divides ( ( C56 ^2 ) - ( D52 . R14 ) ) by L681 , INT_1:62;
L683: (not D50 , ( D52 . R14 ) are_congruent_mod R22)
proof
assume L684: D50 , ( D52 . R14 ) are_congruent_mod R22;
L685: R22 divides ( D50 - ( D52 . R14 ) ) by L684 , INT_2:15;
L686: R22 divides ( ( ( C56 ^2 ) - ( D52 . R14 ) ) - ( D50 - ( D52 . R14 ) ) ) by L685 , L682 , L1;
L687: ( ( ( C56 ^2 ) - D50 ) mod R22 ) = ( 0 ) by L686 , INT_1:62;
thus L688: contradiction by L687 , L556 , L384;
end;
thus L689: thesis by L683 , L638 , L676 , FINSEQ_1:42;
end;
end;
L691: ( ( ( Poly-INT D47 ) . D50 ) mod R22 ) = ( 0 ) by L601 , L645;
L692: (for R13 being Nat holds (R13 in ( dom D52 ) implies ( ( ( Poly-INT D47 ) . ( D52 . R13 ) ) mod R22 ) = ( 0 )))
proof
let R13 being Nat;
assume L693: R13 in ( dom D52 );
L694: R13 in ( Seg ( D44 + 1 ) ) by L693 , L647 , FINSEQ_1:def 3;
L695: R13 <= ( D44 + 1 ) by L694 , FINSEQ_1:1;
per cases  by L694 , L695 , FINSEQ_1:1 , XXREAL_0:1;
suppose L696: (R13 >= 1 & R13 < ( D44 + 1 ));

reconsider D53 = ( C54 . R13 ) as (Element of ( INT )) by INT_1:def 2;
L697: R13 <= D44 by L696 , NAT_1:13;
L698: R13 in ( dom C54 ) by L697 , L638 , L696 , FINSEQ_3:25;
L699: ( ( C54 . R13 ) gcd R22 ) = 1 by L698 , L639;
L700: ( ( ( C54 . R13 ) |^ D44 ) mod R22 ) = ( 1 mod R22 ) by L699 , L554 , L558 , L640 , L698 , L526;
L701: ( ( ( D53 |^ D44 ) - 1 ) mod R22 ) = ( 0 ) by L700 , INT_4:22;
L702: ( ( ( Poly-INT D47 ) . D53 ) mod R22 ) = ( 0 ) by L701 , L601;
thus L703: thesis by L702 , L698 , FINSEQ_1:def 7;
end;
suppose L704: R13 = ( D44 + 1 );

thus L705: thesis by L704 , L638 , L691 , FINSEQ_1:42;
end;
end;
reconsider D54 = D52 as (FinSequence of ( INT )) by FINSEQ_2:24 , NUMBERS:17;
L707: (not R22 divides ( D47 . ( D44 + 1 ) )) by L557 , L642 , NAT_D:7;
L708: ( len D54 ) <= D44 by L707 , L554 , L599 , L692 , L648 , L275;
thus L709: contradiction by L708 , L647 , XREAL_1:29;
end;
L710: R22 divides ( ( D43 |^ D44 ) + 1 ) by L643 , L568 , L255;
consider C57 being Nat such that L711: ( ( D43 |^ D44 ) + 1 ) = ( R22 * C57 ) by L710 , NAT_D:def 3;
L712: ( - R22 ) < ( - 1 ) by L557 , XREAL_1:24;
L713: ( ( - 1 ) mod R22 ) = ( ( - 1 ) + R22 ) by L712 , NAT_D:63;
L714: ( ( D43 |^ D44 ) mod R22 ) = ( ( ( R22 * C57 ) + ( - 1 ) ) mod R22 ) by L711
.= ( R22 - 1 ) by L713 , NAT_D:61;
thus L715: thesis by L714;
end;
end;
theorem
L717: (for R9 being Integer holds (for R22 being Prime holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & (not R9 is_quadratic_residue_mod R22)) implies ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( R22 - 1 ))))
proof
let R9 being Integer;
let R22 being Prime;
assume that
L718: R22 > 2
and
L719: ( R9 gcd R22 ) = 1
and
L720: (not R9 is_quadratic_residue_mod R22);
set D55 = ( R9 mod R22 );
reconsider D56 = D55 as (Element of ( NAT )) by INT_1:3 , INT_1:57;
L721: ( D56 mod R22 ) = ( R9 mod R22 ) by NAT_D:65;
L722: D56 , R9 are_congruent_mod R22 by L721 , NAT_D:64;
L723: ( D56 gcd R22 ) = 1 by L722 , L719 , INT_4:14;
L724: ( ( D56 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( R22 - 1 ) by L723 , L718 , L720 , L722 , L392 , L553;
thus L725: thesis by L724 , L721 , L421;
end;
theorem
L726: (for R9 being Integer holds (for R22 being Prime holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & R9 is_quadratic_residue_mod R22) implies ( ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) - 1 ) mod R22 ) = ( 0 ))))
proof
let R9 being Integer;
let R22 being Prime;
assume that
L727: R22 > 2
and
L728: ( R9 gcd R22 ) = 1
and
L729: R9 is_quadratic_residue_mod R22;
L730: R22 > 1 by INT_2:def 4;
L731: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = 1 by L727 , L728 , L729 , L526;
L732: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( 1 mod R22 ) by L731 , L730 , NAT_D:14;
L733: ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) , 1 are_congruent_mod R22 by L732 , NAT_D:64;
L734: R22 divides ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) - 1 ) by L733 , INT_2:15;
thus L735: thesis by L734 , INT_1:62;
end;
theorem
L736: (for R9 being Integer holds (for R22 being Prime holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & (not R9 is_quadratic_residue_mod R22)) implies ( ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) + 1 ) mod R22 ) = ( 0 ))))
proof
let R9 being Integer;
let R22 being Prime;
assume that
L737: R22 > 2
and
L738: ( R9 gcd R22 ) = 1
and
L739: (not R9 is_quadratic_residue_mod R22);
L740: ( R22 - 1 ) > ( 2 - 1 ) by L737 , XREAL_1:9;
L741: ( R22 - 1 ) < R22 by XREAL_1:146;
L742: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( R22 - 1 ) by L737 , L738 , L739 , L717;
L743: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( ( R22 - 1 ) mod R22 ) by L742 , L740 , L741 , NAT_D:63;
L744: ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) , ( R22 - 1 ) are_congruent_mod R22 by L743 , NAT_D:64;
L745: R22 divides ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) - ( R22 - 1 ) ) by L744 , INT_2:15;
L746: R22 divides ( - ( ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) + 1 ) - R22 ) ) by L745 , INT_2:10;
L747: R22 divides ( R22 - ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) + 1 ) ) by L746;
L748: R22 divides ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) + 1 ) by L747 , L8;
thus L749: thesis by L748 , INT_1:62;
end;
theorem
L750: (for R9 being Integer holds (for R22 being Prime holds (for R28 being Integer holds ((R9 is_quadratic_residue_mod R22 & R28 is_quadratic_residue_mod R22) implies ( R9 * R28 ) is_quadratic_residue_mod R22))))
proof
let R9 being Integer;
let R22 being Prime;
let R28 being Integer;
assume that
L751: R9 is_quadratic_residue_mod R22
and
L752: R28 is_quadratic_residue_mod R22;
consider C58 being Integer such that L753: ( ( ( C58 ^2 ) - R9 ) mod R22 ) = ( 0 ) by L751 , L384;
consider C59 being Integer such that L754: ( ( ( C59 ^2 ) - R28 ) mod R22 ) = ( 0 ) by L752 , L384;
L755: R22 divides ( ( C59 ^2 ) - R28 ) by L754 , INT_1:62;
L756: ( C59 ^2 ) , R28 are_congruent_mod R22 by L755 , INT_2:15;
L757: R22 divides ( ( C58 ^2 ) - R9 ) by L753 , INT_1:62;
L758: ( C58 ^2 ) , R9 are_congruent_mod R22 by L757 , INT_2:15;
L759: ( ( C58 ^2 ) * ( C59 ^2 ) ) , ( R9 * R28 ) are_congruent_mod R22 by L758 , L756 , INT_1:18;
L760: R22 divides ( ( ( C58 * C59 ) ^2 ) - ( R9 * R28 ) ) by L759 , INT_2:15;
L761: ( ( ( ( C58 * C59 ) ^2 ) - ( R9 * R28 ) ) mod R22 ) = ( 0 ) by L760 , INT_1:62;
thus L762: thesis by L761 , L384;
end;
theorem
L763: (for R9 being Integer holds (for R22 being Prime holds (for R28 being Integer holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & ( R28 gcd R22 ) = 1 & R9 is_quadratic_residue_mod R22 & (not R28 is_quadratic_residue_mod R22)) implies (not ( R9 * R28 ) is_quadratic_residue_mod R22)))))
proof
let R9 being Integer;
let R22 being Prime;
let R28 being Integer;
assume that
L764: R22 > 2
and
L765: ( R9 gcd R22 ) = 1
and
L766: ( R28 gcd R22 ) = 1
and
L767: R9 is_quadratic_residue_mod R22
and
L768: (not R28 is_quadratic_residue_mod R22);
L769: ( ( R9 * R28 ) gcd R22 ) = 1 by L765 , L766 , WSIERP_1:6;
set D57 = ( ( R22 -' 1 ) div 2 );
L770: ( ( ( R28 |^ D57 ) + 1 ) mod R22 ) = ( 0 ) by L764 , L766 , L768 , L736;
L771: R22 divides ( ( R28 |^ D57 ) + 1 ) by L770 , INT_1:62;
L772: ( ( ( R9 |^ D57 ) - 1 ) * ( ( R28 |^ D57 ) + 1 ) ) = ( ( ( ( ( R9 |^ D57 ) * ( R28 |^ D57 ) ) + ( ( R9 |^ D57 ) * 1 ) ) - ( 1 * ( R28 |^ D57 ) ) ) - ( 1 * 1 ) )
.= ( ( ( ( ( R9 * R28 ) |^ D57 ) + ( ( R9 |^ D57 ) * 1 ) ) - ( 1 * ( R28 |^ D57 ) ) ) - ( 1 * 1 ) ) by NEWTON:7
.= ( ( ( ( ( R9 * R28 ) |^ D57 ) - 1 ) + ( ( R9 |^ D57 ) - 1 ) ) - ( ( R28 |^ D57 ) - 1 ) );
L773: ( ( ( R9 |^ D57 ) - 1 ) mod R22 ) = ( 0 ) by L764 , L765 , L767 , L726;
L774: R22 divides ( ( R9 |^ D57 ) - 1 ) by L773 , INT_1:62;
L775: R22 divides ( ( ( R9 |^ D57 ) - 1 ) * ( ( R28 |^ D57 ) + 1 ) ) by L774 , INT_2:2;
assume L776: ( R9 * R28 ) is_quadratic_residue_mod R22;
L777: ( ( ( ( R9 * R28 ) |^ D57 ) - 1 ) mod R22 ) = ( 0 ) by L776 , L764 , L769 , L726;
L778: R22 divides ( ( ( R9 * R28 ) |^ D57 ) - 1 ) by L777 , INT_1:62;
L779: R22 divides ( ( ( ( R9 * R28 ) |^ D57 ) - 1 ) + ( ( R9 |^ D57 ) - 1 ) ) by L778 , L774 , WSIERP_1:4;
L780: R22 divides ( ( R28 |^ D57 ) - 1 ) by L779 , L775 , L772 , L8;
L781: R22 divides ( ( ( R28 |^ D57 ) + 1 ) - ( ( R28 |^ D57 ) - 1 ) ) by L780 , L771 , L1;
thus L782: contradiction by L781 , L764 , NAT_D:7;
end;
theorem
L783: (for R9 being Integer holds (for R22 being Prime holds (for R28 being Integer holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & ( R28 gcd R22 ) = 1 & (not R9 is_quadratic_residue_mod R22) & (not R28 is_quadratic_residue_mod R22)) implies ( R9 * R28 ) is_quadratic_residue_mod R22))))
proof
let R9 being Integer;
let R22 being Prime;
let R28 being Integer;
assume that
L784: R22 > 2
and
L785: ( R9 gcd R22 ) = 1
and
L786: ( R28 gcd R22 ) = 1
and
L787: (not R9 is_quadratic_residue_mod R22)
and
L788: (not R28 is_quadratic_residue_mod R22);
L789: ( ( R9 * R28 ) gcd R22 ) = 1 by L785 , L786 , WSIERP_1:6;
set D58 = ( ( R22 -' 1 ) div 2 );
L790: ( ( ( R28 |^ D58 ) + 1 ) mod R22 ) = ( 0 ) by L784 , L786 , L788 , L736;
L791: R22 divides ( ( R28 |^ D58 ) + 1 ) by L790 , INT_1:62;
L792: ( ( ( R9 |^ D58 ) + 1 ) * ( ( R28 |^ D58 ) + 1 ) ) = ( ( ( ( ( R9 |^ D58 ) * ( R28 |^ D58 ) ) + ( ( R9 |^ D58 ) * 1 ) ) + ( 1 * ( R28 |^ D58 ) ) ) + ( 1 * 1 ) )
.= ( ( ( ( ( R9 * R28 ) |^ D58 ) + ( R9 |^ D58 ) ) + ( R28 |^ D58 ) ) + 1 ) by NEWTON:7
.= ( ( ( ( ( R9 * R28 ) |^ D58 ) + 1 ) + ( ( R9 |^ D58 ) + 1 ) ) - ( 1 - ( R28 |^ D58 ) ) );
L793: ( ( ( R9 |^ D58 ) + 1 ) mod R22 ) = ( 0 ) by L784 , L785 , L787 , L736;
L794: R22 divides ( ( R9 |^ D58 ) + 1 ) by L793 , INT_1:62;
L795: R22 divides ( ( ( R9 |^ D58 ) + 1 ) * ( ( R28 |^ D58 ) + 1 ) ) by L794 , INT_2:2;
L796:
now
assume L797: (not ( R9 * R28 ) is_quadratic_residue_mod R22);
L798: ( ( ( ( R9 * R28 ) |^ D58 ) + 1 ) mod R22 ) = ( 0 ) by L797 , L784 , L789 , L736;
L799: R22 divides ( ( ( R9 * R28 ) |^ D58 ) + 1 ) by L798 , INT_1:62;
L800: R22 divides ( ( ( ( R9 * R28 ) |^ D58 ) + 1 ) + ( ( R9 |^ D58 ) + 1 ) ) by L799 , L794 , WSIERP_1:4;
L801: R22 divides ( 1 - ( R28 |^ D58 ) ) by L800 , L795 , L792 , L8;
L802: R22 divides ( ( ( R28 |^ D58 ) + 1 ) + ( 1 - ( R28 |^ D58 ) ) ) by L801 , L791 , WSIERP_1:4;
thus L803: contradiction by L802 , L784 , NAT_D:7;
end;
thus L804: thesis by L796;
end;
definition
let C60 being Integer;
let C61 being Prime;
func Lege (C60 , C61) -> Integer equals 
:L805: 1 if (C60 is_quadratic_residue_mod C61 & ( C60 mod C61 ) <> ( 0 )) , ( 0 ) if (C60 is_quadratic_residue_mod C61 & ( C60 mod C61 ) = ( 0 )) otherwise ( - 1 );
coherence;
consistency;
end;
theorem
L807: (for R9 being Integer holds (for R22 being Prime holds (( Lege (R9 , R22) ) = 1 or ( Lege (R9 , R22) ) = ( 0 ) or ( Lege (R9 , R22) ) = ( - 1 ))))
proof
let R9 being Integer;
let R22 being Prime;
per cases ;
suppose L808: (R9 is_quadratic_residue_mod R22 & ( R9 mod R22 ) <> ( 0 ));

thus L809: thesis by L808 , L805;
end;
suppose L810: (R9 is_quadratic_residue_mod R22 & ( R9 mod R22 ) = ( 0 ));

thus L811: thesis by L810 , L805;
end;
suppose L812: (not R9 is_quadratic_residue_mod R22);

thus L813: thesis by L812 , L805;
end;
end;
theorem
L815: (for R9 being Integer holds (for R22 being Prime holds (( R9 mod R22 ) <> ( 0 ) implies ( Lege (( R9 ^2 ) , R22) ) = 1)))
proof
let R9 being Integer;
let R22 being Prime;
assume L816: ( R9 mod R22 ) <> ( 0 );
L817: (not R22 divides R9) by L816 , INT_1:62;
L818: (not R22 divides ( R9 ^2 )) by L817 , L255;
L819: ( ( R9 ^2 ) mod R22 ) <> ( 0 ) by L818 , INT_1:62;
L820: ( R9 ^2 ) is_quadratic_residue_mod R22 by L386;
thus L821: thesis by L820 , L805 , L819;
end;
theorem
L822: (for R22 being Prime holds ( Lege (1 , R22) ) = 1)
proof
let R22 being Prime;
L823: 1 < R22 by INT_2:def 4;
L824: ( 1 mod R22 ) <> ( 0 ) by L823 , NAT_D:14;
L825: ( Lege (( 1 ^2 ) , R22) ) = 1 by L824 , L815;
thus L826: thesis by L825;
end;
L827: (for R9 being Integer holds (for R22 being Prime holds (( R9 gcd R22 ) = 1 implies (not R22 divides R9))))
proof
let R9 being Integer;
let R22 being Prime;
assume L828: ( R9 gcd R22 ) = 1;
assume L829: R22 divides R9;
L830: R22 divides ( R22 gcd R9 ) by L829 , INT_2:def 2;
L831: R22 = 1 by L830 , L828 , WSIERP_1:15;
thus L832: thesis by L831 , INT_2:def 4;
end;
theorem
L833: (for R9 being Integer holds (for R22 being Prime holds ((R22 > 2 & ( R9 gcd R22 ) = 1) implies ( Lege (R9 , R22) ) , ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22)))
proof
let R9 being Integer;
let R22 being Prime;
assume that
L834: R22 > 2
and
L835: ( R9 gcd R22 ) = 1;
L836: (not R22 divides R9) by L827 , L835;
L837: ( R9 mod R22 ) <> ( 0 ) by L836 , INT_1:62;
L838: R22 > 1 by INT_2:def 4;
L839: ( - R22 ) < ( - 1 ) by L838 , XREAL_1:24;
L840: ( ( - 1 ) mod R22 ) = ( R22 + ( - 1 ) ) by L839 , NAT_D:63;
per cases ;
suppose L841: R9 is_quadratic_residue_mod R22;

L842: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = 1 by L841 , L834 , L835 , L526;
L843: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( 1 mod R22 ) by L842 , L838 , NAT_D:14;
L844: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( ( Lege (R9 , R22) ) mod R22 ) by L843 , L841 , L805 , L837;
thus L845: thesis by L844 , NAT_D:64;
end;
suppose L846: (not R9 is_quadratic_residue_mod R22);

L847: ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) = ( R22 - 1 ) by L846 , L834 , L835 , L717
.= ( ( Lege (R9 , R22) ) mod R22 ) by L840 , L846 , L805;
thus L848: thesis by L847 , NAT_D:64;
end;
end;
theorem
L850: (for R9 being Integer holds (for R22 being Prime holds (for R28 being Integer holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & R9 , R28 are_congruent_mod R22) implies ( Lege (R9 , R22) ) = ( Lege (R28 , R22) )))))
proof
let R9 being Integer;
let R22 being Prime;
let R28 being Integer;
assume that
L851: R22 > 2
and
L852: ( R9 gcd R22 ) = 1
and
L853: R9 , R28 are_congruent_mod R22;
L854: ( Lege (R9 , R22) ) , ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22 by L851 , L852 , L833;
L855: ( ( Lege (R9 , R22) ) mod R22 ) = ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) by L854 , NAT_D:64;
L856: ( R28 gcd R22 ) = 1 by L852 , L853 , INT_4:14;
L857: ( Lege (R28 , R22) ) , ( R28 |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22 by L856 , L851 , L833;
L858: ( ( Lege (R28 , R22) ) mod R22 ) = ( ( R28 |^ ( ( R22 -' 1 ) div 2 ) ) mod R22 ) by L857 , NAT_D:64;
L859: ( R9 mod R22 ) = ( R28 mod R22 ) by L853 , NAT_D:64;
L860: ( ( Lege (R9 , R22) ) mod R22 ) = ( ( Lege (R28 , R22) ) mod R22 ) by L859 , L855 , L858 , L421;
L861: ( Lege (R9 , R22) ) , ( Lege (R28 , R22) ) are_congruent_mod R22 by L860 , NAT_D:64;
L862: R22 divides ( ( Lege (R9 , R22) ) - ( Lege (R28 , R22) ) ) by L861 , INT_2:15;
per cases  by L807;
suppose L863: ( Lege (R9 , R22) ) = 1;

L864:
now
assume L865: ( Lege (R28 , R22) ) = ( 0 );
L866: R22 = 1 by L865 , L862 , L863 , WSIERP_1:15;
thus L867: contradiction by L866 , L851;
end;
L868: ( Lege (R28 , R22) ) <> ( - 1 ) by L863 , L851 , L862 , NAT_D:7;
thus L869: thesis by L868 , L863 , L864 , L807;
end;
suppose L870: ( Lege (R9 , R22) ) = ( 0 );

L871:
now
assume L872: ( Lege (R28 , R22) ) = 1;
L873: R22 divides 1 by L872 , L862 , L870 , INT_2:10;
L874: R22 = 1 by L873 , WSIERP_1:15;
thus L875: contradiction by L874 , L851;
end;
L876:
now
assume L877: ( Lege (R28 , R22) ) = ( - 1 );
L878: R22 = 1 by L877 , L862 , L870 , WSIERP_1:15;
thus L879: contradiction by L878 , L851;
end;
thus L880: thesis by L876 , L870 , L807 , L871;
end;
suppose L881: ( Lege (R9 , R22) ) = ( - 1 );

L882:
now
assume L883: ( Lege (R28 , R22) ) = 1;
L884: R22 divides ( - 2 ) by L883 , L862 , L881;
L885: R22 divides 2 by L884 , INT_2:10;
thus L886: contradiction by L885 , L851 , NAT_D:7;
end;
L887:
now
assume L888: ( Lege (R28 , R22) ) = ( 0 );
L889: R22 divides 1 by L888 , L862 , L881 , INT_2:10;
L890: R22 = 1 by L889 , WSIERP_1:15;
thus L891: contradiction by L890 , L851;
end;
thus L892: thesis by L887 , L881 , L807 , L882;
end;
end;
theorem
L894: (for R9 being Integer holds (for R22 being Prime holds (for R28 being Integer holds ((R22 > 2 & ( R9 gcd R22 ) = 1 & ( R28 gcd R22 ) = 1) implies ( Lege (( R9 * R28 ) , R22) ) = ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) )))))
proof
let R9 being Integer;
let R22 being Prime;
let R28 being Integer;
assume that
L895: R22 > 2
and
L896: ( R9 gcd R22 ) = 1
and
L897: ( R28 gcd R22 ) = 1;
L898: ( Lege (R28 , R22) ) , ( R28 |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22 by L895 , L897 , L833;
L899: ( Lege (R9 , R22) ) , ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22 by L895 , L896 , L833;
L900: ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) ) , ( ( R9 |^ ( ( R22 -' 1 ) div 2 ) ) * ( R28 |^ ( ( R22 -' 1 ) div 2 ) ) ) are_congruent_mod R22 by L899 , L898 , INT_1:18;
L901: ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) ) , ( ( R9 * R28 ) |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22 by L900 , NEWTON:7;
L902: ( ( R9 * R28 ) |^ ( ( R22 -' 1 ) div 2 ) ) , ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) ) are_congruent_mod R22 by L901 , INT_1:14;
L903: ( ( R9 * R28 ) gcd R22 ) = 1 by L896 , L897 , WSIERP_1:6;
L904: ( Lege (( R9 * R28 ) , R22) ) , ( ( R9 * R28 ) |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22 by L903 , L895 , L833;
L905: ( Lege (( R9 * R28 ) , R22) ) , ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) ) are_congruent_mod R22 by L904 , L902 , INT_1:15;
L906: R22 divides ( ( Lege (( R9 * R28 ) , R22) ) - ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) ) ) by L905 , INT_2:15;
L907: (( Lege (R28 , R22) ) = 1 or ( Lege (R28 , R22) ) = ( - 1 ) or ( Lege (R28 , R22) ) = ( 0 )) by L807;
L908: (( Lege (R9 , R22) ) = 1 or ( Lege (R9 , R22) ) = ( - 1 ) or ( Lege (R9 , R22) ) = ( 0 )) by L807;
per cases  by L807;
suppose L909: ( Lege (( R9 * R28 ) , R22) ) = 1;

L910:
now
assume L911: (( Lege (R9 , R22) ) = ( 0 ) or ( Lege (R28 , R22) ) = ( 0 ));
L912: R22 = 1 by L911 , L906 , L909 , WSIERP_1:15;
thus L913: contradiction by L912 , L895;
end;
thus L914: thesis by L910 , L908 , L907 , L895 , L906 , L909 , NAT_D:7;
end;
suppose L915: ( Lege (( R9 * R28 ) , R22) ) = ( 0 );

L916:
now
assume L917: ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) ) = ( - 1 );
L918: R22 <= 1 by L917 , L906 , L915 , NAT_D:7;
L919: R22 < ( 1 + 1 ) by L918 , NAT_1:13;
thus L920: contradiction by L919 , L895;
end;
L921:
now
assume L922: ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) ) = 1;
L923: R22 divides 1 by L922 , L906 , L915 , INT_2:10;
L924: R22 <= 1 by L923 , NAT_D:7;
L925: R22 < ( 1 + 1 ) by L924 , NAT_1:13;
thus L926: contradiction by L925 , L895;
end;
thus L927: thesis by L921 , L908 , L907 , L916 , L915;
end;
suppose L928: ( Lege (( R9 * R28 ) , R22) ) = ( - 1 );

L929:
now
assume L930: (( Lege (R9 , R22) ) = ( 0 ) or ( Lege (R28 , R22) ) = ( 0 ));
L931: (R22 = 1 or R22 = ( - 1 )) by L930 , L906 , L928 , INT_2:13;
thus L932: contradiction by L931 , INT_2:def 4;
end;
L933:
now
assume L934: ( ( Lege (R9 , R22) ) * ( Lege (R28 , R22) ) ) = 1;
L935: R22 divides ( - 2 ) by L934 , L906 , L928;
L936: R22 divides 2 by L935 , INT_2:10;
thus L937: contradiction by L936 , L895 , NAT_D:7;
end;
thus L938: thesis by L933 , L928 , L929 , L907 , L908;
end;
end;
theorem
L940: (for R24 being (FinSequence of ( INT )) holds ((for R13 being Nat holds (R13 in ( dom R24 ) implies (( R24 . R13 ) = 1 or ( R24 . R13 ) = ( 0 ) or ( R24 . R13 ) = ( - 1 )))) implies (( Product R24 ) = 1 or ( Product R24 ) = ( 0 ) or ( Product R24 ) = ( - 1 ))))
proof
let R24 being (FinSequence of ( INT ));
defpred S6[ (FinSequence of ( INT )) ] means ((for R13 being Nat holds (R13 in ( dom $1 ) implies (( $1 . R13 ) = 1 or ( $1 . R13 ) = ( 0 ) or ( $1 . R13 ) = ( - 1 )))) implies (( Product $1 ) = 1 or ( Product $1 ) = ( 0 ) or ( Product $1 ) = ( - 1 )));
L941: (for B50 being (FinSequence of ( INT )) holds (for B51 being (Element of ( INT )) holds (S6[ B50 ] implies S6[ ( B50 ^ <* B51 *> ) ])))
proof
let C62 being (FinSequence of ( INT ));
let C63 being (Element of ( INT ));
set D59 = ( C62 ^ <* C63 *> );
assume L942: S6[ C62 ];
L943: S6[ D59 ]
proof
assume L944: (for R13 being Nat holds (R13 in ( dom D59 ) implies (( D59 . R13 ) = 1 or ( D59 . R13 ) = ( 0 ) or ( D59 . R13 ) = ( - 1 ))));
L945: (for R13 being Nat holds (R13 in ( dom C62 ) implies (( C62 . R13 ) = 1 or ( C62 . R13 ) = ( 0 ) or ( C62 . R13 ) = ( - 1 ))))
proof
let R13 being Nat;
assume L946: R13 in ( dom C62 );
L947: (( D59 . R13 ) = 1 or ( D59 . R13 ) = ( 0 ) or ( D59 . R13 ) = ( - 1 )) by L946 , L944 , FINSEQ_2:15;
thus L948: thesis by L947 , L946 , FINSEQ_1:def 7;
end;
L949: ( len D59 ) in ( dom D59 ) by FINSEQ_5:6;
L950: ( Product D59 ) = ( ( Product C62 ) * C63 ) by RVSUM_1:96;
L951: ( len D59 ) = ( ( len C62 ) + 1 ) by FINSEQ_2:16;
L952: (( D59 . ( ( len C62 ) + 1 ) ) = 1 or ( D59 . ( ( len C62 ) + 1 ) ) = ( 0 ) or ( D59 . ( ( len C62 ) + 1 ) ) = ( - 1 )) by L951 , L944 , L949;
per cases  by L942 , L945 , L952 , FINSEQ_1:42;
suppose L953: (( Product C62 ) = 1 & C63 = 1);

thus L954: thesis by L953 , L950;
end;
suppose L955: (( Product C62 ) = 1 & C63 = ( 0 ));

thus L956: thesis by L955 , L950;
end;
suppose L957: (( Product C62 ) = 1 & C63 = ( - 1 ));

thus L958: thesis by L957 , L950;
end;
suppose L959: (( Product C62 ) = ( - 1 ) & C63 = 1);

thus L960: thesis by L959 , L950;
end;
suppose L961: (( Product C62 ) = ( - 1 ) & C63 = ( 0 ));

thus L962: thesis by L961 , L950;
end;
suppose L963: (( Product C62 ) = ( - 1 ) & C63 = ( - 1 ));

thus L964: thesis by L963 , L950;
end;
suppose L965: (( Product C62 ) = ( 0 ) & C63 = 1);

thus L966: thesis by L965 , L950;
end;
suppose L967: (( Product C62 ) = ( 0 ) & C63 = ( 0 ));

thus L968: thesis by L967 , L950;
end;
suppose L969: (( Product C62 ) = ( 0 ) & C63 = ( - 1 ));

thus L970: thesis by L969 , L950;
end;
end;
thus L972: thesis by L943;
end;
L973: S6[ ( <*> ( INT ) ) ] by RVSUM_1:94;
L974: (for B52 being (FinSequence of ( INT )) holds S6[ B52 ]) from FINSEQ_2:sch 2(L973 , L941);
thus L975: thesis by L974;
end;
theorem
L976: (for R29 being Integer holds (for R25 being (FinSequence of ( INT )) holds (for R24 being (FinSequence of ( INT )) holds ((( len R25 ) = ( len R24 ) & (for R13 being Nat holds (R13 in ( dom R25 ) implies ( R25 . R13 ) , ( R24 . R13 ) are_congruent_mod R29))) implies ( Product R25 ) , ( Product R24 ) are_congruent_mod R29))))
proof
let R29 being Integer;
defpred S7[ Nat ] means (for R25 being (FinSequence of ( INT )) holds (for R24 being (FinSequence of ( INT )) holds ((( len R25 ) = $1 & ( len R25 ) = ( len R24 ) & (for R13 being Nat holds (R13 in ( dom R25 ) implies ( R25 . R13 ) , ( R24 . R13 ) are_congruent_mod R29))) implies ( Product R25 ) , ( Product R24 ) are_congruent_mod R29)));
L977: (for B53 being (Element of ( NAT )) holds (S7[ B53 ] implies S7[ ( B53 + 1 ) ]))
proof
let C64 being (Element of ( NAT ));
assume L978: S7[ C64 ];
L979: S7[ ( C64 + 1 ) ]
proof
let R25 being (FinSequence of ( INT ));
let R24 being (FinSequence of ( INT ));
assume that
L980: ( len R25 ) = ( C64 + 1 )
and
L981: ( len R25 ) = ( len R24 )
and
L982: (for R13 being Nat holds (R13 in ( dom R25 ) implies ( R25 . R13 ) , ( R24 . R13 ) are_congruent_mod R29));
consider C65 being (FinSequence of ( INT )), C66 being (Element of ( INT )) such that L983: R24 = ( C65 ^ <* C66 *> ) by L980 , L981 , FINSEQ_2:19;
L984: R25 <> ( {} ) by L980;
L985: ( C64 + 1 ) in ( dom R25 ) by L984 , L980 , FINSEQ_5:6;
consider C67 being (FinSequence of ( INT )), C68 being (Element of ( INT )) such that L986: R25 = ( C67 ^ <* C68 *> ) by L980 , FINSEQ_2:19;
L987: ( C64 + 1 ) = ( ( len C65 ) + 1 ) by L980 , L981 , L983 , FINSEQ_2:16;
L988: ( R24 . ( C64 + 1 ) ) = C66 by L987 , L983 , FINSEQ_1:42;
L989: ( C64 + 1 ) = ( ( len C67 ) + 1 ) by L980 , L986 , FINSEQ_2:16;
L990: ( dom C67 ) = ( dom C65 ) by L989 , L987 , FINSEQ_3:29;
L991: (for R13 being Nat holds (R13 in ( dom C67 ) implies ( C67 . R13 ) , ( C65 . R13 ) are_congruent_mod R29))
proof
let R13 being Nat;
assume L992: R13 in ( dom C67 );
L993: ( R25 . R13 ) = ( C67 . R13 ) by L992 , L986 , FINSEQ_1:def 7;
L994: ( R24 . R13 ) = ( C65 . R13 ) by L983 , L990 , L992 , FINSEQ_1:def 7;
thus L995: thesis by L994 , L982 , L986 , L992 , L993 , FINSEQ_2:15;
end;
L996: ( Product C67 ) , ( Product C65 ) are_congruent_mod R29 by L991 , L978 , L989 , L987;
L997: ( R25 . ( C64 + 1 ) ) = C68 by L986 , L989 , FINSEQ_1:42;
L998: C68 , C66 are_congruent_mod R29 by L997 , L982 , L985 , L988;
L999: ( ( Product C67 ) * C68 ) , ( ( Product C65 ) * C66 ) are_congruent_mod R29 by L998 , L996 , INT_1:18;
L1000: ( Product R25 ) , ( ( Product C65 ) * C66 ) are_congruent_mod R29 by L999 , L986 , RVSUM_1:96;
thus L1001: thesis by L1000 , L983 , RVSUM_1:96;
end;
thus L1002: thesis by L979;
end;
L1003: S7[ ( 0 ) ]
proof
let R25 being (FinSequence of ( INT ));
let R24 being (FinSequence of ( INT ));
assume that
L1004: ( len R25 ) = ( 0 )
and
L1005: ( len R25 ) = ( len R24 );
L1006: R25 = ( <*> ( INT ) ) by L1004;
L1007: R24 = ( <*> ( INT ) ) by L1004 , L1005;
thus L1008: thesis by L1007 , L1006 , INT_1:11;
end;
L1009: (for B54 being (Element of ( NAT )) holds S7[ B54 ]) from NAT_1:sch 1(L1003 , L977);
thus L1010: thesis by L1009;
end;
theorem
L1011: (for R29 being Integer holds (for R25 being (FinSequence of ( INT )) holds (for R24 being (FinSequence of ( INT )) holds ((( len R25 ) = ( len R24 ) & (for R13 being Nat holds (R13 in ( dom R25 ) implies ( R25 . R13 ) , ( - ( R24 . R13 ) ) are_congruent_mod R29))) implies ( Product R25 ) , ( ( ( - 1 ) |^ ( len R25 ) ) * ( Product R24 ) ) are_congruent_mod R29))))
proof
let R29 being Integer;
defpred S8[ Nat ] means (for R25 being (FinSequence of ( INT )) holds (for R24 being (FinSequence of ( INT )) holds ((( len R25 ) = $1 & ( len R25 ) = ( len R24 ) & (for R13 being Nat holds (R13 in ( dom R25 ) implies ( R25 . R13 ) , ( - ( R24 . R13 ) ) are_congruent_mod R29))) implies ( Product R25 ) , ( ( ( - 1 ) |^ ( len R25 ) ) * ( Product R24 ) ) are_congruent_mod R29)));
L1012: (for B55 being (Element of ( NAT )) holds (S8[ B55 ] implies S8[ ( B55 + 1 ) ]))
proof
let C69 being (Element of ( NAT ));
assume L1013: S8[ C69 ];
L1014: S8[ ( C69 + 1 ) ]
proof
let R25 being (FinSequence of ( INT ));
let R24 being (FinSequence of ( INT ));
assume that
L1015: ( len R25 ) = ( C69 + 1 )
and
L1016: ( len R25 ) = ( len R24 )
and
L1017: (for R13 being Nat holds (R13 in ( dom R25 ) implies ( R25 . R13 ) , ( - ( R24 . R13 ) ) are_congruent_mod R29));
consider C70 being (FinSequence of ( INT )), C71 being (Element of ( INT )) such that L1018: R24 = ( C70 ^ <* C71 *> ) by L1015 , L1016 , FINSEQ_2:19;
L1019: R25 <> ( {} ) by L1015;
L1020: ( C69 + 1 ) in ( dom R25 ) by L1019 , L1015 , FINSEQ_5:6;
consider C72 being (FinSequence of ( INT )), C73 being (Element of ( INT )) such that L1021: R25 = ( C72 ^ <* C73 *> ) by L1015 , FINSEQ_2:19;
L1022: ( C69 + 1 ) = ( ( len C70 ) + 1 ) by L1015 , L1016 , L1018 , FINSEQ_2:16;
L1023: ( R24 . ( C69 + 1 ) ) = C71 by L1022 , L1018 , FINSEQ_1:42;
L1024: ( C69 + 1 ) = ( ( len C72 ) + 1 ) by L1015 , L1021 , FINSEQ_2:16;
L1025: ( dom C72 ) = ( dom C70 ) by L1024 , L1022 , FINSEQ_3:29;
L1026: (for R13 being Nat holds (R13 in ( dom C72 ) implies ( C72 . R13 ) , ( - ( C70 . R13 ) ) are_congruent_mod R29))
proof
let R13 being Nat;
assume L1027: R13 in ( dom C72 );
L1028: ( R25 . R13 ) = ( C72 . R13 ) by L1027 , L1021 , FINSEQ_1:def 7;
L1029: ( R24 . R13 ) = ( C70 . R13 ) by L1018 , L1025 , L1027 , FINSEQ_1:def 7;
thus L1030: thesis by L1029 , L1017 , L1021 , L1027 , L1028 , FINSEQ_2:15;
end;
L1031: ( Product C72 ) , ( ( ( - 1 ) |^ ( len C72 ) ) * ( Product C70 ) ) are_congruent_mod R29 by L1026 , L1013 , L1024 , L1022;
L1032: ( R25 . ( C69 + 1 ) ) = C73 by L1021 , L1024 , FINSEQ_1:42;
L1033: C73 , ( - C71 ) are_congruent_mod R29 by L1032 , L1017 , L1020 , L1023;
L1034: ( ( Product C72 ) * C73 ) , ( ( ( ( - 1 ) |^ ( len C72 ) ) * ( Product C70 ) ) * ( - C71 ) ) are_congruent_mod R29 by L1033 , L1031 , INT_1:18;
L1035: ( Product R25 ) , ( ( ( ( - 1 ) |^ ( len C72 ) ) * ( - 1 ) ) * ( ( Product C70 ) * C71 ) ) are_congruent_mod R29 by L1034 , L1021 , RVSUM_1:96;
L1036: ( Product R25 ) , ( ( ( - 1 ) |^ ( ( len C72 ) + 1 ) ) * ( ( Product C70 ) * C71 ) ) are_congruent_mod R29 by L1035 , NEWTON:6;
thus L1037: thesis by L1036 , L1015 , L1018 , L1024 , RVSUM_1:96;
end;
thus L1038: thesis by L1014;
end;
L1039: S8[ ( 0 ) ]
proof
let R25 being (FinSequence of ( INT ));
let R24 being (FinSequence of ( INT ));
assume that
L1040: ( len R25 ) = ( 0 )
and
L1041: ( len R25 ) = ( len R24 );
L1042: R25 = ( <*> ( INT ) ) by L1040;
L1043: ( ( - 1 ) |^ ( len R25 ) ) = 1 by L1040 , NEWTON:4;
L1044: R24 = ( <*> ( INT ) ) by L1040 , L1041;
thus L1045: thesis by L1044 , L1042 , L1043 , INT_1:11;
end;
L1046: (for B56 being (Element of ( NAT )) holds S8[ B56 ]) from NAT_1:sch 1(L1039 , L1012);
thus L1047: thesis by L1046;
end;
theorem
L1048: (for R22 being Prime holds (for R30 being (FinSequence of ( NAT )) holds ((R22 > 2 & (for R13 being Nat holds (R13 in ( dom R30 ) implies ( ( R30 . R13 ) gcd R22 ) = 1))) implies (ex B57 being (FinSequence of ( INT )) st (( len B57 ) = ( len R30 ) & (for R13 being Nat holds (R13 in ( dom B57 ) implies ( B57 . R13 ) = ( Lege (( R30 . R13 ) , R22) ))) & ( Lege (( Product R30 ) , R22) ) = ( Product B57 ))))))
proof
let R22 being Prime;
let R30 being (FinSequence of ( NAT ));
assume L1049: R22 > 2;
deffunc H5(Nat) = ( Lege (( R30 . $1 ) , R22) );
set D60 = ( ( R22 -' 1 ) div 2 );
assume L1050: (for R13 being Nat holds (R13 in ( dom R30 ) implies ( ( R30 . R13 ) gcd R22 ) = 1));
set D61 = ( R30 |^ D60 );
reconsider D62 = D61 as (FinSequence of ( INT )) by FINSEQ_2:24 , NUMBERS:17;
consider C74 being FinSequence such that L1051: (( len C74 ) = ( len R30 ) & (for B58 being Nat holds (B58 in ( dom C74 ) implies ( C74 . B58 ) = H5(B58)))) from FINSEQ_1:sch 2;
L1052: (for B59 being Nat holds (B59 in ( dom C74 ) implies ( C74 . B59 ) in ( INT )))
proof
let C75 being Nat;
assume L1053: C75 in ( dom C74 );
L1054: ( C74 . C75 ) = ( Lege (( R30 . C75 ) , R22) ) by L1053 , L1051;
thus L1055: thesis by L1054 , INT_1:def 2;
end;
reconsider D63 = C74 as (FinSequence of ( INT )) by L1052 , FINSEQ_2:12;
L1056: R30 is (FinSequence of ( REAL )) by FINSEQ_2:24;
L1057: ( len D62 ) = ( len R30 ) by NAT_3:def 1;
L1058: (for R13 being Nat holds (R13 in ( dom D63 ) implies ( D63 . R13 ) , ( D62 . R13 ) are_congruent_mod R22))
proof
let R13 being Nat;
assume L1059: R13 in ( dom D63 );
L1060: R13 in ( dom R30 ) by L1059 , L1051 , FINSEQ_3:29;
L1061: ( ( R30 . R13 ) gcd R22 ) = 1 by L1060 , L1050;
L1062: ( Lege (( R30 . R13 ) , R22) ) , ( ( R30 . R13 ) |^ D60 ) are_congruent_mod R22 by L1061 , L1049 , L833;
L1063: ( D63 . R13 ) , ( ( R30 . R13 ) |^ D60 ) are_congruent_mod R22 by L1062 , L1051 , L1059;
L1064: R13 in ( dom D62 ) by L1051 , L1057 , L1059 , FINSEQ_3:29;
thus L1065: thesis by L1064 , L1063 , NAT_3:def 1;
end;
L1066: ( Product D62 ) , ( Product D63 ) are_congruent_mod R22 by L1058 , L1051 , L1057 , L976 , INT_1:14;
L1067: ( ( Product R30 ) gcd R22 ) = 1 by L1050 , WSIERP_1:36;
L1068: ( Lege (( Product R30 ) , R22) ) , ( ( Product R30 ) |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22 by L1067 , L1049 , L833;
L1069: ( Lege (( Product R30 ) , R22) ) , ( Product D62 ) are_congruent_mod R22 by L1068 , L1056 , NAT_3:15;
L1070: ( Lege (( Product R30 ) , R22) ) , ( Product D63 ) are_congruent_mod R22 by L1069 , L1066 , INT_1:15;
L1071: R22 divides ( ( Lege (( Product R30 ) , R22) ) - ( Product D63 ) ) by L1070 , INT_2:15;
take D63;
L1072: (for R13 being Nat holds (R13 in ( dom D63 ) implies (( D63 . R13 ) = 1 or ( D63 . R13 ) = ( 0 ) or ( D63 . R13 ) = ( - 1 ))))
proof
let R13 being Nat;
assume L1073: R13 in ( dom D63 );
L1074: ( D63 . R13 ) = ( Lege (( R30 . R13 ) , R22) ) by L1073 , L1051;
thus L1075: thesis by L1074 , L807;
end;
per cases  by L807;
suppose L1076: ( Lege (( Product R30 ) , R22) ) = 1;

L1077: ( Product D63 ) <> ( - 1 ) by L1076 , L1049 , L1071 , NAT_D:7;
L1078:
now
assume L1079: ( Product D63 ) = ( 0 );
L1080: R22 = 1 by L1079 , L1071 , L1076 , WSIERP_1:15;
thus L1081: contradiction by L1080 , L1049;
end;
thus L1082: thesis by L1078 , L1051 , L1072 , L1076 , L940 , L1077;
end;
suppose L1083: ( Lege (( Product R30 ) , R22) ) = ( 0 );

L1084:
now
assume L1085: ( Product D63 ) = ( - 1 );
L1086: R22 = 1 by L1085 , L1071 , L1083 , WSIERP_1:15;
thus L1087: contradiction by L1086 , L1049;
end;
L1088:
now
assume L1089: ( Product D63 ) = 1;
L1090: R22 divides 1 by L1089 , L1071 , L1083 , INT_2:10;
L1091: R22 = 1 by L1090 , WSIERP_1:15;
thus L1092: contradiction by L1091 , L1049;
end;
thus L1093: thesis by L1088 , L1051 , L1072 , L1083 , L940 , L1084;
end;
suppose L1094: ( Lege (( Product R30 ) , R22) ) = ( - 1 );

L1095:
now
assume L1096: ( Product D63 ) = 1;
L1097: R22 divides ( - 2 ) by L1096 , L1071 , L1094;
L1098: R22 divides 2 by L1097 , INT_2:10;
thus L1099: contradiction by L1098 , L1049 , NAT_D:7;
end;
L1100:
now
assume L1101: ( Product D63 ) = ( 0 );
L1102: R22 divides 1 by L1101 , L1071 , L1094 , INT_2:10;
L1103: R22 = 1 by L1102 , WSIERP_1:15;
thus L1104: contradiction by L1103 , L1049;
end;
thus L1105: thesis by L1100 , L1051 , L1072 , L1094 , L940 , L1095;
end;
end;
theorem
L1107: (for R13 being Nat holds (for R14 being Nat holds (for R22 being Prime holds ((R22 > 2 & ( R13 gcd R22 ) = 1 & ( R14 gcd R22 ) = 1) implies ( Lege (( ( R13 ^2 ) * R14 ) , R22) ) = ( Lege (R14 , R22) )))))
proof
let R13 being Nat;
let R14 being Nat;
let R22 being Prime;
assume that
L1108: R22 > 2
and
L1109: ( R13 gcd R22 ) = 1
and
L1110: ( R14 gcd R22 ) = 1;
reconsider D64 = ( R13 ^2 ) , D65 = R14 as (Element of ( NAT )) by ORDINAL1:def 12;
set D66 = <* D64 , D65 *>;
reconsider D67 = D66 as (FinSequence of ( NAT )) by FINSEQ_2:13;
L1111: (not R22 divides R13) by L1109 , L827;
L1112: ( R13 mod R22 ) <> ( 0 ) by L1111 , INT_1:62;
L1113: ( Lege (( R13 ^2 ) , R22) ) = 1 by L1112 , L815;
reconsider D68 = R22 as  prime (Element of ( NAT )) by ORDINAL1:def 12;
L1114: (for R15 being Nat holds (R15 in ( dom D67 ) implies ( ( D67 . R15 ) gcd D68 ) = 1))
proof
let R15 being Nat;
assume L1115: R15 in ( dom D67 );
L1116: R15 in ( Seg ( len D67 ) ) by L1115 , FINSEQ_1:def 3;
L1117: R15 in ( Seg 2 ) by L1116 , FINSEQ_1:44;
per cases  by L1117 , FINSEQ_1:2 , TARSKI:def 2;
suppose L1118: R15 = 1;

L1119: ( D67 . R15 ) = ( R13 ^2 ) by L1118 , FINSEQ_1:44;
thus L1120: thesis by L1119 , L1109 , WSIERP_1:7;
end;
suppose L1121: R15 = 2;

thus L1122: thesis by L1121 , L1110 , FINSEQ_1:44;
end;
end;
consider C76 being (FinSequence of ( INT )) such that L1124: ( len C76 ) = ( len D67 ) and L1125: (for B60 being Nat holds (B60 in ( dom C76 ) implies ( C76 . B60 ) = ( Lege (( D67 . B60 ) , D68) ))) and L1126: ( Lege (( Product D67 ) , D68) ) = ( Product C76 ) by L1114 , L1108 , L1048;
L1127: ( len C76 ) = 2 by L1124 , FINSEQ_1:44;
L1128: 2 in ( dom C76 ) by L1127 , FINSEQ_3:25;
L1129: ( C76 . 2 ) = ( Lege (( D67 . 2 ) , D68) ) by L1128 , L1125;
L1130: ( C76 . 2 ) = ( Lege (D65 , D68) ) by L1129 , FINSEQ_1:44;
L1131: 1 in ( dom C76 ) by L1127 , FINSEQ_3:25;
L1132: ( C76 . 1 ) = ( Lege (( D67 . 1 ) , D68) ) by L1131 , L1125;
L1133: ( C76 . 1 ) = ( Lege (( R13 ^2 ) , D68) ) by L1132 , FINSEQ_1:44;
L1134: C76 = <* 1 , ( Lege (D65 , D68) ) *> by L1133 , L1113 , L1127 , L1130 , FINSEQ_1:44;
L1135: ( Product C76 ) = ( 1 * ( Lege (D65 , D68) ) ) by L1134 , RVSUM_1:99;
thus L1136: thesis by L1135 , L1126 , RVSUM_1:99;
end;
theorem
L1137: (for R22 being Prime holds (R22 > 2 implies ( Lege (( - 1 ) , R22) ) = ( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) )))
proof
let R22 being Prime;
assume L1138: R22 > 2;
L1139: ( abs ( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) ) ) = 1 by SERIES_2:1;
L1140: (( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) ) = 1 or ( - ( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) ) ) = 1) by L1139 , ABSVALUE:1;
L1141: ( ( - 1 ) gcd R22 ) = ( ( ( - 1 ) |^ 1 ) gcd R22 ) by NEWTON:5
.= ( ( abs ( ( - 1 ) |^ 1 ) ) gcd ( abs R22 ) ) by INT_2:34
.= ( 1 gcd ( abs R22 ) ) by SERIES_2:1
.= 1 by NEWTON:51;
L1142: ( Lege (( - 1 ) , R22) ) , ( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) ) are_congruent_mod R22 by L1141 , L1138 , L833;
per cases  by L1140;
suppose L1143: ( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) ) = 1;

L1144: R22 divides ( ( Lege (( - 1 ) , R22) ) - 1 ) by L1143 , L1142 , INT_2:15;
L1145:
now
assume L1146: ( Lege (( - 1 ) , R22) ) = ( - 1 );
L1147: R22 divides ( - 2 ) by L1146 , L1144;
L1148: R22 divides 2 by L1147 , INT_2:10;
thus L1149: contradiction by L1148 , L1138 , NAT_D:7;
end;
L1150:
now
assume L1151: ( Lege (( - 1 ) , R22) ) = ( 0 );
L1152: R22 divides 1 by L1151 , L1144 , INT_2:10;
L1153: R22 <= 1 by L1152 , NAT_D:7;
L1154: R22 < ( 1 + 1 ) by L1153 , NAT_1:13;
thus L1155: contradiction by L1154 , L1138;
end;
thus L1156: thesis by L1150 , L1143 , L807 , L1145;
end;
suppose L1157: ( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) ) = ( - 1 );

L1158: R22 divides ( ( Lege (( - 1 ) , R22) ) - ( - 1 ) ) by L1157 , L1142 , INT_2:15;
L1159: ( Lege (( - 1 ) , R22) ) <> 1 by L1158 , L1138 , NAT_D:7;
L1160:
now
assume L1161: ( Lege (( - 1 ) , R22) ) = ( 0 );
L1162: R22 <= 1 by L1161 , L1158 , NAT_D:7;
L1163: R22 < ( 1 + 1 ) by L1162 , NAT_1:13;
thus L1164: contradiction by L1163 , L1138;
end;
thus L1165: thesis by L1160 , L1157 , L807 , L1159;
end;
end;
theorem
L1167: (for R22 being Prime holds ((R22 > 2 & ( R22 mod 4 ) = 1) implies ( - 1 ) is_quadratic_residue_mod R22))
proof
let R22 being Prime;
assume that
L1168: R22 > 2
and
L1169: ( R22 mod 4 ) = 1;
L1170: R22 > 1 by INT_2:def 4;
L1171: ( R22 -' 1 ) = ( R22 - 1 ) by L1170 , XREAL_1:233;
L1172: R22 = ( ( ( R22 div 4 ) * 4 ) + 1 ) by L1169 , NAT_D:2;
L1173: ( R22 -' 1 ) = ( 2 * ( 2 * ( R22 div 4 ) ) ) by L1172 , L1171;
L1174: ( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) ) = ( ( - 1 ) |^ ( 2 * ( R22 div 4 ) ) ) by L1173 , NAT_D:18
.= ( ( ( - 1 ) |^ 2 ) |^ ( R22 div 4 ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( R22 div 4 ) ) by WSIERP_1:1
.= ( ( 1 ^2 ) |^ ( R22 div 4 ) ) by NEWTON:81
.= 1 by NEWTON:10;
L1175: ( Lege (( - 1 ) , R22) ) = 1 by L1174 , L1168 , L1137;
thus L1176: thesis by L1175 , L805;
end;
theorem
L1177: (for R22 being Prime holds ((R22 > 2 & ( R22 mod 4 ) = 3) implies (not ( - 1 ) is_quadratic_residue_mod R22)))
proof
let R22 being Prime;
assume that
L1178: R22 > 2
and
L1179: ( R22 mod 4 ) = 3;
L1180: R22 > 1 by INT_2:def 4;
L1181: ( R22 -' 1 ) = ( R22 - 1 ) by L1180 , XREAL_1:233;
L1182: R22 = ( ( ( R22 div 4 ) * 4 ) + 3 ) by L1179 , NAT_D:2;
L1183: ( R22 -' 1 ) = ( 2 * ( ( 2 * ( R22 div 4 ) ) + 1 ) ) by L1182 , L1181;
L1184: ( ( - 1 ) |^ ( ( R22 -' 1 ) div 2 ) ) = ( ( - 1 ) |^ ( ( 2 * ( R22 div 4 ) ) + 1 ) ) by L1183 , NAT_D:18
.= ( ( ( - 1 ) |^ ( 2 * ( R22 div 4 ) ) ) * ( - 1 ) ) by NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( R22 div 4 ) ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( R22 div 4 ) ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( ( 1 ^2 ) |^ ( R22 div 4 ) ) * ( - 1 ) ) by NEWTON:81
.= ( 1 * ( - 1 ) ) by NEWTON:10;
L1185: ( Lege (( - 1 ) , R22) ) = ( - 1 ) by L1184 , L1178 , L1137;
L1186: ((not (( - 1 ) is_quadratic_residue_mod R22 & ( ( - 1 ) mod R22 ) <> ( 0 ))) & (not (( - 1 ) is_quadratic_residue_mod R22 & ( ( - 1 ) mod R22 ) = ( 0 )))) by L1185 , L805;
thus L1187: thesis by L1186;
end;
begin
theorem
L1188: (for B61 being non  empty set holds (for B62 being (FinSequence of B61) holds (for B63 , B64 being Nat holds (B62 is  one-to-one iff ( Swap (B62 , B63 , B64) ) is  one-to-one))))
proof
let C77 being non  empty set;
let C78 being (FinSequence of C77);
let C79 , C80 being Nat;
thus L1189: (C78 is  one-to-one implies ( Swap (C78 , C79 , C80) ) is  one-to-one)
proof
set D69 = ( Swap (C78 , C79 , C80) );
L1190: ( rng D69 ) = ( rng C78 ) by FINSEQ_7:22;
assume L1191: C78 is  one-to-one;
L1192: ( card ( rng C78 ) ) = ( len C78 ) by L1191 , FINSEQ_4:62;
L1193: ( len D69 ) = ( len C78 ) by FINSEQ_7:18;
thus L1194: thesis by L1193 , L1192 , L1190 , FINSEQ_4:62;
end;

assume L1195: ( Swap (C78 , C79 , C80) ) is  one-to-one;
L1196: ( card ( rng ( Swap (C78 , C79 , C80) ) ) ) = ( len ( Swap (C78 , C79 , C80) ) ) by L1195 , FINSEQ_4:62;
L1197: ( card ( rng C78 ) ) = ( len ( Swap (C78 , C79 , C80) ) ) by L1196 , FINSEQ_7:22;
L1198: ( card ( rng C78 ) ) = ( len C78 ) by L1197 , FINSEQ_7:18;
thus L1199: thesis by L1198 , FINSEQ_4:62;
end;
theorem
L1200: (for R16 being Nat holds (for B65 being (FinSequence of ( NAT )) holds ((( len B65 ) = R16 & (for R13 being Nat holds (R13 in ( dom B65 ) implies (( B65 . R13 ) > ( 0 ) & ( B65 . R13 ) <= R16))) & B65 is  one-to-one) implies ( rng B65 ) = ( Seg R16 ))))
proof
let R16 being Nat;
defpred S9[ Nat ] means (for B66 being (FinSequence of ( NAT )) holds ((( len B66 ) = $1 & (for R13 being Nat holds (R13 in ( dom B66 ) implies (( B66 . R13 ) > ( 0 ) & ( B66 . R13 ) <= $1))) & B66 is  one-to-one) implies ( rng B66 ) = ( Seg $1 )));
L1201: (for B67 being (Element of ( NAT )) holds (S9[ B67 ] implies S9[ ( B67 + 1 ) ]))
proof
let C81 being (Element of ( NAT ));
assume L1202: S9[ C81 ];
L1203: S9[ ( C81 + 1 ) ]
proof
let C82 being (FinSequence of ( NAT ));
assume that
L1204: ( len C82 ) = ( C81 + 1 )
and
L1205: (for R13 being Nat holds (R13 in ( dom C82 ) implies (( C82 . R13 ) > ( 0 ) & ( C82 . R13 ) <= ( C81 + 1 ))))
and
L1206: C82 is  one-to-one;
L1207: C82 <> ( {} ) by L1204;
L1208: ( C81 + 1 ) in ( dom C82 ) by L1207 , L1204 , FINSEQ_5:6;
L1209: ( C82 . ( C81 + 1 ) ) > ( 0 ) by L1208 , L1205;
consider C83 being (FinSequence of ( NAT )), C84 being (Element of ( NAT )) such that L1210: C82 = ( C83 ^ <* C84 *> ) by L1207 , HILBERT2:4;
L1211: C83 is  one-to-one by L1206 , L1210 , FINSEQ_3:91;
L1212: ( len C82 ) = ( ( len C83 ) + 1 ) by L1210 , FINSEQ_2:16;
L1213: ( C82 . ( C81 + 1 ) ) <= ( C81 + 1 ) by L1205 , L1208;
L1214: C84 <= ( C81 + 1 ) by L1213 , L1204 , L1210 , L1212 , FINSEQ_1:42;
per cases  by L1204 , L1210 , L1212 , L1209 , L1214 , FINSEQ_1:42 , XXREAL_0:1;
suppose L1215: C84 = ( C81 + 1 );

L1216: (for R13 being Nat holds (R13 in ( dom C83 ) implies (( C83 . R13 ) > ( 0 ) & ( C83 . R13 ) <= C81)))
proof
let R13 being Nat;
assume L1217: R13 in ( dom C83 );
L1218: R13 in ( dom C82 ) by L1217 , L1210 , FINSEQ_2:15;
L1219:
now
L1220: R13 <= C81 by L1204 , L1212 , L1217 , FINSEQ_3:25;
L1221: R13 < ( C81 + 1 ) by L1220 , XREAL_1:145;
L1222: ( C82 . R13 ) <> ( C82 . ( C81 + 1 ) ) by L1221 , L1206 , L1208 , L1218 , FUNCT_1:def 4;
L1223: ( C83 . R13 ) <> ( C82 . ( C81 + 1 ) ) by L1222 , L1210 , L1217 , FINSEQ_1:def 7;
assume L1224: ( C83 . R13 ) = ( C81 + 1 );
thus L1225: contradiction by L1224 , L1204 , L1210 , L1212 , L1215 , L1223 , FINSEQ_1:42;
end;
L1226: ( C82 . R13 ) <= ( C81 + 1 ) by L1205 , L1218;
L1227: ( C83 . R13 ) <= ( C81 + 1 ) by L1226 , L1210 , L1217 , FINSEQ_1:def 7;
L1228: ( C83 . R13 ) < ( C81 + 1 ) by L1227 , L1219 , XXREAL_0:1;
L1229: ( C82 . R13 ) > ( 0 ) by L1205 , L1218;
thus L1230: thesis by L1229 , L1210 , L1217 , L1228 , FINSEQ_1:def 7 , NAT_1:13;
end;
L1231: ( rng C83 ) = ( Seg C81 ) by L1216 , L1202 , L1204 , L1212 , L1211;
L1232: ( ( rng C83 ) \/ { C84 } ) = ( Seg ( C81 + 1 ) ) by L1231 , L1215 , FINSEQ_1:9;
L1233: ( ( rng C83 ) \/ ( rng <* C84 *> ) ) = ( Seg ( C81 + 1 ) ) by L1232 , FINSEQ_1:38;
thus L1234: thesis by L1233 , L1210 , FINSEQ_1:31;
end;
suppose L1235: (C84 > ( 0 ) & C84 < ( C81 + 1 ));

L1236: (ex R13 being Nat st (R13 in ( dom C83 ) & ( C83 . R13 ) = ( C81 + 1 )))
proof
assume L1237: (for R13 being Nat holds (R13 in ( dom C83 ) implies ( C83 . R13 ) <> ( C81 + 1 )));
L1238: (for B68 being Nat holds (B68 in ( dom C82 ) implies ( C82 . B68 ) in ( Seg C81 )))
proof
let C85 being Nat;
assume L1239: C85 in ( dom C82 );
L1240: C85 in ( Seg ( C81 + 1 ) ) by L1239 , L1204 , FINSEQ_1:def 3;
L1241: C85 <= ( C81 + 1 ) by L1240 , FINSEQ_1:1;
per cases  by L1240 , L1241 , FINSEQ_1:1 , XXREAL_0:1;
suppose L1242: C85 = ( C81 + 1 );

L1243: ( C82 . C85 ) = C84 by L1242 , L1204 , L1210 , L1212 , FINSEQ_1:42;
L1244: ( C82 . C85 ) <= C81 by L1243 , L1235 , NAT_1:13;
L1245: ( C82 . C85 ) >= ( ( 0 ) + 1 ) by L1235 , L1243 , NAT_1:13;
thus L1246: thesis by L1245 , L1244 , FINSEQ_1:1;
end;
suppose L1247: (C85 >= 1 & C85 < ( C81 + 1 ));

L1248: C85 <= C81 by L1247 , NAT_1:13;
L1249: C85 in ( Seg C81 ) by L1248 , L1247 , FINSEQ_1:1;
L1250: C85 in ( dom C83 ) by L1249 , L1204 , L1212 , FINSEQ_1:def 3;
L1251: ( C83 . C85 ) <> ( C81 + 1 ) by L1250 , L1237;
L1252: ( C82 . C85 ) <> ( C81 + 1 ) by L1251 , L1210 , L1250 , FINSEQ_1:def 7;
L1253: ( C82 . C85 ) <= ( C81 + 1 ) by L1205 , L1239;
L1254: ( C82 . C85 ) < ( C81 + 1 ) by L1253 , L1252 , XXREAL_0:1;
L1255: ( C82 . C85 ) <= C81 by L1254 , NAT_1:13;
L1256: ( C82 . C85 ) > ( 0 ) by L1205 , L1239;
L1257: ( C82 . C85 ) >= ( ( 0 ) + 1 ) by L1256 , NAT_1:13;
thus L1258: thesis by L1257 , L1255 , FINSEQ_1:1;
end;
end;
L1260: C82 is (FinSequence of ( Seg C81 )) by L1238 , FINSEQ_2:12;
L1261: ( rng C82 ) c= ( Seg C81 ) by L1260 , FINSEQ_1:def 4;
L1262: ( card ( rng C82 ) ) <= ( card ( Seg C81 ) ) by L1261 , NAT_1:43;
L1263: ( C81 + 1 ) <= ( card ( Seg C81 ) ) by L1262 , L1204 , L1206 , FINSEQ_4:62;
L1264: ( C81 + 1 ) <= ( C81 + ( 0 ) ) by L1263 , FINSEQ_1:57;
thus L1265: contradiction by L1264 , XREAL_1:6;
end;
consider C86 being (Element of ( NAT )) such that L1266: C86 in ( dom C83 ) and L1267: ( C83 . C86 ) = ( C81 + 1 ) by L1236;
L1268: C86 <= C81 by L1204 , L1212 , L1266 , FINSEQ_3:25;
L1269: C86 <= ( len C82 ) by L1268 , L1204 , NAT_1:13;
L1270: ( ( 0 ) + 1 ) <= ( C81 + 1 ) by XREAL_1:6;
set D70 = ( Swap (C82 , C86 , ( C81 + 1 )) );
L1271: ( len D70 ) = ( C81 + 1 ) by L1204 , FINSEQ_7:18;
L1272: D70 <> ( {} ) by L1271;
consider C87 being (FinSequence of ( NAT )), C88 being (Element of ( NAT )) such that L1273: D70 = ( C87 ^ <* C88 *> ) by L1272 , HILBERT2:4;
L1274: ( C81 + 1 ) = ( ( len C87 ) + 1 ) by L1271 , L1273 , FINSEQ_2:16;
L1275: 1 <= C86 by L1266 , FINSEQ_3:25;
L1276: ( D70 /. ( C81 + 1 ) ) = ( C82 /. C86 ) by L1275 , L1204 , L1269 , L1270 , FINSEQ_7:31;
L1277: ( D70 /. ( C81 + 1 ) ) = ( C82 . C86 ) by L1276 , L1275 , L1269 , FINSEQ_4:15;
L1278: ( D70 . ( C81 + 1 ) ) = ( C82 . C86 ) by L1277 , L1271 , L1270 , FINSEQ_4:15;
L1279: ( D70 . ( C81 + 1 ) ) = ( C81 + 1 ) by L1278 , L1210 , L1266 , L1267 , FINSEQ_1:def 7;
L1280: C88 = ( C81 + 1 ) by L1279 , L1273 , L1274 , FINSEQ_1:42;
L1281: D70 is  one-to-one by L1206 , L1188;
L1282: (for R13 being Nat holds (R13 in ( dom C87 ) implies (( C87 . R13 ) > ( 0 ) & ( C87 . R13 ) <= C81)))
proof
let R13 being Nat;
assume L1283: R13 in ( dom C87 );
L1284: R13 in ( dom D70 ) by L1283 , L1273 , FINSEQ_2:15;
L1285:
now
L1286: R13 <= C81 by L1274 , L1283 , FINSEQ_3:25;
L1287: R13 < ( C81 + 1 ) by L1286 , XREAL_1:145;
assume L1288: ( C87 . R13 ) = ( C81 + 1 );
L1289: ( D70 . R13 ) = ( C81 + 1 ) by L1288 , L1273 , L1283 , FINSEQ_1:def 7;
L1290: ( C81 + 1 ) in ( dom D70 ) by L1271 , L1272 , FINSEQ_5:6;
thus L1291: contradiction by L1290 , L1279 , L1281 , L1284 , L1289 , L1287 , FUNCT_1:def 4;
end;
L1292: ( D70 . R13 ) in ( rng D70 ) by L1284 , FUNCT_1:3;
L1293: ( D70 . R13 ) in ( rng C82 ) by L1292 , FINSEQ_7:22;
L1294: (ex B69 being Nat st (B69 in ( dom C82 ) & ( D70 . R13 ) = ( C82 . B69 ))) by L1293 , FINSEQ_2:10;
L1295: ( D70 . R13 ) <= ( C81 + 1 ) by L1294 , L1205;
L1296: ( C87 . R13 ) <= ( C81 + 1 ) by L1295 , L1273 , L1283 , FINSEQ_1:def 7;
L1297: ( C87 . R13 ) < ( C81 + 1 ) by L1296 , L1285 , XXREAL_0:1;
L1298: ( D70 . R13 ) > ( 0 ) by L1205 , L1294;
thus L1299: thesis by L1298 , L1273 , L1283 , L1297 , FINSEQ_1:def 7 , NAT_1:13;
end;
L1300: C87 is  one-to-one by L1273 , L1281 , FINSEQ_3:91;
L1301: ( rng C87 ) = ( Seg C81 ) by L1300 , L1202 , L1274 , L1282;
L1302: ( rng D70 ) = ( ( rng C87 ) \/ ( rng <* C88 *> ) ) by L1273 , FINSEQ_1:31
.= ( ( Seg C81 ) \/ { ( C81 + 1 ) } ) by L1280 , L1301 , FINSEQ_1:38
.= ( Seg ( C81 + 1 ) ) by FINSEQ_1:9;
thus L1303: thesis by L1302 , FINSEQ_7:22;
end;
end;
thus L1305: thesis by L1203;
end;
L1306: S9[ ( 0 ) ]
proof
let C89 being (FinSequence of ( NAT ));
assume L1307: ( len C89 ) = ( 0 );
L1308: C89 = ( {} ) by L1307;
thus L1309: thesis by L1308;
end;
L1310: (for B70 being (Element of ( NAT )) holds S9[ B70 ]) from NAT_1:sch 1(L1306 , L1201);
thus L1311: thesis by L1310;
end;
theorem
L1312: (for R22 being Prime holds (for R31 being Nat holds (for R32 being Nat holds (for B71 being (FinSequence of ( NAT )) holds ((R22 > 2 & ( R31 gcd R22 ) = 1 & B71 = ( R31 * ( idseq ( ( R22 -' 1 ) div 2 ) ) ) & R32 = ( card { B72 where B72 is (Element of ( NAT )) : (B72 in ( rng ( B71 mod R22 ) ) & B72 > ( R22 / 2 )) } )) implies ( Lege (R31 , R22) ) = ( ( - 1 ) |^ R32 ))))))
proof
let R22 being Prime;
let R31 being Nat;
let R32 being Nat;
let C90 being (FinSequence of ( NAT ));
assume that
L1313: R22 > 2
and
L1314: ( R31 gcd R22 ) = 1
and
L1315: C90 = ( R31 * ( idseq ( ( R22 -' 1 ) div 2 ) ) )
and
L1316: R32 = ( card { B73 where B73 is (Element of ( NAT )) : (B73 in ( rng ( C90 mod R22 ) ) & B73 > ( R22 / 2 )) } );
set D71 = ( C90 mod R22 );
L1317: ( len D71 ) = ( len C90 ) by EULER_2:def 1;
set D72 = { B74 where B74 is (Element of ( NAT )) : (B74 in ( rng D71 ) & B74 > ( R22 / 2 )) };
L1318: (for B75 being set holds (B75 in D72 implies B75 in ( rng D71 )))
proof
let C91 being set;
assume L1319: C91 in D72;
L1320: (ex B76 being (Element of ( NAT )) st (C91 = B76 & B76 in ( rng D71 ) & B76 > ( R22 / 2 ))) by L1319;
thus L1321: thesis by L1320;
end;
L1322: D72 c= ( rng D71 ) by L1318 , TARSKI:def 3;
reconsider D73 = D72 as  finite set by L1322;
L1323: ( rng D71 ) c= ( NAT ) by FINSEQ_1:def 4;
reconsider D74 = D73 as  finite (Subset of ( NAT )) by L1323 , L1322 , XBOOLE_1:1;
L1324: ( card D74 ) is (Element of ( NAT ));
reconsider D75 = R32 as (Element of ( NAT )) by L1324 , L1316;
L1325: ( ( rng D71 ) \ D74 ) c= ( rng D71 ) by XBOOLE_1:36;
reconsider D76 = ( ( rng D71 ) \ D74 ) as  finite (Subset of ( NAT )) by L1325 , L1323 , XBOOLE_1:1;
L1326: ( R31 |^ ( ( R22 -' 1 ) div 2 ) ) , ( Lege (R31 , R22) ) are_congruent_mod R22 by L1313 , L1314 , L833 , INT_1:14;
set D77 = ( Sgm ( rng D71 ) );
L1327: ( ( Product D71 ) mod R22 ) = ( ( Product C90 ) mod R22 ) by EULER_2:11;
L1328: ( Product D71 ) , ( Product C90 ) are_congruent_mod R22 by L1327 , NAT_D:64;
L1329: R22 > 1 by INT_2:def 4;
L1330: ( R22 -' 1 ) = ( R22 - 1 ) by L1329 , XREAL_1:233;
L1331: ( R22 -' 1 ) > ( 0 ) by L1330 , L1329 , XREAL_1:50;
set D78 = ( ( R22 -' 1 ) div 2 );
L1332: ( rng ( idseq D78 ) ) = ( Seg D78 ) by RELAT_1:45;
reconsider D79 = ( idseq D78 ) as (FinSequence of ( NAT )) by L1332 , FINSEQ_1:def 4;
L1333: ( dom C90 ) = ( dom D79 ) by L1315 , VALUED_1:def 5;
L1334: ( len C90 ) = ( len D79 ) by L1333 , FINSEQ_3:29
.= D78 by CARD_1:def 7;
L1335: R22 >= ( 2 + 1 ) by L1313 , NAT_1:13;
L1336: ( R22 - 1 ) >= ( 3 - 1 ) by L1335 , XREAL_1:9;
L1337: D71 <> ( {} ) by L1336 , L1334 , L1330 , L1317 , NAT_2:13;
L1338: ( rng D71 ) is non  empty non  empty non  empty non  empty (Subset of ( NAT )) by L1337 , FINSEQ_1:def 4;
consider C92 being (Element of ( NAT )) such that L1339: ( rng D71 ) c= ( ( Seg C92 ) \/ { ( 0 ) } ) by L1338 , HEYTING3:1;
L1340: D79 is (Element of ( D78 -tuples_on ( REAL ) )) by FINSEQ_2:109;
L1341: ( Product C90 ) = ( ( Product ( D78 |-> R31 ) ) * ( Product D79 ) ) by L1340 , L1315 , RVSUM_1:108
.= ( ( R31 |^ D78 ) * ( Product D79 ) ) by NEWTON:def 1;
L1342: R22 is  odd by L1313 , PEPIN:17;
L1343: ( R22 -' 1 ) is  even by L1342 , L1330 , HILBERT3:2;
L1344: D78 = ( ( ( R22 -' 1 ) + 1 ) div 2 ) by L1343 , NAT_2:26
.= ( R22 div 2 ) by L1329 , XREAL_1:235;
L1345: 2 divides ( R22 -' 1 ) by L1343 , PEPIN:22;
L1346: ( R22 -' 1 ) = ( 2 * D78 ) by L1345 , NAT_D:3;
L1347: D78 divides ( R22 -' 1 ) by L1346 , NAT_D:def 3;
L1348: D78 <= ( R22 -' 1 ) by L1347 , L1331 , NAT_D:7;
L1349: D78 < R22 by L1348 , L1330 , XREAL_1:146 , XXREAL_0:2;
L1350: (for B77 being Nat holds (B77 in ( dom D79 ) implies ( ( D79 . B77 ) gcd R22 ) = 1))
proof
let C93 being Nat;
assume L1351: C93 in ( dom D79 );
L1352: C93 in ( Seg ( len D79 ) ) by L1351 , FINSEQ_1:def 3;
L1353: C93 in ( Seg D78 ) by L1352 , CARD_1:def 7;
L1354: ( D79 . C93 ) = C93 by L1353 , FINSEQ_2:49;
L1355: C93 <= D78 by L1353 , FINSEQ_1:1;
L1356: C93 < R22 by L1355 , L1349 , XXREAL_0:2;
L1357: C93 >= 1 by L1352 , FINSEQ_1:1;
L1358: C93 , R22 are_relative_prime  by L1357 , L1356 , EULER_1:2;
thus L1359: thesis by L1358 , L1354 , INT_2:def 3;
end;
L1360: ( ( Product D79 ) gcd R22 ) = 1 by L1350 , WSIERP_1:36;
L1361: (for R13 being Nat holds (R13 in ( dom C90 ) implies ( C90 . R13 ) = ( R31 * R13 )))
proof
let R13 being Nat;
assume L1362: R13 in ( dom C90 );
L1363: R13 in ( dom D79 ) by L1362 , L1315 , VALUED_1:def 5;
L1364: R13 in ( Seg ( len D79 ) ) by L1363 , FINSEQ_1:def 3;
L1365: R13 is (Element of ( Seg D78 )) by L1364 , CARD_1:def 7;
thus L1366: ( C90 . R13 ) = ( R31 * ( D79 . R13 ) ) by L1315 , L1362 , VALUED_1:def 5
.= ( R31 * R13 ) by L1365 , FINSEQ_2:49;
end;
L1367: (for B78 , B79 being (Element of ( NAT )) holds ((1 <= B78 & B78 < B79 & B79 <= ( len D71 )) implies ( D71 . B78 ) <> ( D71 . B79 )))
proof
let C94 , C95 being (Element of ( NAT ));
assume that
L1368: 1 <= C94
and
L1369: C94 < C95
and
L1370: C95 <= ( len D71 );
L1371: C95 <= ( len C90 ) by L1370 , EULER_2:def 1;
L1372: 1 <= C95 by L1368 , L1369 , XXREAL_0:2;
L1373: C95 in ( dom C90 ) by L1372 , L1371 , FINSEQ_3:25;
L1374: ( D71 . C95 ) = ( ( C90 . C95 ) mod R22 ) by L1373 , EULER_2:def 1;
L1375: C94 < ( len C90 ) by L1369 , L1371 , XXREAL_0:2;
L1376: C94 in ( dom C90 ) by L1375 , L1368 , FINSEQ_3:25;
L1377: ( D71 . C94 ) = ( ( C90 . C94 ) mod R22 ) by L1376 , EULER_2:def 1;
L1378:
now
assume L1379: ( D71 . C94 ) = ( D71 . C95 );
L1380: ( C90 . C95 ) , ( C90 . C94 ) are_congruent_mod R22 by L1379 , L1377 , L1374 , NAT_D:64;
L1381: R22 divides ( ( C90 . C95 ) - ( C90 . C94 ) ) by L1380 , INT_2:15;
L1382: R22 divides ( ( R31 * C95 ) - ( C90 . C94 ) ) by L1381 , L1361 , L1373;
L1383: R22 divides ( ( R31 * C95 ) - ( R31 * C94 ) ) by L1382 , L1361 , L1376;
L1384: R22 divides ( R31 * ( C95 - C94 ) ) by L1383;
L1385: ( D78 - 1 ) < R22 by L1349 , XREAL_1:147;
reconsider D80 = ( C95 - C94 ) as (Element of ( NAT )) by L1369 , NAT_1:21;
L1386: ( abs R22 ) = R22 by ABSVALUE:def 1;
L1387: ( abs D80 ) = D80 by ABSVALUE:def 1;
L1388: D80 <= ( D78 - 1 ) by L1334 , L1317 , L1368 , L1370 , XREAL_1:13;
L1389: D80 <> ( 0 ) by L1369;
L1390: R22 <= D80 by L1389 , L1314 , L1384 , L1386 , L1387 , INT_4:6 , WSIERP_1:29;
thus L1391: contradiction by L1390 , L1388 , L1385 , XXREAL_0:2;
end;
thus L1392: thesis by L1378;
end;
L1393: ( len D71 ) = ( card ( rng D71 ) ) by L1367 , GRAPH_5:7;
L1394: D71 is  one-to-one by L1393 , FINSEQ_4:62;
L1395: ( dom D71 ) = ( dom C90 ) by L1317 , FINSEQ_3:29;
L1396: (not ( 0 ) in ( rng D71 ))
proof
reconsider D81 = R31 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L1397: ( 0 ) in ( rng D71 );
consider C96 being Nat such that L1398: C96 in ( dom D71 ) and L1399: ( D71 . C96 ) = ( 0 ) by L1397 , FINSEQ_2:10;
L1400: ( 0 ) = ( ( C90 . C96 ) mod R22 ) by L1395 , L1398 , L1399 , EULER_2:def 1
.= ( ( D81 * C96 ) mod R22 ) by L1361 , L1395 , L1398;
L1401: R22 divides ( D81 * C96 ) by L1400 , PEPIN:6;
L1402: C96 >= 1 by L1398 , FINSEQ_3:25;
L1403: R22 <= C96 by L1402 , L1314 , L1401 , NAT_D:7 , WSIERP_1:30;
L1404: C96 <= D78 by L1334 , L1317 , L1398 , FINSEQ_3:25;
thus L1405: contradiction by L1404 , L1349 , L1403 , XXREAL_0:2;
end;
L1406: { ( 0 ) } misses ( rng D71 ) by L1396 , ZFMISC_1:50;
L1407: D77 is  one-to-one by L1406 , L1339 , FINSEQ_3:92 , XBOOLE_1:73;
L1408: ( rng D71 ) c= ( Seg C92 ) by L1339 , L1406 , XBOOLE_1:73;
L1409: D74 c= ( Seg C92 ) by L1408 , L1322 , XBOOLE_1:1;
L1410: ( len C90 ) = ( card ( rng D71 ) ) by L1317 , L1367 , GRAPH_5:7;
reconsider D82 = ( D78 - D75 ) as (Element of ( NAT )) by L1410 , L1316 , L1334 , L1322 , NAT_1:21 , NAT_1:43;
L1411: D76 c= ( Seg C92 ) by L1408 , L1325 , XBOOLE_1:1;
L1412: ( rng D71 ) = ( rng D77 ) by L1408 , FINSEQ_1:def 13;
L1413: ( Product D71 ) = ( Product D77 ) by L1412 , L1394 , L1407 , EULER_2:10 , RFINSEQ:26;
set D83 = ( ( ( len ( D77 /^ D82 ) ) |-> R22 ) - ( D77 /^ D82 ) );
set D84 = ( ( D77 | D82 ) ^ D83 );
L1414: ( D77 /^ D82 ) is (FinSequence of ( INT )) by FINSEQ_2:24 , NUMBERS:17;
L1415: ( dom D83 ) = ( ( dom ( ( len ( D77 /^ D82 ) ) |-> R22 ) ) /\ ( dom ( D77 /^ D82 ) ) ) by VALUED_1:12
.= ( ( Seg ( len ( ( len ( D77 /^ D82 ) ) |-> R22 ) ) ) /\ ( dom ( D77 /^ D82 ) ) ) by FINSEQ_1:def 3
.= ( ( Seg ( len ( D77 /^ D82 ) ) ) /\ ( dom ( D77 /^ D82 ) ) ) by CARD_1:def 7
.= ( ( dom ( D77 /^ D82 ) ) /\ ( dom ( D77 /^ D82 ) ) ) by FINSEQ_1:def 3
.= ( dom ( D77 /^ D82 ) );
L1416: ( len D83 ) = ( len ( D77 /^ D82 ) ) by L1415 , FINSEQ_3:29;
L1417: (for B80 , B81 being (Element of ( NAT )) holds ((B80 in D76 & B81 in D74) implies B80 < B81))
proof
let C97 , C98 being (Element of ( NAT ));
assume that
L1418: C97 in D76
and
L1419: C98 in D74;
L1420: (not C97 in D74) by L1418 , XBOOLE_0:def 5;
L1421: (ex B82 being (Element of ( NAT )) st (B82 = C98 & B82 in ( rng D71 ) & B82 > ( R22 / 2 ))) by L1419;
L1422: C97 in ( rng D71 ) by L1418 , XBOOLE_0:def 5;
L1423: C97 <= ( R22 / 2 ) by L1422 , L1420;
thus L1424: thesis by L1423 , L1421 , XXREAL_0:2;
end;
L1425: ( Sgm ( D76 \/ D74 ) ) = ( ( Sgm D76 ) ^ ( Sgm D74 ) ) by L1417 , L1409 , L1411 , FINSEQ_3:42;
L1426: ( Sgm ( ( rng D71 ) \/ D74 ) ) = ( ( Sgm D76 ) ^ ( Sgm D74 ) ) by L1425 , XBOOLE_1:39;
L1427: D77 = ( ( Sgm D76 ) ^ ( Sgm D74 ) ) by L1426 , L1322 , XBOOLE_1:12;
L1428: (for R13 being Nat holds (R13 in ( dom D83 ) implies ( D83 . R13 ) = ( R22 - ( ( D77 /^ D82 ) . R13 ) )))
proof
let R13 being Nat;
assume L1429: R13 in ( dom D83 );
L1430: R13 in ( Seg ( len ( D77 /^ D82 ) ) ) by L1429 , L1415 , FINSEQ_1:def 3;
L1431: ( ( ( len ( D77 /^ D82 ) ) |-> R22 ) . R13 ) = R22 by L1430 , FINSEQ_2:57;
thus L1432: thesis by L1431 , L1429 , VALUED_1:13;
end;
L1433: ( len ( Sgm D76 ) ) = ( card D76 ) by L1408 , L1325 , FINSEQ_3:39 , XBOOLE_1:1
.= ( D78 - D75 ) by L1316 , L1334 , L1317 , L1322 , L1393 , CARD_2:44;
L1434: ( D77 /^ D82 ) = ( Sgm D74 ) by L1433 , L1427 , FINSEQ_5:37;
L1435: (for R13 being Nat holds (R13 in ( dom D83 ) implies (( D83 . R13 ) > ( 0 ) & ( D83 . R13 ) <= D78)))
proof
let R13 being Nat;
reconsider D85 = ( D83 . R13 ) as (Element of ( INT )) by INT_1:def 2;
assume L1436: R13 in ( dom D83 );
L1437: ( ( Sgm D74 ) . R13 ) in ( rng ( Sgm D74 ) ) by L1436 , L1434 , L1415 , FUNCT_1:3;
L1438: ( ( Sgm D74 ) . R13 ) in D74 by L1437 , L1409 , FINSEQ_1:def 13;
L1439: (ex B83 being (Element of ( NAT )) st (B83 = ( ( Sgm D74 ) . R13 ) & B83 in ( rng D71 ) & B83 > ( R22 / 2 ))) by L1438;
consider C99 being Nat such that L1440: C99 in ( dom D71 ) and L1441: ( D71 . C99 ) = ( ( D77 /^ D82 ) . R13 ) by L1439 , L1434 , FINSEQ_2:10;
L1442: ( ( D77 /^ D82 ) . R13 ) = ( ( C90 . C99 ) mod R22 ) by L1395 , L1440 , L1441 , EULER_2:def 1;
L1443: ( ( D77 /^ D82 ) . R13 ) < R22 by L1442 , NAT_D:1;
L1444: ( D83 . R13 ) = ( R22 - ( ( D77 /^ D82 ) . R13 ) ) by L1428 , L1436;
L1445: D85 < ( R22 - ( R22 / 2 ) ) by L1444 , L1434 , L1439 , XREAL_1:10;
thus L1446: thesis by L1445 , L1344 , L1444 , L1443 , INT_1:54 , XREAL_1:50;
end;
L1447: ( rng D83 ) c= ( INT ) by RELAT_1:def 19;
L1448: (for B84 being Nat holds (B84 in ( dom D83 ) implies ( D83 . B84 ) in ( NAT )))
proof
let C100 being Nat;
assume L1449: C100 in ( dom D83 );
L1450: ( D83 . C100 ) > ( 0 ) by L1435 , L1449;
thus L1451: thesis by L1450 , L1447 , INT_1:3;
end;
reconsider D86 = D83 as (FinSequence of ( NAT )) by L1448 , FINSEQ_2:12;
L1452: ( abs ( ( - 1 ) |^ D75 ) ) = 1 by SERIES_2:1;
L1453: (( ( - 1 ) |^ D75 ) = 1 or ( - ( ( - 1 ) |^ D75 ) ) = 1) by L1452 , ABSVALUE:1;
L1454: D86 is (FinSequence of ( NAT ));
reconsider D87 = D84 as (FinSequence of ( NAT )) by L1454 , FINSEQ_1:75;
L1455: ( D77 | D82 ) = ( Sgm D76 ) by L1427 , L1433 , FINSEQ_3:113 , FINSEQ_6:10;
L1456: (for R13 being Nat holds (R13 in ( dom D87 ) implies (( D87 . R13 ) > ( 0 ) & ( D87 . R13 ) <= D78)))
proof
let R13 being Nat;
assume L1457: R13 in ( dom D87 );
per cases  by L1457 , FINSEQ_1:25;
suppose L1458: R13 in ( dom ( D77 | D82 ) );

reconsider D88 = R13 as (Element of ( NAT )) by ORDINAL1:def 12;
L1459: ( ( D77 | D82 ) . D88 ) in ( rng ( Sgm D76 ) ) by L1455 , L1458 , FUNCT_1:3;
L1460: ( ( D77 | D82 ) . D88 ) in D76 by L1459 , L1411 , FINSEQ_1:def 13;
L1461: ( ( D77 | D82 ) . D88 ) in ( rng D71 ) by L1460 , XBOOLE_0:def 5;
L1462: (not ( ( D77 | D82 ) . D88 ) in D74) by L1460 , XBOOLE_0:def 5;
L1463: ( ( D77 | D82 ) . D88 ) <= ( R22 / 2 ) by L1462 , L1461;
L1464: ( ( D77 | D82 ) . D88 ) <= D78 by L1463 , L1344 , INT_1:54;
L1465: (not ( ( D77 | D82 ) . D88 ) in { ( 0 ) }) by L1406 , L1461 , XBOOLE_0:3;
L1466: ( ( D77 | D82 ) . D88 ) <> ( 0 ) by L1465 , TARSKI:def 1;
thus L1467: thesis by L1466 , L1458 , L1464 , FINSEQ_1:def 7;
end;
suppose L1468: (ex B85 being Nat st (B85 in ( dom D86 ) & R13 = ( ( len ( D77 | D82 ) ) + B85 )));

consider C101 being (Element of ( NAT )) such that L1469: C101 in ( dom D86 ) and L1470: R13 = ( ( len ( D77 | D82 ) ) + C101 ) by L1468;
L1471: ( D87 . R13 ) = ( D86 . C101 ) by L1469 , L1470 , FINSEQ_1:def 7;
thus L1472: thesis by L1471 , L1435 , L1469;
end;
end;
L1474: D77 = ( ( D77 | D82 ) ^ ( D77 /^ D82 ) ) by RFINSEQ:8;
L1475: ( D77 /^ D82 ) is  one-to-one by L1474 , L1407 , FINSEQ_3:91;
L1476: (for B86 , B87 being (Element of ( NAT )) holds ((1 <= B86 & B86 < B87 & B87 <= ( len D86 )) implies ( D86 . B86 ) <> ( D86 . B87 )))
proof
let C102 , C103 being (Element of ( NAT ));
assume that
L1477: 1 <= C102
and
L1478: C102 < C103
and
L1479: C103 <= ( len D86 );
L1480: 1 <= C103 by L1477 , L1478 , XXREAL_0:2;
L1481: C103 in ( dom D86 ) by L1480 , L1479 , FINSEQ_3:25;
L1482: ( D86 . C103 ) = ( R22 - ( ( D77 /^ D82 ) . C103 ) ) by L1481 , L1428;
L1483: C102 < ( len D86 ) by L1478 , L1479 , XXREAL_0:2;
L1484: C102 in ( dom D86 ) by L1483 , L1477 , FINSEQ_3:25;
L1485: ( D86 . C102 ) = ( R22 - ( ( D77 /^ D82 ) . C102 ) ) by L1484 , L1428;
thus L1486: thesis by L1485 , L1475 , L1415 , L1478 , L1484 , L1481 , L1482 , FUNCT_1:def 4;
end;
L1487: ( len D86 ) = ( card ( rng D86 ) ) by L1476 , GRAPH_5:7;
L1488: D86 is  one-to-one by L1487 , FINSEQ_4:62;
L1489: ( len D77 ) = D78 by L1334 , L1317 , L1339 , L1406 , L1393 , FINSEQ_3:39 , XBOOLE_1:73;
L1490: D82 <= ( len D77 ) by L1489 , XREAL_1:43;
L1491: ( rng ( D77 | D82 ) ) misses ( rng D86 )
proof
assume L1492: ( rng ( D77 | D82 ) ) meets ( rng D86 );
consider C104 being set such that L1493: C104 in ( rng ( D77 | D82 ) ) and L1494: C104 in ( rng D86 ) by L1492 , XBOOLE_0:3;
consider C105 being Nat such that L1495: C105 in ( dom D86 ) and L1496: ( D86 . C105 ) = C104 by L1494 , FINSEQ_2:10;
L1497: C104 = ( R22 - ( ( D77 /^ D82 ) . C105 ) ) by L1428 , L1495 , L1496;
L1498: C104 = ( R22 - ( D77 . ( C105 + D82 ) ) ) by L1497 , L1490 , L1415 , L1495 , RFINSEQ:def 1;
L1499: ( C105 + D82 ) in ( dom D77 ) by L1415 , L1495 , FINSEQ_5:26;
consider C106 being Nat such that L1500: C106 in ( dom D71 ) and L1501: ( D71 . C106 ) = ( D77 . ( C105 + D82 ) ) by L1499 , L1412 , FINSEQ_2:10 , FUNCT_1:3;
L1502: C106 in ( dom C90 ) by L1317 , L1500 , FINSEQ_3:29;
L1503: C106 <= D78 by L1334 , L1317 , L1500 , FINSEQ_3:25;
L1504: ( rng ( D77 | D82 ) ) c= ( rng D77 ) by FINSEQ_5:19;
consider C107 being Nat such that L1505: C107 in ( dom D71 ) and L1506: ( D71 . C107 ) = C104 by L1504 , L1412 , L1493 , FINSEQ_2:10;
L1507: C107 <= D78 by L1334 , L1317 , L1505 , FINSEQ_3:25;
L1508: ( C107 + C106 ) <= ( D78 + D78 ) by L1507 , L1503 , XREAL_1:7;
L1509: ( C107 + C106 ) < R22 by L1508 , L1330 , L1346 , XREAL_1:146 , XXREAL_0:2;
L1510: C104 = ( ( C90 . C107 ) mod R22 ) by L1395 , L1505 , L1506 , EULER_2:def 1;
L1511: ( ( ( C90 . C107 ) mod R22 ) + ( D77 . ( C105 + D82 ) ) ) = R22 by L1510 , L1498;
L1512: ( ( ( C90 . C107 ) mod R22 ) + ( ( C90 . C106 ) mod R22 ) ) = R22 by L1511 , L1501 , L1502 , EULER_2:def 1;
L1513: ( ( ( ( C90 . C107 ) mod R22 ) + ( ( C90 . C106 ) mod R22 ) ) mod R22 ) = ( 0 ) by L1512 , NAT_D:25;
L1514: ( ( ( C90 . C107 ) + ( C90 . C106 ) ) mod R22 ) = ( 0 ) by L1513 , EULER_2:6;
L1515: R22 divides ( ( C90 . C107 ) + ( C90 . C106 ) ) by L1514 , PEPIN:6;
L1516: R22 divides ( ( C107 * R31 ) + ( C90 . C106 ) ) by L1515 , L1361 , L1395 , L1505;
L1517: R22 divides ( ( C107 * R31 ) + ( C106 * R31 ) ) by L1516 , L1361 , L1502;
L1518: R22 divides ( ( C107 + C106 ) * R31 ) by L1517;
L1519: C107 >= 1 by L1505 , FINSEQ_3:25;
thus L1520: contradiction by L1519 , L1314 , L1518 , L1509 , NAT_D:7 , WSIERP_1:30;
end;
L1521: ( D77 | D82 ) is  one-to-one by L1407 , L1474 , FINSEQ_3:91;
L1522: D87 is  one-to-one by L1521 , L1488 , L1491 , FINSEQ_3:91;
L1523: (for R13 being Nat holds (R13 in ( dom D86 ) implies ( D86 . R13 ) , ( - ( ( D77 /^ D82 ) . R13 ) ) are_congruent_mod R22))
proof
let R13 being Nat;
assume L1524: R13 in ( dom D86 );
L1525: ( ( D86 . R13 ) mod R22 ) = ( ( R22 - ( ( D77 /^ D82 ) . R13 ) ) mod R22 ) by L1524 , L1428
.= ( ( ( 1 * R22 ) + ( - ( ( D77 /^ D82 ) . R13 ) ) ) mod R22 )
.= ( ( - ( ( D77 /^ D82 ) . R13 ) ) mod R22 ) by EULER_1:12;
thus L1526: thesis by L1525 , NAT_D:64;
end;
L1527: ( len ( D77 /^ D82 ) ) = ( ( len D77 ) -' D82 ) by RFINSEQ:29
.= ( ( len D77 ) - D82 ) by L1489 , XREAL_1:43 , XREAL_1:233
.= D75 by L1489;
L1528: ( len ( D77 | D82 ) ) = D82 by L1489 , FINSEQ_1:59 , XREAL_1:43;
L1529: ( len D87 ) = ( D82 + D75 ) by L1528 , L1416 , L1527 , FINSEQ_1:22
.= ( len C90 ) by L1334;
L1530: ( rng D87 ) = ( rng D79 ) by L1529 , L1332 , L1334 , L1522 , L1456 , L1200;
L1531: ( Product D87 ) = ( Product D79 ) by L1530 , L1522 , EULER_2:10 , RFINSEQ:26;
L1532: ( ( Product ( D77 | D82 ) ) * ( Product D86 ) ) = ( Product D79 ) by L1531 , RVSUM_1:97;
L1533: D86 is (FinSequence of ( INT )) by FINSEQ_2:24 , NUMBERS:17;
L1534: ( ( Product D86 ) * ( Product ( D77 | D82 ) ) ) , ( ( ( ( - 1 ) |^ D75 ) * ( Product ( D77 /^ D82 ) ) ) * ( Product ( D77 | D82 ) ) ) are_congruent_mod R22 by L1533 , L1416 , L1527 , L1414 , L1523 , L1011 , INT_4:11;
L1535: ( ( Product D86 ) * ( Product ( D77 | D82 ) ) ) , ( ( ( - 1 ) |^ D75 ) * ( ( Product ( D77 | D82 ) ) * ( Product ( D77 /^ D82 ) ) ) ) are_congruent_mod R22 by L1534;
L1536: ( Product D79 ) , ( ( ( - 1 ) |^ D75 ) * ( Product ( ( D77 | D82 ) ^ ( D77 /^ D82 ) ) ) ) are_congruent_mod R22 by L1535 , L1532 , RVSUM_1:97;
L1537: ( Product D79 ) , ( ( ( - 1 ) |^ D75 ) * ( Product D71 ) ) are_congruent_mod R22 by L1536 , L1413 , RFINSEQ:8;
L1538: ( ( ( - 1 ) |^ D75 ) * ( Product D71 ) ) , ( ( ( - 1 ) |^ D75 ) * ( Product C90 ) ) are_congruent_mod R22 by L1328 , INT_4:11;
L1539: ( Product D79 ) , ( ( ( ( - 1 ) |^ D75 ) * ( R31 |^ D78 ) ) * ( Product D79 ) ) are_congruent_mod R22 by L1538 , L1341 , L1537 , INT_1:15;
L1540: R22 divides ( ( 1 * ( Product D79 ) ) - ( ( ( ( - 1 ) |^ D75 ) * ( R31 |^ D78 ) ) * ( Product D79 ) ) ) by L1539 , INT_2:15;
L1541: R22 divides ( ( 1 - ( ( ( - 1 ) |^ D75 ) * ( R31 |^ D78 ) ) ) * ( Product D79 ) ) by L1540;
L1542: R22 divides ( 1 - ( ( ( - 1 ) |^ D75 ) * ( R31 |^ D78 ) ) ) by L1541 , L1360 , WSIERP_1:29;
L1543: R22 divides ( ( ( - 1 ) |^ D75 ) * ( 1 - ( ( ( - 1 ) |^ D75 ) * ( R31 |^ D78 ) ) ) ) by L1542 , INT_2:2;
L1544: R22 divides ( ( ( - 1 ) |^ D75 ) - ( ( ( ( - 1 ) |^ D75 ) * ( ( - 1 ) |^ D75 ) ) * ( R31 |^ D78 ) ) ) by L1543;
L1545: ( ( ( - 1 ) |^ D75 ) * ( ( - 1 ) |^ D75 ) ) = ( ( - 1 ) |^ ( D75 + D75 ) ) by NEWTON:8
.= ( ( - 1 ) |^ ( 2 * D75 ) )
.= ( ( ( - 1 ) |^ 2 ) |^ D75 ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ D75 ) by WSIERP_1:1
.= ( ( 1 ^2 ) |^ D75 ) by NEWTON:81
.= 1 by NEWTON:10;
L1546: ( ( - 1 ) |^ D75 ) , ( R31 |^ D78 ) are_congruent_mod R22 by L1545 , L1544 , INT_2:15;
L1547: ( ( - 1 ) |^ D75 ) , ( Lege (R31 , R22) ) are_congruent_mod R22 by L1546 , L1326 , INT_1:15;
per cases  by L1453;
suppose L1548: ( ( - 1 ) |^ D75 ) = 1;

L1549:
now
assume L1550: ( Lege (R31 , R22) ) = ( - 1 );
L1551: R22 divides ( 1 - ( - 1 ) ) by L1550 , L1547 , L1548 , INT_2:15;
thus L1552: contradiction by L1551 , L1313 , NAT_D:7;
end;
L1553:
now
assume L1554: ( Lege (R31 , R22) ) = ( 0 );
L1555: R22 divides ( 1 - ( 0 ) ) by L1554 , L1547 , L1548 , INT_2:15;
L1556: R22 = 1 by L1555 , WSIERP_1:15;
thus L1557: contradiction by L1556 , L1313;
end;
thus L1558: thesis by L1553 , L1548 , L807 , L1549;
end;
suppose L1559: ( ( - 1 ) |^ D75 ) = ( - 1 );

L1560:
now
assume L1561: ( Lege (R31 , R22) ) = 1;
L1562: R22 divides ( ( - 1 ) - 1 ) by L1561 , L1547 , L1559 , INT_2:15;
L1563: R22 divides ( - 2 ) by L1562;
L1564: R22 divides 2 by L1563 , INT_2:10;
thus L1565: contradiction by L1564 , L1313 , NAT_D:7;
end;
L1566:
now
assume L1567: ( Lege (R31 , R22) ) = ( 0 );
L1568: R22 divides ( ( - 1 ) - ( 0 ) ) by L1567 , L1547 , L1559 , INT_2:15;
L1569: R22 divides 1 by L1568 , INT_2:10;
L1570: R22 = 1 by L1569 , WSIERP_1:15;
thus L1571: contradiction by L1570 , L1313;
end;
thus L1572: thesis by L1566 , L1559 , L807 , L1560;
end;
end;
theorem
L1574: (for R22 being Prime holds (R22 > 2 implies ( Lege (2 , R22) ) = ( ( - 1 ) |^ ( ( ( R22 ^2 ) -' 1 ) div 8 ) )))
proof
let R22 being Prime;
set D89 = ( ( R22 -' 1 ) div 2 );
set D90 = ( idseq D89 );
set D91 = ( 2 * D90 );
set D92 = ( R22 div 8 );
L1575: R22 > 1 by INT_2:def 4;
L1576: ( R22 - 1 ) = ( R22 -' 1 ) by L1575 , XREAL_1:233;
L1577: (for R13 being Nat holds (R13 in ( dom D91 ) implies ( D91 . R13 ) = ( 2 * R13 )))
proof
let R13 being Nat;
assume L1578: R13 in ( dom D91 );
L1579: R13 in ( dom D90 ) by L1578 , VALUED_1:def 5;
L1580: R13 in ( Seg ( len D90 ) ) by L1579 , FINSEQ_1:def 3;
L1581: R13 is (Element of ( Seg D89 )) by L1580 , CARD_1:def 7;
thus L1582: ( D91 . R13 ) = ( 2 * ( D90 . R13 ) ) by L1578 , VALUED_1:def 5
.= ( 2 * R13 ) by L1581 , FINSEQ_2:49;
end;
L1583: (for B88 being Nat holds (B88 in ( dom D91 ) implies ( D91 . B88 ) in ( NAT )));
reconsider D93 = D91 as (FinSequence of ( NAT )) by L1583 , FINSEQ_2:12;
set D94 = ( D93 mod R22 );
set D95 = { B89 where B89 is (Element of ( NAT )) : (B89 in ( rng D94 ) & B89 > ( R22 / 2 )) };
set D96 = ( card D95 );
L1584: ( dom D93 ) = ( dom D90 ) by VALUED_1:def 5;
L1585: ( len D93 ) = ( len D90 ) by L1584 , FINSEQ_3:29
.= D89 by CARD_1:def 7;
set D97 = { B90 where B90 is (Element of ( NAT )) : (B90 in ( dom D94 ) & ( D94 . B90 ) > ( R22 / 2 )) };
L1586: (for B91 being set holds (B91 in D97 implies B91 in ( dom D94 )))
proof
let C108 being set;
assume L1587: C108 in D97;
L1588: (ex B92 being (Element of ( NAT )) st (C108 = B92 & B92 in ( dom D94 ) & ( D94 . B92 ) > ( R22 / 2 ))) by L1587;
thus L1589: thesis by L1588;
end;
L1590: D97 c= ( dom D94 ) by L1586 , TARSKI:def 3;
reconsider D98 = D97 as  finite (Subset of ( NAT )) by L1590 , XBOOLE_1:1;
set D99 = ( seq (( R22 div 4 ) , ( D89 -' ( R22 div 4 ) )) );
L1591: ( R22 mod 8 ) <= ( 8 - 1 ) by INT_1:52 , NAT_D:1;
L1592: 8 = ( 2 * 4 );
L1593: 2 divides 8 by L1592 , NAT_D:def 3;
L1594:
now
assume L1595: ( R22 mod 8 ) = ( 0 );
L1596: 8 divides R22 by L1595 , PEPIN:6;
L1597: R22 = 8 by L1596 , INT_2:def 4;
thus L1598: contradiction by L1597 , L1593 , NAT_4:12;
end;
L1599: (for B93 being set holds (B93 in D95 implies B93 in ( rng D94 )))
proof
let C109 being set;
assume L1600: C109 in D95;
L1601: (ex B94 being (Element of ( NAT )) st (C109 = B94 & B94 in ( rng D94 ) & B94 > ( R22 / 2 ))) by L1600;
thus L1602: thesis by L1601;
end;
L1603: D95 c= ( rng D94 ) by L1599 , TARSKI:def 3;
reconsider D100 = D95 as  finite set by L1603;
L1604: ( card D100 ) is (Element of ( NAT ));
reconsider D101 = D96 as (Element of ( NAT )) by L1604;
L1605: ( len D94 ) = ( len D93 ) by EULER_2:def 1;
L1606: ( dom D94 ) = ( dom D93 ) by L1605 , FINSEQ_3:29;
assume L1607: R22 > 2;
L1608: 2 , R22 are_relative_prime  by L1607 , EULER_1:2;
L1609: ( 2 gcd R22 ) = 1 by L1608 , INT_2:def 3;
L1610: ( Lege (2 , R22) ) = ( ( - 1 ) |^ D101 ) by L1609 , L1607 , L1312;
L1611: R22 is  odd by L1607 , PEPIN:17;
L1612: ( R22 - 1 ) is  even by L1611 , HILBERT3:2;
L1613: D89 = ( ( ( R22 -' 1 ) + 1 ) div 2 ) by L1612 , L1576 , NAT_2:26
.= ( R22 div 2 ) by L1575 , XREAL_1:235;
L1614: D94 <> ( {} ) by L1613 , L1607 , L1585 , L1605 , NAT_2:13;
reconsider D102 = ( dom D94 ) as non  empty  finite (Subset of ( NAT )) by L1614;
L1615: 2 divides ( R22 -' 1 ) by L1612 , L1576 , PEPIN:22;
L1616: ( R22 -' 1 ) = ( 2 * D89 ) by L1615 , NAT_D:3;
L1617: (for R13 being Nat holds (R13 in ( dom D94 ) implies ( D94 . R13 ) = ( 2 * R13 )))
proof
let R13 being Nat;
assume L1618: R13 in ( dom D94 );
L1619: R13 <= D89 by L1618 , L1585 , L1605 , FINSEQ_3:25;
L1620: ( 2 * R13 ) <= ( R22 -' 1 ) by L1619 , L1616 , XREAL_1:64;
L1621: ( 2 * R13 ) < R22 by L1620 , NAT_2:9 , XXREAL_0:2;
thus L1622: ( 2 * R13 ) = ( ( 2 * R13 ) mod R22 ) by L1621 , NAT_D:24
.= ( ( D93 . R13 ) mod R22 ) by L1577 , L1606 , L1618
.= ( D94 . R13 ) by L1606 , L1618 , EULER_2:def 1;
end;
L1623: (for B95 , B96 , B97 , B98 being Nat holds ((1 <= B95 & B95 < B96 & B96 <= ( len D94 ) & B97 = ( D94 . B95 ) & B98 = ( D94 . B96 )) implies B97 < B98))
proof
let C110 , C111 , C112 , C113 being Nat;
assume that
L1624: 1 <= C110
and
L1625: C110 < C111
and
L1626: C111 <= ( len D94 )
and
L1627: C112 = ( D94 . C110 )
and
L1628: C113 = ( D94 . C111 );
L1629: 1 <= C111 by L1624 , L1625 , XXREAL_0:2;
L1630: C111 in ( dom D94 ) by L1629 , L1626 , FINSEQ_3:25;
L1631: C113 = ( 2 * C111 ) by L1630 , L1617 , L1628;
L1632: C110 <= ( len D94 ) by L1625 , L1626 , XXREAL_0:2;
L1633: C110 in ( dom D94 ) by L1632 , L1624 , FINSEQ_3:25;
L1634: C112 = ( 2 * C110 ) by L1633 , L1617 , L1627;
thus L1635: thesis by L1634 , L1625 , L1631 , XREAL_1:68;
end;
L1636: ( rng D94 ) is non  empty non  empty non  empty non  empty (Subset of ( NAT )) by L1614 , FINSEQ_1:def 4;
consider C114 being (Element of ( NAT )) such that L1637: ( rng D94 ) c= ( ( Seg C114 ) \/ { ( 0 ) } ) by L1636 , HEYTING3:1;
L1638: ( rng D94 ) c= ( NAT ) by FINSEQ_1:def 4;
reconsider D103 = D100 as  finite (Subset of ( NAT )) by L1638 , L1603 , XBOOLE_1:1;
L1639: D99 , ( ( ( R22 -' 1 ) div 2 ) -' ( R22 div 4 ) ) are_equipotent  by CALCUL_2:6;
L1640: ( card D99 ) = ( ( ( R22 -' 1 ) div 2 ) -' ( R22 div 4 ) ) by L1639 , CARD_1:def 2;
L1641: (not ( 0 ) in ( rng D94 ))
proof
assume L1642: ( 0 ) in ( rng D94 );
consider C115 being Nat such that L1643: C115 in ( dom D94 ) and L1644: ( D94 . C115 ) = ( 0 ) by L1642 , FINSEQ_2:10;
L1645: ( 2 * C115 ) = ( 0 ) by L1617 , L1643 , L1644;
thus L1646: contradiction by L1645 , L1643 , FINSEQ_3:25;
end;
L1647: { ( 0 ) } misses ( rng D94 ) by L1641 , ZFMISC_1:50;
L1648: ( rng D94 ) c= ( Seg C114 ) by L1647 , L1637 , XBOOLE_1:73;
L1649: ( Sgm ( rng D94 ) ) = D94 by L1648 , L1623 , FINSEQ_1:def 13;
L1650: D103 , D98 are_equipotent 
proof
deffunc H6((Element of D102)) = ( D94 . $1 );
set D104 = { B99 where B99 is (Element of D102) : H6(B99) in D103 };
L1651:
now
let C116 being set;
assume L1652: C116 in D103;
consider C117 being (Element of ( NAT )) such that L1653: C117 = C116 and L1654: C117 in ( rng D94 ) and L1655: C117 > ( R22 / 2 ) by L1652;
consider C118 being Nat such that L1656: C118 in D102 and L1657: ( D94 . C118 ) = C117 by L1654 , FINSEQ_2:10;
reconsider D105 = C118 as (Element of D102) by L1656;
take D106 = D105;
thus L1658: C116 = H6(D106) by L1653 , L1657;
end;
L1659: D98 c= D104
proof
let C119 being set;
assume L1660: C119 in D98;
L1661: (ex B100 being (Element of ( NAT )) st (B100 = C119 & B100 in ( dom D94 ) & ( D94 . B100 ) > ( R22 / 2 ))) by L1660;
reconsider D107 = C119 as (Element of D102) by L1661;
reconsider D108 = D94 as (FinSequence of (( NAT ) qua set));
L1662: ( D108 . D107 ) in ( rng D108 ) by FUNCT_1:3;
L1663: H6(D107) in D103 by L1662 , L1661;
thus L1664: thesis by L1663;
end;
L1665:
now
let C120 being set;
assume L1666: C120 in D104;
consider C121 being (Element of D102) such that L1667: C121 = C120 and L1668: ( D94 . C121 ) in D103 by L1666;
L1669: (ex B101 being (Element of ( NAT )) st (B101 = ( D94 . C121 ) & B101 in ( rng D94 ) & B101 > ( R22 / 2 ))) by L1668;
thus L1670: C120 in D98 by L1669 , L1667;
end;
L1671: D104 c= D98 by L1665 , TARSKI:def 3;
L1672: (for B102 , B103 being (Element of D102) holds (H6(B102) = H6(B103) implies B102 = B103))
proof
let C122 , C123 being (Element of D102);
assume L1673: H6(C122) = H6(C123);
L1674: D94 is  one-to-one by L1637 , L1647 , L1649 , FINSEQ_3:92 , XBOOLE_1:73;
thus L1675: thesis by L1674 , L1673 , FUNCT_1:def 4;
end;
L1676: D103 , D104 are_equipotent  from FUNCT_7:sch 3(L1651 , L1672);
thus L1677: thesis by L1676 , L1659 , L1671 , XBOOLE_0:def 10;
end;
L1678: ( R22 div 2 ) < R22 by INT_1:56;
L1679: ( ( R22 div 2 ) div 2 ) <= ( R22 div 2 ) by L1678 , NAT_2:24;
L1680: ( R22 div ( 2 * 2 ) ) <= ( R22 div 2 ) by L1679 , NAT_2:27;
L1681: D99 c= D98
proof
let C124 being set;
assume L1682: C124 in D99;
reconsider D109 = C124 as (Element of ( NAT )) by L1682;
L1683: D109 >= ( ( R22 div 4 ) + 1 ) by L1682 , CALCUL_2:1;
L1684: ( ( R22 div 4 ) + D109 ) >= ( ( R22 div 4 ) + 1 ) by L1683 , NAT_1:12;
L1685: D109 >= 1 by L1684 , XREAL_1:6;
L1686: D109 <= ( ( ( ( R22 -' 1 ) div 2 ) -' ( R22 div 4 ) ) + ( R22 div 4 ) ) by L1682 , CALCUL_2:1;
L1687: D109 <= ( ( R22 -' 1 ) div 2 ) by L1686 , L1613 , L1680 , XREAL_1:235;
L1688: D109 in ( dom D94 ) by L1687 , L1585 , L1605 , L1685 , FINSEQ_3:25;
L1689: D109 > ( R22 / 4 ) by L1683 , INT_1:29 , XXREAL_0:2;
L1690: ( 2 * D109 ) > ( 2 * ( R22 / 4 ) ) by L1689 , XREAL_1:68;
L1691: ( D94 . D109 ) > ( R22 / 2 ) by L1690 , L1617 , L1688;
thus L1692: thesis by L1691 , L1688;
end;
L1693:
now
let C125 being set;
L1694: ( R22 / 4 ) >= [\ ( R22 / 4 ) /] by INT_1:def 6;
assume L1695: C125 in D98;
consider C126 being (Element of ( NAT )) such that L1696: C126 = C125 and L1697: C126 in ( dom D94 ) and L1698: ( D94 . C126 ) > ( R22 / 2 ) by L1695;
L1699: ( 2 * C126 ) > ( R22 / 2 ) by L1617 , L1697 , L1698;
L1700: C126 > ( ( R22 / 2 ) / 2 ) by L1699 , XREAL_1:83;
L1701: C126 > [\ ( R22 / 4 ) /] by L1700 , L1694 , XXREAL_0:2;
L1702: C126 >= ( ( R22 div 4 ) + 1 ) by L1701 , NAT_1:13;
L1703: C126 <= D89 by L1585 , L1605 , L1697 , FINSEQ_3:25;
L1704: C126 <= ( ( D89 -' ( R22 div 4 ) ) + ( R22 div 4 ) ) by L1703 , L1613 , L1680 , XREAL_1:235;
thus L1705: C125 in D99 by L1704 , L1696 , L1702;
end;
L1706: D98 c= D99 by L1693 , TARSKI:def 3;
L1707: D98 = D99 by L1706 , L1681 , XBOOLE_0:def 10;
L1708: D101 = ( ( ( R22 -' 1 ) div 2 ) -' ( R22 div 4 ) ) by L1707 , L1640 , L1650 , CARD_1:5;
L1709:
now
assume L1710: ( R22 mod 8 ) = 2;
L1711: 8 divides ( R22 - 2 ) by L1710 , PEPIN:8;
L1712: 2 divides ( R22 - 2 ) by L1711 , L1593 , INT_2:9;
L1713: 2 divides ( - ( R22 - 2 ) ) by L1712 , INT_2:10;
L1714: 2 divides ( 2 - R22 ) by L1713;
L1715: 2 divides R22 by L1714 , L8;
thus L1716: contradiction by L1715 , L1607 , NAT_4:12;
end;
L1717:
now
assume L1718: ( R22 mod 8 ) = 4;
L1719: 8 divides ( R22 - 4 ) by L1718 , PEPIN:8;
L1720: 2 divides ( R22 - 4 ) by L1719 , L1593 , INT_2:9;
L1721: 2 divides ( - ( R22 - 4 ) ) by L1720 , INT_2:10;
L1722: 2 divides ( 4 - R22 ) by L1721;
L1723: 4 = ( 2 * 2 );
L1724: 2 divides 4 by L1723 , NAT_D:def 3;
L1725: 2 divides R22 by L1724 , L1722 , L8;
thus L1726: contradiction by L1725 , L1607 , NAT_4:12;
end;
L1727:
now
assume L1728: ( R22 mod 8 ) = 6;
L1729: 8 divides ( R22 - 6 ) by L1728 , PEPIN:8;
L1730: 2 divides ( R22 - 6 ) by L1729 , L1593 , INT_2:9;
L1731: 2 divides ( - ( R22 - 6 ) ) by L1730 , INT_2:10;
L1732: 2 divides ( 6 - R22 ) by L1731;
L1733: 6 = ( 2 * 3 );
L1734: 2 divides 6 by L1733 , NAT_D:def 3;
L1735: 2 divides R22 by L1734 , L1732 , L8;
thus L1736: contradiction by L1735 , L1607 , NAT_4:12;
end;
per cases  by L1594 , L1709 , L1717 , L1727 , L1591 , NAT_1:31;
suppose L1737: ( R22 mod 8 ) = 1;

L1738: R22 = ( ( 8 * D92 ) + 1 ) by L1737 , NAT_D:2;
L1739: ( R22 -' 1 ) = ( 2 * ( 4 * D92 ) ) by L1738 , L1576;
L1740: ( ( R22 -' 1 ) div 2 ) = ( 4 * D92 ) by L1739 , NAT_D:18;
L1741: ( R22 div 4 ) = ( ( ( 4 * ( 2 * D92 ) ) + 1 ) div 4 ) by L1738
.= ( ( 2 * D92 ) + ( 1 div 4 ) ) by NAT_D:61
.= ( ( 2 * D92 ) + ( 0 ) ) by NAT_D:27;
L1742: D101 = ( ( 4 * D92 ) - ( 2 * D92 ) ) by L1741 , L1708 , L1740 , XREAL_1:64 , XREAL_1:233
.= ( 2 * D92 );
L1743: ( Lege (2 , R22) ) = ( ( ( - 1 ) |^ 2 ) |^ D92 ) by L1742 , L1610 , NEWTON:9
.= ( ( 1 |^ 2 ) |^ D92 ) by WSIERP_1:1
.= ( ( 1 ^2 ) |^ D92 ) by NEWTON:81
.= 1 by NEWTON:10;
L1744: ( ( ( R22 ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( ( 8 * D92 ) ^2 ) + ( 2 * ( 8 * D92 ) ) ) + 1 ) -' 1 ) div 8 ) by L1738
.= ( ( 8 * ( ( 8 * ( D92 ^2 ) ) + ( 2 * D92 ) ) ) div 8 ) by NAT_D:34
.= ( ( 8 * ( D92 ^2 ) ) + ( 2 * D92 ) ) by NAT_D:18;
thus L1745: ( ( - 1 ) |^ ( ( ( R22 ^2 ) -' 1 ) div 8 ) ) = ( ( - 1 ) |^ ( 2 * ( ( 4 * ( D92 ^2 ) ) + D92 ) ) ) by L1744
.= ( ( ( - 1 ) |^ 2 ) |^ ( ( 4 * ( D92 ^2 ) ) + D92 ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( ( 4 * ( D92 ^2 ) ) + D92 ) ) by WSIERP_1:1
.= ( 1 |^ ( ( 4 * ( D92 ^2 ) ) + D92 ) ) by NEWTON:10
.= ( Lege (2 , R22) ) by L1743 , NEWTON:10;
end;
suppose L1746: ( R22 mod 8 ) = 3;

L1747: R22 = ( ( 8 * D92 ) + 3 ) by L1746 , NAT_D:2;
L1748: ( R22 -' 1 ) = ( 2 * ( ( 4 * D92 ) + 1 ) ) by L1747 , L1576;
L1749: ( ( R22 -' 1 ) div 2 ) = ( ( 4 * D92 ) + 1 ) by L1748 , NAT_D:18;
L1750: ( 4 * D92 ) >= ( 2 * D92 ) by XREAL_1:64;
L1751: ( R22 div 4 ) = ( ( ( 4 * ( 2 * D92 ) ) + 3 ) div 4 ) by L1747
.= ( ( 2 * D92 ) + ( 3 div 4 ) ) by NAT_D:61
.= ( ( 2 * D92 ) + ( 0 ) ) by NAT_D:27;
L1752: D101 = ( ( ( 4 * D92 ) + 1 ) - ( 2 * D92 ) ) by L1751 , L1708 , L1749 , L1750 , NAT_1:12 , XREAL_1:233
.= ( ( 2 * D92 ) + 1 );
L1753: ( Lege (2 , R22) ) = ( ( ( - 1 ) |^ ( 2 * D92 ) ) * ( - 1 ) ) by L1752 , L1610 , NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ D92 ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ D92 ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ D92 ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( - 1 );
L1754: ( ( ( R22 ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( D92 ^2 ) ) ) + ( 8 * ( 6 * D92 ) ) ) + ( 3 * 3 ) ) - 1 ) div 8 ) by L1747 , NAT_1:12 , XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( D92 ^2 ) ) + ( 6 * D92 ) ) + 1 ) ) div 8 )
.= ( ( ( 8 * ( D92 ^2 ) ) + ( 6 * D92 ) ) + 1 ) by NAT_D:18;
thus L1755: ( ( - 1 ) |^ ( ( ( R22 ^2 ) -' 1 ) div 8 ) ) = ( ( ( - 1 ) |^ ( 2 * ( ( 4 * ( D92 ^2 ) ) + ( 3 * D92 ) ) ) ) * ( - 1 ) ) by L1754 , NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( ( 4 * ( D92 ^2 ) ) + ( 3 * D92 ) ) ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( ( 4 * ( D92 ^2 ) ) + ( 3 * D92 ) ) ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ ( ( 4 * ( D92 ^2 ) ) + ( 3 * D92 ) ) ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( Lege (2 , R22) ) by L1753;
end;
suppose L1756: ( R22 mod 8 ) = 5;

L1757: R22 = ( ( 8 * D92 ) + 5 ) by L1756 , NAT_D:2;
L1758: ( R22 -' 1 ) = ( 2 * ( ( 4 * D92 ) + 2 ) ) by L1757 , L1576;
L1759: ( ( R22 -' 1 ) div 2 ) = ( ( 4 * D92 ) + 2 ) by L1758 , NAT_D:18;
L1760: ( 4 * D92 ) >= ( 2 * D92 ) by XREAL_1:64;
L1761: ( R22 div 4 ) = ( ( ( 4 * ( ( 2 * D92 ) + 1 ) ) + 1 ) div 4 ) by L1757
.= ( ( ( 2 * D92 ) + 1 ) + ( 1 div 4 ) ) by NAT_D:61
.= ( ( ( 2 * D92 ) + 1 ) + ( 0 ) ) by NAT_D:27;
L1762: D101 = ( ( ( 4 * D92 ) + 2 ) - ( ( 2 * D92 ) + 1 ) ) by L1761 , L1708 , L1759 , L1760 , XREAL_1:7 , XREAL_1:233
.= ( ( 2 * D92 ) + 1 );
L1763: ( Lege (2 , R22) ) = ( ( ( - 1 ) |^ ( 2 * D92 ) ) * ( - 1 ) ) by L1762 , L1610 , NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ D92 ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ D92 ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ D92 ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( - 1 );
L1764: ( ( ( R22 ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( D92 ^2 ) ) ) + ( 8 * ( 10 * D92 ) ) ) + 25 ) - 1 ) div 8 ) by L1757 , NAT_1:12 , XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( D92 ^2 ) ) + ( 10 * D92 ) ) + 3 ) ) div 8 )
.= ( ( ( 8 * ( D92 ^2 ) ) + ( 10 * D92 ) ) + 3 ) by NAT_D:18;
thus L1765: ( ( - 1 ) |^ ( ( ( R22 ^2 ) -' 1 ) div 8 ) ) = ( ( - 1 ) |^ ( ( ( ( 2 * ( 4 * ( D92 ^2 ) ) ) + ( 2 * ( 5 * D92 ) ) ) + ( 2 * 1 ) ) + 1 ) ) by L1764
.= ( ( ( - 1 ) |^ ( 2 * ( ( ( 4 * ( D92 ^2 ) ) + ( 5 * D92 ) ) + 1 ) ) ) * ( - 1 ) ) by NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( ( ( 4 * ( D92 ^2 ) ) + ( 5 * D92 ) ) + 1 ) ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( ( ( 4 * ( D92 ^2 ) ) + ( 5 * D92 ) ) + 1 ) ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ ( ( ( 4 * ( D92 ^2 ) ) + ( 5 * D92 ) ) + 1 ) ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( Lege (2 , R22) ) by L1763;
end;
suppose L1766: ( R22 mod 8 ) = 7;

L1767: R22 = ( ( 8 * D92 ) + 7 ) by L1766 , NAT_D:2;
L1768: ( R22 -' 1 ) = ( 2 * ( ( 4 * D92 ) + 3 ) ) by L1767 , L1576;
L1769: ( ( R22 -' 1 ) div 2 ) = ( ( 4 * D92 ) + 3 ) by L1768 , NAT_D:18;
L1770: ( 4 * D92 ) >= ( 2 * D92 ) by XREAL_1:64;
L1771: ( R22 div 4 ) = ( ( ( 4 * ( ( 2 * D92 ) + 1 ) ) + 3 ) div 4 ) by L1767
.= ( ( ( 2 * D92 ) + 1 ) + ( 3 div 4 ) ) by NAT_D:61
.= ( ( ( 2 * D92 ) + 1 ) + ( 0 ) ) by NAT_D:27;
L1772: D101 = ( ( ( 4 * D92 ) + 3 ) - ( ( 2 * D92 ) + 1 ) ) by L1771 , L1708 , L1769 , L1770 , XREAL_1:7 , XREAL_1:233
.= ( ( 2 * D92 ) + 2 );
L1773: ( Lege (2 , R22) ) = ( ( - 1 ) |^ ( 2 * ( D92 + 1 ) ) ) by L1772 , L1607 , L1609 , L1312
.= ( ( ( - 1 ) |^ 2 ) |^ ( D92 + 1 ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( D92 + 1 ) ) by WSIERP_1:1
.= ( 1 |^ ( D92 + 1 ) ) by NEWTON:10
.= 1 by NEWTON:10;
L1774: ( ( ( R22 ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( D92 ^2 ) ) ) + ( 8 * ( 14 * D92 ) ) ) + 49 ) - 1 ) div 8 ) by L1767 , NAT_1:12 , XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( D92 ^2 ) ) + ( 14 * D92 ) ) + 6 ) ) div 8 )
.= ( ( ( 8 * ( D92 ^2 ) ) + ( 14 * D92 ) ) + 6 ) by NAT_D:18;
thus L1775: ( ( - 1 ) |^ ( ( ( R22 ^2 ) -' 1 ) div 8 ) ) = ( ( - 1 ) |^ ( 2 * ( ( ( 4 * ( D92 ^2 ) ) + ( 7 * D92 ) ) + 3 ) ) ) by L1774
.= ( ( ( - 1 ) |^ 2 ) |^ ( ( ( 4 * ( D92 ^2 ) ) + ( 7 * D92 ) ) + 3 ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( ( ( 4 * ( D92 ^2 ) ) + ( 7 * D92 ) ) + 3 ) ) by WSIERP_1:1
.= ( 1 |^ ( ( ( 4 * ( D92 ^2 ) ) + ( 7 * D92 ) ) + 3 ) ) by NEWTON:10
.= ( Lege (2 , R22) ) by L1773 , NEWTON:10;
end;
end;
theorem
L1777: (for R22 being Prime holds ((R22 > 2 & (( R22 mod 8 ) = 1 or ( R22 mod 8 ) = 7)) implies 2 is_quadratic_residue_mod R22))
proof
let R22 being Prime;
assume that
L1778: R22 > 2
and
L1779: (( R22 mod 8 ) = 1 or ( R22 mod 8 ) = 7);
set D110 = ( R22 div 8 );
per cases  by L1779;
suppose L1780: ( R22 mod 8 ) = 1;

L1781: R22 = ( ( 8 * D110 ) + 1 ) by L1780 , NAT_D:2;
L1782: ( ( ( R22 ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( ( 8 * D110 ) ^2 ) + ( 2 * ( 8 * D110 ) ) ) + 1 ) -' 1 ) div 8 ) by L1781
.= ( ( 8 * ( ( 8 * ( D110 ^2 ) ) + ( 2 * D110 ) ) ) div 8 ) by NAT_D:34
.= ( 2 * ( ( 4 * ( D110 ^2 ) ) + D110 ) ) by NAT_D:18;
L1783: ( Lege (2 , R22) ) = ( ( - 1 ) |^ ( 2 * ( ( 4 * ( D110 ^2 ) ) + D110 ) ) ) by L1782 , L1778 , L1574
.= ( ( ( - 1 ) |^ 2 ) |^ ( ( 4 * ( D110 ^2 ) ) + D110 ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( ( 4 * ( D110 ^2 ) ) + D110 ) ) by WSIERP_1:1
.= ( 1 |^ ( ( 4 * ( D110 ^2 ) ) + D110 ) ) by NEWTON:10
.= 1 by NEWTON:10;
thus L1784: thesis by L1783 , L805;
end;
suppose L1785: ( R22 mod 8 ) = 7;

L1786: R22 = ( ( 8 * D110 ) + 7 ) by L1785 , NAT_D:2;
L1787: ( ( ( R22 ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( D110 ^2 ) ) ) + ( 8 * ( 14 * D110 ) ) ) + 49 ) - 1 ) div 8 ) by L1786 , NAT_1:12 , XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( D110 ^2 ) ) + ( 14 * D110 ) ) + 6 ) ) div 8 )
.= ( 2 * ( ( ( 4 * ( D110 ^2 ) ) + ( 7 * D110 ) ) + 3 ) ) by NAT_D:18;
L1788: ( Lege (2 , R22) ) = ( ( - 1 ) |^ ( 2 * ( ( ( 4 * ( D110 ^2 ) ) + ( 7 * D110 ) ) + 3 ) ) ) by L1787 , L1778 , L1574
.= ( ( ( - 1 ) |^ 2 ) |^ ( ( ( 4 * ( D110 ^2 ) ) + ( 7 * D110 ) ) + 3 ) ) by NEWTON:9
.= ( ( 1 |^ 2 ) |^ ( ( ( 4 * ( D110 ^2 ) ) + ( 7 * D110 ) ) + 3 ) ) by WSIERP_1:1
.= ( 1 |^ ( ( ( 4 * ( D110 ^2 ) ) + ( 7 * D110 ) ) + 3 ) ) by NEWTON:10
.= 1 by NEWTON:10;
thus L1789: thesis by L1788 , L805;
end;
end;
theorem
L1791: (for R22 being Prime holds ((R22 > 2 & (( R22 mod 8 ) = 3 or ( R22 mod 8 ) = 5)) implies (not 2 is_quadratic_residue_mod R22)))
proof
let R22 being Prime;
assume that
L1792: R22 > 2
and
L1793: (( R22 mod 8 ) = 3 or ( R22 mod 8 ) = 5);
set D111 = ( R22 div 8 );
per cases  by L1793;
suppose L1794: ( R22 mod 8 ) = 3;

L1795: R22 = ( ( 8 * D111 ) + 3 ) by L1794 , NAT_D:2;
L1796: ( ( ( R22 ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( D111 ^2 ) ) ) + ( 8 * ( 6 * D111 ) ) ) + ( 3 * 3 ) ) - 1 ) div 8 ) by L1795 , NAT_1:12 , XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( D111 ^2 ) ) + ( 6 * D111 ) ) + 1 ) ) div 8 )
.= ( ( ( 8 * ( D111 ^2 ) ) + ( 6 * D111 ) ) + 1 ) by NAT_D:18;
L1797: ( Lege (2 , R22) ) = ( ( - 1 ) |^ ( ( ( 8 * ( D111 ^2 ) ) + ( 6 * D111 ) ) + 1 ) ) by L1796 , L1792 , L1574
.= ( ( ( - 1 ) |^ ( 2 * ( ( 4 * ( D111 ^2 ) ) + ( 3 * D111 ) ) ) ) * ( - 1 ) ) by NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( ( 4 * ( D111 ^2 ) ) + ( 3 * D111 ) ) ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( ( 4 * ( D111 ^2 ) ) + ( 3 * D111 ) ) ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ ( ( 4 * ( D111 ^2 ) ) + ( 3 * D111 ) ) ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( - 1 );
L1798: ((not (2 is_quadratic_residue_mod R22 & ( 2 mod R22 ) <> ( 0 ))) & (not (2 is_quadratic_residue_mod R22 & ( 2 mod R22 ) = ( 0 )))) by L1797 , L805;
thus L1799: thesis by L1798;
end;
suppose L1800: ( R22 mod 8 ) = 5;

L1801: R22 = ( ( 8 * D111 ) + 5 ) by L1800 , NAT_D:2;
L1802: ( ( ( R22 ^2 ) -' 1 ) div 8 ) = ( ( ( ( ( 8 * ( 8 * ( D111 ^2 ) ) ) + ( 8 * ( 10 * D111 ) ) ) + 25 ) - 1 ) div 8 ) by L1801 , NAT_1:12 , XREAL_1:233
.= ( ( 8 * ( ( ( 8 * ( D111 ^2 ) ) + ( 10 * D111 ) ) + 3 ) ) div 8 )
.= ( ( ( 8 * ( D111 ^2 ) ) + ( 10 * D111 ) ) + 3 ) by NAT_D:18;
L1803: ( Lege (2 , R22) ) = ( ( - 1 ) |^ ( ( ( ( 2 * ( 4 * ( D111 ^2 ) ) ) + ( 2 * ( 5 * D111 ) ) ) + ( 2 * 1 ) ) + 1 ) ) by L1802 , L1792 , L1574
.= ( ( ( - 1 ) |^ ( 2 * ( ( ( 4 * ( D111 ^2 ) ) + ( 5 * D111 ) ) + 1 ) ) ) * ( - 1 ) ) by NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( ( ( 4 * ( D111 ^2 ) ) + ( 5 * D111 ) ) + 1 ) ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( ( ( 4 * ( D111 ^2 ) ) + ( 5 * D111 ) ) + 1 ) ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( 1 |^ ( ( ( 4 * ( D111 ^2 ) ) + ( 5 * D111 ) ) + 1 ) ) * ( - 1 ) ) by NEWTON:10
.= ( 1 * ( - 1 ) ) by NEWTON:10
.= ( - 1 );
L1804: ((not (2 is_quadratic_residue_mod R22 & ( 2 mod R22 ) <> ( 0 ))) & (not (2 is_quadratic_residue_mod R22 & ( 2 mod R22 ) = ( 0 )))) by L1803 , L805;
thus L1805: thesis by L1804;
end;
end;
theorem
L1807: (for B104 , B105 being Nat holds (( B104 mod 2 ) = ( B105 mod 2 ) implies ( ( - 1 ) |^ B104 ) = ( ( - 1 ) |^ B105 )))
proof
let C127 , C128 being Nat;
assume L1808: ( C127 mod 2 ) = ( C128 mod 2 );
L1809: C127 , C128 are_congruent_mod 2 by L1808 , NAT_D:64;
L1810: 2 divides ( C127 - C128 ) by L1809 , INT_2:15;
per cases ;
suppose L1811: C127 >= C128;

reconsider D112 = ( C127 - C128 ) as (Element of ( NAT )) by L1811 , NAT_1:21;
consider C129 being Nat such that L1812: D112 = ( 2 * C129 ) by L1810 , NAT_D:def 3;
L1813: ( ( - 1 ) |^ C127 ) = ( ( - 1 ) |^ ( C128 + ( 2 * C129 ) ) ) by L1812
.= ( ( ( - 1 ) |^ C128 ) * ( ( - 1 ) |^ ( 2 * C129 ) ) ) by NEWTON:8
.= ( ( ( - 1 ) |^ C128 ) * ( ( ( - 1 ) |^ 2 ) |^ C129 ) ) by NEWTON:9
.= ( ( ( - 1 ) |^ C128 ) * ( ( 1 |^ 2 ) |^ C129 ) ) by WSIERP_1:1
.= ( ( ( - 1 ) |^ C128 ) * ( 1 |^ C129 ) ) by NEWTON:10
.= ( ( ( - 1 ) |^ C128 ) * 1 ) by NEWTON:10;
thus L1814: thesis by L1813;
end;
suppose L1815: C127 < C128;

reconsider D113 = ( C128 - C127 ) as (Element of ( NAT )) by L1815 , NAT_1:21;
L1816: 2 divides ( - ( C127 - C128 ) ) by L1810 , INT_2:10;
consider C130 being Nat such that L1817: D113 = ( 2 * C130 ) by L1816 , NAT_D:def 3;
L1818: ( ( - 1 ) |^ C128 ) = ( ( - 1 ) |^ ( C127 + ( 2 * C130 ) ) ) by L1817
.= ( ( ( - 1 ) |^ C127 ) * ( ( - 1 ) |^ ( 2 * C130 ) ) ) by NEWTON:8
.= ( ( ( - 1 ) |^ C127 ) * ( ( ( - 1 ) |^ 2 ) |^ C130 ) ) by NEWTON:9
.= ( ( ( - 1 ) |^ C127 ) * ( ( 1 |^ 2 ) |^ C130 ) ) by WSIERP_1:1
.= ( ( ( - 1 ) |^ C127 ) * ( 1 |^ C130 ) ) by NEWTON:10
.= ( ( ( - 1 ) |^ C127 ) * 1 ) by NEWTON:10;
thus L1819: thesis by L1818;
end;
end;
theorem
L1821: (for R33 being (FinSequence of ( REAL )) holds (for R34 being (FinSequence of ( REAL )) holds (for R35 being (FinSequence of ( REAL )) holds (for R36 being (FinSequence of ( REAL )) holds ((( len R33 ) = ( len R35 ) & ( len R34 ) = ( len R36 )) implies ( ( R33 ^ R34 ) - ( R35 ^ R36 ) ) = ( ( R33 - R35 ) ^ ( R34 - R36 ) ))))))
proof
let R33 being (FinSequence of ( REAL ));
let R34 being (FinSequence of ( REAL ));
let R35 being (FinSequence of ( REAL ));
let R36 being (FinSequence of ( REAL ));
assume that
L1822: ( len R33 ) = ( len R35 )
and
L1823: ( len R34 ) = ( len R36 );
L1824: ( len ( R33 - R35 ) ) = ( len R33 ) by L1822 , TOPREAL7:7;
L1825: ( len ( R33 ^ R34 ) ) = ( ( len R35 ) + ( len R36 ) ) by L1822 , L1823 , FINSEQ_1:22;
L1826: ( len ( R33 ^ R34 ) ) = ( len ( R35 ^ R36 ) ) by L1825 , FINSEQ_1:22;
L1827: ( len ( ( R33 ^ R34 ) - ( R35 ^ R36 ) ) ) = ( len ( R33 ^ R34 ) ) by L1826 , TOPREAL7:7;
L1828: ( len ( R34 - R36 ) ) = ( len R34 ) by L1823 , TOPREAL7:7;
L1829: ( len ( ( R33 - R35 ) ^ ( R34 - R36 ) ) ) = ( ( len R33 ) + ( len R34 ) ) by L1828 , L1824 , FINSEQ_1:22;
L1830: ( len ( ( R33 ^ R34 ) - ( R35 ^ R36 ) ) ) = ( len ( ( R33 - R35 ) ^ ( R34 - R36 ) ) ) by L1829 , L1827 , FINSEQ_1:22;
L1831: ( dom ( ( R33 ^ R34 ) - ( R35 ^ R36 ) ) ) = ( dom ( ( R33 - R35 ) ^ ( R34 - R36 ) ) ) by L1830 , FINSEQ_3:29;
L1832: (for B106 being Nat holds (B106 in ( dom ( ( R33 - R35 ) ^ ( R34 - R36 ) ) ) implies ( ( ( R33 - R35 ) ^ ( R34 - R36 ) ) . B106 ) = ( ( ( R33 ^ R34 ) - ( R35 ^ R36 ) ) . B106 )))
proof
let C131 being Nat;
assume L1833: C131 in ( dom ( ( R33 - R35 ) ^ ( R34 - R36 ) ) );
per cases  by L1833 , FINSEQ_1:25;
suppose L1834: C131 in ( dom ( R33 - R35 ) );

L1835: ( ( ( R33 - R35 ) ^ ( R34 - R36 ) ) . C131 ) = ( ( R33 - R35 ) . C131 ) by L1834 , FINSEQ_1:def 7
.= ( ( R33 . C131 ) - ( R35 . C131 ) ) by L1834 , VALUED_1:13;
L1836: ( dom R33 ) = ( dom ( R33 - R35 ) ) by L1822 , TOPREAL7:7;
L1837: ( dom R35 ) = ( dom ( R33 - R35 ) ) by L1822 , L1824 , FINSEQ_3:29;
L1838: ( ( ( R33 ^ R34 ) - ( R35 ^ R36 ) ) . C131 ) = ( ( ( R33 ^ R34 ) . C131 ) - ( ( R35 ^ R36 ) . C131 ) ) by L1831 , L1834 , FINSEQ_2:15 , VALUED_1:13
.= ( ( R33 . C131 ) - ( ( R35 ^ R36 ) . C131 ) ) by L1834 , L1836 , FINSEQ_1:def 7
.= ( ( R33 . C131 ) - ( R35 . C131 ) ) by L1834 , L1837 , FINSEQ_1:def 7;
thus L1839: thesis by L1838 , L1835;
end;
suppose L1840: (ex B107 being Nat st (B107 in ( dom ( R34 - R36 ) ) & C131 = ( ( len ( R33 - R35 ) ) + B107 )));

consider R14 being Nat such that L1841: R14 in ( dom ( R34 - R36 ) ) and L1842: C131 = ( ( len ( R33 - R35 ) ) + R14 ) by L1840;
L1843: R14 in ( dom R34 ) by L1823 , L1841 , TOPREAL7:7;
L1844: ( ( R33 ^ R34 ) . C131 ) = ( R34 . R14 ) by L1843 , L1824 , L1842 , FINSEQ_1:def 7;
L1845: R14 in ( dom R36 ) by L1823 , L1828 , L1841 , FINSEQ_3:29;
L1846: ( ( R35 ^ R36 ) . C131 ) = ( R36 . R14 ) by L1845 , L1822 , L1824 , L1842 , FINSEQ_1:def 7;
L1847: ( ( ( R33 - R35 ) ^ ( R34 - R36 ) ) . C131 ) = ( ( R34 - R36 ) . R14 ) by L1841 , L1842 , FINSEQ_1:def 7
.= ( ( R34 . R14 ) - ( R36 . R14 ) ) by L1841 , VALUED_1:13;
thus L1848: thesis by L1847 , L1831 , L1841 , L1842 , L1844 , L1846 , FINSEQ_1:28 , VALUED_1:13;
end;
end;
thus L1850: thesis by L1832 , L1831 , FINSEQ_1:13;
end;
theorem
L1851: (for B108 being (FinSequence of ( REAL )) holds (for B109 being Real holds ( Sum ( ( ( len B108 ) |-> B109 ) - B108 ) ) = ( ( ( len B108 ) * B109 ) - ( Sum B108 ) )))
proof
defpred S10[ Nat ] means (for B110 being (FinSequence of ( REAL )) holds (for B111 being Real holds (( len B110 ) = $1 implies ( Sum ( ( $1 |-> B111 ) - B110 ) ) = ( ( $1 * B111 ) - ( Sum B110 ) ))));
L1852: (for B112 being (Element of ( NAT )) holds (S10[ B112 ] implies S10[ ( B112 + 1 ) ]))
proof
let C132 being (Element of ( NAT ));
assume L1853: S10[ C132 ];
L1854: S10[ ( C132 + 1 ) ]
proof
let C133 being (FinSequence of ( REAL ));
let C134 being Real;
L1855: ( len <* C134 *> ) = 1 by FINSEQ_1:39;
assume L1856: ( len C133 ) = ( C132 + 1 );
L1857: C133 <> ( {} ) by L1856;
consider C135 being (FinSequence of ( REAL )), C136 being (Element of ( REAL )) such that L1858: C133 = ( C135 ^ <* C136 *> ) by L1857 , HILBERT2:4;
L1859: ( C132 + 1 ) = ( ( len C135 ) + 1 ) by L1856 , L1858 , FINSEQ_2:16;
L1860: ( len ( C132 |-> C134 ) ) = ( len C135 ) by L1859 , CARD_1:def 7;
L1861: ( len <* C136 *> ) = 1 by FINSEQ_1:39;
L1862: ( ( ( C132 + 1 ) |-> C134 ) - C133 ) = ( ( ( C132 |-> C134 ) ^ <* C134 *> ) - ( C135 ^ <* C136 *> ) ) by L1858 , FINSEQ_2:60
.= ( ( ( C132 |-> C134 ) - C135 ) ^ ( <* C134 *> - <* C136 *> ) ) by L1860 , L1861 , L1855 , L1821
.= ( ( ( C132 |-> C134 ) - C135 ) ^ <* ( C134 - C136 ) *> ) by RVSUM_1:29;
thus L1863: ( Sum ( ( ( C132 + 1 ) |-> C134 ) - C133 ) ) = ( ( Sum ( ( C132 |-> C134 ) - C135 ) ) + ( C134 - C136 ) ) by L1862 , RVSUM_1:74
.= ( ( ( C132 * C134 ) - ( Sum C135 ) ) + ( C134 - C136 ) ) by L1853 , L1859
.= ( ( ( C132 + 1 ) * C134 ) - ( ( Sum C135 ) + C136 ) )
.= ( ( ( C132 + 1 ) * C134 ) - ( Sum C133 ) ) by L1858 , RVSUM_1:74;
end;
thus L1864: thesis by L1854;
end;
L1865: S10[ ( 0 ) ]
proof
let C137 being (FinSequence of ( REAL ));
let C138 being Real;
assume L1866: ( len C137 ) = ( 0 );
L1867: ( Sum C137 ) = ( 0 ) by L1866 , PROB_3:62;
thus L1868: thesis by L1867 , RVSUM_1:28 , RVSUM_1:72;
end;
L1869: (for B113 being (Element of ( NAT )) holds S10[ B113 ]) from NAT_1:sch 1(L1865 , L1852);
thus L1870: thesis by L1869;
end;
definition
let R37 being  finite set;
let R38 being (FinSequence of ( bool R37 ));
redefine func Card R38 ->  Cardinal-yielding (FinSequence of ( NAT ));

coherence
proof
L1871: ( rng ( Card R38 ) ) c= ( NAT )
proof
let C139 being set;
assume L1872: C139 in ( rng ( Card R38 ) );
consider C140 being set such that L1873: C140 in ( dom ( Card R38 ) ) and L1874: C139 = ( ( Card R38 ) . C140 ) by L1872 , FUNCT_1:def 3;
L1875: C140 in ( dom R38 ) by L1873 , CARD_3:def 2;
L1876: ( R38 . C140 ) in ( rng R38 ) by L1875 , FUNCT_1:3;
reconsider D114 = ( R38 . C140 ) as  finite set by L1876;
L1877: C139 = ( card D114 ) by L1874 , L1875 , CARD_3:def 2;
thus L1878: thesis by L1877;
end;
thus L1879: thesis by L1871 , FINSEQ_1:def 4;
end;
end;
theorem
L1881: (for R16 being Nat holds (for R37 being  finite set holds (for B114 being (FinSequence of ( bool R37 )) holds ((( len B114 ) = R16 & (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom B114 ) & R14 in ( dom B114 ) & R13 <> R14) implies ( B114 . R13 ) misses ( B114 . R14 ))))) implies ( card ( union ( rng B114 ) ) ) = ( Sum ( Card B114 ) )))))
proof
let R16 being Nat;
let R37 being  finite set;
defpred S11[ Nat ] means (for B115 being (FinSequence of ( bool R37 )) holds ((( len B115 ) = $1 & (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom B115 ) & R14 in ( dom B115 ) & R13 <> R14) implies ( B115 . R13 ) misses ( B115 . R14 ))))) implies ( card ( union ( rng B115 ) ) ) = ( Sum ( Card B115 ) )));
L1882: (for B116 being (Element of ( NAT )) holds (S11[ B116 ] implies S11[ ( B116 + 1 ) ]))
proof
let C141 being (Element of ( NAT ));
assume L1883: S11[ C141 ];
L1884: S11[ ( C141 + 1 ) ]
proof
let C142 being (FinSequence of ( bool R37 ));
assume that
L1885: ( len C142 ) = ( C141 + 1 )
and
L1886: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom C142 ) & R14 in ( dom C142 ) & R13 <> R14) implies ( C142 . R13 ) misses ( C142 . R14 ))));
L1887: C142 <> ( {} ) by L1885;
consider C143 being (FinSequence of ( bool R37 )), C144 being (Element of ( bool R37 )) such that L1888: C142 = ( C143 ^ <* C144 *> ) by L1887 , HILBERT2:4;
reconsider D115 = ( union ( rng C143 ) ) as  finite set;
L1889: ( union ( rng C142 ) ) = ( union ( ( rng C143 ) \/ ( rng <* C144 *> ) ) ) by L1888 , FINSEQ_1:31
.= ( union ( ( rng C143 ) \/ { C144 } ) ) by FINSEQ_1:38
.= ( D115 \/ ( union { C144 } ) ) by ZFMISC_1:78
.= ( D115 \/ C144 ) by ZFMISC_1:25;
L1890: ( C141 + 1 ) = ( ( len C143 ) + 1 ) by L1885 , L1888 , FINSEQ_2:16;
L1891: D115 misses C144
proof
L1892: ( C141 + 1 ) in ( dom C142 ) by L1885 , L1887 , FINSEQ_5:6;
assume L1893: D115 meets C144;
consider C145 being set such that L1894: C145 in ( D115 /\ C144 ) by L1893 , XBOOLE_0:4;
L1895: C145 in D115 by L1894 , XBOOLE_0:def 4;
consider C146 being set such that L1896: C145 in C146 and L1897: C146 in ( rng C143 ) by L1895 , TARSKI:def 4;
consider C147 being Nat such that L1898: C147 in ( dom C143 ) and L1899: ( C143 . C147 ) = C146 by L1897 , FINSEQ_2:10;
L1900: C147 <= C141 by L1890 , L1898 , FINSEQ_3:25;
L1901: C147 < ( C141 + 1 ) by L1900 , NAT_1:13;
L1902: C147 in ( dom C142 ) by L1888 , L1898 , FINSEQ_2:15;
L1903: ( C142 . ( C141 + 1 ) ) misses ( C142 . C147 ) by L1902 , L1886 , L1901 , L1892;
L1904: C144 misses ( C142 . C147 ) by L1903 , L1888 , L1890 , FINSEQ_1:42;
L1905: C144 misses C146 by L1904 , L1888 , L1898 , L1899 , FINSEQ_1:def 7;
L1906: C145 in ( C144 \/ C146 ) by L1896 , XBOOLE_0:def 3;
L1907: (not C145 in C144) by L1906 , L1896 , L1905 , XBOOLE_0:5;
thus L1908: contradiction by L1907 , L1894 , XBOOLE_0:def 4;
end;
L1909: ( ( card D115 ) + ( card C144 ) ) = ( card ( D115 \/ C144 ) ) by L1891 , CARD_2:40;
reconsider D116 = <* ( card C144 ) *> as (FinSequence of ( NAT ));
L1910: ( Card C142 ) = ( ( Card C143 ) ^ ( Card <* C144 *> ) ) by L1888 , PRE_POLY:25
.= ( ( Card C143 ) ^ D116 ) by PRE_POLY:24;
L1911: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom C143 ) & R14 in ( dom C143 ) & R13 <> R14) implies ( C143 . R13 ) misses ( C143 . R14 ))))
proof
let R13 being Nat;
let R14 being Nat;
assume that
L1912: R13 in ( dom C143 )
and
L1913: R14 in ( dom C143 )
and
L1914: R13 <> R14;
L1915: ( C142 . R14 ) = ( C143 . R14 ) by L1888 , L1913 , FINSEQ_1:def 7;
L1916: R14 in ( dom C142 ) by L1888 , L1913 , FINSEQ_2:15;
L1917: R13 in ( dom C142 ) by L1888 , L1912 , FINSEQ_2:15;
L1918: ( C142 . R13 ) = ( C143 . R13 ) by L1888 , L1912 , FINSEQ_1:def 7;
thus L1919: thesis by L1918 , L1886 , L1914 , L1915 , L1917 , L1916;
end;
L1920: ( card ( union ( rng C143 ) ) ) = ( Sum ( Card C143 ) ) by L1911 , L1883 , L1890;
thus L1921: thesis by L1920 , L1909 , L1910 , L1889 , RVSUM_1:74;
end;
thus L1922: thesis by L1884;
end;
L1923: S11[ ( 0 ) ]
proof
let C148 being (FinSequence of ( bool R37 ));
assume that
L1924: ( len C148 ) = ( 0 )
and
L1925: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom C148 ) & R14 in ( dom C148 ) & R13 <> R14) implies ( C148 . R13 ) misses ( C148 . R14 ))));
L1926: ( Card ( {} ) ) = ( {} );
L1927: C148 = ( {} ) by L1924;
thus L1928: thesis by L1927 , L1926 , CARD_1:27 , RVSUM_1:72 , ZFMISC_1:2;
end;
L1929: (for B117 being (Element of ( NAT )) holds S11[ B117 ]) from NAT_1:sch 1(L1923 , L1882);
thus L1930: thesis by L1929;
end;
L1931: (for R30 being (FinSequence of ( NAT )) holds ( Sum R30 ) is (Element of ( NAT )));
::$N Law of Quadratic Reciprocity
theorem
L1932: (for R22 being Prime holds (for R39 being Prime holds ((R22 > 2 & R39 > 2 & R22 <> R39) implies ( ( Lege (R22 , R39) ) * ( Lege (R39 , R22) ) ) = ( ( - 1 ) |^ ( ( ( R22 -' 1 ) div 2 ) * ( ( R39 -' 1 ) div 2 ) ) ))))
proof
let R22 being Prime;
let R39 being Prime;
assume that
L1933: R22 > 2
and
L1934: R39 > 2
and
L1935: R22 <> R39;
L1936: R39 , R22 are_relative_prime  by L1935 , INT_2:30;
L1937: ( R39 gcd R22 ) = 1 by L1936 , INT_2:def 3;
reconsider D117 = R22 , D118 = R39 as  prime (Element of ( NAT )) by ORDINAL1:def 12;
set D119 = ( ( D117 -' 1 ) div 2 );
L1938: D117 > 1 by INT_2:def 4;
L1939: ( D117 -' 1 ) = ( D117 - 1 ) by L1938 , XREAL_1:233;
L1940: ( D117 -' 1 ) > ( 0 ) by L1939 , L1938 , XREAL_1:50;
L1941: D117 is  odd by L1933 , PEPIN:17;
L1942: ( D117 -' 1 ) is  even by L1941 , L1939 , HILBERT3:2;
L1943: 2 divides ( D117 -' 1 ) by L1942 , PEPIN:22;
L1944: ( D117 -' 1 ) = ( 2 * D119 ) by L1943 , NAT_D:3;
L1945: D119 divides ( D117 -' 1 ) by L1944 , NAT_D:def 3;
L1946: D119 <= ( D117 -' 1 ) by L1945 , L1940 , NAT_D:7;
L1947: D119 < D117 by L1946 , L1939 , XREAL_1:146 , XXREAL_0:2;
set D120 = ( D118 * ( idseq D119 ) );
L1948: (for R13 being Nat holds (R13 in ( dom D120 ) implies ( D120 . R13 ) = ( D118 * R13 )))
proof
let R13 being Nat;
assume L1949: R13 in ( dom D120 );
L1950: R13 in ( dom ( idseq D119 ) ) by L1949 , VALUED_1:def 5;
L1951: R13 in ( Seg ( len ( idseq D119 ) ) ) by L1950 , FINSEQ_1:def 3;
L1952: R13 is (Element of ( Seg D119 )) by L1951 , CARD_1:def 7;
L1953: ( D120 . R13 ) = ( D118 * ( ( idseq D119 ) . R13 ) ) by L1949 , VALUED_1:def 5;
thus L1954: thesis by L1953 , L1952 , FINSEQ_2:49;
end;
L1955: (for B118 being Nat holds (B118 in ( dom D120 ) implies ( D120 . B118 ) in ( NAT )));
L1956: ( dom D120 ) = ( dom ( idseq D119 ) ) by VALUED_1:def 5;
L1957: ( len D120 ) = ( len ( idseq D119 ) ) by L1956 , FINSEQ_3:29;
L1958: ( len D120 ) = D119 by L1957 , CARD_1:def 7;
set D121 = ( ( D118 -' 1 ) div 2 );
set D122 = ( D117 * ( idseq D121 ) );
L1959: (for R13 being Nat holds (R13 in ( dom D122 ) implies ( D122 . R13 ) = ( D117 * R13 )))
proof
let R13 being Nat;
assume L1960: R13 in ( dom D122 );
L1961: R13 in ( dom ( idseq D121 ) ) by L1960 , VALUED_1:def 5;
L1962: R13 in ( Seg ( len ( idseq D121 ) ) ) by L1961 , FINSEQ_1:def 3;
L1963: R13 is (Element of ( Seg D121 )) by L1962 , CARD_1:def 7;
L1964: ( D122 . R13 ) = ( D117 * ( ( idseq D121 ) . R13 ) ) by L1960 , VALUED_1:def 5;
thus L1965: thesis by L1964 , L1963 , FINSEQ_2:49;
end;
L1966: (for B119 being Nat holds (B119 in ( dom D122 ) implies ( D122 . B119 ) in ( NAT )));
L1967: ( dom D122 ) = ( dom ( idseq D121 ) ) by VALUED_1:def 5;
L1968: ( len D122 ) = ( len ( idseq D121 ) ) by L1967 , FINSEQ_3:29;
L1969: ( len D122 ) = D121 by L1968 , CARD_1:def 7;
reconsider D123 = D122 as (FinSequence of ( NAT )) by L1966 , FINSEQ_2:12;
set D124 = ( D123 mod D118 );
set D125 = ( Sgm ( rng D124 ) );
L1970: ( len D124 ) = ( len D123 ) by EULER_2:def 1;
L1971: ( dom D123 ) = ( dom D124 ) by L1970 , FINSEQ_3:29;
set D126 = { B120 where B120 is (Element of ( NAT )) : (B120 in ( rng D125 ) & B120 > ( D118 / 2 )) };
L1972: (for B121 being set holds (B121 in D126 implies B121 in ( rng D125 )))
proof
let C149 being set;
assume L1973: C149 in D126;
L1974: (ex B122 being (Element of ( NAT )) st (C149 = B122 & B122 in ( rng D125 ) & B122 > ( D118 / 2 ))) by L1973;
thus L1975: thesis by L1974;
end;
L1976: D126 c= ( rng D125 ) by L1972 , TARSKI:def 3;
reconsider D127 = D120 as (FinSequence of ( NAT )) by L1955 , FINSEQ_2:12;
deffunc H7(Nat) = ( ( D127 . $1 ) div D117 );
consider C150 being FinSequence such that L1977: (( len C150 ) = D119 & (for B123 being Nat holds (B123 in ( dom C150 ) implies ( C150 . B123 ) = H7(B123)))) from FINSEQ_1:sch 2;
L1978: D118 > 1 by INT_2:def 4;
L1979: ( D118 -' 1 ) = ( D118 - 1 ) by L1978 , XREAL_1:233;
L1980: ( D118 -' 1 ) > ( 0 ) by L1979 , L1978 , XREAL_1:50;
L1981: D118 >= ( 2 + 1 ) by L1934 , NAT_1:13;
L1982: ( D118 - 1 ) >= ( 3 - 1 ) by L1981 , XREAL_1:9;
L1983: D121 >= 1 by L1982 , L1979 , NAT_2:13;
L1984: ( len D124 ) >= 1 by L1983 , L1969 , EULER_2:def 1;
L1985: D124 <> ( {} ) by L1984;
L1986: ( rng D124 ) is  finite non  empty  finite non  empty  finite non  empty  finite non  empty (Subset of ( NAT )) by L1985 , FINSEQ_1:def 4;
consider C151 being (Element of ( NAT )) such that L1987: ( rng D124 ) c= ( ( Seg C151 ) \/ { ( 0 ) } ) by L1986 , HEYTING3:1;
deffunc H8(Nat) = ( ( D123 . $1 ) div D118 );
consider C152 being FinSequence such that L1988: (( len C152 ) = D121 & (for B124 being Nat holds (B124 in ( dom C152 ) implies ( C152 . B124 ) = H8(B124)))) from FINSEQ_1:sch 2;
L1989: (for B125 being Nat holds (B125 in ( dom C152 ) implies ( C152 . B125 ) in ( NAT )))
proof
let C153 being Nat;
assume L1990: C153 in ( dom C152 );
L1991: ( C152 . C153 ) = ( ( D123 . C153 ) div D118 ) by L1990 , L1988;
thus L1992: thesis by L1991;
end;
reconsider D128 = C152 as (FinSequence of ( NAT )) by L1989 , FINSEQ_2:12;
L1993: ( dom D123 ) = ( dom D128 ) by L1969 , L1988 , FINSEQ_3:29;
L1994: (for R13 being Nat holds (R13 in ( dom D123 ) implies ( D123 . R13 ) = ( ( ( D128 . R13 ) * D118 ) + ( D124 . R13 ) )))
proof
let R13 being Nat;
assume L1995: R13 in ( dom D123 );
L1996: ( D124 . R13 ) = ( ( D123 . R13 ) mod D118 ) by L1995 , EULER_2:def 1;
L1997: ( D128 . R13 ) = ( ( D123 . R13 ) div D118 ) by L1988 , L1993 , L1995;
thus L1998: thesis by L1997 , L1996 , NAT_D:2;
end;
L1999: D118 is  odd by L1934 , PEPIN:17;
L2000: ( D118 -' 1 ) is  even by L1999 , L1979 , HILBERT3:2;
L2001: 2 divides ( D118 -' 1 ) by L2000 , PEPIN:22;
L2002: ( D118 -' 1 ) = ( 2 * D121 ) by L2001 , NAT_D:3;
L2003: D121 divides ( D118 -' 1 ) by L2002 , NAT_D:def 3;
L2004: D121 <= ( D118 -' 1 ) by L2003 , L1980 , NAT_D:7;
L2005: D121 < D118 by L2004 , L1979 , XREAL_1:146 , XXREAL_0:2;
L2006: (not ( 0 ) in ( rng D124 ))
proof
assume L2007: ( 0 ) in ( rng D124 );
consider C154 being Nat such that L2008: C154 in ( dom D124 ) and L2009: ( D124 . C154 ) = ( 0 ) by L2007 , FINSEQ_2:10;
L2010: C154 in ( dom D123 ) by L1970 , L2008 , FINSEQ_3:29;
L2011: ( D123 . C154 ) = ( ( ( D128 . C154 ) * D118 ) + ( 0 ) ) by L2010 , L1994 , L2009;
L2012: C154 in ( dom D123 ) by L1970 , L2008 , FINSEQ_3:29;
L2013: ( D117 * C154 ) = ( ( D128 . C154 ) * D118 ) by L2012 , L1959 , L2011;
L2014: D118 divides ( D117 * C154 ) by L2013 , NAT_D:def 3;
L2015: C154 >= 1 by L2008 , FINSEQ_3:25;
L2016: D118 <= C154 by L2015 , L1936 , L2014 , NAT_D:7 , PEPIN:3;
L2017: C154 <= D121 by L1969 , L1970 , L2008 , FINSEQ_3:25;
thus L2018: contradiction by L2017 , L2005 , L2016 , XXREAL_0:2;
end;
L2019: { ( 0 ) } misses ( rng D124 ) by L2006 , ZFMISC_1:50;
L2020: D125 is  one-to-one by L2019 , L1987 , FINSEQ_3:92 , XBOOLE_1:73;
L2021: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom D123 ) & R14 in ( dom D123 ) & D118 divides ( ( D123 . R13 ) - ( D123 . R14 ) )) implies R13 = R14)))
proof
L2022: D118 , (D117 qua Integer) are_relative_prime  by L1935 , INT_2:30;
let R13 being Nat;
let R14 being Nat;
assume that
L2023: R13 in ( dom D123 )
and
L2024: R14 in ( dom D123 )
and
L2025: D118 divides ( ( D123 . R13 ) - ( D123 . R14 ) );
L2026: ( D123 . R14 ) = ( D117 * R14 ) by L1959 , L2024;
L2027: ( D123 . R13 ) = ( D117 * R13 ) by L1959 , L2023;
L2028: D118 divides ( ( R13 - R14 ) * D117 ) by L2027 , L2025 , L2026;
L2029:
now
assume L2030: R13 <> R14;
L2031: ( R13 - R14 ) <> ( 0 ) by L2030;
L2032: ( abs D118 ) <= ( abs ( R13 - R14 ) ) by L2031 , L2028 , L2022 , INT_2:25 , INT_4:6;
L2033: D118 <= ( abs ( R13 - R14 ) ) by L2032 , ABSVALUE:def 1;
L2034: R14 >= 1 by L2024 , FINSEQ_3:25;
L2035: R13 >= 1 by L2023 , FINSEQ_3:25;
L2036: R14 <= D121 by L1969 , L2024 , FINSEQ_3:25;
L2037: ( R13 - R14 ) >= ( 1 - D121 ) by L2036 , L2035 , XREAL_1:13;
L2038: ( D121 - 1 ) < D118 by L2005 , XREAL_1:147;
L2039: R13 <= D121 by L1969 , L2023 , FINSEQ_3:25;
L2040: ( R13 - R14 ) <= ( D121 - 1 ) by L2039 , L2034 , XREAL_1:13;
L2041: ( R13 - R14 ) < D118 by L2040 , L2038 , XXREAL_0:2;
L2042: ( - ( D121 - 1 ) ) > ( - D118 ) by L2038 , XREAL_1:24;
L2043: ( R13 - R14 ) > ( - D118 ) by L2042 , L2037 , XXREAL_0:2;
thus L2044: contradiction by L2043 , L2033 , L2041 , SEQ_2:1;
end;
thus L2045: thesis by L2029;
end;
L2046: (for B126 , B127 being set holds ((B126 in ( dom D124 ) & B127 in ( dom D124 ) & ( D124 . B126 ) = ( D124 . B127 )) implies B126 = B127))
proof
let C155 , C156 being set;
assume that
L2047: C155 in ( dom D124 )
and
L2048: C156 in ( dom D124 )
and
L2049: ( D124 . C155 ) = ( D124 . C156 );
reconsider D129 = C155 , D130 = C156 as (Element of ( NAT )) by L2047 , L2048;
L2050: ( D123 . D130 ) = ( ( ( D128 . D130 ) * D118 ) + ( D124 . D130 ) ) by L1971 , L1994 , L2048;
L2051: ( D123 . D129 ) = ( ( ( D128 . D129 ) * D118 ) + ( D124 . D129 ) ) by L1971 , L1994 , L2047;
L2052: ( ( D123 . D129 ) - ( D123 . D130 ) ) = ( ( ( D128 . D129 ) - ( D128 . D130 ) ) * D118 ) by L2051 , L2049 , L2050;
L2053: D118 divides ( ( D123 . D129 ) - ( D123 . D130 ) ) by L2052 , INT_1:def 3;
thus L2054: thesis by L2053 , L2021 , L1971 , L2047 , L2048;
end;
L2055: D124 is  one-to-one by L2046 , FUNCT_1:def 4;
L2056: ( len D124 ) = ( card ( rng D124 ) ) by L2055 , FINSEQ_4:62;
L2057: ( len D125 ) = D121 by L2056 , L1969 , L1970 , L1987 , L2019 , FINSEQ_3:39 , XBOOLE_1:73;
reconsider D131 = D126 as  finite (Subset of ( NAT )) by L1976 , XBOOLE_1:1;
set D132 = ( card D131 );
reconsider D133 = ( ( rng D125 ) \ D131 ) as  finite (Subset of ( NAT ));
L2058: D124 is (Element of ( ( NAT ) * )) by FINSEQ_1:def 11;
L2059: ( len D124 ) = D121 by L1969 , EULER_2:def 1;
L2060: D124 in ( D121 -tuples_on ( NAT ) ) by L2059 , L2058;
L2061: D124 is (Element of ( D121 -tuples_on ( REAL ) )) by L2060 , FINSEQ_2:109;
L2062: (for B128 being Nat holds (B128 in ( dom ( idseq D121 ) ) implies ( ( idseq D121 ) . B128 ) in ( NAT )));
L2063: ( idseq D121 ) is (FinSequence of ( NAT )) by L2062 , FINSEQ_2:12;
reconsider D134 = ( Sum ( idseq D121 ) ) as (Element of ( NAT )) by L2063 , L1931;
L2064: 2 , D118 are_relative_prime  by L1934 , EULER_1:2;
L2065: ( dom ( D118 * D128 ) ) = ( dom D128 ) by VALUED_1:def 5;
L2066: ( len ( D118 * D128 ) ) = D121 by L2065 , L1988 , FINSEQ_3:29;
L2067: ( D118 * D128 ) is (Element of ( ( NAT ) * )) by FINSEQ_1:def 11;
L2068: ( D118 * D128 ) in ( D121 -tuples_on ( NAT ) ) by L2067 , L2066;
L2069: ( D118 * D128 ) is (Element of ( D121 -tuples_on ( REAL ) )) by L2068 , FINSEQ_2:109;
L2070: ( dom ( ( D118 * D128 ) + D124 ) ) = ( ( dom ( D118 * D128 ) ) /\ ( dom D124 ) ) by VALUED_1:def 1
.= ( ( dom D128 ) /\ ( dom D124 ) ) by VALUED_1:def 5
.= ( dom D123 ) by L1971 , L1993;
L2071: (for B129 being Nat holds (B129 in ( dom D123 ) implies ( D123 . B129 ) = ( ( ( D118 * D128 ) + D124 ) . B129 )))
proof
let C157 being Nat;
assume L2072: C157 in ( dom D123 );
L2073: C157 in ( dom ( D118 * D128 ) ) by L2072 , L1993 , VALUED_1:def 5;
L2074: ( ( ( D118 * D128 ) + D124 ) . C157 ) = ( ( ( D118 * D128 ) . C157 ) + ( D124 . C157 ) ) by L2070 , L2072 , VALUED_1:def 1;
thus L2075: ( ( ( D118 * D128 ) + D124 ) . C157 ) = ( ( D118 * ( D128 . C157 ) ) + ( D124 . C157 ) ) by L2074 , L2073 , VALUED_1:def 5
.= ( D123 . C157 ) by L1994 , L2072;
end;
L2076: D123 = ( ( D118 * D128 ) + D124 ) by L2071 , L2070 , FINSEQ_1:13;
L2077: ( Sum D123 ) = ( ( Sum ( D118 * D128 ) ) + ( Sum D124 ) ) by L2076 , L2069 , L2061 , RVSUM_1:89
.= ( ( D118 * ( Sum D128 ) ) + ( Sum D124 ) ) by RVSUM_1:87;
L2078: ( rng D124 ) c= ( Seg C151 ) by L1987 , L2019 , XBOOLE_1:73;
L2079: ( rng D125 ) = ( rng D124 ) by L2078 , FINSEQ_1:def 13;
L2080: D131 c= ( Seg C151 ) by L2079 , L2078 , L1976 , XBOOLE_1:1;
L2081: ( len D124 ) = ( card ( rng D125 ) ) by L2055 , L2079 , FINSEQ_4:62;
L2082: D132 <= ( card ( rng D125 ) ) by L1976 , NAT_1:43;
L2083: D132 <= D121 by L2082 , L1969 , L2081 , EULER_2:def 1;
reconsider D135 = ( D121 - D132 ) as (Element of ( NAT )) by L2083 , NAT_1:21;
L2084: D125 = ( ( D125 | D135 ) ^ ( D125 /^ D135 ) ) by RFINSEQ:8;
L2085: ( D125 /^ D135 ) is  one-to-one by L2084 , L2020 , FINSEQ_3:91;
L2086: D121 = ( ( ( D118 -' 1 ) + 1 ) div 2 ) by L2000 , NAT_2:26
.= ( D118 div 2 ) by L1978 , XREAL_1:235;
L2087: D125 is (FinSequence of ( REAL )) by FINSEQ_2:24;
L2088: ( Sum D125 ) = ( Sum D124 ) by L2087 , L2055 , L2079 , L2020 , RFINSEQ:9 , RFINSEQ:26;
L2089: ( ( rng D125 ) \ D131 ) c= ( rng D125 ) by XBOOLE_1:36;
L2090: D133 c= ( Seg C151 ) by L2089 , L2078 , L2079 , XBOOLE_1:1;
L2091: (for B130 , B131 being (Element of ( NAT )) holds ((B130 in D133 & B131 in D131) implies B130 < B131))
proof
let C158 , C159 being (Element of ( NAT ));
assume that
L2092: C158 in D133
and
L2093: C159 in D131;
L2094: (not C158 in D131) by L2092 , XBOOLE_0:def 5;
L2095: (ex B132 being (Element of ( NAT )) st (B132 = C159 & B132 in ( rng D125 ) & B132 > ( D118 / 2 ))) by L2093;
L2096: C158 in ( rng D125 ) by L2092 , XBOOLE_0:def 5;
L2097: C158 <= ( D118 / 2 ) by L2096 , L2094;
thus L2098: thesis by L2097 , L2095 , XXREAL_0:2;
end;
L2099: ( Sgm ( D133 \/ D131 ) ) = ( ( Sgm D133 ) ^ ( Sgm D131 ) ) by L2091 , L2090 , L2080 , FINSEQ_3:42;
L2100: ( Sgm ( ( rng D125 ) \/ D131 ) ) = ( ( Sgm D133 ) ^ ( Sgm D131 ) ) by L2099 , XBOOLE_1:39;
L2101: D125 = ( ( Sgm D133 ) ^ ( Sgm D131 ) ) by L2100 , L2079 , L1976 , XBOOLE_1:12;
L2102: ( Sum D125 ) = ( ( Sum ( Sgm D133 ) ) + ( Sum ( Sgm D131 ) ) ) by L2101 , RVSUM_1:75;
L2103: ( D117 * ( Sum ( idseq D121 ) ) ) = ( ( ( D118 * ( Sum D128 ) ) + ( Sum ( Sgm D133 ) ) ) + ( Sum ( Sgm D131 ) ) ) by L2102 , L2077 , L2088 , RVSUM_1:87;
L2104: ( len ( Sgm D133 ) ) = ( card D133 ) by L2078 , L2079 , L2089 , FINSEQ_3:39 , XBOOLE_1:1
.= ( D121 - D132 ) by L1969 , L1970 , L1976 , L2081 , CARD_2:44;
L2105: ( D125 /^ D135 ) = ( Sgm D131 ) by L2104 , L2101 , FINSEQ_5:37;
L2106: (for B133 being Nat holds (B133 in ( dom C150 ) implies ( C150 . B133 ) in ( NAT )))
proof
let C160 being Nat;
assume L2107: C160 in ( dom C150 );
L2108: ( C150 . C160 ) = ( ( D127 . C160 ) div D117 ) by L2107 , L1977;
thus L2109: thesis by L2108;
end;
reconsider D136 = C150 as (FinSequence of ( NAT )) by L2106 , FINSEQ_2:12;
set D137 = ( D127 mod D117 );
L2110: ( len D137 ) = ( len D127 ) by EULER_2:def 1;
L2111: ( dom D127 ) = ( dom D137 ) by L2110 , FINSEQ_3:29;
set D138 = ( Sgm ( rng D137 ) );
L2112: D117 >= ( 2 + 1 ) by L1933 , NAT_1:13;
L2113: ( D117 - 1 ) >= ( 3 - 1 ) by L2112 , XREAL_1:9;
L2114: D137 <> ( {} ) by L2113 , L1958 , L1939 , L2110 , NAT_2:13;
L2115: ( rng D137 ) is  finite non  empty  finite non  empty  finite non  empty  finite non  empty (Subset of ( NAT )) by L2114 , FINSEQ_1:def 4;
consider C161 being (Element of ( NAT )) such that L2116: ( rng D137 ) c= ( ( Seg C161 ) \/ { ( 0 ) } ) by L2115 , HEYTING3:1;
L2117: ( dom D127 ) = ( dom D136 ) by L1958 , L1977 , FINSEQ_3:29;
L2118: (for R13 being Nat holds (R13 in ( dom D127 ) implies ( D127 . R13 ) = ( ( ( D136 . R13 ) * D117 ) + ( D137 . R13 ) )))
proof
let R13 being Nat;
assume L2119: R13 in ( dom D127 );
L2120: ( D137 . R13 ) = ( ( D127 . R13 ) mod D117 ) by L2119 , EULER_2:def 1;
L2121: ( D136 . R13 ) = ( ( D127 . R13 ) div D117 ) by L1977 , L2117 , L2119;
thus L2122: thesis by L2121 , L2120 , NAT_D:2;
end;
L2123: (not ( 0 ) in ( rng D137 ))
proof
assume L2124: ( 0 ) in ( rng D137 );
consider C162 being Nat such that L2125: C162 in ( dom D137 ) and L2126: ( D137 . C162 ) = ( 0 ) by L2124 , FINSEQ_2:10;
L2127: ( D127 . C162 ) = ( ( ( D136 . C162 ) * D117 ) + ( 0 ) ) by L2111 , L2118 , L2125 , L2126;
L2128: ( D118 * C162 ) = ( ( D136 . C162 ) * D117 ) by L2127 , L1948 , L2111 , L2125;
L2129: D117 divides ( D118 * C162 ) by L2128 , NAT_D:def 3;
L2130: C162 >= 1 by L2125 , FINSEQ_3:25;
L2131: D117 <= C162 by L2130 , L1936 , L2129 , NAT_D:7 , PEPIN:3;
L2132: C162 <= D119 by L1958 , L2110 , L2125 , FINSEQ_3:25;
thus L2133: contradiction by L2132 , L1947 , L2131 , XXREAL_0:2;
end;
L2134: { ( 0 ) } misses ( rng D137 ) by L2123 , ZFMISC_1:50;
L2135: D138 is  one-to-one by L2134 , L2116 , FINSEQ_3:92 , XBOOLE_1:73;
L2136: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom D127 ) & R14 in ( dom D127 ) & D117 divides ( ( D127 . R13 ) - ( D127 . R14 ) )) implies R13 = R14)))
proof
L2137: D118 , (D117 qua Integer) are_relative_prime  by L1935 , INT_2:30;
let R13 being Nat;
let R14 being Nat;
assume that
L2138: R13 in ( dom D127 )
and
L2139: R14 in ( dom D127 )
and
L2140: D117 divides ( ( D127 . R13 ) - ( D127 . R14 ) );
L2141: ( D127 . R14 ) = ( D118 * R14 ) by L1948 , L2139;
L2142: ( D127 . R13 ) = ( D118 * R13 ) by L1948 , L2138;
L2143: D117 divides ( ( R13 - R14 ) * D118 ) by L2142 , L2140 , L2141;
L2144:
now
assume L2145: R13 <> R14;
L2146: ( R13 - R14 ) <> ( 0 ) by L2145;
L2147: ( abs D117 ) <= ( abs ( R13 - R14 ) ) by L2146 , L2143 , L2137 , INT_2:25 , INT_4:6;
L2148: D117 <= ( abs ( R13 - R14 ) ) by L2147 , ABSVALUE:def 1;
L2149: R14 >= 1 by L2139 , FINSEQ_3:25;
L2150: R13 >= 1 by L2138 , FINSEQ_3:25;
L2151: R14 <= D119 by L1958 , L2139 , FINSEQ_3:25;
L2152: ( R13 - R14 ) >= ( 1 - D119 ) by L2151 , L2150 , XREAL_1:13;
L2153: ( D119 - 1 ) < D117 by L1947 , XREAL_1:147;
L2154: R13 <= D119 by L1958 , L2138 , FINSEQ_3:25;
L2155: ( R13 - R14 ) <= ( D119 - 1 ) by L2154 , L2149 , XREAL_1:13;
L2156: ( R13 - R14 ) < D117 by L2155 , L2153 , XXREAL_0:2;
L2157: ( - ( D119 - 1 ) ) > ( - D117 ) by L2153 , XREAL_1:24;
L2158: ( R13 - R14 ) > ( - D117 ) by L2157 , L2152 , XXREAL_0:2;
thus L2159: contradiction by L2158 , L2148 , L2156 , SEQ_2:1;
end;
thus L2160: thesis by L2144;
end;
L2161: (for B134 , B135 being set holds ((B134 in ( dom D137 ) & B135 in ( dom D137 ) & ( D137 . B134 ) = ( D137 . B135 )) implies B134 = B135))
proof
let C163 , C164 being set;
assume that
L2162: C163 in ( dom D137 )
and
L2163: C164 in ( dom D137 )
and
L2164: ( D137 . C163 ) = ( D137 . C164 );
reconsider D139 = C163 , D140 = C164 as (Element of ( NAT )) by L2162 , L2163;
L2165: ( D127 . D140 ) = ( ( ( D136 . D140 ) * D117 ) + ( D137 . D140 ) ) by L2111 , L2118 , L2163;
L2166: ( D127 . D139 ) = ( ( ( D136 . D139 ) * D117 ) + ( D137 . D139 ) ) by L2111 , L2118 , L2162;
L2167: ( ( D127 . D139 ) - ( D127 . D140 ) ) = ( ( ( D136 . D139 ) - ( D136 . D140 ) ) * D117 ) by L2166 , L2164 , L2165;
L2168: D117 divides ( ( D127 . D139 ) - ( D127 . D140 ) ) by L2167 , INT_1:def 3;
thus L2169: thesis by L2168 , L2136 , L2111 , L2162 , L2163;
end;
L2170: D137 is  one-to-one by L2161 , FUNCT_1:def 4;
L2171: ( len D137 ) = ( card ( rng D137 ) ) by L2170 , FINSEQ_4:62;
L2172: ( len D138 ) = D119 by L2171 , L1958 , L2110 , L2116 , L2134 , FINSEQ_3:39 , XBOOLE_1:73;
L2173: ( D125 | D135 ) = ( Sgm D133 ) by L2101 , L2104 , FINSEQ_3:113 , FINSEQ_6:10;
L2174: ( D125 | D135 ) is  one-to-one by L2020 , L2084 , FINSEQ_3:91;
L2175: ( Lege (D117 , D118) ) = ( ( - 1 ) |^ ( Sum D128 ) )
proof
set D141 = ( ( D132 |-> D118 ) - ( D125 /^ D135 ) );
set D142 = ( ( D125 | D135 ) ^ D141 );
L2176: ( rng ( idseq D121 ) ) = ( Seg D121 ) by RELAT_1:45;
L2177: ( D125 /^ D135 ) is (FinSequence of ( REAL )) by FINSEQ_2:24;
L2178: ( len ( D125 | D135 ) ) = D135 by L2057 , FINSEQ_1:59 , XREAL_1:43;
L2179: ( len ( D125 /^ D135 ) ) = ( ( len D125 ) -' D135 ) by RFINSEQ:29
.= ( ( len D125 ) - D135 ) by L2057 , XREAL_1:43 , XREAL_1:233
.= D132 by L2057;
L2180: ( dom D141 ) = ( ( dom ( D132 |-> D118 ) ) /\ ( dom ( D125 /^ D135 ) ) ) by VALUED_1:12
.= ( ( Seg ( len ( D132 |-> D118 ) ) ) /\ ( dom ( D125 /^ D135 ) ) ) by FINSEQ_1:def 3
.= ( ( Seg ( len ( D125 /^ D135 ) ) ) /\ ( dom ( D125 /^ D135 ) ) ) by L2179 , CARD_1:def 7
.= ( ( dom ( D125 /^ D135 ) ) /\ ( dom ( D125 /^ D135 ) ) ) by FINSEQ_1:def 3
.= ( dom ( D125 /^ D135 ) );
L2181: ( len D141 ) = ( len ( D125 /^ D135 ) ) by L2180 , FINSEQ_3:29;
L2182: (for R13 being Nat holds (R13 in ( dom D141 ) implies ( D141 . R13 ) = ( D118 - ( ( D125 /^ D135 ) . R13 ) )))
proof
let R13 being Nat;
assume L2183: R13 in ( dom D141 );
L2184: R13 in ( Seg D132 ) by L2183 , L2179 , L2180 , FINSEQ_1:def 3;
L2185: ( ( D132 |-> D118 ) . R13 ) = D118 by L2184 , FINSEQ_2:57;
thus L2186: thesis by L2185 , L2183 , VALUED_1:13;
end;
L2187: (for R13 being Nat holds (R13 in ( dom D141 ) implies (( D141 . R13 ) > ( 0 ) & ( D141 . R13 ) <= D121)))
proof
let R13 being Nat;
reconsider D143 = ( D141 . R13 ) as (Element of ( INT )) by INT_1:def 2;
assume L2188: R13 in ( dom D141 );
L2189: ( ( Sgm D131 ) . R13 ) in ( rng ( Sgm D131 ) ) by L2188 , L2105 , L2180 , FUNCT_1:3;
L2190: ( ( Sgm D131 ) . R13 ) in D131 by L2189 , L2080 , FINSEQ_1:def 13;
L2191: (ex B136 being (Element of ( NAT )) st (B136 = ( ( Sgm D131 ) . R13 ) & B136 in ( rng D124 ) & B136 > ( D118 / 2 ))) by L2190 , L2079;
consider C165 being Nat such that L2192: C165 in ( dom D124 ) and L2193: ( D124 . C165 ) = ( ( D125 /^ D135 ) . R13 ) by L2191 , L2105 , FINSEQ_2:10;
L2194: ( ( D125 /^ D135 ) . R13 ) = ( ( D123 . C165 ) mod D118 ) by L1971 , L2192 , L2193 , EULER_2:def 1;
L2195: ( ( D125 /^ D135 ) . R13 ) < D118 by L2194 , NAT_D:1;
L2196: ( D141 . R13 ) = ( D118 - ( ( D125 /^ D135 ) . R13 ) ) by L2182 , L2188;
L2197: D143 < ( D118 - ( D118 / 2 ) ) by L2196 , L2105 , L2191 , XREAL_1:10;
thus L2198: thesis by L2197 , L2086 , L2196 , L2195 , INT_1:54 , XREAL_1:50;
end;
L2199: ( rng D141 ) c= ( INT ) by RELAT_1:def 19;
L2200: (for B137 being Nat holds (B137 in ( dom D141 ) implies ( D141 . B137 ) in ( NAT )))
proof
let C166 being Nat;
assume L2201: C166 in ( dom D141 );
L2202: ( D141 . C166 ) > ( 0 ) by L2187 , L2201;
thus L2203: thesis by L2202 , L2199 , INT_1:3;
end;
reconsider D144 = D141 as (FinSequence of ( NAT )) by L2200 , FINSEQ_2:12;
L2204: D144 is (FinSequence of ( NAT ));
reconsider D145 = D142 as (FinSequence of ( NAT )) by L2204 , FINSEQ_1:75;
L2205: D145 is (FinSequence of ( REAL )) by FINSEQ_2:24;
L2206: D135 <= ( len D125 ) by L2057 , XREAL_1:43;
L2207: ( rng ( D125 | D135 ) ) misses ( rng D144 )
proof
assume L2208: (not ( rng ( D125 | D135 ) ) misses ( rng D144 ));
consider C167 being set such that L2209: C167 in ( rng ( D125 | D135 ) ) and L2210: C167 in ( rng D144 ) by L2208 , XBOOLE_0:3;
consider C168 being Nat such that L2211: C168 in ( dom D144 ) and L2212: ( D144 . C168 ) = C167 by L2210 , FINSEQ_2:10;
L2213: C167 = ( D118 - ( ( D125 /^ D135 ) . C168 ) ) by L2182 , L2211 , L2212;
L2214: C167 = ( D118 - ( D125 . ( C168 + D135 ) ) ) by L2213 , L2206 , L2180 , L2211 , RFINSEQ:def 1;
L2215: ( C168 + D135 ) in ( dom D125 ) by L2180 , L2211 , FINSEQ_5:26;
consider C169 being Nat such that L2216: C169 in ( dom D124 ) and L2217: ( D124 . C169 ) = ( D125 . ( C168 + D135 ) ) by L2215 , L2079 , FINSEQ_2:10 , FUNCT_1:3;
L2218: C169 <= D121 by L1969 , L1970 , L2216 , FINSEQ_3:25;
L2219: ( rng ( D125 | D135 ) ) c= ( rng D125 ) by FINSEQ_5:19;
consider C170 being Nat such that L2220: C170 in ( dom D124 ) and L2221: ( D124 . C170 ) = C167 by L2219 , L2079 , L2209 , FINSEQ_2:10;
L2222: C170 <= D121 by L1969 , L1970 , L2220 , FINSEQ_3:25;
L2223: ( C170 + C169 ) <= ( D121 + D121 ) by L2222 , L2218 , XREAL_1:7;
L2224: ( C170 + C169 ) < D118 by L2223 , L1979 , L2002 , XREAL_1:146 , XXREAL_0:2;
L2225: C169 in ( dom D123 ) by L1970 , L2216 , FINSEQ_3:29;
L2226: ( D125 . ( C168 + D135 ) ) = ( ( D123 . C169 ) mod D118 ) by L2225 , L2217 , EULER_2:def 1;
L2227: C170 in ( dom D123 ) by L1970 , L2220 , FINSEQ_3:29;
L2228: C167 = ( ( D123 . C170 ) mod D118 ) by L2227 , L2221 , EULER_2:def 1;
L2229: ( ( ( ( D123 . C170 ) mod D118 ) + ( ( D123 . C169 ) mod D118 ) ) mod D118 ) = ( 0 ) by L2228 , L2214 , L2226 , NAT_D:25;
L2230: ( ( ( D123 . C170 ) + ( D123 . C169 ) ) mod D118 ) = ( 0 ) by L2229 , EULER_2:6;
L2231: D118 divides ( ( D123 . C170 ) + ( D123 . C169 ) ) by L2230 , PEPIN:6;
L2232: D118 divides ( ( C170 * D117 ) + ( D123 . C169 ) ) by L2231 , L1959 , L2227;
L2233: D118 divides ( ( C170 * D117 ) + ( C169 * D117 ) ) by L2232 , L1959 , L2225;
L2234: D118 divides ( ( C170 + C169 ) * D117 ) by L2233;
L2235: C170 >= 1 by L2220 , FINSEQ_3:25;
thus L2236: contradiction by L2235 , L1936 , L2234 , L2224 , NAT_D:7 , PEPIN:3;
end;
L2237: (for B138 , B139 being (Element of ( NAT )) holds ((1 <= B138 & B138 < B139 & B139 <= ( len D144 )) implies ( D144 . B138 ) <> ( D144 . B139 )))
proof
let C171 , C172 being (Element of ( NAT ));
assume that
L2238: 1 <= C171
and
L2239: C171 < C172
and
L2240: C172 <= ( len D144 );
L2241: 1 <= C172 by L2238 , L2239 , XXREAL_0:2;
L2242: C172 in ( dom D144 ) by L2241 , L2240 , FINSEQ_3:25;
L2243: ( D144 . C172 ) = ( D118 - ( ( D125 /^ D135 ) . C172 ) ) by L2242 , L2182;
L2244: C171 < ( len D144 ) by L2239 , L2240 , XXREAL_0:2;
L2245: C171 in ( dom D144 ) by L2244 , L2238 , FINSEQ_3:25;
L2246: ( D144 . C171 ) = ( D118 - ( ( D125 /^ D135 ) . C171 ) ) by L2245 , L2182;
thus L2247: thesis by L2246 , L2085 , L2180 , L2239 , L2245 , L2242 , L2243 , FUNCT_1:def 4;
end;
L2248: ( len D144 ) = ( card ( rng D144 ) ) by L2237 , GRAPH_5:7;
L2249: D144 is  one-to-one by L2248 , FINSEQ_4:62;
L2250: D145 is  one-to-one by L2249 , L2174 , L2207 , FINSEQ_3:91;
L2251: (for R13 being Nat holds (R13 in ( dom D145 ) implies (( D145 . R13 ) > ( 0 ) & ( D145 . R13 ) <= D121)))
proof
let R13 being Nat;
assume L2252: R13 in ( dom D145 );
per cases  by L2252 , FINSEQ_1:25;
suppose L2253: R13 in ( dom ( D125 | D135 ) );

L2254: ( ( D125 | D135 ) . R13 ) in ( rng ( Sgm D133 ) ) by L2253 , L2173 , FUNCT_1:3;
L2255: ( ( D125 | D135 ) . R13 ) in D133 by L2254 , L2090 , FINSEQ_1:def 13;
L2256: ( ( D125 | D135 ) . R13 ) in ( rng D125 ) by L2255 , XBOOLE_0:def 5;
L2257: (not ( ( D125 | D135 ) . R13 ) in D131) by L2255 , XBOOLE_0:def 5;
L2258: ( ( D125 | D135 ) . R13 ) <= ( D118 / 2 ) by L2257 , L2256;
L2259: ( ( D125 | D135 ) . R13 ) <= D121 by L2258 , L2086 , INT_1:54;
L2260: (not ( ( D125 | D135 ) . R13 ) in { ( 0 ) }) by L2019 , L2079 , L2256 , XBOOLE_0:3;
L2261: ( ( D125 | D135 ) . R13 ) <> ( 0 ) by L2260 , TARSKI:def 1;
thus L2262: thesis by L2261 , L2253 , L2259 , FINSEQ_1:def 7;
end;
suppose L2263: (ex B140 being Nat st (B140 in ( dom D144 ) & R13 = ( ( len ( D125 | D135 ) ) + B140 )));

consider C173 being (Element of ( NAT )) such that L2264: C173 in ( dom D144 ) and L2265: R13 = ( ( len ( D125 | D135 ) ) + C173 ) by L2263;
L2266: ( D145 . R13 ) = ( D144 . C173 ) by L2264 , L2265 , FINSEQ_1:def 7;
thus L2267: thesis by L2266 , L2187 , L2264;
end;
end;
L2269: ( idseq D121 ) is (FinSequence of ( REAL )) by RVSUM_1:145;
L2270: ( len D145 ) = ( ( len ( D125 | D135 ) ) + ( len D144 ) ) by FINSEQ_1:22
.= D121 by L2178 , L2179 , L2181;
L2271: ( rng D145 ) = ( rng ( idseq D121 ) ) by L2270 , L2176 , L2250 , L2251 , L1200;
L2272: D134 = ( Sum D145 ) by L2271 , L2250 , L2205 , L2269 , RFINSEQ:9 , RFINSEQ:26
.= ( ( Sum ( D125 | D135 ) ) + ( Sum D144 ) ) by RVSUM_1:75
.= ( ( Sum ( D125 | D135 ) ) + ( ( D132 * D118 ) - ( Sum ( D125 /^ D135 ) ) ) ) by L2179 , L2177 , L1851
.= ( ( ( Sum ( D125 | D135 ) ) + ( D132 * D118 ) ) - ( Sum ( D125 /^ D135 ) ) );
L2273: ( ( D117 - 1 ) * D134 ) = ( ( ( D118 * ( Sum D128 ) ) + ( 2 * ( Sum ( Sgm D131 ) ) ) ) - ( D132 * D118 ) ) by L2272 , L2103 , L2105 , L2173;
L2274: ( ( ( D117 -' 1 ) * D134 ) mod 2 ) = ( ( ( ( D118 * ( Sum D128 ) ) - ( D132 * D118 ) ) + ( 2 * ( Sum ( Sgm D131 ) ) ) ) mod 2 ) by L2273 , L1938 , XREAL_1:233
.= ( ( ( D118 * ( Sum D128 ) ) - ( D132 * D118 ) ) mod 2 ) by EULER_1:12;
L2275: 2 divides ( ( D117 -' 1 ) * D134 ) by L1943 , NAT_D:9;
L2276: ( ( D118 * ( ( Sum D128 ) - D132 ) ) mod 2 ) = ( 0 ) by L2275 , L2274 , PEPIN:6;
L2277: 2 divides ( D118 * ( ( Sum D128 ) - D132 ) ) by L2276 , L14;
L2278: 2 divides ( ( Sum D128 ) - D132 ) by L2277 , L2064 , INT_2:25;
L2279: ( Sum D128 ) , D132 are_congruent_mod 2 by L2278 , INT_2:15;
L2280: ( ( Sum D128 ) mod 2 ) = ( D132 mod 2 ) by L2279 , NAT_D:64;
L2281: ( ( - 1 ) |^ ( Sum D128 ) ) = ( ( - 1 ) |^ D132 ) by L2280 , L1807;
thus L2282: thesis by L2281 , L1934 , L1937 , L2079 , L1312;
end;
L2283: (for B141 being Nat holds (B141 in ( dom ( idseq D119 ) ) implies ( ( idseq D119 ) . B141 ) in ( NAT )));
L2284: ( idseq D119 ) is (FinSequence of ( NAT )) by L2283 , FINSEQ_2:12;
reconsider D146 = ( Sum ( idseq D119 ) ) as (Element of ( NAT )) by L2284 , L1931;
L2285: 2 , D117 are_relative_prime  by L1933 , EULER_1:2;
set D147 = { B142 where B142 is (Element of ( NAT )) : (B142 in ( rng D138 ) & B142 > ( D117 / 2 )) };
L2286: (for B143 being set holds (B143 in D147 implies B143 in ( rng D138 )))
proof
let C174 being set;
assume L2287: C174 in D147;
L2288: (ex B144 being (Element of ( NAT )) st (C174 = B144 & B144 in ( rng D138 ) & B144 > ( D117 / 2 ))) by L2287;
thus L2289: thesis by L2288;
end;
L2290: D147 c= ( rng D138 ) by L2286 , TARSKI:def 3;
L2291: D119 >= 1 by L1939 , L2113 , NAT_2:13;
L2292: ( ( Sum D136 ) + ( Sum D128 ) ) = ( D119 * D121 )
proof
reconsider D148 = ( Seg D119 ) , D149 = ( Seg D121 ) as non  empty  finite (Subset of ( NAT )) by L2291 , L1983;
deffunc H9((Element of D148) , (Element of D149)) = ( ( $1 / D117 ) - ( $2 / D118 ) );
L2293: (for B145 being (Element of D148) holds (for B146 being (Element of D149) holds H9(B145 , B146) in ( REAL ))) by XREAL_0:def 1;
consider C175 being (Function of [: D148 , D149 :] , ( REAL )) such that L2294: (for B147 being (Element of D148) holds (for B148 being (Element of D149) holds ( C175 . (B147 , B148) ) = H9(B147 , B148))) from FUNCT_7:sch 1(L2293);
defpred S12[ set , set ] means (ex B149 being (Element of D148) st ($1 = B149 & $2 = { [ B149 , B150 ] where B150 is (Element of D149) : ( C175 . (B149 , B150) ) > ( 0 ) }));
L2295: (for B151 being Nat holds (B151 in ( Seg D119 ) implies (ex B152 being (Element of ( bool ( dom C175 ) )) st S12[ B151 , B152 ])))
proof
let C176 being Nat;
assume L2296: C176 in ( Seg D119 );
reconsider D150 = C176 as (Element of D148) by L2296;
take D151 = { [ D150 , B153 ] where B153 is (Element of D149) : ( C175 . (D150 , B153) ) > ( 0 ) };
L2297: D151 c= ( dom C175 )
proof
let C177 being set;
assume L2298: C177 in D151;
L2299: (ex B154 being (Element of D149) st ([ D150 , B154 ] = C177 & ( C175 . (D150 , B154) ) > ( 0 ))) by L2298;
L2300: C177 in [: D148 , D149 :] by L2299;
thus L2301: thesis by L2300 , FUNCT_2:def 1;
end;
thus L2302: thesis by L2297;
end;
consider C178 being (FinSequence of ( bool ( dom C175 ) )) such that L2303: (( dom C178 ) = ( Seg D119 ) & (for B155 being Nat holds (B155 in ( Seg D119 ) implies S12[ B155 , ( C178 . B155 ) ]))) from FINSEQ_1:sch 5(L2295);
L2304: ( dom ( Card C178 ) ) = ( dom C178 ) by CARD_3:def 2
.= ( dom D136 ) by L1977 , L2303 , FINSEQ_1:def 3;
L2305: (for B156 being Nat holds (B156 in ( dom ( Card C178 ) ) implies ( ( Card C178 ) . B156 ) = ( D136 . B156 )))
proof
let C179 being Nat;
assume L2306: C179 in ( dom ( Card C178 ) );
L2307: C179 in ( Seg D119 ) by L2306 , L1977 , L2304 , FINSEQ_1:def 3;
consider C180 being (Element of D148) such that L2308: C180 = C179 and L2309: ( C178 . C179 ) = { [ C180 , B157 ] where B157 is (Element of D149) : ( C175 . (C180 , B157) ) > ( 0 ) } by L2307 , L2303;
L2310: ( C178 . C179 ) = [: { C180 } , ( Seg ( D136 . C180 ) ) :]
proof
set D152 = [: { C180 } , ( Seg ( D136 . C180 ) ) :];
L2311: D152 c= ( C178 . C179 )
proof
L2312:
now
assume L2313: ( D118 mod D117 ) = ( 0 );
L2314: D117 divides D118 by L2313 , PEPIN:6;
L2315: D117 <= D118 by L2314 , NAT_D:7;
L2316: D117 < D118 by L2315 , L1935 , XXREAL_0:1;
thus L2317: contradiction by L2316 , L1938 , L2314 , NAT_4:12;
end;
L2318: ( - ( D118 div D117 ) ) = ( ( ( - D118 ) div D117 ) + 1 ) by L2312 , WSIERP_1:41;
L2319: 2 divides ( ( D117 -' 1 ) * D118 ) by L1943 , NAT_D:9;
L2320: ( ( ( D117 -' 1 ) * D118 ) mod 2 ) = ( 0 ) by L2319 , PEPIN:6;
L2321: ( ( ( D117 -' 1 ) * D118 ) div 2 ) = ( ( ( D117 -' 1 ) * D118 ) / 2 ) by L2320 , REAL_3:4;
L2322: ( ( D119 * D118 ) div D117 ) = ( ( ( D117 - 1 ) * D118 ) div ( 2 * D117 ) ) by L2321 , L1939 , L1944 , NAT_2:27
.= ( ( ( ( D117 * D118 ) - D118 ) div D117 ) div 2 ) by PRE_FF:5
.= ( ( D118 + ( ( - ( D118 div D117 ) ) - 1 ) ) div 2 ) by L2318 , NAT_D:61
.= ( ( ( 2 * D121 ) + ( - ( D118 div D117 ) ) ) div 2 ) by L1979 , L2002
.= ( D121 + ( ( - ( D118 div D117 ) ) div 2 ) ) by NAT_D:61;
L2323: ( ( D119 * D118 ) div D117 ) <= D121
proof
per cases ;
suppose L2324: ( ( D118 div D117 ) mod 2 ) = ( 0 );

L2325: ( ( - ( D118 div D117 ) ) div 2 ) = ( - ( ( D118 div D117 ) div 2 ) ) by L2324 , WSIERP_1:42
.= ( - ( D118 div ( 2 * D117 ) ) ) by NAT_2:27;
L2326: ( ( D119 * D118 ) div D117 ) = ( D121 - ( D118 div ( 2 * D117 ) ) ) by L2325 , L2322;
thus L2327: thesis by L2326 , XREAL_1:43;
end;
suppose L2328: ( ( D118 div D117 ) mod 2 ) <> ( 0 );

L2329: ( - ( ( D118 div D117 ) div 2 ) ) = ( ( ( - ( D118 div D117 ) ) div 2 ) + 1 ) by L2328 , WSIERP_1:41;
L2330: ( ( - ( D118 div D117 ) ) div 2 ) = ( ( - ( ( D118 div D117 ) div 2 ) ) - 1 ) by L2329
.= ( ( - ( D118 div ( 2 * D117 ) ) ) - 1 ) by NAT_2:27;
L2331: ( ( D119 * D118 ) div D117 ) = ( D121 - ( ( D118 div ( 2 * D117 ) ) + 1 ) ) by L2330 , L2322;
thus L2332: thesis by L2331 , XREAL_1:43;
end;
end;
L2334: C180 <= D119 by FINSEQ_1:1;
L2335: ( C180 * D118 ) <= ( D119 * D118 ) by L2334 , XREAL_1:64;
L2336: ( ( C180 * D118 ) div D117 ) <= ( ( D119 * D118 ) div D117 ) by L2335 , NAT_2:24;
L2337: ( ( C180 * D118 ) div D117 ) <= D121 by L2336 , L2323 , XXREAL_0:2;
L2338: C180 in ( Seg D119 );
L2339: C180 in ( dom D127 ) by L2338 , L1958 , FINSEQ_1:def 3;
L2340: ( D136 . C180 ) = ( ( D127 . C180 ) div D117 ) by L2339 , L1977 , L2117
.= ( ( C180 * D118 ) div D117 ) by L1948 , L2339;
L2341:
now
assume L2342: ( ( C180 * D118 ) / D117 ) is  integer;
L2343: D117 divides ( C180 * D118 ) by L2342 , WSIERP_1:17;
L2344: C180 <= D119 by FINSEQ_1:1;
L2345: ( ( 0 ) + 1 ) <= C180 by FINSEQ_1:1;
L2346: D117 <= C180 by L2345 , L1937 , L2343 , NAT_D:7 , WSIERP_1:30;
thus L2347: contradiction by L2346 , L1947 , L2344 , XXREAL_0:2;
end;
L2348: [\ ( ( C180 * D118 ) / D117 ) /] < ( ( C180 * D118 ) / D117 ) by L2341 , INT_1:26;
let C181 being set;
assume L2349: C181 in D152;
consider C182 , C183 being set such that L2350: C182 in { C180 } and L2351: C183 in ( Seg ( D136 . C180 ) ) and L2352: C181 = [ C182 , C183 ] by L2349 , ZFMISC_1:def 2;
reconsider D153 = C183 as (Element of ( NAT )) by L2351;
L2353: 1 <= D153 by L2351 , FINSEQ_1:1;
L2354: D153 <= ( D136 . C180 ) by L2351 , FINSEQ_1:1;
L2355: D153 <= D121 by L2354 , L2337 , L2340 , XXREAL_0:2;
reconsider D154 = D153 as (Element of D149) by L2355 , L2353 , FINSEQ_1:1;
L2356: D154 <= [\ ( ( C180 * D118 ) / D117 ) /] by L2351 , L2340 , FINSEQ_1:1;
L2357: D154 < ( ( C180 * D118 ) / D117 ) by L2356 , L2348 , XXREAL_0:2;
L2358: ( D154 * D117 ) < ( ( ( C180 * D118 ) / D117 ) * D117 ) by L2357 , XREAL_1:68;
L2359: ( D154 * D117 ) < ( C180 * D118 ) by L2358 , XCMPLX_1:87;
L2360: ( D154 / D118 ) < ( C180 / D117 ) by L2359 , XREAL_1:106;
L2361: ( ( C180 / D117 ) - ( D154 / D118 ) ) > ( 0 ) by L2360 , XREAL_1:50;
L2362: ( C175 . (C180 , D154) ) > ( 0 ) by L2361 , L2294;
L2363: [ C180 , D154 ] in ( C178 . C179 ) by L2362 , L2309;
thus L2364: thesis by L2363 , L2350 , L2352 , TARSKI:def 1;
end;
L2365: ( C178 . C179 ) c= D152
proof
let C184 being set;
L2366: C180 in { C180 } by TARSKI:def 1;
L2367: C180 in ( Seg D119 );
L2368: C180 in ( dom D127 ) by L2367 , L1958 , FINSEQ_1:def 3;
assume L2369: C184 in ( C178 . C179 );
consider C185 being (Element of D149) such that L2370: C184 = [ C180 , C185 ] and L2371: ( C175 . (C180 , C185) ) > ( 0 ) by L2369 , L2309;
L2372: ( ( C180 / D117 ) - ( C185 / D118 ) ) > ( 0 ) by L2294 , L2371;
L2373: ( ( ( C180 / D117 ) - ( C185 / D118 ) ) + ( C185 / D118 ) ) > ( ( 0 ) + ( C185 / D118 ) ) by L2372 , XREAL_1:6;
L2374: ( ( C180 / D117 ) * D118 ) > ( ( C185 / D118 ) * D118 ) by L2373 , XREAL_1:68;
L2375: ( ( C180 * D118 ) / D117 ) > C185 by L2374 , XCMPLX_1:87;
L2376: ( ( C180 * D118 ) div D117 ) >= C185 by L2375 , INT_1:54;
L2377: ( ( D127 . C180 ) div D117 ) >= C185 by L2376 , L1948 , L2368;
L2378: C185 <= ( D136 . C180 ) by L2377 , L1977 , L2117 , L2368;
L2379: C185 >= 1 by FINSEQ_1:1;
L2380: C185 in ( Seg ( D136 . C180 ) ) by L2379 , L2378 , FINSEQ_1:1;
thus L2381: thesis by L2380 , L2370 , L2366 , ZFMISC_1:def 2;
end;
thus L2382: thesis by L2365 , L2311 , XBOOLE_0:def 10;
end;
L2383: ( card ( C178 . C179 ) ) = ( card [: ( Seg ( D136 . C180 ) ) , { C180 } :] ) by L2310 , CARD_2:4
.= ( card ( Seg ( D136 . C180 ) ) ) by CARD_1:69;
L2384: ( card ( C178 . C179 ) ) = ( card ( D136 . C179 ) ) by L2383 , L2308 , FINSEQ_1:55
.= ( D136 . C179 ) by CARD_1:def 2;
L2385: C179 in ( dom C178 ) by L2306 , CARD_3:def 2;
thus L2386: thesis by L2385 , L2384 , CARD_3:def 2;
end;
L2387: ( Card C178 ) = D136 by L2305 , L2304 , FINSEQ_1:13;
defpred S13[ set , set ] means (ex B158 being (Element of D149) st ($1 = B158 & $2 = { [ B159 , B158 ] where B159 is (Element of D148) : ( C175 . (B159 , B158) ) < ( 0 ) }));
L2388: (for B160 being Nat holds (B160 in ( Seg D121 ) implies (ex B161 being (Element of ( bool ( dom C175 ) )) st S13[ B160 , B161 ])))
proof
let C186 being Nat;
assume L2389: C186 in ( Seg D121 );
reconsider D155 = C186 as (Element of D149) by L2389;
take D156 = { [ B162 , D155 ] where B162 is (Element of D148) : ( C175 . (B162 , D155) ) < ( 0 ) };
L2390: D156 c= ( dom C175 )
proof
let C187 being set;
assume L2391: C187 in D156;
L2392: (ex B163 being (Element of D148) st ([ B163 , D155 ] = C187 & ( C175 . (B163 , D155) ) < ( 0 ))) by L2391;
L2393: C187 in [: D148 , D149 :] by L2392;
thus L2394: thesis by L2393 , FUNCT_2:def 1;
end;
thus L2395: thesis by L2390;
end;
consider C188 being (FinSequence of ( bool ( dom C175 ) )) such that L2396: (( dom C188 ) = ( Seg D121 ) & (for B164 being Nat holds (B164 in ( Seg D121 ) implies S13[ B164 , ( C188 . B164 ) ]))) from FINSEQ_1:sch 5(L2388);
L2397: ( dom ( Card C188 ) ) = ( Seg ( len D128 ) ) by L1988 , L2396 , CARD_3:def 2
.= ( dom D128 ) by FINSEQ_1:def 3;
L2398: (for B165 being Nat holds (B165 in ( dom ( Card C188 ) ) implies ( ( Card C188 ) . B165 ) = ( D128 . B165 )))
proof
let C189 being Nat;
assume L2399: C189 in ( dom ( Card C188 ) );
L2400: C189 in ( Seg D121 ) by L2399 , L1988 , L2397 , FINSEQ_1:def 3;
consider C190 being (Element of D149) such that L2401: C190 = C189 and L2402: ( C188 . C189 ) = { [ B166 , C190 ] where B166 is (Element of D148) : ( C175 . (B166 , C190) ) < ( 0 ) } by L2400 , L2396;
L2403: ( C188 . C189 ) = [: ( Seg ( D128 . C190 ) ) , { C190 } :]
proof
set D157 = [: ( Seg ( D128 . C190 ) ) , { C190 } :];
L2404: D157 c= ( C188 . C189 )
proof
L2405:
now
assume L2406: ( D117 mod D118 ) = ( 0 );
L2407: D118 divides D117 by L2406 , PEPIN:6;
L2408: D118 <= D117 by L2407 , NAT_D:7;
L2409: D118 < D117 by L2408 , L1935 , XXREAL_0:1;
thus L2410: contradiction by L2409 , L1978 , L2407 , NAT_4:12;
end;
L2411: ( - ( D117 div D118 ) ) = ( ( ( - D117 ) div D118 ) + 1 ) by L2405 , WSIERP_1:41;
L2412: 2 divides ( ( D118 -' 1 ) * D117 ) by L2001 , NAT_D:9;
L2413: ( ( ( D118 -' 1 ) * D117 ) mod 2 ) = ( 0 ) by L2412 , PEPIN:6;
L2414: ( ( ( D118 -' 1 ) * D117 ) div 2 ) = ( ( ( D118 -' 1 ) * D117 ) / 2 ) by L2413 , REAL_3:4;
L2415: ( ( D121 * D117 ) div D118 ) = ( ( ( D118 - 1 ) * D117 ) div ( 2 * D118 ) ) by L2414 , L1979 , L2002 , NAT_2:27
.= ( ( ( ( D118 * D117 ) - D117 ) div D118 ) div 2 ) by PRE_FF:5
.= ( ( D117 + ( ( - ( D117 div D118 ) ) - 1 ) ) div 2 ) by L2411 , NAT_D:61
.= ( ( ( 2 * D119 ) - ( D117 div D118 ) ) div 2 ) by L1939 , L1944
.= ( D119 + ( ( - ( D117 div D118 ) ) div 2 ) ) by NAT_D:61;
L2416: ( ( D121 * D117 ) div D118 ) <= D119
proof
per cases ;
suppose L2417: ( ( D117 div D118 ) mod 2 ) = ( 0 );

L2418: ( ( - ( D117 div D118 ) ) div 2 ) = ( - ( ( D117 div D118 ) div 2 ) ) by L2417 , WSIERP_1:42
.= ( - ( D117 div ( 2 * D118 ) ) ) by NAT_2:27;
L2419: ( ( D121 * D117 ) div D118 ) = ( D119 - ( D117 div ( 2 * D118 ) ) ) by L2418 , L2415;
thus L2420: thesis by L2419 , XREAL_1:43;
end;
suppose L2421: ( ( D117 div D118 ) mod 2 ) <> ( 0 );

L2422: ( - ( ( D117 div D118 ) div 2 ) ) = ( ( ( - ( D117 div D118 ) ) div 2 ) + 1 ) by L2421 , WSIERP_1:41;
L2423: ( ( - ( D117 div D118 ) ) div 2 ) = ( ( - ( ( D117 div D118 ) div 2 ) ) - 1 ) by L2422
.= ( ( - ( D117 div ( 2 * D118 ) ) ) - 1 ) by NAT_2:27;
L2424: ( ( D121 * D117 ) div D118 ) = ( D119 - ( ( D117 div ( 2 * D118 ) ) + 1 ) ) by L2423 , L2415;
thus L2425: thesis by L2424 , XREAL_1:43;
end;
end;
L2427: C190 in ( Seg D121 );
L2428: C190 in ( dom D123 ) by L2427 , L1969 , FINSEQ_1:def 3;
L2429: ( D128 . C190 ) = ( ( D123 . C190 ) div D118 ) by L2428 , L1988 , L1993
.= ( ( C190 * D117 ) div D118 ) by L1959 , L2428;
let C191 being set;
assume L2430: C191 in D157;
consider C192 , C193 being set such that L2431: C192 in ( Seg ( D128 . C190 ) ) and L2432: C193 in { C190 } and L2433: C191 = [ C192 , C193 ] by L2430 , ZFMISC_1:def 2;
reconsider D158 = C192 as (Element of ( NAT )) by L2431;
L2434: D158 <= ( D128 . C190 ) by L2431 , FINSEQ_1:1;
L2435: C190 <= D121 by FINSEQ_1:1;
L2436: ( C190 * D117 ) <= ( D121 * D117 ) by L2435 , XREAL_1:64;
L2437: ( ( C190 * D117 ) div D118 ) <= ( ( D121 * D117 ) div D118 ) by L2436 , NAT_2:24;
L2438: ( ( C190 * D117 ) div D118 ) <= D119 by L2437 , L2416 , XXREAL_0:2;
L2439: D158 <= D119 by L2438 , L2429 , L2434 , XXREAL_0:2;
L2440: 1 <= D158 by L2431 , FINSEQ_1:1;
reconsider D159 = D158 as (Element of D148) by L2440 , L2439 , FINSEQ_1:1;
L2441:
now
assume L2442: ( ( C190 * D117 ) / D118 ) is  integer;
L2443: D118 divides ( C190 * D117 ) by L2442 , WSIERP_1:17;
L2444: C190 <= D121 by FINSEQ_1:1;
L2445: ( ( 0 ) + 1 ) <= C190 by FINSEQ_1:1;
L2446: D118 <= C190 by L2445 , L1937 , L2443 , NAT_D:7 , WSIERP_1:30;
thus L2447: contradiction by L2446 , L2005 , L2444 , XXREAL_0:2;
end;
L2448: [\ ( ( C190 * D117 ) / D118 ) /] < ( ( C190 * D117 ) / D118 ) by L2441 , INT_1:26;
L2449: D159 < ( ( C190 * D117 ) / D118 ) by L2448 , L2429 , L2434 , XXREAL_0:2;
L2450: ( D159 * D118 ) < ( ( ( C190 * D117 ) / D118 ) * D118 ) by L2449 , XREAL_1:68;
L2451: ( D159 * D118 ) < ( C190 * D117 ) by L2450 , XCMPLX_1:87;
L2452: ( ( D159 / D117 ) - ( C190 / D118 ) ) < ( 0 ) by L2451 , XREAL_1:49 , XREAL_1:106;
L2453: ( C175 . (D159 , C190) ) < ( 0 ) by L2452 , L2294;
L2454: [ D159 , C190 ] in ( C188 . C189 ) by L2453 , L2402;
thus L2455: thesis by L2454 , L2432 , L2433 , TARSKI:def 1;
end;
L2456: ( C188 . C189 ) c= D157
proof
let C194 being set;
L2457: C190 in { C190 } by TARSKI:def 1;
L2458: C190 in ( Seg D121 );
L2459: C190 in ( dom D123 ) by L2458 , L1969 , FINSEQ_1:def 3;
assume L2460: C194 in ( C188 . C189 );
consider C195 being (Element of D148) such that L2461: C194 = [ C195 , C190 ] and L2462: ( C175 . (C195 , C190) ) < ( 0 ) by L2460 , L2402;
L2463: ( ( C195 / D117 ) - ( C190 / D118 ) ) < ( 0 ) by L2294 , L2462;
L2464: ( ( ( C195 / D117 ) - ( C190 / D118 ) ) + ( C190 / D118 ) ) < ( ( 0 ) + ( C190 / D118 ) ) by L2463 , XREAL_1:6;
L2465: ( ( C195 / D117 ) * D117 ) < ( ( C190 / D118 ) * D117 ) by L2464 , XREAL_1:68;
L2466: C195 < ( ( C190 * D117 ) / D118 ) by L2465 , XCMPLX_1:87;
L2467: C195 <= ( ( C190 * D117 ) div D118 ) by L2466 , INT_1:54;
L2468: ( ( D123 . C190 ) div D118 ) >= C195 by L2467 , L1959 , L2459;
L2469: C195 <= ( D128 . C190 ) by L2468 , L1988 , L1993 , L2459;
L2470: C195 >= 1 by FINSEQ_1:1;
L2471: C195 in ( Seg ( D128 . C190 ) ) by L2470 , L2469 , FINSEQ_1:1;
thus L2472: thesis by L2471 , L2461 , L2457 , ZFMISC_1:def 2;
end;
thus L2473: thesis by L2456 , L2404 , XBOOLE_0:def 10;
end;
L2474: ( card ( C188 . C189 ) ) = ( card ( Seg ( D128 . C190 ) ) ) by L2403 , CARD_1:69;
L2475: ( card ( C188 . C189 ) ) = ( card ( D128 . C189 ) ) by L2474 , L2401 , FINSEQ_1:55
.= ( D128 . C189 ) by CARD_1:def 2;
L2476: C189 in ( dom C188 ) by L2399 , CARD_3:def 2;
thus L2477: thesis by L2476 , L2475 , CARD_3:def 2;
end;
reconsider D160 = ( union ( rng C178 ) ) , D161 = ( union ( rng C188 ) ) as  finite (Subset of ( dom C175 )) by PROB_3:48;
L2478: ( dom C175 ) c= ( D160 \/ D161 )
proof
let C196 being set;
assume L2479: C196 in ( dom C175 );
consider C197 , C198 being set such that L2480: C197 in D148 and L2481: C198 in D149 and L2482: C196 = [ C197 , C198 ] by L2479 , ZFMISC_1:def 2;
reconsider D162 = C198 as (Element of D149) by L2481;
reconsider D163 = C197 as (Element of D148) by L2480;
L2483: ( C175 . (D163 , D162) ) <> ( 0 )
proof
assume L2484: ( C175 . (D163 , D162) ) = ( 0 );
L2485: ( ( D163 / D117 ) - ( D162 / D118 ) ) = ( 0 ) by L2484 , L2294;
L2486: ( D163 * D118 ) = ( D162 * D117 ) by L2485 , XCMPLX_1:95;
L2487: D117 divides ( D163 * D118 ) by L2486 , NAT_D:def 3;
L2488: D163 <= D119 by FINSEQ_1:1;
L2489: D163 >= ( ( 0 ) + 1 ) by FINSEQ_1:1;
L2490: D117 <= D163 by L2489 , L1937 , L2487 , NAT_D:7 , WSIERP_1:30;
thus L2491: contradiction by L2490 , L1947 , L2488 , XXREAL_0:2;
end;
per cases  by L2483;
suppose L2492: ( C175 . (D163 , D162) ) > ( 0 );

L2493: S12[ D163 , ( C178 . D163 ) ] by L2303;
L2494: C196 in ( C178 . D163 ) by L2493 , L2482 , L2492;
L2495: C196 in ( Union C178 ) by L2494 , L2303 , PROB_3:49;
thus L2496: thesis by L2495 , XBOOLE_0:def 3;
end;
suppose L2497: ( C175 . (D163 , D162) ) < ( 0 );

L2498: S13[ D162 , ( C188 . D162 ) ] by L2396;
L2499: C196 in ( C188 . D162 ) by L2498 , L2482 , L2497;
L2500: C196 in ( Union C188 ) by L2499 , L2396 , PROB_3:49;
thus L2501: thesis by L2500 , XBOOLE_0:def 3;
end;
end;
L2503: ( D160 \/ D161 ) = ( dom C175 ) by L2478 , XBOOLE_0:def 10;
L2504: D160 misses D161
proof
assume L2505: D160 meets D161;
consider C199 being set such that L2506: C199 in D160 and L2507: C199 in D161 by L2505 , XBOOLE_0:3;
L2508: C199 in ( Union C188 ) by L2507;
consider C200 being Nat such that L2509: C200 in ( dom C188 ) and L2510: C199 in ( C188 . C200 ) by L2508 , PROB_3:49;
L2511: C199 in ( Union C178 ) by L2506;
consider C201 being Nat such that L2512: C201 in ( dom C178 ) and L2513: C199 in ( C178 . C201 ) by L2511 , PROB_3:49;
reconsider D164 = C201 , D165 = C200 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C202 being (Element of D149) such that L2514: C202 = D165 and L2515: ( C188 . D165 ) = { [ B167 , C202 ] where B167 is (Element of D148) : ( C175 . (B167 , C202) ) < ( 0 ) } by L2396 , L2509;
consider C203 being (Element of D148) such that L2516: C199 = [ C203 , C202 ] and L2517: ( C175 . (C203 , C202) ) < ( 0 ) by L2510 , L2515;
consider C204 being (Element of D148) such that L2518: C204 = D164 and L2519: ( C178 . D164 ) = { [ C204 , B168 ] where B168 is (Element of D149) : ( C175 . (C204 , B168) ) > ( 0 ) } by L2303 , L2512;
L2520: (ex B169 being (Element of D149) st (C199 = [ C204 , B169 ] & ( C175 . (C204 , B169) ) > ( 0 ))) by L2513 , L2519;
L2521: C204 = C203 by L2520 , L2516 , XTUPLE_0:1;
thus L2522: contradiction by L2521 , L2520 , L2516 , L2517 , XTUPLE_0:1;
end;
L2523: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom C188 ) & R14 in ( dom C188 ) & R13 <> R14) implies ( C188 . R13 ) misses ( C188 . R14 ))))
proof
let R13 being Nat;
let R14 being Nat;
assume that
L2524: R13 in ( dom C188 )
and
L2525: R14 in ( dom C188 )
and
L2526: R13 <> R14;
consider C205 being (Element of D149) such that L2527: C205 = R14 and L2528: ( C188 . R14 ) = { [ B170 , C205 ] where B170 is (Element of D148) : ( C175 . (B170 , C205) ) < ( 0 ) } by L2396 , L2525;
consider C206 being (Element of D149) such that L2529: C206 = R13 and L2530: ( C188 . R13 ) = { [ B171 , C206 ] where B171 is (Element of D148) : ( C175 . (B171 , C206) ) < ( 0 ) } by L2396 , L2524;
L2531:
now
assume L2532: (not ( C188 . R13 ) misses ( C188 . R14 ));
consider C207 being set such that L2533: C207 in ( C188 . R13 ) and L2534: C207 in ( C188 . R14 ) by L2532 , XBOOLE_0:3;
L2535: (ex B172 being (Element of D148) st (C207 = [ B172 , C205 ] & ( C175 . (B172 , C205) ) < ( 0 ))) by L2528 , L2534;
L2536: (ex B173 being (Element of D148) st (C207 = [ B173 , C206 ] & ( C175 . (B173 , C206) ) < ( 0 ))) by L2530 , L2533;
thus L2537: contradiction by L2536 , L2526 , L2529 , L2527 , L2535 , XTUPLE_0:1;
end;
thus L2538: thesis by L2531;
end;
L2539: ( len C188 ) = D121 by L2396 , FINSEQ_1:def 3;
L2540: ( card ( union ( rng C188 ) ) ) = ( Sum ( Card C188 ) ) by L2539 , L2523 , L1881;
L2541: (for R13 being Nat holds (for R14 being Nat holds ((R13 in ( dom C178 ) & R14 in ( dom C178 ) & R13 <> R14) implies ( C178 . R13 ) misses ( C178 . R14 ))))
proof
let R13 being Nat;
let R14 being Nat;
assume that
L2542: R13 in ( dom C178 )
and
L2543: R14 in ( dom C178 )
and
L2544: R13 <> R14;
consider C208 being (Element of D148) such that L2545: C208 = R14 and L2546: ( C178 . R14 ) = { [ C208 , B174 ] where B174 is (Element of D149) : ( C175 . (C208 , B174) ) > ( 0 ) } by L2303 , L2543;
consider C209 being (Element of D148) such that L2547: C209 = R13 and L2548: ( C178 . R13 ) = { [ C209 , B175 ] where B175 is (Element of D149) : ( C175 . (C209 , B175) ) > ( 0 ) } by L2303 , L2542;
L2549:
now
assume L2550: (not ( C178 . R13 ) misses ( C178 . R14 ));
consider C210 being set such that L2551: C210 in ( C178 . R13 ) and L2552: C210 in ( C178 . R14 ) by L2550 , XBOOLE_0:3;
L2553: (ex B176 being (Element of D149) st (C210 = [ C208 , B176 ] & ( C175 . (C208 , B176) ) > ( 0 ))) by L2546 , L2552;
L2554: (ex B177 being (Element of D149) st (C210 = [ C209 , B177 ] & ( C175 . (C209 , B177) ) > ( 0 ))) by L2548 , L2551;
thus L2555: contradiction by L2554 , L2544 , L2547 , L2545 , L2553 , XTUPLE_0:1;
end;
thus L2556: thesis by L2549;
end;
L2557: ( len C178 ) = D119 by L2303 , FINSEQ_1:def 3;
L2558: ( card ( union ( rng C178 ) ) ) = ( Sum ( Card C178 ) ) by L2557 , L2541 , L1881;
L2559: ( card ( D160 \/ D161 ) ) = ( ( Sum ( Card C178 ) ) + ( Sum ( Card C188 ) ) ) by L2558 , L2540 , L2504 , CARD_2:40;
L2560: ( ( Sum ( Card C178 ) ) + ( Sum ( Card C188 ) ) ) = ( card [: D148 , D149 :] ) by L2559 , L2503 , FUNCT_2:def 1
.= ( ( card D148 ) * ( card D149 ) ) by CARD_2:46
.= ( D119 * ( card D149 ) ) by FINSEQ_1:57
.= ( D119 * D121 ) by FINSEQ_1:57;
thus L2561: thesis by L2560 , L2387 , L2397 , L2398 , FINSEQ_1:13;
end;
L2562: ( dom ( D117 * D136 ) ) = ( dom D136 ) by VALUED_1:def 5;
L2563: ( len ( D117 * D136 ) ) = D119 by L2562 , L1977 , FINSEQ_3:29;
L2564: ( D117 * D136 ) is (Element of ( ( NAT ) * )) by FINSEQ_1:def 11;
L2565: ( D117 * D136 ) in ( D119 -tuples_on ( NAT ) ) by L2564 , L2563;
L2566: ( D117 * D136 ) is (Element of ( D119 -tuples_on ( REAL ) )) by L2565 , FINSEQ_2:109;
L2567: D119 = ( ( ( D117 -' 1 ) + 1 ) div 2 ) by L1942 , NAT_2:26
.= ( D117 div 2 ) by L1938 , XREAL_1:235;
reconsider D166 = D147 as  finite (Subset of ( NAT )) by L2290 , XBOOLE_1:1;
set D167 = ( card D166 );
reconsider D168 = ( ( rng D138 ) \ D166 ) as  finite (Subset of ( NAT ));
L2568: D137 is (Element of ( ( NAT ) * )) by FINSEQ_1:def 11;
L2569: ( len D137 ) = D119 by L1957 , L2110 , CARD_1:def 7;
L2570: D137 in ( D119 -tuples_on ( NAT ) ) by L2569 , L2568;
L2571: D137 is (Element of ( D119 -tuples_on ( REAL ) )) by L2570 , FINSEQ_2:109;
L2572: ( rng D137 ) c= ( Seg C161 ) by L2116 , L2134 , XBOOLE_1:73;
L2573: ( rng D138 ) = ( rng D137 ) by L2572 , FINSEQ_1:def 13;
L2574: D166 c= ( Seg C161 ) by L2573 , L2572 , L2290 , XBOOLE_1:1;
L2575: ( dom ( ( D117 * D136 ) + D137 ) ) = ( ( dom ( D117 * D136 ) ) /\ ( dom D137 ) ) by VALUED_1:def 1
.= ( ( dom D136 ) /\ ( dom D137 ) ) by VALUED_1:def 5
.= ( dom D127 ) by L2111 , L2117;
L2576: (for B178 being Nat holds (B178 in ( dom D127 ) implies ( D127 . B178 ) = ( ( ( D117 * D136 ) + D137 ) . B178 )))
proof
let C211 being Nat;
assume L2577: C211 in ( dom D127 );
L2578: C211 in ( dom ( D117 * D136 ) ) by L2577 , L2117 , VALUED_1:def 5;
L2579: ( ( ( D117 * D136 ) + D137 ) . C211 ) = ( ( ( D117 * D136 ) . C211 ) + ( D137 . C211 ) ) by L2575 , L2577 , VALUED_1:def 1;
thus L2580: ( ( ( D117 * D136 ) + D137 ) . C211 ) = ( ( D117 * ( D136 . C211 ) ) + ( D137 . C211 ) ) by L2579 , L2578 , VALUED_1:def 5
.= ( D127 . C211 ) by L2118 , L2577;
end;
L2581: D127 = ( ( D117 * D136 ) + D137 ) by L2576 , L2575 , FINSEQ_1:13;
L2582: ( Sum D127 ) = ( ( Sum ( D117 * D136 ) ) + ( Sum D137 ) ) by L2581 , L2566 , L2571 , RVSUM_1:89
.= ( ( D117 * ( Sum D136 ) ) + ( Sum D137 ) ) by RVSUM_1:87;
L2583: ( ( rng D138 ) \ D166 ) c= ( rng D138 ) by XBOOLE_1:36;
L2584: D168 c= ( Seg C161 ) by L2583 , L2572 , L2573 , XBOOLE_1:1;
L2585: ( len D137 ) = ( card ( rng D138 ) ) by L2170 , L2573 , FINSEQ_4:62;
reconsider D169 = ( D119 - D167 ) as (Element of ( NAT )) by L2585 , L1958 , L2110 , L2290 , NAT_1:21 , NAT_1:43;
L2586: D138 = ( ( D138 | D169 ) ^ ( D138 /^ D169 ) ) by RFINSEQ:8;
L2587: ( D138 /^ D169 ) is  one-to-one by L2586 , L2135 , FINSEQ_3:91;
L2588: D138 is (FinSequence of ( REAL )) by FINSEQ_2:24;
L2589: ( Sum D138 ) = ( Sum D137 ) by L2588 , L2170 , L2573 , L2135 , RFINSEQ:9 , RFINSEQ:26;
L2590: (for B179 , B180 being (Element of ( NAT )) holds ((B179 in D168 & B180 in D166) implies B179 < B180))
proof
let C212 , C213 being (Element of ( NAT ));
assume that
L2591: C212 in D168
and
L2592: C213 in D166;
L2593: (not C212 in D166) by L2591 , XBOOLE_0:def 5;
L2594: (ex B181 being (Element of ( NAT )) st (B181 = C213 & B181 in ( rng D138 ) & B181 > ( D117 / 2 ))) by L2592;
L2595: C212 in ( rng D138 ) by L2591 , XBOOLE_0:def 5;
L2596: C212 <= ( D117 / 2 ) by L2595 , L2593;
thus L2597: thesis by L2596 , L2594 , XXREAL_0:2;
end;
L2598: ( Sgm ( D168 \/ D166 ) ) = ( ( Sgm D168 ) ^ ( Sgm D166 ) ) by L2590 , L2574 , L2584 , FINSEQ_3:42;
L2599: ( Sgm ( ( rng D138 ) \/ D166 ) ) = ( ( Sgm D168 ) ^ ( Sgm D166 ) ) by L2598 , XBOOLE_1:39;
L2600: D138 = ( ( Sgm D168 ) ^ ( Sgm D166 ) ) by L2599 , L2573 , L2290 , XBOOLE_1:12;
L2601: ( Sum D138 ) = ( ( Sum ( Sgm D168 ) ) + ( Sum ( Sgm D166 ) ) ) by L2600 , RVSUM_1:75;
L2602: ( D118 * ( Sum ( idseq D119 ) ) ) = ( ( ( D117 * ( Sum D136 ) ) + ( Sum ( Sgm D168 ) ) ) + ( Sum ( Sgm D166 ) ) ) by L2601 , L2582 , L2589 , RVSUM_1:87;
L2603: ( len ( Sgm D168 ) ) = ( card D168 ) by L2572 , L2573 , L2583 , FINSEQ_3:39 , XBOOLE_1:1
.= ( D119 - D167 ) by L1958 , L2110 , L2290 , L2585 , CARD_2:44;
L2604: ( D138 /^ D169 ) = ( Sgm D166 ) by L2603 , L2600 , FINSEQ_5:37;
L2605: ( D138 | D169 ) = ( Sgm D168 ) by L2600 , L2603 , FINSEQ_3:113 , FINSEQ_6:10;
L2606: ( D138 | D169 ) is  one-to-one by L2135 , L2586 , FINSEQ_3:91;
L2607: ( Lege (D118 , D117) ) = ( ( - 1 ) |^ ( Sum D136 ) )
proof
set D170 = ( ( D167 |-> D117 ) - ( D138 /^ D169 ) );
set D171 = ( ( D138 | D169 ) ^ D170 );
L2608: ( rng ( idseq D119 ) ) = ( Seg D119 ) by RELAT_1:45;
L2609: ( D138 /^ D169 ) is (FinSequence of ( REAL )) by FINSEQ_2:24;
L2610: ( len ( D138 | D169 ) ) = D169 by L2172 , FINSEQ_1:59 , XREAL_1:43;
L2611: ( len ( D138 /^ D169 ) ) = ( ( len D138 ) -' D169 ) by RFINSEQ:29
.= ( ( len D138 ) - D169 ) by L2172 , XREAL_1:43 , XREAL_1:233
.= D167 by L2172;
L2612: ( dom D170 ) = ( ( dom ( D167 |-> D117 ) ) /\ ( dom ( D138 /^ D169 ) ) ) by VALUED_1:12
.= ( ( Seg ( len ( D167 |-> D117 ) ) ) /\ ( dom ( D138 /^ D169 ) ) ) by FINSEQ_1:def 3
.= ( ( Seg ( len ( D138 /^ D169 ) ) ) /\ ( dom ( D138 /^ D169 ) ) ) by L2611 , CARD_1:def 7
.= ( ( dom ( D138 /^ D169 ) ) /\ ( dom ( D138 /^ D169 ) ) ) by FINSEQ_1:def 3
.= ( dom ( D138 /^ D169 ) );
L2613: ( len D170 ) = ( len ( D138 /^ D169 ) ) by L2612 , FINSEQ_3:29;
L2614: (for R13 being Nat holds (R13 in ( dom D170 ) implies ( D170 . R13 ) = ( D117 - ( ( D138 /^ D169 ) . R13 ) )))
proof
let R13 being Nat;
assume L2615: R13 in ( dom D170 );
L2616: R13 in ( Seg D167 ) by L2615 , L2611 , L2612 , FINSEQ_1:def 3;
L2617: ( ( D167 |-> D117 ) . R13 ) = D117 by L2616 , FINSEQ_2:57;
thus L2618: thesis by L2617 , L2615 , VALUED_1:13;
end;
L2619: (for R13 being Nat holds (R13 in ( dom D170 ) implies (( D170 . R13 ) > ( 0 ) & ( D170 . R13 ) <= D119)))
proof
let R13 being Nat;
reconsider D172 = ( D170 . R13 ) as (Element of ( INT )) by INT_1:def 2;
assume L2620: R13 in ( dom D170 );
L2621: ( ( Sgm D166 ) . R13 ) in ( rng ( Sgm D166 ) ) by L2620 , L2604 , L2612 , FUNCT_1:3;
L2622: ( ( Sgm D166 ) . R13 ) in D166 by L2621 , L2574 , FINSEQ_1:def 13;
L2623: (ex B182 being (Element of ( NAT )) st (B182 = ( ( Sgm D166 ) . R13 ) & B182 in ( rng D137 ) & B182 > ( D117 / 2 ))) by L2622 , L2573;
consider C214 being Nat such that L2624: C214 in ( dom D137 ) and L2625: ( D137 . C214 ) = ( ( D138 /^ D169 ) . R13 ) by L2623 , L2604 , FINSEQ_2:10;
L2626: ( ( D138 /^ D169 ) . R13 ) = ( ( D127 . C214 ) mod D117 ) by L2111 , L2624 , L2625 , EULER_2:def 1;
L2627: ( ( D138 /^ D169 ) . R13 ) < D117 by L2626 , NAT_D:1;
L2628: ( D170 . R13 ) = ( D117 - ( ( D138 /^ D169 ) . R13 ) ) by L2614 , L2620;
L2629: D172 < ( D117 - ( D117 / 2 ) ) by L2628 , L2604 , L2623 , XREAL_1:10;
thus L2630: thesis by L2629 , L2567 , L2628 , L2627 , INT_1:54 , XREAL_1:50;
end;
L2631: ( rng D170 ) c= ( INT ) by RELAT_1:def 19;
L2632: (for B183 being Nat holds (B183 in ( dom D170 ) implies ( D170 . B183 ) in ( NAT )))
proof
let C215 being Nat;
assume L2633: C215 in ( dom D170 );
L2634: ( D170 . C215 ) > ( 0 ) by L2633 , L2619;
thus L2635: thesis by L2634 , L2631 , INT_1:3;
end;
reconsider D173 = D170 as (FinSequence of ( NAT )) by L2632 , FINSEQ_2:12;
L2636: D173 is (FinSequence of ( NAT ));
reconsider D174 = D171 as (FinSequence of ( NAT )) by L2636 , FINSEQ_1:75;
L2637: D174 is (FinSequence of ( REAL )) by FINSEQ_2:24;
L2638: D169 <= ( len D138 ) by L2172 , XREAL_1:43;
L2639: ( rng ( D138 | D169 ) ) misses ( rng D173 )
proof
assume L2640: (not ( rng ( D138 | D169 ) ) misses ( rng D173 ));
consider C216 being set such that L2641: C216 in ( rng ( D138 | D169 ) ) and L2642: C216 in ( rng D173 ) by L2640 , XBOOLE_0:3;
consider C217 being Nat such that L2643: C217 in ( dom D173 ) and L2644: ( D173 . C217 ) = C216 by L2642 , FINSEQ_2:10;
L2645: C216 = ( D117 - ( ( D138 /^ D169 ) . C217 ) ) by L2614 , L2643 , L2644;
L2646: C216 = ( D117 - ( D138 . ( C217 + D169 ) ) ) by L2645 , L2638 , L2612 , L2643 , RFINSEQ:def 1;
L2647: ( C217 + D169 ) in ( dom D138 ) by L2612 , L2643 , FINSEQ_5:26;
consider C218 being Nat such that L2648: C218 in ( dom D137 ) and L2649: ( D137 . C218 ) = ( D138 . ( C217 + D169 ) ) by L2647 , L2573 , FINSEQ_2:10 , FUNCT_1:3;
L2650: C218 <= D119 by L1958 , L2110 , L2648 , FINSEQ_3:25;
L2651: ( rng ( D138 | D169 ) ) c= ( rng D138 ) by FINSEQ_5:19;
consider C219 being Nat such that L2652: C219 in ( dom D137 ) and L2653: ( D137 . C219 ) = C216 by L2651 , L2573 , L2641 , FINSEQ_2:10;
L2654: C219 <= D119 by L1958 , L2110 , L2652 , FINSEQ_3:25;
L2655: ( C219 + C218 ) <= ( D119 + D119 ) by L2654 , L2650 , XREAL_1:7;
L2656: ( C219 + C218 ) < D117 by L2655 , L1939 , L1944 , XREAL_1:146 , XXREAL_0:2;
L2657: C216 = ( ( D127 . C219 ) mod D117 ) by L2111 , L2652 , L2653 , EULER_2:def 1;
L2658: ( ( ( D127 . C219 ) mod D117 ) + ( D138 . ( C217 + D169 ) ) ) = D117 by L2657 , L2646;
L2659: ( ( ( D127 . C219 ) mod D117 ) + ( ( D127 . C218 ) mod D117 ) ) = D117 by L2658 , L2111 , L2648 , L2649 , EULER_2:def 1;
L2660: ( ( ( ( D127 . C219 ) mod D117 ) + ( ( D127 . C218 ) mod D117 ) ) mod D117 ) = ( 0 ) by L2659 , NAT_D:25;
L2661: ( ( ( D127 . C219 ) + ( D127 . C218 ) ) mod D117 ) = ( 0 ) by L2660 , EULER_2:6;
L2662: D117 divides ( ( D127 . C219 ) + ( D127 . C218 ) ) by L2661 , PEPIN:6;
L2663: D117 divides ( ( C219 * D118 ) + ( D127 . C218 ) ) by L2662 , L1948 , L2111 , L2652;
L2664: D117 divides ( ( C219 * D118 ) + ( C218 * D118 ) ) by L2663 , L1948 , L2111 , L2648;
L2665: D117 divides ( ( C219 + C218 ) * D118 ) by L2664;
L2666: C219 >= 1 by L2652 , FINSEQ_3:25;
thus L2667: contradiction by L2666 , L1936 , L2665 , L2656 , NAT_D:7 , PEPIN:3;
end;
L2668: (for B184 , B185 being (Element of ( NAT )) holds ((1 <= B184 & B184 < B185 & B185 <= ( len D173 )) implies ( D173 . B184 ) <> ( D173 . B185 )))
proof
let C220 , C221 being (Element of ( NAT ));
assume that
L2669: 1 <= C220
and
L2670: C220 < C221
and
L2671: C221 <= ( len D173 );
L2672: 1 <= C221 by L2669 , L2670 , XXREAL_0:2;
L2673: C221 in ( dom D173 ) by L2672 , L2671 , FINSEQ_3:25;
L2674: ( D173 . C221 ) = ( D117 - ( ( D138 /^ D169 ) . C221 ) ) by L2673 , L2614;
L2675: C220 < ( len D173 ) by L2670 , L2671 , XXREAL_0:2;
L2676: C220 in ( dom D173 ) by L2675 , L2669 , FINSEQ_3:25;
L2677: ( D173 . C220 ) = ( D117 - ( ( D138 /^ D169 ) . C220 ) ) by L2676 , L2614;
thus L2678: thesis by L2677 , L2587 , L2612 , L2670 , L2676 , L2673 , L2674 , FUNCT_1:def 4;
end;
L2679: ( len D173 ) = ( card ( rng D173 ) ) by L2668 , GRAPH_5:7;
L2680: D173 is  one-to-one by L2679 , FINSEQ_4:62;
L2681: D174 is  one-to-one by L2680 , L2606 , L2639 , FINSEQ_3:91;
L2682: (for R13 being Nat holds (R13 in ( dom D174 ) implies (( D174 . R13 ) > ( 0 ) & ( D174 . R13 ) <= D119)))
proof
let R13 being Nat;
assume L2683: R13 in ( dom D174 );
per cases  by L2683 , FINSEQ_1:25;
suppose L2684: R13 in ( dom ( D138 | D169 ) );

L2685: ( ( D138 | D169 ) . R13 ) in ( rng ( Sgm D168 ) ) by L2684 , L2605 , FUNCT_1:3;
L2686: ( ( D138 | D169 ) . R13 ) in D168 by L2685 , L2584 , FINSEQ_1:def 13;
L2687: ( ( D138 | D169 ) . R13 ) in ( rng D138 ) by L2686 , XBOOLE_0:def 5;
L2688: (not ( ( D138 | D169 ) . R13 ) in D166) by L2686 , XBOOLE_0:def 5;
L2689: ( ( D138 | D169 ) . R13 ) <= ( D117 / 2 ) by L2688 , L2687;
L2690: ( ( D138 | D169 ) . R13 ) <= D119 by L2689 , L2567 , INT_1:54;
L2691: (not ( ( D138 | D169 ) . R13 ) in { ( 0 ) }) by L2134 , L2573 , L2687 , XBOOLE_0:3;
L2692: ( ( D138 | D169 ) . R13 ) <> ( 0 ) by L2691 , TARSKI:def 1;
thus L2693: thesis by L2692 , L2684 , L2690 , FINSEQ_1:def 7;
end;
suppose L2694: (ex B186 being Nat st (B186 in ( dom D173 ) & R13 = ( ( len ( D138 | D169 ) ) + B186 )));

consider C222 being (Element of ( NAT )) such that L2695: C222 in ( dom D173 ) and L2696: R13 = ( ( len ( D138 | D169 ) ) + C222 ) by L2694;
L2697: ( D174 . R13 ) = ( D173 . C222 ) by L2695 , L2696 , FINSEQ_1:def 7;
thus L2698: thesis by L2697 , L2619 , L2695;
end;
end;
L2700: ( idseq D119 ) is (FinSequence of ( REAL )) by RVSUM_1:145;
L2701: ( len D174 ) = ( ( len ( D138 | D169 ) ) + ( len D173 ) ) by FINSEQ_1:22
.= D119 by L2610 , L2611 , L2613;
L2702: ( rng D174 ) = ( rng ( idseq D119 ) ) by L2701 , L2608 , L2681 , L2682 , L1200;
L2703: D146 = ( Sum D174 ) by L2702 , L2700 , L2681 , L2637 , RFINSEQ:9 , RFINSEQ:26
.= ( ( Sum ( D138 | D169 ) ) + ( Sum D173 ) ) by RVSUM_1:75
.= ( ( Sum ( D138 | D169 ) ) + ( ( D167 * D117 ) - ( Sum ( D138 /^ D169 ) ) ) ) by L2611 , L2609 , L1851
.= ( ( ( Sum ( D138 | D169 ) ) + ( D167 * D117 ) ) - ( Sum ( D138 /^ D169 ) ) );
L2704: ( ( D118 - 1 ) * D146 ) = ( ( ( D117 * ( Sum D136 ) ) + ( 2 * ( Sum ( Sgm D166 ) ) ) ) - ( D167 * D117 ) ) by L2703 , L2602 , L2604 , L2605;
L2705: ( ( ( D118 -' 1 ) * D146 ) mod 2 ) = ( ( ( ( D117 * ( Sum D136 ) ) - ( D167 * D117 ) ) + ( 2 * ( Sum ( Sgm D166 ) ) ) ) mod 2 ) by L2704 , L1978 , XREAL_1:233
.= ( ( ( D117 * ( Sum D136 ) ) - ( D167 * D117 ) ) mod 2 ) by EULER_1:12;
L2706: 2 divides ( ( D118 -' 1 ) * D146 ) by L2001 , NAT_D:9;
L2707: ( ( ( D118 -' 1 ) * D146 ) mod 2 ) = ( 0 ) by L2706 , PEPIN:6;
L2708: 2 divides ( D117 * ( ( Sum D136 ) - D167 ) ) by L2707 , L2705 , L14;
L2709: 2 divides ( ( Sum D136 ) - D167 ) by L2708 , L2285 , INT_2:25;
L2710: ( Sum D136 ) , D167 are_congruent_mod 2 by L2709 , INT_2:15;
L2711: ( ( Sum D136 ) mod 2 ) = ( D167 mod 2 ) by L2710 , NAT_D:64;
L2712: ( ( - 1 ) |^ ( Sum D136 ) ) = ( ( - 1 ) |^ D167 ) by L2711 , L1807;
thus L2713: thesis by L2712 , L1933 , L1937 , L2573 , L1312;
end;
thus L2714: thesis by L2607 , L2175 , L2292 , NEWTON:8;
end;
theorem
L2715: (for R22 being Prime holds (for R39 being Prime holds ((R22 > 2 & R39 > 2 & R22 <> R39 & ( R22 mod 4 ) = 3 & ( R39 mod 4 ) = 3) implies ( Lege (R22 , R39) ) = ( - ( Lege (R39 , R22) ) ))))
proof
let R22 being Prime;
let R39 being Prime;
assume that
L2716: R22 > 2
and
L2717: R39 > 2
and
L2718: R22 <> R39
and
L2719: ( R22 mod 4 ) = 3
and
L2720: ( R39 mod 4 ) = 3;
L2721: R39 > 1 by INT_2:def 4;
L2722: ( R39 -' 1 ) = ( R39 - 1 ) by L2721 , XREAL_1:233;
L2723: R39 = ( ( 4 * ( R39 div 4 ) ) + 3 ) by L2720 , NAT_D:2;
L2724: ( R39 -' 1 ) = ( 2 * ( ( 2 * ( R39 div 4 ) ) + 1 ) ) by L2723 , L2722;
L2725: ( ( R39 -' 1 ) div 2 ) = ( ( 2 * ( R39 div 4 ) ) + 1 ) by L2724 , NAT_D:18;
L2726: R22 > 1 by INT_2:def 4;
L2727: ( R22 -' 1 ) = ( R22 - 1 ) by L2726 , XREAL_1:233;
L2728: R22 = ( ( 4 * ( R22 div 4 ) ) + 3 ) by L2719 , NAT_D:2;
L2729: ( R22 -' 1 ) = ( 2 * ( ( 2 * ( R22 div 4 ) ) + 1 ) ) by L2728 , L2727;
L2730: ( ( R22 -' 1 ) div 2 ) = ( ( 2 * ( R22 div 4 ) ) + 1 ) by L2729 , NAT_D:18;
L2731: ( ( Lege (R22 , R39) ) * ( Lege (R39 , R22) ) ) = ( ( - 1 ) |^ ( ( ( 2 * ( R22 div 4 ) ) + 1 ) * ( ( 2 * ( R39 div 4 ) ) + 1 ) ) ) by L2730 , L2716 , L2717 , L2718 , L2725 , L1932
.= ( ( ( - 1 ) |^ ( ( 2 * ( R22 div 4 ) ) + 1 ) ) |^ ( ( 2 * ( R39 div 4 ) ) + 1 ) ) by NEWTON:9
.= ( ( ( ( - 1 ) |^ ( 2 * ( R22 div 4 ) ) ) * ( - 1 ) ) |^ ( ( 2 * ( R39 div 4 ) ) + 1 ) ) by NEWTON:6
.= ( ( ( ( ( - 1 ) |^ 2 ) |^ ( R22 div 4 ) ) * ( - 1 ) ) |^ ( ( 2 * ( R39 div 4 ) ) + 1 ) ) by NEWTON:9
.= ( ( ( ( 1 |^ 2 ) |^ ( R22 div 4 ) ) * ( - 1 ) ) |^ ( ( 2 * ( R39 div 4 ) ) + 1 ) ) by WSIERP_1:1
.= ( ( ( ( 1 ^2 ) |^ ( R22 div 4 ) ) * ( - 1 ) ) |^ ( ( 2 * ( R39 div 4 ) ) + 1 ) ) by NEWTON:81
.= ( ( 1 * ( - 1 ) ) |^ ( ( 2 * ( R39 div 4 ) ) + 1 ) ) by NEWTON:10
.= ( ( ( - 1 ) |^ ( 2 * ( R39 div 4 ) ) ) * ( - 1 ) ) by NEWTON:6
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( R39 div 4 ) ) * ( - 1 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( R39 div 4 ) ) * ( - 1 ) ) by WSIERP_1:1
.= ( ( ( 1 ^2 ) |^ ( R39 div 4 ) ) * ( - 1 ) ) by NEWTON:81
.= ( 1 * ( - 1 ) ) by NEWTON:10;
per cases  by L807;
suppose L2732: ( Lege (R22 , R39) ) = 1;

thus L2733: thesis by L2732 , L2731;
end;
suppose L2734: ( Lege (R22 , R39) ) = ( 0 );

thus L2735: thesis by L2734 , L2731;
end;
suppose L2736: ( Lege (R22 , R39) ) = ( - 1 );

thus L2737: thesis by L2736 , L2731;
end;
end;
theorem
L2739: (for R22 being Prime holds (for R39 being Prime holds ((R22 > 2 & R39 > 2 & R22 <> R39 & (( R22 mod 4 ) = 1 or ( R39 mod 4 ) = 1)) implies ( Lege (R22 , R39) ) = ( Lege (R39 , R22) ))))
proof
let R22 being Prime;
let R39 being Prime;
assume that
L2740: R22 > 2
and
L2741: R39 > 2
and
L2742: R22 <> R39
and
L2743: (( R22 mod 4 ) = 1 or ( R39 mod 4 ) = 1);
L2744: R22 > 1 by INT_2:def 4;
L2745: ( R22 -' 1 ) = ( R22 - 1 ) by L2744 , XREAL_1:233;
L2746: R39 > 1 by INT_2:def 4;
L2747: ( R39 -' 1 ) = ( R39 - 1 ) by L2746 , XREAL_1:233;
per cases  by L2743;
suppose L2748: ( R22 mod 4 ) = 1;

L2749: R22 = ( ( 4 * ( R22 div 4 ) ) + 1 ) by L2748 , NAT_D:2;
L2750: ( R22 -' 1 ) = ( 2 * ( 2 * ( R22 div 4 ) ) ) by L2749 , L2745;
L2751: ( ( R22 -' 1 ) div 2 ) = ( 2 * ( R22 div 4 ) ) by L2750 , NAT_D:18;
L2752: ( ( Lege (R22 , R39) ) * ( Lege (R39 , R22) ) ) = ( ( - 1 ) |^ ( ( 2 * ( R22 div 4 ) ) * ( ( R39 -' 1 ) div 2 ) ) ) by L2751 , L2740 , L2741 , L2742 , L1932
.= ( ( ( - 1 ) |^ ( 2 * ( R22 div 4 ) ) ) |^ ( ( R39 -' 1 ) div 2 ) ) by NEWTON:9
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( R22 div 4 ) ) |^ ( ( R39 -' 1 ) div 2 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( R22 div 4 ) ) |^ ( ( R39 -' 1 ) div 2 ) ) by WSIERP_1:1
.= ( ( ( 1 ^2 ) |^ ( R22 div 4 ) ) |^ ( ( R39 -' 1 ) div 2 ) ) by NEWTON:81
.= ( 1 |^ ( ( R39 -' 1 ) div 2 ) ) by NEWTON:10
.= 1 by NEWTON:10;
per cases  by L807;
suppose L2753: ( Lege (R22 , R39) ) = 1;

thus L2754: thesis by L2753 , L2752;
end;
suppose L2755: ( Lege (R22 , R39) ) = ( 0 );

thus L2756: thesis by L2755 , L2752;
end;
suppose L2757: ( Lege (R22 , R39) ) = ( - 1 );

thus L2758: thesis by L2757 , L2752;
end;
end;
suppose L2760: ( R39 mod 4 ) = 1;

L2761: R39 = ( ( 4 * ( R39 div 4 ) ) + 1 ) by L2760 , NAT_D:2;
L2762: ( R39 -' 1 ) = ( 2 * ( 2 * ( R39 div 4 ) ) ) by L2761 , L2747;
L2763: ( ( R39 -' 1 ) div 2 ) = ( 2 * ( R39 div 4 ) ) by L2762 , NAT_D:18;
L2764: ( ( Lege (R22 , R39) ) * ( Lege (R39 , R22) ) ) = ( ( - 1 ) |^ ( ( 2 * ( R39 div 4 ) ) * ( ( R22 -' 1 ) div 2 ) ) ) by L2763 , L2740 , L2741 , L2742 , L1932
.= ( ( ( - 1 ) |^ ( 2 * ( R39 div 4 ) ) ) |^ ( ( R22 -' 1 ) div 2 ) ) by NEWTON:9
.= ( ( ( ( - 1 ) |^ 2 ) |^ ( R39 div 4 ) ) |^ ( ( R22 -' 1 ) div 2 ) ) by NEWTON:9
.= ( ( ( 1 |^ 2 ) |^ ( R39 div 4 ) ) |^ ( ( R22 -' 1 ) div 2 ) ) by WSIERP_1:1
.= ( ( ( 1 ^2 ) |^ ( R39 div 4 ) ) |^ ( ( R22 -' 1 ) div 2 ) ) by NEWTON:81
.= ( 1 |^ ( ( R22 -' 1 ) div 2 ) ) by NEWTON:10
.= 1 by NEWTON:10;
per cases  by L807;
suppose L2765: ( Lege (R22 , R39) ) = 1;

thus L2766: thesis by L2765 , L2764;
end;
suppose L2767: ( Lege (R22 , R39) ) = ( 0 );

thus L2768: thesis by L2767 , L2764;
end;
suppose L2769: ( Lege (R22 , R39) ) = ( - 1 );

thus L2770: thesis by L2769 , L2764;
end;
end;
end;
