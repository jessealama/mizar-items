:: Arithmetic of Non Negative Rational Numbers
::  by Grzegorz Bancerek
::
:: Received March 7, 1998
:: Copyright (c) 1998-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies ORDINAL1, XBOOLE_0, ORDINAL2, TARSKI, SUBSET_1, ORDINAL3,
      ARYTM_3;
 notations TARSKI, XBOOLE_0, SUBSET_1, ORDINAL1, ORDINAL2, ORDINAL3;
 constructors SUBSET_1, ORDINAL3;
 registrations XBOOLE_0, SUBSET_1, ORDINAL1, ORDINAL2, ORDINAL3;
 requirements BOOLE, SUBSET, NUMERALS;
 definitions TARSKI, ORDINAL1;
 theorems TARSKI, XBOOLE_0, ZFMISC_1, ORDINAL1, ORDINAL2, ORDINAL3, XBOOLE_1,
      XTUPLE_0;
 schemes ORDINAL1;

begin
L1: ( {} ) in ( omega ) by ORDINAL1:def 11;
L2: 1 in ( omega );
definition
func one equals 
1;
correctness;
end;
begin
definition
let C1 , C2 being Ordinal;
pred C1 , C2 are_relative_prime 
means
:L4: (for B1 , B2 , B3 being Ordinal holds ((C1 = ( B1 *^ B2 ) & C2 = ( B1 *^ B3 )) implies B1 = 1))
;symmetry
;
end;
theorem
L6: (not ( {} ) , ( {} ) are_relative_prime )
proof
take ( {} );
take ( {} );
take ( {} );
thus L7: thesis by ORDINAL2:35;
end;
theorem
L8: (for R1 being Ordinal holds 1 , R1 are_relative_prime )
proof
let R1 being Ordinal;
let C3 , C4 , C5 being Ordinal;
thus L9: thesis by ORDINAL3:37;
end;
theorem
L10: (for R1 being Ordinal holds (( {} ) , R1 are_relative_prime  implies R1 = 1))
proof
let R1 being Ordinal;
L11: (( {} ) = ( R1 *^ ( {} ) ) & R1 = ( R1 *^ 1 )) by ORDINAL2:38 , ORDINAL2:39;
assume L12: (( {} ) , R1 are_relative_prime  & R1 <> 1);
thus L13: contradiction by L12 , L11 , L4;
end;
defpred S1[ set ] means (ex R2 being Ordinal st (R2 c= $1 & $1 in ( omega ) & $1 <> ( {} ) & (not (ex B4 , B5 , B6 being  natural Ordinal st (B5 , B6 are_relative_prime  & $1 = ( B4 *^ B5 ) & R2 = ( B4 *^ B6 ))))));
theorem
L14: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds ((R4 <> ( {} ) or R5 <> ( {} )) implies (ex B7 , B8 , B9 being  natural Ordinal st (B8 , B9 are_relative_prime  & R4 = ( B7 *^ B8 ) & R5 = ( B7 *^ B9 ))))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
assume that
L15: (R4 <> ( {} ) or R5 <> ( {} ))
and
L16: (not (ex B10 , B11 , B12 being  natural Ordinal st (B11 , B12 are_relative_prime  & R4 = ( B10 *^ B11 ) & R5 = ( B10 *^ B12 ))));
L17: (ex R1 being Ordinal st S1[ R1 ])
proof
per cases ;
suppose L18: R4 c= R5;

take D1 = R5;
take D2 = R4;
thus L19: (D2 c= D1 & D1 in ( omega ) & D1 <> ( {} )) by L15 , L18 , ORDINAL1:def 12;
thus L20: thesis by L16;
end;
suppose L21: R5 c= R4;

take D3 = R4;
take D4 = R5;
thus L22: (D4 c= D3 & D3 in ( omega ) & D3 <> ( {} )) by L15 , L21 , ORDINAL1:def 12;
thus L23: thesis by L16;
end;
end;
consider R1 being Ordinal such that L25: S1[ R1 ] and L26: (for R3 being Ordinal holds (S1[ R3 ] implies R1 c= R3)) from ORDINAL1:sch 1(L17);
consider R2 being Ordinal such that L27: R2 c= R1 and L28: R1 in ( omega ) and L29: R1 <> ( {} ) and L30: (not (ex B13 , B14 , B15 being  natural Ordinal st (B14 , B15 are_relative_prime  & R1 = ( B13 *^ B14 ) & R2 = ( B13 *^ B15 )))) by L25;
reconsider D5 = R1 , D6 = R2 as (Element of ( omega )) by L27 , L28 , ORDINAL1:12;
L31: (D5 = ( 1 *^ D5 ) & D6 = ( 1 *^ D6 )) by ORDINAL2:39;
L32: (not D5 , D6 are_relative_prime ) by L31 , L30;
consider C6 , C7 , C8 being Ordinal such that L33: D5 = ( C6 *^ C7 ) and L34: D6 = ( C6 *^ C8 ) and L35: C6 <> 1 by L32 , L4;
L36: C6 <> ( {} ) by L29 , L33 , ORDINAL2:35;
L37: (C7 c= D5 & C8 c= D6) by L36 , L33 , L34 , ORDINAL3:36;
L38: C7 <> ( {} ) by L29 , L33 , ORDINAL2:38;
L39: C6 c= D5 by L38 , L33 , ORDINAL3:36;
reconsider D7 = C6 , D8 = C7 , D9 = C8 as (Element of ( omega )) by L39 , L37 , ORDINAL1:12;
L40: (1 in D7 or D7 in 1) by L35 , ORDINAL1:14;
L41: ( 1 *^ D8 ) in D5 by L40 , L33 , L38 , L36 , ORDINAL3:14 , ORDINAL3:19;
L42: D8 in D5 by L41 , ORDINAL2:39;
L43:
now
let C9 , C10 , C11 being  natural Ordinal;
assume that
L44: C10 , C11 are_relative_prime 
and
L45: (D8 = ( C9 *^ C10 ) & D9 = ( C9 *^ C11 ));
L46: (D5 = ( ( D7 *^ C9 ) *^ C10 ) & D6 = ( ( D7 *^ C9 ) *^ C11 )) by L33 , L34 , L45 , ORDINAL3:50;
thus L47: contradiction by L46 , L30 , L44;
end;
L48: (D5 = ( D8 *^ D7 ) & D6 = ( D9 *^ D7 )) by L33 , L34;
L49: D9 c= D8 by L48 , L27 , L36 , ORDINAL3:35;
thus L50: contradiction by L49 , L26 , L38 , L43 , L42 , ORDINAL1:5;
end;
registration
let R9 being  natural Ordinal;
let R10 being  natural Ordinal;
cluster ( R9 div^ R10 ) ->  natural;
coherence
proof
L51: (R10 = ( {} ) implies (( R9 div^ R10 ) = ( {} ) & ( ( {} ) *^ 1 ) = ( {} ))) by ORDINAL2:35 , ORDINAL3:def 6;
L52: (R10 in 1 or 1 c= R10) by ORDINAL1:16;
L53: ( ( R9 div^ R10 ) *^ 1 ) c= ( ( R9 div^ R10 ) *^ R10 ) by L52 , L51 , ORDINAL3:14 , ORDINAL3:20;
L54: ( R9 div^ R10 ) c= ( ( R9 div^ R10 ) *^ R10 ) by L53 , ORDINAL2:39;
L55: (( ( R9 div^ R10 ) *^ R10 ) c= R9 & R9 in ( omega )) by ORDINAL1:def 12 , ORDINAL3:64;
thus L56: ( R9 div^ R10 ) in ( omega ) by L55 , L54 , ORDINAL1:12 , XBOOLE_1:1;
end;
cluster ( R9 mod^ R10 ) ->  natural;
coherence
proof
L57: ( ( ( R9 div^ R10 ) *^ R10 ) +^ ( R9 mod^ R10 ) ) = R9 by ORDINAL3:65;
L58: ( R9 mod^ R10 ) c= R9 by L57 , ORDINAL3:24;
L59: R9 in ( omega ) by ORDINAL1:def 12;
thus L60: ( R9 mod^ R10 ) in ( omega ) by L59 , L58 , ORDINAL1:12;
end;
end;
definition
let C12 , C13 being Ordinal;
pred C12 divides C13
means
:L62: (ex B16 being Ordinal st C13 = ( C12 *^ B16 ))
;reflexivity
proof
let C14 being Ordinal;
take 1;
thus L63: thesis by ORDINAL2:39;
end;
end;
theorem
L65: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (R4 divides R5 iff (ex R6 being  natural Ordinal st R5 = ( R4 *^ R6 )))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
thus L66: (R4 divides R5 implies (ex R6 being  natural Ordinal st R5 = ( R4 *^ R6 )))
proof
given C15 being Ordinal such that
L67: R5 = ( R4 *^ C15 );

per cases ;
suppose L68: R5 = ( {} );

L69: R5 = ( R4 *^ ( {} ) ) by L68 , ORDINAL2:38;
thus L70: thesis by L69;
end;
suppose L71: R5 <> ( {} );

L72: C15 is (Element of ( omega )) by L71 , L67 , ORDINAL3:75;
thus L73: thesis by L72 , L67;
end;
end;

thus L75: thesis by L62;
end;
theorem
L76: (for R9 being  natural Ordinal holds (for R10 being  natural Ordinal holds (( {} ) in R9 implies ( R10 mod^ R9 ) in R9)))
proof
let R9 being  natural Ordinal;
let R10 being  natural Ordinal;
assume L77: ( {} ) in R9;
L78: (ex R3 being Ordinal st (R10 = ( ( ( R10 div^ R9 ) *^ R9 ) +^ R3 ) & R3 in R9)) by L77 , ORDINAL3:def 6;
L79: ( R10 mod^ R9 ) = ( R10 -^ ( ( R10 div^ R9 ) *^ R9 ) ) by ORDINAL3:def 7;
thus L80: thesis by L79 , L78 , ORDINAL3:52;
end;
theorem
L81: (for R10 being  natural Ordinal holds (for R9 being  natural Ordinal holds (R9 divides R10 iff R10 = ( R9 *^ ( R10 div^ R9 ) ))))
proof
let R10 being  natural Ordinal;
let R9 being  natural Ordinal;
assume L82: (not thesis);
consider R4 being  natural Ordinal such that L83: R10 = ( R9 *^ R4 ) by L82 , L65;
L84: ( ( {} ) *^ R4 ) = ( {} ) by ORDINAL2:35;
L85: ( {} ) <> R9 by L84 , L82 , L83 , ORDINAL2:35;
L86: ( {} ) in R9 by L85 , ORDINAL3:8;
L87: R10 = ( ( R4 *^ R9 ) +^ ( {} ) ) by L83 , ORDINAL2:27;
thus L88: thesis by L87 , L82 , L83 , L86 , L62 , ORDINAL3:def 6;
end;
theorem
L89: (for R10 being  natural Ordinal holds (for R9 being  natural Ordinal holds ((R10 divides R9 & R9 divides R10) implies R10 = R9)))
proof
let R10 being  natural Ordinal;
let R9 being  natural Ordinal;
assume that
L90: R10 divides R9
and
L91: R9 divides R10;
L92: R9 = ( R10 *^ ( R9 div^ R10 ) ) by L90 , L81;
L93: (( ( R9 div^ R10 ) *^ ( R10 div^ R9 ) ) = 1 implies R10 = R9)
proof
assume L94: ( ( R9 div^ R10 ) *^ ( R10 div^ R9 ) ) = 1;
L95: ( R9 div^ R10 ) = 1 by L94 , ORDINAL3:37;
thus L96: thesis by L95 , L92 , ORDINAL2:39;
end;
L97: R10 = ( R9 *^ ( R10 div^ R9 ) ) by L91 , L81;
L98: (( R10 *^ 1 ) = R10 & R10 = ( R10 *^ ( ( R9 div^ R10 ) *^ ( R10 div^ R9 ) ) )) by L97 , L92 , ORDINAL2:39 , ORDINAL3:50;
L99: (R10 = ( {} ) implies R10 = R9) by L92 , ORDINAL2:35;
thus L100: thesis by L99 , L98 , L93 , ORDINAL3:33;
end;
theorem
L101: (for R10 being  natural Ordinal holds (R10 divides ( {} ) & 1 divides R10))
proof
let R10 being  natural Ordinal;
L102: ( {} ) = ( R10 *^ ( {} ) ) by ORDINAL2:35;
thus L103: R10 divides ( {} ) by L102 , L62;
L104: R10 = ( 1 *^ R10 ) by ORDINAL2:39;
thus L105: thesis by L104 , L62;
end;
theorem
L106: (for R10 being  natural Ordinal holds (for R9 being  natural Ordinal holds ((( {} ) in R9 & R10 divides R9) implies R10 c= R9)))
proof
let R10 being  natural Ordinal;
let R9 being  natural Ordinal;
assume that
L107: ( {} ) in R9;
given C16 being Ordinal such that
L108: R9 = ( R10 *^ C16 );

L109: C16 <> ( {} ) by L107 , L108 , ORDINAL2:38;
thus L110: thesis by L109 , L108 , ORDINAL3:36;
end;
theorem
L111: (for R10 being  natural Ordinal holds (for R9 being  natural Ordinal holds (for R8 being  natural Ordinal holds ((R10 divides R9 & R10 divides ( R9 +^ R8 )) implies R10 divides R8))))
proof
let R10 being  natural Ordinal;
let R9 being  natural Ordinal;
let R8 being  natural Ordinal;
assume L112: R10 divides R9;
consider R4 being  natural Ordinal such that L113: R9 = ( R10 *^ R4 ) by L112 , L65;
assume L114: R10 divides ( R9 +^ R8 );
consider R5 being  natural Ordinal such that L115: ( R9 +^ R8 ) = ( R10 *^ R5 ) by L114 , L65;
assume L116: (not R10 divides R8);
L117: R8 = ( ( R10 *^ R5 ) -^ ( R10 *^ R4 ) ) by L113 , L115 , ORDINAL3:52
.= ( ( R5 -^ R4 ) *^ R10 ) by ORDINAL3:63;
thus L118: thesis by L117 , L116 , L62;
end;
L119: 1 = ( succ ( {} ) );
definition
let C17 , C18 being  natural Ordinal;
func C17 lcm C18 -> (Element of ( omega )) means 
:L120: (C17 divides it & C18 divides it & (for R9 being  natural Ordinal holds ((C17 divides R9 & C18 divides R9) implies it divides R9)));
existence
proof
per cases ;
suppose L121: (C17 = ( {} ) or C18 = ( {} ));

reconsider D10 = ( {} ) as (Element of ( omega )) by ORDINAL1:def 12;
take D10;
thus L122: (C17 divides D10 & C18 divides D10) by L101;
let R9 being  natural Ordinal;
assume L123: (C17 divides R9 & C18 divides R9);
thus L124: thesis by L123 , L121;
end;
suppose L125: (C17 <> ( {} ) & C18 <> ( {} ));

L126: ( {} ) c= C17;
L127: ( {} ) c< C17 by L126 , L125 , XBOOLE_0:def 8;
L128: ( {} ) in C17 by L127 , ORDINAL1:11;
L129: ( {} ) c= C18;
L130: ( {} ) c< C18 by L129 , L125 , XBOOLE_0:def 8;
L131: ( {} ) in C18 by L130 , ORDINAL1:11;
L132: 1 c= C18 by L131 , L119 , ORDINAL1:21;
defpred S2[ Ordinal ] means (ex R9 being  natural Ordinal st ($1 = R9 & C17 divides R9 & C18 divides R9 & C17 c= R9));
L133: ( C17 *^ 1 ) = C17 by ORDINAL2:39;
L134: (C17 divides ( C17 *^ C18 ) & C18 divides ( C17 *^ C18 )) by L62;
L135: (ex R1 being Ordinal st S2[ R1 ]) by L134 , L132 , L133 , ORDINAL2:41;
consider R1 being Ordinal such that L136: S2[ R1 ] and L137: (for R2 being Ordinal holds (S2[ R2 ] implies R1 c= R2)) from ORDINAL1:sch 1(L135);
consider R8 being  natural Ordinal such that L138: R1 = R8 and L139: C17 divides R8 and L140: C18 divides R8 and L141: C17 c= R8 by L136;
reconsider D11 = R8 as (Element of ( omega )) by ORDINAL1:def 12;
take D11;
thus L142: (C17 divides D11 & C18 divides D11) by L139 , L140;
let R9 being  natural Ordinal;
assume that
L143: C17 divides R9
and
L144: C18 divides R9;
L145: R9 = ( ( D11 *^ ( R9 div^ D11 ) ) +^ ( R9 mod^ D11 ) ) by ORDINAL3:65;
L146: D11 = ( C17 *^ ( D11 div^ C17 ) ) by L139 , L81;
L147: ( D11 *^ ( R9 div^ D11 ) ) = ( C17 *^ ( ( D11 div^ C17 ) *^ ( R9 div^ D11 ) ) ) by L146 , ORDINAL3:50;
L148: C17 divides ( D11 *^ ( R9 div^ D11 ) ) by L147 , L62;
L149: C17 divides ( R9 mod^ D11 ) by L148 , L143 , L145 , L111;
L150: D11 = ( C18 *^ ( D11 div^ C18 ) ) by L140 , L81;
L151: ( D11 *^ ( R9 div^ D11 ) ) = ( C18 *^ ( ( D11 div^ C18 ) *^ ( R9 div^ D11 ) ) ) by L150 , ORDINAL3:50;
L152: C18 divides ( D11 *^ ( R9 div^ D11 ) ) by L151 , L62;
L153: C18 divides ( R9 mod^ D11 ) by L152 , L144 , L145 , L111;
L154:
now
L155: ( {} ) c= ( R9 mod^ D11 );
assume L156: ( R9 mod^ D11 ) <> ( {} );
L157: ( {} ) c< ( R9 mod^ D11 ) by L156 , L155 , XBOOLE_0:def 8;
L158: C17 c= ( R9 mod^ D11 ) by L157 , L149 , L106 , ORDINAL1:11;
L159: D11 c= ( R9 mod^ D11 ) by L158 , L137 , L138 , L149 , L153;
thus L160: contradiction by L159 , L141 , L128 , L76 , ORDINAL1:5;
end;
L161: R9 = ( D11 *^ ( R9 div^ D11 ) ) by L154 , L145 , ORDINAL2:27;
thus L162: thesis by L161 , L81;
end;
end;
uniqueness
proof
let C19 , C20 being (Element of ( omega ));
assume L164: (C17 divides C19 & C18 divides C19 & (for R9 being  natural Ordinal holds ((C17 divides R9 & C18 divides R9) implies C19 divides R9)) & C17 divides C20 & C18 divides C20 & (for R9 being  natural Ordinal holds ((C17 divides R9 & C18 divides R9) implies C20 divides R9)));
L165: (C19 divides C20 & C20 divides C19) by L164;
thus L166: thesis by L165 , L89;
end;
commutativity
;
end;
theorem
L168: (for R9 being  natural Ordinal holds (for R10 being  natural Ordinal holds ( R9 lcm R10 ) divides ( R9 *^ R10 )))
proof
let R9 being  natural Ordinal;
let R10 being  natural Ordinal;
L169: (R9 divides ( R9 *^ R10 ) & R10 divides ( R9 *^ R10 )) by L62;
thus L170: thesis by L169 , L120;
end;
theorem
L171: (for R9 being  natural Ordinal holds (for R10 being  natural Ordinal holds (R10 <> ( {} ) implies ( ( R9 *^ R10 ) div^ ( R9 lcm R10 ) ) divides R9)))
proof
let R9 being  natural Ordinal;
let R10 being  natural Ordinal;
assume L172: R10 <> ( {} );
take ( ( R9 lcm R10 ) div^ R10 );
L173: R10 divides ( R9 lcm R10 ) by L120;
L174: ( R9 lcm R10 ) = ( R10 *^ ( ( R9 lcm R10 ) div^ R10 ) ) by L173 , L81;
L175: ( R9 lcm R10 ) divides ( R9 *^ R10 ) by L168;
L176: ( R9 *^ R10 ) = ( ( R9 lcm R10 ) *^ ( ( R9 *^ R10 ) div^ ( R9 lcm R10 ) ) ) by L175 , L81;
L177: ( R10 *^ R9 ) = ( R10 *^ ( ( ( R9 lcm R10 ) div^ R10 ) *^ ( ( R9 *^ R10 ) div^ ( R9 lcm R10 ) ) ) ) by L176 , L174 , ORDINAL3:50;
thus L178: R9 = ( ( ( R9 *^ R10 ) div^ ( R9 lcm R10 ) ) *^ ( ( R9 lcm R10 ) div^ R10 ) ) by L177 , L172 , ORDINAL3:33;
end;
definition
let C21 , C22 being  natural Ordinal;
func C21 hcf C22 -> (Element of ( omega )) means 
:L179: (it divides C21 & it divides C22 & (for R9 being  natural Ordinal holds ((R9 divides C21 & R9 divides C22) implies R9 divides it)));
existence
proof
per cases ;
suppose L180: (C21 = ( {} ) or C22 = ( {} ));

reconsider D12 = ( C21 \/ C22 ) as (Element of ( omega )) by L180 , ORDINAL1:def 12;
take D12;
thus L181: (D12 divides C21 & D12 divides C22) by L180 , L101;
thus L182: thesis by L180;
end;
suppose L183: (C21 <> ( {} ) & C22 <> ( {} ));

reconsider D13 = ( ( C21 *^ C22 ) div^ ( C21 lcm C22 ) ) as (Element of ( omega )) by ORDINAL1:def 12;
take D13;
thus L184: (D13 divides C21 & D13 divides C22) by L183 , L171;
let R9 being  natural Ordinal;
assume that
L185: R9 divides C21
and
L186: R9 divides C22;
L187: C22 = ( R9 *^ ( C22 div^ R9 ) ) by L186 , L81;
L188: ( C22 div^ R9 ) <> ( {} ) by L187 , L183 , ORDINAL2:35;
L189: ( ( R9 *^ ( C21 div^ R9 ) ) *^ ( C22 div^ R9 ) ) = ( C22 *^ ( C21 div^ R9 ) ) by L187 , ORDINAL3:50;
L190: C22 divides ( ( R9 *^ ( C21 div^ R9 ) ) *^ ( C22 div^ R9 ) ) by L189 , L62;
set D14 = ( R9 *^ ( ( C21 div^ R9 ) *^ ( C22 div^ R9 ) ) );
L191: D14 = ( ( R9 *^ ( C21 div^ R9 ) ) *^ ( C22 div^ R9 ) ) by ORDINAL3:50;
L192: C21 = ( R9 *^ ( C21 div^ R9 ) ) by L185 , L81;
L193: ( C21 div^ R9 ) <> ( {} ) by L192 , L183 , ORDINAL2:35;
L194: ( ( C21 div^ R9 ) *^ ( C22 div^ R9 ) ) <> ( {} ) by L193 , L188 , ORDINAL3:31;
L195: C21 divides ( ( R9 *^ ( C21 div^ R9 ) ) *^ ( C22 div^ R9 ) ) by L192 , L62;
L196: ( C21 lcm C22 ) divides ( ( R9 *^ ( C21 div^ R9 ) ) *^ ( C22 div^ R9 ) ) by L195 , L190 , L120;
L197: D14 = ( ( C21 lcm C22 ) *^ ( D14 div^ ( C21 lcm C22 ) ) ) by L196 , L191 , L81;
L198: R9 <> ( {} ) by L183 , L192 , ORDINAL2:35;
L199: ( C21 lcm C22 ) <> ( {} ) by L198 , L197 , L194 , ORDINAL2:35 , ORDINAL3:31;
L200: (( C21 *^ C22 ) = ( ( C21 *^ C22 ) +^ ( {} ) ) & ( {} ) in ( C21 lcm C22 )) by L199 , ORDINAL2:27 , ORDINAL3:8;
L201: ( D14 *^ R9 ) = ( ( C21 lcm C22 ) *^ ( R9 *^ ( D14 div^ ( C21 lcm C22 ) ) ) ) by L197 , ORDINAL3:50;
L202: ( C21 *^ C22 ) = ( ( C21 lcm C22 ) *^ ( R9 *^ ( D14 div^ ( C21 lcm C22 ) ) ) ) by L201 , L192 , L187 , L191 , ORDINAL3:50;
L203: D13 = ( R9 *^ ( D14 div^ ( C21 lcm C22 ) ) ) by L202 , L200 , ORDINAL3:66;
thus L204: thesis by L203 , L62;
end;
end;
uniqueness
proof
let C23 , C24 being (Element of ( omega ));
assume L206: (C23 divides C21 & C23 divides C22 & (for R9 being  natural Ordinal holds ((R9 divides C21 & R9 divides C22) implies R9 divides C23)) & C24 divides C21 & C24 divides C22 & (for R9 being  natural Ordinal holds ((R9 divides C21 & R9 divides C22) implies R9 divides C24)));
L207: (C23 divides C24 & C24 divides C23) by L206;
thus L208: thesis by L207 , L89;
end;
commutativity
;
end;
theorem
L210: (for R4 being  natural Ordinal holds (( R4 hcf ( {} ) ) = R4 & ( R4 lcm ( {} ) ) = ( {} )))
proof
let R4 being  natural Ordinal;
reconsider D15 = R4 , D16 = ( {} ) as (Element of ( omega )) by ORDINAL1:def 12;
L211: (for R5 being  natural Ordinal holds ((R4 divides R5 & ( {} ) divides R5) implies D16 divides R5));
L212: ((for R10 being  natural Ordinal holds ((R10 divides R4 & R10 divides ( {} )) implies R10 divides D15)) & R4 divides D16) by L101;
thus L213: thesis by L212 , L211 , L120 , L179;
end;
theorem
L214: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (( R4 hcf R5 ) = ( {} ) implies R4 = ( {} ))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
L215: ( R4 hcf R5 ) divides R4 by L179;
L216: R4 = ( ( R4 hcf R5 ) *^ ( R4 div^ ( R4 hcf R5 ) ) ) by L215 , L81;
thus L217: thesis by L216 , ORDINAL2:35;
end;
theorem
L218: (for R4 being  natural Ordinal holds (( R4 hcf R4 ) = R4 & ( R4 lcm R4 ) = R4))
proof
let R4 being  natural Ordinal;
reconsider D17 = R4 as (Element of ( omega )) by ORDINAL1:def 12;
L219: (for R5 being  natural Ordinal holds ((R5 divides R4 & R5 divides R4) implies R5 divides D17));
thus L220: ( R4 hcf R4 ) = R4 by L219 , L179;
L221: (for R5 being  natural Ordinal holds ((R4 divides R5 & R4 divides R5) implies D17 divides R5));
thus L222: thesis by L221 , L120;
end;
theorem
L223: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (for R6 being  natural Ordinal holds ( ( R4 *^ R6 ) hcf ( R5 *^ R6 ) ) = ( ( R4 hcf R5 ) *^ R6 ))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
let R6 being  natural Ordinal;
per cases ;
suppose L224: R6 = ( {} );

L225: ( ( R4 hcf R5 ) *^ R6 ) = ( {} ) by L224 , ORDINAL2:35;
L226: (( R4 *^ R6 ) = ( {} ) & ( R5 *^ R6 ) = ( {} )) by L224 , ORDINAL2:35;
thus L227: thesis by L226 , L225 , L218;
end;
suppose L228: (R6 <> ( {} ) & R4 <> ( {} ));

reconsider D18 = ( ( R4 hcf R5 ) *^ R6 ) as (Element of ( omega )) by ORDINAL1:def 12;
set D19 = ( ( ( R4 *^ R6 ) hcf ( R5 *^ R6 ) ) div^ D18 );
L229: ( R4 hcf R5 ) divides R5 by L179;
L230: R5 = ( ( R4 hcf R5 ) *^ ( R5 div^ ( R4 hcf R5 ) ) ) by L229 , L81;
L231: ( R5 *^ R6 ) = ( D18 *^ ( R5 div^ ( R4 hcf R5 ) ) ) by L230 , ORDINAL3:50;
L232: D18 divides ( R5 *^ R6 ) by L231 , L62;
L233: ( R4 hcf R5 ) divides R4 by L179;
L234: R4 = ( ( R4 hcf R5 ) *^ ( R4 div^ ( R4 hcf R5 ) ) ) by L233 , L81;
L235: ( R4 *^ R6 ) = ( D18 *^ ( R4 div^ ( R4 hcf R5 ) ) ) by L234 , ORDINAL3:50;
L236: D18 divides ( R4 *^ R6 ) by L235 , L62;
L237: D18 divides ( ( R4 *^ R6 ) hcf ( R5 *^ R6 ) ) by L236 , L232 , L179;
L238: ( ( R4 *^ R6 ) hcf ( R5 *^ R6 ) ) = ( D18 *^ D19 ) by L237 , L81
.= ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) by ORDINAL3:50;
L239: ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) divides ( R5 *^ R6 ) by L238 , L179;
L240: ( ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) *^ ( ( R5 *^ R6 ) div^ ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) ) ) = ( R5 *^ R6 ) by L239 , L81;
L241: ( ( ( ( R4 hcf R5 ) *^ D19 ) *^ ( ( R5 *^ R6 ) div^ ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) ) ) *^ R6 ) = ( R5 *^ R6 ) by L240 , ORDINAL3:50;
L242: ( ( ( R4 hcf R5 ) *^ D19 ) *^ ( ( R5 *^ R6 ) div^ ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) ) ) = R5 by L241 , L228 , ORDINAL3:33;
L243: ( ( R4 hcf R5 ) *^ D19 ) divides R5 by L242 , L62;
L244: ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) divides ( R4 *^ R6 ) by L238 , L179;
L245: ( ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) *^ ( ( R4 *^ R6 ) div^ ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) ) ) = ( R4 *^ R6 ) by L244 , L81;
L246: ( ( ( ( R4 hcf R5 ) *^ D19 ) *^ ( ( R4 *^ R6 ) div^ ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) ) ) *^ R6 ) = ( R4 *^ R6 ) by L245 , ORDINAL3:50;
L247: ( ( ( R4 hcf R5 ) *^ D19 ) *^ ( ( R4 *^ R6 ) div^ ( ( ( R4 hcf R5 ) *^ D19 ) *^ R6 ) ) ) = R4 by L246 , L228 , ORDINAL3:33;
L248: ( ( R4 hcf R5 ) *^ D19 ) divides R4 by L247 , L62;
L249: ( ( R4 hcf R5 ) *^ D19 ) divides ( R4 hcf R5 ) by L248 , L243 , L179;
L250: ( ( ( R4 hcf R5 ) *^ D19 ) *^ ( ( R4 hcf R5 ) div^ ( ( R4 hcf R5 ) *^ D19 ) ) ) = ( R4 hcf R5 ) by L249 , L81;
L251: ( ( R4 hcf R5 ) *^ ( D19 *^ ( ( R4 hcf R5 ) div^ ( ( R4 hcf R5 ) *^ D19 ) ) ) ) = ( R4 hcf R5 ) by L250 , ORDINAL3:50
.= ( ( R4 hcf R5 ) *^ 1 ) by ORDINAL2:39;
L252: (( R4 hcf R5 ) = ( {} ) or ( D19 *^ ( ( R4 hcf R5 ) div^ ( ( R4 hcf R5 ) *^ D19 ) ) ) = 1) by L251 , ORDINAL3:33;
L253: D19 = 1 by L252 , L228 , L214 , ORDINAL3:37;
thus L254: thesis by L253 , L238 , ORDINAL2:39;
end;
suppose L255: R4 = ( {} );

L256: (( R4 hcf R5 ) = R5 & ( R4 *^ R6 ) = ( {} )) by L255 , L210 , ORDINAL2:35;
thus L257: thesis by L256 , L210;
end;
end;
theorem
L259: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (R5 <> ( {} ) implies (( R4 hcf R5 ) <> ( {} ) & ( R5 div^ ( R4 hcf R5 ) ) <> ( {} )))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
L260: ( R4 hcf R5 ) divides R5 by L179;
L261: R5 = ( ( R4 hcf R5 ) *^ ( R5 div^ ( R4 hcf R5 ) ) ) by L260 , L81;
thus L262: thesis by L261 , ORDINAL2:35;
end;
theorem
L263: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds ((R4 <> ( {} ) or R5 <> ( {} )) implies ( R4 div^ ( R4 hcf R5 ) ) , ( R5 div^ ( R4 hcf R5 ) ) are_relative_prime )))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
assume L264: (R4 <> ( {} ) or R5 <> ( {} ));
set D20 = ( R4 hcf R5 );
L265: (( 1 *^ R4 ) = R4 & ( 1 *^ R5 ) = R5) by ORDINAL2:39;
per cases ;
suppose L266: (R4 = ( {} ) or R5 = ( {} ));

L267: ((D20 = R5 & ( R5 div^ R5 ) = 1) or (D20 = R4 & ( R4 div^ R4 ) = 1)) by L266 , L264 , L265 , L210 , ORDINAL3:68;
thus L268: thesis by L267 , L8;
end;
suppose L269: (R4 <> ( {} ) & R5 <> ( {} ));

L270: D20 divides R5 by L179;
L271: R5 = ( D20 *^ ( R5 div^ D20 ) ) by L270 , L81;
L272: ( R5 div^ D20 ) <> ( {} ) by L271 , L269 , ORDINAL2:35;
let C25 , C26 , C27 being Ordinal;
assume that
L273: ( R4 div^ ( R4 hcf R5 ) ) = ( C25 *^ C26 )
and
L274: ( R5 div^ ( R4 hcf R5 ) ) = ( C25 *^ C27 );
L275: D20 divides R4 by L179;
L276: R4 = ( D20 *^ ( R4 div^ D20 ) ) by L275 , L81;
L277: ( R4 div^ D20 ) <> ( {} ) by L276 , L269 , ORDINAL2:35;
reconsider D21 = C25 , D22 = C26 , D23 = C27 as (Element of ( omega )) by L277 , L273 , L274 , L272 , ORDINAL3:75;
L278: R5 = ( ( D20 *^ D21 ) *^ D23 ) by L271 , L274 , ORDINAL3:50;
L279: ( D20 *^ D21 ) divides R5 by L278 , L62;
L280: R4 = ( ( D20 *^ D21 ) *^ D22 ) by L276 , L273 , ORDINAL3:50;
L281: ( D20 *^ D21 ) divides R4 by L280 , L62;
L282: ( D20 *^ D21 ) divides D20 by L281 , L279 , L179;
L283: D20 = ( ( D20 *^ D21 ) *^ ( D20 div^ ( D20 *^ D21 ) ) ) by L282 , L81;
L284: D20 = ( D20 *^ ( D21 *^ ( D20 div^ ( D20 *^ D21 ) ) ) ) by L283 , ORDINAL3:50;
L285: ( D20 *^ 1 ) = ( D20 *^ ( D21 *^ ( D20 div^ ( D20 *^ D21 ) ) ) ) by L284 , ORDINAL2:39;
L286: D20 <> ( {} ) by L269 , L276 , ORDINAL2:35;
L287: 1 = ( D21 *^ ( D20 div^ ( D20 *^ D21 ) ) ) by L286 , L285 , ORDINAL3:33;
thus L288: thesis by L287 , ORDINAL3:37;
end;
end;
theorem
L290: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (R4 , R5 are_relative_prime  iff ( R4 hcf R5 ) = 1)))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
L291: ( R4 hcf R5 ) divides R5 by L179;
L292: R5 = ( ( R4 hcf R5 ) *^ ( R5 div^ ( R4 hcf R5 ) ) ) by L291 , L81;
L293: ( R4 hcf R5 ) divides R4 by L179;
L294: R4 = ( ( R4 hcf R5 ) *^ ( R4 div^ ( R4 hcf R5 ) ) ) by L293 , L81;
thus L295: (R4 , R5 are_relative_prime  implies ( R4 hcf R5 ) = 1) by L294 , L292 , L4;
assume L296: ( R4 hcf R5 ) = 1;
let C28 , C29 , C30 being Ordinal;
assume that
L297: (R4 = ( C28 *^ C29 ) & R5 = ( C28 *^ C30 ));
L298: (R4 <> ( {} ) or R5 <> ( {} )) by L296 , L210;
reconsider D24 = C28 as (Element of ( omega )) by L298 , L297 , ORDINAL3:75;
L299: (D24 divides R4 & D24 divides R5) by L297 , L62;
L300: D24 divides 1 by L299 , L296 , L179;
L301: (ex R7 being  natural Ordinal st 1 = ( D24 *^ R7 )) by L300 , L65;
thus L302: thesis by L301 , ORDINAL3:37;
end;
definition
let C31 , C32 being  natural Ordinal;
func RED (C31 , C32) -> (Element of ( omega )) equals 
( C31 div^ ( C31 hcf C32 ) );
coherence by ORDINAL1:def 12;
end;
theorem
L304: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds ( ( RED (R4 , R5) ) *^ ( R4 hcf R5 ) ) = R4))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
L305: ( R4 hcf R5 ) divides R4 by L179;
thus L306: thesis by L305 , L81;
end;
theorem
L307: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds ((R4 <> ( {} ) or R5 <> ( {} )) implies ( RED (R4 , R5) ) , ( RED (R5 , R4) ) are_relative_prime ))) by L263;
theorem
L308: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (R4 , R5 are_relative_prime  implies ( RED (R4 , R5) ) = R4)))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
assume L309: R4 , R5 are_relative_prime ;
L310: ( R4 hcf R5 ) = 1 by L309 , L290;
thus L311: thesis by L310 , ORDINAL3:71;
end;
theorem
L312: (for R4 being  natural Ordinal holds (( RED (R4 , 1) ) = R4 & ( RED (1 , R4) ) = 1))
proof
let R4 being  natural Ordinal;
L313: R4 , 1 are_relative_prime  by L8;
L314: ( R4 hcf 1 ) = 1 by L313 , L290;
thus L315: thesis by L314 , ORDINAL3:71;
end;
theorem
L316: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (R5 <> ( {} ) implies ( RED (R5 , R4) ) <> ( {} )))) by L259;
theorem
L317: (for R4 being  natural Ordinal holds (( RED (( {} ) , R4) ) = ( {} ) & (R4 <> ( {} ) implies ( RED (R4 , ( {} )) ) = 1)))
proof
let R4 being  natural Ordinal;
thus L318: ( RED (( {} ) , R4) ) = ( {} ) by ORDINAL3:70;
assume L319: R4 <> ( {} );
thus L320: ( RED (R4 , ( {} )) ) = ( R4 div^ R4 ) by L210
.= ( ( R4 *^ 1 ) div^ R4 ) by ORDINAL2:39
.= 1 by L319 , ORDINAL3:68;
end;
theorem
L321: (for R4 being  natural Ordinal holds (R4 <> ( {} ) implies ( RED (R4 , R4) ) = 1))
proof
let R4 being  natural Ordinal;
assume L322: R4 <> ( {} );
thus L323: ( RED (R4 , R4) ) = ( R4 div^ R4 ) by L218
.= ( ( R4 *^ 1 ) div^ R4 ) by ORDINAL2:39
.= 1 by L322 , ORDINAL3:68;
end;
theorem
L324: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (for R6 being  natural Ordinal holds (R6 <> ( {} ) implies ( RED (( R4 *^ R6 ) , ( R5 *^ R6 )) ) = ( RED (R4 , R5) )))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
let R6 being  natural Ordinal;
assume L325: R6 <> ( {} );
L326: (R4 <> ( {} ) implies ( R4 hcf R5 ) <> ( {} )) by L259;
L327: (R4 <> ( {} ) implies ( ( R4 hcf R5 ) *^ R6 ) <> ( {} )) by L326 , L325 , ORDINAL3:31;
L328: (( RED (( {} ) , R5) ) = ( {} ) & ( ( {} ) *^ ( ( R4 hcf R5 ) *^ R6 ) ) = ( {} )) by ORDINAL2:35 , ORDINAL3:70;
L329: ( R4 hcf R5 ) divides R4 by L179;
thus L330: ( RED (( R4 *^ R6 ) , ( R5 *^ R6 )) ) = ( ( R4 *^ R6 ) div^ ( ( R4 hcf R5 ) *^ R6 ) ) by L223
.= ( ( ( ( R4 div^ ( R4 hcf R5 ) ) *^ ( R4 hcf R5 ) ) *^ R6 ) div^ ( ( R4 hcf R5 ) *^ R6 ) ) by L329 , L81
.= ( ( ( RED (R4 , R5) ) *^ ( ( R4 hcf R5 ) *^ R6 ) ) div^ ( ( R4 hcf R5 ) *^ R6 ) ) by ORDINAL3:50
.= ( RED (R4 , R5) ) by L327 , L328 , ORDINAL3:68 , ORDINAL3:70;
end;
set D25 = { [ B17 , B18 ] where B17 , B18 is (Element of ( omega )) : (B17 , B18 are_relative_prime  & B18 <> ( {} )) };
L331: 1 , 1 are_relative_prime  by L8;
L332: [ 1 , 1 ] in D25 by L331;
reconsider D26 = D25 as non  empty set by L332;
L333: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds ([ R4 , R5 ] in D26 implies (R4 , R5 are_relative_prime  & R5 <> ( {} )))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
assume L334: [ R4 , R5 ] in D26;
consider C33 , C34 being (Element of ( omega )) such that L335: [ R4 , R5 ] = [ C33 , C34 ] and L336: (C33 , C34 are_relative_prime  & C34 <> ( {} )) by L334;
L337: R4 = C33 by L335 , XTUPLE_0:1;
thus L338: thesis by L337 , L335 , L336 , XTUPLE_0:1;
end;
begin
definition
func RAT+ equals 
( ( { [ R11 , R12 ] where R11 is (Element of ( omega )) , R12 is (Element of ( omega )) : (R11 , R12 are_relative_prime  & R12 <> ( {} )) } \ { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) } ) \/ ( omega ) );
correctness;
end;
L340: ( omega ) c= ( RAT+ ) by XBOOLE_1:7;
registration
cluster ( RAT+ ) -> non  empty;
coherence;
end;
registration
cluster non  empty  ordinal for (Element of ( RAT+ ));
existence by L2 , L340;
end;
theorem
L343: (for R14 being (Element of ( RAT+ )) holds (R14 in ( omega ) or (ex R11 being (Element of ( omega )) st (ex R12 being (Element of ( omega )) st (R14 = [ R11 , R12 ] & R11 , R12 are_relative_prime  & R12 <> ( {} ) & R12 <> 1)))))
proof
let R14 being (Element of ( RAT+ ));
assume L344: (not R14 in ( omega ));
L345: R14 in ( D26 \ { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) } ) by L344 , XBOOLE_0:def 3;
L346: (not R14 in { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) }) by L345 , XBOOLE_0:def 5;
L347: R14 in D26 by L345;
consider C35 , C36 being (Element of ( omega )) such that L348: (R14 = [ C35 , C36 ] & C35 , C36 are_relative_prime  & C36 <> ( {} )) by L347;
L349: [ C35 , 1 ] in { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) };
thus L350: thesis by L349 , L346 , L348;
end;
theorem
L351: (not (ex B19 , B20 being set st [ B19 , B20 ] is Ordinal))
proof
given C37 , C38 being set such that
L352: [ C37 , C38 ] is Ordinal;

L353: ( {} ) in [ C37 , C38 ] by L352 , ORDINAL3:8;
thus L354: thesis by L353 , TARSKI:def 2;
end;
theorem
L355: (for R1 being Ordinal holds (R1 in ( RAT+ ) implies R1 in ( omega )))
proof
let R1 being Ordinal;
assume L356: (R1 in ( RAT+ ) & (not R1 in ( omega )));
L357: (ex R11 being (Element of ( omega )) st (ex R12 being (Element of ( omega )) st (R1 = [ R11 , R12 ] & R11 , R12 are_relative_prime  & R12 <> ( {} ) & R12 <> 1))) by L356 , L343;
thus L358: thesis by L357 , L351;
end;
registration
cluster  ->  natural for  ordinal  ordinal  ordinal  ordinal (Element of ( RAT+ ));
coherence
proof
let C39 being  ordinal (Element of ( RAT+ ));
assume L359: (not C39 in ( omega ));
L360: (ex R11 being (Element of ( omega )) st (ex R12 being (Element of ( omega )) st (C39 = [ R11 , R12 ] & R11 , R12 are_relative_prime  & R12 <> ( {} ) & R12 <> 1))) by L359 , L343;
L361: ( {} ) in C39 by L360 , ORDINAL3:8;
thus L362: thesis by L361 , L360 , TARSKI:def 2;
end;
end;
theorem
L364: (not (ex B21 , B22 being set st [ B21 , B22 ] in ( omega )))
proof
given C40 , C41 being set such that
L365: [ C40 , C41 ] in ( omega );

reconsider D27 = [ C40 , C41 ] as (Element of ( omega )) by L365;
L366: ( {} ) in D27 by ORDINAL3:8;
thus L367: thesis by L366 , TARSKI:def 2;
end;
theorem
L368: (for R11 being (Element of ( omega )) holds (for R12 being (Element of ( omega )) holds ([ R11 , R12 ] in ( RAT+ ) iff (R11 , R12 are_relative_prime  & R12 <> ( {} ) & R12 <> 1))))
proof
let R11 being (Element of ( omega ));
let R12 being (Element of ( omega ));
L369: (not [ R11 , R12 ] in ( omega )) by L364;
thus L370:now
assume L371: [ R11 , R12 ] in ( RAT+ );
L372: [ R11 , R12 ] in ( D26 \ { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) } ) by L371 , L369 , XBOOLE_0:def 3;
thus L373: (R11 , R12 are_relative_prime  & R12 <> ( {} )) by L372 , L333;
L374: (not [ R11 , R12 ] in { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) }) by L372 , XBOOLE_0:def 5;
thus L375: R12 <> 1 by L374;
end;
assume L376: (R11 , R12 are_relative_prime  & R12 <> ( {} ));
L377: [ R11 , R12 ] in D26 by L376;
assume L378: R12 <> 1;
L379: (not (ex R13 being (Element of ( omega )) st [ R11 , R12 ] = [ R13 , 1 ])) by L378 , XTUPLE_0:1;
L380: (not [ R11 , R12 ] in { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) }) by L379;
L381: [ R11 , R12 ] in ( D26 \ { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) } ) by L380 , L377 , XBOOLE_0:def 5;
thus L382: thesis by L381 , XBOOLE_0:def 3;
end;
definition
let C42 being (Element of ( RAT+ ));
func numerator C42 -> (Element of ( omega )) means 
:L383: it = C42 if C42 in ( omega ) otherwise (ex R4 being  natural Ordinal st C42 = [ it , R4 ]);
existence
proof
thus L384: (C42 in ( omega ) implies (ex B23 being (Element of ( omega )) st B23 = C42));
assume L385: (not C42 in ( omega ));
L386: C42 in ( D26 \ { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) } ) by L385 , XBOOLE_0:def 3;
L387: C42 in D26 by L386;
consider C43 , C44 being (Element of ( omega )) such that L388: C42 = [ C43 , C44 ] and L389: C43 , C44 are_relative_prime  and L390: C44 <> ( {} ) by L387;
take C43;
take C44;
thus L391: thesis by L388;
end;
correctness by XTUPLE_0:1;
func denominator C42 -> (Element of ( omega )) means 
:L392: it = 1 if C42 in ( omega ) otherwise (ex R4 being  natural Ordinal st C42 = [ R4 , it ]);
existence
proof
thus L393: (C42 in ( omega ) implies (ex B24 being (Element of ( omega )) st B24 = 1));
assume L394: (not C42 in ( omega ));
L395: C42 in ( D26 \ { [ R13 , 1 ] where R13 is (Element of ( omega )) : (not contradiction) } ) by L394 , XBOOLE_0:def 3;
L396: C42 in D26 by L395;
consider C45 , C46 being (Element of ( omega )) such that L397: C42 = [ C45 , C46 ] and L398: C45 , C46 are_relative_prime  and L399: C46 <> ( {} ) by L396;
take C46;
take C45;
thus L400: thesis by L397;
end;
correctness by XTUPLE_0:1;
end;
theorem
L402: (for R14 being (Element of ( RAT+ )) holds ( numerator R14 ) , ( denominator R14 ) are_relative_prime )
proof
let R14 being (Element of ( RAT+ ));
per cases ;
suppose L403: R14 in ( omega );

L404: ( denominator R14 ) = 1 by L403 , L392;
thus L405: thesis by L404 , L8;
end;
suppose L406: (not R14 in ( omega ));

consider R11 being (Element of ( omega )), R12 being (Element of ( omega )) such that L407: R14 = [ R11 , R12 ] and L408: R11 , R12 are_relative_prime  and L409: R12 <> ( {} ) and L410: R12 <> 1 by L406 , L343;
L411: R11 = ( numerator R14 ) by L406 , L407 , L383;
thus L412: thesis by L411 , L406 , L407 , L408 , L392;
end;
end;
theorem
L414: (for R14 being (Element of ( RAT+ )) holds ( denominator R14 ) <> ( {} ))
proof
let R14 being (Element of ( RAT+ ));
per cases ;
suppose L415: R14 in ( omega );

thus L416: thesis by L415 , L392;
end;
suppose L417: (not R14 in ( omega ));

L418: (ex R11 being (Element of ( omega )) st (ex R12 being (Element of ( omega )) st (R14 = [ R11 , R12 ] & R11 , R12 are_relative_prime  & R12 <> ( {} ) & R12 <> 1))) by L417 , L343;
thus L419: thesis by L418 , L417 , L392;
end;
end;
theorem
L421: (for R14 being (Element of ( RAT+ )) holds ((not R14 in ( omega )) implies (R14 = [ ( numerator R14 ) , ( denominator R14 ) ] & ( denominator R14 ) <> 1)))
proof
let R14 being (Element of ( RAT+ ));
assume L422: (not R14 in ( omega ));
consider R11 being (Element of ( omega )), R12 being (Element of ( omega )) such that L423: R14 = [ R11 , R12 ] and L424: R11 , R12 are_relative_prime  and L425: R12 <> ( {} ) and L426: R12 <> 1 by L422 , L343;
L427: R11 = ( numerator R14 ) by L422 , L423 , L383;
thus L428: thesis by L427 , L422 , L423 , L426 , L392;
end;
theorem
L429: (for R14 being (Element of ( RAT+ )) holds (R14 <> ( {} ) iff ( numerator R14 ) <> ( {} )))
proof
let R14 being (Element of ( RAT+ ));
thus L430:now
assume that
L431: R14 <> ( {} )
and
L432: ( numerator R14 ) = ( {} );
L433: (not R14 in ( omega )) by L431 , L432 , L383;
consider R11 being (Element of ( omega )), R12 being (Element of ( omega )) such that L434: R14 = [ R11 , R12 ] and L435: R11 , R12 are_relative_prime  and L436: R12 <> ( {} ) and L437: R12 <> 1 by L433 , L343;
L438: R11 = ( {} ) by L432 , L433 , L434 , L383;
thus L439: contradiction by L438 , L435 , L437 , L10;
end;
L440: ( {} ) in ( omega ) by ORDINAL1:def 11;
thus L441: thesis by L440 , L383;
end;
theorem
L442: (for R14 being (Element of ( RAT+ )) holds (R14 in ( omega ) iff ( denominator R14 ) = 1)) by L392 , L421;
definition
let C47 , C48 being  natural Ordinal;
func C47 / C48 -> (Element of ( RAT+ )) equals 
:L443: ( {} ) if C48 = ( {} ) , ( RED (C47 , C48) ) if ( RED (C48 , C47) ) = 1 otherwise [ ( RED (C47 , C48) ) , ( RED (C48 , C47) ) ];
coherence
proof
L444:
now
assume L445: C48 <> ( {} );
L446: (( RED (C47 , C48) ) , ( RED (C48 , C47) ) are_relative_prime  & ( RED (C48 , C47) ) <> ( {} )) by L445 , L259 , L263;
thus L447: (( RED (C48 , C47) ) <> 1 implies [ ( RED (C47 , C48) ) , ( RED (C48 , C47) ) ] in ( RAT+ )) by L446 , L368;
end;
L448: ( RED (C47 , C48) ) in ( omega );
thus L449: thesis by L448 , L444 , L1 , L340;
end;
consistency by L317;
end;
notation
let C49 , C50 being  natural Ordinal;
synonym quotient (C49 , C50) for C49 / C50;
end;
theorem
L452: (for R14 being (Element of ( RAT+ )) holds ( ( numerator R14 ) / ( denominator R14 ) ) = R14)
proof
let R14 being (Element of ( RAT+ ));
L453: ( denominator R14 ) <> ( {} ) by L414;
L454: ( RED (( numerator R14 ) , ( denominator R14 )) ) = ( numerator R14 ) by L308 , L402;
L455: ( numerator R14 ) , ( denominator R14 ) are_relative_prime  by L402;
L456: ( RED (( denominator R14 ) , ( numerator R14 )) ) = ( denominator R14 ) by L455 , L308;
per cases ;
suppose L457: ( denominator R14 ) = 1;

L458: R14 in ( omega ) by L457 , L421;
L459: ( numerator R14 ) = R14 by L458 , L383;
thus L460: thesis by L459 , L454 , L456 , L457 , L443;
end;
suppose L461: ( denominator R14 ) <> 1;

L462: (not R14 in ( omega )) by L461 , L392;
L463: R14 = [ ( numerator R14 ) , ( denominator R14 ) ] by L462 , L421;
thus L464: thesis by L463 , L453 , L454 , L456 , L461 , L443;
end;
end;
theorem
L466: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (( ( {} ) / R5 ) = ( {} ) & ( R4 / 1 ) = R4)))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
L467: (R5 <> ( {} ) implies ( RED (R5 , ( {} )) ) = 1) by L317;
L468: ( RED (( {} ) , R5) ) = ( {} ) by L317;
thus L469: ( ( {} ) / R5 ) = ( {} ) by L468 , L467 , L443;
L470: (( RED (1 , R4) ) = 1 & ( RED (R4 , 1) ) = R4) by L312;
thus L471: thesis by L470 , L443;
end;
theorem
L472: (for R4 being  natural Ordinal holds (R4 <> ( {} ) implies ( R4 / R4 ) = 1))
proof
let R4 being  natural Ordinal;
assume L473: R4 <> ( {} );
L474: ( RED (R4 , R4) ) = 1 by L473 , L321;
thus L475: thesis by L474 , L443;
end;
theorem
L476: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (R5 <> ( {} ) implies (( numerator ( R4 / R5 ) ) = ( RED (R4 , R5) ) & ( denominator ( R4 / R5 ) ) = ( RED (R5 , R4) )))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
assume L477: R5 <> ( {} );
per cases ;
suppose L478: ( RED (R5 , R4) ) = 1;

L479: ( R4 / R5 ) = ( RED (R4 , R5) ) by L478 , L443;
thus L480: thesis by L479 , L478 , L383 , L392;
end;
suppose L481: ( RED (R5 , R4) ) <> 1;

L482: (not [ ( RED (R4 , R5) ) , ( RED (R5 , R4) ) ] in ( omega )) by L364;
L483: ( R4 / R5 ) = [ ( RED (R4 , R5) ) , ( RED (R5 , R4) ) ] by L477 , L481 , L443;
thus L484: thesis by L483 , L482 , L383 , L392;
end;
end;
theorem
L486: (for R11 being (Element of ( omega )) holds (for R12 being (Element of ( omega )) holds ((R11 , R12 are_relative_prime  & R12 <> ( {} )) implies (( numerator ( R11 / R12 ) ) = R11 & ( denominator ( R11 / R12 ) ) = R12))))
proof
let R11 being (Element of ( omega ));
let R12 being (Element of ( omega ));
assume L487: R11 , R12 are_relative_prime ;
L488: (( RED (R11 , R12) ) = R11 & ( RED (R12 , R11) ) = R12) by L487 , L308;
thus L489: thesis by L488 , L476;
end;
theorem
L490: (for R4 being  natural Ordinal holds (for R5 being  natural Ordinal holds (for R6 being  natural Ordinal holds (R6 <> ( {} ) implies ( ( R4 *^ R6 ) / ( R5 *^ R6 ) ) = ( R4 / R5 )))))
proof
let R4 being  natural Ordinal;
let R5 being  natural Ordinal;
let R6 being  natural Ordinal;
assume L491: R6 <> ( {} );
per cases ;
suppose L492: R5 = ( {} );

L493: (( R4 / R5 ) = ( {} ) & ( R5 *^ R6 ) = ( {} )) by L492 , L443 , ORDINAL2:35;
thus L494: thesis by L493 , L443;
end;
suppose L495: R5 <> ( {} );

L496: ( R5 *^ R6 ) <> ( {} ) by L495 , L491 , ORDINAL3:31;
L497: ( denominator ( ( R4 *^ R6 ) / ( R5 *^ R6 ) ) ) = ( RED (( R5 *^ R6 ) , ( R4 *^ R6 )) ) by L496 , L476
.= ( RED (R5 , R4) ) by L491 , L324
.= ( denominator ( R4 / R5 ) ) by L495 , L476;
L498: ( numerator ( ( R4 *^ R6 ) / ( R5 *^ R6 ) ) ) = ( RED (( R4 *^ R6 ) , ( R5 *^ R6 )) ) by L496 , L476
.= ( RED (R4 , R5) ) by L491 , L324
.= ( numerator ( R4 / R5 ) ) by L495 , L476;
thus L499: ( ( R4 *^ R6 ) / ( R5 *^ R6 ) ) = ( ( numerator ( R4 / R5 ) ) / ( denominator ( R4 / R5 ) ) ) by L498 , L497 , L452
.= ( R4 / R5 ) by L452;
end;
end;
theorem
L501: (for R8 being  natural Ordinal holds (for R17 being  natural Ordinal holds (for R18 being  natural Ordinal holds (for R19 being  natural Ordinal holds ((R18 <> ( {} ) & R8 <> ( {} )) implies (( R17 / R18 ) = ( R19 / R8 ) iff ( R17 *^ R8 ) = ( R18 *^ R19 )))))))
proof
let R8 being  natural Ordinal;
let R17 being  natural Ordinal;
let R18 being  natural Ordinal;
let R19 being  natural Ordinal;
assume that
L502: R18 <> ( {} )
and
L503: R8 <> ( {} );
set D28 = ( R17 / R18 );
set D29 = ( R19 / R8 );
set D30 = ( numerator D29 );
set D31 = ( denominator D29 );
L504: D30 = ( RED (R19 , R8) ) by L503 , L476;
set D32 = ( numerator D28 );
set D33 = ( denominator D28 );
L505: D33 = ( RED (R18 , R17) ) by L502 , L476;
L506: D31 = ( RED (R8 , R19) ) by L503 , L476;
L507: D32 = ( RED (R17 , R18) ) by L502 , L476;
thus L508:now
assume L509: ( R17 / R18 ) = ( R19 / R8 );
L510: (R17 = ( D30 *^ ( R17 hcf R18 ) ) & R8 = ( D33 *^ ( R8 hcf R19 ) )) by L509 , L507 , L506 , L304;
thus L511: ( R17 *^ R8 ) = ( ( ( D30 *^ ( R17 hcf R18 ) ) *^ D33 ) *^ ( R8 hcf R19 ) ) by L510 , ORDINAL3:50
.= ( ( D30 *^ ( ( R17 hcf R18 ) *^ D33 ) ) *^ ( R8 hcf R19 ) ) by ORDINAL3:50
.= ( ( D30 *^ R18 ) *^ ( R8 hcf R19 ) ) by L505 , L304
.= ( R18 *^ ( D30 *^ ( R8 hcf R19 ) ) ) by ORDINAL3:50
.= ( R18 *^ R19 ) by L504 , L304;
end;
assume L512: ( R17 *^ R8 ) = ( R18 *^ R19 );
L513: D33 = ( RED (( R18 *^ R8 ) , ( R18 *^ R19 )) ) by L512 , L503 , L505 , L324;
L514: D33 = D31 by L513 , L502 , L506 , L324;
L515: D32 = ( RED (( R18 *^ R19 ) , ( R18 *^ R8 )) ) by L503 , L507 , L512 , L324;
L516: D32 = D30 by L515 , L502 , L504 , L324;
L517: D28 = ( D30 / D31 ) by L516 , L514 , L452;
thus L518: thesis by L517 , L452;
end;
definition
let C51 , C52 being (Element of ( RAT+ ));
func C51 + C52 -> (Element of ( RAT+ )) equals 
( ( ( ( numerator C51 ) *^ ( denominator C52 ) ) +^ ( ( numerator C52 ) *^ ( denominator C51 ) ) ) / ( ( denominator C51 ) *^ ( denominator C52 ) ) );
coherence;
commutativity
;
func C51 *' C52 -> (Element of ( RAT+ )) equals 
( ( ( numerator C51 ) *^ ( numerator C52 ) ) / ( ( denominator C51 ) *^ ( denominator C52 ) ) );
coherence;
commutativity
;
end;
theorem
L520: (for R8 being  natural Ordinal holds (for R17 being  natural Ordinal holds (for R18 being  natural Ordinal holds (for R19 being  natural Ordinal holds ((R18 <> ( {} ) & R8 <> ( {} )) implies ( ( R17 / R18 ) + ( R19 / R8 ) ) = ( ( ( R17 *^ R8 ) +^ ( R18 *^ R19 ) ) / ( R18 *^ R8 ) ))))))
proof
let R8 being  natural Ordinal;
let R17 being  natural Ordinal;
let R18 being  natural Ordinal;
let R19 being  natural Ordinal;
assume that
L521: R18 <> ( {} )
and
L522: R8 <> ( {} );
L523: (( denominator ( R19 / R8 ) ) = ( RED (R8 , R19) ) & ( denominator ( R17 / R18 ) ) = ( RED (R18 , R17) )) by L521 , L522 , L476;
L524: (( numerator ( R19 / R8 ) ) = ( RED (R19 , R8) ) & ( numerator ( R17 / R18 ) ) = ( RED (R17 , R18) )) by L521 , L522 , L476;
thus L525: ( ( R17 / R18 ) + ( R19 / R8 ) ) = ( ( ( ( ( RED (R17 , R18) ) *^ ( RED (R8 , R19) ) ) +^ ( ( RED (R18 , R17) ) *^ ( RED (R19 , R8) ) ) ) *^ ( R17 hcf R18 ) ) / ( ( ( RED (R18 , R17) ) *^ ( RED (R8 , R19) ) ) *^ ( R17 hcf R18 ) ) ) by L524 , L521 , L523 , L214 , L490
.= ( ( ( ( ( RED (R17 , R18) ) *^ ( RED (R8 , R19) ) ) +^ ( ( RED (R18 , R17) ) *^ ( RED (R19 , R8) ) ) ) *^ ( R17 hcf R18 ) ) / ( ( RED (R8 , R19) ) *^ ( ( RED (R18 , R17) ) *^ ( R17 hcf R18 ) ) ) ) by ORDINAL3:50
.= ( ( ( ( ( RED (R17 , R18) ) *^ ( RED (R8 , R19) ) ) +^ ( ( RED (R18 , R17) ) *^ ( RED (R19 , R8) ) ) ) *^ ( R17 hcf R18 ) ) / ( ( RED (R8 , R19) ) *^ R18 ) ) by L304
.= ( ( ( ( ( RED (R17 , R18) ) *^ ( RED (R8 , R19) ) ) *^ ( R17 hcf R18 ) ) +^ ( ( ( RED (R18 , R17) ) *^ ( RED (R19 , R8) ) ) *^ ( R17 hcf R18 ) ) ) / ( ( RED (R8 , R19) ) *^ R18 ) ) by ORDINAL3:46
.= ( ( ( ( RED (R8 , R19) ) *^ ( ( RED (R17 , R18) ) *^ ( R17 hcf R18 ) ) ) +^ ( ( ( RED (R18 , R17) ) *^ ( RED (R19 , R8) ) ) *^ ( R17 hcf R18 ) ) ) / ( ( RED (R8 , R19) ) *^ R18 ) ) by ORDINAL3:50
.= ( ( ( ( RED (R8 , R19) ) *^ R17 ) +^ ( ( ( RED (R18 , R17) ) *^ ( RED (R19 , R8) ) ) *^ ( R17 hcf R18 ) ) ) / ( ( RED (R8 , R19) ) *^ R18 ) ) by L304
.= ( ( ( ( RED (R8 , R19) ) *^ R17 ) +^ ( ( RED (R19 , R8) ) *^ ( ( RED (R18 , R17) ) *^ ( R17 hcf R18 ) ) ) ) / ( ( RED (R8 , R19) ) *^ R18 ) ) by ORDINAL3:50
.= ( ( ( ( RED (R8 , R19) ) *^ R17 ) +^ ( ( RED (R19 , R8) ) *^ R18 ) ) / ( ( RED (R8 , R19) ) *^ R18 ) ) by L304
.= ( ( ( ( ( RED (R8 , R19) ) *^ R17 ) +^ ( ( RED (R19 , R8) ) *^ R18 ) ) *^ ( R19 hcf R8 ) ) / ( ( ( RED (R8 , R19) ) *^ R18 ) *^ ( R19 hcf R8 ) ) ) by L522 , L214 , L490
.= ( ( ( ( ( RED (R8 , R19) ) *^ R17 ) +^ ( ( RED (R19 , R8) ) *^ R18 ) ) *^ ( R19 hcf R8 ) ) / ( R18 *^ ( ( RED (R8 , R19) ) *^ ( R19 hcf R8 ) ) ) ) by ORDINAL3:50
.= ( ( ( ( ( RED (R8 , R19) ) *^ R17 ) +^ ( ( RED (R19 , R8) ) *^ R18 ) ) *^ ( R19 hcf R8 ) ) / ( R18 *^ R8 ) ) by L304
.= ( ( ( ( ( RED (R8 , R19) ) *^ R17 ) *^ ( R19 hcf R8 ) ) +^ ( ( ( RED (R19 , R8) ) *^ R18 ) *^ ( R19 hcf R8 ) ) ) / ( R18 *^ R8 ) ) by ORDINAL3:46
.= ( ( ( R17 *^ ( ( RED (R8 , R19) ) *^ ( R19 hcf R8 ) ) ) +^ ( ( ( RED (R19 , R8) ) *^ R18 ) *^ ( R19 hcf R8 ) ) ) / ( R18 *^ R8 ) ) by ORDINAL3:50
.= ( ( ( R17 *^ R8 ) +^ ( ( ( RED (R19 , R8) ) *^ R18 ) *^ ( R19 hcf R8 ) ) ) / ( R18 *^ R8 ) ) by L304
.= ( ( ( R17 *^ R8 ) +^ ( R18 *^ ( ( RED (R19 , R8) ) *^ ( R19 hcf R8 ) ) ) ) / ( R18 *^ R8 ) ) by ORDINAL3:50
.= ( ( ( R17 *^ R8 ) +^ ( R18 *^ R19 ) ) / ( R18 *^ R8 ) ) by L304;
end;
theorem
L526: (for R17 being  natural Ordinal holds (for R18 being  natural Ordinal holds (for R19 being  natural Ordinal holds (R19 <> ( {} ) implies ( ( R17 / R19 ) + ( R18 / R19 ) ) = ( ( R17 +^ R18 ) / R19 )))))
proof
let R17 being  natural Ordinal;
let R18 being  natural Ordinal;
let R19 being  natural Ordinal;
assume L527: R19 <> ( {} );
thus L528: ( ( R17 / R19 ) + ( R18 / R19 ) ) = ( ( ( R17 *^ R19 ) +^ ( R18 *^ R19 ) ) / ( R19 *^ R19 ) ) by L527 , L520
.= ( ( ( R17 +^ R18 ) *^ R19 ) / ( R19 *^ R19 ) ) by ORDINAL3:46
.= ( ( R17 +^ R18 ) / R19 ) by L527 , L490;
end;
registration
cluster  empty for (Element of ( RAT+ ));
existence by L1 , L340;
end;
definition
redefine func {} -> (Element of ( RAT+ ));

coherence by L1 , L340;
redefine func one -> non  empty  ordinal (Element of ( RAT+ ));

coherence by L2 , L340;
end;
theorem
L531: (for R14 being (Element of ( RAT+ )) holds ( R14 *' ( {} ) ) = ( {} ))
proof
let R14 being (Element of ( RAT+ ));
L532: (( numerator ( {} ) ) = ( {} ) & ( ( numerator R14 ) *^ ( {} ) ) = ( {} )) by L383 , L1 , ORDINAL2:35;
thus L533: thesis by L532 , L466;
end;
theorem
L534: (for R8 being  natural Ordinal holds (for R17 being  natural Ordinal holds (for R18 being  natural Ordinal holds (for R19 being  natural Ordinal holds ( ( R17 / R18 ) *' ( R19 / R8 ) ) = ( ( R17 *^ R19 ) / ( R18 *^ R8 ) )))))
proof
let R8 being  natural Ordinal;
let R17 being  natural Ordinal;
let R18 being  natural Ordinal;
let R19 being  natural Ordinal;
per cases ;
suppose L535: (R18 <> ( {} ) & R8 <> ( {} ));

L536: (( denominator ( R19 / R8 ) ) = ( RED (R8 , R19) ) & ( denominator ( R17 / R18 ) ) = ( RED (R18 , R17) )) by L535 , L476;
L537: (( numerator ( R19 / R8 ) ) = ( RED (R19 , R8) ) & ( numerator ( R17 / R18 ) ) = ( RED (R17 , R18) )) by L535 , L476;
thus L538: ( ( R17 / R18 ) *' ( R19 / R8 ) ) = ( ( ( ( RED (R17 , R18) ) *^ ( RED (R19 , R8) ) ) *^ ( R17 hcf R18 ) ) / ( ( ( RED (R18 , R17) ) *^ ( RED (R8 , R19) ) ) *^ ( R17 hcf R18 ) ) ) by L537 , L535 , L536 , L214 , L490
.= ( ( ( RED (R19 , R8) ) *^ ( ( RED (R17 , R18) ) *^ ( R17 hcf R18 ) ) ) / ( ( ( RED (R18 , R17) ) *^ ( RED (R8 , R19) ) ) *^ ( R17 hcf R18 ) ) ) by ORDINAL3:50
.= ( ( ( RED (R19 , R8) ) *^ R17 ) / ( ( ( RED (R18 , R17) ) *^ ( RED (R8 , R19) ) ) *^ ( R17 hcf R18 ) ) ) by L304
.= ( ( ( RED (R19 , R8) ) *^ R17 ) / ( ( RED (R8 , R19) ) *^ ( ( RED (R18 , R17) ) *^ ( R17 hcf R18 ) ) ) ) by ORDINAL3:50
.= ( ( ( RED (R19 , R8) ) *^ R17 ) / ( ( RED (R8 , R19) ) *^ R18 ) ) by L304
.= ( ( ( ( RED (R19 , R8) ) *^ R17 ) *^ ( R8 hcf R19 ) ) / ( ( ( RED (R8 , R19) ) *^ R18 ) *^ ( R8 hcf R19 ) ) ) by L535 , L214 , L490
.= ( ( R17 *^ ( ( RED (R19 , R8) ) *^ ( R8 hcf R19 ) ) ) / ( ( ( RED (R8 , R19) ) *^ R18 ) *^ ( R8 hcf R19 ) ) ) by ORDINAL3:50
.= ( ( R17 *^ R19 ) / ( ( ( RED (R8 , R19) ) *^ R18 ) *^ ( R8 hcf R19 ) ) ) by L304
.= ( ( R17 *^ R19 ) / ( R18 *^ ( ( RED (R8 , R19) ) *^ ( R8 hcf R19 ) ) ) ) by ORDINAL3:50
.= ( ( R17 *^ R19 ) / ( R18 *^ R8 ) ) by L304;
end;
suppose L539: (R18 = ( {} ) or R8 = ( {} ));

L540: (( R17 / R18 ) = ( {} ) or ( R19 / R8 ) = ( {} )) by L539 , L443;
L541: ( ( R17 / R18 ) *' ( R19 / R8 ) ) = ( {} ) by L540 , L531;
L542: ( R18 *^ R8 ) = ( {} ) by L539 , ORDINAL2:35;
thus L543: thesis by L542 , L541 , L443;
end;
end;
theorem
L545: (for R14 being (Element of ( RAT+ )) holds ( R14 + ( {} ) ) = R14)
proof
let R14 being (Element of ( RAT+ ));
L546: (( ( numerator R14 ) *^ 1 ) = ( numerator R14 ) & ( ( {} ) *^ ( denominator R14 ) ) = ( {} )) by ORDINAL2:35 , ORDINAL2:39;
L547: (( ( denominator R14 ) *^ 1 ) = ( denominator R14 ) & ( ( numerator R14 ) +^ ( {} ) ) = ( numerator R14 )) by ORDINAL2:27 , ORDINAL2:39;
L548: (( denominator ( {} ) ) = 1 & ( numerator ( {} ) ) = ( {} )) by L383 , L392 , L1;
thus L549: thesis by L548 , L546 , L547 , L452;
end;
theorem
L550: (for R14 being (Element of ( RAT+ )) holds (for R15 being (Element of ( RAT+ )) holds (for R16 being (Element of ( RAT+ )) holds ( ( R14 + R15 ) + R16 ) = ( R14 + ( R15 + R16 ) ))))
proof
let R14 being (Element of ( RAT+ ));
let R15 being (Element of ( RAT+ ));
let R16 being (Element of ( RAT+ ));
set D34 = ( numerator R14 );
set D35 = ( numerator R15 );
set D36 = ( numerator R16 );
set D37 = ( denominator R14 );
set D38 = ( denominator R15 );
set D39 = ( denominator R16 );
L551: D38 <> ( {} ) by L414;
L552: D39 <> ( {} ) by L414;
L553: ( D38 *^ D39 ) <> ( {} ) by L552 , L551 , ORDINAL3:31;
L554: D37 <> ( {} ) by L414;
L555: ( D37 *^ D38 ) <> ( {} ) by L554 , L551 , ORDINAL3:31;
thus L556: ( ( R14 + R15 ) + R16 ) = ( ( ( ( D34 *^ D38 ) +^ ( D37 *^ D35 ) ) / ( D37 *^ D38 ) ) + ( D36 / D39 ) ) by L452
.= ( ( ( ( ( D34 *^ D38 ) +^ ( D37 *^ D35 ) ) *^ D39 ) +^ ( ( D37 *^ D38 ) *^ D36 ) ) / ( ( D37 *^ D38 ) *^ D39 ) ) by L552 , L555 , L520
.= ( ( ( ( ( D34 *^ D38 ) *^ D39 ) +^ ( ( D37 *^ D35 ) *^ D39 ) ) +^ ( ( D37 *^ D38 ) *^ D36 ) ) / ( ( D37 *^ D38 ) *^ D39 ) ) by ORDINAL3:46
.= ( ( ( ( D34 *^ ( D38 *^ D39 ) ) +^ ( ( D37 *^ D35 ) *^ D39 ) ) +^ ( ( D37 *^ D38 ) *^ D36 ) ) / ( ( D37 *^ D38 ) *^ D39 ) ) by ORDINAL3:50
.= ( ( ( ( D34 *^ ( D38 *^ D39 ) ) +^ ( D37 *^ ( D35 *^ D39 ) ) ) +^ ( ( D37 *^ D38 ) *^ D36 ) ) / ( ( D37 *^ D38 ) *^ D39 ) ) by ORDINAL3:50
.= ( ( ( ( D34 *^ ( D38 *^ D39 ) ) +^ ( D37 *^ ( D35 *^ D39 ) ) ) +^ ( D37 *^ ( D38 *^ D36 ) ) ) / ( ( D37 *^ D38 ) *^ D39 ) ) by ORDINAL3:50
.= ( ( ( D34 *^ ( D38 *^ D39 ) ) +^ ( ( D37 *^ ( D35 *^ D39 ) ) +^ ( D37 *^ ( D38 *^ D36 ) ) ) ) / ( ( D37 *^ D38 ) *^ D39 ) ) by ORDINAL3:30
.= ( ( ( D34 *^ ( D38 *^ D39 ) ) +^ ( D37 *^ ( ( D35 *^ D39 ) +^ ( D38 *^ D36 ) ) ) ) / ( ( D37 *^ D38 ) *^ D39 ) ) by ORDINAL3:46
.= ( ( ( D34 *^ ( D38 *^ D39 ) ) +^ ( D37 *^ ( ( D35 *^ D39 ) +^ ( D38 *^ D36 ) ) ) ) / ( D37 *^ ( D38 *^ D39 ) ) ) by ORDINAL3:50
.= ( ( ( ( D35 *^ D39 ) +^ ( D38 *^ D36 ) ) / ( D38 *^ D39 ) ) + ( D34 / D37 ) ) by L554 , L553 , L520
.= ( R14 + ( R15 + R16 ) ) by L452;
end;
theorem
L557: (for R14 being (Element of ( RAT+ )) holds (for R15 being (Element of ( RAT+ )) holds (for R16 being (Element of ( RAT+ )) holds ( ( R14 *' R15 ) *' R16 ) = ( R14 *' ( R15 *' R16 ) ))))
proof
let R14 being (Element of ( RAT+ ));
let R15 being (Element of ( RAT+ ));
let R16 being (Element of ( RAT+ ));
set D40 = ( numerator R14 );
set D41 = ( numerator R15 );
set D42 = ( numerator R16 );
set D43 = ( denominator R14 );
set D44 = ( denominator R15 );
set D45 = ( denominator R16 );
L558: R14 = ( D40 / D43 ) by L452;
L559: R16 = ( D42 / D45 ) by L452;
thus L560: ( ( R14 *' R15 ) *' R16 ) = ( ( ( D40 *^ D41 ) *^ D42 ) / ( ( D43 *^ D44 ) *^ D45 ) ) by L559 , L534
.= ( ( D40 *^ ( D41 *^ D42 ) ) / ( ( D43 *^ D44 ) *^ D45 ) ) by ORDINAL3:50
.= ( ( D40 *^ ( D41 *^ D42 ) ) / ( D43 *^ ( D44 *^ D45 ) ) ) by ORDINAL3:50
.= ( R14 *' ( R15 *' R16 ) ) by L558 , L534;
end;
theorem
L561: (for R14 being (Element of ( RAT+ )) holds ( R14 *' ( one ) ) = R14)
proof
let R14 being (Element of ( RAT+ ));
set D46 = ( one );
L562: (( ( numerator R14 ) *^ 1 ) = ( numerator R14 ) & ( ( denominator R14 ) *^ 1 ) = ( denominator R14 )) by ORDINAL2:39;
L563: (( numerator D46 ) = 1 & ( denominator D46 ) = 1) by L383 , L392;
thus L564: thesis by L563 , L562 , L452;
end;
theorem
L565: (for R14 being (Element of ( RAT+ )) holds (R14 <> ( {} ) implies (ex R15 being (Element of ( RAT+ )) st ( R14 *' R15 ) = 1)))
proof
let R14 being (Element of ( RAT+ ));
set D47 = ( numerator R14 );
set D48 = ( denominator R14 );
L566: D48 <> ( {} ) by L414;
assume L567: R14 <> ( {} );
L568: D47 <> ( {} ) by L567 , L429;
take D49 = ( D48 / D47 );
L569: D47 , D48 are_relative_prime  by L402;
L570: (( denominator D49 ) = D47 & ( numerator D49 ) = D48) by L569 , L568 , L486;
thus L571: thesis by L570 , L568 , L566 , L472 , ORDINAL3:31;
end;
theorem
L572: (for R14 being (Element of ( RAT+ )) holds (for R15 being (Element of ( RAT+ )) holds (R14 <> ( {} ) implies (ex R16 being (Element of ( RAT+ )) st R15 = ( R14 *' R16 )))))
proof
let R14 being (Element of ( RAT+ ));
let R15 being (Element of ( RAT+ ));
reconsider D50 = ( one ) as (Element of ( RAT+ ));
assume L573: R14 <> ( {} );
consider R16 being (Element of ( RAT+ )) such that L574: ( R14 *' R16 ) = 1 by L573 , L565;
take ( R16 *' R15 );
thus L575: R15 = ( R15 *' D50 ) by L561
.= ( R14 *' ( R16 *' R15 ) ) by L574 , L557;
end;
theorem
L576: (for R14 being (Element of ( RAT+ )) holds (for R15 being (Element of ( RAT+ )) holds (for R16 being (Element of ( RAT+ )) holds ((R14 <> ( {} ) & ( R14 *' R15 ) = ( R14 *' R16 )) implies R15 = R16))))
proof
let R14 being (Element of ( RAT+ ));
let R15 being (Element of ( RAT+ ));
let R16 being (Element of ( RAT+ ));
assume L577: R14 <> ( {} );
consider C53 being (Element of ( RAT+ )) such that L578: ( R14 *' C53 ) = 1 by L577 , L565;
L579: ( C53 *' ( R14 *' R15 ) ) = ( ( one ) *' R15 ) by L578 , L557;
L580: ( C53 *' ( R14 *' R15 ) ) = R15 by L579 , L561;
L581: ( C53 *' ( R14 *' R16 ) ) = ( ( one ) *' R16 ) by L578 , L557;
thus L582: thesis by L581 , L580 , L561;
end;
theorem
L583: (for R14 being (Element of ( RAT+ )) holds (for R15 being (Element of ( RAT+ )) holds (for R16 being (Element of ( RAT+ )) holds ( R14 *' ( R15 + R16 ) ) = ( ( R14 *' R15 ) + ( R14 *' R16 ) ))))
proof
let R14 being (Element of ( RAT+ ));
let R15 being (Element of ( RAT+ ));
let R16 being (Element of ( RAT+ ));
set D51 = ( numerator R14 );
set D52 = ( numerator R15 );
set D53 = ( numerator R16 );
set D54 = ( denominator R14 );
set D55 = ( denominator R15 );
set D56 = ( denominator R16 );
L584: D54 <> ( {} ) by L414;
L585: D56 <> ( {} ) by L414;
L586: ( D54 *^ D56 ) <> ( {} ) by L585 , L584 , ORDINAL3:31;
L587: D55 <> ( {} ) by L414;
L588: ( D54 *^ D55 ) <> ( {} ) by L587 , L584 , ORDINAL3:31;
L589: R14 = ( D51 / D54 ) by L452;
thus L590: ( R14 *' ( R15 + R16 ) ) = ( ( D51 *^ ( ( D52 *^ D56 ) +^ ( D55 *^ D53 ) ) ) / ( D54 *^ ( D55 *^ D56 ) ) ) by L589 , L534
.= ( ( ( D51 *^ ( D52 *^ D56 ) ) +^ ( D51 *^ ( D55 *^ D53 ) ) ) / ( D54 *^ ( D55 *^ D56 ) ) ) by ORDINAL3:46
.= ( ( ( ( D51 *^ D52 ) *^ D56 ) +^ ( D51 *^ ( D55 *^ D53 ) ) ) / ( D54 *^ ( D55 *^ D56 ) ) ) by ORDINAL3:50
.= ( ( ( ( D51 *^ D52 ) *^ D56 ) +^ ( D55 *^ ( D51 *^ D53 ) ) ) / ( D54 *^ ( D55 *^ D56 ) ) ) by ORDINAL3:50
.= ( ( ( ( D51 *^ D52 ) *^ D56 ) +^ ( D55 *^ ( D51 *^ D53 ) ) ) / ( D55 *^ ( D54 *^ D56 ) ) ) by ORDINAL3:50
.= ( ( D54 *^ ( ( ( D51 *^ D52 ) *^ D56 ) +^ ( D55 *^ ( D51 *^ D53 ) ) ) ) / ( D54 *^ ( D55 *^ ( D54 *^ D56 ) ) ) ) by L414 , L490
.= ( ( ( D54 *^ ( ( D51 *^ D52 ) *^ D56 ) ) +^ ( D54 *^ ( D55 *^ ( D51 *^ D53 ) ) ) ) / ( D54 *^ ( D55 *^ ( D54 *^ D56 ) ) ) ) by ORDINAL3:46
.= ( ( ( D54 *^ ( ( D51 *^ D52 ) *^ D56 ) ) +^ ( ( D54 *^ D55 ) *^ ( D51 *^ D53 ) ) ) / ( D54 *^ ( D55 *^ ( D54 *^ D56 ) ) ) ) by ORDINAL3:50
.= ( ( ( ( D51 *^ D52 ) *^ ( D54 *^ D56 ) ) +^ ( ( D54 *^ D55 ) *^ ( D51 *^ D53 ) ) ) / ( D54 *^ ( D55 *^ ( D54 *^ D56 ) ) ) ) by ORDINAL3:50
.= ( ( ( ( D51 *^ D52 ) *^ ( D54 *^ D56 ) ) +^ ( ( D54 *^ D55 ) *^ ( D51 *^ D53 ) ) ) / ( ( D54 *^ D55 ) *^ ( D54 *^ D56 ) ) ) by ORDINAL3:50
.= ( ( R14 *' R15 ) + ( R14 *' R16 ) ) by L586 , L588 , L520;
end;
theorem
L591: (for B25 , B26 being  ordinal (Element of ( RAT+ )) holds ( B25 + B26 ) = ( B25 +^ B26 ))
proof
let C54 , C55 being  ordinal (Element of ( RAT+ ));
set D57 = ( numerator C54 );
set D58 = ( numerator C55 );
L592: C55 in ( omega ) by ORDINAL1:def 12;
L593: ( denominator C55 ) = 1 by L592 , L392;
L594: C54 in ( omega ) by ORDINAL1:def 12;
L595: ( denominator C54 ) = 1 by L594 , L392;
thus L596: ( C54 + C55 ) = ( ( ( D57 *^ 1 ) +^ ( 1 *^ D58 ) ) / 1 ) by L595 , L593 , ORDINAL2:39
.= ( ( D57 +^ ( 1 *^ D58 ) ) / 1 ) by ORDINAL2:39
.= ( ( D57 +^ D58 ) / 1 ) by ORDINAL2:39
.= ( D57 +^ D58 ) by L466
.= ( C54 +^ D58 ) by L594 , L383
.= ( C54 +^ C55 ) by L592 , L383;
end;
theorem
L597: (for B27 , B28 being  ordinal (Element of ( RAT+ )) holds ( B27 *' B28 ) = ( B27 *^ B28 ))
proof
let C56 , C57 being  ordinal (Element of ( RAT+ ));
set D59 = ( numerator C56 );
set D60 = ( numerator C57 );
L598: C57 in ( omega ) by ORDINAL1:def 12;
L599: ( denominator C57 ) = 1 by L598 , L392;
L600: C56 in ( omega ) by ORDINAL1:def 12;
L601: ( denominator C56 ) = 1 by L600 , L392;
thus L602: ( C56 *' C57 ) = ( ( D59 *^ D60 ) / 1 ) by L601 , L599 , ORDINAL2:39
.= ( D59 *^ D60 ) by L466
.= ( C56 *^ D60 ) by L600 , L383
.= ( C56 *^ C57 ) by L598 , L383;
end;
theorem
L603: (for R14 being (Element of ( RAT+ )) holds (ex R15 being (Element of ( RAT+ )) st R14 = ( R15 + R15 )))
proof
let R14 being (Element of ( RAT+ ));
set D61 = ( ( one ) + ( one ) );
L604: D61 = ( 1 +^ 1 ) by L591;
L605: D61 <> ( {} ) by L604 , ORDINAL3:26;
consider R16 being (Element of ( RAT+ )) such that L606: ( D61 *' R16 ) = 1 by L605 , L565;
take D62 = ( R16 *' R14 );
thus L607: R14 = ( ( one ) *' R14 ) by L561
.= ( D61 *' D62 ) by L606 , L557
.= ( ( ( one ) *' D62 ) + ( ( one ) *' D62 ) ) by L583
.= ( D62 + ( ( one ) *' D62 ) ) by L561
.= ( D62 + D62 ) by L561;
end;
definition
let C58 , C59 being (Element of ( RAT+ ));
pred C58 <=' C59
means
:L608: (ex B29 being (Element of ( RAT+ )) st C59 = ( C58 + B29 ))
;connectedness
proof
let C60 , C61 being (Element of ( RAT+ ));
set D63 = ( numerator C60 );
set D64 = ( numerator C61 );
set D65 = ( denominator C60 );
set D66 = ( denominator C61 );
L609: (D65 <> ( {} ) & D66 <> ( {} )) by L414;
L610: (( D63 / D65 ) = C60 & ( D64 / D66 ) = C61) by L452;
L611: (( D63 *^ D66 ) c= ( D64 *^ D65 ) or ( D64 *^ D65 ) c= ( D63 *^ D66 ));
L612: (( D64 *^ D65 ) = ( ( D63 *^ D66 ) +^ ( ( D64 *^ D65 ) -^ ( D63 *^ D66 ) ) ) or ( D63 *^ D66 ) = ( ( D64 *^ D65 ) +^ ( ( D63 *^ D66 ) -^ ( D64 *^ D65 ) ) )) by L611 , ORDINAL3:def 5;
L613: (( ( D63 *^ D66 ) / ( D65 *^ D66 ) ) = ( D63 / D65 ) & ( ( D64 *^ D65 ) / ( D65 *^ D66 ) ) = ( D64 / D66 )) by L414 , L490;
L614: (C60 = ( C61 + ( ( ( D63 *^ D66 ) -^ ( D64 *^ D65 ) ) / ( D65 *^ D66 ) ) ) or C61 = ( C60 + ( ( ( D64 *^ D65 ) -^ ( D63 *^ D66 ) ) / ( D65 *^ D66 ) ) )) by L613 , L609 , L610 , L612 , L526 , ORDINAL3:31;
thus L615: thesis by L614;
end;
end;
notation
let C62 , C63 being (Element of ( RAT+ ));
antonym C63 < C62 for C62 <=' C63;
end;
theorem
L618: (not (ex B30 being set st [ ( {} ) , B30 ] in ( RAT+ )))
proof
given C64 being set such that
L619: [ ( {} ) , C64 ] in ( RAT+ );

consider C65 , C66 being (Element of ( omega )) such that L620: [ ( {} ) , C64 ] = [ C65 , C66 ] and L621: C65 , C66 are_relative_prime  and L622: C66 <> ( {} ) and L623: C66 <> 1 by L619 , L343 , L364;
L624: C65 = ( {} ) by L620 , XTUPLE_0:1;
thus L625: thesis by L624 , L621 , L623 , L10;
end;
theorem
L626: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds (( R21 + R22 ) = ( R20 + R22 ) implies R21 = R20))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
assume L627: ( R21 + R22 ) = ( R20 + R22 );
set D67 = ( numerator R20 );
set D68 = ( denominator R20 );
set D69 = ( numerator R22 );
set D70 = ( denominator R22 );
set D71 = ( numerator R21 );
set D72 = ( denominator R21 );
L628: D70 <> ( {} ) by L414;
L629: D72 <> ( {} ) by L414;
L630: ( D72 *^ D70 ) <> ( {} ) by L629 , L628 , ORDINAL3:31;
L631: D68 <> ( {} ) by L414;
L632: ( D68 *^ D70 ) <> ( {} ) by L631 , L628 , ORDINAL3:31;
L633: ( ( ( D71 *^ D70 ) +^ ( D72 *^ D69 ) ) *^ ( D68 *^ D70 ) ) = ( ( ( D67 *^ D70 ) +^ ( D68 *^ D69 ) ) *^ ( D72 *^ D70 ) ) by L632 , L627 , L630 , L501
.= ( ( ( ( D67 *^ D70 ) +^ ( D68 *^ D69 ) ) *^ D72 ) *^ D70 ) by ORDINAL3:50;
L634: ( ( ( ( D71 *^ D70 ) +^ ( D72 *^ D69 ) ) *^ D68 ) *^ D70 ) = ( ( ( ( D67 *^ D70 ) +^ ( D68 *^ D69 ) ) *^ D72 ) *^ D70 ) by L633 , ORDINAL3:50;
L635: ( ( ( D71 *^ D70 ) +^ ( D72 *^ D69 ) ) *^ D68 ) = ( ( ( D67 *^ D70 ) +^ ( D68 *^ D69 ) ) *^ D72 ) by L634 , L628 , ORDINAL3:33
.= ( ( ( D67 *^ D70 ) *^ D72 ) +^ ( ( D68 *^ D69 ) *^ D72 ) ) by ORDINAL3:46;
L636: ( ( ( D71 *^ D70 ) *^ D68 ) +^ ( ( D72 *^ D69 ) *^ D68 ) ) = ( ( ( D67 *^ D70 ) *^ D72 ) +^ ( ( D68 *^ D69 ) *^ D72 ) ) by L635 , ORDINAL3:46
.= ( ( ( D67 *^ D70 ) *^ D72 ) +^ ( ( D72 *^ D69 ) *^ D68 ) ) by ORDINAL3:50;
L637: ( ( D71 *^ D70 ) *^ D68 ) = ( ( D67 *^ D70 ) *^ D72 ) by L636 , ORDINAL3:21
.= ( ( D67 *^ D72 ) *^ D70 ) by ORDINAL3:50;
L638: ( ( D71 *^ D68 ) *^ D70 ) = ( ( D67 *^ D72 ) *^ D70 ) by L637 , ORDINAL3:50;
L639: ( D71 *^ D68 ) = ( D67 *^ D72 ) by L638 , L628 , ORDINAL3:33;
L640: ( D71 / D72 ) = ( D67 / D68 ) by L639 , L629 , L631 , L501
.= R20 by L452;
thus L641: thesis by L640 , L452;
end;
theorem
L642: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (( R20 + R21 ) = ( {} ) implies R20 = ( {} ))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
set D73 = ( numerator R20 );
set D74 = ( denominator R20 );
set D75 = ( numerator R21 );
set D76 = ( denominator R21 );
assume L643: ( R20 + R21 ) = ( {} );
L644: (( denominator ( {} ) ) = 1 & ( numerator ( {} ) ) = ( {} )) by L383 , L392 , L1;
L645: ( ( ( D73 *^ D76 ) +^ ( D75 *^ D74 ) ) / ( D74 *^ D76 ) ) = ( ( {} ) / 1 ) by L644 , L643 , L452;
L646: D76 <> ( {} ) by L414;
L647: D74 <> ( {} ) by L414;
L648: ( D74 *^ D76 ) <> ( {} ) by L647 , L646 , ORDINAL3:31;
L649: ( ( ( D73 *^ D76 ) +^ ( D75 *^ D74 ) ) *^ 1 ) = ( ( D74 *^ D76 ) *^ ( {} ) ) by L648 , L645 , L501
.= ( {} ) by ORDINAL2:35;
L650: ( ( D73 *^ D76 ) +^ ( D75 *^ D74 ) ) = ( {} ) by L649 , ORDINAL3:31;
L651: ( D73 *^ D76 ) = ( {} ) by L650 , ORDINAL3:26;
L652: D73 = ( {} ) by L651 , L646 , ORDINAL3:31;
thus L653: thesis by L652 , L429;
end;
theorem
L654: (for R21 being (Element of ( RAT+ )) holds ( {} ) <=' R21)
proof
let R21 being (Element of ( RAT+ ));
take R21;
thus L655: thesis by L545;
end;
theorem
L656: (for R21 being (Element of ( RAT+ )) holds (R21 <=' ( {} ) implies R21 = ( {} )))
proof
let R21 being (Element of ( RAT+ ));
assume L657: (ex R20 being (Element of ( RAT+ )) st ( {} ) = ( R21 + R20 ));
thus L658: thesis by L657 , L642;
end;
theorem
L659: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds ((R20 <=' R21 & R21 <=' R20) implies R20 = R21)))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
given R14 being (Element of ( RAT+ )) such that
L660: R21 = ( R20 + R14 );

given R15 being (Element of ( RAT+ )) such that
L661: R20 = ( R21 + R15 );

L662: ( R20 + ( {} ) ) = R20 by L545
.= ( R20 + ( R14 + R15 ) ) by L660 , L661 , L550;
L663: R14 = ( {} ) by L662 , L626 , L642;
thus L664: thesis by L663 , L660 , L545;
end;
theorem
L665: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds ((R20 <=' R21 & R21 <=' R22) implies R20 <=' R22))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
given R14 being (Element of ( RAT+ )) such that
L666: R21 = ( R20 + R14 );

given R15 being (Element of ( RAT+ )) such that
L667: R22 = ( R21 + R15 );

take ( R14 + R15 );
thus L668: thesis by L666 , L667 , L550;
end;
theorem
L669: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (R20 < R21 iff (R20 <=' R21 & R20 <> R21)))) by L659;
theorem
L670: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds (((R20 < R21 & R21 <=' R22) or (R20 <=' R21 & R21 < R22)) implies R20 < R22)))) by L665;
theorem
L671: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds ((R20 < R21 & R21 < R22) implies R20 < R22)))) by L665;
theorem
L672: (for R14 being (Element of ( RAT+ )) holds (for R15 being (Element of ( RAT+ )) holds ((R14 in ( omega ) & ( R14 + R15 ) in ( omega )) implies R15 in ( omega ))))
proof
let R14 being (Element of ( RAT+ ));
let R15 being (Element of ( RAT+ ));
assume that
L673: R14 in ( omega )
and
L674: ( R14 + R15 ) in ( omega );
L675: ( denominator ( R14 + R15 ) ) = 1 by L674 , L392;
set D77 = ( numerator R14 );
set D78 = ( denominator R14 );
L676: D78 = 1 by L673 , L392;
set D79 = ( numerator R15 );
set D80 = ( denominator R15 );
L677: (( R14 + R15 ) = ( ( numerator ( R14 + R15 ) ) / ( denominator ( R14 + R15 ) ) ) & ( ( ( D77 *^ D80 ) +^ ( D79 *^ D78 ) ) *^ 1 ) = ( ( D77 *^ D80 ) +^ ( D79 *^ D78 ) )) by L452 , ORDINAL2:39;
L678: D80 <> ( {} ) by L414;
L679: ( D78 *^ D80 ) <> ( {} ) by L678 , L676 , ORDINAL3:31;
L680: ( ( D77 *^ D80 ) +^ ( D79 *^ D78 ) ) = ( ( D78 *^ D80 ) *^ ( numerator ( R14 + R15 ) ) ) by L679 , L675 , L677 , L501
.= ( D80 *^ ( numerator ( R14 + R15 ) ) ) by L676 , ORDINAL2:39;
L681: ( ( D77 *^ D80 ) +^ D79 ) = ( D80 *^ ( numerator ( R14 + R15 ) ) ) by L680 , L676 , ORDINAL2:39;
L682: D79 = ( ( D80 *^ ( numerator ( R14 + R15 ) ) ) -^ ( D77 *^ D80 ) ) by L681 , ORDINAL3:52;
L683: D79 = ( D80 *^ ( ( numerator ( R14 + R15 ) ) -^ D77 ) ) by L682 , ORDINAL3:63;
L684: D80 divides D79 by L683 , L62;
L685: D79 , D80 are_relative_prime  by L402;
L686: (for B31 being  natural Ordinal holds ((B31 divides D80 & B31 divides D79) implies B31 divides D80));
L687: ( D80 hcf D79 ) = D80 by L686 , L684 , L179;
L688: D80 = 1 by L687 , L685 , L290;
L689: R15 = ( D79 / D80 ) by L452;
L690: R15 = D79 by L689 , L688 , L466;
thus L691: thesis by L690;
end;
theorem
L692: (for R14 being (Element of ( RAT+ )) holds (for B32 being  ordinal (Element of ( RAT+ )) holds ((B32 < R14 & R14 < ( B32 + ( one ) )) implies (not R14 in ( omega )))))
proof
let R14 being (Element of ( RAT+ ));
let C67 being  ordinal (Element of ( RAT+ ));
assume that
L693: C67 < R14
and
L694: R14 < ( C67 + ( one ) )
and
L695: R14 in ( omega );
consider R16 being (Element of ( RAT+ )) such that L696: ( C67 + ( one ) ) = ( R14 + R16 ) by L694 , L608;
L697: ( C67 + ( one ) ) = ( C67 +^ 1 ) by L591;
L698: ( C67 + ( one ) ) in ( omega ) by L697 , L355;
reconsider D81 = R16 as (Element of ( omega )) by L698 , L695 , L696 , L672;
consider R15 being (Element of ( RAT+ )) such that L699: R14 = ( C67 + R15 ) by L693 , L608;
L700: C67 in ( omega ) by L355;
reconsider D82 = R15 as (Element of ( omega )) by L700 , L695 , L699 , L672;
L701: ( C67 + ( one ) ) = ( C67 + ( R15 + R16 ) ) by L699 , L696 , L550;
L702: 1 = ( R15 + R16 ) by L701 , L626
.= ( D82 +^ D81 ) by L591;
L703: D82 c= 1 by L702 , ORDINAL3:24;
L704: (R15 = ( {} ) or R15 = 1) by L703 , ORDINAL3:16;
L705: (C67 = R14 or ( C67 + ( one ) ) = R14) by L704 , L699 , L545;
thus L706: contradiction by L705 , L693 , L694;
end;
theorem
L707: (for R22 being (Element of ( RAT+ )) holds (R22 <> ( {} ) implies (ex R20 being (Element of ( RAT+ )) st (R20 < R22 & (not R20 in ( omega ))))))
proof
let R22 being (Element of ( RAT+ ));
assume L708: R22 <> ( {} );
L709: ( 1 +^ 1 ) = ( succ 1 ) by ORDINAL2:31;
per cases ;
suppose L710: ( one ) <=' R22;

consider R20 being (Element of ( RAT+ )) such that L711: ( one ) = ( R20 + R20 ) by L603;
take R20;
L712: (R20 <=' ( one ) & R20 <> 1) by L709 , L711 , L608 , L591;
L713: R20 < ( one ) by L712 , L659;
thus L714: R20 < R22 by L713 , L710 , L665;
L715: ( 1 *^ 1 ) = 1 by ORDINAL2:39;
assume L716: R20 in ( omega );
L717: ( denominator R20 ) = 1 by L716 , L392;
L718: ( ( numerator R20 ) *^ ( denominator R20 ) ) = ( numerator R20 ) by L717 , ORDINAL2:39;
L719: 1 = ( ( numerator R20 ) +^ ( numerator R20 ) ) by L718 , L711 , L717 , L715 , L466;
L720: ( numerator R20 ) c= 1 by L719 , ORDINAL3:24;
L721: (( numerator R20 ) = ( {} ) or ( numerator R20 ) = 1) by L720 , ORDINAL3:16;
thus L722: contradiction by L721 , L709 , L719 , ORDINAL2:27;
end;
suppose L723: R22 < ( one );

consider R20 being (Element of ( RAT+ )) such that L724: R22 = ( R20 + R20 ) by L603;
L725: ( {} ) <=' R20 by L654;
L726: R20 <> ( {} ) by L708 , L724 , L545;
L727: ( {} ) < R20 by L726 , L725 , L659;
take R20;
L728: 1 = ( ( {} ) + ( one ) ) by L545;
L729: R20 <=' R22 by L724 , L608;
L730:
now
assume L731: R20 = R22;
L732: ( R22 + ( {} ) ) = ( R22 + R22 ) by L731 , L724 , L545;
thus L733: contradiction by L732 , L708 , L626;
end;
thus L734: R20 < R22 by L730 , L729 , L659;
L735: R20 < ( one ) by L723 , L729 , L665;
thus L736: thesis by L735 , L727 , L728 , L692;
end;
end;
theorem
L738: (for R22 being (Element of ( RAT+ )) holds ({ R21 where R21 is (Element of ( RAT+ )) : R21 < R22 } in ( RAT+ ) iff R22 = ( {} )))
proof
let R22 being (Element of ( RAT+ ));
thus L739:now
assume L740: ({ R21 where R21 is (Element of ( RAT+ )) : R21 < R22 } in ( RAT+ ) & R22 <> ( {} ));
consider R20 being (Element of ( RAT+ )) such that L741: R20 < R22 and L742: (not R20 in ( omega )) by L740 , L707;
L743: ( {} ) <=' R22 by L654;
L744: ( {} ) < R22 by L743 , L740 , L659;
L745: ( {} ) in { R21 where R21 is (Element of ( RAT+ )) : R21 < R22 } by L744;
L746: R20 in { R21 where R21 is (Element of ( RAT+ )) : R21 < R22 } by L741;
L747: ({ R21 where R21 is (Element of ( RAT+ )) : R21 < R22 } in ( omega ) implies R20 is Ordinal) by L746;
L748: (ex B33 , B34 being (Element of ( omega )) st ({ R21 where R21 is (Element of ( RAT+ )) : R21 < R22 } = [ B33 , B34 ] & B33 , B34 are_relative_prime  & B34 <> ( {} ) & B34 <> 1)) by L747 , L740 , L742 , L343 , L355;
thus L749: contradiction by L748 , L745 , TARSKI:def 2;
end;
assume L750: R22 = ( {} );
L751: { R21 where R21 is (Element of ( RAT+ )) : R21 < R22 } c= ( {} )
proof
let C68 being set;
assume L752: C68 in { R21 where R21 is (Element of ( RAT+ )) : R21 < R22 };
L753: (ex R21 being (Element of ( RAT+ )) st (C68 = R21 & R21 < R22)) by L752;
thus L754: thesis by L753 , L750 , L654;
end;
L755: { R21 where R21 is (Element of ( RAT+ )) : R21 < R22 } = ( {} ) by L751;
thus L756: thesis by L755;
end;
theorem
L757: (for B35 being (Subset of ( RAT+ )) holds (((ex R22 being (Element of ( RAT+ )) st (R22 in B35 & R22 <> ( {} ))) & (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds ((R20 in B35 & R21 <=' R20) implies R21 in B35)))) implies (ex B36 , B37 , B38 being (Element of ( RAT+ )) st (B36 in B35 & B37 in B35 & B38 in B35 & B36 <> B37 & B37 <> B38 & B38 <> B36))))
proof
let C69 being (Subset of ( RAT+ ));
given R22 being (Element of ( RAT+ )) such that
L758: R22 in C69
and
L759: R22 <> ( {} );

assume L760: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds ((R20 in C69 & R21 <=' R20) implies R21 in C69)));
consider R14 being (Element of ( RAT+ )) such that L761: R22 = ( R14 + R14 ) by L603;
take ( {} );
take R14;
take R22;
L762: R14 <=' R22 by L761 , L608;
thus L763: (( {} ) in C69 & R14 in C69 & R22 in C69) by L762 , L758 , L760 , L654;
thus L764: ( {} ) <> R14 by L759 , L761 , L545;
thus L765:now
assume L766: R14 = R22;
L767: ( R22 + ( {} ) ) = ( R22 + R22 ) by L766 , L761 , L545;
thus L768: contradiction by L767 , L759 , L626;
end;
thus L769: thesis by L759;
end;
theorem
L770: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds (( R21 + R22 ) <=' ( R20 + R22 ) iff R21 <=' R20))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
thus L771: (( R21 + R22 ) <=' ( R20 + R22 ) implies R21 <=' R20)
proof
given R16 being (Element of ( RAT+ )) such that
L772: ( R20 + R22 ) = ( ( R21 + R22 ) + R16 );

take R16;
L773: ( R20 + R22 ) = ( ( R21 + R16 ) + R22 ) by L772 , L550;
thus L774: thesis by L773 , L626;
end;

given R16 being (Element of ( RAT+ )) such that
L775: R20 = ( R21 + R16 );

take R16;
thus L776: thesis by L775 , L550;
end;
theorem
L777: (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds R21 <=' ( R21 + R22 )))
proof
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
take R22;
thus L778: thesis;
end;
theorem
L779: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (( R20 *' R21 ) = ( {} ) implies (R20 = ( {} ) or R21 = ( {} )))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
set D83 = ( numerator R20 );
set D84 = ( denominator R20 );
set D85 = ( numerator R21 );
set D86 = ( denominator R21 );
assume L780: ( R20 *' R21 ) = ( {} );
L781: (D84 <> ( {} ) & D86 <> ( {} )) by L414;
L782: ( D84 *^ D86 ) <> ( {} ) by L781 , ORDINAL3:31;
L783: (( denominator ( {} ) ) = 1 & ( numerator ( {} ) ) = ( {} )) by L383 , L392 , L1;
L784: ( ( D83 *^ D85 ) / ( D84 *^ D86 ) ) = ( ( {} ) / 1 ) by L783 , L780 , L452;
L785: ( ( D83 *^ D85 ) *^ 1 ) = ( ( D84 *^ D86 ) *^ ( {} ) ) by L784 , L782 , L501
.= ( {} ) by ORDINAL2:35;
L786: ( D83 *^ D85 ) = ( {} ) by L785 , ORDINAL3:31;
L787: (D83 = ( {} ) or D85 = ( {} )) by L786 , ORDINAL3:31;
thus L788: thesis by L787 , L429;
end;
theorem
L789: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds (R20 <=' ( R21 *' R22 ) implies (ex B39 being (Element of ( RAT+ )) st (R20 = ( R21 *' B39 ) & B39 <=' R22))))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
given R14 being (Element of ( RAT+ )) such that
L790: ( R21 *' R22 ) = ( R20 + R14 );

per cases ;
suppose L791: R21 = ( {} );

take R22;
L792: ( R21 *' R22 ) = ( {} ) by L791 , L531;
thus L793: thesis by L792 , L790 , L642;
end;
suppose L794: R21 <> ( {} );

consider C70 being (Element of ( RAT+ )) such that L795: R14 = ( R21 *' C70 ) by L794 , L572;
consider C71 being (Element of ( RAT+ )) such that L796: R20 = ( R21 *' C71 ) by L794 , L572;
take C71;
thus L797: R20 = ( R21 *' C71 ) by L796;
take C70;
L798: ( R21 *' R22 ) = ( R21 *' ( C71 + C70 ) ) by L790 , L796 , L795 , L583;
thus L799: thesis by L798 , L794 , L576;
end;
end;
theorem
L801: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds ((R22 <> ( {} ) & ( R21 *' R22 ) <=' ( R20 *' R22 )) implies R21 <=' R20))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
assume that
L802: R22 <> ( {} )
and
L803: ( R21 *' R22 ) <=' ( R20 *' R22 );
L804: (ex R14 being (Element of ( RAT+ )) st (( R21 *' R22 ) = ( R22 *' R14 ) & R14 <=' R20)) by L803 , L789;
thus L805: thesis by L804 , L802 , L576;
end;
theorem
L806: (for B40 , B41 , B42 , B43 being (Element of ( RAT+ )) holds (( B40 + B41 ) = ( B42 + B43 ) implies (B40 <=' B42 or B41 <=' B43)))
proof
let C72 , C73 , C74 , C75 being (Element of ( RAT+ ));
assume that
L807: ( C72 + C73 ) = ( C74 + C75 );
assume that
L808: C74 < C72
and
L809: C75 < C73;
L810: ( C74 + C75 ) < ( C72 + C75 ) by L808 , L770;
thus L811: thesis by L810 , L807 , L809 , L770;
end;
theorem
L812: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds (R21 <=' R20 implies ( R21 *' R22 ) <=' ( R20 *' R22 )))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
given R14 being (Element of ( RAT+ )) such that
L813: R20 = ( R21 + R14 );

take ( R14 *' R22 );
thus L814: thesis by L813 , L583;
end;
theorem
L815: (for B44 , B45 , B46 , B47 being (Element of ( RAT+ )) holds (( B44 *' B45 ) = ( B46 *' B47 ) implies (B44 <=' B46 or B45 <=' B47)))
proof
let C76 , C77 , C78 , C79 being (Element of ( RAT+ ));
assume that
L816: ( C76 *' C77 ) = ( C78 *' C79 );
L817: ( {} ) <=' C78 by L654;
assume that
L818: C78 < C76
and
L819: C79 < C77;
L820: (C79 <> C77 & ( C78 *' C79 ) <=' ( C76 *' C79 )) by L818 , L819 , L812;
L821: ( C78 *' C79 ) < ( C76 *' C79 ) by L820 , L816 , L818 , L817 , L576 , L659;
thus L822: thesis by L821 , L816 , L819 , L812;
end;
theorem
L823: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (R20 = ( {} ) iff ( R20 + R21 ) = R21)))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
L824: ( R21 + ( {} ) ) = R21 by L545;
thus L825: thesis by L824 , L626;
end;
theorem
L826: (for B48 , B49 , B50 , B51 being (Element of ( RAT+ )) holds ((( B48 + B49 ) = ( B50 + B51 ) & B48 <=' B50) implies B51 <=' B49))
proof
let C80 , C81 , C82 , C83 being (Element of ( RAT+ ));
assume that
L827: ( C80 + C81 ) = ( C82 + C83 );
given R14 being (Element of ( RAT+ )) such that
L828: C82 = ( C80 + R14 );

take R14;
L829: ( C80 + C81 ) = ( C80 + ( R14 + C83 ) ) by L827 , L828 , L550;
thus L830: thesis by L829 , L626;
end;
theorem
L831: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds ((R20 <=' R21 & R21 <=' ( R20 + R22 )) implies (ex B52 being (Element of ( RAT+ )) st (R21 = ( R20 + B52 ) & B52 <=' R22))))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
given C84 being (Element of ( RAT+ )) such that
L832: R21 = ( R20 + C84 );

assume L833: R21 <=' ( R20 + R22 );
L834: C84 <=' R22 by L833 , L832 , L770;
thus L835: thesis by L834 , L832;
end;
theorem
L836: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds (R20 <=' ( R21 + R22 ) implies (ex B53 , B54 being (Element of ( RAT+ )) st (R20 = ( B53 + B54 ) & B53 <=' R21 & B54 <=' R22))))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
assume L837: R20 <=' ( R21 + R22 );
per cases ;
suppose L838: R21 <=' R20;

L839: (R21 <=' R21 & (ex B55 being (Element of ( RAT+ )) st (R20 = ( R21 + B55 ) & B55 <=' R22))) by L838 , L837 , L831;
thus L840: thesis by L839;
end;
suppose L841: R20 <=' R21;

L842: (R20 = ( R20 + ( {} ) ) & ( {} ) <=' R22) by L545 , L654;
thus L843: thesis by L842 , L841;
end;
end;
theorem
L845: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds ((R20 < R21 & R20 < R22) implies (ex B56 being (Element of ( RAT+ )) st (B56 <=' R21 & B56 <=' R22 & R20 < B56))))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
L846: ((R21 <=' R22 & R21 <=' R21) or (R22 <=' R21 & R22 <=' R22));
thus L847: thesis by L846;
end;
theorem
L848: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds ((R20 <=' R21 & R21 <=' R22 & R21 <> R22) implies R20 <> R22)))) by L659;
theorem
L849: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds ((R21 < ( R20 + R22 ) & R22 <> ( {} )) implies (ex B57 , B58 being (Element of ( RAT+ )) st (R21 = ( B57 + B58 ) & B57 <=' R20 & B58 <=' R22 & B58 <> R22))))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
assume that
L850: R21 < ( R20 + R22 )
and
L851: R22 <> ( {} );
per cases ;
suppose L852: R20 <=' R21;

consider C85 being (Element of ( RAT+ )) such that L853: (R21 = ( R20 + C85 ) & C85 <=' R22) by L852 , L850 , L831;
take R20;
take C85;
thus L854: thesis by L850 , L853;
end;
suppose L855: R21 <=' R20;

L856: (R21 = ( R21 + ( {} ) ) & ( {} ) <=' R22) by L545 , L654;
thus L857: thesis by L856 , L851 , L855;
end;
end;
theorem
L859: (for B59 being non  empty (Subset of ( RAT+ )) holds (B59 in ( RAT+ ) implies (ex R21 being (Element of ( RAT+ )) st (R21 in B59 & (for R20 being (Element of ( RAT+ )) holds (R20 in B59 implies R20 <=' R21))))))
proof
let C86 being non  empty (Subset of ( RAT+ ));
L860:
now
given C87 , C88 being (Element of ( omega )) such that
L861: C86 = [ C87 , C88 ]
and
L862: C87 , C88 are_relative_prime 
and
L863: C88 <> ( {} )
and
L864: C88 <> 1;

L865:
now
assume L866: { C87 } in ( omega );
L867: ( {} ) in { C87 } by L866 , ORDINAL3:8;
L868: ( {} ) = C87 by L867 , TARSKI:def 1;
thus L869: contradiction by L868 , L862 , L864 , L10;
end;
L870: { C87 } in C86 by L861 , TARSKI:def 2;
consider C89 , C90 being (Element of ( omega )) such that L871: { C87 } = [ C89 , C90 ] and L872: C89 , C90 are_relative_prime  and L873: C90 <> ( {} ) and L874: C90 <> 1 by L870 , L865 , L343;
L875: { C89 , C90 } in { C87 } by L871 , TARSKI:def 2;
L876: C87 = { C89 , C90 } by L875 , TARSKI:def 1;
L877: { C89 } in { C87 } by L871 , TARSKI:def 2;
L878: C87 = { C89 } by L877 , TARSKI:def 1;
L879: C90 in { C89 } by L878 , L876 , TARSKI:def 2;
L880: C90 = C89 by L879 , TARSKI:def 1;
L881: C90 = ( C90 *^ 1 ) by ORDINAL2:39;
thus L882: contradiction by L881 , L872 , L874 , L880 , L4;
end;
assume L883: C86 in ( RAT+ );
reconsider D87 = C86 as (Element of ( omega )) by L883 , L860 , L343;
L884: ( {} ) in D87 by ORDINAL3:8;
L885:
now
assume L886: D87 is  limit_ordinal;
L887: ( omega ) c= D87 by L886 , L884 , ORDINAL1:def 11;
thus L888: contradiction by L887 , ORDINAL1:5;
end;
consider R3 being Ordinal such that L889: D87 = ( succ R3 ) by L885 , ORDINAL1:29;
L890: R3 in D87 by L889 , ORDINAL1:6;
reconsider D88 = R3 as  ordinal (Element of ( RAT+ )) by L890;
take D88;
thus L891: D88 in C86 by L889 , ORDINAL1:6;
let R20 being (Element of ( RAT+ ));
assume L892: R20 in C86;
L893: R20 in D87 by L892;
reconsider D89 = R20 as  ordinal (Element of ( RAT+ )) by L893;
L894: ( D88 -^ D89 ) in ( omega ) by ORDINAL1:def 12;
reconsider D90 = ( D88 -^ D89 ) as  ordinal (Element of ( RAT+ )) by L894 , L340;
L895: D89 c= D88 by L889 , L892 , ORDINAL1:22;
L896: D88 = ( D89 +^ D90 ) by L895 , ORDINAL3:def 5
.= ( D89 + D90 ) by L591;
thus L897: thesis by L896 , L608;
end;
theorem
L898: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (ex R22 being (Element of ( RAT+ )) st (( R20 + R22 ) = R21 or ( R21 + R22 ) = R20))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
L899: (R20 <=' R21 or R21 <=' R20);
thus L900: thesis by L899 , L608;
end;
theorem
L901: (for R20 being (Element of ( RAT+ )) holds (for R21 being (Element of ( RAT+ )) holds (R20 < R21 implies (ex R22 being (Element of ( RAT+ )) st (R20 < R22 & R22 < R21)))))
proof
let R20 being (Element of ( RAT+ ));
let R21 being (Element of ( RAT+ ));
assume L902: R20 < R21;
consider R14 being (Element of ( RAT+ )) such that L903: R21 = ( R20 + R14 ) by L902 , L608;
consider R15 being (Element of ( RAT+ )) such that L904: R14 = ( R15 + R15 ) by L603;
take D91 = ( R20 + R15 );
L905: R21 = ( D91 + R15 ) by L903 , L904 , L550;
L906: D91 <=' R21 by L905 , L608;
L907: R20 <=' D91 by L608;
thus L908: R20 < D91 by L907 , L902 , L905 , L659;
L909: R20 <> R21 by L902;
L910: R21 <> D91 by L909 , L905 , L626;
thus L911: thesis by L910 , L906 , L659;
end;
theorem
L912: (for R20 being (Element of ( RAT+ )) holds (ex R21 being (Element of ( RAT+ )) st R20 < R21))
proof
let R20 being (Element of ( RAT+ ));
take D92 = ( R20 + ( one ) );
L913: ( D92 + ( {} ) ) = D92 by L545;
L914: R20 <> D92 by L913 , L626;
L915: R20 <=' D92 by L608;
thus L916: thesis by L915 , L914 , L659;
end;
theorem
L917: (for R20 being (Element of ( RAT+ )) holds (for R22 being (Element of ( RAT+ )) holds (R22 <> ( {} ) implies (ex R21 being (Element of ( RAT+ )) st (R21 in ( omega ) & R20 <=' ( R21 *' R22 ))))))
proof
let R20 being (Element of ( RAT+ ));
let R22 being (Element of ( RAT+ ));
set D93 = ( ( ( numerator R20 ) *^ ( ( ( numerator R22 ) *^ ( denominator R20 ) ) -^ 1 ) ) / ( denominator R20 ) );
L918: ( denominator R20 ) <> ( {} ) by L414;
L919: ( ( denominator R22 ) *^ ( numerator R20 ) ) in ( omega ) by ORDINAL1:def 12;
reconsider D94 = ( ( denominator R22 ) *^ ( numerator R20 ) ) as  ordinal (Element of ( RAT+ )) by L919 , L340;
assume L920: R22 <> ( {} );
L921: ( numerator R22 ) <> ( {} ) by L920 , L429;
L922: ( {} ) in ( ( numerator R22 ) *^ ( denominator R20 ) ) by L921 , L918 , ORDINAL3:8 , ORDINAL3:31;
L923: ( one ) c= ( ( numerator R22 ) *^ ( denominator R20 ) ) by L922 , L119 , ORDINAL1:21;
L924: ( ( numerator R22 ) *^ ( denominator R20 ) ) = ( 1 +^ ( ( ( numerator R22 ) *^ ( denominator R20 ) ) -^ 1 ) ) by L923 , ORDINAL3:def 5;
L925: ( D94 *^ ( ( numerator R22 ) *^ ( denominator R20 ) ) ) = ( ( denominator R22 ) *^ ( ( numerator R20 ) *^ ( 1 +^ ( ( ( numerator R22 ) *^ ( denominator R20 ) ) -^ 1 ) ) ) ) by L924 , ORDINAL3:50
.= ( ( denominator R22 ) *^ ( ( ( numerator R20 ) *^ 1 ) +^ ( ( numerator R20 ) *^ ( ( ( numerator R22 ) *^ ( denominator R20 ) ) -^ 1 ) ) ) ) by ORDINAL3:46;
L926: ( ( D94 *^ ( numerator R22 ) ) *^ ( denominator R20 ) ) = ( ( denominator R22 ) *^ ( ( ( numerator R20 ) *^ 1 ) +^ ( ( numerator R20 ) *^ ( ( ( numerator R22 ) *^ ( denominator R20 ) ) -^ 1 ) ) ) ) by L925 , ORDINAL3:50;
take D94;
thus L927: D94 in ( omega ) by ORDINAL1:def 12;
take D93;
L928: ( denominator R22 ) <> ( {} ) by L414;
L929: ( ( D94 *^ ( numerator R22 ) ) / ( denominator R22 ) ) = ( ( ( ( numerator R20 ) *^ 1 ) +^ ( ( numerator R20 ) *^ ( ( ( numerator R22 ) *^ ( denominator R20 ) ) -^ 1 ) ) ) / ( denominator R20 ) ) by L928 , L918 , L926 , L501
.= ( ( ( ( numerator R20 ) *^ 1 ) / ( denominator R20 ) ) + D93 ) by L414 , L526
.= ( ( ( numerator R20 ) / ( denominator R20 ) ) + D93 ) by ORDINAL2:39
.= ( R20 + D93 ) by L452;
L930: ( R20 + D93 ) = ( ( D94 *^ ( numerator R22 ) ) / ( 1 *^ ( denominator R22 ) ) ) by L929 , ORDINAL2:39
.= ( ( D94 / 1 ) *' ( ( numerator R22 ) / ( denominator R22 ) ) ) by L534
.= ( D94 *' ( ( numerator R22 ) / ( denominator R22 ) ) ) by L466;
thus L931: thesis by L930 , L452;
end;
scheme DisNat { F1 , F2 , F3() -> (Element of ( RAT+ )) , P1[set] } : (ex R21 being (Element of ( RAT+ )) st (R21 in ( omega ) & P1[ R21 ] & (not P1[ ( R21 + F2() ) ])))
provided
L932: F2() = 1
and
L933: F1() = ( {} )
and
L934: F3() in ( omega )
and
L935: P1[ F1() ]
and
L936: (not P1[ F3() ])
proof
defpred S3[ Ordinal ] means ((not P1[ $1 ]) & $1 in ( omega ));
L937: (ex R1 being Ordinal st S3[ R1 ]) by L934 , L936;
consider R1 being Ordinal such that L938: S3[ R1 ] and L939: (for R2 being Ordinal holds (S3[ R2 ] implies R1 c= R2)) from ORDINAL1:sch 1(L937);
L940: ( {} ) in R1 by L933 , L935 , L938 , ORDINAL3:8;
L941:
now
assume L942: R1 is  limit_ordinal;
L943: ( omega ) c= R1 by L942 , L940 , ORDINAL1:def 11;
L944: R1 in R1 by L943 , L938;
thus L945: contradiction by L944;
end;
consider C91 being Ordinal such that L946: R1 = ( succ C91 ) by L941 , ORDINAL1:29;
L947: C91 in R1 by L946 , ORDINAL1:8;
L948: C91 in ( omega ) by L947 , L938 , ORDINAL1:10;
reconsider D95 = C91 as  ordinal (Element of ( RAT+ )) by L948 , L340;
take D95;
thus L949: (D95 in ( omega ) & P1[ D95 ]) by L939 , L947 , L948 , ORDINAL1:5;
L950: R1 = ( C91 +^ 1 ) by L946 , ORDINAL2:31;
thus L951: thesis by L950 , L932 , L938 , L591;
end;
