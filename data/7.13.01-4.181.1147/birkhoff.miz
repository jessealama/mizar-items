:: Birkhoff Theorem for Many Sorted Algebras
::  by Artur Korni{\l}owicz
::
:: Received June 19, 1997
:: Copyright (c) 1997-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies XBOOLE_0, STRUCT_0, MSUALG_1, RELAT_1, PBOOLE, MSAFREE, MSUALG_3,
      REALSET1, MEMBER_1, FUNCT_6, TARSKI, FUNCT_1, WELLORD1, MSUALG_2,
      PRALG_2, CARD_3, SUBSET_1, MSUALG_5, MSUALG_4, FUNCOP_1, RLVECT_2,
      PRALG_1, EQREL_1, CLOSURE2, SETFAM_1, FUNCT_4, ZFMISC_1, GROUP_6,
      NUMBERS, EQUATION, ZF_MODEL, ZF_LANG, MCART_1, PZFMISC1, MSAFREE2,
      FINSET_1, BIRKHOFF;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, NUMBERS, SETFAM_1, RELAT_1,
      XTUPLE_0, MCART_1, STRUCT_0, FUNCT_1, PBOOLE, RELSET_1, PARTFUN1,
      FUNCT_2, FINSET_1, CARD_3, FUNCT_6, FUNCOP_1, MSUALG_1, MSUALG_2,
      PRALG_3, MSUALG_3, MSAFREE, MSAFREE2, PRALG_2, MSUALG_4, PZFMISC1,
      MSSUBFAM, CLOSURE2, MSUALG_5, EQUATION;
 constructors BINOP_1, PZFMISC1, MSSUBFAM, MSUALG_3, MSAFREE2, MSUALG_5,
      CLOSURE2, PRALG_3, EQUATION, RELSET_1, XTUPLE_0;
 registrations XBOOLE_0, ORDINAL1, RELSET_1, FUNCT_2, FUNCOP_1, PBOOLE,
      STRUCT_0, MSUALG_1, MSUALG_2, MSUALG_4, MSAFREE1, MSAFREE2, EXTENS_1,
      MSUALG_5, CLOSURE2, PRALG_3, MSUALG_9, EQUATION, MSSUBFAM, AUTALG_1,
      XTUPLE_0;
 requirements SUBSET, BOOLE;
 definitions FUNCT_1, RELAT_1, TARSKI, PBOOLE, PRALG_2, MSUALG_4, EQUATION,
      FUNCOP_1, PZFMISC1, XTUPLE_0;
 theorems CARD_3, CLOSURE2, EXTENS_1, FUNCOP_1, FUNCT_1, FUNCT_2, MCART_1,
      MSAFREE, MSAFREE2, MSSCYC_1, MSSUBFAM, MSUALG_2, MSUALG_3, MSUALG_4,
      MSUALG_5, MSUALG_7, MSUALG_9, PBOOLE, PRALG_2, PRALG_3, EQUATION,
      RELAT_1, ZFMISC_1, SETFAM_1;
 schemes DOMAIN_1, PBOOLE;

begin
definition
let C1 being non  empty non  void ManySortedSign;
let C2 being  non-empty (ManySortedSet of (the carrier of C1));
let C3 being  non-empty MSAlgebra over C1;
let C4 being (ManySortedFunction of C2 , (the Sorts of C3));
func C4 -hash -> (ManySortedFunction of ( FreeMSA C2 ) , C3) means 
:L1: (it is_homomorphism ( FreeMSA C2 ) , C3 & ( it || ( FreeGen C2 ) ) = ( C4 ** ( Reverse C2 ) ));
existence by MSAFREE:def 5;
uniqueness by EXTENS_1:14;
end;
theorem
L3: (for B1 being non  empty non  void ManySortedSign holds (for B2 being  non-empty MSAlgebra over B1 holds (for B3 being  non-empty (ManySortedSet of (the carrier of B1)) holds (for B4 being (ManySortedFunction of B3 , (the Sorts of B2)) holds ( rngs B4 ) c= ( rngs ( B4 -hash ) )))))
proof
let C5 being non  empty non  void ManySortedSign;
let C6 being  non-empty MSAlgebra over C5;
let C7 being  non-empty (ManySortedSet of (the carrier of C5));
let C8 being (ManySortedFunction of C7 , (the Sorts of C6));
set D1 = ( Reverse C7 );
let C9 being set;
assume L4: C9 in (the carrier of C5);
reconsider D2 = C9 as (SortSymbol of C5) by L4;
let C10 being set;
L5: ( dom ( D1 . D2 ) ) = ( ( FreeGen C7 ) . D2 ) by FUNCT_2:def 1;
L6: ( FreeGen C7 ) c= (the Sorts of ( FreeMSA C7 )) by PBOOLE:def 18;
L7: ( ( FreeGen C7 ) . D2 ) c= ( (the Sorts of ( FreeMSA C7 )) . D2 ) by L6 , PBOOLE:def 2;
assume L8: C10 in ( ( rngs C8 ) . C9 );
L9: C10 in ( rng ( C8 . D2 ) ) by L8 , MSSUBFAM:13;
consider C11 being set such that L10: C11 in ( dom ( C8 . D2 ) ) and L11: C10 = ( ( C8 . D2 ) . C11 ) by L9 , FUNCT_1:def 3;
L12: ( rngs D1 ) = C7 by EXTENS_1:10;
L13: D1 is  "onto" by L12 , EXTENS_1:9;
L14: ( rng ( D1 . D2 ) ) = ( C7 . D2 ) by L13 , MSUALG_3:def 3;
consider C12 being set such that L15: C12 in ( dom ( D1 . D2 ) ) and L16: C11 = ( ( D1 . D2 ) . C12 ) by L14 , L10 , FUNCT_1:def 3;
L17: ( dom ( ( C8 -hash ) . D2 ) ) = ( (the Sorts of ( FreeMSA C7 )) . D2 ) by FUNCT_2:def 1;
L18: C10 = ( ( ( C8 . D2 ) * ( D1 . D2 ) ) . C12 ) by L11 , L15 , L16 , FUNCT_1:13
.= ( ( ( C8 ** D1 ) . D2 ) . C12 ) by MSUALG_3:2
.= ( ( ( ( C8 -hash ) || ( FreeGen C7 ) ) . D2 ) . C12 ) by L1
.= ( ( ( ( C8 -hash ) . D2 ) | ( ( FreeGen C7 ) . D2 ) ) . C12 ) by MSAFREE:def 1
.= ( ( ( C8 -hash ) . D2 ) . C12 ) by L15 , FUNCT_1:49;
L19: C10 in ( rng ( ( C8 -hash ) . D2 ) ) by L18 , L15 , L5 , L17 , L7 , FUNCT_1:def 3;
thus L20: thesis by L19 , MSSUBFAM:13;
end;
scheme ExFreeAlg1 { F1() -> non  empty non  void ManySortedSign , F2() ->  non-empty MSAlgebra over F1() , P1[set] } : (ex B5 being  strict  non-empty MSAlgebra over F1() st (ex B6 being (ManySortedFunction of F2() , B5) st (P1[ B5 ] & B6 is_epimorphism F2() , B5 & (for B7 being  non-empty MSAlgebra over F1() holds (for B8 being (ManySortedFunction of F2() , B7) holds ((B8 is_homomorphism F2() , B7 & P1[ B7 ]) implies (ex B9 being (ManySortedFunction of B5 , B7) st (B9 is_homomorphism B5 , B7 & ( B9 ** B6 ) = B8 & (for B10 being (ManySortedFunction of B5 , B7) holds (( B10 ** B6 ) = B8 implies B9 = B10))))))))))
provided
L21: (for B11 , B12 being  non-empty MSAlgebra over F1() holds ((B11 , B12 are_isomorphic  & P1[ B11 ]) implies P1[ B12 ]))
and
L22: (for B13 being  non-empty MSAlgebra over F1() holds (for B14 being  strict  non-empty (MSSubAlgebra of B13) holds (P1[ B13 ] implies P1[ B14 ])))
and
L23: (for B15 being set holds (for B16 being (MSAlgebra-Family of B15 , F1()) holds ((for B17 being set holds (B17 in B15 implies (ex B18 being MSAlgebra over F1() st (B18 = ( B16 . B17 ) & P1[ B18 ])))) implies P1[ ( product B16 ) ])))
proof
set D3 = the (MSAlgebra-Family of ( {} ) , F1());
set D4 = { B19 where B19 is (Element of ( CongrLatt F2() )) : (ex B20 being (MSCongruence of F2()) st (B20 = B19 & P1[ ( QuotMSAlg (F2() , B20) ) ])) };
set D5 = (the Sorts of F2());
set D6 = (the carrier of F1());
consider C13 being (ManySortedSet of D6) such that L24: { C13 } = ( D6 --> { ( {} ) } ) by MSUALG_9:5;
L25:
now
let C14 being set;
assume L26: C14 in D6;
reconsider D7 = C14 as (SortSymbol of F1()) by L26;
thus L27: ( (the Sorts of ( product D3 )) . C14 ) = ( product ( Carrier (D3 , D7) ) ) by PRALG_2:def 10
.= { ( {} ) } by CARD_3:10 , PRALG_2:def 9
.= ( ( D6 --> { ( {} ) } ) . D7 ) by FUNCOP_1:7
.= ( { C13 } . C14 ) by L24;
end;
L28: (the Sorts of ( product D3 )) = { C13 } by L25 , PBOOLE:3;
reconsider D8 = [| D5 , D5 |] as (MSCongruence of F2()) by MSUALG_5:18;
L29: [| D5 , D5 |] is (MSCongruence of F2()) by MSUALG_5:18;
L30: [| D5 , D5 |] is (Element of ( CongrLatt F2() )) by L29 , MSUALG_5:def 6;
L31: (the Sorts of ( QuotMSAlg (F2() , D8) )) = { D5 } by MSUALG_9:29;
L32: ( QuotMSAlg (F2() , D8) ) , ( Trivial_Algebra F1() ) are_isomorphic  by L31 , MSUALG_9:26;
L33: (for B21 being set holds (B21 in ( {} ) implies (ex B22 being MSAlgebra over F1() st (B22 = ( D3 . B21 ) & P1[ B22 ]))));
L34: P1[ ( product D3 ) ] by L33 , L23;
L35: P1[ ( Trivial_Algebra F1() ) ] by L34 , L21 , L28 , MSUALG_9:26;
L36: P1[ ( QuotMSAlg (F2() , D8) ) ] by L35 , L21 , L32 , MSUALG_3:17;
L37: [| D5 , D5 |] in D4 by L36 , L30;
defpred S1[ set , set ] means (ex B23 being (MSCongruence of F2()) st (B23 = $1 & $2 = ( QuotMSAlg (F2() , B23) )));
defpred S2[ set ] means (ex B24 being (MSCongruence of F2()) st (B24 = $1 & P1[ ( QuotMSAlg (F2() , B24) ) ]));
L38:
now
let C15 being set;
assume L39: C15 in D4;
L40: (ex B25 being (Element of ( CongrLatt F2() )) st (C15 = B25 & (ex B26 being (MSCongruence of F2()) st (B26 = B25 & P1[ ( QuotMSAlg (F2() , B26) ) ])))) by L39;
thus L41: C15 is (MSCongruence of F2()) by L40;
end;
L42: D4 c= (the carrier of ( EqRelLatt D5 ))
proof
let C16 being set;
assume L43: C16 in D4;
L44: C16 is (Equivalence_Relation of D5) by L43 , L38;
thus L45: thesis by L44 , MSUALG_5:def 5;
end;
reconsider D9 = D4 as non  empty (SubsetFamily of [| D5 , D5 |]) by L42 , L37 , MSUALG_7:5;
set D10 = ( meet |: D9 :| );
L46: D10 is  MSEquivalence_Relation-like  MSEquivalence_Relation-like  MSEquivalence_Relation-like  MSEquivalence_Relation-like (ManySortedRelation of D5) by L42 , MSUALG_7:8;
reconsider D11 = D10 as (ManySortedRelation of F2()) by L42 , MSUALG_7:8;
L47: D11 is  MSEquivalence-like
proof
let C17 being set;
let C18 being (Relation of ( D5 . C17 ));
assume that
L48: C17 in D6
and
L49: ( D11 . C17 ) = C18;
thus L50: thesis by L46 , L48 , L49 , MSUALG_4:def 2;
end;
reconsider D12 = D11 as  MSEquivalence-like (ManySortedRelation of F2()) by L47;
L51: { B27 where B27 is (Element of ( CongrLatt F2() )) : S2[ B27 ] } is (Subset of ( CongrLatt F2() )) from DOMAIN_1:sch 7;
reconsider D13 = D12 as (MSCongruence of F2()) by L51 , MSUALG_9:28;
take D14 = ( QuotMSAlg (F2() , D13) );
reconsider D15 = ( MSNat_Hom (F2() , D13) ) as (ManySortedFunction of F2() , D14);
take D15;
L52:
now
let C19 being set;
assume L53: C19 in D9;
reconsider D16 = C19 as (MSCongruence of F2()) by L53 , L38;
consider C20 being set such that L54: C20 = ( QuotMSAlg (F2() , D16) );
take D17 = C20;
thus L55: S1[ C19 , D17 ] by L54;
end;
consider C21 being (ManySortedSet of D9) such that L56: (for B28 being set holds (B28 in D9 implies S1[ B28 , ( C21 . B28 ) ])) from PBOOLE:sch 3(L52);
L57: C21 is (MSAlgebra-Family of D9 , F1())
proof
let C22 being set;
assume L58: C22 in D9;
L59: (ex B29 being (MSCongruence of F2()) st (B29 = C22 & ( C21 . C22 ) = ( QuotMSAlg (F2() , B29) ))) by L58 , L56;
thus L60: thesis by L59;
end;
reconsider D18 = C21 as (MSAlgebra-Family of D9 , F1()) by L57;
defpred S3[ (Element of D9) , set ] means (ex B30 being (ManySortedFunction of F2() , ( D18 . $1 )) st (B30 = $2 & B30 is_homomorphism F2() , ( D18 . $1 ) & (ex B31 being (MSCongruence of F2()) st ($1 = B31 & B30 = ( MSNat_Hom (F2() , B31) )))));
L61: (for B32 being (Element of D9) holds (ex B33 being set st S3[ B32 , B33 ]))
proof
let C23 being (Element of D9);
consider C24 being (MSCongruence of F2()) such that L62: C24 = C23 and L63: ( D18 . C23 ) = ( QuotMSAlg (F2() , C24) ) by L56;
set D19 = ( MSNat_Hom (F2() , C24) );
reconsider D20 = D19 as (ManySortedFunction of F2() , ( D18 . C23 )) by L63;
take D19;
take D20;
thus L64: D20 = D19;
L65: ( MSNat_Hom (F2() , C24) ) is_epimorphism F2() , ( QuotMSAlg (F2() , C24) ) by MSUALG_4:3;
thus L66: D20 is_homomorphism F2() , ( D18 . C23 ) by L65 , L63 , MSUALG_3:def 8;
take C24;
thus L67: thesis by L62;
end;
consider C25 being (ManySortedSet of D9) such that L68: (for B34 being (Element of D9) holds S3[ B34 , ( C25 . B34 ) ]) from PBOOLE:sch 6(L61);
L69: (for B35 being (Element of D9) holds (ex B36 being (ManySortedFunction of F2() , ( D18 . B35 )) st (B36 = ( C25 . B35 ) & B36 is_homomorphism F2() , ( D18 . B35 ))))
proof
let C26 being (Element of D9);
consider C27 being (ManySortedFunction of F2() , ( D18 . C26 )) such that L70: C27 = ( C25 . C26 ) and L71: C27 is_homomorphism F2() , ( D18 . C26 ) and L72: (ex B37 being (MSCongruence of F2()) st (C26 = B37 & C27 = ( MSNat_Hom (F2() , B37) ))) by L68;
take C27;
thus L73: thesis by L70 , L71;
end;
L74: C25 is  Function-yielding
proof
let C28 being set;
assume L75: C28 in ( dom C25 );
reconsider D21 = C28 as (Element of D9) by L75;
L76: (ex B38 being (ManySortedFunction of F2() , ( D18 . D21 )) st (B38 = ( C25 . D21 ) & B38 is_homomorphism F2() , ( D18 . D21 ))) by L69;
thus L77: thesis by L76;
end;
reconsider D22 = C25 as (ManySortedFunction of D9) by L74;
consider C29 being (ManySortedFunction of F2() , ( product D18 )) such that L78: C29 is_homomorphism F2() , ( product D18 ) and L79: (for B39 being (Element of D9) holds ( ( proj (D18 , B39) ) ** C29 ) = ( D22 . B39 )) by L69 , PRALG_3:29;
L80:
now
let C30 being set;
assume L81: C30 in D6;
reconsider D23 = C30 as (SortSymbol of F1()) by L81;
consider C31 being (Subset-Family of ( [| D5 , D5 |] . D23 )) such that L82: C31 = ( |: D9 :| . D23 ) and L83: ( ( meet |: D9 :| ) . D23 ) = ( Intersect C31 ) by MSSUBFAM:def 1;
L84: ( |: D9 :| . D23 ) = { ( B40 . D23 ) where B40 is (Element of ( Bool [| D5 , D5 |] )) : B40 in D9 } by CLOSURE2:14;
L85: ( ( MSCng C29 ) . D23 ) = ( D13 . D23 )
proof
let C32 , C33 being set;
thus L86:now
assume L87: [ C32 , C33 ] in ( ( MSCng C29 ) . D23 );
L88: C32 in ( D5 . D23 ) by L87 , ZFMISC_1:87;
L89: C33 in ( D5 . D23 ) by L87 , ZFMISC_1:87;
L90: [ C32 , C33 ] in ( MSCng (C29 , D23) ) by L78 , L87 , MSUALG_4:def 18;
L91: (for B41 being set holds (B41 in C31 implies [ C32 , C33 ] in B41))
proof
let C34 being set;
assume L92: C34 in C31;
consider C35 being (Element of ( Bool [| D5 , D5 |] )) such that L93: C34 = ( C35 . D23 ) and L94: C35 in D9 by L92 , L82 , L84;
reconsider D24 = C35 as (Element of D9) by L94;
consider C36 being (ManySortedFunction of F2() , ( D18 . D24 )) such that L95: C36 = ( D22 . D24 ) and L96: C36 is_homomorphism F2() , ( D18 . D24 ) and L97: (ex B42 being (MSCongruence of F2()) st (D24 = B42 & C36 = ( MSNat_Hom (F2() , B42) ))) by L68;
L98: ( ( C36 . D23 ) . C32 ) = ( ( ( ( proj (D18 , D24) ) ** C29 ) . D23 ) . C32 ) by L79 , L95
.= ( ( ( ( proj (D18 , D24) ) . D23 ) * ( C29 . D23 ) ) . C32 ) by MSUALG_3:2
.= ( ( ( proj (D18 , D24) ) . D23 ) . ( ( C29 . D23 ) . C32 ) ) by L88 , FUNCT_2:15
.= ( ( ( proj (D18 , D24) ) . D23 ) . ( ( C29 . D23 ) . C33 ) ) by L88 , L89 , L90 , MSUALG_4:def 17
.= ( ( ( ( proj (D18 , D24) ) . D23 ) * ( C29 . D23 ) ) . C33 ) by L89 , FUNCT_2:15
.= ( ( ( ( proj (D18 , D24) ) ** C29 ) . D23 ) . C33 ) by MSUALG_3:2
.= ( ( C36 . D23 ) . C33 ) by L79 , L95;
thus L99: thesis by L98 , L88 , L89 , L93 , L97 , MSUALG_9:33;
end;
L100: [ C32 , C33 ] in [: ( D5 . D23 ) , ( D5 . D23 ) :] by L87;
L101: [ C32 , C33 ] in ( [| D5 , D5 |] . D23 ) by L100 , PBOOLE:def 16;
thus L102: [ C32 , C33 ] in ( D13 . D23 ) by L101 , L83 , L91 , SETFAM_1:43;
end;
assume L103: [ C32 , C33 ] in ( D13 . D23 );
L104: C32 in ( D5 . D23 ) by L103 , ZFMISC_1:87;
L105: C33 in ( D5 . D23 ) by L103 , ZFMISC_1:87;
L106: (for B43 being (Element of D9) holds ( ( proj (( Carrier (D18 , D23) ) , B43) ) . ( ( C29 . D23 ) . C32 ) ) = ( ( proj (( Carrier (D18 , D23) ) , B43) ) . ( ( C29 . D23 ) . C33 ) ))
proof
let C37 being (Element of D9);
reconsider D25 = C37 as (MSCongruence of F2()) by L38;
consider C38 being (ManySortedFunction of F2() , ( D18 . C37 )) such that L107: C38 = ( D22 . C37 ) and L108: C38 is_homomorphism F2() , ( D18 . C37 ) and L109: (ex B44 being (MSCongruence of F2()) st (C37 = B44 & C38 = ( MSNat_Hom (F2() , B44) ))) by L68;
L110: D25 is (Element of ( Bool [| D5 , D5 |] )) by CLOSURE2:def 1;
L111: ( D25 . D23 ) in ( |: D9 :| . D23 ) by L110 , L84;
L112: [ C32 , C33 ] in ( D25 . D23 ) by L111 , L82 , L83 , L103 , SETFAM_1:43;
thus L113: ( ( proj (( Carrier (D18 , D23) ) , C37) ) . ( ( C29 . D23 ) . C32 ) ) = ( ( ( proj (D18 , C37) ) . D23 ) . ( ( C29 . D23 ) . C32 ) ) by PRALG_3:def 2
.= ( ( ( ( proj (D18 , C37) ) . D23 ) * ( C29 . D23 ) ) . C32 ) by L104 , FUNCT_2:15
.= ( ( ( ( proj (D18 , C37) ) ** C29 ) . D23 ) . C32 ) by MSUALG_3:2
.= ( ( C38 . D23 ) . C32 ) by L79 , L107
.= ( ( C38 . D23 ) . C33 ) by L104 , L105 , L112 , L109 , MSUALG_9:33
.= ( ( ( ( proj (D18 , C37) ) ** C29 ) . D23 ) . C33 ) by L79 , L107
.= ( ( ( ( proj (D18 , C37) ) . D23 ) * ( C29 . D23 ) ) . C33 ) by MSUALG_3:2
.= ( ( ( proj (D18 , C37) ) . D23 ) . ( ( C29 . D23 ) . C33 ) ) by L105 , FUNCT_2:15
.= ( ( proj (( Carrier (D18 , D23) ) , C37) ) . ( ( C29 . D23 ) . C33 ) ) by PRALG_3:def 2;
end;
L114: ( ( C29 . D23 ) . C33 ) in ( (the Sorts of ( product D18 )) . D23 ) by L105 , FUNCT_2:5;
L115: ( ( C29 . D23 ) . C33 ) in ( product ( Carrier (D18 , D23) ) ) by L114 , PRALG_2:def 10;
L116: ( ( C29 . D23 ) . C32 ) in ( (the Sorts of ( product D18 )) . D23 ) by L104 , FUNCT_2:5;
L117: ( ( C29 . D23 ) . C32 ) in ( product ( Carrier (D18 , D23) ) ) by L116 , PRALG_2:def 10;
L118: ( ( C29 . D23 ) . C32 ) = ( ( C29 . D23 ) . C33 ) by L117 , L115 , L106 , MSUALG_9:14;
L119: [ C32 , C33 ] in ( MSCng (C29 , D23) ) by L118 , L104 , L105 , MSUALG_4:def 17;
thus L120: thesis by L119 , L78 , MSUALG_4:def 18;
end;
thus L121: ( ( MSCng C29 ) . C30 ) = ( D13 . C30 ) by L85;
end;
L122: ( MSCng C29 ) = D13 by L80 , PBOOLE:3;
L123: ( QuotMSAlg (F2() , ( MSCng C29 )) ) , ( Image ( MSHomQuot C29 ) ) are_isomorphic  by L78 , MSUALG_4:4 , MSUALG_9:16;
consider C39 being  strict  non-empty (MSSubAlgebra of ( product D18 )) such that L124: D14 , C39 are_isomorphic  by L123 , L122;
L125: (for B45 being set holds (B45 in D9 implies (ex B46 being MSAlgebra over F1() st (B46 = ( D18 . B45 ) & P1[ B46 ]))))
proof
let C40 being set;
assume L126: C40 in D9;
reconsider D26 = C40 as (Element of D9) by L126;
take ( D18 . D26 );
L127: (ex B47 being (Element of ( CongrLatt F2() )) st (C40 = B47 & (ex B48 being (MSCongruence of F2()) st (B48 = B47 & P1[ ( QuotMSAlg (F2() , B48) ) ])))) by L126;
L128: (ex B49 being (MSCongruence of F2()) st (B49 = C40 & ( D18 . C40 ) = ( QuotMSAlg (F2() , B49) ))) by L56 , L126;
thus L129: thesis by L128 , L127;
end;
L130: P1[ C39 ] by L125 , L22 , L23;
thus L131: P1[ D14 ] by L130 , L21 , L124 , MSUALG_3:17;
thus L132: D15 is_epimorphism F2() , D14 by MSUALG_4:3;
L133: D15 is  "onto" by L132 , MSUALG_3:def 8;
let C41 being  non-empty MSAlgebra over F1();
let C42 being (ManySortedFunction of F2() , C41);
assume that
L134: C42 is_homomorphism F2() , C41
and
L135: P1[ C41 ];
reconsider D27 = ( Image ( MSHomQuot C42 ) ) as  strict  non-empty (MSSubAlgebra of C41);
L136: ( QuotMSAlg (F2() , ( MSCng C42 )) ) , D27 are_isomorphic  by L134 , MSUALG_4:4 , MSUALG_9:16;
L137: ( MSCng C42 ) is (Element of ( CongrLatt F2() )) by MSUALG_5:def 6;
L138: P1[ D27 ] by L22 , L135;
L139: P1[ ( QuotMSAlg (F2() , ( MSCng C42 )) ) ] by L138 , L21 , L136 , MSUALG_3:17;
L140: ( MSCng C42 ) in D9 by L139 , L137;
L141: D13 c= ( MSCng C42 ) by L140 , CLOSURE2:21 , MSSUBFAM:43;
consider C43 being (ManySortedFunction of D14 , C41) such that L142: C43 is_homomorphism D14 , C41 and L143: C42 = ( C43 ** D15 ) by L141 , L134 , MSUALG_9:36;
take C43;
thus L144: C43 is_homomorphism D14 , C41 by L142;
thus L145: C42 = ( C43 ** D15 ) by L143;
let C44 being (ManySortedFunction of D14 , C41);
assume L146: ( C44 ** D15 ) = C42;
thus L147: thesis by L146 , L143 , L133 , EXTENS_1:12;
end;
scheme ExFreeAlg2 { F3() -> non  empty non  void ManySortedSign , F4() ->  non-empty (ManySortedSet of (the carrier of F3())) , P2[set] } : (ex B50 being  strict  non-empty MSAlgebra over F3() st (ex B51 being (ManySortedFunction of F4() , (the Sorts of B50)) st (P2[ B50 ] & (for B52 being  non-empty MSAlgebra over F3() holds (for B53 being (ManySortedFunction of F4() , (the Sorts of B52)) holds (P2[ B52 ] implies (ex B54 being (ManySortedFunction of B50 , B52) st (B54 is_homomorphism B50 , B52 & ( B54 ** B51 ) = B53 & (for B55 being (ManySortedFunction of B50 , B52) holds ((B55 is_homomorphism B50 , B52 & ( B55 ** B51 ) = B53) implies B54 = B55))))))))))
provided
L148: (for B56 , B57 being  non-empty MSAlgebra over F3() holds ((B56 , B57 are_isomorphic  & P2[ B56 ]) implies P2[ B57 ]))
and
L149: (for B58 being  non-empty MSAlgebra over F3() holds (for B59 being  strict  non-empty (MSSubAlgebra of B58) holds (P2[ B58 ] implies P2[ B59 ])))
and
L150: (for B60 being set holds (for B61 being (MSAlgebra-Family of B60 , F3()) holds ((for B62 being set holds (B62 in B60 implies (ex B63 being MSAlgebra over F3() st (B63 = ( B61 . B62 ) & P2[ B63 ])))) implies P2[ ( product B61 ) ])))
proof
L151: (for B64 being  non-empty MSAlgebra over F3() holds (for B65 being  strict  non-empty (MSSubAlgebra of B64) holds (P2[ B64 ] implies P2[ B65 ]))) by L149;
L152: (for B66 being set holds (for B67 being (MSAlgebra-Family of B66 , F3()) holds ((for B68 being set holds (B68 in B66 implies (ex B69 being MSAlgebra over F3() st (B69 = ( B67 . B68 ) & P2[ B69 ])))) implies P2[ ( product B67 ) ]))) by L150;
set D28 = ( FreeMSA F4() );
L153: ( Reverse F4() ) is  "1-1" by MSUALG_9:11;
L154: (for B70 , B71 being  non-empty MSAlgebra over F3() holds ((B70 , B71 are_isomorphic  & P2[ B70 ]) implies P2[ B71 ])) by L148;
consider C45 being  strict  non-empty MSAlgebra over F3(), C46 being (ManySortedFunction of D28 , C45) such that L155: P2[ C45 ] and L156: C46 is_epimorphism D28 , C45 and L157: (for B72 being  non-empty MSAlgebra over F3() holds (for B73 being (ManySortedFunction of D28 , B72) holds ((B73 is_homomorphism D28 , B72 & P2[ B72 ]) implies (ex B74 being (ManySortedFunction of C45 , B72) st (B74 is_homomorphism C45 , B72 & ( B74 ** C46 ) = B73 & (for B75 being (ManySortedFunction of C45 , B72) holds (( B75 ** C46 ) = B73 implies B74 = B75))))))) from ExFreeAlg1(L154 , L151 , L152);
reconsider D29 = ( ( C46 || ( FreeGen F4() ) ) ** ( ( Reverse F4() ) "" ) ) as (ManySortedFunction of F4() , (the Sorts of C45));
take C45;
take D29;
thus L158: P2[ C45 ] by L155;
let C47 being  non-empty MSAlgebra over F3();
let C48 being (ManySortedFunction of F4() , (the Sorts of C47));
assume that
L159: P2[ C47 ];
consider C49 being (ManySortedFunction of D28 , C47) such that L160: C49 is_homomorphism D28 , C47 and L161: ( C49 || ( FreeGen F4() ) ) = ( C48 ** ( Reverse F4() ) ) by MSAFREE:def 5;
consider C50 being (ManySortedFunction of C45 , C47) such that L162: C50 is_homomorphism C45 , C47 and L163: ( C50 ** C46 ) = C49 and L164: (for B76 being (ManySortedFunction of C45 , C47) holds (( B76 ** C46 ) = C49 implies C50 = B76)) by L157 , L159 , L160;
take C50;
thus L165: C50 is_homomorphism C45 , C47 by L162;
L166: ( C50 ** ( C46 || ( FreeGen F4() ) ) ) = ( C49 || ( FreeGen F4() ) ) by L163 , EXTENS_1:4;
L167: C46 is  "onto" by L156 , MSUALG_3:def 8;
L168: ( rngs ( Reverse F4() ) ) = F4() by EXTENS_1:10;
L169: ( Reverse F4() ) is  "onto" by L168 , EXTENS_1:9;
L170: ( D29 ** ( Reverse F4() ) ) = ( ( C46 || ( FreeGen F4() ) ) ** ( ( ( Reverse F4() ) "" ) ** ( Reverse F4() ) ) ) by PBOOLE:140
.= ( ( C46 || ( FreeGen F4() ) ) ** ( id ( FreeGen F4() ) ) ) by L169 , L153 , MSUALG_3:5
.= ( C46 || ( FreeGen F4() ) ) by MSUALG_3:3;
L171: ( ( C50 ** D29 ) ** ( Reverse F4() ) ) = ( C48 ** ( Reverse F4() ) ) by L170 , L161 , L166 , PBOOLE:140;
thus L172: ( C50 ** D29 ) = C48 by L171 , L169 , EXTENS_1:12;
let C51 being (ManySortedFunction of C45 , C47);
assume L173: C51 is_homomorphism C45 , C47;
assume L174: ( C51 ** D29 ) = C48;
L175: ( C51 ** ( ( ( C46 || ( FreeGen F4() ) ) ** ( ( Reverse F4() ) "" ) ) ** ( Reverse F4() ) ) ) = ( ( C50 ** ( ( C46 || ( FreeGen F4() ) ) ** ( ( Reverse F4() ) "" ) ) ) ** ( Reverse F4() ) ) by L174 , L171 , PBOOLE:140;
L176: ( C51 ** ( ( ( C46 || ( FreeGen F4() ) ) ** ( ( Reverse F4() ) "" ) ) ** ( Reverse F4() ) ) ) = ( C50 ** ( ( ( C46 || ( FreeGen F4() ) ) ** ( ( Reverse F4() ) "" ) ) ** ( Reverse F4() ) ) ) by L175 , PBOOLE:140;
L177: ( C51 ** ( ( C46 || ( FreeGen F4() ) ) ** ( ( ( Reverse F4() ) "" ) ** ( Reverse F4() ) ) ) ) = ( C50 ** ( ( ( C46 || ( FreeGen F4() ) ) ** ( ( Reverse F4() ) "" ) ) ** ( Reverse F4() ) ) ) by L176 , PBOOLE:140;
L178: ( C51 ** ( ( C46 || ( FreeGen F4() ) ) ** ( ( ( Reverse F4() ) "" ) ** ( Reverse F4() ) ) ) ) = ( C50 ** ( ( C46 || ( FreeGen F4() ) ) ** ( ( ( Reverse F4() ) "" ) ** ( Reverse F4() ) ) ) ) by L177 , PBOOLE:140;
L179: ( C51 ** ( ( C46 || ( FreeGen F4() ) ) ** ( id ( FreeGen F4() ) ) ) ) = ( C50 ** ( ( C46 || ( FreeGen F4() ) ) ** ( ( ( Reverse F4() ) "" ) ** ( Reverse F4() ) ) ) ) by L178 , L169 , L153 , MSUALG_3:5;
L180: ( C51 ** ( ( C46 || ( FreeGen F4() ) ) ** ( id ( FreeGen F4() ) ) ) ) = ( C50 ** ( ( C46 || ( FreeGen F4() ) ) ** ( id ( FreeGen F4() ) ) ) ) by L179 , L169 , L153 , MSUALG_3:5;
L181: ( C51 ** ( C46 || ( FreeGen F4() ) ) ) = ( C50 ** ( ( C46 || ( FreeGen F4() ) ) ** ( id ( FreeGen F4() ) ) ) ) by L180 , MSUALG_3:3;
L182: ( C51 ** ( C46 || ( FreeGen F4() ) ) ) = ( C50 ** ( C46 || ( FreeGen F4() ) ) ) by L181 , MSUALG_3:3;
L183: ( ( C51 ** C46 ) || ( FreeGen F4() ) ) = ( C50 ** ( C46 || ( FreeGen F4() ) ) ) by L182 , EXTENS_1:4;
L184: ( ( C51 ** C46 ) || ( FreeGen F4() ) ) = ( ( C50 ** C46 ) || ( FreeGen F4() ) ) by L183 , EXTENS_1:4;
L185: C46 is_homomorphism D28 , C45 by L156 , MSUALG_3:def 8;
L186: ( C51 ** C46 ) is_homomorphism D28 , C47 by L185 , L173 , MSUALG_3:10;
L187: ( C51 ** C46 ) = ( C50 ** C46 ) by L186 , L160 , L163 , L184 , EXTENS_1:14;
thus L188: thesis by L187 , L167 , EXTENS_1:12;
end;
scheme Exhash { F5() -> non  empty non  void ManySortedSign , F6 , F7() ->  non-empty MSAlgebra over F5() , F8() -> (ManySortedFunction of ( (the carrier of F5()) --> ( NAT ) ) , (the Sorts of F6())) , F9() -> (ManySortedFunction of ( (the carrier of F5()) --> ( NAT ) ) , (the Sorts of F7())) , P3[set] } : (ex B77 being (ManySortedFunction of F6() , F7()) st (B77 is_homomorphism F6() , F7() & ( F9() -hash ) = ( B77 ** ( F8() -hash ) )))
provided
L189: P3[ F7() ]
and
L190: (for B78 being  non-empty MSAlgebra over F5() holds (for B79 being (ManySortedFunction of ( (the carrier of F5()) --> ( NAT ) ) , (the Sorts of B78)) holds (P3[ B78 ] implies (ex B80 being (ManySortedFunction of F6() , B78) st (B80 is_homomorphism F6() , B78 & B79 = ( B80 ** F8() ))))))
proof
consider C52 being (ManySortedFunction of F6() , F7()) such that L191: C52 is_homomorphism F6() , F7() and L192: F9() = ( C52 ** F8() ) by L189 , L190;
take C52;
thus L193: C52 is_homomorphism F6() , F7() by L191;
L194: ( F8() -hash ) is_homomorphism ( FreeMSA ( (the carrier of F5()) --> ( NAT ) ) ) , F6() by L1;
L195: ( C52 ** ( F8() -hash ) ) is_homomorphism ( FreeMSA ( (the carrier of F5()) --> ( NAT ) ) ) , F7() by L194 , L191 , MSUALG_3:10;
reconsider D30 = ( (the carrier of F5()) --> ( NAT ) ) as  non-empty (ManySortedSet of (the carrier of F5()));
reconsider D31 = F9() as (ManySortedFunction of D30 , (the Sorts of F7()));
L196: ( D31 -hash ) is_homomorphism ( FreeMSA D30 ) , F7() by L1;
L197: ( ( D31 -hash ) || ( FreeGen D30 ) ) = ( F9() ** ( Reverse D30 ) ) by L1
.= ( C52 ** ( F8() ** ( Reverse D30 ) ) ) by L192 , PBOOLE:140
.= ( C52 ** ( ( F8() -hash ) || ( FreeGen ( (the carrier of F5()) --> ( NAT ) ) ) ) ) by L1
.= ( ( C52 ** ( F8() -hash ) ) || ( FreeGen ( (the carrier of F5()) --> ( NAT ) ) ) ) by EXTENS_1:4;
thus L198: thesis by L197 , L196 , L195 , EXTENS_1:14;
end;
scheme EqTerms { F10() -> non  empty non  void ManySortedSign , F11() ->  non-empty MSAlgebra over F10() , F12() -> (ManySortedFunction of ( (the carrier of F10()) --> ( NAT ) ) , (the Sorts of F11())) , F13() -> (SortSymbol of F10()) , F14 , F15() -> (Element of ( (the Sorts of ( TermAlg F10() )) . F13() )) , P4[set] } : (for B81 being  non-empty MSAlgebra over F10() holds (P4[ B81 ] implies B81 |= ( F14() '=' F15() )))
provided
L199: ( ( ( F12() -hash ) . F13() ) . F14() ) = ( ( ( F12() -hash ) . F13() ) . F15() )
and
L200: (for B82 being  non-empty MSAlgebra over F10() holds (for B83 being (ManySortedFunction of ( (the carrier of F10()) --> ( NAT ) ) , (the Sorts of B82)) holds (P4[ B82 ] implies (ex B84 being (ManySortedFunction of F11() , B82) st (B84 is_homomorphism F11() , B82 & B83 = ( B84 ** F12() ))))))
proof
reconsider D32 = F12() as (ManySortedFunction of ( (the carrier of F10()) --> ( NAT ) ) , (the Sorts of F11()));
reconsider D33 = ( (the carrier of F10()) --> ( NAT ) ) as  non-empty (ManySortedSet of (the carrier of F10()));
let C53 being  non-empty MSAlgebra over F10();
assume L201: P4[ C53 ];
L202: P4[ C53 ] by L201;
let C54 being (ManySortedFunction of ( TermAlg F10() ) , C53);
assume that
L203: C54 is_homomorphism ( TermAlg F10() ) , C53;
reconsider D34 = C54 as (ManySortedFunction of ( FreeMSA D33 ) , C53);
set D35 = ( ( D34 || ( FreeGen D33 ) ) ** ( ( Reverse D33 ) "" ) );
L204: ( D35 -hash ) is_homomorphism ( FreeMSA D33 ) , C53 by L1;
reconsider D36 = D35 as (ManySortedFunction of ( (the carrier of F10()) --> ( NAT ) ) , (the Sorts of C53));
L205: (for B85 being  non-empty MSAlgebra over F10() holds (for B86 being (ManySortedFunction of ( (the carrier of F10()) --> ( NAT ) ) , (the Sorts of B85)) holds (P4[ B85 ] implies (ex B87 being (ManySortedFunction of F11() , B85) st (B87 is_homomorphism F11() , B85 & B86 = ( B87 ** D32 )))))) by L200;
consider C55 being (ManySortedFunction of F11() , C53) such that L206: C55 is_homomorphism F11() , C53 and L207: ( D36 -hash ) = ( C55 ** ( D32 -hash ) ) from Exhash(L202 , L205);
L208: ( ( ( D35 -hash ) . F13() ) . F14() ) = ( ( ( C55 . F13() ) * ( ( F12() -hash ) . F13() ) ) . F14() ) by L207 , MSUALG_3:2
.= ( ( C55 . F13() ) . ( ( ( F12() -hash ) . F13() ) . F15() ) ) by L199 , FUNCT_2:15
.= ( ( ( C55 . F13() ) * ( ( F12() -hash ) . F13() ) ) . F15() ) by FUNCT_2:15
.= ( ( ( D35 -hash ) . F13() ) . F15() ) by L207 , MSUALG_3:2;
L209: ( rngs ( Reverse D33 ) ) = D33 by EXTENS_1:10;
L210: ( Reverse D33 ) is  "1-1"  "onto" by L209 , EXTENS_1:9 , MSUALG_9:11;
L211: ( ( D35 -hash ) || ( FreeGen D33 ) ) = ( D35 ** ( Reverse D33 ) ) by L1
.= ( ( D34 || ( FreeGen D33 ) ) ** ( ( ( Reverse D33 ) "" ) ** ( Reverse D33 ) ) ) by PBOOLE:140
.= ( ( D34 || ( FreeGen D33 ) ) ** ( id ( FreeGen D33 ) ) ) by L210 , MSUALG_3:5
.= ( D34 || ( FreeGen D33 ) ) by MSUALG_3:3;
L212: ( D35 -hash ) = D34 by L211 , L203 , L204 , EXTENS_1:14;
thus L213: ( ( C54 . F13() ) . ( [ F14() , F15() ] `1 ) ) = ( ( C54 . F13() ) . F14() )
.= ( ( C54 . F13() ) . ( [ F14() , F15() ] `2 ) ) by L212 , L208;
end;
scheme FreeIsGen { F16() -> non  empty non  void ManySortedSign , F17() ->  non-empty (ManySortedSet of (the carrier of F16())) , F18() ->  strict  non-empty MSAlgebra over F16() , F19() -> (ManySortedFunction of F17() , (the Sorts of F18())) , P5[set] } : ( F19() .:.: F17() ) is  non-empty  non-empty  non-empty  non-empty (GeneratorSet of F18())
provided
L214: (for B88 being  non-empty MSAlgebra over F16() holds (for B89 being (ManySortedFunction of F17() , (the Sorts of B88)) holds (P5[ B88 ] implies (ex B90 being (ManySortedFunction of F18() , B88) st (B90 is_homomorphism F18() , B88 & ( B90 ** F19() ) = B89 & (for B91 being (ManySortedFunction of F18() , B88) holds ((B91 is_homomorphism F18() , B88 & ( B91 ** F19() ) = B89) implies B90 = B91)))))))
and
L215: P5[ F18() ]
and
L216: (for B92 being  non-empty MSAlgebra over F16() holds (for B93 being  strict  non-empty (MSSubAlgebra of B92) holds (P5[ B92 ] implies P5[ B93 ])))
proof
set D37 = (the carrier of F16());
L217: ( F19() .:.: F17() ) is  non-empty
proof
let C56 being set;
assume L218: C56 in D37;
reconsider D38 = ( F19() . C56 ) as (Function of ( F17() . C56 ) , ( (the Sorts of F18()) . C56 )) by L218 , PBOOLE:def 15;
L219: ( ( F19() .:.: F17() ) . C56 ) = ( D38 .: ( F17() . C56 ) ) by L218 , PBOOLE:def 20;
reconsider D39 = ( F17() . C56 ) as non  empty set by L218;
L220: D39 meets D39;
L221: ( dom D38 ) = D39 by L218 , FUNCT_2:def 1;
thus L222: thesis by L221 , L220 , L219 , RELAT_1:118;
end;
L223: ( F19() .:.: F17() ) is (ManySortedSubset of (the Sorts of F18()))
proof
let C57 being set;
assume L224: C57 in D37;
reconsider D40 = ( F19() . C57 ) as (Function of ( F17() . C57 ) , ( (the Sorts of F18()) . C57 )) by L224 , PBOOLE:def 15;
L225: ( ( F19() .:.: F17() ) . C57 ) = ( D40 .: ( F17() . C57 ) ) by L224 , PBOOLE:def 20;
thus L226: thesis by L225;
end;
reconsider D41 = ( F19() .:.: F17() ) as  non-empty (MSSubset of F18()) by L223 , L217;
set D42 = ( GenMSAlg D41 );
L227: F17() is_transformable_to (the Sorts of D42)
proof
let C58 being set;
assume L228: C58 in D37;
thus L229: thesis by L228;
end;
L230: F17() is_transformable_to (the Sorts of F18())
proof
let C59 being set;
assume L231: C59 in D37;
thus L232: thesis by L231;
end;
L233: ( doms F19() ) = F17() by L230 , MSSUBFAM:17;
L234: ( rngs F19() ) = ( F19() .:.: F17() ) by L233 , EQUATION:13;
L235: ( rngs F19() ) is (ManySortedSubset of (the Sorts of D42)) by L234 , MSUALG_2:def 17;
L236: ( rngs F19() ) c= (the Sorts of D42) by L235 , PBOOLE:def 18;
reconsider D43 = F19() as (ManySortedFunction of F17() , (the Sorts of D42)) by L236 , L227 , L233 , EQUATION:4;
consider C60 being (ManySortedFunction of F18() , D42) such that L237: C60 is_homomorphism F18() , D42 and L238: ( C60 ** F19() ) = D43 and L239: (for B94 being (ManySortedFunction of F18() , D42) holds ((B94 is_homomorphism F18() , D42 & ( B94 ** F19() ) = D43) implies C60 = B94)) by L214 , L215 , L216;
L240: (the Sorts of D42) is (ManySortedSubset of (the Sorts of F18())) by MSUALG_2:def 9;
reconsider D44 = ( id (the Sorts of D42) ) as (ManySortedFunction of D42 , F18()) by L240 , EXTENS_1:5;
consider C61 being (ManySortedFunction of F18() , F18()) such that L241: C61 is_homomorphism F18() , F18() and L242: ( C61 ** F19() ) = ( D44 ** D43 ) and L243: (for B95 being (ManySortedFunction of F18() , F18()) holds ((B95 is_homomorphism F18() , F18() & ( B95 ** F19() ) = ( D44 ** D43 )) implies C61 = B95)) by L214 , L215;
L244: D44 is_monomorphism D42 , F18() by MSUALG_3:22;
L245: D44 is_homomorphism D42 , F18() by L244 , MSUALG_3:def 9;
reconsider D45 = ( D44 ** C60 ) as (ManySortedFunction of F18() , F18());
L246: ( D44 ** D43 ) = ( ( D44 ** C60 ) ** F19() ) by L238 , PBOOLE:140;
L247: C61 = D45 by L246 , L237 , L243 , L245 , MSUALG_3:10;
L248: F18() is (MSSubAlgebra of F18()) by MSUALG_2:5;
L249: F19() = ( D44 ** D43 ) by MSUALG_3:4;
L250: ( ( id (the Sorts of F18()) ) ** F19() ) = ( D44 ** D43 ) by L249 , MSUALG_3:4;
L251: C61 = ( id (the Sorts of F18()) ) by L250 , L243 , MSUALG_3:9;
L252: C61 is  "onto" by L251;
L253: (the Sorts of D42) = ( D44 .:.: (the Sorts of D42) ) by EQUATION:15
.= (the Sorts of F18()) by L247 , L252 , EQUATION:2 , EQUATION:9;
L254: D42 = F18() by L253 , L248 , MSUALG_2:9;
thus L255: thesis by L254 , MSAFREE:3;
end;
scheme Hashisonto { F20() -> non  empty non  void ManySortedSign , F21() ->  strict  non-empty MSAlgebra over F20() , F22() -> (ManySortedFunction of ( (the carrier of F20()) --> ( NAT ) ) , (the Sorts of F21())) , P6[set] } : ( F22() -hash ) is_epimorphism ( FreeMSA ( (the carrier of F20()) --> ( NAT ) ) ) , F21()
provided
L256: (for B96 being  non-empty MSAlgebra over F20() holds (for B97 being (ManySortedFunction of ( (the carrier of F20()) --> ( NAT ) ) , (the Sorts of B96)) holds (P6[ B96 ] implies (ex B98 being (ManySortedFunction of F21() , B96) st (B98 is_homomorphism F21() , B96 & ( B98 ** F22() ) = B97 & (for B99 being (ManySortedFunction of F21() , B96) holds ((B99 is_homomorphism F21() , B96 & ( B99 ** F22() ) = B97) implies B98 = B99)))))))
and
L257: P6[ F21() ]
and
L258: (for B100 being  non-empty MSAlgebra over F20() holds (for B101 being  strict  non-empty (MSSubAlgebra of B100) holds (P6[ B100 ] implies P6[ B101 ])))
proof
L259: P6[ F21() ] by L257;
set D46 = ( (the carrier of F20()) --> ( NAT ) );
reconsider D47 = (the Sorts of ( FreeMSA D46 )) as (GeneratorSet of ( FreeMSA D46 )) by MSAFREE2:6;
L260: ( F22() .:.: D46 ) c= ( rngs F22() ) by EQUATION:12;
L261: (the Sorts of ( FreeMSA D46 )) is_transformable_to (the Sorts of F21())
proof
let C62 being set;
assume that
L262: C62 in (the carrier of F20());
assume L263: ( (the Sorts of F21()) . C62 ) = ( {} );
thus L264: thesis by L263 , L262;
end;
L265: ( doms ( F22() -hash ) ) = (the Sorts of ( FreeMSA D46 )) by L261 , MSSUBFAM:17;
L266: ( ( F22() -hash ) .:.: (the Sorts of ( FreeMSA D46 )) ) = ( rngs ( F22() -hash ) ) by L265 , EQUATION:13;
L267: ( rngs F22() ) c= ( rngs ( F22() -hash ) ) by L3;
L268: ( F22() .:.: D46 ) c= ( ( F22() -hash ) .:.: D47 ) by L267 , L266 , L260 , PBOOLE:13;
L269: ( F22() -hash ) is_homomorphism ( FreeMSA D46 ) , F21() by L1;
L270: (for B102 being  non-empty MSAlgebra over F20() holds (for B103 being  strict  non-empty (MSSubAlgebra of B102) holds (P6[ B102 ] implies P6[ B103 ]))) by L258;
L271: (for B104 being  non-empty MSAlgebra over F20() holds (for B105 being (ManySortedFunction of ( (the carrier of F20()) --> ( NAT ) ) , (the Sorts of B104)) holds (P6[ B104 ] implies (ex B106 being (ManySortedFunction of F21() , B104) st (B106 is_homomorphism F21() , B104 & ( B106 ** F22() ) = B105 & (for B107 being (ManySortedFunction of F21() , B104) holds ((B107 is_homomorphism F21() , B104 & ( B107 ** F22() ) = B105) implies B106 = B107))))))) by L256;
L272: ( F22() .:.: D46 ) is  non-empty  non-empty  non-empty  non-empty (GeneratorSet of F21()) from FreeIsGen(L271 , L259 , L270);
thus L273: thesis by L272 , L268 , L269 , EQUATION:23;
end;
scheme FinGenAlgInVar { F23() -> non  empty non  void ManySortedSign , F24() ->  strict  finitely-generated  non-empty MSAlgebra over F23() , F25() ->  non-empty MSAlgebra over F23() , F26() -> (ManySortedFunction of ( (the carrier of F23()) --> ( NAT ) ) , (the Sorts of F25())) , P7 , P8[set] } : P7[ F24() ]
provided
L274: P8[ F24() ]
and
L275: P7[ F25() ]
and
L276: (for B108 being  non-empty MSAlgebra over F23() holds (for B109 being (ManySortedFunction of ( (the carrier of F23()) --> ( NAT ) ) , (the Sorts of B108)) holds (P8[ B108 ] implies (ex B110 being (ManySortedFunction of F25() , B108) st (B110 is_homomorphism F25() , B108 & B109 = ( B110 ** F26() ))))))
and
L277: (for B111 , B112 being  non-empty MSAlgebra over F23() holds ((B111 , B112 are_isomorphic  & P7[ B111 ]) implies P7[ B112 ]))
and
L278: (for B113 being  non-empty MSAlgebra over F23() holds (for B114 being (MSCongruence of B113) holds (P7[ B113 ] implies P7[ ( QuotMSAlg (B113 , B114) ) ])))
proof
set D48 = (the carrier of F23());
set D49 = (the Sorts of F24());
consider C63 being (GeneratorSet of F24()) such that L279: C63 is  finite-yielding by MSAFREE2:def 10;
reconsider D50 = C63 as  finite-yielding (ManySortedSubset of D49) by L279;
consider C64 being  non-empty  finite-yielding (ManySortedSubset of D49) such that L280: D50 c= C64 by MSUALG_9:7;
consider C65 being (ManySortedFunction of ( D48 --> ( NAT ) ) , C64) such that L281: C65 is  "onto" by MSUALG_9:12;
L282: ( D48 --> ( NAT ) ) is_transformable_to C64
proof
let C66 being set;
assume L283: C66 in D48;
thus L284: thesis by L283;
end;
reconsider D51 = C65 as (ManySortedFunction of ( D48 --> ( NAT ) ) , D49) by L282 , EXTENS_1:5;
consider C67 being (ManySortedFunction of F25() , F24()) such that L285: C67 is_homomorphism F25() , F24() and L286: D51 = ( C67 ** F26() ) by L274 , L276;
reconsider D52 = (the Sorts of ( Image C67 )) as (MSSubset of ( Image C67 )) by PBOOLE:def 18;
L287: C64 is (GeneratorSet of F24()) by L280 , MSSCYC_1:21;
reconsider D53 = (the Sorts of ( Image C67 )) as (MSSubset of F24()) by MSUALG_2:def 9;
L288: C64 is (ManySortedSubset of D53)
proof
let C68 being set;
assume L289: C68 in D48;
reconsider D54 = C68 as (SortSymbol of F23()) by L289;
let C69 being set;
assume L290: C69 in ( C64 . C68 );
L291: ( ( D48 --> ( NAT ) ) . D54 ) = ( NAT ) by FUNCOP_1:7;
reconsider D55 = ( F26() . D54 ) as (Function of ( NAT ) , ( (the Sorts of F25()) . D54 )) by L291;
L292: ( dom ( ( C67 . D54 ) * D55 ) ) = ( NAT ) by FUNCT_2:def 1
.= ( dom D55 ) by FUNCT_2:def 1;
L293: ( rng D55 ) c= ( dom ( C67 . D54 ) ) by L292 , FUNCT_1:15;
L294: ( rng ( C65 . D54 ) ) = ( C64 . D54 ) by L281 , MSUALG_3:def 3;
consider C70 being set such that L295: C70 in ( dom ( C65 . D54 ) ) and L296: C69 = ( ( C65 . D54 ) . C70 ) by L294 , L290 , FUNCT_1:def 3;
L297: ( dom ( C65 . D54 ) ) = ( NAT ) by L291 , FUNCT_2:def 1
.= ( dom D55 ) by FUNCT_2:def 1;
L298: ( D55 . C70 ) in ( rng D55 ) by L297 , L295 , FUNCT_1:def 3;
L299: C69 = ( ( ( C67 . D54 ) * D55 ) . C70 ) by L286 , L296 , MSUALG_3:2
.= ( ( C67 . D54 ) . ( D55 . C70 ) ) by L295 , FUNCT_2:15;
L300: C69 in ( ( C67 . D54 ) .: ( (the Sorts of F25()) . D54 ) ) by L299 , L298 , L293 , FUNCT_1:def 6;
L301: C69 in ( ( C67 .:.: (the Sorts of F25()) ) . D54 ) by L300 , PBOOLE:def 20;
thus L302: thesis by L301 , L285 , MSUALG_3:def 12;
end;
L303: ( GenMSAlg C64 ) is (MSSubAlgebra of ( GenMSAlg D53 )) by L288 , EXTENS_1:17;
L304: ( GenMSAlg D53 ) = ( GenMSAlg D52 ) by EXTENS_1:18;
L305: ( GenMSAlg C64 ) is (MSSubAlgebra of ( Image C67 )) by L304 , L303 , MSUALG_2:21;
L306: F24() is (MSSubAlgebra of ( Image C67 )) by L305 , L287 , MSAFREE:3;
L307: F24() = ( Image C67 ) by L306 , MSUALG_2:7;
L308: C67 is_epimorphism F25() , F24() by L307 , L285 , MSUALG_3:19;
L309: P7[ ( QuotMSAlg (F25() , ( MSCng C67 )) ) ] by L275 , L278;
thus L310: thesis by L309 , L277 , L308 , MSUALG_4:6;
end;
scheme QuotEpi { F27() -> non  empty non  void ManySortedSign , F28 , F29() ->  non-empty MSAlgebra over F27() , P9[set] } : P9[ F29() ]
provided
L311: (ex B115 being (ManySortedFunction of F28() , F29()) st B115 is_epimorphism F28() , F29())
and
L312: P9[ F28() ]
and
L313: (for B116 , B117 being  non-empty MSAlgebra over F27() holds ((B116 , B117 are_isomorphic  & P9[ B116 ]) implies P9[ B117 ]))
and
L314: (for B118 being  non-empty MSAlgebra over F27() holds (for B119 being (MSCongruence of B118) holds (P9[ B118 ] implies P9[ ( QuotMSAlg (B118 , B119) ) ])))
proof
consider C71 being (ManySortedFunction of F28() , F29()) such that L315: C71 is_epimorphism F28() , F29() by L311;
L316: P9[ ( QuotMSAlg (F28() , ( MSCng C71 )) ) ] by L312 , L314;
thus L317: thesis by L316 , L313 , L315 , MSUALG_4:6;
end;
scheme AllFinGen { F30() -> non  empty non  void ManySortedSign , F31() ->  non-empty MSAlgebra over F30() , P10[set] } : P10[ F31() ]
provided
L318: (for B120 being  strict  non-empty  finitely-generated (MSSubAlgebra of F31()) holds P10[ B120 ])
and
L319: (for B121 , B122 being  non-empty MSAlgebra over F30() holds ((B121 , B122 are_isomorphic  & P10[ B121 ]) implies P10[ B122 ]))
and
L320: (for B123 being  non-empty MSAlgebra over F30() holds (for B124 being  strict  non-empty (MSSubAlgebra of B123) holds (P10[ B123 ] implies P10[ B124 ])))
and
L321: (for B125 being  non-empty MSAlgebra over F30() holds (for B126 being (MSCongruence of B125) holds (P10[ B125 ] implies P10[ ( QuotMSAlg (B125 , B126) ) ])))
and
L322: (for B127 being set holds (for B128 being (MSAlgebra-Family of B127 , F30()) holds ((for B129 being set holds (B129 in B127 implies (ex B130 being MSAlgebra over F30() st (B130 = ( B128 . B129 ) & P10[ B130 ])))) implies P10[ ( product B128 ) ])))
proof
L323: (for B131 , B132 being  non-empty MSAlgebra over F30() holds ((B131 , B132 are_isomorphic  & P10[ B131 ]) implies P10[ B132 ])) by L319;
set D56 = the  strict  non-empty  finitely-generated (MSSubAlgebra of F31());
set D57 = { B133 where B133 is (Element of ( MSSub F31() )) : (ex B134 being  strict  non-empty  finitely-generated (MSSubAlgebra of F31()) st B134 = B133) };
L324: D56 in ( MSSub F31() ) by MSUALG_2:def 19;
L325: D56 in D57 by L324;
reconsider D58 = D57 as non  empty set by L325;
defpred S4[ set , set ] means $1 = $2;
L326: (for B135 being set holds (B135 in D58 implies (ex B136 being set st S4[ B135 , B136 ])));
consider C72 being (ManySortedSet of D58) such that L327: (for B137 being set holds (B137 in D58 implies S4[ B137 , ( C72 . B137 ) ])) from PBOOLE:sch 3(L326);
L328: C72 is (MSAlgebra-Family of D58 , F30())
proof
let C73 being set;
assume L329: C73 in D58;
L330: (ex B138 being (Element of ( MSSub F31() )) st (C73 = B138 & (ex B139 being  strict  non-empty  finitely-generated (MSSubAlgebra of F31()) st B139 = B138))) by L329;
thus L331: thesis by L330 , L327 , L329;
end;
reconsider D59 = C72 as (MSAlgebra-Family of D58 , F30()) by L328;
consider C74 being  strict  non-empty (MSSubAlgebra of ( product D59 )) such that L332: (ex B140 being (ManySortedFunction of C74 , F31()) st B140 is_epimorphism C74 , F31()) by L327 , EQUATION:27;
L333: (for B141 being  non-empty MSAlgebra over F30() holds (for B142 being (MSCongruence of B141) holds (P10[ B141 ] implies P10[ ( QuotMSAlg (B141 , B142) ) ]))) by L321;
L334: (for B143 being set holds (B143 in D58 implies (ex B144 being MSAlgebra over F30() st (B144 = ( D59 . B143 ) & P10[ B144 ]))))
proof
let C75 being set;
assume L335: C75 in D58;
consider C76 being (Element of ( MSSub F31() )) such that L336: C75 = C76 and L337: (ex B145 being  strict  non-empty  finitely-generated (MSSubAlgebra of F31()) st B145 = C76) by L335;
consider C77 being  strict  non-empty  finitely-generated (MSSubAlgebra of F31()) such that L338: C77 = C76 by L337;
take C77;
thus L339: thesis by L318 , L327 , L335 , L336 , L338;
end;
L340: P10[ C74 ] by L334 , L320 , L322;
thus L341: P10[ F31() ] from QuotEpi(L332 , L340 , L323 , L333);
end;
scheme FreeInModIsInVar1 { F32() -> non  empty non  void ManySortedSign , F33() ->  non-empty MSAlgebra over F32() , P11 , P12[set] } : P12[ F33() ]
provided
L342: (for B146 being  non-empty MSAlgebra over F32() holds (P12[ B146 ] iff (for B147 being (SortSymbol of F32()) holds (for B148 being (Element of ( ( Equations F32() ) . B147 )) holds ((for B149 being  non-empty MSAlgebra over F32() holds (P11[ B149 ] implies B149 |= B148)) implies B146 |= B148)))))
and
L343: P11[ F33() ]
proof
L344: (for B150 being (SortSymbol of F32()) holds (for B151 being (Element of ( ( Equations F32() ) . B150 )) holds ((for B152 being  non-empty MSAlgebra over F32() holds (P11[ B152 ] implies B152 |= B151)) implies F33() |= B151))) by L343;
thus L345: thesis by L344 , L342;
end;
scheme FreeInModIsInVar { F34() -> non  empty non  void ManySortedSign , F35() ->  strict  non-empty MSAlgebra over F34() , F36() -> (ManySortedFunction of ( (the carrier of F34()) --> ( NAT ) ) , (the Sorts of F35())) , P13 , P14[set] } : P13[ F35() ]
provided
L346: (for B153 being  non-empty MSAlgebra over F34() holds (P14[ B153 ] iff (for B154 being (SortSymbol of F34()) holds (for B155 being (Element of ( ( Equations F34() ) . B154 )) holds ((for B156 being  non-empty MSAlgebra over F34() holds (P13[ B156 ] implies B156 |= B155)) implies B153 |= B155)))))
and
L347: (for B157 being  non-empty MSAlgebra over F34() holds (for B158 being (ManySortedFunction of ( (the carrier of F34()) --> ( NAT ) ) , (the Sorts of B157)) holds (P14[ B157 ] implies (ex B159 being (ManySortedFunction of F35() , B157) st (B159 is_homomorphism F35() , B157 & ( B159 ** F36() ) = B158 & (for B160 being (ManySortedFunction of F35() , B157) holds ((B160 is_homomorphism F35() , B157 & ( B160 ** F36() ) = B158) implies B159 = B160)))))))
and
L348: P14[ F35() ]
and
L349: (for B161 , B162 being  non-empty MSAlgebra over F34() holds ((B161 , B162 are_isomorphic  & P13[ B161 ]) implies P13[ B162 ]))
and
L350: (for B163 being  non-empty MSAlgebra over F34() holds (for B164 being  strict  non-empty (MSSubAlgebra of B163) holds (P13[ B163 ] implies P13[ B164 ])))
and
L351: (for B165 being set holds (for B166 being (MSAlgebra-Family of B165 , F34()) holds ((for B167 being set holds (B167 in B165 implies (ex B168 being MSAlgebra over F34() st (B168 = ( B166 . B167 ) & P13[ B168 ])))) implies P13[ ( product B166 ) ])))
proof
L352: (for B169 being set holds (for B170 being (MSAlgebra-Family of B169 , F34()) holds ((for B171 being set holds (B171 in B169 implies (ex B172 being MSAlgebra over F34() st (B172 = ( B170 . B171 ) & P13[ B172 ])))) implies P13[ ( product B170 ) ]))) by L351;
set D60 = ( (the carrier of F34()) --> ( NAT ) );
L353: (for B173 being  non-empty MSAlgebra over F34() holds (for B174 being  strict  non-empty (MSSubAlgebra of B173) holds (P13[ B173 ] implies P13[ B174 ]))) by L350;
L354: (for B175 , B176 being  non-empty MSAlgebra over F34() holds ((B175 , B176 are_isomorphic  & P13[ B175 ]) implies P13[ B176 ])) by L349;
consider C78 being  strict  non-empty MSAlgebra over F34(), C79 being (ManySortedFunction of D60 , (the Sorts of C78)) such that L355: P13[ C78 ] and L356: (for B177 being  non-empty MSAlgebra over F34() holds (for B178 being (ManySortedFunction of D60 , (the Sorts of B177)) holds (P13[ B177 ] implies (ex B179 being (ManySortedFunction of C78 , B177) st (B179 is_homomorphism C78 , B177 & ( B179 ** C79 ) = B178 & (for B180 being (ManySortedFunction of C78 , B177) holds ((B180 is_homomorphism C78 , B177 & ( B180 ** C79 ) = B178) implies B179 = B180))))))) from ExFreeAlg2(L354 , L353 , L352);
L357: (for B181 being  non-empty MSAlgebra over F34() holds (for B182 being (ManySortedFunction of ( (the carrier of F34()) --> ( NAT ) ) , (the Sorts of B181)) holds (P14[ B181 ] implies (ex B183 being (ManySortedFunction of F35() , B181) st (B183 is_homomorphism F35() , B181 & ( B183 ** F36() ) = B182 & (for B184 being (ManySortedFunction of F35() , B181) holds ((B184 is_homomorphism F35() , B181 & ( B184 ** F36() ) = B182) implies B183 = B184))))))) by L347;
L358: (for B185 being  non-empty MSAlgebra over F34() holds (for B186 being (ManySortedFunction of ( (the carrier of F34()) --> ( NAT ) ) , (the Sorts of B185)) holds (P14[ B185 ] implies (ex B187 being (ManySortedFunction of F35() , B185) st (B187 is_homomorphism F35() , B185 & B186 = ( B187 ** F36() ))))))
proof
let C80 being  non-empty MSAlgebra over F34();
let C81 being (ManySortedFunction of D60 , (the Sorts of C80));
assume L359: P14[ C80 ];
consider C82 being (ManySortedFunction of F35() , C80) such that L360: C82 is_homomorphism F35() , C80 and L361: C81 = ( C82 ** F36() ) and L362: (for B188 being (ManySortedFunction of F35() , C80) holds ((B188 is_homomorphism F35() , C80 & ( B188 ** F36() ) = C81) implies C82 = B188)) by L359 , L347;
take C82;
thus L363: thesis by L360 , L361;
end;
L364: P14[ F35() ] by L348;
L365: (for B189 being  non-empty MSAlgebra over F34() holds (P14[ B189 ] iff (for B190 being (SortSymbol of F34()) holds (for B191 being (Element of ( ( Equations F34() ) . B190 )) holds ((for B192 being  non-empty MSAlgebra over F34() holds (P13[ B192 ] implies B192 |= B191)) implies B189 |= B191))))) by L346;
L366: P14[ C78 ] from FreeInModIsInVar1(L365 , L355);
consider C83 being (ManySortedFunction of F35() , C78) such that L367: C83 is_homomorphism F35() , C78 and L368: ( C79 -hash ) = ( C83 ** ( F36() -hash ) ) from Exhash(L366 , L358);
L369: ( F36() -hash ) is_homomorphism ( FreeMSA D60 ) , F35() by L1;
L370:
now
let C84 being set;
assume L371: C84 in (the carrier of F34());
reconsider D61 = C84 as (SortSymbol of F34()) by L371;
thus L372: ( C83 . C84 ) is  one-to-one
proof
L373: (for B193 being  non-empty MSAlgebra over F34() holds (for B194 being  strict  non-empty (MSSubAlgebra of B193) holds (P14[ B193 ] implies P14[ B194 ])))
proof
let C85 being  non-empty MSAlgebra over F34();
let C86 being  strict  non-empty (MSSubAlgebra of C85);
assume that
L374: P14[ C85 ];
L375:
now
let C87 being (SortSymbol of F34());
let C88 being (Element of ( ( Equations F34() ) . C87 ));
assume L376: (for B195 being  non-empty MSAlgebra over F34() holds (P13[ B195 ] implies B195 |= C88));
L377: C85 |= C88 by L376 , L346 , L374;
thus L378: C86 |= C88 by L377 , EQUATION:31;
end;
thus L379: thesis by L375 , L346;
end;
L380: ( F36() -hash ) is_epimorphism ( FreeMSA D60 ) , F35() from Hashisonto(L357 , L364 , L373);
L381: ( F36() -hash ) is  "onto" by L380 , MSUALG_3:def 8;
L382: (for B196 being  non-empty MSAlgebra over F34() holds (for B197 being (ManySortedFunction of D60 , (the Sorts of B196)) holds (P13[ B196 ] implies (ex B198 being (ManySortedFunction of C78 , B196) st (B198 is_homomorphism C78 , B196 & B197 = ( B198 ** C79 ))))))
proof
let C89 being  non-empty MSAlgebra over F34();
let C90 being (ManySortedFunction of D60 , (the Sorts of C89));
assume L383: P13[ C89 ];
consider C91 being (ManySortedFunction of C78 , C89) such that L384: C91 is_homomorphism C78 , C89 and L385: ( C91 ** C79 ) = C90 and L386: (for B199 being (ManySortedFunction of C78 , C89) holds ((B199 is_homomorphism C78 , C89 & ( B199 ** C79 ) = C90) implies C91 = B199)) by L383 , L356;
take C91;
thus L387: thesis by L384 , L385;
end;
let C92 , C93 being set;
assume that
L388: C92 in ( dom ( C83 . C84 ) )
and
L389: C93 in ( dom ( C83 . C84 ) )
and
L390: ( ( C83 . C84 ) . C92 ) = ( ( C83 . C84 ) . C93 );
L391: ( dom ( C83 . D61 ) ) = ( (the Sorts of F35()) . D61 ) by FUNCT_2:def 1
.= ( rng ( ( F36() -hash ) . D61 ) ) by L381 , MSUALG_3:def 3;
consider C94 being set such that L392: C94 in ( dom ( ( F36() -hash ) . D61 ) ) and L393: ( ( ( F36() -hash ) . D61 ) . C94 ) = C92 by L391 , L388 , FUNCT_1:def 3;
consider C95 being set such that L394: C95 in ( dom ( ( F36() -hash ) . D61 ) ) and L395: ( ( ( F36() -hash ) . D61 ) . C95 ) = C93 by L389 , L391 , FUNCT_1:def 3;
reconsider D62 = C94 , D63 = C95 as (Element of ( (the Sorts of ( TermAlg F34() )) . D61 )) by L392 , L394;
set D64 = ( D62 '=' D63 );
L396: ( ( ( C79 -hash ) . D61 ) . D62 ) = ( ( ( C83 . D61 ) * ( ( F36() -hash ) . D61 ) ) . D62 ) by L368 , MSUALG_3:2
.= ( ( C83 . D61 ) . C92 ) by L393 , FUNCT_2:15
.= ( ( ( C83 . D61 ) * ( ( F36() -hash ) . D61 ) ) . D63 ) by L390 , L395 , FUNCT_2:15
.= ( ( ( C79 -hash ) . D61 ) . D63 ) by L368 , MSUALG_3:2;
L397: (for B200 being  non-empty MSAlgebra over F34() holds (P13[ B200 ] implies B200 |= ( D62 '=' D63 ))) from EqTerms(L396 , L382);
L398: F35() |= D64 by L397 , L346 , L348;
thus L399: C92 = ( ( ( F36() -hash ) . D61 ) . ( D64 `1 ) ) by L393
.= ( ( ( F36() -hash ) . D61 ) . ( D64 `2 ) ) by L369 , L398 , EQUATION:def 5
.= C93 by L395;
end;

end;
L373: C83 is  "1-1" by L370 , MSUALG_3:1;
L374: C83 is_monomorphism F35() , C78 by L373 , L367 , MSUALG_3:def 9;
L375: F35() , ( Image C83 ) are_isomorphic  by L374 , MSUALG_9:16;
L376: P13[ ( Image C83 ) ] by L350 , L355;
thus L377: thesis by L376 , L349 , L375 , MSUALG_3:17;
end;
::$N Birkhoff Variety Theorem
scheme Birkhoff { F37() -> non  empty non  void ManySortedSign , P15[set] } : (ex B201 being (EqualSet of F37()) st (for B202 being  non-empty MSAlgebra over F37() holds (P15[ B202 ] iff B202 |= B201)))
provided
L378: (for B203 , B204 being  non-empty MSAlgebra over F37() holds ((B203 , B204 are_isomorphic  & P15[ B203 ]) implies P15[ B204 ]))
and
L379: (for B205 being  non-empty MSAlgebra over F37() holds (for B206 being  strict  non-empty (MSSubAlgebra of B205) holds (P15[ B205 ] implies P15[ B206 ])))
and
L380: (for B207 being  non-empty MSAlgebra over F37() holds (for B208 being (MSCongruence of B207) holds (P15[ B207 ] implies P15[ ( QuotMSAlg (B207 , B208) ) ])))
and
L381: (for B209 being set holds (for B210 being (MSAlgebra-Family of B209 , F37()) holds ((for B211 being set holds (B211 in B209 implies (ex B212 being MSAlgebra over F37() st (B212 = ( B210 . B211 ) & P15[ B212 ])))) implies P15[ ( product B210 ) ])))
proof
L382: (for B213 being  non-empty MSAlgebra over F37() holds (for B214 being  strict  non-empty (MSSubAlgebra of B213) holds (P15[ B213 ] implies P15[ B214 ]))) by L379;
set D65 = ( (the carrier of F37()) --> ( NAT ) );
set D66 = (the carrier of F37());
defpred S5[ set , set ] means (ex B215 being (SortSymbol of F37()) st ($1 = B215 & $2 = { B216 where B216 is (Element of ( ( Equations F37() ) . B215 )) : (for B217 being  non-empty MSAlgebra over F37() holds (P15[ B217 ] implies B217 |= B216)) }));
L383:
now
let C96 being set;
assume L384: C96 in D66;
consider C97 being (SortSymbol of F37()) such that L385: C97 = C96 by L384;
take D67 = { B218 where B218 is (Element of ( ( Equations F37() ) . C97 )) : (for B219 being  non-empty MSAlgebra over F37() holds (P15[ B219 ] implies B219 |= B218)) };
thus L386: S5[ C96 , D67 ] by L385;
end;
consider C98 being (ManySortedSet of D66) such that L387: (for B220 being set holds (B220 in D66 implies S5[ B220 , ( C98 . B220 ) ])) from PBOOLE:sch 3(L383);
L388: C98 is (ManySortedSubset of ( Equations F37() ))
proof
let C99 being set;
assume L389: C99 in D66;
consider C100 being (SortSymbol of F37()) such that L390: C99 = C100 and L391: ( C98 . C99 ) = { B221 where B221 is (Element of ( ( Equations F37() ) . C100 )) : (for B222 being  non-empty MSAlgebra over F37() holds (P15[ B222 ] implies B222 |= B221)) } by L389 , L387;
let C101 being set;
assume L392: C101 in ( C98 . C99 );
L393: (ex B223 being (Element of ( ( Equations F37() ) . C100 )) st (C101 = B223 & (for B224 being  non-empty MSAlgebra over F37() holds (P15[ B224 ] implies B224 |= B223)))) by L392 , L391;
thus L394: thesis by L393 , L390;
end;
reconsider D68 = C98 as (EqualSet of F37()) by L388;
L395: (for B225 , B226 being  non-empty MSAlgebra over F37() holds ((B225 , B226 are_isomorphic  & P15[ B225 ]) implies P15[ B226 ])) by L378;
defpred S6[ MSAlgebra over F37() ] means $1 |= D68;
L396: (for B227 being  non-empty MSAlgebra over F37() holds (S6[ B227 ] iff (for B228 being (SortSymbol of F37()) holds (for B229 being (Element of ( ( Equations F37() ) . B228 )) holds ((for B230 being  non-empty MSAlgebra over F37() holds (P15[ B230 ] implies B230 |= B229)) implies B227 |= B229)))))
proof
let C102 being  non-empty MSAlgebra over F37();
thus L397: (S6[ C102 ] implies (for B231 being (SortSymbol of F37()) holds (for B232 being (Element of ( ( Equations F37() ) . B231 )) holds ((for B233 being  non-empty MSAlgebra over F37() holds (P15[ B233 ] implies B233 |= B232)) implies C102 |= B232))))
proof
assume L398: S6[ C102 ];
let C103 being (SortSymbol of F37());
let C104 being (Element of ( ( Equations F37() ) . C103 ));
assume that
L399: (for B234 being  non-empty MSAlgebra over F37() holds (P15[ B234 ] implies B234 |= C104));
L400: S5[ C103 , ( D68 . C103 ) ] by L387;
L401: C104 in ( D68 . C103 ) by L400 , L399;
thus L402: thesis by L401 , L398 , EQUATION:def 6;
end;

assume L403: (for B235 being (SortSymbol of F37()) holds (for B236 being (Element of ( ( Equations F37() ) . B235 )) holds ((for B237 being  non-empty MSAlgebra over F37() holds (P15[ B237 ] implies B237 |= B236)) implies C102 |= B236)));
let C105 being (SortSymbol of F37());
let C106 being (Element of ( ( Equations F37() ) . C105 ));
assume that
L404: C106 in ( D68 . C105 );
L405: S5[ C105 , ( D68 . C105 ) ] by L387;
L406: (ex B238 being (Element of ( ( Equations F37() ) . C105 )) st (C106 = B238 & (for B239 being  non-empty MSAlgebra over F37() holds (P15[ B239 ] implies B239 |= B238)))) by L405 , L404;
thus L407: thesis by L406 , L403;
end;
L408: (for B240 being  non-empty MSAlgebra over F37() holds (for B241 being  strict  non-empty (MSSubAlgebra of B240) holds (S6[ B240 ] implies S6[ B241 ]))) by EQUATION:32;
L409: (for B242 being set holds (for B243 being (MSAlgebra-Family of B242 , F37()) holds ((for B244 being set holds (B244 in B242 implies (ex B245 being MSAlgebra over F37() st (B245 = ( B243 . B244 ) & S6[ B245 ])))) implies S6[ ( product B243 ) ]))) by EQUATION:38;
L410: (for B246 , B247 being  non-empty MSAlgebra over F37() holds (B246 , B247 are_isomorphic  implies (S6[ B246 ] implies S6[ B247 ]))) by EQUATION:34;
consider C107 being  strict  non-empty MSAlgebra over F37(), C108 being (ManySortedFunction of D65 , (the Sorts of C107)) such that L411: S6[ C107 ] and L412: (for B248 being  non-empty MSAlgebra over F37() holds (for B249 being (ManySortedFunction of D65 , (the Sorts of B248)) holds (S6[ B248 ] implies (ex B250 being (ManySortedFunction of C107 , B248) st (B250 is_homomorphism C107 , B248 & ( B250 ** C108 ) = B249 & (for B251 being (ManySortedFunction of C107 , B248) holds ((B251 is_homomorphism C107 , B248 & ( B251 ** C108 ) = B249) implies B250 = B251))))))) from ExFreeAlg2(L410 , L408 , L409);
L413: (for B252 being  non-empty MSAlgebra over F37() holds (for B253 being (ManySortedFunction of ( (the carrier of F37()) --> ( NAT ) ) , (the Sorts of B252)) holds (S6[ B252 ] implies (ex B254 being (ManySortedFunction of C107 , B252) st (B254 is_homomorphism C107 , B252 & B253 = ( B254 ** C108 ))))))
proof
let C109 being  non-empty MSAlgebra over F37();
let C110 being (ManySortedFunction of ( (the carrier of F37()) --> ( NAT ) ) , (the Sorts of C109));
assume L414: S6[ C109 ];
L415: (ex B255 being (ManySortedFunction of C107 , C109) st (B255 is_homomorphism C107 , C109 & ( B255 ** C108 ) = C110 & (for B256 being (ManySortedFunction of C107 , C109) holds ((B256 is_homomorphism C107 , C109 & ( B256 ** C108 ) = C110) implies B255 = B256)))) by L414 , L412;
thus L416: (ex B257 being (ManySortedFunction of C107 , C109) st (B257 is_homomorphism C107 , C109 & ( B257 ** C108 ) = C110)) by L415;
end;
L417: (for B258 being set holds (for B259 being (MSAlgebra-Family of B258 , F37()) holds ((for B260 being set holds (B260 in B258 implies (ex B261 being MSAlgebra over F37() st (B261 = ( B259 . B260 ) & P15[ B261 ])))) implies P15[ ( product B259 ) ]))) by L381;
take D68;
let C111 being  non-empty MSAlgebra over F37();
thus L418:now
assume L419: P15[ C111 ];
thus L420: C111 |= D68
proof
let C112 being (SortSymbol of F37());
L421: S5[ C112 , ( D68 . C112 ) ] by L387;
let C113 being (Element of ( ( Equations F37() ) . C112 ));
assume L422: C113 in ( D68 . C112 );
consider C114 being (Element of ( ( Equations F37() ) . C112 )) such that L423: C113 = C114 and L424: (for B262 being  non-empty MSAlgebra over F37() holds (P15[ B262 ] implies B262 |= C114)) by L422 , L421;
L425: C111 |= C114 by L419 , L424;
let C115 being (ManySortedFunction of ( TermAlg F37() ) , C111);
assume L426: C115 is_homomorphism ( TermAlg F37() ) , C111;
thus L427: thesis by L426 , L423 , L425 , EQUATION:def 5;
end;

end;
assume L421: C111 |= D68;
L422: (for B263 being  non-empty MSAlgebra over F37() holds (for B264 being (MSCongruence of B263) holds (P15[ B263 ] implies P15[ ( QuotMSAlg (B263 , B264) ) ]))) by L380;
L423: S6[ C107 ] by L411;
L424: P15[ C107 ] from FreeInModIsInVar(L396 , L412 , L423 , L395 , L382 , L417);
L425: (for B265 being  strict  non-empty  finitely-generated (MSSubAlgebra of C111) holds P15[ B265 ])
proof
let C116 being  strict  non-empty  finitely-generated (MSSubAlgebra of C111);
L426: S6[ C116 ] by L421 , EQUATION:32;
thus L427: P15[ C116 ] from FinGenAlgInVar(L426 , L424 , L413 , L395 , L422);
end;
thus L428: P15[ C111 ] from AllFinGen(L425 , L395 , L382 , L422 , L417);
end;
