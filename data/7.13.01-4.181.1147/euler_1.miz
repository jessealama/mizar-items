:: Euler's Function
::  by Yoshinori Fujisawa and Yasushi Fuwa
::
:: Received December 10, 1997
:: Copyright (c) 1997-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, NAT_1, INT_1, CARD_1, ARYTM_3, XXREAL_0, ARYTM_1,
      RELAT_1, INT_2, SUBSET_1, FINSET_1, XBOOLE_0, TARSKI, COMPLEX1, FUNCT_1,
      FUNCT_2, FINSEQ_1, NEWTON, ZFMISC_1, EULER_1;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, CARD_1, NUMBERS, XCMPLX_0,
      INT_1, ORDINAL1, NAT_1, NAT_D, INT_2, FINSEQ_1, FINSET_1, RELAT_1,
      FUNCT_1, FUNCT_2, BINOP_1, XXREAL_0, NEWTON;
 constructors BINOP_1, XXREAL_0, REAL_1, NAT_1, NAT_D, NEWTON, WELLORD2,
      RELSET_1;
 registrations SUBSET_1, ORDINAL1, RELSET_1, FINSET_1, XXREAL_0, XREAL_0,
      NAT_1, INT_1, CARD_1, FINSEQ_1, NEWTON;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, FUNCT_1, FUNCT_2, XBOOLE_0, BINOP_1;
 theorems TARSKI, INT_2, AXIOMS, FINSEQ_1, CARD_1, NAT_1, ABSVALUE, CARD_2,
      ZFMISC_1, INT_1, FUNCT_1, FUNCT_2, PRE_FF, DOMAIN_1, XBOOLE_0, XBOOLE_1,
      XCMPLX_1, NEWTON, XREAL_1, COMPLEX1, XXREAL_0, ORDINAL1, NAT_D, RELAT_1;
 schemes NAT_1, FUNCT_7;

begin
L1: (for R4 being Nat holds (for R9 being Integer holds ((R4 <> ( 0 ) & ( [\ ( R9 / R4 ) /] + 1 ) >= ( R9 / R4 )) implies R4 >= ( R9 - ( [\ ( R9 / R4 ) /] * R4 ) ))))
proof
let R4 being Nat;
let R9 being Integer;
assume that
L2: R4 <> ( 0 )
and
L3: ( [\ ( R9 / R4 ) /] + 1 ) >= ( R9 / R4 );
L4: ( ( [\ ( R9 / R4 ) /] + 1 ) + ( - 1 ) ) >= ( ( R9 / R4 ) + ( - 1 ) ) by L3 , XREAL_1:6;
L5: ( [\ ( R9 / R4 ) /] * R4 ) >= ( ( ( R9 / R4 ) - 1 ) * R4 ) by L4 , XREAL_1:64;
L6: ( - ( ( ( R9 / R4 ) - 1 ) * R4 ) ) >= ( - ( [\ ( R9 / R4 ) /] * R4 ) ) by L5 , XREAL_1:24;
L7: ( R9 + ( - ( ( ( R9 / R4 ) - 1 ) * R4 ) ) ) >= ( R9 + ( - ( [\ ( R9 / R4 ) /] * R4 ) ) ) by L6 , XREAL_1:6;
L8: ( R9 - ( ( ( R9 / R4 ) * R4 ) - ( 1 * R4 ) ) ) >= ( R9 - ( [\ ( R9 / R4 ) /] * R4 ) ) by L7;
L9: ( R9 - ( R9 - R4 ) ) >= ( R9 - ( [\ ( R9 / R4 ) /] * R4 ) ) by L8 , L2 , XCMPLX_1:87;
thus L10: thesis by L9;
end;
L11: (not 1 is  prime) by INT_2:def 4;
theorem
L12: (for R7 being Nat holds (R7 , R7 are_relative_prime  iff R7 = 1))
proof
let R7 being Nat;
L13: ( R7 gcd R7 ) = R7 by NAT_D:32;
thus L14: thesis by L13 , INT_2:def 3;
end;
theorem
L15: (for B1 , B2 being Nat holds ((B1 <> ( 0 ) & B1 < B2 & B2 is  prime) implies B1 , B2 are_relative_prime ))
proof
let C1 , C2 being Nat;
assume that
L16: (C1 <> ( 0 ) & C1 < C2)
and
L17: C2 is  prime;
L18: ( C1 gcd C2 ) divides C2 by NAT_D:def 5;
per cases  by L17 , L18 , INT_2:def 4;
suppose L19: ( C1 gcd C2 ) = 1;

thus L20: thesis by L19 , INT_2:def 3;
end;
suppose L21: ( C1 gcd C2 ) = C2;

L22: C2 divides C1 by L21 , NAT_D:def 5;
thus L23: thesis by L22 , L16 , NAT_D:7;
end;
end;
theorem
L25: (for R4 being Nat holds (for R7 being Nat holds ((R7 is  prime & R4 in { B3 where B3 is (Element of ( NAT )) : (R7 , B3 are_relative_prime  & B3 >= 1 & B3 <= R7) }) iff (R7 is  prime & R4 in R7 & (not R4 in { ( 0 ) })))))
proof
let R4 being Nat;
let R7 being Nat;
set D1 = { B4 where B4 is (Element of ( NAT )) : (R7 , B4 are_relative_prime  & B4 >= 1 & B4 <= R7) };
thus L26: ((R7 is  prime & R4 in D1) implies (R7 is  prime & R4 in R7 & (not R4 in { ( 0 ) })))
proof
assume that
L27: R7 is  prime
and
L28: R4 in D1;
L29: (ex B5 being (Element of ( NAT )) st (B5 = R4 & R7 , B5 are_relative_prime  & B5 >= 1 & B5 <= R7)) by L28;
L30: R4 <> R7 by L29 , L27 , L11 , L12;
L31: R4 < R7 by L30 , L29 , XXREAL_0:1;
thus L32: thesis by L31 , L27 , L29 , NAT_1:44 , TARSKI:def 1;
end;

assume that
L33: R7 is  prime
and
L34: R4 in R7
and
L35: (not R4 in { ( 0 ) });
L36: R4 <> ( 0 ) by L35 , TARSKI:def 1;
L37: R4 >= 1 by L36 , NAT_1:14;
L38: R4 < R7 by L34 , NAT_1:44;
L39: (R4 in ( NAT ) & R4 , R7 are_relative_prime ) by L38 , L33 , L36 , L15 , ORDINAL1:def 12;
thus L40: thesis by L39 , L33 , L38 , L37;
end;
theorem
L41: (for B6 being  finite set holds (for B7 being set holds (B7 in B6 implies ( card ( B6 \ { B7 } ) ) = ( ( card B6 ) - ( card { B7 } ) ))))
proof
let C3 being  finite set;
let C4 being set;
assume L42: C4 in C3;
L43: { C4 } c= C3 by L42 , ZFMISC_1:31;
thus L44: thesis by L43 , CARD_2:44;
end;
theorem
L45: (for R1 being Nat holds (for R2 being Nat holds (( R1 gcd R2 ) = 1 implies (for R3 being Nat holds ( ( R1 * R3 ) gcd ( R2 * R3 ) ) = R3))))
proof
let R1 being Nat;
let R2 being Nat;
assume L46: ( R1 gcd R2 ) = 1;
let R6 being Nat;
reconsider D2 = R1 , D3 = R2 as Integer;
L47: D2 , D3 are_relative_prime  by L46 , INT_2:def 3;
thus L48: ( ( R1 * R6 ) gcd ( R2 * R6 ) ) = ( abs ( abs R6 ) ) by L47 , INT_2:24
.= R6 by ABSVALUE:def 1;
end;
theorem
L49: (for R1 being Nat holds (for R2 being Nat holds (for R3 being Nat holds ((R1 <> ( 0 ) & R3 <> ( 0 ) & ( ( R1 * R3 ) gcd ( R2 * R3 ) ) = R3) implies R1 , R2 are_relative_prime ))))
proof
let R1 being Nat;
let R2 being Nat;
let R3 being Nat;
assume that
L50: R1 <> ( 0 )
and
L51: R3 <> ( 0 )
and
L52: ( ( R1 * R3 ) gcd ( R2 * R3 ) ) = R3;
L53: ( R1 * R3 ) <> ( ( 0 ) * R3 ) by L50 , L51 , XCMPLX_1:5;
consider C5 , C6 being Integer such that L54: ( R1 * R3 ) = ( ( ( R1 * R3 ) gcd ( R2 * R3 ) ) * C5 ) and L55: (( R2 * R3 ) = ( ( ( R1 * R3 ) gcd ( R2 * R3 ) ) * C6 ) & C5 , C6 are_relative_prime ) by L53 , INT_2:23;
L56: R1 = C5 by L51 , L52 , L54 , XCMPLX_1:5;
thus L57: thesis by L56 , L51 , L52 , L55 , XCMPLX_1:5;
end;
theorem
L58: (for R1 being Nat holds (for R2 being Nat holds (( R1 gcd R2 ) = 1 implies ( ( R1 + R2 ) gcd R2 ) = 1)))
proof
let R1 being Nat;
let R2 being Nat;
assume L59: ( R1 gcd R2 ) = 1;
set D4 = ( ( R1 + R2 ) gcd R2 );
L60: D4 divides R2 by NAT_D:def 5;
L61: D4 divides ( R1 + R2 ) by NAT_D:def 5;
L62: D4 divides R1 by L61 , L60 , NAT_D:10;
L63: D4 divides ( R1 gcd R2 ) by L62 , L60 , NEWTON:50;
L64: D4 <= ( 1 + ( 0 ) ) by L63 , L59 , NAT_D:7;
per cases  by L64 , NAT_1:9;
suppose L65: D4 = 1;

thus L66: thesis by L65;
end;
suppose L67: D4 = ( 0 );

L68: R2 = ( 0 ) by L67 , INT_2:5;
thus L69: thesis by L68 , L59;
end;
end;
theorem
L71: (for B8 , B9 , B10 being Nat holds ( ( B8 + ( B9 * B10 ) ) gcd B9 ) = ( B8 gcd B9 ))
proof
let C7 , C8 , C9 being Nat;
defpred S1[ Nat ] means ( ( C7 + ( C8 * $1 ) ) gcd C8 ) = ( C7 gcd C8 );
L72: (for B11 being Nat holds (S1[ B11 ] implies S1[ ( B11 + 1 ) ]))
proof
let C10 being Nat;
assume L73: ( ( C7 + ( C8 * C10 ) ) gcd C8 ) = ( C7 gcd C8 );
L74:
now
per cases ;
suppose L75: C8 = ( 0 );

thus L76: ( ( C7 + ( C8 * ( C10 + 1 ) ) ) gcd C8 ) = ( C7 gcd C8 ) by L75;
end;
suppose L77: C8 > ( 0 );

set D5 = ( C7 gcd C8 );
L78: ( C7 gcd C8 ) > ( 0 ) by L77 , NEWTON:58;
L79: ( C7 gcd C8 ) divides ( C7 + ( C8 * C10 ) ) by L73 , NAT_D:def 5;
L80: ( C7 + ( C8 * C10 ) ) = ( ( C7 gcd C8 ) * ( ( C7 + ( C8 * C10 ) ) div ( C7 gcd C8 ) ) ) by L79 , NAT_D:3;
L81:
now
per cases ;
suppose L82: ( C7 + ( C8 * C10 ) ) = ( 0 );

L83: ( C7 gcd C8 ) = ( ( 0 ) gcd C8 ) by L82 , NAT_1:7
.= C8 by NEWTON:52;
thus L84: ( ( C7 + ( C8 * ( C10 + 1 ) ) ) gcd C8 ) = ( C7 gcd C8 ) by L83 , L82 , NAT_D:32;
end;
suppose L85: ( C7 + ( C8 * C10 ) ) > ( 0 );

set D6 = ( C8 div ( C7 gcd C8 ) );
set D7 = ( ( C7 + ( C8 * C10 ) ) div ( C7 gcd C8 ) );
L86: ( ( C7 + ( C8 * C10 ) ) div ( C7 gcd C8 ) ) <> ( 0 ) by L80 , L85;
L87: ( C7 gcd C8 ) divides C8 by NAT_D:def 5;
L88: C8 = ( ( C7 gcd C8 ) * ( C8 div ( C7 gcd C8 ) ) ) by L87 , NAT_D:3;
L89: ( ( D7 * D5 ) gcd ( D6 * D5 ) ) = D5 by L88 , L73 , L79 , NAT_D:3;
L90: D7 , D6 are_relative_prime  by L89 , L78 , L86 , L49;
L91: ( D7 gcd D6 ) = 1 by L90 , INT_2:def 3;
L92: ( ( D7 + D6 ) gcd D6 ) = 1 by L91 , L58;
L93: ( ( C7 + ( C8 * ( C10 + 1 ) ) ) gcd C8 ) = ( ( ( C7 + ( C8 * C10 ) ) + C8 ) gcd C8 )
.= ( ( ( D5 * D7 ) + ( D5 * D6 ) ) gcd ( D5 * D6 ) ) by L79 , L88 , NAT_D:3
.= ( ( D5 * ( D7 + D6 ) ) gcd ( D5 * D6 ) )
.= ( C7 gcd C8 ) by L92 , L45;
thus L94: ( ( C7 + ( C8 * ( C10 + 1 ) ) ) gcd C8 ) = ( C7 gcd C8 ) by L93;
end;
end;
thus L96: ( ( C7 + ( C8 * ( C10 + 1 ) ) ) gcd C8 ) = ( C7 gcd C8 ) by L81;
end;
end;
thus L98: thesis by L74;
end;
L99: S1[ ( 0 ) ];
L100: (for B12 being Nat holds S1[ B12 ]) from NAT_1:sch 2(L99 , L72);
thus L101: thesis by L100;
end;
theorem
L102: (for R6 being Nat holds (for R7 being Nat holds (R6 , R7 are_relative_prime  implies (ex R4 being Nat st ((ex B13 , B14 being Integer st (R4 = ( ( B13 * R6 ) + ( B14 * R7 ) ) & R4 > ( 0 ))) & (for R5 being Nat holds ((ex B15 , B16 being Integer st (R5 = ( ( B15 * R6 ) + ( B16 * R7 ) ) & R5 > ( 0 ))) implies R4 <= R5)))))))
proof
let R6 being Nat;
let R7 being Nat;
defpred S2[ Nat ] means (ex B17 , B18 being Integer st ($1 = ( ( B17 * R6 ) + ( B18 * R7 ) ) & $1 > ( 0 )));
assume L103: R6 , R7 are_relative_prime ;
L104: (R6 > ( 0 ) or R7 > ( 0 ))
proof
assume L105: ((not R6 > ( 0 )) & (not R7 > ( 0 )));
L106: (R6 = ( 0 ) & R7 = ( 0 )) by L105;
L107: ( R6 gcd R7 ) <> 1 by L106 , NAT_D:32;
thus L108: contradiction by L107 , L103 , INT_2:def 3;
end;
L109: ( ( 1 * R6 ) + ( 1 * R7 ) ) > ( 0 ) by L104;
L110: (ex B19 being Nat st S2[ B19 ]) by L109;
consider C11 being Nat such that L111: S2[ C11 ] and L112: (for B20 being Nat holds (S2[ B20 ] implies C11 <= B20)) from NAT_1:sch 5(L110);
take C11;
thus L113: (ex B21 , B22 being Integer st (C11 = ( ( B21 * R6 ) + ( B22 * R7 ) ) & C11 > ( 0 ))) by L111;
let R5 being Nat;
thus L114: thesis by L112;
end;
theorem
L115: (for R6 being Nat holds (for R7 being Nat holds (R6 , R7 are_relative_prime  implies (for R4 being Nat holds (ex R8 being Integer st (ex R9 being Integer st ( ( R8 * R6 ) + ( R9 * R7 ) ) = R4))))))
proof
let R6 being Nat;
let R7 being Nat;
reconsider D8 = 1 , D9 = ( 0 ) as Integer;
assume L116: R6 , R7 are_relative_prime ;
consider R1 being Nat such that L117: (ex B23 , B24 being Integer st (R1 = ( ( B23 * R6 ) + ( B24 * R7 ) ) & R1 > ( 0 ))) and L118: (for R3 being Nat holds ((ex R8 being Integer st (ex R9 being Integer st (R3 = ( ( R8 * R6 ) + ( R9 * R7 ) ) & R3 > ( 0 )))) implies R1 <= R3)) by L116 , L102;
let R4 being Nat;
consider C12 , C13 being Integer such that L119: R1 = ( ( C12 * R6 ) + ( C13 * R7 ) ) and L120: R1 > ( 0 ) by L117;
L121: (for R3 being Nat holds ((ex R8 being Integer st (ex R9 being Integer st (R3 = ( ( R8 * R6 ) + ( R9 * R7 ) ) & R3 > ( 0 )))) implies ( R3 mod R1 ) = ( 0 )))
proof
let R2 being Nat;
assume L122: (ex R8 being Integer st (ex R9 being Integer st (R2 = ( ( R8 * R6 ) + ( R9 * R7 ) ) & R2 > ( 0 ))));
consider R8 being Integer, R9 being Integer such that L123: R2 = ( ( R8 * R6 ) + ( R9 * R7 ) ) and L124: R2 > ( 0 ) by L122;
set D10 = ( R9 - ( ( R2 div R1 ) * C13 ) );
set D11 = ( R8 - ( ( R2 div R1 ) * C12 ) );
L125: ( ( ( R2 mod R1 ) + ( R1 * ( R2 div R1 ) ) ) - ( R1 * ( R2 div R1 ) ) ) = ( R2 - ( R1 * ( R2 div R1 ) ) ) by L120 , NAT_D:2;
reconsider D12 = ( ( D11 * R6 ) + ( D10 * R7 ) ) as (Element of ( NAT )) by L125 , L119 , L123;
assume L126: ( R2 mod R1 ) <> ( 0 );
L127: D12 < R1 by L119 , L120 , L123 , L125 , NAT_D:1;
thus L128: contradiction by L127 , L118 , L119 , L126 , L123 , L125;
end;
L129: R1 divides R7
proof
per cases ;
suppose L130: R7 = ( 0 );

thus L131: thesis by L130 , NAT_D:6;
end;
suppose L132: R7 > ( 0 );

L133: ( ( D9 * R6 ) + ( D8 * R7 ) ) > ( 0 ) by L132;
L134: ( R7 mod R1 ) = ( 0 ) by L133 , L121;
L135: R7 = ( ( R1 * ( R7 div R1 ) ) + ( 0 ) ) by L134 , L117 , NAT_D:2;
thus L136: thesis by L135 , NAT_D:3;
end;
end;
L138: R1 divides R6
proof
per cases ;
suppose L139: R6 = ( 0 );

thus L140: thesis by L139 , NAT_D:6;
end;
suppose L141: R6 > ( 0 );

L142: ( ( D8 * R6 ) + ( D9 * R7 ) ) > ( 0 ) by L141;
L143: ( R6 mod R1 ) = ( 0 ) by L142 , L121;
L144: R6 = ( ( R1 * ( R6 div R1 ) ) + ( 0 ) ) by L143 , L117 , NAT_D:2;
thus L145: thesis by L144 , NAT_D:3;
end;
end;
L147: R1 divides ( R6 gcd R7 ) by L138 , L129 , NAT_D:def 5;
L148: R1 divides 1 by L147 , L116 , INT_2:def 3;
L149: (ex B25 being Nat st 1 = ( R1 * B25 )) by L148 , NAT_D:def 3;
L150: ( ( C12 * R6 ) + ( C13 * R7 ) ) = 1 by L149 , L119 , NAT_1:15;
L151: R4 = ( R4 * ( ( C12 * R6 ) + ( C13 * R7 ) ) ) by L150
.= ( ( ( R4 * C12 ) * R6 ) + ( R4 * ( C13 * R7 ) ) );
L152: R4 = ( ( ( R4 * C12 ) * R6 ) + ( ( R4 * C13 ) * R7 ) ) by L151;
thus L153: thesis by L152;
end;
theorem
L154: (for B26 being set holds (for B27 being non  empty set holds (for B28 being (Function of B26 , B27) holds (B28 is  bijective implies ( card B26 ) = ( card B27 )))))
proof
let C14 being set;
let C15 being non  empty set;
let C16 being (Function of C14 , C15);
assume L155: C16 is  bijective;
L156: C16 is  one-to-one  onto by L155 , FUNCT_2:def 4;
L157: C14 = ( dom C16 ) by FUNCT_2:def 1;
L158: C15 c= ( rng C16 ) by L156 , FUNCT_2:def 3;
L159: ( card C15 ) c= ( card C14 ) by L158 , L157 , CARD_1:12;
L160: ( rng C16 ) c= C15 by RELAT_1:def 19;
L161: ( card C14 ) c= ( card C15 ) by L160 , L157 , L156 , CARD_1:10;
thus L162: thesis by L161 , L159 , XBOOLE_0:def 10;
end;
theorem
L163: (for B29 , B30 , B31 being Integer holds ( ( B29 + ( B30 * B31 ) ) mod B31 ) = ( B29 mod B31 ))
proof
let C17 , C18 , C19 being Integer;
per cases ;
suppose L164: C19 <> ( 0 );

L165: ( ( C17 + ( C18 * C19 ) ) mod C19 ) = ( ( C17 + ( C18 * C19 ) ) - ( ( ( C17 + ( C18 * C19 ) ) div C19 ) * C19 ) ) by L164 , INT_1:def 10
.= ( ( C17 + ( C18 * C19 ) ) - ( [\ ( ( C17 + ( C18 * C19 ) ) / C19 ) /] * C19 ) ) by INT_1:def 9
.= ( ( C17 + ( C18 * C19 ) ) - ( [\ ( ( C17 / C19 ) + ( ( C18 * C19 ) / C19 ) ) /] * C19 ) ) by XCMPLX_1:62
.= ( ( C17 + ( C18 * C19 ) ) - ( [\ ( ( C17 / C19 ) + ( C18 / ( C19 / C19 ) ) ) /] * C19 ) ) by XCMPLX_1:77
.= ( ( C17 + ( C18 * C19 ) ) - ( [\ ( ( C17 / C19 ) + ( C18 / 1 ) ) /] * C19 ) ) by L164 , XCMPLX_1:60
.= ( ( C17 + ( C18 * C19 ) ) - ( ( [\ ( C17 / C19 ) /] + C18 ) * C19 ) ) by INT_1:28
.= ( C17 - ( [\ ( C17 / C19 ) /] * C19 ) )
.= ( C17 - ( ( C17 div C19 ) * C19 ) ) by INT_1:def 9
.= ( C17 mod C19 ) by L164 , INT_1:def 10;
thus L166: thesis by L165;
end;
suppose L167: C19 = ( 0 );

thus L168: thesis by L167;
end;
end;
theorem
L170: (for R1 being Nat holds (for R2 being Nat holds (for R3 being Nat holds ((R3 divides ( R1 * R2 ) & R1 , R3 are_relative_prime ) implies R3 divides R2))))
proof
let R1 being Nat;
let R2 being Nat;
let R3 being Nat;
assume that
L171: R3 divides ( R1 * R2 )
and
L172: R1 , R3 are_relative_prime ;
L173: R3 divides ( R3 * R2 ) by NAT_D:9;
L174: ( R1 gcd R3 ) = 1 by L172 , INT_2:def 3;
L175: ( ( R1 * R2 ) gcd ( R3 * R2 ) ) = R2 by L174 , L45;
thus L176: thesis by L175 , L171 , L173 , NEWTON:50;
end;
theorem
L177: (for R1 being Nat holds (for R2 being Nat holds (for R3 being Nat holds ((R1 <> ( 0 ) & R3 <> ( 0 ) & R1 , R3 are_relative_prime  & R2 , R3 are_relative_prime ) implies ( R1 * R2 ) , R3 are_relative_prime ))))
proof
let R1 being Nat;
let R2 being Nat;
let R3 being Nat;
assume that
L178: R1 <> ( 0 )
and
L179: R3 <> ( 0 )
and
L180: R1 , R3 are_relative_prime 
and
L181: R2 , R3 are_relative_prime ;
L182: ( R1 gcd R3 ) = 1 by L180 , INT_2:def 3;
L183: ( ( R1 * R2 ) gcd R3 ) divides R3 by NAT_D:def 5;
L184: ( ( ( R1 * R2 ) gcd R3 ) gcd R1 ) divides ( ( R1 * R2 ) gcd R3 ) by NAT_D:def 5;
L185: (( ( ( R1 * R2 ) gcd R3 ) gcd R1 ) divides R1 & ( ( ( R1 * R2 ) gcd R3 ) gcd R1 ) divides R3) by L184 , L183 , NAT_D:4 , NAT_D:def 5;
L186: ( ( ( R1 * R2 ) gcd R3 ) gcd R1 ) divides 1 by L185 , L182 , NEWTON:50;
L187: ( ( ( R1 * R2 ) gcd R3 ) gcd R1 ) <= ( ( 0 ) + 1 ) by L186 , NAT_D:7;
L188: ( ( ( R1 * R2 ) gcd R3 ) gcd R1 ) <> ( 0 ) by L178 , NEWTON:58;
L189: ( ( ( R1 * R2 ) gcd R3 ) gcd R1 ) = 1 by L188 , L187 , NAT_1:9;
L190: (( ( R1 * R2 ) gcd R3 ) divides ( R1 * R2 ) & R1 , ( ( R1 * R2 ) gcd R3 ) are_relative_prime ) by L189 , INT_2:def 3 , NAT_D:def 5;
L191: ( ( R1 * R2 ) gcd R3 ) divides R2 by L190 , L170;
L192: ( R2 gcd R3 ) = 1 by L181 , INT_2:def 3;
L193: ( ( R1 * R2 ) gcd R3 ) divides 1 by L192 , L183 , L191 , NEWTON:50;
L194: ( ( R1 * R2 ) gcd R3 ) <= ( ( 0 ) + 1 ) by L193 , NAT_D:7;
L195: ( ( R1 * R2 ) gcd R3 ) > ( 0 ) by L179 , NEWTON:58;
L196: ( ( R1 * R2 ) gcd R3 ) = 1 by L195 , L194 , NAT_1:9;
thus L197: thesis by L196 , INT_2:def 3;
end;
theorem
L198: (for R8 being Integer holds (for R10 being Integer holds (for R11 being Integer holds ((R10 <> ( 0 ) & R8 > ( 0 )) implies ( ( R8 * R10 ) gcd ( R8 * R11 ) ) = ( R8 * ( R10 gcd R11 ) )))))
proof
let R8 being Integer;
let R10 being Integer;
let R11 being Integer;
assume that
L199: R10 <> ( 0 )
and
L200: R8 > ( 0 );
consider C20 , C21 being Integer such that L201: (R10 = ( ( R10 gcd R11 ) * C20 ) & R11 = ( ( R10 gcd R11 ) * C21 )) and L202: C20 , C21 are_relative_prime  by L199 , INT_2:23;
L203: (( R8 * R10 ) = ( ( R8 * ( R10 gcd R11 ) ) * C20 ) & ( R8 * R11 ) = ( ( R8 * ( R10 gcd R11 ) ) * C21 )) by L201;
L204: ( ( R8 * R10 ) gcd ( R8 * R11 ) ) = ( abs ( R8 * ( R10 gcd R11 ) ) ) by L203 , L202 , INT_2:24
.= ( ( abs R8 ) * ( abs ( R10 gcd R11 ) ) ) by COMPLEX1:65;
L205: R8 = ( abs R8 ) by L200 , ABSVALUE:def 1;
thus L206: thesis by L205 , L204 , ABSVALUE:def 1;
end;
theorem
L207: (for R1 being Nat holds (for R2 being Nat holds (for R10 being Integer holds (R1 <> ( 0 ) implies ( ( R1 + ( R10 * R2 ) ) gcd R2 ) = ( R1 gcd R2 )))))
proof
let R1 being Nat;
let R2 being Nat;
let C22 being Integer;
set D13 = ( R1 gcd R2 );
L208: R2 = ( abs R2 ) by ABSVALUE:def 1;
assume L209: R1 <> ( 0 );
L210: (for B32 being Nat holds ((B32 divides ( abs ( R1 + ( C22 * R2 ) ) ) & B32 divides ( abs R2 )) implies B32 divides D13))
proof
let C23 being Nat;
assume that
L211: C23 divides ( abs ( R1 + ( C22 * R2 ) ) )
and
L212: C23 divides ( abs R2 );
consider C24 being Nat such that L213: R2 = ( C23 * C24 ) by L208 , L212 , NAT_D:def 3;
reconsider D14 = C23 as (Element of ( NAT )) by ORDINAL1:def 12;
L214:
now
per cases ;
suppose L215: ( R1 + ( C22 * R2 ) ) >= ( 0 );

L216: ( abs ( R1 + ( C22 * R2 ) ) ) = ( R1 + ( C22 * R2 ) ) by L215 , ABSVALUE:def 1;
consider C25 being Integer such that L217: ( R1 + ( C22 * R2 ) ) = ( D14 * C25 ) by L216 , L211 , INT_1:def 3;
L218: R1 = ( ( D14 * C25 ) - ( D14 * ( C22 * C24 ) ) ) by L213 , L217 , XCMPLX_1:26
.= ( D14 * ( C25 - ( C22 * C24 ) ) );
L219: ( C25 - ( C22 * C24 ) ) >= ( 0 ) by L218 , L209;
reconsider D15 = ( C25 - ( C22 * C24 ) ) as (Element of ( NAT )) by L219 , INT_1:3;
L220: R1 = ( D14 * D15 ) by L218;
thus L221: D14 divides R1 by L220 , NAT_D:def 3;
end;
suppose L222: ( R1 + ( C22 * R2 ) ) < ( 0 );

L223: ( abs ( R1 + ( C22 * R2 ) ) ) = ( - ( R1 + ( C22 * R2 ) ) ) by L222 , ABSVALUE:def 1;
consider C26 being Integer such that L224: ( - ( R1 + ( C22 * R2 ) ) ) = ( D14 * C26 ) by L223 , L211 , INT_1:def 3;
L225: R1 = ( ( - ( D14 * C26 ) ) - ( D14 * ( C22 * C24 ) ) ) by L213 , L224 , XCMPLX_1:26
.= ( D14 * ( ( - C26 ) - ( C22 * C24 ) ) );
L226: ( ( - C26 ) - ( C22 * C24 ) ) >= ( 0 ) by L225 , L209;
reconsider D16 = ( ( - C26 ) - ( C22 * C24 ) ) as (Element of ( NAT )) by L226 , INT_1:3;
L227: R1 = ( D14 * D16 ) by L225;
thus L228: D14 divides R1 by L227 , NAT_D:def 3;
end;
end;
thus L230: thesis by L214 , L208 , L212 , NEWTON:50;
end;
L231: D13 divides R1 by NAT_D:def 5;
L232: R1 = ( D13 * ( R1 div D13 ) ) by L231 , NAT_D:3;
L233: D13 divides R2 by NAT_D:def 5;
L234: R2 = ( D13 * ( R2 div D13 ) ) by L233 , NAT_D:3;
L235: D13 divides ( abs ( R1 + ( C22 * R2 ) ) )
proof
per cases ;
suppose L236: ( R1 + ( C22 * R2 ) ) < ( 0 );

L237: ( abs ( R1 + ( C22 * R2 ) ) ) = ( - ( R1 + ( C22 * R2 ) ) ) by L236 , ABSVALUE:def 1;
L238: ( - ( R1 + ( C22 * R2 ) ) ) = ( D13 * ( - ( ( R1 div D13 ) + ( C22 * ( R2 div D13 ) ) ) ) ) by L232 , L234;
thus L239: thesis by L238 , L237 , INT_1:def 3;
end;
suppose L240: ( R1 + ( C22 * R2 ) ) >= ( 0 );

L241: ( abs ( R1 + ( C22 * R2 ) ) ) = ( R1 + ( C22 * R2 ) ) by L240 , ABSVALUE:def 1;
L242: ( R1 + ( C22 * R2 ) ) = ( D13 * ( ( R1 div D13 ) + ( C22 * ( R2 div D13 ) ) ) ) by L232 , L234;
thus L243: thesis by L242 , L241 , INT_1:def 3;
end;
end;
L245: ( ( abs ( R1 + ( C22 * R2 ) ) ) gcd ( abs R2 ) ) = D13 by L235 , L208 , L233 , L210 , NAT_D:def 5;
thus L246: thesis by L245 , INT_2:34;
end;
begin
definition
let C27 being Nat;
func Euler C27 -> (Element of ( NAT )) equals 
( card { B33 where B33 is (Element of ( NAT )) : (C27 , B33 are_relative_prime  & B33 >= 1 & B33 <= C27) } );
coherence
proof
set D17 = { B34 where B34 is (Element of ( NAT )) : (C27 , B34 are_relative_prime  & B34 >= 1 & B34 <= C27) };
L247: D17 c= ( Seg C27 )
proof
let C28 being set;
assume L248: C28 in D17;
L249: (ex B35 being (Element of ( NAT )) st (B35 = C28 & C27 , B35 are_relative_prime  & B35 >= 1 & B35 <= C27)) by L248;
thus L250: thesis by L249 , FINSEQ_1:1;
end;
reconsider D18 = D17 as  finite set by L247;
L251: ( card D18 ) is (Element of ( NAT ));
thus L252: thesis by L251;
end;
end;
set D19 = { B36 where B36 is (Element of ( NAT )) : (1 , B36 are_relative_prime  & B36 >= 1 & B36 <= 1) };
L254: (for B37 being set holds (B37 in D19 iff B37 = 1))
proof
let C29 being set;
thus L255: (C29 in D19 implies C29 = 1)
proof
assume L256: C29 in D19;
L257: (ex B38 being (Element of ( NAT )) st (B38 = C29 & 1 , B38 are_relative_prime  & B38 >= 1 & B38 <= 1)) by L256;
thus L258: thesis by L257 , XXREAL_0:1;
end;

L259: ( 1 gcd 1 ) = 1 by NAT_D:32;
L260: 1 , 1 are_relative_prime  by L259 , INT_2:def 3;
thus L261: thesis by L260;
end;
L262: ( card { 1 } ) = ( Euler 1 ) by L254 , TARSKI:def 1;
theorem
L263: ( Euler 1 ) = 1 by L262 , CARD_1:30;
set D20 = { B39 where B39 is (Element of ( NAT )) : (2 , B39 are_relative_prime  & B39 >= 1 & B39 <= 2) };
L264: (for B40 being set holds (B40 in D20 iff B40 = 1))
proof
let C30 being set;
thus L265: (C30 in D20 implies C30 = 1)
proof
assume L266: C30 in D20;
consider C31 being (Element of ( NAT )) such that L267: (C31 = C30 & 2 , C31 are_relative_prime ) and L268: (C31 >= 1 & C31 <= 2) by L266;
L269: ( 2 gcd 2 ) = 2 by NAT_D:32;
L270: (C31 = 1 or C31 = 2) by L268 , NAT_1:26;
thus L271: thesis by L270 , L267 , L269 , INT_2:def 3;
end;

L272: ( 2 gcd 1 ) = 1 by NEWTON:51;
L273: 2 , 1 are_relative_prime  by L272 , INT_2:def 3;
thus L274: thesis by L273;
end;
L275: ( card { 1 } ) = ( Euler 2 ) by L264 , TARSKI:def 1;
theorem
L276: ( Euler 2 ) = 1 by L275 , CARD_1:30;
theorem
L277: (for R7 being Nat holds (R7 > 1 implies ( Euler R7 ) <= ( R7 - 1 )))
proof
let R7 being Nat;
set D21 = { B41 where B41 is (Element of ( NAT )) : (R7 , B41 are_relative_prime  & B41 >= 1 & B41 <= R7) };
L278: D21 c= ( Seg R7 )
proof
let C32 being set;
assume L279: C32 in D21;
L280: (ex B42 being (Element of ( NAT )) st (B42 = C32 & R7 , B42 are_relative_prime  & B42 >= 1 & B42 <= R7)) by L279;
thus L281: thesis by L280 , FINSEQ_1:1;
end;
reconsider D22 = D21 as  finite set by L278;
assume L282: R7 > 1;
L283: ( 0 ) in { B43 where B43 is (Element of ( NAT )) : B43 < R7 } by L282;
L284: ( 0 ) in R7 by L283 , AXIOMS:4;
L285: ( card ( R7 \ { ( 0 ) } ) ) = ( ( card R7 ) - ( card { ( 0 ) } ) ) by L284 , L41;
L286: D22 c= ( R7 \ { ( 0 ) } )
proof
let C33 being set;
assume L287: C33 in D22;
consider C34 being (Element of ( NAT )) such that L288: C34 = C33 and L289: R7 , C34 are_relative_prime  and L290: C34 >= 1 and L291: C34 <= R7 by L287;
L292: (not R7 , R7 are_relative_prime ) by L282 , L12;
L293: C34 < R7 by L292 , L289 , L291 , XXREAL_0:1;
L294: C34 in { B44 where B44 is (Element of ( NAT )) : B44 < R7 } by L293;
L295: C34 in R7 by L294 , AXIOMS:4;
L296: (not C34 in { ( 0 ) }) by L290 , TARSKI:def 1;
thus L297: thesis by L296 , L288 , L295 , XBOOLE_0:def 5;
end;
L298: (( card R7 ) = R7 & ( card { ( 0 ) } ) = 1) by CARD_1:30 , CARD_1:def 2;
thus L299: thesis by L298 , L286 , L285 , NAT_1:43;
end;
theorem
L300: (for R7 being Nat holds (R7 is  prime implies ( Euler R7 ) = ( R7 - 1 )))
proof
let R7 being Nat;
set D23 = { B45 where B45 is (Element of ( NAT )) : (R7 , B45 are_relative_prime  & B45 >= 1 & B45 <= R7) };
L301: D23 c= ( Seg R7 )
proof
let C35 being set;
assume L302: C35 in D23;
L303: (ex B46 being (Element of ( NAT )) st (B46 = C35 & R7 , B46 are_relative_prime  & B46 >= 1 & B46 <= R7)) by L302;
thus L304: thesis by L303 , FINSEQ_1:1;
end;
reconsider D24 = D23 as  finite set by L301;
assume L305: R7 is  prime;
L306: R7 <> ( 0 )
proof
assume L307: R7 = ( 0 );
L308: R7 in ( SetPrimenumber 2 ) by L307 , L305 , NEWTON:def 7;
thus L309: contradiction by L308;
end;
L310: ( 0 ) in { B47 where B47 is (Element of ( NAT )) : B47 < R7 } by L306;
L311: ( 0 ) in R7 by L310 , AXIOMS:4;
L312: ( R7 \ { ( 0 ) } ) c= D24
proof
let C36 being set;
assume L313: C36 in ( R7 \ { ( 0 ) } );
L314: C36 in R7 by L313;
L315: C36 in { B48 where B48 is (Element of ( NAT )) : B48 < R7 } by L314 , AXIOMS:4;
L316: (ex B49 being (Element of ( NAT )) st (B49 = C36 & B49 < R7)) by L315;
L317: (not C36 in { ( 0 ) }) by L313 , XBOOLE_0:def 5;
thus L318: thesis by L317 , L305 , L313 , L316 , L25;
end;
L319: ( card ( R7 \ { ( 0 ) } ) ) <= ( card D24 ) by L312 , NAT_1:43;
L320: ( Euler R7 ) <= ( R7 - 1 ) by L305 , L277 , INT_2:def 4;
L321: (( card R7 ) = R7 & ( card { ( 0 ) } ) = 1) by CARD_1:30 , CARD_1:def 2;
L322: ( R7 - 1 ) <= ( Euler R7 ) by L321 , L319 , L311 , L41;
thus L323: thesis by L322 , L320 , XXREAL_0:1;
end;
theorem
L324: (for R6 being Nat holds (for R7 being Nat holds ((R6 > 1 & R7 > 1 & R6 , R7 are_relative_prime ) implies ( Euler ( R6 * R7 ) ) = ( ( Euler R6 ) * ( Euler R7 ) ))))
proof
let R6 being Nat;
let R7 being Nat;
assume that
L325: R6 > 1
and
L326: R7 > 1
and
L327: R6 , R7 are_relative_prime ;
set D25 = { B50 where B50 is (Element of ( NAT )) : (( R6 * R7 ) , B50 are_relative_prime  & B50 >= 1 & B50 <= ( R6 * R7 )) };
set D26 = { B51 where B51 is (Element of ( NAT )) : (ex B52 , B53 being Integer st (B51 = ( ( ( R6 * B53 ) + ( R7 * B52 ) ) mod ( R6 * R7 ) ) & ( R6 * R7 ) , B51 are_relative_prime  & B53 <= R7 & B52 <= R6 & B51 >= ( 0 ))) };
L328: ( R6 * R7 ) <> ( 0 ) by L325 , L326 , XCMPLX_1:6;
L329: D26 c= ( ( Seg ( R6 * R7 ) ) \/ { ( 0 ) } )
proof
let C37 being set;
assume L330: C37 in D26;
consider C38 being (Element of ( NAT )) such that L331: C38 = C37 and L332: (ex B54 , B55 being Integer st (C38 = ( ( ( R6 * B55 ) + ( R7 * B54 ) ) mod ( R6 * R7 ) ) & ( R6 * R7 ) , C38 are_relative_prime  & B55 <= R7 & B54 <= R6 & C38 >= ( 0 ))) by L330;
consider C39 , C40 being Integer such that L333: C38 = ( ( ( R6 * C40 ) + ( R7 * C39 ) ) mod ( R6 * R7 ) ) and L334: ( R6 * R7 ) , C38 are_relative_prime  and L335: C40 <= R7 and L336: C39 <= R6 and L337: C38 >= ( 0 ) by L332;
per cases ;
suppose L338: C38 > ( 0 );

L339: ( ( ( R6 * C40 ) + ( R7 * C39 ) ) mod ( R6 * R7 ) ) <= ( R6 * R7 )
proof
set D27 = ( R6 * R7 );
set D28 = ( ( R6 * C40 ) + ( R7 * C39 ) );
L340: ( [\ ( D28 / D27 ) /] + 1 ) >= ( D28 / D27 ) by INT_1:29;
L341: ( ( ( R6 * C40 ) + ( R7 * C39 ) ) mod ( R6 * R7 ) ) = ( D28 - ( ( D28 div D27 ) * D27 ) ) by L328 , INT_1:def 10
.= ( D28 - ( [\ ( D28 / D27 ) /] * D27 ) ) by INT_1:def 9;
thus L342: thesis by L341 , L325 , L326 , L340 , L1 , XCMPLX_1:6;
end;
L343: C38 >= 1 by L338 , NAT_1:14;
L344: C37 in ( Seg ( R6 * R7 ) ) by L343 , L331 , L333 , L339 , FINSEQ_1:1;
thus L345: thesis by L344 , XBOOLE_0:def 3;
end;
suppose L346: C38 = ( 0 );

L347: ( 0 ) in { ( 0 ) } by TARSKI:def 1;
thus L348: thesis by L347 , L331 , L346 , XBOOLE_0:def 3;
end;
end;
reconsider D29 = D26 as  finite set by L329;
set D30 = { B56 where B56 is (Element of ( NAT )) : (R7 , B56 are_relative_prime  & B56 >= 1 & B56 <= R7) };
L350: D30 c= ( Seg R7 )
proof
let C41 being set;
assume L351: C41 in D30;
L352: (ex B57 being (Element of ( NAT )) st (B57 = C41 & R7 , B57 are_relative_prime  & B57 >= 1 & B57 <= R7)) by L351;
thus L353: thesis by L352 , FINSEQ_1:1;
end;
L354: (for R10 being Integer holds (for R11 being Integer holds ((R11 = 1 & R10 = 1) implies ( ( ( R6 * R11 ) + ( R7 * R10 ) ) mod ( R6 * R7 ) ) in D29)))
proof
let R10 being Integer;
let R11 being Integer;
L355: ( R6 gcd R7 ) = 1 by L327 , INT_2:def 3;
L356: ( ( R6 + R7 ) gcd R6 ) = 1 by L355 , L58;
L357: R6 , ( R6 + R7 ) are_relative_prime  by L356 , INT_2:def 3;
L358: ( ( R6 + R7 ) gcd R7 ) = 1 by L355 , L58;
L359: R7 , ( R6 + R7 ) are_relative_prime  by L358 , INT_2:def 3;
L360: ( R6 * R7 ) , ( R6 + R7 ) are_relative_prime  by L359 , L325 , L357 , L177;
L361: ( ( R6 * R7 ) gcd ( R6 + R7 ) ) = 1 by L360 , INT_2:def 3;
assume L362: (R11 = 1 & R10 = 1);
reconsider D31 = R11 , D32 = R10 as (Element of ( NAT )) by L362;
L363: ( ( ( R6 * D31 ) + ( R7 * D32 ) ) mod ( R6 * R7 ) ) = ( ( ( R6 * R11 ) + ( R7 * R10 ) ) mod ( R6 * R7 ) );
consider C42 being (Element of ( NAT )) such that L364: C42 = ( ( ( R6 * R11 ) + ( R7 * R10 ) ) mod ( R6 * R7 ) ) by L363;
L365: (ex B58 being Nat st (( R6 + R7 ) = ( ( ( R6 * R7 ) * B58 ) + ( ( R6 + R7 ) mod ( R6 * R7 ) ) ) & ( ( R6 + R7 ) mod ( R6 * R7 ) ) < ( R6 * R7 ))) by L328 , NAT_D:def 2;
L366: ( ( ( R6 + R7 ) mod ( R6 * R7 ) ) gcd ( R6 * R7 ) ) = 1 by L365 , L361 , L71;
L367: ( R6 * R7 ) , C42 are_relative_prime  by L366 , L362 , L364 , INT_2:def 3;
thus L368: thesis by L367 , L325 , L326 , L362 , L364;
end;
reconsider D33 = D30 as  finite set by L350;
L369: (for R1 being Nat holds (R1 = 1 implies R1 in D33))
proof
let R1 being Nat;
assume L370: R1 = 1;
L371: ( R7 gcd R1 ) = 1 by L370 , NEWTON:51;
L372: R7 , R1 are_relative_prime  by L371 , INT_2:def 3;
thus L373: thesis by L372 , L326 , L370;
end;
set D34 = { B59 where B59 is (Element of ( NAT )) : (R6 , B59 are_relative_prime  & B59 >= 1 & B59 <= R6) };
L374: D34 c= ( Seg R6 )
proof
let C43 being set;
assume L375: C43 in D34;
L376: (ex B60 being (Element of ( NAT )) st (B60 = C43 & R6 , B60 are_relative_prime  & B60 >= 1 & B60 <= R6)) by L375;
thus L377: thesis by L376 , FINSEQ_1:1;
end;
L378: ( R6 * R7 ) <> 1 by L325 , NAT_1:15;
L379: D29 = D25
proof
thus L380: D29 c= D25
proof
let C44 being set;
assume L381: C44 in D29;
consider C45 being (Element of ( NAT )) such that L382: C45 = C44 and L383: (ex B61 , B62 being Integer st (C45 = ( ( ( R6 * B62 ) + ( R7 * B61 ) ) mod ( R6 * R7 ) ) & ( R6 * R7 ) , C45 are_relative_prime  & B62 <= R7 & B61 <= R6 & C45 >= ( 0 ))) by L381;
consider C46 , C47 being Integer such that L384: C45 = ( ( ( R6 * C47 ) + ( R7 * C46 ) ) mod ( R6 * R7 ) ) and L385: ( R6 * R7 ) , C45 are_relative_prime  and L386: C47 <= R7 and L387: C46 <= R6 and L388: C45 >= ( 0 ) by L383;
L389: ( ( ( R6 * C47 ) + ( R7 * C46 ) ) mod ( R6 * R7 ) ) <= ( R6 * R7 )
proof
set D35 = ( R6 * R7 );
set D36 = ( ( R6 * C47 ) + ( R7 * C46 ) );
L390: ( [\ ( D36 / D35 ) /] + 1 ) >= ( D36 / D35 ) by INT_1:29;
L391: ( ( ( R6 * C47 ) + ( R7 * C46 ) ) mod ( R6 * R7 ) ) = ( D36 - ( ( D36 div D35 ) * D35 ) ) by L328 , INT_1:def 10
.= ( D36 - ( [\ ( D36 / D35 ) /] * D35 ) ) by INT_1:def 9;
thus L392: thesis by L391 , L325 , L326 , L390 , L1 , XCMPLX_1:6;
end;
per cases ;
suppose L393: C45 > ( 0 );

L394: C45 >= 1 by L393 , NAT_1:14;
thus L395: thesis by L394 , L382 , L384 , L385 , L389;
end;
suppose L396: C45 = ( 0 );

L397: ( ( R6 * R7 ) gcd ( 0 ) ) = 1 by L396 , L385 , INT_2:def 3;
thus L398: thesis by L397 , L378 , NEWTON:52;
end;
end;

let C48 being set;
assume L400: C48 in D25;
consider C49 being (Element of ( NAT )) such that L401: C49 = C48 and L402: ( R6 * R7 ) , C49 are_relative_prime  and L403: C49 >= 1 and L404: C49 <= ( R6 * R7 ) by L400;
L405: C49 <> ( R6 * R7 )
proof
assume L406: C49 = ( R6 * R7 );
L407: ( ( R6 * R7 ) gcd ( R6 * R7 ) ) = 1 by L406 , L402 , INT_2:def 3;
L408: ( R6 * R7 ) = 1 by L407 , NAT_D:32;
thus L409: contradiction by L408 , L325 , NAT_1:15;
end;
L410: C49 < ( R6 * R7 ) by L405 , L404 , XXREAL_0:1;
consider C50 , C51 being Integer such that L411: ( ( C50 * R6 ) + ( C51 * R7 ) ) = C49 by L327 , L115;
L412: ( ( ( R6 * C50 ) + ( R7 * C51 ) ) mod ( R6 * R7 ) ) = ( ( ( R6 * C50 ) + ( R7 * C51 ) ) - ( ( ( ( R6 * C50 ) + ( R7 * C51 ) ) div ( R6 * R7 ) ) * ( R6 * R7 ) ) ) by L328 , INT_1:def 10
.= ( ( ( R6 * C50 ) + ( R7 * C51 ) ) - ( ( 0 ) * ( R6 * R7 ) ) ) by L410 , L411 , PRE_FF:4
.= ( ( R6 * C50 ) + ( R7 * C51 ) );
set D37 = ( C50 div R7 );
set D38 = ( C51 div R6 );
consider C52 , C53 being Integer such that L413: C52 = ( C51 mod R6 ) and L414: C53 = ( C50 mod R7 );
L415: (( C51 mod R6 ) = ( C51 - ( ( C51 div R6 ) * R6 ) ) & ( C50 mod R7 ) = ( C50 - ( ( C50 div R7 ) * R7 ) )) by L325 , L326 , INT_1:def 10;
L416: ( ( R6 * C50 ) + ( R7 * C51 ) ) = ( ( ( R6 * C53 ) + ( R7 * C52 ) ) + ( ( R6 * R7 ) * ( D37 + D38 ) ) ) by L415 , L413 , L414;
L417: ( ( R6 * C50 ) + ( R7 * C51 ) ) = ( ( ( R6 * C53 ) + ( R7 * C52 ) ) mod ( R6 * R7 ) ) by L416 , L412 , L163;
L418: ( [\ ( C50 / R7 ) /] + 1 ) >= ( C50 / R7 ) by INT_1:29;
L419: ( [\ ( C51 / R6 ) /] + 1 ) >= ( C51 / R6 ) by INT_1:29;
L420: C53 = ( C50 - ( ( C50 div R7 ) * R7 ) ) by L326 , L414 , INT_1:def 10
.= ( C50 - ( [\ ( C50 / R7 ) /] * R7 ) ) by INT_1:def 9;
L421: C53 <= R7 by L420 , L326 , L418 , L1;
L422: C52 = ( C51 - ( ( C51 div R6 ) * R6 ) ) by L325 , L413 , INT_1:def 10
.= ( C51 - ( [\ ( C51 / R6 ) /] * R6 ) ) by INT_1:def 9;
L423: C52 <= R6 by L422 , L325 , L419 , L1;
thus L424: thesis by L423 , L401 , L402 , L411 , L421 , L417;
end;
reconsider D39 = D34 as  finite set by L374;
L425: (for R2 being Nat holds (R2 = 1 implies R2 in D39))
proof
let R2 being Nat;
assume L426: R2 = 1;
L427: ( R6 gcd R2 ) = 1 by L426 , NEWTON:51;
L428: R6 , R2 are_relative_prime  by L427 , INT_2:def 3;
thus L429: thesis by L428 , L325 , L426;
end;
L430: { ( 0 ) } c= ( NAT ) by ZFMISC_1:31;
L431: ( ( Seg ( R6 * R7 ) ) \/ { ( 0 ) } ) c= ( NAT ) by L430 , XBOOLE_1:8;
reconsider D40 = D33 , D41 = D39 , D42 = D29 as non  empty  finite (Subset of ( NAT )) by L431 , L350 , L374 , L329 , L369 , L425 , L354 , XBOOLE_1:1;
deffunc H1((Element of D40) , (Element of D41)) = ( ( ( R6 * $1 ) + ( R7 * $2 ) ) mod ( R6 * R7 ) );
L432: (for B63 being (Element of D40) holds (for B64 being (Element of D41) holds H1(B63 , B64) in D42))
proof
set D43 = ( R7 * R6 );
let C54 being (Element of D40);
let C55 being (Element of D41);
L433: C54 in D40;
consider C56 being (Element of ( NAT )) such that L434: C56 = C54 and L435: R7 , C56 are_relative_prime  and L436: C56 >= 1 and L437: C56 <= R7 by L433;
L438: C55 in D41;
consider C57 being (Element of ( NAT )) such that L439: C57 = C55 and L440: R6 , C57 are_relative_prime  and L441: C57 >= 1 and L442: C57 <= R6 by L438;
L443: ( C56 * R6 ) , R7 are_relative_prime  by L325 , L326 , L327 , L435 , L177;
L444: ( ( C56 * R6 ) gcd R7 ) = 1 by L443 , INT_2:def 3;
L445: ( ( ( R6 * C56 ) + ( R7 * C57 ) ) gcd R7 ) = 1 by L444 , L71;
L446: R7 , ( ( R6 * C56 ) + ( R7 * C57 ) ) are_relative_prime  by L445 , INT_2:def 3;
L447: ( C57 * R7 ) , R6 are_relative_prime  by L325 , L326 , L327 , L440 , L177;
L448: ( ( C57 * R7 ) gcd R6 ) = 1 by L447 , INT_2:def 3;
L449: ( ( ( R6 * C56 ) + ( R7 * C57 ) ) gcd R6 ) = 1 by L448 , L71;
L450: R6 , ( ( R6 * C56 ) + ( R7 * C57 ) ) are_relative_prime  by L449 , INT_2:def 3;
L451: ( C56 * R6 ) <> ( ( 0 ) * R6 ) by L325 , L436 , XCMPLX_1:5;
L452: ( R7 * R6 ) , ( ( R6 * C56 ) + ( R7 * C57 ) ) are_relative_prime  by L451 , L325 , L446 , L450 , L177;
L453: ( ( R7 * R6 ) gcd ( ( R6 * C56 ) + ( R7 * C57 ) ) ) = 1 by L452 , INT_2:def 3;
reconsider D44 = C56 , D45 = C57 as Integer;
L454: ( ( ( R6 * D44 ) + ( R7 * D45 ) ) mod ( R6 * R7 ) ) = ( ( ( R6 * C56 ) + ( R7 * C57 ) ) mod ( R6 * R7 ) );
consider C58 being (Element of ( NAT )) such that L455: C58 = ( ( ( R6 * D44 ) + ( R7 * D45 ) ) mod ( R6 * R7 ) ) by L454;
L456: (ex B65 being Nat st (( ( R6 * C56 ) + ( R7 * C57 ) ) = ( ( ( R7 * R6 ) * B65 ) + ( ( ( R6 * C56 ) + ( R7 * C57 ) ) mod ( R7 * R6 ) ) ) & ( ( ( R6 * C56 ) + ( R7 * C57 ) ) mod ( R7 * R6 ) ) < ( R7 * R6 ))) by L328 , NAT_D:def 2;
L457: ( ( ( ( R6 * C56 ) + ( R7 * C57 ) ) mod D43 ) gcd D43 ) = 1 by L456 , L453 , L71;
L458: D43 , C58 are_relative_prime  by L457 , L455 , INT_2:def 3;
thus L459: thesis by L458 , L434 , L437 , L439 , L442 , L455;
end;
consider C59 being (Function of [: D40 , D41 :] , D42) such that L460: (for B66 being (Element of D40) holds (for B67 being (Element of D41) holds ( C59 . (B66 , B67) ) = H1(B66 , B67))) from FUNCT_7:sch 1(L432);
L461: C59 is  onto
proof
thus L462: ( rng C59 ) c= D42 by RELAT_1:def 19;
let C60 being set;
assume L463: C60 in D42;
consider C61 being (Element of ( NAT )) such that L464: C61 = C60 and L465: (ex B68 , B69 being Integer st (C61 = ( ( ( R6 * B69 ) + ( R7 * B68 ) ) mod ( R6 * R7 ) ) & ( R6 * R7 ) , C61 are_relative_prime  & B69 <= R7 & B68 <= R6 & C61 >= ( 0 ))) by L463;
consider C62 , C63 being Integer such that L466: C61 = ( ( ( R6 * C63 ) + ( R7 * C62 ) ) mod ( R6 * R7 ) ) and L467: ( R6 * R7 ) , C61 are_relative_prime  and L468: C63 <= R7 and L469: C62 <= R6 and L470: C61 >= ( 0 ) by L465;
consider C64 , C65 being Integer such that L471: C64 = ( C62 mod R6 ) and L472: C65 = ( C63 mod R7 );
L473: C64 <= R6 by L325 , L471 , NEWTON:65;
L474: ( ( ( R6 * C65 ) + ( R7 * C64 ) ) mod ( R6 * R7 ) ) = ( ( ( R6 * C63 ) + ( R7 * C62 ) ) mod ( R6 * R7 ) )
proof
set D46 = ( C63 div R7 );
set D47 = ( C62 div R6 );
L475: (( C62 mod R6 ) = ( C62 - ( ( C62 div R6 ) * R6 ) ) & ( C63 mod R7 ) = ( C63 - ( ( C63 div R7 ) * R7 ) )) by L325 , L326 , INT_1:def 10;
L476: ( ( R6 * C63 ) + ( R7 * C62 ) ) = ( ( ( R6 * C65 ) + ( R7 * C64 ) ) + ( ( R6 * R7 ) * ( D46 + D47 ) ) ) by L475 , L471 , L472;
thus L477: thesis by L476 , L163;
end;
L478: C65 <= R7 by L326 , L472 , NEWTON:65;
reconsider D48 = C64 , D49 = C65 as (Element of ( NAT )) by L471 , L472 , INT_1:3 , NEWTON:64;
L479: D48 <> ( 0 )
proof
set D50 = ( C62 div R6 );
set D51 = ( ( C63 + ( R7 * D50 ) ) - ( R7 * ( ( R6 * ( C63 + ( R7 * D50 ) ) ) div ( R6 * R7 ) ) ) );
assume L480: D48 = ( 0 );
L481: ( C62 - ( ( C62 div R6 ) * R6 ) ) = ( 0 ) by L480 , L325 , L471 , INT_1:def 10;
L482: ( ( ( R6 * C63 ) + ( R7 * C62 ) ) mod ( R6 * R7 ) ) = ( ( R6 * ( C63 + ( R7 * D50 ) ) ) - ( ( ( R6 * ( C63 + ( R7 * D50 ) ) ) div ( R6 * R7 ) ) * ( R6 * R7 ) ) ) by L481 , L328 , INT_1:def 10
.= ( R6 * ( ( C63 + ( R7 * D50 ) ) - ( R7 * ( ( R6 * ( C63 + ( R7 * D50 ) ) ) div ( R6 * R7 ) ) ) ) );
reconsider D52 = ( R6 * D51 ) as (Element of ( NAT )) by L482 , L466;
L483: ( ( R6 * R7 ) gcd ( R6 * D51 ) ) = 1 by L466 , L467 , L482 , INT_2:def 3;
L484: (D52 > ( 0 ) or D52 = ( 0 ));
L485: (not D51 < ( 0 ))
proof
assume L486: D51 < ( 0 );
L487: ( R6 * D51 ) < ( ( 0 ) * D51 ) by L486 , L325 , XREAL_1:69;
thus L488: contradiction by L487 , L484;
end;
reconsider D53 = D51 as (Element of ( NAT )) by L485 , INT_1:3;
L489: D53 = ( 0 )
proof
assume L490: (not D53 = ( 0 ));
L491: ( R6 * ( R7 gcd D53 ) ) = 1 by L325 , L326 , L483 , L198;
thus L492: contradiction by L491 , L325 , NAT_1:15;
end;
L493: ( ( R6 * R7 ) gcd ( 0 ) ) = 1 by L489 , L466 , L467 , L482 , INT_2:def 3;
thus L494: contradiction by L493 , L378 , NEWTON:52;
end;
L495: D49 <> ( 0 )
proof
set D54 = ( C63 div R7 );
set D55 = ( ( ( R6 * D54 ) + C62 ) - ( R6 * ( ( R7 * ( ( R6 * D54 ) + C62 ) ) div ( R6 * R7 ) ) ) );
assume L496: D49 = ( 0 );
L497: ( C63 - ( ( C63 div R7 ) * R7 ) ) = ( 0 ) by L496 , L326 , L472 , INT_1:def 10;
L498: ( ( ( R6 * C63 ) + ( R7 * C62 ) ) mod ( R6 * R7 ) ) = ( ( R7 * ( ( R6 * D54 ) + C62 ) ) - ( ( ( R7 * ( ( R6 * D54 ) + C62 ) ) div ( R6 * R7 ) ) * ( R6 * R7 ) ) ) by L497 , L328 , INT_1:def 10
.= ( R7 * ( ( ( R6 * D54 ) + C62 ) - ( R6 * ( ( R7 * ( ( R6 * D54 ) + C62 ) ) div ( R6 * R7 ) ) ) ) );
reconsider D56 = ( R7 * D55 ) as (Element of ( NAT )) by L498 , L466;
L499: ( ( R6 * R7 ) gcd ( R7 * D55 ) ) = 1 by L466 , L467 , L498 , INT_2:def 3;
L500: (D56 > ( 0 ) or D56 = ( 0 ));
L501: (not D55 < ( 0 ))
proof
assume L502: D55 < ( 0 );
L503: ( R7 * D55 ) < ( ( 0 ) * D55 ) by L502 , L326 , XREAL_1:69;
thus L504: contradiction by L503 , L500;
end;
reconsider D57 = D55 as (Element of ( NAT )) by L501 , INT_1:3;
L505: D57 = ( 0 )
proof
assume L506: (not D57 = ( 0 ));
L507: ( R7 * ( R6 gcd D57 ) ) = 1 by L325 , L326 , L499 , L198;
thus L508: contradiction by L507 , L326 , NAT_1:15;
end;
L509: ( ( R6 * R7 ) gcd ( 0 ) ) = 1 by L505 , L466 , L467 , L498 , INT_2:def 3;
thus L510: contradiction by L509 , L378 , NEWTON:52;
end;
L511: R6 , C62 are_relative_prime 
proof
set D58 = ( R6 gcd C62 );
L512: D58 divides R6 by INT_2:21;
consider C66 being Integer such that L513: R6 = ( D58 * C66 ) by L512 , INT_1:def 3;
L514: D58 divides C62 by INT_2:21;
consider C67 being Integer such that L515: C62 = ( D58 * C67 ) by L514 , INT_1:def 3;
set D59 = ( C66 * R7 );
set D60 = ( ( ( ( D58 * C66 ) * C63 ) + ( R7 * ( D58 * C67 ) ) ) div ( ( D58 * C66 ) * R7 ) );
set D61 = ( ( ( C66 * C63 ) + ( R7 * C67 ) ) - ( ( C66 * D60 ) * R7 ) );
L516: D58 <> ( 0 ) by L325 , L513;
L517: ( ( ( R6 * C63 ) + ( R7 * C62 ) ) mod ( R6 * R7 ) ) = ( ( ( ( D58 * C66 ) * C63 ) + ( R7 * ( D58 * C67 ) ) ) - ( ( ( ( ( D58 * C66 ) * C63 ) + ( R7 * ( D58 * C67 ) ) ) div ( ( D58 * C66 ) * R7 ) ) * ( ( D58 * C66 ) * R7 ) ) ) by L328 , L513 , L515 , INT_1:def 10;
L518: ( ( ( ( D58 * C66 ) * C63 ) + ( R7 * ( D58 * C67 ) ) ) - ( D60 * ( ( D58 * C66 ) * R7 ) ) ) = ( D58 * ( ( ( C66 * C63 ) + ( R7 * C67 ) ) - ( ( C66 * D60 ) * R7 ) ) );
L519: (not D61 < ( 0 ))
proof
assume L520: D61 < ( 0 );
L521: ( D58 * D61 ) < ( ( 0 ) * D61 ) by L520 , L516 , XREAL_1:69;
thus L522: contradiction by L521 , L328 , L466 , L513 , L515 , L518 , INT_1:def 10;
end;
reconsider D62 = D58 , D63 = D61 as (Element of ( NAT )) by L519 , INT_1:3;
L523: (not D59 < ( 0 ))
proof
assume L524: D59 < ( 0 );
L525: ( D62 * D59 ) < ( ( 0 ) * D59 ) by L524 , L516 , XREAL_1:69;
thus L526: contradiction by L525 , L328 , L513;
end;
reconsider D64 = D59 as (Element of ( NAT )) by L523 , INT_1:3;
L527: ( R6 * R7 ) = ( D62 * ( C66 * R7 ) ) by L513;
L528:
now
per cases  by L325 , L326 , L527 , XCMPLX_1:6;
suppose L529: (D62 <> ( 0 ) & D64 <> ( 0 ) & D63 <> ( 0 ));

L530: ( ( D62 * D64 ) gcd ( D62 * D63 ) ) = 1 by L466 , L467 , L513 , L517 , INT_2:def 3;
L531: ( D62 * ( D64 gcd D63 ) ) = 1 by L530 , L529 , L198;
thus L532: D62 = 1 by L531 , NAT_1:15;
end;
suppose L533: (D62 <> ( 0 ) & D64 <> ( 0 ) & D63 = ( 0 ));

L534: ( ( D62 * D64 ) gcd ( 0 ) ) = 1 by L533 , L466 , L467 , L513 , L517 , L518 , INT_2:def 3;
L535: ( D62 * D64 ) = 1 by L534 , NEWTON:52;
thus L536: D62 = 1 by L535 , NAT_1:15;
end;
end;
thus L538: thesis by L528 , INT_2:def 3;
end;
L539: R7 , C63 are_relative_prime 
proof
set D65 = ( R7 gcd C63 );
L540: D65 divides R7 by INT_2:21;
consider C68 being Integer such that L541: R7 = ( D65 * C68 ) by L540 , INT_1:def 3;
L542: D65 divides C63 by INT_2:21;
consider C69 being Integer such that L543: C63 = ( D65 * C69 ) by L542 , INT_1:def 3;
set D66 = ( C68 * R6 );
set D67 = ( ( ( R6 * ( D65 * C69 ) ) + ( ( D65 * C68 ) * C62 ) ) div ( R6 * ( D65 * C68 ) ) );
set D68 = ( ( ( R6 * C69 ) + ( C68 * C62 ) ) - ( ( C68 * D67 ) * R6 ) );
L544: D65 <> ( 0 ) by L326 , L541;
L545: ( ( ( R6 * C63 ) + ( R7 * C62 ) ) mod ( R6 * R7 ) ) = ( ( ( R6 * ( D65 * C69 ) ) + ( ( D65 * C68 ) * C62 ) ) - ( ( ( ( R6 * ( D65 * C69 ) ) + ( ( D65 * C68 ) * C62 ) ) div ( R6 * ( D65 * C68 ) ) ) * ( R6 * ( D65 * C68 ) ) ) ) by L328 , L541 , L543 , INT_1:def 10;
L546: ( ( ( R6 * ( D65 * C69 ) ) + ( ( D65 * C68 ) * C62 ) ) - ( D67 * ( R6 * ( D65 * C68 ) ) ) ) = ( D65 * ( ( ( R6 * C69 ) + ( C68 * C62 ) ) - ( ( C68 * D67 ) * R6 ) ) );
L547: D68 >= ( 0 )
proof
assume L548: D68 < ( 0 );
L549: ( D65 * D68 ) < ( ( 0 ) * D68 ) by L548 , L544 , XREAL_1:69;
thus L550: contradiction by L549 , L328 , L466 , L541 , L543 , L546 , INT_1:def 10;
end;
reconsider D69 = D65 , D70 = D68 as (Element of ( NAT )) by L547 , INT_1:3;
L551: (not D66 < ( 0 ))
proof
assume L552: D66 < ( 0 );
L553: ( D69 * D66 ) < ( ( 0 ) * D66 ) by L552 , L544 , XREAL_1:69;
thus L554: contradiction by L553 , L328 , L541;
end;
reconsider D71 = D66 as (Element of ( NAT )) by L551 , INT_1:3;
L555: ( R6 * R7 ) = ( D69 * ( C68 * R6 ) ) by L541;
L556:
now
per cases  by L325 , L326 , L555 , XCMPLX_1:6;
suppose L557: (D69 <> ( 0 ) & D71 <> ( 0 ) & D70 <> ( 0 ));

L558: ( ( D69 * D71 ) gcd ( D69 * D70 ) ) = 1 by L466 , L467 , L541 , L545 , INT_2:def 3;
L559: ( D69 * ( D71 gcd D70 ) ) = 1 by L558 , L557 , L198;
thus L560: D69 = 1 by L559 , NAT_1:15;
end;
suppose L561: (D69 <> ( 0 ) & D71 <> ( 0 ) & D70 = ( 0 ));

L562: ( ( D69 * D71 ) gcd ( 0 ) ) = 1 by L561 , L466 , L467 , L541 , L545 , L546 , INT_2:def 3;
L563: ( D69 * D71 ) = 1 by L562 , NEWTON:52;
thus L564: D69 = 1 by L563 , NAT_1:15;
end;
end;
thus L566: thesis by L556 , INT_2:def 3;
end;
L567: ( C63 gcd R7 ) = 1 by L539 , INT_2:def 3;
L568: D48 = ( C62 - ( ( C62 div R6 ) * R6 ) ) by L325 , L471 , INT_1:def 10;
L569: ( C62 gcd R6 ) = ( ( D48 + ( ( C62 div R6 ) * R6 ) ) gcd R6 ) by L568;
L570: ( C62 gcd R6 ) = ( D48 gcd R6 ) by L569 , L479 , L207;
L571: ( R6 gcd D48 ) = 1 by L570 , L511 , INT_2:def 3;
L572: R6 , D48 are_relative_prime  by L571 , INT_2:def 3;
L573: D48 >= ( ( 0 ) + 1 ) by L479 , INT_1:7;
L574: D48 in D41 by L573 , L473 , L572;
L575: D49 = ( C63 - ( ( C63 div R7 ) * R7 ) ) by L326 , L472 , INT_1:def 10;
L576: ( C63 gcd R7 ) = ( ( D49 + ( ( C63 div R7 ) * R7 ) ) gcd R7 ) by L575;
L577: ( C63 gcd R7 ) = ( D49 gcd R7 ) by L576 , L495 , L207;
L578: R7 , D49 are_relative_prime  by L577 , L567 , INT_2:def 3;
L579: D49 >= ( ( 0 ) + 1 ) by L495 , INT_1:7;
L580: D49 in D40 by L579 , L478 , L578;
reconsider D72 = D49 as (Element of D40) by L580;
reconsider D73 = D48 as (Element of D41) by L574;
L581: C61 = ( C59 . (D72 , D73) ) by L460 , L466 , L474;
consider C70 being set such that L582: C70 = [ D72 , D73 ];
L583: ( dom C59 ) = [: D40 , D41 :] by FUNCT_2:def 1;
L584: C70 in ( dom C59 ) by L583 , L582 , ZFMISC_1:87;
thus L585: C60 in ( rng C59 ) by L584 , L464 , L582 , L581 , FUNCT_1:def 3;
end;
L586: ( R6 * R7 ) >= 1 by L325 , L326 , NAT_1:14 , XCMPLX_1:6;
L587: C59 is  one-to-one
proof
let C71 , C72 being set;
L588: ( dom C59 ) = [: D40 , D41 :] by FUNCT_2:def 1;
assume L589: C71 in ( dom C59 );
consider C73 being (Element of D40), C74 being (Element of D41) such that L590: C71 = [ C73 , C74 ] by L589 , L588 , DOMAIN_1:1;
assume L591: C72 in ( dom C59 );
consider C75 being (Element of D40), C76 being (Element of D41) such that L592: C72 = [ C75 , C76 ] by L591 , L588 , DOMAIN_1:1;
L593: C73 in D40;
consider C77 being (Element of ( NAT )) such that L594: C73 = C77 and L595: R7 , C77 are_relative_prime  and L596: C77 >= 1 and L597: C77 <= R7 by L593;
L598: C74 in D41;
consider C78 being (Element of ( NAT )) such that L599: C74 = C78 and L600: R6 , C78 are_relative_prime  and L601: C78 >= 1 and L602: C78 <= R6 by L598;
consider C79 being Integer such that L603: C79 = R6;
assume L604: ( C59 . C71 ) = ( C59 . C72 );
L605: C76 in D41;
consider C80 being (Element of ( NAT )) such that L606: C76 = C80 and L607: R6 , C80 are_relative_prime  and L608: C80 >= 1 and L609: C80 <= R6 by L605;
L610: C75 in D40;
consider C81 being (Element of ( NAT )) such that L611: C75 = C81 and L612: R7 , C81 are_relative_prime  and L613: C81 >= 1 and L614: C81 <= R7 by L610;
L615: ( ( ( C77 * R6 ) + ( C78 * R7 ) ) mod ( R6 * R7 ) ) = ( C59 . (C73 , C74) ) by L460 , L594 , L599
.= ( C59 . (C75 , C76) ) by L590 , L592 , L604
.= ( ( ( C81 * R6 ) + ( C80 * R7 ) ) mod ( R6 * R7 ) ) by L460 , L611 , L606;
reconsider D74 = C81 , D75 = C80 , D76 = C77 , D77 = C78 as (Element of ( NAT ));
set D78 = ( ( ( D76 * R6 ) + ( D77 * R7 ) ) mod ( R6 * R7 ) );
L616: (( ( ( D76 * R6 ) + ( D77 * R7 ) ) - ( ( D74 * R6 ) + ( D75 * R7 ) ) ) = ( ( R6 * ( D76 - D74 ) ) + ( R7 * ( D77 - D75 ) ) ) & ( ( D78 + ( ( ( ( D76 * R6 ) + ( D77 * R7 ) ) div ( R6 * R7 ) ) * ( R6 * R7 ) ) ) - ( D78 + ( ( ( ( D74 * R6 ) + ( D75 * R7 ) ) div ( R6 * R7 ) ) * ( R6 * R7 ) ) ) ) = ( ( R6 * R7 ) * ( ( ( ( D76 * R6 ) + ( D77 * R7 ) ) div ( R6 * R7 ) ) - ( ( ( D74 * R6 ) + ( D75 * R7 ) ) div ( R6 * R7 ) ) ) ));
set D79 = ( ( ( ( D76 * R6 ) + ( D77 * R7 ) ) div ( R6 * R7 ) ) - ( ( ( D74 * R6 ) + ( D75 * R7 ) ) div ( R6 * R7 ) ) );
L617: ( ( D74 * R6 ) + ( D75 * R7 ) ) = ( D78 + ( ( ( ( D74 * R6 ) + ( D75 * R7 ) ) div ( R6 * R7 ) ) * ( R6 * R7 ) ) ) by L586 , L615 , NAT_D:2;
L618: ( ( R6 * ( D76 - D74 ) ) + ( R7 * ( D77 - D75 ) ) ) = ( ( R6 * R7 ) * D79 ) by L617 , L586 , L616 , NAT_D:2;
L619: ( R7 * ( D77 - D75 ) ) = ( R6 * ( ( R7 * D79 ) - ( D76 - D74 ) ) ) by L618;
L620: C79 divides ( R7 * ( D77 - D75 ) ) by L619 , L603 , INT_1:def 3;
consider C82 being Integer such that L621: C82 = R7;
L622: ( R6 * ( D76 - D74 ) ) = ( R7 * ( ( R6 * D79 ) - ( D77 - D75 ) ) ) by L618;
L623: C82 divides ( R6 * ( D76 - D74 ) ) by L622 , L621 , INT_1:def 3;
L624: R7 divides ( D76 - D74 ) by L623 , L327 , L621 , INT_2:25;
L625: ( D76 - D74 ) = ( 0 )
proof
per cases ;
suppose L626: ( 0 ) <= ( D76 - D74 );

consider C83 being Integer such that L627: C83 = ( D76 - D74 );
reconsider D80 = C83 as (Element of ( NAT )) by L626 , L627 , INT_1:3;
L628: D80 = ( 0 )
proof
set D81 = ( R7 + ( - 1 ) );
L629: ( - D74 ) <= ( - 1 ) by L613 , XREAL_1:24;
L630: ( D76 + ( - D74 ) ) <= ( R7 + ( - 1 ) ) by L629 , L597 , XREAL_1:7;
L631: D81 is (Element of ( NAT )) by L630 , L626 , INT_1:3;
L632: D80 < ( D81 + 1 ) by L631 , L627 , L630 , NAT_1:13;
assume L633: D80 <> ( 0 );
thus L634: contradiction by L633 , L327 , L621 , L623 , L627 , L632 , INT_2:25 , NAT_D:7;
end;
thus L635: thesis by L628 , L627;
end;
suppose L636: ( D76 - D74 ) <= ( 0 );

consider C84 being Integer such that L637: C84 = ( - ( D76 - D74 ) );
L638: ( - ( 0 ) ) <= C84 by L636 , L637;
L639: R7 divides C84 by L624 , L637 , INT_2:10;
reconsider D82 = C84 as (Element of ( NAT )) by L636 , L637 , INT_1:3;
L640: D82 = ( 0 )
proof
set D83 = ( R7 + ( - 1 ) );
L641: ( - D76 ) <= ( - 1 ) by L596 , XREAL_1:24;
L642: ( ( - D76 ) + D74 ) <= ( R7 + ( - 1 ) ) by L641 , L614 , XREAL_1:7;
L643: D83 is (Element of ( NAT )) by L642 , L637 , L638 , INT_1:3;
L644: D82 < ( D83 + 1 ) by L643 , L637 , L642 , NAT_1:13;
assume L645: D82 <> ( 0 );
thus L646: contradiction by L645 , L639 , L644 , NAT_D:7;
end;
thus L647: thesis by L640 , L637;
end;
end;
L649: R6 divides ( D77 - D75 ) by L327 , L603 , L620 , INT_2:25;
L650: ( D77 - D75 ) = ( 0 )
proof
per cases ;
suppose L651: ( 0 ) <= ( D77 - D75 );

consider C85 being Integer such that L652: C85 = ( D77 - D75 );
reconsider D84 = C85 as (Element of ( NAT )) by L651 , L652 , INT_1:3;
L653: D84 = ( 0 )
proof
set D85 = ( R6 + ( - 1 ) );
L654: ( - D75 ) <= ( - 1 ) by L608 , XREAL_1:24;
L655: ( D77 + ( - D75 ) ) <= ( R6 + ( - 1 ) ) by L654 , L602 , XREAL_1:7;
L656: D85 is (Element of ( NAT )) by L655 , L651 , INT_1:3;
L657: D84 < ( D85 + 1 ) by L656 , L652 , L655 , NAT_1:13;
assume L658: D84 <> ( 0 );
thus L659: contradiction by L658 , L327 , L603 , L620 , L652 , L657 , INT_2:25 , NAT_D:7;
end;
thus L660: thesis by L653 , L652;
end;
suppose L661: ( D77 - D75 ) <= ( 0 );

consider C86 being Integer such that L662: C86 = ( - ( D77 - D75 ) );
L663: ( - ( 0 ) ) <= C86 by L661 , L662;
L664: R6 divides C86 by L649 , L662 , INT_2:10;
reconsider D86 = C86 as (Element of ( NAT )) by L661 , L662 , INT_1:3;
L665: D86 = ( 0 )
proof
set D87 = ( R6 + ( - 1 ) );
L666: ( - D77 ) <= ( - 1 ) by L601 , XREAL_1:24;
L667: ( ( - D77 ) + D75 ) <= ( R6 + ( - 1 ) ) by L666 , L609 , XREAL_1:7;
L668: D87 is (Element of ( NAT )) by L667 , L662 , L663 , INT_1:3;
L669: D86 < ( D87 + 1 ) by L668 , L662 , L667 , NAT_1:13;
assume L670: D86 <> ( 0 );
thus L671: contradiction by L670 , L664 , L669 , NAT_D:7;
end;
thus L672: thesis by L665 , L662;
end;
end;
thus L674: thesis by L650 , L590 , L594 , L599 , L592 , L611 , L606 , L625;
end;
L675: C59 is  bijective by L587 , L461 , FUNCT_2:def 4;
L676: ( card [: D40 , D41 :] ) = ( card D42 ) by L675 , L154;
thus L677: thesis by L676 , L379 , CARD_2:46;
end;
