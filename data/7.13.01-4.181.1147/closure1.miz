:: On the Many Sorted Closure Operator and the Many Sorted Closure
:: System
::  by Artur Korni{\l}owicz
::
:: Received February 7, 1996
:: Copyright (c) 1996-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies PBOOLE, FUNCT_1, RELAT_1, TARSKI, FUNCT_4, FUNCOP_1, XBOOLE_0,
      SUBSET_1, FINSEQ_4, PARTFUN1, FUNCT_6, MEMBER_1, MSUALG_3, FINSET_1,
      ZFMISC_1, RELAT_2, MSAFREE2, BINOP_1, YELLOW_6, STRUCT_0, MSUALG_1,
      CLOSURE2, MSSUBFAM, SETFAM_1, CLOSURE1;
 notations TARSKI, XBOOLE_0, SUBSET_1, STRUCT_0, SETFAM_1, RELAT_1, FUNCT_1,
      FINSET_1, PARTFUN1, FUNCT_2, FUNCOP_1, FUNCT_4, PBOOLE, FUNCT_6,
      MSUALG_1, MSUALG_3, PRALG_1, MSSUBFAM;
 constructors SETFAM_1, PZFMISC1, MSSUBFAM, PRALG_1, MSUALG_3, RELSET_1,
      FUNCT_4, FUNCT_6;
 registrations SUBSET_1, FUNCT_1, RELSET_1, FUNCOP_1, FINSET_1, PBOOLE,
      MSSUBFAM, MSUALG_1, RELAT_1, PRALG_1;
 requirements SUBSET, BOOLE;
 definitions XBOOLE_0, FUNCT_1, MSSUBFAM, MSUALG_1, MSUALG_3, PBOOLE, FINSET_1,
      TARSKI, FUNCOP_1;
 theorems FUNCOP_1, FUNCT_1, FUNCT_2, FUNCT_4, MBOOLEAN, MSSUBFAM, MSUALG_1,
      MSUALG_3, PBOOLE, PZFMISC1, TARSKI, ZFMISC_1, PRALG_1, XBOOLE_0,
      XBOOLE_1, PARTFUN1, RELAT_1;
 schemes MSSUBFAM, PBOOLE, XBOOLE_0;

begin
scheme MSSUBSET { F1() -> set , F2() ->  non-empty (ManySortedSet of F1()) , F3() -> (ManySortedSet of F1()) , P1[set] } : ((for B1 being (ManySortedSet of F1()) holds (B1 in F2() iff (B1 in F3() & P1[ B1 ]))) implies F2() c= F3())
proof
assume L1: (for B2 being (ManySortedSet of F1()) holds (B2 in F2() iff (B2 in F3() & P1[ B2 ])));
consider C1 being (ManySortedSet of F1()) such that L2: C1 in F2() by PBOOLE:134;
let R1 being set;
assume that
L3: R1 in F1();
let R2 being set;
assume that
L4: R2 in ( F2() . R1 );
L5: ( dom ( C1 +* ( R1 .--> R2 ) ) ) = F1() by L3 , PZFMISC1:1;
reconsider D1 = ( C1 +* ( R1 .--> R2 ) ) as (ManySortedSet of F1()) by L5 , PARTFUN1:def 2 , RELAT_1:def 18;
L6: ( dom ( R1 .--> R2 ) ) = { R1 } by FUNCOP_1:13;
L7: R1 in { R1 } by TARSKI:def 1;
L8: ( D1 . R1 ) = ( ( R1 .--> R2 ) . R1 ) by L7 , L6 , FUNCT_4:13
.= R2 by FUNCOP_1:72;
L9: D1 in F2()
proof
let C2 being set;
assume that
L10: C2 in F1();
per cases ;
suppose L11: C2 = R1;

thus L12: thesis by L11 , L4 , L8;
end;
suppose L13: C2 <> R1;

L14: (not C2 in ( dom ( R1 .--> R2 ) )) by L13 , L6 , TARSKI:def 1;
L15: ( D1 . C2 ) = ( C1 . C2 ) by L14 , FUNCT_4:11;
thus L16: thesis by L15 , L2 , L10 , PBOOLE:def 1;
end;
end;
L18: D1 in F3() by L9 , L1;
thus L19: thesis by L18 , L3 , L8 , PBOOLE:def 1;
end;
theorem
L20: (for B3 being non  empty set holds (for B4 , B5 being set holds (B4 c= B5 implies { B6 where B6 is (Element of B3) : B5 c= B6 } c= { B7 where B7 is (Element of B3) : B4 c= B7 })))
proof
let C3 being non  empty set;
let C4 , C5 being set;
assume that
L21: C4 c= C5;
let C6 being set;
assume L22: C6 in { B8 where B8 is (Element of C3) : C5 c= B8 };
L23: (ex B9 being (Element of C3) st (B9 = C6 & C5 c= B9)) by L22;
L24: C4 c= C6 by L23 , L21 , XBOOLE_1:1;
thus L25: thesis by L24 , L23;
end;
theorem
L26: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds ((ex R4 being (ManySortedSet of R3) st R4 in R5) implies R5 is  non-empty)))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
given R4 being (ManySortedSet of R3) such that
L27: R4 in R5;

let R1 being set;
assume L28: R1 in R3;
thus L29: thesis by L28 , L27 , PBOOLE:def 1;
end;
registration
let R3 being set;
let R7 being (ManySortedFunction of R3);
let R4 being (ManySortedSet of R3);
cluster ( R7 .. R4 ) ->  total for R3 -defined R3 -defined R3 -defined R3 -defined Function;
coherence;
end;
L31:
now
let R3 being set;
let C7 , C8 being  non-empty (ManySortedSet of R3);
let C9 being (ManySortedFunction of C7 , C8);
let C10 being (Element of C7);
thus L32: ( C9 .. C10 ) is (Element of C8)
proof
let R1 being set;
assume that
L33: R1 in R3;
reconsider D2 = ( C9 . R1 ) as Function;
L34: (D2 is (Function of ( C7 . R1 ) , ( C8 . R1 )) & ( C10 . R1 ) is (Element of ( C7 . R1 ))) by L33 , PBOOLE:def 14 , PBOOLE:def 15;
L35: (( dom C9 ) = R3 & ( D2 . ( C10 . R1 ) ) in ( C8 . R1 )) by L34 , L33 , FUNCT_2:5 , PARTFUN1:def 2;
thus L36: thesis by L35 , L33 , PRALG_1:def 17;
end;

end;
definition
let R3 being set;
let C11 , C12 being  non-empty (ManySortedSet of R3);
let C13 being (ManySortedFunction of C11 , C12);
let C14 being (Element of C11);
redefine func C13 .. C14 -> (Element of C12);

coherence by L31;
end;
theorem
L34: (for R3 being set holds (for B10 , B11 being (ManySortedSet of R3) holds (for B12 being  non-empty (ManySortedSet of R3) holds (for B13 being (ManySortedFunction of B10 , B12) holds (B11 in B10 implies ( B13 .. B11 ) in B12)))))
proof
let R3 being set;
let C15 , C16 being (ManySortedSet of R3);
let C17 being  non-empty (ManySortedSet of R3);
let C18 being (ManySortedFunction of C15 , C17);
assume that
L35: C16 in C15;
let C19 being set;
assume that
L36: C19 in R3;
reconsider D3 = ( C18 . C19 ) as Function;
L37: D3 is (Function of ( C15 . C19 ) , ( C17 . C19 )) by L36 , PBOOLE:def 15;
L38: ( C16 . C19 ) in ( C15 . C19 ) by L35 , L36 , PBOOLE:def 1;
L39: (( dom C18 ) = R3 & ( D3 . ( C16 . C19 ) ) in ( C17 . C19 )) by L38 , L36 , L37 , FUNCT_2:5 , PARTFUN1:def 2;
thus L40: thesis by L39 , L36 , PRALG_1:def 17;
end;
theorem
L41: (for R3 being set holds (for B14 , B15 being (ManySortedFunction of R3) holds (for B16 being (ManySortedSet of R3) holds (B16 in ( doms B15 ) implies ( B14 .. ( B15 .. B16 ) ) = ( ( B14 ** B15 ) .. B16 )))))
proof
let R3 being set;
let C20 , C21 being (ManySortedFunction of R3);
L42: ( dom C20 ) = R3 by PARTFUN1:def 2;
reconsider D4 = ( C20 ** C21 ) as (ManySortedFunction of R3) by MSSUBFAM:15;
L43: ( dom C21 ) = R3 by PARTFUN1:def 2;
L44: ( dom D4 ) = R3 by PARTFUN1:def 2;
let C22 being (ManySortedSet of R3);
assume that
L45: C22 in ( doms C21 );
L46:
now
let R1 being set;
reconsider D5 = ( C20 . R1 ) as Function;
reconsider D6 = ( C21 . R1 ) as Function;
reconsider D7 = ( ( C20 ** C21 ) . R1 ) as Function;
assume L47: R1 in R3;
L48: ( dom D6 ) = ( ( doms C21 ) . R1 ) by L47 , MSSUBFAM:14;
L49: ( C22 . R1 ) in ( dom D6 ) by L48 , L45 , L47 , PBOOLE:def 1;
L50: ( ( C21 .. C22 ) . R1 ) = ( D6 . ( C22 . R1 ) ) by L43 , L47 , PRALG_1:def 17;
thus L51: ( ( C20 .. ( C21 .. C22 ) ) . R1 ) = ( D5 . ( D6 . ( C22 . R1 ) ) ) by L50 , L42 , L47 , PRALG_1:def 17
.= ( ( D5 * D6 ) . ( C22 . R1 ) ) by L49 , FUNCT_1:13
.= ( D7 . ( C22 . R1 ) ) by L44 , L47 , PBOOLE:def 19
.= ( ( ( C20 ** C21 ) .. C22 ) . R1 ) by L44 , L47 , PRALG_1:def 17;
end;
L52: ( D4 .. C22 ) is (ManySortedSet of R3);
thus L53: thesis by L52 , L46 , PBOOLE:3;
end;
theorem
L54: (for R3 being set holds (for R7 being (ManySortedFunction of R3) holds (R7 is  "1-1" implies (for B17 , B18 being (ManySortedSet of R3) holds ((B17 in ( doms R7 ) & B18 in ( doms R7 ) & ( R7 .. B17 ) = ( R7 .. B18 )) implies B17 = B18)))))
proof
let R3 being set;
let R7 being (ManySortedFunction of R3);
assume L55: R7 is  "1-1";
let C23 , C24 being (ManySortedSet of R3);
assume that
L56: (C23 in ( doms R7 ) & C24 in ( doms R7 ))
and
L57: ( R7 .. C23 ) = ( R7 .. C24 );
L58:
now
let R1 being set;
assume that
L59: R1 in R3;
reconsider D8 = ( R7 . R1 ) as Function;
L60: D8 is  one-to-one by L55 , L59 , MSUALG_3:1;
L61: ( dom D8 ) = ( ( doms R7 ) . R1 ) by L59 , MSSUBFAM:14;
L62: (( C23 . R1 ) in ( dom D8 ) & ( C24 . R1 ) in ( dom D8 )) by L61 , L56 , L59 , PBOOLE:def 1;
L63: ( dom R7 ) = R3 by PARTFUN1:def 2;
L64: ( D8 . ( C23 . R1 ) ) = ( ( R7 .. C23 ) . R1 ) by L63 , L59 , PRALG_1:def 17
.= ( D8 . ( C24 . R1 ) ) by L57 , L59 , L63 , PRALG_1:def 17;
thus L65: ( C23 . R1 ) = ( C24 . R1 ) by L64 , L60 , L62 , FUNCT_1:def 4;
end;
thus L66: thesis by L58 , PBOOLE:3;
end;
theorem
L67: (for R3 being set holds (for R7 being (ManySortedFunction of R3) holds ((( doms R7 ) is  non-empty & (for B19 , B20 being (ManySortedSet of R3) holds ((B19 in ( doms R7 ) & B20 in ( doms R7 ) & ( R7 .. B19 ) = ( R7 .. B20 )) implies B19 = B20))) implies R7 is  "1-1")))
proof
let R3 being set;
let R7 being (ManySortedFunction of R3);
assume that
L68: ( doms R7 ) is  non-empty
and
L69: (for B21 , B22 being (ManySortedSet of R3) holds ((B21 in ( doms R7 ) & B22 in ( doms R7 ) & ( R7 .. B21 ) = ( R7 .. B22 )) implies B21 = B22));
consider C25 being (ManySortedSet of R3) such that L70: C25 in ( doms R7 ) by L68 , PBOOLE:134;
let C26 being set;
let C27 being Function;
assume that
L71: C26 in ( dom R7 )
and
L72: ( R7 . C26 ) = C27;
let C28 , C29 being set;
assume that
L73: C28 in ( dom C27 )
and
L74: C29 in ( dom C27 )
and
L75: ( C27 . C28 ) = ( C27 . C29 );
L76: ( dom R7 ) = R3 by PARTFUN1:def 2;
L77: ( dom ( C25 +* ( C26 .--> C28 ) ) ) = R3 by L76 , L71 , PZFMISC1:1;
reconsider D9 = ( C25 +* ( C26 .--> C28 ) ) as (ManySortedSet of R3) by L77 , PARTFUN1:def 2 , RELAT_1:def 18;
L78: ( dom ( C26 .--> C28 ) ) = { C26 } by FUNCOP_1:13;
L79: C26 in { C26 } by TARSKI:def 1;
L80: ( D9 . C26 ) = ( ( C26 .--> C28 ) . C26 ) by L79 , L78 , FUNCT_4:13
.= C28 by FUNCOP_1:72;
L81: D9 in ( doms R7 )
proof
let C30 being set;
assume that
L82: C30 in R3;
per cases ;
suppose L83: C30 = C26;

thus L84: thesis by L83 , L72 , L73 , L80 , L82 , MSSUBFAM:14;
end;
suppose L85: C30 <> C26;

L86: (not C30 in ( dom ( C26 .--> C28 ) )) by L85 , L78 , TARSKI:def 1;
L87: ( D9 . C30 ) = ( C25 . C30 ) by L86 , FUNCT_4:11;
thus L88: thesis by L87 , L70 , L82 , PBOOLE:def 1;
end;
end;
L90: ( dom ( C25 +* ( C26 .--> C29 ) ) ) = R3 by L71 , L76 , PZFMISC1:1;
reconsider D10 = ( C25 +* ( C26 .--> C29 ) ) as (ManySortedSet of R3) by L90 , PARTFUN1:def 2 , RELAT_1:def 18;
L91: ( dom ( C26 .--> C29 ) ) = { C26 } by FUNCOP_1:13;
L92: C26 in { C26 } by TARSKI:def 1;
L93: ( D10 . C26 ) = ( ( C26 .--> C29 ) . C26 ) by L92 , L91 , FUNCT_4:13
.= C29 by FUNCOP_1:72;
L94: D10 in ( doms R7 )
proof
let C31 being set;
assume that
L95: C31 in R3;
per cases ;
suppose L96: C31 = C26;

thus L97: thesis by L96 , L72 , L74 , L93 , L95 , MSSUBFAM:14;
end;
suppose L98: C31 <> C26;

L99: (not C31 in ( dom ( C26 .--> C29 ) )) by L98 , L91 , TARSKI:def 1;
L100: ( D10 . C31 ) = ( C25 . C31 ) by L99 , FUNCT_4:11;
thus L101: thesis by L100 , L70 , L95 , PBOOLE:def 1;
end;
end;
L103:
now
let C32 being set;
assume that
L104: C32 in R3;
per cases ;
suppose L105: C32 = C26;

thus L106: ( ( R7 .. D9 ) . C32 ) = ( C27 . ( D10 . C32 ) ) by L105 , L71 , L72 , L75 , L80 , L93 , PRALG_1:def 17
.= ( ( R7 .. D10 ) . C32 ) by L71 , L72 , L105 , PRALG_1:def 17;
end;
suppose L107: C32 <> C26;

L108: (not C32 in ( dom ( C26 .--> C29 ) )) by L107 , L91 , TARSKI:def 1;
L109: ( D10 . C32 ) = ( C25 . C32 ) by L108 , FUNCT_4:11;
reconsider D11 = ( R7 . C32 ) as Function;
L110: (not C32 in ( dom ( C26 .--> C28 ) )) by L78 , L107 , TARSKI:def 1;
thus L111: ( ( R7 .. D9 ) . C32 ) = ( D11 . ( D9 . C32 ) ) by L76 , L104 , PRALG_1:def 17
.= ( D11 . ( D10 . C32 ) ) by L110 , L109 , FUNCT_4:11
.= ( ( R7 .. D10 ) . C32 ) by L76 , L104 , PRALG_1:def 17;
end;
end;
thus L113: thesis by L103 , L69 , L80 , L93 , L81 , L94 , PBOOLE:3;
end;
theorem
L114: (for R3 being set holds (for B23 , B24 being  non-empty (ManySortedSet of R3) holds (for B25 , B26 being (ManySortedFunction of B23 , B24) holds ((for R5 being (ManySortedSet of R3) holds (R5 in B23 implies ( B25 .. R5 ) = ( B26 .. R5 ))) implies B25 = B26))))
proof
let R3 being set;
let C33 , C34 being  non-empty (ManySortedSet of R3);
let C35 , C36 being (ManySortedFunction of C33 , C34);
assume that
L115: (for R5 being (ManySortedSet of R3) holds (R5 in C33 implies ( C35 .. R5 ) = ( C36 .. R5 )));
L116:
now
let R1 being set;
assume L117: R1 in R3;
reconsider D12 = ( C35 . R1 ) as (Function of ( C33 . R1 ) , ( C34 . R1 )) by L117 , PBOOLE:def 15;
reconsider D13 = ( C36 . R1 ) as (Function of ( C33 . R1 ) , ( C34 . R1 )) by L117 , PBOOLE:def 15;
L118:
now
L119: ( dom C36 ) = R3 by PARTFUN1:def 2;
consider C37 being (ManySortedSet of R3) such that L120: C37 in C33 by PBOOLE:134;
let R2 being set;
assume that
L121: R2 in ( C33 . R1 );
L122: ( dom ( C37 +* ( R1 .--> R2 ) ) ) = R3 by L117 , PZFMISC1:1;
reconsider D14 = ( C37 +* ( R1 .--> R2 ) ) as (ManySortedSet of R3) by L122 , PARTFUN1:def 2 , RELAT_1:def 18;
L123: ( dom ( R1 .--> R2 ) ) = { R1 } by FUNCOP_1:13;
L124: R1 in { R1 } by TARSKI:def 1;
L125: ( D14 . R1 ) = ( ( R1 .--> R2 ) . R1 ) by L124 , L123 , FUNCT_4:13
.= R2 by FUNCOP_1:72;
L126: D14 in C33
proof
let C38 being set;
assume that
L127: C38 in R3;
per cases ;
suppose L128: C38 = R1;

thus L129: thesis by L128 , L121 , L125;
end;
suppose L130: C38 <> R1;

L131: (not C38 in ( dom ( R1 .--> R2 ) )) by L130 , L123 , TARSKI:def 1;
L132: ( D14 . C38 ) = ( C37 . C38 ) by L131 , FUNCT_4:11;
thus L133: thesis by L132 , L120 , L127 , PBOOLE:def 1;
end;
end;
L135: ( C35 .. D14 ) = ( C36 .. D14 ) by L126 , L115;
L136: ( dom C35 ) = R3 by PARTFUN1:def 2;
thus L137: ( D12 . R2 ) = ( ( C35 .. D14 ) . R1 ) by L136 , L117 , L125 , PRALG_1:def 17
.= ( D13 . R2 ) by L117 , L125 , L135 , L119 , PRALG_1:def 17;
end;
thus L138: ( C35 . R1 ) = ( C36 . R1 ) by L118 , FUNCT_2:12;
end;
thus L139: thesis by L116 , PBOOLE:3;
end;
registration
let R3 being set;
let R5 being (ManySortedSet of R3);
cluster  empty-yielding  finite-yielding for (Element of ( bool R5 ));
existence
proof
L140: ( [[0]] R3 ) c= R5 by MBOOLEAN:5;
L141: ( [[0]] R3 ) in ( bool R5 ) by L140 , MBOOLEAN:1;
reconsider D15 = ( [[0]] R3 ) as (Element of ( bool R5 )) by L141 , MSSUBFAM:11;
take D15;
thus L142: thesis;
end;
end;
begin
definition
let R3 being set;
let R5 being (ManySortedSet of R3);
mode MSSetOp of R5
 is (ManySortedFunction of ( bool R5 ) , ( bool R5 ));
end;
definition
let R3 being set;
let R5 being (ManySortedSet of R3);
let C39 being (MSSetOp of R5);
let C40 being (Element of ( bool R5 ));
redefine func C39 .. C40 -> (Element of ( bool R5 ));

coherence by L31;
end;
definition
let R3 being set;
let R5 being (ManySortedSet of R3);
let C41 being (MSSetOp of R5);
attr C41 is  reflexive
means
:L146: (for B27 being (Element of ( bool R5 )) holds B27 c= ( C41 .. B27 ));
attr C41 is  monotonic
means
:L147: (for B28 , B29 being (Element of ( bool R5 )) holds (B28 c= B29 implies ( C41 .. B28 ) c= ( C41 .. B29 )));
attr C41 is  idempotent
means
:L148: (for B30 being (Element of ( bool R5 )) holds ( C41 .. B30 ) = ( C41 .. ( C41 .. B30 ) ));
attr C41 is  topological
means
:L149: (for B31 , B32 being (Element of ( bool R5 )) holds ( C41 .. ( B31 \/ B32 ) ) = ( ( C41 .. B31 ) \/ ( C41 .. B32 ) ));
end;
theorem
L151: (for R3 being set holds (for B33 being  non-empty (ManySortedSet of R3) holds (for B34 being (Element of B33) holds B34 = ( ( id B33 ) .. B34 ))))
proof
let R3 being set;
let C42 being  non-empty (ManySortedSet of R3);
let C43 being (Element of C42);
set D16 = ( id C42 );
L152: ( dom D16 ) = R3 by PARTFUN1:def 2;
L153:
now
let R1 being set;
reconsider D17 = ( D16 . R1 ) as Function;
assume L154: R1 in R3;
L155: (( C43 . R1 ) is (Element of ( C42 . R1 )) & ( D16 . R1 ) = ( id ( C42 . R1 ) )) by L154 , MSUALG_3:def 1 , PBOOLE:def 14;
L156: ( D17 . ( C43 . R1 ) ) = ( C43 . R1 ) by L155 , L154 , FUNCT_1:18;
thus L157: ( C43 . R1 ) = ( ( D16 .. C43 ) . R1 ) by L156 , L152 , L154 , PRALG_1:def 17;
end;
thus L158: thesis by L153 , PBOOLE:3;
end;
theorem
L159: (for R3 being set holds (for B35 being  non-empty (ManySortedSet of R3) holds (for B36 , B37 being (Element of B35) holds (B36 c= B37 implies ( ( id B35 ) .. B36 ) c= ( ( id B35 ) .. B37 )))))
proof
let R3 being set;
let C44 being  non-empty (ManySortedSet of R3);
let C45 , C46 being (Element of C44);
assume that
L160: C45 c= C46;
L161: ( ( id C44 ) .. C45 ) = C45 by L151;
thus L162: thesis by L161 , L160 , L151;
end;
theorem
L163: (for R3 being set holds (for B38 being  non-empty (ManySortedSet of R3) holds (for B39 , B40 being (Element of B38) holds (( B39 \/ B40 ) is (Element of B38) implies ( ( id B38 ) .. ( B39 \/ B40 ) ) = ( ( ( id B38 ) .. B39 ) \/ ( ( id B38 ) .. B40 ) )))))
proof
let R3 being set;
let C47 being  non-empty (ManySortedSet of R3);
let C48 , C49 being (Element of C47);
set D18 = ( id C47 );
assume L164: ( C48 \/ C49 ) is (Element of C47);
thus L165: ( D18 .. ( C48 \/ C49 ) ) = ( C48 \/ C49 ) by L164 , L151
.= ( ( D18 .. C48 ) \/ C49 ) by L151
.= ( ( D18 .. C48 ) \/ ( D18 .. C49 ) ) by L151;
end;
theorem
L166: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for B41 being (Element of ( bool R5 )) holds (for B42 , B43 being set holds ((B42 in R3 & B43 in ( ( ( id ( bool R5 ) ) .. B41 ) . B42 )) implies (ex B44 being  finite-yielding (Element of ( bool R5 )) st (B44 c= B41 & B43 in ( ( ( id ( bool R5 ) ) .. B44 ) . B42 ))))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let C50 being (Element of ( bool R5 ));
let C51 , C52 being set;
assume that
L167: C51 in R3
and
L168: C52 in ( ( ( id ( bool R5 ) ) .. C50 ) . C51 );
L169: C52 in ( C50 . C51 ) by L168 , L151;
set D19 = ( ( R3 --> ( {} ) ) +* ( C51 .--> { C52 } ) );
L170: ( dom D19 ) = R3 by L167 , PZFMISC1:1;
reconsider D20 = D19 as (ManySortedSet of R3) by L170 , PARTFUN1:def 2 , RELAT_1:def 18;
L171: ( dom ( C51 .--> { C52 } ) ) = { C51 } by FUNCOP_1:13;
L172: C51 in { C51 } by TARSKI:def 1;
L173: ( D20 . C51 ) = ( ( C51 .--> { C52 } ) . C51 ) by L172 , L171 , FUNCT_4:13
.= { C52 } by FUNCOP_1:72;
L174: C50 in ( bool R5 ) by MSSUBFAM:12;
L175: C50 c= R5 by L174 , MBOOLEAN:18;
L176: ( C50 . C51 ) c= ( R5 . C51 ) by L175 , L167 , PBOOLE:def 2;
L177: D20 is (Element of ( bool R5 ))
proof
let C53 being set;
assume that
L178: C53 in R3;
L179:
now
per cases ;
case L180: C53 = C51;
L181: { C52 } c= ( R5 . C53 ) by L180 , L169 , L176 , ZFMISC_1:31;
thus L182: thesis by L181 , L173 , L178 , L180 , MBOOLEAN:def 1;
end;
case L183: C53 <> C51;
L184: (not C53 in ( dom ( C51 .--> { C52 } ) )) by L183 , L171 , TARSKI:def 1;
L185: ( D20 . C53 ) = ( ( R3 --> ( {} ) ) . C53 ) by L184 , FUNCT_4:11;
L186: ( D20 . C53 ) = ( {} ) by L185 , L178 , FUNCOP_1:7;
L187: ( D20 . C53 ) c= ( R5 . C53 ) by L186 , XBOOLE_1:2;
thus L188: thesis by L187 , L178 , MBOOLEAN:def 1;
end;
end;
thus L190: thesis by L179;
end;
reconsider D21 = D20 as (Element of ( bool R5 )) by L177;
L191: D21 is  finite-yielding
proof
let C54 being set;
assume that
L192: C54 in R3;
L193:
now
per cases ;
case L194: C54 = C51;
thus L195: thesis by L194 , L173;
end;
case L196: C54 <> C51;
L197: (not C54 in ( dom ( C51 .--> { C52 } ) )) by L196 , L171 , TARSKI:def 1;
L198: ( D21 . C54 ) = ( ( R3 --> ( {} ) ) . C54 ) by L197 , FUNCT_4:11;
thus L199: thesis by L198 , L192 , FUNCOP_1:7;
end;
end;
thus L201: thesis by L193;
end;
reconsider D22 = D21 as  finite-yielding (Element of ( bool R5 )) by L191;
take D22;
thus L202: D22 c= C50
proof
let C55 being set;
assume that
L203: C55 in R3;
L204:
now
per cases ;
case L205: C55 = C51;
thus L206: thesis by L205 , L169 , L173 , ZFMISC_1:31;
end;
case L207: C55 <> C51;
L208: (not C55 in ( dom ( C51 .--> { C52 } ) )) by L207 , L171 , TARSKI:def 1;
L209: ( D22 . C55 ) = ( ( R3 --> ( {} ) ) . C55 ) by L208 , FUNCT_4:11;
L210: ( D22 . C55 ) = ( {} ) by L209 , L203 , FUNCOP_1:7;
thus L211: thesis by L210 , XBOOLE_1:2;
end;
end;
thus L213: thesis by L204;
end;

L214: C52 in ( D22 . C51 ) by L173 , TARSKI:def 1;
thus L215: thesis by L214 , L151;
end;
registration
let R3 being set;
let R5 being (ManySortedSet of R3);
cluster  reflexive  monotonic  idempotent  topological for (MSSetOp of R5);
existence
proof
reconsider D23 = ( id ( bool R5 ) ) as (MSSetOp of R5);
take D23;
thus L216: D23 is  reflexive
proof
let C56 being (Element of ( bool R5 ));
thus L217: thesis by L151;
end;

thus L218: D23 is  monotonic
proof
let C57 , C58 being (Element of ( bool R5 ));
assume L219: C57 c= C58;
thus L220: thesis by L219 , L159;
end;

thus L221: D23 is  idempotent
proof
let C59 being (Element of ( bool R5 ));
thus L222: thesis by L151;
end;

thus L223: D23 is  topological
proof
let C60 , C61 being (Element of ( bool R5 ));
L224: C61 in ( bool R5 ) by MSSUBFAM:12;
L225: C61 c= R5 by L224 , MBOOLEAN:1;
L226: C60 in ( bool R5 ) by MSSUBFAM:12;
L227: C60 c= R5 by L226 , MBOOLEAN:1;
L228: ( C60 \/ C61 ) c= R5 by L227 , L225 , PBOOLE:16;
L229: ( C60 \/ C61 ) in ( bool R5 ) by L228 , MBOOLEAN:1;
L230: ( C60 \/ C61 ) is (Element of ( bool R5 )) by L229 , MSSUBFAM:11;
thus L231: thesis by L230 , L163;
end;

end;
end;
theorem
L225: (for R3 being set holds (for R4 being (ManySortedSet of R3) holds ( id ( bool R4 ) ) is  reflexive  reflexive  reflexive  reflexive (MSSetOp of R4)))
proof
let R3 being set;
let R4 being (ManySortedSet of R3);
reconsider D24 = ( id ( bool R4 ) ) as (MSSetOp of R4);
L226: D24 is  reflexive
proof
let C62 being (Element of ( bool R4 ));
thus L227: thesis by L151;
end;
thus L228: thesis by L226;
end;
theorem
L229: (for R3 being set holds (for R4 being (ManySortedSet of R3) holds ( id ( bool R4 ) ) is  monotonic  monotonic  monotonic  monotonic (MSSetOp of R4)))
proof
let R3 being set;
let R4 being (ManySortedSet of R3);
reconsider D25 = ( id ( bool R4 ) ) as (MSSetOp of R4);
L230: D25 is  monotonic
proof
let C63 , C64 being (Element of ( bool R4 ));
assume L231: C63 c= C64;
thus L232: thesis by L231 , L159;
end;
thus L233: thesis by L230;
end;
theorem
L234: (for R3 being set holds (for R4 being (ManySortedSet of R3) holds ( id ( bool R4 ) ) is  idempotent  idempotent  idempotent  idempotent (MSSetOp of R4)))
proof
let R3 being set;
let R4 being (ManySortedSet of R3);
reconsider D26 = ( id ( bool R4 ) ) as (MSSetOp of R4);
L235: D26 is  idempotent
proof
let C65 being (Element of ( bool R4 ));
thus L236: thesis by L151;
end;
thus L237: thesis by L235;
end;
theorem
L238: (for R3 being set holds (for R4 being (ManySortedSet of R3) holds ( id ( bool R4 ) ) is  topological  topological  topological  topological (MSSetOp of R4)))
proof
let R3 being set;
let R4 being (ManySortedSet of R3);
reconsider D27 = ( id ( bool R4 ) ) as (MSSetOp of R4);
L239: D27 is  topological
proof
let C66 , C67 being (Element of ( bool R4 ));
L240: C67 in ( bool R4 ) by MSSUBFAM:12;
L241: C67 c= R4 by L240 , MBOOLEAN:1;
L242: C66 in ( bool R4 ) by MSSUBFAM:12;
L243: C66 c= R4 by L242 , MBOOLEAN:1;
L244: ( C66 \/ C67 ) c= R4 by L243 , L241 , PBOOLE:16;
L245: ( C66 \/ C67 ) in ( bool R4 ) by L244 , MBOOLEAN:1;
L246: ( C66 \/ C67 ) is (Element of ( bool R4 )) by L245 , MSSUBFAM:11;
thus L247: thesis by L246 , L163;
end;
thus L248: thesis by L239;
end;
theorem
L249: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R8 being (MSSetOp of R5) holds (for R10 being (Element of ( bool R5 )) holds ((R10 = R5 & R8 is  reflexive) implies R10 = ( R8 .. R10 ))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let R8 being (MSSetOp of R5);
let R10 being (Element of ( bool R5 ));
assume L250: R10 = R5;
assume L251: R8 is  reflexive;
L252: R10 c= ( R8 .. R10 ) by L251 , L146;
L253: ( R8 .. R10 ) in ( bool R10 ) by L250 , MSSUBFAM:12;
L254: ( R8 .. R10 ) c= R10 by L253 , MBOOLEAN:18;
thus L255: thesis by L254 , L252 , PBOOLE:146;
end;
theorem
L256: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R8 being (MSSetOp of R5) holds ((R8 is  reflexive & (for B45 being (Element of ( bool R5 )) holds ( R8 .. B45 ) c= B45)) implies R8 is  idempotent))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let R8 being (MSSetOp of R5);
assume that
L257: R8 is  reflexive
and
L258: (for B46 being (Element of ( bool R5 )) holds ( R8 .. B46 ) c= B46);
let C68 being (Element of ( bool R5 ));
L259: ( R8 .. C68 ) c= ( R8 .. ( R8 .. C68 ) ) by L257 , L146;
L260: ( R8 .. ( R8 .. C68 ) ) c= ( R8 .. C68 ) by L258;
thus L261: thesis by L260 , L259 , PBOOLE:146;
end;
theorem
L262: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R8 being (MSSetOp of R5) holds (for R10 being (Element of ( bool R5 )) holds (for R11 being (Element of ( bool R5 )) holds (R8 is  monotonic implies ( R8 .. ( R10 /\ R11 ) ) c= ( ( R8 .. R10 ) /\ ( R8 .. R11 ) )))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let R8 being (MSSetOp of R5);
let R10 being (Element of ( bool R5 ));
let R11 being (Element of ( bool R5 ));
assume L263: R8 is  monotonic;
L264: R10 in ( bool R5 ) by MSSUBFAM:12;
L265: R10 c= R5 by L264 , MBOOLEAN:1;
L266: ( R10 /\ R11 ) c= R5 by L265 , MBOOLEAN:14;
L267: ( R10 /\ R11 ) in ( bool R5 ) by L266 , MBOOLEAN:1;
L268: ( R10 /\ R11 ) is (Element of ( bool R5 )) by L267 , MSSUBFAM:11;
L269: ( R10 /\ R11 ) c= R11 by PBOOLE:15;
L270: ( R8 .. ( R10 /\ R11 ) ) c= ( R8 .. R11 ) by L269 , L263 , L268 , L147;
L271: ( R10 /\ R11 ) c= R10 by PBOOLE:15;
L272: ( R8 .. ( R10 /\ R11 ) ) c= ( R8 .. R10 ) by L271 , L263 , L268 , L147;
thus L273: thesis by L272 , L270 , PBOOLE:17;
end;
registration
let R3 being set;
let R5 being (ManySortedSet of R3);
cluster  topological ->  monotonic for (MSSetOp of R5);
coherence
proof
let C69 being (MSSetOp of R5);
assume that
L274: C69 is  topological;
let C70 , C71 being (Element of ( bool R5 ));
assume that
L275: C70 c= C71;
L276: ( ( C69 .. C70 ) \/ ( C69 .. C71 ) ) = ( C69 .. ( C70 \/ C71 ) ) by L274 , L149
.= ( C69 .. C71 ) by L275 , PBOOLE:22;
thus L277: thesis by L276 , PBOOLE:26;
end;
end;
theorem
L279: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R8 being (MSSetOp of R5) holds (for R10 being (Element of ( bool R5 )) holds (for R11 being (Element of ( bool R5 )) holds (R8 is  topological implies ( ( R8 .. R10 ) \ ( R8 .. R11 ) ) c= ( R8 .. ( R10 \ R11 ) )))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let R8 being (MSSetOp of R5);
let R10 being (Element of ( bool R5 ));
let R11 being (Element of ( bool R5 ));
L280: R10 in ( bool R5 ) by MSSUBFAM:12;
L281: R10 c= R5 by L280 , MBOOLEAN:1;
L282: ( R10 \ R11 ) c= R5 by L281 , MBOOLEAN:15;
L283: ( R10 \ R11 ) in ( bool R5 ) by L282 , MBOOLEAN:1;
L284: ( R10 \ R11 ) is (Element of ( bool R5 )) by L283 , MSSUBFAM:11;
assume L285: R8 is  topological;
L286: ( ( R8 .. R10 ) \/ ( R8 .. R11 ) ) = ( R8 .. ( R10 \/ R11 ) ) by L285 , L149
.= ( R8 .. ( ( R10 \ R11 ) \/ R11 ) ) by PBOOLE:67
.= ( ( R8 .. ( R10 \ R11 ) ) \/ ( R8 .. R11 ) ) by L284 , L285 , L149;
L287: ( R8 .. R10 ) c= ( ( R8 .. ( R10 \ R11 ) ) \/ ( R8 .. R11 ) ) by L286 , PBOOLE:14;
L288: ( ( R8 .. R10 ) \ ( R8 .. R11 ) ) c= ( ( ( R8 .. ( R10 \ R11 ) ) \/ ( R8 .. R11 ) ) \ ( R8 .. R11 ) ) by L287 , PBOOLE:53;
L289: ( ( R8 .. R10 ) \ ( R8 .. R11 ) ) c= ( ( R8 .. ( R10 \ R11 ) ) \ ( R8 .. R11 ) ) by L288 , PBOOLE:75;
L290: ( ( R8 .. ( R10 \ R11 ) ) \ ( R8 .. R11 ) ) c= ( R8 .. ( R10 \ R11 ) ) by PBOOLE:56;
thus L291: thesis by L290 , L289 , PBOOLE:13;
end;
definition
let R3 being set;
let R5 being (ManySortedSet of R3);
let R9 being (MSSetOp of R5);
let R8 being (MSSetOp of R5);
redefine func R8 ** R9 -> (MSSetOp of R5);

coherence
proof
L292: ( R8 ** R9 ) is (ManySortedFunction of ( bool R5 ) , ( bool R5 ));
thus L293: thesis by L292;
end;
end;
theorem
L295: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R8 being (MSSetOp of R5) holds (for R9 being (MSSetOp of R5) holds ((R8 is  reflexive & R9 is  reflexive) implies ( R8 ** R9 ) is  reflexive)))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let R8 being (MSSetOp of R5);
let R9 being (MSSetOp of R5);
assume L296: (R8 is  reflexive & R9 is  reflexive);
let C72 being (Element of ( bool R5 ));
L297: (C72 c= ( R9 .. C72 ) & ( R9 .. C72 ) c= ( R8 .. ( R9 .. C72 ) )) by L296 , L146;
L298: (( doms R9 ) = ( bool R5 ) & C72 c= ( R8 .. ( R9 .. C72 ) )) by L297 , MSSUBFAM:17 , PBOOLE:13;
thus L299: thesis by L298 , L41 , MSSUBFAM:12;
end;
theorem
L300: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R8 being (MSSetOp of R5) holds (for R9 being (MSSetOp of R5) holds ((R8 is  monotonic & R9 is  monotonic) implies ( R8 ** R9 ) is  monotonic)))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let R8 being (MSSetOp of R5);
let R9 being (MSSetOp of R5);
assume that
L301: R8 is  monotonic
and
L302: R9 is  monotonic;
L303: ( doms R9 ) = ( bool R5 ) by MSSUBFAM:17;
let C73 , C74 being (Element of ( bool R5 ));
assume L304: C73 c= C74;
L305: ( R9 .. C73 ) c= ( R9 .. C74 ) by L304 , L302 , L147;
L306: ( R8 .. ( R9 .. C73 ) ) c= ( R8 .. ( R9 .. C74 ) ) by L305 , L301 , L147;
L307: ( R8 .. ( R9 .. C73 ) ) c= ( ( R8 ** R9 ) .. C74 ) by L306 , L303 , L41 , MSSUBFAM:12;
thus L308: thesis by L307 , L303 , L41 , MSSUBFAM:12;
end;
theorem
L309: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R8 being (MSSetOp of R5) holds (for R9 being (MSSetOp of R5) holds ((R8 is  idempotent & R9 is  idempotent & ( R8 ** R9 ) = ( R9 ** R8 )) implies ( R8 ** R9 ) is  idempotent)))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let R8 being (MSSetOp of R5);
let R9 being (MSSetOp of R5);
assume that
L310: R8 is  idempotent
and
L311: R9 is  idempotent
and
L312: ( R8 ** R9 ) = ( R9 ** R8 );
let C75 being (Element of ( bool R5 ));
L313: ( doms R8 ) = ( bool R5 ) by MSSUBFAM:17;
L314: ( doms R9 ) = ( bool R5 ) by MSSUBFAM:17;
thus L315: ( ( R8 ** R9 ) .. C75 ) = ( R8 .. ( R9 .. C75 ) ) by L314 , L41 , MSSUBFAM:12
.= ( R8 .. ( R9 .. ( R9 .. C75 ) ) ) by L311 , L148
.= ( R8 .. ( R8 .. ( R9 .. ( R9 .. C75 ) ) ) ) by L310 , L148
.= ( R8 .. ( ( R9 ** R8 ) .. ( R9 .. C75 ) ) ) by L312 , L314 , L41 , MSSUBFAM:12
.= ( R8 .. ( R9 .. ( R8 .. ( R9 .. C75 ) ) ) ) by L313 , L41 , MSSUBFAM:12
.= ( R8 .. ( R9 .. ( ( R8 ** R9 ) .. C75 ) ) ) by L314 , L41 , MSSUBFAM:12
.= ( ( R8 ** R9 ) .. ( ( R8 ** R9 ) .. C75 ) ) by L314 , L41 , MSSUBFAM:12;
end;
theorem
L316: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R8 being (MSSetOp of R5) holds (for R9 being (MSSetOp of R5) holds ((R8 is  topological & R9 is  topological) implies ( R8 ** R9 ) is  topological)))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let R8 being (MSSetOp of R5);
let R9 being (MSSetOp of R5);
assume that
L317: R8 is  topological
and
L318: R9 is  topological;
let C76 , C77 being (Element of ( bool R5 ));
L319: ( doms R9 ) = ( bool R5 ) by MSSUBFAM:17;
L320: C77 in ( bool R5 ) by MSSUBFAM:12;
L321: C77 c= R5 by L320 , MBOOLEAN:1;
L322: C76 in ( bool R5 ) by MSSUBFAM:12;
L323: C76 c= R5 by L322 , MBOOLEAN:1;
L324: ( C76 \/ C77 ) c= R5 by L323 , L321 , PBOOLE:16;
L325: ( C76 \/ C77 ) in ( doms R9 ) by L324 , L319 , MBOOLEAN:1;
thus L326: ( ( R8 ** R9 ) .. ( C76 \/ C77 ) ) = ( R8 .. ( R9 .. ( C76 \/ C77 ) ) ) by L325 , L41
.= ( R8 .. ( ( R9 .. C76 ) \/ ( R9 .. C77 ) ) ) by L318 , L149
.= ( ( R8 .. ( R9 .. C76 ) ) \/ ( R8 .. ( R9 .. C77 ) ) ) by L317 , L149
.= ( ( ( R8 ** R9 ) .. C76 ) \/ ( R8 .. ( R9 .. C77 ) ) ) by L319 , L41 , MSSUBFAM:12
.= ( ( ( R8 ** R9 ) .. C76 ) \/ ( ( R8 ** R9 ) .. C77 ) ) by L319 , L41 , MSSUBFAM:12;
end;
L327:
now
let R3 being set;
let R5 being (ManySortedSet of R3);
let R1 being set;
let C78 being (ManySortedSet of R3);
let C79 being (Element of ( bool ( R5 . R1 ) ));
assume that
L328: C78 = ( ( [[0]] R3 ) +* ( R1 .--> C79 ) );
L329: ( dom ( R1 .--> C79 ) ) = { R1 } by FUNCOP_1:13;
L330: ( [[0]] R3 ) c= R5 by MBOOLEAN:5;
L331: ( [[0]] R3 ) in ( bool R5 ) by L330 , MBOOLEAN:1;
thus L332: C78 in ( bool R5 )
proof
let C80 being set;
assume that
L333: C80 in R3;
L334: R1 in { R1 } by TARSKI:def 1;
L335: ( C78 . R1 ) = ( ( R1 .--> C79 ) . R1 ) by L334 , L328 , L329 , FUNCT_4:13
.= C79 by FUNCOP_1:72;
L336:
now
per cases ;
case L337: C80 = R1;
L338: C79 in ( bool ( R5 . C80 ) ) by L337;
thus L339: thesis by L338 , L333 , L335 , L337 , MBOOLEAN:def 1;
end;
case L340: C80 <> R1;
L341: (not C80 in ( dom ( R1 .--> C79 ) )) by L340 , L329 , TARSKI:def 1;
L342: ( C78 . C80 ) = ( ( [[0]] R3 ) . C80 ) by L341 , L328 , FUNCT_4:11;
thus L343: thesis by L342 , L331 , L333 , PBOOLE:def 1;
end;
end;
thus L345: thesis by L336;
end;

end;
theorem
L333: (for R1 being set holds (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R6 being Function holds (for R8 being (MSSetOp of R5) holds ((R8 is  reflexive & R1 in R3 & R6 = ( R8 . R1 )) implies (for B47 being (Element of ( bool ( R5 . R1 ) )) holds B47 c= ( R6 . B47 ))))))))
proof
let R1 being set;
let R3 being set;
let R5 being (ManySortedSet of R3);
let R6 being Function;
let R8 being (MSSetOp of R5);
assume that
L334: R8 is  reflexive
and
L335: R1 in R3
and
L336: R6 = ( R8 . R1 );
let C81 being (Element of ( bool ( R5 . R1 ) ));
L337: ( dom ( ( [[0]] R3 ) +* ( R1 .--> C81 ) ) ) = R3 by L335 , PZFMISC1:1;
reconsider D28 = ( ( [[0]] R3 ) +* ( R1 .--> C81 ) ) as (ManySortedSet of R3) by L337 , PARTFUN1:def 2 , RELAT_1:def 18;
L338: D28 is (Element of ( bool R5 )) by L327 , MSSUBFAM:11;
L339: D28 c= ( R8 .. D28 ) by L338 , L334 , L146;
L340: ( D28 . R1 ) c= ( ( R8 .. D28 ) . R1 ) by L339 , L335 , PBOOLE:def 2;
L341: (( dom ( R1 .--> C81 ) ) = { R1 } & R1 in { R1 }) by FUNCOP_1:13 , TARSKI:def 1;
L342: ( D28 . R1 ) = ( ( R1 .--> C81 ) . R1 ) by L341 , FUNCT_4:13
.= C81 by FUNCOP_1:72;
L343: R1 in ( dom R8 ) by L335 , PARTFUN1:def 2;
thus L344: thesis by L343 , L336 , L342 , L340 , PRALG_1:def 17;
end;
theorem
L345: (for R1 being set holds (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R6 being Function holds (for R8 being (MSSetOp of R5) holds ((R8 is  monotonic & R1 in R3 & R6 = ( R8 . R1 )) implies (for B48 , B49 being (Element of ( bool ( R5 . R1 ) )) holds (B48 c= B49 implies ( R6 . B48 ) c= ( R6 . B49 )))))))))
proof
let R1 being set;
let R3 being set;
let R5 being (ManySortedSet of R3);
let R6 being Function;
let R8 being (MSSetOp of R5);
assume that
L346: R8 is  monotonic
and
L347: R1 in R3
and
L348: R6 = ( R8 . R1 );
let C82 , C83 being (Element of ( bool ( R5 . R1 ) ));
assume that
L349: C82 c= C83;
L350: ( dom ( ( [[0]] R3 ) +* ( R1 .--> C83 ) ) ) = R3 by L347 , PZFMISC1:1;
reconsider D29 = ( ( [[0]] R3 ) +* ( R1 .--> C83 ) ) as (ManySortedSet of R3) by L350 , PARTFUN1:def 2 , RELAT_1:def 18;
L351: ( dom ( ( [[0]] R3 ) +* ( R1 .--> C82 ) ) ) = R3 by L347 , PZFMISC1:1;
reconsider D30 = ( ( [[0]] R3 ) +* ( R1 .--> C82 ) ) as (ManySortedSet of R3) by L351 , PARTFUN1:def 2 , RELAT_1:def 18;
L352: R1 in { R1 } by TARSKI:def 1;
L353: ( dom ( R1 .--> C83 ) ) = { R1 } by FUNCOP_1:13;
L354: ( D29 . R1 ) = ( ( R1 .--> C83 ) . R1 ) by L353 , L352 , FUNCT_4:13
.= C83 by FUNCOP_1:72;
L355: ( dom ( R1 .--> C82 ) ) = { R1 } by FUNCOP_1:13;
L356: ( D30 . R1 ) = ( ( R1 .--> C82 ) . R1 ) by L355 , L352 , FUNCT_4:13
.= C82 by FUNCOP_1:72;
L357: D30 c= D29
proof
let C84 being set;
assume that
L358: C84 in R3;
per cases ;
suppose L359: C84 = R1;

thus L360: thesis by L359 , L349 , L356 , L354;
end;
suppose L361: C84 <> R1;

L362: (not C84 in ( dom ( R1 .--> C82 ) )) by L361 , L355 , TARSKI:def 1;
L363: ( D30 . C84 ) = ( ( [[0]] R3 ) . C84 ) by L362 , FUNCT_4:11;
L364: (not C84 in ( dom ( R1 .--> C83 ) )) by L353 , L361 , TARSKI:def 1;
thus L365: thesis by L364 , L363 , FUNCT_4:11;
end;
end;
L367: R1 in ( dom R8 ) by L347 , PARTFUN1:def 2;
L368: (D30 is (Element of ( bool R5 )) & D29 is (Element of ( bool R5 ))) by L327 , MSSUBFAM:11;
L369: ( R8 .. D30 ) c= ( R8 .. D29 ) by L368 , L346 , L357 , L147;
L370: ( ( R8 .. D30 ) . R1 ) c= ( ( R8 .. D29 ) . R1 ) by L369 , L347 , PBOOLE:def 2;
L371: ( R6 . ( D30 . R1 ) ) c= ( ( R8 .. D29 ) . R1 ) by L370 , L348 , L367 , PRALG_1:def 17;
thus L372: thesis by L371 , L348 , L356 , L354 , L367 , PRALG_1:def 17;
end;
theorem
L373: (for R1 being set holds (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R6 being Function holds (for R8 being (MSSetOp of R5) holds ((R8 is  idempotent & R1 in R3 & R6 = ( R8 . R1 )) implies (for B50 being (Element of ( bool ( R5 . R1 ) )) holds ( R6 . B50 ) = ( R6 . ( R6 . B50 ) ))))))))
proof
let R1 being set;
let R3 being set;
let R5 being (ManySortedSet of R3);
let R6 being Function;
let R8 being (MSSetOp of R5);
assume that
L374: R8 is  idempotent
and
L375: R1 in R3
and
L376: R6 = ( R8 . R1 );
L377: R1 in ( dom R8 ) by L375 , PARTFUN1:def 2;
let C85 being (Element of ( bool ( R5 . R1 ) ));
L378: ( dom ( ( [[0]] R3 ) +* ( R1 .--> C85 ) ) ) = R3 by L375 , PZFMISC1:1;
reconsider D31 = ( ( [[0]] R3 ) +* ( R1 .--> C85 ) ) as (ManySortedSet of R3) by L378 , PARTFUN1:def 2 , RELAT_1:def 18;
L379: D31 is (Element of ( bool R5 )) by L327 , MSSUBFAM:11;
L380: (( dom ( R1 .--> C85 ) ) = { R1 } & R1 in { R1 }) by FUNCOP_1:13 , TARSKI:def 1;
L381: ( D31 . R1 ) = ( ( R1 .--> C85 ) . R1 ) by L380 , FUNCT_4:13
.= C85 by FUNCOP_1:72;
thus L382: ( R6 . C85 ) = ( ( R8 .. D31 ) . R1 ) by L381 , L376 , L377 , PRALG_1:def 17
.= ( ( R8 .. ( R8 .. D31 ) ) . R1 ) by L374 , L379 , L148
.= ( R6 . ( ( R8 .. D31 ) . R1 ) ) by L376 , L377 , PRALG_1:def 17
.= ( R6 . ( R6 . C85 ) ) by L376 , L381 , L377 , PRALG_1:def 17;
end;
theorem
L383: (for R1 being set holds (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for R6 being Function holds (for R8 being (MSSetOp of R5) holds ((R8 is  topological & R1 in R3 & R6 = ( R8 . R1 )) implies (for B51 , B52 being (Element of ( bool ( R5 . R1 ) )) holds ( R6 . ( B51 \/ B52 ) ) = ( ( R6 . B51 ) \/ ( R6 . B52 ) ))))))))
proof
let R1 being set;
let R3 being set;
let R5 being (ManySortedSet of R3);
let R6 being Function;
let R8 being (MSSetOp of R5);
assume that
L384: R8 is  topological
and
L385: R1 in R3
and
L386: R6 = ( R8 . R1 );
L387: R1 in ( dom R8 ) by L385 , PARTFUN1:def 2;
let C86 , C87 being (Element of ( bool ( R5 . R1 ) ));
L388: ( dom ( ( [[0]] R3 ) +* ( R1 .--> C87 ) ) ) = R3 by L385 , PZFMISC1:1;
reconsider D32 = ( ( [[0]] R3 ) +* ( R1 .--> C87 ) ) as (ManySortedSet of R3) by L388 , PARTFUN1:def 2 , RELAT_1:def 18;
L389: ( dom ( ( [[0]] R3 ) +* ( R1 .--> C86 ) ) ) = R3 by L385 , PZFMISC1:1;
reconsider D33 = ( ( [[0]] R3 ) +* ( R1 .--> C86 ) ) as (ManySortedSet of R3) by L389 , PARTFUN1:def 2 , RELAT_1:def 18;
L390: R1 in { R1 } by TARSKI:def 1;
L391: ( dom ( R1 .--> C87 ) ) = { R1 } by FUNCOP_1:13;
L392: ( D32 . R1 ) = ( ( R1 .--> C87 ) . R1 ) by L391 , L390 , FUNCT_4:13
.= C87 by FUNCOP_1:72;
L393: (D33 is (Element of ( bool R5 )) & D32 is (Element of ( bool R5 ))) by L327 , MSSUBFAM:11;
L394: ( dom ( R1 .--> C86 ) ) = { R1 } by FUNCOP_1:13;
L395: ( D33 . R1 ) = ( ( R1 .--> C86 ) . R1 ) by L394 , L390 , FUNCT_4:13
.= C86 by FUNCOP_1:72;
thus L396: ( R6 . ( C86 \/ C87 ) ) = ( R6 . ( ( D33 \/ D32 ) . R1 ) ) by L395 , L385 , L392 , PBOOLE:def 4
.= ( ( R8 .. ( D33 \/ D32 ) ) . R1 ) by L386 , L387 , PRALG_1:def 17
.= ( ( ( R8 .. D33 ) \/ ( R8 .. D32 ) ) . R1 ) by L384 , L393 , L149
.= ( ( ( R8 .. D33 ) . R1 ) \/ ( ( R8 .. D32 ) . R1 ) ) by L385 , PBOOLE:def 4
.= ( ( R6 . ( D33 . R1 ) ) \/ ( ( R8 .. D32 ) . R1 ) ) by L386 , L387 , PRALG_1:def 17
.= ( ( R6 . C86 ) \/ ( R6 . C87 ) ) by L386 , L395 , L392 , L387 , PRALG_1:def 17;
end;
begin
definition
let R12 being 1-sorted;
struct (many-sorted over R12) MSClosureStr over R12(# Sorts -> (ManySortedSet of (the carrier of R12)) , Family -> (MSSubsetFamily of the Sorts) #);
end;
definition
let R12 being 1-sorted;
let C88 being MSClosureStr over R12;
attr C88 is  additive
means
:L398: (the Family of C88) is  additive;
attr C88 is  absolutely-additive
means
:L399: (the Family of C88) is  absolutely-additive;
attr C88 is  multiplicative
means
:L400: (the Family of C88) is  multiplicative;
attr C88 is  absolutely-multiplicative
means
:L401: (the Family of C88) is  absolutely-multiplicative;
attr C88 is  properly-upper-bound
means
:L402: (the Family of C88) is  properly-upper-bound;
attr C88 is  properly-lower-bound
means
:L403: (the Family of C88) is  properly-lower-bound;
end;
definition
let R12 being 1-sorted;
let R13 being many-sorted over R12;
func MSFull R13 -> MSClosureStr over R12 equals 
MSClosureStr (# (the Sorts of R13) , ( bool (the Sorts of R13) ) #);
correctness;
end;
registration
let R12 being 1-sorted;
let R13 being many-sorted over R12;
cluster ( MSFull R13 ) ->  strict  additive  absolutely-additive  multiplicative  absolutely-multiplicative  properly-upper-bound  properly-lower-bound;
coherence
proof
thus L406: ( MSFull R13 ) is  strict;
thus L407: (the Family of ( MSFull R13 )) is  additive  absolutely-additive  multiplicative  absolutely-multiplicative  properly-upper-bound  properly-lower-bound;
end;
end;
registration
let R12 being 1-sorted;
let C89 being  non-empty many-sorted over R12;
cluster ( MSFull C89 ) ->  non-empty;
coherence by MSUALG_1:def 3;
end;
registration
let R12 being 1-sorted;
cluster  strict  non-empty  additive  absolutely-additive  multiplicative  absolutely-multiplicative  properly-upper-bound  properly-lower-bound for MSClosureStr over R12;
existence
proof
set D34 = the  non-empty many-sorted over R12;
take ( MSFull D34 );
thus L410: thesis;
end;
end;
registration
let R12 being 1-sorted;
let C90 being  additive MSClosureStr over R12;
cluster (the Family of C90) ->  additive;
coherence by L398;
end;
registration
let R12 being 1-sorted;
let C91 being  absolutely-additive MSClosureStr over R12;
cluster (the Family of C91) ->  absolutely-additive;
coherence by L399;
end;
registration
let R12 being 1-sorted;
let C92 being  multiplicative MSClosureStr over R12;
cluster (the Family of C92) ->  multiplicative;
coherence by L400;
end;
registration
let R12 being 1-sorted;
let C93 being  absolutely-multiplicative MSClosureStr over R12;
cluster (the Family of C93) ->  absolutely-multiplicative;
coherence by L401;
end;
registration
let R12 being 1-sorted;
let C94 being  properly-upper-bound MSClosureStr over R12;
cluster (the Family of C94) ->  properly-upper-bound;
coherence by L402;
end;
registration
let R12 being 1-sorted;
let C95 being  properly-lower-bound MSClosureStr over R12;
cluster (the Family of C95) ->  properly-lower-bound;
coherence by L403;
end;
registration
let R12 being 1-sorted;
let C96 being  non-empty (ManySortedSet of (the carrier of R12));
let C97 being (MSSubsetFamily of C96);
cluster MSClosureStr (# C96 , C97 #) ->  non-empty;
coherence
proof
thus L418: (the Sorts of MSClosureStr (# C96 , C97 #)) is  non-empty;
end;
end;
registration
let R12 being 1-sorted;
let R13 being many-sorted over R12;
let C98 being  additive (MSSubsetFamily of (the Sorts of R13));
cluster MSClosureStr (# (the Sorts of R13) , C98 #) ->  additive;
coherence by L398;
end;
registration
let R12 being 1-sorted;
let R13 being many-sorted over R12;
let C99 being  absolutely-additive (MSSubsetFamily of (the Sorts of R13));
cluster MSClosureStr (# (the Sorts of R13) , C99 #) ->  absolutely-additive;
coherence by L399;
end;
registration
let R12 being 1-sorted;
let R13 being many-sorted over R12;
let C100 being  multiplicative (MSSubsetFamily of (the Sorts of R13));
cluster MSClosureStr (# (the Sorts of R13) , C100 #) ->  multiplicative;
coherence by L400;
end;
registration
let R12 being 1-sorted;
let R13 being many-sorted over R12;
let C101 being  absolutely-multiplicative (MSSubsetFamily of (the Sorts of R13));
cluster MSClosureStr (# (the Sorts of R13) , C101 #) ->  absolutely-multiplicative;
coherence by L401;
end;
registration
let R12 being 1-sorted;
let R13 being many-sorted over R12;
let C102 being  properly-upper-bound (MSSubsetFamily of (the Sorts of R13));
cluster MSClosureStr (# (the Sorts of R13) , C102 #) ->  properly-upper-bound;
coherence by L402;
end;
registration
let R12 being 1-sorted;
let R13 being many-sorted over R12;
let C103 being  properly-lower-bound (MSSubsetFamily of (the Sorts of R13));
cluster MSClosureStr (# (the Sorts of R13) , C103 #) ->  properly-lower-bound;
coherence by L403;
end;
registration
let R12 being 1-sorted;
cluster  absolutely-additive ->  additive for MSClosureStr over R12;
coherence
proof
let C104 being MSClosureStr over R12;
assume L426: C104 is  absolutely-additive;
thus L427: (the Family of C104) is  additive by L426;
end;
end;
registration
let R12 being 1-sorted;
cluster  absolutely-multiplicative ->  multiplicative for MSClosureStr over R12;
coherence
proof
let C105 being MSClosureStr over R12;
assume L429: C105 is  absolutely-multiplicative;
thus L430: (the Family of C105) is  multiplicative by L429;
end;
end;
registration
let R12 being 1-sorted;
cluster  absolutely-multiplicative ->  properly-upper-bound for MSClosureStr over R12;
coherence
proof
let C106 being MSClosureStr over R12;
assume L432: C106 is  absolutely-multiplicative;
thus L433: (the Family of C106) is  properly-upper-bound by L432;
end;
end;
registration
let R12 being 1-sorted;
cluster  absolutely-additive ->  properly-lower-bound for MSClosureStr over R12;
coherence
proof
let C107 being MSClosureStr over R12;
assume L435: C107 is  absolutely-additive;
thus L436: (the Family of C107) is  properly-lower-bound by L435;
end;
end;
definition
let R12 being 1-sorted;
mode MSClosureSystem of R12
 is  absolutely-multiplicative MSClosureStr over R12;
end;
definition
let R3 being set;
let R5 being (ManySortedSet of R3);
mode MSClosureOperator of R5
 is  reflexive  monotonic  idempotent (MSSetOp of R5);
end;
definition
let R3 being set;
let R5 being (ManySortedSet of R3);
let C108 being (ManySortedFunction of R5 , R5);
func MSFixPoints C108 -> (ManySortedSubset of R5) means 
:L440: (for R2 being set holds (for R1 being set holds (R1 in R3 implies (R2 in ( it . R1 ) iff (ex B53 being Function st (B53 = ( C108 . R1 ) & R2 in ( dom B53 ) & ( B53 . R2 ) = R2))))));
existence
proof
defpred S1[ set , set ] means (for R2 being set holds (R2 in $2 iff (R2 in ( R5 . $1 ) & (ex B54 being Function st (B54 = ( C108 . $1 ) & R2 in ( dom B54 ) & ( B54 . R2 ) = R2)))));
L441:
now
let R1 being set;
assume that
L442: R1 in R3;
defpred S2[ set ] means (ex B55 being Function st (B55 = ( C108 . R1 ) & $1 in ( dom B55 ) & ( B55 . $1 ) = $1));
consider C109 being set such that L443: (for R2 being set holds (R2 in C109 iff (R2 in ( R5 . R1 ) & S2[ R2 ]))) from XBOOLE_0:sch 1;
take D35 = C109;
thus L444: S1[ R1 , D35 ] by L443;
end;
consider C110 being (ManySortedSet of R3) such that L445: (for R1 being set holds (R1 in R3 implies S1[ R1 , ( C110 . R1 ) ])) from PBOOLE:sch 3(L441);
L446: C110 is (ManySortedSubset of R5)
proof
let R1 being set;
assume that
L447: R1 in R3;
let R2 being set;
assume L448: R2 in ( C110 . R1 );
thus L449: thesis by L448 , L445 , L447;
end;
reconsider D36 = C110 as (ManySortedSubset of R5) by L446;
take D36;
thus L450: (for R2 being set holds (for R1 being set holds (R1 in R3 implies (R2 in ( D36 . R1 ) iff (ex B56 being Function st (B56 = ( C108 . R1 ) & R2 in ( dom B56 ) & ( B56 . R2 ) = R2))))))
proof
let R2 being set;
let R1 being set;
assume L451: R1 in R3;
thus L452: (R2 in ( D36 . R1 ) implies (ex B57 being Function st (B57 = ( C108 . R1 ) & R2 in ( dom B57 ) & ( B57 . R2 ) = R2))) by L451 , L445;
given C111 being Function such that
L453: C111 = ( C108 . R1 )
and
L454: (R2 in ( dom C111 ) & ( C111 . R2 ) = R2);

L455: ( doms C108 ) = R5 by MSSUBFAM:17;
L456: ( dom C111 ) = ( R5 . R1 ) by L455 , L451 , L453 , MSSUBFAM:14;
thus L457: thesis by L456 , L445 , L451 , L453 , L454;
end;

end;
uniqueness
proof
let C112 , C113 being (ManySortedSubset of R5);
assume that
L451: (for R2 being set holds (for R1 being set holds (R1 in R3 implies (R2 in ( C112 . R1 ) iff (ex B58 being Function st (B58 = ( C108 . R1 ) & R2 in ( dom B58 ) & ( B58 . R2 ) = R2))))))
and
L452: (for R2 being set holds (for R1 being set holds (R1 in R3 implies (R2 in ( C113 . R1 ) iff (ex B59 being Function st (B59 = ( C108 . R1 ) & R2 in ( dom B59 ) & ( B59 . R2 ) = R2))))));
L453:
now
let R1 being set;
assume that
L454: R1 in R3;
thus L455: ( C112 . R1 ) = ( C113 . R1 )
proof
thus L456: ( C112 . R1 ) c= ( C113 . R1 )
proof
let R2 being set;
assume L457: R2 in ( C112 . R1 );
L458: (ex B60 being Function st (B60 = ( C108 . R1 ) & R2 in ( dom B60 ) & ( B60 . R2 ) = R2)) by L457 , L451 , L454;
thus L459: thesis by L458 , L452 , L454;
end;

let R2 being set;
assume L460: R2 in ( C113 . R1 );
L461: (ex B61 being Function st (B61 = ( C108 . R1 ) & R2 in ( dom B61 ) & ( B61 . R2 ) = R2)) by L460 , L452 , L454;
thus L462: thesis by L461 , L451 , L454;
end;

end;
thus L456: C112 = C113 by L453 , PBOOLE:3;
end;
end;
registration
let R3 being set;
let C114 being  empty-yielding (ManySortedSet of R3);
let C115 being (ManySortedFunction of C114 , C114);
cluster ( MSFixPoints C115 ) ->  empty-yielding;
coherence
proof
let R1 being set;
assume that
L458: R1 in R3;
assume L459: ( ( MSFixPoints C115 ) . R1 ) is non  empty;
consider C116 being set such that L460: C116 in ( ( MSFixPoints C115 ) . R1 ) by L459 , XBOOLE_0:def 1;
consider C117 being Function such that L461: C117 = ( C115 . R1 ) and L462: C116 in ( dom C117 ) and L463: ( C117 . C116 ) = C116 by L458 , L460 , L440;
L464: ( C114 . R1 ) = ( {} );
L465: C117 is (Function of ( {} ) , ( {} )) by L464 , L458 , L461 , PBOOLE:def 15;
thus L466: contradiction by L465 , L462;
end;
end;
theorem
L468: (for R3 being set holds (for R4 being (ManySortedSet of R3) holds (for R5 being (ManySortedSet of R3) holds (for B62 being (ManySortedFunction of R5 , R5) holds ((R4 in R5 & ( B62 .. R4 ) = R4) iff R4 in ( MSFixPoints B62 ))))))
proof
let R3 being set;
let R4 being (ManySortedSet of R3);
let R5 being (ManySortedSet of R3);
let C118 being (ManySortedFunction of R5 , R5);
thus L469: ((R4 in R5 & ( C118 .. R4 ) = R4) implies R4 in ( MSFixPoints C118 ))
proof
assume that
L470: R4 in R5
and
L471: ( C118 .. R4 ) = R4;
let R1 being set;
assume L472: R1 in R3;
reconsider D37 = ( C118 . R1 ) as (Function of ( R5 . R1 ) , ( R5 . R1 )) by L472 , PBOOLE:def 15;
L473: R1 in ( dom C118 ) by L472 , PARTFUN1:def 2;
L474: ( D37 . ( R4 . R1 ) ) = ( R4 . R1 ) by L473 , L471 , PRALG_1:def 17;
L475: R5 = ( doms C118 ) by MSSUBFAM:17;
L476: ( R5 . R1 ) = ( dom D37 ) by L475 , L472 , MSSUBFAM:14;
L477: ( R4 . R1 ) in ( dom D37 ) by L476 , L470 , L472 , PBOOLE:def 1;
thus L478: thesis by L477 , L472 , L474 , L440;
end;

assume L479: R4 in ( MSFixPoints C118 );
thus L480: R4 in R5
proof
let R1 being set;
L481: R5 = ( doms C118 ) by MSSUBFAM:17;
assume L482: R1 in R3;
L483: ( R4 . R1 ) in ( ( MSFixPoints C118 ) . R1 ) by L482 , L479 , PBOOLE:def 1;
L484: (ex B63 being Function st (B63 = ( C118 . R1 ) & ( R4 . R1 ) in ( dom B63 ) & ( B63 . ( R4 . R1 ) ) = ( R4 . R1 ))) by L483 , L482 , L440;
thus L485: thesis by L484 , L482 , L481 , MSSUBFAM:14;
end;

L486:
now
let R1 being set;
assume L487: R1 in R3;
L488: ( R4 . R1 ) in ( ( MSFixPoints C118 ) . R1 ) by L487 , L479 , PBOOLE:def 1;
L489: (ex B64 being Function st (B64 = ( C118 . R1 ) & ( R4 . R1 ) in ( dom B64 ) & ( B64 . ( R4 . R1 ) ) = ( R4 . R1 ))) by L488 , L487 , L440;
L490: R1 in ( dom C118 ) by L487 , PARTFUN1:def 2;
thus L491: ( ( C118 .. R4 ) . R1 ) = ( R4 . R1 ) by L490 , L489 , PRALG_1:def 17;
end;
thus L492: thesis by L486 , PBOOLE:3;
end;
theorem
L493: (for R3 being set holds (for R4 being (ManySortedSet of R3) holds ( MSFixPoints ( id R4 ) ) = R4))
proof
let R3 being set;
let R4 being (ManySortedSet of R3);
L494:
now
let R1 being set;
assume that
L495: R1 in R3;
thus L496: ( ( MSFixPoints ( id R4 ) ) . R1 ) = ( R4 . R1 )
proof
thus L497: ( ( MSFixPoints ( id R4 ) ) . R1 ) c= ( R4 . R1 )
proof
let C119 being set;
assume L498: C119 in ( ( MSFixPoints ( id R4 ) ) . R1 );
consider C120 being Function such that L499: C120 = ( ( id R4 ) . R1 ) and L500: C119 in ( dom C120 ) and L501: ( C120 . C119 ) = C119 by L498 , L495 , L440;
L502: C120 is (Function of ( R4 . R1 ) , ( R4 . R1 )) by L495 , L499 , PBOOLE:def 15;
thus L503: thesis by L502 , L500 , FUNCT_2:52;
end;

reconsider D38 = ( ( id R4 ) . R1 ) as (Function of ( R4 . R1 ) , ( R4 . R1 )) by L495 , PBOOLE:def 15;
let C121 being set;
assume that
L504: C121 in ( R4 . R1 );
L505: C121 in ( dom D38 ) by L504 , FUNCT_2:52;
L506: D38 = ( id ( R4 . R1 ) ) by L495 , MSUALG_3:def 1;
L507: ( D38 . C121 ) = C121 by L506 , L504 , FUNCT_1:18;
thus L508: thesis by L507 , L495 , L505 , L440;
end;

end;
thus L497: thesis by L494 , PBOOLE:3;
end;
theorem
L498: (for R12 being 1-sorted holds (for B65 being (ManySortedSet of (the carrier of R12)) holds (for B66 being  reflexive  monotonic (MSSetOp of B65) holds (for B67 being (MSSubsetFamily of B65) holds (B67 = ( MSFixPoints B66 ) implies MSClosureStr (# B65 , B67 #) is (MSClosureSystem of R12))))))
proof
let R12 being 1-sorted;
let C122 being (ManySortedSet of (the carrier of R12));
let C123 being  reflexive  monotonic (MSSetOp of C122);
let C124 being (MSSubsetFamily of C122);
assume that
L499: C124 = ( MSFixPoints C123 );
L500: C124 is  absolutely-multiplicative
proof
let C125 being (MSSubsetFamily of C122);
assume that
L501: C125 c= C124;
L502: ( C123 .. ( meet C125 ) ) c= ( meet C125 )
proof
let R1 being set;
assume L503: R1 in (the carrier of R12);
reconsider D39 = ( C123 . R1 ) as (Function of ( ( bool C122 ) . R1 ) , ( ( bool C122 ) . R1 )) by L503 , PBOOLE:def 15;
L504: R1 in ( dom C123 ) by L503 , PARTFUN1:def 2;
consider C126 being (Subset-Family of ( C122 . R1 )) such that L505: C126 = ( C125 . R1 ) and L506: ( ( meet C125 ) . R1 ) = ( Intersect C126 ) by L503 , MSSUBFAM:def 1;
L507:
now
let R2 being set;
assume that
L508: R2 in C126;
L509: C126 c= ( C124 . R1 ) by L501 , L503 , L505 , PBOOLE:def 2;
L510: (ex B68 being Function st (B68 = ( C123 . R1 ) & R2 in ( dom B68 ) & ( B68 . R2 ) = R2)) by L509 , L499 , L503 , L508 , L440;
thus L511: ( D39 . ( Intersect C126 ) ) c= R2 by L510 , L503 , L508 , L345 , MSSUBFAM:2;
end;
L512: ( ( bool C122 ) . R1 ) = ( bool ( C122 . R1 ) ) by L503 , MBOOLEAN:def 1;
L513: ( D39 . ( Intersect C126 ) ) in ( bool ( C122 . R1 ) ) by L512 , FUNCT_2:5;
L514: ( D39 . ( Intersect C126 ) ) c= ( Intersect C126 ) by L513 , L507 , MSSUBFAM:4;
thus L515: thesis by L514 , L506 , L504 , PRALG_1:def 17;
end;
L516: ( meet C125 ) c= C122 by PBOOLE:def 18;
L517: ( meet C125 ) in ( bool C122 ) by L516 , MBOOLEAN:18;
L518: ( meet C125 ) is (Element of ( bool C122 )) by L517 , MSSUBFAM:11;
L519: ( meet C125 ) c= ( C123 .. ( meet C125 ) ) by L518 , L146;
L520: ( C123 .. ( meet C125 ) ) = ( meet C125 ) by L519 , L502 , PBOOLE:146;
thus L521: thesis by L520 , L499 , L517 , L468;
end;
thus L522: thesis by L500;
end;
theorem
L523: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for B69 being  properly-upper-bound (MSSubsetFamily of R5) holds (for B70 being (Element of ( bool R5 )) holds (ex B71 being  non-empty (MSSubsetFamily of R5) st (for B72 being (ManySortedSet of R3) holds (B72 in B71 iff (B72 in B69 & B70 c= B72))))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let C127 being  properly-upper-bound (MSSubsetFamily of R5);
let C128 being (Element of ( bool R5 ));
defpred S3[ set , set ] means ( C128 . $1 ) c= $2;
consider C129 being (ManySortedSet of R3) such that L524: (for B73 being set holds (B73 in R3 implies (for B74 being set holds (B74 in ( C129 . B73 ) iff (B74 in ( C127 . B73 ) & S3[ B73 , B74 ]))))) from PBOOLE:sch 2;
L525: C127 c= ( bool R5 ) by PBOOLE:def 18;
L526: C129 is (ManySortedSubset of ( bool R5 ))
proof
let R1 being set;
assume L527: R1 in R3;
L528: ( C127 . R1 ) c= ( ( bool R5 ) . R1 ) by L527 , L525 , PBOOLE:def 2;
L529: ( C127 . R1 ) c= ( bool ( R5 . R1 ) ) by L528 , L527 , MBOOLEAN:def 1;
L530: ( C129 . R1 ) c= ( bool ( R5 . R1 ) )
proof
let R2 being set;
assume L531: R2 in ( C129 . R1 );
L532: R2 in ( C127 . R1 ) by L531 , L524 , L527;
thus L533: thesis by L532 , L529;
end;
thus L534: ( C129 . R1 ) c= ( ( bool R5 ) . R1 ) by L530 , L527 , MBOOLEAN:def 1;
end;
reconsider D40 = C129 as (ManySortedSubset of ( bool R5 )) by L526;
reconsider D41 = D40 as (MSSubsetFamily of R5);
L535: D41 is  non-empty
proof
let R1 being set;
assume that
L536: R1 in R3;
L537: R5 in C127 by MSSUBFAM:def 6;
L538: ( R5 . R1 ) in ( C127 . R1 ) by L537 , L536 , PBOOLE:def 1;
L539: C128 in ( bool R5 ) by MSSUBFAM:12;
L540: C128 c= R5 by L539 , MBOOLEAN:18;
L541: ( C128 . R1 ) c= ( R5 . R1 ) by L540 , L536 , PBOOLE:def 2;
thus L542: thesis by L541 , L524 , L536 , L538;
end;
reconsider D42 = D41 as  non-empty (MSSubsetFamily of R5) by L535;
take D42;
let C130 being (ManySortedSet of R3);
thus L543: (C130 in D42 implies (C130 in C127 & C128 c= C130))
proof
assume L544: C130 in D42;
thus L545: C130 in C127
proof
let R1 being set;
assume L546: R1 in R3;
L547: ( C130 . R1 ) in ( D42 . R1 ) by L546 , L544 , PBOOLE:def 1;
thus L548: thesis by L547 , L524 , L546;
end;

thus L549: C128 c= C130
proof
let R1 being set;
assume L550: R1 in R3;
L551: ( C130 . R1 ) in ( D42 . R1 ) by L550 , L544 , PBOOLE:def 1;
thus L552: thesis by L551 , L524 , L550;
end;

end;

assume L550: (C130 in C127 & C128 c= C130);
let R1 being set;
assume L551: R1 in R3;
L552: (( C130 . R1 ) in ( C127 . R1 ) & ( C128 . R1 ) c= ( C130 . R1 )) by L551 , L550 , PBOOLE:def 1 , PBOOLE:def 2;
thus L553: thesis by L552 , L524 , L551;
end;
theorem
L554: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for B75 being  properly-upper-bound (MSSubsetFamily of R5) holds (for B76 being (Element of ( bool R5 )) holds (for B77 being  non-empty (MSSubsetFamily of R5) holds ((for B78 being (ManySortedSet of R3) holds (B78 in B77 iff (B78 in B75 & B76 c= B78))) implies (for B79 being set holds (for B80 being non  empty set holds ((B79 in R3 & B80 = ( B75 . B79 )) implies ( B77 . B79 ) = { B81 where B81 is (Element of B80) : ( B76 . B79 ) c= B81 })))))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let C131 being  properly-upper-bound (MSSubsetFamily of R5);
let C132 being (Element of ( bool R5 ));
let C133 being  non-empty (MSSubsetFamily of R5);
assume that
L555: (for B82 being (ManySortedSet of R3) holds (B82 in C133 iff (B82 in C131 & C132 c= B82)));
let C134 being set;
let C135 being non  empty set;
assume that
L556: C134 in R3
and
L557: C135 = ( C131 . C134 );
thus L558: ( C133 . C134 ) c= { B83 where B83 is (Element of C135) : ( C132 . C134 ) c= B83 }
proof
consider C136 being (ManySortedSet of R3) such that L559: C136 in C133 by PBOOLE:134;
let R2 being set;
assume that
L560: R2 in ( C133 . C134 );
L561: ( dom ( C136 +* ( C134 .--> R2 ) ) ) = R3 by L556 , PZFMISC1:1;
reconsider D43 = ( C136 +* ( C134 .--> R2 ) ) as (ManySortedSet of R3) by L561 , PARTFUN1:def 2 , RELAT_1:def 18;
L562: ( dom ( C134 .--> R2 ) ) = { C134 } by FUNCOP_1:13;
L563: C134 in { C134 } by TARSKI:def 1;
L564: ( D43 . C134 ) = ( ( C134 .--> R2 ) . C134 ) by L563 , L562 , FUNCT_4:13
.= R2 by FUNCOP_1:72;
L565: D43 in C133
proof
let C137 being set;
assume that
L566: C137 in R3;
per cases ;
suppose L567: C137 = C134;

thus L568: thesis by L567 , L560 , L564;
end;
suppose L569: C137 <> C134;

L570: (not C137 in ( dom ( C134 .--> R2 ) )) by L569 , L562 , TARSKI:def 1;
L571: ( D43 . C137 ) = ( C136 . C137 ) by L570 , FUNCT_4:11;
thus L572: thesis by L571 , L559 , L566 , PBOOLE:def 1;
end;
end;
L574: C132 c= D43 by L565 , L555;
L575: ( C132 . C134 ) c= ( D43 . C134 ) by L574 , L556 , PBOOLE:def 2;
L576: D43 in C131 by L555 , L565;
L577: ( D43 . C134 ) in ( C131 . C134 ) by L576 , L556 , PBOOLE:def 1;
thus L578: thesis by L577 , L557 , L564 , L575;
end;

let R2 being set;
assume L579: R2 in { B84 where B84 is (Element of C135) : ( C132 . C134 ) c= B84 };
consider C138 being (Element of C135) such that L580: C138 = R2 and L581: ( C132 . C134 ) c= C138 by L579;
L582: ( dom ( R5 +* ( C134 .--> C138 ) ) ) = R3 by L556 , PZFMISC1:1;
reconsider D44 = ( R5 +* ( C134 .--> C138 ) ) as (ManySortedSet of R3) by L582 , PARTFUN1:def 2 , RELAT_1:def 18;
L583: ( dom ( C134 .--> C138 ) ) = { C134 } by FUNCOP_1:13;
L584: C134 in { C134 } by TARSKI:def 1;
L585: ( D44 . C134 ) = ( ( C134 .--> C138 ) . C134 ) by L584 , L583 , FUNCT_4:13
.= C138 by FUNCOP_1:72;
L586: C132 c= D44
proof
let C139 being set;
assume that
L587: C139 in R3;
per cases ;
suppose L588: C139 = C134;

thus L589: thesis by L588 , L581 , L585;
end;
suppose L590: C139 <> C134;

L591: C132 in ( bool R5 ) by MSSUBFAM:12;
L592: C132 c= R5 by L591 , MBOOLEAN:18;
L593: (not C139 in ( dom ( C134 .--> C138 ) )) by L583 , L590 , TARSKI:def 1;
L594: ( D44 . C139 ) = ( R5 . C139 ) by L593 , FUNCT_4:11;
thus L595: thesis by L594 , L587 , L592 , PBOOLE:def 2;
end;
end;
L597: R5 in C131 by MSSUBFAM:def 6;
L598: D44 in C131
proof
let C140 being set;
assume that
L599: C140 in R3;
per cases ;
suppose L600: C140 = C134;

thus L601: thesis by L600 , L557 , L585;
end;
suppose L602: C140 <> C134;

L603: (not C140 in ( dom ( C134 .--> C138 ) )) by L602 , L583 , TARSKI:def 1;
L604: ( D44 . C140 ) = ( R5 . C140 ) by L603 , FUNCT_4:11;
thus L605: thesis by L604 , L597 , L599 , PBOOLE:def 1;
end;
end;
L607: D44 in C133 by L598 , L555 , L586;
thus L608: thesis by L607 , L556 , L580 , L585 , PBOOLE:def 1;
end;
theorem
L609: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for B85 being  properly-upper-bound (MSSubsetFamily of R5) holds (ex B86 being (MSSetOp of R5) st (for B87 being (Element of ( bool R5 )) holds (for B88 being  non-empty (MSSubsetFamily of R5) holds ((for B89 being (ManySortedSet of R3) holds (B89 in B88 iff (B89 in B85 & B87 c= B89))) implies ( B86 .. B87 ) = ( meet B88 ))))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let C141 being  properly-upper-bound (MSSubsetFamily of R5);
set D45 = ( bool R5 );
defpred S4[ set , set , set ] means (for B90 being (Subset-Family of ( R5 . $3 )) holds (for B91 being non  empty set holds ((B91 = ( C141 . $3 ) & B90 = { B92 where B92 is (Element of B91) : $2 c= B92 }) implies $1 = ( Intersect B90 ))));
L610:
now
consider C142 being (ManySortedSet of R3) such that L611: C142 in D45 by PBOOLE:134;
let C143 being set;
assume that
L612: C143 in R3;
reconsider D46 = ( ( bool R5 ) . C143 ) as non  empty set by L612;
let C144 being set;
assume that
L613: C144 in ( D45 . C143 );
L614: ( dom ( C142 +* ( C143 .--> C144 ) ) ) = R3 by L612 , PZFMISC1:1;
reconsider D47 = ( C142 +* ( C143 .--> C144 ) ) as (ManySortedSet of R3) by L614 , PARTFUN1:def 2 , RELAT_1:def 18;
L615: ( dom ( C143 .--> C144 ) ) = { C143 } by FUNCOP_1:13;
L616: C143 in { C143 } by TARSKI:def 1;
L617: ( D47 . C143 ) = ( ( C143 .--> C144 ) . C143 ) by L616 , L615 , FUNCT_4:13
.= C144 by FUNCOP_1:72;
L618: D47 is (Element of ( bool R5 ))
proof
let C145 being set;
assume that
L619: C145 in R3;
per cases ;
suppose L620: C145 = C143;

thus L621: thesis by L620 , L613 , L617;
end;
suppose L622: C145 <> C143;

L623: (not C145 in ( dom ( C143 .--> C144 ) )) by L622 , L615 , TARSKI:def 1;
L624: ( D47 . C145 ) = ( C142 . C145 ) by L623 , FUNCT_4:11;
thus L625: thesis by L624 , L611 , L619 , PBOOLE:def 1;
end;
end;
consider C146 being  non-empty (MSSubsetFamily of R5) such that L627: (for B93 being (ManySortedSet of R3) holds (B93 in C146 iff (B93 in C141 & D47 c= B93))) by L618 , L523;
reconsider D48 = ( C146 . C143 ) as (Subset-Family of ( R5 . C143 )) by L612 , MSSUBFAM:32;
reconsider D49 = ( Intersect D48 ) as (Element of D46) by L612 , MBOOLEAN:def 1;
reconsider D50 = ( D46 --> D49 ) as (Function of D46 , D46);
take D51 = ( D50 . C144 );
L628: ( Intersect D48 ) in ( bool ( R5 . C143 ) );
L629: ( Intersect D48 ) in D46 by L628 , L612 , MBOOLEAN:def 1;
thus L630: D51 in ( D45 . C143 ) by L629 , L613 , FUNCOP_1:7;
thus L631: S4[ D51 , C144 , C143 ]
proof
reconsider D52 = ( C141 . C143 ) as non  empty set by L612;
L632: ( C146 . C143 ) = { B94 where B94 is (Element of D52) : ( D47 . C143 ) c= B94 } by L612 , L618 , L627 , L554;
let C147 being (Subset-Family of ( R5 . C143 ));
let C148 being non  empty set;
assume L633: (C148 = ( C141 . C143 ) & C147 = { B95 where B95 is (Element of C148) : C144 c= B95 });
thus L634: thesis by L633 , L613 , L617 , L632 , FUNCOP_1:7;
end;

end;
consider C149 being (ManySortedFunction of D45 , D45) such that L632: (for B96 being set holds (B96 in R3 implies (ex B97 being (Function of ( D45 . B96 ) , ( D45 . B96 )) st (B97 = ( C149 . B96 ) & (for B98 being set holds (B98 in ( D45 . B96 ) implies S4[ ( B97 . B98 ) , B98 , B96 ])))))) from MSSUBFAM:sch 1(L610);
reconsider D53 = C149 as (MSSetOp of R5);
take D53;
let C150 being (Element of ( bool R5 ));
let C151 being  non-empty (MSSubsetFamily of R5);
assume that
L633: (for B99 being (ManySortedSet of R3) holds (B99 in C151 iff (B99 in C141 & C150 c= B99)));
L634:
now
let R1 being set;
assume L635: R1 in R3;
consider C152 being (Subset-Family of ( R5 . R1 )) such that L636: C152 = ( C151 . R1 ) and L637: ( ( meet C151 ) . R1 ) = ( Intersect C152 ) by L635 , MSSUBFAM:def 1;
reconsider D54 = ( C141 . R1 ) as non  empty set by L635;
L638: C152 = { B100 where B100 is (Element of D54) : ( C150 . R1 ) c= B100 } by L633 , L635 , L636 , L554;
L639: C150 in D45 by MSSUBFAM:12;
L640: ( C150 . R1 ) in ( D45 . R1 ) by L639 , L635 , PBOOLE:def 1;
consider C153 being (Function of ( D45 . R1 ) , ( D45 . R1 )) such that L641: C153 = ( D53 . R1 ) and L642: (for R2 being set holds (R2 in ( D45 . R1 ) implies S4[ ( C153 . R2 ) , R2 , R1 ])) by L632 , L635;
L643: ( dom D53 ) = R3 by PARTFUN1:def 2;
thus L644: ( ( D53 .. C150 ) . R1 ) = ( C153 . ( C150 . R1 ) ) by L643 , L635 , L641 , PRALG_1:def 17
.= ( ( meet C151 ) . R1 ) by L642 , L637 , L638 , L640;
end;
thus L645: thesis by L634 , PBOOLE:3;
end;
theorem
L646: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for B101 being  properly-upper-bound (MSSubsetFamily of R5) holds (for B102 being (Element of ( bool R5 )) holds (for B103 being (MSSetOp of R5) holds ((B102 in B101 & (for B104 being (Element of ( bool R5 )) holds (for B105 being  non-empty (MSSubsetFamily of R5) holds ((for B106 being (ManySortedSet of R3) holds (B106 in B105 iff (B106 in B101 & B104 c= B106))) implies ( B103 .. B104 ) = ( meet B105 ))))) implies ( B103 .. B102 ) = B102))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let C154 being  properly-upper-bound (MSSubsetFamily of R5);
let C155 being (Element of ( bool R5 ));
let C156 being (MSSetOp of R5);
assume that
L647: C155 in C154
and
L648: (for B107 being (Element of ( bool R5 )) holds (for B108 being  non-empty (MSSubsetFamily of R5) holds ((for B109 being (ManySortedSet of R3) holds (B109 in B108 iff (B109 in C154 & B107 c= B109))) implies ( C156 .. B107 ) = ( meet B108 ))));
consider C157 being  non-empty (MSSubsetFamily of R5) such that L649: (for B110 being (ManySortedSet of R3) holds (B110 in C157 iff (B110 in C154 & C155 c= B110))) by L523;
L650: C155 in C157 by L647 , L649;
L651: ( meet C157 ) c= C155 by L650 , MSSUBFAM:43;
L652: ( C156 .. C155 ) c= C155 by L651 , L648 , L649;
L653: (for B111 being (ManySortedSet of R3) holds (B111 in C157 implies C155 c= B111)) by L649;
L654: ( C156 .. C155 ) = ( meet C157 ) by L648 , L649;
L655: C155 c= ( C156 .. C155 ) by L654 , L653 , MSSUBFAM:45;
thus L656: ( C156 .. C155 ) = C155 by L655 , L652 , PBOOLE:146;
end;
theorem
L657: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for B112 being  absolutely-multiplicative (MSSubsetFamily of R5) holds (for B113 being (Element of ( bool R5 )) holds (for B114 being (MSSetOp of R5) holds ((( B114 .. B113 ) = B113 & (for B115 being (Element of ( bool R5 )) holds (for B116 being  non-empty (MSSubsetFamily of R5) holds ((for B117 being (ManySortedSet of R3) holds (B117 in B116 iff (B117 in B112 & B115 c= B117))) implies ( B114 .. B115 ) = ( meet B116 ))))) implies B113 in B112))))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let C158 being  absolutely-multiplicative (MSSubsetFamily of R5);
let C159 being (Element of ( bool R5 ));
let C160 being (MSSetOp of R5);
assume that
L658: ( C160 .. C159 ) = C159
and
L659: (for B118 being (Element of ( bool R5 )) holds (for B119 being  non-empty (MSSubsetFamily of R5) holds ((for B120 being (ManySortedSet of R3) holds (B120 in B119 iff (B120 in C158 & B118 c= B120))) implies ( C160 .. B118 ) = ( meet B119 ))));
defpred S5[ (ManySortedSet of R3) ] means C159 c= $1;
consider C161 being  non-empty (MSSubsetFamily of R5) such that L660: (for B121 being (ManySortedSet of R3) holds (B121 in C161 iff (B121 in C158 & C159 c= B121))) by L523;
L661: ((for B122 being (ManySortedSet of R3) holds (B122 in C161 iff (B122 in C158 & S5[ B122 ]))) implies C161 c= C158) from MSSUBSET;
L662: ( C160 .. C159 ) = ( meet C161 ) by L659 , L660;
thus L663: thesis by L662 , L658 , L660 , L661 , MSSUBFAM:def 5;
end;
theorem
L664: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for B123 being  properly-upper-bound (MSSubsetFamily of R5) holds (for B124 being (MSSetOp of R5) holds ((for B125 being (Element of ( bool R5 )) holds (for B126 being  non-empty (MSSubsetFamily of R5) holds ((for B127 being (ManySortedSet of R3) holds (B127 in B126 iff (B127 in B123 & B125 c= B127))) implies ( B124 .. B125 ) = ( meet B126 )))) implies B124 is  reflexive  monotonic)))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let C162 being  properly-upper-bound (MSSubsetFamily of R5);
let C163 being (MSSetOp of R5);
assume that
L665: (for B128 being (Element of ( bool R5 )) holds (for B129 being  non-empty (MSSubsetFamily of R5) holds ((for B130 being (ManySortedSet of R3) holds (B130 in B129 iff (B130 in C162 & B128 c= B130))) implies ( C163 .. B128 ) = ( meet B129 ))));
thus L666: C163 is  reflexive
proof
let C164 being (Element of ( bool R5 ));
consider C165 being  non-empty (MSSubsetFamily of R5) such that L667: (for B131 being (ManySortedSet of R3) holds (B131 in C165 iff (B131 in C162 & C164 c= B131))) by L523;
L668: (( C163 .. C164 ) = ( meet C165 ) & (for B132 being (ManySortedSet of R3) holds (B132 in C165 implies C164 c= B132))) by L665 , L667;
thus L669: thesis by L668 , MSSUBFAM:45;
end;

thus L670: C163 is  monotonic
proof
let C166 , C167 being (Element of ( bool R5 ));
assume that
L671: C166 c= C167;
consider C168 being  non-empty (MSSubsetFamily of R5) such that L672: (for B133 being (ManySortedSet of R3) holds (B133 in C168 iff (B133 in C162 & C166 c= B133))) by L523;
consider C169 being  non-empty (MSSubsetFamily of R5) such that L673: (for B134 being (ManySortedSet of R3) holds (B134 in C169 iff (B134 in C162 & C167 c= B134))) by L523;
L674: C169 c= C168
proof
let R1 being set;
assume L675: R1 in R3;
consider C170 being non  empty set such that L676: C170 = ( C162 . R1 ) by L675;
L677: ( C166 . R1 ) c= ( C167 . R1 ) by L671 , L675 , PBOOLE:def 2;
L678: (( C168 . R1 ) = { B135 where B135 is (Element of C170) : ( C166 . R1 ) c= B135 } & ( C169 . R1 ) = { B136 where B136 is (Element of C170) : ( C167 . R1 ) c= B136 }) by L672 , L673 , L675 , L676 , L554;
thus L679: thesis by L678 , L677 , L20;
end;
L680: ( meet C168 ) c= ( meet C169 ) by L674 , MSSUBFAM:46;
L681: ( C163 .. C166 ) = ( meet C168 ) by L665 , L672;
thus L682: thesis by L681 , L665 , L673 , L680;
end;

end;
theorem
L671: (for R3 being set holds (for R5 being (ManySortedSet of R3) holds (for B137 being  absolutely-multiplicative (MSSubsetFamily of R5) holds (for B138 being (MSSetOp of R5) holds ((for B139 being (Element of ( bool R5 )) holds (for B140 being  non-empty (MSSubsetFamily of R5) holds ((for B141 being (ManySortedSet of R3) holds (B141 in B140 iff (B141 in B137 & B139 c= B141))) implies ( B138 .. B139 ) = ( meet B140 )))) implies B138 is  idempotent)))))
proof
let R3 being set;
let R5 being (ManySortedSet of R3);
let C171 being  absolutely-multiplicative (MSSubsetFamily of R5);
let C172 being (MSSetOp of R5);
assume that
L672: (for B142 being (Element of ( bool R5 )) holds (for B143 being  non-empty (MSSubsetFamily of R5) holds ((for B144 being (ManySortedSet of R3) holds (B144 in B143 iff (B144 in C171 & B142 c= B144))) implies ( C172 .. B142 ) = ( meet B143 ))));
let C173 being (Element of ( bool R5 ));
defpred S6[ (ManySortedSet of R3) ] means C173 c= $1;
consider C174 being  non-empty (MSSubsetFamily of R5) such that L673: (for B145 being (ManySortedSet of R3) holds (B145 in C174 iff (B145 in C171 & C173 c= B145))) by L523;
L674: ((for B146 being (ManySortedSet of R3) holds (B146 in C174 iff (B146 in C171 & S6[ B146 ]))) implies C174 c= C171) from MSSUBSET;
L675: ( meet C174 ) in C171 by L674 , L673 , MSSUBFAM:def 5;
L676: C171 c= ( bool R5 ) by PBOOLE:def 18;
L677: ( meet C174 ) is (Element of ( bool R5 )) by L676 , L675 , MSSUBFAM:11 , PBOOLE:9;
thus L678: ( C172 .. C173 ) = ( meet C174 ) by L672 , L673
.= ( C172 .. ( meet C174 ) ) by L672 , L675 , L677 , L646
.= ( C172 .. ( C172 .. C173 ) ) by L672 , L673;
end;
theorem
L679: (for R12 being 1-sorted holds (for B147 being (MSClosureSystem of R12) holds (for B148 being (MSSetOp of (the Sorts of B147)) holds ((for B149 being (Element of ( bool (the Sorts of B147) )) holds (for B150 being  non-empty (MSSubsetFamily of (the Sorts of B147)) holds ((for B151 being (ManySortedSet of (the carrier of R12)) holds (B151 in B150 iff (B151 in (the Family of B147) & B149 c= B151))) implies ( B148 .. B149 ) = ( meet B150 )))) implies B148 is (MSClosureOperator of (the Sorts of B147)))))) by L664 , L671;
definition
let R12 being 1-sorted;
let C175 being (ManySortedSet of (the carrier of R12));
let C176 being (MSClosureOperator of C175);
func ClOp->ClSys C176 -> (MSClosureSystem of R12) means 
:L680: (ex B152 being (MSSubsetFamily of C175) st (B152 = ( MSFixPoints C176 ) & it = MSClosureStr (# C175 , B152 #)));
existence
proof
reconsider D55 = ( MSFixPoints C176 ) as (MSSubsetFamily of C175);
reconsider D56 = MSClosureStr (# C175 , D55 #) as (MSClosureSystem of R12) by L498;
take D56;
thus L681: thesis;
end;
uniqueness;
end;
registration
let R12 being 1-sorted;
let C177 being (ManySortedSet of (the carrier of R12));
let C178 being (MSClosureOperator of C177);
cluster ( ClOp->ClSys C178 ) ->  strict;
coherence
proof
L683: (ex B153 being (MSSubsetFamily of C177) st (B153 = ( MSFixPoints C178 ) & ( ClOp->ClSys C178 ) = MSClosureStr (# C177 , B153 #))) by L680;
thus L684: thesis by L683;
end;
end;
registration
let R12 being 1-sorted;
let C179 being  non-empty (ManySortedSet of (the carrier of R12));
let C180 being (MSClosureOperator of C179);
cluster ( ClOp->ClSys C180 ) ->  non-empty;
coherence
proof
L686: (ex B154 being (MSSubsetFamily of C179) st (B154 = ( MSFixPoints C180 ) & ( ClOp->ClSys C180 ) = MSClosureStr (# C179 , B154 #))) by L680;
thus L687: thesis by L686;
end;
end;
definition
let R12 being 1-sorted;
let C181 being (MSClosureSystem of R12);
func ClSys->ClOp C181 -> (MSClosureOperator of (the Sorts of C181)) means 
:L689: (for B155 being (Element of ( bool (the Sorts of C181) )) holds (for B156 being  non-empty (MSSubsetFamily of (the Sorts of C181)) holds ((for B157 being (ManySortedSet of (the carrier of R12)) holds (B157 in B156 iff (B157 in (the Family of C181) & B155 c= B157))) implies ( it .. B155 ) = ( meet B156 ))));
existence
proof
consider C182 being (MSSetOp of (the Sorts of C181)) such that L690: (for B158 being (Element of ( bool (the Sorts of C181) )) holds (for B159 being  non-empty (MSSubsetFamily of (the Sorts of C181)) holds ((for B160 being (ManySortedSet of (the carrier of R12)) holds (B160 in B159 iff (B160 in (the Family of C181) & B158 c= B160))) implies ( C182 .. B158 ) = ( meet B159 )))) by L609;
reconsider D57 = C182 as (MSClosureOperator of (the Sorts of C181)) by L690 , L664 , L671;
take D57;
thus L691: thesis by L690;
end;
uniqueness
proof
set D58 = (the Sorts of C181);
let C183 , C184 being (MSClosureOperator of (the Sorts of C181));
assume that
L692: (for B161 being (Element of ( bool (the Sorts of C181) )) holds (for B162 being  non-empty (MSSubsetFamily of (the Sorts of C181)) holds ((for B163 being (ManySortedSet of (the carrier of R12)) holds (B163 in B162 iff (B163 in (the Family of C181) & B161 c= B163))) implies ( C183 .. B161 ) = ( meet B162 ))))
and
L693: (for B164 being (Element of ( bool (the Sorts of C181) )) holds (for B165 being  non-empty (MSSubsetFamily of (the Sorts of C181)) holds ((for B166 being (ManySortedSet of (the carrier of R12)) holds (B166 in B165 iff (B166 in (the Family of C181) & B164 c= B166))) implies ( C184 .. B164 ) = ( meet B165 ))));
L694:
now
let C185 being (ManySortedSet of (the carrier of R12));
assume L695: C185 in ( bool D58 );
L696: C185 is (Element of ( bool D58 )) by L695 , MSSUBFAM:11;
consider C186 being  non-empty (MSSubsetFamily of (the Sorts of C181)) such that L697: (for B167 being (ManySortedSet of (the carrier of R12)) holds (B167 in C186 iff (B167 in (the Family of C181) & C185 c= B167))) by L696 , L523;
thus L698: ( C183 .. C185 ) = ( meet C186 ) by L692 , L696 , L697
.= ( C184 .. C185 ) by L693 , L696 , L697;
end;
thus L699: C183 = C184 by L694 , L114;
end;
end;
theorem
L701: (for R12 being 1-sorted holds (for B168 being (ManySortedSet of (the carrier of R12)) holds (for B169 being (MSClosureOperator of B168) holds ( ClSys->ClOp ( ClOp->ClSys B169 ) ) = B169)))
proof
let R12 being 1-sorted;
let C187 being (ManySortedSet of (the carrier of R12));
let C188 being (MSClosureOperator of C187);
set D59 = (the carrier of R12);
set D60 = (the Sorts of ( ClOp->ClSys C188 ));
set D61 = ( ClSys->ClOp ( ClOp->ClSys C188 ) );
L702: (ex B170 being (MSSubsetFamily of C187) st (B170 = ( MSFixPoints C188 ) & ( ClOp->ClSys C188 ) = MSClosureStr (# C187 , B170 #))) by L680;
L703: (for B171 being (ManySortedSet of D59) holds (B171 in ( bool C187 ) implies ( D61 .. B171 ) = ( C188 .. B171 )))
proof
let C189 being (ManySortedSet of D59);
assume L704: C189 in ( bool C187 );
L705: C189 is (Element of ( bool D60 )) by L704 , L702 , MSSUBFAM:11;
consider C190 being  non-empty (MSSubsetFamily of D60) such that L706: (for B172 being (ManySortedSet of D59) holds (B172 in C190 iff (B172 in ( MSFixPoints C188 ) & C189 c= B172))) by L705 , L702 , L523;
L707:
now
L708: ( dom C188 ) = D59 by PARTFUN1:def 2;
let R1 being set;
assume that
L709: R1 in D59;
reconsider D62 = ( C188 . R1 ) as (Function of ( ( bool C187 ) . R1 ) , ( ( bool C187 ) . R1 )) by L709 , PBOOLE:def 15;
L710: ( ( bool C187 ) . R1 ) = ( bool ( C187 . R1 ) ) by L709 , MBOOLEAN:def 1;
reconsider D63 = D62 as (Function of ( bool ( C187 . R1 ) ) , ( bool ( C187 . R1 ) )) by L710;
L711: ( C189 . R1 ) is (Element of ( ( bool C187 ) . R1 )) by L702 , L705 , L709 , PBOOLE:def 14;
L712: ( C189 . R1 ) is (Element of ( bool ( C187 . R1 ) )) by L711 , L709 , MBOOLEAN:def 1;
L713: ( C189 . R1 ) c= ( D63 . ( C189 . R1 ) ) by L712 , L709 , L333;
reconsider D64 = ( ( MSFixPoints C188 ) . R1 ) as non  empty set by L702 , L709;
consider C191 being (Subset-Family of ( D60 . R1 )) such that L714: C191 = ( C190 . R1 ) and L715: ( ( meet C190 ) . R1 ) = ( Intersect C191 ) by L709 , MSSUBFAM:def 1;
L716: ( C190 . R1 ) = { B173 where B173 is (Element of D64) : ( C189 . R1 ) c= B173 } by L702 , L705 , L706 , L709 , L554;
L717:
now
let R2 being set;
assume L718: R2 in C191;
consider C192 being (Element of D64) such that L719: (C192 = R2 & ( C189 . R1 ) c= C192) by L718 , L714 , L716;
L720: ( MSFixPoints C188 ) c= ( bool C187 ) by PBOOLE:def 18;
L721: D64 c= ( ( bool C187 ) . R1 ) by L720 , L709 , PBOOLE:def 2;
L722: D64 c= ( bool ( C187 . R1 ) ) by L721 , L709 , MBOOLEAN:def 1;
L723: C192 is (Element of ( bool ( C187 . R1 ) )) by L722 , TARSKI:def 3;
L724: (ex B174 being Function st (B174 = ( C188 . R1 ) & C192 in ( dom B174 ) & ( B174 . C192 ) = C192)) by L709 , L440;
thus L725: ( D63 . ( C189 . R1 ) ) c= R2 by L724 , L709 , L712 , L719 , L723 , L345;
end;
L726: ( D63 . ( C189 . R1 ) ) c= ( Intersect C191 ) by L717 , L709 , L714 , MSSUBFAM:5;
L727: (( dom D63 ) = ( bool ( C187 . R1 ) ) & ( D63 . ( C189 . R1 ) ) in ( bool ( C187 . R1 ) )) by L712 , FUNCT_2:5 , FUNCT_2:def 1;
L728: ( D63 . ( D63 . ( C189 . R1 ) ) ) = ( D63 . ( C189 . R1 ) ) by L709 , L712 , L373;
L729: ( D63 . ( C189 . R1 ) ) is (Element of D64) by L728 , L709 , L727 , L440;
L730: ( D63 . ( C189 . R1 ) ) in { B175 where B175 is (Element of D64) : ( C189 . R1 ) c= B175 } by L729 , L713;
L731: ( Intersect C191 ) c= ( D63 . ( C189 . R1 ) ) by L730 , L714 , L716 , MSSUBFAM:2;
L732: ( Intersect C191 ) = ( D63 . ( C189 . R1 ) ) by L731 , L726 , XBOOLE_0:def 10;
thus L733: ( ( D61 .. C189 ) . R1 ) = ( D63 . ( C189 . R1 ) ) by L732 , L702 , L705 , L706 , L715 , L689
.= ( ( C188 .. C189 ) . R1 ) by L709 , L708 , PRALG_1:def 17;
end;
thus L734: thesis by L707 , PBOOLE:3;
end;
thus L735: thesis by L703 , L702 , L114;
end;
theorem
L736: (for R12 being 1-sorted holds (for B176 being (MSClosureSystem of R12) holds ( ClOp->ClSys ( ClSys->ClOp B176 ) ) = ( the MSClosureStr of B176 )))
proof
let R12 being 1-sorted;
let C193 being (MSClosureSystem of R12);
set D65 = (the Sorts of C193);
set D66 = (the Family of C193);
set D67 = (the carrier of R12);
consider C194 being (ManySortedSet of D67) such that L737: C194 in ( bool D65 ) by PBOOLE:134;
L738: D66 = ( MSFixPoints ( ClSys->ClOp C193 ) )
proof
L739: ( dom ( ClSys->ClOp C193 ) ) = D67 by PARTFUN1:def 2;
let R1 being set;
assume that
L740: R1 in D67;
reconsider D68 = ( ( ClSys->ClOp C193 ) . R1 ) as (Function of ( ( bool D65 ) . R1 ) , ( ( bool D65 ) . R1 )) by L740 , PBOOLE:def 15;
reconsider D69 = ( D66 . R1 ) as non  empty set by L740;
thus L741: ( D66 . R1 ) c= ( ( MSFixPoints ( ClSys->ClOp C193 ) ) . R1 )
proof
let R2 being set;
assume that
L742: R2 in ( D66 . R1 );
L743: ( dom ( C194 +* ( R1 .--> R2 ) ) ) = D67 by L740 , PZFMISC1:1;
reconsider D70 = ( C194 +* ( R1 .--> R2 ) ) as (ManySortedSet of D67) by L743 , PARTFUN1:def 2 , RELAT_1:def 18;
L744: ( dom ( R1 .--> R2 ) ) = { R1 } by FUNCOP_1:13;
L745: D66 c= ( bool D65 ) by PBOOLE:def 18;
L746: ( D66 . R1 ) c= ( ( bool D65 ) . R1 ) by L745 , L740 , PBOOLE:def 2;
L747: R2 in ( ( bool D65 ) . R1 ) by L746 , L742;
L748: R2 in ( dom D68 ) by L747 , FUNCT_2:def 1;
L749: R1 in { R1 } by TARSKI:def 1;
L750: ( D70 . R1 ) = ( ( R1 .--> R2 ) . R1 ) by L749 , L744 , FUNCT_4:13
.= R2 by FUNCOP_1:72;
L751: D70 is (Element of ( bool D65 ))
proof
let C195 being set;
assume that
L752: C195 in D67;
per cases ;
suppose L753: C195 = R1;

thus L754: thesis by L753 , L742 , L750 , L746;
end;
suppose L755: C195 <> R1;

L756: (not C195 in ( dom ( R1 .--> R2 ) )) by L755 , L744 , TARSKI:def 1;
L757: ( D70 . C195 ) = ( C194 . C195 ) by L756 , FUNCT_4:11;
thus L758: thesis by L757 , L737 , L752 , PBOOLE:def 1;
end;
end;
reconsider D71 = D70 as (Element of ( bool D65 )) by L751;
consider C196 being  non-empty (MSSubsetFamily of D65) such that L760: (for B177 being (ManySortedSet of D67) holds (B177 in C196 iff (B177 in D66 & D71 c= B177))) by L523;
consider C197 being (Subset-Family of ( D65 . R1 )) such that L761: C197 = ( C196 . R1 ) and L762: ( ( meet C196 ) . R1 ) = ( Intersect C197 ) by L740 , MSSUBFAM:def 1;
L763: ( C196 . R1 ) = { B178 where B178 is (Element of D69) : ( D71 . R1 ) c= B178 } by L740 , L760 , L554;
L764:
now
let C198 being set;
assume L765: C198 in C197;
L766: (ex B179 being (Element of D69) st (B179 = C198 & ( D71 . R1 ) c= B179)) by L765 , L761 , L763;
thus L767: R2 c= C198 by L766 , L750;
end;
L768: R2 c= ( Intersect C197 ) by L764 , L740 , L761 , MSSUBFAM:5;
L769: R2 in { B180 where B180 is (Element of D69) : R2 c= B180 } by L742;
L770: ( Intersect C197 ) c= R2 by L769 , L750 , L761 , L763 , MSSUBFAM:2;
L771: ( Intersect C197 ) = R2 by L770 , L768 , XBOOLE_0:def 10;
L772: ( ( ClSys->ClOp C193 ) .. D71 ) = ( meet C196 ) by L760 , L689;
L773: ( D68 . R2 ) = R2 by L772 , L740 , L750 , L762 , L771 , L739 , PRALG_1:def 17;
thus L774: thesis by L773 , L740 , L748 , L440;
end;

let R2 being set;
assume L775: R2 in ( ( MSFixPoints ( ClSys->ClOp C193 ) ) . R1 );
L776: (ex B181 being Function st (B181 = ( ( ClSys->ClOp C193 ) . R1 ) & R2 in ( dom B181 ) & ( B181 . R2 ) = R2)) by L775 , L740 , L440;
L777: ( dom ( C194 +* ( R1 .--> R2 ) ) ) = D67 by L740 , PZFMISC1:1;
reconsider D72 = ( C194 +* ( R1 .--> R2 ) ) as (ManySortedSet of D67) by L777 , PARTFUN1:def 2 , RELAT_1:def 18;
L778: ( dom ( R1 .--> R2 ) ) = { R1 } by FUNCOP_1:13;
L779: R1 in { R1 } by TARSKI:def 1;
L780: ( D72 . R1 ) = ( ( R1 .--> R2 ) . R1 ) by L779 , L778 , FUNCT_4:13
.= R2 by FUNCOP_1:72;
L781: ( MSFixPoints ( ClSys->ClOp C193 ) ) c= ( bool D65 ) by PBOOLE:def 18;
L782: ( ( MSFixPoints ( ClSys->ClOp C193 ) ) . R1 ) c= ( ( bool D65 ) . R1 ) by L781 , L740 , PBOOLE:def 2;
L783: D72 is (Element of ( bool D65 ))
proof
let C199 being set;
assume that
L784: C199 in D67;
per cases ;
suppose L785: C199 = R1;

thus L786: thesis by L785 , L775 , L780 , L782;
end;
suppose L787: C199 <> R1;

L788: (not C199 in ( dom ( R1 .--> R2 ) )) by L787 , L778 , TARSKI:def 1;
L789: ( D72 . C199 ) = ( C194 . C199 ) by L788 , FUNCT_4:11;
thus L790: thesis by L789 , L737 , L784 , PBOOLE:def 1;
end;
end;
reconsider D73 = D72 as (Element of ( bool D65 )) by L783;
defpred S7[ (ManySortedSet of D67) ] means D73 c= $1;
consider C200 being  non-empty (MSSubsetFamily of D65) such that L792: (for B182 being (ManySortedSet of D67) holds (B182 in C200 iff (B182 in D66 & D73 c= B182))) by L523;
L793: ( dom ( ClSys->ClOp C193 ) ) = D67 by PARTFUN1:def 2;
L794: ((for B183 being (ManySortedSet of D67) holds (B183 in C200 iff (B183 in D66 & S7[ B183 ]))) implies C200 c= D66) from MSSUBSET;
L795: ( meet C200 ) in D66 by L794 , L792 , MSSUBFAM:def 5;
L796: ( ( meet C200 ) . R1 ) = ( ( ( ClSys->ClOp C193 ) .. D73 ) . R1 ) by L792 , L689
.= R2 by L740 , L776 , L780 , L793 , PRALG_1:def 17;
thus L797: thesis by L796 , L740 , L795 , PBOOLE:def 1;
end;
thus L798: thesis by L738 , L680;
end;
