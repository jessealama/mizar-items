:: Definition and Some Properties of Information Entropy
::  by Bo Zhang and Yatsuka Nakamura
::
:: Received July 9, 2007
:: Copyright (c) 2007-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, XBOOLE_0, SUBSET_1, NAT_1, REAL_1, FINSEQ_1, MATRIX_1,
      CARD_1, ARYTM_3, XXREAL_0, INT_1, ARYTM_1, RELAT_1, TAYLOR_1, FUNCT_1,
      XXREAL_1, LIMFUNC1, POWER, PARTFUN1, FDIFF_1, ORDINAL2, TARSKI, CARD_3,
      SEQ_1, SUPINF_2, PARTFUN3, XREAL_0, ORDINAL1, RVSUM_1, ORDINAL4,
      FINSEQ_2, MATRPROB, MATRIXC1, TREES_1, INCSP_1, MATRIXR1, FVSUM_1,
      ZFMISC_1, FUNCOP_1, ENTROPY1;
 notations TARSKI, SUBSET_1, XBOOLE_0, XXREAL_0, XREAL_0, REAL_1, ORDINAL1,
      NAT_1, NAT_D, NUMBERS, RELAT_1, FUNCT_1, VALUED_1, SEQ_1, ZFMISC_1,
      PARTFUN1, FUNCOP_1, RVSUM_1, FINSEQ_1, NEWTON, FINSEQ_2, MATRIXR1,
      MATRIX_1, PARTFUN3, POWER, LIMFUNC1, RCOMP_1, MATRPROB, FDIFF_1,
      TAYLOR_1, FCONT_1;
 constructors REAL_1, NAT_D, BINOP_2, MATRIX_3, MATRIXR1, MATRLIN, MATRPROB,
      PARTFUN3, PARTFUN2, FDIFF_1, FCONT_1, POWER, LIMFUNC1, SIN_COS, TAYLOR_1,
      INTEGRA1, SEQ_1, XXREAL_2, RVSUM_1, RELSET_1, NEWTON;
 registrations MATRPROB, RELSET_1, NAT_1, MEMBERED, ORDINAL1, XREAL_0, FCONT_3,
      RCOMP_1, XXREAL_0, NUMBERS, XBOOLE_0, VALUED_0, FINSEQ_1, CARD_1,
      XXREAL_2, FINSEQ_2, RVSUM_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, PARTFUN3, FINSEQ_2, LIMFUNC1, RCOMP_1, VALUED_1, XCMPLX_0,
      TAYLOR_1;
 theorems FUNCT_1, NAT_1, MATRIX_2, XREAL_1, NAT_2, MATRIXR1, GOBOARD1,
      XBOOLE_0, PROB_3, INTEGRA5, FINSEQ_1, MATRIX_1, FINSEQ_2, PARTFUN3,
      FINSEQ_3, RVSUM_1, POWER, FDIFF_1, TREES_1, XBOOLE_1, TAYLOR_1, RELAT_1,
      ROLLE, FCONT_1, XCMPLX_1, INTEGRA1, XXREAL_0, ORDINAL1, MATRPROB,
      FUNCOP_1, PEPIN, NAT_D, PARTFUN1, VALUED_1, XXREAL_1, XXREAL_2, CARD_1;
 schemes FINSEQ_2, SEQ_1, NAT_1, RECDEF_1, FINSEQ_1, MATRIX_1;

begin
theorem
L1: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (for R4 being (Element of ( NAT )) holds (for R5 being (Element of ( NAT )) holds ((R4 <> ( 0 ) & R2 < R5 & R5 <= R3 & R4 divides R5) implies ( R2 div R4 ) < ( R3 div R4 ))))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
let R4 being (Element of ( NAT ));
let R5 being (Element of ( NAT ));
assume that
L2: R4 <> ( 0 )
and
L3: R2 < R5
and
L4: R5 <= R3
and
L5: R4 divides R5;
L6: ( R5 mod R4 ) = ( 0 ) by L2 , L5 , PEPIN:6;
L7: ( R2 + ( R2 mod R4 ) ) >= R2 by NAT_1:11;
L8: ( R2 - ( R2 mod R4 ) ) <= ( ( R2 + ( R2 mod R4 ) ) - ( R2 mod R4 ) ) by L7 , XREAL_1:9;
L9: ( R2 - ( R2 mod R4 ) ) < R5 by L8 , L3 , XXREAL_0:2;
L10: ( ( R2 - ( R2 mod R4 ) ) / R4 ) < ( R5 / R4 ) by L9 , L2 , XREAL_1:74;
L11: R2 = ( ( R4 * ( R2 div R4 ) ) + ( R2 mod R4 ) ) by L2 , NAT_D:2;
L12: ( ( R4 / R4 ) * ( R2 div R4 ) ) = ( ( R2 - ( R2 mod R4 ) ) / R4 ) by L11;
L13: ( 1 * ( R2 div R4 ) ) = ( ( R2 - ( R2 mod R4 ) ) / R4 ) by L12 , L2 , XCMPLX_1:60;
L14: R5 = ( ( R4 * ( R5 div R4 ) ) + ( R5 mod R4 ) ) by L2 , NAT_D:2
.= ( R4 * ( R5 div R4 ) ) by L6;
L15: ( ( R4 / R4 ) * ( R5 div R4 ) ) = ( R5 / R4 ) by L14;
L16: ( 1 * ( R5 div R4 ) ) = ( R5 / R4 ) by L15 , L2 , XCMPLX_1:60;
L17: ( R5 div R4 ) <= ( R3 div R4 ) by L4 , NAT_2:24;
thus L18: thesis by L17 , L16 , L13 , L10 , XXREAL_0:2;
end;
theorem
L19: (for R11 being Real holds (R11 > ( 0 ) implies (( ( ln ) . R11 ) <= ( R11 - 1 ) & (R11 = 1 iff ( ( ln ) . R11 ) = ( R11 - 1 )) & (R11 <> 1 iff ( ( ln ) . R11 ) < ( R11 - 1 )))))
proof
let R11 being Real;
set D1 = ]. ( 0 ) , 1 .[;
set D2 = ( right_open_halfline 1 );
reconsider D3 = ( log_ ( number_e ) ) as (PartFunc of ( REAL ) , ( REAL ));
deffunc H1(Real) = ( $1 - 1 );
defpred S1[ set ] means $1 in ( REAL );
set D4 = ( right_open_halfline ( 0 ) );
L20: 1 in D4 by XXREAL_1:235;
L21: 1 in { B1 where B1 is Real : ( 0 ) < B1 };
L22: 1 in D4 by L21 , XXREAL_1:230;
consider C1 being (PartFunc of ( REAL ) , ( REAL )) such that L23: ((for R11 being Real holds (R11 in ( dom C1 ) iff S1[ R11 ])) & (for R11 being Real holds (R11 in ( dom C1 ) implies ( C1 . R11 ) = H1(R11)))) from SEQ_1:sch 3;
L24: ( dom C1 ) is (Subset of ( REAL )) by RELAT_1:def 18;
L25: ( dom C1 ) = ( REAL ) by L24 , L23 , FDIFF_1:1;
L26: (for R11 being Real holds (R11 in D4 implies ( C1 . R11 ) = ( ( 1 * R11 ) + ( - 1 ) )))
proof
let R11 being Real;
assume that
L27: R11 in D4;
L28: ( C1 . R11 ) = ( R11 - 1 ) by L23;
thus L29: thesis by L28;
end;
L30: C1 is_differentiable_on D4 by L26 , L25 , FDIFF_1:23;
set D5 = ( C1 - D3 );
L31: ( number_e ) <> 1 by TAYLOR_1:11;
assume L32: R11 > ( 0 );
L33: ( dom D3 ) = D4 by TAYLOR_1:def 2;
L34: ( dom D5 ) = ( D4 /\ ( REAL ) ) by L33 , L25 , VALUED_1:12
.= D4 by XBOOLE_1:28;
L35: (for B2 being Real holds (B2 > ( 0 ) implies ( D5 . B2 ) = ( ( B2 - 1 ) - ( ( ln ) . B2 ) )))
proof
let C2 being Real;
assume L36: C2 > ( 0 );
L37: C2 in { B3 where B3 is Real : ( 0 ) < B3 } by L36;
L38: C2 in ( dom D5 ) by L37 , L34 , XXREAL_1:230;
L39: ( D5 . C2 ) = ( ( C1 . C2 ) - ( D3 . C2 ) ) by L38 , VALUED_1:13;
thus L40: thesis by L39 , L23;
end;
L41: ( D5 . 1 ) = ( ( 1 - 1 ) - ( ( ln ) . 1 ) ) by L35
.= ( - ( log (( number_e ) , 1) ) ) by L22 , TAYLOR_1:def 2
.= ( - ( 0 ) ) by L31 , POWER:51 , TAYLOR_1:11
.= ( 0 );
L42: C1 is_differentiable_on D4 by L25 , L26 , FDIFF_1:23;
L43:
now
let R11 being Real;
assume that
L44: R11 in D4;
thus L45: ( diff (C1 , R11) ) = ( ( C1 `| D4 ) . R11 ) by L42 , L44 , FDIFF_1:def 7
.= 1 by L25 , L26 , L44 , FDIFF_1:23;
end;
L46: (D5 is_differentiable_on D4 & (for R11 being Real holds (R11 in D4 implies ( diff (D5 , R11) ) = ( 1 - ( 1 / R11 ) ))))
proof
thus L47: D5 is_differentiable_on D4 by L34 , L30 , FDIFF_1:19 , TAYLOR_1:18;
thus L48:now
let R11 being Real;
assume that
L49: R11 in D4;
L50: ( ( ( C1 - D3 ) `| D4 ) . R11 ) = ( ( diff (C1 , R11) ) - ( diff (D3 , R11) ) ) by L34 , L30 , L49 , FDIFF_1:19 , TAYLOR_1:18
.= ( 1 - ( diff (D3 , R11) ) ) by L43 , L49
.= ( 1 - ( 1 / R11 ) ) by L49 , TAYLOR_1:18;
thus L51: ( diff (D5 , R11) ) = ( 1 - ( 1 / R11 ) ) by L50 , L47 , L49 , FDIFF_1:def 7;
end;
end;
L49: ( D5 | D4 ) is  continuous by L46 , FDIFF_1:25;
L50: D2 c= D4 by XXREAL_1:46;
L51: (for R11 being Real holds (R11 in D2 implies ( diff (D5 , R11) ) > ( 0 )))
proof
let R11 being Real;
assume that
L52: R11 in D2;
L53: R11 in { B4 where B4 is Real : 1 < B4 } by L52 , XXREAL_1:230;
L54: (ex B5 being Real st (B5 = R11 & 1 < B5)) by L53;
L55: ( diff (D5 , R11) ) = ( 1 - ( 1 / R11 ) ) by L46 , L50 , L52;
thus L56: thesis by L55 , L54 , XREAL_1:50 , XREAL_1:212;
end;
L57: (for R11 being Real holds (R11 in D2 implies ( D5 . R11 ) > ( 0 )))
proof
assume L58: (not (for R11 being Real holds (R11 in D2 implies ( D5 . R11 ) > ( 0 ))));
consider R12 being Real such that L59: R12 in D2 and L60: ( D5 . R12 ) <= ( 0 ) by L58;
L61: [. 1 , R12 .] c= ( dom D5 ) by L20 , L34 , L50 , L59 , XXREAL_2:def 12;
L62: R12 in { B6 where B6 is Real : 1 < B6 } by L59 , XXREAL_1:230;
L63: (ex B7 being Real st (B7 = R12 & 1 < B7)) by L62;
L64: D5 is_differentiable_on ]. 1 , R12 .[ by L46 , FDIFF_1:26 , XXREAL_1:247;
L65: ( D5 | [. 1 , R12 .] ) is  continuous by L49 , FCONT_1:16 , XXREAL_1:249;
per cases  by L60;
suppose L66: ( D5 . R12 ) = ( 0 );

consider C3 being Real such that L67: C3 in ]. 1 , R12 .[ and L68: ( diff (D5 , C3) ) = ( 0 ) by L66 , L41 , L63 , L65 , L64 , L61 , ROLLE:1;
L69: (ex B8 being Real st (B8 = C3 & 1 < B8 & B8 < R12)) by L67;
L70: C3 in { B9 where B9 is Real : 1 < B9 } by L69;
L71: C3 in D2 by L70 , XXREAL_1:230;
thus L72: contradiction by L71 , L51 , L68;
end;
suppose L73: ( D5 . R12 ) < ( 0 );

consider C4 being Real such that L74: C4 in ]. 1 , R12 .[ and L75: ( diff (D5 , C4) ) = ( ( ( D5 . R12 ) - ( D5 . 1 ) ) / ( R12 - 1 ) ) by L63 , L65 , L64 , L61 , ROLLE:3;
L76: (ex B10 being Real st (B10 = C4 & 1 < B10 & B10 < R12)) by L74;
L77: C4 in { B11 where B11 is Real : 1 < B11 } by L76;
L78: C4 in D2 by L77 , XXREAL_1:230;
L79: ( R12 - 1 ) > ( 0 ) by L63 , XREAL_1:50;
thus L80: contradiction by L79 , L41 , L51 , L73 , L75 , L78;
end;
end;
L82: (for R11 being Real holds (R11 > 1 implies ( D5 . R11 ) > ( 0 )))
proof
let R11 being Real;
assume L83: R11 > 1;
L84: R11 in { B12 where B12 is Real : 1 < B12 } by L83;
L85: R11 in D2 by L84 , XXREAL_1:230;
thus L86: thesis by L85 , L57;
end;
L87: D1 c= D4 by XXREAL_1:247;
L88: (for R11 being Real holds (R11 in D1 implies ( diff (D5 , R11) ) < ( 0 )))
proof
let R11 being Real;
assume L89: R11 in D1;
L90: (ex B13 being Real st (B13 = R11 & ( 0 ) < B13 & B13 < 1)) by L89;
L91: 1 < ( 1 / R11 ) by L90 , XREAL_1:187;
L92: ( diff (D5 , R11) ) = ( 1 - ( 1 / R11 ) ) by L46 , L87 , L89;
thus L93: thesis by L92 , L91 , XREAL_1:49;
end;
L94: (for R11 being Real holds (R11 in D1 implies ( D5 . R11 ) > ( 0 )))
proof
assume L95: (not (for R11 being Real holds (R11 in D1 implies ( D5 . R11 ) > ( 0 ))));
consider R12 being Real such that L96: R12 in D1 and L97: ( D5 . R12 ) <= ( 0 ) by L95;
L98: [. R12 , 1 .] c= ( dom D5 ) by L20 , L34 , L87 , L96 , XXREAL_2:def 12;
L99: (ex B14 being Real st (B14 = R12 & ( 0 ) < B14 & B14 < 1)) by L96;
L100: ( D5 | [. R12 , 1 .] ) is  continuous by L99 , L49 , FCONT_1:16 , XXREAL_1:249;
L101: D5 is_differentiable_on ]. R12 , 1 .[ by L46 , L99 , FDIFF_1:26 , XXREAL_1:247;
per cases  by L97;
suppose L102: ( D5 . R12 ) = ( 0 );

consider C5 being Real such that L103: C5 in ]. R12 , 1 .[ and L104: ( diff (D5 , C5) ) = ( 0 ) by L102 , L41 , L99 , L100 , L98 , L101 , ROLLE:1;
L105: (ex B15 being Real st (B15 = C5 & R12 < B15 & B15 < 1)) by L103;
L106: C5 in { B16 where B16 is Real : (( 0 ) < B16 & B16 < 1) } by L105 , L99;
thus L107: contradiction by L106 , L88 , L104;
end;
suppose L108: ( D5 . R12 ) < ( 0 );

L109: ( 1 - R12 ) > ( 0 ) by L99 , XREAL_1:50;
consider C6 being Real such that L110: C6 in ]. R12 , 1 .[ and L111: ( diff (D5 , C6) ) = ( ( ( D5 . 1 ) - ( D5 . R12 ) ) / ( 1 - R12 ) ) by L99 , L100 , L98 , L101 , ROLLE:3;
L112: (ex B17 being Real st (B17 = C6 & R12 < B17 & B17 < 1)) by L110;
L113: C6 in D1 by L112 , L99;
thus L114: contradiction by L113 , L41 , L88 , L108 , L111 , L109;
end;
end;
L116: (for R11 being Real holds ((R11 > ( 0 ) & R11 < 1) implies ( D5 . R11 ) > ( 0 )))
proof
let R11 being Real;
assume that
L117: R11 > ( 0 )
and
L118: R11 < 1;
L119: R11 in { B18 where B18 is Real : (( 0 ) < B18 & B18 < 1) } by L117 , L118;
thus L120: thesis by L119 , L94;
end;
L121: (for R11 being Real holds (R11 > ( 0 ) implies ( D5 . R11 ) >= ( 0 )))
proof
let R11 being Real;
assume that
L122: R11 > ( 0 );
per cases  by XXREAL_0:1;
suppose L123: R11 < 1;

thus L124: thesis by L123 , L116 , L122;
end;
suppose L125: R11 = 1;

thus L126: thesis by L125 , L41;
end;
suppose L127: R11 > 1;

thus L128: thesis by L127 , L82;
end;
end;
L130: ( D5 . R11 ) >= ( 0 ) by L121 , L32;
L131: ( ( R11 - 1 ) - ( ( ln ) . R11 ) ) >= ( 0 ) by L130 , L35 , L32;
L132: ( ( R11 - 1 ) - ( 0 ) ) >= ( ( ln ) . R11 ) by L131 , XREAL_1:11;
thus L133: ( ( ln ) . R11 ) <= ( R11 - 1 ) by L132;
thus L134: (R11 = 1 iff ( ( ln ) . R11 ) = ( R11 - 1 ))
proof
thus L135:now
assume L136: R11 = 1;
L137: ( ( R11 - 1 ) - ( ( ln ) . R11 ) ) = ( 0 ) by L136 , L35 , L41;
thus L138: ( ( ln ) . R11 ) = ( R11 - 1 ) by L137;
end;
assume L139: ( ( ln ) . R11 ) = ( R11 - 1 );
L140: ( ( R11 - 1 ) - ( ( ln ) . R11 ) ) = ( 0 ) by L139;
assume L141: R11 <> 1;
per cases  by L141 , XXREAL_0:1;
suppose L142: R11 < 1;

L143: ( D5 . R11 ) > ( 0 ) by L142 , L116 , L32;
thus L144: contradiction by L143 , L35 , L32 , L140;
end;
suppose L145: R11 > 1;

L146: ( D5 . R11 ) > ( 0 ) by L145 , L82;
thus L147: contradiction by L146 , L35 , L140 , L145;
end;
end;

thus L149: (R11 <> 1 iff ( ( ln ) . R11 ) < ( R11 - 1 ))
proof
thus L150:now
assume L151: R11 <> 1;
L152: (( R11 - 1 ) > ( 0 ) or ( 1 - R11 ) > ( 0 )) by L151 , XREAL_1:55;
per cases  by L152 , XREAL_1:47;
suppose L153: R11 < 1;

L154: ( D5 . R11 ) > ( 0 ) by L153 , L116 , L32;
L155: ( ( R11 - 1 ) - ( ( ln ) . R11 ) ) > ( 0 ) by L154 , L35 , L32;
thus L156: ( ( ln ) . R11 ) < ( R11 - 1 ) by L155 , XREAL_1:47;
end;
suppose L157: R11 > 1;

L158: ( D5 . R11 ) > ( 0 ) by L157 , L82;
L159: ( ( R11 - 1 ) - ( ( ln ) . R11 ) ) > ( 0 ) by L158 , L35 , L157;
thus L160: ( ( ln ) . R11 ) < ( R11 - 1 ) by L159 , XREAL_1:47;
end;
end;
assume L162: ( ( ln ) . R11 ) < ( R11 - 1 );
assume L163: R11 = 1;
thus L164: contradiction by L163 , L134 , L162;
end;

end;
theorem
L150: (for R11 being Real holds (R11 > ( 0 ) implies (( log (( number_e ) , R11) ) <= ( R11 - 1 ) & (R11 = 1 iff ( log (( number_e ) , R11) ) = ( R11 - 1 )) & (R11 <> 1 iff ( log (( number_e ) , R11) ) < ( R11 - 1 )))))
proof
let R11 being Real;
assume L151: R11 > ( 0 );
L152: R11 in { B19 where B19 is Real : ( 0 ) < B19 } by L151;
L153: R11 in ( right_open_halfline ( 0 ) ) by L152 , XXREAL_1:230;
L154: ( log (( number_e ) , R11) ) = ( ( ln ) . R11 ) by L153 , TAYLOR_1:def 2;
thus L155: thesis by L154 , L151 , L19;
end;
theorem
L156: (for R8 being Real holds (for R9 being Real holds ((R8 > 1 & R9 > 1) implies ( log (R8 , R9) ) > ( 0 ))))
proof
let R8 being Real;
let R9 being Real;
assume that
L157: R8 > 1
and
L158: R9 > 1;
L159: ( R8 to_power ( log (R8 , R9) ) ) > 1 by L157 , L158 , POWER:def 3;
assume L160: ( log (R8 , R9) ) <= ( 0 );
per cases  by L160;
suppose L161: ( log (R8 , R9) ) = ( 0 );

thus L162: contradiction by L161 , L159 , POWER:24;
end;
suppose L163: ( log (R8 , R9) ) < ( 0 );

thus L164: contradiction by L163 , L157 , L159 , POWER:36;
end;
end;
theorem
L166: (for R8 being Real holds (for R9 being Real holds ((R8 > ( 0 ) & R8 <> 1 & R9 > ( 0 )) implies ( - ( log (R8 , R9) ) ) = ( log (R8 , ( 1 / R9 )) ))))
proof
let R8 being Real;
let R9 being Real;
assume that
L167: R8 > ( 0 )
and
L168: R8 <> 1
and
L169: R9 > ( 0 );
thus L170: ( - ( log (R8 , R9) ) ) = ( ( 0 ) - ( log (R8 , R9) ) )
.= ( ( log (R8 , 1) ) - ( log (R8 , R9) ) ) by L167 , L168 , POWER:51
.= ( log (R8 , ( 1 / R9 )) ) by L167 , L168 , L169 , POWER:54;
end;
theorem
L171: (for R8 being Real holds (for R9 being Real holds (for R10 being Real holds ((R8 > ( 0 ) & R8 <> 1 & R9 >= ( 0 ) & R10 >= ( 0 )) implies ( ( R9 * R10 ) * ( log (R8 , ( R9 * R10 )) ) ) = ( ( ( R9 * R10 ) * ( log (R8 , R9) ) ) + ( ( R9 * R10 ) * ( log (R8 , R10) ) ) )))))
proof
let R8 being Real;
let R9 being Real;
let R10 being Real;
assume that
L172: R8 > ( 0 )
and
L173: R8 <> 1
and
L174: R9 >= ( 0 )
and
L175: R10 >= ( 0 );
per cases  by L174 , L175;
suppose L176: (R9 > ( 0 ) & R10 = ( 0 ));

thus L177: thesis by L176;
end;
suppose L178: (R9 = ( 0 ) & R10 = ( 0 ));

thus L179: thesis by L178;
end;
suppose L180: (R9 = ( 0 ) & R10 > ( 0 ));

thus L181: thesis by L180;
end;
suppose L182: (R9 > ( 0 ) & R10 > ( 0 ));

thus L183: ( ( R9 * R10 ) * ( log (R8 , ( R9 * R10 )) ) ) = ( ( R9 * R10 ) * ( ( log (R8 , R9) ) + ( log (R8 , R10) ) ) ) by L182 , L172 , L173 , POWER:53
.= ( ( ( R9 * R10 ) * ( log (R8 , R9) ) ) + ( ( R9 * R10 ) * ( log (R8 , R10) ) ) );
end;
end;
theorem
L185: (for B20 , B21 , B22 being (FinSequence of ( REAL )) holds ((( len B21 ) = ( len B20 ) & ( len B21 ) = ( len B22 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom B21 ) implies ( B20 . R4 ) = ( ( B21 . R4 ) + ( B22 . R4 ) )))) implies ( Sum B20 ) = ( ( Sum B21 ) + ( Sum B22 ) )))
proof
let C7 , C8 , C9 being (FinSequence of ( REAL ));
assume that
L186: ( len C8 ) = ( len C7 )
and
L187: ( len C8 ) = ( len C9 )
and
L188: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C8 ) implies ( C7 . R4 ) = ( ( C8 . R4 ) + ( C9 . R4 ) )));
L189: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C8 ) implies ( C7 . R4 ) = ( ( C8 /. R4 ) + ( C9 /. R4 ) )))
proof
let R4 being (Element of ( NAT ));
assume that
L190: R4 in ( dom C8 );
L191: R4 in ( dom C9 ) by L187 , L190 , FINSEQ_3:29;
thus L192: ( C7 . R4 ) = ( ( C8 . R4 ) + ( C9 . R4 ) ) by L188 , L190
.= ( ( C8 /. R4 ) + ( C9 . R4 ) ) by L190 , PARTFUN1:def 6
.= ( ( C8 /. R4 ) + ( C9 /. R4 ) ) by L191 , PARTFUN1:def 6;
end;
thus L193: thesis by L189 , L186 , L187 , INTEGRA1:21;
end;
theorem
L194: (for B23 , B24 , B25 being (FinSequence of ( REAL )) holds ((( len B24 ) = ( len B23 ) & ( len B24 ) = ( len B25 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom B24 ) implies ( B23 . R4 ) = ( ( B24 . R4 ) - ( B25 . R4 ) )))) implies ( Sum B23 ) = ( ( Sum B24 ) - ( Sum B25 ) )))
proof
let C10 , C11 , C12 being (FinSequence of ( REAL ));
assume that
L195: ( len C11 ) = ( len C10 )
and
L196: ( len C11 ) = ( len C12 )
and
L197: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C11 ) implies ( C10 . R4 ) = ( ( C11 . R4 ) - ( C12 . R4 ) )));
L198: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C11 ) implies ( C10 . R4 ) = ( ( C11 /. R4 ) - ( C12 /. R4 ) )))
proof
let R4 being (Element of ( NAT ));
assume that
L199: R4 in ( dom C11 );
L200: R4 in ( dom C12 ) by L196 , L199 , FINSEQ_3:29;
thus L201: ( C10 . R4 ) = ( ( C11 . R4 ) - ( C12 . R4 ) ) by L197 , L199
.= ( ( C11 /. R4 ) - ( C12 . R4 ) ) by L199 , PARTFUN1:def 6
.= ( ( C11 /. R4 ) - ( C12 /. R4 ) ) by L200 , PARTFUN1:def 6;
end;
thus L202: thesis by L198 , L195 , L196 , INTEGRA1:22;
end;
theorem
L203: (for R14 being (FinSequence of ( REAL )) holds (( len R14 ) >= 1 implies (ex R15 being (FinSequence of ( REAL )) st (( len R15 ) = ( len R14 ) & ( R15 . 1 ) = ( R14 . 1 ) & (for R4 being (Element of ( NAT )) holds ((( 0 ) <> R4 & R4 < ( len R14 )) implies ( R15 . ( R4 + 1 ) ) = ( ( R15 . R4 ) + ( R14 . ( R4 + 1 ) ) ))) & ( Sum R14 ) = ( R15 . ( len R14 ) )))))
proof
let R14 being (FinSequence of ( REAL ));
assume L204: ( len R14 ) >= 1;
consider C13 being Real_Sequence such that L205: ( C13 . 1 ) = ( R14 . 1 ) and L206: (for R6 being Nat holds ((( 0 ) <> R6 & R6 < ( len R14 )) implies ( C13 . ( R6 + 1 ) ) = ( ( C13 . R6 ) + ( R14 . ( R6 + 1 ) ) ))) and L207: ( Sum R14 ) = ( C13 . ( len R14 ) ) by L204 , PROB_3:63;
L208: 1 in ( dom R14 ) by L204 , FINSEQ_3:25;
deffunc H2(Nat) = ( C13 . $1 );
consider C14 being FinSequence such that L209: (( len C14 ) = ( len R14 ) & (for B26 being Nat holds (B26 in ( dom C14 ) implies ( C14 . B26 ) = H2(B26)))) from FINSEQ_1:sch 2;
L210: ( rng C14 ) c= ( REAL )
proof
let R7 being set;
assume L211: R7 in ( rng C14 );
consider C15 being Nat such that L212: C15 in ( dom C14 ) and L213: ( C14 . C15 ) = R7 by L211 , FINSEQ_2:10;
L214: ( C14 . C15 ) = ( C13 . C15 ) by L209 , L212;
thus L215: thesis by L214 , L213;
end;
L216: ( dom C14 ) = ( dom R14 ) by L209 , FINSEQ_3:29;
reconsider D6 = C14 as (FinSequence of ( REAL )) by L210 , FINSEQ_1:def 4;
L217:
now
let R4 being (Element of ( NAT ));
assume that
L218: ( 0 ) <> R4
and
L219: R4 < ( len R14 );
L220: R4 >= 1 by L218 , NAT_1:14;
L221: R4 in ( dom D6 ) by L220 , L209 , L219 , FINSEQ_3:25;
L222: ( R4 + 1 ) >= 1 by NAT_1:14;
L223: ( R4 + 1 ) <= ( len R14 ) by L219 , NAT_1:13;
L224: ( R4 + 1 ) in ( dom D6 ) by L223 , L209 , L222 , FINSEQ_3:25;
thus L225: ( D6 . ( R4 + 1 ) ) = ( C13 . ( R4 + 1 ) ) by L224 , L209
.= ( ( C13 . R4 ) + ( R14 . ( R4 + 1 ) ) ) by L206 , L218 , L219
.= ( ( D6 . R4 ) + ( R14 . ( R4 + 1 ) ) ) by L209 , L221;
end;
take D6;
L226: ( len R14 ) in ( dom D6 ) by L204 , L209 , FINSEQ_3:25;
thus L227: thesis by L226 , L205 , L207 , L209 , L216 , L208 , L217;
end;
notation
let R14 being (FinSequence of ( REAL ));
synonym R14 is  nonnegative for R14 is  nonnegative-yielding;
end;
definition
let R14 being (FinSequence of ( REAL ));
redefine attr R14 is  nonnegative
means
:L229: (for R2 being (Element of ( NAT )) holds (R2 in ( dom R14 ) implies ( R14 . R2 ) >= ( 0 )));
compatibility
proof
thus L230:now
assume L231: R14 is  nonnegative;
let R2 being (Element of ( NAT ));
assume L232: R2 in ( dom R14 );
L233: ( R14 . R2 ) in ( rng R14 ) by L232 , FUNCT_1:3;
thus L234: ( R14 . R2 ) >= ( 0 ) by L233 , L231 , PARTFUN3:def 4;
end;
assume L235: (for R2 being (Element of ( NAT )) holds (R2 in ( dom R14 ) implies ( R14 . R2 ) >= ( 0 )));
let C16 being  real number;
assume L236: C16 in ( rng R14 );
L237: (ex B27 being Nat st (B27 in ( dom R14 ) & C16 = ( R14 . B27 ))) by L236 , FINSEQ_2:10;
thus L238: thesis by L237 , L235;
end;
end;
registration
cluster  nonnegative for (FinSequence of ( REAL ));
existence
proof
take <* 1 *>;
L240: <* 1 *> is  nonnegative
proof
set D7 = <* 1 *>;
L241: (for R2 being (Element of ( NAT )) holds (R2 in ( dom D7 ) implies ( D7 . R2 ) >= ( 0 )))
proof
let R2 being (Element of ( NAT ));
assume L242: R2 in ( dom D7 );
L243: R2 in ( Seg 1 ) by L242 , FINSEQ_1:def 8;
L244: R2 <= 1 by L243 , FINSEQ_1:1;
L245: R2 >= 1 by L243 , FINSEQ_1:1;
L246: R2 = 1 by L245 , L244 , XXREAL_0:1;
thus L247: thesis by L246 , FINSEQ_1:40;
end;
thus L248: thesis by L241 , L229;
end;
thus L249: thesis by L240;
end;
end;
theorem
L251: (for R11 being Real holds (for R14 being (FinSequence of ( REAL )) holds ((R14 is  nonnegative & R11 >= ( 0 )) implies ( R11 * R14 ) is  nonnegative)))
proof
let R11 being Real;
let R14 being (FinSequence of ( REAL ));
assume that
L252: R14 is  nonnegative
and
L253: R11 >= ( 0 );
L254:
now
let R4 being (Element of ( NAT ));
assume L255: R4 in ( dom ( R11 * R14 ) );
L256: R4 in ( dom R14 ) by L255 , VALUED_1:def 5;
L257: ( R14 . R4 ) >= ( 0 ) by L256 , L252 , L229;
L258: ( ( R11 * R14 ) . R4 ) = ( R11 * ( R14 . R4 ) ) by RVSUM_1:44;
thus L259: ( ( R11 * R14 ) . R4 ) >= ( 0 ) by L258 , L253 , L257;
end;
thus L260: thesis by L254 , L229;
end;
definition
let R14 being (FinSequence of ( REAL ));
let R4 being (Element of ( NAT ));
pred R14 has_onlyone_value_in R4
means
:L261: (R4 in ( dom R14 ) & (for R2 being (Element of ( NAT )) holds ((R2 in ( dom R14 ) & R2 <> R4) implies ( R14 . R2 ) = ( 0 ))))
;end;
theorem
L263: (for R2 being (Element of ( NAT )) holds (for R4 being (Element of ( NAT )) holds (for R14 being (FinSequence of ( REAL )) holds ((R14 has_onlyone_value_in R4 & R2 <> R4) implies ( R14 . R2 ) = ( 0 )))))
proof
let R2 being (Element of ( NAT ));
let R4 being (Element of ( NAT ));
let R14 being (FinSequence of ( REAL ));
assume that
L264: R14 has_onlyone_value_in R4
and
L265: R2 <> R4;
per cases ;
suppose L266: (not R2 in ( dom R14 ));

thus L267: thesis by L266 , FUNCT_1:def 2;
end;
suppose L268: R2 in ( dom R14 );

thus L269: thesis by L268 , L264 , L265 , L261;
end;
end;
theorem
L271: (for R4 being (Element of ( NAT )) holds (for R14 being (FinSequence of ( REAL )) holds (for R15 being (FinSequence of ( REAL )) holds ((( len R14 ) = ( len R15 ) & R14 has_onlyone_value_in R4) implies (( mlt (R14 , R15) ) has_onlyone_value_in R4 & ( ( mlt (R14 , R15) ) . R4 ) = ( ( R14 . R4 ) * ( R15 . R4 ) ))))))
proof
let R4 being (Element of ( NAT ));
let R14 being (FinSequence of ( REAL ));
let R15 being (FinSequence of ( REAL ));
assume that
L272: ( len R14 ) = ( len R15 )
and
L273: R14 has_onlyone_value_in R4;
L274: ( len ( mlt (R14 , R15) ) ) = ( len R14 ) by L272 , MATRPROB:30;
L275: ( dom ( mlt (R14 , R15) ) ) = ( dom R14 ) by L274 , FINSEQ_3:29;
L276:
now
let R2 being (Element of ( NAT ));
assume that
L277: R2 in ( dom ( mlt (R14 , R15) ) )
and
L278: R2 <> R4;
thus L279: ( ( mlt (R14 , R15) ) . R2 ) = ( ( R14 . R2 ) * ( R15 . R2 ) ) by RVSUM_1:59
.= ( ( 0 ) * ( R15 . R2 ) ) by L273 , L275 , L277 , L278 , L261
.= ( 0 );
end;
L280: R4 in ( dom ( mlt (R14 , R15) ) ) by L273 , L275 , L261;
thus L281: thesis by L280 , L276 , L261 , RVSUM_1:59;
end;
theorem
L282: (for R4 being (Element of ( NAT )) holds (for R14 being (FinSequence of ( REAL )) holds (R14 has_onlyone_value_in R4 implies ( Sum R14 ) = ( R14 . R4 ))))
proof
let R4 being (Element of ( NAT ));
let R14 being (FinSequence of ( REAL ));
assume that
L283: R4 in ( dom R14 )
and
L284: (for R2 being (Element of ( NAT )) holds ((R2 in ( dom R14 ) & R2 <> R4) implies ( R14 . R2 ) = ( 0 )));
reconsider D8 = ( R14 . R4 ) as (Element of ( REAL ));
reconsider D9 = ( R14 | ( Seg R4 ) ) as (FinSequence of ( REAL )) by FINSEQ_1:18;
L285: D9 c= R14 by TREES_1:def 1;
consider C17 being FinSequence such that L286: R14 = ( D9 ^ C17 ) by L285 , TREES_1:1;
reconsider D10 = C17 as (FinSequence of ( REAL )) by L286 , FINSEQ_1:36;
L287: ( dom D10 ) = ( Seg ( len D10 ) ) by FINSEQ_1:def 3;
L288: 1 <= R4 by L283 , FINSEQ_3:25;
L289: R4 in ( Seg R4 ) by L288 , FINSEQ_1:3;
L290: R4 in ( ( dom R14 ) /\ ( Seg R4 ) ) by L289 , L283 , XBOOLE_0:def 4;
L291: R4 in ( dom D9 ) by L290 , RELAT_1:61;
L292: (for R2 being (Element of ( NAT )) holds (R2 in ( Seg ( len D10 ) ) implies ( D10 . R2 ) = ( 0 )))
proof
let R2 being (Element of ( NAT ));
L293: ( len D9 ) <= ( ( len D9 ) + R2 ) by NAT_1:12;
L294: R4 <= ( len D9 ) by L291 , FINSEQ_3:25;
assume L295: R2 in ( Seg ( len D10 ) );
L296: R2 in ( dom D10 ) by L295 , FINSEQ_1:def 3;
L297: ( 0 ) <> R2 by L296 , FINSEQ_3:25;
L298: ( len D9 ) <> ( ( len D9 ) + R2 ) by L297;
L299: R4 <> ( ( len D9 ) + R2 ) by L298 , L294 , L293 , XXREAL_0:1;
thus L300: ( D10 . R2 ) = ( R14 . ( ( len D9 ) + R2 ) ) by L286 , L296 , FINSEQ_1:def 7
.= ( 0 ) by L284 , L286 , L296 , L299 , FINSEQ_1:28;
end;
L301:
now
let C18 being Nat;
assume L302: C18 in ( dom D10 );
thus L303: ( D10 . C18 ) = ( 0 ) by L302 , L292 , L287
.= ( ( ( len D10 ) |-> ( 0 ) ) . C18 ) by L287 , L302 , FINSEQ_2:57;
end;
L304: D9 <> ( {} ) by L290 , RELAT_1:38 , RELAT_1:61;
L305: ( len D9 ) <> ( 0 ) by L304;
consider C19 being (FinSequence of ( REAL )), C20 being (Element of ( REAL )) such that L306: D9 = ( C19 ^ <* C20 *> ) by L305 , FINSEQ_2:19;
L307: R4 <= ( len R14 ) by L283 , FINSEQ_3:25;
L308: R4 = ( len D9 ) by L307 , FINSEQ_1:17
.= ( ( len C19 ) + ( len <* C20 *> ) ) by L306 , FINSEQ_1:22
.= ( ( len C19 ) + 1 ) by FINSEQ_1:39;
L309: C20 = ( D9 . R4 ) by L308 , L306 , FINSEQ_1:42
.= D8 by L286 , L291 , FINSEQ_1:def 7;
L310: ( dom C19 ) = ( Seg ( len C19 ) ) by FINSEQ_1:def 3;
L311: (for R2 being (Element of ( NAT )) holds (R2 in ( Seg ( len C19 ) ) implies ( C19 . R2 ) = ( 0 )))
proof
let R2 being (Element of ( NAT ));
assume L312: R2 in ( Seg ( len C19 ) );
L313: R2 <= ( len C19 ) by L312 , FINSEQ_1:1;
L314: R2 <> R4 by L313 , L308 , NAT_1:13;
L315: R2 in ( dom C19 ) by L312 , FINSEQ_1:def 3;
L316: R2 in ( dom D9 ) by L315 , L306 , FINSEQ_2:15;
thus L317: ( C19 . R2 ) = ( D9 . R2 ) by L306 , L315 , FINSEQ_1:def 7
.= ( R14 . R2 ) by L286 , L316 , FINSEQ_1:def 7
.= ( 0 ) by L284 , L286 , L314 , L316 , FINSEQ_2:15;
end;
L318:
now
let C21 being Nat;
assume L319: C21 in ( dom C19 );
thus L320: ( C19 . C21 ) = ( 0 ) by L319 , L311 , L310
.= ( ( ( len C19 ) |-> ( 0 ) ) . C21 ) by L310 , L319 , FINSEQ_2:57;
end;
L321: ( len ( ( len C19 ) |-> ( 0 ) ) ) = ( len C19 ) by CARD_1:def 7;
L322: C19 = ( ( len C19 ) |-> ( 0 ) ) by L321 , L318 , FINSEQ_2:9;
L323: ( len ( ( len D10 ) |-> ( 0 ) ) ) = ( len D10 ) by CARD_1:def 7;
L324: D10 = ( ( len D10 ) |-> ( 0 ) ) by L323 , L301 , FINSEQ_2:9;
L325: ( Sum R14 ) = ( ( Sum ( C19 ^ <* C20 *> ) ) + ( Sum ( ( len D10 ) |-> ( 0 ) ) ) ) by L324 , L286 , L306 , RVSUM_1:75
.= ( ( Sum ( C19 ^ <* C20 *> ) ) + ( 0 ) ) by RVSUM_1:81
.= ( ( Sum ( ( len C19 ) |-> ( 0 ) ) ) + C20 ) by L322 , RVSUM_1:74
.= ( ( 0 ) + D8 ) by L309 , RVSUM_1:81
.= ( R14 . R4 );
thus L326: thesis by L325;
end;
theorem
L327: (for R14 being (FinSequence of ( REAL )) holds (R14 is  nonnegative implies (for R4 being (Element of ( NAT )) holds ((R4 in ( dom R14 ) & ( R14 . R4 ) = ( Sum R14 )) implies R14 has_onlyone_value_in R4))))
proof
let R14 being (FinSequence of ( REAL ));
assume L328: R14 is  nonnegative;
let C22 being (Element of ( NAT ));
assume that
L329: C22 in ( dom R14 )
and
L330: ( R14 . C22 ) = ( Sum R14 );
L331: C22 <= ( len R14 ) by L329 , FINSEQ_3:25;
consider C23 being Nat such that L332: ( C22 + C23 ) = ( len R14 ) by L331 , NAT_1:10;
reconsider D11 = C23 as (Element of ( NAT )) by ORDINAL1:def 12;
L333: C22 >= 1 by L329 , FINSEQ_3:25;
L334: (not (ex R2 being (Element of ( NAT )) st (R2 in ( dom R14 ) & R2 <> C22 & ( R14 . R2 ) <> ( 0 ))))
proof
assume L335: (ex R2 being (Element of ( NAT )) st (R2 in ( dom R14 ) & R2 <> C22 & ( R14 . R2 ) <> ( 0 )));
consider C24 being (Element of ( NAT )) such that L336: C24 in ( dom R14 ) and L337: C24 <> C22 and L338: ( R14 . C24 ) <> ( 0 ) by L335;
L339: ( R14 . C24 ) > ( 0 ) by L328 , L336 , L338 , L229;
L340: C24 <= ( len R14 ) by L336 , FINSEQ_3:25;
consider C25 being Nat such that L341: ( C24 + C25 ) = ( len R14 ) by L340 , NAT_1:10;
reconsider D12 = C25 as (Element of ( NAT )) by ORDINAL1:def 12;
L342: C24 >= 1 by L336 , FINSEQ_3:25;
per cases  by L337 , XXREAL_0:1;
suppose L343: C22 > C24;

consider C26 , C27 being (FinSequence of ( REAL )) such that L344: ( len C26 ) = C24 and L345: ( len C27 ) = D12 and L346: R14 = ( C26 ^ C27 ) by L341 , FINSEQ_2:23;
L347: (for B28 being Nat holds (B28 in ( dom C27 ) implies ( C27 . B28 ) >= ( 0 )))
proof
let C28 being Nat;
assume that
L348: C28 in ( dom C27 );
L349: C28 >= 1 by L348 , FINSEQ_3:25;
L350: ( C24 + C28 ) >= ( 1 + ( 0 ) ) by L349 , XREAL_1:7;
L351: C28 <= D12 by L345 , L348 , FINSEQ_3:25;
L352: ( C24 + C28 ) <= ( len R14 ) by L351 , L341 , XREAL_1:7;
L353: ( C24 + C28 ) in ( dom R14 ) by L352 , L350 , FINSEQ_3:25;
L354: ( C27 . C28 ) = ( R14 . ( C24 + C28 ) ) by L344 , L346 , L348 , FINSEQ_1:def 7;
thus L355: thesis by L354 , L328 , L353 , L229;
end;
L356: C24 in ( Seg C24 ) by L342 , FINSEQ_1:3;
L357: C24 in ( dom C26 ) by L356 , L344 , FINSEQ_1:def 3;
L358: (( C26 . C24 ) > ( 0 ) & (for B29 being Nat holds (B29 in ( dom C26 ) implies ( C26 . B29 ) >= ( 0 ))))
proof
thus L359: ( C26 . C24 ) > ( 0 ) by L339 , L346 , L357 , FINSEQ_1:def 7;
L360: ( dom C26 ) c= ( dom R14 ) by L346 , FINSEQ_1:26;
let C29 being Nat;
assume that
L361: C29 in ( dom C26 );
L362: ( C26 . C29 ) = ( R14 . C29 ) by L346 , L361 , FINSEQ_1:def 7;
thus L363: thesis by L362 , L328 , L361 , L360 , L229;
end;
L364: ( Sum C26 ) > ( 0 ) by L358 , L357 , RVSUM_1:85;
L365: (not C22 in ( Seg C24 )) by L343 , FINSEQ_1:1;
L366: (not C22 in ( dom C26 )) by L365 , L344 , FINSEQ_1:def 3;
consider C30 being Nat such that L367: C30 in ( dom C27 ) and L368: C22 = ( C24 + C30 ) by L366 , L329 , L344 , L346 , FINSEQ_1:25;
L369: ( C27 . C30 ) = ( R14 . C22 ) by L344 , L346 , L367 , L368 , FINSEQ_1:def 7;
L370: ( Sum C27 ) >= ( R14 . C22 ) by L369 , L367 , L347 , MATRPROB:5;
L371: ( Sum R14 ) = ( ( Sum C26 ) + ( Sum C27 ) ) by L346 , RVSUM_1:75;
L372: ( Sum R14 ) > ( ( R14 . C22 ) + ( 0 ) ) by L371 , L364 , L370 , XREAL_1:8;
thus L373: thesis by L372 , L330;
end;
suppose L374: C22 < C24;

consider C31 , C32 being (FinSequence of ( REAL )) such that L375: ( len C31 ) = C22 and L376: ( len C32 ) = D11 and L377: R14 = ( C31 ^ C32 ) by L332 , FINSEQ_2:23;
L378: (for B30 being Nat holds (B30 in ( dom C32 ) implies ( C32 . B30 ) >= ( 0 )))
proof
let C33 being Nat;
assume that
L379: C33 in ( dom C32 );
L380: C33 >= 1 by L379 , FINSEQ_3:25;
L381: ( C22 + C33 ) >= ( 1 + ( 0 ) ) by L380 , XREAL_1:7;
L382: C33 <= D11 by L376 , L379 , FINSEQ_3:25;
L383: ( C22 + C33 ) <= ( len R14 ) by L382 , L332 , XREAL_1:7;
L384: ( C22 + C33 ) in ( dom R14 ) by L383 , L381 , FINSEQ_3:25;
L385: ( C32 . C33 ) = ( R14 . ( C22 + C33 ) ) by L375 , L377 , L379 , FINSEQ_1:def 7;
thus L386: thesis by L385 , L328 , L384 , L229;
end;
L387: C22 in ( Seg C22 ) by L333 , FINSEQ_1:3;
L388: C22 in ( dom C31 ) by L387 , L375 , FINSEQ_1:def 3;
L389: (( C31 . C22 ) = ( R14 . C22 ) & (for B31 being Nat holds (B31 in ( dom C31 ) implies ( C31 . B31 ) >= ( 0 ))))
proof
thus L390: ( C31 . C22 ) = ( R14 . C22 ) by L377 , L388 , FINSEQ_1:def 7;
L391: ( dom C31 ) c= ( dom R14 ) by L377 , FINSEQ_1:26;
let C34 being Nat;
assume that
L392: C34 in ( dom C31 );
L393: ( C31 . C34 ) = ( R14 . C34 ) by L377 , L392 , FINSEQ_1:def 7;
thus L394: thesis by L393 , L328 , L392 , L391 , L229;
end;
L395: ( Sum C31 ) >= ( R14 . C22 ) by L389 , L388 , MATRPROB:5;
L396: (not C24 in ( Seg C22 )) by L374 , FINSEQ_1:1;
L397: (not C24 in ( dom C31 )) by L396 , L375 , FINSEQ_1:def 3;
consider C35 being Nat such that L398: C35 in ( dom C32 ) and L399: C24 = ( C22 + C35 ) by L397 , L336 , L375 , L377 , FINSEQ_1:25;
L400: ( C32 . C35 ) = ( R14 . C24 ) by L375 , L377 , L398 , L399 , FINSEQ_1:def 7;
L401: ( Sum C32 ) > ( 0 ) by L400 , L339 , L398 , L378 , RVSUM_1:85;
L402: ( Sum R14 ) = ( ( Sum C31 ) + ( Sum C32 ) ) by L377 , RVSUM_1:75;
L403: ( Sum R14 ) > ( ( R14 . C22 ) + ( 0 ) ) by L402 , L395 , L401 , XREAL_1:8;
thus L404: thesis by L403 , L330;
end;
end;
thus L406: thesis by L334 , L329 , L261;
end;
registration
cluster  ProbFinS -> non  empty  nonnegative for (FinSequence of ( REAL ));
coherence
proof
let C36 being (FinSequence of ( REAL ));
assume L407: C36 is  ProbFinS;
thus L408: C36 is non  empty by L407 , MATRPROB:def 5 , RVSUM_1:72;
L409: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C36 ) implies ( C36 . R2 ) >= ( 0 ))) by L407 , MATRPROB:def 5;
thus L410: thesis by L409 , L229;
end;
end;
theorem
L412: (for B32 being  ProbFinS (FinSequence of ( REAL )) holds (for R4 being (Element of ( NAT )) holds ((R4 in ( dom B32 ) & ( B32 . R4 ) = 1) implies B32 has_onlyone_value_in R4)))
proof
let C37 being  ProbFinS (FinSequence of ( REAL ));
let R4 being (Element of ( NAT ));
assume that
L413: R4 in ( dom C37 )
and
L414: ( C37 . R4 ) = 1;
L415: ( C37 . R4 ) = ( Sum C37 ) by L414 , MATRPROB:def 5;
thus L416: thesis by L415 , L413 , L327;
end;
theorem
L417: (for B33 being non  empty Nat holds ( B33 |-> ( 1 / B33 ) ) is  ProbFinS  ProbFinS  ProbFinS  ProbFinS (FinSequence of ( REAL )))
proof
let C38 being non  empty Nat;
reconsider D13 = C38 as non  empty (Element of ( NAT )) by ORDINAL1:def 12;
L418: (for R4 being (Element of ( NAT )) holds (R4 in ( dom ( D13 |-> ( 1 / D13 ) ) ) implies ( ( D13 |-> ( 1 / D13 ) ) . R4 ) >= ( 0 )))
proof
let R4 being (Element of ( NAT ));
assume L419: R4 in ( dom ( D13 |-> ( 1 / D13 ) ) );
L420: R4 in ( Seg D13 ) by L419 , FUNCOP_1:13;
thus L421: thesis by L420 , FUNCOP_1:7;
end;
L422: ( Sum ( D13 |-> ( 1 / D13 ) ) ) = ( D13 * ( 1 / D13 ) ) by RVSUM_1:80
.= 1 by XCMPLX_1:106;
thus L423: thesis by L422 , L418 , MATRPROB:def 5;
end;
registration
cluster  with_sum=1 -> non  empty-yielding for (Matrix of ( REAL ));
coherence
proof
let C39 being (Matrix of ( REAL ));
assume that
L424: C39 is  with_sum=1;
assume L425: C39 is  empty-yielding;
per cases  by L425 , GOBOARD1:def 3;
suppose L426: ( len C39 ) = ( 0 );

L427: ( SumAll C39 ) = ( 0 ) by L426 , MATRPROB:23;
thus L428: thesis by L427 , L424 , MATRPROB:def 7;
end;
suppose L429: (( width C39 ) = ( 0 ) & ( len C39 ) > ( 0 ));

reconsider D14 = C39 as (Matrix of ( len C39 ) , ( 0 ) , ( REAL )) by L429 , MATRIX_1:20;
L430: ( SumAll D14 ) = ( 0 ) by MATRPROB:24;
thus L431: thesis by L430 , L424 , MATRPROB:def 7;
end;
end;
cluster  Joint_Probability -> non  empty-yielding for (Matrix of ( REAL ));
coherence;
end;
theorem
L434: (for B34 being (Matrix of ( REAL )) holds (B34 = ( {} ) implies ( SumAll B34 ) = ( 0 )))
proof
let C40 being (Matrix of ( REAL ));
assume L435: C40 = ( {} );
reconsider D15 = C40 as (Matrix of ( 0 ) , ( width C40 ) , ( REAL )) by L435 , MATRIX_1:13;
L436: ( len D15 ) = ( 0 ) by MATRIX_1:22;
thus L437: thesis by L436 , MATRPROB:23;
end;
theorem
L438: (for R1 being non  empty set holds (for B35 being (Matrix of R1) holds (for R2 being (Element of ( NAT )) holds (R2 in ( dom B35 ) implies ( dom ( B35 . R2 ) ) = ( Seg ( width B35 ) )))))
proof
let R1 being non  empty set;
let C41 being (Matrix of R1);
let R2 being (Element of ( NAT ));
assume L439: R2 in ( dom C41 );
thus L440: ( dom ( C41 . R2 ) ) = ( dom ( Line (C41 , R2) ) ) by L439 , MATRIX_2:16
.= ( Seg ( len ( Line (C41 , R2) ) ) ) by FINSEQ_1:def 3
.= ( Seg ( width C41 ) ) by MATRIX_1:def 7;
end;
theorem
L441: (for R16 being (Matrix of ( REAL )) holds (R16 is  m-nonnegative iff (for R2 being (Element of ( NAT )) holds (R2 in ( dom R16 ) implies ( Line (R16 , R2) ) is  nonnegative))))
proof
let R16 being (Matrix of ( REAL ));
thus L442:now
assume L443: R16 is  m-nonnegative;
let R2 being (Element of ( NAT ));
assume that
L444: R2 in ( dom R16 );
L445:
now
let R4 being (Element of ( NAT ));
assume L446: R4 in ( dom ( Line (R16 , R2) ) );
L447: R4 in ( dom ( R16 . R2 ) ) by L446 , L444 , MATRIX_2:16;
L448: R4 in ( Seg ( width R16 ) ) by L447 , L444 , L438;
L449: ( ( Line (R16 , R2) ) . R4 ) = ( R16 * (R2 , R4) ) by L448 , MATRIX_1:def 7;
L450: [ R2 , R4 ] in ( Indices R16 ) by L444 , L447 , MATRPROB:13;
thus L451: ( ( Line (R16 , R2) ) . R4 ) >= ( 0 ) by L450 , L443 , L449 , MATRPROB:def 6;
end;
thus L452: ( Line (R16 , R2) ) is  nonnegative by L445 , L229;
end;
assume L453: (for R2 being (Element of ( NAT )) holds (R2 in ( dom R16 ) implies ( Line (R16 , R2) ) is  nonnegative));
L454:
now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L455: [ R2 , R3 ] in ( Indices R16 );
L456: R3 in ( Seg ( width R16 ) ) by L455 , MATRPROB:12;
L457: R3 in ( Seg ( len ( Line (R16 , R2) ) ) ) by L456 , MATRIX_1:def 7;
L458: R3 in ( dom ( Line (R16 , R2) ) ) by L457 , FINSEQ_1:def 3;
L459: R2 in ( Seg ( len R16 ) ) by L455 , MATRPROB:12;
L460: R2 in ( dom R16 ) by L459 , FINSEQ_1:def 3;
L461: ( Line (R16 , R2) ) is  nonnegative by L460 , L453;
L462: ( R16 * (R2 , R3) ) = ( ( Line (R16 , R2) ) . R3 ) by L456 , MATRIX_1:def 7;
thus L463: ( R16 * (R2 , R3) ) >= ( 0 ) by L462 , L458 , L461 , L229;
end;
thus L464: thesis by L454 , MATRPROB:def 6;
end;
begin
theorem
L465: (for R14 being (FinSequence of ( REAL )) holds (for R3 being (Element of ( NAT )) holds (R3 in ( dom R14 ) implies ( Col (( LineVec2Mx R14 ) , R3) ) = <* ( R14 . R3 ) *>)))
proof
let R14 being (FinSequence of ( REAL ));
set D16 = ( LineVec2Mx R14 );
let R3 being (Element of ( NAT ));
assume that
L466: R3 in ( dom R14 );
L467: ( dom <* ( R14 . R3 ) *> ) = ( Seg 1 ) by FINSEQ_1:def 8;
L468: ( len ( Col (D16 , R3) ) ) = ( len D16 ) by MATRIX_1:def 8;
L469: ( len ( Col (D16 , R3) ) ) = 1 by L468 , MATRIXR1:def 10;
L470: ( dom ( Col (D16 , R3) ) ) = ( dom <* ( R14 . R3 ) *> ) by L469 , L467 , FINSEQ_1:def 3;
L471:
now
let C42 being Nat;
assume that
L472: C42 in ( dom ( Col (D16 , R3) ) );
L473: C42 <= 1 by L467 , L470 , L472 , FINSEQ_1:1;
L474: C42 >= 1 by L467 , L470 , L472 , FINSEQ_1:1;
L475: C42 = 1 by L474 , L473 , XXREAL_0:1;
L476: C42 in ( dom D16 ) by L468 , L472 , FINSEQ_3:29;
thus L477: ( ( Col (D16 , R3) ) . C42 ) = ( D16 * (C42 , R3) ) by L476 , MATRIX_1:def 8
.= ( R14 . R3 ) by L466 , L475 , MATRIXR1:def 10
.= ( <* ( R14 . R3 ) *> . C42 ) by L475 , FINSEQ_1:def 8;
end;
thus L478: thesis by L471 , L470 , FINSEQ_1:13;
end;
theorem
L479: (for B36 being non  empty (FinSequence of ( REAL )) holds (for B37 being (FinSequence of ( REAL )) holds (for B38 being (Matrix of ( REAL )) holds (B38 = ( ( ColVec2Mx B36 ) * ( LineVec2Mx B37 ) ) iff (( len B38 ) = ( len B36 ) & ( width B38 ) = ( len B37 ) & (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B38 ) implies ( B38 * (R2 , R3) ) = ( ( B36 . R2 ) * ( B37 . R3 ) )))))))))
proof
let C43 being non  empty (FinSequence of ( REAL ));
let C44 being (FinSequence of ( REAL ));
let C45 being (Matrix of ( REAL ));
set D17 = ( ColVec2Mx C43 );
set D18 = ( LineVec2Mx C44 );
L480: ( len D17 ) = ( len C43 ) by MATRIXR1:def 9;
L481: ( len D18 ) = 1 by MATRIXR1:def 10;
L482: ( len C43 ) > ( 0 );
L483: ( width D17 ) = 1 by L482 , MATRIXR1:def 9;
L484: ( width D18 ) = ( len C44 ) by MATRIXR1:def 10;
thus L485:now
assume L486: C45 = ( D17 * D18 );
L487: ( len C45 ) = ( len D17 ) by L486 , L483 , L481 , MATRPROB:39;
thus L488: (( len C45 ) = ( len C43 ) & ( width C45 ) = ( len C44 )) by L480 , L483 , L481 , L484 , L486 , MATRPROB:39;
L489: ( width C45 ) = ( width D18 ) by L483 , L481 , L486 , MATRPROB:39;
thus L490: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C45 ) implies ( C45 * (R2 , R3) ) = ( ( C43 . R2 ) * ( C44 . R3 ) ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L491: [ R2 , R3 ] in ( Indices C45 );
L492: R2 in ( Seg ( len C45 ) ) by L491 , MATRPROB:12;
L493: R2 in ( dom C43 ) by L492 , L480 , L487 , FINSEQ_1:def 3;
L494: R3 in ( Seg ( width C45 ) ) by L491 , MATRPROB:12;
L495: R3 in ( dom C44 ) by L494 , L484 , L489 , FINSEQ_1:def 3;
L496: R2 in ( dom D17 ) by L487 , L492 , FINSEQ_1:def 3;
L497: ( Line (D17 , R2) ) = ( D17 . R2 ) by L496 , MATRIX_2:16
.= <* ( C43 . R2 ) *> by L482 , L493 , MATRIXR1:def 9;
thus L498: ( C45 * (R2 , R3) ) = ( ( Line (D17 , R2) ) "*" ( Col (D18 , R3) ) ) by L483 , L481 , L486 , L491 , MATRPROB:39
.= ( <* ( C43 . R2 ) *> "*" <* ( C44 . R3 ) *> ) by L495 , L497 , L465
.= ( Sum ( mlt (<* ( C43 . R2 ) *> , <* ( C44 . R3 ) *>) ) ) by RVSUM_1:def 16
.= ( Sum <* ( ( C43 . R2 ) * ( C44 . R3 ) ) *> ) by RVSUM_1:62
.= ( ( C43 . R2 ) * ( C44 . R3 ) ) by RVSUM_1:73;
end;

end;
assume that
L491: ( len C45 ) = ( len C43 )
and
L492: ( width C45 ) = ( len C44 )
and
L493: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C45 ) implies ( C45 * (R2 , R3) ) = ( ( C43 . R2 ) * ( C44 . R3 ) ))));
L494: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C45 ) implies ( C45 * (R2 , R3) ) = ( ( Line (D17 , R2) ) "*" ( Col (D18 , R3) ) ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L495: [ R2 , R3 ] in ( Indices C45 );
L496: R3 in ( Seg ( width C45 ) ) by L495 , MATRPROB:12;
L497: R3 in ( dom C44 ) by L496 , L492 , FINSEQ_1:def 3;
L498: R2 in ( Seg ( len C45 ) ) by L495 , MATRPROB:12;
L499: R2 in ( dom D17 ) by L498 , L480 , L491 , FINSEQ_1:def 3;
L500: R2 in ( dom C43 ) by L491 , L498 , FINSEQ_1:def 3;
L501: <* ( C43 . R2 ) *> = ( D17 . R2 ) by L500 , L482 , MATRIXR1:def 9
.= ( Line (D17 , R2) ) by L499 , MATRIX_2:16;
thus L502: ( C45 * (R2 , R3) ) = ( ( C43 . R2 ) * ( C44 . R3 ) ) by L493 , L495
.= ( Sum <* ( ( C43 . R2 ) * ( C44 . R3 ) ) *> ) by RVSUM_1:73
.= ( Sum ( mlt (<* ( C43 . R2 ) *> , <* ( C44 . R3 ) *>) ) ) by RVSUM_1:62
.= ( <* ( C43 . R2 ) *> "*" <* ( C44 . R3 ) *> ) by RVSUM_1:def 16
.= ( ( Line (D17 , R2) ) "*" ( Col (D18 , R3) ) ) by L497 , L501 , L465;
end;
thus L503: thesis by L494 , L480 , L483 , L481 , L484 , L491 , L492 , MATRPROB:39;
end;
theorem
L504: (for B39 being non  empty (FinSequence of ( REAL )) holds (for B40 being (FinSequence of ( REAL )) holds (for B41 being (Matrix of ( REAL )) holds (B41 = ( ( ColVec2Mx B39 ) * ( LineVec2Mx B40 ) ) iff (( len B41 ) = ( len B39 ) & ( width B41 ) = ( len B40 ) & (for R2 being (Element of ( NAT )) holds (R2 in ( dom B41 ) implies ( Line (B41 , R2) ) = ( ( B39 . R2 ) * B40 ))))))))
proof
let C46 being non  empty (FinSequence of ( REAL ));
let C47 being (FinSequence of ( REAL ));
let C48 being (Matrix of ( REAL ));
set D19 = ( ColVec2Mx C46 );
set D20 = ( LineVec2Mx C47 );
thus L505:now
assume L506: C48 = ( D19 * D20 );
thus L507: (( len C48 ) = ( len C46 ) & ( width C48 ) = ( len C47 )) by L506 , L479;
thus L508: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C48 ) implies ( Line (C48 , R2) ) = ( ( C46 . R2 ) * C47 )))
proof
let R2 being (Element of ( NAT ));
assume L509: R2 in ( dom C48 );
L510: R2 in ( Seg ( len C48 ) ) by L509 , FINSEQ_1:def 3;
L511: (for B42 being Nat holds (B42 in ( dom ( Line (C48 , R2) ) ) implies ( ( Line (C48 , R2) ) . B42 ) = ( ( ( C46 . R2 ) * C47 ) . B42 )))
proof
let C49 being Nat;
assume L512: C49 in ( dom ( Line (C48 , R2) ) );
L513: C49 in ( Seg ( len ( Line (C48 , R2) ) ) ) by L512 , FINSEQ_1:def 3;
L514: C49 in ( Seg ( width C48 ) ) by L513 , MATRIX_1:def 7;
L515: [ R2 , C49 ] in ( Indices C48 ) by L514 , L510 , MATRPROB:12;
L516: C49 in ( NAT ) by ORDINAL1:def 12;
thus L517: ( ( Line (C48 , R2) ) . C49 ) = ( C48 * (R2 , C49) ) by L514 , MATRIX_1:def 7
.= ( ( C46 . R2 ) * ( C47 . C49 ) ) by L506 , L516 , L515 , L479
.= ( ( ( C46 . R2 ) * C47 ) . C49 ) by RVSUM_1:44;
end;
L518: ( dom ( Line (C48 , R2) ) ) = ( Seg ( len ( Line (C48 , R2) ) ) ) by FINSEQ_1:def 3
.= ( Seg ( width C48 ) ) by MATRIX_1:def 7
.= ( Seg ( len C47 ) ) by L506 , L479
.= ( dom C47 ) by FINSEQ_1:def 3
.= ( dom ( ( C46 . R2 ) * C47 ) ) by VALUED_1:def 5;
thus L519: thesis by L518 , L511 , FINSEQ_1:13;
end;

end;
assume that
L509: ( len C48 ) = ( len C46 )
and
L510: ( width C48 ) = ( len C47 )
and
L511: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C48 ) implies ( Line (C48 , R2) ) = ( ( C46 . R2 ) * C47 )));
L512: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C48 ) implies ( C48 * (R2 , R3) ) = ( ( C46 . R2 ) * ( C47 . R3 ) ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L513: [ R2 , R3 ] in ( Indices C48 );
L514: R2 in ( dom C48 ) by L513 , MATRPROB:13;
L515: R3 in ( Seg ( width C48 ) ) by L513 , MATRPROB:12;
thus L516: ( C48 * (R2 , R3) ) = ( ( Line (C48 , R2) ) . R3 ) by L515 , MATRIX_1:def 7
.= ( ( ( C46 . R2 ) * C47 ) . R3 ) by L511 , L514
.= ( ( C46 . R2 ) * ( C47 . R3 ) ) by RVSUM_1:44;
end;
thus L517: thesis by L512 , L509 , L510 , L479;
end;
theorem
L518: (for B43 , B44 being  ProbFinS (FinSequence of ( REAL )) holds ( ( ColVec2Mx B43 ) * ( LineVec2Mx B44 ) ) is  Joint_Probability)
proof
let C50 , C51 being  ProbFinS (FinSequence of ( REAL ));
set D21 = ( ( ColVec2Mx C50 ) * ( LineVec2Mx C51 ) );
L519: ( len D21 ) = ( len C50 ) by L504;
L520: ( LineSum D21 ) = C50
proof
set D22 = ( LineSum D21 );
L521: ( len D22 ) = ( len D21 ) by MATRPROB:20;
L522: ( dom D22 ) = ( dom D21 ) by L521 , FINSEQ_3:29;
L523:
now
let C52 being Nat;
assume that
L524: C52 in ( dom D22 );
L525: C52 in ( Seg ( len D21 ) ) by L521 , L524 , FINSEQ_1:def 3;
thus L526: ( D22 . C52 ) = ( Sum ( Line (D21 , C52) ) ) by L525 , MATRPROB:20
.= ( Sum ( ( C50 . C52 ) * C51 ) ) by L522 , L524 , L504
.= ( ( C50 . C52 ) * ( Sum C51 ) ) by RVSUM_1:87
.= ( ( C50 . C52 ) * 1 ) by MATRPROB:def 5
.= ( C50 . C52 );
end;
L527: ( dom D22 ) = ( dom C50 ) by L519 , L521 , FINSEQ_3:29;
thus L528: thesis by L527 , L523 , FINSEQ_1:13;
end;
L529: ( width D21 ) = ( len C51 ) by L504;
L530:
now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L531: [ R2 , R3 ] in ( Indices D21 );
L532: R2 in ( Seg ( len C50 ) ) by L519 , L531 , MATRPROB:12;
L533: R2 in ( dom C50 ) by L532 , FINSEQ_1:def 3;
L534: ( C50 . R2 ) >= ( 0 ) by L533 , MATRPROB:def 5;
L535: R3 in ( Seg ( len C51 ) ) by L529 , L531 , MATRPROB:12;
L536: R3 in ( dom C51 ) by L535 , FINSEQ_1:def 3;
L537: ( C51 . R3 ) >= ( 0 ) by L536 , MATRPROB:def 5;
L538: ( D21 * (R2 , R3) ) = ( ( C50 . R2 ) * ( C51 . R3 ) ) by L531 , L479;
thus L539: ( D21 * (R2 , R3) ) >= ( 0 ) by L538 , L534 , L537;
end;
L540: D21 is  m-nonnegative by L530 , MATRPROB:def 6;
L541: ( SumAll D21 ) = ( Sum ( LineSum D21 ) ) by MATRPROB:def 3
.= 1 by L520 , MATRPROB:def 5;
L542: D21 is  with_sum=1 by L541 , MATRPROB:def 7;
thus L543: thesis by L542 , L540;
end;
definition
let R6 being Nat;
let C53 being (Matrix of R6 , ( REAL ));
attr C53 is  diagonal
means
:L544: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (([ R2 , R3 ] in ( Indices C53 ) & ( C53 * (R2 , R3) ) <> ( 0 )) implies R2 = R3)));
end;
registration
let R6 being Nat;
cluster  diagonal for (Matrix of R6 , ( REAL ));
existence
proof
deffunc H3(set , set) = ( 0 );
reconsider D23 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C54 being (Matrix of D23 , ( REAL )) such that L546: (for B45 , B46 being Nat holds ([ B45 , B46 ] in ( Indices C54 ) implies ( C54 * (B45 , B46) ) = H3(B45 , B46))) from MATRIX_1:sch 1;
reconsider D24 = C54 as (Matrix of R6 , ( REAL ));
take D24;
L547: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (([ R2 , R3 ] in ( Indices C54 ) & ( C54 * (R2 , R3) ) <> ( 0 )) implies R2 = R3))) by L546;
thus L548: thesis by L547 , L544;
end;
end;
theorem
L550: (for R6 being Nat holds (for B47 being (Matrix of R6 , ( REAL )) holds (B47 is  diagonal iff (for R2 being (Element of ( NAT )) holds (R2 in ( dom B47 ) implies ( Line (B47 , R2) ) has_onlyone_value_in R2)))))
proof
let R6 being Nat;
let C55 being (Matrix of R6 , ( REAL ));
L551: ( width C55 ) = R6 by MATRIX_1:24;
L552: ( len C55 ) = R6 by MATRIX_1:24;
L553: ( dom C55 ) = ( Seg ( width C55 ) ) by L552 , L551 , FINSEQ_1:def 3;
thus L554:now
assume L555: C55 is  diagonal;
L556:
now
let R2 being (Element of ( NAT ));
assume that
L557: R2 in ( dom C55 );
L558: ( len ( Line (C55 , R2) ) ) = ( width C55 ) by MATRIX_1:def 7;
L559:
now
let R3 being (Element of ( NAT ));
assume that
L560: R3 in ( dom ( Line (C55 , R2) ) )
and
L561: R3 <> R2;
L562: R3 in ( dom ( C55 . R2 ) ) by L557 , L560 , MATRIX_2:16;
L563: [ R2 , R3 ] in ( Indices C55 ) by L562 , L557 , MATRPROB:13;
L564: R3 in ( Seg ( width C55 ) ) by L558 , L560 , FINSEQ_1:def 3;
thus L565: ( ( Line (C55 , R2) ) . R3 ) = ( C55 * (R2 , R3) ) by L564 , MATRIX_1:def 7
.= ( 0 ) by L555 , L561 , L563 , L544;
end;
L566: R2 in ( dom ( Line (C55 , R2) ) ) by L553 , L557 , L558 , FINSEQ_1:def 3;
thus L567: ( Line (C55 , R2) ) has_onlyone_value_in R2 by L566 , L559 , L261;
end;
thus L568: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C55 ) implies ( Line (C55 , R2) ) has_onlyone_value_in R2)) by L556;
end;
assume L569: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C55 ) implies ( Line (C55 , R2) ) has_onlyone_value_in R2));
L570: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (([ R2 , R3 ] in ( Indices C55 ) & ( C55 * (R2 , R3) ) <> ( 0 )) implies R2 = R3)))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L571: [ R2 , R3 ] in ( Indices C55 )
and
L572: ( C55 * (R2 , R3) ) <> ( 0 );
L573: R2 in ( dom C55 ) by L571 , MATRPROB:13;
L574: ( Line (C55 , R2) ) has_onlyone_value_in R2 by L573 , L569;
L575: R3 in ( dom ( C55 . R2 ) ) by L571 , MATRPROB:13;
L576: R3 in ( dom ( Line (C55 , R2) ) ) by L575 , L573 , MATRIX_2:16;
assume L577: R2 <> R3;
L578: ( len ( Line (C55 , R2) ) ) = ( width C55 ) by MATRIX_1:def 7;
L579: ( dom ( Line (C55 , R2) ) ) = ( Seg ( width C55 ) ) by L578 , FINSEQ_1:def 3;
L580: ( C55 * (R2 , R3) ) = ( ( Line (C55 , R2) ) . R3 ) by L579 , L576 , MATRIX_1:def 7
.= ( 0 ) by L577 , L576 , L574 , L261;
thus L581: thesis by L580 , L572;
end;
thus L582: thesis by L570 , L544;
end;
definition
let R14 being (FinSequence of ( REAL ));
func Vec2DiagMx R14 ->  diagonal (Matrix of ( len R14 ) , ( REAL )) means 
:L583: (for R3 being (Element of ( NAT )) holds (R3 in ( dom R14 ) implies ( it * (R3 , R3) ) = ( R14 . R3 )));
existence
proof
defpred S2[ Nat , Nat , (Element of ( REAL )) ] means (($1 = $2 implies $3 = ( R14 . $1 )) & ($1 <> $2 implies $3 = ( 0 )));
L584: (for B48 , B49 being Nat holds ([ B48 , B49 ] in [: ( Seg ( len R14 ) ) , ( Seg ( len R14 ) ) :] implies (ex B50 being (Element of ( REAL )) st S2[ B48 , B49 , B50 ])))
proof
let C56 , C57 being Nat;
assume L585: [ C56 , C57 ] in [: ( Seg ( len R14 ) ) , ( Seg ( len R14 ) ) :];
L586: (C56 = C57 implies S2[ C56 , C57 , ( R14 . C56 ) ]);
thus L587: thesis by L586;
end;
consider C58 being (Matrix of ( len R14 ) , ( REAL )) such that L588: (for B51 , B52 being Nat holds ([ B51 , B52 ] in ( Indices C58 ) implies S2[ B51 , B52 , ( C58 * (B51 , B52) ) ])) from MATRIX_1:sch 2(L584);
L589: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (([ R2 , R3 ] in ( Indices C58 ) & ( C58 * (R2 , R3) ) <> ( 0 )) implies R2 = R3))) by L588;
reconsider D25 = C58 as  diagonal (Matrix of ( len R14 ) , ( REAL )) by L589 , L544;
take D25;
L590: ( len C58 ) = ( len R14 ) by MATRIX_1:24;
L591: ( Seg ( len D25 ) ) = ( dom R14 ) by L590 , FINSEQ_1:def 3;
L592: ( width C58 ) = ( len R14 ) by MATRIX_1:24;
L593: ( Seg ( width D25 ) ) = ( dom R14 ) by L592 , FINSEQ_1:def 3;
L594: (for R3 being (Element of ( NAT )) holds (R3 in ( dom R14 ) implies ( D25 * (R3 , R3) ) = ( R14 . R3 )))
proof
let R3 being (Element of ( NAT ));
assume L595: R3 in ( dom R14 );
L596: [ R3 , R3 ] in ( Indices D25 ) by L595 , L593 , L591 , MATRPROB:12;
thus L597: thesis by L596 , L588;
end;
thus L598: thesis by L594;
end;
uniqueness
proof
let C59 , C60 being  diagonal (Matrix of ( len R14 ) , ( REAL ));
assume that
L599: (for R3 being (Element of ( NAT )) holds (R3 in ( dom R14 ) implies ( C59 * (R3 , R3) ) = ( R14 . R3 )))
and
L600: (for R3 being (Element of ( NAT )) holds (R3 in ( dom R14 ) implies ( C60 * (R3 , R3) ) = ( R14 . R3 )));
L601: ( width C59 ) = ( len R14 ) by MATRIX_1:24;
L602: ( Seg ( width C59 ) ) = ( dom R14 ) by L601 , FINSEQ_1:def 3;
L603: ( Indices C59 ) = ( Indices C60 ) by MATRIX_1:26;
L604:
now
let C61 , C62 being Nat;
assume that
L605: [ C61 , C62 ] in ( Indices C59 );
reconsider D26 = C61 , D27 = C62 as (Element of ( NAT )) by ORDINAL1:def 12;
L606: [ D26 , D27 ] in ( Indices C59 ) by L605;
L607: D27 in ( Seg ( width C59 ) ) by L606 , MATRPROB:12;
per cases ;
suppose L608: C61 = C62;

thus L609: ( C59 * (C61 , C62) ) = ( R14 . C62 ) by L608 , L599 , L602 , L607
.= ( C60 * (C61 , C62) ) by L600 , L602 , L607 , L608;
end;
suppose L610: C61 <> C62;

thus L611: ( C59 * (C61 , C62) ) = ( 0 ) by L610 , L606 , L544
.= ( C60 * (C61 , C62) ) by L603 , L606 , L610 , L544;
end;
end;
thus L613: thesis by L604 , MATRIX_1:27;
end;
end;
theorem
L615: (for R14 being (FinSequence of ( REAL )) holds (for R16 being (Matrix of ( REAL )) holds (R16 = ( Vec2DiagMx R14 ) iff (( len R16 ) = ( len R14 ) & ( width R16 ) = ( len R14 ) & (for R2 being (Element of ( NAT )) holds (R2 in ( dom R16 ) implies (( Line (R16 , R2) ) has_onlyone_value_in R2 & ( ( Line (R16 , R2) ) . R2 ) = ( R14 . R2 ))))))))
proof
let R14 being (FinSequence of ( REAL ));
let R16 being (Matrix of ( REAL ));
thus L616:now
assume L617: R16 = ( Vec2DiagMx R14 );
reconsider D28 = R16 as  diagonal (Matrix of ( len R14 ) , ( REAL )) by L617;
L618: ( len D28 ) = ( len R14 ) by MATRIX_1:24;
L619: ( dom R16 ) = ( dom R14 ) by L618 , FINSEQ_3:29;
thus L620: (( len R16 ) = ( len R14 ) & ( width R16 ) = ( len R14 )) by L618 , MATRIX_1:24;
L621: ( width D28 ) = ( len R14 ) by MATRIX_1:24;
L622: ( Seg ( width R16 ) ) = ( dom R14 ) by L621 , FINSEQ_1:def 3;
thus L623: (for R2 being (Element of ( NAT )) holds (R2 in ( dom R16 ) implies (( Line (R16 , R2) ) has_onlyone_value_in R2 & ( ( Line (R16 , R2) ) . R2 ) = ( R14 . R2 ))))
proof
let R2 being (Element of ( NAT ));
assume that
L624: R2 in ( dom R16 );
L625: ( Line (D28 , R2) ) has_onlyone_value_in R2 by L624 , L550;
L626: ( ( Line (R16 , R2) ) . R2 ) = ( R16 * (R2 , R2) ) by L619 , L622 , L624 , MATRIX_1:def 7
.= ( R14 . R2 ) by L617 , L619 , L624 , L583;
thus L627: thesis by L626 , L625;
end;

end;
assume that
L624: ( len R16 ) = ( len R14 )
and
L625: ( width R16 ) = ( len R14 )
and
L626: (for R2 being (Element of ( NAT )) holds (R2 in ( dom R16 ) implies (( Line (R16 , R2) ) has_onlyone_value_in R2 & ( ( Line (R16 , R2) ) . R2 ) = ( R14 . R2 ))));
reconsider D29 = R16 as (Matrix of ( len R14 ) , ( REAL )) by L624 , L625 , MATRIX_2:7;
L627: (for R2 being (Element of ( NAT )) holds (R2 in ( dom D29 ) implies ( Line (D29 , R2) ) has_onlyone_value_in R2)) by L626;
reconsider D30 = D29 as  diagonal (Matrix of ( len R14 ) , ( REAL )) by L627 , L550;
L628: (for R3 being (Element of ( NAT )) holds (R3 in ( dom R14 ) implies ( D30 * (R3 , R3) ) = ( R14 . R3 )))
proof
L629: ( dom D30 ) = ( dom R14 ) by L624 , FINSEQ_3:29;
let R3 being (Element of ( NAT ));
assume that
L630: R3 in ( dom R14 );
L631: ( Seg ( width D30 ) ) = ( dom R14 ) by L625 , FINSEQ_1:def 3;
thus L632: ( D30 * (R3 , R3) ) = ( ( Line (D30 , R3) ) . R3 ) by L631 , L630 , MATRIX_1:def 7
.= ( R14 . R3 ) by L626 , L630 , L629;
end;
thus L633: thesis by L628 , L583;
end;
theorem
L634: (for R14 being (FinSequence of ( REAL )) holds (for R16 being (Matrix of ( REAL )) holds (for R17 being (Matrix of ( REAL )) holds (( len R14 ) = ( len R16 ) implies (R17 = ( ( Vec2DiagMx R14 ) * R16 ) iff (( len R17 ) = ( len R14 ) & ( width R17 ) = ( width R16 ) & (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices R17 ) implies ( R17 * (R2 , R3) ) = ( ( R14 . R2 ) * ( R16 * (R2 , R3) ) ))))))))))
proof
let R14 being (FinSequence of ( REAL ));
let R16 being (Matrix of ( REAL ));
let R17 being (Matrix of ( REAL ));
set D31 = ( Vec2DiagMx R14 );
L635: ( len D31 ) = ( len R14 ) by L615;
L636: ( width D31 ) = ( len R14 ) by L615;
assume L637: ( len R14 ) = ( len R16 );
L638: ( dom R14 ) = ( dom R16 ) by L637 , FINSEQ_3:29;
thus L639:now
assume L640: R17 = ( D31 * R16 );
thus L641: (( len R17 ) = ( len R14 ) & ( width R17 ) = ( width R16 )) by L640 , L637 , L635 , L636 , MATRPROB:39;
L642: ( len R17 ) = ( len D31 ) by L637 , L636 , L640 , MATRPROB:39;
L643: ( dom R17 ) = ( dom D31 ) by L642 , FINSEQ_3:29;
L644: ( dom R17 ) = ( dom R14 ) by L635 , L642 , FINSEQ_3:29;
thus L645: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices R17 ) implies ( R17 * (R2 , R3) ) = ( ( R14 . R2 ) * ( R16 * (R2 , R3) ) ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L646: [ R2 , R3 ] in ( Indices R17 );
L647: R2 in ( Seg ( len R17 ) ) by L646 , MATRPROB:12;
L648: R2 in ( dom R17 ) by L647 , FINSEQ_1:def 3;
L649: ( ( Line (D31 , R2) ) . R2 ) = ( R14 . R2 ) by L648 , L643 , L615;
set D32 = ( mlt (( Line (D31 , R2) ) , ( Col (R16 , R3) )) );
L650: ( len ( Line (D31 , R2) ) ) = ( width D31 ) by MATRIX_1:def 7;
L651: ( len ( Col (R16 , R3) ) ) = ( len R16 ) by MATRIX_1:def 8;
L652: ( Line (D31 , R2) ) has_onlyone_value_in R2 by L643 , L648 , L615;
L653: ( D32 . R2 ) = ( ( ( Line (D31 , R2) ) . R2 ) * ( ( Col (R16 , R3) ) . R2 ) ) by L652 , L637 , L636 , L650 , L651 , L271;
thus L654: ( R17 * (R2 , R3) ) = ( ( Line (D31 , R2) ) "*" ( Col (R16 , R3) ) ) by L637 , L636 , L640 , L646 , MATRPROB:39
.= ( Sum D32 ) by RVSUM_1:def 16
.= ( ( R14 . R2 ) * ( ( Col (R16 , R3) ) . R2 ) ) by L637 , L636 , L652 , L649 , L650 , L651 , L653 , L271 , L282
.= ( ( R14 . R2 ) * ( R16 * (R2 , R3) ) ) by L638 , L644 , L648 , MATRIX_1:def 8;
end;

end;
assume that
L646: ( len R17 ) = ( len R14 )
and
L647: ( width R17 ) = ( width R16 )
and
L648: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices R17 ) implies ( R17 * (R2 , R3) ) = ( ( R14 . R2 ) * ( R16 * (R2 , R3) ) ))));
L649: ( dom R17 ) = ( dom D31 ) by L635 , L646 , FINSEQ_3:29;
L650: ( dom R16 ) = ( dom R17 ) by L637 , L646 , FINSEQ_3:29;
L651: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices R17 ) implies ( R17 * (R2 , R3) ) = ( ( Line (D31 , R2) ) "*" ( Col (R16 , R3) ) ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L652: [ R2 , R3 ] in ( Indices R17 );
L653: R2 in ( Seg ( len R17 ) ) by L652 , MATRPROB:12;
L654: R2 in ( dom R17 ) by L653 , FINSEQ_1:def 3;
L655: ( ( Line (D31 , R2) ) . R2 ) = ( R14 . R2 ) by L654 , L649 , L615;
set D33 = ( mlt (( Line (D31 , R2) ) , ( Col (R16 , R3) )) );
L656: ( len ( Line (D31 , R2) ) ) = ( width D31 ) by MATRIX_1:def 7;
L657: ( len ( Col (R16 , R3) ) ) = ( len R16 ) by MATRIX_1:def 8;
L658: ( Line (D31 , R2) ) has_onlyone_value_in R2 by L649 , L654 , L615;
L659: ( D33 . R2 ) = ( ( ( Line (D31 , R2) ) . R2 ) * ( ( Col (R16 , R3) ) . R2 ) ) by L658 , L637 , L636 , L656 , L657 , L271;
thus L660: ( R17 * (R2 , R3) ) = ( ( R14 . R2 ) * ( R16 * (R2 , R3) ) ) by L648 , L652
.= ( ( R14 . R2 ) * ( ( Col (R16 , R3) ) . R2 ) ) by L650 , L654 , MATRIX_1:def 8
.= ( Sum D33 ) by L637 , L636 , L658 , L655 , L656 , L657 , L659 , L271 , L282
.= ( ( Line (D31 , R2) ) "*" ( Col (R16 , R3) ) ) by RVSUM_1:def 16;
end;
thus L661: thesis by L651 , L637 , L635 , L636 , L646 , L647 , MATRPROB:39;
end;
theorem
L662: (for R14 being (FinSequence of ( REAL )) holds (for R16 being (Matrix of ( REAL )) holds (for R17 being (Matrix of ( REAL )) holds (( len R14 ) = ( len R16 ) implies (R17 = ( ( Vec2DiagMx R14 ) * R16 ) iff (( len R17 ) = ( len R14 ) & ( width R17 ) = ( width R16 ) & (for R2 being (Element of ( NAT )) holds (R2 in ( dom R17 ) implies ( Line (R17 , R2) ) = ( ( R14 . R2 ) * ( Line (R16 , R2) ) )))))))))
proof
let R14 being (FinSequence of ( REAL ));
let R16 being (Matrix of ( REAL ));
let R17 being (Matrix of ( REAL ));
set D34 = ( Vec2DiagMx R14 );
assume L663: ( len R14 ) = ( len R16 );
thus L664:now
assume L665: R17 = ( D34 * R16 );
thus L666: (( len R17 ) = ( len R14 ) & ( width R17 ) = ( width R16 )) by L665 , L663 , L634;
L667: ( width R17 ) = ( width R16 ) by L663 , L665 , L634;
thus L668: (for R2 being (Element of ( NAT )) holds (R2 in ( dom R17 ) implies ( Line (R17 , R2) ) = ( ( R14 . R2 ) * ( Line (R16 , R2) ) )))
proof
let R2 being (Element of ( NAT ));
assume L669: R2 in ( dom R17 );
L670: R2 in ( Seg ( len R17 ) ) by L669 , FINSEQ_1:def 3;
L671: (for B53 being Nat holds (B53 in ( dom ( Line (R17 , R2) ) ) implies ( ( Line (R17 , R2) ) . B53 ) = ( ( ( R14 . R2 ) * ( Line (R16 , R2) ) ) . B53 )))
proof
let C63 being Nat;
assume L672: C63 in ( dom ( Line (R17 , R2) ) );
L673: C63 in ( Seg ( len ( Line (R17 , R2) ) ) ) by L672 , FINSEQ_1:def 3;
L674: C63 in ( Seg ( width R17 ) ) by L673 , MATRIX_1:def 7;
L675: [ R2 , C63 ] in ( Indices R17 ) by L674 , L670 , MATRPROB:12;
L676: C63 in ( NAT ) by ORDINAL1:def 12;
thus L677: ( ( Line (R17 , R2) ) . C63 ) = ( R17 * (R2 , C63) ) by L674 , MATRIX_1:def 7
.= ( ( R14 . R2 ) * ( R16 * (R2 , C63) ) ) by L663 , L665 , L676 , L675 , L634
.= ( ( R14 . R2 ) * ( ( Line (R16 , R2) ) . C63 ) ) by L667 , L674 , MATRIX_1:def 7
.= ( ( ( R14 . R2 ) * ( Line (R16 , R2) ) ) . C63 ) by RVSUM_1:44;
end;
L678: ( dom ( Line (R17 , R2) ) ) = ( Seg ( len ( Line (R17 , R2) ) ) ) by FINSEQ_1:def 3
.= ( Seg ( width R17 ) ) by MATRIX_1:def 7
.= ( Seg ( len ( Line (R16 , R2) ) ) ) by L667 , MATRIX_1:def 7
.= ( dom ( Line (R16 , R2) ) ) by FINSEQ_1:def 3
.= ( dom ( ( R14 . R2 ) * ( Line (R16 , R2) ) ) ) by VALUED_1:def 5;
thus L679: thesis by L678 , L671 , FINSEQ_1:13;
end;

end;
assume that
L669: ( len R17 ) = ( len R14 )
and
L670: ( width R17 ) = ( width R16 )
and
L671: (for R2 being (Element of ( NAT )) holds (R2 in ( dom R17 ) implies ( Line (R17 , R2) ) = ( ( R14 . R2 ) * ( Line (R16 , R2) ) )));
L672: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices R17 ) implies ( R17 * (R2 , R3) ) = ( ( R14 . R2 ) * ( R16 * (R2 , R3) ) ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L673: [ R2 , R3 ] in ( Indices R17 );
L674: R2 in ( dom R17 ) by L673 , MATRPROB:13;
L675: R3 in ( Seg ( width R17 ) ) by L673 , MATRPROB:12;
thus L676: ( R17 * (R2 , R3) ) = ( ( Line (R17 , R2) ) . R3 ) by L675 , MATRIX_1:def 7
.= ( ( ( R14 . R2 ) * ( Line (R16 , R2) ) ) . R3 ) by L671 , L674
.= ( ( R14 . R2 ) * ( ( Line (R16 , R2) ) . R3 ) ) by RVSUM_1:44
.= ( ( R14 . R2 ) * ( R16 * (R2 , R3) ) ) by L670 , L675 , MATRIX_1:def 7;
end;
thus L677: thesis by L672 , L663 , L669 , L670 , L634;
end;
theorem
L678: (for B54 being  ProbFinS (FinSequence of ( REAL )) holds (for B55 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds (( len B54 ) = ( len B55 ) implies ( ( Vec2DiagMx B54 ) * B55 ) is  Joint_Probability)))
proof
let C64 being  ProbFinS (FinSequence of ( REAL ));
let C65 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
set D35 = ( ( Vec2DiagMx C64 ) * C65 );
assume L679: ( len C64 ) = ( len C65 );
L680: ( len D35 ) = ( len C64 ) by L679 , L634;
L681: ( LineSum D35 ) = C64
proof
set D36 = ( LineSum D35 );
L682: ( len D36 ) = ( len D35 ) by MATRPROB:20;
L683: ( dom D36 ) = ( dom C65 ) by L682 , L679 , L680 , FINSEQ_3:29;
L684: ( dom D36 ) = ( dom D35 ) by L682 , FINSEQ_3:29;
L685:
now
let C66 being Nat;
assume that
L686: C66 in ( dom D36 );
L687: C66 in ( Seg ( len D35 ) ) by L682 , L686 , FINSEQ_1:def 3;
thus L688: ( D36 . C66 ) = ( Sum ( Line (D35 , C66) ) ) by L687 , MATRPROB:20
.= ( Sum ( ( C64 . C66 ) * ( Line (C65 , C66) ) ) ) by L679 , L684 , L686 , L662
.= ( ( C64 . C66 ) * ( Sum ( Line (C65 , C66) ) ) ) by RVSUM_1:87
.= ( ( C64 . C66 ) * ( Sum ( C65 . C66 ) ) ) by L683 , L686 , MATRIX_2:16
.= ( ( C64 . C66 ) * 1 ) by L683 , L686 , MATRPROB:def 9
.= ( C64 . C66 );
end;
L689: ( dom D36 ) = ( dom C64 ) by L680 , L682 , FINSEQ_3:29;
thus L690: thesis by L689 , L685 , FINSEQ_1:13;
end;
L691: ( width D35 ) = ( width C65 ) by L679 , L634;
L692:
now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L693: [ R2 , R3 ] in ( Indices D35 );
L694: R3 in ( Seg ( width C65 ) ) by L691 , L693 , MATRPROB:12;
L695: R2 in ( Seg ( len C64 ) ) by L680 , L693 , MATRPROB:12;
L696: R2 in ( dom C64 ) by L695 , FINSEQ_1:def 3;
L697: ( C64 . R2 ) >= ( 0 ) by L696 , MATRPROB:def 5;
L698: R2 in ( Seg ( len C65 ) ) by L679 , L680 , L693 , MATRPROB:12;
L699: [ R2 , R3 ] in ( Indices C65 ) by L698 , L694 , MATRPROB:12;
L700: ( C65 * (R2 , R3) ) >= ( 0 ) by L699 , MATRPROB:def 6;
L701: ( D35 * (R2 , R3) ) = ( ( C64 . R2 ) * ( C65 * (R2 , R3) ) ) by L679 , L693 , L634;
thus L702: ( D35 * (R2 , R3) ) >= ( 0 ) by L701 , L697 , L700;
end;
L703: D35 is  m-nonnegative by L692 , MATRPROB:def 6;
L704: ( SumAll D35 ) = ( Sum ( LineSum D35 ) ) by MATRPROB:def 3
.= 1 by L681 , MATRPROB:def 5;
L705: D35 is  with_sum=1 by L704 , MATRPROB:def 7;
thus L706: thesis by L705 , L703;
end;
theorem
L707: (for R1 being non  empty set holds (for B56 being (Matrix of R1) holds (for B57 being (FinSequence of ( R1 * )) holds ((( len B57 ) = ( len B56 ) & ( B57 . 1 ) = ( B56 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B56 )) implies ( B57 . ( R4 + 1 ) ) = ( ( B57 . R4 ) ^ ( B56 . ( R4 + 1 ) ) )))) implies (for R4 being (Element of ( NAT )) holds (R4 in ( dom B57 ) implies ( len ( B57 . R4 ) ) = ( R4 * ( width B56 ) )))))))
proof
let R1 being non  empty set;
let C67 being (Matrix of R1);
let C68 being (FinSequence of ( R1 * ));
assume that
L708: ( len C68 ) = ( len C67 )
and
L709: ( C68 . 1 ) = ( C67 . 1 )
and
L710: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C67 )) implies ( C68 . ( R4 + 1 ) ) = ( ( C68 . R4 ) ^ ( C67 . ( R4 + 1 ) ) )));
defpred S3[ (Element of ( NAT )) ] means (($1 >= 1 & $1 <= ( len C67 )) implies ( len ( C68 . $1 ) ) = ( $1 * ( width C67 ) ));
L711: (for B58 being (Element of ( NAT )) holds (S3[ B58 ] implies S3[ ( B58 + 1 ) ]))
proof
let C69 being (Element of ( NAT ));
assume that
L712: ((C69 >= 1 & C69 <= ( len C67 )) implies ( len ( C68 . C69 ) ) = ( C69 * ( width C67 ) ));
assume that
L713: ( C69 + 1 ) >= 1
and
L714: ( C69 + 1 ) <= ( len C67 );
L715:
now
per cases ;
suppose L716: C69 = ( 0 );

L717: 1 in ( dom C67 ) by L716 , L714 , FINSEQ_3:25;
thus L718: thesis by L717 , L709 , L716 , MATRIX_1:42;
end;
suppose L719: C69 <> ( 0 );

L720: ( C69 + 1 ) in ( dom C67 ) by L713 , L714 , FINSEQ_3:25;
L721: C69 < ( len C67 ) by L714 , NAT_1:13;
L722: ( C68 . ( C69 + 1 ) ) = ( ( C68 . C69 ) ^ ( C67 . ( C69 + 1 ) ) ) by L721 , L710 , L719 , NAT_1:14;
L723: ( len ( C68 . ( C69 + 1 ) ) ) = ( ( len ( C68 . C69 ) ) + ( len ( C67 . ( C69 + 1 ) ) ) ) by L722 , FINSEQ_1:22
.= ( ( C69 * ( width C67 ) ) + ( width C67 ) ) by L712 , L714 , L719 , L720 , MATRIX_1:42 , NAT_1:13 , NAT_1:14
.= ( ( C69 + 1 ) * ( width C67 ) );
thus L724: thesis by L723;
end;
end;
thus L726: thesis by L715;
end;
L727: S3[ ( 0 ) ];
L728: (for B59 being (Element of ( NAT )) holds S3[ B59 ]) from NAT_1:sch 1(L727 , L711);
let R4 being (Element of ( NAT ));
assume L729: R4 in ( dom C68 );
L730: R4 in ( Seg ( len C68 ) ) by L729 , FINSEQ_1:def 3;
L731: R4 <= ( len C68 ) by L730 , FINSEQ_1:1;
L732: R4 >= 1 by L730 , FINSEQ_1:1;
thus L733: thesis by L732 , L708 , L728 , L731;
end;
theorem
L734: (for R1 being non  empty set holds (for B60 being (Matrix of R1) holds (for B61 being (FinSequence of ( R1 * )) holds ((( len B61 ) = ( len B60 ) & ( B61 . 1 ) = ( B60 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B60 )) implies ( B61 . ( R4 + 1 ) ) = ( ( B61 . R4 ) ^ ( B60 . ( R4 + 1 ) ) )))) implies (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom B61 ) & R3 in ( dom B61 ) & R2 <= R3) implies ( dom ( B61 . R2 ) ) c= ( dom ( B61 . R3 ) ))))))))
proof
let R1 being non  empty set;
let C70 being (Matrix of R1);
let C71 being (FinSequence of ( R1 * ));
assume that
L735: ( len C71 ) = ( len C70 )
and
L736: ( C71 . 1 ) = ( C70 . 1 )
and
L737: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C70 )) implies ( C71 . ( R4 + 1 ) ) = ( ( C71 . R4 ) ^ ( C70 . ( R4 + 1 ) ) )));
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L738: R2 in ( dom C71 )
and
L739: R3 in ( dom C71 )
and
L740: R2 <= R3;
L741: ( len ( C71 . R3 ) ) = ( R3 * ( width C70 ) ) by L735 , L736 , L737 , L739 , L707;
L742: ( len ( C71 . R2 ) ) = ( R2 * ( width C70 ) ) by L735 , L736 , L737 , L738 , L707;
L743: ( len ( C71 . R2 ) ) <= ( len ( C71 . R3 ) ) by L742 , L740 , L741 , NAT_1:4;
L744: ( Seg ( len ( C71 . R2 ) ) ) c= ( Seg ( len ( C71 . R3 ) ) ) by L743 , FINSEQ_1:5;
L745: ( dom ( C71 . R2 ) ) c= ( Seg ( len ( C71 . R3 ) ) ) by L744 , FINSEQ_1:def 3;
thus L746: thesis by L745 , FINSEQ_1:def 3;
end;
theorem
L747: (for R1 being non  empty set holds (for B62 being (Matrix of R1) holds (for B63 being (FinSequence of ( R1 * )) holds ((( len B63 ) = ( len B62 ) & ( B63 . 1 ) = ( B62 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B62 )) implies ( B63 . ( R4 + 1 ) ) = ( ( B63 . R4 ) ^ ( B62 . ( R4 + 1 ) ) )))) implies (( len ( B63 . 1 ) ) = ( width B62 ) & (for R3 being (Element of ( NAT )) holds ([ 1 , R3 ] in ( Indices B62 ) implies (R3 in ( dom ( B63 . 1 ) ) & ( ( B63 . 1 ) . R3 ) = ( B62 * (1 , R3) )))))))))
proof
let R1 being non  empty set;
let C72 being (Matrix of R1);
let C73 being (FinSequence of ( R1 * ));
assume that
L748: ( len C73 ) = ( len C72 )
and
L749: ( C73 . 1 ) = ( C72 . 1 )
and
L750: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C72 )) implies ( C73 . ( R4 + 1 ) ) = ( ( C73 . R4 ) ^ ( C72 . ( R4 + 1 ) ) )));
per cases ;
suppose L751: ( len C72 ) = ( 0 );

L752: C73 = ( {} ) by L751 , L748;
L753: ( C73 . 1 ) = ( {} ) by L752 , FUNCT_1:def 2 , RELAT_1:38;
thus L754: ( len ( C73 . 1 ) ) = ( width C72 ) by L753 , L751 , MATRIX_1:def 3;
let R3 being (Element of ( NAT ));
L755: ( Seg ( len C72 ) ) = ( {} ) by L751;
assume L756: [ 1 , R3 ] in ( Indices C72 );
thus L757: thesis by L756 , L755 , MATRPROB:12;
end;
suppose L758: ( len C72 ) > ( 0 );

L759: 1 <= ( len C73 ) by L758 , L748 , NAT_1:14;
L760: 1 in ( Seg ( len C73 ) ) by L759 , FINSEQ_1:1;
L761: 1 in ( dom C73 ) by L760 , FINSEQ_1:def 3;
thus L762: ( len ( C73 . 1 ) ) = ( 1 * ( width C72 ) ) by L761 , L748 , L749 , L750 , L707
.= ( width C72 );
let R3 being (Element of ( NAT ));
assume that
L763: [ 1 , R3 ] in ( Indices C72 );
L764: R3 in ( Seg ( width C72 ) ) by L763 , MATRPROB:12;
thus L765: thesis by L764 , L749 , L762 , L763 , FINSEQ_1:def 3 , MATRPROB:14;
end;
end;
theorem
L767: (for R1 being non  empty set holds (for B64 being (Matrix of R1) holds (for B65 being (FinSequence of ( R1 * )) holds ((( len B65 ) = ( len B64 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B64 )) implies ( B65 . ( R4 + 1 ) ) = ( ( B65 . R4 ) ^ ( B64 . ( R4 + 1 ) ) )))) implies (for R3 being (Element of ( NAT )) holds ((R3 >= 1 & R3 < ( len B65 )) implies (for R5 being (Element of ( NAT )) holds (R5 in ( dom ( B65 . R3 ) ) implies ( ( B65 . R3 ) . R5 ) = ( ( B65 . ( R3 + 1 ) ) . R5 )))))))))
proof
let R1 being non  empty set;
let C74 being (Matrix of R1);
let C75 being (FinSequence of ( R1 * ));
assume that
L768: ( len C75 ) = ( len C74 )
and
L769: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C74 )) implies ( C75 . ( R4 + 1 ) ) = ( ( C75 . R4 ) ^ ( C74 . ( R4 + 1 ) ) )));
let R3 being (Element of ( NAT ));
assume that
L770: R3 >= 1
and
L771: R3 < ( len C75 );
L772: ( C75 . ( R3 + 1 ) ) = ( ( C75 . R3 ) ^ ( C74 . ( R3 + 1 ) ) ) by L768 , L769 , L770 , L771;
let R5 being (Element of ( NAT ));
assume L773: R5 in ( dom ( C75 . R3 ) );
thus L774: thesis by L773 , L772 , FINSEQ_1:def 7;
end;
theorem
L775: (for R1 being non  empty set holds (for B66 being (Matrix of R1) holds (for B67 being (FinSequence of ( R1 * )) holds ((( len B67 ) = ( len B66 ) & ( B67 . 1 ) = ( B66 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B66 )) implies ( B67 . ( R4 + 1 ) ) = ( ( B67 . R4 ) ^ ( B66 . ( R4 + 1 ) ) )))) implies (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom B67 ) & R3 in ( dom B67 ) & R2 <= R3) implies (for R5 being (Element of ( NAT )) holds (R5 in ( dom ( B67 . R2 ) ) implies ( ( B67 . R2 ) . R5 ) = ( ( B67 . R3 ) . R5 ))))))))))
proof
let R1 being non  empty set;
let C76 being (Matrix of R1);
let C77 being (FinSequence of ( R1 * ));
assume that
L776: ( len C77 ) = ( len C76 )
and
L777: ( C77 . 1 ) = ( C76 . 1 )
and
L778: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C76 )) implies ( C77 . ( R4 + 1 ) ) = ( ( C77 . R4 ) ^ ( C76 . ( R4 + 1 ) ) )));
defpred S4[ (Element of ( NAT )) ] means ($1 in ( dom C77 ) implies (for R2 being (Element of ( NAT )) holds ((R2 in ( dom C77 ) & R2 <= $1) implies (for R5 being (Element of ( NAT )) holds (R5 in ( dom ( C77 . R2 ) ) implies ( ( C77 . R2 ) . R5 ) = ( ( C77 . $1 ) . R5 ))))));
L779: (for R3 being (Element of ( NAT )) holds (S4[ R3 ] implies S4[ ( R3 + 1 ) ]))
proof
let R3 being (Element of ( NAT ));
assume that
L780: (R3 in ( dom C77 ) implies (for R2 being (Element of ( NAT )) holds ((R2 in ( dom C77 ) & R2 <= R3) implies (for R5 being (Element of ( NAT )) holds (R5 in ( dom ( C77 . R2 ) ) implies ( ( C77 . R2 ) . R5 ) = ( ( C77 . R3 ) . R5 ))))));
assume L781: ( R3 + 1 ) in ( dom C77 );
L782: ( R3 + 1 ) <= ( len C77 ) by L781 , FINSEQ_3:25;
L783: ( R3 + 1 ) >= 1 by L781 , FINSEQ_3:25;
L784: (( R3 + 1 ) = 1 or ( R3 + 1 ) > 1) by L783 , XXREAL_0:1;
let R2 being (Element of ( NAT ));
assume that
L785: R2 in ( dom C77 )
and
L786: R2 <= ( R3 + 1 );
L787: R2 in ( Seg ( len C77 ) ) by L785 , FINSEQ_1:def 3;
L788: R2 >= 1 by L787 , FINSEQ_1:1;
per cases  by L784 , NAT_1:13;
suppose L789: ( R3 + 1 ) = 1;

thus L790: thesis by L789 , L786 , L788 , XXREAL_0:1;
end;
suppose L791: R3 >= 1;

L792: R3 < ( len C77 ) by L782 , NAT_1:13;
L793: R3 in ( Seg ( len C77 ) ) by L792 , L791 , FINSEQ_1:1;
L794: R3 in ( dom C77 ) by L793 , FINSEQ_1:def 3;
thus L795: (for R5 being (Element of ( NAT )) holds (R5 in ( dom ( C77 . R2 ) ) implies ( ( C77 . R2 ) . R5 ) = ( ( C77 . ( R3 + 1 ) ) . R5 )))
proof
let R5 being (Element of ( NAT ));
assume that
L796: R5 in ( dom ( C77 . R2 ) );
per cases  by L786 , NAT_1:8;
suppose L797: R2 <= R3;

L798: ( dom ( C77 . R2 ) ) c= ( dom ( C77 . R3 ) ) by L797 , L776 , L777 , L778 , L785 , L794 , L734;
thus L799: ( ( C77 . R2 ) . R5 ) = ( ( C77 . R3 ) . R5 ) by L780 , L785 , L793 , L796 , L797 , FINSEQ_1:def 3
.= ( ( C77 . ( R3 + 1 ) ) . R5 ) by L776 , L778 , L791 , L792 , L796 , L798 , L767;
end;
suppose L800: R2 = ( R3 + 1 );

thus L801: thesis by L800;
end;
end;

end;
end;
L797: S4[ ( 0 ) ];
L798: (for R3 being (Element of ( NAT )) holds S4[ R3 ]) from NAT_1:sch 1(L797 , L779);
thus L799: thesis by L798;
end;
theorem
L800: (for R1 being non  empty set holds (for B68 being (Matrix of R1) holds (for B69 being (FinSequence of ( R1 * )) holds ((( len B69 ) = ( len B68 ) & ( B69 . 1 ) = ( B68 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B68 )) implies ( B69 . ( R4 + 1 ) ) = ( ( B69 . R4 ) ^ ( B68 . ( R4 + 1 ) ) )))) implies (for R3 being (Element of ( NAT )) holds ((R3 >= 1 & R3 < ( len B69 )) implies (for R5 being (Element of ( NAT )) holds (R5 in ( Seg ( width B68 ) ) implies (( ( R3 * ( width B68 ) ) + R5 ) in ( dom ( B69 . ( R3 + 1 ) ) ) & ( ( B69 . ( R3 + 1 ) ) . ( ( R3 * ( width B68 ) ) + R5 ) ) = ( ( B68 . ( R3 + 1 ) ) . R5 ))))))))))
proof
let R1 being non  empty set;
let C78 being (Matrix of R1);
let C79 being (FinSequence of ( R1 * ));
assume that
L801: ( len C79 ) = ( len C78 )
and
L802: ( C79 . 1 ) = ( C78 . 1 )
and
L803: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C78 )) implies ( C79 . ( R4 + 1 ) ) = ( ( C79 . R4 ) ^ ( C78 . ( R4 + 1 ) ) )));
let R3 being (Element of ( NAT ));
assume that
L804: R3 >= 1
and
L805: R3 < ( len C79 );
L806: ( R3 + 1 ) >= 1 by L804 , NAT_1:13;
L807: R3 in ( Seg ( len C79 ) ) by L804 , L805 , FINSEQ_1:1;
L808: R3 in ( dom C79 ) by L807 , FINSEQ_1:def 3;
L809: ( len ( C79 . R3 ) ) = ( R3 * ( width C78 ) ) by L808 , L801 , L802 , L803 , L707;
let R5 being (Element of ( NAT ));
assume that
L810: R5 in ( Seg ( width C78 ) );
L811: R5 <= ( width C78 ) by L810 , FINSEQ_1:1;
L812: ( R3 + 1 ) <= ( len C78 ) by L801 , L805 , NAT_1:13;
L813: ( R3 + 1 ) in ( Seg ( len C78 ) ) by L812 , L806 , FINSEQ_1:1;
L814: ( R3 + 1 ) in ( dom C78 ) by L813 , FINSEQ_1:def 3;
L815: R5 in ( dom ( C78 . ( R3 + 1 ) ) ) by L814 , L810 , L438;
L816: R5 >= 1 by L810 , FINSEQ_1:1;
L817: ( ( R3 * ( width C78 ) ) + R5 ) >= ( ( 0 ) + 1 ) by L816 , XREAL_1:7;
L818: ( dom C79 ) = ( dom C78 ) by L801 , FINSEQ_3:29;
L819: ( len ( C79 . ( R3 + 1 ) ) ) = ( ( R3 + 1 ) * ( width C78 ) ) by L818 , L801 , L802 , L803 , L814 , L707
.= ( ( R3 * ( width C78 ) ) + ( width C78 ) );
L820: ( ( R3 * ( width C78 ) ) + R5 ) <= ( len ( C79 . ( R3 + 1 ) ) ) by L819 , L811 , XREAL_1:7;
L821: ( ( R3 * ( width C78 ) ) + R5 ) in ( Seg ( len ( C79 . ( R3 + 1 ) ) ) ) by L820 , L817 , FINSEQ_1:1;
thus L822: ( ( R3 * ( width C78 ) ) + R5 ) in ( dom ( C79 . ( R3 + 1 ) ) ) by L821 , FINSEQ_1:def 3;
L823: ( C79 . ( R3 + 1 ) ) = ( ( C79 . R3 ) ^ ( C78 . ( R3 + 1 ) ) ) by L801 , L803 , L804 , L805;
thus L824: thesis by L823 , L815 , L809 , FINSEQ_1:def 7;
end;
theorem
L825: (for R1 being non  empty set holds (for B70 being (Matrix of R1) holds (for B71 being (FinSequence of ( R1 * )) holds ((( len B71 ) = ( len B70 ) & ( B71 . 1 ) = ( B70 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B70 )) implies ( B71 . ( R4 + 1 ) ) = ( ( B71 . R4 ) ^ ( B70 . ( R4 + 1 ) ) )))) implies (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B70 ) implies (( ( ( R2 - 1 ) * ( width B70 ) ) + R3 ) in ( dom ( B71 . R2 ) ) & ( B70 * (R2 , R3) ) = ( ( B71 . R2 ) . ( ( ( R2 - 1 ) * ( width B70 ) ) + R3 ) )))))))))
proof
let R1 being non  empty set;
let C80 being (Matrix of R1);
let C81 being (FinSequence of ( R1 * ));
assume that
L826: ( len C81 ) = ( len C80 )
and
L827: ( C81 . 1 ) = ( C80 . 1 )
and
L828: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C80 )) implies ( C81 . ( R4 + 1 ) ) = ( ( C81 . R4 ) ^ ( C80 . ( R4 + 1 ) ) )));
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L829: [ R2 , R3 ] in ( Indices C80 );
L830: R3 in ( Seg ( width C80 ) ) by L829 , MATRPROB:12;
L831: R2 in ( Seg ( len C80 ) ) by L829 , MATRPROB:12;
L832: R2 in ( dom C80 ) by L831 , FINSEQ_1:def 3;
L833: R2 >= 1 by L832 , FINSEQ_3:25;
L834: R2 <= ( len C80 ) by L832 , FINSEQ_3:25;
per cases  by L833 , XXREAL_0:1;
suppose L835: R2 > 1;

reconsider D37 = ( R2 - 1 ) as (Element of ( NAT )) by L835 , NAT_1:20;
L836: R2 < ( ( len C80 ) + 1 ) by L834 , NAT_1:13;
L837: ( R2 - 1 ) < ( ( ( len C80 ) + 1 ) - 1 ) by L836 , XREAL_1:14;
L838: ( D37 + 1 ) > 1 by L835;
L839: D37 >= 1 by L838 , NAT_1:13;
L840: ( ( C81 . ( D37 + 1 ) ) . ( ( D37 * ( width C80 ) ) + R3 ) ) = ( ( C80 . ( D37 + 1 ) ) . R3 ) by L839 , L826 , L827 , L828 , L830 , L837 , L800;
thus L841: thesis by L840 , L826 , L827 , L828 , L829 , L830 , L839 , L837 , L800 , MATRPROB:14;
end;
suppose L842: R2 = 1;

thus L843: thesis by L842 , L826 , L827 , L828 , L829 , L747;
end;
end;
theorem
L845: (for R1 being non  empty set holds (for B72 being (Matrix of R1) holds (for B73 being (FinSequence of ( R1 * )) holds ((( len B73 ) = ( len B72 ) & ( B73 . 1 ) = ( B72 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B72 )) implies ( B73 . ( R4 + 1 ) ) = ( ( B73 . R4 ) ^ ( B72 . ( R4 + 1 ) ) )))) implies (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B72 ) implies (( ( ( R2 - 1 ) * ( width B72 ) ) + R3 ) in ( dom ( B73 . ( len B72 ) ) ) & ( B72 * (R2 , R3) ) = ( ( B73 . ( len B72 ) ) . ( ( ( R2 - 1 ) * ( width B72 ) ) + R3 ) )))))))))
proof
let R1 being non  empty set;
let C82 being (Matrix of R1);
let C83 being (FinSequence of ( R1 * ));
assume that
L846: ( len C83 ) = ( len C82 )
and
L847: ( C83 . 1 ) = ( C82 . 1 )
and
L848: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C82 )) implies ( C83 . ( R4 + 1 ) ) = ( ( C83 . R4 ) ^ ( C82 . ( R4 + 1 ) ) )));
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L849: [ R2 , R3 ] in ( Indices C82 );
L850: ( ( ( R2 - 1 ) * ( width C82 ) ) + R3 ) in ( dom ( C83 . R2 ) ) by L846 , L847 , L848 , L849 , L825;
L851: ( C82 * (R2 , R3) ) = ( ( C83 . R2 ) . ( ( ( R2 - 1 ) * ( width C82 ) ) + R3 ) ) by L846 , L847 , L848 , L849 , L825;
L852: R2 in ( Seg ( len C82 ) ) by L849 , MATRPROB:12;
L853: ( len C82 ) <> ( 0 ) by L852;
L854: R2 <= ( len C82 ) by L852 , FINSEQ_1:1;
L855: ( len C82 ) >= 1 by L853 , NAT_1:14;
L856: ( len C82 ) in ( Seg ( len C83 ) ) by L855 , L846 , FINSEQ_1:1;
L857: ( len C82 ) in ( dom C83 ) by L856 , FINSEQ_1:def 3;
L858: R2 in ( dom C83 ) by L846 , L852 , FINSEQ_1:def 3;
L859: ( dom ( C83 . R2 ) ) c= ( dom ( C83 . ( len C82 ) ) ) by L858 , L846 , L847 , L848 , L854 , L857 , L734;
thus L860: thesis by L859 , L846 , L847 , L848 , L854 , L858 , L857 , L850 , L851 , L775;
end;
theorem
L861: (for B74 being (Matrix of ( REAL )) holds (for B75 being (FinSequence of ( ( REAL ) * )) holds ((for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B74 )) implies ( B75 . ( R4 + 1 ) ) = ( ( B75 . R4 ) ^ ( B74 . ( R4 + 1 ) ) ))) implies (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B74 )) implies ( Sum ( B75 . ( R4 + 1 ) ) ) = ( ( Sum ( B75 . R4 ) ) + ( Sum ( B74 . ( R4 + 1 ) ) ) ))))))
proof
let C84 being (Matrix of ( REAL ));
let C85 being (FinSequence of ( ( REAL ) * ));
assume that
L862: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C84 )) implies ( C85 . ( R4 + 1 ) ) = ( ( C85 . R4 ) ^ ( C84 . ( R4 + 1 ) ) )));
let R4 being (Element of ( NAT ));
assume that
L863: R4 >= 1
and
L864: R4 < ( len C84 );
L865: ( C85 . ( R4 + 1 ) ) = ( ( C85 . R4 ) ^ ( C84 . ( R4 + 1 ) ) ) by L862 , L863 , L864;
thus L866: thesis by L865 , RVSUM_1:75;
end;
theorem
L867: (for B76 being (Matrix of ( REAL )) holds (for B77 being (FinSequence of ( ( REAL ) * )) holds ((( len B77 ) = ( len B76 ) & ( B77 . 1 ) = ( B76 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len B76 )) implies ( B77 . ( R4 + 1 ) ) = ( ( B77 . R4 ) ^ ( B76 . ( R4 + 1 ) ) )))) implies ( SumAll B76 ) = ( Sum ( B77 . ( len B76 ) ) ))))
proof
let C86 being (Matrix of ( REAL ));
let C87 being (FinSequence of ( ( REAL ) * ));
assume that
L868: ( len C87 ) = ( len C86 )
and
L869: ( C87 . 1 ) = ( C86 . 1 )
and
L870: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C86 )) implies ( C87 . ( R4 + 1 ) ) = ( ( C87 . R4 ) ^ ( C86 . ( R4 + 1 ) ) )));
per cases ;
suppose L871: ( len C86 ) = ( 0 );

L872: C87 = ( {} ) by L871 , L868;
thus L873: ( Sum ( C87 . ( len C86 ) ) ) = ( 0 ) by L872 , FUNCT_1:def 2 , RELAT_1:38 , RVSUM_1:72
.= ( SumAll C86 ) by L871 , MATRPROB:23;
end;
suppose L874: ( len C86 ) > ( 0 );

L875: ( len C86 ) >= 1 by L874 , NAT_1:14;
set D38 = ( LineSum C86 );
L876: ( len D38 ) = ( len C86 ) by MATRPROB:def 1;
consider C88 being (FinSequence of ( REAL )) such that L877: ( len C88 ) = ( len D38 ) and L878: ( C88 . 1 ) = ( D38 . 1 ) and L879: (for R4 being (Element of ( NAT )) holds ((( 0 ) <> R4 & R4 < ( len D38 )) implies ( C88 . ( R4 + 1 ) ) = ( ( C88 . R4 ) + ( D38 . ( R4 + 1 ) ) ))) and L880: ( Sum D38 ) = ( C88 . ( len D38 ) ) by L876 , L874 , L203 , NAT_1:14;
L881: ( len C88 ) = ( len C86 ) by L877 , MATRPROB:def 1
.= ( len ( Sum C87 ) ) by L868 , MATRPROB:def 1;
L882: ( dom C88 ) = ( Seg ( len C88 ) ) by FINSEQ_1:def 3;
L883: ( len ( Sum C87 ) ) = ( len C87 ) by MATRPROB:def 1;
L884: ( dom ( Sum C87 ) ) = ( dom C87 ) by L883 , FINSEQ_3:29;
L885: (for B78 being Nat holds (B78 in ( dom C88 ) implies ( C88 . B78 ) = ( ( Sum C87 ) . B78 )))
proof
defpred S5[ Nat ] means ($1 in ( dom C88 ) implies ( C88 . $1 ) = ( ( Sum C87 ) . $1 ));
L886: (for R4 being (Element of ( NAT )) holds (S5[ R4 ] implies S5[ ( R4 + 1 ) ]))
proof
let R4 being (Element of ( NAT ));
assume that
L887: S5[ R4 ];
assume L888: ( R4 + 1 ) in ( dom C88 );
L889: ( R4 + 1 ) <= ( len C88 ) by L888 , L882 , FINSEQ_1:1;
L890: ( R4 + 1 ) in ( dom ( Sum C87 ) ) by L868 , L876 , L883 , L877 , L882 , L888 , FINSEQ_1:def 3;
L891: ( R4 + 1 ) in ( dom C86 ) by L876 , L877 , L882 , L888 , FINSEQ_1:def 3;
L892: ( R4 + 1 ) >= 1 by L882 , L888 , FINSEQ_1:1;
L893: (( R4 + 1 ) = 1 or ( R4 + 1 ) > 1) by L892 , XXREAL_0:1;
per cases  by L893 , NAT_1:13;
suppose L894: ( R4 + 1 ) = 1;

L895: 1 in ( Seg ( len C86 ) ) by L875 , FINSEQ_1:1;
L896: 1 in ( dom C86 ) by L895 , FINSEQ_1:def 3;
L897: 1 in ( dom C87 ) by L868 , L895 , FINSEQ_1:def 3;
L898: ( C88 . ( R4 + 1 ) ) = ( Sum ( Line (C86 , 1) ) ) by L878 , L894 , L895 , MATRPROB:20
.= ( Sum ( C86 . 1 ) ) by L896 , MATRIX_2:16
.= ( ( Sum C87 ) . 1 ) by L869 , L884 , L897 , MATRPROB:def 1;
thus L899: thesis by L898 , L894;
end;
suppose L900: R4 >= 1;

L901: R4 < ( len C88 ) by L889 , NAT_1:13;
L902: R4 < ( len C86 ) by L901 , L877 , MATRPROB:def 1;
L903: R4 in ( Seg ( len C88 ) ) by L900 , L901 , FINSEQ_1:1;
L904: R4 in ( dom ( Sum C87 ) ) by L903 , L881 , FINSEQ_1:def 3;
L905: ( C88 . ( R4 + 1 ) ) = ( ( C88 . R4 ) + ( D38 . ( R4 + 1 ) ) ) by L877 , L879 , L900 , L901
.= ( ( Sum ( C87 . R4 ) ) + ( D38 . ( R4 + 1 ) ) ) by L882 , L887 , L900 , L901 , L904 , FINSEQ_1:1 , MATRPROB:def 1
.= ( ( Sum ( C87 . R4 ) ) + ( Sum ( Line (C86 , ( R4 + 1 )) ) ) ) by L876 , L877 , L882 , L888 , MATRPROB:20
.= ( ( Sum ( C87 . R4 ) ) + ( Sum ( C86 . ( R4 + 1 ) ) ) ) by L891 , MATRIX_2:16
.= ( Sum ( C87 . ( R4 + 1 ) ) ) by L870 , L900 , L902 , L861
.= ( ( Sum C87 ) . ( R4 + 1 ) ) by L890 , MATRPROB:def 1;
thus L906: thesis by L905;
end;
end;
L908: S5[ ( 0 ) ] by L882 , FINSEQ_1:1;
L909: (for R3 being (Element of ( NAT )) holds S5[ R3 ]) from NAT_1:sch 1(L908 , L886);
thus L910: thesis by L909;
end;
L911: C88 = ( Sum C87 ) by L885 , L881 , FINSEQ_2:9;
L912: ( len C86 ) in ( Seg ( len C86 ) ) by L874 , FINSEQ_1:3;
L913: ( len C86 ) in ( dom ( Sum C87 ) ) by L912 , L868 , L883 , FINSEQ_1:def 3;
thus L914: ( SumAll C86 ) = ( Sum D38 ) by MATRPROB:def 3
.= ( ( Sum C87 ) . ( len C86 ) ) by L880 , L911 , MATRPROB:def 1
.= ( Sum ( C87 . ( len C86 ) ) ) by L913 , MATRPROB:def 1;
end;
end;
definition
let C89 being non  empty set;
let C90 being (Matrix of C89);
func Mx2FinS C90 -> (FinSequence of C89) means 
:L916: it = ( {} ) if ( len C90 ) = ( 0 ) otherwise (ex B79 being (FinSequence of ( C89 * )) st (it = ( B79 . ( len C90 ) ) & ( len B79 ) = ( len C90 ) & ( B79 . 1 ) = ( C90 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C90 )) implies ( B79 . ( R4 + 1 ) ) = ( ( B79 . R4 ) ^ ( C90 . ( R4 + 1 ) ) )))));
existence
proof
thus L917: (( len C90 ) = ( 0 ) implies (ex B80 being (FinSequence of C89) st B80 = ( {} )))
proof
assume L918: ( len C90 ) = ( 0 );
L919: ( <*> C89 ) = ( {} );
thus L920: thesis by L919;
end;

thus L921: (( len C90 ) <> ( 0 ) implies (ex B81 being (FinSequence of C89) st (ex B82 being (FinSequence of ( C89 * )) st (B81 = ( B82 . ( len C90 ) ) & ( len B82 ) = ( len C90 ) & ( B82 . 1 ) = ( C90 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C90 )) implies ( B82 . ( R4 + 1 ) ) = ( ( B82 . R4 ) ^ ( C90 . ( R4 + 1 ) ) )))))))
proof
reconsider D39 = ( C90 . 1 ) as (Element of ( C89 * )) by FINSEQ_1:def 11;
defpred S6[ (Element of ( NAT )) , set , set ] means (ex B83 , B84 being (Element of ( C89 * )) st (B84 = $2 & B83 = ( C90 . ( $1 + 1 ) ) & $3 = ( B84 ^ B83 )));
assume L922: ( len C90 ) <> ( 0 );
L923: (for B85 being (Element of ( NAT )) holds ((1 <= B85 & B85 < ( len C90 )) implies (for B86 being (Element of ( C89 * )) holds (ex B87 being (Element of ( C89 * )) st S6[ B85 , B86 , B87 ]))))
proof
let C91 being (Element of ( NAT ));
assume that
L924: 1 <= C91
and
L925: C91 < ( len C90 );
L926: 1 <= ( C91 + 1 ) by NAT_1:11;
L927: ( C91 + 1 ) <= ( len C90 ) by L925 , NAT_1:13;
L928: ( C91 + 1 ) in ( dom C90 ) by L927 , L926 , FINSEQ_3:25;
reconsider D40 = ( C90 . ( C91 + 1 ) ) as (Element of ( C89 * )) by L928 , FINSEQ_2:11;
let C92 being (Element of ( C89 * ));
set D41 = ( C92 ^ D40 );
reconsider D42 = D41 as (Element of ( C89 * )) by FINSEQ_1:def 11;
take D42;
take D40;
take C92;
thus L929: thesis;
end;
L930: (ex B88 being (FinSequence of ( C89 * )) st (( len B88 ) = ( len C90 ) & (( B88 . 1 ) = D39 or ( len C90 ) = ( 0 )) & (for B89 being (Element of ( NAT )) holds ((1 <= B89 & B89 < ( len C90 )) implies S6[ B89 , ( B88 . B89 ) , ( B88 . ( B89 + 1 ) ) ])))) from RECDEF_1:sch 4(L923);
consider C93 being (FinSequence of ( C89 * )) such that L931: ( len C93 ) = ( len C90 ) and L932: (( C93 . 1 ) = D39 or ( len C90 ) = ( 0 )) and L933: (for B90 being (Element of ( NAT )) holds ((1 <= B90 & B90 < ( len C90 )) implies S6[ B90 , ( C93 . B90 ) , ( C93 . ( B90 + 1 ) ) ])) by L930;
reconsider D43 = ( C93 . ( len C90 ) ) as (FinSequence of C89);
take D43;
L934: (for B91 being (Element of ( NAT )) holds ((1 <= B91 & B91 < ( len C90 )) implies ( C93 . ( B91 + 1 ) ) = ( ( C93 . B91 ) ^ ( C90 . ( B91 + 1 ) ) )))
proof
let C94 being (Element of ( NAT ));
assume that
L935: 1 <= C94
and
L936: C94 < ( len C90 );
L937: (ex B92 , B93 being (Element of ( C89 * )) st (B93 = ( C93 . C94 ) & B92 = ( C90 . ( C94 + 1 ) ) & ( C93 . ( C94 + 1 ) ) = ( B93 ^ B92 ))) by L933 , L935 , L936;
thus L938: thesis by L937;
end;
thus L939: thesis by L934 , L922 , L931 , L932;
end;

end;
uniqueness
proof
let C95 , C96 being (FinSequence of C89);
thus L922: ((( len C90 ) = ( 0 ) & C95 = ( {} ) & C96 = ( {} )) implies C95 = C96);
assume L923: ( len C90 ) <> ( 0 );
L924: ( len C90 ) >= 1 by L923 , NAT_1:14;
given C97 being (FinSequence of ( C89 * )) such that
L925: C95 = ( C97 . ( len C90 ) )
and
L926: ( len C97 ) = ( len C90 )
and
L927: ( C97 . 1 ) = ( C90 . 1 )
and
L928: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C90 )) implies ( C97 . ( R4 + 1 ) ) = ( ( C97 . R4 ) ^ ( C90 . ( R4 + 1 ) ) )));

given C98 being (FinSequence of ( C89 * )) such that
L929: C96 = ( C98 . ( len C90 ) )
and
L930: ( len C98 ) = ( len C90 )
and
L931: ( C98 . 1 ) = ( C90 . 1 )
and
L932: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C90 )) implies ( C98 . ( R4 + 1 ) ) = ( ( C98 . R4 ) ^ ( C90 . ( R4 + 1 ) ) )));

L933: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 <= ( len C90 )) implies ( C97 . R4 ) = ( C98 . R4 )))
proof
defpred S7[ (Element of ( NAT )) ] means (($1 >= 1 & $1 <= ( len C90 )) implies ( C97 . $1 ) = ( C98 . $1 ));
L934: (for B94 being (Element of ( NAT )) holds (S7[ B94 ] implies S7[ ( B94 + 1 ) ]))
proof
let C99 being (Element of ( NAT ));
assume that
L935: ((C99 >= 1 & C99 <= ( len C90 )) implies ( C97 . C99 ) = ( C98 . C99 ));
assume that
L936: ( C99 + 1 ) >= 1
and
L937: ( C99 + 1 ) <= ( len C90 );
L938:
now
per cases ;
suppose L939: C99 = ( 0 );

thus L940: thesis by L939 , L927 , L931;
end;
suppose L941: C99 <> ( 0 );

L942: C99 < ( len C90 ) by L937 , NAT_1:13;
thus L943: ( C97 . ( C99 + 1 ) ) = ( ( C98 . C99 ) ^ ( C90 . ( C99 + 1 ) ) ) by L942 , L928 , L935 , L941 , NAT_1:14
.= ( C98 . ( C99 + 1 ) ) by L932 , L941 , L942 , NAT_1:14;
end;
end;
thus L945: thesis by L938;
end;
L946: S7[ ( 0 ) ];
thus L947: (for B95 being (Element of ( NAT )) holds S7[ B95 ]) from NAT_1:sch 1(L946 , L934);
end;
thus L948: thesis by L933 , L924 , L925 , L929;
end;
consistency;
end;
theorem
L950: (for R1 being non  empty set holds (for B96 being (Matrix of R1) holds ( len ( Mx2FinS B96 ) ) = ( ( len B96 ) * ( width B96 ) )))
proof
let R1 being non  empty set;
let C100 being (Matrix of R1);
per cases ;
suppose L951: ( len C100 ) = ( 0 );

L952: ( Mx2FinS C100 ) = ( {} ) by L951 , L916;
thus L953: thesis by L952 , L951;
end;
suppose L954: ( len C100 ) > ( 0 );

consider C101 being (FinSequence of ( R1 * )) such that L955: ( Mx2FinS C100 ) = ( C101 . ( len C100 ) ) and L956: ( len C101 ) = ( len C100 ) and L957: ( C101 . 1 ) = ( C100 . 1 ) and L958: (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C100 )) implies ( C101 . ( R4 + 1 ) ) = ( ( C101 . R4 ) ^ ( C100 . ( R4 + 1 ) ) ))) by L954 , L916;
L959: ( len C100 ) in ( Seg ( len C100 ) ) by L954 , FINSEQ_1:3;
L960: ( len C100 ) in ( dom C101 ) by L959 , L956 , FINSEQ_1:def 3;
thus L961: thesis by L960 , L955 , L956 , L957 , L958 , L707;
end;
end;
theorem
L963: (for R1 being non  empty set holds (for B97 being (Matrix of R1) holds (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B97 ) implies (( ( ( R2 - 1 ) * ( width B97 ) ) + R3 ) in ( dom ( Mx2FinS B97 ) ) & ( B97 * (R2 , R3) ) = ( ( Mx2FinS B97 ) . ( ( ( R2 - 1 ) * ( width B97 ) ) + R3 ) )))))))
proof
let R1 being non  empty set;
let C102 being (Matrix of R1);
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L964: [ R2 , R3 ] in ( Indices C102 );
L965: ( Seg ( len C102 ) ) <> ( {} ) by L964 , MATRPROB:12;
L966: ( len C102 ) <> ( 0 ) by L965;
L967: (ex B98 being (FinSequence of ( R1 * )) st (( Mx2FinS C102 ) = ( B98 . ( len C102 ) ) & ( len B98 ) = ( len C102 ) & ( B98 . 1 ) = ( C102 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len C102 )) implies ( B98 . ( R4 + 1 ) ) = ( ( B98 . R4 ) ^ ( C102 . ( R4 + 1 ) ) ))))) by L966 , L916;
thus L968: thesis by L967 , L964 , L845;
end;
theorem
L969: (for R1 being non  empty set holds (for B99 being (Matrix of R1) holds (for R4 being (Element of ( NAT )) holds (for R5 being (Element of ( NAT )) holds ((R4 in ( dom ( Mx2FinS B99 ) ) & R5 = ( R4 - 1 )) implies ([ ( ( R5 div ( width B99 ) ) + 1 ) , ( ( R5 mod ( width B99 ) ) + 1 ) ] in ( Indices B99 ) & ( ( Mx2FinS B99 ) . R4 ) = ( B99 * (( ( R5 div ( width B99 ) ) + 1 ) , ( ( R5 mod ( width B99 ) ) + 1 )) )))))))
proof
let R1 being non  empty set;
let C103 being (Matrix of R1);
let R4 being (Element of ( NAT ));
let R5 being (Element of ( NAT ));
assume that
L970: R4 in ( dom ( Mx2FinS C103 ) )
and
L971: R5 = ( R4 - 1 );
set D44 = ( ( R5 mod ( width C103 ) ) + 1 );
set D45 = ( ( R5 div ( width C103 ) ) + 1 );
L972: ( len ( Mx2FinS C103 ) ) = ( ( len C103 ) * ( width C103 ) ) by L950;
L973: R4 in ( Seg ( len ( Mx2FinS C103 ) ) ) by L970 , FINSEQ_1:def 3;
L974: R4 <= ( len ( Mx2FinS C103 ) ) by L973 , FINSEQ_1:1;
L975: R4 < ( ( ( len C103 ) * ( width C103 ) ) + 1 ) by L974 , L972 , NAT_1:13;
L976: ( R4 - 1 ) < ( ( ( ( len C103 ) * ( width C103 ) ) + 1 ) - 1 ) by L975 , XREAL_1:9;
L977: ( Mx2FinS C103 ) <> ( {} ) by L970;
L978: ( width C103 ) <> ( 0 ) by L977 , L972;
L979: ( width C103 ) > ( 0 ) by L977 , L972;
L980: R5 = ( ( ( R5 div ( width C103 ) ) * ( width C103 ) ) + ( R5 mod ( width C103 ) ) ) by L979 , NAT_D:2;
L981: ( width C103 ) divides ( ( len C103 ) * ( width C103 ) ) by NAT_D:def 3;
L982: ( R5 div ( width C103 ) ) < ( ( ( len C103 ) * ( width C103 ) ) div ( width C103 ) ) by L981 , L971 , L978 , L976 , L1;
L983: ( R5 div ( width C103 ) ) < ( len C103 ) by L982 , L978 , NAT_D:18;
L984: D45 <= ( len C103 ) by L983 , NAT_1:13;
L985: ( R5 mod ( width C103 ) ) < ( width C103 ) by L979 , NAT_D:1;
L986: D44 <= ( width C103 ) by L985 , NAT_1:13;
L987: D44 >= 1 by NAT_1:11;
L988: D44 in ( Seg ( width C103 ) ) by L987 , L986 , FINSEQ_1:1;
L989: D45 >= 1 by NAT_1:11;
L990: D45 in ( Seg ( len C103 ) ) by L989 , L984 , FINSEQ_1:1;
thus L991: [ D45 , D44 ] in ( Indices C103 ) by L990 , L988 , MATRPROB:12;
L992: ( C103 * (D45 , D44) ) = ( ( Mx2FinS C103 ) . ( ( ( D45 - 1 ) * ( width C103 ) ) + D44 ) ) by L991 , L963
.= ( ( Mx2FinS C103 ) . R4 ) by L971 , L980;
thus L993: thesis by L992;
end;
theorem
L994: (for R16 being (Matrix of ( REAL )) holds ( SumAll R16 ) = ( Sum ( Mx2FinS R16 ) ))
proof
let R16 being (Matrix of ( REAL ));
per cases ;
suppose L995: ( len R16 ) = ( 0 );

thus L996: ( Sum ( Mx2FinS R16 ) ) = ( 0 ) by L995 , L916 , RVSUM_1:72
.= ( SumAll R16 ) by L995 , MATRPROB:23;
end;
suppose L997: ( len R16 ) > ( 0 );

L998: (ex B100 being (FinSequence of ( ( REAL ) * )) st (( Mx2FinS R16 ) = ( B100 . ( len R16 ) ) & ( len B100 ) = ( len R16 ) & ( B100 . 1 ) = ( R16 . 1 ) & (for R4 being (Element of ( NAT )) holds ((R4 >= 1 & R4 < ( len R16 )) implies ( B100 . ( R4 + 1 ) ) = ( ( B100 . R4 ) ^ ( R16 . ( R4 + 1 ) ) ))))) by L997 , L916;
thus L999: thesis by L998 , L867;
end;
end;
theorem
L1001: (for R16 being (Matrix of ( REAL )) holds (R16 is  m-nonnegative iff ( Mx2FinS R16 ) is  nonnegative))
proof
let R16 being (Matrix of ( REAL ));
thus L1002:now
assume L1003: R16 is  m-nonnegative;
L1004: (for R4 being (Element of ( NAT )) holds (R4 in ( dom ( Mx2FinS R16 ) ) implies ( ( Mx2FinS R16 ) . R4 ) >= ( 0 )))
proof
let R2 being (Element of ( NAT ));
assume that
L1005: R2 in ( dom ( Mx2FinS R16 ) );
L1006: R2 in ( Seg ( len ( Mx2FinS R16 ) ) ) by L1005 , FINSEQ_1:def 3;
L1007: R2 >= 1 by L1006 , FINSEQ_1:1;
reconsider D46 = ( R2 - 1 ) as (Element of ( NAT )) by L1007 , NAT_1:21;
L1008: ( ( Mx2FinS R16 ) . R2 ) = ( R16 * (( ( D46 div ( width R16 ) ) + 1 ) , ( ( D46 mod ( width R16 ) ) + 1 )) ) by L1005 , L969;
L1009: [ ( ( D46 div ( width R16 ) ) + 1 ) , ( ( D46 mod ( width R16 ) ) + 1 ) ] in ( Indices R16 ) by L1005 , L969;
thus L1010: thesis by L1009 , L1003 , L1008 , MATRPROB:def 6;
end;
thus L1011: ( Mx2FinS R16 ) is  nonnegative by L1004 , L229;
end;
assume L1012: ( Mx2FinS R16 ) is  nonnegative;
L1013:
now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L1014: [ R2 , R3 ] in ( Indices R16 );
L1015: ( R16 * (R2 , R3) ) = ( ( Mx2FinS R16 ) . ( ( ( R2 - 1 ) * ( width R16 ) ) + R3 ) ) by L1014 , L963;
L1016: ( ( ( R2 - 1 ) * ( width R16 ) ) + R3 ) in ( dom ( Mx2FinS R16 ) ) by L1014 , L963;
thus L1017: ( R16 * (R2 , R3) ) >= ( 0 ) by L1016 , L1012 , L1015 , L229;
end;
thus L1018: thesis by L1013 , MATRPROB:def 6;
end;
theorem
L1019: (for R16 being (Matrix of ( REAL )) holds (R16 is  Joint_Probability iff ( Mx2FinS R16 ) is  ProbFinS))
proof
let R16 being (Matrix of ( REAL ));
thus L1020:now
assume L1021: R16 is  Joint_Probability;
reconsider D47 = R16 as  Joint_Probability (Matrix of ( REAL )) by L1021;
L1022: D47 is  m-nonnegative  with_sum=1  m-nonnegative  with_sum=1  m-nonnegative  with_sum=1  m-nonnegative  with_sum=1 (Matrix of ( REAL ));
L1023: ( Mx2FinS R16 ) is  nonnegative by L1022 , L1001;
L1024: (for R2 being (Element of ( NAT )) holds (R2 in ( dom ( Mx2FinS R16 ) ) implies ( ( Mx2FinS R16 ) . R2 ) >= ( 0 ))) by L1023 , L229;
L1025: ( Sum ( Mx2FinS R16 ) ) = ( SumAll R16 ) by L994
.= 1 by L1022 , MATRPROB:def 7;
thus L1026: ( Mx2FinS R16 ) is  ProbFinS by L1025 , L1024 , MATRPROB:def 5;
end;
assume L1027: ( Mx2FinS R16 ) is  ProbFinS;
reconsider D48 = ( Mx2FinS R16 ) as  ProbFinS (FinSequence of ( REAL )) by L1027;
reconsider D49 = D48 as non  empty  ProbFinS (FinSequence of ( REAL ));
L1028: ( SumAll R16 ) = ( Sum D49 ) by L994
.= 1 by MATRPROB:def 5;
L1029: R16 is  with_sum=1 by L1028 , MATRPROB:def 7;
L1030: D49 is  nonnegative;
L1031: R16 is  m-nonnegative by L1030 , L1001;
thus L1032: thesis by L1031 , L1029;
end;
theorem
L1033: (for B101 , B102 being  ProbFinS (FinSequence of ( REAL )) holds ( Mx2FinS ( ( ColVec2Mx B101 ) * ( LineVec2Mx B102 ) ) ) is  ProbFinS)
proof
let C104 , C105 being  ProbFinS (FinSequence of ( REAL ));
L1034: ( ( ColVec2Mx C104 ) * ( LineVec2Mx C105 ) ) is  Joint_Probability  Joint_Probability  Joint_Probability  Joint_Probability (Matrix of ( REAL )) by L518;
thus L1035: thesis by L1034 , L1019;
end;
theorem
L1036: (for B103 being  ProbFinS (FinSequence of ( REAL )) holds (for B104 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds (( len B103 ) = ( len B104 ) implies ( Mx2FinS ( ( Vec2DiagMx B103 ) * B104 ) ) is  ProbFinS)))
proof
let C106 being non  empty  ProbFinS (FinSequence of ( REAL ));
let C107 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
assume L1037: ( len C106 ) = ( len C107 );
L1038: ( ( Vec2DiagMx C106 ) * C107 ) is  Joint_Probability  Joint_Probability  Joint_Probability  Joint_Probability (Matrix of ( REAL )) by L1037 , L678;
thus L1039: thesis by L1038 , L1019;
end;
begin
definition
let R8 being Real;
let R14 being (FinSequence of ( REAL ));
assume that
L1040: R14 is  nonnegative;
func FinSeq_log (R8 , R14) -> (FinSequence of ( REAL )) means 
:L1041: (( len it ) = ( len R14 ) & (for B105 being Nat holds (B105 in ( dom it ) implies ((( R14 . B105 ) > ( 0 ) implies ( it . B105 ) = ( log (R8 , ( R14 . B105 )) )) & (( R14 . B105 ) = ( 0 ) implies ( it . B105 ) = ( 0 ))))));
existence
proof
defpred S8[ Nat , set ] means ((( R14 . $1 ) > ( 0 ) implies $2 = ( log (R8 , ( R14 . $1 )) )) & (( R14 . $1 ) = ( 0 ) implies $2 = ( 0 )));
L1042: (for B106 being Nat holds (B106 in ( Seg ( len R14 ) ) implies (ex B107 being (Element of ( REAL )) st S8[ B106 , B107 ])))
proof
let C108 being Nat;
assume L1043: C108 in ( Seg ( len R14 ) );
L1044: C108 in ( dom R14 ) by L1043 , FINSEQ_1:def 3;
per cases  by L1040 , L1044 , L229;
suppose L1045: ( R14 . C108 ) > ( 0 );

take ( log (R8 , ( R14 . C108 )) );
thus L1046: thesis by L1045;
end;
suppose L1047: ( R14 . C108 ) = ( 0 );

take ( 0 );
thus L1048: thesis by L1047;
end;
end;
consider C109 being (FinSequence of ( REAL )) such that L1050: (( dom C109 ) = ( Seg ( len R14 ) ) & (for B108 being Nat holds (B108 in ( Seg ( len R14 ) ) implies S8[ B108 , ( C109 . B108 ) ]))) from FINSEQ_1:sch 5(L1042);
L1051: ( len C109 ) = ( len R14 ) by L1050 , FINSEQ_1:def 3;
thus L1052: thesis by L1051 , L1050;
end;
uniqueness
proof
let C110 , C111 being (FinSequence of ( REAL ));
assume that
L1053: ( len C110 ) = ( len R14 )
and
L1054: (for B109 being Nat holds (B109 in ( dom C110 ) implies ((( R14 . B109 ) > ( 0 ) implies ( C110 . B109 ) = ( log (R8 , ( R14 . B109 )) )) & (( R14 . B109 ) = ( 0 ) implies ( C110 . B109 ) = ( 0 )))))
and
L1055: ( len C111 ) = ( len R14 )
and
L1056: (for B110 being Nat holds (B110 in ( dom C111 ) implies ((( R14 . B110 ) > ( 0 ) implies ( C111 . B110 ) = ( log (R8 , ( R14 . B110 )) )) & (( R14 . B110 ) = ( 0 ) implies ( C111 . B110 ) = ( 0 )))));
L1057: (for B111 being Nat holds (B111 in ( dom C110 ) implies ( C110 . B111 ) = ( C111 . B111 )))
proof
let C112 being Nat;
assume L1058: C112 in ( dom C110 );
L1059: C112 in ( dom R14 ) by L1058 , L1053 , FINSEQ_3:29;
L1060: C112 in ( dom C111 ) by L1053 , L1055 , L1058 , FINSEQ_3:29;
per cases  by L1040 , L1059 , L229;
suppose L1061: ( R14 . C112 ) > ( 0 );

thus L1062: ( C110 . C112 ) = ( log (R8 , ( R14 . C112 )) ) by L1061 , L1054 , L1058
.= ( C111 . C112 ) by L1056 , L1060 , L1061;
end;
suppose L1063: ( R14 . C112 ) = ( 0 );

thus L1064: ( C110 . C112 ) = ( 0 ) by L1063 , L1054 , L1058
.= ( C111 . C112 ) by L1056 , L1060 , L1063;
end;
end;
L1066: ( dom C110 ) = ( Seg ( len C111 ) ) by L1053 , L1055 , FINSEQ_1:def 3
.= ( dom C111 ) by FINSEQ_1:def 3;
thus L1067: thesis by L1066 , L1057 , FINSEQ_1:13;
end;
end;
definition
let R14 being (FinSequence of ( REAL ));
func Infor_FinSeq_of R14 -> (FinSequence of ( REAL )) equals 
( mlt (R14 , ( FinSeq_log (2 , R14) )) );
correctness;
end;
theorem
L1070: (for B112 being  nonnegative (FinSequence of ( REAL )) holds (for R15 being (FinSequence of ( REAL )) holds (R15 = ( Infor_FinSeq_of B112 ) iff (( len R15 ) = ( len B112 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom R15 ) implies ( R15 . R4 ) = ( ( B112 . R4 ) * ( log (2 , ( B112 . R4 )) ) )))))))
proof
let C113 being  nonnegative (FinSequence of ( REAL ));
let R15 being (FinSequence of ( REAL ));
set D50 = ( mlt (C113 , ( FinSeq_log (2 , C113) )) );
L1071: ( len C113 ) = ( len ( FinSeq_log (2 , C113) ) ) by L1041;
L1072: ( len D50 ) = ( len C113 ) by L1071 , MATRPROB:30;
thus L1073:now
assume L1074: R15 = ( Infor_FinSeq_of C113 );
thus L1075: (( len R15 ) = ( len C113 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom R15 ) implies ( R15 . R4 ) = ( ( C113 . R4 ) * ( log (2 , ( C113 . R4 )) ) ))))
proof
L1076: ( dom C113 ) = ( dom R15 ) by L1072 , L1074 , FINSEQ_3:29;
thus L1077: ( len R15 ) = ( len C113 ) by L1071 , L1074 , MATRPROB:30;
let R4 being (Element of ( NAT ));
assume that
L1078: R4 in ( dom R15 );
L1079: ( R15 . R4 ) = ( ( C113 . R4 ) * ( ( FinSeq_log (2 , C113) ) . R4 ) ) by L1074 , RVSUM_1:59;
L1080: R4 in ( dom ( FinSeq_log (2 , C113) ) ) by L1071 , L1072 , L1074 , L1078 , FINSEQ_3:29;
per cases  by L1078 , L1076 , L229;
suppose L1081: ( C113 . R4 ) = ( 0 );

thus L1082: thesis by L1081 , L1079;
end;
suppose L1083: ( C113 . R4 ) > ( 0 );

thus L1084: thesis by L1083 , L1079 , L1080 , L1041;
end;
end;

end;
assume that
L1076: ( len R15 ) = ( len C113 )
and
L1077: (for R4 being (Element of ( NAT )) holds (R4 in ( dom R15 ) implies ( R15 . R4 ) = ( ( C113 . R4 ) * ( log (2 , ( C113 . R4 )) ) )));
L1078: ( dom R15 ) = ( dom C113 ) by L1076 , FINSEQ_3:29;
L1079: ( len R15 ) = ( len D50 ) by L1071 , L1076 , MATRPROB:30;
L1080: ( dom R15 ) = ( dom D50 ) by L1079 , FINSEQ_3:29;
L1081: ( dom C113 ) = ( dom ( FinSeq_log (2 , C113) ) ) by L1071 , FINSEQ_3:29;
L1082:
now
let C114 being Nat;
assume that
L1083: C114 in ( dom R15 );
L1084: ( D50 . C114 ) = ( ( C113 . C114 ) * ( ( FinSeq_log (2 , C113) ) . C114 ) ) by RVSUM_1:59;
per cases  by L1078 , L1083 , L229;
suppose L1085: ( C113 . C114 ) = ( 0 );

thus L1086: ( R15 . C114 ) = ( ( 0 ) * ( log (2 , ( C113 . C114 )) ) ) by L1085 , L1077 , L1083
.= ( D50 . C114 ) by L1084 , L1085;
end;
suppose L1087: ( C113 . C114 ) > ( 0 );

L1088: ( ( FinSeq_log (2 , C113) ) . C114 ) = ( log (2 , ( C113 . C114 )) ) by L1087 , L1081 , L1078 , L1083 , L1041;
thus L1089: ( D50 . C114 ) = ( ( C113 . C114 ) * ( log (2 , ( C113 . C114 )) ) ) by L1088 , RVSUM_1:59
.= ( R15 . C114 ) by L1077 , L1083;
end;
end;
thus L1091: thesis by L1082 , L1080 , FINSEQ_1:13;
end;
theorem
L1092: (for B113 being  nonnegative (FinSequence of ( REAL )) holds (for R4 being (Element of ( NAT )) holds (R4 in ( dom B113 ) implies ((( B113 . R4 ) = ( 0 ) implies ( ( Infor_FinSeq_of B113 ) . R4 ) = ( 0 )) & (( B113 . R4 ) > ( 0 ) implies ( ( Infor_FinSeq_of B113 ) . R4 ) = ( ( B113 . R4 ) * ( log (2 , ( B113 . R4 )) ) ))))))
proof
let C115 being  nonnegative (FinSequence of ( REAL ));
L1093: ( dom C115 ) = ( Seg ( len C115 ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( Infor_FinSeq_of C115 ) ) ) by L1070
.= ( dom ( Infor_FinSeq_of C115 ) ) by FINSEQ_1:def 3;
let R4 being (Element of ( NAT ));
assume that
L1094: R4 in ( dom C115 );
thus L1095:now
assume L1096: ( C115 . R4 ) = ( 0 );
thus L1097: ( ( Infor_FinSeq_of C115 ) . R4 ) = ( ( 0 ) * ( log (2 , ( C115 . R4 )) ) ) by L1096 , L1094 , L1093 , L1070
.= ( 0 );
end;
thus L1098: thesis by L1094 , L1093 , L1070;
end;
theorem
L1099: (for B114 being  nonnegative (FinSequence of ( REAL )) holds (for R15 being (FinSequence of ( REAL )) holds (R15 = ( - ( Infor_FinSeq_of B114 ) ) iff (( len R15 ) = ( len B114 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom R15 ) implies ( R15 . R4 ) = ( ( B114 . R4 ) * ( log (2 , ( 1 / ( B114 . R4 ) )) ) )))))))
proof
let C116 being  nonnegative (FinSequence of ( REAL ));
let R15 being (FinSequence of ( REAL ));
set D51 = ( Infor_FinSeq_of C116 );
thus L1100:now
assume L1101: R15 = ( - D51 );
L1102: ( dom R15 ) = ( dom D51 ) by L1101 , VALUED_1:8;
L1103: ( Seg ( len R15 ) ) = ( dom R15 ) by FINSEQ_1:def 3
.= ( Seg ( len D51 ) ) by L1102 , FINSEQ_1:def 3
.= ( Seg ( len C116 ) ) by L1070;
L1104: (for R4 being (Element of ( NAT )) holds (R4 in ( dom R15 ) implies ( R15 . R4 ) = ( ( C116 . R4 ) * ( log (2 , ( 1 / ( C116 . R4 ) )) ) )))
proof
let R4 being (Element of ( NAT ));
assume that
L1105: R4 in ( dom R15 );
L1106: R4 in ( Seg ( len R15 ) ) by L1105 , FINSEQ_1:def 3;
L1107: R4 in ( dom C116 ) by L1106 , L1103 , FINSEQ_1:def 3;
L1108: ( R15 . R4 ) = ( - ( D51 . R4 ) ) by L1101 , RVSUM_1:17;
L1109: ( R15 . R4 ) = ( - ( ( C116 . R4 ) * ( log (2 , ( C116 . R4 )) ) ) ) by L1108 , L1102 , L1105 , L1070
.= ( ( C116 . R4 ) * ( - ( log (2 , ( C116 . R4 )) ) ) );
per cases  by L1107 , L229;
suppose L1110: ( C116 . R4 ) = ( 0 );

L1111: ( D51 . R4 ) = ( 0 ) by L1110 , L1107 , L1092;
thus L1112: thesis by L1111 , L1108 , L1110;
end;
suppose L1113: ( C116 . R4 ) > ( 0 );

thus L1114: thesis by L1113 , L1109 , L166;
end;
end;
thus L1116: (( len R15 ) = ( len C116 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom R15 ) implies ( R15 . R4 ) = ( ( C116 . R4 ) * ( log (2 , ( 1 / ( C116 . R4 ) )) ) )))) by L1104 , L1103 , FINSEQ_1:6;
end;
assume that
L1117: ( len R15 ) = ( len C116 )
and
L1118: (for R4 being (Element of ( NAT )) holds (R4 in ( dom R15 ) implies ( R15 . R4 ) = ( ( C116 . R4 ) * ( log (2 , ( 1 / ( C116 . R4 ) )) ) )));
L1119: ( dom R15 ) = ( Seg ( len R15 ) ) by FINSEQ_1:def 3
.= ( Seg ( len D51 ) ) by L1117 , L1070
.= ( dom D51 ) by FINSEQ_1:def 3;
L1120: (for B115 being Nat holds (B115 in ( dom R15 ) implies ( ( - D51 ) . B115 ) = ( R15 . B115 )))
proof
let C117 being Nat;
assume L1121: C117 in ( dom R15 );
L1122: C117 in ( Seg ( len C116 ) ) by L1121 , L1117 , FINSEQ_1:def 3;
L1123: C117 in ( dom C116 ) by L1122 , FINSEQ_1:def 3;
per cases  by L1123 , L229;
suppose L1124: ( C116 . C117 ) = ( 0 );

thus L1125: ( ( - D51 ) . C117 ) = ( - ( D51 . C117 ) ) by RVSUM_1:17
.= ( - ( 0 ) ) by L1123 , L1124 , L1092
.= ( ( C116 . C117 ) * ( log (2 , ( 1 / ( C116 . C117 ) )) ) ) by L1124
.= ( R15 . C117 ) by L1118 , L1121;
end;
suppose L1126: ( C116 . C117 ) > ( 0 );

thus L1127: ( ( - D51 ) . C117 ) = ( - ( D51 . C117 ) ) by RVSUM_1:17
.= ( - ( ( C116 . C117 ) * ( log (2 , ( C116 . C117 )) ) ) ) by L1119 , L1121 , L1070
.= ( ( C116 . C117 ) * ( - ( log (2 , ( C116 . C117 )) ) ) )
.= ( ( C116 . C117 ) * ( log (2 , ( 1 / ( C116 . C117 ) )) ) ) by L1126 , L166
.= ( R15 . C117 ) by L1118 , L1121;
end;
end;
L1129: ( dom R15 ) = ( dom ( - D51 ) ) by L1119 , VALUED_1:8;
thus L1130: thesis by L1129 , L1120 , FINSEQ_1:13;
end;
theorem
L1131: (for R12 being Real holds (for R13 being Real holds (for B116 being  nonnegative (FinSequence of ( REAL )) holds ((R12 >= ( 0 ) & R13 >= ( 0 )) implies (for R2 being (Element of ( NAT )) holds ((R2 in ( dom B116 ) & ( B116 . R2 ) = ( R12 * R13 )) implies ( ( Infor_FinSeq_of B116 ) . R2 ) = ( ( ( R12 * R13 ) * ( log (2 , R12) ) ) + ( ( R12 * R13 ) * ( log (2 , R13) ) ) )))))))
proof
let R12 being Real;
let R13 being Real;
let C118 being  nonnegative (FinSequence of ( REAL ));
assume that
L1132: R12 >= ( 0 )
and
L1133: R13 >= ( 0 );
let R2 being (Element of ( NAT ));
assume that
L1134: R2 in ( dom C118 )
and
L1135: ( C118 . R2 ) = ( R12 * R13 );
L1136: ( len C118 ) = ( len ( Infor_FinSeq_of C118 ) ) by L1070;
L1137: R2 in ( dom ( Infor_FinSeq_of C118 ) ) by L1136 , L1134 , FINSEQ_3:29;
thus L1138: ( ( Infor_FinSeq_of C118 ) . R2 ) = ( ( R12 * R13 ) * ( log (2 , ( R12 * R13 )) ) ) by L1137 , L1135 , L1070
.= ( ( ( R12 * R13 ) * ( log (2 , R12) ) ) + ( ( R12 * R13 ) * ( log (2 , R13) ) ) ) by L1132 , L1133 , L171;
end;
theorem
L1139: (for R11 being Real holds (for B117 being  nonnegative (FinSequence of ( REAL )) holds (R11 >= ( 0 ) implies ( Infor_FinSeq_of ( R11 * B117 ) ) = ( ( ( R11 * ( log (2 , R11) ) ) * B117 ) + ( R11 * ( mlt (B117 , ( FinSeq_log (2 , B117) )) ) ) ))))
proof
let R11 being Real;
let C119 being  nonnegative (FinSequence of ( REAL ));
assume that
L1140: R11 >= ( 0 );
reconsider D52 = ( R11 * C119 ) as  nonnegative (FinSequence of ( REAL )) by L1140 , L251;
set D53 = ( Infor_FinSeq_of D52 );
L1141: ( dom D52 ) = ( dom C119 ) by VALUED_1:def 5;
L1142: ( dom ( ( R11 * ( log (2 , R11) ) ) * C119 ) ) = ( dom C119 ) by VALUED_1:def 5;
L1143: ( len ( FinSeq_log (2 , C119) ) ) = ( len C119 ) by L1041;
L1144: ( len ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) = ( len C119 ) by L1143 , MATRPROB:30;
L1145: ( dom ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) = ( dom C119 ) by L1144 , FINSEQ_3:29;
L1146: ( dom ( R11 * ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) ) = ( dom C119 ) by L1145 , VALUED_1:def 5;
L1147: ( len ( ( R11 * ( log (2 , R11) ) ) * C119 ) ) = ( len ( R11 * ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) ) by L1146 , L1142 , FINSEQ_3:29;
L1148: ( len ( ( ( R11 * ( log (2 , R11) ) ) * C119 ) + ( R11 * ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) ) ) = ( len ( ( R11 * ( log (2 , R11) ) ) * C119 ) ) by L1147 , INTEGRA5:2;
L1149: ( dom ( ( ( R11 * ( log (2 , R11) ) ) * C119 ) + ( R11 * ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) ) ) = ( dom ( ( R11 * ( log (2 , R11) ) ) * C119 ) ) by L1148 , FINSEQ_3:29;
L1150: ( len D52 ) = ( len D53 ) by L1070;
L1151: ( dom D52 ) = ( dom D53 ) by L1150 , FINSEQ_3:29;
L1152: ( dom ( FinSeq_log (2 , C119) ) ) = ( dom C119 ) by L1143 , FINSEQ_3:29;
L1153:
now
let C120 being Nat;
assume that
L1154: C120 in ( dom D53 );
L1155: ( D52 . C120 ) = ( R11 * ( C119 . C120 ) ) by RVSUM_1:44;
L1156: ( C119 . C120 ) >= ( 0 ) by L1141 , L1151 , L1154 , L229;
L1157: ( D53 . C120 ) = ( ( ( R11 * ( C119 . C120 ) ) * ( log (2 , R11) ) ) + ( ( R11 * ( C119 . C120 ) ) * ( log (2 , ( C119 . C120 )) ) ) ) by L1156 , L1140 , L1151 , L1154 , L1155 , L1131;
L1158: ( ( ( R11 * ( log (2 , R11) ) ) * C119 ) . C120 ) = ( ( R11 * ( log (2 , R11) ) ) * ( C119 . C120 ) ) by RVSUM_1:44;
L1159: ( ( R11 * ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) . C120 ) = ( R11 * ( ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) . C120 ) ) by RVSUM_1:44
.= ( R11 * ( ( C119 . C120 ) * ( ( FinSeq_log (2 , C119) ) . C120 ) ) ) by RVSUM_1:59
.= ( ( R11 * ( C119 . C120 ) ) * ( ( FinSeq_log (2 , C119) ) . C120 ) );
per cases  by L1141 , L1151 , L1154 , L229;
suppose L1160: ( C119 . C120 ) > ( 0 );

L1161: ( D53 . C120 ) = ( ( ( ( R11 * ( log (2 , R11) ) ) * C119 ) . C120 ) + ( ( R11 * ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) . C120 ) ) by L1160 , L1141 , L1151 , L1152 , L1154 , L1157 , L1158 , L1159 , L1041;
thus L1162: ( D53 . C120 ) = ( ( ( ( R11 * ( log (2 , R11) ) ) * C119 ) + ( R11 * ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) ) . C120 ) by L1161 , L1141 , L1151 , L1142 , L1149 , L1154 , VALUED_1:def 1;
end;
suppose L1163: ( C119 . C120 ) = ( 0 );

thus L1164: ( D53 . C120 ) = ( ( ( ( R11 * ( log (2 , R11) ) ) * C119 ) + ( R11 * ( mlt (C119 , ( FinSeq_log (2 , C119) )) ) ) ) . C120 ) by L1163 , L1141 , L1151 , L1142 , L1149 , L1154 , L1157 , L1158 , L1159 , VALUED_1:def 1;
end;
end;
thus L1166: thesis by L1153 , L1141 , L1151 , L1142 , L1149 , FINSEQ_1:13;
end;
theorem
L1167: (for B118 being non  empty  ProbFinS (FinSequence of ( REAL )) holds (for R4 being (Element of ( NAT )) holds (R4 in ( dom B118 ) implies ( ( Infor_FinSeq_of B118 ) . R4 ) <= ( 0 ))))
proof
let C121 being non  empty  ProbFinS (FinSequence of ( REAL ));
let R4 being (Element of ( NAT ));
assume that
L1168: R4 in ( dom C121 );
per cases  by L1168 , MATRPROB:53 , MATRPROB:def 5;
suppose L1169: ( C121 . R4 ) = ( 0 );

thus L1170: thesis by L1169 , L1168 , L1092;
end;
suppose L1171: (( C121 . R4 ) > ( 0 ) & ( C121 . R4 ) <= 1);

L1172: ( ( Infor_FinSeq_of C121 ) . R4 ) = ( ( C121 . R4 ) * ( log (2 , ( C121 . R4 )) ) ) by L1171 , L1168 , L1092;
thus L1173: ( ( Infor_FinSeq_of C121 ) . R4 ) <= ( 0 )
proof
L1174: ( log (2 , 1) ) = ( 0 ) by POWER:51;
per cases  by L1171 , XXREAL_0:1;
suppose L1175: ( C121 . R4 ) < 1;

L1176: ( log (2 , ( C121 . R4 )) ) < ( 0 ) by L1175 , L1171 , L1174 , POWER:57;
thus L1177: thesis by L1176 , L1171 , L1172;
end;
suppose L1178: ( C121 . R4 ) = 1;

thus L1179: thesis by L1178 , L1172 , POWER:51;
end;
end;

end;
end;
definition
let R16 being (Matrix of ( REAL ));
assume L1175: R16 is  m-nonnegative;
func Infor_FinSeq_of R16 -> (Matrix of ( REAL )) means 
:L1176: (( len it ) = ( len R16 ) & ( width it ) = ( width R16 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom it ) implies ( it . R4 ) = ( mlt (( Line (R16 , R4) ) , ( FinSeq_log (2 , ( Line (R16 , R4) )) )) ))));
existence
proof
deffunc H4(Nat) = ( mlt (( Line (R16 , $1) ) , ( FinSeq_log (2 , ( Line (R16 , $1) )) )) );
consider C122 being FinSequence such that L1177: ( len C122 ) = ( len R16 ) and L1178: (for B119 being Nat holds (B119 in ( dom C122 ) implies ( C122 . B119 ) = H4(B119))) from FINSEQ_1:sch 2;
L1179: ( rng C122 ) c= ( ( REAL ) * )
proof
let R7 being set;
assume L1180: R7 in ( rng C122 );
consider C123 being Nat such that L1181: C123 in ( dom C122 ) and L1182: R7 = ( C122 . C123 ) by L1180 , FINSEQ_2:10;
L1183: ( C122 . C123 ) = ( mlt (( Line (R16 , C123) ) , ( FinSeq_log (2 , ( Line (R16 , C123) )) )) ) by L1178 , L1181;
thus L1184: thesis by L1183 , L1182 , FINSEQ_1:def 11;
end;
L1185: (for R7 being set holds (R7 in ( rng C122 ) implies (ex B120 being FinSequence st (B120 = R7 & ( len B120 ) = ( width R16 )))))
proof
let R7 being set;
assume L1186: R7 in ( rng C122 );
consider C124 being Nat such that L1187: C124 in ( dom C122 ) and L1188: R7 = ( C122 . C124 ) by L1186 , FINSEQ_2:10;
L1189: C124 in ( dom R16 ) by L1177 , L1187 , FINSEQ_3:29;
L1190: ( Line (R16 , C124) ) is  nonnegative by L1189 , L1175 , L441;
L1191: ( len ( FinSeq_log (2 , ( Line (R16 , C124) )) ) ) = ( len ( Line (R16 , C124) ) ) by L1190 , L1041;
L1192: ( len ( Line (R16 , C124) ) ) = ( width R16 ) by MATRIX_1:def 7;
L1193: ( len ( mlt (( Line (R16 , C124) ) , ( FinSeq_log (2 , ( Line (R16 , C124) )) )) ) ) = ( width R16 ) by L1192 , L1191 , MATRPROB:30;
L1194: R7 = ( mlt (( Line (R16 , C124) ) , ( FinSeq_log (2 , ( Line (R16 , C124) )) )) ) by L1178 , L1187 , L1188;
thus L1195: thesis by L1194 , L1193;
end;
reconsider D54 = C122 as (Matrix of ( REAL )) by L1185 , L1179 , FINSEQ_1:def 4 , MATRIX_1:def 1;
take D54;
L1196: ( width D54 ) = ( width R16 )
proof
per cases ;
suppose L1197: ( len R16 ) = ( 0 );

L1198: ( width D54 ) = ( 0 ) by L1197 , L1177 , MATRIX_1:def 3;
thus L1199: thesis by L1198 , L1197 , MATRIX_1:def 3;
end;
suppose L1200: ( len R16 ) > ( 0 );

L1201: ( len D54 ) >= 1 by L1200 , L1177 , NAT_1:14;
L1202: 1 in ( Seg ( len D54 ) ) by L1201 , FINSEQ_1:1;
L1203: 1 in ( dom D54 ) by L1202 , FINSEQ_1:def 3;
L1204: ( D54 . 1 ) in ( rng D54 ) by L1203 , FUNCT_1:3;
L1205: (ex B121 being FinSequence st (B121 = ( D54 . 1 ) & ( len B121 ) = ( width R16 ))) by L1185 , L1203 , FUNCT_1:3;
thus L1206: thesis by L1205 , L1177 , L1200 , L1204 , MATRIX_1:def 3;
end;
end;
thus L1208: thesis by L1196 , L1177 , L1178;
end;
uniqueness
proof
let C125 , C126 being (Matrix of ( REAL ));
assume that
L1209: ( len C125 ) = ( len R16 )
and
L1210: ( width C125 ) = ( width R16 )
and
L1211: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C125 ) implies ( C125 . R4 ) = ( mlt (( Line (R16 , R4) ) , ( FinSeq_log (2 , ( Line (R16 , R4) )) )) )))
and
L1212: ( len C126 ) = ( len R16 )
and
L1213: ( width C126 ) = ( width R16 )
and
L1214: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C126 ) implies ( C126 . R4 ) = ( mlt (( Line (R16 , R4) ) , ( FinSeq_log (2 , ( Line (R16 , R4) )) )) )));
L1215: ( dom C125 ) = ( dom C126 ) by L1209 , L1212 , FINSEQ_3:29;
L1216:
now
let C127 being Nat;
assume that
L1217: C127 in ( dom C125 );
thus L1218: ( C125 . C127 ) = ( mlt (( Line (R16 , C127) ) , ( FinSeq_log (2 , ( Line (R16 , C127) )) )) ) by L1211 , L1217
.= ( C126 . C127 ) by L1214 , L1215 , L1217;
end;
thus L1219: thesis by L1216 , L1215 , FINSEQ_1:13;
end;
end;
theorem
L1221: (for B122 being  m-nonnegative (Matrix of ( REAL )) holds (for R4 being (Element of ( NAT )) holds (R4 in ( dom B122 ) implies ( Line (( Infor_FinSeq_of B122 ) , R4) ) = ( Infor_FinSeq_of ( Line (B122 , R4) ) ))))
proof
let C128 being  m-nonnegative (Matrix of ( REAL ));
set D55 = ( Infor_FinSeq_of C128 );
L1222: ( len D55 ) = ( len C128 ) by L1176;
L1223: ( dom D55 ) = ( dom C128 ) by L1222 , FINSEQ_3:29;
let R4 being (Element of ( NAT ));
assume that
L1224: R4 in ( dom C128 );
thus L1225: ( Line (D55 , R4) ) = ( D55 . R4 ) by L1224 , L1223 , MATRIX_2:16
.= ( Infor_FinSeq_of ( Line (C128 , R4) ) ) by L1224 , L1223 , L1176;
end;
theorem
L1226: (for B123 being  m-nonnegative (Matrix of ( REAL )) holds (for B124 being (Matrix of ( REAL )) holds (B124 = ( Infor_FinSeq_of B123 ) iff (( len B124 ) = ( len B123 ) & ( width B124 ) = ( width B123 ) & (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B124 ) implies ( B124 * (R2 , R3) ) = ( ( B123 * (R2 , R3) ) * ( log (2 , ( B123 * (R2 , R3) )) ) ))))))))
proof
let C129 being  m-nonnegative (Matrix of ( REAL ));
let C130 being (Matrix of ( REAL ));
thus L1227:now
assume L1228: C130 = ( Infor_FinSeq_of C129 );
L1229: ( width C130 ) = ( width C129 ) by L1228 , L1176;
L1230: ( len C130 ) = ( len C129 ) by L1228 , L1176;
L1231:
now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L1232: [ R2 , R3 ] in ( Indices C130 );
L1233: R3 in ( Seg ( width C130 ) ) by L1232 , MATRPROB:12;
L1234: R2 in ( Seg ( len C130 ) ) by L1232 , MATRPROB:12;
L1235: R2 in ( dom C129 ) by L1234 , L1230 , FINSEQ_1:def 3;
reconsider D56 = ( Line (C129 , R2) ) as  nonnegative (FinSequence of ( REAL )) by L1235 , L441;
L1236: ( len D56 ) = ( width C129 ) by MATRIX_1:def 7;
L1237: ( len D56 ) = ( len ( Infor_FinSeq_of D56 ) ) by L1070;
L1238: R3 in ( dom ( Infor_FinSeq_of D56 ) ) by L1237 , L1229 , L1233 , L1236 , FINSEQ_1:def 3;
L1239: ( D56 . R3 ) = ( C129 * (R2 , R3) ) by L1229 , L1233 , MATRIX_1:def 7;
thus L1240: ( C130 * (R2 , R3) ) = ( ( Line (C130 , R2) ) . R3 ) by L1233 , MATRIX_1:def 7
.= ( ( Infor_FinSeq_of D56 ) . R3 ) by L1228 , L1235 , L1221
.= ( ( C129 * (R2 , R3) ) * ( log (2 , ( C129 * (R2 , R3) )) ) ) by L1239 , L1238 , L1070;
end;
thus L1241: (( len C130 ) = ( len C129 ) & ( width C130 ) = ( width C129 ) & (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C130 ) implies ( C130 * (R2 , R3) ) = ( ( C129 * (R2 , R3) ) * ( log (2 , ( C129 * (R2 , R3) )) ) ))))) by L1231 , L1228 , L1176;
end;
assume that
L1242: ( len C130 ) = ( len C129 )
and
L1243: ( width C130 ) = ( width C129 )
and
L1244: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C130 ) implies ( C130 * (R2 , R3) ) = ( ( C129 * (R2 , R3) ) * ( log (2 , ( C129 * (R2 , R3) )) ) ))));
L1245: ( dom C130 ) = ( dom C129 ) by L1242 , FINSEQ_3:29;
L1246: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C130 ) implies ( C130 . R4 ) = ( mlt (( Line (C129 , R4) ) , ( FinSeq_log (2 , ( Line (C129 , R4) )) )) )))
proof
let R4 being (Element of ( NAT ));
assume that
L1247: R4 in ( dom C130 );
L1248: ( len ( C130 . R4 ) ) = ( width C130 ) by L1247 , MATRIX_1:42;
reconsider D57 = ( Line (C129 , R4) ) as  nonnegative (FinSequence of ( REAL )) by L1245 , L1247 , L441;
L1249: ( len D57 ) = ( width C129 ) by MATRIX_1:def 7;
L1250: ( len ( FinSeq_log (2 , D57) ) ) = ( len D57 ) by L1041;
L1251: ( len ( mlt (D57 , ( FinSeq_log (2 , D57) )) ) ) = ( len D57 ) by L1250 , MATRPROB:30;
L1252: ( dom ( C130 . R4 ) ) = ( dom ( mlt (D57 , ( FinSeq_log (2 , D57) )) ) ) by L1251 , L1243 , L1249 , L1248 , FINSEQ_3:29;
L1253: R4 in ( Seg ( len C129 ) ) by L1242 , L1247 , FINSEQ_1:def 3;
L1254:
now
let C131 being Nat;
assume that
L1255: C131 in ( dom ( C130 . R4 ) );
L1256: C131 in ( Seg ( width C129 ) ) by L1243 , L1248 , L1255 , FINSEQ_1:def 3;
L1257: ( D57 . C131 ) = ( C129 * (R4 , C131) ) by L1256 , MATRIX_1:def 7;
L1258: [ R4 , C131 ] in ( Indices C129 ) by L1253 , L1256 , MATRPROB:12;
L1259: ( ( mlt (D57 , ( FinSeq_log (2 , D57) )) ) . C131 ) = ( ( D57 . C131 ) * ( ( FinSeq_log (2 , D57) ) . C131 ) ) by RVSUM_1:59
.= ( ( C129 * (R4 , C131) ) * ( ( FinSeq_log (2 , D57) ) . C131 ) ) by L1256 , MATRIX_1:def 7;
L1260: C131 in ( dom ( FinSeq_log (2 , D57) ) ) by L1249 , L1250 , L1256 , FINSEQ_1:def 3;
L1261: C131 in ( NAT ) by ORDINAL1:def 12;
L1262: [ R4 , C131 ] in ( Indices C130 ) by L1247 , L1255 , MATRPROB:13;
L1263: ( ( C130 . R4 ) . C131 ) = ( C130 * (R4 , C131) ) by L1262 , L1261 , MATRPROB:14
.= ( ( C129 * (R4 , C131) ) * ( log (2 , ( C129 * (R4 , C131) )) ) ) by L1244 , L1261 , L1262;
per cases  by L1261 , L1258 , MATRPROB:def 6;
suppose L1264: ( C129 * (R4 , C131) ) = ( 0 );

thus L1265: ( ( C130 . R4 ) . C131 ) = ( ( mlt (D57 , ( FinSeq_log (2 , D57) )) ) . C131 ) by L1264 , L1263 , L1259;
end;
suppose L1266: ( C129 * (R4 , C131) ) > ( 0 );

thus L1267: ( ( mlt (D57 , ( FinSeq_log (2 , D57) )) ) . C131 ) = ( ( C130 . R4 ) . C131 ) by L1266 , L1260 , L1263 , L1257 , L1259 , L1041;
end;
end;
thus L1269: thesis by L1254 , L1252 , FINSEQ_1:13;
end;
thus L1270: thesis by L1246 , L1242 , L1243 , L1176;
end;
definition
let C132 being (FinSequence of ( REAL ));
func Entropy C132 -> Real equals 
( - ( Sum ( Infor_FinSeq_of C132 ) ) );
correctness;
end;
theorem
L1272: (for B125 being non  empty  ProbFinS (FinSequence of ( REAL )) holds ( Entropy B125 ) >= ( 0 ))
proof
let C133 being non  empty  ProbFinS (FinSequence of ( REAL ));
set D58 = ( - ( Infor_FinSeq_of C133 ) );
L1273: ( dom C133 ) = ( Seg ( len C133 ) ) by FINSEQ_1:def 3
.= ( Seg ( len ( Infor_FinSeq_of C133 ) ) ) by L1070
.= ( dom ( Infor_FinSeq_of C133 ) ) by FINSEQ_1:def 3;
L1274: (for B126 being Nat holds (B126 in ( dom D58 ) implies ( D58 . B126 ) >= ( 0 )))
proof
let C134 being Nat;
assume L1275: C134 in ( dom D58 );
L1276: C134 in ( dom C133 ) by L1275 , L1273 , VALUED_1:8;
L1277: ( ( Infor_FinSeq_of C133 ) . C134 ) <= ( 0 ) by L1276 , L1167;
L1278: ( - ( ( Infor_FinSeq_of C133 ) . C134 ) ) >= ( - ( 0 ) ) by L1277;
thus L1279: thesis by L1278 , RVSUM_1:17;
end;
L1280: ( Entropy C133 ) = ( Sum D58 ) by RVSUM_1:88;
thus L1281: thesis by L1280 , L1274 , RVSUM_1:84;
end;
theorem
L1282: (for B127 being non  empty  ProbFinS (FinSequence of ( REAL )) holds ((ex R4 being (Element of ( NAT )) st (R4 in ( dom B127 ) & ( B127 . R4 ) = 1)) implies ( Entropy B127 ) = ( 0 )))
proof
let C135 being non  empty  ProbFinS (FinSequence of ( REAL ));
assume L1283: (ex R4 being (Element of ( NAT )) st (R4 in ( dom C135 ) & ( C135 . R4 ) = 1));
consider C136 being (Element of ( NAT )) such that L1284: C136 in ( dom C135 ) and L1285: ( C135 . C136 ) = 1 by L1283;
set D59 = ( Infor_FinSeq_of C135 );
L1286: ( len D59 ) = ( len C135 ) by L1070;
L1287: ( dom D59 ) = ( dom C135 ) by L1286 , FINSEQ_3:29;
L1288: C135 has_onlyone_value_in C136 by L1284 , L1285 , L412;
L1289: (for R4 being (Element of ( NAT )) holds (R4 in ( dom D59 ) implies ( D59 . R4 ) = ( 0 )))
proof
let R4 being (Element of ( NAT ));
assume that
L1290: R4 in ( dom D59 );
per cases ;
suppose L1291: R4 = C136;

thus L1292: ( D59 . R4 ) = ( 1 * ( log (2 , 1) ) ) by L1291 , L1285 , L1290 , L1070
.= ( 0 ) by POWER:51;
end;
suppose L1293: R4 <> C136;

L1294: ( C135 . R4 ) = ( 0 ) by L1293 , L1288 , L1287 , L1290 , L261;
thus L1295: ( D59 . R4 ) = ( ( C135 . R4 ) * ( log (2 , ( C135 . R4 )) ) ) by L1290 , L1070
.= ( 0 ) by L1294;
end;
end;
L1297: (for R7 being set holds (R7 in ( dom D59 ) implies ( D59 . R7 ) = ( 0 ))) by L1289;
L1298: D59 = ( ( dom D59 ) --> ( 0 ) ) by L1297 , FUNCOP_1:11;
L1299: D59 = ( ( len D59 ) |-> ( 0 ) ) by L1298 , FINSEQ_1:def 3;
L1300: ( Sum D59 ) = ( 0 ) by L1299 , RVSUM_1:81;
thus L1301: thesis by L1300;
end;
theorem
L1302: (for B128 , B129 being non  empty  ProbFinS (FinSequence of ( REAL )) holds (for B130 , B131 being (FinSequence of ( REAL )) holds ((( len B128 ) = ( len B129 ) & ( len B130 ) = ( len B128 ) & ( len B131 ) = ( len B129 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom B128 ) implies (( B128 . R4 ) > ( 0 ) & ( B129 . R4 ) > ( 0 ) & ( B130 . R4 ) = ( - ( ( B128 . R4 ) * ( log (2 , ( B128 . R4 )) ) ) ) & ( B131 . R4 ) = ( - ( ( B128 . R4 ) * ( log (2 , ( B129 . R4 )) ) ) ))))) implies (( Sum B130 ) <= ( Sum B131 ) & ((for R4 being (Element of ( NAT )) holds (R4 in ( dom B128 ) implies ( B128 . R4 ) = ( B129 . R4 ))) iff ( Sum B130 ) = ( Sum B131 )) & ((ex R4 being (Element of ( NAT )) st (R4 in ( dom B128 ) & ( B128 . R4 ) <> ( B129 . R4 ))) iff ( Sum B130 ) < ( Sum B131 ))))))
proof
let C137 , C138 being non  empty  ProbFinS (FinSequence of ( REAL ));
let C139 , C140 being (FinSequence of ( REAL ));
assume that
L1303: ( len C137 ) = ( len C138 )
and
L1304: ( len C139 ) = ( len C137 )
and
L1305: ( len C140 ) = ( len C138 )
and
L1306: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C137 ) implies (( C137 . R4 ) > ( 0 ) & ( C138 . R4 ) > ( 0 ) & ( C139 . R4 ) = ( - ( ( C137 . R4 ) * ( log (2 , ( C137 . R4 )) ) ) ) & ( C140 . R4 ) = ( - ( ( C137 . R4 ) * ( log (2 , ( C138 . R4 )) ) ) ))));
set D60 = ( C139 - C140 );
L1307: ( number_e ) <> 1 by TAYLOR_1:11;
L1308: ( len ( C139 - C140 ) ) = ( len C137 ) by L1303 , L1304 , L1305 , RVSUM_1:116;
L1309: ( dom ( C139 - C140 ) ) = ( dom C139 ) by L1308 , L1304 , FINSEQ_3:29;
L1310: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C139 ) implies ( ( C139 - C140 ) . R4 ) = ( ( C139 . R4 ) - ( C140 . R4 ) ))) by L1309 , VALUED_1:13;
L1311: ( ( Sum C139 ) - ( Sum C140 ) ) = ( Sum ( C139 - C140 ) ) by L1310 , L1303 , L1304 , L1305 , L1308 , L194;
L1312: ( dom C139 ) = ( Seg ( len C139 ) ) by FINSEQ_1:def 3
.= ( dom C137 ) by L1304 , FINSEQ_1:def 3;
L1313: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C137 ) implies ( D60 . R4 ) = ( ( ( C137 . R4 ) * ( log (2 , ( number_e )) ) ) * ( log (( number_e ) , ( ( C138 . R4 ) / ( C137 . R4 ) )) ) )))
proof
let R4 being (Element of ( NAT ));
assume that
L1314: R4 in ( dom C137 );
L1315: ( C139 . R4 ) = ( - ( ( C137 . R4 ) * ( log (2 , ( C137 . R4 )) ) ) ) by L1306 , L1314;
L1316: ( C140 . R4 ) = ( - ( ( C137 . R4 ) * ( log (2 , ( C138 . R4 )) ) ) ) by L1306 , L1314;
L1317: ( C137 . R4 ) > ( 0 ) by L1306 , L1314;
L1318: ( - ( log (2 , ( C137 . R4 )) ) ) = ( log (2 , ( 1 / ( C137 . R4 ) )) ) by L1317 , L166;
L1319: ( C138 . R4 ) > ( 0 ) by L1306 , L1314;
L1320: ( ( C138 . R4 ) / ( C137 . R4 ) ) > ( 0 ) by L1319 , L1317 , XREAL_1:139;
L1321: ( log (2 , ( ( C138 . R4 ) / ( C137 . R4 ) )) ) = ( ( log (2 , ( number_e )) ) * ( log (( number_e ) , ( ( C138 . R4 ) / ( C137 . R4 ) )) ) ) by L1320 , L1307 , POWER:56 , TAYLOR_1:11;
thus L1322: ( D60 . R4 ) = ( ( C139 . R4 ) - ( C140 . R4 ) ) by L1309 , L1312 , L1314 , VALUED_1:13
.= ( ( C137 . R4 ) * ( ( log (2 , ( 1 / ( C137 . R4 ) )) ) + ( log (2 , ( C138 . R4 )) ) ) ) by L1315 , L1316 , L1318
.= ( ( C137 . R4 ) * ( log (2 , ( ( 1 / ( C137 . R4 ) ) * ( C138 . R4 ) )) ) ) by L1317 , L1319 , POWER:53
.= ( ( ( C137 . R4 ) * ( log (2 , ( number_e )) ) ) * ( log (( number_e ) , ( ( C138 . R4 ) / ( C137 . R4 ) )) ) ) by L1321;
end;
set D61 = ( len C137 );
deffunc H5(Nat) = ( ( ( C137 . $1 ) * ( log (2 , ( number_e )) ) ) * ( ( ( C138 . $1 ) / ( C137 . $1 ) ) - 1 ) );
consider C141 being (FinSequence of ( REAL )) such that L1323: ( len C141 ) = D61 and L1324: (for B132 being Nat holds (B132 in ( dom C141 ) implies ( C141 . B132 ) = H5(B132))) from FINSEQ_2:sch 1;
L1325: ( dom C141 ) = ( Seg ( len C141 ) ) by FINSEQ_1:def 3
.= ( dom C137 ) by L1323 , FINSEQ_1:def 3;
L1326: ( len D60 ) = ( len C137 ) by L1303 , L1304 , L1305 , RVSUM_1:116;
L1327: D60 is (Element of ( D61 -tuples_on ( REAL ) )) by L1326 , FINSEQ_2:92;
L1328: ( dom C141 ) = ( Seg D61 ) by L1323 , FINSEQ_1:def 3;
L1329: ( len ( C138 - C137 ) ) = ( len C138 ) by L1303 , RVSUM_1:116;
L1330: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C138 ) implies ( ( C138 - C137 ) . R4 ) = ( ( C138 . R4 ) - ( C137 . R4 ) )))
proof
let R4 being (Element of ( NAT ));
assume L1331: R4 in ( dom C138 );
L1332: R4 in ( dom ( C138 - C137 ) ) by L1331 , L1329 , FINSEQ_3:29;
thus L1333: thesis by L1332 , VALUED_1:13;
end;
L1334: ( dom C137 ) = ( Seg D61 ) by FINSEQ_1:def 3;
L1335: ( dom ( C138 - C137 ) ) = ( dom C141 ) by L1303 , L1323 , L1329 , FINSEQ_3:29;
L1336: (for B133 being Nat holds (B133 in ( dom C141 ) implies ( C141 . B133 ) = ( ( ( log (2 , ( number_e )) ) * ( C138 - C137 ) ) . B133 )))
proof
let C142 being Nat;
assume that
L1337: C142 in ( dom C141 );
L1338: ( C137 . C142 ) > ( 0 ) by L1306 , L1325 , L1337;
thus L1339: ( C141 . C142 ) = ( ( ( log (2 , ( number_e )) ) * ( C137 . C142 ) ) * ( ( ( C138 . C142 ) / ( C137 . C142 ) ) - 1 ) ) by L1324 , L1337
.= ( ( log (2 , ( number_e )) ) * ( ( ( ( C137 . C142 ) / ( C137 . C142 ) ) * ( C138 . C142 ) ) - ( C137 . C142 ) ) )
.= ( ( log (2 , ( number_e )) ) * ( ( 1 * ( C138 . C142 ) ) - ( C137 . C142 ) ) ) by L1338 , XCMPLX_1:60
.= ( ( log (2 , ( number_e )) ) * ( ( C138 - C137 ) . C142 ) ) by L1335 , L1337 , VALUED_1:13
.= ( ( ( log (2 , ( number_e )) ) * ( C138 - C137 ) ) . C142 ) by RVSUM_1:44;
end;
L1340: ( dom C141 ) = ( dom ( ( log (2 , ( number_e )) ) * ( C138 - C137 ) ) ) by L1335 , VALUED_1:def 5;
L1341: ( Sum C141 ) = ( Sum ( ( log (2 , ( number_e )) ) * ( C138 - C137 ) ) ) by L1340 , L1336 , FINSEQ_1:13
.= ( ( log (2 , ( number_e )) ) * ( Sum ( C138 - C137 ) ) ) by RVSUM_1:87
.= ( ( log (2 , ( number_e )) ) * ( ( Sum C138 ) - ( Sum C137 ) ) ) by L1303 , L1329 , L1330 , L194
.= ( ( log (2 , ( number_e )) ) * ( 1 - ( Sum C137 ) ) ) by MATRPROB:def 5
.= ( ( log (2 , ( number_e )) ) * ( 1 - 1 ) ) by MATRPROB:def 5
.= ( 0 );
L1342: ( ( number_e ) - ( 0 ) ) > ( 2 - 1 ) by TAYLOR_1:11 , XREAL_1:15;
L1343: ( log (2 , ( number_e )) ) > ( 0 ) by L1342 , L156;
L1344: (for B134 being Nat holds (B134 in ( Seg D61 ) implies ( D60 . B134 ) <= ( C141 . B134 )))
proof
let C143 being Nat;
assume that
L1345: C143 in ( Seg D61 );
L1346: C143 in ( dom C137 ) by L1345 , FINSEQ_1:def 3;
L1347: ( C137 . C143 ) > ( 0 ) by L1346 , L1306;
L1348: ( C138 . C143 ) > ( 0 ) by L1306 , L1346;
L1349: ( ( C138 . C143 ) / ( C137 . C143 ) ) > ( 0 ) by L1348 , L1347 , XREAL_1:139;
L1350: ( log (( number_e ) , ( ( C138 . C143 ) / ( C137 . C143 ) )) ) <= ( ( ( C138 . C143 ) / ( C137 . C143 ) ) - 1 ) by L1349 , L150;
L1351: ( ( ( C137 . C143 ) * ( log (2 , ( number_e )) ) ) * ( log (( number_e ) , ( ( C138 . C143 ) / ( C137 . C143 ) )) ) ) <= ( ( ( C137 . C143 ) * ( log (2 , ( number_e )) ) ) * ( ( ( C138 . C143 ) / ( C137 . C143 ) ) - 1 ) ) by L1350 , L1343 , L1347 , XREAL_1:64;
L1352: ( D60 . C143 ) <= ( ( ( C137 . C143 ) * ( log (2 , ( number_e )) ) ) * ( ( ( C138 . C143 ) / ( C137 . C143 ) ) - 1 ) ) by L1351 , L1313 , L1346;
thus L1353: thesis by L1352 , L1324 , L1328 , L1345;
end;
L1354: C141 is (Element of ( D61 -tuples_on ( REAL ) )) by L1323 , FINSEQ_2:92;
thus L1355: ( Sum C139 ) <= ( Sum C140 ) by L1354 , L1311 , L1344 , L1327 , L1341 , RVSUM_1:82 , XREAL_1:50;
L1356: ((ex R4 being (Element of ( NAT )) st (R4 in ( Seg D61 ) & ( C137 . R4 ) <> ( C138 . R4 ))) implies ( Sum C139 ) < ( Sum C140 ))
proof
assume L1357: (ex R4 being (Element of ( NAT )) st (R4 in ( Seg D61 ) & ( C137 . R4 ) <> ( C138 . R4 )));
consider C144 being Nat such that L1358: C144 in ( Seg D61 ) and L1359: ( C137 . C144 ) <> ( C138 . C144 ) by L1357;
L1360: C144 in ( dom C137 ) by L1358 , FINSEQ_1:def 3;
L1361: ( C137 . C144 ) > ( 0 ) by L1360 , L1306;
L1362: ( ( C137 . C144 ) * ( log (2 , ( number_e )) ) ) > ( 0 ) by L1361 , L1343 , XREAL_1:129;
L1363: ( C138 . C144 ) > ( 0 ) by L1306 , L1360;
L1364: ( ( C138 . C144 ) / ( C137 . C144 ) ) > ( 0 ) by L1363 , L1361 , XREAL_1:139;
L1365: ( ( C138 . C144 ) / ( C137 . C144 ) ) <> 1 by L1359 , XCMPLX_1:58;
L1366: ( log (( number_e ) , ( ( C138 . C144 ) / ( C137 . C144 ) )) ) < ( ( ( C138 . C144 ) / ( C137 . C144 ) ) - 1 ) by L1365 , L1364 , L150;
L1367: ( ( ( C137 . C144 ) * ( log (2 , ( number_e )) ) ) * ( log (( number_e ) , ( ( C138 . C144 ) / ( C137 . C144 ) )) ) ) < ( ( ( C137 . C144 ) * ( log (2 , ( number_e )) ) ) * ( ( ( C138 . C144 ) / ( C137 . C144 ) ) - 1 ) ) by L1366 , L1362 , XREAL_1:68;
L1368: ( D60 . C144 ) < ( ( ( C137 . C144 ) * ( log (2 , ( number_e )) ) ) * ( ( ( C138 . C144 ) / ( C137 . C144 ) ) - 1 ) ) by L1367 , L1313 , L1360;
L1369: ( D60 . C144 ) < ( C141 . C144 ) by L1368 , L1324 , L1328 , L1358;
L1370: ( ( Sum C139 ) - ( Sum C140 ) ) < ( 0 ) by L1369 , L1311 , L1344 , L1327 , L1354 , L1341 , L1358 , RVSUM_1:83;
thus L1371: thesis by L1370 , XREAL_1:48;
end;
L1372: ( dom D60 ) = ( dom C141 ) by L1326 , L1323 , FINSEQ_3:29;
thus L1373: ((for R4 being (Element of ( NAT )) holds (R4 in ( dom C137 ) implies ( C137 . R4 ) = ( C138 . R4 ))) iff ( Sum C139 ) = ( Sum C140 ))
proof
thus L1374:now
assume L1375: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C137 ) implies ( C137 . R4 ) = ( C138 . R4 )));
L1376: (for B135 being Nat holds (B135 in ( dom C137 ) implies ( D60 . B135 ) = ( C141 . B135 )))
proof
let C145 being Nat;
assume that
L1377: C145 in ( dom C137 );
L1378: ( C137 . C145 ) = ( C138 . C145 ) by L1375 , L1377;
L1379: ( C137 . C145 ) > ( 0 ) by L1306 , L1377;
L1380: ( ( C138 . C145 ) / ( C137 . C145 ) ) = 1 by L1379 , L1378 , XCMPLX_1:60;
L1381: ( ( ( C137 . C145 ) * ( log (2 , ( number_e )) ) ) * ( log (( number_e ) , ( ( C138 . C145 ) / ( C137 . C145 ) )) ) ) = ( ( ( C137 . C145 ) * ( log (2 , ( number_e )) ) ) * ( ( ( C138 . C145 ) / ( C137 . C145 ) ) - 1 ) ) by L1380 , L150;
L1382: ( D60 . C145 ) = ( ( ( C137 . C145 ) * ( log (2 , ( number_e )) ) ) * ( ( ( C138 . C145 ) / ( C137 . C145 ) ) - 1 ) ) by L1381 , L1313 , L1377;
L1383: C145 in ( Seg D61 ) by L1377 , FINSEQ_1:def 3;
thus L1384: thesis by L1383 , L1324 , L1328 , L1382;
end;
L1385: ( Sum D60 ) = ( 0 ) by L1376 , L1325 , L1372 , L1341 , FINSEQ_1:13;
thus L1386: ( Sum C139 ) = ( Sum C140 ) by L1385 , L1311;
end;
assume L1387: ( Sum C139 ) = ( Sum C140 );
assume L1388: (not (for R4 being (Element of ( NAT )) holds (R4 in ( dom C137 ) implies ( C137 . R4 ) = ( C138 . R4 ))));
thus L1389: contradiction by L1388 , L1334 , L1356 , L1387;
end;

thus L1390: thesis by L1373 , L1334 , L1356;
end;
theorem
L1391: (for B136 being non  empty  ProbFinS (FinSequence of ( REAL )) holds ((for R4 being (Element of ( NAT )) holds (R4 in ( dom B136 ) implies ( B136 . R4 ) > ( 0 ))) implies (( Entropy B136 ) <= ( log (2 , ( len B136 )) ) & ((for R4 being (Element of ( NAT )) holds (R4 in ( dom B136 ) implies ( B136 . R4 ) = ( 1 / ( len B136 ) ))) iff ( Entropy B136 ) = ( log (2 , ( len B136 )) )) & ((ex R4 being (Element of ( NAT )) st (R4 in ( dom B136 ) & ( B136 . R4 ) <> ( 1 / ( len B136 ) ))) iff ( Entropy B136 ) < ( log (2 , ( len B136 )) )))))
proof
let C146 being non  empty  ProbFinS (FinSequence of ( REAL ));
assume that
L1392: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C146 ) implies ( C146 . R4 ) > ( 0 )));
set D62 = ( - ( Infor_FinSeq_of C146 ) );
set D63 = ( len C146 );
reconsider D64 = D63 as non  empty (Element of ( NAT ));
reconsider D65 = ( 1 / D64 ) as (Element of ( REAL ));
reconsider D66 = ( D63 |-> D65 ) as (FinSequence of ( REAL ));
deffunc H6(Nat) = ( - ( ( C146 . $1 ) * ( log (2 , ( D66 . $1 )) ) ) );
consider C147 being (FinSequence of ( REAL )) such that L1393: ( len C147 ) = D63 and L1394: (for B137 being Nat holds (B137 in ( dom C147 ) implies ( C147 . B137 ) = H6(B137))) from FINSEQ_2:sch 1;
L1395: ( dom C147 ) = ( Seg D63 ) by L1393 , FINSEQ_1:def 3;
L1396: (for B138 being Nat holds (B138 in ( dom C147 ) implies ( C147 . B138 ) = ( ( ( - ( log (2 , ( 1 / D64 )) ) ) * C146 ) . B138 )))
proof
let C148 being Nat;
assume that
L1397: C148 in ( dom C147 );
thus L1398: ( C147 . C148 ) = ( - ( ( C146 . C148 ) * ( log (2 , ( D66 . C148 )) ) ) ) by L1394 , L1397
.= ( - ( ( C146 . C148 ) * ( log (2 , ( 1 / D64 )) ) ) ) by L1395 , L1397 , FINSEQ_2:57
.= ( ( - ( log (2 , ( 1 / D64 )) ) ) * ( C146 . C148 ) )
.= ( ( ( - ( log (2 , ( 1 / D64 )) ) ) * C146 ) . C148 ) by RVSUM_1:44;
end;
L1399: ( len D66 ) = D63 by CARD_1:def 7;
L1400: ( dom ( Infor_FinSeq_of C146 ) ) = ( Seg ( len ( Infor_FinSeq_of C146 ) ) ) by FINSEQ_1:def 3
.= ( Seg D63 ) by L1070;
L1401: (( len D62 ) = D63 & (for R4 being (Element of ( NAT )) holds (R4 in ( Seg D63 ) implies ( D62 . R4 ) = ( - ( ( C146 . R4 ) * ( log (2 , ( C146 . R4 )) ) ) ))))
proof
L1402: ( dom D62 ) = ( Seg D63 ) by L1400 , VALUED_1:8;
thus L1403: ( len D62 ) = D63 by L1402 , FINSEQ_1:def 3;
thus L1404:now
let R4 being (Element of ( NAT ));
assume that
L1405: R4 in ( Seg D63 );
thus L1406: ( D62 . R4 ) = ( - ( ( Infor_FinSeq_of C146 ) . R4 ) ) by RVSUM_1:17
.= ( - ( ( C146 . R4 ) * ( log (2 , ( C146 . R4 )) ) ) ) by L1400 , L1405 , L1070;
end;
end;
L1405: ( dom C147 ) = ( dom C146 ) by L1393 , FINSEQ_3:29;
L1406: ( dom C147 ) = ( dom ( ( - ( log (2 , ( 1 / D64 )) ) ) * C146 ) ) by L1405 , VALUED_1:def 5;
L1407: C147 = ( ( - ( log (2 , ( 1 / D64 )) ) ) * C146 ) by L1406 , L1396 , FINSEQ_1:13;
L1408: ( Sum C147 ) = ( ( - ( log (2 , ( 1 / D64 )) ) ) * ( Sum C146 ) ) by L1407 , RVSUM_1:87
.= ( ( - ( log (2 , ( 1 / D64 )) ) ) * 1 ) by MATRPROB:def 5
.= ( log (2 , ( 1 / ( 1 / D64 ) )) ) by L166
.= ( log (2 , D63) );
L1409: D66 is non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS (FinSequence of ( REAL )) by L417;
L1410: ( dom C146 ) = ( Seg ( len C146 ) ) by FINSEQ_1:def 3;
L1411: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C146 ) implies (( C146 . R4 ) > ( 0 ) & ( D66 . R4 ) > ( 0 ) & ( D62 . R4 ) = ( - ( ( C146 . R4 ) * ( log (2 , ( C146 . R4 )) ) ) ) & ( C147 . R4 ) = ( - ( ( C146 . R4 ) * ( log (2 , ( D66 . R4 )) ) ) )))) by L1410 , L1392 , L1394 , L1395 , L1401 , FINSEQ_2:57;
L1412: ( Sum D62 ) = ( Entropy C146 ) by RVSUM_1:88;
thus L1413: ( Entropy C146 ) <= ( log (2 , ( len C146 )) ) by L1412 , L1399 , L1409 , L1393 , L1401 , L1411 , L1408 , L1302;
thus L1414: ((for R4 being (Element of ( NAT )) holds (R4 in ( dom C146 ) implies ( C146 . R4 ) = ( 1 / ( len C146 ) ))) iff ( Entropy C146 ) = ( log (2 , ( len C146 )) ))
proof
thus L1415:now
assume L1416: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C146 ) implies ( C146 . R4 ) = ( 1 / ( len C146 ) )));
L1417:
now
let R4 being (Element of ( NAT ));
assume that
L1418: R4 in ( dom C146 );
thus L1419: ( C146 . R4 ) = ( 1 / D63 ) by L1416 , L1418
.= ( D66 . R4 ) by L1410 , L1418 , FINSEQ_2:57;
end;
thus L1420: ( Entropy C146 ) = ( log (2 , D63) ) by L1417 , L1399 , L1409 , L1393 , L1401 , L1411 , L1412 , L1408 , L1302;
end;
assume L1421: ( Entropy C146 ) = ( log (2 , D63) );
thus L1422:now
let R4 being (Element of ( NAT ));
assume L1423: R4 in ( dom C146 );
thus L1424: ( C146 . R4 ) = ( D66 . R4 ) by L1423 , L1399 , L1409 , L1393 , L1401 , L1411 , L1412 , L1408 , L1421 , L1302
.= ( 1 / D63 ) by L1410 , L1423 , FINSEQ_2:57;
end;
end;

L1423: ((for R4 being (Element of ( NAT )) holds (R4 in ( dom C146 ) implies ( C146 . R4 ) = ( D66 . R4 ))) iff ( Sum D62 ) = ( Sum C147 )) by L1399 , L1409 , L1393 , L1401 , L1411 , L1302;
thus L1424: ((ex R4 being (Element of ( NAT )) st (R4 in ( dom C146 ) & ( C146 . R4 ) <> ( 1 / ( len C146 ) ))) iff ( Entropy C146 ) < ( log (2 , ( len C146 )) ))
proof
thus L1425:now
assume L1426: (ex R4 being (Element of ( NAT )) st (R4 in ( dom C146 ) & ( C146 . R4 ) <> ( 1 / ( len C146 ) )));
consider C149 being Nat such that L1427: C149 in ( dom C146 ) and L1428: ( C146 . C149 ) <> ( 1 / D63 ) by L1426;
L1429: ( D66 . C149 ) <> ( C146 . C149 ) by L1410 , L1427 , L1428 , FINSEQ_2:57;
thus L1430: ( Entropy C146 ) < ( log (2 , D63) ) by L1429 , L1399 , L1409 , L1393 , L1401 , L1411 , L1412 , L1408 , L1427 , L1302;
end;
assume L1431: ( Entropy C146 ) < ( log (2 , D63) );
consider C150 being Nat such that L1432: C150 in ( dom C146 ) and L1433: ( C146 . C150 ) <> ( D66 . C150 ) by L1431 , L1423 , L1408 , RVSUM_1:88;
L1434: ( D66 . C150 ) = ( 1 / D63 ) by L1410 , L1432 , FINSEQ_2:57;
thus L1435: thesis by L1434 , L1432 , L1433;
end;

end;
theorem
L1425: (for B139 being  m-nonnegative (Matrix of ( REAL )) holds ( Mx2FinS ( Infor_FinSeq_of B139 ) ) = ( Infor_FinSeq_of ( Mx2FinS B139 ) ))
proof
let C151 being  m-nonnegative (Matrix of ( REAL ));
reconsider D67 = ( Mx2FinS C151 ) as  nonnegative (FinSequence of ( REAL )) by L1001;
set D68 = ( Infor_FinSeq_of D67 );
set D69 = ( Mx2FinS ( Infor_FinSeq_of C151 ) );
set D70 = ( Infor_FinSeq_of C151 );
L1426: ( len D67 ) = ( ( len C151 ) * ( width C151 ) ) by L950;
L1427: ( width D70 ) = ( width C151 ) by L1176;
L1428: ( len D70 ) = ( len C151 ) by L1176;
L1429: ( len D69 ) = ( ( len C151 ) * ( width C151 ) ) by L1428 , L1427 , L950;
L1430: ( len D68 ) = ( len D67 ) by L1070;
L1431: ( dom D69 ) = ( dom D68 ) by L1430 , L1426 , L1429 , FINSEQ_3:29;
L1432: ( dom D69 ) = ( dom D67 ) by L1426 , L1429 , FINSEQ_3:29;
L1433:
now
let C152 being Nat;
assume that
L1434: C152 in ( dom D69 );
L1435: C152 in ( Seg ( len D69 ) ) by L1434 , FINSEQ_1:def 3;
L1436: C152 >= 1 by L1435 , FINSEQ_1:1;
reconsider D71 = ( C152 - 1 ) as (Element of ( NAT )) by L1436 , NAT_1:21;
set D72 = ( ( D71 mod ( width D70 ) ) + 1 );
set D73 = ( ( D71 div ( width D70 ) ) + 1 );
L1437: [ D73 , D72 ] in ( Indices D70 ) by L1434 , L969;
L1438: ( D69 . C152 ) = ( D70 * (D73 , D72) ) by L1434 , L969;
L1439: ( D67 . C152 ) = ( C151 * (D73 , D72) ) by L1427 , L1432 , L1434 , L969;
thus L1440: ( D68 . C152 ) = ( ( D67 . C152 ) * ( log (2 , ( D67 . C152 )) ) ) by L1431 , L1434 , L1070
.= ( D69 . C152 ) by L1437 , L1438 , L1439 , L1226;
end;
thus L1441: thesis by L1433 , L1431 , FINSEQ_1:13;
end;
theorem
L1442: (for B140 , B141 being  ProbFinS (FinSequence of ( REAL )) holds (for B142 being (Matrix of ( REAL )) holds (B142 = ( ( ColVec2Mx B140 ) * ( LineVec2Mx B141 ) ) implies ( SumAll ( Infor_FinSeq_of B142 ) ) = ( ( Sum ( Infor_FinSeq_of B140 ) ) + ( Sum ( Infor_FinSeq_of B141 ) ) ))))
proof
let C153 , C154 being  ProbFinS (FinSequence of ( REAL ));
set D74 = ( Infor_FinSeq_of C153 );
set D75 = ( ( Sum ( Infor_FinSeq_of C154 ) ) * C153 );
L1443: ( len D74 ) = ( len C153 ) by L1070;
L1444: ( dom D75 ) = ( dom C153 ) by VALUED_1:def 5;
L1445: ( len D74 ) = ( len D75 ) by L1444 , L1443 , FINSEQ_3:29;
L1446: ( len ( FinSeq_log (2 , C154) ) ) = ( len C154 ) by L1041;
L1447: ( len ( mlt (C154 , ( FinSeq_log (2 , C154) )) ) ) = ( len C154 ) by L1446 , MATRPROB:30;
let C155 being (Matrix of ( REAL ));
assume that
L1448: C155 = ( ( ColVec2Mx C153 ) * ( LineVec2Mx C154 ) );
reconsider D76 = C155 as  Joint_Probability (Matrix of ( REAL )) by L1448 , L518;
set D77 = ( Infor_FinSeq_of D76 );
set D78 = ( LineSum D77 );
L1449: ( len D78 ) = ( len D77 ) by MATRPROB:def 1;
L1450: ( dom D78 ) = ( dom D77 ) by L1449 , FINSEQ_3:29;
L1451: ( len D77 ) = ( len D76 ) by L1176;
L1452: ( dom D77 ) = ( dom D76 ) by L1451 , FINSEQ_3:29;
L1453: ( len D76 ) = ( len C153 ) by L1448 , L504;
L1454: ( dom D76 ) = ( dom C153 ) by L1453 , FINSEQ_3:29;
L1455:
now
let R4 being (Element of ( NAT ));
assume that
L1456: R4 in ( dom D78 );
reconsider D79 = ( Line (D76 , R4) ) as  nonnegative (FinSequence of ( REAL )) by L1450 , L1452 , L1456 , L441;
L1457: D79 = ( ( C153 . R4 ) * C154 ) by L1448 , L1450 , L1452 , L1456 , L504;
L1458: ( dom ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) * C154 ) ) = ( dom C154 ) by VALUED_1:def 5;
L1459: ( len ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) * C154 ) ) = ( len C154 ) by L1458 , FINSEQ_3:29;
L1460: ( dom ( ( C153 . R4 ) * ( mlt (C154 , ( FinSeq_log (2 , C154) )) ) ) ) = ( dom ( mlt (C154 , ( FinSeq_log (2 , C154) )) ) ) by VALUED_1:def 5;
L1461: ( len ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) * C154 ) ) = ( len ( ( C153 . R4 ) * ( mlt (C154 , ( FinSeq_log (2 , C154) )) ) ) ) by L1460 , L1447 , L1459 , FINSEQ_3:29;
L1462: ( C153 . R4 ) >= ( 0 ) by L1450 , L1452 , L1454 , L1456 , L229;
thus L1463: ( D78 . R4 ) = ( Sum ( D77 . R4 ) ) by L1456 , MATRPROB:def 1
.= ( Sum ( Line (D77 , R4) ) ) by L1450 , L1456 , MATRIX_2:16
.= ( Sum ( Infor_FinSeq_of D79 ) ) by L1450 , L1452 , L1456 , L1221
.= ( Sum ( ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) * C154 ) + ( ( C153 . R4 ) * ( mlt (C154 , ( FinSeq_log (2 , C154) )) ) ) ) ) by L1457 , L1462 , L1139
.= ( ( Sum ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) * C154 ) ) + ( Sum ( ( C153 . R4 ) * ( mlt (C154 , ( FinSeq_log (2 , C154) )) ) ) ) ) by L1461 , INTEGRA5:2
.= ( ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) * ( Sum C154 ) ) + ( Sum ( ( C153 . R4 ) * ( mlt (C154 , ( FinSeq_log (2 , C154) )) ) ) ) ) by RVSUM_1:87
.= ( ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) * 1 ) + ( Sum ( ( C153 . R4 ) * ( mlt (C154 , ( FinSeq_log (2 , C154) )) ) ) ) ) by MATRPROB:def 5
.= ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) + ( ( C153 . R4 ) * ( Sum ( Infor_FinSeq_of C154 ) ) ) ) by RVSUM_1:87;
end;
L1464: ( dom D74 ) = ( dom D78 ) by L1453 , L1451 , L1449 , L1443 , FINSEQ_3:29;
L1465:
now
let R4 being (Element of ( NAT ));
assume that
L1466: R4 in ( dom D74 );
thus L1467: ( D78 . R4 ) = ( ( ( C153 . R4 ) * ( log (2 , ( C153 . R4 )) ) ) + ( ( C153 . R4 ) * ( Sum ( Infor_FinSeq_of C154 ) ) ) ) by L1455 , L1464 , L1466
.= ( ( D74 . R4 ) + ( ( C153 . R4 ) * ( Sum ( Infor_FinSeq_of C154 ) ) ) ) by L1466 , L1070
.= ( ( D74 . R4 ) + ( D75 . R4 ) ) by RVSUM_1:44;
end;
L1468: ( Sum D78 ) = ( ( Sum D74 ) + ( Sum D75 ) ) by L1465 , L1453 , L1451 , L1449 , L1443 , L1445 , L185
.= ( ( Sum D74 ) + ( ( Sum ( Infor_FinSeq_of C154 ) ) * ( Sum C153 ) ) ) by RVSUM_1:87
.= ( ( Sum D74 ) + ( ( Sum ( Infor_FinSeq_of C154 ) ) * 1 ) ) by MATRPROB:def 5
.= ( ( Sum ( Infor_FinSeq_of C153 ) ) + ( Sum ( Infor_FinSeq_of C154 ) ) );
thus L1469: thesis by L1468 , MATRPROB:def 3;
end;
definition
let R16 being (Matrix of ( REAL ));
func Entropy_of_Joint_Prob R16 -> Real equals 
( Entropy ( Mx2FinS R16 ) );
coherence;
end;
theorem
L1471: (for B143 , B144 being  ProbFinS (FinSequence of ( REAL )) holds ( Entropy_of_Joint_Prob ( ( ColVec2Mx B143 ) * ( LineVec2Mx B144 ) ) ) = ( ( Entropy B143 ) + ( Entropy B144 ) ))
proof
let C156 , C157 being  ProbFinS (FinSequence of ( REAL ));
set D80 = ( ( ColVec2Mx C156 ) * ( LineVec2Mx C157 ) );
reconsider D81 = D80 as  Joint_Probability (Matrix of ( REAL )) by L518;
set D82 = ( Mx2FinS ( ( ColVec2Mx C156 ) * ( LineVec2Mx C157 ) ) );
reconsider D83 = D82 as  ProbFinS (FinSequence of ( REAL )) by L1033;
L1472: ( ( Entropy C156 ) + ( Entropy C157 ) ) = ( - ( ( Sum ( Infor_FinSeq_of C156 ) ) + ( Sum ( Infor_FinSeq_of C157 ) ) ) )
.= ( - ( SumAll ( Infor_FinSeq_of D81 ) ) ) by L1442
.= ( - ( Sum ( Mx2FinS ( Infor_FinSeq_of D81 ) ) ) ) by L994
.= ( - ( Sum ( Infor_FinSeq_of D83 ) ) ) by L1425;
thus L1473: thesis by L1472;
end;
definition
let R16 being (Matrix of ( REAL ));
func Entropy_of_Cond_Prob R16 -> (FinSequence of ( REAL )) means 
:L1474: (( len it ) = ( len R16 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom it ) implies ( it . R4 ) = ( Entropy ( Line (R16 , R4) ) ))));
existence
proof
deffunc H7(Nat) = ( Entropy ( Line (R16 , $1) ) );
consider C158 being (FinSequence of ( REAL )) such that L1475: ( len C158 ) = ( len R16 ) and L1476: (for B145 being Nat holds (B145 in ( dom C158 ) implies ( C158 . B145 ) = H7(B145))) from FINSEQ_2:sch 1;
take C158;
thus L1477: thesis by L1475 , L1476;
end;
uniqueness
proof
let C159 , C160 being (FinSequence of ( REAL ));
assume that
L1478: ( len C159 ) = ( len R16 )
and
L1479: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C159 ) implies ( C159 . R4 ) = ( Entropy ( Line (R16 , R4) ) )))
and
L1480: ( len C160 ) = ( len R16 )
and
L1481: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C160 ) implies ( C160 . R4 ) = ( Entropy ( Line (R16 , R4) ) )));
L1482: ( dom C159 ) = ( dom C160 ) by L1478 , L1480 , FINSEQ_3:29;
L1483:
now
let C161 being Nat;
assume that
L1484: C161 in ( dom C159 );
thus L1485: ( C159 . C161 ) = ( Entropy ( Line (R16 , C161) ) ) by L1479 , L1484
.= ( C160 . C161 ) by L1481 , L1482 , L1484;
end;
thus L1486: thesis by L1483 , L1482 , FINSEQ_1:13;
end;
end;
theorem
L1488: (for B146 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds (for B147 being (FinSequence of ( REAL )) holds (B147 = ( Entropy_of_Cond_Prob B146 ) iff (( len B147 ) = ( len B146 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom B147 ) implies ( B147 . R4 ) = ( - ( Sum ( ( Infor_FinSeq_of B146 ) . R4 ) ) )))))))
proof
let C162 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
let C163 being (FinSequence of ( REAL ));
L1489: ( len ( Infor_FinSeq_of C162 ) ) = ( len C162 ) by L1176;
thus L1490:now
assume L1491: C163 = ( Entropy_of_Cond_Prob C162 );
L1492: ( len C163 ) = ( len C162 ) by L1491 , L1474;
L1493: ( dom C163 ) = ( dom C162 ) by L1492 , FINSEQ_3:29;
L1494:
now
let R4 being (Element of ( NAT ));
assume that
L1495: R4 in ( dom C163 );
L1496: R4 in ( dom ( Infor_FinSeq_of C162 ) ) by L1489 , L1492 , L1495 , FINSEQ_3:29;
thus L1497: ( C163 . R4 ) = ( Entropy ( Line (C162 , R4) ) ) by L1491 , L1495 , L1474
.= ( - ( Sum ( Line (( Infor_FinSeq_of C162 ) , R4) ) ) ) by L1493 , L1495 , L1221
.= ( - ( Sum ( ( Infor_FinSeq_of C162 ) . R4 ) ) ) by L1496 , MATRIX_2:16;
end;
thus L1498: (( len C163 ) = ( len C162 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom C163 ) implies ( C163 . R4 ) = ( - ( Sum ( ( Infor_FinSeq_of C162 ) . R4 ) ) )))) by L1494 , L1491 , L1474;
end;
assume that
L1499: ( len C163 ) = ( len C162 )
and
L1500: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C163 ) implies ( C163 . R4 ) = ( - ( Sum ( ( Infor_FinSeq_of C162 ) . R4 ) ) )));
L1501: ( dom C163 ) = ( dom C162 ) by L1499 , FINSEQ_3:29;
L1502: ( dom ( Infor_FinSeq_of C162 ) ) = ( dom C162 ) by L1489 , FINSEQ_3:29;
L1503:
now
let R4 being (Element of ( NAT ));
assume that
L1504: R4 in ( dom C163 );
thus L1505: ( C163 . R4 ) = ( - ( Sum ( ( Infor_FinSeq_of C162 ) . R4 ) ) ) by L1500 , L1504
.= ( - ( Sum ( Line (( Infor_FinSeq_of C162 ) , R4) ) ) ) by L1502 , L1501 , L1504 , MATRIX_2:16
.= ( Entropy ( Line (C162 , R4) ) ) by L1501 , L1504 , L1221;
end;
thus L1506: thesis by L1503 , L1499 , L1474;
end;
theorem
L1507: (for B148 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds ( Entropy_of_Cond_Prob B148 ) = ( - ( LineSum ( Infor_FinSeq_of B148 ) ) ))
proof
let C164 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
set D84 = ( Entropy_of_Cond_Prob C164 );
set D85 = ( - ( LineSum ( Infor_FinSeq_of C164 ) ) );
L1508: ( dom D85 ) = ( dom ( LineSum ( Infor_FinSeq_of C164 ) ) ) by VALUED_1:8;
L1509: ( len D85 ) = ( len ( LineSum ( Infor_FinSeq_of C164 ) ) ) by L1508 , FINSEQ_3:29;
L1510: ( len D85 ) = ( len ( Infor_FinSeq_of C164 ) ) by L1509 , MATRPROB:def 1;
L1511: ( len D85 ) = ( len C164 ) by L1510 , L1176;
L1512: ( len D84 ) = ( len C164 ) by L1488;
L1513: ( dom D84 ) = ( dom D85 ) by L1512 , L1511 , FINSEQ_3:29;
L1514:
now
let C165 being Nat;
assume that
L1515: C165 in ( dom D84 );
thus L1516: ( D84 . C165 ) = ( - ( Sum ( ( Infor_FinSeq_of C164 ) . C165 ) ) ) by L1515 , L1488
.= ( - ( ( Sum ( Infor_FinSeq_of C164 ) ) . C165 ) ) by L1508 , L1513 , L1515 , MATRPROB:def 1
.= ( D85 . C165 ) by RVSUM_1:17;
end;
thus L1517: thesis by L1514 , L1513 , FINSEQ_1:13;
end;
theorem
L1518: (for B149 being  ProbFinS (FinSequence of ( REAL )) holds (for B150 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds (( len B149 ) = ( len B150 ) implies (for B151 being (Matrix of ( REAL )) holds (B151 = ( ( Vec2DiagMx B149 ) * B150 ) implies ( SumAll ( Infor_FinSeq_of B151 ) ) = ( ( Sum ( Infor_FinSeq_of B149 ) ) + ( Sum ( mlt (B149 , ( LineSum ( Infor_FinSeq_of B150 ) )) ) ) ))))))
proof
let C166 being  ProbFinS (FinSequence of ( REAL ));
let C167 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
assume L1519: ( len C166 ) = ( len C167 );
let C168 being (Matrix of ( REAL ));
assume that
L1520: C168 = ( ( Vec2DiagMx C166 ) * C167 );
reconsider D86 = C168 as  Joint_Probability (Matrix of ( REAL )) by L1519 , L1520 , L678;
L1521: ( len D86 ) = ( len C166 ) by L1519 , L1520 , L634;
L1522: ( dom D86 ) = ( dom C166 ) by L1521 , FINSEQ_3:29;
set D87 = ( Infor_FinSeq_of D86 );
set D88 = ( LineSum D87 );
L1523: ( len D88 ) = ( len D87 ) by MATRPROB:def 1;
L1524: ( dom D88 ) = ( dom D87 ) by L1523 , FINSEQ_3:29;
L1525: ( len D87 ) = ( len D86 ) by L1176;
L1526: ( dom D87 ) = ( dom D86 ) by L1525 , FINSEQ_3:29;
L1527: ( dom C166 ) = ( dom C167 ) by L1519 , FINSEQ_3:29;
L1528: (for R4 being (Element of ( NAT )) holds (R4 in ( dom D88 ) implies ( D88 . R4 ) = ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) + ( ( C166 . R4 ) * ( Sum ( Infor_FinSeq_of ( Line (C167 , R4) ) ) ) ) )))
proof
let R4 being (Element of ( NAT ));
assume that
L1529: R4 in ( dom D88 );
reconsider D89 = ( Line (D86 , R4) ) as  nonnegative (FinSequence of ( REAL )) by L1524 , L1526 , L1529 , L441;
L1530: ( C166 . R4 ) >= ( 0 ) by L1524 , L1526 , L1522 , L1529 , L229;
reconsider D90 = ( Line (C167 , R4) ) as non  empty  ProbFinS (FinSequence of ( REAL )) by L1524 , L1526 , L1522 , L1527 , L1529 , MATRPROB:60;
L1531: D89 = ( ( C166 . R4 ) * D90 ) by L1519 , L1520 , L1524 , L1526 , L1529 , L662;
L1532: ( dom ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) * D90 ) ) = ( dom D90 ) by VALUED_1:def 5;
L1533: ( len ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) * D90 ) ) = ( len D90 ) by L1532 , FINSEQ_3:29;
L1534: ( len ( FinSeq_log (2 , D90) ) ) = ( len D90 ) by L1041;
L1535: ( len ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) = ( len D90 ) by L1534 , MATRPROB:30;
L1536: ( dom ( ( C166 . R4 ) * ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) ) = ( dom ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) by VALUED_1:def 5;
L1537: ( len ( ( C166 . R4 ) * ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) ) = ( len ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) by L1536 , FINSEQ_3:29;
L1538: ( D88 . R4 ) = ( Sum ( D87 . R4 ) ) by L1529 , MATRPROB:def 1
.= ( Sum ( Line (D87 , R4) ) ) by L1524 , L1529 , MATRIX_2:16
.= ( Sum ( Infor_FinSeq_of D89 ) ) by L1524 , L1526 , L1529 , L1221
.= ( Sum ( ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) * D90 ) + ( ( C166 . R4 ) * ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) ) ) by L1531 , L1530 , L1139
.= ( ( Sum ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) * D90 ) ) + ( Sum ( ( C166 . R4 ) * ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) ) ) by L1535 , L1533 , L1537 , INTEGRA5:2
.= ( ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) * ( Sum D90 ) ) + ( Sum ( ( C166 . R4 ) * ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) ) ) by RVSUM_1:87
.= ( ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) * 1 ) + ( Sum ( ( C166 . R4 ) * ( mlt (D90 , ( FinSeq_log (2 , D90) )) ) ) ) ) by MATRPROB:def 5
.= ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) + ( ( C166 . R4 ) * ( Sum ( Infor_FinSeq_of D90 ) ) ) ) by RVSUM_1:87;
thus L1539: thesis by L1538;
end;
set D91 = ( Infor_FinSeq_of C167 );
set D92 = ( LineSum D91 );
set D93 = ( mlt (C166 , D92) );
set D94 = ( Infor_FinSeq_of C166 );
L1540: ( len D94 ) = ( len C166 ) by L1070;
L1541: ( dom D94 ) = ( dom C167 ) by L1540 , L1519 , FINSEQ_3:29;
L1542: ( len D91 ) = ( len C167 ) by L1176;
L1543: ( len D92 ) = ( len C166 ) by L1542 , L1519 , MATRPROB:def 1;
L1544: ( len D93 ) = ( len C166 ) by L1543 , MATRPROB:30;
L1545: ( dom D94 ) = ( dom D91 ) by L1519 , L1542 , L1540 , FINSEQ_3:29;
L1546: ( dom D92 ) = ( dom D94 ) by L1543 , L1540 , FINSEQ_3:29;
L1547: ( dom D94 ) = ( dom D88 ) by L1521 , L1525 , L1523 , L1540 , FINSEQ_3:29;
L1548:
now
let R4 being (Element of ( NAT ));
assume that
L1549: R4 in ( dom D94 );
L1550: ( D93 . R4 ) = ( ( C166 . R4 ) * ( D92 . R4 ) ) by RVSUM_1:59
.= ( ( C166 . R4 ) * ( Sum ( D91 . R4 ) ) ) by L1546 , L1549 , MATRPROB:def 1
.= ( ( C166 . R4 ) * ( Sum ( Line (D91 , R4) ) ) ) by L1545 , L1549 , MATRIX_2:16
.= ( ( C166 . R4 ) * ( Sum ( Infor_FinSeq_of ( Line (C167 , R4) ) ) ) ) by L1541 , L1549 , L1221;
thus L1551: ( D88 . R4 ) = ( ( ( C166 . R4 ) * ( log (2 , ( C166 . R4 )) ) ) + ( ( C166 . R4 ) * ( Sum ( Infor_FinSeq_of ( Line (C167 , R4) ) ) ) ) ) by L1528 , L1547 , L1549
.= ( ( D94 . R4 ) + ( D93 . R4 ) ) by L1549 , L1550 , L1070;
end;
L1552: ( Sum D88 ) = ( ( Sum ( Infor_FinSeq_of C166 ) ) + ( Sum ( mlt (C166 , ( LineSum ( Infor_FinSeq_of C167 ) )) ) ) ) by L1548 , L1521 , L1525 , L1523 , L1540 , L1544 , L185;
thus L1553: thesis by L1552 , MATRPROB:def 3;
end;
theorem
L1554: (for B152 being  ProbFinS (FinSequence of ( REAL )) holds (for B153 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds (( len B152 ) = ( len B153 ) implies ( Entropy_of_Joint_Prob ( ( Vec2DiagMx B152 ) * B153 ) ) = ( ( Entropy B152 ) + ( Sum ( mlt (B152 , ( Entropy_of_Cond_Prob B153 )) ) ) ))))
proof
let C169 being  ProbFinS (FinSequence of ( REAL ));
let C170 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
set D95 = ( ( Vec2DiagMx C169 ) * C170 );
assume L1555: ( len C169 ) = ( len C170 );
reconsider D96 = D95 as  Joint_Probability (Matrix of ( REAL )) by L1555 , L678;
L1556: ( ( Entropy C169 ) + ( Sum ( mlt (C169 , ( Entropy_of_Cond_Prob C170 )) ) ) ) = ( ( - ( Sum ( Infor_FinSeq_of C169 ) ) ) + ( Sum ( mlt (C169 , ( - ( LineSum ( Infor_FinSeq_of C170 ) ) )) ) ) ) by L1507
.= ( ( - ( Sum ( Infor_FinSeq_of C169 ) ) ) + ( Sum ( - ( mlt (C169 , ( LineSum ( Infor_FinSeq_of C170 ) )) ) ) ) ) by RVSUM_1:65
.= ( ( - ( Sum ( Infor_FinSeq_of C169 ) ) ) + ( - ( Sum ( mlt (C169 , ( LineSum ( Infor_FinSeq_of C170 ) )) ) ) ) ) by RVSUM_1:88;
L1557: ( Entropy_of_Joint_Prob D96 ) = ( - ( Sum ( Mx2FinS ( Infor_FinSeq_of D96 ) ) ) ) by L1425
.= ( - ( SumAll ( Infor_FinSeq_of D96 ) ) ) by L994
.= ( - ( ( Sum ( Infor_FinSeq_of C169 ) ) + ( Sum ( mlt (C169 , ( LineSum ( Infor_FinSeq_of C170 ) )) ) ) ) ) by L1555 , L1518
.= ( ( - ( Sum ( Infor_FinSeq_of C169 ) ) ) - ( Sum ( mlt (C169 , ( LineSum ( Infor_FinSeq_of C170 ) )) ) ) );
thus L1558: thesis by L1557 , L1556;
end;
