:: Minimization of finite state machines
::  by Miroslava Kaloper and Piotr Rudnicki
::
:: Received November 18, 1994
:: Copyright (c) 1994-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, SUBSET_1, NAT_1, ARYTM_3, XXREAL_0, CARD_1, XBOOLE_0,
      FUNCT_1, FUNCT_2, RELAT_1, EQREL_1, FINSET_1, CARD_3, SETFAM_1, TARSKI,
      STRUCT_0, ZFMISC_1, FINSEQ_1, ORDINAL4, FINSEQ_3, ARYTM_1, MCART_1,
      LATTICES, INT_1, RELAT_2, FUNCOP_1, FUNCT_4, FSM_1;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, CARD_1, NUMBERS, XCMPLX_0,
      ORDINAL1, NAT_1, INT_1, SETFAM_1, FINSET_1, STRUCT_0, XTUPLE_0, MCART_1,
      DOMAIN_1, RELAT_1, FUNCT_1, PARTFUN1, FUNCT_2, FUNCOP_1, BINOP_1,
      XXREAL_0, FUNCT_4, FINSEQ_1, FINSEQ_3, EQREL_1;
 constructors FUNCT_4, REAL_1, NAT_1, NAT_D, MEMBERED, FUNCOP_1, FINSEQ_3,
      BORSUK_1, BINOP_1, XTUPLE_0;
 registrations XBOOLE_0, SUBSET_1, FUNCT_1, PARTFUN1, FUNCT_2, FINSET_1,
      XXREAL_0, XREAL_0, NAT_1, INT_1, MEMBERED, EQREL_1, STRUCT_0, FINSEQ_1,
      CARD_1, RELSET_1, RELAT_1, XTUPLE_0;
 requirements NUMERALS, REAL, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, SETFAM_1, XBOOLE_0, BINOP_1, XTUPLE_0;
 theorems TARSKI, SUBSET_1, MCART_1, RELSET_1, NAT_1, INT_1, FINSEQ_1,
      FINSEQ_2, FINSEQ_3, FINSEQ_4, FUNCT_1, FUNCT_2, FUNCT_4, EQREL_1,
      ZFMISC_1, XBOOLE_0, XBOOLE_1, RELAT_1, XREAL_1, BINOP_1, XXREAL_0,
      ORDINAL1;
 schemes NAT_1, FUNCT_1, FUNCT_2, FINSEQ_1, RECDEF_1, EQREL_1, BINOP_1,
      CLASSES1;

begin
definition
let C1 being set;
struct (1-sorted) FSM over C1(# carrier -> set , Tran -> (Function of [: the carrier , C1 :] , the carrier) , InitS -> (Element of the carrier) #);
end;
definition
let C2 being set;
let C3 being FSM over C2;
mode State of C3
 is (Element of C3);
end;
registration
let C4 being set;
cluster non  empty  finite for FSM over C4;
existence
proof
set D1 = the non  empty  finite set;
set D2 = the (Function of [: D1 , C4 :] , D1);
set D3 = the (Element of D1);
take D4 = FSM (# D1 , D2 , D3 #);
thus L3: D4 is non  empty;
thus L4: thesis;
end;
end;
definition
let C5 being non  empty set;
let C6 being non  empty FSM over C5;
let C7 being (Element of C5);
let C8 being (State of C6);
func C7 -succ_of C8 -> (State of C6) equals 
( (the Tran of C6) . [ C8 , C7 ] );
correctness;
end;
definition
let C9 being non  empty set;
let C10 being non  empty FSM over C9;
let C11 being (State of C10);
let C12 being (FinSequence of C9);
func (C11 , C12) -admissible -> (FinSequence of (the carrier of C10)) means 
:L7: (( it . 1 ) = C11 & ( len it ) = ( ( len C12 ) + 1 ) & (for B1 being Nat holds ((1 <= B1 & B1 <= ( len C12 )) implies (ex B2 being (Element of C9) st (ex B3 , B4 being (State of C10) st (B2 = ( C12 . B1 ) & B3 = ( it . B1 ) & B4 = ( it . ( B1 + 1 ) ) & ( B2 -succ_of B3 ) = B4))))));
existence
proof
set D5 = ( ( len C12 ) + 1 );
set D6 = (the carrier of C10);
defpred S1[ (Element of ( NAT )) , set , set ] means (ex B5 being (Element of C9) st (ex B6 , B7 being (Element of D6) st (( C12 . $1 ) = B5 & B6 = $2 & B7 = $3 & ( B5 -succ_of B6 ) = B7)));
L8: (for B8 being (Element of ( NAT )) holds ((1 <= B8 & B8 < D5) implies (for B9 being (Element of D6) holds (ex B10 being (Element of D6) st S1[ B8 , B9 , B10 ]))))
proof
let C13 being (Element of ( NAT ));
assume L9: 1 <= C13;
assume L10: C13 < D5;
L11: C13 <= ( len C12 ) by L10 , NAT_1:13;
L12: C13 in ( dom C12 ) by L11 , L9 , FINSEQ_3:25;
reconsider D7 = ( C12 . C13 ) as (Element of C9) by L12 , FINSEQ_2:11;
let C14 being (Element of D6);
L13: ( D7 -succ_of C14 ) = ( (the Tran of C10) . [ C14 , D7 ] );
thus L14: thesis by L13;
end;
consider C15 being (FinSequence of D6) such that L15: (( len C15 ) = D5 & (( C15 . 1 ) = C11 or D5 = ( 0 )) & (for B11 being (Element of ( NAT )) holds ((1 <= B11 & B11 < D5) implies S1[ B11 , ( C15 . B11 ) , ( C15 . ( B11 + 1 ) ) ]))) from RECDEF_1:sch 4(L8);
take C15;
thus L16: ( C15 . 1 ) = C11 by L15;
thus L17: ( len C15 ) = ( ( len C12 ) + 1 ) by L15;
let C16 being Nat;
assume L18: 1 <= C16;
assume L19: C16 <= ( len C12 );
L20: (C16 in ( NAT ) & C16 < D5) by L19 , NAT_1:13 , ORDINAL1:def 12;
thus L21: thesis by L20 , L15 , L18;
end;
uniqueness
proof
let C17 , C18 being (FinSequence of (the carrier of C10));
assume that
L22: ( C17 . 1 ) = C11
and
L23: ( len C17 ) = ( ( len C12 ) + 1 )
and
L24: (for B12 being Nat holds ((1 <= B12 & B12 <= ( len C12 )) implies (ex B13 being (Element of C9) st (ex B14 , B15 being (State of C10) st (B13 = ( C12 . B12 ) & B14 = ( C17 . B12 ) & B15 = ( C17 . ( B12 + 1 ) ) & ( B13 -succ_of B14 ) = B15)))))
and
L25: ( C18 . 1 ) = C11
and
L26: ( len C18 ) = ( ( len C12 ) + 1 )
and
L27: (for B16 being Nat holds ((1 <= B16 & B16 <= ( len C12 )) implies (ex B17 being (Element of C9) st (ex B18 , B19 being (State of C10) st (B17 = ( C12 . B16 ) & B18 = ( C18 . B16 ) & B19 = ( C18 . ( B16 + 1 ) ) & ( B17 -succ_of B18 ) = B19)))));
defpred S2[ Nat ] means ((1 <= $1 & $1 <= ( len C17 )) implies ( C17 . $1 ) = ( C18 . $1 ));
L28:
now
let C19 being Nat;
assume L29: S2[ C19 ];
thus L30: S2[ ( C19 + 1 ) ]
proof
assume that
L31: 1 <= ( C19 + 1 )
and
L32: ( C19 + 1 ) <= ( len C17 );
L33: (( 0 ) = C19 or (( 0 ) < C19 & ( ( 0 ) + 1 ) = 1));
per cases  by L33 , NAT_1:13;
suppose L34: ( 0 ) = C19;

thus L35: thesis by L34 , L22 , L25;
end;
suppose L36: 1 <= C19;

L37: C19 <= ( len C12 ) by L23 , L32 , XREAL_1:6;
L38: ((ex B20 being (Element of C9) st (ex B21 , B22 being (State of C10) st (B20 = ( C12 . C19 ) & B21 = ( C17 . C19 ) & B22 = ( C17 . ( C19 + 1 ) ) & ( B20 -succ_of B21 ) = B22))) & (ex B23 being (Element of C9) st (ex B24 , B25 being (State of C10) st (B23 = ( C12 . C19 ) & B24 = ( C18 . C19 ) & B25 = ( C18 . ( C19 + 1 ) ) & ( B23 -succ_of B24 ) = B25)))) by L37 , L24 , L27 , L36;
thus L39: thesis by L38 , L23 , L29 , L36 , L37 , NAT_1:12;
end;
end;

end;
L31: S2[ ( 0 ) ];
L32: (for B26 being Nat holds S2[ B26 ]) from NAT_1:sch 2(L31 , L28);
thus L33: thesis by L32 , L23 , L26 , FINSEQ_1:14;
end;
end;
theorem
L35: (for R5 being non  empty set holds (for R7 being non  empty FSM over R5 holds (for R12 being (State of R7) holds ( (R12 , ( <*> R5 )) -admissible ) = <* R12 *>)))
proof
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R12 being (State of R7);
set D8 = ( <*> R5 );
L36: (for B27 being Nat holds ((1 <= B27 & B27 <= ( len D8 )) implies (ex B28 being (Element of R5) st (ex B29 , B30 being (State of R7) st (B28 = ( D8 . B27 ) & B29 = ( <* R12 *> . B27 ) & B30 = ( <* R12 *> . ( B27 + 1 ) ) & ( B28 -succ_of B29 ) = B30)))));
L37: (( len <* R12 *> ) = ( ( len D8 ) + 1 ) & ( <* R12 *> . 1 ) = R12) by FINSEQ_1:40;
thus L38: thesis by L37 , L36 , L7;
end;
definition
let C20 being non  empty set;
let C21 being non  empty FSM over C20;
let C22 being (FinSequence of C20);
let C23 , C24 being (State of C21);
pred C23 , C22 -leads_to C24
means
:L39: ( ( (C23 , C22) -admissible ) . ( ( len C22 ) + 1 ) ) = C24
;end;
theorem
L41: (for R5 being non  empty set holds (for R7 being non  empty FSM over R5 holds (for R12 being (State of R7) holds R12 , ( <*> R5 ) -leads_to R12)))
proof
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R12 being (State of R7);
set D9 = ( <*> R5 );
L42: ( <* R12 *> . ( ( len D9 ) + 1 ) ) = ( <* R12 *> . ( ( 0 ) + 1 ) )
.= R12 by FINSEQ_1:40;
L43: ( (R12 , D9) -admissible ) = <* R12 *> by L35;
thus L44: thesis by L43 , L42 , L39;
end;
definition
let C25 being non  empty set;
let C26 being non  empty FSM over C25;
let C27 being (FinSequence of C25);
let C28 being (FinSequence of (the carrier of C26));
pred C28 is_admissible_for C27
means
:L45: (ex B31 being (State of C26) st (B31 = ( C28 . 1 ) & ( (B31 , C27) -admissible ) = C28))
;end;
theorem
L47: (for R5 being non  empty set holds (for R7 being non  empty FSM over R5 holds (for R12 being (State of R7) holds <* R12 *> is_admissible_for ( <*> R5 ))))
proof
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R12 being (State of R7);
L48: (( (R12 , ( <*> R5 )) -admissible ) = <* R12 *> & R12 = ( <* R12 *> . 1 )) by L35 , FINSEQ_1:40;
thus L49: thesis by L48 , L45;
end;
definition
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R12 being (State of R7);
let R9 being (FinSequence of R5);
func R12 leads_to_under R9 -> (State of R7) means 
:L50: R12 , R9 -leads_to it;
existence
proof
L51: (( len ( (R12 , R9) -admissible ) ) = ( ( len R9 ) + 1 ) & ( ( len R9 ) + 1 ) in ( Seg ( ( len R9 ) + 1 ) )) by L7 , FINSEQ_1:4;
L52: ( ( len R9 ) + 1 ) in ( dom ( (R12 , R9) -admissible ) ) by L51 , FINSEQ_1:def 3;
reconsider D10 = ( ( (R12 , R9) -admissible ) . ( ( len R9 ) + 1 ) ) as (Element of R7) by L52 , FINSEQ_2:11;
take D10;
thus L53: thesis by L39;
end;
uniqueness
proof
let C29 , C30 being (Element of R7);
assume that
L54: R12 , R9 -leads_to C29
and
L55: R12 , R9 -leads_to C30;
L56: ( ( (R12 , R9) -admissible ) . ( ( len R9 ) + 1 ) ) = C29 by L54 , L39;
thus L57: thesis by L56 , L55 , L39;
end;
end;
theorem
L59: (for R5 being non  empty set holds (for R7 being non  empty FSM over R5 holds (for R9 being (FinSequence of R5) holds (for R12 being (State of R7) holds (for R13 being (State of R7) holds (( ( (R12 , R9) -admissible ) . ( len ( (R12 , R9) -admissible ) ) ) = R13 iff R12 , R9 -leads_to R13))))))
proof
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R9 being (FinSequence of R5);
let R12 being (State of R7);
let R13 being (State of R7);
thus L60:now
set D11 = ( (R12 , R9) -admissible );
assume L61: ( D11 . ( len D11 ) ) = R13;
L62: ( len D11 ) = ( ( len R9 ) + 1 ) by L7;
thus L63: R12 , R9 -leads_to R13 by L62 , L61 , L39;
end;
assume L64: R12 , R9 -leads_to R13;
L65: ( ( (R12 , R9) -admissible ) . ( ( len R9 ) + 1 ) ) = R13 by L64 , L39;
thus L66: thesis by L65 , L7;
end;
theorem
L67: (for R5 being non  empty set holds (for R7 being non  empty FSM over R5 holds (for R10 being (FinSequence of R5) holds (for R11 being (FinSequence of R5) holds (for R14 being (State of R7) holds (for R4 being (Element of ( NAT )) holds ((1 <= R4 & R4 <= ( len R10 )) implies ( ( (R14 , ( R10 ^ R11 )) -admissible ) . R4 ) = ( ( (R14 , R10) -admissible ) . R4 ))))))))
proof
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R10 being (FinSequence of R5);
let R11 being (FinSequence of R5);
let R14 being (State of R7);
set D12 = ( (R14 , ( R10 ^ R11 )) -admissible );
set D13 = ( (R14 , R10) -admissible );
defpred S3[ (Element of ( NAT )) ] means ((1 <= $1 & $1 <= ( len R10 )) implies ( D12 . $1 ) = ( D13 . $1 ));
L68:
now
let C31 being (Element of ( NAT ));
assume L69: S3[ C31 ];
thus L70: S3[ ( C31 + 1 ) ]
proof
assume that
L71: 1 <= ( C31 + 1 )
and
L72: ( C31 + 1 ) <= ( len R10 );
L73: (( 0 ) = C31 or (( 0 ) < C31 & ( ( 0 ) + 1 ) = 1));
per cases  by L72 , L73 , NAT_1:13;
suppose L74: C31 = ( 0 );

thus L75: ( D12 . ( C31 + 1 ) ) = R14 by L74 , L7
.= ( D13 . ( C31 + 1 ) ) by L74 , L7;
end;
suppose L76: (1 <= C31 & C31 <= ( len R10 ));

L77: ( len R10 ) <= ( ( len R10 ) + ( len R11 ) ) by NAT_1:11;
L78: C31 <= ( ( len R10 ) + ( len R11 ) ) by L77 , L76 , XXREAL_0:2;
L79: C31 <= ( len ( R10 ^ R11 ) ) by L78 , FINSEQ_1:22;
L80: (ex B32 being (Element of R5) st (ex B33 , B34 being (State of R7) st (B32 = ( ( R10 ^ R11 ) . C31 ) & B33 = ( D12 . C31 ) & B34 = ( D12 . ( C31 + 1 ) ) & ( B32 -succ_of B33 ) = B34))) by L79 , L76 , L7;
L81: ((ex B35 being (Element of R5) st (ex B36 , B37 being (State of R7) st (B35 = ( R10 . C31 ) & B36 = ( D13 . C31 ) & B37 = ( D13 . ( C31 + 1 ) ) & ( B35 -succ_of B36 ) = B37))) & C31 in ( dom R10 )) by L76 , L7 , FINSEQ_3:25;
thus L82: thesis by L81 , L69 , L76 , L80 , FINSEQ_1:def 7;
end;
end;

end;
L71: S3[ ( 0 ) ];
thus L72: (for B38 being (Element of ( NAT )) holds S3[ B38 ]) from NAT_1:sch 1(L71 , L68);
end;
theorem
L73: (for R5 being non  empty set holds (for R7 being non  empty FSM over R5 holds (for R10 being (FinSequence of R5) holds (for R11 being (FinSequence of R5) holds (for R14 being (State of R7) holds (for R15 being (State of R7) holds (R14 , R10 -leads_to R15 implies ( ( (R14 , ( R10 ^ R11 )) -admissible ) . ( ( len R10 ) + 1 ) ) = R15)))))))
proof
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R10 being (FinSequence of R5);
let R11 being (FinSequence of R5);
let R14 being (State of R7);
let R15 being (State of R7);
assume L74: R14 , R10 -leads_to R15;
set D14 = ( (R14 , R10) -admissible );
set D15 = ( (R14 , ( R10 ^ R11 )) -admissible );
per cases ;
suppose L75: ( len R10 ) = ( 0 );

L76: (( D14 . 1 ) = R14 & ( D14 . ( ( len R10 ) + 1 ) ) = R15) by L74 , L7 , L39;
thus L77: thesis by L76 , L75 , L7;
end;
suppose L78: ( len R10 ) > ( 0 );

L79: ( len D14 ) = ( ( len R10 ) + 1 ) by L7;
L80: ( ( 0 ) + 1 ) = 1;
L81: 1 <= ( len R10 ) by L80 , L78 , NAT_1:13;
consider C32 being (Element of R5), C33 , C34 being (State of R7) such that L82: C32 = ( R10 . ( len R10 ) ) and L83: C33 = ( D14 . ( len R10 ) ) and L84: C34 = ( D14 . ( ( len R10 ) + 1 ) ) and L85: ( C32 -succ_of C33 ) = C34 by L81 , L7;
L86: ( len ( R10 ^ R11 ) ) = ( ( len R10 ) + ( len R11 ) ) by FINSEQ_1:22;
L87: ( len R10 ) <= ( len ( R10 ^ R11 ) ) by L86 , NAT_1:12;
consider C35 being (Element of R5), C36 , C37 being (State of R7) such that L88: C35 = ( ( R10 ^ R11 ) . ( len R10 ) ) and L89: (C36 = ( D15 . ( len R10 ) ) & C37 = ( D15 . ( ( len R10 ) + 1 ) ) & ( C35 -succ_of C36 ) = C37) by L87 , L81 , L7;
L90: ( len R10 ) in ( Seg ( len R10 ) ) by L78 , FINSEQ_1:3;
L91: ( len R10 ) in ( dom R10 ) by L90 , FINSEQ_1:def 3;
L92: C35 = C32 by L91 , L88 , L82 , FINSEQ_1:def 7;
thus L93: ( ( (R14 , ( R10 ^ R11 )) -admissible ) . ( ( len R10 ) + 1 ) ) = C34 by L92 , L81 , L89 , L83 , L85 , L67
.= R15 by L74 , L84 , L79 , L59;
end;
end;
theorem
L95: (for R5 being non  empty set holds (for R7 being non  empty FSM over R5 holds (for R10 being (FinSequence of R5) holds (for R11 being (FinSequence of R5) holds (for R14 being (State of R7) holds (for R15 being (State of R7) holds (R14 , R10 -leads_to R15 implies (for R4 being (Element of ( NAT )) holds ((1 <= R4 & R4 <= ( ( len R11 ) + 1 )) implies ( ( (R14 , ( R10 ^ R11 )) -admissible ) . ( ( len R10 ) + R4 ) ) = ( ( (R15 , R11) -admissible ) . R4 ))))))))))
proof
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R10 being (FinSequence of R5);
let R11 being (FinSequence of R5);
let R14 being (State of R7);
let R15 being (State of R7);
set D16 = ( (R14 , ( R10 ^ R11 )) -admissible );
set D17 = ( (R15 , R11) -admissible );
defpred S4[ (Element of ( NAT )) ] means ((1 <= $1 & $1 <= ( ( len R11 ) + 1 )) implies ( D16 . ( ( len R10 ) + $1 ) ) = ( D17 . $1 ));
assume L96: R14 , R10 -leads_to R15;
L97: (for B39 being (Element of ( NAT )) holds (S4[ B39 ] implies S4[ ( B39 + 1 ) ]))
proof
let C38 being (Element of ( NAT ));
assume L98: ((1 <= C38 & C38 <= ( ( len R11 ) + 1 )) implies ( D16 . ( ( len R10 ) + C38 ) ) = ( D17 . C38 ));
assume that
L99: 1 <= ( C38 + 1 )
and
L100: ( C38 + 1 ) <= ( ( len R11 ) + 1 );
per cases ;
suppose L101: C38 = ( 0 );

thus L102: ( D16 . ( ( len R10 ) + ( C38 + 1 ) ) ) = R15 by L101 , L96 , L73
.= ( D17 . ( C38 + 1 ) ) by L101 , L7;
end;
suppose L103: ( 0 ) < C38;

L104: C38 <= ( len R11 ) by L100 , XREAL_1:6;
L105: ( ( 0 ) + 1 ) = 1;
L106: 1 <= C38 by L105 , L103 , NAT_1:13;
L107: ((ex B40 being (Element of R5) st (ex B41 , B42 being (State of R7) st (B40 = ( R11 . C38 ) & B41 = ( D17 . C38 ) & B42 = ( D17 . ( C38 + 1 ) ) & ( B40 -succ_of B41 ) = B42))) & C38 in ( dom R11 )) by L106 , L104 , L7 , FINSEQ_3:25;
L108: ( len ( R10 ^ R11 ) ) = ( ( len R10 ) + ( len R11 ) ) by FINSEQ_1:22;
L109: ( ( len R10 ) + C38 ) <= ( len ( R10 ^ R11 ) ) by L108 , L104 , XREAL_1:7;
L110: 1 <= ( ( len R10 ) + C38 ) by L103 , L105 , NAT_1:13;
L111: (ex B43 being (Element of R5) st (ex B44 , B45 being (State of R7) st (B43 = ( ( R10 ^ R11 ) . ( ( len R10 ) + C38 ) ) & B44 = ( D16 . ( ( len R10 ) + C38 ) ) & B45 = ( D16 . ( ( ( len R10 ) + C38 ) + 1 ) ) & ( B43 -succ_of B44 ) = B45))) by L110 , L109 , L7;
thus L112: thesis by L111 , L98 , L100 , L103 , L105 , L107 , FINSEQ_1:def 7 , NAT_1:13;
end;
end;
L114: S4[ ( 0 ) ];
thus L115: (for B46 being (Element of ( NAT )) holds S4[ B46 ]) from NAT_1:sch 1(L114 , L97);
end;
theorem
L116: (for R5 being non  empty set holds (for R7 being non  empty FSM over R5 holds (for R10 being (FinSequence of R5) holds (for R11 being (FinSequence of R5) holds (for R14 being (State of R7) holds (for R15 being (State of R7) holds (R14 , R10 -leads_to R15 implies ( (R14 , ( R10 ^ R11 )) -admissible ) = ( ( Del (( (R14 , R10) -admissible ) , ( ( len R10 ) + 1 )) ) ^ ( (R15 , R11) -admissible ) ))))))))
proof
let R5 being non  empty set;
let R7 being non  empty FSM over R5;
let R10 being (FinSequence of R5);
let R11 being (FinSequence of R5);
let R14 being (State of R7);
let R15 being (State of R7);
set D18 = ( (R14 , ( R10 ^ R11 )) -admissible );
set D19 = ( (R14 , R10) -admissible );
set D20 = ( (R15 , R11) -admissible );
set D21 = ( Del (( (R14 , R10) -admissible ) , ( ( len R10 ) + 1 )) );
L117: ( len D19 ) = ( ( len R10 ) + 1 ) by L7;
L118: (( len D19 ) = ( ( len R10 ) + 1 ) & ( dom D19 ) = ( Seg ( len D19 ) )) by L7 , FINSEQ_1:def 3;
L119: ( ( len R10 ) + 1 ) in ( dom D19 ) by L118 , FINSEQ_1:3;
L120: (ex B47 being Nat st (( len D19 ) = ( B47 + 1 ) & ( len D21 ) = B47)) by L119 , FINSEQ_3:104;
L121: ( len D18 ) = ( ( len ( R10 ^ R11 ) ) + 1 ) by L7
.= ( ( ( len R10 ) + ( len R11 ) ) + 1 ) by FINSEQ_1:22
.= ( ( len D21 ) + ( ( len R11 ) + 1 ) ) by L120 , L117
.= ( ( len D21 ) + ( len D20 ) ) by L7
.= ( len ( D21 ^ D20 ) ) by FINSEQ_1:22;
assume L122: R14 , R10 -leads_to R15;
L123:
now
let C39 being Nat;
assume L124: (1 <= C39 & C39 <= ( len D18 ));
per cases  by L124 , NAT_1:13;
suppose L125: (1 <= C39 & C39 <= ( len R10 ));

L126: C39 < ( ( len R10 ) + 1 ) by L125 , NAT_1:13;
L127: C39 in ( dom D21 ) by L120 , L117 , L125 , FINSEQ_3:25;
L128: C39 in ( NAT ) by ORDINAL1:def 12;
thus L129: ( D18 . C39 ) = ( D19 . C39 ) by L128 , L125 , L67
.= ( D21 . C39 ) by L126 , FINSEQ_3:110
.= ( ( D21 ^ D20 ) . C39 ) by L127 , FINSEQ_1:def 7;
end;
suppose L130: (( ( len R10 ) + 1 ) <= C39 & C39 <= ( len D18 ));

L131: C39 <= ( ( len D21 ) + ( len D20 ) ) by L130 , L121 , FINSEQ_1:22;
L132: ( ( D21 ^ D20 ) . C39 ) = ( D20 . ( C39 - ( len R10 ) ) ) by L131 , L120 , L117 , L130 , FINSEQ_1:23;
L133: ( ( ( len R10 ) + 1 ) - ( len R10 ) ) <= ( C39 - ( len R10 ) ) by L130 , XREAL_1:9;
reconsider D22 = ( C39 - ( len R10 ) ) as (Element of ( NAT )) by L133 , INT_1:3;
L134: C39 = ( ( len R10 ) + D22 );
L135: ( len D18 ) = ( ( len ( R10 ^ R11 ) ) + 1 ) by L7;
L136: C39 <= ( ( ( len R10 ) + ( len R11 ) ) + 1 ) by L135 , L130 , FINSEQ_1:22;
L137: C39 <= ( ( len R10 ) + ( ( len R11 ) + 1 ) ) by L136;
L138: D22 <= ( ( len R11 ) + 1 ) by L137 , L134 , XREAL_1:6;
L139: 1 <= D22 by L130 , L134 , XREAL_1:6;
thus L140: ( D18 . C39 ) = ( ( D21 ^ D20 ) . C39 ) by L139 , L122 , L134 , L138 , L132 , L95;
end;
end;
thus L142: thesis by L123 , L121 , FINSEQ_1:14;
end;
begin
definition
let C40 being set;
let C41 being non  empty set;
struct (FSM over C40) Mealy-FSM over C40 , C41(# carrier -> set , Tran -> (Function of [: the carrier , C40 :] , the carrier) , OFun -> (Function of [: the carrier , C40 :] , C41) , InitS -> (Element of the carrier) #);
struct (FSM over C40) Moore-FSM over C40 , C41(# carrier -> set , Tran -> (Function of [: the carrier , C40 :] , the carrier) , OFun -> (Function of the carrier , C41) , InitS -> (Element of the carrier) #);
end;
registration
let C42 being set;
let C43 being  finite non  empty set;
let C44 being (Function of [: C43 , C42 :] , C43);
let C45 being (Element of C43);
cluster FSM (# C43 , C44 , C45 #) ->  finite non  empty;
coherence;
end;
registration
let C46 being set;
let C47 being non  empty set;
let C48 being  finite non  empty set;
let C49 being (Function of [: C48 , C46 :] , C48);
let C50 being (Function of [: C48 , C46 :] , C47);
let C51 being (Element of C48);
cluster Mealy-FSM (# C48 , C49 , C50 , C51 #) ->  finite non  empty;
coherence;
end;
registration
let C52 being set;
let C53 being non  empty set;
let C54 being  finite non  empty set;
let C55 being (Function of [: C54 , C52 :] , C54);
let C56 being (Function of C54 , C53);
let C57 being (Element of C54);
cluster Moore-FSM (# C54 , C55 , C56 , C57 #) ->  finite non  empty;
coherence;
end;
registration
let C58 being set;
let C59 being non  empty set;
cluster  finite non  empty for Mealy-FSM over C58 , C59;
existence
proof
set D23 = the  finite non  empty set;
set D24 = the (Function of [: D23 , C58 :] , D23);
set D25 = the (Function of [: D23 , C58 :] , C59);
set D26 = the (Element of D23);
take Mealy-FSM (# D23 , D24 , D25 , D26 #);
thus L147: thesis;
end;
cluster  finite non  empty for Moore-FSM over C58 , C59;
existence
proof
set D27 = the  finite non  empty set;
set D28 = the (Function of [: D27 , C58 :] , D27);
set D29 = the (Function of D27 , C59);
set D30 = the (Element of D27);
take Moore-FSM (# D27 , D28 , D29 , D30 #);
thus L148: thesis;
end;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R30 being (State of R16);
let R9 being (FinSequence of R5);
func (R30 , R9) -response -> (FinSequence of R6) means 
:L150: (( len it ) = ( len R9 ) & (for R3 being (Element of ( NAT )) holds (R3 in ( dom R9 ) implies ( it . R3 ) = ( (the OFun of R16) . [ ( ( (R30 , R9) -admissible ) . R3 ) , ( R9 . R3 ) ] ))));
existence
proof
set D31 = ( (R30 , R9) -admissible );
deffunc H1(Nat) = ( (the OFun of R16) . [ ( D31 . $1 ) , ( R9 . $1 ) ] );
consider C60 being FinSequence such that L151: (( len C60 ) = ( len R9 ) & (for B48 being Nat holds (B48 in ( dom C60 ) implies ( C60 . B48 ) = H1(B48)))) from FINSEQ_1:sch 2;
L152: ( Seg ( len R9 ) ) = ( dom R9 ) by FINSEQ_1:def 3;
L153: ( rng C60 ) c= R6
proof
let C61 being set;
assume L154: C61 in ( rng C60 );
consider C62 being set such that L155: C62 in ( dom C60 ) and L156: C61 = ( C60 . C62 ) by L154 , FUNCT_1:def 3;
reconsider D32 = C62 as (Element of ( NAT )) by L155;
L157: D32 <= ( len C60 ) by L155 , FINSEQ_3:25;
L158: D32 <= ( ( len C60 ) + 1 ) by L157 , NAT_1:12;
L159: ( len D31 ) = ( ( len C60 ) + 1 ) by L151 , L7;
L160: ( dom C60 ) = ( Seg ( len C60 ) ) by FINSEQ_1:def 3;
reconsider D33 = ( R9 . D32 ) as (Element of R5) by L160 , L152 , L151 , L155 , FINSEQ_2:11;
L161: 1 <= D32 by L155 , FINSEQ_3:25;
L162: D32 in ( dom D31 ) by L161 , L159 , L158 , FINSEQ_3:25;
reconsider D34 = ( D31 . D32 ) as (Element of R16) by L162 , FINSEQ_2:11;
L163: ( C60 . D32 ) = ( (the OFun of R16) . [ D34 , D33 ] ) by L151 , L155;
thus L164: thesis by L163 , L156;
end;
reconsider D35 = C60 as (FinSequence of R6) by L153 , FINSEQ_1:def 4;
L165: ( dom C60 ) = ( dom R9 ) by L151 , FINSEQ_3:29;
L166: (for B49 being (Element of ( NAT )) holds (B49 in ( dom R9 ) implies ( D35 . B49 ) = ( (the OFun of R16) . [ ( D31 . B49 ) , ( R9 . B49 ) ] ))) by L165 , L151;
thus L167: thesis by L166 , L151;
end;
uniqueness
proof
let C63 , C64 being (FinSequence of R6);
set D36 = ( (R30 , R9) -admissible );
assume that
L168: ( len C63 ) = ( len R9 )
and
L169: (for B50 being (Element of ( NAT )) holds (B50 in ( dom R9 ) implies ( C63 . B50 ) = ( (the OFun of R16) . [ ( D36 . B50 ) , ( R9 . B50 ) ] )));
assume that
L170: ( len C64 ) = ( len R9 )
and
L171: (for B51 being (Element of ( NAT )) holds (B51 in ( dom R9 ) implies ( C64 . B51 ) = ( (the OFun of R16) . [ ( D36 . B51 ) , ( R9 . B51 ) ] )));
L172: ( dom R9 ) = ( dom C63 ) by L168 , FINSEQ_3:29;
L173:
now
thus L174: ( len C63 ) = ( len C64 ) by L168 , L170;
let C65 being Nat;
assume L175: (1 <= C65 & C65 <= ( len C63 ));
L176: C65 in ( dom C63 ) by L175 , FINSEQ_3:25;
L177: ( C63 . C65 ) = ( (the OFun of R16) . [ ( D36 . C65 ) , ( R9 . C65 ) ] ) by L176 , L169 , L172;
thus L178: ( C63 . C65 ) = ( C64 . C65 ) by L177 , L171 , L172 , L176;
end;
thus L179: thesis by L173 , FINSEQ_1:14;
end;
end;
theorem
L181: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R30 being (State of R16) holds ( (R30 , ( <*> R5 )) -response ) = ( <*> R6 )))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R30 being (State of R16);
L182: ( len ( (R30 , ( <*> R5 )) -response ) ) = ( len ( <*> R5 ) ) by L150
.= ( 0 );
thus L183: thesis by L182;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let R20 being non  empty Moore-FSM over R5 , R6;
let R21 being (State of R20);
let R9 being (FinSequence of R5);
func (R21 , R9) -response -> (FinSequence of R6) means 
:L184: (( len it ) = ( ( len R9 ) + 1 ) & (for R3 being (Element of ( NAT )) holds (R3 in ( Seg ( ( len R9 ) + 1 ) ) implies ( it . R3 ) = ( (the OFun of R20) . ( ( (R21 , R9) -admissible ) . R3 ) ))));
existence
proof
set D37 = ( (R21 , R9) -admissible );
deffunc H2(Nat) = ( (the OFun of R20) . ( D37 . $1 ) );
consider C66 being FinSequence such that L185: (( len C66 ) = ( len D37 ) & (for B52 being Nat holds (B52 in ( dom C66 ) implies ( C66 . B52 ) = H2(B52)))) from FINSEQ_1:sch 2;
L186: ( Seg ( len D37 ) ) = ( dom D37 ) by FINSEQ_1:def 3;
L187: ( rng C66 ) c= R6
proof
let C67 being set;
assume L188: C67 in ( rng C66 );
consider C68 being set such that L189: C68 in ( dom C66 ) and L190: C67 = ( C66 . C68 ) by L188 , FUNCT_1:def 3;
reconsider D38 = C68 as (Element of ( NAT )) by L189;
L191: ( dom C66 ) = ( Seg ( len C66 ) ) by FINSEQ_1:def 3;
reconsider D39 = ( D37 . D38 ) as (State of R20) by L191 , L186 , L185 , L189 , FINSEQ_2:11;
L192: ( C66 . D38 ) = ( (the OFun of R20) . D39 ) by L185 , L189;
thus L193: thesis by L192 , L190;
end;
reconsider D40 = C66 as (FinSequence of R6) by L187 , FINSEQ_1:def 4;
L194: ( len D37 ) = ( ( len R9 ) + 1 ) by L7;
L195: ( dom C66 ) = ( dom D37 ) by L185 , FINSEQ_3:29;
L196: (for B53 being (Element of ( NAT )) holds (B53 in ( dom D37 ) implies ( D40 . B53 ) = ( (the OFun of R20) . ( D37 . B53 ) ))) by L195 , L185;
thus L197: thesis by L196 , L186 , L185 , L194;
end;
uniqueness
proof
let C69 , C70 being (FinSequence of R6);
set D41 = ( (R21 , R9) -admissible );
assume that
L198: ( len C69 ) = ( ( len R9 ) + 1 )
and
L199: (for B54 being (Element of ( NAT )) holds (B54 in ( Seg ( ( len R9 ) + 1 ) ) implies ( C69 . B54 ) = ( (the OFun of R20) . ( D41 . B54 ) )));
assume that
L200: ( len C70 ) = ( ( len R9 ) + 1 )
and
L201: (for B55 being (Element of ( NAT )) holds (B55 in ( Seg ( ( len R9 ) + 1 ) ) implies ( C70 . B55 ) = ( (the OFun of R20) . ( D41 . B55 ) )));
L202:
now
thus L203: ( len C69 ) = ( len C70 ) by L198 , L200;
let C71 being Nat;
assume L204: (1 <= C71 & C71 <= ( len C69 ));
L205: C71 in ( Seg ( len C69 ) ) by L204 , FINSEQ_1:1;
L206: ( C69 . C71 ) = ( (the OFun of R20) . ( D41 . C71 ) ) by L205 , L198 , L199;
thus L207: ( C69 . C71 ) = ( C70 . C71 ) by L206 , L198 , L201 , L205;
end;
thus L208: thesis by L202 , FINSEQ_1:14;
end;
end;
theorem
L210: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R9 being (FinSequence of R5) holds (for R20 being non  empty Moore-FSM over R5 , R6 holds (for R21 being (State of R20) holds ( ( (R21 , R9) -response ) . 1 ) = ( (the OFun of R20) . R21 ))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R9 being (FinSequence of R5);
let R20 being non  empty Moore-FSM over R5 , R6;
let R21 being (State of R20);
L211: 1 <= ( ( len R9 ) + 1 ) by NAT_1:12;
L212: 1 in ( Seg ( ( len R9 ) + 1 ) ) by L211 , FINSEQ_1:1;
thus L213: ( ( (R21 , R9) -response ) . 1 ) = ( (the OFun of R20) . ( ( (R21 , R9) -admissible ) . 1 ) ) by L212 , L184
.= ( (the OFun of R20) . R21 ) by L7;
end;
theorem
L214: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R10 being (FinSequence of R5) holds (for R11 being (FinSequence of R5) holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R31 being (State of R16) holds (for R32 being (State of R16) holds (R31 , R10 -leads_to R32 implies ( (R31 , ( R10 ^ R11 )) -response ) = ( ( (R31 , R10) -response ) ^ ( (R32 , R11) -response ) )))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R10 being (FinSequence of R5);
let R11 being (FinSequence of R5);
let R16 being non  empty Mealy-FSM over R5 , R6;
let R31 being (State of R16);
let R32 being (State of R16);
set D42 = ( (R31 , R10) -response );
set D43 = ( (R32 , R11) -response );
set D44 = ( (R31 , ( R10 ^ R11 )) -response );
set D45 = ( Del (( (R31 , R10) -admissible ) , ( ( len R10 ) + 1 )) );
set D46 = (the OFun of R16);
assume L215: R31 , R10 -leads_to R32;
L216:
now
L217: ( dom ( (R31 , R10) -admissible ) ) = ( Seg ( len ( (R31 , R10) -admissible ) ) ) by FINSEQ_1:def 3;
L218: ( dom ( (R31 , R10) -admissible ) ) = ( Seg ( ( len R10 ) + 1 ) ) by L217 , L7;
L219: ( ( len R10 ) + 1 ) in ( dom ( (R31 , R10) -admissible ) ) by L218 , FINSEQ_1:3;
consider C72 being Nat such that L220: ( len ( (R31 , R10) -admissible ) ) = ( C72 + 1 ) and L221: ( len D45 ) = C72 by L219 , FINSEQ_3:104;
L222: ( C72 + 1 ) = ( ( len R10 ) + 1 ) by L220 , L7;
L223: ( len D42 ) = ( len R10 ) by L150;
let C73 being Nat;
assume that
L224: 1 <= C73
and
L225: C73 <= ( len D44 );
per cases  by L224 , L225 , NAT_1:13;
suppose L226: (1 <= C73 & C73 <= ( len D42 ));

L227: C73 <= ( len R10 ) by L226 , L150;
L228: C73 in ( dom R10 ) by L227 , L226 , FINSEQ_3:25;
L229: C73 in ( dom D45 ) by L221 , L222 , L226 , L227 , FINSEQ_3:25;
L230: C73 < ( ( len R10 ) + 1 ) by L227 , NAT_1:13;
L231: C73 in ( dom D42 ) by L226 , FINSEQ_3:25;
L232: C73 <= ( len ( R10 ^ R11 ) ) by L225 , L150;
L233: C73 in ( dom ( R10 ^ R11 ) ) by L232 , L224 , FINSEQ_3:25;
thus L234: ( D44 . C73 ) = ( D46 . [ ( ( (R31 , ( R10 ^ R11 )) -admissible ) . C73 ) , ( ( R10 ^ R11 ) . C73 ) ] ) by L233 , L150
.= ( D46 . [ ( ( D45 ^ ( (R32 , R11) -admissible ) ) . C73 ) , ( ( R10 ^ R11 ) . C73 ) ] ) by L215 , L116
.= ( D46 . [ ( D45 . C73 ) , ( ( R10 ^ R11 ) . C73 ) ] ) by L229 , FINSEQ_1:def 7
.= ( D46 . [ ( D45 . C73 ) , ( R10 . C73 ) ] ) by L228 , FINSEQ_1:def 7
.= ( D46 . [ ( ( (R31 , R10) -admissible ) . C73 ) , ( R10 . C73 ) ] ) by L230 , FINSEQ_3:110
.= ( ( (R31 , R10) -response ) . C73 ) by L228 , L150
.= ( ( ( (R31 , R10) -response ) ^ ( (R32 , R11) -response ) ) . C73 ) by L231 , FINSEQ_1:def 7;
end;
suppose L235: (( ( len D42 ) + 1 ) <= C73 & C73 <= ( len D44 ));

L236: ( ( ( len D42 ) + 1 ) - ( len D42 ) ) <= ( C73 - ( len D42 ) ) by L235 , XREAL_1:9;
reconsider D47 = ( C73 - ( len D42 ) ) as (Element of ( NAT )) by L236 , INT_1:3;
L237: ( len D44 ) = ( len ( R10 ^ R11 ) ) by L150
.= ( ( len R10 ) + ( len R11 ) ) by FINSEQ_1:22;
L238: C73 <= ( ( len D42 ) + ( len R11 ) ) by L237 , L235 , L150;
L239: ( C73 - ( len D42 ) ) <= ( ( ( len D42 ) + ( len R11 ) ) - ( len D42 ) ) by L238 , XREAL_1:9;
L240: D47 in ( dom R11 ) by L239 , L236 , FINSEQ_3:25;
L241: ( ( len D45 ) + 1 ) <= C73 by L221 , L222 , L235 , L150;
L242: ( ( len R10 ) + 1 ) <= C73 by L235 , L150;
L243: ( len D44 ) = ( len ( R10 ^ R11 ) ) by L150
.= ( ( len R10 ) + ( len R11 ) ) by FINSEQ_1:22
.= ( ( len D42 ) + ( len R11 ) ) by L150
.= ( ( len D42 ) + ( len D43 ) ) by L150;
L244: ( ( D42 ^ D43 ) . C73 ) = ( ( (R32 , R11) -response ) . D47 ) by L243 , L235 , FINSEQ_1:23
.= ( D46 . [ ( ( (R32 , R11) -admissible ) . D47 ) , ( R11 . D47 ) ] ) by L240 , L150
.= ( D46 . [ ( ( (R32 , R11) -admissible ) . ( C73 - ( len R10 ) ) ) , ( R11 . ( C73 - ( len D42 ) ) ) ] ) by L150
.= ( D46 . [ ( ( (R32 , R11) -admissible ) . ( C73 - ( len R10 ) ) ) , ( R11 . ( C73 - ( len R10 ) ) ) ] ) by L150;
L245: ( len R11 ) <= ( ( len R11 ) + 1 ) by NAT_1:11;
L246: ( ( len D45 ) + ( len R11 ) ) <= ( ( len D45 ) + ( ( len R11 ) + 1 ) ) by L245 , XREAL_1:6;
L247: C73 <= ( ( len D45 ) + ( len R11 ) ) by L221 , L222 , L223 , L235 , L243 , L150;
L248: C73 <= ( ( len D45 ) + ( ( len R11 ) + 1 ) ) by L247 , L246 , XXREAL_0:2;
L249: C73 <= ( ( len D45 ) + ( len ( (R32 , R11) -admissible ) ) ) by L248 , L7;
L250: C73 <= ( len ( R10 ^ R11 ) ) by L225 , L150;
L251: C73 in ( dom ( R10 ^ R11 ) ) by L250 , L224 , FINSEQ_3:25;
L252: ( D44 . C73 ) = ( D46 . [ ( ( (R31 , ( R10 ^ R11 )) -admissible ) . C73 ) , ( ( R10 ^ R11 ) . C73 ) ] ) by L251 , L150
.= ( D46 . [ ( ( ( Del (( (R31 , R10) -admissible ) , ( ( len R10 ) + 1 )) ) ^ ( (R32 , R11) -admissible ) ) . C73 ) , ( ( R10 ^ R11 ) . C73 ) ] ) by L215 , L116
.= ( D46 . [ ( ( (R32 , R11) -admissible ) . ( C73 - ( len D45 ) ) ) , ( ( R10 ^ R11 ) . C73 ) ] ) by L241 , L249 , FINSEQ_1:23
.= ( D46 . [ ( ( (R32 , R11) -admissible ) . ( C73 - ( len R10 ) ) ) , ( R11 . ( C73 - ( len R10 ) ) ) ] ) by L221 , L222 , L235 , L237 , L242 , FINSEQ_1:23;
thus L253: ( D44 . C73 ) = ( ( D42 ^ D43 ) . C73 ) by L252 , L244;
end;
end;
L255: ( len D44 ) = ( len ( R10 ^ R11 ) ) by L150
.= ( ( len R10 ) + ( len R11 ) ) by FINSEQ_1:22
.= ( ( len D42 ) + ( len R11 ) ) by L150
.= ( ( len D42 ) + ( len D43 ) ) by L150
.= ( len ( D42 ^ D43 ) ) by FINSEQ_1:22;
thus L256: thesis by L255 , L216 , FINSEQ_1:14;
end;
theorem
L257: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R10 being (FinSequence of R5) holds (for R11 being (FinSequence of R5) holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R33 being (State of R17) holds (for R34 being (State of R17) holds (for R35 being (State of R18) holds (for R36 being (State of R18) holds ((R33 , R10 -leads_to R34 & R35 , R10 -leads_to R36 & ( (R34 , R11) -response ) <> ( (R36 , R11) -response )) implies ( (R33 , ( R10 ^ R11 )) -response ) <> ( (R35 , ( R10 ^ R11 )) -response ))))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R10 being (FinSequence of R5);
let R11 being (FinSequence of R5);
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R33 being (State of R17);
let R34 being (State of R17);
let R35 being (State of R18);
let R36 being (State of R18);
assume that
L258: R33 , R10 -leads_to R34
and
L259: R35 , R10 -leads_to R36
and
L260: ( (R34 , R11) -response ) <> ( (R36 , R11) -response );
set D48 = ( (R34 , R11) -response );
set D49 = ( (R36 , R11) -response );
L261: ( len D49 ) = ( len R11 ) by L150;
set D50 = ( R10 ^ R11 );
set D51 = ( (R33 , R10) -response );
set D52 = ( (R35 , R10) -response );
assume L262: ( (R33 , ( R10 ^ R11 )) -response ) = ( (R35 , ( R10 ^ R11 )) -response );
set D53 = ( (R35 , D50) -response );
L263: D53 = ( D52 ^ D49 ) by L259 , L214;
set D54 = ( (R33 , D50) -response );
L264: D54 = ( D51 ^ D48 ) by L258 , L214;
L265: ( len D51 ) = ( len R10 ) by L150;
L266: ( len D48 ) = ( len R11 ) by L150;
L267: ( dom R11 ) = ( Seg ( len D48 ) ) by L266 , FINSEQ_1:def 3;
L268: ( dom R11 ) = ( dom D48 ) by L267 , FINSEQ_1:def 3;
consider C74 being Nat such that L269: C74 in ( dom R11 ) and L270: ( D48 . C74 ) <> ( D49 . C74 ) by L268 , L260 , L266 , L261 , FINSEQ_2:9;
L271: ( len D52 ) = ( len R10 ) by L150;
L272: C74 in ( dom D48 ) by L267 , L269 , FINSEQ_1:def 3;
L273: ( D54 . ( ( len R10 ) + C74 ) ) = ( D48 . C74 ) by L272 , L265 , L264 , FINSEQ_1:def 7;
L274: C74 in ( dom D49 ) by L266 , L261 , L267 , L269 , FINSEQ_1:def 3;
thus L275: contradiction by L274 , L262 , L271 , L270 , L263 , L273 , FINSEQ_1:def 7;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let C75 being non  empty Mealy-FSM over R5 , R6;
let C76 being non  empty Moore-FSM over R5 , R6;
pred C75 is_similar_to C76
means
(for B56 being (FinSequence of R5) holds ( <* ( (the OFun of C76) . (the InitS of C76) ) *> ^ ( ((the InitS of C75) , B56) -response ) ) = ( ((the InitS of C76) , B56) -response ))
;end;
theorem
L277: (for R5 being non  empty set holds (for R6 being non  empty set holds (for B57 being non  empty  finite Moore-FSM over R5 , R6 holds (ex B58 being non  empty  finite Mealy-FSM over R5 , R6 st B58 is_similar_to B57))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let C77 being non  empty  finite Moore-FSM over R5 , R6;
set D55 = (the carrier of C77);
set D56 = (the Tran of C77);
set D57 = (the OFun of C77);
set D58 = (the InitS of C77);
deffunc H3((Element of D55) , (Element of R5)) = ( D57 . ( D56 . [ $1 , $2 ] ) );
consider C78 being (Function of [: D55 , R5 :] , R6) such that L278: (for B59 being (Element of D55) holds (for B60 being (Element of R5) holds ( C78 . (B59 , B60) ) = H3(B59 , B60))) from BINOP_1:sch 4;
take D59 = Mealy-FSM (# D55 , D56 , C78 , D58 #);
let C79 being (FinSequence of R5);
set D60 = (the InitS of D59);
set D61 = ( (D60 , C79) -admissible );
set D62 = ( (D58 , C79) -admissible );
defpred S5[ (Element of ( NAT )) ] means ($1 in ( Seg ( ( len C79 ) + 1 ) ) implies ( D61 . $1 ) = ( D62 . $1 ));
L279: (for B61 being (Element of ( NAT )) holds (S5[ B61 ] implies S5[ ( B61 + 1 ) ]))
proof
let C80 being (Element of ( NAT ));
assume L280: (C80 in ( Seg ( ( len C79 ) + 1 ) ) implies ( D61 . C80 ) = ( D62 . C80 ));
assume L281: ( C80 + 1 ) in ( Seg ( ( len C79 ) + 1 ) );
L282: ( C80 + 1 ) <= ( ( len C79 ) + 1 ) by L281 , FINSEQ_1:1;
per cases  by L282 , XREAL_1:6;
suppose L283: C80 = ( 0 );

L284: ( D61 . 1 ) = (the InitS of D59) by L7;
thus L285: thesis by L284 , L283 , L7;
end;
suppose L286: (C80 > ( 0 ) & C80 <= ( len C79 ));

L287: C80 <= ( ( len C79 ) + 1 ) by L286 , NAT_1:13;
L288: (( ( 0 ) + 1 ) = 1 implies (1 <= C80 & C80 <= ( len C79 ))) by L286 , NAT_1:13;
L289: ((ex B62 being (Element of R5) st (ex B63 , B64 being (Element of D59) st (B62 = ( C79 . C80 ) & B63 = ( D61 . C80 ) & B64 = ( D61 . ( C80 + 1 ) ) & ( B62 -succ_of B63 ) = B64))) & (ex B65 being (Element of R5) st (ex B66 , B67 being (Element of C77) st (B65 = ( C79 . C80 ) & B66 = ( D62 . C80 ) & B67 = ( D62 . ( C80 + 1 ) ) & ( B65 -succ_of B66 ) = B67)))) by L288 , L7;
thus L290: thesis by L289 , L280 , L288 , L287 , FINSEQ_1:1;
end;
end;
L292: S5[ ( 0 ) ] by FINSEQ_1:1;
L293: (for B68 being (Element of ( NAT )) holds S5[ B68 ]) from NAT_1:sch 1(L292 , L279);
L294:
now
thus L295: ( len ( <* ( D57 . D58 ) *> ^ ( (D60 , C79) -response ) ) ) = ( ( len <* ( D57 . D58 ) *> ) + ( len ( (D60 , C79) -response ) ) ) by FINSEQ_1:22
.= ( 1 + ( len ( (D60 , C79) -response ) ) ) by FINSEQ_1:40
.= ( ( len C79 ) + 1 ) by L150;
L296: ( dom ( <* ( D57 . D58 ) *> ^ ( (D60 , C79) -response ) ) ) = ( Seg ( ( len C79 ) + 1 ) ) by L295 , FINSEQ_1:def 3;
thus L297: ( len ( (D58 , C79) -response ) ) = ( ( len C79 ) + 1 ) by L184;
let C81 being Nat;
assume L298: C81 in ( dom ( <* ( D57 . D58 ) *> ^ ( (D60 , C79) -response ) ) );
L299: 1 <= C81 by L298 , L296 , FINSEQ_1:1;
L300: C81 <= ( ( len C79 ) + 1 ) by L296 , L298 , FINSEQ_1:1;
per cases  by L299 , XXREAL_0:1;
suppose L301: C81 = 1;

L302: C81 in ( Seg 1 ) by L301 , FINSEQ_1:2 , TARSKI:def 1;
L303: C81 in ( dom <* ( D57 . D58 ) *> ) by L302 , FINSEQ_1:38;
thus L304: ( ( <* ( D57 . D58 ) *> ^ ( (D60 , C79) -response ) ) . C81 ) = ( <* ( D57 . D58 ) *> . C81 ) by L303 , FINSEQ_1:def 7
.= ( D57 . D58 ) by L301 , FINSEQ_1:40
.= ( ( (D58 , C79) -response ) . C81 ) by L301 , L210;
end;
suppose L305: 1 < C81;

consider C82 being (Element of ( NAT )) such that L306: C82 = ( C81 - 1 ) and L307: 1 <= C82 by L305 , INT_1:51;
L308: C81 = ( C82 + 1 ) by L306;
L309: C82 <= ( len C79 ) by L308 , L300 , XREAL_1:6;
consider C83 being (Element of R5), C84 , C85 being (Element of C77) such that L310: (C83 = ( C79 . C82 ) & C84 = ( D62 . C82 )) and L311: (C85 = ( D62 . ( C82 + 1 ) ) & ( C83 -succ_of C84 ) = C85) by L309 , L307 , L7;
L312: C82 in ( Seg ( len C79 ) ) by L307 , L309 , FINSEQ_1:1;
L313: C82 in ( dom C79 ) by L312 , FINSEQ_1:def 3;
L314: C82 <= ( ( len C79 ) + 1 ) by L309 , NAT_1:12;
L315: C82 in ( Seg ( ( len C79 ) + 1 ) ) by L314 , L307 , FINSEQ_1:1;
L316: ( len ( (D60 , C79) -response ) ) = ( len C79 ) by L150;
L317: (( len <* ( D57 . D58 ) *> ) = 1 & C82 in ( dom ( (D60 , C79) -response ) )) by L316 , L312 , FINSEQ_1:40 , FINSEQ_1:def 3;
L318: ( ( <* ( D57 . D58 ) *> ^ ( (D60 , C79) -response ) ) . C81 ) = ( ( (D60 , C79) -response ) . C82 ) by L317 , L308 , FINSEQ_1:def 7
.= ( (the OFun of D59) . [ ( ( (D60 , C79) -admissible ) . C82 ) , ( C79 . C82 ) ] ) by L313 , L150
.= ( C78 . (( ( (D58 , C79) -admissible ) . C82 ) , ( C79 . C82 )) ) by L293 , L315
.= ( D57 . ( D56 . (C84 , C83) ) ) by L278 , L310
.= ( ( (D58 , C79) -response ) . C81 ) by L296 , L298 , L306 , L311 , L184;
thus L319: ( ( <* ( D57 . D58 ) *> ^ ( (D60 , C79) -response ) ) . C81 ) = ( ( (D58 , C79) -response ) . C81 ) by L318;
end;
end;
thus L321: thesis by L294 , FINSEQ_2:9;
end;
theorem
L322: (for R5 being non  empty set holds (for R37 being  finite non  empty set holds (for R38 being  finite non  empty Mealy-FSM over R5 , R37 holds (ex R39 being  finite non  empty Moore-FSM over R5 , R37 st R38 is_similar_to R39))))
proof
let R5 being non  empty set;
let R37 being  finite non  empty set;
let R38 being  finite non  empty Mealy-FSM over R5 , R37;
set D63 = (the carrier of R38);
set D64 = (the Tran of R38);
set D65 = (the OFun of R38);
set D66 = (the InitS of R38);
set D67 = [: D63 , R37 :];
deffunc H4((Element of D67) , (Element of R5)) = [ ( D64 . [ ( $1 `1 ) , $2 ] ) , ( D65 . [ ( $1 `1 ) , $2 ] ) ];
consider C86 being (Function of [: D67 , R5 :] , D67) such that L323: (for B69 being (Element of D67) holds (for B70 being (Element of R5) holds ( C86 . (B69 , B70) ) = H4(B69 , B70))) from BINOP_1:sch 4;
set D68 = D67;
set D69 = C86;
set D70 = the (Element of R37);
deffunc H5((Element of D63) , (Element of R37)) = $2;
consider C87 being (Function of D67 , R37) such that L324: (for B71 being (Element of D63) holds (for B72 being (Element of R37) holds ( C87 . (B71 , B72) ) = H5(B71 , B72))) from BINOP_1:sch 4;
set D71 = [ D66 , D70 ];
reconsider D72 = C87 as (Function of D68 , R37);
reconsider D73 = Moore-FSM (# D68 , D69 , D72 , D71 #) as  finite non  empty Moore-FSM over R5 , R37;
take D73;
reconsider D74 = D71 as (Element of D73);
thus L325: R38 is_similar_to D73
proof
let C88 being (FinSequence of R5);
set D75 = ( ((the InitS of R38) , C88) -admissible );
set D76 = ( ((the InitS of D73) , C88) -admissible );
defpred S6[ (Element of ( NAT )) ] means ($1 in ( Seg ( ( len C88 ) + 1 ) ) implies ( D75 . $1 ) = ( ( D76 . $1 ) `1 ));
L326: (for B73 being (Element of ( NAT )) holds (S6[ B73 ] implies S6[ ( B73 + 1 ) ]))
proof
let C89 being (Element of ( NAT ));
assume L327: S6[ C89 ];
assume L328: ( C89 + 1 ) in ( Seg ( ( len C88 ) + 1 ) );
L329: ( C89 + 1 ) <= ( ( len C88 ) + 1 ) by L328 , FINSEQ_1:1;
per cases  by L329 , XREAL_1:6;
suppose L330: C89 = ( 0 );

L331: ( D75 . 1 ) = D66 by L7
.= ( [ D66 , D70 ] `1 )
.= ( ( D76 . 1 ) `1 ) by L7;
thus L332: thesis by L331 , L330;
end;
suppose L333: (C89 > ( 0 ) & C89 <= ( len C88 ));

L334: C89 <= ( ( len C88 ) + 1 ) by L333 , NAT_1:13;
L335: (( ( 0 ) + 1 ) = 1 implies (1 <= C89 & C89 <= ( len C88 ))) by L333 , NAT_1:13;
L336: (ex B74 being (Element of R5) st (ex B75 , B76 being (Element of R38) st (B74 = ( C88 . C89 ) & B75 = ( D75 . C89 ) & B76 = ( D75 . ( C89 + 1 ) ) & ( B74 -succ_of B75 ) = B76))) by L335 , L7;
consider C90 being (Element of R5), C91 , C92 being (Element of D73) such that L337: (C90 = ( C88 . C89 ) & C91 = ( D76 . C89 ) & C92 = ( D76 . ( C89 + 1 ) )) and L338: ( C90 -succ_of C91 ) = C92 by L335 , L7;
L339: ( [ ( D64 . [ ( C91 `1 ) , C90 ] ) , ( D65 . [ ( C91 `1 ) , C90 ] ) ] `1 ) = ( D64 . [ ( C91 `1 ) , C90 ] );
L340: C92 = ( C86 . (C91 , C90) ) by L338
.= [ ( D64 . [ ( C91 `1 ) , C90 ] ) , ( D65 . [ ( C91 `1 ) , C90 ] ) ] by L323;
thus L341: thesis by L340 , L327 , L335 , L334 , L336 , L337 , FINSEQ_1:1 , L339;
end;
end;
L343: S6[ ( 0 ) ] by FINSEQ_1:1;
L344: (for B77 being (Element of ( NAT )) holds S6[ B77 ]) from NAT_1:sch 1(L343 , L326);
L345:
now
thus L346: ( len ( <* ( C87 . D71 ) *> ^ ( (D66 , C88) -response ) ) ) = ( ( len <* ( C87 . D71 ) *> ) + ( len ( (D66 , C88) -response ) ) ) by FINSEQ_1:22
.= ( 1 + ( len ( (D66 , C88) -response ) ) ) by FINSEQ_1:40
.= ( ( len C88 ) + 1 ) by L150;
L347: ( dom ( <* ( C87 . D71 ) *> ^ ( (D66 , C88) -response ) ) ) = ( Seg ( ( len C88 ) + 1 ) ) by L346 , FINSEQ_1:def 3;
thus L348: ( len ( (D74 , C88) -response ) ) = ( ( len C88 ) + 1 ) by L184;
let C93 being Nat;
assume L349: C93 in ( dom ( <* ( C87 . D71 ) *> ^ ( (D66 , C88) -response ) ) );
L350: 1 <= C93 by L349 , L347 , FINSEQ_1:1;
L351: C93 <= ( ( len C88 ) + 1 ) by L347 , L349 , FINSEQ_1:1;
per cases  by L350 , XXREAL_0:1;
suppose L352: C93 = 1;

L353: C93 in ( Seg 1 ) by L352 , FINSEQ_1:2 , TARSKI:def 1;
L354: C93 in ( dom <* ( C87 . D71 ) *> ) by L353 , FINSEQ_1:38;
thus L355: ( ( <* ( C87 . D71 ) *> ^ ( (D66 , C88) -response ) ) . C93 ) = ( <* ( C87 . D71 ) *> . C93 ) by L354 , FINSEQ_1:def 7
.= ( C87 . D71 ) by L352 , FINSEQ_1:40
.= ( ( (D74 , C88) -response ) . C93 ) by L352 , L210;
end;
suppose L356: 1 < C93;

consider C94 being (Element of ( NAT )) such that L357: C94 = ( C93 - 1 ) and L358: 1 <= C94 by L356 , INT_1:51;
L359: C93 = ( C94 + 1 ) by L357;
L360: C94 <= ( len C88 ) by L359 , L351 , XREAL_1:6;
consider C95 being (Element of R5), C96 , C97 being (Element of D73) such that L361: C95 = ( C88 . C94 ) and L362: C96 = ( D76 . C94 ) and L363: (C97 = ( D76 . ( C94 + 1 ) ) & ( C95 -succ_of C96 ) = C97) by L360 , L358 , L7;
L364: C94 <= ( ( len C88 ) + 1 ) by L360 , NAT_1:12;
L365: C94 in ( Seg ( ( len C88 ) + 1 ) ) by L364 , L358 , FINSEQ_1:1;
reconsider D77 = C96 as (Element of D67);
L366: C94 in ( Seg ( len C88 ) ) by L358 , L360 , FINSEQ_1:1;
L367: C94 in ( dom C88 ) by L366 , FINSEQ_1:def 3;
L368: ( len ( (D66 , C88) -response ) ) = ( len C88 ) by L150;
L369: (( len <* ( C87 . D71 ) *> ) = 1 & C94 in ( dom ( (D66 , C88) -response ) )) by L368 , L366 , FINSEQ_1:40 , FINSEQ_1:def 3;
thus L370: ( ( <* ( C87 . D71 ) *> ^ ( (D66 , C88) -response ) ) . C93 ) = ( ( (D66 , C88) -response ) . C94 ) by L369 , L359 , FINSEQ_1:def 7
.= ( D65 . (( ( (D66 , C88) -admissible ) . C94 ) , ( C88 . C94 )) ) by L367 , L150
.= ( D65 . (( D77 `1 ) , ( C88 . C94 )) ) by L344 , L365 , L362
.= ( C87 . (( D64 . (( D77 `1 ) , C95) ) , ( D65 . (( D77 `1 ) , C95) )) ) by L324 , L361
.= ( C87 . ( C86 . (D77 , C95) ) ) by L323
.= ( ( (D74 , C88) -response ) . C93 ) by L347 , L349 , L357 , L363 , L184;
end;
end;
thus L372: thesis by L345 , FINSEQ_2:9;
end;

end;
begin
definition
let C98 , C99 being non  empty set;
let C100 , C101 being non  empty Mealy-FSM over C98 , C99;
pred C100 , C101 -are_equivalent 
means
:L326: (for B78 being (FinSequence of C98) holds ( ((the InitS of C100) , B78) -response ) = ( ((the InitS of C101) , B78) -response ))
;reflexivity
;
symmetry
;
end;
theorem
L328: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R19 being non  empty Mealy-FSM over R5 , R6 holds ((R17 , R18 -are_equivalent  & R18 , R19 -are_equivalent ) implies R17 , R19 -are_equivalent ))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R19 being non  empty Mealy-FSM over R5 , R6;
assume that
L329: R17 , R18 -are_equivalent 
and
L330: R18 , R19 -are_equivalent ;
let C102 being (FinSequence of R5);
set D78 = (the InitS of R19);
set D79 = (the InitS of R17);
set D80 = (the InitS of R18);
thus L331: ( (D79 , C102) -response ) = ( (D80 , C102) -response ) by L329 , L326
.= ( (D78 , C102) -response ) by L330 , L326;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
pred R26 , R27 -are_equivalent 
means
:L332: (for R9 being (FinSequence of R5) holds ( (R26 , R9) -response ) = ( (R27 , R9) -response ))
;reflexivity
;
symmetry
;
end;
theorem
L334: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R23 being (State of R16) holds (for R24 being (State of R16) holds (for R25 being (State of R16) holds ((R23 , R24 -are_equivalent  & R24 , R25 -are_equivalent ) implies R23 , R25 -are_equivalent )))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R23 being (State of R16);
let R24 being (State of R16);
let R25 being (State of R16);
assume that
L335: R23 , R24 -are_equivalent 
and
L336: R24 , R25 -are_equivalent ;
thus L337: R23 , R25 -are_equivalent 
proof
let C103 being (FinSequence of R5);
L338: ( (R23 , C103) -response ) = ( (R24 , C103) -response ) by L335 , L332;
thus L339: thesis by L338 , L336 , L332;
end;

end;
theorem
L338: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R8 being (Element of R5) holds (for R9 being (FinSequence of R5) holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R29 being (State of R16) holds (R29 = ( (the Tran of R16) . [ R26 , R8 ] ) implies (for R3 being (Element of ( NAT )) holds (R3 in ( Seg ( ( len R9 ) + 1 ) ) implies ( ( (R26 , ( <* R8 *> ^ R9 )) -admissible ) . ( R3 + 1 ) ) = ( ( (R29 , R9) -admissible ) . R3 )))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R8 being (Element of R5);
let R9 being (FinSequence of R5);
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R29 being (State of R16);
set D81 = ( <* R8 *> ^ R9 );
L339: ( len D81 ) = ( ( len <* R8 *> ) + ( len R9 ) ) by FINSEQ_1:22
.= ( ( len R9 ) + 1 ) by FINSEQ_1:40;
defpred S7[ (Element of ( NAT )) ] means ($1 in ( Seg ( ( len R9 ) + 1 ) ) implies ( ( (R26 , ( <* R8 *> ^ R9 )) -admissible ) . ( $1 + 1 ) ) = ( ( (R29 , R9) -admissible ) . $1 ));
L340: ( D81 . 1 ) = R8 by FINSEQ_1:41;
assume L341: R29 = ( (the Tran of R16) . [ R26 , R8 ] );
L342: (for B79 being (Element of ( NAT )) holds (S7[ B79 ] implies S7[ ( B79 + 1 ) ]))
proof
let C104 being (Element of ( NAT ));
assume L343: (C104 in ( Seg ( ( len R9 ) + 1 ) ) implies ( ( (R26 , ( <* R8 *> ^ R9 )) -admissible ) . ( C104 + 1 ) ) = ( ( (R29 , R9) -admissible ) . C104 ));
assume L344: ( C104 + 1 ) in ( Seg ( ( len R9 ) + 1 ) );
per cases ;
suppose L345: C104 = ( 0 );

set D82 = ( (R26 , D81) -admissible );
L346: 1 <= ( len D81 ) by L339 , L344 , L345 , FINSEQ_1:1;
L347: (ex B80 being (Element of R5) st (ex B81 , B82 being (Element of R16) st (B80 = ( D81 . 1 ) & B81 = ( D82 . 1 ) & B82 = ( D82 . ( 1 + 1 ) ) & ( B80 -succ_of B81 ) = B82))) by L346 , L7;
L348: ( ( (R29 , R9) -admissible ) . 1 ) = R29 by L7;
thus L349: thesis by L348 , L341 , L340 , L345 , L347 , L7;
end;
suppose L350: C104 <> ( 0 );

set D83 = ( (R26 , D81) -admissible );
set D84 = ( (R29 , R9) -admissible );
L351: C104 in ( Seg ( len R9 ) ) by L344 , L350 , FINSEQ_1:61;
L352: C104 <= ( len R9 ) by L351 , FINSEQ_1:1;
L353: (1 <= ( C104 + 1 ) & ( C104 + 1 ) <= ( len D81 )) by L352 , L339 , NAT_1:12 , XREAL_1:7;
L354: (ex B83 being (Element of R5) st (ex B84 , B85 being (Element of R16) st (B83 = ( D81 . ( C104 + 1 ) ) & B84 = ( D83 . ( C104 + 1 ) ) & B85 = ( D83 . ( ( C104 + 1 ) + 1 ) ) & ( B83 -succ_of B84 ) = B85))) by L353 , L7;
L355: 1 <= C104 by L351 , FINSEQ_1:1;
L356: (ex B86 being (Element of R5) st (ex B87 , B88 being (Element of R16) st (B86 = ( R9 . C104 ) & B87 = ( D84 . C104 ) & B88 = ( D84 . ( C104 + 1 ) ) & ( B86 -succ_of B87 ) = B88))) by L355 , L352 , L7;
L357: C104 in ( dom R9 ) by L351 , FINSEQ_1:def 3;
thus L358: thesis by L357 , L343 , L344 , L350 , L354 , L356 , FINSEQ_1:61 , FINSEQ_3:103;
end;
end;
L360: S7[ ( 0 ) ] by FINSEQ_1:1;
thus L361: (for B89 being (Element of ( NAT )) holds S7[ B89 ]) from NAT_1:sch 1(L360 , L342);
end;
theorem
L362: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R8 being (Element of R5) holds (for R9 being (FinSequence of R5) holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R29 being (State of R16) holds (R29 = ( (the Tran of R16) . [ R26 , R8 ] ) implies ( (R26 , ( <* R8 *> ^ R9 )) -response ) = ( <* ( (the OFun of R16) . [ R26 , R8 ] ) *> ^ ( (R29 , R9) -response ) )))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R8 being (Element of R5);
let R9 being (FinSequence of R5);
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R29 being (State of R16);
set D85 = (the OFun of R16);
set D86 = ( D85 . [ R26 , R8 ] );
L363: ( len ( <* R8 *> ^ R9 ) ) = ( ( len <* R8 *> ) + ( len R9 ) ) by FINSEQ_1:22
.= ( 1 + ( len R9 ) ) by FINSEQ_1:40;
assume L364: R29 = ( (the Tran of R16) . [ R26 , R8 ] );
L365:
now
thus L366: ( len ( (R26 , ( <* R8 *> ^ R9 )) -response ) ) = ( 1 + ( len R9 ) ) by L363 , L150;
L367: ( dom ( (R26 , ( <* R8 *> ^ R9 )) -response ) ) = ( Seg ( 1 + ( len R9 ) ) ) by L366 , FINSEQ_1:def 3;
thus L368: ( len ( <* D86 *> ^ ( (R29 , R9) -response ) ) ) = ( ( len <* D86 *> ) + ( len ( (R29 , R9) -response ) ) ) by FINSEQ_1:22
.= ( 1 + ( len ( (R29 , R9) -response ) ) ) by FINSEQ_1:40
.= ( 1 + ( len R9 ) ) by L150;
let C105 being Nat;
assume L369: C105 in ( dom ( (R26 , ( <* R8 *> ^ R9 )) -response ) );
L370: 1 <= C105 by L369 , L367 , FINSEQ_1:1;
L371: C105 <= ( 1 + ( len R9 ) ) by L367 , L369 , FINSEQ_1:1;
L372: C105 in ( dom ( <* R8 *> ^ R9 ) ) by L363 , L367 , L369 , FINSEQ_1:def 3;
per cases  by L370 , XXREAL_0:1;
suppose L373: C105 = 1;

thus L374: ( ( (R26 , ( <* R8 *> ^ R9 )) -response ) . C105 ) = ( D85 . [ ( ( (R26 , ( <* R8 *> ^ R9 )) -admissible ) . C105 ) , ( ( <* R8 *> ^ R9 ) . C105 ) ] ) by L372 , L150
.= ( D85 . [ R26 , ( ( <* R8 *> ^ R9 ) . C105 ) ] ) by L373 , L7
.= D86 by L373 , FINSEQ_1:41
.= ( ( <* D86 *> ^ ( (R29 , R9) -response ) ) . C105 ) by L373 , FINSEQ_1:41;
end;
suppose L375: C105 > 1;

consider C106 being (Element of ( NAT )) such that L376: C106 = ( C105 - 1 ) and L377: 1 <= C106 by L375 , INT_1:51;
L378: C105 <= ( ( len R9 ) + 1 ) by L367 , L369 , FINSEQ_1:1;
L379: ( C105 - 1 ) <= ( ( ( len R9 ) + 1 ) - 1 ) by L378 , XREAL_1:9;
L380: C106 in ( Seg ( len R9 ) ) by L379 , L376 , L377 , FINSEQ_1:1;
L381: C106 in ( Seg ( 1 + ( len R9 ) ) ) by L380 , FINSEQ_2:8;
L382: ( C106 + 1 ) in ( Seg ( 1 + ( len R9 ) ) ) by L380 , FINSEQ_1:60;
L383: ( C106 + 1 ) in ( dom ( <* R8 *> ^ R9 ) ) by L382 , L363 , FINSEQ_1:def 3;
L384: C106 in ( dom R9 ) by L380 , FINSEQ_1:def 3;
L385: ( len <* D86 *> ) = 1 by FINSEQ_1:40;
L386: ( ( <* D86 *> ^ ( (R29 , R9) -response ) ) . C105 ) = ( ( (R29 , R9) -response ) . C106 ) by L385 , L368 , L371 , L375 , L376 , FINSEQ_1:24
.= ( D85 . [ ( ( (R29 , R9) -admissible ) . C106 ) , ( R9 . C106 ) ] ) by L384 , L150
.= ( D85 . [ ( ( (R29 , R9) -admissible ) . C106 ) , ( ( <* R8 *> ^ R9 ) . ( C106 + 1 ) ) ] ) by L384 , FINSEQ_3:103
.= ( D85 . [ ( ( (R26 , ( <* R8 *> ^ R9 )) -admissible ) . ( C106 + 1 ) ) , ( ( <* R8 *> ^ R9 ) . ( C106 + 1 ) ) ] ) by L364 , L381 , L338
.= ( ( (R26 , ( <* R8 *> ^ R9 )) -response ) . C105 ) by L376 , L383 , L150;
thus L387: ( ( (R26 , ( <* R8 *> ^ R9 )) -response ) . C105 ) = ( ( <* D86 *> ^ ( (R29 , R9) -response ) ) . C105 ) by L386;
end;
end;
thus L389: thesis by L365 , FINSEQ_2:9;
end;
theorem
L390: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R27 being (State of R16) holds (R26 , R27 -are_equivalent  iff (for R8 being (Element of R5) holds (( (the OFun of R16) . [ R26 , R8 ] ) = ( (the OFun of R16) . [ R27 , R8 ] ) & ( (the Tran of R16) . [ R26 , R8 ] ) , ( (the Tran of R16) . [ R27 , R8 ] ) -are_equivalent ))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
set D87 = (the OFun of R16);
thus L391:now
assume L392: R26 , R27 -are_equivalent ;
let C107 being (Element of R5);
set D88 = ( (the Tran of R16) . [ R26 , C107 ] );
set D89 = ( (the Tran of R16) . [ R27 , C107 ] );
L393: ( len <* C107 *> ) = 1 by FINSEQ_1:40;
L394: 1 in ( dom <* C107 *> ) by L393 , FINSEQ_3:25;
thus L395: ( D87 . [ R26 , C107 ] ) = ( D87 . [ ( ( (R26 , <* C107 *>) -admissible ) . 1 ) , C107 ] ) by L7
.= ( D87 . [ ( ( (R26 , <* C107 *>) -admissible ) . 1 ) , ( <* C107 *> . 1 ) ] ) by FINSEQ_1:40
.= ( ( (R26 , <* C107 *>) -response ) . 1 ) by L394 , L150
.= ( ( (R27 , <* C107 *>) -response ) . 1 ) by L392 , L332
.= ( D87 . [ ( ( (R27 , <* C107 *>) -admissible ) . 1 ) , ( <* C107 *> . 1 ) ] ) by L394 , L150
.= ( D87 . [ ( ( (R27 , <* C107 *>) -admissible ) . 1 ) , C107 ] ) by FINSEQ_1:40
.= ( D87 . [ R27 , C107 ] ) by L7;
L396:
now
let C108 being (FinSequence of R5);
L397: (( (R26 , ( <* C107 *> ^ C108 )) -response ) = ( <* ( D87 . [ R26 , C107 ] ) *> ^ ( (D88 , C108) -response ) ) & ( (R27 , ( <* C107 *> ^ C108 )) -response ) = ( <* ( D87 . [ R27 , C107 ] ) *> ^ ( (D89 , C108) -response ) )) by L362;
L398: ( (R26 , ( <* C107 *> ^ C108 )) -response ) = ( (R27 , ( <* C107 *> ^ C108 )) -response ) by L392 , L332;
thus L399: ( (D88 , C108) -response ) = ( (D89 , C108) -response ) by L398 , L395 , L397 , FINSEQ_1:33;
end;
thus L400: ( (the Tran of R16) . [ R26 , C107 ] ) , ( (the Tran of R16) . [ R27 , C107 ] ) -are_equivalent  by L396 , L332;
end;
assume L401: (for B90 being (Element of R5) holds (( (the OFun of R16) . [ R26 , B90 ] ) = ( (the OFun of R16) . [ R27 , B90 ] ) & ( (the Tran of R16) . [ R26 , B90 ] ) , ( (the Tran of R16) . [ R27 , B90 ] ) -are_equivalent ));
let C109 being (FinSequence of R5);
per cases ;
suppose L402: C109 = ( <*> R5 );

thus L403: ( (R26 , C109) -response ) = ( <*> R6 ) by L402 , L181
.= ( (R27 , C109) -response ) by L402 , L181;
end;
suppose L404: C109 <> ( {} );

consider C110 being (Element of R5), C111 being (FinSequence of R5) such that L405: C110 = ( C109 . 1 ) and L406: C109 = ( <* C110 *> ^ C111 ) by L404 , FINSEQ_3:102;
set D90 = ( (the OFun of R16) . [ R27 , C110 ] );
set D91 = ( (the OFun of R16) . [ R26 , C110 ] );
set D92 = ( (the Tran of R16) . [ R27 , C110 ] );
set D93 = ( (the Tran of R16) . [ R26 , C110 ] );
L407: D93 , D92 -are_equivalent  by L401;
L408: ( (D93 , C111) -response ) = ( (D92 , C111) -response ) by L407 , L332;
thus L409: ( (R26 , C109) -response ) = ( <* D91 *> ^ ( (D93 , C111) -response ) ) by L406 , L362
.= ( <* D90 *> ^ ( (D92 , C111) -response ) ) by L401 , L408
.= ( (R27 , C109) -response ) by L406 , L362;
end;
end;
theorem
L411: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R27 being (State of R16) holds (R26 , R27 -are_equivalent  implies (for R9 being (FinSequence of R5) holds (for R3 being (Element of ( NAT )) holds (R3 in ( dom R9 ) implies (ex B91 , B92 being (State of R16) st (B91 = ( ( (R26 , R9) -admissible ) . R3 ) & B92 = ( ( (R27 , R9) -admissible ) . R3 ) & B91 , B92 -are_equivalent )))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
assume L412: R26 , R27 -are_equivalent ;
let C112 being (FinSequence of R5);
defpred S8[ (Element of ( NAT )) ] means ($1 in ( Seg ( len C112 ) ) implies (ex B93 , B94 being (Element of R16) st (B93 = ( ( (R26 , C112) -admissible ) . $1 ) & B94 = ( ( (R27 , C112) -admissible ) . $1 ) & B93 , B94 -are_equivalent )));
L413: (for B95 being (Element of ( NAT )) holds (S8[ B95 ] implies S8[ ( B95 + 1 ) ]))
proof
let C113 being (Element of ( NAT ));
assume L414: (C113 in ( Seg ( len C112 ) ) implies (ex B96 , B97 being (Element of R16) st (B96 = ( ( (R26 , C112) -admissible ) . C113 ) & B97 = ( ( (R27 , C112) -admissible ) . C113 ) & B96 , B97 -are_equivalent )));
L415: (C113 = ( 0 ) or (( 0 ) < C113 & ( ( 0 ) + 1 ) = 1));
assume L416: ( C113 + 1 ) in ( Seg ( len C112 ) );
L417: ( C113 + 1 ) <= ( len C112 ) by L416 , FINSEQ_1:1;
L418: (( 0 ) = C113 or (1 <= C113 & C113 <= ( len C112 ))) by L417 , L415 , NAT_1:13;
per cases  by L418 , FINSEQ_1:1;
suppose L419: C113 = ( 0 );

reconsider D94 = ( ( (R26 , C112) -admissible ) . 1 ) , D95 = ( ( (R27 , C112) -admissible ) . 1 ) as (Element of R16) by L7;
take D94;
take D95;
thus L420: D94 = ( ( (R26 , C112) -admissible ) . ( C113 + 1 ) ) by L419;
thus L421: D95 = ( ( (R27 , C112) -admissible ) . ( C113 + 1 ) ) by L419;
L422: D94 = R26 by L7;
thus L423: thesis by L422 , L412 , L7;
end;
suppose L424: C113 in ( Seg ( len C112 ) );

L425: (1 <= C113 & C113 <= ( len C112 )) by L424 , FINSEQ_1:1;
consider C114 being (Element of R5), C115 , C116 being (Element of R16) such that L426: (C114 = ( C112 . C113 ) & C115 = ( ( (R26 , C112) -admissible ) . C113 )) and L427: C116 = ( ( (R26 , C112) -admissible ) . ( C113 + 1 ) ) and L428: ( C114 -succ_of C115 ) = C116 by L425 , L7;
take C116;
consider C117 being (Element of R5), C118 , C119 being (Element of R16) such that L429: (C117 = ( C112 . C113 ) & C118 = ( ( (R27 , C112) -admissible ) . C113 )) and L430: C119 = ( ( (R27 , C112) -admissible ) . ( C113 + 1 ) ) and L431: ( C117 -succ_of C118 ) = C119 by L425 , L7;
take C119;
thus L432: C116 = ( ( (R26 , C112) -admissible ) . ( C113 + 1 ) ) by L427;
thus L433: C119 = ( ( (R27 , C112) -admissible ) . ( C113 + 1 ) ) by L430;
thus L434: thesis by L414 , L424 , L426 , L428 , L429 , L431 , L390;
end;
end;
L436: ( Seg ( len C112 ) ) = ( dom C112 ) by FINSEQ_1:def 3;
L437: S8[ ( 0 ) ] by FINSEQ_1:1;
L438: (for B98 being (Element of ( NAT )) holds S8[ B98 ]) from NAT_1:sch 1(L437 , L413);
thus L439: thesis by L438 , L436;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
let C120 being Nat;
pred C120 -equivalent R26 , R27
means
:L440: (for R9 being (FinSequence of R5) holds (( len R9 ) <= C120 implies ( (R26 , R9) -response ) = ( (R27 , R9) -response )))
;end;
theorem
L442: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for B99 being Nat holds B99 -equivalent R26 , R26)))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let C121 being Nat;
let C122 being (FinSequence of R5);
assume L443: ( len C122 ) <= C121;
thus L444: thesis;
end;
theorem
L445: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R27 being (State of R16) holds (for B100 being Nat holds (B100 -equivalent R26 , R27 implies B100 -equivalent R27 , R26)))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
let C123 being Nat;
assume L446: C123 -equivalent R26 , R27;
thus L447: C123 -equivalent R27 , R26
proof
let C124 being (FinSequence of R5);
assume L448: ( len C124 ) <= C123;
thus L449: thesis by L448 , L446 , L440;
end;

end;
theorem
L448: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R27 being (State of R16) holds (for R28 being (State of R16) holds (for B101 being Nat holds ((B101 -equivalent R26 , R27 & B101 -equivalent R27 , R28) implies B101 -equivalent R26 , R28))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
let R28 being (State of R16);
let C125 being Nat;
assume that
L449: C125 -equivalent R26 , R27
and
L450: C125 -equivalent R27 , R28;
thus L451: C125 -equivalent R26 , R28
proof
let C126 being (FinSequence of R5);
assume L452: ( len C126 ) <= C125;
L453: ( (R26 , C126) -response ) = ( (R27 , C126) -response ) by L452 , L449 , L440;
thus L454: thesis by L453 , L450 , L452 , L440;
end;

end;
theorem
L452: (for R4 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R27 being (State of R16) holds (R26 , R27 -are_equivalent  implies R4 -equivalent R26 , R27)))))))
proof
let R4 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
assume L453: R26 , R27 -are_equivalent ;
thus L454: R4 -equivalent R26 , R27
proof
let C127 being (FinSequence of R5);
assume L455: ( len C127 ) <= R4;
thus L456: thesis by L453 , L332;
end;

end;
theorem
L455: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R27 being (State of R16) holds ( 0 ) -equivalent R26 , R27)))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
let C128 being (FinSequence of R5);
assume L456: ( len C128 ) <= ( 0 );
L457: C128 = ( <*> R5 ) by L456;
thus L458: ( (R26 , C128) -response ) = ( <*> R6 ) by L457 , L181
.= ( (R27 , C128) -response ) by L457 , L181;
end;
theorem
L459: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R27 being (State of R16) holds (for B102 , B103 being Nat holds (( B102 + B103 ) -equivalent R26 , R27 implies B102 -equivalent R26 , R27)))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
let C129 , C130 being Nat;
assume L460: ( C129 + C130 ) -equivalent R26 , R27;
let C131 being (FinSequence of R5);
L461: C129 <= ( C129 + C130 ) by NAT_1:11;
assume L462: ( len C131 ) <= C129;
L463: ( len C131 ) <= ( C129 + C130 ) by L462 , L461 , XXREAL_0:2;
thus L464: thesis by L463 , L460 , L440;
end;
theorem
L465: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R26 being (State of R16) holds (for R27 being (State of R16) holds (for B104 being Nat holds (1 <= B104 implies (B104 -equivalent R26 , R27 iff (1 -equivalent R26 , R27 & (for B105 being (Element of R5) holds (for B106 being (Element of ( NAT )) holds (B106 = ( B104 - 1 ) implies B106 -equivalent ( (the Tran of R16) . [ R26 , B105 ] ) , ( (the Tran of R16) . [ R27 , B105 ] )))))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R26 being (State of R16);
let R27 being (State of R16);
let C132 being Nat;
set D96 = (the OFun of R16);
assume L466: 1 <= C132;
thus L467:now
assume L468: C132 -equivalent R26 , R27;
thus L469: 1 -equivalent R26 , R27
proof
let C133 being (FinSequence of R5);
assume L470: ( len C133 ) <= 1;
L471: ( len C133 ) <= C132 by L470 , L466 , XXREAL_0:2;
thus L472: thesis by L471 , L468 , L440;
end;

let C134 being (Element of R5);
let C135 being (Element of ( NAT ));
assume that
L473: C135 = ( C132 - 1 );
set D97 = ( (the Tran of R16) . [ R27 , C134 ] );
set D98 = ( (the Tran of R16) . [ R26 , C134 ] );
thus L474: C135 -equivalent D98 , D97
proof
let C136 being (FinSequence of R5);
set D99 = ( <* C134 *> ^ C136 );
L475: ( len <* C134 *> ) = 1 by FINSEQ_1:40;
assume L476: ( len C136 ) <= C135;
L477: ( ( len C136 ) + 1 ) <= ( C135 + 1 ) by L476 , XREAL_1:7;
L478: ( len ( <* C134 *> ^ C136 ) ) = ( ( len <* C134 *> ) + ( len C136 ) ) by FINSEQ_1:22
.= ( 1 + ( len C136 ) ) by FINSEQ_1:40;
L479: ( (R26 , D99) -response ) = ( (R27 , D99) -response ) by L478 , L468 , L473 , L477 , L440;
L480: (( (R26 , D99) -response ) = ( <* ( D96 . [ R26 , C134 ] ) *> ^ ( (D98 , C136) -response ) ) & ( (R27 , D99) -response ) = ( <* ( D96 . [ R27 , C134 ] ) *> ^ ( (D97 , C136) -response ) )) by L362;
L481: ( ( 0 ) + 1 ) in ( Seg ( ( 0 ) + 1 ) ) by FINSEQ_1:4;
L482: 1 in ( dom <* C134 *> ) by L481 , L475 , FINSEQ_1:def 3;
L483: ( D96 . [ R26 , C134 ] ) = ( D96 . [ ( ( (R26 , <* C134 *>) -admissible ) . 1 ) , C134 ] ) by L7
.= ( D96 . [ ( ( (R26 , <* C134 *>) -admissible ) . 1 ) , ( <* C134 *> . 1 ) ] ) by FINSEQ_1:def 8
.= ( ( (R26 , <* C134 *>) -response ) . 1 ) by L482 , L150
.= ( ( (R27 , <* C134 *>) -response ) . 1 ) by L469 , L475 , L440
.= ( D96 . [ ( ( (R27 , <* C134 *>) -admissible ) . 1 ) , ( <* C134 *> . 1 ) ] ) by L482 , L150
.= ( D96 . [ ( ( (R27 , <* C134 *>) -admissible ) . 1 ) , C134 ] ) by FINSEQ_1:def 8
.= ( D96 . [ R27 , C134 ] ) by L7;
thus L484: thesis by L483 , L480 , L479 , FINSEQ_1:33;
end;

end;
assume that
L475: 1 -equivalent R26 , R27
and
L476: (for B107 being (Element of R5) holds (for B108 being (Element of ( NAT )) holds (B108 = ( C132 - 1 ) implies B108 -equivalent ( (the Tran of R16) . [ R26 , B107 ] ) , ( (the Tran of R16) . [ R27 , B107 ] ))));
thus L477: C132 -equivalent R26 , R27
proof
let C137 being (FinSequence of R5);
assume that
L478: ( len C137 ) <= C132;
per cases ;
suppose L479: C137 = ( <*> R5 );

thus L480: ( (R26 , C137) -response ) = ( <*> R6 ) by L479 , L181
.= ( (R27 , C137) -response ) by L479 , L181;
end;
suppose L481: C137 is non  empty;

consider C138 being (Element of R5), C139 being (FinSequence of R5) such that L482: C138 = ( C137 . 1 ) and L483: C137 = ( <* C138 *> ^ C139 ) by L481 , FINSEQ_3:102;
reconsider D100 = ( C132 - 1 ) as (Element of ( NAT )) by L466 , INT_1:5;
L484: ( len <* C138 *> ) = 1 by FINSEQ_1:40;
L485: ( len C137 ) = ( ( len <* C138 *> ) + ( len C139 ) ) by L483 , FINSEQ_1:22
.= ( ( len C139 ) + 1 ) by FINSEQ_1:40;
L486: ( ( ( len C139 ) + 1 ) - 1 ) <= D100 by L485 , L478 , XREAL_1:9;
L487: ( ( 0 ) + 1 ) in ( Seg ( ( 0 ) + 1 ) ) by FINSEQ_1:4;
L488: 1 in ( dom <* C138 *> ) by L487 , L484 , FINSEQ_1:def 3;
set D101 = ( (the Tran of R16) . [ R26 , C138 ] );
set D102 = ( (the Tran of R16) . [ R27 , C138 ] );
L489: (( (R26 , C137) -response ) = ( <* ( D96 . [ R26 , C138 ] ) *> ^ ( (D101 , C139) -response ) ) & ( (R27 , C137) -response ) = ( <* ( D96 . [ R27 , C138 ] ) *> ^ ( (D102 , C139) -response ) )) by L483 , L362;
L490: D100 -equivalent D101 , D102 by L476;
L491: ( D96 . [ R26 , C138 ] ) = ( D96 . [ ( ( (R26 , <* C138 *>) -admissible ) . 1 ) , C138 ] ) by L7
.= ( D96 . [ ( ( (R26 , <* C138 *>) -admissible ) . 1 ) , ( <* C138 *> . 1 ) ] ) by FINSEQ_1:def 8
.= ( ( (R26 , <* C138 *>) -response ) . 1 ) by L488 , L150
.= ( ( (R27 , <* C138 *>) -response ) . 1 ) by L475 , L484 , L440
.= ( D96 . [ ( ( (R27 , <* C138 *>) -admissible ) . 1 ) , ( <* C138 *> . 1 ) ] ) by L488 , L150
.= ( D96 . [ ( ( (R27 , <* C138 *>) -admissible ) . 1 ) , C138 ] ) by FINSEQ_1:def 8
.= ( D96 . [ R27 , C138 ] ) by L7;
thus L492: thesis by L491 , L489 , L490 , L486 , L440;
end;
end;

end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let C140 being Nat;
func C140 -eq_states_EqR R16 -> (Equivalence_Relation of (the carrier of R16)) means 
:L478: (for R26 being (State of R16) holds (for R27 being (State of R16) holds ([ R26 , R27 ] in it iff C140 -equivalent R26 , R27)));
existence
proof
set D103 = (the carrier of R16);
defpred S9[ set , set ] means (ex B109 , B110 being (Element of D103) st (B109 = $1 & B110 = $2 & C140 -equivalent B109 , B110));
L479: (for B111 , B112 being set holds (S9[ B111 , B112 ] implies S9[ B112 , B111 ])) by L445;
L480: (for B113 , B114 , B115 being set holds ((S9[ B113 , B114 ] & S9[ B114 , B115 ]) implies S9[ B113 , B115 ])) by L448;
L481: (for B116 being set holds (B116 in D103 implies S9[ B116 , B116 ])) by L442;
consider C141 being (Equivalence_Relation of D103) such that L482: (for B117 , B118 being set holds ([ B117 , B118 ] in C141 iff (B117 in D103 & B118 in D103 & S9[ B117 , B118 ]))) from EQREL_1:sch 1(L481 , L479 , L480);
take C141;
let C142 , C143 being (Element of D103);
thus L483:now
assume L484: [ C142 , C143 ] in C141;
L485: (ex B119 , B120 being (Element of D103) st (B119 = C142 & B120 = C143 & C140 -equivalent B119 , B120)) by L484 , L482;
thus L486: C140 -equivalent C142 , C143 by L485;
end;
assume L487: C140 -equivalent C142 , C143;
thus L488: thesis by L487 , L482;
end;
uniqueness
proof
set D104 = (the carrier of R16);
let C144 , C145 being (Equivalence_Relation of D104);
assume L489: (for B121 , B122 being (Element of D104) holds ([ B121 , B122 ] in C144 iff C140 -equivalent B121 , B122));
assume L490: (for B123 , B124 being (Element of D104) holds ([ B123 , B124 ] in C145 iff C140 -equivalent B123 , B124));
assume L491: C144 <> C145;
consider C146 being set such that L492: ((C146 in C144 & (not C146 in C145)) or (C146 in C145 & (not C146 in C144))) by L491 , TARSKI:1;
per cases  by L492;
suppose L493: (C146 in C144 & (not C146 in C145));

consider C147 , C148 being set such that L494: C146 = [ C147 , C148 ] and L495: (C147 in D104 & C148 in D104) by L493 , RELSET_1:2;
reconsider D105 = C147 , D106 = C148 as (Element of D104) by L495;
L496: C140 -equivalent D105 , D106 by L489 , L493 , L494;
thus L497: contradiction by L496 , L490 , L493 , L494;
end;
suppose L498: (C146 in C145 & (not C146 in C144));

consider C149 , C150 being set such that L499: C146 = [ C149 , C150 ] and L500: (C149 in D104 & C150 in D104) by L498 , RELSET_1:2;
reconsider D107 = C149 , D108 = C150 as (Element of D104) by L500;
L501: C140 -equivalent D107 , D108 by L490 , L498 , L499;
thus L502: contradiction by L501 , L489 , L498 , L499;
end;
end;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let C151 being non  empty Mealy-FSM over R5 , R6;
let C152 being Nat;
func C152 -eq_states_partition C151 -> non  empty (a_partition of (the carrier of C151)) equals 
( Class ( C152 -eq_states_EqR C151 ) );
coherence;
end;
theorem
L506: (for R4 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds ( ( R4 + 1 ) -eq_states_partition R16 ) is_finer_than ( R4 -eq_states_partition R16 )))))
proof
let R4 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
set D109 = ( R4 -eq_states_partition R16 );
set D110 = ( ( R4 + 1 ) -eq_states_partition R16 );
set D111 = (the carrier of R16);
let C153 being set;
assume L507: C153 in D110;
reconsider D112 = C153 as (Subset of D111) by L507;
consider C154 being (Element of D111) such that L508: C154 in C153 by L507 , FINSEQ_4:87;
reconsider D113 = ( ( proj D109 ) . C154 ) as (Element of D109);
take D113;
thus L509: D113 in D109;
let C155 being set;
assume L510: C155 in C153;
L511: C155 in D112 by L510;
reconsider D114 = C155 as (Element of D111) by L511;
reconsider D115 = D112 as (Element of ( Class ( ( R4 + 1 ) -eq_states_EqR R16 ) )) by L507;
consider C156 being set such that L512: C156 in D111 and L513: D115 = ( Class (( ( R4 + 1 ) -eq_states_EqR R16 ) , C156) ) by EQREL_1:def 3;
L514: [ D114 , C156 ] in ( ( R4 + 1 ) -eq_states_EqR R16 ) by L510 , L513 , EQREL_1:19;
L515: [ C156 , D114 ] in ( ( R4 + 1 ) -eq_states_EqR R16 ) by L514 , EQREL_1:6;
L516: [ C154 , C156 ] in ( ( R4 + 1 ) -eq_states_EqR R16 ) by L508 , L513 , EQREL_1:19;
L517: [ C154 , D114 ] in ( ( R4 + 1 ) -eq_states_EqR R16 ) by L516 , L515 , EQREL_1:7;
L518: ( R4 + 1 ) -equivalent C154 , D114 by L517 , L478;
L519: R4 -equivalent C154 , D114 by L518 , L459;
L520: [ C154 , D114 ] in ( R4 -eq_states_EqR R16 ) by L519 , L478;
L521: [ D114 , C154 ] in ( R4 -eq_states_EqR R16 ) by L520 , EQREL_1:6;
reconsider D116 = D113 as (Element of ( Class ( R4 -eq_states_EqR R16 ) ));
consider C157 being set such that L522: C157 in D111 and L523: D116 = ( Class (( R4 -eq_states_EqR R16 ) , C157) ) by EQREL_1:def 3;
reconsider D117 = C157 as (Element of D111) by L522;
L524: C154 in D113 by EQREL_1:def 9;
L525: ( Class (( R4 -eq_states_EqR R16 ) , D117) ) = ( Class (( R4 -eq_states_EqR R16 ) , C154) ) by L524 , L523 , EQREL_1:23;
thus L526: thesis by L525 , L521 , L523 , EQREL_1:19;
end;
theorem
L527: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for B125 being Nat holds (( Class ( B125 -eq_states_EqR R16 ) ) = ( Class ( ( B125 + 1 ) -eq_states_EqR R16 ) ) implies (for B126 being Nat holds ( Class ( ( B125 + B126 ) -eq_states_EqR R16 ) ) = ( Class ( B125 -eq_states_EqR R16 ) )))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let C158 being Nat;
set D118 = (the carrier of R16);
set D119 = ( Class ( C158 -eq_states_EqR R16 ) );
set D120 = ( C158 -eq_states_EqR R16 );
set D121 = ( Class ( ( C158 + 1 ) -eq_states_EqR R16 ) );
set D122 = ( ( C158 + 1 ) -eq_states_EqR R16 );
defpred S10[ Nat ] means ( Class ( ( C158 + $1 ) -eq_states_EqR R16 ) ) = D119;
assume L528: D119 = D121;
L529: D120 = D122 by L528 , FINSEQ_4:86;
L530: (for B127 being Nat holds (S10[ B127 ] implies S10[ ( B127 + 1 ) ]))
proof
let C159 being Nat;
set D123 = ( Class ( ( C158 + C159 ) -eq_states_EqR R16 ) );
set D124 = ( ( C158 + C159 ) -eq_states_EqR R16 );
set D125 = ( Class ( ( C158 + ( C159 + 1 ) ) -eq_states_EqR R16 ) );
set D126 = ( ( C158 + ( C159 + 1 ) ) -eq_states_EqR R16 );
assume L531: D123 = D119;
L532: D124 = D120 by L531 , FINSEQ_4:86;
L533:
now
let C160 being set;
thus L534:now
assume L535: C160 in D125;
reconsider D127 = C160 as (Subset of D118) by L535;
consider C161 being set such that L536: C161 in D118 and L537: D127 = ( Class (D126 , C161) ) by L535 , EQREL_1:def 3;
reconsider D128 = C161 as (Element of D118) by L536;
L538: D127 c= D118;
L539:
now
let C162 being set;
thus L540:now
assume L541: C162 in C160;
reconsider D129 = C162 as (Element of D118) by L541 , L538;
L542: [ C162 , D128 ] in D126 by L537 , L541 , EQREL_1:19;
L543: ( C158 + ( C159 + 1 ) ) -equivalent D129 , D128 by L542 , L478;
L544: C158 -equivalent D129 , D128 by L543 , L459;
L545: [ D129 , D128 ] in D120 by L544 , L478;
thus L546: C162 in ( Class (D120 , D128) ) by L545 , EQREL_1:19;
end;
assume L547: C162 in ( Class (D120 , D128) );
reconsider D130 = C162 as (Element of D118) by L547;
L548: [ D130 , D128 ] in D120 by L547 , EQREL_1:19;
L549: ( C158 + 1 ) -equivalent D130 , D128 by L548 , L529 , L478;
L550: 1 <= ( C158 + 1 ) by NAT_1:11;
L551:
now
let C163 being (Element of R5);
let C164 being (Element of ( NAT ));
set D131 = ( (the Tran of R16) . [ D130 , C163 ] );
set D132 = ( (the Tran of R16) . [ D128 , C163 ] );
L552: (C158 in ( NAT ) & C158 = ( ( C158 + 1 ) - 1 )) by ORDINAL1:def 12;
L553: C158 -equivalent D131 , D132 by L552 , L549 , L550 , L465;
L554: [ D131 , D132 ] in D120 by L553 , L478;
assume L555: C164 = ( ( ( C158 + C159 ) + 1 ) - 1 );
thus L556: C164 -equivalent D131 , D132 by L555 , L532 , L554 , L478;
end;
L557: (1 <= ( ( C158 + C159 ) + 1 ) & 1 -equivalent D130 , D128) by L549 , L550 , L465 , NAT_1:11;
L558: ( ( C158 + C159 ) + 1 ) -equivalent D130 , D128 by L557 , L551 , L465;
L559: [ D130 , D128 ] in D126 by L558 , L478;
thus L560: C162 in C160 by L559 , L537 , EQREL_1:19;
end;
L561: C160 = ( Class (D120 , D128) ) by L539 , TARSKI:1;
thus L562: C160 in D119 by L561 , EQREL_1:def 3;
end;
assume L563: C160 in D119;
reconsider D133 = C160 as (Subset of D118) by L563;
consider C165 being set such that L564: C165 in D118 and L565: D133 = ( Class (D120 , C165) ) by L563 , EQREL_1:def 3;
reconsider D134 = C165 as (Element of D118) by L564;
L566:
now
let C166 being set;
thus L567:now
assume L568: C166 in C160;
reconsider D135 = C166 as (Element of D118) by L568 , L565;
L569: [ D135 , D134 ] in D120 by L565 , L568 , EQREL_1:19;
L570: ( C158 + 1 ) -equivalent D135 , D134 by L569 , L529 , L478;
L571: 1 <= ( C158 + 1 ) by NAT_1:11;
L572:
now
let C167 being (Element of R5);
let C168 being (Element of ( NAT ));
set D136 = ( (the Tran of R16) . [ D135 , C167 ] );
set D137 = ( (the Tran of R16) . [ D134 , C167 ] );
L573: (C158 in ( NAT ) & C158 = ( ( C158 + 1 ) - 1 )) by ORDINAL1:def 12;
L574: C158 -equivalent D136 , D137 by L573 , L570 , L571 , L465;
L575: [ D136 , D137 ] in D120 by L574 , L478;
assume L576: C168 = ( ( ( C158 + C159 ) + 1 ) - 1 );
thus L577: C168 -equivalent D136 , D137 by L576 , L532 , L575 , L478;
end;
L578: (1 <= ( ( C158 + C159 ) + 1 ) & 1 -equivalent D135 , D134) by L570 , L571 , L465 , NAT_1:11;
L579: ( ( C158 + C159 ) + 1 ) -equivalent D135 , D134 by L578 , L572 , L465;
L580: [ D135 , D134 ] in D126 by L579 , L478;
thus L581: C166 in ( Class (D126 , D134) ) by L580 , EQREL_1:19;
end;
assume L582: C166 in ( Class (D126 , D134) );
reconsider D138 = C166 as (Element of D118) by L582;
L583: [ C166 , D134 ] in D126 by L582 , EQREL_1:19;
L584: ( C158 + ( C159 + 1 ) ) -equivalent D138 , D134 by L583 , L478;
L585: C158 -equivalent D138 , D134 by L584 , L459;
L586: [ D138 , D134 ] in D120 by L585 , L478;
thus L587: C166 in C160 by L586 , L565 , EQREL_1:19;
end;
L588: C160 = ( Class (D126 , D134) ) by L566 , TARSKI:1;
thus L589: C160 in D125 by L588 , EQREL_1:def 3;
end;
thus L590: D125 = D119 by L533 , TARSKI:1;
end;
L591: S10[ ( 0 ) ];
thus L592: (for B128 being Nat holds S10[ B128 ]) from NAT_1:sch 2(L591 , L530);
end;
theorem
L593: (for R4 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (( R4 -eq_states_partition R16 ) = ( ( R4 + 1 ) -eq_states_partition R16 ) implies (for R1 being (Element of ( NAT )) holds ( ( R4 + R1 ) -eq_states_partition R16 ) = ( R4 -eq_states_partition R16 ))))))) by L527;
theorem
L594: (for R4 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (( ( R4 + 1 ) -eq_states_partition R16 ) <> ( R4 -eq_states_partition R16 ) implies (for R3 being (Element of ( NAT )) holds (R3 <= R4 implies ( ( R3 + 1 ) -eq_states_partition R16 ) <> ( R3 -eq_states_partition R16 ))))))))
proof
let R4 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
assume L595: ( ( R4 + 1 ) -eq_states_partition R16 ) <> ( R4 -eq_states_partition R16 );
let C169 being (Element of ( NAT ));
assume that
L596: C169 <= R4;
L597: (ex B129 being Nat st ( R4 + 1 ) = ( C169 + B129 )) by L596 , NAT_1:10 , NAT_1:12;
assume L598: ( ( C169 + 1 ) -eq_states_partition R16 ) = ( C169 -eq_states_partition R16 );
L599: (ex B130 being Nat st R4 = ( C169 + B130 )) by L596 , NAT_1:10;
L600: ( R4 -eq_states_partition R16 ) = ( C169 -eq_states_partition R16 ) by L599 , L598 , L527;
thus L601: contradiction by L600 , L595 , L598 , L597 , L527;
end;
theorem
L602: (for R4 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for B131 being  finite non  empty Mealy-FSM over R5 , R6 holds (( R4 -eq_states_partition B131 ) = ( ( R4 + 1 ) -eq_states_partition B131 ) or ( card ( R4 -eq_states_partition B131 ) ) < ( card ( ( R4 + 1 ) -eq_states_partition B131 ) ))))))
proof
let R4 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let C170 being  finite non  empty Mealy-FSM over R5 , R6;
set D139 = ( R4 -eq_states_partition C170 );
set D140 = ( ( R4 + 1 ) -eq_states_partition C170 );
L603: ( card D139 ) <= ( card D140 ) by L506 , FINSEQ_4:89;
L604: (( card D139 ) = ( card D140 ) or ( card D139 ) < ( card D140 )) by L603 , XXREAL_0:1;
assume L605: D139 <> D140;
thus L606: thesis by L605 , L604 , L506 , FINSEQ_4:91;
end;
theorem
L607: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (for R22 being (State of R16) holds ( Class (( ( 0 ) -eq_states_EqR R16 ) , R22) ) = (the carrier of R16)))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
let R22 being (State of R16);
set D141 = ( ( 0 ) -eq_states_EqR R16 );
set D142 = (the carrier of R16);
L608:
now
let C171 being set;
thus L609: (C171 in ( Class (D141 , R22) ) implies C171 in D142);
assume L610: C171 in D142;
reconsider D143 = C171 as (Element of D142) by L610;
L611: ( 0 ) -equivalent D143 , R22 by L455;
L612: [ C171 , R22 ] in D141 by L611 , L478;
thus L613: C171 in ( Class (D141 , R22) ) by L612 , EQREL_1:19;
end;
thus L614: thesis by L608 , TARSKI:1;
end;
theorem
L615: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds ( ( 0 ) -eq_states_partition R16 ) = { (the carrier of R16) })))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
set D144 = (the carrier of R16);
set D145 = { (the carrier of R16) };
set D146 = ( ( 0 ) -eq_states_partition R16 );
set D147 = ( ( 0 ) -eq_states_EqR R16 );
L616:
now
set D148 = the (Element of D144);
let C172 being set;
thus L617:now
assume L618: C172 in D146;
reconsider D149 = C172 as (Subset of D144) by L618;
consider C173 being set such that L619: C173 in D144 and L620: D149 = ( Class (D147 , C173) ) by L618 , EQREL_1:def 3;
reconsider D150 = C173 as (Element of D144) by L619;
L621: ( Class (D147 , D150) ) = D144 by L607;
thus L622: C172 in D145 by L621 , L620 , TARSKI:def 1;
end;
assume L623: C172 in D145;
L624: C172 = D144 by L623 , TARSKI:def 1;
L625: ( Class (D147 , D148) ) in ( Class D147 ) by EQREL_1:def 3;
thus L626: C172 in D146 by L625 , L624 , L607;
end;
thus L627: thesis by L616 , TARSKI:1;
end;
theorem
L628: (for R2 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for B132 being  finite non  empty Mealy-FSM over R5 , R6 holds (( R2 + 1 ) = ( card (the carrier of B132) ) implies ( ( R2 + 1 ) -eq_states_partition B132 ) = ( R2 -eq_states_partition B132 ))))))
proof
let R2 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let C174 being  finite non  empty Mealy-FSM over R5 , R6;
assume L629: ( R2 + 1 ) = ( card (the carrier of C174) );
defpred S11[ (Element of ( NAT )) ] means ($1 <= ( R2 + 1 ) implies ( card ( $1 -eq_states_partition C174 ) ) > $1);
assume L630: ( ( R2 + 1 ) -eq_states_partition C174 ) <> ( R2 -eq_states_partition C174 );
L631: (for B133 being (Element of ( NAT )) holds (S11[ B133 ] implies S11[ ( B133 + 1 ) ]))
proof
let C175 being (Element of ( NAT ));
assume L632: (C175 <= ( R2 + 1 ) implies ( card ( C175 -eq_states_partition C174 ) ) > C175);
assume L633: ( C175 + 1 ) <= ( R2 + 1 );
L634: C175 <= R2 by L633 , XREAL_1:6;
L635: ( ( C175 + 1 ) -eq_states_partition C174 ) <> ( C175 -eq_states_partition C174 ) by L634 , L630 , L594;
L636: ( C175 + 1 ) <= ( card ( C175 -eq_states_partition C174 ) ) by L632 , L633 , NAT_1:13;
thus L637: thesis by L636 , L635 , L602 , XXREAL_0:2;
end;
L638: S11[ ( 0 ) ];
L639: (for B134 being (Element of ( NAT )) holds S11[ B134 ]) from NAT_1:sch 1(L638 , L631);
L640: ( card ( ( R2 + 1 ) -eq_states_partition C174 ) ) > ( R2 + 1 ) by L639;
thus L641: contradiction by L640 , L629 , FINSEQ_4:88;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let C176 being non  empty Mealy-FSM over R5 , R6;
let C177 being (a_partition of (the carrier of C176));
attr C177 is  final
means
:L642: (for B135 , B136 being (State of C176) holds (B135 , B136 -are_equivalent  iff (ex B137 being (Element of C177) st (B135 in B137 & B136 in B137))));
end;
theorem
L644: (for R4 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (( R4 -eq_states_partition R16 ) is  final implies ( ( R4 + 1 ) -eq_states_EqR R16 ) = ( R4 -eq_states_EqR R16 ))))))
proof
let R4 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
set D151 = (the carrier of R16);
set D152 = ( R4 -eq_states_EqR R16 );
set D153 = ( ( R4 + 1 ) -eq_states_EqR R16 );
set D154 = ( R4 -eq_states_partition R16 );
assume L645: ( R4 -eq_states_partition R16 ) is  final;
L646:
now
let C178 being set;
thus L647:now
assume L648: C178 in D153;
consider C179 , C180 being set such that L649: C178 = [ C179 , C180 ] and L650: C179 in D151 and L651: C180 in D151 by L648 , RELSET_1:2;
reconsider D155 = C180 as (Element of D151) by L651;
reconsider D156 = C179 as (Element of D151) by L650;
L652: ( R4 + 1 ) -equivalent D156 , D155 by L648 , L649 , L478;
L653: R4 -equivalent D156 , D155 by L652 , L459;
thus L654: C178 in D152 by L653 , L649 , L478;
end;
assume L655: C178 in D152;
consider C181 , C182 being set such that L656: C178 = [ C181 , C182 ] and L657: C181 in D151 and L658: C182 in D151 by L655 , RELSET_1:2;
reconsider D157 = C182 as (Element of D151) by L658;
reconsider D158 = C181 as (Element of D151) by L657;
reconsider D159 = ( Class (D152 , D157) ) as (Element of D154) by EQREL_1:def 3;
L659: D157 in D159 by EQREL_1:20;
L660: D158 in D159 by L655 , L656 , EQREL_1:19;
L661: D158 , D157 -are_equivalent  by L660 , L645 , L659 , L642;
L662: ( R4 + 1 ) -equivalent D158 , D157 by L661 , L452;
thus L663: C178 in D153 by L662 , L656 , L478;
end;
thus L664: thesis by L646 , TARSKI:1;
end;
theorem
L665: (for R4 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for R16 being non  empty Mealy-FSM over R5 , R6 holds (( R4 -eq_states_partition R16 ) = ( ( R4 + 1 ) -eq_states_partition R16 ) implies ( R4 -eq_states_partition R16 ) is  final)))))
proof
let R4 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let R16 being non  empty Mealy-FSM over R5 , R6;
set D160 = (the carrier of R16);
set D161 = ( R4 -eq_states_partition R16 );
set D162 = ( ( R4 + 1 ) -eq_states_partition R16 );
set D163 = ( R4 -eq_states_EqR R16 );
assume L666: D161 = D162;
L667:
now
let C183 , C184 being (Element of R16);
thus L668:now
reconsider D164 = ( Class (D163 , C184) ) as (Element of D161) by EQREL_1:def 3;
assume L669: C183 , C184 -are_equivalent ;
take D165 = D164;
L670: R4 -equivalent C183 , C184 by L669 , L452;
L671: [ C183 , C184 ] in D163 by L670 , L478;
thus L672: (C183 in D165 & C184 in D165) by L671 , EQREL_1:19 , EQREL_1:20;
end;
given C185 being (Element of D161) such that
L673: C183 in C185
and
L674: C184 in C185;

consider C186 being set such that L675: C186 in D160 and L676: C185 = ( Class (D163 , C186) ) by EQREL_1:def 3;
L677: [ C184 , C186 ] in D163 by L674 , L676 , EQREL_1:19;
L678: [ C186 , C184 ] in D163 by L677 , EQREL_1:6;
L679: [ C183 , C186 ] in D163 by L673 , L676 , EQREL_1:19;
L680: [ C183 , C184 ] in D163 by L679 , L678 , EQREL_1:7;
L681: R4 -equivalent C183 , C184 by L680 , L478;
thus L682: C183 , C184 -are_equivalent 
proof
let C187 being (FinSequence of R5);
consider C188 being Nat such that L683: ( dom C187 ) = ( Seg C188 ) by FINSEQ_1:def 2;
L684: C188 in ( NAT ) by ORDINAL1:def 12;
L685: C188 = ( len C187 ) by L684 , L683 , FINSEQ_1:def 3;
per cases ;
suppose L686: C188 <= R4;

thus L687: thesis by L686 , L681 , L685 , L440;
end;
suppose L688: C188 > R4;

L689: (ex B138 being (Element of ( NAT )) st (C188 = ( R4 + B138 ) & 1 <= B138)) by L688 , FINSEQ_4:84;
L690: ( C188 -eq_states_partition R16 ) = D161 by L689 , L666 , L527;
L691: [ C183 , C184 ] in ( C188 -eq_states_EqR R16 ) by L690 , L680 , FINSEQ_4:86;
L692: C188 -equivalent C183 , C184 by L691 , L478;
thus L693: thesis by L692 , L685 , L440;
end;
end;

end;
thus L683: thesis by L667 , L642;
end;
theorem
L684: (for R2 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for B139 being  finite non  empty Mealy-FSM over R5 , R6 holds (( R2 + 1 ) = ( card (the carrier of B139) ) implies (ex B140 being (Element of ( NAT )) st (B140 <= R2 & ( B140 -eq_states_partition B139 ) is  final)))))))
proof
let R2 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let C189 being  finite non  empty Mealy-FSM over R5 , R6;
assume L685: ( R2 + 1 ) = ( card (the carrier of C189) );
take R2;
thus L686: R2 <= R2;
L687: ( R2 -eq_states_partition C189 ) = ( ( R2 + 1 ) -eq_states_partition C189 ) by L685 , L628;
thus L688: thesis by L687 , L665;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let C190 being  finite non  empty Mealy-FSM over R5 , R6;
func final_states_partition C190 -> (a_partition of (the carrier of C190)) means 
:L689: it is  final;
existence
proof
reconsider D166 = ( card (the carrier of C190) ) as (Element of ( NAT ));
consider C191 being Nat such that L690: D166 = ( C191 + 1 ) by NAT_1:6;
reconsider D167 = C191 as (Element of ( NAT )) by ORDINAL1:def 12;
take ( D167 -eq_states_partition C190 );
L691: ( D167 -eq_states_partition C190 ) = ( ( D167 + 1 ) -eq_states_partition C190 ) by L690 , L628;
thus L692: thesis by L691 , L665;
end;
uniqueness
proof
let C192 , C193 being (a_partition of (the carrier of C190));
assume that
L693: C192 is  final
and
L694: C193 is  final;
L695:
now
assume L696: C192 <> C193;
L697: (not (for B141 being set holds (B141 in C192 iff B141 in C193))) by L696 , TARSKI:1;
consider C194 being set such that L698: ((C194 in C192 & (not C194 in C193)) or ((not C194 in C192) & C194 in C193)) by L697;
per cases  by L698;
suppose L699: (C194 in C192 & (not C194 in C193));

reconsider D168 = C194 as (Subset of C190) by L699;
consider C195 being (Element of C190) such that L700: C195 in D168 by L699 , FINSEQ_4:87;
L701: ( union C193 ) = (the carrier of C190) by EQREL_1:def 4;
consider C196 being set such that L702: C195 in C196 and L703: C196 in C193 by L701 , TARSKI:def 4;
reconsider D169 = C196 as (Subset of C190) by L703;
set D170 = ( D168 \ D169 );
set D171 = ( D169 \ D168 );
set D172 = ( D170 \/ D171 );
L704: D172 <> ( {} )
proof
assume L705: D172 = ( {} );
L706: ( D169 \ D168 ) = ( {} ) by L705;
L707: D169 c= D168 by L706 , XBOOLE_1:37;
L708: ( D168 \ D169 ) = ( {} ) by L705;
L709: D168 c= D169 by L708 , XBOOLE_1:37;
thus L710: contradiction by L709 , L699 , L703 , L707 , XBOOLE_0:def 10;
end;
consider C197 being (Element of C190) such that L711: C197 in D172 by L704 , SUBSET_1:4;
reconsider D173 = D168 as (Element of C192) by L699;
L712:
now
assume L713: C197 in ( D169 \ D173 );
L714: (not C195 , C197 -are_equivalent )
proof
assume L715: C195 , C197 -are_equivalent ;
consider C198 being (Element of C192) such that L716: C195 in C198 and L717: C197 in C198 by L715 , L693 , L642;
per cases ;
suppose L718: D173 = C198;

thus L719: contradiction by L718 , L713 , L717 , XBOOLE_0:def 5;
end;
suppose L720: D173 <> C198;

L721: D173 misses C198 by L720 , EQREL_1:def 4;
L722: ( D173 /\ C198 ) = ( {} ) by L721 , XBOOLE_0:def 7;
thus L723: contradiction by L722 , L700 , L716 , XBOOLE_0:def 4;
end;
end;
L725: C197 in D169 by L713 , XBOOLE_0:def 5;
thus L726: contradiction by L725 , L694 , L702 , L703 , L714 , L642;
end;
L727:
now
assume L728: C197 in ( D173 \ D169 );
L729: (not C195 , C197 -are_equivalent )
proof
assume L730: C195 , C197 -are_equivalent ;
consider C199 being (Element of C193) such that L731: C195 in C199 and L732: C197 in C199 by L730 , L694 , L642;
per cases ;
suppose L733: D169 = C199;

thus L734: contradiction by L733 , L728 , L732 , XBOOLE_0:def 5;
end;
suppose L735: D169 <> C199;

L736: D169 misses C199 by L735 , L703 , EQREL_1:def 4;
L737: ( D169 /\ C199 ) = ( {} ) by L736 , XBOOLE_0:def 7;
thus L738: contradiction by L737 , L702 , L731 , XBOOLE_0:def 4;
end;
end;
L740: C197 in D173 by L728 , XBOOLE_0:def 5;
thus L741: contradiction by L740 , L693 , L700 , L729 , L642;
end;
thus L742: contradiction by L727 , L711 , L712 , XBOOLE_0:def 3;
end;
suppose L743: ((not C194 in C192) & C194 in C193);

reconsider D174 = C194 as (Subset of C190) by L743;
consider C200 being (Element of C190) such that L744: C200 in D174 by L743 , FINSEQ_4:87;
L745: ( union C192 ) = (the carrier of C190) by EQREL_1:def 4;
consider C201 being set such that L746: C200 in C201 and L747: C201 in C192 by L745 , TARSKI:def 4;
reconsider D175 = C201 as (Subset of C190) by L747;
set D176 = ( D174 \ D175 );
set D177 = ( D175 \ D174 );
set D178 = ( D176 \/ D177 );
L748: D178 <> ( {} )
proof
assume L749: D178 = ( {} );
L750: ( D175 \ D174 ) = ( {} ) by L749;
L751: D175 c= D174 by L750 , XBOOLE_1:37;
L752: ( D174 \ D175 ) = ( {} ) by L749;
L753: D174 c= D175 by L752 , XBOOLE_1:37;
thus L754: contradiction by L753 , L743 , L747 , L751 , XBOOLE_0:def 10;
end;
consider C202 being (Element of C190) such that L755: C202 in D178 by L748 , SUBSET_1:4;
reconsider D179 = D174 as (Element of C193) by L743;
L756:
now
assume L757: C202 in ( D175 \ D179 );
L758: (not C200 , C202 -are_equivalent )
proof
assume L759: C200 , C202 -are_equivalent ;
consider C203 being (Element of C193) such that L760: C200 in C203 and L761: C202 in C203 by L759 , L694 , L642;
per cases ;
suppose L762: D179 = C203;

thus L763: contradiction by L762 , L757 , L761 , XBOOLE_0:def 5;
end;
suppose L764: D179 <> C203;

L765: D179 misses C203 by L764 , EQREL_1:def 4;
L766: ( D179 /\ C203 ) = ( {} ) by L765 , XBOOLE_0:def 7;
thus L767: contradiction by L766 , L744 , L760 , XBOOLE_0:def 4;
end;
end;
L769: C202 in D175 by L757 , XBOOLE_0:def 5;
thus L770: contradiction by L769 , L693 , L746 , L747 , L758 , L642;
end;
L771:
now
assume L772: C202 in ( D179 \ D175 );
L773: (not C200 , C202 -are_equivalent )
proof
assume L774: C200 , C202 -are_equivalent ;
consider C204 being (Element of C192) such that L775: C200 in C204 and L776: C202 in C204 by L774 , L693 , L642;
per cases ;
suppose L777: D175 = C204;

thus L778: contradiction by L777 , L772 , L776 , XBOOLE_0:def 5;
end;
suppose L779: D175 <> C204;

L780: D175 misses C204 by L779 , L747 , EQREL_1:def 4;
L781: ( D175 /\ C204 ) = ( {} ) by L780 , XBOOLE_0:def 7;
thus L782: contradiction by L781 , L746 , L775 , XBOOLE_0:def 4;
end;
end;
L784: C202 in D179 by L772 , XBOOLE_0:def 5;
thus L785: contradiction by L784 , L694 , L744 , L773 , L642;
end;
thus L786: contradiction by L771 , L755 , L756 , XBOOLE_0:def 3;
end;
end;
thus L788: thesis by L695;
end;
end;
theorem
L790: (for R2 being (Element of ( NAT )) holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for B142 being  finite non  empty Mealy-FSM over R5 , R6 holds (( R2 + 1 ) = ( card (the carrier of B142) ) implies ( final_states_partition B142 ) = ( R2 -eq_states_partition B142 ))))))
proof
let R2 being (Element of ( NAT ));
let R5 being non  empty set;
let R6 being non  empty set;
let C205 being  finite non  empty Mealy-FSM over R5 , R6;
assume L791: ( R2 + 1 ) = ( card (the carrier of C205) );
L792: ( ( R2 + 1 ) -eq_states_partition C205 ) = ( R2 -eq_states_partition C205 ) by L791 , L628;
L793: ( R2 -eq_states_partition C205 ) is  final by L792 , L665;
thus L794: thesis by L793 , L689;
end;
begin
definition
let C206 , C207 being non  empty set;
let C208 being  finite non  empty Mealy-FSM over C206 , C207;
let C209 being (Element of ( final_states_partition C208 ));
let C210 being (Element of C206);
func (C210 , C209) -succ_class -> (Element of ( final_states_partition C208 )) means 
:L795: (ex B143 being (State of C208) st (ex B144 being (Element of ( NAT )) st (B143 in C209 & ( B144 + 1 ) = ( card (the carrier of C208) ) & it = ( Class (( B144 -eq_states_EqR C208 ) , ( (the Tran of C208) . [ B143 , C210 ] )) ))));
existence
proof
consider C211 being (Element of C208) such that L796: C211 in C209 by FINSEQ_4:87;
set D180 = ( (the Tran of C208) . [ C211 , C210 ] );
set D181 = ( card (the carrier of C208) );
consider C212 being Nat such that L797: D181 = ( C212 + 1 ) by NAT_1:6;
reconsider D182 = C212 as (Element of ( NAT )) by ORDINAL1:def 12;
L798: ( final_states_partition C208 ) = ( D182 -eq_states_partition C208 ) by L797 , L790;
reconsider D183 = ( Class (( D182 -eq_states_EqR C208 ) , D180) ) as (Element of ( final_states_partition C208 )) by L798 , EQREL_1:def 3;
take D183;
thus L799: thesis by L797 , L796;
end;
uniqueness
proof
let C213 , C214 being (Element of ( final_states_partition C208 ));
given C215 being (Element of C208) , C216 being (Element of ( NAT )) such that
L800: C215 in C209
and
L801: (( C216 + 1 ) = ( card (the carrier of C208) ) & C213 = ( Class (( C216 -eq_states_EqR C208 ) , ( (the Tran of C208) . [ C215 , C210 ] )) ));

set D184 = ( (the Tran of C208) . [ C215 , C210 ] );
set D185 = ( C216 + 1 );
given C217 being (Element of C208) , C218 being (Element of ( NAT )) such that
L802: C217 in C209
and
L803: (( C218 + 1 ) = ( card (the carrier of C208) ) & C214 = ( Class (( C218 -eq_states_EqR C208 ) , ( (the Tran of C208) . [ C217 , C210 ] )) ));

set D186 = ( (the Tran of C208) . [ C217 , C210 ] );
L804: (1 <= D185 & C216 = ( D185 - 1 )) by INT_1:6;
L805: ( final_states_partition C208 ) is  final by L689;
L806: C215 , C217 -are_equivalent  by L805 , L800 , L802 , L642;
L807: D185 -equivalent C215 , C217 by L806 , L452;
L808: C216 -equivalent D184 , D186 by L807 , L804 , L465;
L809: [ D184 , D186 ] in ( C216 -eq_states_EqR C208 ) by L808 , L478;
thus L810: thesis by L809 , L801 , L803 , EQREL_1:35;
end;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let C219 being (Element of ( final_states_partition R40 ));
let R8 being (Element of R5);
func (C219 , R8) -class_response -> (Element of R6) means 
:L812: (ex R42 being (State of R40) st (R42 in C219 & it = ( (the OFun of R40) . [ R42 , R8 ] )));
existence
proof
consider C220 being (Element of R40) such that L813: C220 in C219 by FINSEQ_4:87;
take ( (the OFun of R40) . [ C220 , R8 ] );
thus L814: thesis by L813;
end;
uniqueness
proof
let C221 , C222 being (Element of R6);
given C223 being (Element of R40) such that
L815: C223 in C219
and
L816: C221 = ( (the OFun of R40) . [ C223 , R8 ] );

given C224 being (Element of R40) such that
L817: C224 in C219
and
L818: C222 = ( (the OFun of R40) . [ C224 , R8 ] );

L819: ( final_states_partition R40 ) is  final by L689;
L820: C223 , C224 -are_equivalent  by L819 , L815 , L817 , L642;
thus L821: thesis by L820 , L816 , L818 , L390;
end;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
func the_reduction_of R40 ->  strict Mealy-FSM over R5 , R6 means 
:L823: ((the carrier of it) = ( final_states_partition R40 ) & (for B145 being (State of it) holds (for R8 being (Element of R5) holds (for B146 being (State of R40) holds (B146 in B145 implies (( (the Tran of R40) . (B146 , R8) ) in ( (the Tran of it) . (B145 , R8) ) & ( (the OFun of R40) . (B146 , R8) ) = ( (the OFun of it) . (B145 , R8) )))))) & (the InitS of R40) in (the InitS of it));
existence
proof
set D187 = ( final_states_partition R40 );
reconsider D188 = ( card (the carrier of R40) ) as (Element of ( NAT ));
set D189 = (the Tran of R40);
consider C225 being Nat such that L824: D188 = ( C225 + 1 ) by NAT_1:6;
reconsider D190 = C225 as (Element of ( NAT )) by ORDINAL1:def 12;
set D191 = ( Class (( D190 -eq_states_EqR R40 ) , (the InitS of R40)) );
L825: D187 = ( D190 -eq_states_partition R40 ) by L824 , L790;
reconsider D192 = D191 as (Element of D187) by L825 , EQREL_1:def 3;
deffunc H6((Element of D187) , (Element of R5)) = ( ($2 , $1) -succ_class );
consider C226 being (Function of [: D187 , R5 :] , D187) such that L826: (for B147 being (Element of D187) holds (for B148 being (Element of R5) holds ( C226 . (B147 , B148) ) = H6(B147 , B148))) from BINOP_1:sch 4;
deffunc H7((Element of D187) , (Element of R5)) = ( ($1 , $2) -class_response );
consider C227 being (Function of [: D187 , R5 :] , R6) such that L827: (for B149 being (Element of D187) holds (for B150 being (Element of R5) holds ( C227 . (B149 , B150) ) = H7(B149 , B150))) from BINOP_1:sch 4;
take D193 = Mealy-FSM (# ( final_states_partition R40 ) , C226 , C227 , D192 #);
L828:
now
reconsider D194 = 1 as Integer;
let C228 being (Element of D193);
let R8 being (Element of R5);
let R42 being (State of R40);
assume that
L829: R42 in C228;
reconsider D195 = R8 as (Element of R5);
reconsider D196 = C228 as (Element of ( final_states_partition R40 ));
consider C229 being (Element of R40), C230 being (Element of ( NAT )) such that L830: C229 in D196 and L831: ( C230 + 1 ) = ( card (the carrier of R40) ) and L832: ( (D195 , D196) -succ_class ) = ( Class (( C230 -eq_states_EqR R40 ) , ( D189 . [ C229 , D195 ] )) ) by L795;
L833: ( final_states_partition R40 ) is  final by L689;
L834: R42 , C229 -are_equivalent  by L833 , L829 , L830 , L642;
L835: ( C230 + 1 ) -equivalent R42 , C229 by L834 , L452;
reconsider D197 = C230 as Integer;
L836: (1 <= ( C230 + 1 ) & ( ( D197 + D194 ) - D194 ) = D197) by NAT_1:11;
L837: C230 -equivalent ( D189 . [ R42 , D195 ] ) , ( D189 . [ C229 , D195 ] ) by L836 , L835 , L465;
L838: [ ( D189 . [ R42 , D195 ] ) , ( D189 . [ C229 , D195 ] ) ] in ( C230 -eq_states_EqR R40 ) by L837 , L478;
L839: ( (the Tran of D193) . (D196 , D195) ) = ( Class (( C230 -eq_states_EqR R40 ) , ( D189 . (C229 , D195) )) ) by L826 , L832;
thus L840: ( D189 . [ R42 , R8 ] ) in ( (the Tran of D193) . (C228 , R8) ) by L839 , L838 , EQREL_1:19;
L841: ( (the OFun of D193) . (D196 , D195) ) = ( (D196 , D195) -class_response ) by L827;
consider C231 being (Element of R40) such that L842: C231 in D196 and L843: ( (D196 , D195) -class_response ) = ( (the OFun of R40) . [ C231 , D195 ] ) by L812;
L844: ( final_states_partition R40 ) is  final by L689;
L845: R42 , C231 -are_equivalent  by L844 , L829 , L842 , L642;
thus L846: ( (the OFun of R40) . [ R42 , R8 ] ) = ( (the OFun of D193) . [ C228 , R8 ] ) by L845 , L841 , L843 , L390;
end;
thus L847: thesis by L828 , EQREL_1:20;
end;
uniqueness
proof
let C232 , C233 being  strict Mealy-FSM over R5 , R6;
set D198 = (the Tran of R40);
assume that
L848: (the carrier of C232) = ( final_states_partition R40 )
and
L849: (for B151 being (Element of C232) holds (for R8 being (Element of R5) holds (for R42 being (State of R40) holds (R42 in B151 implies (( D198 . (R42 , R8) ) in ( (the Tran of C232) . (B151 , R8) ) & ( (the OFun of R40) . (R42 , R8) ) = ( (the OFun of C232) . (B151 , R8) ))))))
and
L850: (the InitS of R40) in (the InitS of C232);
assume that
L851: (the carrier of C233) = ( final_states_partition R40 )
and
L852: (for B152 being (Element of C233) holds (for R8 being (Element of R5) holds (for R42 being (State of R40) holds (R42 in B152 implies (( D198 . (R42 , R8) ) in ( (the Tran of C233) . (B152 , R8) ) & ( (the OFun of R40) . (R42 , R8) ) = ( (the OFun of C233) . (B152 , R8) ))))))
and
L853: (the InitS of R40) in (the InitS of C233);
L854: (the OFun of C232) = (the OFun of C233)
proof
reconsider D199 = (the OFun of C233) as (Function of [: ( final_states_partition R40 ) , R5 :] , R6) by L851;
reconsider D200 = (the OFun of C232) as (Function of [: ( final_states_partition R40 ) , R5 :] , R6) by L848;
L855:
now
let C234 being (Element of ( final_states_partition R40 ));
let R8 being (Element of R5);
consider C235 being (Element of R40) such that L856: C235 in C234 by FINSEQ_4:87;
thus L857: ( D200 . (C234 , R8) ) = ( (the OFun of R40) . (C235 , R8) ) by L848 , L849 , L856
.= ( D199 . (C234 , R8) ) by L851 , L852 , L856;
end;
thus L858: thesis by L855 , BINOP_1:2;
end;
L859: (the Tran of C232) = (the Tran of C233)
proof
reconsider D201 = (the Tran of C233) as (Function of [: ( final_states_partition R40 ) , R5 :] , ( final_states_partition R40 )) by L851;
reconsider D202 = (the Tran of C232) as (Function of [: ( final_states_partition R40 ) , R5 :] , ( final_states_partition R40 )) by L848;
L860:
now
let C236 being (Element of ( final_states_partition R40 ));
let R8 being (Element of R5);
reconsider D203 = ( D202 . [ C236 , R8 ] ) , D204 = ( D201 . [ C236 , R8 ] ) as (Subset of R40) by TARSKI:def 3;
L861: (D203 = D204 or D203 misses D204) by EQREL_1:def 4;
consider C237 being (Element of R40) such that L862: C237 in C236 by FINSEQ_4:87;
L863: (( D198 . (C237 , R8) ) in ( D202 . (C236 , R8) ) & ( D198 . (C237 , R8) ) in ( D201 . (C236 , R8) )) by L848 , L849 , L851 , L852 , L862;
thus L864: ( D202 . (C236 , R8) ) = ( D201 . (C236 , R8) ) by L863 , L861 , XBOOLE_0:3;
end;
thus L865: thesis by L860 , BINOP_1:2;
end;
L866: (the InitS of C232) = (the InitS of C233)
proof
L867: (the InitS of C233) in ( final_states_partition R40 ) by L851;
reconsider D205 = (the InitS of C233) as (Subset of R40) by L867;
L868: (the InitS of C232) in ( final_states_partition R40 ) by L848;
reconsider D206 = (the InitS of C232) as (Subset of R40) by L868;
L869: (D206 = D205 or D206 misses D205) by L848 , L851 , EQREL_1:def 4;
thus L870: thesis by L869 , L850 , L853 , XBOOLE_0:3;
end;
thus L871: thesis by L866 , L848 , L851 , L859 , L854;
end;
end;
registration
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
cluster ( the_reduction_of R40 ) -> non  empty  finite;
coherence
proof
L873: (the carrier of ( the_reduction_of R40 )) = ( final_states_partition R40 ) by L823;
thus L874: thesis by L873;
end;
end;
theorem
L876: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R9 being (FinSequence of R5) holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R41 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R42 being (State of R40) holds (for B153 being (State of R41) holds ((R41 = ( the_reduction_of R40 ) & R42 in B153) implies (for B154 being (Element of ( NAT )) holds (B154 in ( Seg ( ( len R9 ) + 1 ) ) implies ( ( (R42 , R9) -admissible ) . B154 ) in ( ( (B153 , R9) -admissible ) . B154 )))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R9 being (FinSequence of R5);
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R41 being  finite non  empty Mealy-FSM over R5 , R6;
let R42 being (State of R40);
let C238 being (State of R41);
set D207 = (the Tran of R40);
assume that
L877: R41 = ( the_reduction_of R40 )
and
L878: R42 in C238;
defpred S12[ (Element of ( NAT )) ] means ($1 in ( Seg ( ( len R9 ) + 1 ) ) implies ( ( (R42 , R9) -admissible ) . $1 ) in ( ( (C238 , R9) -admissible ) . $1 ));
L879: (for B155 being (Element of ( NAT )) holds (S12[ B155 ] implies S12[ ( B155 + 1 ) ]))
proof
let C239 being (Element of ( NAT ));
assume L880: (C239 in ( Seg ( ( len R9 ) + 1 ) ) implies ( ( (R42 , R9) -admissible ) . C239 ) in ( ( (C238 , R9) -admissible ) . C239 ));
assume L881: ( C239 + 1 ) in ( Seg ( ( len R9 ) + 1 ) );
L882: (C239 = ( 0 ) or (( 0 ) < C239 & ( ( 0 ) + 1 ) = 1));
per cases  by L882 , NAT_1:13;
suppose L883: C239 = ( 0 );

L884: ( ( (R42 , R9) -admissible ) . ( C239 + 1 ) ) = R42 by L883 , L7;
thus L885: thesis by L884 , L878 , L883 , L7;
end;
suppose L886: 1 <= C239;

L887: ( C239 + 1 ) <= ( ( len R9 ) + 1 ) by L881 , FINSEQ_1:1;
L888: C239 <= ( len R9 ) by L887 , XREAL_1:6;
consider C240 being (Element of R5), C241 , C242 being (Element of R40) such that L889: (C240 = ( R9 . C239 ) & C241 = ( ( (R42 , R9) -admissible ) . C239 )) and L890: (C242 = ( ( (R42 , R9) -admissible ) . ( C239 + 1 ) ) & ( C240 -succ_of C241 ) = C242) by L888 , L886 , L7;
consider C243 being (Element of R5), C244 , C245 being (Element of R41) such that L891: (C243 = ( R9 . C239 ) & C244 = ( ( (C238 , R9) -admissible ) . C239 )) and L892: (C245 = ( ( (C238 , R9) -admissible ) . ( C239 + 1 ) ) & ( C243 -succ_of C244 ) = C245) by L886 , L888 , L7;
L893: C239 <= ( C239 + 1 ) by NAT_1:11;
L894: C239 <= ( ( len R9 ) + 1 ) by L893 , L887 , XXREAL_0:2;
L895: ( D207 . (C241 , C240) ) in ( (the Tran of R41) . (C244 , C243) ) by L894 , L877 , L880 , L886 , L889 , L891 , L823 , FINSEQ_1:1;
thus L896: thesis by L895 , L890 , L892;
end;
end;
L898: S12[ ( 0 ) ] by FINSEQ_1:1;
thus L899: (for B156 being (Element of ( NAT )) holds S12[ B156 ]) from NAT_1:sch 1(L898 , L879);
end;
theorem
L900: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds R40 , ( the_reduction_of R40 ) -are_equivalent )))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
L901:
now
set D208 = ( the_reduction_of R40 );
let C246 being (FinSequence of R5);
set D209 = ( ((the InitS of R40) , C246) -admissible );
set D210 = ( ((the InitS of D208) , C246) -admissible );
set D211 = ( ((the InitS of R40) , C246) -response );
set D212 = ( ((the InitS of D208) , C246) -response );
L902: (the InitS of R40) in (the InitS of D208) by L823;
L903:
now
let C247 being Nat;
assume that
L904: 1 <= C247
and
L905: C247 <= ( len D211 );
L906: C247 <= ( len C246 ) by L905 , L150;
L907: C247 in ( Seg ( len C246 ) ) by L906 , L904 , FINSEQ_1:1;
L908: C247 in ( Seg ( ( len C246 ) + 1 ) ) by L907 , FINSEQ_2:8;
L909: ( D209 . C247 ) in ( D210 . C247 ) by L908 , L902 , L876;
L910: C247 in ( Seg ( len D210 ) ) by L908 , L7;
L911: C247 in ( dom D210 ) by L910 , FINSEQ_1:def 3;
L912: ( D210 . C247 ) is (Element of D208) by L911 , FINSEQ_2:11;
L913: C247 in ( Seg ( len D209 ) ) by L908 , L7;
L914: C247 in ( dom D209 ) by L913 , FINSEQ_1:def 3;
L915: ( D209 . C247 ) is (Element of R40) by L914 , FINSEQ_2:11;
L916: C247 in ( dom C246 ) by L907 , FINSEQ_1:def 3;
L917: ( C246 . C247 ) is (Element of R5) by L916 , FINSEQ_2:11;
thus L918: ( D212 . C247 ) = ( (the OFun of D208) . (( D210 . C247 ) , ( C246 . C247 )) ) by L916 , L150
.= ( (the OFun of R40) . (( D209 . C247 ) , ( C246 . C247 )) ) by L915 , L917 , L912 , L909 , L823
.= ( D211 . C247 ) by L916 , L150;
end;
L919: ( len D211 ) = ( len C246 ) by L150
.= ( len D212 ) by L150;
thus L920: D211 = D212 by L919 , L903 , FINSEQ_1:14;
end;
thus L921: thesis by L901 , L326;
end;
begin
definition
let R5 being non  empty set;
let R6 being non  empty set;
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
pred R17 , R18 -are_isomorphic 
means
:L922: (ex R45 being (Function of (the carrier of R17) , (the carrier of R18)) st (R45 is  bijective & ( R45 . (the InitS of R17) ) = (the InitS of R18) & (for R33 being (State of R17) holds (for R8 being (Element of R5) holds (( R45 . ( (the Tran of R17) . (R33 , R8) ) ) = ( (the Tran of R18) . (( R45 . R33 ) , R8) ) & ( (the OFun of R17) . (R33 , R8) ) = ( (the OFun of R18) . (( R45 . R33 ) , R8) ))))))
;reflexivity
proof
let C248 being non  empty Mealy-FSM over R5 , R6;
take D213 = ( id (the carrier of C248) );
thus L923: D213 is  bijective;
thus L924: ( D213 . (the InitS of C248) ) = (the InitS of C248) by FUNCT_1:17;
let C249 being (Element of C248);
let R8 being (Element of R5);
thus L925: ( D213 . ( (the Tran of C248) . (C249 , R8) ) ) = ( (the Tran of C248) . [ C249 , R8 ] ) by FUNCT_1:17
.= ( (the Tran of C248) . (( D213 . C249 ) , R8) ) by FUNCT_1:17;
thus L926: thesis by FUNCT_1:17;
end;
symmetry
proof
let C250 , C251 being non  empty Mealy-FSM over R5 , R6;
given C252 being (Function of (the carrier of C250) , (the carrier of C251)) such that
L927: C252 is  bijective
and
L928: ( C252 . (the InitS of C250) ) = (the InitS of C251)
and
L929: (for B157 being (Element of C250) holds (for B158 being (Element of R5) holds (( C252 . ( (the Tran of C250) . (B157 , B158) ) ) = ( (the Tran of C251) . (( C252 . B157 ) , B158) ) & ( (the OFun of C250) . (B157 , B158) ) = ( (the OFun of C251) . (( C252 . B157 ) , B158) ))));

L930: ( dom C252 ) = (the carrier of C250) by FUNCT_2:def 1;
L931: ( rng ( C252 " ) ) = (the carrier of C250) by L930 , L927 , FUNCT_1:33;
L932: ( rng C252 ) = (the carrier of C251) by L927 , FUNCT_2:def 3;
L933: (the carrier of C251) = ( dom ( C252 " ) ) by L932 , L927 , FUNCT_1:33;
reconsider D214 = ( C252 " ) as (Function of (the carrier of C251) , (the carrier of C250)) by L933 , L931 , FUNCT_2:1;
take D214;
L934: D214 is  onto by L931 , FUNCT_2:def 3;
thus L935: D214 is  bijective by L934 , L927;
thus L936: (the InitS of C250) = ( D214 . (the InitS of C251) ) by L927 , L928 , L930 , FUNCT_1:34;
L937:
now
let C253 being (Element of C251);
let C254 being (Element of R5);
L938: C253 = ( C252 . ( D214 . C253 ) ) by L927 , L932 , FUNCT_1:35;
thus L939: ( (the Tran of C250) . [ ( D214 . C253 ) , C254 ] ) = ( D214 . ( C252 . ( (the Tran of C250) . (( D214 . C253 ) , C254) ) ) ) by L927 , L930 , FUNCT_1:34
.= ( D214 . ( (the Tran of C251) . (C253 , C254) ) ) by L929 , L938;
thus L940: ( (the OFun of C250) . (( D214 . C253 ) , C254) ) = ( (the OFun of C251) . (C253 , C254) ) by L929 , L938;
end;
thus L941: thesis by L937;
end;
end;
theorem
L943: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R19 being non  empty Mealy-FSM over R5 , R6 holds ((R17 , R18 -are_isomorphic  & R18 , R19 -are_isomorphic ) implies R17 , R19 -are_isomorphic ))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R19 being non  empty Mealy-FSM over R5 , R6;
assume that
L944: R17 , R18 -are_isomorphic 
and
L945: R18 , R19 -are_isomorphic ;
consider C255 being (Function of (the carrier of R17) , (the carrier of R18)) such that L946: C255 is  bijective and L947: ( C255 . (the InitS of R17) ) = (the InitS of R18) and L948: (for B159 being (Element of R17) holds (for B160 being (Element of R5) holds (( C255 . ( (the Tran of R17) . (B159 , B160) ) ) = ( (the Tran of R18) . (( C255 . B159 ) , B160) ) & ( (the OFun of R17) . (B159 , B160) ) = ( (the OFun of R18) . (( C255 . B159 ) , B160) )))) by L944 , L922;
consider C256 being (Function of (the carrier of R18) , (the carrier of R19)) such that L949: C256 is  bijective and L950: ( C256 . (the InitS of R18) ) = (the InitS of R19) and L951: (for B161 being (Element of R18) holds (for B162 being (Element of R5) holds (( C256 . ( (the Tran of R18) . (B161 , B162) ) ) = ( (the Tran of R19) . (( C256 . B161 ) , B162) ) & ( (the OFun of R18) . (B161 , B162) ) = ( (the OFun of R19) . (( C256 . B161 ) , B162) )))) by L945 , L922;
take D215 = ( C256 * C255 );
thus L952: D215 is  bijective by L946 , L949 , FINSEQ_4:85;
L953: ( dom C255 ) = (the carrier of R17) by FUNCT_2:def 1;
thus L954: ( D215 . (the InitS of R17) ) = (the InitS of R19) by L953 , L947 , L950 , FUNCT_1:13;
L955:
now
let C257 being (Element of R17);
let C258 being (Element of R5);
thus L956: ( (the Tran of R19) . [ ( D215 . C257 ) , C258 ] ) = ( (the Tran of R19) . (( C256 . ( C255 . C257 ) ) , C258) ) by L953 , FUNCT_1:13
.= ( C256 . ( (the Tran of R18) . (( C255 . C257 ) , C258) ) ) by L951
.= ( C256 . ( C255 . ( (the Tran of R17) . (C257 , C258) ) ) ) by L948
.= ( D215 . ( (the Tran of R17) . (C257 , C258) ) ) by L953 , FUNCT_1:13;
thus L957: ( (the OFun of R19) . [ ( D215 . C257 ) , C258 ] ) = ( (the OFun of R19) . (( C256 . ( C255 . C257 ) ) , C258) ) by L953 , FUNCT_1:13
.= ( (the OFun of R18) . (( C255 . C257 ) , C258) ) by L951
.= ( (the OFun of R17) . (C257 , C258) ) by L948;
end;
thus L958: thesis by L955;
end;
theorem
L959: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R9 being (FinSequence of R5) holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R33 being (State of R17) holds (for R45 being (Function of (the carrier of R17) , (the carrier of R18)) holds ((for B163 being (State of R17) holds (for R8 being (Element of R5) holds ( R45 . ( (the Tran of R17) . (B163 , R8) ) ) = ( (the Tran of R18) . (( R45 . B163 ) , R8) ))) implies (for R4 being (Element of ( NAT )) holds ((1 <= R4 & R4 <= ( ( len R9 ) + 1 )) implies ( R45 . ( ( (R33 , R9) -admissible ) . R4 ) ) = ( ( (( R45 . R33 ) , R9) -admissible ) . R4 )))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R9 being (FinSequence of R5);
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R33 being (State of R17);
let R45 being (Function of (the carrier of R17) , (the carrier of R18));
defpred S13[ (Element of ( NAT )) ] means ((1 <= $1 & $1 <= ( ( len R9 ) + 1 )) implies ( R45 . ( ( (R33 , R9) -admissible ) . $1 ) ) = ( ( (( R45 . R33 ) , R9) -admissible ) . $1 ));
assume L960: (for B164 being (State of R17) holds (for R8 being (Element of R5) holds ( R45 . ( (the Tran of R17) . (B164 , R8) ) ) = ( (the Tran of R18) . (( R45 . B164 ) , R8) )));
L961: (for B165 being (Element of ( NAT )) holds (S13[ B165 ] implies S13[ ( B165 + 1 ) ]))
proof
let C259 being (Element of ( NAT ));
assume L962: ((1 <= C259 & C259 <= ( ( len R9 ) + 1 )) implies ( R45 . ( ( (R33 , R9) -admissible ) . C259 ) ) = ( ( (( R45 . R33 ) , R9) -admissible ) . C259 ));
assume that
L963: 1 <= ( C259 + 1 )
and
L964: ( C259 + 1 ) <= ( ( len R9 ) + 1 );
L965: (C259 = ( 0 ) or (( 0 ) < C259 & ( ( 0 ) + 1 ) = 1));
per cases  by L965 , NAT_1:13;
suppose L966: C259 = ( 0 );

thus L967: ( R45 . ( ( (R33 , R9) -admissible ) . ( C259 + 1 ) ) ) = ( R45 . R33 ) by L966 , L7
.= ( ( (( R45 . R33 ) , R9) -admissible ) . ( C259 + 1 ) ) by L966 , L7;
end;
suppose L968: 1 <= C259;

L969: ( len R9 ) <= ( ( len R9 ) + 1 ) by NAT_1:11;
L970: C259 <= ( len R9 ) by L964 , XREAL_1:6;
consider C260 being (Element of R5), C261 , C262 being (State of R17) such that L971: (C260 = ( R9 . C259 ) & C261 = ( ( (R33 , R9) -admissible ) . C259 )) and L972: (C262 = ( ( (R33 , R9) -admissible ) . ( C259 + 1 ) ) & ( C260 -succ_of C261 ) = C262) by L970 , L968 , L7;
consider C263 being (Element of R5), C264 , C265 being (State of R18) such that L973: (C263 = ( R9 . C259 ) & C264 = ( ( (( R45 . R33 ) , R9) -admissible ) . C259 )) and L974: (C265 = ( ( (( R45 . R33 ) , R9) -admissible ) . ( C259 + 1 ) ) & ( C263 -succ_of C264 ) = C265) by L968 , L970 , L7;
thus L975: ( R45 . ( ( (R33 , R9) -admissible ) . ( C259 + 1 ) ) ) = ( R45 . ( (the Tran of R17) . (C261 , C260) ) ) by L972
.= ( (the Tran of R18) . (C264 , C263) ) by L960 , L962 , L968 , L970 , L969 , L971 , L973 , XXREAL_0:2
.= ( ( (( R45 . R33 ) , R9) -admissible ) . ( C259 + 1 ) ) by L974;
end;
end;
L977: S13[ ( 0 ) ];
thus L978: (for B166 being (Element of ( NAT )) holds S13[ B166 ]) from NAT_1:sch 1(L977 , L961);
end;
theorem
L979: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R33 being (State of R17) holds (for R34 being (State of R17) holds (for R45 being (Function of (the carrier of R17) , (the carrier of R18)) holds ((for B167 being (State of R17) holds (for R8 being (Element of R5) holds (( R45 . ( (the Tran of R17) . (B167 , R8) ) ) = ( (the Tran of R18) . (( R45 . B167 ) , R8) ) & ( (the OFun of R17) . (B167 , R8) ) = ( (the OFun of R18) . (( R45 . B167 ) , R8) )))) implies (R33 , R34 -are_equivalent  iff ( R45 . R33 ) , ( R45 . R34 ) -are_equivalent )))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R33 being (State of R17);
let R34 being (State of R17);
let R45 being (Function of (the carrier of R17) , (the carrier of R18));
set D216 = (the carrier of R17);
set D217 = (the carrier of R18);
set D218 = (the OFun of R17);
set D219 = (the OFun of R18);
assume L980: (for B168 being (Element of D216) holds (for R8 being (Element of R5) holds (( R45 . ( (the Tran of R17) . (B168 , R8) ) ) = ( (the Tran of R18) . (( R45 . B168 ) , R8) ) & ( (the OFun of R17) . (B168 , R8) ) = ( (the OFun of R18) . (( R45 . B168 ) , R8) ))));
thus L981:now
reconsider D220 = ( R45 . R34 ) as (Element of D217);
reconsider D221 = ( R45 . R33 ) as (Element of D217);
assume L982: R33 , R34 -are_equivalent ;
L983:
now
let C266 being (FinSequence of R5);
L984:
now
let C267 being Nat;
assume that
L985: 1 <= C267
and
L986: C267 <= ( len ( (D221 , C266) -response ) );
L987: ( len ( (D221 , C266) -response ) ) = ( len C266 ) by L150;
L988: C267 in ( Seg ( len C266 ) ) by L987 , L985 , L986 , FINSEQ_1:1;
L989: C267 in ( Seg ( ( len C266 ) + 1 ) ) by L988 , FINSEQ_2:8;
L990: C267 <= ( ( len C266 ) + 1 ) by L989 , FINSEQ_1:1;
L991: ( len ( (R33 , C266) -admissible ) ) = ( ( len C266 ) + 1 ) by L7;
L992: C267 in ( dom ( (R33 , C266) -admissible ) ) by L991 , L989 , FINSEQ_1:def 3;
reconsider D222 = ( ( (R33 , C266) -admissible ) . C267 ) as (Element of D216) by L992 , FINSEQ_2:11;
L993: C267 in ( NAT ) by ORDINAL1:def 12;
L994: ( len ( (R34 , C266) -admissible ) ) = ( ( len C266 ) + 1 ) by L7;
L995: C267 in ( dom ( (R34 , C266) -admissible ) ) by L994 , L989 , FINSEQ_1:def 3;
reconsider D223 = ( ( (R34 , C266) -admissible ) . C267 ) as (Element of D216) by L995 , FINSEQ_2:11;
L996: C267 in ( dom C266 ) by L988 , FINSEQ_1:def 3;
reconsider D224 = ( C266 . C267 ) as (Element of R5) by L996 , FINSEQ_2:11;
thus L997: ( ( (D221 , C266) -response ) . C267 ) = ( D219 . [ ( ( (D221 , C266) -admissible ) . C267 ) , ( C266 . C267 ) ] ) by L996 , L150
.= ( D219 . (( R45 . D222 ) , D224) ) by L980 , L985 , L990 , L993 , L959
.= ( D218 . (D222 , D224) ) by L980
.= ( ( (R33 , C266) -response ) . C267 ) by L996 , L150
.= ( ( (R34 , C266) -response ) . C267 ) by L982 , L332
.= ( D218 . (D223 , D224) ) by L996 , L150
.= ( D219 . (( R45 . D223 ) , D224) ) by L980
.= ( D219 . [ ( ( (D220 , C266) -admissible ) . C267 ) , ( C266 . C267 ) ] ) by L980 , L985 , L990 , L993 , L959
.= ( ( (D220 , C266) -response ) . C267 ) by L996 , L150;
end;
L998: ( len ( (D221 , C266) -response ) ) = ( len C266 ) by L150
.= ( len ( (D220 , C266) -response ) ) by L150;
thus L999: ( (D221 , C266) -response ) = ( (D220 , C266) -response ) by L998 , L984 , FINSEQ_1:14;
end;
thus L1000: ( R45 . R33 ) , ( R45 . R34 ) -are_equivalent  by L983 , L332;
end;
assume L1001: ( R45 . R33 ) , ( R45 . R34 ) -are_equivalent ;
L1002:
now
let C268 being (FinSequence of R5);
L1003:
now
let C269 being Nat;
assume that
L1004: 1 <= C269
and
L1005: C269 <= ( len ( (R33 , C268) -response ) );
L1006: ( len ( (R33 , C268) -response ) ) = ( len C268 ) by L150;
L1007: C269 in ( Seg ( len C268 ) ) by L1006 , L1004 , L1005 , FINSEQ_1:1;
L1008: C269 in ( Seg ( ( len C268 ) + 1 ) ) by L1007 , FINSEQ_2:8;
L1009: (C269 in ( NAT ) & C269 <= ( ( len C268 ) + 1 )) by L1008 , FINSEQ_1:1;
L1010: ( len ( (R34 , C268) -admissible ) ) = ( ( len C268 ) + 1 ) by L7;
L1011: C269 in ( dom ( (R34 , C268) -admissible ) ) by L1010 , L1008 , FINSEQ_1:def 3;
reconsider D225 = ( ( (R34 , C268) -admissible ) . C269 ) as (Element of D216) by L1011 , FINSEQ_2:11;
L1012: ( len ( (R33 , C268) -admissible ) ) = ( ( len C268 ) + 1 ) by L7;
L1013: C269 in ( dom ( (R33 , C268) -admissible ) ) by L1012 , L1008 , FINSEQ_1:def 3;
reconsider D226 = ( ( (R33 , C268) -admissible ) . C269 ) as (Element of D216) by L1013 , FINSEQ_2:11;
L1014: C269 in ( dom C268 ) by L1007 , FINSEQ_1:def 3;
reconsider D227 = ( C268 . C269 ) as (Element of R5) by L1014 , FINSEQ_2:11;
thus L1015: ( ( (R33 , C268) -response ) . C269 ) = ( D218 . (( ( (R33 , C268) -admissible ) . C269 ) , ( C268 . C269 )) ) by L1014 , L150
.= ( D219 . (( R45 . D226 ) , D227) ) by L980
.= ( D219 . [ ( ( (( R45 . R33 ) , C268) -admissible ) . C269 ) , D227 ] ) by L980 , L1004 , L1009 , L959
.= ( ( (( R45 . R33 ) , C268) -response ) . C269 ) by L1014 , L150
.= ( ( (( R45 . R34 ) , C268) -response ) . C269 ) by L1001 , L332
.= ( D219 . [ ( ( (( R45 . R34 ) , C268) -admissible ) . C269 ) , ( C268 . C269 ) ] ) by L1014 , L150
.= ( D219 . (( R45 . D225 ) , D227) ) by L980 , L1004 , L1009 , L959
.= ( D218 . (D225 , ( C268 . C269 )) ) by L980
.= ( ( (R34 , C268) -response ) . C269 ) by L1014 , L150;
end;
L1016: ( len ( (R33 , C268) -response ) ) = ( len C268 ) by L150
.= ( len ( (R34 , C268) -response ) ) by L150;
thus L1017: ( (R33 , C268) -response ) = ( (R34 , C268) -response ) by L1016 , L1003 , FINSEQ_1:14;
end;
thus L1018: thesis by L1002 , L332;
end;
theorem
L1019: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R41 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R43 being (State of R41) holds (for R44 being (State of R41) holds ((R41 = ( the_reduction_of R40 ) & R43 <> R44) implies (not R43 , R44 -are_equivalent ))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R41 being  finite non  empty Mealy-FSM over R5 , R6;
let R43 being (State of R41);
let R44 being (State of R41);
assume that
L1020: R41 = ( the_reduction_of R40 )
and
L1021: R43 <> R44;
L1022: (the carrier of R41) = ( final_states_partition R40 ) by L1020 , L823;
reconsider D228 = R43 as (Subset of R40) by L1022 , TARSKI:def 3;
consider C270 being (Element of R40) such that L1023: C270 in D228 by L1022 , FINSEQ_4:87;
reconsider D229 = R44 as (Subset of R40) by L1022 , TARSKI:def 3;
consider C271 being (Element of R40) such that L1024: C271 in D229 by L1022 , FINSEQ_4:87;
L1025: ( final_states_partition R40 ) is  final by L689;
L1026: (not C270 , C271 -are_equivalent )
proof
assume L1027: C270 , C271 -are_equivalent ;
consider C272 being (Element of R41) such that L1028: (C270 in C272 & C271 in C272) by L1027 , L1022 , L1025 , L642;
L1029: D229 misses D228 by L1021 , L1022 , EQREL_1:def 4;
L1030: C272 is (Subset of R40) by L1022 , TARSKI:def 3;
L1031: (C272 = D228 or C272 misses D228) by L1030 , L1022 , EQREL_1:def 4;
thus L1032: contradiction by L1031 , L1023 , L1024 , L1028 , L1029 , XBOOLE_0:3;
end;
consider C273 being (FinSequence of R5) such that L1033: ( (C270 , C273) -response ) <> ( (C271 , C273) -response ) by L1026 , L332;
set D230 = ( (R43 , C273) -admissible );
set D231 = ( (R44 , C273) -admissible );
set D232 = ( (C270 , C273) -admissible );
set D233 = ( (C271 , C273) -admissible );
set D234 = ( (C270 , C273) -response );
set D235 = ( (C271 , C273) -response );
L1034: ( len D234 ) = ( len C273 ) by L150
.= ( len D235 ) by L150;
consider C274 being Nat such that L1035: (1 <= C274 & C274 <= ( len D234 )) and L1036: ( D234 . C274 ) <> ( D235 . C274 ) by L1034 , L1033 , FINSEQ_1:14;
L1037: ( len D234 ) = ( len C273 ) by L150;
L1038: C274 in ( Seg ( len C273 ) ) by L1037 , L1035 , FINSEQ_1:1;
L1039: C274 in ( Seg ( ( len C273 ) + 1 ) ) by L1038 , FINSEQ_2:8;
L1040: ( D233 . C274 ) in ( D231 . C274 ) by L1039 , L1020 , L1024 , L876;
set D236 = ( (R43 , C273) -response );
set D237 = ( (R44 , C273) -response );
L1041: ( len D230 ) = ( ( len C273 ) + 1 ) by L7
.= ( ( len D234 ) + 1 ) by L150;
L1042: C274 in ( Seg ( len D234 ) ) by L1035 , FINSEQ_1:1;
L1043: C274 in ( Seg ( len D230 ) ) by L1042 , L1041 , FINSEQ_2:8;
L1044: C274 in ( dom D230 ) by L1043 , FINSEQ_1:def 3;
L1045: ( D230 . C274 ) is (Element of R41) by L1044 , FINSEQ_2:11;
L1046: ( len D231 ) = ( ( len C273 ) + 1 ) by L7
.= ( len D230 ) by L7;
L1047: C274 in ( dom D231 ) by L1046 , L1043 , FINSEQ_1:def 3;
L1048: ( D231 . C274 ) is (Element of R41) by L1047 , FINSEQ_2:11;
L1049: C274 in ( dom C273 ) by L1038 , FINSEQ_1:def 3;
L1050: ( C273 . C274 ) is (Element of R5) by L1049 , FINSEQ_2:11;
L1051: ( len D230 ) = ( ( len C273 ) + 1 ) by L7
.= ( len D232 ) by L7;
L1052: C274 in ( dom D232 ) by L1051 , L1043 , FINSEQ_1:def 3;
L1053: ( D232 . C274 ) is (Element of R40) by L1052 , FINSEQ_2:11;
L1054: ( len D233 ) = ( ( len C273 ) + 1 ) by L7
.= ( len D232 ) by L7;
L1055: C274 in ( dom D233 ) by L1054 , L1043 , L1051 , FINSEQ_1:def 3;
L1056: ( D233 . C274 ) is (Element of R40) by L1055 , FINSEQ_2:11;
L1057: C274 in ( Seg ( ( len C273 ) + 1 ) ) by L1038 , FINSEQ_2:8;
L1058: ( D232 . C274 ) in ( D230 . C274 ) by L1057 , L1020 , L1023 , L876;
L1059:
now
assume L1060: D236 = D237;
L1061: ( len C273 ) = ( len D234 ) by L150;
L1062: C274 in ( dom C273 ) by L1061 , L1035 , FINSEQ_3:25;
L1063: ( D234 . C274 ) = ( (the OFun of R40) . (( D232 . C274 ) , ( C273 . C274 )) ) by L1062 , L150;
L1064: ( D237 . C274 ) = ( (the OFun of R41) . (( D231 . C274 ) , ( C273 . C274 )) ) by L1062 , L150
.= ( (the OFun of R40) . (( D233 . C274 ) , ( C273 . C274 )) ) by L1020 , L1050 , L1048 , L1040 , L1056 , L823;
L1065: ( D236 . C274 ) = ( (the OFun of R41) . (( D230 . C274 ) , ( C273 . C274 )) ) by L1062 , L150
.= ( (the OFun of R40) . (( D232 . C274 ) , ( C273 . C274 )) ) by L1020 , L1045 , L1050 , L1058 , L1053 , L823;
thus L1066: contradiction by L1065 , L1036 , L1060 , L1062 , L1064 , L1063 , L150;
end;
thus L1067: thesis by L1059 , L332;
end;
begin
definition
let C275 , C276 being non  empty set;
let C277 being non  empty Mealy-FSM over C275 , C276;
attr C277 is  reduced
means
:L1068: (for B169 , B170 being (State of C277) holds (B169 <> B170 implies (not B169 , B170 -are_equivalent )));
end;
registration
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
cluster ( the_reduction_of R40 ) ->  reduced;
coherence
proof
let C278 , C279 being (State of ( the_reduction_of R40 ));
thus L1070: thesis by L1019;
end;
end;
registration
let R5 being non  empty set;
let R6 being non  empty set;
cluster  reduced  finite for non  empty non  empty non  empty non  empty Mealy-FSM over R5 , R6;
existence
proof
set D238 = the  finite non  empty Mealy-FSM over R5 , R6;
take ( the_reduction_of D238 );
thus L1072: thesis;
end;
end;
theorem
L1074: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R46 being  reduced  finite non  empty Mealy-FSM over R5 , R6 holds R46 , ( the_reduction_of R46 ) -are_isomorphic )))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R46 being  reduced  finite non  empty Mealy-FSM over R5 , R6;
set D239 = R46;
set D240 = ( the_reduction_of D239 );
set D241 = ( final_states_partition D239 );
deffunc H8((Element of D239)) = ( ( proj D241 ) . $1 );
consider C280 being (Function of (the carrier of D239) , D241) such that L1075: (for B171 being (Element of D239) holds ( C280 . B171 ) = H8(B171)) from FUNCT_2:sch 4;
L1076:
now
assume L1077: (not C280 is  one-to-one);
consider C281 , C282 being set such that L1078: (C281 in (the carrier of D239) & C282 in (the carrier of D239)) and L1079: ( C280 . C281 ) = ( C280 . C282 ) and L1080: C281 <> C282 by L1077 , FUNCT_2:19;
reconsider D242 = C281 , D243 = C282 as (State of D239) by L1078;
L1081: ( C280 . D242 ) = ( ( proj D241 ) . D242 ) by L1075;
L1082: D242 in ( C280 . D242 ) by L1081 , EQREL_1:def 9;
L1083: D241 is  final by L689;
L1084: ( C280 . D243 ) = ( ( proj D241 ) . D243 ) by L1075;
L1085: D243 in ( C280 . D243 ) by L1084 , EQREL_1:def 9;
L1086: (not D242 , D243 -are_equivalent ) by L1080 , L1068;
thus L1087: contradiction by L1086 , L1079 , L1083 , L1082 , L1085 , L642;
end;
set D244 = (the InitS of D239);
L1088: D241 c= ( rng C280 )
proof
let C283 being set;
assume L1089: C283 in D241;
reconsider D245 = C283 as (Subset of D239) by L1089;
consider C284 being (Element of D239) such that L1090: C284 in D245 by L1089 , FINSEQ_4:87;
L1091: D245 = ( ( proj D241 ) . C284 ) by L1089 , L1090 , EQREL_1:65;
L1092: ( C280 . C284 ) = D245 by L1091 , L1075;
thus L1093: thesis by L1092 , FUNCT_2:4;
end;
L1094: ( rng C280 ) c= D241 by RELAT_1:def 19;
L1095: ( rng C280 ) = D241 by L1094 , L1088 , XBOOLE_0:def 10;
L1096: C280 is  onto by L1095 , FUNCT_2:def 3;
L1097: (the carrier of D240) = D241 by L823;
L1098:
now
let C285 being (State of D239);
let C286 being (Element of R5);
reconsider D246 = ( C280 . C285 ) as (State of D240) by L823;
L1099: ( (the Tran of D240) . [ D246 , C286 ] ) is (State of D240);
L1100: ( C280 . C285 ) = ( ( proj D241 ) . C285 ) by L1075;
L1101: C285 in ( C280 . C285 ) by L1100 , EQREL_1:def 9;
L1102: ( (the Tran of D239) . (C285 , C286) ) in ( (the Tran of D240) . (( C280 . C285 ) , C286) ) by L1101 , L1097 , L823;
L1103: ( (the Tran of D240) . [ ( C280 . C285 ) , C286 ] ) = ( ( proj D241 ) . ( (the Tran of D239) . [ C285 , C286 ] ) ) by L1102 , L1097 , L1099 , EQREL_1:65;
thus L1104: ( C280 . ( (the Tran of D239) . (C285 , C286) ) ) = ( (the Tran of D240) . (( C280 . C285 ) , C286) ) by L1103 , L1075;
thus L1105: ( (the OFun of D239) . (C285 , C286) ) = ( (the OFun of D240) . (( C280 . C285 ) , C286) ) by L1097 , L1101 , L823;
end;
L1106: (the InitS of D239) in (the InitS of D240) by L823;
L1107: (the InitS of D240) = ( ( proj D241 ) . D244 ) by L1106 , L1097 , EQREL_1:65;
L1108: ( C280 . (the InitS of D239) ) = (the InitS of D240) by L1107 , L1075;
thus L1109: thesis by L1108 , L1097 , L1076 , L1096 , L1098 , L922;
end;
theorem
L1110: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (R40 is  reduced iff (ex B172 being  finite non  empty Mealy-FSM over R5 , R6 st R40 , ( the_reduction_of B172 ) -are_isomorphic )))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
set D247 = R40;
thus L1111:now
assume L1112: D247 is  reduced;
L1113: D247 , ( the_reduction_of D247 ) -are_isomorphic  by L1112 , L1074;
thus L1114: (ex B173 being  finite non  empty Mealy-FSM over R5 , R6 st R40 , ( the_reduction_of B173 ) -are_isomorphic ) by L1113;
end;
given C287 being  finite non  empty Mealy-FSM over R5 , R6 such that
L1115: D247 , ( the_reduction_of C287 ) -are_isomorphic ;

set D248 = ( the_reduction_of C287 );
consider C288 being (Function of (the carrier of D247) , (the carrier of D248)) such that L1116: C288 is  bijective and L1117: ( C288 . (the InitS of D247) ) = (the InitS of D248) and L1118: (for B174 being (State of D247) holds (for B175 being (Element of R5) holds (( C288 . ( (the Tran of D247) . (B174 , B175) ) ) = ( (the Tran of D248) . (( C288 . B174 ) , B175) ) & ( (the OFun of D247) . (B174 , B175) ) = ( (the OFun of D248) . (( C288 . B174 ) , B175) )))) by L1115 , L922;
let C289 , C290 being (State of D247);
assume L1119: C289 <> C290;
L1120: ( C288 . C289 ) <> ( C288 . C290 ) by L1119 , L1116 , FUNCT_2:19;
L1121: (not ( C288 . C289 ) , ( C288 . C290 ) -are_equivalent ) by L1120 , L1019;
thus L1122: thesis by L1121 , L1118 , L979;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let C291 being non  empty Mealy-FSM over R5 , R6;
let C292 being (State of C291);
attr C292 is  accessible
means
:L1123: (ex R9 being (FinSequence of R5) st (the InitS of C291) , R9 -leads_to C292);
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let C293 being non  empty Mealy-FSM over R5 , R6;
attr C293 is  connected
means
:L1125: (for B176 being (State of C293) holds B176 is  accessible);
end;
registration
let R5 being non  empty set;
let R6 being non  empty set;
cluster  connected for  finite non  empty  finite non  empty  finite non  empty  finite non  empty Mealy-FSM over R5 , R6;
existence
proof
set D249 = the (Element of R6);
reconsider D250 = { 1 } as  finite non  empty set;
reconsider D251 = 1 as (Element of D250) by TARSKI:def 1;
set D252 = [: D250 , R5 :];
set D253 = ( D252 --> 1 );
reconsider D254 = D253 as (Function of D252 , D250);
reconsider D255 = ( D252 --> D249 ) as (Function of [: D250 , R5 :] , R6);
reconsider D256 = Mealy-FSM (# D250 , D254 , D255 , D251 #) as  finite non  empty Mealy-FSM over R5 , R6;
take D256;
let C294 being (State of D256);
L1127: (C294 = 1 & (the InitS of D256) , ( <*> R5 ) -leads_to (the InitS of D256)) by L41 , TARSKI:def 1;
thus L1128: thesis by L1127 , L1123;
end;
end;
registration
let R5 being non  empty set;
let R6 being non  empty set;
let R47 being  connected  finite non  empty Mealy-FSM over R5 , R6;
cluster ( the_reduction_of R47 ) ->  connected;
coherence
proof
set D257 = R47;
set D258 = ( the_reduction_of D257 );
L1130: (the InitS of D257) in (the InitS of D258) by L823;
assume L1131: (not D258 is  connected);
consider C295 being (State of D258) such that L1132: (not C295 is  accessible) by L1131 , L1125;
L1133: (the carrier of D258) = ( final_states_partition D257 ) by L823;
reconsider D259 = C295 as (Subset of D257) by L1133 , TARSKI:def 3;
L1134: C295 in (the carrier of D258);
L1135: D259 in ( final_states_partition D257 ) by L1134 , L823;
consider C296 being (Element of D257) such that L1136: C296 in C295 by L1135 , FINSEQ_4:87;
L1137: C296 is  accessible by L1125;
consider R9 being (FinSequence of R5) such that L1138: (the InitS of D257) , R9 -leads_to C296 by L1137 , L1123;
L1139: 1 <= ( ( len R9 ) + 1 ) by NAT_1:11;
L1140: ( ( len R9 ) + 1 ) in ( Seg ( ( len R9 ) + 1 ) ) by L1139 , FINSEQ_1:1;
L1141: ( ( len R9 ) + 1 ) in ( Seg ( len ( ((the InitS of D258) , R9) -admissible ) ) ) by L1140 , L7;
L1142: ( ( len R9 ) + 1 ) in ( dom ( ((the InitS of D258) , R9) -admissible ) ) by L1141 , FINSEQ_1:def 3;
L1143: ( ( ((the InitS of D258) , R9) -admissible ) . ( ( len R9 ) + 1 ) ) in (the carrier of D258) by L1142 , FINSEQ_2:11;
reconsider D260 = ( ( ((the InitS of D258) , R9) -admissible ) . ( ( len R9 ) + 1 ) ) as (Subset of D257) by L1143 , L1133;
L1144: (D259 = D260 or D259 misses D260) by L1133 , L1143 , EQREL_1:def 4;
L1145: ( ( ((the InitS of D257) , R9) -admissible ) . ( ( len R9 ) + 1 ) ) = C296 by L1138 , L39;
L1146: C296 in ( ( ((the InitS of D258) , R9) -admissible ) . ( ( len R9 ) + 1 ) ) by L1145 , L1130 , L1140 , L876;
L1147: (the InitS of D258) , R9 -leads_to C295 by L1146 , L1136 , L1144 , L39 , XBOOLE_0:3;
thus L1148: contradiction by L1147 , L1132 , L1123;
end;
end;
registration
let R5 being non  empty set;
let R6 being non  empty set;
cluster  connected  reduced  finite for non  empty non  empty non  empty non  empty Mealy-FSM over R5 , R6;
existence
proof
set D261 = the  connected  finite non  empty Mealy-FSM over R5 , R6;
take ( the_reduction_of D261 );
thus L1150: thesis;
end;
end;
definition
let R5 being non  empty set;
let R6 being non  empty set;
let C297 being non  empty Mealy-FSM over R5 , R6;
func accessibleStates C297 equals 
{ B177 where B177 is (State of C297) : B177 is  accessible };
coherence;
end;
registration
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
cluster ( accessibleStates R40 ) ->  finite non  empty;
coherence
proof
set D262 = R40;
set D263 = { B178 where B178 is (State of D262) : B178 is  accessible };
L1153: D263 c= (the carrier of D262)
proof
let C298 being set;
assume L1154: C298 in D263;
L1155: (ex B179 being (State of D262) st (C298 = B179 & B179 is  accessible)) by L1154;
thus L1156: thesis by L1155;
end;
L1157: (the InitS of D262) , ( <*> R5 ) -leads_to (the InitS of D262) by L41;
L1158: (the InitS of D262) is  accessible by L1157 , L1123;
L1159: (the InitS of D262) in D263 by L1158;
thus L1160: thesis by L1159 , L1153;
end;
end;
theorem
L1162: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (( accessibleStates R40 ) c= (the carrier of R40) & (for R42 being (State of R40) holds (R42 in ( accessibleStates R40 ) iff R42 is  accessible))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
set D264 = { B180 where B180 is (State of R40) : B180 is  accessible };
L1163: D264 c= (the carrier of R40)
proof
let C299 being set;
assume L1164: C299 in D264;
L1165: (ex B181 being (State of R40) st (C299 = B181 & B181 is  accessible)) by L1164;
thus L1166: thesis by L1165;
end;
thus L1167: ( accessibleStates R40 ) c= (the carrier of R40) by L1163;
let C300 being (State of R40);
thus L1168:now
assume L1169: C300 in ( accessibleStates R40 );
L1170: (ex B182 being (State of R40) st (B182 = C300 & B182 is  accessible)) by L1169;
thus L1171: C300 is  accessible by L1170;
end;
thus L1172: thesis;
end;
theorem
L1173: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds ( (the Tran of R40) | [: ( accessibleStates R40 ) , R5 :] ) is (Function of [: ( accessibleStates R40 ) , R5 :] , ( accessibleStates R40 )))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
set D265 = ( (the Tran of R40) | [: ( accessibleStates R40 ) , R5 :] );
L1174: ( accessibleStates R40 ) c= (the carrier of R40) by L1162;
L1175: [: ( accessibleStates R40 ) , R5 :] c= [: (the carrier of R40) , R5 :] by L1174 , ZFMISC_1:96;
L1176: D265 is (Function of [: ( accessibleStates R40 ) , R5 :] , (the carrier of R40)) by L1175 , FUNCT_2:32;
L1177: ( dom D265 ) = [: ( accessibleStates R40 ) , R5 :] by L1176 , FUNCT_2:def 1;
L1178: ( rng D265 ) c= ( accessibleStates R40 )
proof
set D266 = (the InitS of R40);
let C301 being set;
assume L1179: C301 in ( rng D265 );
consider C302 being set such that L1180: C302 in ( dom D265 ) and L1181: C301 = ( D265 . C302 ) by L1179 , FUNCT_1:def 3;
L1182: ( C302 `1 ) in ( accessibleStates R40 ) by L1177 , L1180 , MCART_1:10;
reconsider D267 = ( C302 `1 ) as (State of R40) by L1182 , L1174;
reconsider D268 = ( C302 `2 ) as (Element of R5) by L1177 , L1180 , MCART_1:10;
set D269 = ( (D267 , <* D268 *>) -admissible );
L1183: (( D269 . 1 ) = D267 & ( <* D268 *> . 1 ) = D268) by L7 , FINSEQ_1:40;
L1184: ( rng D265 ) c= (the carrier of R40) by RELAT_1:def 19;
reconsider D270 = C301 as (State of R40) by L1184 , L1179;
L1185: 1 <= ( len <* D268 *> ) by FINSEQ_1:39;
L1186: (ex B183 being (Element of R5) st (ex B184 , B185 being (State of R40) st (B183 = ( <* D268 *> . 1 ) & B184 = ( D269 . 1 ) & B185 = ( D269 . ( 1 + 1 ) ) & ( B183 -succ_of B184 ) = B185))) by L1185 , L7;
L1187: ( (the Tran of R40) . C302 ) = D270 by L1177 , L1180 , L1181 , FUNCT_1:49;
L1188: ( D269 . ( 1 + 1 ) ) = D270 by L1187 , L1180 , L1183 , L1186 , MCART_1:21;
L1189: ( 1 + 1 ) = 2;
L1190: 2 <= ( ( len <* D268 *> ) + 1 ) by L1189 , FINSEQ_1:39;
L1191: D267 is  accessible by L1182 , L1162;
consider C303 being (FinSequence of R5) such that L1192: D266 , C303 -leads_to D267 by L1191 , L1123;
L1193: ( len ( C303 ^ <* D268 *> ) ) = ( ( len C303 ) + ( len <* D268 *> ) ) by FINSEQ_1:22;
L1194: ( ( len ( C303 ^ <* D268 *> ) ) + 1 ) = ( ( ( len C303 ) + 1 ) + 1 ) by L1193 , FINSEQ_1:39
.= ( ( len C303 ) + ( 1 + 1 ) );
L1195: ( ( (D266 , ( C303 ^ <* D268 *> )) -admissible ) . ( ( len ( C303 ^ <* D268 *> ) ) + 1 ) ) = D270 by L1194 , L1192 , L1188 , L1190 , L95;
L1196: D266 , ( C303 ^ <* D268 *> ) -leads_to D270 by L1195 , L39;
L1197: D270 is  accessible by L1196 , L1123;
thus L1198: thesis by L1197;
end;
thus L1199: thesis by L1178 , L1177 , FUNCT_2:def 1 , RELSET_1:4;
end;
theorem
L1200: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for B186 being (Function of [: ( accessibleStates R40 ) , R5 :] , ( accessibleStates R40 )) holds (for B187 being (Function of [: ( accessibleStates R40 ) , R5 :] , R6) holds (for B188 being (Element of ( accessibleStates R40 )) holds ((B186 = ( (the Tran of R40) | [: ( accessibleStates R40 ) , R5 :] ) & B187 = ( (the OFun of R40) | [: ( accessibleStates R40 ) , R5 :] ) & B188 = (the InitS of R40)) implies R40 , Mealy-FSM (# ( accessibleStates R40 ) , B186 , B187 , B188 #) -are_equivalent )))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
set D271 = R40;
let C304 being (Function of [: ( accessibleStates D271 ) , R5 :] , ( accessibleStates D271 ));
let C305 being (Function of [: ( accessibleStates D271 ) , R5 :] , R6);
let C306 being (Element of ( accessibleStates D271 ));
assume that
L1201: C304 = ( (the Tran of D271) | [: ( accessibleStates D271 ) , R5 :] )
and
L1202: C305 = ( (the OFun of D271) | [: ( accessibleStates D271 ) , R5 :] )
and
L1203: C306 = (the InitS of D271);
let C307 being (FinSequence of R5);
set D272 = Mealy-FSM (# ( accessibleStates D271 ) , C304 , C305 , C306 #);
set D273 = ( ((the InitS of D271) , C307) -admissible );
set D274 = ( ((the InitS of D272) , C307) -admissible );
set D275 = ( ((the InitS of D271) , C307) -response );
set D276 = ( ((the InitS of D272) , C307) -response );
L1204:
now
defpred S14[ Nat ] means ($1 in ( dom D273 ) implies ( D273 . $1 ) = ( D274 . $1 ));
thus L1205: (( len D273 ) = ( ( len C307 ) + 1 ) & ( len D274 ) = ( ( len C307 ) + 1 )) by L7;
L1206: ( dom D273 ) = ( Seg ( ( len C307 ) + 1 ) ) by L1205 , FINSEQ_1:def 3;
L1207: (for B189 being Nat holds (S14[ B189 ] implies S14[ ( B189 + 1 ) ]))
proof
let C308 being Nat;
assume that
L1208: (C308 in ( dom D273 ) implies ( D273 . C308 ) = ( D274 . C308 ));
L1209: (( 0 ) = C308 or (( 0 ) < C308 & ( ( 0 ) + 1 ) = 1));
assume L1210: ( C308 + 1 ) in ( dom D273 );
L1211: ( C308 + 1 ) <= ( ( len C307 ) + 1 ) by L1210 , L1206 , FINSEQ_1:1;
L1212: C308 <= ( len C307 ) by L1211 , XREAL_1:6;
L1213: C308 < ( ( len C307 ) + 1 ) by L1211 , NAT_1:13;
per cases  by L1209 , NAT_1:13;
suppose L1214: ( 0 ) = C308;

thus L1215: ( D273 . ( C308 + 1 ) ) = (the InitS of D271) by L1214 , L7
.= ( D274 . ( C308 + 1 ) ) by L1203 , L1214 , L7;
end;
suppose L1216: 1 <= C308;

L1217: ((ex B190 being (Element of R5) st (ex B191 , B192 being (State of D271) st (B190 = ( C307 . C308 ) & B191 = ( D273 . C308 ) & B192 = ( D273 . ( C308 + 1 ) ) & ( B190 -succ_of B191 ) = B192))) & (ex B193 being (Element of R5) st (ex B194 , B195 being (State of D272) st (B193 = ( C307 . C308 ) & B194 = ( D274 . C308 ) & B195 = ( D274 . ( C308 + 1 ) ) & ( B193 -succ_of B194 ) = B195)))) by L1216 , L1212 , L7;
thus L1218: thesis by L1217 , L1201 , L1206 , L1208 , L1213 , L1216 , FINSEQ_1:1 , FUNCT_1:49;
end;
end;
L1220: S14[ ( 0 ) ] by L1206 , FINSEQ_1:1;
thus L1221: (for B196 being Nat holds S14[ B196 ]) from NAT_1:sch 2(L1220 , L1207);
end;
L1222: D273 = D274 by L1204 , FINSEQ_2:9;
L1223:
now
thus L1224: (( len D275 ) = ( len C307 ) & ( len D276 ) = ( len C307 )) by L150;
L1225: ( dom D275 ) = ( Seg ( len C307 ) ) by L1224 , FINSEQ_1:def 3;
let C309 being Nat;
assume L1226: C309 in ( dom D275 );
L1227: C309 in ( dom C307 ) by L1226 , L1225 , FINSEQ_1:def 3;
L1228: C309 in ( Seg ( ( len C307 ) + 1 ) ) by L1225 , L1226 , FINSEQ_2:8;
L1229: C309 in ( dom D274 ) by L1228 , L1204 , FINSEQ_1:def 3;
L1230: ( D274 . C309 ) in ( accessibleStates D271 ) by L1229 , FINSEQ_2:11;
L1231: ( C307 . C309 ) in R5 by L1227 , FINSEQ_2:11;
L1232: [ ( D274 . C309 ) , ( C307 . C309 ) ] in [: ( accessibleStates D271 ) , R5 :] by L1231 , L1230 , ZFMISC_1:87;
thus L1233: ( D275 . C309 ) = ( (the OFun of D271) . [ ( D273 . C309 ) , ( C307 . C309 ) ] ) by L1227 , L150
.= ( C305 . [ ( D274 . C309 ) , ( C307 . C309 ) ] ) by L1202 , L1222 , L1232 , FUNCT_1:49
.= ( D276 . C309 ) by L1227 , L150;
end;
thus L1234: thesis by L1223 , FINSEQ_2:9;
end;
theorem
L1235: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (ex R47 being  connected  finite non  empty Mealy-FSM over R5 , R6 st ((the Tran of R47) = ( (the Tran of R40) | [: ( accessibleStates R40 ) , R5 :] ) & (the OFun of R47) = ( (the OFun of R40) | [: ( accessibleStates R40 ) , R5 :] ) & (the InitS of R47) = (the InitS of R40) & R40 , R47 -are_equivalent )))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
set D277 = R40;
set D278 = (the InitS of D277);
L1236: ( accessibleStates D277 ) c= (the carrier of D277) by L1162;
L1237: [: ( accessibleStates D277 ) , R5 :] c= [: (the carrier of D277) , R5 :] by L1236 , ZFMISC_1:96;
reconsider D279 = ( (the OFun of D277) | [: ( accessibleStates D277 ) , R5 :] ) as (Function of [: ( accessibleStates D277 ) , R5 :] , R6) by L1237 , FUNCT_2:32;
L1238: D278 , ( <*> R5 ) -leads_to D278 by L41;
L1239: D278 is  accessible by L1238 , L1123;
reconsider D280 = (the InitS of D277) as (Element of ( accessibleStates D277 )) by L1239 , L1162;
reconsider D281 = ( (the Tran of D277) | [: ( accessibleStates D277 ) , R5 :] ) as (Function of [: ( accessibleStates D277 ) , R5 :] , ( accessibleStates D277 )) by L1173;
set D282 = Mealy-FSM (# ( accessibleStates D277 ) , D281 , D279 , D280 #);
L1240:
now
let C310 being (FinSequence of R5);
set D283 = ( ((the InitS of D277) , C310) -admissible );
set D284 = ( ((the InitS of D282) , C310) -admissible );
L1241:
now
defpred S15[ Nat ] means ($1 in ( dom D283 ) implies ( D283 . $1 ) = ( D284 . $1 ));
thus L1242: (( len D283 ) = ( ( len C310 ) + 1 ) & ( len D284 ) = ( ( len C310 ) + 1 )) by L7;
L1243: ( dom D283 ) = ( Seg ( ( len C310 ) + 1 ) ) by L1242 , FINSEQ_1:def 3;
L1244: (for B197 being Nat holds (S15[ B197 ] implies S15[ ( B197 + 1 ) ]))
proof
let C311 being Nat;
assume that
L1245: (C311 in ( dom D283 ) implies ( D283 . C311 ) = ( D284 . C311 ));
L1246: (( 0 ) = C311 or (( 0 ) < C311 & ( ( 0 ) + 1 ) = 1));
assume L1247: ( C311 + 1 ) in ( dom D283 );
L1248: ( C311 + 1 ) <= ( ( len C310 ) + 1 ) by L1247 , L1243 , FINSEQ_1:1;
L1249: C311 <= ( len C310 ) by L1248 , XREAL_1:6;
L1250: C311 < ( ( len C310 ) + 1 ) by L1248 , NAT_1:13;
per cases  by L1246 , NAT_1:13;
suppose L1251: ( 0 ) = C311;

thus L1252: ( D283 . ( C311 + 1 ) ) = (the InitS of D277) by L1251 , L7
.= ( D284 . ( C311 + 1 ) ) by L1251 , L7;
end;
suppose L1253: 1 <= C311;

L1254: ((ex B198 being (Element of R5) st (ex B199 , B200 being (State of D277) st (B198 = ( C310 . C311 ) & B199 = ( D283 . C311 ) & B200 = ( D283 . ( C311 + 1 ) ) & ( B198 -succ_of B199 ) = B200))) & (ex B201 being (Element of R5) st (ex B202 , B203 being (State of D282) st (B201 = ( C310 . C311 ) & B202 = ( D284 . C311 ) & B203 = ( D284 . ( C311 + 1 ) ) & ( B201 -succ_of B202 ) = B203)))) by L1253 , L1249 , L7;
thus L1255: thesis by L1254 , L1243 , L1245 , L1250 , L1253 , FINSEQ_1:1 , FUNCT_1:49;
end;
end;
L1257: S15[ ( 0 ) ] by L1243 , FINSEQ_1:1;
thus L1258: (for B204 being Nat holds S15[ B204 ]) from NAT_1:sch 2(L1257 , L1244);
end;
thus L1259: D283 = D284 by L1241 , FINSEQ_2:9;
end;
L1260:
now
let C312 being (State of D282);
L1261: (C312 in ( accessibleStates D277 ) & ( accessibleStates D277 ) c= (the carrier of D277)) by L1162;
reconsider D285 = C312 as (State of D277) by L1261;
L1262: D285 is  accessible by L1162;
consider C313 being (FinSequence of R5) such that L1263: (the InitS of D277) , C313 -leads_to D285 by L1262 , L1123;
L1264: ( ( ((the InitS of D277) , C313) -admissible ) . ( ( len C313 ) + 1 ) ) = D285 by L1263 , L39;
L1265: ( ( ((the InitS of D282) , C313) -admissible ) . ( ( len C313 ) + 1 ) ) = C312 by L1264 , L1240;
L1266: (the InitS of D282) , C313 -leads_to C312 by L1265 , L39;
thus L1267: C312 is  accessible by L1266 , L1123;
end;
reconsider D286 = D282 as  connected  finite non  empty Mealy-FSM over R5 , R6 by L1260 , L1125;
take D286;
thus L1268: (the Tran of D286) = ( (the Tran of D277) | [: ( accessibleStates D277 ) , R5 :] );
thus L1269: (the OFun of D286) = ( (the OFun of D277) | [: ( accessibleStates D277 ) , R5 :] );
thus L1270: (the InitS of D286) = (the InitS of D277);
let C314 being (FinSequence of R5);
set D287 = ( ((the InitS of D277) , C314) -admissible );
set D288 = ( ((the InitS of D286) , C314) -admissible );
set D289 = ( ((the InitS of D277) , C314) -response );
set D290 = ( ((the InitS of D286) , C314) -response );
L1271: ( len D288 ) = ( ( len C314 ) + 1 ) by L7;
L1272:
now
thus L1273: (( len D289 ) = ( len C314 ) & ( len D290 ) = ( len C314 )) by L150;
L1274: ( dom D289 ) = ( Seg ( len C314 ) ) by L1273 , FINSEQ_1:def 3;
let C315 being Nat;
assume L1275: C315 in ( dom D289 );
L1276: C315 in ( dom C314 ) by L1275 , L1274 , FINSEQ_1:def 3;
L1277: C315 in ( Seg ( ( len C314 ) + 1 ) ) by L1274 , L1275 , FINSEQ_2:8;
L1278: C315 in ( dom D288 ) by L1277 , L1271 , FINSEQ_1:def 3;
L1279: ( D288 . C315 ) in ( accessibleStates D277 ) by L1278 , FINSEQ_2:11;
L1280: ( C314 . C315 ) in R5 by L1276 , FINSEQ_2:11;
L1281: [ ( D288 . C315 ) , ( C314 . C315 ) ] in [: ( accessibleStates D277 ) , R5 :] by L1280 , L1279 , ZFMISC_1:87;
L1282: [ ( D287 . C315 ) , ( C314 . C315 ) ] = [ ( D288 . C315 ) , ( C314 . C315 ) ] by L1240;
thus L1283: ( D289 . C315 ) = ( (the OFun of D277) . [ ( D287 . C315 ) , ( C314 . C315 ) ] ) by L1276 , L150
.= ( D279 . [ ( D288 . C315 ) , ( C314 . C315 ) ] ) by L1282 , L1281 , FUNCT_1:49
.= ( D290 . C315 ) by L1276 , L150;
end;
thus L1284: thesis by L1272 , FINSEQ_2:9;
end;
begin
definition
let C316 being set;
let C317 being non  empty set;
let C318 , C319 being non  empty Mealy-FSM over C316 , C317;
func C318 -Mealy_union C319 ->  strict Mealy-FSM over C316 , C317 means 
:L1285: ((the carrier of it) = ( (the carrier of C318) \/ (the carrier of C319) ) & (the Tran of it) = ( (the Tran of C318) +* (the Tran of C319) ) & (the OFun of it) = ( (the OFun of C318) +* (the OFun of C319) ) & (the InitS of it) = (the InitS of C318));
existence
proof
set D291 = (the OFun of C318);
set D292 = (the OFun of C319);
set D293 = (the Tran of C318);
set D294 = (the Tran of C319);
set D295 = (the carrier of C318);
set D296 = (the carrier of C319);
set D297 = ( D293 +* D294 );
set D298 = ( D291 +* D292 );
reconsider D299 = ( D295 \/ D296 ) as non  empty set;
L1286: (( rng D293 ) c= D295 & ( rng D294 ) c= D296) by RELAT_1:def 19;
L1287: (( rng D297 ) c= ( ( rng D293 ) \/ ( rng D294 ) ) & ( ( rng D293 ) \/ ( rng D294 ) ) c= ( D295 \/ D296 )) by L1286 , FUNCT_4:17 , XBOOLE_1:13;
L1288: (( dom D291 ) = [: D295 , C316 :] & ( dom D292 ) = [: D296 , C316 :]) by FUNCT_2:def 1;
L1289: ( dom D298 ) = ( [: D295 , C316 :] \/ [: D296 , C316 :] ) by L1288 , FUNCT_4:def 1
.= [: ( D295 \/ D296 ) , C316 :] by ZFMISC_1:97;
L1290: (( rng D291 ) c= C317 & ( rng D292 ) c= C317) by RELAT_1:def 19;
L1291: (( rng D298 ) c= ( ( rng D291 ) \/ ( rng D292 ) ) & ( ( rng D291 ) \/ ( rng D292 ) ) c= ( C317 \/ C317 )) by L1290 , FUNCT_4:17 , XBOOLE_1:13;
reconsider D300 = D298 as (Function of [: D299 , C316 :] , C317) by L1291 , L1289 , FUNCT_2:2 , XBOOLE_1:1;
L1292: (( dom D293 ) = [: D295 , C316 :] & ( dom D294 ) = [: D296 , C316 :]) by FUNCT_2:def 1;
L1293: ( dom D297 ) = ( [: D295 , C316 :] \/ [: D296 , C316 :] ) by L1292 , FUNCT_4:def 1
.= [: ( D295 \/ D296 ) , C316 :] by ZFMISC_1:97;
reconsider D301 = D297 as (Function of [: D299 , C316 :] , D299) by L1293 , L1287 , FUNCT_2:2 , XBOOLE_1:1;
reconsider D302 = (the InitS of C318) as (Element of D299) by XBOOLE_0:def 3;
take Mealy-FSM (# D299 , D301 , D300 , D302 #);
thus L1294: thesis;
end;
uniqueness;
end;
registration
let C320 being set;
let C321 being non  empty set;
let C322 , C323 being non  empty  finite Mealy-FSM over C320 , C321;
cluster ( C322 -Mealy_union C323 ) -> non  empty  finite;
coherence
proof
L1296: (the carrier of ( C322 -Mealy_union C323 )) = ( (the carrier of C322) \/ (the carrier of C323) ) by L1285;
thus L1297: thesis by L1296;
end;
end;
theorem
L1299: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R9 being (FinSequence of R5) holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R33 being (State of R17) holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R42 being (State of R40) holds ((R40 = ( R17 -Mealy_union R18 ) & (the carrier of R17) misses (the carrier of R18) & R33 = R42) implies ( (R33 , R9) -admissible ) = ( (R42 , R9) -admissible ))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R9 being (FinSequence of R5);
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R33 being (State of R17);
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R42 being (State of R40);
assume that
L1300: R40 = ( R17 -Mealy_union R18 )
and
L1301: (the carrier of R17) misses (the carrier of R18)
and
L1302: R33 = R42;
set D303 = ( (R33 , R9) -admissible );
set D304 = ( (R42 , R9) -admissible );
defpred S16[ Nat ] means ((1 <= $1 & $1 <= ( len D303 )) implies ( D303 . $1 ) = ( D304 . $1 ));
L1303: (for B205 being Nat holds (S16[ B205 ] implies S16[ ( B205 + 1 ) ]))
proof
let C324 being Nat;
assume L1304: ((1 <= C324 & C324 <= ( len D303 )) implies ( D303 . C324 ) = ( D304 . C324 ));
assume that
L1305: 1 <= ( C324 + 1 )
and
L1306: ( C324 + 1 ) <= ( len D303 );
L1307: (C324 = ( 0 ) or (( 0 ) < C324 & ( ( 0 ) + 1 ) = 1));
per cases  by L1307 , NAT_1:13;
suppose L1308: C324 = ( 0 );

thus L1309: ( D303 . ( C324 + 1 ) ) = R33 by L1308 , L7
.= ( D304 . ( C324 + 1 ) ) by L1302 , L1308 , L7;
end;
suppose L1310: 1 <= C324;

L1311: ( C324 + 1 ) <= ( ( len R9 ) + 1 ) by L1306 , L7;
L1312: C324 <= ( len R9 ) by L1311 , XREAL_1:6;
consider C325 being (Element of R5), C326 , C327 being (Element of R17) such that L1313: (C325 = ( R9 . C324 ) & C326 = ( D303 . C324 )) and L1314: (C327 = ( D303 . ( C324 + 1 ) ) & ( C325 -succ_of C326 ) = C327) by L1312 , L1310 , L7;
L1315: (ex B206 being (Element of R5) st (ex B207 , B208 being (Element of R40) st (B206 = ( R9 . C324 ) & B207 = ( D304 . C324 ) & B208 = ( D304 . ( C324 + 1 ) ) & ( B206 -succ_of B207 ) = B208))) by L1310 , L1312 , L7;
L1316: ( len R9 ) <= ( ( len R9 ) + 1 ) by NAT_1:11;
L1317: C324 <= ( ( len R9 ) + 1 ) by L1316 , L1312 , XXREAL_0:2;
L1318: [: (the carrier of R17) , R5 :] misses [: (the carrier of R18) , R5 :] by L1301 , ZFMISC_1:104;
L1319: (( dom (the Tran of R18) ) = [: (the carrier of R18) , R5 :] & (not [ C326 , C325 ] in [: (the carrier of R18) , R5 :])) by L1318 , FUNCT_2:def 1 , XBOOLE_0:3;
thus L1320: ( D303 . ( C324 + 1 ) ) = ( ( (the Tran of R17) +* (the Tran of R18) ) . [ C326 , C325 ] ) by L1319 , L1314 , FUNCT_4:11
.= ( D304 . ( C324 + 1 ) ) by L1300 , L1304 , L1310 , L1313 , L1315 , L1317 , L7 , L1285;
end;
end;
L1322: S16[ ( 0 ) ];
L1323: (for B209 being Nat holds S16[ B209 ]) from NAT_1:sch 2(L1322 , L1303);
L1324: ( len D303 ) = ( ( len R9 ) + 1 ) by L7
.= ( len D304 ) by L7;
thus L1325: thesis by L1324 , L1323 , FINSEQ_1:14;
end;
theorem
L1326: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R9 being (FinSequence of R5) holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R33 being (State of R17) holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R42 being (State of R40) holds ((R40 = ( R17 -Mealy_union R18 ) & (the carrier of R17) misses (the carrier of R18) & R33 = R42) implies ( (R33 , R9) -response ) = ( (R42 , R9) -response ))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R9 being (FinSequence of R5);
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R33 being (State of R17);
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R42 being (State of R40);
set D305 = R33;
assume that
L1327: R40 = ( R17 -Mealy_union R18 )
and
L1328: (the carrier of R17) misses (the carrier of R18)
and
L1329: D305 = R42;
set D306 = ( (D305 , R9) -admissible );
set D307 = ( (R42 , R9) -response );
set D308 = ( (D305 , R9) -response );
L1330: ( len D308 ) = ( len R9 ) by L150;
L1331:
now
let C328 being Nat;
L1332: [: (the carrier of R17) , R5 :] misses [: (the carrier of R18) , R5 :] by L1328 , ZFMISC_1:104;
assume L1333: (1 <= C328 & C328 <= ( len D308 ));
L1334: C328 in ( Seg ( len R9 ) ) by L1333 , L1330 , FINSEQ_1:1;
L1335: C328 in ( dom R9 ) by L1334 , FINSEQ_1:def 3;
L1336: C328 in ( Seg ( ( len R9 ) + 1 ) ) by L1334 , FINSEQ_2:8;
L1337: C328 in ( Seg ( len D306 ) ) by L1336 , L7;
L1338: C328 in ( dom D306 ) by L1337 , FINSEQ_1:def 3;
L1339: ( D306 . C328 ) in (the carrier of R17) by L1338 , FINSEQ_2:11;
L1340: ( R9 . C328 ) in R5 by L1335 , FINSEQ_2:11;
L1341: [ ( D306 . C328 ) , ( R9 . C328 ) ] in [: (the carrier of R17) , R5 :] by L1340 , L1339 , ZFMISC_1:87;
L1342: (( dom (the OFun of R18) ) = [: (the carrier of R18) , R5 :] & (not [ ( D306 . C328 ) , ( R9 . C328 ) ] in [: (the carrier of R18) , R5 :])) by L1341 , L1332 , FUNCT_2:def 1 , XBOOLE_0:3;
L1343: ( D308 . C328 ) = ( (the OFun of R17) . [ ( ( (D305 , R9) -admissible ) . C328 ) , ( R9 . C328 ) ] ) by L1335 , L150
.= ( ( (the OFun of R17) +* (the OFun of R18) ) . [ ( D306 . C328 ) , ( R9 . C328 ) ] ) by L1342 , FUNCT_4:11
.= ( ( (the OFun of R17) +* (the OFun of R18) ) . [ ( ( (R42 , R9) -admissible ) . C328 ) , ( R9 . C328 ) ] ) by L1327 , L1328 , L1329 , L1299
.= ( (the OFun of R40) . [ ( ( (R42 , R9) -admissible ) . C328 ) , ( R9 . C328 ) ] ) by L1327 , L1285
.= ( D307 . C328 ) by L1335 , L150;
thus L1344: ( D308 . C328 ) = ( D307 . C328 ) by L1343;
end;
L1345: ( len D308 ) = ( len R9 ) by L150
.= ( len D307 ) by L150;
thus L1346: thesis by L1345 , L1331 , FINSEQ_1:14;
end;
theorem
L1347: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R9 being (FinSequence of R5) holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R35 being (State of R18) holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R42 being (State of R40) holds ((R40 = ( R17 -Mealy_union R18 ) & R35 = R42) implies ( (R35 , R9) -admissible ) = ( (R42 , R9) -admissible ))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R9 being (FinSequence of R5);
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R35 being (State of R18);
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R42 being (State of R40);
set D309 = R35;
assume that
L1348: R40 = ( R17 -Mealy_union R18 )
and
L1349: D309 = R42;
set D310 = ( (D309 , R9) -admissible );
set D311 = ( (R42 , R9) -admissible );
defpred S17[ Nat ] means ((1 <= $1 & $1 <= ( len D310 )) implies ( D310 . $1 ) = ( D311 . $1 ));
L1350: (for B210 being Nat holds (S17[ B210 ] implies S17[ ( B210 + 1 ) ]))
proof
let C329 being Nat;
assume L1351: ((1 <= C329 & C329 <= ( len D310 )) implies ( D310 . C329 ) = ( D311 . C329 ));
assume that
L1352: 1 <= ( C329 + 1 )
and
L1353: ( C329 + 1 ) <= ( len D310 );
L1354: (C329 = ( 0 ) or (( 0 ) < C329 & ( ( 0 ) + 1 ) = 1));
per cases  by L1354 , NAT_1:13;
suppose L1355: C329 = ( 0 );

thus L1356: ( D310 . ( C329 + 1 ) ) = D309 by L1355 , L7
.= ( D311 . ( C329 + 1 ) ) by L1349 , L1355 , L7;
end;
suppose L1357: 1 <= C329;

L1358: ( C329 + 1 ) <= ( ( len R9 ) + 1 ) by L1353 , L7;
L1359: C329 <= ( len R9 ) by L1358 , XREAL_1:6;
consider C330 being (Element of R5), C331 , C332 being (Element of R18) such that L1360: (C330 = ( R9 . C329 ) & C331 = ( D310 . C329 )) and L1361: (C332 = ( D310 . ( C329 + 1 ) ) & ( C330 -succ_of C331 ) = C332) by L1359 , L1357 , L7;
L1362: (ex B211 being (Element of R5) st (ex B212 , B213 being (Element of R40) st (B211 = ( R9 . C329 ) & B212 = ( D311 . C329 ) & B213 = ( D311 . ( C329 + 1 ) ) & ( B211 -succ_of B212 ) = B213))) by L1357 , L1359 , L7;
L1363: ( len R9 ) <= ( ( len R9 ) + 1 ) by NAT_1:11;
L1364: C329 <= ( ( len R9 ) + 1 ) by L1363 , L1359 , XXREAL_0:2;
L1365: ( dom (the Tran of R18) ) = [: (the carrier of R18) , R5 :] by FUNCT_2:def 1;
thus L1366: ( D310 . ( C329 + 1 ) ) = ( ( (the Tran of R17) +* (the Tran of R18) ) . [ C331 , C330 ] ) by L1365 , L1361 , FUNCT_4:13
.= ( D311 . ( C329 + 1 ) ) by L1348 , L1351 , L1357 , L1360 , L1362 , L1364 , L7 , L1285;
end;
end;
L1368: S17[ ( 0 ) ];
L1369: (for B214 being Nat holds S17[ B214 ]) from NAT_1:sch 2(L1368 , L1350);
L1370: ( len D310 ) = ( ( len R9 ) + 1 ) by L7
.= ( len D311 ) by L7;
thus L1371: thesis by L1370 , L1369 , FINSEQ_1:14;
end;
theorem
L1372: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R9 being (FinSequence of R5) holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (for R35 being (State of R18) holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R42 being (State of R40) holds ((R40 = ( R17 -Mealy_union R18 ) & R35 = R42) implies ( (R35 , R9) -response ) = ( (R42 , R9) -response ))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R9 being (FinSequence of R5);
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
let R35 being (State of R18);
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R42 being (State of R40);
set D312 = R35;
assume that
L1373: R40 = ( R17 -Mealy_union R18 )
and
L1374: D312 = R42;
set D313 = ( (D312 , R9) -admissible );
set D314 = ( (R42 , R9) -response );
set D315 = ( (D312 , R9) -response );
L1375: ( len D315 ) = ( len R9 ) by L150;
L1376:
now
let C333 being Nat;
assume L1377: (1 <= C333 & C333 <= ( len D315 ));
L1378: C333 in ( Seg ( len R9 ) ) by L1377 , L1375 , FINSEQ_1:1;
L1379: C333 in ( dom R9 ) by L1378 , FINSEQ_1:def 3;
L1380: C333 in ( Seg ( ( len R9 ) + 1 ) ) by L1378 , FINSEQ_2:8;
L1381: C333 in ( Seg ( len D313 ) ) by L1380 , L7;
L1382: C333 in ( dom D313 ) by L1381 , FINSEQ_1:def 3;
L1383: ( D313 . C333 ) in (the carrier of R18) by L1382 , FINSEQ_2:11;
L1384: (( dom (the OFun of R18) ) = [: (the carrier of R18) , R5 :] & ( R9 . C333 ) in R5) by L1379 , FINSEQ_2:11 , FUNCT_2:def 1;
L1385: [ ( D313 . C333 ) , ( R9 . C333 ) ] in ( dom (the OFun of R18) ) by L1384 , L1383 , ZFMISC_1:87;
L1386: ( D315 . C333 ) = ( (the OFun of R18) . [ ( ( (D312 , R9) -admissible ) . C333 ) , ( R9 . C333 ) ] ) by L1379 , L150
.= ( ( (the OFun of R17) +* (the OFun of R18) ) . [ ( D313 . C333 ) , ( R9 . C333 ) ] ) by L1385 , FUNCT_4:13
.= ( ( (the OFun of R17) +* (the OFun of R18) ) . [ ( ( (R42 , R9) -admissible ) . C333 ) , ( R9 . C333 ) ] ) by L1373 , L1374 , L1347
.= ( (the OFun of R40) . [ ( ( (R42 , R9) -admissible ) . C333 ) , ( R9 . C333 ) ] ) by L1373 , L1285
.= ( D314 . C333 ) by L1379 , L150;
thus L1387: ( D315 . C333 ) = ( D314 . C333 ) by L1386;
end;
L1388: ( len D315 ) = ( len R9 ) by L150
.= ( len D314 ) by L150;
thus L1389: thesis by L1388 , L1376 , FINSEQ_1:14;
end;
theorem
L1390: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R50 being  reduced non  empty Mealy-FSM over R5 , R6 holds (for R51 being  reduced non  empty Mealy-FSM over R5 , R6 holds ((R40 = ( R50 -Mealy_union R51 ) & (the carrier of R50) misses (the carrier of R51) & R50 , R51 -are_equivalent ) implies (ex B215 being (State of ( the_reduction_of R40 )) st ((the InitS of R50) in B215 & (the InitS of R51) in B215 & B215 = (the InitS of ( the_reduction_of R40 ))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R50 being  reduced non  empty Mealy-FSM over R5 , R6;
let R51 being  reduced non  empty Mealy-FSM over R5 , R6;
set D316 = R50;
set D317 = R51;
assume that
L1391: R40 = ( D316 -Mealy_union D317 )
and
L1392: (the carrier of D316) misses (the carrier of D317)
and
L1393: D316 , D317 -are_equivalent ;
set D318 = (the carrier of D317);
set D319 = (the carrier of R40);
set D320 = (the carrier of D316);
L1394: D319 = ( D320 \/ D318 ) by L1391 , L1285;
reconsider D321 = (the InitS of D317) as (Element of D319) by L1394 , XBOOLE_0:def 3;
reconsider D322 = (the InitS of D316) as (Element of D319) by L1391 , L1285;
L1395:
now
let C334 being (FinSequence of R5);
L1396: ( ((the InitS of D316) , C334) -response ) = ( ((the InitS of D317) , C334) -response ) by L1393 , L326;
thus L1397: ( (D322 , C334) -response ) = ( ((the InitS of D317) , C334) -response ) by L1396 , L1391 , L1392 , L1326
.= ( (D321 , C334) -response ) by L1391 , L1372;
end;
L1398: D322 , D321 -are_equivalent  by L1395 , L332;
set D323 = ( the_reduction_of R40 );
L1399: (the InitS of R40) = (the InitS of D316) by L1391 , L1285;
L1400: (the InitS of D316) in (the InitS of D323) by L1399 , L823;
set D324 = (the carrier of D323);
L1401: D324 = ( final_states_partition R40 ) by L823;
L1402: ( final_states_partition R40 ) is  final by L689;
consider C335 being (Element of D324) such that L1403: D322 in C335 and L1404: D321 in C335 by L1402 , L1401 , L1398 , L642;
take C335;
thus L1405: ((the InitS of D316) in C335 & (the InitS of D317) in C335) by L1403 , L1404;
L1406: (C335 is (Subset of D319) & (the InitS of D323) is (Subset of D319)) by L1401 , TARSKI:def 3;
L1407: (C335 = (the InitS of D323) or C335 misses (the InitS of D323)) by L1406 , L1401 , EQREL_1:def 4;
thus L1408: thesis by L1407 , L1403 , L1400 , XBOOLE_0:3;
end;
theorem
L1409: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R52 being  connected  reduced non  empty Mealy-FSM over R5 , R6 holds (for R53 being  connected  reduced non  empty Mealy-FSM over R5 , R6 holds (for R54 being (State of R40) holds (for R55 being (State of R40) holds (for B216 , B217 being (State of R52) holds ((B216 = R54 & B217 = R55 & (the carrier of R52) misses (the carrier of R53) & R40 = ( R52 -Mealy_union R53 ) & (not B216 , B217 -are_equivalent )) implies (not R54 , R55 -are_equivalent ))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R52 being  connected  reduced non  empty Mealy-FSM over R5 , R6;
let R53 being  connected  reduced non  empty Mealy-FSM over R5 , R6;
let R54 being (State of R40);
let R55 being (State of R40);
let C336 , C337 being (State of R52);
set D325 = R52;
set D326 = R53;
set D327 = C336;
set D328 = C337;
assume that
L1410: D327 = R54
and
L1411: D328 = R55
and
L1412: ((the carrier of D325) misses (the carrier of D326) & R40 = ( D325 -Mealy_union D326 ));
assume L1413: (not D327 , D328 -are_equivalent );
consider C338 being (FinSequence of R5) such that L1414: ( (D327 , C338) -response ) <> ( (D328 , C338) -response ) by L1413 , L332;
L1415: ( (R54 , C338) -response ) = ( (D327 , C338) -response ) by L1410 , L1412 , L1326;
L1416: ( (R54 , C338) -response ) <> ( (R55 , C338) -response ) by L1415 , L1411 , L1412 , L1414 , L1326;
thus L1417: thesis by L1416 , L332;
end;
theorem
L1418: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R52 being  connected  reduced non  empty Mealy-FSM over R5 , R6 holds (for R53 being  connected  reduced non  empty Mealy-FSM over R5 , R6 holds (for R54 being (State of R40) holds (for R55 being (State of R40) holds (for B218 , B219 being (State of R53) holds ((B218 = R54 & B219 = R55 & R40 = ( R52 -Mealy_union R53 ) & (not B218 , B219 -are_equivalent )) implies (not R54 , R55 -are_equivalent ))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R52 being  connected  reduced non  empty Mealy-FSM over R5 , R6;
let R53 being  connected  reduced non  empty Mealy-FSM over R5 , R6;
let R54 being (State of R40);
let R55 being (State of R40);
let C339 , C340 being (State of R53);
set D329 = R52;
set D330 = R53;
set D331 = C339;
set D332 = C340;
assume that
L1419: D331 = R54
and
L1420: D332 = R55
and
L1421: R40 = ( D329 -Mealy_union D330 );
assume L1422: (not D331 , D332 -are_equivalent );
consider C341 being (FinSequence of R5) such that L1423: ( (D331 , C341) -response ) <> ( (D332 , C341) -response ) by L1422 , L332;
L1424: ( (R54 , C341) -response ) = ( (D331 , C341) -response ) by L1419 , L1421 , L1372;
L1425: ( (R54 , C341) -response ) <> ( (R55 , C341) -response ) by L1424 , L1420 , L1421 , L1423 , L1372;
thus L1426: thesis by L1425 , L332;
end;
theorem
L1427: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R56 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (for R57 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (((the carrier of R56) misses (the carrier of R57) & R40 = ( R56 -Mealy_union R57 )) implies (for B220 being (State of ( the_reduction_of R40 )) holds (not (ex B221 , B222 being (Element of B220) st (B221 in (the carrier of R56) & B222 in (the carrier of R56) & B221 <> B222))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R56 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
let R57 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
set D333 = R56;
set D334 = R57;
assume that
L1428: (the carrier of D333) misses (the carrier of D334)
and
L1429: R40 = ( D333 -Mealy_union D334 );
given C342 being (Element of ( the_reduction_of R40 )) , C343 , C344 being (Element of C342) such that
L1430: (C343 in (the carrier of D333) & C344 in (the carrier of D333))
and
L1431: C343 <> C344;

consider C345 being  finite non  empty Mealy-FSM over R5 , R6 such that L1432: D333 , ( the_reduction_of C345 ) -are_isomorphic  by L1110;
set D335 = ( the_reduction_of C345 );
consider C346 being (Function of (the carrier of D333) , (the carrier of D335)) such that L1433: C346 is  bijective and L1434: ( C346 . (the InitS of D333) ) = (the InitS of D335) and L1435: (for B223 being (State of D333) holds (for B224 being (Element of R5) holds (( C346 . ( (the Tran of D333) . (B223 , B224) ) ) = ( (the Tran of D335) . (( C346 . B223 ) , B224) ) & ( (the OFun of D333) . (B223 , B224) ) = ( (the OFun of D335) . (( C346 . B223 ) , B224) )))) by L1432 , L922;
L1436: ( dom C346 ) = (the carrier of D333) by FUNCT_2:def 1;
L1437: ( C346 . C343 ) <> ( C346 . C344 ) by L1436 , L1430 , L1431 , L1433 , FUNCT_1:def 4;
L1438: ( rng C346 ) = (the carrier of D335) by L1433 , FUNCT_2:def 3;
reconsider D336 = ( C346 . C343 ) , D337 = ( C346 . C344 ) as (Element of D335) by L1438 , L1430 , L1436 , FUNCT_1:def 3;
L1439: (the carrier of R40) = ( (the carrier of D333) \/ (the carrier of D334) ) by L1429 , L1285;
reconsider D338 = C343 , D339 = C344 as (Element of R40) by L1439 , L1430 , XBOOLE_0:def 3;
reconsider D340 = D338 , D341 = D339 as (Element of D333) by L1430;
L1440: (not D336 , D337 -are_equivalent ) by L1437 , L1019;
L1441: (not D340 , D341 -are_equivalent ) by L1440 , L1435 , L979;
set D342 = ( the_reduction_of R40 );
L1442: ( final_states_partition R40 ) is  final by L689;
L1443: (the carrier of D342) = ( final_states_partition R40 ) by L823;
reconsider D343 = C342 as (Subset of R40) by L1443 , TARSKI:def 3;
L1444: D343 <> ( {} ) by L1443 , EQREL_1:def 4;
L1445: D338 , D339 -are_equivalent  by L1444 , L1442 , L1443 , L642;
thus L1446: contradiction by L1445 , L1428 , L1429 , L1441 , L1409;
end;
theorem
L1447: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R56 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (for R57 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (R40 = ( R56 -Mealy_union R57 ) implies (for B225 being (State of ( the_reduction_of R40 )) holds (not (ex B226 , B227 being (Element of B225) st (B226 in (the carrier of R57) & B227 in (the carrier of R57) & B226 <> B227))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R56 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
let R57 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
set D344 = R56;
set D345 = R57;
set D346 = ( the_reduction_of R40 );
consider C347 being  finite non  empty Mealy-FSM over R5 , R6 such that L1448: D345 , ( the_reduction_of C347 ) -are_isomorphic  by L1110;
set D347 = ( the_reduction_of C347 );
consider C348 being (Function of (the carrier of D345) , (the carrier of D347)) such that L1449: C348 is  bijective and L1450: ( C348 . (the InitS of D345) ) = (the InitS of D347) and L1451: (for B228 being (State of D345) holds (for B229 being (Element of R5) holds (( C348 . ( (the Tran of D345) . (B228 , B229) ) ) = ( (the Tran of D347) . (( C348 . B228 ) , B229) ) & ( (the OFun of D345) . (B228 , B229) ) = ( (the OFun of D347) . (( C348 . B228 ) , B229) )))) by L1448 , L922;
assume L1452: R40 = ( D344 -Mealy_union D345 );
L1453: (the carrier of R40) = ( (the carrier of D344) \/ (the carrier of D345) ) by L1452 , L1285;
given C349 being (Element of ( the_reduction_of R40 )) , C350 , C351 being (Element of C349) such that
L1454: C350 in (the carrier of D345)
and
L1455: C351 in (the carrier of D345)
and
L1456: C350 <> C351;

L1457: ( dom C348 ) = (the carrier of D345) by FUNCT_2:def 1;
L1458: ( C348 . C350 ) <> ( C348 . C351 ) by L1457 , L1454 , L1455 , L1456 , L1449 , FUNCT_1:def 4;
L1459: ( rng C348 ) = (the carrier of D347) by L1449 , FUNCT_2:def 3;
reconsider D348 = ( C348 . C350 ) , D349 = ( C348 . C351 ) as (Element of D347) by L1459 , L1454 , L1455 , L1457 , FUNCT_1:def 3;
reconsider D350 = C351 as (Element of R40) by L1455 , L1453 , XBOOLE_0:def 3;
reconsider D351 = D350 as (Element of D345) by L1455;
reconsider D352 = C350 as (Element of R40) by L1454 , L1453 , XBOOLE_0:def 3;
reconsider D353 = D352 as (Element of D345) by L1454;
L1460: (not D348 , D349 -are_equivalent ) by L1458 , L1019;
L1461: (not D353 , D351 -are_equivalent ) by L1460 , L1451 , L979;
L1462: (the carrier of D346) = ( final_states_partition R40 ) by L823;
reconsider D354 = C349 as (Subset of R40) by L1462 , TARSKI:def 3;
L1463: ( final_states_partition R40 ) is  final by L689;
L1464: D354 <> ( {} ) by L1462 , EQREL_1:def 4;
L1465: D352 , D350 -are_equivalent  by L1464 , L1463 , L1462 , L642;
thus L1466: contradiction by L1465 , L1452 , L1461 , L1418;
end;
theorem
L1467: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R40 being  finite non  empty Mealy-FSM over R5 , R6 holds (for R56 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (for R57 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (((the carrier of R56) misses (the carrier of R57) & R56 , R57 -are_equivalent  & R40 = ( R56 -Mealy_union R57 )) implies (for B230 being (State of ( the_reduction_of R40 )) holds (ex B231 , B232 being (Element of B230) st (B231 in (the carrier of R56) & B232 in (the carrier of R57) & (for B233 being (Element of B230) holds (B233 = B231 or B233 = B232)))))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R40 being  finite non  empty Mealy-FSM over R5 , R6;
let R56 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
let R57 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
set D355 = R56;
set D356 = R57;
assume that
L1468: (the carrier of D355) misses (the carrier of D356)
and
L1469: D355 , D356 -are_equivalent 
and
L1470: R40 = ( D355 -Mealy_union D356 );
set D357 = (the InitS of D356);
set D358 = (the InitS of D355);
L1471: ( (the carrier of D355) /\ (the carrier of D356) ) = ( {} ) by L1468 , XBOOLE_0:def 7;
set D359 = (the carrier of R40);
set D360 = (the carrier of D356);
set D361 = (the carrier of D355);
set D362 = ( the_reduction_of R40 );
set D363 = (the carrier of D362);
assume L1472: (not thesis);
consider C352 being (Element of ( the_reduction_of R40 )) such that L1473: (for B234 , B235 being (Element of C352) holds ((not B234 in (the carrier of D355)) or (not B235 in (the carrier of D356)) or (not (for B236 being (Element of C352) holds (B236 = B234 or B236 = B235))))) by L1472;
L1474: D363 = ( final_states_partition R40 ) by L823;
reconsider D364 = C352 as (Subset of D359) by L1474 , TARSKI:def 3;
L1475: ( union ( final_states_partition R40 ) ) = D359 by EQREL_1:def 4
.= ( D361 \/ D360 ) by L1470 , L1285;
L1476: D364 c= ( D361 \/ D360 ) by L1475 , L1474 , ZFMISC_1:74;
L1477: D364 in D363;
L1478: D364 in ( final_states_partition R40 ) by L1477 , L823;
L1479: D364 <> ( {} ) by L1478 , EQREL_1:def 4;
consider C353 being (Element of D359) such that L1480: C353 in D364 by L1479 , SUBSET_1:4;
per cases  by L1480 , L1476 , XBOOLE_0:def 3;
suppose L1481: C353 in D361;

set D365 = ( D364 \ { C353 } );
L1482:
now
L1483: D365 c= D364 by XBOOLE_1:36;
reconsider D366 = D364 as (Subset of D359);
assume L1484: D365 <> ( {} );
reconsider D367 = D365 as (Subset of D359);
consider C354 being (Element of D359) such that L1485: C354 in D367 by L1484 , SUBSET_1:4;
L1486: D367 c= ( D361 \/ D360 ) by L1476 , L1483 , XBOOLE_1:1;
per cases  by L1485 , L1486 , XBOOLE_0:def 3;
suppose L1487: C354 in D361;

reconsider D368 = C354 as (Element of D366) by L1485 , XBOOLE_0:def 5;
reconsider D369 = C353 as (Element of D366) by L1480;
L1488: ((not D369 in D361) or (not D368 in D361) or D369 = D368) by L1468 , L1470 , L1427;
thus L1489: contradiction by L1488 , L1481 , L1485 , L1487 , ZFMISC_1:56;
end;
suppose L1490: C354 in D360;

set D370 = ( D367 \ { C354 } );
L1491:
now
L1492: D370 c= D367 by XBOOLE_1:36;
reconsider D371 = D367 as (Subset of D359);
assume L1493: D370 <> ( {} );
reconsider D372 = D370 as (Subset of D359);
consider C355 being (Element of D359) such that L1494: C355 in D372 by L1493 , SUBSET_1:4;
L1495: D372 c= ( D361 \/ D360 ) by L1486 , L1492 , XBOOLE_1:1;
per cases  by L1494 , L1495 , XBOOLE_0:def 3;
suppose L1496: C355 in D361;

reconsider D373 = C353 as (Element of D366) by L1480;
L1497: C355 in D371 by L1494 , ZFMISC_1:56;
reconsider D374 = C355 as (Element of D366) by L1497 , ZFMISC_1:56;
L1498: ((not D373 in D361) or (not D374 in D361) or D373 = D374) by L1468 , L1470 , L1427;
thus L1499: contradiction by L1498 , L1481 , L1496 , L1497 , ZFMISC_1:56;
end;
suppose L1500: C355 in D360;

reconsider D375 = C354 as (Element of D366) by L1485 , ZFMISC_1:56;
L1501: C355 in D371 by L1494 , ZFMISC_1:56;
reconsider D376 = C355 as (Element of D366) by L1501 , ZFMISC_1:56;
L1502: ((not D375 in D360) or (not D376 in D360) or D375 = D376) by L1470 , L1447;
thus L1503: contradiction by L1502 , L1490 , L1494 , L1500 , ZFMISC_1:56;
end;
end;
L1505:
now
assume L1506: D370 = ( {} );
L1507: (for B237 being (Element of D366) holds (B237 = C353 or B237 = C354))
proof
given C356 being (Element of D366) such that
L1508: C356 <> C353
and
L1509: C356 <> C354;

L1510: C356 in D367 by L1479 , L1508 , ZFMISC_1:56;
thus L1511: contradiction by L1510 , L1506 , L1509 , ZFMISC_1:56;
end;
reconsider D377 = C354 as (Element of D366) by L1485 , ZFMISC_1:56;
reconsider D378 = C353 as (Element of D366) by L1480;
L1512: ((not D378 in D361) or (not D377 in D360) or (ex B238 being (Element of D366) st (B238 <> D378 & B238 <> D377))) by L1473;
thus L1513: contradiction by L1512 , L1481 , L1490 , L1507;
end;
thus L1514: contradiction by L1505 , L1491;
end;
end;
L1516:
now
reconsider D379 = C353 as (Element of D361) by L1481;
L1517: D379 is  accessible by L1125;
consider C357 being (FinSequence of R5) such that L1518: D358 , C357 -leads_to D379 by L1517 , L1123;
set D380 = ( D357 leads_to_under C357 );
L1519:
now
reconsider D381 = D379 as (Element of D359);
assume L1520: (not D380 in D364);
reconsider D382 = D381 as (Element of D361);
L1521: D380 in ( D361 \/ D360 ) by XBOOLE_0:def 3;
reconsider D383 = D380 as (Element of D359) by L1521 , L1470 , L1285;
L1522: (not (ex B239 being (Element of D363) st (D381 in B239 & D383 in B239)))
proof
reconsider D384 = D364 as (Subset of D359);
assume L1523: (not thesis);
consider C358 being (Element of D363) such that L1524: D381 in C358 and L1525: D383 in C358 by L1523;
reconsider D385 = C358 as (Subset of D359) by L1474 , TARSKI:def 3;
L1526: D385 in D363;
L1527: D385 in ( final_states_partition R40 ) by L1526 , L823;
L1528: D385 misses D384 by L1527 , L1478 , L1520 , L1525 , EQREL_1:def 4;
thus L1529: contradiction by L1528 , L1480 , L1524 , XBOOLE_0:3;
end;
reconsider D386 = D383 as (Element of D360);
L1530: ( final_states_partition R40 ) is  final by L689;
L1531: (not D381 , D383 -are_equivalent ) by L1530 , L1474 , L1522 , L642;
consider C359 being (FinSequence of R5) such that L1532: ( (D381 , C359) -response ) <> ( (D383 , C359) -response ) by L1531 , L332;
L1533: ( (D381 , C359) -response ) = ( (D382 , C359) -response ) by L1468 , L1470 , L1326;
L1534: ( (D382 , C359) -response ) <> ( (D386 , C359) -response ) by L1533 , L1470 , L1532 , L1372;
L1535: D357 , C357 -leads_to D386 by L50;
L1536: ( (D358 , ( C357 ^ C359 )) -response ) <> ( (D357 , ( C357 ^ C359 )) -response ) by L1535 , L1518 , L1534 , L257;
thus L1537: contradiction by L1536 , L1469 , L326;
end;
assume L1538: D365 = ( {} );
L1539:
now
assume L1540: D380 in D364;
L1541: D380 <> D379 by L1471 , XBOOLE_0:def 4;
thus L1542: contradiction by L1541 , L1538 , L1540 , ZFMISC_1:56;
end;
thus L1543: contradiction by L1539 , L1519;
end;
thus L1544: contradiction by L1516 , L1482;
end;
suppose L1545: C353 in D360;

set D387 = ( D364 \ { C353 } );
L1546:
now
L1547: D387 c= D364 by XBOOLE_1:36;
reconsider D388 = D364 as (Subset of D359);
assume L1548: D387 <> ( {} );
reconsider D389 = D387 as (Subset of D359);
consider C360 being (Element of D359) such that L1549: C360 in D389 by L1548 , SUBSET_1:4;
L1550: D389 c= ( D361 \/ D360 ) by L1476 , L1547 , XBOOLE_1:1;
per cases  by L1549 , L1550 , XBOOLE_0:def 3;
suppose L1551: C360 in D361;

set D390 = ( D389 \ { C360 } );
L1552:
now
L1553: D390 c= D389 by XBOOLE_1:36;
reconsider D391 = D389 as (Subset of D359);
assume L1554: D390 <> ( {} );
reconsider D392 = D390 as (Subset of D359);
consider C361 being (Element of D359) such that L1555: C361 in D392 by L1554 , SUBSET_1:4;
L1556: D392 c= ( D361 \/ D360 ) by L1550 , L1553 , XBOOLE_1:1;
per cases  by L1555 , L1556 , XBOOLE_0:def 3;
suppose L1557: C361 in D361;

reconsider D393 = C360 as (Element of D388) by L1549 , ZFMISC_1:56;
L1558: C361 in D391 by L1555 , ZFMISC_1:56;
reconsider D394 = C361 as (Element of D388) by L1558 , ZFMISC_1:56;
L1559: ((not D393 in D361) or (not D394 in D361) or D393 = D394) by L1468 , L1470 , L1427;
thus L1560: contradiction by L1559 , L1551 , L1555 , L1557 , ZFMISC_1:56;
end;
suppose L1561: C361 in D360;

reconsider D395 = C353 as (Element of D388) by L1480;
L1562: C361 in D391 by L1555 , ZFMISC_1:56;
reconsider D396 = C361 as (Element of D388) by L1562 , ZFMISC_1:56;
L1563: ((not D395 in D360) or (not D396 in D360) or D395 = D396) by L1470 , L1447;
thus L1564: contradiction by L1563 , L1545 , L1561 , L1562 , ZFMISC_1:56;
end;
end;
L1566:
now
assume L1567: D390 = ( {} );
L1568: (for B240 being (Element of D388) holds (B240 = C353 or B240 = C360))
proof
given C362 being (Element of D388) such that
L1569: C362 <> C353
and
L1570: C362 <> C360;

L1571: C362 in D389 by L1479 , L1569 , ZFMISC_1:56;
thus L1572: contradiction by L1571 , L1567 , L1570 , ZFMISC_1:56;
end;
reconsider D397 = C360 as (Element of D388) by L1549 , ZFMISC_1:56;
reconsider D398 = C353 as (Element of D388) by L1480;
L1573: ((not D397 in D361) or (not D398 in D360) or (ex B241 being (Element of D388) st (B241 <> D397 & B241 <> D398))) by L1473;
thus L1574: contradiction by L1573 , L1545 , L1551 , L1568;
end;
thus L1575: contradiction by L1566 , L1552;
end;
suppose L1576: C360 in D360;

reconsider D399 = C360 as (Element of D388) by L1549 , XBOOLE_0:def 5;
reconsider D400 = C353 as (Element of D388) by L1480;
L1577: ((not D400 in D360) or (not D399 in D360) or D400 = D399) by L1470 , L1447;
thus L1578: contradiction by L1577 , L1545 , L1549 , L1576 , ZFMISC_1:56;
end;
end;
L1580:
now
reconsider D401 = C353 as (Element of D360) by L1545;
L1581: D401 is  accessible by L1125;
consider C363 being (FinSequence of R5) such that L1582: D357 , C363 -leads_to D401 by L1581 , L1123;
set D402 = ( D358 leads_to_under C363 );
L1583:
now
reconsider D403 = D401 as (Element of D359);
assume L1584: (not D402 in D364);
reconsider D404 = D403 as (Element of D360);
L1585: D402 in ( D361 \/ D360 ) by XBOOLE_0:def 3;
reconsider D405 = D402 as (Element of D359) by L1585 , L1470 , L1285;
L1586: (not (ex B242 being (Element of D363) st (D403 in B242 & D405 in B242)))
proof
assume L1587: (not thesis);
consider C364 being (Element of D363) such that L1588: D403 in C364 and L1589: D405 in C364 by L1587;
reconsider D406 = C364 as (Subset of D359) by L1474 , TARSKI:def 3;
L1590: D406 in D363;
L1591: D406 in ( final_states_partition R40 ) by L1590 , L823;
L1592: D406 misses D364 by L1591 , L1478 , L1584 , L1589 , EQREL_1:def 4;
thus L1593: contradiction by L1592 , L1480 , L1588 , XBOOLE_0:3;
end;
reconsider D407 = D405 as (Element of D361);
L1594: ( final_states_partition R40 ) is  final by L689;
L1595: (not D403 , D405 -are_equivalent ) by L1594 , L1474 , L1586 , L642;
consider C365 being (FinSequence of R5) such that L1596: ( (D403 , C365) -response ) <> ( (D405 , C365) -response ) by L1595 , L332;
L1597: ( (D403 , C365) -response ) = ( (D404 , C365) -response ) by L1470 , L1372;
L1598: ( (D404 , C365) -response ) <> ( (D407 , C365) -response ) by L1597 , L1468 , L1470 , L1596 , L1326;
L1599: D358 , C363 -leads_to D407 by L50;
L1600: ( (D357 , ( C363 ^ C365 )) -response ) <> ( (D358 , ( C363 ^ C365 )) -response ) by L1599 , L1582 , L1598 , L257;
thus L1601: contradiction by L1600 , L1469 , L326;
end;
assume L1602: D387 = ( {} );
L1603:
now
assume L1604: D402 in D364;
L1605: D402 <> D401 by L1468 , XBOOLE_0:3;
thus L1606: contradiction by L1605 , L1602 , L1604 , ZFMISC_1:56;
end;
thus L1607: contradiction by L1603 , L1583;
end;
thus L1608: contradiction by L1580 , L1546;
end;
end;
begin
theorem
L1610: (for R5 being non  empty set holds (for R6 being non  empty set holds (for B243 , B244 being  finite non  empty Mealy-FSM over R5 , R6 holds (ex B245 , B246 being  finite non  empty Mealy-FSM over R5 , R6 st ((the carrier of B245) misses (the carrier of B246) & B245 , B243 -are_isomorphic  & B246 , B244 -are_isomorphic )))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
deffunc H9(set) = ( $1 `2 );
set D408 = ( 0 );
set D409 = 1;
set D410 = { D408 };
set D411 = { D409 };
let C366 , C367 being  finite non  empty Mealy-FSM over R5 , R6;
set D412 = (the carrier of C366);
set D413 = (the Tran of C366);
set D414 = (the OFun of C366);
set D415 = (the carrier of C367);
set D416 = (the Tran of C367);
set D417 = (the OFun of C367);
set D418 = [: { ( 0 ) } , D412 :];
set D419 = [: { 1 } , D415 :];
deffunc H10((Element of D418) , (Element of R5)) = [ ( $1 `1 ) , ( D413 . [ ( $1 `2 ) , $2 ] ) ];
consider C368 being (Function of [: D418 , R5 :] , D418) such that L1611: (for B247 being (Element of D418) holds (for B248 being (Element of R5) holds ( C368 . (B247 , B248) ) = H10(B247 , B248))) from BINOP_1:sch 4;
reconsider D420 = [ 1 , (the InitS of C367) ] as (Element of D419) by ZFMISC_1:105;
reconsider D421 = [: D411 , D415 :] as  finite non  empty set;
reconsider D422 = [ ( 0 ) , (the InitS of C366) ] as (Element of D418) by ZFMISC_1:105;
set D423 = [: D410 , D412 :];
deffunc H11((Element of D418) , (Element of R5)) = ( D414 . [ ( $1 `2 ) , $2 ] );
consider C369 being (Function of [: D418 , R5 :] , R6) such that L1612: (for B249 being (Element of D418) holds (for B250 being (Element of R5) holds ( C369 . (B249 , B250) ) = H11(B249 , B250))) from BINOP_1:sch 4;
reconsider D424 = D420 as (Element of D421);
set D425 = D422;
reconsider D426 = C369 as (Function of [: D423 , R5 :] , R6);
reconsider D427 = C368 as (Function of [: D423 , R5 :] , D423);
deffunc H12((Element of D419) , (Element of R5)) = [ ( $1 `1 ) , ( D416 . [ ( $1 `2 ) , $2 ] ) ];
consider C370 being (Function of [: D419 , R5 :] , D419) such that L1613: (for B251 being (Element of D419) holds (for B252 being (Element of R5) holds ( C370 . (B251 , B252) ) = H12(B251 , B252))) from BINOP_1:sch 4;
reconsider D428 = C370 as (Function of [: D421 , R5 :] , D421);
take D429 = Mealy-FSM (# D423 , D427 , D426 , D425 #);
deffunc H13((Element of D419) , (Element of R5)) = ( D417 . [ ( $1 `2 ) , $2 ] );
consider C371 being (Function of [: D419 , R5 :] , R6) such that L1614: (for B253 being (Element of D419) holds (for B254 being (Element of R5) holds ( C371 . (B253 , B254) ) = H13(B253 , B254))) from BINOP_1:sch 4;
L1615: D410 misses D411 by ZFMISC_1:11;
reconsider D430 = C371 as (Function of [: D421 , R5 :] , R6);
take D431 = Mealy-FSM (# D421 , D428 , D430 , D424 #);
L1616: ( D418 /\ D419 ) = [: ( D410 /\ D411 ) , ( D412 /\ D415 ) :] by ZFMISC_1:100
.= [: ( {} ) , ( D412 /\ D415 ) :] by L1615 , XBOOLE_0:def 7
.= ( {} ) by ZFMISC_1:90;
thus L1617: ( (the carrier of D429) /\ (the carrier of D431) ) = ( {} ) by L1616;
thus L1618: D429 , C366 -are_isomorphic 
proof
deffunc H14(set) = ( $1 `2 );
consider C372 being Function such that L1619: (( dom C372 ) = (the carrier of D429) & (for B255 being set holds (B255 in (the carrier of D429) implies ( C372 . B255 ) = H14(B255)))) from FUNCT_1:sch 3;
L1620: ( rng C372 ) = D412
proof
assume L1621: (not ( rng C372 ) = D412);
per cases  by L1621 , XBOOLE_0:def 10;
suppose L1622: (not ( rng C372 ) c= D412);

consider C373 being set such that L1623: C373 in ( rng C372 ) and L1624: (not C373 in D412) by L1622 , TARSKI:def 3;
consider C374 being set such that L1625: C374 in ( dom C372 ) and L1626: C373 = ( C372 . C374 ) by L1623 , FUNCT_1:def 3;
reconsider D432 = ( C374 `2 ) as (Element of D412) by L1619 , L1625 , MCART_1:10;
L1627: D432 in D412;
thus L1628: contradiction by L1627 , L1619 , L1624 , L1625 , L1626;
end;
suppose L1629: (not D412 c= ( rng C372 ));

consider C375 being set such that L1630: C375 in D412 and L1631: (not C375 in ( rng C372 )) by L1629 , TARSKI:def 3;
L1632: ( 0 ) in { ( 0 ) } by TARSKI:def 1;
L1633: [ ( 0 ) , C375 ] in D423 by L1632 , L1630 , ZFMISC_1:87;
L1634: (( C372 . [ ( 0 ) , C375 ] ) in ( rng C372 ) & ( C372 . [ ( 0 ) , C375 ] ) = ( [ ( 0 ) , C375 ] `2 )) by L1633 , L1619 , FUNCT_1:def 3;
thus L1635: contradiction by L1634 , L1631;
end;
end;
reconsider D433 = C372 as (Function of (the carrier of D429) , (the carrier of C366)) by L1620 , L1619 , FUNCT_2:1;
take D433;
L1637:
now
let C376 , C377 being set;
assume that
L1638: C376 in ( dom C372 )
and
L1639: C377 in ( dom C372 )
and
L1640: ( C372 . C376 ) = ( C372 . C377 );
L1641: (( C372 . C376 ) = ( C376 `2 ) & ( C372 . C377 ) = ( C377 `2 )) by L1619 , L1638 , L1639;
L1642: ( C376 `1 ) in D410 by L1619 , L1638 , MCART_1:10;
L1643: ( C376 `1 ) = ( 0 ) by L1642 , TARSKI:def 1;
L1644: ( C377 `1 ) in D410 by L1619 , L1639 , MCART_1:10;
L1645: (C376 = [ ( C376 `1 ) , ( C376 `2 ) ] & C377 = [ ( C377 `1 ) , ( C377 `2 ) ]) by L1619 , L1638 , L1639 , MCART_1:21;
thus L1646: C376 = C377 by L1645 , L1640 , L1641 , L1644 , L1643 , TARSKI:def 1;
end;
L1647: D433 is  one-to-one  onto by L1637 , L1620 , FUNCT_1:def 4 , FUNCT_2:def 3;
thus L1648: D433 is  bijective by L1647;
thus L1649: ( D433 . (the InitS of D429) ) = ( D425 `2 ) by L1619
.= (the InitS of C366) by MCART_1:7;
L1650:
now
let C378 being (State of D429);
let C379 being (Element of R5);
reconsider D434 = ( C378 `2 ) as (Element of D412) by MCART_1:10;
reconsider D435 = ( D413 . [ D434 , C379 ] ) as (Element of D412);
L1651: ( C378 `1 ) in D410 by MCART_1:10;
L1652: [ ( C378 `1 ) , D435 ] in [: D410 , D412 :] by L1651 , ZFMISC_1:87;
thus L1653: ( D433 . ( (the Tran of D429) . (C378 , C379) ) ) = ( D433 . (( C378 `1 ) , ( D413 . (( C378 `2 ) , C379) )) ) by L1611
.= ( [ ( C378 `1 ) , ( D413 . [ ( C378 `2 ) , C379 ] ) ] `2 ) by L1619 , L1652
.= ( D413 . [ ( C378 `2 ) , C379 ] )
.= ( (the Tran of C366) . [ ( D433 . C378 ) , C379 ] ) by L1619;
thus L1654: ( (the OFun of D429) . (C378 , C379) ) = ( D414 . (( C378 `2 ) , C379) ) by L1612
.= ( (the OFun of C366) . (( D433 . C378 ) , C379) ) by L1619;
end;
thus L1655: thesis by L1650;
end;

consider C380 being Function such that L1656: (( dom C380 ) = (the carrier of D431) & (for B256 being set holds (B256 in (the carrier of D431) implies ( C380 . B256 ) = H9(B256)))) from FUNCT_1:sch 3;
L1657: ( rng C380 ) = D415
proof
assume L1658: (not ( rng C380 ) = D415);
per cases  by L1658 , XBOOLE_0:def 10;
suppose L1659: (not ( rng C380 ) c= D415);

consider C381 being set such that L1660: C381 in ( rng C380 ) and L1661: (not C381 in D415) by L1659 , TARSKI:def 3;
consider C382 being set such that L1662: C382 in ( dom C380 ) and L1663: C381 = ( C380 . C382 ) by L1660 , FUNCT_1:def 3;
reconsider D436 = ( C382 `2 ) as (Element of D415) by L1656 , L1662 , MCART_1:10;
L1664: D436 in D415;
thus L1665: contradiction by L1664 , L1656 , L1661 , L1662 , L1663;
end;
suppose L1666: (not D415 c= ( rng C380 ));

consider C383 being set such that L1667: C383 in D415 and L1668: (not C383 in ( rng C380 )) by L1666 , TARSKI:def 3;
L1669: 1 in { 1 } by TARSKI:def 1;
L1670: [ 1 , C383 ] in D421 by L1669 , L1667 , ZFMISC_1:87;
L1671: (( C380 . [ 1 , C383 ] ) in ( rng C380 ) & ( C380 . [ 1 , C383 ] ) = ( [ 1 , C383 ] `2 )) by L1670 , L1656 , FUNCT_1:def 3;
thus L1672: contradiction by L1671 , L1668;
end;
end;
reconsider D437 = C380 as (Function of (the carrier of D431) , (the carrier of C367)) by L1657 , L1656 , FUNCT_2:1;
take D437;
L1674:
now
let C384 , C385 being set;
assume that
L1675: C384 in ( dom C380 )
and
L1676: C385 in ( dom C380 )
and
L1677: ( C380 . C384 ) = ( C380 . C385 );
L1678: (( C380 . C384 ) = ( C384 `2 ) & ( C380 . C385 ) = ( C385 `2 )) by L1656 , L1675 , L1676;
L1679: ( C384 `1 ) in D411 by L1656 , L1675 , MCART_1:10;
L1680: ( C384 `1 ) = 1 by L1679 , TARSKI:def 1;
L1681: ( C385 `1 ) in D411 by L1656 , L1676 , MCART_1:10;
L1682: (C384 = [ ( C384 `1 ) , ( C384 `2 ) ] & C385 = [ ( C385 `1 ) , ( C385 `2 ) ]) by L1656 , L1675 , L1676 , MCART_1:21;
thus L1683: C384 = C385 by L1682 , L1677 , L1678 , L1681 , L1680 , TARSKI:def 1;
end;
L1684: D437 is  one-to-one  onto by L1674 , L1657 , FUNCT_1:def 4 , FUNCT_2:def 3;
thus L1685: D437 is  bijective by L1684;
thus L1686: ( D437 . (the InitS of D431) ) = ( D424 `2 ) by L1656
.= (the InitS of C367) by MCART_1:7;
L1687:
now
let C386 being (State of D431);
let C387 being (Element of R5);
reconsider D438 = ( C386 `2 ) as (Element of D415) by MCART_1:10;
set D439 = ( D416 . [ D438 , C387 ] );
L1688: ( C386 `1 ) in D411 by MCART_1:10;
L1689: [ ( C386 `1 ) , D439 ] in [: D411 , D415 :] by L1688 , ZFMISC_1:87;
thus L1690: ( D437 . ( (the Tran of D431) . (C386 , C387) ) ) = ( D437 . (( C386 `1 ) , ( D416 . (( C386 `2 ) , C387) )) ) by L1613
.= ( [ ( C386 `1 ) , ( D416 . [ ( C386 `2 ) , C387 ] ) ] `2 ) by L1656 , L1689
.= ( D416 . [ ( C386 `2 ) , C387 ] )
.= ( (the Tran of C367) . [ ( D437 . C386 ) , C387 ] ) by L1656;
thus L1691: ( (the OFun of D431) . (C386 , C387) ) = ( D417 . (( C386 `2 ) , C387) ) by L1614
.= ( (the OFun of C367) . [ ( D437 . C386 ) , C387 ] ) by L1656;
end;
thus L1692: thesis by L1687;
end;
theorem
L1693: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R17 being non  empty Mealy-FSM over R5 , R6 holds (for R18 being non  empty Mealy-FSM over R5 , R6 holds (R17 , R18 -are_isomorphic  implies R17 , R18 -are_equivalent )))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R17 being non  empty Mealy-FSM over R5 , R6;
let R18 being non  empty Mealy-FSM over R5 , R6;
assume L1694: R17 , R18 -are_isomorphic ;
consider R45 being (Function of (the carrier of R17) , (the carrier of R18)) such that L1695: R45 is  bijective and L1696: ( R45 . (the InitS of R17) ) = (the InitS of R18) and L1697: (for B257 being (Element of R17) holds (for B258 being (Element of R5) holds (( R45 . ( (the Tran of R17) . (B257 , B258) ) ) = ( (the Tran of R18) . (( R45 . B257 ) , B258) ) & ( (the OFun of R17) . (B257 , B258) ) = ( (the OFun of R18) . (( R45 . B257 ) , B258) )))) by L1694 , L922;
L1698:
now
let C388 being (FinSequence of R5);
set D440 = ( ((the InitS of R17) , C388) -response );
set D441 = ( ((the InitS of R18) , C388) -response );
set D442 = ( ((the InitS of R17) , C388) -admissible );
set D443 = ( ((the InitS of R18) , C388) -admissible );
L1699: (for B259 being (Element of ( NAT )) holds ((1 <= B259 & B259 <= ( ( len C388 ) + 1 )) implies ( R45 . ( D442 . B259 ) ) = ( D443 . B259 )))
proof
defpred S18[ (Element of ( NAT )) ] means ((1 <= $1 & $1 <= ( ( len C388 ) + 1 )) implies ( R45 . ( D442 . $1 ) ) = ( D443 . $1 ));
L1700: (for B260 being (Element of ( NAT )) holds (S18[ B260 ] implies S18[ ( B260 + 1 ) ]))
proof
let C389 being (Element of ( NAT ));
assume L1701: ((1 <= C389 & C389 <= ( ( len C388 ) + 1 )) implies ( R45 . ( D442 . C389 ) ) = ( D443 . C389 ));
assume that
L1702: 1 <= ( C389 + 1 )
and
L1703: ( C389 + 1 ) <= ( ( len C388 ) + 1 );
L1704: (( 0 ) = C389 or (( 0 ) < C389 & ( ( 0 ) + 1 ) = 1));
per cases  by L1704 , NAT_1:13;
suppose L1705: ( 0 ) = C389;

thus L1706: ( R45 . ( D442 . ( C389 + 1 ) ) ) = (the InitS of R18) by L1705 , L1696 , L7
.= ( D443 . ( C389 + 1 ) ) by L1705 , L7;
end;
suppose L1707: 1 <= C389;

L1708: ( len C388 ) <= ( ( len C388 ) + 1 ) by NAT_1:11;
L1709: C389 <= ( len C388 ) by L1703 , XREAL_1:6;
consider C390 being (Element of R5), C391 , C392 being (Element of R17) such that L1710: (C390 = ( C388 . C389 ) & C391 = ( D442 . C389 )) and L1711: (C392 = ( D442 . ( C389 + 1 ) ) & ( C390 -succ_of C391 ) = C392) by L1709 , L1707 , L7;
consider C393 being (Element of R5), C394 , C395 being (Element of R18) such that L1712: (C393 = ( C388 . C389 ) & C394 = ( D443 . C389 )) and L1713: (C395 = ( D443 . ( C389 + 1 ) ) & ( C393 -succ_of C394 ) = C395) by L1707 , L1709 , L7;
thus L1714: ( R45 . ( D442 . ( C389 + 1 ) ) ) = ( R45 . ( (the Tran of R17) . (C391 , C390) ) ) by L1711
.= ( (the Tran of R18) . (C394 , C393) ) by L1697 , L1701 , L1707 , L1709 , L1710 , L1712 , L1708 , XXREAL_0:2
.= ( D443 . ( C389 + 1 ) ) by L1713;
end;
end;
L1716: S18[ ( 0 ) ];
thus L1717: (for B261 being (Element of ( NAT )) holds S18[ B261 ]) from NAT_1:sch 1(L1716 , L1700);
end;
L1718:
now
let C396 being Nat;
assume that
L1719: 1 <= C396
and
L1720: C396 <= ( len D440 );
L1721: C396 <= ( len C388 ) by L1720 , L150;
L1722: C396 in ( dom C388 ) by L1721 , L1719 , FINSEQ_3:25;
L1723: ( C388 . C396 ) is (Element of R5) by L1722 , FINSEQ_2:11;
L1724: C396 in ( Seg ( len C388 ) ) by L1722 , FINSEQ_1:def 3;
L1725: C396 in ( Seg ( ( len C388 ) + 1 ) ) by L1724 , FINSEQ_2:8;
L1726: C396 in ( Seg ( len D442 ) ) by L1725 , L7;
L1727: C396 in ( dom D442 ) by L1726 , FINSEQ_1:def 3;
L1728: 1 <= C396 by L1727 , FINSEQ_3:25;
L1729: C396 <= ( len D442 ) by L1727 , FINSEQ_3:25;
L1730: C396 <= ( ( len C388 ) + 1 ) by L1729 , L7;
L1731: C396 in ( NAT ) by ORDINAL1:def 12;
L1732: ( D442 . C396 ) is (Element of R17) by L1727 , FINSEQ_2:11;
thus L1733: ( D441 . C396 ) = ( (the OFun of R18) . [ ( D443 . C396 ) , ( C388 . C396 ) ] ) by L1722 , L150
.= ( (the OFun of R18) . (( R45 . ( D442 . C396 ) ) , ( C388 . C396 )) ) by L1699 , L1728 , L1730 , L1731
.= ( (the OFun of R17) . (( D442 . C396 ) , ( C388 . C396 )) ) by L1697 , L1732 , L1723
.= ( D440 . C396 ) by L1722 , L150;
end;
L1734: ( len D440 ) = ( len C388 ) by L150
.= ( len D441 ) by L150;
thus L1735: D440 = D441 by L1734 , L1718 , FINSEQ_1:14;
end;
thus L1736: thesis by L1698 , L326;
end;
theorem
L1737: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R56 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (for R57 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (((the carrier of R56) misses (the carrier of R57) & R56 , R57 -are_equivalent ) implies R56 , R57 -are_isomorphic )))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R56 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
let R57 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
set D444 = R56;
set D445 = R57;
assume that
L1738: (the carrier of D444) misses (the carrier of D445)
and
L1739: D444 , D445 -are_equivalent ;
set D446 = (the carrier of D445);
set D447 = (the carrier of D444);
set D448 = ( D444 -Mealy_union D445 );
set D449 = ( the_reduction_of D448 );
set D450 = (the carrier of D449);
defpred S19[ set , set ] means (ex B262 being (Element of D450) st ($1 in B262 & $2 in ( B262 \ { $1 } )));
L1740: D450 = ( final_states_partition D448 ) by L823;
L1741: (for B263 being set holds (B263 in D447 implies (ex B264 being set st S19[ B263 , B264 ])))
proof
let C397 being set;
set D451 = { C397 };
L1742: ( union D450 ) = (the carrier of D448) by L1740 , EQREL_1:def 4;
assume L1743: C397 in D447;
L1744: C397 in ( D447 \/ D446 ) by L1743 , XBOOLE_0:def 3;
L1745: C397 in (the carrier of D448) by L1744 , L1285;
consider C398 being set such that L1746: C397 in C398 and L1747: C398 in D450 by L1745 , L1742 , TARSKI:def 4;
reconsider D452 = C398 as (Element of D450) by L1747;
consider C399 , C400 being (Element of D452) such that L1748: C399 in D447 and L1749: C400 in D446 and L1750: (for B265 being (Element of D452) holds (B265 = C399 or B265 = C400)) by L1738 , L1739 , L1467;
set D453 = C400;
take D453;
L1751: C397 <> C400 by L1738 , L1743 , L1749 , XBOOLE_0:3;
L1752: C400 in ( D452 \ D451 ) by L1751 , L1746 , ZFMISC_1:56;
thus L1753: thesis by L1752 , L1746;
end;
consider C401 being Function such that L1754: (( dom C401 ) = D447 & (for B266 being set holds (B266 in D447 implies S19[ B266 , ( C401 . B266 ) ]))) from CLASSES1:sch 1(L1741);
L1755:
now
assume L1756: ((not ( rng C401 ) c= D446) or (not D446 c= ( rng C401 )));
per cases  by L1756;
suppose L1757: (not ( rng C401 ) c= D446);

consider C402 being set such that L1758: C402 in ( rng C401 ) and L1759: (not C402 in D446) by L1757 , TARSKI:def 3;
consider C403 being set such that L1760: C403 in D447 and L1761: C402 = ( C401 . C403 ) by L1754 , L1758 , FUNCT_1:def 3;
consider C404 being (Element of D450) such that L1762: C403 in C404 and L1763: ( C401 . C403 ) in ( C404 \ { C403 } ) by L1754 , L1760;
L1764:
now
assume L1765: C402 in D447;
L1766: C402 <> C403 by L1761 , L1763 , ZFMISC_1:56;
thus L1767: contradiction by L1766 , L1738 , L1760 , L1761 , L1762 , L1763 , L1765 , L1427;
end;
L1768: C404 is (Subset of D448) by L1740 , TARSKI:def 3;
L1769: C404 is (Subset of ( D447 \/ D446 )) by L1768 , L1285;
L1770: C402 in C404 by L1761 , L1763;
thus L1771: contradiction by L1770 , L1759 , L1769 , L1764 , XBOOLE_0:def 3;
end;
suppose L1772: (not D446 c= ( rng C401 ));

L1773: ( union D450 ) = (the carrier of D448) by L1740 , EQREL_1:def 4;
consider C405 being set such that L1774: C405 in D446 and L1775: (not C405 in ( rng C401 )) by L1772 , TARSKI:def 3;
L1776: C405 in ( D447 \/ D446 ) by L1774 , XBOOLE_0:def 3;
L1777: C405 in (the carrier of D448) by L1776 , L1285;
consider C406 being set such that L1778: C405 in C406 and L1779: C406 in D450 by L1777 , L1773 , TARSKI:def 4;
reconsider D454 = C406 as (Element of D450) by L1779;
L1780: D454 is (Subset of D448) by L1740 , TARSKI:def 3;
consider C407 , C408 being (Element of D454) such that L1781: C407 in D447 and L1782: C408 in D446 and L1783: (for B267 being (Element of D454) holds (B267 = C407 or B267 = C408)) by L1738 , L1739 , L1467;
consider C409 being (Element of D450) such that L1784: C407 in C409 and L1785: ( C401 . C407 ) in ( C409 \ { C407 } ) by L1754 , L1781;
L1786: C409 is (Subset of D448) by L1740 , TARSKI:def 3;
L1787: (D454 = C409 or D454 misses C409) by L1786 , L1740 , L1780 , EQREL_1:def 4;
L1788: ( C401 . C407 ) in C409 by L1785;
L1789:
now
L1790:
now
assume L1791: ( C401 . C407 ) in D447;
L1792: ( C401 . C407 ) <> C407 by L1785 , ZFMISC_1:56;
thus L1793: contradiction by L1792 , L1738 , L1781 , L1784 , L1785 , L1791 , L1427;
end;
L1794: D454 is (Subset of ( D447 \/ D446 )) by L1780 , L1285;
L1795: (( C401 . C407 ) in D447 or ( C401 . C407 ) in D446) by L1794 , L1778 , L1784 , L1787 , L1788 , XBOOLE_0:3 , XBOOLE_0:def 3;
assume L1796: C405 <> ( C401 . C407 );
thus L1797: contradiction by L1796 , L1774 , L1778 , L1784 , L1785 , L1787 , L1795 , L1790 , L1447 , XBOOLE_0:3;
end;
thus L1798: contradiction by L1789 , L1754 , L1775 , L1781 , FUNCT_1:def 3;
end;
end;
L1800: ( rng C401 ) = D446 by L1755 , XBOOLE_0:def 10;
L1801:
now
let C410 , C411 being set;
assume that
L1802: C410 in ( dom C401 )
and
L1803: C411 in ( dom C401 )
and
L1804: ( C401 . C410 ) = ( C401 . C411 );
consider C412 being (Element of D450) such that L1805: (C410 in C412 & ( C401 . C410 ) in ( C412 \ { C410 } )) by L1754 , L1802;
consider C413 being (Element of D450) such that L1806: (C411 in C413 & ( C401 . C411 ) in ( C413 \ { C411 } )) by L1754 , L1803;
assume L1807: C410 <> C411;
L1808: (C412 is (Subset of D448) & C413 is (Subset of D448)) by L1740 , TARSKI:def 3;
L1809: (C412 = C413 or C412 misses C413) by L1808 , L1740 , EQREL_1:def 4;
thus L1810: contradiction by L1809 , L1738 , L1754 , L1802 , L1803 , L1804 , L1807 , L1805 , L1806 , L1427 , XBOOLE_0:3;
end;
reconsider D455 = C401 as (Function of D447 , D446) by L1754 , L1800 , FUNCT_2:1;
L1811: ( D455 . (the InitS of D444) ) = (the InitS of D445)
proof
consider C414 being (Element of D450) such that L1812: ((the InitS of D444) in C414 & ( D455 . (the InitS of D444) ) in ( C414 \ { (the InitS of D444) } )) by L1754;
consider C415 being (Element of D450) such that L1813: ((the InitS of D444) in C415 & (the InitS of D445) in C415) and L1814: C415 = (the InitS of D449) by L1738 , L1739 , L1390;
assume L1815: ( D455 . (the InitS of D444) ) <> (the InitS of D445);
L1816: (C415 is (Subset of D448) & C414 is (Subset of D448)) by L1740 , TARSKI:def 3;
L1817: (C415 = C414 or C415 misses C414) by L1816 , L1740 , EQREL_1:def 4;
thus L1818: contradiction by L1817 , L1815 , L1813 , L1812 , L1447 , XBOOLE_0:3;
end;
L1819: (for B268 being (State of D444) holds (for B269 being (Element of R5) holds (( D455 . ( (the Tran of D444) . (B268 , B269) ) ) = ( (the Tran of D445) . (( D455 . B268 ) , B269) ) & ( (the OFun of D444) . (B268 , B269) ) = ( (the OFun of D445) . (( D455 . B268 ) , B269) ))))
proof
let C416 being (State of D444);
let C417 being (Element of R5);
set D456 = ( (the Tran of D444) . [ C416 , C417 ] );
set D457 = ( D455 . C416 );
set D458 = ( (the Tran of D445) . [ D457 , C417 ] );
L1820: ( dom (the Tran of D445) ) = [: D446 , R5 :] by FUNCT_2:def 1;
L1821: (the carrier of D448) = ( D447 \/ D446 ) by L1285;
reconsider D459 = C416 as (Element of D448) by L1821 , XBOOLE_0:def 3;
L1822: ( D455 . C416 ) in ( rng D455 ) by L1754 , FUNCT_1:def 3;
reconsider D460 = ( D455 . D459 ) as (Element of D448) by L1822 , L1821 , XBOOLE_0:def 3;
set D461 = ( (the Tran of D448) . [ D459 , C417 ] );
set D462 = ( (the Tran of D448) . [ D460 , C417 ] );
L1823: D462 = ( ( (the Tran of D444) +* (the Tran of D445) ) . [ D460 , C417 ] ) by L1285
.= D458 by L1820 , FUNCT_4:13;
consider C418 being (Element of D450) such that L1824: (D456 in C418 & ( D455 . D456 ) in ( C418 \ { D456 } )) by L1754;
L1825: ( final_states_partition D448 ) is  final by L689;
L1826: (ex B270 being (Element of D450) st (C416 in B270 & ( D455 . C416 ) in ( B270 \ { C416 } ))) by L1754;
L1827: D459 , D460 -are_equivalent  by L1826 , L1740 , L1825 , L642;
L1828: D461 , D462 -are_equivalent  by L1827 , L390;
consider C419 being (Element of D450) such that L1829: (D461 in C419 & D462 in C419) by L1828 , L1740 , L1825 , L642;
L1830: ( (the carrier of D444) /\ (the carrier of D445) ) = ( {} ) by L1738 , XBOOLE_0:def 7;
L1831: ( dom (the Tran of D444) ) = [: D447 , R5 :] by FUNCT_2:def 1;
L1832: ( ( dom (the Tran of D444) ) /\ ( dom (the Tran of D445) ) ) = ( [: D447 , R5 :] /\ [: D446 , R5 :] ) by L1831 , FUNCT_2:def 1
.= [: ( {} ) , R5 :] by L1830 , ZFMISC_1:99
.= ( {} ) by ZFMISC_1:90;
L1833: ( dom (the Tran of D444) ) misses ( dom (the Tran of D445) ) by L1832 , XBOOLE_0:def 7;
L1834: D461 = ( ( (the Tran of D444) +* (the Tran of D445) ) . [ D459 , C417 ] ) by L1285
.= D456 by L1831 , L1833 , FUNCT_4:16;
L1835: C419 is (Subset of D448) by L1740 , TARSKI:def 3;
L1836:
now
L1837: C418 is (Subset of D448) by L1740 , TARSKI:def 3;
L1838: (C419 = C418 or C419 misses C418) by L1837 , L1740 , L1835 , EQREL_1:def 4;
assume L1839: ( D455 . D456 ) <> D458;
thus L1840: contradiction by L1839 , L1829 , L1834 , L1823 , L1824 , L1838 , L1447 , XBOOLE_0:3;
end;
thus L1841: ( D455 . ( (the Tran of D444) . (C416 , C417) ) ) = ( (the Tran of D445) . (( D455 . C416 ) , C417) ) by L1836;
L1842: ( dom (the OFun of D445) ) = [: D446 , R5 :] by FUNCT_2:def 1;
L1843: ( dom (the OFun of D444) ) = [: D447 , R5 :] by FUNCT_2:def 1;
L1844: ( ( dom (the OFun of D444) ) /\ ( dom (the OFun of D445) ) ) = [: ( D447 /\ D446 ) , R5 :] by L1843 , L1842 , ZFMISC_1:99
.= ( {} ) by L1830 , ZFMISC_1:90;
L1845: ( dom (the OFun of D444) ) misses ( dom (the OFun of D445) ) by L1844 , XBOOLE_0:def 7;
thus L1846: ( (the OFun of D444) . (C416 , C417) ) = ( ( (the OFun of D444) +* (the OFun of D445) ) . [ C416 , C417 ] ) by L1845 , L1843 , FUNCT_4:16
.= ( (the OFun of D448) . [ D459 , C417 ] ) by L1285
.= ( (the OFun of D448) . [ D460 , C417 ] ) by L1827 , L390
.= ( ( (the OFun of D444) +* (the OFun of D445) ) . [ ( D455 . C416 ) , C417 ] ) by L1285
.= ( (the OFun of D445) . (( D455 . C416 ) , C417) ) by L1842 , FUNCT_4:13;
end;
L1847: D455 is  one-to-one  onto by L1801 , L1800 , FUNCT_1:def 4 , FUNCT_2:def 3;
thus L1848: thesis by L1847 , L1811 , L1819 , L922;
end;
theorem
L1849: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R48 being  connected  finite non  empty Mealy-FSM over R5 , R6 holds (for R49 being  connected  finite non  empty Mealy-FSM over R5 , R6 holds (R48 , R49 -are_equivalent  implies ( the_reduction_of R48 ) , ( the_reduction_of R49 ) -are_isomorphic )))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R48 being  connected  finite non  empty Mealy-FSM over R5 , R6;
let R49 being  connected  finite non  empty Mealy-FSM over R5 , R6;
assume L1850: R48 , R49 -are_equivalent ;
set D463 = ( the_reduction_of R49 );
set D464 = ( the_reduction_of R48 );
consider C420 , C421 being  finite non  empty Mealy-FSM over R5 , R6 such that L1851: (the carrier of C420) misses (the carrier of C421) and L1852: C420 , D464 -are_isomorphic  and L1853: C421 , D463 -are_isomorphic  by L1610;
L1854: D464 , R48 -are_equivalent  by L900;
set D465 = (the carrier of D464);
set D466 = (the carrier of D463);
set D467 = (the InitS of D464);
set D468 = (the InitS of D463);
set D469 = (the carrier of C420);
set D470 = (the carrier of C421);
set D471 = (the InitS of C420);
set D472 = (the InitS of C421);
L1855: D463 , R49 -are_equivalent  by L900;
L1856: C421 , D463 -are_equivalent  by L1853 , L1693;
L1857: C421 , R49 -are_equivalent  by L1856 , L1855 , L328;
L1858: C420 is  connected
proof
assume L1859: (not C420 is  connected);
consider C422 being (Element of D469) such that L1860: (not C422 is  accessible) by L1859 , L1125;
consider C423 being (Function of (the carrier of C420) , D465) such that L1861: C423 is  bijective and L1862: (( C423 . (the InitS of C420) ) = D467 & (for B271 being (State of C420) holds (for B272 being (Element of R5) holds (( C423 . ( (the Tran of C420) . (B271 , B272) ) ) = ( (the Tran of D464) . (( C423 . B271 ) , B272) ) & ( (the OFun of C420) . (B271 , B272) ) = ( (the OFun of D464) . (( C423 . B271 ) , B272) ))))) by L1852 , L922;
L1863: ( dom C423 ) = D469 by FUNCT_2:def 1;
set D473 = ( C423 . C422 );
L1864: D473 is  accessible by L1125;
consider C424 being (FinSequence of R5) such that L1865: D467 , C424 -leads_to D473 by L1864 , L1123;
L1866: 1 <= ( ( len C424 ) + 1 ) by NAT_1:11;
L1867: ( C423 . ( ( (D471 , C424) -admissible ) . ( ( len C424 ) + 1 ) ) ) = ( ( (D467 , C424) -admissible ) . ( ( len C424 ) + 1 ) ) by L1866 , L1862 , L959;
L1868: ( ( C423 " ) . ( C423 . ( ( (D471 , C424) -admissible ) . ( ( len C424 ) + 1 ) ) ) ) = ( ( C423 " ) . D473 ) by L1867 , L1865 , L39;
L1869: ( len ( (D471 , C424) -admissible ) ) = ( ( len C424 ) + 1 ) by L7;
L1870: ( ( len C424 ) + 1 ) in ( Seg ( len ( (D471 , C424) -admissible ) ) ) by L1869 , L1866 , FINSEQ_1:1;
L1871: ( ( len C424 ) + 1 ) in ( dom ( (D471 , C424) -admissible ) ) by L1870 , FINSEQ_1:def 3;
L1872: ( ( ((the InitS of C420) , C424) -admissible ) . ( ( len C424 ) + 1 ) ) in ( dom C423 ) by L1871 , L1863 , FINSEQ_2:11;
L1873: ( ( (D471 , C424) -admissible ) . ( ( len C424 ) + 1 ) ) = ( ( C423 " ) . ( C423 . C422 ) ) by L1872 , L1861 , L1868 , FUNCT_1:34
.= C422 by L1861 , L1863 , FUNCT_1:34;
L1874: D471 , C424 -leads_to C422 by L1873 , L39;
thus L1875: contradiction by L1874 , L1860 , L1123;
end;
L1876: C421 is  connected
proof
assume L1877: (not C421 is  connected);
consider C425 being (Element of D470) such that L1878: (not C425 is  accessible) by L1877 , L1125;
consider C426 being (Function of D470 , D466) such that L1879: C426 is  bijective and L1880: (( C426 . D472 ) = D468 & (for B273 being (State of C421) holds (for B274 being (Element of R5) holds (( C426 . ( (the Tran of C421) . (B273 , B274) ) ) = ( (the Tran of D463) . (( C426 . B273 ) , B274) ) & ( (the OFun of C421) . (B273 , B274) ) = ( (the OFun of D463) . (( C426 . B273 ) , B274) ))))) by L1853 , L922;
L1881: ( dom C426 ) = D470 by FUNCT_2:def 1;
set D474 = ( C426 . C425 );
L1882: D474 is  accessible by L1125;
consider C427 being (FinSequence of R5) such that L1883: D468 , C427 -leads_to D474 by L1882 , L1123;
L1884: 1 <= ( ( len C427 ) + 1 ) by NAT_1:11;
L1885: ( C426 . ( ( (D472 , C427) -admissible ) . ( ( len C427 ) + 1 ) ) ) = ( ( (D468 , C427) -admissible ) . ( ( len C427 ) + 1 ) ) by L1884 , L1880 , L959;
L1886: ( ( C426 " ) . ( C426 . ( ( (D472 , C427) -admissible ) . ( ( len C427 ) + 1 ) ) ) ) = ( ( C426 " ) . D474 ) by L1885 , L1883 , L39;
L1887: ( len ( (D472 , C427) -admissible ) ) = ( ( len C427 ) + 1 ) by L7;
L1888: ( ( len C427 ) + 1 ) in ( Seg ( len ( (D472 , C427) -admissible ) ) ) by L1887 , L1884 , FINSEQ_1:1;
L1889: ( ( len C427 ) + 1 ) in ( dom ( (D472 , C427) -admissible ) ) by L1888 , FINSEQ_1:def 3;
L1890: ( ( (D472 , C427) -admissible ) . ( ( len C427 ) + 1 ) ) in ( dom C426 ) by L1889 , L1881 , FINSEQ_2:11;
L1891: ( ( (D472 , C427) -admissible ) . ( ( len C427 ) + 1 ) ) = ( ( C426 " ) . ( C426 . C425 ) ) by L1890 , L1879 , L1886 , FUNCT_1:34
.= C425 by L1879 , L1881 , FUNCT_1:34;
L1892: D472 , C427 -leads_to C425 by L1891 , L39;
thus L1893: contradiction by L1892 , L1878 , L1123;
end;
L1894: C420 , D464 -are_equivalent  by L1852 , L1693;
L1895: C420 , R48 -are_equivalent  by L1894 , L1854 , L328;
L1896: C420 , R49 -are_equivalent  by L1895 , L1850 , L328;
reconsider D475 = C420 , D476 = C421 as  reduced  finite non  empty Mealy-FSM over R5 , R6 by L1852 , L1853 , L1110;
L1897: D475 , D476 -are_isomorphic  by L1851 , L1858 , L1876 , L1857 , L1896 , L328 , L1737;
L1898: D475 , D463 -are_isomorphic  by L1897 , L1853 , L943;
thus L1899: thesis by L1898 , L1852 , L943;
end;
::$N Myhill-Nerode theorem
theorem
L1900: (for R5 being non  empty set holds (for R6 being non  empty set holds (for B275 , B276 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6 holds (B275 , B276 -are_isomorphic  iff B275 , B276 -are_equivalent ))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let C428 , C429 being  connected  reduced  finite non  empty Mealy-FSM over R5 , R6;
thus L1901: (C428 , C429 -are_isomorphic  implies C428 , C429 -are_equivalent ) by L1693;
L1902: C429 , ( the_reduction_of C429 ) -are_isomorphic  by L1074;
assume L1903: C428 , C429 -are_equivalent ;
L1904: ( the_reduction_of C428 ) , ( the_reduction_of C429 ) -are_isomorphic  by L1903 , L1849;
L1905: C428 , ( the_reduction_of C428 ) -are_isomorphic  by L1074;
L1906: C428 , ( the_reduction_of C429 ) -are_isomorphic  by L1905 , L1904 , L943;
thus L1907: thesis by L1906 , L1902 , L943;
end;
