:: Introduction to Matroids
::  by Grzegorz Bancerek and Yasunari Shidama
::
:: Received July 30, 2008
:: Copyright (c) 2008-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, TARSKI, PRE_TOPC, SUBSET_1, BVFUNC_2, RCOMP_1, SETFAM_1,
      CLASSES1, FINSET_1, CARD_1, ARYTM_3, XBOOLE_0, STRUCT_0, ZFMISC_1, NAT_1,
      XXREAL_0, TAXONOM2, AOFA_000, ORDERS_1, FUNCT_1, RELAT_1, NATTRA_1,
      EQREL_1, VECTSP_1, RLVECT_3, CARD_3, RLVECT_2, SUPINF_2, REALSET1,
      ARYTM_1, RLVECT_5, JORDAN13, MATROID0;
 notations TARSKI, XBOOLE_0, SUBSET_1, DOMAIN_1, SETFAM_1, FINSET_1, NUMBERS,
      FUNCT_1, RELSET_1, FUNCT_2, EQREL_1, ORDERS_1, TAXONOM2, XCMPLX_0,
      XXREAL_0, ORDINAL1, NAT_1, CARD_1, CLASSES1, AOFA_000, STRUCT_0,
      RLVECT_1, VECTSP_1, VECTSP_6, VECTSP_7, PRE_TOPC, TDLAT_3, MATRLIN,
      PENCIL_1, RANKNULL;
 constructors COH_SP, TDLAT_3, TAXONOM2, RANKNULL, VECTSP_7, PENCIL_1,
      REALSET1, RELSET_1;
 registrations FINSET_1, XBOOLE_0, CARD_1, RELSET_1, STRUCT_0, SUBSET_1,
      PENCIL_1, TDLAT_3, SETFAM_1, EQREL_1, MATRLIN, XREAL_0, MEMBERED,
      ALGSTR_0, BINOM, RLVECT_1, VECTSP_1, VECTSP_7;
 requirements BOOLE, SUBSET, NUMERALS, ARITHM, REAL;
 definitions TARSKI, FUNCT_1, CLASSES1, TAXONOM2, XBOOLE_0, STRUCT_0, PENCIL_1,
      FINSET_1;
 theorems PENCIL_1, TARSKI, XBOOLE_1, ZFMISC_1, CARD_1, COH_SP, PRE_TOPC,
      NAT_1, CLASSES1, TDLAT_3, XXREAL_0, XREAL_1, XBOOLE_0, TAXONOM2,
      ORDERS_1, FUNCT_2, FUNCT_1, EQREL_1, WELLORD2, VECTSP_7, VECTSP_9,
      MATRLIN, STRUCT_0, CARD_FIN, CARD_2, VECTSP_4, ORDINAL1, CARD_FIL,
      RANKNULL, VECTSP_1, VECTSP_6, ALGSTR_0, HALLMAR1;
 schemes FUNCT_2, NAT_1;

begin
notation
let C1 , C2 being set;
antonym C1 c/= C2 for C1 c= C2;
end;
definition
mode SubsetFamilyStr
 is TopStruct;
end;
notation
let C3 being SubsetFamilyStr;
let C4 being (Subset of C3);
synonym C4 is  independent for C4 is  open;
antonym C4 is  dependent for C4 is  open;
end;
definition
let C5 being SubsetFamilyStr;
func the_family_of C5 -> (Subset-Family of C5) equals 
(the topology of C5);
coherence;
end;
definition
let C6 being SubsetFamilyStr;
let C7 being (Subset of C6);
redefine attr C7 is  independent
means
:L5: C7 in ( the_family_of C6 );
compatibility by PRE_TOPC:def 2;
end;
definition
let C8 being SubsetFamilyStr;
attr C8 is  subset-closed
means
:L7: ( the_family_of C8 ) is  subset-closed;
attr C8 is  with_exchange_property
means
(for B1 , B2 being  finite (Subset of C8) holds ((B1 in ( the_family_of C8 ) & B2 in ( the_family_of C8 ) & ( card B2 ) = ( ( card B1 ) + 1 )) implies (ex B3 being (Element of C8) st (B3 in ( B2 \ B1 ) & ( B1 \/ { B3 } ) in ( the_family_of C8 )))));
end;
registration
cluster  strict non  empty non  void  finite  subset-closed  with_exchange_property for SubsetFamilyStr;
existence
proof
reconsider D1 = ( bool { ( 0 ) } ) as (Subset-Family of { ( 0 ) });
take D2 = TopStruct (# { ( 0 ) } , D1 #);
thus L9: D2 is  strict;
thus L10: (the carrier of D2) is non  empty;
thus L11: (the topology of D2) is non  empty;
thus L12: (the carrier of D2) is  finite;
thus L13: ( the_family_of D2 ) is  subset-closed by COH_SP:2;
let C9 , C10 being  finite (Subset of D2);
assume L14: C9 in ( the_family_of D2 );
assume L15: C10 in ( the_family_of D2 );
assume L16: ( card C10 ) = ( ( card C9 ) + 1 );
reconsider D3 = ( 0 ) as (Element of D2) by TARSKI:def 1;
take D3;
L17: ( bool { ( 0 ) } ) = { ( {} ) , { ( 0 ) } } by ZFMISC_1:24;
L18: (C10 = ( {} ) or C10 = { ( 0 ) }) by L17 , TARSKI:def 2;
L19: (( card C10 ) = ( 0 ) or ( card C10 ) = 1) by L18 , CARD_1:30;
L20: (C9 = ( {} ) or C9 = { ( 0 ) }) by L17 , TARSKI:def 2;
L21: (( card C9 ) = ( 0 ) or ( card C9 ) = 1) by L20 , CARD_1:30;
thus L22: thesis by L21 , L16 , L20 , L18 , L19;
end;
end;
registration
let C11 being non  void SubsetFamilyStr;
cluster  independent for (Subset of C11);
existence
proof
set D4 = the (Element of (the topology of C11));
reconsider D5 = D4 as (Subset of C11);
take D5;
thus L24: D5 in ( the_family_of C11 );
end;
end;
registration
let C12 being  subset-closed SubsetFamilyStr;
cluster ( the_family_of C12 ) ->  subset-closed;
coherence by L7;
end;
theorem
L27: (for B4 being non  void  subset-closed SubsetFamilyStr holds (for B5 being  independent (Subset of B4) holds (for B6 being set holds (B6 c= B5 implies B6 is  independent  independent  independent  independent (Subset of B4)))))
proof
let C13 being non  void  subset-closed SubsetFamilyStr;
let C14 being  independent (Subset of C13);
let C15 being set;
assume L28: C15 c= C14;
L29: C14 in ( the_family_of C13 ) by L5;
L30: C15 in ( the_family_of C13 ) by L29 , L28 , CLASSES1:def 1;
thus L31: thesis by L30 , L5;
end;
registration
let C16 being non  void  subset-closed SubsetFamilyStr;
cluster  finite  independent for (Subset of C16);
existence
proof
set D6 = the (Element of (the topology of C16));
reconsider D7 = D6 as  independent (Subset of C16) by PRE_TOPC:def 2;
L32: ( {} ) c= D7 by XBOOLE_1:2;
reconsider D8 = ( {} ) as  independent (Subset of C16) by L32 , L27;
take D8;
thus L33: thesis;
end;
end;
definition
mode Matroid
 is non  empty non  void  subset-closed  with_exchange_property SubsetFamilyStr;
end;
theorem
L36: (for B7 being  subset-closed SubsetFamilyStr holds (B7 is non  void iff ( {} ) in ( the_family_of B7 )))
proof
let C17 being  subset-closed SubsetFamilyStr;
thus L37:now
assume L38: C17 is non  void;
reconsider D9 = C17 as non  void  subset-closed SubsetFamilyStr by L38;
set D10 = the  independent (Subset of D9);
L39: ( {} ) c= D10 by XBOOLE_1:2;
L40: ( {} ) is  independent  independent  independent  independent (Subset of D9) by L39 , L27;
thus L41: ( {} ) in ( the_family_of C17 ) by L40 , L5;
end;
assume L42: ( {} ) in ( the_family_of C17 );
thus L43: (the topology of C17) is non  empty by L42;
end;
registration
let C18 being non  void  subset-closed SubsetFamilyStr;
cluster  empty ->  independent for (Subset of C18);
coherence
proof
let C19 being (Subset of C18);
assume L44: C19 is  empty;
thus L45: C19 in ( the_family_of C18 ) by L44 , L36;
end;
end;
theorem
L47: (for B8 being non  void SubsetFamilyStr holds (B8 is  subset-closed iff (for B9 , B10 being (Subset of B8) holds ((B9 is  independent & B10 c= B9) implies B10 is  independent))))
proof
let C20 being non  void SubsetFamilyStr;
thus L48: (C20 is  subset-closed implies (for B11 , B12 being (Subset of C20) holds ((B11 is  independent & B12 c= B11) implies B12 is  independent))) by L27;
assume L49: (for B13 , B14 being (Subset of C20) holds ((B13 is  independent & B14 c= B13) implies B14 is  independent));
let C21 , C22 being set;
assume L50: C21 in ( the_family_of C20 );
L51: C21 is  independent  independent  independent  independent (Subset of C20) by L50 , L5;
assume L52: C22 c= C21;
L53: C22 is  independent  independent  independent  independent (Subset of C20) by L52 , L49 , L51 , XBOOLE_1:1;
thus L54: thesis by L53 , L5;
end;
registration
let C23 being non  void  subset-closed SubsetFamilyStr;
let C24 being  independent (Subset of C23);
let C25 being set;
cluster ( C24 /\ C25 ) ->  independent for (Subset of C23);
coherence
proof
L55: ( C24 /\ C25 ) c= C24 by XBOOLE_1:17;
thus L56: thesis by L55 , L47;
end;
cluster ( C25 /\ C24 ) ->  independent for (Subset of C23);
coherence;
cluster ( C24 \ C25 ) ->  independent for (Subset of C23);
coherence
proof
L57: ( C24 \ C25 ) c= C24 by XBOOLE_1:36;
thus L58: thesis by L57 , L47;
end;
end;
theorem
L60: (for B15 being non  void non  empty SubsetFamilyStr holds (B15 is  with_exchange_property iff (for B16 , B17 being  finite (Subset of B15) holds ((B16 is  independent & B17 is  independent & ( card B17 ) = ( ( card B16 ) + 1 )) implies (ex B18 being (Element of B15) st (B18 in ( B17 \ B16 ) & ( B16 \/ { B18 } ) is  independent))))))
proof
let C26 being non  void non  empty SubsetFamilyStr;
thus L61: (C26 is  with_exchange_property implies (for B19 , B20 being  finite (Subset of C26) holds ((B19 is  independent & B20 is  independent & ( card B20 ) = ( ( card B19 ) + 1 )) implies (ex B21 being (Element of C26) st (B21 in ( B20 \ B19 ) & ( B19 \/ { B21 } ) is  independent)))))
proof
assume L62: (for B22 , B23 being  finite (Subset of C26) holds ((B22 in ( the_family_of C26 ) & B23 in ( the_family_of C26 ) & ( card B23 ) = ( ( card B22 ) + 1 )) implies (ex B24 being (Element of C26) st (B24 in ( B23 \ B22 ) & ( B22 \/ { B24 } ) in ( the_family_of C26 )))));
let C27 , C28 being  finite (Subset of C26);
assume that
L63: C27 in ( the_family_of C26 )
and
L64: C28 in ( the_family_of C26 )
and
L65: ( card C28 ) = ( ( card C27 ) + 1 );
consider C29 being (Element of C26) such that L66: C29 in ( C28 \ C27 ) and L67: ( C27 \/ { C29 } ) in ( the_family_of C26 ) by L62 , L63 , L64 , L65;
take C29;
thus L68: (C29 in ( C28 \ C27 ) & ( C27 \/ { C29 } ) in ( the_family_of C26 )) by L66 , L67;
end;

assume L69: (for B25 , B26 being  finite (Subset of C26) holds ((B25 is  independent & B26 is  independent & ( card B26 ) = ( ( card B25 ) + 1 )) implies (ex B27 being (Element of C26) st (B27 in ( B26 \ B25 ) & ( B25 \/ { B27 } ) is  independent))));
let C30 , C31 being  finite (Subset of C26);
assume that
L70: C30 in ( the_family_of C26 )
and
L71: C31 in ( the_family_of C26 );
L72: C31 is  independent by L71 , L5;
assume L73: ( card C31 ) = ( ( card C30 ) + 1 );
L74: C30 is  independent by L70 , L5;
consider C32 being (Element of C26) such that L75: C32 in ( C31 \ C30 ) and L76: ( C30 \/ { C32 } ) is  independent by L74 , L69 , L72 , L73;
take C32;
thus L77: thesis by L75 , L76 , L5;
end;
definition
canceled 1;
let C33 being SubsetFamilyStr;
attr C33 is  finite-membered
means
:L78: ( the_family_of C33 ) is  finite-membered;
end;
definition
let C34 being SubsetFamilyStr;
attr C34 is  finite-degree
means
:L80: (C34 is  finite-membered & (ex B28 being Nat st (for B29 being  finite (Subset of C34) holds (B29 is  independent implies ( card B29 ) <= B28))));
end;
registration
cluster  finite-degree ->  finite-membered for SubsetFamilyStr;
coherence
proof
let C35 being SubsetFamilyStr;
assume L82: C35 is  finite-membered;
thus L83: thesis by L82;
end;
cluster  finite ->  finite-degree for SubsetFamilyStr;
coherence
proof
let C36 being SubsetFamilyStr;
assume L84: (the carrier of C36) is  finite;
reconsider D11 = (the carrier of C36) as  finite set by L84;
thus L85: C36 is  finite-membered
proof
let C37 being set;
assume L86: C37 in ( the_family_of C36 );
L87: C37 c= D11 by L86;
thus L88: thesis by L87;
end;

take ( card D11 );
let C38 being  finite (Subset of C36);
thus L89: thesis by NAT_1:43;
end;
end;
begin
registration
cluster  mutually-disjoint non  empty  with_non-empty_elements for set;
existence
proof
take { { ( 0 ) } };
thus L91: thesis by TAXONOM2:10;
end;
end;
theorem
L93: (for B30 , B31 being  finite set holds (( card B30 ) < ( card B31 ) implies (ex B32 being set st B32 in ( B31 \ B30 ))))
proof
let C39 , C40 being  finite set;
assume L94: ( card C39 ) < ( card C40 );
L95: (not C40 c= C39) by L94 , NAT_1:43;
consider C41 being set such that L96: C41 in C40 and L97: C41 nin C39 by L95 , TARSKI:def 3;
take C41;
thus L98: thesis by L96 , L97 , XBOOLE_0:def 5;
end;
theorem
L99: (for B33 being  mutually-disjoint  with_non-empty_elements non  empty set holds (for B34 being (Choice_Function of B33) holds B34 is  one-to-one))
proof
let C42 being  mutually-disjoint  with_non-empty_elements non  empty set;
let C43 being (Choice_Function of C42);
let C44 , C45 being set;
assume that
L100: C44 in ( dom C43 )
and
L101: C45 in ( dom C43 )
and
L102: ( C43 . C44 ) = ( C43 . C45 );
L103: (not ( {} ) in C42);
L104: ( C43 . C44 ) in C44 by L103 , L100 , ORDERS_1:def 1;
L105: ( C43 . C44 ) in C45 by L101 , L102 , L103 , ORDERS_1:def 1;
L106: C44 meets C45 by L105 , L104 , XBOOLE_0:3;
thus L107: thesis by L106 , L100 , L101 , TAXONOM2:def 5;
end;
registration
cluster  -> non  void  subset-closed  with_exchange_property for  discrete  discrete  discrete  discrete SubsetFamilyStr;
coherence
proof
let C46 being  discrete SubsetFamilyStr;
L108: (the topology of C46) is non  empty by TDLAT_3:def 1;
thus L109: C46 is non  void by L108 , PENCIL_1:def 4;
L110: (for B35 , B36 being (Subset of C46) holds ((B35 is  independent & B36 c= B35) implies B36 is  independent)) by TDLAT_3:15;
thus L111: C46 is  subset-closed by L110 , L109 , L47;
let C47 , C48 being  finite (Subset of C46);
assume that
L112: C47 in ( the_family_of C46 )
and
L113: C48 in ( the_family_of C46 )
and
L114: ( card C48 ) = ( ( card C47 ) + 1 );
L115:
now
assume L116: C48 c= C47;
L117: ( card C48 ) c= ( card C47 ) by L116 , CARD_1:11;
L118: ( card C48 ) <= ( card C47 ) by L117 , NAT_1:39;
L119: ( ( card C48 ) + ( 0 ) ) < ( ( card C47 ) + 1 ) by L118 , XREAL_1:8;
thus L120: contradiction by L119 , L114;
end;
consider C49 being set such that L121: C49 in C48 and L122: (not C49 in C47) by L115 , TARSKI:def 3;
reconsider D12 = C49 as (Element of C46) by L121;
L123: { D12 } c= (the carrier of C46) by L121 , ZFMISC_1:31;
reconsider D13 = ( C47 \/ { D12 } ) as (Subset of C46) by L123 , XBOOLE_1:8;
take D12;
thus L124: D12 in ( C48 \ C47 ) by L121 , L122 , XBOOLE_0:def 5;
L125: D13 is  independent by TDLAT_3:15;
thus L126: thesis by L125 , L5;
end;
end;
theorem
L128: (for B37 being non  empty  discrete TopStruct holds B37 is Matroid);
definition
let C50 being set;
func ProdMatroid C50 ->  strict SubsetFamilyStr means 
:L129: ((the carrier of it) = ( union C50 ) & ( the_family_of it ) = { B38 where B38 is (Subset of ( union C50 )) : (for B39 being set holds (B39 in C50 implies (ex B40 being set st ( B38 /\ B39 ) c= { B40 }))) });
existence
proof
set D14 = { B41 where B41 is (Subset of ( union C50 )) : (for B42 being set holds (B42 in C50 implies (ex B43 being set st ( B41 /\ B42 ) c= { B43 }))) };
set D15 = ( union C50 );
L130: D14 c= ( bool D15 )
proof
let C51 being set;
assume L131: C51 in D14;
L132: (ex B44 being (Subset of D15) st (C51 = B44 & (for B45 being set holds (B45 in C50 implies (ex B46 being set st ( B44 /\ B45 ) c= { B46 }))))) by L131;
thus L133: thesis by L132;
end;
reconsider D16 = D14 as (Subset-Family of D15) by L130;
take TopStruct (# D15 , D16 #);
thus L134: thesis;
end;
uniqueness;
end;
registration
let C52 being non  empty  with_non-empty_elements set;
cluster ( ProdMatroid C52 ) -> non  empty;
coherence
proof
set D17 = ( ProdMatroid C52 );
L136: (the carrier of D17) = ( union C52 ) by L129;
thus L137: (the carrier of D17) is non  empty by L136;
end;
end;
theorem
L139: (for B47 being set holds (for B48 being (Subset of ( ProdMatroid B47 )) holds (B48 is  independent iff (for B49 being (Element of B47) holds (ex B50 being (Element of B49) st ( B48 /\ B49 ) c= { B50 })))))
proof
let C53 being set;
set D18 = ( ProdMatroid C53 );
L140: ( the_family_of D18 ) = { B51 where B51 is (Subset of ( union C53 )) : (for B52 being set holds (B52 in C53 implies (ex B53 being set st ( B51 /\ B52 ) c= { B53 }))) } by L129;
let C54 being (Subset of ( ProdMatroid C53 ));
L141: (the carrier of D18) = ( union C53 ) by L129;
thus L142: (C54 is  independent implies (for B54 being (Element of C53) holds (ex B55 being (Element of B54) st ( C54 /\ B54 ) c= { B55 })))
proof
assume L143: C54 in ( the_family_of D18 );
L144: (ex B56 being (Subset of ( union C53 )) st (C54 = B56 & (for B57 being set holds (B57 in C53 implies (ex B58 being set st ( B56 /\ B57 ) c= { B58 }))))) by L143 , L140;
let C55 being (Element of C53);
L145: (C53 = ( {} ) implies (C54 = ( {} ) & ( ( {} ) /\ C55 ) = ( {} ))) by L141 , ZFMISC_1:2;
L146: (C53 = ( {} ) implies ( C54 /\ C55 ) c= { 1 }) by L145 , XBOOLE_1:2;
consider C56 being set such that L147: ( C54 /\ C55 ) c= { C56 } by L146 , L144;
set D19 = the (Element of C55);
L148:
now
assume L149: C56 nin C55;
L150: C56 nin ( C54 /\ C55 ) by L149 , XBOOLE_0:def 4;
L151: ( C54 /\ C55 ) <> { C56 } by L150 , TARSKI:def 1;
L152: ( C54 /\ C55 ) = ( {} ) by L151 , L147 , ZFMISC_1:33;
thus L153: ( C54 /\ C55 ) c= { D19 } by L152 , XBOOLE_1:2;
end;
thus L154: thesis by L148 , L147;
end;

assume L155: (for B59 being (Element of C53) holds (ex B60 being (Element of B59) st ( C54 /\ B59 ) c= { B60 }));
L156:
now
let C57 being set;
assume L157: C57 in C53;
L158: (ex B61 being (Element of C57) st ( C54 /\ C57 ) c= { B61 }) by L157 , L155;
thus L159: (ex B62 being set st ( C54 /\ C57 ) c= { B62 }) by L158;
end;
L160: (the carrier of D18) = ( union C53 ) by L129;
thus L161: C54 in ( the_family_of D18 ) by L160 , L140 , L156;
end;
registration
let C58 being set;
cluster ( ProdMatroid C58 ) -> non  void  subset-closed;
coherence
proof
set D20 = ( ProdMatroid C58 );
L162: ( the_family_of D20 ) = { B63 where B63 is (Subset of ( union C58 )) : (for B64 being set holds (B64 in C58 implies (ex B65 being set st ( B63 /\ B64 ) c= { B65 }))) } by L129;
set D21 = ( {} ( union C58 ) );
L163:
now
let C59 being set;
assume L164: C59 in C58;
take D22 = ( {} );
thus L165: ( D21 /\ C59 ) c= { D22 } by XBOOLE_1:2;
end;
L166: D21 in ( the_family_of D20 ) by L163 , L162;
thus L167: (the topology of D20) is non  empty by L166;
thus L168: ( the_family_of D20 ) is  subset-closed
proof
let C60 , C61 being set;
assume that
L169: C60 in ( the_family_of D20 )
and
L170: C61 c= C60;
L171: (ex B66 being (Subset of ( union C58 )) st (C60 = B66 & (for B67 being set holds (B67 in C58 implies (ex B68 being set st ( B66 /\ B67 ) c= { B68 }))))) by L162 , L169;
L172:
now
let C62 being set;
assume L173: C62 in C58;
consider C63 being set such that L174: ( C60 /\ C62 ) c= { C63 } by L173 , L171;
take D23 = C63;
L175: ( C61 /\ C62 ) c= ( C60 /\ C62 ) by L170 , XBOOLE_1:26;
thus L176: ( C61 /\ C62 ) c= { D23 } by L175 , L174 , XBOOLE_1:1;
end;
L177: C61 is (Subset of ( union C58 )) by L170 , L171 , XBOOLE_1:1;
thus L178: thesis by L177 , L162 , L172;
end;

end;
end;
theorem
L170: (for B69 being  mutually-disjoint set holds (for B70 being (Subset of ( ProdMatroid B69 )) holds (ex B71 being (Function of B70 , B69) st (for B72 being set holds (B72 in B70 implies B72 in ( B71 . B72 ))))))
proof
defpred S1[ set , set ] means $1 in $2;
let C64 being  mutually-disjoint set;
let C65 being (Subset of ( ProdMatroid C64 ));
L171:
now
let C66 being set;
assume L172: C66 in C65;
L173: C66 in (the carrier of ( ProdMatroid C64 )) by L172;
L174: C66 in ( union C64 ) by L173 , L129;
L175: (ex B73 being set st (C66 in B73 & B73 in C64)) by L174 , TARSKI:def 4;
thus L176: (ex B74 being set st (B74 in C64 & S1[ C66 , B74 ])) by L175;
end;
consider C67 being (Function of C65 , C64) such that L177: (for B75 being set holds (B75 in C65 implies S1[ B75 , ( C67 . B75 ) ])) from FUNCT_2:sch 1(L171);
take C67;
thus L178: thesis by L177;
end;
theorem
L179: (for B76 being  mutually-disjoint set holds (for B77 being (Subset of ( ProdMatroid B76 )) holds (for B78 being (Function of B77 , B76) holds ((for B79 being set holds (B79 in B77 implies B79 in ( B78 . B79 ))) implies (B77 is  independent iff B78 is  one-to-one)))))
proof
let C68 being  mutually-disjoint set;
let C69 being (Subset of ( ProdMatroid C68 ));
let C70 being (Function of C69 , C68);
assume L180: (for B80 being set holds (B80 in C69 implies B80 in ( C70 . B80 )));
thus L181:now
assume L182: C69 is  independent;
thus L183: C70 is  one-to-one
proof
let C71 , C72 being set;
assume that
L184: C71 in ( dom C70 )
and
L185: C72 in ( dom C70 );
L186: ( C70 . C72 ) in ( rng C70 ) by L185 , FUNCT_1:def 3;
L187: ( C70 . C71 ) in ( rng C70 ) by L184 , FUNCT_1:def 3;
reconsider D24 = ( C70 . C71 ) , D25 = ( C70 . C72 ) as (Element of C68) by L187 , L186;
L188: C71 in D24 by L180 , L184;
L189: C71 in ( C69 /\ D24 ) by L188 , L184 , XBOOLE_0:def 4;
consider C73 being (Element of D25) such that L190: ( C69 /\ D25 ) c= { C73 } by L182 , L139;
L191: C72 in D25 by L180 , L185;
L192: C72 in ( C69 /\ D25 ) by L191 , L185 , XBOOLE_0:def 4;
L193: C72 = C73 by L192 , L190 , TARSKI:def 1;
thus L194: thesis by L193 , L190 , L189 , TARSKI:def 1;
end;

end;
assume L184: C70 is  one-to-one;
L185:
now
let C74 being (Element of C68);
set D26 = the (Element of C74);
assume L186: (for B81 being (Element of C74) holds ( C69 /\ C74 ) c/= { B81 });
L187: ( C69 /\ C74 ) c/= { D26 } by L186;
consider C75 being set such that L188: C75 in ( C69 /\ C74 ) and L189: C75 nin { D26 } by L187 , TARSKI:def 3;
L190: C75 in C74 by L188 , XBOOLE_0:def 4;
L191: C75 in C69 by L188 , XBOOLE_0:def 4;
L192: C75 in ( C70 . C75 ) by L191 , L180;
L193: ( C70 . C75 ) meets C74 by L192 , L190 , XBOOLE_0:3;
L194: (the carrier of ( ProdMatroid C68 )) = ( union C68 ) by L129;
L195: (ex B82 being set st (C75 in B82 & B82 in C68)) by L194 , L188 , TARSKI:def 4;
L196: ( dom C70 ) = C69 by L195 , FUNCT_2:def 1;
L197: ( C70 . C75 ) in ( rng C70 ) by L196 , L191 , FUNCT_1:def 3;
L198: ( C70 . C75 ) = C74 by L197 , L193 , TAXONOM2:def 5;
L199: ( C69 /\ C74 ) c= { C75 }
proof
let C76 being set;
assume L200: C76 in ( C69 /\ C74 );
L201: C76 in C69 by L200 , XBOOLE_0:def 4;
L202: C76 in C74 by L200 , XBOOLE_0:def 4;
L203: C76 in ( C70 . C76 ) by L180 , L201;
L204: ( C70 . C76 ) meets C74 by L203 , L202 , XBOOLE_0:3;
L205: ( C70 . C76 ) in ( rng C70 ) by L196 , L201 , FUNCT_1:def 3;
L206: ( C70 . C76 ) = C74 by L205 , L204 , TAXONOM2:def 5;
L207: C76 = C75 by L206 , L184 , L191 , L196 , L198 , L201 , FUNCT_1:def 4;
thus L208: thesis by L207 , TARSKI:def 1;
end;
thus L209: contradiction by L199 , L186 , L190;
end;
thus L210: thesis by L185 , L139;
end;
registration
let C77 being  mutually-disjoint set;
cluster ( ProdMatroid C77 ) ->  with_exchange_property;
coherence
proof
set D27 = ( ProdMatroid C77 );
L211: ( the_family_of D27 ) = { B83 where B83 is (Subset of ( union C77 )) : (for B84 being set holds (B84 in C77 implies (ex B85 being set st ( B83 /\ B84 ) c= { B85 }))) } by L129;
let C78 , C79 being  finite (Subset of D27);
assume that
L212: C78 in ( the_family_of D27 )
and
L213: C79 in ( the_family_of D27 );
consider C80 being (Function of C78 , C77) such that L214: (for B86 being set holds (B86 in C78 implies B86 in ( C80 . B86 ))) by L170;
assume L215: ( card C79 ) = ( ( card C78 ) + 1 );
L216: ( card C79 ) > ( card C78 ) by L215 , NAT_1:13;
consider C81 being (Function of C79 , C77) such that L217: (for B87 being set holds (B87 in C79 implies B87 in ( C81 . B87 ))) by L170;
L218: (the carrier of ( ProdMatroid C77 )) = ( union C77 ) by L129;
L219: (C77 = ( {} ) implies C78 = ( {} )) by L218 , ZFMISC_1:2;
L220: ( dom C80 ) = C78 by L219 , FUNCT_2:def 1;
reconsider D28 = ( rng C80 ) , D29 = ( rng C81 ) as  finite set;
L221: C78 is  independent by L212 , L5;
L222: C80 is  one-to-one by L221 , L214 , L179;
L223: C78 , D28 are_equipotent  by L222 , L220 , WELLORD2:def 4;
L224: ( card C78 ) = ( card D28 ) by L223 , CARD_1:5;
L225: (C77 = ( {} ) implies C79 = ( {} )) by L218 , ZFMISC_1:2;
L226: ( dom C81 ) = C79 by L225 , FUNCT_2:def 1;
L227: C79 is  independent by L213 , L5;
L228: C81 is  one-to-one by L227 , L217 , L179;
L229: C79 , D29 are_equipotent  by L228 , L226 , WELLORD2:def 4;
L230: ( card C79 ) = ( card D29 ) by L229 , CARD_1:5;
consider C82 being set such that L231: C82 in ( D29 \ D28 ) by L230 , L224 , L216 , L93;
consider C83 being set such that L232: C83 in C79 and L233: C82 = ( C81 . C83 ) by L226 , L231 , FUNCT_1:def 3;
reconsider D30 = C83 as (Element of D27) by L232;
take D30;
L234: C82 nin D28 by L231 , XBOOLE_0:def 5;
L235:
now
L236: D30 in ( C81 . D30 ) by L217 , L232;
assume L237: D30 in C78;
L238: D30 in ( C80 . D30 ) by L237 , L214;
L239: ( C80 . D30 ) meets ( C81 . D30 ) by L238 , L236 , XBOOLE_0:3;
L240: ( C81 . D30 ) in ( rng C81 ) by L226 , L232 , FUNCT_1:def 3;
L241: ( C80 . D30 ) in ( rng C80 ) by L220 , L237 , FUNCT_1:def 3;
thus L242: contradiction by L241 , L234 , L233 , L240 , L239 , TAXONOM2:def 5;
end;
thus L243: D30 in ( C79 \ C78 ) by L235 , L232 , XBOOLE_0:def 5;
reconsider D31 = { D30 } as (Subset of D27) by L232 , ZFMISC_1:31;
reconsider D32 = ( C78 \/ D31 ) as (Subset of ( union C77 )) by L129;
L244: C82 in D29 by L231;
L245:
now
let C84 being set;
L246: ( D32 /\ C84 ) = ( ( C78 /\ C84 ) \/ ( D31 /\ C84 ) ) by XBOOLE_1:23;
assume L247: C84 in C77;
consider C85 being (Element of C84) such that L248: ( C78 /\ C84 ) c= { C85 } by L247 , L221 , L139;
per cases ;
suppose L249: C84 = C82;

take D33 = C83;
L250: ( C78 /\ C84 ) c= ( {} )
proof
let C86 being set;
assume L251: C86 in ( C78 /\ C84 );
L252: C86 in C84 by L251 , XBOOLE_0:def 4;
L253: C86 in C78 by L251 , XBOOLE_0:def 4;
L254: C86 in ( C80 . C86 ) by L253 , L214;
L255: C84 meets ( C80 . C86 ) by L254 , L252 , XBOOLE_0:3;
L256: ( C80 . C86 ) in ( rng C80 ) by L220 , L253 , FUNCT_1:def 3;
thus L257: thesis by L256 , L244 , L234 , L249 , L255 , TAXONOM2:def 5;
end;
L258: ( C78 /\ C84 ) = ( {} ) by L250;
thus L259: ( D32 /\ C84 ) c= { D33 } by L258 , L246 , XBOOLE_1:17;
end;
suppose L260: C84 <> C82;

L261: C82 in ( rng C81 ) by L226 , L232 , L233 , FUNCT_1:def 3;
L262: C82 misses C84 by L261 , L247 , L260 , TAXONOM2:def 5;
L263: D30 in C82 by L217 , L232 , L233;
L264: D30 nin C84 by L263 , L262 , XBOOLE_0:3;
L265: D31 c/= C84 by L264 , ZFMISC_1:31;
L266: ( D31 /\ C84 ) <> D31 by L265 , XBOOLE_1:17;
reconsider D34 = C85 as set;
take D35 = D34;
L267: ( D31 /\ C84 ) c= D31 by XBOOLE_1:17;
L268: ( D31 /\ C84 ) = ( {} ) by L267 , L266 , ZFMISC_1:33;
thus L269: ( D32 /\ C84 ) c= { D35 } by L268 , L248 , L246;
end;
end;
thus L271: thesis by L245 , L211;
end;
end;
registration
let C87 being  finite set;
let C88 being (Subset of ( bool C87 ));
cluster ( ProdMatroid C88 ) ->  finite;
coherence
proof
L273: ( union C88 ) is  finite;
thus L274: (the carrier of ( ProdMatroid C88 )) is  finite by L273 , L129;
end;
end;
registration
let C89 being set;
cluster  ->  mutually-disjoint for (a_partition of C89);
coherence
proof
let C90 being (a_partition of C89);
let C91 , C92 being set;
thus L276: thesis by EQREL_1:def 4;
end;
end;
registration
cluster  finite  strict for Matroid;
existence
proof
set D36 = the  finite non  empty set;
set D37 = the (a_partition of D36);
take ( ProdMatroid D37 );
thus L278: thesis;
end;
end;
registration
let C93 being  finite-membered non  void SubsetFamilyStr;
cluster  ->  finite for  independent  independent  independent  independent (Subset of C93);
coherence
proof
let C94 being  independent (Subset of C93);
L280: ( the_family_of C93 ) is  finite-membered by L78;
L281: C94 in ( the_family_of C93 ) by L5;
thus L282: thesis by L281 , L280;
end;
end;
definition
let C95 being Field;
let C96 being (VectSp of C95);
func LinearlyIndependentSubsets C96 ->  strict SubsetFamilyStr means 
:L284: ((the carrier of it) = (the carrier of C96) & ( the_family_of it ) = { B88 where B88 is (Subset of C96) : B88 is  linearly-independent });
existence
proof
set D38 = { B89 where B89 is (Subset of C96) : B89 is  linearly-independent };
set D39 = (the carrier of C96);
L285: D38 c= ( bool D39 )
proof
let C97 being set;
assume L286: C97 in D38;
L287: (ex B90 being (Subset of D39) st (C97 = B90 & B90 is  linearly-independent)) by L286;
thus L288: thesis by L287;
end;
reconsider D40 = D38 as (Subset-Family of D39) by L285;
take TopStruct (# D39 , D40 #);
thus L289: thesis;
end;
uniqueness;
end;
registration
let C98 being Field;
let C99 being (VectSp of C98);
cluster ( LinearlyIndependentSubsets C99 ) -> non  empty non  void  subset-closed;
coherence
proof
set D41 = ( LinearlyIndependentSubsets C99 );
L291: ( the_family_of D41 ) = { B91 where B91 is (Subset of C99) : B91 is  linearly-independent } by L284;
L292: (the carrier of D41) = (the carrier of C99) by L284;
thus L293: (the carrier of D41) is non  empty by L292;
L294: ( {} C99 ) is  linearly-independent;
L295: ( {} ) in ( the_family_of D41 ) by L294 , L291;
thus L296: (the topology of D41) is non  empty by L295;
let C100 , C101 being set;
assume L297: C100 in ( the_family_of D41 );
L298: (ex B92 being (Subset of C99) st (C100 = B92 & B92 is  linearly-independent)) by L297 , L291;
assume L299: C101 c= C100;
reconsider D42 = C101 as (Subset of C99) by L299 , L298 , XBOOLE_1:1;
L300: D42 is  linearly-independent by L298 , L299 , VECTSP_7:1;
thus L301: thesis by L300 , L291;
end;
end;
theorem
L303: (for B93 being Field holds (for B94 being (VectSp of B93) holds (for B95 being (Subset of ( LinearlyIndependentSubsets B94 )) holds (B95 is  independent iff B95 is  linearly-independent  linearly-independent  linearly-independent  linearly-independent (Subset of B94)))))
proof
let C102 being Field;
let C103 being (VectSp of C102);
set D43 = ( LinearlyIndependentSubsets C103 );
let C104 being (Subset of D43);
L304: ( the_family_of D43 ) = { B96 where B96 is (Subset of C103) : B96 is  linearly-independent } by L284;
L305: (C104 in ( the_family_of D43 ) iff (ex B97 being (Subset of C103) st (C104 = B97 & B97 is  linearly-independent))) by L304;
thus L306: thesis by L305 , L5;
end;
theorem
L307: (for B98 being Field holds (for B99 being (VectSp of B98) holds (for B100 , B101 being  finite (Subset of B99) holds (B101 c= B100 implies (for B102 being (Vector of B99) holds ((B102 in ( Lin B100 ) & (not B102 in ( Lin B101 ))) implies (ex B103 being (Vector of B99) st (B103 in ( B100 \ B101 ) & B103 in ( Lin ( ( B100 \ { B103 } ) \/ { B102 } ) )))))))))
proof
let C105 being Field;
let C106 being (VectSp of C105);
let C107 , C108 being  finite (Subset of C106);
assume L308: C108 c= C107;
L309: C107 = ( C108 \/ ( C107 \ C108 ) ) by L308 , XBOOLE_1:45;
thus L310: thesis by L309 , VECTSP_9:18;
end;
theorem
L311: (for B104 being Field holds (for B105 being (VectSp of B104) holds (for B106 being (Subset of B105) holds (B106 is  linearly-independent implies (for B107 being (Element of B105) holds (B107 nin (the carrier of ( Lin B106 )) implies ( B106 \/ { B107 } ) is  linearly-independent))))))
proof
let C109 being Field;
let C110 being (VectSp of C109);
let C111 being (Subset of C110);
assume that
L312: C111 is  linearly-independent;
L313: { ( Sum B108 ) where B108 is (Linear_Combination of C111) : (not contradiction) } = (the carrier of ( Lin C111 )) by VECTSP_7:def 2;
let C112 being (Element of C110);
set D44 = ( C111 \/ { C112 } );
assume that
L314: C112 nin (the carrier of ( Lin C111 ))
and
L315: D44 is  linearly-dependent;
consider C113 being (Linear_Combination of D44) such that L316: ( Sum C113 ) = ( 0. C110 ) and L317: ( Carrier C113 ) <> ( {} ) by L315 , VECTSP_7:def 1;
L318: C112 in { C112 } by TARSKI:def 1;
L319: ( ( C113 ! { C112 } ) . C112 ) = ( C113 . C112 ) by L318 , RANKNULL:25;
L320: C111 c= (the carrier of ( Lin C111 ))
proof
let C114 being set;
assume L321: C114 in C111;
reconsider D45 = C114 as (Element of C110) by L321;
L322: D45 in ( Lin C111 ) by L321 , VECTSP_7:8;
thus L323: thesis by L322 , STRUCT_0:def 5;
end;
L324: C112 nin C111 by L320 , L314;
L325: ( D44 \ C111 ) = { C112 } by L324 , XBOOLE_1:88 , ZFMISC_1:50;
L326: C113 = ( ( C113 ! C111 ) + ( C113 ! { C112 } ) ) by L325 , RANKNULL:27 , XBOOLE_1:7;
L327: ( 0. C110 ) = ( ( Sum ( C113 ! C111 ) ) + ( Sum ( C113 ! { C112 } ) ) ) by L326 , L316 , VECTSP_6:44
.= ( ( Sum ( C113 ! C111 ) ) + ( ( C113 . C112 ) * C112 ) ) by L319 , VECTSP_6:17;
L328: ( ( C113 . C112 ) * C112 ) = ( - ( Sum ( C113 ! C111 ) ) ) by L327 , ALGSTR_0:def 13;
L329: ( ( - ( ( C113 . C112 ) " ) ) * ( C113 ! C111 ) ) is (Linear_Combination of C111) by VECTSP_6:31;
L330:
now
assume L331: ( C113 . C112 ) <> ( 0. C109 );
L332: C112 = ( ( ( C113 . C112 ) " ) * ( - ( Sum ( C113 ! C111 ) ) ) ) by L331 , L328 , VECTSP_1:20
.= ( - ( ( ( C113 . C112 ) " ) * ( Sum ( C113 ! C111 ) ) ) ) by VECTSP_1:22
.= ( ( - ( ( C113 . C112 ) " ) ) * ( Sum ( C113 ! C111 ) ) ) by VECTSP_1:21
.= ( Sum ( ( - ( ( C113 . C112 ) " ) ) * ( C113 ! C111 ) ) ) by VECTSP_6:45;
thus L333: contradiction by L332 , L314 , L313 , L329;
end;
L334: C112 nin ( Carrier C113 ) by L330 , VECTSP_6:2;
L335: ( Carrier C113 ) c= D44 by VECTSP_6:def 4;
L336: ( Carrier C113 ) c= C111
proof
let C115 being set;
thus L337: thesis by L334 , L335 , ZFMISC_1:136;
end;
L338: C113 is (Linear_Combination of C111) by L336 , VECTSP_6:def 4;
thus L339: contradiction by L338 , L312 , L316 , L317 , VECTSP_7:def 1;
end;
registration
let C116 being Field;
let C117 being (VectSp of C116);
cluster ( LinearlyIndependentSubsets C117 ) ->  with_exchange_property;
coherence
proof
set D46 = ( LinearlyIndependentSubsets C117 );
L340: ( the_family_of D46 ) = { B109 where B109 is (Subset of C117) : B109 is  linearly-independent } by L284;
let C118 , C119 being  finite (Subset of D46);
assume that
L341: C118 in ( the_family_of D46 )
and
L342: C119 in ( the_family_of D46 )
and
L343: ( card C119 ) = ( ( card C118 ) + 1 );
L344: C119 is  independent by L342 , L5;
L345: C118 is  independent by L341 , L5;
reconsider D47 = C118 , D48 = C119 as  linearly-independent  finite (Subset of C117) by L345 , L344 , L303;
set D49 = ( Lin ( D47 \/ D48 ) );
L346: D47 c= (the carrier of D49)
proof
let C120 being set;
assume L347: C120 in D47;
L348: C120 in ( D47 \/ D48 ) by L347 , XBOOLE_0:def 3;
L349: C120 in D49 by L348 , VECTSP_7:8;
thus L350: thesis by L349 , STRUCT_0:def 5;
end;
reconsider D50 = D47 as  linearly-independent  finite (Subset of D49) by L346 , VECTSP_9:12;
L351: D48 c= (the carrier of D49)
proof
let C121 being set;
assume L352: C121 in D48;
L353: C121 in ( D47 \/ D48 ) by L352 , XBOOLE_0:def 3;
L354: C121 in D49 by L353 , VECTSP_7:8;
thus L355: thesis by L354 , STRUCT_0:def 5;
end;
reconsider D51 = D48 as  linearly-independent  finite (Subset of D49) by L351 , VECTSP_9:12;
L356: D49 = ( Lin ( D50 \/ D51 ) ) by VECTSP_9:17;
consider C122 being (Basis of D49) such that L357: D48 c= C122 by L356 , VECTSP_7:19;
consider C123 being (Basis of D49) such that L358: C123 c= ( D50 \/ D51 ) by L356 , VECTSP_7:20;
reconsider D52 = C123 as  finite set by L358;
L359: D52 is (Basis of D49);
L360: D49 is  finite-dimensional by L359 , MATRLIN:def 1;
L361: ( card D52 ) = ( card C122 ) by L360 , VECTSP_9:22;
L362: ( card C119 ) c= ( card D52 ) by L361 , L357 , CARD_1:11;
L363: ( card C119 ) <= ( card D52 ) by L362 , NAT_1:39;
L364: ( card C118 ) < ( card D52 ) by L363 , L343 , NAT_1:13;
set D53 = the (Element of ( C123 \ (the carrier of ( Lin D47 )) ));
L365: D47 is (Basis of ( Lin D47 )) by RANKNULL:20;
L366: ( Lin D47 ) is  finite-dimensional by L365 , MATRLIN:def 1;
L367:
now
assume L368: C123 c= (the carrier of ( Lin D47 ));
reconsider D54 = C123 as (Subset of ( Lin D47 )) by L368;
L369: (the carrier of ( Lin D47 )) c= (the carrier of C117) by VECTSP_4:def 2;
reconsider D55 = D54 as (Subset of C117) by L369 , XBOOLE_1:1;
L370: C123 is  linearly-independent by VECTSP_7:def 3;
L371: D55 is  linearly-independent by L370 , VECTSP_9:11;
consider C124 being (Basis of ( Lin D47 )) such that L372: D54 c= C124 by L371 , VECTSP_7:19 , VECTSP_9:12;
L373: ( card C118 ) = ( card C124 ) by L365 , L366 , VECTSP_9:22;
L374: C124 is  finite by L373;
thus L375: contradiction by L374 , L364 , L372 , L373 , NAT_1:43;
end;
consider C125 being set such that L376: C125 in C123 and L377: C125 nin (the carrier of ( Lin D47 )) by L367 , TARSKI:def 3;
L378: C125 in ( C123 \ (the carrier of ( Lin D47 )) ) by L376 , L377 , XBOOLE_0:def 5;
L379: D53 nin (the carrier of ( Lin D47 )) by L378 , XBOOLE_0:def 5;
L380: D53 in C123 by L378 , XBOOLE_0:def 5;
L381: D53 in ( C118 \/ C119 ) by L380 , L358;
reconsider D56 = D53 as (Element of D46) by L381;
take D56;
L382: C118 c= (the carrier of ( Lin D47 ))
proof
let C126 being set;
assume L383: C126 in C118;
L384: C126 in ( Lin D47 ) by L383 , VECTSP_7:8;
thus L385: thesis by L384 , STRUCT_0:def 5;
end;
L386: D56 nin C118 by L382 , L378 , XBOOLE_0:def 5;
L387: D56 in D48 by L386 , L358 , L380 , XBOOLE_0:def 3;
thus L388: D56 in ( C119 \ C118 ) by L387 , L386 , XBOOLE_0:def 5;
reconsider D57 = D56 as (Element of C117) by L387;
L389: ( D47 \/ { D57 } ) is  linearly-independent by L379 , L311;
thus L390: ( C118 \/ { D56 } ) in ( the_family_of D46 ) by L389 , L340;
end;
end;
registration
let C127 being Field;
let C128 being  finite-dimensional (VectSp of C127);
cluster ( LinearlyIndependentSubsets C128 ) ->  finite-membered;
coherence
proof
let C129 being set;
set D58 = ( LinearlyIndependentSubsets C128 );
assume L392: C129 in ( the_family_of D58 );
L393: C129 is  independent  independent  independent  independent (Subset of D58) by L392 , L5;
L394: C129 is  linearly-independent  linearly-independent  linearly-independent  linearly-independent (Subset of C128) by L393 , L303;
thus L395: thesis by L394 , VECTSP_9:21;
end;
end;
begin
definition
let C130 being SubsetFamilyStr;
let C131 , C132 being (Subset of C130);
pred C131 is_maximal_independent_in C132
means
:L397: (C131 is  independent & C131 c= C132 & (for B110 being (Subset of C130) holds ((B110 is  independent & B110 c= C132 & C131 c= B110) implies C131 = B110)))
;end;
theorem
L399: (for B111 being non  void  finite-degree SubsetFamilyStr holds (for B112 , B113 being (Subset of B111) holds ((B113 c= B112 & B113 is  independent) implies (ex B114 being  independent (Subset of B111) st (B113 c= B114 & B114 is_maximal_independent_in B112)))))
proof
let C133 being non  void  finite-degree SubsetFamilyStr;
let C134 , C135 being (Subset of C133);
assume that
L400: C135 c= C134
and
L401: C135 is  independent;
reconsider D59 = C135 as  independent (Subset of C133) by L401;
defpred S2[ Nat ] means (for B115 being  finite (Subset of C133) holds ((C135 c= B115 & B115 c= C134 & B115 is  independent) implies ( card B115 ) <= $1));
consider C136 being Nat such that L402: (for B116 being  finite (Subset of C133) holds (B116 is  independent implies ( card B116 ) <= C136)) by L80;
reconsider D60 = C136 as (Element of ( NAT )) by ORDINAL1:def 12;
L403: S2[ D60 ] by L402;
L404: (ex B117 being Nat st S2[ B117 ]) by L403;
consider C137 being Nat such that L405: (S2[ C137 ] & (for B118 being Nat holds (S2[ B118 ] implies C137 <= B118))) from NAT_1:sch 5(L404);
L406:
now
L407: ( 0 ) <= ( card D59 ) by NAT_1:2;
L408: ( ( card D59 ) + 1 ) >= ( ( 0 ) + 1 ) by L407 , XREAL_1:6;
assume L409: (for B119 being  independent (Subset of C133) holds ((C135 c= B119 & B119 c= C134) implies ( card B119 ) < C137));
L410: ( card D59 ) < C137 by L409 , L400;
L411: ( ( card D59 ) + 1 ) <= C137 by L410 , NAT_1:13;
consider C138 being Nat such that L412: C137 = ( 1 + C138 ) by L411 , L408 , NAT_1:10 , XXREAL_0:2;
reconsider D61 = C138 as (Element of ( NAT )) by ORDINAL1:def 12;
L413: S2[ D61 ]
proof
let C139 being  finite (Subset of C133);
assume that
L414: C135 c= C139
and
L415: C139 c= C134
and
L416: C139 is  independent;
L417: ( card C139 ) < ( D61 + 1 ) by L409 , L412 , L414 , L415 , L416;
thus L418: thesis by L417 , NAT_1:13;
end;
L419: ( D61 + 1 ) <= D61 by L413 , L405 , L412;
thus L420: contradiction by L419 , NAT_1:13;
end;
consider C140 being  independent (Subset of C133) such that L421: C135 c= C140 and L422: C140 c= C134 and L423: ( card C140 ) >= C137 by L406;
L424: ( card C140 ) <= C137 by L405 , L421 , L422;
take C140;
thus L425: (C135 c= C140 & C140 is  independent & C140 c= C134) by L421 , L422;
let C141 being (Subset of C133);
assume that
L426: C141 is  independent
and
L427: C141 c= C134
and
L428: C140 c= C141;
reconsider D62 = C141 as  independent (Subset of C133) by L426;
L429: ( card C140 ) <= ( card D62 ) by L428 , NAT_1:43;
L430: C137 <= ( card D62 ) by L429 , L423 , XXREAL_0:2;
L431: C135 c= C141 by L421 , L428 , XBOOLE_1:1;
L432: ( card D62 ) <= C137 by L431 , L405 , L427;
L433: ( card D62 ) = C137 by L432 , L430 , XXREAL_0:1;
thus L434: thesis by L433 , L423 , L428 , L424 , CARD_FIN:1 , XXREAL_0:1;
end;
theorem
L435: (for B120 being non  void  finite-degree  subset-closed SubsetFamilyStr holds (for B121 being (Subset of B120) holds (ex B122 being  independent (Subset of B120) st B122 is_maximal_independent_in B121)))
proof
let C142 being non  void  finite-degree  subset-closed SubsetFamilyStr;
let C143 being (Subset of C142);
L436: ( {} C142 ) c= C143 by XBOOLE_1:2;
L437: (ex B123 being  independent (Subset of C142) st (( {} C142 ) c= B123 & B123 is_maximal_independent_in C143)) by L436 , L399;
thus L438: thesis by L437;
end;
theorem
L439: (for B124 being non  empty non  void  subset-closed  finite-degree SubsetFamilyStr holds (B124 is Matroid iff (for B125 being (Subset of B124) holds (for B126 , B127 being  independent (Subset of B124) holds ((B126 is_maximal_independent_in B125 & B127 is_maximal_independent_in B125) implies ( card B126 ) = ( card B127 ))))))
proof
let C144 being non  empty non  void  subset-closed  finite-degree SubsetFamilyStr;
thus L440:now
assume L441: C144 is Matroid;
let C145 being (Subset of C144);
L442:
now
let C146 , C147 being  independent (Subset of C144);
assume that
L443: C146 is_maximal_independent_in C145
and
L444: C147 is_maximal_independent_in C145
and
L445: ( card C146 ) < ( card C147 );
L446: C146 c= C145 by L443 , L397;
L447: ( ( card C146 ) + 1 ) <= ( card C147 ) by L445 , NAT_1:13;
L448: ( ( card C146 ) + 1 ) c= ( card C147 ) by L447 , NAT_1:39;
consider C148 being set such that L449: C148 c= C147 and L450: ( card C148 ) = ( ( card C146 ) + 1 ) by L448 , CARD_FIL:36;
reconsider D63 = C148 as  finite (Subset of C144) by L449 , XBOOLE_1:1;
L451: D63 is  independent by L449 , L47;
consider C149 being (Element of C144) such that L452: C149 in ( D63 \ C146 ) and L453: ( C146 \/ { C149 } ) is  independent by L451 , L441 , L450 , L60;
L454: ( D63 \ C146 ) c= D63 by XBOOLE_1:36;
L455: ( D63 \ C146 ) c= C147 by L454 , L449 , XBOOLE_1:1;
L456: C147 c= C145 by L444 , L397;
L457: ( D63 \ C146 ) c= C145 by L456 , L455 , XBOOLE_1:1;
L458: { C149 } c= C145 by L457 , L452 , ZFMISC_1:31;
L459: ( C146 \/ { C149 } ) c= C145 by L458 , L446 , XBOOLE_1:8;
L460: C146 c= ( C146 \/ { C149 } ) by XBOOLE_1:7;
L461: ( C146 \/ { C149 } ) = C146 by L460 , L443 , L453 , L459 , L397;
L462: { C149 } c= C146 by L461 , XBOOLE_1:7;
L463: C149 in C146 by L462 , ZFMISC_1:31;
thus L464: contradiction by L463 , L452 , XBOOLE_0:def 5;
end;
let C150 , C151 being  independent (Subset of C144);
assume that
L465: C150 is_maximal_independent_in C145
and
L466: C151 is_maximal_independent_in C145;
L467: (( card C150 ) < ( card C151 ) or ( card C151 ) < ( card C150 ) or ( card C150 ) = ( card C151 )) by XXREAL_0:1;
thus L468: ( card C150 ) = ( card C151 ) by L467 , L442 , L465 , L466;
end;
assume L469: (for B128 being (Subset of C144) holds (for B129 , B130 being  independent (Subset of C144) holds ((B129 is_maximal_independent_in B128 & B130 is_maximal_independent_in B128) implies ( card B129 ) = ( card B130 ))));
L470: C144 is  with_exchange_property
proof
let C152 , C153 being  finite (Subset of C144);
reconsider D64 = ( C152 \/ C153 ) as (Subset of C144);
assume that
L471: C152 in ( the_family_of C144 )
and
L472: C153 in ( the_family_of C144 )
and
L473: ( card C153 ) = ( ( card C152 ) + 1 );
L474: C153 is  independent by L472 , L5;
consider C154 being  independent (Subset of C144) such that L475: C153 c= C154 and L476: C154 is_maximal_independent_in D64 by L474 , L399 , XBOOLE_1:7;
L477: ( card C153 ) <= ( card C154 ) by L475 , NAT_1:43;
assume L478: (for B131 being (Element of C144) holds (B131 in ( C153 \ C152 ) implies (not ( C152 \/ { B131 } ) in ( the_family_of C144 ))));
reconsider D65 = C152 as  independent (Subset of C144) by L471 , L5;
L479: D65 is_maximal_independent_in D64
proof
thus L480: D65 in ( the_family_of C144 ) by L471;
thus L481: D65 c= D64 by XBOOLE_1:7;
let C155 being (Subset of C144);
assume that
L482: C155 is  independent
and
L483: C155 c= D64
and
L484: D65 c= C155;
assume L485: (not (D65 c= C155 & C155 c= D65));
consider C156 being set such that L486: C156 in C155 and L487: (not C156 in D65) by L485 , L484 , TARSKI:def 3;
reconsider D66 = C156 as (Element of C144) by L486;
L488: D66 in C153 by L483 , L486 , L487 , XBOOLE_0:def 3;
L489: D66 in ( C153 \ D65 ) by L488 , L487 , XBOOLE_0:def 5;
L490: (not ( D65 \/ { D66 } ) in ( the_family_of C144 )) by L489 , L478;
L491: (not ( D65 \/ { D66 } ) is  independent) by L490 , L5;
L492: { D66 } c= C155 by L486 , ZFMISC_1:31;
L493: ( D65 \/ { D66 } ) c= C155 by L492 , L484 , XBOOLE_1:8;
thus L494: contradiction by L493 , L482 , L491 , L47;
end;
L495: ( card D65 ) = ( card C154 ) by L479 , L469 , L476;
thus L496: contradiction by L495 , L473 , L477 , NAT_1:13;
end;
thus L497: thesis by L470;
end;
definition
let C157 being  finite-degree Matroid;
let C158 being (Subset of C157);
func Rnk C158 -> Nat equals 
( union { ( card B132 ) where B132 is  independent (Subset of C157) : B132 c= C158 } );
coherence
proof
set D67 = { ( card B133 ) where B133 is  independent (Subset of C157) : B133 c= C158 };
defpred S3[ Nat ] means (ex B134 being  independent (Subset of C157) st (B134 c= C158 & $1 = ( card B134 )));
defpred S4[ Nat ] means (for B135 being  independent (Subset of C157) holds (B135 c= C158 implies ( card B135 ) <= $1));
consider C159 being Nat such that L498: (for B136 being  finite (Subset of C157) holds (B136 is  independent implies ( card B136 ) <= C159)) by L80;
L499: (ex B137 being Nat st S4[ B137 ])
proof
take C159;
thus L500: thesis by L498;
end;
consider C160 being Nat such that L501: (S4[ C160 ] & (for B138 being Nat holds (S4[ B138 ] implies C160 <= B138))) from NAT_1:sch 5(L499);
L502: ( union D67 ) = C160
proof
L503:
now
let C161 being set;
assume L504: C161 in D67;
consider C162 being  independent (Subset of C157) such that L505: C161 = ( card C162 ) and L506: C162 c= C158 by L504;
L507: ( card C162 ) <= C160 by L501 , L506;
thus L508: C161 c= C160 by L507 , L505 , NAT_1:39;
end;
thus L509: ( union D67 ) c= C160 by L503 , ZFMISC_1:76;
L510: ( {} C157 ) c= C158 by XBOOLE_1:2;
L511: (for B139 being Nat holds (S3[ B139 ] implies B139 <= C160)) by L501;
L512: ( card ( {} ) ) = ( card ( {} ) );
L513: (ex B140 being Nat st S3[ B140 ]) by L512 , L510;
consider C163 being Nat such that L514: (S3[ C163 ] & (for B141 being Nat holds (S3[ B141 ] implies B141 <= C163))) from NAT_1:sch 6(L511 , L513);
L515: S4[ C163 ] by L514;
L516: C160 <= C163 by L515 , L501;
L517: C163 <= C160 by L501 , L514;
L518: C163 = C160 by L517 , L516 , XXREAL_0:1;
L519: C160 in D67 by L518 , L514;
thus L520: thesis by L519 , ZFMISC_1:74;
end;
thus L521: thesis by L502;
end;
end;
theorem
L523: (for B142 being  finite-degree Matroid holds (for B143 being (Subset of B142) holds (for B144 being  independent (Subset of B142) holds (B144 c= B143 implies ( card B144 ) <= ( Rnk B143 )))))
proof
let C164 being  finite-degree Matroid;
let C165 being (Subset of C164);
let C166 being  independent (Subset of C164);
assume L524: C166 c= C165;
L525: ( card C166 ) in { ( card B145 ) where B145 is  independent (Subset of C164) : B145 c= C165 } by L524;
L526: ( card C166 ) c= ( Rnk C165 ) by L525 , ZFMISC_1:74;
thus L527: thesis by L526 , NAT_1:39;
end;
theorem
L528: (for B146 being  finite-degree Matroid holds (for B147 being (Subset of B146) holds (ex B148 being  independent (Subset of B146) st (B148 c= B147 & ( card B148 ) = ( Rnk B147 )))))
proof
let C167 being  finite-degree Matroid;
let C168 being (Subset of C167);
defpred S5[ Nat ] means (for B149 being  independent (Subset of C167) holds (B149 c= C168 implies ( card B149 ) <= $1));
defpred S6[ Nat ] means (ex B150 being  independent (Subset of C167) st (B150 c= C168 & $1 = ( card B150 )));
set D68 = { ( card B151 ) where B151 is  independent (Subset of C167) : B151 c= C168 };
L529: ( {} C167 ) c= C168 by XBOOLE_1:2;
L530: ( card ( {} ) ) = ( card ( {} ) );
L531: (ex B152 being Nat st S6[ B152 ]) by L530 , L529;
consider C169 being Nat such that L532: (for B153 being  finite (Subset of C167) holds (B153 is  independent implies ( card B153 ) <= C169)) by L80;
L533: (ex B154 being Nat st S5[ B154 ])
proof
take C169;
thus L534: thesis by L532;
end;
consider C170 being Nat such that L535: (S5[ C170 ] & (for B155 being Nat holds (S5[ B155 ] implies C170 <= B155))) from NAT_1:sch 5(L533);
L536:
now
let C171 being set;
assume L537: C171 in D68;
consider C172 being  independent (Subset of C167) such that L538: C171 = ( card C172 ) and L539: C172 c= C168 by L537;
L540: ( card C172 ) <= C170 by L535 , L539;
thus L541: C171 c= C170 by L540 , L538 , NAT_1:39;
end;
L542: ( Rnk C168 ) c= C170 by L536 , ZFMISC_1:76;
L543: (for B156 being Nat holds (S6[ B156 ] implies B156 <= C170)) by L535;
consider C173 being Nat such that L544: (S6[ C173 ] & (for B157 being Nat holds (S6[ B157 ] implies B157 <= C173))) from NAT_1:sch 6(L543 , L531);
L545: S5[ C173 ] by L544;
L546: C170 <= C173 by L545 , L535;
consider C174 being  independent (Subset of C167) such that L547: C174 c= C168 and L548: C173 = ( card C174 ) by L544;
take C174;
L549: C173 <= C170 by L535 , L544;
L550: C173 = C170 by L549 , L546 , XXREAL_0:1;
L551: C170 in D68 by L550 , L547 , L548;
L552: C170 c= ( Rnk C168 ) by L551 , ZFMISC_1:74;
thus L553: thesis by L552 , L542 , L547 , L548 , L550 , XBOOLE_0:def 10;
end;
theorem
L554: (for B158 being  finite-degree Matroid holds (for B159 being (Subset of B158) holds (for B160 being  independent (Subset of B158) holds (B160 is_maximal_independent_in B159 iff (B160 c= B159 & ( card B160 ) = ( Rnk B159 ))))))
proof
let C175 being  finite-degree Matroid;
let C176 being (Subset of C175);
set D69 = { ( card B161 ) where B161 is  independent (Subset of C175) : B161 c= C176 };
let C177 being  independent (Subset of C175);
consider C178 being  independent (Subset of C175) such that L555: C178 c= C176 and L556: ( card C178 ) = ( Rnk C176 ) by L528;
L557:
now
let C179 being  independent (Subset of C175);
assume that
L558: C179 c= C176
and
L559: ( card C179 ) = ( Rnk C176 );
thus L560: C179 is_maximal_independent_in C176
proof
thus L561: (C179 is  independent & C179 c= C176) by L558;
let C180 being (Subset of C175);
assume L562: C180 is  independent;
reconsider D70 = C180 as  independent (Subset of C175) by L562;
assume L563: C180 c= C176;
L564: ( card D70 ) in D69 by L563;
L565: ( card D70 ) c= ( Rnk C176 ) by L564 , ZFMISC_1:74;
assume L566: C179 c= C180;
L567: ( card C179 ) c= ( card D70 ) by L566 , CARD_1:11;
L568: ( card C179 ) = ( card D70 ) by L567 , L559 , L565 , XBOOLE_0:def 10;
thus L569: thesis by L568 , L566 , CARD_FIN:1;
end;

end;
thus L561:now
assume L562: C177 is_maximal_independent_in C176;
thus L563: C177 c= C176 by L562 , L397;
L564: C178 is_maximal_independent_in C176 by L557 , L555 , L556;
thus L565: ( card C177 ) = ( Rnk C176 ) by L564 , L556 , L562 , L439;
end;
thus L566: thesis by L557;
end;
theorem
L567: (for B162 being  finite-degree Matroid holds (for B163 being  finite (Subset of B162) holds ( Rnk B163 ) <= ( card B163 )))
proof
let C181 being  finite-degree Matroid;
let C182 being  finite (Subset of C181);
L568: (ex B164 being  independent (Subset of C181) st (B164 c= C182 & ( card B164 ) = ( Rnk C182 ))) by L528;
L569: ( Rnk C182 ) c= ( card C182 ) by L568 , CARD_1:11;
thus L570: thesis by L569 , NAT_1:39;
end;
theorem
L571: (for B165 being  finite-degree Matroid holds (for B166 being  finite (Subset of B165) holds (B166 is  independent iff ( card B166 ) = ( Rnk B166 ))))
proof
let C183 being  finite-degree Matroid;
let C184 being  finite (Subset of C183);
set D71 = { ( card B167 ) where B167 is  independent (Subset of C183) : B167 c= C184 };
thus L572:now
assume L573: C184 is  independent;
L574: ( card C184 ) in D71 by L573;
L575: ( card C184 ) c= ( Rnk C184 ) by L574 , ZFMISC_1:74;
L576: ( card C184 ) <= ( Rnk C184 ) by L575 , NAT_1:39;
L577: ( Rnk C184 ) <= ( card C184 ) by L567;
thus L578: ( card C184 ) = ( Rnk C184 ) by L577 , L576 , XXREAL_0:1;
end;
L579: (ex B168 being  independent (Subset of C183) st (B168 c= C184 & ( card B168 ) = ( Rnk C184 ))) by L528;
thus L580: thesis by L579 , CARD_FIN:1;
end;
definition
let C185 being  finite-degree Matroid;
func Rnk C185 -> Nat equals 
( Rnk ( [#] C185 ) );
coherence;
end;
definition
let C186 being non  void  finite-degree SubsetFamilyStr;
mode Basis of C186
 ->  independent (Subset of C186)
means :L582: it is_maximal_independent_in ( [#] C186 );
existence
proof
set D72 = the  independent (Subset of C186);
set D73 = ( [#] C186 );
consider C187 being  independent (Subset of C186) such that L583: D72 c= C187 and L584: C187 is_maximal_independent_in D73 by L399;
take C187;
thus L585: thesis by L584;
end;
end;
theorem
L587: (for B169 being  finite-degree Matroid holds (for B170 , B171 being (Basis of B169) holds ( card B170 ) = ( card B171 )))
proof
let C188 being  finite-degree Matroid;
let C189 , C190 being (Basis of C188);
L588: C190 is_maximal_independent_in ( [#] C188 ) by L582;
L589: C189 is_maximal_independent_in ( [#] C188 ) by L582;
thus L590: thesis by L589 , L588 , L439;
end;
theorem
L591: (for B172 being  finite-degree Matroid holds (for B173 being  independent (Subset of B172) holds (ex B174 being (Basis of B172) st B173 c= B174)))
proof
let C191 being  finite-degree Matroid;
let C192 being  independent (Subset of C191);
consider C193 being  independent (Subset of C191) such that L592: C192 c= C193 and L593: C193 is_maximal_independent_in ( [#] C191 ) by L399;
reconsider D74 = C193 as (Basis of C191) by L593 , L582;
take D74;
thus L594: thesis by L592;
end;
theorem
L595: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R3 being (Subset of R1) holds (R2 c= R3 implies ( Rnk R2 ) <= ( Rnk R3 )))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R3 being (Subset of R1);
L596: (ex B175 being  independent (Subset of R1) st (B175 c= R2 & ( card B175 ) = ( Rnk R2 ))) by L528;
thus L597: thesis by L596 , L523 , XBOOLE_1:1;
end;
theorem
L598: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R3 being (Subset of R1) holds ( ( Rnk ( R2 \/ R3 ) ) + ( Rnk ( R2 /\ R3 ) ) ) <= ( ( Rnk R2 ) + ( Rnk R3 ) ))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R3 being (Subset of R1);
consider C194 being  independent (Subset of R1) such that L599: C194 c= ( R2 /\ R3 ) and L600: ( card C194 ) = ( Rnk ( R2 /\ R3 ) ) by L528;
L601: ( R2 /\ R3 ) c= R2 by XBOOLE_1:17;
L602: C194 c= R2 by L601 , L599 , XBOOLE_1:1;
consider C195 being  independent (Subset of R1) such that L603: C194 c= C195 and L604: C195 is_maximal_independent_in R2 by L602 , L399;
L605: C195 c= R2 by L604 , L397;
L606: ( C195 /\ R3 ) c= C194
proof
let C196 being set;
assume L607: C196 in ( C195 /\ R3 );
L608: C196 in C195 by L607 , XBOOLE_0:def 4;
L609: { C196 } c= C195 by L608 , ZFMISC_1:31;
L610: ( C194 \/ { C196 } ) c= C195 by L609 , L603 , XBOOLE_1:8;
reconsider D75 = ( C194 \/ { C196 } ) as  independent (Subset of R1) by L610 , L47 , XBOOLE_1:1;
L611: C196 in R3 by L607 , XBOOLE_0:def 4;
L612: C196 in ( R2 /\ R3 ) by L611 , L605 , L608 , XBOOLE_0:def 4;
L613: { C196 } c= ( R2 /\ R3 ) by L612 , ZFMISC_1:31;
L614: D75 c= ( R2 /\ R3 ) by L613 , L599 , XBOOLE_1:8;
L615: C194 c= D75 by XBOOLE_1:7;
L616: C194 is_maximal_independent_in ( R2 /\ R3 ) by L599 , L600 , L554;
L617: C194 = D75 by L616 , L614 , L615 , L397;
L618: { C196 } c= C194 by L617 , XBOOLE_1:7;
thus L619: thesis by L618 , ZFMISC_1:31;
end;
L620: ( R2 /\ R3 ) c= R3 by XBOOLE_1:17;
L621: C194 c= R3 by L620 , L599 , XBOOLE_1:1;
L622: C194 c= ( C195 /\ R3 ) by L621 , L603 , XBOOLE_1:19;
L623: ( C195 /\ R3 ) = C194 by L622 , L606 , XBOOLE_0:def 10;
L624: R2 c= ( R2 \/ R3 ) by XBOOLE_1:7;
L625: C195 c= ( R2 \/ R3 ) by L624 , L605 , XBOOLE_1:1;
consider C197 being  independent (Subset of R1) such that L626: C195 c= C197 and L627: C197 is_maximal_independent_in ( R2 \/ R3 ) by L625 , L399;
L628: ( C195 /\ ( C197 /\ R3 ) ) = ( ( C195 /\ C197 ) /\ R3 ) by XBOOLE_1:16
.= ( C195 /\ R3 ) by L626 , XBOOLE_1:28;
L629: C197 c= ( R2 \/ R3 ) by L627 , L554;
L630: C197 = ( C195 \/ ( C197 /\ R3 ) )
proof
thus L631: C197 c= ( C195 \/ ( C197 /\ R3 ) )
proof
let C198 being set;
assume L632: C198 in C197;
L633: { C198 } c= C197 by L632 , ZFMISC_1:31;
L634: ( C195 \/ { C198 } ) c= C197 by L633 , L626 , XBOOLE_1:8;
reconsider D76 = ( C195 \/ { C198 } ) as  independent (Subset of R1) by L634 , L47 , XBOOLE_1:1;
L635:
now
assume L636: C198 in R2;
L637: { C198 } c= R2 by L636 , ZFMISC_1:31;
L638: D76 c= R2 by L637 , L605 , XBOOLE_1:8;
L639: C195 c= D76 by XBOOLE_1:7;
L640: C195 = D76 by L639 , L604 , L638 , L397;
L641: { C198 } c= C195 by L640 , XBOOLE_1:7;
thus L642: C198 in C195 by L641 , ZFMISC_1:31;
end;
L643: (C198 in R3 implies C198 in ( C197 /\ R3 )) by L632 , XBOOLE_0:def 4;
thus L644: thesis by L643 , L629 , L632 , L635 , XBOOLE_0:def 3;
end;

let C199 being set;
assume L645: C199 in ( C195 \/ ( C197 /\ R3 ) );
L646: (C199 in C195 or C199 in ( C197 /\ R3 )) by L645 , XBOOLE_0:def 3;
thus L647: thesis by L646 , L626 , XBOOLE_0:def 4;
end;
L648: ( C197 /\ R3 ) c= R3 by XBOOLE_1:17;
consider C200 being  independent (Subset of R1) such that L649: ( C197 /\ R3 ) c= C200 and L650: C200 is_maximal_independent_in R3 by L648 , L399;
L651: ( card C200 ) = ( Rnk R3 ) by L650 , L554;
L652: ( card ( C197 /\ R3 ) ) <= ( Rnk R3 ) by L651 , L649 , NAT_1:43;
L653: ( card C197 ) = ( Rnk ( R2 \/ R3 ) ) by L627 , L554;
L654: ( card C195 ) = ( Rnk R2 ) by L604 , L554;
L655: ( Rnk ( R2 \/ R3 ) ) = ( ( ( Rnk R2 ) + ( card ( C197 /\ R3 ) ) ) - ( Rnk ( R2 /\ R3 ) ) ) by L654 , L600 , L653 , L630 , L628 , L623 , CARD_2:45;
thus L656: thesis by L655 , L652 , XREAL_1:6;
end;
theorem
L657: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R3 being (Subset of R1) holds (for R5 being (Element of R1) holds (( Rnk R2 ) <= ( Rnk ( R2 \/ R3 ) ) & ( Rnk ( R2 \/ { R5 } ) ) <= ( ( Rnk R2 ) + 1 ))))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R3 being (Subset of R1);
let R5 being (Element of R1);
L658: ( card { R5 } ) = 1 by CARD_1:30;
thus L659: ( Rnk R2 ) <= ( Rnk ( R2 \/ R3 ) ) by L595 , XBOOLE_1:7;
L660: ( ( Rnk ( R2 \/ { R5 } ) ) + ( Rnk ( R2 /\ { R5 } ) ) ) <= ( ( Rnk R2 ) + ( Rnk { R5 } ) ) by L598;
L661: ( Rnk { R5 } ) <= ( card { R5 } ) by L567;
L662: ( ( Rnk R2 ) + ( Rnk { R5 } ) ) <= ( ( Rnk R2 ) + 1 ) by L661 , L658 , XREAL_1:6;
L663: ( ( Rnk ( R2 \/ { R5 } ) ) + ( Rnk ( R2 /\ { R5 } ) ) ) <= ( ( Rnk R2 ) + 1 ) by L662 , L660 , XXREAL_0:2;
L664: ( Rnk ( R2 \/ { R5 } ) ) <= ( ( Rnk ( R2 \/ { R5 } ) ) + ( Rnk ( R2 /\ { R5 } ) ) ) by NAT_1:11;
thus L665: thesis by L664 , L663 , XXREAL_0:2;
end;
theorem
L666: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R5 being (Element of R1) holds (for R6 being (Element of R1) holds ((( Rnk ( R2 \/ { R5 } ) ) = ( Rnk ( R2 \/ { R6 } ) ) & ( Rnk ( R2 \/ { R6 } ) ) = ( Rnk R2 )) implies ( Rnk ( R2 \/ { R5 , R6 } ) ) = ( Rnk R2 ))))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R5 being (Element of R1);
let R6 being (Element of R1);
assume that
L667: ( Rnk ( R2 \/ { R5 } ) ) = ( Rnk ( R2 \/ { R6 } ) )
and
L668: ( Rnk ( R2 \/ { R6 } ) ) = ( Rnk R2 );
consider C201 being  independent (Subset of R1) such that L669: C201 c= R2 and L670: ( card C201 ) = ( Rnk R2 ) by L528;
L671: C201 is_maximal_independent_in R2 by L669 , L670 , L554;
L672: R2 c= ( R2 \/ { R6 } ) by XBOOLE_1:7;
L673: C201 c= ( R2 \/ { R6 } ) by L672 , L669 , XBOOLE_1:1;
L674: C201 is_maximal_independent_in ( R2 \/ { R6 } ) by L673 , L670 , L668 , L554;
L675: R2 c= ( R2 \/ { R5 } ) by XBOOLE_1:7;
L676: C201 c= ( R2 \/ { R5 } ) by L675 , L669 , XBOOLE_1:1;
L677: C201 is_maximal_independent_in ( R2 \/ { R5 } ) by L676 , L670 , L667 , L668 , L554;
L678: R2 c= ( R2 \/ { R5 , R6 } ) by XBOOLE_1:7;
L679: C201 c= ( R2 \/ { R5 , R6 } ) by L678 , L669 , XBOOLE_1:1;
consider C202 being  independent (Subset of R1) such that L680: C201 c= C202 and L681: C202 is_maximal_independent_in ( R2 \/ { R5 , R6 } ) by L679 , L399;
L682: C202 c= ( R2 \/ { R5 , R6 } ) by L681 , L554;
L683:
now
assume L684: C202 <> C201;
consider C203 being set such that L685: (not (C203 in C202 iff C203 in C201)) by L684 , TARSKI:1;
L686: { C203 } c= C202 by L680 , L685 , ZFMISC_1:31;
L687: ( C201 \/ { C203 } ) c= C202 by L686 , L680 , XBOOLE_1:8;
reconsider D77 = ( C201 \/ { C203 } ) as  independent (Subset of R1) by L687 , L47 , XBOOLE_1:1;
L688:
now
assume L689: C203 in R2;
L690: { C203 } c= R2 by L689 , ZFMISC_1:31;
L691: D77 c= R2 by L690 , L669 , XBOOLE_1:8;
L692: C201 c= D77 by XBOOLE_1:7;
L693: C201 = D77 by L692 , L671 , L691 , L397;
L694: { C203 } c= C201 by L693 , XBOOLE_1:7;
thus L695: contradiction by L694 , L680 , L685 , ZFMISC_1:31;
end;
L696: C203 in { R5 , R6 } by L688 , L680 , L682 , L685 , XBOOLE_0:def 3;
L697: (C203 = R5 or C203 = R6) by L696 , TARSKI:def 2;
L698: (({ C203 } c= ( R2 \/ { R5 } ) & C201 c= ( R2 \/ { R5 } )) or ({ C203 } c= ( R2 \/ { R6 } ) & C201 c= ( R2 \/ { R6 } ))) by L697 , L669 , XBOOLE_1:10;
L699: (D77 c= ( R2 \/ { R5 } ) or D77 c= ( R2 \/ { R6 } )) by L698 , XBOOLE_1:8;
L700: C201 c= D77 by XBOOLE_1:7;
L701: C201 = D77 by L700 , L677 , L674 , L699 , L397;
L702: { C203 } c= C201 by L701 , XBOOLE_1:7;
thus L703: contradiction by L702 , L680 , L685 , ZFMISC_1:31;
end;
thus L704: thesis by L683 , L670 , L681 , L554;
end;
begin
definition
let C204 being  finite-degree Matroid;
let C205 being (Element of C204);
let C206 being (Subset of C204);
pred C205 is_dependent_on C206
means
:L705: ( Rnk ( C206 \/ { C205 } ) ) = ( Rnk C206 )
;end;
theorem
L707: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R5 being (Element of R1) holds (R5 in R2 implies R5 is_dependent_on R2))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R5 being (Element of R1);
assume L708: R5 in R2;
L709: { R5 } c= R2 by L708 , ZFMISC_1:31;
thus L710: ( Rnk ( R2 \/ { R5 } ) ) = ( Rnk R2 ) by L709 , XBOOLE_1:12;
end;
theorem
L711: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R3 being (Subset of R1) holds (for R5 being (Element of R1) holds ((R2 c= R3 & R5 is_dependent_on R2) implies R5 is_dependent_on R3)))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R3 being (Subset of R1);
let R5 being (Element of R1);
assume that
L712: R2 c= R3
and
L713: ( Rnk ( R2 \/ { R5 } ) ) = ( Rnk R2 );
consider C207 being  independent (Subset of R1) such that L714: C207 c= R2 and L715: ( card C207 ) = ( Rnk R2 ) by L528;
L716: C207 c= R3 by L712 , L714 , XBOOLE_1:1;
L717: R3 c= ( R3 \/ { R5 } ) by XBOOLE_1:7;
L718: C207 c= ( R3 \/ { R5 } ) by L717 , L716 , XBOOLE_1:1;
consider C208 being  independent (Subset of R1) such that L719: C207 c= C208 and L720: C208 is_maximal_independent_in ( R3 \/ { R5 } ) by L718 , L399;
L721:
now
L722: C208 c= ( R3 \/ { R5 } ) by L720 , L554;
L723: C208 = ( C208 /\ ( R3 \/ { R5 } ) ) by L722 , XBOOLE_1:28
.= ( ( C208 /\ R3 ) \/ ( C208 /\ { R5 } ) ) by XBOOLE_1:23;
L724: ( C208 /\ { R5 } ) c= { R5 } by XBOOLE_1:17;
L725: ((( C208 /\ { R5 } ) = ( {} ) & ( card ( {} ) ) = ( 0 )) or (( C208 /\ { R5 } ) = { R5 } & ( card { R5 } ) = 1)) by L724 , CARD_1:30 , ZFMISC_1:33;
L726: ( card ( C208 /\ R3 ) ) <= ( Rnk R3 ) by L523 , XBOOLE_1:17;
L727: ( ( card ( C208 /\ R3 ) ) + 1 ) <= ( ( Rnk R3 ) + 1 ) by L726 , XREAL_1:6;
L728: C207 c= ( R2 \/ { R5 } ) by L714 , XBOOLE_1:10;
L729: C207 is_maximal_independent_in ( R2 \/ { R5 } ) by L728 , L713 , L715 , L554;
L730: C207 c= ( C207 \/ { R5 } ) by XBOOLE_1:10;
assume L731: ( Rnk ( R3 \/ { R5 } ) ) = ( ( Rnk R3 ) + 1 );
L732: ( card C208 ) = ( ( Rnk R3 ) + 1 ) by L731 , L720 , L554;
L733: ( ( Rnk R3 ) + 1 ) <= ( ( card ( C208 /\ R3 ) ) + ( card ( C208 /\ { R5 } ) ) ) by L732 , L723 , CARD_2:43;
L734: ( ( card ( C208 /\ R3 ) ) + 1 ) <= ( ( card ( C208 /\ R3 ) ) + ( card ( C208 /\ { R5 } ) ) ) by L733 , L727 , XXREAL_0:2;
L735: R5 in ( C208 /\ { R5 } ) by L734 , L725 , TARSKI:def 1 , XREAL_1:6;
L736: R5 in C208 by L735 , XBOOLE_0:def 4;
L737: { R5 } c= C208 by L736 , ZFMISC_1:31;
L738: ( C207 \/ { R5 } ) c= C208 by L737 , L719 , XBOOLE_1:8;
L739: ( C207 \/ { R5 } ) is  independent by L738 , L47;
L740: ( C207 \/ { R5 } ) c= ( R2 \/ { R5 } ) by L714 , XBOOLE_1:9;
L741: C207 = ( C207 \/ { R5 } ) by L740 , L730 , L739 , L729 , L397;
L742: { R5 } c= C207 by L741 , XBOOLE_1:7;
L743: R3 = ( R3 \/ { R5 } ) by L742 , L716 , XBOOLE_1:1 , XBOOLE_1:12;
thus L744: contradiction by L743 , L731;
end;
L745: ( Rnk ( R3 \/ { R5 } ) ) <= ( ( Rnk R3 ) + 1 ) by L657;
L746: ( Rnk R3 ) <= ( Rnk ( R3 \/ { R5 } ) ) by L657;
thus L747: ( Rnk ( R3 \/ { R5 } ) ) = ( Rnk R3 ) by L746 , L745 , L721 , NAT_1:9;
end;
definition
let C209 being  finite-degree Matroid;
let C210 being (Subset of C209);
func Span C210 -> (Subset of C209) equals 
{ B176 where B176 is (Element of C209) : B176 is_dependent_on C210 };
coherence
proof
set D78 = { B177 where B177 is (Element of C209) : B177 is_dependent_on C210 };
L748: D78 c= (the carrier of C209)
proof
let C211 being set;
assume L749: C211 in D78;
L750: (ex B178 being (Element of C209) st (C211 = B178 & B178 is_dependent_on C210)) by L749;
thus L751: thesis by L750;
end;
thus L752: thesis by L748;
end;
end;
theorem
L754: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R5 being (Element of R1) holds (R5 in ( Span R2 ) iff ( Rnk ( R2 \/ { R5 } ) ) = ( Rnk R2 )))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R5 being (Element of R1);
thus L755:now
assume L756: R5 in ( Span R2 );
L757: (ex B179 being (Element of R1) st (R5 = B179 & B179 is_dependent_on R2)) by L756;
thus L758: ( Rnk ( R2 \/ { R5 } ) ) = ( Rnk R2 ) by L757 , L705;
end;
assume L759: ( Rnk ( R2 \/ { R5 } ) ) = ( Rnk R2 );
L760: R5 is_dependent_on R2 by L759 , L705;
thus L761: thesis by L760;
end;
theorem
L762: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds R2 c= ( Span R2 )))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let C212 being set;
assume L763: C212 in R2;
reconsider D79 = C212 as (Element of R1) by L763;
L764: D79 is_dependent_on R2 by L763 , L707;
thus L765: thesis by L764;
end;
theorem
L766: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R3 being (Subset of R1) holds (R2 c= R3 implies ( Span R2 ) c= ( Span R3 )))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R3 being (Subset of R1);
assume L767: R2 c= R3;
let C213 being set;
assume L768: C213 in ( Span R2 );
L769: (ex R5 being (Element of R1) st (C213 = R5 & R5 is_dependent_on R2)) by L768;
L770: (ex R5 being (Element of R1) st (C213 = R5 & R5 is_dependent_on R3)) by L769 , L767 , L711;
thus L771: thesis by L770;
end;
theorem
L772: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds ( Rnk ( Span R2 ) ) = ( Rnk R2 )))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
consider C214 being  independent (Subset of R1) such that L773: C214 c= R2 and L774: ( card C214 ) = ( Rnk R2 ) by L528;
L775: R2 c= ( Span R2 ) by L762;
L776: C214 c= ( Span R2 ) by L775 , L773 , XBOOLE_1:1;
consider C215 being  independent (Subset of R1) such that L777: C214 c= C215 and L778: C215 is_maximal_independent_in ( Span R2 ) by L776 , L399;
L779:
now
assume L780: C215 c/= C214;
consider C216 being set such that L781: C216 in C215 and L782: C216 nin C214 by L780 , TARSKI:def 3;
L783: C215 c= ( Span R2 ) by L778 , L554;
L784: C216 in ( Span R2 ) by L783 , L781;
consider C217 being (Element of R1) such that L785: C216 = C217 and L786: C217 is_dependent_on R2 by L784;
L787: { C217 } c= C215 by L781 , L785 , ZFMISC_1:31;
L788: ( C214 \/ { C217 } ) c= C215 by L787 , L777 , XBOOLE_1:8;
reconsider D80 = ( C214 \/ { C217 } ) as  independent (Subset of R1) by L788 , L47;
L789: D80 c= ( R2 \/ { C217 } ) by L773 , XBOOLE_1:9;
consider C218 being  independent (Subset of R1) such that L790: D80 c= C218 and L791: C218 is_maximal_independent_in ( R2 \/ { C217 } ) by L789 , L399;
L792: ( card C214 ) = ( Rnk ( R2 \/ { C217 } ) ) by L774 , L786 , L705
.= ( card C218 ) by L791 , L554;
L793: ( card D80 ) <= ( card C214 ) by L792 , L790 , NAT_1:43;
L794: ( card C214 ) <= ( card D80 ) by NAT_1:43 , XBOOLE_1:7;
L795: ( card C214 ) = ( card D80 ) by L794 , L793 , XXREAL_0:1;
L796: C214 = D80 by L795 , CARD_FIN:1 , XBOOLE_1:7;
L797: C217 nin { C217 } by L796 , L782 , L785 , XBOOLE_0:def 3;
thus L798: contradiction by L797 , TARSKI:def 1;
end;
L799: C215 = C214 by L779 , L777 , XBOOLE_0:def 10;
thus L800: thesis by L799 , L774 , L778 , L554;
end;
theorem
L801: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R5 being (Element of R1) holds (R5 is_dependent_on ( Span R2 ) implies R5 is_dependent_on R2))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R5 being (Element of R1);
assume L802: ( Rnk ( ( Span R2 ) \/ { R5 } ) ) = ( Rnk ( Span R2 ) );
L803: ( Rnk R2 ) = ( Rnk ( Span R2 ) ) by L772;
consider C219 being  independent (Subset of R1) such that L804: C219 c= R2 and L805: ( card C219 ) = ( Rnk R2 ) by L528;
L806: ( Rnk R2 ) = ( Rnk C219 ) by L805 , L571;
L807: ( Rnk C219 ) <= ( Rnk ( R2 \/ { R5 } ) ) by L804 , L595 , XBOOLE_1:10;
L808: R2 c= ( Span R2 ) by L762;
L809: ( Rnk ( R2 \/ { R5 } ) ) <= ( Rnk R2 ) by L808 , L802 , L803 , L595 , XBOOLE_1:9;
thus L810: ( Rnk ( R2 \/ { R5 } ) ) = ( Rnk R2 ) by L809 , L806 , L807 , XXREAL_0:1;
end;
theorem
L811: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds ( Span ( Span R2 ) ) = ( Span R2 )))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
thus L812: ( Span ( Span R2 ) ) c= ( Span R2 )
proof
let C220 being set;
assume L813: C220 in ( Span ( Span R2 ) );
consider C221 being (Element of R1) such that L814: C220 = C221 and L815: C221 is_dependent_on ( Span R2 ) by L813;
L816: C221 is_dependent_on R2 by L815 , L801;
thus L817: thesis by L816 , L814;
end;

thus L818: thesis by L762;
end;
theorem
L819: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R5 being (Element of R1) holds (for R6 being (Element of R1) holds ((R6 nin ( Span R2 ) & R6 in ( Span ( R2 \/ { R5 } ) )) implies R5 in ( Span ( R2 \/ { R6 } ) ))))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R5 being (Element of R1);
let R6 being (Element of R1);
assume that
L820: R6 nin ( Span R2 )
and
L821: R6 in ( Span ( R2 \/ { R5 } ) );
L822: ( Rnk R2 ) <= ( Rnk ( R2 \/ { R6 } ) ) by L657;
L823: ( Rnk ( R2 \/ { R6 } ) ) <= ( ( Rnk R2 ) + 1 ) by L657;
L824: ( Rnk R2 ) <> ( Rnk ( R2 \/ { R6 } ) ) by L820 , L754;
L825: ( Rnk ( R2 \/ { R6 } ) ) = ( ( Rnk R2 ) + 1 ) by L824 , L822 , L823 , NAT_1:9;
L826: ( ( R2 \/ { R6 } ) \/ { R5 } ) = ( R2 \/ ( { R6 } \/ { R5 } ) ) by XBOOLE_1:4;
L827: ( Rnk ( R2 \/ { R5 } ) ) <= ( ( Rnk R2 ) + 1 ) by L657;
L828: ( ( R2 \/ { R5 } ) \/ { R6 } ) = ( R2 \/ ( { R5 } \/ { R6 } ) ) by XBOOLE_1:4;
L829: ( Rnk ( ( R2 \/ { R5 } ) \/ { R6 } ) ) = ( Rnk ( R2 \/ { R5 } ) ) by L821 , L754;
L830: ( Rnk ( R2 \/ { R6 } ) ) <= ( Rnk ( R2 \/ { R5 } ) ) by L829 , L826 , L828 , L657;
L831: ( Rnk ( R2 \/ { R6 } ) ) = ( Rnk ( ( R2 \/ { R6 } ) \/ { R5 } ) ) by L830 , L829 , L825 , L826 , L828 , L827 , XXREAL_0:1;
thus L832: thesis by L831 , L754;
end;
definition
let C222 being SubsetFamilyStr;
let C223 being (Subset of C222);
attr C223 is  cycle
means
:L833: (C223 is  dependent & (for B180 being (Element of C222) holds (B180 in C223 implies ( C223 \ { B180 } ) is  independent)));
end;
theorem
L835: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (R2 is  cycle implies R2 is non  empty  finite)))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
assume that
L836: R2 is  dependent
and
L837: (for B181 being (Element of R1) holds (B181 in R2 implies ( R2 \ { B181 } ) is  independent));
thus L838: R2 is non  empty by L836;
set D81 = the (Element of R2);
L839:
now
assume L840: R2 is non  empty non  empty non  empty non  empty set;
L841: D81 in R2 by L840;
reconsider D82 = D81 as (Element of R1) by L841;
reconsider D83 = ( R2 \ { D82 } ) as  independent (Subset of R1) by L837 , L840;
L842: R2 = ( D83 \/ { D82 } ) by L840 , ZFMISC_1:116;
thus L843: thesis by L842;
end;
thus L844: thesis by L839;
end;
registration
let R1 being  finite-degree Matroid;
cluster  cycle -> non  empty  finite for (Subset of R1);
coherence by L835;
end;
theorem
L846: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (R2 is  cycle iff (R2 is non  empty & (for R5 being (Element of R1) holds (R5 in R2 implies ( R2 \ { R5 } ) is_maximal_independent_in R2))))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
thus L847: (R2 is  cycle implies (R2 is non  empty & (for R5 being (Element of R1) holds (R5 in R2 implies ( R2 \ { R5 } ) is_maximal_independent_in R2))))
proof
assume that
L848: R2 is  dependent
and
L849: (for B182 being (Element of R1) holds (B182 in R2 implies ( R2 \ { B182 } ) is  independent));
thus L850: R2 is non  empty by L848;
let R5 being (Element of R1);
set D84 = ( R2 \ { R5 } );
assume L851: R5 in R2;
thus L852: (D84 is  independent & D84 c= R2) by L851 , L849 , XBOOLE_1:36;
let R3 being (Subset of R1);
assume that
L853: R3 is  independent
and
L854: R3 c= R2
and
L855: D84 c= R3;
L856: R2 = ( D84 \/ { R5 } ) by L851 , ZFMISC_1:116;
thus L857: thesis by L856 , L848 , L853 , L854 , L855 , ZFMISC_1:138;
end;

set D85 = the (Element of R2);
assume that
L858: R2 is non  empty
and
L859: (for R5 being (Element of R1) holds (R5 in R2 implies ( R2 \ { R5 } ) is_maximal_independent_in R2));
L860: D85 in R2 by L858;
reconsider D86 = D85 as (Element of R1) by L860;
set D87 = ( R2 \ { D86 } );
L861: D87 c= R2 by XBOOLE_1:36;
L862: D87 is_maximal_independent_in R2 by L858 , L859;
thus L863:now
assume L864: R2 is  independent;
L865: R2 = D87 by L864 , L862 , L861 , L397;
L866: D86 nin { D86 } by L865 , L858 , XBOOLE_0:def 5;
thus L867: contradiction by L866 , TARSKI:def 1;
end;
let R5 being (Element of R1);
assume L868: R5 in R2;
L869: ( R2 \ { R5 } ) is_maximal_independent_in R2 by L868 , L859;
thus L870: thesis by L869 , L397;
end;
theorem
L871: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (R2 is  cycle implies ( ( Rnk R2 ) + 1 ) = ( card R2 ))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
assume L872: R2 is  cycle;
reconsider D88 = R2 as non  empty  finite (Subset of R1) by L872;
set D89 = the (Element of D88);
L873: ( D88 \ { D89 } ) is_maximal_independent_in D88 by L872 , L846;
L874: ( D88 \ { D89 } ) is  independent by L873 , L397;
L875: ( Rnk D88 ) = ( card ( D88 \ { D89 } ) ) by L874 , L873 , L554;
L876: D89 in { D89 } by TARSKI:def 1;
L877: D89 nin ( D88 \ { D89 } ) by L876 , XBOOLE_0:def 5;
L878: D88 = ( ( D88 \ { D89 } ) \/ { D89 } ) by ZFMISC_1:116;
thus L879: thesis by L878 , L875 , L877 , CARD_2:41;
end;
theorem
L880: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R5 being (Element of R1) holds ((R2 is  cycle & R5 in R2) implies R5 is_dependent_on ( R2 \ { R5 } )))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R5 being (Element of R1);
assume that
L881: R2 is  cycle
and
L882: R5 in R2;
reconsider D90 = ( R2 \ { R5 } ) as  independent (Subset of R1) by L881 , L882 , L833;
L883: D90 is_maximal_independent_in R2 by L881 , L882 , L846;
L884: ( Rnk R2 ) = ( card D90 ) by L883 , L554;
thus L885: ( Rnk ( ( R2 \ { R5 } ) \/ { R5 } ) ) = ( card D90 ) by L884 , L882 , ZFMISC_1:116
.= ( Rnk ( R2 \ { R5 } ) ) by L571;
end;
theorem
L886: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R3 being (Subset of R1) holds ((R2 is  cycle & R3 is  cycle & R2 c= R3) implies R2 = R3))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R3 being (Subset of R1);
assume that
L887: R2 is  dependent
and
L888: (for R5 being (Element of R1) holds (R5 in R2 implies ( R2 \ { R5 } ) is  independent))
and
L889: R3 is  dependent
and
L890: (for R5 being (Element of R1) holds (R5 in R3 implies ( R3 \ { R5 } ) is  independent));
assume that
L891: R2 c= R3
and
L892: R2 <> R3;
consider C224 being set such that L893: (not (C224 in R2 iff C224 in R3)) by L892 , TARSKI:1;
reconsider D91 = C224 as (Element of R1) by L893;
L894: R2 c= ( R3 \ { D91 } ) by L891 , L893 , ZFMISC_1:34;
L895: ( R3 \ { D91 } ) is  independent by L890 , L891 , L893;
thus L896: contradiction by L895 , L887 , L894 , L47;
end;
theorem
L897: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds ((for R3 being (Subset of R1) holds (R3 c= R2 implies (not R3 is  cycle))) implies R2 is  independent)))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
assume L898: (for R3 being (Subset of R1) holds (R3 c= R2 implies (not R3 is  cycle)));
consider C225 being  independent (Subset of R1) such that L899: C225 c= R2 and L900: ( card C225 ) = ( Rnk R2 ) by L528;
per cases ;
suppose L901: R2 c= C225;

thus L902: thesis by L901 , L899 , XBOOLE_0:def 10;
end;
suppose L903: R2 c/= C225;

consider C226 being set such that L904: C226 in R2 and L905: C226 nin C225 by L903 , TARSKI:def 3;
reconsider D92 = C226 as (Element of R1) by L904;
L906: C225 c= ( C225 \/ { D92 } ) by ZFMISC_1:137;
defpred S7[ Nat ] means (ex B183 being  independent (Subset of R1) st (( card B183 ) = $1 & B183 c= C225 & ( B183 \/ { D92 } ) is  dependent));
L907: ( C225 \/ { D92 } ) c= R2 by L899 , L904 , ZFMISC_1:137;
L908: (ex B184 being Nat st S7[ B184 ])
proof
take D93 = ( Rnk R2 );
take C225;
thus L909: (( card C225 ) = D93 & C225 c= C225) by L900;
assume L910: ( C225 \/ { D92 } ) is  independent;
L911: C225 is_maximal_independent_in R2 by L899 , L900 , L554;
L912: C225 = ( C225 \/ { D92 } ) by L911 , L907 , L906 , L910 , L397;
L913: { D92 } c= C225 by L912 , XBOOLE_1:7;
thus L914: contradiction by L913 , L905 , ZFMISC_1:31;
end;
consider C227 being Nat such that L915: (S7[ C227 ] & (for B185 being Nat holds (S7[ B185 ] implies C227 <= B185))) from NAT_1:sch 5(L908);
consider C228 being  independent (Subset of R1) such that L916: ( card C228 ) = C227 and L917: C228 c= C225 and L918: ( C228 \/ { D92 } ) is  dependent by L915;
L919: D92 nin C228 by L905 , L917;
L920: ( C228 \/ { D92 } ) is  cycle
proof
thus L921: ( C228 \/ { D92 } ) is  dependent by L918;
let C229 being (Element of R1);
set D94 = ( C228 \ { C229 } );
L922: D94 c= C228 by XBOOLE_1:36;
assume L923: C229 in ( C228 \/ { D92 } );
per cases  by L923 , ZFMISC_1:136;
suppose L924: C229 in C228;

L925: C229 nin D94 by ZFMISC_1:56;
L926: C228 = ( D94 \/ { C229 } ) by L924 , ZFMISC_1:116;
L927: C227 = ( ( card D94 ) + 1 ) by L926 , L916 , L925 , CARD_2:41;
assume L928: ( ( C228 \/ { D92 } ) \ { C229 } ) is  dependent;
L929: ( ( C228 \/ { D92 } ) \ { C229 } ) = ( D94 \/ { D92 } ) by L919 , L924 , XBOOLE_1:87 , ZFMISC_1:11;
L930: C227 <= ( card D94 ) by L929 , L915 , L917 , L922 , L928 , XBOOLE_1:1;
thus L931: contradiction by L930 , L927 , NAT_1:13;
end;
suppose L932: C229 = D92;

thus L933: ( ( C228 \/ { D92 } ) \ { C229 } ) is  independent by L932 , L919 , ZFMISC_1:117;
end;
end;
L935: C228 c= R2 by L899 , L917 , XBOOLE_1:1;
L936: ( C228 \/ { D92 } ) c= R2 by L935 , L904 , ZFMISC_1:137;
thus L937: thesis by L936 , L898 , L920;
end;
end;
theorem
L939: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R3 being (Subset of R1) holds (for R5 being (Element of R1) holds ((R2 is  cycle & R3 is  cycle & R2 <> R3 & R5 in ( R2 /\ R3 )) implies (ex R4 being (Subset of R1) st (R4 is  cycle & R4 c= ( ( R2 \/ R3 ) \ { R5 } ))))))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R3 being (Subset of R1);
let R5 being (Element of R1);
assume that
L940: R2 is  cycle
and
L941: R3 is  cycle
and
L942: R2 <> R3
and
L943: R5 in ( R2 /\ R3 )
and
L944: (for R4 being (Subset of R1) holds (R4 is  cycle implies R4 c/= ( ( R2 \/ R3 ) \ { R5 } )));
L945: R5 in R2 by L943 , XBOOLE_0:def 4;
L946: ( R2 /\ R3 ) c= R3 by XBOOLE_1:17;
L947: R2 c/= ( R2 /\ R3 ) by L946 , L940 , L941 , L942 , L886 , XBOOLE_1:1;
consider C230 being set such that L948: C230 in R2 and L949: C230 nin ( R2 /\ R3 ) by L947 , TARSKI:def 3;
reconsider D95 = C230 as (Element of R1) by L948;
L950: { D95 } misses ( R2 /\ R3 ) by L949 , ZFMISC_1:50;
L951: ( R2 /\ R3 ) c= ( R2 \ { D95 } ) by L950 , XBOOLE_1:17 , XBOOLE_1:86;
reconsider D96 = R2 , D97 = R3 as  finite (Subset of R1) by L940 , L941;
L952: ( ( Rnk ( R2 \/ R3 ) ) + ( Rnk ( R2 /\ R3 ) ) ) <= ( ( Rnk R2 ) + ( Rnk R3 ) ) by L598;
L953: ( ( ( Rnk ( R2 \/ R3 ) ) + ( Rnk ( R2 /\ R3 ) ) ) + 1 ) <= ( ( ( Rnk R2 ) + ( Rnk R3 ) ) + 1 ) by L952 , XREAL_1:6;
L954: ( R2 \ { D95 } ) is  independent by L940 , L948 , L833;
L955: ( R2 /\ R3 ) is  independent by L954 , L951 , L47;
L956: ( card ( D96 /\ D97 ) ) = ( Rnk ( R2 /\ R3 ) ) by L955 , L571;
L957: (for R4 being (Subset of R1) holds (R4 c= ( ( R2 \/ R3 ) \ { R5 } ) implies (not R4 is  cycle))) by L944;
reconsider D98 = ( ( R2 \/ R3 ) \ { R5 } ) as  independent (Subset of R1) by L957 , L897;
L958: R5 in { R5 } by TARSKI:def 1;
L959: R5 nin D98 by L958 , XBOOLE_0:def 5;
L960: R5 in R3 by L943 , XBOOLE_0:def 4;
reconsider D99 = ( R2 \ { R5 } ) , D100 = ( R3 \ { R5 } ) as  independent (Subset of R1) by L960 , L940 , L941 , L945 , L833;
L961: R5 nin D100 by L958 , XBOOLE_0:def 5;
L962: R3 = ( D100 \/ { R5 } ) by L960 , ZFMISC_1:116;
L963: ( card D97 ) = ( ( card D100 ) + 1 ) by L962 , L961 , CARD_2:41;
L964: ( ( Rnk R3 ) + 1 ) = ( ( card D100 ) + 1 ) by L963 , L941 , L871;
L965: R5 nin D99 by L958 , XBOOLE_0:def 5;
L966: R2 = ( D99 \/ { R5 } ) by L945 , ZFMISC_1:116;
L967: ( card D96 ) = ( ( card D99 ) + 1 ) by L966 , L965 , CARD_2:41;
L968: ( ( Rnk R2 ) + 1 ) = ( ( card D99 ) + 1 ) by L967 , L940 , L871;
L969: ( ( card ( D96 \/ D97 ) ) + ( card ( D96 /\ D97 ) ) ) = ( ( ( Rnk R2 ) + 1 ) + ( ( Rnk R3 ) + 1 ) ) by L968 , L967 , L963 , L964 , HALLMAR1:1
.= ( ( ( ( Rnk R2 ) + ( Rnk R3 ) ) + 1 ) + 1 );
L970: ( ( ( ( Rnk ( R2 \/ R3 ) ) + ( Rnk ( R2 /\ R3 ) ) ) + 1 ) + 1 ) <= ( ( card ( D96 \/ D97 ) ) + ( card ( D96 /\ D97 ) ) ) by L969 , L953 , XREAL_1:6;
L971: R5 in ( R2 \/ R3 ) by L945 , XBOOLE_0:def 3;
L972: ( D98 \/ { R5 } ) = ( D96 \/ D97 ) by L971 , ZFMISC_1:116;
L973: D98 is_maximal_independent_in ( R2 \/ R3 )
proof
thus L974: (D98 is  independent & D98 c= ( R2 \/ R3 )) by XBOOLE_1:36;
let C231 being (Subset of R1);
L975: R2 c= ( R2 \/ R3 ) by XBOOLE_1:7;
L976: R2 is  dependent by L940 , L833;
L977: ( R2 \/ R3 ) is  dependent by L976 , L975 , L47;
thus L978: thesis by L977 , L972 , ZFMISC_1:138;
end;
L979: ( ( Rnk ( R2 \/ R3 ) ) + 1 ) = ( ( card D98 ) + 1 ) by L973 , L554
.= ( card ( D96 \/ D97 ) ) by L959 , L972 , CARD_2:41;
thus L980: contradiction by L979 , L970 , L956 , NAT_1:13;
end;
theorem
L981: (for R1 being  finite-degree Matroid holds (for R2 being (Subset of R1) holds (for R3 being (Subset of R1) holds (for R4 being (Subset of R1) holds (for R5 being (Element of R1) holds ((R2 is  independent & R3 is  cycle & R4 is  cycle & R3 c= ( R2 \/ { R5 } ) & R4 c= ( R2 \/ { R5 } )) implies R3 = R4))))))
proof
let R1 being  finite-degree Matroid;
let R2 being (Subset of R1);
let R3 being (Subset of R1);
let R4 being (Subset of R1);
let R5 being (Element of R1);
assume that
L982: R2 is  independent
and
L983: R3 is  cycle
and
L984: R4 is  cycle
and
L985: R3 c= ( R2 \/ { R5 } )
and
L986: R4 c= ( R2 \/ { R5 } );
L987:
now
assume L988: R4 c= R2;
L989: R4 is  independent by L988 , L982 , L47;
thus L990: contradiction by L989 , L984 , L833;
end;
consider C232 being set such that L991: C232 in R4 and L992: C232 nin R2 by L987 , TARSKI:def 3;
L993: C232 in { R5 } by L986 , L991 , L992 , XBOOLE_0:def 3;
L994: C232 = R5 by L993 , TARSKI:def 1;
L995:
now
assume L996: R3 c= R2;
L997: R3 is  independent by L996 , L982 , L47;
thus L998: contradiction by L997 , L983 , L833;
end;
consider C233 being set such that L999: C233 in R3 and L1000: C233 nin R2 by L995 , TARSKI:def 3;
assume L1001: R3 <> R4;
L1002: C233 in { R5 } by L985 , L999 , L1000 , XBOOLE_0:def 3;
L1003: C233 = R5 by L1002 , TARSKI:def 1;
L1004: R5 in ( R3 /\ R4 ) by L1003 , L999 , L991 , L994 , XBOOLE_0:def 4;
consider C234 being (Subset of R1) such that L1005: C234 is  cycle and L1006: C234 c= ( ( R3 \/ R4 ) \ { R5 } ) by L1004 , L983 , L984 , L1001 , L939;
L1007: C234 c= R2
proof
let C235 being set;
assume L1008: C235 in C234;
L1009: C235 in ( R3 \/ R4 ) by L1008 , L1006 , XBOOLE_0:def 5;
L1010: (C235 in R3 or C235 in R4) by L1009 , XBOOLE_0:def 3;
L1011: C235 nin { R5 } by L1006 , L1008 , XBOOLE_0:def 5;
thus L1012: thesis by L1011 , L985 , L986 , L1010 , XBOOLE_0:def 3;
end;
L1013: C234 is  independent by L1007 , L982 , L47;
thus L1014: thesis by L1013 , L1005 , L833;
end;
