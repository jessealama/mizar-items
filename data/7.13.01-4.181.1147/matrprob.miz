:: The Definition of Finite Sequences and Matrices of Probability, and
:: Addition of Matrices of Real Elements
::  by Bo Zhang and Yatsuka Nakamura
::
:: Received August 18, 2006
:: Copyright (c) 2006-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, XBOOLE_0, SUBSET_1, NAT_1, REAL_1, FINSEQ_1, RELAT_1,
      FUNCT_1, TARSKI, XREAL_0, ORDINAL1, FINSEQ_2, CARD_1, XXREAL_0, SEQ_1,
      ARYTM_3, CARD_3, FUNCOP_1, MATRIX_1, TREES_1, ZFMISC_1, INCSP_1,
      MATRIXC1, QC_LANG1, ORDINAL4, PRE_POLY, BINOP_2, FINSEQ_3, RVSUM_1,
      STRUCT_0, VECTSP_1, SUPINF_2, FVSUM_1, MATRIXR1, MATRPROB;
 notations TARSKI, SUBSET_1, XBOOLE_0, XXREAL_0, XREAL_0, REAL_1, ORDINAL1,
      NUMBERS, RELAT_1, FUNCT_1, SEQ_1, ZFMISC_1, FUNCOP_1, BINOP_1, BINOP_2,
      FUNCT_2, RVSUM_1, FINSEQ_1, FINSEQ_2, FINSEQOP, NEWTON, STRUCT_0,
      MATRLIN, MATRIXR1, MATRIX_3, MATRIX_1, GROUP_1, FVSUM_1, RLVECT_1,
      VECTSP_1;
 constructors REAL_1, BINOP_2, NEWTON, FVSUM_1, MATRIX_3, MATRLIN, MATRIXR1,
      SEQ_1, BINOP_1, RVSUM_1, RELSET_1, FINSEQ_2;
 registrations XBOOLE_0, ORDINAL1, RELSET_1, NUMBERS, XXREAL_0, NAT_1,
      MEMBERED, FINSEQ_1, FINSEQ_2, STRUCT_0, VECTSP_1, MATRIX_1, MATRLIN,
      VALUED_0, CARD_1, RVSUM_1;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, FINSEQ_2, RVSUM_1;
 theorems FUNCT_1, SEQ_1, NAT_1, TARSKI, ZFMISC_1, MATRIX_3, MATRIX_2, XREAL_1,
      GOBOARD1, BINOP_2, FVSUM_1, VECTSP_1, RLVECT_1, MATRLIN, XBOOLE_0,
      FINSEQ_1, PROB_3, MATRIX_1, FINSEQ_2, FUNCOP_1, RFINSEQ, FINSEQ_3,
      RVSUM_1, MATRIXR1, ORDINAL1, XREAL_0, MATRIXC1, XXREAL_0, STRUCT_0,
      PRE_POLY, CARD_1;
 schemes CLASSES1, FINSEQ_2, PARTFUN1, NAT_1, MATRIX_1;

begin
definition
let C1 being set;
let C2 being (FinSequence of ( C1 * ));
let C3 being Nat;
redefine func C2 . C3 -> (FinSequence of C1);

correctness
proof
per cases ;
suppose L1: C3 in ( dom C2 );

L2: ( rng C2 ) c= ( C1 * ) by FINSEQ_1:def 4;
L3: ( C2 . C3 ) in ( rng C2 ) by L1 , FUNCT_1:3;
L4: ( C2 . C3 ) is (Element of ( C1 * )) by L3 , L2;
thus L5: thesis by L4;
end;
suppose L6: (not C3 in ( dom C2 ));

L7: ( C2 . C3 ) = ( <*> C1 ) by L6 , FUNCT_1:def 2;
thus L8: thesis by L7;
end;
end;
end;
definition
let C4 being  real number;
redefine func <*C4 *> -> (FinSequence of ( REAL ));

coherence
proof
L11: ( rng <* C4 *> ) c= ( REAL );
thus L12: thesis by L11 , FINSEQ_1:def 4;
end;
end;
theorem
L14: (for R1 being non  empty set holds (for B1 being (Element of R1) holds (for B2 being non  empty Nat holds (for B3 being (FinSequence of R1) holds ((( len B3 ) = B2 & (for B4 being Nat holds (B4 in ( dom B3 ) implies ( B3 . B4 ) = B1))) iff B3 = ( B2 |-> B1 ))))))
proof
let R1 being non  empty set;
let C5 being (Element of R1);
let C6 being non  empty Nat;
let C7 being (FinSequence of R1);
thus L15:now
assume that
L16: ( len C7 ) = C6
and
L17: (for B5 being Nat holds (B5 in ( dom C7 ) implies ( C7 . B5 ) = C5));
L18: (( dom C7 ) = ( dom ( C6 |-> C5 ) ) & (for B6 being Nat holds (B6 in ( dom C7 ) implies ( C7 . B6 ) = ( ( C6 |-> C5 ) . B6 ))))
proof
thus L19: ( dom C7 ) = ( Seg C6 ) by L16 , FINSEQ_1:def 3
.= ( dom ( C6 |-> C5 ) ) by FUNCOP_1:13;
let C8 being Nat;
assume that
L20: C8 in ( dom C7 );
L21: C8 in ( Seg C6 ) by L16 , L20 , FINSEQ_1:def 3;
thus L22: ( C7 . C8 ) = C5 by L17 , L20
.= ( ( C6 |-> C5 ) . C8 ) by L21 , FINSEQ_2:57;
end;
thus L23: C7 = ( C6 |-> C5 ) by L18 , FINSEQ_1:13;
end;
assume L24: C7 = ( C6 |-> C5 );
L25: ( dom C7 ) = ( Seg C6 ) by L24 , FUNCOP_1:13;
thus L26: thesis by L25 , L24 , CARD_1:def 7 , FINSEQ_2:57;
end;
theorem
L27: (for R1 being non  empty set holds (for R4 being (Element of ( NAT )) holds (for R5 being Nat holds (for B7 , B8 being (Element of R1) holds (ex B9 being (FinSequence of R1) st (( len B9 ) = R5 & (for B10 being Nat holds (B10 in ( Seg R5 ) implies ((B10 in ( Seg R4 ) implies ( B9 . B10 ) = B7) & ((not B10 in ( Seg R4 )) implies ( B9 . B10 ) = B8))))))))))
proof
let R1 being non  empty set;
let R4 being (Element of ( NAT ));
let R5 being Nat;
let C9 , C10 being (Element of R1);
defpred S1[ set ] means $1 in ( Seg R4 );
deffunc H1(set) = C9;
deffunc H2(set) = C10;
L28: (ex B11 being Function st (( dom B11 ) = ( Seg R5 ) & (for B12 being set holds (B12 in ( Seg R5 ) implies ((S1[ B12 ] implies ( B11 . B12 ) = H1(B12)) & ((not S1[ B12 ]) implies ( B11 . B12 ) = H2(B12))))))) from PARTFUN1:sch 1;
consider C11 being Function such that L29: ( dom C11 ) = ( Seg R5 ) and L30: (for B13 being set holds (B13 in ( Seg R5 ) implies ((B13 in ( Seg R4 ) implies ( C11 . B13 ) = C9) & ((not B13 in ( Seg R4 )) implies ( C11 . B13 ) = C10)))) by L28;
reconsider D1 = C11 as FinSequence by L29 , FINSEQ_1:def 2;
L31: ( rng D1 ) c= R1
proof
let C12 being set;
assume L32: C12 in ( rng D1 );
consider C13 being set such that L33: C13 in ( dom D1 ) and L34: C12 = ( D1 . C13 ) by L32 , FUNCT_1:def 3;
L35: ((not C13 in ( Seg R4 )) implies ( D1 . C13 ) = C10) by L29 , L30 , L33;
L36: (C13 in ( Seg R4 ) implies ( D1 . C13 ) = C9) by L29 , L30 , L33;
thus L37: thesis by L36 , L34 , L35;
end;
reconsider D2 = D1 as (FinSequence of R1) by L31 , FINSEQ_1:def 4;
take D2;
L38: R5 in ( NAT ) by ORDINAL1:def 12;
thus L39: thesis by L38 , L29 , L30 , FINSEQ_1:def 3;
end;
theorem
L40: (for R8 being (FinSequence of ( REAL )) holds ((for B14 being Nat holds (B14 in ( dom R8 ) implies ( 0 ) <= ( R8 . B14 ))) implies (for B15 being Real_Sequence holds ((for B16 being Nat holds ((( 0 ) <> B16 & B16 < ( len R8 )) implies ( B15 . ( B16 + 1 ) ) = ( ( B15 . B16 ) + ( R8 . ( B16 + 1 ) ) ))) implies (for B17 , B18 being Nat holds ((B17 in ( dom R8 ) & B18 in ( dom R8 ) & B17 <= B18) implies ( B15 . B17 ) <= ( B15 . B18 )))))))
proof
let R8 being (FinSequence of ( REAL ));
assume L41: (for B19 being Nat holds (B19 in ( dom R8 ) implies ( 0 ) <= ( R8 . B19 )));
let C14 being Real_Sequence;
assume that
L42: (for B20 being Nat holds ((( 0 ) <> B20 & B20 < ( len R8 )) implies ( C14 . ( B20 + 1 ) ) = ( ( C14 . B20 ) + ( R8 . ( B20 + 1 ) ) )));
L43: (for R5 being Nat holds ((R5 <> ( 0 ) & R5 < ( len R8 )) implies ( C14 . R5 ) <= ( C14 . ( R5 + 1 ) )))
proof
let R5 being Nat;
assume that
L44: R5 <> ( 0 )
and
L45: R5 < ( len R8 );
L46: (( R5 + 1 ) >= 1 & ( R5 + 1 ) <= ( len R8 )) by L45 , NAT_1:13 , NAT_1:14;
L47: ( R5 + 1 ) in ( dom R8 ) by L46 , FINSEQ_3:25;
L48: ( ( C14 . R5 ) + ( R8 . ( R5 + 1 ) ) ) >= ( C14 . R5 ) by L47 , L41 , XREAL_1:31;
thus L49: thesis by L48 , L42 , L44 , L45;
end;
L50: (for B21 being Nat holds (B21 in ( dom R8 ) implies (for R6 being Nat holds ((R6 in ( dom R8 ) & B21 <= R6) implies ( C14 . B21 ) <= ( C14 . R6 )))))
proof
let C15 being Nat;
assume L51: C15 in ( dom R8 );
L52: C15 >= 1 by L51 , FINSEQ_3:25;
defpred S2[ Nat ] means (($1 in ( dom R8 ) & C15 <= $1) implies ( C14 . $1 ) >= ( C14 . C15 ));
L53:
now
let R4 being (Element of ( NAT ));
assume that
L54: S2[ R4 ];
L55:
now
assume that
L56: ( R4 + 1 ) in ( dom R8 )
and
L57: C15 <= ( R4 + 1 );
L58: ( R4 + 1 ) <= ( len R8 ) by L56 , FINSEQ_3:25;
per cases  by L57 , L58 , NAT_1:8 , NAT_1:13;
suppose L59: (( R4 + 1 ) = C15 & R4 < ( len R8 ));

thus L60: ( C14 . ( R4 + 1 ) ) >= ( C14 . C15 ) by L59;
end;
suppose L61: (R4 >= C15 & R4 < ( len R8 ));

L62: (R4 >= 1 & ( C14 . ( R4 + 1 ) ) >= ( C14 . R4 )) by L61 , L43 , L52 , NAT_1:14;
thus L63: ( C14 . ( R4 + 1 ) ) >= ( C14 . C15 ) by L62 , L54 , L61 , FINSEQ_3:25 , XXREAL_0:2;
end;
end;
thus L65: S2[ ( R4 + 1 ) ] by L55;
end;
L66: S2[ ( 0 ) ];
L67: (for B22 being (Element of ( NAT )) holds S2[ B22 ]) from NAT_1:sch 1(L66 , L53);
thus L68: thesis by L67;
end;
thus L69: thesis by L50;
end;
theorem
L70: (for R8 being (FinSequence of ( REAL )) holds ((( len R8 ) >= 1 & (for B23 being Nat holds (B23 in ( dom R8 ) implies ( 0 ) <= ( R8 . B23 )))) implies (for B24 being Real_Sequence holds ((( B24 . 1 ) = ( R8 . 1 ) & (for B25 being Nat holds ((( 0 ) <> B25 & B25 < ( len R8 )) implies ( B24 . ( B25 + 1 ) ) = ( ( B24 . B25 ) + ( R8 . ( B25 + 1 ) ) )))) implies (for B26 being Nat holds (B26 in ( dom R8 ) implies ( R8 . B26 ) <= ( B24 . B26 )))))))
proof
let R8 being (FinSequence of ( REAL ));
assume that
L71: ( len R8 ) >= 1
and
L72: (for B27 being Nat holds (B27 in ( dom R8 ) implies ( 0 ) <= ( R8 . B27 )));
let C16 being Real_Sequence;
assume that
L73: ( C16 . 1 ) = ( R8 . 1 )
and
L74: (for B28 being Nat holds ((( 0 ) <> B28 & B28 < ( len R8 )) implies ( C16 . ( B28 + 1 ) ) = ( ( C16 . B28 ) + ( R8 . ( B28 + 1 ) ) )));
defpred S3[ Nat ] means ($1 in ( dom R8 ) implies ( R8 . $1 ) <= ( C16 . $1 ));
L75:
now
let C17 being Nat;
assume that
L76: S3[ C17 ];
L77:
now
assume L78: ( C17 + 1 ) in ( dom R8 );
L79: ( C17 + 1 ) <= ( len R8 ) by L78 , FINSEQ_3:25;
per cases  by L79 , NAT_1:13;
suppose L80: (C17 = ( 0 ) & C17 < ( len R8 ));

thus L81: ( R8 . ( C17 + 1 ) ) <= ( C16 . ( C17 + 1 ) ) by L80 , L73;
end;
suppose L82: (C17 > ( 0 ) & C17 < ( len R8 ));

L83: 1 <= ( len R8 ) by L82 , NAT_1:14;
L84: 1 in ( dom R8 ) by L83 , FINSEQ_3:25;
L85: 1 in ( dom R8 ) by L71 , FINSEQ_3:25;
L86: C17 >= 1 by L82 , NAT_1:14;
L87: C17 in ( dom R8 ) by L86 , L82 , FINSEQ_3:25;
L88: ( R8 . 1 ) <= ( C16 . C17 ) by L87 , L72 , L73 , L74 , L86 , L84 , L40;
L89: ( C16 . C17 ) >= ( 0 ) by L88 , L72 , L85;
L90: ( ( C16 . C17 ) + ( R8 . ( C17 + 1 ) ) ) >= ( R8 . ( C17 + 1 ) ) by L89 , XREAL_1:31;
thus L91: ( R8 . ( C17 + 1 ) ) <= ( C16 . ( C17 + 1 ) ) by L90 , L74 , L82;
end;
end;
thus L93: S3[ ( C17 + 1 ) ] by L77;
end;
L94: S3[ ( 0 ) ] by FINSEQ_3:25;
L95: (for R5 being Nat holds S3[ R5 ]) from NAT_1:sch 2(L94 , L75);
thus L96: thesis by L95;
end;
theorem
L97: (for R8 being (FinSequence of ( REAL )) holds ((for B29 being Nat holds (B29 in ( dom R8 ) implies ( 0 ) <= ( R8 . B29 ))) implies (for B30 being Nat holds (B30 in ( dom R8 ) implies ( R8 . B30 ) <= ( Sum R8 )))))
proof
let R8 being (FinSequence of ( REAL ));
assume L98: (for B31 being Nat holds (B31 in ( dom R8 ) implies ( 0 ) <= ( R8 . B31 )));
per cases ;
suppose L99: ( len R8 ) = ( 0 );

L100: R8 = ( {} ) by L99;
thus L101: thesis by L100;
end;
suppose L102: ( len R8 ) <> ( 0 );

L103: ( len R8 ) >= 1 by L102 , NAT_1:14;
L104: ( len R8 ) in ( dom R8 ) by L103 , FINSEQ_3:25;
let C18 being Nat;
assume L105: C18 in ( dom R8 );
reconsider D3 = C18 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C19 being Real_Sequence such that L106: ( C19 . 1 ) = ( R8 . 1 ) and L107: (for B32 being Nat holds ((( 0 ) <> B32 & B32 < ( len R8 )) implies ( C19 . ( B32 + 1 ) ) = ( ( C19 . B32 ) + ( R8 . ( B32 + 1 ) ) ))) and L108: ( Sum R8 ) = ( C19 . ( len R8 ) ) by L102 , NAT_1:14 , PROB_3:63;
L109: ( R8 . D3 ) <= ( C19 . D3 ) by L98 , L102 , L106 , L107 , L105 , L70 , NAT_1:14;
L110: D3 <= ( len R8 ) by L105 , FINSEQ_3:25;
L111: ( C19 . D3 ) <= ( C19 . ( len R8 ) ) by L110 , L98 , L107 , L105 , L104 , L40;
thus L112: thesis by L111 , L108 , L109 , XXREAL_0:2;
end;
end;
theorem
L114: (for B33 , B34 being Real holds (for B35 being Nat holds (for B36 being Real_Sequence holds (ex B37 being Real_Sequence st (( B37 . ( 0 ) ) = B33 & (for R5 being Nat holds (((R5 <> ( 0 ) & R5 <= B35) implies ( B37 . R5 ) = ( B36 . R5 )) & (R5 > B35 implies ( B37 . R5 ) = B34))))))))
proof
let C20 , C21 being Real;
let C22 being Nat;
let C23 being Real_Sequence;
L115: (ex B38 being Real_Sequence st (for R5 being Nat holds ((R5 = ( 0 ) implies ( B38 . R5 ) = C20) & ((R5 <> ( 0 ) & R5 <= C22) implies ( B38 . R5 ) = ( C23 . R5 )) & ((R5 <> ( 0 ) & R5 > C22) implies ( B38 . R5 ) = C21))))
proof
defpred S4[ set , set ] means (ex B39 being (Element of ( NAT )) st (B39 = $1 & (B39 = ( 0 ) implies $2 = C20) & ((B39 <> ( 0 ) & B39 <= C22) implies $2 = ( C23 . B39 )) & ((B39 <> ( 0 ) & B39 > C22) implies $2 = C21)));
L116: (for B40 being set holds (B40 in ( NAT ) implies (ex B41 being set st S4[ B40 , B41 ])))
proof
let C24 being set;
assume L117: C24 in ( NAT );
reconsider D4 = C24 as (Element of ( NAT )) by L117;
L118:
now
per cases ;
case L119: D4 = ( 0 );
thus L120: S4[ C24 , C20 ] by L119;
end;
case L121: (D4 <> ( 0 ) & D4 <= C22);
thus L122: S4[ C24 , ( C23 . D4 ) ] by L121;
end;
case L123: (D4 <> ( 0 ) & (not D4 <= C22));
thus L124: S4[ C24 , C21 ] by L123;
end;
end;
thus L126: thesis by L118;
end;
consider C25 being Function such that L127: (( dom C25 ) = ( NAT ) & (for B42 being set holds (B42 in ( NAT ) implies S4[ B42 , ( C25 . B42 ) ]))) from CLASSES1:sch 1(L116);
L128:
now
let C26 being set;
assume L129: C26 in ( NAT );
L130: (ex B43 being (Element of ( NAT )) st (B43 = C26 & (B43 = ( 0 ) implies ( C25 . C26 ) = C20) & ((B43 <> ( 0 ) & B43 <= C22) implies ( C25 . C26 ) = ( C23 . B43 )) & ((B43 <> ( 0 ) & B43 > C22) implies ( C25 . C26 ) = C21))) by L129 , L127;
thus L131: ( C25 . C26 ) is  real by L130;
end;
reconsider D5 = C25 as Real_Sequence by L128 , L127 , SEQ_1:1;
take D6 = D5;
let C27 being Nat;
reconsider D7 = C27 as (Element of ( NAT )) by ORDINAL1:def 12;
L132: (ex B44 being (Element of ( NAT )) st (B44 = D7 & (B44 = ( 0 ) implies ( D6 . D7 ) = C20) & ((B44 <> ( 0 ) & B44 <= C22) implies ( D6 . D7 ) = ( C23 . B44 )) & ((B44 <> ( 0 ) & B44 > C22) implies ( D6 . D7 ) = C21))) by L127;
thus L133: thesis by L132;
end;
consider C28 being Real_Sequence such that L134: (for R5 being Nat holds ((R5 = ( 0 ) implies ( C28 . R5 ) = C20) & ((R5 <> ( 0 ) & R5 <= C22) implies ( C28 . R5 ) = ( C23 . R5 )) & ((R5 <> ( 0 ) & R5 > C22) implies ( C28 . R5 ) = C21))) by L115;
take C28;
thus L135: thesis by L134;
end;
theorem
L136: (for B45 being (FinSequence of ( REAL )) holds (ex B46 being Real_Sequence st (( B46 . ( 0 ) ) = ( 0 ) & (for B47 being Nat holds (B47 < ( len B45 ) implies ( B46 . ( B47 + 1 ) ) = ( ( B46 . B47 ) + ( B45 . ( B47 + 1 ) ) ))) & ( Sum B45 ) = ( B46 . ( len B45 ) ))))
proof
let C29 being (FinSequence of ( REAL ));
per cases ;
suppose L137: ( len C29 ) = ( 0 );

set D8 = ( ( NAT ) --> (( 0 ) qua Real) );
L138: (for B48 being Nat holds (B48 < ( len C29 ) implies ( D8 . ( B48 + 1 ) ) = ( ( D8 . B48 ) + ( C29 . ( B48 + 1 ) ) ))) by L137;
L139: (for B49 being Nat holds ( D8 . B49 ) = ( 0 ))
proof
let C30 being Nat;
L140: C30 in ( NAT ) by ORDINAL1:def 12;
thus L141: thesis by L140 , FUNCOP_1:7;
end;
L142: ( D8 . ( 0 ) ) = ( 0 ) by L139;
L143: ( Sum C29 ) = ( 0 ) by L137 , PROB_3:62
.= ( D8 . ( len C29 ) ) by L139;
thus L144: thesis by L143 , L138 , L142;
end;
suppose L145: ( len C29 ) > ( 0 );

consider C31 being Real_Sequence such that L146: ( C31 . 1 ) = ( C29 . 1 ) and L147: (for B50 being Nat holds ((( 0 ) <> B50 & B50 < ( len C29 )) implies ( C31 . ( B50 + 1 ) ) = ( ( C31 . B50 ) + ( C29 . ( B50 + 1 ) ) ))) and L148: ( Sum C29 ) = ( C31 . ( len C29 ) ) by L145 , NAT_1:14 , PROB_3:63;
consider C32 being Real_Sequence such that L149: (for R5 being Nat holds (( C32 . ( 0 ) ) = ( 0 ) & ((R5 <> ( 0 ) & R5 <= ( len C29 )) implies ( C32 . R5 ) = ( C31 . R5 )) & (R5 > ( len C29 ) implies ( C32 . R5 ) = ( 0 )))) by L114;
L150: ( len C29 ) >= 1 by L145 , NAT_1:14;
L151: (for B51 being Nat holds (B51 < ( len C29 ) implies ( C32 . ( B51 + 1 ) ) = ( ( C32 . B51 ) + ( C29 . ( B51 + 1 ) ) )))
proof
let C33 being Nat;
assume that
L152: C33 < ( len C29 );
set D9 = ( C29 . ( C33 + 1 ) );
per cases ;
suppose L153: C33 = ( 0 );

thus L154: thesis by L153 , L150 , L146 , L149;
end;
suppose L155: C33 <> ( 0 );

L156: ( C33 + 1 ) <= ( len C29 ) by L152 , NAT_1:13;
thus L157: ( C32 . ( C33 + 1 ) ) = ( C31 . ( C33 + 1 ) ) by L156 , L149
.= ( ( C31 . C33 ) + ( C29 . ( C33 + 1 ) ) ) by L147 , L152 , L155
.= ( ( C32 . C33 ) + D9 ) by L149 , L152 , L155;
end;
end;
L159: ( Sum C29 ) = ( C32 . ( len C29 ) ) by L145 , L148 , L149;
thus L160: thesis by L159 , L149 , L151;
end;
end;
theorem
L162: (for R5 being Nat holds (for B52 being set holds (for B53 being (FinSequence of B52) holds ( R5 |-> B53 ) is (FinSequence of ( B52 * )))))
proof
let R5 being Nat;
let C34 being set;
let C35 being (FinSequence of C34);
L163: C35 in ( C34 * ) by FINSEQ_1:def 11;
thus L164: thesis by L163 , FINSEQ_2:63;
end;
theorem
L165: (for R4 being (Element of ( NAT )) holds (for R5 being Nat holds (for B54 being set holds (for B55 , B56 being (FinSequence of B54) holds (ex B57 being (FinSequence of ( B54 * )) st (( len B57 ) = R5 & (for B58 being Nat holds (B58 in ( Seg R5 ) implies ((B58 in ( Seg R4 ) implies ( B57 . B58 ) = B55) & ((not B58 in ( Seg R4 )) implies ( B57 . B58 ) = B56))))))))))
proof
let R4 being (Element of ( NAT ));
let R5 being Nat;
let C36 being set;
let C37 , C38 being (FinSequence of C36);
L166: (C37 in ( C36 * ) & C38 in ( C36 * )) by FINSEQ_1:def 11;
thus L167: thesis by L166 , L27;
end;
theorem
L168: (for B59 being set holds (for B60 being FinSequence holds (B60 is (Matrix of B59) iff (ex R5 being Nat st (for R2 being (Element of ( NAT )) holds (R2 in ( dom B60 ) implies (ex B61 being (FinSequence of B59) st (( B60 . R2 ) = B61 & ( len B61 ) = R5))))))))
proof
let C39 being set;
let C40 being FinSequence;
thus L169: (C40 is (Matrix of C39) implies (ex R5 being Nat st (for R2 being (Element of ( NAT )) holds (R2 in ( dom C40 ) implies (ex B62 being (FinSequence of C39) st (( C40 . R2 ) = B62 & ( len B62 ) = R5))))))
proof
assume L170: C40 is (Matrix of C39);
reconsider D10 = C40 as (FinSequence of ( C39 * )) by L170;
consider C41 being Nat such that L171: (for B63 being set holds (B63 in ( rng D10 ) implies (ex B64 being FinSequence st (B64 = B63 & ( len B64 ) = C41)))) by L170 , MATRIX_1:def 1;
L172: (for R2 being (Element of ( NAT )) holds (R2 in ( dom D10 ) implies (ex B65 being (FinSequence of C39) st (( D10 . R2 ) = B65 & ( len B65 ) = C41))))
proof
let R2 being (Element of ( NAT ));
assume L173: R2 in ( dom D10 );
consider C42 being FinSequence such that L174: (C42 = ( D10 . R2 ) & ( len C42 ) = C41) by L173 , L171 , FUNCT_1:3;
take C42;
thus L175: thesis by L174;
end;
reconsider D11 = C41 as (Element of ( NAT )) by ORDINAL1:def 12;
take D11;
thus L176: thesis by L172;
end;

given R5 being Nat such that
L177: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C40 ) implies (ex B66 being (FinSequence of C39) st (( C40 . R2 ) = B66 & ( len B66 ) = R5))));

L178: (for B67 being set holds (B67 in ( rng C40 ) implies ((ex B68 being FinSequence st (B68 = B67 & ( len B68 ) = R5)) & B67 in ( C39 * ))))
proof
let C43 being set;
assume L179: C43 in ( rng C40 );
consider C44 being set such that L180: C44 in ( dom C40 ) and L181: C43 = ( C40 . C44 ) by L179 , FUNCT_1:def 3;
L182: (ex B69 being (FinSequence of C39) st (( C40 . C44 ) = B69 & ( len B69 ) = R5)) by L177 , L180;
thus L183: (ex B70 being FinSequence st (B70 = C43 & ( len B70 ) = R5)) by L182 , L181;
thus L184: thesis by L181 , L182 , FINSEQ_1:def 11;
end;
L185: (for B71 being set holds (B71 in ( rng C40 ) implies B71 in ( C39 * ))) by L178;
L186: ( rng C40 ) c= ( C39 * ) by L185 , TARSKI:def 3;
L187: (for B72 being set holds (B72 in ( rng C40 ) implies (ex B73 being FinSequence st (B73 = B72 & ( len B73 ) = R5)))) by L178;
thus L188: thesis by L187 , L186 , FINSEQ_1:def 4 , MATRIX_1:def 1;
end;
theorem
L189: (for B74 being set holds (for B75 being (FinSequence of ( B74 * )) holds ((ex R5 being Nat st (for R2 being (Element of ( NAT )) holds (R2 in ( dom B75 ) implies ( len ( B75 . R2 ) ) = R5))) iff B75 is (Matrix of B74))))
proof
let C45 being set;
let C46 being (FinSequence of ( C45 * ));
thus L190:now
given R5 being Nat such that
L191: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C46 ) implies ( len ( C46 . R2 ) ) = R5));

L192: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C46 ) implies (ex B76 being (FinSequence of C45) st (( C46 . R2 ) = B76 & ( len B76 ) = R5))))
proof
let R2 being (Element of ( NAT ));
assume L193: R2 in ( dom C46 );
L194: ( len ( C46 . R2 ) ) = R5 by L193 , L191;
thus L195: thesis by L194;
end;
thus L196: C46 is (Matrix of C45) by L192 , L168;
end;
assume L197: C46 is (Matrix of C45);
consider R5 being Nat such that L198: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C46 ) implies (ex B77 being (FinSequence of C45) st (( C46 . R2 ) = B77 & ( len B77 ) = R5)))) by L197 , L168;
L199: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C46 ) implies ( len ( C46 . R2 ) ) = R5))
proof
let R2 being (Element of ( NAT ));
assume L200: R2 in ( dom C46 );
L201: (ex B78 being (FinSequence of C45) st (( C46 . R2 ) = B78 & ( len B78 ) = R5)) by L200 , L198;
thus L202: thesis by L201;
end;
thus L203: thesis by L199;
end;
theorem
L204: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (for B79 being  tabular FinSequence holds ([ R2 , R3 ] in ( Indices B79 ) iff (R2 in ( Seg ( len B79 ) ) & R3 in ( Seg ( width B79 ) ))))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
let C47 being  tabular FinSequence;
thus L205:now
assume L206: [ R2 , R3 ] in ( Indices C47 );
L207: [ R2 , R3 ] in [: ( dom C47 ) , ( Seg ( width C47 ) ) :] by L206 , MATRIX_1:def 4;
L208: R2 in ( dom C47 ) by L207 , ZFMISC_1:87;
thus L209: (R2 in ( Seg ( len C47 ) ) & R3 in ( Seg ( width C47 ) )) by L208 , L207 , FINSEQ_1:def 3 , ZFMISC_1:87;
end;
assume that
L210: R2 in ( Seg ( len C47 ) )
and
L211: R3 in ( Seg ( width C47 ) );
L212: R2 in ( dom C47 ) by L210 , FINSEQ_1:def 3;
L213: [ R2 , R3 ] in [: ( dom C47 ) , ( Seg ( width C47 ) ) :] by L212 , L211 , ZFMISC_1:87;
thus L214: thesis by L213 , MATRIX_1:def 4;
end;
theorem
L215: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (for B80 being non  empty set holds (for B81 being (Matrix of B80) holds ([ R2 , R3 ] in ( Indices B81 ) iff (R2 in ( dom B81 ) & R3 in ( dom ( B81 . R2 ) )))))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
let C48 being non  empty set;
let C49 being (Matrix of C48);
thus L216:now
assume L217: [ R2 , R3 ] in ( Indices C49 );
L218: R3 in ( Seg ( width C49 ) ) by L217 , L204;
L219: R2 in ( Seg ( len C49 ) ) by L217 , L204;
L220: R2 in ( dom C49 ) by L219 , FINSEQ_1:def 3;
L221: R3 in ( Seg ( len ( C49 . R2 ) ) ) by L220 , L218 , MATRIX_1:42;
thus L222: (R2 in ( dom C49 ) & R3 in ( dom ( C49 . R2 ) )) by L221 , L219 , FINSEQ_1:def 3;
end;
assume L223: (R2 in ( dom C49 ) & R3 in ( dom ( C49 . R2 ) ));
thus L224: thesis by L223 , MATRIX_1:43;
end;
theorem
L225: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (for B82 being non  empty set holds (for B83 being (Matrix of B82) holds ([ R2 , R3 ] in ( Indices B83 ) implies ( B83 * (R2 , R3) ) = ( ( B83 . R2 ) . R3 ))))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
let C50 being non  empty set;
let C51 being (Matrix of C50);
assume L226: [ R2 , R3 ] in ( Indices C51 );
L227: (ex B84 being (FinSequence of C50) st (B84 = ( C51 . R2 ) & ( C51 * (R2 , R3) ) = ( B84 . R3 ))) by L226 , MATRIX_1:def 5;
thus L228: thesis by L227;
end;
theorem
L229: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds (for B85 being non  empty set holds (for B86 being (Matrix of B85) holds ([ R2 , R3 ] in ( Indices B86 ) iff (R2 in ( dom ( Col (B86 , R3) ) ) & R3 in ( dom ( Line (B86 , R2) ) )))))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
let C52 being non  empty set;
let C53 being (Matrix of C52);
thus L230:now
assume L231: [ R2 , R3 ] in ( Indices C53 );
L232: R2 in ( dom C53 ) by L231 , L215;
L233: R2 in ( Seg ( len C53 ) ) by L232 , FINSEQ_1:def 3;
L234: R2 in ( Seg ( len ( Col (C53 , R3) ) ) ) by L233 , MATRIX_1:def 8;
thus L235: R2 in ( dom ( Col (C53 , R3) ) ) by L234 , FINSEQ_1:def 3;
L236: R3 in ( dom ( C53 . R2 ) ) by L231 , L215;
thus L237: R3 in ( dom ( Line (C53 , R2) ) ) by L236 , L232 , MATRIX_2:16;
end;
assume that
L238: R2 in ( dom ( Col (C53 , R3) ) )
and
L239: R3 in ( dom ( Line (C53 , R2) ) );
L240: R2 in ( Seg ( len ( Col (C53 , R3) ) ) ) by L238 , FINSEQ_1:def 3;
L241: R2 in ( Seg ( len C53 ) ) by L240 , MATRIX_1:def 8;
L242: R2 in ( dom C53 ) by L241 , FINSEQ_1:def 3;
L243: R3 in ( dom ( C53 . R2 ) ) by L242 , L239 , MATRIX_2:16;
thus L244: thesis by L243 , L242 , L215;
end;
theorem
L245: (for B87 , B88 being non  empty set holds (for B89 being (Matrix of B87) holds (for B90 being (Matrix of B88) holds (B89 = B90 implies (for R2 being (Element of ( NAT )) holds (R2 in ( dom B89 ) implies ( Line (B89 , R2) ) = ( Line (B90 , R2) )))))))
proof
let C54 , C55 being non  empty set;
let C56 being (Matrix of C54);
let C57 being (Matrix of C55);
assume that
L246: C56 = C57;
thus L247:now
let R2 being (Element of ( NAT ));
assume L248: R2 in ( dom C56 );
L249: ( Line (C56 , R2) ) = ( C56 . R2 ) by L248 , MATRIX_2:16;
thus L250: ( Line (C56 , R2) ) = ( Line (C57 , R2) ) by L249 , L246 , L248 , MATRIX_2:16;
end;
end;
theorem
L248: (for B91 , B92 being non  empty set holds (for B93 being (Matrix of B91) holds (for B94 being (Matrix of B92) holds (B93 = B94 implies (for R3 being (Element of ( NAT )) holds (R3 in ( Seg ( width B93 ) ) implies ( Col (B93 , R3) ) = ( Col (B94 , R3) )))))))
proof
let C58 , C59 being non  empty set;
let C60 being (Matrix of C58);
let C61 being (Matrix of C59);
assume that
L249: C60 = C61;
thus L250:now
let R3 being (Element of ( NAT ));
assume that
L251: R3 in ( Seg ( width C60 ) );
L252: (for B95 being Nat holds (B95 in ( dom ( Col (C60 , R3) ) ) implies ( ( Col (C60 , R3) ) . B95 ) = ( ( Col (C61 , R3) ) . B95 )))
proof
let C62 being Nat;
assume L253: C62 in ( dom ( Col (C60 , R3) ) );
L254: C62 in ( Seg ( len ( Col (C60 , R3) ) ) ) by L253 , FINSEQ_1:def 3;
L255: C62 in ( Seg ( len C60 ) ) by L254 , MATRIX_1:def 8;
L256: [ C62 , R3 ] in ( Indices C60 ) by L255 , L251 , L204;
L257: C62 in ( dom C60 ) by L255 , FINSEQ_1:def 3;
thus L258: ( ( Col (C60 , R3) ) . C62 ) = ( C60 * (C62 , R3) ) by L257 , MATRIX_1:def 8
.= ( C61 * (C62 , R3) ) by L249 , L256 , MATRIXR1:23
.= ( ( Col (C61 , R3) ) . C62 ) by L249 , L257 , MATRIX_1:def 8;
end;
L259: ( dom ( Col (C60 , R3) ) ) = ( Seg ( len ( Col (C60 , R3) ) ) ) by FINSEQ_1:def 3
.= ( Seg ( len C60 ) ) by MATRIX_1:def 8
.= ( Seg ( len ( Col (C61 , R3) ) ) ) by L249 , MATRIX_1:def 8
.= ( dom ( Col (C61 , R3) ) ) by FINSEQ_1:def 3;
thus L260: ( Col (C60 , R3) ) = ( Col (C61 , R3) ) by L259 , L252 , FINSEQ_1:13;
end;
end;
theorem
L251: (for R1 being non  empty set holds (for R5 being Nat holds (for R6 being Nat holds (for B96 being (FinSequence of R1) holds (( len B96 ) = R6 implies ( R5 |-> B96 ) is (Matrix of R5 , R6 , R1))))))
proof
let R1 being non  empty set;
let R5 being Nat;
let R6 being Nat;
let C63 being (FinSequence of R1);
assume that
L252: ( len C63 ) = R6;
reconsider D12 = ( R5 |-> C63 ) as (FinSequence of ( R1 * )) by L162;
L253: ( len D12 ) = R5 by CARD_1:def 7;
L254: (for R2 being (Element of ( NAT )) holds (R2 in ( dom D12 ) implies ( len ( D12 . R2 ) ) = R6))
proof
let R2 being (Element of ( NAT ));
assume L255: R2 in ( dom D12 );
L256: R2 in ( Seg R5 ) by L255 , L253 , FINSEQ_1:def 3;
thus L257: thesis by L256 , L252 , FUNCOP_1:7;
end;
reconsider D13 = D12 as (Matrix of R1) by L254 , L189;
L258: (for B97 being (FinSequence of R1) holds (B97 in ( rng D13 ) implies ( len B97 ) = R6))
proof
let C64 being (FinSequence of R1);
assume L259: C64 in ( rng D13 );
L260: (ex B98 being set st (B98 in ( dom D13 ) & C64 = ( D13 . B98 ))) by L259 , FUNCT_1:def 3;
thus L261: thesis by L260 , L254;
end;
thus L262: thesis by L258 , L253 , MATRIX_1:def 2;
end;
theorem
L263: (for R1 being non  empty set holds (for R4 being (Element of ( NAT )) holds (for R5 being Nat holds (for R6 being Nat holds (for B99 , B100 being (FinSequence of R1) holds ((( len B99 ) = R6 & ( len B100 ) = R6) implies (ex B101 being (Matrix of R5 , R6 , R1) st (for B102 being Nat holds (B102 in ( Seg R5 ) implies ((B102 in ( Seg R4 ) implies ( B101 . B102 ) = B99) & ((not B102 in ( Seg R4 )) implies ( B101 . B102 ) = B100)))))))))))
proof
let R1 being non  empty set;
let R4 being (Element of ( NAT ));
let R5 being Nat;
let R6 being Nat;
let C65 , C66 being (FinSequence of R1);
assume that
L264: (( len C65 ) = R6 & ( len C66 ) = R6);
consider C67 being (FinSequence of ( R1 * )) such that L265: ( len C67 ) = R5 and L266: (for B103 being Nat holds (B103 in ( Seg R5 ) implies ((B103 in ( Seg R4 ) implies ( C67 . B103 ) = C65) & ((not B103 in ( Seg R4 )) implies ( C67 . B103 ) = C66)))) by L165;
L267: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C67 ) implies ( len ( C67 . R2 ) ) = R6))
proof
let R2 being (Element of ( NAT ));
assume L268: R2 in ( dom C67 );
L269: R2 in ( Seg R5 ) by L268 , L265 , FINSEQ_1:def 3;
thus L270: thesis by L269 , L264 , L266;
end;
reconsider D14 = C67 as (Matrix of R1) by L267 , L189;
L271: (for B104 being (FinSequence of R1) holds (B104 in ( rng D14 ) implies ( len B104 ) = R6))
proof
let C68 being (FinSequence of R1);
assume L272: C68 in ( rng D14 );
L273: (ex B105 being set st (B105 in ( dom D14 ) & C68 = ( D14 . B105 ))) by L272 , FUNCT_1:def 3;
thus L274: thesis by L273 , L267;
end;
L275: D14 is (Matrix of R5 , R6 , R1) by L271 , L265 , MATRIX_1:def 2;
thus L276: thesis by L275 , L266;
end;
L277: (for R7 being Real holds (for B106 being (Matrix of ( REAL )) holds ((for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B106 ) implies ( B106 * (R2 , R3) ) >= R7))) iff (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom B106 ) & R3 in ( dom ( B106 . R2 ) )) implies ( ( B106 . R2 ) . R3 ) >= R7))))))
proof
let R7 being Real;
let C69 being (Matrix of ( REAL ));
thus L278:now
assume L279: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C69 ) implies ( C69 * (R2 , R3) ) >= R7)));
thus L280:now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume L281: (R2 in ( dom C69 ) & R3 in ( dom ( C69 . R2 ) ));
L282: [ R2 , R3 ] in ( Indices C69 ) by L281 , L215;
L283: ( C69 * (R2 , R3) ) >= R7 by L282 , L279;
thus L284: ( ( C69 . R2 ) . R3 ) >= R7 by L283 , L282 , L225;
end;
end;
assume L281: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom C69 ) & R3 in ( dom ( C69 . R2 ) )) implies ( ( C69 . R2 ) . R3 ) >= R7)));
thus L282:now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L283: [ R2 , R3 ] in ( Indices C69 );
L284: (R2 in ( dom C69 ) & R3 in ( dom ( C69 . R2 ) )) by L283 , L215;
L285: ( ( C69 . R2 ) . R3 ) >= R7 by L284 , L281;
thus L286: ( C69 * (R2 , R3) ) >= R7 by L285 , L283 , L225;
end;
end;
L283: (for R7 being Real holds (for B107 being (Matrix of ( REAL )) holds ((for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B107 ) implies ( B107 * (R2 , R3) ) >= R7))) iff (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom B107 ) & R3 in ( dom ( Line (B107 , R2) ) )) implies ( ( Line (B107 , R2) ) . R3 ) >= R7))))))
proof
let R7 being Real;
let C70 being (Matrix of ( REAL ));
thus L284:now
assume L285: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C70 ) implies ( C70 * (R2 , R3) ) >= R7)));
thus L286:now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L287: R2 in ( dom C70 )
and
L288: R3 in ( dom ( Line (C70 , R2) ) );
L289: ( C70 . R2 ) = ( Line (C70 , R2) ) by L287 , MATRIX_2:16;
thus L290: ( ( Line (C70 , R2) ) . R3 ) >= R7 by L289 , L285 , L287 , L288 , L277;
end;
end;
assume L287: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom C70 ) & R3 in ( dom ( Line (C70 , R2) ) )) implies ( ( Line (C70 , R2) ) . R3 ) >= R7)));
L288:
now
let R2 being (Element of ( NAT ));
assume that
L289: R2 in ( dom C70 );
L290: ( C70 . R2 ) = ( Line (C70 , R2) ) by L289 , MATRIX_2:16;
thus L291: (for R3 being (Element of ( NAT )) holds (R3 in ( dom ( C70 . R2 ) ) implies ( ( C70 . R2 ) . R3 ) >= R7)) by L290 , L287 , L289;
end;
L292: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom C70 ) & R3 in ( dom ( C70 . R2 ) )) implies ( ( C70 . R2 ) . R3 ) >= R7))) by L288;
thus L293: thesis by L292 , L277;
end;
L294: (for R7 being Real holds (for B108 being (Matrix of ( REAL )) holds ((for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B108 ) implies ( B108 * (R2 , R3) ) >= R7))) iff (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R3 in ( Seg ( width B108 ) ) & R2 in ( dom ( Col (B108 , R3) ) )) implies ( ( Col (B108 , R3) ) . R2 ) >= R7))))))
proof
let R7 being Real;
let C71 being (Matrix of ( REAL ));
thus L295:now
assume L296: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C71 ) implies ( C71 * (R2 , R3) ) >= R7)));
thus L297:now
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L298: R3 in ( Seg ( width C71 ) )
and
L299: R2 in ( dom ( Col (C71 , R3) ) );
L300: R3 in ( Seg ( len ( Line (C71 , R2) ) ) ) by L298 , MATRIX_1:def 7;
L301: R3 in ( dom ( Line (C71 , R2) ) ) by L300 , FINSEQ_1:def 3;
L302: [ R2 , R3 ] in ( Indices C71 ) by L301 , L299 , L229;
L303: R2 in ( dom C71 ) by L302 , L215;
L304: ( ( Line (C71 , R2) ) . R3 ) >= R7 by L303 , L296 , L301 , L283;
thus L305: ( ( Col (C71 , R3) ) . R2 ) >= R7 by L304 , L298 , L303 , GOBOARD1:2;
end;
end;
assume L298: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R3 in ( Seg ( width C71 ) ) & R2 in ( dom ( Col (C71 , R3) ) )) implies ( ( Col (C71 , R3) ) . R2 ) >= R7)));
L299: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom C71 ) & R3 in ( dom ( Line (C71 , R2) ) )) implies ( ( Line (C71 , R2) ) . R3 ) >= R7)))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L300: R2 in ( dom C71 )
and
L301: R3 in ( dom ( Line (C71 , R2) ) );
L302: R3 in ( Seg ( len ( Line (C71 , R2) ) ) ) by L301 , FINSEQ_1:def 3;
L303: R3 in ( Seg ( width C71 ) ) by L302 , MATRIX_1:def 7;
L304: R2 in ( Seg ( len C71 ) ) by L300 , FINSEQ_1:def 3;
L305: R2 in ( Seg ( len ( Col (C71 , R3) ) ) ) by L304 , MATRIX_1:def 8;
L306: R2 in ( dom ( Col (C71 , R3) ) ) by L305 , FINSEQ_1:def 3;
L307: ( ( Col (C71 , R3) ) . R2 ) >= R7 by L306 , L298 , L303;
thus L308: thesis by L307 , L300 , L303 , GOBOARD1:2;
end;
thus L309: thesis by L299 , L283;
end;
definition
let C72 being (FinSequence of ( ( REAL ) * ));
func Sum C72 -> (FinSequence of ( REAL )) means 
:L310: (( len it ) = ( len C72 ) & (for R4 being (Element of ( NAT )) holds (R4 in ( dom it ) implies ( it . R4 ) = ( Sum ( C72 . R4 ) ))));
existence
proof
deffunc H3(Nat) = ( Sum ( C72 . $1 ) );
consider C73 being (FinSequence of ( REAL )) such that L311: (( len C73 ) = ( len C72 ) & (for B109 being Nat holds (B109 in ( dom C73 ) implies ( C73 . B109 ) = H3(B109)))) from FINSEQ_2:sch 1;
take C73;
thus L312: thesis by L311;
end;
uniqueness
proof
let C74 , C75 being (FinSequence of ( REAL ));
assume that
L313: ( len C74 ) = ( len C72 )
and
L314: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C74 ) implies ( C74 . R4 ) = ( Sum ( C72 . R4 ) )))
and
L315: ( len C75 ) = ( len C72 )
and
L316: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C75 ) implies ( C75 . R4 ) = ( Sum ( C72 . R4 ) )));
L317: (( dom C74 ) = ( dom C75 ) & (for B110 being Nat holds (B110 in ( dom C74 ) implies ( C74 . B110 ) = ( C75 . B110 ))))
proof
thus L318: ( dom C74 ) = ( Seg ( len C72 ) ) by L313 , FINSEQ_1:def 3
.= ( dom C75 ) by L315 , FINSEQ_1:def 3;
let C76 being Nat;
assume that
L319: C76 in ( dom C74 );
thus L320: ( C74 . C76 ) = ( Sum ( C72 . C76 ) ) by L314 , L319
.= ( C75 . C76 ) by L316 , L318 , L319;
end;
thus L321: thesis by L317 , FINSEQ_1:13;
end;
end;
notation
let C77 being (Matrix of ( REAL ));
synonym LineSum C77 for Sum C77;
end;
theorem
L324: (for B111 being (Matrix of ( REAL )) holds (( len ( Sum B111 ) ) = ( len B111 ) & (for R2 being (Element of ( NAT )) holds (R2 in ( Seg ( len B111 ) ) implies ( ( Sum B111 ) . R2 ) = ( Sum ( Line (B111 , R2) ) )))))
proof
let C78 being (Matrix of ( REAL ));
thus L325: ( len ( Sum C78 ) ) = ( len C78 ) by L310;
thus L326: (for R4 being (Element of ( NAT )) holds (R4 in ( Seg ( len C78 ) ) implies ( ( Sum C78 ) . R4 ) = ( Sum ( Line (C78 , R4) ) )))
proof
let R4 being (Element of ( NAT ));
assume that
L327: R4 in ( Seg ( len C78 ) );
L328: R4 in ( dom C78 ) by L327 , FINSEQ_1:def 3;
L329: R4 in ( Seg ( len ( Sum C78 ) ) ) by L327 , L310;
L330: R4 in ( dom ( Sum C78 ) ) by L329 , FINSEQ_1:def 3;
thus L331: ( ( Sum C78 ) . R4 ) = ( Sum ( C78 . R4 ) ) by L330 , L310
.= ( Sum ( Line (C78 , R4) ) ) by L328 , MATRIX_2:16;
end;

end;
definition
let C79 being (Matrix of ( REAL ));
func ColSum C79 -> (FinSequence of ( REAL )) means 
:L327: (( len it ) = ( width C79 ) & (for B112 being Nat holds (B112 in ( Seg ( width C79 ) ) implies ( it . B112 ) = ( Sum ( Col (C79 , B112) ) ))));
existence
proof
deffunc H4(Nat) = ( Sum ( Col (C79 , $1) ) );
consider C80 being (FinSequence of ( REAL )) such that L328: (( len C80 ) = ( width C79 ) & (for B113 being Nat holds (B113 in ( dom C80 ) implies ( C80 . B113 ) = H4(B113)))) from FINSEQ_2:sch 1;
L329: ( dom C80 ) = ( Seg ( width C79 ) ) by L328 , FINSEQ_1:def 3;
thus L330: thesis by L329 , L328;
end;
uniqueness
proof
let C81 , C82 being (FinSequence of ( REAL ));
assume that
L331: ( len C81 ) = ( width C79 )
and
L332: (for B114 being Nat holds (B114 in ( Seg ( width C79 ) ) implies ( C81 . B114 ) = ( Sum ( Col (C79 , B114) ) )))
and
L333: ( len C82 ) = ( width C79 )
and
L334: (for B115 being Nat holds (B115 in ( Seg ( width C79 ) ) implies ( C82 . B115 ) = ( Sum ( Col (C79 , B115) ) )));
L335: ( dom C81 ) = ( Seg ( width C79 ) ) by L331 , FINSEQ_1:def 3;
L336: (for B116 being Nat holds (B116 in ( dom C81 ) implies ( C81 . B116 ) = ( C82 . B116 )))
proof
let C83 being Nat;
assume L337: C83 in ( dom C81 );
L338: ( C81 . C83 ) = ( Sum ( Col (C79 , C83) ) ) by L337 , L332 , L335;
thus L339: thesis by L338 , L334 , L335 , L337;
end;
thus L340: thesis by L336 , L331 , L333 , FINSEQ_2:9;
end;
end;
theorem
L342: (for B117 being (Matrix of ( REAL )) holds (( width B117 ) > ( 0 ) implies ( LineSum B117 ) = ( ColSum ( B117 @ ) )))
proof
let C84 being (Matrix of ( REAL ));
assume L343: ( width C84 ) > ( 0 );
L344: ( len C84 ) = ( width ( C84 @ ) ) by L343 , MATRIX_2:10;
L345: ( len ( LineSum C84 ) ) = ( len C84 ) by L324;
L346: ( len ( ColSum ( C84 @ ) ) ) = ( width ( C84 @ ) ) by L327;
L347:
now
let C85 being Nat;
assume that
L348: 1 <= C85
and
L349: C85 <= ( len ( ColSum ( C84 @ ) ) );
L350: C85 <= ( len ( LineSum C84 ) ) by L345 , L344 , L349 , L327;
L351: C85 in ( Seg ( len ( LineSum C84 ) ) ) by L350 , L348 , FINSEQ_1:1;
L352: C85 in ( Seg ( len C84 ) ) by L351 , L324;
L353: C85 in ( dom C84 ) by L352 , FINSEQ_1:def 3;
L354: C85 in ( Seg ( width ( C84 @ ) ) ) by L346 , L348 , L349 , FINSEQ_1:1;
thus L355: ( ( ColSum ( C84 @ ) ) . C85 ) = ( Sum ( Col (( C84 @ ) , C85) ) ) by L354 , L327
.= ( Sum ( Line (C84 , C85) ) ) by L353 , MATRIX_2:14
.= ( ( LineSum C84 ) . C85 ) by L352 , L324;
end;
L356: ( len ( ColSum ( C84 @ ) ) ) = ( len ( LineSum C84 ) ) by L345 , L344 , L327;
thus L357: thesis by L356 , L347 , FINSEQ_1:14;
end;
theorem
L358: (for B118 being (Matrix of ( REAL )) holds ( ColSum B118 ) = ( LineSum ( B118 @ ) ))
proof
let C86 being (Matrix of ( REAL ));
L359: ( len ( ColSum C86 ) ) = ( width C86 ) by L327;
L360: ( len ( LineSum ( C86 @ ) ) ) = ( len ( C86 @ ) ) by L324;
L361:
now
let C87 being Nat;
assume that
L362: 1 <= C87
and
L363: C87 <= ( len ( ColSum C86 ) );
L364: C87 <= ( len ( LineSum ( C86 @ ) ) ) by L360 , L359 , L363 , MATRIX_1:def 6;
L365: C87 in ( Seg ( len ( LineSum ( C86 @ ) ) ) ) by L364 , L362 , FINSEQ_1:1;
L366: C87 in ( Seg ( len ( C86 @ ) ) ) by L365 , L324;
L367: C87 in ( Seg ( width C86 ) ) by L359 , L362 , L363 , FINSEQ_1:1;
thus L368: ( ( ColSum C86 ) . C87 ) = ( Sum ( Col (C86 , C87) ) ) by L367 , L327
.= ( Sum ( Line (( C86 @ ) , C87) ) ) by L367 , MATRIX_2:15
.= ( ( LineSum ( C86 @ ) ) . C87 ) by L366 , L324;
end;
L369: ( len ( ColSum C86 ) ) = ( len ( LineSum ( C86 @ ) ) ) by L360 , L359 , MATRIX_1:def 6;
thus L370: thesis by L369 , L361 , FINSEQ_1:14;
end;
definition
let C88 being (Matrix of ( REAL ));
func SumAll C88 -> (Element of ( REAL )) equals 
( Sum ( Sum C88 ) );
coherence;
end;
theorem
L372: (for B119 being (Matrix of ( REAL )) holds (( len B119 ) = ( 0 ) implies ( SumAll B119 ) = ( 0 )))
proof
let C89 being (Matrix of ( REAL ));
assume L373: ( len C89 ) = ( 0 );
L374: ( len ( Sum C89 ) ) = ( 0 ) by L373 , L310;
L375: ( Sum C89 ) = ( <*> ( REAL ) ) by L374;
thus L376: thesis by L375 , RVSUM_1:72;
end;
theorem
L377: (for R6 being Nat holds (for B120 being (Matrix of R6 , ( 0 ) , ( REAL )) holds ( SumAll B120 ) = ( 0 )))
proof
let R6 being Nat;
let C90 being (Matrix of R6 , ( 0 ) , ( REAL ));
per cases ;
suppose L378: R6 = ( 0 );

L379: ( len C90 ) = ( 0 ) by L378 , MATRIX_1:def 2;
thus L380: thesis by L379 , L372;
end;
suppose L381: R6 > ( 0 );

L382: (( len ( Sum C90 ) ) > ( 0 ) & (for B121 being Nat holds (B121 in ( dom ( Sum C90 ) ) implies ( ( Sum C90 ) . B121 ) = ( 0 ))))
proof
L383: ( len C90 ) > ( 0 ) by L381 , MATRIX_1:def 2;
thus L384: ( len ( Sum C90 ) ) > ( 0 ) by L383 , L310;
L385: ( len C90 ) = ( len ( Sum C90 ) ) by L310;
L386: ( dom C90 ) = ( dom ( Sum C90 ) ) by L385 , FINSEQ_3:29;
thus L387:now
let C91 being Nat;
assume that
L388: C91 in ( dom ( Sum C90 ) );
L389: ( C90 . C91 ) in ( rng C90 ) by L386 , L388 , FUNCT_1:def 3;
L390: ( len ( C90 . C91 ) ) = ( 0 ) by L389 , MATRIX_1:def 2;
L391: ( C90 . C91 ) = ( <*> ( REAL ) ) by L390;
thus L392: ( ( Sum C90 ) . C91 ) = ( Sum ( C90 . C91 ) ) by L388 , L310
.= ( 0 ) by L391 , RVSUM_1:72;
end;
end;
thus L388: ( SumAll C90 ) = ( Sum ( ( len ( Sum C90 ) ) |-> ( 0 ) ) ) by L382 , L14
.= ( ( len ( Sum C90 ) ) * ( 0 ) ) by RVSUM_1:80
.= ( 0 );
end;
end;
theorem
L390: (for R4 being (Element of ( NAT )) holds (for R5 being Nat holds (for R6 being Nat holds (for B122 being (Matrix of R5 , R4 , ( REAL )) holds (for B123 being (Matrix of R6 , R4 , ( REAL )) holds ( Sum ( B122 ^ B123 ) ) = ( ( Sum B122 ) ^ ( Sum B123 ) ))))))
proof
let R4 being (Element of ( NAT ));
let R5 being Nat;
let R6 being Nat;
let C92 being (Matrix of R5 , R4 , ( REAL ));
let C93 being (Matrix of R6 , R4 , ( REAL ));
L391: ( dom ( Sum ( C92 ^ C93 ) ) ) = ( Seg ( len ( Sum ( C92 ^ C93 ) ) ) ) by FINSEQ_1:def 3;
L392:
now
let C94 being Nat;
assume L393: C94 in ( dom ( Sum ( C92 ^ C93 ) ) );
L394: C94 in ( Seg ( len ( C92 ^ C93 ) ) ) by L393 , L391 , L310;
L395: C94 in ( dom ( C92 ^ C93 ) ) by L394 , FINSEQ_1:def 3;
L396:
now
per cases  by L395 , FINSEQ_1:25;
suppose L397: C94 in ( dom C92 );

L398: ( len C92 ) = ( len ( Sum C92 ) ) by L310;
L399: ( dom C92 ) = ( dom ( Sum C92 ) ) by L398 , FINSEQ_3:29;
thus L400: ( ( Sum ( C92 ^ C93 ) ) . C94 ) = ( Sum ( ( C92 ^ C93 ) . C94 ) ) by L393 , L310
.= ( Sum ( C92 . C94 ) ) by L397 , FINSEQ_1:def 7
.= ( ( Sum C92 ) . C94 ) by L397 , L399 , L310
.= ( ( ( Sum C92 ) ^ ( Sum C93 ) ) . C94 ) by L397 , L399 , FINSEQ_1:def 7;
end;
suppose L401: (ex B124 being Nat st (B124 in ( dom C93 ) & C94 = ( ( len C92 ) + B124 )));

L402: ( len C92 ) = ( len ( Sum C92 ) ) by L310;
L403: ( len C93 ) = ( len ( Sum C93 ) ) by L310;
L404: ( dom C93 ) = ( dom ( Sum C93 ) ) by L403 , FINSEQ_3:29;
consider C95 being Nat such that L405: C95 in ( dom C93 ) and L406: C94 = ( ( len C92 ) + C95 ) by L401;
thus L407: ( ( Sum ( C92 ^ C93 ) ) . C94 ) = ( Sum ( ( C92 ^ C93 ) . C94 ) ) by L393 , L310
.= ( Sum ( C93 . C95 ) ) by L405 , L406 , FINSEQ_1:def 7
.= ( ( Sum C93 ) . C95 ) by L405 , L404 , L310
.= ( ( ( Sum C92 ) ^ ( Sum C93 ) ) . C94 ) by L405 , L406 , L402 , L404 , FINSEQ_1:def 7;
end;
end;
thus L409: ( ( Sum ( C92 ^ C93 ) ) . C94 ) = ( ( ( Sum C92 ) ^ ( Sum C93 ) ) . C94 ) by L396;
end;
L410: ( len ( Sum ( C92 ^ C93 ) ) ) = ( len ( C92 ^ C93 ) ) by L310
.= ( ( len C92 ) + ( len C93 ) ) by FINSEQ_1:22
.= ( ( len ( Sum C92 ) ) + ( len C93 ) ) by L310
.= ( ( len ( Sum C92 ) ) + ( len ( Sum C93 ) ) ) by L310
.= ( len ( ( Sum C92 ) ^ ( Sum C93 ) ) ) by FINSEQ_1:22;
thus L411: thesis by L410 , L392 , FINSEQ_2:9;
end;
theorem
L412: (for B125 , B126 being (Matrix of ( REAL )) holds ( ( Sum B125 ) + ( Sum B126 ) ) = ( Sum ( B125 ^^ B126 ) ))
proof
let C96 , C97 being (Matrix of ( REAL ));
reconsider D15 = ( min (( len C96 ) , ( len C97 )) ) as (Element of ( NAT )) by FINSEQ_2:1;
L413: ( Seg D15 ) = ( ( Seg ( len C96 ) ) /\ ( Seg ( len C97 ) ) ) by FINSEQ_2:2
.= ( ( Seg ( len C96 ) ) /\ ( dom C97 ) ) by FINSEQ_1:def 3
.= ( ( dom C96 ) /\ ( dom C97 ) ) by FINSEQ_1:def 3
.= ( dom ( C96 ^^ C97 ) ) by PRE_POLY:def 4
.= ( Seg ( len ( C96 ^^ C97 ) ) ) by FINSEQ_1:def 3;
L414: ( len ( ( Sum C96 ) + ( Sum C97 ) ) ) = ( len ( ( addreal ) .: (( Sum C96 ) , ( Sum C97 )) ) )
.= ( min (( len ( Sum C96 ) ) , ( len ( Sum C97 ) )) ) by FINSEQ_2:71
.= ( min (( len C96 ) , ( len ( Sum C97 ) )) ) by L310
.= ( min (( len C96 ) , ( len C97 )) ) by L310
.= ( len ( C96 ^^ C97 ) ) by L413 , FINSEQ_1:6
.= ( len ( Sum ( C96 ^^ C97 ) ) ) by L310;
L415: ( dom ( ( Sum C96 ) + ( Sum C97 ) ) ) = ( Seg ( len ( ( Sum C96 ) + ( Sum C97 ) ) ) ) by FINSEQ_1:def 3;
L416:
now
let C98 being Nat;
assume L417: C98 in ( dom ( ( Sum C96 ) + ( Sum C97 ) ) );
L418: C98 in ( dom ( ( addreal ) .: (( Sum C96 ) , ( Sum C97 )) ) ) by L417;
L419: C98 in ( Seg ( len ( C96 ^^ C97 ) ) ) by L414 , L415 , L417 , L310;
L420: C98 in ( dom ( C96 ^^ C97 ) ) by L419 , FINSEQ_1:def 3;
L421: C98 in ( ( dom C96 ) /\ ( dom C97 ) ) by L420 , PRE_POLY:def 4;
L422: C98 in ( dom C96 ) by L421 , XBOOLE_0:def 4;
L423: C98 in ( Seg ( len C96 ) ) by L422 , FINSEQ_1:def 3;
L424: C98 in ( Seg ( len ( Sum C96 ) ) ) by L423 , L310;
L425: C98 in ( dom ( Sum C96 ) ) by L424 , FINSEQ_1:def 3;
L426: C98 in ( dom C97 ) by L421 , XBOOLE_0:def 4;
L427: C98 in ( Seg ( len C97 ) ) by L426 , FINSEQ_1:def 3;
L428: C98 in ( Seg ( len ( Sum C97 ) ) ) by L427 , L310;
L429: C98 in ( dom ( Sum C97 ) ) by L428 , FINSEQ_1:def 3;
L430: C98 in ( dom ( Sum ( C96 ^^ C97 ) ) ) by L414 , L415 , L417 , FINSEQ_1:def 3;
L431: ( ( C96 . C98 ) ^ ( C97 . C98 ) ) = ( ( C96 ^^ C97 ) . C98 ) by L420 , PRE_POLY:def 4;
thus L432: ( ( ( Sum C96 ) + ( Sum C97 ) ) . C98 ) = ( ( ( addreal ) .: (( Sum C96 ) , ( Sum C97 )) ) . C98 )
.= ( ( addreal ) . (( ( Sum C96 ) . C98 ) , ( ( Sum C97 ) . C98 )) ) by L418 , FUNCOP_1:22
.= ( ( ( Sum C96 ) . C98 ) + ( ( Sum C97 ) . C98 ) ) by BINOP_2:def 9
.= ( ( Sum ( C96 . C98 ) ) + ( ( Sum C97 ) . C98 ) ) by L425 , L310
.= ( ( Sum ( C96 . C98 ) ) + ( Sum ( C97 . C98 ) ) ) by L429 , L310
.= ( Sum ( ( C96 ^^ C97 ) . C98 ) ) by L431 , RVSUM_1:75
.= ( ( Sum ( C96 ^^ C97 ) ) . C98 ) by L430 , L310;
end;
thus L433: thesis by L416 , L414 , FINSEQ_2:9;
end;
theorem
L434: (for B127 , B128 being (Matrix of ( REAL )) holds (( len B127 ) = ( len B128 ) implies ( ( SumAll B127 ) + ( SumAll B128 ) ) = ( SumAll ( B127 ^^ B128 ) )))
proof
let C99 , C100 being (Matrix of ( REAL ));
assume that
L435: ( len C99 ) = ( len C100 );
L436: ( len ( Sum C99 ) ) = ( len C99 ) by L310
.= ( len ( Sum C100 ) ) by L435 , L310;
reconsider D16 = ( Sum C99 ) , D17 = ( Sum C100 ) as (Element of ( ( len ( Sum C99 ) ) -tuples_on ( REAL ) )) by L436 , FINSEQ_2:92;
thus L437: ( ( SumAll C99 ) + ( SumAll C100 ) ) = ( Sum ( D16 + D17 ) ) by RVSUM_1:89
.= ( SumAll ( C99 ^^ C100 ) ) by L412;
end;
theorem
L438: (for B129 being (Matrix of ( REAL )) holds ( SumAll B129 ) = ( SumAll ( B129 @ ) ))
proof
let C101 being (Matrix of ( REAL ));
defpred S5[ Nat ] means (for B130 being (Matrix of ( REAL )) holds (( len B130 ) = $1 implies ( SumAll B130 ) = ( SumAll ( B130 @ ) )));
L439: (for B131 being (FinSequence of ( REAL )) holds ( SumAll <* B131 *> ) = ( SumAll ( <* B131 *> @ ) ))
proof
defpred S6[ (FinSequence of ( REAL )) ] means ( SumAll <* $1 *> ) = ( SumAll ( <* $1 *> @ ) );
let C102 being (FinSequence of ( REAL ));
L440: (for B132 being (FinSequence of ( REAL )) holds (for B133 being (Element of ( REAL )) holds (S6[ B132 ] implies S6[ ( B132 ^ <* B133 *> ) ])))
proof
let C103 being (FinSequence of ( REAL ));
let C104 being (Element of ( REAL ));
assume that
L441: ( SumAll <* C103 *> ) = ( SumAll ( <* C103 *> @ ) );
L442: ( Seg ( len ( <* C103 *> ^^ <* <* C104 *> *> ) ) ) = ( dom ( <* C103 *> ^^ <* <* C104 *> *> ) ) by FINSEQ_1:def 3
.= ( ( dom <* C103 *> ) /\ ( dom <* <* C104 *> *> ) ) by PRE_POLY:def 4
.= ( ( Seg 1 ) /\ ( dom <* <* C104 *> *> ) ) by FINSEQ_1:38
.= ( ( Seg 1 ) /\ ( Seg 1 ) ) by FINSEQ_1:38
.= ( Seg 1 );
L443: ( len ( <* C103 *> ^^ <* <* C104 *> *> ) ) = 1 by L442 , FINSEQ_1:6
.= ( len <* ( C103 ^ <* C104 *> ) *> ) by FINSEQ_1:39;
L444: ( dom <* ( C103 ^ <* C104 *> ) *> ) = ( Seg ( len <* ( C103 ^ <* C104 *> ) *> ) ) by FINSEQ_1:def 3;
L445:
now
let C105 being Nat;
reconsider D18 = ( <* C103 *> . C105 ) , D19 = ( <* <* C104 *> *> . C105 ) as FinSequence;
assume L446: C105 in ( dom <* ( C103 ^ <* C104 *> ) *> );
L447: C105 in { 1 } by L446 , L444 , FINSEQ_1:2 , FINSEQ_1:40;
L448: C105 = 1 by L447 , TARSKI:def 1;
L449: C105 in ( dom ( <* C103 *> ^^ <* <* C104 *> *> ) ) by L443 , L444 , L446 , FINSEQ_1:def 3;
thus L450: ( ( <* C103 *> ^^ <* <* C104 *> *> ) . C105 ) = ( D18 ^ D19 ) by L449 , PRE_POLY:def 4
.= ( C103 ^ D19 ) by L448 , FINSEQ_1:40
.= ( C103 ^ <* C104 *> ) by L448 , FINSEQ_1:40
.= ( <* ( C103 ^ <* C104 *> ) *> . C105 ) by L448 , FINSEQ_1:40;
end;
per cases ;
suppose L451: ( len C103 ) = ( 0 );

L452: C103 = ( {} ) by L451;
thus L453: ( SumAll <* ( C103 ^ <* C104 *> ) *> ) = ( SumAll <* <* C104 *> *> ) by L452 , FINSEQ_1:34
.= ( SumAll ( <* <* C104 *> *> @ ) ) by MATRLIN:15
.= ( SumAll ( <* ( C103 ^ <* C104 *> ) *> @ ) ) by L452 , FINSEQ_1:34;
end;
suppose L454: ( len C103 ) <> ( 0 );

L455: ( len <* <* C104 *> *> ) = 1 by FINSEQ_1:40;
L456: ( width <* <* C104 *> *> ) = ( len <* C104 *> ) by L455 , MATRIX_1:20
.= 1 by FINSEQ_1:40;
L457: ( len ( <* <* C104 *> *> @ ) ) = 1 by L456 , MATRIX_1:def 6;
L458: ( len <* C103 *> ) = 1 by FINSEQ_1:40;
L459: ( width <* C103 *> ) = ( len C103 ) by L458 , MATRIX_1:20;
L460: ( len ( <* C103 *> @ ) ) = ( len C103 ) by L459 , MATRIX_1:def 6;
L461: ( width ( <* C103 *> @ ) ) = 1 by L454 , L458 , L459 , MATRIX_2:10;
reconsider D20 = ( <* C103 *> @ ) as (Matrix of ( len C103 ) , 1 , ( REAL )) by L461 , L454 , L460 , MATRIX_1:20;
L462: ( len <* ( C103 ^ <* C104 *> ) *> ) = 1 by FINSEQ_1:40;
L463: ( width <* ( C103 ^ <* C104 *> ) *> ) = ( len ( C103 ^ <* C104 *> ) ) by L462 , MATRIX_1:20
.= ( ( len C103 ) + ( len <* C104 *> ) ) by FINSEQ_1:22
.= ( ( len C103 ) + 1 ) by FINSEQ_1:40;
L464: ( ( <* <* C104 *> *> @ ) @ ) = <* <* C104 *> *> by L455 , L456 , MATRIX_2:13;
L465: ( width ( <* C103 *> @ ) ) = ( len <* C103 *> ) by L454 , L459 , MATRIX_2:10
.= ( width ( <* <* C104 *> *> @ ) ) by L458 , L455 , L456 , MATRIX_2:10;
L466: ( width ( <* <* C104 *> *> @ ) ) = 1 by L465 , L454 , L458 , L459 , MATRIX_2:10;
reconsider D21 = ( <* <* C104 *> *> @ ) as (Matrix of 1 , 1 , ( REAL )) by L466 , L457 , MATRIX_1:20;
L467: ( ( D20 ^ D21 ) @ ) = ( ( ( <* C103 *> @ ) @ ) ^^ ( ( <* <* C104 *> *> @ ) @ ) ) by L465 , MATRLIN:28
.= ( <* C103 *> ^^ <* <* C104 *> *> ) by L454 , L458 , L459 , L464 , MATRIX_2:13
.= <* ( C103 ^ <* C104 *> ) *> by L443 , L445 , FINSEQ_2:9
.= ( ( <* ( C103 ^ <* C104 *> ) *> @ ) @ ) by L462 , L463 , MATRIX_2:13;
L468: ( len ( ( <* C103 *> @ ) ^ ( <* <* C104 *> *> @ ) ) ) = ( ( len ( <* C103 *> @ ) ) + ( len ( <* <* C104 *> *> @ ) ) ) by FINSEQ_1:22
.= ( ( width <* C103 *> ) + ( len ( <* <* C104 *> *> @ ) ) ) by MATRIX_1:def 6
.= ( ( width <* C103 *> ) + ( width <* <* C104 *> *> ) ) by MATRIX_1:def 6
.= ( len ( <* ( C103 ^ <* C104 *> ) *> @ ) ) by L459 , L456 , L463 , MATRIX_1:def 6;
thus L469: ( SumAll <* ( C103 ^ <* C104 *> ) *> ) = ( SumAll ( <* C103 *> ^^ <* <* C104 *> *> ) ) by L443 , L445 , FINSEQ_2:9
.= ( ( SumAll ( <* C103 *> @ ) ) + ( SumAll <* <* C104 *> *> ) ) by L441 , L458 , L455 , L434
.= ( ( SumAll ( <* C103 *> @ ) ) + ( SumAll ( <* <* C104 *> *> @ ) ) ) by MATRLIN:15
.= ( Sum ( ( Sum D20 ) ^ ( Sum D21 ) ) ) by RVSUM_1:75
.= ( SumAll ( D20 ^ D21 ) ) by L390
.= ( SumAll ( <* ( C103 ^ <* C104 *> ) *> @ ) ) by L468 , L467 , MATRIX_2:9;
end;
end;
L471: S6[ ( <*> ( REAL ) ) ]
proof
reconsider D22 = <* ( <*> ( REAL ) ) *> as (Matrix of 1 , ( 0 ) , ( REAL ));
L472: ( len D22 ) = 1 by MATRIX_1:def 2;
L473: ( width D22 ) = ( 0 ) by L472 , MATRIX_1:20;
L474: ( len ( D22 @ ) ) = ( 0 ) by L473 , MATRIX_1:def 6;
L475: ( SumAll D22 ) = ( 0 ) by L377
.= ( SumAll ( D22 @ ) ) by L474 , L372;
thus L476: thesis by L475;
end;
L477: (for B134 being (FinSequence of ( REAL )) holds S6[ B134 ]) from FINSEQ_2:sch 2(L471 , L440);
thus L478: thesis by L477;
end;
L479: (for R5 being Nat holds (S5[ R5 ] implies S5[ ( R5 + 1 ) ]))
proof
let R5 being Nat;
assume that
L480: (for B135 being (Matrix of ( REAL )) holds (( len B135 ) = R5 implies ( SumAll B135 ) = ( SumAll ( B135 @ ) )));
thus L481: (for B136 being (Matrix of ( REAL )) holds (( len B136 ) = ( R5 + 1 ) implies ( SumAll B136 ) = ( SumAll ( B136 @ ) )))
proof
let C106 being (Matrix of ( REAL ));
assume that
L482: ( len C106 ) = ( R5 + 1 );
L483: ( dom C106 ) = ( Seg ( len C106 ) ) by FINSEQ_1:def 3;
per cases ;
suppose L484: R5 = ( 0 );

reconsider D23 = ( C106 . 1 ) as (FinSequence of ( REAL ));
L485: C106 = <* D23 *> by L482 , L484 , FINSEQ_1:40;
thus L486: thesis by L485 , L439;
end;
suppose L487: R5 > ( 0 );

reconsider D24 = C106 as (Matrix of ( R5 + 1 ) , ( width C106 ) , ( REAL )) by L482 , MATRIX_1:20;
reconsider D25 = ( C106 . ( R5 + 1 ) ) as (FinSequence of ( REAL ));
reconsider D26 = ( Del (D24 , ( R5 + 1 )) ) as (Matrix of R5 , ( width C106 ) , ( REAL )) by MATRLIN:3;
L488: ( C106 . ( R5 + 1 ) ) = ( Line (C106 , ( R5 + 1 )) ) by L482 , L483 , FINSEQ_1:4 , MATRIX_2:16;
reconsider D27 = <* D25 *> as (Matrix of 1 , ( width C106 ) , ( REAL )) by L488 , MATRIX_1:def 7;
L489: ( width D26 ) = ( width D24 ) by L487 , MATRLIN:2
.= ( width D27 ) by MATRLIN:2;
L490: ( len ( D26 @ ) ) = ( width D26 ) by MATRIX_1:def 6
.= ( len ( D27 @ ) ) by L489 , MATRIX_1:def 6;
L491: ( len ( Del (C106 , ( R5 + 1 )) ) ) = R5 by L482 , PRE_POLY:12;
thus L492: ( SumAll C106 ) = ( SumAll ( D26 ^ D27 ) ) by L482 , PRE_POLY:13
.= ( Sum ( ( Sum D26 ) ^ ( Sum D27 ) ) ) by L390
.= ( ( SumAll ( Del (C106 , ( R5 + 1 )) ) ) + ( SumAll D27 ) ) by RVSUM_1:75
.= ( ( SumAll ( ( Del (C106 , ( R5 + 1 )) ) @ ) ) + ( SumAll D27 ) ) by L480 , L491
.= ( ( SumAll ( ( Del (C106 , ( R5 + 1 )) ) @ ) ) + ( SumAll ( D27 @ ) ) ) by L439
.= ( SumAll ( ( D26 @ ) ^^ ( D27 @ ) ) ) by L490 , L434
.= ( SumAll ( ( D26 ^ D27 ) @ ) ) by L489 , MATRLIN:28
.= ( SumAll ( C106 @ ) ) by L482 , PRE_POLY:13;
end;
end;

end;
L482: S5[ ( 0 ) ]
proof
let C107 being (Matrix of ( REAL ));
assume L483: ( len C107 ) = ( 0 );
L484: ( width C107 ) = ( 0 ) by L483 , MATRIX_1:def 3;
L485: ( len ( C107 @ ) ) = ( 0 ) by L484 , MATRIX_1:def 6;
thus L486: ( SumAll C107 ) = ( 0 ) by L483 , L372
.= ( SumAll ( C107 @ ) ) by L485 , L372;
end;
L487: (for R5 being Nat holds S5[ R5 ]) from NAT_1:sch 2(L482 , L479);
L488: S5[ ( len C101 ) ] by L487;
thus L489: thesis by L488;
end;
theorem
L490: (for B137 being (Matrix of ( REAL )) holds ( SumAll B137 ) = ( Sum ( ColSum B137 ) ))
proof
let C108 being (Matrix of ( REAL ));
thus L491: ( Sum ( ColSum C108 ) ) = ( SumAll ( C108 @ ) ) by L358
.= ( SumAll C108 ) by L438;
end;
theorem
L492: (for B138 , B139 being (FinSequence of ( REAL )) holds (( len B138 ) = ( len B139 ) implies ( len ( mlt (B138 , B139) ) ) = ( len B138 ))) by FINSEQ_2:72;
theorem
L493: (for R2 being (Element of ( NAT )) holds (for B140 being (Element of ( R2 -tuples_on ( REAL ) )) holds ( mlt (( R2 |-> 1 ) , B140) ) = B140))
proof
let R2 being (Element of ( NAT ));
let C109 being (Element of ( R2 -tuples_on ( REAL ) ));
thus L494: ( mlt (( R2 |-> 1 ) , C109) ) = ( 1 * C109 ) by RVSUM_1:63
.= C109 by RVSUM_1:52;
end;
theorem
L495: (for B141 being (FinSequence of ( REAL )) holds ( mlt (( ( len B141 ) |-> 1 ) , B141) ) = B141)
proof
let C110 being (FinSequence of ( REAL ));
reconsider D28 = C110 as (Element of ( ( len C110 ) -tuples_on ( REAL ) )) by FINSEQ_2:92;
L496: ( mlt (( ( len C110 ) |-> 1 ) , D28) ) = D28 by L493;
thus L497: thesis by L496;
end;
theorem
L498: (for B142 , B143 being (FinSequence of ( REAL )) holds (((for R2 being (Element of ( NAT )) holds (R2 in ( dom B142 ) implies ( B142 . R2 ) >= ( 0 ))) & (for R2 being (Element of ( NAT )) holds (R2 in ( dom B143 ) implies ( B143 . R2 ) >= ( 0 )))) implies (for R4 being (Element of ( NAT )) holds (R4 in ( dom ( mlt (B142 , B143) ) ) implies ( ( mlt (B142 , B143) ) . R4 ) >= ( 0 )))))
proof
L499: (for B144 being (FinSequence of ( REAL )) holds ((for R2 being (Element of ( NAT )) holds (R2 in ( dom B144 ) implies ( B144 . R2 ) >= ( 0 ))) implies (for R2 being (Element of ( NAT )) holds ( B144 . R2 ) >= ( 0 ))))
proof
let C111 being (FinSequence of ( REAL ));
assume that
L500: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C111 ) implies ( C111 . R2 ) >= ( 0 )));
thus L501:now
let R2 being (Element of ( NAT ));
per cases ;
suppose L502: (not R2 in ( dom C111 ));

thus L503: ( C111 . R2 ) >= ( 0 ) by L502 , FUNCT_1:def 2;
end;
suppose L504: R2 in ( dom C111 );

thus L505: ( C111 . R2 ) >= ( 0 ) by L504 , L500;
end;
end;
end;
let C112 , C113 being (FinSequence of ( REAL ));
assume that
L502: ((for R2 being (Element of ( NAT )) holds (R2 in ( dom C112 ) implies ( C112 . R2 ) >= ( 0 ))) & (for R2 being (Element of ( NAT )) holds (R2 in ( dom C113 ) implies ( C113 . R2 ) >= ( 0 ))));
thus L503:now
let R4 being (Element of ( NAT ));
assume L504: R4 in ( dom ( mlt (C112 , C113) ) );
L505: ( ( mlt (C112 , C113) ) . R4 ) = ( ( C112 . R4 ) * ( C113 . R4 ) ) by RVSUM_1:59;
L506: (( C112 . R4 ) >= ( 0 ) & ( C113 . R4 ) >= ( 0 )) by L502 , L499;
thus L507: ( ( mlt (C112 , C113) ) . R4 ) >= ( 0 ) by L506 , L505 , XREAL_1:127;
end;
end;
theorem
L504: (for R2 being (Element of ( NAT )) holds (for B145 , B146 being (Element of ( R2 -tuples_on ( REAL ) )) holds (for B147 , B148 being (Element of ( R2 -tuples_on (the carrier of ( F_Real )) )) holds ((B145 = B147 & B146 = B148) implies ( mlt (B145 , B146) ) = ( mlt (B147 , B148) )))))
proof
let R2 being (Element of ( NAT ));
let C114 , C115 being (Element of ( R2 -tuples_on ( REAL ) ));
let C116 , C117 being (Element of ( R2 -tuples_on (the carrier of ( F_Real )) ));
assume that
L505: (C114 = C116 & C115 = C117);
L506: ( dom ( mlt (C114 , C115) ) ) = ( Seg ( len ( mlt (C114 , C115) ) ) ) by FINSEQ_1:def 3
.= ( Seg R2 ) by CARD_1:def 7
.= ( Seg ( len ( mlt (C116 , C117) ) ) ) by CARD_1:def 7
.= ( dom ( mlt (C116 , C117) ) ) by FINSEQ_1:def 3;
L507: (for B149 being Nat holds (B149 in ( dom ( mlt (C114 , C115) ) ) implies ( ( mlt (C114 , C115) ) . B149 ) = ( ( mlt (C116 , C117) ) . B149 )))
proof
let C118 being Nat;
assume that
L508: C118 in ( dom ( mlt (C114 , C115) ) );
reconsider D29 = ( C114 . C118 ) , D30 = ( C115 . C118 ) as (Element of ( F_Real )) by VECTSP_1:def 5;
thus L509: ( ( mlt (C114 , C115) ) . C118 ) = ( D29 * D30 ) by RVSUM_1:59
.= ( ( mlt (C116 , C117) ) . C118 ) by L505 , L506 , L508 , FVSUM_1:60;
end;
thus L510: thesis by L507 , L506 , FINSEQ_1:13;
end;
theorem
L511: (for B150 , B151 being (FinSequence of ( REAL )) holds (for B152 , B153 being (FinSequence of ( F_Real )) holds ((( len B150 ) = ( len B151 ) & B150 = B152 & B151 = B153) implies ( mlt (B150 , B151) ) = ( mlt (B152 , B153) ))))
proof
let C119 , C120 being (FinSequence of ( REAL ));
let C121 , C122 being (FinSequence of ( F_Real ));
assume that
L512: ( len C119 ) = ( len C120 )
and
L513: C119 = C121
and
L514: C120 = C122;
set D31 = ( len C119 );
set D32 = { B154 where B154 is (Element of ( (the carrier of ( F_Real )) * )) : ( len B154 ) = D31 };
L515: C121 is (Element of ( (the carrier of ( F_Real )) * )) by FINSEQ_1:def 11;
L516: C121 in D32 by L515 , L513;
reconsider D33 = C121 as (Element of ( D31 -tuples_on (the carrier of ( F_Real )) )) by L516;
L517: C122 is (Element of ( (the carrier of ( F_Real )) * )) by FINSEQ_1:def 11;
L518: C122 in D32 by L517 , L512 , L514;
reconsider D34 = C122 as (Element of ( D31 -tuples_on (the carrier of ( F_Real )) )) by L518;
set D35 = { B155 where B155 is (Element of ( ( REAL ) * )) : ( len B155 ) = D31 };
L519: C120 is (Element of ( ( REAL ) * )) by FINSEQ_1:def 11;
L520: C120 in D35 by L519 , L512;
reconsider D36 = C120 as (Element of ( D31 -tuples_on ( REAL ) )) by L520;
reconsider D37 = C119 as (Element of ( D31 -tuples_on ( REAL ) )) by FINSEQ_2:92;
L521: ( mlt (D37 , D36) ) = ( mlt (D33 , D34) ) by L513 , L514 , L504;
thus L522: thesis by L521;
end;
theorem
L523: (for B156 being (FinSequence of ( REAL )) holds (for B157 being (FinSequence of ( F_Real )) holds (B156 = B157 implies ( Sum B156 ) = ( Sum B157 ))))
proof
let C123 being (FinSequence of ( REAL ));
let C124 being (FinSequence of ( F_Real ));
assume that
L524: C123 = C124;
consider C125 being (Function of ( NAT ) , ( REAL )) such that L525: ( C125 . ( 0 ) ) = ( 0 ) and L526: (for B158 being Nat holds (B158 < ( len C123 ) implies ( C125 . ( B158 + 1 ) ) = ( ( C125 . B158 ) + ( C123 . ( B158 + 1 ) ) ))) and L527: ( Sum C123 ) = ( C125 . ( len C123 ) ) by L136;
consider C126 being (Function of ( NAT ) , (the carrier of ( F_Real ))) such that L528: ( Sum C124 ) = ( C126 . ( len C124 ) ) and L529: ( C126 . ( 0 ) ) = ( 0. ( F_Real ) ) and L530: (for R3 being (Element of ( NAT )) holds (for B159 being (Element of ( F_Real )) holds ((R3 < ( len C124 ) & B159 = ( C124 . ( R3 + 1 ) )) implies ( C126 . ( R3 + 1 ) ) = ( ( C126 . R3 ) + B159 )))) by RLVECT_1:def 12;
L531: (for R5 being Nat holds (R5 <= ( len C123 ) implies ( C125 . R5 ) = ( C126 . R5 )))
proof
defpred S7[ Nat ] means ($1 <= ( len C123 ) implies ( C125 . $1 ) = ( C126 . $1 ));
let R5 being Nat;
L532:
now
let C127 being Nat;
assume that
L533: S7[ C127 ];
L534:
now
reconsider D38 = C127 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D39 = ( C123 . ( C127 + 1 ) ) as (Element of ( F_Real )) by VECTSP_1:def 5;
assume L535: ( C127 + 1 ) <= ( len C123 );
L536: C127 < ( len C123 ) by L535 , NAT_1:13;
L537: ( C125 . ( C127 + 1 ) ) = ( ( C126 . D38 ) + D39 ) by L536 , L526 , L533
.= ( C126 . ( C127 + 1 ) ) by L524 , L530 , L536;
thus L538: ( C125 . ( C127 + 1 ) ) = ( C126 . ( C127 + 1 ) ) by L537;
end;
thus L539: S7[ ( C127 + 1 ) ] by L534;
end;
L540: S7[ ( 0 ) ] by L525 , L529 , STRUCT_0:def 6 , VECTSP_1:def 5;
L541: (for B160 being Nat holds S7[ B160 ]) from NAT_1:sch 2(L540 , L532);
thus L542: thesis by L541;
end;
thus L543: thesis by L531 , L524 , L527 , L528;
end;
notation
let C128 , C129 being (FinSequence of ( REAL ));
synonym C128 "*" C129 for |(C128 , C129 )|;
end;
theorem
L545: (for R2 being (Element of ( NAT )) holds (for B161 , B162 being (Element of ( R2 -tuples_on ( REAL ) )) holds (for B163 , B164 being (Element of ( R2 -tuples_on (the carrier of ( F_Real )) )) holds ((B161 = B163 & B162 = B164) implies ( B161 "*" B162 ) = ( B163 "*" B164 )))))
proof
let R2 being (Element of ( NAT ));
let C130 , C131 being (Element of ( R2 -tuples_on ( REAL ) ));
let C132 , C133 being (Element of ( R2 -tuples_on (the carrier of ( F_Real )) ));
assume L546: (C130 = C132 & C131 = C133);
thus L547: ( C130 "*" C131 ) = ( Sum ( mlt (C132 , C133) ) ) by L546 , L504 , L523
.= ( C132 "*" C133 ) by FVSUM_1:def 9;
end;
theorem
L548: (for B165 , B166 being (FinSequence of ( REAL )) holds (for B167 , B168 being (FinSequence of ( F_Real )) holds ((( len B165 ) = ( len B166 ) & B165 = B167 & B166 = B168) implies ( B165 "*" B166 ) = ( B167 "*" B168 ))))
proof
let C134 , C135 being (FinSequence of ( REAL ));
let C136 , C137 being (FinSequence of ( F_Real ));
assume L549: (( len C134 ) = ( len C135 ) & C134 = C136 & C135 = C137);
thus L550: ( C134 "*" C135 ) = ( Sum ( mlt (C136 , C137) ) ) by L549 , L511 , L523
.= ( C136 "*" C137 ) by FVSUM_1:def 9;
end;
theorem
L551: (for B169 , B170 , B171 being (Matrix of ( REAL )) holds (( width B170 ) = ( len B171 ) implies (B169 = ( B170 * B171 ) iff (( len B169 ) = ( len B170 ) & ( width B169 ) = ( width B171 ) & (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B169 ) implies ( B169 * (R2 , R3) ) = ( ( Line (B170 , R2) ) "*" ( Col (B171 , R3) ) ))))))))
proof
let C138 , C139 , C140 being (Matrix of ( REAL ));
assume that
L552: ( width C139 ) = ( len C140 );
set D40 = ( MXR2MXF C138 );
set D41 = ( MXR2MXF C140 );
set D42 = ( MXR2MXF C139 );
L553: D42 = C139 by MATRIXR1:def 1;
L554: D41 = C140 by MATRIXR1:def 1;
L555: ( MXF2MXR ( D42 * D41 ) ) = ( C139 * C140 ) by MATRIXR1:def 6;
L556: ( D42 * D41 ) = ( C139 * C140 ) by L555 , MATRIXR1:def 2;
thus L557:now
assume L558: C138 = ( C139 * C140 );
thus L559: ( len C138 ) = ( len C139 ) by L558 , L552 , L553 , L554 , L556 , MATRIX_3:def 4;
thus L560: ( width C138 ) = ( width C140 ) by L552 , L553 , L554 , L556 , L558 , MATRIX_3:def 4;
thus L561: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C138 ) implies ( C138 * (R2 , R3) ) = ( ( Line (C139 , R2) ) "*" ( Col (C140 , R3) ) ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L562: [ R2 , R3 ] in ( Indices C138 );
L563: R3 in ( Seg ( width C140 ) ) by L560 , L562 , L204;
L564: ( Col (D41 , R3) ) = ( Col (C140 , R3) ) by L563 , L554 , L248;
L565: R2 in ( Seg ( len C139 ) ) by L559 , L562 , L204;
L566: R2 in ( dom C139 ) by L565 , FINSEQ_1:def 3;
L567: ( Line (D42 , R2) ) = ( Line (C139 , R2) ) by L566 , L553 , L245;
L568: ( len ( Line (C139 , R2) ) ) = ( width C139 ) by MATRIX_1:def 7
.= ( len ( Col (C140 , R3) ) ) by L552 , MATRIX_1:def 8;
L569: C138 = ( MXF2MXR ( D42 * D41 ) ) by L558 , MATRIXR1:def 6;
L570: ([ R2 , R3 ] in ( Indices ( D42 * D41 ) ) & ( C138 * (R2 , R3) ) = ( ( D42 * D41 ) * (R2 , R3) )) by L569 , L562 , MATRIXR1:23 , MATRIXR1:def 2;
thus L571: ( C138 * (R2 , R3) ) = ( ( Line (D42 , R2) ) "*" ( Col (D41 , R3) ) ) by L570 , L552 , L553 , L554 , MATRIX_3:def 4
.= ( ( Line (C139 , R2) ) "*" ( Col (C140 , R3) ) ) by L567 , L564 , L568 , L548;
end;

end;
assume that
L562: ( len C138 ) = ( len C139 )
and
L563: ( width C138 ) = ( width C140 )
and
L564: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C138 ) implies ( C138 * (R2 , R3) ) = ( ( Line (C139 , R2) ) "*" ( Col (C140 , R3) ) ))));
L565: ( width D40 ) = ( width C138 ) by MATRIXR1:def 1
.= ( width D41 ) by L563 , MATRIXR1:def 1;
L566: ( len D40 ) = ( len C138 ) by MATRIXR1:def 1
.= ( len D42 ) by L562 , MATRIXR1:def 1;
L567: (for B172 , B173 being Nat holds ([ B172 , B173 ] in ( Indices D40 ) implies ( D40 * (B172 , B173) ) = ( ( Line (D42 , B172) ) "*" ( Col (D41 , B173) ) )))
proof
let C141 , C142 being Nat;
assume that
L568: [ C141 , C142 ] in ( Indices D40 );
L569: (C141 in ( NAT ) & C142 in ( NAT )) by ORDINAL1:def 12;
L570: C142 in ( Seg ( width D41 ) ) by L569 , L565 , L568 , L204;
L571: ( Col (D41 , C142) ) = ( Col (C140 , C142) ) by L570 , L248 , MATRIXR1:def 1;
L572: C141 in ( Seg ( len D42 ) ) by L566 , L568 , L569 , L204;
L573: C141 in ( dom D42 ) by L572 , FINSEQ_1:def 3;
L574: ( Line (D42 , C141) ) = ( Line (C139 , C141) ) by L573 , L245 , MATRIXR1:def 1;
L575: ( len ( Line (C139 , C141) ) ) = ( width C139 ) by MATRIX_1:def 7
.= ( len ( Col (C140 , C142) ) ) by L552 , MATRIX_1:def 8;
L576: ([ C141 , C142 ] in ( Indices C138 ) & ( D40 * (C141 , C142) ) = ( C138 * (C141 , C142) )) by L568 , MATRIXR1:23 , MATRIXR1:def 1;
thus L577: ( D40 * (C141 , C142) ) = ( ( Line (C139 , C141) ) "*" ( Col (C140 , C142) ) ) by L576 , L564 , L569
.= ( ( Line (D42 , C141) ) "*" ( Col (D41 , C142) ) ) by L574 , L571 , L575 , L548;
end;
L578: (D40 = C138 & D40 = ( D42 * D41 )) by L567 , L552 , L553 , L554 , L566 , L565 , MATRIXR1:def 1 , MATRIX_3:def 4;
L579: C138 = ( MXF2MXR ( D42 * D41 ) ) by L578 , MATRIXR1:def 2;
thus L580: thesis by L579 , MATRIXR1:def 6;
end;
theorem
L581: (for B174 being (Matrix of ( REAL )) holds (for B175 being (FinSequence of ( REAL )) holds (( len B174 ) = ( len B175 ) implies (for R2 being (Element of ( NAT )) holds (R2 in ( Seg ( len ( B175 * B174 ) ) ) implies ( ( B175 * B174 ) . R2 ) = ( B175 "*" ( Col (B174 , R2) ) ))))))
proof
let C143 being (Matrix of ( REAL ));
let C144 being (FinSequence of ( REAL ));
assume that
L582: ( len C143 ) = ( len C144 );
L583: ( len ( C144 * C143 ) ) = ( len ( Line (( ( LineVec2Mx C144 ) * C143 ) , 1) ) ) by MATRIXR1:def 12
.= ( width ( ( LineVec2Mx C144 ) * C143 ) ) by MATRIX_1:def 7;
thus L584:now
let R2 being (Element of ( NAT ));
assume that
L585: R2 in ( Seg ( len ( C144 * C143 ) ) );
L586: ( width ( LineVec2Mx C144 ) ) = ( len C143 ) by L582 , MATRIXR1:def 10;
L587: ( len ( ( LineVec2Mx C144 ) * C143 ) ) = ( len ( LineVec2Mx C144 ) ) by L586 , L551;
L588: ( len ( ( LineVec2Mx C144 ) * C143 ) ) = 1 by L587 , MATRIXR1:48;
L589: 1 in ( Seg ( len ( ( LineVec2Mx C144 ) * C143 ) ) ) by L588 , FINSEQ_1:1;
L590: [ 1 , R2 ] in ( Indices ( ( LineVec2Mx C144 ) * C143 ) ) by L589 , L583 , L585 , L204;
L591: ( ( ( LineVec2Mx C144 ) * C143 ) * (1 , R2) ) = ( ( Line (( LineVec2Mx C144 ) , 1) ) "*" ( Col (C143 , R2) ) ) by L590 , L586 , L551
.= ( C144 "*" ( Col (C143 , R2) ) ) by MATRIXR1:48;
L592: ( ( Line (( ( LineVec2Mx C144 ) * C143 ) , 1) ) . R2 ) = ( ( ( LineVec2Mx C144 ) * C143 ) * (1 , R2) ) by L583 , L585 , MATRIX_1:def 7;
thus L593: ( C144 "*" ( Col (C143 , R2) ) ) = ( ( C144 * C143 ) . R2 ) by L592 , L591 , MATRIXR1:def 12;
end;
end;
theorem
L585: (for B176 being (Matrix of ( REAL )) holds (for B177 being (FinSequence of ( REAL )) holds ((( width B176 ) = ( len B177 ) & ( width B176 ) > ( 0 )) implies (for R2 being (Element of ( NAT )) holds (R2 in ( Seg ( len ( B176 * B177 ) ) ) implies ( ( B176 * B177 ) . R2 ) = ( ( Line (B176 , R2) ) "*" B177 ))))))
proof
let C145 being (Matrix of ( REAL ));
let C146 being (FinSequence of ( REAL ));
assume that
L586: (( width C145 ) = ( len C146 ) & ( width C145 ) > ( 0 ));
L587: ( len ( C145 * C146 ) ) = ( len ( Col (( C145 * ( ColVec2Mx C146 ) ) , 1) ) ) by MATRIXR1:def 11
.= ( len ( C145 * ( ColVec2Mx C146 ) ) ) by MATRIX_1:def 8;
thus L588:now
let R2 being (Element of ( NAT ));
assume that
L589: R2 in ( Seg ( len ( C145 * C146 ) ) );
L590: R2 in ( dom ( C145 * ( ColVec2Mx C146 ) ) ) by L587 , L589 , FINSEQ_1:def 3;
L591: ( ( Col (( C145 * ( ColVec2Mx C146 ) ) , 1) ) . R2 ) = ( ( C145 * ( ColVec2Mx C146 ) ) * (R2 , 1) ) by L590 , MATRIX_1:def 8;
L592: ( len ( ColVec2Mx C146 ) ) = ( width C145 ) by L586 , MATRIXR1:def 9;
L593: ( width ( C145 * ( ColVec2Mx C146 ) ) ) = ( width ( ColVec2Mx C146 ) ) by L592 , L551;
L594: ( width ( C145 * ( ColVec2Mx C146 ) ) ) = 1 by L593 , L586 , MATRIXR1:def 9;
L595: 1 in ( Seg ( width ( C145 * ( ColVec2Mx C146 ) ) ) ) by L594 , FINSEQ_1:1;
L596: [ R2 , 1 ] in ( Indices ( C145 * ( ColVec2Mx C146 ) ) ) by L595 , L587 , L589 , L204;
L597: ( ( C145 * ( ColVec2Mx C146 ) ) * (R2 , 1) ) = ( ( Line (C145 , R2) ) "*" ( Col (( ColVec2Mx C146 ) , 1) ) ) by L596 , L592 , L551
.= ( ( Line (C145 , R2) ) "*" C146 ) by L586 , MATRIXR1:45;
thus L598: ( ( Line (C145 , R2) ) "*" C146 ) = ( ( C145 * C146 ) . R2 ) by L597 , L591 , MATRIXR1:def 11;
end;
end;
theorem
L589: (for B178 , B179 , B180 being (Matrix of ( REAL )) holds (( width B179 ) = ( len B180 ) implies (B178 = ( B179 * B180 ) iff (( len B178 ) = ( len B179 ) & ( width B178 ) = ( width B180 ) & (for R2 being (Element of ( NAT )) holds (R2 in ( Seg ( len B178 ) ) implies ( Line (B178 , R2) ) = ( ( Line (B179 , R2) ) * B180 )))))))
proof
let C147 , C148 , C149 being (Matrix of ( REAL ));
assume that
L590: ( width C148 ) = ( len C149 );
thus L591:now
assume L592: C147 = ( C148 * C149 );
thus L593: (( len C147 ) = ( len C148 ) & ( width C147 ) = ( width C149 )) by L592 , L590 , L551;
thus L594: (for R2 being (Element of ( NAT )) holds (R2 in ( Seg ( len C147 ) ) implies ( Line (C147 , R2) ) = ( ( Line (C148 , R2) ) * C149 )))
proof
let R2 being (Element of ( NAT ));
assume that
L595: R2 in ( Seg ( len C147 ) );
L596: ( len ( Line (C148 , R2) ) ) = ( len C149 ) by L590 , MATRIX_1:def 7;
L597: ( len ( ( Line (C148 , R2) ) * C149 ) ) = ( width C149 ) by L596 , MATRIXR1:62;
L598: ( len ( Line (C147 , R2) ) ) = ( width C147 ) by MATRIX_1:def 7;
L599: ( dom ( Line (C147 , R2) ) ) = ( Seg ( width C149 ) ) by L598 , L593 , FINSEQ_1:def 3
.= ( dom ( ( Line (C148 , R2) ) * C149 ) ) by L597 , FINSEQ_1:def 3;
L600: R2 in ( dom C147 ) by L595 , FINSEQ_1:def 3;
L601: (for B181 being Nat holds (B181 in ( dom ( Line (C147 , R2) ) ) implies ( ( Line (C147 , R2) ) . B181 ) = ( ( ( Line (C148 , R2) ) * C149 ) . B181 )))
proof
let C150 being Nat;
assume that
L602: C150 in ( dom ( Line (C147 , R2) ) );
L603: C150 in ( Seg ( len ( ( Line (C148 , R2) ) * C149 ) ) ) by L599 , L602 , FINSEQ_1:def 3;
L604: C150 in ( Seg ( len ( Line (C147 , R2) ) ) ) by L602 , FINSEQ_1:def 3;
L605: C150 in ( Seg ( width C147 ) ) by L604 , MATRIX_1:def 7;
L606: [ R2 , C150 ] in ( Indices C147 ) by L605 , L595 , L204;
thus L607: ( ( Line (C147 , R2) ) . C150 ) = ( ( C147 . R2 ) . C150 ) by L600 , MATRIX_2:16
.= ( C147 * (R2 , C150) ) by L606 , MATRIX_1:def 5
.= ( ( Line (C148 , R2) ) "*" ( Col (C149 , C150) ) ) by L590 , L592 , L602 , L606 , L551
.= ( ( ( Line (C148 , R2) ) * C149 ) . C150 ) by L596 , L603 , L581;
end;
thus L608: thesis by L601 , L599 , FINSEQ_1:13;
end;

end;
assume that
L595: ( len C147 ) = ( len C148 )
and
L596: ( width C147 ) = ( width C149 )
and
L597: (for R2 being (Element of ( NAT )) holds (R2 in ( Seg ( len C147 ) ) implies ( Line (C147 , R2) ) = ( ( Line (C148 , R2) ) * C149 )));
L598: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C147 ) implies ( C147 * (R2 , R3) ) = ( ( Line (C148 , R2) ) "*" ( Col (C149 , R3) ) ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L599: [ R2 , R3 ] in ( Indices C147 );
L600: R2 in ( Seg ( len C147 ) ) by L599 , L204;
L601: R2 in ( dom C147 ) by L600 , FINSEQ_1:def 3;
L602: ( len ( Line (C148 , R2) ) ) = ( len C149 ) by L590 , MATRIX_1:def 7;
L603: R3 in ( Seg ( width C147 ) ) by L599 , L204;
L604: R3 in ( Seg ( len ( ( Line (C148 , R2) ) * C149 ) ) ) by L603 , L596 , L602 , MATRIXR1:62;
thus L605: ( C147 * (R2 , R3) ) = ( ( C147 . R2 ) . R3 ) by L599 , MATRIX_1:def 5
.= ( ( Line (C147 , R2) ) . R3 ) by L601 , MATRIX_2:16
.= ( ( ( Line (C148 , R2) ) * C149 ) . R3 ) by L597 , L600
.= ( ( Line (C148 , R2) ) "*" ( Col (C149 , R3) ) ) by L602 , L604 , L581;
end;
thus L606: thesis by L598 , L590 , L595 , L596 , L551;
end;
definition
let C151 , C152 being (FinSequence of ( REAL ));
let C153 being (Matrix of ( REAL ));
assume that
L607: ( len C151 ) = ( len C153 )
and
L608: ( len C152 ) = ( width C153 );
func QuadraticForm (C151 , C153 , C152) -> (Matrix of ( REAL )) means 
:L609: (( len it ) = ( len C151 ) & ( width it ) = ( len C152 ) & (for B182 , B183 being Nat holds ([ B182 , B183 ] in ( Indices C153 ) implies ( it * (B182 , B183) ) = ( ( ( C151 . B182 ) * ( C153 * (B182 , B183) ) ) * ( C152 . B183 ) ))));
existence
proof
deffunc H5(Nat , Nat) = ( ( ( C151 . $1 ) * ( C153 * ($1 , $2) ) ) * ( C152 . $2 ) );
consider C154 being (Matrix of ( len C153 ) , ( width C153 ) , ( REAL )) such that L610: (for B184 , B185 being Nat holds ([ B184 , B185 ] in ( Indices C154 ) implies ( C154 * (B184 , B185) ) = H5(B184 , B185))) from MATRIX_1:sch 1;
take C154;
L611: ( len C154 ) = ( len C151 ) by L607 , MATRIX_1:def 2;
L612:
now
per cases ;
case L613: ( len C153 ) = ( 0 );
L614: ( width C154 ) = ( 0 ) by L613 , L607 , L611 , MATRIX_1:def 3;
thus L615: ( width C154 ) = ( len C152 ) by L614 , L608 , L613 , MATRIX_1:def 3;
end;
case L616: ( len C153 ) > ( 0 );
thus L617: ( width C154 ) = ( len C152 ) by L616 , L608 , MATRIX_1:23;
end;
end;
L619: ( Indices C153 ) = [: ( dom C153 ) , ( Seg ( width C153 ) ) :] by MATRIX_1:def 4;
L620: ( dom C153 ) = ( dom C154 ) by L607 , L611 , FINSEQ_3:29;
L621: ( Indices C154 ) = [: ( dom C153 ) , ( Seg ( width C153 ) ) :] by L620 , L608 , L612 , MATRIX_1:def 4;
thus L622: thesis by L621 , L607 , L610 , L612 , L619 , MATRIX_1:def 2;
end;
uniqueness
proof
let C155 , C156 being (Matrix of ( REAL ));
assume that
L623: ( len C155 ) = ( len C151 )
and
L624: ( width C155 ) = ( len C152 )
and
L625: (for B186 , B187 being Nat holds ([ B186 , B187 ] in ( Indices C153 ) implies ( C155 * (B186 , B187) ) = ( ( ( C151 . B186 ) * ( C153 * (B186 , B187) ) ) * ( C152 . B187 ) )))
and
L626: (( len C156 ) = ( len C151 ) & ( width C156 ) = ( len C152 ))
and
L627: (for B188 , B189 being Nat holds ([ B188 , B189 ] in ( Indices C153 ) implies ( C156 * (B188 , B189) ) = ( ( ( C151 . B188 ) * ( C153 * (B188 , B189) ) ) * ( C152 . B189 ) )));
L628:
now
let C157 , C158 being Nat;
L629: ( Indices C153 ) = [: ( dom C153 ) , ( Seg ( width C153 ) ) :] by MATRIX_1:def 4;
L630: ( dom C155 ) = ( dom C153 ) by L607 , L623 , FINSEQ_3:29;
L631: ( Indices C155 ) = [: ( dom C153 ) , ( Seg ( width C153 ) ) :] by L630 , L608 , L624 , MATRIX_1:def 4;
assume L632: [ C157 , C158 ] in ( Indices C155 );
thus L633: ( C155 * (C157 , C158) ) = ( ( ( C151 . C157 ) * ( C153 * (C157 , C158) ) ) * ( C152 . C158 ) ) by L632 , L625 , L631 , L629
.= ( C156 * (C157 , C158) ) by L627 , L632 , L631 , L629;
end;
thus L634: thesis by L628 , L623 , L624 , L626 , MATRIX_1:21;
end;
end;
theorem
L636: (for B190 , B191 being (FinSequence of ( REAL )) holds (for B192 being (Matrix of ( REAL )) holds ((( len B190 ) = ( len B192 ) & ( len B191 ) = ( width B192 ) & ( len B191 ) > ( 0 )) implies ( ( QuadraticForm (B190 , B192 , B191) ) @ ) = ( QuadraticForm (B191 , ( B192 @ ) , B190) ))))
proof
let C159 , C160 being (FinSequence of ( REAL ));
let C161 being (Matrix of ( REAL ));
assume that
L637: ( len C159 ) = ( len C161 )
and
L638: ( len C160 ) = ( width C161 )
and
L639: ( len C160 ) > ( 0 );
L640: ( len ( C161 @ ) ) = ( len C160 ) by L638 , MATRIX_1:def 6;
L641: ( width ( C161 @ ) ) = ( len C159 ) by L637 , L638 , L639 , MATRIX_2:10;
L642: (( len ( QuadraticForm (C160 , ( C161 @ ) , C159) ) ) = ( len C160 ) & ( width ( QuadraticForm (C160 , ( C161 @ ) , C159) ) ) = ( len C159 )) by L641 , L640 , L609;
L643: ( len ( ( QuadraticForm (C159 , C161 , C160) ) @ ) ) = ( width ( QuadraticForm (C159 , C161 , C160) ) ) by MATRIX_1:def 6;
L644: ( width ( QuadraticForm (C159 , C161 , C160) ) ) = ( len C160 ) by L637 , L638 , L609;
L645: ( width ( ( QuadraticForm (C159 , C161 , C160) ) @ ) ) = ( len ( QuadraticForm (C159 , C161 , C160) ) ) by L644 , L639 , MATRIX_2:10;
L646: (for B193 , B194 being Nat holds ([ B193 , B194 ] in ( Indices ( ( QuadraticForm (C159 , C161 , C160) ) @ ) ) implies ( ( QuadraticForm (C160 , ( C161 @ ) , C159) ) * (B193 , B194) ) = ( ( ( QuadraticForm (C159 , C161 , C160) ) @ ) * (B193 , B194) )))
proof
let C162 , C163 being Nat;
assume L647: [ C162 , C163 ] in ( Indices ( ( QuadraticForm (C159 , C161 , C160) ) @ ) );
reconsider D43 = C162 , D44 = C163 as (Element of ( NAT )) by ORDINAL1:def 12;
L648: 1 <= D44 by L647 , MATRIXC1:1;
L649: D44 <= ( len ( QuadraticForm (C159 , C161 , C160) ) ) by L645 , L647 , MATRIXC1:1;
L650: D44 <= ( len C161 ) by L649 , L637 , L638 , L609;
L651: 1 <= D43 by L647 , MATRIXC1:1;
L652: D43 <= ( width ( QuadraticForm (C159 , C161 , C160) ) ) by L643 , L647 , MATRIXC1:1;
L653: D43 <= ( width C161 ) by L652 , L637 , L638 , L609;
L654: [ D44 , D43 ] in ( Indices C161 ) by L653 , L648 , L651 , L650 , MATRIXC1:1;
L655: D44 <= ( width ( C161 @ ) ) by L637 , L638 , L641 , L649 , L609;
L656: 1 <= D43 by L647 , MATRIXC1:1;
L657: 1 <= D43 by L647 , MATRIXC1:1;
L658: [ D44 , D43 ] in ( Indices ( QuadraticForm (C159 , C161 , C160) ) ) by L657 , L652 , L648 , L649 , MATRIXC1:1;
L659: D43 <= ( len ( C161 @ ) ) by L637 , L638 , L640 , L652 , L609;
L660: [ D43 , D44 ] in ( Indices ( C161 @ ) ) by L659 , L648 , L656 , L655 , MATRIXC1:1;
L661: ( ( QuadraticForm (C160 , ( C161 @ ) , C159) ) * (D43 , D44) ) = ( ( ( C160 . D43 ) * ( ( C161 @ ) * (D43 , D44) ) ) * ( C159 . D44 ) ) by L660 , L640 , L641 , L609
.= ( ( ( C160 . D43 ) * ( C161 * (D44 , D43) ) ) * ( C159 . D44 ) ) by L654 , MATRIX_1:def 6
.= ( ( ( C159 . D44 ) * ( C161 * (D44 , D43) ) ) * ( C160 . D43 ) )
.= ( ( QuadraticForm (C159 , C161 , C160) ) * (D44 , D43) ) by L637 , L638 , L654 , L609
.= ( ( ( QuadraticForm (C159 , C161 , C160) ) @ ) * (D43 , D44) ) by L658 , MATRIX_1:def 6;
thus L662: thesis by L661;
end;
L663: ( len ( ( QuadraticForm (C159 , C161 , C160) ) @ ) ) = ( width ( QuadraticForm (C159 , C161 , C160) ) ) by MATRIX_1:def 6
.= ( len C160 ) by L637 , L638 , L609;
L664: ( width ( ( QuadraticForm (C159 , C161 , C160) ) @ ) ) = ( len ( QuadraticForm (C159 , C161 , C160) ) ) by L639 , L644 , MATRIX_2:10
.= ( len C159 ) by L637 , L638 , L609;
thus L665: thesis by L664 , L663 , L642 , L646 , MATRIX_1:21;
end;
theorem
L666: (for B195 , B196 being (FinSequence of ( REAL )) holds (for B197 being (Matrix of ( REAL )) holds ((( len B195 ) = ( len B197 ) & ( len B196 ) = ( width B197 ) & ( len B196 ) > ( 0 )) implies |( B195 , ( B197 * B196 ) )| = ( SumAll ( QuadraticForm (B195 , B197 , B196) ) ))))
proof
let C164 , C165 being (FinSequence of ( REAL ));
let C166 being (Matrix of ( REAL ));
set D45 = ( QuadraticForm (C164 , C166 , C165) );
assume that
L667: ( len C164 ) = ( len C166 )
and
L668: ( len C165 ) = ( width C166 )
and
L669: ( len C165 ) > ( 0 );
L670: ( width D45 ) = ( len C165 ) by L667 , L668 , L609;
L671: ( len ( LineSum D45 ) ) = ( len D45 ) by L324;
L672: ( len ( C166 * C165 ) ) = ( len C164 ) by L667 , L668 , L669 , MATRIXR1:61;
L673: ( len ( mlt (C164 , ( C166 * C165 )) ) ) = ( len C164 ) by L672 , L492
.= ( len ( LineSum D45 ) ) by L667 , L668 , L671 , L609;
L674: (for B198 being Nat holds ((1 <= B198 & B198 <= ( len ( LineSum D45 ) )) implies ( ( LineSum D45 ) . B198 ) = ( ( mlt (C164 , ( C166 * C165 )) ) . B198 )))
proof
let C167 being Nat;
assume that
L675: 1 <= C167
and
L676: C167 <= ( len ( LineSum D45 ) );
L677: C167 in ( Seg ( len ( LineSum D45 ) ) ) by L675 , L676 , FINSEQ_1:1;
L678: C167 in ( Seg ( len C166 ) ) by L677 , L667 , L668 , L671 , L609;
L679: C167 in ( Seg ( len ( C166 * C165 ) ) ) by L678 , L668 , L669 , MATRIXR1:61;
L680: ( len ( Line (C166 , C167) ) ) = ( len C165 ) by L668 , MATRIX_1:def 7;
L681: C167 <= ( len C166 ) by L678 , FINSEQ_1:1;
L682: (for B199 being Nat holds ((1 <= B199 & B199 <= ( len ( Line (D45 , C167) ) )) implies ( ( ( C164 . C167 ) * ( mlt (( Line (C166 , C167) ) , C165) ) ) . B199 ) = ( ( Line (D45 , C167) ) . B199 )))
proof
let C168 being Nat;
assume that
L683: 1 <= C168
and
L684: C168 <= ( len ( Line (D45 , C167) ) );
L685: C168 <= ( width C166 ) by L668 , L670 , L684 , MATRIX_1:def 7;
L686: [ C167 , C168 ] in ( Indices C166 ) by L685 , L675 , L681 , L683 , MATRIXC1:1;
L687: C168 in ( Seg ( len ( Line (D45 , C167) ) ) ) by L683 , L684 , FINSEQ_1:1;
L688: C168 in ( Seg ( width D45 ) ) by L687 , MATRIX_1:def 7;
thus L689: ( ( ( C164 . C167 ) * ( mlt (( Line (C166 , C167) ) , C165) ) ) . C168 ) = ( ( C164 . C167 ) * ( ( mlt (( Line (C166 , C167) ) , C165) ) . C168 ) ) by RVSUM_1:44
.= ( ( C164 . C167 ) * ( ( ( Line (C166 , C167) ) . C168 ) * ( C165 . C168 ) ) ) by RVSUM_1:59
.= ( ( C164 . C167 ) * ( ( C166 * (C167 , C168) ) * ( C165 . C168 ) ) ) by L668 , L670 , L688 , MATRIX_1:def 7
.= ( ( ( C164 . C167 ) * ( C166 * (C167 , C168) ) ) * ( C165 . C168 ) )
.= ( D45 * (C167 , C168) ) by L667 , L668 , L686 , L609
.= ( ( Line (D45 , C167) ) . C168 ) by L688 , MATRIX_1:def 7;
end;
L690: ( len ( Line (D45 , C167) ) ) = ( len C165 ) by L670 , MATRIX_1:def 7;
L691: ( len ( mlt (( Line (C166 , C167) ) , C165) ) ) = ( len C165 ) by L680 , L492;
L692: ( len ( ( C164 . C167 ) * ( mlt (( Line (C166 , C167) ) , C165) ) ) ) = ( len ( Line (D45 , C167) ) ) by L691 , L690 , RVSUM_1:117;
L693: ( ( C164 . C167 ) * ( mlt (( Line (C166 , C167) ) , C165) ) ) = ( Line (D45 , C167) ) by L692 , L682 , FINSEQ_1:14;
L694: ( ( mlt (C164 , ( C166 * C165 )) ) . C167 ) = ( ( C164 . C167 ) * ( ( C166 * C165 ) . C167 ) ) by RVSUM_1:59
.= ( ( C164 . C167 ) * ( ( Line (C166 , C167) ) "*" C165 ) ) by L668 , L669 , L679 , L585
.= ( Sum ( ( C164 . C167 ) * ( mlt (( Line (C166 , C167) ) , C165) ) ) ) by RVSUM_1:87;
thus L695: thesis by L694 , L671 , L677 , L693 , L324;
end;
thus L696: thesis by L674 , L673 , FINSEQ_1:14;
end;
theorem
L697: (for B200 being (FinSequence of ( REAL )) holds |( B200 , ( ( len B200 ) |-> 1 ) )| = ( Sum B200 )) by L495;
theorem
L698: (for B201 , B202 being (FinSequence of ( REAL )) holds (for B203 being (Matrix of ( REAL )) holds ((( len B201 ) = ( len B203 ) & ( len B202 ) = ( width B203 )) implies |( ( B201 * B203 ) , B202 )| = ( SumAll ( QuadraticForm (B201 , B203 , B202) ) ))))
proof
let C169 , C170 being (FinSequence of ( REAL ));
let C171 being (Matrix of ( REAL ));
set D46 = ( QuadraticForm (C169 , C171 , C170) );
assume that
L699: ( len C169 ) = ( len C171 )
and
L700: ( len C170 ) = ( width C171 );
L701: ( len D46 ) = ( len C169 ) by L699 , L700 , L609;
L702: ( len ( ColSum D46 ) ) = ( width D46 ) by L327;
L703: ( len ( C169 * C171 ) ) = ( len C170 ) by L699 , L700 , MATRIXR1:62;
L704: ( len ( mlt (( C169 * C171 ) , C170) ) ) = ( len C170 ) by L703 , L492
.= ( len ( ColSum D46 ) ) by L699 , L700 , L702 , L609;
L705: (for B204 being Nat holds ((1 <= B204 & B204 <= ( len ( ColSum D46 ) )) implies ( ( ColSum D46 ) . B204 ) = ( ( mlt (( C169 * C171 ) , C170) ) . B204 )))
proof
let C172 being Nat;
assume that
L706: 1 <= C172
and
L707: C172 <= ( len ( ColSum D46 ) );
L708: C172 in ( Seg ( len ( ColSum D46 ) ) ) by L706 , L707 , FINSEQ_1:1;
L709: C172 in ( Seg ( width C171 ) ) by L708 , L699 , L700 , L702 , L609;
L710: C172 in ( Seg ( len ( C169 * C171 ) ) ) by L709 , L699 , MATRIXR1:62;
L711: ( len ( Col (C171 , C172) ) ) = ( len C169 ) by L699 , MATRIX_1:def 8;
L712: C172 <= ( width C171 ) by L709 , FINSEQ_1:1;
L713: (for B205 being Nat holds ((1 <= B205 & B205 <= ( len ( Col (D46 , C172) ) )) implies ( ( ( C170 . C172 ) * ( mlt (C169 , ( Col (C171 , C172) )) ) ) . B205 ) = ( ( Col (D46 , C172) ) . B205 )))
proof
let C173 being Nat;
assume that
L714: 1 <= C173
and
L715: C173 <= ( len ( Col (D46 , C172) ) );
L716: C173 <= ( len C171 ) by L699 , L701 , L715 , MATRIX_1:def 8;
L717: [ C173 , C172 ] in ( Indices C171 ) by L716 , L706 , L712 , L714 , MATRIXC1:1;
L718: C173 in ( Seg ( len ( Col (D46 , C172) ) ) ) by L714 , L715 , FINSEQ_1:1;
L719: C173 in ( Seg ( len D46 ) ) by L718 , MATRIX_1:def 8;
L720: C173 in ( dom D46 ) by L719 , FINSEQ_1:def 3;
L721: C173 in ( dom C171 ) by L699 , L701 , L719 , FINSEQ_1:def 3;
thus L722: ( ( ( C170 . C172 ) * ( mlt (C169 , ( Col (C171 , C172) )) ) ) . C173 ) = ( ( C170 . C172 ) * ( ( mlt (C169 , ( Col (C171 , C172) )) ) . C173 ) ) by RVSUM_1:44
.= ( ( C170 . C172 ) * ( ( C169 . C173 ) * ( ( Col (C171 , C172) ) . C173 ) ) ) by RVSUM_1:59
.= ( ( C170 . C172 ) * ( ( C169 . C173 ) * ( C171 * (C173 , C172) ) ) ) by L721 , MATRIX_1:def 8
.= ( D46 * (C173 , C172) ) by L699 , L700 , L717 , L609
.= ( ( Col (D46 , C172) ) . C173 ) by L720 , MATRIX_1:def 8;
end;
L723: ( len ( Col (D46 , C172) ) ) = ( len C169 ) by L701 , MATRIX_1:def 8;
L724: ( len ( mlt (C169 , ( Col (C171 , C172) )) ) ) = ( len C169 ) by L711 , L492;
L725: ( len ( ( C170 . C172 ) * ( mlt (C169 , ( Col (C171 , C172) )) ) ) ) = ( len ( Col (D46 , C172) ) ) by L724 , L723 , RVSUM_1:117;
L726: ( ( C170 . C172 ) * ( mlt (C169 , ( Col (C171 , C172) )) ) ) = ( Col (D46 , C172) ) by L725 , L713 , FINSEQ_1:14;
L727: ( ( mlt (( C169 * C171 ) , C170) ) . C172 ) = ( ( ( C169 * C171 ) . C172 ) * ( C170 . C172 ) ) by RVSUM_1:59
.= ( ( C169 "*" ( Col (C171 , C172) ) ) * ( C170 . C172 ) ) by L699 , L710 , L581
.= ( Sum ( ( C170 . C172 ) * ( mlt (C169 , ( Col (C171 , C172) )) ) ) ) by RVSUM_1:87;
thus L728: thesis by L727 , L702 , L708 , L726 , L327;
end;
thus L729: |( ( C169 * C171 ) , C170 )| = ( Sum ( ColSum D46 ) ) by L705 , L704 , FINSEQ_1:14
.= ( SumAll D46 ) by L490;
end;
theorem
L730: (for B206 , B207 being (FinSequence of ( REAL )) holds (for B208 being (Matrix of ( REAL )) holds ((( len B206 ) = ( len B208 ) & ( len B207 ) = ( width B208 ) & ( len B207 ) > ( 0 )) implies |( ( B206 * B208 ) , B207 )| = |( B206 , ( B208 * B207 ) )|)))
proof
let C174 , C175 being (FinSequence of ( REAL ));
let C176 being (Matrix of ( REAL ));
assume that
L731: (( len C174 ) = ( len C176 ) & ( len C175 ) = ( width C176 ))
and
L732: ( len C175 ) > ( 0 );
thus L733: |( ( C174 * C176 ) , C175 )| = ( SumAll ( QuadraticForm (C174 , C176 , C175) ) ) by L731 , L698
.= |( C174 , ( C176 * C175 ) )| by L731 , L732 , L666;
end;
theorem
L734: (for B209 , B210 being (FinSequence of ( REAL )) holds (for B211 being (Matrix of ( REAL )) holds ((( len B210 ) = ( len B211 ) & ( len B209 ) = ( width B211 ) & ( len B209 ) > ( 0 ) & ( len B210 ) > ( 0 )) implies |( ( B211 * B209 ) , B210 )| = |( B209 , ( ( B211 @ ) * B210 ) )|)))
proof
let C177 , C178 being (FinSequence of ( REAL ));
let C179 being (Matrix of ( REAL ));
assume that
L735: ( len C178 ) = ( len C179 )
and
L736: ( len C177 ) = ( width C179 )
and
L737: ( len C177 ) > ( 0 )
and
L738: ( len C178 ) > ( 0 );
L739: (( len ( C179 @ ) ) = ( width C179 ) & ( width ( C179 @ ) ) = ( len C179 )) by L736 , L737 , MATRIX_2:10;
thus L740: |( ( C179 * C177 ) , C178 )| = |( ( C177 * ( C179 @ ) ) , C178 )| by L735 , L736 , L737 , L738 , MATRIXR1:53
.= |( C177 , ( ( C179 @ ) * C178 ) )| by L735 , L736 , L738 , L739 , L730;
end;
theorem
L741: (for B212 , B213 being (FinSequence of ( REAL )) holds (for B214 being (Matrix of ( REAL )) holds ((( len B213 ) = ( len B214 ) & ( len B212 ) = ( width B214 ) & ( len B212 ) > ( 0 ) & ( len B213 ) > ( 0 )) implies |( B212 , ( B213 * B214 ) )| = |( ( B212 * ( B214 @ ) ) , B213 )|)))
proof
let C180 , C181 being (FinSequence of ( REAL ));
let C182 being (Matrix of ( REAL ));
assume that
L742: ( len C181 ) = ( len C182 )
and
L743: ( len C180 ) = ( width C182 )
and
L744: ( len C180 ) > ( 0 )
and
L745: ( len C181 ) > ( 0 );
L746: (( len ( C182 @ ) ) = ( width C182 ) & ( width ( C182 @ ) ) = ( len C182 )) by L743 , L744 , MATRIX_2:10;
thus L747: |( C180 , ( C181 * C182 ) )| = |( C180 , ( ( C182 @ ) * C181 ) )| by L742 , L743 , L744 , L745 , MATRIXR1:52
.= |( ( C180 * ( C182 @ ) ) , C181 )| by L742 , L743 , L745 , L746 , L730;
end;
theorem
L748: (for B215 being (FinSequence of ( REAL )) holds (for B216 being (Matrix of ( REAL )) holds ((( len B215 ) = ( len B216 ) & B215 = ( ( len B215 ) |-> 1 )) implies (for R4 being (Element of ( NAT )) holds (R4 in ( Seg ( len ( B215 * B216 ) ) ) implies ( ( B215 * B216 ) . R4 ) = ( Sum ( Col (B216 , R4) ) ))))))
proof
let C183 being (FinSequence of ( REAL ));
let C184 being (Matrix of ( REAL ));
assume that
L749: ( len C183 ) = ( len C184 )
and
L750: C183 = ( ( len C183 ) |-> 1 );
thus L751:now
let R4 being (Element of ( NAT ));
assume that
L752: R4 in ( Seg ( len ( C183 * C184 ) ) );
L753: ( len ( Col (C184 , R4) ) ) = ( len C183 ) by L749 , MATRIX_1:def 8;
thus L754: ( ( C183 * C184 ) . R4 ) = ( C183 "*" ( Col (C184 , R4) ) ) by L749 , L752 , L581
.= ( Sum ( Col (C184 , R4) ) ) by L750 , L753 , L495;
end;
end;
theorem
L752: (for B217 being (FinSequence of ( REAL )) holds (for B218 being (Matrix of ( REAL )) holds ((( len B217 ) = ( width B218 ) & ( width B218 ) > ( 0 ) & B217 = ( ( len B217 ) |-> 1 )) implies (for R4 being (Element of ( NAT )) holds (R4 in ( Seg ( len ( B218 * B217 ) ) ) implies ( ( B218 * B217 ) . R4 ) = ( Sum ( Line (B218 , R4) ) ))))))
proof
let C185 being (FinSequence of ( REAL ));
let C186 being (Matrix of ( REAL ));
assume that
L753: ( len C185 ) = ( width C186 )
and
L754: ( width C186 ) > ( 0 )
and
L755: C185 = ( ( len C185 ) |-> 1 );
thus L756:now
let R4 being (Element of ( NAT ));
assume that
L757: R4 in ( Seg ( len ( C186 * C185 ) ) );
L758: ( len ( Line (C186 , R4) ) ) = ( len C185 ) by L753 , MATRIX_1:def 7;
thus L759: ( ( C186 * C185 ) . R4 ) = ( ( Line (C186 , R4) ) "*" C185 ) by L753 , L754 , L757 , L585
.= ( Sum ( Line (C186 , R4) ) ) by L755 , L758 , L495;
end;
end;
theorem
L757: (for B219 being non  empty Nat holds (ex B220 being (FinSequence of ( REAL )) st (( len B220 ) = B219 & (for R2 being (Element of ( NAT )) holds (R2 in ( dom B220 ) implies ( B220 . R2 ) >= ( 0 ))) & ( Sum B220 ) = 1)))
proof
let C187 being non  empty Nat;
reconsider D47 = C187 as non  empty (Element of ( NAT )) by ORDINAL1:def 12;
consider R8 being (FinSequence of ( REAL )) such that L758: ( len R8 ) = D47 and L759: (for B221 being Nat holds (B221 in ( Seg D47 ) implies ((B221 in ( Seg 1 ) implies ( R8 . B221 ) = 1) & ((not B221 in ( Seg 1 )) implies ( R8 . B221 ) = ( 0 ))))) by L27;
L760: D47 >= 1 by NAT_1:14;
L761: ( Sum R8 ) = 1
proof
consider C188 being Real_Sequence such that L762: ( C188 . 1 ) = ( R8 . 1 ) and L763: (for B222 being Nat holds ((( 0 ) <> B222 & B222 < ( len R8 )) implies ( C188 . ( B222 + 1 ) ) = ( ( C188 . B222 ) + ( R8 . ( B222 + 1 ) ) ))) and L764: ( Sum R8 ) = ( C188 . ( len R8 ) ) by L758 , NAT_1:14 , PROB_3:63;
L765: (for R5 being Nat holds ((R5 <> ( 0 ) & R5 <= ( len R8 )) implies ( C188 . R5 ) = 1))
proof
defpred S8[ Nat ] means (($1 <> ( 0 ) & $1 <= ( len R8 )) implies ( C188 . $1 ) = 1);
L766:
now
let C189 being Nat;
assume that
L767: S8[ C189 ];
L768:
now
assume that
L769: ( C189 + 1 ) <> ( 0 )
and
L770: ( C189 + 1 ) <= ( len R8 );
per cases  by L770 , NAT_1:13;
suppose L771: (C189 = ( 0 ) & C189 < ( len R8 ));

L772: (1 in ( Seg 1 ) & 1 in ( Seg D47 )) by L760 , FINSEQ_1:1;
thus L773: ( C188 . ( C189 + 1 ) ) = 1 by L772 , L759 , L762 , L771;
end;
suppose L774: (C189 > ( 0 ) & C189 < ( len R8 ));

L775: C189 >= 1 by L774 , NAT_1:14;
L776: ( C189 + 1 ) > 1 by L775 , NAT_1:13;
L777: (( C189 + 1 ) in ( Seg D47 ) & (not ( C189 + 1 ) in ( Seg 1 ))) by L776 , L758 , L770 , FINSEQ_1:1;
thus L778: ( C188 . ( C189 + 1 ) ) = ( 1 + ( R8 . ( C189 + 1 ) ) ) by L763 , L767 , L774
.= ( 1 + ( 0 ) ) by L759 , L777
.= 1;
end;
end;
thus L780: S8[ ( C189 + 1 ) ] by L768;
end;
L781: S8[ ( 0 ) ];
L782: (for R5 being Nat holds S8[ R5 ]) from NAT_1:sch 2(L781 , L766);
thus L783: thesis by L782;
end;
thus L784: thesis by L765 , L758 , L764;
end;
take R8;
L785: (for R2 being (Element of ( NAT )) holds (R2 in ( dom R8 ) implies ( R8 . R2 ) >= ( 0 )))
proof
let R2 being (Element of ( NAT ));
assume L786: R2 in ( dom R8 );
L787: R2 in ( Seg D47 ) by L786 , L758 , FINSEQ_1:def 3;
thus L788: thesis by L787 , L759;
end;
thus L789: thesis by L785 , L758 , L761;
end;
definition
let C190 being (FinSequence of ( REAL ));
attr C190 is  ProbFinS
means
:L790: ((for R2 being (Element of ( NAT )) holds (R2 in ( dom C190 ) implies ( C190 . R2 ) >= ( 0 ))) & ( Sum C190 ) = 1);
end;
registration
cluster non  empty  ProbFinS for (FinSequence of ( REAL ));
existence
proof
set D48 = 1;
consider C191 being (FinSequence of ( REAL )) such that L792: (( len C191 ) = D48 & (for R2 being (Element of ( NAT )) holds (R2 in ( dom C191 ) implies ( C191 . R2 ) >= ( 0 ))) & ( Sum C191 ) = 1) by L757;
take C191;
thus L793: thesis by L792 , L790;
end;
end;
theorem
L795: (for B223 being non  empty  ProbFinS (FinSequence of ( REAL )) holds (for R4 being (Element of ( NAT )) holds (R4 in ( dom B223 ) implies ( B223 . R4 ) <= 1)))
proof
let C192 being non  empty  ProbFinS (FinSequence of ( REAL ));
L796: (( Sum C192 ) = 1 & (for B224 being Nat holds (B224 in ( dom C192 ) implies ( C192 . B224 ) >= ( 0 )))) by L790;
thus L797: thesis by L796 , L97;
end;
theorem
L798: (for R1 being non  empty set holds (for B225 being non  empty-yielding (Matrix of R1) holds (1 <= ( len B225 ) & 1 <= ( width B225 ))))
proof
let R1 being non  empty set;
let C193 being non  empty-yielding (Matrix of R1);
L799: ((not ( len C193 ) = ( 0 )) & (not ( width C193 ) = ( 0 ))) by GOBOARD1:def 3;
thus L800: thesis by L799 , NAT_1:14;
end;
definition
let C194 being (Matrix of ( REAL ));
attr C194 is  m-nonnegative
means
:L801: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C194 ) implies ( C194 * (R2 , R3) ) >= ( 0 ))));
end;
definition
let C195 being (Matrix of ( REAL ));
attr C195 is  with_sum=1
means
:L803: ( SumAll C195 ) = 1;
end;
definition
let C196 being (Matrix of ( REAL ));
attr C196 is  Joint_Probability
means
:L805: C196 is  m-nonnegative  with_sum=1;
end;
registration
cluster  Joint_Probability ->  m-nonnegative  with_sum=1 for (Matrix of ( REAL ));
coherence by L805;
cluster  m-nonnegative  with_sum=1 ->  Joint_Probability for (Matrix of ( REAL ));
coherence by L805;
end;
theorem
L808: (for B226 , B227 being non  empty Nat holds (ex B228 being (Matrix of B226 , B227 , ( REAL )) st (B228 is  m-nonnegative & ( SumAll B228 ) = 1)))
proof
let C197 , C198 being non  empty Nat;
consider C199 being Nat such that L809: C198 = ( C199 + 1 ) by NAT_1:6;
consider C200 being Nat such that L810: C197 = ( C200 + 1 ) by NAT_1:6;
reconsider D49 = C197 , D50 = C198 as non  empty (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D51 = C199 , D52 = C200 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C201 being (FinSequence of ( REAL )) such that L811: ( len C201 ) = D50 and L812: (for B229 being Nat holds (B229 in ( Seg D50 ) implies ((B229 in ( Seg D51 ) implies ( C201 . B229 ) = ( 0 )) & ((not B229 in ( Seg D51 )) implies ( C201 . B229 ) = 1)))) by L27;
L813: ( D51 + 1 ) > D51 by NAT_1:13;
L814: (not ( D51 + 1 ) in ( Seg D51 )) by L813 , FINSEQ_1:1;
L815: ( D51 + 1 ) in ( Seg D50 ) by L809 , FINSEQ_1:4;
L816: ( C201 . ( D51 + 1 ) ) = 1 by L815 , L812 , L814;
L817: C201 = ( ( C201 | D51 ) ^ <* 1 *> ) by L816 , L809 , L811 , RFINSEQ:7;
reconsider D53 = ( C201 | D51 ) as (FinSequence of ( REAL ));
L818: D50 > D51 by L809 , NAT_1:13;
L819: ( len D53 ) = D51 by L818 , L811 , FINSEQ_1:59;
L820: ( dom C201 ) = ( Seg D50 ) by L811 , FINSEQ_1:def 3;
L821: ( Sum C201 ) = 1
proof
per cases ;
suppose L822: D51 = ( 0 );

L823: ( Sum D53 ) = ( 0 ) by L822 , RVSUM_1:72;
thus L824: ( Sum C201 ) = ( ( Sum ( C201 | D51 ) ) + 1 ) by L817 , RVSUM_1:74
.= 1 by L823;
end;
suppose L825: D51 <> ( 0 );

L826: (for B230 being Nat holds (B230 in ( dom D53 ) implies ( D53 . B230 ) = ( 0 )))
proof
let C202 being Nat;
assume L827: C202 in ( dom D53 );
L828: C202 in ( Seg D51 ) by L827 , L819 , FINSEQ_1:def 3;
L829: ( D51 + 1 ) in ( Seg ( D51 + 1 ) ) by FINSEQ_1:4;
L830: D51 in ( Seg D50 ) by L829 , L809 , L825 , FINSEQ_1:61;
L831: D51 in ( dom C201 ) by L830 , L811 , FINSEQ_1:def 3;
L832: (( D53 . C202 ) = ( C201 . C202 ) & C202 in ( dom C201 )) by L831 , L828 , RFINSEQ:6;
thus L833: thesis by L832 , L812 , L820 , L828;
end;
L834: D53 = ( D51 |-> ( 0 ) ) by L826 , L819 , L825 , L14;
L835: ( Sum D53 ) = ( D51 * ( 0 ) ) by L834 , RVSUM_1:80
.= ( 0 );
thus L836: ( Sum C201 ) = ( ( Sum ( C201 | D51 ) ) + 1 ) by L817 , RVSUM_1:74
.= 1 by L835;
end;
end;
reconsider D54 = ( D50 |-> (( 0 ) qua Real) ) as (FinSequence of ( REAL ));
L838: ( len D54 ) = D50 by CARD_1:def 7;
consider C203 being (Matrix of D49 , D50 , ( REAL )) such that L839: (for B231 being Nat holds (B231 in ( Seg D49 ) implies ((B231 in ( Seg D52 ) implies ( C203 . B231 ) = D54) & ((not B231 in ( Seg D52 )) implies ( C203 . B231 ) = C201)))) by L838 , L811 , L263;
L840: ( Sum D54 ) = ( D50 * ( 0 ) ) by RVSUM_1:80
.= ( 0 );
L841: (( len ( Sum C203 ) ) = D49 & (for R2 being (Element of ( NAT )) holds (R2 in ( Seg D49 ) implies ((R2 in ( Seg D52 ) implies ( ( Sum C203 ) . R2 ) = ( 0 )) & ((not R2 in ( Seg D52 )) implies ( ( Sum C203 ) . R2 ) = 1)))))
proof
thus L842: ( len ( Sum C203 ) ) = ( len C203 ) by L310
.= D49 by MATRIX_1:def 2;
let R2 being (Element of ( NAT ));
assume that
L843: R2 in ( Seg D49 );
L844: R2 in ( dom ( Sum C203 ) ) by L842 , L843 , FINSEQ_1:def 3;
thus L845: (R2 in ( Seg D52 ) implies ( ( Sum C203 ) . R2 ) = ( 0 ))
proof
assume L846: R2 in ( Seg D52 );
thus L847: ( ( Sum C203 ) . R2 ) = ( Sum ( C203 . R2 ) ) by L844 , L310
.= ( 0 ) by L839 , L840 , L843 , L846;
end;

assume L848: (not R2 in ( Seg D52 ));
thus L849: ( ( Sum C203 ) . R2 ) = ( Sum ( C203 . R2 ) ) by L844 , L310
.= 1 by L839 , L821 , L843 , L848;
end;
L850: ( SumAll C203 ) = 1
proof
reconsider D55 = ( Sum C203 ) as (FinSequence of ( REAL ));
reconsider D56 = ( D55 | D52 ) as (FinSequence of ( REAL ));
L851: ( D52 + 1 ) > D52 by NAT_1:13;
L852: (not ( D52 + 1 ) in ( Seg D52 )) by L851 , FINSEQ_1:1;
L853: ( D52 + 1 ) in ( Seg D49 ) by L810 , FINSEQ_1:4;
L854: ( D55 . ( D52 + 1 ) ) = 1 by L853 , L841 , L852;
L855: D49 > D52 by L810 , NAT_1:13;
L856: ( len D56 ) = D52 by L855 , L841 , FINSEQ_1:59;
L857: ( dom D55 ) = ( Seg D49 ) by L841 , FINSEQ_1:def 3;
L858: ( Sum D55 ) = 1
proof
per cases ;
suppose L859: D52 = ( 0 );

L860: D56 = ( <*> ( REAL ) ) by L859;
thus L861: ( Sum D55 ) = ( Sum ( ( D55 | D52 ) ^ <* 1 *> ) ) by L810 , L841 , L854 , RFINSEQ:7
.= ( ( Sum ( D55 | D52 ) ) + 1 ) by RVSUM_1:74
.= 1 by L860 , RVSUM_1:72;
end;
suppose L862: D52 <> ( 0 );

L863: (for B232 being Nat holds (B232 in ( dom D56 ) implies ( D56 . B232 ) = ( 0 )))
proof
let C204 being Nat;
assume L864: C204 in ( dom D56 );
L865: C204 in ( Seg D52 ) by L864 , L856 , FINSEQ_1:def 3;
L866: ( D52 + 1 ) in ( Seg ( D52 + 1 ) ) by FINSEQ_1:4;
L867: D52 in ( Seg D49 ) by L866 , L810 , L862 , FINSEQ_1:61;
L868: D52 in ( dom D55 ) by L867 , L841 , FINSEQ_1:def 3;
L869: (( D56 . C204 ) = ( D55 . C204 ) & C204 in ( dom D55 )) by L868 , L865 , RFINSEQ:6;
thus L870: thesis by L869 , L841 , L857 , L865;
end;
L871: D56 = ( D52 |-> ( 0 ) ) by L863 , L856 , L862 , L14;
L872: ( Sum D56 ) = ( D52 * ( 0 ) ) by L871 , RVSUM_1:80
.= ( 0 );
thus L873: ( Sum D55 ) = ( Sum ( ( D55 | D52 ) ^ <* 1 *> ) ) by L810 , L841 , L854 , RFINSEQ:7
.= ( ( Sum ( D55 | D52 ) ) + 1 ) by RVSUM_1:74
.= 1 by L872;
end;
end;
thus L875: thesis by L858;
end;
L876: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C203 ) implies ( C203 * (R2 , R3) ) >= ( 0 ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L877: [ R2 , R3 ] in ( Indices C203 );
consider C205 being (FinSequence of ( REAL )) such that L878: C205 = ( C203 . R2 ) and L879: ( C203 * (R2 , R3) ) = ( C205 . R3 ) by L877 , MATRIX_1:def 5;
L880: ( len C203 ) = D49 by MATRIX_1:def 2;
L881: [ R2 , R3 ] in [: ( dom C203 ) , ( Seg ( width C203 ) ) :] by L877 , MATRIX_1:def 4;
L882: R2 in ( dom C203 ) by L881 , ZFMISC_1:87;
L883: R2 in ( Seg D49 ) by L882 , L880 , FINSEQ_1:def 3;
L884: R3 in ( Seg ( width C203 ) ) by L881 , ZFMISC_1:87;
L885: R3 in ( Seg D50 ) by L884 , L880 , MATRIX_1:20;
per cases  by L839 , L878 , L883;
suppose L886: C205 = D54;

thus L887: thesis by L886 , L879;
end;
suppose L888: C205 = C201;

thus L889: thesis by L888 , L812 , L879 , L885;
end;
end;
L891: C203 is  m-nonnegative by L876 , L801;
thus L892: thesis by L891 , L850;
end;
registration
cluster non  empty-yielding  Joint_Probability for (Matrix of ( REAL ));
existence
proof
set D57 = 1;
set D58 = 1;
consider C206 being (Matrix of D57 , D58 , ( REAL )) such that L893: C206 is  m-nonnegative and L894: ( SumAll C206 ) = 1 by L808;
take C206;
L895: C206 is  with_sum=1 by L894 , L803;
L896: ( len C206 ) = 1 by MATRIX_1:def 2;
L897: ( width C206 ) = 1 by L896 , MATRIX_1:20;
thus L898: thesis by L897 , L893 , L896 , L895 , GOBOARD1:def 3;
end;
end;
theorem
L900: (for B233 being non  empty-yielding  Joint_Probability (Matrix of ( REAL )) holds ( B233 @ ) is non  empty-yielding  Joint_Probability non  empty-yielding  Joint_Probability non  empty-yielding  Joint_Probability non  empty-yielding  Joint_Probability (Matrix of ( REAL )))
proof
let C207 being non  empty-yielding  Joint_Probability (Matrix of ( REAL ));
set D59 = ( len C207 );
set D60 = ( width C207 );
L901: D59 > ( 0 ) by L798;
L902: D60 > ( 0 ) by L798;
L903: (( len ( C207 @ ) ) = D60 & ( width ( C207 @ ) ) = D59) by L902 , MATRIX_2:10;
reconsider D61 = ( C207 @ ) as (Matrix of D60 , D59 , ( REAL )) by L903 , MATRIX_2:7;
L904: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices D61 ) implies ( D61 * (R2 , R3) ) >= ( 0 ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume L905: [ R2 , R3 ] in ( Indices D61 );
L906: [ R3 , R2 ] in ( Indices C207 ) by L905 , MATRIX_1:def 6;
L907: ( D61 * (R2 , R3) ) = ( C207 * (R3 , R2) ) by L906 , MATRIX_1:def 6;
thus L908: thesis by L907 , L906 , L801;
end;
L909: D61 is  m-nonnegative by L904 , L801;
L910: ( SumAll D61 ) = ( SumAll C207 ) by L438
.= 1 by L803;
L911: D61 is  with_sum=1 by L910 , L803;
thus L912: thesis by L911 , L901 , L902 , L903 , L909 , GOBOARD1:def 3;
end;
theorem
L913: (for B234 being non  empty-yielding  Joint_Probability (Matrix of ( REAL )) holds (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B234 ) implies ( B234 * (R2 , R3) ) <= 1))))
proof
let C208 being non  empty-yielding  Joint_Probability (Matrix of ( REAL ));
L914: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C208 ) implies ( C208 * (R2 , R3) ) >= ( 0 )))) by L801;
L915: (for B235 being Nat holds (B235 in ( dom ( Sum C208 ) ) implies ( ( Sum C208 ) . B235 ) >= ( 0 )))
proof
let C209 being Nat;
assume that
L916: C209 in ( dom ( Sum C208 ) );
L917: C209 in ( Seg ( len ( Sum C208 ) ) ) by L916 , FINSEQ_1:def 3;
L918: C209 in ( Seg ( len C208 ) ) by L917 , L310;
L919: C209 in ( dom C208 ) by L918 , FINSEQ_1:def 3;
L920: (for B236 being Nat holds (B236 in ( dom ( C208 . C209 ) ) implies ( ( C208 . C209 ) . B236 ) >= ( 0 ))) by L919 , L914 , L277;
L921: ( Sum ( C208 . C209 ) ) >= ( 0 ) by L920 , RVSUM_1:84;
thus L922: thesis by L921 , L916 , L310;
end;
L923: (for R2 being (Element of ( NAT )) holds (R2 in ( dom ( Sum C208 ) ) implies ( ( Sum C208 ) . R2 ) <= 1))
proof
let R2 being (Element of ( NAT ));
assume L924: R2 in ( dom ( Sum C208 ) );
L925: ( ( Sum C208 ) . R2 ) <= ( SumAll C208 ) by L924 , L915 , L97;
thus L926: thesis by L925 , L803;
end;
L927: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C208 ) implies (for R3 being (Element of ( NAT )) holds (R3 in ( dom ( C208 . R2 ) ) implies ( ( C208 . R2 ) . R3 ) <= ( Sum ( C208 . R2 ) )))))
proof
let R2 being (Element of ( NAT ));
assume L928: R2 in ( dom C208 );
L929: (for B237 being Nat holds (B237 in ( dom ( C208 . R2 ) ) implies ( ( C208 . R2 ) . B237 ) >= ( 0 ))) by L928 , L914 , L277;
thus L930: thesis by L929 , L97;
end;
L931: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C208 ) implies (for R3 being (Element of ( NAT )) holds (R3 in ( dom ( C208 . R2 ) ) implies ( ( C208 . R2 ) . R3 ) <= 1))))
proof
let R2 being (Element of ( NAT ));
assume that
L932: R2 in ( dom C208 );
L933: R2 in ( Seg ( len C208 ) ) by L932 , FINSEQ_1:def 3;
L934: R2 in ( Seg ( len ( Sum C208 ) ) ) by L933 , L310;
L935: R2 in ( dom ( Sum C208 ) ) by L934 , FINSEQ_1:def 3;
L936: ( ( Sum C208 ) . R2 ) <= 1 by L935 , L923;
L937: ( Sum ( C208 . R2 ) ) <= 1 by L936 , L935 , L310;
let R3 being (Element of ( NAT ));
assume L938: R3 in ( dom ( C208 . R2 ) );
L939: ( ( C208 . R2 ) . R3 ) <= ( Sum ( C208 . R2 ) ) by L938 , L927 , L932;
thus L940: thesis by L939 , L937 , XXREAL_0:2;
end;
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L941: [ R2 , R3 ] in ( Indices C208 );
L942: (ex B238 being (FinSequence of ( REAL )) st (B238 = ( C208 . R2 ) & ( C208 * (R2 , R3) ) = ( B238 . R3 ))) by L941 , MATRIX_1:def 5;
L943: R2 in ( Seg ( len C208 ) ) by L941 , L204;
L944: R2 in ( dom C208 ) by L943 , FINSEQ_1:def 3;
L945: R3 in ( Seg ( width C208 ) ) by L941 , L204;
L946: R3 in ( Seg ( len ( C208 . R2 ) ) ) by L945 , L944 , MATRIX_1:42;
L947: R3 in ( dom ( C208 . R2 ) ) by L946 , FINSEQ_1:def 3;
thus L948: thesis by L947 , L931 , L944 , L942;
end;
definition
let C210 being (Matrix of ( REAL ));
attr C210 is  with_line_sum=1
means
:L949: (for R4 being (Element of ( NAT )) holds (R4 in ( dom C210 ) implies ( Sum ( C210 . R4 ) ) = 1));
end;
theorem
L951: (for B239 , B240 being non  empty Nat holds (ex B241 being (Matrix of B239 , B240 , ( REAL )) st B241 is  m-nonnegative  with_line_sum=1))
proof
let C211 , C212 being non  empty Nat;
consider C213 being Nat such that L952: C212 = ( C213 + 1 ) by NAT_1:6;
reconsider D62 = C213 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C214 being (FinSequence of ( REAL )) such that L953: ( len C214 ) = C212 and L954: (for B242 being Nat holds (B242 in ( Seg C212 ) implies ((B242 in ( Seg D62 ) implies ( C214 . B242 ) = ( 0 )) & ((not B242 in ( Seg D62 )) implies ( C214 . B242 ) = 1)))) by L27;
L955: ( D62 + 1 ) > D62 by NAT_1:13;
L956: (not ( D62 + 1 ) in ( Seg D62 )) by L955 , FINSEQ_1:1;
L957: ( D62 + 1 ) in ( Seg C212 ) by L952 , FINSEQ_1:4;
L958: ( C214 . ( D62 + 1 ) ) = 1 by L957 , L954 , L956;
L959: C214 = ( ( C214 | D62 ) ^ <* 1 *> ) by L958 , L952 , L953 , RFINSEQ:7;
reconsider D63 = ( C211 |-> C214 ) as (Matrix of C211 , C212 , ( REAL )) by L953 , L251;
L960: ( len D63 ) = C211 by MATRIX_1:def 2;
L961: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices D63 ) implies ( D63 * (R2 , R3) ) >= ( 0 ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L962: [ R2 , R3 ] in ( Indices D63 );
consider C215 being (FinSequence of ( REAL )) such that L963: C215 = ( D63 . R2 ) and L964: ( D63 * (R2 , R3) ) = ( C215 . R3 ) by L962 , MATRIX_1:def 5;
L965: [ R2 , R3 ] in [: ( dom D63 ) , ( Seg ( width D63 ) ) :] by L962 , MATRIX_1:def 4;
L966: R3 in ( Seg ( width D63 ) ) by L965 , ZFMISC_1:87;
L967: R3 in ( Seg C212 ) by L966 , L960 , MATRIX_1:20;
L968: R2 in ( dom D63 ) by L965 , ZFMISC_1:87;
L969: R2 in ( Seg C211 ) by L968 , L960 , FINSEQ_1:def 3;
L970: C215 = C214 by L969 , L963 , FUNCOP_1:7;
thus L971: thesis by L970 , L954 , L964 , L967;
end;
reconsider D64 = ( C214 | D62 ) as (FinSequence of ( REAL ));
L972: C212 > D62 by L952 , NAT_1:13;
L973: ( len D64 ) = D62 by L972 , L953 , FINSEQ_1:59;
take D63;
L974: ( dom C214 ) = ( Seg C212 ) by L953 , FINSEQ_1:def 3;
L975: ( Sum C214 ) = 1
proof
per cases ;
suppose L976: D62 = ( 0 );

L977: D64 = ( <*> ( REAL ) ) by L976;
thus L978: ( Sum C214 ) = ( ( Sum ( C214 | D62 ) ) + 1 ) by L959 , RVSUM_1:74
.= 1 by L977 , RVSUM_1:72;
end;
suppose L979: D62 <> ( 0 );

L980: (for B243 being Nat holds (B243 in ( dom D64 ) implies ( D64 . B243 ) = ( 0 )))
proof
let C216 being Nat;
assume L981: C216 in ( dom D64 );
L982: C216 in ( Seg D62 ) by L981 , L973 , FINSEQ_1:def 3;
L983: ( D62 + 1 ) in ( Seg ( D62 + 1 ) ) by FINSEQ_1:4;
L984: D62 in ( Seg C212 ) by L983 , L952 , L979 , FINSEQ_1:61;
L985: D62 in ( dom C214 ) by L984 , L953 , FINSEQ_1:def 3;
L986: (( D64 . C216 ) = ( C214 . C216 ) & C216 in ( dom C214 )) by L985 , L982 , RFINSEQ:6;
thus L987: thesis by L986 , L954 , L974 , L982;
end;
L988: D64 = ( D62 |-> ( 0 ) ) by L980 , L973 , L979 , L14;
L989: ( Sum D64 ) = ( D62 * ( 0 ) ) by L988 , RVSUM_1:80
.= ( 0 );
thus L990: ( Sum C214 ) = ( ( Sum ( C214 | D62 ) ) + 1 ) by L959 , RVSUM_1:74
.= 1 by L989;
end;
end;
L992: (for R2 being (Element of ( NAT )) holds (R2 in ( dom D63 ) implies ( Sum ( D63 . R2 ) ) = 1))
proof
let R2 being (Element of ( NAT ));
assume L993: R2 in ( dom D63 );
L994: R2 in ( Seg C211 ) by L993 , L960 , FINSEQ_1:def 3;
thus L995: thesis by L994 , L975 , FUNCOP_1:7;
end;
thus L996: thesis by L992 , L961 , L801 , L949;
end;
definition
let C217 being (Matrix of ( REAL ));
attr C217 is  Conditional_Probability
means
:L997: C217 is  m-nonnegative  with_line_sum=1;
end;
registration
cluster  Conditional_Probability ->  m-nonnegative  with_line_sum=1 for (Matrix of ( REAL ));
coherence by L997;
cluster  m-nonnegative  with_line_sum=1 ->  Conditional_Probability for (Matrix of ( REAL ));
coherence by L997;
end;
registration
cluster non  empty-yielding  Conditional_Probability for (Matrix of ( REAL ));
existence
proof
set D65 = 1;
set D66 = 1;
consider C218 being (Matrix of D65 , D66 , ( REAL )) such that L1000: C218 is  m-nonnegative  with_line_sum=1 by L951;
take C218;
L1001: ( len C218 ) = 1 by MATRIX_1:def 2;
L1002: ( width C218 ) = 1 by L1001 , MATRIX_1:20;
thus L1003: thesis by L1002 , L1000 , L1001 , GOBOARD1:def 3;
end;
end;
theorem
L1005: (for B244 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices B244 ) implies ( B244 * (R2 , R3) ) <= 1))))
proof
let C219 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
L1006: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C219 ) implies ( C219 * (R2 , R3) ) >= ( 0 )))) by L801;
L1007: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C219 ) implies (for R3 being (Element of ( NAT )) holds (R3 in ( dom ( C219 . R2 ) ) implies ( ( C219 . R2 ) . R3 ) <= 1))))
proof
let R2 being (Element of ( NAT ));
assume that
L1008: R2 in ( dom C219 );
L1009: (for B245 being Nat holds (B245 in ( dom ( C219 . R2 ) ) implies ( ( C219 . R2 ) . B245 ) >= ( 0 ))) by L1006 , L1008 , L277;
let R3 being (Element of ( NAT ));
assume L1010: R3 in ( dom ( C219 . R2 ) );
L1011: ( ( C219 . R2 ) . R3 ) <= ( Sum ( C219 . R2 ) ) by L1010 , L1009 , L97;
thus L1012: thesis by L1011 , L1008 , L949;
end;
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L1013: [ R2 , R3 ] in ( Indices C219 );
L1014: (ex B246 being (FinSequence of ( REAL )) st (B246 = ( C219 . R2 ) & ( C219 * (R2 , R3) ) = ( B246 . R3 ))) by L1013 , MATRIX_1:def 5;
L1015: R2 in ( Seg ( len C219 ) ) by L1013 , L204;
L1016: R2 in ( dom C219 ) by L1015 , FINSEQ_1:def 3;
L1017: R3 in ( Seg ( width C219 ) ) by L1013 , L204;
L1018: R3 in ( Seg ( len ( C219 . R2 ) ) ) by L1017 , L1016 , MATRIX_1:42;
L1019: R3 in ( dom ( C219 . R2 ) ) by L1018 , FINSEQ_1:def 3;
thus L1020: thesis by L1019 , L1007 , L1016 , L1014;
end;
theorem
L1021: (for B247 being non  empty-yielding (Matrix of ( REAL )) holds (B247 is non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) iff (for R2 being (Element of ( NAT )) holds (R2 in ( dom B247 ) implies ( Line (B247 , R2) ) is non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS (FinSequence of ( REAL ))))))
proof
let C220 being non  empty-yielding (Matrix of ( REAL ));
thus L1022:now
assume L1023: C220 is non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
thus L1024:now
set D67 = ( width C220 );
let R2 being (Element of ( NAT ));
assume that
L1025: R2 in ( dom C220 );
L1026: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C220 ) implies ( C220 * (R2 , R3) ) >= ( 0 )))) by L1023 , L801;
L1027: (( len ( Line (C220 , R2) ) ) = D67 & (for R3 being (Element of ( NAT )) holds (R3 in ( dom ( Line (C220 , R2) ) ) implies ( ( Line (C220 , R2) ) . R3 ) >= ( 0 )))) by L1026 , L1025 , L283 , MATRIX_1:def 7;
L1028: ( Sum ( Line (C220 , R2) ) ) = ( Sum ( C220 . R2 ) ) by L1025 , MATRIX_2:16
.= 1 by L1023 , L1025 , L949;
thus L1029: ( Line (C220 , R2) ) is non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS (FinSequence of ( REAL )) by L1028 , L1027 , L790 , L798;
end;
end;
assume L1025: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C220 ) implies ( Line (C220 , R2) ) is non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS (FinSequence of ( REAL ))));
L1026:
now
let R4 being (Element of ( NAT ));
assume that
L1027: R4 in ( dom C220 );
L1028: ( Line (C220 , R4) ) is  ProbFinS by L1025 , L1027;
L1029: ( Sum ( Line (C220 , R4) ) ) = 1 by L1028 , L790;
thus L1030: ( Sum ( C220 . R4 ) ) = 1 by L1029 , L1027 , MATRIX_2:16;
end;
L1031: C220 is  with_line_sum=1 by L1026 , L949;
L1032: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ((R2 in ( dom C220 ) & R3 in ( dom ( Line (C220 , R2) ) )) implies ( ( Line (C220 , R2) ) . R3 ) >= ( 0 ))))
proof
let R2 being (Element of ( NAT ));
let R3 being (Element of ( NAT ));
assume that
L1033: R2 in ( dom C220 )
and
L1034: R3 in ( dom ( Line (C220 , R2) ) );
L1035: ( Line (C220 , R2) ) is  ProbFinS by L1025 , L1033;
thus L1036: thesis by L1035 , L1034 , L790;
end;
L1037: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C220 ) implies ( C220 * (R2 , R3) ) >= ( 0 )))) by L1032 , L283;
L1038: C220 is  m-nonnegative by L1037 , L801;
thus L1039: thesis by L1038 , L1031;
end;
theorem
L1040: (for B248 being non  empty-yielding  with_line_sum=1 (Matrix of ( REAL )) holds ( SumAll B248 ) = ( len B248 ))
proof
let C221 being non  empty-yielding  with_line_sum=1 (Matrix of ( REAL ));
set D68 = ( len C221 );
L1041: (( len ( Sum C221 ) ) = D68 & (for B249 being Nat holds (B249 in ( dom ( Sum C221 ) ) implies ( ( Sum C221 ) . B249 ) = 1)))
proof
thus L1042: ( len ( Sum C221 ) ) = D68 by L310;
thus L1043:now
let C222 being Nat;
assume L1044: C222 in ( dom ( Sum C221 ) );
L1045: C222 in ( Seg ( len ( Sum C221 ) ) ) by L1044 , FINSEQ_1:def 3;
L1046: C222 in ( Seg ( len C221 ) ) by L1045 , L310;
L1047: C222 in ( dom C221 ) by L1046 , FINSEQ_1:def 3;
L1048: ( Sum ( C221 . C222 ) ) = 1 by L1047 , L949;
thus L1049: ( ( Sum C221 ) . C222 ) = 1 by L1048 , L1044 , L310;
end;
end;
L1044: D68 > ( 0 ) by L798;
L1045: ( Sum C221 ) = ( D68 |-> 1 ) by L1044 , L1041 , L14;
thus L1046: ( SumAll C221 ) = ( D68 * 1 ) by L1045 , RVSUM_1:80
.= D68;
end;
notation
let C223 being (Matrix of ( REAL ));
synonym Row_Marginal C223 for LineSum C223;
synonym Column_Marginal C223 for ColSum C223;
end;
registration
let C224 being non  empty-yielding  Joint_Probability (Matrix of ( REAL ));
cluster ( Row_Marginal C224 ) -> non  empty  ProbFinS;
coherence
proof
set D69 = ( len C224 );
set D70 = ( LineSum C224 );
L1048: ( len D70 ) = ( len C224 ) by L324;
L1049: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C224 ) implies ( C224 * (R2 , R3) ) >= ( 0 )))) by L801;
L1050: (for R2 being (Element of ( NAT )) holds (R2 in ( dom D70 ) implies ( D70 . R2 ) >= ( 0 )))
proof
let R2 being (Element of ( NAT ));
assume L1051: R2 in ( dom D70 );
L1052: R2 in ( Seg ( len C224 ) ) by L1051 , L1048 , FINSEQ_1:def 3;
L1053: R2 in ( dom C224 ) by L1052 , FINSEQ_1:def 3;
L1054: (for B250 being Nat holds (B250 in ( dom ( Line (C224 , R2) ) ) implies ( ( Line (C224 , R2) ) . B250 ) >= ( 0 ))) by L1053 , L1049 , L283;
L1055: ( Sum ( Line (C224 , R2) ) ) >= ( 0 ) by L1054 , RVSUM_1:84;
thus L1056: thesis by L1055 , L1052 , L324;
end;
L1057: ( Sum D70 ) = ( SumAll C224 )
.= 1 by L803;
L1058: ( len D70 ) = D69 by L324;
thus L1059: thesis by L1058 , L1050 , L1057 , L790 , L798;
end;
cluster ( Column_Marginal C224 ) -> non  empty  ProbFinS;
coherence
proof
set D71 = ( ColSum C224 );
set D72 = ( width C224 );
L1060: ( len D71 ) = ( width C224 ) by L327;
L1061: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C224 ) implies ( C224 * (R2 , R3) ) >= ( 0 )))) by L801;
L1062: (for R2 being (Element of ( NAT )) holds (R2 in ( dom D71 ) implies ( D71 . R2 ) >= ( 0 )))
proof
let R2 being (Element of ( NAT ));
assume L1063: R2 in ( dom D71 );
L1064: R2 in ( Seg ( width C224 ) ) by L1063 , L1060 , FINSEQ_1:def 3;
L1065: (for B251 being Nat holds (B251 in ( dom ( Col (C224 , R2) ) ) implies ( ( Col (C224 , R2) ) . B251 ) >= ( 0 ))) by L1064 , L1061 , L294;
L1066: ( Sum ( Col (C224 , R2) ) ) >= ( 0 ) by L1065 , RVSUM_1:84;
thus L1067: thesis by L1066 , L1064 , L327;
end;
L1068: ( len D71 ) = D72 by L327;
L1069: ( Sum D71 ) = ( SumAll C224 ) by L490
.= 1 by L803;
thus L1070: thesis by L1069 , L1068 , L1062 , L790 , L798;
end;
end;
registration
let C225 being non  empty-yielding (Matrix of ( REAL ));
cluster ( C225 @ ) -> non  empty-yielding;
coherence
proof
L1072: ( width C225 ) <> ( 0 ) by GOBOARD1:def 3;
L1073: ( width ( C225 @ ) ) = ( len C225 ) by L1072 , MATRIX_2:10;
L1074: ( width ( C225 @ ) ) <> ( 0 ) by L1073 , GOBOARD1:def 3;
L1075: ( len ( C225 @ ) ) <> ( 0 ) by L1072 , MATRIX_2:10;
thus L1076: thesis by L1075 , L1074 , GOBOARD1:def 3;
end;
end;
registration
let C226 being non  empty-yielding  Joint_Probability (Matrix of ( REAL ));
cluster ( C226 @ ) ->  Joint_Probability;
coherence by L900;
end;
theorem
L1079: (for B252 being non  empty  ProbFinS (FinSequence of ( REAL )) holds (for B253 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds (( len B252 ) = ( len B253 ) implies (( B252 * B253 ) is non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS (FinSequence of ( REAL )) & ( len ( B252 * B253 ) ) = ( width B253 )))))
proof
let C227 being non  empty  ProbFinS (FinSequence of ( REAL ));
set D73 = ( len C227 );
let C228 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
assume that
L1080: ( len C227 ) = ( len C228 );
L1081: ( len ( C227 * C228 ) ) = ( width C228 ) by L1080 , MATRIXR1:62;
L1082: (for R2 being (Element of ( NAT )) holds (R2 in ( dom ( C227 * C228 ) ) implies ( ( C227 * C228 ) . R2 ) >= ( 0 )))
proof
let R2 being (Element of ( NAT ));
assume that
L1083: R2 in ( dom ( C227 * C228 ) );
L1084: R2 in ( Seg ( len ( C227 * C228 ) ) ) by L1083 , FINSEQ_1:def 3;
L1085: ( ( C227 * C228 ) . R2 ) = ( C227 "*" ( Col (C228 , R2) ) ) by L1084 , L1080 , L581
.= ( Sum ( mlt (C227 , ( Col (C228 , R2) )) ) );
L1086: (for R2 being (Element of ( NAT )) holds (for R3 being (Element of ( NAT )) holds ([ R2 , R3 ] in ( Indices C228 ) implies ( C228 * (R2 , R3) ) >= ( 0 )))) by L801;
L1087: R2 in ( Seg ( width C228 ) ) by L1081 , L1083 , FINSEQ_1:def 3;
L1088: (for R3 being (Element of ( NAT )) holds (R3 in ( dom ( Col (C228 , R2) ) ) implies ( ( Col (C228 , R2) ) . R3 ) >= ( 0 ))) by L1087 , L1086 , L294;
L1089: (for R2 being (Element of ( NAT )) holds (R2 in ( dom C227 ) implies ( C227 . R2 ) >= ( 0 ))) by L790;
L1090: (for B254 being Nat holds (B254 in ( dom ( mlt (C227 , ( Col (C228 , R2) )) ) ) implies ( ( mlt (C227 , ( Col (C228 , R2) )) ) . B254 ) >= ( 0 ))) by L1089 , L1088 , L498;
thus L1091: thesis by L1090 , L1085 , RVSUM_1:84;
end;
set D74 = ( width C228 );
set D75 = ( D74 |-> (1 qua Real) );
L1092: ( len D75 ) = D74 by CARD_1:def 7;
L1093: D74 > ( 0 ) by L798;
L1094: ( len ( C228 @ ) ) = ( width C228 ) by L1093 , MATRIX_2:10;
L1095: ( width ( C228 @ ) ) = ( len C228 ) by L1093 , MATRIX_2:10;
L1096: ( len ( D75 * ( C228 @ ) ) ) = D73 by L1095 , L1080 , L1092 , L1094 , MATRIXR1:62;
L1097: (for B255 being Nat holds (B255 in ( dom ( D75 * ( C228 @ ) ) ) implies ( ( D75 * ( C228 @ ) ) . B255 ) = 1))
proof
let C229 being Nat;
assume L1098: C229 in ( dom ( D75 * ( C228 @ ) ) );
L1099: C229 in ( Seg ( len ( D75 * ( C228 @ ) ) ) ) by L1098 , FINSEQ_1:def 3;
L1100: C229 in ( dom C228 ) by L1099 , L1080 , L1096 , FINSEQ_1:def 3;
thus L1101: ( ( D75 * ( C228 @ ) ) . C229 ) = ( Sum ( Col (( C228 @ ) , C229) ) ) by L1092 , L1094 , L1099 , L748
.= ( Sum ( Line (C228 , C229) ) ) by L1100 , MATRIX_2:14
.= ( Sum ( C228 . C229 ) ) by L1100 , MATRIX_2:16
.= 1 by L1100 , L949;
end;
L1102: ( D75 * ( C228 @ ) ) = ( D73 |-> 1 ) by L1097 , L1096 , L14;
L1103: ( Sum ( C227 * C228 ) ) = |( ( C227 * C228 ) , D75 )| by L1081 , L495
.= |( C227 , ( D75 * ( C228 @ ) ) )| by L1080 , L1093 , L1092 , L741
.= ( Sum C227 ) by L1102 , L495
.= 1 by L790;
thus L1104: thesis by L1103 , L1081 , L1082 , L790 , L798;
end;
theorem
L1105: (for B256 , B257 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) holds (( width B256 ) = ( len B257 ) implies (( B256 * B257 ) is non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability non  empty-yielding  Conditional_Probability (Matrix of ( REAL )) & ( len ( B256 * B257 ) ) = ( len B256 ) & ( width ( B256 * B257 ) ) = ( width B257 ))))
proof
let C230 , C231 being non  empty-yielding  Conditional_Probability (Matrix of ( REAL ));
assume that
L1106: ( width C230 ) = ( len C231 );
set D76 = ( width C231 );
set D77 = ( len C231 );
set D78 = ( len C230 );
L1107: ( len ( C230 * C231 ) ) = D78 by L1106 , L589;
L1108: ( width ( C230 * C231 ) ) = D76 by L1106 , L589;
reconsider D79 = ( C230 * C231 ) as (Matrix of D78 , D76 , ( REAL )) by L1108 , L1107 , MATRIX_2:7;
L1109: (for R2 being (Element of ( NAT )) holds (R2 in ( dom D79 ) implies ( Line (D79 , R2) ) is non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS (FinSequence of ( REAL ))))
proof
let R2 being (Element of ( NAT ));
assume L1110: R2 in ( dom D79 );
L1111: R2 in ( Seg ( len D79 ) ) by L1110 , FINSEQ_1:def 3;
L1112: R2 in ( dom C230 ) by L1111 , L1107 , FINSEQ_1:def 3;
reconsider D80 = ( Line (C230 , R2) ) as non  empty  ProbFinS (FinSequence of ( REAL )) by L1112 , L1021;
L1113: ( len D80 ) = D77 by L1106 , MATRIX_1:def 7;
L1114: ( D80 * C231 ) is non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS non  empty  ProbFinS (FinSequence of ( REAL )) by L1113 , L1079;
thus L1115: thesis by L1114 , L1106 , L1111 , L589;
end;
L1116: (D78 > ( 0 ) & D76 > ( 0 )) by L798;
L1117: D79 is non  empty-yielding non  empty-yielding non  empty-yielding non  empty-yielding (Matrix of ( REAL )) by L1116 , L1107 , L1108 , GOBOARD1:def 3;
thus L1118: thesis by L1117 , L1106 , L1109 , L589 , L1021;
end;
