:: Laplace Expansion
::  by Karol P\c{a}k and Andrzej Trybulec
::
:: Received August 13, 2007
:: Copyright (c) 2007-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, SUBSET_1, NAT_1, XBOOLE_0, MATRIX11, FINSEQ_1, ARYTM_3,
      MATRIX_2, VECTSP_1, MATRIX_1, RELAT_1, FINSEQ_3, ARYTM_1, TREES_1,
      CARD_1, XXREAL_0, FUNCT_1, INCSP_1, TARSKI, ALGSTR_0, ZFMISC_1, STRUCT_0,
      REALSET1, SETWOP_2, FUNCT_2, FINSUB_1, GROUP_1, SETWISEO, INT_1,
      FINSET_1, ABIAN, FINSEQ_2, BINOP_1, QC_LANG1, AFINSQ_1, ABSVALUE,
      MATRIX_3, SUPINF_2, CARD_3, FINSOP_1, RVSUM_1, FVSUM_1, MESFUNC1,
      MATRIX_6, LAPLACE;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, NUMBERS, XCMPLX_0, XXREAL_0,
      FINSET_1, RELAT_1, RELSET_1, FUNCT_1, PARTFUN1, FUNCT_2, FINSEQ_1,
      BINOP_1, STRUCT_0, ALGSTR_0, GROUP_1, VECTSP_1, SETWISEO, SETWOP_2,
      FINSEQ_2, MATRIX_1, FINSUB_1, MATRIX_2, ORDINAL1, NAT_1, FVSUM_1,
      FINSOP_1, MATRIX_3, CARD_1, FINSEQ_7, NEWTON, MATRIX_7, FINSEQ_3,
      MATRIX11, MATRIX_6, NAT_D;
 constructors SETWISEO, FINSOP_1, SETWOP_2, ALGSTR_1, FVSUM_1, BINOP_1,
      FINSEQ_4, FINSEQ_7, WELLORD2, NEWTON, MATRIX_6, MATRIX_7, MATRIX11,
      NAT_D, BINOP_2, RELSET_1;
 registrations FUNCT_1, FINSUB_1, FINSET_1, STRUCT_0, FVSUM_1, MATRIX_2,
      VECTSP_1, FUNCT_2, PARTFUN1, XBOOLE_0, ORDINAL1, XXREAL_0, NAT_1, INT_1,
      RELAT_1, CARD_1, MATRIX11, XCMPLX_0, RELSET_1, FINSEQ_2, FINSEQ_1;
 requirements ARITHM, NUMERALS, REAL, BOOLE, SUBSET;
 definitions FINSEQ_2, FINSEQ_1, TARSKI, MATRIX_1, MATRIX_3, FVSUM_1, MATRIX_2,
      MATRIX_7, MATRIX11, RELAT_1, ALGSTR_0;
 theorems FINSEQ_1, FINSEQ_2, TARSKI, FUNCT_2, NAT_1, FUNCT_1, SETWISEO,
      VECTSP_1, ZFMISC_1, FVSUM_1, SETWOP_2, MATRIX_1, MATRIX_2, FINSUB_1,
      FINSEQ_3, RELAT_1, FINSOP_1, XBOOLE_0, XBOOLE_1, MATRIX_3, XREAL_1,
      MATRIX_7, ORDINAL1, CARD_1, CARD_2, MATRIX_9, STIRL2_1, SGRAPH1,
      CARD_FIN, HURWITZ, NEWTON, COMPUT_1, MATRIX11, GROUP_1, MATRIX_4,
      MATRIX_6, MATRIXR1, NAT_D, XXREAL_0, MATRIXR2, XREAL_0;
 schemes FUNCT_2, NAT_1, FINSEQ_1, FUNCT_1, SETWISEO, MATRIX_1;

begin
theorem
L1: (for B1 being FinSequence holds (for B2 being Nat holds (B2 in ( dom B1 ) implies ( len ( Del (B1 , B2) ) ) = ( ( len B1 ) -' 1 ))))
proof
let C1 being FinSequence;
let C2 being Nat;
assume L2: C2 in ( dom C1 );
L3: (ex B3 being Nat st (( len C1 ) = ( B3 + 1 ) & ( len ( Del (C1 , C2) ) ) = B3)) by L2 , FINSEQ_3:104;
thus L4: thesis by L3 , NAT_D:34;
end;
theorem
L5: (for R16 being Field holds (for B4 , B5 , B6 being Nat holds (for B7 being (Matrix of B6 , R16) holds (B4 in ( dom B7 ) implies ( len ( Deleting (B7 , B4 , B5) ) ) = ( B6 -' 1 )))))
proof
let R16 being Field;
let C3 , C4 , C5 being Nat;
let C6 being (Matrix of C5 , R16);
assume L6: C3 in ( dom C6 );
L7: ( len C6 ) = C5 by MATRIX_1:def 2;
thus L8: ( len ( Deleting (C6 , C3 , C4) ) ) = ( len ( DelLine (C6 , C3) ) ) by MATRIX_2:def 5
.= ( C5 -' 1 ) by L6 , L7 , L1;
end;
theorem
L9: (for R6 being Nat holds (for R16 being Field holds (for R19 being (Matrix of R16) holds (R6 in ( Seg ( width R19 ) ) implies ( width ( DelCol (R19 , R6) ) ) = ( ( width R19 ) -' 1 )))))
proof
let R6 being Nat;
let R16 being Field;
let R19 being (Matrix of R16);
set D1 = ( DelCol (R19 , R6) );
L10: ( len D1 ) = ( len R19 ) by MATRIX_2:def 5;
assume L11: R6 in ( Seg ( width R19 ) );
L12: ( Seg ( width R19 ) ) <> ( {} ) by L11;
L13: ( width R19 ) <> ( 0 ) by L12;
L14: ( len R19 ) > ( 0 ) by L13 , MATRIX_1:def 3;
consider C7 being FinSequence such that L15: C7 in ( rng D1 ) and L16: ( len C7 ) = ( width D1 ) by L14 , L10 , MATRIX_1:def 3;
consider C8 being set such that L17: C8 in ( dom ( DelCol (R19 , R6) ) ) and L18: ( D1 . C8 ) = C7 by L15 , FUNCT_1:def 3;
L19: C8 in ( Seg ( len D1 ) ) by L17 , FINSEQ_1:def 3;
consider C9 being (Element of ( NAT )) such that L20: C8 = C9 and L21: 1 <= C9 and L22: C9 <= ( len D1 ) by L19;
L23: C9 in ( dom R19 ) by L10 , L17 , L20 , FINSEQ_3:29;
L24: C7 = ( Del (( Line (R19 , C9) ) , R6) ) by L23 , L18 , L20 , MATRIX_2:def 5;
L25: ( len ( Line (R19 , C9) ) ) = ( width R19 ) by MATRIX_1:def 7;
L26: ( dom ( Line (R19 , C9) ) ) = ( Seg ( width R19 ) ) by L25 , FINSEQ_1:def 3;
thus L27: thesis by L26 , L11 , L16 , L25 , L24 , L1;
end;
theorem
L28: (for R16 being Field holds (for R19 being (Matrix of R16) holds (for B8 being Nat holds (( len R19 ) > 1 implies ( width R19 ) = ( width ( DelLine (R19 , B8) ) )))))
proof
let R16 being Field;
let R19 being (Matrix of R16);
let C10 being Nat;
assume L29: ( len R19 ) > 1;
per cases ;
suppose L30: C10 in ( dom R19 );

consider C11 being Nat such that L31: ( len R19 ) = ( C11 + 1 ) and L32: ( len ( Del (R19 , C10) ) ) = C11 by L30 , FINSEQ_3:104;
L33: C11 >= 1 by L29 , L31 , NAT_1:13;
L34: C11 in ( dom ( Del (R19 , C10) ) ) by L33 , L32 , FINSEQ_3:25;
L35: ( ( DelLine (R19 , C10) ) . C11 ) in ( rng ( Del (R19 , C10) ) ) by L34 , FUNCT_1:def 3;
L36: ( rng ( Del (R19 , C10) ) ) c= ( rng R19 ) by FINSEQ_3:106;
L37: ( ( DelLine (R19 , C10) ) . C11 ) = ( Line (( DelLine (R19 , C10) ) , C11) ) by L34 , MATRIX_2:16;
L38: R19 is (Matrix of ( len R19 ) , ( width R19 ) , R16) by L29 , MATRIX_1:20;
L39: ( len ( Line (( DelLine (R19 , C10) ) , C11) ) ) = ( width R19 ) by L38 , L35 , L37 , L36 , MATRIX_1:def 2;
thus L40: thesis by L39 , L32 , L33 , L35 , L37 , MATRIX_1:def 3;
end;
suppose L41: (not C10 in ( dom R19 ));

thus L42: thesis by L41 , FINSEQ_3:104;
end;
end;
theorem
L44: (for R6 being Nat holds (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (for B9 being Nat holds (R6 in ( Seg ( width R22 ) ) implies ( width ( Deleting (R22 , B9 , R6) ) ) = ( R9 -' 1 )))))))
proof
let R6 being Nat;
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
let C12 being Nat;
assume L45: R6 in ( Seg ( width R22 ) );
per cases ;
suppose L46: (( len R22 ) <= 1 & C12 in ( dom R22 ));

L47: ( Seg ( width R22 ) ) <> ( {} ) by L45;
L48: ( width R22 ) <> ( {} ) by L47;
L49: ( len R22 ) > ( 0 ) by L48 , MATRIX_1:def 3;
L50: ( len R22 ) = 1 by L49 , L46 , NAT_1:25;
L51: ( len ( Deleting (R22 , C12 , R6) ) ) = ( R9 -' 1 ) by L46 , L5;
L52: ( len R22 ) = R9 by MATRIX_1:24;
L53: ( len ( Deleting (R22 , C12 , R6) ) ) = ( 0 ) by L52 , L50 , L51 , XREAL_1:232;
thus L54: thesis by L53 , L51 , MATRIX_1:def 3;
end;
suppose L55: ( len R22 ) > 1;

L56: ( width R22 ) = R9 by MATRIX_1:24;
L57: ( width R22 ) = ( width ( DelLine (R22 , C12) ) ) by L55 , L28;
thus L58: thesis by L57 , L45 , L56 , L9;
end;
suppose L59: (not C12 in ( dom R22 ));

L60: ( width R22 ) = R9 by MATRIX_1:24;
L61: ( DelLine (R22 , C12) ) = R22 by L59 , FINSEQ_3:104;
thus L62: thesis by L61 , L45 , L60 , L9;
end;
end;
definition
let C13 being non  empty multMagma;
let C14 being (Function of [: (the carrier of C13) , ( NAT ) :] , (the carrier of C13));
let C15 being (Element of C13);
let C16 being Nat;
redefine func C14 . (C15 , C16) -> (Element of C13);

coherence
proof
reconsider D2 = C16 as (Element of ( NAT )) by ORDINAL1:def 12;
L64: ( C14 . (C15 , D2) ) is (Element of C13);
thus L65: thesis by L64;
end;
end;
theorem
L67: (for R9 being Nat holds ( card ( Permutations R9 ) ) = ( R9 ! ))
proof
let R9 being Nat;
set D3 = ( Permutations R9 );
reconsider D4 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
set D5 = ( finSeg D4 );
set D6 = { B10 where B10 is (Function of D5 , D5) : B10 is (Permutation of D5) };
L68: D3 c= D6
proof
let R1 being set;
assume L69: R1 in D3;
L70: R1 is (Permutation of D5) by L69 , MATRIX_2:def 9;
thus L71: thesis by L70;
end;
L72: D6 c= D3
proof
let R1 being set;
assume L73: R1 in D6;
L74: (ex B11 being (Function of D5 , D5) st (R1 = B11 & B11 is (Permutation of D5))) by L73;
thus L75: thesis by L74 , MATRIX_2:def 9;
end;
L76: D3 = D6 by L72 , L68 , XBOOLE_0:def 10;
thus L77: ( card D3 ) = ( ( card D5 ) ! ) by L76 , CARD_FIN:8
.= ( R9 ! ) by FINSEQ_1:57;
end;
theorem
L78: (for R9 being Nat holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg ( R9 + 1 ) ) & R6 in ( Seg ( R9 + 1 ) )) implies ( card { R13 where R13 is (Element of ( Permutations ( R9 + 1 ) )) : ( R13 . R5 ) = R6 } ) = ( R9 ! )))))
proof
let R9 being Nat;
let R5 being Nat;
let R6 being Nat;
assume that
L79: R5 in ( Seg ( R9 + 1 ) )
and
L80: R6 in ( Seg ( R9 + 1 ) );
reconsider D7 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
set D8 = ( D7 + 1 );
set D9 = ( finSeg D8 );
set D10 = ( D9 \ { R6 } );
L81: ( D10 \/ { R6 } ) = D9 by L80 , ZFMISC_1:116;
set D11 = ( D9 \ { R5 } );
set D12 = ( Permutations D8 );
set D13 = { B12 where B12 is (Element of D12) : ( B12 . R5 ) = R6 };
set D14 = { B13 where B13 is (Function of ( D11 \/ { R5 } ) , ( D10 \/ { R6 } )) : (B13 is  one-to-one & ( B13 . R5 ) = R6) };
L82: ( D11 \/ { R5 } ) = D9 by L79 , ZFMISC_1:116;
L83: D14 c= D13
proof
let R1 being set;
assume L84: R1 in D14;
consider C17 being (Function of D9 , D9) such that L85: C17 = R1 and L86: C17 is  one-to-one and L87: ( C17 . R5 ) = R6 by L84 , L82 , L81;
L88: ( card D9 ) = ( card D9 );
L89: C17 is  onto by L88 , L86 , STIRL2_1:60;
L90: C17 in D12 by L89 , L86 , MATRIX_2:def 9;
thus L91: thesis by L90 , L85 , L87;
end;
L92: D13 c= D14
proof
let R1 being set;
assume L93: R1 in D13;
consider C18 being (Element of D12) such that L94: R1 = C18 and L95: ( C18 . R5 ) = R6 by L93;
reconsider D15 = C18 as (Permutation of D9) by MATRIX_2:def 9;
L96: ( D15 . R5 ) = R6 by L95;
thus L97: thesis by L96 , L82 , L81 , L94;
end;
L98: D13 = D14 by L92 , L83 , XBOOLE_0:def 10;
L99: ( card D9 ) = D8 by FINSEQ_1:57;
L100: (not R6 in D10) by ZFMISC_1:56;
L101: ( card D9 ) = ( ( card D10 ) + 1 ) by L100 , L81 , CARD_2:41;
L102: (not R5 in D11) by ZFMISC_1:56;
L103: ( card D9 ) = ( ( card D11 ) + 1 ) by L102 , L82 , CARD_2:41;
L104: (D10 is  empty implies D11 is  empty) by L103 , L101;
thus L105: ( card { R13 where R13 is (Element of ( Permutations ( R9 + 1 ) )) : ( R13 . R5 ) = R6 } ) = ( card { B14 where B14 is (Function of D11 , D10) : B14 is  one-to-one } ) by L104 , L102 , L100 , L98 , CARD_FIN:5
.= ( ( ( card D10 ) ! ) / ( ( ( card D10 ) -' ( card D11 ) ) ! ) ) by L103 , L101 , CARD_FIN:7
.= ( ( ( card D10 ) ! ) / 1 ) by L103 , L101 , NEWTON:12 , XREAL_1:232
.= ( R9 ! ) by L101 , L99;
end;
theorem
L106: (for R9 being Nat holds (for B15 being  Fanoian Field holds (for R15 being (Element of ( Permutations ( R9 + 2 ) )) holds (for B16 , B17 being (Element of ( Fin ( 2Set ( Seg ( R9 + 2 ) ) ) )) holds (B17 = { R11 where R11 is (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) : (R11 in B16 & ( ( Part_sgn (R15 , B15) ) . R11 ) = ( - ( 1_ B15 ) )) } implies ( (the multF of B15) $$ (B16 , ( Part_sgn (R15 , B15) )) ) = ( ( power B15 ) . (( - ( 1_ B15 ) ) , ( card B17 )) ))))))
proof
let R9 being Nat;
let C19 being  Fanoian Field;
let R15 being (Element of ( Permutations ( R9 + 2 ) ));
set D16 = ( R9 + 2 );
let C20 , C21 being (Element of ( Fin ( 2Set ( Seg D16 ) ) ));
assume that
L107: C21 = { R11 where R11 is (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) : (R11 in C20 & ( ( Part_sgn (R15 , C19) ) . R11 ) = ( - ( 1_ C19 ) )) };
reconsider D17 = ( id ( Seg D16 ) ) as (Element of ( Permutations D16 )) by MATRIX_2:def 9;
set D18 = { R11 where R11 is (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) : (R11 in C20 & ( ( Part_sgn (R15 , C19) ) . R11 ) <> ( ( Part_sgn (D17 , C19) ) . R11 )) };
L108: (for R1 being set holds (R1 in C20 implies ( ( Part_sgn (D17 , C19) ) . R1 ) = ( 1_ C19 )))
proof
L109: C20 c= ( 2Set ( Seg D16 ) ) by FINSUB_1:def 5;
let R1 being set;
assume L110: R1 in C20;
consider C22 , C23 being Nat such that L111: C22 in ( Seg D16 ) and L112: C23 in ( Seg D16 ) and L113: C22 < C23 and L114: R1 = { C22 , C23 } by L110 , L109 , MATRIX11:1;
L115: ( D17 . C23 ) = C23 by L112 , FUNCT_1:17;
L116: ( D17 . C22 ) = C22 by L111 , FUNCT_1:17;
thus L117: thesis by L116 , L111 , L112 , L113 , L114 , L115 , MATRIX11:def 1;
end;
L118: D18 c= C21
proof
let R2 being set;
assume L119: R2 in D18;
consider R11 being (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) such that L120: R2 = R11 and L121: R11 in C20 and L122: ( ( Part_sgn (R15 , C19) ) . R11 ) <> ( ( Part_sgn (D17 , C19) ) . R11 ) by L119;
L123: ( ( Part_sgn (D17 , C19) ) . R11 ) = ( 1_ C19 ) by L108 , L121;
L124: ( ( Part_sgn (R15 , C19) ) . R11 ) = ( - ( 1_ C19 ) ) by L123 , L122 , MATRIX11:5;
thus L125: thesis by L124 , L107 , L120 , L121;
end;
L126: C21 c= D18
proof
let R2 being set;
L127: ( 1_ C19 ) <> ( - ( 1_ C19 ) ) by MATRIX11:22;
assume L128: R2 in C21;
consider R11 being (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) such that L129: R11 = R2 and L130: R11 in C20 and L131: ( ( Part_sgn (R15 , C19) ) . R11 ) = ( - ( 1_ C19 ) ) by L128 , L107;
L132: ( ( Part_sgn (D17 , C19) ) . R11 ) = ( 1_ C19 ) by L108 , L130;
thus L133: thesis by L132 , L129 , L130 , L131 , L127;
end;
L134: C21 = D18 by L126 , L118 , XBOOLE_0:def 10;
per cases  by NAT_D:12;
suppose L135: ( ( card C21 ) mod 2 ) = ( 0 );

consider C24 being Nat such that L136: ( card C21 ) = ( ( 2 * C24 ) + ( 0 ) ) and L137: ( 0 ) < 2 by L135 , NAT_D:def 2;
L138: C24 is (Element of ( NAT )) by ORDINAL1:def 12;
thus L139: ( ( power C19 ) . (( - ( 1_ C19 ) ) , ( card C21 )) ) = ( 1_ C19 ) by L138 , L136 , HURWITZ:4
.= ( (the multF of C19) $$ (C20 , ( Part_sgn (D17 , C19) )) ) by L108 , MATRIX11:4
.= ( (the multF of C19) $$ (C20 , ( Part_sgn (R15 , C19) )) ) by L134 , L135 , MATRIX11:7;
end;
suppose L140: ( ( card C21 ) mod 2 ) = 1;

consider C25 being Nat such that L141: ( card C21 ) = ( ( 2 * C25 ) + 1 ) and L142: 1 < 2 by L140 , NAT_D:def 2;
L143: C25 is (Element of ( NAT )) by ORDINAL1:def 12;
thus L144: ( ( power C19 ) . (( - ( 1_ C19 ) ) , ( card C21 )) ) = ( - ( 1_ C19 ) ) by L143 , L141 , HURWITZ:4
.= ( - ( (the multF of C19) $$ (C20 , ( Part_sgn (D17 , C19) )) ) ) by L108 , MATRIX11:4
.= ( (the multF of C19) $$ (C20 , ( Part_sgn (R15 , C19) )) ) by L134 , L140 , MATRIX11:7;
end;
end;
theorem
L146: (for R9 being Nat holds (for B18 being  Fanoian Field holds (for R15 being (Element of ( Permutations ( R9 + 2 ) )) holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg ( R9 + 2 ) ) & ( R15 . R5 ) = R6) implies (ex B19 being (Element of ( Fin ( 2Set ( Seg ( R9 + 2 ) ) ) )) st (B19 = { { R3 , R5 } where R3 is (Element of ( NAT )) : { R3 , R5 } in ( 2Set ( Seg ( R9 + 2 ) ) ) } & ( (the multF of B18) $$ (B19 , ( Part_sgn (R15 , B18) )) ) = ( ( power B18 ) . (( - ( 1_ B18 ) ) , ( R5 + R6 )) )))))))))
proof
let R9 being Nat;
let C26 being  Fanoian Field;
let R15 being (Element of ( Permutations ( R9 + 2 ) ));
let R5 being Nat;
let R6 being Nat;
assume that
L147: R5 in ( Seg ( R9 + 2 ) )
and
L148: ( R15 . R5 ) = R6;
reconsider D19 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
set D20 = ( D19 + 2 );
reconsider D21 = R15 as (Permutation of ( finSeg D20 )) by MATRIX_2:def 9;
L149: ( rng D21 ) = ( Seg D20 ) by FUNCT_2:def 3;
L150: 1 <= R5 by L147 , FINSEQ_1:1;
reconsider D22 = ( R5 - 1 ) as (Element of ( NAT )) by L150 , NAT_1:21;
deffunc H1(set) = { $1 , R5 };
set D23 = ( ( finSeg D20 ) \ ( Seg R5 ) );
set D24 = ( finSeg D22 );
set D25 = ( 2Set ( Seg ( R9 + 2 ) ) );
set D26 = { { B20 , R5 } where B20 is (Element of ( NAT )) : { B20 , R5 } in ( 2Set ( Seg ( R9 + 2 ) ) ) };
L151: D26 c= D25
proof
let R1 being set;
assume L152: R1 in D26;
L153: (ex B21 being (Element of ( NAT )) st (R1 = { B21 , R5 } & { B21 , R5 } in ( 2Set ( Seg D20 ) ))) by L152;
thus L154: thesis by L153;
end;
reconsider D27 = D26 as (Element of ( Fin D25 )) by L151 , FINSUB_1:def 5;
set D28 = { R11 where R11 is (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) : (R11 in D27 & ( ( Part_sgn (R15 , C26) ) . R11 ) = ( - ( 1_ C26 ) )) };
L155: D28 c= D27
proof
let R1 being set;
assume L156: R1 in D28;
L157: (ex R11 being (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) st (R11 = R1 & R11 in D27 & ( ( Part_sgn (R15 , C26) ) . R11 ) = ( - ( 1_ C26 ) ))) by L156;
thus L158: thesis by L157;
end;
L159: D28 c= D25 by L155 , L151 , XBOOLE_1:1;
L160: ( dom D21 ) = ( Seg D20 ) by FUNCT_2:52;
L161: ( R15 . R5 ) in ( rng R15 ) by L160 , L147 , FUNCT_1:def 3;
L162: 1 <= R6 by L161 , L148 , L149 , FINSEQ_1:1;
reconsider D29 = ( R6 - 1 ) as (Element of ( NAT )) by L162 , NAT_1:21;
reconsider D30 = D28 as (Element of ( Fin D25 )) by L159 , FINSUB_1:def 5;
consider C27 being Function such that L163: (( dom C27 ) = ( D24 \/ D23 ) & (for R1 being set holds (R1 in ( D24 \/ D23 ) implies ( C27 . R1 ) = H1(R1)))) from FUNCT_1:sch 3;
L164: ( C27 " D30 ) c= ( dom C27 ) by RELAT_1:132;
reconsider D31 = ( C27 " D30 ) as  finite set by L164 , L163;
L165: ( D24 \/ D23 ) c= ( ( Seg D20 ) \ { R5 } )
proof
let R1 being set;
assume that
L166: R1 in ( D24 \/ D23 );
per cases  by L166 , XBOOLE_0:def 3;
suppose L167: R1 in D24;

L168: R5 <= D20 by L147 , FINSEQ_1:1;
consider C28 being (Element of ( NAT )) such that L169: R1 = C28 and L170: 1 <= C28 and L171: C28 <= D22 by L167;
L172: D22 < ( D22 + 1 ) by NAT_1:13;
L173: C28 < R5 by L172 , L171 , XXREAL_0:2;
L174: C28 <= D20 by L173 , L168 , XXREAL_0:2;
L175: C28 in ( Seg D20 ) by L174 , L170;
L176: (not C28 in { R5 }) by L171 , L172 , TARSKI:def 1;
thus L177: thesis by L176 , L169 , L175 , XBOOLE_0:def 5;
end;
suppose L178: R1 in D23;

L179: ( D22 + 1 ) in ( Seg R5 ) by FINSEQ_1:4;
L180: (not R1 in ( Seg R5 )) by L178 , XBOOLE_0:def 5;
L181: (not R1 in { R5 }) by L180 , L179 , TARSKI:def 1;
thus L182: thesis by L181 , L178 , XBOOLE_0:def 5;
end;
end;
L184: (for B22 , B23 being set holds ((B22 in ( dom C27 ) & B23 in ( dom C27 ) & ( C27 . B22 ) = ( C27 . B23 )) implies B22 = B23))
proof
let C29 , C30 being set;
assume that
L185: C29 in ( dom C27 )
and
L186: C30 in ( dom C27 )
and
L187: ( C27 . C29 ) = ( C27 . C30 );
L188: ( C27 . C30 ) = H1(C30) by L163 , L186;
L189: (not C29 in { R5 }) by L165 , L163 , L185 , XBOOLE_0:def 5;
L190: C29 <> R5 by L189 , TARSKI:def 1;
L191: ( C27 . C29 ) = H1(C29) by L163 , L185;
L192: C29 in { R5 , C30 } by L191 , L187 , L188 , TARSKI:def 2;
thus L193: thesis by L192 , L190 , TARSKI:def 2;
end;
L194: C27 is  one-to-one by L184 , FUNCT_1:def 4;
L195: ( C27 .: D31 ) , D31 are_equipotent  by L194 , L164 , CARD_1:33;
L196: ( card ( C27 .: D31 ) ) = ( card D31 ) by L195 , CARD_1:5;
L197: ( ( finSeg D20 ) \ { R5 } ) c= ( D24 \/ D23 )
proof
let R1 being set;
assume that
L198: R1 in ( ( finSeg D20 ) \ { R5 } );
L199: R1 in ( finSeg D20 ) by L198;
consider C31 being (Element of ( NAT )) such that L200: R1 = C31 and L201: 1 <= C31 and L202: C31 <= D20 by L199;
L203: (not C31 in { R5 }) by L198 , L200 , XBOOLE_0:def 5;
L204: C31 <> R5 by L203 , TARSKI:def 1;
per cases  by L204 , XXREAL_0:1;
suppose L205: C31 < ( D22 + 1 );

L206: C31 <= D22 by L205 , NAT_1:13;
L207: R1 in D24 by L206 , L200 , L201;
thus L208: thesis by L207 , XBOOLE_0:def 3;
end;
suppose L209: C31 > ( D22 + 1 );

L210: (not R1 in ( Seg R5 )) by L209 , L200 , FINSEQ_1:1;
L211: R1 in ( Seg D20 ) by L200 , L201 , L202;
L212: R1 in D23 by L211 , L210 , XBOOLE_0:def 5;
thus L213: thesis by L212 , XBOOLE_0:def 3;
end;
end;
L215: ( ( finSeg D20 ) \ { R5 } ) = ( D24 \/ D23 ) by L197 , L165 , XBOOLE_0:def 10;
L216: ( rng C27 ) c= D27
proof
let R1 being set;
assume L217: R1 in ( rng C27 );
consider R2 being set such that L218: R2 in ( dom C27 ) and L219: ( C27 . R2 ) = R1 by L217 , FUNCT_1:def 3;
L220: R2 in ( finSeg D20 ) by L215 , L163 , L218;
consider C32 being (Element of ( NAT )) such that L221: C32 = R2 and L222: 1 <= C32 and L223: C32 <= D20 by L220;
L224: ( C27 . C32 ) = { R5 , C32 } by L163 , L218 , L221;
L225: (not R2 in { R5 }) by L165 , L163 , L218 , XBOOLE_0:def 5;
L226: R5 <> C32 by L225 , L221 , TARSKI:def 1;
L227: (C32 < R5 or R5 < C32) by L226 , XXREAL_0:1;
L228: C32 in ( Seg D20 ) by L222 , L223;
L229: { R5 , C32 } in D25 by L228 , L147 , L227 , MATRIX11:1;
thus L230: thesis by L229 , L219 , L221 , L224;
end;
L231: ( D21 .: ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) ) c= ( Seg D29 )
proof
let R2 being set;
assume L232: R2 in ( D21 .: ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) );
consider R1 being set such that L233: R1 in ( dom D21 ) and L234: R1 in ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) and L235: ( D21 . R1 ) = R2 by L232 , FUNCT_1:def 6;
L236: ( dom D21 ) = ( Seg D20 ) by FUNCT_2:52;
consider C33 being (Element of ( NAT )) such that L237: R1 = C33 and L238: 1 <= C33 and L239: C33 <= D20 by L236 , L233;
per cases  by L234 , L237 , XBOOLE_0:def 3;
suppose L240: C33 in ( D24 \ ( C27 " D30 ) );

L241: C33 <= D22 by L240 , FINSEQ_1:1;
L242: C33 < ( D22 + 1 ) by L241 , NAT_1:13;
L243: D24 c= ( dom C27 ) by L163 , XBOOLE_1:7;
L244: C33 in D24 by L240;
L245: ( C27 . C33 ) in ( rng C27 ) by L244 , L243 , FUNCT_1:def 3;
L246: (not C33 in ( C27 " D30 )) by L240 , XBOOLE_0:def 5;
L247: (not ( C27 . C33 ) in D30) by L246 , L244 , L243 , FUNCT_1:def 7;
L248: C33 in ( Seg D20 ) by L238 , L239;
L249: ( dom D21 ) = ( Seg D20 ) by FUNCT_2:52;
L250: ( R15 . R5 ) <> ( R15 . C33 ) by L249 , L147 , L242 , L248 , FUNCT_1:def 4;
L251: ( C27 . C33 ) = H1(C33) by L163 , L244 , L243;
L252: H1(C33) in D27 by L251 , L216 , L245;
L253: (ex B24 being (Element of ( NAT )) st (H1(C33) = { B24 , R5 } & { B24 , R5 } in D25)) by L252;
L254: ( ( Part_sgn (R15 , C26) ) . { C33 , R5 } ) <> ( - ( 1_ C26 ) ) by L253 , L216 , L247 , L245 , L251;
L255: ( R15 . C33 ) <= ( R15 . R5 ) by L254 , L147 , L242 , L248 , MATRIX11:def 1;
L256: ( R15 . C33 ) < ( D29 + 1 ) by L255 , L148 , L250 , XXREAL_0:1;
L257: ( R15 . C33 ) <= D29 by L256 , NAT_1:13;
L258: ( rng D21 ) = ( Seg D20 ) by FUNCT_2:def 3;
L259: ( R15 . C33 ) in ( rng D21 ) by L233 , L237 , FUNCT_1:def 3;
L260: 1 <= ( R15 . C33 ) by L259 , L258 , FINSEQ_1:1;
thus L261: thesis by L260 , L235 , L237 , L257 , FINSEQ_1:1;
end;
suppose L262: C33 in ( D23 /\ ( C27 " D30 ) );

L263: C33 in D23 by L262 , XBOOLE_0:def 4;
L264: (not C33 in ( Seg R5 )) by L263 , XBOOLE_0:def 5;
L265: 1 <= C33 by L262 , FINSEQ_1:1;
L266: R5 < C33 by L265 , L264;
L267: C33 in ( C27 " D30 ) by L262 , XBOOLE_0:def 4;
L268: ( C27 . C33 ) in D30 by L267 , FUNCT_1:def 7;
consider R11 being (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) such that L269: R11 = ( C27 . C33 ) and L270: R11 in D27 and L271: ( ( Part_sgn (R15 , C26) ) . R11 ) = ( - ( 1_ C26 ) ) by L268;
L272: C33 in ( dom C27 ) by L267 , FUNCT_1:def 7;
L273: R11 = { R5 , C33 } by L272 , L163 , L269;
L274: ( dom D21 ) = ( finSeg D20 ) by FUNCT_2:52;
L275: ( D21 . R5 ) <> ( R15 . C33 ) by L274 , L147 , L262 , L266 , FUNCT_1:def 4;
L276: ( 1_ C26 ) <> ( - ( 1_ C26 ) ) by MATRIX11:22;
L277: ( R15 . R5 ) >= ( R15 . C33 ) by L276 , L147 , L262 , L271 , L273 , L266 , MATRIX11:def 1;
L278: ( R15 . C33 ) < ( D29 + 1 ) by L277 , L148 , L275 , XXREAL_0:1;
L279: ( R15 . C33 ) <= D29 by L278 , NAT_1:13;
L280: ( rng D21 ) = ( Seg D20 ) by FUNCT_2:def 3;
L281: ( R15 . C33 ) in ( rng D21 ) by L233 , L237 , FUNCT_1:def 3;
L282: 1 <= ( R15 . C33 ) by L281 , L280 , FINSEQ_1:1;
thus L283: thesis by L282 , L235 , L237 , L279 , FINSEQ_1:1;
end;
end;
take D27;
reconsider D32 = R5 , D33 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
set D34 = ( power C26 );
thus L285: D27 = { { B25 , R5 } where B25 is (Element of ( NAT )) : { B25 , R5 } in ( 2Set ( Seg ( R9 + 2 ) ) ) };
L286: ( D24 /\ ( C27 " D30 ) ) c= D24 by XBOOLE_1:17;
L287: ( Seg D29 ) c= ( D21 .: ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) )
proof
let R2 being set;
assume that
L288: R2 in ( Seg D29 );
consider C34 being (Element of ( NAT )) such that L289: R2 = C34 and L290: 1 <= C34 and L291: C34 <= D29 by L288;
L292: D29 < ( D29 + 1 ) by NAT_1:13;
L293: C34 < R6 by L292 , L291 , XXREAL_0:2;
L294: R6 <= D20 by L148 , L161 , L149 , FINSEQ_1:1;
L295: D29 <= D20 by L294 , L292 , XXREAL_0:2;
L296: ( Seg D29 ) c= ( Seg D20 ) by L295 , FINSEQ_1:5;
consider R1 being set such that L297: R1 in ( dom D21 ) and L298: R2 = ( D21 . R1 ) by L296 , L149 , L288 , FUNCT_1:def 3;
L299: (not R1 in { R5 }) by L148 , L289 , L291 , L292 , L298 , TARSKI:def 1;
L300: R1 in ( dom C27 ) by L299 , L215 , L163 , L297 , XBOOLE_0:def 5;
L301: ( C27 . R1 ) = H1(R1) by L300 , L163;
L302: ( C27 . R1 ) in ( rng C27 ) by L300 , FUNCT_1:def 3;
L303: H1(R1) in D27 by L302 , L216 , L301;
consider C35 being (Element of ( NAT )) such that L304: H1(R1) = { C35 , R5 } and L305: { C35 , R5 } in ( 2Set ( Seg D20 ) ) by L303;
L306: C35 <> R5 by L305 , SGRAPH1:10;
L307: C35 in ( Seg D20 ) by L305 , SGRAPH1:10;
L308: C35 in { R1 , R5 } by L304 , TARSKI:def 2;
L309: C35 = R1 by L308 , L306 , TARSKI:def 2;
per cases  by L305 , SGRAPH1:10 , XXREAL_0:1;
suppose L310: C35 < R5;

L311: (not C35 in ( C27 " D30 ))
proof
assume L312: C35 in ( C27 " D30 );
L313: { C35 , R5 } in D30 by L312 , L301 , L309 , FUNCT_1:def 7;
L314: (ex R11 being (Element of ( 2Set ( Seg ( R9 + 2 ) ) )) st (R11 = { C35 , R5 } & R11 in D27 & ( ( Part_sgn (R15 , C26) ) . R11 ) = ( - ( 1_ C26 ) ))) by L313;
L315: ( ( Part_sgn (R15 , C26) ) . { C35 , R5 } ) = ( 1_ C26 ) by L147 , L148 , L289 , L293 , L297 , L298 , L309 , L310 , MATRIX11:def 1;
thus L316: thesis by L315 , L314 , MATRIX11:22;
end;
L317: C35 < ( D22 + 1 ) by L310;
L318: C35 <= D22 by L317 , NAT_1:13;
L319: 1 <= C35 by L307 , FINSEQ_1:1;
L320: C35 in D24 by L319 , L318;
L321: R1 in ( D24 \ ( C27 " D30 ) ) by L320 , L309 , L311 , XBOOLE_0:def 5;
L322: R1 in ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) by L321 , XBOOLE_0:def 3;
thus L323: thesis by L322 , L297 , L298 , FUNCT_1:def 6;
end;
suppose L324: C35 > R5;

L325: (not C35 in ( Seg R5 )) by L324 , FINSEQ_1:1;
L326: R1 in D23 by L325 , L309 , L307 , XBOOLE_0:def 5;
L327: ( ( Part_sgn (R15 , C26) ) . { C35 , R5 } ) = ( - ( 1_ C26 ) ) by L147 , L148 , L289 , L293 , L297 , L298 , L309 , L324 , MATRIX11:def 1;
L328: ( C27 . R1 ) in D30 by L327 , L216 , L301 , L302 , L304 , L305;
L329: R1 in ( dom C27 ) by L215 , L163 , L297 , L299 , XBOOLE_0:def 5;
L330: R1 in ( C27 " D30 ) by L329 , L328 , FUNCT_1:def 7;
L331: R1 in ( D23 /\ ( C27 " D30 ) ) by L330 , L326 , XBOOLE_0:def 4;
L332: R1 in ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) by L331 , XBOOLE_0:def 3;
thus L333: thesis by L332 , L297 , L298 , FUNCT_1:def 6;
end;
end;
L335: ( Seg D29 ) = ( D21 .: ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) ) by L287 , L231 , XBOOLE_0:def 10;
L336: ( Seg D20 ) = ( dom D21 ) by FUNCT_2:52;
L337: ( D24 \ ( C27 " D30 ) ) = ( D24 \ ( ( C27 " D30 ) /\ D24 ) ) by XBOOLE_1:47;
L338: D22 < ( D22 + 1 ) by NAT_1:13;
L339: D24 c= ( Seg R5 ) by L338 , FINSEQ_1:5;
L340: D24 misses D23 by L339 , XBOOLE_1:64 , XBOOLE_1:79;
L341: D27 c= ( rng C27 )
proof
let R1 being set;
assume L342: R1 in D27;
consider C36 being (Element of ( NAT )) such that L343: R1 = { C36 , R5 } and L344: { C36 , R5 } in D25 by L342;
L345: C36 <> R5 by L344 , SGRAPH1:10;
L346: (not C36 in { R5 }) by L345 , TARSKI:def 1;
L347: C36 in ( Seg D20 ) by L344 , SGRAPH1:10;
L348: C36 in ( D24 \/ D23 ) by L347 , L215 , L346 , XBOOLE_0:def 5;
L349: ( C27 . C36 ) = H1(C36) by L348 , L163;
thus L350: thesis by L349 , L163 , L343 , L348 , FUNCT_1:def 3;
end;
L351: D27 = ( rng C27 ) by L341 , L216 , XBOOLE_0:def 10;
L352: ( C27 .: D31 ) = D30 by L351 , L155 , FUNCT_1:77;
L353: ( ( D24 /\ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) = ( ( dom C27 ) /\ ( C27 " D30 ) ) by L163 , XBOOLE_1:23;
L354: ( ( D24 /\ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) = ( C27 " D30 ) by L353 , RELAT_1:132 , XBOOLE_1:28;
L355: ( D23 /\ ( C27 " D30 ) ) c= D23 by XBOOLE_1:17;
L356: ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) c= ( ( finSeg D20 ) \ { R5 } ) by L355 , L215 , XBOOLE_1:13;
L357: ( finSeg D29 ) , ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) are_equipotent  by L356 , L336 , L335 , CARD_1:33 , XBOOLE_1:1;
L358: ( card ( finSeg D29 ) ) = ( card ( ( D24 \ ( C27 " D30 ) ) \/ ( D23 /\ ( C27 " D30 ) ) ) ) by L357 , CARD_1:5
.= ( ( card ( D24 \ ( ( C27 " D30 ) /\ D24 ) ) ) + ( card ( D23 /\ ( C27 " D30 ) ) ) ) by L340 , L355 , L337 , CARD_2:40 , XBOOLE_1:64
.= ( ( ( card D24 ) - ( card ( ( C27 " D30 ) /\ D24 ) ) ) + ( card ( D23 /\ ( C27 " D30 ) ) ) ) by CARD_2:44 , XBOOLE_1:17;
per cases ;
suppose L359: R6 > R5;

reconsider D35 = ( R6 - R5 ) as (Element of ( NAT )) by L359 , NAT_1:21;
L360: ( card D30 ) = ( ( ( ( card ( D24 /\ D31 ) ) + ( card ( finSeg D29 ) ) ) - ( card D24 ) ) + ( card ( D31 /\ D24 ) ) ) by L340 , L286 , L355 , L354 , L196 , L352 , L358 , CARD_2:40 , XBOOLE_1:64
.= ( ( ( 2 * ( card ( D24 /\ D31 ) ) ) + ( card ( finSeg D29 ) ) ) - ( card D24 ) )
.= ( ( ( 2 * ( card ( D24 /\ D31 ) ) ) + D29 ) - ( card D24 ) ) by FINSEQ_1:57
.= ( ( ( 2 * ( card ( D24 /\ D31 ) ) ) + D29 ) - D22 ) by FINSEQ_1:57
.= ( ( 2 * ( card ( D24 /\ D31 ) ) ) + D35 );
thus L361: ( (the multF of C26) $$ (D27 , ( Part_sgn (R15 , C26) )) ) = ( D34 . (( - ( 1_ C26 ) ) , ( ( 2 * ( card ( D24 /\ D31 ) ) ) + D35 )) ) by L360 , L106
.= ( ( D34 . (( - ( 1_ C26 ) ) , ( 2 * ( card ( D24 /\ D31 ) ) )) ) * ( D34 . (( - ( 1_ C26 ) ) , D35) ) ) by HURWITZ:3
.= ( ( 1_ C26 ) * ( D34 . (( - ( 1_ C26 ) ) , D35) ) ) by HURWITZ:4
.= ( ( D34 . (( - ( 1_ C26 ) ) , ( 2 * D32 )) ) * ( D34 . (( - ( 1_ C26 ) ) , D35) ) ) by HURWITZ:4
.= ( D34 . (( - ( 1_ C26 ) ) , ( ( 2 * R5 ) + D35 )) ) by HURWITZ:3
.= ( D34 . (( - ( 1_ C26 ) ) , ( R5 + R6 )) );
end;
suppose L362: R6 <= R5;

reconsider D36 = ( R5 - R6 ) as (Element of ( NAT )) by L362 , NAT_1:21;
L363: ( card D30 ) = ( ( ( ( card D24 ) + ( card ( D23 /\ D31 ) ) ) - ( card ( finSeg D29 ) ) ) + ( card ( D23 /\ D31 ) ) ) by L340 , L286 , L355 , L354 , L196 , L352 , L358 , CARD_2:40 , XBOOLE_1:64
.= ( ( ( 2 * ( card ( D23 /\ D31 ) ) ) - ( card ( finSeg D29 ) ) ) + ( card D24 ) )
.= ( ( ( 2 * ( card ( D23 /\ D31 ) ) ) - D29 ) + ( card D24 ) ) by FINSEQ_1:57
.= ( ( ( 2 * ( card ( D23 /\ D31 ) ) ) - D29 ) + D22 ) by FINSEQ_1:57
.= ( ( 2 * ( card ( D23 /\ D31 ) ) ) + D36 );
thus L364: ( (the multF of C26) $$ (D27 , ( Part_sgn (R15 , C26) )) ) = ( D34 . (( - ( 1_ C26 ) ) , ( ( 2 * ( card ( D23 /\ D31 ) ) ) + D36 )) ) by L363 , L106
.= ( ( D34 . (( - ( 1_ C26 ) ) , ( 2 * ( card ( D23 /\ D31 ) ) )) ) * ( D34 . (( - ( 1_ C26 ) ) , D36) ) ) by HURWITZ:3
.= ( ( 1_ C26 ) * ( D34 . (( - ( 1_ C26 ) ) , D36) ) ) by HURWITZ:4
.= ( ( D34 . (( - ( 1_ C26 ) ) , ( 2 * D33 )) ) * ( D34 . (( - ( 1_ C26 ) ) , D36) ) ) by HURWITZ:4
.= ( D34 . (( - ( 1_ C26 ) ) , ( ( 2 * R6 ) + D36 )) ) by HURWITZ:3
.= ( D34 . (( - ( 1_ C26 ) ) , ( R5 + R6 )) );
end;
end;
theorem
L366: (for R9 being Nat holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg ( R9 + 1 ) ) & R9 >= 2) implies (ex B26 being (Function of ( 2Set ( Seg R9 ) ) , ( 2Set ( Seg ( R9 + 1 ) ) )) st (( rng B26 ) = ( ( 2Set ( Seg ( R9 + 1 ) ) ) \ { { R3 , R5 } where R3 is (Element of ( NAT )) : { R3 , R5 } in ( 2Set ( Seg ( R9 + 1 ) ) ) } ) & B26 is  one-to-one & (for R7 being Nat holds (for R8 being Nat holds ((R7 < R8 & { R7 , R8 } in ( 2Set ( Seg R9 ) )) implies (((R8 < R5 & R7 < R5) implies ( B26 . { R7 , R8 } ) = { R7 , R8 }) & ((R8 >= R5 & R7 < R5) implies ( B26 . { R7 , R8 } ) = { R7 , ( R8 + 1 ) }) & ((R8 >= R5 & R7 >= R5) implies ( B26 . { R7 , R8 } ) = { ( R7 + 1 ) , ( R8 + 1 ) })))))))))))
proof
let R9 being Nat;
let C37 , C38 being Nat;
assume that
L367: C37 in ( Seg ( R9 + 1 ) )
and
L368: R9 >= 2;
defpred S1[ set , set ] means (for B27 , B28 being Nat holds (({ B27 , B28 } = $1 & B27 < B28) implies (((B28 < C37 & B27 < C37) implies $2 = { B27 , B28 }) & ((B28 >= C37 & B27 < C37) implies $2 = { B27 , ( B28 + 1 ) }) & ((B28 >= C37 & B27 >= C37) implies $2 = { ( B27 + 1 ) , ( B28 + 1 ) }))));
set D37 = { { R3 , C37 } where R3 is (Element of ( NAT )) : { R3 , C37 } in ( 2Set ( Seg ( R9 + 1 ) ) ) };
set D38 = ( 2Set ( Seg R9 ) );
set D39 = ( R9 + 1 );
set D40 = ( 2Set ( Seg D39 ) );
L369: (for B29 , B30 being Nat holds ({ B29 , B30 } in D37 implies (B29 = C37 or B30 = C37)))
proof
let C39 , C40 being Nat;
assume L370: { C39 , C40 } in D37;
consider C41 being (Element of ( NAT )) such that L371: { C39 , C40 } = { C41 , C37 } and L372: { C41 , C37 } in D40 by L370;
L373: C37 in { C37 , C41 } by TARSKI:def 2;
thus L374: thesis by L373 , L371 , TARSKI:def 2;
end;
L375: (for R1 being set holds (R1 in D38 implies (ex R2 being set st (R2 in ( D40 \ D37 ) & S1[ R1 , R2 ]))))
proof
L376: R9 <= ( R9 + 1 ) by NAT_1:11;
L377: ( Seg R9 ) c= ( Seg D39 ) by L376 , FINSEQ_1:5;
reconsider D41 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
let R1 being set;
assume L378: R1 in D38;
consider C42 , C43 being Nat such that L379: C42 in ( Seg R9 ) and L380: C43 in ( Seg R9 ) and L381: C42 < C43 and L382: R1 = { C42 , C43 } by L378 , MATRIX11:1;
L383: ( C43 + 1 ) in ( Seg ( D41 + 1 ) ) by L380 , FINSEQ_1:60;
reconsider D42 = C42 as (Element of ( NAT )) by ORDINAL1:def 12;
L384: ( D42 + 1 ) in ( Seg ( D41 + 1 ) ) by L379 , FINSEQ_1:60;
per cases ;
suppose L385: (C43 < C37 & C42 < C37);

L386: (not { C42 , C43 } in D37) by L385 , L369;
L387: { C42 , C43 } in D40 by L379 , L380 , L381 , L377 , MATRIX11:1;
L388: { C42 , C43 } in ( D40 \ D37 ) by L387 , L386 , XBOOLE_0:def 5;
L389: S1[ { C42 , C43 } , { C42 , C43 } ] by L385 , ZFMISC_1:6;
thus L390: thesis by L389 , L382 , L388;
end;
suppose L391: (C43 >= C37 & C42 < C37);

L392: S1[ { C42 , C43 } , { C42 , ( C43 + 1 ) } ]
proof
let C44 , C45 being Nat;
assume that
L393: { C44 , C45 } = { C42 , C43 }
and
L394: C44 < C45;
L395: (C44 = C42 or C44 = C43) by L393 , ZFMISC_1:6;
thus L396: thesis by L395 , L391 , L393 , ZFMISC_1:6;
end;
L397: ( C43 + 1 ) > C37 by L391 , NAT_1:13;
L398: (not { C42 , ( C43 + 1 ) } in D37) by L397 , L369 , L391;
L399: ( C43 + 1 ) > C42 by L381 , NAT_1:13;
L400: { C42 , ( C43 + 1 ) } in D40 by L399 , L379 , L377 , L383 , MATRIX11:1;
L401: { C42 , ( C43 + 1 ) } in ( D40 \ D37 ) by L400 , L398 , XBOOLE_0:def 5;
thus L402: thesis by L401 , L382 , L392;
end;
suppose L403: (C43 < C37 & C42 >= C37);

thus L404: thesis by L403 , L381 , XXREAL_0:2;
end;
suppose L405: (C43 >= C37 & C42 >= C37);

L406: S1[ { C42 , C43 } , { ( C42 + 1 ) , ( C43 + 1 ) } ]
proof
let C46 , C47 being Nat;
assume that
L407: { C46 , C47 } = { C42 , C43 }
and
L408: C46 < C47;
L409: (C46 = C42 or C46 = C43) by L407 , ZFMISC_1:6;
thus L410: thesis by L409 , L405 , L407 , L408 , ZFMISC_1:6;
end;
L411: ( C42 + 1 ) > C37 by L405 , NAT_1:13;
L412: ( C43 + 1 ) > ( C42 + 1 ) by L381 , XREAL_1:8;
L413: { ( C42 + 1 ) , ( C43 + 1 ) } in D40 by L412 , L383 , L384 , MATRIX11:1;
L414: ( C43 + 1 ) > C37 by L405 , NAT_1:13;
L415: (not { ( C42 + 1 ) , ( C43 + 1 ) } in D37) by L414 , L369 , L411;
L416: { ( C42 + 1 ) , ( C43 + 1 ) } in ( D40 \ D37 ) by L415 , L413 , XBOOLE_0:def 5;
thus L417: thesis by L416 , L382 , L406;
end;
end;
consider C48 being (Function of D38 , ( D40 \ D37 )) such that L419: (for R1 being set holds (R1 in D38 implies S1[ R1 , ( C48 . R1 ) ])) from FUNCT_2:sch 1(L375);
L420: (ex R2 being set st (R2 in ( D40 \ D37 ) & S1[ { 1 , 2 } , R2 ])) by L368 , L375 , MATRIX11:3;
reconsider D43 = ( D40 \ D37 ) as non  empty set by L420;
reconsider D44 = C48 as (Function of D38 , D43);
L421: D43 c= ( rng D44 )
proof
let R1 being set;
assume that
L422: R1 in D43;
consider C49 , C50 being Nat such that L423: C49 in ( Seg D39 ) and L424: C50 in ( Seg D39 ) and L425: C49 < C50 and L426: R1 = { C49 , C50 } by L422 , MATRIX11:1;
L427: (C49 <> C37 & C50 <> C37)
proof
assume L428: (C49 = C37 or C50 = C37);
L429: R1 in D37 by L428 , L422 , L423 , L424 , L426;
thus L430: thesis by L429 , L422 , XBOOLE_0:def 5;
end;
L431: 1 <= C50 by L424 , FINSEQ_1:1;
L432: 1 <= C49 by L423 , FINSEQ_1:1;
reconsider D45 = ( C49 - 1 ) , D46 = ( C50 - 1 ) as (Element of ( NAT )) by L432 , L431 , NAT_1:21;
reconsider D47 = C50 , D48 = C49 as (Element of ( NAT )) by ORDINAL1:def 12;
per cases  by L427 , XXREAL_0:1;
suppose L433: (C49 < C37 & C50 < C37);

L434: C37 <= ( R9 + 1 ) by L367 , FINSEQ_1:1;
L435: C49 < ( R9 + 1 ) by L434 , L433 , XXREAL_0:2;
L436: C49 <= R9 by L435 , NAT_1:13;
L437: C50 < ( R9 + 1 ) by L433 , L434 , XXREAL_0:2;
L438: C50 <= R9 by L437 , NAT_1:13;
L439: 1 <= C50 by L424 , FINSEQ_1:1;
L440: C50 in ( Seg R9 ) by L439 , L438 , FINSEQ_1:1;
L441: ( dom D44 ) = D38 by FUNCT_2:def 1;
L442: 1 <= C49 by L423 , FINSEQ_1:1;
L443: C49 in ( Seg R9 ) by L442 , L436 , FINSEQ_1:1;
L444: { D48 , D47 } in D38 by L443 , L425 , L440 , MATRIX11:1;
L445: R1 = ( D44 . R1 ) by L444 , L419 , L425 , L426 , L433;
thus L446: thesis by L445 , L426 , L444 , L441 , FUNCT_1:def 3;
end;
suppose L447: (C49 > C37 & C50 < C37);

thus L448: thesis by L447 , L425 , XXREAL_0:2;
end;
suppose L449: (C49 < C37 & C50 > C37);

L450: 1 <= C37 by L367 , FINSEQ_1:1;
L451: 1 < ( D46 + 1 ) by L450 , L449 , XXREAL_0:2;
L452: C37 <= D46 by L451 , L449 , NAT_1:13;
L453: C49 < D46 by L452 , L449 , XXREAL_0:2;
L454: C37 <= ( R9 + 1 ) by L367 , FINSEQ_1:1;
L455: C49 < ( R9 + 1 ) by L454 , L449 , XXREAL_0:2;
L456: C49 <= R9 by L455 , NAT_1:13;
L457: ( dom D44 ) = D38 by FUNCT_2:def 1;
L458: ( D46 + 1 ) <= ( R9 + 1 ) by L424 , FINSEQ_1:1;
L459: D46 < ( R9 + 1 ) by L458 , NAT_1:13;
L460: D46 <= R9 by L459 , NAT_1:13;
L461: 1 <= D46 by L451 , NAT_1:13;
L462: D46 in ( Seg R9 ) by L461 , L460;
L463: 1 <= C49 by L423 , FINSEQ_1:1;
L464: C49 in ( Seg R9 ) by L463 , L456 , FINSEQ_1:1;
L465: { D48 , D46 } in D38 by L464 , L462 , L453 , MATRIX11:1;
L466: ( D44 . { D48 , D46 } ) = { D48 , ( D46 + 1 ) } by L465 , L419 , L449 , L452 , L453;
thus L467: thesis by L466 , L426 , L465 , L457 , FUNCT_1:def 3;
end;
suppose L468: (C49 > C37 & C50 > C37);

L469: ( D45 + 1 ) <= ( R9 + 1 ) by L423 , FINSEQ_1:1;
L470: D45 < ( R9 + 1 ) by L469 , NAT_1:13;
L471: D45 <= R9 by L470 , NAT_1:13;
L472: ( dom D44 ) = D38 by FUNCT_2:def 1;
L473: ( D46 + 1 ) <= ( R9 + 1 ) by L424 , FINSEQ_1:1;
L474: D46 < ( R9 + 1 ) by L473 , NAT_1:13;
L475: D46 <= R9 by L474 , NAT_1:13;
L476: D45 < D46 by L425 , XREAL_1:9;
L477: 1 <= C37 by L367 , FINSEQ_1:1;
L478: 1 < ( D46 + 1 ) by L477 , L468 , XXREAL_0:2;
L479: 1 < ( D45 + 1 ) by L468 , L477 , XXREAL_0:2;
L480: C37 <= D45 by L479 , L468 , NAT_1:13;
L481: 1 <= D45 by L479 , NAT_1:13;
L482: D45 in ( Seg R9 ) by L481 , L471;
L483: 1 <= D46 by L478 , NAT_1:13;
L484: D46 in ( Seg R9 ) by L483 , L475;
L485: { D45 , D46 } in D38 by L484 , L482 , L476 , MATRIX11:1;
L486: C37 <= D46 by L468 , L478 , NAT_1:13;
L487: ( D44 . { D45 , D46 } ) = { ( D45 + 1 ) , ( D46 + 1 ) } by L486 , L419 , L480 , L476 , L485;
thus L488: thesis by L487 , L426 , L485 , L472 , FUNCT_1:def 3;
end;
end;
L490: ( rng D44 ) c= D43 by RELAT_1:def 19;
L491: D43 = ( rng D44 ) by L490 , L421 , XBOOLE_0:def 10;
L492: ( dom D44 ) = D38 by FUNCT_2:def 1;
reconsider D49 = D44 as (Function of D38 , D40) by L492 , L491 , FUNCT_2:2;
take D49;
L493: (for B31 , B32 being set holds ((B31 in D38 & B32 in D38 & ( D49 . B31 ) = ( D49 . B32 )) implies B31 = B32))
proof
let C51 , C52 being set;
assume that
L494: C51 in D38
and
L495: C52 in D38
and
L496: ( D49 . C51 ) = ( D49 . C52 );
consider C53 , C54 being Nat such that L497: C53 in ( Seg R9 ) and L498: C54 in ( Seg R9 ) and L499: C53 < C54 and L500: C52 = { C53 , C54 } by L495 , MATRIX11:1;
consider C55 , C56 being Nat such that L501: C55 in ( Seg R9 ) and L502: C56 in ( Seg R9 ) and L503: C55 < C56 and L504: C51 = { C55 , C56 } by L494 , MATRIX11:1;
reconsider D50 = C56 , D51 = C54 , D52 = C55 , D53 = C53 as (Element of ( NAT )) by ORDINAL1:def 12;
per cases ;
suppose L505: (D52 < C37 & D50 < C37 & D53 < C37 & D51 < C37);

L506: ( D49 . C51 ) = C51 by L505 , L419 , L494 , L503 , L504;
thus L507: thesis by L506 , L419 , L495 , L496 , L499 , L500 , L505;
end;
suppose L508: (D52 < C37 & D50 < C37 & (D53 < C37 or D53 >= C37) & D51 >= C37);

L509: (( D49 . C52 ) = { D53 , ( D51 + 1 ) } or ( D49 . C52 ) = { ( D53 + 1 ) , ( D51 + 1 ) }) by L508 , L419 , L495 , L499 , L500;
L510: ( D49 . C51 ) = { D52 , D50 } by L419 , L494 , L503 , L504 , L508;
L511: (((D52 = D53 or D52 = ( D51 + 1 )) & (D50 = D53 or D50 = ( D51 + 1 ))) or ((D52 = ( D53 + 1 ) or D52 = ( D51 + 1 )) & (D50 = ( D53 + 1 ) or D50 = ( D51 + 1 )))) by L510 , L496 , L509 , ZFMISC_1:6;
thus L512: thesis by L511 , L503 , L508 , NAT_1:13;
end;
suppose L513: (D52 < C37 & D50 >= C37 & D53 < C37 & D51 >= C37);

L514: ( D49 . C52 ) = { D53 , ( D51 + 1 ) } by L513 , L419 , L495 , L499 , L500;
L515: ( D49 . C51 ) = { D52 , ( D50 + 1 ) } by L419 , L494 , L503 , L504 , L513;
L516: (( D50 + 1 ) = D53 or ( D50 + 1 ) = ( D51 + 1 )) by L515 , L496 , L514 , ZFMISC_1:6;
L517: (D52 = D53 or D52 = ( D51 + 1 )) by L496 , L515 , L514 , ZFMISC_1:6;
thus L518: thesis by L517 , L504 , L500 , L513 , L516 , NAT_1:13;
end;
suppose L519: (D52 < C37 & D50 >= C37 & ((D53 >= C37 & D51 >= C37) or (D53 < C37 & D51 < C37)));

L520: (( D49 . C52 ) = { ( D53 + 1 ) , ( D51 + 1 ) } or ( D49 . C52 ) = { D53 , D51 }) by L519 , L419 , L495 , L499 , L500;
L521: ( D49 . C51 ) = { D52 , ( D50 + 1 ) } by L419 , L494 , L503 , L504 , L519;
L522: (((D52 = ( D53 + 1 ) or D52 = ( D51 + 1 )) & (( D50 + 1 ) = ( D53 + 1 ) or ( D50 + 1 ) = ( D51 + 1 ))) or ((D52 = D53 or D52 = D51) & (( D50 + 1 ) = D53 or ( D50 + 1 ) = D51))) by L521 , L496 , L520 , ZFMISC_1:6;
thus L523: thesis by L522 , L519 , NAT_1:13;
end;
suppose L524: ((D52 >= C37 & D50 < C37) or (D53 >= C37 & D51 < C37));

thus L525: thesis by L524 , L503 , L499 , XXREAL_0:2;
end;
suppose L526: (D52 >= C37 & D50 >= C37 & D53 >= C37 & D51 >= C37);

L527: ( D49 . C52 ) = { ( D53 + 1 ) , ( D51 + 1 ) } by L526 , L419 , L495 , L499 , L500;
L528: ( D49 . C51 ) = { ( D52 + 1 ) , ( D50 + 1 ) } by L419 , L494 , L503 , L504 , L526;
L529: (( D50 + 1 ) = ( D53 + 1 ) or ( D50 + 1 ) = ( D51 + 1 )) by L528 , L496 , L527 , ZFMISC_1:6;
L530: (( D52 + 1 ) = ( D53 + 1 ) or ( D52 + 1 ) = ( D51 + 1 )) by L496 , L528 , L527 , ZFMISC_1:6;
thus L531: thesis by L530 , L503 , L504 , L500 , L529;
end;
suppose L532: (D52 >= C37 & D50 >= C37 & ((D53 < C37 & D51 < C37) or (D53 < C37 & D51 >= C37)));

L533: (( D49 . C52 ) = { D53 , D51 } or ( D49 . C52 ) = { D53 , ( D51 + 1 ) }) by L532 , L419 , L495 , L499 , L500;
L534: ( D49 . C51 ) = { ( D52 + 1 ) , ( D50 + 1 ) } by L419 , L494 , L503 , L504 , L532;
L535: (((( D52 + 1 ) = D53 or ( D52 + 1 ) = D51) & (( D50 + 1 ) = D53 or ( D50 + 1 ) = D51)) or ((( D52 + 1 ) = D53 or ( D52 + 1 ) = ( D51 + 1 )) & (( D50 + 1 ) = D53 or ( D50 + 1 ) = ( D51 + 1 )))) by L534 , L496 , L533 , ZFMISC_1:6;
thus L536: thesis by L535 , L503 , L532 , NAT_1:13;
end;
end;
thus L538: thesis by L493 , L419 , L421 , L490 , FUNCT_2:19 , XBOOLE_0:def 10;
end;
theorem
L539: (for R9 being Nat holds (R9 < 2 implies (for B33 being (Element of ( Permutations R9 )) holds (B33 is  even & B33 = ( idseq R9 )))))
proof
let R9 being Nat;
assume L540: R9 < 2;
let C57 being (Element of ( Permutations R9 ));
reconsider D54 = C57 as (Permutation of ( Seg R9 )) by MATRIX_2:def 9;
L541:
now
per cases  by L540 , NAT_1:23;
suppose L542: R9 = ( 0 );

L543: ( Seg R9 ) = ( {} ) by L542;
L544: ( len ( Permutations R9 ) ) = R9 by MATRIX_2:18;
L545: D54 = ( {} ) by L542;
thus L546: thesis by L545 , L544 , L543 , MATRIX_2:25 , RELAT_1:55;
end;
suppose L547: R9 = 1;

L548: ( len ( Permutations R9 ) ) = R9 by MATRIX_2:18;
L549: D54 = ( id ( Seg R9 ) ) by L547 , MATRIX_2:19 , TARSKI:def 1;
thus L550: thesis by L549 , L548 , MATRIX_2:25;
end;
end;
thus L552: thesis by L541;
end;
theorem
L553: (for B34 , B35 , B36 being non  empty set holds (for B37 being (Function of B34 , ( Fin B35 )) holds (for B38 being (Function of ( Fin B35 ) , B36) holds (for B39 being (BinOp of B36) holds (((for B40 , B41 being (Element of ( Fin B35 )) holds (B40 misses B41 implies ( B39 . (( B38 . B40 ) , ( B38 . B41 )) ) = ( B38 . ( B40 \/ B41 ) ))) & B39 is  commutative  associative & B39 is  having_a_unity & ( B38 . ( {} ) ) = ( the_unity_wrt B39 )) implies (for B42 being (Element of ( Fin B34 )) holds ((for R1 being set holds (for R2 being set holds ((R1 in B42 & R2 in B42 & ( B37 . R1 ) meets ( B37 . R2 )) implies R1 = R2))) implies (( B39 $$ (B42 , ( B38 * B37 )) ) = ( B39 $$ (( B37 .: B42 ) , B38) ) & ( B39 $$ (( B37 .: B42 ) , B38) ) = ( B38 . ( union ( B37 .: B42 ) ) ) & ( union ( B37 .: B42 ) ) is (Element of ( Fin B35 ))))))))))
proof
let C58 , C59 , C60 being non  empty set;
let C61 being (Function of C58 , ( Fin C59 ));
let C62 being (Function of ( Fin C59 ) , C60);
let C63 being (BinOp of C60);
assume that
L554: (for B43 , B44 being (Element of ( Fin C59 )) holds (B43 misses B44 implies ( C63 . (( C62 . B43 ) , ( C62 . B44 )) ) = ( C62 . ( B43 \/ B44 ) )))
and
L555: C63 is  commutative  associative
and
L556: C63 is  having_a_unity
and
L557: ( C62 . ( {} ) ) = ( the_unity_wrt C63 );
defpred S2[ set ] means (for B45 being (Element of ( Fin C58 )) holds ((B45 = $1 & (for R1 being set holds (for R2 being set holds ((R1 in B45 & R2 in B45 & ( C61 . R1 ) meets ( C61 . R2 )) implies R1 = R2)))) implies (( C63 $$ (B45 , ( C62 * C61 )) ) = ( C63 $$ (( C61 .: B45 ) , C62) ) & ( C63 $$ (( C61 .: B45 ) , C62) ) = ( C62 . ( union ( C61 .: B45 ) ) ) & ( union ( C61 .: B45 ) ) is (Element of ( Fin C59 )))));
L558: (for B46 being (Element of ( Fin C58 )) holds (for B47 being (Element of C58) holds ((S2[ B46 ] & (not B47 in B46)) implies S2[ ( B46 \/ { B47 } ) ])))
proof
let C64 being (Element of ( Fin C58 ));
let C65 being (Element of C58);
assume that
L559: S2[ C64 ]
and
L560: (not C65 in C64);
let C66 being (Element of ( Fin C58 ));
assume that
L561: ( C64 \/ { C65 } ) = C66
and
L562: (for R1 being set holds (for R2 being set holds ((R1 in C66 & R2 in C66 & ( C61 . R1 ) meets ( C61 . R2 )) implies R1 = R2)));
L563: (for R1 being set holds (for R2 being set holds ((R1 in C64 & R2 in C64 & ( C61 . R1 ) meets ( C61 . R2 )) implies R1 = R2)))
proof
let R1 being set;
let R2 being set;
assume that
L564: R1 in C64
and
L565: R2 in C64
and
L566: ( C61 . R1 ) meets ( C61 . R2 );
L567: C64 c= C66 by L561 , XBOOLE_1:7;
thus L568: thesis by L567 , L562 , L564 , L565 , L566;
end;
L569: ( C63 $$ (C64 , ( C62 * C61 )) ) = ( C63 $$ (( C61 .: C64 ) , C62) ) by L563 , L559;
L570: ( union ( C61 .: C64 ) ) is (Element of ( Fin C59 )) by L559 , L563;
L571: ( dom C61 ) = C58 by FUNCT_2:def 1;
L572: ( Im (C61 , C65) ) = { ( C61 . C65 ) } by L571 , FUNCT_1:59;
L573: ( C61 .: C66 ) = ( ( C61 .: C64 ) \/ { ( C61 . C65 ) } ) by L572 , L561 , RELAT_1:120;
L574: ( C63 $$ (( C61 .: C64 ) , C62) ) = ( C62 . ( union ( C61 .: C64 ) ) ) by L559 , L563;
L575: ( dom ( C62 * C61 ) ) = C58 by FUNCT_2:def 1;
L576: ( C62 . ( C61 . C65 ) ) = ( ( C62 * C61 ) . C65 ) by L575 , FUNCT_1:12;
per cases ;
suppose L577: (( C61 . C65 ) is non  empty or (not ( C61 . C65 ) in ( C61 .: C64 )));

L578: (not ( C61 . C65 ) in ( C61 .: C64 ))
proof
L579: C64 c= C66 by L561 , XBOOLE_1:7;
L580: { C65 } c= C66 by L561 , XBOOLE_1:7;
L581: C65 in { C65 } by TARSKI:def 1;
assume L582: ( C61 . C65 ) in ( C61 .: C64 );
consider R1 being set such that L583: R1 in ( dom C61 ) and L584: R1 in C64 and L585: ( C61 . R1 ) = ( C61 . C65 ) by L582 , FUNCT_1:def 6;
L586: ( C61 . R1 ) meets ( C61 . C65 ) by L577 , L582 , L585 , XBOOLE_1:66;
thus L587: thesis by L586 , L560 , L562 , L584 , L581 , L580 , L579;
end;
L588: ( C63 $$ (( C61 .: C66 ) , C62) ) = ( C63 . (( C63 $$ (( C61 .: C64 ) , C62) ) , ( ( C62 * C61 ) . C65 )) ) by L578 , L555 , L556 , L573 , L576 , SETWOP_2:2;
L589: ( C61 . C65 ) c= C59 by FINSUB_1:def 5;
L590: ( union ( C61 .: C64 ) ) c= C59 by L570 , FINSUB_1:def 5;
L591: ( ( union ( C61 .: C64 ) ) \/ ( C61 . C65 ) ) c= C59 by L590 , L589 , XBOOLE_1:8;
L592:
now
let R1 being set;
assume L593: R1 in ( C61 .: C64 );
L594: (ex R2 being set st (R2 in ( dom C61 ) & R2 in C64 & ( C61 . R2 ) = R1)) by L593 , FUNCT_1:def 6;
L595: C65 in { C65 } by TARSKI:def 1;
L596: C64 c= C66 by L561 , XBOOLE_1:7;
L597: { C65 } c= C66 by L561 , XBOOLE_1:7;
assume L598: R1 meets ( C61 . C65 );
thus L599: contradiction by L598 , L560 , L562 , L594 , L595 , L597 , L596;
end;
L600: ( union ( C61 .: C64 ) ) misses ( C61 . C65 ) by L592 , ZFMISC_1:80;
L601: ( union ( C61 .: C66 ) ) = ( ( union ( C61 .: C64 ) ) \/ ( union { ( C61 . C65 ) } ) ) by L573 , ZFMISC_1:78
.= ( ( union ( C61 .: C64 ) ) \/ ( C61 . C65 ) ) by ZFMISC_1:25;
thus L602: thesis by L601 , L554 , L555 , L556 , L560 , L561 , L569 , L574 , L570 , L576 , L588 , L591 , L600 , FINSUB_1:def 5 , SETWOP_2:2;
end;
suppose L603: (( C61 . C65 ) is  empty & ( C61 . C65 ) in ( C61 .: C64 ));

L604: ( ( C61 .: C64 ) \/ { ( C61 . C65 ) } ) = ( C61 .: C64 ) by L603 , ZFMISC_1:40;
L605: ( C63 $$ (C66 , ( C62 * C61 )) ) = ( C63 . (( C63 $$ (( C61 .: C64 ) , C62) ) , ( the_unity_wrt C63 )) ) by L555 , L556 , L557 , L560 , L561 , L569 , L576 , L603 , SETWOP_2:2
.= ( C63 $$ (( C61 .: C66 ) , C62) ) by L556 , L573 , L604 , SETWISEO:15;
thus L606: thesis by L605 , L559 , L563 , L573 , L604;
end;
end;
L608: S2[ ( {}. C58 ) ]
proof
L609: ( {} ) c= C59 by XBOOLE_1:2;
let C67 being (Element of ( Fin C58 ));
assume that
L610: ( {}. C58 ) = C67
and
L611: (for R1 being set holds (for R2 being set holds ((R1 in C67 & R2 in C67 & ( C61 . R1 ) meets ( C61 . R2 )) implies R1 = R2)));
L612: ( C61 .: C67 ) = ( {}. ( Fin C59 ) ) by L610;
L613: ( C63 $$ (C67 , ( C62 * C61 )) ) = ( C62 . ( {} ) ) by L555 , L556 , L557 , L610 , SETWISEO:31;
thus L614: thesis by L613 , L555 , L556 , L557 , L612 , L609 , FINSUB_1:def 5 , SETWISEO:31 , ZFMISC_1:2;
end;
L615: (for B48 being (Element of ( Fin C58 )) holds S2[ B48 ]) from SETWISEO:sch 2(L608 , L558);
thus L616: thesis by L615;
end;
begin
definition
let C68 , C69 , C70 being Nat;
let R16 being Field;
let C71 being (Matrix of C70 , R16);
assume that
L617: C68 in ( Seg C70 )
and
L618: C69 in ( Seg C70 );
func Delete (C71 , C68 , C69) -> (Matrix of ( C70 -' 1 ) , R16) equals 
:L619: ( Deleting (C71 , C68 , C69) );
coherence
proof
set D55 = ( Deleting (C71 , C68 , C69) );
L620: ( width C71 ) = C70 by MATRIX_1:24;
L621: ( len C71 ) = C70 by MATRIX_1:24;
L622: ( dom C71 ) = ( Seg C70 ) by L621 , FINSEQ_1:def 3;
L623: ( len D55 ) = ( C70 -' 1 ) by L622 , L617 , L5;
per cases ;
suppose L624: ( C70 -' 1 ) = ( 0 );

L625: ( dom D55 ) = ( Seg ( 0 ) ) by L624 , L623 , FINSEQ_1:def 3;
L626: (for R18 being (FinSequence of R16) holds (R18 in ( rng D55 ) implies ( len R18 ) = ( C70 -' 1 ))) by L625 , RELAT_1:42;
thus L627: thesis by L626 , L623 , MATRIX_1:def 2;
end;
suppose L628: ( C70 -' 1 ) > ( 0 );

L629: ( width ( Deleting (C71 , C68 , C69) ) ) = ( C70 -' 1 ) by L618 , L620 , L44;
thus L630: thesis by L629 , L623 , L628 , MATRIX_1:20;
end;
end;
end;
theorem
L633: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg R9 ) & R6 in ( Seg R9 )) implies (for R7 being Nat holds (for R8 being Nat holds ((R7 in ( Seg ( R9 -' 1 ) ) & R8 in ( Seg ( R9 -' 1 ) )) implies (((R7 < R5 & R8 < R6) implies ( ( Delete (R22 , R5 , R6) ) * (R7 , R8) ) = ( R22 * (R7 , R8) )) & ((R7 < R5 & R8 >= R6) implies ( ( Delete (R22 , R5 , R6) ) * (R7 , R8) ) = ( R22 * (R7 , ( R8 + 1 )) )) & ((R7 >= R5 & R8 < R6) implies ( ( Delete (R22 , R5 , R6) ) * (R7 , R8) ) = ( R22 * (( R7 + 1 ) , R8) )) & ((R7 >= R5 & R8 >= R6) implies ( ( Delete (R22 , R5 , R6) ) * (R7 , R8) ) = ( R22 * (( R7 + 1 ) , ( R8 + 1 )) ))))))))))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
let R5 being Nat;
let R6 being Nat;
assume that
L634: R5 in ( Seg R9 )
and
L635: R6 in ( Seg R9 );
set D56 = ( Delete (R22 , R5 , R6) );
L636: ( Deleting (R22 , R5 , R6) ) = D56 by L634 , L635 , L619;
L637: R9 > ( 0 ) by L634;
reconsider D57 = ( R9 - 1 ) as (Element of ( NAT )) by L637 , NAT_1:20;
set D58 = ( DelLine (R22 , R5) );
let R7 being Nat;
let R8 being Nat;
assume that
L638: R7 in ( Seg ( R9 -' 1 ) )
and
L639: R8 in ( Seg ( R9 -' 1 ) );
L640: ( R9 -' 1 ) = D57 by XREAL_0:def 2;
L641: ( R7 + 1 ) in ( Seg ( D57 + 1 ) ) by L640 , L638 , FINSEQ_1:60;
reconsider D59 = R5 , D60 = R6 , D61 = R7 , D62 = R8 as (Element of ( NAT )) by ORDINAL1:def 12;
L642: D57 <= ( D57 + 1 ) by NAT_1:11;
L643: ( Seg D57 ) c= ( Seg R9 ) by L642 , FINSEQ_1:5;
L644: ( len R22 ) = R9 by MATRIX_1:24;
L645: ( dom R22 ) = ( Seg R9 ) by L644 , FINSEQ_1:def 3;
L646: ( len D58 ) = D57 by L645 , L634 , L640 , L644 , L1;
L647: ( dom D58 ) = ( Seg D57 ) by L646 , FINSEQ_1:def 3;
L648: ( ( Deleting (R22 , R5 , R6) ) . R7 ) = ( Del (( Line (D58 , R7) ) , R6) ) by L647 , L638 , L640 , MATRIX_2:def 5;
L649: ( len D56 ) = D57 by L640 , MATRIX_1:24;
L650: ( dom D56 ) = ( Seg D57 ) by L649 , FINSEQ_1:def 3;
L651: ( D56 . R7 ) = ( Line (D56 , R7) ) by L650 , L638 , L640 , MATRIX_2:16;
L652: ( width D56 ) = D57 by L640 , MATRIX_1:24;
L653: ( ( Line (D56 , R7) ) . R8 ) = ( D56 * (R7 , R8) ) by L652 , L639 , L640 , MATRIX_1:def 7;
L654: ( Line (D58 , R7) ) = ( D58 . R7 ) by L638 , L640 , L647 , MATRIX_2:16;
L655: ( R8 + 1 ) in ( Seg ( D57 + 1 ) ) by L639 , L640 , FINSEQ_1:60;
L656: (D61 >= D59 implies ((D62 < D60 implies ( D56 * (D61 , D62) ) = ( R22 * (( D61 + 1 ) , D62) )) & (D62 >= D60 implies ( D56 * (D61 , D62) ) = ( R22 * (( D61 + 1 ) , ( D62 + 1 )) ))))
proof
assume L657: D61 >= D59;
L658: D61 <= D57 by L638 , L640 , FINSEQ_1:1;
L659: ( D58 . D61 ) = ( R22 . ( D61 + 1 ) ) by L658 , L634 , L644 , L645 , L641 , L657 , FINSEQ_3:111;
L660: ( R22 . ( D61 + 1 ) ) = ( Line (R22 , ( D61 + 1 )) ) by L645 , L641 , MATRIX_2:16;
thus L661: (D62 < D60 implies ( D56 * (D61 , D62) ) = ( R22 * (( D61 + 1 ) , D62) ))
proof
L662: ( width R22 ) = R9 by MATRIX_1:24;
assume L663: D62 < D60;
L664: ( D56 * (D61 , D62) ) = ( ( Line (R22 , ( D61 + 1 )) ) . D62 ) by L663 , L648 , L636 , L651 , L653 , L654 , L659 , L660 , FINSEQ_3:110;
thus L665: thesis by L664 , L639 , L640 , L643 , L662 , MATRIX_1:def 7;
end;

assume L666: D62 >= D60;
L667: D62 <= D57 by L639 , L640 , FINSEQ_1:1;
L668: ( width R22 ) = R9 by MATRIX_1:24;
L669: ( len ( Line (D58 , D61) ) ) = ( width R22 ) by L654 , L659 , L660 , MATRIX_1:def 7;
L670: D60 in ( dom ( Line (D58 , D61) ) ) by L669 , L635 , L668 , FINSEQ_1:def 3;
L671: ( D56 * (D61 , D62) ) = ( ( Line (R22 , ( D61 + 1 )) ) . ( D62 + 1 ) ) by L670 , L648 , L636 , L651 , L653 , L654 , L641 , L659 , L660 , L666 , L669 , L667 , FINSEQ_3:111 , MATRIX_1:24;
thus L672: thesis by L671 , L655 , L668 , MATRIX_1:def 7;
end;
L673: (D61 < D59 implies ((D62 < D60 implies ( D56 * (D61 , D62) ) = ( R22 * (D61 , D62) )) & (D62 >= D60 implies ( D56 * (D61 , D62) ) = ( R22 * (D61 , ( D62 + 1 )) ))))
proof
assume L674: D61 < D59;
L675: ( D58 . D61 ) = ( R22 . D61 ) by L674 , FINSEQ_3:110;
L676: ( R22 . D61 ) = ( Line (R22 , D61) ) by L638 , L640 , L645 , L643 , MATRIX_2:16;
thus L677: (D62 < D60 implies ( D56 * (D61 , D62) ) = ( R22 * (D61 , D62) ))
proof
assume L678: D62 < D60;
L679: ( width R22 ) = ( D57 + 1 ) by MATRIX_1:24;
L680: ( D56 * (D61 , D62) ) = ( ( Line (R22 , D61) ) . D62 ) by L648 , L636 , L651 , L653 , L654 , L675 , L676 , L678 , FINSEQ_3:110;
thus L681: thesis by L680 , L639 , L640 , L643 , L679 , MATRIX_1:def 7;
end;

assume L682: D62 >= D60;
L683: D62 <= D57 by L639 , L640 , FINSEQ_1:1;
L684: ( width R22 ) = R9 by MATRIX_1:24;
L685: ( len ( Line (D58 , D61) ) ) = ( width R22 ) by L654 , L675 , L676 , MATRIX_1:def 7;
L686: D60 in ( dom ( Line (D58 , D61) ) ) by L685 , L635 , L684 , FINSEQ_1:def 3;
L687: ( D56 * (D61 , D62) ) = ( ( Line (R22 , D61) ) . ( D62 + 1 ) ) by L686 , L648 , L636 , L651 , L653 , L654 , L641 , L675 , L676 , L682 , L685 , L683 , FINSEQ_3:111 , MATRIX_1:24;
thus L688: thesis by L687 , L655 , L684 , MATRIX_1:def 7;
end;
thus L689: thesis by L673 , L656;
end;
theorem
L690: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg R9 ) & R6 in ( Seg R9 )) implies ( ( Delete (R22 , R5 , R6) ) @ ) = ( Delete (( R22 @ ) , R6 , R5) )))))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
let R5 being Nat;
let R6 being Nat;
assume that
L691: R5 in ( Seg R9 )
and
L692: R6 in ( Seg R9 );
L693: R9 > ( 0 ) by L691;
reconsider D63 = ( R9 - 1 ) as (Element of ( NAT )) by L693 , NAT_1:20;
set D64 = ( Seg R9 );
reconsider D65 = ( R22 @ ) as (Matrix of R9 , R16);
set D66 = ( Delete (R22 , R5 , R6) );
set D67 = ( R9 -' 1 );
reconsider D68 = R5 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D69 = ( D66 @ ) as (Matrix of D67 , R16);
set D70 = ( Delete (D65 , R6 , R5) );
set D71 = ( Seg D67 );
L694: ( ( D63 + 1 ) -' 1 ) = D63 by NAT_D:34;
L695:
now
L696: D67 <= R9 by NAT_D:35;
L697: D71 c= D64 by L696 , FINSEQ_1:5;
let C72 , C73 being Nat;
assume that
L698: [ C72 , C73 ] in ( Indices D69 );
L699: [ C73 , C72 ] in ( Indices D66 ) by L698 , MATRIX_1:def 6;
L700: ( D69 * (C72 , C73) ) = ( D66 * (C73 , C72) ) by L699 , MATRIX_1:def 6;
reconsider D72 = C72 , D73 = C73 as (Element of ( NAT )) by ORDINAL1:def 12;
L701: ( Indices D69 ) = [: D71 , D71 :] by MATRIX_1:24;
L702: C72 in D71 by L701 , L698 , ZFMISC_1:87;
L703: ( C72 + 1 ) in D64 by L702 , L694 , FINSEQ_1:60;
L704: ( Indices R22 ) = [: D64 , D64 :] by MATRIX_1:24;
L705: C73 in D71 by L698 , L701 , ZFMISC_1:87;
L706: ( C73 + 1 ) in D64 by L705 , L694 , FINSEQ_1:60;
per cases ;
suppose L707: (D73 < D68 & D72 < R6);

L708: ( D70 * (C72 , C73) ) = ( D65 * (C72 , C73) ) by L707 , L691 , L692 , L702 , L705 , L633;
L709: [ C73 , C72 ] in ( Indices R22 ) by L702 , L705 , L697 , L704 , ZFMISC_1:87;
L710: ( D66 * (C73 , C72) ) = ( R22 * (C73 , C72) ) by L691 , L692 , L702 , L705 , L707 , L633;
thus L711: ( D69 * (C72 , C73) ) = ( D70 * (C72 , C73) ) by L710 , L700 , L709 , L708 , MATRIX_1:def 6;
end;
suppose L712: (D73 < D68 & D72 >= R6);

L713: ( D70 * (C72 , C73) ) = ( D65 * (( C72 + 1 ) , C73) ) by L712 , L691 , L692 , L702 , L705 , L633;
L714: [ C73 , ( C72 + 1 ) ] in ( Indices R22 ) by L705 , L697 , L703 , L704 , ZFMISC_1:87;
L715: ( D66 * (C73 , C72) ) = ( R22 * (C73 , ( C72 + 1 )) ) by L691 , L692 , L702 , L705 , L712 , L633;
thus L716: ( D69 * (C72 , C73) ) = ( D70 * (C72 , C73) ) by L715 , L700 , L714 , L713 , MATRIX_1:def 6;
end;
suppose L717: (D73 >= D68 & D72 < R6);

L718: ( D70 * (C72 , C73) ) = ( D65 * (C72 , ( C73 + 1 )) ) by L717 , L691 , L692 , L702 , L705 , L633;
L719: [ ( C73 + 1 ) , C72 ] in ( Indices R22 ) by L702 , L697 , L706 , L704 , ZFMISC_1:87;
L720: ( D66 * (C73 , C72) ) = ( R22 * (( C73 + 1 ) , C72) ) by L691 , L692 , L702 , L705 , L717 , L633;
thus L721: ( D69 * (C72 , C73) ) = ( D70 * (C72 , C73) ) by L720 , L700 , L719 , L718 , MATRIX_1:def 6;
end;
suppose L722: (D73 >= D68 & D72 >= R6);

L723: ( D70 * (C72 , C73) ) = ( D65 * (( C72 + 1 ) , ( C73 + 1 )) ) by L722 , L691 , L692 , L702 , L705 , L633;
L724: [ ( C73 + 1 ) , ( C72 + 1 ) ] in ( Indices R22 ) by L703 , L706 , L704 , ZFMISC_1:87;
L725: ( D66 * (C73 , C72) ) = ( R22 * (( C73 + 1 ) , ( C72 + 1 )) ) by L691 , L692 , L702 , L705 , L722 , L633;
thus L726: ( D69 * (C72 , C73) ) = ( D70 * (C72 , C73) ) by L725 , L700 , L724 , L723 , MATRIX_1:def 6;
end;
end;
thus L728: thesis by L695 , MATRIX_1:27;
end;
theorem
L729: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (for B49 being (FinSequence of R16) holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg R9 ) & R6 in ( Seg R9 )) implies ( Delete (R22 , R5 , R6) ) = ( Delete (( RLine (R22 , R5 , B49) ) , R5 , R6) ))))))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
let C74 being (FinSequence of R16);
let R5 being Nat;
let R6 being Nat;
assume that
L730: R5 in ( Seg R9 )
and
L731: R6 in ( Seg R9 );
L732: ( Delete (R22 , R5 , R6) ) = ( Deleting (R22 , R5 , R6) ) by L730 , L731 , L619;
L733: ( Delete (( RLine (R22 , R5 , C74) ) , R5 , R6) ) = ( Deleting (( RLine (R22 , R5 , C74) ) , R5 , R6) ) by L730 , L731 , L619;
reconsider D74 = C74 as (Element of ( (the carrier of R16) * )) by FINSEQ_1:def 11;
reconsider D75 = R5 as (Element of ( NAT )) by ORDINAL1:def 12;
per cases ;
suppose L734: ( len C74 ) = ( width R22 );

L735: ( RLine (R22 , D75 , C74) ) = ( Replace (R22 , R5 , D74) ) by L734 , MATRIX11:29;
thus L736: thesis by L735 , L732 , L733 , COMPUT_1:3;
end;
suppose L737: ( len C74 ) <> ( width R22 );

thus L738: thesis by L737 , MATRIX11:def 3;
end;
end;
definition
let R4 being Nat;
let R9 being Nat;
let R8 being Nat;
let R10 being non  empty set;
let C75 being (Matrix of R9 , R8 , R10);
let C76 being (FinSequence of R10);
func ReplaceCol (C75 , R4 , C76) -> (Matrix of R9 , R8 , R10) means 
:L740: (( len it ) = ( len C75 ) & ( width it ) = ( width C75 ) & (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices C75 ) implies ((R6 <> R4 implies ( it * (R5 , R6) ) = ( C75 * (R5 , R6) )) & (R6 = R4 implies ( it * (R5 , R4) ) = ( C76 . R5 ))))))) if ( len C76 ) = ( len C75 ) otherwise it = C75;
consistency;
existence
proof
thus L741: (( len C76 ) = ( len C75 ) implies (ex B50 being (Matrix of R9 , R8 , R10) st (( len B50 ) = ( len C75 ) & ( width B50 ) = ( width C75 ) & (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices C75 ) implies ((R6 <> R4 implies ( B50 * (R5 , R6) ) = ( C75 * (R5 , R6) )) & (R6 = R4 implies ( B50 * (R5 , R4) ) = ( C76 . R5 )))))))))
proof
reconsider D76 = C75 as (Matrix of ( len C75 ) , ( width C75 ) , R10) by MATRIX_2:7;
reconsider D77 = R9 , D78 = R8 as (Element of ( NAT )) by ORDINAL1:def 12;
defpred S3[ set , set , set ] means (for R5 being Nat holds (for R6 being Nat holds ((R5 = $1 & R6 = $2) implies ((R6 <> R4 implies $3 = ( C75 * (R5 , R6) )) & (R6 = R4 implies $3 = ( C76 . R5 ))))));
assume L742: ( len C76 ) = ( len C75 );
L743: (for B51 , B52 being Nat holds ([ B51 , B52 ] in [: ( Seg D77 ) , ( Seg D78 ) :] implies (ex B53 being (Element of R10) st S3[ B51 , B52 , B53 ])))
proof
let C77 , C78 being Nat;
assume that
L744: [ C77 , C78 ] in [: ( Seg D77 ) , ( Seg D78 ) :];
L745:
now
per cases ;
case L746: C78 = R4;
L747: ( rng C76 ) c= R10 by FINSEQ_1:def 4;
L748: ( len C75 ) = R9 by MATRIX_1:def 2;
L749: C77 in ( Seg ( len C76 ) ) by L748 , L742 , L744 , ZFMISC_1:87;
L750: C77 in ( dom C76 ) by L749 , FINSEQ_1:def 3;
L751: ( C76 . C77 ) in ( rng C76 ) by L750 , FUNCT_1:def 3;
L752: S3[ C77 , C78 , ( C76 . C77 ) ] by L746;
thus L753: thesis by L752 , L751 , L747;
end;
case L754: C78 <> R4;
L755: S3[ C77 , C78 , ( C75 * (C77 , C78) ) ] by L754;
thus L756: thesis by L755;
end;
end;
thus L758: thesis by L745;
end;
consider C79 being (Matrix of D77 , D78 , R10) such that L759: (for B54 , B55 being Nat holds ([ B54 , B55 ] in ( Indices C79 ) implies S3[ B54 , B55 , ( C79 * (B54 , B55) ) ])) from MATRIX_1:sch 2(L743);
reconsider D79 = C79 as (Matrix of R9 , R8 , R10);
take D79;
L760:
now
per cases ;
suppose L761: R9 = ( 0 );

L762: ( len D79 ) = ( 0 ) by L761 , MATRIX_1:def 2;
L763: ( width D79 ) = ( 0 ) by L762 , MATRIX_1:def 3;
L764: ( len C75 ) = ( 0 ) by L761 , MATRIX_1:def 2;
thus L765: (( len C75 ) = ( len D79 ) & ( width D79 ) = ( width C75 )) by L764 , L761 , L763 , MATRIX_1:def 2 , MATRIX_1:def 3;
end;
suppose L766: R9 > ( 0 );

L767: ( width C75 ) = R8 by L766 , MATRIX_1:23;
L768: ( len C75 ) = R9 by L766 , MATRIX_1:23;
thus L769: (( len C75 ) = ( len D79 ) & ( width C75 ) = ( width D79 )) by L768 , L766 , L767 , MATRIX_1:23;
end;
end;
L771: ( Indices D76 ) = ( Indices D79 ) by MATRIX_1:26;
thus L772: thesis by L771 , L759 , L760;
end;

thus L773: thesis;
end;
uniqueness
proof
let C80 , C81 being (Matrix of R9 , R8 , R10);
thus L774: ((( len C76 ) = ( len C75 ) & ( len C80 ) = ( len C75 ) & ( width C80 ) = ( width C75 ) & (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices C75 ) implies ((R6 <> R4 implies ( C80 * (R5 , R6) ) = ( C75 * (R5 , R6) )) & (R6 = R4 implies ( C80 * (R5 , R4) ) = ( C76 . R5 )))))) & ( len C81 ) = ( len C75 ) & ( width C81 ) = ( width C75 ) & (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices C75 ) implies ((R6 <> R4 implies ( C81 * (R5 , R6) ) = ( C75 * (R5 , R6) )) & (R6 = R4 implies ( C81 * (R5 , R4) ) = ( C76 . R5 ))))))) implies C80 = C81)
proof
assume L775: ( len C76 ) = ( len C75 );
assume that
L776: ( len C80 ) = ( len C75 )
and
L777: ( width C80 ) = ( width C75 )
and
L778: (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices C75 ) implies ((R6 <> R4 implies ( C80 * (R5 , R6) ) = ( C75 * (R5 , R6) )) & (R6 = R4 implies ( C80 * (R5 , R4) ) = ( C76 . R5 ))))));
assume that
L779: ( len C81 ) = ( len C75 )
and
L780: ( width C81 ) = ( width C75 )
and
L781: (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices C75 ) implies ((R6 <> R4 implies ( C81 * (R5 , R6) ) = ( C75 * (R5 , R6) )) & (R6 = R4 implies ( C81 * (R5 , R4) ) = ( C76 . R5 ))))));
L782: (for B56 , B57 being Nat holds ([ B56 , B57 ] in ( Indices C80 ) implies ( C80 * (B56 , B57) ) = ( C81 * (B56 , B57) )))
proof
let C82 , C83 being Nat;
assume L783: [ C82 , C83 ] in ( Indices C80 );
L784: [ C82 , C83 ] in ( Indices C75 ) by L783 , L776 , L777 , MATRIX_4:55;
reconsider D80 = C82 , D81 = C83 as (Element of ( NAT )) by ORDINAL1:def 12;
L785: (D81 = R4 implies ( C80 * (D80 , R4) ) = ( C76 . D80 )) by L778 , L784;
L786: (D81 <> R4 implies ( C81 * (D80 , D81) ) = ( C75 * (D80 , D81) )) by L781 , L784;
L787: (D81 <> R4 implies ( C80 * (D80 , D81) ) = ( C75 * (D80 , D81) )) by L778 , L784;
thus L788: thesis by L787 , L781 , L784 , L785 , L786;
end;
thus L789: thesis by L782 , MATRIX_1:27;
end;

thus L790: thesis;
end;
end;
notation
let R4 being Nat;
let R9 being Nat;
let R8 being Nat;
let R10 being non  empty set;
let C84 being (Matrix of R9 , R8 , R10);
let C85 being (FinSequence of R10);
synonym RCol (C84 , R4 , C85) for ReplaceCol (C84 , R4 , C85);
end;
theorem
L793: (for R4 being Nat holds (for R8 being Nat holds (for R9 being Nat holds (for R10 being non  empty set holds (for R20 being (Matrix of R9 , R8 , R10) holds (for R21 being (FinSequence of R10) holds (for R5 being Nat holds (R5 in ( Seg ( width R20 ) ) implies (((R5 = R4 & ( len R21 ) = ( len R20 )) implies ( Col (( RCol (R20 , R4 , R21) ) , R5) ) = R21) & (R5 <> R4 implies ( Col (( RCol (R20 , R4 , R21) ) , R5) ) = ( Col (R20 , R5) )))))))))))
proof
let R4 being Nat;
let R8 being Nat;
let R9 being Nat;
let R10 being non  empty set;
let R20 being (Matrix of R9 , R8 , R10);
let R21 being (FinSequence of R10);
let R5 being Nat;
assume that
L794: R5 in ( Seg ( width R20 ) );
set D82 = ( RCol (R20 , R4 , R21) );
set D83 = ( Col (D82 , R5) );
thus L795: ((R5 = R4 & ( len R21 ) = ( len R20 )) implies D83 = R21)
proof
assume that
L796: R5 = R4
and
L797: ( len R21 ) = ( len R20 );
L798: ( len D82 ) = ( len R21 ) by L797 , L740;
L799:
now
let C86 being Nat;
assume that
L800: 1 <= C86
and
L801: C86 <= ( len R21 );
L802: C86 in ( NAT ) by ORDINAL1:def 12;
L803: C86 in ( Seg ( len R21 ) ) by L802 , L800 , L801;
L804: C86 in ( dom D82 ) by L803 , L798 , FINSEQ_1:def 3;
L805: R5 in ( Seg ( width D82 ) ) by L794 , L797 , L740;
L806: [ C86 , R4 ] in ( Indices D82 ) by L805 , L796 , L804 , ZFMISC_1:87;
L807: ( Indices D82 ) = ( Indices R20 ) by MATRIX_1:26;
L808: ( D83 . C86 ) = ( D82 * (C86 , R4) ) by L796 , L804 , MATRIX_1:def 8;
thus L809: ( D83 . C86 ) = ( R21 . C86 ) by L808 , L797 , L806 , L807 , L740;
end;
L810: ( len D83 ) = ( len R21 ) by L798 , MATRIX_1:def 8;
thus L811: thesis by L810 , L799 , FINSEQ_1:14;
end;

set D84 = ( Col (R20 , R5) );
L812: ( len R20 ) = R9 by MATRIX_1:def 2;
L813: ( len D82 ) = R9 by MATRIX_1:def 2;
L814: ( len R20 ) = ( len D84 ) by MATRIX_1:def 8;
assume L815: R5 <> R4;
L816:
now
let C87 being Nat;
assume that
L817: 1 <= C87
and
L818: C87 <= ( len D84 );
L819: C87 in ( NAT ) by ORDINAL1:def 12;
L820: C87 in ( Seg ( len R20 ) ) by L819 , L814 , L817 , L818;
L821: C87 in ( dom R20 ) by L820 , FINSEQ_1:def 3;
L822: ( D84 . C87 ) = ( R20 * (C87 , R5) ) by L821 , MATRIX_1:def 8;
L823: C87 in ( dom D82 ) by L812 , L813 , L820 , FINSEQ_1:def 3;
L824: ( D83 . C87 ) = ( D82 * (C87 , R5) ) by L823 , MATRIX_1:def 8;
L825: [ C87 , R5 ] in ( Indices R20 ) by L794 , L821 , ZFMISC_1:87;
per cases ;
suppose L826: ( len R21 ) = ( len R20 );

thus L827: ( D84 . C87 ) = ( D83 . C87 ) by L826 , L815 , L822 , L824 , L825 , L740;
end;
suppose L828: ( len R21 ) <> ( len R20 );

thus L829: ( D84 . C87 ) = ( D83 . C87 ) by L828 , L740;
end;
end;
L831: ( len D83 ) = ( len D82 ) by MATRIX_1:def 8;
thus L832: thesis by L831 , L812 , L813 , L814 , L816 , FINSEQ_1:14;
end;
theorem
L833: (for R4 being Nat holds (for R8 being Nat holds (for R9 being Nat holds (for R10 being non  empty set holds (for R20 being (Matrix of R9 , R8 , R10) holds (for R21 being (FinSequence of R10) holds ((not R4 in ( Seg ( width R20 ) )) implies ( RCol (R20 , R4 , R21) ) = R20)))))))
proof
let R4 being Nat;
let R8 being Nat;
let R9 being Nat;
let R10 being non  empty set;
let R20 being (Matrix of R9 , R8 , R10);
let R21 being (FinSequence of R10);
assume L834: (not R4 in ( Seg ( width R20 ) ));
set D85 = ( RCol (R20 , R4 , R21) );
per cases ;
suppose L835: ( len R21 ) = ( len R20 );

L836:
now
let C88 , C89 being Nat;
assume that
L837: [ C88 , C89 ] in ( Indices R20 );
L838: C89 in ( Seg ( width R20 ) ) by L837 , ZFMISC_1:87;
thus L839: ( D85 * (C88 , C89) ) = ( R20 * (C88 , C89) ) by L838 , L834 , L835 , L837 , L740;
end;
thus L840: thesis by L836 , MATRIX_1:27;
end;
suppose L841: ( len R21 ) <> ( len R20 );

thus L842: thesis by L841 , L740;
end;
end;
theorem
L844: (for R4 being Nat holds (for R8 being Nat holds (for R9 being Nat holds (for R10 being non  empty set holds (for R20 being (Matrix of R9 , R8 , R10) holds ( RCol (R20 , R4 , ( Col (R20 , R4) )) ) = R20)))))
proof
let R4 being Nat;
let R8 being Nat;
let R9 being Nat;
let R10 being non  empty set;
let R20 being (Matrix of R9 , R8 , R10);
set D86 = ( Col (R20 , R4) );
set D87 = ( RCol (R20 , R4 , D86) );
L845:
now
reconsider D88 = R4 as (Element of ( NAT )) by ORDINAL1:def 12;
let C90 , C91 being Nat;
assume that
L846: [ C90 , C91 ] in ( Indices R20 );
L847: ( len D86 ) = ( len R20 ) by MATRIX_1:def 8;
reconsider D89 = C90 , D90 = C91 as (Element of ( NAT )) by ORDINAL1:def 12;
L848: C90 in ( dom R20 ) by L846 , ZFMISC_1:87;
L849:
now
per cases ;
suppose L850: D88 = C91;

thus L851: ( D87 * (C90 , C91) ) = ( D86 . D89 ) by L850 , L846 , L847 , L740
.= ( R20 * (C90 , C91) ) by L848 , L850 , MATRIX_1:def 8;
end;
suppose L852: D88 <> D90;

thus L853: ( D87 * (C90 , C91) ) = ( R20 * (C90 , C91) ) by L852 , L846 , L847 , L740;
end;
end;
thus L855: ( D87 * (C90 , C91) ) = ( R20 * (C90 , C91) ) by L849;
end;
thus L856: thesis by L845 , MATRIX_1:27;
end;
theorem
L857: (for R4 being Nat holds (for R8 being Nat holds (for R9 being Nat holds (for R10 being non  empty set holds (for R21 being (FinSequence of R10) holds (for B58 being (Matrix of R9 , R8 , R10) holds (for B59 being (Matrix of R8 , R9 , R10) holds ((B59 = ( B58 @ ) & (R8 = ( 0 ) implies R9 = ( 0 ))) implies ( ReplaceCol (B58 , R4 , R21) ) = ( ( ReplaceLine (B59 , R4 , R21) ) @ )))))))))
proof
let R4 being Nat;
let R8 being Nat;
let R9 being Nat;
let R10 being non  empty set;
let R21 being (FinSequence of R10);
let C92 being (Matrix of R9 , R8 , R10);
let C93 being (Matrix of R8 , R9 , R10);
assume that
L858: C93 = ( C92 @ )
and
L859: (R8 = ( 0 ) implies R9 = ( 0 ));
set D91 = ( ReplaceCol (C92 , R4 , R21) );
set D92 = ( ReplaceLine (C93 , R4 , R21) );
L860:
now
per cases ;
suppose L861: R9 = ( 0 );

L862: ( 0 ) = ( len C92 ) by L861 , MATRIX_1:def 2;
L863: ( 0 ) = ( width C92 ) by L862 , MATRIX_1:def 3
.= ( len C93 ) by L858 , MATRIX_1:def 6;
L864: R8 = ( 0 ) by L863 , MATRIX_1:def 2;
L865: ( len D92 ) = ( 0 ) by L864 , MATRIX_1:def 2;
L866: ( width D92 ) = ( 0 ) by L865 , MATRIX_1:def 3;
L867: ( len ( D92 @ ) ) = ( 0 ) by L866 , MATRIX_1:def 6;
L868: ( D92 @ ) = ( {} ) by L867;
L869: ( len D91 ) = ( 0 ) by L861 , MATRIX_1:def 2;
thus L870: thesis by L869 , L868;
end;
suppose L871: (( len R21 ) <> ( len C92 ) & R9 > ( 0 ));

L872: ( width C92 ) = R8 by L871 , MATRIX_1:23;
L873: ( width C93 ) = ( len C92 ) by L872 , L858 , L859 , L871 , MATRIX_2:10;
L874: ( len C92 ) = R9 by L871 , MATRIX_1:23;
thus L875: D91 = C92 by L871 , L740
.= ( ( C92 @ ) @ ) by L859 , L871 , L874 , L872 , MATRIX_2:13
.= ( D92 @ ) by L858 , L871 , L873 , MATRIX11:def 3;
end;
suppose L876: (( len R21 ) = ( len C92 ) & R9 > ( 0 ));

L877: ( width D92 ) = R9 by L876 , L859 , MATRIX_1:23;
L878: ( len ( D92 @ ) ) = R9 by L877 , L876 , MATRIX_2:10;
L879: ( len D92 ) = R8 by L859 , L876 , MATRIX_1:23;
L880: ( width ( D92 @ ) ) = R8 by L879 , L876 , L877 , MATRIX_2:10;
reconsider D93 = ( D92 @ ) as (Matrix of R9 , R8 , R10) by L880 , L878 , MATRIX_2:7;
L881: ( len C92 ) = R9 by L876 , MATRIX_1:23;
L882: ( width C93 ) = R9 by L859 , L876 , MATRIX_1:23;
L883:
now
L884: ( Indices D91 ) = ( Indices C92 ) by MATRIX_1:26;
L885: ( Indices D92 ) = ( Indices C93 ) by MATRIX_1:26;
let C94 , C95 being Nat;
assume that
L886: [ C94 , C95 ] in ( Indices D91 );
reconsider D94 = C94 , D95 = C95 as (Element of ( NAT )) by ORDINAL1:def 12;
L887: ( Indices D91 ) = ( Indices D93 ) by MATRIX_1:26;
L888: [ C95 , C94 ] in ( Indices D92 ) by L887 , L886 , MATRIX_1:def 6;
per cases ;
suppose L889: D95 = R4;

thus L890: ( D91 * (C94 , C95) ) = ( R21 . D94 ) by L889 , L876 , L886 , L884 , L740
.= ( D92 * (D95 , D94) ) by L876 , L881 , L882 , L888 , L885 , L889 , MATRIX11:def 3
.= ( D93 * (C94 , C95) ) by L888 , MATRIX_1:def 6;
end;
suppose L891: D95 <> R4;

thus L892: ( D91 * (C94 , C95) ) = ( C92 * (D94 , D95) ) by L891 , L876 , L886 , L884 , L740
.= ( C93 * (C95 , C94) ) by L858 , L886 , L884 , MATRIX_1:def 6
.= ( D92 * (D95 , D94) ) by L876 , L881 , L882 , L888 , L885 , L891 , MATRIX11:def 3
.= ( D93 * (C94 , C95) ) by L888 , MATRIX_1:def 6;
end;
end;
thus L894: thesis by L883 , MATRIX_1:27;
end;
end;
thus L896: thesis by L860;
end;
begin
definition
let R5 being Nat;
let R9 being Nat;
let C96 being (Element of ( Permutations ( R9 + 1 ) ));
assume L897: R5 in ( Seg ( R9 + 1 ) );
func Rem (C96 , R5) -> (Element of ( Permutations R9 )) means 
:L898: (for R7 being Nat holds (R7 in ( Seg R9 ) implies ((R7 < R5 implies ((( C96 . R7 ) < ( C96 . R5 ) implies ( it . R7 ) = ( C96 . R7 )) & (( C96 . R7 ) >= ( C96 . R5 ) implies ( it . R7 ) = ( ( C96 . R7 ) - 1 )))) & (R7 >= R5 implies ((( C96 . ( R7 + 1 ) ) < ( C96 . R5 ) implies ( it . R7 ) = ( C96 . ( R7 + 1 ) )) & (( C96 . ( R7 + 1 ) ) >= ( C96 . R5 ) implies ( it . R7 ) = ( ( C96 . ( R7 + 1 ) ) - 1 )))))));
existence
proof
set D96 = ( C96 . R5 );
set D97 = ( Permutations R9 );
set D98 = C96;
set D99 = ( R9 + 1 );
reconsider D100 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D101 = D98 as (Permutation of ( Seg D99 )) by MATRIX_2:def 9;
L899: ( dom D101 ) = ( Seg D99 ) by FUNCT_2:52;
defpred S4[ set , set ] means (for R7 being Nat holds ((R7 in ( Seg R9 ) & $1 = R7) implies ((R7 < R5 implies ((( D98 . R7 ) < D96 implies $2 = ( D98 . R7 )) & (( D98 . R7 ) >= D96 implies $2 = ( ( D98 . R7 ) - 1 )))) & (R7 >= R5 implies ((( D98 . ( R7 + 1 ) ) < D96 implies $2 = ( D98 . ( R7 + 1 ) )) & (( D98 . ( R7 + 1 ) ) >= D96 implies $2 = ( ( D98 . ( R7 + 1 ) ) - 1 )))))));
L900: ( rng D101 ) = ( Seg D99 ) by FUNCT_2:def 3;
L901: D96 in ( Seg D99 ) by L900 , L897 , L899 , FUNCT_1:def 3;
L902: (for B60 being set holds (B60 in ( Seg R9 ) implies (ex R2 being set st (R2 in ( Seg R9 ) & S4[ B60 , R2 ]))))
proof
let C97 being set;
assume L903: C97 in ( Seg R9 );
consider C98 being (Element of ( NAT )) such that L904: C97 = C98 and L905: 1 <= C98 and L906: C98 <= R9 by L903;
L907: C98 < D99 by L906 , NAT_1:13;
L908: C98 in ( Seg D99 ) by L907 , L905;
L909: ( D98 . C98 ) in ( Seg D99 ) by L908 , L899 , L900 , FUNCT_1:def 3;
set D102 = ( C98 + 1 );
L910: ( 1 + ( 0 ) ) <= ( C98 + 1 ) by NAT_1:13;
L911: ( C98 + 1 ) <= D99 by L907 , NAT_1:13;
L912: ( C98 + 1 ) in ( Seg D99 ) by L911 , L910;
L913: ( D98 . ( C98 + 1 ) ) in ( Seg D99 ) by L912 , L899 , L900 , FUNCT_1:def 3;
per cases ;
suppose L914: (C98 < R5 & ( D98 . C98 ) < D96);

L915: D96 <= D99 by L901 , FINSEQ_1:1;
L916: ( D98 . C98 ) < D99 by L915 , L914 , XXREAL_0:2;
L917: ( D98 . C98 ) <= R9 by L916 , NAT_1:13;
L918: S4[ C97 , ( D98 . C98 ) ] by L904 , L914;
L919: 1 <= ( D98 . C98 ) by L909 , FINSEQ_1:1;
L920: ( D98 . C98 ) in ( Seg R9 ) by L919 , L917 , FINSEQ_1:1;
thus L921: thesis by L920 , L918;
end;
suppose L922: (C98 < R5 & ( D98 . C98 ) >= D96);

L923: ( D101 . C98 ) <> ( D101 . R5 ) by L922 , L897 , L908 , FUNCT_2:19;
L924: ( D98 . C98 ) > D96 by L923 , L922 , XXREAL_0:1;
reconsider D103 = ( ( D98 . C98 ) - 1 ) as (Element of ( NAT )) by L924 , NAT_1:20;
L925: S4[ C97 , D103 ] by L904 , L922;
L926: D103 < ( D103 + 1 ) by NAT_1:13;
L927: ( D98 . C98 ) <= D99 by L909 , FINSEQ_1:1;
L928: D103 < D99 by L927 , L926 , XXREAL_0:2;
L929: D103 <= R9 by L928 , NAT_1:13;
L930: D96 >= 1 by L901 , FINSEQ_1:1;
L931: ( D103 + 1 ) > 1 by L930 , L924 , XXREAL_0:2;
L932: D103 >= 1 by L931 , NAT_1:13;
L933: D103 in ( Seg R9 ) by L932 , L929;
thus L934: thesis by L933 , L925;
end;
suppose L935: (C98 >= R5 & ( D98 . D102 ) < D96);

L936: D96 <= D99 by L901 , FINSEQ_1:1;
L937: ( D98 . D102 ) < D99 by L936 , L935 , XXREAL_0:2;
L938: ( D98 . D102 ) <= R9 by L937 , NAT_1:13;
L939: S4[ C97 , ( D98 . D102 ) ] by L904 , L935;
L940: 1 <= ( D98 . D102 ) by L913 , FINSEQ_1:1;
L941: ( D98 . D102 ) in ( Seg R9 ) by L940 , L938 , FINSEQ_1:1;
thus L942: thesis by L941 , L939;
end;
suppose L943: (C98 >= R5 & ( D98 . D102 ) >= D96);

L944: R5 < D102 by L943 , NAT_1:13;
L945: ( D101 . D102 ) <> ( D101 . R5 ) by L944 , L897 , L912 , FUNCT_2:19;
L946: ( D98 . D102 ) > D96 by L945 , L943 , XXREAL_0:1;
reconsider D104 = ( ( D98 . D102 ) - 1 ) as (Element of ( NAT )) by L946 , NAT_1:20;
L947: S4[ C97 , D104 ] by L904 , L943;
L948: D104 < ( D104 + 1 ) by NAT_1:13;
L949: ( D98 . D102 ) <= D99 by L913 , FINSEQ_1:1;
L950: D104 < D99 by L949 , L948 , XXREAL_0:2;
L951: D104 <= R9 by L950 , NAT_1:13;
L952: D96 >= 1 by L901 , FINSEQ_1:1;
L953: ( D104 + 1 ) > 1 by L952 , L946 , XXREAL_0:2;
L954: D104 >= 1 by L953 , NAT_1:13;
L955: D104 in ( Seg R9 ) by L954 , L951;
thus L956: thesis by L955 , L947;
end;
end;
consider C99 being (Function of ( Seg R9 ) , ( Seg R9 )) such that L958: (for R1 being set holds (R1 in ( Seg R9 ) implies S4[ R1 , ( C99 . R1 ) ])) from FUNCT_2:sch 1(L902);
L959: (for B61 , B62 being set holds ((B61 in ( dom C99 ) & B62 in ( dom C99 ) & ( C99 . B61 ) = ( C99 . B62 )) implies B61 = B62))
proof
let C100 , C101 being set;
assume that
L960: C100 in ( dom C99 )
and
L961: C101 in ( dom C99 )
and
L962: ( C99 . C100 ) = ( C99 . C101 );
L963: ( dom C99 ) = ( Seg R9 ) by FUNCT_2:52;
consider C102 being (Element of ( NAT )) such that L964: C100 = C102 and L965: 1 <= C102 and L966: C102 <= R9 by L963 , L960;
L967: ( ( 0 ) + 1 ) <= ( C102 + 1 ) by NAT_1:13;
L968: C102 < ( R9 + 1 ) by L966 , NAT_1:13;
L969: C102 in ( Seg D99 ) by L968 , L965;
L970: ( C102 + 1 ) <= ( R9 + 1 ) by L968 , NAT_1:13;
L971: ( C102 + 1 ) in ( Seg D99 ) by L970 , L967;
consider C103 being (Element of ( NAT )) such that L972: C101 = C103 and L973: 1 <= C103 and L974: C103 <= R9 by L961 , L963;
L975: C103 < ( R9 + 1 ) by L974 , NAT_1:13;
L976: C103 in ( Seg D99 ) by L975 , L973;
L977: ( ( 0 ) + 1 ) <= ( C103 + 1 ) by NAT_1:13;
L978: ( C103 + 1 ) <= ( R9 + 1 ) by L975 , NAT_1:13;
L979: ( C103 + 1 ) in ( Seg D99 ) by L978 , L977;
per cases ;
suppose L980: (C102 < R5 & ( D98 . C102 ) < D96);

L981: ( C99 . C102 ) = ( D101 . C102 ) by L980 , L958 , L960 , L964;
per cases ;
suppose L982: (C103 < R5 & ( D98 . C103 ) < D96);

L983: ( D101 . C103 ) = ( D101 . C102 ) by L982 , L958 , L961 , L962 , L964 , L972 , L981;
thus L984: thesis by L983 , L899 , L964 , L972 , L969 , L976 , FUNCT_1:def 4;
end;
suppose L985: (C103 < R5 & ( D98 . C103 ) >= D96);

L986: ( C99 . C103 ) = ( ( D98 . C103 ) - 1 ) by L985 , L958 , L961 , L972;
L987: ( ( D98 . C102 ) + 1 ) = ( D98 . C103 ) by L986 , L962 , L964 , L972 , L981;
L988: ( D98 . C103 ) <= D96 by L987 , L980 , NAT_1:13;
L989: ( D101 . C103 ) = ( D101 . R5 ) by L988 , L985 , XXREAL_0:1;
thus L990: thesis by L989 , L897 , L899 , L976 , L985 , FUNCT_1:def 4;
end;
suppose L991: (C103 >= R5 & ( D98 . ( C103 + 1 ) ) < D96);

L992: ( D101 . C102 ) = ( D101 . ( C103 + 1 ) ) by L991 , L958 , L961 , L962 , L964 , L972 , L981;
L993: C102 = ( C103 + 1 ) by L992 , L899 , L969 , L979 , FUNCT_1:def 4;
thus L994: thesis by L993 , L980 , L991 , NAT_1:13;
end;
suppose L995: (C103 >= R5 & ( D98 . ( C103 + 1 ) ) >= D96);

L996: ( D98 . C102 ) = ( ( D98 . ( C103 + 1 ) ) - 1 ) by L995 , L958 , L961 , L962 , L964 , L972 , L981;
L997: ( ( D98 . C102 ) + 1 ) = ( D98 . ( C103 + 1 ) ) by L996;
L998: ( D98 . ( C103 + 1 ) ) <= D96 by L997 , L980 , NAT_1:13;
L999: ( D101 . ( C103 + 1 ) ) = ( D98 . R5 ) by L998 , L995 , XXREAL_0:1;
L1000: ( C103 + 1 ) = R5 by L999 , L897 , L899 , L979 , FUNCT_1:def 4;
thus L1001: thesis by L1000 , L995 , NAT_1:13;
end;
end;
suppose L1003: (C102 < R5 & ( D98 . C102 ) >= D96);

L1004: ( C99 . C102 ) = ( ( D98 . C102 ) - 1 ) by L1003 , L958 , L960 , L964;
per cases ;
suppose L1005: (C103 < R5 & ( D98 . C103 ) < D96);

L1006: ( C99 . C103 ) = ( D101 . C103 ) by L1005 , L958 , L961 , L972;
L1007: ( D98 . C102 ) = ( ( D98 . C103 ) + 1 ) by L1006 , L962 , L964 , L972 , L1004;
L1008: ( D98 . C102 ) <= D96 by L1007 , L1005 , NAT_1:13;
L1009: ( D98 . C102 ) = ( D98 . R5 ) by L1008 , L1003 , XXREAL_0:1;
thus L1010: thesis by L1009 , L897 , L899 , L969 , L1003 , FUNCT_1:def 4;
end;
suppose L1011: (C103 < R5 & ( D98 . C103 ) >= D96);

L1012: ( ( D98 . C102 ) - 1 ) = ( ( D98 . C103 ) - 1 ) by L1011 , L958 , L961 , L962 , L964 , L972 , L1004;
thus L1013: thesis by L1012 , L899 , L964 , L972 , L969 , L976 , FUNCT_1:def 4;
end;
suppose L1014: (C103 >= R5 & ( D98 . ( C103 + 1 ) ) < D96);

L1015: ( ( D98 . C102 ) - 1 ) = ( D98 . ( C103 + 1 ) ) by L1014 , L958 , L961 , L962 , L964 , L972 , L1004;
L1016: ( ( D98 . ( C103 + 1 ) ) + 1 ) = ( D98 . C102 ) by L1015;
L1017: ( D98 . C102 ) <= D96 by L1016 , L1014 , NAT_1:13;
L1018: ( D101 . C102 ) = ( D101 . R5 ) by L1017 , L1003 , XXREAL_0:1;
thus L1019: thesis by L1018 , L897 , L899 , L969 , L1003 , FUNCT_1:def 4;
end;
suppose L1020: (C103 >= R5 & ( D98 . ( C103 + 1 ) ) >= D96);

L1021: ( ( D98 . C102 ) - 1 ) = ( ( D98 . ( C103 + 1 ) ) - 1 ) by L1020 , L958 , L961 , L962 , L964 , L972 , L1004;
L1022: C102 = ( C103 + 1 ) by L1021 , L899 , L969 , L979 , FUNCT_1:def 4;
thus L1023: thesis by L1022 , L1003 , L1020 , NAT_1:13;
end;
end;
suppose L1025: (C102 >= R5 & ( D98 . ( C102 + 1 ) ) < D96);

L1026: ( C99 . C102 ) = ( D98 . ( C102 + 1 ) ) by L1025 , L958 , L960 , L964;
per cases ;
suppose L1027: (C103 < R5 & ( D98 . C103 ) < D96);

L1028: ( D101 . ( C102 + 1 ) ) = ( D101 . C103 ) by L1027 , L958 , L961 , L962 , L964 , L972 , L1026;
L1029: ( C102 + 1 ) = C103 by L1028 , L899 , L976 , L971 , FUNCT_1:def 4;
thus L1030: thesis by L1029 , L1025 , L1027 , NAT_1:13;
end;
suppose L1031: (C103 < R5 & ( D98 . C103 ) >= D96);

L1032: ( D98 . ( C102 + 1 ) ) = ( ( D98 . C103 ) - 1 ) by L1031 , L958 , L961 , L962 , L964 , L972 , L1026;
L1033: ( D98 . C103 ) = ( ( D98 . ( C102 + 1 ) ) + 1 ) by L1032;
L1034: ( D98 . C103 ) <= D96 by L1033 , L1025 , NAT_1:13;
L1035: ( D101 . C103 ) = ( D101 . R5 ) by L1034 , L1031 , XXREAL_0:1;
thus L1036: thesis by L1035 , L897 , L899 , L976 , L1031 , FUNCT_1:def 4;
end;
suppose L1037: (C103 >= R5 & ( D98 . ( C103 + 1 ) ) < D96);

L1038: ( C99 . C103 ) = ( D98 . ( C103 + 1 ) ) by L1037 , L958 , L961 , L972;
L1039: ( C102 + 1 ) = ( C103 + 1 ) by L1038 , L899 , L962 , L964 , L972 , L971 , L979 , L1026 , FUNCT_1:def 4;
thus L1040: thesis by L1039 , L964 , L972;
end;
suppose L1041: (C103 >= R5 & ( D98 . ( C103 + 1 ) ) >= D96);

L1042: ( D98 . ( C102 + 1 ) ) = ( ( D98 . ( C103 + 1 ) ) - 1 ) by L1041 , L958 , L961 , L962 , L964 , L972 , L1026;
L1043: ( D98 . ( C103 + 1 ) ) = ( ( D98 . ( C102 + 1 ) ) + 1 ) by L1042;
L1044: ( D98 . ( C103 + 1 ) ) <= D96 by L1043 , L1025 , NAT_1:13;
L1045: ( D101 . ( C103 + 1 ) ) = ( D101 . R5 ) by L1044 , L1041 , XXREAL_0:1;
L1046: ( C103 + 1 ) = R5 by L1045 , L897 , L899 , L979 , FUNCT_1:def 4;
thus L1047: thesis by L1046 , L1041 , NAT_1:13;
end;
end;
suppose L1049: (C102 >= R5 & ( D98 . ( C102 + 1 ) ) >= D96);

L1050: ( C99 . C102 ) = ( ( D98 . ( C102 + 1 ) ) - 1 ) by L1049 , L958 , L960 , L964;
per cases ;
suppose L1051: (C103 < R5 & ( D98 . C103 ) < D96);

L1052: ( ( D98 . ( C102 + 1 ) ) - 1 ) = ( D98 . C103 ) by L1051 , L958 , L961 , L962 , L964 , L972 , L1050;
L1053: ( D98 . ( C102 + 1 ) ) = ( ( D98 . C103 ) + 1 ) by L1052;
L1054: ( D98 . ( C102 + 1 ) ) <= D96 by L1053 , L1051 , NAT_1:13;
L1055: ( D101 . ( C102 + 1 ) ) = ( D101 . R5 ) by L1054 , L1049 , XXREAL_0:1;
L1056: ( C102 + 1 ) = R5 by L1055 , L897 , L899 , L971 , FUNCT_1:def 4;
thus L1057: thesis by L1056 , L1049 , NAT_1:13;
end;
suppose L1058: (C103 < R5 & ( D98 . C103 ) >= D96);

L1059: ( ( D98 . ( C102 + 1 ) ) - 1 ) = ( ( D98 . C103 ) - 1 ) by L1058 , L958 , L961 , L962 , L964 , L972 , L1050;
L1060: ( C102 + 1 ) = C103 by L1059 , L899 , L976 , L971 , FUNCT_1:def 4;
thus L1061: thesis by L1060 , L1049 , L1058 , NAT_1:13;
end;
suppose L1062: (C103 >= R5 & ( D98 . ( C103 + 1 ) ) < D96);

L1063: ( ( D98 . ( C102 + 1 ) ) - 1 ) = ( D98 . ( C103 + 1 ) ) by L1062 , L958 , L961 , L962 , L964 , L972 , L1050;
L1064: ( D98 . ( C102 + 1 ) ) = ( ( D98 . ( C103 + 1 ) ) + 1 ) by L1063;
L1065: ( D98 . ( C102 + 1 ) ) <= D96 by L1064 , L1062 , NAT_1:13;
L1066: ( D101 . ( C102 + 1 ) ) = ( D101 . R5 ) by L1065 , L1049 , XXREAL_0:1;
L1067: ( C102 + 1 ) = R5 by L1066 , L897 , L899 , L971 , FUNCT_1:def 4;
thus L1068: thesis by L1067 , L1049 , NAT_1:13;
end;
suppose L1069: (C103 >= R5 & ( D98 . ( C103 + 1 ) ) >= D96);

L1070: ( ( D98 . ( C102 + 1 ) ) - 1 ) = ( ( D98 . ( C103 + 1 ) ) - 1 ) by L1069 , L958 , L961 , L962 , L964 , L972 , L1050;
L1071: ( C102 + 1 ) = ( C103 + 1 ) by L1070 , L899 , L971 , L979 , FUNCT_1:def 4;
thus L1072: thesis by L1071 , L964 , L972;
end;
end;
end;
L1075: C99 is  one-to-one by L959 , FUNCT_1:def 4;
L1076: ( card ( finSeg D100 ) ) = ( card ( finSeg D100 ) );
L1077: C99 is  one-to-one  onto by L1076 , L1075 , STIRL2_1:60;
reconsider D105 = C99 as (Element of D97) by L1077 , MATRIX_2:def 9;
take D105;
thus L1078: thesis by L958;
end;
uniqueness
proof
set D106 = C96;
let C104 , C105 being (Element of ( Permutations R9 ));
assume that
L1079: (for R7 being Nat holds (R7 in ( Seg R9 ) implies ((R7 < R5 implies ((( D106 . R7 ) < ( D106 . R5 ) implies ( C104 . R7 ) = ( D106 . R7 )) & (( D106 . R7 ) >= ( D106 . R5 ) implies ( C104 . R7 ) = ( ( D106 . R7 ) - 1 )))) & (R7 >= R5 implies ((( D106 . ( R7 + 1 ) ) < ( D106 . R5 ) implies ( C104 . R7 ) = ( D106 . ( R7 + 1 ) )) & (( D106 . ( R7 + 1 ) ) >= ( D106 . R5 ) implies ( C104 . R7 ) = ( ( D106 . ( R7 + 1 ) ) - 1 )))))))
and
L1080: (for R7 being Nat holds (R7 in ( Seg R9 ) implies ((R7 < R5 implies ((( D106 . R7 ) < ( D106 . R5 ) implies ( C105 . R7 ) = ( D106 . R7 )) & (( D106 . R7 ) >= ( D106 . R5 ) implies ( C105 . R7 ) = ( ( D106 . R7 ) - 1 )))) & (R7 >= R5 implies ((( D106 . ( R7 + 1 ) ) < ( D106 . R5 ) implies ( C105 . R7 ) = ( D106 . ( R7 + 1 ) )) & (( D106 . ( R7 + 1 ) ) >= ( D106 . R5 ) implies ( C105 . R7 ) = ( ( D106 . ( R7 + 1 ) ) - 1 )))))));
L1081: C104 is (Permutation of ( Seg R9 )) by MATRIX_2:def 9;
L1082: ( dom C104 ) = ( Seg R9 ) by L1081 , FUNCT_2:52;
L1083:
now
let R1 being set;
assume that
L1084: R1 in ( dom C104 );
consider C106 being (Element of ( NAT )) such that L1085: R1 = C106 and L1086: 1 <= C106 and L1087: C106 <= R9 by L1082 , L1084;
set D107 = ( C106 + 1 );
L1088: (( D106 . C106 ) < ( D106 . R5 ) or ( D106 . C106 ) >= ( D106 . R5 ));
L1089: (( D106 . D107 ) < ( D106 . R5 ) or ( D106 . D107 ) >= ( D106 . R5 ));
L1090: (C106 < R5 or C106 >= R5);
L1091: ((( D106 . C106 ) < ( D106 . R5 ) & ( C104 . C106 ) = ( D106 . C106 ) & ( C105 . C106 ) = ( D106 . C106 )) or (( D106 . C106 ) >= ( D106 . R5 ) & ( C104 . C106 ) = ( ( D106 . C106 ) - 1 ) & ( C105 . C106 ) = ( ( D106 . C106 ) - 1 )) or (( D106 . D107 ) < ( D106 . R5 ) & ( C104 . C106 ) = ( D106 . D107 ) & ( C105 . C106 ) = ( D106 . D107 )) or (( D106 . D107 ) >= ( D106 . R5 ) & ( C104 . C106 ) = ( ( D106 . D107 ) - 1 ) & ( C105 . C106 ) = ( ( D106 . D107 ) - 1 ))) by L1090 , L1079 , L1080 , L1082 , L1084 , L1085 , L1088 , L1089;
thus L1092: ( C104 . R1 ) = ( C105 . R1 ) by L1091 , L1085;
end;
L1093: C105 is (Permutation of ( Seg R9 )) by MATRIX_2:def 9;
L1094: ( dom C105 ) = ( Seg R9 ) by L1093 , FUNCT_2:52;
thus L1095: thesis by L1094 , L1081 , L1083 , FUNCT_1:2 , FUNCT_2:52;
end;
end;
theorem
L1097: (for R9 being Nat holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg ( R9 + 1 ) ) & R6 in ( Seg ( R9 + 1 ) )) implies (for B63 being set holds (B63 = { R13 where R13 is (Element of ( Permutations ( R9 + 1 ) )) : ( R13 . R5 ) = R6 } implies (ex B64 being (Function of B63 , ( Permutations R9 )) st (B64 is  bijective & (for R14 being (Element of ( Permutations ( R9 + 1 ) )) holds (( R14 . R5 ) = R6 implies ( B64 . R14 ) = ( Rem (R14 , R5) )))))))))))
proof
let R9 being Nat;
let R5 being Nat;
let R6 being Nat;
assume that
L1098: R5 in ( Seg ( R9 + 1 ) )
and
L1099: R6 in ( Seg ( R9 + 1 ) );
set D108 = ( R9 + 1 );
reconsider D109 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
set D110 = ( Permutations ( D109 + 1 ) );
defpred S5[ set , set ] means (for B65 being (Element of D110) holds (($1 = B65 & ( B65 . R5 ) = R6) implies $2 = ( Rem (B65 , R5) )));
let C107 being set;
assume that
L1100: C107 = { R13 where R13 is (Element of ( Permutations ( R9 + 1 ) )) : ( R13 . R5 ) = R6 };
L1101: (for R1 being set holds (R1 in C107 implies (ex R2 being set st (R2 in ( Permutations R9 ) & S5[ R1 , R2 ]))))
proof
let R1 being set;
assume L1102: R1 in C107;
consider C108 being (Element of D110) such that L1103: C108 = R1 and L1104: ( C108 . R5 ) = R6 by L1102 , L1100;
take ( Rem (C108 , R5) );
thus L1105: thesis by L1103;
end;
consider C109 being (Function of C107 , ( Permutations R9 )) such that L1106: (for R1 being set holds (R1 in C107 implies S5[ R1 , ( C109 . R1 ) ])) from FUNCT_2:sch 1(L1101);
L1107: (for B66 , B67 being set holds ((B66 in C107 & B67 in C107 & ( C109 . B66 ) = ( C109 . B67 )) implies B66 = B67))
proof
let C110 , C111 being set;
assume that
L1108: C110 in C107
and
L1109: C111 in C107
and
L1110: ( C109 . C110 ) = ( C109 . C111 );
consider C112 being (Element of D110) such that L1111: C112 = C110 and L1112: ( C112 . R5 ) = R6 by L1100 , L1108;
set D111 = ( Rem (C112 , R5) );
L1113: ( C109 . C110 ) = D111 by L1106 , L1108 , L1111 , L1112;
consider C113 being (Element of D110) such that L1114: C113 = C111 and L1115: ( C113 . R5 ) = R6 by L1100 , L1109;
set D112 = ( Rem (C113 , R5) );
L1116: ( C109 . C111 ) = D112 by L1106 , L1109 , L1114 , L1115;
reconsider D113 = C112 , D114 = C113 as (Permutation of ( Seg D108 )) by MATRIX_2:def 9;
L1117: ( dom D114 ) = ( Seg D108 ) by FUNCT_2:52;
L1118: ( dom D113 ) = ( Seg D108 ) by FUNCT_2:52;
L1119:
now
let R1 being set;
assume that
L1120: R1 in ( Seg D108 );
consider C114 being (Element of ( NAT )) such that L1121: R1 = C114 and L1122: 1 <= C114 and L1123: C114 <= D108 by L1120;
per cases  by XXREAL_0:1;
suppose L1124: C114 < R5;

L1125: R5 <= D108 by L1098 , FINSEQ_1:1;
L1126: C114 < D108 by L1125 , L1124 , XXREAL_0:2;
L1127: C114 <= R9 by L1126 , NAT_1:13;
L1128: C114 in ( Seg R9 ) by L1127 , L1122;
per cases ;
suppose L1129: ((( C112 . C114 ) < R6 & ( C113 . C114 ) < R6) or (( C112 . C114 ) >= R6 & ( C113 . C114 ) >= R6));

L1130: ((( D111 . C114 ) = ( C112 . C114 ) & ( D112 . C114 ) = ( C113 . C114 )) or (( D111 . C114 ) = ( ( C112 . C114 ) - 1 ) & ( D112 . C114 ) = ( ( C113 . C114 ) - 1 ))) by L1129 , L1098 , L1112 , L1115 , L1124 , L1128 , L898;
thus L1131: ( C112 . R1 ) = ( C113 . R1 ) by L1130 , L1110 , L1113 , L1116 , L1121;
end;
suppose L1132: ((( C112 . C114 ) < R6 & ( C113 . C114 ) >= R6) or (( C112 . C114 ) >= R6 & ( C113 . C114 ) < R6));

L1133: ((( D111 . C114 ) = ( C112 . C114 ) & ( D112 . C114 ) = ( ( C113 . C114 ) - 1 ) & ( C112 . C114 ) < R6 & ( C113 . C114 ) >= R6) or (( D111 . C114 ) = ( ( C112 . C114 ) - 1 ) & ( D112 . C114 ) = ( C113 . C114 ) & ( C112 . C114 ) >= R6 & ( C113 . C114 ) < R6)) by L1132 , L1098 , L1112 , L1115 , L1124 , L1128 , L898;
L1134: ((( ( C112 . C114 ) + 1 ) = ( C113 . C114 ) & ( C112 . C114 ) < R6 & ( C113 . C114 ) >= R6) or (( C112 . C114 ) = ( ( C113 . C114 ) + 1 ) & ( C112 . C114 ) >= R6 & ( C113 . C114 ) < R6)) by L1133 , L1110 , L1113 , L1116;
L1135: ((( C113 . C114 ) <= R6 & ( C113 . C114 ) >= R6) or (( C112 . C114 ) >= R6 & ( C112 . C114 ) <= R6)) by L1134 , NAT_1:13;
L1136: (( D114 . C114 ) = ( D114 . R5 ) or ( D113 . C114 ) = ( D113 . R5 )) by L1135 , L1112 , L1115 , XXREAL_0:1;
thus L1137: ( C112 . R1 ) = ( C113 . R1 ) by L1136 , L1098 , L1118 , L1117 , L1120 , L1121 , L1124 , FUNCT_1:def 4;
end;
end;
suppose L1139: C114 = R5;

thus L1140: ( C112 . R1 ) = ( C113 . R1 ) by L1139 , L1112 , L1115 , L1121;
end;
suppose L1141: C114 > R5;

reconsider D115 = ( C114 - 1 ) as (Element of ( NAT )) by L1141 , NAT_1:20;
L1142: ( D115 + 1 ) > R5 by L1141;
L1143: D115 >= R5 by L1142 , NAT_1:13;
L1144: ( D115 + 1 ) <= D108 by L1123;
L1145: D115 < D108 by L1144 , NAT_1:13;
L1146: D115 <= R9 by L1145 , NAT_1:13;
L1147: 1 <= R5 by L1098 , FINSEQ_1:1;
L1148: 1 < ( D115 + 1 ) by L1147 , L1141 , XXREAL_0:2;
L1149: 1 <= D115 by L1148 , NAT_1:13;
L1150: D115 in ( Seg R9 ) by L1149 , L1146;
per cases ;
suppose L1151: ((( C112 . ( D115 + 1 ) ) < R6 & ( C113 . ( D115 + 1 ) ) < R6) or (( C112 . ( D115 + 1 ) ) >= R6 & ( C113 . ( D115 + 1 ) ) >= R6));

L1152: ((( D111 . D115 ) = ( C112 . C114 ) & ( D112 . D115 ) = ( C113 . C114 )) or (( D111 . D115 ) = ( ( C112 . C114 ) - 1 ) & ( D112 . D115 ) = ( ( C113 . C114 ) - 1 ))) by L1151 , L1098 , L1112 , L1115 , L1150 , L1143 , L898;
thus L1153: ( C112 . R1 ) = ( C113 . R1 ) by L1152 , L1110 , L1113 , L1116 , L1121;
end;
suppose L1154: ((( C112 . ( D115 + 1 ) ) < R6 & ( C113 . ( D115 + 1 ) ) >= R6) or (( C112 . ( D115 + 1 ) ) >= R6 & ( C113 . ( D115 + 1 ) ) < R6));

L1155: ((( D111 . D115 ) = ( C112 . C114 ) & ( D112 . D115 ) = ( ( C113 . C114 ) - 1 ) & ( C112 . C114 ) < R6 & ( C113 . C114 ) >= R6) or (( D111 . D115 ) = ( ( C112 . C114 ) - 1 ) & ( D112 . D115 ) = ( C113 . C114 ) & ( C112 . C114 ) >= R6 & ( C113 . C114 ) < R6)) by L1154 , L1098 , L1112 , L1115 , L1150 , L1143 , L898;
L1156: ((( ( C112 . C114 ) + 1 ) = ( C113 . C114 ) & ( C112 . C114 ) < R6 & ( C113 . C114 ) >= R6) or (( C112 . C114 ) = ( ( C113 . C114 ) + 1 ) & ( C112 . C114 ) >= R6 & ( C113 . C114 ) < R6)) by L1155 , L1110 , L1113 , L1116;
L1157: ((( C113 . C114 ) <= R6 & ( C113 . C114 ) >= R6) or (( C112 . C114 ) >= R6 & ( C112 . C114 ) <= R6)) by L1156 , NAT_1:13;
L1158: (( D114 . C114 ) = ( D114 . R5 ) or ( D113 . C114 ) = ( D113 . R5 )) by L1157 , L1112 , L1115 , XXREAL_0:1;
thus L1159: ( C112 . R1 ) = ( C113 . R1 ) by L1158 , L1098 , L1118 , L1117 , L1120 , L1121 , L1141 , FUNCT_1:def 4;
end;
end;
end;
thus L1162: thesis by L1119 , L1111 , L1114 , L1118 , L1117 , FUNCT_1:2;
end;
L1163: C109 is  one-to-one by L1107 , FUNCT_2:19;
set D116 = ( Permutations D109 );
L1164: ( card D116 ) = ( D109 ! ) by L67;
L1165: ( card C107 ) = ( D109 ! ) by L1098 , L1099 , L1100 , L78;
reconsider D117 = D116 , D118 = C107 as  finite set by L1165 , L1164;
take C109;
L1166: ( card D117 ) = ( R9 ! ) by L67;
L1167: ( card D118 ) = ( R9 ! ) by L1098 , L1099 , L1100 , L78;
L1168: C109 is  onto  one-to-one by L1167 , L1163 , L1166 , STIRL2_1:60;
thus L1169: C109 is  bijective by L1168;
let C115 being (Element of ( Permutations ( R9 + 1 ) ));
assume that
L1170: ( C115 . R5 ) = R6;
L1171: C115 in C107 by L1100 , L1170;
thus L1172: thesis by L1171 , L1106 , L1170;
end;
theorem
L1173: (for R9 being Nat holds (for R13 being (Element of ( Permutations ( R9 + 1 ) )) holds (for R16 being Field holds (for R17 being (Element of R16) holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg ( R9 + 1 ) ) & ( R13 . R5 ) = R6) implies ( - (R17 , R13) ) = ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) * ( - (R17 , ( Rem (R13 , R5) )) ) ))))))))
proof
let R9 being Nat;
let R13 being (Element of ( Permutations ( R9 + 1 ) ));
let R16 being Field;
let R17 being (Element of R16);
set D119 = ( R9 + 1 );
let R5 being Nat;
let R6 being Nat;
assume that
L1174: R5 in ( Seg D119 )
and
L1175: ( R13 . R5 ) = R6;
L1176: R13 is (Permutation of ( Seg D119 )) by MATRIX_2:def 9;
L1177: ( rng R13 ) = ( Seg D119 ) by L1176 , FUNCT_2:def 3;
L1178: ( dom R13 ) = ( Seg D119 ) by L1176 , FUNCT_2:52;
L1179: R6 in ( Seg D119 ) by L1178 , L1174 , L1175 , L1177 , FUNCT_1:def 3;
set D120 = ( Rem (R13 , R5) );
per cases  by NAT_1:23;
suppose L1180: R9 = ( 0 );

L1181: D120 is  even by L1180 , L539;
L1182: ( - (R17 , D120) ) = R17 by L1181 , MATRIX_2:def 13;
L1183: ( 1 + 1 ) = ( 2 * 1 );
L1184: R13 is  even by L1180 , L539;
L1185: ( - (R17 , R13) ) = R17 by L1184 , MATRIX_2:def 13;
L1186: R6 = 1 by L1179 , L1180 , FINSEQ_1:2 , TARSKI:def 1;
L1187: R5 = 1 by L1174 , L1180 , FINSEQ_1:2 , TARSKI:def 1;
L1188: ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) = ( 1_ R16 ) by L1187 , L1186 , L1183 , HURWITZ:4;
thus L1189: thesis by L1188 , L1185 , L1182 , VECTSP_1:def 4;
end;
suppose L1190: R9 = 1;

L1191: R13 is (Permutation of ( Seg 2 )) by L1190 , MATRIX_2:def 9;
per cases  by L1191 , MATRIX_7:1;
suppose L1192: R13 = <* 1 , 2 *>;

L1193: (R5 = 1 or R5 = 2) by L1174 , L1190 , FINSEQ_1:2 , TARSKI:def 2;
L1194: ((R5 = 1 & ( R13 . R5 ) = 1) or (R5 = 2 & ( R13 . R5 ) = 2)) by L1193 , L1192 , FINSEQ_1:44;
L1195: (( R5 + R6 ) = ( 2 * 1 ) or ( R5 + R6 ) = ( 2 * 2 )) by L1194 , L1175;
L1196: ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) = ( 1_ R16 ) by L1195 , HURWITZ:4;
L1197: ( len ( Permutations 2 ) ) = 2 by MATRIX_2:18;
L1198: D120 is  even by L1190 , L539;
L1199: ( - (R17 , D120) ) = R17 by L1198 , MATRIX_2:def 13;
L1200: ( id ( Seg 2 ) ) is  even by MATRIX_2:25;
L1201: ( - (R17 , R13) ) = R17 by L1200 , L1190 , L1192 , L1197 , FINSEQ_2:52 , MATRIX_2:def 13;
thus L1202: thesis by L1201 , L1196 , L1199 , VECTSP_1:def 4;
end;
suppose L1203: R13 = <* 2 , 1 *>;

L1204: ( len ( Permutations 2 ) ) = 2 by MATRIX_2:18;
L1205: ( - (R17 , R13) ) = ( - R17 ) by L1204 , L1190 , L1203 , MATRIX_2:def 13 , MATRIX_9:12;
L1206: ( - (R17 , R13) ) = ( - ( ( 1_ R16 ) * R17 ) ) by L1205 , VECTSP_1:def 4;
L1207: (R5 = 1 or R5 = 2) by L1174 , L1190 , FINSEQ_1:2 , TARSKI:def 2;
L1208: ( R5 + R6 ) = ( ( 2 * 1 ) + 1 ) by L1207 , L1175 , L1203 , FINSEQ_1:44;
L1209: ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) = ( - ( 1_ R16 ) ) by L1208 , HURWITZ:4;
L1210: D120 is  even by L1190 , L539;
L1211: ( - (R17 , D120) ) = R17 by L1210 , MATRIX_2:def 13;
thus L1212: thesis by L1211 , L1209 , L1206 , VECTSP_1:8;
end;
end;
suppose L1214: R9 >= 2;

reconsider D121 = ( R9 - 2 ) as (Element of ( NAT )) by L1214 , NAT_1:21;
per cases ;
suppose L1215: (not R16 is  Fanoian);

L1216:
now
per cases  by NAT_D:12;
suppose L1217: ( ( R5 + R6 ) mod 2 ) = ( 0 );

consider C116 being Nat such that L1218: ( R5 + R6 ) = ( ( 2 * C116 ) + ( 0 ) ) and L1219: ( 0 ) < 2 by L1217 , NAT_D:def 2;
L1220: C116 is (Element of ( NAT )) by ORDINAL1:def 12;
thus L1221: ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) = ( 1_ R16 ) by L1220 , L1218 , HURWITZ:4;
end;
suppose L1222: ( ( R5 + R6 ) mod 2 ) = 1;

consider C117 being Nat such that L1223: ( R5 + R6 ) = ( ( 2 * C117 ) + 1 ) and L1224: 1 < 2 by L1222 , NAT_D:def 2;
L1225: ( 1_ R16 ) = ( - ( 1_ R16 ) ) by L1215 , MATRIX11:22;
L1226: C117 is (Element of ( NAT )) by ORDINAL1:def 12;
thus L1227: ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) = ( 1_ R16 ) by L1226 , L1223 , L1225 , HURWITZ:4;
end;
end;
L1229: (( - (R17 , R13) ) = R17 or ( - (R17 , R13) ) = ( - R17 )) by MATRIX_2:def 13;
L1230: ( - ( 1_ R16 ) ) = ( 1_ R16 ) by L1215 , MATRIX11:22;
L1231: ( - ( R17 * ( 1_ R16 ) ) ) = ( R17 * ( 1_ R16 ) ) by L1230 , VECTSP_1:9;
L1232: ( - R17 ) = ( - ( R17 * ( 1_ R16 ) ) ) by VECTSP_1:def 4;
L1233: (( - (R17 , D120) ) = R17 or ( - (R17 , D120) ) = ( - R17 )) by MATRIX_2:def 13;
L1234: ( - (R17 , D120) ) = R17 by L1233 , L1232 , L1231 , VECTSP_1:def 4;
thus L1235: thesis by L1234 , L1216 , L1229 , L1231 , VECTSP_1:def 4;
end;
suppose L1236: R16 is  Fanoian;

set D122 = (the multF of R16);
reconsider D123 = ( D121 + 1 ) as (Element of ( NAT ));
set D124 = ( Permutations ( D123 + 2 ) );
reconsider D125 = R13 as (Element of D124);
set D126 = ( 2Set ( Seg ( D123 + 2 ) ) );
consider C118 being (Element of ( Fin D126 )) such that L1237: C118 = { { R3 , R5 } where R3 is (Element of ( NAT )) : { R3 , R5 } in D126 } and L1238: ( D122 $$ (C118 , ( Part_sgn (D125 , R16) )) ) = ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) by L1174 , L1175 , L1236 , L146;
set D127 = ( Part_sgn (D125 , R16) );
set D128 = ( 2Set ( Seg ( D121 + 2 ) ) );
reconsider D129 = D125 as (Permutation of ( Seg ( D123 + 2 ) )) by MATRIX_2:def 9;
set D130 = ( Permutations ( D121 + 2 ) );
reconsider D131 = D120 as (Element of D130);
reconsider D132 = D131 as (Permutation of ( Seg ( D121 + 2 ) )) by MATRIX_2:def 9;
set D133 = ( Part_sgn (D131 , R16) );
L1239: ( FinOmega D126 ) = D126 by MATRIX_2:def 14;
reconsider D134 = ( D126 \ C118 ) as (Element of ( Fin D126 )) by FINSUB_1:def 5;
L1240: ( C118 \/ D134 ) = ( D126 \/ C118 ) by XBOOLE_1:39;
L1241: C118 c= D126 by FINSUB_1:def 5;
L1242: ( C118 \/ D134 ) = D126 by L1241 , L1240 , XBOOLE_1:12;
consider C119 being (Function of D128 , D126) such that L1243: ( rng C119 ) = ( D126 \ C118 ) and L1244: C119 is  one-to-one and L1245: (for R7 being Nat holds (for R8 being Nat holds ((R7 < R8 & { R7 , R8 } in D128) implies (((R8 < R5 & R7 < R5) implies ( C119 . { R7 , R8 } ) = { R7 , R8 }) & ((R8 >= R5 & R7 < R5) implies ( C119 . { R7 , R8 } ) = { R7 , ( R8 + 1 ) }) & ((R8 >= R5 & R7 >= R5) implies ( C119 . { R7 , R8 } ) = { ( R7 + 1 ) , ( R8 + 1 ) }))))) by L1174 , L1214 , L1237 , L366;
set D135 = ( D127 * C119 );
L1246: ( dom D135 ) = D128 by FUNCT_2:def 1;
L1247: ( dom D129 ) = ( Seg ( D123 + 2 ) ) by FUNCT_2:52;
L1248:
now
L1249: R9 <= ( R9 + 1 ) by NAT_1:11;
L1250: ( Seg ( D121 + 2 ) ) c= ( Seg ( D123 + 2 ) ) by L1249 , FINSEQ_1:5;
let R1 being set;
assume that
L1251: R1 in D128;
consider C120 , C121 being Nat such that L1252: C120 in ( Seg ( D121 + 2 ) ) and L1253: C121 in ( Seg ( D121 + 2 ) ) and L1254: C120 < C121 and L1255: R1 = { C120 , C121 } by L1251 , MATRIX11:1;
reconsider D136 = C120 , D137 = C121 as (Element of ( NAT )) by ORDINAL1:def 12;
L1256: ( dom D132 ) = ( Seg ( D121 + 2 ) ) by FUNCT_2:52;
L1257: ( D132 . D136 ) <> ( D131 . D137 ) by L1256 , L1252 , L1253 , L1254 , FUNCT_1:def 4;
L1258: (( D131 . D136 ) > ( D131 . D137 ) or ( D131 . D136 ) < ( D131 . D137 )) by L1257 , XXREAL_0:1;
set D138 = ( D137 + 1 );
set D139 = ( D136 + 1 );
L1259: ( ( D121 + 2 ) + 1 ) = ( D123 + 2 );
L1260: D139 in ( Seg ( D123 + 2 ) ) by L1259 , L1252 , FINSEQ_1:60;
L1261: D138 in ( Seg ( D123 + 2 ) ) by L1253 , L1259 , FINSEQ_1:60;
per cases ;
suppose L1262: (D136 < R5 & D137 < R5);

L1263: ( D135 . R1 ) = ( D127 . ( C119 . R1 ) ) by L1246 , L1251 , FUNCT_1:12;
L1264: ( C119 . R1 ) = R1 by L1245 , L1251 , L1254 , L1255 , L1262;
per cases ;
suppose L1265: ((( D125 . D136 ) < R6 & ( D125 . D137 ) < R6) or (( D125 . D136 ) >= R6 & ( D125 . D137 ) >= R6));

L1266: ((( D131 . D136 ) = ( D125 . D136 ) & ( D131 . D137 ) = ( D125 . D137 )) or (( D131 . D136 ) = ( ( D125 . D136 ) - 1 ) & ( D131 . D137 ) = ( ( D125 . D137 ) - 1 ))) by L1265 , L1174 , L1175 , L1252 , L1253 , L1262 , L898;
L1267: ((( D131 . D136 ) < ( D131 . D137 ) & ( D125 . D136 ) < ( D125 . D137 )) or (( D131 . D136 ) > ( D131 . D137 ) & ( D125 . D136 ) > ( D125 . D137 ))) by L1266 , L1258 , XREAL_1:9;
L1268: ((( D127 . R1 ) = ( 1_ R16 ) & ( D133 . R1 ) = ( 1_ R16 )) or (( D127 . R1 ) = ( - ( 1_ R16 ) ) & ( D133 . R1 ) = ( - ( 1_ R16 ) ))) by L1267 , L1252 , L1253 , L1254 , L1255 , L1250 , MATRIX11:def 1;
thus L1269: ( D135 . R1 ) = ( D133 . R1 ) by L1268 , L1246 , L1251 , L1264 , FUNCT_1:12;
end;
suppose L1270: (( D125 . D136 ) < R6 & ( D125 . D137 ) >= R6);

L1271: ( D131 . D137 ) = ( ( D125 . D137 ) - 1 ) by L1270 , L1174 , L1175 , L1253 , L1262 , L898;
L1272: ( D125 . D137 ) = ( ( D131 . D137 ) + 1 ) by L1271;
L1273: ( D129 . D137 ) <> R6 by L1174 , L1175 , L1247 , L1253 , L1250 , L1262 , FUNCT_1:def 4;
L1274: ( D125 . D137 ) > R6 by L1273 , L1270 , XXREAL_0:1;
L1275: ( D131 . D137 ) >= R6 by L1274 , L1272 , NAT_1:13;
L1276: ( D125 . D136 ) < ( D125 . D137 ) by L1270 , XXREAL_0:2;
L1277: ( D127 . R1 ) = ( 1_ R16 ) by L1276 , L1252 , L1253 , L1254 , L1255 , L1250 , MATRIX11:def 1;
L1278: ( D125 . D136 ) = ( D131 . D136 ) by L1174 , L1175 , L1252 , L1262 , L1270 , L898;
L1279: ( D131 . D136 ) < ( D131 . D137 ) by L1278 , L1270 , L1275 , XXREAL_0:2;
thus L1280: ( D135 . R1 ) = ( D133 . R1 ) by L1279 , L1252 , L1253 , L1254 , L1255 , L1264 , L1263 , L1277 , MATRIX11:def 1;
end;
suppose L1281: (( D125 . D136 ) >= R6 & ( D125 . D137 ) < R6);

L1282: ( D131 . D136 ) = ( ( D125 . D136 ) - 1 ) by L1281 , L1174 , L1175 , L1252 , L1262 , L898;
L1283: ( D125 . D136 ) = ( ( D131 . D136 ) + 1 ) by L1282;
L1284: ( D129 . D136 ) <> R6 by L1174 , L1175 , L1247 , L1252 , L1250 , L1262 , FUNCT_1:def 4;
L1285: ( D125 . D136 ) > R6 by L1284 , L1281 , XXREAL_0:1;
L1286: ( D131 . D136 ) >= R6 by L1285 , L1283 , NAT_1:13;
L1287: ( D125 . D136 ) > ( D125 . D137 ) by L1281 , XXREAL_0:2;
L1288: ( D127 . R1 ) = ( - ( 1_ R16 ) ) by L1287 , L1252 , L1253 , L1254 , L1255 , L1250 , MATRIX11:def 1;
L1289: ( D125 . D137 ) = ( D131 . D137 ) by L1174 , L1175 , L1253 , L1262 , L1281 , L898;
L1290: ( D131 . D136 ) > ( D131 . D137 ) by L1289 , L1281 , L1286 , XXREAL_0:2;
thus L1291: ( D135 . R1 ) = ( D133 . R1 ) by L1290 , L1252 , L1253 , L1254 , L1255 , L1264 , L1263 , L1288 , MATRIX11:def 1;
end;
end;
suppose L1293: (D136 >= R5 & D137 < R5);

thus L1294: ( D135 . R1 ) = ( D133 . R1 ) by L1293 , L1254 , XXREAL_0:2;
end;
suppose L1295: (D136 < R5 & D137 >= R5);

L1296: ( D135 . R1 ) = ( D127 . ( C119 . { D136 , D137 } ) ) by L1246 , L1251 , L1255 , FUNCT_1:12;
L1297: ( C119 . { D136 , D137 } ) = { D136 , D138 } by L1245 , L1251 , L1254 , L1255 , L1295;
per cases ;
suppose L1298: ((( D125 . D136 ) < R6 & ( D125 . D138 ) < R6) or (( D125 . D136 ) >= R6 & ( D125 . D138 ) >= R6));

L1299: ((( D131 . D136 ) = ( D125 . D136 ) & ( D131 . D137 ) = ( D125 . D138 )) or (( D131 . D136 ) = ( ( D125 . D136 ) - 1 ) & ( D131 . D137 ) = ( ( D125 . D138 ) - 1 ))) by L1298 , L1174 , L1175 , L1252 , L1253 , L1295 , L898;
L1300: ((( D131 . D136 ) < ( D131 . D137 ) & ( D125 . D136 ) < ( D125 . D138 )) or (( D131 . D136 ) > ( D131 . D137 ) & ( D125 . D136 ) > ( D125 . D138 ))) by L1299 , L1258 , XREAL_1:9;
L1301: D136 < D138 by L1254 , NAT_1:13;
L1302: ((( D127 . { D136 , D138 } ) = ( 1_ R16 ) & ( D133 . R1 ) = ( 1_ R16 )) or (( D127 . { D136 , D138 } ) = ( - ( 1_ R16 ) ) & ( D133 . R1 ) = ( - ( 1_ R16 ) ))) by L1301 , L1252 , L1253 , L1254 , L1255 , L1250 , L1261 , L1300 , MATRIX11:def 1;
thus L1303: ( D135 . R1 ) = ( D133 . R1 ) by L1302 , L1246 , L1251 , L1255 , L1297 , FUNCT_1:12;
end;
suppose L1304: (( D125 . D136 ) < R6 & ( D125 . D138 ) >= R6);

L1305: D138 > R5 by L1295 , NAT_1:13;
L1306: ( D129 . D138 ) <> R6 by L1305 , L1174 , L1175 , L1247 , L1261 , FUNCT_1:def 4;
L1307: ( D125 . D138 ) > R6 by L1306 , L1304 , XXREAL_0:1;
L1308: ( D131 . D137 ) = ( ( D125 . D138 ) - 1 ) by L1174 , L1175 , L1253 , L1295 , L1304 , L898;
L1309: ( D125 . D138 ) = ( ( D131 . D137 ) + 1 ) by L1308;
L1310: ( D131 . D137 ) >= R6 by L1309 , L1307 , NAT_1:13;
L1311: ( D125 . D136 ) = ( D131 . D136 ) by L1174 , L1175 , L1252 , L1295 , L1304 , L898;
L1312: ( D131 . D136 ) < ( D131 . D137 ) by L1311 , L1304 , L1310 , XXREAL_0:2;
L1313: D136 < D138 by L1254 , NAT_1:13;
L1314: ( D125 . D136 ) < ( D125 . D138 ) by L1304 , XXREAL_0:2;
L1315: ( D127 . { D136 , D138 } ) = ( 1_ R16 ) by L1314 , L1252 , L1250 , L1261 , L1313 , MATRIX11:def 1;
thus L1316: ( D135 . R1 ) = ( D133 . R1 ) by L1315 , L1252 , L1253 , L1254 , L1255 , L1297 , L1296 , L1312 , MATRIX11:def 1;
end;
suppose L1317: (( D125 . D136 ) >= R6 & ( D125 . D138 ) < R6);

L1318: ( D131 . D136 ) = ( ( D125 . D136 ) - 1 ) by L1317 , L1174 , L1175 , L1252 , L1295 , L898;
L1319: ( D125 . D136 ) = ( ( D131 . D136 ) + 1 ) by L1318;
L1320: ( D129 . D136 ) <> R6 by L1174 , L1175 , L1247 , L1252 , L1250 , L1295 , FUNCT_1:def 4;
L1321: ( D125 . D136 ) > R6 by L1320 , L1317 , XXREAL_0:1;
L1322: ( D131 . D136 ) >= R6 by L1321 , L1319 , NAT_1:13;
L1323: ( D125 . D138 ) = ( D131 . D137 ) by L1174 , L1175 , L1253 , L1295 , L1317 , L898;
L1324: ( D131 . D137 ) < ( D131 . D136 ) by L1323 , L1317 , L1322 , XXREAL_0:2;
L1325: D136 < D138 by L1254 , NAT_1:13;
L1326: ( D125 . D136 ) > ( D125 . D138 ) by L1317 , XXREAL_0:2;
L1327: ( D127 . { D136 , D138 } ) = ( - ( 1_ R16 ) ) by L1326 , L1252 , L1250 , L1261 , L1325 , MATRIX11:def 1;
thus L1328: ( D135 . R1 ) = ( D133 . R1 ) by L1327 , L1252 , L1253 , L1254 , L1255 , L1297 , L1296 , L1324 , MATRIX11:def 1;
end;
end;
suppose L1330: (D136 >= R5 & D137 >= R5);

L1331: ( D135 . R1 ) = ( D127 . ( C119 . { D136 , D137 } ) ) by L1246 , L1251 , L1255 , FUNCT_1:12;
L1332: D139 < D138 by L1254 , XREAL_1:6;
L1333: ( C119 . { D136 , D137 } ) = { ( D136 + 1 ) , ( D137 + 1 ) } by L1245 , L1251 , L1254 , L1255 , L1330;
per cases ;
suppose L1334: ((( D125 . D139 ) < R6 & ( D125 . D138 ) < R6) or (( D125 . D139 ) >= R6 & ( D125 . D138 ) >= R6));

L1335: ((( D131 . D136 ) = ( D125 . D139 ) & ( D131 . D137 ) = ( D125 . D138 )) or (( D131 . D136 ) = ( ( D125 . D139 ) - 1 ) & ( D131 . D137 ) = ( ( D125 . D138 ) - 1 ))) by L1334 , L1174 , L1175 , L1252 , L1253 , L1330 , L898;
L1336: ((( D131 . D136 ) < ( D131 . D137 ) & ( D125 . D139 ) < ( D125 . D138 )) or (( D131 . D136 ) > ( D131 . D137 ) & ( D125 . D139 ) > ( D125 . D138 ))) by L1335 , L1258 , XREAL_1:9;
L1337: ((( D127 . { D139 , D138 } ) = ( 1_ R16 ) & ( D133 . R1 ) = ( 1_ R16 )) or (( D127 . { D138 , D139 } ) = ( - ( 1_ R16 ) ) & ( D133 . R1 ) = ( - ( 1_ R16 ) ))) by L1336 , L1252 , L1253 , L1254 , L1255 , L1260 , L1261 , L1332 , MATRIX11:def 1;
thus L1338: ( D135 . R1 ) = ( D133 . R1 ) by L1337 , L1246 , L1251 , L1255 , L1333 , FUNCT_1:12;
end;
suppose L1339: (( D125 . D139 ) < R6 & ( D125 . D138 ) >= R6);

L1340: D138 > R5 by L1330 , NAT_1:13;
L1341: ( D129 . D138 ) <> R6 by L1340 , L1174 , L1175 , L1247 , L1261 , FUNCT_1:def 4;
L1342: ( D125 . D138 ) > R6 by L1341 , L1339 , XXREAL_0:1;
L1343: ( D131 . D137 ) = ( ( D125 . D138 ) - 1 ) by L1174 , L1175 , L1253 , L1330 , L1339 , L898;
L1344: ( D125 . D138 ) = ( ( D131 . D137 ) + 1 ) by L1343;
L1345: ( D131 . D137 ) >= R6 by L1344 , L1342 , NAT_1:13;
L1346: ( D125 . D139 ) < ( D125 . D138 ) by L1339 , XXREAL_0:2;
L1347: ( D127 . { D139 , D138 } ) = ( 1_ R16 ) by L1346 , L1260 , L1261 , L1332 , MATRIX11:def 1;
L1348: ( D125 . D139 ) = ( D131 . D136 ) by L1174 , L1175 , L1252 , L1330 , L1339 , L898;
L1349: ( D131 . D136 ) < ( D131 . D137 ) by L1348 , L1339 , L1345 , XXREAL_0:2;
thus L1350: ( D135 . R1 ) = ( D133 . R1 ) by L1349 , L1252 , L1253 , L1254 , L1255 , L1333 , L1331 , L1347 , MATRIX11:def 1;
end;
suppose L1351: (( D125 . D139 ) >= R6 & ( D125 . D138 ) < R6);

L1352: D139 > R5 by L1330 , NAT_1:13;
L1353: ( D129 . D139 ) <> R6 by L1352 , L1174 , L1175 , L1247 , L1260 , FUNCT_1:def 4;
L1354: ( D125 . D139 ) > R6 by L1353 , L1351 , XXREAL_0:1;
L1355: ( D131 . D136 ) = ( ( D125 . D139 ) - 1 ) by L1174 , L1175 , L1252 , L1330 , L1351 , L898;
L1356: ( D125 . D139 ) = ( ( D131 . D136 ) + 1 ) by L1355;
L1357: ( D131 . D136 ) >= R6 by L1356 , L1354 , NAT_1:13;
L1358: ( D125 . D139 ) > ( D125 . D138 ) by L1351 , XXREAL_0:2;
L1359: ( D127 . { D139 , D138 } ) = ( - ( 1_ R16 ) ) by L1358 , L1260 , L1261 , L1332 , MATRIX11:def 1;
L1360: ( D125 . D138 ) = ( D131 . D137 ) by L1174 , L1175 , L1253 , L1330 , L1351 , L898;
L1361: ( D131 . D136 ) > ( D131 . D137 ) by L1360 , L1351 , L1357 , XXREAL_0:2;
thus L1362: ( D135 . R1 ) = ( D133 . R1 ) by L1361 , L1252 , L1253 , L1254 , L1255 , L1333 , L1331 , L1359 , MATRIX11:def 1;
end;
end;
end;
reconsider D140 = ( dom C119 ) as (Element of ( Fin D128 )) by FINSUB_1:def 5;
L1365: ( C119 .: D140 ) = ( rng C119 ) by RELAT_1:113;
L1366: ( dom C119 ) = D128 by FUNCT_2:def 1;
L1367: D140 = ( FinOmega D128 ) by L1366 , MATRIX_2:def 14;
L1368: ( dom D133 ) = D128 by FUNCT_2:def 1;
L1369: D133 = D135 by L1368 , L1246 , L1248 , FUNCT_1:2;
L1370: ( D122 $$ (D134 , D127) ) = ( sgn (D131 , R16) ) by L1369 , L1243 , L1244 , L1367 , L1365 , SETWOP_2:6;
L1371: C118 misses D134 by XBOOLE_1:79;
L1372: ( sgn (D125 , R16) ) = ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) * ( sgn (D131 , R16) ) ) by L1371 , L1238 , L1370 , L1242 , L1239 , SETWOP_2:4;
thus L1373: ( - (R17 , R13) ) = ( ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) * ( sgn (D131 , R16) ) ) * R17 ) by L1372 , MATRIX11:26
.= ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) * ( ( sgn (D131 , R16) ) * R17 ) ) by GROUP_1:def 3
.= ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) * ( - (R17 , D120) ) ) by MATRIX11:26;
end;
end;
end;
theorem
L1376: (for R9 being Nat holds (for R13 being (Element of ( Permutations ( R9 + 1 ) )) holds (for R16 being Field holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg ( R9 + 1 ) ) & ( R13 . R5 ) = R6) implies (for B68 being (Matrix of ( R9 + 1 ) , R16) holds (for B69 being (Matrix of R9 , R16) holds (B69 = ( Delete (B68 , R5 , R6) ) implies ( ( Path_product B68 ) . R13 ) = ( ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) * ( B68 * (R5 , R6) ) ) * ( ( Path_product B69 ) . ( Rem (R13 , R5) ) ) ))))))))))
proof
let R9 being Nat;
let R13 being (Element of ( Permutations ( R9 + 1 ) ));
let R16 being Field;
reconsider D141 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
set D142 = ( D141 + 1 );
let C122 , C123 being Nat;
assume that
L1377: C122 in ( Seg ( R9 + 1 ) )
and
L1378: ( R13 . C122 ) = C123;
set D143 = (the multF of R16);
set D144 = ( Rem (R13 , C122) );
let C124 being (Matrix of ( R9 + 1 ) , R16);
let C125 being (Matrix of R9 , R16);
assume that
L1379: C125 = ( Delete (C124 , C122 , C123) );
set D145 = ( Path_matrix (D144 , C125) );
set D146 = ( Path_matrix (R13 , C124) );
L1380: ( len D146 ) = D142 by MATRIX_3:def 7;
L1381: ( dom D146 ) = ( Seg D142 ) by L1380 , FINSEQ_1:def 3;
L1382: ( D146 . C122 ) = ( C124 * (C122 , C123) ) by L1381 , L1377 , L1378 , MATRIX_3:def 7;
L1383:
now
per cases ;
suppose L1384: D141 = ( 0 );

L1385: ( len D146 ) = 1 by L1384 , MATRIX_3:def 7;
L1386: ( D146 . 1 ) = ( C124 * (C122 , C123) ) by L1377 , L1382 , L1384 , FINSEQ_1:2 , TARSKI:def 1;
L1387: D146 = <* ( C124 * (C122 , C123) ) *> by L1386 , L1385 , FINSEQ_1:40;
L1388: ( D143 $$ D146 ) = ( C124 * (C122 , C123) ) by L1387 , FINSOP_1:11;
L1389: ( len D145 ) = ( 0 ) by L1384 , MATRIX_3:def 7;
L1390: D145 = ( <*> (the carrier of R16) ) by L1389;
L1391: ( D143 $$ D145 ) = ( the_unity_wrt D143 ) by L1390 , FINSOP_1:10;
L1392: ( the_unity_wrt D143 ) = ( 1_ R16 ) by FVSUM_1:5;
thus L1393: ( D143 $$ D146 ) = ( ( C124 * (C122 , C123) ) * ( D143 $$ D145 ) ) by L1392 , L1388 , L1391 , VECTSP_1:def 4;
end;
suppose L1394: D141 > ( 0 );

L1395: ( len D145 ) = R9 by MATRIX_3:def 7;
consider C126 being (Function of ( NAT ) , (the carrier of R16)) such that L1396: ( C126 . 1 ) = ( D145 . 1 ) and L1397: (for B70 being (Element of ( NAT )) holds ((( 0 ) <> B70 & B70 < R9) implies ( C126 . ( B70 + 1 ) ) = ( D143 . (( C126 . B70 ) , ( D145 . ( B70 + 1 ) )) ))) and L1398: ( D143 $$ D145 ) = ( C126 . R9 ) by L1395 , L1394 , FINSOP_1:def 1;
L1399: ( len D146 ) = D142 by MATRIX_3:def 7;
consider C127 being (Function of ( NAT ) , (the carrier of R16)) such that L1400: ( C127 . 1 ) = ( D146 . 1 ) and L1401: (for B71 being (Element of ( NAT )) holds ((( 0 ) <> B71 & B71 < D142) implies ( C127 . ( B71 + 1 ) ) = ( D143 . (( C127 . B71 ) , ( D146 . ( B71 + 1 ) )) ))) and L1402: ( D143 $$ D146 ) = ( C127 . D142 ) by L1399 , FINSOP_1:def 1;
defpred S6[ Nat ] means ((1 <= $1 & $1 < C122) implies ( C126 . $1 ) = ( C127 . $1 ));
L1403: (for R7 being Nat holds (R7 in ( Seg R9 ) implies ((R7 < C122 implies ( D145 . R7 ) = ( D146 . R7 )) & (R7 >= C122 implies ( D145 . R7 ) = ( D146 . ( R7 + 1 ) )))))
proof
L1404: ( len D146 ) = D142 by MATRIX_3:def 7;
L1405: ( dom D146 ) = ( Seg D142 ) by L1404 , FINSEQ_1:def 3;
L1406: ( len D145 ) = R9 by MATRIX_3:def 7;
L1407: ( dom D145 ) = ( Seg R9 ) by L1406 , FINSEQ_1:def 3;
reconsider D147 = R13 as (Permutation of ( Seg D142 )) by MATRIX_2:def 9;
reconsider D148 = D144 as (Permutation of ( Seg R9 )) by MATRIX_2:def 9;
let R7 being Nat;
assume that
L1408: R7 in ( Seg R9 );
reconsider D149 = ( R7 + 1 ) as (Element of ( NAT ));
L1409: D149 in ( Seg D142 ) by L1408 , FINSEQ_1:60;
L1410: ( rng D147 ) = ( Seg D142 ) by FUNCT_2:def 3;
L1411: ( dom D147 ) = ( Seg D142 ) by FUNCT_2:52;
L1412: C123 in ( Seg D142 ) by L1411 , L1377 , L1378 , L1410 , FUNCT_1:def 3;
L1413: ( rng D148 ) = ( Seg R9 ) by FUNCT_2:def 3;
L1414: ( dom D148 ) = ( Seg R9 ) by FUNCT_2:52;
L1415: ( D144 . R7 ) in ( Seg R9 ) by L1414 , L1408 , L1413 , FUNCT_1:def 3;
consider C128 being (Element of ( NAT )) such that L1416: C128 = ( D144 . R7 ) and L1417: 1 <= C128 and L1418: C128 <= R9 by L1415;
L1419: ( D142 -' 1 ) = ( D142 - 1 ) by XREAL_0:def 2;
L1420: R9 <= D142 by NAT_1:11;
L1421: ( Seg R9 ) c= ( Seg D142 ) by L1420 , FINSEQ_1:5;
thus L1422: (R7 < C122 implies ( D145 . R7 ) = ( D146 . R7 ))
proof
assume L1423: R7 < C122;
L1424: ( dom D147 ) = ( Seg D142 ) by FUNCT_2:52;
L1425: ( D147 . R7 ) <> ( D147 . C122 ) by L1424 , L1377 , L1408 , L1421 , L1423 , FUNCT_1:def 4;
L1426: (( R13 . R7 ) < C123 or ( R13 . R7 ) > C123) by L1425 , L1378 , XXREAL_0:1;
L1427: ((C128 = ( R13 . R7 ) & ( R13 . R7 ) < C123) or (( R13 . R7 ) > C123 & C128 = ( ( R13 . R7 ) - 1 ))) by L1426 , L1377 , L1378 , L1408 , L1416 , L1423 , L898;
L1428: ((C128 = ( R13 . R7 ) & ( R13 . R7 ) < C123) or (( R13 . R7 ) > C123 & ( R13 . R7 ) = ( C128 + 1 ))) by L1427;
L1429: ((C128 = ( R13 . R7 ) & ( R13 . R7 ) < C123) or (( R13 . R7 ) > C123 & C128 >= C123 & ( R13 . R7 ) = ( C128 + 1 ))) by L1428 , NAT_1:13;
L1430: ((( C125 * (R7 , C128) ) = ( C124 * (R7 , C128) ) & ( D145 . R7 ) = ( C125 * (R7 , C128) ) & ( D146 . R7 ) = ( C124 * (R7 , C128) )) or (( D145 . R7 ) = ( C125 * (R7 , C128) ) & ( C125 * (R7 , C128) ) = ( C124 * (R7 , ( C128 + 1 )) ) & ( D146 . R7 ) = ( C124 * (R7 , ( C128 + 1 )) ))) by L1429 , L1377 , L1379 , L1408 , L1415 , L1412 , L1416 , L1421 , L1419 , L1407 , L1405 , L1423 , L633 , MATRIX_3:def 7;
thus L1431: thesis by L1430;
end;

L1432: ( dom D147 ) = ( Seg D142 ) by FUNCT_2:52;
assume L1433: R7 >= C122;
L1434: D149 > C122 by L1433 , NAT_1:13;
L1435: ( D147 . D149 ) <> ( D147 . C122 ) by L1434 , L1377 , L1409 , L1432 , FUNCT_1:def 4;
L1436: (( R13 . D149 ) < C123 or ( R13 . D149 ) > C123) by L1435 , L1378 , XXREAL_0:1;
L1437: ((C128 = ( R13 . D149 ) & ( R13 . D149 ) < C123) or (( R13 . D149 ) > C123 & C128 = ( ( R13 . D149 ) - 1 ))) by L1436 , L1377 , L1378 , L1408 , L1416 , L1433 , L898;
L1438: ((C128 = ( R13 . D149 ) & ( R13 . D149 ) < C123) or (( R13 . D149 ) > C123 & ( R13 . D149 ) = ( C128 + 1 ))) by L1437;
L1439: ((C128 = ( R13 . D149 ) & ( R13 . D149 ) < C123) or (( R13 . D149 ) > C123 & C128 >= C123 & ( R13 . D149 ) = ( C128 + 1 ))) by L1438 , NAT_1:13;
L1440: ((( C125 * (R7 , C128) ) = ( C124 * (( R7 + 1 ) , C128) ) & ( D145 . R7 ) = ( C125 * (R7 , C128) ) & ( D146 . D149 ) = ( C124 * (( R7 + 1 ) , C128) )) or (( D145 . R7 ) = ( C125 * (R7 , C128) ) & ( C125 * (R7 , C128) ) = ( C124 * (( R7 + 1 ) , ( C128 + 1 )) ) & ( D146 . D149 ) = ( C124 * (D149 , ( C128 + 1 )) ))) by L1439 , L1377 , L1379 , L1408 , L1415 , L1412 , L1416 , L1419 , L1409 , L1407 , L1405 , L1433 , L633 , MATRIX_3:def 7;
thus L1441: thesis by L1440;
end;
L1442: (for R7 being Nat holds (S6[ R7 ] implies S6[ ( R7 + 1 ) ]))
proof
let R7 being Nat;
assume that
L1443: S6[ R7 ];
reconsider D150 = R7 as (Element of ( NAT )) by ORDINAL1:def 12;
assume that
L1444: 1 <= ( R7 + 1 )
and
L1445: ( R7 + 1 ) < C122;
set D151 = ( D150 + 1 );
L1446: C122 <= D142 by L1377 , FINSEQ_1:1;
L1447: D151 < D142 by L1446 , L1445 , XXREAL_0:2;
L1448: D151 <= R9 by L1447 , NAT_1:13;
L1449: D151 in ( Seg D141 ) by L1448 , L1444;
per cases  by NAT_1:14;
suppose L1450: R7 = ( 0 );

thus L1451: thesis by L1450 , L1400 , L1396 , L1403 , L1445 , L1449;
end;
suppose L1452: R7 >= 1;

L1453: C122 <= D142 by L1377 , FINSEQ_1:1;
L1454: D151 < D142 by L1453 , L1445 , XXREAL_0:2;
L1455: R7 < D142 by L1454 , NAT_1:13;
L1456: ( C127 . D151 ) = ( D143 . (( C127 . R7 ) , ( D146 . D151 )) ) by L1455 , L1401 , L1452;
L1457: D151 <= R9 by L1454 , NAT_1:13;
L1458: D151 in ( Seg D141 ) by L1457 , L1444;
L1459: R7 < R9 by L1454 , XREAL_1:6;
L1460: ( C126 . D151 ) = ( D143 . (( C126 . R7 ) , ( D145 . D151 )) ) by L1459 , L1397 , L1452;
thus L1461: thesis by L1460 , L1403 , L1443 , L1445 , L1452 , L1456 , L1458 , NAT_1:13;
end;
end;
defpred S7[ Nat ] means ((C122 <= $1 & $1 <= D142) implies (($1 = 1 implies ( C127 . $1 ) = ( C124 * (C122 , C123) )) & ($1 > 1 implies (for R17 being (Element of R16) holds (R17 = ( C126 . ( $1 - 1 ) ) implies ( C127 . $1 ) = ( ( C124 * (C122 , C123) ) * R17 ))))));
L1463: S6[ ( 0 ) ];
L1464: (for R7 being Nat holds S6[ R7 ]) from NAT_1:sch 2(L1463 , L1442);
L1465: (for R7 being Nat holds (S7[ R7 ] implies S7[ ( R7 + 1 ) ]))
proof
let R7 being Nat;
assume that
L1466: S7[ R7 ];
set D152 = ( R7 + 1 );
assume that
L1467: C122 <= D152
and
L1468: D152 <= D142;
per cases ;
suppose L1469: R7 = ( 0 );

L1470: 1 <= C122 by L1377 , FINSEQ_1:1;
thus L1471: thesis by L1470 , L1382 , L1400 , L1467 , L1469 , XXREAL_0:1;
end;
suppose L1472: R7 > ( 0 );

thus L1473: (D152 = 1 implies ( C127 . D152 ) = ( C124 * (C122 , C123) )) by L1472;
assume L1474: D152 > 1;
let R17 being (Element of R16);
assume that
L1475: R17 = ( C126 . ( D152 - 1 ) );
L1476: R7 <= R9 by L1468 , XREAL_1:6;
L1477: R7 >= 1 by L1472 , NAT_1:14;
L1478: R7 in ( Seg R9 ) by L1477 , L1476 , FINSEQ_1:1;
L1479: ( len D145 ) = R9 by MATRIX_3:def 7;
L1480: ( dom D145 ) = ( Seg R9 ) by L1479 , FINSEQ_1:def 3;
L1481: ( D145 . R7 ) = ( C125 * (R7 , ( D144 . R7 )) ) by L1480 , L1478 , MATRIX_3:def 7;
L1482: R7 < D142 by L1468 , NAT_1:13;
L1483: ( C127 . D152 ) = ( D143 . (( C127 . R7 ) , ( D146 . D152 )) ) by L1482 , L1401 , L1472 , L1478;
per cases  by L1467 , XXREAL_0:1;
suppose L1484: D152 = C122;

L1485: R7 < C122 by L1484 , NAT_1:13;
L1486: ( C127 . D152 ) = ( R17 * ( C124 * (C122 , C123) ) ) by L1485 , L1382 , L1464 , L1472 , L1475 , L1483 , L1484 , NAT_1:14;
thus L1487: thesis by L1486;
end;
suppose L1488: D152 > C122;

L1489: R7 < D142 by L1468 , NAT_1:13;
L1490: R7 >= C122 by L1488 , NAT_1:13;
L1491: C122 >= 1 by L1377 , FINSEQ_1:1;
L1492: R7 >= 1 by L1491 , L1490 , XXREAL_0:2;
per cases  by L1492 , XXREAL_0:1;
suppose L1493: R7 = 1;

thus L1494: thesis by L1493 , L1396 , L1403 , L1466 , L1468 , L1475 , L1478 , L1483 , L1490 , NAT_1:13;
end;
suppose L1495: R7 > 1;

reconsider D153 = ( R7 - 1 ) as (Element of ( NAT )) by L1472 , NAT_1:20;
reconsider D154 = ( C126 . D153 ) as (Element of R16);
L1496: ( D153 + 1 ) <= R9 by L1489 , NAT_1:13;
L1497: D153 < R9 by L1496 , NAT_1:13;
L1498: ( D153 + 1 ) > ( ( 0 ) + 1 ) by L1495;
L1499: R17 = ( D143 . (D154 , ( D145 . ( D153 + 1 ) )) ) by L1498 , L1397 , L1475 , L1497;
L1500: ( C127 . R7 ) = ( ( C124 * (C122 , C123) ) * D154 ) by L1466 , L1468 , L1488 , L1495 , NAT_1:13;
thus L1501: ( C127 . D152 ) = ( ( ( C124 * (C122 , C123) ) * D154 ) * ( C125 * (R7 , ( D144 . R7 )) ) ) by L1500 , L1403 , L1478 , L1483 , L1481 , L1490
.= ( ( C124 * (C122 , C123) ) * ( D154 * ( C125 * (R7 , ( D144 . R7 )) ) ) ) by GROUP_1:def 3
.= ( ( C124 * (C122 , C123) ) * R17 ) by L1478 , L1480 , L1499 , MATRIX_3:def 7;
end;
end;
end;
end;
L1505: S7[ ( 0 ) ];
L1506: (for R7 being Nat holds S7[ R7 ]) from NAT_1:sch 2(L1505 , L1465);
L1507: C122 <= D142 by L1377 , FINSEQ_1:1;
L1508: ( D142 - 1 ) = R9;
L1509: D142 > ( ( 0 ) + 1 ) by L1394 , XREAL_1:6;
thus L1510: ( D143 $$ D146 ) = ( ( C124 * (C122 , C123) ) * ( D143 $$ D145 ) ) by L1509 , L1402 , L1398 , L1506 , L1507 , L1508;
end;
end;
per cases ;
suppose L1512: D144 is  even;

thus L1513: ( ( Path_product C124 ) . R13 ) = ( - (( D143 $$ D146 ) , R13) ) by MATRIX_3:def 8
.= ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( - (( D143 $$ D146 ) , D144) ) ) by L1377 , L1378 , L1173
.= ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( ( C124 * (C122 , C123) ) * ( D143 $$ D145 ) ) ) by L1383 , L1512 , MATRIX_2:def 13
.= ( ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( C124 * (C122 , C123) ) ) * ( D143 $$ D145 ) ) by GROUP_1:def 3
.= ( ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( C124 * (C122 , C123) ) ) * ( - (( D143 $$ D145 ) , D144) ) ) by L1512 , MATRIX_2:def 13
.= ( ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( C124 * (C122 , C123) ) ) * ( ( Path_product C125 ) . D144 ) ) by MATRIX_3:def 8;
end;
suppose L1514: D144 is  odd;

thus L1515: ( ( Path_product C124 ) . R13 ) = ( - (( D143 $$ D146 ) , R13) ) by MATRIX_3:def 8
.= ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( - (( D143 $$ D146 ) , D144) ) ) by L1377 , L1378 , L1173
.= ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( - ( ( C124 * (C122 , C123) ) * ( D143 $$ D145 ) ) ) ) by L1383 , L1514 , MATRIX_2:def 13
.= ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( ( C124 * (C122 , C123) ) * ( - ( D143 $$ D145 ) ) ) ) by VECTSP_1:8
.= ( ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( C124 * (C122 , C123) ) ) * ( - ( D143 $$ D145 ) ) ) by GROUP_1:def 3
.= ( ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( C124 * (C122 , C123) ) ) * ( - (( D143 $$ D145 ) , D144) ) ) by L1514 , MATRIX_2:def 13
.= ( ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C122 + C123 )) ) * ( C124 * (C122 , C123) ) ) * ( ( Path_product C125 ) . D144 ) ) by MATRIX_3:def 8;
end;
end;
begin
definition
let C129 , C130 , C131 being Nat;
let R16 being Field;
let C132 being (Matrix of C131 , R16);
func Minor (C132 , C129 , C130) -> (Element of R16) equals 
( Det ( Delete (C132 , C129 , C130) ) );
coherence;
end;
definition
let C133 , C134 , C135 being Nat;
let R16 being Field;
let C136 being (Matrix of C135 , R16);
func Cofactor (C136 , C133 , C134) -> (Element of R16) equals 
( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C133 + C134 )) ) * ( Minor (C136 , C133 , C134) ) );
coherence;
end;
theorem
L1519: (for R9 being Nat holds (for R16 being Field holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg R9 ) & R6 in ( Seg R9 )) implies (for B72 being (Element of ( Fin ( Permutations R9 ) )) holds (B72 = { R12 where R12 is (Element of ( Permutations R9 )) : ( R12 . R5 ) = R6 } implies (for B73 being (Matrix of R9 , R16) holds ( (the addF of R16) $$ (B72 , ( Path_product B73 )) ) = ( ( B73 * (R5 , R6) ) * ( Cofactor (B73 , R5 , R6) ) )))))))))
proof
let R9 being Nat;
let R16 being Field;
let C137 , C138 being Nat;
assume that
L1520: C137 in ( Seg R9 )
and
L1521: C138 in ( Seg R9 );
L1522: R9 > ( 0 ) by L1520;
reconsider D155 = ( R9 - 1 ) as (Element of ( NAT )) by L1522 , NAT_1:20;
set D156 = ( Permutations ( R9 -' 1 ) );
set D157 = ( D155 + 1 );
set D158 = ( Permutations R9 );
L1523: ( D157 -' 1 ) = ( ( D155 + 1 ) - 1 ) by XREAL_0:def 2;
set D159 = (the addF of R16);
L1524: ( FinOmega D156 ) = D156 by MATRIX_2:26 , MATRIX_2:def 14;
let C139 being (Element of ( Fin D158 ));
assume that
L1525: C139 = { R12 where R12 is (Element of ( Permutations R9 )) : ( R12 . C137 ) = C138 };
consider C140 being (Function of C139 , D156) such that L1526: C140 is  bijective and L1527: (for B74 being (Element of ( Permutations D157 )) holds (( B74 . C137 ) = C138 implies ( C140 . B74 ) = ( Rem (B74 , C137) ))) by L1520 , L1521 , L1525 , L1523 , L1097;
let C141 being (Matrix of R9 , R16);
set D160 = ( Delete (C141 , C137 , C138) );
set D161 = ( Path_product C141 );
set D162 = ( Path_product D160 );
set D163 = ( ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C137 + C138 )) ) * ( C141 * (C137 , C138) ) );
defpred S8[ set ] means (for B75 being (Element of ( Fin D158 )) holds (for B76 being (Element of ( Fin D156 )) holds ((B75 = $1 & B76 = ( C140 .: B75 ) & B75 c= C139) implies ( D159 $$ (B75 , D161) ) = ( D163 * ( D159 $$ (B76 , D162) ) ))));
L1528: (for B77 being (Element of ( Fin D158 )) holds (for B78 being (Element of D158) holds ((S8[ B77 ] & (not B78 in B77)) implies S8[ ( B77 \/ { B78 } ) ])))
proof
let C142 being (Element of ( Fin D158 ));
let C143 being (Element of D158);
assume that
L1529: S8[ C142 ]
and
L1530: (not C143 in C142);
L1531: C143 in { C143 } by TARSKI:def 1;
L1532: ( rng C140 ) = D156 by L1526 , FUNCT_2:def 3;
L1533: ( C140 .: C142 ) c= D156 by L1532 , RELAT_1:111;
reconsider D164 = ( C140 .: C142 ) as (Element of ( Fin D156 )) by L1533 , FINSUB_1:def 5;
let C144 being (Element of ( Fin D158 ));
let C145 being (Element of ( Fin D156 ));
assume that
L1534: C144 = ( C142 \/ { C143 } )
and
L1535: C145 = ( C140 .: C144 )
and
L1536: C144 c= C139;
L1537: C142 c= C144 by L1534 , XBOOLE_1:7;
L1538: C142 c= C144 by L1534 , XBOOLE_1:7;
L1539: C142 c= C139 by L1538 , L1536 , XBOOLE_1:1;
L1540: { C143 } c= C144 by L1534 , XBOOLE_1:7;
L1541: C143 in C139 by L1540 , L1536 , L1531 , TARSKI:def 3;
consider C146 being (Element of D158) such that L1542: C146 = C143 and L1543: ( C146 . C137 ) = C138 by L1541 , L1525;
L1544: ( dom C140 ) = C139 by FUNCT_2:def 1;
L1545: ( Im (C140 , C143) ) = { ( C140 . C143 ) } by L1544 , L1541 , FUNCT_1:59;
reconsider D165 = ( C140 . C143 ) as (Element of D156) by L1541 , L1544 , L1532 , FUNCT_1:def 3;
L1546: ( C140 . C143 ) in ( rng C140 ) by L1541 , L1544 , FUNCT_1:def 3;
reconsider D166 = C146 as (Element of ( Permutations ( D155 + 1 ) ));
L1547: ( Rem (D166 , C137) ) = D165 by L1527 , L1542 , L1543;
L1548: ( D161 . C146 ) = ( D163 * ( D162 . D165 ) ) by L1547 , L1520 , L1523 , L1543 , L1376;
L1549: (not D165 in D164)
proof
assume L1550: D165 in D164;
L1551: (ex R1 being set st (R1 in ( dom C140 ) & R1 in C142 & ( C140 . R1 ) = D165)) by L1550 , FUNCT_1:def 6;
thus L1552: thesis by L1551 , L1526 , L1530 , L1541 , L1544 , FUNCT_1:def 4;
end;
per cases ;
suppose L1553: C142 = ( {} );

L1554: ( D159 $$ (C144 , D161) ) = ( D161 . C143 ) by L1553 , L1534 , SETWISEO:17;
L1555: ( D159 $$ (C145 , D162) ) = ( D162 . ( C140 . C143 ) ) by L1534 , L1535 , L1545 , L1546 , L1532 , L1553 , SETWISEO:17;
thus L1556: thesis by L1555 , L1520 , L1523 , L1542 , L1543 , L1547 , L1554 , L1376;
end;
suppose L1557: C142 <> ( {} );

L1558: C145 = ( D164 \/ { D165 } ) by L1534 , L1535 , L1545 , RELAT_1:120;
thus L1559: ( D163 * ( D159 $$ (C145 , D162) ) ) = ( D163 * ( ( D159 $$ (D164 , D162) ) + ( D162 . D165 ) ) ) by L1558 , L1541 , L1539 , L1544 , L1549 , L1557 , SETWOP_2:2
.= ( ( D163 * ( D159 $$ (D164 , D162) ) ) + ( D163 * ( D162 . D165 ) ) ) by VECTSP_1:def 2
.= ( D159 . (( D159 $$ (C142 , D161) ) , ( D161 . C143 )) ) by L1529 , L1536 , L1542 , L1537 , L1548 , XBOOLE_1:1
.= ( D159 $$ (C144 , D161) ) by L1530 , L1534 , L1557 , SETWOP_2:2;
end;
end;
L1561: S8[ ( {}. D158 ) ]
proof
let C147 being (Element of ( Fin D158 ));
let C148 being (Element of ( Fin D156 ));
assume that
L1562: C147 = ( {}. D158 )
and
L1563: C148 = ( C140 .: C147 )
and
L1564: C147 c= C139;
L1565: C148 = ( {}. D156 ) by L1562 , L1563;
L1566: ( D159 $$ (C148 , D162) ) = ( the_unity_wrt D159 ) by L1565 , FVSUM_1:8 , SETWISEO:31;
L1567: ( the_unity_wrt D159 ) = ( 0. R16 ) by FVSUM_1:7;
L1568: ( D159 $$ (C147 , D161) ) = ( the_unity_wrt D159 ) by L1562 , FVSUM_1:8 , SETWISEO:31;
thus L1569: thesis by L1568 , L1566 , L1567 , VECTSP_1:6;
end;
L1570: (for B79 being (Element of ( Fin D158 )) holds S8[ B79 ]) from SETWISEO:sch 2(L1561 , L1528);
L1571: ( dom C140 ) = C139 by FUNCT_2:def 1;
L1572: ( rng C140 ) = D156 by L1526 , FUNCT_2:def 3;
L1573: ( C140 .: C139 ) = ( FinOmega D156 ) by L1572 , L1524 , L1571 , RELAT_1:113;
thus L1574: ( D159 $$ (C139 , D161) ) = ( ( ( C141 * (C137 , C138) ) * ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( C137 + C138 )) ) ) * ( Det ( Delete (C141 , C137 , C138) ) ) ) by L1573 , L1570
.= ( ( C141 * (C137 , C138) ) * ( Cofactor (C141 , C137 , C138) ) ) by GROUP_1:def 3;
end;
theorem
L1575: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (for R5 being Nat holds (for R6 being Nat holds ((R5 in ( Seg R9 ) & R6 in ( Seg R9 )) implies ( Minor (R22 , R5 , R6) ) = ( Minor (( R22 @ ) , R6 , R5) )))))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
let R5 being Nat;
let R6 being Nat;
assume that
L1576: R5 in ( Seg R9 )
and
L1577: R6 in ( Seg R9 );
thus L1578: ( Minor (R22 , R5 , R6) ) = ( Det ( ( Delete (R22 , R5 , R6) ) @ ) ) by MATRIXR2:43
.= ( Minor (( R22 @ ) , R6 , R5) ) by L1576 , L1577 , L690;
end;
definition
let R9 being Nat;
let R16 being Field;
let C149 being (Matrix of R9 , R16);
func Matrix_of_Cofactor C149 -> (Matrix of R9 , R16) means 
:L1579: (for B80 , B81 being Nat holds ([ B80 , B81 ] in ( Indices it ) implies ( it * (B80 , B81) ) = ( Cofactor (C149 , B80 , B81) )));
existence
proof
reconsider D167 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
deffunc H2(Nat , Nat) = ( Cofactor (C149 , $1 , $2) );
L1580: (ex B82 being (Matrix of D167 , D167 , R16) st (for B83 , B84 being Nat holds ([ B83 , B84 ] in ( Indices B82 ) implies ( B82 * (B83 , B84) ) = H2(B83 , B84)))) from MATRIX_1:sch 1;
thus L1581: thesis by L1580;
end;
uniqueness
proof
let C150 , C151 being (Matrix of R9 , R16);
assume that
L1582: (for B85 , B86 being Nat holds ([ B85 , B86 ] in ( Indices C150 ) implies ( C150 * (B85 , B86) ) = ( Cofactor (C149 , B85 , B86) )))
and
L1583: (for B87 , B88 being Nat holds ([ B87 , B88 ] in ( Indices C151 ) implies ( C151 * (B87 , B88) ) = ( Cofactor (C149 , B87 , B88) )));
L1584:
now
L1585: ( Indices C150 ) = ( Indices C151 ) by MATRIX_1:26;
let C152 , C153 being Nat;
assume that
L1586: [ C152 , C153 ] in ( Indices C150 );
reconsider D168 = C152 , D169 = C153 as (Element of ( NAT )) by ORDINAL1:def 12;
L1587: ( C150 * (C152 , C153) ) = ( Cofactor (C149 , D168 , D169) ) by L1582 , L1586;
thus L1588: ( C150 * (C152 , C153) ) = ( C151 * (C152 , C153) ) by L1587 , L1583 , L1586 , L1585;
end;
thus L1589: thesis by L1584 , MATRIX_1:27;
end;
end;
begin
definition
let R9 being Nat;
let R5 being Nat;
let R16 being Field;
let C154 being (Matrix of R9 , R16);
::$N Laplace expansion
func LaplaceExpL (C154 , R5) -> (FinSequence of R16) means 
:L1591: (( len it ) = R9 & (for R6 being Nat holds (R6 in ( dom it ) implies ( it . R6 ) = ( ( C154 * (R5 , R6) ) * ( Cofactor (C154 , R5 , R6) ) ))));
existence
proof
reconsider D170 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
deffunc H3(Nat) = ( ( C154 * (R5 , $1) ) * ( Cofactor (C154 , R5 , $1) ) );
consider C155 being FinSequence such that L1592: (( len C155 ) = D170 & (for B89 being Nat holds (B89 in ( dom C155 ) implies ( C155 . B89 ) = H3(B89)))) from FINSEQ_1:sch 2;
L1593: ( rng C155 ) c= (the carrier of R16)
proof
let R1 being set;
assume L1594: R1 in ( rng C155 );
consider R2 being set such that L1595: R2 in ( dom C155 ) and L1596: ( C155 . R2 ) = R1 by L1594 , FUNCT_1:def 3;
L1597: ( dom C155 ) = ( Seg R9 ) by L1592 , FINSEQ_1:def 3;
consider C156 being (Element of ( NAT )) such that L1598: C156 = R2 and L1599: 1 <= C156 and L1600: C156 <= R9 by L1597 , L1595;
L1601: H3(C156) is (Element of R16);
L1602: ( C155 . C156 ) is (Element of R16) by L1601 , L1592 , L1595 , L1598;
thus L1603: thesis by L1602 , L1596 , L1598;
end;
reconsider D171 = C155 as (FinSequence of R16) by L1593 , FINSEQ_1:def 4;
take D171;
thus L1604: ( len D171 ) = R9 by L1592;
thus L1605: thesis by L1592;
end;
uniqueness
proof
let C157 , C158 being (FinSequence of R16);
assume that
L1606: ( len C157 ) = R9
and
L1607: (for R6 being Nat holds (R6 in ( dom C157 ) implies ( C157 . R6 ) = ( ( C154 * (R5 , R6) ) * ( Cofactor (C154 , R5 , R6) ) )))
and
L1608: ( len C158 ) = R9
and
L1609: (for R6 being Nat holds (R6 in ( dom C158 ) implies ( C158 . R6 ) = ( ( C154 * (R5 , R6) ) * ( Cofactor (C154 , R5 , R6) ) )));
L1610: ( dom C158 ) = ( Seg R9 ) by L1608 , FINSEQ_1:def 3;
L1611: ( dom C157 ) = ( Seg R9 ) by L1606 , FINSEQ_1:def 3;
L1612:
now
let C159 being Nat;
assume that
L1613: C159 in ( dom C157 );
L1614: ( C157 . C159 ) = ( ( C154 * (R5 , C159) ) * ( Cofactor (C154 , R5 , C159) ) ) by L1607 , L1613;
thus L1615: ( C157 . C159 ) = ( C158 . C159 ) by L1614 , L1609 , L1611 , L1610 , L1613;
end;
thus L1616: thesis by L1612 , L1611 , L1610 , FINSEQ_1:13;
end;
end;
definition
let R9 being Nat;
let C160 being Nat;
let R16 being Field;
let C161 being (Matrix of R9 , R16);
func LaplaceExpC (C161 , C160) -> (FinSequence of R16) means 
:L1618: (( len it ) = R9 & (for R5 being Nat holds (R5 in ( dom it ) implies ( it . R5 ) = ( ( C161 * (R5 , C160) ) * ( Cofactor (C161 , R5 , C160) ) ))));
existence
proof
reconsider D172 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
deffunc H4(Nat) = ( ( C161 * ($1 , C160) ) * ( Cofactor (C161 , $1 , C160) ) );
consider C162 being FinSequence such that L1619: (( len C162 ) = D172 & (for B90 being Nat holds (B90 in ( dom C162 ) implies ( C162 . B90 ) = H4(B90)))) from FINSEQ_1:sch 2;
L1620: ( rng C162 ) c= (the carrier of R16)
proof
let R1 being set;
assume L1621: R1 in ( rng C162 );
consider R2 being set such that L1622: R2 in ( dom C162 ) and L1623: ( C162 . R2 ) = R1 by L1621 , FUNCT_1:def 3;
L1624: ( dom C162 ) = ( Seg R9 ) by L1619 , FINSEQ_1:def 3;
consider C163 being (Element of ( NAT )) such that L1625: C163 = R2 and L1626: 1 <= C163 and L1627: C163 <= R9 by L1624 , L1622;
L1628: H4(C163) is (Element of R16);
L1629: ( C162 . C163 ) is (Element of R16) by L1628 , L1619 , L1622 , L1625;
thus L1630: thesis by L1629 , L1623 , L1625;
end;
reconsider D173 = C162 as (FinSequence of R16) by L1620 , FINSEQ_1:def 4;
take D173;
thus L1631: ( len D173 ) = R9 by L1619;
let R5 being Nat;
assume L1632: R5 in ( dom D173 );
thus L1633: thesis by L1632 , L1619;
end;
uniqueness
proof
let C164 , C165 being (FinSequence of R16);
assume that
L1634: ( len C164 ) = R9
and
L1635: (for R5 being Nat holds (R5 in ( dom C164 ) implies ( C164 . R5 ) = ( ( C161 * (R5 , C160) ) * ( Cofactor (C161 , R5 , C160) ) )))
and
L1636: ( len C165 ) = R9
and
L1637: (for R5 being Nat holds (R5 in ( dom C165 ) implies ( C165 . R5 ) = ( ( C161 * (R5 , C160) ) * ( Cofactor (C161 , R5 , C160) ) )));
L1638: ( dom C165 ) = ( Seg R9 ) by L1636 , FINSEQ_1:def 3;
L1639: ( dom C164 ) = ( Seg R9 ) by L1634 , FINSEQ_1:def 3;
L1640:
now
let C166 being Nat;
assume that
L1641: C166 in ( dom C164 );
L1642: ( C164 . C166 ) = ( ( C161 * (C166 , C160) ) * ( Cofactor (C161 , C166 , C160) ) ) by L1635 , L1641;
thus L1643: ( C164 . C166 ) = ( C165 . C166 ) by L1642 , L1637 , L1639 , L1638 , L1641;
end;
thus L1644: thesis by L1640 , L1639 , L1638 , FINSEQ_1:13;
end;
end;
theorem
L1646: (for R9 being Nat holds (for R16 being Field holds (for B91 being Nat holds (for B92 being (Matrix of R9 , R16) holds (B91 in ( Seg R9 ) implies ( Det B92 ) = ( Sum ( LaplaceExpL (B92 , B91) ) ))))))
proof
let R9 being Nat;
let R16 being Field;
reconsider D174 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
set D175 = ( Permutations R9 );
set D176 = (the carrier of R16);
set D177 = (the addF of R16);
L1647: D177 is  having_a_unity by FVSUM_1:8;
let C167 being Nat;
let C168 being (Matrix of R9 , R16);
assume that
L1648: C167 in ( Seg R9 );
reconsider D178 = ( finSeg D174 ) as non  empty set by L1648;
set D179 = ( Path_product C168 );
deffunc H5((Element of ( Fin D175 ))) = ( D177 $$ ($1 , D179) );
consider C169 being (Function of ( Fin D175 ) , D176) such that L1649: (for B93 being (Element of ( Fin D175 )) holds ( C169 . B93 ) = H5(B93)) from FUNCT_2:sch 4;
L1650: (for B94 , B95 being (Element of ( Fin D175 )) holds (B94 misses B95 implies ( D177 . (( C169 . B94 ) , ( C169 . B95 )) ) = ( C169 . ( B94 \/ B95 ) )))
proof
let C170 , C171 being (Element of ( Fin D175 ));
assume that
L1651: C170 misses C171;
L1652: ( C169 . C170 ) = H5(C170) by L1649;
L1653: ( C169 . C171 ) = H5(C171) by L1649;
L1654: ( C169 . ( C170 \/ C171 ) ) = H5(( C170 \/ C171 )) by L1649;
thus L1655: thesis by L1654 , L1651 , L1652 , L1653 , FVSUM_1:8 , SETWOP_2:4;
end;
deffunc H6(set) = { R12 where R12 is (Element of ( Permutations R9 )) : ( R12 . C167 ) = $1 };
consider C172 being Function such that L1656: (( dom C172 ) = D178 & (for R1 being set holds (R1 in D178 implies ( C172 . R1 ) = H6(R1)))) from FUNCT_1:sch 3;
L1657: ( rng C172 ) c= ( Fin D175 )
proof
let R1 being set;
assume L1658: R1 in ( rng C172 );
consider R2 being set such that L1659: R2 in ( dom C172 ) and L1660: ( C172 . R2 ) = R1 by L1658 , FUNCT_1:def 3;
L1661: H6(R2) c= D175
proof
let C173 being set;
assume L1662: C173 in H6(R2);
L1663: (ex R12 being (Element of ( Permutations R9 )) st (R12 = C173 & ( R12 . C167 ) = R2)) by L1662;
thus L1664: thesis by L1663;
end;
L1665: D175 is  finite by MATRIX_2:26;
L1666: H6(R2) in ( Fin D175 ) by L1665 , L1661 , FINSUB_1:def 5;
thus L1667: thesis by L1666 , L1656 , L1659 , L1660;
end;
reconsider D180 = C172 as (Function of D178 , ( Fin D175 )) by L1657 , L1656 , FUNCT_2:2;
L1668: ( C169 . ( FinOmega D175 ) ) = ( Det C168 ) by L1649;
set D181 = ( C169 * D180 );
L1669: ( dom D181 ) = D178 by FUNCT_2:def 1;
L1670: ( D181 * ( id D178 ) ) = D181 by L1669 , RELAT_1:52;
L1671: D175 c= ( union ( D180 .: D178 ) )
proof
let R1 being set;
assume L1672: R1 in D175;
reconsider D182 = R1 as (Permutation of D178) by L1672 , MATRIX_2:def 9;
L1673: R1 in H6(( D182 . C167 )) by L1672;
L1674: ( rng D182 ) = D178 by FUNCT_2:def 3;
L1675: ( dom D182 ) = D178 by FUNCT_2:52;
L1676: ( D182 . C167 ) in D178 by L1675 , L1648 , L1674 , FUNCT_1:def 3;
L1677: ( D180 . ( D182 . C167 ) ) in ( D180 .: D178 ) by L1676 , L1656 , FUNCT_1:def 6;
L1678: ( D180 . ( D182 . C167 ) ) = H6(( D182 . C167 )) by L1656 , L1676;
thus L1679: thesis by L1678 , L1673 , L1677 , TARSKI:def 4;
end;
set D183 = ( LaplaceExpL (C168 , C167) );
L1680: ( len D183 ) = R9 by L1591;
L1681: ( dom D183 ) = ( Seg R9 ) by L1680 , FINSEQ_1:def 3;
L1682: ( dom ( id D178 ) ) = ( dom D183 ) by L1681;
reconsider D184 = D178 as (Element of ( Fin D178 )) by FINSUB_1:def 5;
L1683: ( FinOmega D175 ) = D175 by MATRIX_2:26 , MATRIX_2:def 14;
L1684: ( C169 . ( {}. ( Fin D175 ) ) ) = ( D177 $$ (( {}. D175 ) , D179) ) by L1649;
L1685: ( C169 . ( {} ) ) = ( the_unity_wrt D177 ) by L1684 , FVSUM_1:8 , SETWISEO:31;
L1686:
now
let R1 being set;
let R2 being set;
assume that
L1687: R1 in D184
and
L1688: R2 in D184
and
L1689: ( D180 . R1 ) meets ( D180 . R2 );
consider C174 being set such that L1690: C174 in ( D180 . R1 ) and L1691: C174 in ( D180 . R2 ) by L1689 , XBOOLE_0:3;
L1692: ( D180 . R2 ) = H6(R2) by L1656 , L1688;
L1693: (ex R12 being (Element of ( Permutations R9 )) st (R12 = C174 & ( R12 . C167 ) = R2)) by L1692 , L1691;
L1694: ( D180 . R1 ) = H6(R1) by L1656 , L1687;
L1695: (ex R12 being (Element of ( Permutations R9 )) st (R12 = C174 & ( R12 . C167 ) = R1)) by L1694 , L1690;
thus L1696: R1 = R2 by L1695 , L1693;
end;
L1697:
now
L1698: ( rng D180 ) c= ( Fin D175 ) by RELAT_1:def 19;
let R1 being set;
assume that
L1699: R1 in ( dom D181 );
consider C175 being (Element of ( NAT )) such that L1700: C175 = R1 and L1701: 1 <= C175 and L1702: C175 <= R9 by L1669 , L1699;
L1703: ( D180 . C175 ) in ( rng D180 ) by L1656 , L1699 , L1700 , FUNCT_1:def 3;
reconsider D185 = H6(C175) as (Element of ( Fin D175 )) by L1703 , L1656 , L1699 , L1700 , L1698;
L1704: ( D180 . C175 ) = D185 by L1656 , L1699 , L1700;
L1705: ( D181 . C175 ) = ( C169 . ( D180 . C175 ) ) by L1656 , L1699 , L1700 , FUNCT_1:13;
L1706: ( D181 . C175 ) = H5(D185) by L1705 , L1649 , L1704;
L1707: H5(D185) = ( ( C168 * (C167 , C175) ) * ( Cofactor (C168 , C167 , C175) ) ) by L1648 , L1699 , L1700 , L1519;
thus L1708: ( D183 . R1 ) = ( D181 . R1 ) by L1707 , L1681 , L1699 , L1700 , L1706 , L1591;
end;
L1709: D183 = D181 by L1697 , L1681 , L1669 , FUNCT_1:2;
set D186 = ( [#] (D183 , ( the_unity_wrt D177 )) );
L1710: ( rng ( id D178 ) ) = D184;
L1711: ( D186 | ( dom D183 ) ) = D183 by SETWOP_2:21;
L1712: ( union ( D180 .: D178 ) ) c= D175
proof
let R1 being set;
assume L1713: R1 in ( union ( D180 .: D178 ) );
consider R2 being set such that L1714: R1 in R2 and L1715: R2 in ( D180 .: D178 ) by L1713 , TARSKI:def 4;
consider C176 being set such that L1716: C176 in ( dom D180 ) and L1717: C176 in D178 and L1718: ( D180 . C176 ) = R2 by L1715 , FUNCT_1:def 6;
L1719: R2 = H6(C176) by L1656 , L1716 , L1718;
L1720: (ex R12 being (Element of ( Permutations R9 )) st (R1 = R12 & ( R12 . C167 ) = C176)) by L1719 , L1714;
thus L1721: thesis by L1720;
end;
L1722: D175 = ( union ( D180 .: D178 ) ) by L1712 , L1671 , XBOOLE_0:def 10;
L1723: ( D177 $$ (( D180 .: D184 ) , C169) ) = ( C169 . ( FinOmega D175 ) ) by L1722 , L1686 , L1650 , L1647 , L1685 , L1683 , L553;
L1724: ( D177 $$ (D184 , ( C169 * D180 )) ) = ( D177 $$ (( D180 .: D184 ) , C169) ) by L1686 , L1650 , L1647 , L1685 , L553;
thus L1725: ( Det C168 ) = ( D177 $$ (( findom D183 ) , D186) ) by L1724 , L1682 , L1710 , L1711 , L1670 , L1709 , L1723 , L1668 , SETWOP_2:5
.= ( Sum D183 ) by FVSUM_1:8 , SETWOP_2:def 2;
end;
theorem
L1726: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (for R5 being Nat holds (R5 in ( Seg R9 ) implies ( LaplaceExpC (R22 , R5) ) = ( LaplaceExpL (( R22 @ ) , R5) ))))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
let R5 being Nat;
assume that
L1727: R5 in ( Seg R9 );
set D187 = ( LaplaceExpL (( R22 @ ) , R5) );
set D188 = ( LaplaceExpC (R22 , R5) );
reconsider D189 = R5 as (Element of ( NAT )) by ORDINAL1:def 12;
L1728: ( len D187 ) = R9 by L1591;
L1729: ( len D188 ) = R9 by L1618;
L1730:
now
let C177 being Nat;
assume that
L1731: 1 <= C177
and
L1732: C177 <= R9;
L1733: C177 in ( NAT ) by ORDINAL1:def 12;
L1734: C177 in ( Seg R9 ) by L1733 , L1731 , L1732;
L1735: ( dom D188 ) = ( Seg R9 ) by L1729 , FINSEQ_1:def 3;
L1736: ( D188 . C177 ) = ( ( R22 * (C177 , D189) ) * ( Cofactor (R22 , C177 , D189) ) ) by L1735 , L1734 , L1618;
L1737: ( Indices R22 ) = [: ( Seg R9 ) , ( Seg R9 ) :] by MATRIX_1:24;
L1738: [ C177 , R5 ] in ( Indices R22 ) by L1737 , L1727 , L1734 , ZFMISC_1:87;
L1739: ( dom D187 ) = ( Seg R9 ) by L1728 , FINSEQ_1:def 3;
L1740: ( D187 . C177 ) = ( ( ( R22 @ ) * (D189 , C177) ) * ( Cofactor (( R22 @ ) , D189 , C177) ) ) by L1739 , L1734 , L1591;
L1741: ( Cofactor (R22 , C177 , D189) ) = ( Cofactor (( R22 @ ) , D189 , C177) ) by L1727 , L1734 , L1575;
thus L1742: ( D188 . C177 ) = ( D187 . C177 ) by L1741 , L1738 , L1736 , L1740 , MATRIX_1:def 6;
end;
thus L1743: thesis by L1730 , L1729 , L1728 , FINSEQ_1:14;
end;
theorem
L1744: (for R9 being Nat holds (for R16 being Field holds (for B96 being Nat holds (for B97 being (Matrix of R9 , R16) holds (B96 in ( Seg R9 ) implies ( Det B97 ) = ( Sum ( LaplaceExpC (B97 , B96) ) ))))))
proof
let R9 being Nat;
let R16 being Field;
let C178 being Nat;
let C179 being (Matrix of R9 , R16);
assume that
L1745: C178 in ( Seg R9 );
thus L1746: ( Det C179 ) = ( Det ( C179 @ ) ) by MATRIXR2:43
.= ( Sum ( LaplaceExpL (( C179 @ ) , C178) ) ) by L1745 , L1646
.= ( Sum ( LaplaceExpC (C179 , C178) ) ) by L1745 , L1726;
end;
theorem
L1747: (for R9 being Nat holds (for R16 being Field holds (for R18 being (FinSequence of R16) holds (for R22 being (Matrix of R9 , R16) holds (for R12 being (Element of ( Permutations R9 )) holds (for R5 being Nat holds ((( len R18 ) = R9 & R5 in ( Seg R9 )) implies ( mlt (( Line (( Matrix_of_Cofactor R22 ) , R5) ) , R18) ) = ( LaplaceExpL (( RLine (R22 , R5 , R18) ) , R5) ))))))))
proof
let R9 being Nat;
let R16 being Field;
let R18 being (FinSequence of R16);
let R22 being (Matrix of R9 , R16);
let R12 being (Element of ( Permutations R9 ));
let R5 being Nat;
assume that
L1748: ( len R18 ) = R9
and
L1749: R5 in ( Seg R9 );
reconsider D190 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
set D191 = (the carrier of R16);
set D192 = ( Matrix_of_Cofactor R22 );
reconsider D193 = R18 , D194 = ( Line (D192 , R5) ) as (Element of ( D190 -tuples_on D191 )) by L1748 , FINSEQ_2:92 , MATRIX_1:24;
set D195 = ( RLine (R22 , R5 , R18) );
set D196 = ( LaplaceExpL (D195 , R5) );
set D197 = ( mlt (D194 , D193) );
L1750: ( len D196 ) = R9 by L1591;
L1751:
now
L1752: ( dom D196 ) = ( Seg R9 ) by L1750 , FINSEQ_1:def 3;
L1753: R9 = ( width R22 ) by MATRIX_1:24;
let C180 being Nat;
assume that
L1754: 1 <= C180
and
L1755: C180 <= R9;
L1756: C180 in ( NAT ) by ORDINAL1:def 12;
L1757: C180 in ( Seg R9 ) by L1756 , L1754 , L1755;
L1758: R9 = ( width D192 ) by MATRIX_1:24;
L1759: ( ( Line (D192 , R5) ) . C180 ) = ( D192 * (R5 , C180) ) by L1758 , L1757 , MATRIX_1:def 7;
L1760: ( Indices R22 ) = [: ( Seg R9 ) , ( Seg R9 ) :] by MATRIX_1:24;
L1761: [ R5 , C180 ] in ( Indices R22 ) by L1760 , L1749 , L1757 , ZFMISC_1:87;
L1762: ( D195 * (R5 , C180) ) = ( R18 . C180 ) by L1761 , L1748 , L1753 , MATRIX11:def 3;
L1763: ( Indices D192 ) = [: ( Seg R9 ) , ( Seg R9 ) :] by MATRIX_1:24;
L1764: [ R5 , C180 ] in ( Indices D192 ) by L1763 , L1749 , L1757 , ZFMISC_1:87;
L1765: ( ( Line (D192 , R5) ) . C180 ) = ( Cofactor (R22 , R5 , C180) ) by L1764 , L1759 , L1579;
L1766: ( D197 . C180 ) = ( ( Cofactor (R22 , R5 , C180) ) * ( D195 * (R5 , C180) ) ) by L1765 , L1757 , L1762 , FVSUM_1:61;
L1767: ( Cofactor (R22 , R5 , C180) ) = ( Cofactor (D195 , R5 , C180) ) by L1749 , L1757 , L729;
thus L1768: ( D197 . C180 ) = ( D196 . C180 ) by L1767 , L1757 , L1752 , L1766 , L1591;
end;
L1769: ( len D197 ) = R9 by CARD_1:def 7;
thus L1770: thesis by L1769 , L1750 , L1751 , FINSEQ_1:14;
end;
theorem
L1771: (for R5 being Nat holds (for R6 being Nat holds (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (R5 in ( Seg R9 ) implies ( ( Line (R22 , R6) ) "*" ( Col (( ( Matrix_of_Cofactor R22 ) @ ) , R5) ) ) = ( Det ( RLine (R22 , R5 , ( Line (R22 , R6) )) ) )))))))
proof
let R5 being Nat;
let R6 being Nat;
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
assume L1772: R5 in ( Seg R9 );
set D198 = ( Matrix_of_Cofactor R22 );
L1773: ( len D198 ) = R9 by MATRIX_1:24;
L1774: ( dom D198 ) = ( Seg R9 ) by L1773 , FINSEQ_1:def 3;
L1775: ( Line (D198 , R5) ) = ( Col (( D198 @ ) , R5) ) by L1774 , L1772 , MATRIX_2:14;
L1776: ( width R22 ) = R9 by MATRIX_1:24;
L1777: ( len ( Line (R22 , R6) ) ) = R9 by L1776 , MATRIX_1:def 7;
thus L1778: ( Det ( RLine (R22 , R5 , ( Line (R22 , R6) )) ) ) = ( Sum ( LaplaceExpL (( RLine (R22 , R5 , ( Line (R22 , R6) )) ) , R5) ) ) by L1772 , L1646
.= ( Sum ( mlt (( Col (( D198 @ ) , R5) ) , ( Line (R22 , R6) )) ) ) by L1772 , L1775 , L1777 , L1747
.= ( ( Line (R22 , R6) ) "*" ( Col (( D198 @ ) , R5) ) ) by FVSUM_1:64;
end;
theorem
L1779: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (( Det R22 ) <> ( 0. R16 ) implies ( R22 * ( ( ( Det R22 ) " ) * ( ( Matrix_of_Cofactor R22 ) @ ) ) ) = ( 1. (R16 , R9) )))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
set D199 = ( Det R22 );
set D200 = ( D199 " );
set D201 = ( Matrix_of_Cofactor R22 );
set D202 = ( D200 * ( D201 @ ) );
set D203 = ( R22 * D202 );
set D204 = ( 1. (R16 , R9) );
assume L1780: D199 <> ( 0. R16 );
L1781:
now
L1782: ( Indices D203 ) = ( Indices D204 ) by MATRIX_1:26;
reconsider D205 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
let C181 , C182 being Nat;
assume that
L1783: [ C181 , C182 ] in ( Indices D203 );
reconsider D206 = ( Col (( D201 @ ) , C182) ) , D207 = ( Line (R22 , C181) ) as (Element of ( D205 -tuples_on (the carrier of R16) )) by MATRIX_1:24;
reconsider D208 = C181 , D209 = C182 as (Element of ( NAT )) by ORDINAL1:def 12;
L1784: ( len D202 ) = R9 by MATRIX_1:24;
L1785: ( Indices D203 ) = [: ( Seg R9 ) , ( Seg R9 ) :] by MATRIX_1:24;
L1786: C181 in ( Seg R9 ) by L1785 , L1783 , ZFMISC_1:87;
L1787: C182 in ( Seg R9 ) by L1783 , L1785 , ZFMISC_1:87;
L1788: 1 <= C182 by L1787 , FINSEQ_1:1;
L1789: ( width ( D201 @ ) ) = R9 by MATRIX_1:24;
L1790: C182 <= ( width ( D201 @ ) ) by L1789 , L1787 , FINSEQ_1:1;
L1791: ( Col (D202 , C182) ) = ( D200 * D206 ) by L1790 , L1788 , MATRIXR1:19;
L1792: ( mlt (( Line (R22 , C181) ) , ( Col (D202 , C182) )) ) = ( D200 * ( mlt (D207 , D206) ) ) by L1791 , FVSUM_1:69;
L1793: ( ( Line (R22 , C181) ) "*" ( Col (D202 , C182) ) ) = ( D200 * ( ( Line (R22 , C181) ) "*" ( Col (( D201 @ ) , C182) ) ) ) by L1792 , FVSUM_1:73
.= ( D200 * ( Det ( RLine (R22 , D209 , ( Line (R22 , D208) )) ) ) ) by L1787 , L1771;
L1794: ( width R22 ) = R9 by MATRIX_1:24;
L1795: ( D203 * (C181 , C182) ) = ( D200 * ( Det ( RLine (R22 , C182 , ( Line (R22 , C181) )) ) ) ) by L1794 , L1783 , L1784 , L1793 , MATRIX_3:def 4;
per cases ;
suppose L1796: C181 = C182;

L1797: ( RLine (R22 , C182 , ( Line (R22 , C181) )) ) = R22 by L1796 , MATRIX11:30;
L1798: ( D199 * D200 ) = ( 1_ R16 ) by L1780 , VECTSP_1:def 10;
L1799: ( D204 * (C181 , C182) ) = ( 1_ R16 ) by L1783 , L1782 , L1796 , MATRIX_1:def 11;
thus L1800: ( D204 * (C181 , C182) ) = ( D203 * (C181 , C182) ) by L1799 , L1783 , L1794 , L1784 , L1793 , L1797 , L1798 , MATRIX_3:def 4;
end;
suppose L1801: C181 <> C182;

L1802: ( D204 * (C181 , C182) ) = ( 0. R16 ) by L1801 , L1783 , L1782 , MATRIX_1:def 11;
L1803: ( Det ( RLine (R22 , D209 , ( Line (R22 , D208) )) ) ) = ( 0. R16 ) by L1786 , L1787 , L1801 , MATRIX11:51;
thus L1804: ( D204 * (C181 , C182) ) = ( D203 * (C181 , C182) ) by L1803 , L1795 , L1802 , VECTSP_1:6;
end;
end;
thus L1806: thesis by L1781 , MATRIX_1:27;
end;
theorem
L1807: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (for R18 being (FinSequence of R16) holds (for R5 being Nat holds ((( len R18 ) = R9 & R5 in ( Seg R9 )) implies ( mlt (( Col (( Matrix_of_Cofactor R22 ) , R5) ) , R18) ) = ( LaplaceExpL (( RLine (( R22 @ ) , R5 , R18) ) , R5) )))))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
let R18 being (FinSequence of R16);
let R5 being Nat;
assume that
L1808: ( len R18 ) = R9
and
L1809: R5 in ( Seg R9 );
reconsider D210 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
set D211 = (the carrier of R16);
set D212 = ( Matrix_of_Cofactor R22 );
reconsider D213 = R18 , D214 = ( Col (D212 , R5) ) as (Element of ( D210 -tuples_on D211 )) by L1808 , FINSEQ_2:92 , MATRIX_1:24;
set D215 = ( RLine (( R22 @ ) , R5 , R18) );
set D216 = ( LaplaceExpL (D215 , R5) );
set D217 = ( mlt (D214 , D213) );
L1810: ( len D216 ) = R9 by L1591;
L1811:
now
L1812: ( Indices ( R22 @ ) ) = [: ( Seg R9 ) , ( Seg R9 ) :] by MATRIX_1:24;
L1813: ( dom D216 ) = ( Seg R9 ) by L1810 , FINSEQ_1:def 3;
L1814: ( width ( R22 @ ) ) = R9 by MATRIX_1:24;
let C183 being Nat;
assume that
L1815: 1 <= C183
and
L1816: C183 <= R9;
L1817: C183 in ( NAT ) by ORDINAL1:def 12;
L1818: C183 in ( Seg R9 ) by L1817 , L1815 , L1816;
L1819: ( Delete (( R22 @ ) , R5 , C183) ) = ( ( Delete (R22 , C183 , R5) ) @ ) by L1818 , L1809 , L690;
L1820: ( Cofactor (( R22 @ ) , R5 , C183) ) = ( Cofactor (R22 , C183 , R5) ) by L1819 , MATRIXR2:43;
L1821: ( Indices D212 ) = [: ( Seg R9 ) , ( Seg R9 ) :] by MATRIX_1:24;
L1822: [ C183 , R5 ] in ( Indices D212 ) by L1821 , L1809 , L1818 , ZFMISC_1:87;
L1823: ( D212 * (C183 , R5) ) = ( Cofactor (R22 , C183 , R5) ) by L1822 , L1579;
L1824: R9 = ( len D212 ) by MATRIX_1:24;
L1825: ( dom D212 ) = ( Seg R9 ) by L1824 , FINSEQ_1:def 3;
L1826: ( ( Col (D212 , R5) ) . C183 ) = ( D212 * (C183 , R5) ) by L1825 , L1818 , MATRIX_1:def 8;
L1827: ( Indices R22 ) = [: ( Seg R9 ) , ( Seg R9 ) :] by MATRIX_1:24;
L1828: [ R5 , C183 ] in ( Indices R22 ) by L1827 , L1809 , L1818 , ZFMISC_1:87;
L1829: ( D215 * (R5 , C183) ) = ( R18 . C183 ) by L1828 , L1808 , L1814 , L1827 , L1812 , MATRIX11:def 3;
L1830: ( D217 . C183 ) = ( ( Cofactor (R22 , C183 , R5) ) * ( D215 * (R5 , C183) ) ) by L1829 , L1818 , L1826 , L1823 , FVSUM_1:61;
L1831: ( Cofactor (D215 , R5 , C183) ) = ( Cofactor (( R22 @ ) , R5 , C183) ) by L1809 , L1818 , L729;
thus L1832: ( D217 . C183 ) = ( D216 . C183 ) by L1831 , L1818 , L1820 , L1813 , L1830 , L1591;
end;
L1833: ( len D217 ) = R9 by CARD_1:def 7;
thus L1834: thesis by L1833 , L1810 , L1811 , FINSEQ_1:14;
end;
theorem
L1835: (for R5 being Nat holds (for R6 being Nat holds (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds ((R5 in ( Seg R9 ) & R6 in ( Seg R9 )) implies ( ( Line (( ( Matrix_of_Cofactor R22 ) @ ) , R5) ) "*" ( Col (R22 , R6) ) ) = ( Det ( RLine (( R22 @ ) , R5 , ( Line (( R22 @ ) , R6) )) ) )))))))
proof
let R5 being Nat;
let R6 being Nat;
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
assume that
L1836: R5 in ( Seg R9 )
and
L1837: R6 in ( Seg R9 );
set D218 = ( Matrix_of_Cofactor R22 );
set D219 = ( Line (( R22 @ ) , R6) );
L1838: ( width D218 ) = R9 by MATRIX_1:24;
L1839: ( width ( R22 @ ) ) = R9 by MATRIX_1:24;
L1840: ( len D219 ) = R9 by L1839 , MATRIX_1:def 7;
L1841: ( width R22 ) = R9 by MATRIX_1:24;
thus L1842: ( Det ( RLine (( R22 @ ) , R5 , D219) ) ) = ( Sum ( LaplaceExpL (( RLine (( R22 @ ) , R5 , D219) ) , R5) ) ) by L1836 , L1646
.= ( Sum ( mlt (( Col (D218 , R5) ) , D219) ) ) by L1836 , L1840 , L1807
.= ( ( Line (( D218 @ ) , R5) ) "*" D219 ) by L1836 , L1838 , MATRIX_2:15
.= ( ( Line (( D218 @ ) , R5) ) "*" ( Col (R22 , R6) ) ) by L1837 , L1841 , MATRIX_2:15;
end;
theorem
L1843: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (( Det R22 ) <> ( 0. R16 ) implies ( ( ( ( Det R22 ) " ) * ( ( Matrix_of_Cofactor R22 ) @ ) ) * R22 ) = ( 1. (R16 , R9) )))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
set D220 = ( Det R22 );
set D221 = ( D220 " );
set D222 = ( Matrix_of_Cofactor R22 );
set D223 = ( D221 * ( D222 @ ) );
set D224 = ( D223 * R22 );
set D225 = ( 1. (R16 , R9) );
assume L1844: D220 <> ( 0. R16 );
L1845:
now
L1846: ( Indices D224 ) = ( Indices D225 ) by MATRIX_1:26;
reconsider D226 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
let C184 , C185 being Nat;
assume that
L1847: [ C184 , C185 ] in ( Indices D224 );
reconsider D227 = ( Col (R22 , C185) ) , D228 = ( Line (( D222 @ ) , C184) ) as (Element of ( D226 -tuples_on (the carrier of R16) )) by MATRIX_1:24;
reconsider D229 = C184 , D230 = C185 as (Element of ( NAT )) by ORDINAL1:def 12;
L1848: ( len R22 ) = R9 by MATRIX_1:24;
L1849: ( Indices D224 ) = [: ( Seg R9 ) , ( Seg R9 ) :] by MATRIX_1:24;
L1850: C184 in ( Seg R9 ) by L1849 , L1847 , ZFMISC_1:87;
L1851: 1 <= C184 by L1850 , FINSEQ_1:1;
L1852: C185 in ( Seg R9 ) by L1847 , L1849 , ZFMISC_1:87;
L1853: ( len ( D222 @ ) ) = R9 by MATRIX_1:24;
L1854: C184 <= ( len ( D222 @ ) ) by L1853 , L1850 , FINSEQ_1:1;
L1855: ( Line (D223 , C184) ) = ( D221 * D228 ) by L1854 , L1851 , MATRIXR1:20;
L1856: ( mlt (( Line (D223 , C184) ) , ( Col (R22 , C185) )) ) = ( D221 * ( mlt (D228 , D227) ) ) by L1855 , FVSUM_1:69;
L1857: ( ( Line (D223 , C184) ) "*" ( Col (R22 , C185) ) ) = ( D221 * ( ( Line (( D222 @ ) , C184) ) "*" ( Col (R22 , C185) ) ) ) by L1856 , FVSUM_1:73
.= ( D221 * ( Det ( RLine (( R22 @ ) , D229 , ( Line (( R22 @ ) , D230) )) ) ) ) by L1850 , L1852 , L1835;
L1858: ( width D223 ) = R9 by MATRIX_1:24;
L1859: ( D224 * (C184 , C185) ) = ( D221 * ( Det ( RLine (( R22 @ ) , C184 , ( Line (( R22 @ ) , C185) )) ) ) ) by L1858 , L1847 , L1848 , L1857 , MATRIX_3:def 4;
per cases ;
suppose L1860: C184 = C185;

L1861: ( RLine (( R22 @ ) , C184 , ( Line (( R22 @ ) , C185) )) ) = ( R22 @ ) by L1860 , MATRIX11:30;
L1862: D220 = ( Det ( R22 @ ) ) by MATRIXR2:43;
L1863: ( D221 * D220 ) = ( 1_ R16 ) by L1844 , VECTSP_1:def 10;
L1864: ( D225 * (C184 , C185) ) = ( 1_ R16 ) by L1847 , L1846 , L1860 , MATRIX_1:def 11;
thus L1865: ( D225 * (C184 , C185) ) = ( D224 * (C184 , C185) ) by L1864 , L1847 , L1858 , L1848 , L1857 , L1861 , L1863 , L1862 , MATRIX_3:def 4;
end;
suppose L1866: C184 <> C185;

L1867: ( D225 * (C184 , C185) ) = ( 0. R16 ) by L1866 , L1847 , L1846 , MATRIX_1:def 11;
L1868: ( Det ( RLine (( R22 @ ) , D229 , ( Line (( R22 @ ) , D230) )) ) ) = ( 0. R16 ) by L1850 , L1852 , L1866 , MATRIX11:51;
thus L1869: ( D225 * (C184 , C185) ) = ( D224 * (C184 , C185) ) by L1868 , L1859 , L1867 , VECTSP_1:6;
end;
end;
thus L1871: thesis by L1845 , MATRIX_1:27;
end;
theorem
L1872: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (R22 is  invertible iff ( Det R22 ) <> ( 0. R16 )))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
thus L1873: (R22 is  invertible implies ( Det R22 ) <> ( 0. R16 ))
proof
reconsider D231 = R9 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L1874: R22 is  invertible;
consider C186 being (Matrix of R9 , R16) such that L1875: R22 is_reverse_of C186 by L1874 , MATRIX_6:def 3;
per cases  by NAT_1:14;
suppose L1876: D231 = ( 0 );

L1877: ( Det R22 ) = ( 1_ R16 ) by L1876 , MATRIXR2:41;
thus L1878: thesis by L1877;
end;
suppose L1879: D231 >= 1;

L1880: ( R22 * C186 ) = ( 1. (R16 , R9) ) by L1875 , MATRIX_6:def 2;
L1881: ( Det ( 1. (R16 , R9) ) ) = ( 1_ R16 ) by L1879 , MATRIX_7:16;
L1882: ( ( Det R22 ) * ( Det C186 ) ) = ( 1_ R16 ) by L1881 , L1879 , L1880 , MATRIX11:62;
thus L1883: thesis by L1882 , VECTSP_1:12;
end;
end;

set D232 = ( ( ( Det R22 ) " ) * ( ( Matrix_of_Cofactor R22 ) @ ) );
assume L1885: ( Det R22 ) <> ( 0. R16 );
L1886: ( R22 * D232 ) = ( 1. (R16 , R9) ) by L1885 , L1779;
L1887: ( D232 * R22 ) = ( 1. (R16 , R9) ) by L1885 , L1843;
L1888: R22 is_reverse_of D232 by L1887 , L1886 , MATRIX_6:def 2;
thus L1889: thesis by L1888 , MATRIX_6:def 3;
end;
theorem
L1890: (for R9 being Nat holds (for R16 being Field holds (for R22 being (Matrix of R9 , R16) holds (( Det R22 ) <> ( 0. R16 ) implies ( R22 ~ ) = ( ( ( Det R22 ) " ) * ( ( Matrix_of_Cofactor R22 ) @ ) )))))
proof
let R9 being Nat;
let R16 being Field;
let R22 being (Matrix of R9 , R16);
set D233 = ( ( ( Det R22 ) " ) * ( ( Matrix_of_Cofactor R22 ) @ ) );
assume L1891: ( Det R22 ) <> ( 0. R16 );
L1892: ( R22 * D233 ) = ( 1. (R16 , R9) ) by L1891 , L1779;
L1893: ( D233 * R22 ) = ( 1. (R16 , R9) ) by L1891 , L1843;
L1894: R22 is_reverse_of D233 by L1893 , L1892 , MATRIX_6:def 2;
L1895: R22 is  invertible by L1891 , L1872;
thus L1896: thesis by L1895 , L1894 , MATRIX_6:def 4;
end;
theorem
L1897: (for R9 being Nat holds (for R16 being Field holds (for B98 being (Matrix of R9 , R16) holds (B98 is  invertible implies (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices ( B98 ~ ) ) implies ( ( B98 ~ ) * (R5 , R6) ) = ( ( ( ( Det B98 ) " ) * ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) ) * ( Minor (B98 , R6 , R5) ) ))))))))
proof
let R9 being Nat;
let R16 being Field;
let C187 being (Matrix of R9 , R16);
assume L1898: C187 is  invertible;
L1899: ( Det C187 ) <> ( 0. R16 ) by L1898 , L1872;
set D234 = ( Det C187 );
set D235 = ( Matrix_of_Cofactor C187 );
let R5 being Nat;
let R6 being Nat;
assume L1900: [ R5 , R6 ] in ( Indices ( C187 ~ ) );
L1901: [ R5 , R6 ] in ( Indices ( D235 @ ) ) by L1900 , MATRIX_1:26;
L1902: [ R6 , R5 ] in ( Indices D235 ) by L1901 , MATRIX_1:def 6;
thus L1903: ( ( C187 ~ ) * (R5 , R6) ) = ( ( ( D234 " ) * ( D235 @ ) ) * (R5 , R6) ) by L1899 , L1890
.= ( ( D234 " ) * ( ( D235 @ ) * (R5 , R6) ) ) by L1901 , MATRIX_3:def 5
.= ( ( D234 " ) * ( D235 * (R6 , R5) ) ) by L1902 , MATRIX_1:def 6
.= ( ( D234 " ) * ( Cofactor (C187 , R6 , R5) ) ) by L1902 , L1579
.= ( ( ( D234 " ) * ( ( power R16 ) . (( - ( 1_ R16 ) ) , ( R5 + R6 )) ) ) * ( Minor (C187 , R6 , R5) ) ) by GROUP_1:def 3;
end;
theorem
L1904: (for R9 being Nat holds (for R16 being Field holds (for B99 being (Matrix of R9 , R16) holds (( Det B99 ) <> ( 0. R16 ) implies (for B100 , B101 being (Matrix of R16) holds ((( len B100 ) = R9 & ( B99 * B100 ) = B101) implies (B100 = ( ( B99 ~ ) * B101 ) & (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices B100 ) implies ( B100 * (R5 , R6) ) = ( ( ( Det B99 ) " ) * ( Det ( ReplaceCol (B99 , R5 , ( Col (B101 , R6) )) ) ) )))))))))))
proof
let R9 being Nat;
let R16 being Field;
let C188 being (Matrix of R9 , R16);
assume that
L1905: ( Det C188 ) <> ( 0. R16 );
L1906: C188 is  invertible by L1905 , L1872;
L1907: ( C188 ~ ) is_reverse_of C188 by L1906 , MATRIX_6:def 4;
L1908: ( ( C188 ~ ) * C188 ) = ( 1. (R16 , R9) ) by L1907 , MATRIX_6:def 2;
set D236 = ( Matrix_of_Cofactor C188 );
set D237 = ( Det C188 );
L1909: ( width D236 ) = R9 by MATRIX_1:24;
L1910: ( len ( D236 @ ) ) = R9 by MATRIX_1:24;
L1911: ( width ( D236 @ ) ) = R9 by MATRIX_1:24;
L1912: ( width ( C188 ~ ) ) = R9 by MATRIX_1:24;
L1913: ( width C188 ) = R9 by MATRIX_1:24;
let C189 , C190 being (Matrix of R16);
assume that
L1914: ( len C189 ) = R9
and
L1915: ( C188 * C189 ) = C190;
L1916: ( len C188 ) = R9 by MATRIX_1:24;
L1917: ( len C190 ) = R9 by L1916 , L1914 , L1915 , L1913 , MATRIX_3:def 4;
L1918: C189 = ( ( 1. (R16 , R9) ) * C189 ) by L1914 , MATRIXR2:68;
thus L1919: C189 = ( ( C188 ~ ) * C190 ) by L1918 , L1914 , L1915 , L1912 , L1916 , L1913 , L1908 , MATRIX_3:33;
let R5 being Nat;
let R6 being Nat;
assume that
L1920: [ R5 , R6 ] in ( Indices C189 );
L1921: ( len ( Col (C190 , R6) ) ) = R9 by L1917 , MATRIX_1:def 8;
L1922: ( Indices C189 ) = [: ( Seg R9 ) , ( Seg ( width C189 ) ) :] by L1914 , FINSEQ_1:def 3;
L1923: R5 in ( Seg R9 ) by L1922 , L1920 , ZFMISC_1:87;
L1924: 1 <= R5 by L1923 , FINSEQ_1:1;
L1925: R5 <= R9 by L1923 , FINSEQ_1:1;
thus L1926: ( C189 * (R5 , R6) ) = ( ( Line (( C188 ~ ) , R5) ) "*" ( Col (C190 , R6) ) ) by L1912 , L1919 , L1920 , L1917 , MATRIX_3:def 4
.= ( ( Line (( ( D237 " ) * ( D236 @ ) ) , R5) ) "*" ( Col (C190 , R6) ) ) by L1905 , L1890
.= ( ( ( D237 " ) * ( Line (( D236 @ ) , R5) ) ) "*" ( Col (C190 , R6) ) ) by L1910 , L1924 , L1925 , MATRIXR1:20
.= ( Sum ( ( D237 " ) * ( mlt (( Line (( D236 @ ) , R5) ) , ( Col (C190 , R6) )) ) ) ) by L1911 , L1917 , FVSUM_1:68
.= ( ( D237 " ) * ( ( Line (( D236 @ ) , R5) ) "*" ( Col (C190 , R6) ) ) ) by FVSUM_1:73
.= ( ( D237 " ) * ( ( Col (D236 , R5) ) "*" ( Col (C190 , R6) ) ) ) by L1909 , L1923 , MATRIX_2:15
.= ( ( D237 " ) * ( Sum ( LaplaceExpL (( RLine (( C188 @ ) , R5 , ( Col (C190 , R6) )) ) , R5) ) ) ) by L1923 , L1921 , L1807
.= ( ( D237 " ) * ( Det ( RLine (( C188 @ ) , R5 , ( Col (C190 , R6) )) ) ) ) by L1923 , L1646
.= ( ( D237 " ) * ( Det ( ( RLine (( C188 @ ) , R5 , ( Col (C190 , R6) )) ) @ ) ) ) by MATRIXR2:43
.= ( ( D237 " ) * ( Det ( RCol (C188 , R5 , ( Col (C190 , R6) )) ) ) ) by L857;
end;
theorem
L1927: (for R9 being Nat holds (for R16 being Field holds (for B102 being (Matrix of R9 , R16) holds (( Det B102 ) <> ( 0. R16 ) implies (for B103 , B104 being (Matrix of R16) holds ((( width B103 ) = R9 & ( B103 * B102 ) = B104) implies (B103 = ( B104 * ( B102 ~ ) ) & (for R5 being Nat holds (for R6 being Nat holds ([ R5 , R6 ] in ( Indices B103 ) implies ( B103 * (R5 , R6) ) = ( ( ( Det B102 ) " ) * ( Det ( ReplaceLine (B102 , R6 , ( Line (B104 , R5) )) ) ) )))))))))))
proof
let R9 being Nat;
let R16 being Field;
let C191 being (Matrix of R9 , R16);
assume that
L1928: ( Det C191 ) <> ( 0. R16 );
L1929: C191 is  invertible by L1928 , L1872;
L1930: ( C191 ~ ) is_reverse_of C191 by L1929 , MATRIX_6:def 4;
L1931: ( C191 * ( C191 ~ ) ) = ( 1. (R16 , R9) ) by L1930 , MATRIX_6:def 2;
L1932: ( width C191 ) = R9 by MATRIX_1:24;
let C192 , C193 being (Matrix of R16);
assume that
L1933: ( width C192 ) = R9
and
L1934: ( C192 * C191 ) = C193;
L1935: ( len C191 ) = R9 by MATRIX_1:24;
L1936: ( width C193 ) = R9 by L1935 , L1933 , L1934 , L1932 , MATRIX_3:def 4;
set D238 = ( Matrix_of_Cofactor C191 );
set D239 = ( Det C191 );
L1937: ( len ( D238 @ ) ) = R9 by MATRIX_1:24;
L1938: ( width ( D238 @ ) ) = R9 by MATRIX_1:24;
L1939: ( len D238 ) = R9 by MATRIX_1:24;
L1940: ( Seg R9 ) = ( dom D238 ) by L1939 , FINSEQ_1:def 3;
L1941: ( len ( C191 ~ ) ) = R9 by MATRIX_1:24;
L1942: C192 = ( C192 * ( 1. (R16 , R9) ) ) by L1933 , MATRIXR2:67;
thus L1943: C192 = ( C193 * ( C191 ~ ) ) by L1942 , L1933 , L1934 , L1941 , L1935 , L1932 , L1931 , MATRIX_3:33;
let R5 being Nat;
let R6 being Nat;
assume that
L1944: [ R5 , R6 ] in ( Indices C192 );
L1945: R6 in ( Seg R9 ) by L1933 , L1944 , ZFMISC_1:87;
L1946: 1 <= R6 by L1945 , FINSEQ_1:1;
L1947: ( len ( Line (C193 , R5) ) ) = R9 by L1936 , MATRIX_1:def 7;
L1948: R6 <= R9 by L1945 , FINSEQ_1:1;
thus L1949: ( C192 * (R5 , R6) ) = ( ( Line (C193 , R5) ) "*" ( Col (( C191 ~ ) , R6) ) ) by L1941 , L1943 , L1944 , L1936 , MATRIX_3:def 4
.= ( ( Line (C193 , R5) ) "*" ( Col (( ( D239 " ) * ( D238 @ ) ) , R6) ) ) by L1928 , L1890
.= ( ( Line (C193 , R5) ) "*" ( ( D239 " ) * ( Col (( D238 @ ) , R6) ) ) ) by L1938 , L1946 , L1948 , MATRIXR1:19
.= ( ( ( D239 " ) * ( Col (( D238 @ ) , R6) ) ) "*" ( Line (C193 , R5) ) ) by FVSUM_1:90
.= ( Sum ( ( D239 " ) * ( mlt (( Col (( D238 @ ) , R6) ) , ( Line (C193 , R5) )) ) ) ) by L1937 , L1936 , FVSUM_1:69
.= ( ( D239 " ) * ( ( Col (( D238 @ ) , R6) ) "*" ( Line (C193 , R5) ) ) ) by FVSUM_1:73
.= ( ( D239 " ) * ( ( Line (D238 , R6) ) "*" ( Line (C193 , R5) ) ) ) by L1945 , L1940 , MATRIX_2:14
.= ( ( D239 " ) * ( Sum ( LaplaceExpL (( RLine (C191 , R6 , ( Line (C193 , R5) )) ) , R6) ) ) ) by L1945 , L1947 , L1747
.= ( ( D239 " ) * ( Det ( RLine (C191 , R6 , ( Line (C193 , R5) )) ) ) ) by L1945 , L1646;
end;
begin
definition
let C194 being non  empty set;
let C195 being (FinSequence of C194);
redefine func <*C195 *> -> (Matrix of 1 , ( len C195 ) , C194);

coherence by MATRIX_1:11;
end;
definition
let R16 being Field;
let C196 being (Matrix of R16);
let C197 being (FinSequence of R16);
func C196 * C197 -> (Matrix of R16) equals 
( C196 * ( <* C197 *> @ ) );
coherence;
func C197 * C196 -> (Matrix of R16) equals 
( <* C197 *> * C196 );
coherence;
end;
theorem
L1952: (for R9 being Nat holds (for R16 being Field holds (for B105 being (Matrix of R9 , R16) holds (( Det B105 ) <> ( 0. R16 ) implies (for B106 , B107 being (FinSequence of R16) holds ((( len B106 ) = R9 & ( B105 * B106 ) = ( <* B107 *> @ )) implies (( <* B106 *> @ ) = ( ( B105 ~ ) * B107 ) & (for R5 being Nat holds (R5 in ( Seg R9 ) implies ( B106 . R5 ) = ( ( ( Det B105 ) " ) * ( Det ( ReplaceCol (B105 , R5 , B107) ) ) ))))))))))
proof
let R9 being Nat;
let R16 being Field;
let C198 being (Matrix of R9 , R16);
assume that
L1953: ( Det C198 ) <> ( 0. R16 );
let C199 , C200 being (FinSequence of R16);
assume that
L1954: ( len C199 ) = R9
and
L1955: ( C198 * C199 ) = ( <* C200 *> @ );
set D240 = <* C199 *>;
L1956: ( len D240 ) = 1 by MATRIX_1:def 2;
L1957: ( len C199 ) = ( width D240 ) by L1956 , MATRIX_1:20;
L1958: ( len ( D240 @ ) ) = ( len C199 ) by L1957 , MATRIX_1:def 6;
thus L1959: ( D240 @ ) = ( ( C198 ~ ) * C200 ) by L1958 , L1953 , L1954 , L1955 , L1904;
set D241 = <* C200 *>;
L1960: 1 in ( Seg 1 );
L1961: ( Line (D240 , 1) ) = ( D240 . 1 ) by L1960 , MATRIX_2:8;
L1962: ( len D241 ) = 1 by MATRIX_1:def 2;
L1963: 1 in ( dom D241 ) by L1962 , L1960 , FINSEQ_1:def 3;
L1964: ( Line (D241 , 1) ) = ( D241 . 1 ) by L1960 , MATRIX_2:8;
let R5 being Nat;
assume that
L1965: R5 in ( Seg R9 );
L1966: R9 > ( 0 ) by L1965;
L1967: ( width ( D240 @ ) ) = ( len D240 ) by L1966 , L1954 , L1957 , MATRIX_2:10
.= 1 by MATRIX_1:def 2;
L1968: ( Indices ( D240 @ ) ) = [: ( Seg R9 ) , ( Seg 1 ) :] by L1967 , L1954 , L1958 , FINSEQ_1:def 3;
L1969: [ R5 , 1 ] in ( Indices ( D240 @ ) ) by L1968 , L1965 , L1960 , ZFMISC_1:87;
L1970: [ 1 , R5 ] in ( Indices D240 ) by L1969 , MATRIX_1:def 6;
L1971: ( ( D240 @ ) * (R5 , 1) ) = ( D240 * (1 , R5) ) by L1970 , MATRIX_1:def 6
.= ( ( Line (D240 , 1) ) . R5 ) by L1954 , L1957 , L1965 , MATRIX_1:def 7
.= ( C199 . R5 ) by L1961 , FINSEQ_1:40;
thus L1972: ( C199 . R5 ) = ( ( ( Det C198 ) " ) * ( Det ( ReplaceCol (C198 , R5 , ( Col (( D241 @ ) , 1) )) ) ) ) by L1971 , L1953 , L1954 , L1955 , L1958 , L1969 , L1904
.= ( ( ( Det C198 ) " ) * ( Det ( ReplaceCol (C198 , R5 , ( Line (D241 , 1) )) ) ) ) by L1963 , MATRIX_2:14
.= ( ( ( Det C198 ) " ) * ( Det ( ReplaceCol (C198 , R5 , C200) ) ) ) by L1964 , FINSEQ_1:40;
end;
::$N Cramer's Rule
theorem
L1973: (for R9 being Nat holds (for R16 being Field holds (for B108 being (Matrix of R9 , R16) holds (( Det B108 ) <> ( 0. R16 ) implies (for B109 , B110 being (FinSequence of R16) holds ((( len B109 ) = R9 & ( B109 * B108 ) = <* B110 *>) implies (<* B109 *> = ( B110 * ( B108 ~ ) ) & (for R5 being Nat holds (R5 in ( Seg R9 ) implies ( B109 . R5 ) = ( ( ( Det B108 ) " ) * ( Det ( ReplaceLine (B108 , R5 , B110) ) ) ))))))))))
proof
let R9 being Nat;
let R16 being Field;
let C201 being (Matrix of R9 , R16);
assume that
L1974: ( Det C201 ) <> ( 0. R16 );
let C202 , C203 being (FinSequence of R16);
assume that
L1975: ( len C202 ) = R9
and
L1976: ( C202 * C201 ) = <* C203 *>;
set D242 = <* C202 *>;
L1977: ( width D242 ) = ( len C202 ) by MATRIX_1:23;
thus L1978: D242 = ( C203 * ( C201 ~ ) ) by L1977 , L1974 , L1975 , L1976 , L1927;
L1979: [: ( Seg 1 ) , ( Seg R9 ) :] = ( Indices D242 ) by L1975 , MATRIX_1:23;
set D243 = <* C203 *>;
L1980: 1 in ( Seg 1 );
L1981: ( Line (D242 , 1) ) = ( D242 . 1 ) by L1980 , MATRIX_2:8;
let R5 being Nat;
assume that
L1982: R5 in ( Seg R9 );
L1983: [ 1 , R5 ] in [: ( Seg 1 ) , ( Seg R9 ) :] by L1982 , L1980 , ZFMISC_1:87;
L1984: ( Line (D243 , 1) ) = ( D243 . 1 ) by L1980 , MATRIX_2:8;
L1985: ( D242 * (1 , R5) ) = ( ( Line (D242 , 1) ) . R5 ) by L1975 , L1977 , L1982 , MATRIX_1:def 7
.= ( C202 . R5 ) by L1981 , FINSEQ_1:40;
thus L1986: ( C202 . R5 ) = ( ( ( Det C201 ) " ) * ( Det ( ReplaceLine (C201 , R5 , ( Line (D243 , 1) )) ) ) ) by L1985 , L1974 , L1975 , L1976 , L1977 , L1983 , L1979 , L1927
.= ( ( ( Det C201 ) " ) * ( Det ( ReplaceLine (C201 , R5 , C203) ) ) ) by L1984 , FINSEQ_1:40;
end;
