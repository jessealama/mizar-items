:: Free Universal Algebra Construction
::  by Beata Perkowska
::
:: Received October 20, 1993
:: Copyright (c) 1993-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, SUBSET_1, XBOOLE_0, ARYTM_1, CARD_1, RELAT_1, FINSEQ_1,
      QUANTAL1, UNIALG_1, UNIALG_2, FUNCT_1, MSAFREE, TARSKI, STRUCT_0,
      FINSEQ_2, PRELAMB, CQC_SIM1, MSUALG_3, FUNCOP_1, PARTFUN1, FUNCT_2,
      NAT_1, LANG1, TDGROUP, DTCONSTR, TREES_3, TREES_4, CARD_3, TREES_2,
      QC_LANG1, FREEALG;
 notations TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, XCMPLX_0, ORDINAL1, RELAT_1,
      RELSET_1, FUNCT_1, PARTFUN1, FINSEQ_1, FUNCT_2, FUNCOP_1, FINSEQ_2,
      TREES_2, TREES_3, TREES_4, MARGREL1, STRUCT_0, UNIALG_1, UNIALG_2, LANG1,
      DTCONSTR, PRE_POLY, ALG_1;
 constructors DOMAIN_1, FINSEQOP, DTCONSTR, ALG_1, RELSET_1, PRE_POLY;
 registrations XBOOLE_0, SUBSET_1, RELAT_1, ORDINAL1, PARTFUN1, XREAL_0,
      FINSEQ_1, FINSEQ_2, TREES_3, STRUCT_0, UNIALG_2, DTCONSTR, CARD_1,
      RELSET_1, MARGREL1, FUNCT_1;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, UNIALG_2, DTCONSTR, XBOOLE_0, FINSEQ_2, FUNCOP_1,
      MARGREL1;
 theorems FINSEQ_1, FINSEQ_2, PARTFUN1, FUNCT_1, FUNCT_2, NAT_1, ZFMISC_1,
      UNIALG_1, ALG_1, TARSKI, FUNCOP_1, UNIALG_2, LANG1, DTCONSTR, RELAT_1,
      XBOOLE_0, XBOOLE_1, TREES_3, MARGREL1, FINSEQ_3, CARD_1;
 schemes PARTFUN1, FINSEQ_1, RELSET_1, DTCONSTR;

begin
definition
let C1 being set;
attr C1 is  disjoint_with_NAT
means
:L1: C1 misses ( NAT );
end;
registration
cluster non  empty  disjoint_with_NAT for set;
existence
proof
take D1 = { ( - 1 ) };
thus L3: D1 is non  empty;
L4:
now
assume L5: D1 meets ( NAT );
consider R1 being set such that L6: R1 in D1 and L7: R1 in ( NAT ) by L5 , XBOOLE_0:3;
reconsider D2 = R1 as (Element of ( NAT )) by L7;
L8: D2 = ( - 1 ) by L6 , TARSKI:def 1;
thus L9: contradiction by L8 , NAT_1:2;
end;
thus L10: thesis by L4 , L1;
end;
end;
L12: ((not ( 0 ) in ( rng <* 1 *> )) & ( 0 ) in ( rng <* ( 0 ) *> ))
proof
L13: (( rng <* ( 0 ) *> ) = { ( 0 ) } & ( rng <* 1 *> ) = { 1 }) by FINSEQ_1:38;
thus L14: thesis by L13 , TARSKI:def 1;
end;
notation
let C2 being Relation;
antonym C2 is  with_zero for C2 is  non-empty;
synonym C2 is  without_zero for C2 is  non-empty;
end;
definition
let C3 being Relation;
redefine attr C3 is  with_zero
means
:L16: ( 0 ) in ( rng C3 );
compatibility by RELAT_1:def 9;
end;
registration
cluster non  empty  with_zero for (FinSequence of ( NAT ));
existence
proof
reconsider D3 = <* ( 0 ) *> as (FinSequence of ( NAT ));
take D3;
thus L18: D3 is non  empty;
thus L19: ( 0 ) in ( rng D3 ) by L12;
end;
cluster non  empty  without_zero for (FinSequence of ( NAT ));
existence
proof
reconsider D4 = <* 1 *> as (FinSequence of ( NAT ));
take D4;
thus L20: D4 is non  empty;
thus L21: (not ( 0 ) in ( rng D4 )) by L12;
end;
end;
begin
definition
let C4 being Universal_Algebra;
let C5 being (Element of ( NAT ));
assume L23: C5 in ( dom (the charact of C4) );
func oper (C5 , C4) -> (operation of C4) equals 
:L24: ( (the charact of C4) . C5 );
coherence by L23 , FUNCT_1:def 3;
end;
definition
let C6 being Universal_Algebra;
mode GeneratorSet of C6
 -> (Subset of C6)
means (for B1 being (Subset of C6) holds ((B1 is  opers_closed & it c= B1) implies B1 = (the carrier of C6)));
existence
proof
L26: (the carrier of C6) c= (the carrier of C6);
reconsider D5 = (the carrier of C6) as non  empty (Subset of C6) by L26;
take D5;
thus L27: thesis by XBOOLE_0:def 10;
end;
end;
L29: (for B2 being Universal_Algebra holds (for B3 being (Subset of B2) holds (B3 is  opers_closed implies ( Constants B2 ) c= B3)))
proof
let C7 being Universal_Algebra;
let C8 being (Subset of C7);
assume that
L30: C8 is  opers_closed;
let C9 being set;
assume L31: C9 in ( Constants C7 );
consider C10 being (Element of C7) such that L32: C9 = C10 and L33: (ex B4 being (Element of ( Operations C7 )) st (( arity B4 ) = ( 0 ) & C10 in ( rng B4 ))) by L31;
consider C11 being (Element of ( Operations C7 )) such that L34: ( arity C11 ) = ( 0 ) and L35: C10 in ( rng C11 ) by L33;
L36: C8 is_closed_on C11 by L30 , UNIALG_2:def 4;
consider C12 being set such that L37: C12 in ( dom C11 ) and L38: C10 = ( C11 . C12 ) by L35 , FUNCT_1:def 3;
reconsider D6 = C12 as (Element of ( (the carrier of C7) * )) by L37;
L39: ( dom C11 ) = ( ( 0 ) -tuples_on (the carrier of C7) ) by L34 , MARGREL1:22;
L40: D6 = ( {} ) by L39 , L37;
L41: ( rng D6 ) c= C8 by L40 , RELAT_1:38 , XBOOLE_1:2;
L42: D6 is (FinSequence of C8) by L41 , FINSEQ_1:def 4;
L43: ( len D6 ) = ( 0 ) by L37 , L39;
thus L44: thesis by L43 , L32 , L34 , L38 , L42 , L36 , UNIALG_2:def 3;
end;
L45: (for B5 being Universal_Algebra holds (for B6 being (Subset of B5) holds ((B6 <> ( {} ) or ( Constants B5 ) <> ( {} )) implies (B6 is (GeneratorSet of B5) iff (the carrier of ( GenUnivAlg B6 )) = (the carrier of B5)))))
proof
let C13 being Universal_Algebra;
let C14 being (Subset of C13);
assume L46: (C14 <> ( {} ) or ( Constants C13 ) <> ( {} ));
thus L47: (C14 is (GeneratorSet of C13) implies (the carrier of ( GenUnivAlg C14 )) = (the carrier of C13))
proof
reconsider D7 = (the carrier of ( GenUnivAlg C14 )) as non  empty (Subset of C13) by UNIALG_2:def 7;
assume L48: (for B7 being (Subset of C13) holds ((B7 is  opers_closed & C14 c= B7) implies B7 = (the carrier of C13)));
L49: (C14 c= D7 & D7 is  opers_closed) by L46 , UNIALG_2:def 7 , UNIALG_2:def 12;
thus L50: thesis by L49 , L48;
end;

assume L51: (the carrier of ( GenUnivAlg C14 )) = (the carrier of C13);
let C15 being (Subset of C13);
assume that
L52: C15 is  opers_closed
and
L53: C14 c= C15;
reconsider D8 = C15 as non  empty (Subset of C13) by L46 , L52 , L53 , L29 , XBOOLE_1:3;
thus L54: C15 c= (the carrier of C13);
L55: ( UniAlgSetClosed D8 ) = UAStr (# D8 , ( Opers (C13 , D8) ) #) by L52 , UNIALG_2:def 8;
L56: ( GenUnivAlg C14 ) is (SubAlgebra of ( UniAlgSetClosed D8 )) by L55 , L46 , L53 , UNIALG_2:def 12;
L57: (the carrier of C13) is (Subset of D8) by L56 , L51 , L55 , UNIALG_2:def 7;
thus L58: thesis by L57;
end;
definition
let C16 being Universal_Algebra;
let C17 being (GeneratorSet of C16);
attr C17 is  free
means
:L59: (for B8 being Universal_Algebra holds (C16 , B8 are_similar  implies (for B9 being (Function of C17 , (the carrier of B8)) holds (ex B10 being (Function of C16 , B8) st (B10 is_homomorphism C16 , B8 & ( B10 | C17 ) = B9)))));
end;
definition
let C18 being Universal_Algebra;
attr C18 is  free
means
:L61: (ex B11 being (GeneratorSet of C18) st B11 is  free);
end;
registration
cluster  free  strict for Universal_Algebra;
existence
proof
set D9 = the set;
reconsider D10 = { D9 } as non  empty set;
set D11 = the (Element of D10);
reconsider D12 = ( ( <*> D10 ) .--> D11 ) as (Element of ( PFuncs (( D10 * ) , D10) )) by MARGREL1:19;
reconsider D13 = <* D12 *> as (PFuncFinSequence of D10);
set D14 = UAStr (# D10 , D13 #);
L63: ((the charact of D14) is  quasi_total & (the charact of D14) is  homogeneous) by MARGREL1:20;
L64: (the charact of D14) is  non-empty by MARGREL1:20;
L65: ( len (the charact of D14) ) = 1 by FINSEQ_1:39;
reconsider D15 = D14 as Universal_Algebra by L63 , L64 , UNIALG_1:def 1 , UNIALG_1:def 2 , UNIALG_1:def 3;
L66: ( dom (the charact of D15) ) = { 1 } by L65 , FINSEQ_1:2 , FINSEQ_1:def 3;
L67: 1 in { 1 } by TARSKI:def 1;
reconsider D16 = ( (the charact of D15) . 1 ) as (operation of D15) by L67 , L66 , FUNCT_1:def 3;
take D15;
L68: ( GenUnivAlg ( {} (the carrier of D15) ) ) = D15
proof
set D17 = ( {} (the carrier of D15) );
reconsider D18 = (the carrier of ( GenUnivAlg D17 )) as non  empty (Subset of D15) by UNIALG_2:def 7;
L69: ( dom (the charact of D15) ) = ( dom ( Opers (D15 , D18) ) ) by UNIALG_2:def 6;
L70: D18 = (the carrier of D15) by ZFMISC_1:33;
L71: (for B12 being Nat holds (B12 in ( dom (the charact of D15) ) implies ( (the charact of D15) . B12 ) = ( ( Opers (D15 , D18) ) . B12 )))
proof
let C19 being Nat;
assume L72: C19 in ( dom (the charact of D15) );
reconsider D19 = ( (the charact of D15) . C19 ) as (operation of D15) by L72 , FUNCT_1:def 3;
L73: ( ( Opers (D15 , D18) ) . C19 ) = ( D19 /. D18 ) by L69 , L72 , UNIALG_2:def 6;
thus L74: thesis by L73 , L70 , UNIALG_2:4;
end;
L75: (the charact of D15) = ( Opers (D15 , D18) ) by L71 , L69 , FINSEQ_1:13
.= (the charact of ( GenUnivAlg D17 )) by UNIALG_2:def 7;
thus L76: thesis by L75 , L70;
end;
L77: D16 = D12 by FINSEQ_1:40;
L78: ( dom D16 ) = { ( <*> D10 ) } by L77 , FUNCOP_1:13;
L79:
now
L80: ( <*> D10 ) in ( dom D16 ) by L78 , TARSKI:def 1;
thus L81: (ex B13 being FinSequence st B13 in ( dom D16 )) by L80;
let C20 being FinSequence;
assume L82: C20 in ( dom D16 );
L83: C20 = ( <*> D10 ) by L82 , L78 , TARSKI:def 1;
thus L84: ( len C20 ) = ( 0 ) by L83;
end;
L85: ( arity D16 ) = ( 0 ) by L79 , MARGREL1:def 25;
L86: ( {} ) in { ( <*> D10 ) } by TARSKI:def 1;
L87: ( D16 . ( <*> D10 ) ) = D11 by L86 , L77 , FUNCOP_1:7;
L88: D11 in ( rng D16 ) by L87 , L78 , L86 , FUNCT_1:def 3;
L89: D11 in ( Constants D15 ) by L88 , L85;
reconsider D20 = ( {} (the carrier of D15) ) as (GeneratorSet of D15) by L89 , L68 , L45;
L90:
now
take D21 = D20;
L91:
now
let C21 being Universal_Algebra;
L92: 1 in { 1 } by TARSKI:def 1;
assume L93: D15 , C21 are_similar ;
L94: ( signature D15 ) = ( signature C21 ) by L93 , UNIALG_2:def 1;
L95: ( len (the charact of C21) ) = 1 by L65 , L93 , UNIALG_2:1;
L96: ( dom (the charact of C21) ) = { 1 } by L95 , FINSEQ_1:2 , FINSEQ_1:def 3;
reconsider D22 = ( (the charact of C21) . 1 ) as (operation of C21) by L96 , L92 , FUNCT_1:def 3;
L97: ( rng D22 ) c= (the carrier of C21) by RELAT_1:def 19;
let C22 being (Function of D21 , (the carrier of C21));
consider C23 being set such that L98: C23 in ( dom D22 ) by XBOOLE_0:def 1;
L99: ( D22 . C23 ) in ( rng D22 ) by L98 , FUNCT_1:def 3;
reconsider D23 = ( D22 . C23 ) as (Element of C21) by L99 , L97;
reconsider D24 = ( (the carrier of D15) --> D23 ) as (Function of D15 , C21);
take D25 = D24;
L100: (( len ( signature D15 ) ) = ( len (the charact of D15) ) & ( dom ( signature D15 ) ) = ( Seg ( len ( signature D15 ) ) )) by FINSEQ_1:def 3 , UNIALG_1:def 4;
L101: ( ( signature D15 ) . 1 ) = ( arity D16 ) by L100 , L65 , L92 , FINSEQ_1:2 , UNIALG_1:def 4;
L102: ( arity D16 ) = ( arity D22 ) by L101 , L65 , L92 , L94 , L100 , FINSEQ_1:2 , UNIALG_1:def 4;
L103:
now
let C24 being (Element of ( NAT ));
assume L104: C24 in ( dom (the charact of D15) );
L105: C24 = 1 by L104 , L66 , TARSKI:def 1;
let C25 being (operation of D15);
let C26 being (operation of C21);
assume that
L106: C25 = ( (the charact of D15) . C24 )
and
L107: C26 = ( (the charact of C21) . C24 );
let C27 being (FinSequence of D15);
assume L108: C27 in ( dom C25 );
L109: C27 = ( <*> (the carrier of D15) ) by L108 , L78 , L105 , L106 , TARSKI:def 1;
L110: ( D25 * C27 ) = ( <*> (the carrier of C21) ) by L109;
L111: ( dom C26 ) = ( ( 0 ) -tuples_on (the carrier of C21) ) by L85 , L102 , L105 , L107 , MARGREL1:22
.= { ( <*> (the carrier of C21) ) } by FINSEQ_2:94;
L112: ( C26 . ( D25 * C27 ) ) = D23 by L111 , L98 , L105 , L107 , L110 , TARSKI:def 1;
L113: ( rng C25 ) c= (the carrier of D15) by RELAT_1:def 19;
L114: ( C25 . C27 ) in ( rng C25 ) by L108 , FUNCT_1:def 3;
thus L115: ( D25 . ( C25 . C27 ) ) = ( C26 . ( D25 * C27 ) ) by L114 , L112 , L113 , FUNCOP_1:7;
end;
thus L116: D25 is_homomorphism D15 , C21 by L103 , L93 , ALG_1:def 1;
L117: C22 = ( {} );
thus L118: ( D25 | D21 ) = C22 by L117;
end;
thus L119: D21 is  free by L91 , L59;
end;
thus L120: thesis by L90 , L61;
end;
end;
registration
let C28 being  free Universal_Algebra;
cluster  free for (GeneratorSet of C28);
existence by L61;
end;
theorem
L123: (for B14 being  strict Universal_Algebra holds (for B15 being (Subset of B14) holds ((( Constants B14 ) <> ( {} ) or B15 <> ( {} )) implies (B15 is (GeneratorSet of B14) iff ( GenUnivAlg B15 ) = B14))))
proof
let C29 being  strict Universal_Algebra;
let C30 being (Subset of C29);
assume that
L124: (( Constants C29 ) <> ( {} ) or C30 <> ( {} ));
thus L125: (C30 is (GeneratorSet of C29) implies ( GenUnivAlg C30 ) = C29)
proof
assume L126: C30 is (GeneratorSet of C29);
L127: (the carrier of ( GenUnivAlg C30 )) = (the carrier of C29) by L126 , L124 , L45;
L128: C29 is  strict  strict  strict  strict (SubAlgebra of C29) by UNIALG_2:8;
thus L129: thesis by L128 , L127 , UNIALG_2:12;
end;

assume L130: ( GenUnivAlg C30 ) = C29;
thus L131: thesis by L130 , L124 , L45;
end;
begin
definition
let C31 being non  empty (FinSequence of ( NAT ));
let C32 being set;
func REL (C31 , C32) -> (Relation of ( ( dom C31 ) \/ C32 ) , ( ( ( dom C31 ) \/ C32 ) * )) means 
:L132: (for B16 being (Element of ( ( dom C31 ) \/ C32 )) holds (for B17 being (Element of ( ( ( dom C31 ) \/ C32 ) * )) holds ([ B16 , B17 ] in it iff (B16 in ( dom C31 ) & ( C31 . B16 ) = ( len B17 )))));
existence
proof
set D26 = ( ( dom C31 ) \/ C32 );
defpred S1[ (Element of D26) , (Element of ( D26 * )) ] means ($1 in ( dom C31 ) & ( C31 . $1 ) = ( len $2 ));
consider C33 being (Relation of D26 , ( D26 * )) such that L133: (for B18 being (Element of D26) holds (for B19 being (Element of ( D26 * )) holds ([ B18 , B19 ] in C33 iff S1[ B18 , B19 ]))) from RELSET_1:sch 2;
take C33;
let C34 being (Element of D26);
let C35 being (Element of ( D26 * ));
thus L134: thesis by L133;
end;
uniqueness
proof
set D27 = ( ( dom C31 ) \/ C32 );
let C36 , C37 being (Relation of D27 , ( D27 * ));
assume that
L135: (for B20 being (Element of D27) holds (for B21 being (Element of ( D27 * )) holds ([ B20 , B21 ] in C36 iff (B20 in ( dom C31 ) & ( C31 . B20 ) = ( len B21 )))))
and
L136: (for B22 being (Element of D27) holds (for B23 being (Element of ( D27 * )) holds ([ B22 , B23 ] in C37 iff (B22 in ( dom C31 ) & ( C31 . B22 ) = ( len B23 )))));
L137: (for R1 being set holds (for R2 being set holds ([ R1 , R2 ] in C36 iff [ R1 , R2 ] in C37)))
proof
let R1 being set;
let R2 being set;
thus L138: ([ R1 , R2 ] in C36 implies [ R1 , R2 ] in C37)
proof
assume L139: [ R1 , R2 ] in C36;
reconsider D28 = R1 as (Element of D27) by L139 , ZFMISC_1:87;
reconsider D29 = R2 as (Element of ( D27 * )) by L139 , ZFMISC_1:87;
L140: [ D28 , D29 ] in C36 by L139;
L141: D28 in ( dom C31 ) by L140 , L135;
L142: ( C31 . D28 ) = ( len D29 ) by L135 , L139;
thus L143: thesis by L142 , L136 , L141;
end;

assume L144: [ R1 , R2 ] in C37;
reconsider D30 = R1 as (Element of D27) by L144 , ZFMISC_1:87;
reconsider D31 = R2 as (Element of ( D27 * )) by L144 , ZFMISC_1:87;
L145: [ D30 , D31 ] in C37 by L144;
L146: D30 in ( dom C31 ) by L145 , L136;
L147: ( C31 . D30 ) = ( len D31 ) by L136 , L144;
thus L148: thesis by L147 , L135 , L146;
end;
thus L149: thesis by L137 , RELAT_1:def 2;
end;
end;
definition
let C38 being non  empty (FinSequence of ( NAT ));
let C39 being set;
func DTConUA (C38 , C39) ->  strict DTConstrStr equals 
DTConstrStr (# ( ( dom C38 ) \/ C39 ) , ( REL (C38 , C39) ) #);
correctness;
end;
registration
let C40 being non  empty (FinSequence of ( NAT ));
let C41 being set;
cluster ( DTConUA (C40 , C41) ) -> non  empty;
coherence;
end;
theorem
L153: (for B24 being non  empty (FinSequence of ( NAT )) holds (for B25 being set holds (( Terminals ( DTConUA (B24 , B25) ) ) c= B25 & ( NonTerminals ( DTConUA (B24 , B25) ) ) = ( dom B24 ))))
proof
let C42 being non  empty (FinSequence of ( NAT ));
let C43 being set;
set D32 = ( DTConUA (C42 , C43) );
set D33 = ( ( dom C42 ) \/ C43 );
L154: (the carrier of D32) = ( ( Terminals D32 ) \/ ( NonTerminals D32 ) ) by LANG1:1;
L155: ( Terminals D32 ) misses ( NonTerminals D32 ) by DTCONSTR:8;
L156: ( ( Terminals D32 ) /\ ( NonTerminals D32 ) ) = ( {} ) by L155 , XBOOLE_0:def 7;
thus L157: ( Terminals D32 ) c= C43
proof
let R1 being set;
assume L158: R1 in ( Terminals D32 );
reconsider D34 = R1 as (Element of D33) by L158 , L154 , XBOOLE_0:def 3;
reconsider D35 = R1 as (Element of (the carrier of D32)) by L154 , L158 , XBOOLE_0:def 3;
L159:
now
L160: ( rng C42 ) c= ( NAT ) by FINSEQ_1:def 4;
assume L161: R1 in ( dom C42 );
L162: ( C42 . R1 ) in ( rng C42 ) by L161 , FUNCT_1:def 3;
reconsider D36 = ( C42 . R1 ) as (Element of ( NAT )) by L162 , L160;
reconsider D37 = ( D36 |-> D34 ) as (FinSequence of D33);
reconsider D38 = D37 as (Element of ( D33 * )) by FINSEQ_1:def 11;
L163: ( len D38 ) = ( C42 . D34 ) by CARD_1:def 7;
L164: [ D34 , D38 ] in ( REL (C42 , C43) ) by L163 , L161 , L132;
L165: D35 ==> D38 by L164 , LANG1:def 1;
L166: D35 in { B26 where B26 is (Symbol of D32) : (ex B27 being FinSequence st B26 ==> B27) } by L165;
L167: R1 in ( NonTerminals D32 ) by L166 , LANG1:def 3;
thus L168: contradiction by L167 , L156 , L158 , XBOOLE_0:def 4;
end;
L169: R1 in ( ( dom C42 ) \/ C43 ) by L154 , L158 , XBOOLE_0:def 3;
thus L170: thesis by L169 , L159 , XBOOLE_0:def 3;
end;

thus L171: ( NonTerminals D32 ) c= ( dom C42 )
proof
let R1 being set;
assume L172: R1 in ( NonTerminals D32 );
L173: R1 in { B28 where B28 is (Symbol of D32) : (ex B29 being FinSequence st B28 ==> B29) } by L172 , LANG1:def 3;
consider C44 being (Symbol of D32) such that L174: R1 = C44 and L175: (ex B30 being FinSequence st C44 ==> B30) by L173;
consider C45 being FinSequence such that L176: C44 ==> C45 by L175;
L177: [ C44 , C45 ] in (the Rules of D32) by L176 , LANG1:def 1;
reconsider D39 = C45 as (Element of ( D33 * )) by L177 , ZFMISC_1:87;
reconsider D40 = C44 as (Element of D33);
L178: [ D40 , D39 ] in ( REL (C42 , C43) ) by L176 , LANG1:def 1;
thus L179: thesis by L178 , L174 , L132;
end;

let R1 being set;
L180: ( rng C42 ) c= ( NAT ) by FINSEQ_1:def 4;
assume L181: R1 in ( dom C42 );
reconsider D41 = R1 as (Symbol of D32) by L181 , XBOOLE_0:def 3;
L182: ( C42 . R1 ) in ( rng C42 ) by L181 , FUNCT_1:def 3;
reconsider D42 = ( C42 . R1 ) as (Element of ( NAT )) by L182 , L180;
reconsider D43 = R1 as (Element of D33) by L181 , XBOOLE_0:def 3;
reconsider D44 = ( D42 |-> D43 ) as (FinSequence of D33);
reconsider D45 = D44 as (Element of ( D33 * )) by FINSEQ_1:def 11;
L183: ( len D45 ) = ( C42 . D43 ) by CARD_1:def 7;
L184: [ D43 , D45 ] in ( REL (C42 , C43) ) by L183 , L181 , L132;
L185: D41 ==> D45 by L184 , LANG1:def 1;
L186: D41 in { B31 where B31 is (Symbol of D32) : (ex B32 being FinSequence st B31 ==> B32) } by L185;
thus L187: thesis by L186 , LANG1:def 3;
end;
theorem
L188: (for B33 being non  empty (FinSequence of ( NAT )) holds (for B34 being  disjoint_with_NAT set holds ( Terminals ( DTConUA (B33 , B34) ) ) = B34))
proof
let C46 being non  empty (FinSequence of ( NAT ));
let C47 being  disjoint_with_NAT set;
set D46 = ( DTConUA (C46 , C47) );
thus L189: ( Terminals D46 ) c= C47 by L153;
let R1 being set;
assume L190: R1 in C47;
L191: ( NonTerminals D46 ) = ( dom C46 ) by L153;
L192:
now
assume L193: R1 in ( NonTerminals D46 );
L194: C47 meets ( NAT ) by L193 , L191 , L190 , XBOOLE_0:3;
thus L195: contradiction by L194 , L1;
end;
L196: ((the carrier of D46) = ( ( Terminals D46 ) \/ ( NonTerminals D46 ) ) & R1 in ( ( dom C46 ) \/ C47 )) by L190 , LANG1:1 , XBOOLE_0:def 3;
thus L197: thesis by L196 , L192 , XBOOLE_0:def 3;
end;
registration
let C48 being non  empty (FinSequence of ( NAT ));
let C49 being set;
cluster ( DTConUA (C48 , C49) ) ->  with_nonterminals;
coherence
proof
L198: ( NonTerminals ( DTConUA (C48 , C49) ) ) = ( dom C48 ) by L153;
thus L199: thesis by L198 , DTCONSTR:def 4;
end;
end;
registration
let C50 being  with_zero non  empty (FinSequence of ( NAT ));
let C51 being set;
cluster ( DTConUA (C50 , C51) ) ->  with_nonterminals  with_useful_nonterminals;
coherence
proof
set D47 = ( DTConUA (C50 , C51) );
set D48 = ( ( dom C50 ) \/ C51 );
L201: D47 is  with_useful_nonterminals
proof
set D49 = ( <*> ( TS D47 ) );
let C52 being (Symbol of D47);
assume L202: C52 in ( NonTerminals D47 );
L203: ( rng C50 ) c= ( NAT ) by FINSEQ_1:def 4;
L204: ( NonTerminals D47 ) = ( dom C50 ) by L153;
L205: ( C50 . C52 ) in ( rng C50 ) by L204 , L202 , FUNCT_1:def 3;
reconsider D50 = ( C50 . C52 ) as (Element of ( NAT )) by L205 , L203;
reconsider D51 = C52 as (Element of D48);
L206: ( roots D49 ) = ( <*> D48 ) by DTCONSTR:3;
reconsider D52 = ( roots D49 ) as (Element of ( D48 * )) by L206;
L207: ( 0 ) in ( rng C50 ) by L16;
consider R1 being set such that L208: R1 in ( dom C50 ) and L209: ( C50 . R1 ) = ( 0 ) by L207 , FUNCT_1:def 3;
L210: ( NonTerminals D47 ) = ( dom C50 ) by L153;
reconsider D53 = R1 as (Symbol of D47) by L210 , L208;
set D54 = ( D50 |-> ( D53 -tree D49 ) );
L211: ( len D54 ) = D50 by CARD_1:def 7;
L212: ( len D52 ) = ( 0 ) by DTCONSTR:3;
L213: [ D53 , ( roots D49 ) ] in (the Rules of D47) by L212 , L208 , L209 , L132;
L214: D53 ==> ( roots D49 ) by L213 , LANG1:def 1;
L215: ( D53 -tree D49 ) in ( TS D47 ) by L214 , DTCONSTR:def 1;
L216: ( rng D54 ) c= ( TS D47 )
proof
let R2 being set;
assume L217: R2 in ( rng D54 );
L218: (ex B35 being Nat st (B35 in ( dom D54 ) & ( D54 . B35 ) = R2)) by L217 , FINSEQ_2:10;
L219: ( dom D54 ) = ( Seg ( len D54 ) ) by FINSEQ_1:def 3;
thus L220: thesis by L219 , L215 , L211 , L218 , FUNCOP_1:7;
end;
L221: ( dom ( roots D54 ) ) = ( dom D54 ) by TREES_3:def 18
.= ( Seg ( len D54 ) ) by FINSEQ_1:def 3;
L222: ( len ( roots D54 ) ) = D50 by L221 , L211 , FINSEQ_1:def 3;
reconsider D55 = D54 as (FinSequence of ( TS D47 )) by L216 , FINSEQ_1:def 4;
take D55;
reconsider D56 = D55 as (FinSequence of ( FinTrees (the carrier of D47) ));
reconsider D57 = ( roots D56 ) as (Element of ( D48 * )) by FINSEQ_1:def 11;
L223: [ D51 , D57 ] in ( REL (C50 , C51) ) by L202 , L210 , L222 , L132;
thus L224: thesis by L223 , LANG1:def 1;
end;
thus L225: thesis by L201;
end;
end;
registration
let C53 being non  empty (FinSequence of ( NAT ));
let C54 being  disjoint_with_NAT non  empty set;
cluster ( DTConUA (C53 , C54) ) ->  with_terminals  with_nonterminals  with_useful_nonterminals;
coherence
proof
set D58 = ( DTConUA (C53 , C54) );
L227: ( NonTerminals D58 ) = ( dom C53 ) by L153;
L228: ( Terminals D58 ) = C54 by L188;
L229: D58 is  with_useful_nonterminals
proof
set D59 = the (Element of C54);
let C55 being (Symbol of D58);
reconsider D60 = D59 as (Symbol of D58) by XBOOLE_0:def 3;
L230: ( rng C53 ) c= ( NAT ) by FINSEQ_1:def 4;
assume L231: C55 in ( NonTerminals D58 );
L232: ( C53 . C55 ) in ( rng C53 ) by L231 , L227 , FUNCT_1:def 3;
reconsider D61 = ( C53 . C55 ) as (Element of ( NAT )) by L232 , L230;
reconsider D62 = C55 as (Element of ( ( dom C53 ) \/ C54 ));
set D63 = ( D61 |-> ( root-tree D60 ) );
L233: ( len D63 ) = D61 by CARD_1:def 7;
L234: ( root-tree D60 ) in ( TS D58 ) by L228 , DTCONSTR:def 1;
L235: ( rng D63 ) c= ( TS D58 )
proof
let R2 being set;
assume L236: R2 in ( rng D63 );
consider C56 being Nat such that L237: C56 in ( dom D63 ) and L238: ( D63 . C56 ) = R2 by L236 , FINSEQ_2:10;
L239: C56 in ( Seg ( len D63 ) ) by L237 , FINSEQ_1:def 3;
thus L240: thesis by L239 , L234 , L233 , L238 , FUNCOP_1:7;
end;
L241: ( dom ( roots D63 ) ) = ( dom D63 ) by TREES_3:def 18
.= ( Seg ( len D63 ) ) by FINSEQ_1:def 3;
L242: ( len ( roots D63 ) ) = D61 by L241 , L233 , FINSEQ_1:def 3;
reconsider D64 = D63 as (FinSequence of ( TS D58 )) by L235 , FINSEQ_1:def 4;
take D64;
reconsider D65 = D64 as (FinSequence of ( FinTrees (the carrier of D58) ));
reconsider D66 = ( roots D65 ) as (Element of ( ( ( dom C53 ) \/ C54 ) * )) by FINSEQ_1:def 11;
L243: [ D62 , D66 ] in ( REL (C53 , C54) ) by L227 , L231 , L242 , L132;
thus L244: thesis by L243 , LANG1:def 1;
end;
thus L245: thesis by L229 , L228 , DTCONSTR:def 3;
end;
end;
definition
let C57 being non  empty (FinSequence of ( NAT ));
let C58 being set;
let C59 being Nat;
assume L247: C59 in ( dom C57 );
func Sym (C59 , C57 , C58) -> (Symbol of ( DTConUA (C57 , C58) )) equals 
:L248: C59;
coherence by L247 , XBOOLE_0:def 3;
end;
begin
definition
let C60 being non  empty (FinSequence of ( NAT ));
let C61 being  disjoint_with_NAT non  empty set;
let C62 being Nat;
assume L250: C62 in ( dom C60 );
func FreeOpNSG (C62 , C60 , C61) ->  homogeneous  quasi_total non  empty (PartFunc of ( ( TS ( DTConUA (C60 , C61) ) ) * ) , ( TS ( DTConUA (C60 , C61) ) )) means 
:L251: (( dom it ) = ( ( C60 /. C62 ) -tuples_on ( TS ( DTConUA (C60 , C61) ) ) ) & (for B36 being (FinSequence of ( TS ( DTConUA (C60 , C61) ) )) holds (B36 in ( dom it ) implies ( it . B36 ) = ( ( Sym (C62 , C60 , C61) ) -tree B36 ))));
existence
proof
set D67 = ( DTConUA (C60 , C61) );
set D68 = ( C60 /. C62 );
set D69 = ( ( dom C60 ) \/ C61 );
set D70 = ( Sym (C62 , C60 , C61) );
defpred S2[ set , set ] means ($1 in ( D68 -tuples_on ( TS D67 ) ) & (for B37 being (FinSequence of ( TS D67 )) holds (B37 = $1 implies $2 = ( D70 -tree B37 ))));
set D71 = { B38 where B38 is (Element of ( ( TS D67 ) * )) : ( len B38 ) = ( C60 /. C62 ) };
L252: D68 = ( C60 . C62 ) by L250 , PARTFUN1:def 6;
L253: (for R1 being set holds (for R2 being set holds ((R1 in ( ( TS D67 ) * ) & S2[ R1 , R2 ]) implies R2 in ( TS D67 ))))
proof
reconsider D72 = ( Sym (C62 , C60 , C61) ) as (Element of D69);
let R1 being set;
let R2 being set;
assume that
L254: R1 in ( ( TS D67 ) * )
and
L255: S2[ R1 , R2 ];
consider C63 being (Element of ( ( TS D67 ) * )) such that L256: C63 = R1 and L257: ( len C63 ) = D68 by L255;
L258: R2 = ( ( Sym (C62 , C60 , C61) ) -tree C63 ) by L255 , L256;
reconsider D73 = C63 as (FinSequence of ( TS D67 ));
L259: (( dom ( roots D73 ) ) = ( dom D73 ) & ( Seg ( len ( roots D73 ) ) ) = ( dom ( roots D73 ) )) by FINSEQ_1:def 3 , TREES_3:def 18;
L260: ( len ( roots D73 ) ) = D68 by L259 , L257 , FINSEQ_1:def 3;
reconsider D74 = D73 as (FinSequence of ( FinTrees (the carrier of D67) ));
reconsider D75 = ( roots D74 ) as (Element of ( D69 * )) by FINSEQ_1:def 11;
L261: D72 = C62 by L250 , L248;
L262: [ D72 , D75 ] in ( REL (C60 , C61) ) by L261 , L250 , L252 , L260 , L132;
L263: ( Sym (C62 , C60 , C61) ) ==> ( roots D74 ) by L262 , LANG1:def 1;
thus L264: thesis by L263 , L258 , DTCONSTR:def 1;
end;
L265: (for B39 , B40 , B41 being set holds ((B39 in ( ( TS D67 ) * ) & S2[ B39 , B40 ] & S2[ B39 , B41 ]) implies B40 = B41))
proof
let C64 , C65 , C66 being set;
assume that
L266: C64 in ( ( TS D67 ) * )
and
L267: S2[ C64 , C65 ]
and
L268: S2[ C64 , C66 ];
consider C67 being (Element of ( ( TS D67 ) * )) such that L269: C67 = C64 and L270: ( len C67 ) = D68 by L267;
L271: C65 = ( ( Sym (C62 , C60 , C61) ) -tree C67 ) by L267 , L269;
thus L272: thesis by L271 , L268 , L269;
end;
consider C68 being (PartFunc of ( ( TS D67 ) * ) , ( TS D67 )) such that L273: (for B42 being set holds (B42 in ( dom C68 ) iff (B42 in ( ( TS D67 ) * ) & (ex R2 being set st S2[ B42 , R2 ])))) and L274: (for B43 being set holds (B43 in ( dom C68 ) implies S2[ B43 , ( C68 . B43 ) ])) from PARTFUN1:sch 2(L253 , L265);
L275: ( dom C68 ) = ( D68 -tuples_on ( TS D67 ) )
proof
thus L276: ( dom C68 ) c= ( D68 -tuples_on ( TS D67 ) )
proof
let R1 being set;
assume L277: R1 in ( dom C68 );
L278: (ex R2 being set st S2[ R1 , R2 ]) by L277 , L273;
thus L279: thesis by L278;
end;

reconsider D76 = D70 as (Symbol of D67);
let R1 being set;
assume L280: R1 in ( D68 -tuples_on ( TS D67 ) );
consider C69 being (Element of ( ( TS D67 ) * )) such that L281: C69 = R1 and L282: ( len C69 ) = D68 by L280;
L283: S2[ C69 , ( D76 -tree C69 ) ] by L282;
thus L284: thesis by L283 , L273 , L281;
end;
L285: (for B44 , B45 being (FinSequence of ( TS D67 )) holds ((( len B44 ) = ( len B45 ) & B44 in ( dom C68 )) implies B45 in ( dom C68 )))
proof
let C70 , C71 being (FinSequence of ( TS D67 ));
assume that
L286: ( len C70 ) = ( len C71 )
and
L287: C70 in ( dom C68 );
reconsider D77 = C71 as (Element of ( ( TS D67 ) * )) by FINSEQ_1:def 11;
L288: (ex B46 being (Element of ( ( TS D67 ) * )) st (B46 = C70 & ( len B46 ) = ( C60 /. C62 ))) by L275 , L287;
L289: D77 in D71 by L288 , L286;
thus L290: thesis by L289 , L275;
end;
L291: (ex B47 being FinSequence st B47 in ( dom C68 ))
proof
set D78 = the (Element of ( D68 -tuples_on ( TS D67 ) ));
L292: D78 in ( dom C68 ) by L275;
thus L293: (ex B48 being FinSequence st B48 in ( dom C68 )) by L292;
end;
L294: ( dom C68 ) is  with_common_domain
proof
let C72 , C73 being FinSequence;
assume L295: (C72 in ( dom C68 ) & C73 in ( dom C68 ));
L296: ((ex B49 being (Element of ( ( TS D67 ) * )) st (B49 = C72 & ( len B49 ) = ( C60 /. C62 ))) & (ex B50 being (Element of ( ( TS D67 ) * )) st (B50 = C73 & ( len B50 ) = ( C60 /. C62 )))) by L295 , L275;
thus L297: thesis by L296;
end;
reconsider D79 = C68 as  homogeneous  quasi_total non  empty (PartFunc of ( ( TS D67 ) * ) , ( TS D67 )) by L294 , L285 , L291 , MARGREL1:def 21 , MARGREL1:def 22;
take D79;
thus L298: ( dom D79 ) = ( D68 -tuples_on ( TS D67 ) ) by L275;
let C74 being (FinSequence of ( TS D67 ));
assume L299: C74 in ( dom D79 );
thus L300: thesis by L299 , L274;
end;
uniqueness
proof
set D80 = ( TS ( DTConUA (C60 , C61) ) );
let C75 , C76 being  homogeneous  quasi_total non  empty (PartFunc of ( D80 * ) , D80);
assume that
L301: ( dom C75 ) = ( ( C60 /. C62 ) -tuples_on D80 )
and
L302: (for B51 being (FinSequence of D80) holds (B51 in ( dom C75 ) implies ( C75 . B51 ) = ( ( Sym (C62 , C60 , C61) ) -tree B51 )))
and
L303: ( dom C76 ) = ( ( C60 /. C62 ) -tuples_on D80 )
and
L304: (for B52 being (FinSequence of D80) holds (B52 in ( dom C76 ) implies ( C76 . B52 ) = ( ( Sym (C62 , C60 , C61) ) -tree B52 )));
L305:
now
let R1 being set;
assume L306: R1 in ( ( C60 /. C62 ) -tuples_on D80 );
consider C77 being (Element of ( D80 * )) such that L307: C77 = R1 and L308: ( len C77 ) = ( C60 /. C62 ) by L306;
L309: ( C75 . C77 ) = ( ( Sym (C62 , C60 , C61) ) -tree C77 ) by L301 , L302 , L306 , L307;
thus L310: ( C75 . R1 ) = ( C76 . R1 ) by L309 , L303 , L304 , L306 , L307;
end;
thus L311: thesis by L305 , L301 , L303 , FUNCT_1:2;
end;
end;
definition
let C78 being non  empty (FinSequence of ( NAT ));
let C79 being  disjoint_with_NAT non  empty set;
func FreeOpSeqNSG (C78 , C79) -> (PFuncFinSequence of ( TS ( DTConUA (C78 , C79) ) )) means 
:L313: (( len it ) = ( len C78 ) & (for R3 being (Element of ( NAT )) holds (R3 in ( dom it ) implies ( it . R3 ) = ( FreeOpNSG (R3 , C78 , C79) ))));
existence
proof
defpred S3[ Nat , set ] means $2 = ( FreeOpNSG ($1 , C78 , C79) );
set D81 = ( TS ( DTConUA (C78 , C79) ) );
L314: (for B53 being Nat holds (B53 in ( Seg ( len C78 ) ) implies (ex B54 being (Element of ( PFuncs (( D81 * ) , D81) )) st S3[ B53 , B54 ])))
proof
let C80 being Nat;
assume L315: C80 in ( Seg ( len C78 ) );
reconsider D82 = ( FreeOpNSG (C80 , C78 , C79) ) as (Element of ( PFuncs (( D81 * ) , D81) )) by PARTFUN1:45;
take D82;
thus L316: thesis;
end;
consider C81 being (FinSequence of ( PFuncs (( D81 * ) , D81) )) such that L317: (( dom C81 ) = ( Seg ( len C78 ) ) & (for B55 being Nat holds (B55 in ( Seg ( len C78 ) ) implies S3[ B55 , ( C81 . B55 ) ]))) from FINSEQ_1:sch 5(L314);
reconsider D83 = C81 as (PFuncFinSequence of D81);
take D83;
thus L318: ( len D83 ) = ( len C78 ) by L317 , FINSEQ_1:def 3;
let R3 being (Element of ( NAT ));
assume L319: R3 in ( dom D83 );
thus L320: thesis by L319 , L317;
end;
uniqueness
proof
let C82 , C83 being (PFuncFinSequence of ( TS ( DTConUA (C78 , C79) ) ));
assume that
L321: ( len C82 ) = ( len C78 )
and
L322: (for R3 being (Element of ( NAT )) holds (R3 in ( dom C82 ) implies ( C82 . R3 ) = ( FreeOpNSG (R3 , C78 , C79) )))
and
L323: ( len C83 ) = ( len C78 )
and
L324: (for R3 being (Element of ( NAT )) holds (R3 in ( dom C83 ) implies ( C83 . R3 ) = ( FreeOpNSG (R3 , C78 , C79) )));
L325: (for B56 being Nat holds (B56 in ( dom C82 ) implies ( C82 . B56 ) = ( C83 . B56 )))
proof
let C84 being Nat;
L326: (( dom C82 ) = ( Seg ( len C82 ) ) & ( dom C83 ) = ( Seg ( len C83 ) )) by FINSEQ_1:def 3;
assume L327: C84 in ( dom C82 );
L328: ( C82 . C84 ) = ( FreeOpNSG (C84 , C78 , C79) ) by L327 , L322;
thus L329: thesis by L328 , L321 , L323 , L324 , L326 , L327;
end;
thus L330: thesis by L325 , L321 , L323 , FINSEQ_2:9;
end;
end;
definition
let C85 being non  empty (FinSequence of ( NAT ));
let C86 being  disjoint_with_NAT non  empty set;
func FreeUnivAlgNSG (C85 , C86) ->  strict Universal_Algebra equals 
UAStr (# ( TS ( DTConUA (C85 , C86) ) ) , ( FreeOpSeqNSG (C85 , C86) ) #);
coherence
proof
set D84 = ( TS ( DTConUA (C85 , C86) ) );
set D85 = UAStr (# D84 , ( FreeOpSeqNSG (C85 , C86) ) #);
L332: (for B57 being Nat holds (for B58 being (PartFunc of ( D84 * ) , D84) holds ((B57 in ( dom (the charact of D85) ) & B58 = ( (the charact of D85) . B57 )) implies B58 is  quasi_total)))
proof
let C87 being Nat;
let C88 being (PartFunc of ( D84 * ) , D84);
assume L333: (C87 in ( dom (the charact of D85) ) & C88 = ( (the charact of D85) . C87 ));
L334: C88 = ( FreeOpNSG (C87 , C85 , C86) ) by L333 , L313;
thus L335: thesis by L334;
end;
L336: (the charact of D85) is  quasi_total by L332 , MARGREL1:def 24;
L337: (for B59 being Nat holds (for B60 being (PartFunc of ( D84 * ) , D84) holds ((B59 in ( dom (the charact of D85) ) & B60 = ( (the charact of D85) . B59 )) implies B60 is  homogeneous)))
proof
let C89 being Nat;
let C90 being (PartFunc of ( D84 * ) , D84);
assume L338: (C89 in ( dom (the charact of D85) ) & C90 = ( (the charact of D85) . C89 ));
L339: C90 = ( FreeOpNSG (C89 , C85 , C86) ) by L338 , L313;
thus L340: thesis by L339;
end;
L341: (the charact of D85) is  homogeneous by L337 , MARGREL1:def 23;
L342: (for B61 being set holds (B61 in ( dom (the charact of D85) ) implies ( (the charact of D85) . B61 ) is non  empty))
proof
let C91 being set;
assume L343: C91 in ( dom (the charact of D85) );
reconsider D86 = C91 as (Element of ( NAT )) by L343;
L344: ( (the charact of D85) . D86 ) = ( FreeOpNSG (D86 , C85 , C86) ) by L343 , L313;
thus L345: thesis by L344;
end;
L346: (the charact of D85) is  non-empty by L342 , FUNCT_1:def 9;
L347: ( len ( FreeOpSeqNSG (C85 , C86) ) ) = ( len C85 ) by L313;
L348: (the charact of D85) <> ( {} ) by L347;
thus L349: thesis by L348 , L336 , L341 , L346 , UNIALG_1:def 1 , UNIALG_1:def 2 , UNIALG_1:def 3;
end;
end;
theorem
L351: (for B62 being non  empty (FinSequence of ( NAT )) holds (for B63 being  disjoint_with_NAT non  empty set holds ( signature ( FreeUnivAlgNSG (B62 , B63) ) ) = B62))
proof
let C92 being non  empty (FinSequence of ( NAT ));
let C93 being  disjoint_with_NAT non  empty set;
set D87 = ( FreeUnivAlgNSG (C92 , C93) );
set D88 = ( TS ( DTConUA (C92 , C93) ) );
L352: ( len (the charact of D87) ) = ( len C92 ) by L313;
L353: ( len ( signature D87 ) ) = ( len (the charact of D87) ) by UNIALG_1:def 4;
L354: ( dom ( signature D87 ) ) = ( Seg ( len C92 ) ) by L353 , L352 , FINSEQ_1:def 3;
L355:
now
let C94 being Nat;
reconsider D89 = ( FreeOpNSG (C94 , C92 , C93) ) as  homogeneous  quasi_total non  empty (PartFunc of ( (the carrier of D87) * ) , (the carrier of D87));
L356: ( dom D89 ) = ( ( arity D89 ) -tuples_on (the carrier of D87) ) by MARGREL1:22;
assume L357: C94 in ( dom ( signature D87 ) );
L358: C94 in ( dom C92 ) by L357 , L354 , FINSEQ_1:def 3;
L359: ( dom D89 ) = ( ( C92 /. C94 ) -tuples_on D88 ) by L358 , L251;
L360: ( arity D89 ) = ( C92 /. C94 ) by L359 , L356 , FINSEQ_2:110;
L361: C94 in ( dom ( FreeOpSeqNSG (C92 , C93) ) ) by L352 , L354 , L357 , FINSEQ_1:def 3;
L362: ( (the charact of D87) . C94 ) = ( FreeOpNSG (C94 , C92 , C93) ) by L361 , L313;
thus L363: ( ( signature D87 ) . C94 ) = ( arity D89 ) by L362 , L357 , UNIALG_1:def 4
.= ( C92 . C94 ) by L358 , L360 , PARTFUN1:def 6;
end;
thus L364: thesis by L355 , L353 , L352 , FINSEQ_2:9;
end;
definition
let C95 being non  empty (FinSequence of ( NAT ));
let C96 being non  empty  disjoint_with_NAT set;
func FreeGenSetNSG (C95 , C96) -> (Subset of ( FreeUnivAlgNSG (C95 , C96) )) equals 
{ ( root-tree B64 ) where B64 is (Symbol of ( DTConUA (C95 , C96) )) : B64 in ( Terminals ( DTConUA (C95 , C96) ) ) };
coherence
proof
set D90 = ( DTConUA (C95 , C96) );
set D91 = { ( root-tree B65 ) where B65 is (Symbol of D90) : B65 in ( Terminals D90 ) };
L365: D91 c= (the carrier of ( FreeUnivAlgNSG (C95 , C96) ))
proof
let R1 being set;
assume L366: R1 in D91;
L367: (ex B66 being (Symbol of D90) st (R1 = ( root-tree B66 ) & B66 in ( Terminals D90 ))) by L366;
thus L368: thesis by L367 , DTCONSTR:def 1;
end;
thus L369: thesis by L365;
end;
end;
theorem
L371: (for B67 being non  empty (FinSequence of ( NAT )) holds (for B68 being non  empty  disjoint_with_NAT set holds ( FreeGenSetNSG (B67 , B68) ) is non  empty))
proof
let C97 being non  empty (FinSequence of ( NAT ));
let C98 being  disjoint_with_NAT non  empty set;
set D92 = ( DTConUA (C97 , C98) );
set D93 = the (Element of C98);
reconsider D94 = D93 as (Symbol of D92) by XBOOLE_0:def 3;
L372: ( Terminals D92 ) = C98 by L188;
L373: ( root-tree D94 ) in { ( root-tree B69 ) where B69 is (Symbol of D92) : B69 in ( Terminals D92 ) } by L372;
thus L374: thesis by L373;
end;
definition
let C99 being non  empty (FinSequence of ( NAT ));
let C100 being non  empty  disjoint_with_NAT set;
redefine func FreeGenSetNSG (C99 , C100) -> (GeneratorSet of ( FreeUnivAlgNSG (C99 , C100) ));

coherence
proof
set D95 = ( FreeGenSetNSG (C99 , C100) );
set D96 = ( FreeUnivAlgNSG (C99 , C100) );
L375: (the carrier of ( GenUnivAlg D95 )) = (the carrier of D96)
proof
set D97 = ( DTConUA (C99 , C100) );
defpred S4[ (DecoratedTree of (the carrier of D97)) ] means $1 in (the carrier of ( GenUnivAlg D95 ));
L376: (the carrier of ( GenUnivAlg D95 )) is (Subset of D96) by UNIALG_2:def 7;
thus L377: (the carrier of ( GenUnivAlg D95 )) c= (the carrier of D96) by L376;
L378: (for B70 being (Symbol of D97) holds (for B71 being (FinSequence of ( TS D97 )) holds ((B70 ==> ( roots B71 ) & (for B72 being (DecoratedTree of (the carrier of D97)) holds (B72 in ( rng B71 ) implies S4[ B72 ]))) implies S4[ ( B70 -tree B71 ) ])))
proof
reconsider D98 = (the carrier of ( GenUnivAlg D95 )) as (Subset of D96) by UNIALG_2:def 7;
let C101 being (Symbol of D97);
let C102 being (FinSequence of ( TS D97 ));
assume that
L379: C101 ==> ( roots C102 )
and
L380: (for B73 being (DecoratedTree of (the carrier of D97)) holds (B73 in ( rng C102 ) implies B73 in (the carrier of ( GenUnivAlg D95 ))));
L381: ( rng C102 ) c= (the carrier of ( GenUnivAlg D95 ))
proof
let R1 being set;
assume L382: R1 in ( rng C102 );
L383: ( rng C102 ) c= ( FinTrees (the carrier of D97) ) by FINSEQ_1:def 4;
reconsider D99 = R1 as (Element of ( FinTrees (the carrier of D97) )) by L383 , L382;
L384: D99 in (the carrier of ( GenUnivAlg D95 )) by L380 , L382;
thus L385: thesis by L384;
end;
reconsider D100 = C102 as (FinSequence of (the carrier of ( GenUnivAlg D95 ))) by L381 , FINSEQ_1:def 4;
reconsider D101 = C102 as (Element of ( ( TS D97 ) * )) by FINSEQ_1:def 11;
L386: [ C101 , ( roots C102 ) ] in (the Rules of D97) by L379 , LANG1:def 1;
reconsider D102 = ( roots C102 ) as (Element of ( ( ( dom C99 ) \/ C100 ) * )) by L386 , ZFMISC_1:87;
reconsider D103 = C101 as (Element of ( ( dom C99 ) \/ C100 ));
L387: [ D103 , D102 ] in ( REL (C99 , C100) ) by L379 , LANG1:def 1;
L388: D103 in ( dom C99 ) by L387 , L132;
reconsider D104 = C101 as (Element of ( NAT )) by L388;
L389: ( C99 . D103 ) = ( len D102 ) by L387 , L132;
L390: ( len ( FreeOpSeqNSG (C99 , C100) ) ) = ( len C99 ) by L313;
L391: ( dom ( FreeOpSeqNSG (C99 , C100) ) ) = ( Seg ( len C99 ) ) by L390 , FINSEQ_1:def 3
.= ( dom C99 ) by FINSEQ_1:def 3;
L392: ( ( FreeOpSeqNSG (C99 , C100) ) . D104 ) in ( rng ( FreeOpSeqNSG (C99 , C100) ) ) by L391 , L388 , FUNCT_1:def 3;
reconsider D105 = ( FreeOpNSG (D104 , C99 , C100) ) as (operation of D96) by L392 , L388 , L391 , L313;
L393: D98 is  opers_closed by UNIALG_2:def 7;
L394: D98 is_closed_on D105 by L393 , UNIALG_2:def 4;
L395: ( dom ( FreeOpNSG (D104 , C99 , C100) ) ) = ( ( C99 /. D104 ) -tuples_on ( TS D97 ) ) by L388 , L251;
L396: ( dom D105 ) = ( ( arity D105 ) -tuples_on (the carrier of D96) ) by MARGREL1:22;
L397: ( arity D105 ) = ( C99 /. D104 ) by L396 , L395 , FINSEQ_2:110;
L398: ( dom ( roots C102 ) ) = ( dom C102 ) by TREES_3:def 18
.= ( Seg ( len C102 ) ) by FINSEQ_1:def 3;
L399: ( len C102 ) = ( len D102 ) by L398 , FINSEQ_1:def 3
.= ( C99 /. D104 ) by L388 , L389 , PARTFUN1:def 6;
L400: D101 in { B74 where B74 is (Element of ( ( TS D97 ) * )) : ( len B74 ) = ( C99 /. D104 ) } by L399;
L401: ( D105 . D100 ) = ( ( Sym (D104 , C99 , C100) ) -tree C102 ) by L400 , L388 , L395 , L251
.= ( C101 -tree C102 ) by L388 , L248;
thus L402: thesis by L401 , L394 , L399 , L397 , UNIALG_2:def 3;
end;
let R1 being set;
assume L403: R1 in (the carrier of D96);
reconsider D106 = R1 as (Element of ( FinTrees (the carrier of D97) )) by L403;
L404: D106 in ( TS D97 ) by L403;
L405: (for B75 being (Symbol of D97) holds (B75 in ( Terminals D97 ) implies S4[ ( root-tree B75 ) ]))
proof
let C103 being (Symbol of D97);
assume L406: C103 in ( Terminals D97 );
L407: ( root-tree C103 ) in { ( root-tree B76 ) where B76 is (Symbol of D97) : B76 in ( Terminals D97 ) } by L406;
L408: D95 <> ( {} ) by L371;
L409: D95 c= (the carrier of ( GenUnivAlg D95 )) by L408 , UNIALG_2:def 12;
thus L410: thesis by L409 , L407;
end;
L411: (for B77 being (DecoratedTree of (the carrier of D97)) holds (B77 in ( TS D97 ) implies S4[ B77 ])) from DTCONSTR:sch 7(L405 , L378);
thus L412: thesis by L411 , L404;
end;
L413: D95 <> ( {} ) by L371;
thus L414: thesis by L413 , L375 , L45;
end;
end;
definition
let C104 being non  empty (FinSequence of ( NAT ));
let C105 being non  empty  disjoint_with_NAT set;
let C106 being non  empty set;
let C107 being (Symbol of ( DTConUA (C104 , C105) ));
let C108 being (Function of ( FreeGenSetNSG (C104 , C105) ) , C106);
assume L416: C107 in ( Terminals ( DTConUA (C104 , C105) ) );
func pi (C108 , C107) -> (Element of C106) equals 
:L417: ( C108 . ( root-tree C107 ) );
coherence
proof
L418: (( root-tree C107 ) in ( FreeGenSetNSG (C104 , C105) ) & ( dom C108 ) = ( FreeGenSetNSG (C104 , C105) )) by L416 , FUNCT_2:def 1;
L419: (( rng C108 ) c= C106 & ( C108 . ( root-tree C107 ) ) in ( rng C108 )) by L418 , FUNCT_1:def 3 , RELAT_1:def 19;
thus L420: thesis by L419;
end;
end;
definition
let C109 being non  empty (FinSequence of ( NAT ));
let C110 being set;
let C111 being (Symbol of ( DTConUA (C109 , C110) ));
given C112 being FinSequence such that
L422: C111 ==> C112;

func @ C111 -> (Element of ( NAT )) equals 
:L423: C111;
coherence
proof
reconsider D107 = C111 as (Element of ( ( dom C109 ) \/ C110 ));
set D108 = ( DTConUA (C109 , C110) );
L424: [ C111 , C112 ] in (the Rules of D108) by L422 , LANG1:def 1;
reconsider D109 = C112 as (Element of ( ( ( dom C109 ) \/ C110 ) * )) by L424 , ZFMISC_1:87;
L425: [ D107 , D109 ] in ( REL (C109 , C110) ) by L422 , LANG1:def 1;
L426: D107 in ( dom C109 ) by L425 , L132;
thus L427: thesis by L426;
end;
end;
theorem
L429: (for B78 being non  empty (FinSequence of ( NAT )) holds (for B79 being non  empty  disjoint_with_NAT set holds ( FreeGenSetNSG (B78 , B79) ) is  free))
proof
let C113 being non  empty (FinSequence of ( NAT ));
let C114 being non  empty  disjoint_with_NAT set;
set D110 = ( FreeGenSetNSG (C113 , C114) );
set D111 = ( FreeUnivAlgNSG (C113 , C114) );
let C115 being Universal_Algebra;
assume L430: D111 , C115 are_similar ;
set D112 = ( DTConUA (C113 , C114) );
set D113 = (the carrier of C115);
set D114 = (the carrier of D111);
let C116 being (Function of D110 , (the carrier of C115));
deffunc H1((Symbol of D112)) = ( pi (C116 , $1) );
deffunc H2((Symbol of D112) , FinSequence , set) = ( ( oper (( @ $1 ) , C115) ) /. $3 );
consider C117 being (Function of ( TS D112 ) , D113) such that L431: (for B80 being (Symbol of D112) holds (B80 in ( Terminals D112 ) implies ( C117 . ( root-tree B80 ) ) = H1(B80))) and L432: (for B81 being (Symbol of D112) holds (for B82 being (FinSequence of ( TS D112 )) holds (B81 ==> ( roots B82 ) implies ( C117 . ( B81 -tree B82 ) ) = H2(B81 , ( roots B82 ) , ( C117 * B82 ))))) from DTCONSTR:sch 8;
reconsider D115 = C117 as (Function of D111 , C115);
take D115;
L433: (for B83 being (Element of ( NAT )) holds (B83 in ( dom (the charact of D111) ) implies (for B84 being (operation of D111) holds (for B85 being (operation of C115) holds ((B84 = ( (the charact of D111) . B83 ) & B85 = ( (the charact of C115) . B83 )) implies (for B86 being (FinSequence of D111) holds (B86 in ( dom B84 ) implies ( D115 . ( B84 . B86 ) ) = ( B85 . ( D115 * B86 ) ))))))))
proof
L434: ( Seg ( len (the charact of C115) ) ) = ( dom (the charact of C115) ) by FINSEQ_1:def 3;
let C118 being (Element of ( NAT ));
assume L435: C118 in ( dom (the charact of D111) );
let C119 being (operation of D111);
let C120 being (operation of C115);
assume that
L436: C119 = ( (the charact of D111) . C118 )
and
L437: C120 = ( (the charact of C115) . C118 );
let C121 being (FinSequence of D111);
assume L438: C121 in ( dom C119 );
reconsider D116 = C121 as (FinSequence of ( TS D112 ));
L439: ( dom ( roots D116 ) ) = ( dom D116 ) by TREES_3:def 18
.= ( Seg ( len D116 ) ) by FINSEQ_1:def 3;
L440: ( len ( roots D116 ) ) = ( len D116 ) by L439 , FINSEQ_1:def 3;
reconsider D117 = D116 as (FinSequence of ( FinTrees (the carrier of D112) ));
reconsider D118 = ( roots D117 ) as (FinSequence of ( ( dom C113 ) \/ C114 ));
reconsider D119 = D118 as (Element of ( ( ( dom C113 ) \/ C114 ) * )) by FINSEQ_1:def 11;
L441: ( dom C119 ) = ( ( arity C119 ) -tuples_on D114 ) by MARGREL1:22
.= { B87 where B87 is (Element of ( D114 * )) : ( len B87 ) = ( arity C119 ) };
L442: (ex B88 being (Element of ( D114 * )) st (C121 = B88 & ( len B88 ) = ( arity C119 ))) by L441 , L438;
L443: C119 = ( FreeOpNSG (C118 , C113 , C114) ) by L435 , L436 , L313;
reconsider D120 = ( D115 * C121 ) as (Element of ( D113 * ));
L444: ( dom C120 ) = ( ( arity C120 ) -tuples_on D113 ) by MARGREL1:22
.= { B89 where B89 is (Element of ( D113 * )) : ( len B89 ) = ( arity C120 ) };
L445: (( len (the charact of D111) ) = ( len (the charact of C115) ) & ( Seg ( len (the charact of D111) ) ) = ( dom (the charact of D111) )) by L430 , FINSEQ_1:def 3 , UNIALG_2:1;
L446: ( dom ( FreeOpSeqNSG (C113 , C114) ) ) = ( Seg ( len ( FreeOpSeqNSG (C113 , C114) ) ) ) by FINSEQ_1:def 3;
L447: (( len ( FreeOpSeqNSG (C113 , C114) ) ) = ( len C113 ) & ( Seg ( len C113 ) ) = ( dom C113 )) by L313 , FINSEQ_1:def 3;
reconsider D121 = C118 as (Symbol of D112) by L447 , L435 , L446 , XBOOLE_0:def 3;
reconsider D122 = C118 as (Element of ( ( dom C113 ) \/ C114 )) by L435 , L447 , L446 , XBOOLE_0:def 3;
L448: C113 = ( signature D111 ) by L351;
L449: ( ( signature D111 ) . C118 ) = ( arity C119 ) by L448 , L435 , L436 , L447 , L446 , UNIALG_1:def 4;
L450: [ D122 , D119 ] in ( REL (C113 , C114) ) by L449 , L435 , L447 , L446 , L448 , L442 , L440 , L132;
L451: D121 ==> ( roots D117 ) by L450 , LANG1:def 1;
L452: ( D115 . ( D121 -tree D117 ) ) = ( ( oper (( @ D121 ) , C115) ) /. ( D115 * C121 ) ) by L451 , L432;
L453: ( @ D121 ) = C118 by L451 , L423;
L454: ( oper (( @ D121 ) , C115) ) = C120 by L453 , L435 , L437 , L445 , L434 , L24;
L455: ( signature D111 ) = ( signature C115 ) by L430 , UNIALG_2:def 1;
L456: (( len ( D115 * C121 ) ) = ( len C121 ) & ( arity C120 ) = ( len C121 )) by L455 , L435 , L437 , L447 , L446 , L448 , L442 , L449 , FINSEQ_3:120 , UNIALG_1:def 4;
L457: D120 in { B90 where B90 is (Element of ( D113 * )) : ( len B90 ) = ( arity C120 ) } by L456;
reconsider D123 = D117 as (Element of ( ( TS D112 ) * )) by FINSEQ_1:def 11;
L458: ( Sym (C118 , C113 , C114) ) = D121 by L435 , L447 , L446 , L248;
L459: ( C119 . C121 ) = ( D121 -tree D123 ) by L458 , L435 , L438 , L447 , L446 , L443 , L251;
thus L460: thesis by L459 , L452 , L454 , L444 , L457 , PARTFUN1:def 6;
end;
thus L461: D115 is_homomorphism D111 , C115 by L433 , L430 , ALG_1:def 1;
L462: ( (the carrier of D111) /\ D110 ) = D110 by XBOOLE_1:28;
L463: (( dom ( D115 | D110 ) ) = ( ( dom D115 ) /\ D110 ) & ( dom D115 ) = (the carrier of D111)) by FUNCT_2:def 1 , RELAT_1:61;
L464:
now
let R1 being set;
assume L465: R1 in ( dom C116 );
L466: R1 in { ( root-tree B91 ) where B91 is (Symbol of D112) : B91 in ( Terminals D112 ) } by L465;
consider C122 being (Symbol of D112) such that L467: (R1 = ( root-tree C122 ) & C122 in ( Terminals D112 )) by L466;
thus L468: ( ( D115 | D110 ) . R1 ) = ( D115 . R1 ) by L463 , L462 , L465 , FUNCT_1:47
.= ( pi (C116 , C122) ) by L431 , L467
.= ( C116 . R1 ) by L467 , L417;
end;
L469: D110 = ( dom C116 ) by FUNCT_2:def 1;
thus L470: thesis by L469 , L463 , L462 , L464 , FUNCT_1:2;
end;
registration
let C123 being non  empty (FinSequence of ( NAT ));
let C124 being non  empty  disjoint_with_NAT set;
cluster ( FreeUnivAlgNSG (C123 , C124) ) ->  free;
coherence
proof
L471: ( FreeGenSetNSG (C123 , C124) ) is  free by L429;
thus L472: thesis by L471 , L61;
end;
end;
definition
let C125 being non  empty (FinSequence of ( NAT ));
let C126 being non  empty  disjoint_with_NAT set;
redefine func FreeGenSetNSG (C125 , C126) ->  free (GeneratorSet of ( FreeUnivAlgNSG (C125 , C126) ));

coherence by L429;
end;
begin
definition
let C127 being  with_zero non  empty (FinSequence of ( NAT ));
let C128 being  disjoint_with_NAT set;
let C129 being Nat;
assume L475: C129 in ( dom C127 );
func FreeOpZAO (C129 , C127 , C128) ->  homogeneous  quasi_total non  empty (PartFunc of ( ( TS ( DTConUA (C127 , C128) ) ) * ) , ( TS ( DTConUA (C127 , C128) ) )) means 
:L476: (( dom it ) = ( ( C127 /. C129 ) -tuples_on ( TS ( DTConUA (C127 , C128) ) ) ) & (for B92 being (FinSequence of ( TS ( DTConUA (C127 , C128) ) )) holds (B92 in ( dom it ) implies ( it . B92 ) = ( ( Sym (C129 , C127 , C128) ) -tree B92 ))));
existence
proof
set D124 = ( DTConUA (C127 , C128) );
set D125 = ( C127 /. C129 );
set D126 = ( ( dom C127 ) \/ C128 );
set D127 = ( Sym (C129 , C127 , C128) );
defpred S5[ set , set ] means ($1 in ( D125 -tuples_on ( TS D124 ) ) & (for B93 being (FinSequence of ( TS D124 )) holds (B93 = $1 implies $2 = ( D127 -tree B93 ))));
set D128 = { B94 where B94 is (Element of ( ( TS D124 ) * )) : ( len B94 ) = ( C127 /. C129 ) };
L477: D125 = ( C127 . C129 ) by L475 , PARTFUN1:def 6;
L478: (for R1 being set holds (for R2 being set holds ((R1 in ( ( TS D124 ) * ) & S5[ R1 , R2 ]) implies R2 in ( TS D124 ))))
proof
reconsider D129 = ( Sym (C129 , C127 , C128) ) as (Element of D126);
let R1 being set;
let R2 being set;
assume that
L479: R1 in ( ( TS D124 ) * )
and
L480: S5[ R1 , R2 ];
consider C130 being (Element of ( ( TS D124 ) * )) such that L481: C130 = R1 and L482: ( len C130 ) = D125 by L480;
L483: R2 = ( ( Sym (C129 , C127 , C128) ) -tree C130 ) by L480 , L481;
reconsider D130 = C130 as (FinSequence of ( TS D124 ));
L484: (( dom ( roots D130 ) ) = ( dom D130 ) & ( Seg ( len ( roots D130 ) ) ) = ( dom ( roots D130 ) )) by FINSEQ_1:def 3 , TREES_3:def 18;
L485: ( len ( roots D130 ) ) = D125 by L484 , L482 , FINSEQ_1:def 3;
reconsider D131 = D130 as (FinSequence of ( FinTrees (the carrier of D124) ));
reconsider D132 = ( roots D131 ) as (Element of ( D126 * )) by FINSEQ_1:def 11;
L486: D129 = C129 by L475 , L248;
L487: [ D129 , D132 ] in ( REL (C127 , C128) ) by L486 , L475 , L477 , L485 , L132;
L488: ( Sym (C129 , C127 , C128) ) ==> ( roots D131 ) by L487 , LANG1:def 1;
thus L489: thesis by L488 , L483 , DTCONSTR:def 1;
end;
L490: (for B95 , B96 , B97 being set holds ((B95 in ( ( TS D124 ) * ) & S5[ B95 , B96 ] & S5[ B95 , B97 ]) implies B96 = B97))
proof
let C131 , C132 , C133 being set;
assume that
L491: C131 in ( ( TS D124 ) * )
and
L492: S5[ C131 , C132 ]
and
L493: S5[ C131 , C133 ];
consider C134 being (Element of ( ( TS D124 ) * )) such that L494: C134 = C131 and L495: ( len C134 ) = D125 by L492;
L496: C132 = ( ( Sym (C129 , C127 , C128) ) -tree C134 ) by L492 , L494;
thus L497: thesis by L496 , L493 , L494;
end;
consider C135 being (PartFunc of ( ( TS D124 ) * ) , ( TS D124 )) such that L498: (for B98 being set holds (B98 in ( dom C135 ) iff (B98 in ( ( TS D124 ) * ) & (ex R2 being set st S5[ B98 , R2 ])))) and L499: (for B99 being set holds (B99 in ( dom C135 ) implies S5[ B99 , ( C135 . B99 ) ])) from PARTFUN1:sch 2(L478 , L490);
L500: ( dom C135 ) = ( D125 -tuples_on ( TS D124 ) )
proof
thus L501: ( dom C135 ) c= ( D125 -tuples_on ( TS D124 ) )
proof
let R1 being set;
assume L502: R1 in ( dom C135 );
L503: (ex R2 being set st S5[ R1 , R2 ]) by L502 , L498;
thus L504: thesis by L503;
end;

reconsider D133 = D127 as (Symbol of D124);
let R1 being set;
assume L505: R1 in ( D125 -tuples_on ( TS D124 ) );
consider C136 being (Element of ( ( TS D124 ) * )) such that L506: C136 = R1 and L507: ( len C136 ) = D125 by L505;
L508: S5[ C136 , ( D133 -tree C136 ) ] by L507;
thus L509: thesis by L508 , L498 , L506;
end;
L510: (for B100 , B101 being (FinSequence of ( TS D124 )) holds ((( len B100 ) = ( len B101 ) & B100 in ( dom C135 )) implies B101 in ( dom C135 )))
proof
let C137 , C138 being (FinSequence of ( TS D124 ));
assume that
L511: ( len C137 ) = ( len C138 )
and
L512: C137 in ( dom C135 );
reconsider D134 = C138 as (Element of ( ( TS D124 ) * )) by FINSEQ_1:def 11;
L513: (ex B102 being (Element of ( ( TS D124 ) * )) st (B102 = C137 & ( len B102 ) = ( C127 /. C129 ))) by L500 , L512;
L514: D134 in D128 by L513 , L511;
thus L515: thesis by L514 , L500;
end;
L516: (ex B103 being FinSequence st B103 in ( dom C135 ))
proof
set D135 = the (Element of ( D125 -tuples_on ( TS D124 ) ));
L517: D135 in ( dom C135 ) by L500;
thus L518: (ex B104 being FinSequence st B104 in ( dom C135 )) by L517;
end;
L519: ( dom C135 ) is  with_common_domain
proof
let C139 , C140 being FinSequence;
assume L520: (C139 in ( dom C135 ) & C140 in ( dom C135 ));
L521: ((ex B105 being (Element of ( ( TS D124 ) * )) st (B105 = C139 & ( len B105 ) = ( C127 /. C129 ))) & (ex B106 being (Element of ( ( TS D124 ) * )) st (B106 = C140 & ( len B106 ) = ( C127 /. C129 )))) by L520 , L500;
thus L522: thesis by L521;
end;
reconsider D136 = C135 as  homogeneous  quasi_total non  empty (PartFunc of ( ( TS D124 ) * ) , ( TS D124 )) by L519 , L510 , L516 , MARGREL1:def 21 , MARGREL1:def 22;
take D136;
thus L523: ( dom D136 ) = ( D125 -tuples_on ( TS D124 ) ) by L500;
let C141 being (FinSequence of ( TS D124 ));
assume L524: C141 in ( dom D136 );
thus L525: thesis by L524 , L499;
end;
uniqueness
proof
set D137 = ( TS ( DTConUA (C127 , C128) ) );
let C142 , C143 being  homogeneous  quasi_total non  empty (PartFunc of ( D137 * ) , D137);
assume that
L526: ( dom C142 ) = ( ( C127 /. C129 ) -tuples_on D137 )
and
L527: (for B107 being (FinSequence of D137) holds (B107 in ( dom C142 ) implies ( C142 . B107 ) = ( ( Sym (C129 , C127 , C128) ) -tree B107 )))
and
L528: ( dom C143 ) = ( ( C127 /. C129 ) -tuples_on D137 )
and
L529: (for B108 being (FinSequence of D137) holds (B108 in ( dom C143 ) implies ( C143 . B108 ) = ( ( Sym (C129 , C127 , C128) ) -tree B108 )));
L530:
now
let R1 being set;
assume L531: R1 in ( ( C127 /. C129 ) -tuples_on D137 );
consider C144 being (Element of ( D137 * )) such that L532: C144 = R1 and L533: ( len C144 ) = ( C127 /. C129 ) by L531;
L534: ( C142 . C144 ) = ( ( Sym (C129 , C127 , C128) ) -tree C144 ) by L526 , L527 , L531 , L532;
thus L535: ( C142 . R1 ) = ( C143 . R1 ) by L534 , L528 , L529 , L531 , L532;
end;
thus L536: thesis by L530 , L526 , L528 , FUNCT_1:2;
end;
end;
definition
let C145 being  with_zero non  empty (FinSequence of ( NAT ));
let C146 being  disjoint_with_NAT set;
func FreeOpSeqZAO (C145 , C146) -> (PFuncFinSequence of ( TS ( DTConUA (C145 , C146) ) )) means 
:L538: (( len it ) = ( len C145 ) & (for R3 being (Element of ( NAT )) holds (R3 in ( dom it ) implies ( it . R3 ) = ( FreeOpZAO (R3 , C145 , C146) ))));
existence
proof
defpred S6[ Nat , set ] means $2 = ( FreeOpZAO ($1 , C145 , C146) );
set D138 = ( TS ( DTConUA (C145 , C146) ) );
L539: (for B109 being Nat holds (B109 in ( Seg ( len C145 ) ) implies (ex B110 being (Element of ( PFuncs (( D138 * ) , D138) )) st S6[ B109 , B110 ])))
proof
let C147 being Nat;
assume L540: C147 in ( Seg ( len C145 ) );
reconsider D139 = ( FreeOpZAO (C147 , C145 , C146) ) as (Element of ( PFuncs (( D138 * ) , D138) )) by PARTFUN1:45;
take D139;
thus L541: thesis;
end;
consider C148 being (FinSequence of ( PFuncs (( D138 * ) , D138) )) such that L542: (( dom C148 ) = ( Seg ( len C145 ) ) & (for B111 being Nat holds (B111 in ( Seg ( len C145 ) ) implies S6[ B111 , ( C148 . B111 ) ]))) from FINSEQ_1:sch 5(L539);
reconsider D140 = C148 as (PFuncFinSequence of D138);
take D140;
thus L543: ( len D140 ) = ( len C145 ) by L542 , FINSEQ_1:def 3;
let R3 being (Element of ( NAT ));
assume L544: R3 in ( dom D140 );
thus L545: thesis by L544 , L542;
end;
uniqueness
proof
let C149 , C150 being (PFuncFinSequence of ( TS ( DTConUA (C145 , C146) ) ));
assume that
L546: ( len C149 ) = ( len C145 )
and
L547: (for R3 being (Element of ( NAT )) holds (R3 in ( dom C149 ) implies ( C149 . R3 ) = ( FreeOpZAO (R3 , C145 , C146) )))
and
L548: ( len C150 ) = ( len C145 )
and
L549: (for R3 being (Element of ( NAT )) holds (R3 in ( dom C150 ) implies ( C150 . R3 ) = ( FreeOpZAO (R3 , C145 , C146) )));
L550: ( dom C149 ) = ( Seg ( len C149 ) ) by FINSEQ_1:def 3;
L551: ( dom C145 ) = ( Seg ( len C145 ) ) by FINSEQ_1:def 3;
L552: ( dom C150 ) = ( Seg ( len C150 ) ) by FINSEQ_1:def 3;
L553: (for B112 being Nat holds (B112 in ( dom C145 ) implies ( C149 . B112 ) = ( C150 . B112 )))
proof
let C151 being Nat;
assume L554: C151 in ( dom C145 );
L555: ( C149 . C151 ) = ( FreeOpZAO (C151 , C145 , C146) ) by L554 , L546 , L547 , L551 , L550;
thus L556: thesis by L555 , L548 , L549 , L551 , L552 , L554;
end;
thus L557: thesis by L553 , L546 , L548 , L551 , L550 , FINSEQ_2:9;
end;
end;
definition
let C152 being  with_zero non  empty (FinSequence of ( NAT ));
let C153 being  disjoint_with_NAT set;
func FreeUnivAlgZAO (C152 , C153) ->  strict Universal_Algebra equals 
UAStr (# ( TS ( DTConUA (C152 , C153) ) ) , ( FreeOpSeqZAO (C152 , C153) ) #);
coherence
proof
set D141 = ( TS ( DTConUA (C152 , C153) ) );
set D142 = UAStr (# D141 , ( FreeOpSeqZAO (C152 , C153) ) #);
L559: (for B113 being Nat holds (for B114 being (PartFunc of ( D141 * ) , D141) holds ((B113 in ( dom (the charact of D142) ) & B114 = ( (the charact of D142) . B113 )) implies B114 is  quasi_total)))
proof
let C154 being Nat;
let C155 being (PartFunc of ( D141 * ) , D141);
assume L560: (C154 in ( dom (the charact of D142) ) & C155 = ( (the charact of D142) . C154 ));
L561: C155 = ( FreeOpZAO (C154 , C152 , C153) ) by L560 , L538;
thus L562: thesis by L561;
end;
L563: (the charact of D142) is  quasi_total by L559 , MARGREL1:def 24;
L564: (for B115 being Nat holds (for B116 being (PartFunc of ( D141 * ) , D141) holds ((B115 in ( dom (the charact of D142) ) & B116 = ( (the charact of D142) . B115 )) implies B116 is  homogeneous)))
proof
let C156 being Nat;
let C157 being (PartFunc of ( D141 * ) , D141);
assume L565: (C156 in ( dom (the charact of D142) ) & C157 = ( (the charact of D142) . C156 ));
L566: C157 = ( FreeOpZAO (C156 , C152 , C153) ) by L565 , L538;
thus L567: thesis by L566;
end;
L568: (the charact of D142) is  homogeneous by L564 , MARGREL1:def 23;
L569: (for B117 being set holds (B117 in ( dom (the charact of D142) ) implies ( (the charact of D142) . B117 ) is non  empty))
proof
let C158 being set;
assume L570: C158 in ( dom (the charact of D142) );
reconsider D143 = C158 as (Element of ( NAT )) by L570;
L571: ( (the charact of D142) . D143 ) = ( FreeOpZAO (D143 , C152 , C153) ) by L570 , L538;
thus L572: thesis by L571;
end;
L573: (the charact of D142) is  non-empty by L569 , FUNCT_1:def 9;
L574: ( len ( FreeOpSeqZAO (C152 , C153) ) ) = ( len C152 ) by L538;
L575: (the charact of D142) <> ( {} ) by L574;
thus L576: thesis by L575 , L563 , L568 , L573 , UNIALG_1:def 1 , UNIALG_1:def 2 , UNIALG_1:def 3;
end;
end;
theorem
L578: (for B118 being  with_zero non  empty (FinSequence of ( NAT )) holds (for B119 being  disjoint_with_NAT set holds ( signature ( FreeUnivAlgZAO (B118 , B119) ) ) = B118))
proof
let C159 being  with_zero non  empty (FinSequence of ( NAT ));
let C160 being  disjoint_with_NAT set;
set D144 = ( FreeUnivAlgZAO (C159 , C160) );
set D145 = ( TS ( DTConUA (C159 , C160) ) );
L579: ( len (the charact of D144) ) = ( len C159 ) by L538;
L580: ( len ( signature D144 ) ) = ( len (the charact of D144) ) by UNIALG_1:def 4;
L581: ( dom ( signature D144 ) ) = ( Seg ( len C159 ) ) by L580 , L579 , FINSEQ_1:def 3;
L582:
now
let C161 being Nat;
reconsider D146 = ( FreeOpZAO (C161 , C159 , C160) ) as  homogeneous  quasi_total non  empty (PartFunc of ( (the carrier of D144) * ) , (the carrier of D144));
L583: ( dom D146 ) = ( ( arity D146 ) -tuples_on (the carrier of D144) ) by MARGREL1:22;
assume L584: C161 in ( dom ( signature D144 ) );
L585: C161 in ( dom C159 ) by L584 , L581 , FINSEQ_1:def 3;
L586: ( dom D146 ) = ( ( C159 /. C161 ) -tuples_on D145 ) by L585 , L476;
L587: ( arity D146 ) = ( C159 /. C161 ) by L586 , L583 , FINSEQ_2:110;
L588: C161 in ( dom ( FreeOpSeqZAO (C159 , C160) ) ) by L579 , L581 , L584 , FINSEQ_1:def 3;
L589: ( (the charact of D144) . C161 ) = ( FreeOpZAO (C161 , C159 , C160) ) by L588 , L538;
thus L590: ( ( signature D144 ) . C161 ) = ( arity D146 ) by L589 , L584 , UNIALG_1:def 4
.= ( C159 . C161 ) by L585 , L587 , PARTFUN1:def 6;
end;
thus L591: thesis by L582 , L580 , L579 , FINSEQ_2:9;
end;
theorem
L592: (for B120 being  with_zero non  empty (FinSequence of ( NAT )) holds (for B121 being  disjoint_with_NAT set holds ( FreeUnivAlgZAO (B120 , B121) ) is  with_const_op))
proof
let C162 being  with_zero non  empty (FinSequence of ( NAT ));
let C163 being  disjoint_with_NAT set;
set D147 = ( DTConUA (C162 , C163) );
set D148 = ( FreeUnivAlgZAO (C162 , C163) );
L593: ( dom C162 ) = ( Seg ( len C162 ) ) by FINSEQ_1:def 3;
L594: ( 0 ) in ( rng C162 ) by L16;
consider C164 being Nat such that L595: C164 in ( dom C162 ) and L596: ( C162 . C164 ) = ( 0 ) by L594 , FINSEQ_2:10;
L597: (( len ( FreeOpSeqZAO (C162 , C163) ) ) = ( len C162 ) & ( dom ( FreeOpSeqZAO (C162 , C163) ) ) = ( Seg ( len ( FreeOpSeqZAO (C162 , C163) ) ) )) by L538 , FINSEQ_1:def 3;
L598: ( (the charact of D148) . C164 ) = ( FreeOpZAO (C164 , C162 , C163) ) by L597 , L595 , L593 , L538;
reconsider D149 = ( FreeOpZAO (C164 , C162 , C163) ) as (operation of D148) by L598 , L595 , L597 , L593 , FUNCT_1:def 3;
take D149;
L599: ( dom D149 ) = ( ( arity D149 ) -tuples_on (the carrier of D148) ) by MARGREL1:22;
L600: (( C162 /. C164 ) = ( C162 . C164 ) & ( dom ( FreeOpZAO (C164 , C162 , C163) ) ) = ( ( C162 /. C164 ) -tuples_on ( TS D147 ) )) by L595 , L476 , PARTFUN1:def 6;
thus L601: thesis by L600 , L596 , L599 , FINSEQ_2:110;
end;
theorem
L602: (for B122 being  with_zero non  empty (FinSequence of ( NAT )) holds (for B123 being  disjoint_with_NAT set holds ( Constants ( FreeUnivAlgZAO (B122 , B123) ) ) <> ( {} )))
proof
let C165 being  with_zero non  empty (FinSequence of ( NAT ));
let C166 being  disjoint_with_NAT set;
set D150 = ( DTConUA (C165 , C166) );
set D151 = ( FreeUnivAlgZAO (C165 , C166) );
L603: ( dom C165 ) = ( Seg ( len C165 ) ) by FINSEQ_1:def 3;
set D152 = (the carrier of D151);
L604: ( 0 ) in ( rng C165 ) by L16;
consider C167 being Nat such that L605: C167 in ( dom C165 ) and L606: ( C165 . C167 ) = ( 0 ) by L604 , FINSEQ_2:10;
L607: (( len ( FreeOpSeqZAO (C165 , C166) ) ) = ( len C165 ) & ( dom ( FreeOpSeqZAO (C165 , C166) ) ) = ( Seg ( len ( FreeOpSeqZAO (C165 , C166) ) ) )) by L538 , FINSEQ_1:def 3;
L608: ( (the charact of D151) . C167 ) = ( FreeOpZAO (C167 , C165 , C166) ) by L607 , L605 , L603 , L538;
reconsider D153 = ( FreeOpZAO (C167 , C165 , C166) ) as (operation of D151) by L608 , L605 , L607 , L603 , FUNCT_1:def 3;
L609: (( C165 /. C167 ) = ( C165 . C167 ) & ( dom ( FreeOpZAO (C167 , C165 , C166) ) ) = ( ( C165 /. C167 ) -tuples_on ( TS D150 ) )) by L605 , L476 , PARTFUN1:def 6;
L610: ( dom D153 ) = { ( <*> ( TS D150 ) ) } by L609 , L606 , FINSEQ_2:94;
L611: ( <*> ( TS D150 ) ) in ( dom D153 ) by L610 , TARSKI:def 1;
L612: ( D153 . ( <*> ( TS D150 ) ) ) in ( rng D153 ) by L611 , FUNCT_1:def 3;
L613: ( rng D153 ) c= D152 by RELAT_1:def 19;
reconsider D154 = ( D153 . ( <*> ( TS D150 ) ) ) as (Element of D152) by L613 , L612;
L614: ( dom D153 ) = ( ( arity D153 ) -tuples_on (the carrier of D151) ) by MARGREL1:22;
L615: ( arity D153 ) = ( 0 ) by L614 , L606 , L609 , FINSEQ_2:110;
L616: D154 in { B124 where B124 is (Element of D152) : (ex B125 being (operation of D151) st (( arity B125 ) = ( 0 ) & B124 in ( rng B125 ))) } by L615 , L612;
thus L617: thesis by L616;
end;
definition
let C168 being  with_zero non  empty (FinSequence of ( NAT ));
let C169 being  disjoint_with_NAT set;
func FreeGenSetZAO (C168 , C169) -> (Subset of ( FreeUnivAlgZAO (C168 , C169) )) equals 
{ ( root-tree B126 ) where B126 is (Symbol of ( DTConUA (C168 , C169) )) : B126 in ( Terminals ( DTConUA (C168 , C169) ) ) };
coherence
proof
set D155 = ( DTConUA (C168 , C169) );
set D156 = { ( root-tree B127 ) where B127 is (Symbol of D155) : B127 in ( Terminals D155 ) };
L618: D156 c= (the carrier of ( FreeUnivAlgZAO (C168 , C169) ))
proof
let R1 being set;
assume L619: R1 in D156;
L620: (ex B128 being (Symbol of D155) st (R1 = ( root-tree B128 ) & B128 in ( Terminals D155 ))) by L619;
thus L621: thesis by L620 , DTCONSTR:def 1;
end;
thus L622: thesis by L618;
end;
end;
definition
let C170 being  with_zero non  empty (FinSequence of ( NAT ));
let C171 being  disjoint_with_NAT set;
redefine func FreeGenSetZAO (C170 , C171) -> (GeneratorSet of ( FreeUnivAlgZAO (C170 , C171) ));

coherence
proof
set D157 = ( FreeGenSetZAO (C170 , C171) );
set D158 = ( FreeUnivAlgZAO (C170 , C171) );
L624: (the carrier of ( GenUnivAlg D157 )) = (the carrier of D158)
proof
set D159 = ( DTConUA (C170 , C171) );
defpred S7[ (DecoratedTree of (the carrier of D159)) ] means $1 in (the carrier of ( GenUnivAlg D157 ));
L625: (the carrier of ( GenUnivAlg D157 )) is (Subset of D158) by UNIALG_2:def 7;
thus L626: (the carrier of ( GenUnivAlg D157 )) c= (the carrier of D158) by L625;
L627: (for B129 being (Symbol of D159) holds (for B130 being (FinSequence of ( TS D159 )) holds ((B129 ==> ( roots B130 ) & (for B131 being (DecoratedTree of (the carrier of D159)) holds (B131 in ( rng B130 ) implies S7[ B131 ]))) implies S7[ ( B129 -tree B130 ) ])))
proof
reconsider D160 = (the carrier of ( GenUnivAlg D157 )) as (Subset of D158) by UNIALG_2:def 7;
let C172 being (Symbol of D159);
let C173 being (FinSequence of ( TS D159 ));
assume that
L628: C172 ==> ( roots C173 )
and
L629: (for B132 being (DecoratedTree of (the carrier of D159)) holds (B132 in ( rng C173 ) implies B132 in (the carrier of ( GenUnivAlg D157 ))));
L630: ( rng C173 ) c= (the carrier of ( GenUnivAlg D157 ))
proof
let R1 being set;
assume L631: R1 in ( rng C173 );
L632: ( rng C173 ) c= ( FinTrees (the carrier of D159) ) by FINSEQ_1:def 4;
reconsider D161 = R1 as (Element of ( FinTrees (the carrier of D159) )) by L632 , L631;
L633: D161 in (the carrier of ( GenUnivAlg D157 )) by L629 , L631;
thus L634: thesis by L633;
end;
reconsider D162 = C173 as (FinSequence of (the carrier of ( GenUnivAlg D157 ))) by L630 , FINSEQ_1:def 4;
reconsider D163 = C173 as (Element of ( ( TS D159 ) * )) by FINSEQ_1:def 11;
L635: [ C172 , ( roots C173 ) ] in (the Rules of D159) by L628 , LANG1:def 1;
reconsider D164 = ( roots C173 ) as (Element of ( ( ( dom C170 ) \/ C171 ) * )) by L635 , ZFMISC_1:87;
reconsider D165 = C172 as (Element of ( ( dom C170 ) \/ C171 ));
L636: [ D165 , D164 ] in ( REL (C170 , C171) ) by L628 , LANG1:def 1;
L637: D165 in ( dom C170 ) by L636 , L132;
reconsider D166 = C172 as (Element of ( NAT )) by L637;
L638: ( C170 . D165 ) = ( len D164 ) by L636 , L132;
L639: ( len ( FreeOpSeqZAO (C170 , C171) ) ) = ( len C170 ) by L538;
L640: ( dom ( FreeOpSeqZAO (C170 , C171) ) ) = ( Seg ( len C170 ) ) by L639 , FINSEQ_1:def 3
.= ( dom C170 ) by FINSEQ_1:def 3;
L641: ( ( FreeOpSeqZAO (C170 , C171) ) . D166 ) in ( rng ( FreeOpSeqZAO (C170 , C171) ) ) by L640 , L637 , FUNCT_1:def 3;
reconsider D167 = ( FreeOpZAO (D166 , C170 , C171) ) as (operation of D158) by L641 , L637 , L640 , L538;
L642: D160 is  opers_closed by UNIALG_2:def 7;
L643: D160 is_closed_on D167 by L642 , UNIALG_2:def 4;
L644: ( dom ( FreeOpZAO (D166 , C170 , C171) ) ) = ( ( C170 /. D166 ) -tuples_on ( TS D159 ) ) by L637 , L476;
L645: ( dom D167 ) = ( ( arity D167 ) -tuples_on (the carrier of D158) ) by MARGREL1:22;
L646: ( arity D167 ) = ( C170 /. D166 ) by L645 , L644 , FINSEQ_2:110;
L647: ( dom ( roots C173 ) ) = ( dom C173 ) by TREES_3:def 18
.= ( Seg ( len C173 ) ) by FINSEQ_1:def 3;
L648: ( len C173 ) = ( len D164 ) by L647 , FINSEQ_1:def 3
.= ( C170 /. D166 ) by L637 , L638 , PARTFUN1:def 6;
L649: D163 in { B133 where B133 is (Element of ( ( TS D159 ) * )) : ( len B133 ) = ( C170 /. D166 ) } by L648;
L650: ( D167 . D162 ) = ( ( Sym (D166 , C170 , C171) ) -tree C173 ) by L649 , L637 , L644 , L476
.= ( C172 -tree C173 ) by L637 , L248;
thus L651: thesis by L650 , L643 , L648 , L646 , UNIALG_2:def 3;
end;
let R1 being set;
assume L652: R1 in (the carrier of D158);
reconsider D168 = R1 as (Element of ( FinTrees (the carrier of D159) )) by L652;
L653: D168 in ( TS D159 ) by L652;
L654: (for B134 being (Symbol of D159) holds (B134 in ( Terminals D159 ) implies S7[ ( root-tree B134 ) ]))
proof
let C174 being (Symbol of D159);
assume L655: C174 in ( Terminals D159 );
L656: ( root-tree C174 ) in { ( root-tree B135 ) where B135 is (Symbol of D159) : B135 in ( Terminals D159 ) } by L655;
L657: ( Constants D158 ) <> ( {} ) by L602;
L658: D157 c= (the carrier of ( GenUnivAlg D157 )) by L657 , UNIALG_2:def 12;
thus L659: thesis by L658 , L656;
end;
L660: (for B136 being (DecoratedTree of (the carrier of D159)) holds (B136 in ( TS D159 ) implies S7[ B136 ])) from DTCONSTR:sch 7(L654 , L627);
thus L661: thesis by L660 , L653;
end;
L662: ( Constants D158 ) <> ( {} ) by L602;
thus L663: thesis by L662 , L624 , L45;
end;
end;
definition
let C175 being  with_zero non  empty (FinSequence of ( NAT ));
let C176 being  disjoint_with_NAT set;
let C177 being non  empty set;
let C178 being (Symbol of ( DTConUA (C175 , C176) ));
let C179 being (Function of ( FreeGenSetZAO (C175 , C176) ) , C177);
assume L665: C178 in ( Terminals ( DTConUA (C175 , C176) ) );
func pi (C179 , C178) -> (Element of C177) equals 
:L666: ( C179 . ( root-tree C178 ) );
coherence
proof
L667: (( root-tree C178 ) in ( FreeGenSetZAO (C175 , C176) ) & ( dom C179 ) = ( FreeGenSetZAO (C175 , C176) )) by L665 , FUNCT_2:def 1;
L668: (( rng C179 ) c= C177 & ( C179 . ( root-tree C178 ) ) in ( rng C179 )) by L667 , FUNCT_1:def 3 , RELAT_1:def 19;
thus L669: thesis by L668;
end;
end;
theorem
L671: (for B137 being  with_zero non  empty (FinSequence of ( NAT )) holds (for B138 being  disjoint_with_NAT set holds ( FreeGenSetZAO (B137 , B138) ) is  free))
proof
let C180 being  with_zero non  empty (FinSequence of ( NAT ));
let C181 being  disjoint_with_NAT set;
set D169 = ( FreeGenSetZAO (C180 , C181) );
set D170 = ( FreeUnivAlgZAO (C180 , C181) );
let C182 being Universal_Algebra;
assume L672: D170 , C182 are_similar ;
set D171 = ( DTConUA (C180 , C181) );
set D172 = (the carrier of C182);
set D173 = (the carrier of D170);
let C183 being (Function of D169 , (the carrier of C182));
deffunc H3((Symbol of D171)) = ( pi (C183 , $1) );
deffunc H4((Symbol of D171) , FinSequence , set) = ( ( oper (( @ $1 ) , C182) ) /. $3 );
consider C184 being (Function of ( TS D171 ) , D172) such that L673: (for B139 being (Symbol of D171) holds (B139 in ( Terminals D171 ) implies ( C184 . ( root-tree B139 ) ) = H3(B139))) and L674: (for B140 being (Symbol of D171) holds (for B141 being (FinSequence of ( TS D171 )) holds (B140 ==> ( roots B141 ) implies ( C184 . ( B140 -tree B141 ) ) = H4(B140 , ( roots B141 ) , ( C184 * B141 ))))) from DTCONSTR:sch 8;
reconsider D174 = C184 as (Function of D170 , C182);
take D174;
L675: (for B142 being (Element of ( NAT )) holds (B142 in ( dom (the charact of D170) ) implies (for B143 being (operation of D170) holds (for B144 being (operation of C182) holds ((B143 = ( (the charact of D170) . B142 ) & B144 = ( (the charact of C182) . B142 )) implies (for B145 being (FinSequence of D170) holds (B145 in ( dom B143 ) implies ( D174 . ( B143 . B145 ) ) = ( B144 . ( D174 * B145 ) ))))))))
proof
L676: ( dom (the charact of C182) ) = ( Seg ( len (the charact of C182) ) ) by FINSEQ_1:def 3;
let C185 being (Element of ( NAT ));
assume L677: C185 in ( dom (the charact of D170) );
let C186 being (operation of D170);
let C187 being (operation of C182);
assume that
L678: C186 = ( (the charact of D170) . C185 )
and
L679: C187 = ( (the charact of C182) . C185 );
let C188 being (FinSequence of D170);
assume L680: C188 in ( dom C186 );
reconsider D175 = C188 as (FinSequence of ( TS D171 ));
L681: ( dom ( roots D175 ) ) = ( dom D175 ) by TREES_3:def 18
.= ( Seg ( len D175 ) ) by FINSEQ_1:def 3;
L682: ( len ( roots D175 ) ) = ( len D175 ) by L681 , FINSEQ_1:def 3;
reconsider D176 = D175 as (FinSequence of ( FinTrees (the carrier of D171) ));
reconsider D177 = ( roots D176 ) as (FinSequence of ( ( dom C180 ) \/ C181 ));
reconsider D178 = D177 as (Element of ( ( ( dom C180 ) \/ C181 ) * )) by FINSEQ_1:def 11;
L683: ( dom C186 ) = ( ( arity C186 ) -tuples_on D173 ) by MARGREL1:22
.= { B146 where B146 is (Element of ( D173 * )) : ( len B146 ) = ( arity C186 ) };
L684: (ex B147 being (Element of ( D173 * )) st (C188 = B147 & ( len B147 ) = ( arity C186 ))) by L683 , L680;
L685: C186 = ( FreeOpZAO (C185 , C180 , C181) ) by L677 , L678 , L538;
reconsider D179 = ( D174 * C188 ) as (Element of ( D172 * ));
L686: ( dom C187 ) = ( ( arity C187 ) -tuples_on D172 ) by MARGREL1:22
.= { B148 where B148 is (Element of ( D172 * )) : ( len B148 ) = ( arity C187 ) };
L687: (( len (the charact of D170) ) = ( len (the charact of C182) ) & ( dom (the charact of D170) ) = ( Seg ( len (the charact of D170) ) )) by L672 , FINSEQ_1:def 3 , UNIALG_2:1;
L688: ( Seg ( len ( FreeOpSeqZAO (C180 , C181) ) ) ) = ( dom ( FreeOpSeqZAO (C180 , C181) ) ) by FINSEQ_1:def 3;
L689: (( len ( FreeOpSeqZAO (C180 , C181) ) ) = ( len C180 ) & ( dom C180 ) = ( Seg ( len C180 ) )) by L538 , FINSEQ_1:def 3;
reconsider D180 = C185 as (Symbol of D171) by L689 , L677 , L688 , XBOOLE_0:def 3;
reconsider D181 = C185 as (Element of ( ( dom C180 ) \/ C181 )) by L677 , L689 , L688 , XBOOLE_0:def 3;
L690: C180 = ( signature D170 ) by L578;
L691: ( ( signature D170 ) . C185 ) = ( arity C186 ) by L690 , L677 , L678 , L689 , L688 , UNIALG_1:def 4;
L692: [ D181 , D178 ] in ( REL (C180 , C181) ) by L691 , L677 , L689 , L688 , L690 , L684 , L682 , L132;
L693: D180 ==> ( roots D176 ) by L692 , LANG1:def 1;
L694: ( D174 . ( D180 -tree D176 ) ) = ( ( oper (( @ D180 ) , C182) ) /. ( D174 * C188 ) ) by L693 , L674;
L695: ( @ D180 ) = C185 by L693 , L423;
L696: ( oper (( @ D180 ) , C182) ) = C187 by L695 , L677 , L679 , L687 , L676 , L24;
L697: ( signature D170 ) = ( signature C182 ) by L672 , UNIALG_2:def 1;
L698: (( len ( D174 * C188 ) ) = ( len C188 ) & ( arity C187 ) = ( len C188 )) by L697 , L677 , L679 , L689 , L688 , L690 , L684 , L691 , FINSEQ_3:120 , UNIALG_1:def 4;
L699: D179 in { B149 where B149 is (Element of ( D172 * )) : ( len B149 ) = ( arity C187 ) } by L698;
reconsider D182 = D176 as (Element of ( ( TS D171 ) * )) by FINSEQ_1:def 11;
L700: ( Sym (C185 , C180 , C181) ) = D180 by L677 , L689 , L688 , L248;
L701: ( C186 . C188 ) = ( D180 -tree D182 ) by L700 , L677 , L680 , L689 , L688 , L685 , L476;
thus L702: thesis by L701 , L694 , L696 , L686 , L699 , PARTFUN1:def 6;
end;
thus L703: D174 is_homomorphism D170 , C182 by L675 , L672 , ALG_1:def 1;
L704: ( (the carrier of D170) /\ D169 ) = D169 by XBOOLE_1:28;
L705: (( dom ( D174 | D169 ) ) = ( ( dom D174 ) /\ D169 ) & ( dom D174 ) = (the carrier of D170)) by FUNCT_2:def 1 , RELAT_1:61;
L706:
now
let R1 being set;
assume L707: R1 in ( dom C183 );
L708: R1 in { ( root-tree B150 ) where B150 is (Symbol of D171) : B150 in ( Terminals D171 ) } by L707;
consider C189 being (Symbol of D171) such that L709: (R1 = ( root-tree C189 ) & C189 in ( Terminals D171 )) by L708;
thus L710: ( ( D174 | D169 ) . R1 ) = ( D174 . R1 ) by L705 , L704 , L707 , FUNCT_1:47
.= ( pi (C183 , C189) ) by L673 , L709
.= ( C183 . R1 ) by L709 , L666;
end;
L711: D169 = ( dom C183 ) by FUNCT_2:def 1;
thus L712: thesis by L711 , L705 , L704 , L706 , FUNCT_1:2;
end;
registration
let C190 being  with_zero non  empty (FinSequence of ( NAT ));
let C191 being  disjoint_with_NAT set;
cluster ( FreeUnivAlgZAO (C190 , C191) ) ->  free;
coherence
proof
L713: ( FreeGenSetZAO (C190 , C191) ) is  free by L671;
thus L714: thesis by L713 , L61;
end;
end;
definition
let C192 being  with_zero non  empty (FinSequence of ( NAT ));
let C193 being  disjoint_with_NAT set;
redefine func FreeGenSetZAO (C192 , C193) ->  free (GeneratorSet of ( FreeUnivAlgZAO (C192 , C193) ));

coherence by L671;
end;
registration
cluster  strict  free  with_const_op for Universal_Algebra;
existence
proof
set D183 = the  disjoint_with_NAT set;
set D184 = the  with_zero non  empty (FinSequence of ( NAT ));
take ( FreeUnivAlgZAO (D184 , D183) );
thus L717: thesis by L592;
end;
end;
