:: Free Magmas
::  by Marco Riccardi
::
:: Received October 20, 2009
:: Copyright (c) 2009-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, FUNCT_1, ORDINAL1, RELAT_1, XBOOLE_0, TARSKI, AFINSQ_1,
      SUBSET_1, YELLOW_6, ZFMISC_1, CLASSES1, PARTFUN1, ALGSTR_0, BINOP_1,
      EQREL_1, MSUALG_6, STRUCT_0, GROUP_6, MSSUBFAM, FUNCT_2, SETFAM_1,
      REALSET1, CIRCUIT2, CARD_1, XXREAL_0, FINSEQ_1, ARYTM_1, CARD_3, ARYTM_3,
      NAT_1, XCMPLX_0, MCART_1, NAT_LAT, ALGSTR_4;
 notations TARSKI, XBOOLE_0, ZFMISC_1,
      XTUPLE_0, SUBSET_1, XCMPLX_0, RELAT_1, FUNCT_1,
      ORDINAL1, NUMBERS, SETFAM_1, FUNCT_6, FUNCT_2, XXREAL_0, CLASSES1,
      FINSEQ_1, CARD_3, AFINSQ_1, NAT_D, YELLOW_6, BINOP_1, STRUCT_0, ALGSTR_0,
      RELSET_1, GROUP_6, MCART_1, NAT_LAT, PARTFUN1, REALSET1, EQREL_1, ALG_1,
      GROUP_2;
 constructors NAT_1, CLASSES1, AFINSQ_1, NAT_D, YELLOW_6, BINOP_1, RELSET_1,
      FACIRC_1, GROUP_6, NAT_LAT, REALSET1, EQREL_1, XTUPLE_0;
 registrations XBOOLE_0, SUBSET_1, RELAT_1, FUNCT_1, ORDINAL1, FINSET_1,
      XXREAL_0, XREAL_0, NAT_1, CARD_1, FUNCT_2, INT_1, STRUCT_0, RELSET_1,
      NAT_LAT, REALSET1, EQREL_1, GROUP_2, XTUPLE_0;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, ALGSTR_0, XTUPLE_0;
 theorems TARSKI, XBOOLE_1, ORDINAL1, RELAT_1, FUNCT_1, FUNCT_2, AFINSQ_1,
      FINSEQ_1, XREAL_1, NAT_1, XXREAL_0, XREAL_0, ZFMISC_1, CLASSES1, CARD_3,
      YELLOW_6, BINOP_1, RELSET_1, MCART_1, INT_1, SUBSET_1, XBOOLE_0, NAT_LAT,
      FUNCT_5, GROUP_6, PARTFUN1, REALSET1, SETFAM_1, EQREL_1, OSALG_4,
      GROUP_2, FUNCT_6, XTUPLE_0;
 schemes ORDINAL1, NAT_1, CLASSES1, FINSEQ_1, BINOP_1, FUNCT_2, XBOOLE_0,
      EQREL_1, RELAT_1;

begin
registration
let C1 being set;
let C2 being (Function of ( NAT ) , C1);
let C3 being Nat;
cluster ( C2 | C3 ) ->  T-Sequence-like;
correctness
proof
per cases ;
suppose L1: C1 <> ( {} );

L2: C3 c= ( NAT );
L3: C3 c= ( dom C2 ) by L2 , L1 , FUNCT_2:def 1;
L4: ( dom ( C2 | C3 ) ) is  ordinal by L3 , RELAT_1:62;
thus L5: thesis by L4 , ORDINAL1:def 7;
end;
suppose L6: C1 = ( {} );

L7: C2 = ( {} ) by L6;
thus L8: thesis by L7;
end;
end;
end;
definition
let C4 , C5 being set;
func IFXFinSequence (C5 , C4) -> (XFinSequence of C4) equals 
:L11: C5 if C5 is (XFinSequence of C4) otherwise ( <%> C4 );
correctness;
end;
definition
let C6 being non  empty set;
let C7 being (Function of ( C6 ^omega ) , C6);
let C8 being (XFinSequence of C6);
redefine func C7 . C8 -> (Element of C6);

correctness
proof
L13: C8 in ( C6 ^omega ) by AFINSQ_1:def 7;
thus L14: thesis by L13 , FUNCT_2:5;
end;
end;
theorem
L16: (for B1 , B2 , B3 being set holds ((B2 c= ( the_universe_of B1 ) & B3 c= ( the_universe_of B1 )) implies [: B2 , B3 :] c= ( the_universe_of B1 )))
proof
let C9 , C10 , C11 being set;
assume L17: C10 c= ( the_universe_of C9 );
L18: C10 c= ( Tarski-Class ( the_transitive-closure_of C9 ) ) by L17 , YELLOW_6:def 1;
assume L19: C11 c= ( the_universe_of C9 );
L20: C11 c= ( Tarski-Class ( the_transitive-closure_of C9 ) ) by L19 , YELLOW_6:def 1;
L21: [: C10 , C11 :] c= ( Tarski-Class ( the_transitive-closure_of C9 ) ) by L20 , L18 , CLASSES1:28;
thus L22: [: C10 , C11 :] c= ( the_universe_of C9 ) by L21 , YELLOW_6:def 1;
end;
scheme FuncRecursiveUniq { F1(set) -> set , F2 , F3() -> Function } : F2() = F3()
provided
L23: (( dom F2() ) = ( NAT ) & (for B4 being Nat holds ( F2() . B4 ) = F1(( F2() | B4 ))))
and
L24: (( dom F3() ) = ( NAT ) & (for B5 being Nat holds ( F3() . B5 ) = F1(( F3() | B5 ))))
proof
reconsider D1 = F2() as T-Sequence by L23 , ORDINAL1:def 7;
reconsider D2 = F3() as T-Sequence by L24 , ORDINAL1:def 7;
L25: (( dom D1 ) = ( NAT ) & (for B6 being Ordinal holds (for B7 being T-Sequence holds ((B6 in ( NAT ) & B7 = ( D1 | B6 )) implies ( D1 . B6 ) = F1(B7))))) by L23;
L26: (( dom D2 ) = ( NAT ) & (for B8 being Ordinal holds (for B9 being T-Sequence holds ((B8 in ( NAT ) & B9 = ( D2 | B8 )) implies ( D2 . B8 ) = F1(B9))))) by L24;
L27: D1 = D2 from ORDINAL1:sch 3(L25 , L26);
thus L28: thesis by L27;
end;
scheme FuncRecursiveExist { F4(set) -> set } : (ex B10 being Function st (( dom B10 ) = ( NAT ) & (for B11 being Nat holds ( B10 . B11 ) = F4(( B10 | B11 )))))
proof
consider C12 being T-Sequence such that L29: ( dom C12 ) = ( NAT ) and L30: (for B12 being Ordinal holds (for B13 being T-Sequence holds ((B12 in ( NAT ) & B13 = ( C12 | B12 )) implies ( C12 . B12 ) = F4(B13)))) from ORDINAL1:sch 4;
take C12;
thus L31: ( dom C12 ) = ( NAT ) by L29;
let C13 being Nat;
reconsider D3 = C13 as Ordinal;
L32: D3 in ( NAT ) by ORDINAL1:def 12;
L33: ( C12 . D3 ) = F4(( C12 | D3 )) by L32 , L30;
thus L34: thesis by L33;
end;
scheme FuncRecursiveUniqu2 { F5() -> non  empty set , F6((XFinSequence of F5())) -> (Element of F5()) , F7 , F8() -> (Function of ( NAT ) , F5()) } : F7() = F8()
provided
L35: (for B14 being Nat holds ( F7() . B14 ) = F6(( F7() | B14 )))
and
L36: (for B15 being Nat holds ( F8() . B15 ) = F6(( F8() | B15 )))
proof
deffunc H1(set) = F6(( IFXFinSequence ($1 , F5()) ));
reconsider D4 = F7() as Function;
reconsider D5 = F8() as Function;
L37: (( dom D4 ) = ( NAT ) & (for B16 being Nat holds ( D4 . B16 ) = H1(( D4 | B16 ))))
proof
thus L38: ( dom D4 ) = ( NAT ) by FUNCT_2:def 1;
let C14 being Nat;
thus L39: ( D4 . C14 ) = F6(( F7() | C14 )) by L35
.= H1(( D4 | C14 )) by L11;
end;
L40: (( dom D5 ) = ( NAT ) & (for B17 being Nat holds ( D5 . B17 ) = H1(( D5 | B17 ))))
proof
thus L41: ( dom D5 ) = ( NAT ) by FUNCT_2:def 1;
let C15 being Nat;
thus L42: ( D5 . C15 ) = F6(( F8() | C15 )) by L36
.= H1(( D5 | C15 )) by L11;
end;
L43: D4 = D5 from FuncRecursiveUniq(L37 , L40);
thus L44: thesis by L43;
end;
scheme FuncRecursiveExist2 { F9() -> non  empty set , F10((XFinSequence of F9())) -> (Element of F9()) } : (ex B18 being (Function of ( NAT ) , F9()) st (for B19 being Nat holds ( B18 . B19 ) = F10(( B18 | B19 ))))
proof
deffunc H2(set) = F10(( IFXFinSequence ($1 , F9()) ));
consider C16 being Function such that L45: ( dom C16 ) = ( NAT ) and L46: (for B20 being Nat holds ( C16 . B20 ) = H2(( C16 | B20 ))) from FuncRecursiveExist;
L47: (for B21 being set holds (B21 in ( rng C16 ) implies B21 in F9()))
proof
let C17 being set;
assume L48: C17 in ( rng C16 );
consider C18 being set such that L49: (C18 in ( dom C16 ) & C17 = ( C16 . C18 )) by L48 , FUNCT_1:def 3;
reconsider D6 = C18 as Nat by L45 , L49;
L50: C17 = F10(( IFXFinSequence (( C16 | D6 ) , F9()) )) by L49 , L46;
thus L51: C17 in F9() by L50;
end;
L52: ( rng C16 ) c= F9() by L47 , TARSKI:def 3;
reconsider D7 = C16 as (Function of ( NAT ) , F9()) by L52 , L45 , FUNCT_2:2;
take D7;
let C19 being Nat;
L53: ( C16 . C19 ) = F10(( IFXFinSequence (( D7 | C19 ) , F9()) )) by L46
.= F10(( D7 | C19 )) by L11;
thus L54: thesis by L53;
end;
definition
let C20 , C21 being Function;
pred C20 extends C21
means
:L55: (( dom C21 ) c= ( dom C20 ) & C20 tolerates C21)
;end;
registration
cluster  empty for multMagma;
existence
proof
take multMagma (# ( {} ) , the (BinOp of ( {} )) #);
thus L57: thesis;
end;
end;
begin
definition
let C22 being multMagma;
let C23 being (Equivalence_Relation of C22);
attr C23 is  compatible
means
:L59: (for B22 , B23 , B24 , B25 being (Element of C22) holds ((B22 in ( Class (C23 , B23) ) & B24 in ( Class (C23 , B25) )) implies ( B22 * B24 ) in ( Class (C23 , ( B23 * B25 )) )));
end;
registration
let C24 being multMagma;
cluster ( nabla (the carrier of C24) ) ->  compatible;
correctness
proof
set D8 = ( nabla (the carrier of C24) );
let C25 , C26 , C27 , C28 being (Element of C24);
assume L61: (C25 in ( Class (D8 , C26) ) & C27 in ( Class (D8 , C28) ));
L62: C24 is non  empty by L61;
L63: ( Class (D8 , ( C26 * C28 )) ) = (the carrier of C24) by L62 , EQREL_1:26;
thus L64: thesis by L63 , L62 , SUBSET_1:def 1;
end;
end;
registration
let C29 being multMagma;
cluster  compatible for (Equivalence_Relation of C29);
correctness
proof
take ( nabla (the carrier of C29) );
thus L66: thesis;
end;
end;
theorem
L68: (for B26 being multMagma holds (for B27 being (Equivalence_Relation of B26) holds (B27 is  compatible iff (for B28 , B29 , B30 , B31 being (Element of B26) holds ((( Class (B27 , B28) ) = ( Class (B27 , B29) ) & ( Class (B27 , B30) ) = ( Class (B27 , B31) )) implies ( Class (B27 , ( B28 * B30 )) ) = ( Class (B27 , ( B29 * B31 )) ))))))
proof
let C30 being multMagma;
let C31 being (Equivalence_Relation of C30);
thus L69:now
assume L70: C31 is  compatible;
let C32 , C33 , C34 , C35 being (Element of C30);
assume L71: (( Class (C31 , C32) ) = ( Class (C31 , C33) ) & ( Class (C31 , C34) ) = ( Class (C31 , C35) ));
per cases ;
suppose L72: C30 is  empty;

thus L73: ( Class (C31 , ( C32 * C34 )) ) = ( {} ) by L72
.= ( Class (C31 , ( C33 * C35 )) ) by L72;
end;
suppose L74: (not C30 is  empty);

L75: (C32 in ( Class (C31 , C33) ) & C34 in ( Class (C31 , C35) )) by L74 , L71 , EQREL_1:23;
L76: ( C32 * C34 ) in ( Class (C31 , ( C33 * C35 )) ) by L75 , L70 , L59;
thus L77: ( Class (C31 , ( C32 * C34 )) ) = ( Class (C31 , ( C33 * C35 )) ) by L76 , EQREL_1:23;
end;
end;
assume L79: (for B32 , B33 , B34 , B35 being (Element of C30) holds ((( Class (C31 , B32) ) = ( Class (C31 , B33) ) & ( Class (C31 , B34) ) = ( Class (C31 , B35) )) implies ( Class (C31 , ( B32 * B34 )) ) = ( Class (C31 , ( B33 * B35 )) )));
L80: (for B36 , B37 , B38 , B39 being (Element of C30) holds ((B36 in ( Class (C31 , B37) ) & B38 in ( Class (C31 , B39) )) implies ( B36 * B38 ) in ( Class (C31 , ( B37 * B39 )) )))
proof
let C36 , C37 , C38 , C39 being (Element of C30);
assume L81: (C36 in ( Class (C31 , C37) ) & C38 in ( Class (C31 , C39) ));
per cases ;
suppose L82: C30 is  empty;

thus L83: thesis by L82 , L81;
end;
suppose L84: (not C30 is  empty);

L85: (( Class (C31 , C37) ) = ( Class (C31 , C36) ) & ( Class (C31 , C39) ) = ( Class (C31 , C38) )) by L81 , EQREL_1:23;
L86: ( Class (C31 , ( C36 * C38 )) ) = ( Class (C31 , ( C37 * C39 )) ) by L85 , L79;
thus L87: ( C36 * C38 ) in ( Class (C31 , ( C37 * C39 )) ) by L86 , L84 , EQREL_1:23;
end;
end;
thus L89: C31 is  compatible by L80 , L59;
end;
definition
let C40 being multMagma;
let C41 being  compatible (Equivalence_Relation of C40);
func ClassOp C41 -> (BinOp of ( Class C41 )) means 
:L90: (for B40 , B41 being (Element of ( Class C41 )) holds (for B42 , B43 being (Element of C40) holds ((B40 = ( Class (C41 , B42) ) & B41 = ( Class (C41 , B43) )) implies ( it . (B40 , B41) ) = ( Class (C41 , ( B42 * B43 )) )))) if C40 is non  empty otherwise it = ( {} );
correctness
proof
L91: ((not C40 is  empty) implies (ex B44 being (BinOp of ( Class C41 )) st (for B45 , B46 being (Element of ( Class C41 )) holds (for B47 , B48 being (Element of C40) holds ((B45 = ( Class (C41 , B47) ) & B46 = ( Class (C41 , B48) )) implies ( B44 . (B45 , B46) ) = ( Class (C41 , ( B47 * B48 )) ))))))
proof
assume L92: (not C40 is  empty);
reconsider D9 = ( Class C41 ) as non  empty set by L92;
defpred S1[ set , set , set ] means (for B49 , B50 being (Element of ( Class C41 )) holds (for B51 , B52 being (Element of C40) holds ((B49 = $1 & B50 = $2 & B49 = ( Class (C41 , B51) ) & B50 = ( Class (C41 , B52) )) implies $3 = ( Class (C41 , ( B51 * B52 )) ))));
L93: (for B53 , B54 being (Element of D9) holds (ex B55 being (Element of D9) st S1[ B53 , B54 , B55 ]))
proof
let C42 , C43 being (Element of D9);
L94: C42 in ( Class C41 );
consider C44 being set such that L95: (C44 in (the carrier of C40) & C42 = ( Class (C41 , C44) )) by L94 , EQREL_1:def 3;
reconsider D10 = C44 as (Element of C40) by L95;
L96: C43 in ( Class C41 );
consider C45 being set such that L97: (C45 in (the carrier of C40) & C43 = ( Class (C41 , C45) )) by L96 , EQREL_1:def 3;
reconsider D11 = C45 as (Element of C40) by L97;
reconsider D12 = ( Class (C41 , ( D10 * D11 )) ) as (Element of D9) by L92 , EQREL_1:def 3;
take D12;
thus L98: thesis by L95 , L97 , L68;
end;
consider C46 being (Function of [: D9 , D9 :] , D9) such that L99: (for B56 , B57 being (Element of D9) holds S1[ B56 , B57 , ( C46 . (B56 , B57) ) ]) from BINOP_1:sch 3(L93);
reconsider D13 = C46 as (BinOp of ( Class C41 ));
take D13;
thus L100: thesis by L99;
end;
L101: (C40 is  empty implies (ex B58 being (BinOp of ( Class C41 )) st B58 = ( {} )))
proof
assume L102: C40 is  empty;
L103: (the carrier of C40) is  empty by L102;
L104: ( Class C41 ) is  empty by L103 , EQREL_1:31;
set D14 = the (BinOp of ( Class C41 ));
take D14;
thus L105: D14 = ( {} ) by L104;
end;
L106: (for B59 , B60 being (BinOp of ( Class C41 )) holds (((not C40 is  empty) & (for B61 , B62 being (Element of ( Class C41 )) holds (for B63 , B64 being (Element of C40) holds ((B61 = ( Class (C41 , B63) ) & B62 = ( Class (C41 , B64) )) implies ( B59 . (B61 , B62) ) = ( Class (C41 , ( B63 * B64 )) )))) & (for B65 , B66 being (Element of ( Class C41 )) holds (for B67 , B68 being (Element of C40) holds ((B65 = ( Class (C41 , B67) ) & B66 = ( Class (C41 , B68) )) implies ( B60 . (B65 , B66) ) = ( Class (C41 , ( B67 * B68 )) ))))) implies B59 = B60))
proof
let C47 , C48 being (BinOp of ( Class C41 ));
assume L107: (not C40 is  empty);
assume L108: (for B69 , B70 being (Element of ( Class C41 )) holds (for B71 , B72 being (Element of C40) holds ((B69 = ( Class (C41 , B71) ) & B70 = ( Class (C41 , B72) )) implies ( C47 . (B69 , B70) ) = ( Class (C41 , ( B71 * B72 )) ))));
assume L109: (for B73 , B74 being (Element of ( Class C41 )) holds (for B75 , B76 being (Element of C40) holds ((B73 = ( Class (C41 , B75) ) & B74 = ( Class (C41 , B76) )) implies ( C48 . (B73 , B74) ) = ( Class (C41 , ( B75 * B76 )) ))));
L110: (for B77 , B78 being set holds ((B77 in ( Class C41 ) & B78 in ( Class C41 )) implies ( C47 . (B77 , B78) ) = ( C48 . (B77 , B78) )))
proof
let C49 , C50 being set;
assume L111: C49 in ( Class C41 );
reconsider D15 = C49 as (Element of ( Class C41 )) by L111;
assume L112: C50 in ( Class C41 );
reconsider D16 = C50 as (Element of ( Class C41 )) by L112;
consider C51 being set such that L113: (C51 in (the carrier of C40) & D15 = ( Class (C41 , C51) )) by L111 , EQREL_1:def 3;
consider C52 being set such that L114: (C52 in (the carrier of C40) & D16 = ( Class (C41 , C52) )) by L112 , EQREL_1:def 3;
reconsider D17 = C51 , D18 = C52 as (Element of C40) by L113 , L114;
L115: ( C47 . (D15 , D16) ) = ( Class (C41 , ( D17 * D18 )) ) by L113 , L114 , L108;
thus L116: ( C47 . (C49 , C50) ) = ( C48 . (C49 , C50) ) by L115 , L113 , L114 , L109;
end;
thus L117: thesis by L110 , BINOP_1:1;
end;
thus L118: thesis by L106 , L91 , L101;
end;
end;
definition
let C53 being multMagma;
let C54 being  compatible (Equivalence_Relation of C53);
func C53 ./. C54 -> multMagma equals 
multMagma (# ( Class C54 ) , ( ClassOp C54 ) #);
correctness;
end;
registration
let C55 being multMagma;
let C56 being  compatible (Equivalence_Relation of C55);
cluster ( C55 ./. C56 ) ->  strict;
correctness;
end;
registration
let C57 being non  empty multMagma;
let C58 being  compatible (Equivalence_Relation of C57);
cluster ( C57 ./. C58 ) -> non  empty;
correctness;
end;
definition
let C59 being non  empty multMagma;
let C60 being  compatible (Equivalence_Relation of C59);
func nat_hom C60 -> (Function of C59 , ( C59 ./. C60 )) means 
:L123: (for B79 being (Element of C59) holds ( it . B79 ) = ( Class (C60 , B79) ));
existence
proof
defpred S2[ set , set ] means (ex B80 being (Element of C59) st ($1 = B80 & $2 = ( Class (C60 , B80) )));
L124: (for B81 being set holds (B81 in (the carrier of C59) implies (ex B82 being set st S2[ B81 , B82 ])))
proof
let C61 being set;
assume L125: C61 in (the carrier of C59);
reconsider D19 = C61 as (Element of C59) by L125;
reconsider D20 = ( Class (C60 , D19) ) as set;
take D20;
take D19;
thus L126: thesis;
end;
consider C62 being Function such that L127: ( dom C62 ) = (the carrier of C59) and L128: (for B83 being set holds (B83 in (the carrier of C59) implies S2[ B83 , ( C62 . B83 ) ])) from CLASSES1:sch 1(L124);
L129: ( rng C62 ) c= (the carrier of ( C59 ./. C60 ))
proof
let C63 being set;
assume L130: C63 in ( rng C62 );
consider C64 being set such that L131: C64 in ( dom C62 ) and L132: ( C62 . C64 ) = C63 by L130 , FUNCT_1:def 3;
consider C65 being (Element of C59) such that L133: (C64 = C65 & ( C62 . C64 ) = ( Class (C60 , C65) )) by L127 , L128 , L131;
thus L134: thesis by L132 , L133 , EQREL_1:def 3;
end;
reconsider D21 = C62 as (Function of C59 , ( C59 ./. C60 )) by L129 , L127 , FUNCT_2:def 1 , RELSET_1:4;
take D21;
let C66 being (Element of C59);
L135: (ex B84 being (Element of C59) st (C66 = B84 & ( D21 . C66 ) = ( Class (C60 , B84) ))) by L128;
thus L136: thesis by L135;
end;
uniqueness
proof
let C67 , C68 being (Function of C59 , ( C59 ./. C60 ));
assume that
L137: (for B85 being (Element of C59) holds ( C67 . B85 ) = ( Class (C60 , B85) ))
and
L138: (for B86 being (Element of C59) holds ( C68 . B86 ) = ( Class (C60 , B86) ));
L139:
now
let C69 being (Element of C59);
L140: (( C67 . C69 ) = ( Class (C60 , C69) ) & ( C68 . C69 ) = ( Class (C60 , C69) )) by L137 , L138;
thus L141: ( C67 . C69 ) = ( C68 . C69 ) by L140;
end;
thus L142: thesis by L139 , FUNCT_2:63;
end;
end;
registration
let C70 being non  empty multMagma;
let C71 being  compatible (Equivalence_Relation of C70);
cluster ( nat_hom C71 ) ->  multiplicative;
correctness
proof
L144: (for B87 , B88 being (Element of C70) holds ( ( nat_hom C71 ) . ( B87 * B88 ) ) = ( ( ( nat_hom C71 ) . B87 ) * ( ( nat_hom C71 ) . B88 ) ))
proof
let C72 , C73 being (Element of C70);
L145: (( ( nat_hom C71 ) . C72 ) = ( Class (C71 , C72) ) & ( ( nat_hom C71 ) . C73 ) = ( Class (C71 , C73) )) by L123;
L146: ( ( ClassOp C71 ) . (( ( nat_hom C71 ) . C72 ) , ( ( nat_hom C71 ) . C73 )) ) = ( Class (C71 , ( C72 * C73 )) ) by L145 , L90;
thus L147: ( ( nat_hom C71 ) . ( C72 * C73 ) ) = ( ( ( nat_hom C71 ) . C72 ) * ( ( nat_hom C71 ) . C73 ) ) by L146 , L123;
end;
thus L148: thesis by L144 , GROUP_6:def 6;
end;
end;
registration
let C74 being non  empty multMagma;
let C75 being  compatible (Equivalence_Relation of C74);
cluster ( nat_hom C75 ) ->  onto;
correctness
proof
L150: (for B89 being set holds (B89 in (the carrier of ( C74 ./. C75 )) implies B89 in ( rng ( nat_hom C75 ) )))
proof
let C76 being set;
assume L151: C76 in (the carrier of ( C74 ./. C75 ));
consider C77 being set such that L152: (C77 in (the carrier of C74) & C76 = ( Class (C75 , C77) )) by L151 , EQREL_1:def 3;
reconsider D22 = C77 as (Element of C74) by L152;
L153: (the carrier of C74) = ( dom ( nat_hom C75 ) ) by FUNCT_2:def 1;
L154: (D22 in ( dom ( nat_hom C75 ) ) & ( ( nat_hom C75 ) . D22 ) = ( Class (C75 , D22) )) by L153 , L123;
thus L155: C76 in ( rng ( nat_hom C75 ) ) by L154 , L152 , FUNCT_1:def 3;
end;
L156: (the carrier of ( C74 ./. C75 )) c= ( rng ( nat_hom C75 ) ) by L150 , TARSKI:def 3;
L157: ( rng ( nat_hom C75 ) ) = (the carrier of ( C74 ./. C75 )) by L156 , XBOOLE_0:def 10;
thus L158: thesis by L157 , FUNCT_2:def 3;
end;
end;
definition
let C78 being multMagma;
mode Relators of C78
 is [: (the carrier of C78) , (the carrier of C78) :] -valued Function;
end;
definition
let C79 being multMagma;
let C80 being (Relators of C79);
func equ_rel C80 -> (Equivalence_Relation of C79) equals 
( meet { B90 where B90 is  compatible (Equivalence_Relation of C79) : (for B91 being set holds (for B92 , B93 being (Element of C79) holds ((B91 in ( dom C80 ) & ( C80 . B91 ) = [ B92 , B93 ]) implies B92 in ( Class (B90 , B93) )))) } );
correctness
proof
set D23 = { B94 where B94 is  compatible (Equivalence_Relation of C79) : (for B95 being set holds (for B96 , B97 being (Element of C79) holds ((B95 in ( dom C80 ) & ( C80 . B95 ) = [ B96 , B97 ]) implies B96 in ( Class (B94 , B97) )))) };
per cases ;
suppose L161: C79 is  empty;

L162: (the carrier of C79) = ( {} ) by L161;
L163: (for B98 being set holds (B98 in D23 implies B98 in { ( {} ) }))
proof
let C81 being set;
assume L164: C81 in D23;
consider C82 being  compatible (Equivalence_Relation of C79) such that L165: (C81 = C82 & (for B99 being set holds (for B100 , B101 being (Element of C79) holds ((B99 in ( dom C80 ) & ( C80 . B99 ) = [ B100 , B101 ]) implies B100 in ( Class (C82 , B101) ))))) by L164;
L166: C81 is (Subset of ( {} )) by L165 , L162 , ZFMISC_1:90;
thus L167: C81 in { ( {} ) } by L166 , TARSKI:def 1;
end;
L168: D23 c= { ( {} ) } by L163 , TARSKI:def 3;
L169: (D23 = ( {} ) or D23 = { ( {} ) }) by L168 , ZFMISC_1:33;
thus L170: thesis by L169 , L162 , OSALG_4:9 , SETFAM_1:10 , SETFAM_1:def 1;
end;
suppose L171: (not C79 is  empty);

L172: (for B102 being set holds (for B103 , B104 being (Element of C79) holds ((B102 in ( dom C80 ) & ( C80 . B102 ) = [ B103 , B104 ]) implies B103 in ( Class (( nabla (the carrier of C79) ) , B104) ))))
proof
let C83 being set;
let C84 , C85 being (Element of C79);
assume L173: (C83 in ( dom C80 ) & ( C80 . C83 ) = [ C84 , C85 ]);
L174: ( Class (( nabla (the carrier of C79) ) , C85) ) = (the carrier of C79) by L171 , EQREL_1:26;
thus L175: C84 in ( Class (( nabla (the carrier of C79) ) , C85) ) by L174 , L171 , SUBSET_1:def 1;
end;
L176: ( nabla (the carrier of C79) ) in D23 by L172;
L177: (for B105 being set holds (B105 in D23 implies B105 in ( bool [: (the carrier of C79) , (the carrier of C79) :] )))
proof
let C86 being set;
assume L178: C86 in D23;
consider C87 being  compatible (Equivalence_Relation of C79) such that L179: (C86 = C87 & (for B106 being set holds (for B107 , B108 being (Element of C79) holds ((B106 in ( dom C80 ) & ( C80 . B106 ) = [ B107 , B108 ]) implies B107 in ( Class (C87 , B108) ))))) by L178;
thus L180: thesis by L179;
end;
reconsider D24 = D23 as (Subset-Family of [: (the carrier of C79) , (the carrier of C79) :]) by L177 , TARSKI:def 3;
L181: (for B109 being set holds (B109 in D24 implies B109 is (Equivalence_Relation of C79)))
proof
let C88 being set;
assume L182: C88 in D24;
consider C89 being  compatible (Equivalence_Relation of C79) such that L183: (C88 = C89 & (for B110 being set holds (for B111 , B112 being (Element of C79) holds ((B110 in ( dom C80 ) & ( C80 . B110 ) = [ B111 , B112 ]) implies B111 in ( Class (C89 , B112) ))))) by L182;
thus L184: C88 is (Equivalence_Relation of C79) by L183;
end;
thus L185: thesis by L181 , L176 , EQREL_1:11;
end;
end;
end;
theorem
L188: (for B113 being multMagma holds (for B114 being (Relators of B113) holds (for B115 being  compatible (Equivalence_Relation of B113) holds ((for B116 being set holds (for B117 , B118 being (Element of B113) holds ((B116 in ( dom B114 ) & ( B114 . B116 ) = [ B117 , B118 ]) implies B117 in ( Class (B115 , B118) )))) implies ( equ_rel B114 ) c= B115))))
proof
let C90 being multMagma;
let C91 being (Relators of C90);
let C92 being  compatible (Equivalence_Relation of C90);
assume L189: (for B119 being set holds (for B120 , B121 being (Element of C90) holds ((B119 in ( dom C91 ) & ( C91 . B119 ) = [ B120 , B121 ]) implies B120 in ( Class (C92 , B121) ))));
L190: (for B122 being set holds (B122 in ( equ_rel C91 ) implies B122 in C92))
proof
let C93 being set;
L191: C92 in { B123 where B123 is  compatible (Equivalence_Relation of C90) : (for B124 being set holds (for B125 , B126 being (Element of C90) holds ((B124 in ( dom C91 ) & ( C91 . B124 ) = [ B125 , B126 ]) implies B125 in ( Class (B123 , B126) )))) } by L189;
thus L192: thesis by L191 , SETFAM_1:def 1;
end;
thus L193: ( equ_rel C91 ) c= C92 by L190 , TARSKI:def 3;
end;
registration
let C94 being multMagma;
let C95 being (Relators of C94);
cluster ( equ_rel C95 ) ->  compatible;
coherence
proof
set D25 = { B127 where B127 is  compatible (Equivalence_Relation of C94) : (for B128 being set holds (for B129 , B130 being (Element of C94) holds ((B128 in ( dom C95 ) & ( C95 . B128 ) = [ B129 , B130 ]) implies B129 in ( Class (B127 , B130) )))) };
L194: (for B131 , B132 , B133 , B134 being (Element of C94) holds ((B131 in ( Class (( equ_rel C95 ) , B132) ) & B133 in ( Class (( equ_rel C95 ) , B134) )) implies ( B131 * B133 ) in ( Class (( equ_rel C95 ) , ( B132 * B134 )) )))
proof
let C96 , C97 , C98 , C99 being (Element of C94);
assume L195: C96 in ( Class (( equ_rel C95 ) , C97) );
L196: [ C97 , C96 ] in ( equ_rel C95 ) by L195 , EQREL_1:18;
assume L197: C98 in ( Class (( equ_rel C95 ) , C99) );
L198: [ C99 , C98 ] in ( equ_rel C95 ) by L197 , EQREL_1:18;
per cases ;
suppose L199: D25 = ( {} );

thus L200: thesis by L199 , L196 , SETFAM_1:def 1;
end;
suppose L201: D25 <> ( {} );

L202: (for B135 being set holds (B135 in D25 implies [ ( C97 * C99 ) , ( C96 * C98 ) ] in B135))
proof
let C100 being set;
assume L203: C100 in D25;
consider C101 being  compatible (Equivalence_Relation of C94) such that L204: (C100 = C101 & (for B136 being set holds (for B137 , B138 being (Element of C94) holds ((B136 in ( dom C95 ) & ( C95 . B136 ) = [ B137 , B138 ]) implies B137 in ( Class (C101 , B138) ))))) by L203;
L205: [ C97 , C96 ] in C100 by L196 , L203 , SETFAM_1:def 1;
L206: C96 in ( Class (C101 , C97) ) by L205 , L204 , EQREL_1:18;
L207: [ C99 , C98 ] in C100 by L198 , L203 , SETFAM_1:def 1;
L208: C98 in ( Class (C101 , C99) ) by L207 , L204 , EQREL_1:18;
L209: ( C96 * C98 ) in ( Class (C101 , ( C97 * C99 )) ) by L208 , L206 , L59;
thus L210: [ ( C97 * C99 ) , ( C96 * C98 ) ] in C100 by L209 , L204 , EQREL_1:18;
end;
L211: [ ( C97 * C99 ) , ( C96 * C98 ) ] in ( meet D25 ) by L202 , L201 , SETFAM_1:def 1;
thus L212: ( C96 * C98 ) in ( Class (( equ_rel C95 ) , ( C97 * C99 )) ) by L211 , EQREL_1:18;
end;
end;
thus L214: thesis by L194 , L59;
end;
end;
definition
let C102 , C103 being set;
let C104 being (Function of C102 , C103);
func equ_kernel C104 -> (Equivalence_Relation of C102) means 
:L216: (for B139 , B140 being set holds ([ B139 , B140 ] in it iff (B139 in C102 & B140 in C102 & ( C104 . B139 ) = ( C104 . B140 ))));
existence
proof
defpred S3[ set , set ] means ( C104 . $1 ) = ( C104 . $2 );
L217: (for B141 being set holds (B141 in C102 implies S3[ B141 , B141 ]));
L218: (for B142 , B143 being set holds (S3[ B142 , B143 ] implies S3[ B143 , B142 ]));
L219: (for B144 , B145 , B146 being set holds ((S3[ B144 , B145 ] & S3[ B145 , B146 ]) implies S3[ B144 , B146 ]));
L220: (ex B147 being (Equivalence_Relation of C102) st (for B148 , B149 being set holds ([ B148 , B149 ] in B147 iff (B148 in C102 & B149 in C102 & S3[ B148 , B149 ])))) from EQREL_1:sch 1(L217 , L218 , L219);
thus L221: thesis by L220;
end;
uniqueness
proof
let C105 , C106 being (Equivalence_Relation of C102);
defpred S4[ set , set ] means ($1 in C102 & $2 in C102 & ( C104 . $1 ) = ( C104 . $2 ));
assume L222: (for B150 , B151 being set holds ([ B150 , B151 ] in C105 iff (B150 in C102 & B151 in C102 & ( C104 . B150 ) = ( C104 . B151 ))));
L223: (for B152 , B153 being set holds ([ B152 , B153 ] in C105 iff S4[ B152 , B153 ])) by L222;
assume L224: (for B154 , B155 being set holds ([ B154 , B155 ] in C106 iff (B154 in C102 & B155 in C102 & ( C104 . B154 ) = ( C104 . B155 ))));
L225: (for B156 , B157 being set holds ([ B156 , B157 ] in C106 iff S4[ B156 , B157 ])) by L224;
thus L226: C105 = C106 from RELAT_1:sch 2(L223 , L225);
end;
end;
theorem
L228: (for R1 being non  empty multMagma holds (for R2 being non  empty multMagma holds (for R3 being (Function of R1 , R2) holds (R3 is  multiplicative implies ( equ_kernel R3 ) is  compatible))))
proof
let R1 being non  empty multMagma;
let R2 being non  empty multMagma;
let R3 being (Function of R1 , R2);
assume L229: R3 is  multiplicative;
set D26 = ( equ_kernel R3 );
L230: (for B158 , B159 , B160 , B161 being (Element of R1) holds ((B158 in ( Class (D26 , B159) ) & B160 in ( Class (D26 , B161) )) implies ( B158 * B160 ) in ( Class (D26 , ( B159 * B161 )) )))
proof
let C107 , C108 , C109 , C110 being (Element of R1);
assume L231: C107 in ( Class (D26 , C108) );
L232: [ C108 , C107 ] in D26 by L231 , EQREL_1:18;
assume L233: C109 in ( Class (D26 , C110) );
L234: [ C110 , C109 ] in D26 by L233 , EQREL_1:18;
L235: ( R3 . C110 ) = ( R3 . C109 ) by L234 , L216;
L236: ( R3 . ( C108 * C110 ) ) = ( ( R3 . C108 ) * ( R3 . C110 ) ) by L229 , GROUP_6:def 6
.= ( ( R3 . C107 ) * ( R3 . C109 ) ) by L232 , L235 , L216
.= ( R3 . ( C107 * C109 ) ) by L229 , GROUP_6:def 6;
L237: [ ( C108 * C110 ) , ( C107 * C109 ) ] in D26 by L236 , L216;
thus L238: ( C107 * C109 ) in ( Class (D26 , ( C108 * C110 )) ) by L237 , EQREL_1:18;
end;
thus L239: ( equ_kernel R3 ) is  compatible by L230 , L59;
end;
theorem
L240: (for R1 being non  empty multMagma holds (for R2 being non  empty multMagma holds (for R3 being (Function of R1 , R2) holds (R3 is  multiplicative implies (ex B162 being (Relators of R1) st ( equ_kernel R3 ) = ( equ_rel B162 ))))))
proof
let R1 being non  empty multMagma;
let R2 being non  empty multMagma;
let R3 being (Function of R1 , R2);
assume L241: R3 is  multiplicative;
set D27 = { [ B163 , B164 ] where B163 , B164 is (Element of R1) : ( R3 . B163 ) = ( R3 . B164 ) };
set D28 = ( id D27 );
L242: ( dom D28 ) = D27;
L243: (for B165 being set holds (B165 in ( rng D28 ) implies B165 in [: (the carrier of R1) , (the carrier of R1) :]))
proof
let C111 being set;
assume L244: C111 in ( rng D28 );
consider C112 being set such that L245: (C112 in ( dom D28 ) & C111 = ( D28 . C112 )) by L244 , FUNCT_1:def 3;
L246: C111 = C112 by L245 , FUNCT_1:17;
L247: C111 in D27 by L246 , L245;
consider C113 , C114 being (Element of R1) such that L248: (C111 = [ C113 , C114 ] & ( R3 . C113 ) = ( R3 . C114 )) by L247;
thus L249: thesis by L248 , ZFMISC_1:def 2;
end;
L250: ( rng D28 ) c= [: (the carrier of R1) , (the carrier of R1) :] by L243 , TARSKI:def 3;
reconsider D29 = D28 as (Relators of R1) by L250 , FUNCT_2:2;
take D29;
reconsider D30 = ( equ_kernel R3 ) as  compatible (Equivalence_Relation of R1) by L241 , L228;
L251: (for B166 being set holds (for B167 , B168 being (Element of R1) holds ((B166 in ( dom D29 ) & ( D29 . B166 ) = [ B167 , B168 ]) implies B167 in ( Class (D30 , B168) ))))
proof
let C115 being set;
let C116 , C117 being (Element of R1);
assume L252: (C115 in ( dom D29 ) & ( D29 . C115 ) = [ C116 , C117 ]);
L253: ( D29 . C115 ) = C115 by L252 , L242 , FUNCT_1:17;
consider C118 , C119 being (Element of R1) such that L254: (C115 = [ C118 , C119 ] & ( R3 . C118 ) = ( R3 . C119 )) by L242 , L252;
L255: [ C116 , C117 ] in ( equ_kernel R3 ) by L254 , L216 , L252 , L253;
thus L256: C116 in ( Class (D30 , C117) ) by L255 , EQREL_1:19;
end;
L257: ( equ_rel D29 ) c= D30 by L251 , L188;
L258: (for B169 being set holds (B169 in D30 implies B169 in ( equ_rel D29 )))
proof
let C120 being set;
assume L259: C120 in D30;
consider C121 , C122 being set such that L260: (C121 in (the carrier of R1) & C122 in (the carrier of R1) & C120 = [ C121 , C122 ]) by L259 , ZFMISC_1:def 2;
L261: ( R3 . C121 ) = ( R3 . C122 ) by L259 , L260 , L216;
reconsider D31 = C121 , D32 = C122 as (Element of R1) by L260;
set D33 = { B170 where B170 is  compatible (Equivalence_Relation of R1) : (for B171 being set holds (for B172 , B173 being (Element of R1) holds ((B171 in ( dom D29 ) & ( D29 . B171 ) = [ B172 , B173 ]) implies B172 in ( Class (B170 , B173) )))) };
L262: D30 in D33 by L251;
L263: (for B174 being set holds (B174 in D33 implies C120 in B174))
proof
let C123 being set;
assume L264: C123 in D33;
consider C124 being  compatible (Equivalence_Relation of R1) such that L265: (C124 = C123 & (for B175 being set holds (for B176 , B177 being (Element of R1) holds ((B175 in ( dom D29 ) & ( D29 . B175 ) = [ B176 , B177 ]) implies B176 in ( Class (C124 , B177) ))))) by L264;
set D34 = [ D31 , D32 ];
L266: D34 in D27 by L261;
L267: ( D29 . D34 ) = [ D31 , D32 ] by L266 , FUNCT_1:17;
L268: D31 in ( Class (C124 , D32) ) by L267 , L242 , L266 , L265;
thus L269: C120 in C123 by L268 , L260 , L265 , EQREL_1:19;
end;
thus L270: thesis by L263 , L262 , SETFAM_1:def 1;
end;
L271: D30 c= ( equ_rel D29 ) by L258 , TARSKI:def 3;
thus L272: thesis by L271 , L257 , XBOOLE_0:def 10;
end;
begin
definition
let C125 being multMagma;
mode multSubmagma of C125
 -> multMagma
means :L273: ((the carrier of it) c= (the carrier of C125) & (the multF of it) = ( (the multF of C125) || (the carrier of it) ));
existence
proof
set D35 = the  empty multMagma;
reconsider D36 = (the carrier of D35) as set;
reconsider D37 = [: D36 , D36 :] as set;
L274: (the multF of D35) = ( (the multF of C125) | ( {} ) )
.= ( (the multF of C125) | D37 ) by ZFMISC_1:90
.= ( (the multF of C125) || (the carrier of D35) ) by REALSET1:def 2;
thus L275: thesis by L274 , XBOOLE_1:2;
end;
end;
registration
let C126 being multMagma;
cluster  strict for (multSubmagma of C126);
existence
proof
set D38 = multMagma (# (the carrier of C126) , (the multF of C126) #);
L277: (the multF of D38) = ( (the multF of D38) | [: (the carrier of D38) , (the carrier of D38) :] )
.= ( (the multF of C126) || (the carrier of D38) ) by REALSET1:def 2;
reconsider D39 = D38 as (multSubmagma of C126) by L277 , L273;
take D39;
thus L278: thesis;
end;
end;
registration
let C127 being non  empty multMagma;
cluster non  empty for (multSubmagma of C127);
existence
proof
set D40 = multMagma (# (the carrier of C127) , (the multF of C127) #);
L280: (the multF of D40) = ( (the multF of D40) | [: (the carrier of D40) , (the carrier of D40) :] )
.= ( (the multF of C127) || (the carrier of D40) ) by REALSET1:def 2;
reconsider D41 = D40 as (multSubmagma of C127) by L280 , L273;
take D41;
thus L281: thesis;
end;
end;
theorem
L283: (for R4 being multMagma holds (for R5 being (multSubmagma of R4) holds (for R6 being (multSubmagma of R4) holds ((R5 is (multSubmagma of R6) & R6 is (multSubmagma of R5)) implies ( the multMagma of R5 ) = ( the multMagma of R6 )))))
proof
let R4 being multMagma;
let R5 being (multSubmagma of R4);
let R6 being (multSubmagma of R4);
assume that
L284: R5 is (multSubmagma of R6)
and
L285: R6 is (multSubmagma of R5);
set D42 = (the carrier of R5);
set D43 = (the carrier of R6);
set D44 = (the multF of R5);
set D45 = (the multF of R6);
L286: (D42 c= D43 & D43 c= D42) by L284 , L285 , L273;
L287: D44 = ( D45 || D42 ) by L284 , L273
.= ( ( D44 || D43 ) || D42 ) by L285 , L273
.= ( ( D44 | [: D43 , D43 :] ) || D42 ) by REALSET1:def 2
.= ( ( D44 | [: D43 , D43 :] ) | [: D42 , D42 :] ) by REALSET1:def 2
.= ( D44 | [: D43 , D43 :] )
.= ( D44 || D43 ) by REALSET1:def 2
.= D45 by L285 , L273;
thus L288: thesis by L287 , L286 , XBOOLE_0:def 10;
end;
theorem
L289: (for R4 being multMagma holds (for R5 being (multSubmagma of R4) holds ((the carrier of R5) = (the carrier of R4) implies ( the multMagma of R5 ) = ( the multMagma of R4 ))))
proof
let R4 being multMagma;
let R5 being (multSubmagma of R4);
assume L290: (the carrier of R5) = (the carrier of R4);
per cases ;
suppose L291: (the carrier of R4) = ( {} );

thus L292: thesis by L291 , L290;
end;
suppose L293: (the carrier of R4) <> ( {} );

L294: (the multF of R4) = ( (the multF of R4) | [: (the carrier of R4) , (the carrier of R4) :] )
.= ( (the multF of R4) || (the carrier of R4) ) by REALSET1:def 2;
reconsider D46 = R4 as (multSubmagma of R4) by L294 , L273;
L295: (the multF of D46) = ( (the multF of R5) || (the carrier of D46) ) by L290 , L294 , L273;
L296: D46 is (multSubmagma of R5) by L295 , L290 , L273;
thus L297: thesis by L296 , L283;
end;
end;
definition
let C128 being multMagma;
let C129 being (Subset of C128);
attr C129 is  stable
means
:L299: (for B178 , B179 being (Element of C128) holds ((B178 in C129 & B179 in C129) implies ( B178 * B179 ) in C129));
end;
registration
let C130 being multMagma;
cluster  stable for (Subset of C130);
correctness
proof
reconsider D47 = (the carrier of C130) as (Subset of C130) by ZFMISC_1:def 1;
take D47;
L301: (for B180 , B181 being (Element of C130) holds ((B180 in D47 & B181 in D47) implies ( B180 * B181 ) in D47));
thus L302: thesis by L301 , L299;
end;
end;
theorem
L304: (for R4 being multMagma holds (for R5 being (multSubmagma of R4) holds (the carrier of R5) is  stable  stable  stable  stable (Subset of R4)))
proof
let R4 being multMagma;
let R5 being (multSubmagma of R4);
L305: (for B182 , B183 being (Element of R4) holds ((B182 in (the carrier of R5) & B183 in (the carrier of R5)) implies ( B182 * B183 ) in (the carrier of R5)))
proof
let C131 , C132 being (Element of R4);
assume L306: (C131 in (the carrier of R5) & C132 in (the carrier of R5));
reconsider D48 = C131 , D49 = C132 as (Element of R5) by L306;
L307: [ C131 , C132 ] in [: (the carrier of R5) , (the carrier of R5) :] by L306 , ZFMISC_1:def 2;
L308: ( D48 * D49 ) = ( (the multF of R5) . [ D48 , D49 ] ) by BINOP_1:def 1
.= ( ( (the multF of R4) || (the carrier of R5) ) . [ D48 , D49 ] ) by L273
.= ( ( (the multF of R4) | [: (the carrier of R5) , (the carrier of R5) :] ) . [ C131 , C132 ] ) by REALSET1:def 2
.= ( (the multF of R4) . [ C131 , C132 ] ) by L307 , FUNCT_1:49
.= ( C131 * C132 ) by BINOP_1:def 1;
thus L309: ( C131 * C132 ) in (the carrier of R5) by L308 , L306;
end;
thus L310: (the carrier of R5) is  stable  stable  stable  stable (Subset of R4) by L305 , L273 , L299;
end;
registration
let C133 being multMagma;
let C134 being (multSubmagma of C133);
cluster (the carrier of C134) ->  stable for (Subset of C133);
correctness by L304;
end;
theorem
L312: (for R4 being multMagma holds (for B184 being Function holds ((for B185 being set holds (B185 in ( dom B184 ) implies ( B184 . B185 ) is  stable  stable  stable  stable (Subset of R4))) implies ( meet B184 ) is  stable  stable  stable  stable (Subset of R4))))
proof
let R4 being multMagma;
let C135 being Function;
assume L313: (for B186 being set holds (B186 in ( dom C135 ) implies ( C135 . B186 ) is  stable  stable  stable  stable (Subset of R4)));
L314: (for B187 being set holds (B187 in ( meet C135 ) implies B187 in (the carrier of R4)))
proof
let C136 being set;
assume L315: C136 in ( meet C135 );
L316: C136 in ( meet ( rng C135 ) ) by L315 , FUNCT_6:def 4;
per cases ;
suppose L317: ( dom C135 ) is  empty;

L318: C135 = ( {} ) by L317;
thus L319: thesis by L318 , L316 , SETFAM_1:1;
end;
suppose L320: (not ( dom C135 ) is  empty);

consider C137 being set such that L321: C137 in ( dom C135 ) by L320 , XBOOLE_0:def 1;
L322: ( meet ( rng C135 ) ) c= ( C135 . C137 ) by L321 , FUNCT_1:3 , SETFAM_1:3;
L323: C136 in ( C135 . C137 ) by L322 , L316;
L324: ( C135 . C137 ) is  stable  stable  stable  stable (Subset of R4) by L313 , L321;
thus L325: C136 in (the carrier of R4) by L324 , L323;
end;
end;
L327: (for B188 , B189 being (Element of R4) holds ((B188 in ( meet C135 ) & B189 in ( meet C135 )) implies ( B188 * B189 ) in ( meet C135 )))
proof
let C138 , C139 being (Element of R4);
assume L328: (C138 in ( meet C135 ) & C139 in ( meet C135 ));
per cases ;
suppose L329: C135 = ( {} );

L330: ( meet ( rng C135 ) ) = ( {} ) by L329 , SETFAM_1:1;
thus L331: thesis by L330 , L328 , FUNCT_6:def 4;
end;
suppose L332: C135 <> ( {} );

L333: (C138 in ( meet ( rng C135 ) ) & C139 in ( meet ( rng C135 ) )) by L328 , FUNCT_6:def 4;
L334: (for B190 being set holds (B190 in ( rng C135 ) implies ( C138 * C139 ) in B190))
proof
let C140 being set;
assume L335: C140 in ( rng C135 );
L336: (C138 in C140 & C139 in C140) by L335 , L333 , SETFAM_1:def 1;
consider C141 being set such that L337: (C141 in ( dom C135 ) & C140 = ( C135 . C141 )) by L335 , FUNCT_1:def 3;
L338: C140 is  stable  stable  stable  stable (Subset of R4) by L313 , L337;
thus L339: ( C138 * C139 ) in C140 by L338 , L336 , L299;
end;
L340: ( C138 * C139 ) in ( meet ( rng C135 ) ) by L334 , L332 , SETFAM_1:def 1;
thus L341: ( C138 * C139 ) in ( meet C135 ) by L340 , FUNCT_6:def 4;
end;
end;
thus L343: thesis by L327 , L314 , L299 , TARSKI:def 3;
end;
theorem
L344: (for R7 being non  empty multMagma holds (for R9 being (Subset of R7) holds (R9 is  stable iff ( R9 * R9 ) c= R9)))
proof
let R7 being non  empty multMagma;
let R9 being (Subset of R7);
thus L345:now
assume L346: R9 is  stable;
L347: (for B191 being set holds (B191 in ( R9 * R9 ) implies B191 in R9))
proof
let C142 being set;
assume L348: C142 in ( R9 * R9 );
consider C143 , C144 being (Element of R7) such that L349: (C142 = ( C143 * C144 ) & C143 in R9 & C144 in R9) by L348 , GROUP_2:8;
thus L350: C142 in R9 by L346 , L349 , L299;
end;
thus L351: ( R9 * R9 ) c= R9 by L347 , TARSKI:def 3;
end;
assume L352: ( R9 * R9 ) c= R9;
L353: (for B192 , B193 being (Element of R7) holds ((B192 in R9 & B193 in R9) implies ( B192 * B193 ) in R9))
proof
let C145 , C146 being (Element of R7);
assume L354: (C145 in R9 & C146 in R9);
L355: ( C145 * C146 ) in ( R9 * R9 ) by L354 , GROUP_2:8;
thus L356: ( C145 * C146 ) in R9 by L355 , L352;
end;
thus L357: R9 is  stable by L353 , L299;
end;
theorem
L358: (for R7 being non  empty multMagma holds (for R8 being non  empty multMagma holds (for R10 being (Function of R7 , R8) holds (for R12 being  stable (Subset of R7) holds (R10 is  multiplicative implies ( R10 .: R12 ) is  stable  stable  stable  stable (Subset of R8))))))
proof
let R7 being non  empty multMagma;
let R8 being non  empty multMagma;
let R10 being (Function of R7 , R8);
let R12 being  stable (Subset of R7);
assume L359: R10 is  multiplicative;
L360: (for B194 , B195 being (Element of R8) holds ((B194 in ( R10 .: R12 ) & B195 in ( R10 .: R12 )) implies ( B194 * B195 ) in ( R10 .: R12 )))
proof
let C147 , C148 being (Element of R8);
assume L361: C147 in ( R10 .: R12 );
consider C149 being set such that L362: (C149 in ( dom R10 ) & C149 in R12 & C147 = ( R10 . C149 )) by L361 , FUNCT_1:def 6;
assume L363: C148 in ( R10 .: R12 );
consider C150 being set such that L364: (C150 in ( dom R10 ) & C150 in R12 & C148 = ( R10 . C150 )) by L363 , FUNCT_1:def 6;
reconsider D50 = C149 , D51 = C150 as (Element of R7) by L362 , L364;
L365: ( D50 * D51 ) in (the carrier of R7);
L366: ( D50 * D51 ) in ( dom R10 ) by L365 , FUNCT_2:def 1;
L367: ( D50 * D51 ) in R12 by L362 , L364 , L299;
L368: ( R10 . ( D50 * D51 ) ) in ( R10 .: R12 ) by L367 , L366 , FUNCT_1:def 6;
thus L369: ( C147 * C148 ) in ( R10 .: R12 ) by L368 , L362 , L364 , L359 , GROUP_6:def 6;
end;
thus L370: ( R10 .: R12 ) is  stable  stable  stable  stable (Subset of R8) by L360 , L299;
end;
theorem
L371: (for R7 being non  empty multMagma holds (for R8 being non  empty multMagma holds (for R10 being (Function of R7 , R8) holds (for R13 being  stable (Subset of R8) holds (R10 is  multiplicative implies ( R10 " R13 ) is  stable  stable  stable  stable (Subset of R7))))))
proof
let R7 being non  empty multMagma;
let R8 being non  empty multMagma;
let R10 being (Function of R7 , R8);
let R13 being  stable (Subset of R8);
assume L372: R10 is  multiplicative;
L373: (for B196 , B197 being (Element of R7) holds ((B196 in ( R10 " R13 ) & B197 in ( R10 " R13 )) implies ( B196 * B197 ) in ( R10 " R13 )))
proof
let C151 , C152 being (Element of R7);
assume L374: C151 in ( R10 " R13 );
L375: (C151 in ( dom R10 ) & ( R10 . C151 ) in R13) by L374 , FUNCT_1:def 7;
assume L376: C152 in ( R10 " R13 );
L377: (C152 in ( dom R10 ) & ( R10 . C152 ) in R13) by L376 , FUNCT_1:def 7;
L378: ( C151 * C152 ) in (the carrier of R7);
L379: ( C151 * C152 ) in ( dom R10 ) by L378 , FUNCT_2:def 1;
L380: ( ( R10 . C151 ) * ( R10 . C152 ) ) in R13 by L375 , L377 , L299;
L381: ( R10 . ( C151 * C152 ) ) in R13 by L380 , L372 , GROUP_6:def 6;
thus L382: ( C151 * C152 ) in ( R10 " R13 ) by L381 , L379 , FUNCT_1:def 7;
end;
thus L383: ( R10 " R13 ) is  stable  stable  stable  stable (Subset of R7) by L373 , L299;
end;
theorem
L384: (for R7 being non  empty multMagma holds (for R8 being non  empty multMagma holds (for R10 being (Function of R7 , R8) holds (for R11 being (Function of R7 , R8) holds ((R10 is  multiplicative & R11 is  multiplicative) implies { B198 where B198 is (Element of R7) : ( R10 . B198 ) = ( R11 . B198 ) } is  stable  stable  stable  stable (Subset of R7))))))
proof
let R7 being non  empty multMagma;
let R8 being non  empty multMagma;
let R10 being (Function of R7 , R8);
let R11 being (Function of R7 , R8);
assume L385: R10 is  multiplicative;
assume L386: R11 is  multiplicative;
set D52 = { B199 where B199 is (Element of R7) : ( R10 . B199 ) = ( R11 . B199 ) };
L387: (for B200 being set holds (B200 in D52 implies B200 in (the carrier of R7)))
proof
let C153 being set;
assume L388: C153 in D52;
consider C154 being (Element of R7) such that L389: (C153 = C154 & ( R10 . C154 ) = ( R11 . C154 )) by L388;
thus L390: C153 in (the carrier of R7) by L389;
end;
reconsider D53 = D52 as (Subset of R7) by L387 , TARSKI:def 3;
L391: (for B201 , B202 being (Element of R7) holds ((B201 in D53 & B202 in D53) implies ( B201 * B202 ) in D53))
proof
let C155 , C156 being (Element of R7);
assume L392: C155 in D53;
consider C157 being (Element of R7) such that L393: (C155 = C157 & ( R10 . C157 ) = ( R11 . C157 )) by L392;
assume L394: C156 in D53;
consider C158 being (Element of R7) such that L395: (C156 = C158 & ( R10 . C158 ) = ( R11 . C158 )) by L394;
L396: ( R10 . ( C155 * C156 ) ) = ( ( R11 . C155 ) * ( R11 . C156 ) ) by L393 , L395 , L385 , GROUP_6:def 6
.= ( R11 . ( C155 * C156 ) ) by L386 , GROUP_6:def 6;
thus L397: ( C155 * C156 ) in D53 by L396;
end;
thus L398: thesis by L391 , L299;
end;
definition
let C159 being multMagma;
let C160 being  stable (Subset of C159);
func the_mult_induced_by C160 -> (BinOp of C160) equals 
( (the multF of C159) || C160 );
correctness
proof
L399: (for B203 being set holds (B203 in [: C160 , C160 :] implies ( (the multF of C159) . B203 ) in C160))
proof
let C161 being set;
assume L400: C161 in [: C160 , C160 :];
consider C162 , C163 being set such that L401: (C162 in C160 & C163 in C160 & C161 = [ C162 , C163 ]) by L400 , ZFMISC_1:def 2;
reconsider D54 = C162 , D55 = C163 as (Element of C159) by L401;
L402: ( D54 * D55 ) in C160 by L401 , L299;
thus L403: ( (the multF of C159) . C161 ) in C160 by L402 , L401 , BINOP_1:def 1;
end;
L404: C160 is (Preserv of (the multF of C159)) by L399 , REALSET1:def 1;
thus L405: thesis by L404 , REALSET1:2;
end;
end;
definition
let C164 being multMagma;
let C165 being (Subset of C164);
func the_submagma_generated_by C165 ->  strict (multSubmagma of C164) means 
:L407: (C165 c= (the carrier of it) & (for B204 being  strict (multSubmagma of C164) holds (C165 c= (the carrier of B204) implies it is (multSubmagma of B204))));
existence
proof
defpred S5[ set ] means (ex B205 being  strict (multSubmagma of C164) st ($1 = (the carrier of B205) & C165 c= $1));
consider C166 being set such that L408: (for B206 being set holds (B206 in C166 iff (B206 in ( bool (the carrier of C164) ) & S5[ B206 ]))) from XBOOLE_0:sch 1;
set D56 = ( id C166 );
set D57 = ( meet ( id C166 ) );
L409: (for B207 being set holds (B207 in ( dom D56 ) implies ( D56 . B207 ) is  stable  stable  stable  stable (Subset of C164)))
proof
let C167 being set;
assume L410: C167 in ( dom D56 );
L411: (C167 in ( bool (the carrier of C164) ) & S5[ C167 ]) by L410 , L408;
thus L412: thesis by L411 , L410 , FUNCT_1:18;
end;
reconsider D58 = D57 as  stable (Subset of C164) by L409 , L312;
set D59 = multMagma (# D58 , ( the_mult_induced_by D58 ) #);
take D59;
per cases ;
suppose L413: C166 = ( {} );

L414: (the carrier of C164) in ( bool (the carrier of C164) ) by ZFMISC_1:def 1;
L415: (ex B208 being  strict (multSubmagma of C164) st ((the carrier of C164) = (the carrier of B208) & C165 c= (the carrier of C164)))
proof
L416: (the multF of C164) = ( (the multF of C164) | [: (the carrier of C164) , (the carrier of C164) :] );
L417: (the multF of C164) = ( (the multF of C164) || (the carrier of C164) ) by L416 , REALSET1:def 2;
reconsider D60 = ( the multMagma of C164 ) as  strict (multSubmagma of C164) by L417 , L273;
take D60;
thus L418: (the carrier of C164) = (the carrier of D60);
thus L419: C165 c= (the carrier of C164);
end;
thus L420: thesis by L415 , L413 , L414 , L408;
end;
suppose L421: C166 <> ( {} );

L422: (for B209 being set holds (B209 in C165 implies B209 in D58))
proof
let C168 being set;
assume L423: C168 in C165;
L424: (for B210 being set holds (B210 in C166 implies C168 in B210))
proof
let C169 being set;
assume L425: C169 in C166;
consider C170 being  strict (multSubmagma of C164) such that L426: (C169 = (the carrier of C170) & C165 c= C169) by L425 , L408;
thus L427: C168 in C169 by L426 , L423;
end;
L428: C168 in ( meet C166 ) by L424 , L421 , SETFAM_1:def 1;
L429: C168 in ( meet ( rng ( id C166 ) ) ) by L428;
thus L430: thesis by L429 , FUNCT_6:def 4;
end;
L431: (for B211 being  strict (multSubmagma of C164) holds (C165 c= (the carrier of B211) implies D59 is (multSubmagma of B211)))
proof
let C171 being  strict (multSubmagma of C164);
assume L432: C165 c= (the carrier of C171);
L433: (for B212 being set holds (B212 in (the carrier of D59) implies B212 in (the carrier of C171)))
proof
let C172 being set;
assume L434: C172 in (the carrier of D59);
L435: C172 in ( meet ( rng ( id C166 ) ) ) by L434 , FUNCT_6:def 4;
L436: C172 in ( meet C166 ) by L435;
L437: (the carrier of C171) c= (the carrier of C164) by L273;
L438: (the carrier of C171) in C166 by L437 , L408 , L432;
thus L439: C172 in (the carrier of C171) by L438 , L436 , SETFAM_1:def 1;
end;
L440: (the carrier of D59) c= (the carrier of C171) by L433 , TARSKI:def 3;
L441: ( (the multF of C164) | [: (the carrier of C171) , (the carrier of C171) :] ) = ( (the multF of C164) || (the carrier of C171) ) by REALSET1:def 2
.= (the multF of C171) by L273;
L442: (the multF of D59) = ( (the multF of C164) | [: (the carrier of D59) , (the carrier of D59) :] ) by REALSET1:def 2
.= ( ( (the multF of C164) | [: (the carrier of C171) , (the carrier of C171) :] ) | [: (the carrier of D59) , (the carrier of D59) :] ) by L440 , RELAT_1:74 , ZFMISC_1:96
.= ( (the multF of C171) || (the carrier of D59) ) by L441 , REALSET1:def 2;
thus L443: D59 is (multSubmagma of C171) by L442 , L440 , L273;
end;
thus L444: thesis by L431 , L422 , L273 , TARSKI:def 3;
end;
end;
uniqueness
proof
let C173 , C174 being  strict (multSubmagma of C164);
assume L446: (C165 c= (the carrier of C173) & (for B213 being  strict (multSubmagma of C164) holds (C165 c= (the carrier of B213) implies C173 is (multSubmagma of B213))) & C165 c= (the carrier of C174) & (for B214 being  strict (multSubmagma of C164) holds (C165 c= (the carrier of B214) implies C174 is (multSubmagma of B214))));
L447: (C173 is (multSubmagma of C174) & C174 is (multSubmagma of C173)) by L446;
thus L448: thesis by L447 , L283;
end;
end;
theorem
L450: (for B215 being multMagma holds (for B216 being (Subset of B215) holds (B216 is  empty iff ( the_submagma_generated_by B216 ) is  empty)))
proof
let C175 being multMagma;
let C176 being (Subset of C175);
thus L451:now
assume L452: C176 is  empty;
L453: (for B217 , B218 being (Element of C175) holds ((B217 in C176 & B218 in C176) implies ( B217 * B218 ) in C176)) by L452;
reconsider D61 = C176 as  stable (Subset of C175) by L453 , L299;
reconsider D62 = multMagma (# D61 , ( the_mult_induced_by D61 ) #) as  strict (multSubmagma of C175) by L273;
L454: ( the_submagma_generated_by C176 ) is (multSubmagma of D62) by L407;
L455: (the carrier of ( the_submagma_generated_by C176 )) c= (the carrier of D62) by L454 , L273;
thus L456: ( the_submagma_generated_by C176 ) is  empty by L455 , L452;
end;
assume L457: ( the_submagma_generated_by C176 ) is  empty;
L458: (the carrier of ( the_submagma_generated_by C176 )) = ( {} ) by L457;
L459: C176 c= ( {} ) by L458 , L407;
thus L460: C176 is  empty by L459;
end;
registration
let C177 being multMagma;
let C178 being  empty (Subset of C177);
cluster ( the_submagma_generated_by C178 ) ->  empty;
correctness by L450;
end;
theorem
L462: (for B219 , B220 being non  empty multMagma holds (for B221 being (Function of B219 , B220) holds (for B222 being (Subset of B219) holds (B221 is  multiplicative implies ( B221 .: (the carrier of ( the_submagma_generated_by B222 )) ) = (the carrier of ( the_submagma_generated_by ( B221 .: B222 ) ))))))
proof
let C179 , C180 being non  empty multMagma;
let C181 being (Function of C179 , C180);
let C182 being (Subset of C179);
assume L463: C181 is  multiplicative;
set D63 = ( the_submagma_generated_by C182 );
set D64 = ( C181 .: (the carrier of D63) );
L464: (the carrier of D63) is  stable  stable  stable  stable (Subset of C179) by L304;
reconsider D65 = D64 as  stable (Subset of C180) by L464 , L463 , L358;
set D66 = ( the_submagma_generated_by ( C181 .: C182 ) );
set D67 = ( C181 " (the carrier of D66) );
L465: (the carrier of D66) is  stable  stable  stable  stable (Subset of C180) by L304;
reconsider D68 = D67 as  stable (Subset of C179) by L465 , L463 , L371;
L466: (( C181 .: C182 ) c= (the carrier of D66) & (for B223 being  strict (multSubmagma of C180) holds (( C181 .: C182 ) c= (the carrier of B223) implies D66 is (multSubmagma of B223)))) by L407;
reconsider D69 = multMagma (# D65 , ( the_mult_induced_by D65 ) #) as  strict (multSubmagma of C180) by L273;
L467: C182 c= (the carrier of D63) by L407;
L468: D66 is (multSubmagma of D69) by L467 , L466 , RELAT_1:123;
L469: (the carrier of D66) c= D65 by L468 , L273;
L470: (C182 c= (the carrier of D63) & (for B224 being  strict (multSubmagma of C179) holds (C182 c= (the carrier of B224) implies D63 is (multSubmagma of B224)))) by L407;
reconsider D70 = multMagma (# D68 , ( the_mult_induced_by D68 ) #) as  strict (multSubmagma of C179) by L273;
L471: ( C181 .: ( C181 " (the carrier of D66) ) ) c= (the carrier of D66) by FUNCT_1:75;
L472: ( C181 .: C182 ) c= (the carrier of ( the_submagma_generated_by ( C181 .: C182 ) )) by L407;
L473: ( C181 " ( C181 .: C182 ) ) c= ( C181 " (the carrier of ( the_submagma_generated_by ( C181 .: C182 ) )) ) by L472 , RELAT_1:143;
L474: C182 c= (the carrier of C179);
L475: C182 c= ( dom C181 ) by L474 , FUNCT_2:def 1;
L476: C182 c= ( C181 " ( C181 .: C182 ) ) by L475 , FUNCT_1:76;
L477: D63 is (multSubmagma of D70) by L476 , L470 , L473 , XBOOLE_1:1;
L478: (the carrier of D63) c= D68 by L477 , L273;
L479: D65 c= ( C181 .: ( C181 " (the carrier of D66) ) ) by L478 , RELAT_1:123;
L480: D65 c= (the carrier of D66) by L479 , L471 , XBOOLE_1:1;
thus L481: thesis by L480 , L469 , XBOOLE_0:def 10;
end;
begin
definition
let C183 being set;
defpred S6[ set , set ] means (for B225 being (XFinSequence of ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) )) holds ($1 = B225 implies ((( dom B225 ) = ( 0 ) implies $2 = ( {} )) & (( dom B225 ) = 1 implies $2 = C183) & (for B226 being Nat holds ((B226 >= 2 & ( dom B225 ) = B226) implies (ex B227 being FinSequence st (( len B227 ) = ( B226 - 1 ) & (for B228 being Nat holds ((B228 >= 1 & B228 <= ( B226 - 1 )) implies ( B227 . B228 ) = [: ( B225 . B228 ) , ( B225 . ( B226 - B228 ) ) :])) & $2 = ( Union ( disjoin B227 ) ))))))));
L482: (for B229 being set holds (B229 in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) implies (ex B230 being set st S6[ B229 , B230 ])))
proof
let C184 being set;
assume L483: C184 in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega );
reconsider D71 = C184 as (XFinSequence of ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) )) by L483 , AFINSQ_1:def 7;
L484: (( dom D71 ) = ( 0 ) or ( ( dom D71 ) + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L485: (( dom D71 ) = ( 0 ) or ( dom D71 ) >= 1) by L484 , NAT_1:13;
L486: (( dom D71 ) = ( 0 ) or ( dom D71 ) = 1 or ( dom D71 ) > 1) by L485 , XXREAL_0:1;
L487: (( dom D71 ) = ( 0 ) or ( dom D71 ) = 1 or ( ( dom D71 ) + 1 ) > ( 1 + 1 )) by L486 , XREAL_1:6;
per cases  by L487 , NAT_1:13;
suppose L488: ( dom D71 ) = ( 0 );

set D72 = ( {} );
take D72;
thus L489: S6[ C184 , D72 ] by L488;
end;
suppose L490: ( dom D71 ) = 1;

set D73 = C183;
take D73;
thus L491: S6[ C184 , D73 ] by L490;
end;
suppose L492: ( dom D71 ) >= 2;

reconsider D74 = ( dom D71 ) as Nat;
reconsider D75 = ( D74 -' 1 ) as Nat;
L493: ( D74 - 1 ) >= ( 2 - 1 ) by L492 , XREAL_1:9;
L494: D75 = ( D74 - 1 ) by L493 , XREAL_0:def 2;
defpred S7[ set , set ] means (for B231 being Nat holds ((B231 >= 1 & B231 <= ( D74 - 1 ) & $1 = B231) implies $2 = [: ( D71 . B231 ) , ( D71 . ( D74 - B231 ) ) :]));
L495: (for B232 being Nat holds (B232 in ( Seg D75 ) implies (ex B233 being set st S7[ B232 , B233 ])))
proof
let C185 being Nat;
assume L496: C185 in ( Seg D75 );
set D76 = [: ( D71 . C185 ) , ( D71 . ( D74 - C185 ) ) :];
take D76;
thus L497: thesis;
end;
consider C186 being FinSequence such that L498: (( dom C186 ) = ( Seg D75 ) & (for B234 being Nat holds (B234 in ( Seg D75 ) implies S7[ B234 , ( C186 . B234 ) ]))) from FINSEQ_1:sch 1(L495);
set D77 = ( Union ( disjoin C186 ) );
take D77;
L499: ( len C186 ) = ( D74 - 1 ) by L494 , L498 , FINSEQ_1:def 3;
L500: (for B235 being Nat holds ((B235 >= 1 & B235 <= ( D74 - 1 )) implies ( C186 . B235 ) = [: ( D71 . B235 ) , ( D71 . ( D74 - B235 ) ) :]))
proof
let C187 being Nat;
assume L501: (C187 >= 1 & C187 <= ( D74 - 1 ));
L502: C187 in ( Seg D75 ) by L501 , L494 , FINSEQ_1:1;
thus L503: ( C186 . C187 ) = [: ( D71 . C187 ) , ( D71 . ( D74 - C187 ) ) :] by L502 , L498 , L501;
end;
thus L504: S6[ C184 , D77 ] by L500 , L492 , L499;
end;
end;
consider C188 being Function such that L506: (( dom C188 ) = ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) & (for B236 being set holds (B236 in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) implies S6[ B236 , ( C188 . B236 ) ]))) from CLASSES1:sch 1(L482);
L507: (for B237 being set holds (B237 in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) implies ( C188 . B237 ) in ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) )))
proof
let C189 being set;
assume L508: C189 in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega );
reconsider D78 = C189 as (XFinSequence of ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) )) by L508 , AFINSQ_1:def 7;
L509: ((( dom D78 ) = ( 0 ) implies ( C188 . C189 ) = ( {} )) & (( dom D78 ) = 1 implies ( C188 . C189 ) = C183) & (for B238 being Nat holds ((B238 >= 2 & ( dom D78 ) = B238) implies (ex B239 being FinSequence st (( len B239 ) = ( B238 - 1 ) & (for B240 being Nat holds ((B240 >= 1 & B240 <= ( B238 - 1 )) implies ( B239 . B240 ) = [: ( D78 . B240 ) , ( D78 . ( B238 - B240 ) ) :])) & ( C188 . C189 ) = ( Union ( disjoin B239 ) )))))) by L508 , L506;
L510: (( dom D78 ) = ( 0 ) or ( ( dom D78 ) + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L511: (( dom D78 ) = ( 0 ) or ( dom D78 ) >= 1) by L510 , NAT_1:13;
L512: (( dom D78 ) = ( 0 ) or ( dom D78 ) = 1 or ( dom D78 ) > 1) by L511 , XXREAL_0:1;
L513: (( dom D78 ) = ( 0 ) or ( dom D78 ) = 1 or ( ( dom D78 ) + 1 ) > ( 1 + 1 )) by L512 , XREAL_1:6;
per cases  by L513 , NAT_1:13;
suppose L514: ( dom D78 ) = ( 0 );

L515: ( {} ) c= ( the_universe_of ( C183 \/ ( NAT ) ) ) by XBOOLE_1:2;
thus L516: ( C188 . C189 ) in ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) by L515 , L514 , L509;
end;
suppose L517: ( dom D78 ) = 1;

L518: ( C188 . C189 ) = C183 by L517 , L508 , L506;
L519: (for B241 being set holds (B241 in C183 implies B241 in ( Tarski-Class ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) )))
proof
let C190 being set;
assume L520: C190 in C183;
L521: C190 c= ( ( union C183 ) \/ ( union ( NAT ) ) ) by L520 , XBOOLE_1:10 , ZFMISC_1:74;
L522: C190 c= ( union ( C183 \/ ( NAT ) ) ) by L521 , ZFMISC_1:78;
L523: ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) in ( Tarski-Class ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) ) by CLASSES1:2;
L524: ( union ( C183 \/ ( NAT ) ) ) c= ( union ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) ) by CLASSES1:52 , ZFMISC_1:77;
L525: ( union ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) ) c= ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) by CLASSES1:48 , CLASSES1:51;
L526: ( union ( C183 \/ ( NAT ) ) ) c= ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) by L525 , L524 , XBOOLE_1:1;
thus L527: thesis by L526 , L523 , L522 , CLASSES1:3 , XBOOLE_1:1;
end;
L528: C183 c= ( Tarski-Class ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) ) by L519 , TARSKI:def 3;
L529: C183 c= ( the_universe_of ( C183 \/ ( NAT ) ) ) by L528 , YELLOW_6:def 1;
thus L530: ( C188 . C189 ) in ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) by L529 , L518;
end;
suppose L531: ( dom D78 ) >= 2;

set D79 = ( dom D78 );
consider C191 being FinSequence such that L532: (( len C191 ) = ( D79 - 1 ) & (for B242 being Nat holds ((B242 >= 1 & B242 <= ( D79 - 1 )) implies ( C191 . B242 ) = [: ( D78 . B242 ) , ( D78 . ( D79 - B242 ) ) :])) & ( C188 . C189 ) = ( Union ( disjoin C191 ) )) by L531 , L508 , L506;
reconsider D80 = ( D79 -' 1 ) as Nat;
L533: ( D79 - 1 ) >= ( 2 - 1 ) by L531 , XREAL_1:9;
L534: D80 = ( D79 - 1 ) by L533 , XREAL_0:def 2;
L535: (for B243 being Nat holds ((B243 >= 1 & B243 <= ( D79 - 1 )) implies ( C191 . B243 ) c= ( the_universe_of ( C183 \/ ( NAT ) ) )))
proof
let C192 being Nat;
assume L536: (C192 >= 1 & C192 <= ( D79 - 1 ));
L537: ( C191 . C192 ) = [: ( D78 . C192 ) , ( D78 . ( D79 - C192 ) ) :] by L536 , L532;
L538: C192 in ( Seg D80 ) by L534 , L536 , FINSEQ_1:1;
L539: (( - C192 ) <= ( - 1 ) & ( - C192 ) >= ( - ( D79 - 1 ) )) by L536 , XREAL_1:24;
L540: (( ( - C192 ) + D79 ) <= ( ( - 1 ) + D79 ) & ( ( - C192 ) + D79 ) >= ( ( - ( D79 - 1 ) ) + D79 )) by L539 , XREAL_1:6;
L541: (( D79 - C192 ) <= ( D79 -' 1 ) & ( D79 - C192 ) >= 1) by L540 , XREAL_0:def 2;
L542: ( D79 - C192 ) = ( D79 -' C192 ) by L540 , XREAL_0:def 2;
L543: ( D79 -' C192 ) in ( Seg D80 ) by L542 , L541 , FINSEQ_1:1;
L544: ( Seg D80 ) c= ( D80 + 1 ) by AFINSQ_1:3;
L545: ( D78 . C192 ) in ( rng D78 ) by L544 , L538 , L534 , FUNCT_1:3;
L546: ( D78 . ( D79 - C192 ) ) in ( rng D78 ) by L542 , L544 , L534 , L543 , FUNCT_1:3;
thus L547: ( C191 . C192 ) c= ( the_universe_of ( C183 \/ ( NAT ) ) ) by L546 , L537 , L545 , L16;
end;
L548: (for B244 being set holds (B244 in ( rng ( disjoin C191 ) ) implies B244 c= ( the_universe_of ( C183 \/ ( NAT ) ) )))
proof
let C193 being set;
assume L549: C193 in ( rng ( disjoin C191 ) );
consider C194 being set such that L550: (C194 in ( dom ( disjoin C191 ) ) & C193 = ( ( disjoin C191 ) . C194 )) by L549 , FUNCT_1:def 3;
L551: C194 in ( dom C191 ) by L550 , CARD_3:def 3;
L552: C193 = [: ( C191 . C194 ) , { C194 } :] by L551 , L550 , CARD_3:def 3;
L553: C194 in ( Seg D80 ) by L532 , L534 , L551 , FINSEQ_1:def 3;
reconsider D81 = C194 as Nat by L551;
L554: (D81 >= 1 & D81 <= ( D79 - 1 )) by L534 , L553 , FINSEQ_1:1;
L555: ( C191 . D81 ) c= ( the_universe_of ( C183 \/ ( NAT ) ) ) by L554 , L535;
L556: (for B245 being set holds (B245 in { D81 } implies B245 in ( NAT )))
proof
let C195 being set;
assume L557: C195 in { D81 };
L558: C195 = D81 by L557 , TARSKI:def 1;
thus L559: C195 in ( NAT ) by L558 , ORDINAL1:def 12;
end;
L560: (for B246 being set holds (B246 in { D81 } implies B246 in ( Tarski-Class ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) )))
proof
let C196 being set;
assume L561: C196 in { D81 };
L562: C196 in ( NAT ) by L561 , L556;
L563: C196 c= ( ( union C183 ) \/ ( union ( NAT ) ) ) by L562 , XBOOLE_1:10 , ZFMISC_1:74;
L564: C196 c= ( union ( C183 \/ ( NAT ) ) ) by L563 , ZFMISC_1:78;
L565: ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) in ( Tarski-Class ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) ) by CLASSES1:2;
L566: ( union ( C183 \/ ( NAT ) ) ) c= ( union ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) ) by CLASSES1:52 , ZFMISC_1:77;
L567: ( union ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) ) c= ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) by CLASSES1:48 , CLASSES1:51;
L568: ( union ( C183 \/ ( NAT ) ) ) c= ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) by L567 , L566 , XBOOLE_1:1;
thus L569: thesis by L568 , L565 , L564 , CLASSES1:3 , XBOOLE_1:1;
end;
L570: { D81 } c= ( Tarski-Class ( the_transitive-closure_of ( C183 \/ ( NAT ) ) ) ) by L560 , TARSKI:def 3;
L571: { D81 } c= ( the_universe_of ( C183 \/ ( NAT ) ) ) by L570 , YELLOW_6:def 1;
thus L572: thesis by L571 , L552 , L555 , L16;
end;
L573: ( union ( rng ( disjoin C191 ) ) ) c= ( the_universe_of ( C183 \/ ( NAT ) ) ) by L548 , ZFMISC_1:76;
L574: ( union ( rng ( disjoin C191 ) ) ) in ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) by L573;
thus L575: thesis by L574 , L532 , CARD_3:def 4;
end;
end;
func free_magma_seq C183 -> (Function of ( NAT ) , ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) )) means 
:L577: (( it . ( 0 ) ) = ( {} ) & ( it . 1 ) = C183 & (for B247 being Nat holds (B247 >= 2 implies (ex B248 being FinSequence st (( len B248 ) = ( B247 - 1 ) & (for B249 being Nat holds ((B249 >= 1 & B249 <= ( B247 - 1 )) implies ( B248 . B249 ) = [: ( it . B249 ) , ( it . ( B247 - B249 ) ) :])) & ( it . B247 ) = ( Union ( disjoin B248 ) ))))));
existence
proof
reconsider D82 = C188 as (Function of ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) , ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) )) by L507 , L506 , FUNCT_2:3;
deffunc H3((XFinSequence of ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ))) = ( D82 . $1 );
consider C197 being (Function of ( NAT ) , ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) )) such that L578: (for B250 being Nat holds ( C197 . B250 ) = H3(( C197 | B250 ))) from FuncRecursiveExist2;
take C197;
L579: ( {} ) in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) by AFINSQ_1:43;
L580: ( dom ( {} ) ) = ( {} );
thus L581: ( C197 . ( 0 ) ) = ( D82 . ( C197 | ( 0 ) ) ) by L578
.= ( {} ) by L579 , L580 , L506;
L582: 1 c= ( NAT );
L583: 1 c= ( dom C197 ) by L582 , FUNCT_2:def 1;
L584: ( dom ( C197 | 1 ) ) = 1 by L583 , RELAT_1:62;
L585: ( C197 | 1 ) in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) by AFINSQ_1:42;
thus L586: ( C197 . 1 ) = ( D82 . ( C197 | 1 ) ) by L578
.= C183 by L584 , L585 , L506;
let C198 being Nat;
assume L587: C198 >= 2;
L588: C198 c= ( NAT );
L589: C198 c= ( dom C197 ) by L588 , FUNCT_2:def 1;
L590: ( dom ( C197 | C198 ) ) = C198 by L589 , RELAT_1:62;
L591: ( C197 | C198 ) in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) by AFINSQ_1:42;
consider C199 being FinSequence such that L592: (( len C199 ) = ( C198 - 1 ) & (for B251 being Nat holds ((B251 >= 1 & B251 <= ( C198 - 1 )) implies ( C199 . B251 ) = [: ( ( C197 | C198 ) . B251 ) , ( ( C197 | C198 ) . ( C198 - B251 ) ) :])) & ( D82 . ( C197 | C198 ) ) = ( Union ( disjoin C199 ) )) by L591 , L587 , L590 , L506;
take C199;
thus L593: ( len C199 ) = ( C198 - 1 ) by L592;
thus L594: (for B252 being Nat holds ((B252 >= 1 & B252 <= ( C198 - 1 )) implies ( C199 . B252 ) = [: ( C197 . B252 ) , ( C197 . ( C198 - B252 ) ) :]))
proof
let C200 being Nat;
assume L595: (C200 >= 1 & C200 <= ( C198 - 1 ));
set D83 = ( C198 -' 1 );
L596: ( C198 - 1 ) >= ( 2 - 1 ) by L587 , XREAL_1:9;
L597: D83 = ( C198 - 1 ) by L596 , XREAL_0:def 2;
L598: C200 in ( Seg D83 ) by L597 , L595 , FINSEQ_1:1;
L599: ( Seg D83 ) c= ( D83 + 1 ) by AFINSQ_1:3;
L600: ( ( C197 | C198 ) . C200 ) = ( C197 . C200 ) by L599 , L597 , L598 , FUNCT_1:49;
L601: (( - C200 ) <= ( - 1 ) & ( - C200 ) >= ( - ( C198 - 1 ) )) by L595 , XREAL_1:24;
L602: (( ( - C200 ) + C198 ) <= ( ( - 1 ) + C198 ) & ( ( - C200 ) + C198 ) >= ( ( - ( C198 - 1 ) ) + C198 )) by L601 , XREAL_1:6;
L603: (( C198 - C200 ) <= ( C198 -' 1 ) & ( C198 - C200 ) >= 1) by L602 , XREAL_0:def 2;
L604: ( C198 - C200 ) = ( C198 -' C200 ) by L602 , XREAL_0:def 2;
L605: ( C198 -' C200 ) in ( Seg D83 ) by L604 , L603 , FINSEQ_1:1;
L606: ( Seg D83 ) c= ( D83 + 1 ) by AFINSQ_1:3;
thus L607: ( C199 . C200 ) = [: ( ( C197 | C198 ) . C200 ) , ( ( C197 | C198 ) . ( C198 - C200 ) ) :] by L595 , L592
.= [: ( C197 . C200 ) , ( C197 . ( C198 - C200 ) ) :] by L600 , L606 , L604 , L597 , L605 , FUNCT_1:49;
end;

thus L608: ( C197 . C198 ) = ( Union ( disjoin C199 ) ) by L592 , L578;
end;
uniqueness
proof
let C201 , C202 being (Function of ( NAT ) , ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ));
assume L609: ( C201 . ( 0 ) ) = ( {} );
assume L610: ( C201 . 1 ) = C183;
assume L611: (for B253 being Nat holds (B253 >= 2 implies (ex B254 being FinSequence st (( len B254 ) = ( B253 - 1 ) & (for B255 being Nat holds ((B255 >= 1 & B255 <= ( B253 - 1 )) implies ( B254 . B255 ) = [: ( C201 . B255 ) , ( C201 . ( B253 - B255 ) ) :])) & ( C201 . B253 ) = ( Union ( disjoin B254 ) )))));
assume L612: ( C202 . ( 0 ) ) = ( {} );
assume L613: ( C202 . 1 ) = C183;
assume L614: (for B256 being Nat holds (B256 >= 2 implies (ex B257 being FinSequence st (( len B257 ) = ( B256 - 1 ) & (for B258 being Nat holds ((B258 >= 1 & B258 <= ( B256 - 1 )) implies ( B257 . B258 ) = [: ( C202 . B258 ) , ( C202 . ( B256 - B258 ) ) :])) & ( C202 . B256 ) = ( Union ( disjoin B257 ) )))));
L615: ( {} ) in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) by AFINSQ_1:43;
L616: (S6[ ( {} ) , ( C188 . ( {} ) ) ] & ( {} ) is (XFinSequence of ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ))) by L615 , L506 , AFINSQ_1:42;
L617: ( dom ( {} ) ) = ( {} );
reconsider D84 = C188 as (Function of ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) , ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) )) by L507 , L506 , FUNCT_2:3;
deffunc H4((XFinSequence of ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ))) = ( D84 . $1 );
L618: (for B259 being Nat holds ( C201 . B259 ) = H4(( C201 | B259 )))
proof
let C203 being Nat;
L619: (C203 = ( 0 ) or ( C203 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L620: (C203 = ( 0 ) or C203 >= 1) by L619 , NAT_1:13;
L621: (C203 = ( 0 ) or C203 = 1 or C203 > 1) by L620 , XXREAL_0:1;
L622: (C203 = ( 0 ) or C203 = 1 or ( C203 + 1 ) > ( 1 + 1 )) by L621 , XREAL_1:6;
per cases  by L622 , NAT_1:13;
suppose L623: C203 = ( 0 );

thus L624: ( C201 . C203 ) = ( D84 . ( {} ) ) by L623 , L616 , L617 , L609
.= H4(( C201 | C203 )) by L623;
end;
suppose L625: C203 = 1;

L626: 1 c= ( NAT );
L627: 1 c= ( dom C201 ) by L626 , FUNCT_2:def 1;
L628: ( dom ( C201 | 1 ) ) = 1 by L627 , RELAT_1:62;
L629: ( C201 | 1 ) in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) by AFINSQ_1:42;
thus L630: ( C201 . C203 ) = H4(( C201 | C203 )) by L629 , L625 , L628 , L506 , L610;
end;
suppose L631: C203 >= 2;

L632: C203 c= ( NAT );
L633: C203 c= ( dom C201 ) by L632 , FUNCT_2:def 1;
L634: ( dom ( C201 | C203 ) ) = C203 by L633 , RELAT_1:62;
L635: ( C201 | C203 ) in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) by AFINSQ_1:42;
consider C204 being FinSequence such that L636: (( len C204 ) = ( C203 - 1 ) & (for B260 being Nat holds ((B260 >= 1 & B260 <= ( C203 - 1 )) implies ( C204 . B260 ) = [: ( ( C201 | C203 ) . B260 ) , ( ( C201 | C203 ) . ( C203 - B260 ) ) :])) & ( D84 . ( C201 | C203 ) ) = ( Union ( disjoin C204 ) )) by L635 , L631 , L634 , L506;
consider C205 being FinSequence such that L637: (( len C205 ) = ( C203 - 1 ) & (for B261 being Nat holds ((B261 >= 1 & B261 <= ( C203 - 1 )) implies ( C205 . B261 ) = [: ( C201 . B261 ) , ( C201 . ( C203 - B261 ) ) :])) & ( C201 . C203 ) = ( Union ( disjoin C205 ) )) by L631 , L611;
L638: (for B262 being Nat holds ((1 <= B262 & B262 <= ( len C204 )) implies ( C204 . B262 ) = ( C205 . B262 )))
proof
let C206 being Nat;
assume L639: (1 <= C206 & C206 <= ( len C204 ));
L640: ( C204 . C206 ) = [: ( ( C201 | C203 ) . C206 ) , ( ( C201 | C203 ) . ( C203 - C206 ) ) :] by L639 , L636;
L641: ( C205 . C206 ) = [: ( C201 . C206 ) , ( C201 . ( C203 - C206 ) ) :] by L639 , L636 , L637;
set D85 = ( C203 -' 1 );
L642: ( C203 - 1 ) >= ( 2 - 1 ) by L631 , XREAL_1:9;
L643: D85 = ( C203 - 1 ) by L642 , XREAL_0:def 2;
L644: C206 in ( Seg D85 ) by L643 , L639 , L636 , FINSEQ_1:1;
L645: ( Seg D85 ) c= ( D85 + 1 ) by AFINSQ_1:3;
L646: (( - C206 ) <= ( - 1 ) & ( - C206 ) >= ( - ( C203 - 1 ) )) by L639 , L636 , XREAL_1:24;
L647: (( ( - C206 ) + C203 ) <= ( ( - 1 ) + C203 ) & ( ( - C206 ) + C203 ) >= ( ( - ( C203 - 1 ) ) + C203 )) by L646 , XREAL_1:6;
L648: (( C203 - C206 ) <= ( C203 -' 1 ) & ( C203 - C206 ) >= 1) by L647 , XREAL_0:def 2;
L649: ( C203 - C206 ) = ( C203 -' C206 ) by L647 , XREAL_0:def 2;
L650: ( C203 -' C206 ) in ( Seg D85 ) by L649 , L648 , FINSEQ_1:1;
L651: ( Seg D85 ) c= ( D85 + 1 ) by AFINSQ_1:3;
L652: ( ( C201 | C203 ) . ( C203 - C206 ) ) = ( C201 . ( C203 - C206 ) ) by L651 , L649 , L643 , L650 , FUNCT_1:49;
thus L653: ( C204 . C206 ) = ( C205 . C206 ) by L652 , L645 , L640 , L641 , L643 , L644 , FUNCT_1:49;
end;
thus L654: ( C201 . C203 ) = H4(( C201 | C203 )) by L638 , L636 , L637 , FINSEQ_1:14;
end;
end;
L656: (for B263 being Nat holds ( C202 . B263 ) = H4(( C202 | B263 )))
proof
let C207 being Nat;
L657: (C207 = ( 0 ) or ( C207 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L658: (C207 = ( 0 ) or C207 >= 1) by L657 , NAT_1:13;
L659: (C207 = ( 0 ) or C207 = 1 or C207 > 1) by L658 , XXREAL_0:1;
L660: (C207 = ( 0 ) or C207 = 1 or ( C207 + 1 ) > ( 1 + 1 )) by L659 , XREAL_1:6;
per cases  by L660 , NAT_1:13;
suppose L661: C207 = ( 0 );

thus L662: ( C202 . C207 ) = ( D84 . ( {} ) ) by L661 , L616 , L617 , L612
.= H4(( C202 | C207 )) by L661;
end;
suppose L663: C207 = 1;

L664: 1 c= ( NAT );
L665: 1 c= ( dom C202 ) by L664 , FUNCT_2:def 1;
L666: ( dom ( C202 | 1 ) ) = 1 by L665 , RELAT_1:62;
L667: ( C202 | 1 ) in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) by AFINSQ_1:42;
thus L668: ( C202 . C207 ) = H4(( C202 | C207 )) by L667 , L666 , L506 , L663 , L613;
end;
suppose L669: C207 >= 2;

L670: C207 c= ( NAT );
L671: C207 c= ( dom C202 ) by L670 , FUNCT_2:def 1;
L672: ( dom ( C202 | C207 ) ) = C207 by L671 , RELAT_1:62;
L673: ( C202 | C207 ) in ( ( bool ( the_universe_of ( C183 \/ ( NAT ) ) ) ) ^omega ) by AFINSQ_1:42;
consider C208 being FinSequence such that L674: (( len C208 ) = ( C207 - 1 ) & (for B264 being Nat holds ((B264 >= 1 & B264 <= ( C207 - 1 )) implies ( C208 . B264 ) = [: ( ( C202 | C207 ) . B264 ) , ( ( C202 | C207 ) . ( C207 - B264 ) ) :])) & ( D84 . ( C202 | C207 ) ) = ( Union ( disjoin C208 ) )) by L673 , L669 , L672 , L506;
consider C209 being FinSequence such that L675: (( len C209 ) = ( C207 - 1 ) & (for B265 being Nat holds ((B265 >= 1 & B265 <= ( C207 - 1 )) implies ( C209 . B265 ) = [: ( C202 . B265 ) , ( C202 . ( C207 - B265 ) ) :])) & ( C202 . C207 ) = ( Union ( disjoin C209 ) )) by L669 , L614;
L676: (for B266 being Nat holds ((1 <= B266 & B266 <= ( len C208 )) implies ( C208 . B266 ) = ( C209 . B266 )))
proof
let C210 being Nat;
assume L677: (1 <= C210 & C210 <= ( len C208 ));
L678: ( C208 . C210 ) = [: ( ( C202 | C207 ) . C210 ) , ( ( C202 | C207 ) . ( C207 - C210 ) ) :] by L677 , L674;
L679: ( C209 . C210 ) = [: ( C202 . C210 ) , ( C202 . ( C207 - C210 ) ) :] by L677 , L674 , L675;
set D86 = ( C207 -' 1 );
L680: ( C207 - 1 ) >= ( 2 - 1 ) by L669 , XREAL_1:9;
L681: D86 = ( C207 - 1 ) by L680 , XREAL_0:def 2;
L682: C210 in ( Seg D86 ) by L681 , L677 , L674 , FINSEQ_1:1;
L683: ( Seg D86 ) c= ( D86 + 1 ) by AFINSQ_1:3;
L684: (( - C210 ) <= ( - 1 ) & ( - C210 ) >= ( - ( C207 - 1 ) )) by L677 , L674 , XREAL_1:24;
L685: (( ( - C210 ) + C207 ) <= ( ( - 1 ) + C207 ) & ( ( - C210 ) + C207 ) >= ( ( - ( C207 - 1 ) ) + C207 )) by L684 , XREAL_1:6;
L686: (( C207 - C210 ) <= ( C207 -' 1 ) & ( C207 - C210 ) >= 1) by L685 , XREAL_0:def 2;
L687: ( C207 - C210 ) = ( C207 -' C210 ) by L685 , XREAL_0:def 2;
L688: ( C207 -' C210 ) in ( Seg D86 ) by L687 , L686 , FINSEQ_1:1;
L689: ( Seg D86 ) c= ( D86 + 1 ) by AFINSQ_1:3;
L690: ( ( C202 | C207 ) . ( C207 - C210 ) ) = ( C202 . ( C207 - C210 ) ) by L689 , L688 , L687 , L681 , FUNCT_1:49;
thus L691: ( C208 . C210 ) = ( C209 . C210 ) by L690 , L683 , L678 , L679 , L681 , L682 , FUNCT_1:49;
end;
thus L692: ( C202 . C207 ) = H4(( C202 | C207 )) by L676 , L675 , L674 , FINSEQ_1:14;
end;
end;
L694: C201 = C202 from FuncRecursiveUniqu2(L618 , L656);
thus L695: thesis by L694;
end;
end;
definition
let C211 being set;
let C212 being Nat;
func free_magma (C211 , C212) equals 
( ( free_magma_seq C211 ) . C212 );
correctness;
end;
registration
let C213 being non  empty set;
let C214 being non  zero Nat;
cluster ( free_magma (C213 , C214) ) -> non  empty;
correctness
proof
defpred S8[ Nat ] means ($1 = ( 0 ) or ( ( free_magma_seq C213 ) . $1 ) <> ( {} ));
L698: (for B267 being Nat holds ((for B268 being Nat holds (B268 < B267 implies S8[ B268 ])) implies S8[ B267 ]))
proof
let C215 being Nat;
assume L699: (for B269 being Nat holds (B269 < C215 implies S8[ B269 ]));
L700: (C215 = ( 0 ) or ( C215 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L701: (C215 = ( 0 ) or C215 >= 1) by L700 , NAT_1:13;
L702: (C215 = ( 0 ) or C215 = 1 or C215 > 1) by L701 , XXREAL_0:1;
L703: (C215 = ( 0 ) or C215 = 1 or ( C215 + 1 ) > ( 1 + 1 )) by L702 , XREAL_1:6;
per cases  by L703 , NAT_1:13;
suppose L704: C215 = ( 0 );

thus L705: S8[ C215 ] by L704;
end;
suppose L706: C215 = 1;

thus L707: S8[ C215 ] by L706 , L577;
end;
suppose L708: C215 >= 2;

consider C216 being FinSequence such that L709: (( len C216 ) = ( C215 - 1 ) & (for B270 being Nat holds ((B270 >= 1 & B270 <= ( C215 - 1 )) implies ( C216 . B270 ) = [: ( ( free_magma_seq C213 ) . B270 ) , ( ( free_magma_seq C213 ) . ( C215 - B270 ) ) :])) & ( ( free_magma_seq C213 ) . C215 ) = ( Union ( disjoin C216 ) )) by L708 , L577;
L710: ( 2 - 1 ) <= ( C215 - 1 ) by L708 , XREAL_1:9;
L711: 1 in ( Seg ( len C216 ) ) by L710 , L709 , FINSEQ_1:1;
L712: 1 in ( dom C216 ) by L711 , FINSEQ_1:def 3;
L713: 1 in ( dom ( disjoin C216 ) ) by L712 , CARD_3:def 3;
L714: ( ( disjoin C216 ) . 1 ) = [: ( C216 . 1 ) , { 1 } :] by L712 , CARD_3:def 3;
L715: ( C216 . 1 ) = [: ( ( free_magma_seq C213 ) . 1 ) , ( ( free_magma_seq C213 ) . ( C215 - 1 ) ) :] by L709 , L710;
L716: ( 1 + 1 ) <= ( ( C215 - 1 ) + 1 ) by L708;
L717: 1 < C215 by L716 , NAT_1:13;
L718: ( ( free_magma_seq C213 ) . 1 ) <> ( {} ) by L717 , L699;
L719: ( ( - 1 ) + C215 ) < ( ( 0 ) + C215 ) by XREAL_1:8;
L720: ( C215 - 1 ) in ( NAT ) by L710 , INT_1:3;
reconsider D87 = ( C215 - 1 ) as Nat by L720;
L721: ( ( free_magma_seq C213 ) . D87 ) <> ( {} ) by L719 , L710 , L699;
consider C217 being set such that L722: C217 in [: ( C216 . 1 ) , { 1 } :] by L721 , L718 , L715 , XBOOLE_0:def 1;
L723: [: ( C216 . 1 ) , { 1 } :] c= ( union ( rng ( disjoin C216 ) ) ) by L714 , L713 , FUNCT_1:3 , ZFMISC_1:74;
thus L724: S8[ C215 ] by L723 , L722 , L709 , CARD_3:def 4;
end;
end;
L726: (for B271 being Nat holds S8[ B271 ]) from NAT_1:sch 4(L698);
thus L727: thesis by L726;
end;
end;
theorem
L729: (for R14 being set holds ( free_magma (R14 , ( 0 )) ) = ( {} )) by L577;
theorem
L730: (for R14 being set holds ( free_magma (R14 , 1) ) = R14) by L577;
theorem
L731: (for R14 being set holds ( free_magma (R14 , 2) ) = [: [: R14 , R14 :] , { 1 } :])
proof
let R14 being set;
consider C218 being FinSequence such that L732: (( len C218 ) = ( 2 - 1 ) & (for B272 being Nat holds ((B272 >= 1 & B272 <= ( 2 - 1 )) implies ( C218 . B272 ) = [: ( ( free_magma_seq R14 ) . B272 ) , ( ( free_magma_seq R14 ) . ( 2 - B272 ) ) :])) & ( ( free_magma_seq R14 ) . 2 ) = ( Union ( disjoin C218 ) )) by L577;
L733: ( C218 . 1 ) = [: ( ( free_magma_seq R14 ) . 1 ) , ( ( free_magma_seq R14 ) . ( 2 - 1 ) ) :] by L732
.= [: ( free_magma (R14 , 1) ) , R14 :] by L577
.= [: R14 , R14 :] by L577;
L734: C218 = <* [: R14 , R14 :] *> by L733 , L732 , FINSEQ_1:40;
L735: (for B273 being set holds (B273 in ( union ( rng ( disjoin C218 ) ) ) iff B273 in [: [: R14 , R14 :] , { 1 } :]))
proof
let C219 being set;
thus L736:now
assume L737: C219 in ( union ( rng ( disjoin C218 ) ) );
consider C220 being set such that L738: (C219 in C220 & C220 in ( rng ( disjoin C218 ) )) by L737 , TARSKI:def 4;
consider C221 being set such that L739: (C221 in ( dom ( disjoin C218 ) ) & C220 = ( ( disjoin C218 ) . C221 )) by L738 , FUNCT_1:def 3;
L740: C221 in ( dom C218 ) by L739 , CARD_3:def 3;
L741: C221 in ( Seg 1 ) by L740 , L734 , FINSEQ_1:38;
L742: C221 = 1 by L741 , FINSEQ_1:2 , TARSKI:def 1;
thus L743: C219 in [: [: R14 , R14 :] , { 1 } :] by L742 , L738 , L733 , L739 , L740 , CARD_3:def 3;
end;
assume L744: C219 in [: [: R14 , R14 :] , { 1 } :];
L745: 1 in ( Seg 1 ) by FINSEQ_1:1;
L746: 1 in ( dom C218 ) by L745 , L734 , FINSEQ_1:38;
L747: 1 in ( dom ( disjoin C218 ) ) by L746 , CARD_3:def 3;
L748: [: [: R14 , R14 :] , { 1 } :] = ( ( disjoin C218 ) . 1 ) by L733 , L746 , CARD_3:def 3;
L749: [: [: R14 , R14 :] , { 1 } :] in ( rng ( disjoin C218 ) ) by L748 , L747 , FUNCT_1:def 3;
thus L750: C219 in ( union ( rng ( disjoin C218 ) ) ) by L749 , L744 , TARSKI:def 4;
end;
thus L751: ( free_magma (R14 , 2) ) = ( union ( rng ( disjoin C218 ) ) ) by L732 , CARD_3:def 4
.= [: [: R14 , R14 :] , { 1 } :] by L735 , TARSKI:1;
end;
theorem
L752: (for R14 being set holds ( free_magma (R14 , 3) ) = ( [: [: R14 , [: [: R14 , R14 :] , { 1 } :] :] , { 1 } :] \/ [: [: [: [: R14 , R14 :] , { 1 } :] , R14 :] , { 2 } :] ))
proof
let R14 being set;
set D88 = [: [: R14 , [: [: R14 , R14 :] , { 1 } :] :] , { 1 } :];
set D89 = [: [: [: [: R14 , R14 :] , { 1 } :] , R14 :] , { 2 } :];
consider C222 being FinSequence such that L753: (( len C222 ) = ( 3 - 1 ) & (for B274 being Nat holds ((B274 >= 1 & B274 <= ( 3 - 1 )) implies ( C222 . B274 ) = [: ( ( free_magma_seq R14 ) . B274 ) , ( ( free_magma_seq R14 ) . ( 3 - B274 ) ) :])) & ( ( free_magma_seq R14 ) . 3 ) = ( Union ( disjoin C222 ) )) by L577;
L754: ( C222 . 1 ) = [: ( free_magma (R14 , 1) ) , ( free_magma (R14 , 2) ) :] by L753
.= [: ( free_magma (R14 , 1) ) , [: [: R14 , R14 :] , { 1 } :] :] by L731
.= [: R14 , [: [: R14 , R14 :] , { 1 } :] :] by L577;
L755: ( C222 . 2 ) = [: ( ( free_magma_seq R14 ) . 2 ) , ( ( free_magma_seq R14 ) . ( 3 - 2 ) ) :] by L753
.= [: ( free_magma (R14 , 2) ) , R14 :] by L577
.= [: [: [: R14 , R14 :] , { 1 } :] , R14 :] by L731;
L756: (for B275 being set holds (B275 in ( union ( rng ( disjoin C222 ) ) ) iff (B275 in D88 or B275 in D89)))
proof
let C223 being set;
thus L757:now
assume L758: C223 in ( union ( rng ( disjoin C222 ) ) );
consider C224 being set such that L759: (C223 in C224 & C224 in ( rng ( disjoin C222 ) )) by L758 , TARSKI:def 4;
consider C225 being set such that L760: (C225 in ( dom ( disjoin C222 ) ) & C224 = ( ( disjoin C222 ) . C225 )) by L759 , FUNCT_1:def 3;
L761: C225 in ( dom C222 ) by L760 , CARD_3:def 3;
L762: C225 in { 1 , 2 } by L761 , L753 , FINSEQ_1:2 , FINSEQ_1:def 3;
L763: (C225 = 1 or C225 = 2) by L762 , TARSKI:def 2;
thus L764: (C223 in D88 or C223 in D89) by L763 , L754 , L755 , L759 , L760 , L761 , CARD_3:def 3;
end;
assume L765: (C223 in D88 or C223 in D89);
L766: (1 in ( Seg 2 ) & 2 in ( Seg 2 )) by FINSEQ_1:1;
L767: (1 in ( dom C222 ) & 2 in ( dom C222 )) by L766 , L753 , FINSEQ_1:def 3;
L768: (1 in ( dom ( disjoin C222 ) ) & 2 in ( dom ( disjoin C222 ) )) by L767 , CARD_3:def 3;
L769: (D88 = ( ( disjoin C222 ) . 1 ) & D89 = ( ( disjoin C222 ) . 2 )) by L754 , L755 , L767 , CARD_3:def 3;
L770: (D88 in ( rng ( disjoin C222 ) ) & D89 in ( rng ( disjoin C222 ) )) by L769 , L768 , FUNCT_1:def 3;
thus L771: C223 in ( union ( rng ( disjoin C222 ) ) ) by L770 , L765 , TARSKI:def 4;
end;
thus L772: ( free_magma (R14 , 3) ) = ( union ( rng ( disjoin C222 ) ) ) by L753 , CARD_3:def 4
.= ( [: [: R14 , [: [: R14 , R14 :] , { 1 } :] :] , { 1 } :] \/ [: [: [: [: R14 , R14 :] , { 1 } :] , R14 :] , { 2 } :] ) by L756 , XBOOLE_0:def 3;
end;
theorem
L773: (for R14 being set holds (for R18 being Nat holds (R18 >= 2 implies (ex B276 being FinSequence st (( len B276 ) = ( R18 - 1 ) & (for R20 being Nat holds ((R20 >= 1 & R20 <= ( R18 - 1 )) implies ( B276 . R20 ) = [: ( free_magma (R14 , R20) ) , ( free_magma (R14 , ( R18 -' R20 )) ) :])) & ( free_magma (R14 , R18) ) = ( Union ( disjoin B276 ) ))))))
proof
let R14 being set;
let R18 being Nat;
assume L774: R18 >= 2;
consider C226 being FinSequence such that L775: (( len C226 ) = ( R18 - 1 ) & (for R20 being Nat holds ((R20 >= 1 & R20 <= ( R18 - 1 )) implies ( C226 . R20 ) = [: ( ( free_magma_seq R14 ) . R20 ) , ( ( free_magma_seq R14 ) . ( R18 - R20 ) ) :])) & ( ( free_magma_seq R14 ) . R18 ) = ( Union ( disjoin C226 ) )) by L774 , L577;
take C226;
thus L776: ( len C226 ) = ( R18 - 1 ) by L775;
thus L777: (for R20 being Nat holds ((R20 >= 1 & R20 <= ( R18 - 1 )) implies ( C226 . R20 ) = [: ( free_magma (R14 , R20) ) , ( free_magma (R14 , ( R18 -' R20 )) ) :]))
proof
let R20 being Nat;
assume L778: (R20 >= 1 & R20 <= ( R18 - 1 ));
L779: (( - R20 ) <= ( - 1 ) & ( - R20 ) >= ( - ( R18 - 1 ) )) by L778 , XREAL_1:24;
L780: (( ( - R20 ) + R18 ) <= ( ( - 1 ) + R18 ) & ( ( - R20 ) + R18 ) >= ( ( - ( R18 - 1 ) ) + R18 )) by L779 , XREAL_1:6;
L781: ( R18 - R20 ) = ( R18 -' R20 ) by L780 , XREAL_0:def 2;
thus L782: thesis by L781 , L778 , L775;
end;

thus L783: ( free_magma (R14 , R18) ) = ( Union ( disjoin C226 ) ) by L775;
end;
theorem
L784: (for R14 being set holds (for R15 being set holds (for R18 being Nat holds ((R18 >= 2 & R15 in ( free_magma (R14 , R18) )) implies (ex R20 being Nat st (ex R19 being Nat st (( R15 `2 ) = R20 & 1 <= R20 & R20 <= ( R18 - 1 ) & ( ( R15 `1 ) `1 ) in ( free_magma (R14 , R20) ) & ( ( R15 `1 ) `2 ) in ( free_magma (R14 , R19) ) & R18 = ( R20 + R19 ) & R15 in [: [: ( free_magma (R14 , R20) ) , ( free_magma (R14 , R19) ) :] , { R20 } :])))))))
proof
let R14 being set;
let R15 being set;
let R18 being Nat;
assume L785: R18 >= 2;
assume L786: R15 in ( free_magma (R14 , R18) );
consider C227 being FinSequence such that L787: ( len C227 ) = ( R18 - 1 ) and L788: (for R20 being Nat holds ((R20 >= 1 & R20 <= ( R18 - 1 )) implies ( C227 . R20 ) = [: ( ( free_magma_seq R14 ) . R20 ) , ( ( free_magma_seq R14 ) . ( R18 - R20 ) ) :])) and L789: ( ( free_magma_seq R14 ) . R18 ) = ( Union ( disjoin C227 ) ) by L785 , L577;
L790: R15 in ( union ( rng ( disjoin C227 ) ) ) by L786 , L789 , CARD_3:def 4;
consider C228 being set such that L791: (R15 in C228 & C228 in ( rng ( disjoin C227 ) )) by L790 , TARSKI:def 4;
consider C229 being set such that L792: (C229 in ( dom ( disjoin C227 ) ) & C228 = ( ( disjoin C227 ) . C229 )) by L791 , FUNCT_1:def 3;
L793: C229 in ( dom C227 ) by L792 , CARD_3:def 3;
reconsider D90 = C229 as Nat by L793;
L794: D90 in ( Seg ( len C227 ) ) by L793 , FINSEQ_1:def 3;
L795: (1 <= D90 & D90 <= ( len C227 )) by L794 , FINSEQ_1:1;
L796: ( C227 . D90 ) = [: ( ( free_magma_seq R14 ) . D90 ) , ( ( free_magma_seq R14 ) . ( R18 - D90 ) ) :] by L795 , L787 , L788;
L797: R15 in [: [: ( ( free_magma_seq R14 ) . D90 ) , ( ( free_magma_seq R14 ) . ( R18 - D90 ) ) :] , { D90 } :] by L796 , L791 , L792 , L793 , CARD_3:def 3;
L798: (( R15 `1 ) in [: ( ( free_magma_seq R14 ) . D90 ) , ( ( free_magma_seq R14 ) . ( R18 - D90 ) ) :] & ( R15 `2 ) in { D90 }) by L797 , MCART_1:10;
L799: ( - D90 ) >= ( - ( R18 - 1 ) ) by L795 , L787 , XREAL_1:24;
L800: ( ( - D90 ) + R18 ) >= ( ( - ( R18 - 1 ) ) + R18 ) by L799 , XREAL_1:7;
L801: ( R18 - D90 ) in ( NAT ) by L800 , INT_1:3;
reconsider D91 = ( R18 - D90 ) as Nat by L801;
take D90;
take D91;
thus L802: thesis by L787 , L794 , L791 , L796 , L792 , L793 , L798 , CARD_3:def 3 , FINSEQ_1:1 , MCART_1:10 , TARSKI:def 1;
end;
theorem
L803: (for R14 being set holds (for R15 being set holds (for R16 being set holds (for R18 being Nat holds (for R19 being Nat holds ((R15 in ( free_magma (R14 , R18) ) & R16 in ( free_magma (R14 , R19) )) implies [ [ R15 , R16 ] , R18 ] in ( free_magma (R14 , ( R18 + R19 )) )))))))
proof
let R14 being set;
let R15 being set;
let R16 being set;
let R18 being Nat;
let R19 being Nat;
assume L804: R15 in ( free_magma (R14 , R18) );
assume L805: R16 in ( free_magma (R14 , R19) );
per cases ;
suppose L806: (R18 = ( 0 ) or R19 = ( 0 ));

thus L807: thesis by L806 , L577 , L804 , L805;
end;
suppose L808: (R18 <> ( 0 ) & R19 <> ( 0 ));

L809: (R18 >= ( ( 0 ) + 1 ) & R19 >= ( ( 0 ) + 1 )) by L808 , NAT_1:13;
L810: ( R18 + R19 ) >= ( 1 + 1 ) by L809 , XREAL_1:7;
consider C230 being FinSequence such that L811: (( len C230 ) = ( ( R18 + R19 ) - 1 ) & (for R20 being Nat holds ((R20 >= 1 & R20 <= ( ( R18 + R19 ) - 1 )) implies ( C230 . R20 ) = [: ( ( free_magma_seq R14 ) . R20 ) , ( ( free_magma_seq R14 ) . ( ( R18 + R19 ) - R20 ) ) :])) & ( ( free_magma_seq R14 ) . ( R18 + R19 ) ) = ( Union ( disjoin C230 ) )) by L810 , L577;
L812: ( 1 - 1 ) <= ( R19 - 1 ) by L809 , XREAL_1:9;
L813: ( ( 0 ) + R18 ) <= ( ( R19 - 1 ) + R18 ) by L812 , XREAL_1:7;
L814: ( C230 . R18 ) = [: ( ( free_magma_seq R14 ) . R18 ) , ( ( free_magma_seq R14 ) . ( ( R18 + R19 ) - R18 ) ) :] by L813 , L811 , L809
.= [: ( ( free_magma_seq R14 ) . R18 ) , ( ( free_magma_seq R14 ) . R19 ) :];
L815: [ R15 , R16 ] in ( C230 . R18 ) by L814 , L804 , L805 , ZFMISC_1:def 2;
L816: R18 in { R18 } by TARSKI:def 1;
L817: [ [ R15 , R16 ] , R18 ] in [: ( C230 . R18 ) , { R18 } :] by L816 , L815 , ZFMISC_1:def 2;
L818: R18 in ( Seg ( len C230 ) ) by L811 , L809 , L813 , FINSEQ_1:1;
L819: R18 in ( dom C230 ) by L818 , FINSEQ_1:def 3;
L820: ( ( disjoin C230 ) . R18 ) = [: ( C230 . R18 ) , { R18 } :] by L819 , CARD_3:def 3;
L821: R18 in ( dom ( disjoin C230 ) ) by L819 , CARD_3:def 3;
L822: [: ( C230 . R18 ) , { R18 } :] in ( rng ( disjoin C230 ) ) by L821 , L820 , FUNCT_1:3;
L823: [ [ R15 , R16 ] , R18 ] in ( union ( rng ( disjoin C230 ) ) ) by L822 , L817 , TARSKI:def 4;
thus L824: [ [ R15 , R16 ] , R18 ] in ( free_magma (R14 , ( R18 + R19 )) ) by L823 , L811 , CARD_3:def 4;
end;
end;
theorem
L826: (for R14 being set holds (for R17 being set holds (for R18 being Nat holds (R14 c= R17 implies ( free_magma (R14 , R18) ) c= ( free_magma (R17 , R18) )))))
proof
let R14 being set;
let R17 being set;
let R18 being Nat;
defpred S9[ Nat ] means (R14 c= R17 implies ( free_magma (R14 , $1) ) c= ( free_magma (R17 , $1) ));
L827: (for B277 being Nat holds ((for B278 being Nat holds (B278 < B277 implies S9[ B278 ])) implies S9[ B277 ]))
proof
let C231 being Nat;
assume L828: (for B279 being Nat holds (B279 < C231 implies S9[ B279 ]));
thus L829: (R14 c= R17 implies ( free_magma (R14 , C231) ) c= ( free_magma (R17 , C231) ))
proof
assume L830: R14 c= R17;
L831: (C231 = ( 0 ) or ( C231 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L832: (C231 = ( 0 ) or C231 >= 1) by L831 , NAT_1:13;
L833: (C231 = ( 0 ) or C231 = 1 or C231 > 1) by L832 , XXREAL_0:1;
L834: (C231 = ( 0 ) or C231 = 1 or ( C231 + 1 ) > ( 1 + 1 )) by L833 , XREAL_1:6;
per cases  by L834 , NAT_1:13;
suppose L835: C231 = ( 0 );

L836: (( free_magma (R14 , C231) ) = ( {} ) & ( free_magma (R17 , C231) ) = ( {} )) by L835 , L577;
thus L837: ( free_magma (R14 , C231) ) c= ( free_magma (R17 , C231) ) by L836;
end;
suppose L838: C231 = 1;

L839: (( free_magma (R14 , C231) ) = R14 & ( free_magma (R17 , C231) ) = R17) by L838 , L577;
thus L840: ( free_magma (R14 , C231) ) c= ( free_magma (R17 , C231) ) by L839 , L830;
end;
suppose L841: C231 >= 2;

L842: (for R15 being set holds (R15 in ( free_magma (R14 , C231) ) implies R15 in ( free_magma (R17 , C231) )))
proof
let R15 being set;
assume L843: R15 in ( free_magma (R14 , C231) );
consider C232 , C233 being Nat such that L844: (( R15 `2 ) = C232 & 1 <= C232 & C232 <= ( C231 - 1 ) & ( ( R15 `1 ) `1 ) in ( free_magma (R14 , C232) ) & ( ( R15 `1 ) `2 ) in ( free_magma (R14 , C233) ) & C231 = ( C232 + C233 ) & R15 in [: [: ( free_magma (R14 , C232) ) , ( free_magma (R14 , C233) ) :] , { C232 } :]) by L843 , L841 , L784;
consider C234 being FinSequence such that L845: (( len C234 ) = ( C231 - 1 ) & (for B280 being Nat holds ((B280 >= 1 & B280 <= ( C231 - 1 )) implies ( C234 . B280 ) = [: ( free_magma (R17 , B280) ) , ( free_magma (R17 , ( C231 -' B280 )) ) :])) & ( free_magma (R17 , C231) ) = ( Union ( disjoin C234 ) )) by L841 , L773;
L846: ( C234 . C232 ) = [: ( free_magma (R17 , C232) ) , ( free_magma (R17 , ( C231 -' C232 )) ) :] by L844 , L845;
L847: (( R15 `1 ) in [: ( free_magma (R14 , C232) ) , ( free_magma (R14 , C233) ) :] & ( R15 `2 ) in { C232 }) by L844 , MCART_1:10;
L848: R15 = [ ( R15 `1 ) , ( R15 `2 ) ] by L844 , MCART_1:21;
L849: ( R15 `1 ) = [ ( ( R15 `1 ) `1 ) , ( ( R15 `1 ) `2 ) ] by L847 , MCART_1:21;
L850: ( C232 + 1 ) <= ( ( C231 - 1 ) + 1 ) by L844 , XREAL_1:7;
L851: C232 < C231 by L850 , NAT_1:13;
L852: ( free_magma (R14 , C232) ) c= ( free_magma (R17 , C232) ) by L851 , L828 , L830;
L853: ( C232 - C232 ) < ( C231 - C232 ) by L851 , XREAL_1:14;
L854: ( C231 -' C232 ) = C233 by L853 , L844 , XREAL_0:def 2;
L855: ( C232 + C233 ) > ( ( 0 ) + C233 ) by L844 , XREAL_1:8;
L856: ( free_magma (R14 , C233) ) c= ( free_magma (R17 , ( C231 -' C232 )) ) by L855 , L844 , L828 , L830 , L854;
L857: ( R15 `1 ) in [: ( free_magma (R17 , C232) ) , ( free_magma (R17 , ( C231 -' C232 )) ) :] by L856 , L844 , L849 , L852 , MCART_1:11;
L858: R15 in [: ( C234 . C232 ) , { C232 } :] by L857 , L846 , L848 , L847 , MCART_1:11;
L859: C232 in ( Seg ( len C234 ) ) by L844 , L845 , FINSEQ_1:1;
L860: C232 in ( dom C234 ) by L859 , FINSEQ_1:def 3;
L861: ( ( disjoin C234 ) . C232 ) = [: ( C234 . C232 ) , { C232 } :] by L860 , CARD_3:def 3;
L862: C232 in ( dom ( disjoin C234 ) ) by L860 , CARD_3:def 3;
L863: [: ( C234 . C232 ) , { C232 } :] in ( rng ( disjoin C234 ) ) by L862 , L861 , FUNCT_1:3;
L864: R15 in ( union ( rng ( disjoin C234 ) ) ) by L863 , L858 , TARSKI:def 4;
thus L865: R15 in ( free_magma (R17 , C231) ) by L864 , L845 , CARD_3:def 4;
end;
thus L866: ( free_magma (R14 , C231) ) c= ( free_magma (R17 , C231) ) by L842 , TARSKI:def 3;
end;
end;

end;
L830: (for B281 being Nat holds S9[ B281 ]) from NAT_1:sch 4(L827);
thus L831: thesis by L830;
end;
definition
let C235 being set;
func free_magma_carrier C235 equals 
( Union ( disjoin ( ( free_magma_seq C235 ) | ( NATPLUS ) ) ) );
correctness;
end;
L833: (for R14 being set holds (for R18 being Nat holds (R18 > ( 0 ) implies [: ( free_magma (R14 , R18) ) , { R18 } :] c= ( free_magma_carrier R14 ))))
proof
let R14 being set;
let R18 being Nat;
assume L834: R18 > ( 0 );
L835: (for B282 being set holds (B282 in [: ( free_magma (R14 , R18) ) , { R18 } :] implies B282 in ( free_magma_carrier R14 )))
proof
let C236 being set;
assume L836: C236 in [: ( free_magma (R14 , R18) ) , { R18 } :];
L837: R18 in ( NAT ) by ORDINAL1:def 12;
L838: R18 in ( dom ( free_magma_seq R14 ) ) by L837 , FUNCT_2:def 1;
L839: R18 in ( NATPLUS ) by L834 , NAT_LAT:def 6;
L840: R18 in ( dom ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) by L839 , L838 , RELAT_1:57;
L841: ( ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) . R18 ) = [: ( ( ( free_magma_seq R14 ) | ( NATPLUS ) ) . R18 ) , { R18 } :] by L840 , CARD_3:def 3
.= [: ( ( free_magma_seq R14 ) . R18 ) , { R18 } :] by L840 , FUNCT_1:47;
L842: R18 in ( dom ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) ) by L840 , CARD_3:def 3;
L843: [: ( free_magma (R14 , R18) ) , { R18 } :] in ( rng ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) ) by L842 , L841 , FUNCT_1:3;
L844: C236 in ( union ( rng ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) ) ) by L843 , L836 , TARSKI:def 4;
thus L845: C236 in ( free_magma_carrier R14 ) by L844 , CARD_3:def 4;
end;
thus L846: thesis by L835 , TARSKI:def 3;
end;
theorem
L847: (for R14 being set holds (R14 = ( {} ) iff ( free_magma_carrier R14 ) = ( {} )))
proof
let R14 being set;
thus L848:now
assume L849: R14 = ( {} );
defpred S10[ Nat ] means ( ( free_magma_seq R14 ) . $1 ) = ( {} );
L850: (for B283 being Nat holds ((for B284 being Nat holds (B284 < B283 implies S10[ B284 ])) implies S10[ B283 ]))
proof
let C237 being Nat;
assume L851: (for B285 being Nat holds (B285 < C237 implies S10[ B285 ]));
L852: (C237 = ( 0 ) or ( C237 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L853: (C237 = ( 0 ) or C237 >= 1) by L852 , NAT_1:13;
L854: (C237 = ( 0 ) or C237 = 1 or C237 > 1) by L853 , XXREAL_0:1;
L855: (C237 = ( 0 ) or C237 = 1 or ( C237 + 1 ) > ( 1 + 1 )) by L854 , XREAL_1:6;
per cases  by L855 , NAT_1:13;
suppose L856: C237 = ( 0 );

thus L857: S10[ C237 ] by L856 , L577;
end;
suppose L858: C237 = 1;

thus L859: S10[ C237 ] by L858 , L849 , L577;
end;
suppose L860: C237 >= 2;

consider C238 being FinSequence such that L861: (( len C238 ) = ( C237 - 1 ) & (for B286 being Nat holds ((B286 >= 1 & B286 <= ( C237 - 1 )) implies ( C238 . B286 ) = [: ( ( free_magma_seq R14 ) . B286 ) , ( ( free_magma_seq R14 ) . ( C237 - B286 ) ) :])) & ( ( free_magma_seq R14 ) . C237 ) = ( Union ( disjoin C238 ) )) by L860 , L577;
L862: (for B287 being set holds (B287 in ( rng ( disjoin C238 ) ) implies B287 c= ( {} )))
proof
let C239 being set;
assume L863: C239 in ( rng ( disjoin C238 ) );
consider C240 being set such that L864: (C240 in ( dom ( disjoin C238 ) ) & C239 = ( ( disjoin C238 ) . C240 )) by L863 , FUNCT_1:def 3;
L865: C240 in ( dom C238 ) by L864 , CARD_3:def 3;
L866: C240 in ( Seg ( len C238 ) ) by L865 , FINSEQ_1:def 3;
reconsider D92 = C240 as Nat by L865;
L867: (D92 >= 1 & D92 <= ( C237 - 1 )) by L861 , L866 , FINSEQ_1:1;
L868: ( D92 + 1 ) <= ( ( C237 - 1 ) + 1 ) by L867 , XREAL_1:7;
L869: D92 < C237 by L868 , NAT_1:13;
L870: ( ( free_magma_seq R14 ) . D92 ) = ( {} ) by L869 , L851;
L871: ( C238 . D92 ) = [: ( ( free_magma_seq R14 ) . D92 ) , ( ( free_magma_seq R14 ) . ( C237 - D92 ) ) :] by L861 , L867
.= ( {} ) by L870 , ZFMISC_1:90;
L872: ( ( disjoin C238 ) . D92 ) = [: ( C238 . D92 ) , { D92 } :] by L865 , CARD_3:def 3
.= ( {} ) by L871 , ZFMISC_1:90;
thus L873: C239 c= ( {} ) by L872 , L864;
end;
L874: ( union ( rng ( disjoin C238 ) ) ) c= ( {} ) by L862 , ZFMISC_1:76;
thus L875: S10[ C237 ] by L874 , L861 , CARD_3:def 4;
end;
end;
L877: (for B288 being Nat holds S10[ B288 ]) from NAT_1:sch 4(L850);
L878: (for B289 being set holds (B289 in ( rng ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) ) implies B289 c= ( {} )))
proof
let C241 being set;
assume L879: C241 in ( rng ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) );
consider C242 being set such that L880: (C242 in ( dom ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) ) & C241 = ( ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) . C242 )) by L879 , FUNCT_1:def 3;
L881: C242 in ( dom ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) by L880 , CARD_3:def 3;
reconsider D93 = C242 as Nat by L881;
L882: D93 in ( dom ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) by L880 , CARD_3:def 3;
L883: ( ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) . D93 ) = [: ( ( ( free_magma_seq R14 ) | ( NATPLUS ) ) . D93 ) , { D93 } :] by L881 , CARD_3:def 3
.= [: ( ( free_magma_seq R14 ) . D93 ) , { D93 } :] by L882 , FUNCT_1:47
.= [: ( {} ) , { D93 } :] by L877
.= ( {} ) by ZFMISC_1:90;
thus L884: C241 c= ( {} ) by L883 , L880;
end;
L885: ( union ( rng ( disjoin ( ( free_magma_seq R14 ) | ( NATPLUS ) ) ) ) ) c= ( {} ) by L878 , ZFMISC_1:76;
thus L886: ( free_magma_carrier R14 ) = ( {} ) by L885 , CARD_3:def 4;
end;
assume L887: ( free_magma_carrier R14 ) = ( {} );
L888: [: ( free_magma (R14 , 1) ) , { 1 } :] c= ( free_magma_carrier R14 ) by L833;
thus L889: R14 = ( {} ) by L888 , L887;
end;
registration
let C243 being  empty set;
cluster ( free_magma_carrier C243 ) ->  empty;
correctness by L847;
end;
registration
let C244 being non  empty set;
cluster ( free_magma_carrier C244 ) -> non  empty;
correctness by L847;
let C245 being (Element of ( free_magma_carrier C244 ));
cluster ( C245 `2 ) -> non  zero  natural for number;
correctness
proof
L891: C245 in ( free_magma_carrier C244 );
L892: C245 in ( union ( rng ( disjoin ( ( free_magma_seq C244 ) | ( NATPLUS ) ) ) ) ) by L891 , CARD_3:def 4;
consider C246 being set such that L893: (C245 in C246 & C246 in ( rng ( disjoin ( ( free_magma_seq C244 ) | ( NATPLUS ) ) ) )) by L892 , TARSKI:def 4;
consider C247 being set such that L894: (C247 in ( dom ( disjoin ( ( free_magma_seq C244 ) | ( NATPLUS ) ) ) ) & C246 = ( ( disjoin ( ( free_magma_seq C244 ) | ( NATPLUS ) ) ) . C247 )) by L893 , FUNCT_1:def 3;
L895: C247 in ( dom ( ( free_magma_seq C244 ) | ( NATPLUS ) ) ) by L894 , CARD_3:def 3;
L896: C247 in ( NATPLUS ) by L895 , RELAT_1:57;
reconsider D94 = C247 as non  zero Nat by L896;
L897: C245 in [: ( ( ( free_magma_seq C244 ) | ( NATPLUS ) ) . D94 ) , { D94 } :] by L894 , L893 , L895 , CARD_3:def 3;
L898: ( C245 `2 ) in { D94 } by L897 , MCART_1:10;
thus L899: thesis by L898 , TARSKI:def 1;
end;
end;
theorem
L901: (for B290 being non  empty set holds (for B291 being (Element of ( free_magma_carrier B290 )) holds B291 in [: ( free_magma (B290 , ( B291 `2 )) ) , { ( B291 `2 ) } :]))
proof
let C248 being non  empty set;
let C249 being (Element of ( free_magma_carrier C248 ));
L902: C249 in ( free_magma_carrier C248 );
L903: C249 in ( union ( rng ( disjoin ( ( free_magma_seq C248 ) | ( NATPLUS ) ) ) ) ) by L902 , CARD_3:def 4;
consider C250 being set such that L904: (C249 in C250 & C250 in ( rng ( disjoin ( ( free_magma_seq C248 ) | ( NATPLUS ) ) ) )) by L903 , TARSKI:def 4;
consider C251 being set such that L905: (C251 in ( dom ( disjoin ( ( free_magma_seq C248 ) | ( NATPLUS ) ) ) ) & C250 = ( ( disjoin ( ( free_magma_seq C248 ) | ( NATPLUS ) ) ) . C251 )) by L904 , FUNCT_1:def 3;
L906: C251 in ( dom ( ( free_magma_seq C248 ) | ( NATPLUS ) ) ) by L905 , CARD_3:def 3;
L907: ( ( ( free_magma_seq C248 ) | ( NATPLUS ) ) . C251 ) = ( ( free_magma_seq C248 ) . C251 ) by L906 , FUNCT_1:47;
reconsider D95 = C251 as Nat by L906;
L908: C249 in [: ( ( ( free_magma_seq C248 ) | ( NATPLUS ) ) . D95 ) , { D95 } :] by L905 , L904 , L906 , CARD_3:def 3;
L909: ( C249 `2 ) in { D95 } by L908 , MCART_1:10;
L910: ( C249 `2 ) = D95 by L909 , TARSKI:def 1;
thus L911: C249 in [: ( free_magma (C248 , ( C249 `2 )) ) , { ( C249 `2 ) } :] by L910 , L907 , L905 , L904 , L906 , CARD_3:def 3;
end;
theorem
L912: (for B292 being non  empty set holds (for B293 , B294 being (Element of ( free_magma_carrier B292 )) holds [ [ [ ( B293 `1 ) , ( B294 `1 ) ] , ( B293 `2 ) ] , ( ( B293 `2 ) + ( B294 `2 ) ) ] is (Element of ( free_magma_carrier B292 ))))
proof
let C252 being non  empty set;
let C253 , C254 being (Element of ( free_magma_carrier C252 ));
L913: C253 in [: ( free_magma (C252 , ( C253 `2 )) ) , { ( C253 `2 ) } :] by L901;
L914: ( C253 `1 ) in ( free_magma (C252 , ( C253 `2 )) ) by L913 , MCART_1:10;
L915: C254 in [: ( free_magma (C252 , ( C254 `2 )) ) , { ( C254 `2 ) } :] by L901;
L916: ( C254 `1 ) in ( free_magma (C252 , ( C254 `2 )) ) by L915 , MCART_1:10;
L917: [ [ ( C253 `1 ) , ( C254 `1 ) ] , ( C253 `2 ) ] in ( free_magma (C252 , ( ( C253 `2 ) + ( C254 `2 ) )) ) by L916 , L914 , L803;
L918: ( ( C253 `2 ) + ( C254 `2 ) ) in { ( ( C253 `2 ) + ( C254 `2 ) ) } by TARSKI:def 1;
set D96 = [ [ [ ( C253 `1 ) , ( C254 `1 ) ] , ( C253 `2 ) ] , ( ( C253 `2 ) + ( C254 `2 ) ) ];
L919: ( D96 `1 ) in ( free_magma (C252 , ( ( C253 `2 ) + ( C254 `2 ) )) ) by L917;
L920: ( D96 `2 ) in { ( ( C253 `2 ) + ( C254 `2 ) ) } by L918;
L921: D96 in [: ( free_magma (C252 , ( ( C253 `2 ) + ( C254 `2 ) )) ) , { ( ( C253 `2 ) + ( C254 `2 ) ) } :] by L920 , L919 , MCART_1:11;
L922: [: ( free_magma (C252 , ( ( C253 `2 ) + ( C254 `2 ) )) ) , { ( ( C253 `2 ) + ( C254 `2 ) ) } :] c= ( free_magma_carrier C252 ) by L833;
thus L923: thesis by L922 , L921;
end;
theorem
L924: (for R14 being set holds (for R17 being set holds (R14 c= R17 implies ( free_magma_carrier R14 ) c= ( free_magma_carrier R17 ))))
proof
let R14 being set;
let R17 being set;
assume L925: R14 c= R17;
per cases ;
suppose L926: R14 = ( {} );

L927: ( free_magma_carrier R14 ) = ( {} ) by L926;
thus L928: ( free_magma_carrier R14 ) c= ( free_magma_carrier R17 ) by L927 , XBOOLE_1:2;
end;
suppose L929: R14 <> ( {} );

L930: (for R15 being set holds (R15 in ( free_magma_carrier R14 ) implies R15 in ( free_magma_carrier R17 )))
proof
let R15 being set;
assume L931: R15 in ( free_magma_carrier R14 );
reconsider D97 = R14 as non  empty set by L929;
reconsider D98 = R15 as (Element of ( free_magma_carrier D97 )) by L931;
L932: D98 in [: ( free_magma (D97 , ( D98 `2 )) ) , { ( D98 `2 ) } :] by L901;
L933: (( D98 `1 ) in ( free_magma (D97 , ( D98 `2 )) ) & ( D98 `2 ) in { ( D98 `2 ) }) by L932 , MCART_1:10;
reconsider D99 = R17 as non  empty set by L929 , L925;
L934: ( free_magma (D97 , ( D98 `2 )) ) c= ( free_magma (D99 , ( D98 `2 )) ) by L925 , L826;
L935: D98 = [ ( D98 `1 ) , ( D98 `2 ) ] by L932 , MCART_1:21;
L936: D98 in [: ( free_magma (D99 , ( D98 `2 )) ) , { ( D98 `2 ) } :] by L935 , L934 , L933 , ZFMISC_1:def 2;
L937: [: ( free_magma (D99 , ( D98 `2 )) ) , { ( D98 `2 ) } :] c= ( free_magma_carrier D99 ) by L833;
thus L938: R15 in ( free_magma_carrier R17 ) by L937 , L936;
end;
thus L939: ( free_magma_carrier R14 ) c= ( free_magma_carrier R17 ) by L930 , TARSKI:def 3;
end;
end;
theorem
L941: (for R14 being set holds (for R18 being Nat holds (R18 > ( 0 ) implies [: ( free_magma (R14 , R18) ) , { R18 } :] c= ( free_magma_carrier R14 )))) by L833;
definition
let C255 being set;
func free_magma_mult C255 -> (BinOp of ( free_magma_carrier C255 )) means 
:L942: (for B295 , B296 being (Element of ( free_magma_carrier C255 )) holds (for R18 being Nat holds (for R19 being Nat holds ((R18 = ( B295 `2 ) & R19 = ( B296 `2 )) implies ( it . (B295 , B296) ) = [ [ [ ( B295 `1 ) , ( B296 `1 ) ] , ( B295 `2 ) ] , ( R18 + R19 ) ])))) if C255 is non  empty otherwise it = ( {} );
correctness
proof
L943: (C255 is non  empty implies (ex B297 being (BinOp of ( free_magma_carrier C255 )) st (for B298 , B299 being (Element of ( free_magma_carrier C255 )) holds (for R18 being Nat holds (for R19 being Nat holds ((R18 = ( B298 `2 ) & R19 = ( B299 `2 )) implies ( B297 . (B298 , B299) ) = [ [ [ ( B298 `1 ) , ( B299 `1 ) ] , ( B298 `2 ) ] , ( R18 + R19 ) ]))))))
proof
assume L944: C255 is non  empty;
defpred S11[ set , set , set ] means (for R18 being Nat holds (for R19 being Nat holds ((R18 = ( $1 `2 ) & R19 = ( $2 `2 )) implies $3 = [ [ [ ( $1 `1 ) , ( $2 `1 ) ] , ( $1 `2 ) ] , ( R18 + R19 ) ])));
reconsider D100 = ( free_magma_carrier C255 ) as non  empty set by L944;
L945: (for B300 being (Element of D100) holds (for B301 being (Element of D100) holds (ex B302 being (Element of D100) st S11[ B300 , B301 , B302 ])))
proof
let C256 being (Element of D100);
let C257 being (Element of D100);
reconsider D101 = C255 as non  empty set by L944;
reconsider D102 = C256 as (Element of ( free_magma_carrier D101 ));
reconsider D103 = C257 as (Element of ( free_magma_carrier D101 ));
reconsider D104 = [ [ [ ( D102 `1 ) , ( D103 `1 ) ] , ( D102 `2 ) ] , ( ( D102 `2 ) + ( D103 `2 ) ) ] as (Element of D100) by L912;
take D104;
thus L946: thesis;
end;
consider C258 being (Function of [: D100 , D100 :] , D100) such that L947: (for B303 being (Element of D100) holds (for B304 being (Element of D100) holds S11[ B303 , B304 , ( C258 . (B303 , B304) ) ])) from BINOP_1:sch 3(L945);
reconsider D105 = C258 as (BinOp of ( free_magma_carrier C255 ));
take D105;
thus L948: thesis by L947;
end;
L949: (C255 is  empty implies (ex B305 being (BinOp of ( free_magma_carrier C255 )) st B305 = ( {} )))
proof
assume L950: C255 is  empty;
L951: ( free_magma_carrier C255 ) = ( {} ) by L950;
L952: ( {} ) c= [: (( {} ) qua set) , (( {} ) qua set) :] by ZFMISC_1:90;
reconsider D106 = ( {} ) as (Relation of [: (( {} ) qua set) , (( {} ) qua set) :] , ( {} )) by L952 , ZFMISC_1:90;
L953: (([: (( {} ) qua set) , (( {} ) qua set) :] = ( {} ) implies ( {} ) = ( {} )) & ( dom D106 ) = [: (( {} ) qua set) , (( {} ) qua set) :]) by ZFMISC_1:90;
reconsider D107 = ( {} ) as (BinOp of ( {} )) by L953 , FUNCT_2:def 1;
L954: (for B306 , B307 being (Element of ( free_magma_carrier C255 )) holds (for R18 being Nat holds (for R19 being Nat holds ((R18 = ( B306 `2 ) & R19 = ( B307 `2 ) & B306 in ( free_magma_carrier C255 ) & B307 in ( free_magma_carrier C255 )) implies ( D107 . (B306 , B307) ) = [ [ [ ( B306 `1 ) , ( B307 `1 ) ] , ( B306 `2 ) ] , ( R18 + R19 ) ])))) by L950;
thus L955: thesis by L954 , L951;
end;
L956:
now
let C259 , C260 being (BinOp of ( free_magma_carrier C255 ));
thus L957: ((C255 is non  empty & (for B308 , B309 being (Element of ( free_magma_carrier C255 )) holds (for R18 being Nat holds (for R19 being Nat holds ((R18 = ( B308 `2 ) & R19 = ( B309 `2 )) implies ( C259 . (B308 , B309) ) = [ [ [ ( B308 `1 ) , ( B309 `1 ) ] , ( B308 `2 ) ] , ( R18 + R19 ) ])))) & (for B310 , B311 being (Element of ( free_magma_carrier C255 )) holds (for R18 being Nat holds (for R19 being Nat holds ((R18 = ( B310 `2 ) & R19 = ( B311 `2 )) implies ( C260 . (B310 , B311) ) = [ [ [ ( B310 `1 ) , ( B311 `1 ) ] , ( B310 `2 ) ] , ( R18 + R19 ) ]))))) implies C259 = C260)
proof
assume L958: C255 is non  empty;
assume L959: (for B312 , B313 being (Element of ( free_magma_carrier C255 )) holds (for R18 being Nat holds (for R19 being Nat holds ((R18 = ( B312 `2 ) & R19 = ( B313 `2 )) implies ( C259 . (B312 , B313) ) = [ [ [ ( B312 `1 ) , ( B313 `1 ) ] , ( B312 `2 ) ] , ( R18 + R19 ) ]))));
assume L960: (for B314 , B315 being (Element of ( free_magma_carrier C255 )) holds (for R18 being Nat holds (for R19 being Nat holds ((R18 = ( B314 `2 ) & R19 = ( B315 `2 )) implies ( C260 . (B314 , B315) ) = [ [ [ ( B314 `1 ) , ( B315 `1 ) ] , ( B314 `2 ) ] , ( R18 + R19 ) ]))));
L961: (for B316 , B317 being (Element of ( free_magma_carrier C255 )) holds ( C259 . (B316 , B317) ) = ( C260 . (B316 , B317) ))
proof
let C261 , C262 being (Element of ( free_magma_carrier C255 ));
set D108 = ( C261 `2 );
set D109 = ( C262 `2 );
reconsider D110 = D108 , D111 = D109 as Nat by L958;
thus L962: ( C259 . (C261 , C262) ) = [ [ [ ( C261 `1 ) , ( C262 `1 ) ] , ( C261 `2 ) ] , ( D110 + D111 ) ] by L959
.= ( C260 . (C261 , C262) ) by L960;
end;
thus L963: C259 = C260 by L961 , BINOP_1:2;
end;

assume L964: (C255 is  empty & C259 = ( {} ) & C260 = ( {} ));
thus L965: thesis by L964;
end;
thus L966: thesis by L956 , L943 , L949;
end;
end;
definition
let C263 being set;
func free_magma C263 -> multMagma equals 
multMagma (# ( free_magma_carrier C263 ) , ( free_magma_mult C263 ) #);
correctness;
end;
registration
let C264 being set;
cluster ( free_magma C264 ) ->  strict;
correctness;
end;
registration
let C265 being  empty set;
cluster ( free_magma C265 ) ->  empty;
correctness;
end;
registration
let C266 being non  empty set;
cluster ( free_magma C266 ) -> non  empty;
correctness;
let C267 being (Element of ( free_magma C266 ));
cluster ( C267 `2 ) -> non  zero  natural for number;
correctness;
end;
theorem
L972: (for B318 being set holds (for B319 being (Subset of B318) holds ( free_magma B319 ) is (multSubmagma of ( free_magma B318 ))))
proof
let C268 being set;
let C269 being (Subset of C268);
L973: (the carrier of ( free_magma C269 )) c= (the carrier of ( free_magma C268 )) by L924;
reconsider D112 = (the carrier of ( free_magma C269 )) as set;
L974: ( (the multF of ( free_magma C268 )) | [: D112 , D112 :] ) = ( (the multF of ( free_magma C268 )) || (the carrier of ( free_magma C269 )) ) by REALSET1:def 2;
per cases ;
suppose L975: C269 is  empty;

L976: (the carrier of ( free_magma C269 )) = ( {} ) by L975;
L977: (the multF of ( free_magma C269 )) = ( (the multF of ( free_magma C268 )) | ( {} ) ) by L975
.= ( (the multF of ( free_magma C268 )) | [: D112 , D112 :] ) by L976 , ZFMISC_1:90;
thus L978: thesis by L977 , L974 , L973 , L273;
end;
suppose L979: (not C269 is  empty);

L980: ( dom (the multF of ( free_magma C269 )) ) = [: D112 , D112 :] by L979 , FUNCT_2:def 1;
L981: C268 is non  empty by L979;
L982: [: D112 , D112 :] c= [: ( free_magma_carrier C268 ) , ( free_magma_carrier C268 ) :] by L973 , ZFMISC_1:96;
L983: [: D112 , D112 :] c= ( dom (the multF of ( free_magma C268 )) ) by L982 , L981 , FUNCT_2:def 1;
L984: ( dom (the multF of ( free_magma C269 )) ) = ( dom ( (the multF of ( free_magma C268 )) || (the carrier of ( free_magma C269 )) ) ) by L983 , L980 , L974 , RELAT_1:62;
L985: (for B320 being set holds (B320 in ( dom (the multF of ( free_magma C269 )) ) implies ( (the multF of ( free_magma C269 )) . B320 ) = ( ( (the multF of ( free_magma C268 )) || (the carrier of ( free_magma C269 )) ) . B320 )))
proof
let C270 being set;
assume L986: C270 in ( dom (the multF of ( free_magma C269 )) );
consider R15 being set, R16 being set such that L987: (R15 in D112 & R16 in D112 & C270 = [ R15 , R16 ]) by L986 , ZFMISC_1:def 2;
reconsider D113 = R15 , D114 = R16 as (Element of ( free_magma_carrier C269 )) by L987;
reconsider D115 = ( D113 `2 ) , D116 = ( D114 `2 ) as Nat by L979;
reconsider D117 = D113 , D118 = D114 as (Element of ( free_magma_carrier C268 )) by L987 , L973;
L988: ( (the multF of ( free_magma C269 )) . C270 ) = ( (the multF of ( free_magma C269 )) . (D113 , D114) ) by L987 , BINOP_1:def 1
.= [ [ [ ( D113 `1 ) , ( D114 `1 ) ] , ( D113 `2 ) ] , ( D115 + D116 ) ] by L979 , L942
.= ( ( free_magma_mult C268 ) . (D117 , D118) ) by L981 , L942
.= ( (the multF of ( free_magma C268 )) . C270 ) by L987 , BINOP_1:def 1
.= ( ( (the multF of ( free_magma C268 )) | [: D112 , D112 :] ) . C270 ) by L986 , FUNCT_1:49;
thus L989: thesis by L988 , REALSET1:def 2;
end;
L990: (the multF of ( free_magma C269 )) = ( (the multF of ( free_magma C268 )) || (the carrier of ( free_magma C269 )) ) by L985 , L984 , FUNCT_1:2;
thus L991: ( free_magma C269 ) is (multSubmagma of ( free_magma C268 )) by L990 , L973 , L273;
end;
end;
definition
let C271 being set;
let C272 being (Element of ( free_magma C271 ));
func length C272 -> Nat equals 
:L993: ( C272 `2 ) if C271 is non  empty otherwise ( 0 );
correctness;
end;
theorem
L995: (for R14 being set holds R14 = { ( B321 `1 ) where B321 is (Element of ( free_magma R14 )) : ( length B321 ) = 1 })
proof
let R14 being set;
L996: (for B322 being set holds (B322 in R14 iff B322 in { ( B323 `1 ) where B323 is (Element of ( free_magma R14 )) : ( length B323 ) = 1 }))
proof
let C273 being set;
thus L997:now
assume L998: C273 in R14;
L999: C273 in ( free_magma (R14 , 1) ) by L998 , L577;
L1000: 1 in { 1 } by TARSKI:def 1;
L1001: [ C273 , 1 ] in [: ( free_magma (R14 , 1) ) , { 1 } :] by L1000 , L999 , ZFMISC_1:def 2;
L1002: [: ( free_magma (R14 , 1) ) , { 1 } :] c= ( free_magma_carrier R14 ) by L833;
reconsider D119 = [ C273 , 1 ] as (Element of ( free_magma R14 )) by L1002 , L1001;
L1003: 1 = ( [ C273 , 1 ] `2 );
L1004: ( length D119 ) = 1 by L1003 , L998 , L993;
L1005: C273 = ( [ C273 , 1 ] `1 );
thus L1006: C273 in { ( B324 `1 ) where B324 is (Element of ( free_magma R14 )) : ( length B324 ) = 1 } by L1005 , L1004;
end;
assume L1007: C273 in { ( B325 `1 ) where B325 is (Element of ( free_magma R14 )) : ( length B325 ) = 1 };
consider C274 being (Element of ( free_magma R14 )) such that L1008: (C273 = ( C274 `1 ) & ( length C274 ) = 1) by L1007;
L1009: ( C274 `2 ) = 1 by L1008 , L993;
per cases ;
suppose L1010: R14 is non  empty;

L1011: C274 in [: ( free_magma (R14 , 1) ) , { 1 } :] by L1010 , L1009 , L901;
L1012: C274 in [: R14 , { 1 } :] by L1011 , L577;
thus L1013: C273 in R14 by L1012 , L1008 , MCART_1:10;
end;
suppose L1014: R14 is  empty;

thus L1015: thesis by L1014 , L1008 , L993;
end;
end;
thus L1017: thesis by L996 , TARSKI:1;
end;
theorem
L1018: (for R14 being set holds (for R21 being (Element of ( free_magma R14 )) holds (for R24 being (Element of ( free_magma R14 )) holds (R14 is non  empty implies ( R21 * R24 ) = [ [ [ ( R21 `1 ) , ( R24 `1 ) ] , ( R21 `2 ) ] , ( ( length R21 ) + ( length R24 ) ) ]))))
proof
let R14 being set;
let R21 being (Element of ( free_magma R14 ));
let R24 being (Element of ( free_magma R14 ));
assume L1019: R14 is non  empty;
L1020: (( length R21 ) = ( R21 `2 ) & ( length R24 ) = ( R24 `2 )) by L1019 , L993;
thus L1021: thesis by L1020 , L1019 , L942;
end;
theorem
L1022: (for R14 being set holds (for R21 being (Element of ( free_magma R14 )) holds (R14 is non  empty implies (R21 = [ ( R21 `1 ) , ( R21 `2 ) ] & ( length R21 ) >= 1))))
proof
let R14 being set;
let R21 being (Element of ( free_magma R14 ));
assume L1023: R14 is non  empty;
reconsider D120 = R14 as non  empty set by L1023;
reconsider D121 = R21 as (Element of ( free_magma D120 ));
L1024: D121 in [: ( free_magma (R14 , ( D121 `2 )) ) , { ( D121 `2 ) } :] by L901;
L1025: (ex B326 , B327 being set st (B326 in ( free_magma (R14 , ( D121 `2 )) ) & B327 in { ( D121 `2 ) } & D121 = [ B326 , B327 ])) by L1024 , ZFMISC_1:def 2;
thus L1026: R21 = [ ( R21 `1 ) , ( R21 `2 ) ] by L1025 , MCART_1:8;
reconsider D122 = D121 as (Element of ( free_magma_carrier D120 ));
L1027: ( D122 `2 ) > ( 0 );
L1028: ( length D121 ) > ( 0 ) by L1027 , L993;
L1029: ( ( length D121 ) + 1 ) > ( ( 0 ) + 1 ) by L1028 , XREAL_1:6;
thus L1030: thesis by L1029 , NAT_1:13;
end;
theorem
L1031: (for R14 being set holds (for R21 being (Element of ( free_magma R14 )) holds (for R24 being (Element of ( free_magma R14 )) holds ( length ( R21 * R24 ) ) = ( ( length R21 ) + ( length R24 ) ))))
proof
let R14 being set;
let R21 being (Element of ( free_magma R14 ));
let R24 being (Element of ( free_magma R14 ));
set D123 = ( R21 * R24 );
per cases ;
suppose L1032: R14 is non  empty;

L1033: ( R21 * R24 ) = [ [ [ ( R21 `1 ) , ( R24 `1 ) ] , ( R21 `2 ) ] , ( ( length R21 ) + ( length R24 ) ) ] by L1032 , L1018;
thus L1034: ( length ( R21 * R24 ) ) = ( [ [ [ ( R21 `1 ) , ( R24 `1 ) ] , ( R21 `2 ) ] , ( ( length R21 ) + ( length R24 ) ) ] `2 ) by L1033 , L1032 , L993
.= ( ( length R21 ) + ( length R24 ) );
end;
suppose L1035: R14 is  empty;

thus L1036: ( length ( R21 * R24 ) ) = ( 0 ) by L1035 , L993
.= ( ( length R21 ) + ( 0 ) ) by L1035 , L993
.= ( ( length R21 ) + ( length R24 ) ) by L1035 , L993;
end;
end;
theorem
L1038: (for R14 being set holds (for R24 being (Element of ( free_magma R14 )) holds (( length R24 ) >= 2 implies (ex R25 being (Element of ( free_magma R14 )) st (ex R26 being (Element of ( free_magma R14 )) st (R24 = ( R25 * R26 ) & ( length R25 ) < ( length R24 ) & ( length R26 ) < ( length R24 )))))))
proof
let R14 being set;
let R24 being (Element of ( free_magma R14 ));
assume L1039: ( length R24 ) >= 2;
reconsider D124 = R14 as non  empty set by L1039 , L993;
reconsider D125 = R24 as (Element of ( free_magma D124 ));
L1040: D125 in [: ( free_magma (R14 , ( D125 `2 )) ) , { ( D125 `2 ) } :] by L901;
set D126 = ( length R24 );
L1041: D126 = ( D125 `2 ) by L993;
consider C275 being FinSequence such that L1042: ( len C275 ) = ( D126 - 1 ) and L1043: (for B328 being Nat holds ((B328 >= 1 & B328 <= ( D126 - 1 )) implies ( C275 . B328 ) = [: ( ( free_magma_seq R14 ) . B328 ) , ( ( free_magma_seq R14 ) . ( D126 - B328 ) ) :])) and L1044: ( ( free_magma_seq R14 ) . D126 ) = ( Union ( disjoin C275 ) ) by L1039 , L577;
L1045: ( D125 `1 ) in ( ( free_magma_seq R14 ) . D126 ) by L1041 , L1040 , MCART_1:10;
L1046: ( D125 `1 ) in ( union ( rng ( disjoin C275 ) ) ) by L1045 , L1044 , CARD_3:def 4;
consider C276 being set such that L1047: (( D125 `1 ) in C276 & C276 in ( rng ( disjoin C275 ) )) by L1046 , TARSKI:def 4;
consider C277 being set such that L1048: (C277 in ( dom ( disjoin C275 ) ) & C276 = ( ( disjoin C275 ) . C277 )) by L1047 , FUNCT_1:def 3;
L1049: C277 in ( dom C275 ) by L1048 , CARD_3:def 3;
reconsider D127 = C277 as Nat by L1049;
L1050: D127 in ( Seg ( len C275 ) ) by L1049 , FINSEQ_1:def 3;
L1051: (1 <= D127 & D127 <= ( len C275 )) by L1050 , FINSEQ_1:1;
L1052: ( C275 . D127 ) = [: ( ( free_magma_seq R14 ) . D127 ) , ( ( free_magma_seq R14 ) . ( D126 - D127 ) ) :] by L1051 , L1042 , L1043;
L1053: ( D125 `1 ) in [: [: ( ( free_magma_seq R14 ) . D127 ) , ( ( free_magma_seq R14 ) . ( D126 - D127 ) ) :] , { D127 } :] by L1052 , L1047 , L1048 , L1049 , CARD_3:def 3;
L1054: (( ( D125 `1 ) `1 ) in [: ( ( free_magma_seq R14 ) . D127 ) , ( ( free_magma_seq R14 ) . ( D126 - D127 ) ) :] & ( ( D125 `1 ) `2 ) in { D127 }) by L1053 , MCART_1:10;
L1055: (( ( ( D125 `1 ) `1 ) `1 ) in ( ( free_magma_seq R14 ) . D127 ) & ( ( ( D125 `1 ) `1 ) `2 ) in ( ( free_magma_seq R14 ) . ( D126 - D127 ) )) by L1054 , MCART_1:10;
L1056: ( - D127 ) >= ( - ( D126 - 1 ) ) by L1051 , L1042 , XREAL_1:24;
L1057: ( ( - D127 ) + D126 ) >= ( ( - ( D126 - 1 ) ) + D126 ) by L1056 , XREAL_1:7;
L1058: ( D126 - D127 ) in ( NAT ) by L1057 , INT_1:3;
reconsider D128 = ( D126 - D127 ) as Nat by L1058;
set D129 = [ ( ( ( D125 `1 ) `1 ) `1 ) , D127 ];
set D130 = [ ( ( ( D125 `1 ) `1 ) `2 ) , D128 ];
L1059: D127 in { D127 } by TARSKI:def 1;
L1060: D129 in [: ( free_magma (R14 , D127) ) , { D127 } :] by L1059 , L1055 , ZFMISC_1:def 2;
L1061: D128 in { D128 } by TARSKI:def 1;
L1062: D130 in [: ( free_magma (R14 , D128) ) , { D128 } :] by L1061 , L1055 , ZFMISC_1:def 2;
L1063: [: ( free_magma (R14 , D127) ) , { D127 } :] c= ( free_magma_carrier R14 ) by L1051 , L833;
reconsider D131 = D129 as (Element of ( free_magma_carrier R14 )) by L1063 , L1060;
L1064: [: ( free_magma (R14 , D128) ) , { D128 } :] c= ( free_magma_carrier R14 ) by L1057 , L833;
reconsider D132 = D130 as (Element of ( free_magma_carrier R14 )) by L1064 , L1062;
reconsider D133 = D131 , D134 = D132 as (Element of ( free_magma R14 ));
L1065: ( [ ( ( ( D125 `1 ) `1 ) `1 ) , D127 ] `2 ) = D127;
L1066: ( length D133 ) = ( [ ( ( ( D125 `1 ) `1 ) `1 ) , D127 ] `2 ) by L993
.= D127;
L1067: ( length D134 ) = ( [ ( ( ( D125 `1 ) `1 ) `2 ) , D128 ] `2 ) by L993
.= D128;
L1068: ( [ ( ( ( D125 `1 ) `1 ) `1 ) , D127 ] `1 ) = ( ( ( D125 `1 ) `1 ) `1 );
L1069: ( [ ( ( ( D125 `1 ) `1 ) `2 ) , D128 ] `1 ) = ( ( ( D125 `1 ) `1 ) `2 );
L1070: (ex B329 , B330 being set st (B329 in [: ( ( free_magma_seq R14 ) . D127 ) , ( ( free_magma_seq R14 ) . ( D126 - D127 ) ) :] & B330 in { D127 } & ( D125 `1 ) = [ B329 , B330 ])) by L1053 , ZFMISC_1:def 2;
L1071: ( D125 `1 ) = [ ( ( D125 `1 ) `1 ) , ( ( D125 `1 ) `2 ) ] by L1070 , MCART_1:8
.= [ ( ( D125 `1 ) `1 ) , D127 ] by L1054 , TARSKI:def 1;
L1072: (ex B331 , B332 being set st (B331 in ( ( free_magma_seq R14 ) . D127 ) & B332 in ( ( free_magma_seq R14 ) . ( D126 - D127 ) ) & ( ( D125 `1 ) `1 ) = [ B331 , B332 ])) by L1054 , ZFMISC_1:def 2;
take D133;
take D134;
L1073: (ex B333 , B334 being set st (B333 in ( free_magma (R14 , ( D125 `2 )) ) & B334 in { ( D125 `2 ) } & D125 = [ B333 , B334 ])) by L1040 , ZFMISC_1:def 2;
thus L1074: R24 = [ ( D125 `1 ) , ( D125 `2 ) ] by L1073 , MCART_1:8
.= [ [ ( ( D125 `1 ) `1 ) , D127 ] , D126 ] by L1071 , L993
.= [ [ ( ( D125 `1 ) `1 ) , ( D133 `2 ) ] , ( ( length D133 ) + ( length D134 ) ) ] by L1066 , L1067 , L1065
.= [ [ [ ( ( ( D125 `1 ) `1 ) `1 ) , ( ( ( D125 `1 ) `1 ) `2 ) ] , ( D133 `2 ) ] , ( ( length D133 ) + ( length D134 ) ) ] by L1072 , MCART_1:8
.= [ [ [ ( ( ( D125 `1 ) `1 ) `1 ) , ( D134 `1 ) ] , ( D133 `2 ) ] , ( ( length D133 ) + ( length D134 ) ) ] by L1069
.= [ [ [ ( D133 `1 ) , ( D134 `1 ) ] , ( D133 `2 ) ] , ( ( length D133 ) + ( length D134 ) ) ] by L1068
.= ( D133 * D134 ) by L1018;
L1075: D127 <= ( D126 - 1 ) by L1050 , L1042 , FINSEQ_1:1;
L1076: ( D127 + 1 ) <= ( ( D126 - 1 ) + 1 ) by L1075 , XREAL_1:7;
thus L1077: ( length D133 ) < ( length R24 ) by L1076 , L1066 , NAT_1:13;
L1078: ( - 1 ) >= ( - D127 ) by L1051 , XREAL_1:24;
L1079: ( ( - 1 ) + ( D126 + 1 ) ) >= ( ( - D127 ) + ( D126 + 1 ) ) by L1078 , XREAL_1:7;
L1080: D126 >= ( D128 + 1 ) by L1079;
thus L1081: ( length D134 ) < ( length R24 ) by L1080 , L1067 , NAT_1:13;
end;
theorem
L1082: (for R14 being set holds (for R22 being (Element of ( free_magma R14 )) holds (for R23 being (Element of ( free_magma R14 )) holds (for R25 being (Element of ( free_magma R14 )) holds (for R26 being (Element of ( free_magma R14 )) holds (( R22 * R23 ) = ( R25 * R26 ) implies (R22 = R25 & R23 = R26)))))))
proof
let R14 being set;
let R22 being (Element of ( free_magma R14 ));
let R23 being (Element of ( free_magma R14 ));
let R25 being (Element of ( free_magma R14 ));
let R26 being (Element of ( free_magma R14 ));
assume L1083: ( R22 * R23 ) = ( R25 * R26 );
per cases ;
suppose L1084: R14 is non  empty;

L1085: (( R22 * R23 ) = [ [ [ ( R22 `1 ) , ( R23 `1 ) ] , ( R22 `2 ) ] , ( ( length R22 ) + ( length R23 ) ) ] & ( R25 * R26 ) = [ [ [ ( R25 `1 ) , ( R26 `1 ) ] , ( R25 `2 ) ] , ( ( length R25 ) + ( length R26 ) ) ]) by L1084 , L1018;
L1086: ([ [ ( R22 `1 ) , ( R23 `1 ) ] , ( R22 `2 ) ] = [ [ ( R25 `1 ) , ( R26 `1 ) ] , ( R25 `2 ) ] & ( ( length R22 ) + ( length R23 ) ) = ( ( length R25 ) + ( length R26 ) )) by L1085 , L1083 , XTUPLE_0:1;
L1087: ([ ( R22 `1 ) , ( R23 `1 ) ] = [ ( R25 `1 ) , ( R26 `1 ) ] & ( R22 `2 ) = ( R25 `2 )) by L1086 , XTUPLE_0:1;
L1088: ( length R22 ) = ( R22 `2 ) by L1084 , L993
.= ( length R25 ) by L1084 , L1087 , L993;
L1089: ( R23 `2 ) = ( length R26 ) by L1088 , L1084 , L1086 , L993;
L1090: ( R23 `2 ) = ( R26 `2 ) by L1089 , L1084 , L993;
thus L1091: R22 = [ ( R22 `1 ) , ( R22 `2 ) ] by L1084 , L1022
.= [ ( R25 `1 ) , ( R25 `2 ) ] by L1087 , XTUPLE_0:1
.= R25 by L1084 , L1022;
thus L1092: R23 = [ ( R23 `1 ) , ( R23 `2 ) ] by L1084 , L1022
.= [ ( R26 `1 ) , ( R26 `2 ) ] by L1090 , L1087 , XTUPLE_0:1
.= R26 by L1084 , L1022;
end;
suppose L1093: R14 is  empty;

L1094: (R22 = ( {} ) & R25 = ( {} ) & R23 = ( {} ) & R26 = ( {} )) by L1093 , SUBSET_1:def 1;
thus L1095: thesis by L1094;
end;
end;
definition
let C278 being set;
let C279 being Nat;
func canon_image (C278 , C279) -> (Function of ( free_magma (C278 , C279) ) , ( free_magma C278 )) means 
:L1097: (for R15 being set holds (R15 in ( dom it ) implies ( it . R15 ) = [ R15 , C279 ])) if C279 > ( 0 ) otherwise it = ( {} );
correctness
proof
L1098: (C279 > ( 0 ) implies (ex B335 being (Function of ( free_magma (C278 , C279) ) , ( free_magma C278 )) st (for R15 being set holds (R15 in ( dom B335 ) implies ( B335 . R15 ) = [ R15 , C279 ]))))
proof
assume L1099: C279 > ( 0 );
deffunc H5(set) = [ $1 , C279 ];
L1100: (for R15 being set holds (R15 in ( free_magma (C278 , C279) ) implies H5(R15) in (the carrier of ( free_magma C278 ))))
proof
let R15 being set;
assume L1101: R15 in ( free_magma (C278 , C279) );
L1102: C279 in { C279 } by TARSKI:def 1;
L1103: H5(R15) in [: ( free_magma (C278 , C279) ) , { C279 } :] by L1102 , L1101 , ZFMISC_1:def 2;
L1104: [: ( free_magma (C278 , C279) ) , { C279 } :] c= ( free_magma_carrier C278 ) by L1099 , L833;
thus L1105: H5(R15) in (the carrier of ( free_magma C278 )) by L1104 , L1103;
end;
consider C280 being (Function of ( free_magma (C278 , C279) ) , (the carrier of ( free_magma C278 ))) such that L1106: (for R15 being set holds (R15 in ( free_magma (C278 , C279) ) implies ( C280 . R15 ) = H5(R15))) from FUNCT_2:sch 2(L1100);
take C280;
let R15 being set;
assume L1107: R15 in ( dom C280 );
thus L1108: ( C280 . R15 ) = [ R15 , C279 ] by L1107 , L1106;
end;
L1109: ((not C279 > ( 0 )) implies (ex B336 being (Function of ( free_magma (C278 , C279) ) , ( free_magma C278 )) st B336 = ( {} )))
proof
assume L1110: (not C279 > ( 0 ));
L1111: C279 = ( 0 ) by L1110;
L1112: ( free_magma (C278 , C279) ) = ( {} ) by L1111 , L577;
set D135 = ( {} );
L1113: ( dom D135 ) = ( {} );
L1114: ( rng D135 ) c= (the carrier of ( free_magma C278 )) by XBOOLE_1:2;
reconsider D136 = D135 as (Function of ( free_magma (C278 , C279) ) , ( free_magma C278 )) by L1114 , L1112 , L1113 , FUNCT_2:2;
take D136;
thus L1115: D136 = ( {} );
end;
L1116: (for B337 , B338 being (Function of ( free_magma (C278 , C279) ) , ( free_magma C278 )) holds ((C279 > ( 0 ) & (for R15 being set holds (R15 in ( dom B337 ) implies ( B337 . R15 ) = [ R15 , C279 ])) & (for R15 being set holds (R15 in ( dom B338 ) implies ( B338 . R15 ) = [ R15 , C279 ]))) implies B337 = B338))
proof
let C281 , C282 being (Function of ( free_magma (C278 , C279) ) , ( free_magma C278 ));
assume L1117: C279 > ( 0 );
assume L1118: (for R15 being set holds (R15 in ( dom C281 ) implies ( C281 . R15 ) = [ R15 , C279 ]));
assume L1119: (for R15 being set holds (R15 in ( dom C282 ) implies ( C282 . R15 ) = [ R15 , C279 ]));
per cases ;
suppose L1120: C278 is  empty;

thus L1121: thesis by L1120;
end;
suppose L1122: C278 is non  empty;

L1123: ( dom C281 ) = ( free_magma (C278 , C279) ) by L1122 , FUNCT_2:def 1
.= ( dom C282 ) by L1122 , FUNCT_2:def 1;
L1124: (for R15 being set holds (R15 in ( dom C281 ) implies ( C281 . R15 ) = ( C282 . R15 )))
proof
let R15 being set;
assume L1125: R15 in ( dom C281 );
thus L1126: ( C281 . R15 ) = [ R15 , C279 ] by L1125 , L1118
.= ( C282 . R15 ) by L1119 , L1123 , L1125;
end;
thus L1127: thesis by L1124 , L1123 , FUNCT_1:2;
end;
end;
thus L1129: thesis by L1116 , L1098 , L1109;
end;
end;
L1131: (for R14 being set holds (for R18 being Nat holds ( canon_image (R14 , R18) ) is  one-to-one))
proof
let R14 being set;
let R18 being Nat;
L1132: (for B339 , B340 being set holds ((B339 in ( dom ( canon_image (R14 , R18) ) ) & B340 in ( dom ( canon_image (R14 , R18) ) ) & ( ( canon_image (R14 , R18) ) . B339 ) = ( ( canon_image (R14 , R18) ) . B340 )) implies B339 = B340))
proof
let C283 , C284 being set;
assume L1133: (C283 in ( dom ( canon_image (R14 , R18) ) ) & C284 in ( dom ( canon_image (R14 , R18) ) ));
assume L1134: ( ( canon_image (R14 , R18) ) . C283 ) = ( ( canon_image (R14 , R18) ) . C284 );
per cases ;
suppose L1135: R18 > ( 0 );

L1136: (( ( canon_image (R14 , R18) ) . C283 ) = [ C283 , R18 ] & ( ( canon_image (R14 , R18) ) . C284 ) = [ C284 , R18 ]) by L1135 , L1133 , L1097;
thus L1137: C283 = C284 by L1136 , L1134 , XTUPLE_0:1;
end;
suppose L1138: (not R18 > ( 0 ));

L1139: ( canon_image (R14 , R18) ) = ( {} ) by L1138 , L1097;
thus L1140: thesis by L1139 , L1133;
end;
end;
thus L1142: ( canon_image (R14 , R18) ) is  one-to-one by L1132 , FUNCT_1:def 4;
end;
registration
let C285 being set;
let C286 being Nat;
cluster ( canon_image (C285 , C286) ) ->  one-to-one;
correctness by L1131;
end;
L1144: (for R27 being non  empty set holds (( dom ( canon_image (R27 , 1) ) ) = R27 & (for B341 being set holds (B341 in R27 implies ( ( canon_image (R27 , 1) ) . B341 ) = [ B341 , 1 ]))))
proof
let R27 being non  empty set;
L1145: ( dom ( canon_image (R27 , 1) ) ) = ( free_magma (R27 , 1) ) by FUNCT_2:def 1;
thus L1146: ( dom ( canon_image (R27 , 1) ) ) = R27 by L1145 , L577;
thus L1147: (for B342 being set holds (B342 in R27 implies ( ( canon_image (R27 , 1) ) . B342 ) = [ B342 , 1 ])) by L1146 , L1097;
end;
theorem
L1148: (for R27 being non  empty set holds (for B343 being (Subset of ( free_magma R27 )) holds (B343 = ( ( canon_image (R27 , 1) ) .: R27 ) implies ( free_magma R27 ) = ( the_submagma_generated_by B343 ))))
proof
let R27 being non  empty set;
let C287 being (Subset of ( free_magma R27 ));
set D137 = ( the_submagma_generated_by C287 );
assume L1149: C287 = ( ( canon_image (R27 , 1) ) .: R27 );
per cases ;
suppose L1150: C287 is  empty;

L1151: R27 is  empty
proof
assume L1152: R27 is non  empty;
consider R15 being set such that L1153: R15 in R27 by XBOOLE_0:def 1;
L1154: R15 in ( dom ( canon_image (R27 , 1) ) ) by L1144 , L1153;
L1155: ( ( canon_image (R27 , 1) ) . R15 ) in ( ( canon_image (R27 , 1) ) .: R27 ) by L1154 , L1153 , FUNCT_1:def 6;
thus L1156: contradiction by L1155 , L1150 , L1149;
end;
thus L1157: thesis by L1151;
end;
suppose L1158: (not C287 is  empty);

L1159: (the carrier of D137) c= (the carrier of ( free_magma R27 )) by L273;
L1160: (for R15 being set holds (R15 in (the carrier of ( free_magma R27 )) implies R15 in (the carrier of D137)))
proof
let R15 being set;
assume L1161: R15 in (the carrier of ( free_magma R27 ));
defpred S12[ Nat ] means (for B344 being (Element of ( free_magma R27 )) holds (( length B344 ) = $1 implies B344 in (the carrier of D137)));
L1162: (for B345 being Nat holds ((for B346 being Nat holds (B346 < B345 implies S12[ B346 ])) implies S12[ B345 ]))
proof
let C288 being Nat;
assume L1163: (for B347 being Nat holds (B347 < C288 implies S12[ B347 ]));
L1164: (C288 = ( 0 ) or ( C288 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L1165: (C288 = ( 0 ) or C288 >= 1) by L1164 , NAT_1:13;
L1166: (C288 = ( 0 ) or C288 = 1 or C288 > 1) by L1165 , XXREAL_0:1;
L1167: (C288 = ( 0 ) or C288 = 1 or ( C288 + 1 ) > ( 1 + 1 )) by L1166 , XREAL_1:6;
per cases  by L1167 , NAT_1:13;
suppose L1168: C288 = ( 0 );

thus L1169: S12[ C288 ] by L1168 , L1022;
end;
suppose L1170: C288 = 1;

L1171: (for B348 being (Element of ( free_magma R27 )) holds (( length B348 ) = 1 implies B348 in (the carrier of D137)))
proof
let C289 being (Element of ( free_magma R27 ));
assume L1172: ( length C289 ) = 1;
L1173: C289 = [ ( C289 `1 ) , ( C289 `2 ) ] by L1022
.= [ ( C289 `1 ) , 1 ] by L1172 , L993;
L1174: ( C289 `1 ) in { ( B349 `1 ) where B349 is (Element of ( free_magma R27 )) : ( length B349 ) = 1 } by L1172;
L1175: ( C289 `1 ) in R27 by L1174 , L995;
L1176: (( C289 `1 ) in ( dom ( canon_image (R27 , 1) ) ) & ( C289 `1 ) in R27 & C289 = ( ( canon_image (R27 , 1) ) . ( C289 `1 ) )) by L1175 , L1173 , L1144;
L1177: C289 in C287 by L1176 , L1149 , FUNCT_1:def 6;
L1178: C287 c= (the carrier of D137) by L407;
thus L1179: thesis by L1178 , L1177;
end;
thus L1180: S12[ C288 ] by L1171 , L1170;
end;
suppose L1181: C288 >= 2;

L1182: (for B350 being (Element of ( free_magma R27 )) holds (( length B350 ) = C288 implies B350 in (the carrier of D137)))
proof
let C290 being (Element of ( free_magma R27 ));
assume L1183: ( length C290 ) = C288;
consider C291 , C292 being (Element of ( free_magma R27 )) such that L1184: (C290 = ( C291 * C292 ) & ( length C291 ) < ( length C290 ) & ( length C292 ) < ( length C290 )) by L1183 , L1181 , L1038;
L1185: C291 in (the carrier of D137) by L1163 , L1183 , L1184;
reconsider D138 = C291 as (Element of D137) by L1163 , L1183 , L1184;
L1186: C292 in (the carrier of D137) by L1163 , L1183 , L1184;
reconsider D139 = C292 as (Element of D137) by L1163 , L1183 , L1184;
L1187: D137 is non  empty by L1158 , L450;
L1188: (the carrier of D137) <> ( {} ) by L1187;
L1189: [ C291 , C292 ] in [: (the carrier of D137) , (the carrier of D137) :] by L1185 , L1186 , ZFMISC_1:87;
L1190: ( D138 * D139 ) = ( (the multF of D137) . [ D138 , D139 ] ) by BINOP_1:def 1
.= ( ( (the multF of ( free_magma R27 )) || (the carrier of D137) ) . [ C291 , C292 ] ) by L273
.= ( ( (the multF of ( free_magma R27 )) | [: (the carrier of D137) , (the carrier of D137) :] ) . [ C291 , C292 ] ) by REALSET1:def 2
.= ( (the multF of ( free_magma R27 )) . [ C291 , C292 ] ) by L1189 , FUNCT_1:49
.= ( C291 * C292 ) by BINOP_1:def 1;
thus L1191: C290 in (the carrier of D137) by L1190 , L1184 , L1188;
end;
thus L1192: S12[ C288 ] by L1182;
end;
end;
L1194: (for B351 being Nat holds S12[ B351 ]) from NAT_1:sch 4(L1162);
reconsider D140 = R15 as (Element of ( free_magma R27 )) by L1161;
reconsider D141 = ( length D140 ) as Nat;
L1195: S12[ D141 ] by L1194;
thus L1196: R15 in (the carrier of D137) by L1195;
end;
L1197: (the carrier of ( free_magma R27 )) c= (the carrier of D137) by L1160 , TARSKI:def 3;
L1198: (the carrier of ( free_magma R27 )) = (the carrier of D137) by L1197 , L1159 , XBOOLE_0:def 10;
thus L1199: thesis by L1198 , L289;
end;
end;
theorem
L1201: (for R27 being non  empty set holds (for B352 being  compatible (Equivalence_Relation of ( free_magma R27 )) holds ( ( free_magma R27 ) ./. B352 ) = ( the_submagma_generated_by ( ( nat_hom B352 ) .: ( ( canon_image (R27 , 1) ) .: R27 ) ) )))
proof
let R27 being non  empty set;
let C293 being  compatible (Equivalence_Relation of ( free_magma R27 ));
set D142 = ( ( canon_image (R27 , 1) ) .: R27 );
reconsider D143 = D142 as (Subset of ( free_magma R27 ));
L1202: (the carrier of ( the_submagma_generated_by D143 )) = (the carrier of ( free_magma R27 )) by L1148;
L1203: (the carrier of ( ( free_magma R27 ) ./. C293 )) = ( rng ( nat_hom C293 ) ) by FUNCT_2:def 3;
L1204: (the carrier of ( ( free_magma R27 ) ./. C293 )) = ( ( nat_hom C293 ) .: ( dom ( nat_hom C293 ) ) ) by L1203 , RELAT_1:113;
L1205: (the carrier of ( ( free_magma R27 ) ./. C293 )) = ( ( nat_hom C293 ) .: (the carrier of ( the_submagma_generated_by D143 )) ) by L1204 , L1202 , FUNCT_2:def 1;
L1206: (the carrier of ( ( free_magma R27 ) ./. C293 )) = (the carrier of ( the_submagma_generated_by ( ( nat_hom C293 ) .: D143 ) )) by L1205 , L462;
thus L1207: thesis by L1206 , L289;
end;
theorem
L1208: (for R27 being non  empty set holds (for R28 being non  empty set holds (for B353 being (Function of R27 , R28) holds ( ( canon_image (R28 , 1) ) * B353 ) is (Function of R27 , ( free_magma R28 )))))
proof
let R27 being non  empty set;
let R28 being non  empty set;
let C294 being (Function of R27 , R28);
L1209: ( dom C294 ) = R27 by FUNCT_2:def 1;
L1210: ( dom ( canon_image (R28 , 1) ) ) = R28 by L1144;
L1211: ( rng C294 ) c= ( dom ( canon_image (R28 , 1) ) ) by L1210;
L1212: ( dom ( ( canon_image (R28 , 1) ) * C294 ) ) = R27 by L1211 , L1209 , RELAT_1:27;
L1213: ( rng ( ( canon_image (R28 , 1) ) * C294 ) ) c= ( rng ( canon_image (R28 , 1) ) ) by RELAT_1:26;
thus L1214: thesis by L1213 , L1212 , FUNCT_2:2;
end;
definition
let C295 being non  empty set;
let C296 being non  empty multMagma;
let C297 , C298 being non  zero Nat;
let C299 being (Function of ( free_magma (C295 , C297) ) , C296);
let C300 being (Function of ( free_magma (C295 , C298) ) , C296);
func [:C299 , C300 :] -> (Function of [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :] , C296) means 
:L1215: (for B354 being (Element of [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :]) holds (for B355 being (Element of ( free_magma (C295 , C297) )) holds (for B356 being (Element of ( free_magma (C295 , C298) )) holds ((B355 = ( ( B354 `1 ) `1 ) & B356 = ( ( B354 `1 ) `2 )) implies ( it . B354 ) = ( ( C299 . B355 ) * ( C300 . B356 ) )))));
existence
proof
set D144 = [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :];
defpred S13[ set , set ] means (for B357 being (Element of D144) holds (for B358 being (Element of ( free_magma (C295 , C297) )) holds (for B359 being (Element of ( free_magma (C295 , C298) )) holds (($1 = B357 & B358 = ( ( B357 `1 ) `1 ) & B359 = ( ( B357 `1 ) `2 )) implies $2 = ( ( C299 . B358 ) * ( C300 . B359 ) )))));
L1216: (for R15 being set holds (R15 in D144 implies (ex R16 being set st (R16 in (the carrier of C296) & S13[ R15 , R16 ]))))
proof
let R15 being set;
assume L1217: R15 in D144;
L1218: ( R15 `1 ) in [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] by L1217 , MCART_1:10;
reconsider D145 = ( ( R15 `1 ) `1 ) as (Element of ( free_magma (C295 , C297) )) by L1218 , MCART_1:10;
reconsider D146 = ( ( R15 `1 ) `2 ) as (Element of ( free_magma (C295 , C298) )) by L1218 , MCART_1:10;
set D147 = ( ( C299 . D145 ) * ( C300 . D146 ) );
take D147;
thus L1219: D147 in (the carrier of C296);
thus L1220: S13[ R15 , D147 ];
end;
consider C301 being (Function of D144 , (the carrier of C296)) such that L1221: (for R15 being set holds (R15 in D144 implies S13[ R15 , ( C301 . R15 ) ])) from FUNCT_2:sch 1(L1216);
take C301;
thus L1222: thesis by L1221;
end;
uniqueness
proof
let C302 , C303 being (Function of [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :] , C296);
assume L1223: (for B360 being (Element of [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :]) holds (for B361 being (Element of ( free_magma (C295 , C297) )) holds (for B362 being (Element of ( free_magma (C295 , C298) )) holds ((B361 = ( ( B360 `1 ) `1 ) & B362 = ( ( B360 `1 ) `2 )) implies ( C302 . B360 ) = ( ( C299 . B361 ) * ( C300 . B362 ) )))));
assume L1224: (for B363 being (Element of [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :]) holds (for B364 being (Element of ( free_magma (C295 , C297) )) holds (for B365 being (Element of ( free_magma (C295 , C298) )) holds ((B364 = ( ( B363 `1 ) `1 ) & B365 = ( ( B363 `1 ) `2 )) implies ( C303 . B363 ) = ( ( C299 . B364 ) * ( C300 . B365 ) )))));
L1225: (for R15 being set holds (R15 in [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :] implies ( C302 . R15 ) = ( C303 . R15 )))
proof
let R15 being set;
assume L1226: R15 in [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :];
reconsider D148 = R15 as (Element of [: [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] , { C297 } :]) by L1226;
L1227: ( D148 `1 ) in [: ( free_magma (C295 , C297) ) , ( free_magma (C295 , C298) ) :] by MCART_1:10;
reconsider D149 = ( ( D148 `1 ) `1 ) as (Element of ( free_magma (C295 , C297) )) by L1227 , MCART_1:10;
reconsider D150 = ( ( D148 `1 ) `2 ) as (Element of ( free_magma (C295 , C298) )) by L1227 , MCART_1:10;
thus L1228: ( C302 . R15 ) = ( ( C299 . D149 ) * ( C300 . D150 ) ) by L1223
.= ( C303 . R15 ) by L1224;
end;
thus L1229: thesis by L1225 , FUNCT_2:12;
end;
end;
theorem
L1231: (for R27 being non  empty set holds (for R30 being non  empty multMagma holds (for B366 being (Function of R27 , R30) holds (ex B367 being (Function of ( free_magma R27 ) , R30) st (B367 is  multiplicative & B367 extends ( B366 * ( ( canon_image (R27 , 1) ) " ) ))))))
proof
let R27 being non  empty set;
let R30 being non  empty multMagma;
let C304 being (Function of R27 , R30);
defpred S14[ set , set ] means (ex R18 being Nat st (R18 = $1 & $2 = ( Funcs (( free_magma (R27 , R18) ) , (the carrier of R30)) )));
L1232: (for R15 being set holds (R15 in ( NAT ) implies (ex R16 being set st S14[ R15 , R16 ])))
proof
let R15 being set;
assume L1233: R15 in ( NAT );
reconsider D151 = R15 as Nat by L1233;
set D152 = ( Funcs (( free_magma (R27 , D151) ) , (the carrier of R30)) );
take D152;
thus L1234: S14[ R15 , D152 ];
end;
consider C305 being Function such that L1235: (( dom C305 ) = ( NAT ) & (for R15 being set holds (R15 in ( NAT ) implies S14[ R15 , ( C305 . R15 ) ]))) from CLASSES1:sch 1(L1232);
L1236: C304 in ( Funcs (R27 , (the carrier of R30)) ) by FUNCT_2:8;
L1237: S14[ 1 , ( C305 . 1 ) ] by L1235;
L1238: ( C305 . 1 ) = ( Funcs (R27 , (the carrier of R30)) ) by L1237 , L577;
L1239: ( Funcs (R27 , (the carrier of R30)) ) in ( rng C305 ) by L1238 , L1235 , FUNCT_1:3;
L1240: C304 in ( union ( rng C305 ) ) by L1239 , L1236 , TARSKI:def 4;
L1241: C304 in ( Union C305 ) by L1240 , CARD_3:def 4;
reconsider D153 = ( Union C305 ) as non  empty set by L1240 , CARD_3:def 4;
defpred S15[ set , set ] means (for B368 being (XFinSequence of D153) holds ($1 = B368 implies (((for B369 being non  zero Nat holds (B369 in ( dom B368 ) implies ( B368 . B369 ) is (Function of ( free_magma (R27 , B369) ) , R30))) implies ((( dom B368 ) = ( 0 ) implies $2 = ( {} )) & (( dom B368 ) = 1 implies $2 = C304) & (for B370 being Nat holds ((B370 >= 2 & ( dom B368 ) = B370) implies (ex B371 being FinSequence st (( len B371 ) = ( B370 - 1 ) & (for B372 being Nat holds ((B372 >= 1 & B372 <= ( B370 - 1 )) implies (ex B373 , B374 being non  zero Nat st (ex B375 being (Function of ( free_magma (R27 , B373) ) , R30) st (ex B376 being (Function of ( free_magma (R27 , B374) ) , R30) st (B373 = B372 & B374 = ( B370 - B372 ) & B375 = ( B368 . B373 ) & B376 = ( B368 . B374 ) & ( B371 . B372 ) = [: B375 , B376 :])))))) & $2 = ( Union B371 ))))))) & ((not (for B377 being non  zero Nat holds (B377 in ( dom B368 ) implies ( B368 . B377 ) is (Function of ( free_magma (R27 , B377) ) , R30)))) implies $2 = C304))));
L1242: (for B378 being set holds (B378 in ( D153 ^omega ) implies (ex B379 being set st S15[ B378 , B379 ])))
proof
let C306 being set;
assume L1243: C306 in ( D153 ^omega );
reconsider D154 = C306 as (XFinSequence of D153) by L1243 , AFINSQ_1:def 7;
per cases ;
suppose L1244: (for B380 being non  zero Nat holds (B380 in ( dom D154 ) implies ( D154 . B380 ) is (Function of ( free_magma (R27 , B380) ) , R30)));

L1245: (( dom D154 ) = ( 0 ) or ( ( dom D154 ) + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L1246: (( dom D154 ) = ( 0 ) or ( dom D154 ) >= 1) by L1245 , NAT_1:13;
L1247: (( dom D154 ) = ( 0 ) or ( dom D154 ) = 1 or ( dom D154 ) > 1) by L1246 , XXREAL_0:1;
L1248: (( dom D154 ) = ( 0 ) or ( dom D154 ) = 1 or ( ( dom D154 ) + 1 ) > ( 1 + 1 )) by L1247 , XREAL_1:6;
per cases  by L1248 , NAT_1:13;
suppose L1249: ( dom D154 ) = ( 0 );

set D155 = ( {} );
take D155;
thus L1250: S15[ C306 , D155 ] by L1249;
end;
suppose L1251: ( dom D154 ) = 1;

set D156 = C304;
take D156;
thus L1252: S15[ C306 , D156 ] by L1251;
end;
suppose L1253: ( dom D154 ) >= 2;

reconsider D157 = ( dom D154 ) as Nat;
reconsider D158 = ( D157 -' 1 ) as Nat;
L1254: ( D157 - 1 ) >= ( 2 - 1 ) by L1253 , XREAL_1:9;
L1255: D158 = ( D157 - 1 ) by L1254 , XREAL_0:def 2;
L1256: ( Seg D158 ) c= ( D158 + 1 ) by AFINSQ_1:3;
defpred S16[ set , set ] means (for B381 being Nat holds ((B381 >= 1 & B381 <= ( D157 - 1 ) & $1 = B381) implies (ex B382 , B383 being non  zero Nat st (ex B384 being (Function of ( free_magma (R27 , B382) ) , R30) st (ex B385 being (Function of ( free_magma (R27 , B383) ) , R30) st (B382 = B381 & B383 = ( D157 - B381 ) & B384 = ( D154 . B382 ) & B385 = ( D154 . B383 ) & $2 = [: B384 , B385 :]))))));
L1257: (for B386 being Nat holds (B386 in ( Seg D158 ) implies (ex B387 being set st S16[ B386 , B387 ])))
proof
let C307 being Nat;
assume L1258: C307 in ( Seg D158 );
L1259: (1 <= C307 & C307 <= D158) by L1258 , FINSEQ_1:1;
L1260: ( C307 + 1 ) <= ( ( D157 - 1 ) + 1 ) by L1259 , L1255 , XREAL_1:7;
L1261: ( ( C307 + 1 ) - C307 ) <= ( D157 - C307 ) by L1260 , XREAL_1:9;
L1262: ( D157 -' C307 ) = ( D157 - C307 ) by L1261 , XREAL_0:def 2;
reconsider D159 = C307 as non  zero Nat by L1258 , FINSEQ_1:1;
reconsider D160 = ( D157 - C307 ) as non  zero Nat by L1261 , L1262;
reconsider D161 = ( D154 . D159 ) as (Function of ( free_magma (R27 , D159) ) , R30) by L1244 , L1258 , L1256 , L1255;
L1263: ( - 1 ) >= ( - C307 ) by L1259 , XREAL_1:24;
L1264: ( ( - 1 ) + D157 ) >= ( ( - C307 ) + D157 ) by L1263 , XREAL_1:7;
L1265: D160 in ( Seg D158 ) by L1264 , L1255 , L1261 , FINSEQ_1:1;
reconsider D162 = ( D154 . D160 ) as (Function of ( free_magma (R27 , D160) ) , R30) by L1265 , L1244 , L1256 , L1255;
set D163 = [: D161 , D162 :];
take D163;
thus L1266: thesis;
end;
consider C308 being FinSequence such that L1267: (( dom C308 ) = ( Seg D158 ) & (for B388 being Nat holds (B388 in ( Seg D158 ) implies S16[ B388 , ( C308 . B388 ) ]))) from FINSEQ_1:sch 1(L1257);
set D164 = ( Union C308 );
take D164;
L1268:
now
assume L1269: (for B389 being non  zero Nat holds (B389 in ( dom D154 ) implies ( D154 . B389 ) is (Function of ( free_magma (R27 , B389) ) , R30)));
thus L1270: ((( dom D154 ) = ( 0 ) implies D164 = ( {} )) & (( dom D154 ) = 1 implies D164 = C304)) by L1253;
thus L1271: (for B390 being Nat holds ((B390 >= 2 & ( dom D154 ) = B390) implies (ex B391 being FinSequence st (( len B391 ) = ( B390 - 1 ) & (for B392 being Nat holds ((B392 >= 1 & B392 <= ( B390 - 1 )) implies (ex B393 , B394 being non  zero Nat st (ex B395 being (Function of ( free_magma (R27 , B393) ) , R30) st (ex B396 being (Function of ( free_magma (R27 , B394) ) , R30) st (B393 = B392 & B394 = ( B390 - B392 ) & B395 = ( D154 . B393 ) & B396 = ( D154 . B394 ) & ( B391 . B392 ) = [: B395 , B396 :])))))) & D164 = ( Union B391 )))))
proof
let C309 being Nat;
assume L1272: C309 >= 2;
assume L1273: ( dom D154 ) = C309;
take C308;
thus L1274: ( len C308 ) = ( C309 - 1 ) by L1255 , L1273 , L1267 , FINSEQ_1:def 3;
thus L1275: (for B397 being Nat holds ((B397 >= 1 & B397 <= ( C309 - 1 )) implies (ex B398 , B399 being non  zero Nat st (ex B400 being (Function of ( free_magma (R27 , B398) ) , R30) st (ex B401 being (Function of ( free_magma (R27 , B399) ) , R30) st (B398 = B397 & B399 = ( C309 - B397 ) & B400 = ( D154 . B398 ) & B401 = ( D154 . B399 ) & ( C308 . B397 ) = [: B400 , B401 :]))))))
proof
let C310 being Nat;
assume L1276: C310 >= 1;
assume L1277: C310 <= ( C309 - 1 );
L1278: C310 <= D158 by L1277 , L1273 , XREAL_0:def 2;
L1279: ( C310 + 1 ) <= ( ( D157 - 1 ) + 1 ) by L1273 , L1277 , XREAL_1:7;
L1280: ( ( C310 + 1 ) - C310 ) <= ( D157 - C310 ) by L1279 , XREAL_1:9;
L1281: ( D157 -' C310 ) = ( D157 - C310 ) by L1280 , XREAL_0:def 2;
reconsider D165 = C310 as non  zero Nat by L1276;
reconsider D166 = ( D157 - C310 ) as non  zero Nat by L1280 , L1281;
L1282: C310 in ( Seg D158 ) by L1276 , L1278 , FINSEQ_1:1;
reconsider D167 = ( D154 . D165 ) as (Function of ( free_magma (R27 , D165) ) , R30) by L1282 , L1244 , L1256 , L1255;
L1283: ( - 1 ) >= ( - C310 ) by L1276 , XREAL_1:24;
L1284: ( ( - 1 ) + D157 ) >= ( ( - C310 ) + D157 ) by L1283 , XREAL_1:7;
L1285: D166 in ( Seg D158 ) by L1284 , L1255 , L1280 , FINSEQ_1:1;
reconsider D168 = ( D154 . D166 ) as (Function of ( free_magma (R27 , D166) ) , R30) by L1285 , L1256 , L1244 , L1255;
take D165;
take D166;
take D167;
take D168;
L1286: C310 in ( Seg D158 ) by L1276 , L1278 , FINSEQ_1:1;
L1287: (ex B402 , B403 being non  zero Nat st (ex B404 being (Function of ( free_magma (R27 , B402) ) , R30) st (ex B405 being (Function of ( free_magma (R27 , B403) ) , R30) st (B402 = C310 & B403 = ( D157 - C310 ) & B404 = ( D154 . B402 ) & B405 = ( D154 . B403 ) & ( C308 . C310 ) = [: B404 , B405 :])))) by L1286 , L1267 , L1273 , L1276 , L1277;
thus L1288: (D165 = C310 & D166 = ( C309 - C310 ) & D167 = ( D154 . D165 ) & D168 = ( D154 . D166 )) by L1273;
thus L1289: ( C308 . C310 ) = [: D167 , D168 :] by L1287;
end;

thus L1290: D164 = ( Union C308 );
end;

end;
thus L1272: thesis by L1268 , L1244;
end;
end;
suppose L1274: (not (for B406 being non  zero Nat holds (B406 in ( dom D154 ) implies ( D154 . B406 ) is (Function of ( free_magma (R27 , B406) ) , R30))));

take C304;
thus L1275: thesis by L1274;
end;
end;
consider C311 being Function such that L1277: (( dom C311 ) = ( D153 ^omega ) & (for B407 being set holds (B407 in ( D153 ^omega ) implies S15[ B407 , ( C311 . B407 ) ]))) from CLASSES1:sch 1(L1242);
L1278: (for B408 being Nat holds (for B409 being (XFinSequence of D153) holds ((B408 >= 2 & ( dom B409 ) = B408 & (for B410 being non  zero Nat holds (B410 in ( dom B409 ) implies ( B409 . B410 ) is (Function of ( free_magma (R27 , B410) ) , R30))) & (ex B411 being FinSequence st (( len B411 ) = ( B408 - 1 ) & (for B412 being Nat holds ((B412 >= 1 & B412 <= ( B408 - 1 )) implies (ex B413 , B414 being non  zero Nat st (ex B415 being (Function of ( free_magma (R27 , B413) ) , R30) st (ex B416 being (Function of ( free_magma (R27 , B414) ) , R30) st (B413 = B412 & B414 = ( B408 - B412 ) & B415 = ( B409 . B413 ) & B416 = ( B409 . B414 ) & ( B411 . B412 ) = [: B415 , B416 :])))))) & ( C311 . B409 ) = ( Union B411 )))) implies ( C311 . B409 ) in ( Funcs (( free_magma (R27 , B408) ) , (the carrier of R30)) ))))
proof
let C312 being Nat;
let C313 being (XFinSequence of D153);
assume L1279: C312 >= 2;
assume L1280: ( dom C313 ) = C312;
assume L1281: (for B417 being non  zero Nat holds (B417 in ( dom C313 ) implies ( C313 . B417 ) is (Function of ( free_magma (R27 , B417) ) , R30)));
assume L1282: (ex B418 being FinSequence st (( len B418 ) = ( C312 - 1 ) & (for B419 being Nat holds ((B419 >= 1 & B419 <= ( C312 - 1 )) implies (ex B420 , B421 being non  zero Nat st (ex B422 being (Function of ( free_magma (R27 , B420) ) , R30) st (ex B423 being (Function of ( free_magma (R27 , B421) ) , R30) st (B420 = B419 & B421 = ( C312 - B419 ) & B422 = ( C313 . B420 ) & B423 = ( C313 . B421 ) & ( B418 . B419 ) = [: B422 , B423 :])))))) & ( C311 . C313 ) = ( Union B418 )));
consider C314 being FinSequence such that L1283: ( len C314 ) = ( C312 - 1 ) and L1284: (for B424 being Nat holds ((B424 >= 1 & B424 <= ( C312 - 1 )) implies (ex B425 , B426 being non  zero Nat st (ex B427 being (Function of ( free_magma (R27 , B425) ) , R30) st (ex B428 being (Function of ( free_magma (R27 , B426) ) , R30) st (B425 = B424 & B426 = ( C312 - B424 ) & B427 = ( C313 . B425 ) & B428 = ( C313 . B426 ) & ( C314 . B424 ) = [: B427 , B428 :])))))) and L1285: ( C311 . C313 ) = ( Union C314 ) by L1282;
L1286: (for B429 being set holds (B429 in ( C311 . C313 ) implies (ex B430 , B431 being set st B429 = [ B430 , B431 ])))
proof
let C315 being set;
assume L1287: C315 in ( C311 . C313 );
L1288: C315 in ( union ( rng C314 ) ) by L1287 , L1285 , CARD_3:def 4;
consider C316 being set such that L1289: (C315 in C316 & C316 in ( rng C314 )) by L1288 , TARSKI:def 4;
consider C317 being set such that L1290: (C317 in ( dom C314 ) & C316 = ( C314 . C317 )) by L1289 , FUNCT_1:def 3;
reconsider D169 = C317 as Nat by L1290;
L1291: D169 in ( Seg ( len C314 ) ) by L1290 , FINSEQ_1:def 3;
L1292: (1 <= D169 & D169 <= ( C312 - 1 )) by L1291 , L1283 , FINSEQ_1:1;
consider C318 , C319 being non  zero Nat, C320 being (Function of ( free_magma (R27 , C318) ) , R30), C321 being (Function of ( free_magma (R27 , C319) ) , R30) such that L1293: (C318 = D169 & C319 = ( C312 - D169 ) & C320 = ( C313 . C318 ) & C321 = ( C313 . C319 ) & ( C314 . D169 ) = [: C320 , C321 :]) by L1292 , L1284;
consider C322 , C323 being set such that L1294: C315 = [ C322 , C323 ] by L1289 , L1290 , L1293 , RELAT_1:def 1;
take C322;
take C323;
thus L1295: C315 = [ C322 , C323 ] by L1294;
end;
L1296: (for B432 , B433 , B434 being set holds (([ B432 , B433 ] in ( C311 . C313 ) & [ B432 , B434 ] in ( C311 . C313 )) implies B433 = B434))
proof
let C324 , C325 , C326 being set;
assume L1297: [ C324 , C325 ] in ( C311 . C313 );
L1298: [ C324 , C325 ] in ( union ( rng C314 ) ) by L1297 , L1285 , CARD_3:def 4;
consider C327 being set such that L1299: ([ C324 , C325 ] in C327 & C327 in ( rng C314 )) by L1298 , TARSKI:def 4;
consider C328 being set such that L1300: (C328 in ( dom C314 ) & C327 = ( C314 . C328 )) by L1299 , FUNCT_1:def 3;
reconsider D170 = C328 as Nat by L1300;
L1301: D170 in ( Seg ( len C314 ) ) by L1300 , FINSEQ_1:def 3;
L1302: (1 <= D170 & D170 <= ( C312 - 1 )) by L1301 , L1283 , FINSEQ_1:1;
consider C329 , C330 being non  zero Nat, C331 being (Function of ( free_magma (R27 , C329) ) , R30), C332 being (Function of ( free_magma (R27 , C330) ) , R30) such that L1303: (C329 = D170 & C330 = ( C312 - D170 ) & C331 = ( C313 . C329 ) & C332 = ( C313 . C330 ) & ( C314 . D170 ) = [: C331 , C332 :]) by L1302 , L1284;
L1304: C324 in ( dom [: C331 , C332 :] ) by L1299 , L1300 , L1303 , FUNCT_1:1;
L1305: ( C324 `2 ) in { C329 } by L1304 , MCART_1:10;
L1306: ( C324 `2 ) = C329 by L1305 , TARSKI:def 1;
assume L1307: [ C324 , C326 ] in ( C311 . C313 );
L1308: [ C324 , C326 ] in ( union ( rng C314 ) ) by L1307 , L1285 , CARD_3:def 4;
consider C333 being set such that L1309: ([ C324 , C326 ] in C333 & C333 in ( rng C314 )) by L1308 , TARSKI:def 4;
consider C334 being set such that L1310: (C334 in ( dom C314 ) & C333 = ( C314 . C334 )) by L1309 , FUNCT_1:def 3;
reconsider D171 = C334 as Nat by L1310;
L1311: D171 in ( Seg ( len C314 ) ) by L1310 , FINSEQ_1:def 3;
L1312: (1 <= D171 & D171 <= ( C312 - 1 )) by L1311 , L1283 , FINSEQ_1:1;
consider C335 , C336 being non  zero Nat, C337 being (Function of ( free_magma (R27 , C335) ) , R30), C338 being (Function of ( free_magma (R27 , C336) ) , R30) such that L1313: (C335 = D171 & C336 = ( C312 - D171 ) & C337 = ( C313 . C335 ) & C338 = ( C313 . C336 ) & ( C314 . D171 ) = [: C337 , C338 :]) by L1312 , L1284;
L1314: C324 in ( dom [: C337 , C338 :] ) by L1309 , L1310 , L1313 , FUNCT_1:1;
L1315: ( C324 `2 ) in { C335 } by L1314 , MCART_1:10;
L1316: (C331 = C337 & C332 = C338) by L1315 , L1303 , L1313 , L1306 , TARSKI:def 1;
L1317: ( C324 `1 ) in [: ( free_magma (R27 , C329) ) , ( free_magma (R27 , C330) ) :] by L1304 , MCART_1:10;
reconsider D172 = C324 as (Element of [: [: ( free_magma (R27 , C329) ) , ( free_magma (R27 , C330) ) :] , { C329 } :]) by L1304;
reconsider D173 = ( ( C324 `1 ) `1 ) as (Element of ( free_magma (R27 , C329) )) by L1317 , MCART_1:10;
reconsider D174 = ( ( C324 `1 ) `2 ) as (Element of ( free_magma (R27 , C330) )) by L1317 , MCART_1:10;
L1318: ( C324 `1 ) in [: ( free_magma (R27 , C335) ) , ( free_magma (R27 , C336) ) :] by L1314 , MCART_1:10;
reconsider D175 = C324 as (Element of [: [: ( free_magma (R27 , C335) ) , ( free_magma (R27 , C336) ) :] , { C335 } :]) by L1314;
reconsider D176 = ( ( C324 `1 ) `1 ) as (Element of ( free_magma (R27 , C335) )) by L1318 , MCART_1:10;
reconsider D177 = ( ( C324 `1 ) `2 ) as (Element of ( free_magma (R27 , C336) )) by L1318 , MCART_1:10;
thus L1319: C325 = ( [: C331 , C332 :] . D172 ) by L1299 , L1300 , L1303 , FUNCT_1:1
.= ( ( C331 . D173 ) * ( C332 . D174 ) ) by L1215
.= ( ( C337 . D176 ) * ( C338 . D177 ) ) by L1316
.= ( [: C337 , C338 :] . D175 ) by L1215
.= C326 by L1309 , L1310 , L1313 , FUNCT_1:1;
end;
reconsider D178 = ( C311 . C313 ) as Function by L1296 , L1286 , FUNCT_1:def 1 , RELAT_1:def 1;
L1320: (for R15 being set holds (R15 in ( free_magma (R27 , C312) ) iff (ex R16 being set st [ R15 , R16 ] in D178)))
proof
let R15 being set;
thus L1321:now
assume L1322: R15 in ( free_magma (R27 , C312) );
consider C339 , C340 being Nat such that L1323: (( R15 `2 ) = C339 & 1 <= C339 & C339 <= ( C312 - 1 ) & ( ( R15 `1 ) `1 ) in ( free_magma (R27 , C339) ) & ( ( R15 `1 ) `2 ) in ( free_magma (R27 , C340) ) & C312 = ( C339 + C340 ) & R15 in [: [: ( free_magma (R27 , C339) ) , ( free_magma (R27 , C340) ) :] , { C339 } :]) by L1322 , L1279 , L784;
consider C341 , C342 being non  zero Nat, C343 being (Function of ( free_magma (R27 , C341) ) , R30), C344 being (Function of ( free_magma (R27 , C342) ) , R30) such that L1324: (C341 = C339 & C342 = ( C312 - C339 ) & C343 = ( C313 . C341 ) & C344 = ( C313 . C342 ) & ( C314 . C339 ) = [: C343 , C344 :]) by L1284 , L1323;
reconsider D179 = R15 as (Element of [: [: ( free_magma (R27 , C341) ) , ( free_magma (R27 , C342) ) :] , { C341 } :]) by L1323 , L1324;
reconsider D180 = ( ( R15 `1 ) `1 ) as (Element of ( free_magma (R27 , C341) )) by L1323 , L1324;
reconsider D181 = ( ( R15 `1 ) `2 ) as (Element of ( free_magma (R27 , C342) )) by L1323 , L1324;
reconsider D182 = ( ( C343 . D180 ) * ( C344 . D181 ) ) as set;
L1325: ( dom [: C343 , C344 :] ) = [: [: ( free_magma (R27 , C341) ) , ( free_magma (R27 , C342) ) :] , { C341 } :] by FUNCT_2:def 1;
L1326: ( [: C343 , C344 :] . D179 ) = D182 by L1215;
take D183 = D182;
L1327: [ R15 , D183 ] in ( C314 . C339 ) by L1324 , L1325 , L1326 , FUNCT_1:1;
L1328: C339 in ( Seg ( len C314 ) ) by L1323 , L1283 , FINSEQ_1:1;
L1329: C339 in ( dom C314 ) by L1328 , FINSEQ_1:def 3;
L1330: ( C314 . C339 ) in ( rng C314 ) by L1329 , FUNCT_1:3;
L1331: [ R15 , D183 ] in ( union ( rng C314 ) ) by L1330 , L1327 , TARSKI:def 4;
thus L1332: [ R15 , D183 ] in D178 by L1331 , L1285 , CARD_3:def 4;
end;
given R16 being set such that
L1333: [ R15 , R16 ] in D178;

L1334: [ R15 , R16 ] in ( union ( rng C314 ) ) by L1285 , L1333 , CARD_3:def 4;
consider C345 being set such that L1335: ([ R15 , R16 ] in C345 & C345 in ( rng C314 )) by L1334 , TARSKI:def 4;
consider C346 being set such that L1336: (C346 in ( dom C314 ) & C345 = ( C314 . C346 )) by L1335 , FUNCT_1:def 3;
L1337: C346 in ( Seg ( len C314 ) ) by L1336 , FINSEQ_1:def 3;
reconsider D184 = C346 as Nat by L1336;
L1338: (D184 >= 1 & D184 <= ( C312 - 1 )) by L1337 , L1283 , FINSEQ_1:1;
consider C347 , C348 being non  zero Nat, C349 being (Function of ( free_magma (R27 , C347) ) , R30), C350 being (Function of ( free_magma (R27 , C348) ) , R30) such that L1339: (C347 = D184 & C348 = ( C312 - D184 ) & C349 = ( C313 . C347 ) & C350 = ( C313 . C348 ) & ( C314 . D184 ) = [: C349 , C350 :]) by L1338 , L1284;
L1340: R15 in ( dom [: C349 , C350 :] ) by L1335 , L1336 , L1339 , FUNCT_1:1;
L1341: (( R15 `1 ) in [: ( free_magma (R27 , C347) ) , ( free_magma (R27 , C348) ) :] & ( R15 `2 ) in { C347 }) by L1340 , MCART_1:10;
L1342: (( ( R15 `1 ) `1 ) in ( free_magma (R27 , C347) ) & ( ( R15 `1 ) `2 ) in ( free_magma (R27 , C348) )) by L1341 , MCART_1:10;
L1343: R15 = [ ( R15 `1 ) , ( R15 `2 ) ] by L1340 , MCART_1:21;
L1344: R15 = [ [ ( ( R15 `1 ) `1 ) , ( ( R15 `1 ) `2 ) ] , ( R15 `2 ) ] by L1343 , L1341 , MCART_1:21;
L1345: ( R15 `2 ) = C347 by L1341 , TARSKI:def 1;
L1346: R15 in ( free_magma (R27 , ( C347 + C348 )) ) by L1345 , L1344 , L803 , L1342;
thus L1347: R15 in ( free_magma (R27 , C312) ) by L1346 , L1339;
end;
L1348: ( dom D178 ) = ( free_magma (R27 , C312) ) by L1320 , XTUPLE_0:def 12;
L1349: (for R16 being set holds (R16 in ( rng D178 ) implies R16 in (the carrier of R30)))
proof
let R16 being set;
assume L1350: R16 in ( rng D178 );
consider R15 being set such that L1351: (R15 in ( dom D178 ) & R16 = ( D178 . R15 )) by L1350 , FUNCT_1:def 3;
L1352: [ R15 , R16 ] in ( Union C314 ) by L1285 , L1351 , FUNCT_1:1;
L1353: [ R15 , R16 ] in ( union ( rng C314 ) ) by L1352 , CARD_3:def 4;
consider C351 being set such that L1354: ([ R15 , R16 ] in C351 & C351 in ( rng C314 )) by L1353 , TARSKI:def 4;
consider C352 being set such that L1355: (C352 in ( dom C314 ) & C351 = ( C314 . C352 )) by L1354 , FUNCT_1:def 3;
L1356: C352 in ( Seg ( len C314 ) ) by L1355 , FINSEQ_1:def 3;
reconsider D185 = C352 as Nat by L1355;
L1357: (D185 >= 1 & D185 <= ( C312 - 1 )) by L1356 , L1283 , FINSEQ_1:1;
consider C353 , C354 being non  zero Nat, C355 being (Function of ( free_magma (R27 , C353) ) , R30), C356 being (Function of ( free_magma (R27 , C354) ) , R30) such that L1358: (C353 = D185 & C354 = ( C312 - D185 ) & C355 = ( C313 . C353 ) & C356 = ( C313 . C354 ) & ( C314 . D185 ) = [: C355 , C356 :]) by L1357 , L1284;
L1359: R16 in ( rng [: C355 , C356 :] ) by L1354 , L1355 , L1358 , XTUPLE_0:def 13;
thus L1360: R16 in (the carrier of R30) by L1359;
end;
L1361: ( rng D178 ) c= (the carrier of R30) by L1349 , TARSKI:def 3;
thus L1362: thesis by L1361 , L1348 , FUNCT_2:def 2;
end;
L1363: (for B435 being set holds (B435 in ( D153 ^omega ) implies ( C311 . B435 ) in D153))
proof
let C357 being set;
assume L1364: C357 in ( D153 ^omega );
reconsider D186 = C357 as (XFinSequence of D153) by L1364 , AFINSQ_1:def 7;
per cases ;
suppose L1365: (for B436 being non  zero Nat holds (B436 in ( dom D186 ) implies ( D186 . B436 ) is (Function of ( free_magma (R27 , B436) ) , R30)));

L1366: ((( dom D186 ) = ( 0 ) implies ( C311 . C357 ) = ( {} )) & (( dom D186 ) = 1 implies ( C311 . C357 ) = C304) & (for B437 being Nat holds ((B437 >= 2 & ( dom D186 ) = B437) implies (ex B438 being FinSequence st (( len B438 ) = ( B437 - 1 ) & (for B439 being Nat holds ((B439 >= 1 & B439 <= ( B437 - 1 )) implies (ex B440 , B441 being non  zero Nat st (ex B442 being (Function of ( free_magma (R27 , B440) ) , R30) st (ex B443 being (Function of ( free_magma (R27 , B441) ) , R30) st (B440 = B439 & B441 = ( B437 - B439 ) & B442 = ( D186 . B440 ) & B443 = ( D186 . B441 ) & ( B438 . B439 ) = [: B442 , B443 :])))))) & ( C311 . C357 ) = ( Union B438 )))))) by L1365 , L1364 , L1277;
L1367: (( dom D186 ) = ( 0 ) or ( ( dom D186 ) + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L1368: (( dom D186 ) = ( 0 ) or ( dom D186 ) >= 1) by L1367 , NAT_1:13;
L1369: (( dom D186 ) = ( 0 ) or ( dom D186 ) = 1 or ( dom D186 ) > 1) by L1368 , XXREAL_0:1;
L1370: (( dom D186 ) = ( 0 ) or ( dom D186 ) = 1 or ( ( dom D186 ) + 1 ) > ( 1 + 1 )) by L1369 , XREAL_1:6;
per cases  by L1370 , NAT_1:13;
suppose L1371: ( dom D186 ) = ( 0 );

L1372: ( Funcs (( {} ) , (the carrier of R30)) ) = { ( {} ) } by FUNCT_5:57;
L1373: ( {} ) in ( Funcs (( {} ) , (the carrier of R30)) ) by L1372 , TARSKI:def 1;
L1374: S14[ ( 0 ) , ( C305 . ( 0 ) ) ] by L1235;
L1375: ( C305 . ( 0 ) ) = ( Funcs (( {} ) , (the carrier of R30)) ) by L1374 , L577;
L1376: ( Funcs (( {} ) , (the carrier of R30)) ) in ( rng C305 ) by L1375 , L1235 , FUNCT_1:3;
L1377: ( {} ) in ( union ( rng C305 ) ) by L1376 , L1373 , TARSKI:def 4;
thus L1378: ( C311 . C357 ) in D153 by L1377 , L1371 , L1366 , CARD_3:def 4;
end;
suppose L1379: ( dom D186 ) = 1;

thus L1380: ( C311 . C357 ) in D153 by L1379 , L1241 , L1365 , L1364 , L1277;
end;
suppose L1381: ( dom D186 ) >= 2;

set D187 = ( dom D186 );
L1382: (ex B444 being FinSequence st (( len B444 ) = ( D187 - 1 ) & (for B445 being Nat holds ((B445 >= 1 & B445 <= ( D187 - 1 )) implies (ex B446 , B447 being non  zero Nat st (ex B448 being (Function of ( free_magma (R27 , B446) ) , R30) st (ex B449 being (Function of ( free_magma (R27 , B447) ) , R30) st (B446 = B445 & B447 = ( D187 - B445 ) & B448 = ( D186 . B446 ) & B449 = ( D186 . B447 ) & ( B444 . B445 ) = [: B448 , B449 :])))))) & ( C311 . C357 ) = ( Union B444 ))) by L1365 , L1381 , L1364 , L1277;
L1383: ( C311 . C357 ) in ( Funcs (( free_magma (R27 , D187) ) , (the carrier of R30)) ) by L1382 , L1278 , L1381 , L1365;
L1384: D187 in ( dom C305 ) by L1235 , ORDINAL1:def 12;
L1385: S14[ D187 , ( C305 . D187 ) ] by L1384 , L1235;
L1386: ( Funcs (( free_magma (R27 , D187) ) , (the carrier of R30)) ) in ( rng C305 ) by L1385 , L1384 , FUNCT_1:3;
L1387: ( C311 . C357 ) in ( union ( rng C305 ) ) by L1386 , L1383 , TARSKI:def 4;
thus L1388: ( C311 . C357 ) in D153 by L1387 , CARD_3:def 4;
end;
end;
suppose L1390: (not (for B450 being non  zero Nat holds (B450 in ( dom D186 ) implies ( D186 . B450 ) is (Function of ( free_magma (R27 , B450) ) , R30))));

thus L1391: ( C311 . C357 ) in D153 by L1390 , L1241 , L1364 , L1277;
end;
end;
reconsider D188 = C311 as (Function of ( D153 ^omega ) , D153) by L1363 , L1277 , FUNCT_2:3;
deffunc H6((XFinSequence of D153)) = ( D188 . $1 );
consider C358 being (Function of ( NAT ) , D153) such that L1393: (for B451 being Nat holds ( C358 . B451 ) = H6(( C358 | B451 ))) from FuncRecursiveExist2;
L1394: (for B452 being Nat holds (B452 > ( 0 ) implies ( C358 . B452 ) is (Function of ( free_magma (R27 , B452) ) , R30)))
proof
defpred S17[ Nat ] means (for B453 being Nat holds (($1 = B453 & B453 > ( 0 )) implies ( C358 . B453 ) is (Function of ( free_magma (R27 , B453) ) , R30)));
L1395: (for B454 being Nat holds ((for B455 being Nat holds (B455 < B454 implies S17[ B455 ])) implies S17[ B454 ]))
proof
let C359 being Nat;
assume L1396: (for B456 being Nat holds (B456 < C359 implies S17[ B456 ]));
thus L1397: S17[ C359 ]
proof
let C360 being Nat;
assume L1398: C359 = C360;
assume L1399: C360 > ( 0 );
L1400: (for B457 being non  zero Nat holds (B457 in ( dom ( C358 | C360 ) ) implies ( ( C358 | C360 ) . B457 ) is (Function of ( free_magma (R27 , B457) ) , R30)))
proof
let C361 being non  zero Nat;
assume L1401: C361 in ( dom ( C358 | C360 ) );
L1402: ( ( C358 | C360 ) . C361 ) = ( C358 . C361 ) by L1401 , FUNCT_1:47;
L1403: C361 in C359 by L1398 , L1401;
L1404: C361 < C359 by L1403 , NAT_1:44;
thus L1405: ( ( C358 | C360 ) . C361 ) is (Function of ( free_magma (R27 , C361) ) , R30) by L1404 , L1402 , L1396;
end;
L1406: ( C358 | C360 ) in ( D153 ^omega ) by AFINSQ_1:def 7;
reconsider D189 = ( C358 | C360 ) as (XFinSequence of D153);
L1407: ((( dom D189 ) = ( 0 ) implies ( D188 . D189 ) = ( {} )) & (( dom D189 ) = 1 implies ( D188 . D189 ) = C304) & (for B458 being Nat holds ((B458 >= 2 & ( dom D189 ) = B458) implies (ex B459 being FinSequence st (( len B459 ) = ( B458 - 1 ) & (for B460 being Nat holds ((B460 >= 1 & B460 <= ( B458 - 1 )) implies (ex B461 , B462 being non  zero Nat st (ex B463 being (Function of ( free_magma (R27 , B461) ) , R30) st (ex B464 being (Function of ( free_magma (R27 , B462) ) , R30) st (B461 = B460 & B462 = ( B458 - B460 ) & B463 = ( D189 . B461 ) & B464 = ( D189 . B462 ) & ( B459 . B460 ) = [: B463 , B464 :])))))) & ( D188 . D189 ) = ( Union B459 )))))) by L1400 , L1406 , L1277;
L1408: C360 in ( NAT ) by ORDINAL1:def 12;
L1409: ( dom C358 ) = ( NAT ) by FUNCT_2:def 1;
L1410: C360 c= ( dom C358 ) by L1409 , L1408 , ORDINAL1:def 2;
L1411: ( dom D189 ) = ( ( dom C358 ) /\ C360 ) by RELAT_1:61
.= C360 by L1410 , XBOOLE_1:28;
L1412: ( D188 . D189 ) is (Function of ( free_magma (R27 , C360) ) , R30)
proof
L1413: (C360 = ( 0 ) or ( C360 + 1 ) > ( ( 0 ) + 1 )) by XREAL_1:6;
L1414: (C360 = ( 0 ) or C360 >= 1) by L1413 , NAT_1:13;
L1415: (C360 = ( 0 ) or C360 = 1 or C360 > 1) by L1414 , XXREAL_0:1;
L1416: (C360 = ( 0 ) or C360 = 1 or ( C360 + 1 ) > ( 1 + 1 )) by L1415 , XREAL_1:6;
per cases  by L1416 , NAT_1:13;
suppose L1417: C360 = ( 0 );

L1418: ( Funcs (( {} ) , (the carrier of R30)) ) = { ( {} ) } by FUNCT_5:57;
L1419: ( D188 . D189 ) in ( Funcs (( {} ) , (the carrier of R30)) ) by L1418 , L1417 , L1407 , TARSKI:def 1;
L1420: ( D188 . D189 ) in ( Funcs (( free_magma (R27 , C360) ) , (the carrier of R30)) ) by L1419 , L1417 , L577;
L1421: (ex B465 being Function st (( D188 . D189 ) = B465 & ( dom B465 ) = ( free_magma (R27 , C360) ) & ( rng B465 ) c= (the carrier of R30))) by L1420 , FUNCT_2:def 2;
thus L1422: thesis by L1421 , FUNCT_2:2;
end;
suppose L1423: C360 = 1;

L1424: ( free_magma (R27 , 1) ) = R27 by L577;
thus L1425: thesis by L1424 , L1400 , L1406 , L1277 , L1423 , L1411;
end;
suppose L1426: C360 >= 2;

L1427: (ex B466 being FinSequence st (( len B466 ) = ( C360 - 1 ) & (for B467 being Nat holds ((B467 >= 1 & B467 <= ( C360 - 1 )) implies (ex B468 , B469 being non  zero Nat st (ex B470 being (Function of ( free_magma (R27 , B468) ) , R30) st (ex B471 being (Function of ( free_magma (R27 , B469) ) , R30) st (B468 = B467 & B469 = ( C360 - B467 ) & B470 = ( D189 . B468 ) & B471 = ( D189 . B469 ) & ( B466 . B467 ) = [: B470 , B471 :])))))) & ( D188 . D189 ) = ( Union B466 ))) by L1426 , L1400 , L1406 , L1277 , L1411;
L1428: ( D188 . D189 ) in ( Funcs (( free_magma (R27 , C360) ) , (the carrier of R30)) ) by L1427 , L1278 , L1426 , L1411 , L1400;
L1429: (ex B472 being Function st (( D188 . D189 ) = B472 & ( dom B472 ) = ( free_magma (R27 , C360) ) & ( rng B472 ) c= (the carrier of R30))) by L1428 , FUNCT_2:def 2;
thus L1430: thesis by L1429 , FUNCT_2:2;
end;
end;
thus L1432: ( C358 . C360 ) is (Function of ( free_magma (R27 , C360) ) , R30) by L1412 , L1393;
end;

end;
L1398: (for B473 being Nat holds S17[ B473 ]) from NAT_1:sch 4(L1395);
thus L1399: thesis by L1398;
end;
reconsider D190 = (the carrier of ( free_magma R27 )) as set;
defpred S18[ set , set ] means (for B474 being (Element of ( free_magma R27 )) holds (for B475 being (Function of ( free_magma (R27 , ( B474 `2 )) ) , R30) holds ((B474 = $1 & B475 = ( C358 . ( B474 `2 ) )) implies $2 = ( B475 . ( B474 `1 ) ))));
L1400: (for R15 being set holds (R15 in D190 implies (ex R16 being set st (R16 in (the carrier of R30) & S18[ R15 , R16 ]))))
proof
let R15 being set;
assume L1401: R15 in D190;
reconsider D191 = R15 as (Element of ( free_magma R27 )) by L1401;
reconsider D192 = ( C358 . ( D191 `2 ) ) as (Function of ( free_magma (R27 , ( D191 `2 )) ) , R30) by L1394;
set D193 = ( D192 . ( D191 `1 ) );
take D193;
L1402: D191 in [: ( free_magma (R27 , ( D191 `2 )) ) , { ( D191 `2 ) } :] by L901;
L1403: ( D191 `1 ) in ( free_magma (R27 , ( D191 `2 )) ) by L1402 , MCART_1:10;
thus L1404: D193 in (the carrier of R30) by L1403 , FUNCT_2:5;
thus L1405: S18[ R15 , D193 ];
end;
consider C362 being (Function of D190 , (the carrier of R30)) such that L1406: (for R15 being set holds (R15 in D190 implies S18[ R15 , ( C362 . R15 ) ])) from FUNCT_2:sch 1(L1400);
reconsider D194 = C362 as (Function of ( free_magma R27 ) , R30);
take D194;
L1407: (for B476 , B477 being (Element of ( free_magma R27 )) holds ( D194 . ( B476 * B477 ) ) = ( ( D194 . B476 ) * ( D194 . B477 ) ))
proof
let C363 , C364 being (Element of ( free_magma R27 ));
reconsider D195 = ( C358 . ( ( C363 * C364 ) `2 ) ) as (Function of ( free_magma (R27 , ( ( C363 * C364 ) `2 )) ) , R30) by L1394;
L1408: ( C363 * C364 ) = [ [ [ ( C363 `1 ) , ( C364 `1 ) ] , ( C363 `2 ) ] , ( ( length C363 ) + ( length C364 ) ) ] by L1018;
L1409: (( ( C363 * C364 ) `1 ) = [ [ ( C363 `1 ) , ( C364 `1 ) ] , ( C363 `2 ) ] & ( ( C363 * C364 ) `2 ) = ( ( length C363 ) + ( length C364 ) )) by L1408 , MCART_1:7;
L1410: D195 = ( D188 . ( C358 | ( ( length C363 ) + ( length C364 ) ) ) ) by L1409 , L1393;
L1411: ( C358 | ( ( length C363 ) + ( length C364 ) ) ) in ( D153 ^omega ) by AFINSQ_1:def 7;
L1412: (for B478 being non  zero Nat holds (B478 in ( dom ( C358 | ( ( length C363 ) + ( length C364 ) ) ) ) implies ( ( C358 | ( ( length C363 ) + ( length C364 ) ) ) . B478 ) is (Function of ( free_magma (R27 , B478) ) , R30)))
proof
let C365 being non  zero Nat;
assume L1413: C365 in ( dom ( C358 | ( ( length C363 ) + ( length C364 ) ) ) );
L1414: ( C358 . C365 ) is (Function of ( free_magma (R27 , C365) ) , R30) by L1394;
thus L1415: thesis by L1414 , L1413 , FUNCT_1:47;
end;
set D196 = ( ( length C363 ) + ( length C364 ) );
L1416: (( length C363 ) >= 1 & ( length C364 ) >= 1) by L1022;
L1417: ( ( length C363 ) + ( length C364 ) ) >= ( 1 + 1 ) by L1416 , XREAL_1:7;
L1418: D196 in ( NAT ) by ORDINAL1:def 12;
L1419: ( dom C358 ) = ( NAT ) by FUNCT_2:def 1;
L1420: D196 c= ( dom C358 ) by L1419 , L1418 , ORDINAL1:def 2;
L1421: ( dom ( C358 | D196 ) ) = ( ( dom C358 ) /\ D196 ) by RELAT_1:61
.= D196 by L1420 , XBOOLE_1:28;
consider C366 being FinSequence such that L1422: ( len C366 ) = ( D196 - 1 ) and L1423: (for B479 being Nat holds ((B479 >= 1 & B479 <= ( D196 - 1 )) implies (ex B480 , B481 being non  zero Nat st (ex B482 being (Function of ( free_magma (R27 , B480) ) , R30) st (ex B483 being (Function of ( free_magma (R27 , B481) ) , R30) st (B480 = B479 & B481 = ( D196 - B479 ) & B482 = ( ( C358 | D196 ) . B480 ) & B483 = ( ( C358 | D196 ) . B481 ) & ( C366 . B479 ) = [: B482 , B483 :])))))) and L1424: D195 = ( Union C366 ) by L1421 , L1412 , L1417 , L1411 , L1277 , L1410;
L1425: ( C363 * C364 ) in [: ( free_magma (R27 , ( ( C363 * C364 ) `2 )) ) , { ( ( C363 * C364 ) `2 ) } :] by L901;
L1426: ( ( C363 * C364 ) `1 ) in ( free_magma (R27 , ( ( C363 * C364 ) `2 )) ) by L1425 , MCART_1:10;
L1427: ( ( C363 * C364 ) `1 ) in ( dom D195 ) by L1426 , FUNCT_2:def 1;
L1428: [ ( ( C363 * C364 ) `1 ) , ( D195 . ( ( C363 * C364 ) `1 ) ) ] in ( Union C366 ) by L1427 , L1424 , FUNCT_1:1;
L1429: [ ( ( C363 * C364 ) `1 ) , ( D195 . ( ( C363 * C364 ) `1 ) ) ] in ( union ( rng C366 ) ) by L1428 , CARD_3:def 4;
consider C367 being set such that L1430: ([ ( ( C363 * C364 ) `1 ) , ( D195 . ( ( C363 * C364 ) `1 ) ) ] in C367 & C367 in ( rng C366 )) by L1429 , TARSKI:def 4;
consider C368 being set such that L1431: (C368 in ( dom C366 ) & C367 = ( C366 . C368 )) by L1430 , FUNCT_1:def 3;
L1432: C368 in ( Seg ( len C366 ) ) by L1431 , FINSEQ_1:def 3;
reconsider D197 = C368 as Nat by L1431;
L1433: (D197 >= 1 & D197 <= ( D196 - 1 )) by L1432 , L1422 , FINSEQ_1:1;
consider C369 , C370 being non  zero Nat, C371 being (Function of ( free_magma (R27 , C369) ) , R30), C372 being (Function of ( free_magma (R27 , C370) ) , R30) such that L1434: (C369 = D197 & C370 = ( D196 - D197 ) & C371 = ( ( C358 | D196 ) . C369 ) & C372 = ( ( C358 | D196 ) . C370 ) & ( C366 . D197 ) = [: C371 , C372 :]) by L1433 , L1423;
L1435: ( ( C363 * C364 ) `1 ) in ( dom [: C371 , C372 :] ) by L1434 , L1430 , L1431 , FUNCT_1:1;
L1436: (( ( ( C363 * C364 ) `1 ) `1 ) in [: ( free_magma (R27 , C369) ) , ( free_magma (R27 , C370) ) :] & ( ( ( C363 * C364 ) `1 ) `2 ) in { C369 }) by L1435 , MCART_1:10;
L1437: ([ ( C363 `1 ) , ( C364 `1 ) ] in [: ( free_magma (R27 , C369) ) , ( free_magma (R27 , C370) ) :] & ( C363 `2 ) in { C369 }) by L1436 , L1409 , MCART_1:7;
L1438: C369 = ( C363 `2 ) by L1437 , TARSKI:def 1;
L1439: C369 = ( length C363 ) by L1438 , L993;
L1440: ( length C364 ) >= ( ( 0 ) + 1 ) by L1022;
L1441: ( ( length C364 ) + ( length C363 ) ) > ( ( 0 ) + ( length C363 ) ) by L1440 , XREAL_1:6;
L1442: C369 in D196 by L1441 , L1439 , NAT_1:44;
L1443: ( length C363 ) >= ( ( 0 ) + 1 ) by L1022;
L1444: ( ( length C363 ) + ( length C364 ) ) > ( ( 0 ) + ( length C364 ) ) by L1443 , XREAL_1:6;
L1445: C370 in D196 by L1444 , L1439 , L1434 , NAT_1:44;
reconsider D198 = ( ( C363 * C364 ) `1 ) as (Element of [: [: ( free_magma (R27 , C369) ) , ( free_magma (R27 , C370) ) :] , { C369 } :]) by L1435;
L1446: ( D198 `1 ) in [: ( free_magma (R27 , C369) ) , ( free_magma (R27 , C370) ) :] by MCART_1:10;
reconsider D199 = ( ( D198 `1 ) `1 ) as (Element of ( free_magma (R27 , C369) )) by L1446 , MCART_1:10;
reconsider D200 = ( ( D198 `1 ) `2 ) as (Element of ( free_magma (R27 , C370) )) by L1446 , MCART_1:10;
L1447: ( D198 `1 ) = [ ( C363 `1 ) , ( C364 `1 ) ] by L1409 , MCART_1:7;
L1448: ( [: C371 , C372 :] . D198 ) = ( ( C371 . D199 ) * ( C372 . D200 ) ) by L1215;
L1449: ( D194 . ( C363 * C364 ) ) = ( D195 . ( ( C363 * C364 ) `1 ) ) by L1406;
L1450: ( D195 . ( ( C363 * C364 ) `1 ) ) = ( [: C371 , C372 :] . D198 ) by L1434 , L1430 , L1431 , FUNCT_1:1;
reconsider D201 = ( C358 . ( C363 `2 ) ) as (Function of ( free_magma (R27 , ( C363 `2 )) ) , R30) by L1394;
reconsider D202 = ( C358 . ( C364 `2 ) ) as (Function of ( free_magma (R27 , ( C364 `2 )) ) , R30) by L1394;
L1451: C371 = ( C358 . C369 ) by L1434 , L1442 , FUNCT_1:49
.= D201 by L1437 , TARSKI:def 1;
L1452: ( D201 . ( C363 `1 ) ) = ( C371 . D199 ) by L1451 , L1447 , MCART_1:7;
L1453: C372 = ( C358 . C370 ) by L1434 , L1445 , FUNCT_1:49
.= D202 by L993 , L1439 , L1434;
L1454: ( D202 . ( C364 `1 ) ) = ( C372 . D200 ) by L1453 , L1447 , MCART_1:7;
L1455: ( D194 . C364 ) = ( D202 . ( C364 `1 ) ) by L1406;
thus L1456: ( D194 . ( C363 * C364 ) ) = ( ( D194 . C363 ) * ( D194 . C364 ) ) by L1455 , L1448 , L1449 , L1452 , L1454 , L1406 , L1450;
end;
thus L1457: D194 is  multiplicative by L1407 , GROUP_6:def 6;
set D203 = ( canon_image (R27 , 1) );
L1458: (for R15 being set holds (R15 in ( dom ( C304 * ( D203 " ) ) ) implies R15 in ( dom D194 )))
proof
let R15 being set;
assume L1459: R15 in ( dom ( C304 * ( D203 " ) ) );
L1460: ( dom ( C304 * ( D203 " ) ) ) c= ( dom ( D203 " ) ) by RELAT_1:25;
L1461: R15 in ( dom ( D203 " ) ) by L1460 , L1459;
L1462: R15 in ( rng D203 ) by L1461 , FUNCT_1:33;
L1463: R15 in (the carrier of ( free_magma R27 )) by L1462;
thus L1464: R15 in ( dom D194 ) by L1463 , FUNCT_2:def 1;
end;
L1465: ( dom ( C304 * ( D203 " ) ) ) c= ( dom D194 ) by L1458 , TARSKI:def 3;
L1466: (for R15 being set holds (R15 in ( ( dom D194 ) /\ ( dom ( C304 * ( D203 " ) ) ) ) implies ( D194 . R15 ) = ( ( C304 * ( D203 " ) ) . R15 )))
proof
let R15 being set;
assume L1467: R15 in ( ( dom D194 ) /\ ( dom ( C304 * ( D203 " ) ) ) );
L1468: R15 in ( dom ( C304 * ( D203 " ) ) ) by L1467 , L1465 , XBOOLE_1:28;
L1469: ( dom ( C304 * ( D203 " ) ) ) c= ( dom ( D203 " ) ) by RELAT_1:25;
L1470: R15 in ( dom ( D203 " ) ) by L1469 , L1468;
L1471: R15 in ( rng D203 ) by L1470 , FUNCT_1:33;
consider C373 being set such that L1472: (C373 in ( dom D203 ) & R15 = ( D203 . C373 )) by L1471 , FUNCT_1:def 3;
L1473: 1 in { 1 } by TARSKI:def 1;
L1474: [: ( free_magma (R27 , 1) ) , { 1 } :] c= ( free_magma_carrier R27 ) by L833;
L1475: [: R27 , { 1 } :] c= ( free_magma_carrier R27 ) by L1474 , L577;
L1476: C373 in R27 by L1472 , L1144;
L1477: R15 = [ C373 , 1 ] by L1472 , L1097;
L1478: R15 in [: R27 , { 1 } :] by L1477 , L1473 , L1476 , ZFMISC_1:def 2;
reconsider D204 = R15 as (Element of ( free_magma R27 )) by L1478 , L1475;
L1479: ( ( D203 " ) . R15 ) = C373 by L1472 , FUNCT_1:34;
set D205 = ( C358 . ( D204 `2 ) );
reconsider D206 = D205 as (Function of ( free_magma (R27 , ( D204 `2 )) ) , R30) by L1394;
L1480: D206 = ( C358 . 1 ) by L1477 , MCART_1:7
.= H6(( C358 | 1 )) by L1393;
L1481: (for B484 being non  zero Nat holds (B484 in ( dom ( C358 | 1 ) ) implies ( ( C358 | 1 ) . B484 ) is (Function of ( free_magma (R27 , B484) ) , R30)))
proof
let C374 being non  zero Nat;
assume L1482: C374 in ( dom ( C358 | 1 ) );
L1483: ( ( C358 | 1 ) . C374 ) = ( C358 . C374 ) by L1482 , FUNCT_1:47;
thus L1484: ( ( C358 | 1 ) . C374 ) is (Function of ( free_magma (R27 , C374) ) , R30) by L1483 , L1394;
end;
L1485: ( C358 | 1 ) in ( D153 ^omega ) by AFINSQ_1:def 7;
reconsider D207 = ( C358 | 1 ) as (XFinSequence of D153);
L1486: ( dom C358 ) = ( NAT ) by FUNCT_2:def 1;
L1487: 1 c= ( dom C358 ) by L1486 , ORDINAL1:def 2;
L1488: ( dom D207 ) = ( ( dom C358 ) /\ 1 ) by RELAT_1:61
.= 1 by L1487 , XBOOLE_1:28;
thus L1489: ( D194 . R15 ) = ( D206 . ( D204 `1 ) ) by L1406
.= ( D206 . C373 ) by L1477 , MCART_1:7
.= ( C304 . ( ( D203 " ) . R15 ) ) by L1479 , L1480 , L1488 , L1481 , L1485 , L1277
.= ( ( C304 * ( D203 " ) ) . R15 ) by L1469 , L1468 , FUNCT_1:13;
end;
L1490: D194 tolerates ( C304 * ( D203 " ) ) by L1466 , PARTFUN1:def 4;
thus L1491: D194 extends ( C304 * ( ( canon_image (R27 , 1) ) " ) ) by L1490 , L1465 , L55;
end;
theorem
L1492: (for R27 being non  empty set holds (for R30 being non  empty multMagma holds (for B485 being (Function of R27 , R30) holds (for B486 , B487 being (Function of ( free_magma R27 ) , R30) holds ((B486 is  multiplicative & B486 extends ( B485 * ( ( canon_image (R27 , 1) ) " ) ) & B487 is  multiplicative & B487 extends ( B485 * ( ( canon_image (R27 , 1) ) " ) )) implies B486 = B487)))))
proof
let R27 being non  empty set;
let R30 being non  empty multMagma;
let C375 being (Function of R27 , R30);
let C376 , C377 being (Function of ( free_magma R27 ) , R30);
assume L1493: C376 is  multiplicative;
assume L1494: C376 extends ( C375 * ( ( canon_image (R27 , 1) ) " ) );
assume L1495: C377 is  multiplicative;
assume L1496: C377 extends ( C375 * ( ( canon_image (R27 , 1) ) " ) );
defpred S19[ Nat ] means (for B488 being (Element of ( free_magma R27 )) holds (( length B488 ) = $1 implies ( C376 . B488 ) = ( C377 . B488 )));
L1497: (for B489 being Nat holds ((for B490 being Nat holds (B490 < B489 implies S19[ B490 ])) implies S19[ B489 ]))
proof
let C378 being Nat;
assume L1498: (for B491 being Nat holds (B491 < C378 implies S19[ B491 ]));
thus L1499: (for B492 being (Element of ( free_magma R27 )) holds (( length B492 ) = C378 implies ( C376 . B492 ) = ( C377 . B492 )))
proof
let C379 being (Element of ( free_magma R27 ));
assume L1500: ( length C379 ) = C378;
L1501: (C379 = [ ( C379 `1 ) , ( C379 `2 ) ] & ( length C379 ) >= 1) by L1022;
L1502: (( length C379 ) = 1 or ( length C379 ) > 1) by L1501 , XXREAL_0:1;
L1503: (( length C379 ) = 1 or ( ( length C379 ) + 1 ) > ( 1 + 1 )) by L1502 , XREAL_1:8;
per cases  by L1503 , NAT_1:13;
suppose L1504: ( length C379 ) = 1;

set D208 = ( C379 `1 );
L1505: D208 in { ( B493 `1 ) where B493 is (Element of ( free_magma R27 )) : ( length B493 ) = 1 } by L1504;
L1506: D208 in R27 by L1505 , L995;
L1507: (( dom ( C375 * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom C376 ) & C376 tolerates ( C375 * ( ( canon_image (R27 , 1) ) " ) )) by L55 , L1494;
L1508: (( dom ( C375 * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom C377 ) & C377 tolerates ( C375 * ( ( canon_image (R27 , 1) ) " ) )) by L55 , L1496;
L1509: ( ( canon_image (R27 , 1) ) . D208 ) = [ D208 , 1 ] by L1506 , L1144
.= C379 by L993 , L1501 , L1504;
L1510: D208 in ( dom ( canon_image (R27 , 1) ) ) by L1506 , L1144;
L1511: C379 in ( rng ( canon_image (R27 , 1) ) ) by L1510 , L1509 , FUNCT_1:3;
L1512: C379 in ( dom ( ( canon_image (R27 , 1) ) " ) ) by L1511 , FUNCT_1:33;
L1513: R27 c= ( dom C375 ) by FUNCT_2:def 1;
L1514: ( dom ( canon_image (R27 , 1) ) ) c= ( dom C375 ) by L1513 , L1144;
L1515: ( rng ( ( canon_image (R27 , 1) ) " ) ) c= ( dom C375 ) by L1514 , FUNCT_1:33;
L1516: C379 in ( dom ( C375 * ( ( canon_image (R27 , 1) ) " ) ) ) by L1515 , L1512 , RELAT_1:27;
L1517: (C379 in ( ( dom C376 ) /\ ( dom ( C375 * ( ( canon_image (R27 , 1) ) " ) ) ) ) & C379 in ( ( dom C377 ) /\ ( dom ( C375 * ( ( canon_image (R27 , 1) ) " ) ) ) )) by L1516 , L1507 , L1508 , XBOOLE_1:28;
L1518: (( C376 . C379 ) = ( ( C375 * ( ( canon_image (R27 , 1) ) " ) ) . C379 ) & ( C377 . C379 ) = ( ( C375 * ( ( canon_image (R27 , 1) ) " ) ) . C379 )) by L1517 , L1507 , L1508 , PARTFUN1:def 4;
thus L1519: thesis by L1518;
end;
suppose L1520: ( length C379 ) >= 2;

consider C380 , C381 being (Element of ( free_magma R27 )) such that L1521: (C379 = ( C380 * C381 ) & ( length C380 ) < ( length C379 ) & ( length C381 ) < ( length C379 )) by L1520 , L1038;
L1522: (( C376 . C380 ) = ( C377 . C380 ) & ( C376 . C381 ) = ( C377 . C381 )) by L1498 , L1500 , L1521;
L1523: ( C376 . ( C380 * C381 ) ) = ( ( C377 . C380 ) * ( C377 . C381 ) ) by L1522 , L1493 , GROUP_6:def 6;
thus L1524: ( C376 . C379 ) = ( C377 . C379 ) by L1523 , L1521 , L1495 , GROUP_6:def 6;
end;
end;

end;
L1500: (for B494 being Nat holds S19[ B494 ]) from NAT_1:sch 4(L1497);
L1501: (for B495 being (Element of ( free_magma R27 )) holds ( C376 . B495 ) = ( C377 . B495 ))
proof
let C382 being (Element of ( free_magma R27 ));
reconsider D209 = ( length C382 ) as Nat;
L1502: S19[ D209 ] by L1500;
thus L1503: ( C376 . C382 ) = ( C377 . C382 ) by L1502;
end;
L1504: (for R15 being set holds (R15 in (the carrier of ( free_magma R27 )) implies ( C376 . R15 ) = ( C377 . R15 ))) by L1501;
thus L1505: C376 = C377 by L1504 , FUNCT_2:12;
end;
theorem
L1506: (for R31 being non  empty multMagma holds (for R32 being non  empty multMagma holds (for R33 being (Function of R31 , R32) holds (for R34 being non  empty (multSubmagma of R32) holds (for R35 being  compatible (Equivalence_Relation of R31) holds ((R33 is  multiplicative & (the carrier of R34) = ( rng R33 ) & R35 = ( equ_kernel R33 )) implies (ex B496 being (Function of ( R31 ./. R35 ) , R34) st (R33 = ( B496 * ( nat_hom R35 ) ) & B496 is  bijective & B496 is  multiplicative))))))))
proof
let R31 being non  empty multMagma;
let R32 being non  empty multMagma;
let R33 being (Function of R31 , R32);
let R34 being non  empty (multSubmagma of R32);
let R35 being  compatible (Equivalence_Relation of R31);
assume L1507: R33 is  multiplicative;
assume L1508: (the carrier of R34) = ( rng R33 );
assume L1509: R35 = ( equ_kernel R33 );
set D210 = ( ( ( nat_hom R35 ) ~ ) * R33 );
L1510: (for B497 , B498 , B499 being set holds (([ B497 , B498 ] in D210 & [ B497 , B499 ] in D210) implies B498 = B499))
proof
let C383 , C384 , C385 being set;
assume L1511: [ C383 , C384 ] in D210;
consider C386 being set such that L1512: ([ C383 , C386 ] in ( ( nat_hom R35 ) ~ ) & [ C386 , C384 ] in R33) by L1511 , RELAT_1:def 8;
assume L1513: [ C383 , C385 ] in D210;
consider C387 being set such that L1514: ([ C383 , C387 ] in ( ( nat_hom R35 ) ~ ) & [ C387 , C385 ] in R33) by L1513 , RELAT_1:def 8;
L1515: ([ C386 , C383 ] in ( nat_hom R35 ) & [ C387 , C383 ] in ( nat_hom R35 )) by L1512 , L1514 , RELAT_1:def 7;
L1516: (C386 in ( dom ( nat_hom R35 ) ) & C387 in ( dom ( nat_hom R35 ) )) by L1515 , XTUPLE_0:def 12;
reconsider D211 = C386 , D212 = C387 as (Element of R31) by L1516;
L1517: (C383 = ( ( nat_hom R35 ) . D211 ) & C383 = ( ( nat_hom R35 ) . D212 )) by L1515 , FUNCT_1:1;
L1518: (( R33 . D211 ) = C384 & ( R33 . D212 ) = C385) by L1512 , L1514 , FUNCT_1:1;
L1519: (( ( nat_hom R35 ) . D211 ) = ( Class (R35 , D211) ) & ( ( nat_hom R35 ) . D212 ) = ( Class (R35 , D212) )) by L123;
L1520: D212 in ( Class (R35 , D211) ) by L1519 , L1517 , EQREL_1:23;
L1521: [ D211 , D212 ] in ( equ_kernel R33 ) by L1520 , L1509 , EQREL_1:18;
thus L1522: C384 = C385 by L1521 , L1518 , L216;
end;
reconsider D213 = D210 as Function by L1510 , FUNCT_1:def 1;
L1523: ( rng ( nat_hom R35 ) ) = (the carrier of ( R31 ./. R35 )) by FUNCT_2:def 3;
L1524: ( dom ( ( nat_hom R35 ) ~ ) ) = (the carrier of ( R31 ./. R35 )) by L1523 , RELAT_1:20;
L1525: (the carrier of R31) c= ( dom R33 ) by FUNCT_2:def 1;
L1526: ( dom ( nat_hom R35 ) ) c= ( dom R33 ) by L1525 , FUNCT_2:def 1;
L1527: ( rng ( ( nat_hom R35 ) ~ ) ) c= ( dom R33 ) by L1526 , RELAT_1:20;
L1528: ( dom D213 ) = (the carrier of ( R31 ./. R35 )) by L1527 , L1524 , RELAT_1:27;
L1529: ( dom R33 ) c= (the carrier of R31);
L1530: ( dom R33 ) c= ( dom ( nat_hom R35 ) ) by L1529 , FUNCT_2:def 1;
L1531: ( dom R33 ) c= ( rng ( ( nat_hom R35 ) ~ ) ) by L1530 , RELAT_1:20;
L1532: ( rng D213 ) = (the carrier of R34) by L1531 , L1508 , RELAT_1:28;
reconsider D214 = D213 as (Function of ( R31 ./. R35 ) , R34) by L1532 , L1528 , FUNCT_2:1;
take D214;
L1533: (for B500 , B501 being set holds ((B500 in ( dom D214 ) & B501 in ( dom D214 ) & ( D214 . B500 ) = ( D214 . B501 )) implies B500 = B501))
proof
let C388 , C389 being set;
assume L1534: C388 in ( dom D214 );
assume L1535: C389 in ( dom D214 );
assume L1536: ( D214 . C388 ) = ( D214 . C389 );
set D215 = ( D214 . C388 );
L1537: [ C388 , D215 ] in D214 by L1534 , FUNCT_1:1;
consider C390 being set such that L1538: ([ C388 , C390 ] in ( ( nat_hom R35 ) ~ ) & [ C390 , D215 ] in R33) by L1537 , RELAT_1:def 8;
L1539: [ C389 , D215 ] in D214 by L1536 , L1535 , FUNCT_1:1;
consider C391 being set such that L1540: ([ C389 , C391 ] in ( ( nat_hom R35 ) ~ ) & [ C391 , D215 ] in R33) by L1539 , RELAT_1:def 8;
L1541: ([ C390 , C388 ] in ( nat_hom R35 ) & [ C391 , C389 ] in ( nat_hom R35 )) by L1538 , L1540 , RELAT_1:def 7;
L1542: (C390 in ( dom ( nat_hom R35 ) ) & C391 in ( dom ( nat_hom R35 ) )) by L1541 , XTUPLE_0:def 12;
reconsider D216 = C390 , D217 = C391 as (Element of R31) by L1542;
L1543: (D216 in ( dom R33 ) & D217 in ( dom R33 ) & ( R33 . D216 ) = D215 & ( R33 . D217 ) = D215) by L1538 , L1540 , FUNCT_1:1;
L1544: [ D216 , D217 ] in ( equ_kernel R33 ) by L1543 , L216;
L1545: D217 in ( Class (R35 , D216) ) by L1544 , L1509 , EQREL_1:18;
L1546: (( ( nat_hom R35 ) . D216 ) = ( Class (R35 , D216) ) & ( ( nat_hom R35 ) . D217 ) = ( Class (R35 , D217) )) by L123;
L1547: (C388 = ( ( nat_hom R35 ) . D216 ) & C389 = ( ( nat_hom R35 ) . D217 )) by L1541 , FUNCT_1:1;
thus L1548: C388 = C389 by L1547 , L1546 , L1545 , EQREL_1:23;
end;
L1549: D214 is  one-to-one by L1533 , FUNCT_1:def 4;
L1550: (for R15 being set holds (R15 in ( dom R33 ) iff (R15 in ( dom ( nat_hom R35 ) ) & ( ( nat_hom R35 ) . R15 ) in ( dom D214 ))))
proof
let R15 being set;
thus L1551:now
assume L1552: R15 in ( dom R33 );
L1553: R15 in (the carrier of R31) by L1552;
thus L1554: R15 in ( dom ( nat_hom R35 ) ) by L1553 , FUNCT_2:def 1;
L1555: ( ( nat_hom R35 ) . R15 ) in ( rng ( nat_hom R35 ) ) by L1554 , FUNCT_1:3;
L1556: ( ( nat_hom R35 ) . R15 ) in (the carrier of ( R31 ./. R35 )) by L1555;
thus L1557: ( ( nat_hom R35 ) . R15 ) in ( dom D214 ) by L1556 , FUNCT_2:def 1;
end;
assume L1558: (R15 in ( dom ( nat_hom R35 ) ) & ( ( nat_hom R35 ) . R15 ) in ( dom D214 ));
L1559: R15 in (the carrier of R31) by L1558;
thus L1560: R15 in ( dom R33 ) by L1559 , FUNCT_2:def 1;
end;
L1561: (for R15 being set holds (R15 in ( dom R33 ) implies ( R33 . R15 ) = ( D214 . ( ( nat_hom R35 ) . R15 ) )))
proof
let R15 being set;
assume L1562: R15 in ( dom R33 );
set D218 = ( ( nat_hom R35 ) . R15 );
L1563: D218 in ( dom D214 ) by L1562 , L1550;
L1564: [ D218 , ( D214 . D218 ) ] in D214 by L1563 , FUNCT_1:1;
consider C392 being set such that L1565: ([ D218 , C392 ] in ( ( nat_hom R35 ) ~ ) & [ C392 , ( D214 . D218 ) ] in R33) by L1564 , RELAT_1:def 8;
L1566: [ C392 , D218 ] in ( nat_hom R35 ) by L1565 , RELAT_1:def 7;
L1567: (C392 in ( dom ( nat_hom R35 ) ) & D218 = ( ( nat_hom R35 ) . C392 )) by L1566 , FUNCT_1:1;
L1568: (C392 in ( dom R33 ) & ( D214 . D218 ) = ( R33 . C392 )) by L1565 , FUNCT_1:1;
reconsider D219 = C392 , D220 = R15 as (Element of R31) by L1568 , L1562;
L1569: (( ( nat_hom R35 ) . D219 ) = ( Class (R35 , D219) ) & ( ( nat_hom R35 ) . D220 ) = ( Class (R35 , D220) )) by L123;
L1570: D219 in ( Class (R35 , D220) ) by L1569 , L1567 , EQREL_1:23;
L1571: [ R15 , C392 ] in R35 by L1570 , EQREL_1:18;
thus L1572: ( R33 . R15 ) = ( D214 . ( ( nat_hom R35 ) . R15 ) ) by L1571 , L1568 , L1509 , L216;
end;
thus L1573: R33 = ( D214 * ( nat_hom R35 ) ) by L1561 , L1550 , FUNCT_1:10;
L1574: D214 is  onto by L1532 , FUNCT_2:def 3;
thus L1575: D214 is  bijective by L1574 , L1549;
L1576: (for B502 , B503 being (Element of ( R31 ./. R35 )) holds ( D214 . ( B502 * B503 ) ) = ( ( D214 . B502 ) * ( D214 . B503 ) ))
proof
let C393 , C394 being (Element of ( R31 ./. R35 ));
L1577: ( C393 * C394 ) in (the carrier of ( R31 ./. R35 ));
L1578: ( C393 * C394 ) in ( dom D214 ) by L1577 , FUNCT_2:def 1;
L1579: [ ( C393 * C394 ) , ( D214 . ( C393 * C394 ) ) ] in D214 by L1578 , FUNCT_1:1;
consider C395 being set such that L1580: ([ ( C393 * C394 ) , C395 ] in ( ( nat_hom R35 ) ~ ) & [ C395 , ( D214 . ( C393 * C394 ) ) ] in R33) by L1579 , RELAT_1:def 8;
L1581: [ C395 , ( C393 * C394 ) ] in ( nat_hom R35 ) by L1580 , RELAT_1:def 7;
L1582: (C395 in ( dom ( nat_hom R35 ) ) & ( ( nat_hom R35 ) . C395 ) = ( C393 * C394 )) by L1581 , FUNCT_1:1;
L1583: ( R33 . C395 ) = ( D214 . ( C393 * C394 ) ) by L1580 , FUNCT_1:1;
L1584: C393 in (the carrier of ( R31 ./. R35 ));
L1585: C393 in ( dom D214 ) by L1584 , FUNCT_2:def 1;
L1586: [ C393 , ( D214 . C393 ) ] in D214 by L1585 , FUNCT_1:1;
consider C396 being set such that L1587: ([ C393 , C396 ] in ( ( nat_hom R35 ) ~ ) & [ C396 , ( D214 . C393 ) ] in R33) by L1586 , RELAT_1:def 8;
L1588: [ C396 , C393 ] in ( nat_hom R35 ) by L1587 , RELAT_1:def 7;
L1589: (C396 in ( dom ( nat_hom R35 ) ) & ( ( nat_hom R35 ) . C396 ) = C393) by L1588 , FUNCT_1:1;
L1590: ( R33 . C396 ) = ( D214 . C393 ) by L1587 , FUNCT_1:1;
L1591: C394 in (the carrier of ( R31 ./. R35 ));
L1592: C394 in ( dom D214 ) by L1591 , FUNCT_2:def 1;
L1593: [ C394 , ( D214 . C394 ) ] in D214 by L1592 , FUNCT_1:1;
consider C397 being set such that L1594: ([ C394 , C397 ] in ( ( nat_hom R35 ) ~ ) & [ C397 , ( D214 . C394 ) ] in R33) by L1593 , RELAT_1:def 8;
L1595: [ C397 , C394 ] in ( nat_hom R35 ) by L1594 , RELAT_1:def 7;
L1596: (C397 in ( dom ( nat_hom R35 ) ) & ( ( nat_hom R35 ) . C397 ) = C394) by L1595 , FUNCT_1:1;
L1597: ( R33 . C397 ) = ( D214 . C394 ) by L1594 , FUNCT_1:1;
reconsider D221 = C396 , D222 = C397 , D223 = C395 as (Element of R31) by L1589 , L1596 , L1582;
L1598: ( ( nat_hom R35 ) . D223 ) = ( ( nat_hom R35 ) . ( D221 * D222 ) ) by L1589 , L1596 , L1582 , GROUP_6:def 6;
L1599: (( ( nat_hom R35 ) . ( D221 * D222 ) ) = ( Class (R35 , ( D221 * D222 )) ) & ( ( nat_hom R35 ) . D223 ) = ( Class (R35 , D223) )) by L123;
L1600: ( D221 * D222 ) in ( Class (R35 , D223) ) by L1599 , L1598 , EQREL_1:23;
L1601: [ D223 , ( D221 * D222 ) ] in R35 by L1600 , EQREL_1:18;
L1602: ( R33 . D223 ) = ( R33 . ( D221 * D222 ) ) by L1601 , L1509 , L216
.= ( ( R33 . D221 ) * ( R33 . D222 ) ) by L1507 , GROUP_6:def 6;
L1603: [ ( D214 . C393 ) , ( D214 . C394 ) ] in [: (the carrier of R34) , (the carrier of R34) :] by ZFMISC_1:def 2;
thus L1604: ( D214 . ( C393 * C394 ) ) = ( (the multF of R32) . [ ( D214 . C393 ) , ( D214 . C394 ) ] ) by L1590 , L1597 , L1602 , L1583 , BINOP_1:def 1
.= ( ( (the multF of R32) | [: (the carrier of R34) , (the carrier of R34) :] ) . [ ( D214 . C393 ) , ( D214 . C394 ) ] ) by L1603 , FUNCT_1:49
.= ( ( (the multF of R32) | [: (the carrier of R34) , (the carrier of R34) :] ) . (( D214 . C393 ) , ( D214 . C394 )) ) by BINOP_1:def 1
.= ( ( (the multF of R32) || (the carrier of R34) ) . (( D214 . C393 ) , ( D214 . C394 )) ) by REALSET1:def 2
.= ( ( D214 . C393 ) * ( D214 . C394 ) ) by L273;
end;
thus L1605: D214 is  multiplicative by L1576 , GROUP_6:def 6;
end;
theorem
L1606: (for R31 being non  empty multMagma holds (for R32 being non  empty multMagma holds (for R35 being  compatible (Equivalence_Relation of R31) holds (for B504 , B505 being (Function of ( R31 ./. R35 ) , R32) holds (( B504 * ( nat_hom R35 ) ) = ( B505 * ( nat_hom R35 ) ) implies B504 = B505)))))
proof
let R31 being non  empty multMagma;
let R32 being non  empty multMagma;
let R35 being  compatible (Equivalence_Relation of R31);
let C398 , C399 being (Function of ( R31 ./. R35 ) , R32);
assume L1607: ( C398 * ( nat_hom R35 ) ) = ( C399 * ( nat_hom R35 ) );
set D224 = ( rng ( nat_hom R35 ) );
L1608: ( rng ( nat_hom R35 ) ) = (the carrier of ( R31 ./. R35 )) by FUNCT_2:def 3;
L1609: (( dom C398 ) = D224 & ( dom C399 ) = D224) by L1608 , FUNCT_2:def 1;
thus L1610: C398 = C399 by L1609 , L1607 , FUNCT_1:86;
end;
theorem
L1611: (for B506 being non  empty multMagma holds (ex B507 being non  empty set st (ex B508 being (Relators of ( free_magma B507 )) st (ex B509 being (Function of ( ( free_magma B507 ) ./. ( equ_rel B508 ) ) , B506) st (B509 is  bijective & B509 is  multiplicative)))))
proof
let C400 being non  empty multMagma;
set D225 = (the carrier of C400);
consider C401 being (Function of ( free_magma D225 ) , C400) such that L1612: (C401 is  multiplicative & C401 extends ( ( id D225 ) * ( ( canon_image (D225 , 1) ) " ) )) by L1231;
consider C402 being (Relators of ( free_magma D225 )) such that L1613: ( equ_kernel C401 ) = ( equ_rel C402 ) by L1612 , L240;
reconsider D226 = ( equ_kernel C401 ) as  compatible (Equivalence_Relation of ( free_magma D225 )) by L1612 , L228;
L1614: (the multF of C400) = ( (the multF of C400) | [: (the carrier of C400) , (the carrier of C400) :] );
L1615: (the multF of C400) = ( (the multF of C400) || (the carrier of C400) ) by L1614 , REALSET1:def 2;
reconsider D227 = C400 as non  empty (multSubmagma of C400) by L1615 , L273;
L1616: (for R16 being set holds (R16 in (the carrier of C400) implies (ex R15 being set st (R15 in ( dom C401 ) & R16 = ( C401 . R15 )))))
proof
let R16 being set;
assume L1617: R16 in (the carrier of C400);
set D228 = [ R16 , 1 ];
take D228;
L1618: [: ( free_magma (D225 , 1) ) , { 1 } :] c= (the carrier of ( free_magma D225 )) by L833;
L1619: [: D225 , { 1 } :] c= (the carrier of ( free_magma D225 )) by L1618 , L577;
L1620: 1 in { 1 } by TARSKI:def 1;
L1621: D228 in [: D225 , { 1 } :] by L1620 , L1617 , ZFMISC_1:def 2;
L1622: D228 in (the carrier of ( free_magma D225 )) by L1621 , L1619;
thus L1623: D228 in ( dom C401 ) by L1622 , FUNCT_2:def 1;
L1624: (( dom ( ( id D225 ) * ( ( canon_image (D225 , 1) ) " ) ) ) c= ( dom C401 ) & C401 tolerates ( ( id D225 ) * ( ( canon_image (D225 , 1) ) " ) )) by L1612 , L55;
L1625: ( ( canon_image (D225 , 1) ) . R16 ) = D228 by L1617 , L1144;
L1626: R16 in ( dom ( canon_image (D225 , 1) ) ) by L1617 , L1144;
L1627: D228 in ( rng ( canon_image (D225 , 1) ) ) by L1626 , L1625 , FUNCT_1:3;
L1628: D228 in ( dom ( ( canon_image (D225 , 1) ) " ) ) by L1627 , FUNCT_1:33;
L1629: ( dom ( canon_image (D225 , 1) ) ) c= ( dom ( id D225 ) ) by L1144;
L1630: ( rng ( ( canon_image (D225 , 1) ) " ) ) c= ( dom ( id D225 ) ) by L1629 , FUNCT_1:33;
L1631: D228 in ( dom ( ( id D225 ) * ( ( canon_image (D225 , 1) ) " ) ) ) by L1630 , L1628 , RELAT_1:27;
L1632: R16 in ( dom ( canon_image (D225 , 1) ) ) by L1617 , L1144;
thus L1633: R16 = ( ( id D225 ) . R16 ) by L1617 , FUNCT_1:18
.= ( ( id D225 ) . ( ( ( canon_image (D225 , 1) ) " ) . D228 ) ) by L1632 , L1625 , FUNCT_1:34
.= ( ( ( id D225 ) * ( ( canon_image (D225 , 1) ) " ) ) . D228 ) by L1631 , FUNCT_1:12
.= ( C401 . D228 ) by L1631 , L1624 , PARTFUN1:53;
end;
L1634: (the carrier of C400) c= ( rng C401 ) by L1616 , FUNCT_1:9;
L1635: (the carrier of D227) = ( rng C401 ) by L1634 , XBOOLE_0:def 10;
consider C403 being (Function of ( ( free_magma D225 ) ./. D226 ) , D227) such that L1636: (C401 = ( C403 * ( nat_hom D226 ) ) & C403 is  bijective & C403 is  multiplicative) by L1635 , L1612 , L1506;
reconsider D229 = C403 as (Function of ( ( free_magma D225 ) ./. ( equ_rel C402 ) ) , C400) by L1613;
take D225;
take C402;
take D229;
thus L1637: thesis by L1636 , L1613;
end;
definition
let C404 , C405 being non  empty set;
let C406 being (Function of C404 , C405);
func free_magmaF C406 -> (Function of ( free_magma C404 ) , ( free_magma C405 )) means 
:L1638: (it is  multiplicative & it extends ( ( ( canon_image (C405 , 1) ) * C406 ) * ( ( canon_image (C404 , 1) ) " ) ));
existence
proof
reconsider D230 = ( ( canon_image (C405 , 1) ) * C406 ) as (Function of C404 , ( free_magma C405 )) by L1208;
L1639: (ex B510 being (Function of ( free_magma C404 ) , ( free_magma C405 )) st (B510 is  multiplicative & B510 extends ( D230 * ( ( canon_image (C404 , 1) ) " ) ))) by L1231;
thus L1640: thesis by L1639;
end;
uniqueness
proof
let C407 , C408 being (Function of ( free_magma C404 ) , ( free_magma C405 ));
assume L1641: (C407 is  multiplicative & C407 extends ( ( ( canon_image (C405 , 1) ) * C406 ) * ( ( canon_image (C404 , 1) ) " ) ));
assume L1642: (C408 is  multiplicative & C408 extends ( ( ( canon_image (C405 , 1) ) * C406 ) * ( ( canon_image (C404 , 1) ) " ) ));
reconsider D231 = ( ( canon_image (C405 , 1) ) * C406 ) as (Function of C404 , ( free_magma C405 )) by L1208;
L1643: (C407 extends ( D231 * ( ( canon_image (C404 , 1) ) " ) ) & C408 extends ( D231 * ( ( canon_image (C404 , 1) ) " ) )) by L1641 , L1642;
thus L1644: C407 = C408 by L1643 , L1641 , L1642 , L1492;
end;
end;
registration
let C409 , C410 being non  empty set;
let C411 being (Function of C409 , C410);
cluster ( free_magmaF C411 ) ->  multiplicative;
coherence by L1638;
end;
theorem
L1647: (for R27 being non  empty set holds (for R28 being non  empty set holds (for R29 being non  empty set holds (for R36 being (Function of R27 , R28) holds (for R37 being (Function of R28 , R29) holds ( free_magmaF ( R37 * R36 ) ) = ( ( free_magmaF R37 ) * ( free_magmaF R36 ) ))))))
proof
let R27 being non  empty set;
let R28 being non  empty set;
let R29 being non  empty set;
let R36 being (Function of R27 , R28);
let R37 being (Function of R28 , R29);
set D232 = ( ( free_magmaF R37 ) * ( free_magmaF R36 ) );
reconsider D233 = ( ( canon_image (R29 , 1) ) * ( R37 * R36 ) ) as (Function of R27 , ( free_magma R29 )) by L1208;
L1648: (for B511 , B512 being (Element of ( free_magma R27 )) holds ( D232 . ( B511 * B512 ) ) = ( ( D232 . B511 ) * ( D232 . B512 ) ))
proof
let C412 , C413 being (Element of ( free_magma R27 ));
L1649: ( C412 * C413 ) in (the carrier of ( free_magma R27 ));
L1650: ( C412 * C413 ) in ( dom D232 ) by L1649 , FUNCT_2:def 1;
L1651: (C412 in (the carrier of ( free_magma R27 )) & C413 in (the carrier of ( free_magma R27 )));
L1652: (C412 in ( dom ( free_magmaF R36 ) ) & C413 in ( dom ( free_magmaF R36 ) )) by L1651 , FUNCT_2:def 1;
thus L1653: ( D232 . ( C412 * C413 ) ) = ( ( free_magmaF R37 ) . ( ( free_magmaF R36 ) . ( C412 * C413 ) ) ) by L1650 , FUNCT_1:12
.= ( ( free_magmaF R37 ) . ( ( ( free_magmaF R36 ) . C412 ) * ( ( free_magmaF R36 ) . C413 ) ) ) by GROUP_6:def 6
.= ( ( ( free_magmaF R37 ) . ( ( free_magmaF R36 ) . C412 ) ) * ( ( free_magmaF R37 ) . ( ( free_magmaF R36 ) . C413 ) ) ) by GROUP_6:def 6
.= ( ( D232 . C412 ) * ( ( free_magmaF R37 ) . ( ( free_magmaF R36 ) . C413 ) ) ) by L1652 , FUNCT_1:13
.= ( ( D232 . C412 ) * ( D232 . C413 ) ) by L1652 , FUNCT_1:13;
end;
L1654: D232 is  multiplicative by L1648 , GROUP_6:def 6;
L1655: ( dom ( D233 * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom ( ( canon_image (R27 , 1) ) " ) ) by RELAT_1:25;
L1656: ( rng ( canon_image (R27 , 1) ) ) c= (the carrier of ( free_magma R27 ));
L1657: ( dom ( ( canon_image (R27 , 1) ) " ) ) c= (the carrier of ( free_magma R27 )) by L1656 , FUNCT_1:33;
L1658: ( dom ( D233 * ( ( canon_image (R27 , 1) ) " ) ) ) c= (the carrier of ( free_magma R27 )) by L1657 , L1655 , XBOOLE_1:1;
L1659: ( dom ( D233 * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom D232 ) by L1658 , FUNCT_2:def 1;
L1660: (for R15 being set holds (R15 in ( dom ( D233 * ( ( canon_image (R27 , 1) ) " ) ) ) implies ( D232 . R15 ) = ( ( D233 * ( ( canon_image (R27 , 1) ) " ) ) . R15 )))
proof
let R15 being set;
assume L1661: R15 in ( dom ( D233 * ( ( canon_image (R27 , 1) ) " ) ) );
L1662: ( free_magmaF R36 ) extends ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) by L1638;
L1663: (( dom ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom ( free_magmaF R36 ) ) & ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) tolerates ( free_magmaF R36 )) by L1662 , L55;
L1664: R15 in ( dom ( ( canon_image (R27 , 1) ) " ) ) by L1661 , FUNCT_1:11;
L1665: R27 c= ( dom R36 ) by FUNCT_2:def 1;
L1666: ( dom ( canon_image (R27 , 1) ) ) c= ( dom R36 ) by L1665 , L1144;
L1667: ( rng ( ( canon_image (R27 , 1) ) " ) ) c= ( dom R36 ) by L1666 , FUNCT_1:33;
L1668: R15 in ( dom ( R36 * ( ( canon_image (R27 , 1) ) " ) ) ) by L1667 , L1664 , RELAT_1:27;
L1669: ( rng ( R36 * ( ( canon_image (R27 , 1) ) " ) ) ) c= R28;
L1670: ( rng ( R36 * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom ( canon_image (R28 , 1) ) ) by L1669 , L1144;
L1671: R15 in ( dom ( ( canon_image (R28 , 1) ) * ( R36 * ( ( canon_image (R27 , 1) ) " ) ) ) ) by L1670 , L1668 , RELAT_1:27;
L1672: R15 in ( dom ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) ) by L1671 , RELAT_1:36;
set D234 = ( ( R36 * ( ( canon_image (R27 , 1) ) " ) ) . R15 );
L1673: ( free_magmaF R37 ) extends ( ( ( canon_image (R29 , 1) ) * R37 ) * ( ( canon_image (R28 , 1) ) " ) ) by L1638;
L1674: (( dom ( ( ( canon_image (R29 , 1) ) * R37 ) * ( ( canon_image (R28 , 1) ) " ) ) ) c= ( dom ( free_magmaF R37 ) ) & ( ( ( canon_image (R29 , 1) ) * R37 ) * ( ( canon_image (R28 , 1) ) " ) ) tolerates ( free_magmaF R37 )) by L1673 , L55;
L1675: D234 in ( rng ( R36 * ( ( canon_image (R27 , 1) ) " ) ) ) by L1668 , FUNCT_1:3;
L1676: D234 in R28 by L1675;
L1677: D234 in ( dom ( canon_image (R28 , 1) ) ) by L1676 , L1144;
L1678: ( ( canon_image (R28 , 1) ) . D234 ) in ( rng ( canon_image (R28 , 1) ) ) by L1677 , FUNCT_1:3;
L1679: R28 c= ( dom R37 ) by FUNCT_2:def 1;
L1680: ( dom ( canon_image (R28 , 1) ) ) c= ( dom R37 ) by L1679 , L1144;
L1681: ( rng R37 ) c= R29;
L1682: ( rng R37 ) c= ( dom ( canon_image (R29 , 1) ) ) by L1681 , L1144;
L1683: ( dom ( canon_image (R28 , 1) ) ) c= ( dom ( ( canon_image (R29 , 1) ) * R37 ) ) by L1682 , L1680 , RELAT_1:27;
L1684: ( rng ( ( canon_image (R28 , 1) ) " ) ) c= ( dom ( ( canon_image (R29 , 1) ) * R37 ) ) by L1683 , FUNCT_1:33;
L1685: ( rng ( canon_image (R28 , 1) ) ) c= ( dom ( ( canon_image (R28 , 1) ) " ) ) by FUNCT_1:33;
L1686: ( rng ( canon_image (R28 , 1) ) ) c= ( dom ( ( ( canon_image (R29 , 1) ) * R37 ) * ( ( canon_image (R28 , 1) ) " ) ) ) by L1685 , L1684 , RELAT_1:27;
L1687: ( rng ( canon_image (R28 , 1) ) ) c= ( dom ( ( canon_image (R28 , 1) ) " ) ) by FUNCT_1:33;
L1688: ( dom ( canon_image (R28 , 1) ) ) = R28 by L1144;
L1689: D234 in ( dom ( ( ( canon_image (R28 , 1) ) " ) * ( canon_image (R28 , 1) ) ) ) by L1688 , L1676 , L1687 , RELAT_1:27;
L1690: ( ( ( canon_image (R29 , 1) ) * R37 ) * ( R36 * ( ( canon_image (R27 , 1) ) " ) ) ) = ( ( canon_image (R29 , 1) ) * ( R37 * ( R36 * ( ( canon_image (R27 , 1) ) " ) ) ) ) by RELAT_1:36
.= ( ( canon_image (R29 , 1) ) * ( ( R37 * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) ) by RELAT_1:36
.= ( ( ( canon_image (R29 , 1) ) * ( R37 * R36 ) ) * ( ( canon_image (R27 , 1) ) " ) ) by RELAT_1:36;
thus L1691: ( D232 . R15 ) = ( ( free_magmaF R37 ) . ( ( free_magmaF R36 ) . R15 ) ) by L1661 , L1659 , FUNCT_1:12
.= ( ( free_magmaF R37 ) . ( ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) . R15 ) ) by L1672 , L1663 , PARTFUN1:53
.= ( ( free_magmaF R37 ) . ( ( ( canon_image (R28 , 1) ) * ( R36 * ( ( canon_image (R27 , 1) ) " ) ) ) . R15 ) ) by RELAT_1:36
.= ( ( free_magmaF R37 ) . ( ( canon_image (R28 , 1) ) . ( ( R36 * ( ( canon_image (R27 , 1) ) " ) ) . R15 ) ) ) by L1668 , FUNCT_1:13
.= ( ( ( ( canon_image (R29 , 1) ) * R37 ) * ( ( canon_image (R28 , 1) ) " ) ) . ( ( canon_image (R28 , 1) ) . D234 ) ) by L1686 , L1678 , L1674 , PARTFUN1:53
.= ( ( ( ( ( canon_image (R29 , 1) ) * R37 ) * ( ( canon_image (R28 , 1) ) " ) ) * ( canon_image (R28 , 1) ) ) . D234 ) by L1677 , FUNCT_1:13
.= ( ( ( ( canon_image (R29 , 1) ) * R37 ) * ( ( ( canon_image (R28 , 1) ) " ) * ( canon_image (R28 , 1) ) ) ) . D234 ) by RELAT_1:36
.= ( ( ( canon_image (R29 , 1) ) * R37 ) . ( ( ( ( canon_image (R28 , 1) ) " ) * ( canon_image (R28 , 1) ) ) . D234 ) ) by L1689 , FUNCT_1:13
.= ( ( ( canon_image (R29 , 1) ) * R37 ) . ( ( R36 * ( ( canon_image (R27 , 1) ) " ) ) . R15 ) ) by L1677 , FUNCT_1:34
.= ( ( D233 * ( ( canon_image (R27 , 1) ) " ) ) . R15 ) by L1690 , L1668 , FUNCT_1:13;
end;
L1692: D232 tolerates ( D233 * ( ( canon_image (R27 , 1) ) " ) ) by L1660 , L1659 , PARTFUN1:53;
L1693: D232 extends ( D233 * ( ( canon_image (R27 , 1) ) " ) ) by L1692 , L1659 , L55;
thus L1694: ( free_magmaF ( R37 * R36 ) ) = ( ( free_magmaF R37 ) * ( free_magmaF R36 ) ) by L1693 , L1638 , L1654;
end;
theorem
L1695: (for R27 being non  empty set holds (for R28 being non  empty set holds (for R29 being non  empty set holds (for R36 being (Function of R27 , R28) holds (for B513 being (Function of R27 , R29) holds ((R28 c= R29 & R36 = B513) implies ( free_magmaF R36 ) = ( free_magmaF B513 )))))))
proof
let R27 being non  empty set;
let R28 being non  empty set;
let R29 being non  empty set;
let R36 being (Function of R27 , R28);
let C414 being (Function of R27 , R29);
assume L1696: R28 c= R29;
assume L1697: R36 = C414;
L1698: (the carrier of ( free_magma R28 )) c= (the carrier of ( free_magma R29 )) by L1696 , L924;
reconsider D235 = ( free_magmaF R36 ) as (Function of ( free_magma R27 ) , ( free_magma R29 )) by L1698 , FUNCT_2:7;
L1699: (for B514 , B515 being (Element of ( free_magma R27 )) holds ( D235 . ( B514 * B515 ) ) = ( ( D235 . B514 ) * ( D235 . B515 ) ))
proof
let C415 , C416 being (Element of ( free_magma R27 ));
set D236 = ( ( free_magmaF R36 ) . C415 );
set D237 = ( ( free_magmaF R36 ) . C416 );
L1700: (D236 in (the carrier of ( free_magma R28 )) & D237 in (the carrier of ( free_magma R28 )));
reconsider D238 = D236 , D239 = D237 as (Element of ( free_magma R29 )) by L1700 , L1698;
L1701: ( length D236 ) = ( D236 `2 ) by L993
.= ( length D238 ) by L993;
L1702: ( length D237 ) = ( D237 `2 ) by L993
.= ( length D239 ) by L993;
thus L1703: ( D235 . ( C415 * C416 ) ) = ( ( ( free_magmaF R36 ) . C415 ) * ( ( free_magmaF R36 ) . C416 ) ) by GROUP_6:def 6
.= [ [ [ ( D238 `1 ) , ( D239 `1 ) ] , ( D238 `2 ) ] , ( ( length D238 ) + ( length D239 ) ) ] by L1018 , L1701 , L1702
.= ( ( D235 . C415 ) * ( D235 . C416 ) ) by L1018;
end;
L1704: D235 is  multiplicative by L1699 , GROUP_6:def 6;
L1705: ( rng C414 ) c= R29;
L1706: ( rng C414 ) c= ( dom ( canon_image (R29 , 1) ) ) by L1705 , L1144;
L1707: ( dom ( ( canon_image (R29 , 1) ) * C414 ) ) = ( dom C414 ) by L1706 , RELAT_1:27;
L1708: R27 c= ( dom C414 ) by FUNCT_2:def 1;
L1709: ( dom ( canon_image (R27 , 1) ) ) c= ( dom ( ( canon_image (R29 , 1) ) * C414 ) ) by L1708 , L1144 , L1707;
L1710: ( rng ( ( canon_image (R27 , 1) ) " ) ) c= ( dom ( ( canon_image (R29 , 1) ) * C414 ) ) by L1709 , FUNCT_1:33;
L1711: ( dom ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) ) = ( dom ( ( canon_image (R27 , 1) ) " ) ) by L1710 , RELAT_1:27;
L1712: ( rng ( canon_image (R27 , 1) ) ) c= (the carrier of ( free_magma R27 ));
L1713: ( dom ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) ) c= (the carrier of ( free_magma R27 )) by L1712 , L1711 , FUNCT_1:33;
L1714: ( dom ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom D235 ) by L1713 , FUNCT_2:def 1;
L1715: (for R15 being set holds (R15 in ( dom ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) ) implies ( D235 . R15 ) = ( ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) . R15 )))
proof
let R15 being set;
assume L1716: R15 in ( dom ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) );
L1717: ( free_magmaF R36 ) extends ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) by L1638;
L1718: (( dom ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom ( free_magmaF R36 ) ) & ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) tolerates ( free_magmaF R36 )) by L1717 , L55;
L1719: ( rng R36 ) c= R28;
L1720: ( rng R36 ) c= ( dom ( canon_image (R28 , 1) ) ) by L1719 , L1144;
L1721: ( rng R36 ) c= R29 by L1696 , XBOOLE_1:1;
L1722: ( rng R36 ) c= ( dom ( canon_image (R29 , 1) ) ) by L1721 , L1144;
L1723: ( dom ( ( canon_image (R28 , 1) ) * R36 ) ) = ( dom R36 ) by L1720 , RELAT_1:27
.= ( dom ( ( canon_image (R29 , 1) ) * R36 ) ) by L1722 , RELAT_1:27;
L1724: (for R15 being set holds (R15 in ( dom ( ( canon_image (R28 , 1) ) * R36 ) ) implies ( ( ( canon_image (R28 , 1) ) * R36 ) . R15 ) = ( ( ( canon_image (R29 , 1) ) * R36 ) . R15 )))
proof
let R15 being set;
assume L1725: R15 in ( dom ( ( canon_image (R28 , 1) ) * R36 ) );
L1726: ( R36 . R15 ) in ( dom ( canon_image (R28 , 1) ) ) by L1725 , FUNCT_1:11;
L1727: ( R36 . R15 ) in R28 by L1726 , L1144;
thus L1728: ( ( ( canon_image (R28 , 1) ) * R36 ) . R15 ) = ( ( canon_image (R28 , 1) ) . ( R36 . R15 ) ) by L1725 , FUNCT_1:12
.= [ ( R36 . R15 ) , 1 ] by L1726 , L1097
.= ( ( canon_image (R29 , 1) ) . ( R36 . R15 ) ) by L1696 , L1727 , L1144
.= ( ( ( canon_image (R29 , 1) ) * R36 ) . R15 ) by L1723 , L1725 , FUNCT_1:12;
end;
L1729: ( ( canon_image (R28 , 1) ) * R36 ) = ( ( canon_image (R29 , 1) ) * C414 ) by L1724 , L1697 , L1723 , FUNCT_1:2;
thus L1730: ( D235 . R15 ) = ( ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) . R15 ) by L1729 , L1716 , L1718 , PARTFUN1:53;
end;
L1731: D235 tolerates ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) by L1715 , L1714 , PARTFUN1:53;
L1732: D235 extends ( ( ( canon_image (R29 , 1) ) * C414 ) * ( ( canon_image (R27 , 1) ) " ) ) by L1731 , L1714 , L55;
thus L1733: ( free_magmaF R36 ) = ( free_magmaF C414 ) by L1732 , L1704 , L1638;
end;
theorem
L1734: (for R27 being non  empty set holds (for R28 being non  empty set holds (for R36 being (Function of R27 , R28) holds ( free_magmaF ( id R27 ) ) = ( id ( dom ( free_magmaF R36 ) ) ))))
proof
let R27 being non  empty set;
let R28 being non  empty set;
let R36 being (Function of R27 , R28);
L1735: ( dom ( free_magmaF ( id R27 ) ) ) = (the carrier of ( free_magma R27 )) by FUNCT_2:def 1;
L1736: ( dom ( free_magmaF ( id R27 ) ) ) = ( dom ( free_magmaF R36 ) ) by L1735 , FUNCT_2:def 1;
L1737: (for R15 being set holds (R15 in ( dom ( free_magmaF R36 ) ) implies ( ( free_magmaF ( id R27 ) ) . R15 ) = R15))
proof
let R15 being set;
assume L1738: R15 in ( dom ( free_magmaF R36 ) );
defpred S20[ Nat ] means (for B516 being (Element of ( free_magma R27 )) holds (( length B516 ) = $1 implies ( ( free_magmaF ( id R27 ) ) . B516 ) = B516));
L1739: (for B517 being Nat holds ((for B518 being Nat holds (B518 < B517 implies S20[ B518 ])) implies S20[ B517 ]))
proof
let C417 being Nat;
assume L1740: (for B519 being Nat holds (B519 < C417 implies S20[ B519 ]));
thus L1741: (for B520 being (Element of ( free_magma R27 )) holds (( length B520 ) = C417 implies ( ( free_magmaF ( id R27 ) ) . B520 ) = B520))
proof
let C418 being (Element of ( free_magma R27 ));
assume L1742: ( length C418 ) = C417;
L1743: (C418 = [ ( C418 `1 ) , ( C418 `2 ) ] & ( length C418 ) >= 1) by L1022;
L1744: (( length C418 ) = 1 or ( length C418 ) > 1) by L1743 , XXREAL_0:1;
L1745: (( length C418 ) = 1 or ( ( length C418 ) + 1 ) > ( 1 + 1 )) by L1744 , XREAL_1:8;
per cases  by L1745 , NAT_1:13;
suppose L1746: ( length C418 ) = 1;

set D240 = ( C418 `1 );
L1747: D240 in { ( B521 `1 ) where B521 is (Element of ( free_magma R27 )) : ( length B521 ) = 1 } by L1746;
L1748: D240 in R27 by L1747 , L995;
L1749: D240 in ( dom ( id R27 ) ) by L1748;
L1750: ( free_magmaF ( id R27 ) ) extends ( ( ( canon_image (R27 , 1) ) * ( id R27 ) ) * ( ( canon_image (R27 , 1) ) " ) ) by L1638;
L1751: (( dom ( ( ( canon_image (R27 , 1) ) * ( id R27 ) ) * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom ( free_magmaF ( id R27 ) ) ) & ( ( ( canon_image (R27 , 1) ) * ( id R27 ) ) * ( ( canon_image (R27 , 1) ) " ) ) tolerates ( free_magmaF ( id R27 ) )) by L1750 , L55;
L1752: ( ( canon_image (R27 , 1) ) . D240 ) = [ D240 , 1 ] by L1748 , L1144
.= C418 by L993 , L1743 , L1746;
L1753: D240 in ( dom ( canon_image (R27 , 1) ) ) by L1748 , L1144;
L1754: C418 in ( rng ( canon_image (R27 , 1) ) ) by L1753 , L1752 , FUNCT_1:3;
L1755: C418 in ( dom ( ( canon_image (R27 , 1) ) " ) ) by L1754 , FUNCT_1:33;
L1756: ( rng ( id R27 ) ) = R27
.= ( dom ( canon_image (R27 , 1) ) ) by L1144;
L1757: ( dom ( ( canon_image (R27 , 1) ) * ( id R27 ) ) ) = ( dom ( id R27 ) ) by L1756 , RELAT_1:27;
L1758: R27 = ( dom ( ( canon_image (R27 , 1) ) * ( id R27 ) ) ) by L1757;
L1759: ( dom ( canon_image (R27 , 1) ) ) c= ( dom ( ( canon_image (R27 , 1) ) * ( id R27 ) ) ) by L1758 , L1144;
L1760: ( rng ( ( canon_image (R27 , 1) ) " ) ) c= ( dom ( ( canon_image (R27 , 1) ) * ( id R27 ) ) ) by L1759 , FUNCT_1:33;
L1761: C418 in ( dom ( ( ( canon_image (R27 , 1) ) * ( id R27 ) ) * ( ( canon_image (R27 , 1) ) " ) ) ) by L1760 , L1755 , RELAT_1:27;
L1762: ( ( ( canon_image (R27 , 1) ) " ) . C418 ) = D240 by L1753 , L1752 , FUNCT_1:34;
L1763: ( ( ( ( canon_image (R27 , 1) ) * ( id R27 ) ) * ( ( canon_image (R27 , 1) ) " ) ) . C418 ) = ( ( ( canon_image (R27 , 1) ) * ( id R27 ) ) . D240 ) by L1762 , L1761 , FUNCT_1:12
.= ( ( canon_image (R27 , 1) ) . ( ( id R27 ) . D240 ) ) by L1749 , FUNCT_1:13
.= C418 by L1752 , L1748 , FUNCT_1:18;
thus L1764: ( ( free_magmaF ( id R27 ) ) . C418 ) = C418 by L1763 , L1761 , L1751 , PARTFUN1:53;
end;
suppose L1765: ( length C418 ) >= 2;

consider C419 , C420 being (Element of ( free_magma R27 )) such that L1766: (C418 = ( C419 * C420 ) & ( length C419 ) < ( length C418 ) & ( length C420 ) < ( length C418 )) by L1765 , L1038;
thus L1767: ( ( free_magmaF ( id R27 ) ) . C418 ) = ( ( ( free_magmaF ( id R27 ) ) . C419 ) * ( ( free_magmaF ( id R27 ) ) . C420 ) ) by L1766 , GROUP_6:def 6
.= ( C419 * ( ( free_magmaF ( id R27 ) ) . C420 ) ) by L1740 , L1742 , L1766
.= C418 by L1740 , L1742 , L1766;
end;
end;

end;
L1742: (for B522 being Nat holds S20[ B522 ]) from NAT_1:sch 4(L1739);
L1743: (for B523 being (Element of ( free_magma R27 )) holds ( ( free_magmaF ( id R27 ) ) . B523 ) = B523)
proof
let C421 being (Element of ( free_magma R27 ));
reconsider D241 = ( length C421 ) as Nat;
L1744: S20[ D241 ] by L1742;
thus L1745: ( ( free_magmaF ( id R27 ) ) . C421 ) = C421 by L1744;
end;
thus L1746: ( ( free_magmaF ( id R27 ) ) . R15 ) = R15 by L1743 , L1738;
end;
thus L1747: ( free_magmaF ( id R27 ) ) = ( id ( dom ( free_magmaF R36 ) ) ) by L1737 , L1736 , FUNCT_1:17;
end;
theorem
L1748: (for R27 being non  empty set holds (for R28 being non  empty set holds (for R36 being (Function of R27 , R28) holds (R36 is  one-to-one implies ( free_magmaF R36 ) is  one-to-one))))
proof
let R27 being non  empty set;
let R28 being non  empty set;
let R36 being (Function of R27 , R28);
assume L1749: R36 is  one-to-one;
L1750: ( ( R36 " ) * R36 ) = ( id ( dom R36 ) ) by L1749 , FUNCT_1:39;
set D242 = ( rng R36 );
L1751: ( dom R36 ) = R27 by FUNCT_2:def 1;
reconsider D243 = R36 as (Function of R27 , D242) by L1751 , FUNCT_2:1;
reconsider D244 = ( D243 " ) as (Function of D242 , R27) by L1749 , FUNCT_2:25;
L1752: ( D244 * D243 ) = ( id R27 ) by L1750 , FUNCT_2:def 1;
L1753: ( ( free_magmaF D244 ) * ( free_magmaF D243 ) ) = ( free_magmaF ( id R27 ) ) by L1752 , L1647;
L1754: ( ( free_magmaF D244 ) * ( free_magmaF R36 ) ) = ( free_magmaF ( id R27 ) ) by L1753 , L1695;
L1755: ( ( free_magmaF D244 ) * ( free_magmaF R36 ) ) = ( id ( dom ( free_magmaF R36 ) ) ) by L1754 , L1734;
thus L1756: ( free_magmaF R36 ) is  one-to-one by L1755 , FUNCT_1:31;
end;
theorem
L1757: (for R27 being non  empty set holds (for R28 being non  empty set holds (for R36 being (Function of R27 , R28) holds (R36 is  onto implies ( free_magmaF R36 ) is  onto))))
proof
let R27 being non  empty set;
let R28 being non  empty set;
let R36 being (Function of R27 , R28);
assume L1758: R36 is  onto;
L1759: (for R16 being set holds (R16 in (the carrier of ( free_magma R28 )) implies R16 in ( rng ( free_magmaF R36 ) )))
proof
let R16 being set;
assume L1760: R16 in (the carrier of ( free_magma R28 ));
defpred S21[ Nat ] means (for B524 being (Element of ( free_magma R28 )) holds (( length B524 ) = $1 implies (ex B525 being (Element of ( free_magma R27 )) st B524 = ( ( free_magmaF R36 ) . B525 ))));
L1761: (for B526 being Nat holds ((for B527 being Nat holds (B527 < B526 implies S21[ B527 ])) implies S21[ B526 ]))
proof
let C422 being Nat;
assume L1762: (for B528 being Nat holds (B528 < C422 implies S21[ B528 ]));
thus L1763: (for B529 being (Element of ( free_magma R28 )) holds (( length B529 ) = C422 implies (ex B530 being (Element of ( free_magma R27 )) st B529 = ( ( free_magmaF R36 ) . B530 ))))
proof
let C423 being (Element of ( free_magma R28 ));
assume L1764: ( length C423 ) = C422;
L1765: (C423 = [ ( C423 `1 ) , ( C423 `2 ) ] & ( length C423 ) >= 1) by L1022;
L1766: (( length C423 ) = 1 or ( length C423 ) > 1) by L1765 , XXREAL_0:1;
L1767: (( length C423 ) = 1 or ( ( length C423 ) + 1 ) > ( 1 + 1 )) by L1766 , XREAL_1:8;
per cases  by L1767 , NAT_1:13;
suppose L1768: ( length C423 ) = 1;

set D245 = ( C423 `1 );
L1769: D245 in { ( B531 `1 ) where B531 is (Element of ( free_magma R28 )) : ( length B531 ) = 1 } by L1768;
L1770: D245 in R28 by L1769 , L995;
L1771: ( free_magmaF R36 ) extends ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) by L1638;
L1772: (( dom ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) ) c= ( dom ( free_magmaF R36 ) ) & ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) tolerates ( free_magmaF R36 )) by L1771 , L55;
L1773: ( ( canon_image (R28 , 1) ) . D245 ) = [ D245 , 1 ] by L1770 , L1144
.= C423 by L993 , L1765 , L1768;
L1774: ( rng R36 ) = R28 by L1758 , FUNCT_2:def 3;
consider R15 being set such that L1775: (R15 in ( dom R36 ) & D245 = ( R36 . R15 )) by L1774 , L1770 , FUNCT_1:def 3;
L1776: 1 in { 1 } by TARSKI:def 1;
L1777: R15 in R27 by L1775;
L1778: R15 in ( free_magma (R27 , 1) ) by L1777 , L577;
L1779: [ R15 , 1 ] in [: ( free_magma (R27 , 1) ) , { 1 } :] by L1778 , L1776 , ZFMISC_1:def 2;
L1780: [: ( free_magma (R27 , 1) ) , { 1 } :] c= ( free_magma_carrier R27 ) by L833;
reconsider D246 = [ R15 , 1 ] as (Element of ( free_magma R27 )) by L1780 , L1779;
take D246;
L1781: R15 in ( dom ( canon_image (R27 , 1) ) ) by L1144 , L1777;
L1782: D246 = ( ( canon_image (R27 , 1) ) . R15 ) by L1144 , L1775;
L1783: D246 in ( rng ( canon_image (R27 , 1) ) ) by L1782 , L1781 , FUNCT_1:3;
L1784: D246 in ( dom ( ( canon_image (R27 , 1) ) " ) ) by L1783 , FUNCT_1:33;
L1785: ( rng R36 ) = ( dom ( canon_image (R28 , 1) ) ) by L1144 , L1774;
L1786: ( dom R36 ) = ( dom ( ( canon_image (R28 , 1) ) * R36 ) ) by L1785 , RELAT_1:27;
L1787: R27 c= ( dom ( ( canon_image (R28 , 1) ) * R36 ) ) by L1786 , FUNCT_2:def 1;
L1788: ( dom ( canon_image (R27 , 1) ) ) c= ( dom ( ( canon_image (R28 , 1) ) * R36 ) ) by L1787 , L1144;
L1789: ( rng ( ( canon_image (R27 , 1) ) " ) ) c= ( dom ( ( canon_image (R28 , 1) ) * R36 ) ) by L1788 , FUNCT_1:33;
L1790: D246 in ( dom ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) ) by L1789 , L1784 , RELAT_1:27;
L1791: ( ( free_magmaF R36 ) . D246 ) = ( ( ( ( canon_image (R28 , 1) ) * R36 ) * ( ( canon_image (R27 , 1) ) " ) ) . D246 ) by L1790 , L1772 , PARTFUN1:53
.= ( ( ( canon_image (R28 , 1) ) * R36 ) . ( ( ( canon_image (R27 , 1) ) " ) . D246 ) ) by L1790 , FUNCT_1:12;
L1792: R15 in ( dom ( canon_image (R27 , 1) ) ) by L1777 , L1144;
L1793: ( ( ( canon_image (R27 , 1) ) " ) . D246 ) = R15 by L1792 , L1782 , FUNCT_1:34;
thus L1794: thesis by L1793 , L1773 , L1775 , L1791 , FUNCT_1:13;
end;
suppose L1795: ( length C423 ) >= 2;

consider C424 , C425 being (Element of ( free_magma R28 )) such that L1796: (C423 = ( C424 * C425 ) & ( length C424 ) < ( length C423 ) & ( length C425 ) < ( length C423 )) by L1795 , L1038;
consider C426 being (Element of ( free_magma R27 )) such that L1797: C424 = ( ( free_magmaF R36 ) . C426 ) by L1796 , L1762 , L1764;
consider C427 being (Element of ( free_magma R27 )) such that L1798: C425 = ( ( free_magmaF R36 ) . C427 ) by L1796 , L1762 , L1764;
take ( C426 * C427 );
thus L1799: thesis by L1797 , L1798 , L1796 , GROUP_6:def 6;
end;
end;

end;
L1764: (for B532 being Nat holds S21[ B532 ]) from NAT_1:sch 4(L1761);
L1765: (for B533 being (Element of ( free_magma R28 )) holds (ex B534 being (Element of ( free_magma R27 )) st B533 = ( ( free_magmaF R36 ) . B534 )))
proof
let C428 being (Element of ( free_magma R28 ));
reconsider D247 = ( length C428 ) as Nat;
L1766: S21[ D247 ] by L1764;
thus L1767: thesis by L1766;
end;
L1768: (ex R15 being set st (R15 in ( dom ( free_magmaF R36 ) ) & R16 = ( ( free_magmaF R36 ) . R15 )))
proof
consider C429 being (Element of ( free_magma R27 )) such that L1769: R16 = ( ( free_magmaF R36 ) . C429 ) by L1760 , L1765;
take C429;
L1770: C429 in (the carrier of ( free_magma R27 ));
thus L1771: C429 in ( dom ( free_magmaF R36 ) ) by L1770 , FUNCT_2:def 1;
thus L1772: R16 = ( ( free_magmaF R36 ) . C429 ) by L1769;
end;
thus L1773: R16 in ( rng ( free_magmaF R36 ) ) by L1768 , FUNCT_1:def 3;
end;
L1774: (the carrier of ( free_magma R28 )) c= ( rng ( free_magmaF R36 ) ) by L1759 , TARSKI:def 3;
L1775: ( rng ( free_magmaF R36 ) ) = (the carrier of ( free_magma R28 )) by L1774 , XBOOLE_0:def 10;
thus L1776: ( free_magmaF R36 ) is  onto by L1775 , FUNCT_2:def 3;
end;
