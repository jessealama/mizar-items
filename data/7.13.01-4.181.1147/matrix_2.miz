:: Transpose Matrices and Groups of Permutations
::  by Katarzyna Jankowska
::
:: Received May 20, 1992
:: Copyright (c) 1992-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, NAT_1, XBOOLE_0, VECTSP_1, FINSEQ_1, SUBSET_1, FUNCOP_1,
      MATRIX_1, FINSEQ_2, RELAT_1, XXREAL_0, CARD_1, TREES_1, FUNCT_1, ARYTM_3,
      ZFMISC_1, SUPINF_2, INCSP_1, FINSEQ_3, STRUCT_0, QC_LANG1, TARSKI,
      FUNCT_2, ALGSTR_0, BINOP_1, GROUP_1, ABIAN, INT_1, CARD_3, ARYTM_1,
      FINSET_1, FINSUB_1, MATRIX_2;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, RELAT_1, FUNCT_1, PARTFUN1,
      FINSEQ_1, FUNCT_2, STRUCT_0, ALGSTR_0, ORDINAL1, NAT_1, NAT_D, GROUP_1,
      GROUP_4, BINOP_1, VECTSP_1, MATRIX_1, FINSET_1, FINSUB_1, FINSEQ_2,
      FINSEQ_3, FINSEQ_4, NUMBERS, XXREAL_0;
 constructors RELAT_2, PARTFUN1, BINOP_1, FINSUB_1, XXREAL_0, NAT_1, NAT_D,
      FINSEQOP, FINSEQ_4, GROUP_4, MATRIX_1, VECTSP_1, RELSET_1, PRE_POLY;
 registrations XBOOLE_0, FUNCT_1, RELSET_1, PARTFUN1, FUNCT_2, XXREAL_0, NAT_1,
      FINSEQ_1, FINSEQ_2, STRUCT_0, GROUP_1, MATRIX_1, ORDINAL1, CARD_1;
 requirements NUMERALS, REAL, BOOLE, SUBSET, ARITHM;
 definitions STRUCT_0, FINSEQ_2, MATRIX_1, TARSKI, ALGSTR_0;
 theorems FINSEQ_1, FINSEQ_2, FINSEQ_3, TARSKI, GROUP_1, FUNCT_1, FUNCT_2,
      ZFMISC_1, NAT_1, BINOP_1, FINSUB_1, FINSET_1, GROUP_4, FRAENKEL,
      MATRIX_1, RELAT_1, XBOOLE_0, FUNCOP_1, ORDINAL1, NAT_D, CARD_1;
 schemes BINOP_1, MATRIX_1, XBOOLE_0;

begin
definition
let R11 being Nat;
let R12 being Nat;
let C1 being set;
func (R11 , R12) --> C1 ->  tabular FinSequence equals 
( R11 |-> ( R12 |-> C1 ) );
coherence by MATRIX_1:2;
end;
definition
let R13 being non  empty set;
let R11 being Nat;
let R12 being Nat;
let R20 being (Element of R13);
redefine func (R11 , R12) --> R20 -> (Matrix of R11 , R12 , R13);

coherence by MATRIX_1:10;
end;
theorem
L3: (for R7 being Nat holds (for R8 being Nat holds (for R11 being Nat holds (for R12 being Nat holds (for R13 being non  empty set holds (for R17 being (Element of R13) holds ([ R7 , R8 ] in ( Indices ( (R11 , R12) --> R17 ) ) implies ( ( (R11 , R12) --> R17 ) * (R7 , R8) ) = R17)))))))
proof
let R7 being Nat;
let R8 being Nat;
let R11 being Nat;
let R12 being Nat;
let R13 being non  empty set;
let R17 being (Element of R13);
reconsider D1 = R12 as (Element of ( NAT )) by ORDINAL1:def 12;
set D2 = ( (R11 , R12) --> R17 );
assume L4: [ R7 , R8 ] in ( Indices D2 );
L5: R7 in ( dom D2 ) by L4 , ZFMISC_1:87;
L6: R7 in ( Seg ( len D2 ) ) by L5 , FINSEQ_1:def 3;
L7: R7 in ( Seg R11 ) by L6 , MATRIX_1:def 2;
L8: R11 > ( 0 ) by L7;
L9: R8 in ( Seg ( width D2 ) ) by L4 , ZFMISC_1:87;
L10: R8 in ( Seg R12 ) by L9 , L8 , MATRIX_1:23;
L11: ( ( D1 |-> R17 ) . R8 ) = R17 by L10 , FUNCOP_1:7;
L12: ( D2 . R7 ) = ( D1 |-> R17 ) by L7 , FUNCOP_1:7;
thus L13: thesis by L12 , L4 , L11 , MATRIX_1:def 5;
end;
theorem
L14: (for R11 being Nat holds (for R14 being Field holds (for R23 being (Element of R14) holds (for R24 being (Element of R14) holds ( ( (R11 , R11) --> R23 ) + ( (R11 , R11) --> R24 ) ) = ( (R11 , R11) --> ( R23 + R24 ) )))))
proof
let R11 being Nat;
let R14 being Field;
let R23 being (Element of R14);
let R24 being (Element of R14);
L15: ( Indices ( (R11 , R11) --> R23 ) ) = ( Indices ( (R11 , R11) --> ( R23 + R24 ) ) ) by MATRIX_1:26;
L16: ( Indices ( (R11 , R11) --> R23 ) ) = ( Indices ( (R11 , R11) --> R24 ) ) by MATRIX_1:26;
L17:
now
let R7 being Nat;
let R8 being Nat;
assume L18: [ R7 , R8 ] in ( Indices ( (R11 , R11) --> ( R23 + R24 ) ) );
L19: ( ( (R11 , R11) --> R23 ) * (R7 , R8) ) = R23 by L18 , L15 , L3;
L20: ( ( ( (R11 , R11) --> R23 ) * (R7 , R8) ) + ( ( (R11 , R11) --> R24 ) * (R7 , R8) ) ) = ( R23 + R24 ) by L19 , L16 , L15 , L18 , L3;
thus L21: ( ( ( (R11 , R11) --> R23 ) * (R7 , R8) ) + ( ( (R11 , R11) --> R24 ) * (R7 , R8) ) ) = ( ( (R11 , R11) --> ( R23 + R24 ) ) * (R7 , R8) ) by L20 , L18 , L3;
end;
thus L22: thesis by L17 , L15 , MATRIX_1:def 13;
end;
definition
let C2 , C3 , C4 , C5 being set;
func (C2 , C3) ][ (C4 , C5) ->  tabular FinSequence equals 
<* <* C2 , C3 *> , <* C4 , C5 *> *>;
correctness
proof
L23: (( len <* C2 , C3 *> ) = 2 & ( len <* C4 , C5 *> ) = 2) by FINSEQ_1:44;
thus L24: thesis by L23 , MATRIX_1:4;
end;
end;
theorem
L26: (for R3 being set holds (for R4 being set holds (for R5 being set holds (for R6 being set holds (( len ( (R3 , R4) ][ (R5 , R6) ) ) = 2 & ( width ( (R3 , R4) ][ (R5 , R6) ) ) = 2 & ( Indices ( (R3 , R4) ][ (R5 , R6) ) ) = [: ( Seg 2 ) , ( Seg 2 ) :])))))
proof
let R3 being set;
let R4 being set;
let R5 being set;
let R6 being set;
set D3 = ( (R3 , R4) ][ (R5 , R6) );
thus L27: ( len D3 ) = 2 by FINSEQ_1:44;
L28: ( rng D3 ) = { <* R3 , R4 *> , <* R5 , R6 *> } by FINSEQ_2:127;
L29: <* R3 , R4 *> in ( rng D3 ) by L28 , TARSKI:def 2;
L30: ( len <* R3 , R4 *> ) = 2 by FINSEQ_1:44;
thus L31: ( width D3 ) = 2 by L30 , L27 , L29 , MATRIX_1:def 3;
thus L32: thesis by L31 , L27 , FINSEQ_1:def 3;
end;
theorem
L33: (for R3 being set holds (for R4 being set holds (for R5 being set holds (for R6 being set holds ([ 1 , 1 ] in ( Indices ( (R3 , R4) ][ (R5 , R6) ) ) & [ 1 , 2 ] in ( Indices ( (R3 , R4) ][ (R5 , R6) ) ) & [ 2 , 1 ] in ( Indices ( (R3 , R4) ][ (R5 , R6) ) ) & [ 2 , 2 ] in ( Indices ( (R3 , R4) ][ (R5 , R6) ) ))))))
proof
let R3 being set;
let R4 being set;
let R5 being set;
let R6 being set;
L34: 2 in ( Seg 2 ) by FINSEQ_1:2 , TARSKI:def 2;
L35: (( Indices ( (R3 , R4) ][ (R5 , R6) ) ) = [: ( Seg 2 ) , ( Seg 2 ) :] & 1 in ( Seg 2 )) by L26 , FINSEQ_1:2 , TARSKI:def 2;
thus L36: thesis by L35 , L34 , ZFMISC_1:87;
end;
definition
let R13 being non  empty set;
let C6 being (Element of R13);
redefine func <*C6 *> -> (Element of ( 1 -tuples_on R13 ));

coherence by FINSEQ_2:98;
end;
definition
let R13 being non  empty set;
let R11 being Nat;
let C7 being (Element of ( R11 -tuples_on R13 ));
redefine func <*C7 *> -> (Matrix of 1 , R11 , R13);

coherence
proof
L38: ( len C7 ) = R11 by CARD_1:def 7;
thus L39: thesis by L38 , MATRIX_1:11;
end;
end;
theorem
L41: (for R13 being non  empty set holds (for R17 being (Element of R13) holds ([ 1 , 1 ] in ( Indices <* <* R17 *> *> ) & ( <* <* R17 *> *> * (1 , 1) ) = R17)))
proof
let R13 being non  empty set;
let R17 being (Element of R13);
set D4 = <* <* R17 *> *>;
L42: (( Indices D4 ) = [: ( Seg 1 ) , ( Seg 1 ) :] & 1 in ( Seg 1 )) by FINSEQ_1:2 , MATRIX_1:24 , TARSKI:def 1;
thus L43: [ 1 , 1 ] in ( Indices <* <* R17 *> *> ) by L42 , ZFMISC_1:87;
L44: (( D4 . 1 ) = <* R17 *> & ( <* R17 *> . 1 ) = R17) by FINSEQ_1:40;
thus L45: thesis by L44 , L43 , MATRIX_1:def 5;
end;
definition
let R13 being non  empty set;
let C8 , C9 , C10 , C11 being (Element of R13);
redefine func (C8 , C9) ][ (C10 , C11) -> (Matrix of 2 , R13);

coherence by MATRIX_1:19;
end;
theorem
L47: (for R13 being non  empty set holds (for R17 being (Element of R13) holds (for R18 being (Element of R13) holds (for R19 being (Element of R13) holds (for R20 being (Element of R13) holds (( ( (R17 , R18) ][ (R19 , R20) ) * (1 , 1) ) = R17 & ( ( (R17 , R18) ][ (R19 , R20) ) * (1 , 2) ) = R18 & ( ( (R17 , R18) ][ (R19 , R20) ) * (2 , 1) ) = R19 & ( ( (R17 , R18) ][ (R19 , R20) ) * (2 , 2) ) = R20))))))
proof
let R13 being non  empty set;
let R17 being (Element of R13);
let R18 being (Element of R13);
let R19 being (Element of R13);
let R20 being (Element of R13);
set D5 = ( (R17 , R18) ][ (R19 , R20) );
L48: (( D5 . 1 ) = <* R17 , R18 *> & ( D5 . 2 ) = <* R19 , R20 *>) by FINSEQ_1:44;
L49: (( <* R17 , R18 *> . 1 ) = R17 & ( <* R17 , R18 *> . 2 ) = R18) by FINSEQ_1:44;
L50: ([ 2 , 1 ] in ( Indices D5 ) & [ 2 , 2 ] in ( Indices D5 )) by L33;
L51: (( <* R19 , R20 *> . 1 ) = R19 & ( <* R19 , R20 *> . 2 ) = R20) by FINSEQ_1:44;
L52: ([ 1 , 1 ] in ( Indices D5 ) & [ 1 , 2 ] in ( Indices D5 )) by L33;
thus L53: thesis by L52 , L48 , L49 , L51 , L50 , MATRIX_1:def 5;
end;
definition
let R11 being Nat;
let R14 being Field;
let C12 being (Matrix of R11 , R14);
attr C12 is  upper_triangular
means
:L54: (for R7 being Nat holds (for R8 being Nat holds (([ R7 , R8 ] in ( Indices C12 ) & R7 > R8) implies ( C12 * (R7 , R8) ) = ( 0. R14 ))));
attr C12 is  lower_triangular
means
(for R7 being Nat holds (for R8 being Nat holds (([ R7 , R8 ] in ( Indices C12 ) & R7 < R8) implies ( C12 * (R7 , R8) ) = ( 0. R14 ))));
end;
registration
let R11 being Nat;
let R14 being Field;
cluster  ->  upper_triangular  lower_triangular for (Diagonal of R11 , R14);
coherence
proof
let C13 being (Diagonal of R11 , R14);
L56: (for R7 being Nat holds (for R8 being Nat holds (([ R7 , R8 ] in ( Indices C13 ) & R7 > R8) implies ( C13 * (R7 , R8) ) = ( 0. R14 )))) by MATRIX_1:def 14;
thus L57: C13 is  upper_triangular by L56 , L54;
thus L58: (for R7 being Nat holds (for R8 being Nat holds (([ R7 , R8 ] in ( Indices C13 ) & R7 < R8) implies ( C13 * (R7 , R8) ) = ( 0. R14 )))) by MATRIX_1:def 14;
end;
end;
registration
let R11 being Nat;
let R14 being Field;
cluster  lower_triangular  upper_triangular for (Matrix of R11 , R14);
existence
proof
set D6 = the (Diagonal of R11 , R14);
take D6;
thus L60: thesis;
end;
end;
definition
let R11 being Nat;
let R14 being Field;
mode Upper_Triangular_Matrix of R11 , R14
 is  upper_triangular (Matrix of R11 , R14);
mode Lower_Triangular_Matrix of R11 , R14
 is  lower_triangular (Matrix of R11 , R14);
end;
theorem
L63: (for R11 being Nat holds (for R13 being non  empty set holds (for B1 being (Matrix of R13) holds (( len B1 ) = R11 implies B1 is (Matrix of R11 , ( width B1 ) , R13)))))
proof
let R11 being Nat;
let R13 being non  empty set;
let C14 being (Matrix of R13);
assume that
L64: ( len C14 ) = R11
and
L65: (not C14 is (Matrix of R11 , ( width C14 ) , R13));
set D7 = ( width C14 );
per cases  by L65 , MATRIX_1:def 2;
suppose L66: ( len C14 ) <> R11;

thus L67: contradiction by L66 , L64;
end;
suppose L68: (ex B2 being (FinSequence of R13) st (B2 in ( rng C14 ) & (not ( len B2 ) = D7)));

consider R9 being Nat such that L69: (for R1 being set holds (R1 in ( rng C14 ) implies (ex R21 being (FinSequence of R13) st (R1 = R21 & ( len R21 ) = R9)))) by MATRIX_1:9;
consider C15 being (FinSequence of R13) such that L70: C15 in ( rng C14 ) and L71: ( len C15 ) <> D7 by L68;
reconsider D8 = C15 as set;
L72: (ex R21 being (FinSequence of R13) st (D8 = R21 & ( len R21 ) = R9)) by L70 , L69;
L73:
now
per cases ;
suppose L74: R11 = ( 0 );

L75: C14 = ( {} ) by L74 , L64;
thus L76: ( len C15 ) = D7 by L75 , L70 , RELAT_1:38;
end;
suppose L77: R11 > ( 0 );

consider C16 being FinSequence such that L78: C16 in ( rng C14 ) and L79: ( len C16 ) = ( width C14 ) by L77 , L64 , MATRIX_1:def 3;
reconsider D9 = C16 as set;
L80: (ex R22 being (FinSequence of R13) st (D9 = R22 & ( len R22 ) = R9)) by L69 , L78;
thus L81: ( len C15 ) = D7 by L80 , L72 , L79;
end;
end;
thus L83: contradiction by L73 , L71;
end;
end;
begin
theorem
L85: (for R11 being Nat holds (for R12 being Nat holds (for R13 being non  empty set holds (for B3 being (Matrix of R11 , R12 , R13) holds (for R9 being Nat holds (R9 in ( Seg R11 ) implies ( B3 . R9 ) = ( Line (B3 , R9) )))))))
proof
let R11 being Nat;
let R12 being Nat;
let R13 being non  empty set;
let C17 being (Matrix of R11 , R12 , R13);
let R9 being Nat;
assume L86: R9 in ( Seg R11 );
L87: (( len C17 ) = R11 & ( dom C17 ) = ( Seg ( len C17 ) )) by FINSEQ_1:def 3 , MATRIX_1:25;
L88: ( C17 . R9 ) in ( rng C17 ) by L87 , L86 , FUNCT_1:def 3;
per cases ;
suppose L89: R11 = ( 0 );

thus L90: thesis by L89 , L86;
end;
suppose L91: ( 0 ) < R11;

consider R10 being Nat such that L92: (for R1 being set holds (R1 in ( rng C17 ) implies (ex B4 being (FinSequence of R13) st (R1 = B4 & ( len B4 ) = R10)))) by MATRIX_1:9;
consider C18 being (FinSequence of R13) such that L93: ( C17 . R9 ) = C18 and L94: ( len C18 ) = R10 by L88 , L92;
L95: ( width C17 ) = R12 by L91 , MATRIX_1:23;
L96: (for R8 being Nat holds (R8 in ( Seg ( width C17 ) ) implies ( C18 . R8 ) = ( C17 * (R9 , R8) )))
proof
let R8 being Nat;
assume L97: R8 in ( Seg ( width C17 ) );
L98: [ R9 , R8 ] in [: ( Seg R11 ) , ( Seg R12 ) :] by L97 , L86 , L95 , ZFMISC_1:87;
L99: [ R9 , R8 ] in ( Indices C17 ) by L98 , L91 , MATRIX_1:23;
L100: (ex B5 being (FinSequence of R13) st (B5 = ( C17 . R9 ) & ( C17 * (R9 , R8) ) = ( B5 . R8 ))) by L99 , MATRIX_1:def 5;
thus L101: thesis by L100 , L93;
end;
L102: ( len C18 ) = ( width C17 ) by L88 , L95 , L93 , MATRIX_1:def 2;
thus L103: thesis by L102 , L93 , L96 , MATRIX_1:def 7;
end;
end;
L105: (for R14 being Field holds (for B6 being (Matrix of R14) holds (for R9 being Nat holds (R9 in ( dom B6 ) implies ( B6 . R9 ) = ( Line (B6 , R9) )))))
proof
let R14 being Field;
let C19 being (Matrix of R14);
let R9 being Nat;
assume L106: R9 in ( dom C19 );
L107: (1 <= R9 & R9 <= ( len C19 )) by L106 , FINSEQ_3:25;
reconsider D10 = C19 as (Matrix of ( len C19 ) , ( width C19 ) , R14) by L107 , MATRIX_1:20;
L108: R9 in ( Seg ( len D10 ) ) by L106 , FINSEQ_1:def 3;
thus L109: thesis by L108 , L85;
end;
definition
let R7 being Nat;
let R14 being Field;
let C20 being (Matrix of R14);
func DelCol (C20 , R7) -> (Matrix of R14) means 
(( len it ) = ( len C20 ) & (for R9 being Nat holds (R9 in ( dom C20 ) implies ( it . R9 ) = ( Del (( Line (C20 , R9) ) , R7) ))));
existence
proof
per cases ;
suppose L110: (not R7 in ( Seg ( width C20 ) ));

take C20;
thus L111: ( len C20 ) = ( len C20 );
let R9 being Nat;
assume that
L112: R9 in ( dom C20 );
L113: ( len ( Line (C20 , R9) ) ) = ( width C20 ) by MATRIX_1:def 7;
L114: (not R7 in ( dom ( Line (C20 , R9) ) )) by L113 , L110 , FINSEQ_1:def 3;
thus L115: ( C20 . R9 ) = ( Line (C20 , R9) ) by L112 , L105
.= ( Del (( Line (C20 , R9) ) , R7) ) by L114 , FINSEQ_3:104;
end;
suppose L116: R7 in ( Seg ( width C20 ) );

defpred S1[ Nat , Nat , (Element of R14) ] means $3 = ( ( Del (( Line (C20 , $1) ) , R7) ) . $2 );
per cases ;
suppose L117: ( len C20 ) = ( 0 );

L118: ( Seg ( len C20 ) ) = ( {} ) by L117;
thus L119: thesis by L118 , L116 , L117 , MATRIX_1:def 3;
end;
suppose L120: ( len C20 ) > ( 0 );

set D11 = ( width C20 );
per cases ;
suppose L121: D11 = ( 0 );

thus L122: thesis by L121 , L116;
end;
suppose L123: D11 > ( 0 );

consider C21 being Nat such that L124: D11 = ( C21 + 1 ) by L123 , NAT_1:6;
reconsider D12 = C21 as (Element of ( NAT )) by ORDINAL1:def 12;
L125: (for R9 being Nat holds (R9 in ( dom C20 ) implies ( len ( Del (( Line (C20 , R9) ) , R7) ) ) = D12))
proof
let R9 being Nat;
assume L126: R9 in ( dom C20 );
L127: ( len ( Line (C20 , R9) ) ) = D11 by MATRIX_1:def 7;
L128: R7 in ( dom ( Line (C20 , R9) ) ) by L127 , L116 , FINSEQ_1:def 3;
L129: (ex B7 being Nat st (( len ( Line (C20 , R9) ) ) = ( B7 + 1 ) & ( len ( Del (( Line (C20 , R9) ) , R7) ) ) = B7)) by L128 , FINSEQ_3:104;
thus L130: thesis by L129 , L124 , L127;
end;
L131: (for R9 being Nat holds (for R10 being Nat holds ([ R9 , R10 ] in [: ( Seg ( len C20 ) ) , ( Seg D12 ) :] implies (ex B8 being (Element of R14) st S1[ R9 , R10 , B8 ]))))
proof
let R9 being Nat;
let R10 being Nat;
assume L132: [ R9 , R10 ] in [: ( Seg ( len C20 ) ) , ( Seg D12 ) :];
reconsider D13 = ( Del (( Line (C20 , R9) ) , R7) ) as (FinSequence of R14) by FINSEQ_3:105;
L133: ( dom C20 ) = ( Seg ( len C20 ) ) by FINSEQ_1:def 3;
L134: R9 in ( dom C20 ) by L133 , L132 , ZFMISC_1:87;
L135: ( len D13 ) = D12 by L134 , L125;
L136: ( dom D13 ) = ( Seg ( len D13 ) ) by FINSEQ_1:def 3;
L137: R10 in ( Seg D12 ) by L132 , ZFMISC_1:87;
reconsider D14 = ( D13 . R10 ) as (Element of (the carrier of R14)) by L137 , L135 , L136 , FINSEQ_2:11;
take D14;
thus L138: thesis;
end;
consider C22 being (Matrix of ( len C20 ) , D12 , R14) such that L139: (for R9 being Nat holds (for R10 being Nat holds ([ R9 , R10 ] in ( Indices C22 ) implies S1[ R9 , R10 , ( C22 * (R9 , R10) ) ]))) from MATRIX_1:sch 2(L131);
L140: ( dom C20 ) = ( Seg ( len C20 ) ) by FINSEQ_1:def 3;
L141: ( Indices C22 ) = [: ( dom C20 ) , ( Seg D12 ) :] by L140 , L120 , MATRIX_1:23;
L142: (for R9 being Nat holds (for R10 being Nat holds ((R9 in ( dom C20 ) & R10 in ( Seg D12 )) implies ( C22 * (R9 , R10) ) = ( ( Del (( Line (C20 , R9) ) , R7) ) . R10 ))))
proof
let R9 being Nat;
let R10 being Nat;
assume L143: (R9 in ( dom C20 ) & R10 in ( Seg D12 ));
L144: [ R9 , R10 ] in ( Indices C22 ) by L143 , L141 , ZFMISC_1:87;
thus L145: thesis by L144 , L139;
end;
L146: ( width C22 ) = D12 by L120 , MATRIX_1:23;
reconsider D15 = C22 as (Matrix of R14);
take D15;
L147: (for R9 being Nat holds (R9 in ( dom C20 ) implies ( D15 . R9 ) = ( Del (( Line (C20 , R9) ) , R7) )))
proof
let R9 being Nat;
assume L148: R9 in ( dom C20 );
L149: R9 in ( Seg ( len C20 ) ) by L148 , FINSEQ_1:def 3;
L150: ( D15 . R9 ) = ( Line (D15 , R9) ) by L149 , L85;
reconsider D16 = ( D15 . R9 ) as FinSequence;
L151: ( len D16 ) = D12 by L146 , L150 , MATRIX_1:def 7;
L152: ( dom D16 ) = ( Seg D12 ) by L151 , FINSEQ_1:def 3;
L153:
now
let C23 being Nat;
assume L154: C23 in ( dom D16 );
L155: ( ( Line (D15 , R9) ) . C23 ) = ( D15 * (R9 , C23) ) by L154 , L146 , L152 , MATRIX_1:def 7;
thus L156: ( D16 . C23 ) = ( ( Del (( Line (C20 , R9) ) , R7) ) . C23 ) by L155 , L142 , L148 , L150 , L152 , L154;
end;
L157: ( len ( Del (( Line (C20 , R9) ) , R7) ) ) = D12 by L125 , L148;
thus L158: thesis by L157 , L151 , L153 , FINSEQ_2:9;
end;
thus L159: thesis by L147 , L120 , MATRIX_1:23;
end;
end;
end;
end;
uniqueness
proof
let C24 , C25 being (Matrix of R14);
assume that
L163: ( len C24 ) = ( len C20 )
and
L164: (for R9 being Nat holds (R9 in ( dom C20 ) implies ( C24 . R9 ) = ( Del (( Line (C20 , R9) ) , R7) )))
and
L165: ( len C25 ) = ( len C20 )
and
L166: (for R9 being Nat holds (R9 in ( dom C20 ) implies ( C25 . R9 ) = ( Del (( Line (C20 , R9) ) , R7) )));
L167: ( dom C24 ) = ( dom C20 ) by L163 , FINSEQ_3:29;
L168:
now
let C26 being Nat;
assume L169: C26 in ( dom C24 );
thus L170: ( C24 . C26 ) = ( Del (( Line (C20 , C26) ) , R7) ) by L169 , L164 , L167
.= ( C25 . C26 ) by L166 , L167 , L169;
end;
thus L171: thesis by L168 , L163 , L165 , FINSEQ_2:9;
end;
end;
theorem
L173: (for R13 being non  empty set holds (for B9 , B10 being (Matrix of R13) holds ((( B9 @ ) = ( B10 @ ) & ( len B9 ) = ( len B10 )) implies B9 = B10)))
proof
let R13 being non  empty set;
let C27 , C28 being (Matrix of R13);
assume that
L174: ( C27 @ ) = ( C28 @ )
and
L175: ( len C27 ) = ( len C28 );
L176: ( len ( C27 @ ) ) = ( width C27 ) by MATRIX_1:def 6;
L177: ( width C27 ) = ( width C28 ) by L176 , L174 , MATRIX_1:def 6;
L178: ( Indices C28 ) = [: ( dom C28 ) , ( Seg ( width C28 ) ) :];
L179: (for R7 being Nat holds (for R8 being Nat holds ([ R7 , R8 ] in ( Indices C27 ) implies ( C27 * (R7 , R8) ) = ( C28 * (R7 , R8) ))))
proof
let R7 being Nat;
let R8 being Nat;
assume L180: [ R7 , R8 ] in ( Indices C27 );
L181: ( dom C27 ) = ( Seg ( len C28 ) ) by L175 , FINSEQ_1:def 3
.= ( dom C28 ) by FINSEQ_1:def 3;
L182: ( ( C28 @ ) * (R8 , R7) ) = ( C28 * (R7 , R8) ) by L181 , L177 , L178 , L180 , MATRIX_1:def 6;
thus L183: thesis by L182 , L174 , L180 , MATRIX_1:def 6;
end;
thus L184: thesis by L179 , L175 , L177 , MATRIX_1:21;
end;
theorem
L185: (for R13 being non  empty set holds (for B11 being (Matrix of R13) holds (( width B11 ) > ( 0 ) implies (( len ( B11 @ ) ) = ( width B11 ) & ( width ( B11 @ ) ) = ( len B11 )))))
proof
let R13 being non  empty set;
let C29 being (Matrix of R13);
assume L186: ( width C29 ) > ( 0 );
thus L187: ( len ( C29 @ ) ) = ( width C29 ) by MATRIX_1:def 6;
per cases ;
suppose L188: ( len C29 ) = ( 0 );

thus L189: thesis by L188 , L186 , MATRIX_1:def 3;
end;
suppose L190: ( len C29 ) > ( 0 );

L191: (for B12 , B13 being set holds ([ B12 , B13 ] in [: ( dom ( C29 @ ) ) , ( Seg ( width ( C29 @ ) ) ) :] iff [ B12 , B13 ] in [: ( Seg ( width C29 ) ) , ( dom C29 ) :]))
proof
let C30 , C31 being set;
thus L192: ([ C30 , C31 ] in [: ( dom ( C29 @ ) ) , ( Seg ( width ( C29 @ ) ) ) :] implies [ C30 , C31 ] in [: ( Seg ( width C29 ) ) , ( dom C29 ) :])
proof
assume L193: [ C30 , C31 ] in [: ( dom ( C29 @ ) ) , ( Seg ( width ( C29 @ ) ) ) :];
L194: (C30 in ( dom ( C29 @ ) ) & C31 in ( Seg ( width ( C29 @ ) ) )) by L193 , ZFMISC_1:87;
reconsider D17 = C30 , D18 = C31 as Nat by L194;
L195: [ D17 , D18 ] in ( Indices ( C29 @ ) ) by L193;
L196: [ D18 , D17 ] in ( Indices C29 ) by L195 , MATRIX_1:def 6;
thus L197: thesis by L196 , ZFMISC_1:88;
end;

assume L198: [ C30 , C31 ] in [: ( Seg ( width C29 ) ) , ( dom C29 ) :];
L199: (C30 in ( Seg ( width C29 ) ) & C31 in ( dom C29 )) by L198 , ZFMISC_1:87;
reconsider D19 = C30 , D20 = C31 as Nat by L199;
L200: [ D20 , D19 ] in ( Indices C29 ) by L198 , ZFMISC_1:88;
L201: [ D19 , D20 ] in ( Indices ( C29 @ ) ) by L200 , MATRIX_1:def 6;
thus L202: thesis by L201;
end;
L203: (( dom C29 ) = ( Seg ( len C29 ) ) & [: ( Seg ( width C29 ) ) , ( dom C29 ) :] = [: ( dom ( C29 @ ) ) , ( Seg ( width ( C29 @ ) ) ) :]) by L191 , FINSEQ_1:def 3 , ZFMISC_1:89;
L204: ( dom C29 ) = ( Seg ( width ( C29 @ ) ) ) by L203 , L186 , L190 , ZFMISC_1:110;
thus L205: thesis by L204 , FINSEQ_1:def 3;
end;
end;
theorem
L207: (for R13 being non  empty set holds (for B14 , B15 being (Matrix of R13) holds ((( width B14 ) > ( 0 ) & ( width B15 ) > ( 0 ) & ( B14 @ ) = ( B15 @ )) implies B14 = B15)))
proof
let R13 being non  empty set;
let C32 , C33 being (Matrix of R13);
assume L208: (( width C32 ) > ( 0 ) & ( width C33 ) > ( 0 ));
L209: (( width ( C32 @ ) ) = ( len C32 ) & ( width ( C33 @ ) ) = ( len C33 )) by L208 , L185;
assume L210: ( C32 @ ) = ( C33 @ );
thus L211: thesis by L210 , L209 , L173;
end;
theorem
L212: (for R13 being non  empty set holds (for B16 , B17 being (Matrix of R13) holds ((( width B16 ) > ( 0 ) & ( width B17 ) > ( 0 )) implies (B16 = B17 iff (( B16 @ ) = ( B17 @ ) & ( width B16 ) = ( width B17 ))))))
proof
let R13 being non  empty set;
let C34 , C35 being (Matrix of R13);
assume that
L213: ( width C34 ) > ( 0 )
and
L214: ( width C35 ) > ( 0 );
thus L215: (C34 = C35 implies (( C34 @ ) = ( C35 @ ) & ( width C34 ) = ( width C35 )));
assume that
L216: ( C34 @ ) = ( C35 @ )
and
L217: ( width C34 ) = ( width C35 );
L218: ( len C34 ) = ( width ( C34 @ ) ) by L213 , L185;
L219: ( len C34 ) = ( len C35 ) by L218 , L214 , L216 , L185;
L220: ( Indices C35 ) = [: ( dom C35 ) , ( Seg ( width C35 ) ) :];
L221: (for R7 being Nat holds (for R8 being Nat holds ([ R7 , R8 ] in ( Indices C34 ) implies ( C34 * (R7 , R8) ) = ( C35 * (R7 , R8) ))))
proof
let R7 being Nat;
let R8 being Nat;
assume L222: [ R7 , R8 ] in ( Indices C34 );
L223: ( dom C34 ) = ( Seg ( len C35 ) ) by L219 , FINSEQ_1:def 3
.= ( dom C35 ) by FINSEQ_1:def 3;
L224: ( ( C35 @ ) * (R8 , R7) ) = ( C35 * (R7 , R8) ) by L223 , L217 , L220 , L222 , MATRIX_1:def 6;
thus L225: thesis by L224 , L216 , L222 , MATRIX_1:def 6;
end;
thus L226: thesis by L221 , L217 , L219 , MATRIX_1:21;
end;
theorem
L227: (for R13 being non  empty set holds (for B18 being (Matrix of R13) holds ((( len B18 ) > ( 0 ) & ( width B18 ) > ( 0 )) implies ( ( B18 @ ) @ ) = B18)))
proof
let R13 being non  empty set;
let C36 being (Matrix of R13);
assume that
L228: ( len C36 ) > ( 0 )
and
L229: ( width C36 ) > ( 0 );
set D21 = ( C36 @ );
L230: ( width D21 ) = ( len C36 ) by L229 , L185;
L231: ( len ( D21 @ ) ) = ( width D21 ) by MATRIX_1:def 6;
L232: ( len D21 ) = ( width C36 ) by MATRIX_1:def 6;
L233: (( dom C36 ) = ( Seg ( len C36 ) ) & ( dom ( D21 @ ) ) = ( Seg ( len ( D21 @ ) ) )) by FINSEQ_1:def 3;
L234: ( Indices ( D21 @ ) ) = ( Indices C36 ) by L233 , L228 , L232 , L230 , L231 , L185;
L235: (for R7 being Nat holds (for R8 being Nat holds ([ R7 , R8 ] in ( Indices ( D21 @ ) ) implies ( ( D21 @ ) * (R7 , R8) ) = ( C36 * (R7 , R8) ))))
proof
let R7 being Nat;
let R8 being Nat;
assume L236: [ R7 , R8 ] in ( Indices ( D21 @ ) );
L237: [ R8 , R7 ] in ( Indices D21 ) by L236 , MATRIX_1:def 6;
L238: ( ( D21 @ ) * (R7 , R8) ) = ( D21 * (R8 , R7) ) by L237 , MATRIX_1:def 6;
thus L239: thesis by L238 , L234 , L236 , MATRIX_1:def 6;
end;
L240: ( width D21 ) > ( 0 ) by L228 , L229 , L185;
L241: ( width ( D21 @ ) ) = ( width C36 ) by L240 , L232 , L185;
thus L242: thesis by L241 , L230 , L231 , L235 , MATRIX_1:21;
end;
theorem
L243: (for R13 being non  empty set holds (for B19 being (Matrix of R13) holds (for R7 being Nat holds (R7 in ( dom B19 ) implies ( Line (B19 , R7) ) = ( Col (( B19 @ ) , R7) )))))
proof
let R13 being non  empty set;
let C37 being (Matrix of R13);
let R7 being Nat;
L244: ( len ( C37 @ ) ) = ( width C37 ) by MATRIX_1:def 6;
L245: ( len ( Col (( C37 @ ) , R7) ) ) = ( len ( C37 @ ) ) by MATRIX_1:def 8;
L246: ( len ( Col (( C37 @ ) , R7) ) ) = ( width C37 ) by L245 , MATRIX_1:def 6;
L247: ( dom ( Col (( C37 @ ) , R7) ) ) = ( Seg ( width C37 ) ) by L246 , FINSEQ_1:def 3;
assume L248: R7 in ( dom C37 );
L249:
now
let C38 being Nat;
L250: ( dom ( C37 @ ) ) = ( Seg ( len ( C37 @ ) ) ) by FINSEQ_1:def 3;
assume L251: C38 in ( dom ( Col (( C37 @ ) , R7) ) );
L252: (( ( Line (C37 , R7) ) . C38 ) = ( C37 * (R7 , C38) ) & [ R7 , C38 ] in ( Indices C37 )) by L251 , L248 , L247 , MATRIX_1:def 7 , ZFMISC_1:87;
thus L253: ( ( Line (C37 , R7) ) . C38 ) = ( ( C37 @ ) * (C38 , R7) ) by L252 , MATRIX_1:def 6
.= ( ( Col (( C37 @ ) , R7) ) . C38 ) by L244 , L247 , L251 , L250 , MATRIX_1:def 8;
end;
L254: ( len ( Line (C37 , R7) ) ) = ( width C37 ) by MATRIX_1:def 7;
thus L255: thesis by L254 , L246 , L249 , FINSEQ_2:9;
end;
theorem
L256: (for R13 being non  empty set holds (for B20 being (Matrix of R13) holds (for R8 being Nat holds (R8 in ( Seg ( width B20 ) ) implies ( Line (( B20 @ ) , R8) ) = ( Col (B20 , R8) )))))
proof
let R13 being non  empty set;
let C39 being (Matrix of R13);
let R8 being Nat;
assume L257: R8 in ( Seg ( width C39 ) );
L258: R8 in ( Seg ( len ( C39 @ ) ) ) by L257 , MATRIX_1:def 6;
L259: R8 in ( dom ( C39 @ ) ) by L258 , FINSEQ_1:def 3;
per cases ;
suppose L260: ( len C39 ) = ( 0 );

L261: ( Seg ( len C39 ) ) = ( {} ) by L260;
thus L262: thesis by L261 , L257 , L260 , MATRIX_1:def 3;
end;
suppose L263: ( len C39 ) > ( 0 );

per cases ;
suppose L264: ( width C39 ) = ( 0 );

thus L265: thesis by L264 , L257;
end;
suppose L266: ( width C39 ) > ( 0 );

L267: ( ( C39 @ ) @ ) = C39 by L266 , L263 , L227;
thus L268: thesis by L267 , L259 , L243;
end;
end;
end;
theorem
L271: (for R13 being non  empty set holds (for B21 being (Matrix of R13) holds (for R7 being Nat holds (R7 in ( dom B21 ) implies ( B21 . R7 ) = ( Line (B21 , R7) )))))
proof
let R13 being non  empty set;
let C40 being (Matrix of R13);
let R7 being Nat;
assume L272: R7 in ( dom C40 );
L273: ( C40 . R7 ) in ( rng C40 ) by L272 , FUNCT_1:def 3;
L274: ( rng C40 ) c= ( R13 * ) by FINSEQ_1:def 4;
reconsider D22 = ( C40 . R7 ) as (FinSequence of R13) by L274 , L273 , FINSEQ_1:def 11;
L275: C40 <> ( {} ) by L272;
L276: C40 is (Matrix of ( len C40 ) , ( width C40 ) , R13) by L275 , MATRIX_1:20;
L277: ( len D22 ) = ( width C40 ) by L276 , L273 , MATRIX_1:def 2;
L278: ( len ( Line (C40 , R7) ) ) = ( width C40 ) by MATRIX_1:def 7;
L279: ( dom ( Line (C40 , R7) ) ) = ( Seg ( width C40 ) ) by L278 , FINSEQ_1:def 3;
L280: (for R8 being Nat holds (R8 in ( Seg ( width C40 ) ) implies ( C40 * (R7 , R8) ) = ( D22 . R8 )))
proof
let R8 being Nat;
assume L281: R8 in ( Seg ( width C40 ) );
L282: [ R7 , R8 ] in ( Indices C40 ) by L281 , L272 , ZFMISC_1:87;
L283: (ex B22 being (FinSequence of R13) st (B22 = ( C40 . R7 ) & ( B22 . R8 ) = ( C40 * (R7 , R8) ))) by L282 , MATRIX_1:def 5;
thus L284: thesis by L283;
end;
L285:
now
let C41 being Nat;
assume L286: C41 in ( dom ( Line (C40 , R7) ) );
thus L287: ( ( Line (C40 , R7) ) . C41 ) = ( C40 * (R7 , C41) ) by L286 , L279 , MATRIX_1:def 7
.= ( D22 . C41 ) by L280 , L279 , L286;
end;
thus L288: thesis by L285 , L277 , L278 , FINSEQ_2:9;
end;
notation
let R14 being Field;
let R7 being Nat;
let C42 being (Matrix of R14);
synonym DelLine (C42 , R7) for Del (C42 , R7);
end;
registration
let R14 being Field;
let R7 being Nat;
let C43 being (Matrix of R14);
cluster ( DelLine (C43 , R7) ) ->  tabular;
coherence
proof
consider C44 being Nat such that L290: (for R1 being set holds (R1 in ( rng C43 ) implies (ex B23 being FinSequence st (B23 = R1 & ( len B23 ) = C44)))) by MATRIX_1:def 1;
take C44;
let R1 being set;
L291: ( rng ( DelLine (C43 , R7) ) ) c= ( rng C43 ) by FINSEQ_3:106;
assume L292: R1 in ( rng ( DelLine (C43 , R7) ) );
thus L293: thesis by L292 , L290 , L291;
end;
end;
definition
let R14 being Field;
let R7 being Nat;
let C45 being (Matrix of R14);
redefine func DelLine (C45 , R7) -> (Matrix of R14);

coherence by FINSEQ_3:105;
end;
definition
let R7 being Nat;
let R8 being Nat;
let R11 being Nat;
let R14 being Field;
let C46 being (Matrix of R11 , R14);
func Deleting (C46 , R7 , R8) -> (Matrix of R14) equals 
( DelCol (( DelLine (C46 , R7) ) , R8) );
coherence;
end;
begin
definition
let C47 being set;
attr C47 is  permutational
means
:L297: (ex R11 being Nat st (for R1 being set holds (R1 in C47 implies R1 is (Permutation of ( Seg R11 )))));
end;
registration
cluster  permutational non  empty for set;
existence
proof
set D23 = the Nat;
set D24 = the (Permutation of ( Seg D23 ));
take D25 = { D24 };
thus L299: D25 is  permutational
proof
take D23;
let R1 being set;
assume L300: R1 in D25;
thus L301: thesis by L300 , TARSKI:def 1;
end;

thus L302: thesis;
end;
end;
definition
let C48 being  permutational non  empty set;
func len C48 -> Nat means 
:L304: (ex R15 being FinSequence st (R15 in C48 & it = ( len R15 )));
existence
proof
set D26 = the (Element of C48);
consider R11 being Nat such that L305: (for R2 being set holds (R2 in C48 implies R2 is (Permutation of ( Seg R11 )))) by L297;
reconsider D27 = R11 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D28 = D26 as (Permutation of ( Seg D27 )) by L305;
L306: ( dom D28 ) = ( Seg D27 ) by FUNCT_2:52;
reconsider D29 = D28 as FinSequence by L306 , FINSEQ_1:def 2;
take D27;
take D29;
thus L307: thesis by L306 , FINSEQ_1:def 3;
end;
uniqueness
proof
let C49 , C50 being Nat;
given C51 being FinSequence such that
L308: C51 in C48
and
L309: C49 = ( len C51 );

consider R11 being Nat such that L310: (for R2 being set holds (R2 in C48 implies R2 is (Permutation of ( Seg R11 )))) by L297;
L311: C51 is (Function of ( Seg R11 ) , ( Seg R11 )) by L308 , L310;
L312: (R11 in ( NAT ) & ( dom C51 ) = ( Seg R11 )) by L311 , FUNCT_2:52 , ORDINAL1:def 12;
L313: ( len C51 ) = R11 by L312 , FINSEQ_1:def 3;
given R16 being FinSequence such that
L314: R16 in C48
and
L315: C50 = ( len R16 );

L316: R16 is (Permutation of ( Seg R11 )) by L314 , L310;
L317: ( dom R16 ) = ( Seg R11 ) by L316 , FUNCT_2:52;
thus L318: thesis by L317 , L309 , L315 , L313 , FINSEQ_1:def 3;
end;
end;
definition
let C52 being  permutational non  empty set;
redefine func len C52 -> (Element of ( NAT ));

coherence by ORDINAL1:def 12;
end;
definition
let C53 being  permutational non  empty set;
redefine mode Element of C53
 -> (Permutation of ( Seg ( len C53 ) ));
coherence
proof
let C54 being (Element of C53);
consider R11 being Nat such that L321: (for R2 being set holds (R2 in C53 implies R2 is (Permutation of ( Seg R11 )))) by L297;
reconsider D30 = R11 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D31 = C54 as (Permutation of ( Seg D30 )) by L321;
L322: ( dom D31 ) = ( Seg D30 ) by FUNCT_2:52;
reconsider D32 = D31 as FinSequence by L322 , FINSEQ_1:def 2;
L323: ( len D32 ) = D30 by L322 , FINSEQ_1:def 3;
L324: ( Seg ( len C53 ) ) = ( Seg D30 ) by L323 , L304;
thus L325: thesis by L324 , L321;
end;
end;
theorem
L327: (for R11 being Nat holds (ex B24 being  permutational non  empty set st ( len B24 ) = R11))
proof
let R11 being Nat;
set D33 = the (Permutation of ( Seg R11 ));
set D34 = { D33 };
L328:
now
take D35 = R11;
let R1 being set;
assume L329: R1 in D34;
thus L330: R1 is (Permutation of ( Seg D35 )) by L329 , TARSKI:def 1;
end;
reconsider D36 = D34 as  permutational non  empty set by L328 , L297;
take D36;
L331: ( len D36 ) = R11
proof
set D37 = the (Element of D36);
reconsider D38 = D37 as (Function of ( Seg R11 ) , ( Seg R11 )) by TARSKI:def 1;
L332: ( dom D38 ) = ( Seg R11 ) by FUNCT_2:52;
reconsider D39 = D38 as FinSequence by L332 , FINSEQ_1:def 2;
L333: (R11 in ( NAT ) & ( len D36 ) = ( len D39 )) by L304 , ORDINAL1:def 12;
thus L334: thesis by L333 , L332 , FINSEQ_1:def 3;
end;
thus L335: thesis by L331;
end;
definition
let R11 being Nat;
func Permutations R11 -> set means 
:L336: (for R1 being set holds (R1 in it iff R1 is (Permutation of ( Seg R11 ))));
existence
proof
defpred S2[ set ] means $1 is (Permutation of ( Seg R11 ));
consider C55 being set such that L337: (for R1 being set holds (R1 in C55 iff (R1 in ( Funcs (( Seg R11 ) , ( Seg R11 )) ) & S2[ R1 ]))) from XBOOLE_0:sch 1;
take C55;
let R1 being set;
thus L338: (R1 in C55 implies R1 is (Permutation of ( Seg R11 ))) by L337;
assume L339: R1 is (Permutation of ( Seg R11 ));
L340: R1 in ( Funcs (( Seg R11 ) , ( Seg R11 )) ) by L339 , FUNCT_2:9;
thus L341: thesis by L340 , L337 , L339;
end;
uniqueness
proof
let C56 , C57 being set;
assume that
L342: (for R1 being set holds (R1 in C56 iff R1 is (Permutation of ( Seg R11 ))))
and
L343: (for R1 being set holds (R1 in C57 iff R1 is (Permutation of ( Seg R11 ))));
L344:
now
let R1 being set;
assume L345: R1 in C57;
L346: R1 is (Permutation of ( Seg R11 )) by L345 , L343;
thus L347: R1 in C56 by L346 , L342;
end;
L348:
now
let R1 being set;
assume L349: R1 in C56;
L350: R1 is (Permutation of ( Seg R11 )) by L349 , L342;
thus L351: R1 in C57 by L350 , L343;
end;
thus L352: thesis by L348 , L344 , TARSKI:1;
end;
end;
registration
let R11 being Nat;
cluster ( Permutations R11 ) ->  permutational non  empty;
coherence
proof
defpred S3[ set ] means $1 is (Permutation of ( Seg R11 ));
consider C58 being set such that L354: (for R1 being set holds (R1 in C58 iff (R1 in ( Funcs (( Seg R11 ) , ( Seg R11 )) ) & S3[ R1 ]))) from XBOOLE_0:sch 1;
L355: ( idseq R11 ) in ( Funcs (( Seg R11 ) , ( Seg R11 )) ) by FUNCT_2:9;
reconsider D40 = C58 as non  empty set by L355 , L354;
L356:
now
take D41 = R11;
let R1 being set;
assume L357: R1 in D40;
thus L358: R1 is (Permutation of ( Seg D41 )) by L357 , L354;
end;
reconsider D42 = D40 as  permutational non  empty set by L356 , L297;
L359: (for R1 being set holds (R1 in D42 iff R1 is (Permutation of ( Seg R11 ))))
proof
let R1 being set;
thus L360: (R1 in D42 implies R1 is (Permutation of ( Seg R11 ))) by L354;
assume L361: R1 is (Permutation of ( Seg R11 ));
L362: R1 in ( Funcs (( Seg R11 ) , ( Seg R11 )) ) by L361 , FUNCT_2:9;
thus L363: thesis by L362 , L354 , L361;
end;
thus L364: thesis by L359 , L336;
end;
end;
theorem
L366: (for R11 being Nat holds ( len ( Permutations R11 ) ) = R11)
proof
let R11 being Nat;
set D43 = the (Element of ( Permutations R11 ));
reconsider D44 = D43 as (Permutation of ( Seg R11 )) by L336;
L367: ( dom D44 ) = ( Seg R11 ) by FUNCT_2:52;
reconsider D45 = D44 as FinSequence by L367 , FINSEQ_1:def 2;
L368: R11 in ( NAT ) by ORDINAL1:def 12;
L369: ( len D45 ) = R11 by L368 , L367 , FINSEQ_1:def 3;
thus L370: thesis by L369 , L304;
end;
theorem
L371: ( Permutations 1 ) = { ( idseq 1 ) }
proof
L372: ( Permutations 1 ) c= { ( idseq 1 ) }
proof
let C59 being set;
assume L373: C59 in ( Permutations 1 );
reconsider D46 = C59 as (Permutation of ( Seg 1 )) by L373 , L336;
L374: ( dom D46 ) = ( Seg 1 ) by FUNCT_2:52;
L375: (( rng D46 ) = ( Seg 1 ) & 1 in { 1 }) by FUNCT_2:def 3 , TARSKI:def 1;
L376: ( D46 . 1 ) in ( Seg 1 ) by L375 , FINSEQ_1:2 , FUNCT_2:4;
L377: ( D46 . 1 ) = 1 by L376 , FINSEQ_1:2 , TARSKI:def 1;
reconsider D47 = D46 as FinSequence by L374 , FINSEQ_1:def 2;
L378: ( len D47 ) = 1 by L374 , FINSEQ_1:def 3;
L379: D47 = ( idseq 1 ) by L378 , L377 , FINSEQ_1:40 , FINSEQ_2:50;
thus L380: thesis by L379 , TARSKI:def 1;
end;
L381: { ( idseq 1 ) } c= ( Permutations 1 )
proof
let R1 being set;
assume L382: R1 in { ( idseq 1 ) };
L383: R1 = ( idseq 1 ) by L382 , TARSKI:def 1;
thus L384: thesis by L383 , L336;
end;
thus L385: thesis by L381 , L372 , XBOOLE_0:def 10;
end;
begin
definition
let R11 being Nat;
func Group_of_Perm R11 ->  strict multMagma means 
:L386: ((the carrier of it) = ( Permutations R11 ) & (for B25 , B26 being (Element of ( Permutations R11 )) holds ( (the multF of it) . (B25 , B26) ) = ( B26 * B25 )));
existence
proof
defpred S4[ (Element of ( Permutations R11 )) , (Element of ( Permutations R11 )) , set ] means $3 = ( $2 * $1 );
L387: (for B27 , B28 being (Element of ( Permutations R11 )) holds (ex B29 being (Element of ( Permutations R11 )) st S4[ B27 , B28 , B29 ]))
proof
let C60 , C61 being (Element of ( Permutations R11 ));
reconsider D48 = C61 , D49 = C60 as (Permutation of ( Seg R11 )) by L336;
reconsider D50 = ( D48 * D49 ) as (Element of ( Permutations R11 )) by L336;
take D50;
thus L388: thesis;
end;
consider C62 being (BinOp of ( Permutations R11 )) such that L389: (for B30 , B31 being (Element of ( Permutations R11 )) holds S4[ B30 , B31 , ( C62 . (B30 , B31) ) ]) from BINOP_1:sch 3(L387);
take multMagma (# ( Permutations R11 ) , C62 #);
thus L390: thesis by L389;
end;
uniqueness
proof
let C63 , C64 being  strict multMagma;
assume that
L391: (the carrier of C63) = ( Permutations R11 )
and
L392: (for B32 , B33 being (Element of ( Permutations R11 )) holds ( (the multF of C63) . (B32 , B33) ) = ( B33 * B32 ))
and
L393: (the carrier of C64) = ( Permutations R11 )
and
L394: (for B34 , B35 being (Element of ( Permutations R11 )) holds ( (the multF of C64) . (B34 , B35) ) = ( B35 * B34 ));
L395:
now
let C65 , C66 being (Element of C63);
reconsider D51 = C65 , D52 = C66 as (Element of ( Permutations R11 )) by L391;
thus L396: ( (the multF of C63) . (C65 , C66) ) = ( D52 * D51 ) by L392
.= ( (the multF of C64) . (C65 , C66) ) by L394;
end;
thus L397: thesis by L395 , L391 , L393 , BINOP_1:2;
end;
end;
registration
let R11 being Nat;
cluster ( Group_of_Perm R11 ) -> non  empty;
coherence
proof
L399: (the carrier of ( Group_of_Perm R11 )) = ( Permutations R11 ) by L386;
thus L400: (the carrier of ( Group_of_Perm R11 )) is non  empty by L399;
end;
end;
theorem
L402: (for R11 being Nat holds ( idseq R11 ) is (Element of ( Group_of_Perm R11 )))
proof
let R11 being Nat;
L403: (the carrier of ( Group_of_Perm R11 )) = ( Permutations R11 ) by L386;
thus L404: thesis by L403 , L336;
end;
theorem
L405: (for R11 being Nat holds (for R25 being (Element of ( Permutations R11 )) holds (( R25 * ( idseq R11 ) ) = R25 & ( ( idseq R11 ) * R25 ) = R25)))
proof
let R11 being Nat;
let R25 being (Element of ( Permutations R11 ));
L406: (( Seg R11 ) = ( {} ) implies ( Seg R11 ) = ( {} ));
L407: R25 is (Permutation of ( Seg R11 )) by L336;
L408: ( rng R25 ) = ( Seg R11 ) by L407 , FUNCT_2:def 3;
L409: R25 is (Function of ( Seg R11 ) , ( Seg R11 )) by L336;
L410: ( dom R25 ) = ( Seg R11 ) by L409 , L406 , FUNCT_2:def 1;
thus L411: thesis by L410 , L408 , RELAT_1:52 , RELAT_1:54;
end;
theorem
L412: (for R11 being Nat holds (for R25 being (Element of ( Permutations R11 )) holds (( R25 * ( R25 " ) ) = ( idseq R11 ) & ( ( R25 " ) * R25 ) = ( idseq R11 ))))
proof
let R11 being Nat;
let R25 being (Element of ( Permutations R11 ));
L413: R25 is (Permutation of ( Seg R11 )) by L336;
thus L414: thesis by L413 , FUNCT_2:61;
end;
theorem
L415: (for R11 being Nat holds (for R25 being (Element of ( Permutations R11 )) holds ( R25 " ) is (Element of ( Group_of_Perm R11 ))))
proof
let R11 being Nat;
let R25 being (Element of ( Permutations R11 ));
reconsider D53 = R25 as (Permutation of ( Seg R11 )) by L336;
L416: ( D53 " ) is (Element of ( Permutations R11 )) by L336;
thus L417: thesis by L416 , L386;
end;
registration
let R11 being Nat;
cluster ( Group_of_Perm R11 ) ->  associative  Group-like;
coherence
proof
L418: (ex B36 being (Element of ( Group_of_Perm R11 )) st (for B37 being (Element of ( Group_of_Perm R11 )) holds (( B37 * B36 ) = B37 & ( B36 * B37 ) = B37 & (ex B38 being (Element of ( Group_of_Perm R11 )) st (( B37 * B38 ) = B36 & ( B38 * B37 ) = B36)))))
proof
reconsider D54 = ( idseq R11 ) as (Element of ( Group_of_Perm R11 )) by L402;
take D54;
reconsider D55 = ( idseq R11 ) as (Element of ( Permutations R11 )) by L336;
L419: (for B39 being (Element of ( Group_of_Perm R11 )) holds (ex B40 being (Element of ( Group_of_Perm R11 )) st (( B39 * B40 ) = D54 & ( B40 * B39 ) = D54)))
proof
let C67 being (Element of ( Group_of_Perm R11 ));
reconsider D56 = C67 as (Element of ( Permutations R11 )) by L386;
reconsider D57 = D56 as (Permutation of ( Seg R11 )) by L336;
reconsider D58 = ( D57 " ) as (Element of ( Permutations R11 )) by L336;
reconsider D59 = D58 as (Element of ( Group_of_Perm R11 )) by L415;
take D59;
L420: ( D59 * C67 ) = ( D56 * D58 ) by L386
.= D54 by L412;
L421: ( C67 * D59 ) = ( D58 * D56 ) by L386
.= D54 by L412;
thus L422: thesis by L421 , L420;
end;
L423: (for B41 being (Element of ( Group_of_Perm R11 )) holds (( B41 * D54 ) = B41 & ( D54 * B41 ) = B41))
proof
let C68 being (Element of ( Group_of_Perm R11 ));
reconsider D60 = C68 as (Element of ( Permutations R11 )) by L386;
L424: ( D54 * C68 ) = ( D60 * D55 ) by L386
.= C68 by L405;
L425: ( C68 * D54 ) = ( D55 * D60 ) by L386
.= C68 by L405;
thus L426: thesis by L425 , L424;
end;
thus L427: thesis by L423 , L419;
end;
L428: (for B42 , B43 , B44 being (Element of ( Group_of_Perm R11 )) holds ( ( B42 * B43 ) * B44 ) = ( B42 * ( B43 * B44 ) ))
proof
let C69 , C70 , C71 being (Element of ( Group_of_Perm R11 ));
reconsider D61 = C69 , D62 = C70 , D63 = C71 as (Element of ( Permutations R11 )) by L386;
L429: (( D62 * D61 ) is (Permutation of ( Seg R11 )) & ( D63 * D62 ) is (Permutation of ( Seg R11 )))
proof
reconsider D64 = D61 , D65 = D62 , D66 = D63 as (Permutation of ( Seg R11 )) by L336;
L430: (( D65 * D64 ) is (Permutation of ( Seg R11 )) & ( D66 * D65 ) is (Permutation of ( Seg R11 )));
thus L431: thesis by L430;
end;
L432: ( D62 * D61 ) is (Element of ( Permutations R11 )) by L429 , L336;
L433: ( D63 * D62 ) is (Element of ( Permutations R11 )) by L429 , L336;
L434: ( ( C69 * C70 ) * C71 ) = ( (the multF of ( Group_of_Perm R11 )) . (( D62 * D61 ) , D63) ) by L386
.= ( D63 * ( D62 * D61 ) ) by L432 , L386
.= ( ( D63 * D62 ) * D61 ) by RELAT_1:36
.= ( (the multF of ( Group_of_Perm R11 )) . (D61 , ( D63 * D62 )) ) by L433 , L386
.= ( C69 * ( C70 * C71 ) ) by L386;
thus L435: thesis by L434;
end;
thus L436: thesis by L428 , L418 , GROUP_1:1;
end;
end;
theorem
L438: (for R11 being Nat holds ( idseq R11 ) = ( 1_ ( Group_of_Perm R11 ) ))
proof
let R11 being Nat;
reconsider D67 = ( idseq R11 ) as (Element of ( Group_of_Perm R11 )) by L402;
reconsider D68 = ( idseq R11 ) as (Element of ( Permutations R11 )) by L336;
L439: (for B45 being (Element of ( Group_of_Perm R11 )) holds (( B45 * D67 ) = B45 & ( D67 * B45 ) = B45))
proof
let C72 being (Element of ( Group_of_Perm R11 ));
reconsider D69 = C72 as (Element of ( Permutations R11 )) by L386;
L440: ( D67 * C72 ) = ( D69 * D68 ) by L386
.= C72 by L405;
L441: ( C72 * D67 ) = ( D68 * D69 ) by L386
.= C72 by L405;
thus L442: thesis by L441 , L440;
end;
thus L443: thesis by L439 , GROUP_1:4;
end;
definition
let R11 being Nat;
let C73 being (Permutation of ( Seg R11 ));
attr C73 is  being_transposition
means
(ex R7 being Nat st (ex R8 being Nat st (R7 in ( dom C73 ) & R8 in ( dom C73 ) & R7 <> R8 & ( C73 . R7 ) = R8 & ( C73 . R8 ) = R7 & (for R9 being Nat holds ((R9 <> R7 & R9 <> R8 & R9 in ( dom C73 )) implies ( C73 . R9 ) = R9)))));
end;
definition
let R11 being Nat;
let C74 being (Permutation of ( Seg R11 ));
attr C74 is  even
means
:L445: (ex B46 being (FinSequence of ( Group_of_Perm R11 )) st (( ( len B46 ) mod 2 ) = ( 0 ) & C74 = ( Product B46 ) & (for R7 being Nat holds (R7 in ( dom B46 ) implies (ex R26 being (Element of ( Permutations R11 )) st (( B46 . R7 ) = R26 & R26 is  being_transposition))))));
end;
notation
let R11 being Nat;
let C75 being (Permutation of ( Seg R11 ));
antonym C75 is  odd for C75 is  even;
end;
theorem
L448: (for R11 being Nat holds ( id ( Seg R11 ) ) is  even)
proof
let R11 being Nat;
set D70 = ( <*> (the carrier of ( Group_of_Perm R11 )) );
L449: ( 0 ) = ( ( 2 * ( 0 ) ) + ( 0 ) );
L450: ( ( len D70 ) mod 2 ) = ( 0 ) by L449 , NAT_D:def 2;
L451: ( Product ( <*> (the carrier of ( Group_of_Perm R11 )) ) ) = ( 1_ ( Group_of_Perm R11 ) ) by GROUP_4:8;
L452: ( idseq R11 ) = ( Product D70 ) by L451 , L438;
L453: (for R7 being Nat holds (R7 in ( dom D70 ) implies (ex R26 being (Element of ( Permutations R11 )) st (( D70 . R7 ) = R26 & R26 is  being_transposition))));
thus L454: thesis by L453 , L450 , L452 , L445;
end;
definition
let R14 being Field;
let R11 being Nat;
let C76 being (Element of R14);
let C77 being (Element of ( Permutations R11 ));
func - (C76 , C77) -> (Element of R14) equals 
C76 if C77 is  even otherwise ( - C76 );
correctness;
end;
definition
let C78 being set;
assume L456: C78 is  finite;
func FinOmega C78 -> (Element of ( Fin C78 )) equals 
C78;
coherence by L456 , FINSUB_1:def 5;
end;
theorem
L458: (for R11 being Nat holds ( Permutations R11 ) is  finite)
proof
let R11 being Nat;
L459: ( Permutations R11 ) c= ( Funcs (( Seg R11 ) , ( Seg R11 )) )
proof
let R1 being set;
assume L460: R1 in ( Permutations R11 );
L461: R1 is (Function of ( Seg R11 ) , ( Seg R11 )) by L460 , L336;
thus L462: thesis by L461 , FUNCT_2:9;
end;
L463: ( Funcs (( Seg R11 ) , ( Seg R11 )) ) is  finite by FRAENKEL:6;
thus L464: thesis by L463 , L459 , FINSET_1:1;
end;
