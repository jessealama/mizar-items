:: Primitive Roots of Unity and Cyclotomic Polynomials
::  by Broderick Arneson and Piotr Rudnicki
::
:: Received December 30, 2003
:: Copyright (c) 2003-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, SUBSET_1, XBOOLE_0, XXREAL_0, CARD_1, ARYTM_3, NAT_1,
      FINSEQ_1, RELAT_1, FUNCT_1, TARSKI, COMPLFLD, COMPLEX1, PARTFUN1, CARD_3,
      STRUCT_0, REAL_1, ORDINAL4, FINSET_1, UPROOTS, ARYTM_1, POLYNOM2,
      AFINSQ_1, GROUP_1, INT_1, HAHNBAN1, SQUARE_1, POWER, SIN_COS, BINOP_1,
      ALGSTR_0, FINSEQ_2, MOD_2, VECTSP_1, VECTSP_2, REALSET1, ZFMISC_1,
      SUPINF_2, COMPTRIG, RAT_1, PREPOWER, XREAL_0, ORDINAL1, NEWTON, XCMPLX_0,
      INT_2, BINOP_2, GROUP_2, POLYNOM1, POLYNOM3, FUNCT_4, ALGSEQ_1, VALUED_0,
      POLYNOM5, SGRAPH1, PRE_POLY, GRAPH_2, MESFUNC1, UNIROOTS;
 notations TARSKI, XBOOLE_0, SUBSET_1, REALSET1, CARD_1, NUMBERS, XREAL_0,
      ZFMISC_1, XXREAL_0, COMPLEX1, REAL_1, SQUARE_1, INT_1, INT_2, ORDINAL1,
      NAT_D, PREPOWER, POWER, BINOP_1, RELAT_1, FUNCT_1, PARTFUN1, FUNCT_2,
      FINSEQ_1, RAT_1, DOMAIN_1, FINSET_1, BINOP_2, STRUCT_0, ALGSTR_0,
      VECTSP_2, VECTSP_1, GROUP_4, RVSUM_1, ALGSEQ_1, COMPLFLD, HAHNBAN1,
      POLYNOM3, POLYNOM4, POLYNOM5, COMPTRIG, GROUP_2, NEWTON, GROUP_1, MOD_2,
      GRAPH_2, PRE_POLY, FVSUM_1, UPROOTS, SIN_COS, FUNCT_7, FINSEQ_2;
 constructors WELLORD2, BINOP_1, REAL_1, SQUARE_1, NAT_D, FINSEQOP, FINSOP_1,
      RVSUM_1, PREPOWER, POWER, REALSET1, SIN_COS, GROUP_4, MOD_2, MATRIX_2,
      HAHNBAN1, GRAPH_2, POLYNOM4, POLYNOM5, UPROOTS, SEQ_1, RECDEF_1, BINOP_2,
      RELSET_1, PBOOLE, FUNCT_7, NEWTON, FVSUM_1;
 registrations RELAT_1, FUNCT_1, FINSET_1, NUMBERS, XCMPLX_0, XXREAL_0,
      XREAL_0, NAT_1, INT_1, BINOP_2, CARD_1, MEMBERED, FINSEQ_1, FINSEQ_2,
      REALSET1, WSIERP_1, STRUCT_0, GROUP_1, VECTSP_1, COMPLFLD, QUOFIELD,
      POLYNOM3, POLYNOM5, VALUED_0, ALGSTR_0, POWER, UPROOTS, RELSET_1,
      PRE_POLY, XBOOLE_0, ZFMISC_1;
 requirements NUMERALS, BOOLE, SUBSET, ARITHM, REAL;
 definitions TARSKI, GROUP_1, XBOOLE_0, BINOP_1, REALSET1, SQUARE_1, HAHNBAN1,
      POLYNOM3, FINSEQ_2, COMPLEX1, GROUP_4, ALGSTR_0, STRUCT_0;
 theorems GROUP_1, CARD_1, FINSEQ_1, ZFMISC_1, NAT_1, FUNCT_1, FUNCT_2,
      RELAT_1, TARSKI, XBOOLE_0, XBOOLE_1, VECTSP_1, PREPOWER, COMPTRIG,
      COMPLFLD, BINOP_1, XCMPLX_1, COMPLEX1, HAHNBAN1, SIN_COS, POWER,
      SIN_COS2, POLYNOM5, INT_1, COMPLEX2, XCMPLX_0, XREAL_0, SQUARE_1,
      RVSUM_1, FVSUM_1, FINSEQ_3, FINSEQ_2, FINSEQ_4, POLYNOM4, INT_2,
      WSIERP_1, NAT_2, PEPIN, POLYNOM3, COMPUT_1, NORMSP_1, FUNCT_7, ALGSEQ_1,
      RLVECT_1, NEWTON, POLYNOM2, MATRIX_3, VECTSP_2, MOD_2, CARD_2, GRAPH_2,
      FINSEQ_5, UPROOTS, GROUP_2, BINOP_2, XREAL_1, XXREAL_0, GROUP_4,
      FUNCOP_1, ORDINAL1, FINSOP_1, NAT_D, PARTFUN1, PRE_POLY;
 schemes NAT_1, FUNCT_2, FINSEQ_1, INT_1, RECDEF_1;

begin
L1: (for B1 being (Element of ( NAT )) holds (B1 is non  empty iff 1 <= B1))
proof
let C1 being (Element of ( NAT ));
thus L2:now
assume L3: C1 is non  empty;
L4: ( ( 0 ) + 1 ) <= C1 by L3 , NAT_1:13;
thus L5: 1 <= C1 by L4;
end;
assume L6: 1 <= C1;
thus L7: thesis by L6;
end;
scheme CompIndNE { P1[non  empty Nat] } : (for B2 being non  empty (Element of ( NAT )) holds P1[ B2 ])
provided
L8: (for B3 being non  empty (Element of ( NAT )) holds ((for B4 being non  empty (Element of ( NAT )) holds (B4 < B3 implies P1[ B4 ])) implies P1[ B3 ]))
proof
let C2 being non  empty (Element of ( NAT ));
defpred S1[ Nat ] means (ex B5 being non  empty (Element of ( NAT )) st (B5 = $1 & P1[ B5 ]));
L9:
now
let C3 being Nat;
assume that
L10: C3 >= 1
and
L11: (for B6 being Nat holds ((B6 >= 1 & B6 < C3) implies S1[ B6 ]));
reconsider D1 = C3 as non  empty (Element of ( NAT )) by L10 , ORDINAL1:def 12;
L12:
now
let C4 being non  empty (Element of ( NAT ));
assume that
L13: C4 < D1;
L14: C4 >= 1 by L1;
L15: S1[ C4 ] by L14 , L11 , L13;
thus L16: P1[ C4 ] by L15;
end;
L17: P1[ D1 ] by L12 , L8;
thus L18: S1[ C3 ] by L17;
end;
L19: (for B7 being Nat holds (B7 >= 1 implies S1[ B7 ])) from NAT_1:sch 9(L9);
L20: C2 >= 1 by L1;
L21: (ex B8 being non  empty (Element of ( NAT )) st (B8 = C2 & P1[ B8 ])) by L20 , L19;
thus L22: thesis by L21;
end;
theorem
L23: (for B9 being FinSequence holds (1 <= ( len B9 ) implies ( B9 | ( Seg 1 ) ) = <* ( B9 . 1 ) *>))
proof
let C5 being FinSequence;
assume L24: 1 <= ( len C5 );
L25: ( Seg 1 ) c= ( Seg ( len C5 ) ) by L24 , FINSEQ_1:5;
L26: ( Seg 1 ) c= ( dom C5 ) by L25 , FINSEQ_1:def 3;
reconsider D2 = ( C5 | ( Seg 1 ) ) as FinSequence by FINSEQ_1:15;
L27: ( ( 0 ) + 1 ) in ( Seg 1 ) by FINSEQ_1:4;
L28: ( ( C5 | ( Seg 1 ) ) . 1 ) = ( C5 . 1 ) by L27 , FUNCT_1:49;
L29: ( dom D2 ) = ( Seg 1 ) by L26 , RELAT_1:62;
L30: ( len D2 ) = 1 by L29 , FINSEQ_1:def 3;
thus L31: thesis by L30 , L28 , FINSEQ_1:40;
end;
L32: (for B10 being FinSequence holds (for B11 , B12 being (Element of ( NAT )) holds (B12 <= B11 implies ( ( B10 | ( Seg B11 ) ) | ( Seg B12 ) ) = ( B10 | ( Seg B12 ) ))))
proof
let C6 being FinSequence;
let C7 , C8 being (Element of ( NAT ));
assume L33: C8 <= C7;
L34: ( Seg C8 ) c= ( Seg C7 ) by L33 , FINSEQ_1:5;
thus L35: thesis by L34 , RELAT_1:74;
end;
theorem
L36: (for B13 being (FinSequence of ( F_Complex )) holds (for B14 being (FinSequence of ( REAL )) holds ((( len B13 ) = ( len B14 ) & (for B15 being (Element of ( NAT )) holds (B15 in ( dom B13 ) implies |. ( B13 /. B15 ) .| = ( B14 . B15 )))) implies |. ( Product B13 ) .| = ( Product B14 ))))
proof
defpred S2[ (Element of ( NAT )) ] means (for B16 being (FinSequence of ( F_Complex )) holds (for B17 being (FinSequence of ( REAL )) holds ((( len B16 ) = ( len B17 ) & (for B18 being (Element of ( NAT )) holds (B18 in ( dom B16 ) implies |. ( B16 /. B18 ) .| = ( B17 . B18 ))) & $1 = ( len B16 )) implies |. ( Product B16 ) .| = ( Product B17 ))));
set D3 = (the carrier of ( F_Complex ));
set D4 = ( F_Complex );
L37: (for B19 being (Element of ( NAT )) holds (S2[ B19 ] implies S2[ ( B19 + 1 ) ]))
proof
let C9 being (Element of ( NAT ));
assume that
L38: S2[ C9 ];
let C10 being (FinSequence of D4);
let C11 being (FinSequence of ( REAL ));
assume that
L39: ( len C10 ) = ( len C11 )
and
L40: (for B20 being (Element of ( NAT )) holds (B20 in ( dom C10 ) implies |. ( C10 /. B20 ) .| = ( C11 . B20 )))
and
L41: ( C9 + 1 ) = ( len C10 );
consider C12 being (FinSequence of ( REAL )), C13 being Real such that L42: C11 = ( C12 ^ <* C13 *> ) by L39 , L41 , FINSEQ_2:19;
L43: ( len C11 ) = ( ( len C12 ) + ( len <* C13 *> ) ) by L42 , FINSEQ_1:22
.= ( ( len C12 ) + 1 ) by FINSEQ_1:39;
L44: ( C11 . ( len C10 ) ) = C13 by L43 , L39 , L42 , FINSEQ_1:42;
consider C14 being (FinSequence of D4), C15 being (Element of D3) such that L45: C10 = ( C14 ^ <* C15 *> ) by L41 , FINSEQ_2:19;
L46: ( len C10 ) = ( ( len C14 ) + ( len <* C15 *> ) ) by L45 , FINSEQ_1:22
.= ( ( len C14 ) + 1 ) by FINSEQ_1:39;
L47: ( dom C14 ) = ( dom C12 ) by L46 , L39 , L43 , FINSEQ_3:29;
L48:
now
let C16 being (Element of ( NAT ));
L49: ( dom C14 ) c= ( dom C10 ) by L45 , FINSEQ_1:26;
assume L50: C16 in ( dom C14 );
L51: ( C14 /. C16 ) = ( C14 . C16 ) by L50 , PARTFUN1:def 6
.= ( C10 . C16 ) by L45 , L50 , FINSEQ_1:def 7
.= ( C10 /. C16 ) by L50 , L49 , PARTFUN1:def 6;
thus L52: |. ( C14 /. C16 ) .| = ( C11 . C16 ) by L51 , L40 , L50 , L49
.= ( C12 . C16 ) by L42 , L47 , L50 , FINSEQ_1:def 7;
end;
reconsider D5 = ( Product C14 ) as (Element of ( COMPLEX )) by COMPLFLD:def 1;
L53: ( Product C11 ) = ( ( Product C12 ) * C13 ) by L42 , RVSUM_1:96;
reconsider D6 = C15 as (Element of ( COMPLEX )) by COMPLFLD:def 1;
L54: C10 <> ( {} ) by L41;
L55: ( len C10 ) in ( dom C10 ) by L54 , FINSEQ_5:6;
L56: ( C10 /. ( len C10 ) ) = ( C10 . ( len C10 ) ) by L55 , PARTFUN1:def 6
.= C15 by L45 , L46 , FINSEQ_1:42;
L57: |. D6 .| = C13 by L56 , L40 , L55 , L44;
L58: ( Product C10 ) = ( ( Product C14 ) * C15 ) by L45 , GROUP_4:6;
thus L59: |. ( Product C10 ) .| = ( |. D5 .| * |. D6 .| ) by L58 , COMPLEX1:65
.= ( Product C11 ) by L38 , L39 , L41 , L53 , L46 , L43 , L48 , L57;
end;
L60: S2[ ( 0 ) ]
proof
let C17 being (FinSequence of ( F_Complex ));
let C18 being (FinSequence of ( REAL ));
assume that
L61: ( len C17 ) = ( len C18 )
and
L62: (for B21 being (Element of ( NAT )) holds (B21 in ( dom C17 ) implies |. ( C17 /. B21 ) .| = ( C18 . B21 )))
and
L63: ( 0 ) = ( len C17 );
L64: C17 = ( <*> (the carrier of ( F_Complex )) ) by L63;
L65: C18 = ( <*> (the carrier of ( F_Complex )) ) by L64 , L61;
L66: ( Product C17 ) = ( 1r ) by L64 , COMPLFLD:8 , GROUP_4:8;
thus L67: thesis by L66 , L65 , COMPLEX1:48 , RVSUM_1:94;
end;
L68: (for B22 being (Element of ( NAT )) holds S2[ B22 ]) from NAT_1:sch 1(L60 , L37);
let C19 being (FinSequence of ( F_Complex ));
let C20 being (FinSequence of ( REAL ));
assume L69: (( len C19 ) = ( len C20 ) & (for B23 being (Element of ( NAT )) holds (B23 in ( dom C19 ) implies |. ( C19 /. B23 ) .| = ( C20 . B23 ))));
thus L70: thesis by L69 , L68;
end;
theorem
L71: (for B24 being non  empty  finite (Subset of ( F_Complex )) holds (for B25 being (Element of ( F_Complex )) holds (for B26 being (FinSequence of ( REAL )) holds ((( len B26 ) = ( card B24 ) & (for B27 being (Element of ( NAT )) holds (for B28 being (Element of ( F_Complex )) holds ((B27 in ( dom B26 ) & B28 = ( ( canFS B24 ) . B27 )) implies ( B26 . B27 ) = |. ( B25 - B28 ) .|)))) implies |. ( eval (( poly_with_roots ( (B24 , 1) -bag ) ) , B25) ) .| = ( Product B26 )))))
proof
set D7 = ( F_Complex );
let C21 being non  empty  finite (Subset of D7);
let C22 being (Element of D7);
let C23 being (FinSequence of ( REAL ));
assume that
L72: ( len C23 ) = ( card C21 )
and
L73: (for B29 being (Element of ( NAT )) holds (for B30 being (Element of D7) holds ((B29 in ( dom C23 ) & B30 = ( ( canFS C21 ) . B29 )) implies ( C23 . B29 ) = |. ( C22 - B30 ) .|)));
defpred S3[ set , set ] means (ex B31 being (Element of D7) st (B31 = ( ( canFS C21 ) . $1 ) & $2 = ( eval (<% ( - B31 ) , ( 1_ ( F_Complex ) ) %> , C22) )));
L74: ( len ( canFS C21 ) ) = ( card C21 ) by UPROOTS:3;
L75: ( dom ( canFS C21 ) ) = ( Seg ( card C21 ) ) by L74 , FINSEQ_1:def 3;
L76: (for B32 being (Element of ( NAT )) holds (B32 in ( Seg ( card C21 ) ) implies (ex B33 being (Element of D7) st S3[ B32 , B33 ])))
proof
let C24 being (Element of ( NAT ));
assume that
L77: C24 in ( Seg ( card C21 ) );
set D8 = ( ( canFS C21 ) . C24 );
L78: D8 in C21 by L75 , L77 , FINSEQ_2:11;
reconsider D9 = D8 as (Element of D7) by L78;
reconsider D10 = ( eval (<% ( - D9 ) , ( 1_ ( F_Complex ) ) %> , C22) ) as (Element of D7);
take D10;
take D9;
thus L79: thesis;
end;
consider C25 being (FinSequence of D7) such that L80: ( dom C25 ) = ( Seg ( card C21 ) ) and L81: (for B34 being (Element of ( NAT )) holds (B34 in ( Seg ( card C21 ) ) implies S3[ B34 , ( C25 /. B34 ) ])) from RECDEF_1:sch 17(L76);
L82:
now
let C26 being (Element of ( NAT ));
let C27 being (Element of D7);
assume that
L83: C26 in ( dom C25 )
and
L84: C27 = ( ( canFS C21 ) . C26 );
L85: (ex B35 being (Element of D7) st (B35 = ( ( canFS C21 ) . C26 ) & ( C25 /. C26 ) = ( eval (<% ( - B35 ) , ( 1_ ( F_Complex ) ) %> , C22) ))) by L80 , L81 , L83;
thus L86: ( C25 . C26 ) = ( eval (<% ( - C27 ) , ( 1_ ( F_Complex ) ) %> , C22) ) by L85 , L83 , L84 , PARTFUN1:def 6;
end;
L87: ( dom C23 ) = ( Seg ( card C21 ) ) by L72 , FINSEQ_1:def 3;
L88: (for B36 being (Element of ( NAT )) holds (B36 in ( dom C25 ) implies |. ( C25 /. B36 ) .| = ( C23 . B36 )))
proof
let C28 being (Element of ( NAT ));
set D11 = ( ( canFS C21 ) . C28 );
assume L89: C28 in ( dom C25 );
L90: D11 in C21 by L89 , L75 , L80 , FINSEQ_2:11;
reconsider D12 = ( ( canFS C21 ) . C28 ) as (Element of D7) by L90;
L91: ( C25 . C28 ) = ( eval (<% ( - D12 ) , ( 1_ ( F_Complex ) ) %> , C22) ) by L82 , L89;
L92: ( C25 /. C28 ) = ( C25 . C28 ) by L89 , PARTFUN1:def 6
.= ( ( - D12 ) + C22 ) by L91 , POLYNOM5:47
.= ( C22 - D12 );
thus L93: thesis by L92 , L73 , L87 , L80 , L89;
end;
L94: ( len C25 ) = ( len C23 ) by L72 , L80 , FINSEQ_1:def 3;
L95: ( eval (( poly_with_roots ( (C21 , 1) -bag ) ) , C22) ) = ( Product C25 ) by L94 , L72 , L82 , UPROOTS:67;
thus L96: thesis by L95 , L94 , L88 , L36;
end;
theorem
L97: (for B37 being (FinSequence of ( F_Complex )) holds ((for B38 being (Element of ( NAT )) holds (B38 in ( dom B37 ) implies ( B37 . B38 ) is  integer)) implies ( Sum B37 ) is  integer))
proof
set D13 = ( F_Complex );
let C29 being (FinSequence of D13);
assume L98: (for B39 being (Element of ( NAT )) holds (B39 in ( dom C29 ) implies ( C29 . B39 ) is  integer));
defpred S4[ (Element of ( NAT )) ] means (for B40 being (FinSequence of D13) holds ((( len B40 ) = $1 & (for B41 being (Element of ( NAT )) holds (B41 in ( dom B40 ) implies ( B40 . B41 ) is  integer))) implies ( Sum B40 ) is  integer));
L99: (for B42 being (Element of ( NAT )) holds (S4[ B42 ] implies S4[ ( B42 + 1 ) ]))
proof
let C30 being (Element of ( NAT ));
assume that
L100: S4[ C30 ];
let C31 being (FinSequence of D13);
assume that
L101: ( len C31 ) = ( C30 + 1 )
and
L102: (for B43 being (Element of ( NAT )) holds (B43 in ( dom C31 ) implies ( C31 . B43 ) is  integer));
consider C32 being (FinSequence of D13), C33 being (Element of D13) such that L103: C31 = ( C32 ^ <* C33 *> ) by L101 , FINSEQ_2:19;
L104:
now
let C34 being (Element of ( NAT ));
L105: ( dom C32 ) c= ( dom C31 ) by L103 , FINSEQ_1:26;
assume L106: C34 in ( dom C32 );
L107: ( C31 . C34 ) = ( C32 . C34 ) by L106 , L103 , FINSEQ_1:def 7;
thus L108: ( C32 . C34 ) is  integer by L107 , L102 , L106 , L105;
end;
L109: ( ( 0 ) + 1 ) <= ( len C31 ) by L101 , NAT_1:13;
L110: ( len C31 ) in ( dom C31 ) by L109 , FINSEQ_3:25;
L111: ( C31 . ( len C31 ) ) is  integer by L110 , L102;
reconsider D14 = ( Sum C32 ) , D15 = C33 as (Element of ( COMPLEX )) by COMPLFLD:def 1;
L112: ( len C31 ) = ( ( len C32 ) + ( len <* C33 *> ) ) by L103 , FINSEQ_1:22
.= ( ( len C32 ) + 1 ) by FINSEQ_1:40;
reconsider D16 = D14 , D17 = D15 as Integer by L112 , L100 , L101 , L103 , L104 , L111 , FINSEQ_1:42;
L113: ( Sum C31 ) = ( ( Sum C32 ) + ( Sum <* C33 *> ) ) by L103 , RLVECT_1:41
.= ( D16 + D17 ) by RLVECT_1:44;
thus L114: thesis by L113;
end;
L115: ( len C29 ) is (Element of ( NAT ));
L116: S4[ ( 0 ) ]
proof
let C35 being (FinSequence of D13);
assume L117: ( len C35 ) = ( 0 );
L118: C35 = ( <*> (the carrier of ( F_Complex )) ) by L117;
thus L119: thesis by L118 , COMPLFLD:7 , RLVECT_1:43;
end;
L120: (for B44 being (Element of ( NAT )) holds S4[ B44 ]) from NAT_1:sch 1(L116 , L99);
thus L121: thesis by L120 , L98 , L115;
end;
theorem
L122: (for B45 , B46 being (Element of ( F_Complex )) holds (for B47 , B48 being Real holds ((B47 = B45 & B48 = B46) implies (( B47 * B48 ) = ( B45 * B46 ) & ( B47 + B48 ) = ( B45 + B46 )))));
theorem
L123: (for B49 being Real holds (B49 > ( 0 ) implies (for B50 being (Element of ( F_Complex )) holds ((|. B50 .| = 1 & B50 <> [** 1 , ( 0 ) **]) implies |. ( [** B49 , ( 0 ) **] - B50 ) .| > ( B49 - 1 )))))
proof
let C36 being Real;
assume that
L124: C36 > ( 0 );
let C37 being (Element of ( F_Complex ));
assume that
L125: |. C37 .| = 1
and
L126: C37 <> [** 1 , ( 0 ) **];
set D18 = ( Im C37 );
set D19 = ( Re C37 );
L127: ( ( D19 ^2 ) + ( D18 ^2 ) ) = ( 1 ^2 ) by L125 , COMPTRIG:3;
L128:
now
assume L129: D19 = 1;
L130: D18 = ( 0 ) by L129 , L127;
thus L131: contradiction by L130 , L126 , L129 , COMPLEX1:13;
end;
L132: D19 <= 1 by L125 , COMPLEX1:54;
L133: D19 < 1 by L132 , L128 , XXREAL_0:1;
L134: ( 2 * C36 ) > ( ( 2 * C36 ) * D19 ) by L133 , L124 , XREAL_1:157;
L135: ( - ( ( 2 * C36 ) * D19 ) ) > ( - ( 2 * C36 ) ) by L134 , XREAL_1:24;
L136: ( ( - ( 2 * C36 ) ) + ( C36 ^2 ) ) < ( ( - ( ( 2 * C36 ) * D19 ) ) + ( C36 ^2 ) ) by L135 , XREAL_1:8;
L137: ( ( ( C36 ^2 ) - ( ( 2 * C36 ) * D19 ) ) + 1 ) > ( ( ( C36 ^2 ) - ( 2 * C36 ) ) + 1 ) by L136 , XREAL_1:8;
reconsider D20 = [** C36 , ( 0 ) **] as (Element of ( F_Complex ));
L138: (( Re [** ( C36 - D19 ) , ( - D18 ) **] ) = ( C36 - D19 ) & ( Im [** ( C36 - D19 ) , ( - D18 ) **] ) = ( - D18 )) by COMPLEX1:12;
L139: ( |. ( D20 - C37 ) .| ^2 ) = ( |. ( [** C36 , ( 0 ) **] - [** D19 , D18 **] ) .| ^2 ) by COMPLEX1:13
.= ( |. [** ( C36 - D19 ) , ( ( 0 ) - D18 ) **] .| ^2 ) by POLYNOM5:6
.= ( ( ( C36 - D19 ) ^2 ) + ( D18 ^2 ) ) by L138 , COMPTRIG:3
.= ( ( ( C36 ^2 ) - ( ( 2 * C36 ) * D19 ) ) + 1 ) by L127;
L140: (|. ( D20 - C37 ) .| >= ( 0 ) & ( |. ( D20 - C37 ) .| ^2 ) > ( ( C36 - 1 ) ^2 )) by L139 , L137 , COMPLEX1:46;
thus L141: thesis by L140 , SQUARE_1:48;
end;
theorem
L142: (for B51 being non  empty (FinSequence of ( REAL )) holds (for B52 being Real holds ((B52 >= 1 & (for B53 being (Element of ( NAT )) holds (B53 in ( dom B51 ) implies ( B51 . B53 ) > B52))) implies ( Product B51 ) > B52)))
proof
let C38 being non  empty (FinSequence of ( REAL ));
let C39 being Real;
assume that
L143: C39 >= 1
and
L144: (for B54 being (Element of ( NAT )) holds (B54 in ( dom C38 ) implies ( C38 . B54 ) > C39));
consider C40 being FinSequence, C41 being set such that L145: C38 = ( C40 ^ <* C41 *> ) by FINSEQ_1:46;
L146: <* C41 *> is (FinSequence of ( REAL )) by L145 , FINSEQ_1:36;
L147: ( rng <* C41 *> ) c= ( REAL ) by L146 , FINSEQ_1:def 4;
L148: { C41 } c= ( REAL ) by L147 , FINSEQ_1:38;
reconsider D21 = C41 as Real by L148 , ZFMISC_1:31;
defpred S5[ (Element of ( NAT )) ] means (for B55 being (FinSequence of ( REAL )) holds ((( len B55 ) = $1 & (for B56 being (Element of ( NAT )) holds (B56 in ( dom B55 ) implies ( B55 . B56 ) > C39))) implies ( ( Product B55 ) * D21 ) > C39));
L149: (for B57 being (Element of ( NAT )) holds (S5[ B57 ] implies S5[ ( B57 + 1 ) ]))
proof
let C42 being (Element of ( NAT ));
assume that
L150: S5[ C42 ];
let C43 being (FinSequence of ( REAL ));
assume that
L151: ( len C43 ) = ( C42 + 1 )
and
L152: (for B58 being (Element of ( NAT )) holds (B58 in ( dom C43 ) implies ( C43 . B58 ) > C39));
L153: C43 <> ( {} ) by L151;
consider C44 being FinSequence, C45 being set such that L154: C43 = ( C44 ^ <* C45 *> ) by L153 , FINSEQ_1:46;
reconsider D22 = C44 , D23 = <* C45 *> as (FinSequence of ( REAL )) by L154 , FINSEQ_1:36;
L155: ( rng D23 ) c= ( REAL );
L156: { C45 } c= ( REAL ) by L155 , FINSEQ_1:38;
reconsider D24 = C45 as Real by L156 , ZFMISC_1:31;
L157: ( C42 + 1 ) = ( ( len D22 ) + ( len D23 ) ) by L151 , L154 , FINSEQ_1:22;
L158: ( C42 + 1 ) = ( ( len D22 ) + 1 ) by L157 , FINSEQ_1:39;
L159: ( C43 . ( len C43 ) ) = D24 by L158 , L151 , L154 , FINSEQ_1:42;
L160: ( len C43 ) in ( Seg ( len C43 ) ) by L151 , FINSEQ_1:3;
L161: ( len C43 ) in ( dom C43 ) by L160 , FINSEQ_1:def 3;
L162: D24 > 1 by L161 , L143 , L152 , L159 , XXREAL_0:2;
L163: ( C39 * D24 ) > C39 by L162 , L143 , XREAL_1:155;
L164: (for B59 being (Element of ( NAT )) holds (B59 in ( dom D22 ) implies ( D22 . B59 ) > C39))
proof
L165: ( dom D22 ) c= ( dom C43 ) by L154 , FINSEQ_1:26;
let C46 being (Element of ( NAT ));
assume that
L166: C46 in ( dom D22 );
L167: ( C43 . C46 ) = ( D22 . C46 ) by L154 , L166 , FINSEQ_1:def 7;
thus L168: thesis by L167 , L152 , L166 , L165;
end;
L169: ( Product C43 ) = ( ( Product D22 ) * D24 ) by L154 , RVSUM_1:96;
L170: ( ( Product C43 ) * D21 ) = ( ( ( Product D22 ) * D21 ) * D24 ) by L169;
L171: D24 > C39 by L152 , L159 , L161;
L172: ( ( Product C43 ) * D21 ) > ( C39 * D24 ) by L171 , L143 , L150 , L158 , L164 , L170 , XREAL_1:68;
thus L173: thesis by L172 , L163 , XXREAL_0:2;
end;
L174: ( len C38 ) in ( Seg ( len C38 ) ) by FINSEQ_1:3;
L175: ( len C38 ) in ( dom C38 ) by L174 , FINSEQ_1:def 3;
reconsider D25 = C40 as (FinSequence of ( REAL )) by L145 , FINSEQ_1:36;
L176: (for B60 being (Element of ( NAT )) holds (B60 in ( dom D25 ) implies ( D25 . B60 ) > C39))
proof
L177: ( dom D25 ) c= ( dom C38 ) by L145 , FINSEQ_1:26;
let C47 being (Element of ( NAT ));
assume that
L178: C47 in ( dom D25 );
L179: ( C38 . C47 ) = ( D25 . C47 ) by L145 , L178 , FINSEQ_1:def 7;
thus L180: thesis by L179 , L144 , L178 , L177;
end;
L181: ( len D25 ) = ( len D25 );
L182: ( len C38 ) = ( ( len C40 ) + ( len <* C41 *> ) ) by L145 , FINSEQ_1:22;
L183: ( len C38 ) = ( ( len C40 ) + 1 ) by L182 , FINSEQ_1:39;
L184: ( C38 . ( len C38 ) ) = D21 by L183 , L145 , FINSEQ_1:42;
L185: S5[ ( 0 ) ]
proof
let C48 being (FinSequence of ( REAL ));
assume that
L186: ( len C48 ) = ( 0 )
and
L187: (for B61 being (Element of ( NAT )) holds (B61 in ( dom C48 ) implies ( C48 . B61 ) > C39));
L188: C48 = ( <*> ( REAL ) ) by L186;
L189: ( Product C48 ) = 1 by L188 , RVSUM_1:94;
thus L190: thesis by L189 , L144 , L184 , L175;
end;
L191: (for B62 being (Element of ( NAT )) holds S5[ B62 ]) from NAT_1:sch 1(L185 , L149);
L192: ( ( Product D25 ) * D21 ) > C39 by L191 , L176 , L181;
thus L193: thesis by L192 , L145 , RVSUM_1:96;
end;
theorem
L194: (for B63 being (Element of ( NAT )) holds ( 1_ ( F_Complex ) ) = ( ( power ( F_Complex ) ) . (( 1_ ( F_Complex ) ) , B63) ))
proof
let C49 being (Element of ( NAT ));
L195: ( 1_ ( F_Complex ) ) = [** 1 , ( 0 ) **] by COMPLFLD:8;
L196: ( ( power ( F_Complex ) ) . (( 1_ ( F_Complex ) ) , C49) ) = [** ( 1 to_power C49 ) , ( 0 ) **] by L195 , HAHNBAN1:29
.= ( 1_ ( F_Complex ) ) by COMPLFLD:8 , POWER:26;
thus L197: thesis by L196;
end;
theorem
L198: (for B64 , B65 being (Element of ( NAT )) holds (( cos ( ( ( 2 * ( PI ) ) * B65 ) / B64 ) ) = ( cos ( ( ( 2 * ( PI ) ) * ( B65 mod B64 ) ) / B64 ) ) & ( sin ( ( ( 2 * ( PI ) ) * B65 ) / B64 ) ) = ( sin ( ( ( 2 * ( PI ) ) * ( B65 mod B64 ) ) / B64 ) )))
proof
let C50 , C51 being (Element of ( NAT ));
set D26 = ( C51 div C50 );
per cases ;
suppose L199: C50 <> ( 0 );

L200: C51 = ( ( C50 * D26 ) + ( C51 mod C50 ) ) by L199 , NAT_D:2;
L201: ( ( ( 2 * ( PI ) ) * C51 ) / C50 ) = ( ( ( ( 2 * ( PI ) ) * ( C50 * D26 ) ) + ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) ) / C50 ) by L200
.= ( ( ( ( 2 * ( PI ) ) * ( C50 * D26 ) ) / ( C50 * 1 ) ) + ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) by XCMPLX_1:62
.= ( ( ( ( ( 2 * ( PI ) ) / C50 ) * ( C50 * D26 ) ) / 1 ) + ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) by XCMPLX_1:83
.= ( ( ( ( 2 * ( PI ) ) * ( 1 / C50 ) ) * ( C50 * D26 ) ) + ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) by XCMPLX_1:99
.= ( ( ( 2 * ( PI ) ) * ( ( 1 / C50 ) * ( D26 * C50 ) ) ) + ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) )
.= ( ( ( 2 * ( PI ) ) * ( D26 * 1 ) ) + ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) by L199 , XCMPLX_1:90
.= ( ( ( 2 * ( PI ) ) * D26 ) + ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) );
L202: ( sin ( ( ( 2 * ( PI ) ) * C51 ) / C50 ) ) = ( ( ( sin ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) + ( ( cos ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by L201 , SIN_COS:75
.= ( ( ( ( sin ) . ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) + ( ( cos ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by SIN_COS:def 17
.= ( ( ( ( sin ) . ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) + ( ( ( cos ) . ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by SIN_COS:def 19
.= ( ( ( ( sin ) . ( 0 ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) + ( ( ( cos ) . ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by SIN_COS2:10
.= ( ( ( ( sin ) . ( 0 ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) + ( ( ( cos ) . ( 0 ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by SIN_COS2:11
.= ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) by SIN_COS:30;
L203: ( cos ( ( ( 2 * ( PI ) ) * C51 ) / C50 ) ) = ( ( ( cos ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) - ( ( sin ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by L201 , SIN_COS:75
.= ( ( ( ( cos ) . ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) - ( ( sin ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by SIN_COS:def 19
.= ( ( ( ( cos ) . ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) - ( ( ( sin ) . ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by SIN_COS:def 17
.= ( ( ( ( cos ) . ( 0 ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) - ( ( ( sin ) . ( ( ( 2 * ( PI ) ) * D26 ) + ( 0 ) ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by SIN_COS2:11
.= ( ( ( ( cos ) . ( 0 ) ) * ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) - ( ( ( sin ) . ( 0 ) ) * ( sin ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) ) ) by SIN_COS2:10
.= ( cos ( ( ( 2 * ( PI ) ) * ( C51 mod C50 ) ) / C50 ) ) by SIN_COS:30;
thus L204: thesis by L203 , L202;
end;
suppose L205: C50 = ( 0 );

L206: ( ( ( 2 * ( PI ) ) * C51 ) / C50 ) = ( 0 ) by L205 , XCMPLX_1:49;
thus L207: thesis by L206 , L205 , XCMPLX_1:49;
end;
end;
theorem
L209: (for B66 , B67 being (Element of ( NAT )) holds [** ( cos ( ( ( 2 * ( PI ) ) * B67 ) / B66 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B67 ) / B66 ) ) **] = [** ( cos ( ( ( 2 * ( PI ) ) * ( B67 mod B66 ) ) / B66 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( B67 mod B66 ) ) / B66 ) ) **])
proof
let C52 , C53 being (Element of ( NAT ));
L210: [** ( cos ( ( ( 2 * ( PI ) ) * C53 ) / C52 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C53 ) / C52 ) ) **] = [** ( cos ( ( ( 2 * ( PI ) ) * ( C53 mod C52 ) ) / C52 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C53 ) / C52 ) ) **] by L198
.= [** ( cos ( ( ( 2 * ( PI ) ) * ( C53 mod C52 ) ) / C52 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( C53 mod C52 ) ) / C52 ) ) **] by L198;
thus L211: thesis by L210;
end;
theorem
L212: (for B68 , B69 , B70 being (Element of ( NAT )) holds ( [** ( cos ( ( ( 2 * ( PI ) ) * B69 ) / B68 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B69 ) / B68 ) ) **] * [** ( cos ( ( ( 2 * ( PI ) ) * B70 ) / B68 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B70 ) / B68 ) ) **] ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( B69 + B70 ) mod B68 ) ) / B68 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( ( B69 + B70 ) mod B68 ) ) / B68 ) ) **])
proof
let C54 , C55 , C56 being (Element of ( NAT ));
L213: ( ( ( ( 2 * ( PI ) ) * C55 ) / C54 ) + ( ( ( 2 * ( PI ) ) * C56 ) / C54 ) ) = ( ( ( ( 2 * ( PI ) ) * C55 ) + ( ( 2 * ( PI ) ) * C56 ) ) / C54 ) by XCMPLX_1:62
.= ( ( ( 2 * ( PI ) ) * ( C55 + C56 ) ) / C54 );
L214: (( ( ( cos ( ( ( 2 * ( PI ) ) * C55 ) / C54 ) ) * ( cos ( ( ( 2 * ( PI ) ) * C56 ) / C54 ) ) ) - ( ( sin ( ( ( 2 * ( PI ) ) * C55 ) / C54 ) ) * ( sin ( ( ( 2 * ( PI ) ) * C56 ) / C54 ) ) ) ) = ( cos ( ( ( 2 * ( PI ) ) * ( C55 + C56 ) ) / C54 ) ) & ( ( ( cos ( ( ( 2 * ( PI ) ) * C55 ) / C54 ) ) * ( sin ( ( ( 2 * ( PI ) ) * C56 ) / C54 ) ) ) + ( ( cos ( ( ( 2 * ( PI ) ) * C56 ) / C54 ) ) * ( sin ( ( ( 2 * ( PI ) ) * C55 ) / C54 ) ) ) ) = ( sin ( ( ( 2 * ( PI ) ) * ( C55 + C56 ) ) / C54 ) )) by L213 , SIN_COS:75;
L215: ( [** ( cos ( ( ( 2 * ( PI ) ) * C55 ) / C54 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C55 ) / C54 ) ) **] * [** ( cos ( ( ( 2 * ( PI ) ) * C56 ) / C54 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C56 ) / C54 ) ) **] ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( C55 + C56 ) ) / C54 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( C55 + C56 ) ) / C54 ) ) **] by L214
.= [** ( cos ( ( ( 2 * ( PI ) ) * ( ( C55 + C56 ) mod C54 ) ) / C54 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( ( C55 + C56 ) mod C54 ) ) / C54 ) ) **] by L209;
thus L216: thesis by L215;
end;
theorem
L217: (for B71 being  unital  associative non  empty multMagma holds (for B72 being (Element of B71) holds (for B73 , B74 being (Element of ( NAT )) holds ( ( power B71 ) . (B72 , ( B73 * B74 )) ) = ( ( power B71 ) . (( ( power B71 ) . (B72 , B73) ) , B74) ))))
proof
let C57 being  unital  associative non  empty multMagma;
let C58 being (Element of C57);
let C59 being (Element of ( NAT ));
defpred S6[ (Element of ( NAT )) ] means ( ( power C57 ) . (C58 , ( C59 * $1 )) ) = ( ( power C57 ) . (( ( power C57 ) . (C58 , C59) ) , $1) );
set D27 = ( power C57 );
L218: (for B75 being (Element of ( NAT )) holds (S6[ B75 ] implies S6[ ( B75 + 1 ) ]))
proof
let C60 being (Element of ( NAT ));
assume that
L219: S6[ C60 ];
thus L220: ( D27 . (C58 , ( C59 * ( C60 + 1 ) )) ) = ( D27 . (C58 , ( ( C59 * C60 ) + ( C59 * 1 ) )) )
.= ( ( D27 . (C58 , ( C59 * C60 )) ) * ( D27 . (C58 , C59) ) ) by POLYNOM2:1
.= ( D27 . (( D27 . (C58 , C59) ) , ( C60 + 1 )) ) by L219 , GROUP_1:def 7;
end;
L221: ( D27 . (C58 , ( C59 * (( 0 ) qua Nat) )) ) = ( 1_ C57 ) by GROUP_1:def 7
.= ( D27 . (( D27 . (C58 , C59) ) , ( 0 )) ) by GROUP_1:def 7;
L222: S6[ ( 0 ) ] by L221;
thus L223: (for B76 being (Element of ( NAT )) holds S6[ B76 ]) from NAT_1:sch 1(L222 , L218);
end;
theorem
L224: (for B77 being (Element of ( NAT )) holds (for B78 being (Element of ( F_Complex )) holds (B78 is Integer implies ( ( power ( F_Complex ) ) . (B78 , B77) ) is Integer)))
proof
let C61 being (Element of ( NAT ));
let C62 being (Element of ( F_Complex ));
assume that
L225: C62 is Integer;
defpred S7[ (Element of ( NAT )) ] means ( ( power ( F_Complex ) ) . (C62 , $1) ) is Integer;
L226:
now
reconsider D28 = C62 as Integer by L225;
let C63 being (Element of ( NAT ));
assume L227: S7[ C63 ];
reconsider D29 = ( ( power ( F_Complex ) ) . (C62 , C63) ) as Integer by L227;
L228: ( ( ( power ( F_Complex ) ) . (C62 , C63) ) * C62 ) = ( D28 * D29 );
thus L229: S7[ ( C63 + 1 ) ] by L228 , GROUP_1:def 7;
end;
L230: S7[ ( 0 ) ] by COMPLFLD:8 , GROUP_1:def 7;
L231: (for B79 being (Element of ( NAT )) holds S7[ B79 ]) from NAT_1:sch 1(L230 , L226);
thus L232: thesis by L231;
end;
theorem
L233: (for B80 being (FinSequence of ( F_Complex )) holds ((for B81 being (Element of ( NAT )) holds (B81 in ( dom B80 ) implies ( B80 . B81 ) is Integer)) implies ( Sum B80 ) is Integer))
proof
defpred S8[ (Element of ( NAT )) ] means (for B82 being (FinSequence of ( F_Complex )) holds ((( len B82 ) = $1 & (for B83 being (Element of ( NAT )) holds (B83 in ( dom B82 ) implies ( B82 . B83 ) is Integer))) implies ( Sum B82 ) is Integer));
let C64 being (FinSequence of ( F_Complex ));
assume that
L234: (for B84 being (Element of ( NAT )) holds (B84 in ( dom C64 ) implies ( C64 . B84 ) is Integer));
L235: (for B85 being (Element of ( NAT )) holds (S8[ B85 ] implies S8[ ( B85 + 1 ) ]))
proof
let C65 being (Element of ( NAT ));
assume that
L236: S8[ C65 ];
let C66 being (FinSequence of ( F_Complex ));
assume that
L237: ( len C66 ) = ( C65 + 1 )
and
L238: (for B86 being (Element of ( NAT )) holds (B86 in ( dom C66 ) implies ( C66 . B86 ) is Integer));
L239: C66 <> ( {} ) by L237;
consider C67 being FinSequence, C68 being set such that L240: C66 = ( C67 ^ <* C68 *> ) by L239 , FINSEQ_1:46;
L241: ( len C66 ) in ( Seg ( len C66 ) ) by L237 , FINSEQ_1:3;
L242: ( len C66 ) in ( dom C66 ) by L241 , FINSEQ_1:def 3;
reconsider D30 = <* C68 *> as (FinSequence of ( F_Complex )) by L240 , FINSEQ_1:36;
reconsider D31 = C67 as (FinSequence of ( F_Complex )) by L240 , FINSEQ_1:36;
L243: ( rng D30 ) c= (the carrier of ( F_Complex )) by FINSEQ_1:def 4;
L244: { C68 } c= (the carrier of ( F_Complex )) by L243 , FINSEQ_1:38;
reconsider D32 = C68 as (Element of ( F_Complex )) by L244 , ZFMISC_1:31;
L245: ( C65 + 1 ) = ( ( len D31 ) + ( len D30 ) ) by L237 , L240 , FINSEQ_1:22;
L246: ( C65 + 1 ) = ( ( len D31 ) + 1 ) by L245 , FINSEQ_1:39;
L247: ( C66 . ( len C66 ) ) = D32 by L246 , L237 , L240 , FINSEQ_1:42;
reconsider D33 = D32 as Integer by L247 , L238 , L242;
L248: (for B87 being (Element of ( NAT )) holds (B87 in ( dom D31 ) implies ( D31 . B87 ) is Integer))
proof
L249: ( dom D31 ) c= ( dom C66 ) by L240 , FINSEQ_1:26;
let C69 being (Element of ( NAT ));
assume that
L250: C69 in ( dom D31 );
L251: ( C66 . C69 ) = ( D31 . C69 ) by L240 , L250 , FINSEQ_1:def 7;
thus L252: thesis by L251 , L238 , L250 , L249;
end;
reconsider D34 = ( Sum D31 ) as Integer by L248 , L236 , L246;
L253: ( Sum C66 ) = ( ( Sum D31 ) + D32 ) by L240 , FVSUM_1:71;
L254: ( Sum C66 ) = ( D34 + D33 ) by L253;
thus L255: thesis by L254;
end;
L256: S8[ ( 0 ) ]
proof
let C70 being (FinSequence of ( F_Complex ));
assume that
L257: ( len C70 ) = ( 0 )
and
L258: (for B88 being (Element of ( NAT )) holds (B88 in ( dom C70 ) implies ( C70 . B88 ) is Integer));
L259: (( ( 0 ) -tuples_on (the carrier of ( F_Complex )) ) = { ( {} ) } & C70 = ( {} )) by L257 , COMPUT_1:5;
L260: C70 is (Element of ( ( 0 ) -tuples_on (the carrier of ( F_Complex )) )) by L259 , TARSKI:def 1;
thus L261: thesis by L260 , COMPLFLD:7 , FVSUM_1:74;
end;
L262: (for B89 being (Element of ( NAT )) holds S8[ B89 ]) from NAT_1:sch 1(L256 , L235);
L263: ( len C64 ) = ( len C64 );
thus L264: thesis by L263 , L234 , L262;
end;
L265: ( Z_3 ) is  finite by MOD_2:def 20;
registration
cluster  finite for Field;
existence by L265 , MOD_2:27;
cluster  finite for Skew-Field;
existence by L265 , MOD_2:27;
end;
begin
definition
let C71 being Skew-Field;
func MultGroup C71 ->  strict Group means 
:L267: ((the carrier of it) = ( NonZero C71 ) & (the multF of it) = ( (the multF of C71) || (the carrier of it) ));
existence
proof
set D35 = ( NonZero C71 );
set D36 = (the carrier of C71);
reconsider D37 = D35 as non  empty set;
set D38 = ( (the multF of C71) || D37 );
L268: [: D37 , D37 :] c= [: D36 , D36 :]
proof
let C72 being set;
assume L269: C72 in [: D37 , D37 :];
L270: (ex B90 , B91 being set st (B90 in D37 & B91 in D37 & C72 = [ B90 , B91 ])) by L269 , ZFMISC_1:def 2;
thus L271: thesis by L270 , ZFMISC_1:def 2;
end;
reconsider D39 = D38 as (Function of [: D37 , D37 :] , D36) by L268 , FUNCT_2:32;
L272: ( rng D39 ) c= D37
proof
let C73 being set;
assume L273: C73 in ( rng D39 );
consider C74 being set such that L274: C74 in ( dom D39 ) and L275: C73 = ( D39 . C74 ) by L273 , FUNCT_1:def 3;
L276: ( dom D39 ) = [: D37 , D37 :] by FUNCT_2:def 1;
consider C75 , C76 being set such that L277: C75 in D37 and L278: C76 in D37 and L279: C74 = [ C75 , C76 ] by L276 , L274 , ZFMISC_1:def 2;
reconsider D40 = C75 , D41 = C76 as (Element of D36) by L277 , L278;
L280: (not D41 in { ( 0. C71 ) }) by L278 , XBOOLE_0:def 5;
L281: D41 <> ( 0. C71 ) by L280 , TARSKI:def 1;
L282: (not D40 in { ( 0. C71 ) }) by L277 , XBOOLE_0:def 5;
L283: D40 <> ( 0. C71 ) by L282 , TARSKI:def 1;
L284: ( D40 * D41 ) <> ( 0. C71 ) by L283 , L281 , VECTSP_2:12;
L285: (not ( D40 * D41 ) in { ( 0. C71 ) }) by L284 , TARSKI:def 1;
L286: ( D39 . C74 ) = ( D40 * D41 ) by L274 , L276 , L279 , FUNCT_1:49;
thus L287: thesis by L286 , L275 , L285 , XBOOLE_0:def 5;
end;
reconsider D42 = D39 as (BinOp of D37) by L272 , FUNCT_2:6;
reconsider D43 = multMagma (# D37 , D42 #) as non  empty multMagma;
set D44 = (the carrier of D43);
L288:
now
let C77 , C78 being (Element of D36);
let C79 , C80 being (Element of D44);
assume that
L289: (C77 = C79 & C78 = C80);
L290: [ C79 , C80 ] in [: D37 , D37 :] by ZFMISC_1:def 2;
thus L291: ( C77 * C78 ) = ( C79 * C80 ) by L290 , L289 , FUNCT_1:49;
end;
L292: (not ( 1_ C71 ) in { ( 0. C71 ) }) by TARSKI:def 1;
L293: D43 is  Group-like
proof
reconsider D45 = ( 1_ C71 ) as (Element of D44) by L292 , XBOOLE_0:def 5;
take D45;
let C81 being (Element of D44);
L294: C81 in D37;
reconsider D46 = C81 as (Scalar of C71) by L294;
thus L295: ( C81 * D45 ) = ( D46 * ( 1_ C71 ) ) by L288
.= C81 by VECTSP_1:def 4;
thus L296: ( D45 * C81 ) = ( ( 1_ C71 ) * D46 ) by L288
.= C81 by VECTSP_1:def 8;
L297: (not C81 in { ( 0. C71 ) }) by XBOOLE_0:def 5;
L298: C81 <> ( 0. C71 ) by L297 , TARSKI:def 1;
L299: ( D46 " ) <> ( 0. C71 ) by L298 , VECTSP_2:13;
L300: (not ( D46 " ) in { ( 0. C71 ) }) by L299 , TARSKI:def 1;
reconsider D47 = ( D46 " ) as (Element of D44) by L300 , XBOOLE_0:def 5;
take D47;
thus L301: ( C81 * D47 ) = ( D46 * ( D46 " ) ) by L288
.= D45 by L298 , VECTSP_2:9;
thus L302: ( D47 * C81 ) = ( ( D46 " ) * D46 ) by L288
.= D45 by L298 , VECTSP_2:9;
end;
L303: D43 is  associative
proof
let C82 , C83 , C84 being (Element of D44);
L304: C84 in D44;
L305: (C82 in D44 & C83 in D44);
reconsider D48 = C82 , D49 = C83 , D50 = C84 as (Element of D36) by L305 , L304;
L306: ( D49 * D50 ) = ( C83 * C84 ) by L288;
L307: ( D48 * D49 ) = ( C82 * C83 ) by L288;
thus L308: ( ( C82 * C83 ) * C84 ) = ( ( D48 * D49 ) * D50 ) by L307 , L288
.= ( D48 * ( D49 * D50 ) ) by GROUP_1:def 3
.= ( C82 * ( C83 * C84 ) ) by L288 , L306;
end;
thus L309: thesis by L303 , L293;
end;
uniqueness;
end;
theorem
L311: (for B92 being Skew-Field holds (the carrier of B92) = ( (the carrier of ( MultGroup B92 )) \/ { ( 0. B92 ) } ))
proof
let C85 being Skew-Field;
L312: ( NonZero C85 ) = (the carrier of ( MultGroup C85 )) by L267;
thus L313: thesis by L312 , XBOOLE_1:45;
end;
theorem
L314: (for B93 being Skew-Field holds (for B94 , B95 being (Element of B93) holds (for B96 , B97 being (Element of ( MultGroup B93 )) holds ((B94 = B96 & B95 = B97) implies ( B96 * B97 ) = ( B94 * B95 )))))
proof
let C86 being Skew-Field;
let C87 , C88 being (Element of C86);
let C89 , C90 being (Element of ( MultGroup C86 ));
assume that
L315: (C87 = C89 & C88 = C90);
set D51 = (the carrier of ( MultGroup C86 ));
L316: [ C89 , C90 ] in [: D51 , D51 :] by ZFMISC_1:def 2;
thus L317: ( C89 * C90 ) = ( ( (the multF of C86) || D51 ) . (C89 , C90) ) by L267
.= ( C87 * C88 ) by L315 , L316 , FUNCT_1:49;
end;
theorem
L318: (for B98 being Skew-Field holds ( 1_ B98 ) = ( 1_ ( MultGroup B98 ) ))
proof
let C91 being Skew-Field;
L319: (the carrier of ( MultGroup C91 )) = ( NonZero C91 ) by L267;
L320: (not ( 1_ C91 ) in { ( 0. C91 ) }) by TARSKI:def 1;
reconsider D52 = ( 1_ C91 ) as (Element of ( MultGroup C91 )) by L320 , L319 , XBOOLE_0:def 5;
L321:
now
let C92 being (Element of ( MultGroup C91 ));
reconsider D53 = C92 as (Element of C91) by L319 , XBOOLE_0:def 5;
L322: ( D53 * ( 1_ C91 ) ) = D53 by VECTSP_1:def 4;
thus L323: ( C92 * D52 ) = C92 by L322 , L314;
L324: ( ( 1_ C91 ) * D53 ) = D53 by VECTSP_1:def 8;
thus L325: ( D52 * C92 ) = C92 by L324 , L314;
end;
thus L326: thesis by L321 , GROUP_1:def 4;
end;
registration
let C93 being  finite Skew-Field;
cluster ( MultGroup C93 ) ->  finite;
correctness
proof
L327: (the carrier of ( MultGroup C93 )) = ( NonZero C93 ) by L267;
thus L328: thesis by L327;
end;
end;
theorem
L330: (for B99 being  finite Skew-Field holds ( card ( MultGroup B99 ) ) = ( ( card B99 ) - 1 ))
proof
let C94 being  finite Skew-Field;
set D54 = ( MultGroup C94 );
L331: (the carrier of D54) = ( NonZero C94 ) by L267;
L332: ( card (the carrier of D54) ) = ( ( card C94 ) - ( card { ( 0. C94 ) } ) ) by L331 , CARD_2:44;
thus L333: thesis by L332 , CARD_1:30;
end;
theorem
L334: (for B100 being Skew-Field holds (for B101 being set holds (B101 in (the carrier of ( MultGroup B100 )) implies B101 in (the carrier of B100))))
proof
let C95 being Skew-Field;
let C96 being set;
assume L335: C96 in (the carrier of ( MultGroup C95 ));
L336: C96 in ( NonZero C95 ) by L335 , L267;
thus L337: thesis by L336;
end;
theorem
L338: (for B102 being Skew-Field holds (the carrier of ( MultGroup B102 )) c= (the carrier of B102))
proof
let C97 being Skew-Field;
let C98 being set;
assume L339: C98 in (the carrier of ( MultGroup C97 ));
L340: C98 in ( NonZero C97 ) by L339 , L267;
thus L341: thesis by L340;
end;
begin
definition
let C99 being non  empty (Element of ( NAT ));
func C99 -roots_of_1 -> (Subset of ( F_Complex )) equals 
{ B103 where B103 is (Element of ( F_Complex )) : B103 is (CRoot of C99 , ( 1_ ( F_Complex ) )) };
coherence
proof
set D55 = { B104 where B104 is (Element of ( F_Complex )) : B104 is (CRoot of C99 , ( 1_ ( F_Complex ) )) };
L342: (for B105 being set holds (B105 in D55 implies B105 in (the carrier of ( F_Complex ))))
proof
let C100 being set;
assume L343: C100 in D55;
L344: (ex B106 being (Element of ( F_Complex )) st (B106 = C100 & B106 is (CRoot of C99 , ( 1_ ( F_Complex ) )))) by L343;
thus L345: thesis by L344;
end;
thus L346: thesis by L342 , TARSKI:def 3;
end;
end;
theorem
L348: (for B107 being non  empty (Element of ( NAT )) holds (for B108 being (Element of ( F_Complex )) holds (B108 in ( B107 -roots_of_1 ) iff B108 is (CRoot of B107 , ( 1_ ( F_Complex ) )))))
proof
let C101 being non  empty (Element of ( NAT ));
let C102 being (Element of ( F_Complex ));
thus L349:now
assume L350: C102 in ( C101 -roots_of_1 );
L351: (ex B109 being (Element of ( F_Complex )) st (B109 = C102 & B109 is (CRoot of C101 , ( 1_ ( F_Complex ) )))) by L350;
thus L352: C102 is (CRoot of C101 , ( 1_ ( F_Complex ) )) by L351;
end;
thus L353: thesis;
end;
theorem
L354: (for B110 being non  empty (Element of ( NAT )) holds ( 1_ ( F_Complex ) ) in ( B110 -roots_of_1 ))
proof
let C103 being non  empty (Element of ( NAT ));
L355: ( 1_ ( F_Complex ) ) = ( ( power ( F_Complex ) ) . (( 1_ ( F_Complex ) ) , C103) ) by L194;
L356: ( 1_ ( F_Complex ) ) is (CRoot of C103 , ( 1_ ( F_Complex ) )) by L355 , COMPLFLD:def 2;
thus L357: thesis by L356;
end;
theorem
L358: (for B111 being non  empty (Element of ( NAT )) holds (for B112 being (Element of ( F_Complex )) holds (B112 in ( B111 -roots_of_1 ) implies |. B112 .| = 1)))
proof
let C104 being non  empty (Element of ( NAT ));
let C105 being (Element of ( F_Complex ));
assume that
L359: C105 in ( C104 -roots_of_1 );
L360:
now
assume L361: C105 = ( 0. ( F_Complex ) );
L362: ( ( power ( F_Complex ) ) . (C105 , C104) ) <> ( 1_ ( F_Complex ) ) by L361 , VECTSP_1:36;
L363: (not C105 is (CRoot of C104 , ( 1_ ( F_Complex ) ))) by L362 , COMPLFLD:def 2;
thus L364: contradiction by L363 , L359 , L348;
end;
L365: |. C105 .| > ( 0 ) by L360 , COMPLFLD:59;
L366: C105 is (CRoot of C104 , ( 1_ ( F_Complex ) )) by L359 , L348;
L367: ( ( power ( F_Complex ) ) . (C105 , C104) ) = ( 1_ ( F_Complex ) ) by L366 , COMPLFLD:def 2;
L368: 1 = ( |. C105 .| to_power C104 ) by L367 , L360 , COMPLFLD:60 , POLYNOM5:7;
assume L369: |. C105 .| <> 1;
per cases  by L369 , XXREAL_0:1;
suppose L370: |. C105 .| < 1;

reconsider D56 = C104 as Rational;
L371: ( |. C105 .| #Q D56 ) < 1 by L365 , L370 , PREPOWER:65;
thus L372: contradiction by L371 , L368 , L365 , PREPOWER:49;
end;
suppose L373: |. C105 .| > 1;

thus L374: contradiction by L373 , L368 , POWER:35;
end;
end;
theorem
L376: (for B113 being non  empty (Element of ( NAT )) holds (for B114 being (Element of ( F_Complex )) holds (B114 in ( B113 -roots_of_1 ) iff (ex B115 being (Element of ( NAT )) st B114 = [** ( cos ( ( ( 2 * ( PI ) ) * B115 ) / B113 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B115 ) / B113 ) ) **]))))
proof
let C106 being non  empty (Element of ( NAT ));
let C107 being (Element of ( F_Complex ));
thus L377:now
assume L378: C107 in ( C106 -roots_of_1 );
L379:
now
assume L380: C107 = ( 0. ( F_Complex ) );
L381: ( ( power ( F_Complex ) ) . (C107 , C106) ) <> ( 1_ ( F_Complex ) ) by L380 , VECTSP_1:36;
L382: (not C107 is (CRoot of C106 , ( 1_ ( F_Complex ) ))) by L381 , COMPLFLD:def 2;
thus L383: contradiction by L382 , L378 , L348;
end;
L384: (( 0 ) <= ( Arg C107 ) & ( Arg C107 ) < ( 2 * ( PI ) )) by L379 , COMPLFLD:7 , COMPTRIG:def 1;
L385: ( ( 0 ) + ( - 1 ) ) <= ( ( ( C106 * ( Arg C107 ) ) / ( 2 * ( PI ) ) ) + ( - 1 ) ) by L384 , XREAL_1:7;
L386: C107 is (CRoot of C106 , ( 1_ ( F_Complex ) )) by L378 , L348;
L387: ( ( power ( F_Complex ) ) . (C107 , C106) ) = ( 1_ ( F_Complex ) ) by L386 , COMPLFLD:def 2;
L388: 1 = ( |. C107 .| to_power C106 ) by L387 , L379 , COMPLFLD:60 , POLYNOM5:7;
L389:
now
L390: |. C107 .| > ( 0 ) by L379 , COMPLFLD:59;
assume L391: |. C107 .| <> 1;
per cases  by L391 , XXREAL_0:1;
suppose L392: |. C107 .| < 1;

reconsider D57 = C106 as Rational;
L393: ( |. C107 .| #Q D57 ) < 1 by L390 , L392 , PREPOWER:65;
thus L394: contradiction by L393 , L388 , L390 , PREPOWER:49;
end;
suppose L395: |. C107 .| > 1;

thus L396: contradiction by L395 , L388 , POWER:35;
end;
end;
set D58 = [\ ( ( C106 * ( Arg C107 ) ) / ( 2 * ( PI ) ) ) /];
reconsider D59 = C107 as (Element of ( COMPLEX )) by XCMPLX_0:def 2;
consider C108 being  real number such that L398: C108 = ( ( ( 2 * ( PI ) ) * ( - [\ ( ( C106 * ( Arg C107 ) ) / ( 2 * ( PI ) ) ) /] ) ) + ( C106 * ( Arg C107 ) ) ) and L399: (( 0 ) <= C108 & C108 < ( 2 * ( PI ) )) by COMPLEX2:1 , COMPTRIG:5;
L400: ( ( ( C106 * ( Arg C107 ) ) / ( 2 * ( PI ) ) ) - 1 ) < D58 by INT_1:def 6;
L401: (not D58 <= ( - 1 )) by L400 , L385 , XXREAL_0:2;
L402: ( ( - 1 ) + 1 ) <= D58 by L401 , INT_1:7;
reconsider D60 = [\ ( ( C106 * ( Arg C107 ) ) / ( 2 * ( PI ) ) ) /] as (Element of ( NAT )) by L402 , INT_1:3;
L403: ( cos ( C106 * ( Arg C107 ) ) ) = ( ( cos ) . ( ( ( 2 * ( PI ) ) * D60 ) + C108 ) ) by L398 , SIN_COS:def 19
.= ( ( cos ) . C108 ) by SIN_COS2:11
.= ( cos C108 ) by SIN_COS:def 19;
L404: ( sin ( C106 * ( Arg C107 ) ) ) = ( ( sin ) . ( ( ( 2 * ( PI ) ) * D60 ) + C108 ) ) by L398 , SIN_COS:def 17
.= ( ( sin ) . C108 ) by SIN_COS2:10
.= ( sin C108 ) by SIN_COS:def 17;
L405: C107 is (CRoot of C106 , ( 1_ ( F_Complex ) )) by L378 , L348;
L406: ( ( power ( F_Complex ) ) . (C107 , C106) ) = [** 1 , ( 0 ) **] by L405 , COMPLFLD:8 , COMPLFLD:def 2;
L407: (( D59 |^ C106 ) = ( ( ( |. D59 .| |^ C106 ) * ( cos ( C106 * ( Arg D59 ) ) ) ) + ( ( ( |. D59 .| |^ C106 ) * ( sin ( C106 * ( Arg D59 ) ) ) ) * ( <i> ) ) ) & ( D59 |^ C106 ) = [** 1 , ( 0 ) **]) by L406 , COMPLFLD:74 , COMPTRIG:54;
L408: ( sin ( C106 * ( Arg C107 ) ) ) = ( 0 ) by L407 , L388 , COMPLEX1:77;
L409: (C108 = ( 0 ) or C108 = ( PI )) by L408 , L399 , L404 , COMPTRIG:17;
L410: ( ( C106 * ( Arg C107 ) ) / ( C106 * 1 ) ) = ( ( ( 2 * ( PI ) ) * D60 ) / C106 ) by L409 , L388 , L407 , L398 , L403 , COMPLEX1:77 , SIN_COS:77;
L411: ( ( ( C106 / C106 ) * ( Arg C107 ) ) / 1 ) = ( ( ( 2 * ( PI ) ) * D60 ) / C106 ) by L410 , XCMPLX_1:83;
L412: ( ( Arg C107 ) / 1 ) = ( ( ( 2 * ( PI ) ) * D60 ) / C106 ) by L411 , XCMPLX_1:88;
L413: C107 = [** ( |. C107 .| * ( cos ( Arg C107 ) ) ) , ( |. C107 .| * ( sin ( Arg C107 ) ) ) **] by L379 , COMPLFLD:7 , COMPTRIG:def 1;
thus L414: (ex B116 being (Element of ( NAT )) st C107 = [** ( cos ( ( ( 2 * ( PI ) ) * B116 ) / C106 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B116 ) / C106 ) ) **]) by L413 , L389 , L412;
end;
L415:
now
reconsider D61 = ( 1_ ( F_Complex ) ) as (Element of ( COMPLEX )) by XCMPLX_0:def 2;
set D62 = ( Arg ( 1_ ( F_Complex ) ) );
given C109 being (Element of ( NAT )) such that
L416: C107 = [** ( cos ( ( ( 2 * ( PI ) ) * C109 ) / C106 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C109 ) / C106 ) ) **];

L417: ( ( 0 ) + 1 ) <= C106 by NAT_1:13;
L418: ( C106 -root 1 ) = 1 by L417 , POWER:6;
L419: C107 = ( ( ( C106 -root |. D61 .| ) * ( cos ( ( D62 + ( ( 2 * ( PI ) ) * C109 ) ) / C106 ) ) ) + ( ( ( C106 -root |. D61 .| ) * ( sin ( ( D62 + ( ( 2 * ( PI ) ) * C109 ) ) / C106 ) ) ) * ( <i> ) ) ) by L418 , L416 , COMPLFLD:8 , COMPLFLD:60 , COMPTRIG:39;
L420: C107 is (CRoot of C106 , D61) by L419 , COMPTRIG:57;
thus L421: C107 in ( C106 -roots_of_1 ) by L420;
end;
thus L422: thesis by L415;
end;
theorem
L423: (for B117 being non  empty (Element of ( NAT )) holds (for B118 , B119 being (Element of ( COMPLEX )) holds ((B118 in ( B117 -roots_of_1 ) & B119 in ( B117 -roots_of_1 )) implies ( B118 * B119 ) in ( B117 -roots_of_1 ))))
proof
let C110 being non  empty (Element of ( NAT ));
let C111 , C112 being (Element of ( COMPLEX ));
assume that
L424: C111 in ( C110 -roots_of_1 )
and
L425: C112 in ( C110 -roots_of_1 );
reconsider D63 = C111 as (Element of ( F_Complex )) by COMPLFLD:def 1;
consider C113 being (Element of ( NAT )) such that L426: D63 = [** ( cos ( ( ( 2 * ( PI ) ) * C113 ) / C110 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C113 ) / C110 ) ) **] by L424 , L376;
reconsider D64 = C112 as (Element of ( F_Complex )) by COMPLFLD:def 1;
consider C114 being (Element of ( NAT )) such that L427: D64 = [** ( cos ( ( ( 2 * ( PI ) ) * C114 ) / C110 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C114 ) / C110 ) ) **] by L425 , L376;
L428: ( D63 * D64 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( C113 + C114 ) mod C110 ) ) / C110 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( ( C113 + C114 ) mod C110 ) ) / C110 ) ) **] by L426 , L427 , L212;
thus L429: thesis by L428 , L376;
end;
theorem
L430: (for B120 being non  empty (Element of ( NAT )) holds ( B120 -roots_of_1 ) = { [** ( cos ( ( ( 2 * ( PI ) ) * B121 ) / B120 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B121 ) / B120 ) ) **] where B121 is (Element of ( NAT )) : B121 < B120 })
proof
let C115 being non  empty (Element of ( NAT ));
set D65 = { [** ( cos ( ( ( 2 * ( PI ) ) * B122 ) / C115 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B122 ) / C115 ) ) **] where B122 is (Element of ( NAT )) : B122 < C115 };
L431:
now
let C116 being set;
thus L432:now
assume L433: C116 in ( C115 -roots_of_1 );
reconsider D66 = C116 as (Element of ( F_Complex )) by L433;
consider C117 being (Element of ( NAT )) such that L434: D66 = [** ( cos ( ( ( 2 * ( PI ) ) * C117 ) / C115 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C117 ) / C115 ) ) **] by L433 , L376;
L435: ( C117 mod C115 ) < C115 by NAT_D:1;
L436: D66 = [** ( cos ( ( ( 2 * ( PI ) ) * ( C117 mod C115 ) ) / C115 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( C117 mod C115 ) ) / C115 ) ) **] by L434 , L209;
thus L437: C116 in D65 by L436 , L435;
end;
assume L438: C116 in D65;
L439: (ex B123 being (Element of ( NAT )) st (C116 = [** ( cos ( ( ( 2 * ( PI ) ) * B123 ) / C115 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B123 ) / C115 ) ) **] & B123 < C115)) by L438;
thus L440: C116 in ( C115 -roots_of_1 ) by L439 , L376;
end;
thus L441: thesis by L431 , TARSKI:1;
end;
theorem
L442: (for B124 being non  empty (Element of ( NAT )) holds ( card ( B124 -roots_of_1 ) ) = B124)
proof
let C118 being non  empty (Element of ( NAT ));
set D67 = { [** ( cos ( ( ( 2 * ( PI ) ) * B125 ) / C118 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B125 ) / C118 ) ) **] where B125 is (Element of ( NAT )) : B125 < C118 };
defpred S9[ set , set ] means (ex B126 being (Element of ( NAT )) st (B126 = $1 & $2 = [** ( cos ( ( ( 2 * ( PI ) ) * ( B126 -' 1 ) ) / C118 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( B126 -' 1 ) ) / C118 ) ) **]));
L443: D67 = ( C118 -roots_of_1 ) by L430;
L444: [** ( cos ( ( ( 2 * ( PI ) ) * (( 0 ) qua Nat) ) / C118 ) ) , ( sin ( ( ( 2 * ( PI ) ) * (( 0 ) qua Nat) ) / C118 ) ) **] in D67;
reconsider D68 = D67 as non  empty set by L444;
L445: (for B127 being set holds (B127 in ( Seg C118 ) implies (ex B128 being set st (B128 in D68 & S9[ B127 , B128 ]))))
proof
let C119 being set;
assume that
L446: C119 in ( Seg C118 );
reconsider D69 = C119 as (Element of ( NAT )) by L446;
L447: D69 <= C118 by L446 , FINSEQ_1:1;
L448: D69 < ( C118 + 1 ) by L447 , NAT_1:13;
L449: ( D69 - 1 ) < ( ( C118 + 1 ) - 1 ) by L448 , XREAL_1:14;
consider C120 being (Element of ( NAT )) such that L450: C120 = ( D69 -' 1 );
L451: 1 <= D69 by L446 , FINSEQ_1:1;
L452: ( D69 -' 1 ) < C118 by L451 , L449 , XREAL_1:233;
L453: [** ( cos ( ( ( 2 * ( PI ) ) * C120 ) / C118 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C120 ) / C118 ) ) **] in D67 by L452 , L450;
thus L454: thesis by L453 , L450;
end;
consider C121 being (Function of ( Seg C118 ) , D68) such that L455: (for B129 being set holds (B129 in ( Seg C118 ) implies S9[ B129 , ( C121 . B129 ) ])) from FUNCT_2:sch 1(L445);
L456: (for B130 being set holds (B130 in D67 implies (ex B131 being set st (B131 in ( Seg C118 ) & B130 = ( C121 . B131 )))))
proof
let C122 being set;
assume L457: C122 in D67;
consider C123 being (Element of ( NAT )) such that L458: C122 = [** ( cos ( ( ( 2 * ( PI ) ) * C123 ) / C118 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C123 ) / C118 ) ) **] and L459: C123 < C118 by L457;
L460: ( ( C123 + 1 ) -' 1 ) = C123 by NAT_D:34;
L461: (( ( 0 ) + 1 ) <= ( C123 + 1 ) & ( C123 + 1 ) <= C118) by L459 , INT_1:7;
L462: ( C123 + 1 ) in ( Seg C118 ) by L461 , FINSEQ_1:1;
L463: (ex B132 being (Element of ( NAT )) st (B132 = ( C123 + 1 ) & ( C121 . ( C123 + 1 ) ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( B132 -' 1 ) ) / C118 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( B132 -' 1 ) ) / C118 ) ) **])) by L462 , L455;
thus L464: thesis by L463 , L458 , L462 , L460;
end;
L465: ( rng C121 ) = D67 by L456 , FUNCT_2:10;
L466: ( dom C121 ) = ( Seg C118 ) by FUNCT_2:def 1;
L467: (for B133 , B134 being set holds ((B133 in ( dom C121 ) & B134 in ( dom C121 ) & ( C121 . B133 ) = ( C121 . B134 )) implies B133 = B134))
proof
let C124 , C125 being set;
assume that
L468: C124 in ( dom C121 )
and
L469: C125 in ( dom C121 )
and
L470: ( C121 . C124 ) = ( C121 . C125 );
L471: C124 in ( Seg C118 ) by L468 , FUNCT_2:def 1;
consider C126 being (Element of ( NAT )) such that L472: C126 = C124 and L473: ( C121 . C124 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( C126 -' 1 ) ) / C118 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( C126 -' 1 ) ) / C118 ) ) **] by L471 , L455;
set D70 = ( ( ( 2 * ( PI ) ) * ( C126 -' 1 ) ) / C118 );
L474: 1 <= C126 by L471 , L472 , FINSEQ_1:1;
L475: C126 <= C118 by L471 , L472 , FINSEQ_1:1;
L476: ( C126 - 1 ) < C118 by L475 , XREAL_1:146 , XXREAL_0:2;
L477: ( C126 -' 1 ) < C118 by L476 , L474 , XREAL_1:233;
L478: ( ( C126 -' 1 ) / C118 ) < ( C118 / C118 ) by L477 , XREAL_1:74;
L479: ( ( C126 -' 1 ) / C118 ) < 1 by L478 , XCMPLX_1:60;
L480: ( ( ( C126 -' 1 ) / C118 ) * ( 2 * ( PI ) ) ) < ( 1 * ( 2 * ( PI ) ) ) by L479 , COMPTRIG:5 , XREAL_1:68;
L481: D70 < ( 2 * ( PI ) ) by L480 , XCMPLX_1:74;
L482: C125 in ( Seg C118 ) by L469 , FUNCT_2:def 1;
consider C127 being (Element of ( NAT )) such that L483: C127 = C125 and L484: ( C121 . C125 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( C127 -' 1 ) ) / C118 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( C127 -' 1 ) ) / C118 ) ) **] by L482 , L455;
set D71 = ( ( ( 2 * ( PI ) ) * ( C127 -' 1 ) ) / C118 );
L485: 1 <= C127 by L482 , L483 , FINSEQ_1:1;
L486: C127 <= C118 by L482 , L483 , FINSEQ_1:1;
L487: ( C127 - 1 ) < C118 by L486 , XREAL_1:146 , XXREAL_0:2;
L488: ( C127 -' 1 ) < C118 by L487 , L485 , XREAL_1:233;
L489: ( ( C127 -' 1 ) / C118 ) < ( C118 / C118 ) by L488 , XREAL_1:74;
L490: ( ( C127 -' 1 ) / C118 ) < 1 by L489 , XCMPLX_1:60;
L491: ( ( ( C127 -' 1 ) / C118 ) * ( 2 * ( PI ) ) ) < ( 1 * ( 2 * ( PI ) ) ) by L490 , COMPTRIG:5 , XREAL_1:68;
L492: D71 < ( 2 * ( PI ) ) by L491 , XCMPLX_1:74;
L493: ( cos ( ( ( 2 * ( PI ) ) * ( C126 -' 1 ) ) / C118 ) ) = ( cos ( ( ( 2 * ( PI ) ) * ( C127 -' 1 ) ) / C118 ) ) by L470 , L473 , L484 , COMPLEX1:77;
L494: D70 = D71 by L493 , L470 , L473 , L484 , L481 , L492 , COMPLEX2:11 , COMPTRIG:5;
L495: ( ( ( ( 2 * ( PI ) ) * ( C126 -' 1 ) ) / C118 ) * C118 ) = ( ( 2 * ( PI ) ) * ( C127 -' 1 ) ) by L494 , XCMPLX_1:87;
L496: ( C126 -' 1 ) = ( C127 -' 1 ) by L495 , COMPTRIG:5 , XCMPLX_1:5 , XCMPLX_1:87;
L497: C126 = ( ( C127 -' 1 ) + 1 ) by L496 , L474 , XREAL_1:235;
thus L498: thesis by L497 , L472 , L483 , L485 , XREAL_1:235;
end;
L499: C121 is  one-to-one by L467 , FUNCT_1:def 4;
L500: ( Seg C118 ) , ( C121 .: ( Seg C118 ) ) are_equipotent  by L499 , L466 , CARD_1:33;
L501: ( Seg C118 ) , ( rng C121 ) are_equipotent  by L500 , L466 , RELAT_1:113;
L502: ( card ( Seg C118 ) ) = ( card D67 ) by L501 , L465 , CARD_1:5;
thus L503: thesis by L502 , L443 , FINSEQ_1:57;
end;
registration
let C128 being non  empty (Element of ( NAT ));
cluster ( C128 -roots_of_1 ) -> non  empty;
correctness by L354;
cluster ( C128 -roots_of_1 ) ->  finite;
correctness
proof
L504: ( card ( C128 -roots_of_1 ) ) = C128 by L442;
thus L505: thesis by L504;
end;
end;
theorem
L507: (for B135 , B136 being non  empty (Element of ( NAT )) holds (B136 divides B135 implies ( B136 -roots_of_1 ) c= ( B135 -roots_of_1 )))
proof
let C129 , C130 being non  empty (Element of ( NAT ));
assume L508: C130 divides C129;
consider C131 being Nat such that L509: C129 = ( C130 * C131 ) by L508 , NAT_D:def 3;
reconsider D72 = C131 as (Element of ( NAT )) by ORDINAL1:def 12;
L510: (for B137 being set holds (B137 in ( C130 -roots_of_1 ) implies B137 in ( C129 -roots_of_1 )))
proof
let C132 being set;
assume that
L511: C132 in ( C130 -roots_of_1 );
reconsider D73 = C132 as (Element of ( F_Complex )) by L511;
L512: D73 is (CRoot of C130 , ( 1_ ( F_Complex ) )) by L511 , L348;
L513: ( 1_ ( F_Complex ) ) = ( ( power ( F_Complex ) ) . (D73 , C130) ) by L512 , COMPLFLD:def 2;
L514: ( 1_ ( F_Complex ) ) = ( ( power ( F_Complex ) ) . (( ( power ( F_Complex ) ) . (D73 , C130) ) , D72) ) by L513 , L194;
L515: ( 1_ ( F_Complex ) ) = ( ( power ( F_Complex ) ) . (D73 , C129) ) by L514 , L509 , L217;
L516: D73 is (CRoot of C129 , ( 1_ ( F_Complex ) )) by L515 , COMPLFLD:def 2;
thus L517: thesis by L516;
end;
thus L518: thesis by L510 , TARSKI:def 3;
end;
theorem
L519: (for B138 being Skew-Field holds (for B139 being (Element of ( MultGroup B138 )) holds (for B140 being (Element of B138) holds (B140 = B139 implies (for B141 being (Element of ( NAT )) holds ( ( power ( MultGroup B138 ) ) . (B139 , B141) ) = ( ( power B138 ) . (B140 , B141) ))))))
proof
let C133 being Skew-Field;
let C134 being (Element of ( MultGroup C133 ));
let C135 being (Element of C133);
assume that
L520: C135 = C134;
defpred S10[ (Element of ( NAT )) ] means ( ( power ( MultGroup C133 ) ) . (C134 , $1) ) = ( ( power C133 ) . (C135 , $1) );
L521: (for B142 being (Element of ( NAT )) holds (S10[ B142 ] implies S10[ ( B142 + 1 ) ]))
proof
let C136 being (Element of ( NAT ));
assume that
L522: S10[ C136 ];
thus L523: ( ( power ( MultGroup C133 ) ) . (C134 , ( C136 + 1 )) ) = ( ( ( power ( MultGroup C133 ) ) . (C134 , C136) ) * C134 ) by GROUP_1:def 7
.= ( ( ( power C133 ) . (C135 , C136) ) * C135 ) by L520 , L522 , L314
.= ( ( power C133 ) . (C135 , ( C136 + 1 )) ) by GROUP_1:def 7;
end;
L524: (( ( power ( MultGroup C133 ) ) . (C134 , ( 0 )) ) = ( 1_ ( MultGroup C133 ) ) & ( ( power C133 ) . (C135 , ( 0 )) ) = ( 1_ C133 )) by GROUP_1:def 7;
L525: S10[ ( 0 ) ] by L524 , L318;
thus L526: (for B143 being (Element of ( NAT )) holds S10[ B143 ]) from NAT_1:sch 1(L525 , L521);
end;
theorem
L527: (for B144 being non  empty (Element of ( NAT )) holds (for B145 being (Element of ( MultGroup ( F_Complex ) )) holds (B145 in ( B144 -roots_of_1 ) implies (not B145 is  being_of_order_0))))
proof
set D74 = ( MultGroup ( F_Complex ) );
set D75 = (the carrier of ( MultGroup ( F_Complex ) ));
set D76 = ( F_Complex );
let C137 being non  empty (Element of ( NAT ));
let C138 being (Element of D75);
assume L528: C138 in ( C137 -roots_of_1 );
consider C139 being (Element of D76) such that L529: C139 = C138 and L530: C139 is (CRoot of C137 , ( 1_ D76 )) by L528;
L531: ( 1_ D74 ) = ( 1_ D76 ) by L318;
L532: ( ( power D76 ) . (C139 , C137) ) = ( 1_ D76 ) by L530 , COMPLFLD:def 2;
L533: ( C138 |^ C137 ) = ( 1_ D74 ) by L532 , L529 , L531 , L519;
thus L534: thesis by L533 , GROUP_1:def 10;
end;
theorem
L535: (for B146 being non  empty (Element of ( NAT )) holds (for B147 being (Element of ( NAT )) holds (for B148 being (Element of ( MultGroup ( F_Complex ) )) holds (B148 = [** ( cos ( ( ( 2 * ( PI ) ) * B147 ) / B146 ) ) , ( sin ( ( ( 2 * ( PI ) ) * B147 ) / B146 ) ) **] implies ( ord B148 ) = ( B146 div ( B147 gcd B146 ) )))))
proof
let C140 being non  empty (Element of ( NAT ));
let C141 being (Element of ( NAT ));
reconsider D77 = ( C141 gcd C140 ) as (Element of ( NAT ));
L536: ( C141 gcd C140 ) divides C140 by INT_2:21;
consider C142 being Nat such that L537: C140 = ( D77 * C142 ) by L536 , NAT_D:def 3;
L538: ( C141 gcd C140 ) divides C141 by INT_2:21;
consider C143 being Nat such that L539: C141 = ( D77 * C143 ) by L538 , NAT_D:def 3;
let C144 being (Element of ( MultGroup ( F_Complex ) ));
assume that
L540: C144 = [** ( cos ( ( ( 2 * ( PI ) ) * C141 ) / C140 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C141 ) / C140 ) ) **];
L541: C144 in ( C140 -roots_of_1 ) by L540 , L376;
L542: (not C144 is  being_of_order_0) by L541 , L527;
L543: ( C140 gcd C141 ) > ( 0 ) by NEWTON:58;
L544:
now
assume L545: ( C140 div D77 ) = ( 0 );
L546: C140 = ( ( D77 * (( 0 ) qua Nat) ) + ( C140 mod D77 ) ) by L545 , NAT_D:2 , NEWTON:58;
thus L547: contradiction by L546 , L536 , L543 , NAT_D:1 , NAT_D:7;
end;
reconsider D78 = C144 as (Element of ( F_Complex )) by L334;
reconsider D79 = C142 as (Element of ( NAT )) by ORDINAL1:def 12;
L548: (not D79 is  empty) by L537;
L549: C140 = ( ( D77 * D79 ) + ( 0 ) ) by L537;
L550: ( C140 div D77 ) = D79 by L549 , L543 , NAT_D:def 1;
L551: (for B149 being Nat holds ((( C144 |^ B149 ) = ( 1_ ( MultGroup ( F_Complex ) ) ) & B149 <> ( 0 )) implies ( C140 div D77 ) <= B149))
proof
let C145 being Nat;
assume that
L552: ( C144 |^ C145 ) = ( 1_ ( MultGroup ( F_Complex ) ) )
and
L553: C145 <> ( 0 );
reconsider D80 = C145 as (Element of ( NAT )) by ORDINAL1:def 12;
L554:
now
assume L555: D80 < D79;
L556:
now
assume L557: ( ( C141 * D80 ) mod C140 ) = ( 0 );
L558: C140 divides ( C141 * D80 ) by L557 , PEPIN:6;
consider C146 being Nat such that L559: ( C141 * D80 ) = ( C140 * C146 ) by L558 , NAT_D:def 3;
consider C147 , C148 being Integer such that L560: C141 = ( D77 * C147 ) and L561: C140 = ( D77 * C148 ) and L562: C147 , C148 are_relative_prime  by INT_2:23;
L563: ( 0 ) <= C147 by L543 , L560;
reconsider D81 = C147 as (Element of ( NAT )) by L563 , INT_1:3;
L564: ( 0 ) <= C148 by L561;
reconsider D82 = C148 as (Element of ( NAT )) by L564 , INT_1:3;
L565: ( ( D80 * C147 ) * D77 ) = ( C146 * ( C148 * D77 ) ) by L560 , L561 , L559;
L566: ( D80 * C147 ) = ( ( ( C146 * C148 ) * D77 ) / D77 ) by L565 , L543 , XCMPLX_1:89;
L567: ( D80 * C147 ) = ( C146 * C148 ) by L566 , L543 , XCMPLX_1:89;
L568: D82 divides ( D80 * D81 ) by L567 , NAT_D:def 3;
L569: D80 < D82 by L543 , L550 , L555 , L561 , NAT_D:18;
thus L570: contradiction by L569 , L553 , L562 , L568 , INT_2:25 , NAT_D:7;
end;
L571: ( ( ( ( 2 * ( PI ) ) * C141 ) / C140 ) * D80 ) = ( ( ( 2 * ( PI ) ) * C141 ) / ( C140 / D80 ) ) by XCMPLX_1:82
.= ( ( ( ( 2 * ( PI ) ) * C141 ) * D80 ) / C140 ) by XCMPLX_1:77;
L572: ( ( 2 * ( PI ) ) * ( ( C141 * D80 ) mod C140 ) ) < ( ( 2 * ( PI ) ) * C140 ) by COMPTRIG:5 , NAT_D:1 , XREAL_1:68;
L573: ( ( ( 2 * ( PI ) ) * ( ( C141 * D80 ) mod C140 ) ) / C140 ) < ( ( ( 2 * ( PI ) ) * C140 ) / C140 ) by L572 , XREAL_1:74;
L574: ( ( ( 2 * ( PI ) ) * ( ( C141 * D80 ) mod C140 ) ) / C140 ) < ( 2 * ( PI ) ) by L573 , XCMPLX_1:89;
L575: ( 1_ ( MultGroup ( F_Complex ) ) ) = [** 1 , ( 0 ) **] by L318 , COMPLFLD:8;
L576: ( C144 |^ D80 ) = ( ( power ( F_Complex ) ) . (D78 , D80) ) by L519
.= ( D78 |^ D80 ) by L553 , COMPLFLD:74
.= [** ( cos ( ( ( 2 * ( PI ) ) * ( C141 * D80 ) ) / C140 ) ) , ( sin ( ( ( ( 2 * ( PI ) ) * C141 ) * D80 ) / C140 ) ) **] by L540 , L571 , COMPTRIG:53
.= [** ( cos ( ( ( 2 * ( PI ) ) * ( ( C141 * D80 ) mod C140 ) ) / C140 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( ( C141 * D80 ) mod C140 ) ) / C140 ) ) **] by L209;
L577: ( cos ( ( ( 2 * ( PI ) ) * ( ( C141 * D80 ) mod C140 ) ) / C140 ) ) = 1 by L576 , L552 , L575 , COMPLEX1:77;
thus L578: contradiction by L577 , L556 , L574 , COMPTRIG:5 , COMPTRIG:61;
end;
thus L579: thesis by L554 , L543 , L549 , NAT_D:def 1;
end;
reconsider D83 = C143 as (Element of ( NAT )) by ORDINAL1:def 12;
L580: ( ( ( ( 2 * ( PI ) ) * C141 ) / C140 ) * D79 ) = ( ( ( 2 * ( PI ) ) * ( D77 * D83 ) ) / ( C140 / D79 ) ) by L539 , XCMPLX_1:82
.= ( ( ( ( 2 * ( PI ) ) * ( D77 * D83 ) ) * D79 ) / C140 ) by XCMPLX_1:77
.= ( ( ( ( 2 * ( PI ) ) * D83 ) * C140 ) / C140 ) by L537
.= ( ( ( 2 * ( PI ) ) * D83 ) + ( 0 ) ) by XCMPLX_1:89;
L581: ( C144 |^ ( C140 div D77 ) ) = ( ( power ( F_Complex ) ) . (D78 , D79) ) by L550 , L519
.= ( D78 |^ D79 ) by L548 , COMPLFLD:74
.= [** ( cos ( ( ( ( 2 * ( PI ) ) * C141 ) / C140 ) * D79 ) ) , ( sin ( ( ( ( 2 * ( PI ) ) * C141 ) / C140 ) * D79 ) ) **] by L540 , COMPTRIG:53
.= [** ( cos ( 0 ) ) , ( sin ( ( ( 2 * ( PI ) ) * D83 ) + ( 0 ) ) ) **] by L580 , COMPLEX2:9
.= ( 1 + ( ( 0 ) * ( <i> ) ) ) by COMPLEX2:8 , SIN_COS:31
.= ( 1_ ( MultGroup ( F_Complex ) ) ) by L318 , COMPLFLD:8;
thus L582: thesis by L581 , L544 , L542 , L551 , GROUP_1:def 11;
end;
theorem
L583: (for B150 being non  empty (Element of ( NAT )) holds ( B150 -roots_of_1 ) c= (the carrier of ( MultGroup ( F_Complex ) )))
proof
let C149 being non  empty (Element of ( NAT ));
set D84 = (the carrier of ( MultGroup ( F_Complex ) ));
set D85 = ( F_Complex );
let C150 being set;
assume L584: C150 in ( C149 -roots_of_1 );
consider C151 being (Element of ( F_Complex )) such that L585: C150 = C151 and L586: C151 is (CRoot of C149 , ( 1_ ( F_Complex ) )) by L584;
L587: ( ( power D85 ) . (C151 , C149) ) = ( 1_ D85 ) by L586 , COMPLFLD:def 2;
L588: C151 <> ( 0. D85 ) by L587 , VECTSP_1:36;
L589: (not C151 in { ( 0. D85 ) }) by L588 , TARSKI:def 1;
L590: D84 = ( NonZero D85 ) by L267;
thus L591: thesis by L590 , L585 , L589 , XBOOLE_0:def 5;
end;
theorem
L592: (for B151 being non  empty (Element of ( NAT )) holds (ex B152 being (Element of ( MultGroup ( F_Complex ) )) st ( ord B152 ) = B151))
proof
let C152 being non  empty (Element of ( NAT ));
set D86 = [** ( cos ( ( ( 2 * ( PI ) ) * 1 ) / C152 ) ) , ( sin ( ( ( 2 * ( PI ) ) * 1 ) / C152 ) ) **];
L593: (( C152 -roots_of_1 ) c= (the carrier of ( MultGroup ( F_Complex ) )) & D86 in ( C152 -roots_of_1 )) by L376 , L583;
reconsider D87 = D86 as (Element of ( MultGroup ( F_Complex ) )) by L593;
L594: (( ord D87 ) = ( C152 div ( 1 gcd C152 ) ) & ( 1 gcd C152 ) = 1) by L535 , WSIERP_1:8;
thus L595: thesis by L594 , NAT_2:4;
end;
theorem
L596: (for B153 being non  empty (Element of ( NAT )) holds (for B154 being (Element of ( MultGroup ( F_Complex ) )) holds (( ord B154 ) divides B153 iff B154 in ( B153 -roots_of_1 ))))
proof
set D88 = ( F_Complex );
let C153 being non  empty (Element of ( NAT ));
let C154 being (Element of ( MultGroup ( F_Complex ) ));
reconsider D89 = C154 as (Element of D88) by L334;
set D90 = ( MultGroup ( F_Complex ) );
L597: ( 1_ D90 ) = ( 1_ D88 ) by L318;
thus L598:now
assume L599: ( ord C154 ) divides C153;
consider C155 being Nat such that L600: C153 = ( ( ord C154 ) * C155 ) by L599 , NAT_D:def 3;
L601: ( C154 |^ ( ord C154 ) ) = ( 1_ D90 ) by GROUP_1:41;
L602: ( ( C154 |^ ( ord C154 ) ) |^ C155 ) = ( 1_ D90 ) by L601 , GROUP_1:31;
L603: ( C154 |^ C153 ) = ( 1_ D90 ) by L602 , L600 , GROUP_1:35;
L604: ( ( power D88 ) . (D89 , C153) ) = ( 1_ D88 ) by L603 , L597 , L519;
L605: D89 is (CRoot of C153 , ( 1_ D88 )) by L604 , COMPLFLD:def 2;
thus L606: C154 in ( C153 -roots_of_1 ) by L605;
end;
assume L607: C154 in ( C153 -roots_of_1 );
consider C156 being (Element of D88) such that L608: C156 = C154 and L609: C156 is (CRoot of C153 , ( 1_ D88 )) by L607;
L610: ( ( power D88 ) . (C156 , C153) ) = ( 1_ D88 ) by L609 , COMPLFLD:def 2;
L611: ( C154 |^ C153 ) = ( 1_ D90 ) by L610 , L597 , L608 , L519;
thus L612: thesis by L611 , GROUP_1:44;
end;
theorem
L613: (for B155 being non  empty (Element of ( NAT )) holds ( B155 -roots_of_1 ) = { B156 where B156 is (Element of ( MultGroup ( F_Complex ) )) : ( ord B156 ) divides B155 })
proof
set D91 = (the carrier of ( MultGroup ( F_Complex ) ));
set D92 = ( MultGroup ( F_Complex ) );
let C157 being non  empty (Element of ( NAT ));
set D93 = { B157 where B157 is (Element of ( F_Complex )) : B157 is (CRoot of C157 , ( 1_ ( F_Complex ) )) };
set D94 = { B158 where B158 is (Element of ( MultGroup ( F_Complex ) )) : ( ord B158 ) divides C157 };
L614: ( C157 -roots_of_1 ) = D93;
L615: D93 c= D91 by L614 , L583;
L616:
now
let C158 being set;
thus L617:now
assume L618: C158 in D93;
reconsider D95 = C158 as (Element of D92) by L618 , L615;
L619: ( ord D95 ) divides C157 by L614 , L618 , L596;
thus L620: C158 in D94 by L619;
end;
assume L621: C158 in D94;
L622: (ex B159 being (Element of D92) st (C158 = B159 & ( ord B159 ) divides C157)) by L621;
thus L623: C158 in D93 by L622 , L614 , L596;
end;
thus L624: thesis by L616 , TARSKI:1;
end;
theorem
L625: (for B160 being non  empty (Element of ( NAT )) holds (for B161 being set holds (B161 in ( B160 -roots_of_1 ) iff (ex B162 being (Element of ( MultGroup ( F_Complex ) )) st (B161 = B162 & ( ord B162 ) divides B160)))))
proof
set D96 = ( MultGroup ( F_Complex ) );
set D97 = (the carrier of ( MultGroup ( F_Complex ) ));
let C159 being non  empty (Element of ( NAT ));
let C160 being set;
L626: ( C159 -roots_of_1 ) c= D97 by L583;
thus L627:now
assume L628: C160 in ( C159 -roots_of_1 );
reconsider D98 = C160 as (Element of D96) by L628 , L626;
L629: ( ord D98 ) divides C159 by L628 , L596;
thus L630: (ex B163 being (Element of ( MultGroup ( F_Complex ) )) st (C160 = B163 & ( ord B163 ) divides C159)) by L629;
end;
thus L631: thesis by L596;
end;
definition
let C161 being non  empty (Element of ( NAT ));
func C161 -th_roots_of_1 ->  strict Group means 
:L632: ((the carrier of it) = ( C161 -roots_of_1 ) & (the multF of it) = ( (the multF of ( F_Complex )) || ( C161 -roots_of_1 ) ));
existence
proof
set D99 = [: ( C161 -roots_of_1 ) , ( C161 -roots_of_1 ) :];
set D100 = ( (the multF of ( F_Complex )) || ( C161 -roots_of_1 ) );
L633: ( C161 -roots_of_1 ) c= (the carrier of ( F_Complex ));
L634: ( C161 -roots_of_1 ) c= ( COMPLEX ) by L633 , COMPLFLD:def 1;
L635: D99 c= [: ( COMPLEX ) , ( COMPLEX ) :] by L634 , ZFMISC_1:96;
L636: D99 c= ( dom ( multcomplex ) ) by L635 , FUNCT_2:def 1;
L637: ( multcomplex ) = (the multF of ( F_Complex )) by COMPLFLD:def 1;
L638: ( dom D100 ) = ( ( dom ( multcomplex ) ) /\ D99 ) by L637 , RELAT_1:61;
L639: ( dom D100 ) = D99 by L638 , L636 , XBOOLE_1:28;
L640: (for B164 being set holds (B164 in D99 implies ( D100 . B164 ) in ( C161 -roots_of_1 )))
proof
let C162 being set;
assume that
L641: C162 in D99;
consider C163 , C164 being set such that L642: [ C163 , C164 ] = C162 by L641 , RELAT_1:def 1;
L643: C164 in ( C161 -roots_of_1 ) by L641 , L642 , ZFMISC_1:87;
L644: C163 in ( C161 -roots_of_1 ) by L641 , L642 , ZFMISC_1:87;
reconsider D101 = C164 as (Element of ( COMPLEX )) by L643 , COMPLFLD:def 1;
reconsider D102 = C163 as (Element of ( COMPLEX )) by L644 , COMPLFLD:def 1;
L645: (( ( multcomplex ) . (D102 , D101) ) = ( D102 * D101 ) & ( D100 . [ D102 , D101 ] ) = ( ( multcomplex ) . [ D102 , D101 ] )) by L637 , L639 , L641 , L642 , BINOP_2:def 5 , FUNCT_1:47;
thus L646: thesis by L645 , L642 , L644 , L643 , L423;
end;
reconsider D103 = D100 as (BinOp of ( C161 -roots_of_1 )) by L640 , L636 , L638 , FUNCT_2:3 , XBOOLE_1:28;
set D104 = multMagma (# ( C161 -roots_of_1 ) , D103 #);
reconsider D105 = ( 1_ ( F_Complex ) ) as (Element of D104) by L354;
L647: ( 1_ ( F_Complex ) ) = [** ( cos ( ( ( 2 * ( PI ) ) * (( 0 ) qua Nat) ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * (( 0 ) qua Nat) ) / C161 ) ) **] by COMPLFLD:8 , SIN_COS:31;
L648: (for B165 being (Element of D104) holds (( B165 * D105 ) = B165 & ( D105 * B165 ) = B165 & (ex B166 being (Element of D104) st (( B165 * B166 ) = ( 1_ ( F_Complex ) ) & ( B166 * B165 ) = ( 1_ ( F_Complex ) )))))
proof
let C165 being (Element of D104);
L649: (ex B167 being (Element of D104) st (( C165 * B167 ) = ( 1_ ( F_Complex ) ) & ( B167 * C165 ) = ( 1_ ( F_Complex ) )))
proof
L650: C165 in (the carrier of ( F_Complex )) by TARSKI:def 3;
consider C166 being (Element of ( NAT )) such that L651: C165 = [** ( cos ( ( ( 2 * ( PI ) ) * C166 ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C166 ) / C161 ) ) **] by L650 , L376;
reconsider D106 = [** ( cos ( ( ( 2 * ( PI ) ) * C166 ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C166 ) / C161 ) ) **] as (Element of ( F_Complex ));
L652: (ex B168 being (Element of ( NAT )) st ( ( C166 + B168 ) mod C161 ) = ( 0 ))
proof
set D107 = ( C166 mod C161 );
L653: D107 < C161 by NAT_D:1;
consider C167 being Nat such that L654: ( D107 + C167 ) = C161 by L653 , NAT_1:10;
L655: C166 = ( ( C161 * ( C166 div C161 ) ) + D107 ) by NAT_D:2;
L656: (C167 in ( NAT ) & ( ( C166 + C167 ) mod C161 ) = ( ( ( ( C166 div C161 ) + 1 ) * C161 ) mod C161 )) by L655 , L654 , ORDINAL1:def 12;
thus L657: thesis by L656 , NAT_D:13;
end;
consider C168 being (Element of ( NAT )) such that L658: ( ( C166 + C168 ) mod C161 ) = ( 0 ) by L652;
set D108 = [** ( cos ( ( ( 2 * ( PI ) ) * C168 ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C168 ) / C161 ) ) **];
reconsider D109 = D108 as (Element of D104) by L376;
reconsider D110 = D109 as (Element of ( F_Complex ));
L659: (( D110 * D106 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( C168 + C166 ) mod C161 ) ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( ( C168 + C166 ) mod C161 ) ) / C161 ) ) **] & [ D109 , C165 ] in ( dom D100 )) by L639 , L212 , ZFMISC_1:87;
L660: ( D109 * C165 ) = ( 1_ ( F_Complex ) ) by L659 , L651 , L658 , COMPLFLD:8 , FUNCT_1:47 , SIN_COS:31;
L661: (( D106 * D110 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( C168 + C166 ) mod C161 ) ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( ( C168 + C166 ) mod C161 ) ) / C161 ) ) **] & [ C165 , D109 ] in ( dom D100 )) by L639 , L212 , ZFMISC_1:87;
L662: ( C165 * D109 ) = ( 1_ ( F_Complex ) ) by L661 , L651 , L658 , COMPLFLD:8 , FUNCT_1:47 , SIN_COS:31;
thus L663: thesis by L662 , L660;
end;
L664: (( C165 * D105 ) = C165 & ( D105 * C165 ) = C165)
proof
L665: ([ C165 , D105 ] in ( dom D100 ) & [ D105 , C165 ] in ( dom D100 )) by L639 , ZFMISC_1:87;
reconsider D111 = C165 as (Element of ( F_Complex )) by TARSKI:def 3;
consider C169 being (Element of ( NAT )) such that L666: D111 = [** ( cos ( ( ( 2 * ( PI ) ) * C169 ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * C169 ) / C161 ) ) **] by L376;
L667: ( ( 1_ ( F_Complex ) ) * D111 ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( C169 + ( 0 ) ) mod C161 ) ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( ( C169 + ( 0 ) ) mod C161 ) ) / C161 ) ) **] by L647 , L666 , L212
.= C165 by L666 , L209;
L668: ( D111 * ( 1_ ( F_Complex ) ) ) = [** ( cos ( ( ( 2 * ( PI ) ) * ( ( C169 + ( 0 ) ) mod C161 ) ) / C161 ) ) , ( sin ( ( ( 2 * ( PI ) ) * ( ( C169 + ( 0 ) ) mod C161 ) ) / C161 ) ) **] by L647 , L666 , L212
.= C165 by L666 , L209;
thus L669: thesis by L668 , L667 , L665 , FUNCT_1:47;
end;
thus L670: thesis by L664 , L649;
end;
L671: ( rng D103 ) c= ( C161 -roots_of_1 ) by RELAT_1:def 19;
L672: (for B169 , B170 , B171 being (Element of D104) holds ( ( B169 * B170 ) * B171 ) = ( B169 * ( B170 * B171 ) ))
proof
set D112 = ( multcomplex );
let C170 , C171 , C172 being (Element of D104);
L673: C170 in (the carrier of ( F_Complex )) by TARSKI:def 3;
L674: C170 is (Element of ( COMPLEX )) by L673 , COMPLFLD:def 1;
L675: C171 in (the carrier of ( F_Complex )) by TARSKI:def 3;
L676: C171 is (Element of ( COMPLEX )) by L675 , COMPLFLD:def 1;
L677: [ C170 , C171 ] in ( dom D100 ) by L639 , ZFMISC_1:87;
L678: ( D100 . [ C170 , C171 ] ) in ( rng D100 ) by L677 , FUNCT_1:3;
L679: [ ( D100 . [ C170 , C171 ] ) , C172 ] in ( dom D100 ) by L678 , L639 , L671 , ZFMISC_1:87;
L680: [ C171 , C172 ] in ( dom D100 ) by L639 , ZFMISC_1:87;
L681: ( D100 . [ C171 , C172 ] ) in ( rng D100 ) by L680 , FUNCT_1:3;
L682: [ C170 , ( D100 . [ C171 , C172 ] ) ] in ( dom D100 ) by L681 , L639 , L671 , ZFMISC_1:87;
L683: ( D100 . [ C171 , C172 ] ) = ( D112 . [ C171 , C172 ] ) by L637 , L680 , FUNCT_1:47;
L684: ( D100 . [ C170 , ( D100 . [ C171 , C172 ] ) ] ) = ( D112 . (C170 , ( D112 . (C171 , C172) )) ) by L683 , L637 , L682 , FUNCT_1:47;
L685: C172 in (the carrier of ( F_Complex )) by TARSKI:def 3;
L686: C172 is (Element of ( COMPLEX )) by L685 , COMPLFLD:def 1;
L687: ( D100 . [ C170 , C171 ] ) = ( D112 . [ C170 , C171 ] ) by L637 , L677 , FUNCT_1:47;
L688: ( D100 . [ ( D100 . [ C170 , C171 ] ) , C172 ] ) = ( D112 . (( D112 . (C170 , C171) ) , C172) ) by L687 , L637 , L679 , FUNCT_1:47;
thus L689: thesis by L688 , L674 , L676 , L686 , L684 , BINOP_1:def 3;
end;
L690: D104 is Group by L672 , L648 , GROUP_1:1;
thus L691: thesis by L690;
end;
uniqueness;
end;
theorem
L693: (for B172 being non  empty (Element of ( NAT )) holds ( B172 -th_roots_of_1 ) is (Subgroup of ( MultGroup ( F_Complex ) )))
proof
set D113 = ( MultGroup ( F_Complex ) );
set D114 = (the carrier of ( MultGroup ( F_Complex ) ));
set D115 = ( F_Complex );
let C173 being non  empty (Element of ( NAT ));
set D116 = ( C173 -th_roots_of_1 );
set D117 = (the carrier of D116);
L694: (the carrier of D116) = ( C173 -roots_of_1 ) by L632;
L695: (the carrier of D116) c= (the carrier of D113) by L694 , L583;
L696: ((the multF of D116) = ( (the multF of D115) || ( C173 -roots_of_1 ) ) & (the multF of D113) = ( (the multF of D115) || D114 )) by L267 , L632;
L697: (the multF of D116) = ( (the multF of D113) || D117 ) by L696 , L694 , L695 , RELAT_1:74 , ZFMISC_1:96;
thus L698: thesis by L697 , L695 , GROUP_2:def 5;
end;
begin
definition
let C174 being non  empty Nat;
let C175 being  left_unital non  empty doubleLoopStr;
func unital_poly (C175 , C174) -> (Polynomial of C175) equals 
( ( ( 0_. C175 ) +* (( 0 ) , ( - ( 1_ C175 ) )) ) +* (C174 , ( 1_ C175 )) );
coherence
proof
set D118 = ( ( ( 0_. C175 ) +* (( 0 ) , ( - ( 1_ C175 ) )) ) +* (C174 , ( 1_ C175 )) );
L699: (for B173 being Nat holds ((B173 <> ( 0 ) & B173 <> C174) implies ( D118 . B173 ) = ( 0. C175 )))
proof
set D119 = ( ( 0_. C175 ) +* (( 0 ) , ( - ( 1_ C175 ) )) );
let C176 being Nat;
assume that
L700: C176 <> ( 0 )
and
L701: C176 <> C174;
L702: C176 in ( NAT ) by ORDINAL1:def 12;
L703: ( ( D119 +* (C174 , ( 1_ C175 )) ) . C176 ) = ( D119 . C176 ) by L701 , FUNCT_7:32
.= ( ( 0_. C175 ) . C176 ) by L700 , FUNCT_7:32
.= ( 0. C175 ) by L702 , FUNCOP_1:7;
thus L704: thesis by L703;
end;
L705: (for B174 being Nat holds (B174 >= ( C174 + 1 ) implies ( D118 . B174 ) = ( 0. C175 )))
proof
let C177 being Nat;
assume that
L706: C177 >= ( C174 + 1 );
L707:
now
L708: ( C174 + ( 0 ) ) < ( C174 + 1 ) by XREAL_1:8;
assume L709: C177 = C174;
thus L710: contradiction by L709 , L706 , L708;
end;
thus L711: thesis by L707 , L699 , L706;
end;
thus L712: thesis by L705 , ALGSEQ_1:def 1;
end;
end;
L714: ( unital_poly (( F_Complex ) , 1) ) = <% ( - ( 1_ ( F_Complex ) ) ) , ( 1_ ( F_Complex ) ) %> by POLYNOM5:def 4;
theorem
L715: (for B175 being  left_unital non  empty doubleLoopStr holds (for B176 being non  empty (Element of ( NAT )) holds (( ( unital_poly (B175 , B176) ) . ( 0 ) ) = ( - ( 1_ B175 ) ) & ( ( unital_poly (B175 , B176) ) . B176 ) = ( 1_ B175 ))))
proof
let C178 being  left_unital non  empty doubleLoopStr;
let C179 being non  empty (Element of ( NAT ));
set D120 = ( ( 0_. C178 ) +* (( 0 ) , ( - ( 1_ C178 ) )) );
set D121 = ( ( 0_. C178 ) +* (C179 , ( 1_ C178 )) );
L716: ( 0 ) in ( NAT );
L717: (( unital_poly (C178 , C179) ) = ( D121 +* (( 0 ) , ( - ( 1_ C178 ) )) ) & ( 0 ) in ( dom D121 )) by L716 , FUNCT_7:33 , NORMSP_1:12;
L718: C179 in ( NAT );
L719: C179 in ( dom D120 ) by L718 , NORMSP_1:12;
thus L720: thesis by L719 , L717 , FUNCT_7:31;
end;
theorem
L721: (for B177 being  left_unital non  empty doubleLoopStr holds (for B178 being non  empty Nat holds (for B179 being Nat holds ((B179 <> ( 0 ) & B179 <> B178) implies ( ( unital_poly (B177 , B178) ) . B179 ) = ( 0. B177 )))))
proof
let C180 being  left_unital non  empty doubleLoopStr;
let C181 being non  empty Nat;
let C182 being Nat;
assume that
L722: C182 <> ( 0 )
and
L723: C182 <> C181;
set D122 = ( ( 0_. C180 ) +* (( 0 ) , ( - ( 1_ C180 ) )) );
L724: C182 in ( NAT ) by ORDINAL1:def 12;
L725: ( ( D122 +* (C181 , ( 1_ C180 )) ) . C182 ) = ( D122 . C182 ) by L723 , FUNCT_7:32
.= ( ( 0_. C180 ) . C182 ) by L722 , FUNCT_7:32
.= ( 0. C180 ) by L724 , FUNCOP_1:7;
thus L726: thesis by L725;
end;
theorem
L727: (for B180 being non  degenerated  well-unital non  empty doubleLoopStr holds (for B181 being non  empty (Element of ( NAT )) holds ( len ( unital_poly (B180 , B181) ) ) = ( B181 + 1 )))
proof
let C183 being non  degenerated  well-unital non  empty doubleLoopStr;
let C184 being non  empty (Element of ( NAT ));
L728: (for B182 being Nat holds (B182 is_at_least_length_of ( unital_poly (C183 , C184) ) implies ( C184 + 1 ) <= B182))
proof
let C185 being Nat;
assume that
L729: C185 is_at_least_length_of ( unital_poly (C183 , C184) );
L730:
now
assume L731: C185 < ( C184 + 1 );
L732: C185 <= C184 by L731 , NAT_1:13;
L733: ( ( unital_poly (C183 , C184) ) . C184 ) = ( 0. C183 ) by L732 , L729 , ALGSEQ_1:def 2;
thus L734: contradiction by L733 , L715;
end;
thus L735: thesis by L730;
end;
L736: (for B183 being Nat holds (B183 >= ( C184 + 1 ) implies ( ( unital_poly (C183 , C184) ) . B183 ) = ( 0. C183 )))
proof
let C186 being Nat;
assume that
L737: C186 >= ( C184 + 1 );
L738:
now
L739: ( C184 + ( 0 ) ) < ( C184 + 1 ) by XREAL_1:8;
assume L740: C186 = C184;
thus L741: contradiction by L740 , L737 , L739;
end;
thus L742: thesis by L738 , L737 , L721;
end;
L743: ( C184 + 1 ) is_at_least_length_of ( unital_poly (C183 , C184) ) by L736 , ALGSEQ_1:def 2;
thus L744: thesis by L743 , L728 , ALGSEQ_1:def 3;
end;
registration
let C187 being non  degenerated  well-unital non  empty doubleLoopStr;
let C188 being non  empty (Element of ( NAT ));
cluster ( unital_poly (C187 , C188) ) ->  non-zero;
correctness
proof
L745: ( len ( unital_poly (C187 , C188) ) ) = ( C188 + 1 ) by L727;
thus L746: thesis by L745 , UPROOTS:17;
end;
end;
theorem
L748: (for B184 being non  empty (Element of ( NAT )) holds (for B185 being (Element of ( F_Complex )) holds ( eval (( unital_poly (( F_Complex ) , B184) ) , B185) ) = ( ( ( power ( F_Complex ) ) . (B185 , B184) ) - 1 )))
proof
L749: ( 1 - 1 ) = ( 0 );
L750: ( 1 -' 1 ) = ( 0 ) by L749 , XREAL_1:233;
reconsider D123 = ( 1_ ( F_Complex ) ) as (Element of ( COMPLEX )) by COMPLFLD:def 1;
let C189 being non  empty (Element of ( NAT ));
let C190 being (Element of ( F_Complex ));
set D124 = ( unital_poly (( F_Complex ) , C189) );
consider C191 being (FinSequence of ( F_Complex )) such that L751: ( eval (D124 , C190) ) = ( Sum C191 ) and L752: ( len C191 ) = ( len D124 ) and L753: (for B186 being (Element of ( NAT )) holds (B186 in ( dom C191 ) implies ( C191 . B186 ) = ( ( D124 . ( B186 -' 1 ) ) * ( ( power ( F_Complex ) ) . (C190 , ( B186 -' 1 )) ) ))) by POLYNOM4:def 2;
L754: ( ( 0 ) + 1 ) < ( C189 + 1 ) by XREAL_1:8;
L755: 1 < ( len C191 ) by L754 , L752 , L727;
L756: ( len C191 ) = ( C189 + 1 ) by L752 , L727;
L757: ( ( len C191 ) - 1 ) = C189 by L756;
L758: ( ( len C191 ) -' 1 ) = C189 by L757 , L754 , XREAL_1:233;
L759: ( ( ( len C191 ) - 1 ) + 1 ) = ( len C191 );
L760: ( ( ( len C191 ) -' 1 ) + 1 ) = ( len C191 ) by L759 , L755 , XREAL_1:233;
L761: ( D124 . ( 0 ) ) = ( - ( 1_ ( F_Complex ) ) ) by L715;
set D125 = ( ( power ( F_Complex ) ) . (C190 , C189) );
set D126 = ( ( ( len C191 ) -' 1 ) |-> ( 0. ( F_Complex ) ) );
L762: ( len D126 ) = ( ( len C191 ) -' 1 ) by CARD_1:def 7;
set D127 = ( D126 ^ <* D125 *> );
set D128 = ( <* ( - ( 1_ ( F_Complex ) ) ) *> ^ D126 );
L763: ( dom C191 ) = ( Seg ( len C191 ) ) by FINSEQ_1:def 3;
reconsider D129 = D128 as (Tuple of ( len C191 ) , (the carrier of ( F_Complex ))) by L760;
reconsider D130 = D129 as (Element of ( ( len C191 ) -tuples_on (the carrier of ( F_Complex )) )) by FINSEQ_2:131;
reconsider D131 = D127 as (Tuple of ( len C191 ) , (the carrier of ( F_Complex ))) by L760;
reconsider D132 = D131 as (Element of ( ( len C191 ) -tuples_on (the carrier of ( F_Complex )) )) by FINSEQ_2:131;
L764: (for B187 being (Element of ( NAT )) holds (B187 in ( dom D126 ) implies ( D126 . B187 ) = ( 0. ( F_Complex ) )))
proof
let C192 being (Element of ( NAT ));
assume L765: C192 in ( dom D126 );
L766: C192 in ( Seg ( ( len C191 ) -' 1 ) ) by L765 , FUNCOP_1:13;
thus L767: thesis by L766 , FUNCOP_1:7;
end;
L768: (for B188 being Nat holds ((B188 <> 1 & B188 in ( dom D130 )) implies ( D130 . B188 ) = ( 0. ( F_Complex ) )))
proof
let C193 being Nat;
assume that
L769: C193 <> 1
and
L770: C193 in ( dom D130 );
L771: ( dom <* ( - ( 1_ ( F_Complex ) ) ) *> ) = ( Seg 1 ) by FINSEQ_1:def 8;
L772:
now
assume L773: C193 in ( dom <* ( - ( 1_ ( F_Complex ) ) ) *> );
L774: (1 <= C193 & C193 <= 1) by L773 , L771 , FINSEQ_1:1;
thus L775: contradiction by L774 , L769 , XXREAL_0:1;
end;
consider C194 being Nat such that L776: C194 in ( dom D126 ) and L777: C193 = ( ( len <* ( - ( 1_ ( F_Complex ) ) ) *> ) + C194 ) by L772 , L770 , FINSEQ_1:25;
L778: ( D126 . C194 ) = ( 0. ( F_Complex ) ) by L764 , L776;
thus L779: thesis by L778 , L776 , L777 , FINSEQ_1:def 7;
end;
L780: ( len D127 ) = ( ( len D126 ) + ( len <* D125 *> ) ) by FINSEQ_1:22;
L781: ( len D127 ) = ( len C191 ) by L780 , L762 , L760 , FINSEQ_1:39;
L782: (for B189 being (Element of ( NAT )) holds ((B189 in ( dom D132 ) & B189 <> ( len C191 )) implies ( D132 . B189 ) = ( 0. ( F_Complex ) )))
proof
let C195 being (Element of ( NAT ));
assume that
L783: C195 in ( dom D132 )
and
L784: C195 <> ( len C191 );
L785: ( dom D132 ) = ( Seg ( len C191 ) ) by L781 , FINSEQ_1:def 3;
L786: C195 <= ( len C191 ) by L785 , L783 , FINSEQ_1:1;
L787: C195 < ( ( ( len C191 ) -' 1 ) + 1 ) by L786 , L760 , L784 , XXREAL_0:1;
L788: C195 <= ( ( len C191 ) -' 1 ) by L787 , NAT_1:13;
L789: 1 <= C195 by L783 , L785 , FINSEQ_1:1;
L790: C195 in ( Seg ( ( len C191 ) -' 1 ) ) by L789 , L788 , FINSEQ_1:1;
L791: C195 in ( dom D126 ) by L790 , L762 , FINSEQ_1:def 3;
L792: ( D132 . C195 ) = ( D126 . C195 ) by L791 , FINSEQ_1:def 7;
thus L793: thesis by L792 , L764 , L791;
end;
L794: ( len D130 ) = ( len C191 ) by CARD_1:def 7;
L795: ( dom D130 ) = ( Seg ( len C191 ) ) by L794 , FINSEQ_1:def 3;
L796: ( len D132 ) = ( len C191 ) by CARD_1:def 7;
L797: ( dom D132 ) = ( Seg ( len C191 ) ) by L796 , FINSEQ_1:def 3;
L798: ( D130 . 1 ) = ( - ( 1_ ( F_Complex ) ) ) by FINSEQ_1:41;
L799: ( len ( D130 + D132 ) ) = ( len C191 ) by CARD_1:def 7;
L800: ( dom ( D130 + D132 ) ) = ( Seg ( len C191 ) ) by L799 , FINSEQ_1:def 3;
L801: ( D132 . ( len C191 ) ) = ( ( power ( F_Complex ) ) . (C190 , C189) ) by L762 , L760 , FINSEQ_1:42;
L802: (for B190 being Nat holds (B190 in ( dom ( D130 + D132 ) ) implies ( ( D130 + D132 ) . B190 ) = ( C191 . B190 )))
proof
let C196 being Nat;
assume that
L803: C196 in ( dom ( D130 + D132 ) );
L804: C196 in ( Seg ( len C191 ) ) by L799 , L803 , FINSEQ_1:def 3;
L805: C196 in ( dom C191 ) by L800 , L803 , FINSEQ_1:def 3;
L806: 1 <= C196 by L800 , L803 , FINSEQ_1:1;
L807: ( ( - ( 1_ ( F_Complex ) ) ) * ( 1_ ( F_Complex ) ) ) = ( - ( 1_ ( F_Complex ) ) ) by COMPLFLD:8;
L808:
now
per cases ;
suppose L809: C196 = 1;

L810: ( D132 . C196 ) = ( 0. ( F_Complex ) ) by L809 , L755 , L782 , L797 , L804;
L811: ( ( D130 + D132 ) . 1 ) = ( ( - ( 1_ ( F_Complex ) ) ) + ( 0. ( F_Complex ) ) ) by L810 , L798 , L803 , L809 , FVSUM_1:17;
L812: ( C191 . 1 ) = ( ( D124 . ( 0 ) ) * ( ( power ( F_Complex ) ) . (C190 , ( 0 )) ) ) by L753 , L750 , L805 , L809
.= ( - ( 1_ ( F_Complex ) ) ) by L761 , L807 , GROUP_1:def 7;
thus L813: thesis by L812 , L809 , L811 , COMPLFLD:7;
end;
suppose L814: C196 <> 1;

L815:
now
per cases ;
suppose L816: C196 = ( len C191 );

L817: ( len C191 ) <> ( 0 ) by L752 , L754 , L727;
L818: ( C191 . ( len C191 ) ) = ( ( D124 . ( ( len C191 ) -' 1 ) ) * ( ( power ( F_Complex ) ) . (C190 , ( ( len C191 ) -' 1 )) ) ) by L817 , L753 , L763 , FINSEQ_1:3
.= ( ( 1_ ( F_Complex ) ) * ( ( power ( F_Complex ) ) . (C190 , C189) ) ) by L758 , L715
.= ( ( power ( F_Complex ) ) . (C190 , C189) ) by VECTSP_1:def 8;
L819: ( D130 . ( len C191 ) ) = ( 0. ( F_Complex ) ) by L755 , L768 , L795 , L804 , L816;
L820: ( ( D130 + D132 ) . ( len C191 ) ) = ( ( 0. ( F_Complex ) ) + ( ( power ( F_Complex ) ) . (C190 , C189) ) ) by L819 , L801 , L803 , L816 , FVSUM_1:17
.= ( ( power ( F_Complex ) ) . (C190 , C189) ) by COMPLFLD:7;
thus L821: thesis by L820 , L816 , L818;
end;
suppose L822: C196 <> ( len C191 );

L823:
now
assume L824: ( C196 -' 1 ) = C189;
L825: ( C196 - 1 ) = C189 by L824 , L806 , XREAL_1:233;
thus L826: contradiction by L825 , L756 , L822;
end;
L827: 1 < C196 by L806 , L814 , XXREAL_0:1;
L828: ( 1 + ( - 1 ) ) < ( C196 + ( - 1 ) ) by L827 , XREAL_1:8;
L829: ( 1 - 1 ) < ( C196 - 1 ) by L828;
L830: ( 0 ) < ( C196 -' 1 ) by L829 , L806 , XREAL_1:233;
L831: ( D124 . ( C196 -' 1 ) ) = ( 0. ( F_Complex ) ) by L830 , L823 , L721;
L832: ( C191 . C196 ) = ( ( 0. ( F_Complex ) ) * ( ( power ( F_Complex ) ) . (C190 , ( C196 -' 1 )) ) ) by L831 , L753 , L805;
L833: ( D132 . C196 ) = ( 0. ( F_Complex ) ) by L782 , L797 , L804 , L822;
L834: ( D130 . C196 ) = ( 0. ( F_Complex ) ) by L768 , L795 , L804 , L814;
L835: ( ( D130 + D132 ) . C196 ) = ( ( 0. ( F_Complex ) ) + ( 0. ( F_Complex ) ) ) by L834 , L803 , L833 , FVSUM_1:17;
thus L836: thesis by L835 , L832 , COMPLFLD:7;
end;
end;
thus L838: thesis by L815;
end;
end;
thus L840: thesis by L808;
end;
L841: ( D130 + D132 ) = C191 by L802 , L763 , L800 , FINSEQ_1:13;
L842: ( Sum D126 ) = ( 0. ( F_Complex ) ) by MATRIX_3:11;
L843: (( Sum D130 ) = ( ( - ( 1_ ( F_Complex ) ) ) + ( 0. ( F_Complex ) ) ) & ( Sum D132 ) = ( ( 0. ( F_Complex ) ) + D125 )) by L842 , FVSUM_1:71 , FVSUM_1:72;
L844: (( - D123 ) = ( - ( 1_ ( F_Complex ) ) ) & ( Sum C191 ) = ( ( - ( 1_ ( F_Complex ) ) ) + ( ( power ( F_Complex ) ) . (C190 , C189) ) )) by L843 , L841 , COMPLFLD:2 , COMPLFLD:7 , FVSUM_1:76;
thus L845: thesis by L844 , L751 , COMPLFLD:8;
end;
theorem
L846: (for B191 being non  empty (Element of ( NAT )) holds ( Roots ( unital_poly (( F_Complex ) , B191) ) ) = ( B191 -roots_of_1 ))
proof
let C197 being non  empty (Element of ( NAT ));
L847:
now
set D133 = ( unital_poly (( F_Complex ) , C197) );
let C198 being set;
thus L848:now
assume L849: C198 in ( Roots D133 );
reconsider D134 = C198 as (Element of ( F_Complex )) by L849;
L850: D134 is_a_root_of D133 by L849 , POLYNOM5:def 9;
L851: ( 0. ( F_Complex ) ) = ( eval (D133 , D134) ) by L850 , POLYNOM5:def 6
.= ( ( ( power ( F_Complex ) ) . (D134 , C197) ) - 1 ) by L748;
L852: D134 is (CRoot of C197 , ( 1_ ( F_Complex ) )) by L851 , COMPLFLD:7 , COMPLFLD:8 , COMPLFLD:def 2;
thus L853: C198 in ( C197 -roots_of_1 ) by L852;
end;
assume L854: C198 in ( C197 -roots_of_1 );
reconsider D135 = C198 as (Element of ( F_Complex )) by L854;
L855: D135 is (CRoot of C197 , ( 1_ ( F_Complex ) )) by L854 , L348;
L856: ( ( power ( F_Complex ) ) . (D135 , C197) ) = 1 by L855 , COMPLFLD:8 , COMPLFLD:def 2;
L857: ( ( ( power ( F_Complex ) ) . (D135 , C197) ) - 1 ) = ( 0c ) by L856;
L858: ( eval (D133 , D135) ) = ( 0. ( F_Complex ) ) by L857 , L748 , COMPLFLD:7;
L859: D135 is_a_root_of D133 by L858 , POLYNOM5:def 6;
thus L860: C198 in ( Roots ( unital_poly (( F_Complex ) , C197) ) ) by L859 , POLYNOM5:def 9;
end;
thus L861: thesis by L847 , TARSKI:1;
end;
theorem
L862: (for B192 being (Element of ( NAT )) holds (for B193 being (Element of ( F_Complex )) holds (B193 is Real implies (ex B194 being Real st (B194 = B193 & ( ( power ( F_Complex ) ) . (B193 , B192) ) = ( B194 |^ B192 ))))))
proof
let C199 being (Element of ( NAT ));
let C200 being (Element of ( F_Complex ));
assume L863: C200 is Real;
reconsider D136 = C200 as Real by L863;
per cases ;
suppose L864: D136 = ( 0 );

L865: C200 = ( 0. ( F_Complex ) ) by L864 , COMPLFLD:def 1;
thus L866: thesis
proof
per cases ;
suppose L867: C199 = ( 0 );

L868: ( ( power ( F_Complex ) ) . (C200 , C199) ) = 1 by L867 , COMPLFLD:8 , GROUP_1:def 7
.= ( D136 |^ C199 ) by L867 , NEWTON:4;
thus L869: thesis by L868;
end;
suppose L870: C199 > ( 0 );

L871: C199 >= ( ( 0 ) + 1 ) by L870 , NAT_1:13;
L872: ( ( power ( F_Complex ) ) . (C200 , C199) ) = ( 0. ( F_Complex ) ) by L865 , L870 , VECTSP_1:36
.= ( D136 |^ C199 ) by L864 , L871 , COMPLFLD:7 , NEWTON:11;
thus L873: thesis by L872;
end;
end;

end;
suppose L867: D136 <> ( 0 );

defpred S11[ (Element of ( NAT )) ] means ( ( power ( F_Complex ) ) . (C200 , $1) ) = ( D136 |^ $1 );
L868: (for B195 being (Element of ( NAT )) holds (S11[ B195 ] implies S11[ ( B195 + 1 ) ]))
proof
let C201 being (Element of ( NAT ));
assume that
L869: S11[ C201 ];
L870: ( ( power ( F_Complex ) ) . (C200 , ( C201 + 1 )) ) = ( ( ( power ( F_Complex ) ) . (C200 , C201) ) * C200 ) by GROUP_1:def 7
.= ( ( D136 #Z C201 ) * D136 ) by L869 , PREPOWER:36
.= ( ( D136 #Z C201 ) * ( D136 #Z 1 ) ) by PREPOWER:35
.= ( D136 #Z ( C201 + 1 ) ) by L867 , PREPOWER:44
.= ( D136 |^ ( C201 + 1 ) ) by PREPOWER:36;
thus L871: thesis by L870;
end;
L872: ( ( power ( F_Complex ) ) . (C200 , ( 0 )) ) = ( 1r ) by COMPLFLD:8 , GROUP_1:def 7
.= ( D136 #Z ( 0 ) ) by PREPOWER:34
.= ( D136 |^ ( 0 ) ) by PREPOWER:36;
L873: S11[ ( 0 ) ] by L872;
L874: (for B196 being (Element of ( NAT )) holds S11[ B196 ]) from NAT_1:sch 1(L873 , L868);
L875: ( ( power ( F_Complex ) ) . (C200 , C199) ) = ( D136 |^ C199 ) by L874;
thus L876: thesis by L875;
end;
end;
theorem
L878: (for B197 being non  empty (Element of ( NAT )) holds (for B198 being Real holds (ex B199 being (Element of ( F_Complex )) st (B199 = B198 & ( eval (( unital_poly (( F_Complex ) , B197) ) , B199) ) = ( ( B198 |^ B197 ) - 1 )))))
proof
let C202 being non  empty (Element of ( NAT ));
let C203 being Real;
L879: C203 in ( COMPLEX ) by XCMPLX_0:def 2;
reconsider D137 = C203 as (Element of ( F_Complex )) by L879 , COMPLFLD:def 1;
L880: (ex B200 being Real st (B200 = D137 & ( ( power ( F_Complex ) ) . (D137 , C202) ) = ( B200 |^ C202 ))) by L862;
L881: ( eval (( unital_poly (( F_Complex ) , C202) ) , D137) ) = ( ( C203 |^ C202 ) - 1 ) by L880 , L748;
thus L882: thesis by L881;
end;
theorem
L883: (for B201 being non  empty (Element of ( NAT )) holds ( BRoots ( unital_poly (( F_Complex ) , B201) ) ) = ( (( B201 -roots_of_1 ) , 1) -bag ))
proof
let C204 being non  empty (Element of ( NAT ));
set D138 = ( unital_poly (( F_Complex ) , C204) );
L884: ( degree ( BRoots D138 ) ) = ( ( len D138 ) -' 1 ) by UPROOTS:59
.= ( ( C204 + 1 ) -' 1 ) by L727
.= C204 by NAT_D:34;
L885: ( card ( C204 -roots_of_1 ) ) = C204 by L442;
L886: (( Roots D138 ) = ( C204 -roots_of_1 ) & ( support ( BRoots D138 ) ) = ( Roots D138 )) by L846 , UPROOTS:def 9;
thus L887: thesis by L886 , L884 , L885 , UPROOTS:13;
end;
theorem
L888: (for B202 being non  empty (Element of ( NAT )) holds ( unital_poly (( F_Complex ) , B202) ) = ( poly_with_roots ( (( B202 -roots_of_1 ) , 1) -bag ) ))
proof
let C205 being non  empty (Element of ( NAT ));
set D139 = ( unital_poly (( F_Complex ) , C205) );
L889: ( len D139 ) = ( C205 + 1 ) by L727;
L890: ( D139 . ( ( len D139 ) -' 1 ) ) = ( D139 . C205 ) by L889 , NAT_D:34
.= ( 1_ ( F_Complex ) ) by L715;
thus L891: ( unital_poly (( F_Complex ) , C205) ) = ( poly_with_roots ( BRoots ( unital_poly (( F_Complex ) , C205) ) ) ) by L890 , UPROOTS:65
.= ( poly_with_roots ( (( C205 -roots_of_1 ) , 1) -bag ) ) by L883;
end;
theorem
L892: (for B203 being non  empty (Element of ( NAT )) holds (for B204 being (Element of ( F_Complex )) holds (B204 is Integer implies ( eval (( unital_poly (( F_Complex ) , B203) ) , B204) ) is Integer)))
proof
let C206 being non  empty (Element of ( NAT ));
let C207 being (Element of ( F_Complex ));
assume that
L893: C207 is Integer;
reconsider D140 = C207 as Integer by L893;
L894: C207 is Real by L893 , XREAL_0:def 1;
L895: (ex B205 being (Element of ( F_Complex )) st (B205 = C207 & ( eval (( unital_poly (( F_Complex ) , C206) ) , B205) ) = ( ( D140 |^ C206 ) - 1 ))) by L894 , L878;
thus L896: thesis by L895;
end;
begin
definition
let C208 being non  empty Nat;
func cyclotomic_poly C208 -> (Polynomial of ( F_Complex )) means 
:L897: (ex B206 being non  empty  finite (Subset of ( F_Complex )) st (B206 = { B207 where B207 is (Element of ( MultGroup ( F_Complex ) )) : ( ord B207 ) = C208 } & it = ( poly_with_roots ( (B206 , 1) -bag ) )));
existence
proof
set D141 = (the carrier of ( MultGroup ( F_Complex ) ));
reconsider D142 = C208 as non  empty (Element of ( NAT )) by ORDINAL1:def 12;
defpred S12[ (Element of D141) ] means ( ord $1 ) = D142;
set D143 = { B208 where B208 is (Element of D141) : S12[ B208 ] };
set D144 = [** ( cos ( ( ( 2 * ( PI ) ) * 1 ) / D142 ) ) , ( sin ( ( ( 2 * ( PI ) ) * 1 ) / D142 ) ) **];
reconsider D145 = D142 as Integer;
L898: D144 <> ( 0. ( F_Complex ) )
proof
assume L899: D144 = ( 0. ( F_Complex ) );
L900: ( ( 0 ) + ( ( 0 ) * ( <i> ) ) ) = ( ( cos ( ( ( 2 * ( PI ) ) * 1 ) / D142 ) ) + ( ( sin ( ( ( 2 * ( PI ) ) * 1 ) / D142 ) ) * ( <i> ) ) ) by L899 , COMPLFLD:7;
L901: ( cos ( ( ( 2 * ( PI ) ) * 1 ) / D142 ) ) = ( 0 ) by L900 , COMPLEX1:77;
thus L902: contradiction by L901 , L899 , COMPLEX2:10 , COMPLFLD:7;
end;
L903: (not D144 in { ( 0. ( F_Complex ) ) }) by L898 , TARSKI:def 1;
L904: D141 = ( NonZero ( F_Complex ) ) by L267;
reconsider D146 = D144 as (Element of D141) by L904 , L903 , XBOOLE_0:def 5;
L905: ( D142 -roots_of_1 ) = { B209 where B209 is (Element of D141) : ( ord B209 ) divides D142 } by L613;
L906: D143 c= ( D142 -roots_of_1 )
proof
let C209 being set;
assume L907: C209 in D143;
L908: (ex B210 being (Element of D141) st (C209 = B210 & ( ord B210 ) = D142)) by L907;
thus L909: thesis by L908 , L905;
end;
L910: ( 1 gcd D145 ) = 1 by WSIERP_1:8;
L911: ( ord D146 ) = ( D142 div 1 ) by L910 , L535
.= D142 by NAT_2:4;
L912: D146 in D143 by L911;
reconsider D147 = D143 as non  empty  finite (Subset of ( F_Complex )) by L912 , L906 , XBOOLE_1:1;
take ( poly_with_roots ( (D147 , 1) -bag ) );
thus L913: thesis;
end;
uniqueness;
end;
theorem
L915: ( cyclotomic_poly 1 ) = <% ( - ( 1_ ( F_Complex ) ) ) , ( 1_ ( F_Complex ) ) %>
proof
set D148 = (the carrier of ( MultGroup ( F_Complex ) ));
consider C210 being non  empty  finite (Subset of ( F_Complex )) such that L916: C210 = { B211 where B211 is (Element of D148) : ( ord B211 ) = 1 } and L917: ( cyclotomic_poly 1 ) = ( poly_with_roots ( (C210 , 1) -bag ) ) by L897;
L918: ( 1 -roots_of_1 ) = { B212 where B212 is (Element of D148) : ( ord B212 ) divides 1 } by L613;
L919:
now
let C211 being set;
thus L920:now
assume L921: C211 in C210;
L922: (ex B213 being (Element of D148) st (C211 = B213 & ( ord B213 ) = 1)) by L921 , L916;
thus L923: C211 in ( 1 -roots_of_1 ) by L922 , L918;
end;
assume L924: C211 in ( 1 -roots_of_1 );
consider C212 being (Element of D148) such that L925: C211 = C212 and L926: ( ord C212 ) divides 1 by L924 , L918;
L927: ( ord C212 ) = 1 by L926 , WSIERP_1:15;
thus L928: C211 in C210 by L927 , L916 , L925;
end;
L929: C210 = ( 1 -roots_of_1 ) by L919 , TARSKI:1;
thus L930: thesis by L929 , L917 , L714 , L888;
end;
theorem
L931: (for B214 being non  empty (Element of ( NAT )) holds (for B215 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds ((( len B215 ) = B214 & (for B216 being non  empty (Element of ( NAT )) holds (B216 in ( dom B215 ) implies (((not B216 divides B214) implies ( B215 . B216 ) = <% ( 1_ ( F_Complex ) ) %>) & (B216 divides B214 implies ( B215 . B216 ) = ( cyclotomic_poly B216 )))))) implies ( unital_poly (( F_Complex ) , B214) ) = ( Product B215 ))))
proof
set D149 = (the carrier of ( MultGroup ( F_Complex ) ));
let C213 being non  empty (Element of ( NAT ));
let C214 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) )));
assume that
L932: ( len C214 ) = C213
and
L933: (for B217 being non  empty (Element of ( NAT )) holds (B217 in ( dom C214 ) implies (((not B217 divides C213) implies ( C214 . B217 ) = <% ( 1_ ( F_Complex ) ) %>) & (B217 divides C213 implies ( C214 . B217 ) = ( cyclotomic_poly B217 )))));
defpred S13[ Nat , set ] means (for B218 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds (B218 = ( C214 | ( Seg $1 ) ) implies $2 = ( Product B218 )));
set D150 = ( C213 -roots_of_1 );
deffunc H1(Nat) = { B219 where B219 is (Element of ( MultGroup ( F_Complex ) )) : (B219 in D150 & ( ord B219 ) <= $1) };
L934:
now
let C215 being Nat;
assume L935: C215 in ( Seg ( len C214 ) );
reconsider D151 = ( C214 | ( Seg C215 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
set D152 = ( Product D151 );
take D153 = D152;
thus L936: S13[ C215 , D153 ];
end;
consider C216 being (FinSequence of ( Polynom-Ring ( F_Complex ) )) such that L937: ( dom C216 ) = ( Seg ( len C214 ) ) and L938: (for B220 being Nat holds (B220 in ( Seg ( len C214 ) ) implies S13[ B220 , ( C216 . B220 ) ])) from FINSEQ_1:sch 5(L934);
defpred S14[ (Element of ( NAT )) ] means (ex B221 being  finite (Subset of ( F_Complex )) st (B221 = H1($1) & ( C216 . $1 ) = ( poly_with_roots ( (B221 , 1) -bag ) )));
L939:
now
let C217 being (Element of ( NAT ));
L940: H1(C217) c= D150
proof
let C218 being set;
assume L941: C218 in H1(C217);
L942: (ex B222 being (Element of D149) st (C218 = B222 & B222 in D150 & ( ord B222 ) <= C217)) by L941;
thus L943: thesis by L942;
end;
thus L944: H1(C217) is  finite  finite  finite  finite (Subset of ( F_Complex )) by L940 , XBOOLE_1:1;
end;
reconsider D154 = H1(C213) as  finite (Subset of ( F_Complex )) by L939;
L945: D150 = { B223 where B223 is (Element of ( MultGroup ( F_Complex ) )) : ( ord B223 ) divides C213 } by L613;
L946: (for B224 being (Element of ( NAT )) holds ((1 <= B224 & B224 < ( len C214 )) implies (S14[ B224 ] implies S14[ ( B224 + 1 ) ])))
proof
let C219 being (Element of ( NAT ));
assume that
L947: 1 <= C219
and
L948: C219 < ( len C214 )
and
L949: S14[ C219 ];
reconsider D155 = ( C214 | ( Seg C219 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
L950: C219 in ( Seg ( len C214 ) ) by L947 , L948 , FINSEQ_1:1;
L951: ( C216 . C219 ) = ( Product D155 ) by L950 , L938;
reconsider D156 = ( C214 | ( Seg ( C219 + 1 ) ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
L952: ( C219 + 1 ) <= ( len C214 ) by L948 , NAT_1:13;
L953: ( C219 + 1 ) = ( min (( C219 + 1 ) , ( len C214 )) ) by L952 , XXREAL_0:def 9;
L954: ( len D156 ) = ( C219 + 1 ) by L953 , FINSEQ_2:21;
L955: 1 <= ( C219 + 1 ) by L947 , NAT_1:13;
L956: ( C219 + 1 ) in ( Seg ( len C214 ) ) by L955 , L952 , FINSEQ_1:1;
L957: ( C219 + 1 ) in ( dom C214 ) by L956 , FINSEQ_1:def 3;
reconsider D157 = H1(( C219 + 1 )) as  finite (Subset of ( F_Complex )) by L939;
take D157;
thus L958: D157 = H1(( C219 + 1 ));
set D158 = ( (D157 , 1) -bag );
consider C220 being  finite (Subset of ( F_Complex )) such that L959: C220 = H1(C219) and L960: ( C216 . C219 ) = ( poly_with_roots ( (C220 , 1) -bag ) ) by L949;
L961: ( ( C214 | ( Seg ( C219 + 1 ) ) ) . ( C219 + 1 ) ) = ( C214 . ( C219 + 1 ) ) by FINSEQ_1:4 , FUNCT_1:49;
reconsider D159 = ( D156 . ( C219 + 1 ) ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by L961 , L957 , FINSEQ_2:11;
set D160 = ( (C220 , 1) -bag );
reconsider D161 = D159 as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
L962: D155 = ( D156 | ( Seg C219 ) ) by L32 , NAT_1:12;
L963: D156 = ( D155 ^ <* D159 *> ) by L962 , L954 , FINSEQ_3:55;
L964: ( Product D156 ) = ( ( Product D155 ) * D159 ) by L963 , GROUP_4:6
.= ( ( poly_with_roots D160 ) *' D161 ) by L960 , L951 , POLYNOM3:def 10;
per cases ;
suppose L965: (not ( C219 + 1 ) divides C213);

set D162 = ( EmptyBag (the carrier of ( F_Complex )) );
L966:
now
let C221 being set;
thus L967:now
assume L968: C221 in D157;
consider C222 being (Element of ( MultGroup ( F_Complex ) )) such that L969: C221 = C222 and L970: C222 in D150 and L971: ( ord C222 ) <= ( C219 + 1 ) by L968;
L972: ( ord C222 ) divides C213 by L970 , L596;
L973: ( ord C222 ) < ( C219 + 1 ) by L972 , L965 , L971 , XXREAL_0:1;
L974: ( ord C222 ) <= C219 by L973 , NAT_1:13;
thus L975: C221 in C220 by L974 , L959 , L969 , L970;
end;
assume L976: C221 in C220;
consider C223 being (Element of D149) such that L977: (C221 = C223 & C223 in D150) and L978: ( ord C223 ) <= C219 by L976 , L959;
L979: ( ord C223 ) <= ( C219 + 1 ) by L978 , NAT_1:12;
thus L980: C221 in D157 by L979 , L977;
end;
L981: D157 = C220 by L966 , TARSKI:1;
L982: ( C214 . ( C219 + 1 ) ) = <% ( 1_ ( F_Complex ) ) %> by L933 , L957 , L965
.= ( poly_with_roots D162 ) by UPROOTS:60;
thus L983: ( C216 . ( C219 + 1 ) ) = ( ( poly_with_roots D160 ) *' ( poly_with_roots D162 ) ) by L982 , L938 , L956 , L961 , L964
.= ( poly_with_roots ( D160 + D162 ) ) by UPROOTS:64
.= ( poly_with_roots D158 ) by L981 , PRE_POLY:53;
end;
suppose L984: ( C219 + 1 ) divides C213;

consider C224 being non  empty  finite (Subset of ( F_Complex )) such that L985: C224 = { B225 where B225 is (Element of D149) : ( ord B225 ) = ( C219 + 1 ) } and L986: ( cyclotomic_poly ( C219 + 1 ) ) = ( poly_with_roots ( (C224 , 1) -bag ) ) by L897;
L987:
now
let C225 being set;
thus L988:now
assume L989: C225 in D157;
consider C226 being (Element of D149) such that L990: C225 = C226 and L991: C226 in D150 and L992: ( ord C226 ) <= ( C219 + 1 ) by L989;
L993: (( ord C226 ) <= C219 or ( ord C226 ) = ( C219 + 1 )) by L992 , NAT_1:8;
L994: (C226 in C220 or C226 in C224) by L993 , L959 , L985 , L991;
thus L995: C225 in ( C220 \/ C224 ) by L994 , L990 , XBOOLE_0:def 3;
end;
assume L996: C225 in ( C220 \/ C224 );
per cases  by L996 , XBOOLE_0:def 3;
suppose L997: C225 in C220;

consider C227 being (Element of D149) such that L998: (C225 = C227 & C227 in D150) and L999: ( ord C227 ) <= C219 by L997 , L959;
L1000: ( ord C227 ) <= ( C219 + 1 ) by L999 , NAT_1:12;
thus L1001: C225 in D157 by L1000 , L998;
end;
suppose L1002: C225 in C224;

consider C228 being (Element of D149) such that L1003: C225 = C228 and L1004: ( ord C228 ) = ( C219 + 1 ) by L1002 , L985;
L1005: C228 in D150 by L945 , L984 , L1004;
thus L1006: C225 in D157 by L1005 , L1003 , L1004;
end;
end;
L1008: D157 = ( C220 \/ C224 ) by L987 , TARSKI:1;
set D163 = ( (C224 , 1) -bag );
L1009: C220 misses C224
proof
assume L1010: ( C220 /\ C224 ) <> ( {} );
consider C229 being set such that L1011: C229 in ( C220 /\ C224 ) by L1010 , XBOOLE_0:def 1;
L1012: C229 in C224 by L1011 , XBOOLE_0:def 4;
L1013: (ex B226 being (Element of D149) st (C229 = B226 & ( ord B226 ) = ( C219 + 1 ))) by L1012 , L985;
L1014: C229 in C220 by L1011 , XBOOLE_0:def 4;
L1015: (ex B227 being (Element of D149) st (C229 = B227 & B227 in D150 & ( ord B227 ) <= C219)) by L1014 , L959;
thus L1016: contradiction by L1015 , L1013 , NAT_1:13;
end;
L1017: ( C214 . ( C219 + 1 ) ) = ( poly_with_roots D163 ) by L933 , L957 , L984 , L986;
thus L1018: ( C216 . ( C219 + 1 ) ) = ( ( poly_with_roots D160 ) *' ( poly_with_roots D163 ) ) by L1017 , L938 , L956 , L961 , L964
.= ( poly_with_roots ( D160 + D163 ) ) by UPROOTS:64
.= ( poly_with_roots D158 ) by L1008 , L1009 , UPROOTS:10;
end;
end;
L1020: ( ( 0 ) + 1 ) <= C213 by NAT_1:13;
L1021: S14[ 1 ]
proof
reconsider D164 = H1(1) as  finite (Subset of ( F_Complex )) by L939;
take D164;
thus L1022: D164 = H1(1);
reconsider D165 = ( C214 | ( Seg 1 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
L1023: (1 in ( dom C214 ) & 1 divides C213) by L932 , L1020 , FINSEQ_3:25 , NAT_D:6;
L1024: 1 in ( Seg ( len C214 ) ) by L932 , L1020 , FINSEQ_1:1;
L1025: 1 in ( dom C214 ) by L1024 , FINSEQ_1:def 3;
reconsider D166 = ( C214 . 1 ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by L1025 , FINSEQ_2:11;
L1026: D165 = <* ( C214 . 1 ) *> by L932 , L1020 , L23;
L1027: ( C216 . 1 ) = ( Product <* D166 *> ) by L1026 , L938 , L1024
.= D166 by FINSOP_1:11
.= ( cyclotomic_poly 1 ) by L933 , L1023;
consider C230 being non  empty  finite (Subset of ( F_Complex )) such that L1028: C230 = { B228 where B228 is (Element of D149) : ( ord B228 ) = 1 } and L1029: ( C216 . 1 ) = ( poly_with_roots ( (C230 , 1) -bag ) ) by L1027 , L897;
L1030:
now
let C231 being set;
thus L1031:now
assume L1032: C231 in H1(1);
consider C232 being (Element of D149) such that L1033: C231 = C232 and L1034: C232 in D150 and L1035: ( ord C232 ) <= 1 by L1032;
L1036: (not C232 is  being_of_order_0) by L1034 , L527;
L1037: ( ord C232 ) <> ( 0 ) by L1036 , GROUP_1:def 11;
L1038: ( ( 0 ) + 1 ) <= ( ord C232 ) by L1037 , NAT_1:13;
L1039: ( ord C232 ) = 1 by L1038 , L1035 , XXREAL_0:1;
thus L1040: C231 in C230 by L1039 , L1028 , L1033;
end;
assume L1041: C231 in C230;
consider C233 being (Element of D149) such that L1042: C231 = C233 and L1043: ( ord C233 ) = 1 by L1041 , L1028;
L1044: ( ord C233 ) divides C213 by L1043 , NAT_D:6;
L1045: C233 in D150 by L1044 , L945;
thus L1046: C231 in H1(1) by L1045 , L1042 , L1043;
end;
thus L1047: thesis by L1030 , L1029 , TARSKI:1;
end;
L1048: (for B229 being (Element of ( NAT )) holds ((1 <= B229 & B229 <= ( len C214 )) implies S14[ B229 ])) from INT_1:sch 7(L1021 , L946);
L1049: (ex B230 being  finite (Subset of ( F_Complex )) st (B230 = H1(( len C214 )) & ( C216 . ( len C214 ) ) = ( poly_with_roots ( (B230 , 1) -bag ) ))) by L1048 , L932 , L1020;
set D167 = ( (D150 , 1) -bag );
L1050: C214 = ( C214 | ( Seg ( len C214 ) ) ) by FINSEQ_3:49;
L1051:
now
let C234 being set;
thus L1052:now
assume L1053: C234 in D150;
consider C235 being (Element of ( MultGroup ( F_Complex ) )) such that L1054: C234 = C235 and L1055: ( ord C235 ) divides C213 by L1053 , L945;
L1056: ( ord C235 ) <= C213 by L1055 , NAT_D:7;
thus L1057: C234 in D154 by L1056 , L1053 , L1054;
end;
assume L1058: C234 in D154;
L1059: (ex B231 being (Element of ( MultGroup ( F_Complex ) )) st (B231 = C234 & B231 in D150 & ( ord B231 ) <= C213)) by L1058;
thus L1060: C234 in D150 by L1059;
end;
L1061: D150 = D154 by L1051 , TARSKI:1;
thus L1062: ( unital_poly (( F_Complex ) , C213) ) = ( poly_with_roots D167 ) by L888
.= ( Product C214 ) by L932 , L938 , L1061 , L1049 , L1050 , FINSEQ_1:3;
end;
theorem
L1063: (for B232 being non  empty (Element of ( NAT )) holds (ex B233 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) st (ex B234 being (Polynomial of ( F_Complex )) st (B234 = ( Product B233 ) & ( dom B233 ) = ( Seg B232 ) & (for B235 being non  empty (Element of ( NAT )) holds (B235 in ( Seg B232 ) implies ((((not B235 divides B232) or B235 = B232) implies ( B233 . B235 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B235 divides B232 & B235 <> B232) implies ( B233 . B235 ) = ( cyclotomic_poly B235 ))))) & ( unital_poly (( F_Complex ) , B232) ) = ( ( cyclotomic_poly B232 ) *' B234 )))))
proof
set D168 = (the carrier of ( Polynom-Ring ( F_Complex ) ));
let C236 being non  empty (Element of ( NAT ));
defpred S15[ set , set ] means (ex B236 being non  empty (Element of ( NAT )) st (B236 = $1 & ((not B236 divides C236) implies $2 = <% ( 1_ ( F_Complex ) ) %>) & (B236 divides C236 implies $2 = ( cyclotomic_poly B236 ))));
consider C237 being Nat such that L1064: C236 = ( C237 + 1 ) by NAT_1:6;
L1065: (for B237 being (Element of ( NAT )) holds (B237 in ( Seg C236 ) implies (ex B238 being (Element of D168) st S15[ B237 , B238 ])))
proof
let C238 being (Element of ( NAT ));
assume L1066: C238 in ( Seg C236 );
reconsider D169 = C238 as non  empty (Element of ( NAT )) by L1066 , FINSEQ_1:1;
per cases ;
suppose L1067: (not D169 divides C236);

reconsider D170 = <% ( 1_ ( F_Complex ) ) %> as (Element of D168) by POLYNOM3:def 10;
take D170;
take D169;
thus L1068: D169 = C238;
thus L1069: thesis by L1067;
end;
suppose L1070: D169 divides C236;

reconsider D171 = ( cyclotomic_poly D169 ) as (Element of D168) by POLYNOM3:def 10;
take D171;
take D169;
thus L1071: D169 = C238;
thus L1072: thesis by L1070;
end;
end;
consider C239 being (FinSequence of D168) such that L1074: ( dom C239 ) = ( Seg C236 ) and L1075: (for B239 being (Element of ( NAT )) holds (B239 in ( Seg C236 ) implies S15[ B239 , ( C239 /. B239 ) ])) from RECDEF_1:sch 17(L1065);
reconsider D172 = ( C239 | ( Seg C237 ) ) as (FinSequence of D168) by FINSEQ_1:18;
L1076: ( len C239 ) = C236 by L1074 , FINSEQ_1:def 3;
L1077:
now
let C240 being non  empty (Element of ( NAT ));
assume L1078: C240 in ( dom C239 );
L1079: C240 <= C236 by L1078 , L1074 , FINSEQ_1:1;
L1080: ((ex B240 being non  empty (Element of ( NAT )) st (B240 = C240 & ((not B240 divides C236) implies ( C239 /. C240 ) = <% ( 1_ ( F_Complex ) ) %>) & (B240 divides C236 implies ( C239 /. C240 ) = ( cyclotomic_poly B240 )))) & 1 <= C240) by L1074 , L1075 , L1078 , FINSEQ_1:1;
thus L1081: (((not C240 divides C236) implies ( C239 . C240 ) = <% ( 1_ ( F_Complex ) ) %>) & (C240 divides C236 implies ( C239 . C240 ) = ( cyclotomic_poly C240 ))) by L1080 , L1076 , L1079 , FINSEQ_4:15;
end;
reconsider D173 = <% ( 1_ ( F_Complex ) ) %> as (Element of D168) by POLYNOM3:def 10;
L1082: <* D173 *> is (FinSequence of D168);
reconsider D174 = ( D172 ^ <* <% ( 1_ ( F_Complex ) ) %> *> ) as (FinSequence of D168) by L1082 , FINSEQ_1:75;
reconsider D175 = ( Product D174 ) as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
take D174;
take D175;
thus L1083: D175 = ( Product D174 );
L1084: C237 <= C236 by L1064 , NAT_1:13;
L1085: ( len D172 ) = C237 by L1084 , L1076 , FINSEQ_1:17;
reconsider D176 = ( cyclotomic_poly C236 ) as (Element of D168) by POLYNOM3:def 10;
reconsider D177 = ( C239 | ( Seg C236 ) ) as (FinSequence of D168) by FINSEQ_1:18;
L1086: 1 <= C236 by NAT_1:53;
L1087: C236 in ( Seg C236 ) by L1086 , FINSEQ_1:1;
L1088: ( C239 . C236 ) = ( cyclotomic_poly C236 ) by L1087 , L1074 , L1077;
L1089: ( len <* <% ( 1_ ( F_Complex ) ) %> *> ) = 1 by FINSEQ_1:40;
thus L1090: ( dom D174 ) = ( Seg C236 ) by L1089 , L1064 , L1085 , FINSEQ_1:def 7;
L1091: ( dom D172 ) = ( Seg C237 ) by L1076 , L1084 , FINSEQ_1:17;
thus L1092: (for B241 being non  empty (Element of ( NAT )) holds (B241 in ( Seg C236 ) implies ((((not B241 divides C236) or B241 = C236) implies ( D174 . B241 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B241 divides C236 & B241 <> C236) implies ( D174 . B241 ) = ( cyclotomic_poly B241 )))))
proof
let C241 being non  empty (Element of ( NAT ));
assume L1093: C241 in ( Seg C236 );
per cases ;
suppose L1094: C241 in ( Seg C237 );

L1095: (( D172 . C241 ) = ( C239 . C241 ) & C241 <= C237) by L1094 , FINSEQ_1:1 , FUNCT_1:49;
L1096: ( D174 . C241 ) = ( D172 . C241 ) by L1091 , L1094 , FINSEQ_1:def 7;
thus L1097: thesis by L1096 , L1074 , L1064 , L1077 , L1093 , L1095 , NAT_1:13;
end;
suppose L1098: (not C241 in ( Seg C237 ));

L1099: (not (1 <= C241 & C241 <= C237)) by L1098 , FINSEQ_1:1;
L1100: C236 <= C241 by L1099 , L1064 , L1093 , FINSEQ_1:1 , NAT_1:13;
L1101: C241 <= C236 by L1093 , FINSEQ_1:1;
L1102: 1 in ( Seg 1 ) by FINSEQ_1:1;
L1103: 1 in ( dom <* <% ( 1_ ( F_Complex ) ) %> *> ) by L1102 , FINSEQ_1:38;
L1104: ( D174 . C236 ) = ( <* <% ( 1_ ( F_Complex ) ) %> *> . 1 ) by L1103 , L1064 , L1085 , FINSEQ_1:def 7
.= <% ( 1_ ( F_Complex ) ) %> by FINSEQ_1:40;
thus L1105: (((not C241 divides C236) or C241 = C236) implies ( D174 . C241 ) = <% ( 1_ ( F_Complex ) ) %>) by L1104 , L1100 , L1101 , XXREAL_0:1;
thus L1106: thesis by L1100 , L1101 , XXREAL_0:1;
end;
end;

reconsider D178 = <% ( 1_ ( F_Complex ) ) %> as (Element of D168) by POLYNOM3:def 10;
reconsider D179 = ( Product D172 ) as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
L1108: ( Product D174 ) = ( ( Product D172 ) * D178 ) by GROUP_4:6
.= ( D179 *' <% ( 1_ ( F_Complex ) ) %> ) by POLYNOM3:def 10
.= ( Product D172 ) by UPROOTS:32;
L1109: C239 = D177 by L1076 , FINSEQ_2:20
.= ( D172 ^ <* ( cyclotomic_poly C236 ) *> ) by L1074 , L1064 , L1087 , L1088 , FINSEQ_5:10;
L1110: ( Product C239 ) = ( ( Product D172 ) * D176 ) by L1109 , GROUP_4:6;
L1111: ( unital_poly (( F_Complex ) , C236) ) = ( Product C239 ) by L1076 , L1077 , L931;
thus L1112: thesis by L1111 , L1108 , L1110 , POLYNOM3:def 10;
end;
theorem
L1113: (for B242 being non  empty (Element of ( NAT )) holds (for B243 being (Element of ( NAT )) holds ((( ( cyclotomic_poly B242 ) . ( 0 ) ) = 1 or ( ( cyclotomic_poly B242 ) . ( 0 ) ) = ( - 1 )) & ( ( cyclotomic_poly B242 ) . B243 ) is  integer)))
proof
deffunc H2(non  empty (Element of ( NAT ))) = ( cyclotomic_poly $1 );
set D180 = (the carrier of ( Polynom-Ring ( F_Complex ) ));
set D181 = (the carrier of ( F_Complex ));
defpred S16[ non  empty (Element of ( NAT )) ] means ((( H2($1) . ( 0 ) ) = 1 or ( H2($1) . ( 0 ) ) = ( - 1 )) & (for B244 being (Element of ( NAT )) holds ( H2($1) . B244 ) is  integer));
L1114: ( - ( 1_ ( F_Complex ) ) ) = ( - 1 ) by COMPLFLD:2 , COMPLFLD:8;
L1115:
now
let C242 being non  empty (Element of ( NAT ));
assume that
L1116: (for B245 being non  empty (Element of ( NAT )) holds (B245 < C242 implies S16[ B245 ]));
L1117: 1 <= C242 by L1;
per cases  by L1117 , XXREAL_0:1;
suppose L1118: C242 = 1;

L1119:
now
let C243 being (Element of ( NAT ));
per cases  by NAT_1:23;
suppose L1120: C243 = ( 0 );

thus L1121: ( H2(C242) . C243 ) is  integer by L1120 , L1114 , L1118 , L915 , POLYNOM5:38;
end;
suppose L1122: C243 = 1;

thus L1123: ( H2(C242) . C243 ) is  integer by L1122 , L1118 , L915 , COMPLFLD:8 , POLYNOM5:38;
end;
suppose L1124: C243 >= 2;

thus L1125: ( H2(C242) . C243 ) is  integer by L1124 , L1118 , L915 , COMPLFLD:7 , POLYNOM5:38;
end;
end;
thus L1127: S16[ C242 ] by L1119 , L1114 , L1118 , L915 , POLYNOM5:38;
end;
suppose L1128: C242 > 1;

consider C244 being (FinSequence of D180), C245 being (Polynomial of ( F_Complex )) such that L1129: C245 = ( Product C244 ) and L1130: ( dom C244 ) = ( Seg C242 ) and L1131: (for B246 being non  empty (Element of ( NAT )) holds (B246 in ( Seg C242 ) implies ((((not B246 divides C242) or B246 = C242) implies ( C244 . B246 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B246 divides C242 & B246 <> C242) implies ( C244 . B246 ) = H2(B246))))) and L1132: ( unital_poly (( F_Complex ) , C242) ) = ( ( cyclotomic_poly C242 ) *' C245 ) by L1063;
defpred S17[ Nat , set ] means (ex B247 being (FinSequence of D180) st (ex B248 being (Polynomial of ( F_Complex )) st (B247 = ( C244 | ( Seg $1 ) ) & B248 = ( Product B247 ) & $2 = B248 & (( B248 . ( 0 ) ) = 1 or ( B248 . ( 0 ) ) = ( - 1 )) & (for B249 being (Element of ( NAT )) holds ( B248 . B249 ) is  integer))));
defpred S18[ (Element of ( NAT )) ] means ($1 in ( Seg ( len C244 ) ) implies (ex B250 being set st S17[ $1 , B250 ]));
L1133: C242 = ( len C244 ) by L1130 , FINSEQ_1:def 3;
L1134: (for B251 being (Element of ( NAT )) holds (S18[ B251 ] implies S18[ ( B251 + 1 ) ]))
proof
let C246 being (Element of ( NAT ));
assume L1135: S18[ C246 ];
assume L1136: ( C246 + 1 ) in ( Seg ( len C244 ) );
per cases ;
suppose L1137: C246 = ( 0 );

reconsider D182 = ( C244 . ( C246 + 1 ) ) as (Element of D180) by L1130 , L1133 , L1136 , FINSEQ_2:11;
reconsider D183 = ( C244 | ( Seg ( C246 + 1 ) ) ) as (FinSequence of D180) by FINSEQ_1:18;
reconsider D184 = ( Product D183 ) as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
L1138: ( <*> D180 ) = ( C244 | (( Seg ( 0 ) ) qua set) );
L1139: D183 = ( ( <*> D180 ) ^ <* ( C244 . ( C246 + 1 ) ) *> ) by L1138 , L1130 , L1133 , L1136 , L1137 , FINSEQ_5:10
.= <* ( C244 . ( C246 + 1 ) ) *> by FINSEQ_1:34;
L1140: D184 = D182 by L1139 , FINSOP_1:11;
take D184;
take D183;
take D184;
thus L1141: (D183 = ( C244 | ( Seg ( C246 + 1 ) ) ) & D184 = ( Product D183 ) & D184 = D184);
L1142: 1 divides C242 by NAT_D:6;
L1143: ( C244 . 1 ) = H2(1) by L1142 , L1128 , L1131 , L1133 , L1136 , L1137;
thus L1144: (( D184 . ( 0 ) ) = 1 or ( D184 . ( 0 ) ) = ( - 1 )) by L1143 , L1114 , L1137 , L1140 , L915 , POLYNOM5:38;
let C247 being (Element of ( NAT ));
thus L1145: ( D184 . C247 ) is  integer
proof
per cases  by NAT_1:23;
suppose L1146: C247 = ( 0 );

thus L1147: thesis by L1146 , L1114 , L1137 , L1140 , L1143 , L915 , POLYNOM5:38;
end;
suppose L1148: C247 = 1;

thus L1149: thesis by L1148 , L1137 , L1140 , L1143 , L915 , COMPLFLD:8 , POLYNOM5:38;
end;
suppose L1150: C247 >= 2;

thus L1151: thesis by L1150 , L1137 , L1140 , L1143 , L915 , COMPLFLD:7 , POLYNOM5:38;
end;
end;

end;
suppose L1146: ( 0 ) < C246;

L1147: (( C246 + 1 ) <= ( len C244 ) & C246 <= ( C246 + 1 )) by L1136 , FINSEQ_1:1 , NAT_1:12;
L1148: C246 <= ( len C244 ) by L1147 , XXREAL_0:2;
L1149: ( ( 0 ) + 1 ) <= C246 by L1146 , NAT_1:13;
consider C248 being set such that L1150: S17[ C246 , C248 ] by L1149 , L1135 , L1148 , FINSEQ_1:1;
reconsider D185 = ( C244 . ( C246 + 1 ) ) as (Element of D180) by L1130 , L1133 , L1136 , FINSEQ_2:11;
reconsider D186 = ( C244 | ( Seg ( C246 + 1 ) ) ) as (FinSequence of D180) by FINSEQ_1:18;
reconsider D187 = ( Product D186 ) as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
take D187;
take D186;
take D187;
thus L1151: (D186 = ( C244 | ( Seg ( C246 + 1 ) ) ) & D187 = ( Product D186 ) & D187 = D187);
reconsider D188 = D185 as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
reconsider D189 = ( - 1 ) as (Element of ( COMPLEX )) by XCMPLX_0:def 2;
consider C249 being (FinSequence of D180), C250 being (Polynomial of ( F_Complex )) such that L1152: C249 = ( C244 | ( Seg C246 ) ) and L1153: C250 = ( Product C249 ) and L1154: C248 = C250 and L1155: (( C250 . ( 0 ) ) = 1 or ( C250 . ( 0 ) ) = ( - 1 )) and L1156: (for B252 being (Element of ( NAT )) holds ( C250 . B252 ) is  integer) by L1150;
L1157: D186 = ( C249 ^ <* D185 *> ) by L1130 , L1133 , L1136 , L1152 , FINSEQ_5:10;
L1158: ( Product D186 ) = ( ( Product C249 ) * D185 ) by L1157 , GROUP_4:6;
L1159: D187 = ( C250 *' D188 ) by L1158 , L1153 , POLYNOM3:def 10;
thus L1160: thesis
proof
per cases ;
suppose L1161: ((not ( C246 + 1 ) divides C242) or ( C246 + 1 ) = C242);

L1162: D188 = <% ( 1_ ( F_Complex ) ) %> by L1161 , L1131 , L1133 , L1136;
consider C251 being (FinSequence of ( F_Complex )) such that L1163: ( len C251 ) = ( ( 0 ) + 1 ) and L1164: ( D187 . ( 0 ) ) = ( Sum C251 ) and L1165: (for B253 being (Element of ( NAT )) holds (B253 in ( dom C251 ) implies ( C251 . B253 ) = ( ( C250 . ( B253 -' 1 ) ) * ( D188 . ( ( ( 0 ) + 1 ) -' B253 ) ) ))) by L1159 , POLYNOM3:def 9;
L1166: 1 in ( dom C251 ) by L1163 , FINSEQ_3:25;
reconsider D190 = ( C251 . 1 ) as (Element of ( F_Complex )) by L1166 , FINSEQ_2:11;
L1167: C251 = <* D190 *> by L1163 , FINSEQ_1:40;
L1168: ( D187 . ( 0 ) ) = D190 by L1167 , L1164 , RLVECT_1:44;
L1169: 1 in ( dom C251 ) by L1163 , FINSEQ_3:25;
L1170: ( D187 . ( 0 ) ) = ( ( C250 . ( 1 -' 1 ) ) * ( D188 . ( ( ( 0 ) + 1 ) -' 1 ) ) ) by L1169 , L1165 , L1168
.= ( ( C250 . ( ( ( 0 ) + 1 ) -' 1 ) ) * ( D188 . ( 0 ) ) ) by NAT_D:34
.= ( ( C250 . ( 0 ) ) * ( D188 . ( 0 ) ) ) by NAT_D:34
.= ( ( C250 . ( 0 ) ) * ( 1_ ( F_Complex ) ) ) by L1162 , POLYNOM5:32;
thus L1171: (( D187 . ( 0 ) ) = 1 or ( D187 . ( 0 ) ) = ( - 1 ))
proof
per cases  by L1155;
suppose L1172: ( C250 . ( 0 ) ) = 1;

thus L1173: thesis by L1172 , L1170 , COMPLFLD:8;
end;
suppose L1174: ( C250 . ( 0 ) ) = ( - 1 );

thus L1175: thesis by L1174 , L1170 , COMPLFLD:8;
end;
end;

let C252 being (Element of ( NAT ));
consider C253 being (FinSequence of ( F_Complex )) such that L1177: ( len C253 ) = ( C252 + 1 ) and L1178: ( D187 . C252 ) = ( Sum C253 ) and L1179: (for B254 being (Element of ( NAT )) holds (B254 in ( dom C253 ) implies ( C253 . B254 ) = ( ( C250 . ( B254 -' 1 ) ) * ( D188 . ( ( C252 + 1 ) -' B254 ) ) ))) by L1159 , POLYNOM3:def 9;
L1180: (for B255 being (Element of ( NAT )) holds (B255 in ( dom C253 ) implies ( C253 . B255 ) is  integer))
proof
let C254 being (Element of ( NAT ));
reconsider D191 = ( C250 . ( C254 -' 1 ) ) as Integer by L1156;
set D192 = ( ( C252 + 1 ) -' C254 );
L1181:
now
L1182: (D192 = ( 0 ) or D192 >= ( ( 0 ) + 1 )) by NAT_1:13;
per cases  by L1182;
case L1183: D192 = ( 0 );
thus L1184: ( D188 . D192 ) = 1 by L1183 , L1162 , COMPLFLD:8 , POLYNOM5:32;
end;
case L1185: D192 >= 1;
thus L1186: ( D188 . D192 ) = ( 0 ) by L1185 , L1162 , COMPLFLD:7 , POLYNOM5:32;
end;
end;
reconsider D193 = ( D188 . ( ( C252 + 1 ) -' C254 ) ) as Integer by L1181;
assume L1188: C254 in ( dom C253 );
L1189: ( C253 . C254 ) = ( ( C250 . ( C254 -' 1 ) ) * ( D188 . ( ( C252 + 1 ) -' C254 ) ) ) by L1188 , L1179
.= ( D191 * D193 );
thus L1190: thesis by L1189;
end;
thus L1191: thesis by L1180 , L1178 , L97;
end;
suppose L1192: (( C246 + 1 ) divides C242 & ( C246 + 1 ) <> C242);

consider C255 being (FinSequence of ( F_Complex )) such that L1193: ( len C255 ) = ( ( 0 ) + 1 ) and L1194: ( D187 . ( 0 ) ) = ( Sum C255 ) and L1195: (for B256 being (Element of ( NAT )) holds (B256 in ( dom C255 ) implies ( C255 . B256 ) = ( ( C250 . ( B256 -' 1 ) ) * ( D188 . ( ( ( 0 ) + 1 ) -' B256 ) ) ))) by L1159 , POLYNOM3:def 9;
L1196: 1 in ( dom C255 ) by L1193 , FINSEQ_3:25;
reconsider D194 = ( C255 . 1 ) as (Element of ( F_Complex )) by L1196 , FINSEQ_2:11;
L1197: C255 = <* D194 *> by L1193 , FINSEQ_1:40;
L1198: ( D187 . ( 0 ) ) = D194 by L1197 , L1194 , RLVECT_1:44;
L1199: 1 in ( dom C255 ) by L1193 , FINSEQ_3:25;
L1200: ( D187 . ( 0 ) ) = ( ( C250 . ( 1 -' 1 ) ) * ( D188 . ( ( ( 0 ) + 1 ) -' 1 ) ) ) by L1199 , L1195 , L1198
.= ( ( C250 . ( ( ( 0 ) + 1 ) -' 1 ) ) * ( D188 . ( 0 ) ) ) by NAT_D:34
.= ( ( C250 . ( 0 ) ) * ( D188 . ( 0 ) ) ) by NAT_D:34;
L1201: ( C246 + 1 ) <= C242 by L1192 , NAT_D:7;
L1202: ( C246 + 1 ) < C242 by L1201 , L1192 , XXREAL_0:1;
L1203: D188 = H2(( C246 + 1 )) by L1131 , L1133 , L1136 , L1192;
reconsider D195 = ( D188 . ( 0 ) ) as Integer by L1203 , L1116 , L1202;
L1204: (D195 = 1 or D195 = D189) by L1116 , L1203 , L1202;
thus L1205: (( D187 . ( 0 ) ) = 1 or ( D187 . ( 0 ) ) = ( - 1 ))
proof
per cases  by L1155;
suppose L1206: ( C250 . ( 0 ) ) = 1;

thus L1207: thesis by L1206 , L1116 , L1203 , L1202 , L1200;
end;
suppose L1208: ( C250 . ( 0 ) ) = ( - 1 );

thus L1209: thesis by L1208 , L1200 , L1204;
end;
end;

let C256 being (Element of ( NAT ));
consider C257 being (FinSequence of ( F_Complex )) such that L1211: ( len C257 ) = ( C256 + 1 ) and L1212: ( D187 . C256 ) = ( Sum C257 ) and L1213: (for B257 being (Element of ( NAT )) holds (B257 in ( dom C257 ) implies ( C257 . B257 ) = ( ( C250 . ( B257 -' 1 ) ) * ( D188 . ( ( C256 + 1 ) -' B257 ) ) ))) by L1159 , POLYNOM3:def 9;
L1214: (for B258 being (Element of ( NAT )) holds (B258 in ( dom C257 ) implies ( C257 . B258 ) is  integer))
proof
let C258 being (Element of ( NAT ));
reconsider D196 = ( D188 . ( ( C256 + 1 ) -' C258 ) ) as Integer by L1116 , L1203 , L1202;
reconsider D197 = ( C250 . ( C258 -' 1 ) ) as Integer by L1156;
assume L1215: C258 in ( dom C257 );
L1216: ( C257 . C258 ) = ( ( C250 . ( C258 -' 1 ) ) * ( D188 . ( ( C256 + 1 ) -' C258 ) ) ) by L1215 , L1213
.= ( D197 * D196 );
thus L1217: thesis by L1216;
end;
thus L1218: thesis by L1214 , L1212 , L97;
end;
end;

end;
end;
defpred S19[ Nat ] means ( H2(C242) . $1 ) is  integer;
L1162: ( ( ( 0 ) + 1 ) -' 1 ) = ( 0 ) by NAT_D:34;
L1163: S18[ ( 0 ) ] by FINSEQ_1:1;
L1164: (for B259 being (Element of ( NAT )) holds S18[ B259 ]) from NAT_1:sch 1(L1163 , L1134);
L1165: (for B260 being Nat holds (B260 in ( Seg ( len C244 ) ) implies (ex B261 being set st S17[ B260 , B261 ]))) by L1164;
consider C259 being FinSequence such that L1166: ( dom C259 ) = ( Seg ( len C244 ) ) and L1167: (for B262 being Nat holds (B262 in ( Seg ( len C244 ) ) implies S17[ B262 , ( C259 . B262 ) ])) from FINSEQ_1:sch 1(L1165);
consider C260 being (FinSequence of D180), C261 being (Polynomial of ( F_Complex )) such that L1168: (C260 = ( C244 | ( Seg C242 ) ) & C261 = ( Product C260 )) and L1169: ( C259 . C242 ) = C261 and L1170: (( C261 . ( 0 ) ) = 1 or ( C261 . ( 0 ) ) = ( - 1 )) and L1171: (for B263 being (Element of ( NAT )) holds ( C261 . B263 ) is  integer) by L1133 , L1167 , FINSEQ_1:3;
L1172: C245 = C261 by L1129 , L1133 , L1168 , FINSEQ_3:49;
L1173:
now
let C262 being Nat;
reconsider D198 = C262 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C263 being (FinSequence of D181) such that L1174: ( len C263 ) = ( C262 + 1 ) and L1175: ( ( unital_poly (( F_Complex ) , C242) ) . C262 ) = ( Sum C263 ) and L1176: (for B264 being (Element of ( NAT )) holds (B264 in ( dom C263 ) implies ( C263 . B264 ) = ( ( C245 . ( B264 -' 1 ) ) * ( H2(C242) . ( ( D198 + 1 ) -' B264 ) ) ))) by L1132 , POLYNOM3:def 9;
reconsider D199 = ( Sum C263 ) as (Element of ( COMPLEX )) by COMPLFLD:def 1;
L1177:
now
per cases ;
suppose L1178: D198 = ( 0 );

thus L1179: D199 is  integer by L1178 , L1114 , L1175 , L715;
end;
suppose L1180: D198 = C242;

thus L1181: D199 is  integer by L1180 , L1175 , L715 , COMPLFLD:8;
end;
suppose L1182: (D198 <> ( 0 ) & D198 <> C242);

thus L1183: D199 is  integer by L1182 , L1175 , L721 , COMPLFLD:7;
end;
end;
reconsider D200 = D199 as Integer by L1177;
L1185: ( ( (1 , 1) -cut C263 ) ^ ( (( 1 + 1 ) , ( len C263 )) -cut C263 ) ) = C263 by L1174 , GRAPH_2:9 , NAT_1:11;
set D201 = ( (( 1 + 1 ) , ( len C263 )) -cut C263 );
reconsider D202 = ( Sum D201 ) as (Element of ( COMPLEX )) by COMPLFLD:def 1;
assume L1186: (for B265 being Nat holds (B265 < C262 implies S19[ B265 ]));
L1187:
now
let C264 being (Element of ( NAT ));
assume L1188: C264 in ( dom D201 );
per cases ;
suppose L1189: ( len C263 ) < 2;

L1190: D201 = ( {} ) by L1189 , GRAPH_2:def 1;
thus L1191: ( D201 . C264 ) is  integer by L1190;
end;
suppose L1192: ( 1 + 1 ) <= ( len C263 );

L1193: ( ( len D201 ) + ( 1 + 1 ) ) = ( ( len C263 ) + 1 ) by L1192 , GRAPH_2:def 1;
per cases ;
suppose L1194: C262 = ( 0 );

thus L1195: ( D201 . C264 ) is  integer by L1194 , L1174 , L1192;
end;
suppose L1196: C262 > ( 0 );

L1197: C264 <> ( 0 ) by L1188 , FINSEQ_3:25;
reconsider D203 = ( H2(C242) . ( C262 -' C264 ) ) as Integer by L1197 , L1186 , L1196 , NAT_2:9;
reconsider D204 = ( C245 . C264 ) as Integer by L1171 , L1172;
L1198: C264 <> ( 0 ) by L1188 , FINSEQ_3:25;
consider C265 being Nat such that L1199: C264 = ( C265 + 1 ) by L1198 , NAT_1:6;
L1200: C264 <= ( len D201 ) by L1188 , FINSEQ_3:25;
L1201: (1 <= ( C264 + 1 ) & ( C264 + 1 ) <= ( ( len D201 ) + 1 )) by L1200 , NAT_1:11 , XREAL_1:6;
L1202: ( 1 + C264 ) in ( dom C263 ) by L1201 , L1193 , FINSEQ_3:25;
L1203: ( C263 . ( 1 + C264 ) ) = ( ( C245 . ( ( 1 + C264 ) -' 1 ) ) * ( H2(C242) . ( ( C262 + 1 ) -' ( 1 + C264 ) ) ) ) by L1202 , L1176
.= ( ( C245 . ( ( C264 + 1 ) -' 1 ) ) * ( H2(C242) . ( ( ( C262 + 1 ) -' 1 ) -' C264 ) ) ) by NAT_2:30
.= ( ( C245 . C264 ) * ( H2(C242) . ( ( ( C262 + 1 ) -' 1 ) -' C264 ) ) ) by NAT_D:34
.= ( D204 * D203 ) by NAT_D:34;
L1204: C265 < ( len D201 ) by L1200 , L1199 , NAT_1:13;
L1205: ( D201 . C264 ) = ( C263 . ( ( 1 + 1 ) + C265 ) ) by L1204 , L1192 , L1199 , GRAPH_2:def 1
.= ( C263 . ( 1 + C264 ) ) by L1199;
thus L1206: ( D201 . C264 ) is  integer by L1205 , L1203;
end;
end;
end;
reconsider D205 = D202 as Integer by L1187 , L97;
L1209: 1 <= ( len C263 ) by L1174 , NAT_1:11;
L1210: 1 in ( dom C263 ) by L1209 , FINSEQ_3:25;
reconsider D206 = ( C263 . 1 ) as (Element of D181) by L1210 , FINSEQ_2:11;
reconsider D207 = D206 as (Element of ( COMPLEX )) by COMPLFLD:def 1;
L1211: ( (1 , 1) -cut C263 ) = <* D206 *> by L1209 , GRAPH_2:6;
L1212: ( Sum C263 ) = ( D206 + ( Sum D201 ) ) by L1211 , L1185 , FVSUM_1:72;
L1213: D207 = ( D200 - D205 ) by L1212;
reconsider D208 = D206 as Integer by L1213;
L1214: D208 = ( ( C245 . ( 1 -' 1 ) ) * ( H2(C242) . ( ( C262 + 1 ) -' 1 ) ) ) by L1176 , L1210
.= ( ( C245 . ( 0 ) ) * ( H2(C242) . D198 ) ) by L1162 , NAT_D:34;
per cases  by L1129 , L1133 , L1168 , L1170 , FINSEQ_3:49;
suppose L1215: ( C245 . ( 0 ) ) = 1;

thus L1216: S19[ C262 ] by L1215 , L1214;
end;
suppose L1217: ( C245 . ( 0 ) ) = ( - 1 );

L1218: D206 = ( ( - ( 1_ ( F_Complex ) ) ) * ( H2(C242) . D198 ) ) by L1217 , L1214 , COMPLFLD:2 , COMPLFLD:8
.= ( - ( ( 1_ ( F_Complex ) ) * ( H2(C242) . D198 ) ) ) by VECTSP_1:9
.= ( - ( H2(C242) . D198 ) ) by VECTSP_1:def 8;
L1219: ( 0. ( F_Complex ) ) = ( ( - ( H2(C242) . D198 ) ) + ( - D206 ) ) by L1218 , RLVECT_1:def 10
.= ( ( - D206 ) - ( H2(C242) . D198 ) );
L1220: ( - D206 ) = ( H2(C242) . C262 ) by L1219 , VECTSP_1:19;
L1221: ( - D208 ) = ( H2(C242) . C262 ) by L1220 , COMPLFLD:2;
thus L1222: S19[ C262 ] by L1221;
end;
end;
L1224: (for B266 being Nat holds S19[ B266 ]) from NAT_1:sch 4(L1173);
consider C266 being (FinSequence of D181) such that L1225: ( len C266 ) = ( ( 0 ) + 1 ) and L1226: ( ( unital_poly (( F_Complex ) , C242) ) . ( 0 ) ) = ( Sum C266 ) and L1227: (for B267 being (Element of ( NAT )) holds (B267 in ( dom C266 ) implies ( C266 . B267 ) = ( ( C245 . ( B267 -' 1 ) ) * ( H2(C242) . ( ( ( 0 ) + 1 ) -' B267 ) ) ))) by L1132 , POLYNOM3:def 9;
L1228: 1 in ( dom C266 ) by L1225 , FINSEQ_3:25;
reconsider D209 = ( C266 . 1 ) as (Element of D181) by L1228 , FINSEQ_2:11;
L1229: C266 = <* D209 *> by L1225 , FINSEQ_1:40;
L1230: ( Sum C266 ) = ( C266 . 1 ) by L1229 , RLVECT_1:44
.= ( ( C245 . ( 0 ) ) * ( H2(C242) . ( 0 ) ) ) by L1227 , L1162 , L1228;
L1231: (( H2(C242) . ( 0 ) ) = 1 or ( H2(C242) . ( 0 ) ) = ( - 1 ))
proof
per cases  by L1129 , L1133 , L1168 , L1170 , FINSEQ_3:49;
suppose L1232: ( C245 . ( 0 ) ) = 1;

thus L1233: thesis by L1232 , L1114 , L1226 , L1230 , L715;
end;
suppose L1234: ( C245 . ( 0 ) ) = ( - 1 );

L1235: ( - ( 1_ ( F_Complex ) ) ) = ( ( - ( 1_ ( F_Complex ) ) ) * ( H2(C242) . ( 0 ) ) ) by L1234 , L1114 , L1226 , L1230 , L715
.= ( - ( ( 1_ ( F_Complex ) ) * ( H2(C242) . ( 0 ) ) ) ) by VECTSP_1:9
.= ( - ( H2(C242) . ( 0 ) ) ) by VECTSP_1:def 8;
thus L1236: thesis by L1235 , COMPLFLD:8 , RLVECT_1:18;
end;
end;
thus L1238: S16[ C242 ] by L1231 , L1224;
end;
end;
L1240: (for B268 being non  empty (Element of ( NAT )) holds S16[ B268 ]) from CompIndNE(L1115);
thus L1241: thesis by L1240;
end;
theorem
L1242: (for B269 being non  empty (Element of ( NAT )) holds (for B270 being (Element of ( F_Complex )) holds (B270 is Integer implies ( eval (( cyclotomic_poly B269 ) , B270) ) is Integer)))
proof
let C267 being non  empty (Element of ( NAT ));
let C268 being (Element of ( F_Complex ));
assume that
L1243: C268 is Integer;
set D210 = ( cyclotomic_poly C267 );
consider C269 being (FinSequence of ( F_Complex )) such that L1244: ( eval (D210 , C268) ) = ( Sum C269 ) and L1245: ( len C269 ) = ( len D210 ) and L1246: (for B271 being (Element of ( NAT )) holds (B271 in ( dom C269 ) implies ( C269 . B271 ) = ( ( D210 . ( B271 -' 1 ) ) * ( ( power ( F_Complex ) ) . (C268 , ( B271 -' 1 )) ) ))) by POLYNOM4:def 2;
L1247: (for B272 being (Element of ( NAT )) holds (B272 in ( dom C269 ) implies ( C269 . B272 ) is Integer))
proof
let C270 being (Element of ( NAT ));
assume L1248: C270 in ( dom C269 );
L1249: ( C269 . C270 ) = ( ( D210 . ( C270 -' 1 ) ) * ( ( power ( F_Complex ) ) . (C268 , ( C270 -' 1 )) ) ) by L1248 , L1246;
reconsider D211 = ( ( power ( F_Complex ) ) . (C268 , ( C270 -' 1 )) ) as Integer by L1243 , L224;
reconsider D212 = ( D210 . ( C270 -' 1 ) ) as Integer by L1113;
L1250: ( C269 . C270 ) = ( D212 * D211 ) by L1249;
thus L1251: thesis by L1250;
end;
thus L1252: thesis by L1247 , L1244 , L233;
end;
theorem
L1253: (for B273 , B274 being non  empty (Element of ( NAT )) holds (for B275 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds (for B276 being  finite (Subset of ( F_Complex )) holds ((B276 = { B277 where B277 is (Element of ( MultGroup ( F_Complex ) )) : (( ord B277 ) divides B273 & (not ( ord B277 ) divides B274) & ( ord B277 ) <> B273) } & ( dom B275 ) = ( Seg B273 ) & (for B278 being non  empty (Element of ( NAT )) holds (B278 in ( dom B275 ) implies ((((not B278 divides B273) or B278 divides B274 or B278 = B273) implies ( B275 . B278 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B278 divides B273 & (not B278 divides B274) & B278 <> B273) implies ( B275 . B278 ) = ( cyclotomic_poly B278 )))))) implies ( Product B275 ) = ( poly_with_roots ( (B276 , 1) -bag ) )))))
proof
set D213 = (the carrier of ( MultGroup ( F_Complex ) ));
set D214 = (the carrier of ( Polynom-Ring ( F_Complex ) ));
let C271 , C272 being non  empty (Element of ( NAT ));
let C273 being (FinSequence of D214);
let C274 being  finite (Subset of ( F_Complex ));
assume that
L1254: C274 = { B279 where B279 is (Element of D213) : (( ord B279 ) divides C271 & (not ( ord B279 ) divides C272) & ( ord B279 ) <> C271) }
and
L1255: ( dom C273 ) = ( Seg C271 )
and
L1256: (for B280 being non  empty (Element of ( NAT )) holds (B280 in ( dom C273 ) implies ((((not B280 divides C271) or B280 divides C272 or B280 = C271) implies ( C273 . B280 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B280 divides C271 & (not B280 divides C272) & B280 <> C271) implies ( C273 . B280 ) = ( cyclotomic_poly B280 )))));
deffunc H3(Nat) = { B281 where B281 is (Element of D213) : (B281 in C274 & ( ord B281 ) <= $1) };
L1257:
now
let C275 being (Element of ( NAT ));
L1258: H3(C275) c= C274
proof
let C276 being set;
assume L1259: C276 in H3(C275);
L1260: (ex B282 being (Element of D213) st (C276 = B282 & B282 in C274 & ( ord B282 ) <= C275)) by L1259;
thus L1261: thesis by L1260;
end;
thus L1262: H3(C275) is  finite  finite  finite  finite (Subset of ( F_Complex )) by L1258 , XBOOLE_1:1;
end;
reconsider D215 = H3(C271) as  finite (Subset of ( F_Complex )) by L1257;
L1263: ( len C273 ) = C271 by L1255 , FINSEQ_1:def 3;
defpred S20[ Nat , set ] means (for B283 being (FinSequence of D214) holds (B283 = ( C273 | ( Seg $1 ) ) implies $2 = ( Product B283 )));
L1264:
now
let C277 being Nat;
assume L1265: C277 in ( Seg ( len C273 ) );
reconsider D216 = ( C273 | ( Seg C277 ) ) as (FinSequence of D214) by FINSEQ_1:18;
set D217 = ( Product D216 );
take D218 = D217;
thus L1266: S20[ C277 , D218 ];
end;
consider C278 being (FinSequence of D214) such that L1267: ( dom C278 ) = ( Seg ( len C273 ) ) and L1268: (for B284 being Nat holds (B284 in ( Seg ( len C273 ) ) implies S20[ B284 , ( C278 . B284 ) ])) from FINSEQ_1:sch 5(L1264);
defpred S21[ (Element of ( NAT )) ] means (ex B285 being  finite (Subset of ( F_Complex )) st (B285 = H3($1) & ( C278 . $1 ) = ( poly_with_roots ( (B285 , 1) -bag ) )));
L1269: (for B286 being (Element of ( NAT )) holds ((1 <= B286 & B286 < ( len C273 )) implies (S21[ B286 ] implies S21[ ( B286 + 1 ) ])))
proof
let C279 being (Element of ( NAT ));
assume that
L1270: 1 <= C279
and
L1271: C279 < ( len C273 )
and
L1272: S21[ C279 ];
reconsider D219 = ( C273 | ( Seg C279 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
L1273: C279 in ( Seg ( len C273 ) ) by L1270 , L1271 , FINSEQ_1:1;
L1274: ( C278 . C279 ) = ( Product D219 ) by L1273 , L1268;
reconsider D220 = ( C273 | ( Seg ( C279 + 1 ) ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
L1275: ( C279 + 1 ) <= ( len C273 ) by L1271 , NAT_1:13;
L1276: ( C279 + 1 ) = ( min (( C279 + 1 ) , ( len C273 )) ) by L1275 , XXREAL_0:def 9;
L1277: ( len D220 ) = ( C279 + 1 ) by L1276 , FINSEQ_2:21;
reconsider D221 = H3(( C279 + 1 )) as  finite (Subset of ( F_Complex )) by L1257;
take D221;
thus L1278: D221 = H3(( C279 + 1 ));
set D222 = ( (D221 , 1) -bag );
consider C280 being  finite (Subset of ( F_Complex )) such that L1279: C280 = H3(C279) and L1280: ( C278 . C279 ) = ( poly_with_roots ( (C280 , 1) -bag ) ) by L1272;
L1281: 1 <= ( C279 + 1 ) by L1270 , NAT_1:13;
L1282: ( C279 + 1 ) in ( Seg ( len C273 ) ) by L1281 , L1275 , FINSEQ_1:1;
L1283: ( C279 + 1 ) in ( dom C273 ) by L1282 , FINSEQ_1:def 3;
L1284: ( ( C273 | ( Seg ( C279 + 1 ) ) ) . ( C279 + 1 ) ) = ( C273 . ( C279 + 1 ) ) by FINSEQ_1:4 , FUNCT_1:49;
reconsider D223 = ( D220 . ( C279 + 1 ) ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by L1284 , L1283 , FINSEQ_2:11;
reconsider D224 = D223 as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
L1285: ( C278 . ( C279 + 1 ) ) = ( Product D220 ) by L1268 , L1282;
set D225 = ( (C280 , 1) -bag );
L1286: D219 = ( D220 | ( Seg C279 ) ) by L32 , NAT_1:12;
L1287: D220 = ( D219 ^ <* D223 *> ) by L1286 , L1277 , FINSEQ_3:55;
L1288: ( Product D220 ) = ( ( Product D219 ) * D223 ) by L1287 , GROUP_4:6;
L1289: ( Product D220 ) = ( ( poly_with_roots D225 ) *' D224 ) by L1288 , L1274 , L1280 , POLYNOM3:def 10;
per cases ;
suppose L1290: ((not ( C279 + 1 ) divides C271) or ( C279 + 1 ) divides C272 or ( C279 + 1 ) = C271);

L1291:
now
let C281 being set;
thus L1292:now
assume L1293: C281 in D221;
consider C282 being (Element of ( MultGroup ( F_Complex ) )) such that L1294: C281 = C282 and L1295: C282 in C274 and L1296: ( ord C282 ) <= ( C279 + 1 ) by L1293;
L1297: (ex B287 being (Element of D213) st (C282 = B287 & ( ord B287 ) divides C271 & (not ( ord B287 ) divides C272) & ( ord B287 ) <> C271)) by L1254 , L1295;
L1298: ( ord C282 ) < ( C279 + 1 ) by L1297 , L1290 , L1296 , XXREAL_0:1;
L1299: ( ord C282 ) <= C279 by L1298 , NAT_1:13;
thus L1300: C281 in C280 by L1299 , L1279 , L1294 , L1295;
end;
assume L1301: C281 in C280;
consider C283 being (Element of ( MultGroup ( F_Complex ) )) such that L1302: (C281 = C283 & C283 in C274) and L1303: ( ord C283 ) <= C279 by L1301 , L1279;
L1304: ( ord C283 ) <= ( C279 + 1 ) by L1303 , NAT_1:12;
thus L1305: C281 in D221 by L1304 , L1302;
end;
L1306: ( C273 . ( C279 + 1 ) ) = <% ( 1_ ( F_Complex ) ) %> by L1256 , L1283 , L1290;
L1307: ( C278 . ( C279 + 1 ) ) = ( poly_with_roots D225 ) by L1306 , L1285 , L1284 , L1289 , UPROOTS:32
.= ( poly_with_roots D222 ) by L1291 , TARSKI:1;
thus L1308: thesis by L1307;
end;
suppose L1309: (( C279 + 1 ) divides C271 & (not ( C279 + 1 ) divides C272) & ( C279 + 1 ) <> C271);

consider C284 being non  empty  finite (Subset of ( F_Complex )) such that L1310: C284 = { B288 where B288 is (Element of D213) : ( ord B288 ) = ( C279 + 1 ) } and L1311: ( cyclotomic_poly ( C279 + 1 ) ) = ( poly_with_roots ( (C284 , 1) -bag ) ) by L897;
L1312:
now
let C285 being set;
thus L1313:now
assume L1314: C285 in D221;
consider C286 being (Element of D213) such that L1315: C285 = C286 and L1316: C286 in C274 and L1317: ( ord C286 ) <= ( C279 + 1 ) by L1314;
L1318: (( ord C286 ) <= C279 or ( ord C286 ) = ( C279 + 1 )) by L1317 , NAT_1:8;
L1319: (C286 in C280 or C286 in C284) by L1318 , L1279 , L1310 , L1316;
thus L1320: C285 in ( C280 \/ C284 ) by L1319 , L1315 , XBOOLE_0:def 3;
end;
assume L1321: C285 in ( C280 \/ C284 );
per cases  by L1321 , XBOOLE_0:def 3;
suppose L1322: C285 in C280;

consider C287 being (Element of D213) such that L1323: (C285 = C287 & C287 in C274) and L1324: ( ord C287 ) <= C279 by L1322 , L1279;
L1325: ( ord C287 ) <= ( C279 + 1 ) by L1324 , NAT_1:12;
thus L1326: C285 in D221 by L1325 , L1323;
end;
suppose L1327: C285 in C284;

consider C288 being (Element of D213) such that L1328: C285 = C288 and L1329: ( ord C288 ) = ( C279 + 1 ) by L1327 , L1310;
L1330: C288 in C274 by L1254 , L1309 , L1329;
thus L1331: C285 in D221 by L1330 , L1328 , L1329;
end;
end;
L1333: D221 = ( C280 \/ C284 ) by L1312 , TARSKI:1;
set D226 = ( (C284 , 1) -bag );
L1334: C280 misses C284
proof
assume L1335: ( C280 /\ C284 ) <> ( {} );
consider C289 being set such that L1336: C289 in ( C280 /\ C284 ) by L1335 , XBOOLE_0:def 1;
L1337: C289 in C284 by L1336 , XBOOLE_0:def 4;
L1338: (ex B289 being (Element of D213) st (C289 = B289 & ( ord B289 ) = ( C279 + 1 ))) by L1337 , L1310;
L1339: C289 in C280 by L1336 , XBOOLE_0:def 4;
L1340: (ex B290 being (Element of D213) st (C289 = B290 & B290 in C274 & ( ord B290 ) <= C279)) by L1339 , L1279;
thus L1341: contradiction by L1340 , L1338 , NAT_1:13;
end;
L1342: ( C273 . ( C279 + 1 ) ) = ( poly_with_roots D226 ) by L1256 , L1283 , L1309 , L1311;
L1343: ( C278 . ( C279 + 1 ) ) = ( ( poly_with_roots D225 ) *' ( poly_with_roots D226 ) ) by L1342 , L1268 , L1282 , L1284 , L1289
.= ( poly_with_roots ( D225 + D226 ) ) by UPROOTS:64
.= ( poly_with_roots D222 ) by L1333 , L1334 , UPROOTS:10;
thus L1344: thesis by L1343;
end;
end;
L1346:
now
let C290 being set;
thus L1347:now
assume L1348: C290 in C274;
consider C291 being (Element of ( MultGroup ( F_Complex ) )) such that L1349: C290 = C291 and L1350: ( ord C291 ) divides C271 and L1351: (not ( ord C291 ) divides C272) and L1352: ( ord C291 ) <> C271 by L1348 , L1254;
L1353: ( ord C291 ) <= C271 by L1350 , NAT_D:7;
thus L1354: C290 in D215 by L1353 , L1348 , L1349;
end;
assume L1355: C290 in D215;
L1356: (ex B291 being (Element of ( MultGroup ( F_Complex ) )) st (B291 = C290 & B291 in C274 & ( ord B291 ) <= C271)) by L1355;
thus L1357: C290 in C274 by L1356;
end;
L1358: C274 = D215 by L1346 , TARSKI:1;
L1359: ( ( 0 ) + 1 ) <= C271 by NAT_1:13;
L1360: S21[ 1 ]
proof
reconsider D227 = H3(1) as  finite (Subset of ( F_Complex )) by L1257;
take D227;
thus L1361: D227 = H3(1);
reconsider D228 = ( C273 | ( Seg 1 ) ) as (FinSequence of D214) by FINSEQ_1:18;
L1362: 1 in ( dom C273 ) by L1263 , L1359 , FINSEQ_3:25;
L1363: 1 divides C272 by NAT_D:6;
L1364:
now
assume L1365: D227 is non  empty;
consider C292 being set such that L1366: C292 in D227 by L1365 , XBOOLE_0:def 1;
consider C293 being (Element of D213) such that L1367: C292 = C293 and L1368: C293 in C274 and L1369: ( ord C293 ) <= 1 by L1366;
consider C294 being (Element of D213) such that L1370: C293 = C294 and L1371: ( ord C294 ) divides C271 and L1372: (not ( ord C294 ) divides C272) and L1373: ( ord C294 ) <> C271 by L1254 , L1368;
L1374:
now
assume L1375: ( ord C294 ) = ( 0 );
L1376: (ex B292 being Nat st C271 = ( ( 0 ) * B292 )) by L1375 , L1371 , NAT_D:def 3;
thus L1377: contradiction by L1376;
end;
L1378: ( ( 0 ) + 1 ) <= ( ord C294 ) by L1374 , NAT_1:13;
thus L1379: contradiction by L1378 , L1363 , L1369 , L1370 , L1372 , XXREAL_0:1;
end;
L1380: ( (D227 , 1) -bag ) = ( EmptyBag (the carrier of ( F_Complex )) ) by L1364 , UPROOTS:9;
L1381: 1 in ( Seg ( len C273 ) ) by L1263 , L1359 , FINSEQ_1:1;
L1382: 1 in ( dom C273 ) by L1381 , FINSEQ_1:def 3;
reconsider D229 = ( C273 . 1 ) as (Element of D214) by L1382 , FINSEQ_2:11;
L1383: D228 = <* ( C273 . 1 ) *> by L1263 , L1359 , L23;
L1384: ( C278 . 1 ) = ( Product <* D229 *> ) by L1383 , L1268 , L1381
.= D229 by FINSOP_1:11
.= <% ( 1_ ( F_Complex ) ) %> by L1256 , L1362 , L1363;
thus L1385: thesis by L1384 , L1380 , UPROOTS:60;
end;
L1386: (for B293 being (Element of ( NAT )) holds ((1 <= B293 & B293 <= ( len C273 )) implies S21[ B293 ])) from INT_1:sch 7(L1360 , L1269);
L1387: (C273 = ( C273 | ( Seg ( len C273 ) ) ) & (ex B294 being  finite (Subset of ( F_Complex )) st (B294 = H3(( len C273 )) & ( C278 . ( len C273 ) ) = ( poly_with_roots ( (B294 , 1) -bag ) )))) by L1386 , L1263 , L1359 , FINSEQ_3:49;
thus L1388: thesis by L1387 , L1263 , L1268 , L1358 , FINSEQ_1:3;
end;
theorem
L1389: (for B295 , B296 being non  empty (Element of ( NAT )) holds ((B296 < B295 & B296 divides B295) implies (ex B297 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) st (ex B298 being (Polynomial of ( F_Complex )) st (B298 = ( Product B297 ) & ( dom B297 ) = ( Seg B295 ) & (for B299 being non  empty (Element of ( NAT )) holds (B299 in ( Seg B295 ) implies ((((not B299 divides B295) or B299 divides B296 or B299 = B295) implies ( B297 . B299 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B299 divides B295 & (not B299 divides B296) & B299 <> B295) implies ( B297 . B299 ) = ( cyclotomic_poly B299 ))))) & ( unital_poly (( F_Complex ) , B295) ) = ( ( ( unital_poly (( F_Complex ) , B296) ) *' ( cyclotomic_poly B295 ) ) *' B298 ))))))
proof
set D230 = (the carrier of ( MultGroup ( F_Complex ) ));
set D231 = (the carrier of ( Polynom-Ring ( F_Complex ) ));
let C295 , C296 being non  empty (Element of ( NAT ));
assume that
L1390: C296 < C295
and
L1391: C296 divides C295;
set D232 = { B300 where B300 is (Element of D230) : (( ord B300 ) divides C295 & (not ( ord B300 ) divides C296) & ( ord B300 ) <> C295) };
L1392: D232 c= ( C295 -roots_of_1 )
proof
let C297 being set;
assume L1393: C297 in D232;
L1394: (ex B301 being (Element of D230) st (C297 = B301 & ( ord B301 ) divides C295 & (not ( ord B301 ) divides C296) & ( ord B301 ) <> C295)) by L1393;
thus L1395: thesis by L1394 , L596;
end;
reconsider D233 = D232 as  finite (Subset of ( F_Complex )) by L1392 , XBOOLE_1:1;
L1396: ( C295 -roots_of_1 ) c= D230 by L583;
set D234 = ( (D233 , 1) -bag );
defpred S22[ set , set ] means (ex B302 being non  empty Nat st ($1 = B302 & (((not B302 divides C295) or B302 divides C296 or B302 = C295) implies $2 = <% ( 1_ ( F_Complex ) ) %>) & ((B302 divides C295 & (not B302 divides C296) & B302 <> C295) implies $2 = ( cyclotomic_poly B302 ))));
L1397:
now
let C298 being Nat;
assume L1398: C298 in ( Seg C295 );
L1399: C298 is non  empty by L1398 , FINSEQ_1:1;
per cases ;
suppose L1400: ((not C298 divides C295) or C298 divides C296 or C298 = C295);

L1401: <% ( 1_ ( F_Complex ) ) %> is (Element of D231) by POLYNOM3:def 10;
thus L1402: (ex B303 being (Element of D231) st S22[ C298 , B303 ]) by L1401 , L1399 , L1400;
end;
suppose L1403: (C298 divides C295 & (not C298 divides C296) & C298 <> C295);

reconsider D235 = C298 as non  empty (Element of ( NAT )) by L1398 , FINSEQ_1:1;
L1404: ( cyclotomic_poly D235 ) is (Element of D231) by POLYNOM3:def 10;
thus L1405: (ex B304 being (Element of D231) st S22[ C298 , B304 ]) by L1404 , L1403;
end;
end;
consider C299 being (FinSequence of D231) such that L1407: ( dom C299 ) = ( Seg C295 ) and L1408: (for B305 being Nat holds (B305 in ( Seg C295 ) implies S22[ B305 , ( C299 . B305 ) ])) from FINSEQ_1:sch 5(L1397);
L1409:
now
let C300 being non  empty (Element of ( NAT ));
assume L1410: C300 in ( Seg C295 );
L1411: (ex B306 being non  empty Nat st (C300 = B306 & (((not B306 divides C295) or B306 divides C296 or B306 = C295) implies ( C299 . C300 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B306 divides C295 & (not B306 divides C296) & B306 <> C295) implies ( C299 . C300 ) = ( cyclotomic_poly B306 )))) by L1410 , L1408;
thus L1412: ((((not C300 divides C295) or C300 divides C296 or C300 = C295) implies ( C299 . C300 ) = <% ( 1_ ( F_Complex ) ) %>) & ((C300 divides C295 & (not C300 divides C296) & C300 <> C295) implies ( C299 . C300 ) = ( cyclotomic_poly C300 ))) by L1411;
end;
L1413: ( Product C299 ) = ( poly_with_roots D234 ) by L1409 , L1407 , L1253;
reconsider D236 = ( Product C299 ) as (Polynomial of ( F_Complex )) by L1413;
take C299;
take D236;
thus L1414: D236 = ( Product C299 );
thus L1415: ( dom C299 ) = ( Seg C295 ) by L1407;
thus L1416: (for B307 being non  empty (Element of ( NAT )) holds (B307 in ( Seg C295 ) implies ((((not B307 divides C295) or B307 divides C296 or B307 = C295) implies ( C299 . B307 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B307 divides C295 & (not B307 divides C296) & B307 <> C295) implies ( C299 . B307 ) = ( cyclotomic_poly B307 ))))) by L1409;
set D237 = ( (( C295 -roots_of_1 ) , 1) -bag );
set D238 = ( (( C296 -roots_of_1 ) , 1) -bag );
consider C301 being non  empty  finite (Subset of ( F_Complex )) such that L1417: C301 = { B308 where B308 is (Element of D230) : ( ord B308 ) = C295 } and L1418: ( cyclotomic_poly C295 ) = ( poly_with_roots ( (C301 , 1) -bag ) ) by L897;
set D239 = ( (C301 , 1) -bag );
L1419: ( C296 -roots_of_1 ) misses C301
proof
assume L1420: ( ( C296 -roots_of_1 ) /\ C301 ) <> ( {} );
consider C302 being set such that L1421: C302 in ( ( C296 -roots_of_1 ) /\ C301 ) by L1420 , XBOOLE_0:def 1;
L1422: C302 in C301 by L1421 , XBOOLE_0:def 4;
L1423: (ex B309 being (Element of D230) st (C302 = B309 & ( ord B309 ) = C295)) by L1422 , L1417;
L1424: C302 in ( C296 -roots_of_1 ) by L1421 , XBOOLE_0:def 4;
L1425: (ex B310 being (Element of D230) st (C302 = B310 & ( ord B310 ) divides C296)) by L1424 , L625;
thus L1426: contradiction by L1425 , L1390 , L1423 , NAT_D:7;
end;
L1427: ( D238 + D239 ) = ( (( ( C296 -roots_of_1 ) \/ C301 ) , 1) -bag ) by L1419 , UPROOTS:10;
set D240 = ( ( C296 -roots_of_1 ) \/ C301 );
reconsider D241 = D240 as  finite (Subset of ( F_Complex ));
L1428: ( C296 -roots_of_1 ) c= ( C295 -roots_of_1 ) by L1391 , L507;
L1429:
now
let C303 being set;
thus L1430:now
assume L1431: C303 in ( C295 -roots_of_1 );
reconsider D242 = C303 as (Element of D230) by L1431 , L1396;
L1432: ( ord D242 ) divides C295 by L1431 , L596;
per cases ;
suppose L1433: ( ord D242 ) = C295;

L1434: D242 in C301 by L1433 , L1417;
L1435: D242 in D241 by L1434 , XBOOLE_0:def 3;
thus L1436: C303 in ( D241 \/ D233 ) by L1435 , XBOOLE_0:def 3;
end;
suppose L1437: (( ord D242 ) <> C295 & (not ( ord D242 ) divides C296));

L1438: D242 in D233 by L1437 , L1432;
thus L1439: C303 in ( D241 \/ D233 ) by L1438 , XBOOLE_0:def 3;
end;
suppose L1440: (( ord D242 ) <> C295 & ( ord D242 ) divides C296);

L1441: C303 in ( C296 -roots_of_1 ) by L1440 , L596;
L1442: C303 in D241 by L1441 , XBOOLE_0:def 3;
thus L1443: C303 in ( D241 \/ D233 ) by L1442 , XBOOLE_0:def 3;
end;
end;
assume L1445: C303 in ( D241 \/ D233 );
L1446: (C303 in D241 or C303 in D233) by L1445 , XBOOLE_0:def 3;
per cases  by L1446 , XBOOLE_0:def 3;
suppose L1447: C303 in ( C296 -roots_of_1 );

thus L1448: C303 in ( C295 -roots_of_1 ) by L1447 , L1428;
end;
suppose L1449: C303 in C301;

L1450: (ex B311 being (Element of D230) st (C303 = B311 & ( ord B311 ) = C295)) by L1449 , L1417;
thus L1451: C303 in ( C295 -roots_of_1 ) by L1450 , L596;
end;
suppose L1452: C303 in D233;

L1453: (ex B312 being (Element of D230) st (C303 = B312 & ( ord B312 ) divides C295 & (not ( ord B312 ) divides C296) & ( ord B312 ) <> C295)) by L1452;
thus L1454: C303 in ( C295 -roots_of_1 ) by L1453 , L596;
end;
end;
L1456: ( C295 -roots_of_1 ) = ( D241 \/ D233 ) by L1429 , TARSKI:1;
set D243 = ( (D241 , 1) -bag );
L1457: ( unital_poly (( F_Complex ) , C296) ) = ( poly_with_roots D238 ) by L888;
L1458: D241 misses D233
proof
assume L1459: ( D241 /\ D233 ) <> ( {} );
consider C304 being set such that L1460: C304 in ( D241 /\ D233 ) by L1459 , XBOOLE_0:def 1;
L1461: C304 in D233 by L1460 , XBOOLE_0:def 4;
L1462: (ex B313 being (Element of D230) st (C304 = B313 & ( ord B313 ) divides C295 & (not ( ord B313 ) divides C296) & ( ord B313 ) <> C295)) by L1461;
L1463: C304 in D241 by L1460 , XBOOLE_0:def 4;
per cases  by L1463 , XBOOLE_0:def 3;
suppose L1464: C304 in ( C296 -roots_of_1 );

L1465: (ex B314 being (Element of D230) st (C304 = B314 & ( ord B314 ) divides C296)) by L1464 , L625;
thus L1466: contradiction by L1465 , L1462;
end;
suppose L1467: C304 in C301;

L1468: (ex B315 being (Element of D230) st (C304 = B315 & ( ord B315 ) = C295)) by L1467 , L1417;
thus L1469: contradiction by L1468 , L1462;
end;
end;
L1471: D237 = ( D243 + D234 ) by L1458 , L1456 , UPROOTS:10;
L1472: ( unital_poly (( F_Complex ) , C295) ) = ( poly_with_roots D237 ) by L888
.= ( ( poly_with_roots D243 ) *' ( poly_with_roots D234 ) ) by L1471 , UPROOTS:64
.= ( ( ( unital_poly (( F_Complex ) , C296) ) *' ( cyclotomic_poly C295 ) ) *' ( poly_with_roots D234 ) ) by L1418 , L1427 , L1457 , UPROOTS:64;
thus L1473: thesis by L1472 , L1407 , L1409 , L1253;
end;
theorem
L1474: (for B316 being Integer holds (for B317 being (Element of ( F_Complex )) holds (for B318 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds (for B319 being (Polynomial of ( F_Complex )) holds ((B319 = ( Product B318 ) & B317 = B316 & (for B320 being non  empty (Element of ( NAT )) holds (B320 in ( dom B318 ) implies (( B318 . B320 ) = <% ( 1_ ( F_Complex ) ) %> or ( B318 . B320 ) = ( cyclotomic_poly B320 ))))) implies ( eval (B319 , B317) ) is  integer)))))
proof
L1475: ( 1_. ( F_Complex ) ) = ( ( 1_ ( F_Complex ) ) * ( 1_. ( F_Complex ) ) ) by POLYNOM5:27
.= <% ( 1_ ( F_Complex ) ) %> by POLYNOM5:29;
let C305 being Integer;
let C306 being (Element of ( F_Complex ));
let C307 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) )));
let C308 being (Polynomial of ( F_Complex ));
assume that
L1476: C308 = ( Product C307 )
and
L1477: C306 = C305
and
L1478: (for B321 being non  empty (Element of ( NAT )) holds (B321 in ( dom C307 ) implies (( C307 . B321 ) = <% ( 1_ ( F_Complex ) ) %> or ( C307 . B321 ) = ( cyclotomic_poly B321 ))));
L1479: ( eval (( 1_. ( F_Complex ) ) , C306) ) = 1 by COMPLFLD:8 , POLYNOM4:18;
per cases ;
suppose L1480: ( len C307 ) = ( 0 );

L1481: C307 = ( <*> (the carrier of ( Polynom-Ring ( F_Complex ) )) ) by L1480;
L1482: C308 = ( 1_ ( Polynom-Ring ( F_Complex ) ) ) by L1481 , L1476 , GROUP_4:8
.= ( 1. ( Polynom-Ring ( F_Complex ) ) );
thus L1483: thesis by L1482 , L1479 , POLYNOM3:def 10;
end;
suppose L1484: ( 0 ) < ( len C307 );

defpred S23[ Nat , set ] means (for B322 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) holds (B322 = ( C307 | ( Seg $1 ) ) implies $2 = ( Product B322 )));
L1485: C307 = ( C307 | ( Seg ( len C307 ) ) ) by FINSEQ_3:49;
L1486:
now
let C309 being Nat;
assume L1487: C309 in ( Seg ( len C307 ) );
reconsider D244 = ( C307 | ( Seg C309 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
set D245 = ( Product D244 );
take D246 = D245;
thus L1488: S23[ C309 , D246 ];
end;
consider C310 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) such that L1489: ( dom C310 ) = ( Seg ( len C307 ) ) and L1490: (for B323 being Nat holds (B323 in ( Seg ( len C307 ) ) implies S23[ B323 , ( C310 . B323 ) ])) from FINSEQ_1:sch 5(L1486);
defpred S24[ (Element of ( NAT )) ] means (ex B324 being (Polynomial of ( F_Complex )) st (B324 = ( C310 . $1 ) & ( eval (B324 , C306) ) is  integer));
L1491:
now
let C311 being (Element of ( NAT ));
assume that
L1492: 1 <= C311
and
L1493: C311 < ( len C307 );
L1494: C311 in ( Seg ( len C307 ) ) by L1492 , L1493 , FINSEQ_1:1;
reconsider D247 = ( C307 | ( Seg ( C311 + 1 ) ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
L1495: ( C311 + 1 ) <= ( len C307 ) by L1493 , NAT_1:13;
L1496: ( C311 + 1 ) = ( min (( C311 + 1 ) , ( len C307 )) ) by L1495 , XXREAL_0:def 9;
L1497: ( len D247 ) = ( C311 + 1 ) by L1496 , FINSEQ_2:21;
L1498: 1 <= ( C311 + 1 ) by L1492 , NAT_1:13;
L1499: ( C311 + 1 ) in ( Seg ( len C307 ) ) by L1498 , L1495 , FINSEQ_1:1;
L1500: ( C311 + 1 ) in ( dom C307 ) by L1499 , FINSEQ_1:def 3;
reconsider D248 = ( C307 | ( Seg C311 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
assume L1501: S24[ C311 ];
L1502: ( ( C307 | ( Seg ( C311 + 1 ) ) ) . ( C311 + 1 ) ) = ( C307 . ( C311 + 1 ) ) by FINSEQ_1:4 , FUNCT_1:49;
reconsider D249 = ( D247 . ( C311 + 1 ) ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by L1502 , L1500 , FINSEQ_2:11;
reconsider D250 = ( Product D247 ) , D251 = ( Product D248 ) as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
reconsider D252 = D249 as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
L1503: D248 = ( D247 | ( Seg C311 ) ) by L32 , NAT_1:12;
L1504: D247 = ( D248 ^ <* D249 *> ) by L1503 , L1497 , FINSEQ_3:55;
L1505: ( Product D247 ) = ( ( Product D248 ) * D249 ) by L1504 , GROUP_4:6;
thus L1506: S24[ ( C311 + 1 ) ]
proof
reconsider D253 = ( eval (D251 , C306) ) , D254 = ( eval (D252 , C306) ) as (Element of ( COMPLEX )) by COMPLFLD:def 1;
L1507:
now
reconsider D255 = ( C311 + 1 ) as non  empty (Element of ( NAT ));
per cases  by L1478 , L1500;
suppose L1508: ( C307 . D255 ) = <% ( 1_ ( F_Complex ) ) %>;

thus L1509: ( eval (D252 , C306) ) is  integer by L1508 , L1479 , L1475 , FINSEQ_1:4 , FUNCT_1:49;
end;
suppose L1510: ( C307 . D255 ) = ( cyclotomic_poly D255 );

thus L1511: ( eval (D252 , C306) ) is  integer by L1510 , L1477 , L1502 , L1242;
end;
end;
reconsider D256 = D254 as Integer by L1507;
reconsider D257 = D253 as Integer by L1490 , L1501 , L1494;
take D250;
thus L1513: D250 = ( C310 . ( C311 + 1 ) ) by L1490 , L1499;
L1514: D250 = ( D251 *' D252 ) by L1505 , POLYNOM3:def 10;
L1515: ( eval (D250 , C306) ) = ( ( eval (D251 , C306) ) * ( eval (D252 , C306) ) ) by L1514 , POLYNOM4:24
.= ( D257 * D256 );
thus L1516: thesis by L1515;
end;

end;
L1507: ( ( 0 ) + 1 ) <= ( len C307 ) by L1484 , NAT_1:13;
L1508: 1 in ( Seg ( len C307 ) ) by L1507 , FINSEQ_1:1;
L1509: S24[ 1 ]
proof
reconsider D258 = ( C307 | ( Seg 1 ) ) as (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by FINSEQ_1:18;
L1510: 1 in ( dom C307 ) by L1508 , FINSEQ_1:def 3;
reconsider D259 = ( C307 . 1 ) as (Element of (the carrier of ( Polynom-Ring ( F_Complex ) ))) by L1510 , FINSEQ_2:11;
reconsider D260 = D259 as (Polynomial of ( F_Complex )) by POLYNOM3:def 10;
take D260;
L1511: D258 = <* ( C307 . 1 ) *> by L1507 , L23;
thus L1512: D260 = ( Product D258 ) by L1511 , FINSOP_1:11
.= ( C310 . 1 ) by L1490 , L1508;
per cases  by L1478 , L1510;
suppose L1513: ( C307 . 1 ) = <% ( 1_ ( F_Complex ) ) %>;

thus L1514: thesis by L1513 , L1475 , COMPLFLD:8 , POLYNOM4:18;
end;
suppose L1515: ( C307 . 1 ) = ( cyclotomic_poly 1 );

thus L1516: thesis by L1515 , L1477 , L1242;
end;
end;
L1518: (for B325 being (Element of ( NAT )) holds ((1 <= B325 & B325 <= ( len C307 )) implies S24[ B325 ])) from INT_1:sch 7(L1509 , L1491);
L1519: (ex B326 being (Polynomial of ( F_Complex )) st (B326 = ( C310 . ( len C307 ) ) & ( eval (B326 , C306) ) is  integer)) by L1518 , L1507;
thus L1520: thesis by L1519 , L1476 , L1484 , L1490 , L1485 , FINSEQ_1:3;
end;
end;
theorem
L1522: (for B327 being non  empty (Element of ( NAT )) holds (for B328 , B329 , B330 being Integer holds (for B331 being (Element of ( F_Complex )) holds ((B331 = B330 & B328 = ( eval (( cyclotomic_poly B327 ) , B331) ) & B329 = ( eval (( unital_poly (( F_Complex ) , B327) ) , B331) )) implies B328 divides B329))))
proof
let C312 being non  empty (Element of ( NAT ));
let C313 , C314 , C315 being Integer;
let C316 being (Element of ( F_Complex ));
assume that
L1523: C316 = C315
and
L1524: C313 = ( eval (( cyclotomic_poly C312 ) , C316) )
and
L1525: C314 = ( eval (( unital_poly (( F_Complex ) , C312) ) , C316) );
set D261 = ( eval (( cyclotomic_poly C312 ) , C316) );
per cases  by NAT_1:53;
suppose L1526: C312 = 1;

thus L1527: thesis by L1526 , L1524 , L1525 , L915 , POLYNOM5:def 4;
end;
suppose L1528: C312 > 1;

set D262 = ( eval (( unital_poly (( F_Complex ) , 1) ) , C316) );
reconsider D263 = D262 as Integer by L1523 , L892;
consider C317 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))), C318 being (Polynomial of ( F_Complex )) such that L1529: C318 = ( Product C317 ) and L1530: (( dom C317 ) = ( Seg C312 ) & (for B332 being non  empty (Element of ( NAT )) holds (B332 in ( Seg C312 ) implies ((((not B332 divides C312) or B332 divides 1 or B332 = C312) implies ( C317 . B332 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B332 divides C312 & (not B332 divides 1) & B332 <> C312) implies ( C317 . B332 ) = ( cyclotomic_poly B332 )))))) and L1531: ( unital_poly (( F_Complex ) , C312) ) = ( ( ( unital_poly (( F_Complex ) , 1) ) *' ( cyclotomic_poly C312 ) ) *' C318 ) by L1528 , L1389 , NAT_D:6;
set D264 = ( eval (C318 , C316) );
L1532:
now
let C319 being non  empty (Element of ( NAT ));
assume L1533: C319 in ( dom C317 );
per cases ;
suppose L1534: ((not C319 divides C312) or C319 divides 1 or C319 = C312);

thus L1535: (( C317 . C319 ) = <% ( 1_ ( F_Complex ) ) %> or ( C317 . C319 ) = ( cyclotomic_poly C319 )) by L1534 , L1530 , L1533;
end;
suppose L1536: (C319 divides C312 & (not C319 divides 1) & C319 <> C312);

thus L1537: (( C317 . C319 ) = <% ( 1_ ( F_Complex ) ) %> or ( C317 . C319 ) = ( cyclotomic_poly C319 )) by L1536 , L1530 , L1533;
end;
end;
reconsider D265 = D264 as Integer by L1532 , L1523 , L1529 , L1474;
L1539: C314 = ( ( eval (( ( unital_poly (( F_Complex ) , 1) ) *' ( cyclotomic_poly C312 ) ) , C316) ) * D264 ) by L1525 , L1531 , POLYNOM4:24;
L1540: C314 = ( ( D262 * D261 ) * D264 ) by L1539 , POLYNOM4:24;
L1541: C314 = ( ( D263 * D265 ) * C313 ) by L1540 , L1524;
thus L1542: thesis by L1541 , INT_1:def 3;
end;
end;
theorem
L1544: (for B333 , B334 being non  empty (Element of ( NAT )) holds (for B335 being Integer holds ((B334 < B333 & B334 divides B333) implies (for B336 being (Element of ( F_Complex )) holds (B336 = B335 implies (for B337 , B338 , B339 being Integer holds ((B337 = ( eval (( cyclotomic_poly B333 ) , B336) ) & B338 = ( eval (( unital_poly (( F_Complex ) , B333) ) , B336) ) & B339 = ( eval (( unital_poly (( F_Complex ) , B334) ) , B336) )) implies B337 divides ( B338 div B339 ))))))))
proof
let C320 , C321 being non  empty (Element of ( NAT ));
let C322 being Integer;
assume that
L1545: (C321 < C320 & C321 divides C320);
set D266 = ( ( unital_poly (( F_Complex ) , C321) ) *' ( cyclotomic_poly C320 ) );
consider C323 being (FinSequence of (the carrier of ( Polynom-Ring ( F_Complex ) ))), C324 being (Polynomial of ( F_Complex )) such that L1546: C324 = ( Product C323 ) and L1547: (( dom C323 ) = ( Seg C320 ) & (for B340 being non  empty (Element of ( NAT )) holds (B340 in ( Seg C320 ) implies ((((not B340 divides C320) or B340 divides C321 or B340 = C320) implies ( C323 . B340 ) = <% ( 1_ ( F_Complex ) ) %>) & ((B340 divides C320 & (not B340 divides C321) & B340 <> C320) implies ( C323 . B340 ) = ( cyclotomic_poly B340 )))))) and L1548: ( unital_poly (( F_Complex ) , C320) ) = ( D266 *' C324 ) by L1545 , L1389;
L1549:
now
let C325 being non  empty (Element of ( NAT ));
assume that
L1550: C325 in ( dom C323 );
per cases ;
suppose L1551: ((not C325 divides C320) or C325 divides C321 or C325 = C320);

thus L1552: (( C323 . C325 ) = <% ( 1_ ( F_Complex ) ) %> or ( C323 . C325 ) = ( cyclotomic_poly C325 )) by L1551 , L1547 , L1550;
end;
suppose L1553: (C325 divides C320 & (not C325 divides C321) & C325 <> C320);

thus L1554: (( C323 . C325 ) = <% ( 1_ ( F_Complex ) ) %> or ( C323 . C325 ) = ( cyclotomic_poly C325 )) by L1553 , L1547 , L1550;
end;
end;
let C326 being (Element of ( F_Complex ));
assume L1556: C326 = C322;
L1557: ( eval (C324 , C326) ) is  integer by L1556 , L1546 , L1549 , L1474;
consider C327 being Integer such that L1558: C327 = ( eval (C324 , C326) ) by L1557;
let C328 , C329 , C330 being Integer;
assume that
L1559: (C328 = ( eval (( cyclotomic_poly C320 ) , C326) ) & C329 = ( eval (( unital_poly (( F_Complex ) , C320) ) , C326) ) & C330 = ( eval (( unital_poly (( F_Complex ) , C321) ) , C326) ));
reconsider D267 = C328 , D268 = C330 , D269 = C327 as (Element of ( COMPLEX )) by XCMPLX_0:def 2;
reconsider D270 = D267 , D271 = D268 , D272 = D269 as (Element of ( F_Complex )) by COMPLFLD:def 1;
L1560: ( eval (( unital_poly (( F_Complex ) , C320) ) , C326) ) = ( ( eval (D266 , C326) ) * ( eval (C324 , C326) ) ) by L1548 , POLYNOM4:24;
L1561: C329 = ( ( D271 * D270 ) * D272 ) by L1560 , L1559 , L1558 , POLYNOM4:24
.= ( ( C330 * C328 ) * C327 );
L1562:
now
per cases ;
suppose L1563: C330 <> ( 0 );

L1564: C329 = ( C330 * ( C328 * C327 ) ) by L1561;
L1565: C330 divides C329 by L1564 , INT_1:def 3;
L1566: ( C329 / C330 ) is  integer by L1565 , L1563 , WSIERP_1:17;
L1567: [\ ( C329 / C330 ) /] = ( C329 / C330 ) by L1566 , INT_1:25;
L1568: ( C329 div C330 ) = ( ( ( C328 * C327 ) * C330 ) / C330 ) by L1567 , L1561 , INT_1:def 9;
L1569: ( C329 div C330 ) = ( C328 * C327 ) by L1568 , L1563 , XCMPLX_1:89;
thus L1570: thesis by L1569 , INT_1:def 3;
end;
suppose L1571: C330 = ( 0 );

L1572: ( C329 div C330 ) = ( 0 ) by L1571 , INT_1:48;
thus L1573: thesis by L1572 , INT_2:12;
end;
end;
thus L1575: thesis by L1562;
end;
theorem
L1576: (for B341 , B342 being non  empty (Element of ( NAT )) holds (for B343 being (Element of ( F_Complex )) holds (B343 = B342 implies (for B344 being Integer holds (B344 = ( eval (( cyclotomic_poly B341 ) , B343) ) implies B344 divides ( ( B342 |^ B341 ) - 1 ))))))
proof
let C331 , C332 being non  empty (Element of ( NAT ));
let C333 being (Element of ( F_Complex ));
assume that
L1577: C333 = C332;
L1578: (ex B345 being (Element of ( F_Complex )) st (B345 = C332 & ( eval (( unital_poly (( F_Complex ) , C331) ) , B345) ) = ( ( C332 |^ C331 ) - 1 ))) by L878;
let C334 being Integer;
assume L1579: C334 = ( eval (( cyclotomic_poly C331 ) , C333) );
thus L1580: thesis by L1579 , L1577 , L1578 , L1522;
end;
theorem
L1581: (for B346 , B347 , B348 being non  empty (Element of ( NAT )) holds ((B347 < B346 & B347 divides B346) implies (for B349 being (Element of ( F_Complex )) holds (B349 = B348 implies (for B350 being Integer holds (B350 = ( eval (( cyclotomic_poly B346 ) , B349) ) implies B350 divides ( ( ( B348 |^ B346 ) - 1 ) div ( ( B348 |^ B347 ) - 1 ) )))))))
proof
let C335 , C336 , C337 being non  empty (Element of ( NAT ));
assume that
L1582: (C336 < C335 & C336 divides C335);
let C338 being (Element of ( F_Complex ));
assume that
L1583: C338 = C337;
L1584: ((ex B351 being (Element of ( F_Complex )) st (B351 = C337 & ( eval (( unital_poly (( F_Complex ) , C335) ) , B351) ) = ( ( C337 |^ C335 ) - 1 ))) & (ex B352 being (Element of ( F_Complex )) st (B352 = C337 & ( eval (( unital_poly (( F_Complex ) , C336) ) , B352) ) = ( ( C337 |^ C336 ) - 1 )))) by L878;
let C339 being Integer;
assume L1585: C339 = ( eval (( cyclotomic_poly C335 ) , C338) );
thus L1586: thesis by L1585 , L1582 , L1583 , L1584 , L1544;
end;
theorem
L1587: (for B353 being non  empty (Element of ( NAT )) holds (1 < B353 implies (for B354 being (Element of ( NAT )) holds (1 < B354 implies (for B355 being (Element of ( F_Complex )) holds (B355 = B354 implies (for B356 being Integer holds (B356 = ( eval (( cyclotomic_poly B353 ) , B355) ) implies ( abs B356 ) > ( B354 - 1 )))))))))
proof
set D273 = ( MultGroup ( F_Complex ) );
set D274 = (the carrier of ( MultGroup ( F_Complex ) ));
let C340 being non  empty (Element of ( NAT ));
assume that
L1588: 1 < C340;
consider C341 being non  empty  finite (Subset of ( F_Complex )) such that L1589: C341 = { B357 where B357 is (Element of D274) : ( ord B357 ) = C340 } and L1590: ( cyclotomic_poly C340 ) = ( poly_with_roots ( (C341 , 1) -bag ) ) by L897;
L1591: ( rng ( canFS C341 ) ) = C341 by FUNCT_2:def 3;
reconsider D275 = ( canFS C341 ) as (FinSequence of ( F_Complex )) by L1591 , FINSEQ_1:def 4;
let C342 being (Element of ( NAT ));
assume that
L1592: 1 < C342;
let C343 being (Element of ( F_Complex ));
assume that
L1593: C343 = C342;
deffunc H4(set) = |. ( C343 - ( D275 /. $1 ) ) .|;
consider C344 being FinSequence such that L1594: (( len C344 ) = ( len D275 ) & (for B358 being Nat holds (B358 in ( dom C344 ) implies ( C344 . B358 ) = H4(B358)))) from FINSEQ_1:sch 2;
L1595: (for B359 being (Element of ( NAT )) holds (for B360 being (Element of ( F_Complex )) holds ((B359 in ( dom C344 ) & B360 = ( ( canFS C341 ) . B359 )) implies ( C344 . B359 ) = |. ( C343 - B360 ) .|)))
proof
let C345 being (Element of ( NAT ));
let C346 being (Element of ( F_Complex ));
assume that
L1596: C345 in ( dom C344 )
and
L1597: C346 = ( ( canFS C341 ) . C345 );
L1598: C345 in ( dom D275 ) by L1594 , L1596 , FINSEQ_3:29;
L1599: ( D275 /. C345 ) = ( ( canFS C341 ) . C345 ) by L1598 , PARTFUN1:def 6;
thus L1600: thesis by L1599 , L1594 , L1596 , L1597;
end;
L1601: (for B361 being set holds (B361 in ( rng C344 ) implies B361 in ( REAL )))
proof
let C347 being set;
assume L1602: C347 in ( rng C344 );
consider C348 being Nat such that L1603: C348 in ( dom C344 ) and L1604: ( C344 . C348 ) = C347 by L1602 , FINSEQ_2:10;
L1605: C348 in ( dom D275 ) by L1594 , L1603 , FINSEQ_3:29;
L1606: ( D275 /. C348 ) = ( ( canFS C341 ) . C348 ) by L1605 , PARTFUN1:def 6;
L1607: C347 = |. ( C343 - ( D275 /. C348 ) ) .| by L1606 , L1595 , L1603 , L1604;
thus L1608: thesis by L1607;
end;
L1609: ( rng C344 ) c= ( REAL ) by L1601 , TARSKI:def 3;
reconsider D276 = C344 as non  empty (FinSequence of ( REAL )) by L1609 , L1594 , FINSEQ_1:def 4;
L1610: ( len D275 ) = ( card C341 ) by UPROOTS:3;
L1611: |. ( eval (( cyclotomic_poly C340 ) , C343) ) .| = ( Product D276 ) by L1610 , L1590 , L1594 , L1595 , L71;
L1612: ( rng D275 ) = C341 by FUNCT_2:def 3;
L1613: (for B362 being (Element of ( NAT )) holds (B362 in ( dom D276 ) implies ( D276 . B362 ) > ( C342 - 1 )))
proof
let C349 being (Element of ( NAT ));
assume that
L1614: C349 in ( dom D276 );
L1615: C349 in ( dom D275 ) by L1594 , L1614 , FINSEQ_3:29;
L1616: ( D275 /. C349 ) = ( ( canFS C341 ) . C349 ) by L1615 , PARTFUN1:def 6;
L1617: ( D276 . C349 ) = |. ( [** C342 , ( 0 ) **] - ( D275 /. C349 ) ) .| by L1616 , L1593 , L1595 , L1614;
L1618: C349 in ( dom D275 ) by L1594 , L1614 , FINSEQ_3:29;
L1619: ( D275 . C349 ) in ( rng D275 ) by L1618 , FUNCT_1:3;
L1620: ( D275 /. C349 ) in ( rng D275 ) by L1619 , L1618 , PARTFUN1:def 6;
L1621: (ex B363 being (Element of D273) st (( D275 /. C349 ) = B363 & ( ord B363 ) = C340)) by L1620 , L1589 , L1612;
L1622:
now
assume L1623: ( D275 /. C349 ) = [** 1 , ( 0 ) **];
L1624: ( 1_ ( MultGroup ( F_Complex ) ) ) = [** 1 , ( 0 ) **] by L318 , COMPLFLD:8;
thus L1625: contradiction by L1624 , L1588 , L1621 , L1623 , GROUP_1:42;
end;
L1626: ( D275 /. C349 ) in ( C340 -roots_of_1 ) by L1621 , L596;
L1627: |. ( D275 /. C349 ) .| = 1 by L1626 , L358;
thus L1628: thesis by L1627 , L1592 , L1617 , L1622 , L123;
end;
reconsider D277 = C342 as Integer;
L1629: ( 1 + 1 ) <= D277 by L1592 , INT_1:7;
L1630: ( ( 1 + 1 ) + ( - 1 ) ) <= ( D277 + ( - 1 ) ) by L1629 , XREAL_1:7;
let C350 being Integer;
reconsider D278 = ( C342 - 1 ) as Real by XREAL_0:def 1;
assume L1631: C350 = ( eval (( cyclotomic_poly C340 ) , C343) );
L1632: ( abs C350 ) > D278 by L1631 , L1630 , L1611 , L1613 , L142;
thus L1633: ( abs C350 ) > ( C342 - 1 ) by L1632;
end;
