:: Matrices. Abelian Group of Matrices
::  by Katarzyna Jankowska
::
:: Received June 8, 1991
:: Copyright (c) 1991-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, NAT_1, XBOOLE_0, ALGSTR_0, FINSEQ_1, SUBSET_1, RLVECT_1,
      RELAT_1, CARD_1, FINSEQ_2, TARSKI, STRUCT_0, TREES_1, XXREAL_0, ZFMISC_1,
      FUNCT_1, QC_LANG1, INCSP_1, SUPINF_2, MESFUNC1, ARYTM_1, ARYTM_3,
      VECTSP_1, BINOP_1, MATRIX_1, GOBRD13, CARD_3, FUNCT_6, FINSET_1, CARD_2;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, NUMBERS, ORDINAL1,
      RELAT_1, CARD_1, CARD_2, NAT_1,
      FUNCT_1, FUNCT_2, FINSET_1, FINSEQ_1, FINSEQ_2, CARD_3, FUNCT_6,
      STRUCT_0, ALGSTR_0, BINOP_1,
      FINSEQOP, RLVECT_1, VECTSP_1, XXREAL_0;
 constructors BINOP_1, XXREAL_0, FINSEQOP, VECTSP_1, RLVECT_1, RELSET_1,
      CARD_3, FUNCT_6, CARD_2, WELLORD2, NAT_1, PRE_POLY;
 registrations XBOOLE_0, RELAT_1, FUNCT_1, XREAL_0, FINSEQ_1, FINSEQ_2,
      STRUCT_0, VECTSP_1, ORDINAL1, CARD_1, CARD_3, FINSET_1, PRE_POLY;
 requirements NUMERALS, SUBSET, BOOLE, REAL;
 definitions TARSKI, RLVECT_1, BINOP_1, FINSEQ_2, STRUCT_0, ALGSTR_0;
 theorems FINSEQ_1, FINSEQ_2, FINSEQ_3, TARSKI, FUNCOP_1, FUNCT_1, FUNCT_2,
      ZFMISC_1, NAT_1, BINOP_1, RLVECT_1, RELAT_1, ORDINAL1, CARD_1, CARD_2,
      XXREAL_0, CARD_3, FUNCT_6, FINSET_1;
 schemes FINSEQ_1, BINOP_1, FINSEQ_2, FRAENKEL;

begin
definition
let C1 being FinSequence;
attr C1 is  tabular
means
:L1: (ex B1 being Nat st (for R1 being set holds (R1 in ( rng C1 ) implies (ex B2 being FinSequence st (B2 = R1 & ( len B2 ) = B1)))));
end;
registration
cluster  tabular for FinSequence;
existence
proof
take D1 = ( {} );
take ( 0 );
let R1 being set;
assume L3: R1 in ( rng D1 );
thus L4: thesis by L3;
end;
end;
theorem
L6: (for R8 being non  empty set holds (for R17 being (Element of R8) holds <* <* R17 *> *> is  tabular))
proof
let R8 being non  empty set;
let R17 being (Element of R8);
take D2 = 1;
let R1 being set;
assume L7: R1 in ( rng <* <* R17 *> *> );
L8: ( len <* R17 *> ) = D2 by FINSEQ_1:39;
L9: ( rng <* <* R17 *> *> ) = { <* R17 *> } by FINSEQ_1:38;
L10: R1 = <* R17 *> by L9 , L7 , TARSKI:def 1;
thus L11: thesis by L10 , L8;
end;
theorem
L12: (for R1 being set holds (for R6 being Nat holds (for R7 being Nat holds ( R7 |-> ( R6 |-> R1 ) ) is  tabular)))
proof
let R1 being set;
let R6 being Nat;
let R7 being Nat;
set D3 = ( R7 |-> ( R6 |-> R1 ) );
reconsider D4 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
take D4;
let R3 being set;
assume L13: R3 in ( rng D3 );
take ( R6 |-> R1 );
L14: ( rng D3 ) c= { ( R6 |-> R1 ) } by FUNCOP_1:13;
thus L15: thesis by L14 , L13 , CARD_1:def 7 , TARSKI:def 1;
end;
theorem
L16: (for R10 being FinSequence holds <* R10 *> is  tabular)
proof
let R10 being FinSequence;
take ( len R10 );
let R1 being set;
assume L17: R1 in ( rng <* R10 *> );
L18: R1 in { R10 } by L17 , FINSEQ_1:38;
reconsider D5 = R1 as FinSequence by L18 , TARSKI:def 1;
take D5;
thus L19: thesis by L18 , TARSKI:def 1;
end;
theorem
L20: (for R6 being Nat holds (for B3 , B4 being FinSequence holds ((( len B3 ) = R6 & ( len B4 ) = R6) implies <* B3 , B4 *> is  tabular)))
proof
let R6 being Nat;
let C2 , C3 being FinSequence;
assume L21: (( len C2 ) = R6 & ( len C3 ) = R6);
L22:
now
take D6 = R6;
let R1 being set;
assume L23: R1 in ( rng <* C2 , C3 *> );
L24: R1 in { C2 , C3 } by L23 , FINSEQ_2:127;
reconsider D7 = R1 as FinSequence by L24 , TARSKI:def 2;
take D8 = D7;
thus L25: (R1 = D8 & ( len D8 ) = D6) by L21 , L24 , TARSKI:def 2;
end;
thus L26: thesis by L22 , L1;
end;
theorem
L27: ( {} ) is  tabular
proof
L28:
now
take D9 = ( 0 );
let R1 being set;
assume L29: R1 in ( rng ( {} ) );
thus L30: (ex R11 being FinSequence st (R11 = R1 & ( len R11 ) = D9)) by L29;
end;
thus L31: thesis by L28 , L1;
end;
theorem
L32: <* ( {} ) , ( {} ) *> is  tabular by L20 , CARD_1:27;
theorem
L33: (for R8 being non  empty set holds (for R13 being (Element of R8) holds (for R14 being (Element of R8) holds <* <* R13 *> , <* R14 *> *> is  tabular)))
proof
let R8 being non  empty set;
let R13 being (Element of R8);
let R14 being (Element of R8);
L34: (( len <* R13 *> ) = 1 & ( len <* R14 *> ) = 1) by FINSEQ_1:39;
thus L35: thesis by L34 , L20;
end;
theorem
L36: (for R8 being non  empty set holds (for R13 being (Element of R8) holds (for R14 being (Element of R8) holds (for R15 being (Element of R8) holds (for R16 being (Element of R8) holds <* <* R13 , R14 *> , <* R15 , R16 *> *> is  tabular)))))
proof
let R8 being non  empty set;
let R13 being (Element of R8);
let R14 being (Element of R8);
let R15 being (Element of R8);
let R16 being (Element of R8);
L37: (( len <* R13 , R14 *> ) = 2 & ( len <* R15 , R16 *> ) = 2) by FINSEQ_1:44;
thus L38: thesis by L37 , L20;
end;
registration
let C4 being set;
cluster  tabular for (FinSequence of ( C4 * ));
existence
proof
take ( <*> ( C4 * ) );
take ( 0 );
thus L39: thesis;
end;
end;
definition
let C5 being set;
mode Matrix of C5
 is  tabular (FinSequence of ( C5 * ));
end;
registration
let C6 being non  empty set;
cluster non  empty-yielding for (Matrix of C6);
existence
proof
set D10 = the (Element of C6);
L42: ( rng <* <* D10 *> *> ) = { <* D10 *> } by FINSEQ_1:38;
L43: <* D10 *> in ( C6 * ) by FINSEQ_1:def 11;
L44: ( rng <* <* D10 *> *> ) c= ( C6 * ) by L43 , L42 , ZFMISC_1:31;
reconsider D11 = <* <* D10 *> *> as (FinSequence of ( C6 * )) by L44 , FINSEQ_1:def 4;
reconsider D12 = <* D10 *> as FinSequence;
reconsider D13 = D11 as  tabular (FinSequence of ( C6 * )) by L6;
take D13;
L45:
now
take D14 = D12;
thus L46: D14 in ( rng D13 ) by L42 , TARSKI:def 1;
thus L47: D14 <> ( {} );
end;
thus L48: thesis by L45 , RELAT_1:149;
end;
end;
theorem
L50: (for R8 being non  empty set holds (for R10 being FinSequence holds (R10 is (Matrix of R8) iff (ex R6 being Nat st (for R1 being set holds (R1 in ( rng R10 ) implies (ex R18 being (FinSequence of R8) st (R1 = R18 & ( len R18 ) = R6))))))))
proof
let R8 being non  empty set;
let R10 being FinSequence;
thus L51: (R10 is (Matrix of R8) implies (ex R6 being Nat st (for R1 being set holds (R1 in ( rng R10 ) implies (ex R18 being (FinSequence of R8) st (R1 = R18 & ( len R18 ) = R6))))))
proof
assume L52: R10 is (Matrix of R8);
reconsider D15 = R10 as  tabular (FinSequence of ( R8 * )) by L52;
consider R6 being Nat such that L53: (for R1 being set holds (R1 in ( rng D15 ) implies (ex R11 being FinSequence st (R11 = R1 & ( len R11 ) = R6)))) by L1;
take R6;
L54: (for R1 being set holds (R1 in ( rng D15 ) implies (ex R18 being (FinSequence of R8) st (R1 = R18 & ( len R18 ) = R6))))
proof
let R1 being set;
assume L55: R1 in ( rng D15 );
consider C7 being FinSequence such that L56: C7 = R1 and L57: ( len C7 ) = R6 by L55 , L53;
L58: ( rng D15 ) c= ( R8 * ) by FINSEQ_1:def 4;
reconsider D16 = C7 as (FinSequence of R8) by L58 , L55 , L56 , FINSEQ_1:def 11;
take D16;
thus L59: thesis by L56 , L57;
end;
thus L60: thesis by L54;
end;

given R6 being Nat such that
L61: (for R1 being set holds (R1 in ( rng R10 ) implies (ex R18 being (FinSequence of R8) st (R1 = R18 & ( len R18 ) = R6))));

L62: R10 is  tabular
proof
consider R6 being Nat such that L63: (for R1 being set holds (R1 in ( rng R10 ) implies (ex R18 being (FinSequence of R8) st (R1 = R18 & ( len R18 ) = R6)))) by L61;
take R6;
L64: (for R1 being set holds (R1 in ( rng R10 ) implies (ex R11 being FinSequence st (R11 = R1 & ( len R11 ) = R6))))
proof
let R1 being set;
assume L65: R1 in ( rng R10 );
consider R18 being (FinSequence of R8) such that L66: (R1 = R18 & ( len R18 ) = R6) by L65 , L63;
reconsider D17 = R18 as FinSequence;
take D17;
thus L67: thesis by L66;
end;
thus L68: thesis by L64;
end;
L69: ( rng R10 ) c= ( R8 * )
proof
let R1 being set;
assume L70: R1 in ( rng R10 );
L71: (ex R18 being (FinSequence of R8) st (R1 = R18 & ( len R18 ) = R6)) by L70 , L61;
reconsider D18 = R1 as (FinSequence of R8) by L71;
L72: D18 in ( R8 * ) by FINSEQ_1:def 11;
thus L73: thesis by L72;
end;
thus L74: thesis by L69 , L62 , FINSEQ_1:def 4;
end;
definition
let R8 being non  empty set;
let R7 being Nat;
let R6 being Nat;
mode Matrix of R7 , R6 , R8
 -> (Matrix of R8)
means :L75: (( len it ) = R7 & (for R18 being (FinSequence of R8) holds (R18 in ( rng it ) implies ( len R18 ) = R6)));
existence
proof
reconsider D19 = R7 , D20 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
set D21 = the (Element of R8);
reconsider D22 = ( D20 |-> D21 ) as (Element of ( R8 * )) by FINSEQ_1:def 11;
reconsider D23 = ( D19 |-> D22 ) as (FinSequence of ( R8 * ));
L76: (ex B5 being (Element of ( NAT )) st (for R1 being set holds (R1 in ( rng D23 ) implies (ex R18 being (FinSequence of R8) st (R1 = R18 & ( len R18 ) = B5)))))
proof
reconsider D24 = ( D20 |-> D21 ) as (FinSequence of R8);
take D20;
let R1 being set;
assume L77: R1 in ( rng D23 );
take D24;
L78: ( rng D23 ) c= { ( R6 |-> D21 ) } by FUNCOP_1:13;
thus L79: thesis by L78 , L77 , CARD_1:def 7 , TARSKI:def 1;
end;
reconsider D25 = D23 as (Matrix of R8) by L76 , L50;
take D25;
thus L80: ( len D25 ) = R7 by CARD_1:def 7;
let R18 being (FinSequence of R8);
L81: ( rng D25 ) c= { ( R6 |-> D21 ) } by FUNCOP_1:13;
assume L82: R18 in ( rng D25 );
L83: R18 = ( R6 |-> D21 ) by L82 , L81 , TARSKI:def 1;
thus L84: thesis by L83 , CARD_1:def 7;
end;
end;
definition
let R8 being non  empty set;
let R6 being Nat;
mode Matrix of R6 , R8
 is (Matrix of R6 , R6 , R8);
end;
definition
let C8 being non  empty 1-sorted;
mode Matrix of C8
 is (Matrix of (the carrier of C8));
let R6 being Nat;
mode Matrix of R6 , C8
 is (Matrix of R6 , R6 , (the carrier of C8));
let R7 being Nat;
mode Matrix of R6 , R7 , C8
 is (Matrix of R6 , R7 , (the carrier of C8));
end;
theorem
L88: (for R6 being Nat holds (for R7 being Nat holds (for R8 being non  empty set holds (for R12 being (Element of R8) holds ( R7 |-> ( R6 |-> R12 ) ) is (Matrix of R7 , R6 , R8)))))
proof
let R6 being Nat;
let R7 being Nat;
let R8 being non  empty set;
let R12 being (Element of R8);
reconsider D26 = R6 , D27 = R7 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D28 = ( D26 |-> R12 ) as (Element of ( R8 * )) by FINSEQ_1:def 11;
reconsider D29 = ( D27 |-> D28 ) as (FinSequence of ( R8 * ));
reconsider D30 = D29 as (Matrix of R8) by L12;
L89: D30 is (Matrix of R7 , R6 , R8)
proof
thus L90: ( len D30 ) = R7 by CARD_1:def 7;
let R18 being (FinSequence of R8);
L91: ( rng D30 ) c= { ( R6 |-> R12 ) } by FUNCOP_1:13;
assume L92: R18 in ( rng D30 );
L93: R18 = ( R6 |-> R12 ) by L92 , L91 , TARSKI:def 1;
thus L94: thesis by L93 , CARD_1:def 7;
end;
thus L95: thesis by L89;
end;
theorem
L96: (for R8 being non  empty set holds (for B6 being (FinSequence of R8) holds <* B6 *> is (Matrix of 1 , ( len B6 ) , R8)))
proof
let R8 being non  empty set;
let C9 being (FinSequence of R8);
reconsider D31 = C9 as (Element of ( R8 * )) by FINSEQ_1:def 11;
L97: <* D31 *> is  tabular by L16;
reconsider D32 = <* C9 *> as (Matrix of R8) by L97;
L98: D32 is (Matrix of 1 , ( len C9 ) , R8)
proof
thus L99: ( len D32 ) = 1 by FINSEQ_1:39;
let R21 being (FinSequence of R8);
assume L100: R21 in ( rng D32 );
L101: R21 in { C9 } by L100 , FINSEQ_1:38;
thus L102: thesis by L101 , TARSKI:def 1;
end;
thus L103: thesis by L98;
end;
theorem
L104: (for R6 being Nat holds (for R8 being non  empty set holds (for R19 being (FinSequence of R8) holds (for R20 being (FinSequence of R8) holds ((( len R19 ) = R6 & ( len R20 ) = R6) implies <* R19 , R20 *> is (Matrix of 2 , R6 , R8))))))
proof
let R6 being Nat;
let R8 being non  empty set;
let R19 being (FinSequence of R8);
let R20 being (FinSequence of R8);
reconsider D33 = R19 , D34 = R20 as (Element of ( R8 * )) by FINSEQ_1:def 11;
reconsider D35 = <* D33 , D34 *> as (FinSequence of ( R8 * )) by FINSEQ_2:13;
assume L105: (( len R19 ) = R6 & ( len R20 ) = R6);
reconsider D36 = D35 as (Matrix of R8) by L105 , L20;
L106: D36 is (Matrix of 2 , R6 , R8)
proof
thus L107: ( len D36 ) = 2 by FINSEQ_1:44;
let R22 being (FinSequence of R8);
assume L108: R22 in ( rng D36 );
L109: R22 in { R19 , R20 } by L108 , FINSEQ_2:127;
thus L110: thesis by L109 , L105 , TARSKI:def 2;
end;
thus L111: thesis by L106;
end;
theorem
L112: (for R7 being Nat holds (for R8 being non  empty set holds ( {} ) is (Matrix of ( 0 ) , R7 , R8)))
proof
let R7 being Nat;
let R8 being non  empty set;
reconsider D37 = ( <*> ( R8 * ) ) as (FinSequence of ( R8 * ));
reconsider D38 = D37 as (Matrix of R8) by L27;
L113: D38 is (Matrix of ( 0 ) , R7 , R8)
proof
thus L114: ( len D38 ) = ( 0 );
let R18 being (FinSequence of R8);
assume L115: R18 in ( rng D38 );
thus L116: thesis by L115;
end;
thus L117: thesis by L113;
end;
theorem
L118: (for R8 being non  empty set holds <* ( {} ) *> is (Matrix of 1 , ( 0 ) , R8))
proof
let R8 being non  empty set;
L119: ( len ( <*> R8 ) ) = ( 0 );
thus L120: thesis by L119 , L96;
end;
theorem
L121: (for R8 being non  empty set holds (for R12 being (Element of R8) holds <* <* R12 *> *> is (Matrix of 1 , R8)))
proof
let R8 being non  empty set;
let R12 being (Element of R8);
L122: ( len <* R12 *> ) = 1 by FINSEQ_1:39;
thus L123: thesis by L122 , L96;
end;
theorem
L124: (for R8 being non  empty set holds <* ( {} ) , ( {} ) *> is (Matrix of 2 , ( 0 ) , R8))
proof
let R8 being non  empty set;
L125: ( len ( <*> R8 ) ) = ( 0 );
thus L126: thesis by L125 , L104;
end;
theorem
L127: (for R8 being non  empty set holds (for R13 being (Element of R8) holds (for R14 being (Element of R8) holds <* <* R13 , R14 *> *> is (Matrix of 1 , 2 , R8))))
proof
let R8 being non  empty set;
let R13 being (Element of R8);
let R14 being (Element of R8);
L128: (<* R13 , R14 *> is (FinSequence of R8) & ( len <* R13 , R14 *> ) = 2) by FINSEQ_1:44 , FINSEQ_2:13;
thus L129: thesis by L128 , L96;
end;
theorem
L130: (for R8 being non  empty set holds (for R13 being (Element of R8) holds (for R14 being (Element of R8) holds <* <* R13 *> , <* R14 *> *> is (Matrix of 2 , 1 , R8))))
proof
let R8 being non  empty set;
let R13 being (Element of R8);
let R14 being (Element of R8);
L131: (( len <* R13 *> ) = 1 & ( len <* R14 *> ) = 1) by FINSEQ_1:39;
thus L132: thesis by L131 , L104;
end;
theorem
L133: (for R8 being non  empty set holds (for R13 being (Element of R8) holds (for R14 being (Element of R8) holds (for R15 being (Element of R8) holds (for R16 being (Element of R8) holds <* <* R13 , R14 *> , <* R15 , R16 *> *> is (Matrix of 2 , R8))))))
proof
let R8 being non  empty set;
let R13 being (Element of R8);
let R14 being (Element of R8);
let R15 being (Element of R8);
let R16 being (Element of R8);
L134: (( len <* R13 , R14 *> ) = 2 & ( len <* R15 , R16 *> ) = 2) by FINSEQ_1:44;
L135: (<* R13 , R14 *> is (FinSequence of R8) & <* R15 , R16 *> is (FinSequence of R8)) by FINSEQ_2:13;
thus L136: thesis by L135 , L134 , L104;
end;
definition
let C10 being  tabular FinSequence;
func width C10 -> (Element of ( NAT )) means 
:L137: (ex R10 being FinSequence st (R10 in ( rng C10 ) & ( len R10 ) = it)) if ( len C10 ) > ( 0 ) otherwise it = ( 0 );
existence
proof
thus L138: (( len C10 ) > ( 0 ) implies (ex B7 being (Element of ( NAT )) st (ex R10 being FinSequence st (R10 in ( rng C10 ) & ( len R10 ) = B7))))
proof
set D39 = the (Element of ( rng C10 ));
consider R6 being Nat such that L139: (for R1 being set holds (R1 in ( rng C10 ) implies (ex R10 being FinSequence st (R10 = R1 & ( len R10 ) = R6)))) by L1;
reconsider D40 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
assume L140: ( len C10 ) > ( 0 );
L141: ( rng C10 ) <> ( {} ) by L140 , CARD_1:27 , RELAT_1:41;
consider R10 being FinSequence such that L142: (R10 = D39 & ( len R10 ) = D40) by L141 , L139;
take D40;
take R10;
thus L143: thesis by L141 , L142;
end;

L144: ( 0 ) in ( NAT ) by ORDINAL1:def 12;
thus L145: thesis by L144;
end;
uniqueness
proof
let C11 , C12 being (Element of ( NAT ));
thus L146: (( len C10 ) > ( 0 ) implies (((ex R10 being FinSequence st (R10 in ( rng C10 ) & ( len R10 ) = C11)) & (ex R10 being FinSequence st (R10 in ( rng C10 ) & ( len R10 ) = C12))) implies C11 = C12))
proof
assume L147: ( len C10 ) > ( 0 );
given R10 being FinSequence such that
L148: R10 in ( rng C10 )
and
L149: ( len R10 ) = C11;

consider R6 being Nat such that L150: (for R1 being set holds (R1 in ( rng C10 ) implies (ex R10 being FinSequence st (R10 = R1 & ( len R10 ) = R6)))) by L1;
L151: (ex B8 being FinSequence st (B8 = R10 & ( len B8 ) = R6)) by L150 , L148;
given C13 being FinSequence such that
L152: C13 in ( rng C10 )
and
L153: ( len C13 ) = C12;

L154: (ex B9 being FinSequence st (B9 = C13 & ( len B9 ) = R6)) by L150 , L152;
thus L155: thesis by L154 , L149 , L153 , L151;
end;

thus L156: thesis;
end;
consistency;
end;
theorem
L158: (for R8 being non  empty set holds (for R24 being (Matrix of R8) holds (( len R24 ) > ( 0 ) implies (for R6 being Nat holds (R24 is (Matrix of ( len R24 ) , R6 , R8) iff R6 = ( width R24 ))))))
proof
let R8 being non  empty set;
let R24 being (Matrix of R8);
assume L159: ( len R24 ) > ( 0 );
let R6 being Nat;
thus L160: (R24 is (Matrix of ( len R24 ) , R6 , R8) implies R6 = ( width R24 ))
proof
consider R10 being FinSequence such that L161: R10 in ( rng R24 ) and L162: ( len R10 ) = ( width R24 ) by L159 , L137;
L163: ( rng R24 ) c= ( R8 * ) by FINSEQ_1:def 4;
reconsider D41 = R10 as (FinSequence of R8) by L163 , L161 , FINSEQ_1:def 11;
assume L164: R24 is (Matrix of ( len R24 ) , R6 , R8);
L165: ( len D41 ) = R6 by L164 , L161 , L75;
thus L166: thesis by L165 , L162;
end;

assume L167: R6 = ( width R24 );
L168: (for R18 being (FinSequence of R8) holds (R18 in ( rng R24 ) implies ( len R18 ) = R6)) by L167 , L159 , L137;
thus L169: thesis by L168 , L75;
end;
definition
let C14 being  tabular FinSequence;
func Indices C14 -> set equals 
[: ( dom C14 ) , ( Seg ( width C14 ) ) :];
coherence;
end;
definition
let C15 being set;
let C16 being (Matrix of C15);
let R4 being Nat;
let R5 being Nat;
assume L171: [ R4 , R5 ] in ( Indices C16 );
func C16 * (R4 , R5) -> (Element of C15) means 
:L172: (ex B10 being (FinSequence of C15) st (B10 = ( C16 . R4 ) & it = ( B10 . R5 )));
existence
proof
L173: R4 in ( dom C16 ) by L171 , ZFMISC_1:87;
L174: ( C16 . R4 ) in ( rng C16 ) by L173 , FUNCT_1:def 3;
L175: ( rng C16 ) c= ( C15 * ) by FINSEQ_1:def 4;
reconsider D42 = ( C16 . R4 ) as (FinSequence of C15) by L175 , L174 , FINSEQ_1:def 11;
L176: R5 in ( Seg ( width C16 ) ) by L171 , ZFMISC_1:87;
L177: (C16 <> ( {} ) & ( len C16 ) >= ( 0 )) by L171 , NAT_1:2 , ZFMISC_1:87;
L178: ( len C16 ) > ( 0 ) by L177 , XXREAL_0:1;
consider R10 being FinSequence such that L179: R10 in ( rng C16 ) and L180: ( len R10 ) = ( width C16 ) by L178 , L137;
consider R6 being Nat such that L181: (for R1 being set holds (R1 in ( rng C16 ) implies (ex R11 being FinSequence st (R11 = R1 & ( len R11 ) = R6)))) by L1;
L182: (ex B11 being FinSequence st (D42 = B11 & ( len B11 ) = R6)) by L174 , L181;
L183: (ex R11 being FinSequence st (R10 = R11 & ( len R11 ) = R6)) by L179 , L181;
L184: R5 in ( dom D42 ) by L183 , L176 , L180 , L182 , FINSEQ_1:def 3;
L185: ( D42 . R5 ) in ( rng D42 ) by L184 , FUNCT_1:def 3;
L186: ( rng D42 ) c= C15 by FINSEQ_1:def 4;
reconsider D43 = ( D42 . R5 ) as (Element of C15) by L186 , L185;
take D43;
take D42;
thus L187: thesis;
end;
uniqueness;
end;
theorem
L189: (for R8 being non  empty set holds (for R25 being (Matrix of R8) holds (for R26 being (Matrix of R8) holds ((( len R25 ) = ( len R26 ) & ( width R25 ) = ( width R26 ) & (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices R25 ) implies ( R25 * (R4 , R5) ) = ( R26 * (R4 , R5) ))))) implies R25 = R26))))
proof
let R8 being non  empty set;
let R25 being (Matrix of R8);
let R26 being (Matrix of R8);
assume that
L190: ( len R25 ) = ( len R26 )
and
L191: ( width R25 ) = ( width R26 )
and
L192: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices R25 ) implies ( R25 * (R4 , R5) ) = ( R26 * (R4 , R5) ))));
L193: ( dom R25 ) = ( dom R26 ) by L190 , FINSEQ_3:29;
L194: (for B12 being Nat holds (B12 in ( dom R25 ) implies ( R25 . B12 ) = ( R26 . B12 )))
proof
let C17 being Nat;
L195: ( len R25 ) >= ( 0 ) by NAT_1:2;
assume L196: C17 in ( dom R25 );
L197: ( R25 . C17 ) in ( rng R25 ) by L196 , FUNCT_1:def 3;
L198: ( rng R25 ) c= ( R8 * ) by FINSEQ_1:def 4;
reconsider D44 = ( R25 . C17 ) as (FinSequence of R8) by L198 , L197 , FINSEQ_1:def 11;
L199: R25 <> ( {} ) by L196;
L200: ( len R25 ) > ( 0 ) by L199 , L195 , XXREAL_0:1;
L201: R25 is (Matrix of ( len R25 ) , ( width R25 ) , R8) by L200 , L158;
L202: ( len D44 ) = ( width R25 ) by L201 , L197 , L75;
L203: ( R26 . C17 ) in ( rng R26 ) by L193 , L196 , FUNCT_1:def 3;
L204: ( rng R26 ) c= ( R8 * ) by FINSEQ_1:def 4;
reconsider D45 = ( R26 . C17 ) as (FinSequence of R8) by L204 , L203 , FINSEQ_1:def 11;
L205: R26 is (Matrix of ( len R25 ) , ( width R25 ) , R8) by L190 , L191 , L200 , L158;
L206: ( len D45 ) = ( width R25 ) by L205 , L203 , L75;
L207: (for B13 being Nat holds ((1 <= B13 & B13 <= ( len D44 )) implies ( D44 . B13 ) = ( D45 . B13 )))
proof
let C18 being Nat;
L208: ( rng D44 ) c= R8 by FINSEQ_1:def 4;
assume L209: (1 <= C18 & C18 <= ( len D44 ));
L210: C18 in ( Seg ( width R25 ) ) by L209 , L202 , FINSEQ_1:1;
L211: C18 in ( dom D44 ) by L210 , L202 , FINSEQ_1:def 3;
L212: ( D44 . C18 ) in ( rng D44 ) by L211 , FUNCT_1:def 3;
reconsider D46 = ( D44 . C18 ) as (Element of R8) by L212 , L208;
L213: ( rng D45 ) c= R8 by FINSEQ_1:def 4;
L214: C18 in ( dom D45 ) by L206 , L210 , FINSEQ_1:def 3;
L215: ( D45 . C18 ) in ( rng D45 ) by L214 , FUNCT_1:def 3;
reconsider D47 = ( D45 . C18 ) as (Element of R8) by L215 , L213;
L216: [ C17 , C18 ] in ( Indices R26 ) by L191 , L193 , L196 , L210 , ZFMISC_1:87;
L217: ( R26 * (C17 , C18) ) = D47 by L216 , L172;
L218: [ C17 , C18 ] in ( Indices R25 ) by L196 , L210 , ZFMISC_1:87;
L219: ( R25 * (C17 , C18) ) = D46 by L218 , L172;
L220: [ C17 , C18 ] in [: ( dom R25 ) , ( Seg ( width R25 ) ) :] by L196 , L210 , ZFMISC_1:87;
thus L221: thesis by L220 , L192 , L219 , L217;
end;
thus L222: thesis by L207 , L202 , L206 , FINSEQ_1:14;
end;
thus L223: thesis by L194 , L193 , FINSEQ_1:13;
end;
scheme MatrixLambda { F1() -> non  empty set , F2 , F3() -> (Element of ( NAT )) , F4(set , set) -> (Element of F1()) } : (ex B14 being (Matrix of F2() , F3() , F1()) st (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices B14 ) implies ( B14 * (R4 , R5) ) = F4(R4 , R5)))))
proof
defpred S1[ set , set ] means (ex B15 being FinSequence st ($2 = B15 & ( len B15 ) = F3() & (for R4 being Nat holds (R4 in ( Seg F3() ) implies ( B15 . R4 ) = F4($1 , R4)))));
L224: F2() >= ( 0 ) by NAT_1:2;
L225: (for B16 being Nat holds (B16 in ( Seg F2() ) implies (ex R2 being set st S1[ B16 , R2 ])))
proof
let C19 being Nat;
assume L226: C19 in ( Seg F2() );
deffunc H1(Nat) = F4(C19 , $1);
consider C20 being FinSequence such that L227: (( len C20 ) = F3() & (for B17 being Nat holds (B17 in ( dom C20 ) implies ( C20 . B17 ) = H1(B17)))) from FINSEQ_1:sch 2;
take C20;
take C20;
L228: ( dom C20 ) = ( Seg F3() ) by L227 , FINSEQ_1:def 3;
thus L229: thesis by L228 , L227;
end;
consider C21 being FinSequence such that L230: ( dom C21 ) = ( Seg F2() ) and L231: (for B18 being Nat holds (B18 in ( Seg F2() ) implies S1[ B18 , ( C21 . B18 ) ])) from FINSEQ_1:sch 1(L225);
L232: ( len C21 ) = F2() by L230 , FINSEQ_1:def 3;
L233: ( rng C21 ) c= ( F1() * )
proof
let R1 being set;
assume L234: R1 in ( rng C21 );
consider C22 being Nat such that L235: C22 in ( dom C21 ) and L236: ( C21 . C22 ) = R1 by L234 , FINSEQ_2:10;
consider C23 being FinSequence such that L237: ( C21 . C22 ) = C23 and L238: (( len C23 ) = F3() & (for R5 being Nat holds (R5 in ( Seg F3() ) implies ( C23 . R5 ) = F4(C22 , R5)))) by L230 , L231 , L235;
L239: ( rng C23 ) c= F1()
proof
let R3 being set;
assume L240: R3 in ( rng C23 );
consider C24 being Nat such that L241: C24 in ( dom C23 ) and L242: ( C23 . C24 ) = R3 by L240 , FINSEQ_2:10;
L243: C24 in ( Seg ( len C23 ) ) by L241 , FINSEQ_1:def 3;
L244: R3 = F4(C22 , C24) by L243 , L238 , L242;
thus L245: thesis by L244;
end;
L246: C23 is (FinSequence of F1()) by L239 , FINSEQ_1:def 4;
thus L247: thesis by L246 , L236 , L237 , FINSEQ_1:def 11;
end;
reconsider D48 = C21 as (FinSequence of ( F1() * )) by L233 , FINSEQ_1:def 4;
L248: (ex R6 being Nat st (for R1 being set holds (R1 in ( rng D48 ) implies (ex B19 being (FinSequence of F1()) st (R1 = B19 & ( len B19 ) = R6)))))
proof
take F3();
let R1 being set;
assume L249: R1 in ( rng D48 );
consider C25 being Nat such that L250: (C25 in ( dom D48 ) & ( D48 . C25 ) = R1) by L249 , FINSEQ_2:10;
consider C26 being FinSequence such that L251: R1 = C26 and L252: ( len C26 ) = F3() and L253: (for R5 being Nat holds (R5 in ( Seg F3() ) implies ( C26 . R5 ) = F4(C25 , R5))) by L230 , L231 , L250;
L254: ( rng C26 ) c= F1()
proof
let R3 being set;
assume L255: R3 in ( rng C26 );
consider C27 being Nat such that L256: C27 in ( dom C26 ) and L257: ( C26 . C27 ) = R3 by L255 , FINSEQ_2:10;
L258: C27 in ( Seg ( len C26 ) ) by L256 , FINSEQ_1:def 3;
L259: R3 = F4(C25 , C27) by L258 , L252 , L253 , L257;
thus L260: thesis by L259;
end;
reconsider D49 = C26 as (FinSequence of F1()) by L254 , FINSEQ_1:def 4;
take D49;
thus L261: thesis by L251 , L252;
end;
reconsider D50 = D48 as (Matrix of F1()) by L248 , L50;
L262: (for B20 being (FinSequence of F1()) holds (B20 in ( rng D50 ) implies ( len B20 ) = F3()))
proof
let C28 being (FinSequence of F1());
assume L263: C28 in ( rng D50 );
consider C29 being Nat such that L264: (C29 in ( dom D50 ) & ( D50 . C29 ) = C28) by L263 , FINSEQ_2:10;
L265: S1[ C29 , C28 ] by L230 , L231 , L264;
thus L266: thesis by L265;
end;
reconsider D51 = D50 as (Matrix of F2() , F3() , F1()) by L262 , L232 , L75;
take D51;
let R4 being Nat;
let R5 being Nat;
assume L267: [ R4 , R5 ] in ( Indices D51 );
L268: F2() <> ( 0 ) by L267 , L230 , ZFMISC_1:87;
L269: F2() > ( 0 ) by L268 , L224 , XXREAL_0:1;
L270: R4 in ( Seg F2() ) by L230 , L267 , ZFMISC_1:87;
L271: (ex B21 being FinSequence st (( D51 . R4 ) = B21 & ( len B21 ) = F3() & (for R5 being Nat holds (R5 in ( Seg F3() ) implies ( B21 . R5 ) = F4(R4 , R5))))) by L270 , L231;
L272: R5 in ( Seg ( width D51 ) ) by L267 , ZFMISC_1:87;
L273: R5 in ( Seg F3() ) by L272 , L232 , L269 , L158;
L274: (ex B22 being (FinSequence of F1()) st (B22 = ( D51 . R4 ) & ( D51 * (R4 , R5) ) = ( B22 . R5 ))) by L267 , L172;
thus L275: thesis by L274 , L271 , L273;
end;
scheme MatrixEx { F5() -> non  empty set , F6 , F7() -> (Element of ( NAT )) , P1[set , set , set] } : (ex B23 being (Matrix of F6() , F7() , F5()) st (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices B23 ) implies P1[ R4 , R5 , ( B23 * (R4 , R5) ) ]))))
provided
L276: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in [: ( Seg F6() ) , ( Seg F7() ) :] implies (ex B24 being (Element of F5()) st P1[ R4 , R5 , B24 ]))))
proof
defpred S2[ set , set , set ] means (P1[ $1 , $2 , $3 ] & $3 in F5());
L277: (for R1 being set holds (for R2 being set holds ((R1 in ( Seg F6() ) & R2 in ( Seg F7() )) implies (ex R3 being set st (R3 in F5() & S2[ R1 , R2 , R3 ])))))
proof
let R1 being set;
let R2 being set;
assume that
L278: R1 in ( Seg F6() )
and
L279: R2 in ( Seg F7() );
reconsider D52 = R2 as (Element of ( NAT )) by L279;
reconsider D53 = R1 as (Element of ( NAT )) by L278;
L280: [ D53 , D52 ] in [: ( Seg F6() ) , ( Seg F7() ) :] by L278 , L279 , ZFMISC_1:87;
consider C30 being (Element of F5()) such that L281: P1[ D53 , D52 , C30 ] by L280 , L276;
take C30;
thus L282: thesis by L281;
end;
consider C31 being (Function of [: ( Seg F6() ) , ( Seg F7() ) :] , F5()) such that L283: (for R1 being set holds (for R2 being set holds ((R1 in ( Seg F6() ) & R2 in ( Seg F7() )) implies S2[ R1 , R2 , ( C31 . (R1 , R2) ) ]))) from BINOP_1:sch 1(L277);
L284: F6() >= ( 0 ) by NAT_1:2;
defpred S3[ set , set ] means (ex B25 being FinSequence st ($2 = B25 & ( len B25 ) = F7() & (for R4 being Nat holds (R4 in ( Seg F7() ) implies ( B25 . R4 ) = ( C31 . ($1 , R4) )))));
L285: (for B26 being Nat holds (B26 in ( Seg F6() ) implies (ex R2 being set st S3[ B26 , R2 ])))
proof
let C32 being Nat;
assume L286: C32 in ( Seg F6() );
deffunc H2(Nat) = ( C31 . [ C32 , $1 ] );
consider C33 being FinSequence such that L287: (( len C33 ) = F7() & (for B27 being Nat holds (B27 in ( dom C33 ) implies ( C33 . B27 ) = H2(B27)))) from FINSEQ_1:sch 2;
take C33;
take C33;
L288: ( dom C33 ) = ( Seg F7() ) by L287 , FINSEQ_1:def 3;
thus L289: thesis by L288 , L287;
end;
consider C34 being FinSequence such that L290: ( dom C34 ) = ( Seg F6() ) and L291: (for B28 being Nat holds (B28 in ( Seg F6() ) implies S3[ B28 , ( C34 . B28 ) ])) from FINSEQ_1:sch 1(L285);
L292: ( len C34 ) = F6() by L290 , FINSEQ_1:def 3;
L293: ( rng C34 ) c= ( F5() * )
proof
let R1 being set;
assume L294: R1 in ( rng C34 );
consider C35 being Nat such that L295: C35 in ( Seg F6() ) and L296: ( C34 . C35 ) = R1 by L294 , L290 , FINSEQ_2:10;
consider C36 being FinSequence such that L297: ( C34 . C35 ) = C36 and L298: ( len C36 ) = F7() and L299: (for R5 being Nat holds (R5 in ( Seg F7() ) implies ( C36 . R5 ) = ( C31 . (C35 , R5) ))) by L291 , L295;
L300: ( rng C36 ) c= F5()
proof
let R3 being set;
assume L301: R3 in ( rng C36 );
consider C37 being Nat such that L302: C37 in ( dom C36 ) and L303: ( C36 . C37 ) = R3 by L301 , FINSEQ_2:10;
L304: C37 in ( Seg ( len C36 ) ) by L302 , FINSEQ_1:def 3;
L305: [ C35 , C37 ] in [: ( Seg F6() ) , ( Seg F7() ) :] by L304 , L295 , L298 , ZFMISC_1:87;
L306: R3 = ( C31 . (C35 , C37) ) by L298 , L299 , L303 , L304;
thus L307: thesis by L306 , L305 , FUNCT_2:5;
end;
L308: C36 is (FinSequence of F5()) by L300 , FINSEQ_1:def 4;
thus L309: thesis by L308 , L296 , L297 , FINSEQ_1:def 11;
end;
reconsider D54 = C34 as (FinSequence of ( F5() * )) by L293 , FINSEQ_1:def 4;
L310: (ex R6 being Nat st (for R1 being set holds (R1 in ( rng D54 ) implies (ex B29 being (FinSequence of F5()) st (R1 = B29 & ( len B29 ) = R6)))))
proof
take F7();
let R1 being set;
assume L311: R1 in ( rng D54 );
consider C38 being Nat such that L312: C38 in ( dom D54 ) and L313: ( D54 . C38 ) = R1 by L311 , FINSEQ_2:10;
consider C39 being FinSequence such that L314: R1 = C39 and L315: ( len C39 ) = F7() and L316: (for R5 being Nat holds (R5 in ( Seg F7() ) implies ( C39 . R5 ) = ( C31 . (C38 , R5) ))) by L290 , L291 , L312 , L313;
L317: ( rng C39 ) c= F5()
proof
let R3 being set;
assume L318: R3 in ( rng C39 );
consider C40 being Nat such that L319: C40 in ( dom C39 ) and L320: ( C39 . C40 ) = R3 by L318 , FINSEQ_2:10;
L321: C40 in ( Seg ( len C39 ) ) by L319 , FINSEQ_1:def 3;
L322: [ C38 , C40 ] in [: ( Seg F6() ) , ( Seg F7() ) :] by L321 , L290 , L312 , L315 , ZFMISC_1:87;
L323: R3 = ( C31 . (C38 , C40) ) by L315 , L316 , L320 , L321;
thus L324: thesis by L323 , L322 , FUNCT_2:5;
end;
reconsider D55 = C39 as (FinSequence of F5()) by L317 , FINSEQ_1:def 4;
take D55;
thus L325: thesis by L314 , L315;
end;
reconsider D56 = D54 as (Matrix of F5()) by L310 , L50;
L326: (for B30 being (FinSequence of F5()) holds (B30 in ( rng D56 ) implies ( len B30 ) = F7()))
proof
let C41 being (FinSequence of F5());
assume L327: C41 in ( rng D56 );
consider C42 being Nat such that L328: (C42 in ( dom D56 ) & ( D56 . C42 ) = C41) by L327 , FINSEQ_2:10;
L329: S3[ C42 , C41 ] by L290 , L291 , L328;
thus L330: thesis by L329;
end;
reconsider D57 = D56 as (Matrix of F6() , F7() , F5()) by L326 , L292 , L75;
take D57;
let R4 being Nat;
let R5 being Nat;
assume L331: [ R4 , R5 ] in ( Indices D57 );
L332: F6() <> ( 0 ) by L331 , L290 , ZFMISC_1:87;
L333: F6() > ( 0 ) by L332 , L284 , XXREAL_0:1;
L334: R5 in ( Seg ( width D57 ) ) by L331 , ZFMISC_1:87;
L335: R5 in ( Seg F7() ) by L334 , L292 , L333 , L158;
L336: (ex B31 being (FinSequence of F5()) st (B31 = ( D57 . R4 ) & ( D57 * (R4 , R5) ) = ( B31 . R5 ))) by L331 , L172;
L337: R4 in ( Seg F6() ) by L290 , L331 , ZFMISC_1:87;
L338: (ex B32 being FinSequence st (( D57 . R4 ) = B32 & ( len B32 ) = F7() & (for R5 being Nat holds (R5 in ( Seg F7() ) implies ( B32 . R5 ) = ( C31 . (R4 , R5) ))))) by L337 , L291;
L339: ( C31 . (R4 , R5) ) = ( D57 * (R4 , R5) ) by L338 , L336 , L335;
thus L340: thesis by L339 , L283 , L337 , L335;
end;
theorem
L341: (for R7 being Nat holds (for R8 being non  empty set holds (for B33 being (Matrix of ( 0 ) , R7 , R8) holds (( len B33 ) = ( 0 ) & ( width B33 ) = ( 0 ) & ( Indices B33 ) = ( {} )))))
proof
let R7 being Nat;
let R8 being non  empty set;
let C43 being (Matrix of ( 0 ) , R7 , R8);
L342: ( len C43 ) = ( 0 ) by L75;
L343: ( width C43 ) = ( 0 ) by L342 , L137;
L344: ( Seg ( width C43 ) ) = ( 0 ) by L343;
thus L345: thesis by L344 , L75 , ZFMISC_1:90;
end;
theorem
L346: (for R6 being Nat holds (for R7 being Nat holds (for R8 being non  empty set holds (R6 > ( 0 ) implies (for B34 being (Matrix of R6 , R7 , R8) holds (( len B34 ) = R6 & ( width B34 ) = R7 & ( Indices B34 ) = [: ( Seg R6 ) , ( Seg R7 ) :]))))))
proof
let R6 being Nat;
let R7 being Nat;
let R8 being non  empty set;
assume L347: R6 > ( 0 );
let C44 being (Matrix of R6 , R7 , R8);
L348: (( Seg ( len C44 ) ) = ( dom C44 ) & ( len C44 ) = R6) by L75 , FINSEQ_1:def 3;
thus L349: thesis by L348 , L347 , L158;
end;
theorem
L350: (for R6 being Nat holds (for R8 being non  empty set holds (for B35 being (Matrix of R6 , R8) holds (( len B35 ) = R6 & ( width B35 ) = R6 & ( Indices B35 ) = [: ( Seg R6 ) , ( Seg R6 ) :]))))
proof
let R6 being Nat;
let R8 being non  empty set;
let C45 being (Matrix of R6 , R8);
L351: ( len C45 ) = R6 by L75;
L352: ( 0 ) <= R6 by NAT_1:2;
L353:
now
per cases  by L352 , XXREAL_0:1;
case L354: R6 = ( 0 );
thus L355: ( width C45 ) = ( 0 ) by L354 , L351 , L137;
end;
case L356: R6 > ( 0 );
thus L357: ( width C45 ) = R6 by L356 , L351 , L158;
end;
end;
L359: ( Seg ( len C45 ) ) = ( dom C45 ) by FINSEQ_1:def 3;
thus L360: thesis by L359 , L353 , L75;
end;
theorem
L361: (for R6 being Nat holds (for R7 being Nat holds (for R8 being non  empty set holds (for B36 being (Matrix of R6 , R7 , R8) holds (( len B36 ) = R6 & ( Indices B36 ) = [: ( Seg R6 ) , ( Seg ( width B36 ) ) :])))))
proof
let R6 being Nat;
let R7 being Nat;
let R8 being non  empty set;
let C46 being (Matrix of R6 , R7 , R8);
L362: ( len C46 ) = R6 by L75;
thus L363: thesis by L362 , FINSEQ_1:def 3;
end;
theorem
L364: (for R6 being Nat holds (for R7 being Nat holds (for R8 being non  empty set holds (for B37 , B38 being (Matrix of R6 , R7 , R8) holds ( Indices B37 ) = ( Indices B38 )))))
proof
let R6 being Nat;
let R7 being Nat;
let R8 being non  empty set;
let C47 , C48 being (Matrix of R6 , R7 , R8);
L365: ( len C47 ) = R6 by L75;
L366: ( len C48 ) = R6 by L75;
L367: ( 0 ) <= R6 by NAT_1:2;
L368:
now
per cases  by L367 , XXREAL_0:1;
suppose L369: R6 = ( 0 );

L370: ( width C47 ) = ( 0 ) by L369 , L365 , L137;
thus L371: ( width C47 ) = ( width C48 ) by L370 , L366 , L369 , L137;
end;
suppose L372: R6 > ( 0 );

L373: ( width C47 ) = R7 by L372 , L365 , L158;
thus L374: ( width C47 ) = ( width C48 ) by L373 , L366 , L372 , L158;
end;
end;
L376: ( dom C47 ) = ( Seg R6 ) by L365 , FINSEQ_1:def 3;
thus L377: thesis by L376 , L366 , L368 , FINSEQ_1:def 3;
end;
theorem
L378: (for R6 being Nat holds (for R7 being Nat holds (for R8 being non  empty set holds (for B39 , B40 being (Matrix of R6 , R7 , R8) holds ((for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices B39 ) implies ( B39 * (R4 , R5) ) = ( B40 * (R4 , R5) )))) implies B39 = B40)))))
proof
let R6 being Nat;
let R7 being Nat;
let R8 being non  empty set;
let C49 , C50 being (Matrix of R6 , R7 , R8);
L379: ( len C49 ) = R6 by L361;
L380: ( len C50 ) = R6 by L361;
L381: ( 0 ) <= R6 by NAT_1:2;
L382:
now
per cases  by L381 , XXREAL_0:1;
suppose L383: R6 = ( 0 );

L384: ( width C49 ) = ( 0 ) by L383 , L379 , L137;
thus L385: ( width C49 ) = ( width C50 ) by L384 , L380 , L383 , L137;
end;
suppose L386: R6 > ( 0 );

L387: ( width C49 ) = R7 by L386 , L379 , L158;
thus L388: ( width C49 ) = ( width C50 ) by L387 , L380 , L386 , L158;
end;
end;
assume L390: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices C49 ) implies ( C49 * (R4 , R5) ) = ( C50 * (R4 , R5) ))));
thus L391: thesis by L390 , L379 , L380 , L382 , L189;
end;
theorem
L392: (for R6 being Nat holds (for R8 being non  empty set holds (for B41 being (Matrix of R6 , R8) holds (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices B41 ) implies [ R5 , R4 ] in ( Indices B41 )))))))
proof
let R6 being Nat;
let R8 being non  empty set;
let C51 being (Matrix of R6 , R8);
let R4 being Nat;
let R5 being Nat;
assume L393: [ R4 , R5 ] in ( Indices C51 );
L394: [ R4 , R5 ] in [: ( Seg R6 ) , ( Seg R6 ) :] by L393 , L350;
L395: (R5 in ( Seg R6 ) & R4 in ( Seg R6 )) by L394 , ZFMISC_1:87;
L396: ( Indices C51 ) = [: ( Seg R6 ) , ( Seg R6 ) :] by L350;
thus L397: thesis by L396 , L395 , ZFMISC_1:87;
end;
definition
let R8 being non  empty set;
let C52 being (Matrix of R8);
func C52 @ -> (Matrix of R8) means 
:L398: (( len it ) = ( width C52 ) & (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices it ) iff [ R5 , R4 ] in ( Indices C52 )))) & (for R4 being Nat holds (for R5 being Nat holds ([ R5 , R4 ] in ( Indices C52 ) implies ( it * (R4 , R5) ) = ( C52 * (R5 , R4) )))));
existence
proof
L399:
now
per cases  by NAT_1:3;
suppose L400: ( width C52 ) > ( 0 );

deffunc H3(Nat , Nat) = ( C52 * ($2 , $1) );
consider C53 being (Matrix of ( width C52 ) , ( len C52 ) , R8) such that L401: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices C53 ) implies ( C53 * (R4 , R5) ) = H3(R4 , R5)))) from MatrixLambda;
reconsider D58 = C53 as (Matrix of R8);
L402: ( Seg ( len C52 ) ) = ( dom C52 ) by FINSEQ_1:def 3;
L403: ( Indices C53 ) = [: ( Seg ( width C52 ) ) , ( dom C52 ) :] by L402 , L400 , L346;
thus L404: thesis
proof
take D58;
thus L405: ( len D58 ) = ( width C52 ) by L400 , L346;
thus L406: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices D58 ) iff [ R5 , R4 ] in ( Indices C52 )))) by L403 , ZFMISC_1:88;
let R4 being Nat;
let R5 being Nat;
assume L407: [ R5 , R4 ] in ( Indices C52 );
L408: [ R4 , R5 ] in ( Indices D58 ) by L407 , L403 , ZFMISC_1:88;
thus L409: thesis by L408 , L401;
end;

end;
suppose L405: ( width C52 ) = ( 0 );

reconsider D59 = ( {} ) as (Matrix of R8) by L112;
thus L406: thesis
proof
take D59;
L407: ( Indices D59 ) = [: ( {} ) , ( Seg ( width D59 ) ) :];
L408: ( Seg ( width C52 ) ) = ( {} ) by L405;
thus L409: thesis by L408 , L405 , L407 , ZFMISC_1:90;
end;

end;
end;
thus L408: thesis by L399;
end;
uniqueness
proof
let C54 , C55 being (Matrix of R8);
assume that
L409: ( len C54 ) = ( width C52 )
and
L410: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices C54 ) iff [ R5 , R4 ] in ( Indices C52 ))))
and
L411: (for R4 being Nat holds (for R5 being Nat holds ([ R5 , R4 ] in ( Indices C52 ) implies ( C54 * (R4 , R5) ) = ( C52 * (R5 , R4) ))))
and
L412: ( len C55 ) = ( width C52 )
and
L413: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices C55 ) iff [ R5 , R4 ] in ( Indices C52 ))))
and
L414: (for R4 being Nat holds (for R5 being Nat holds ([ R5 , R4 ] in ( Indices C52 ) implies ( C55 * (R4 , R5) ) = ( C52 * (R5 , R4) ))));
L415:
now
let R4 being Nat;
let R5 being Nat;
assume L416: [ R4 , R5 ] in ( Indices C54 );
L417: [ R5 , R4 ] in ( Indices C52 ) by L416 , L410;
L418: ( C54 * (R4 , R5) ) = ( C52 * (R5 , R4) ) by L417 , L411;
thus L419: ( C54 * (R4 , R5) ) = ( C55 * (R4 , R5) ) by L418 , L414 , L417;
end;
L420:
now
let R1 being set;
let R2 being set;
thus L421: ([ R1 , R2 ] in [: ( dom C54 ) , ( Seg ( width C54 ) ) :] implies [ R1 , R2 ] in [: ( dom C55 ) , ( Seg ( width C55 ) ) :])
proof
assume L422: [ R1 , R2 ] in [: ( dom C54 ) , ( Seg ( width C54 ) ) :];
L423: R1 in ( dom C54 ) by L422 , ZFMISC_1:87;
reconsider D60 = R1 as (Element of ( NAT )) by L423;
L424: R2 in ( Seg ( width C54 ) ) by L422 , ZFMISC_1:87;
reconsider D61 = R2 as (Element of ( NAT )) by L424;
L425: [ D61 , D60 ] in ( Indices C52 ) by L410 , L422;
thus L426: thesis by L425 , L413;
end;

thus L427: ([ R1 , R2 ] in [: ( dom C55 ) , ( Seg ( width C55 ) ) :] implies [ R1 , R2 ] in [: ( dom C54 ) , ( Seg ( width C54 ) ) :])
proof
assume L428: [ R1 , R2 ] in [: ( dom C55 ) , ( Seg ( width C55 ) ) :];
L429: R1 in ( dom C55 ) by L428 , ZFMISC_1:87;
reconsider D62 = R1 as (Element of ( NAT )) by L429;
L430: R2 in ( Seg ( width C55 ) ) by L428 , ZFMISC_1:87;
reconsider D63 = R2 as (Element of ( NAT )) by L430;
L431: [ D63 , D62 ] in ( Indices C52 ) by L413 , L428;
thus L432: thesis by L431 , L410;
end;

end;
L428: [: ( dom C54 ) , ( Seg ( width C54 ) ) :] = [: ( dom C55 ) , ( Seg ( width C55 ) ) :] by L420 , ZFMISC_1:89;
L429:
now
assume L430: ( len C54 ) <> ( 0 );
L431: ( Seg ( len C55 ) ) <> ( {} ) by L430 , L409 , L412;
L432: ( dom C55 ) <> ( {} ) by L431 , FINSEQ_1:def 3;
L433:
now
per cases ;
suppose L434: ( Seg ( width C54 ) ) <> ( {} );

L435: ( Seg ( len C54 ) ) <> ( {} ) by L430;
L436: ( dom C54 ) <> ( {} ) by L435 , FINSEQ_1:def 3;
L437: ( Seg ( width C54 ) ) = ( Seg ( width C55 ) ) by L436 , L428 , L434 , ZFMISC_1:110;
thus L438: ( width C54 ) = ( width C55 ) by L437 , FINSEQ_1:6;
end;
suppose L439: ( Seg ( width C54 ) ) = ( {} );

L440: [: ( dom C55 ) , ( Seg ( width C55 ) ) :] = ( {} ) by L439 , L428 , ZFMISC_1:90;
L441: ( Seg ( width C55 ) ) = ( {} ) by L440 , L432 , ZFMISC_1:90;
thus L442: ( width C54 ) = ( width C55 ) by L441 , L439 , FINSEQ_1:6;
end;
end;
thus L444: (( len C54 ) = ( len C55 ) & ( width C54 ) = ( width C55 )) by L433 , L409 , L412;
end;
L445: (( len C54 ) = ( 0 ) implies (( len C55 ) = ( 0 ) & ( width C54 ) = ( 0 ) & ( width C55 ) = ( 0 ))) by L409 , L412 , L137;
thus L446: thesis by L445 , L429 , L415 , L189;
end;
end;
L448: (for R8 being non  empty set holds (for B42 being (Matrix of R8) holds (( width B42 ) > ( 0 ) implies (( len ( B42 @ ) ) = ( width B42 ) & ( width ( B42 @ ) ) = ( len B42 )))))
proof
let R8 being non  empty set;
let C56 being (Matrix of R8);
assume L449: ( width C56 ) > ( 0 );
thus L450: ( len ( C56 @ ) ) = ( width C56 ) by L398;
L451: ( len C56 ) >= ( 0 ) by NAT_1:2;
per cases  by L451 , XXREAL_0:1;
suppose L452: ( len C56 ) = ( 0 );

thus L453: thesis by L452 , L449 , L137;
end;
suppose L454: ( len C56 ) > ( 0 );

L455: (for B43 , B44 being set holds ([ B43 , B44 ] in [: ( dom ( C56 @ ) ) , ( Seg ( width ( C56 @ ) ) ) :] iff [ B43 , B44 ] in [: ( Seg ( width C56 ) ) , ( dom C56 ) :]))
proof
let C57 , C58 being set;
thus L456: ([ C57 , C58 ] in [: ( dom ( C56 @ ) ) , ( Seg ( width ( C56 @ ) ) ) :] implies [ C57 , C58 ] in [: ( Seg ( width C56 ) ) , ( dom C56 ) :])
proof
assume L457: [ C57 , C58 ] in [: ( dom ( C56 @ ) ) , ( Seg ( width ( C56 @ ) ) ) :];
L458: (C57 in ( dom ( C56 @ ) ) & C58 in ( Seg ( width ( C56 @ ) ) )) by L457 , ZFMISC_1:87;
reconsider D64 = C57 , D65 = C58 as (Element of ( NAT )) by L458;
L459: [ D64 , D65 ] in ( Indices ( C56 @ ) ) by L457;
L460: [ D65 , D64 ] in ( Indices C56 ) by L459 , L398;
thus L461: thesis by L460 , ZFMISC_1:88;
end;

assume L462: [ C57 , C58 ] in [: ( Seg ( width C56 ) ) , ( dom C56 ) :];
L463: (C57 in ( Seg ( width C56 ) ) & C58 in ( dom C56 )) by L462 , ZFMISC_1:87;
reconsider D66 = C57 , D67 = C58 as (Element of ( NAT )) by L463;
L464: [ D67 , D66 ] in ( Indices C56 ) by L462 , ZFMISC_1:88;
L465: [ D66 , D67 ] in ( Indices ( C56 @ ) ) by L464 , L398;
thus L466: thesis by L465;
end;
L467: (( dom C56 ) = ( Seg ( len C56 ) ) & [: ( Seg ( width C56 ) ) , ( dom C56 ) :] = [: ( dom ( C56 @ ) ) , ( Seg ( width ( C56 @ ) ) ) :]) by L455 , FINSEQ_1:def 3 , ZFMISC_1:89;
L468: ( dom C56 ) = ( Seg ( width ( C56 @ ) ) ) by L467 , L449 , L454 , ZFMISC_1:110;
thus L469: thesis by L468 , FINSEQ_1:def 3;
end;
end;
L471: (for B45 being (Element of ( NAT )) holds (for B46 being non  empty set holds (for B47 being (Matrix of B45 , B46) holds ( B47 @ ) is (Matrix of B45 , B46))))
proof
let C59 being (Element of ( NAT ));
let C60 being non  empty set;
let C61 being (Matrix of C59 , C60);
L472: ( len C61 ) = C59 by L75;
L473: (for B48 being (FinSequence of C60) holds (B48 in ( rng ( C61 @ ) ) implies ( len B48 ) = C59))
proof
let C62 being (FinSequence of C60);
consider C63 being Nat such that L474: (for B49 being set holds (B49 in ( rng ( C61 @ ) ) implies (ex B50 being FinSequence st (B50 = B49 & ( len B50 ) = C63)))) by L1;
L475: (for B51 being (FinSequence of C60) holds (B51 in ( rng ( C61 @ ) ) implies ( len B51 ) = C63))
proof
let C64 being (FinSequence of C60);
assume L476: C64 in ( rng ( C61 @ ) );
L477: (ex B52 being FinSequence st (B52 = C64 & ( len B52 ) = C63)) by L476 , L474;
thus L478: thesis by L477;
end;
assume L479: C62 in ( rng ( C61 @ ) );
L480: (ex B53 being FinSequence st (B53 = C62 & ( len B53 ) = C63)) by L479 , L474;
L481:
now
per cases ;
case L482: C59 > ( 0 );
L483: ( width C61 ) = C59 by L482 , L472 , L158;
L484: ( width ( C61 @ ) ) = ( len C61 ) by L483 , L482 , L448;
L485: ( len ( C61 @ ) ) = ( width C61 ) by L482 , L483 , L448;
L486: ( C61 @ ) is (Matrix of C59 , C63 , C60) by L485 , L475 , L483 , L75;
thus L487: thesis by L486 , L472 , L480 , L482 , L483 , L485 , L484 , L158;
end;
case L488: C59 <= ( 0 );
L489: (( len ( C61 @ ) ) = ( width C61 ) & (ex B54 being set st (B54 in ( dom ( C61 @ ) ) & C62 = ( ( C61 @ ) . B54 )))) by L479 , L398 , FUNCT_1:def 3;
L490: ( width C61 ) = ( 0 ) by L472 , L488 , L137;
L491: ( Seg ( width C61 ) ) = ( {} ) by L490;
thus L492: thesis by L491 , L489 , FINSEQ_1:def 3;
end;
end;
thus L494: thesis by L481;
end;
L495: ( len ( C61 @ ) ) = ( width C61 ) by L398;
L496:
now
L497: C59 >= ( 0 ) by NAT_1:2;
per cases  by L497 , XXREAL_0:1;
case L498: C59 > ( 0 );
thus L499: ( len ( C61 @ ) ) = C59 by L498 , L495 , L472 , L158;
end;
case L500: C59 = ( 0 );
thus L501: ( len ( C61 @ ) ) = C59 by L500 , L495 , L472 , L137;
end;
end;
thus L503: thesis by L496 , L473 , L75;
end;
definition
let R6 being Nat;
let R8 being non  empty set;
let C65 being (Matrix of R6 , R8);
redefine func C65 @ -> (Matrix of R6 , R8);

coherence
proof
L504: R6 in ( NAT ) by ORDINAL1:def 12;
thus L505: thesis by L504 , L471;
end;
end;
definition
let R8 being non  empty set;
let R24 being (Matrix of R8);
let R4 being Nat;
func Line (R24 , R4) -> (FinSequence of R8) means 
:L507: (( len it ) = ( width R24 ) & (for R5 being Nat holds (R5 in ( Seg ( width R24 ) ) implies ( it . R5 ) = ( R24 * (R4 , R5) ))));
existence
proof
deffunc H4(Nat) = ( R24 * (R4 , $1) );
consider C66 being (FinSequence of R8) such that L508: ( len C66 ) = ( width R24 ) and L509: (for B55 being Nat holds (B55 in ( dom C66 ) implies ( C66 . B55 ) = H4(B55))) from FINSEQ_2:sch 1;
take C66;
thus L510: ( len C66 ) = ( width R24 ) by L508;
let R5 being Nat;
L511: ( dom C66 ) = ( Seg ( width R24 ) ) by L508 , FINSEQ_1:def 3;
thus L512: thesis by L511 , L509;
end;
uniqueness
proof
let C67 , C68 being (FinSequence of R8);
assume that
L513: ( len C67 ) = ( width R24 )
and
L514: (for R5 being Nat holds (R5 in ( Seg ( width R24 ) ) implies ( C67 . R5 ) = ( R24 * (R4 , R5) )))
and
L515: ( len C68 ) = ( width R24 )
and
L516: (for R5 being Nat holds (R5 in ( Seg ( width R24 ) ) implies ( C68 . R5 ) = ( R24 * (R4 , R5) )));
L517: ( dom C67 ) = ( Seg ( width R24 ) ) by L513 , FINSEQ_1:def 3;
L518: (for B56 being Nat holds (B56 in ( dom C67 ) implies ( C67 . B56 ) = ( C68 . B56 )))
proof
let C69 being Nat;
assume L519: C69 in ( dom C67 );
L520: ( C67 . C69 ) = ( R24 * (R4 , C69) ) by L519 , L514 , L517;
thus L521: thesis by L520 , L516 , L517 , L519;
end;
thus L522: thesis by L518 , L513 , L515 , FINSEQ_2:9;
end;
func Col (R24 , R4) -> (FinSequence of R8) means 
:L523: (( len it ) = ( len R24 ) & (for R5 being Nat holds (R5 in ( dom R24 ) implies ( it . R5 ) = ( R24 * (R5 , R4) ))));
existence
proof
deffunc H5(Nat) = ( R24 * ($1 , R4) );
consider C70 being (FinSequence of R8) such that L524: ( len C70 ) = ( len R24 ) and L525: (for B57 being Nat holds (B57 in ( dom C70 ) implies ( C70 . B57 ) = H5(B57))) from FINSEQ_2:sch 1;
take C70;
thus L526: ( len C70 ) = ( len R24 ) by L524;
let R5 being Nat;
L527: ( Seg ( len R24 ) ) = ( dom R24 ) by FINSEQ_1:def 3;
L528: ( dom C70 ) = ( Seg ( len R24 ) ) by L524 , FINSEQ_1:def 3;
thus L529: thesis by L528 , L525 , L527;
end;
uniqueness
proof
let C71 , C72 being (FinSequence of R8);
assume that
L530: ( len C71 ) = ( len R24 )
and
L531: (for R5 being Nat holds (R5 in ( dom R24 ) implies ( C71 . R5 ) = ( R24 * (R5 , R4) )))
and
L532: ( len C72 ) = ( len R24 )
and
L533: (for R5 being Nat holds (R5 in ( dom R24 ) implies ( C72 . R5 ) = ( R24 * (R5 , R4) )));
L534: ( dom C71 ) = ( Seg ( len R24 ) ) by L530 , FINSEQ_1:def 3;
L535: (for B58 being Nat holds (B58 in ( dom C71 ) implies ( C71 . B58 ) = ( C72 . B58 )))
proof
let C73 being Nat;
assume L536: C73 in ( dom C71 );
L537: C73 in ( dom R24 ) by L536 , L534 , FINSEQ_1:def 3;
L538: ( C71 . C73 ) = ( R24 * (C73 , R4) ) by L537 , L531;
thus L539: thesis by L538 , L533 , L537;
end;
thus L540: thesis by L535 , L530 , L532 , FINSEQ_2:9;
end;
end;
definition
let R8 being non  empty set;
let C74 being (Matrix of R8);
let R4 being Nat;
redefine func Line (C74 , R4) -> (Element of ( ( width C74 ) -tuples_on R8 ));

coherence
proof
L542: (( len ( Line (C74 , R4) ) ) = ( width C74 ) & ( Line (C74 , R4) ) is (Element of ( R8 * ))) by L507 , FINSEQ_1:def 11;
L543: ( Line (C74 , R4) ) in { B59 where B59 is (Element of ( R8 * )) : ( len B59 ) = ( width C74 ) } by L542;
thus L544: thesis by L543;
end;
redefine func Col (C74 , R4) -> (Element of ( ( len C74 ) -tuples_on R8 ));

coherence
proof
L545: (( len ( Col (C74 , R4) ) ) = ( len C74 ) & ( Col (C74 , R4) ) is (Element of ( R8 * ))) by L523 , FINSEQ_1:def 11;
L546: ( Col (C74 , R4) ) in { B60 where B60 is (Element of ( R8 * )) : ( len B60 ) = ( len C74 ) } by L545;
thus L547: thesis by L546;
end;
end;
definition
let R9 being non  empty doubleLoopStr;
let R6 being Nat;
func R6 -Matrices_over R9 -> set equals 
( R6 -tuples_on ( R6 -tuples_on (the carrier of R9) ) );
coherence;
func 0. (R9 , R6) -> (Matrix of R6 , R9) equals 
( R6 |-> ( R6 |-> ( 0. R9 ) ) );
coherence by L88;
func 1. (R9 , R6) -> (Matrix of R6 , R9) means 
:L549: ((for R4 being Nat holds ([ R4 , R4 ] in ( Indices it ) implies ( it * (R4 , R4) ) = ( 1. R9 ))) & (for R4 being Nat holds (for R5 being Nat holds (([ R4 , R5 ] in ( Indices it ) & R4 <> R5) implies ( it * (R4 , R5) ) = ( 0. R9 )))));
existence
proof
defpred S4[ set , set , set ] means (($1 = $2 implies $3 = ( 1. R9 )) & ($1 <> $2 implies $3 = ( 0. R9 )));
reconsider D68 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
L550: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in [: ( Seg D68 ) , ( Seg D68 ) :] implies (ex B61 being (Element of R9) st S4[ R4 , R5 , B61 ]))))
proof
let R4 being Nat;
let R5 being Nat;
assume L551: [ R4 , R5 ] in [: ( Seg D68 ) , ( Seg D68 ) :];
L552: (R4 = R5 implies S4[ R4 , R5 , ( 1. R9 ) ]);
thus L553: thesis by L552;
end;
consider C75 being (Matrix of D68 , R9) such that L554: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices C75 ) implies S4[ R4 , R5 , ( C75 * (R4 , R5) ) ]))) from MatrixEx(L550);
reconsider D69 = C75 as (Matrix of R6 , R9);
take D69;
thus L555: thesis by L554;
end;
uniqueness
proof
let C76 , C77 being (Matrix of R6 , R9);
assume that
L556: (for R4 being Nat holds ([ R4 , R4 ] in ( Indices C76 ) implies ( C76 * (R4 , R4) ) = ( 1. R9 )))
and
L557: (for R4 being Nat holds (for R5 being Nat holds (([ R4 , R5 ] in ( Indices C76 ) & R4 <> R5) implies ( C76 * (R4 , R5) ) = ( 0. R9 ))))
and
L558: (for R4 being Nat holds ([ R4 , R4 ] in ( Indices C77 ) implies ( C77 * (R4 , R4) ) = ( 1. R9 )))
and
L559: (for R4 being Nat holds (for R5 being Nat holds (([ R4 , R5 ] in ( Indices C77 ) & R4 <> R5) implies ( C77 * (R4 , R5) ) = ( 0. R9 ))));
L560: ( Indices C76 ) = ( Indices C77 ) by L364;
L561:
now
let R4 being Nat;
let R5 being Nat;
assume L562: [ R4 , R5 ] in ( Indices C76 );
L563:
now
assume L564: R4 <> R5;
L565: ( C76 * (R4 , R5) ) = ( 0. R9 ) by L564 , L557 , L562;
thus L566: ( C76 * (R4 , R5) ) = ( C77 * (R4 , R5) ) by L565 , L560 , L559 , L562 , L564;
end;
L567:
now
assume L568: R4 = R5;
L569: ( C76 * (R4 , R5) ) = ( 1. R9 ) by L568 , L556 , L562;
thus L570: ( C76 * (R4 , R5) ) = ( C77 * (R4 , R5) ) by L569 , L560 , L558 , L562 , L568;
end;
thus L571: ( C76 * (R4 , R5) ) = ( C77 * (R4 , R5) ) by L567 , L563;
end;
L572: (( len C77 ) = R6 & ( width C77 ) = R6) by L350;
L573: (( len C76 ) = R6 & ( width C76 ) = R6) by L350;
thus L574: thesis by L573 , L561 , L572 , L189;
end;
let R27 being (Matrix of R6 , R9);
func - R27 -> (Matrix of R6 , R9) means 
:L575: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices R27 ) implies ( it * (R4 , R5) ) = ( - ( R27 * (R4 , R5) ) ))));
existence
proof
deffunc H6(Nat , Nat) = ( - ( R27 * ($1 , $2) ) );
reconsider D70 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C78 being (Matrix of D70 , R9) such that L576: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices C78 ) implies ( C78 * (R4 , R5) ) = H6(R4 , R5)))) from MatrixLambda;
L577: ( Indices R27 ) = [: ( Seg R6 ) , ( Seg R6 ) :] by L350;
L578: ( Indices R27 ) = ( Indices C78 ) by L577 , L350;
reconsider D71 = C78 as (Matrix of R6 , R9);
take D71;
thus L579: thesis by L576 , L578;
end;
uniqueness
proof
let C79 , C80 being (Matrix of R6 , R9);
assume that
L580: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices R27 ) implies ( C79 * (R4 , R5) ) = ( - ( R27 * (R4 , R5) ) ))))
and
L581: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices R27 ) implies ( C80 * (R4 , R5) ) = ( - ( R27 * (R4 , R5) ) ))));
L582:
now
let R4 being Nat;
let R5 being Nat;
assume L583: [ R4 , R5 ] in ( Indices R27 );
L584: ( C79 * (R4 , R5) ) = ( - ( R27 * (R4 , R5) ) ) by L583 , L580;
thus L585: ( C79 * (R4 , R5) ) = ( C80 * (R4 , R5) ) by L584 , L581 , L583;
end;
L586: ( Indices C79 ) = [: ( Seg R6 ) , ( Seg R6 ) :] by L350;
L587: ( Indices R27 ) = ( Indices C79 ) by L586 , L350;
thus L588: thesis by L587 , L582 , L378;
end;
let R28 being (Matrix of R6 , R9);
func R27 + R28 -> (Matrix of R6 , R9) means 
:L589: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices R27 ) implies ( it * (R4 , R5) ) = ( ( R27 * (R4 , R5) ) + ( R28 * (R4 , R5) ) ))));
existence
proof
deffunc H7(Nat , Nat) = ( ( R27 * ($1 , $2) ) + ( R28 * ($1 , $2) ) );
reconsider D72 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C81 being (Matrix of D72 , R9) such that L590: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices C81 ) implies ( C81 * (R4 , R5) ) = H7(R4 , R5)))) from MatrixLambda;
L591: ( Indices R27 ) = [: ( Seg R6 ) , ( Seg R6 ) :] by L350;
L592: ( Indices R27 ) = ( Indices C81 ) by L591 , L350;
reconsider D73 = C81 as (Matrix of R6 , R9);
take D73;
thus L593: thesis by L590 , L592;
end;
uniqueness
proof
let C82 , C83 being (Matrix of R6 , R9);
assume that
L594: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices R27 ) implies ( C82 * (R4 , R5) ) = ( ( R27 * (R4 , R5) ) + ( R28 * (R4 , R5) ) ))))
and
L595: (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices R27 ) implies ( C83 * (R4 , R5) ) = ( ( R27 * (R4 , R5) ) + ( R28 * (R4 , R5) ) ))));
L596:
now
let R4 being Nat;
let R5 being Nat;
assume L597: [ R4 , R5 ] in ( Indices R27 );
L598: ( C82 * (R4 , R5) ) = ( ( R27 * (R4 , R5) ) + ( R28 * (R4 , R5) ) ) by L597 , L594;
thus L599: ( C82 * (R4 , R5) ) = ( C83 * (R4 , R5) ) by L598 , L595 , L597;
end;
L600: ( Indices C82 ) = [: ( Seg R6 ) , ( Seg R6 ) :] by L350;
L601: ( Indices R27 ) = ( Indices C82 ) by L600 , L350;
thus L602: thesis by L601 , L596 , L378;
end;
end;
registration
let R9 being non  empty doubleLoopStr;
let R6 being Nat;
cluster ( R6 -Matrices_over R9 ) -> non  empty;
coherence;
end;
theorem
L605: (for R4 being Nat holds (for R5 being Nat holds (for R6 being Nat holds (for R9 being non  empty doubleLoopStr holds ([ R4 , R5 ] in ( Indices ( 0. (R9 , R6) ) ) implies ( ( 0. (R9 , R6) ) * (R4 , R5) ) = ( 0. R9 ))))))
proof
let R4 being Nat;
let R5 being Nat;
let R6 being Nat;
let R9 being non  empty doubleLoopStr;
reconsider D74 = R6 as (Element of ( NAT )) by ORDINAL1:def 12;
set D75 = ( 0. (R9 , R6) );
assume L606: [ R4 , R5 ] in ( Indices D75 );
L607: [ R4 , R5 ] in [: ( Seg R6 ) , ( Seg R6 ) :] by L606 , L350;
L608: R5 in ( Seg R6 ) by L607 , ZFMISC_1:87;
L609: ( ( D74 |-> ( 0. R9 ) ) . R5 ) = ( 0. R9 ) by L608 , FUNCOP_1:7;
L610: R4 in ( Seg R6 ) by L607 , ZFMISC_1:87;
L611: ( D75 . R4 ) = ( D74 |-> ( 0. R9 ) ) by L610 , FUNCOP_1:7;
thus L612: thesis by L611 , L606 , L609 , L172;
end;
theorem
L613: (for R1 being set holds (for R6 being Nat holds (for R9 being non  empty doubleLoopStr holds (R1 is (Element of ( R6 -Matrices_over R9 )) iff R1 is (Matrix of R6 , R9)))))
proof
let R1 being set;
let R6 being Nat;
let R9 being non  empty doubleLoopStr;
thus L614: (R1 is (Element of ( R6 -Matrices_over R9 )) implies R1 is (Matrix of R6 , R9))
proof
assume L615: R1 is (Element of ( R6 -Matrices_over R9 ));
reconsider D76 = R1 as (Element of ( R6 -tuples_on ( R6 -tuples_on (the carrier of R9) ) )) by L615;
L616: ( len D76 ) = R6 by CARD_1:def 7;
L617: (ex R7 being Nat st (for R2 being set holds (R2 in ( rng D76 ) implies (ex B62 being (FinSequence of R9) st (R2 = B62 & ( len B62 ) = R7)))))
proof
take R6;
let R2 being set;
L618: ( rng D76 ) c= ( R6 -tuples_on (the carrier of R9) ) by FINSEQ_1:def 4;
assume L619: R2 in ( rng D76 );
reconsider D77 = R2 as (Element of ( R6 -tuples_on (the carrier of R9) )) by L619 , L618;
reconsider D78 = D77 as (FinSequence of R9);
take D78;
thus L620: thesis by CARD_1:def 7;
end;
reconsider D79 = D76 as (Matrix of (the carrier of R9)) by L617 , L50;
L621: (for B63 being (FinSequence of R9) holds (B63 in ( rng D79 ) implies ( len B63 ) = R6))
proof
let C84 being (FinSequence of R9);
L622: ( rng D79 ) c= ( R6 -tuples_on (the carrier of R9) ) by FINSEQ_1:def 4;
assume L623: C84 in ( rng D79 );
reconsider D80 = C84 as (Element of ( R6 -tuples_on (the carrier of R9) )) by L623 , L622;
L624: ( len D80 ) = R6 by CARD_1:def 7;
thus L625: thesis by L624;
end;
thus L626: thesis by L621 , L616 , L75;
end;

assume L627: R1 is (Matrix of R6 , R9);
reconsider D81 = R1 as (Matrix of R6 , R9) by L627;
L628: ( len D81 ) = R6 by L75;
reconsider D82 = D81 as (Element of ( R6 -tuples_on ( (the carrier of R9) * ) )) by L628 , FINSEQ_2:92;
L629: ( rng D82 ) c= ( R6 -tuples_on (the carrier of R9) )
proof
let R2 being set;
assume L630: R2 in ( rng D82 );
L631: ( rng D82 ) c= ( (the carrier of R9) * ) by FINSEQ_1:def 4;
reconsider D83 = R2 as (FinSequence of R9) by L631 , L630 , FINSEQ_1:def 11;
L632: ( len D83 ) = R6 by L630 , L75;
L633: D83 is (Element of ( R6 -tuples_on (the carrier of R9) )) by L632 , FINSEQ_2:92;
thus L634: thesis by L633;
end;
L635: D82 is (FinSequence of ( R6 -tuples_on (the carrier of R9) )) by L629 , FINSEQ_1:def 4;
thus L636: thesis by L635 , L628 , FINSEQ_2:92;
end;
definition
let C85 being non  empty ZeroStr;
let C86 being (Matrix of C85);
attr C86 is  diagonal
means
(for R4 being Nat holds (for R5 being Nat holds (([ R4 , R5 ] in ( Indices C86 ) & ( C86 * (R4 , R5) ) <> ( 0. C85 )) implies R4 = R5)));
end;
registration
let R6 being Nat;
let R9 being non  empty doubleLoopStr;
cluster  diagonal for (Matrix of R6 , R9);
existence
proof
take ( 1. (R9 , R6) );
let R4 being Nat;
let R5 being Nat;
thus L638: thesis by L549;
end;
end;
definition
let R9 being non  empty doubleLoopStr;
let R6 being Nat;
mode Diagonal of R6 , R9
 is  diagonal (Matrix of R6 , R9);
end;
theorem
L641: (for R6 being Nat holds (for R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr holds (for R29 being (Matrix of R6 , R23) holds (for R31 being (Matrix of R6 , R23) holds ( R29 + R31 ) = ( R31 + R29 )))))
proof
let R6 being Nat;
let R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr;
let R29 being (Matrix of R6 , R23);
let R31 being (Matrix of R6 , R23);
L642: ( Indices R29 ) = ( Indices ( R29 + R31 ) ) by L364;
L643: ( Indices R29 ) = ( Indices R31 ) by L364;
L644:
now
let R4 being Nat;
let R5 being Nat;
assume L645: [ R4 , R5 ] in ( Indices ( R29 + R31 ) );
thus L646: ( ( R29 + R31 ) * (R4 , R5) ) = ( ( R29 * (R4 , R5) ) + ( R31 * (R4 , R5) ) ) by L645 , L642 , L589
.= ( ( R31 + R29 ) * (R4 , R5) ) by L643 , L642 , L645 , L589;
end;
thus L647: thesis by L644 , L378;
end;
theorem
L648: (for R6 being Nat holds (for R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr holds (for R29 being (Matrix of R6 , R23) holds (for R31 being (Matrix of R6 , R23) holds (for R33 being (Matrix of R6 , R23) holds ( ( R29 + R31 ) + R33 ) = ( R29 + ( R31 + R33 ) ))))))
proof
let R6 being Nat;
let R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr;
let R29 being (Matrix of R6 , R23);
let R31 being (Matrix of R6 , R23);
let R33 being (Matrix of R6 , R23);
L649: ( Indices R29 ) = ( Indices ( ( R29 + R31 ) + R33 ) ) by L364;
L650: ( Indices R29 ) = ( Indices ( R29 + R31 ) ) by L364;
L651: ( Indices R29 ) = ( Indices R31 ) by L364;
L652:
now
let R4 being Nat;
let R5 being Nat;
assume L653: [ R4 , R5 ] in ( Indices ( ( R29 + R31 ) + R33 ) );
thus L654: ( ( ( R29 + R31 ) + R33 ) * (R4 , R5) ) = ( ( ( R29 + R31 ) * (R4 , R5) ) + ( R33 * (R4 , R5) ) ) by L653 , L649 , L650 , L589
.= ( ( ( R29 * (R4 , R5) ) + ( R31 * (R4 , R5) ) ) + ( R33 * (R4 , R5) ) ) by L649 , L653 , L589
.= ( ( R29 * (R4 , R5) ) + ( ( R31 * (R4 , R5) ) + ( R33 * (R4 , R5) ) ) ) by RLVECT_1:def 3
.= ( ( R29 * (R4 , R5) ) + ( ( R31 + R33 ) * (R4 , R5) ) ) by L651 , L649 , L653 , L589
.= ( ( R29 + ( R31 + R33 ) ) * (R4 , R5) ) by L649 , L653 , L589;
end;
thus L655: thesis by L652 , L378;
end;
theorem
L656: (for R6 being Nat holds (for R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr holds (for R29 being (Matrix of R6 , R23) holds ( R29 + ( 0. (R23 , R6) ) ) = R29)))
proof
let R6 being Nat;
let R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr;
let R29 being (Matrix of R6 , R23);
L657: ( Indices R29 ) = ( Indices ( R29 + ( 0. (R23 , R6) ) ) ) by L364;
L658: ( Indices R29 ) = ( Indices ( 0. (R23 , R6) ) ) by L364;
L659:
now
let R4 being Nat;
let R5 being Nat;
assume L660: [ R4 , R5 ] in ( Indices ( R29 + ( 0. (R23 , R6) ) ) );
thus L661: ( ( R29 + ( 0. (R23 , R6) ) ) * (R4 , R5) ) = ( ( R29 * (R4 , R5) ) + ( ( 0. (R23 , R6) ) * (R4 , R5) ) ) by L660 , L657 , L589
.= ( ( R29 * (R4 , R5) ) + ( 0. R23 ) ) by L657 , L658 , L660 , L605
.= ( R29 * (R4 , R5) ) by RLVECT_1:4;
end;
thus L662: thesis by L659 , L378;
end;
theorem
L663: (for R6 being Nat holds (for R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr holds (for R29 being (Matrix of R6 , R23) holds ( R29 + ( - R29 ) ) = ( 0. (R23 , R6) ))))
proof
let R6 being Nat;
let R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr;
let R29 being (Matrix of R6 , R23);
L664: ( Indices R29 ) = ( Indices ( R29 + ( - R29 ) ) ) by L364;
L665: ( Indices R29 ) = ( Indices ( 0. (R23 , R6) ) ) by L364;
L666:
now
let R4 being Nat;
let R5 being Nat;
assume L667: [ R4 , R5 ] in ( Indices ( R29 + ( - R29 ) ) );
thus L668: ( ( R29 + ( - R29 ) ) * (R4 , R5) ) = ( ( R29 * (R4 , R5) ) + ( ( - R29 ) * (R4 , R5) ) ) by L667 , L664 , L589
.= ( ( R29 * (R4 , R5) ) + ( - ( R29 * (R4 , R5) ) ) ) by L664 , L667 , L575
.= ( 0. R23 ) by RLVECT_1:def 10
.= ( ( 0. (R23 , R6) ) * (R4 , R5) ) by L665 , L664 , L667 , L605;
end;
thus L669: thesis by L666 , L378;
end;
definition
let R23 being  add-associative  right_zeroed  right_complementable  Abelian non  empty doubleLoopStr;
let R6 being Nat;
func R6 -G_Matrix_over R23 ->  strict AbGroup means 
((the carrier of it) = ( R6 -Matrices_over R23 ) & (for R29 being (Matrix of R6 , R23) holds (for R31 being (Matrix of R6 , R23) holds ( (the addF of it) . (R29 , R31) ) = ( R29 + R31 ))) & ( 0. it ) = ( 0. (R23 , R6) ));
existence
proof
reconsider D84 = ( 0. (R23 , R6) ) as (Element of ( R6 -Matrices_over R23 ));
defpred S5[ (Element of ( R6 -Matrices_over R23 )) , (Element of ( R6 -Matrices_over R23 )) , (Element of ( R6 -Matrices_over R23 )) ] means (ex R29 being (Matrix of R6 , R23) st (ex R31 being (Matrix of R6 , R23) st ($1 = R29 & $2 = R31 & $3 = ( R29 + R31 ))));
L670: (for B64 , B65 being (Element of ( R6 -Matrices_over R23 )) holds (ex B66 being (Element of ( R6 -Matrices_over R23 )) st S5[ B64 , B65 , B66 ]))
proof
let C87 , C88 being (Element of ( R6 -Matrices_over R23 ));
reconsider D85 = C88 as (Matrix of R6 , R23) by L613;
reconsider D86 = C87 as (Matrix of R6 , R23) by L613;
reconsider D87 = ( D86 + D85 ) as (Element of ( R6 -Matrices_over R23 )) by L613;
take D87;
thus L671: thesis;
end;
consider C89 being (BinOp of ( R6 -Matrices_over R23 )) such that L672: (for B67 , B68 being (Element of ( R6 -Matrices_over R23 )) holds S5[ B67 , B68 , ( C89 . (B67 , B68) ) ]) from BINOP_1:sch 3(L670);
set D88 = addLoopStr (# ( R6 -Matrices_over R23 ) , C89 , D84 #);
L673: (for R29 being (Matrix of R6 , R23) holds (for R31 being (Matrix of R6 , R23) holds ( C89 . (R29 , R31) ) = ( R29 + R31 )))
proof
let R29 being (Matrix of R6 , R23);
let R31 being (Matrix of R6 , R23);
L674: (R29 is (Element of ( R6 -Matrices_over R23 )) & R31 is (Element of ( R6 -Matrices_over R23 ))) by L613;
L675: (ex R30 being (Matrix of R6 , R23) st (ex R32 being (Matrix of R6 , R23) st (R29 = R30 & R31 = R32 & ( C89 . (R29 , R31) ) = ( R30 + R32 )))) by L674 , L672;
thus L676: thesis by L675;
end;
L677: (for B69 being (Element of ( R6 -Matrices_over R23 )) holds (ex B70 being (Element of ( R6 -Matrices_over R23 )) st (ex R29 being (Matrix of R6 , R23) st (B69 = R29 & B70 = ( - R29 )))))
proof
let C90 being (Element of ( R6 -Matrices_over R23 ));
reconsider D89 = C90 as (Matrix of R6 , R23) by L613;
reconsider D90 = ( - D89 ) as (Element of ( R6 -Matrices_over R23 )) by L613;
take D90;
thus L678: thesis;
end;
L679: D88 is  Abelian  add-associative  right_zeroed  right_complementable
proof
thus L680: D88 is  Abelian
proof
let C91 , C92 being (Element of D88);
reconsider D91 = C91 , D92 = C92 as (Matrix of R6 , R23) by L613;
thus L681: ( C91 + C92 ) = ( D91 + D92 ) by L673
.= ( D92 + D91 ) by L641
.= ( C92 + C91 ) by L673;
end;

thus L682:now
let C93 , C94 , C95 being (Element of D88);
reconsider D93 = C93 , D94 = C94 , D95 = C95 as (Matrix of R6 , R23) by L613;
thus L683: ( ( C93 + C94 ) + C95 ) = ( C89 . (( D93 + D94 ) , D95) ) by L673
.= ( ( D93 + D94 ) + D95 ) by L673
.= ( D93 + ( D94 + D95 ) ) by L648
.= ( C89 . (D93 , ( D94 + D95 )) ) by L673
.= ( C93 + ( C94 + C95 ) ) by L673;
end;
thus L684:now
let C96 being (Element of D88);
reconsider D96 = C96 as (Matrix of R6 , R23) by L613;
thus L685: ( C96 + ( 0. D88 ) ) = ( D96 + ( 0. (R23 , R6) ) ) by L673
.= C96 by L656;
end;
let C97 being (Element of D88);
consider C98 being (Element of ( R6 -Matrices_over R23 )) such that L686: (ex R29 being (Matrix of R6 , R23) st (C97 = R29 & C98 = ( - R29 ))) by L677;
consider R29 being (Matrix of R6 , R23) such that L687: C97 = R29 and L688: C98 = ( - R29 ) by L686;
reconsider D97 = ( - R29 ) as (Element of D88) by L688;
take D97;
thus L689: ( C97 + D97 ) = ( R29 + ( - R29 ) ) by L673 , L687
.= ( 0. D88 ) by L663;
end;
reconsider D98 = D88 as  strict AbGroup by L679;
take D98;
thus L690: thesis by L673;
end;
uniqueness
proof
thus L691: (for B71 , B72 being  strict AbGroup holds (((the carrier of B71) = ( R6 -Matrices_over R23 ) & (for R29 being (Matrix of R6 , R23) holds (for R31 being (Matrix of R6 , R23) holds ( (the addF of B71) . (R29 , R31) ) = ( R29 + R31 ))) & ( 0. B71 ) = ( 0. (R23 , R6) ) & (the carrier of B72) = ( R6 -Matrices_over R23 ) & (for R29 being (Matrix of R6 , R23) holds (for R31 being (Matrix of R6 , R23) holds ( (the addF of B72) . (R29 , R31) ) = ( R29 + R31 ))) & ( 0. B72 ) = ( 0. (R23 , R6) )) implies B71 = B72))
proof
let C99 , C100 being  strict AbGroup;
assume that
L692: (the carrier of C99) = ( R6 -Matrices_over R23 )
and
L693: (for R29 being (Matrix of R6 , R23) holds (for R31 being (Matrix of R6 , R23) holds ( (the addF of C99) . (R29 , R31) ) = ( R29 + R31 )))
and
L694: (( 0. C99 ) = ( 0. (R23 , R6) ) & (the carrier of C100) = ( R6 -Matrices_over R23 ))
and
L695: (for R29 being (Matrix of R6 , R23) holds (for R31 being (Matrix of R6 , R23) holds ( (the addF of C100) . (R29 , R31) ) = ( R29 + R31 )))
and
L696: ( 0. C100 ) = ( 0. (R23 , R6) );
L697:
now
let C101 , C102 being (Element of C99);
reconsider D99 = C101 , D100 = C102 as (Matrix of R6 , R23) by L692 , L613;
thus L698: ( (the addF of C99) . (C101 , C102) ) = ( D99 + D100 ) by L693
.= ( (the addF of C100) . (C101 , C102) ) by L695;
end;
thus L699: thesis by L697 , L692 , L694 , L696 , BINOP_1:2;
end;

end;
end;
theorem
L693: (for R6 being Nat holds (for R7 being Nat holds (for R9 being non  empty doubleLoopStr holds (for B73 being (Matrix of ( 0 ) , R6 , R9) holds (for B74 being (Matrix of ( 0 ) , R7 , R9) holds B73 = B74)))))
proof
let R6 being Nat;
let R7 being Nat;
let R9 being non  empty doubleLoopStr;
let C103 being (Matrix of ( 0 ) , R6 , R9);
let C104 being (Matrix of ( 0 ) , R7 , R9);
L694: (( len C103 ) = ( 0 ) & ( len C104 ) = ( 0 )) by L75;
thus L695: thesis by L694 , CARD_2:64;
end;
begin
theorem
L696: (for B75 being set holds (for R4 being Nat holds (for R5 being Nat holds (for B76 being (Matrix of B75) holds ((1 <= R4 & R4 <= ( len B76 ) & 1 <= R5 & R5 <= ( width B76 )) implies [ R4 , R5 ] in ( Indices B76 ))))))
proof
let C105 being set;
let R4 being Nat;
let R5 being Nat;
let C106 being (Matrix of C105);
assume L697: (1 <= R4 & R4 <= ( len C106 ) & 1 <= R5 & R5 <= ( width C106 ));
L698: (R4 in ( dom C106 ) & R5 in ( Seg ( width C106 ) )) by L697 , FINSEQ_1:1 , FINSEQ_3:25;
thus L699: thesis by L698 , ZFMISC_1:87;
end;
theorem
L700: (for R4 being Nat holds (for R5 being Nat holds (for R6 being Nat holds (for R7 being Nat holds (for R8 being non  empty set holds (for B77 being (Matrix of R6 , R7 , R8) holds ((1 <= R4 & R4 <= R6 & 1 <= R5 & R5 <= R7) implies [ R4 , R5 ] in ( Indices B77 ))))))))
proof
let R4 being Nat;
let R5 being Nat;
let R6 being Nat;
let R7 being Nat;
let R8 being non  empty set;
let C107 being (Matrix of R6 , R7 , R8);
assume that
L701: (1 <= R4 & R4 <= R6)
and
L702: (1 <= R5 & R5 <= R7);
L703: ( len C107 ) = R6 by L75;
per cases  by NAT_1:3;
suppose L704: R6 = ( 0 );

thus L705: thesis by L704 , L701 , XXREAL_0:2;
end;
suppose L706: R6 > ( 0 );

L707: R7 = ( width C107 ) by L706 , L346;
thus L708: thesis by L707 , L701 , L702 , L703 , L696;
end;
end;
theorem
L710: (for B78 being  tabular FinSequence holds (for R4 being Nat holds (for R5 being Nat holds ([ R4 , R5 ] in ( Indices B78 ) implies (1 <= R4 & R4 <= ( len B78 ) & 1 <= R5 & R5 <= ( width B78 ))))))
proof
let C108 being  tabular FinSequence;
let R4 being Nat;
let R5 being Nat;
assume L711: [ R4 , R5 ] in ( Indices C108 );
L712: (R4 in ( dom C108 ) & R5 in ( Seg ( width C108 ) )) by L711 , ZFMISC_1:87;
thus L713: thesis by L712 , FINSEQ_1:1 , FINSEQ_3:25;
end;
theorem
L714: (for R4 being Nat holds (for R5 being Nat holds (for R6 being Nat holds (for R7 being Nat holds (for R8 being non  empty set holds (for B79 being (Matrix of R6 , R7 , R8) holds ([ R4 , R5 ] in ( Indices B79 ) implies (1 <= R4 & R4 <= R6 & 1 <= R5 & R5 <= R7))))))))
proof
let R4 being Nat;
let R5 being Nat;
let R6 being Nat;
let R7 being Nat;
let R8 being non  empty set;
let C109 being (Matrix of R6 , R7 , R8);
assume that
L715: [ R4 , R5 ] in ( Indices C109 );
L716: ( len C109 ) = R6 by L75;
per cases  by NAT_1:3;
suppose L717: R6 = ( 0 );

L718: R4 in ( dom C109 ) by L715 , ZFMISC_1:87;
L719: 1 <= R4 by L718 , FINSEQ_3:25;
L720: R4 <= ( 0 ) by L716 , L717 , L718 , FINSEQ_3:25;
thus L721: thesis by L720 , L719 , XXREAL_0:2;
end;
suppose L722: R6 > ( 0 );

L723: R7 = ( width C109 ) by L722 , L346;
thus L724: thesis by L723 , L715 , L716 , L710;
end;
end;
definition
let C110 being Function;
func Values C110 -> set equals 
( Union ( rngs C110 ) );
correctness;
end;
theorem
L727: (for R4 being Nat holds (for R8 being non  empty set holds (for B80 being (FinSequence of ( R8 * )) holds ( B80 . R4 ) is (FinSequence of R8))))
proof
let R4 being Nat;
let R8 being non  empty set;
let C111 being (FinSequence of ( R8 * ));
per cases ;
suppose L728: (not R4 in ( dom C111 ));

L729: ( C111 . R4 ) = ( <*> R8 ) by L728 , FUNCT_1:def 2;
thus L730: thesis by L729;
end;
suppose L731: R4 in ( dom C111 );

L732: ( rng C111 ) c= ( R8 * ) by FINSEQ_1:def 4;
L733: ( C111 . R4 ) in ( rng C111 ) by L731 , FUNCT_1:def 3;
thus L734: thesis by L733 , L732 , FINSEQ_1:def 11;
end;
end;
theorem
L736: (for R8 being non  empty set holds (for B81 being (FinSequence of ( R8 * )) holds ( Values B81 ) = ( union { ( rng B82 ) where B82 is (Element of ( R8 * )) : B82 in ( rng B81 ) } )))
proof
let R8 being non  empty set;
let C112 being (FinSequence of ( R8 * ));
set D101 = { ( rng B83 ) where B83 is (Element of ( R8 * )) : B83 in ( rng C112 ) };
L737: ( Union ( rngs C112 ) ) = ( union ( rng ( rngs C112 ) ) ) by CARD_3:def 4;
L738:
now
let C113 being set;
thus L739:now
assume L740: C113 in ( Values C112 );
consider C114 being set such that L741: C113 in C114 and L742: C114 in ( rng ( rngs C112 ) ) by L740 , L737 , TARSKI:def 4;
consider C115 being set such that L743: C115 in ( dom ( rngs C112 ) ) and L744: ( ( rngs C112 ) . C115 ) = C114 by L742 , FUNCT_1:def 3;
L745: C115 in ( dom C112 ) by L743 , FUNCT_6:60;
reconsider D102 = C115 as (Element of ( NAT )) by L745;
reconsider D103 = ( C112 . D102 ) as (FinSequence of R8) by L727;
L746: C114 = ( rng D103 ) by L744 , L745 , FUNCT_6:22;
L747: D103 in ( R8 * ) by FINSEQ_1:def 11;
L748: D103 in ( rng C112 ) by L745 , FUNCT_1:def 3;
L749: ( rng D103 ) in D101 by L748 , L747;
thus L750: C113 in ( union D101 ) by L749 , L741 , L746 , TARSKI:def 4;
end;
assume L751: C113 in ( union D101 );
consider C116 being set such that L752: C113 in C116 and L753: C116 in D101 by L751 , TARSKI:def 4;
consider C117 being (Element of ( R8 * )) such that L754: C116 = ( rng C117 ) and L755: C117 in ( rng C112 ) by L753;
consider C118 being Nat such that L756: (C118 in ( dom C112 ) & ( C112 . C118 ) = C117) by L755 , FINSEQ_2:10;
L757: (C118 in ( dom ( rngs C112 ) ) & ( ( rngs C112 ) . C118 ) = ( rng C117 )) by L756 , FUNCT_6:22;
L758: ( rng C117 ) in ( rng ( rngs C112 ) ) by L757 , FUNCT_1:def 3;
thus L759: C113 in ( Values C112 ) by L758 , L737 , L752 , L754 , TARSKI:def 4;
end;
thus L760: thesis by L738 , TARSKI:1;
end;
registration
let C119 being non  empty set;
let C120 being (FinSequence of ( C119 * ));
cluster ( Values C120 ) ->  finite;
coherence
proof
deffunc H8(Function) = ( rng $1 );
set D104 = { H8(B84) where B84 is (Element of ( C119 * )) : B84 in ( rng C120 ) };
L761:
now
let C121 being set;
assume L762: C121 in D104;
L763: (ex B85 being (Element of ( C119 * )) st (C121 = ( rng B85 ) & B85 in ( rng C120 ))) by L762;
thus L764: C121 is  finite by L763;
end;
L765: ( rng C120 ) is  finite;
L766: { H8(B86) where B86 is (Element of ( C119 * )) : B86 in ( rng C120 ) } is  finite from FRAENKEL:sch 21(L765);
L767: ( union D104 ) is  finite by L766 , L761 , FINSET_1:7;
thus L768: thesis by L767 , L736;
end;
end;
theorem
L770: (for R4 being Nat holds (for R34 being non  empty set holds (for R35 being (FinSequence of R34) holds (for B87 being (Matrix of R34) holds ((R4 in ( dom B87 ) & ( B87 . R4 ) = R35) implies ( len R35 ) = ( width B87 ))))))
proof
let R4 being Nat;
let R34 being non  empty set;
let R35 being (FinSequence of R34);
let C122 being (Matrix of R34);
assume that
L771: R4 in ( dom C122 )
and
L772: ( C122 . R4 ) = R35;
L773: C122 is non  empty by L771;
L774: ( len C122 ) > ( 0 ) by L773 , NAT_1:3;
consider C123 being FinSequence such that L775: C123 in ( rng C122 ) and L776: ( len C123 ) = ( width C122 ) by L774 , L137;
consider C124 being Nat such that L777: (for B88 being set holds (B88 in ( rng C122 ) implies (ex B89 being FinSequence st (B89 = B88 & ( len B89 ) = C124)))) by L1;
L778: ( C122 . R4 ) in ( rng C122 ) by L771 , FUNCT_1:def 3;
L779: (ex B90 being FinSequence st (B90 = ( C122 . R4 ) & ( len B90 ) = C124)) by L778 , L777;
L780: (ex B91 being FinSequence st (B91 = C123 & ( len B91 ) = C124)) by L775 , L777;
thus L781: thesis by L780 , L772 , L776 , L779;
end;
theorem
L782: (for R4 being Nat holds (for R5 being Nat holds (for R34 being non  empty set holds (for R35 being (FinSequence of R34) holds (for B92 being (Matrix of R34) holds ((R4 in ( dom B92 ) & ( B92 . R4 ) = R35 & R5 in ( dom R35 )) implies [ R4 , R5 ] in ( Indices B92 )))))))
proof
let R4 being Nat;
let R5 being Nat;
let R34 being non  empty set;
let R35 being (FinSequence of R34);
let C125 being (Matrix of R34);
assume that
L783: R4 in ( dom C125 )
and
L784: (( C125 . R4 ) = R35 & R5 in ( dom R35 ));
L785: C125 is non  empty by L783;
L786: ( len C125 ) > ( 0 ) by L785 , NAT_1:3;
consider C126 being FinSequence such that L787: C126 in ( rng C125 ) and L788: ( len C126 ) = ( width C125 ) by L786 , L137;
consider C127 being Nat such that L789: (for B93 being set holds (B93 in ( rng C125 ) implies (ex B94 being FinSequence st (B94 = B93 & ( len B94 ) = C127)))) by L1;
L790: ( C125 . R4 ) in ( rng C125 ) by L783 , FUNCT_1:def 3;
L791: (ex B95 being FinSequence st (B95 = ( C125 . R4 ) & ( len B95 ) = C127)) by L790 , L789;
L792: (ex B96 being FinSequence st (B96 = C126 & ( len B96 ) = C127)) by L787 , L789;
L793: (( Indices C125 ) = [: ( dom C125 ) , ( Seg ( width C125 ) ) :] & R5 in ( Seg ( width C125 ) )) by L792 , L784 , L788 , L791 , FINSEQ_1:def 3;
thus L794: thesis by L793 , L783 , ZFMISC_1:87;
end;
theorem
L795: (for R4 being Nat holds (for R5 being Nat holds (for R34 being non  empty set holds (for R35 being (FinSequence of R34) holds (for B97 being (Matrix of R34) holds (([ R4 , R5 ] in ( Indices B97 ) & ( B97 . R4 ) = R35) implies (( len R35 ) = ( width B97 ) & R5 in ( dom R35 ))))))))
proof
let R4 being Nat;
let R5 being Nat;
let R34 being non  empty set;
let R35 being (FinSequence of R34);
let C128 being (Matrix of R34);
assume that
L796: [ R4 , R5 ] in ( Indices C128 );
L797: R5 in ( Seg ( width C128 ) ) by L796 , ZFMISC_1:87;
L798: C128 is non  empty by L796 , ZFMISC_1:87;
L799: ( len C128 ) > ( 0 ) by L798 , NAT_1:3;
consider C129 being FinSequence such that L800: C129 in ( rng C128 ) and L801: ( len C129 ) = ( width C128 ) by L799 , L137;
consider C130 being Nat such that L802: (for B98 being set holds (B98 in ( rng C128 ) implies (ex B99 being FinSequence st (B99 = B98 & ( len B99 ) = C130)))) by L1;
L803: R4 in ( dom C128 ) by L796 , ZFMISC_1:87;
L804: ( C128 . R4 ) in ( rng C128 ) by L803 , FUNCT_1:def 3;
L805: (ex B100 being FinSequence st (B100 = ( C128 . R4 ) & ( len B100 ) = C130)) by L804 , L802;
L806: (ex B101 being FinSequence st (B101 = C129 & ( len B101 ) = C130)) by L800 , L802;
thus L807: thesis by L806 , L797 , L801 , L805 , FINSEQ_1:def 3;
end;
theorem
L808: (for R34 being non  empty set holds (for B102 being (Matrix of R34) holds ( Values B102 ) = { ( B102 * (B103 , B104) ) where B103 is (Element of ( NAT )) , B104 is (Element of ( NAT )) : [ B103 , B104 ] in ( Indices B102 ) }))
proof
let R34 being non  empty set;
let C131 being (Matrix of R34);
set D105 = { ( C131 * (B105 , B106) ) where B105 is (Element of ( NAT )) , B106 is (Element of ( NAT )) : [ B105 , B106 ] in ( Indices C131 ) };
set D106 = { ( rng B107 ) where B107 is (Element of ( R34 * )) : B107 in ( rng C131 ) };
L809: ( Values C131 ) = ( union D106 ) by L736;
L810:
now
let C132 being set;
thus L811:now
assume L812: C132 in ( Values C131 );
consider C133 being set such that L813: C132 in C133 and L814: C133 in D106 by L812 , L809 , TARSKI:def 4;
consider C134 being (Element of ( R34 * )) such that L815: C133 = ( rng C134 ) and L816: C134 in ( rng C131 ) by L814;
consider C135 being Nat such that L817: C135 in ( dom C134 ) and L818: ( C134 . C135 ) = C132 by L813 , L815 , FINSEQ_2:10;
consider C136 being Nat such that L819: C136 in ( dom C131 ) and L820: ( C131 . C136 ) = C134 by L816 , FINSEQ_2:10;
reconsider D107 = C136 , D108 = C135 as (Element of ( NAT )) by ORDINAL1:def 12;
L821: [ D107 , D108 ] in ( Indices C131 ) by L819 , L820 , L817 , L782;
L822: (ex B108 being (FinSequence of R34) st (B108 = ( C131 . D107 ) & ( C131 * (D107 , D108) ) = ( B108 . D108 ))) by L821 , L172;
thus L823: C132 in D105 by L822 , L820 , L818 , L821;
end;
assume L824: C132 in D105;
consider C137 , C138 being (Element of ( NAT )) such that L825: C132 = ( C131 * (C137 , C138) ) and L826: [ C137 , C138 ] in ( Indices C131 ) by L824;
consider C139 being (FinSequence of R34) such that L827: C139 = ( C131 . C137 ) and L828: ( C131 * (C137 , C138) ) = ( C139 . C138 ) by L826 , L172;
L829: C138 in ( dom C139 ) by L826 , L827 , L795;
L830: ( C139 . C138 ) in ( rng C139 ) by L829 , FUNCT_1:def 3;
L831: C137 in ( dom C131 ) by L826 , ZFMISC_1:87;
L832: ( C131 . C137 ) in ( rng C131 ) by L831 , FUNCT_1:def 3;
L833: C139 in ( R34 * ) by FINSEQ_1:def 11;
L834: ( rng C139 ) in D106 by L833 , L827 , L832;
thus L835: C132 in ( Values C131 ) by L834 , L809 , L825 , L828 , L830 , TARSKI:def 4;
end;
thus L836: thesis by L810 , TARSKI:1;
end;
theorem
L837: (for B109 being non  empty set holds (for B110 being (Matrix of B109) holds ( card ( Values B110 ) ) <= ( ( len B110 ) * ( width B110 ) )))
proof
let C140 being non  empty set;
let C141 being (Matrix of C140);
L838:
now
let C142 being set;
assume L839: C142 in ( dom ( rngs C141 ) );
L840: C142 in ( dom C141 ) by L839 , FUNCT_6:60;
reconsider D109 = C142 as (Element of ( NAT )) by L840;
reconsider D110 = ( C141 . D109 ) as (FinSequence of C140) by L727;
L841: ( card ( rng D110 ) ) c= ( card ( dom D110 ) ) by CARD_2:61;
L842: ( card ( rng D110 ) ) c= ( card ( Seg ( len D110 ) ) ) by L841 , FINSEQ_1:def 3;
L843: ( card ( rng D110 ) ) c= ( card ( len D110 ) ) by L842 , FINSEQ_1:55;
L844: ( card ( rng D110 ) ) c= ( card ( width C141 ) ) by L843 , L840 , L770;
thus L845: ( card ( ( rngs C141 ) . C142 ) ) c= ( card ( width C141 ) ) by L844 , L840 , FUNCT_6:22;
end;
L846: ( card ( dom ( rngs C141 ) ) ) = ( card ( dom C141 ) ) by FUNCT_6:60
.= ( card ( len C141 ) ) by CARD_1:62;
L847: ( card ( Union ( rngs C141 ) ) ) c= ( ( card ( len C141 ) ) *` ( card ( width C141 ) ) ) by L846 , L838 , CARD_2:86;
L848: ( card ( Values C141 ) ) c= ( card ( ( len C141 ) * ( width C141 ) ) ) by L847 , CARD_2:39;
L849: ( card ( Values C141 ) ) <= ( card ( ( len C141 ) * ( width C141 ) ) ) by L848 , NAT_1:39;
thus L850: thesis by L849 , CARD_1:def 2;
end;
theorem
L851: (for R34 being non  empty set holds (for R36 being (Element of ( NAT )) holds (for R37 being (Element of ( NAT )) holds (for B111 being (Matrix of R34) holds ((1 <= R36 & R36 <= ( len B111 ) & 1 <= R37 & R37 <= ( width B111 )) implies ( B111 * (R36 , R37) ) in ( Values B111 ))))))
proof
let R34 being non  empty set;
let R36 being (Element of ( NAT ));
let R37 being (Element of ( NAT ));
let C143 being (Matrix of R34);
assume L852: (1 <= R36 & R36 <= ( len C143 ) & 1 <= R37 & R37 <= ( width C143 ));
L853: [ R36 , R37 ] in ( Indices C143 ) by L852 , L696;
L854: ( Values C143 ) = { ( C143 * (R38 , R39) ) where R38 is (Element of ( NAT )) , R39 is (Element of ( NAT )) : [ R38 , R39 ] in ( Indices C143 ) } by L808;
thus L855: thesis by L854 , L853;
end;
