:: On polynomials with coefficients in a ring of polynomials
::  by Barbara Dzienis
::
:: Received August 10, 2001
:: Copyright (c) 2001-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, ORDINAL1, XBOOLE_0, ALGSTR_0, WELLORD1, QUOFIELD,
      RELAT_1, FUNCT_1, SUBSET_1, STRUCT_0, ORDINAL2, TARSKI, ORDINAL3,
      PRE_POLY, ARYTM_3, CARD_1, PBOOLE, FINSET_1, VALUED_0, FUNCOP_1,
      RLVECT_1, LATTICES, BINOP_1, POLYNOM1, FINSEQ_1, CARD_3, PARTFUN1,
      FINSEQ_2, NAT_1, VECTSP_1, ZFMISC_1, GROUP_1, SUPINF_2, XXREAL_0,
      FINSEQ_3, ORDINAL4, ARYTM_1, ORDERS_1, MSSUBFAM, POLYNOM6;
 notations TARSKI, XBOOLE_0, SUBSET_1, CARD_1, NUMBERS, XCMPLX_0, VALUED_0,
      VECTSP_1, RELAT_1, FUNCT_1, PARTFUN1, FUNCT_2, FUNCOP_1, POLYNOM1,
      STRUCT_0, ALGSTR_0, ORDINAL1, NAT_1, NAT_D, ORDERS_1, PBOOLE, RLVECT_1,
      FINSET_1, FINSEQ_1, FINSEQ_2, ORDINAL2, ORDINAL3, GROUP_1, QUOFIELD,
      GRCAT_1, WSIERP_1, PRE_POLY, FVSUM_1, POLYNOM3, GROUP_6, XXREAL_0,
      MATRLIN;
 constructors ORDINAL3, BINARITH, WSIERP_1, GRCAT_1, GROUP_6, TRIANG_1,
      QUOFIELD, POLYNOM1, POLYNOM3, NAT_D, RELSET_1, MATRLIN, FVSUM_1;
 registrations FUNCT_1, ORDINAL1, RELSET_1, FUNCOP_1, FINSET_1, XREAL_0,
      FINSEQ_1, FINSEQ_2, STRUCT_0, VECTSP_1, QUOFIELD, PRE_POLY, POLYNOM1,
      POLYNOM2, VALUED_0, CARD_1;
 requirements BOOLE, SUBSET, NUMERALS, REAL;
 definitions VECTSP_1, QUOFIELD, GRCAT_1, FUNCT_1, TARSKI, XBOOLE_0, STRUCT_0,
      VALUED_0;
 theorems POLYNOM1, TOPGRP_1, FUNCT_2, PBOOLE, FUNCT_1, ORDINAL3, ORDINAL1,
      ORDINAL2, FINSEQ_3, FINSEQ_2, FVSUM_1, FINSEQ_1, RELAT_1, FUNCOP_1,
      POLYALG1, FINSEQ_5, VECTSP_1, FINSEQ_4, FINSET_1, TARSKI, POLYNOM2,
      MATRLIN, RLVECT_1, NAT_1, SUBSET_1, CARD_3, POLYNOM3, ORDERS_1, RVSUM_1,
      XBOOLE_0, XBOOLE_1, XREAL_1, GROUP_6, XXREAL_0, GROUP_1, PARTFUN1, NAT_D,
      PRE_POLY;
 schemes PBOOLE, FUNCT_2, FRAENKEL, FUNCT_1, RECDEF_1;

begin
notation
let C1 , C2 being non  empty doubleLoopStr;
synonym C1 , C2 are_isomorphic  for C1 is_ringisomorph_to C2;
end;
definition
let C3 , C4 being non  empty doubleLoopStr;
redefine pred C3 is_ringisomorph_to C4
;
reflexivity
proof
let C5 being non  empty doubleLoopStr;
take ( id C5 );
thus L2: ( id C5 ) is  RingHomomorphism;
thus L3: ( id C5 ) is  one-to-one;
thus L4: ( id C5 ) is  RingHomomorphism;
thus L5: ( rng ( id C5 ) ) = ( [#] C5 ) by TOPGRP_1:1
.= (the carrier of C5);
end;
end;
theorem
L7: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B1 being set holds ((for B2 being set holds (B2 in B1 iff (ex B3 being Ordinal st (B2 = ( R1 +^ B3 ) & B3 in R2)))) implies ( R1 +^ R2 ) = ( R1 \/ B1 )))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C6 being set;
assume L8: (for B4 being set holds (B4 in C6 iff (ex B5 being Ordinal st (B4 = ( R1 +^ B5 ) & B5 in R2))));
L9: (for B6 being set holds (B6 in ( R1 +^ R2 ) iff B6 in ( R1 \/ C6 )))
proof
let C7 being set;
L10: (C7 in ( R1 \/ C6 ) implies C7 in ( R1 +^ R2 ))
proof
assume L11: C7 in ( R1 \/ C6 );
per cases  by L11 , XBOOLE_0:def 3;
suppose L12: C7 in R1;

L13: R1 c= ( R1 +^ R2 ) by ORDINAL3:24;
thus L14: thesis by L13 , L12;
end;
suppose L15: C7 in C6;

L16: (ex B7 being Ordinal st (C7 = ( R1 +^ B7 ) & B7 in R2)) by L15 , L8;
thus L17: thesis by L16 , ORDINAL2:32;
end;
end;
per cases ;
suppose L19: C7 in R1;

thus L20: (C7 in ( R1 +^ R2 ) implies C7 in ( R1 \/ C6 )) by L19 , XBOOLE_0:def 3;
thus L21: thesis by L10;
end;
suppose L22: (not C7 in R1);

thus L23: (C7 in ( R1 +^ R2 ) implies C7 in ( R1 \/ C6 ))
proof
assume L24: C7 in ( R1 +^ R2 );
per cases ;
suppose L25: R2 = ( {} );

thus L26: thesis by L25 , L22 , L24 , ORDINAL2:27;
end;
suppose L27: R2 <> ( {} );

reconsider D1 = C7 as Ordinal by L24;
L28: R1 c= D1 by L22 , ORDINAL1:16;
L29: D1 = ( R1 +^ ( D1 -^ R1 ) ) by L28 , ORDINAL3:def 5;
L30: ( D1 -^ R1 ) in R2 by L24 , L27 , ORDINAL3:60;
L31: C7 in C6 by L30 , L8 , L29;
thus L32: thesis by L31 , XBOOLE_0:def 3;
end;
end;

thus L34: thesis by L10;
end;
end;
thus L36: thesis by L9 , TARSKI:1;
end;
registration
let C8 being Ordinal;
let C9 being non  empty Ordinal;
cluster ( C8 +^ C9 ) -> non  empty;
coherence by ORDINAL3:26;
cluster ( C9 +^ C8 ) -> non  empty;
coherence by ORDINAL3:26;
end;
theorem
L38: (for B8 being Ordinal holds (for B9 , B10 being (bag of B8) holds (B9 < B10 implies (ex B11 being Ordinal st (B11 in B8 & ( B9 . B11 ) < ( B10 . B11 ) & (for B12 being Ordinal holds (B12 in B11 implies ( B9 . B12 ) = ( B10 . B12 ))))))))
proof
let C10 being Ordinal;
let C11 , C12 being (bag of C10);
assume L39: C11 < C12;
consider C13 being Ordinal such that L40: ( C11 . C13 ) < ( C12 . C13 ) and L41: (for B13 being Ordinal holds (B13 in C13 implies ( C11 . B13 ) = ( C12 . B13 ))) by L39 , PRE_POLY:def 9;
take C13;
L42:
now
assume L43: (not C13 in C10);
L44: (not C13 in ( dom C12 )) by L43 , PARTFUN1:def 2;
L45: C10 = ( dom C11 ) by PARTFUN1:def 2;
L46: ( C11 . C13 ) = ( 0 ) by L45 , L43 , FUNCT_1:def 2;
thus L47: contradiction by L46 , L40 , L44 , FUNCT_1:def 2;
end;
thus L48: C13 in C10 by L42;
thus L49: ( C11 . C13 ) < ( C12 . C13 ) by L40;
thus L50: thesis by L41;
end;
begin
definition
let C14 , C15 being Ordinal;
let C16 being (Element of ( Bags C14 ));
let C17 being (Element of ( Bags C15 ));
func C16 +^ C17 -> (Element of ( Bags ( C14 +^ C15 ) )) means 
:L51: (for B14 being Ordinal holds ((B14 in C14 implies ( it . B14 ) = ( C16 . B14 )) & (B14 in ( ( C14 +^ C15 ) \ C14 ) implies ( it . B14 ) = ( C17 . ( B14 -^ C14 ) ))));
existence
proof
per cases ;
suppose L52: C15 = ( {} );

reconsider D2 = C16 as (Element of ( Bags ( C14 +^ C15 ) )) by L52 , ORDINAL2:27;
take D2;
let C18 being Ordinal;
thus L53: (C18 in C14 implies ( D2 . C18 ) = ( C16 . C18 ));
L54: ( C14 +^ C15 ) = C14 by L52 , ORDINAL2:27;
thus L55: thesis by L54 , XBOOLE_1:37;
end;
suppose L56: C15 <> ( {} );

reconsider D3 = C15 as non  empty Ordinal by L56;
defpred S1[ set , set ] means (ex B15 being Ordinal st (B15 = $1 & (B15 in C14 implies $2 = ( C16 . B15 )) & (B15 in ( ( C14 +^ C15 ) \ C14 ) implies $2 = ( C17 . ( B15 -^ C14 ) ))));
deffunc H1((Element of D3)) = ( C14 +^ $1 );
set D4 = { H1(B16) where B16 is (Element of D3) : B16 in ( support C17 ) };
set D5 = { ( C14 +^ B17 ) where B17 is (Element of D3) : (not contradiction) };
L57: (for B18 being set holds (B18 in ( C14 +^ C15 ) implies (ex B19 being set st S1[ B18 , B19 ])))
proof
let C19 being set;
assume that
L58: C19 in ( C14 +^ C15 );
reconsider D6 = C19 as Ordinal by L58;
L59: (D6 in C14 iff (not D6 in ( ( C14 +^ C15 ) \ C14 ))) by L58 , XBOOLE_0:def 5;
per cases  by L58 , XBOOLE_0:def 5;
suppose L60: D6 in C14;

take ( C16 . D6 );
take D6;
thus L61: thesis by L60 , XBOOLE_0:def 5;
end;
suppose L62: D6 in ( ( C14 +^ C15 ) \ C14 );

take ( C17 . ( D6 -^ C14 ) );
thus L63: thesis by L59 , L62;
end;
end;
consider C20 being (ManySortedSet of ( C14 +^ C15 )) such that L65: (for B20 being set holds (B20 in ( C14 +^ C15 ) implies S1[ B20 , ( C20 . B20 ) ])) from PBOOLE:sch 3(L57);
L66: ( support C20 ) c= ( ( support C16 ) \/ D4 )
proof
let C21 being set;
assume L67: C21 in ( support C20 );
L68: ( C20 . C21 ) <> ( 0 ) by L67 , PRE_POLY:def 7;
L69: C21 in ( dom C20 ) by L68 , FUNCT_1:def 2;
L70: C21 in ( C14 +^ C15 ) by L69 , PARTFUN1:def 2;
L71: (for B21 being set holds (B21 in D5 iff (ex B22 being Ordinal st (B21 = ( C14 +^ B22 ) & B22 in C15))))
proof
let C22 being set;
thus L72: (C22 in D5 implies (ex B23 being Ordinal st (C22 = ( C14 +^ B23 ) & B23 in C15)))
proof
assume L73: C22 in D5;
L74: (ex B24 being (Element of D3) st C22 = ( C14 +^ B24 )) by L73;
thus L75: thesis by L74;
end;

thus L76: thesis;
end;
L77: C21 in ( C14 \/ D5 ) by L71 , L70 , L7;
per cases  by L77 , XBOOLE_0:def 3;
suppose L78: C21 in C14;

L79: S1[ C21 , ( C20 . C21 ) ] by L65 , L70;
L80: C21 in ( support C16 ) by L79 , L68 , L78 , PRE_POLY:def 7;
thus L81: thesis by L80 , XBOOLE_0:def 3;
end;
suppose L82: C21 in D5;

L83: (ex B25 being (Element of D3) st C21 = ( C14 +^ B25 )) by L82;
consider C23 being Ordinal such that L84: C21 = ( C14 +^ C23 ) and L85: C23 in C15 by L83;
reconsider D7 = C21 as Ordinal by L84;
L86: C14 c= D7 by L84 , ORDINAL3:24;
L87:
now
per cases ;
suppose L88: D7 = C14;

thus L89: (not D7 in C14) by L88;
end;
suppose L90: D7 <> C14;

L91: C14 c< D7 by L90 , L86 , XBOOLE_0:def 8;
thus L92: (not D7 in C14) by L91 , ORDINAL1:11;
end;
end;
L94: S1[ C21 , ( C20 . C21 ) ] by L65 , L70;
L95: (C21 in ( C14 +^ C15 ) & C23 = ( D7 -^ C14 )) by L84 , L85 , ORDINAL2:32 , ORDINAL3:52;
L96: C23 in ( support C17 ) by L95 , L68 , L87 , L94 , PRE_POLY:def 7 , XBOOLE_0:def 5;
L97: C21 in D4 by L96 , L84 , L85;
thus L98: thesis by L97 , XBOOLE_0:def 3;
end;
end;
L100: ( support C17 ) is  finite;
L101: D4 is  finite from FRAENKEL:sch 21(L100);
L102: C20 is  finite-support by L101 , L66 , PRE_POLY:def 8;
L103: C20 is  natural-valued
proof
let C24 being set;
assume L104: C24 in ( dom C20 );
L105: C24 in ( C14 +^ C15 ) by L104 , PARTFUN1:def 2;
reconsider D8 = C24 as Ordinal by L105;
L106: (ex B26 being Ordinal st (B26 = C24 & (B26 in C14 implies ( C20 . C24 ) = ( C16 . B26 )) & (B26 in ( ( C14 +^ C15 ) \ C14 ) implies ( C20 . C24 ) = ( C17 . ( B26 -^ C14 ) )))) by L65 , L105;
per cases  by L105 , XBOOLE_0:def 5;
suppose L107: D8 in C14;

thus L108: thesis by L107 , L106;
end;
suppose L109: D8 in ( ( C14 +^ C15 ) \ C14 );

thus L110: thesis by L109 , L106;
end;
end;
reconsider D9 = C20 as (Element of ( Bags ( C14 +^ C15 ) )) by L103 , L102 , PRE_POLY:def 12;
take D9;
let C25 being Ordinal;
thus L112: (C25 in C14 implies ( D9 . C25 ) = ( C16 . C25 ))
proof
assume L113: C25 in C14;
L114: C14 c= ( C14 +^ C15 ) by ORDINAL3:24;
L115: (ex B27 being Ordinal st (B27 = C25 & (B27 in C14 implies ( D9 . C25 ) = ( C16 . B27 )) & (B27 in ( ( C14 +^ C15 ) \ C14 ) implies ( D9 . C25 ) = ( C17 . ( B27 -^ C14 ) )))) by L114 , L65 , L113;
thus L116: thesis by L115 , L113;
end;

assume L117: C25 in ( ( C14 +^ C15 ) \ C14 );
L118: (ex B28 being Ordinal st (B28 = C25 & (B28 in C14 implies ( D9 . C25 ) = ( C16 . B28 )) & (B28 in ( ( C14 +^ C15 ) \ C14 ) implies ( D9 . C25 ) = ( C17 . ( B28 -^ C14 ) )))) by L117 , L65;
thus L119: thesis by L118 , L117;
end;
end;
uniqueness
proof
let C26 , C27 being (Element of ( Bags ( C14 +^ C15 ) ));
assume that
L121: (for B29 being Ordinal holds ((B29 in C14 implies ( C26 . B29 ) = ( C16 . B29 )) & (B29 in ( ( C14 +^ C15 ) \ C14 ) implies ( C26 . B29 ) = ( C17 . ( B29 -^ C14 ) ))))
and
L122: (for B30 being Ordinal holds ((B30 in C14 implies ( C27 . B30 ) = ( C16 . B30 )) & (B30 in ( ( C14 +^ C15 ) \ C14 ) implies ( C27 . B30 ) = ( C17 . ( B30 -^ C14 ) ))));
L123: ( dom C26 ) = ( C14 +^ C15 ) by PARTFUN1:def 2;
L124: (for B31 being set holds (B31 in ( dom C26 ) implies ( C26 . B31 ) = ( C27 . B31 )))
proof
let C28 being set;
assume that
L125: C28 in ( dom C26 );
reconsider D10 = C28 as Ordinal by L123 , L125;
L126: C14 c= ( C14 +^ C15 ) by ORDINAL3:24;
L127: ( ( ( C14 +^ C15 ) \ C14 ) \/ C14 ) = ( ( C14 +^ C15 ) \/ C14 ) by XBOOLE_1:39
.= ( C14 +^ C15 ) by L126 , XBOOLE_1:12;
per cases  by L123 , L125 , L127 , XBOOLE_0:def 3;
suppose L128: D10 in C14;

thus L129: ( C26 . C28 ) = ( C16 . D10 ) by L128 , L121
.= ( C27 . C28 ) by L122 , L128;
end;
suppose L130: D10 in ( ( C14 +^ C15 ) \ C14 );

thus L131: ( C26 . C28 ) = ( C17 . ( D10 -^ C14 ) ) by L130 , L121
.= ( C27 . C28 ) by L122 , L130;
end;
end;
L133: ( dom C26 ) = ( dom C27 ) by L123 , PARTFUN1:def 2;
thus L134: C26 = C27 by L133 , L124 , FUNCT_1:2;
end;
end;
theorem
L136: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B32 being (Element of ( Bags R1 )) holds (for B33 being (Element of ( Bags R2 )) holds (R2 = ( {} ) implies ( B32 +^ B33 ) = B32)))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C29 being (Element of ( Bags R1 ));
let C30 being (Element of ( Bags R2 ));
assume L137: R2 = ( {} );
reconsider D11 = ( C29 +^ C30 ) as (Element of ( Bags R1 )) by L137 , ORDINAL2:27;
L138: (for B34 being set holds (B34 in R1 implies ( D11 . B34 ) = ( C29 . B34 ))) by L51;
thus L139: thesis by L138 , PBOOLE:3;
end;
theorem
L140: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B35 being (Element of ( Bags R1 )) holds (for B36 being (Element of ( Bags R2 )) holds (R1 = ( {} ) implies ( B35 +^ B36 ) = B36)))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C31 being (Element of ( Bags R1 ));
let C32 being (Element of ( Bags R2 ));
assume L141: R1 = ( {} );
reconsider D12 = ( C31 +^ C32 ) as (Element of ( Bags R2 )) by L141 , ORDINAL2:30;
L142:
now
let C33 being set;
assume L143: C33 in R2;
reconsider D13 = C33 as Ordinal by L143;
L144: ( D13 -^ R1 ) = D13 by L141 , ORDINAL3:56;
L145: C33 in ( ( R1 +^ R2 ) \ R1 ) by L141 , L143 , ORDINAL2:30;
thus L146: ( D12 . C33 ) = ( C32 . C33 ) by L145 , L144 , L51;
end;
thus L147: thesis by L142 , PBOOLE:3;
end;
theorem
L148: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B37 being (Element of ( Bags R1 )) holds (for B38 being (Element of ( Bags R2 )) holds (( B37 +^ B38 ) = ( EmptyBag ( R1 +^ R2 ) ) iff (B37 = ( EmptyBag R1 ) & B38 = ( EmptyBag R2 )))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C34 being (Element of ( Bags R1 ));
let C35 being (Element of ( Bags R2 ));
thus L149:now
assume L150: ( C34 +^ C35 ) = ( EmptyBag ( R1 +^ R2 ) );
L151: (for B39 being set holds (B39 in ( dom C34 ) implies ( C34 . B39 ) = ( 0 )))
proof
let C36 being set;
L152: ( dom C34 ) = R1 by PARTFUN1:def 2;
assume L153: C36 in ( dom C34 );
reconsider D14 = C36 as Ordinal by L153 , L152;
L154: ( C34 . D14 ) = ( ( C34 +^ C35 ) . D14 ) by L153 , L152 , L51
.= ( 0 ) by L150 , PRE_POLY:52;
thus L155: thesis by L154;
end;
L156: ( dom C34 ) = R1 by PARTFUN1:def 2;
L157: C34 = ( R1 --> ( 0 ) ) by L156 , L151 , FUNCOP_1:11;
thus L158: C34 = ( EmptyBag R1 ) by L157 , PRE_POLY:def 13;
L159: (for B40 being set holds (B40 in ( dom C35 ) implies ( C35 . B40 ) = ( 0 )))
proof
let C37 being set;
L160: ( dom C35 ) = R2 by PARTFUN1:def 2;
assume L161: C37 in ( dom C35 );
reconsider D15 = C37 as Ordinal by L161 , L160;
L162: R1 c= ( R1 +^ D15 ) by ORDINAL3:24;
L163: (not ( R1 +^ D15 ) in R1) by L162 , ORDINAL1:5;
L164: ( R1 +^ D15 ) in ( R1 +^ R2 ) by L161 , L160 , ORDINAL2:32;
L165: ( R1 +^ D15 ) in ( ( R1 +^ R2 ) \ R1 ) by L164 , L163 , XBOOLE_0:def 5;
L166: ( ( C34 +^ C35 ) . ( R1 +^ D15 ) ) = ( C35 . ( ( R1 +^ D15 ) -^ R1 ) ) by L165 , L51;
L167: ( C35 . ( ( R1 +^ D15 ) -^ R1 ) ) = ( 0 ) by L166 , L150 , PRE_POLY:52;
thus L168: thesis by L167 , ORDINAL3:52;
end;
L169: ( dom C35 ) = R2 by PARTFUN1:def 2;
L170: C35 = ( R2 --> ( 0 ) ) by L169 , L159 , FUNCOP_1:11;
thus L171: C35 = ( EmptyBag R2 ) by L170 , PRE_POLY:def 13;
end;
thus L172: ((C34 = ( EmptyBag R1 ) & C35 = ( EmptyBag R2 )) implies ( C34 +^ C35 ) = ( EmptyBag ( R1 +^ R2 ) ))
proof
assume that
L173: C34 = ( EmptyBag R1 )
and
L174: C35 = ( EmptyBag R2 );
L175: (for B41 being set holds (B41 in ( dom ( C34 +^ C35 ) ) implies ( ( C34 +^ C35 ) . B41 ) = ( 0 )))
proof
let C38 being set;
L176: ( dom ( C34 +^ C35 ) ) = ( R1 +^ R2 ) by PARTFUN1:def 2;
assume L177: C38 in ( dom ( C34 +^ C35 ) );
reconsider D16 = C38 as Ordinal by L177 , L176;
L178: (D16 in ( ( R1 +^ R2 ) \ R1 ) implies (( C35 . ( D16 -^ R1 ) ) = ( 0 ) & ( ( C34 +^ C35 ) . D16 ) = ( C35 . ( D16 -^ R1 ) ))) by L174 , L51 , PRE_POLY:52;
L179: (D16 in R1 implies (( C34 . D16 ) = ( 0 ) & ( ( C34 +^ C35 ) . D16 ) = ( C34 . D16 ))) by L173 , L51 , PRE_POLY:52;
thus L180: thesis by L179 , L177 , L176 , L178 , XBOOLE_0:def 5;
end;
L181: ( dom ( C34 +^ C35 ) ) = ( R1 +^ R2 ) by PARTFUN1:def 2;
L182: ( C34 +^ C35 ) = ( ( R1 +^ R2 ) --> ( 0 ) ) by L181 , L175 , FUNCOP_1:11;
thus L183: thesis by L182 , PRE_POLY:def 13;
end;

end;
theorem
L173: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B42 being (Element of ( Bags ( R1 +^ R2 ) )) holds (ex B43 being (Element of ( Bags R1 )) st (ex B44 being (Element of ( Bags R2 )) st B42 = ( B43 +^ B44 ))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C39 being (Element of ( Bags ( R1 +^ R2 ) ));
per cases ;
suppose L174: R2 is  empty;

reconsider D17 = ( {} ) as (Element of ( Bags R2 )) by L174 , PRE_POLY:51 , TARSKI:def 1;
reconsider D18 = C39 as (Element of ( Bags R1 )) by L174 , ORDINAL2:27;
take D18;
take D17;
thus L175: thesis by L174 , L136;
end;
suppose L176: R2 is non  empty;

reconsider D19 = R2 as non  empty Ordinal by L176;
L177: ( support ( C39 | R1 ) ) c= ( support C39 )
proof
let C40 being set;
assume L178: C40 in ( support ( C39 | R1 ) );
L179: ( ( C39 | R1 ) . C40 ) <> ( 0 ) by L178 , PRE_POLY:def 7;
L180: C40 in ( dom ( C39 | R1 ) ) by L179 , FUNCT_1:def 2;
L181: [ C40 , ( ( C39 | R1 ) . C40 ) ] in ( C39 | R1 ) by L180 , FUNCT_1:1;
L182: [ C40 , ( ( C39 | R1 ) . C40 ) ] in C39 by L181 , RELAT_1:def 11;
L183: ( ( C39 | R1 ) . C40 ) = ( C39 . C40 ) by L182 , FUNCT_1:1;
thus L184: thesis by L183 , L179 , PRE_POLY:def 7;
end;
L185: ( dom C39 ) = ( R1 +^ R2 ) by PARTFUN1:def 2;
L186: R1 c= ( dom C39 ) by L185 , ORDINAL3:24;
L187: ( dom ( C39 | R1 ) ) = R1 by L186 , RELAT_1:62;
L188: ( C39 | R1 ) is (bag of R1) by L187 , L177 , PARTFUN1:def 2 , PRE_POLY:def 8 , RELAT_1:def 18;
reconsider D20 = ( C39 | R1 ) as (Element of ( Bags R1 )) by L188 , PRE_POLY:def 12;
deffunc H2((Element of ( R1 +^ D19 ))) = ( $1 -^ R1 );
defpred S2[ set , set ] means (for B45 being (Element of R2) holds (B45 = $1 implies $2 = ( C39 . ( R1 +^ B45 ) )));
take D20;
set D21 = { ( B46 -^ R1 ) where B46 is (Element of ( R1 +^ D19 )) : (R1 c= B46 & B46 in ( support C39 )) };
set D22 = { H2(B47) where B47 is (Element of ( R1 +^ D19 )) : B47 in ( support C39 ) };
L189: D21 c= D22
proof
let C41 being set;
assume L190: C41 in D21;
L191: (ex B48 being (Element of ( R1 +^ D19 )) st (C41 = ( B48 -^ R1 ) & R1 c= B48 & B48 in ( support C39 ))) by L190;
thus L192: thesis by L191;
end;
L193: (for B49 being set holds (B49 in R2 implies (ex B50 being set st S2[ B49 , B50 ])))
proof
let C42 being set;
assume L194: C42 in R2;
reconsider D23 = C42 as (Element of R2) by L194;
take ( C39 . ( R1 +^ D23 ) );
thus L195: thesis;
end;
consider C43 being (ManySortedSet of R2) such that L196: (for B51 being set holds (B51 in R2 implies S2[ B51 , ( C43 . B51 ) ])) from PBOOLE:sch 3(L193);
L197: ( support C43 ) c= D21
proof
let C44 being set;
assume L198: C44 in ( support C43 );
L199: ( C43 . C44 ) <> ( 0 ) by L198 , PRE_POLY:def 7;
L200: C44 in ( dom C43 ) by L199 , FUNCT_1:def 2;
reconsider D24 = C44 as (Element of D19) by L200 , PARTFUN1:def 2;
L201: ( C39 . ( R1 +^ D24 ) ) <> ( 0 ) by L196 , L199;
L202: ( R1 +^ D24 ) in ( support C39 ) by L201 , PRE_POLY:def 7;
reconsider D25 = ( R1 +^ D24 ) as (Element of ( R1 +^ D19 )) by ORDINAL2:32;
L203: (D24 = ( D25 -^ R1 ) & R1 c= D25) by ORDINAL3:24 , ORDINAL3:52;
thus L204: thesis by L203 , L202;
end;
L205: C43 is  natural-valued
proof
let C45 being set;
assume L206: C45 in ( dom C43 );
reconsider D26 = C45 as (Element of R2) by L206 , PARTFUN1:def 2;
L207: C45 in R2 by L206 , PARTFUN1:def 2;
L208: ( C43 . C45 ) = ( C39 . ( R1 +^ D26 ) ) by L207 , L196;
thus L209: thesis by L208;
end;
L210: ( support C39 ) is  finite;
L211: D22 is  finite from FRAENKEL:sch 21(L210);
L212: C43 is  finite-support by L211 , L189 , L197 , PRE_POLY:def 8;
reconsider D27 = C43 as (Element of ( Bags R2 )) by L212 , L205 , PRE_POLY:def 12;
take D27;
L213:
now
let C46 being set;
assume L214: C46 in ( R1 +^ R2 );
per cases  by L214 , XBOOLE_0:def 5;
suppose L215: C46 in R1;

reconsider D28 = C46 as Ordinal by L215;
L216: ( dom D20 ) = R1 by PARTFUN1:def 2;
L217: ( C39 . D28 ) = ( D20 . D28 ) by L216 , L215 , FUNCT_1:47
.= ( ( D20 +^ D27 ) . D28 ) by L215 , L51;
thus L218: ( C39 . C46 ) = ( ( D20 +^ D27 ) . C46 ) by L217;
end;
suppose L219: C46 in ( ( R1 +^ R2 ) \ R1 );

reconsider D29 = C46 as Ordinal by L219;
L220: ( D29 -^ R1 ) in R2 by L176 , L219 , ORDINAL3:60;
L221: (not D29 in R1) by L219 , XBOOLE_0:def 5;
L222: R1 c= D29 by L221 , ORDINAL1:16;
L223: ( C39 . D29 ) = ( C39 . ( R1 +^ ( D29 -^ R1 ) ) ) by L222 , ORDINAL3:def 5
.= ( D27 . ( D29 -^ R1 ) ) by L196 , L220
.= ( ( D20 +^ D27 ) . D29 ) by L219 , L51;
thus L224: ( C39 . C46 ) = ( ( D20 +^ D27 ) . C46 ) by L223;
end;
end;
thus L226: thesis by L213 , PBOOLE:3;
end;
end;
theorem
L228: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B52 , B53 being (Element of ( Bags R1 )) holds (for B54 , B55 being (Element of ( Bags R2 )) holds (( B52 +^ B54 ) = ( B53 +^ B55 ) implies (B52 = B53 & B54 = B55))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C47 , C48 being (Element of ( Bags R1 ));
let C49 , C50 being (Element of ( Bags R2 ));
assume L229: ( C47 +^ C49 ) = ( C48 +^ C50 );
L230:
now
let C51 being set;
assume L231: C51 in R1;
reconsider D30 = C51 as Ordinal by L231;
L232: ( ( C47 +^ C49 ) . D30 ) = ( C47 . D30 ) by L231 , L51;
thus L233: ( C47 . C51 ) = ( C48 . C51 ) by L232 , L229 , L231 , L51;
end;
thus L234: C47 = C48 by L230 , PBOOLE:3;
L235:
now
let C52 being set;
assume L236: C52 in R2;
reconsider D31 = C52 as Ordinal by L236;
L237: D31 = ( ( R1 +^ D31 ) -^ R1 ) by ORDINAL3:52;
L238: R1 c= ( R1 +^ D31 ) by ORDINAL3:24;
L239: (not ( R1 +^ D31 ) in R1) by L238 , ORDINAL1:5;
L240: ( R1 +^ D31 ) in ( R1 +^ R2 ) by L236 , ORDINAL2:32;
L241: ( R1 +^ D31 ) in ( ( R1 +^ R2 ) \ R1 ) by L240 , L239 , XBOOLE_0:def 5;
L242: ( ( C47 +^ C49 ) . ( R1 +^ D31 ) ) = ( C49 . ( ( R1 +^ D31 ) -^ R1 ) ) by L241 , L51;
thus L243: ( C49 . C52 ) = ( C50 . C52 ) by L242 , L229 , L241 , L237 , L51;
end;
thus L244: thesis by L235 , PBOOLE:3;
end;
theorem
L245: (for B56 being Ordinal holds (for B57 being  Abelian  add-associative  right_zeroed  right_complementable  distributive  associative non  empty doubleLoopStr holds (for B58 , B59 , B60 being (Series of B56 , B57) holds ( ( B58 + B59 ) *' B60 ) = ( ( B58 *' B60 ) + ( B59 *' B60 ) ))))
proof
let C53 being Ordinal;
let C54 being  Abelian  add-associative  right_zeroed  right_complementable  distributive  associative non  empty doubleLoopStr;
let C55 , C56 , C57 being (Series of C53 , C54);
set D32 = (the carrier of C54);
L246:
now
let C58 being (Element of ( Bags C53 ));
consider C59 being (FinSequence of D32) such that L247: ( ( ( C55 + C56 ) *' C57 ) . C58 ) = ( Sum C59 ) and L248: ( len C59 ) = ( len ( decomp C58 ) ) and L249: (for B61 being (Element of ( NAT )) holds (B61 in ( dom C59 ) implies (ex B62 , B63 being (bag of C53) st (( ( decomp C58 ) /. B61 ) = <* B62 , B63 *> & ( C59 /. B61 ) = ( ( ( C55 + C56 ) . B62 ) * ( C57 . B63 ) ))))) by POLYNOM1:def 9;
consider C60 being (FinSequence of D32) such that L250: ( ( C56 *' C57 ) . C58 ) = ( Sum C60 ) and L251: ( len C60 ) = ( len ( decomp C58 ) ) and L252: (for B64 being (Element of ( NAT )) holds (B64 in ( dom C60 ) implies (ex B65 , B66 being (bag of C53) st (( ( decomp C58 ) /. B64 ) = <* B65 , B66 *> & ( C60 /. B64 ) = ( ( C56 . B65 ) * ( C57 . B66 ) ))))) by POLYNOM1:def 9;
consider C61 being (FinSequence of D32) such that L253: ( ( C55 *' C57 ) . C58 ) = ( Sum C61 ) and L254: ( len C61 ) = ( len ( decomp C58 ) ) and L255: (for B67 being (Element of ( NAT )) holds (B67 in ( dom C61 ) implies (ex B68 , B69 being (bag of C53) st (( ( decomp C58 ) /. B67 ) = <* B68 , B69 *> & ( C61 /. B67 ) = ( ( C55 . B68 ) * ( C57 . B69 ) ))))) by POLYNOM1:def 9;
reconsider D33 = C61 , D34 = C60 as (Element of ( ( len C59 ) -tuples_on D32 )) by L248 , L254 , L251 , FINSEQ_2:92;
L256: ( dom D34 ) = ( dom C59 ) by L248 , L251 , FINSEQ_3:29;
L257: ( dom D33 ) = ( dom C59 ) by L248 , L254 , FINSEQ_3:29;
L258: ( dom ( D33 + D34 ) ) = ( dom C59 ) by L257 , L256 , POLYNOM1:1;
L259:
now
let C62 being Nat;
assume L260: C62 in ( dom C59 );
consider C63 , C64 being (bag of C53) such that L261: ( ( decomp C58 ) /. C62 ) = <* C63 , C64 *> and L262: ( C59 /. C62 ) = ( ( ( C55 + C56 ) . C63 ) * ( C57 . C64 ) ) by L260 , L249;
L263: (( D33 /. C62 ) = ( D33 . C62 ) & ( D34 /. C62 ) = ( D34 . C62 )) by L257 , L256 , L260 , PARTFUN1:def 6;
consider C65 , C66 being (bag of C53) such that L264: ( ( decomp C58 ) /. C62 ) = <* C65 , C66 *> and L265: ( D34 /. C62 ) = ( ( C56 . C65 ) * ( C57 . C66 ) ) by L252 , L256 , L260;
L266: (C63 = C65 & C64 = C66) by L261 , L264 , FINSEQ_1:77;
consider C67 , C68 being (bag of C53) such that L267: ( ( decomp C58 ) /. C62 ) = <* C67 , C68 *> and L268: ( D33 /. C62 ) = ( ( C55 . C67 ) * ( C57 . C68 ) ) by L255 , L257 , L260;
L269: (C63 = C67 & C64 = C68) by L261 , L267 , FINSEQ_1:77;
L270: ( C59 /. C62 ) = ( C59 . C62 ) by L260 , PARTFUN1:def 6;
thus L271: ( C59 . C62 ) = ( ( ( C55 . C63 ) + ( C56 . C63 ) ) * ( C57 . C64 ) ) by L270 , L262 , POLYNOM1:15
.= ( ( ( C55 . C63 ) * ( C57 . C64 ) ) + ( ( C56 . C63 ) * ( C57 . C64 ) ) ) by VECTSP_1:def 7
.= ( ( D33 + D34 ) . C62 ) by L258 , L260 , L268 , L265 , L269 , L266 , L263 , FVSUM_1:17;
end;
L272: ( len ( D33 + D34 ) ) = ( len C59 ) by L258 , FINSEQ_3:29;
L273: C59 = ( D33 + D34 ) by L272 , L259 , FINSEQ_2:9;
thus L274: ( ( ( C55 + C56 ) *' C57 ) . C58 ) = ( ( Sum D33 ) + ( Sum D34 ) ) by L273 , L247 , FVSUM_1:76
.= ( ( ( C55 *' C57 ) + ( C56 *' C57 ) ) . C58 ) by L253 , L250 , POLYNOM1:15;
end;
thus L275: thesis by L246 , FUNCT_2:63;
end;
begin
registration
let C69 being Ordinal;
let C70 being  right_zeroed  Abelian  add-associative  right_complementable  well-unital  distributive  associative non  trivial non  empty doubleLoopStr;
cluster ( Polynom-Ring (C69 , C70) ) -> non  trivial  distributive;
coherence
proof
thus L276: ( Polynom-Ring (C69 , C70) ) is non  trivial
proof
take ( 1_ ( Polynom-Ring (C69 , C70) ) );
L277: (( 1_ ( Polynom-Ring (C69 , C70) ) ) = ( 1_ (C69 , C70) ) & ( ( 0_ (C69 , C70) ) . ( EmptyBag C69 ) ) = ( 0. C70 )) by POLYNOM1:22 , POLYNOM1:31;
L278: (( 0. C70 ) <> ( 1_ C70 ) & ( 0. ( Polynom-Ring (C69 , C70) ) ) = ( 0_ (C69 , C70) )) by POLYNOM1:def 10;
thus L279: thesis by L278 , L277 , POLYNOM1:25;
end;

thus L280: ( Polynom-Ring (C69 , C70) ) is  distributive
proof
let C71 , C72 , C73 being (Element of ( Polynom-Ring (C69 , C70) ));
reconsider D35 = C71 , D36 = C72 , D37 = C73 as (Polynomial of C69 , C70) by POLYNOM1:def 10;
reconsider D38 = C71 , D39 = C72 , D40 = C73 as (Element of ( Polynom-Ring (C69 , C70) ));
L281: (( D35 *' D36 ) = ( D38 * D39 ) & ( D35 *' D37 ) = ( D38 * D40 )) by POLYNOM1:def 10;
L282: ( D39 + D40 ) = ( D36 + D37 ) by POLYNOM1:def 10;
thus L283: ( C71 * ( C72 + C73 ) ) = ( D35 *' ( D36 + D37 ) ) by L282 , POLYNOM1:def 10
.= ( ( D35 *' D36 ) + ( D35 *' D37 ) ) by POLYNOM1:26
.= ( ( C71 * C72 ) + ( C71 * C73 ) ) by L281 , POLYNOM1:def 10;
L284: (( D36 *' D35 ) = ( D39 * D38 ) & ( D37 *' D35 ) = ( D40 * D38 )) by POLYNOM1:def 10;
L285: ( D39 + D40 ) = ( D36 + D37 ) by POLYNOM1:def 10;
thus L286: ( ( C72 + C73 ) * C71 ) = ( ( D36 + D37 ) *' D35 ) by L285 , POLYNOM1:def 10
.= ( ( D36 *' D35 ) + ( D37 *' D35 ) ) by L245
.= ( ( C72 * C71 ) + ( C73 * C71 ) ) by L284 , POLYNOM1:def 10;
end;

end;
end;
definition
let C74 , C75 being non  empty Ordinal;
let C76 being  right_zeroed  add-associative  right_complementable  well-unital  distributive non  trivial doubleLoopStr;
let C77 being (Polynomial of C74 , ( Polynom-Ring (C75 , C76) ));
func Compress C77 -> (Polynomial of ( C74 +^ C75 ) , C76) means 
:L282: (for B70 being (Element of ( Bags ( C74 +^ C75 ) )) holds (ex B71 being (Element of ( Bags C74 )) st (ex B72 being (Element of ( Bags C75 )) st (ex B73 being (Polynomial of C75 , C76) st (B73 = ( C77 . B71 ) & B70 = ( B71 +^ B72 ) & ( it . B70 ) = ( B73 . B72 ))))));
existence
proof
deffunc H3((Element of ( Bags C74 ))) = { ( $1 +^ B74 ) where B74 is (Element of ( Bags C75 )) : (ex B75 being (Polynomial of C75 , C76) st (B75 = ( C77 . $1 ) & B74 in ( Support B75 ))) };
defpred S3[ (Element of ( Bags ( C74 +^ C75 ) )) , (Element of C76) ] means (ex B76 being (Element of ( Bags C74 )) st (ex B77 being (Element of ( Bags C75 )) st (ex B78 being (Polynomial of C75 , C76) st (B78 = ( C77 . B76 ) & $1 = ( B76 +^ B77 ) & $2 = ( B78 . B77 )))));
set D41 = { H3(B79) where B79 is (Element of ( Bags C74 )) : B79 in ( Support C77 ) };
L283: (for B80 being set holds (B80 in D41 implies B80 is  finite))
proof
let C78 being set;
assume L284: C78 in D41;
consider C79 being (Element of ( Bags C74 )) such that L285: C78 = { ( C79 +^ B81 ) where B81 is (Element of ( Bags C75 )) : (ex B82 being (Polynomial of C75 , C76) st (B82 = ( C77 . C79 ) & B81 in ( Support B82 ))) } and L286: C79 in ( Support C77 ) by L284;
deffunc H4((Element of ( Bags C75 ))) = ( C79 +^ $1 );
reconsider D42 = ( C77 . C79 ) as (Polynomial of C75 , C76) by POLYNOM1:def 10;
set D43 = { H4(B83) where B83 is (Element of ( Bags C75 )) : B83 in ( Support D42 ) };
L287: C78 c= D43
proof
let C80 being set;
assume L288: C80 in C78;
L289: (ex B84 being (Element of ( Bags C75 )) st (C80 = ( C79 +^ B84 ) & (ex B85 being (Polynomial of C75 , C76) st (B85 = ( C77 . C79 ) & B84 in ( Support B85 ))))) by L288 , L285;
thus L290: thesis by L289;
end;
L291: ( Support D42 ) is  finite;
L292: D43 is  finite from FRAENKEL:sch 21(L291);
thus L293: thesis by L292 , L287;
end;
L294: (for B86 being (Element of ( Bags ( C74 +^ C75 ) )) holds (ex B87 being (Element of C76) st S3[ B86 , B87 ]))
proof
let C81 being (Element of ( Bags ( C74 +^ C75 ) ));
consider C82 being (Element of ( Bags C74 )), C83 being (Element of ( Bags C75 )) such that L295: C81 = ( C82 +^ C83 ) by L173;
reconsider D44 = ( C77 . C82 ) as (Polynomial of C75 , C76) by POLYNOM1:def 10;
take ( D44 . C83 );
take C82;
take C83;
take D44;
thus L296: thesis by L295;
end;
consider C84 being (Function of ( Bags ( C74 +^ C75 ) ) , (the carrier of C76)) such that L297: (for B88 being (Element of ( Bags ( C74 +^ C75 ) )) holds S3[ B88 , ( C84 . B88 ) ]) from FUNCT_2:sch 3(L294);
reconsider D45 = C84 as (Series of ( C74 +^ C75 ) , C76);
L298: ( Support D45 ) = ( union D41 )
proof
thus L299: ( Support D45 ) c= ( union D41 )
proof
let C85 being set;
assume L300: C85 in ( Support D45 );
L301: ( D45 . C85 ) <> ( 0. C76 ) by L300 , POLYNOM1:def 3;
consider C86 being (Element of ( Bags C74 )), C87 being (Element of ( Bags C75 )) such that L302: C85 = ( C86 +^ C87 ) by L300 , L173;
consider C88 being set such that L303: C88 = { ( C86 +^ B89 ) where B89 is (Element of ( Bags C75 )) : (ex B90 being (Polynomial of C75 , C76) st (B90 = ( C77 . C86 ) & B89 in ( Support B90 ))) };
consider C89 being (Element of ( Bags C74 )), C90 being (Element of ( Bags C75 )), C91 being (Polynomial of C75 , C76) such that L304: C91 = ( C77 . C89 ) and L305: ( C86 +^ C87 ) = ( C89 +^ C90 ) and L306: ( D45 . ( C86 +^ C87 ) ) = ( C91 . C90 ) by L297;
L307: C86 = C89 by L305 , L228;
L308:
now
assume L309: ( C77 . C86 ) = ( 0. ( Polynom-Ring (C75 , C76) ) );
L310: C91 = ( 0_ (C75 , C76) ) by L309 , L304 , L307 , POLYNOM1:def 10;
thus L311: contradiction by L310 , L301 , L302 , L306 , POLYNOM1:22;
end;
L312: C86 in ( Support C77 ) by L308 , POLYNOM1:def 3;
L313: C88 in D41 by L312 , L303;
L314: C87 = C90 by L305 , L228;
L315: C87 in ( Support C91 ) by L314 , L301 , L302 , L306 , POLYNOM1:def 3;
L316: C85 in C88 by L315 , L302 , L303 , L304 , L307;
thus L317: thesis by L316 , L313 , TARSKI:def 4;
end;

let C92 being set;
assume L318: C92 in ( union D41 );
consider C93 being set such that L319: C92 in C93 and L320: C93 in D41 by L318 , TARSKI:def 4;
consider C94 being (Element of ( Bags C74 )) such that L321: C93 = { ( C94 +^ B91 ) where B91 is (Element of ( Bags C75 )) : (ex B92 being (Polynomial of C75 , C76) st (B92 = ( C77 . C94 ) & B91 in ( Support B92 ))) } and L322: C94 in ( Support C77 ) by L320;
consider C95 being (Element of ( Bags C75 )) such that L323: C92 = ( C94 +^ C95 ) and L324: (ex B93 being (Polynomial of C75 , C76) st (B93 = ( C77 . C94 ) & C95 in ( Support B93 ))) by L319 , L321;
consider C96 being (Polynomial of C75 , C76) such that L325: C96 = ( C77 . C94 ) and L326: C95 in ( Support C96 ) by L324;
L327: ( C96 . C95 ) <> ( 0. C76 ) by L326 , POLYNOM1:def 3;
consider C97 being (Element of ( Bags C74 )), C98 being (Element of ( Bags C75 )), C99 being (Polynomial of C75 , C76) such that L328: C99 = ( C77 . C97 ) and L329: ( C94 +^ C95 ) = ( C97 +^ C98 ) and L330: ( D45 . ( C94 +^ C95 ) ) = ( C99 . C98 ) by L297;
L331: ( D45 . ( C94 +^ C95 ) ) = ( C99 . C95 ) by L329 , L330 , L228;
L332: C99 = C96 by L325 , L328 , L329 , L228;
thus L333: thesis by L332 , L323 , L327 , L331 , POLYNOM1:def 3;
end;
L334: ( Support C77 ) is  finite by POLYNOM1:def 4;
L335: D41 is  finite from FRAENKEL:sch 21(L334);
L336: ( union D41 ) is  finite by L335 , L283 , FINSET_1:7;
reconsider D46 = D45 as (Polynomial of ( C74 +^ C75 ) , C76) by L336 , L298 , POLYNOM1:def 4;
take D46;
let C100 being (Element of ( Bags ( C74 +^ C75 ) ));
consider C101 being (Element of ( Bags C74 )), C102 being (Element of ( Bags C75 )), C103 being (Polynomial of C75 , C76) such that L337: C103 = ( C77 . C101 ) and L338: C100 = ( C101 +^ C102 ) and L339: ( D46 . C100 ) = ( C103 . C102 ) by L297;
consider C104 being (Element of ( Bags C74 )), C105 being (Element of ( Bags C75 )) such that L340: C100 = ( C104 +^ C105 ) by L173;
reconsider D47 = ( C77 . C104 ) as (Polynomial of C75 , C76) by POLYNOM1:def 10;
take C104;
take C105;
take D47;
thus L341: D47 = ( C77 . C104 );
thus L342: C100 = ( C104 +^ C105 ) by L340;
L343: C104 = C101 by L340 , L338 , L228;
thus L344: thesis by L343 , L340 , L337 , L338 , L339 , L228;
end;
uniqueness
proof
let C106 , C107 being (Polynomial of ( C74 +^ C75 ) , C76);
assume that
L345: (for B94 being (Element of ( Bags ( C74 +^ C75 ) )) holds (ex B95 being (Element of ( Bags C74 )) st (ex B96 being (Element of ( Bags C75 )) st (ex B97 being (Polynomial of C75 , C76) st (B97 = ( C77 . B95 ) & B94 = ( B95 +^ B96 ) & ( C106 . B94 ) = ( B97 . B96 ))))))
and
L346: (for B98 being (Element of ( Bags ( C74 +^ C75 ) )) holds (ex B99 being (Element of ( Bags C74 )) st (ex B100 being (Element of ( Bags C75 )) st (ex B101 being (Polynomial of C75 , C76) st (B101 = ( C77 . B99 ) & B98 = ( B99 +^ B100 ) & ( C107 . B98 ) = ( B101 . B100 ))))));
L347: (for B102 being (Element of ( Bags ( C74 +^ C75 ) )) holds ( C106 . B102 ) = ( C107 . B102 ))
proof
let C108 being (Element of ( Bags ( C74 +^ C75 ) ));
consider C109 being (Element of ( Bags C74 )), C110 being (Element of ( Bags C75 )), C111 being (Polynomial of C75 , C76) such that L348: C111 = ( C77 . C109 ) and L349: C108 = ( C109 +^ C110 ) and L350: ( C106 . C108 ) = ( C111 . C110 ) by L345;
consider C112 being (Element of ( Bags C74 )), C113 being (Element of ( Bags C75 )), C114 being (Polynomial of C75 , C76) such that L351: C114 = ( C77 . C112 ) and L352: C108 = ( C112 +^ C113 ) and L353: ( C107 . C108 ) = ( C114 . C113 ) by L346;
L354: C110 = C113 by L349 , L352 , L228;
thus L355: thesis by L354 , L348 , L349 , L350 , L351 , L352 , L353 , L228;
end;
thus L356: C106 = C107 by L347 , FUNCT_2:63;
end;
end;
theorem
L358: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B103 , B104 being (Element of ( Bags R1 )) holds (for B105 , B106 being (Element of ( Bags R2 )) holds ((B103 divides B104 & B105 divides B106) implies ( B103 +^ B105 ) divides ( B104 +^ B106 ))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C115 , C116 being (Element of ( Bags R1 ));
let C117 , C118 being (Element of ( Bags R2 ));
assume that
L359: C115 divides C116
and
L360: C117 divides C118;
L361:
now
reconsider D48 = C115 , D49 = C116 as (bag of R1);
let C119 being set;
L362: ( D48 . C119 ) <= ( D49 . C119 ) by L359 , PRE_POLY:def 11;
assume L363: C119 in ( R1 +^ R2 );
per cases  by L363 , XBOOLE_0:def 5;
suppose L364: C119 in R1;

reconsider D50 = C119 as Ordinal by L364;
L365: ( ( C115 +^ C117 ) . D50 ) = ( C115 . D50 ) by L364 , L51;
thus L366: ( ( C115 +^ C117 ) . C119 ) <= ( ( C116 +^ C118 ) . C119 ) by L365 , L362 , L364 , L51;
end;
suppose L367: C119 in ( ( R1 +^ R2 ) \ R1 );

reconsider D51 = C119 as Ordinal by L367;
L368: (( ( C115 +^ C117 ) . D51 ) = ( C117 . ( D51 -^ R1 ) ) & ( ( C116 +^ C118 ) . D51 ) = ( C118 . ( D51 -^ R1 ) )) by L367 , L51;
thus L369: ( ( C115 +^ C117 ) . C119 ) <= ( ( C116 +^ C118 ) . C119 ) by L368 , L360 , PRE_POLY:def 11;
end;
end;
thus L371: thesis by L361 , PRE_POLY:46;
end;
theorem
L372: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B107 being (bag of ( R1 +^ R2 )) holds (for B108 being (Element of ( Bags R1 )) holds (for B109 being (Element of ( Bags R2 )) holds (B107 divides ( B108 +^ B109 ) implies (ex B110 being (Element of ( Bags R1 )) st (ex B111 being (Element of ( Bags R2 )) st (B110 divides B108 & B111 divides B109 & B107 = ( B110 +^ B111 ))))))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C120 being (bag of ( R1 +^ R2 ));
let C121 being (Element of ( Bags R1 ));
let C122 being (Element of ( Bags R2 ));
reconsider D52 = C120 as (Element of ( Bags ( R1 +^ R2 ) )) by PRE_POLY:def 12;
consider C123 being (Element of ( Bags R1 )), C124 being (Element of ( Bags R2 )) such that L373: D52 = ( C123 +^ C124 ) by L173;
reconsider D53 = C123 , D54 = C121 as (bag of R1);
reconsider D55 = C124 , D56 = C122 as (bag of R2);
assume L374: C120 divides ( C121 +^ C122 );
L375: (for B112 being set holds (B112 in R2 implies ( D55 . B112 ) <= ( D56 . B112 )))
proof
let C125 being set;
assume L376: C125 in R2;
reconsider D57 = C125 as Ordinal by L376;
set D58 = ( R1 +^ D57 );
L377: R1 c= ( R1 +^ D57 ) by ORDINAL3:24;
L378: (not ( R1 +^ D57 ) in R1) by L377 , ORDINAL1:5;
L379: (( ( C123 +^ C124 ) . D58 ) <= ( ( C121 +^ C122 ) . D58 ) & D57 = ( ( R1 +^ D57 ) -^ R1 )) by L374 , L373 , ORDINAL3:52 , PRE_POLY:def 11;
L380: ( R1 +^ D57 ) in ( R1 +^ R2 ) by L376 , ORDINAL2:32;
L381: ( R1 +^ D57 ) in ( ( R1 +^ R2 ) \ R1 ) by L380 , L378 , XBOOLE_0:def 5;
L382: ( ( C121 +^ C122 ) . ( R1 +^ D57 ) ) = ( C122 . ( ( R1 +^ D57 ) -^ R1 ) ) by L381 , L51;
thus L383: thesis by L382 , L381 , L379 , L51;
end;
take C123;
take C124;
L384: (for B113 being set holds (B113 in R1 implies ( D53 . B113 ) <= ( D54 . B113 )))
proof
let C126 being set;
assume L385: C126 in R1;
reconsider D59 = C126 as Ordinal by L385;
L386: ( ( C123 +^ C124 ) . C126 ) <= ( ( C121 +^ C122 ) . C126 ) by L374 , L373 , PRE_POLY:def 11;
L387: ( ( C123 +^ C124 ) . D59 ) = ( C123 . D59 ) by L385 , L51;
thus L388: thesis by L387 , L385 , L386 , L51;
end;
thus L389: thesis by L384 , L373 , L375 , PRE_POLY:46;
end;
theorem
L390: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B114 , B115 being (Element of ( Bags R1 )) holds (for B116 , B117 being (Element of ( Bags R2 )) holds (( B114 +^ B116 ) < ( B115 +^ B117 ) iff (B114 < B115 or (B114 = B115 & B116 < B117)))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C127 , C128 being (Element of ( Bags R1 ));
let C129 , C130 being (Element of ( Bags R2 ));
thus L391: (( C127 +^ C129 ) < ( C128 +^ C130 ) implies (C127 < C128 or (C127 = C128 & C129 < C130)))
proof
assume L392: ( C127 +^ C129 ) < ( C128 +^ C130 );
consider C131 being Ordinal such that L393: ( ( C127 +^ C129 ) . C131 ) < ( ( C128 +^ C130 ) . C131 ) and L394: (for B118 being Ordinal holds (B118 in C131 implies ( ( C127 +^ C129 ) . B118 ) = ( ( C128 +^ C130 ) . B118 ))) by L392 , PRE_POLY:def 9;
L395:
now
assume L396: (not C131 in ( dom ( C128 +^ C130 ) ));
L397: ( ( C128 +^ C130 ) . C131 ) = ( 0 ) by L396 , FUNCT_1:def 2;
thus L398: contradiction by L397 , L393 , NAT_1:2;
end;
L399: C131 in ( R1 +^ R2 ) by L395 , PARTFUN1:def 2;
L400:
now
per cases  by L399 , XBOOLE_0:def 5;
case L401: C131 in R1;
reconsider D60 = C127 , D61 = C128 as (bag of R1);
L402: (for B119 being Ordinal holds (B119 in C131 implies ( D60 . B119 ) = ( D61 . B119 )))
proof
let C132 being Ordinal;
assume L403: C132 in C131;
L404: ( ( C127 +^ C129 ) . C132 ) = ( ( C128 +^ C130 ) . C132 ) by L403 , L394;
L405: C132 in R1 by L401 , L403 , ORDINAL1:10;
L406: ( ( C127 +^ C129 ) . C132 ) = ( C127 . C132 ) by L405 , L51;
thus L407: thesis by L406 , L404 , L405 , L51;
end;
L408: ( ( C127 +^ C129 ) . C131 ) = ( C127 . C131 ) by L401 , L51;
L409: ( C127 . C131 ) < ( C128 . C131 ) by L408 , L393 , L401 , L51;
thus L410: C127 < C128 by L409 , L402 , PRE_POLY:def 9;
end;
case L411: C131 in ( ( R1 +^ R2 ) \ R1 );
set D62 = ( C131 -^ R1 );
L412: (not C131 in R1) by L411 , XBOOLE_0:def 5;
L413: R1 c= C131 by L412 , ORDINAL1:16;
L414: C131 = ( R1 +^ ( C131 -^ R1 ) ) by L413 , ORDINAL3:def 5;
L415: (for B120 being Ordinal holds (B120 in D62 implies ( C129 . B120 ) = ( C130 . B120 )))
proof
let C133 being Ordinal;
L416: R1 c= ( R1 +^ C133 ) by ORDINAL3:24;
L417: (not ( R1 +^ C133 ) in R1) by L416 , ORDINAL1:5;
assume L418: C133 in D62;
L419: ( R1 +^ C133 ) in ( R1 +^ D62 ) by L418 , ORDINAL2:32;
L420: ( R1 +^ C133 ) in ( R1 +^ R2 ) by L419 , L411 , L414 , ORDINAL1:10;
L421: ( R1 +^ C133 ) in ( ( R1 +^ R2 ) \ R1 ) by L420 , L417 , XBOOLE_0:def 5;
L422: ( ( C128 +^ C130 ) . ( R1 +^ C133 ) ) = ( C130 . ( ( R1 +^ C133 ) -^ R1 ) ) by L421 , L51
.= ( C130 . C133 ) by ORDINAL3:52;
L423: ( ( C127 +^ C129 ) . ( R1 +^ C133 ) ) = ( C129 . ( ( R1 +^ C133 ) -^ R1 ) ) by L421 , L51
.= ( C129 . C133 ) by ORDINAL3:52;
thus L424: thesis by L423 , L394 , L414 , L418 , L422 , ORDINAL2:32;
end;
L425: (for B121 being set holds (B121 in R1 implies ( C127 . B121 ) = ( C128 . B121 )))
proof
L426: (not C131 in R1) by L411 , XBOOLE_0:def 5;
L427: R1 c= C131 by L426 , ORDINAL1:16;
let C134 being set;
assume L428: C134 in R1;
reconsider D63 = C134 as Ordinal by L428;
L429: (( ( C127 +^ C129 ) . D63 ) = ( C127 . D63 ) & ( ( C128 +^ C130 ) . D63 ) = ( C128 . D63 )) by L428 , L51;
thus L430: thesis by L429 , L394 , L428 , L427;
end;
thus L431: C127 = C128 by L425 , PBOOLE:3;
L432: ( ( C127 +^ C129 ) . C131 ) = ( C129 . ( C131 -^ R1 ) ) by L411 , L51;
L433: ( C129 . D62 ) < ( C130 . D62 ) by L432 , L393 , L411 , L51;
thus L434: C129 < C130 by L433 , L415 , PRE_POLY:def 9;
end;
end;
thus L436: thesis by L400;
end;

thus L437: ((C127 < C128 or (C127 = C128 & C129 < C130)) implies ( C127 +^ C129 ) < ( C128 +^ C130 ))
proof
assume L438: (C127 < C128 or (C127 = C128 & C129 < C130));
L439:
now
per cases ;
case L440: C127 < C128;
consider C135 being Ordinal such that L441: C135 in R1 and L442: ( C127 . C135 ) < ( C128 . C135 ) and L443: (for B122 being Ordinal holds (B122 in C135 implies ( C127 . B122 ) = ( C128 . B122 ))) by L440 , L38;
L444: (for B123 being Ordinal holds (B123 in C135 implies ( ( C127 +^ C129 ) . B123 ) = ( ( C128 +^ C130 ) . B123 )))
proof
let C136 being Ordinal;
assume L445: C136 in C135;
L446: C136 in R1 by L445 , L441 , ORDINAL1:10;
L447: (( ( C127 +^ C129 ) . C136 ) = ( C127 . C136 ) & ( ( C128 +^ C130 ) . C136 ) = ( C128 . C136 )) by L446 , L51;
thus L448: thesis by L447 , L443 , L445;
end;
L449: (( ( C127 +^ C129 ) . C135 ) = ( C127 . C135 ) & ( ( C128 +^ C130 ) . C135 ) = ( C128 . C135 )) by L441 , L51;
thus L450: thesis by L449 , L442 , L444 , PRE_POLY:def 9;
end;
case L451: (not C127 < C128);
consider C137 being Ordinal such that L452: C137 in R2 and L453: ( C129 . C137 ) < ( C130 . C137 ) and L454: (for B124 being Ordinal holds (B124 in C137 implies ( C129 . B124 ) = ( C130 . B124 ))) by L451 , L438 , L38;
set D64 = ( R1 +^ C137 );
L455: (for B125 being Ordinal holds (B125 in D64 implies ( ( C127 +^ C129 ) . B125 ) = ( ( C128 +^ C130 ) . B125 )))
proof
let C138 being Ordinal;
assume L456: C138 in D64;
per cases ;
suppose L457: C138 in R1;

thus L458: ( ( C127 +^ C129 ) . C138 ) = ( C128 . C138 ) by L457 , L438 , L451 , L51
.= ( ( C128 +^ C130 ) . C138 ) by L457 , L51;
end;
suppose L459: (not C138 in R1);

L460: R1 c= C138 by L459 , ORDINAL1:16;
L461: ( C138 -^ R1 ) in ( ( R1 +^ C137 ) -^ R1 ) by L460 , L456 , ORDINAL3:53;
L462: ( C138 -^ R1 ) in C137 by L461 , ORDINAL3:52;
L463: ( R1 +^ C137 ) in ( R1 +^ R2 ) by L452 , ORDINAL2:32;
L464: C138 in ( R1 +^ R2 ) by L463 , L456 , ORDINAL1:10;
L465: C138 in ( ( R1 +^ R2 ) \ R1 ) by L464 , L459 , XBOOLE_0:def 5;
thus L466: ( ( C127 +^ C129 ) . C138 ) = ( C129 . ( C138 -^ R1 ) ) by L465 , L51
.= ( C130 . ( C138 -^ R1 ) ) by L454 , L462
.= ( ( C128 +^ C130 ) . C138 ) by L465 , L51;
end;
end;
L468: R1 c= ( R1 +^ C137 ) by ORDINAL3:24;
L469: (not ( R1 +^ C137 ) in R1) by L468 , ORDINAL1:5;
L470: C137 = ( ( R1 +^ C137 ) -^ R1 ) by ORDINAL3:52;
L471: ( R1 +^ C137 ) in ( R1 +^ R2 ) by L452 , ORDINAL2:32;
L472: ( R1 +^ C137 ) in ( ( R1 +^ R2 ) \ R1 ) by L471 , L469 , XBOOLE_0:def 5;
L473: ( ( C128 +^ C130 ) . ( R1 +^ C137 ) ) = ( C130 . ( ( R1 +^ C137 ) -^ R1 ) ) by L472 , L51;
L474: ( ( C127 +^ C129 ) . D64 ) < ( ( C128 +^ C130 ) . D64 ) by L473 , L453 , L472 , L470 , L51;
thus L475: thesis by L474 , L455 , PRE_POLY:def 9;
end;
end;
thus L477: thesis by L439;
end;

end;
theorem
L438: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B126 being (Element of ( Bags R1 )) holds (for B127 being (Element of ( Bags R2 )) holds (for B128 being (FinSequence of ( ( Bags ( R1 +^ R2 ) ) * )) holds ((( dom B128 ) = ( dom ( divisors B126 ) ) & (for B129 being Nat holds (B129 in ( dom ( divisors B126 ) ) implies (ex B130 being (Element of ( Bags R1 )) st (ex B131 being (FinSequence of ( Bags ( R1 +^ R2 ) )) st (B131 = ( B128 /. B129 ) & ( ( divisors B126 ) /. B129 ) = B130 & ( len B131 ) = ( len ( divisors B127 ) ) & (for B132 being Nat holds (B132 in ( dom B131 ) implies (ex B133 being (Element of ( Bags R2 )) st (( ( divisors B127 ) /. B132 ) = B133 & ( B131 /. B132 ) = ( B130 +^ B133 ))))))))))) implies ( divisors ( B126 +^ B127 ) ) = ( FlattenSeq B128 )))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C139 being (Element of ( Bags R1 ));
let C140 being (Element of ( Bags R2 ));
let C141 being (FinSequence of ( ( Bags ( R1 +^ R2 ) ) * ));
assume that
L439: ( dom C141 ) = ( dom ( divisors C139 ) )
and
L440: (for B134 being Nat holds (B134 in ( dom ( divisors C139 ) ) implies (ex B135 being (Element of ( Bags R1 )) st (ex B136 being (FinSequence of ( Bags ( R1 +^ R2 ) )) st (B136 = ( C141 /. B134 ) & ( ( divisors C139 ) /. B134 ) = B135 & ( len B136 ) = ( len ( divisors C140 ) ) & (for B137 being Nat holds (B137 in ( dom B136 ) implies (ex B138 being (Element of ( Bags R2 )) st (( ( divisors C140 ) /. B137 ) = B138 & ( B136 /. B137 ) = ( B135 +^ B138 ))))))))));
reconsider D65 = ( Del (C141 , 1) ) as (FinSequence of ( ( Bags ( R1 +^ R2 ) ) * ));
consider C142 being (Element of ( Bags R1 )), C143 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L441: C143 = ( C141 /. 1 ) and L442: ( ( divisors C139 ) /. 1 ) = C142 and L443: ( len C143 ) = ( len ( divisors C140 ) ) and L444: (for B139 being Nat holds (B139 in ( dom C143 ) implies (ex B140 being (Element of ( Bags R2 )) st (( ( divisors C140 ) /. B139 ) = B140 & ( C143 /. B139 ) = ( C142 +^ B140 ))))) by L440 , FINSEQ_5:6;
L445: ( len ( divisors C139 ) ) <> ( 0 );
L446: ( len C141 ) <> ( 0 ) by L445 , L439 , FINSEQ_3:29;
L447: C141 is non  empty by L446;
L448: 1 in ( dom C141 ) by L447 , FINSEQ_5:6;
reconsider D66 = ( C141 . 1 ) as (Element of ( ( Bags ( R1 +^ R2 ) ) * )) by L448 , L441 , PARTFUN1:def 6;
L449: C141 = ( <* ( C141 . 1 ) *> ^ ( Del (C141 , 1) ) ) by L447 , POLYALG1:4;
L450: ( FlattenSeq C141 ) = ( ( FlattenSeq <* D66 *> ) ^ ( FlattenSeq D65 ) ) by L449 , PRE_POLY:3
.= ( D66 ^ ( FlattenSeq D65 ) ) by PRE_POLY:1;
set D67 = ( FlattenSeq C141 );
L451: (for B141 , B142 being Nat holds ((B141 in ( dom D67 ) & B142 in ( dom D67 ) & B141 < B142) implies (( D67 /. B141 ) <> ( D67 /. B142 ) & [ ( D67 /. B141 ) , ( D67 /. B142 ) ] in ( BagOrder ( R1 +^ R2 ) ))))
proof
let C144 , C145 being Nat;
assume that
L452: C144 in ( dom D67 )
and
L453: C145 in ( dom D67 )
and
L454: C144 < C145;
L455: ( D67 /. C144 ) = ( D67 . C144 ) by L452 , PARTFUN1:def 6;
consider C146 , C147 being (Element of ( NAT )) such that L456: C146 in ( dom C141 ) and L457: C147 in ( dom ( C141 . C146 ) ) and L458: C144 = ( ( Sum ( Card ( C141 | ( C146 -' 1 ) ) ) ) + C147 ) and L459: ( ( C141 . C146 ) . C147 ) = ( ( FlattenSeq C141 ) . C144 ) by L452 , PRE_POLY:29;
consider C148 being (Element of ( Bags R1 )), C149 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L460: C149 = ( C141 /. C146 ) and L461: ( ( divisors C139 ) /. C146 ) = C148 and L462: ( len C149 ) = ( len ( divisors C140 ) ) and L463: (for B143 being Nat holds (B143 in ( dom C149 ) implies (ex B144 being (Element of ( Bags R2 )) st (( ( divisors C140 ) /. B143 ) = B144 & ( C149 /. B143 ) = ( C148 +^ B144 ))))) by L439 , L440 , L456;
L464: C147 in ( dom C149 ) by L456 , L457 , L460 , PARTFUN1:def 6;
consider C150 being (Element of ( Bags R2 )) such that L465: ( ( divisors C140 ) /. C147 ) = C150 and L466: ( C149 /. C147 ) = ( C148 +^ C150 ) by L464 , L463;
L467: ( Seg ( len C149 ) ) = ( dom C149 ) by FINSEQ_1:def 3;
L468: C147 in ( dom ( divisors C140 ) ) by L467 , L462 , L464 , FINSEQ_1:def 3;
L469:
now
consider C151 , C152 being (Element of ( NAT )) such that L470: C151 in ( dom C141 ) and L471: C152 in ( dom ( C141 . C151 ) ) and L472: C145 = ( ( Sum ( Card ( C141 | ( C151 -' 1 ) ) ) ) + C152 ) and L473: ( ( C141 . C151 ) . C152 ) = ( ( FlattenSeq C141 ) . C145 ) by L453 , PRE_POLY:29;
consider C153 being (Element of ( Bags R1 )), C154 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L474: C154 = ( C141 /. C151 ) and L475: ( ( divisors C139 ) /. C151 ) = C153 and L476: ( len C154 ) = ( len ( divisors C140 ) ) and L477: (for B145 being Nat holds (B145 in ( dom C154 ) implies (ex B146 being (Element of ( Bags R2 )) st (( ( divisors C140 ) /. B145 ) = B146 & ( C154 /. B145 ) = ( C153 +^ B146 ))))) by L439 , L440 , L470;
L478: ( ( divisors C139 ) . C151 ) = C153 by L439 , L470 , L475 , PARTFUN1:def 6;
L479: C154 = ( C141 . C151 ) by L470 , L474 , PARTFUN1:def 6;
L480: ( ( FlattenSeq C141 ) . C145 ) = ( C154 /. C152 ) by L479 , L471 , L473 , PARTFUN1:def 6;
L481: C152 in ( dom C154 ) by L470 , L471 , L474 , PARTFUN1:def 6;
consider C155 being (Element of ( Bags R2 )) such that L482: ( ( divisors C140 ) /. C152 ) = C155 and L483: ( C154 /. C152 ) = ( C153 +^ C155 ) by L481 , L477;
L484: ( Seg ( len C154 ) ) = ( dom C154 ) by FINSEQ_1:def 3;
L485: C152 in ( dom ( divisors C140 ) ) by L484 , L476 , L481 , FINSEQ_1:def 3;
L486: ( ( divisors C140 ) . C152 ) = C155 by L485 , L482 , PARTFUN1:def 6;
consider C156 , C157 being (Element of ( NAT )) such that L487: C156 in ( dom C141 ) and L488: C157 in ( dom ( C141 . C156 ) ) and L489: C144 = ( ( Sum ( Card ( C141 | ( C156 -' 1 ) ) ) ) + C157 ) and L490: ( ( C141 . C156 ) . C157 ) = ( ( FlattenSeq C141 ) . C144 ) by L452 , PRE_POLY:29;
consider C158 being (Element of ( Bags R1 )), C159 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L491: C159 = ( C141 /. C156 ) and L492: ( ( divisors C139 ) /. C156 ) = C158 and L493: ( len C159 ) = ( len ( divisors C140 ) ) and L494: (for B147 being Nat holds (B147 in ( dom C159 ) implies (ex B148 being (Element of ( Bags R2 )) st (( ( divisors C140 ) /. B147 ) = B148 & ( C159 /. B147 ) = ( C158 +^ B148 ))))) by L439 , L440 , L487;
L495: ( ( divisors C139 ) . C156 ) = C158 by L439 , L487 , L492 , PARTFUN1:def 6;
L496: C159 = ( C141 . C156 ) by L487 , L491 , PARTFUN1:def 6;
L497: ( ( FlattenSeq C141 ) . C144 ) = ( C159 /. C157 ) by L496 , L488 , L490 , PARTFUN1:def 6;
L498: C157 in ( dom C159 ) by L487 , L488 , L491 , PARTFUN1:def 6;
consider C160 being (Element of ( Bags R2 )) such that L499: ( ( divisors C140 ) /. C157 ) = C160 and L500: ( C159 /. C157 ) = ( C158 +^ C160 ) by L498 , L494;
L501: ( Seg ( len C159 ) ) = ( dom C159 ) by FINSEQ_1:def 3;
L502: C157 in ( dom ( divisors C140 ) ) by L501 , L493 , L498 , FINSEQ_1:def 3;
L503: ( ( divisors C140 ) . C157 ) = C160 by L502 , L499 , PARTFUN1:def 6;
assume L504: ( D67 /. C144 ) = ( D67 /. C145 );
L505: (( D67 /. C144 ) = ( D67 . C144 ) & ( D67 /. C145 ) = ( D67 . C145 )) by L452 , L453 , PARTFUN1:def 6;
L506: C158 = C153 by L505 , L504 , L500 , L483 , L497 , L480 , L228;
L507: C156 = C151 by L506 , L439 , L487 , L470 , L495 , L478 , FUNCT_1:def 4;
L508: C160 = C155 by L504 , L505 , L500 , L483 , L497 , L480 , L228;
thus L509: contradiction by L508 , L454 , L489 , L472 , L507 , L502 , L503 , L485 , L486 , FUNCT_1:def 4;
end;
thus L510: ( D67 /. C144 ) <> ( D67 /. C145 ) by L469;
reconsider D68 = ( D67 /. C144 ) , D69 = ( D67 /. C145 ) as (bag of ( R1 +^ R2 ));
reconsider D70 = D68 , D71 = D69 as (Element of ( Bags ( R1 +^ R2 ) ));
consider C161 being (Element of ( Bags R1 )), C162 being (Element of ( Bags R2 )) such that L511: D70 = ( C161 +^ C162 ) by L173;
L512: C149 = ( C141 . C146 ) by L456 , L460 , PARTFUN1:def 6;
L513: D70 = ( C149 /. C147 ) by L512 , L455 , L457 , L459 , PARTFUN1:def 6;
L514: C148 = C161 by L513 , L511 , L466 , L228;
L515: ( ( divisors C139 ) . C146 ) = C161 by L514 , L439 , L456 , L461 , PARTFUN1:def 6;
L516: C150 = C162 by L511 , L466 , L513 , L228;
L517: ( ( divisors C140 ) . C147 ) = C162 by L516 , L465 , L468 , PARTFUN1:def 6;
L518: ( D67 /. C145 ) = ( D67 . C145 ) by L453 , PARTFUN1:def 6;
consider C163 being (Element of ( Bags R1 )), C164 being (Element of ( Bags R2 )) such that L519: D71 = ( C163 +^ C164 ) by L173;
consider C165 , C166 being (Element of ( NAT )) such that L520: C165 in ( dom C141 ) and L521: C166 in ( dom ( C141 . C165 ) ) and L522: C145 = ( ( Sum ( Card ( C141 | ( C165 -' 1 ) ) ) ) + C166 ) and L523: ( ( C141 . C165 ) . C166 ) = ( ( FlattenSeq C141 ) . C145 ) by L453 , PRE_POLY:29;
consider C167 being (Element of ( Bags R1 )), C168 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L524: C168 = ( C141 /. C165 ) and L525: ( ( divisors C139 ) /. C165 ) = C167 and L526: ( len C168 ) = ( len ( divisors C140 ) ) and L527: (for B149 being Nat holds (B149 in ( dom C168 ) implies (ex B150 being (Element of ( Bags R2 )) st (( ( divisors C140 ) /. B149 ) = B150 & ( C168 /. B149 ) = ( C167 +^ B150 ))))) by L439 , L440 , L520;
L528: C166 in ( dom C168 ) by L520 , L521 , L524 , PARTFUN1:def 6;
consider C169 being (Element of ( Bags R2 )) such that L529: ( ( divisors C140 ) /. C166 ) = C169 and L530: ( C168 /. C166 ) = ( C167 +^ C169 ) by L528 , L527;
L531: ( Seg ( len C168 ) ) = ( dom C168 ) by FINSEQ_1:def 3;
L532: C166 in ( dom ( divisors C140 ) ) by L531 , L526 , L528 , FINSEQ_1:def 3;
L533: C168 = ( C141 . C165 ) by L520 , L524 , PARTFUN1:def 6;
L534: D71 = ( C168 /. C166 ) by L533 , L518 , L521 , L523 , PARTFUN1:def 6;
L535: C167 = C163 by L534 , L519 , L530 , L228;
L536: ( ( divisors C139 ) . C165 ) = C163 by L535 , L439 , L520 , L525 , PARTFUN1:def 6;
L537: C169 = C164 by L519 , L530 , L534 , L228;
L538: ( ( divisors C140 ) . C166 ) = C164 by L537 , L529 , L532 , PARTFUN1:def 6;
L539:
now
L540:
now
assume that
L541: (not C146 < C165)
and
L542: (not (C146 = C165 & C147 < C166));
per cases  by L541 , XXREAL_0:1;
suppose L543: C146 = C165;

thus L544: contradiction by L543 , L454 , L458 , L522 , L542 , XREAL_1:6;
end;
suppose L545: C146 > C165;

L546: C165 >= 1 by L520 , FINSEQ_3:25;
L547: ( C165 -' 1 ) = ( C165 - 1 ) by L546 , XREAL_1:233;
reconsider D72 = ( C141 . C165 ) as (Element of ( ( Bags ( R1 +^ R2 ) ) * )) by L520 , L524 , PARTFUN1:def 6;
L548: (( Card ( C141 | C165 ) ) = ( ( Card C141 ) | C165 ) & ( Card ( C141 | ( C146 -' 1 ) ) ) = ( ( Card C141 ) | ( C146 -' 1 ) )) by POLYNOM3:16;
reconsider D73 = <* D72 *> as (FinSequence of ( ( Bags ( R1 +^ R2 ) ) * ));
L549: C165 < ( C165 + 1 ) by XREAL_1:29;
L550: ( C165 - 1 ) < C165 by L549 , XREAL_1:19;
L551: C165 >= 1 by L520 , FINSEQ_3:25;
L552: ( ( C165 -' 1 ) + 1 ) = C165 by L551 , XREAL_1:235;
L553: C165 <= ( len C141 ) by L520 , FINSEQ_3:25;
L554: ( C165 -' 1 ) < ( len C141 ) by L553 , L547 , L550 , XXREAL_0:2;
L555: ( C141 | C165 ) = ( ( C141 | ( C165 -' 1 ) ) ^ D73 ) by L554 , L552 , POLYNOM3:19;
L556: ( Card ( C141 | C165 ) ) = ( ( Card ( C141 | ( C165 -' 1 ) ) ) ^ ( Card D73 ) ) by L555 , PRE_POLY:25;
L557: ( Card ( C141 | C165 ) ) = ( ( Card ( C141 | ( C165 -' 1 ) ) ) ^ <* ( card D72 ) *> ) by L556 , PRE_POLY:24;
L558: ( Sum ( Card ( C141 | C165 ) ) ) = ( ( Sum ( Card ( C141 | ( C165 -' 1 ) ) ) ) + ( card ( C141 . C165 ) ) ) by L557 , RVSUM_1:74;
L559: C166 <= ( card ( C141 . C165 ) ) by L521 , FINSEQ_3:25;
L560: ( ( Sum ( Card ( C141 | ( C165 -' 1 ) ) ) ) + C166 ) <= ( Sum ( Card ( C141 | C165 ) ) ) by L559 , L558 , XREAL_1:6;
L561: C165 <= ( C146 -' 1 ) by L545 , NAT_D:49;
L562: ( Sum ( Card ( C141 | C165 ) ) ) <= ( Sum ( Card ( C141 | ( C146 -' 1 ) ) ) ) by L561 , L548 , POLYNOM3:18;
L563: ( ( Sum ( Card ( C141 | ( C165 -' 1 ) ) ) ) + C166 ) <= ( Sum ( Card ( C141 | ( C146 -' 1 ) ) ) ) by L562 , L560 , XXREAL_0:2;
L564: ( Sum ( Card ( C141 | ( C146 -' 1 ) ) ) ) <= ( ( Sum ( Card ( C141 | ( C146 -' 1 ) ) ) ) + C147 ) by NAT_1:11;
thus L565: contradiction by L564 , L454 , L458 , L522 , L563 , XXREAL_0:2;
end;
end;
consider C170 being non  empty  finite (Subset of ( Bags R1 )) such that L567: ( divisors C139 ) = ( SgmX (( BagOrder R1 ) , C170) ) and L568: (for B151 being (bag of R1) holds (B151 in C170 iff B151 divides C139)) by PRE_POLY:def 16;
L569: ( field ( BagOrder R1 ) ) = ( Bags R1 ) by ORDERS_1:15;
L570: ( BagOrder R1 ) linearly_orders C170 by L569 , ORDERS_1:37 , ORDERS_1:38;
consider C171 being non  empty  finite (Subset of ( Bags R2 )) such that L571: ( divisors C140 ) = ( SgmX (( BagOrder R2 ) , C171) ) and L572: (for B152 being (bag of R2) holds (B152 in C171 iff B152 divides C140)) by PRE_POLY:def 16;
L573: ( field ( BagOrder R2 ) ) = ( Bags R2 ) by ORDERS_1:15;
L574: ( BagOrder R2 ) linearly_orders C171 by L573 , ORDERS_1:37 , ORDERS_1:38;
per cases  by L540;
case L575: C146 < C165;
L576: [ ( ( divisors C139 ) /. C146 ) , ( ( divisors C139 ) /. C165 ) ] in ( BagOrder R1 ) by L575 , L439 , L456 , L520 , L567 , L570 , PRE_POLY:def 2;
L577: C161 <=' C163 by L576 , L461 , L525 , L514 , L535 , PRE_POLY:def 14;
L578: C161 <> C163 by L439 , L456 , L520 , L515 , L536 , L575 , FUNCT_1:def 4;
thus L579: C161 < C163 by L578 , L577 , PRE_POLY:def 10;
end;
case that L580: C146 = C165
and
L581: C147 < C166;
L582: [ ( ( divisors C140 ) /. C147 ) , ( ( divisors C140 ) /. C166 ) ] in ( BagOrder R2 ) by L468 , L532 , L571 , L574 , L581 , PRE_POLY:def 2;
L583: C162 <=' C164 by L582 , L465 , L529 , L516 , L537 , PRE_POLY:def 14;
thus L584: C161 = C163 by L519 , L461 , L525 , L530 , L534 , L514 , L580 , L228;
L585: C162 <> C164 by L468 , L517 , L532 , L538 , L581 , FUNCT_1:def 4;
thus L586: C162 < C164 by L585 , L583 , PRE_POLY:def 10;
end;
end;
L588: (D68 < D69 or D68 = D69) by L539 , L511 , L519 , L390;
L589: D68 <=' D69 by L588 , PRE_POLY:def 10;
thus L590: thesis by L589 , PRE_POLY:def 14;
end;
L591: C143 = ( C141 . 1 ) by L448 , L441 , PARTFUN1:def 6;
L592: ( C141 . 1 ) <> ( {} ) by L591 , L443;
reconsider D74 = ( rng ( FlattenSeq C141 ) ) as non  empty  finite (Subset of ( Bags ( R1 +^ R2 ) )) by L592 , L450 , FINSEQ_1:def 4 , RELAT_1:41;
L593: (for B153 being (bag of ( R1 +^ R2 )) holds (B153 in D74 iff B153 divides ( C139 +^ C140 )))
proof
consider C172 being non  empty  finite (Subset of ( Bags R2 )) such that L594: ( divisors C140 ) = ( SgmX (( BagOrder R2 ) , C172) ) and L595: (for B154 being (bag of R2) holds (B154 in C172 iff B154 divides C140)) by PRE_POLY:def 16;
L596: ( field ( BagOrder R2 ) ) = ( Bags R2 ) by ORDERS_1:15;
L597: ( BagOrder R2 ) linearly_orders C172 by L596 , ORDERS_1:37 , ORDERS_1:38;
L598: ( rng ( SgmX (( BagOrder R2 ) , C172) ) ) = C172 by L597 , PRE_POLY:def 2;
let C173 being (bag of ( R1 +^ R2 ));
consider C174 being non  empty  finite (Subset of ( Bags R1 )) such that L599: ( divisors C139 ) = ( SgmX (( BagOrder R1 ) , C174) ) and L600: (for B155 being (bag of R1) holds (B155 in C174 iff B155 divides C139)) by PRE_POLY:def 16;
L601: ( field ( BagOrder R1 ) ) = ( Bags R1 ) by ORDERS_1:15;
L602: ( BagOrder R1 ) linearly_orders C174 by L601 , ORDERS_1:37 , ORDERS_1:38;
L603: ( rng ( SgmX (( BagOrder R1 ) , C174) ) ) = C174 by L602 , PRE_POLY:def 2;
thus L604: (C173 in D74 implies C173 divides ( C139 +^ C140 ))
proof
assume L605: C173 in D74;
consider C175 being set such that L606: C175 in ( dom ( FlattenSeq C141 ) ) and L607: C173 = ( ( FlattenSeq C141 ) . C175 ) by L605 , FUNCT_1:def 3;
consider C176 , C177 being (Element of ( NAT )) such that L608: C176 in ( dom C141 ) and L609: C177 in ( dom ( C141 . C176 ) ) and L610: C175 = ( ( Sum ( Card ( C141 | ( C176 -' 1 ) ) ) ) + C177 ) and L611: ( ( C141 . C176 ) . C177 ) = ( ( FlattenSeq C141 ) . C175 ) by L606 , PRE_POLY:29;
consider C178 being (Element of ( Bags R1 )), C179 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L612: C179 = ( C141 /. C176 ) and L613: ( ( divisors C139 ) /. C176 ) = C178 and L614: ( len C179 ) = ( len ( divisors C140 ) ) and L615: (for B156 being Nat holds (B156 in ( dom C179 ) implies (ex B157 being (Element of ( Bags R2 )) st (( ( divisors C140 ) /. B156 ) = B157 & ( C179 /. B156 ) = ( C178 +^ B157 ))))) by L439 , L440 , L608;
reconsider D75 = C178 as (bag of R1);
L616: ( ( divisors C139 ) . C176 ) = C178 by L439 , L608 , L613 , PARTFUN1:def 6;
L617: C178 in C174 by L616 , L439 , L599 , L603 , L608 , FUNCT_1:3;
L618: D75 divides C139 by L617 , L600;
L619: C179 = ( C141 . C176 ) by L608 , L612 , PARTFUN1:def 6;
consider C180 being (Element of ( Bags R2 )) such that L620: ( ( divisors C140 ) /. C177 ) = C180 and L621: ( C179 /. C177 ) = ( C178 +^ C180 ) by L619 , L609 , L615;
reconsider D76 = C180 as (bag of R2);
L622: C177 in ( Seg ( len C179 ) ) by L609 , L619 , FINSEQ_1:def 3;
L623: C177 in ( dom ( divisors C140 ) ) by L622 , L614 , FINSEQ_1:def 3;
L624: ( ( divisors C140 ) . C177 ) = C180 by L623 , L620 , PARTFUN1:def 6;
L625: C180 in C172 by L624 , L594 , L598 , L623 , FUNCT_1:3;
L626: D76 divides C140 by L625 , L595;
L627: C173 = ( C178 +^ C180 ) by L607 , L609 , L611 , L619 , L621 , PARTFUN1:def 6;
thus L628: thesis by L627 , L618 , L626 , L358;
end;

thus L629: (C173 divides ( C139 +^ C140 ) implies C173 in D74)
proof
assume L630: C173 divides ( C139 +^ C140 );
consider C181 being (Element of ( Bags R1 )), C182 being (Element of ( Bags R2 )) such that L631: C181 divides C139 and L632: C182 divides C140 and L633: C173 = ( C181 +^ C182 ) by L630 , L372;
L634: C181 in C174 by L600 , L631;
consider C183 being set such that L635: C183 in ( dom ( divisors C139 ) ) and L636: C181 = ( ( divisors C139 ) . C183 ) by L634 , L599 , L603 , FUNCT_1:def 3;
reconsider D77 = C183 as (Element of ( NAT )) by L635;
consider C184 being (Element of ( Bags R1 )), C185 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L637: C185 = ( C141 /. D77 ) and L638: ( ( divisors C139 ) /. D77 ) = C184 and L639: ( len C185 ) = ( len ( divisors C140 ) ) and L640: (for B158 being Nat holds (B158 in ( dom C185 ) implies (ex B159 being (Element of ( Bags R2 )) st (( ( divisors C140 ) /. B158 ) = B159 & ( C185 /. B158 ) = ( C184 +^ B159 ))))) by L440 , L635;
L641: C184 = C181 by L635 , L636 , L638 , PARTFUN1:def 6;
L642: C182 in ( rng ( divisors C140 ) ) by L594 , L595 , L598 , L632;
consider C186 being set such that L643: C186 in ( dom ( divisors C140 ) ) and L644: C182 = ( ( divisors C140 ) . C186 ) by L642 , FUNCT_1:def 3;
L645: C186 in ( Seg ( len ( divisors C140 ) ) ) by L643 , FINSEQ_1:def 3;
L646: ( Seg ( len ( C141 . D77 ) ) ) = ( Seg ( len ( divisors C140 ) ) ) by L439 , L635 , L637 , L639 , PARTFUN1:def 6;
L647: C186 in ( dom ( C141 . D77 ) ) by L646 , L645 , FINSEQ_1:def 3;
reconsider D78 = C186 as (Element of ( NAT )) by L643;
L648: ( C141 /. D77 ) = ( C141 . D77 ) by L439 , L635 , PARTFUN1:def 6;
consider C187 being (Element of ( Bags R2 )) such that L649: ( ( divisors C140 ) /. D78 ) = C187 and L650: ( C185 /. D78 ) = ( C184 +^ C187 ) by L648 , L637 , L640 , L647;
L651: C187 = C182 by L643 , L644 , L649 , PARTFUN1:def 6;
L652: (( ( Sum ( Card ( C141 | ( D77 -' 1 ) ) ) ) + D78 ) in ( dom ( FlattenSeq C141 ) ) & ( ( C141 . D77 ) . D78 ) = ( ( FlattenSeq C141 ) . ( ( Sum ( Card ( C141 | ( D77 -' 1 ) ) ) ) + D78 ) )) by L439 , L635 , L647 , PRE_POLY:30;
L653: ( ( C141 . D77 ) . D78 ) = ( C184 +^ C187 ) by L637 , L647 , L648 , L650 , PARTFUN1:def 6;
thus L654: thesis by L653 , L633 , L652 , L641 , L651 , FUNCT_1:def 3;
end;

end;
L630: ( field ( BagOrder ( R1 +^ R2 ) ) ) = ( Bags ( R1 +^ R2 ) ) by ORDERS_1:15;
L631: ( BagOrder ( R1 +^ R2 ) ) linearly_orders D74 by L630 , ORDERS_1:37 , ORDERS_1:38;
L632: ( FlattenSeq C141 ) = ( SgmX (( BagOrder ( R1 +^ R2 ) ) , D74) ) by L631 , L451 , PRE_POLY:def 2;
thus L633: thesis by L632 , L593 , PRE_POLY:def 16;
end;
theorem
L634: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B160 , B161 , B162 being (Element of ( Bags R1 )) holds (for B163 , B164 , B165 being (Element of ( Bags R2 )) holds ((B162 = ( B161 -' B160 ) & B165 = ( B164 -' B163 )) implies ( ( B161 +^ B164 ) -' ( B160 +^ B163 ) ) = ( B162 +^ B165 ))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C188 , C189 , C190 being (Element of ( Bags R1 ));
let C191 , C192 , C193 being (Element of ( Bags R2 ));
assume that
L635: C190 = ( C189 -' C188 )
and
L636: C193 = ( C192 -' C191 );
reconsider D79 = ( ( C189 +^ C192 ) -' ( C188 +^ C191 ) ) as (Element of ( Bags ( R1 +^ R2 ) )) by PRE_POLY:def 12;
L637: (for B166 being Ordinal holds ((B166 in R1 implies ( D79 . B166 ) = ( C190 . B166 )) & (B166 in ( ( R1 +^ R2 ) \ R1 ) implies ( D79 . B166 ) = ( C193 . ( B166 -^ R1 ) ))))
proof
let C194 being Ordinal;
thus L638:now
assume L639: C194 in R1;
thus L640: ( D79 . C194 ) = ( ( ( C189 +^ C192 ) . C194 ) -' ( ( C188 +^ C191 ) . C194 ) ) by PRE_POLY:def 6
.= ( ( C189 . C194 ) -' ( ( C188 +^ C191 ) . C194 ) ) by L639 , L51
.= ( ( C189 . C194 ) -' ( C188 . C194 ) ) by L639 , L51
.= ( C190 . C194 ) by L635 , PRE_POLY:def 6;
end;
assume L641: C194 in ( ( R1 +^ R2 ) \ R1 );
thus L642: ( D79 . C194 ) = ( ( ( C189 +^ C192 ) . C194 ) -' ( ( C188 +^ C191 ) . C194 ) ) by PRE_POLY:def 6
.= ( ( C192 . ( C194 -^ R1 ) ) -' ( ( C188 +^ C191 ) . C194 ) ) by L641 , L51
.= ( ( C192 . ( C194 -^ R1 ) ) -' ( C191 . ( C194 -^ R1 ) ) ) by L641 , L51
.= ( C193 . ( C194 -^ R1 ) ) by L636 , PRE_POLY:def 6;
end;
thus L643: thesis by L637 , L51;
end;
theorem
L644: (for R1 being Ordinal holds (for R2 being Ordinal holds (for B167 being (Element of ( Bags R1 )) holds (for B168 being (Element of ( Bags R2 )) holds (for B169 being (FinSequence of ( ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) ) * )) holds ((( dom B169 ) = ( dom ( decomp B167 ) ) & (for B170 being Nat holds (B170 in ( dom ( decomp B167 ) ) implies (ex B171 , B172 being (Element of ( Bags R1 )) st (ex B173 being (FinSequence of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) st (B173 = ( B169 /. B170 ) & ( ( decomp B167 ) /. B170 ) = <* B171 , B172 *> & ( len B173 ) = ( len ( decomp B168 ) ) & (for B174 being Nat holds (B174 in ( dom B173 ) implies (ex B175 , B176 being (Element of ( Bags R2 )) st (( ( decomp B168 ) /. B174 ) = <* B175 , B176 *> & ( B173 /. B174 ) = <* ( B171 +^ B175 ) , ( B172 +^ B176 ) *>)))))))))) implies ( decomp ( B167 +^ B168 ) ) = ( FlattenSeq B169 )))))))
proof
let R1 being Ordinal;
let R2 being Ordinal;
let C195 being (Element of ( Bags R1 ));
let C196 being (Element of ( Bags R2 ));
let C197 being (FinSequence of ( ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) ) * ));
assume that
L645: ( dom C197 ) = ( dom ( decomp C195 ) )
and
L646: (for B177 being Nat holds (B177 in ( dom ( decomp C195 ) ) implies (ex B178 , B179 being (Element of ( Bags R1 )) st (ex B180 being (FinSequence of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) st (B180 = ( C197 /. B177 ) & ( ( decomp C195 ) /. B177 ) = <* B178 , B179 *> & ( len B180 ) = ( len ( decomp C196 ) ) & (for B181 being Nat holds (B181 in ( dom B180 ) implies (ex B182 , B183 being (Element of ( Bags R2 )) st (( ( decomp C196 ) /. B181 ) = <* B182 , B183 *> & ( B180 /. B181 ) = <* ( B178 +^ B182 ) , ( B179 +^ B183 ) *>)))))))));
defpred S4[ set , Function ] means (( dom $2 ) = ( dom ( C197 . $1 ) ) & (for B184 being Nat holds (B184 in ( dom $2 ) implies (ex B185 being (Element of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) st (B185 = ( ( C197 . $1 ) . B184 ) & ( $2 . B184 ) = ( B185 . 1 ))))));
L647: (for B186 being (Element of ( NAT )) holds (B186 in ( Seg ( len C197 ) ) implies (ex B187 being (Element of ( ( Bags ( R1 +^ R2 ) ) * )) st S4[ B186 , B187 ])))
proof
let C198 being (Element of ( NAT ));
assume that
L648: C198 in ( Seg ( len C197 ) );
defpred S5[ set , set ] means (ex B188 being (Element of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) st (B188 = ( ( C197 . C198 ) . $1 ) & $2 = ( B188 . 1 )));
L649: (for B189 being (Element of ( NAT )) holds (B189 in ( Seg ( len ( C197 . C198 ) ) ) implies (ex B190 being (Element of ( Bags ( R1 +^ R2 ) )) st S5[ B189 , B190 ])))
proof
L650: C198 in ( dom C197 ) by L648 , FINSEQ_1:def 3;
L651: ( C197 . C198 ) in ( rng C197 ) by L650 , FUNCT_1:3;
L652: ( rng C197 ) c= ( ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) ) * ) by FINSEQ_1:def 4;
L653: ( C197 . C198 ) is (Element of ( ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) ) * )) by L652 , L651;
reconsider D80 = ( C197 . C198 ) as (FinSequence of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) by L653;
let C199 being (Element of ( NAT ));
assume L654: C199 in ( Seg ( len ( C197 . C198 ) ) );
L655: C199 in ( dom ( C197 . C198 ) ) by L654 , FINSEQ_1:def 3;
L656: ( ( C197 . C198 ) . C199 ) = ( D80 /. C199 ) by L655 , PARTFUN1:def 6;
reconsider D81 = ( ( C197 . C198 ) . C199 ) as (Element of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) by L656;
L657: (ex B191 , B192 being (Element of ( Bags ( R1 +^ R2 ) )) st D81 = <* B191 , B192 *>) by FINSEQ_2:100;
reconsider D82 = ( D81 . 1 ) as (Element of ( Bags ( R1 +^ R2 ) )) by L657 , FINSEQ_1:44;
take D82;
thus L658: thesis;
end;
consider C200 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L659: ( dom C200 ) = ( Seg ( len ( C197 . C198 ) ) ) and L660: (for B193 being (Element of ( NAT )) holds (B193 in ( Seg ( len ( C197 . C198 ) ) ) implies S5[ B193 , ( C200 /. B193 ) ])) from RECDEF_1:sch 17(L649);
reconsider D83 = C200 as (Element of ( ( Bags ( R1 +^ R2 ) ) * )) by FINSEQ_1:def 11;
take D83;
thus L661: ( dom D83 ) = ( dom ( C197 . C198 ) ) by L659 , FINSEQ_1:def 3;
let C201 being Nat;
assume L662: C201 in ( dom D83 );
consider C202 being (Element of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) such that L663: C202 = ( ( C197 . C198 ) . C201 ) and L664: ( D83 /. C201 ) = ( C202 . 1 ) by L662 , L659 , L660;
take C202;
thus L665: C202 = ( ( C197 . C198 ) . C201 ) by L663;
thus L666: thesis by L662 , L664 , PARTFUN1:def 6;
end;
consider C203 being (FinSequence of ( ( Bags ( R1 +^ R2 ) ) * )) such that L667: ( dom C203 ) = ( Seg ( len C197 ) ) and L668: (for B194 being (Element of ( NAT )) holds (B194 in ( Seg ( len C197 ) ) implies S4[ B194 , ( C203 /. B194 ) ])) from RECDEF_1:sch 17(L647);
L669: ( dom ( Card C203 ) ) = ( dom C203 ) by CARD_3:def 2
.= ( dom C197 ) by L667 , FINSEQ_1:def 3
.= ( dom ( Card C197 ) ) by CARD_3:def 2;
L670: ( dom ( divisors C195 ) ) = ( dom ( decomp C195 ) ) by PRE_POLY:def 17;
L671: (for B195 being Nat holds (B195 in ( dom ( divisors C195 ) ) implies (ex B196 being (Element of ( Bags R1 )) st (ex B197 being (FinSequence of ( Bags ( R1 +^ R2 ) )) st (B197 = ( C203 /. B195 ) & ( ( divisors C195 ) /. B195 ) = B196 & ( len B197 ) = ( len ( divisors C196 ) ) & (for B198 being Nat holds (B198 in ( dom B197 ) implies (ex B199 being (Element of ( Bags R2 )) st (( ( divisors C196 ) /. B198 ) = B199 & ( B197 /. B198 ) = ( B196 +^ B199 ))))))))))
proof
let C204 being Nat;
reconsider D84 = ( C203 /. C204 ) as (FinSequence of ( Bags ( R1 +^ R2 ) ));
L672: ( dom ( decomp C196 ) ) = ( dom ( divisors C196 ) ) by PRE_POLY:def 17;
assume L673: C204 in ( dom ( divisors C195 ) );
consider C205 , C206 being (Element of ( Bags R1 )), C207 being (FinSequence of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) such that L674: C207 = ( C197 /. C204 ) and L675: ( ( decomp C195 ) /. C204 ) = <* C205 , C206 *> and L676: ( len C207 ) = ( len ( decomp C196 ) ) and L677: (for B200 being Nat holds (B200 in ( dom C207 ) implies (ex B201 , B202 being (Element of ( Bags R2 )) st (( ( decomp C196 ) /. B200 ) = <* B201 , B202 *> & ( C207 /. B200 ) = <* ( C205 +^ B201 ) , ( C206 +^ B202 ) *>)))) by L673 , L646 , L670;
take C205;
take D84;
thus L678: D84 = ( C203 /. C204 );
thus L679: ( ( divisors C195 ) /. C204 ) = C205 by L670 , L673 , L675 , PRE_POLY:70;
L680: C204 in ( Seg ( len C197 ) ) by L645 , L670 , L673 , FINSEQ_1:def 3;
L681: ( dom ( C203 /. C204 ) ) = ( dom ( C197 . C204 ) ) by L680 , L668;
thus L682: ( len D84 ) = ( len ( C197 . C204 ) ) by L681 , FINSEQ_3:29
.= ( len ( decomp C196 ) ) by L645 , L670 , L673 , L674 , L676 , PARTFUN1:def 6
.= ( len ( divisors C196 ) ) by L672 , FINSEQ_3:29;
let C208 being Nat;
assume L683: C208 in ( dom D84 );
consider C209 being (Element of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) such that L684: C209 = ( ( C197 . C204 ) . C208 ) and L685: ( ( C203 /. C204 ) . C208 ) = ( C209 . 1 ) by L683 , L668 , L680;
L686: ( C197 . C204 ) = ( C197 /. C204 ) by L645 , L670 , L673 , PARTFUN1:def 6;
consider C210 , C211 being (Element of ( Bags R2 )) such that L687: ( ( decomp C196 ) /. C208 ) = <* C210 , C211 *> and L688: ( C207 /. C208 ) = <* ( C205 +^ C210 ) , ( C206 +^ C211 ) *> by L686 , L674 , L677 , L681 , L683;
L689: C209 = <* ( C205 +^ C210 ) , ( C206 +^ C211 ) *> by L674 , L681 , L686 , L683 , L688 , L684 , PARTFUN1:def 6;
take C210;
L690: C208 in ( dom ( decomp C196 ) ) by L674 , L676 , L681 , L686 , L683 , FINSEQ_3:29;
thus L691: ( ( divisors C196 ) /. C208 ) = C210 by L690 , L687 , PRE_POLY:70;
thus L692: ( D84 /. C208 ) = ( D84 . C208 ) by L683 , PARTFUN1:def 6
.= ( C205 +^ C210 ) by L685 , L689 , FINSEQ_1:44;
end;
L693: ( dom ( decomp C196 ) ) = ( dom ( divisors C196 ) ) by PRE_POLY:def 17;
L694: ( len ( decomp C196 ) ) = ( len ( divisors C196 ) ) by L693 , FINSEQ_3:29;
L695: (for B203 being Nat holds (B203 in ( dom ( Card C203 ) ) implies ( ( Card C203 ) . B203 ) = ( ( Card C197 ) . B203 )))
proof
let C212 being Nat;
assume L696: C212 in ( dom ( Card C203 ) );
L697: C212 in ( dom C197 ) by L696 , L669 , CARD_3:def 2;
L698: ( dom ( Card C203 ) ) = ( dom C203 ) by CARD_3:def 2;
L699: ( ( Card C203 ) . C212 ) = ( card ( C203 . C212 ) ) by L698 , L696 , CARD_3:def 2;
L700: C212 in ( dom ( decomp C195 ) ) by L645 , L667 , L696 , L698 , FINSEQ_1:def 3;
L701: ((ex B204 being (Element of ( Bags R1 )) st (ex B205 being (FinSequence of ( Bags ( R1 +^ R2 ) )) st (B205 = ( C203 /. C212 ) & ( ( divisors C195 ) /. C212 ) = B204 & ( len B205 ) = ( len ( divisors C196 ) ) & (for B206 being Nat holds (B206 in ( dom B205 ) implies (ex B207 being (Element of ( Bags R2 )) st (( ( divisors C196 ) /. B206 ) = B207 & ( B205 /. B206 ) = ( B204 +^ B207 )))))))) & (ex B208 , B209 being (Element of ( Bags R1 )) st (ex B210 being (FinSequence of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) st (B210 = ( C197 /. C212 ) & ( ( decomp C195 ) /. C212 ) = <* B208 , B209 *> & ( len B210 ) = ( len ( decomp C196 ) ) & (for B211 being Nat holds (B211 in ( dom B210 ) implies (ex B212 , B213 being (Element of ( Bags R2 )) st (( ( decomp C196 ) /. B211 ) = <* B212 , B213 *> & ( B210 /. B211 ) = <* ( B208 +^ B212 ) , ( B209 +^ B213 ) *>)))))))) by L700 , L646 , L670 , L671;
L702: ( card ( C203 . C212 ) ) = ( card ( C203 /. C212 ) ) by L696 , L698 , PARTFUN1:def 6
.= ( card ( C197 . C212 ) ) by L694 , L697 , L701 , PARTFUN1:def 6;
thus L703: thesis by L702 , L697 , L699 , CARD_3:def 2;
end;
reconsider D85 = ( C195 +^ C196 ) as (bag of ( R1 +^ R2 ));
reconsider D86 = ( FlattenSeq C197 ) as (FinSequence of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) ));
L704: ( len ( Card C203 ) ) = ( len ( Card C197 ) ) by L669 , FINSEQ_3:29;
L705: ( Card C203 ) = ( Card C197 ) by L704 , L695 , FINSEQ_2:9;
L706: ( len D86 ) = ( len ( FlattenSeq C203 ) ) by L705 , PRE_POLY:28;
L707: ( dom ( decomp C195 ) ) = ( dom ( divisors C195 ) ) by PRE_POLY:def 17;
L708: ( dom C203 ) = ( dom ( divisors C195 ) ) by L707 , L645 , L667 , FINSEQ_1:def 3;
L709: ( divisors ( C195 +^ C196 ) ) = ( FlattenSeq C203 ) by L708 , L671 , L438;
L710: ( dom ( decomp C195 ) ) = ( dom ( divisors C195 ) ) by PRE_POLY:def 17;
L711: (for B214 being (Element of ( NAT )) holds (for B215 being (bag of ( R1 +^ R2 )) holds ((B214 in ( dom D86 ) & B215 = ( ( divisors D85 ) /. B214 )) implies ( D86 /. B214 ) = <* B215 , ( D85 -' B215 ) *>)))
proof
let C213 being (Element of ( NAT ));
let C214 being (bag of ( R1 +^ R2 ));
assume that
L712: C213 in ( dom D86 )
and
L713: C214 = ( ( divisors D85 ) /. C213 );
consider C215 , C216 being (Element of ( NAT )) such that L714: C215 in ( dom C197 ) and L715: C216 in ( dom ( C197 . C215 ) ) and L716: C213 = ( ( Sum ( Card ( C197 | ( C215 -' 1 ) ) ) ) + C216 ) and L717: ( ( C197 . C215 ) . C216 ) = ( D86 . C213 ) by L712 , PRE_POLY:29;
consider C217 being (Element of ( Bags R1 )), C218 being (FinSequence of ( Bags ( R1 +^ R2 ) )) such that L718: C218 = ( C203 /. C215 ) and L719: ( ( divisors C195 ) /. C215 ) = C217 and L720: ( len C218 ) = ( len ( divisors C196 ) ) and L721: (for B216 being Nat holds (B216 in ( dom C218 ) implies (ex B217 being (Element of ( Bags R2 )) st (( ( divisors C196 ) /. B216 ) = B217 & ( C218 /. B216 ) = ( C217 +^ B217 ))))) by L645 , L671 , L710 , L714;
consider C219 , C220 being (Element of ( Bags R1 )), C221 being (FinSequence of ( 2 -tuples_on ( Bags ( R1 +^ R2 ) ) )) such that L722: C221 = ( C197 /. C215 ) and L723: ( ( decomp C195 ) /. C215 ) = <* C219 , C220 *> and L724: ( len C221 ) = ( len ( decomp C196 ) ) and L725: (for B218 being Nat holds (B218 in ( dom C221 ) implies (ex B219 , B220 being (Element of ( Bags R2 )) st (( ( decomp C196 ) /. B218 ) = <* B219 , B220 *> & ( C221 /. B218 ) = <* ( C219 +^ B219 ) , ( C220 +^ B220 ) *>)))) by L645 , L646 , L714;
L726: C219 = C217 by L645 , L714 , L723 , L719 , PRE_POLY:70;
L727: <* C219 , C220 *> = <* C219 , ( C195 -' C219 ) *> by L726 , L645 , L714 , L723 , L719 , PRE_POLY:def 17;
L728: C216 in ( dom C221 ) by L714 , L715 , L722 , PARTFUN1:def 6;
consider C222 , C223 being (Element of ( Bags R2 )) such that L729: ( ( decomp C196 ) /. C216 ) = <* C222 , C223 *> and L730: ( C221 /. C216 ) = <* ( C219 +^ C222 ) , ( C220 +^ C223 ) *> by L728 , L725;
reconsider D87 = ( C196 -' C222 ) as (Element of ( Bags R2 )) by PRE_POLY:def 12;
reconsider D88 = ( C195 -' C219 ) as (Element of ( Bags R1 )) by PRE_POLY:def 12;
L731: C213 in ( dom ( FlattenSeq C203 ) ) by L706 , L712 , FINSEQ_3:29;
consider C224 , C225 being (Element of ( NAT )) such that L732: C224 in ( dom C203 ) and L733: C225 in ( dom ( C203 . C224 ) ) and L734: C213 = ( ( Sum ( Card ( C203 | ( C224 -' 1 ) ) ) ) + C225 ) and L735: ( ( C203 . C224 ) . C225 ) = ( ( FlattenSeq C203 ) . C213 ) by L731 , PRE_POLY:29;
L736: (( Card ( C197 | ( C215 -' 1 ) ) ) = ( ( Card C197 ) | ( C215 -' 1 ) ) & ( Card ( C203 | ( C224 -' 1 ) ) ) = ( ( Card C203 ) | ( C224 -' 1 ) )) by POLYNOM3:16;
L737: C215 = C224 by L736 , L705 , L714 , L715 , L716 , L732 , L733 , L734 , POLYNOM3:22;
L738: C216 = C225 by L705 , L714 , L715 , L716 , L732 , L733 , L734 , L736 , POLYNOM3:22;
L739: C216 in ( dom C218 ) by L738 , L732 , L733 , L737 , L718 , PARTFUN1:def 6;
consider C226 being (Element of ( Bags R2 )) such that L740: ( ( divisors C196 ) /. C216 ) = C226 and L741: ( C218 /. C216 ) = ( C217 +^ C226 ) by L739 , L721;
L742: C216 in ( dom ( decomp C196 ) ) by L724 , L728 , FINSEQ_3:29;
L743: C222 = C226 by L742 , L729 , L740 , PRE_POLY:70;
L744: <* C222 , C223 *> = <* C222 , ( C196 -' C222 ) *> by L743 , L729 , L740 , L742 , PRE_POLY:def 17;
L745: C213 in ( dom ( FlattenSeq C203 ) ) by L706 , L712 , FINSEQ_3:29;
L746: C214 = ( ( C203 . C215 ) . C216 ) by L745 , L709 , L713 , L735 , L737 , L738 , PARTFUN1:def 6
.= ( C218 . C216 ) by L732 , L737 , L718 , PARTFUN1:def 6
.= ( C219 +^ C222 ) by L739 , L741 , L726 , L743 , PARTFUN1:def 6;
L747: ( D85 -' C214 ) = ( D88 +^ D87 ) by L746 , L634
.= ( C220 +^ D87 ) by L727 , FINSEQ_1:77
.= ( C220 +^ C223 ) by L744 , FINSEQ_1:77;
thus L748: ( D86 /. C213 ) = ( ( C197 . C215 ) . C216 ) by L712 , L717 , PARTFUN1:def 6
.= ( C221 . C216 ) by L714 , L722 , PARTFUN1:def 6
.= <* C214 , ( D85 -' C214 ) *> by L728 , L730 , L746 , L747 , PARTFUN1:def 6;
end;
L749: ( dom D86 ) = ( dom ( divisors D85 ) ) by L709 , L706 , FINSEQ_3:29;
thus L750: thesis by L749 , L711 , PRE_POLY:def 17;
end;
theorem
L751: (for B221 , B222 being non  empty Ordinal holds (for B223 being  Abelian  right_zeroed  add-associative  right_complementable  well-unital  distributive  associative  well-unital non  trivial doubleLoopStr holds ( Polynom-Ring (B221 , ( Polynom-Ring (B222 , B223) )) ) , ( Polynom-Ring (( B221 +^ B222 ) , B223) ) are_isomorphic ))
proof
let C227 , C228 being non  empty Ordinal;
let C229 being  Abelian  right_zeroed  add-associative  right_complementable  well-unital  distributive  associative  well-unital non  trivial non  empty doubleLoopStr;
set D89 = ( Polynom-Ring (( C227 +^ C228 ) , C229) );
set D90 = ( Polynom-Ring (C227 , ( Polynom-Ring (C228 , C229) )) );
defpred S6[ set , set ] means (for B224 being (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) holds ($1 = B224 implies $2 = ( Compress B224 )));
reconsider D91 = ( 1_ D90 ) as (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) by POLYNOM1:def 10;
reconsider D92 = ( 1_ D89 ) as (Polynomial of ( C227 +^ C228 ) , C229) by POLYNOM1:def 10;
L752: (for B225 being (Element of D90) holds (ex B226 being (Element of D89) st S6[ B225 , B226 ]))
proof
let C230 being (Element of D90);
reconsider D93 = C230 as (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) by POLYNOM1:def 10;
reconsider D94 = ( Compress D93 ) as (Element of D89) by POLYNOM1:def 10;
take D94;
let C231 being (Polynomial of C227 , ( Polynom-Ring (C228 , C229) ));
assume L753: C230 = C231;
thus L754: thesis by L753;
end;
consider C232 being (Function of (the carrier of D90) , (the carrier of D89)) such that L755: (for B227 being (Element of D90) holds S6[ B227 , ( C232 . B227 ) ]) from FUNCT_2:sch 3(L752);
reconsider D95 = C232 as (Function of D90 , D89);
take D95;
thus L756: D95 is  additive
proof
let C233 , C234 being (Element of D90);
reconsider D96 = C233 , D97 = C234 as (Element of D90);
reconsider D98 = D96 , D99 = D97 as (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) by POLYNOM1:def 10;
reconsider D100 = ( D95 . C233 ) , D101 = ( D95 . C234 ) , D102 = ( D95 . ( C233 + C234 ) ) as (Element of D89);
reconsider D103 = D100 , D104 = D101 , D105 = D102 as (Polynomial of ( C227 +^ C228 ) , C229) by POLYNOM1:def 10;
L757: (for B228 being (bag of ( C227 +^ C228 )) holds ( D105 . B228 ) = ( ( D103 . B228 ) + ( D104 . B228 ) ))
proof
let C235 being (bag of ( C227 +^ C228 ));
reconsider D106 = C235 as (Element of ( Bags ( C227 +^ C228 ) )) by PRE_POLY:def 12;
consider C236 being (Element of ( Bags C227 )), C237 being (Element of ( Bags C228 )), C238 being (Polynomial of C228 , C229) such that L758: C238 = ( D98 . C236 ) and L759: D106 = ( C236 +^ C237 ) and L760: ( ( Compress D98 ) . D106 ) = ( C238 . C237 ) by L282;
consider C239 being (Element of ( Bags C227 )), C240 being (Element of ( Bags C228 )), C241 being (Polynomial of C228 , C229) such that L761: C241 = ( D99 . C239 ) and L762: D106 = ( C239 +^ C240 ) and L763: ( ( Compress D99 ) . D106 ) = ( C241 . C240 ) by L282;
consider C242 being (Element of ( Bags C227 )), C243 being (Element of ( Bags C228 )), C244 being (Polynomial of C228 , C229) such that L764: C244 = ( ( D98 + D99 ) . C242 ) and L765: D106 = ( C242 +^ C243 ) and L766: ( ( Compress ( D98 + D99 ) ) . D106 ) = ( C244 . C243 ) by L282;
L767: C239 = C242 by L762 , L765 , L228;
reconsider D107 = C236 as (bag of C227);
L768: ( ( D98 + D99 ) . D107 ) = ( ( D98 . D107 ) + ( D99 . D107 ) ) by POLYNOM1:15;
L769: D107 = C239 by L759 , L762 , L228;
L770: C244 = ( C238 + C241 ) by L769 , L758 , L761 , L764 , L767 , L768 , POLYNOM1:def 10;
L771: ( C244 . C237 ) = ( ( C238 . C237 ) + ( C241 . C237 ) ) by L770 , POLYNOM1:15;
L772: C240 = C243 by L762 , L765 , L228;
L773: C237 = C240 by L759 , L762 , L228;
L774: ( C233 + C234 ) = ( D98 + D99 ) by POLYNOM1:def 10;
thus L775: ( D105 . C235 ) = ( ( Compress ( D98 + D99 ) ) . D106 ) by L774 , L755
.= ( ( ( Compress D98 ) . D106 ) + ( D104 . C235 ) ) by L755 , L760 , L763 , L766 , L773 , L772 , L771
.= ( ( D103 . C235 ) + ( D104 . C235 ) ) by L755;
end;
thus L776: ( D95 . ( C233 + C234 ) ) = ( D103 + D104 ) by L757 , POLYNOM1:16
.= ( ( D95 . C233 ) + ( D95 . C234 ) ) by POLYNOM1:def 10;
end;

L777:
now
let C245 , C246 being (Element of D90);
reconsider D108 = C245 , D109 = C246 as (Element of D90);
reconsider D110 = D108 , D111 = D109 as (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) by POLYNOM1:def 10;
reconsider D112 = ( D95 . C245 ) , D113 = ( D95 . C246 ) as (Element of D89);
reconsider D114 = D112 , D115 = D113 as (Polynomial of ( C227 +^ C228 ) , C229) by POLYNOM1:def 10;
L778: ( D95 . ( C245 * C246 ) ) = ( D95 . ( D110 *' D111 ) ) by POLYNOM1:def 10;
reconsider D116 = ( D95 . ( D110 *' D111 ) ) as (Polynomial of ( C227 +^ C228 ) , C229) by L778 , POLYNOM1:def 10;
L779: (for B229 being (bag of ( C227 +^ C228 )) holds (ex B230 being (FinSequence of (the carrier of C229)) st (( D116 . B229 ) = ( Sum B230 ) & ( len B230 ) = ( len ( decomp B229 ) ) & (for B231 being (Element of ( NAT )) holds (B231 in ( dom B230 ) implies (ex B232 , B233 being (bag of ( C227 +^ C228 )) st (( ( decomp B229 ) /. B231 ) = <* B232 , B233 *> & ( B230 /. B231 ) = ( ( D114 . B232 ) * ( D115 . B233 ) ))))))))
proof
reconsider D117 = ( D110 *' D111 ) as (Element of D90) by POLYNOM1:def 10;
let C247 being (bag of ( C227 +^ C228 ));
reconsider D118 = C247 as (Element of ( Bags ( C227 +^ C228 ) )) by PRE_POLY:def 12;
consider C248 being (Element of ( Bags C227 )), C249 being (Element of ( Bags C228 )) such that L780: D118 = ( C248 +^ C249 ) by L173;
reconsider D119 = C248 as (bag of C227);
consider C250 being (FinSequence of (the carrier of ( Polynom-Ring (C228 , C229) ))) such that L781: ( ( D110 *' D111 ) . D119 ) = ( Sum C250 ) and L782: ( len C250 ) = ( len ( decomp D119 ) ) and L783: (for B234 being (Element of ( NAT )) holds (B234 in ( dom C250 ) implies (ex B235 , B236 being (bag of C227) st (( ( decomp D119 ) /. B234 ) = <* B235 , B236 *> & ( C250 /. B234 ) = ( ( D110 . B235 ) * ( D111 . B236 ) ))))) by POLYNOM1:def 9;
L784: (for B237 being set holds (B237 in ( dom C250 ) implies ( C250 . B237 ) is Function))
proof
let C251 being set;
assume L785: C251 in ( dom C250 );
L786: ( C250 . C251 ) in ( rng C250 ) by L785 , FUNCT_1:3;
L787: ( rng C250 ) c= (the carrier of ( Polynom-Ring (C228 , C229) )) by FINSEQ_1:def 4;
thus L788: thesis by L787 , L786 , POLYNOM1:def 10;
end;
reconsider D120 = C250 as  Function-yielding Function by L784 , FUNCOP_1:def 6;
deffunc H5(set) = ( ( D120 . $1 ) . C249 );
consider C252 being Function such that L789: ( dom C252 ) = ( dom C250 ) and L790: (for B238 being set holds (B238 in ( dom C250 ) implies ( C252 . B238 ) = H5(B238))) from FUNCT_1:sch 3;
L791: (ex B239 being Nat st ( dom C250 ) = ( Seg B239 )) by FINSEQ_1:def 2;
reconsider D121 = C252 as FinSequence by L791 , L789 , FINSEQ_1:def 2;
L792: ( rng D121 ) c= (the carrier of C229)
proof
let C253 being set;
L793: ( rng D120 ) c= (the carrier of ( Polynom-Ring (C228 , C229) )) by FINSEQ_1:def 4;
assume L794: C253 in ( rng D121 );
consider C254 being set such that L795: C254 in ( dom D121 ) and L796: C253 = ( D121 . C254 ) by L794 , FUNCT_1:def 3;
L797: ( D120 . C254 ) in ( rng D120 ) by L789 , L795 , FUNCT_1:3;
L798: ( D120 . C254 ) is (Function of ( Bags C228 ) , (the carrier of C229)) by L797 , L793 , POLYNOM1:def 10;
L799: ( rng ( D120 . C254 ) ) c= (the carrier of C229) by L798 , RELAT_1:def 19;
L800: ( dom ( D120 . C254 ) ) = ( Bags C228 ) by L798 , FUNCT_2:def 1;
L801: ( ( D120 . C254 ) . C249 ) in ( rng ( D120 . C254 ) ) by L800 , FUNCT_1:3;
L802: ( D121 . C254 ) = ( ( D120 . C254 ) . C249 ) by L789 , L790 , L795;
thus L803: thesis by L802 , L796 , L799 , L801;
end;
defpred S7[ set , set ] means (ex B240 , B241 being (bag of C227) st (ex B242 being (FinSequence of (the carrier of C229)) st (ex B243 , B244 being (Polynomial of C228 , C229) st (B243 = ( D110 . B240 ) & B244 = ( D111 . B241 ) & B242 = $2 & ( ( decomp D119 ) /. $1 ) = <* B240 , B241 *> & ( len B242 ) = ( len ( decomp C249 ) ) & (for B245 being Nat holds (B245 in ( dom B242 ) implies (ex B246 , B247 being (bag of C228) st (( ( decomp C249 ) /. B245 ) = <* B246 , B247 *> & ( B242 /. B245 ) = ( ( B243 . B246 ) * ( B244 . B247 ) )))))))));
L804: (for B248 being (Element of ( NAT )) holds (B248 in ( Seg ( len C250 ) ) implies (ex B249 being (Element of ( (the carrier of C229) * )) st S7[ B248 , B249 ])))
proof
let C255 being (Element of ( NAT ));
assume L805: C255 in ( Seg ( len C250 ) );
L806: C255 in ( dom ( decomp D119 ) ) by L805 , L782 , FINSEQ_1:def 3;
consider C256 , C257 being (bag of C227) such that L807: ( ( decomp D119 ) /. C255 ) = <* C256 , C257 *> and L808: D119 = ( C256 + C257 ) by L806 , PRE_POLY:68;
reconsider D122 = ( D110 . C256 ) , D123 = ( D111 . C257 ) as (Element of ( Polynom-Ring (C228 , C229) ));
reconsider D124 = D122 , D125 = D123 as (Polynomial of C228 , C229) by POLYNOM1:def 10;
defpred S8[ set , set ] means (ex B250 , B251 being (bag of C228) st (( ( decomp C249 ) /. $1 ) = <* B250 , B251 *> & $2 = ( ( D124 . B250 ) * ( D125 . B251 ) )));
L809: (for B252 being (Element of ( NAT )) holds (B252 in ( Seg ( len ( decomp C249 ) ) ) implies (ex B253 being (Element of C229) st S8[ B252 , B253 ])))
proof
let C258 being (Element of ( NAT ));
assume L810: C258 in ( Seg ( len ( decomp C249 ) ) );
L811: C258 in ( dom ( decomp C249 ) ) by L810 , FINSEQ_1:def 3;
consider C259 , C260 being (bag of C228) such that L812: ( ( decomp C249 ) /. C258 ) = <* C259 , C260 *> and L813: C249 = ( C259 + C260 ) by L811 , PRE_POLY:68;
reconsider D126 = ( ( D124 . C259 ) * ( D125 . C260 ) ) as (Element of C229);
take D126;
take C259;
take C260;
thus L814: thesis by L812;
end;
consider C261 being (FinSequence of (the carrier of C229)) such that L815: ( dom C261 ) = ( Seg ( len ( decomp C249 ) ) ) and L816: (for B254 being (Element of ( NAT )) holds (B254 in ( Seg ( len ( decomp C249 ) ) ) implies S8[ B254 , ( C261 /. B254 ) ])) from RECDEF_1:sch 17(L809);
reconsider D127 = C261 as (Element of ( (the carrier of C229) * )) by FINSEQ_1:def 11;
take D127;
take C256;
take C257;
take C261;
take D124;
take D125;
thus L817: (D124 = ( D110 . C256 ) & D125 = ( D111 . C257 ) & C261 = D127);
thus L818: ( ( decomp D119 ) /. C255 ) = <* C256 , C257 *> by L807;
thus L819: ( len C261 ) = ( len ( decomp C249 ) ) by L815 , FINSEQ_1:def 3;
let C262 being Nat;
assume L820: C262 in ( dom C261 );
thus L821: thesis by L820 , L815 , L816;
end;
consider C263 being (FinSequence of ( (the carrier of C229) * )) such that L822: ( dom C263 ) = ( Seg ( len C250 ) ) and L823: (for B255 being (Element of ( NAT )) holds (B255 in ( Seg ( len C250 ) ) implies S7[ B255 , ( C263 /. B255 ) ])) from RECDEF_1:sch 17(L804);
take D128 = ( FlattenSeq C263 );
L824: ( len ( Sum C263 ) ) = ( len C263 ) by MATRLIN:def 6;
reconsider D129 = D121 as (FinSequence of (the carrier of C229)) by L792 , FINSEQ_1:def 4;
L825: ( D95 . D117 ) = ( Compress ( D110 *' D111 ) ) by L755;
L826: ( dom D129 ) = ( dom C263 ) by L822 , L789 , FINSEQ_1:def 3
.= ( dom ( Sum C263 ) ) by L824 , FINSEQ_3:29;
L827: (for B256 being Nat holds (B256 in ( dom D129 ) implies ( D129 . B256 ) = ( ( Sum C263 ) . B256 )))
proof
let C264 being Nat;
assume that
L828: C264 in ( dom D129 );
consider C265 , C266 being (bag of C227) such that L829: ( ( decomp D119 ) /. C264 ) = <* C265 , C266 *> and L830: ( C250 /. C264 ) = ( ( D110 . C265 ) * ( D111 . C266 ) ) by L783 , L789 , L828;
L831: C264 in ( Seg ( len C250 ) ) by L789 , L828 , FINSEQ_1:def 3;
consider C267 , C268 being (bag of C227), C269 being (FinSequence of (the carrier of C229)), C270 , C271 being (Polynomial of C228 , C229) such that L832: (C270 = ( D110 . C267 ) & C271 = ( D111 . C268 )) and L833: C269 = ( C263 /. C264 ) and L834: ( ( decomp D119 ) /. C264 ) = <* C267 , C268 *> and L835: ( len C269 ) = ( len ( decomp C249 ) ) and L836: (for B257 being Nat holds (B257 in ( dom C269 ) implies (ex B258 , B259 being (bag of C228) st (( ( decomp C249 ) /. B257 ) = <* B258 , B259 *> & ( C269 /. B257 ) = ( ( C270 . B258 ) * ( C271 . B259 ) ))))) by L831 , L823;
L837: (C265 = C267 & C266 = C268) by L829 , L834 , FINSEQ_1:77;
consider C272 being (FinSequence of (the carrier of C229)) such that L838: ( ( C270 *' C271 ) . C249 ) = ( Sum C272 ) and L839: ( len C272 ) = ( len ( decomp C249 ) ) and L840: (for B260 being (Element of ( NAT )) holds (B260 in ( dom C272 ) implies (ex B261 , B262 being (bag of C228) st (( ( decomp C249 ) /. B260 ) = <* B261 , B262 *> & ( C272 /. B260 ) = ( ( C270 . B261 ) * ( C271 . B262 ) ))))) by POLYNOM1:def 9;
L841: ( dom C272 ) = ( Seg ( len C272 ) ) by FINSEQ_1:def 3;
L842:
now
let C273 being Nat;
assume L843: C273 in ( dom C272 );
L844: ( C272 /. C273 ) = ( C272 . C273 ) by L843 , PARTFUN1:def 6;
L845: C273 in ( dom C269 ) by L835 , L839 , L841 , L843 , FINSEQ_1:def 3;
consider C274 , C275 being (bag of C228) such that L846: ( ( decomp C249 ) /. C273 ) = <* C274 , C275 *> and L847: ( C269 /. C273 ) = ( ( C270 . C274 ) * ( C271 . C275 ) ) by L845 , L836;
consider C276 , C277 being (bag of C228) such that L848: ( ( decomp C249 ) /. C273 ) = <* C276 , C277 *> and L849: ( C272 /. C273 ) = ( ( C270 . C276 ) * ( C271 . C277 ) ) by L840 , L843;
L850: (C276 = C274 & C277 = C275) by L848 , L846 , FINSEQ_1:77;
thus L851: ( C272 . C273 ) = ( C269 . C273 ) by L850 , L849 , L845 , L847 , L844 , PARTFUN1:def 6;
end;
L852: C272 = C269 by L842 , L835 , L839 , FINSEQ_2:9;
L853: ( D120 . C264 ) = ( C250 /. C264 ) by L789 , L828 , PARTFUN1:def 6
.= ( C270 *' C271 ) by L830 , L832 , L837 , POLYNOM1:def 10;
thus L854: ( D129 . C264 ) = ( ( D120 . C264 ) . C249 ) by L789 , L790 , L828
.= ( ( Sum C263 ) /. C264 ) by L826 , L828 , L833 , L853 , L838 , L852 , MATRLIN:def 6
.= ( ( Sum C263 ) . C264 ) by L826 , L828 , PARTFUN1:def 6;
end;
L855: D129 = ( Sum C263 ) by L827 , L826 , FINSEQ_1:13;
reconsider D130 = ( Sum C250 ) as (Polynomial of C228 , C229) by POLYNOM1:def 10;
consider C278 being (Function of ( NAT ) , (the carrier of ( Polynom-Ring (C228 , C229) ))) such that L856: ( Sum C250 ) = ( C278 . ( len C250 ) ) and L857: ( C278 . ( 0 ) ) = ( 0. ( Polynom-Ring (C228 , C229) ) ) and L858: (for B263 being (Element of ( NAT )) holds (for B264 being (Element of ( Polynom-Ring (C228 , C229) )) holds ((B263 < ( len C250 ) & B264 = ( C250 . ( B263 + 1 ) )) implies ( C278 . ( B263 + 1 ) ) = ( ( C278 . B263 ) + B264 )))) by RLVECT_1:def 12;
defpred S9[ Nat , set ] means (for B265 being (Polynomial of C228 , C229) holds (($1 <= ( len C250 ) & B265 = ( C278 . $1 )) implies $2 = ( B265 . C249 )));
L859: (for B266 being (Element of ( NAT )) holds (ex B267 being (Element of C229) st S9[ B266 , B267 ]))
proof
let C279 being (Element of ( NAT ));
reconsider D131 = ( C278 . C279 ) as (Polynomial of C228 , C229) by POLYNOM1:def 10;
take D132 = ( D131 . C249 );
let C280 being (Polynomial of C228 , C229);
assume that
L860: C279 <= ( len C250 )
and
L861: C280 = ( C278 . C279 );
thus L862: thesis by L861;
end;
consider C281 being (Function of ( NAT ) , (the carrier of C229)) such that L863: (for B268 being (Element of ( NAT )) holds S9[ B268 , ( C281 . B268 ) ]) from FUNCT_2:sch 3(L859);
defpred S10[ set , set ] means (ex B269 , B270 being (Element of ( Bags C227 )) st (ex B271 being (FinSequence of ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) )) st (B271 = $2 & ( ( decomp D119 ) /. $1 ) = <* B269 , B270 *> & ( len B271 ) = ( len ( decomp C249 ) ) & (for B272 being Nat holds (B272 in ( dom B271 ) implies (ex B273 , B274 being (Element of ( Bags C228 )) st (( ( decomp C249 ) /. B272 ) = <* B273 , B274 *> & ( B271 /. B272 ) = <* ( B269 +^ B273 ) , ( B270 +^ B274 ) *>)))))));
L864: (for B275 being (Element of ( NAT )) holds (B275 in ( Seg ( len C250 ) ) implies (ex B276 being (Element of ( ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) ) * )) st S10[ B275 , B276 ])))
proof
let C282 being (Element of ( NAT ));
assume L865: C282 in ( Seg ( len C250 ) );
L866: C282 in ( dom ( decomp D119 ) ) by L865 , L782 , FINSEQ_1:def 3;
consider C283 , C284 being (bag of C227) such that L867: ( ( decomp D119 ) /. C282 ) = <* C283 , C284 *> and L868: D119 = ( C283 + C284 ) by L866 , PRE_POLY:68;
reconsider D133 = C283 , D134 = C284 as (Element of ( Bags C227 )) by PRE_POLY:def 12;
defpred S11[ set , set ] means (ex B277 , B278 being (Element of ( Bags C228 )) st (( ( decomp C249 ) /. $1 ) = <* B277 , B278 *> & $2 = <* ( D133 +^ B277 ) , ( D134 +^ B278 ) *>));
L869: (for B279 being (Element of ( NAT )) holds (B279 in ( Seg ( len ( decomp C249 ) ) ) implies (ex B280 being (Element of ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) )) st S11[ B279 , B280 ])))
proof
let C285 being (Element of ( NAT ));
assume L870: C285 in ( Seg ( len ( decomp C249 ) ) );
L871: C285 in ( dom ( decomp C249 ) ) by L870 , FINSEQ_1:def 3;
consider C286 , C287 being (bag of C228) such that L872: ( ( decomp C249 ) /. C285 ) = <* C286 , C287 *> and L873: C249 = ( C286 + C287 ) by L871 , PRE_POLY:68;
reconsider D135 = C286 , D136 = C287 as (Element of ( Bags C228 )) by PRE_POLY:def 12;
reconsider D137 = <* ( D133 +^ D135 ) , ( D134 +^ D136 ) *> as (Element of ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) ));
take D137;
take D135;
take D136;
thus L874: thesis by L872;
end;
consider C288 being (FinSequence of ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) )) such that L875: ( dom C288 ) = ( Seg ( len ( decomp C249 ) ) ) and L876: (for B281 being (Element of ( NAT )) holds (B281 in ( Seg ( len ( decomp C249 ) ) ) implies S11[ B281 , ( C288 /. B281 ) ])) from RECDEF_1:sch 17(L869);
reconsider D138 = C288 as (Element of ( ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) ) * )) by FINSEQ_1:def 11;
take D138;
take D133;
take D134;
take C288;
thus L877: C288 = D138;
thus L878: ( ( decomp D119 ) /. C282 ) = <* D133 , D134 *> by L867;
thus L879: ( len C288 ) = ( len ( decomp C249 ) ) by L875 , FINSEQ_1:def 3;
let C289 being Nat;
assume L880: C289 in ( dom C288 );
thus L881: thesis by L880 , L875 , L876;
end;
consider C290 being (FinSequence of ( ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) ) * )) such that L882: ( dom C290 ) = ( Seg ( len C250 ) ) and L883: (for B282 being (Element of ( NAT )) holds (B282 in ( Seg ( len C250 ) ) implies S10[ B282 , ( C290 /. B282 ) ])) from RECDEF_1:sch 17(L864);
L884: (for B283 being Nat holds (B283 in ( Seg ( len C250 ) ) implies S10[ B283 , ( C290 /. B283 ) ])) by L883;
L885: ( dom ( Card C263 ) ) = ( dom C263 ) by CARD_3:def 2;
L886: (for B284 being Nat holds (B284 in ( dom ( Card C263 ) ) implies ( ( Card C263 ) . B284 ) = ( ( Card C290 ) . B284 )))
proof
let C291 being Nat;
assume L887: C291 in ( dom ( Card C263 ) );
L888: C291 in ( dom C263 ) by L887 , CARD_3:def 2;
L889: ( ( Card C263 ) . C291 ) = ( card ( C263 . C291 ) ) by L888 , CARD_3:def 2;
L890: ((ex B285 , B286 being (bag of C227) st (ex B287 being (FinSequence of (the carrier of C229)) st (ex B288 , B289 being (Polynomial of C228 , C229) st (B288 = ( D110 . B285 ) & B289 = ( D111 . B286 ) & B287 = ( C263 /. C291 ) & ( ( decomp D119 ) /. C291 ) = <* B285 , B286 *> & ( len B287 ) = ( len ( decomp C249 ) ) & (for B290 being Nat holds (B290 in ( dom B287 ) implies (ex B291 , B292 being (bag of C228) st (( ( decomp C249 ) /. B290 ) = <* B291 , B292 *> & ( B287 /. B290 ) = ( ( B288 . B291 ) * ( B289 . B292 ) ))))))))) & (ex B293 , B294 being (Element of ( Bags C227 )) st (ex B295 being (FinSequence of ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) )) st (B295 = ( C290 /. C291 ) & ( ( decomp D119 ) /. C291 ) = <* B293 , B294 *> & ( len B295 ) = ( len ( decomp C249 ) ) & (for B296 being Nat holds (B296 in ( dom B295 ) implies (ex B297 , B298 being (Element of ( Bags C228 )) st (( ( decomp C249 ) /. B296 ) = <* B297 , B298 *> & ( B295 /. B296 ) = <* ( B293 +^ B297 ) , ( B294 +^ B298 ) *>)))))))) by L822 , L823 , L883 , L888;
L891: ( card ( C263 . C291 ) ) = ( card ( C263 /. C291 ) ) by L888 , PARTFUN1:def 6
.= ( card ( C290 . C291 ) ) by L822 , L882 , L885 , L887 , L890 , PARTFUN1:def 6;
thus L892: thesis by L891 , L822 , L882 , L885 , L887 , L889 , CARD_3:def 2;
end;
consider C292 being (Element of ( Bags C227 )), C293 being (Element of ( Bags C228 )), C294 being (Polynomial of C228 , C229) such that L893: C294 = ( ( D110 *' D111 ) . C292 ) and L894: D118 = ( C292 +^ C293 ) and L895: ( ( Compress ( D110 *' D111 ) ) . D118 ) = ( C294 . C293 ) by L282;
L896: C292 = D119 by L780 , L894 , L228;
L897: ( dom C290 ) = ( dom ( decomp C292 ) ) by L896 , L782 , L882 , FINSEQ_1:def 3;
L898: ( decomp C247 ) = ( FlattenSeq C290 ) by L897 , L780 , L882 , L884 , L896 , L644;
L899: (for B299 being (Element of ( NAT )) holds (for B300 being (Element of C229) holds ((B299 < ( len D129 ) & B300 = ( D129 . ( B299 + 1 ) )) implies ( C281 . ( B299 + 1 ) ) = ( ( C281 . B299 ) + B300 ))))
proof
let C295 being (Element of ( NAT ));
let C296 being (Element of C229);
assume that
L900: C295 < ( len D129 )
and
L901: C296 = ( D129 . ( C295 + 1 ) );
reconsider D139 = ( C250 /. ( C295 + 1 ) ) , D140 = ( C278 . C295 ) , D141 = ( C278 . ( C295 + 1 ) ) as (Polynomial of C228 , C229) by POLYNOM1:def 10;
reconsider D142 = D139 , D143 = D140 , D144 = D141 as (Element of ( Polynom-Ring (C228 , C229) ));
reconsider D145 = D142 , D146 = D143 , D147 = D144 as (Element of ( Polynom-Ring (C228 , C229) ));
L902: C295 < ( len C250 ) by L789 , L900 , FINSEQ_3:29;
L903: ( C295 + 1 ) <= ( len C250 ) by L902 , NAT_1:13;
L904: D139 = ( C250 . ( C295 + 1 ) ) by L903 , FINSEQ_4:15 , NAT_1:11;
L905: D147 = ( D146 + D145 ) by L904 , L858 , L902;
L906: 1 <= ( C295 + 1 ) by NAT_1:11;
L907: ( C295 + 1 ) in ( dom C250 ) by L906 , L903 , FINSEQ_3:25;
L908: ( D139 . C249 ) = C296 by L907 , L790 , L901 , L904;
L909: ( C295 + 1 ) <= ( len C250 ) by L902 , NAT_1:13;
thus L910: ( C281 . ( C295 + 1 ) ) = ( D141 . C249 ) by L909 , L863
.= ( ( D140 + D139 ) . C249 ) by L905 , POLYNOM1:def 10
.= ( ( D140 . C249 ) + ( D139 . C249 ) ) by POLYNOM1:15
.= ( ( C281 . C295 ) + C296 ) by L863 , L902 , L908;
end;
L911: ( C278 . ( 0 ) ) = ( 0_ (C228 , C229) ) by L857 , POLYNOM1:def 10;
L912: ( C281 . ( 0 ) ) = ( ( 0_ (C228 , C229) ) . C249 ) by L911 , L863 , NAT_1:2
.= ( 0. C229 ) by POLYNOM1:22;
L913: ( len D129 ) = ( len C250 ) by L789 , FINSEQ_3:29;
L914: ( D130 . C249 ) = ( C281 . ( len D129 ) ) by L913 , L856 , L863;
L915: ( D130 . C249 ) = ( Sum D129 ) by L914 , L912 , L899 , RLVECT_1:def 12;
L916: (D119 = C292 & C249 = C293) by L780 , L894 , L228;
thus L917: ( D116 . C247 ) = ( Sum D128 ) by L916 , L781 , L893 , L895 , L855 , L915 , L825 , POLYNOM1:14;
L918: ( dom ( Card C290 ) ) = ( dom C290 ) by CARD_3:def 2;
L919: ( len ( Card C263 ) ) = ( len ( Card C290 ) ) by L918 , L822 , L882 , L885 , FINSEQ_3:29;
L920: ( Card C263 ) = ( Card C290 ) by L919 , L886 , FINSEQ_2:9;
thus L921: ( len D128 ) = ( len ( decomp C247 ) ) by L920 , L898 , PRE_POLY:28;
let C297 being (Element of ( NAT ));
assume L922: C297 in ( dom D128 );
consider C298 , C299 being (Element of ( NAT )) such that L923: C298 in ( dom C263 ) and L924: C299 in ( dom ( C263 . C298 ) ) and L925: C297 = ( ( Sum ( Card ( C263 | ( C298 -' 1 ) ) ) ) + C299 ) and L926: ( ( C263 . C298 ) . C299 ) = ( ( FlattenSeq C263 ) . C297 ) by L922 , PRE_POLY:29;
L927: C297 in ( dom ( decomp C247 ) ) by L921 , L922 , FINSEQ_3:29;
consider C300 , C301 being (Element of ( NAT )) such that L928: C300 in ( dom C290 ) and L929: C301 in ( dom ( C290 . C300 ) ) and L930: C297 = ( ( Sum ( Card ( C290 | ( C300 -' 1 ) ) ) ) + C301 ) and L931: ( ( C290 . C300 ) . C301 ) = ( ( decomp C247 ) . C297 ) by L927 , L898 , PRE_POLY:29;
L932: ( ( Sum ( ( Card C263 ) | ( C298 -' 1 ) ) ) + C299 ) = ( ( Sum ( Card ( C263 | ( C298 -' 1 ) ) ) ) + C299 ) by POLYNOM3:16
.= ( ( Sum ( ( Card C290 ) | ( C300 -' 1 ) ) ) + C301 ) by L925 , L930 , POLYNOM3:16;
L933: (C298 = C300 & C299 = C301) by L932 , L920 , L923 , L924 , L928 , L929 , POLYNOM3:22;
consider C302 , C303 being (bag of ( C227 +^ C228 )) such that L934: ( ( decomp C247 ) /. C297 ) = <* C302 , C303 *> and L935: C247 = ( C302 + C303 ) by L927 , PRE_POLY:68;
reconsider D148 = C302 , D149 = C303 as (Element of ( Bags ( C227 +^ C228 ) )) by PRE_POLY:def 12;
consider C304 being (Element of ( Bags C227 )), C305 being (Element of ( Bags C228 )), C306 being (Polynomial of C228 , C229) such that L936: C306 = ( D110 . C304 ) and L937: D148 = ( C304 +^ C305 ) and L938: ( ( Compress D110 ) . D148 ) = ( C306 . C305 ) by L282;
consider C307 , C308 being (bag of C227), C309 being (FinSequence of (the carrier of C229)), C310 , C311 being (Polynomial of C228 , C229) such that L939: C310 = ( D110 . C307 ) and L940: C311 = ( D111 . C308 ) and L941: C309 = ( C263 /. C298 ) and L942: ( ( decomp D119 ) /. C298 ) = <* C307 , C308 *> and L943: ( len C309 ) = ( len ( decomp C249 ) ) and L944: (for B301 being Nat holds (B301 in ( dom C309 ) implies (ex B302 , B303 being (bag of C228) st (( ( decomp C249 ) /. B301 ) = <* B302 , B303 *> & ( C309 /. B301 ) = ( ( C310 . B302 ) * ( C311 . B303 ) ))))) by L822 , L823 , L923;
consider C312 , C313 being (Element of ( Bags C227 )), C314 being (FinSequence of ( 2 -tuples_on ( Bags ( C227 +^ C228 ) ) )) such that L945: C314 = ( C290 /. C298 ) and L946: ( ( decomp D119 ) /. C298 ) = <* C312 , C313 *> and L947: ( len C314 ) = ( len ( decomp C249 ) ) and L948: (for B304 being Nat holds (B304 in ( dom C314 ) implies (ex B305 , B306 being (Element of ( Bags C228 )) st (( ( decomp C249 ) /. B304 ) = <* B305 , B306 *> & ( C314 /. B304 ) = <* ( C312 +^ B305 ) , ( C313 +^ B306 ) *>)))) by L822 , L883 , L923;
L949: C308 = C313 by L942 , L946 , FINSEQ_1:77;
L950: C314 = ( C290 . C298 ) by L822 , L882 , L923 , L945 , PARTFUN1:def 6;
consider C315 , C316 being (Element of ( Bags C228 )) such that L951: ( ( decomp C249 ) /. C299 ) = <* C315 , C316 *> and L952: ( C314 /. C299 ) = <* ( C312 +^ C315 ) , ( C313 +^ C316 ) *> by L950 , L929 , L933 , L948;
L953: <* C302 , C303 *> = ( ( C290 . C298 ) . C299 ) by L927 , L934 , L931 , L933 , PARTFUN1:def 6
.= <* ( C312 +^ C315 ) , ( C313 +^ C316 ) *> by L929 , L933 , L950 , L952 , PARTFUN1:def 6;
L954: C302 = ( C312 +^ C315 ) by L953 , FINSEQ_1:77;
L955: (C304 = C312 & C305 = C315) by L954 , L937 , L228;
L956: C307 = C312 by L942 , L946 , FINSEQ_1:77;
L957: C299 in ( dom C309 ) by L923 , L924 , L941 , PARTFUN1:def 6;
consider C317 , C318 being (bag of C228) such that L958: ( ( decomp C249 ) /. C299 ) = <* C317 , C318 *> and L959: ( C309 /. C299 ) = ( ( C310 . C317 ) * ( C311 . C318 ) ) by L957 , L944;
L960: C317 = C315 by L951 , L958 , FINSEQ_1:77;
L961: ( C310 . C317 ) = ( D114 . C302 ) by L960 , L755 , L939 , L936 , L938 , L955 , L956;
take C302;
take C303;
thus L962: ( ( decomp C247 ) /. C297 ) = <* C302 , C303 *> by L934;
consider C319 being (Element of ( Bags C227 )), C320 being (Element of ( Bags C228 )), C321 being (Polynomial of C228 , C229) such that L963: C321 = ( D111 . C319 ) and L964: D149 = ( C319 +^ C320 ) and L965: ( ( Compress D111 ) . D149 ) = ( C321 . C320 ) by L282;
L966: C303 = ( C313 +^ C316 ) by L953 , FINSEQ_1:77;
L967: (C319 = C313 & C320 = C316) by L966 , L964 , L228;
L968: C309 = ( C263 . C298 ) by L923 , L941 , PARTFUN1:def 6;
L969: C318 = C316 by L951 , L958 , FINSEQ_1:77;
L970: ( C311 . C318 ) = ( D115 . C303 ) by L969 , L755 , L940 , L949 , L963 , L965 , L967;
thus L971: ( D128 /. C297 ) = ( D128 . C297 ) by L922 , PARTFUN1:def 6
.= ( ( D114 . C302 ) * ( D115 . C303 ) ) by L924 , L926 , L968 , L959 , L961 , L970 , PARTFUN1:def 6;
end;
thus L972: ( D95 . ( C245 * C246 ) ) = ( D95 . ( D110 *' D111 ) ) by POLYNOM1:def 10
.= ( D114 *' D115 ) by L779 , POLYNOM1:def 9
.= ( ( D95 . C245 ) * ( D95 . C246 ) ) by POLYNOM1:def 10;
end;
thus L973: D95 is  multiplicative by L777 , GROUP_6:def 6;
L974: (for B307 being (Element of ( Bags ( C227 +^ C228 ) )) holds ( ( Compress D91 ) . B307 ) = ( D92 . B307 ))
proof
let C322 being (Element of ( Bags ( C227 +^ C228 ) ));
L975: ( D92 . C322 ) = ( ( 1_ (( C227 +^ C228 ) , C229) ) . C322 ) by POLYNOM1:31;
consider C323 being (Element of ( Bags C227 )), C324 being (Element of ( Bags C228 )), C325 being (Polynomial of C228 , C229) such that L976: C325 = ( D91 . C323 ) and L977: C322 = ( C323 +^ C324 ) and L978: ( ( Compress D91 ) . C322 ) = ( C325 . C324 ) by L282;
per cases ;
suppose L979: C322 = ( EmptyBag ( C227 +^ C228 ) );

L980: C323 = ( EmptyBag C227 ) by L979 , L977 , L148;
L981: C324 = ( EmptyBag C228 ) by L977 , L979 , L148;
L982: C325 = ( ( 1_ (C227 , ( Polynom-Ring (C228 , C229) )) ) . C323 ) by L976 , POLYNOM1:31
.= ( 1_ ( Polynom-Ring (C228 , C229) ) ) by L980 , POLYNOM1:25;
L983: ( C325 . C324 ) = ( ( 1_ (C228 , C229) ) . C324 ) by L982 , POLYNOM1:31
.= ( 1_ C229 ) by L981 , POLYNOM1:25
.= ( D92 . C322 ) by L975 , L979 , POLYNOM1:25;
thus L984: thesis by L983 , L978;
end;
suppose L985: C322 <> ( EmptyBag ( C227 +^ C228 ) );

L986: (C323 <> ( EmptyBag C227 ) or C324 <> ( EmptyBag C228 )) by L985 , L977 , L148;
L987:
now
per cases ;
suppose L988: C323 = ( EmptyBag C227 );

L989: C325 = ( ( 1_ (C227 , ( Polynom-Ring (C228 , C229) )) ) . C323 ) by L976 , POLYNOM1:31
.= ( 1_ ( Polynom-Ring (C228 , C229) ) ) by L988 , POLYNOM1:25
.= ( 1_ (C228 , C229) ) by POLYNOM1:31;
L990: ( C325 . C324 ) = ( 0. C229 ) by L989 , L986 , L988 , POLYNOM1:25
.= ( D92 . C322 ) by L975 , L985 , POLYNOM1:25;
thus L991: thesis by L990 , L978;
end;
suppose L992: C323 <> ( EmptyBag C227 );

L993: C325 = ( ( 1_ (C227 , ( Polynom-Ring (C228 , C229) )) ) . C323 ) by L976 , POLYNOM1:31
.= ( 0. ( Polynom-Ring (C228 , C229) ) ) by L992 , POLYNOM1:25
.= ( 0_ (C228 , C229) ) by POLYNOM1:def 10;
L994: ( C325 . C324 ) = ( 0. C229 ) by L993 , POLYNOM1:22
.= ( D92 . C322 ) by L975 , L985 , POLYNOM1:25;
thus L995: thesis by L994 , L978;
end;
end;
thus L997: thesis by L987;
end;
end;
L999: ( D95 . ( 1_ D90 ) ) = ( Compress D91 ) by L755
.= ( 1_ D89 ) by L974 , FUNCT_2:63;
thus L1000: D95 is  unity-preserving by L999 , GROUP_1:def 13;
thus L1001: D95 is  one-to-one
proof
let C326 , C327 being set;
assume L1002: C326 in ( dom D95 );
reconsider D150 = C326 as (Element of D90) by L1002 , FUNCT_2:def 1;
assume L1003: C327 in ( dom D95 );
reconsider D151 = C327 as (Element of D90) by L1003 , FUNCT_2:def 1;
reconsider D152 = D151 as (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) by POLYNOM1:def 10;
reconsider D153 = D150 as (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) by POLYNOM1:def 10;
L1004: ( D95 . D151 ) = ( Compress D152 ) by L755;
reconsider D154 = ( D95 . D151 ) as (Polynomial of ( C227 +^ C228 ) , C229) by L1004;
L1005: ( D95 . D150 ) = ( Compress D153 ) by L755;
reconsider D155 = ( D95 . D150 ) as (Polynomial of ( C227 +^ C228 ) , C229) by L1005;
assume L1006: ( D95 . C326 ) = ( D95 . C327 );
L1007:
now
let C328 being (Element of ( Bags C227 ));
reconsider D156 = ( D153 . C328 ) , D157 = ( D152 . C328 ) as (Polynomial of C228 , C229) by POLYNOM1:def 10;
L1008:
now
let C329 being (Element of ( Bags C228 ));
set D158 = ( C328 +^ C329 );
consider C330 being (Element of ( Bags C227 )), C331 being (Element of ( Bags C228 )), C332 being (Polynomial of C228 , C229) such that L1009: C332 = ( D153 . C330 ) and L1010: D158 = ( C330 +^ C331 ) and L1011: ( D155 . D158 ) = ( C332 . C331 ) by L1005 , L282;
L1012: (C328 = C330 & C329 = C331) by L1010 , L228;
consider C333 being (Element of ( Bags C227 )), C334 being (Element of ( Bags C228 )), C335 being (Polynomial of C228 , C229) such that L1013: C335 = ( D152 . C333 ) and L1014: D158 = ( C333 +^ C334 ) and L1015: ( D154 . D158 ) = ( C335 . C334 ) by L1004 , L282;
L1016: C328 = C333 by L1014 , L228;
thus L1017: ( D156 . C329 ) = ( D157 . C329 ) by L1016 , L1006 , L1009 , L1011 , L1013 , L1014 , L1015 , L1012 , L228;
end;
thus L1018: ( D153 . C328 ) = ( D152 . C328 ) by L1008 , FUNCT_2:63;
end;
thus L1019: thesis by L1007 , FUNCT_2:63;
end;

thus L1020: D95 is  RingHomomorphism by L756 , L973 , L1000;
thus L1021: ( rng D95 ) c= (the carrier of D89) by RELAT_1:def 19;
thus L1022: (the carrier of D89) c= ( rng D95 )
proof
defpred S12[ set , set ] means (ex B308 being (Element of ( Bags C227 )) st (ex B309 being (Element of ( Bags C228 )) st ($1 = ( B308 +^ B309 ) & $2 = B308)));
let C336 being set;
assume L1023: C336 in (the carrier of D89);
reconsider D159 = C336 as (Polynomial of ( C227 +^ C228 ) , C229) by L1023 , POLYNOM1:def 10;
defpred S13[ (Element of ( Bags C227 )) , (Element of ( Polynom-Ring (C228 , C229) )) ] means (ex B310 being Function st (B310 = $2 & (for B311 being (Element of ( Bags C228 )) holds (for B312 being (Element of ( Bags ( C227 +^ C228 ) )) holds (B312 = ( $1 +^ B311 ) implies ( B310 . B311 ) = ( D159 . B312 ))))));
L1024: (for B313 being (Element of ( Bags ( C227 +^ C228 ) )) holds (ex B314 being (Element of ( Bags C227 )) st S12[ B313 , B314 ]))
proof
let C337 being (Element of ( Bags ( C227 +^ C228 ) ));
consider C338 being (Element of ( Bags C227 )), C339 being (Element of ( Bags C228 )) such that L1025: C337 = ( C338 +^ C339 ) by L173;
reconsider D160 = C338 as (Element of ( Bags C227 ));
take D160;
take C338;
take C339;
thus L1026: C337 = ( C338 +^ C339 ) by L1025;
thus L1027: D160 = C338;
end;
consider C340 being (Function of ( Bags ( C227 +^ C228 ) ) , ( Bags C227 )) such that L1028: (for B315 being (Element of ( Bags ( C227 +^ C228 ) )) holds S12[ B315 , ( C340 . B315 ) ]) from FUNCT_2:sch 3(L1024);
L1029: (for B316 being (Element of ( Bags C227 )) holds (ex B317 being (Element of ( Polynom-Ring (C228 , C229) )) st S13[ B316 , B317 ]))
proof
defpred S14[ set , set ] means (ex B318 being (Element of ( Bags C227 )) st (ex B319 being (Element of ( Bags C228 )) st ($1 = ( B318 +^ B319 ) & $2 = B319)));
let C341 being (Element of ( Bags C227 ));
reconsider D161 = C341 as (Element of ( Bags C227 ));
defpred S15[ (Element of ( Bags C228 )) , (Element of C229) ] means (for B320 being (Element of ( Bags ( C227 +^ C228 ) )) holds (B320 = ( D161 +^ $1 ) implies $2 = ( D159 . B320 )));
L1030: (for B321 being (Element of ( Bags C228 )) holds (ex B322 being (Element of C229) st S15[ B321 , B322 ]))
proof
let C342 being (Element of ( Bags C228 ));
take ( D159 . ( D161 +^ C342 ) );
let C343 being (Element of ( Bags ( C227 +^ C228 ) ));
assume L1031: C343 = ( D161 +^ C342 );
thus L1032: thesis by L1031;
end;
consider C344 being (Function of ( Bags C228 ) , (the carrier of C229)) such that L1033: (for B323 being (Element of ( Bags C228 )) holds S15[ B323 , ( C344 . B323 ) ]) from FUNCT_2:sch 3(L1030);
reconsider D162 = C344 as (Function of ( Bags C228 ) , C229);
L1034: (for B324 being (Element of ( Bags ( C227 +^ C228 ) )) holds (ex B325 being (Element of ( Bags C228 )) st S14[ B324 , B325 ]))
proof
let C345 being (Element of ( Bags ( C227 +^ C228 ) ));
consider C346 being (Element of ( Bags C227 )), C347 being (Element of ( Bags C228 )) such that L1035: C345 = ( C346 +^ C347 ) by L173;
reconsider D163 = C347 as (Element of ( Bags C228 ));
take D163;
take C346;
take C347;
thus L1036: C345 = ( C346 +^ C347 ) by L1035;
thus L1037: D163 = C347;
end;
consider C348 being (Function of ( Bags ( C227 +^ C228 ) ) , ( Bags C228 )) such that L1038: (for B326 being (Element of ( Bags ( C227 +^ C228 ) )) holds S14[ B326 , ( C348 . B326 ) ]) from FUNCT_2:sch 3(L1034);
L1039: ( Support D162 ) c= ( C348 .: ( Support D159 ) )
proof
let C349 being set;
assume L1040: C349 in ( Support D162 );
reconsider D164 = C349 as (Element of ( Bags C228 )) by L1040;
set D165 = ( D161 +^ D164 );
L1041: ( D162 . C349 ) <> ( 0. C229 ) by L1040 , POLYNOM1:def 3;
L1042: ( D159 . D165 ) <> ( 0. C229 ) by L1041 , L1033;
L1043: (( dom C348 ) = ( Bags ( C227 +^ C228 ) ) & D165 in ( Support D159 )) by L1042 , FUNCT_2:def 1 , POLYNOM1:def 3;
L1044: (ex B327 being (Element of ( Bags C227 )) st (ex B328 being (Element of ( Bags C228 )) st (D165 = ( B327 +^ B328 ) & ( C348 . D165 ) = B328))) by L1038;
L1045: C349 = ( C348 . D165 ) by L1044 , L228;
thus L1046: thesis by L1045 , L1043 , FUNCT_1:def 6;
end;
L1047: D162 is (Polynomial of C228 , C229) by L1039 , POLYNOM1:def 4;
reconsider D166 = D162 as (Element of ( Polynom-Ring (C228 , C229) )) by L1047 , POLYNOM1:def 10;
reconsider D167 = D162 as Function;
take D166;
take D167;
thus L1048: D166 = D167;
let C350 being (Element of ( Bags C228 ));
let C351 being (Element of ( Bags ( C227 +^ C228 ) ));
assume L1049: C351 = ( C341 +^ C350 );
thus L1050: thesis by L1049 , L1033;
end;
consider C352 being (Function of ( Bags C227 ) , (the carrier of ( Polynom-Ring (C228 , C229) ))) such that L1051: (for B329 being (Element of ( Bags C227 )) holds S13[ B329 , ( C352 . B329 ) ]) from FUNCT_2:sch 3(L1029);
reconsider D168 = C352 as (Function of ( Bags C227 ) , ( Polynom-Ring (C228 , C229) ));
L1052: ( Support D168 ) c= ( C340 .: ( Support D159 ) )
proof
let C353 being set;
assume L1053: C353 in ( Support D168 );
reconsider D169 = C353 as (Element of ( Bags C227 )) by L1053;
consider C354 being Function such that L1054: C354 = ( D168 . D169 ) and L1055: (for B330 being (Element of ( Bags C228 )) holds (for B331 being (Element of ( Bags ( C227 +^ C228 ) )) holds (B331 = ( D169 +^ B330 ) implies ( C354 . B330 ) = ( D159 . B331 )))) by L1051;
reconsider D170 = C354 as (Polynomial of C228 , C229) by L1054 , POLYNOM1:def 10;
L1056: ( D168 . D169 ) <> ( 0. ( Polynom-Ring (C228 , C229) ) ) by L1053 , POLYNOM1:def 3;
L1057: ( D168 . D169 ) <> ( 0_ (C228 , C229) ) by L1056 , POLYNOM1:def 10;
consider C355 being (Element of ( Bags C228 )) such that L1058: C355 in ( Support D170 ) by L1057 , L1054 , POLYNOM2:17 , SUBSET_1:4;
set D171 = ( D169 +^ C355 );
L1059: ( D170 . C355 ) <> ( 0. C229 ) by L1058 , POLYNOM1:def 3;
L1060: ( D159 . D171 ) <> ( 0. C229 ) by L1059 , L1055;
L1061: (( dom C340 ) = ( Bags ( C227 +^ C228 ) ) & D171 in ( Support D159 )) by L1060 , FUNCT_2:def 1 , POLYNOM1:def 3;
L1062: (ex B332 being (Element of ( Bags C227 )) st (ex B333 being (Element of ( Bags C228 )) st (D171 = ( B332 +^ B333 ) & ( C340 . D171 ) = B332))) by L1028;
L1063: C353 = ( C340 . D171 ) by L1062 , L228;
thus L1064: thesis by L1063 , L1061 , FUNCT_1:def 6;
end;
L1065: D168 is (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) by L1052 , POLYNOM1:def 4;
reconsider D172 = D168 as (Element of D90) by L1065 , POLYNOM1:def 10;
reconsider D173 = D172 as (Polynomial of C227 , ( Polynom-Ring (C228 , C229) )) by L1052 , POLYNOM1:def 4;
L1066:
now
let C356 being (Element of ( Bags ( C227 +^ C228 ) ));
consider C357 being (Element of ( Bags C227 )), C358 being (Element of ( Bags C228 )), C359 being (Polynomial of C228 , C229) such that L1067: (C359 = ( D173 . C357 ) & C356 = ( C357 +^ C358 ) & ( ( Compress D173 ) . C356 ) = ( C359 . C358 )) by L282;
L1068: (ex B334 being Function st (B334 = ( D173 . C357 ) & (for B335 being (Element of ( Bags C228 )) holds (for B336 being (Element of ( Bags ( C227 +^ C228 ) )) holds (B336 = ( C357 +^ B335 ) implies ( B334 . B335 ) = ( D159 . B336 )))))) by L1051;
thus L1069: ( D159 . C356 ) = ( ( Compress D173 ) . C356 ) by L1068 , L1067;
end;
L1070: C336 = ( Compress D173 ) by L1066 , FUNCT_2:63
.= ( D95 . D172 ) by L755;
L1071: ( dom D95 ) = (the carrier of D90) by FUNCT_2:def 1;
thus L1072: thesis by L1071 , L1070 , FUNCT_1:3;
end;

end;
