:: Lattice of Substitutions
::  by Adam Grabowski
::
:: Received May 21, 1997
:: Copyright (c) 1997-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies SUBSET_1, FINSUB_1, PARTFUN1, FINSET_1, TARSKI, XBOOLE_0,
      NORMFORM, FUNCT_1, ORDINAL4, FUNCT_4, STRUCT_0, LATTICES, BINOP_1,
      EQREL_1, XXREAL_2, SUBSTLAT;
 notations TARSKI, XBOOLE_0, SUBSET_1, FINSET_1, FINSUB_1, BINOP_1, STRUCT_0,
      FUNCT_1, PARTFUN1, LATTICES, FUNCT_4;
 constructors BINOP_1, FUNCT_4, FINSUB_1, LATTICES, RELSET_1;
 registrations XBOOLE_0, RELSET_1, PARTFUN1, FINSET_1, FINSUB_1, LATTICES,
      FUNCT_1;
 requirements SUBSET, BOOLE;
 definitions TARSKI, LATTICES, XBOOLE_0;
 theorems ZFMISC_1, TARSKI, FINSUB_1, FINSET_1, FUNCT_4, PARTFUN1, BINOP_1,
      LATTICES, LATTICE2, XBOOLE_0, XBOOLE_1, RELSET_1;
 schemes FRAENKEL, BINOP_1;

begin
definition
let R1 being set;
let R2 being set;
func SubstitutionSet (R1 , R2) -> (Subset of ( Fin ( PFuncs (R1 , R2) ) )) equals 
{ B1 where B1 is (Element of ( Fin ( PFuncs (R1 , R2) ) )) : ((for B2 being set holds (B2 in B1 implies B2 is  finite)) & (for B3 , B4 being (Element of ( PFuncs (R1 , R2) )) holds ((B3 in B1 & B4 in B1 & B3 c= B4) implies B3 = B4))) };
coherence
proof
set D1 = { B5 where B5 is (Element of ( Fin ( PFuncs (R1 , R2) ) )) : ((for B6 being set holds (B6 in B5 implies B6 is  finite)) & (for B7 , B8 being (Element of ( PFuncs (R1 , R2) )) holds ((B7 in B5 & B8 in B5 & B7 c= B8) implies B7 = B8))) };
L1: D1 c= ( Fin ( PFuncs (R1 , R2) ) )
proof
let C1 being set;
assume L2: C1 in D1;
L3: (ex B9 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) st (B9 = C1 & (for B10 being set holds (B10 in B9 implies B10 is  finite)) & (for B11 , B12 being (Element of ( PFuncs (R1 , R2) )) holds ((B11 in B9 & B12 in B9 & B11 c= B12) implies B11 = B12)))) by L2;
thus L4: thesis by L3;
end;
thus L5: thesis by L1;
end;
end;
L7: (for R1 being set holds (for R2 being set holds (for B13 , B14 being set holds ((B14 in ( SubstitutionSet (R1 , R2) ) & B13 in B14) implies B13 is  finite))))
proof
let R1 being set;
let R2 being set;
let C2 , C3 being set;
assume that
L8: C3 in ( SubstitutionSet (R1 , R2) )
and
L9: C2 in C3;
L10: (ex B15 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) st (B15 = C3 & (for B16 being set holds (B16 in B15 implies B16 is  finite)) & (for B17 , B18 being (Element of ( PFuncs (R1 , R2) )) holds ((B17 in B15 & B18 in B15 & B17 c= B18) implies B17 = B18)))) by L8;
thus L11: thesis by L10 , L9;
end;
theorem
L12: (for R1 being set holds (for R2 being set holds ( {} ) in ( SubstitutionSet (R1 , R2) )))
proof
let R1 being set;
let R2 being set;
L13: ( {} ) c= ( PFuncs (R1 , R2) ) by XBOOLE_1:2;
L14: ( {} ) in ( Fin ( PFuncs (R1 , R2) ) ) by L13 , FINSUB_1:def 5;
L15: ((for B19 being set holds (B19 in ( {} ) implies B19 is  finite)) & (for B20 , B21 being (Element of ( PFuncs (R1 , R2) )) holds ((B20 in ( {} ) & B21 in ( {} ) & B20 c= B21) implies B20 = B21)));
thus L16: thesis by L15 , L14;
end;
theorem
L17: (for R1 being set holds (for R2 being set holds { ( {} ) } in ( SubstitutionSet (R1 , R2) )))
proof
let R1 being set;
let R2 being set;
L18: (for B22 , B23 being (Element of ( PFuncs (R1 , R2) )) holds ((B22 in { ( {} ) } & B23 in { ( {} ) } & B22 c= B23) implies B22 = B23))
proof
let C4 , C5 being (Element of ( PFuncs (R1 , R2) ));
assume that
L19: C4 in { ( {} ) }
and
L20: C5 in { ( {} ) }
and
L21: C4 c= C5;
L22: C4 = ( {} ) by L19 , TARSKI:def 1;
thus L23: thesis by L22 , L20 , TARSKI:def 1;
end;
L24: ( {} ) is (PartFunc of R1 , R2) by RELSET_1:12;
L25: ( {} ) in ( PFuncs (R1 , R2) ) by L24 , PARTFUN1:45;
L26: { ( {} ) } c= ( PFuncs (R1 , R2) ) by L25 , ZFMISC_1:31;
L27: { ( {} ) } in ( Fin ( PFuncs (R1 , R2) ) ) by L26 , FINSUB_1:def 5;
L28: (for B24 being set holds (B24 in { ( {} ) } implies B24 is  finite));
thus L29: thesis by L28 , L27 , L18;
end;
registration
let R1 being set;
let R2 being set;
cluster ( SubstitutionSet (R1 , R2) ) -> non  empty;
coherence by L17;
end;
definition
let R1 being set;
let R2 being set;
let C6 , C7 being (Element of ( SubstitutionSet (R1 , R2) ));
redefine func C6 \/ C7 -> (Element of ( Fin ( PFuncs (R1 , R2) ) ));

coherence
proof
L31: ( C6 \/ C7 ) in ( Fin ( PFuncs (R1 , R2) ) );
thus L32: thesis by L31;
end;
end;
registration
let R1 being set;
let R2 being set;
cluster non  empty for (Element of ( SubstitutionSet (R1 , R2) ));
existence
proof
L34: { ( {} ) } in ( SubstitutionSet (R1 , R2) ) by L17;
thus L35: thesis by L34;
end;
end;
registration
let R1 being set;
let R2 being set;
cluster  ->  finite for (Element of ( SubstitutionSet (R1 , R2) ));
coherence;
end;
definition
let R1 being set;
let R2 being set;
let C8 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
func mi C8 -> (Element of ( SubstitutionSet (R1 , R2) )) equals 
{ B25 where B25 is (Element of ( PFuncs (R1 , R2) )) : (B25 is  finite & (for B26 being (Element of ( PFuncs (R1 , R2) )) holds ((B26 in C8 & B26 c= B25) iff B26 = B25))) };
coherence
proof
set D2 = { B27 where B27 is (Element of ( PFuncs (R1 , R2) )) : (B27 is  finite & (for B28 being (Element of ( PFuncs (R1 , R2) )) holds ((B28 in C8 & B28 c= B27) iff B28 = B27))) };
L38: D2 c= ( PFuncs (R1 , R2) )
proof
let C9 being set;
assume L39: C9 in D2;
L40: (ex B29 being (Element of ( PFuncs (R1 , R2) )) st (C9 = B29 & B29 is  finite & (for B30 being (Element of ( PFuncs (R1 , R2) )) holds ((B30 in C8 & B30 c= B29) iff B30 = B29)))) by L39;
thus L41: thesis by L40;
end;
L42:
now
let C10 being set;
assume L43: C10 in D2;
L44: (ex B31 being (Element of ( PFuncs (R1 , R2) )) st (C10 = B31 & B31 is  finite & (for B32 being (Element of ( PFuncs (R1 , R2) )) holds ((B32 in C8 & B32 c= B31) iff B32 = B31)))) by L43;
thus L45: C10 in C8 by L44;
end;
L46: D2 c= C8 by L42 , TARSKI:def 3;
reconsider D3 = D2 as set;
reconsider D4 = D3 as (Element of ( Fin ( PFuncs (R1 , R2) ) )) by L38 , L46 , FINSUB_1:def 5;
L47: (for B33 being set holds (B33 in D4 implies B33 is  finite))
proof
let C11 being set;
assume L48: C11 in D4;
L49: (ex B34 being (Element of ( PFuncs (R1 , R2) )) st (C11 = B34 & B34 is  finite & (for B35 being (Element of ( PFuncs (R1 , R2) )) holds ((B35 in C8 & B35 c= B34) iff B35 = B34)))) by L48;
thus L50: thesis by L49;
end;
L51: (for B36 , B37 being (Element of ( PFuncs (R1 , R2) )) holds ((B36 in D4 & B37 in D4 & B36 c= B37) implies B36 = B37))
proof
let C12 , C13 being (Element of ( PFuncs (R1 , R2) ));
assume that
L52: (C12 in D4 & C13 in D4)
and
L53: C12 c= C13;
L54: (C12 in C8 & (ex B38 being (Element of ( PFuncs (R1 , R2) )) st (C13 = B38 & B38 is  finite & (for B39 being (Element of ( PFuncs (R1 , R2) )) holds ((B39 in C8 & B39 c= B38) iff B39 = B38))))) by L42 , L52;
thus L55: thesis by L54 , L53;
end;
L56: D3 in { B40 where B40 is (Element of ( Fin ( PFuncs (R1 , R2) ) )) : ((for B41 being set holds (B41 in B40 implies B41 is  finite)) & (for B42 , B43 being (Element of ( PFuncs (R1 , R2) )) holds ((B42 in B40 & B43 in B40 & B42 c= B43) implies B42 = B43))) } by L51 , L47;
thus L57: thesis by L56;
end;
end;
registration
let R1 being set;
let R2 being set;
cluster  ->  functional for (Element of ( SubstitutionSet (R1 , R2) ));
coherence
proof
let C14 being (Element of ( SubstitutionSet (R1 , R2) ));
L59: C14 c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
thus L60: thesis by L59;
end;
end;
definition
let R1 being set;
let R2 being set;
let C15 , C16 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
func C15 ^ C16 -> (Element of ( Fin ( PFuncs (R1 , R2) ) )) equals 
{ ( B44 \/ B45 ) where B44 , B45 is (Element of ( PFuncs (R1 , R2) )) : (B44 in C15 & B45 in C16 & B44 tolerates B45) };
coherence
proof
deffunc H1((Element of ( PFuncs (R1 , R2) )) , (Element of ( PFuncs (R1 , R2) ))) = ( $1 \/ $2 );
set D5 = { H1(B46 , B47) where B46 , B47 is (Element of ( PFuncs (R1 , R2) )) : (B46 in C15 & B47 in C16 & B46 tolerates B47) };
set D6 = { H1(B48 , B49) where B48 , B49 is (Element of ( PFuncs (R1 , R2) )) : (B48 in C15 & B49 in C16) };
L62: D5 c= D6
proof
let C17 being set;
assume L63: C17 in D5;
L64: (ex B50 , B51 being (Element of ( PFuncs (R1 , R2) )) st (C17 = ( B50 \/ B51 ) & B50 in C15 & B51 in C16 & B50 tolerates B51)) by L63;
thus L65: thesis by L64;
end;
L66: D5 c= ( PFuncs (R1 , R2) )
proof
let C18 being set;
assume L67: C18 in D5;
consider C19 , C20 being (Element of ( PFuncs (R1 , R2) )) such that L68: C18 = ( C19 \/ C20 ) and L69: C19 in C15 and L70: C20 in C16 and L71: C19 tolerates C20 by L67;
reconsider D7 = C19 , D8 = C20 as (PartFunc of R1 , R2) by PARTFUN1:47;
reconsider D9 = C19 , D10 = C20 as Function;
L72: (C19 is (PartFunc of R1 , R2) & C20 is (PartFunc of R1 , R2)) by PARTFUN1:47;
L73: ( D9 +* D10 ) is (PartFunc of R1 , R2) by L72 , FUNCT_4:40;
L74: ( D7 \/ D8 ) is (PartFunc of R1 , R2) by L73 , L71 , FUNCT_4:30;
thus L75: thesis by L74 , L68 , PARTFUN1:45;
end;
L76: C16 is  finite;
L77: C15 is  finite;
L78: D6 is  finite from FRAENKEL:sch 22(L77 , L76);
thus L79: thesis by L78 , L62 , L66 , FINSUB_1:def 5;
end;
end;
theorem
L81: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( R3 ^ R4 ) = ( R4 ^ R3 )))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
deffunc H2((Element of ( PFuncs (R1 , R2) )) , (Element of ( PFuncs (R1 , R2) ))) = ( $1 \/ $2 );
defpred S1[ Function , Function ] means ($1 in R3 & $2 in R4 & $1 tolerates $2);
defpred S2[ Function , Function ] means ($2 in R4 & $1 in R3 & $2 tolerates $1);
set D11 = { H2(B52 , B53) where B52 is (Element of ( PFuncs (R1 , R2) )) , B53 is (Element of ( PFuncs (R1 , R2) )) : S1[ B52 , B53 ] };
set D12 = { H2(B55 , B54) where B54 is (Element of ( PFuncs (R1 , R2) )) , B55 is (Element of ( PFuncs (R1 , R2) )) : S2[ B54 , B55 ] };
L82:
now
let C21 being set;
L83: (C21 in D12 iff (ex B56 , B57 being (Element of ( PFuncs (R1 , R2) )) st (C21 = H2(B57 , B56) & S2[ B56 , B57 ])));
L84: (C21 in D12 iff (ex B58 , B59 being (Element of ( PFuncs (R1 , R2) )) st (C21 = ( B58 \/ B59 ) & B58 in R4 & B59 in R3 & B58 tolerates B59))) by L83;
thus L85: (C21 in D12 iff C21 in { ( B60 \/ B61 ) where B60 is (Element of ( PFuncs (R1 , R2) )) , B61 is (Element of ( PFuncs (R1 , R2) )) : (B60 in R4 & B61 in R3 & B60 tolerates B61) }) by L84;
end;
L86: (for B62 , B63 being (Element of ( PFuncs (R1 , R2) )) holds H2(B62 , B63) = H2(B63 , B62));
L87: (for B64 , B65 being (Element of ( PFuncs (R1 , R2) )) holds (S1[ B64 , B65 ] iff S2[ B64 , B65 ]));
L88: D11 = D12 from FRAENKEL:sch 8(L87 , L86);
thus L89: thesis by L88 , L82 , TARSKI:1;
end;
theorem
L90: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (R4 = { ( {} ) } implies ( R3 ^ R4 ) = R3)))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L91: { ( B66 \/ B67 ) where B66 , B67 is (Element of ( PFuncs (R1 , R2) )) : (B66 in R3 & B67 in { ( {} ) } & B66 tolerates B67) } c= R3
proof
let C22 being set;
assume L92: C22 in { ( B68 \/ B69 ) where B68 , B69 is (Element of ( PFuncs (R1 , R2) )) : (B68 in R3 & B69 in { ( {} ) } & B68 tolerates B69) };
consider C23 , C24 being (Element of ( PFuncs (R1 , R2) )) such that L93: (C22 = ( C23 \/ C24 ) & C23 in R3) and L94: C24 in { ( {} ) } and L95: C23 tolerates C24 by L92;
L96: C24 = ( {} ) by L94 , TARSKI:def 1;
thus L97: thesis by L96 , L93;
end;
L98: R3 c= { ( B70 \/ B71 ) where B70 , B71 is (Element of ( PFuncs (R1 , R2) )) : (B70 in R3 & B71 in { ( {} ) } & B70 tolerates B71) }
proof
L99: ( {} ) is (PartFunc of R1 , R2) by RELSET_1:12;
reconsider D13 = ( {} ) as (Element of ( PFuncs (R1 , R2) )) by L99 , PARTFUN1:45;
let C25 being set;
assume L100: C25 in R3;
L101: R3 c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
reconsider D14 = C25 as (Element of ( PFuncs (R1 , R2) )) by L101 , L100;
L102: D13 in { ( {} ) } by TARSKI:def 1;
L103: (C25 = ( D14 \/ D13 ) & D14 tolerates D13) by PARTFUN1:59;
thus L104: thesis by L103 , L100 , L102;
end;
assume L105: R4 = { ( {} ) };
thus L106: thesis by L105 , L91 , L98 , XBOOLE_0:def 10;
end;
theorem
L107: (for R1 being set holds (for R2 being set holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for B72 , B73 being set holds ((R4 in ( SubstitutionSet (R1 , R2) ) & B72 in R4 & B73 in R4 & B72 c= B73) implies B72 = B73)))))
proof
let R1 being set;
let R2 being set;
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let C26 , C27 being set;
assume L108: R4 in ( SubstitutionSet (R1 , R2) );
L109: (ex B74 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) st (B74 = R4 & (for B75 being set holds (B75 in B74 implies B75 is  finite)) & (for B76 , B77 being (Element of ( PFuncs (R1 , R2) )) holds ((B76 in B74 & B77 in B74 & B76 c= B77) implies B76 = B77)))) by L108;
assume that
L110: (C26 in R4 & C27 in R4)
and
L111: C26 c= C27;
L112: R4 c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
reconsider D15 = C26 , D16 = C27 as (Element of ( PFuncs (R1 , R2) )) by L112 , L110;
L113: D15 = D16 by L109 , L110 , L111;
thus L114: thesis by L113;
end;
theorem
L115: (for R1 being set holds (for R2 being set holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for B78 being set holds (B78 in ( mi R4 ) implies (B78 in R4 & (for B79 being set holds ((B79 in R4 & B79 c= B78) implies B79 = B78))))))))
proof
let R1 being set;
let R2 being set;
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let C28 being set;
assume L116: C28 in ( mi R4 );
L117: (ex B80 being (Element of ( PFuncs (R1 , R2) )) st (C28 = B80 & B80 is  finite & (for B81 being (Element of ( PFuncs (R1 , R2) )) holds ((B81 in R4 & B81 c= B80) iff B81 = B80)))) by L116;
thus L118: C28 in R4 by L117;
let C29 being set;
assume that
L119: C29 in R4
and
L120: C29 c= C28;
L121: R4 c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
reconsider D17 = C29 as (Element of ( PFuncs (R1 , R2) )) by L121 , L119;
L122: D17 = C28 by L117 , L119 , L120;
thus L123: thesis by L122;
end;
L124: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ((for B82 being set holds (B82 in R3 implies B82 in R4)) implies R3 c= R4)))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
assume L125: (for B83 being set holds (B83 in R3 implies B83 in R4));
let C30 being set;
assume L126: C30 in R3;
thus L127: thesis by L126 , L125;
end;
registration
let R1 being set;
let R2 being set;
cluster  finite for (Element of ( PFuncs (R1 , R2) ));
existence
proof
L128: ( {} ) is (PartFunc of R1 , R2) by RELSET_1:12;
reconsider D18 = ( {} ) as (Element of ( PFuncs (R1 , R2) )) by L128 , PARTFUN1:45;
take D18;
thus L129: thesis;
end;
end;
theorem
L131: (for R1 being set holds (for R2 being set holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for B84 being  finite set holds ((B84 in R4 & (for B85 being  finite set holds ((B85 in R4 & B85 c= B84) implies B85 = B84))) implies B84 in ( mi R4 ))))))
proof
let R1 being set;
let R2 being set;
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let C31 being  finite set;
assume that
L132: C31 in R4
and
L133: (for B86 being  finite set holds ((B86 in R4 & B86 c= C31) implies B86 = C31));
L134: R4 c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
reconsider D19 = C31 as (Element of ( PFuncs (R1 , R2) )) by L134 , L132;
L135: (for R6 being (Element of ( PFuncs (R1 , R2) )) holds ((R6 in R4 & R6 c= C31) iff R6 = C31)) by L132 , L133;
L136: D19 in { B87 where B87 is (Element of ( PFuncs (R1 , R2) )) : (B87 is  finite & (for B88 being (Element of ( PFuncs (R1 , R2) )) holds ((B88 in R4 & B88 c= B87) iff B88 = B87))) } by L135;
thus L137: thesis by L136;
end;
theorem
L138: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( mi R3 ) c= R3)))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L139: (for B89 being set holds (B89 in ( mi R3 ) implies B89 in R3)) by L115;
thus L140: thesis by L139 , TARSKI:def 3;
end;
theorem
L141: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (R3 = ( {} ) implies ( mi R3 ) = ( {} ))))) by L138 , XBOOLE_1:3;
theorem
L142: (for R1 being set holds (for R2 being set holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for B90 being  finite set holds (B90 in R4 implies (ex B91 being set st (B91 c= B90 & B91 in ( mi R4 ))))))))
proof
let R1 being set;
let R2 being set;
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
defpred S3[ set , set ] means $1 c= $2;
let C32 being  finite set;
assume L143: C32 in R4;
L144: R4 c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
reconsider D20 = C32 as (Element of ( PFuncs (R1 , R2) )) by L144 , L143;
L145: (for B92 , B93 , B94 being (Element of ( PFuncs (R1 , R2) )) holds ((S3[ B92 , B93 ] & S3[ B93 , B94 ]) implies S3[ B92 , B94 ])) by XBOOLE_1:1;
L146: (for B95 being (Element of ( PFuncs (R1 , R2) )) holds S3[ B95 , B95 ]);
L147: (for B96 being (Element of ( PFuncs (R1 , R2) )) holds (B96 in R4 implies (ex B97 being (Element of ( PFuncs (R1 , R2) )) st (B97 in R4 & S3[ B97 , B96 ] & (for B98 being (Element of ( PFuncs (R1 , R2) )) holds ((B98 in R4 & S3[ B98 , B97 ]) implies S3[ B97 , B98 ])))))) from FRAENKEL:sch 23(L146 , L145);
consider C33 being (Element of ( PFuncs (R1 , R2) )) such that L148: C33 in R4 and L149: C33 c= D20 and L150: (for B99 being (Element of ( PFuncs (R1 , R2) )) holds ((B99 in R4 & B99 c= C33) implies C33 c= B99)) by L147 , L143;
take C33;
thus L151: C33 c= C32 by L149;
L152:
now
let C34 being  finite set;
assume that
L153: C34 in R4
and
L154: C34 c= C33;
reconsider D21 = C34 as (Element of ( PFuncs (R1 , R2) )) by L144 , L153;
L155: C33 c= D21 by L150 , L153 , L154;
thus L156: C34 = C33 by L155 , L154 , XBOOLE_0:def 10;
end;
thus L157: thesis by L152 , L148 , L149 , L131;
end;
theorem
L158: (for R1 being set holds (for R2 being set holds (for B100 being (Element of ( SubstitutionSet (R1 , R2) )) holds ( mi B100 ) = B100)))
proof
let R1 being set;
let R2 being set;
let C35 being (Element of ( SubstitutionSet (R1 , R2) ));
thus L159: ( mi C35 ) c= C35 by L138;
L160:
now
let C36 being set;
assume L161: C36 in C35;
L162: (C36 is  finite & (for B101 being  finite set holds ((B101 in C35 & B101 c= C36) implies B101 = C36))) by L161 , L7 , L107;
thus L163: C36 in ( mi C35 ) by L162 , L161 , L131;
end;
thus L164: thesis by L160 , L124;
end;
theorem
L165: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( mi ( R3 \/ R4 ) ) c= ( ( mi R3 ) \/ R4 )))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L166:
now
let C37 being set;
assume L167: C37 in ( mi ( R3 \/ R4 ) );
reconsider D22 = C37 as  finite set by L167 , L7;
L168: C37 in ( R3 \/ R4 ) by L167 , L115;
L169:
now
per cases  by L168 , XBOOLE_0:def 3;
suppose L170: C37 in R3;

L171:
now
let C38 being  finite set;
assume L172: C38 in R3;
L173: C38 in ( R3 \/ R4 ) by L172 , XBOOLE_0:def 3;
thus L174: (C38 c= C37 implies C38 = C37) by L173 , L167 , L115;
end;
L175: D22 in ( mi R3 ) by L171 , L170 , L131;
thus L176: C37 in ( ( mi R3 ) \/ R4 ) by L175 , XBOOLE_0:def 3;
end;
suppose L177: C37 in R4;

thus L178: C37 in ( ( mi R3 ) \/ R4 ) by L177 , XBOOLE_0:def 3;
end;
end;
thus L180: C37 in ( ( mi R3 ) \/ R4 ) by L169;
end;
thus L181: thesis by L166 , L124;
end;
theorem
L182: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( mi ( ( mi R3 ) \/ R4 ) ) = ( mi ( R3 \/ R4 ) )))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L183: ( ( mi R3 ) \/ R4 ) c= ( R3 \/ R4 ) by L138 , XBOOLE_1:9;
L184:
now
let C39 being set;
assume L185: C39 in ( mi ( ( mi R3 ) \/ R4 ) );
reconsider D23 = C39 as  finite set by L185 , L7;
L186:
now
let C40 being  finite set;
assume that
L187: C40 in ( R3 \/ R4 )
and
L188: C40 c= C39;
L189:
now
per cases  by L187 , XBOOLE_0:def 3;
suppose L190: C40 in R3;

consider C41 being set such that L191: C41 c= C40 and L192: C41 in ( mi R3 ) by L190 , L142;
L193: (C41 in ( ( mi R3 ) \/ R4 ) & C41 c= C39) by L188 , L191 , L192 , XBOOLE_0:def 3 , XBOOLE_1:1;
L194: C41 = C39 by L193 , L185 , L115;
thus L195: C40 = C39 by L194 , L188 , L191 , XBOOLE_0:def 10;
end;
suppose L196: C40 in R4;

L197: C40 in ( ( mi R3 ) \/ R4 ) by L196 , XBOOLE_0:def 3;
thus L198: C40 = C39 by L197 , L185 , L188 , L115;
end;
end;
thus L200: C40 = C39 by L189;
end;
L201: C39 in ( ( mi R3 ) \/ R4 ) by L185 , L115;
L202: D23 in ( mi ( R3 \/ R4 ) ) by L201 , L183 , L186 , L131;
thus L203: C39 in ( mi ( R3 \/ R4 ) ) by L202;
end;
thus L204: ( mi ( ( mi R3 ) \/ R4 ) ) c= ( mi ( R3 \/ R4 ) ) by L184 , L124;
L205: ( mi ( R3 \/ R4 ) ) c= ( ( mi R3 ) \/ R4 ) by L165;
L206:
now
let C42 being set;
assume L207: C42 in ( mi ( R3 \/ R4 ) );
reconsider D24 = C42 as  finite set by L207 , L7;
L208: (for B102 being  finite set holds (B102 in ( ( mi R3 ) \/ R4 ) implies (B102 c= C42 implies B102 = C42))) by L183 , L207 , L115;
L209: D24 in ( mi ( ( mi R3 ) \/ R4 ) ) by L208 , L205 , L207 , L131;
thus L210: C42 in ( mi ( ( mi R3 ) \/ R4 ) ) by L209;
end;
thus L211: thesis by L206 , L124;
end;
theorem
L212: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R5 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (R3 c= R4 implies ( R3 ^ R5 ) c= ( R4 ^ R5 )))))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R5 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
deffunc H3((Element of ( PFuncs (R1 , R2) )) , (Element of ( PFuncs (R1 , R2) ))) = ( $1 \/ $2 );
defpred S4[ Function , Function ] means ($1 in R3 & $2 in R5 & $1 tolerates $2);
defpred S5[ Function , Function ] means ($1 in R4 & $2 in R5 & $1 tolerates $2);
set D25 = { H3(B103 , B104) where B103 , B104 is (Element of ( PFuncs (R1 , R2) )) : S4[ B103 , B104 ] };
set D26 = { H3(B105 , B106) where B105 , B106 is (Element of ( PFuncs (R1 , R2) )) : S5[ B105 , B106 ] };
assume L213: R3 c= R4;
L214: (for B107 , B108 being (Element of ( PFuncs (R1 , R2) )) holds (S4[ B107 , B108 ] implies S5[ B107 , B108 ])) by L213;
L215: D25 c= D26 from FRAENKEL:sch 2(L214);
thus L216: thesis by L215;
end;
theorem
L217: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for B109 being set holds (B109 in ( R3 ^ R4 ) implies (ex B110 , B111 being set st (B110 in R3 & B111 in R4 & B109 = ( B110 \/ B111 )))))))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let C43 being set;
assume L218: C43 in ( R3 ^ R4 );
L219: (ex B112 , B113 being (Element of ( PFuncs (R1 , R2) )) st (C43 = ( B112 \/ B113 ) & B112 in R3 & B113 in R4 & B112 tolerates B113)) by L218;
thus L220: thesis by L219;
end;
theorem
L221: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for B114 , B115 being (Element of ( PFuncs (R1 , R2) )) holds ((B114 in R3 & B115 in R4 & B114 tolerates B115) implies ( B114 \/ B115 ) in ( R3 ^ R4 )))))));
L222: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for B116 being  finite set holds (B116 in ( R3 ^ R4 ) implies (ex B117 being  finite set st (B117 c= B116 & B117 in ( ( mi R3 ) ^ R4 )))))))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let C44 being  finite set;
assume L223: C44 in ( R3 ^ R4 );
consider C45 , C46 being (Element of ( PFuncs (R1 , R2) )) such that L224: C44 = ( C45 \/ C46 ) and L225: C45 in R3 and L226: C46 in R4 and L227: C45 tolerates C46 by L223;
L228: C45 is  finite by L224 , FINSET_1:1 , XBOOLE_1:7;
consider C47 being set such that L229: C47 c= C45 and L230: C47 in ( mi R3 ) by L228 , L225 , L142;
L231: ( mi R3 ) c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
reconsider D27 = C47 , D28 = C46 as (Element of ( PFuncs (R1 , R2) )) by L231 , L230;
reconsider D29 = C47 , D30 = C45 , D31 = C46 as (PartFunc of R1 , R2) by L230 , L231 , PARTFUN1:46;
L232: D29 c= D30 by L229;
L233: D27 tolerates D28 by L232 , L227 , PARTFUN1:58;
L234: ( D27 \/ D28 ) = ( D27 +* D28 ) by L233 , FUNCT_4:30;
reconsider D32 = ( D29 \/ D31 ) as (Element of ( PFuncs (R1 , R2) )) by L234 , PARTFUN1:45;
reconsider D33 = D32 as  finite set by L224 , L229 , FINSET_1:1 , XBOOLE_1:9;
take D33;
thus L235: D33 c= C44 by L224 , L229 , XBOOLE_1:9;
thus L236: thesis by L226 , L230 , L233;
end;
theorem
L237: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( mi ( R3 ^ R4 ) ) c= ( ( mi R3 ) ^ R4 )))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L238: ( ( mi R3 ) ^ R4 ) c= ( R3 ^ R4 ) by L138 , L212;
L239:
now
let C48 being set;
assume L240: C48 in ( mi ( R3 ^ R4 ) );
L241: (C48 in ( R3 ^ R4 ) & C48 is  finite) by L240 , L7 , L115;
L242: (ex B118 being  finite set st (B118 c= C48 & B118 in ( ( mi R3 ) ^ R4 ))) by L241 , L222;
thus L243: C48 in ( ( mi R3 ) ^ R4 ) by L242 , L238 , L240 , L115;
end;
thus L244: thesis by L239 , L124;
end;
theorem
L245: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R5 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (R3 c= R4 implies ( R5 ^ R3 ) c= ( R5 ^ R4 )))))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R5 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L246: (( R5 ^ R3 ) = ( R3 ^ R5 ) & ( R5 ^ R4 ) = ( R4 ^ R5 )) by L81;
thus L247: thesis by L246 , L212;
end;
theorem
L248: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( mi ( ( mi R3 ) ^ R4 ) ) = ( mi ( R3 ^ R4 ) )))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L249: ( ( mi R3 ) ^ R4 ) c= ( R3 ^ R4 ) by L138 , L212;
L250:
now
let C49 being set;
assume L251: C49 in ( mi ( ( mi R3 ) ^ R4 ) );
L252:
now
let C50 being  finite set;
assume L253: C50 in ( R3 ^ R4 );
consider C51 being  finite set such that L254: C51 c= C50 and L255: C51 in ( ( mi R3 ) ^ R4 ) by L253 , L222;
assume L256: C50 c= C49;
L257: C51 c= C49 by L256 , L254 , XBOOLE_1:1;
L258: C51 = C49 by L257 , L251 , L255 , L115;
thus L259: C50 = C49 by L258 , L254 , L256 , XBOOLE_0:def 10;
end;
L260: (C49 in ( ( mi R3 ) ^ R4 ) & C49 is  finite) by L251 , L7 , L115;
thus L261: C49 in ( mi ( R3 ^ R4 ) ) by L260 , L249 , L252 , L131;
end;
thus L262: ( mi ( ( mi R3 ) ^ R4 ) ) c= ( mi ( R3 ^ R4 ) ) by L250 , L124;
L263: ( mi ( R3 ^ R4 ) ) c= ( ( mi R3 ) ^ R4 ) by L237;
L264:
now
let C52 being set;
assume L265: C52 in ( mi ( R3 ^ R4 ) );
L266: (C52 is  finite & (for B119 being  finite set holds (B119 in ( ( mi R3 ) ^ R4 ) implies (B119 c= C52 implies B119 = C52)))) by L265 , L249 , L7 , L115;
thus L267: C52 in ( mi ( ( mi R3 ) ^ R4 ) ) by L266 , L263 , L265 , L131;
end;
thus L268: thesis by L264 , L124;
end;
theorem
L269: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( mi ( R3 ^ ( mi R4 ) ) ) = ( mi ( R3 ^ R4 ) )))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L270: (( R3 ^ ( mi R4 ) ) = ( ( mi R4 ) ^ R3 ) & ( R3 ^ R4 ) = ( R4 ^ R3 )) by L81;
thus L271: thesis by L270 , L248;
end;
theorem
L272: (for R1 being set holds (for R2 being set holds (for B120 , B121 , B122 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( B120 ^ ( B121 ^ B122 ) ) = ( ( B120 ^ B121 ) ^ B122 ))))
proof
let R1 being set;
let R2 being set;
let C53 , C54 , C55 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L273: (( C54 ^ C55 ) = ( C55 ^ C54 ) & ( C53 ^ C54 ) = ( C54 ^ C53 )) by L81;
L274:
now
let C56 , C57 , C58 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L275: (C56 c= ( PFuncs (R1 , R2) ) & C57 c= ( PFuncs (R1 , R2) )) by FINSUB_1:def 5;
L276: C58 c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
L277:
now
let C59 being set;
L278: ( C56 ^ ( C57 ^ C58 ) ) c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
assume L279: C59 in ( C56 ^ ( C57 ^ C58 ) );
consider C60 , C61 being set such that L280: C60 in C56 and L281: C61 in ( C57 ^ C58 ) and L282: C59 = ( C60 \/ C61 ) by L279 , L217;
L283: C61 c= ( C60 \/ C61 ) by XBOOLE_1:7;
consider C62 , C63 being set such that L284: C62 in C57 and L285: C63 in C58 and L286: C61 = ( C62 \/ C63 ) by L281 , L217;
reconsider D34 = C60 , D35 = C62 as (PartFunc of R1 , R2) by L275 , L280 , L284 , PARTFUN1:46;
reconsider D36 = C60 , D37 = C62 , D38 = C63 as (Element of ( PFuncs (R1 , R2) )) by L275 , L276 , L280 , L284 , L285;
L287: C62 c= C61 by L286 , XBOOLE_1:7;
L288: (C60 c= ( C60 \/ C61 ) & C62 c= ( C60 \/ C61 )) by L287 , L283 , XBOOLE_1:1 , XBOOLE_1:7;
L289: D36 tolerates D37 by L288 , L279 , L282 , L278 , PARTFUN1:57;
L290: ( D36 \/ D37 ) = ( D36 +* D37 ) by L289 , FUNCT_4:30;
L291: ( D34 \/ D35 ) is (PartFunc of R1 , R2) by L290;
reconsider D39 = ( D36 \/ D37 ) as (Element of ( PFuncs (R1 , R2) )) by L291 , PARTFUN1:45;
L292: (( C60 \/ ( C62 \/ C63 ) ) = ( ( C60 \/ C62 ) \/ C63 ) & D39 in ( C56 ^ C57 )) by L280 , L284 , L289 , XBOOLE_1:4;
L293: C63 c= C61 by L286 , XBOOLE_1:7;
L294: C63 c= ( C60 \/ C61 ) by L293 , L283 , XBOOLE_1:1;
L295: D39 c= ( C60 \/ C61 ) by L288 , XBOOLE_1:8;
L296: D39 tolerates D38 by L295 , L279 , L282 , L278 , L294 , PARTFUN1:57;
thus L297: C59 in ( ( C56 ^ C57 ) ^ C58 ) by L296 , L282 , L285 , L286 , L292;
end;
thus L298: ( C56 ^ ( C57 ^ C58 ) ) c= ( ( C56 ^ C57 ) ^ C58 ) by L277 , L124;
end;
L299: ( C53 ^ ( C54 ^ C55 ) ) c= ( ( C53 ^ C54 ) ^ C55 ) by L274;
L300: (( ( C53 ^ C54 ) ^ C55 ) = ( C55 ^ ( C53 ^ C54 ) ) & ( C53 ^ ( C54 ^ C55 ) ) = ( ( C54 ^ C55 ) ^ C53 )) by L81;
L301: ( ( C53 ^ C54 ) ^ C55 ) c= ( C53 ^ ( C54 ^ C55 ) ) by L300 , L273 , L274;
thus L302: thesis by L301 , L299 , XBOOLE_0:def 10;
end;
theorem
L303: (for R1 being set holds (for R2 being set holds (for B123 , B124 , B125 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( B123 ^ ( B124 \/ B125 ) ) = ( ( B123 ^ B124 ) \/ ( B123 ^ B125 ) ))))
proof
let R1 being set;
let R2 being set;
let C64 , C65 , C66 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L304:
now
let C67 being set;
assume L305: C67 in ( C64 ^ ( C65 \/ C66 ) );
consider C68 , C69 being set such that L306: C68 in C64 and L307: C69 in ( C65 \/ C66 ) and L308: C67 = ( C68 \/ C69 ) by L305 , L217;
L309: ( C64 ^ ( C65 \/ C66 ) ) c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
reconsider D40 = C67 as (Element of ( PFuncs (R1 , R2) )) by L309 , L305;
L310: (C64 c= ( PFuncs (R1 , R2) ) & ( C65 \/ C66 ) c= ( PFuncs (R1 , R2) )) by FINSUB_1:def 5;
reconsider D41 = C68 , D42 = C69 as (Element of ( PFuncs (R1 , R2) )) by L310 , L306 , L307;
L311: (D41 c= D40 & D42 c= D40) by L308 , XBOOLE_1:7;
L312: D41 tolerates D42 by L311 , PARTFUN1:57;
L313: (D42 in C65 or D42 in C66) by L307 , XBOOLE_0:def 3;
L314: (C67 in ( C64 ^ C65 ) or C67 in ( C64 ^ C66 )) by L313 , L306 , L308 , L312;
thus L315: C67 in ( ( C64 ^ C65 ) \/ ( C64 ^ C66 ) ) by L314 , XBOOLE_0:def 3;
end;
thus L316: ( C64 ^ ( C65 \/ C66 ) ) c= ( ( C64 ^ C65 ) \/ ( C64 ^ C66 ) ) by L304 , L124;
L317: (( C64 ^ C65 ) c= ( C64 ^ ( C65 \/ C66 ) ) & ( C64 ^ C66 ) c= ( C64 ^ ( C65 \/ C66 ) )) by L245 , XBOOLE_1:7;
thus L318: thesis by L317 , XBOOLE_1:8;
end;
L319: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds (for B126 being set holds (B126 in ( R3 ^ R4 ) implies (ex B127 being set st (B127 in R4 & B127 c= B126))))))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
let C70 being set;
assume L320: C70 in ( R3 ^ R4 );
consider C71 , C72 being set such that L321: C71 in R3 and L322: C72 in R4 and L323: C70 = ( C71 \/ C72 ) by L320 , L217;
take C72;
thus L324: C72 in R4 by L322;
thus L325: thesis by L323 , XBOOLE_1:7;
end;
L326: (for R1 being set holds (for R2 being set holds (for B128 , B129 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( mi ( ( B128 ^ B129 ) \/ B129 ) ) = ( mi B129 ))))
proof
let R1 being set;
let R2 being set;
let C73 , C74 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L327:
now
let C75 being set;
assume L328: C75 in ( mi ( ( C73 ^ C74 ) \/ C74 ) );
L329: C75 in ( ( C73 ^ C74 ) \/ C74 ) by L328 , L115;
L330: (C75 in ( C73 ^ C74 ) or C75 in C74) by L329 , XBOOLE_0:def 3;
L331:
now
let C76 being  finite set;
assume L332: C76 in C74;
L333: C76 in ( ( C73 ^ C74 ) \/ C74 ) by L332 , XBOOLE_0:def 3;
thus L334: (C76 c= C75 implies C76 = C75) by L333 , L328 , L115;
end;
L335:
now
assume L336: C75 in ( C73 ^ C74 );
consider C77 being set such that L337: C77 in C74 and L338: C77 c= C75 by L336 , L319;
L339: C77 in ( ( C73 ^ C74 ) \/ C74 ) by L337 , XBOOLE_0:def 3;
thus L340: C75 in C74 by L339 , L328 , L337 , L338 , L115;
end;
L341: C75 is  finite by L328 , L7;
thus L342: C75 in ( mi C74 ) by L341 , L330 , L335 , L331 , L131;
end;
thus L343: ( mi ( ( C73 ^ C74 ) \/ C74 ) ) c= ( mi C74 ) by L327 , L124;
L344:
now
let C78 being set;
assume L345: C78 in ( mi C74 );
L346: C78 in C74 by L345 , L115;
L347: C78 in ( ( C73 ^ C74 ) \/ C74 ) by L346 , XBOOLE_0:def 3;
L348:
now
let C79 being  finite set;
assume L349: C79 in ( ( C73 ^ C74 ) \/ C74 );
L350: (C79 in ( C73 ^ C74 ) or C79 in C74) by L349 , XBOOLE_0:def 3;
assume L351: C79 c= C78;
L352:
now
assume L353: C79 in ( C73 ^ C74 );
consider C80 being set such that L354: C80 in C74 and L355: C80 c= C79 by L353 , L319;
L356: C80 c= C78 by L351 , L355 , XBOOLE_1:1;
L357: C80 = C78 by L356 , L345 , L354 , L115;
thus L358: C79 in C74 by L357 , L346 , L351 , L355 , XBOOLE_0:def 10;
end;
thus L359: C79 = C78 by L352 , L345 , L350 , L351 , L115;
end;
L360: C78 is  finite by L345 , L7;
thus L361: C78 in ( mi ( ( C73 ^ C74 ) \/ C74 ) ) by L360 , L347 , L348 , L131;
end;
thus L362: thesis by L344 , L124;
end;
theorem
L363: (for R1 being set holds (for R2 being set holds (for R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds R4 c= ( R4 ^ R4 ))))
proof
let R1 being set;
let R2 being set;
let R4 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
L364:
now
let C81 being set;
assume L365: C81 in R4;
L366: R4 c= ( PFuncs (R1 , R2) ) by FINSUB_1:def 5;
reconsider D43 = C81 as (Element of ( PFuncs (R1 , R2) )) by L366 , L365;
L367: (C81 = ( C81 \/ C81 ) & D43 tolerates D43);
thus L368: C81 in ( R4 ^ R4 ) by L367 , L365;
end;
thus L369: thesis by L364 , L124;
end;
theorem
L370: (for R1 being set holds (for R2 being set holds (for R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) )) holds ( mi ( R3 ^ R3 ) ) = ( mi R3 ))))
proof
let R1 being set;
let R2 being set;
let R3 being (Element of ( Fin ( PFuncs (R1 , R2) ) ));
thus L371: ( mi ( R3 ^ R3 ) ) = ( mi ( ( R3 ^ R3 ) \/ R3 ) ) by L363 , XBOOLE_1:12
.= ( mi R3 ) by L326;
end;
theorem
L372: (for R1 being set holds (for R2 being set holds (for B130 being (Element of ( SubstitutionSet (R1 , R2) )) holds ( mi ( B130 ^ B130 ) ) = B130)))
proof
let R1 being set;
let R2 being set;
let C82 being (Element of ( SubstitutionSet (R1 , R2) ));
thus L373: ( mi ( C82 ^ C82 ) ) = ( mi C82 ) by L370
.= C82 by L158;
end;
begin
definition
let R1 being set;
let R2 being set;
func SubstLatt (R1 , R2) ->  strict LattStr means 
:L374: ((the carrier of it) = ( SubstitutionSet (R1 , R2) ) & (for B131 , B132 being (Element of ( SubstitutionSet (R1 , R2) )) holds (( (the L_join of it) . (B131 , B132) ) = ( mi ( B131 \/ B132 ) ) & ( (the L_meet of it) . (B131 , B132) ) = ( mi ( B131 ^ B132 ) ))));
existence
proof
deffunc H4((Element of ( SubstitutionSet (R1 , R2) )) , (Element of ( SubstitutionSet (R1 , R2) ))) = ( mi ( $1 \/ $2 ) );
consider C83 being (BinOp of ( SubstitutionSet (R1 , R2) )) such that L375: (for B133 , B134 being (Element of ( SubstitutionSet (R1 , R2) )) holds ( C83 . (B133 , B134) ) = H4(B133 , B134)) from BINOP_1:sch 4;
deffunc H5((Element of ( SubstitutionSet (R1 , R2) )) , (Element of ( SubstitutionSet (R1 , R2) ))) = ( mi ( $1 ^ $2 ) );
consider C84 being (BinOp of ( SubstitutionSet (R1 , R2) )) such that L376: (for B135 , B136 being (Element of ( SubstitutionSet (R1 , R2) )) holds ( C84 . (B135 , B136) ) = H5(B135 , B136)) from BINOP_1:sch 4;
take LattStr (# ( SubstitutionSet (R1 , R2) ) , C83 , C84 #);
thus L377: thesis by L375 , L376;
end;
uniqueness
proof
let C85 , C86 being  strict LattStr;
assume that
L378: (the carrier of C85) = ( SubstitutionSet (R1 , R2) )
and
L379: (for B137 , B138 being (Element of ( SubstitutionSet (R1 , R2) )) holds (( (the L_join of C85) . (B137 , B138) ) = ( mi ( B137 \/ B138 ) ) & ( (the L_meet of C85) . (B137 , B138) ) = ( mi ( B137 ^ B138 ) )))
and
L380: (the carrier of C86) = ( SubstitutionSet (R1 , R2) )
and
L381: (for B139 , B140 being (Element of ( SubstitutionSet (R1 , R2) )) holds (( (the L_join of C86) . (B139 , B140) ) = ( mi ( B139 \/ B140 ) ) & ( (the L_meet of C86) . (B139 , B140) ) = ( mi ( B139 ^ B140 ) )));
reconsider D44 = (the L_meet of C85) , D45 = (the L_meet of C86) , D46 = (the L_join of C85) , D47 = (the L_join of C86) as (BinOp of ( SubstitutionSet (R1 , R2) )) by L378 , L380;
L382:
now
let C87 , C88 being (Element of ( SubstitutionSet (R1 , R2) ));
thus L383: ( D46 . (C87 , C88) ) = ( mi ( C87 \/ C88 ) ) by L379
.= ( D47 . (C87 , C88) ) by L381;
end;
L384: D46 = D47 by L382 , BINOP_1:2;
L385:
now
let C89 , C90 being (Element of ( SubstitutionSet (R1 , R2) ));
thus L386: ( D44 . (C89 , C90) ) = ( mi ( C89 ^ C90 ) ) by L379
.= ( D45 . (C89 , C90) ) by L381;
end;
thus L387: thesis by L385 , L378 , L380 , L384 , BINOP_1:2;
end;
end;
registration
let R1 being set;
let R2 being set;
cluster ( SubstLatt (R1 , R2) ) -> non  empty;
coherence
proof
L389: (the carrier of ( SubstLatt (R1 , R2) )) = ( SubstitutionSet (R1 , R2) ) by L374;
thus L390: thesis by L389;
end;
end;
L392: (for R1 being set holds (for R2 being set holds (for B141 , B142 being (Element of ( SubstLatt (R1 , R2) )) holds ( B141 "\/" B142 ) = ( B142 "\/" B141 ))))
proof
let R1 being set;
let R2 being set;
set D48 = ( SubstLatt (R1 , R2) );
let C91 , C92 being (Element of D48);
reconsider D49 = C91 , D50 = C92 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
L393: ( C91 "\/" C92 ) = ( mi ( D50 \/ D49 ) ) by L374
.= ( C92 "\/" C91 ) by L374;
thus L394: thesis by L393;
end;
L395: (for R1 being set holds (for R2 being set holds (for B143 , B144 , B145 being (Element of ( SubstLatt (R1 , R2) )) holds ( B143 "\/" ( B144 "\/" B145 ) ) = ( ( B143 "\/" B144 ) "\/" B145 ))))
proof
let R1 being set;
let R2 being set;
let C93 , C94 , C95 being (Element of ( SubstLatt (R1 , R2) ));
reconsider D51 = C93 , D52 = C94 , D53 = C95 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
set D54 = ( SubstLatt (R1 , R2) );
L396: ( C93 "\/" ( C94 "\/" C95 ) ) = ( (the L_join of D54) . (C93 , ( mi ( D52 \/ D53 ) )) ) by L374
.= ( mi ( ( mi ( D52 \/ D53 ) ) \/ D51 ) ) by L374
.= ( mi ( D51 \/ ( D52 \/ D53 ) ) ) by L182
.= ( mi ( ( D51 \/ D52 ) \/ D53 ) ) by XBOOLE_1:4
.= ( mi ( ( mi ( D51 \/ D52 ) ) \/ D53 ) ) by L182
.= ( (the L_join of D54) . (( mi ( D51 \/ D52 ) ) , D53) ) by L374
.= ( ( C93 "\/" C94 ) "\/" C95 ) by L374;
thus L397: thesis by L396;
end;
L398: (for R1 being set holds (for R2 being set holds (for R7 being (Element of ( SubstitutionSet (R1 , R2) )) holds (for R8 being (Element of ( SubstitutionSet (R1 , R2) )) holds ( (the L_join of ( SubstLatt (R1 , R2) )) . (( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , R8) ) , R8) ) = R8))))
proof
let R1 being set;
let R2 being set;
let R7 being (Element of ( SubstitutionSet (R1 , R2) ));
let R8 being (Element of ( SubstitutionSet (R1 , R2) ));
thus L399: ( (the L_join of ( SubstLatt (R1 , R2) )) . (( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , R8) ) , R8) ) = ( (the L_join of ( SubstLatt (R1 , R2) )) . (( mi ( R7 ^ R8 ) ) , R8) ) by L374
.= ( mi ( ( mi ( R7 ^ R8 ) ) \/ R8 ) ) by L374
.= ( mi ( ( R7 ^ R8 ) \/ R8 ) ) by L182
.= ( mi R8 ) by L326
.= R8 by L158;
end;
L400: (for R1 being set holds (for R2 being set holds (for B146 , B147 being (Element of ( SubstLatt (R1 , R2) )) holds ( ( B146 "/\" B147 ) "\/" B147 ) = B147)))
proof
let R1 being set;
let R2 being set;
let C96 , C97 being (Element of ( SubstLatt (R1 , R2) ));
reconsider D55 = C96 , D56 = C97 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
set D57 = ( SubstLatt (R1 , R2) );
thus L401: ( ( C96 "/\" C97 ) "\/" C97 ) = ( (the L_join of D57) . (( (the L_meet of D57) . (D55 , D56) ) , D56) )
.= C97 by L398;
end;
L402: (for R1 being set holds (for R2 being set holds (for B148 , B149 being (Element of ( SubstLatt (R1 , R2) )) holds ( B148 "/\" B149 ) = ( B149 "/\" B148 ))))
proof
let R1 being set;
let R2 being set;
let C98 , C99 being (Element of ( SubstLatt (R1 , R2) ));
reconsider D58 = C98 , D59 = C99 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
L403: ( C98 "/\" C99 ) = ( mi ( D58 ^ D59 ) ) by L374
.= ( mi ( D59 ^ D58 ) ) by L81
.= ( C99 "/\" C98 ) by L374;
thus L404: thesis by L403;
end;
L405: (for R1 being set holds (for R2 being set holds (for B150 , B151 , B152 being (Element of ( SubstLatt (R1 , R2) )) holds ( B150 "/\" ( B151 "/\" B152 ) ) = ( ( B150 "/\" B151 ) "/\" B152 ))))
proof
let R1 being set;
let R2 being set;
let C100 , C101 , C102 being (Element of ( SubstLatt (R1 , R2) ));
reconsider D60 = C100 , D61 = C101 , D62 = C102 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
set D63 = ( SubstLatt (R1 , R2) );
L406: ( C100 "/\" ( C101 "/\" C102 ) ) = ( (the L_meet of D63) . (C100 , ( mi ( D61 ^ D62 ) )) ) by L374
.= ( mi ( D60 ^ ( mi ( D61 ^ D62 ) ) ) ) by L374
.= ( mi ( D60 ^ ( D61 ^ D62 ) ) ) by L269
.= ( mi ( ( D60 ^ D61 ) ^ D62 ) ) by L272
.= ( mi ( ( mi ( D60 ^ D61 ) ) ^ D62 ) ) by L248
.= ( (the L_meet of D63) . (( mi ( D60 ^ D61 ) ) , D62) ) by L374
.= ( ( C100 "/\" C101 ) "/\" C102 ) by L374;
thus L407: thesis by L406;
end;
L408: (for R1 being set holds (for R2 being set holds (for R7 being (Element of ( SubstitutionSet (R1 , R2) )) holds (for R8 being (Element of ( SubstitutionSet (R1 , R2) )) holds (for R9 being (Element of ( SubstitutionSet (R1 , R2) )) holds ( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , ( (the L_join of ( SubstLatt (R1 , R2) )) . (R8 , R9) )) ) = ( (the L_join of ( SubstLatt (R1 , R2) )) . (( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , R8) ) , ( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , R9) )) ))))))
proof
let R1 being set;
let R2 being set;
let R7 being (Element of ( SubstitutionSet (R1 , R2) ));
let R8 being (Element of ( SubstitutionSet (R1 , R2) ));
let R9 being (Element of ( SubstitutionSet (R1 , R2) ));
L409: ( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , R9) ) = ( mi ( R7 ^ R9 ) ) by L374;
L410: (( (the L_join of ( SubstLatt (R1 , R2) )) . (R8 , R9) ) = ( mi ( R8 \/ R9 ) ) & ( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , R8) ) = ( mi ( R7 ^ R8 ) )) by L374;
reconsider D64 = ( (the L_join of ( SubstLatt (R1 , R2) )) . (R8 , R9) ) , D65 = ( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , R8) ) , D66 = ( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , R9) ) as (Element of ( SubstitutionSet (R1 , R2) )) by L410 , L409;
L411: ( (the L_meet of ( SubstLatt (R1 , R2) )) . (R7 , ( (the L_join of ( SubstLatt (R1 , R2) )) . (R8 , R9) )) ) = ( mi ( R7 ^ D64 ) ) by L374
.= ( mi ( R7 ^ ( mi ( R8 \/ R9 ) ) ) ) by L374
.= ( mi ( R7 ^ ( R8 \/ R9 ) ) ) by L269
.= ( mi ( ( R7 ^ R8 ) \/ ( R7 ^ R9 ) ) ) by L303
.= ( mi ( ( mi ( R7 ^ R8 ) ) \/ ( R7 ^ R9 ) ) ) by L182
.= ( mi ( ( mi ( R7 ^ R8 ) ) \/ ( mi ( R7 ^ R9 ) ) ) ) by L182
.= ( mi ( D65 \/ ( mi ( R7 ^ R9 ) ) ) ) by L374
.= ( mi ( D65 \/ D66 ) ) by L374;
thus L412: thesis by L411 , L374;
end;
L413: (for R1 being set holds (for R2 being set holds (for B153 , B154 being (Element of ( SubstLatt (R1 , R2) )) holds ( B153 "/\" ( B153 "\/" B154 ) ) = B153)))
proof
let R1 being set;
let R2 being set;
let C103 , C104 being (Element of ( SubstLatt (R1 , R2) ));
reconsider D67 = C103 , D68 = C104 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
thus L414: ( C103 "/\" ( C103 "\/" C104 ) ) = ( (the L_join of ( SubstLatt (R1 , R2) )) . (( (the L_meet of ( SubstLatt (R1 , R2) )) . (D67 , D67) ) , ( (the L_meet of ( SubstLatt (R1 , R2) )) . (D67 , D68) )) ) by L408
.= ( (the L_join of ( SubstLatt (R1 , R2) )) . (( mi ( D67 ^ D67 ) ) , ( (the L_meet of ( SubstLatt (R1 , R2) )) . (D67 , D68) )) ) by L374
.= ( (the L_join of ( SubstLatt (R1 , R2) )) . (( mi D67 ) , ( (the L_meet of ( SubstLatt (R1 , R2) )) . (D67 , D68) )) ) by L370
.= ( C103 "\/" ( C103 "/\" C104 ) ) by L158
.= ( ( C103 "/\" C104 ) "\/" C103 ) by L392
.= ( ( C104 "/\" C103 ) "\/" C103 ) by L402
.= C103 by L400;
end;
registration
let R1 being set;
let R2 being set;
cluster ( SubstLatt (R1 , R2) ) ->  Lattice-like;
coherence
proof
set D69 = ( SubstLatt (R1 , R2) );
thus L415: (for B155 , B156 being (Element of D69) holds ( B155 "\/" B156 ) = ( B156 "\/" B155 )) by L392;
thus L416: (for B157 , B158 , B159 being (Element of D69) holds ( B157 "\/" ( B158 "\/" B159 ) ) = ( ( B157 "\/" B158 ) "\/" B159 )) by L395;
thus L417: (for B160 , B161 being (Element of D69) holds ( ( B160 "/\" B161 ) "\/" B161 ) = B161) by L400;
thus L418: (for B162 , B163 being (Element of D69) holds ( B162 "/\" B163 ) = ( B163 "/\" B162 )) by L402;
thus L419: (for B164 , B165 , B166 being (Element of D69) holds ( B164 "/\" ( B165 "/\" B166 ) ) = ( ( B164 "/\" B165 ) "/\" B166 )) by L405;
let C105 , C106 being (Element of D69);
thus L420: thesis by L413;
end;
end;
registration
let R1 being set;
let R2 being set;
cluster ( SubstLatt (R1 , R2) ) ->  distributive  bounded;
coherence
proof
thus L422: ( SubstLatt (R1 , R2) ) is  distributive
proof
let C107 , C108 , C109 being (Element of ( SubstLatt (R1 , R2) ));
reconsider D70 = C107 , D71 = C108 , D72 = C109 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
thus L423: ( C107 "/\" ( C108 "\/" C109 ) ) = ( (the L_meet of ( SubstLatt (R1 , R2) )) . (D70 , ( (the L_join of ( SubstLatt (R1 , R2) )) . (D71 , D72) )) )
.= ( ( C107 "/\" C108 ) "\/" ( C107 "/\" C109 ) ) by L408;
end;

L424: ( SubstLatt (R1 , R2) ) is  lower-bounded
proof
reconsider D73 = ( {} ) as (Element of ( SubstitutionSet (R1 , R2) )) by L12;
set D74 = ( SubstLatt (R1 , R2) );
reconsider D75 = D73 as (Element of D74) by L374;
take D75;
let C110 being (Element of D74);
reconsider D76 = C110 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
L425: ( D75 "\/" C110 ) = ( mi ( D73 \/ D76 ) ) by L374
.= C110 by L158;
L426: ( C110 "/\" D75 ) = D75 by L425 , LATTICES:def 9;
thus L427: thesis by L426 , L425 , LATTICES:def 9;
end;
L428: ( SubstLatt (R1 , R2) ) is  upper-bounded
proof
reconsider D77 = { ( {} ) } as (Element of ( SubstitutionSet (R1 , R2) )) by L17;
set D78 = ( SubstLatt (R1 , R2) );
reconsider D79 = D77 as (Element of D78) by L374;
take D79;
let C111 being (Element of D78);
reconsider D80 = C111 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
L429: ( D79 "/\" C111 ) = ( mi ( D77 ^ D80 ) ) by L374
.= ( mi ( D80 ^ D77 ) ) by L81
.= ( mi D80 ) by L90
.= C111 by L158;
L430: ( D79 "\/" C111 ) = D79 by L429 , LATTICES:def 8;
thus L431: thesis by L430 , L429 , LATTICES:def 8;
end;
thus L432: ( SubstLatt (R1 , R2) ) is  bounded by L428 , L424;
end;
end;
theorem
L434: (for R1 being set holds (for R2 being set holds ( Bottom ( SubstLatt (R1 , R2) ) ) = ( {} )))
proof
let R1 being set;
let R2 being set;
L435: ( {} ) in ( SubstitutionSet (R1 , R2) ) by L12;
reconsider D81 = ( {} ) as (Element of ( SubstLatt (R1 , R2) )) by L435 , L374;
L436:
now
let C112 being (Element of ( SubstLatt (R1 , R2) ));
reconsider D82 = D81 , D83 = C112 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
thus L437: ( D81 "\/" C112 ) = ( mi ( D82 \/ D83 ) ) by L374
.= C112 by L158;
end;
thus L438: thesis by L436 , LATTICE2:14;
end;
theorem
L439: (for R1 being set holds (for R2 being set holds ( Top ( SubstLatt (R1 , R2) ) ) = { ( {} ) }))
proof
let R1 being set;
let R2 being set;
L440: { ( {} ) } in ( SubstitutionSet (R1 , R2) ) by L17;
reconsider D84 = { ( {} ) } as (Element of ( SubstLatt (R1 , R2) )) by L440 , L374;
L441:
now
let C113 being (Element of ( SubstLatt (R1 , R2) ));
reconsider D85 = D84 , D86 = C113 as (Element of ( SubstitutionSet (R1 , R2) )) by L374;
thus L442: ( D84 "/\" C113 ) = ( mi ( D85 ^ D86 ) ) by L374
.= ( mi ( D86 ^ D85 ) ) by L81
.= ( mi D86 ) by L90
.= C113 by L158;
end;
thus L443: thesis by L441 , LATTICE2:16;
end;
