:: The Geometric Interior in Real Linear Spaces
::  by Karol P\c{a}k
::
:: Received February 9, 2010
:: Copyright (c) 2010-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies ARYTM_1, ARYTM_3, XBOOLE_0, CARD_1, CONVEX1, CONVEX2, CONVEX3,
      FINSEQ_1, FINSEQ_2, FINSEQ_4, FINSET_1, FUNCOP_1, FUNCT_1, FUNCT_2,
      FUNCT_4, MEMBERED, ORDERS_1, RELAT_1, RLVECT_1, RLVECT_2, RUSUB_4,
      SEMI_AF1, SETFAM_1, TARSKI, TOPS_1, RLAFFIN1, RLAFFIN2, ZFMISC_1, REAL_1,
      CARD_3, XXREAL_0, NAT_1, SUBSET_1, NUMBERS, ORDINAL1, STRUCT_0, SUPINF_2,
      ORDINAL4, VALUED_1, XREAL_0, PARTFUN1;
 notations TARSKI, XBOOLE_0, SUBSET_1, ZFMISC_1, ORDINAL1, NUMBERS, XCMPLX_0,
      XXREAL_0, ORDERS_1, CARD_1, XREAL_0, REAL_1, FINSET_1, SETFAM_1,
      DOMAIN_1, RELAT_1, FUNCT_1, PARTFUN1, FUNCT_2, RELSET_1, FINSEQ_1,
      STRUCT_0, FINSEQ_2, FINSEQOP, RVSUM_1, RLVECT_1, RLVECT_2, RUSUB_4,
      CONVEX1, CONVEX2, CONVEX3, RLAFFIN1, FUNCT_4, FUNCOP_1, MEMBERED,
      XXREAL_2;
 constructors BINOP_2, CONVEX1, CONVEX3, DOMAIN_1, FINSEQOP, REAL_1, RVSUM_1,
      RUSUB_5, SEQ_1, SETFAM_1, RLAFFIN1, SIMPLEX0, XXREAL_2, FUNCT_4,
      RELSET_1;
 registrations CARD_1, FINSET_1, FINSEQ_2, FUNCT_2, MEMBERED, NAT_1, NUMBERS,
      RELAT_1, RLVECT_1, STRUCT_0, SUBSET_1, VALUED_0, XCMPLX_0, XREAL_0,
      XXREAL_0, XBOOLE_0, RLAFFIN1, FUNCOP_1, SETFAM_1, XXREAL_2, ABIAN,
      RELSET_1, RLVECT_2, ORDINAL1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions ORDERS_1, RLVECT_2, TARSKI, XBOOLE_0;
 theorems SUBSET_1, CARD_1, CARD_2, CARD_FIN, CONVEX1, CONVEX3, FINSEQ_1,
      FINSEQ_2, FINSEQ_3, FINSEQ_4, FUNCOP_1, FUNCT_1, FUNCT_2, FUNCT_4, NAT_1,
      MEMBERED, PARTFUN1, RELAT_1, RLAFFIN1, RLTOPSP1, RUSUB_4, RLVECT_2,
      RLVECT_3, RLVECT_4, RVSUM_1, STIRL2_1, SIMPLEX0, TARSKI, WELLORD2,
      XBOOLE_0, XBOOLE_1, XCMPLX_1, XREAL_0, XREAL_1, XXREAL_0, XXREAL_2,
      ZFMISC_1, RLVECT_1;
 schemes FRAENKEL, FUNCT_2, NAT_1;

begin
L1: (for R3 being Real holds (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R8 being (VECTOR of R6) holds (for R9 being (VECTOR of R6) holds ((R3 <> 1 & ( ( R3 * R8 ) + ( ( 1 - R3 ) * R9 ) ) = R7) implies R9 = ( ( ( 1 / ( 1 - R3 ) ) * R7 ) + ( ( 1 - ( 1 / ( 1 - R3 ) ) ) * R8 ) )))))))
proof
let R3 being Real;
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R8 being (VECTOR of R6);
let R9 being (VECTOR of R6);
assume that
L2: R3 <> 1
and
L3: ( ( R3 * R8 ) + ( ( 1 - R3 ) * R9 ) ) = R7;
L4: ( ( 1 - R3 ) * R9 ) = ( R7 - ( R3 * R8 ) ) by L3 , RLVECT_4:1;
L5: ( 1 - R3 ) <> ( 1 - 1 ) by L2;
L6: ( ( 1 / ( 1 - R3 ) ) * ( 1 - R3 ) ) = 1 by L5 , XCMPLX_1:106;
L7: ( ( 1 / ( 1 - R3 ) ) * ( R3 * R8 ) ) = ( ( ( 1 / ( 1 - R3 ) ) * R3 ) * R8 ) by RLVECT_1:def 7
.= ( ( ( 1 - ( 1 - R3 ) ) / ( 1 - R3 ) ) * R8 ) by XCMPLX_1:99
.= ( ( ( 1 / ( 1 - R3 ) ) - ( ( 1 - R3 ) / ( 1 - R3 ) ) ) * R8 ) by XCMPLX_1:120
.= ( ( ( 1 / ( 1 - R3 ) ) - 1 ) * R8 ) by L5 , XCMPLX_1:60;
thus L8: R9 = ( 1 * R9 ) by RLVECT_1:def 8
.= ( ( 1 / ( 1 - R3 ) ) * ( ( 1 - R3 ) * R9 ) ) by L6 , RLVECT_1:def 7
.= ( ( ( 1 / ( 1 - R3 ) ) * R7 ) - ( ( 1 / ( 1 - R3 ) ) * ( R3 * R8 ) ) ) by L4 , RLVECT_1:34
.= ( ( ( 1 / ( 1 - R3 ) ) * R7 ) + ( - ( ( ( 1 / ( 1 - R3 ) ) - 1 ) * R8 ) ) ) by L7 , RLVECT_1:def 11
.= ( ( ( 1 / ( 1 - R3 ) ) * R7 ) + ( ( ( 1 / ( 1 - R3 ) ) - 1 ) * ( - R8 ) ) ) by RLVECT_1:25
.= ( ( ( 1 / ( 1 - R3 ) ) * R7 ) + ( ( - ( ( 1 / ( 1 - R3 ) ) - 1 ) ) * R8 ) ) by RLVECT_1:24
.= ( ( ( 1 / ( 1 - R3 ) ) * R7 ) + ( ( 1 - ( 1 / ( 1 - R3 ) ) ) * R8 ) );
end;
theorem
L9: (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R11 being (Subset of R6) holds (for B1 being (Linear_Combination of R11) holds ((B1 is  convex & R7 <> ( Sum B1 ) & ( B1 . R7 ) <> ( 0 )) implies (ex R10 being (VECTOR of R6) st (R10 in ( conv ( R11 \ { R7 } ) ) & ( Sum B1 ) = ( ( ( B1 . R7 ) * R7 ) + ( ( 1 - ( B1 . R7 ) ) * R10 ) ) & ( ( ( 1 / ( B1 . R7 ) ) * ( Sum B1 ) ) + ( ( 1 - ( 1 / ( B1 . R7 ) ) ) * R10 ) ) = R7)))))))
proof
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R11 being (Subset of R6);
let C1 being (Linear_Combination of R11);
assume that
L10: C1 is  convex
and
L11: R7 <> ( Sum C1 )
and
L12: ( C1 . R7 ) <> ( 0 );
set D1 = ( C1 . R7 );
set D2 = ( 1 - ( C1 . R7 ) );
L13: ( Carrier C1 ) c= R11 by RLVECT_2:def 6;
L14: ( Carrier C1 ) <> ( {} ) by L10 , CONVEX1:21;
reconsider D3 = R11 as non  empty (Subset of R6) by L14 , L13;
consider C2 being (Linear_Combination of { R7 }) such that L15: ( C2 . R7 ) = D1 by RLVECT_4:37;
L16: D1 <> 1
proof
assume L17: D1 = 1;
L18: ( Carrier C1 ) = { R7 } by L17 , L10 , RLAFFIN1:64;
L19: ( Sum C1 ) = ( 1 * R7 ) by L18 , L17 , RLVECT_2:35
.= R7 by RLVECT_1:def 8;
thus L20: contradiction by L19 , L11;
end;
L21: D1 <= 1 by L10 , RLAFFIN1:63;
L22: D1 < 1 by L21 , L16 , XXREAL_0:1;
L23: D2 > ( 1 - 1 ) by L22 , XREAL_1:10;
L24: R7 in ( Carrier C1 ) by L12;
L25: { R7 } c= D3 by L24 , L13 , ZFMISC_1:31;
L26: C2 is (Linear_Combination of D3) by L25 , RLVECT_2:21;
reconsider D4 = ( C1 - C2 ) as (Linear_Combination of D3) by L26 , RLVECT_2:56;
L27: ( ( 1 / D2 ) * D4 ) is (Linear_Combination of R11) by RLVECT_2:44;
L28: ( Carrier ( ( 1 / D2 ) * D4 ) ) c= D3 by L27 , RLVECT_2:def 6;
L29: ( D4 . R7 ) = ( D1 - D1 ) by L15 , RLVECT_2:54;
L30: ( ( ( 1 / D2 ) * D4 ) . R7 ) = ( ( 1 / D2 ) * ( D1 - D1 ) ) by L29 , RLVECT_2:def 11;
L31: (not R7 in ( Carrier ( ( 1 / D2 ) * D4 ) )) by L30 , RLVECT_2:19;
L32: ( Carrier ( ( 1 / D2 ) * D4 ) ) c= ( R11 \ { R7 } ) by L31 , L28 , ZFMISC_1:34;
L33: ( Carrier C2 ) c= { R7 } by RLVECT_2:def 6;
L34: (for B2 being (Element of R6) holds ( ( ( 1 / D2 ) * D4 ) . B2 ) >= ( 0 ))
proof
let C3 being (Element of R6);
L35: ( ( ( 1 / D2 ) * D4 ) . C3 ) = ( ( 1 / D2 ) * ( D4 . C3 ) ) by RLVECT_2:def 11
.= ( ( 1 / D2 ) * ( ( C1 . C3 ) - ( C2 . C3 ) ) ) by RLVECT_2:54;
per cases ;
suppose L36: C3 = R7;

thus L37: thesis by L36 , L30;
end;
suppose L38: C3 <> R7;

L39: (not C3 in ( Carrier C2 )) by L38 , L33 , TARSKI:def 1;
L40: ( C2 . C3 ) = ( 0 ) by L39;
L41: ( C1 . C3 ) >= ( 0 ) by L10 , RLAFFIN1:62;
thus L42: thesis by L41 , L23 , L35 , L40;
end;
end;
L44: ( sum D4 ) = ( ( sum C1 ) - ( sum C2 ) ) by RLAFFIN1:36
.= ( ( sum C1 ) - D1 ) by L15 , L33 , RLAFFIN1:32
.= D2 by L10 , RLAFFIN1:62;
L45: ( sum ( ( 1 / D2 ) * D4 ) ) = ( ( 1 / D2 ) * D2 ) by L44 , RLAFFIN1:35
.= 1 by L23 , XCMPLX_1:106;
L46: ( ( 1 / D2 ) * D4 ) is  convex by L45 , L34 , RLAFFIN1:62;
L47: ( Carrier ( ( 1 / D2 ) * D4 ) ) <> ( {} ) by L46 , CONVEX1:21;
reconsider D5 = ( R11 \ { R7 } ) as non  empty (Subset of R6) by L47 , L32;
reconsider D6 = ( ( 1 / D2 ) * D4 ) as (Convex_Combination of D5) by L32 , L34 , L45 , RLAFFIN1:62 , RLVECT_2:def 6;
take D7 = ( Sum D6 );
L48: D6 in ( ConvexComb R6 ) by CONVEX3:def 1;
L49: D7 in { ( Sum B3 ) where B3 is (Convex_Combination of D5) : B3 in ( ConvexComb R6 ) } by L48;
thus L50: D7 in ( conv ( R11 \ { R7 } ) ) by L49 , CONVEX3:5;
L51: ( Sum D4 ) = ( ( Sum C1 ) - ( Sum C2 ) ) by RLVECT_3:4
.= ( ( Sum C1 ) - ( D1 * R7 ) ) by L15 , RLVECT_2:32;
L52: ( D2 * D7 ) = ( D2 * ( ( 1 / D2 ) * ( ( Sum C1 ) - ( D1 * R7 ) ) ) ) by L51 , RLVECT_3:2
.= ( ( D2 * ( 1 / D2 ) ) * ( ( Sum C1 ) - ( D1 * R7 ) ) ) by RLVECT_1:def 7
.= ( 1 * ( ( Sum C1 ) - ( D1 * R7 ) ) ) by L23 , XCMPLX_1:106
.= ( ( Sum C1 ) - ( D1 * R7 ) ) by RLVECT_1:def 8;
thus L53: ( Sum C1 ) = ( ( D1 * R7 ) + ( D2 * D7 ) ) by L52 , RLVECT_4:1;
L54: ( 1 - ( 1 / D1 ) ) = ( ( D1 / D1 ) - ( 1 / D1 ) ) by L12 , XCMPLX_1:60
.= ( ( D1 - 1 ) / D1 ) by XCMPLX_1:120
.= ( ( - D2 ) / D1 )
.= ( - ( D2 / D1 ) ) by XCMPLX_1:187;
L55: ( ( 1 - ( 1 / D1 ) ) * ( Sum D6 ) ) = ( ( - ( D2 / D1 ) ) * ( ( 1 / D2 ) * ( ( Sum C1 ) - ( D1 * R7 ) ) ) ) by L54 , L51 , RLVECT_3:2
.= ( ( ( - ( D2 / D1 ) ) * ( 1 / D2 ) ) * ( ( Sum C1 ) - ( D1 * R7 ) ) ) by RLVECT_1:def 7
.= ( ( - ( ( D2 / D1 ) * ( 1 / D2 ) ) ) * ( ( Sum C1 ) - ( D1 * R7 ) ) )
.= ( ( - ( ( D2 / D2 ) * ( 1 / D1 ) ) ) * ( ( Sum C1 ) - ( D1 * R7 ) ) ) by XCMPLX_1:85
.= ( ( - ( 1 * ( 1 / D1 ) ) ) * ( ( Sum C1 ) - ( D1 * R7 ) ) ) by L23 , XCMPLX_1:60
.= ( ( ( - ( 1 / D1 ) ) * ( Sum C1 ) ) - ( ( - ( 1 / D1 ) ) * ( D1 * R7 ) ) ) by RLVECT_1:34
.= ( ( ( - ( 1 / D1 ) ) * ( Sum C1 ) ) + ( - ( ( - ( 1 / D1 ) ) * ( D1 * R7 ) ) ) ) by RLVECT_1:def 11
.= ( ( ( - ( 1 / D1 ) ) * ( Sum C1 ) ) + ( ( - ( - ( 1 / D1 ) ) ) * ( D1 * R7 ) ) ) by RLVECT_4:3
.= ( ( ( - ( 1 / D1 ) ) * ( Sum C1 ) ) + ( ( ( 1 / D1 ) * D1 ) * R7 ) ) by RLVECT_1:def 7
.= ( ( ( - ( 1 / D1 ) ) * ( Sum C1 ) ) + ( 1 * R7 ) ) by L12 , XCMPLX_1:106
.= ( ( ( - ( 1 / D1 ) ) * ( Sum C1 ) ) + R7 ) by RLVECT_1:def 8
.= ( ( - ( ( 1 / D1 ) * ( Sum C1 ) ) ) + R7 ) by RLVECT_4:3;
thus L56: ( ( ( 1 / D1 ) * ( Sum C1 ) ) + ( ( 1 - ( 1 / D1 ) ) * D7 ) ) = ( ( ( ( 1 / D1 ) * ( Sum C1 ) ) + ( - ( ( 1 / D1 ) * ( Sum C1 ) ) ) ) + R7 ) by L55 , RLVECT_1:def 3
.= ( ( ( ( 1 / D1 ) * ( Sum C1 ) ) - ( ( 1 / D1 ) * ( Sum C1 ) ) ) + R7 ) by RLVECT_1:def 11
.= R7 by RLVECT_4:1;
end;
theorem
L57: (for R3 being Real holds (for R4 being Real holds (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R8 being (VECTOR of R6) holds (for R14 being  affinely-independent (Subset of R6) holds (for B4 , B5 , B6 , B7 being (Element of R6) holds ((R7 in ( conv R14 ) & R8 in ( conv R14 ) & (not R8 in ( conv ( R14 \ { B4 } ) )) & (not R8 in ( conv ( R14 \ { B5 } ) )) & B6 in ( conv ( R14 \ { B4 } ) ) & B7 in ( conv ( R14 \ { B5 } ) ) & ( ( R3 * R8 ) + ( ( 1 - R3 ) * B6 ) ) = R7 & ( ( R4 * R8 ) + ( ( 1 - R4 ) * B7 ) ) = R7 & R3 < 1 & R4 < 1) implies (B6 = B7 & R3 = R4)))))))))
proof
let R3 being Real;
let R4 being Real;
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R8 being (VECTOR of R6);
let R14 being  affinely-independent (Subset of R6);
let C4 , C5 , C6 , C7 being (Element of R6);
assume that
L58: R7 in ( conv R14 )
and
L59: R8 in ( conv R14 )
and
L60: (not R8 in ( conv ( R14 \ { C4 } ) ))
and
L61: (not R8 in ( conv ( R14 \ { C5 } ) ))
and
L62: C6 in ( conv ( R14 \ { C4 } ) )
and
L63: C7 in ( conv ( R14 \ { C5 } ) )
and
L64: ( ( R3 * R8 ) + ( ( 1 - R3 ) * C6 ) ) = R7
and
L65: ( ( R4 * R8 ) + ( ( 1 - R4 ) * C7 ) ) = R7
and
L66: R3 < 1
and
L67: R4 < 1;
set D8 = ( R8 |-- R14 );
set D9 = ( R7 |-- R14 );
set D10 = ( C6 |-- R14 );
set D11 = ( C7 |-- R14 );
L68: ( conv R14 ) c= ( Affin R14 ) by RLAFFIN1:65;
L69: ( D8 . C5 ) > ( 0 )
proof
assume L70: ( D8 . C5 ) <= ( 0 );
L71: ( D8 . C5 ) >= ( 0 ) by L59 , RLAFFIN1:71;
L72: (for R2 being set holds (R2 in { C5 } implies ( D8 . R2 ) = ( 0 ))) by L71 , L70 , TARSKI:def 1;
thus L73: contradiction by L72 , L59 , L61 , RLAFFIN1:76;
end;
L74: ( conv ( R14 \ { C5 } ) ) c= ( Affin ( R14 \ { C5 } ) ) by RLAFFIN1:65;
L75: D11 = ( C7 |-- ( R14 \ { C5 } ) ) by L74 , L63 , RLAFFIN1:77 , XBOOLE_1:36;
L76: ( Carrier D11 ) c= ( R14 \ { C5 } ) by L75 , RLVECT_2:def 6;
L77: (not C5 in ( Carrier D11 )) by L76 , ZFMISC_1:56;
L78: ( D11 . C5 ) = ( 0 ) by L77;
L79: ( D8 . C4 ) > ( 0 )
proof
assume L80: ( D8 . C4 ) <= ( 0 );
L81: ( D8 . C4 ) >= ( 0 ) by L59 , RLAFFIN1:71;
L82: (for R2 being set holds (R2 in { C4 } implies ( D8 . R2 ) = ( 0 ))) by L81 , L80 , TARSKI:def 1;
thus L83: contradiction by L82 , L59 , L60 , RLAFFIN1:76;
end;
L84: ( conv ( R14 \ { C4 } ) ) c= ( Affin ( R14 \ { C4 } ) ) by RLAFFIN1:65;
L85: D10 = ( C6 |-- ( R14 \ { C4 } ) ) by L84 , L62 , RLAFFIN1:77 , XBOOLE_1:36;
L86: ( Carrier D10 ) c= ( R14 \ { C4 } ) by L85 , RLVECT_2:def 6;
L87: (not C4 in ( Carrier D10 )) by L86 , ZFMISC_1:56;
L88: ( D10 . C4 ) = ( 0 ) by L87;
L89: ( conv ( R14 \ { C5 } ) ) c= ( conv R14 ) by RLAFFIN1:3 , XBOOLE_1:36;
L90: C7 in ( conv R14 ) by L89 , L63;
L91: ( ( R4 * D8 ) + ( ( 1 - R4 ) * D11 ) ) = D9 by L90 , L59 , L65 , L68 , RLAFFIN1:70;
L92: ( D9 . C5 ) = ( ( ( R4 * D8 ) . C5 ) + ( ( ( 1 - R4 ) * D11 ) . C5 ) ) by L91 , RLVECT_2:def 10
.= ( ( R4 * ( D8 . C5 ) ) + ( ( ( 1 - R4 ) * D11 ) . C5 ) ) by RLVECT_2:def 11
.= ( ( R4 * ( D8 . C5 ) ) + ( ( 1 - R4 ) * ( D11 . C5 ) ) ) by RLVECT_2:def 11
.= ( R4 * ( D8 . C5 ) ) by L78;
L93: ( D9 . C5 ) < ( 1 * ( D8 . C5 ) ) by L92 , L67 , L69 , XREAL_1:68;
L94: ( ( D8 . C5 ) - ( D9 . C5 ) ) >= ( ( D9 . C5 ) - ( D9 . C5 ) ) by L93 , XREAL_1:9;
L95: ( conv ( R14 \ { C4 } ) ) c= ( conv R14 ) by RLAFFIN1:3 , XBOOLE_1:36;
L96: ( D10 . C5 ) >= ( 0 ) by L95 , L62 , RLAFFIN1:71;
L97: ( ( 1 / ( 1 - R4 ) ) - ( 0 ) ) >= ( ( 1 / ( 1 - R4 ) ) - ( ( D10 . C5 ) / ( ( D8 . C5 ) - ( D9 . C5 ) ) ) ) by L96 , L94 , XREAL_1:10;
L98: C6 in ( conv R14 ) by L62 , L95;
L99: D9 = ( ( R3 * D8 ) + ( ( 1 - R3 ) * D10 ) ) by L98 , L59 , L64 , L68 , RLAFFIN1:70;
L100: ( D9 . C4 ) = ( ( ( R3 * D8 ) . C4 ) + ( ( ( 1 - R3 ) * D10 ) . C4 ) ) by L99 , RLVECT_2:def 10
.= ( ( R3 * ( D8 . C4 ) ) + ( ( ( 1 - R3 ) * D10 ) . C4 ) ) by RLVECT_2:def 11
.= ( ( R3 * ( D8 . C4 ) ) + ( ( 1 - R3 ) * ( D10 . C4 ) ) ) by RLVECT_2:def 11
.= ( R3 * ( D8 . C4 ) ) by L88;
L101: ( D9 . C4 ) < ( 1 * ( D8 . C4 ) ) by L100 , L66 , L79 , XREAL_1:68;
L102: ( ( D8 . C4 ) - ( D9 . C4 ) ) >= ( ( D9 . C4 ) - ( D9 . C4 ) ) by L101 , XREAL_1:9;
L103: C7 = ( ( ( 1 / ( 1 - R4 ) ) * R7 ) + ( ( 1 - ( 1 / ( 1 - R4 ) ) ) * R8 ) ) by L65 , L67 , L1;
L104: D11 = ( ( ( 1 / ( 1 - R4 ) ) * D9 ) + ( ( 1 - ( 1 / ( 1 - R4 ) ) ) * D8 ) ) by L103 , L58 , L59 , L68 , RLAFFIN1:70;
L105: ( 1 / ( 1 - R4 ) ) = ( ( ( D8 . C5 ) - ( 0 ) ) / ( ( D8 . C5 ) - ( D9 . C5 ) ) ) by L104 , L78 , L93 , RLAFFIN1:81;
L106: C6 = ( ( ( 1 / ( 1 - R3 ) ) * R7 ) + ( ( 1 - ( 1 / ( 1 - R3 ) ) ) * R8 ) ) by L64 , L66 , L1;
L107: D10 = ( ( ( 1 / ( 1 - R3 ) ) * D9 ) + ( ( 1 - ( 1 / ( 1 - R3 ) ) ) * D8 ) ) by L106 , L58 , L59 , L68 , RLAFFIN1:70;
L108: ( 1 / ( 1 - R3 ) ) = ( ( ( D8 . C5 ) - ( D10 . C5 ) ) / ( ( D8 . C5 ) - ( D9 . C5 ) ) ) by L107 , L93 , RLAFFIN1:81
.= ( ( 1 / ( 1 - R4 ) ) - ( ( D10 . C5 ) / ( ( D8 . C5 ) - ( D9 . C5 ) ) ) ) by L105 , XCMPLX_1:120;
L109: ( D11 . C4 ) >= ( 0 ) by L63 , L89 , RLAFFIN1:71;
L110: ( ( 1 / ( 1 - R3 ) ) - ( 0 ) ) >= ( ( 1 / ( 1 - R3 ) ) - ( ( D11 . C4 ) / ( ( D8 . C4 ) - ( D9 . C4 ) ) ) ) by L109 , L102 , XREAL_1:10;
L111: ( 1 / ( 1 - R3 ) ) = ( ( ( D8 . C4 ) - ( 0 ) ) / ( ( D8 . C4 ) - ( D9 . C4 ) ) ) by L88 , L101 , L107 , RLAFFIN1:81;
L112: ( 1 / ( 1 - R4 ) ) = ( ( ( D8 . C4 ) - ( D11 . C4 ) ) / ( ( D8 . C4 ) - ( D9 . C4 ) ) ) by L101 , L104 , RLAFFIN1:81
.= ( ( 1 / ( 1 - R3 ) ) - ( ( D11 . C4 ) / ( ( D8 . C4 ) - ( D9 . C4 ) ) ) ) by L111 , XCMPLX_1:120;
L113: ( 1 - R3 ) = ( 1 - R4 ) by L112 , L110 , L97 , L108 , XCMPLX_1:59 , XXREAL_0:1;
thus L114: thesis by L113 , L65 , L67 , L106 , L1;
end;
theorem
L115: (for R6 being RealLinearSpace holds (for R13 being  finite (Subset of R6) holds (for R15 being  finite  affinely-independent (Subset of R6) holds (for B8 being (Linear_Combination of R13) holds ((R13 c= ( conv R15 ) & ( sum B8 ) = 1) implies (( Sum B8 ) in ( Affin R15 ) & (for B9 being (Element of R6) holds (ex B10 being (FinSequence of ( REAL )) st (ex B11 being (FinSequence of R6) st (( ( ( Sum B8 ) |-- R15 ) . B9 ) = ( Sum B10 ) & ( len B11 ) = ( len B10 ) & B11 is  one-to-one & ( rng B11 ) = ( Carrier B8 ) & (for R5 being Nat holds (R5 in ( dom B10 ) implies ( B10 . R5 ) = ( ( B8 . ( B11 . R5 ) ) * ( ( ( B11 . R5 ) |-- R15 ) . B9 ) )))))))))))))
proof
let R6 being RealLinearSpace;
let R13 being  finite (Subset of R6);
let R15 being  finite  affinely-independent (Subset of R6);
defpred S1[ Nat ] means (for B12 being  finite (Subset of R6) holds ((( card B12 ) = $1 & B12 c= ( conv R15 )) implies (for B13 being (Linear_Combination of B12) holds ((( Carrier B13 ) = B12 & ( sum B13 ) = 1) implies (( Sum B13 ) in ( Affin R15 ) & (for B14 being (Element of R6) holds (ex B15 being (FinSequence of ( REAL )) st (ex B16 being (FinSequence of R6) st (( ( ( Sum B13 ) |-- R15 ) . B14 ) = ( Sum B15 ) & ( len B16 ) = ( len B15 ) & B16 is  one-to-one & ( rng B16 ) = ( Carrier B13 ) & (for R5 being Nat holds (R5 in ( dom B15 ) implies ( B15 . R5 ) = ( ( B13 . ( B16 . R5 ) ) * ( ( ( B16 . R5 ) |-- R15 ) . B14 ) ))))))))))));
L116: (for B17 being Nat holds (S1[ B17 ] implies S1[ ( B17 + 1 ) ]))
proof
let C8 being Nat;
assume that
L117: S1[ C8 ];
let C9 being  finite (Subset of R6);
assume that
L118: ( card C9 ) = ( C8 + 1 )
and
L119: C9 c= ( conv R15 );
L120: ( conv R15 ) c= ( Affin R15 ) by RLAFFIN1:65;
L121: C9 c= ( Affin R15 ) by L120 , L119 , XBOOLE_1:1;
L122: ( Affin C9 ) c= ( Affin R15 ) by L121 , RLAFFIN1:51;
let C10 being (Linear_Combination of C9);
assume that
L123: ( Carrier C10 ) = C9
and
L124: ( sum C10 ) = 1;
L125: ( Sum C10 ) in { ( Sum B18 ) where B18 is (Linear_Combination of C9) : ( sum B18 ) = 1 } by L124;
L126: ( Sum C10 ) in ( Affin C9 ) by L125 , RLAFFIN1:59;
thus L127: ( Sum C10 ) in ( Affin R15 ) by L126 , L122;
per cases ;
suppose L128: C8 = ( 0 );

let C11 being (Element of R6);
consider C12 being set such that L129: C9 = { C12 } by L118 , L128 , CARD_2:42;
L130: C12 in C9 by L129 , TARSKI:def 1;
reconsider D12 = C12 as (Element of R6) by L130;
L131: ( sum C10 ) = ( C10 . D12 ) by L123 , L129 , RLAFFIN1:32;
set D13 = <* ( ( D12 |-- R15 ) . C11 ) *>;
set D14 = <* D12 *>;
take D13;
take D14;
L132: ( Sum C10 ) = ( ( C10 . D12 ) * D12 ) by L129 , RLVECT_2:32;
L133: (( len D14 ) = 1 & ( Sum C10 ) = D12) by L132 , L124 , L131 , FINSEQ_1:39 , RLVECT_1:def 8;
thus L134: (( ( ( Sum C10 ) |-- R15 ) . C11 ) = ( Sum D13 ) & ( len D14 ) = ( len D13 ) & D14 is  one-to-one & ( rng D14 ) = ( Carrier C10 )) by L133 , L123 , L129 , FINSEQ_1:39 , FINSEQ_3:93 , RVSUM_1:73;
let R5 being Nat;
assume L135: R5 in ( dom D13 );
L136: R5 in ( Seg 1 ) by L135 , FINSEQ_1:38;
L137: R5 = 1 by L136 , FINSEQ_1:2 , TARSKI:def 1;
L138: ( D14 . R5 ) = D12 by L137 , FINSEQ_1:40;
thus L139: thesis by L138 , L124 , L131 , L137 , FINSEQ_1:40;
end;
suppose L140: C8 > ( 0 );

L141: (ex B19 being (Element of R6) st (( C10 . B19 ) <> 1 & B19 in ( Carrier C10 )))
proof
consider C13 being (FinSequence of R6) such that L142: C13 is  one-to-one and L143: ( rng C13 ) = ( Carrier C10 ) and L144: 1 = ( Sum ( C10 * C13 ) ) by L124 , RLAFFIN1:def 3;
L145: ( dom C13 ) , C9 are_equipotent  by L123 , L142 , L143 , WELLORD2:def 4;
L146: ( card C9 ) = ( card ( dom C13 ) ) by L145 , CARD_1:5
.= ( card ( Seg ( len C13 ) ) ) by FINSEQ_1:def 3
.= ( len C13 ) by FINSEQ_1:57;
L147: (( len C13 ) = ( len ( C10 * C13 ) ) & ( len ( ( len C13 ) |-> 1 ) ) = ( len C13 )) by CARD_1:def 7 , FINSEQ_2:33;
L148: ( Sum ( ( len C13 ) |-> 1 ) ) = ( ( len C13 ) * 1 ) by RVSUM_1:80;
L149: ( ( len C13 ) |-> 1 ) <> ( C10 * C13 ) by L148 , L118 , L140 , L144 , L146;
consider C14 being Nat such that L150: (1 <= C14 & C14 <= ( len C13 )) and L151: ( ( ( len C13 ) |-> 1 ) . C14 ) <> ( ( C10 * C13 ) . C14 ) by L149 , L147 , FINSEQ_1:14;
L152: C14 in ( Seg ( len C13 ) ) by L150 , FINSEQ_1:1;
L153: C14 in ( dom C13 ) by L150 , FINSEQ_3:25;
L154: ( C13 . C14 ) in ( Carrier C10 ) by L153 , L143 , FUNCT_1:def 3;
L155: ( C10 . ( C13 . C14 ) ) = ( ( C10 * C13 ) . C14 ) by L153 , FUNCT_1:13;
L156: ( C10 . ( C13 . C14 ) ) <> 1 by L155 , L151 , L152 , FINSEQ_2:57;
thus L157: thesis by L156 , L154;
end;
consider C15 being (Element of R6) such that L158: ( C10 . C15 ) <> 1 and L159: C15 in ( Carrier C10 ) by L141;
set D15 = ( 1 - ( C10 . C15 ) );
consider C16 being (Linear_Combination of { C15 }) such that L160: ( C16 . C15 ) = ( C10 . C15 ) by RLVECT_4:37;
set D16 = ( C10 - C16 );
L161: D15 <> ( 0 ) by L158;
set D17 = ( ( 1 / D15 ) * D16 );
L162: ( Carrier C16 ) c= { C15 } by RLVECT_2:def 6;
L163: ( sum C16 ) = ( C16 . C15 ) by L162 , RLAFFIN1:32;
L164: ( sum D16 ) = D15 by L163 , L124 , L160 , RLAFFIN1:36;
L165: ( sum D17 ) = ( ( 1 / D15 ) * D15 ) by L164 , RLAFFIN1:35;
L166: ( D16 . C15 ) = ( ( C10 . C15 ) - ( C16 . C15 ) ) by RLVECT_2:54;
L167: (not C15 in ( Carrier D16 )) by L166 , L160 , RLVECT_2:19;
L168: ( card ( C9 \ { C15 } ) ) = C8 by L118 , L123 , L159 , STIRL2_1:55;
L169: ( Sum C16 ) = ( ( C10 . C15 ) * C15 ) by L160 , RLVECT_2:32;
L170: ( C9 \ { C15 } ) c= C9 by XBOOLE_1:36;
L171: ( C9 \ { C15 } ) c= ( conv R15 ) by L170 , L119 , XBOOLE_1:1;
L172: ( C10 . C15 ) <> ( 0 ) by L159 , RLVECT_2:19;
L173: C15 in ( Carrier C16 ) by L172 , L160;
L174: ( Carrier C16 ) = { C15 } by L173 , L162 , ZFMISC_1:33;
L175: ( C9 \ { C15 } ) c= ( Carrier D16 )
proof
let R1 being set;
assume L176: R1 in ( C9 \ { C15 } );
reconsider D18 = R1 as (Element of R6) by L176;
L177: D18 in C9 by L176 , ZFMISC_1:56;
L178: ( C10 . D18 ) <> ( 0 ) by L177 , L123 , RLVECT_2:19;
L179: (( D16 . D18 ) = ( ( C10 . D18 ) - ( C16 . D18 ) ) & (not D18 in { C15 })) by L176 , RLVECT_2:54 , XBOOLE_0:def 5;
L180: ( D16 . D18 ) <> ( 0 ) by L179 , L174 , L178;
thus L181: thesis by L180;
end;
let C17 being (Element of R6);
L182: ( ( 1 / D15 ) * D15 ) = ( ( 1 * D15 ) / D15 ) by XCMPLX_1:74
.= 1 by L161 , XCMPLX_1:60;
L183: ( Sum D17 ) = ( ( 1 / D15 ) * ( Sum D16 ) ) by RLVECT_3:2;
L184: ( D15 * ( Sum D17 ) ) = ( ( D15 * ( 1 / D15 ) ) * ( Sum D16 ) ) by L183 , RLVECT_1:def 7
.= ( Sum D16 ) by L182 , RLVECT_1:def 8;
L185: ( ( D15 * ( Sum D17 ) ) + ( ( C10 . C15 ) * C15 ) ) = ( ( ( Sum C10 ) - ( ( C10 . C15 ) * C15 ) ) + ( ( C10 . C15 ) * C15 ) ) by L184 , L169 , RLVECT_3:4
.= ( Sum C10 ) by RLVECT_4:1;
L186: ( C9 \/ { C15 } ) = C9 by L123 , L159 , ZFMISC_1:40;
L187: ( Carrier D16 ) c= ( C9 \ { C15 } ) by L186 , L123 , L174 , L167 , RLVECT_2:55 , ZFMISC_1:34;
L188: ( C9 \ { C15 } ) = ( Carrier D16 ) by L187 , L175 , XBOOLE_0:def 10;
L189: ( Carrier D17 ) = ( C9 \ { C15 } ) by L188 , L161 , RLVECT_2:42;
L190: D17 is (Linear_Combination of ( C9 \ { C15 } )) by L189 , RLVECT_2:def 6;
consider C18 being (FinSequence of ( REAL )), C19 being (FinSequence of R6) such that L191: ( ( ( Sum D17 ) |-- R15 ) . C17 ) = ( Sum C18 ) and L192: ( len C19 ) = ( len C18 ) and L193: C19 is  one-to-one and L194: ( rng C19 ) = ( Carrier D17 ) and L195: (for R5 being Nat holds (R5 in ( dom C18 ) implies ( C18 . R5 ) = ( ( D17 . ( C19 . R5 ) ) * ( ( ( C19 . R5 ) |-- R15 ) . C17 ) ))) by L190 , L117 , L165 , L182 , L168 , L171 , L189;
L196: ( Sum D17 ) in ( Affin R15 ) by L117 , L165 , L182 , L168 , L171 , L189 , L190;
L197: ( ( Sum C10 ) |-- R15 ) = ( ( D15 * ( ( Sum D17 ) |-- R15 ) ) + ( ( C10 . C15 ) * ( C15 |-- R15 ) ) ) by L196 , L121 , L123 , L159 , L185 , RLAFFIN1:70;
take D19 = ( ( D15 * C18 ) ^ <* ( ( C10 . C15 ) * ( ( C15 |-- R15 ) . C17 ) ) *> );
take D20 = ( C19 ^ <* C15 *> );
thus L198: ( Sum D19 ) = ( ( Sum ( D15 * C18 ) ) + ( ( C10 . C15 ) * ( ( C15 |-- R15 ) . C17 ) ) ) by RVSUM_1:74
.= ( ( D15 * ( ( ( Sum D17 ) |-- R15 ) . C17 ) ) + ( ( C10 . C15 ) * ( ( C15 |-- R15 ) . C17 ) ) ) by L191 , RVSUM_1:87
.= ( ( ( D15 * ( ( Sum D17 ) |-- R15 ) ) . C17 ) + ( ( C10 . C15 ) * ( ( C15 |-- R15 ) . C17 ) ) ) by RLVECT_2:def 11
.= ( ( ( D15 * ( ( Sum D17 ) |-- R15 ) ) . C17 ) + ( ( ( C10 . C15 ) * ( C15 |-- R15 ) ) . C17 ) ) by RLVECT_2:def 11
.= ( ( ( Sum C10 ) |-- R15 ) . C17 ) by L197 , RLVECT_2:def 10;
reconsider D21 = C18 as (Element of ( ( len C18 ) -tuples_on ( REAL ) )) by FINSEQ_2:92;
L199: ( len C18 ) = ( len ( D15 * D21 ) ) by CARD_1:def 7;
L200: ( len D19 ) = ( ( len C18 ) + 1 ) by L199 , FINSEQ_2:16;
thus L201: ( len D19 ) = ( len D20 ) by L200 , L192 , FINSEQ_2:16;
L202: ( rng <* C15 *> ) = { C15 } by FINSEQ_1:38;
L203: (<* C15 *> is  one-to-one & ( rng C19 ) misses ( rng <* C15 *> )) by L202 , L189 , L194 , FINSEQ_3:93 , XBOOLE_1:79;
thus L204: D20 is  one-to-one by L203 , L193 , FINSEQ_3:91;
thus L205: ( rng D20 ) = ( ( C9 \ { C15 } ) \/ { C15 } ) by L189 , L194 , L202 , FINSEQ_1:31
.= ( Carrier C10 ) by L123 , L159 , ZFMISC_1:116;
let R5 being Nat;
assume L206: R5 in ( dom D19 );
L207: R5 <= ( len D19 ) by L206 , FINSEQ_3:25;
per cases  by L200 , L206 , L207 , FINSEQ_3:25 , NAT_1:8;
suppose L208: (1 <= R5 & R5 <= ( len C18 ));

L209: R5 in ( dom C18 ) by L208 , FINSEQ_3:25;
L210: (( ( D15 * D21 ) . R5 ) = ( D15 * ( D21 . R5 ) ) & ( C18 . R5 ) = ( ( D17 . ( C19 . R5 ) ) * ( ( ( C19 . R5 ) |-- R15 ) . C17 ) )) by L209 , L195 , RVSUM_1:45;
L211: R5 in ( dom C19 ) by L192 , L208 , FINSEQ_3:25;
L212: ( D20 . R5 ) = ( C19 . R5 ) by L211 , FINSEQ_1:def 7;
L213: ( C19 . R5 ) in ( C9 \ { C15 } ) by L189 , L194 , L211 , FUNCT_1:def 3;
L214: (not ( C19 . R5 ) in { C15 }) by L213 , XBOOLE_0:def 5;
L215: ( C16 . ( C19 . R5 ) ) = ( 0 ) by L214 , L174 , L213;
L216: ( D16 . ( C19 . R5 ) ) = ( ( C10 . ( C19 . R5 ) ) - ( 0 ) ) by L215 , L213 , RLVECT_2:54;
L217: ( D17 . ( C19 . R5 ) ) = ( ( 1 / D15 ) * ( C10 . ( C19 . R5 ) ) ) by L216 , L213 , RLVECT_2:def 11;
L218: ( D15 * ( D17 . ( D20 . R5 ) ) ) = ( ( D15 * ( 1 / D15 ) ) * ( C10 . ( C19 . R5 ) ) ) by L217 , L212;
L219: ( D15 * ( D17 . ( D20 . R5 ) ) ) = ( C10 . ( C19 . R5 ) ) by L218 , L182;
L220: R5 in ( dom ( D15 * C18 ) ) by L199 , L208 , FINSEQ_3:25;
thus L221: thesis by L220 , L210 , L212 , L219 , FINSEQ_1:def 7;
end;
suppose L222: R5 = ( ( len C18 ) + 1 );

L223: ( D20 . R5 ) = C15 by L222 , L192 , FINSEQ_1:42;
thus L224: thesis by L223 , L199 , L222 , FINSEQ_1:42;
end;
end;
end;
let C20 being (Linear_Combination of R13);
assume that
L227: R13 c= ( conv R15 )
and
L228: ( sum C20 ) = 1;
set D22 = ( Carrier C20 );
L229: D22 c= R13 by RLVECT_2:def 6;
L230: D22 c= ( conv R15 ) by L229 , L227 , XBOOLE_1:1;
reconsider D23 = C20 as (Linear_Combination of D22) by RLVECT_2:def 6;
L231: S1[ (( 0 ) qua Nat) ]
proof
let C21 being  finite (Subset of R6);
assume that
L232: ( card C21 ) = ( 0 )
and
L233: C21 c= ( conv R15 );
let C22 being (Linear_Combination of C21);
assume that
L234: ( Carrier C22 ) = C21
and
L235: ( sum C22 ) = 1;
L236: C21 = ( {} (the carrier of R6) ) by L232;
L237: C22 = ( ZeroLC R6 ) by L236 , RLVECT_2:23;
thus L238: thesis by L237 , L235 , RLAFFIN1:31;
end;
L239: (for B20 being Nat holds S1[ B20 ]) from NAT_1:sch 2(L231 , L116);
L240: (( sum C20 ) = ( sum D23 ) & S1[ ( card D22 ) ]) by L239;
thus L241: thesis by L240 , L228 , L230;
end;
theorem
L242: (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R11 being (Subset of R6) holds (for R12 being (Subset of R6) holds (for B21 being (Subset of R6) holds ((B21 is  Affine & ( ( conv R11 ) /\ ( conv R12 ) ) c= B21 & ( conv ( R11 \ { R7 } ) ) c= B21 & (not R7 in B21)) implies ( ( conv ( R11 \ { R7 } ) ) /\ ( conv R12 ) ) = ( ( conv R11 ) /\ ( conv R12 ) )))))))
proof
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R11 being (Subset of R6);
let R12 being (Subset of R6);
let C23 being (Subset of R6);
assume that
L243: C23 is  Affine
and
L244: ( ( conv R11 ) /\ ( conv R12 ) ) c= C23
and
L245: ( conv ( R11 \ { R7 } ) ) c= C23
and
L246: (not R7 in C23);
L247: ( conv ( R11 \ { R7 } ) ) c= ( conv R11 ) by RLTOPSP1:20 , XBOOLE_1:36;
thus L248: ( ( conv ( R11 \ { R7 } ) ) /\ ( conv R12 ) ) c= ( ( conv R11 ) /\ ( conv R12 ) ) by L247 , XBOOLE_1:26;
let R1 being set;
assume L249: R1 in ( ( conv R11 ) /\ ( conv R12 ) );
reconsider D24 = R11 as non  empty (Subset of R6) by L249 , XBOOLE_0:def 4;
L250: R1 in C23 by L244 , L249;
L251: (( conv R11 ) = { ( Sum B22 ) where B22 is (Convex_Combination of D24) : B22 in ( ConvexComb R6 ) } & R1 in ( conv R11 )) by L249 , CONVEX3:5 , XBOOLE_0:def 4;
consider C24 being (Convex_Combination of D24) such that L252: R1 = ( Sum C24 ) and L253: C24 in ( ConvexComb R6 ) by L251;
set D25 = ( C24 . R7 );
L254: ( Carrier C24 ) c= R11 by RLVECT_2:def 6;
L255: R1 in ( conv R12 ) by L249 , XBOOLE_0:def 4;
per cases ;
suppose L256: D25 = ( 0 );

L257: (not R7 in ( Carrier C24 )) by L256 , RLVECT_2:19;
L258: ( Carrier C24 ) c= ( R11 \ { R7 } ) by L257 , L254 , ZFMISC_1:34;
reconsider D26 = C24 as (Linear_Combination of ( R11 \ { R7 } )) by L258 , RLVECT_2:def 6;
L259: ( Carrier C24 ) <> ( {} ) by CONVEX1:21;
reconsider D27 = ( R11 \ { R7 } ) as non  empty (Subset of R6) by L259 , L258;
L260: D26 in ( ConvexComb R6 ) by CONVEX3:def 1;
L261: ( Sum D26 ) in { ( Sum B23 ) where B23 is (Convex_Combination of D27) : B23 in ( ConvexComb R6 ) } by L260;
L262: R1 in ( conv D27 ) by L261 , L252 , CONVEX3:5;
thus L263: thesis by L262 , L255 , XBOOLE_0:def 4;
end;
suppose L264: D25 <> ( 0 );

L265: (ex B24 being (Element of R6) st (B24 in ( conv ( R11 \ { R7 } ) ) & ( Sum C24 ) = ( ( ( C24 . R7 ) * R7 ) + ( ( 1 - ( C24 . R7 ) ) * B24 ) ) & ( ( ( 1 / ( C24 . R7 ) ) * ( Sum C24 ) ) + ( ( 1 - ( 1 / ( C24 . R7 ) ) ) * B24 ) ) = R7)) by L264 , L246 , L250 , L252 , L9;
thus L266: thesis by L265 , L243 , L244 , L245 , L246 , L249 , L252 , RUSUB_4:def 4;
end;
end;
begin
definition
let C25 being non  empty RLSStruct;
let C26 being (Subset of C25);
func Int C26 -> (Subset of C25) means 
:L268: (for R1 being set holds (R1 in it iff (R1 in ( conv C26 ) & (not (ex B25 being (Subset of C25) st (B25 c< C26 & R1 in ( conv B25 )))))));
existence
proof
set D28 = { B26 where B26 is (Element of C25) : (B26 in ( conv C26 ) & (not (ex B27 being (Subset of C25) st (B27 c< C26 & B26 in ( conv B27 ))))) };
L269:
now
let R1 being set;
assume L270: R1 in D28;
L271: (ex B28 being (Element of C25) st (R1 = B28 & B28 in ( conv C26 ) & (not (ex B29 being (Subset of C25) st (B29 c< C26 & B28 in ( conv B29 )))))) by L270;
thus L272: R1 in (the carrier of C25) by L271;
end;
reconsider D29 = D28 as (Subset of C25) by L269 , TARSKI:def 3;
take D29;
let R1 being set;
thus L273:now
assume L274: R1 in D29;
L275: (ex B30 being (Element of C25) st (R1 = B30 & B30 in ( conv C26 ) & (not (ex B31 being (Subset of C25) st (B31 c< C26 & B30 in ( conv B31 )))))) by L274;
thus L276: (R1 in ( conv C26 ) & (not (ex B32 being (Subset of C25) st (B32 c< C26 & R1 in ( conv B32 ))))) by L275;
end;
assume L277: (R1 in ( conv C26 ) & (not (ex B33 being (Subset of C25) st (B33 c< C26 & R1 in ( conv B33 )))));
thus L278: thesis by L277;
end;
uniqueness
proof
let C27 , C28 being (Subset of C25);
assume that
L279: (for R1 being set holds (R1 in C27 iff (R1 in ( conv C26 ) & (not (ex B34 being (Subset of C25) st (B34 c< C26 & R1 in ( conv B34 )))))))
and
L280: (for R1 being set holds (R1 in C28 iff (R1 in ( conv C26 ) & (not (ex B35 being (Subset of C25) st (B35 c< C26 & R1 in ( conv B35 )))))));
L281:
now
let R1 being set;
L282: (R1 in C27 iff (R1 in ( conv C26 ) & (not (ex B36 being (Subset of C25) st (B36 c< C26 & R1 in ( conv B36 )))))) by L279;
thus L283: (R1 in C27 iff R1 in C28) by L282 , L280;
end;
thus L284: thesis by L281 , TARSKI:1;
end;
end;
L286: (for B37 being non  empty RLSStruct holds (for B38 being (Subset of B37) holds ( Int B38 ) c= ( conv B38 )))
proof
let C29 being non  empty RLSStruct;
let C30 being (Subset of C29);
let R1 being set;
assume L287: R1 in ( Int C30 );
thus L288: thesis by L287 , L268;
end;
registration
let C31 being non  empty RLSStruct;
let C32 being  empty (Subset of C31);
cluster ( Int C32 ) ->  empty;
coherence
proof
L289: ( Int C32 ) c= ( conv C32 ) by L286;
thus L290: thesis by L289;
end;
end;
theorem
L292: (for B39 being non  empty RLSStruct holds (for B40 being (Subset of B39) holds ( Int B40 ) c= ( conv B40 ))) by L286;
theorem
L293: (for B41 being  vector-distributive  scalar-distributive  scalar-associative  scalar-unital non  empty RLSStruct holds (for B42 being (Subset of B41) holds (( Int B42 ) = B42 iff B42 is  trivial)))
proof
let C33 being  vector-distributive  scalar-distributive  scalar-associative  scalar-unital non  empty RLSStruct;
let C34 being (Subset of C33);
per cases ;
suppose L294: C34 is  empty;

thus L295: thesis by L294;
end;
suppose L296: C34 is non  empty;

thus L297:now
assume L298: ( Int C34 ) = C34;
L299:
now
let R1 being set;
let R2 being set;
assume that
L300: R1 in C34
and
L301: R2 in C34;
L302: (( C34 \ { R1 } ) c= C34 & ( C34 \ { R1 } ) <> C34) by L300 , XBOOLE_1:36 , ZFMISC_1:56;
L303: (( C34 \ { R1 } ) c= ( conv ( C34 \ { R1 } ) ) & ( C34 \ { R1 } ) c< C34) by L302 , RLAFFIN1:2 , XBOOLE_0:def 8;
L304: (not R2 in ( C34 \ { R1 } )) by L303 , L298 , L301 , L268;
thus L305: R1 = R2 by L304 , L301 , ZFMISC_1:56;
end;
thus L306: C34 is  trivial by L299 , ZFMISC_1:def 10;
end;
assume L307: C34 is  trivial;
consider C35 being (Element of C33) such that L308: C34 = { C35 } by L307 , L296 , SUBSET_1:47;
L309: (not (ex B43 being (Subset of C33) st (B43 c< C34 & C35 in ( conv B43 ))))
proof
let C36 being (Subset of C33);
assume L310: C36 c< C34;
L311: C36 c= C34 by L310 , XBOOLE_0:def 8;
L312: C36 is  empty by L311 , L308 , L310 , ZFMISC_1:33;
thus L313: thesis by L312;
end;
L314: ( conv C34 ) = C34 by L308 , RLAFFIN1:1;
L315: ( Int C34 ) c= C34 by L314 , L286;
L316: C35 in C34 by L308 , TARSKI:def 1;
L317: C35 in ( Int C34 ) by L316 , L309 , L314 , L268;
thus L318: thesis by L317 , L308 , L315 , ZFMISC_1:33;
end;
end;
theorem
L320: (for R6 being RealLinearSpace holds (for R11 being (Subset of R6) holds (for R12 being (Subset of R6) holds (R11 c< R12 implies ( conv R11 ) misses ( Int R12 )))))
proof
let R6 being RealLinearSpace;
let R11 being (Subset of R6);
let R12 being (Subset of R6);
assume L321: R11 c< R12;
assume L322: ( conv R11 ) meets ( Int R12 );
L323: (ex R1 being set st (R1 in ( conv R11 ) & R1 in ( Int R12 ))) by L322 , XBOOLE_0:3;
thus L324: contradiction by L323 , L321 , L268;
end;
theorem
L325: (for R6 being RealLinearSpace holds (for R11 being (Subset of R6) holds ( conv R11 ) = ( union { ( Int R12 ) where R12 is (Subset of R6) : R12 c= R11 } )))
proof
let R6 being RealLinearSpace;
let R11 being (Subset of R6);
defpred S2[ Nat ] means (for B44 being  finite (Subset of R6) holds (( card B44 ) <= $1 implies ( conv B44 ) = ( union { ( Int R12 ) where R12 is (Subset of R6) : R12 c= B44 } )));
set D30 = { ( Int R12 ) where R12 is (Subset of R6) : R12 c= R11 };
L326: (for B45 being (Subset of R6) holds ( union { ( Int R12 ) where R12 is (Subset of R6) : R12 c= B45 } ) c= ( conv B45 ))
proof
let C37 being (Subset of R6);
set D31 = { ( Int R12 ) where R12 is (Subset of R6) : R12 c= C37 };
let R2 being set;
assume L327: R2 in ( union D31 );
consider R1 being set such that L328: R2 in R1 and L329: R1 in D31 by L327 , TARSKI:def 4;
consider C38 being (Subset of R6) such that L330: R1 = ( Int C38 ) and L331: C38 c= C37 by L329;
L332: ( conv C38 ) c= ( conv C37 ) by L331 , RLAFFIN1:3;
L333: R2 in ( conv C38 ) by L328 , L330 , L268;
thus L334: thesis by L333 , L332;
end;
L335: (for B46 being Nat holds (S2[ B46 ] implies S2[ ( B46 + 1 ) ]))
proof
let C39 being Nat;
assume that
L336: S2[ C39 ];
let C40 being  finite (Subset of R6);
assume that
L337: ( card C40 ) <= ( C39 + 1 );
per cases  by L337 , NAT_1:8;
suppose L338: ( card C40 ) <= C39;

thus L339: thesis by L338 , L336;
end;
suppose L340: ( card C40 ) = ( C39 + 1 );

set D32 = { ( Int R12 ) where R12 is (Subset of R6) : R12 c= C40 };
L341: ( conv C40 ) c= ( union D32 )
proof
let R1 being set;
assume that
L342: R1 in ( conv C40 );
per cases ;
suppose L343: (for B47 being (Subset of R6) holds (B47 c< C40 implies (not R1 in ( conv B47 ))));

L344: (( Int C40 ) in D32 & R1 in ( Int C40 )) by L343 , L342 , L268;
thus L345: thesis by L344 , TARSKI:def 4;
end;
suppose L346: (ex B48 being (Subset of R6) st (B48 c< C40 & R1 in ( conv B48 )));

consider C41 being (Subset of R6) such that L347: C41 c< C40 and L348: R1 in ( conv C41 ) by L346;
L349: C41 c= C40 by L347 , XBOOLE_0:def 8;
reconsider D33 = C41 as  finite (Subset of R6) by L349;
L350: ( card D33 ) < ( C39 + 1 ) by L340 , L347 , CARD_2:48;
L351: ( card D33 ) <= C39 by L350 , NAT_1:13;
L352: ( conv D33 ) = ( union { ( Int R12 ) where R12 is (Subset of R6) : R12 c= D33 } ) by L351 , L336;
consider C42 being set such that L353: R1 in C42 and L354: C42 in { ( Int R12 ) where R12 is (Subset of R6) : R12 c= D33 } by L352 , L348 , TARSKI:def 4;
consider C43 being (Subset of R6) such that L355: C42 = ( Int C43 ) and L356: C43 c= D33 by L354;
L357: C43 c= C40 by L349 , L356 , XBOOLE_1:1;
L358: ( Int C43 ) in D32 by L357;
thus L359: thesis by L358 , L353 , L355 , TARSKI:def 4;
end;
end;
L361: ( union D32 ) c= ( conv C40 ) by L326;
thus L362: thesis by L361 , L341 , XBOOLE_0:def 10;
end;
end;
L364: S2[ (( 0 ) qua Nat) ]
proof
let C44 being  finite (Subset of R6);
set D34 = { ( Int R12 ) where R12 is (Subset of R6) : R12 c= C44 };
assume L365: ( card C44 ) <= ( 0 );
L366: C44 is  empty by L365;
L367: ( conv C44 ) is  empty by L366;
L368: ( union D34 ) c= ( conv C44 ) by L326;
thus L369: thesis by L368 , L367;
end;
L370: (for B49 being Nat holds S2[ B49 ]) from NAT_1:sch 2(L364 , L335);
thus L371:now
let R1 being set;
assume that
L372: R1 in ( conv R11 );
reconsider D35 = R11 as non  empty (Subset of R6) by L372;
L373: ( conv R11 ) = { ( Sum B50 ) where B50 is (Convex_Combination of D35) : B50 in ( ConvexComb R6 ) } by CONVEX3:5;
consider C45 being (Convex_Combination of D35) such that L374: (R1 = ( Sum C45 ) & C45 in ( ConvexComb R6 )) by L373 , L372;
reconsider D36 = ( Carrier C45 ) as non  empty  finite (Subset of R6) by CONVEX1:21;
reconsider D37 = C45 as (Linear_Combination of D36) by RLVECT_2:def 6;
L375: D37 is  convex;
L376: R1 in { ( Sum B51 ) where B51 is (Convex_Combination of D36) : B51 in ( ConvexComb R6 ) } by L375 , L374;
L377: R1 in ( conv D36 ) by L376 , CONVEX3:5;
L378: S2[ ( card D36 ) ] by L370;
L379: R1 in ( union { ( Int R12 ) where R12 is (Subset of R6) : R12 c= D36 } ) by L378 , L377;
consider R2 being set such that L380: R1 in R2 and L381: R2 in { ( Int R12 ) where R12 is (Subset of R6) : R12 c= D36 } by L379 , TARSKI:def 4;
consider C46 being (Subset of R6) such that L382: R2 = ( Int C46 ) and L383: C46 c= D36 by L381;
L384: D36 c= R11 by RLVECT_2:def 6;
L385: C46 c= R11 by L384 , L383 , XBOOLE_1:1;
L386: ( Int C46 ) in D30 by L385;
thus L387: R1 in ( union D30 ) by L386 , L380 , L382 , TARSKI:def 4;
end;
thus L388: thesis by L326;
end;
theorem
L389: (for R6 being RealLinearSpace holds (for R11 being (Subset of R6) holds ( conv R11 ) = ( ( Int R11 ) \/ ( union { ( conv ( R11 \ { R7 } ) ) where R7 is (VECTOR of R6) : R7 in R11 } ) )))
proof
let R6 being RealLinearSpace;
let R11 being (Subset of R6);
set D38 = { ( conv ( R11 \ { R7 } ) ) where R7 is (VECTOR of R6) : R7 in R11 };
thus L390:now
let R1 being set;
assume L391: R1 in ( conv R11 );
L392: R1 in ( union { ( Int R12 ) where R12 is (Subset of R6) : R12 c= R11 } ) by L391 , L325;
consider R2 being set such that L393: R1 in R2 and L394: R2 in { ( Int R12 ) where R12 is (Subset of R6) : R12 c= R11 } by L392 , TARSKI:def 4;
consider C47 being (Subset of R6) such that L395: R2 = ( Int C47 ) and L396: C47 c= R11 by L394;
per cases ;
suppose L397: R11 = C47;

thus L398: R1 in ( ( Int R11 ) \/ ( union D38 ) ) by L397 , L393 , L395 , XBOOLE_0:def 3;
end;
suppose L399: C47 <> R11;

L400: C47 c< R11 by L399 , L396 , XBOOLE_0:def 8;
consider R2 being set such that L401: R2 in R11 and L402: (not R2 in C47) by L400 , XBOOLE_0:6;
reconsider D39 = R2 as (Element of R6) by L401;
L403: ( conv ( R11 \ { D39 } ) ) in D38 by L401;
L404: C47 c= ( R11 \ { D39 } ) by L396 , L402 , ZFMISC_1:34;
L405: ( conv C47 ) c= ( conv ( R11 \ { D39 } ) ) by L404 , RLAFFIN1:3;
L406: R1 in ( conv C47 ) by L393 , L395 , L268;
L407: R1 in ( union D38 ) by L406 , L403 , L405 , TARSKI:def 4;
thus L408: R1 in ( ( Int R11 ) \/ ( union D38 ) ) by L407 , XBOOLE_0:def 3;
end;
end;
let R1 being set;
L410:
now
assume L411: R1 in ( union D38 );
consider R2 being set such that L412: R1 in R2 and L413: R2 in D38 by L411 , TARSKI:def 4;
consider R7 being (VECTOR of R6) such that L414: R2 = ( conv ( R11 \ { R7 } ) ) and L415: R7 in R11 by L413;
L416: ( conv ( R11 \ { R7 } ) ) c= ( conv R11 ) by RLAFFIN1:3 , XBOOLE_1:36;
thus L417: R1 in ( conv R11 ) by L416 , L412 , L414;
end;
assume L418: R1 in ( ( Int R11 ) \/ ( union D38 ) );
L419: (R1 in ( Int R11 ) or R1 in ( union D38 )) by L418 , XBOOLE_0:def 3;
L420: ( Int R11 ) c= ( conv R11 ) by L286;
thus L421: thesis by L420 , L410 , L419;
end;
theorem
L422: (for R1 being set holds (for R6 being RealLinearSpace holds (for R11 being (Subset of R6) holds (R1 in ( Int R11 ) implies (ex B52 being (Linear_Combination of R11) st (B52 is  convex & R1 = ( Sum B52 )))))))
proof
let R1 being set;
let R6 being RealLinearSpace;
let R11 being (Subset of R6);
assume L423: R1 in ( Int R11 );
reconsider D40 = R11 as non  empty (Subset of R6) by L423;
L424: R1 in ( conv R11 ) by L423 , L268;
L425: R1 in { ( Sum B53 ) where B53 is (Convex_Combination of D40) : B53 in ( ConvexComb R6 ) } by L424 , CONVEX3:5;
L426: (ex B54 being (Convex_Combination of D40) st (R1 = ( Sum B54 ) & B54 in ( ConvexComb R6 ))) by L425;
thus L427: thesis by L426;
end;
theorem
L428: (for R6 being RealLinearSpace holds (for R11 being (Subset of R6) holds (for B55 being (Linear_Combination of R11) holds ((B55 is  convex & ( Sum B55 ) in ( Int R11 )) implies ( Carrier B55 ) = R11))))
proof
let R6 being RealLinearSpace;
let R11 being (Subset of R6);
let C48 being (Linear_Combination of R11);
assume that
L429: C48 is  convex
and
L430: ( Sum C48 ) in ( Int R11 );
reconsider D41 = ( Carrier C48 ) as non  empty (Subset of R6) by L429 , CONVEX1:21;
reconsider D42 = C48 as (Linear_Combination of D41) by RLVECT_2:def 6;
L431: D42 in ( ConvexComb R6 ) by L429 , CONVEX3:def 1;
L432: ( Sum D42 ) in { ( Sum B56 ) where B56 is (Convex_Combination of D41) : B56 in ( ConvexComb R6 ) } by L431 , L429;
L433: ( Sum C48 ) in ( conv D41 ) by L432 , CONVEX3:5;
L434: ( Carrier C48 ) c= R11 by RLVECT_2:def 6;
assume L435: ( Carrier C48 ) <> R11;
L436: ( Carrier C48 ) c< R11 by L435 , L434 , XBOOLE_0:def 8;
thus L437: contradiction by L436 , L430 , L433 , L268;
end;
theorem
L438: (for R6 being RealLinearSpace holds (for R14 being  affinely-independent (Subset of R6) holds (for B57 being (Linear_Combination of R14) holds ((B57 is  convex & ( Carrier B57 ) = R14) implies ( Sum B57 ) in ( Int R14 )))))
proof
let R6 being RealLinearSpace;
let R14 being  affinely-independent (Subset of R6);
let C49 being (Linear_Combination of R14);
assume that
L439: C49 is  convex
and
L440: ( Carrier C49 ) = R14;
reconsider D43 = R14 as non  empty (Subset of R6) by L439 , L440 , CONVEX1:21;
reconsider D44 = C49 as (Linear_Combination of D43);
L441: D44 in ( ConvexComb R6 ) by L439 , CONVEX3:def 1;
L442: ( Sum D44 ) in { ( Sum B58 ) where B58 is (Convex_Combination of D43) : B58 in ( ConvexComb R6 ) } by L441 , L439;
L443: ( Sum D44 ) in ( conv D43 ) by L442 , CONVEX3:5;
L444: (( conv D43 ) c= ( Affin D43 ) & ( sum C49 ) = 1) by L439 , RLAFFIN1:62 , RLAFFIN1:65;
L445: (for B59 being (Subset of R6) holds (B59 c< R14 implies (not ( Sum D44 ) in ( conv B59 ))))
proof
let C50 being (Subset of R6);
assume that
L446: C50 c< R14;
assume L447: ( Sum D44 ) in ( conv C50 );
L448: (( conv C50 ) c= ( Affin C50 ) & C50 c= R14) by L446 , RLAFFIN1:65 , XBOOLE_0:def 8;
L449: ( ( Sum D44 ) |-- C50 ) = ( ( Sum D44 ) |-- R14 ) by L448 , L447 , RLAFFIN1:77
.= D44 by L443 , L444 , RLAFFIN1:def 7;
L450: R14 c= C50 by L449 , L440 , RLVECT_2:def 6;
thus L451: thesis by L450 , L446 , XBOOLE_0:def 8;
end;
thus L452: thesis by L445 , L443 , L268;
end;
theorem
L453: (for R6 being RealLinearSpace holds (for R11 being (Subset of R6) holds (( Int R11 ) is non  empty implies R11 is  finite)))
proof
let R6 being RealLinearSpace;
let R11 being (Subset of R6);
assume L454: ( Int R11 ) is non  empty;
consider R1 being set such that L455: R1 in ( Int R11 ) by L454 , XBOOLE_0:def 1;
consider C51 being (Linear_Combination of R11) such that L456: (C51 is  convex & R1 = ( Sum C51 )) by L455 , L422;
L457: ( Carrier C51 ) = R11 by L455 , L456 , L428;
thus L458: R11 is  finite by L457;
end;
theorem
L459: (for R3 being Real holds (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R8 being (VECTOR of R6) holds (for R10 being (VECTOR of R6) holds (for R14 being  affinely-independent (Subset of R6) holds ((R7 in R14 & R8 in ( Int R14 ) & R10 in ( conv ( R14 \ { R7 } ) ) & ( ( R3 * R7 ) + ( ( 1 - R3 ) * R10 ) ) = R8) implies R10 in ( Int ( R14 \ { R7 } ) ))))))))
proof
let R3 being Real;
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R8 being (VECTOR of R6);
let R10 being (VECTOR of R6);
let R14 being  affinely-independent (Subset of R6);
assume that
L460: R7 in R14
and
L461: R8 in ( Int R14 )
and
L462: R10 in ( conv ( R14 \ { R7 } ) )
and
L463: ( ( R3 * R7 ) + ( ( 1 - R3 ) * R10 ) ) = R8;
L464: ( conv R14 ) c= ( Affin R14 ) by RLAFFIN1:65;
L465: R14 c= ( conv R14 ) by RLAFFIN1:2;
L466: R7 in ( conv R14 ) by L465 , L460;
L467: ( conv ( R14 \ { R7 } ) ) c= ( conv R14 ) by RLAFFIN1:3 , XBOOLE_1:36;
L468: R10 in ( conv R14 ) by L467 , L462;
L469: ( R8 |-- R14 ) = ( ( ( 1 - R3 ) * ( R10 |-- R14 ) ) + ( R3 * ( R7 |-- R14 ) ) ) by L468 , L463 , L464 , L466 , RLAFFIN1:70;
L470: ( Carrier ( R7 |-- { R7 } ) ) c= { R7 } by RLVECT_2:def 6;
L471: R8 in ( conv R14 ) by L461 , L268;
L472: ( Sum ( R8 |-- R14 ) ) = R8 by L471 , L464 , RLAFFIN1:def 7;
L473: ( Carrier ( R8 |-- R14 ) ) = R14 by L472 , L461 , L471 , L428 , RLAFFIN1:71;
L474: ({ R7 } c= ( Affin { R7 } ) & R7 in { R7 }) by RLAFFIN1:49 , TARSKI:def 1;
L475: { R7 } c= R14 by L460 , ZFMISC_1:31;
L476: ( R7 |-- R14 ) = ( R7 |-- { R7 } ) by L475 , L474 , RLAFFIN1:77;
L477: ( conv ( R14 \ { R7 } ) ) c= ( Affin ( R14 \ { R7 } ) ) by RLAFFIN1:65;
L478: ( R10 |-- R14 ) = ( R10 |-- ( R14 \ { R7 } ) ) by L477 , L462 , RLAFFIN1:77 , XBOOLE_1:36;
L479: ( R14 \ { R7 } ) c= ( Carrier ( R10 |-- ( R14 \ { R7 } ) ) )
proof
let R1 being set;
assume L480: R1 in ( R14 \ { R7 } );
reconsider D45 = R1 as (Element of R6) by L480;
L481: D45 in R14 by L480 , ZFMISC_1:56;
L482: D45 <> R7 by L480 , ZFMISC_1:56;
L483: (not D45 in ( Carrier ( R7 |-- { R7 } ) )) by L482 , L470 , TARSKI:def 1;
L484: ( ( R7 |-- R14 ) . D45 ) = ( 0 ) by L483 , L476;
L485: ( ( R8 |-- R14 ) . D45 ) = ( ( ( ( 1 - R3 ) * ( R10 |-- R14 ) ) . D45 ) + ( ( R3 * ( R7 |-- R14 ) ) . D45 ) ) by L469 , RLVECT_2:def 10
.= ( ( ( ( 1 - R3 ) * ( R10 |-- R14 ) ) . D45 ) + ( R3 * ( ( R7 |-- R14 ) . D45 ) ) ) by RLVECT_2:def 11
.= ( ( 1 - R3 ) * ( ( R10 |-- R14 ) . D45 ) ) by L484 , RLVECT_2:def 11;
L486: ( ( R10 |-- R14 ) . D45 ) <> ( 0 ) by L485 , L473 , L481 , RLVECT_2:19;
thus L487: thesis by L486 , L478;
end;
L488: ( Carrier ( R10 |-- ( R14 \ { R7 } ) ) ) c= ( R14 \ { R7 } ) by RLVECT_2:def 6;
L489: ( R14 \ { R7 } ) = ( Carrier ( R10 |-- ( R14 \ { R7 } ) ) ) by L488 , L479 , XBOOLE_0:def 10;
L490: ( R14 \ { R7 } ) is  affinely-independent by RLAFFIN1:43 , XBOOLE_1:36;
L491: ( Sum ( R10 |-- ( R14 \ { R7 } ) ) ) = R10 by L490 , L462 , L477 , RLAFFIN1:def 7;
thus L492: thesis by L491 , L462 , L489 , L490 , L438 , RLAFFIN1:71;
end;
begin
definition
let R6 being RealLinearSpace;
func center_of_mass R6 -> (Function of ( BOOL (the carrier of R6) ) , (the carrier of R6)) means 
:L493: ((for B60 being non  empty  finite (Subset of R6) holds ( it . B60 ) = ( ( 1 / ( card B60 ) ) * ( Sum B60 ) )) & (for R11 being (Subset of R6) holds (R11 is  infinite implies ( it . R11 ) = ( 0. R6 ))));
existence
proof
defpred S3[ set , set ] means ((for B61 being non  empty  finite (Subset of R6) holds (B61 = $1 implies $2 = ( ( 1 / ( card B61 ) ) * ( Sum B61 ) ))) & (for B62 being (Subset of R6) holds ((B62 is  infinite & B62 = $1) implies $2 = ( 0. R6 ))));
set D46 = (the carrier of R6);
L494: (for R1 being set holds (R1 in ( BOOL D46 ) implies (ex R2 being set st (R2 in D46 & S3[ R1 , R2 ]))))
proof
let R1 being set;
assume L495: R1 in ( BOOL D46 );
reconsider D47 = R1 as (Subset of R6) by L495;
per cases ;
suppose L496: D47 is  finite;

reconsider D48 = D47 as  finite (Subset of R6) by L496;
take ( ( 1 / ( card D48 ) ) * ( Sum D48 ) );
thus L497: thesis;
end;
suppose L498: D47 is  infinite;

take ( 0. R6 );
thus L499: thesis by L498;
end;
end;
consider C52 being (Function of ( BOOL D46 ) , D46) such that L501: (for R1 being set holds (R1 in ( BOOL D46 ) implies S3[ R1 , ( C52 . R1 ) ])) from FUNCT_2:sch 1(L494);
take C52;
thus L502:now
let C53 being non  empty  finite (Subset of R6);
L503: C53 in ( BOOL D46 ) by ZFMISC_1:56;
thus L504: ( C52 . C53 ) = ( ( 1 / ( card C53 ) ) * ( Sum C53 ) ) by L503 , L501;
end;
let C54 being (Subset of R6);
assume L505: C54 is  infinite;
L506: C54 in ( ( bool D46 ) \ { ( {} ) } ) by L505 , ZFMISC_1:56;
thus L507: thesis by L506 , L501 , L505;
end;
uniqueness
proof
set D49 = (the carrier of R6);
let C55 , C56 being (Function of ( BOOL D49 ) , D49);
assume that
L508: (for B63 being non  empty  finite (Subset of R6) holds ( C55 . B63 ) = ( ( 1 / ( card B63 ) ) * ( Sum B63 ) ))
and
L509: (for B64 being (Subset of R6) holds (B64 is  infinite implies ( C55 . B64 ) = ( 0. R6 )))
and
L510: (for B65 being non  empty  finite (Subset of R6) holds ( C56 . B65 ) = ( ( 1 / ( card B65 ) ) * ( Sum B65 ) ))
and
L511: (for B66 being (Subset of R6) holds (B66 is  infinite implies ( C56 . B66 ) = ( 0. R6 )));
L512: (for R1 being set holds (R1 in ( BOOL D49 ) implies ( C55 . R1 ) = ( C56 . R1 )))
proof
let R1 being set;
assume L513: R1 in ( BOOL D49 );
reconsider D50 = R1 as non  empty (Subset of R6) by L513 , ZFMISC_1:56;
per cases ;
suppose L514: D50 is  finite;

reconsider D51 = D50 as non  empty  finite (Subset of R6) by L514;
thus L515: ( C55 . R1 ) = ( ( 1 / ( card D51 ) ) * ( Sum D51 ) ) by L508
.= ( C56 . R1 ) by L510;
end;
suppose L516: D50 is  infinite;

thus L517: ( C55 . R1 ) = ( 0. R6 ) by L516 , L509
.= ( C56 . R1 ) by L511 , L516;
end;
end;
thus L519: thesis by L512 , FUNCT_2:12;
end;
end;
theorem
L521: (for R3 being Real holds (for R6 being RealLinearSpace holds (for R13 being  finite (Subset of R6) holds (ex B67 being (Linear_Combination of R13) st (( Sum B67 ) = ( R3 * ( Sum R13 ) ) & ( sum B67 ) = ( R3 * ( card R13 ) ) & B67 = ( ( ZeroLC R6 ) +* ( R13 --> R3 ) ))))))
proof
let R3 being Real;
let R6 being RealLinearSpace;
let R13 being  finite (Subset of R6);
set D52 = (the carrier of R6);
set D53 = ( ( ZeroLC R6 ) +* ( R13 --> R3 ) );
L522: ( dom ( R13 --> R3 ) ) = R13 by FUNCOP_1:13;
L523: ( dom ( ZeroLC R6 ) ) = D52 by FUNCT_2:def 1;
L524: ( dom D53 ) = ( D52 \/ R13 ) by L523 , L522 , FUNCT_4:def 1;
L525: (( rng D53 ) c= ( ( rng ( R13 --> R3 ) ) \/ ( rng ( ZeroLC R6 ) ) ) & ( dom D53 ) = D52) by L524 , FUNCT_4:17 , XBOOLE_1:12;
L526: D53 is (Function of (the carrier of R6) , ( REAL )) by L525 , FUNCT_2:2;
reconsider D54 = D53 as (Element of ( Funcs ((the carrier of R6) , ( REAL )) )) by L526 , FUNCT_2:8;
L527:
now
take D55 = R13;
let R7 being (VECTOR of R6);
assume L528: (not R7 in D55);
thus L529: ( D54 . R7 ) = ( ( ZeroLC R6 ) . R7 ) by L528 , L522 , FUNCT_4:11
.= ( 0 ) by RLVECT_2:20;
end;
reconsider D56 = D54 as (Linear_Combination of R6) by L527 , RLVECT_2:def 3;
L530: ( Carrier D56 ) c= R13
proof
let C57 being set;
assume L531: C57 in ( Carrier D56 );
reconsider D57 = C57 as (Element of R6) by L531;
assume L532: (not C57 in R13);
L533: ( D56 . C57 ) = ( ( ZeroLC R6 ) . D57 ) by L532 , L522 , FUNCT_4:11
.= ( 0 ) by RLVECT_2:20;
thus L534: thesis by L533 , L531 , RLVECT_2:19;
end;
reconsider D58 = ( ( ZeroLC R6 ) +* ( R13 --> R3 ) ) as (Linear_Combination of R13) by L530 , RLVECT_2:def 6;
L535: ( Carrier D58 ) c= R13 by RLVECT_2:def 6;
per cases ;
suppose L536: R3 = ( 0 );

L537: ( Carrier D58 ) = ( {} )
proof
assume L538: ( Carrier D58 ) <> ( {} );
consider R1 being set such that L539: R1 in ( Carrier D58 ) by L538 , XBOOLE_0:def 1;
L540: (( D58 . R1 ) = ( ( R13 --> R3 ) . R1 ) & ( ( R13 --> R3 ) . R1 ) = ( 0 )) by L522 , L535 , L536 , L539 , FUNCOP_1:7 , FUNCT_4:13;
thus L541: contradiction by L540 , L539 , RLVECT_2:19;
end;
L542: D58 = ( ZeroLC R6 ) by L537 , RLVECT_2:def 5;
L543: (( Sum D58 ) = ( 0. R6 ) & ( sum D58 ) = ( 0 )) by L542 , RLAFFIN1:31 , RLVECT_2:30;
L544: ( R3 * ( Sum R13 ) ) = ( 0. R6 ) by L536 , RLVECT_1:10;
thus L545: thesis by L544 , L536 , L543;
end;
suppose L546: R3 <> ( 0 );

consider C58 being (FinSequence of R6) such that L547: C58 is  one-to-one and L548: ( rng C58 ) = ( Carrier D58 ) and L549: ( Sum D58 ) = ( Sum ( D58 (#) C58 ) ) by RLVECT_2:def 8;
L550: R13 c= ( Carrier D58 )
proof
let R1 being set;
assume L551: R1 in R13;
L552: ( D58 . R1 ) = ( ( R13 --> R3 ) . R1 ) by L551 , L522 , FUNCT_4:13;
thus L553: thesis by L552 , L546 , L551;
end;
L554: R13 = ( Carrier D58 ) by L550 , L535 , XBOOLE_0:def 10;
L555: ( dom C58 ) , R13 are_equipotent  by L554 , L547 , L548 , WELLORD2:def 4;
L556: ( card R13 ) = ( card ( dom C58 ) ) by L555 , CARD_1:5
.= ( card ( Seg ( len C58 ) ) ) by FINSEQ_1:def 3
.= ( len C58 ) by FINSEQ_1:57;
set D59 = ( ( len C58 ) |-> R3 );
L557: ( len ( D58 * C58 ) ) = ( len C58 ) by FINSEQ_2:33;
reconsider D60 = ( D58 * C58 ) as (Element of ( ( len C58 ) -tuples_on ( REAL ) )) by L557 , FINSEQ_2:92;
L558:
now
let C59 being Nat;
assume L559: C59 in ( Seg ( len C58 ) );
L560: C59 in ( dom C58 ) by L559 , FINSEQ_1:def 3;
L561: ( C58 . C59 ) in ( rng C58 ) by L560 , FUNCT_1:def 3;
L562: ( ( R13 --> R3 ) . ( C58 . C59 ) ) = R3 by L561 , L535 , L548 , FUNCOP_1:7;
L563: C59 in ( dom D60 ) by L557 , L559 , FINSEQ_1:def 3;
L564: ( D60 . C59 ) = ( D58 . ( C58 . C59 ) ) by L563 , FUNCT_1:12;
L565: ( D60 . C59 ) = ( ( R13 --> R3 ) . ( C58 . C59 ) ) by L564 , L522 , L535 , L548 , L561 , FUNCT_4:13;
thus L566: ( D60 . C59 ) = ( D59 . C59 ) by L565 , L559 , L562 , FINSEQ_2:57;
end;
L567: D60 = D59 by L558 , FINSEQ_2:119;
L568: ( sum D58 ) = ( Sum D59 ) by L567 , L547 , L548 , RLAFFIN1:def 3
.= ( ( len C58 ) * R3 ) by RVSUM_1:80;
set D61 = ( D58 (#) C58 );
L569: ( len D61 ) = ( len C58 ) by RLVECT_2:def 7;
L570: ( dom D61 ) = ( dom C58 ) by L569 , FINSEQ_3:29;
L571:
now
let C60 being (Element of ( NAT ));
assume L572: C60 in ( dom C58 );
L573: (( C58 /. C60 ) = ( C58 . C60 ) & ( C58 . C60 ) in ( rng C58 )) by L572 , FUNCT_1:def 3 , PARTFUN1:def 6;
L574: (( D58 . ( C58 /. C60 ) ) = ( ( R13 --> R3 ) . ( C58 /. C60 ) ) & ( ( R13 --> R3 ) . ( C58 /. C60 ) ) = R3) by L573 , L522 , L535 , L548 , FUNCOP_1:7 , FUNCT_4:13;
thus L575: ( D61 . C60 ) = ( R3 * ( C58 /. C60 ) ) by L574 , L570 , L572 , RLVECT_2:def 7;
end;
L576: ( Sum D58 ) = ( R3 * ( Sum C58 ) ) by L571 , L549 , L569 , RLVECT_2:3
.= ( R3 * ( Sum R13 ) ) by L547 , L548 , L554 , RLVECT_2:def 2;
thus L577: thesis by L576 , L556 , L568;
end;
end;
theorem
L579: (for R6 being RealLinearSpace holds (for R13 being  finite (Subset of R6) holds (R13 is non  empty implies ( ( center_of_mass R6 ) . R13 ) in ( conv R13 ))))
proof
let R6 being RealLinearSpace;
let R13 being  finite (Subset of R6);
assume L580: R13 is non  empty;
reconsider D62 = R13 as non  empty  finite (Subset of R6) by L580;
consider C61 being (Linear_Combination of R13) such that L581: ( Sum C61 ) = ( ( 1 / ( card D62 ) ) * ( Sum D62 ) ) and L582: ( sum C61 ) = ( ( 1 / ( card D62 ) ) * ( card D62 ) ) and L583: C61 = ( ( ZeroLC R6 ) +* ( R13 --> ( 1 / ( card D62 ) ) ) ) by L521;
L584: ( dom ( R13 --> ( 1 / ( card D62 ) ) ) ) = R13 by FUNCOP_1:13;
L585: (for R7 being (VECTOR of R6) holds ( 0 ) <= ( C61 . R7 ))
proof
let R7 being (VECTOR of R6);
per cases ;
suppose L586: R7 in R13;

L587: ( C61 . R7 ) = ( ( R13 --> ( 1 / ( card D62 ) ) ) . R7 ) by L586 , L583 , L584 , FUNCT_4:13
.= ( 1 / ( card D62 ) ) by L586 , FUNCOP_1:7;
thus L588: thesis by L587;
end;
suppose L589: (not R7 in R13);

L590: ( C61 . R7 ) = ( ( ZeroLC R6 ) . R7 ) by L589 , L583 , L584 , FUNCT_4:11
.= ( 0 ) by RLVECT_2:20;
thus L591: thesis by L590;
end;
end;
L593: ( sum C61 ) = 1 by L582 , XCMPLX_1:87;
L594: C61 is  convex by L593 , L585 , RLAFFIN1:62;
L595: C61 in ( ConvexComb R6 ) by L594 , CONVEX3:def 1;
L596: ( Sum C61 ) in { ( Sum B68 ) where B68 is (Convex_Combination of D62) : B68 in ( ConvexComb R6 ) } by L595 , L594;
L597: ( Sum C61 ) in ( conv R13 ) by L596 , CONVEX3:5;
thus L598: thesis by L597 , L581 , L493;
end;
theorem
L599: (for R6 being RealLinearSpace holds (for R16 being (Subset-Family of R6) holds (( union R16 ) is  finite implies ( ( center_of_mass R6 ) .: R16 ) c= ( conv ( union R16 ) ))))
proof
let R6 being RealLinearSpace;
let R16 being (Subset-Family of R6);
set D63 = ( center_of_mass R6 );
assume L600: ( union R16 ) is  finite;
let R2 being set;
assume L601: R2 in ( D63 .: R16 );
consider R1 being set such that L602: R1 in ( dom D63 ) and L603: R1 in R16 and L604: ( D63 . R1 ) = R2 by L601 , FUNCT_1:def 6;
reconsider D64 = R1 as non  empty (Subset of R6) by L602 , ZFMISC_1:56;
L605: D64 c= ( union R16 ) by L603 , ZFMISC_1:74;
L606: R2 in ( conv D64 ) by L605 , L600 , L604 , L579;
L607: ( conv D64 ) c= ( conv ( union R16 ) ) by L603 , RLTOPSP1:20 , ZFMISC_1:74;
thus L608: thesis by L607 , L606;
end;
theorem
L609: (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R15 being  finite  affinely-independent (Subset of R6) holds (R7 in R15 implies ( ( ( ( center_of_mass R6 ) . R15 ) |-- R15 ) . R7 ) = ( 1 / ( card R15 ) )))))
proof
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R15 being  finite  affinely-independent (Subset of R6);
consider C62 being (Linear_Combination of R15) such that L610: (( Sum C62 ) = ( ( 1 / ( card R15 ) ) * ( Sum R15 ) ) & ( sum C62 ) = ( ( 1 / ( card R15 ) ) * ( card R15 ) )) and L611: C62 = ( ( ZeroLC R6 ) +* ( R15 --> ( 1 / ( card R15 ) ) ) ) by L521;
assume L612: R7 in R15;
L613: (( conv R15 ) c= ( Affin R15 ) & ( ( center_of_mass R6 ) . R15 ) in ( conv R15 )) by L612 , L579 , RLAFFIN1:65;
L614: (( ( center_of_mass R6 ) . R15 ) = ( Sum C62 ) & ( sum C62 ) = 1) by L610 , L612 , L493 , XCMPLX_1:87;
L615: (( dom ( R15 --> ( 1 / ( card R15 ) ) ) ) = R15 & C62 = ( ( ( center_of_mass R6 ) . R15 ) |-- R15 )) by L614 , L613 , FUNCOP_1:13 , RLAFFIN1:def 7;
thus L616: ( ( ( ( center_of_mass R6 ) . R15 ) |-- R15 ) . R7 ) = ( ( R15 --> ( 1 / ( card R15 ) ) ) . R7 ) by L615 , L611 , L612 , FUNCT_4:13
.= ( 1 / ( card R15 ) ) by L612 , FUNCOP_1:7;
end;
theorem
L617: (for R6 being RealLinearSpace holds (for R15 being  finite  affinely-independent (Subset of R6) holds (( ( center_of_mass R6 ) . R15 ) in R15 iff ( card R15 ) = 1)))
proof
let R6 being RealLinearSpace;
let R15 being  finite  affinely-independent (Subset of R6);
set D65 = ( center_of_mass R6 );
thus L618:now
assume L619: ( D65 . R15 ) in R15;
reconsider D66 = ( D65 . R15 ) as (Element of R6) by L619;
L620: ( D65 . R15 ) in ( conv R15 ) by L619 , L579;
L621: 1 = ( ( D66 |-- R15 ) . D66 ) by L620 , L619 , RLAFFIN1:72
.= ( 1 / ( card R15 ) ) by L619 , L609;
thus L622: 1 = ( card R15 ) by L621 , XCMPLX_1:58;
end;
assume L623: ( card R15 ) = 1;
consider R1 being set such that L624: { R1 } = R15 by L623 , CARD_2:42;
L625: R1 in R15 by L624 , TARSKI:def 1;
reconsider D67 = R1 as (Element of R6) by L625;
L626: ( ( center_of_mass R6 ) . R15 ) = ( ( 1 / ( card R15 ) ) * ( Sum R15 ) ) by L624 , L493
.= ( ( 1 / 1 ) * D67 ) by L623 , L624 , RLVECT_2:9
.= D67 by RLVECT_1:def 8;
thus L627: thesis by L626 , L624 , TARSKI:def 1;
end;
theorem
L628: (for R6 being RealLinearSpace holds (for R15 being  finite  affinely-independent (Subset of R6) holds (R15 is non  empty implies ( ( center_of_mass R6 ) . R15 ) in ( Int R15 ))))
proof
let R6 being RealLinearSpace;
let R15 being  finite  affinely-independent (Subset of R6);
set D68 = ( ( ( center_of_mass R6 ) . R15 ) |-- R15 );
L629: R15 c= ( Carrier D68 )
proof
let R1 being set;
assume L630: R1 in R15;
L631: ( D68 . R1 ) = ( 1 / ( card R15 ) ) by L630 , L609;
thus L632: thesis by L631 , L630;
end;
assume L633: R15 is non  empty;
L634: ( ( center_of_mass R6 ) . R15 ) in ( conv R15 ) by L633 , L579;
L635: ( Carrier D68 ) c= R15 by RLVECT_2:def 6;
L636: (( Carrier D68 ) = R15 & D68 is  convex) by L635 , L629 , L634 , RLAFFIN1:71 , XBOOLE_0:def 10;
L637: (( conv R15 ) c= ( Affin R15 ) & ( Sum D68 ) in ( Int R15 )) by L636 , L438 , RLAFFIN1:65;
thus L638: thesis by L637 , L634 , RLAFFIN1:def 7;
end;
theorem
L639: (for R6 being RealLinearSpace holds (for R11 being (Subset of R6) holds (for R15 being  finite  affinely-independent (Subset of R6) holds ((R11 c= R15 & ( ( center_of_mass R6 ) . R15 ) in ( Affin R11 )) implies R15 = R11))))
proof
let R6 being RealLinearSpace;
let R11 being (Subset of R6);
let R15 being  finite  affinely-independent (Subset of R6);
set D69 = ( center_of_mass R6 );
assume that
L640: R11 c= R15
and
L641: ( D69 . R15 ) in ( Affin R11 );
L642: ( ( D69 . R15 ) |-- R15 ) = ( ( D69 . R15 ) |-- R11 ) by L640 , L641 , RLAFFIN1:77;
reconsider D70 = R15 as  finite set;
assume L643: R15 <> R11;
L644: (not R15 c= R11) by L643 , L640 , XBOOLE_0:def 10;
consider R1 being set such that L645: R1 in R15 and L646: (not R1 in R11) by L644 , TARSKI:def 3;
reconsider D71 = R1 as (Element of R6) by L645;
L647: ( ( ( D69 . R15 ) |-- R15 ) . D71 ) = ( 1 / ( card D70 ) ) by L645 , L609;
L648: ( Carrier ( ( D69 . R15 ) |-- R11 ) ) c= R11 by RLVECT_2:def 6;
L649: (not D71 in ( Carrier ( ( D69 . R15 ) |-- R11 ) )) by L648 , L646;
thus L650: contradiction by L649 , L642 , L645 , L647;
end;
theorem
L651: (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R13 being  finite (Subset of R6) holds ((R7 in R13 & ( R13 \ { R7 } ) is non  empty) implies ( ( center_of_mass R6 ) . R13 ) = ( ( ( 1 - ( 1 / ( card R13 ) ) ) * ( ( center_of_mass R6 ) /. ( R13 \ { R7 } ) ) ) + ( ( 1 / ( card R13 ) ) * R7 ) )))))
proof
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R13 being  finite (Subset of R6);
set D72 = ( R13 \ { R7 } );
assume that
L652: R7 in R13
and
L653: D72 is non  empty;
consider C63 being (Linear_Combination of { R7 }) such that L654: ( C63 . R7 ) = ( 1 / ( card R13 ) ) by RLVECT_4:37;
consider C64 being (Linear_Combination of D72) such that L655: ( Sum C64 ) = ( ( 1 / ( card D72 ) ) * ( Sum D72 ) ) and L656: ( sum C64 ) = ( ( 1 / ( card D72 ) ) * ( card D72 ) ) and L657: C64 = ( ( ZeroLC R6 ) +* ( D72 --> ( 1 / ( card D72 ) ) ) ) by L521;
consider C65 being (Linear_Combination of R13) such that L658: ( Sum C65 ) = ( ( 1 / ( card R13 ) ) * ( Sum R13 ) ) and L659: ( sum C65 ) = ( ( 1 / ( card R13 ) ) * ( card R13 ) ) and L660: C65 = ( ( ZeroLC R6 ) +* ( R13 --> ( 1 / ( card R13 ) ) ) ) by L521;
L661: ( Sum C64 ) = ( ( center_of_mass R6 ) . D72 ) by L653 , L655 , L493;
L662: (for B69 being (Element of R6) holds ( C65 . B69 ) = ( ( ( ( 1 - ( 1 / ( card R13 ) ) ) * C64 ) + C63 ) . B69 ))
proof
let C66 being (Element of R6);
L663: (( ( ( ( 1 - ( 1 / ( card R13 ) ) ) * C64 ) + C63 ) . C66 ) = ( ( ( ( 1 - ( 1 / ( card R13 ) ) ) * C64 ) . C66 ) + ( C63 . C66 ) ) & ( ( ( 1 - ( 1 / ( card R13 ) ) ) * C64 ) . C66 ) = ( ( 1 - ( 1 / ( card R13 ) ) ) * ( C64 . C66 ) )) by RLVECT_2:def 10 , RLVECT_2:def 11;
L664: ( ( ZeroLC R6 ) . C66 ) = ( 0 ) by RLVECT_2:20;
L665: ( Carrier C63 ) c= { R7 } by RLVECT_2:def 6;
L666: ( dom ( R13 --> ( 1 / ( card R13 ) ) ) ) = R13 by FUNCOP_1:13;
L667: ( dom ( D72 --> ( 1 / ( card D72 ) ) ) ) = D72 by FUNCOP_1:13;
per cases ;
suppose L668: (not C66 in R13);

L669: (not C66 in ( Carrier C63 )) by L668 , L652 , L665 , TARSKI:def 1;
L670: ( C63 . C66 ) = ( 0 ) by L669;
L671: (not C66 in D72) by L668 , ZFMISC_1:56;
L672: ( C64 . C66 ) = ( 0 ) by L671 , L657 , L664 , L667 , FUNCT_4:11;
thus L673: thesis by L672 , L660 , L663 , L664 , L666 , L668 , L670 , FUNCT_4:11;
end;
suppose L674: R7 = C66;

L675: (not C66 in D72) by L674 , ZFMISC_1:56;
L676: ( C64 . C66 ) = ( 0 ) by L675 , L657 , L664 , L667 , FUNCT_4:11;
L677: ( C65 . C66 ) = ( ( R13 --> ( 1 / ( card R13 ) ) ) . R7 ) by L652 , L660 , L666 , L674 , FUNCT_4:13;
thus L678: thesis by L677 , L652 , L654 , L663 , L674 , L676 , FUNCOP_1:7;
end;
suppose L679: (C66 in R13 & C66 <> R7);

L680: ( C65 . C66 ) = ( ( R13 --> ( 1 / ( card R13 ) ) ) . C66 ) by L679 , L660 , L666 , FUNCT_4:13;
L681: ( C65 . C66 ) = ( 1 / ( card R13 ) ) by L680 , L679 , FUNCOP_1:7;
L682: (not C66 in ( Carrier C63 )) by L665 , L679 , TARSKI:def 1;
L683: ( C63 . C66 ) = ( 0 ) by L682;
L684: ((not R7 in D72) & ( D72 \/ { R7 } ) = R13) by L652 , ZFMISC_1:56 , ZFMISC_1:116;
L685: ( card R13 ) = ( ( card D72 ) + 1 ) by L684 , CARD_2:41;
L686: ( 1 - ( 1 / ( card R13 ) ) ) = ( ( ( card R13 ) / ( card R13 ) ) - ( 1 / ( card R13 ) ) ) by L652 , XCMPLX_1:60
.= ( ( ( card R13 ) - 1 ) / ( card R13 ) ) by XCMPLX_1:120
.= ( ( card D72 ) / ( card R13 ) ) by L685;
L687: ( ( 1 - ( 1 / ( card R13 ) ) ) * ( 1 / ( card D72 ) ) ) = ( ( ( card D72 ) / ( card R13 ) ) / ( card D72 ) ) by L686 , XCMPLX_1:99
.= ( ( ( card D72 ) / ( card D72 ) ) / ( card R13 ) ) by XCMPLX_1:48
.= ( 1 / ( card R13 ) ) by L653 , XCMPLX_1:60;
L688: C66 in D72 by L679 , ZFMISC_1:56;
L689: ( C64 . C66 ) = ( ( D72 --> ( 1 / ( card D72 ) ) ) . C66 ) by L688 , L657 , L667 , FUNCT_4:13;
thus L690: thesis by L689 , L663 , L681 , L683 , L687 , L688 , FUNCOP_1:7;
end;
end;
L692: C65 = ( ( ( 1 - ( 1 / ( card R13 ) ) ) * C64 ) + C63 ) by L662 , RLVECT_2:def 9;
L693: ( dom ( center_of_mass R6 ) ) = ( BOOL (the carrier of R6) ) by FUNCT_2:def 1;
L694: D72 in ( dom ( center_of_mass R6 ) ) by L693 , L653 , ZFMISC_1:56;
L695: ( Sum C65 ) = ( ( center_of_mass R6 ) . R13 ) by L652 , L658 , L493;
thus L696: ( ( center_of_mass R6 ) . R13 ) = ( ( Sum ( ( 1 - ( 1 / ( card R13 ) ) ) * C64 ) ) + ( Sum C63 ) ) by L695 , L692 , RLVECT_3:1
.= ( ( ( 1 - ( 1 / ( card R13 ) ) ) * ( Sum C64 ) ) + ( Sum C63 ) ) by RLVECT_3:2
.= ( ( ( 1 - ( 1 / ( card R13 ) ) ) * ( Sum C64 ) ) + ( ( 1 / ( card R13 ) ) * R7 ) ) by L654 , RLVECT_2:32
.= ( ( ( 1 - ( 1 / ( card R13 ) ) ) * ( ( center_of_mass R6 ) /. D72 ) ) + ( ( 1 / ( card R13 ) ) * R7 ) ) by L661 , L694 , PARTFUN1:def 6;
end;
theorem
L697: (for R6 being RealLinearSpace holds (for R11 being (Subset of R6) holds (for R15 being  finite  affinely-independent (Subset of R6) holds ((( conv R11 ) c= ( conv R15 ) & R15 is non  empty & ( conv R11 ) misses ( Int R15 )) implies (ex B70 being (Subset of R6) st (B70 c< R15 & ( conv R11 ) c= ( conv B70 )))))))
proof
let R6 being RealLinearSpace;
let R11 being (Subset of R6);
let R15 being  finite  affinely-independent (Subset of R6);
assume that
L698: ( conv R11 ) c= ( conv R15 )
and
L699: R15 is non  empty
and
L700: ( conv R11 ) misses ( Int R15 );
reconsider D73 = R15 as non  empty  finite  affinely-independent (Subset of R6) by L699;
set D74 = { B71 where B71 is (Subset of R6) : (B71 c= D73 & (ex R1 being set st (R1 in ( conv R11 ) & R1 in ( Int B71 )))) };
L701: D74 c= ( bool (the carrier of R6) )
proof
let R1 being set;
assume L702: R1 in D74;
L703: (ex B72 being (Subset of R6) st (B72 = R1 & B72 c= D73 & (ex R2 being set st (R2 in ( conv R11 ) & R2 in ( Int B72 ))))) by L702;
thus L704: thesis by L703;
end;
reconsider D75 = D74 as (Subset-Family of R6) by L701;
take D76 = ( union D75 );
L705: ( conv R11 ) c= ( conv D76 )
proof
let C67 being set;
assume L706: C67 in ( conv R11 );
L707: C67 in ( conv D73 ) by L706 , L698;
L708: C67 in ( union { ( Int B73 ) where B73 is (Subset of R6) : B73 c= D73 } ) by L707 , L325;
consider C68 being set such that L709: C67 in C68 and L710: C68 in { ( Int B74 ) where B74 is (Subset of R6) : B74 c= D73 } by L708 , TARSKI:def 4;
consider C69 being (Subset of R6) such that L711: C68 = ( Int C69 ) and L712: C69 c= D73 by L710;
L713: ( Int C69 ) c= ( conv C69 ) by L286;
L714: C67 in ( conv C69 ) by L713 , L709 , L711;
L715: C69 in D75 by L706 , L709 , L711 , L712;
L716: ( conv C69 ) c= ( conv D76 ) by L715 , RLAFFIN1:3 , ZFMISC_1:74;
thus L717: thesis by L716 , L714;
end;
L718: D76 c= D73
proof
let R1 being set;
assume L719: R1 in D76;
consider C70 being set such that L720: R1 in C70 and L721: C70 in D75 by L719 , TARSKI:def 4;
L722: (ex B75 being (Subset of R6) st (C70 = B75 & B75 c= D73 & (ex R2 being set st (R2 in ( conv R11 ) & R2 in ( Int B75 ))))) by L721;
thus L723: thesis by L722 , L720;
end;
L724: D76 <> D73
proof
defpred S4[ set , set ] means (for B76 being (Subset of R6) holds (B76 = $2 implies ($1 in B76 & (ex R1 being set st (R1 in ( conv R11 ) & R1 in ( Int B76 ))))));
assume L725: D76 = D73;
L726: (for R1 being set holds (R1 in D73 implies (ex R2 being set st (R2 in ( bool D73 ) & S4[ R1 , R2 ]))))
proof
let R1 being set;
assume L727: R1 in D73;
consider C71 being set such that L728: R1 in C71 and L729: C71 in D75 by L727 , L725 , TARSKI:def 4;
consider C72 being (Subset of R6) such that L730: (C71 = C72 & C72 c= D73 & (ex R2 being set st (R2 in ( conv R11 ) & R2 in ( Int C72 )))) by L729;
take C72;
thus L731: thesis by L728 , L730;
end;
consider C73 being (Function of D73 , ( bool D73 )) such that L732: (for R1 being set holds (R1 in D73 implies S4[ R1 , ( C73 . R1 ) ])) from FUNCT_2:sch 1(L726);
defpred S5[ set , set ] means (for B77 being (Subset of R6) holds (B77 = ( C73 . $1 ) implies ($2 in ( conv R11 ) & $2 in ( Int B77 ))));
L733: ( dom C73 ) = D73 by FUNCT_2:def 1;
L734: (for R1 being set holds (R1 in D73 implies (ex R2 being set st (R2 in (the carrier of R6) & S5[ R1 , R2 ]))))
proof
let R1 being set;
assume L735: R1 in D73;
L736: ( C73 . R1 ) in ( rng C73 ) by L735 , L733 , FUNCT_1:def 3;
reconsider D77 = ( C73 . R1 ) as (Subset of R6) by L736 , XBOOLE_1:1;
consider R2 being set such that L737: (R2 in ( conv R11 ) & R2 in ( Int D77 )) by L732 , L735;
take R2;
thus L738: thesis by L737;
end;
consider C74 being (Function of D73 , R6) such that L739: (for R1 being set holds (R1 in D73 implies S5[ R1 , ( C74 . R1 ) ])) from FUNCT_2:sch 1(L734);
reconsider D78 = ( rng C74 ) as non  empty  finite (Subset of R6);
L740: D78 c= ( conv R11 )
proof
let R2 being set;
assume L741: R2 in D78;
consider R1 being set such that L742: R1 in ( dom C74 ) and L743: R2 = ( C74 . R1 ) by L741 , FUNCT_1:def 3;
L744: ( C73 . R1 ) in ( rng C73 ) by L733 , L742 , FUNCT_1:def 3;
reconsider D79 = ( C73 . R1 ) as (Subset of R6) by L744 , XBOOLE_1:1;
L745: D79 = ( C73 . R1 );
thus L746: thesis by L745 , L739 , L742 , L743;
end;
L747: D78 c= ( conv D76 ) by L740 , L705 , XBOOLE_1:1;
L748: ( conv D78 ) c= ( conv R11 ) by L740 , CONVEX1:30;
L749: ( dom C74 ) = D73 by FUNCT_2:def 1;
L750: ( ( 1 / ( card D78 ) ) * ( card D78 ) ) = ( ( card D78 ) / ( card D78 ) ) by XCMPLX_1:99
.= 1 by XCMPLX_1:60;
consider C75 being (Linear_Combination of D78) such that L751: ( Sum C75 ) = ( ( 1 / ( card D78 ) ) * ( Sum D78 ) ) and L752: ( sum C75 ) = ( ( 1 / ( card D78 ) ) * ( card D78 ) ) and L753: C75 = ( ( ZeroLC R6 ) +* ( D78 --> ( 1 / ( card D78 ) ) ) ) by L521;
set D80 = ( Sum C75 );
set D81 = ( D80 |-- D73 );
L754: ( Sum C75 ) = ( ( center_of_mass R6 ) . D78 ) by L751 , L493;
L755: ( Sum C75 ) in ( conv D78 ) by L754 , L579;
L756: ( dom ( D78 --> ( 1 / ( card D78 ) ) ) ) = D78 by FUNCOP_1:13;
L757:
now
let R1 being set;
assume L758: R1 in D78;
thus L759: ( C75 . R1 ) = ( ( D78 --> ( 1 / ( card D78 ) ) ) . R1 ) by L758 , L753 , L756 , FUNCT_4:13
.= ( 1 / ( card D78 ) ) by L758 , FUNCOP_1:7;
end;
L760: D78 c= ( Carrier C75 )
proof
let R1 being set;
assume L761: R1 in D78;
L762: ( C75 . R1 ) <> ( 0 ) by L761 , L757;
thus L763: thesis by L762 , L761;
end;
L764: ( conv D76 ) c= ( conv D73 ) by L718 , RLAFFIN1:3;
L765: D78 c= ( conv D73 ) by L764 , L747 , XBOOLE_1:1;
L766: ( conv D78 ) c= ( conv D73 ) by L765 , CONVEX1:30;
L767: D80 in ( conv D73 ) by L766 , L755;
L768: D78 c= ( conv D73 ) by L747 , L764 , XBOOLE_1:1;
L769: ( Carrier C75 ) c= D78 by RLVECT_2:def 6;
L770: D78 = ( Carrier C75 ) by L769 , L760 , XBOOLE_0:def 10;
L771: D73 c= ( Carrier D81 )
proof
let R1 being set;
assume L772: R1 in D73;
consider C76 being (FinSequence of ( REAL )), C77 being (FinSequence of R6) such that L773: ( D81 . R1 ) = ( Sum C76 ) and L774: ( len C77 ) = ( len C76 ) and L775: C77 is  one-to-one and L776: ( rng C77 ) = ( Carrier C75 ) and L777: (for R5 being Nat holds (R5 in ( dom C76 ) implies ( C76 . R5 ) = ( ( C75 . ( C77 . R5 ) ) * ( ( ( C77 . R5 ) |-- D73 ) . R1 ) ))) by L772 , L750 , L752 , L765 , L115;
L778: ( C73 . R1 ) in ( rng C73 ) by L733 , L772 , FUNCT_1:def 3;
reconsider D82 = ( C73 . R1 ) as (Subset of R6) by L778 , XBOOLE_1:1;
L779: ( Int D82 ) c= ( conv D82 ) by L286;
L780: ( C74 . R1 ) in ( Int D82 ) by L739 , L772;
L781: ( C74 . R1 ) in ( conv D82 ) by L780 , L779;
L782: R1 in D82 by L732 , L772;
L783: ( conv D82 ) c= ( Affin D82 ) by RLAFFIN1:65;
L784: D82 is  affinely-independent by L778 , RLAFFIN1:43;
L785: ( Sum ( ( C74 . R1 ) |-- D82 ) ) = ( C74 . R1 ) by L784 , L781 , L783 , RLAFFIN1:def 7;
L786: ( Carrier ( ( C74 . R1 ) |-- D82 ) ) = D82 by L785 , L779 , L780 , L784 , L428 , RLAFFIN1:71;
L787: ( ( C74 . R1 ) |-- D82 ) = ( ( C74 . R1 ) |-- D73 ) by L778 , L781 , L783 , RLAFFIN1:77;
L788: ( ( ( C74 . R1 ) |-- D73 ) . R1 ) <> ( 0 ) by L787 , L782 , L786 , RLVECT_2:19;
L789: ( conv D82 ) c= ( conv D73 ) by L778 , RLAFFIN1:3;
L790: ( ( ( C74 . R1 ) |-- D73 ) . R1 ) >= ( 0 ) by L789 , L772 , L781 , RLAFFIN1:71;
L791: ( C74 . R1 ) in D78 by L749 , L772 , FUNCT_1:def 3;
L792: ( C75 . ( C74 . R1 ) ) = ( 1 / ( card D78 ) ) by L791 , L757;
L793: ( dom C77 ) = ( dom C76 ) by L774 , FINSEQ_3:29;
L794:
now
let C78 being Nat;
assume L795: C78 in ( dom C76 );
L796: ( C77 . C78 ) in D78 by L795 , L770 , L776 , L793 , FUNCT_1:def 3;
L797: (( C75 . ( C77 . C78 ) ) > ( 0 ) & ( ( ( C77 . C78 ) |-- D73 ) . R1 ) >= ( 0 )) by L796 , L757 , L768 , L772 , RLAFFIN1:71;
L798: ( C76 . C78 ) = ( ( C75 . ( C77 . C78 ) ) * ( ( ( C77 . C78 ) |-- D73 ) . R1 ) ) by L777 , L795;
thus L799: ( 0 ) <= ( C76 . C78 ) by L798 , L797;
end;
consider C79 being set such that L800: C79 in ( dom C77 ) and L801: ( C77 . C79 ) = ( C74 . R1 ) by L760 , L776 , L791 , FUNCT_1:def 3;
L802: ( C76 . C79 ) = ( ( C75 . ( C74 . R1 ) ) * ( ( ( C74 . R1 ) |-- D73 ) . R1 ) ) by L777 , L793 , L800 , L801;
L803: ( D81 . R1 ) > ( 0 ) by L802 , L773 , L788 , L790 , L792 , L793 , L794 , L800 , RVSUM_1:85;
thus L804: thesis by L803 , L772;
end;
L805: ( Carrier D81 ) c= D73 by RLVECT_2:def 6;
L806: (( Carrier D81 ) = D73 & D81 is  convex) by L805 , L771 , L755 , L766 , RLAFFIN1:71 , XBOOLE_0:def 10;
L807: (( conv D73 ) c= ( Affin D73 ) & ( Sum D81 ) in ( Int D73 )) by L806 , L438 , RLAFFIN1:65;
L808: D80 in ( Int D73 ) by L807 , L767 , RLAFFIN1:def 7;
thus L809: contradiction by L808 , L700 , L748 , L755 , XBOOLE_0:3;
end;
thus L810: thesis by L724 , L705 , L718 , XBOOLE_0:def 8;
end;
theorem
L811: (for R6 being RealLinearSpace holds (for R17 being (Linear_Combination of R6) holds (for R18 being (Linear_Combination of R6) holds ((( Sum R17 ) <> ( Sum R18 ) & ( sum R17 ) = ( sum R18 )) implies (ex R7 being (VECTOR of R6) st ( R17 . R7 ) > ( R18 . R7 ))))))
proof
let R6 being RealLinearSpace;
let R17 being (Linear_Combination of R6);
let R18 being (Linear_Combination of R6);
assume that
L812: ( Sum R17 ) <> ( Sum R18 )
and
L813: ( sum R17 ) = ( sum R18 );
consider C80 being FinSequence such that L814: ( rng C80 ) = ( ( Carrier R17 ) \/ ( Carrier R18 ) ) and L815: C80 is  one-to-one by FINSEQ_4:58;
reconsider D83 = C80 as (FinSequence of R6) by L814 , FINSEQ_1:def 4;
L816: ( len ( R18 * D83 ) ) = ( len D83 ) by FINSEQ_2:33;
L817: ( len ( R17 * D83 ) ) = ( len D83 ) by FINSEQ_2:33;
reconsider D84 = ( R17 * D83 ) , D85 = ( R18 * D83 ) as (Element of ( ( len D83 ) -tuples_on ( REAL ) )) by L817 , L816 , FINSEQ_2:92;
L818: ( len ( D85 - D84 ) ) = ( len D83 ) by CARD_1:def 7;
assume L819: (for B78 being (Element of R6) holds ( R17 . B78 ) <= ( R18 . B78 ));
L820: (for B79 being Nat holds (B79 in ( dom ( D85 - D84 ) ) implies ( 0 ) <= ( ( D85 - D84 ) . B79 )))
proof
let C81 being Nat;
L821: ( R18 . ( D83 /. C81 ) ) >= ( R17 . ( D83 /. C81 ) ) by L819;
L822: ( ( R18 . ( D83 /. C81 ) ) - ( R17 . ( D83 /. C81 ) ) ) >= ( ( R17 . ( D83 /. C81 ) ) - ( R17 . ( D83 /. C81 ) ) ) by L821 , XREAL_1:9;
assume L823: C81 in ( dom ( D85 - D84 ) );
L824: C81 in ( dom D83 ) by L823 , L818 , FINSEQ_3:29;
L825: ( D83 /. C81 ) = ( D83 . C81 ) by L824 , PARTFUN1:def 6;
L826: C81 in ( dom D85 ) by L816 , L818 , L823 , FINSEQ_3:29;
L827: ( D85 . C81 ) = ( R18 . ( D83 . C81 ) ) by L826 , FUNCT_1:12;
L828: C81 in ( dom D84 ) by L817 , L818 , L823 , FINSEQ_3:29;
L829: ( D84 . C81 ) = ( R17 . ( D83 . C81 ) ) by L828 , FUNCT_1:12;
thus L830: thesis by L829 , L822 , L825 , L827 , RVSUM_1:27;
end;
L831: ( Sum ( D85 - D84 ) ) = ( ( Sum D85 ) - ( Sum D84 ) ) by RVSUM_1:90
.= ( ( sum R18 ) - ( Sum D84 ) ) by L814 , L815 , RLAFFIN1:30 , XBOOLE_1:7
.= ( ( sum R18 ) - ( sum R17 ) ) by L814 , L815 , RLAFFIN1:30 , XBOOLE_1:7
.= ( 0 ) by L813;
L832:
now
let C82 being (Element of R6);
L833:
now
per cases  by L814 , XBOOLE_0:def 3;
suppose L834: ((not C82 in ( Carrier R17 )) & (not C82 in ( Carrier R18 )));

L835: ( R17 . C82 ) = ( 0 ) by L834;
thus L836: ( R17 . C82 ) = ( R18 . C82 ) by L835 , L834;
end;
suppose L837: C82 in ( rng D83 );

consider C83 being set such that L838: C83 in ( dom D83 ) and L839: ( D83 . C83 ) = C82 by L837 , FUNCT_1:def 3;
reconsider D86 = C83 as Nat by L838;
L840: D86 in ( dom D85 ) by L816 , L838 , FINSEQ_3:29;
L841: (( ( D85 - D84 ) . D86 ) = ( ( D85 . D86 ) - ( D84 . D86 ) ) & ( D85 . D86 ) = ( R18 . C82 )) by L840 , L839 , FUNCT_1:12 , RVSUM_1:27;
L842: D86 in ( dom D84 ) by L817 , L838 , FINSEQ_3:29;
L843: ( D84 . D86 ) = ( R17 . C82 ) by L842 , L839 , FUNCT_1:12;
L844: D86 in ( dom ( D85 - D84 ) ) by L818 , L838 , FINSEQ_3:29;
L845: ( ( R18 . C82 ) - ( R17 . C82 ) ) <= ( 0 ) by L844 , L820 , L831 , L841 , L843 , RVSUM_1:85;
L846: ( ( R18 . C82 ) - ( R17 . C82 ) ) = ( 0 ) by L845 , L820 , L841 , L843 , L844;
thus L847: ( R17 . C82 ) = ( R18 . C82 ) by L846;
end;
end;
thus L849: ( R17 . C82 ) = ( R18 . C82 ) by L833;
end;
thus L850: contradiction by L832 , L812 , RLVECT_2:def 9;
end;
L851: (for R3 being Real holds (for R4 being Real holds (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R17 being (Linear_Combination of R6) holds (for R18 being (Linear_Combination of R6) holds (( R17 . R7 ) <> ( R18 . R7 ) implies (( ( ( R3 * R17 ) + ( ( 1 - R3 ) * R18 ) ) . R7 ) = R4 iff R3 = ( ( ( R18 . R7 ) - R4 ) / ( ( R18 . R7 ) - ( R17 . R7 ) ) )))))))))
proof
let R3 being Real;
let R4 being Real;
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R17 being (Linear_Combination of R6);
let R18 being (Linear_Combination of R6);
set D87 = ( R17 . R7 );
set D88 = ( R18 . R7 );
L852: ( ( ( R3 * R17 ) + ( ( 1 - R3 ) * R18 ) ) . R7 ) = ( ( ( R3 * R17 ) . R7 ) + ( ( ( 1 - R3 ) * R18 ) . R7 ) ) by RLVECT_2:def 10
.= ( ( R3 * D87 ) + ( ( ( 1 - R3 ) * R18 ) . R7 ) ) by RLVECT_2:def 11
.= ( ( R3 * D87 ) + ( ( ( - R3 ) + 1 ) * D88 ) ) by RLVECT_2:def 11
.= ( ( R3 * ( D87 - D88 ) ) + D88 );
assume L853: D87 <> D88;
L854: ( D87 - D88 ) <> ( 0 ) by L853;
L855: ( D88 - D87 ) <> ( 0 ) by L853;
thus L856:now
assume L857: ( ( ( R3 * R17 ) + ( ( 1 - R3 ) * R18 ) ) . R7 ) = R4;
L858: ( R3 * ( D88 - D87 ) ) = ( ( D88 - R4 ) * 1 ) by L857 , L852;
L859: ( R3 / 1 ) = ( ( D88 - R4 ) / ( D88 - D87 ) ) by L858 , L855 , XCMPLX_1:94;
thus L860: R3 = ( ( D88 - R4 ) / ( D88 - D87 ) ) by L859;
end;
assume L861: R3 = ( ( D88 - R4 ) / ( D88 - D87 ) );
thus L862: ( ( ( R3 * R17 ) + ( ( 1 - R3 ) * R18 ) ) . R7 ) = ( ( ( ( D88 - R4 ) / ( - ( D87 - D88 ) ) ) * ( D87 - D88 ) ) + D88 ) by L861 , L852
.= ( ( ( ( - ( D88 - R4 ) ) / ( D87 - D88 ) ) * ( D87 - D88 ) ) + D88 ) by XCMPLX_1:192
.= ( ( - ( D88 - R4 ) ) + D88 ) by L854 , XCMPLX_1:87
.= R4;
end;
theorem
L863: (for R3 being Real holds (for R4 being Real holds (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R17 being (Linear_Combination of R6) holds (for R18 being (Linear_Combination of R6) holds (for B80 being Real holds ((( ( ( R3 * R17 ) + ( ( 1 - R3 ) * R18 ) ) . R7 ) <= B80 & B80 <= ( ( ( R4 * R17 ) + ( ( 1 - R4 ) * R18 ) ) . R7 )) implies (ex B81 being Real st (( ( ( B81 * R17 ) + ( ( 1 - B81 ) * R18 ) ) . R7 ) = B80 & (R3 <= R4 implies (R3 <= B81 & B81 <= R4)) & (R4 <= R3 implies (R4 <= B81 & B81 <= R3))))))))))))
proof
let R3 being Real;
let R4 being Real;
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R17 being (Linear_Combination of R6);
let R18 being (Linear_Combination of R6);
let C84 being Real;
set D89 = ( ( ( R3 * R17 ) + ( ( 1 - R3 ) * R18 ) ) . R7 );
set D90 = ( ( ( R4 * R17 ) + ( ( 1 - R4 ) * R18 ) ) . R7 );
set D91 = ( R17 . R7 );
set D92 = ( R18 . R7 );
L864: D89 = ( ( ( R3 * R17 ) . R7 ) + ( ( ( 1 - R3 ) * R18 ) . R7 ) ) by RLVECT_2:def 10
.= ( ( R3 * D91 ) + ( ( ( 1 - R3 ) * R18 ) . R7 ) ) by RLVECT_2:def 11
.= ( ( R3 * D91 ) + ( ( 1 - R3 ) * D92 ) ) by RLVECT_2:def 11;
L865: D90 = ( ( ( R4 * R17 ) . R7 ) + ( ( ( 1 - R4 ) * R18 ) . R7 ) ) by RLVECT_2:def 10
.= ( ( R4 * D91 ) + ( ( ( 1 - R4 ) * R18 ) . R7 ) ) by RLVECT_2:def 11
.= ( ( R4 * D91 ) + ( ( 1 - R4 ) * D92 ) ) by RLVECT_2:def 11;
assume that
L866: D89 <= C84
and
L867: C84 <= D90;
per cases ;
suppose L868: D89 = D90;

take R3;
thus L869: thesis by L866 , L867 , L868 , XXREAL_0:1;
end;
suppose L870: D89 <> D90;

L871: ( D90 - D89 ) <> ( 0 ) by L870;
set D93 = ( ( C84 - D89 ) / ( D90 - D89 ) );
set D94 = ( ( D90 - C84 ) / ( D90 - D89 ) );
take D95 = ( ( R3 * D94 ) + ( R4 * D93 ) );
L872: (( ( R3 * D94 ) + ( R3 * D93 ) ) = ( R3 * ( D94 + D93 ) ) & ( ( R4 * D94 ) + ( R4 * D93 ) ) = ( R4 * ( D94 + D93 ) ));
L873: ( D94 + D93 ) = ( ( ( D90 - C84 ) + ( C84 - D89 ) ) / ( D90 - D89 ) ) by XCMPLX_1:62
.= 1 by L871 , XCMPLX_1:60;
L874: ( C84 - D89 ) >= ( D89 - D89 ) by L866 , XREAL_1:9;
thus L875: C84 = ( ( C84 * ( D90 - D89 ) ) / ( D90 - D89 ) ) by L871 , XCMPLX_1:89
.= ( ( ( D89 * ( D90 - C84 ) ) + ( D90 * ( C84 - D89 ) ) ) / ( D90 - D89 ) )
.= ( ( ( D89 * ( D90 - C84 ) ) / ( D90 - D89 ) ) + ( ( D90 * ( C84 - D89 ) ) / ( D90 - D89 ) ) ) by XCMPLX_1:62
.= ( ( ( D89 * ( D90 - C84 ) ) / ( D90 - D89 ) ) + ( ( ( C84 - D89 ) / ( D90 - D89 ) ) * D90 ) ) by XCMPLX_1:74
.= ( ( D94 * ( ( R3 * D91 ) + ( ( 1 - R3 ) * D92 ) ) ) + ( D93 * ( ( R4 * D91 ) + ( ( 1 - R4 ) * D92 ) ) ) ) by L864 , L865 , XCMPLX_1:74
.= ( ( ( D95 * D91 ) + ( ( D94 + D93 ) * D92 ) ) - ( D95 * D92 ) )
.= ( ( ( D95 * D91 ) + ( 1 * D92 ) ) - ( D95 * D92 ) ) by L873
.= ( ( D95 * D91 ) + ( ( 1 - D95 ) * D92 ) )
.= ( ( D95 * D91 ) + ( ( ( 1 - D95 ) * R18 ) . R7 ) ) by RLVECT_2:def 11
.= ( ( ( D95 * R17 ) . R7 ) + ( ( ( 1 - D95 ) * R18 ) . R7 ) ) by RLVECT_2:def 11
.= ( ( ( D95 * R17 ) + ( ( 1 - D95 ) * R18 ) ) . R7 ) by RLVECT_2:def 10;
L876: (( D90 - D89 ) >= ( D90 - C84 ) & ( D90 - C84 ) >= ( C84 - C84 )) by L866 , L867 , XREAL_1:9 , XREAL_1:10;
thus L877:now
assume L878: R3 <= R4;
L879: (( R3 * D94 ) <= ( R4 * D94 ) & ( R3 * D93 ) <= ( R4 * D93 )) by L878 , L874 , L876 , XREAL_1:64;
thus L880: (R3 <= D95 & D95 <= R4) by L879 , L872 , L873 , XREAL_1:6;
end;
assume L881: R4 <= R3;
L882: ( R3 * D94 ) >= ( R4 * D94 ) by L881 , L876 , XREAL_1:64;
L883: ( D90 - D89 ) >= ( C84 - D89 ) by L867 , XREAL_1:9;
L884: ( R3 * D93 ) >= ( R4 * D93 ) by L883 , L874 , L881 , XREAL_1:64;
thus L885: thesis by L884 , L872 , L873 , L882 , XREAL_1:6;
end;
end;
theorem
L887: (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R8 being (VECTOR of R6) holds (for R11 being (Subset of R6) holds ((R7 in ( conv R11 ) & R8 in ( conv R11 ) & R7 <> R8) implies (ex R10 being (VECTOR of R6) st (ex R9 being (VECTOR of R6) st (ex R3 being Real st (R10 in R11 & R9 in ( conv ( R11 \ { R10 } ) ) & ( 0 ) <= R3 & R3 < 1 & ( ( R3 * R8 ) + ( ( 1 - R3 ) * R9 ) ) = R7)))))))))
proof
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R8 being (VECTOR of R6);
let R11 being (Subset of R6);
reconsider D96 = ( 0 ) as Real by XREAL_0:def 1;
assume that
L888: R7 in ( conv R11 )
and
L889: R8 in ( conv R11 )
and
L890: R7 <> R8;
reconsider D97 = R11 as non  empty (Subset of R6) by L888;
L891: ( conv D97 ) = { ( Sum B82 ) where B82 is (Convex_Combination of D97) : B82 in ( ConvexComb R6 ) } by CONVEX3:5;
consider C85 being (Convex_Combination of D97) such that L892: R7 = ( Sum C85 ) and L893: C85 in ( ConvexComb R6 ) by L891 , L888;
set D98 = ( Carrier C85 );
L894: D98 c= R11 by RLVECT_2:def 6;
consider C86 being (Convex_Combination of D97) such that L895: R8 = ( Sum C86 ) and L896: C86 in ( ConvexComb R6 ) by L889 , L891;
set D99 = ( Carrier C86 );
L897: D99 c= R11 by RLVECT_2:def 6;
L898: ( D98 \/ D99 ) c= R11 by L897 , L894 , XBOOLE_1:8;
per cases ;
suppose L899: (not D99 c= D98);

consider C87 being set such that L900: C87 in D99 and L901: (not C87 in D98) by L899 , TARSKI:def 3;
reconsider D100 = C87 as (Element of R6) by L900;
L902: (( Carrier C85 ) <> ( {} ) & ( Carrier C85 ) c= ( R11 \ { D100 } )) by L894 , L901 , CONVEX1:21 , ZFMISC_1:34;
reconsider D101 = ( R11 \ { D100 } ) as non  empty (Subset of R6) by L902;
L903: ( Carrier C85 ) c= D101 by L894 , L901 , ZFMISC_1:34;
reconsider D102 = C85 as (Linear_Combination of D101) by L903 , RLVECT_2:def 6;
take D100;
take D103 = R7;
take D96;
L904: ( ( D96 * R8 ) + ( ( 1 - D96 ) * D103 ) ) = ( ( 0. R6 ) + ( 1 * D103 ) ) by RLVECT_1:10
.= ( ( 0. R6 ) + D103 ) by RLVECT_1:def 8
.= R7 by RLVECT_1:4;
L905: ( Sum D102 ) in { ( Sum B83 ) where B83 is (Convex_Combination of D101) : B83 in ( ConvexComb R6 ) } by L893;
thus L906: thesis by L905 , L892 , L897 , L900 , L904 , CONVEX3:5;
end;
suppose L907: D99 c= D98;

defpred S6[ set , set ] means (for R3 being Real holds (for B84 being (Element of R6) holds ((R3 = $2 & B84 = $1) implies (R3 < ( 0 ) & ( C85 . B84 ) <> ( C86 . B84 ) & ( ( ( R3 * C86 ) + ( ( 1 - R3 ) * C85 ) ) . B84 ) = ( 0 )))));
set D104 = { B85 where B85 is (Element of ( REAL )) : (ex B86 being (Element of R6) st (S6[ B86 , B85 ] & B86 in ( D98 \/ D99 ))) };
L908:
now
let R1 being set;
assume L909: R1 in D104;
L910: (ex B87 being (Element of ( REAL )) st (B87 = R1 & (ex B88 being (Element of R6) st (S6[ B88 , B87 ] & B88 in ( D98 \/ D99 ))))) by L909;
thus L911: R1 is  real by L910;
end;
L912: (for B89 being (Element of R6) holds (for B90 , B91 being (Element of ( REAL )) holds ((S6[ B89 , B90 ] & S6[ B89 , B91 ]) implies B90 = B91)))
proof
let C88 being (Element of R6);
let C89 , C90 being (Element of ( REAL ));
assume L913: S6[ C88 , C89 ];
L914: ( ( ( C89 * C86 ) + ( ( 1 - C89 ) * C85 ) ) . C88 ) = ( 0 ) by L913;
L915: ( C85 . C88 ) <> ( C86 . C88 ) by L913;
assume L916: S6[ C88 , C90 ];
L917: ( ( ( C90 * C86 ) + ( ( 1 - C90 ) * C85 ) ) . C88 ) = ( 0 ) by L916;
L918: C90 = ( ( ( C85 . C88 ) - ( 0 ) ) / ( ( C85 . C88 ) - ( C86 . C88 ) ) ) by L917 , L915 , L851
.= C89 by L914 , L915 , L851;
thus L919: thesis by L918;
end;
L920: (( sum C86 ) = 1 & ( sum C85 ) = 1) by RLAFFIN1:62;
consider C91 being (Element of R6) such that L921: ( C86 . C91 ) > ( C85 . C91 ) by L920 , L890 , L892 , L895 , L811;
L922: ( C85 . C91 ) <> ( 0 )
proof
assume L923: ( C85 . C91 ) = ( 0 );
L924: (not C91 in D99) by L923 , L907 , RLVECT_2:19;
thus L925: contradiction by L924 , L921 , L923;
end;
L926: C91 in D98 by L922;
L927: C91 in ( D98 \/ D99 ) by L926 , XBOOLE_0:def 3;
set D105 = ( ( C85 . C91 ) / ( ( C85 . C91 ) - ( C86 . C91 ) ) );
L928: (D105 = ( ( ( C85 . C91 ) - D96 ) / ( ( C85 . C91 ) - ( C86 . C91 ) ) ) & ( ( C85 . C91 ) - ( C86 . C91 ) ) < ( ( C86 . C91 ) - ( C86 . C91 ) )) by L921 , XREAL_1:9;
L929: ( C85 . C91 ) > ( 0 ) by L922 , RLAFFIN1:62;
L930: S6[ C91 , D105 ] by L929 , L928 , L851;
L931: D105 in D104 by L930 , L927;
L932: ( D98 \/ D99 ) is  finite;
L933: D104 is  finite from FRAENKEL:sch 28(L932 , L912);
reconsider D106 = D104 as  finite non  empty  real-membered set by L933 , L908 , L931 , MEMBERED:def 3;
set D107 = ( max D106 );
L934: D107 in D106 by XXREAL_2:def 8;
consider C92 being (Element of ( REAL )) such that L935: D107 = C92 and L936: (ex B92 being (Element of R6) st (S6[ B92 , C92 ] & B92 in ( D98 \/ D99 ))) by L934;
set D108 = ( ( C92 * C86 ) + ( ( 1 - C92 ) * C85 ) );
consider C93 being (Element of R6) such that L937: S6[ C93 , C92 ] and L938: C93 in ( D98 \/ D99 ) by L936;
set D109 = ( ( C92 * R8 ) + ( ( 1 - C92 ) * R7 ) );
set D110 = ( ( - C92 ) / ( 1 - C92 ) );
L939: ( Sum D108 ) = ( ( Sum ( C92 * C86 ) ) + ( Sum ( ( 1 - C92 ) * C85 ) ) ) by RLVECT_3:1
.= ( ( C92 * R8 ) + ( Sum ( ( 1 - C92 ) * C85 ) ) ) by L895 , RLVECT_3:2
.= D109 by L892 , RLVECT_3:2;
L940: (for B93 being (Element of R6) holds ( 0 ) <= ( D108 . B93 ))
proof
let C94 being (Element of R6);
L941: ( ( ( D96 * C86 ) + ( ( 1 - D96 ) * C85 ) ) . C94 ) = ( ( ( D96 * C86 ) . C94 ) + ( ( ( 1 - D96 ) * C85 ) . C94 ) ) by RLVECT_2:def 10
.= ( ( D96 * ( C86 . C94 ) ) + ( ( ( 1 - D96 ) * C85 ) . C94 ) ) by RLVECT_2:def 11
.= ( ( D96 * ( C86 . C94 ) ) + ( ( 1 - ( 0 ) ) * ( C85 . C94 ) ) ) by RLVECT_2:def 11
.= ( C85 . C94 );
assume L942: ( 0 ) > ( D108 . C94 );
L943: ( D108 . C94 ) = ( ( ( C92 * C86 ) . C94 ) + ( ( ( 1 - C92 ) * C85 ) . C94 ) ) by RLVECT_2:def 10
.= ( ( C92 * ( C86 . C94 ) ) + ( ( ( 1 - C92 ) * C85 ) . C94 ) ) by RLVECT_2:def 11
.= ( ( C92 * ( C86 . C94 ) ) + ( ( 1 - C92 ) * ( C85 . C94 ) ) ) by RLVECT_2:def 11;
L944: ( C85 . C94 ) <> ( 0 )
proof
assume L945: ( C85 . C94 ) = ( 0 );
L946: (not C94 in D99) by L945 , L907 , RLVECT_2:19;
L947: ( C86 . C94 ) = ( 0 ) by L946;
thus L948: contradiction by L947 , L942 , L943 , L945;
end;
L949: C94 in D98 by L944;
L950: C94 in ( D98 \/ D99 ) by L949 , XBOOLE_0:def 3;
L951: ( C85 . C94 ) >= ( 0 ) by RLAFFIN1:62;
consider C95 being Real such that L952: ( ( ( C95 * C86 ) + ( ( 1 - C95 ) * C85 ) ) . C94 ) = ( 0 ) and L953: (C92 <= ( 0 ) implies (C92 <= C95 & C95 <= ( 0 ))) and L954: (( 0 ) <= C92 implies (( 0 ) <= C95 & C95 <= C92)) by L951 , L941 , L942 , L863;
L955: C95 <> ( 0 ) by L941 , L944 , L952;
L956: S6[ C94 , C95 ] by L955 , L937 , L942 , L943 , L952 , L953 , RLAFFIN1:62;
L957: C95 in D106 by L956 , L950;
L958: C95 <= C92 by L957 , L935 , XXREAL_2:def 8;
L959: C95 = C92 by L958 , L936 , L953 , XXREAL_0:1;
thus L960: contradiction by L959 , L942 , L952;
end;
L961: (( C92 * C86 ) is (Linear_Combination of R11) & ( ( 1 - C92 ) * C85 ) is (Linear_Combination of R11)) by RLVECT_2:44;
L962: D108 is (Linear_Combination of R11) by L961 , RLVECT_2:38;
L963: ( Carrier D108 ) c= R11 by L962 , RLVECT_2:def 6;
L964: ( D108 . C93 ) = ( 0 ) by L937;
L965: (not C93 in ( Carrier D108 )) by L964 , RLVECT_2:19;
L966: ( Carrier D108 ) c= ( R11 \ { C93 } ) by L965 , L963 , ZFMISC_1:34;
L967: ( sum D108 ) = ( ( sum ( C92 * C86 ) ) + ( sum ( ( 1 - C92 ) * C85 ) ) ) by RLAFFIN1:34
.= ( ( C92 * ( sum C86 ) ) + ( sum ( ( 1 - C92 ) * C85 ) ) ) by RLAFFIN1:35
.= ( ( C92 * 1 ) + ( sum ( ( 1 - C92 ) * C85 ) ) ) by RLAFFIN1:62
.= ( ( C92 * 1 ) + ( ( 1 - C92 ) * ( sum C85 ) ) ) by RLAFFIN1:35
.= ( ( C92 * 1 ) + ( ( 1 - C92 ) * 1 ) ) by RLAFFIN1:62
.= 1;
L968: D108 is  convex by L967 , L940 , RLAFFIN1:62;
L969: ( Carrier D108 ) <> ( {} ) by L968 , CONVEX1:21;
reconsider D111 = ( R11 \ { C93 } ) as non  empty (Subset of R6) by L969 , L966;
reconsider D112 = D108 as (Linear_Combination of D111) by L966 , RLVECT_2:def 6;
L970: D112 is  convex by L940 , L967 , RLAFFIN1:62;
L971: D112 in ( ConvexComb R6 ) by L970 , CONVEX3:def 1;
L972: ( Sum D112 ) in { ( Sum B94 ) where B94 is (Convex_Combination of D111) : B94 in ( ConvexComb R6 ) } by L971 , L970;
take C93;
take D109;
take D110;
L973: ( 0 ) > C92 by L937;
L974: (( 1 + ( - C92 ) ) > ( ( 0 ) + ( - C92 ) ) & ( ( 1 + ( - C92 ) ) / ( 1 + ( - C92 ) ) ) = 1) by L973 , XCMPLX_1:60 , XREAL_1:6;
L975: ( ( D110 * R8 ) + ( ( 1 - D110 ) * D109 ) ) = ( ( ( ( - C92 ) / ( 1 - C92 ) ) * R8 ) + ( ( ( ( 1 - C92 ) / ( 1 - C92 ) ) - ( ( - C92 ) / ( 1 - C92 ) ) ) * D109 ) ) by L973 , XCMPLX_1:60
.= ( ( ( ( - C92 ) / ( 1 - C92 ) ) * R8 ) + ( ( ( ( 1 - C92 ) - ( - C92 ) ) / ( 1 - C92 ) ) * D109 ) ) by XCMPLX_1:120
.= ( ( ( ( - C92 ) / ( 1 - C92 ) ) * R8 ) + ( ( ( 1 / ( 1 - C92 ) ) * ( C92 * R8 ) ) + ( ( 1 / ( 1 - C92 ) ) * ( ( 1 - C92 ) * R7 ) ) ) ) by RLVECT_1:def 5
.= ( ( ( ( - C92 ) / ( 1 - C92 ) ) * R8 ) + ( ( ( ( 1 / ( 1 - C92 ) ) * C92 ) * R8 ) + ( ( 1 / ( 1 - C92 ) ) * ( ( 1 - C92 ) * R7 ) ) ) ) by RLVECT_1:def 7
.= ( ( ( ( - C92 ) / ( 1 - C92 ) ) * R8 ) + ( ( ( ( 1 / ( 1 - C92 ) ) * C92 ) * R8 ) + ( ( ( 1 / ( 1 - C92 ) ) * ( 1 - C92 ) ) * R7 ) ) ) by RLVECT_1:def 7
.= ( ( ( ( - C92 ) / ( 1 - C92 ) ) * R8 ) + ( ( ( ( C92 / ( 1 - C92 ) ) * 1 ) * R8 ) + ( ( ( 1 / ( 1 - C92 ) ) * ( 1 - C92 ) ) * R7 ) ) ) by XCMPLX_1:75
.= ( ( ( ( - C92 ) / ( 1 - C92 ) ) * R8 ) + ( ( ( C92 / ( 1 - C92 ) ) * R8 ) + ( 1 * R7 ) ) ) by L973 , XCMPLX_1:87
.= ( ( ( ( ( - C92 ) / ( 1 - C92 ) ) * R8 ) + ( ( C92 / ( 1 - C92 ) ) * R8 ) ) + ( 1 * R7 ) ) by RLVECT_1:def 3
.= ( ( ( ( ( - C92 ) / ( 1 - C92 ) ) + ( C92 / ( 1 - C92 ) ) ) * R8 ) + ( 1 * R7 ) ) by RLVECT_1:def 6
.= ( ( ( ( ( - C92 ) + C92 ) / ( 1 - C92 ) ) * R8 ) + ( 1 * R7 ) ) by XCMPLX_1:62
.= ( ( ( ( 0 ) / ( 1 - C92 ) ) * R8 ) + R7 ) by RLVECT_1:def 8
.= ( ( 0. R6 ) + R7 ) by RLVECT_1:10
.= R7 by RLVECT_1:def 4;
thus L976: thesis by L975 , L898 , L938 , L939 , L972 , L973 , L974 , CONVEX3:5 , XREAL_1:74;
end;
end;
theorem
L978: (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R11 being (Subset of R6) holds (( R11 \/ { R7 } ) is  affinely-independent iff (R11 is  affinely-independent & (R7 in R11 or (not R7 in ( Affin R11 )))))))) by RLAFFIN1:82;
theorem
L979: (for R6 being RealLinearSpace holds (for R7 being (VECTOR of R6) holds (for R13 being  finite (Subset of R6) holds (for R14 being  affinely-independent (Subset of R6) holds ((R13 c= R14 & R7 in R13) implies ( ( R14 \ { R7 } ) \/ { ( ( center_of_mass R6 ) . R13 ) } ) is  affinely-independent  affinely-independent  affinely-independent  affinely-independent (Subset of R6))))))
proof
let R6 being RealLinearSpace;
let R7 being (VECTOR of R6);
let R13 being  finite (Subset of R6);
let R14 being  affinely-independent (Subset of R6);
assume that
L980: R13 c= R14
and
L981: R7 in R13;
set D113 = ( R14 \ { R7 } );
set D114 = ( R13 \ { R7 } );
L982: ( D113 \/ { R7 } ) = R14 by L980 , L981 , ZFMISC_1:116;
set D115 = ( ( center_of_mass R6 ) /. R13 );
L983: ( ( center_of_mass R6 ) . R13 ) = ( ( 1 / ( card R13 ) ) * ( Sum R13 ) ) by L981 , L493;
L984: ( dom ( center_of_mass R6 ) ) = ( BOOL (the carrier of R6) ) by FUNCT_2:def 1;
L985: R13 in ( dom ( center_of_mass R6 ) ) by L984 , L981 , ZFMISC_1:56;
L986: ( ( center_of_mass R6 ) . R13 ) = ( ( center_of_mass R6 ) /. R13 ) by L985 , PARTFUN1:def 6;
per cases ;
suppose L987: R13 = { R7 };

L988: (( Sum R13 ) = R7 & ( card R13 ) = 1) by L987 , CARD_1:30 , RLVECT_2:9;
thus L989: thesis by L988 , L982 , L983 , RLVECT_1:def 8;
end;
suppose L990: R13 <> { R7 };

L991: (not D115 in ( Affin D113 ))
proof
L992: D114 is non  empty
proof
assume L993: D114 is  empty;
L994: R13 c= { R7 } by L993 , XBOOLE_1:37;
thus L995: contradiction by L994 , L981 , L990 , ZFMISC_1:33;
end;
L996: D114 in ( dom ( center_of_mass R6 ) ) by L992 , L984 , ZFMISC_1:56;
L997: ( ( center_of_mass R6 ) . D114 ) = ( ( center_of_mass R6 ) /. D114 ) by L996 , PARTFUN1:def 6;
L998: D114 c= D113 by L980 , XBOOLE_1:33;
L999: ( Affin D114 ) c= ( Affin D113 ) by L998 , RLAFFIN1:52;
reconsider D116 = ( card R13 ) as Real by XREAL_0:def 1;
L1000: ( D116 / D116 ) = ( D116 * ( 1 / D116 ) ) by XCMPLX_1:99;
L1001: (( conv D114 ) c= ( Affin D114 ) & ( ( center_of_mass R6 ) . D114 ) in ( conv D114 )) by L992 , L579 , RLAFFIN1:65;
L1002: ( ( center_of_mass R6 ) . D114 ) in ( Affin D114 ) by L1001;
assume L1003: D115 in ( Affin D113 );
L1004: ((not R7 in D113) & ( ( ( 1 - D116 ) * ( ( center_of_mass R6 ) /. D114 ) ) + ( D116 * ( ( center_of_mass R6 ) /. R13 ) ) ) in ( Affin D113 )) by L1003 , L997 , L999 , L1002 , RUSUB_4:def 4 , ZFMISC_1:56;
L1005: ( ( ( center_of_mass R6 ) /. R13 ) - ( ( 1 - ( 1 / D116 ) ) * ( ( center_of_mass R6 ) /. D114 ) ) ) = ( ( ( ( 1 - ( 1 / D116 ) ) * ( ( center_of_mass R6 ) /. D114 ) ) + ( ( 1 / D116 ) * R7 ) ) - ( ( 1 - ( 1 / D116 ) ) * ( ( center_of_mass R6 ) /. D114 ) ) ) by L981 , L986 , L992 , L651;
L1006: ( ( 1 / D116 ) * R7 ) = ( ( ( center_of_mass R6 ) /. R13 ) - ( ( 1 - ( 1 / D116 ) ) * ( ( center_of_mass R6 ) /. D114 ) ) ) by L1005 , RLVECT_4:1
.= ( ( ( center_of_mass R6 ) /. R13 ) + ( - ( ( 1 - ( 1 / D116 ) ) * ( ( center_of_mass R6 ) /. D114 ) ) ) ) by RLVECT_1:def 11
.= ( ( ( - ( 1 - ( 1 / D116 ) ) ) * ( ( center_of_mass R6 ) /. D114 ) ) + ( ( center_of_mass R6 ) /. R13 ) ) by RLVECT_4:3;
L1007: 1 = ( D116 / D116 ) by L981 , XCMPLX_1:60;
L1008: ( ( ( 1 - D116 ) * ( ( center_of_mass R6 ) /. D114 ) ) + ( D116 * ( ( center_of_mass R6 ) /. R13 ) ) ) = ( 1 * ( ( ( 1 - D116 ) * ( ( center_of_mass R6 ) /. D114 ) ) + ( D116 * ( ( center_of_mass R6 ) /. R13 ) ) ) ) by RLVECT_1:def 8
.= ( D116 * ( ( 1 / D116 ) * ( ( ( 1 - D116 ) * ( ( center_of_mass R6 ) /. D114 ) ) + ( D116 * ( ( center_of_mass R6 ) /. R13 ) ) ) ) ) by L1000 , L1007 , RLVECT_1:def 7
.= ( D116 * ( ( ( 1 / D116 ) * ( ( 1 - D116 ) * ( ( center_of_mass R6 ) /. D114 ) ) ) + ( ( 1 / D116 ) * ( D116 * ( ( center_of_mass R6 ) /. R13 ) ) ) ) ) by RLVECT_1:def 5
.= ( D116 * ( ( ( 1 / D116 ) * ( ( 1 - D116 ) * ( ( center_of_mass R6 ) /. D114 ) ) ) + ( 1 * ( ( center_of_mass R6 ) /. R13 ) ) ) ) by L1000 , L1007 , RLVECT_1:def 7
.= ( D116 * ( ( ( 1 / D116 ) * ( ( 1 - D116 ) * ( ( center_of_mass R6 ) /. D114 ) ) ) + ( ( center_of_mass R6 ) /. R13 ) ) ) by RLVECT_1:def 8
.= ( D116 * ( ( ( ( 1 / D116 ) * ( 1 - D116 ) ) * ( ( center_of_mass R6 ) /. D114 ) ) + ( ( center_of_mass R6 ) /. R13 ) ) ) by RLVECT_1:def 7
.= ( 1 * R7 ) by L1007 , L1006 , L1000 , RLVECT_1:def 7
.= R7 by RLVECT_1:def 8;
thus L1009: contradiction by L1008 , L982 , L1004 , L978;
end;
L1010: D113 is  affinely-independent by RLAFFIN1:43 , XBOOLE_1:36;
thus L1011: thesis by L1010 , L986 , L991 , L978;
end;
end;
theorem
L1013: (for R6 being RealLinearSpace holds (for B95 being  c=-linear (Subset-Family of R6) holds (( union B95 ) is  finite  affinely-independent implies ( ( center_of_mass R6 ) .: B95 ) is  affinely-independent  affinely-independent  affinely-independent  affinely-independent (Subset of R6))))
proof
let R6 being RealLinearSpace;
set D117 = ( center_of_mass R6 );
defpred S7[ Nat ] means (for B96 being Nat holds (B96 <= $1 implies (for B97 being  c=-linear (Subset-Family of R6) holds ((( card ( union B97 ) ) = B96 & ( union B97 ) is  finite  affinely-independent) implies ( D117 .: B97 ) is  affinely-independent  affinely-independent  affinely-independent  affinely-independent (Subset of R6)))));
let C96 being  c=-linear (Subset-Family of R6);
L1014: ( dom D117 ) = ( BOOL (the carrier of R6) ) by FUNCT_2:def 1;
L1015: (for B98 being Nat holds (S7[ B98 ] implies S7[ ( B98 + 1 ) ]))
proof
let C97 being Nat;
assume that
L1016: S7[ C97 ];
let C98 being Nat;
assume that
L1017: C98 <= ( C97 + 1 );
per cases  by L1017 , NAT_1:8;
suppose L1018: C98 <= C97;

thus L1019: thesis by L1018 , L1016;
end;
suppose L1020: C98 = ( C97 + 1 );

let C99 being  c=-linear (Subset-Family of R6);
assume that
L1021: ( card ( union C99 ) ) = C98
and
L1022: ( union C99 ) is  finite  affinely-independent;
set D118 = ( union C99 );
L1023: C99 c= ( bool D118 ) by ZFMISC_1:82;
set D119 = ( C99 \ { D118 } );
L1024: ( union D119 ) c= D118 by XBOOLE_1:36 , ZFMISC_1:77;
reconsider D120 = ( union D119 ) as  finite set by L1024 , L1022;
L1025: D119 c= C99 by XBOOLE_1:36;
L1026: ( union D119 ) <> D118
proof
assume L1027: ( union D119 ) = D118;
L1028: D119 is non  empty by L1027 , L1020 , L1021 , ZFMISC_1:2;
L1029: ( union D119 ) in D119 by L1028 , L1022 , L1025 , L1023 , SIMPLEX0:9;
thus L1030: contradiction by L1029 , L1027 , ZFMISC_1:56;
end;
L1031: ( union D119 ) c< D118 by L1026 , L1024 , XBOOLE_0:def 8;
consider C100 being set such that L1032: C100 in D118 and L1033: (not C100 in ( union D119 )) by L1031 , XBOOLE_0:6;
reconsider D121 = C100 as (Element of R6) by L1032;
L1034: ( ( D118 \ { D121 } ) \/ { ( D117 . D118 ) } ) is  affinely-independent  affinely-independent  affinely-independent  affinely-independent (Subset of R6) by L1022 , L1032 , L979;
L1035: D118 is non  empty by L1020 , L1021;
L1036: D118 in ( dom D117 ) by L1035 , L1014 , ZFMISC_1:56;
L1037: ( D117 . D118 ) in { ( D117 . D118 ) } by TARSKI:def 1;
L1038: ( D117 . D118 ) in ( ( D118 \ { D121 } ) \/ { ( D117 . D118 ) } ) by L1037 , XBOOLE_0:def 3;
reconsider D122 = ( D117 . D118 ) as (Element of R6) by L1038 , L1034;
L1039: C99 is non  empty by L1020 , L1021 , ZFMISC_1:2;
L1040: ( D119 \/ { D118 } ) = C99 by L1039 , L1022 , L1023 , SIMPLEX0:9 , ZFMISC_1:116;
L1041: ( D117 .: C99 ) = ( ( D117 .: D119 ) \/ ( D117 .: { D118 } ) ) by L1040 , RELAT_1:120
.= ( ( D117 .: D119 ) \/ ( Im (D117 , D118) ) ) by RELAT_1:def 16
.= ( ( D117 .: D119 ) \/ { D122 } ) by L1036 , FUNCT_1:59;
L1042: { D121 } c= D118 by L1032 , ZFMISC_1:31;
L1043: ( card { D121 } ) = 1 by CARD_1:30;
per cases ;
suppose L1044: C97 = ( 0 );

L1045: D118 = { D121 } by L1044 , L1020 , L1021 , L1022 , L1042 , L1043 , CARD_FIN:1;
L1046: ( D119 /\ ( dom D117 ) ) = ( {} )
proof
assume L1047: ( D119 /\ ( dom D117 ) ) <> ( {} );
consider R1 being set such that L1048: R1 in ( D119 /\ ( dom D117 ) ) by L1047 , XBOOLE_0:def 1;
L1049: R1 in D119 by L1048 , XBOOLE_0:def 4;
L1050: R1 c= ( union D119 ) by L1049 , ZFMISC_1:74;
L1051: R1 c= D118 by L1050 , L1024 , XBOOLE_1:1;
L1052: (R1 = D118 or R1 = ( {} )) by L1051 , L1045 , ZFMISC_1:33;
L1053: (not D121 in R1) by L1033 , L1050;
thus L1054: thesis by L1053 , L1045 , L1048 , L1052 , TARSKI:def 1 , ZFMISC_1:56;
end;
L1055: ( D117 .: D119 ) = ( D117 .: ( {} ) ) by L1046 , RELAT_1:112
.= ( {} );
thus L1056: thesis by L1055 , L1041;
end;
suppose L1057: C97 > ( 0 );

reconsider D123 = D118 as  finite set by L1022;
L1058: D120 c= D123 by XBOOLE_1:36 , ZFMISC_1:77;
L1059: ( card D120 ) <= ( C97 + 1 ) by L1058 , L1020 , L1021 , NAT_1:43;
L1060: ( card D120 ) < ( C97 + 1 ) by L1059 , L1020 , L1021 , L1026 , L1058 , CARD_FIN:1 , XXREAL_0:1;
L1061: ( card D120 ) <= C97 by L1060 , NAT_1:13;
L1062: (( union D119 ) c= ( D118 \ { D121 } ) & ( D118 \ { D121 } ) c= ( ( D118 \ { D121 } ) \/ { ( D117 . D118 ) } )) by L1024 , L1033 , XBOOLE_1:7 , ZFMISC_1:34;
L1063: ( union D119 ) is  affinely-independent by L1062 , L1034 , RLAFFIN1:43 , XBOOLE_1:1;
reconsider D124 = ( D117 .: D119 ) as  affinely-independent (Subset of R6) by L1063 , L1016 , L1025 , L1061;
L1064: D124 c= ( Affin ( D118 \ { D121 } ) )
proof
let R2 being set;
assume L1065: R2 in D124;
consider R1 being set such that L1066: R1 in ( dom D117 ) and L1067: R1 in D119 and L1068: ( D117 . R1 ) = R2 by L1065 , FUNCT_1:def 6;
reconsider D125 = R1 as non  empty (Subset of R6) by L1066 , ZFMISC_1:56;
L1069: D125 in C99 by L1067 , XBOOLE_0:def 5;
L1070: D125 c= D118 by L1069 , ZFMISC_1:74;
L1071: D125 c= ( union D119 ) by L1067 , ZFMISC_1:74;
L1072: (not D121 in D125) by L1071 , L1033;
L1073: D125 c= ( D118 \ { D121 } ) by L1072 , L1070 , ZFMISC_1:34;
L1074: ( conv D125 ) c= ( conv ( D118 \ { D121 } ) ) by L1073 , RLTOPSP1:20;
L1075: R2 in ( conv D125 ) by L1022 , L1068 , L1070 , L579;
L1076: R2 in ( conv ( D118 \ { D121 } ) ) by L1075 , L1074;
L1077: ( conv ( D118 \ { D121 } ) ) c= ( Affin ( D118 \ { D121 } ) ) by RLAFFIN1:65;
thus L1078: thesis by L1077 , L1076;
end;
L1079: ( Affin D124 ) c= ( Affin ( D118 \ { D121 } ) ) by L1064 , RLAFFIN1:51;
L1080: ( card D118 ) <> 1 by L1020 , L1021 , L1057;
L1081: (not D122 in D118) by L1080 , L1022 , L617;
L1082: (not D122 in ( D118 \ { D121 } )) by L1081 , XBOOLE_0:def 5;
L1083: (not D122 in ( Affin D124 )) by L1082 , L1034 , L1079 , L978;
thus L1084: thesis by L1083 , L1041 , L978;
end;
end;
end;
L1087: S7[ (( 0 ) qua Nat) ]
proof
let C101 being Nat;
assume L1088: C101 <= ( 0 );
let C102 being  c=-linear (Subset-Family of R6);
assume that
L1089: ( card ( union C102 ) ) = C101
and
L1090: ( union C102 ) is  finite  affinely-independent;
L1091: ( union C102 ) = ( {} ) by L1088 , L1089;
L1092: ( C102 /\ ( dom D117 ) ) = ( {} )
proof
assume L1093: ( C102 /\ ( dom D117 ) ) <> ( {} );
consider R1 being set such that L1094: R1 in ( C102 /\ ( dom D117 ) ) by L1093 , XBOOLE_0:def 1;
L1095: R1 in C102 by L1094 , XBOOLE_0:def 4;
L1096: R1 c= ( {} ) by L1095 , L1091 , ZFMISC_1:74;
L1097: R1 <> ( {} ) by L1094 , ZFMISC_1:56;
thus L1098: contradiction by L1097 , L1096;
end;
L1099: ( D117 .: C102 ) = ( D117 .: ( {} ) ) by L1092 , RELAT_1:112
.= ( {} );
thus L1100: thesis by L1099;
end;
L1101: (for B99 being Nat holds S7[ B99 ]) from NAT_1:sch 2(L1087 , L1015);
assume L1102: ( union C96 ) is  finite  affinely-independent;
L1103: ( card ( union C96 ) ) is Nat by L1102;
thus L1104: thesis by L1103 , L1101 , L1102;
end;
theorem
L1105: (for R6 being RealLinearSpace holds (for B100 being  c=-linear (Subset-Family of R6) holds (( union B100 ) is  affinely-independent  finite implies ( Int ( ( center_of_mass R6 ) .: B100 ) ) c= ( Int ( union B100 ) ))))
proof
let R6 being RealLinearSpace;
set D126 = ( center_of_mass R6 );
let C103 being  c=-linear (Subset-Family of R6);
assume that
L1106: ( union C103 ) is  affinely-independent  finite;
reconsider D127 = ( D126 .: C103 ) as  affinely-independent (Subset of R6) by L1106 , L1013;
set D128 = ( union C103 );
let R1 being set;
assume that
L1107: R1 in ( Int ( D126 .: C103 ) );
L1108: D127 is non  empty by L1107;
consider R2 being set such that L1109: R2 in D127 by L1108 , XBOOLE_0:def 1;
consider C104 being set such that L1110: C104 in ( dom D126 ) and L1111: C104 in C103 and L1112: ( D126 . C104 ) = R2 by L1109 , FUNCT_1:def 6;
L1113: (C104 c= D128 & C104 is non  empty) by L1110 , L1111 , ZFMISC_1:56 , ZFMISC_1:74;
reconsider D129 = D128 as non  empty  finite (Subset of R6) by L1113 , L1106;
set D130 = ( R1 |-- D127 );
L1114: ( Int D127 ) c= ( conv D127 ) by L286;
L1115: D130 is  convex by L1114 , L1107 , RLAFFIN1:71;
L1116: C103 c= ( bool D129 )
proof
let C105 being set;
assume L1117: C105 in C103;
L1118: C105 c= D129 by L1117 , ZFMISC_1:74;
thus L1119: thesis by L1118;
end;
L1120: D129 in C103 by L1116 , L1111 , SIMPLEX0:9;
L1121: ( dom D126 ) = ( ( bool (the carrier of R6) ) \ { ( {} ) } ) by FUNCT_2:def 1;
L1122: D129 in ( dom D126 ) by L1121 , ZFMISC_1:56;
L1123: ( D126 . D129 ) in D127 by L1122 , L1120 , FUNCT_1:def 6;
reconsider D131 = ( D126 . D129 ) as (Element of R6) by L1123;
L1124: ( conv D127 ) c= ( Affin D127 ) by RLAFFIN1:65;
L1125: ( Int D127 ) c= ( Affin D127 ) by L1124 , L1114 , XBOOLE_1:1;
L1126: ( Sum D130 ) = R1 by L1125 , L1107 , RLAFFIN1:def 7;
L1127: ( Carrier D130 ) = D127 by L1126 , L1107 , L1114 , L428 , RLAFFIN1:71;
L1128: ( D130 . D131 ) <> ( 0 ) by L1127 , L1123 , RLVECT_2:19;
L1129: ( D130 . D131 ) > ( 0 ) by L1128 , L1107 , L1114 , RLAFFIN1:71;
set D132 = ( R1 |-- D129 );
L1130: ( conv D129 ) c= ( Affin D129 ) by RLAFFIN1:65;
L1131: ( conv ( D126 .: C103 ) ) c= ( conv D129 ) by L599 , CONVEX1:30;
L1132: ( Int D127 ) c= ( conv D129 ) by L1131 , L1114 , XBOOLE_1:1;
L1133: ( Int D127 ) c= ( Affin D129 ) by L1132 , L1130 , XBOOLE_1:1;
L1134: ( Sum D132 ) = R1 by L1133 , L1106 , L1107 , RLAFFIN1:def 7;
L1135: D127 c= ( conv D127 ) by RLAFFIN1:2;
L1136: ( D126 . D129 ) in ( conv D127 ) by L1135 , L1123;
per cases ;
suppose L1137: R1 = ( D126 . D129 );

thus L1138: thesis by L1137 , L1106 , L628;
end;
suppose L1139: R1 <> D131;

consider C106 being (Element of R6) such that L1140: C106 in ( conv ( D127 \ { D131 } ) ) and L1141: ( Sum D130 ) = ( ( ( D130 . D131 ) * D131 ) + ( ( 1 - ( D130 . D131 ) ) * C106 ) ) and L1142: ( ( ( 1 / ( D130 . D131 ) ) * ( Sum D130 ) ) + ( ( 1 - ( 1 / ( D130 . D131 ) ) ) * C106 ) ) = D131 by L1139 , L1115 , L1126 , L1128 , L9;
L1143: R1 = ( ( ( 1 - ( D130 . D131 ) ) * C106 ) + ( ( D130 . D131 ) * D131 ) ) by L1107 , L1125 , L1141 , RLAFFIN1:def 7;
L1144: ( D130 . D131 ) <= 1 by L1107 , L1114 , RLAFFIN1:71;
L1145: ( 1 - ( D130 . D131 ) ) >= ( 1 - 1 ) by L1144 , XREAL_1:10;
L1146: D131 in ( conv D129 ) by L1131 , L1136;
L1147: ( conv ( D127 \ { D131 } ) ) c= ( conv D127 ) by RLAFFIN1:3 , XBOOLE_1:36;
L1148: C106 in ( conv D127 ) by L1147 , L1140;
L1149: C106 in ( conv D129 ) by L1148 , L1131;
L1150: D132 = ( ( ( 1 - ( D130 . D131 ) ) * ( C106 |-- D129 ) ) + ( ( D130 . D131 ) * ( D131 |-- D129 ) ) ) by L1149 , L1106 , L1130 , L1143 , L1146 , RLAFFIN1:70;
L1151: D129 c= ( Carrier D132 )
proof
let C107 being set;
assume L1152: C107 in D129;
L1153: ( D132 . C107 ) = ( ( ( ( 1 - ( D130 . D131 ) ) * ( C106 |-- D129 ) ) . C107 ) + ( ( ( D130 . D131 ) * ( D131 |-- D129 ) ) . C107 ) ) by L1152 , L1150 , RLVECT_2:def 10
.= ( ( ( ( 1 - ( D130 . D131 ) ) * ( C106 |-- D129 ) ) . C107 ) + ( ( D130 . D131 ) * ( ( D131 |-- D129 ) . C107 ) ) ) by L1152 , RLVECT_2:def 11
.= ( ( ( 1 - ( D130 . D131 ) ) * ( ( C106 |-- D129 ) . C107 ) ) + ( ( D130 . D131 ) * ( ( D131 |-- D129 ) . C107 ) ) ) by L1152 , RLVECT_2:def 11;
L1154: (( ( D131 |-- D129 ) . C107 ) = ( 1 / ( card D129 ) ) & ( ( C106 |-- D129 ) . C107 ) >= ( 0 )) by L1106 , L1131 , L1148 , L1152 , L609 , RLAFFIN1:71;
thus L1155: thesis by L1154 , L1129 , L1145 , L1152 , L1153;
end;
L1156: ( Carrier D132 ) c= D129 by RLVECT_2:def 6;
L1157: ( Carrier D132 ) = D129 by L1156 , L1151 , XBOOLE_0:def 10;
thus L1158: thesis by L1157 , L1106 , L1107 , L1132 , L1134 , L438 , RLAFFIN1:71;
end;
end;
