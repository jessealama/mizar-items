:: Semigroup operations on finite subsets
::  by Czes{\l}aw Byli\'nski
::
:: Received May 4, 1990
:: Copyright (c) 1990-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, XBOOLE_0, SUBSET_1, FINSUB_1, BINOP_1, FUNCT_1, NAT_1,
      FINSEQ_1, FINSEQ_2, ARYTM_3, XXREAL_0, SETWISEO, TARSKI, RELAT_1,
      FINSEQOP, FUNCOP_1, FUNCT_4, ORDINAL4, FINSOP_1, CARD_1, SETWOP_2;
 notations TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, ORDINAL1, XCMPLX_0, NAT_1,
      RELAT_1, RELSET_1, FUNCT_1, FINSEQ_1, FINSUB_1, PARTFUN1, FUNCT_2,
      BINOP_1, FUNCOP_1, SETWISEO, FINSEQ_2, FINSEQOP, FINSOP_1, XXREAL_0;
 constructors PARTFUN1, WELLORD2, BINOP_1, SETWISEO, XXREAL_0, XREAL_0, NAT_1,
      FINSEQOP, FINSOP_1, RELSET_1, FINSEQ_2;
 registrations XBOOLE_0, FUNCT_1, ORDINAL1, RELSET_1, FUNCT_2, FINSUB_1,
      XREAL_0, FINSEQ_1, FINSEQ_2, NAT_1, CARD_1, RELAT_1;
 requirements NUMERALS, REAL, BOOLE, SUBSET, ARITHM;
 definitions BINOP_1, XBOOLE_0, RELAT_1;
 theorems TARSKI, ENUMSET1, ZFMISC_1, NAT_1, FUNCT_1, FUNCT_2, FUNCOP_1,
      FINSEQ_1, FINSUB_1, BINOP_1, SETWISEO, FINSEQ_2, WELLORD2, CARD_1,
      FINSEQOP, RELAT_1, FUNCT_4, FINSOP_1, XBOOLE_0, XBOOLE_1, XREAL_1,
      ORDINAL1;
 schemes NAT_1, SETWISEO, FINSEQ_2;

begin
L1: (for B1 being Nat holds ( Seg B1 ) is (Element of ( Fin ( NAT ) ))) by FINSUB_1:def 5;
L2:
now
let R31 being Nat;
assume L3: ( R31 + 1 ) in ( Seg R31 );
L4: ( R31 + 1 ) <= R31 by L3 , FINSEQ_1:1;
thus L5: contradiction by L4 , XREAL_1:29;
end;
theorem
L6: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R9 being (Element of R3) holds (for R10 being (Element of R3) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R9 <> R10) implies ( R23 $$ ({. R9 , R10 .} , R26) ) = ( R23 . (( R26 . R9 ) , ( R26 . R10 )) ))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R9 being (Element of R3);
let R10 being (Element of R3);
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L7: R23 is  commutative  associative
and
L8: R9 <> R10;
consider C1 being (Function of ( Fin R3 ) , R5) such that L9: ( R23 $$ ({. R9 , R10 .} , R26) ) = ( C1 . { R9 , R10 } ) and L10: (for R22 being (Element of R5) holds (R22 is_a_unity_wrt R23 implies ( C1 . ( {} ) ) = R22)) and L11: (for R7 being (Element of R3) holds ( C1 . { R7 } ) = ( R26 . R7 )) and L12: (for R12 being (Element of ( Fin R3 )) holds ((R12 c= { R9 , R10 } & R12 <> ( {} )) implies (for R7 being (Element of R3) holds (R7 in ( { R9 , R10 } \ R12 ) implies ( C1 . ( R12 \/ { R7 } ) ) = ( R23 . (( C1 . R12 ) , ( R26 . R7 )) ))))) by L7 , SETWISEO:def 3;
L13: (R9 in { R9 } & (not R10 in { R9 })) by L8 , TARSKI:def 1;
L14: ( { R9 , R10 } \ { R9 } ) = { R10 } by L13 , ZFMISC_1:62;
L15: R10 in ( { R9 , R10 } \ { R9 } ) by L14 , TARSKI:def 1;
thus L16: ( R23 $$ ({. R9 , R10 .} , R26) ) = ( C1 . ( {. R9 .} \/ {. R10 .} ) ) by L9 , ENUMSET1:1
.= ( R23 . (( C1 . { R9 } ) , ( R26 . R10 )) ) by L12 , L15 , ZFMISC_1:7
.= ( R23 . (( R26 . R9 ) , ( R26 . R10 )) ) by L11;
end;
theorem
L17: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R7 being (Element of R3) holds (for R12 being (Element of ( Fin R3 )) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & (R12 <> ( {} ) or R23 is  having_a_unity) & (not R7 in R12)) implies ( R23 $$ (( R12 \/ {. R7 .} ) , R26) ) = ( R23 . (( R23 $$ (R12 , R26) ) , ( R26 . R7 )) ))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R7 being (Element of R3);
let R12 being (Element of ( Fin R3 ));
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L18: R23 is  commutative  associative
and
L19: (R12 <> ( {} ) or R23 is  having_a_unity)
and
L20: (not R7 in R12);
per cases ;
suppose L21: R12 = ( {} );

L22: R12 = ( {}. R3 ) by L21;
L23: ( R23 $$ (R12 , R26) ) = ( the_unity_wrt R23 ) by L22 , L18 , L19 , SETWISEO:31;
thus L24: ( R23 . (( R23 $$ (R12 , R26) ) , ( R26 . R7 )) ) = ( R26 . R7 ) by L23 , L19 , L21 , SETWISEO:15
.= ( R23 $$ (( R12 \/ {. R7 .} ) , R26) ) by L18 , L21 , SETWISEO:17;
end;
suppose L25: R12 <> ( {} );

consider C2 being (Function of ( Fin R3 ) , R5) such that L26: ( R23 $$ (R12 , R26) ) = ( C2 . R12 ) and L27: (for R22 being (Element of R5) holds (R22 is_a_unity_wrt R23 implies ( C2 . ( {} ) ) = R22)) and L28: (for R8 being (Element of R3) holds ( C2 . { R8 } ) = ( R26 . R8 )) and L29: (for R13 being (Element of ( Fin R3 )) holds ((R13 c= R12 & R13 <> ( {} )) implies (for R8 being (Element of R3) holds (R8 in ( R12 \ R13 ) implies ( C2 . ( R13 \/ { R8 } ) ) = ( R23 . (( C2 . R13 ) , ( R26 . R8 )) ))))) by L18 , L19 , SETWISEO:def 3;
consider C3 being (Function of ( Fin R3 ) , R5) such that L30: ( R23 $$ (( R12 \/ {. R7 .} ) , R26) ) = ( C3 . ( R12 \/ { R7 } ) ) and L31: (for R22 being (Element of R5) holds (R22 is_a_unity_wrt R23 implies ( C3 . ( {} ) ) = R22)) and L32: (for R8 being (Element of R3) holds ( C3 . { R8 } ) = ( R26 . R8 )) and L33: (for R13 being (Element of ( Fin R3 )) holds ((R13 c= ( R12 \/ { R7 } ) & R13 <> ( {} )) implies (for R8 being (Element of R3) holds (R8 in ( ( R12 \/ { R7 } ) \ R13 ) implies ( C3 . ( R13 \/ { R8 } ) ) = ( R23 . (( C3 . R13 ) , ( R26 . R8 )) ))))) by L18 , SETWISEO:def 3;
defpred S1[ set ] means (($1 <> ( {} ) & $1 c= R12) implies ( C3 . $1 ) = ( C2 . $1 ));
L34: (for B2 being (Element of ( Fin R3 )) holds (for B3 being (Element of R3) holds ((S1[ B2 ] & (not B3 in B2)) implies S1[ ( B2 \/ { B3 } ) ])))
proof
L35: R12 c= ( R12 \/ { R7 } ) by XBOOLE_1:7;
let R13 being (Element of ( Fin R3 ));
let R8 being (Element of R3);
assume that
L36: ((R13 <> ( {} ) & R13 c= R12) implies ( C3 . R13 ) = ( C2 . R13 ))
and
L37: (not R8 in R13)
and
L38: ( R13 \/ { R8 } ) <> ( {} )
and
L39: ( R13 \/ { R8 } ) c= R12;
L40: R8 in R12 by L39 , ZFMISC_1:137;
L41: R8 in ( R12 \ R13 ) by L40 , L37 , XBOOLE_0:def 5;
L42: R8 in ( R12 \/ { R7 } ) by L40 , XBOOLE_0:def 3;
L43: R8 in ( ( R12 \/ { R7 } ) \ R13 ) by L42 , L37 , XBOOLE_0:def 5;
L44: R13 c= R12 by L39 , XBOOLE_1:11;
L45: R13 c= ( R12 \/ { R7 } ) by L44 , L35 , XBOOLE_1:1;
per cases ;
suppose L46: R13 = ( {} );

L47: ( C3 . ( R13 \/ { R8 } ) ) = ( R26 . R8 ) by L46 , L32;
thus L48: thesis by L47 , L28 , L46;
end;
suppose L49: R13 <> ( {} );

thus L50: ( C3 . ( R13 \/ { R8 } ) ) = ( R23 . (( C2 . R13 ) , ( R26 . R8 )) ) by L49 , L33 , L36 , L39 , L45 , L43 , XBOOLE_1:11
.= ( C2 . ( R13 \/ { R8 } ) ) by L29 , L39 , L41 , L49 , XBOOLE_1:11;
end;
end;
L52: S1[ ( {}. R3 ) ];
L53: (for R13 being (Element of ( Fin R3 )) holds S1[ R13 ]) from SETWISEO:sch 2(L52 , L34);
L54: R7 in ( R12 \/ { R7 } ) by ZFMISC_1:136;
L55: R7 in ( ( R12 \/ { R7 } ) \ R12 ) by L54 , L20 , XBOOLE_0:def 5;
thus L56: ( R23 $$ (( R12 \/ {. R7 .} ) , R26) ) = ( R23 . (( C3 . R12 ) , ( R26 . R7 )) ) by L55 , L25 , L30 , L33 , XBOOLE_1:7
.= ( R23 . (( R23 $$ (R12 , R26) ) , ( R26 . R7 )) ) by L25 , L26 , L53;
end;
end;
theorem
L58: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R9 being (Element of R3) holds (for R10 being (Element of R3) holds (for R11 being (Element of R3) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R9 <> R10 & R9 <> R11 & R10 <> R11) implies ( R23 $$ ({. R9 , R10 , R11 .} , R26) ) = ( R23 . (( R23 . (( R26 . R9 ) , ( R26 . R10 )) ) , ( R26 . R11 )) )))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R9 being (Element of R3);
let R10 being (Element of R3);
let R11 being (Element of R3);
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L59: R23 is  commutative  associative
and
L60: R9 <> R10;
assume L61: (R9 <> R11 & R10 <> R11);
L62: (not R11 in { R9 , R10 }) by L61 , TARSKI:def 2;
thus L63: ( R23 $$ ({. R9 , R10 , R11 .} , R26) ) = ( R23 $$ (( {. R9 , R10 .} \/ {. R11 .} ) , R26) ) by ENUMSET1:3
.= ( R23 . (( R23 $$ ({. R9 , R10 .} , R26) ) , ( R26 . R11 )) ) by L59 , L62 , L17
.= ( R23 . (( R23 . (( R26 . R9 ) , ( R26 . R10 )) ) , ( R26 . R11 )) ) by L59 , L60 , L6;
end;
theorem
L64: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R14 being (Element of ( Fin R3 )) holds (for R15 being (Element of ( Fin R3 )) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & ((R14 <> ( {} ) & R15 <> ( {} )) or R23 is  having_a_unity) & R14 misses R15) implies ( R23 $$ (( R14 \/ R15 ) , R26) ) = ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (R15 , R26) )) ))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R14 being (Element of ( Fin R3 ));
let R15 being (Element of ( Fin R3 ));
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L65: R23 is  commutative  associative
and
L66: ((R14 <> ( {} ) & R15 <> ( {} )) or R23 is  having_a_unity)
and
L67: ( R14 /\ R15 ) = ( {} );
L68:
now
per cases ;
suppose L69: (R14 = ( {} ) or R15 = ( {} ));

L70:
now
per cases  by L69;
suppose L71: R14 = ( {} );

thus L72: ( R23 $$ (( R14 \/ R15 ) , R26) ) = ( R23 . (( the_unity_wrt R23 ) , ( R23 $$ (R15 , R26) )) ) by L71 , L66 , SETWISEO:15
.= ( R23 . (( R23 $$ (( {}. R3 ) , R26) ) , ( R23 $$ (R15 , R26) )) ) by L65 , L66 , L69 , SETWISEO:31
.= ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (R15 , R26) )) ) by L71;
end;
suppose L73: R15 = ( {} );

thus L74: ( R23 $$ (( R14 \/ R15 ) , R26) ) = ( R23 . (( R23 $$ (R14 , R26) ) , ( the_unity_wrt R23 )) ) by L73 , L66 , SETWISEO:15
.= ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (( {}. R3 ) , R26) )) ) by L65 , L66 , L69 , SETWISEO:31
.= ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (R15 , R26) )) ) by L73;
end;
end;
thus L76: thesis by L70;
end;
suppose L77: (R14 <> ( {} ) & R15 <> ( {} ));

defpred S2[ (Element of ( Fin R3 )) ] means (($1 <> ( {} ) & ( R14 /\ $1 ) = ( {} )) implies ( R23 $$ (( R14 \/ $1 ) , R26) ) = ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ ($1 , R26) )) ));
L78: (for B4 being (Element of ( Fin R3 )) holds (for B5 being (Element of R3) holds ((S2[ B4 ] & (not B5 in B4)) implies S2[ ( B4 \/ {. B5 .} ) ])))
proof
let R12 being (Element of ( Fin R3 ));
let R7 being (Element of R3);
assume that
L79: ((R12 <> ( {} ) & ( R14 /\ R12 ) = ( {} )) implies ( R23 $$ (( R14 \/ R12 ) , R26) ) = ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (R12 , R26) )) ))
and
L80: (not R7 in R12)
and
L81: ( R12 \/ { R7 } ) <> ( {} );
assume L82: ( R14 /\ ( R12 \/ { R7 } ) ) = ( {} );
L83: R14 misses ( R12 \/ { R7 } ) by L82 , XBOOLE_0:def 7;
L84: R7 in ( R12 \/ { R7 } ) by ZFMISC_1:136;
L85: (not R7 in R14) by L84 , L82 , XBOOLE_0:def 4;
L86: ((R12 <> ( {} ) & R14 misses R12) implies ( R23 $$ (( R14 \/ R12 ) , R26) ) = ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (R12 , R26) )) )) by L79 , XBOOLE_0:def 7;
L87:
now
per cases ;
suppose L88: R12 = ( {} );

thus L89: ( R23 $$ (( R14 \/ ( R12 \/ {. R7 .} ) ) , R26) ) = ( R23 . (( R23 $$ (R14 , R26) ) , ( R26 . R7 )) ) by L88 , L65 , L77 , L85 , L17
.= ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (( R12 \/ {. R7 .} ) , R26) )) ) by L65 , L88 , SETWISEO:17;
end;
suppose L90: R12 <> ( {} );

L91: (not R7 in ( R14 \/ R12 )) by L80 , L85 , XBOOLE_0:def 3;
thus L92: ( R23 $$ (( R14 \/ ( R12 \/ {. R7 .} ) ) , R26) ) = ( R23 $$ (( ( R14 \/ R12 ) \/ {. R7 .} ) , R26) ) by XBOOLE_1:4
.= ( R23 . (( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (R12 , R26) )) ) , ( R26 . R7 )) ) by L65 , L86 , L83 , L90 , L91 , L17 , XBOOLE_1:7 , XBOOLE_1:63
.= ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 . (( R23 $$ (R12 , R26) ) , ( R26 . R7 )) )) ) by L65 , BINOP_1:def 3
.= ( R23 . (( R23 $$ (R14 , R26) ) , ( R23 $$ (( R12 \/ {. R7 .} ) , R26) )) ) by L65 , L80 , L90 , L17;
end;
end;
thus L94: thesis by L87;
end;
L95: S2[ ( {}. R3 ) ];
L96: (for R15 being (Element of ( Fin R3 )) holds S2[ R15 ]) from SETWISEO:sch 2(L95 , L78);
thus L97: thesis by L96 , L67 , L77;
end;
end;
thus L99: thesis by L68;
end;
theorem
L100: (for R3 being non  empty set holds (for R4 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R16 being (Element of ( Fin R4 )) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds (for R28 being (Function of R4 , R5) holds ((R23 is  commutative  associative & (R16 <> ( {} ) or R23 is  having_a_unity) & (ex R33 being Function st (( dom R33 ) = R16 & ( rng R33 ) = R12 & R33 is  one-to-one & ( R28 | R16 ) = ( R26 * R33 )))) implies ( R23 $$ (R16 , R28) ) = ( R23 $$ (R12 , R26) ))))))))))
proof
let R3 being non  empty set;
let R4 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R16 being (Element of ( Fin R4 ));
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
let R28 being (Function of R4 , R5);
defpred S3[ (Element of ( Fin R4 )) ] means (($1 <> ( {} ) or R23 is  having_a_unity) implies (for R12 being (Element of ( Fin R3 )) holds ((ex R33 being Function st (( dom R33 ) = $1 & ( rng R33 ) = R12 & R33 is  one-to-one & ( R28 | $1 ) = ( R26 * R33 ))) implies ( R23 $$ ($1 , R28) ) = ( R23 $$ (R12 , R26) ))));
assume L101: R23 is  commutative  associative;
L102: (for B6 being (Element of ( Fin R4 )) holds (for B7 being (Element of R4) holds ((S3[ B6 ] & (not B7 in B6)) implies S3[ ( B6 \/ {. B7 .} ) ])))
proof
let C4 being (Element of ( Fin R4 ));
let C5 being (Element of R4);
assume that
L103: ((C4 <> ( {} ) or R23 is  having_a_unity) implies (for R12 being (Element of ( Fin R3 )) holds ((ex R33 being Function st (( dom R33 ) = C4 & ( rng R33 ) = R12 & R33 is  one-to-one & ( R28 | C4 ) = ( R26 * R33 ))) implies ( R23 $$ (C4 , R28) ) = ( R23 $$ (R12 , R26) ))))
and
L104: (not C5 in C4);
assume L105: (( C4 \/ { C5 } ) <> ( {} ) or R23 is  having_a_unity);
let R12 being (Element of ( Fin R3 ));
set D1 = ( C4 \/ {. C5 .} );
given R33 being Function such that
L106: ( dom R33 ) = D1
and
L107: ( rng R33 ) = R12
and
L108: R33 is  one-to-one
and
L109: ( R28 | D1 ) = ( R26 * R33 );

L110: C5 in D1 by ZFMISC_1:136;
L111: ( R33 . C5 ) in R12 by L110 , L106 , L107 , FUNCT_1:def 3;
L112: R12 c= R3 by FINSUB_1:def 5;
reconsider D2 = ( R33 . C5 ) as (Element of R3) by L112 , L111;
set D3 = ( R12 \ {. D2 .} );
set D4 = ( R33 | C4 );
L113: D4 is  one-to-one by L108 , FUNCT_1:52;
L114:
now
let R2 being set;
thus L115: (R2 in ( rng D4 ) implies R2 in D3)
proof
assume L116: R2 in ( rng D4 );
consider R1 being set such that L117: R1 in ( dom D4 ) and L118: R2 = ( D4 . R1 ) by L116 , FUNCT_1:def 3;
L119: ( D4 . R1 ) = ( R33 . R1 ) by L117 , FUNCT_1:47;
L120: R1 in ( ( dom R33 ) /\ C4 ) by L117 , RELAT_1:61;
L121: (R1 in ( dom R33 ) & R1 <> C5) by L120 , L104 , XBOOLE_0:def 4;
L122: ( R33 . R1 ) <> D2 by L121 , L106 , L108 , L110 , FUNCT_1:def 4;
L123: (not R2 in { D2 }) by L122 , L118 , L119 , TARSKI:def 1;
L124: R1 in ( dom R33 ) by L120 , XBOOLE_0:def 4;
L125: R2 in R12 by L124 , L107 , L118 , L119 , FUNCT_1:def 3;
thus L126: thesis by L125 , L123 , XBOOLE_0:def 5;
end;

assume L127: R2 in D3;
L128: R2 in R12 by L127 , XBOOLE_0:def 5;
consider R1 being set such that L129: R1 in ( dom R33 ) and L130: R2 = ( R33 . R1 ) by L128 , L107 , FUNCT_1:def 3;
L131: (R1 in C4 or R1 in { C5 }) by L106 , L129 , XBOOLE_0:def 3;
L132: (not R2 in { D2 }) by L127 , XBOOLE_0:def 5;
L133: R1 <> C5 by L132 , L130 , TARSKI:def 1;
L134: R1 in ( ( dom R33 ) /\ C4 ) by L133 , L129 , L131 , TARSKI:def 1 , XBOOLE_0:def 4;
L135: (R1 in ( dom D4 ) & ( D4 . R1 ) = ( R33 . R1 )) by L134 , FUNCT_1:48 , RELAT_1:61;
thus L136: R2 in ( rng D4 ) by L135 , L130 , FUNCT_1:def 3;
end;
L137: ( rng D4 ) = D3 by L114 , TARSKI:1;
L138:
now
let R1 being set;
thus L139: (R1 in ( dom ( R28 | C4 ) ) implies R1 in ( dom ( R26 * D4 ) ))
proof
assume L140: R1 in ( dom ( R28 | C4 ) );
L141: R1 in ( ( dom R28 ) /\ C4 ) by L140 , RELAT_1:61;
L142: R1 in C4 by L141 , XBOOLE_0:def 4;
L143: R1 in ( dom R28 ) by L141 , XBOOLE_0:def 4;
L144: R1 in D1 by L142 , ZFMISC_1:136;
L145: R1 in ( ( dom R28 ) /\ D1 ) by L144 , L143 , XBOOLE_0:def 4;
L146: R1 in ( dom ( R26 * R33 ) ) by L145 , L109 , RELAT_1:61;
L147: ( R33 . R1 ) in ( dom R26 ) by L146 , FUNCT_1:11;
L148: R1 in ( dom R33 ) by L146 , FUNCT_1:11;
L149: R1 in ( ( dom R33 ) /\ C4 ) by L148 , L142 , XBOOLE_0:def 4;
L150: R1 in ( dom D4 ) by L149 , RELAT_1:61;
L151: ( D4 . R1 ) = ( R33 . R1 ) by L150 , FUNCT_1:47;
thus L152: thesis by L151 , L147 , L150 , FUNCT_1:11;
end;

assume L153: R1 in ( dom ( R26 * D4 ) );
L154: R1 in ( dom D4 ) by L153 , FUNCT_1:11;
L155: R1 in ( ( dom R33 ) /\ C4 ) by L154 , RELAT_1:61;
L156: R1 in ( dom R33 ) by L155 , XBOOLE_0:def 4;
L157: ( D4 . R1 ) in ( dom R26 ) by L153 , FUNCT_1:11;
L158: ( R33 . R1 ) in ( dom R26 ) by L157 , L154 , FUNCT_1:47;
L159: R1 in ( dom ( R28 | D1 ) ) by L158 , L109 , L156 , FUNCT_1:11;
L160: R1 in ( ( dom R28 ) /\ D1 ) by L159 , RELAT_1:61;
L161: R1 in ( dom R28 ) by L160 , XBOOLE_0:def 4;
L162: R1 in C4 by L155 , XBOOLE_0:def 4;
L163: R1 in ( ( dom R28 ) /\ C4 ) by L162 , L161 , XBOOLE_0:def 4;
thus L164: R1 in ( dom ( R28 | C4 ) ) by L163 , RELAT_1:61;
end;
L165: ( dom ( R28 | C4 ) ) = ( dom ( R26 * D4 ) ) by L138 , TARSKI:1;
L166: C5 in R4;
L167: C5 in ( dom R28 ) by L166 , FUNCT_2:def 1;
L168: C5 in ( ( dom R28 ) /\ D1 ) by L167 , L110 , XBOOLE_0:def 4;
L169: (C5 in ( dom ( R26 * R33 ) ) & ( R28 . C5 ) = ( ( R26 * R33 ) . C5 )) by L168 , L109 , FUNCT_1:48 , RELAT_1:61;
L170: ( R28 . C5 ) = ( R26 . D2 ) by L169 , FUNCT_1:12;
L171: ( D3 \/ { D2 } ) = ( R12 \/ { D2 } ) by XBOOLE_1:39;
L172: R12 = ( D3 \/ { D2 } ) by L171 , L111 , ZFMISC_1:40;
L173: ( dom D4 ) = C4 by L106 , RELAT_1:62 , XBOOLE_1:7;
L174: (for R1 being set holds (R1 in ( dom ( R28 | C4 ) ) implies ( ( R28 | C4 ) . R1 ) = ( ( R26 * D4 ) . R1 )))
proof
let R1 being set;
assume L175: R1 in ( dom ( R28 | C4 ) );
L176: R1 in ( ( dom R28 ) /\ C4 ) by L175 , RELAT_1:61;
L177: R1 in C4 by L176 , XBOOLE_0:def 4;
L178: R1 in D1 by L177 , ZFMISC_1:136;
L179: R1 in ( dom R28 ) by L176 , XBOOLE_0:def 4;
L180: R1 in ( ( dom R28 ) /\ D1 ) by L179 , L178 , XBOOLE_0:def 4;
L181: R1 in ( dom ( R26 * R33 ) ) by L180 , L109 , RELAT_1:61;
L182: R1 in ( dom R33 ) by L181 , FUNCT_1:11;
L183: R1 in ( ( dom R33 ) /\ C4 ) by L182 , L177 , XBOOLE_0:def 4;
L184: R1 in ( dom D4 ) by L183 , RELAT_1:61;
L185: ( D4 . R1 ) = ( R33 . R1 ) by L184 , FUNCT_1:47;
thus L186: ( ( R28 | C4 ) . R1 ) = ( R28 . R1 ) by L177 , FUNCT_1:49
.= ( ( R26 * R33 ) . R1 ) by L109 , L178 , FUNCT_1:49
.= ( R26 . ( R33 . R1 ) ) by L182 , FUNCT_1:13
.= ( ( R26 * D4 ) . R1 ) by L184 , L185 , FUNCT_1:13;
end;
L187: ( R28 | C4 ) = ( R26 * D4 ) by L174 , L165 , FUNCT_1:2;
L188:
now
let R2 being set;
thus L189: (R2 in ( R28 .: C4 ) implies R2 in ( R26 .: D3 ))
proof
assume L190: R2 in ( R28 .: C4 );
consider R1 being set such that L191: R1 in ( dom R28 ) and L192: R1 in C4 and L193: R2 = ( R28 . R1 ) by L190 , FUNCT_1:def 6;
L194: R1 in ( ( dom R28 ) /\ C4 ) by L191 , L192 , XBOOLE_0:def 4;
L195: R1 in ( dom ( R28 | C4 ) ) by L194 , RELAT_1:61;
L196: R1 in ( dom D4 ) by L195 , L165 , FUNCT_1:11;
L197: ( D4 . R1 ) in D3 by L196 , L137 , FUNCT_1:def 3;
L198: R2 = ( ( R26 * D4 ) . R1 ) by L187 , L192 , L193 , FUNCT_1:49;
L199: R2 = ( R26 . ( D4 . R1 ) ) by L198 , L165 , L195 , FUNCT_1:12;
L200: ( D4 . R1 ) in ( dom R26 ) by L165 , L195 , FUNCT_1:11;
thus L201: thesis by L200 , L199 , L197 , FUNCT_1:def 6;
end;

assume L202: R2 in ( R26 .: D3 );
consider R1 being set such that L203: R1 in ( dom R26 ) and L204: R1 in D3 and L205: R2 = ( R26 . R1 ) by L202 , FUNCT_1:def 6;
set D5 = ( ( D4 " ) . R1 );
L206: D5 in C4 by L113 , L173 , L137 , L204 , FUNCT_1:32;
L207: C4 c= R4 by FINSUB_1:def 5;
L208: D5 in R4 by L207 , L206;
L209: D5 in ( dom R28 ) by L208 , FUNCT_2:def 1;
L210: ( D4 . D5 ) = R1 by L113 , L137 , L204 , FUNCT_1:35;
L211: R2 = ( ( R26 * D4 ) . D5 ) by L210 , L173 , L205 , L206 , FUNCT_1:13
.= ( R28 . D5 ) by L187 , L206 , FUNCT_1:49;
thus L212: R2 in ( R28 .: C4 ) by L211 , L206 , L209 , FUNCT_1:def 6;
end;
L213: ( R26 .: D3 ) = ( R28 .: C4 ) by L188 , TARSKI:1;
L214: (not D2 in D3) by ZFMISC_1:56;
L215:
now
per cases ;
suppose L216: C4 = ( {} );

L217: D3 c= R3 by FINSUB_1:def 5;
L218: D3 c= ( dom R26 ) by L217 , FUNCT_2:def 1;
L219: D3 = ( {} ) by L218 , L213 , L216;
thus L220: ( R23 $$ (D1 , R28) ) = ( R26 . D2 ) by L101 , L170 , L216 , SETWISEO:17
.= ( R23 $$ (R12 , R26) ) by L101 , L172 , L219 , SETWISEO:17;
end;
suppose L221: C4 <> ( {} );

L222: C4 c= R4 by FINSUB_1:def 5;
L223: C4 c= ( dom R28 ) by L222 , FUNCT_2:def 1;
L224: D3 <> ( {} ) by L223 , L213 , L221;
thus L225: ( R23 $$ (D1 , R28) ) = ( R23 . (( R23 $$ (C4 , R28) ) , ( R28 . C5 )) ) by L101 , L104 , L221 , L17
.= ( R23 . (( R23 $$ (D3 , R26) ) , ( R26 . D2 )) ) by L103 , L170 , L113 , L173 , L137 , L165 , L174 , L221 , FUNCT_1:2
.= ( R23 $$ (R12 , R26) ) by L101 , L172 , L214 , L224 , L17;
end;
end;
thus L227: thesis by L215;
end;
L228: S3[ ( {}. R4 ) ]
proof
assume L229: (( {}. R4 ) <> ( {} ) or R23 is  having_a_unity);
let R12 being (Element of ( Fin R3 ));
given R33 being Function such that
L230: (( dom R33 ) = ( {}. R4 ) & ( rng R33 ) = R12 & R33 is  one-to-one)
and
L231: ( R28 | ( {}. R4 ) ) = ( R26 * R33 );

L232: R12 , ( {} ) are_equipotent  by L230 , WELLORD2:def 4;
L233: R12 = ( {}. R3 ) by L232 , CARD_1:26;
L234: ( R23 $$ (( {}. R4 ) , R28) ) = ( the_unity_wrt R23 ) by L101 , L229 , SETWISEO:31;
thus L235: thesis by L234 , L101 , L229 , L233 , SETWISEO:31;
end;
L236: (for R16 being (Element of ( Fin R4 )) holds S3[ R16 ]) from SETWISEO:sch 2(L228 , L102);
thus L237: thesis by L236;
end;
theorem
L238: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R26 being (Function of R3 , R5) holds (for R29 being (BinOp of R6) holds (for R30 being (Function of R5 , R6) holds ((R29 is  commutative  associative & (R12 <> ( {} ) or R29 is  having_a_unity) & R26 is  one-to-one) implies ( R29 $$ (( R26 .: R12 ) , R30) ) = ( R29 $$ (R12 , ( R30 * R26 )) )))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R6 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R26 being (Function of R3 , R5);
let R29 being (BinOp of R6);
let R30 being (Function of R5 , R6);
assume that
L239: (R29 is  commutative  associative & (R12 <> ( {} ) or R29 is  having_a_unity))
and
L240: R26 is  one-to-one;
set D6 = ( R26 | R12 );
L241: (( rng D6 ) = ( R26 .: R12 ) & ( ( R30 * R26 ) | R12 ) = ( R30 * D6 )) by RELAT_1:83 , RELAT_1:115;
L242: R12 c= R3 by FINSUB_1:def 5;
L243: R12 c= ( dom R26 ) by L242 , FUNCT_2:def 1;
L244: ( dom D6 ) = R12 by L243 , RELAT_1:62;
L245: D6 is  one-to-one by L240 , FUNCT_1:52;
thus L246: thesis by L245 , L239 , L244 , L241 , L100;
end;
theorem
L247: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds (for R27 being (Function of R3 , R5) holds ((R23 is  commutative  associative & (R12 <> ( {} ) or R23 is  having_a_unity) & ( R26 | R12 ) = ( R27 | R12 )) implies ( R23 $$ (R12 , R26) ) = ( R23 $$ (R12 , R27) ))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
let R27 being (Function of R3 , R5);
assume L248: (R23 is  commutative  associative & (R12 <> ( {} ) or R23 is  having_a_unity));
set D7 = ( id R12 );
L249: (( dom D7 ) = R12 & ( rng D7 ) = R12);
assume L250: ( R26 | R12 ) = ( R27 | R12 );
L251: ( R26 | R12 ) = ( R27 * D7 ) by L250 , RELAT_1:65;
thus L252: thesis by L251 , L248 , L249 , L100;
end;
theorem
L253: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ) & ( R26 .: R12 ) = { R22 }) implies ( R23 $$ (R12 , R26) ) = R22)))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L254: R23 is  commutative  associative
and
L255: R23 is  having_a_unity
and
L256: R22 = ( the_unity_wrt R23 );
defpred S4[ (Element of ( Fin R3 )) ] means (( R26 .: $1 ) = { R22 } implies ( R23 $$ ($1 , R26) ) = R22);
L257: (for B8 being (Element of ( Fin R3 )) holds (for B9 being (Element of R3) holds ((S4[ B8 ] & (not B9 in B8)) implies S4[ ( B8 \/ {. B9 .} ) ])))
proof
let R13 being (Element of ( Fin R3 ));
let R7 being (Element of R3);
assume that
L258: (( R26 .: R13 ) = { R22 } implies ( R23 $$ (R13 , R26) ) = R22)
and
L259: (not R7 in R13)
and
L260: ( R26 .: ( R13 \/ { R7 } ) ) = { R22 };
L261:
now
per cases ;
suppose L262: R13 = ( {} );

L263: R13 = ( {}. R3 ) by L262;
thus L264: ( R23 $$ (( R13 \/ {. R7 .} ) , R26) ) = ( R23 . (( R23 $$ (R13 , R26) ) , ( R26 . R7 )) ) by L254 , L255 , L259 , L17
.= ( R23 . (R22 , ( R26 . R7 )) ) by L254 , L255 , L256 , L263 , SETWISEO:31;
end;
suppose L265: R13 <> ( {} );

L266: R13 c= R3 by FINSUB_1:def 5;
L267: R13 c= ( dom R26 ) by L266 , FUNCT_2:def 1;
L268: ( R26 .: R13 ) c= { R22 } by L260 , RELAT_1:123 , XBOOLE_1:7;
thus L269: ( R23 $$ (( R13 \/ {. R7 .} ) , R26) ) = ( R23 . (R22 , ( R26 . R7 )) ) by L268 , L254 , L258 , L259 , L265 , L267 , L17 , ZFMISC_1:33;
end;
end;
L271: {. R7 .} c= R3 by FINSUB_1:def 5;
L272: { R7 } c= ( dom R26 ) by L271 , FUNCT_2:def 1;
L273: R7 in ( dom R26 ) by L272 , ZFMISC_1:31;
L274: ( Im (R26 , R7) ) c= { R22 } by L260 , RELAT_1:123 , XBOOLE_1:7;
L275: ( Im (R26 , R7) ) = { R22 } by L274 , L272 , ZFMISC_1:33;
L276: { R22 } = { ( R26 . R7 ) } by L275 , L273 , FUNCT_1:59;
L277: ( R26 . R7 ) = R22 by L276 , ZFMISC_1:3;
thus L278: thesis by L277 , L255 , L256 , L261 , SETWISEO:15;
end;
L279: S4[ ( {}. R3 ) ];
L280: (for R12 being (Element of ( Fin R3 )) holds S4[ R12 ]) from SETWISEO:sch 2(L279 , L257);
thus L281: thesis by L280;
end;
theorem
L282: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds (for R27 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ) & ( R24 . (R22 , R22) ) = R22 & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R24 . (R18 , R19) ) , ( R24 . (R20 , R21) )) ) = ( R24 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) )))))) implies ( R24 . (( R23 $$ (R12 , R26) ) , ( R23 $$ (R12 , R27) )) ) = ( R23 $$ (R12 , ( R24 .: (R26 , R27) )) ))))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R26 being (Function of R3 , R5);
let R27 being (Function of R3 , R5);
assume that
L283: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L284: R22 = ( the_unity_wrt R23 )
and
L285: ( R24 . (R22 , R22) ) = R22
and
L286: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R24 . (R18 , R19) ) , ( R24 . (R20 , R21) )) ) = ( R24 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) )))));
defpred S5[ (Element of ( Fin R3 )) ] means ( R24 . (( R23 $$ ($1 , R26) ) , ( R23 $$ ($1 , R27) )) ) = ( R23 $$ ($1 , ( R24 .: (R26 , R27) )) );
L287: (for B10 being (Element of ( Fin R3 )) holds (for B11 being (Element of R3) holds ((S5[ B10 ] & (not B11 in B10)) implies S5[ ( B10 \/ {. B11 .} ) ])))
proof
let R12 being (Element of ( Fin R3 ));
let R7 being (Element of R3);
assume that
L288: ( R24 . (( R23 $$ (R12 , R26) ) , ( R23 $$ (R12 , R27) )) ) = ( R23 $$ (R12 , ( R24 .: (R26 , R27) )) )
and
L289: (not R7 in R12);
set D8 = ( R23 $$ (R12 , R27) );
set D9 = ( R23 $$ (R12 , R26) );
L290: (( R23 $$ (( R12 \/ {. R7 .} ) , R26) ) = ( R23 . (D9 , ( R26 . R7 )) ) & ( R23 $$ (( R12 \/ {. R7 .} ) , R27) ) = ( R23 . (D8 , ( R27 . R7 )) )) by L283 , L289 , L17;
thus L291: ( R24 . (( R23 $$ (( R12 \/ {. R7 .} ) , R26) ) , ( R23 $$ (( R12 \/ {. R7 .} ) , R27) )) ) = ( R23 . (( R24 . (D9 , D8) ) , ( R24 . (( R26 . R7 ) , ( R27 . R7 )) )) ) by L290 , L286
.= ( R23 . (( R24 . (D9 , D8) ) , ( ( R24 .: (R26 , R27) ) . R7 )) ) by FUNCOP_1:37
.= ( R23 $$ (( R12 \/ {. R7 .} ) , ( R24 .: (R26 , R27) )) ) by L283 , L288 , L289 , L17;
end;
L292: (( R23 $$ (( {}. R3 ) , R26) ) = R22 & ( R23 $$ (( {}. R3 ) , R27) ) = R22) by L283 , L284 , SETWISEO:31;
L293: S5[ ( {}. R3 ) ] by L292 , L283 , L284 , L285 , SETWISEO:31;
L294: (for R12 being (Element of ( Fin R3 )) holds S5[ R12 ]) from SETWISEO:sch 2(L293 , L287);
thus L295: thesis by L294;
end;
L296: (for R5 being non  empty set holds (for R23 being (BinOp of R5) holds (R23 is  commutative  associative implies (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R23 . (R18 , R19) ) , ( R23 . (R20 , R21) )) ) = ( R23 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) ))))))))
proof
let R5 being non  empty set;
let R23 being (BinOp of R5);
assume that
L297: R23 is  commutative
and
L298: R23 is  associative;
let R18 being (Element of R5);
let R19 being (Element of R5);
let R20 being (Element of R5);
let R21 being (Element of R5);
thus L299: ( R23 . (( R23 . (R18 , R19) ) , ( R23 . (R20 , R21) )) ) = ( R23 . (R18 , ( R23 . (R19 , ( R23 . (R20 , R21) )) )) ) by L298 , BINOP_1:def 3
.= ( R23 . (R18 , ( R23 . (( R23 . (R19 , R20) ) , R21) )) ) by L298 , BINOP_1:def 3
.= ( R23 . (R18 , ( R23 . (( R23 . (R20 , R19) ) , R21) )) ) by L297 , BINOP_1:def 2
.= ( R23 . (R18 , ( R23 . (R20 , ( R23 . (R19 , R21) )) )) ) by L298 , BINOP_1:def 3
.= ( R23 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) ) by L298 , BINOP_1:def 3;
end;
theorem
L300: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds (for R27 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity) implies ( R23 . (( R23 $$ (R12 , R26) ) , ( R23 $$ (R12 , R27) )) ) = ( R23 $$ (R12 , ( R23 .: (R26 , R27) )) ))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
let R27 being (Function of R3 , R5);
set D10 = ( the_unity_wrt R23 );
assume L301: (R23 is  commutative & R23 is  associative & R23 is  having_a_unity);
L302: (( R23 . (D10 , D10) ) = D10 & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R23 . (R18 , R19) ) , ( R23 . (R20 , R21) )) ) = ( R23 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) )))))) by L301 , L296 , SETWISEO:15;
thus L303: thesis by L302 , L301 , L282;
end;
theorem
L304: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds (for R27 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp & R24 = ( R23 * (( id R5 ) , ( the_inverseOp_wrt R23 )) )) implies ( R24 . (( R23 $$ (R12 , R26) ) , ( R23 $$ (R12 , R27) )) ) = ( R23 $$ (R12 , ( R24 .: (R26 , R27) )) )))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R26 being (Function of R3 , R5);
let R27 being (Function of R3 , R5);
assume that
L305: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L306: (R23 is  having_an_inverseOp & R24 = ( R23 * (( id R5 ) , ( the_inverseOp_wrt R23 )) ));
set D11 = ( the_unity_wrt R23 );
L307: (( R24 . (D11 , D11) ) = D11 & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R24 . (R18 , R19) ) , ( R24 . (R20 , R21) )) ) = ( R24 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) )))))) by L305 , L306 , FINSEQOP:86 , FINSEQOP:89;
thus L308: thesis by L307 , L305 , L282;
end;
theorem
L309: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R17 being (Element of R5) holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ) & R24 is_distributive_wrt R23 & ( R24 . (R17 , R22) ) = R22) implies ( R24 . (R17 , ( R23 $$ (R12 , R26) )) ) = ( R23 $$ (R12 , ( R24 [;] (R17 , R26) )) ))))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R17 being (Element of R5);
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L310: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L311: R22 = ( the_unity_wrt R23 )
and
L312: R24 is_distributive_wrt R23;
defpred S6[ (Element of ( Fin R3 )) ] means ( R24 . (R17 , ( R23 $$ ($1 , R26) )) ) = ( R23 $$ ($1 , ( R24 [;] (R17 , R26) )) );
L313: (for B12 being (Element of ( Fin R3 )) holds (for B13 being (Element of R3) holds ((S6[ B12 ] & (not B13 in B12)) implies S6[ ( B12 \/ {. B13 .} ) ])))
proof
let R13 being (Element of ( Fin R3 ));
let R7 being (Element of R3);
assume that
L314: ( R24 . (R17 , ( R23 $$ (R13 , R26) )) ) = ( R23 $$ (R13 , ( R24 [;] (R17 , R26) )) )
and
L315: (not R7 in R13);
thus L316: ( R24 . (R17 , ( R23 $$ (( R13 \/ {. R7 .} ) , R26) )) ) = ( R24 . (R17 , ( R23 . (( R23 $$ (R13 , R26) ) , ( R26 . R7 )) )) ) by L310 , L315 , L17
.= ( R23 . (( R24 . (R17 , ( R23 $$ (R13 , R26) )) ) , ( R24 . (R17 , ( R26 . R7 )) )) ) by L312 , BINOP_1:11
.= ( R23 . (( R23 $$ (R13 , ( R24 [;] (R17 , R26) )) ) , ( ( R24 [;] (R17 , R26) ) . R7 )) ) by L314 , FUNCOP_1:53
.= ( R23 $$ (( R13 \/ {. R7 .} ) , ( R24 [;] (R17 , R26) )) ) by L310 , L315 , L17;
end;
assume L317: ( R24 . (R17 , R22) ) = R22;
L318: ( R24 . (R17 , ( R23 $$ (( {}. R3 ) , R26) )) ) = R22 by L317 , L310 , L311 , SETWISEO:31
.= ( R23 $$ (( {}. R3 ) , ( R24 [;] (R17 , R26) )) ) by L310 , L311 , SETWISEO:31;
L319: S6[ ( {}. R3 ) ] by L318;
L320: (for R12 being (Element of ( Fin R3 )) holds S6[ R12 ]) from SETWISEO:sch 2(L319 , L313);
thus L321: thesis by L320;
end;
theorem
L322: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R17 being (Element of R5) holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ) & R24 is_distributive_wrt R23 & ( R24 . (R22 , R17) ) = R22) implies ( R24 . (( R23 $$ (R12 , R26) ) , R17) ) = ( R23 $$ (R12 , ( R24 [:] (R26 , R17) )) ))))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R17 being (Element of R5);
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L323: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L324: R22 = ( the_unity_wrt R23 )
and
L325: R24 is_distributive_wrt R23;
defpred S7[ (Element of ( Fin R3 )) ] means ( R24 . (( R23 $$ ($1 , R26) ) , R17) ) = ( R23 $$ ($1 , ( R24 [:] (R26 , R17) )) );
L326: (for B14 being (Element of ( Fin R3 )) holds (for B15 being (Element of R3) holds ((S7[ B14 ] & (not B15 in B14)) implies S7[ ( B14 \/ {. B15 .} ) ])))
proof
let R13 being (Element of ( Fin R3 ));
let R7 being (Element of R3);
assume that
L327: ( R24 . (( R23 $$ (R13 , R26) ) , R17) ) = ( R23 $$ (R13 , ( R24 [:] (R26 , R17) )) )
and
L328: (not R7 in R13);
thus L329: ( R24 . (( R23 $$ (( R13 \/ {. R7 .} ) , R26) ) , R17) ) = ( R24 . (( R23 . (( R23 $$ (R13 , R26) ) , ( R26 . R7 )) ) , R17) ) by L323 , L328 , L17
.= ( R23 . (( R24 . (( R23 $$ (R13 , R26) ) , R17) ) , ( R24 . (( R26 . R7 ) , R17) )) ) by L325 , BINOP_1:11
.= ( R23 . (( R23 $$ (R13 , ( R24 [:] (R26 , R17) )) ) , ( ( R24 [:] (R26 , R17) ) . R7 )) ) by L327 , FUNCOP_1:48
.= ( R23 $$ (( R13 \/ {. R7 .} ) , ( R24 [:] (R26 , R17) )) ) by L323 , L328 , L17;
end;
assume L330: ( R24 . (R22 , R17) ) = R22;
L331: ( R24 . (( R23 $$ (( {}. R3 ) , R26) ) , R17) ) = R22 by L330 , L323 , L324 , SETWISEO:31
.= ( R23 $$ (( {}. R3 ) , ( R24 [:] (R26 , R17) )) ) by L323 , L324 , SETWISEO:31;
L332: S7[ ( {}. R3 ) ] by L331;
L333: (for R12 being (Element of ( Fin R3 )) holds S7[ R12 ]) from SETWISEO:sch 2(L332 , L326);
thus L334: thesis by L333;
end;
theorem
L335: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R17 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp & R24 is_distributive_wrt R23) implies ( R24 . (R17 , ( R23 $$ (R12 , R26) )) ) = ( R23 $$ (R12 , ( R24 [;] (R17 , R26) )) )))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R17 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L336: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L337: R23 is  having_an_inverseOp
and
L338: R24 is_distributive_wrt R23;
set D12 = ( the_unity_wrt R23 );
L339: ( R24 . (R17 , D12) ) = D12 by L336 , L337 , L338 , FINSEQOP:66;
thus L340: thesis by L339 , L336 , L338 , L309;
end;
theorem
L341: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R17 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp & R24 is_distributive_wrt R23) implies ( R24 . (( R23 $$ (R12 , R26) ) , R17) ) = ( R23 $$ (R12 , ( R24 [:] (R26 , R17) )) )))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R17 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L342: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L343: R23 is  having_an_inverseOp
and
L344: R24 is_distributive_wrt R23;
set D13 = ( the_unity_wrt R23 );
L345: ( R24 . (D13 , R17) ) = D13 by L342 , L343 , L344 , FINSEQOP:66;
thus L346: thesis by L345 , L342 , L344 , L322;
end;
theorem
L347: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R6 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds (for R29 being (BinOp of R6) holds (for R30 being (Function of R5 , R6) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R29 is  commutative  associative & R29 is  having_a_unity & ( R30 . ( the_unity_wrt R23 ) ) = ( the_unity_wrt R29 ) & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( R30 . ( R23 . (R18 , R19) ) ) = ( R29 . (( R30 . R18 ) , ( R30 . R19 )) )))) implies ( R30 . ( R23 $$ (R12 , R26) ) ) = ( R29 $$ (R12 , ( R30 * R26 )) ))))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R6 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
let R29 being (BinOp of R6);
let R30 being (Function of R5 , R6);
assume that
L348: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L349: (R29 is  commutative  associative & R29 is  having_a_unity)
and
L350: ( R30 . ( the_unity_wrt R23 ) ) = ( the_unity_wrt R29 )
and
L351: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( R30 . ( R23 . (R18 , R19) ) ) = ( R29 . (( R30 . R18 ) , ( R30 . R19 )) )));
defpred S8[ (Element of ( Fin R3 )) ] means ( R30 . ( R23 $$ ($1 , R26) ) ) = ( R29 $$ ($1 , ( R30 * R26 )) );
L352: (for B16 being (Element of ( Fin R3 )) holds (for B17 being (Element of R3) holds ((S8[ B16 ] & (not B17 in B16)) implies S8[ ( B16 \/ {. B17 .} ) ])))
proof
let R12 being (Element of ( Fin R3 ));
let R7 being (Element of R3);
assume that
L353: ( R30 . ( R23 $$ (R12 , R26) ) ) = ( R29 $$ (R12 , ( R30 * R26 )) )
and
L354: (not R7 in R12);
thus L355: ( R30 . ( R23 $$ (( R12 \/ {. R7 .} ) , R26) ) ) = ( R30 . ( R23 . (( R23 $$ (R12 , R26) ) , ( R26 . R7 )) ) ) by L348 , L354 , L17
.= ( R29 . (( R29 $$ (R12 , ( R30 * R26 )) ) , ( R30 . ( R26 . R7 ) )) ) by L351 , L353
.= ( R29 . (( R29 $$ (R12 , ( R30 * R26 )) ) , ( ( R30 * R26 ) . R7 )) ) by FUNCT_2:15
.= ( R29 $$ (( R12 \/ {. R7 .} ) , ( R30 * R26 )) ) by L349 , L354 , L17;
end;
L356: ( R30 . ( R23 $$ (( {}. R3 ) , R26) ) ) = ( the_unity_wrt R29 ) by L348 , L350 , SETWISEO:31
.= ( R29 $$ (( {}. R3 ) , ( R30 * R26 )) ) by L349 , SETWISEO:31;
L357: S8[ ( {}. R3 ) ] by L356;
L358: (for R12 being (Element of ( Fin R3 )) holds S8[ R12 ]) from SETWISEO:sch 2(L357 , L352);
thus L359: thesis by L358;
end;
theorem
L360: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R23 being (BinOp of R5) holds (for R25 being (UnOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & ( R25 . ( the_unity_wrt R23 ) ) = ( the_unity_wrt R23 ) & R25 is_distributive_wrt R23) implies ( R25 . ( R23 $$ (R12 , R26) ) ) = ( R23 $$ (R12 , ( R25 * R26 )) ))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R23 being (BinOp of R5);
let R25 being (UnOp of R5);
let R26 being (Function of R3 , R5);
assume L361: (R23 is  commutative  associative & R23 is  having_a_unity & ( R25 . ( the_unity_wrt R23 ) ) = ( the_unity_wrt R23 ));
assume L362: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( R25 . ( R23 . (R18 , R19) ) ) = ( R23 . (( R25 . R18 ) , ( R25 . R19 )) )));
thus L363: thesis by L362 , L361 , L347;
end;
theorem
L364: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R17 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp & R24 is_distributive_wrt R23) implies ( ( R24 [;] (R17 , ( id R5 )) ) . ( R23 $$ (R12 , R26) ) ) = ( R23 $$ (R12 , ( ( R24 [;] (R17 , ( id R5 )) ) * R26 )) )))))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R17 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L365: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L366: R23 is  having_an_inverseOp
and
L367: R24 is_distributive_wrt R23;
set D14 = ( the_unity_wrt R23 );
set D15 = ( R24 [;] (R17 , ( id R5 )) );
L368: D15 is_distributive_wrt R23 by L367 , FINSEQOP:54;
L369: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( D15 . ( R23 . (R18 , R19) ) ) = ( R23 . (( D15 . R18 ) , ( D15 . R19 )) ))) by L368 , BINOP_1:def 12;
L370: ( ( R24 [;] (R17 , ( id R5 )) ) . D14 ) = D14 by L365 , L366 , L367 , FINSEQOP:69;
thus L371: thesis by L370 , L365 , L369 , L347;
end;
theorem
L372: (for R3 being non  empty set holds (for R5 being non  empty set holds (for R12 being (Element of ( Fin R3 )) holds (for R23 being (BinOp of R5) holds (for R26 being (Function of R3 , R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp) implies ( ( the_inverseOp_wrt R23 ) . ( R23 $$ (R12 , R26) ) ) = ( R23 $$ (R12 , ( ( the_inverseOp_wrt R23 ) * R26 )) )))))))
proof
let R3 being non  empty set;
let R5 being non  empty set;
let R12 being (Element of ( Fin R3 ));
let R23 being (BinOp of R5);
let R26 being (Function of R3 , R5);
assume that
L373: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L374: R23 is  having_an_inverseOp;
set D16 = ( the_unity_wrt R23 );
set D17 = ( the_inverseOp_wrt R23 );
L375: D17 is_distributive_wrt R23 by L373 , L374 , FINSEQOP:63;
L376: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( D17 . ( R23 . (R18 , R19) ) ) = ( R23 . (( D17 . R18 ) , ( D17 . R19 )) ))) by L375 , BINOP_1:def 12;
L377: ( D17 . D16 ) = D16 by L373 , L374 , FINSEQOP:61;
thus L378: thesis by L377 , L373 , L376 , L347;
end;
definition
let R5 being non  empty set;
let R34 being (FinSequence of R5);
let R17 being (Element of R5);
func [#] (R34 , R17) -> (Function of ( NAT ) , R5) equals 
( ( ( NAT ) --> R17 ) +* R34 );
coherence;
end;
theorem
L380: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R31 being Nat holds (for R34 being (FinSequence of R5) holds ((R31 in ( dom R34 ) implies ( ( [#] (R34 , R17) ) . R31 ) = ( R34 . R31 )) & ((not R31 in ( dom R34 )) implies ( ( [#] (R34 , R17) ) . R31 ) = R17))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R31 being Nat;
let R34 being (FinSequence of R5);
thus L381: (R31 in ( dom R34 ) implies ( ( [#] (R34 , R17) ) . R31 ) = ( R34 . R31 )) by FUNCT_4:13;
L382: R31 in ( NAT ) by ORDINAL1:def 12;
assume L383: (not R31 in ( dom R34 ));
thus L384: ( ( [#] (R34 , R17) ) . R31 ) = ( ( ( NAT ) --> R17 ) . R31 ) by L383 , FUNCT_4:11
.= R17 by L382 , FUNCOP_1:7;
end;
theorem
L385: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R34 being (FinSequence of R5) holds ( ( [#] (R34 , R17) ) | ( dom R34 ) ) = R34)))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R34 being (FinSequence of R5);
set D18 = ( len R34 );
set D19 = ( [#] (R34 , R17) );
L386: ( Seg D18 ) c= ( NAT );
L387: ( Seg D18 ) c= ( dom D19 ) by L386 , FUNCT_2:def 1;
L388: ( dom ( D19 | ( Seg D18 ) ) ) = ( Seg D18 ) by L387 , RELAT_1:62;
L389: ( dom R34 ) = ( Seg D18 ) by FINSEQ_1:def 3;
L390:
now
let R1 being set;
assume L391: R1 in ( Seg D18 );
L392: ( ( D19 | ( Seg D18 ) ) . R1 ) = ( D19 . R1 ) by L391 , L388 , FUNCT_1:47;
thus L393: ( ( D19 | ( Seg D18 ) ) . R1 ) = ( R34 . R1 ) by L392 , L389 , L391 , L380;
end;
thus L394: thesis by L390 , L388 , L389 , FUNCT_1:2;
end;
theorem
L395: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R34 being (FinSequence of R5) holds (for R35 being (FinSequence of R5) holds ( ( [#] (( R34 ^ R35 ) , R17) ) | ( dom R34 ) ) = R34))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R34 being (FinSequence of R5);
let R35 being (FinSequence of R5);
set D20 = ( len R34 );
set D21 = ( [#] (( R34 ^ R35 ) , R17) );
L396: ( Seg D20 ) c= ( NAT );
L397: ( Seg D20 ) c= ( dom D21 ) by L396 , FUNCT_2:def 1;
L398: ( dom ( D21 | ( Seg D20 ) ) ) = ( Seg D20 ) by L397 , RELAT_1:62;
L399: ( dom R34 ) = ( Seg D20 ) by FINSEQ_1:def 3;
L400:
now
let R1 being set;
L401: D20 <= ( D20 + ( len R35 ) ) by NAT_1:12;
L402: D20 <= ( len ( R34 ^ R35 ) ) by L401 , FINSEQ_1:22;
L403: (( Seg ( len ( R34 ^ R35 ) ) ) = ( dom ( R34 ^ R35 ) ) & ( Seg D20 ) c= ( Seg ( len ( R34 ^ R35 ) ) )) by L402 , FINSEQ_1:5 , FINSEQ_1:def 3;
assume L404: R1 in ( Seg D20 );
L405: ( ( D21 | ( Seg D20 ) ) . R1 ) = ( D21 . R1 ) by L404 , L398 , FUNCT_1:47;
thus L406: ( ( D21 | ( Seg D20 ) ) . R1 ) = ( ( R34 ^ R35 ) . R1 ) by L405 , L404 , L403 , L380
.= ( R34 . R1 ) by L399 , L404 , FINSEQ_1:def 7;
end;
thus L407: thesis by L400 , L398 , L399 , FUNCT_1:2;
end;
theorem
L408: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R34 being (FinSequence of R5) holds ( rng ( [#] (R34 , R17) ) ) = ( ( rng R34 ) \/ { R17 } ))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R34 being (FinSequence of R5);
L409:
now
let R2 being set;
thus L410: (R2 in ( rng ( [#] (R34 , R17) ) ) implies R2 in ( ( rng R34 ) \/ { R17 } ))
proof
assume L411: R2 in ( rng ( [#] (R34 , R17) ) );
consider R1 being set such that L412: R1 in ( dom ( [#] (R34 , R17) ) ) and L413: R2 = ( ( [#] (R34 , R17) ) . R1 ) by L411 , FUNCT_1:def 3;
reconsider D22 = R1 as (Element of ( NAT )) by L412;
L414:
now
per cases ;
case L415: D22 in ( dom R34 );
L416: R2 = ( R34 . D22 ) by L415 , L413 , L380;
thus L417: R2 in ( rng R34 ) by L416 , L415 , FUNCT_1:def 3;
end;
case L418: (not D22 in ( dom R34 ));
L419: R2 = R17 by L418 , L413 , L380;
thus L420: R2 in { R17 } by L419 , TARSKI:def 1;
end;
end;
thus L422: thesis by L414 , XBOOLE_0:def 3;
end;

assume L423: R2 in ( ( rng R34 ) \/ { R17 } );
L424:
now
per cases  by L423 , XBOOLE_0:def 3;
suppose L425: R2 in ( rng R34 );

consider C6 being Nat such that L426: C6 in ( dom R34 ) and L427: R2 = ( R34 . C6 ) by L425 , FINSEQ_2:10;
L428: R2 = ( ( [#] (R34 , R17) ) . C6 ) by L426 , L427 , L380;
thus L429: R2 in ( rng ( [#] (R34 , R17) ) ) by L428 , L426 , FUNCT_2:4;
end;
suppose L430: R2 in { R17 };

L431: ( dom R34 ) = ( Seg ( len R34 ) ) by FINSEQ_1:def 3;
L432: (not ( ( len R34 ) + 1 ) in ( dom R34 )) by L431 , L2;
L433: R2 = R17 by L430 , TARSKI:def 1;
L434: R2 = ( ( [#] (R34 , R17) ) . ( ( len R34 ) + 1 ) ) by L433 , L432 , L380;
thus L435: R2 in ( rng ( [#] (R34 , R17) ) ) by L434 , FUNCT_2:4;
end;
end;
thus L437: R2 in ( rng ( [#] (R34 , R17) ) ) by L424;
end;
thus L438: thesis by L409 , TARSKI:1;
end;
theorem
L439: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R17 being (Element of R5) holds (for R30 being (Function of R5 , R6) holds (for R34 being (FinSequence of R5) holds ( R30 * ( [#] (R34 , R17) ) ) = ( [#] (( R30 * R34 ) , ( R30 . R17 )) ))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R17 being (Element of R5);
let R30 being (Function of R5 , R6);
let R34 being (FinSequence of R5);
L440:
now
let C7 being (Element of ( NAT ));
L441: ( dom ( R30 * R34 ) ) = ( Seg ( len ( R30 * R34 ) ) ) by FINSEQ_1:def 3;
L442: (( len ( R30 * R34 ) ) = ( len R34 ) & ( Seg ( len R34 ) ) = ( dom R34 )) by FINSEQ_1:def 3 , FINSEQ_2:33;
L443:
now
per cases ;
suppose L444: C7 in ( dom R34 );

thus L445: ( R30 . ( ( [#] (R34 , R17) ) . C7 ) ) = ( R30 . ( R34 . C7 ) ) by L444 , L380
.= ( ( R30 * R34 ) . C7 ) by L444 , FUNCT_1:13
.= ( ( [#] (( R30 * R34 ) , ( R30 . R17 )) ) . C7 ) by L442 , L441 , L444 , L380;
end;
suppose L446: (not C7 in ( dom R34 ));

thus L447: ( R30 . ( ( [#] (R34 , R17) ) . C7 ) ) = ( R30 . R17 ) by L446 , L380
.= ( ( [#] (( R30 * R34 ) , ( R30 . R17 )) ) . C7 ) by L442 , L441 , L446 , L380;
end;
end;
thus L449: ( ( R30 * ( [#] (R34 , R17) ) ) . C7 ) = ( ( [#] (( R30 * R34 ) , ( R30 . R17 )) ) . C7 ) by L443 , FUNCT_2:15;
end;
thus L450: thesis by L440 , FUNCT_2:63;
end;
L451: (for R5 being non  empty set holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds (for R35 being (FinSequence of R5) holds ((( len R34 ) = ( len R35 ) & ( R23 . (R22 , R22) ) = R22) implies ( R23 .: (( [#] (R34 , R22) ) , ( [#] (R35 , R22) )) ) = ( [#] (( R23 .: (R34 , R35) ) , R22) )))))))
proof
let R5 being non  empty set;
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R34 being (FinSequence of R5);
let R35 being (FinSequence of R5);
assume that
L452: ( len R34 ) = ( len R35 )
and
L453: ( R23 . (R22 , R22) ) = R22;
set D23 = ( R23 .: (R34 , R35) );
L454: ( len D23 ) = ( len R34 ) by L452 , FINSEQ_2:72;
L455: ( dom D23 ) = ( Seg ( len D23 ) ) by FINSEQ_1:def 3;
L456: ( dom R34 ) = ( Seg ( len R34 ) ) by FINSEQ_1:def 3;
L457: ( dom R35 ) = ( Seg ( len R35 ) ) by FINSEQ_1:def 3;
L458:
now
let C8 being (Element of ( NAT ));
L459:
now
per cases ;
suppose L460: C8 in ( dom R34 );

thus L461: ( R23 . (( ( [#] (R34 , R22) ) . C8 ) , ( ( [#] (R35 , R22) ) . C8 )) ) = ( R23 . (( R34 . C8 ) , ( ( [#] (R35 , R22) ) . C8 )) ) by L460 , L380
.= ( R23 . (( R34 . C8 ) , ( R35 . C8 )) ) by L452 , L456 , L457 , L460 , L380
.= ( D23 . C8 ) by L454 , L456 , L455 , L460 , FUNCOP_1:22
.= ( ( [#] (D23 , R22) ) . C8 ) by L454 , L456 , L455 , L460 , L380;
end;
suppose L462: (not C8 in ( dom R34 ));

thus L463: ( R23 . (( ( [#] (R34 , R22) ) . C8 ) , ( ( [#] (R35 , R22) ) . C8 )) ) = ( R23 . (R22 , ( ( [#] (R35 , R22) ) . C8 )) ) by L462 , L380
.= R22 by L452 , L453 , L456 , L457 , L462 , L380
.= ( ( [#] (D23 , R22) ) . C8 ) by L454 , L456 , L455 , L462 , L380;
end;
end;
thus L465: ( ( R23 .: (( [#] (R34 , R22) ) , ( [#] (R35 , R22) )) ) . C8 ) = ( ( [#] (D23 , R22) ) . C8 ) by L459 , FUNCOP_1:37;
end;
thus L466: thesis by L458 , FUNCT_2:63;
end;
L467: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds (( R23 . (R22 , R17) ) = R22 implies ( R23 [:] (( [#] (R34 , R22) ) , R17) ) = ( [#] (( R23 [:] (R34 , R17) ) , R22) )))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R34 being (FinSequence of R5);
assume L468: ( R23 . (R22 , R17) ) = R22;
L469:
now
let C9 being (Element of ( NAT ));
L470: ( dom R34 ) = ( Seg ( len R34 ) ) by FINSEQ_1:def 3;
L471: (( len ( R23 [:] (R34 , R17) ) ) = ( len R34 ) & ( dom ( R23 [:] (R34 , R17) ) ) = ( Seg ( len ( R23 [:] (R34 , R17) ) ) )) by FINSEQ_1:def 3 , FINSEQ_2:84;
L472:
now
per cases ;
suppose L473: C9 in ( dom R34 );

thus L474: ( R23 . (( ( [#] (R34 , R22) ) . C9 ) , R17) ) = ( R23 . (( R34 . C9 ) , R17) ) by L473 , L380
.= ( ( R23 [:] (R34 , R17) ) . C9 ) by L471 , L470 , L473 , FUNCOP_1:27
.= ( ( [#] (( R23 [:] (R34 , R17) ) , R22) ) . C9 ) by L471 , L470 , L473 , L380;
end;
suppose L475: (not C9 in ( dom R34 ));

thus L476: ( R23 . (( ( [#] (R34 , R22) ) . C9 ) , R17) ) = ( R23 . (R22 , R17) ) by L475 , L380
.= ( ( [#] (( R23 [:] (R34 , R17) ) , R22) ) . C9 ) by L468 , L471 , L470 , L475 , L380;
end;
end;
thus L478: ( ( R23 [:] (( [#] (R34 , R22) ) , R17) ) . C9 ) = ( ( [#] (( R23 [:] (R34 , R17) ) , R22) ) . C9 ) by L472 , FUNCOP_1:48;
end;
thus L479: thesis by L469 , FUNCT_2:63;
end;
L480: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds (( R23 . (R17 , R22) ) = R22 implies ( R23 [;] (R17 , ( [#] (R34 , R22) )) ) = ( [#] (( R23 [;] (R17 , R34) ) , R22) )))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R34 being (FinSequence of R5);
assume L481: ( R23 . (R17 , R22) ) = R22;
L482:
now
let C10 being (Element of ( NAT ));
L483: ( dom R34 ) = ( Seg ( len R34 ) ) by FINSEQ_1:def 3;
L484: (( len ( R23 [;] (R17 , R34) ) ) = ( len R34 ) & ( dom ( R23 [;] (R17 , R34) ) ) = ( Seg ( len ( R23 [;] (R17 , R34) ) ) )) by FINSEQ_1:def 3 , FINSEQ_2:78;
L485:
now
per cases ;
suppose L486: C10 in ( dom R34 );

thus L487: ( R23 . (R17 , ( ( [#] (R34 , R22) ) . C10 )) ) = ( R23 . (R17 , ( R34 . C10 )) ) by L486 , L380
.= ( ( R23 [;] (R17 , R34) ) . C10 ) by L484 , L483 , L486 , FUNCOP_1:32
.= ( ( [#] (( R23 [;] (R17 , R34) ) , R22) ) . C10 ) by L484 , L483 , L486 , L380;
end;
suppose L488: (not C10 in ( dom R34 ));

thus L489: ( R23 . (R17 , ( ( [#] (R34 , R22) ) . C10 )) ) = ( R23 . (R17 , R22) ) by L488 , L380
.= ( ( [#] (( R23 [;] (R17 , R34) ) , R22) ) . C10 ) by L481 , L484 , L483 , L488 , L380;
end;
end;
thus L491: ( ( R23 [;] (R17 , ( [#] (R34 , R22) )) ) . C10 ) = ( ( [#] (( R23 [;] (R17 , R34) ) , R22) ) . C10 ) by L485 , FUNCOP_1:53;
end;
thus L492: thesis by L482 , FUNCT_2:63;
end;
notation
let C11 being Nat;
synonym finSeg C11 for Seg C11;
end;
definition
let C12 being Nat;
redefine func finSeg C12 -> (Element of ( Fin ( NAT ) ));

coherence by L1;
end;
notation
let R5 being non  empty set;
let R34 being (FinSequence of R5);
let R23 being (BinOp of R5);
synonym R23 $$ R34 for R23 "**" R34;
end;
definition
let R5 being non  empty set;
let R34 being (FinSequence of R5);
let R23 being (BinOp of R5);
assume L496: ((R23 is  having_a_unity or ( len R34 ) >= 1) & R23 is  associative  commutative);
redefine func R23 $$ R34 equals 
:L497: ( R23 $$ (( findom R34 ) , ( [#] (R34 , ( the_unity_wrt R23 )) )) );
compatibility by L496 , FINSOP_1:3;
end;
theorem
L499: (for R5 being non  empty set holds (for R23 being (BinOp of R5) holds (for R31 being Nat holds (R23 is  having_a_unity implies ( R23 "**" ( R31 |-> ( the_unity_wrt R23 ) ) ) = ( the_unity_wrt R23 )))))
proof
let R5 being non  empty set;
let R23 being (BinOp of R5);
let R31 being Nat;
set D24 = ( the_unity_wrt R23 );
defpred S9[ Nat ] means ( R23 "**" ( $1 |-> D24 ) ) = D24;
assume L500: R23 is  having_a_unity;
L501: (for R31 being Nat holds (S9[ R31 ] implies S9[ ( R31 + 1 ) ]))
proof
let R31 being Nat;
assume L502: ( R23 "**" ( R31 |-> D24 ) ) = D24;
thus L503: ( R23 "**" ( ( R31 + 1 ) |-> D24 ) ) = ( R23 "**" ( ( R31 |-> D24 ) ^ <* D24 *> ) ) by FINSEQ_2:60
.= ( R23 . (( R23 "**" ( R31 |-> D24 ) ) , D24) ) by L500 , FINSOP_1:4
.= D24 by L500 , L502 , SETWISEO:15;
end;
L504: ( R23 "**" ( ( 0 ) |-> D24 ) ) = ( R23 "**" ( <*> R5 ) )
.= D24 by L500 , FINSOP_1:10;
L505: S9[ ( 0 ) ] by L504;
L506: (for R31 being Nat holds S9[ R31 ]) from NAT_1:sch 2(L505 , L501);
thus L507: thesis by L506;
end;
theorem
L508: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R31 being Nat holds (for R32 being Nat holds ((R23 is  associative & ((R31 >= 1 & R32 >= 1) or R23 is  having_a_unity)) implies ( R23 "**" ( ( R31 + R32 ) |-> R17 ) ) = ( R23 . (( R23 "**" ( R31 |-> R17 ) ) , ( R23 "**" ( R32 |-> R17 ) )) )))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R23 being (BinOp of R5);
let R31 being Nat;
let R32 being Nat;
assume L509: R23 is  associative;
set D25 = ( R31 |-> R17 );
set D26 = ( R32 |-> R17 );
assume L510: ((R31 >= 1 & R32 >= 1) or R23 is  having_a_unity);
L511: ((( len D25 ) >= 1 & ( len D26 ) >= 1) or R23 is  having_a_unity) by L510 , CARD_1:def 7;
L512: ( R23 "**" ( D25 ^ D26 ) ) = ( R23 . (( R23 "**" D25 ) , ( R23 "**" D26 )) ) by L511 , L509 , FINSOP_1:5;
thus L513: thesis by L512 , FINSEQ_2:123;
end;
theorem
L514: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R31 being Nat holds (for R32 being Nat holds ((R23 is  commutative  associative & ((R31 >= 1 & R32 >= 1) or R23 is  having_a_unity)) implies ( R23 "**" ( ( R31 * R32 ) |-> R17 ) ) = ( R23 "**" ( R32 |-> ( R23 "**" ( R31 |-> R17 ) ) ) )))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R23 being (BinOp of R5);
let R31 being Nat;
let R32 being Nat;
assume that
L515: R23 is  commutative  associative
and
L516: ((R31 >= 1 & R32 >= 1) or R23 is  having_a_unity);
per cases  by NAT_1:3;
suppose L517: (R31 = ( 0 ) or R32 = ( 0 ));

set D27 = ( the_unity_wrt R23 );
L518:
now
per cases  by L517;
suppose L519: R31 = ( 0 );

L520: ( R31 |-> R17 ) = ( <*> R5 ) by L519;
L521: ( R23 "**" ( R31 |-> R17 ) ) = D27 by L520 , L516 , L517 , FINSOP_1:10;
thus L522: ( R23 "**" ( R32 |-> ( R23 "**" ( R31 |-> R17 ) ) ) ) = D27 by L521 , L516 , L517 , L499;
end;
suppose L523: R32 = ( 0 );

L524: ( R32 |-> ( R23 "**" ( R31 |-> R17 ) ) ) = ( <*> R5 ) by L523;
thus L525: ( R23 "**" ( R32 |-> ( R23 "**" ( R31 |-> R17 ) ) ) ) = D27 by L524 , L516 , L517 , FINSOP_1:10;
end;
end;
L527: ( ( R31 * R32 ) |-> R17 ) = ( <*> R5 ) by L517;
thus L528: thesis by L527 , L516 , L517 , L518 , FINSOP_1:10;
end;
suppose L529: (R31 > ( 0 ) & R32 > ( 0 ));

defpred S10[ Nat ] means ($1 <> ( 0 ) implies ( R23 "**" ( ( R31 * $1 ) |-> R17 ) ) = ( R23 "**" ( $1 |-> ( R23 "**" ( R31 |-> R17 ) ) ) ));
L530: (for R32 being Nat holds (S10[ R32 ] implies S10[ ( R32 + 1 ) ]))
proof
let R32 being Nat;
assume that
L531: (R32 <> ( 0 ) implies ( R23 "**" ( ( R31 * R32 ) |-> R17 ) ) = ( R23 "**" ( R32 |-> ( R23 "**" ( R31 |-> R17 ) ) ) ));
L532:
now
per cases  by NAT_1:14;
suppose L533: R32 = ( 0 );

L534: ( 1 |-> ( R23 "**" ( R31 |-> R17 ) ) ) = <* ( R23 "**" ( R31 |-> R17 ) ) *> by FINSEQ_2:59;
thus L535: thesis by L534 , L533 , FINSOP_1:11;
end;
suppose L536: R32 >= ( 1 + ( 0 ) );

L537: R32 > ( 0 ) by L536 , NAT_1:13;
L538: ( R31 * R32 ) > ( R31 * ( 0 ) ) by L537 , L529 , XREAL_1:68;
L539: ( R31 * R32 ) >= ( 1 + ( 0 ) ) by L538 , NAT_1:13;
L540: ( R23 "**" ( ( R31 * ( R32 + 1 ) ) |-> R17 ) ) = ( R23 "**" ( ( ( R31 * R32 ) + ( R31 * 1 ) ) |-> R17 ) )
.= ( R23 . (( R23 "**" ( ( R31 * R32 ) |-> R17 ) ) , ( R23 "**" ( R31 |-> R17 ) )) ) by L515 , L516 , L539 , L508
.= ( R23 . (( R23 "**" ( ( R31 * R32 ) |-> R17 ) ) , ( R23 "**" ( 1 |-> ( R23 "**" ( R31 |-> R17 ) ) ) )) ) by FINSOP_1:16
.= ( R23 "**" ( ( R32 + 1 ) |-> ( R23 "**" ( R31 |-> R17 ) ) ) ) by L515 , L531 , L536 , L508;
thus L541: thesis by L540;
end;
end;
thus L543: thesis by L532;
end;
L544: S10[ ( 0 ) ];
L545: (for R32 being Nat holds S10[ R32 ]) from NAT_1:sch 2(L544 , L530);
thus L546: thesis by L545 , L529;
end;
end;
theorem
L548: (for R5 being non  empty set holds (for R6 being non  empty set holds (for R23 being (BinOp of R5) holds (for R29 being (BinOp of R6) holds (for R30 being (Function of R5 , R6) holds (for R34 being (FinSequence of R5) holds ((R23 is  having_a_unity & R29 is  having_a_unity & ( R30 . ( the_unity_wrt R23 ) ) = ( the_unity_wrt R29 ) & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( R30 . ( R23 . (R18 , R19) ) ) = ( R29 . (( R30 . R18 ) , ( R30 . R19 )) )))) implies ( R30 . ( R23 "**" R34 ) ) = ( R29 "**" ( R30 * R34 ) ))))))))
proof
let R5 being non  empty set;
let R6 being non  empty set;
let R23 being (BinOp of R5);
let R29 being (BinOp of R6);
let R30 being (Function of R5 , R6);
let R34 being (FinSequence of R5);
assume that
L549: R23 is  having_a_unity
and
L550: R29 is  having_a_unity
and
L551: ( R30 . ( the_unity_wrt R23 ) ) = ( the_unity_wrt R29 )
and
L552: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( R30 . ( R23 . (R18 , R19) ) ) = ( R29 . (( R30 . R18 ) , ( R30 . R19 )) )));
defpred S11[ (FinSequence of R5) ] means ( R30 . ( R23 "**" $1 ) ) = ( R29 "**" ( R30 * $1 ) );
L553: (for R35 being (FinSequence of R5) holds (for R17 being (Element of R5) holds (S11[ R35 ] implies S11[ ( R35 ^ <* R17 *> ) ])))
proof
let R35 being (FinSequence of R5);
let R17 being (Element of R5);
assume that
L554: ( R30 . ( R23 "**" R35 ) ) = ( R29 "**" ( R30 * R35 ) );
thus L555: ( R30 . ( R23 "**" ( R35 ^ <* R17 *> ) ) ) = ( R30 . ( R23 . (( R23 "**" R35 ) , R17) ) ) by L549 , FINSOP_1:4
.= ( R29 . (( R29 "**" ( R30 * R35 ) ) , ( R30 . R17 )) ) by L552 , L554
.= ( R29 "**" ( ( R30 * R35 ) ^ <* ( R30 . R17 ) *> ) ) by L550 , FINSOP_1:4
.= ( R29 "**" ( R30 * ( R35 ^ <* R17 *> ) ) ) by FINSEQOP:8;
end;
L556: ( R30 . ( R23 "**" ( <*> R5 ) ) ) = ( R30 . ( the_unity_wrt R23 ) ) by L549 , FINSOP_1:10
.= ( R29 "**" ( <*> R6 ) ) by L550 , L551 , FINSOP_1:10
.= ( R29 "**" ( R30 * ( <*> R5 ) ) );
L557: S11[ ( <*> R5 ) ] by L556;
L558: (for R35 being (FinSequence of R5) holds S11[ R35 ]) from FINSEQ_2:sch 2(L557 , L553);
thus L559: thesis by L558;
end;
theorem
L560: (for R5 being non  empty set holds (for R23 being (BinOp of R5) holds (for R25 being (UnOp of R5) holds (for R34 being (FinSequence of R5) holds ((R23 is  having_a_unity & ( R25 . ( the_unity_wrt R23 ) ) = ( the_unity_wrt R23 ) & R25 is_distributive_wrt R23) implies ( R25 . ( R23 "**" R34 ) ) = ( R23 "**" ( R25 * R34 ) ))))))
proof
let R5 being non  empty set;
let R23 being (BinOp of R5);
let R25 being (UnOp of R5);
let R34 being (FinSequence of R5);
assume L561: (R23 is  having_a_unity & ( R25 . ( the_unity_wrt R23 ) ) = ( the_unity_wrt R23 ));
assume L562: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( R25 . ( R23 . (R18 , R19) ) ) = ( R23 . (( R25 . R18 ) , ( R25 . R19 )) )));
thus L563: thesis by L562 , L561 , L548;
end;
theorem
L564: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds ((R23 is  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp & R24 is_distributive_wrt R23) implies ( ( R24 [;] (R17 , ( id R5 )) ) . ( R23 "**" R34 ) ) = ( R23 "**" ( ( R24 [;] (R17 , ( id R5 )) ) * R34 ) )))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R34 being (FinSequence of R5);
assume that
L565: R23 is  associative
and
L566: R23 is  having_a_unity
and
L567: R23 is  having_an_inverseOp
and
L568: R24 is_distributive_wrt R23;
set D28 = ( the_unity_wrt R23 );
set D29 = ( R24 [;] (R17 , ( id R5 )) );
L569: D29 is_distributive_wrt R23 by L568 , FINSEQOP:54;
L570: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( D29 . ( R23 . (R18 , R19) ) ) = ( R23 . (( D29 . R18 ) , ( D29 . R19 )) ))) by L569 , BINOP_1:def 12;
L571: ( ( R24 [;] (R17 , ( id R5 )) ) . D28 ) = D28 by L565 , L566 , L567 , L568 , FINSEQOP:69;
thus L572: thesis by L571 , L566 , L570 , L548;
end;
theorem
L573: (for R5 being non  empty set holds (for R23 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp) implies ( ( the_inverseOp_wrt R23 ) . ( R23 "**" R34 ) ) = ( R23 "**" ( ( the_inverseOp_wrt R23 ) * R34 ) )))))
proof
let R5 being non  empty set;
let R23 being (BinOp of R5);
let R34 being (FinSequence of R5);
assume that
L574: R23 is  commutative  associative
and
L575: R23 is  having_a_unity
and
L576: R23 is  having_an_inverseOp;
set D30 = ( the_unity_wrt R23 );
set D31 = ( the_inverseOp_wrt R23 );
L577: D31 is_distributive_wrt R23 by L574 , L575 , L576 , FINSEQOP:63;
L578: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds ( D31 . ( R23 . (R18 , R19) ) ) = ( R23 . (( D31 . R18 ) , ( D31 . R19 )) ))) by L577 , BINOP_1:def 12;
L579: ( D31 . D30 ) = D30 by L574 , L575 , L576 , FINSEQOP:61;
thus L580: thesis by L579 , L575 , L578 , L548;
end;
theorem
L581: (for R5 being non  empty set holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds (for R35 being (FinSequence of R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ) & ( R24 . (R22 , R22) ) = R22 & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R24 . (R18 , R19) ) , ( R24 . (R20 , R21) )) ) = ( R24 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) ))))) & ( len R34 ) = ( len R35 )) implies ( R24 . (( R23 "**" R34 ) , ( R23 "**" R35 )) ) = ( R23 "**" ( R24 .: (R34 , R35) ) ))))))))
proof
let R5 being non  empty set;
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R34 being (FinSequence of R5);
let R35 being (FinSequence of R5);
assume that
L582: (R23 is  commutative & R23 is  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ))
and
L583: ( R24 . (R22 , R22) ) = R22
and
L584: (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R24 . (R18 , R19) ) , ( R24 . (R20 , R21) )) ) = ( R24 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) )))))
and
L585: ( len R34 ) = ( len R35 );
L586: ( len R34 ) = ( len ( R24 .: (R34 , R35) ) ) by L585 , FINSEQ_2:72;
L587: ( dom ( R24 .: (R34 , R35) ) ) = ( Seg ( len ( R24 .: (R34 , R35) ) ) ) by FINSEQ_1:def 3;
L588: ( dom R35 ) = ( Seg ( len R35 ) ) by FINSEQ_1:def 3;
L589: ( dom R34 ) = ( Seg ( len R34 ) ) by FINSEQ_1:def 3;
thus L590: ( R24 . (( R23 "**" R34 ) , ( R23 "**" R35 )) ) = ( R24 . (( R23 $$ (( findom R34 ) , ( [#] (R34 , R22) )) ) , ( R23 "**" R35 )) ) by L582 , L497
.= ( R24 . (( R23 $$ (( findom R34 ) , ( [#] (R34 , R22) )) ) , ( R23 $$ (( findom R35 ) , ( [#] (R35 , R22) )) )) ) by L582 , L497
.= ( R23 $$ (( findom R34 ) , ( R24 .: (( [#] (R34 , R22) ) , ( [#] (R35 , R22) )) )) ) by L582 , L583 , L584 , L585 , L589 , L588 , L282
.= ( R23 $$ (( findom ( R24 .: (R34 , R35) ) ) , ( [#] (( R24 .: (R34 , R35) ) , R22) )) ) by L583 , L585 , L586 , L589 , L587 , L451
.= ( R23 "**" ( R24 .: (R34 , R35) ) ) by L582 , L497;
end;
theorem
L591: (for R5 being non  empty set holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R31 being Nat holds (for R36 being (Element of ( R31 -tuples_on R5 )) holds (for R37 being (Element of ( R31 -tuples_on R5 )) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ) & ( R24 . (R22 , R22) ) = R22 & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R24 . (R18 , R19) ) , ( R24 . (R20 , R21) )) ) = ( R24 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) )))))) implies ( R24 . (( R23 "**" R36 ) , ( R23 "**" R37 )) ) = ( R23 "**" ( R24 .: (R36 , R37) ) )))))))))
proof
let R5 being non  empty set;
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R31 being Nat;
let R36 being (Element of ( R31 -tuples_on R5 ));
let R37 being (Element of ( R31 -tuples_on R5 ));
L592: (( len R36 ) = R31 & ( len R37 ) = R31) by CARD_1:def 7;
thus L593: thesis by L592 , L581;
end;
theorem
L594: (for R5 being non  empty set holds (for R23 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds (for R35 being (FinSequence of R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & ( len R34 ) = ( len R35 )) implies ( R23 . (( R23 "**" R34 ) , ( R23 "**" R35 )) ) = ( R23 "**" ( R23 .: (R34 , R35) ) ))))))
proof
let R5 being non  empty set;
let R23 being (BinOp of R5);
let R34 being (FinSequence of R5);
let R35 being (FinSequence of R5);
set D32 = ( the_unity_wrt R23 );
assume L595: (R23 is  commutative & R23 is  associative & R23 is  having_a_unity);
L596: (( R23 . (D32 , D32) ) = D32 & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R23 . (R18 , R19) ) , ( R23 . (R20 , R21) )) ) = ( R23 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) )))))) by L595 , L296 , SETWISEO:15;
thus L597: thesis by L596 , L595 , L581;
end;
theorem
L598: (for R5 being non  empty set holds (for R23 being (BinOp of R5) holds (for R31 being Nat holds (for R36 being (Element of ( R31 -tuples_on R5 )) holds (for R37 being (Element of ( R31 -tuples_on R5 )) holds ((R23 is  commutative  associative & R23 is  having_a_unity) implies ( R23 . (( R23 "**" R36 ) , ( R23 "**" R37 )) ) = ( R23 "**" ( R23 .: (R36 , R37) ) )))))))
proof
let R5 being non  empty set;
let R23 being (BinOp of R5);
let R31 being Nat;
let R36 being (Element of ( R31 -tuples_on R5 ));
let R37 being (Element of ( R31 -tuples_on R5 ));
L599: (( len R36 ) = R31 & ( len R37 ) = R31) by CARD_1:def 7;
thus L600: thesis by L599 , L594;
end;
theorem
L601: (for R5 being non  empty set holds (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R31 being Nat holds ((R23 is  commutative  associative & R23 is  having_a_unity) implies ( R23 "**" ( R31 |-> ( R23 . (R18 , R19) ) ) ) = ( R23 . (( R23 "**" ( R31 |-> R18 ) ) , ( R23 "**" ( R31 |-> R19 ) )) )))))))
proof
let R5 being non  empty set;
let R18 being (Element of R5);
let R19 being (Element of R5);
let R23 being (BinOp of R5);
let R31 being Nat;
reconsider D33 = ( R31 |-> R18 ) , D34 = ( R31 |-> R19 ) as (Element of ( R31 -tuples_on R5 ));
L602: ( R31 |-> ( R23 . (R18 , R19) ) ) = ( R23 .: (D33 , D34) ) by FINSEQOP:17;
thus L603: thesis by L602 , L598;
end;
theorem
L604: (for R5 being non  empty set holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R31 being Nat holds (for R36 being (Element of ( R31 -tuples_on R5 )) holds (for R37 being (Element of ( R31 -tuples_on R5 )) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp & R24 = ( R23 * (( id R5 ) , ( the_inverseOp_wrt R23 )) )) implies ( R24 . (( R23 "**" R36 ) , ( R23 "**" R37 )) ) = ( R23 "**" ( R24 .: (R36 , R37) ) ))))))))
proof
let R5 being non  empty set;
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R31 being Nat;
let R36 being (Element of ( R31 -tuples_on R5 ));
let R37 being (Element of ( R31 -tuples_on R5 ));
assume that
L605: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L606: (R23 is  having_an_inverseOp & R24 = ( R23 * (( id R5 ) , ( the_inverseOp_wrt R23 )) ));
set D35 = ( the_unity_wrt R23 );
L607: (( R24 . (D35 , D35) ) = D35 & (for R18 being (Element of R5) holds (for R19 being (Element of R5) holds (for R20 being (Element of R5) holds (for R21 being (Element of R5) holds ( R23 . (( R24 . (R18 , R19) ) , ( R24 . (R20 , R21) )) ) = ( R24 . (( R23 . (R18 , R20) ) , ( R23 . (R19 , R21) )) )))))) by L605 , L606 , FINSEQOP:86 , FINSEQOP:89;
thus L608: thesis by L607 , L605 , L591;
end;
theorem
L609: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ) & R24 is_distributive_wrt R23 & ( R24 . (R17 , R22) ) = R22) implies ( R24 . (R17 , ( R23 "**" R34 )) ) = ( R23 "**" ( R24 [;] (R17 , R34) ) ))))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R34 being (FinSequence of R5);
assume that
L610: (R23 is  commutative & R23 is  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ))
and
L611: R24 is_distributive_wrt R23
and
L612: ( R24 . (R17 , R22) ) = R22;
L613: (( len R34 ) = ( len ( R24 [;] (R17 , R34) ) ) & ( Seg ( len R34 ) ) = ( dom R34 )) by FINSEQ_1:def 3 , FINSEQ_2:78;
L614: ( Seg ( len ( R24 [;] (R17 , R34) ) ) ) = ( dom ( R24 [;] (R17 , R34) ) ) by FINSEQ_1:def 3;
thus L615: ( R24 . (R17 , ( R23 "**" R34 )) ) = ( R24 . (R17 , ( R23 $$ (( findom R34 ) , ( [#] (R34 , R22) )) )) ) by L610 , L497
.= ( R23 $$ (( findom R34 ) , ( R24 [;] (R17 , ( [#] (R34 , R22) )) )) ) by L610 , L611 , L612 , L309
.= ( R23 $$ (( findom R34 ) , ( [#] (( R24 [;] (R17 , R34) ) , R22) )) ) by L612 , L480
.= ( R23 "**" ( R24 [;] (R17 , R34) ) ) by L610 , L613 , L614 , L497;
end;
theorem
L616: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R22 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ) & R24 is_distributive_wrt R23 & ( R24 . (R22 , R17) ) = R22) implies ( R24 . (( R23 "**" R34 ) , R17) ) = ( R23 "**" ( R24 [:] (R34 , R17) ) ))))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R22 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R34 being (FinSequence of R5);
assume that
L617: (R23 is  commutative  associative & R23 is  having_a_unity & R22 = ( the_unity_wrt R23 ))
and
L618: R24 is_distributive_wrt R23
and
L619: ( R24 . (R22 , R17) ) = R22;
L620: (( len R34 ) = ( len ( R24 [:] (R34 , R17) ) ) & ( Seg ( len R34 ) ) = ( dom R34 )) by FINSEQ_1:def 3 , FINSEQ_2:84;
L621: ( Seg ( len ( R24 [:] (R34 , R17) ) ) ) = ( dom ( R24 [:] (R34 , R17) ) ) by FINSEQ_1:def 3;
thus L622: ( R24 . (( R23 "**" R34 ) , R17) ) = ( R24 . (( R23 $$ (( findom R34 ) , ( [#] (R34 , R22) )) ) , R17) ) by L617 , L497
.= ( R23 $$ (( findom R34 ) , ( R24 [:] (( [#] (R34 , R22) ) , R17) )) ) by L617 , L618 , L619 , L322
.= ( R23 $$ (( findom R34 ) , ( [#] (( R24 [:] (R34 , R17) ) , R22) )) ) by L619 , L467
.= ( R23 "**" ( R24 [:] (R34 , R17) ) ) by L617 , L620 , L621 , L497;
end;
theorem
L623: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp & R24 is_distributive_wrt R23) implies ( R24 . (R17 , ( R23 "**" R34 )) ) = ( R23 "**" ( R24 [;] (R17 , R34) ) )))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R34 being (FinSequence of R5);
assume that
L624: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L625: R23 is  having_an_inverseOp
and
L626: R24 is_distributive_wrt R23;
set D36 = ( the_unity_wrt R23 );
L627: ( R24 . (R17 , D36) ) = D36 by L624 , L625 , L626 , FINSEQOP:66;
thus L628: thesis by L627 , L624 , L626 , L609;
end;
theorem
L629: (for R5 being non  empty set holds (for R17 being (Element of R5) holds (for R23 being (BinOp of R5) holds (for R24 being (BinOp of R5) holds (for R34 being (FinSequence of R5) holds ((R23 is  commutative  associative & R23 is  having_a_unity & R23 is  having_an_inverseOp & R24 is_distributive_wrt R23) implies ( R24 . (( R23 "**" R34 ) , R17) ) = ( R23 "**" ( R24 [:] (R34 , R17) ) )))))))
proof
let R5 being non  empty set;
let R17 being (Element of R5);
let R23 being (BinOp of R5);
let R24 being (BinOp of R5);
let R34 being (FinSequence of R5);
assume that
L630: (R23 is  commutative  associative & R23 is  having_a_unity)
and
L631: R23 is  having_an_inverseOp
and
L632: R24 is_distributive_wrt R23;
set D37 = ( the_unity_wrt R23 );
L633: ( R24 . (D37 , R17) ) = D37 by L630 , L631 , L632 , FINSEQOP:66;
thus L634: thesis by L633 , L630 , L632 , L616;
end;
