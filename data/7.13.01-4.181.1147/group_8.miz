:: Properties of Groups
::  by Gijs Geleijnse and Grzegorz Bancerek
::
:: Received May 31, 2004
:: Copyright (c) 2004-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, STRUCT_0, GROUP_1, SUBSET_1, GROUP_2, FINSET_1, INT_2,
      CARD_1, GRAPH_1, RELAT_1, TARSKI, ALGSTR_0, ZFMISC_1, PBOOLE, REALSET1,
      NEWTON, INT_1, ARYTM_3, GROUP_4, ARYTM_1, NAT_1, FINSEQ_1, FUNCT_1,
      XXREAL_0, CQC_SIM1, XBOOLE_0, SETFAM_1, GROUP_8;
 notations XBOOLE_0, CARD_1, TARSKI, ZFMISC_1, SUBSET_1, ORDINAL1, NUMBERS,
      XCMPLX_0, XXREAL_0, RELAT_1, REALSET1, FUNCT_1, FUNCT_2, PBOOLE, INT_1,
      NAT_1, FINSET_1, GROUP_2, GROUP_4, GR_CY_1, FINSEQ_1, DOMAIN_1, STRUCT_0,
      ALGSTR_0, GROUP_1, INT_2;
 constructors WELLORD2, BINOP_1, REAL_1, NAT_D, BINOP_2, REALSET2, GROUP_4,
      GR_CY_1, RELSET_1;
 registrations XBOOLE_0, SUBSET_1, RELSET_1, XXREAL_0, XREAL_0, NAT_1, INT_1,
      FINSEQ_1, STRUCT_0, GROUP_1, GROUP_2, GR_CY_1, ORDINAL1, FINSET_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, FUNCT_1, WELLORD2, REALSET1, STRUCT_0, ALGSTR_0;
 theorems GROUP_2, GR_CY_1, GR_CY_2, NAT_1, TARSKI, XBOOLE_0, GROUP_1, CARD_1,
      GROUP_6, ALTCAT_1, FUNCT_2, GROUP_4, INT_2, XCMPLX_1, INT_1, FINSEQ_1,
      FUNCT_1, NEWTON, ORDINAL1, NAT_D, STRUCT_0, XXREAL_0, RELAT_1, PARTFUN1;
 schemes SUBSET_1, NAT_1, FINSEQ_1, FUNCT_2;

begin
theorem
L1: (for R9 being (Element of ( NAT )) holds (for B1 being  strict  finite Group holds ((R9 is  prime & ( card B1 ) = R9) implies (ex B2 being (Element of B1) st ( ord B2 ) = R9))))
proof
let R9 being (Element of ( NAT ));
let C1 being  strict  finite Group;
assume that
L2: R9 is  prime
and
L3: ( card C1 ) = R9;
L4: C1 is  cyclic  cyclic  cyclic  cyclic Group by L2 , L3 , GR_CY_1:21;
thus L5: thesis by L4 , L3 , GR_CY_1:19;
end;
theorem
L6: (for B3 being Group holds (for B4 being (Subgroup of B3) holds (for B5 , B6 being (Element of B4) holds (for B7 , B8 being (Element of B3) holds ((B5 = B7 & B6 = B8) implies ( B5 * B6 ) = ( B7 * B8 ))))))
proof
let C2 being Group;
let C3 being (Subgroup of C2);
let C4 , C5 being (Element of C3);
L7: (the carrier of C3) c= (the carrier of C2) by GROUP_2:def 5;
let C6 , C7 being (Element of C2);
assume that
L8: C4 = C6
and
L9: C5 = C7;
L10: ( dom (the multF of C2) ) = [: (the carrier of C2) , (the carrier of C2) :] by FUNCT_2:def 1;
L11: (the multF of C2) is (ManySortedSet of [: (the carrier of C2) , (the carrier of C2) :]) by L10 , PARTFUN1:def 2;
L12: (the multF of C3) = ( (the multF of C2) || (the carrier of C3) ) by GROUP_2:def 5;
thus L13: thesis by L12 , L7 , L8 , L9 , L11 , ALTCAT_1:5;
end;
theorem
L14: (for B9 being Group holds (for B10 being (Subgroup of B9) holds (for B11 being (Element of B10) holds (for B12 being (Element of B9) holds (B11 = B12 implies (for B13 being (Element of ( NAT )) holds ( B11 |^ B13 ) = ( B12 |^ B13 ))))))) by GROUP_4:1;
theorem
L15: (for B14 being Group holds (for B15 being (Subgroup of B14) holds (for B16 being (Element of B15) holds (for B17 being (Element of B14) holds (B16 = B17 implies (for B18 being Integer holds ( B16 |^ B18 ) = ( B17 |^ B18 ))))))) by GROUP_4:2;
theorem
L16: (for B19 being Group holds (for B20 being (Subgroup of B19) holds (for B21 being (Element of B20) holds (for B22 being (Element of B19) holds ((B21 = B22 & B19 is  finite) implies ( ord B21 ) = ( ord B22 ))))))
proof
let C8 being Group;
let C9 being (Subgroup of C8);
let C10 being (Element of C9);
let C11 being (Element of C8);
assume that
L17: C10 = C11
and
L18: C8 is  finite;
L19: (not C10 is  being_of_order_0) by L18 , GR_CY_1:6;
L20: (not C11 is  being_of_order_0) by L18 , GR_CY_1:6;
L21: ( C10 |^ ( ord C10 ) ) = ( 1_ C9 ) by L19 , GROUP_1:def 11;
L22: ( C11 |^ ( ord C11 ) ) = ( 1_ C8 ) by L20 , GROUP_1:def 11;
L23: ( C10 |^ ( ord C10 ) ) = ( C11 |^ ( ord C10 ) ) by L17 , GROUP_4:1;
L24: ( ord C11 ) divides ( ord C10 ) by L23 , L21 , L22 , GROUP_1:44 , GROUP_2:44;
L25: ( C10 |^ ( ord C11 ) ) = ( 1_ C8 ) by L17 , L22 , GROUP_4:1;
L26: ( C10 |^ ( ord C11 ) ) = ( 1_ C9 ) by L25 , GROUP_2:44;
L27: ( ord C10 ) divides ( ord C11 ) by L26 , GROUP_1:44;
thus L28: thesis by L27 , L24 , NAT_D:5;
end;
theorem
L29: (for B23 being Group holds (for B24 being (Subgroup of B23) holds (for B25 being (Element of B23) holds (B25 in B24 implies ( B24 * B25 ) c= (the carrier of B24)))))
proof
let C12 being Group;
let C13 being (Subgroup of C12);
let C14 being (Element of C12);
assume that
L30: C14 in C13;
L31: (for B26 being set holds (B26 in ( C13 * C14 ) implies B26 in (the carrier of C13)))
proof
let C15 being set;
assume L32: C15 in ( C13 * C14 );
consider C16 being (Element of C12) such that L33: C15 = ( C16 * C14 ) and L34: C16 in C13 by L32 , GROUP_2:104;
L35: ( C16 * C14 ) in C13 by L30 , L34 , GROUP_2:50;
thus L36: thesis by L35 , L33 , STRUCT_0:def 5;
end;
thus L37: thesis by L31 , TARSKI:def 3;
end;
theorem
L38: (for B27 being Group holds (for B28 being (Element of B27) holds (B28 <> ( 1_ B27 ) implies ( gr { B28 } ) <> ( (1). B27 ))))
proof
let C17 being Group;
let C18 being (Element of C17);
assume that
L39: C18 <> ( 1_ C17 );
assume L40: ( gr { C18 } ) = ( (1). C17 );
L41: (the carrier of ( (1). C17 )) = { ( 1_ C17 ) } by GROUP_2:def 7;
L42: { C18 } c= (the carrier of ( gr { C18 } )) by GROUP_4:def 4;
L43: (for B29 being set holds (B29 = C18 implies B29 = ( 1_ C17 )))
proof
let C19 being set;
assume L44: C19 = C18;
L45: C19 in { C18 } by L44 , TARSKI:def 1;
thus L46: thesis by L45 , L40 , L41 , L42 , TARSKI:def 1;
end;
thus L47: thesis by L43 , L39;
end;
theorem
L48: (for B30 being Group holds (for B31 being Integer holds ( ( 1_ B30 ) |^ B31 ) = ( 1_ B30 ))) by GROUP_1:31;
theorem
L49: (for R1 being  strict Group holds (for R2 being (Element of R1) holds (for B32 being Integer holds ( R2 |^ ( B32 * ( ord R2 ) ) ) = ( 1_ R1 ))))
proof
let R1 being  strict Group;
let R2 being (Element of R1);
let C20 being Integer;
per cases ;
suppose L50: R2 is  being_of_order_0;

L51: ( ord R2 ) = ( 0 ) by L50 , GROUP_1:def 11;
thus L52: thesis by L51 , GROUP_1:25;
end;
suppose L53: (not R2 is  being_of_order_0);

L54: ( R2 |^ ( ord R2 ) ) = ( 1_ R1 ) by L53 , GROUP_1:def 11;
L55: ( ( 1_ R1 ) |^ C20 ) = ( 1_ R1 ) by GROUP_1:31;
thus L56: thesis by L55 , L54 , GROUP_1:35;
end;
end;
theorem
L58: (for R1 being  strict Group holds (for R2 being (Element of R1) holds ((not R2 is  being_of_order_0) implies (for B33 being Integer holds ( R2 |^ B33 ) = ( R2 |^ ( B33 mod ( ord R2 ) ) )))))
proof
let R1 being  strict Group;
let R2 being (Element of R1);
assume that
L59: (not R2 is  being_of_order_0);
let C21 being Integer;
L60: ( ord R2 ) <> ( 0 ) by L59 , GROUP_1:def 11;
L61: ( C21 mod ( ord R2 ) ) = ( C21 - ( ( C21 div ( ord R2 ) ) * ( ord R2 ) ) ) by L60 , INT_1:def 10;
L62: ( R2 |^ ( C21 mod ( ord R2 ) ) ) = ( R2 |^ ( C21 + ( - ( ( 1 * ( C21 div ( ord R2 ) ) ) * ( ord R2 ) ) ) ) ) by L61
.= ( ( R2 |^ C21 ) * ( R2 |^ ( ( - ( C21 div ( ord R2 ) ) ) * ( ord R2 ) ) ) ) by GROUP_1:33
.= ( ( R2 |^ C21 ) * ( 1_ R1 ) ) by L49
.= ( R2 |^ C21 ) by GROUP_1:def 4;
thus L63: thesis by L62;
end;
theorem
L64: (for R1 being  strict Group holds (for R3 being (Element of R1) holds ((not R3 is  being_of_order_0) implies ( gr { R3 } ) is  finite)))
proof
let R1 being  strict Group;
let R3 being (Element of R1);
assume L65: (not R3 is  being_of_order_0);
L66: ( ord R3 ) <> ( 0 ) by L65 , GROUP_1:def 11;
deffunc H1(Nat) = ( R3 |^ $1 );
consider C22 being FinSequence such that L67: (( len C22 ) = ( ord R3 ) & (for B34 being Nat holds (B34 in ( dom C22 ) implies ( C22 . B34 ) = H1(B34)))) from FINSEQ_1:sch 2;
L68: ( dom C22 ) = ( Seg ( ord R3 ) ) by L67 , FINSEQ_1:def 3;
L69: (the carrier of ( gr { R3 } )) c= ( rng C22 )
proof
let C23 being set;
assume L70: C23 in (the carrier of ( gr { R3 } ));
L71: C23 in ( gr { R3 } ) by L70 , STRUCT_0:def 5;
L72: C23 in R1 by L71 , GROUP_2:40;
reconsider D1 = C23 as (Element of R1) by L72 , STRUCT_0:def 5;
consider C24 being Integer such that L73: D1 = ( R3 |^ C24 ) by L71 , GR_CY_1:5;
set D2 = ( C24 mod ( ord R3 ) );
reconsider D3 = D2 as (Element of ( NAT )) by INT_1:3 , NEWTON:64;
L74: D1 = ( R3 |^ D3 ) by L65 , L73 , L58;
per cases ;
suppose L75: D3 = ( 0 );

L76: ( ord R3 ) >= ( ( 0 ) + 1 ) by L66 , NAT_1:13;
L77: ( ord R3 ) in ( Seg ( ord R3 ) ) by L76 , FINSEQ_1:1;
L78: D1 = ( 1_ R1 ) by L74 , L75 , GROUP_1:25
.= ( R3 |^ ( ord R3 ) ) by L65 , GROUP_1:def 11
.= ( C22 . ( ord R3 ) ) by L67 , L68 , L77;
thus L79: thesis by L78 , L68 , L77 , FUNCT_1:def 3;
end;
suppose L80: D3 <> ( 0 );

L81: D3 < ( ord R3 ) by L66 , NEWTON:65;
L82: D3 >= ( ( 0 ) + 1 ) by L80 , NAT_1:13;
L83: D3 in ( Seg ( ord R3 ) ) by L82 , L81 , FINSEQ_1:1;
L84: D1 = ( C22 . D3 ) by L83 , L67 , L68 , L74;
thus L85: thesis by L84 , L68 , L83 , FUNCT_1:def 3;
end;
end;
thus L87: (the carrier of ( gr { R3 } )) is  finite by L69;
end;
theorem
L88: (for R1 being  strict Group holds (for R3 being (Element of R1) holds (R3 is  being_of_order_0 implies ( R3 " ) is  being_of_order_0)))
proof
let R1 being  strict Group;
let R3 being (Element of R1);
assume L89: R3 is  being_of_order_0;
L90: (for B35 being Nat holds (( ( R3 " ) |^ B35 ) = ( 1_ R1 ) implies B35 = ( 0 )))
proof
let C25 being Nat;
assume L91: ( ( R3 " ) |^ C25 ) = ( 1_ R1 );
L92: ( ( R3 |^ C25 ) " ) = ( 1_ R1 ) by L91 , GROUP_1:37;
L93: ( ( R3 |^ C25 ) " ) = ( ( 1_ R1 ) " ) by L92 , GROUP_1:8;
L94: ( R3 |^ C25 ) = ( 1_ R1 ) by L93 , GROUP_1:9;
thus L95: thesis by L94 , L89 , GROUP_1:def 10;
end;
thus L96: thesis by L90 , GROUP_1:def 10;
end;
theorem
L97: (for R1 being  strict Group holds (for R3 being (Element of R1) holds (R3 is  being_of_order_0 iff (for B36 being Integer holds (( R3 |^ B36 ) = ( 1_ R1 ) implies B36 = ( 0 ))))))
proof
let R1 being  strict Group;
let R3 being (Element of R1);
thus L98: (R3 is  being_of_order_0 implies (for B37 being Integer holds (( R3 |^ B37 ) = ( 1_ R1 ) implies B37 = ( 0 ))))
proof
assume L99: R3 is  being_of_order_0;
L100: (for B38 being (Element of ( NAT )) holds (( R3 |^ ( - B38 ) ) = ( 1_ R1 ) implies B38 = ( 0 )))
proof
let C26 being (Element of ( NAT ));
assume L101: ( R3 |^ ( - C26 ) ) = ( 1_ R1 );
L102: ( R3 |^ ( - C26 ) ) = ( ( R3 |^ C26 ) " ) by GROUP_1:36;
L103: ( ( R3 " ) |^ C26 ) = ( 1_ R1 ) by L102 , L101 , GROUP_1:37;
L104: ( R3 " ) is  being_of_order_0 by L99 , L88;
thus L105: thesis by L104 , L103 , GROUP_1:def 10;
end;
L106: (for B39 being Integer holds (( R3 |^ B39 ) = ( 1_ R1 ) implies B39 = ( 0 )))
proof
let C27 being Integer;
assume L107: ( R3 |^ C27 ) = ( 1_ R1 );
consider C28 being (Element of ( NAT )) such that L108: (C27 = C28 or C27 = ( - C28 )) by INT_1:2;
per cases  by L108;
suppose L109: C27 = C28;

thus L110: thesis by L109 , L99 , L107 , GROUP_1:def 10;
end;
suppose L111: C27 = ( - C28 );

L112: C28 = ( 0 ) by L111 , L100 , L107;
thus L113: thesis by L112 , L111;
end;
end;
thus L115: thesis by L106;
end;

assume L116: (for B40 being Integer holds (( R3 |^ B40 ) = ( 1_ R1 ) implies B40 = ( 0 )));
L117: (for B41 being Nat holds (( R3 |^ B41 ) = ( 1_ R1 ) implies B41 = ( 0 ))) by L116;
thus L118: thesis by L117 , GROUP_1:def 10;
end;
theorem
L119: (for R1 being  strict Group holds ((ex R2 being (Element of R1) st R2 <> ( 1_ R1 )) implies ((for R7 being  strict (Subgroup of R1) holds (R7 = R1 or R7 = ( (1). R1 ))) iff (R1 is  cyclic & R1 is  finite & (ex B42 being (Element of ( NAT )) st (( card R1 ) = B42 & B42 is  prime))))))
proof
let R1 being  strict Group;
assume that
L120: (ex R2 being (Element of R1) st R2 <> ( 1_ R1 ));
thus L121: ((for R7 being  strict (Subgroup of R1) holds (R7 = R1 or R7 = ( (1). R1 ))) implies (R1 is  cyclic & R1 is  finite & (ex B43 being (Element of ( NAT )) st (( card R1 ) = B43 & B43 is  prime))))
proof
assume L122: (for R7 being  strict (Subgroup of R1) holds (R7 = R1 or R7 = ( (1). R1 )));
consider R3 being (Element of R1) such that L123: R3 <> ( 1_ R1 ) by L120;
L124: ( gr { R3 } ) = R1 by L122 , L123 , L38;
L125: (not R3 is  being_of_order_0)
proof
assume L126: R3 is  being_of_order_0;
L127: ( R3 |^ 2 ) <> ( 1_ R1 ) by L126 , GROUP_1:def 10;
L128: (not R3 in ( gr { ( R3 |^ 2 ) } ))
proof
assume L129: R3 in ( gr { ( R3 |^ 2 ) } );
consider C29 being Integer such that L130: R3 = ( ( R3 |^ 2 ) |^ C29 ) by L129 , GR_CY_1:5;
L131: R3 = ( R3 |^ ( 2 * C29 ) ) by L130 , GROUP_1:35;
L132: ( ( R3 " ) * ( R3 |^ ( 2 * C29 ) ) ) = ( 1_ R1 ) by L131 , GROUP_1:def 5;
L133: ( ( R3 |^ ( - 1 ) ) * ( R3 |^ ( 2 * C29 ) ) ) = ( 1_ R1 ) by L132 , GROUP_1:32;
L134: ( R3 |^ ( ( - 1 ) + ( 2 * C29 ) ) ) = ( 1_ R1 ) by L133 , GROUP_1:33;
L135: ( ( - 1 ) + ( 2 * C29 ) ) = ( 0 ) by L134 , L126 , L97;
thus L136: thesis by L135 , INT_1:9;
end;
L137: ( gr { ( R3 |^ 2 ) } ) <> R1 by L128 , L124 , GR_CY_2:2;
thus L138: contradiction by L137 , L122 , L127 , L38;
end;
consider C30 being (Element of ( NAT )) such that L139: C30 = ( ord R3 ) and L140: (not R3 is  being_of_order_0) by L125;
L141: R1 is  finite by L124 , L125 , L64;
L142: ( card R1 ) = C30 by L141 , L124 , L139 , GR_CY_1:7;
L143: C30 is  prime
proof
assume L144: (not C30 is  prime);
L145: (ex B44 , B45 being (Element of ( NAT )) st (B44 > 1 & B45 > 1 & C30 = ( B44 * B45 )))
proof
L146: (not (C30 > 1 & (for B46 being Nat holds (B46 divides C30 implies (B46 = 1 or B46 = C30))))) by L144 , INT_2:def 4;
L147: C30 >= 1 by L141 , L142 , GROUP_1:45;
L148: C30 > 1 by L147 , L123 , L139 , GROUP_1:43 , XXREAL_0:1;
consider C31 being Nat such that L149: C31 <> 1 and L150: C31 <> C30 and L151: C31 divides C30 by L148 , L146;
reconsider D4 = C31 as (Element of ( NAT )) by ORDINAL1:def 12;
consider C32 being Nat such that L152: C30 = ( D4 * C32 ) by L151 , NAT_D:def 3;
reconsider D5 = C32 as (Element of ( NAT )) by ORDINAL1:def 12;
take D6 = D4;
take D7 = D5;
L153: D6 <> ( 0 )
proof
assume L154: D6 = ( 0 );
L155: C30 = ( ( 0 ) * ( C30 div ( 0 ) ) ) by L154 , L151 , NAT_D:3;
thus L156: contradiction by L155 , L141 , L142;
end;
L157: ( ( 0 ) + 1 ) <= D6 by L153 , INT_1:7;
L158: ( 0 ) < D7 by L141 , L142 , L152;
L159: ( ( 0 ) + 1 ) <= D7 by L158 , INT_1:7;
L160: D7 <> 1 by L150 , L152;
thus L161: thesis by L160 , L149 , L152 , L157 , L159 , XXREAL_0:1;
end;
consider C33 , C34 being (Element of ( NAT )) such that L162: C33 > 1 and L163: C34 > 1 and L164: C30 = ( C33 * C34 ) by L145;
L165: ( ord ( R3 |^ C34 ) ) = C33 by L124 , L141 , L142 , L164 , GR_CY_2:8;
L166: ( card ( gr { ( R3 |^ C34 ) } ) ) = C33 by L165 , L141 , GR_CY_1:7;
L167: C33 <> C30 by L162 , L163 , L164 , XCMPLX_1:7;
L168: ( gr { ( R3 |^ C34 ) } ) <> ( (1). R1 ) by L162 , L166 , GROUP_2:69;
thus L169: thesis by L168 , L122 , L142 , L166 , L167;
end;
thus L170: thesis by L143 , L124 , L125 , L142 , L64 , GR_CY_2:4;
end;

assume that
L171: R1 is  cyclic
and
L172: R1 is  finite
and
L173: (ex B47 being (Element of ( NAT )) st (( card R1 ) = B47 & B47 is  prime));
let R7 being  strict (Subgroup of R1);
reconsider D8 = R1 as  finite Group by L172;
reconsider D9 = R7 as (Subgroup of D8);
L174: ( card D8 ) = ( ( card D9 ) * ( index D9 ) ) by GROUP_2:147;
L175: ( card D9 ) divides ( card D8 ) by L174 , NAT_D:def 3;
per cases  by L173 , L175 , INT_2:def 4;
suppose L176: ( card D9 ) = ( card D8 );

thus L177: thesis by L176 , GROUP_2:73;
end;
suppose L178: ( card D9 ) = 1;

thus L179: thesis by L178 , GROUP_2:70;
end;
end;
theorem
L181: (for B48 being Group holds (for B49 , B50 , B51 being (Element of B48) holds (for B52 being (Subset of B48) holds (B51 in ( ( B49 * B52 ) * B50 ) iff (ex B53 being (Element of B48) st (B51 = ( ( B49 * B53 ) * B50 ) & B53 in B52))))))
proof
let C35 being Group;
let C36 , C37 , C38 being (Element of C35);
let C39 being (Subset of C35);
thus L182: (C38 in ( ( C36 * C39 ) * C37 ) implies (ex B54 being (Element of C35) st (C38 = ( ( C36 * B54 ) * C37 ) & B54 in C39)))
proof
assume L183: C38 in ( ( C36 * C39 ) * C37 );
consider C40 being (Element of C35) such that L184: C38 = ( C40 * C37 ) and L185: C40 in ( C36 * C39 ) by L183 , GROUP_2:28;
consider C41 being (Element of C35) such that L186: C40 = ( C36 * C41 ) and L187: C41 in C39 by L185 , GROUP_2:27;
take C41;
thus L188: thesis by L184 , L186 , L187;
end;

given C42 being (Element of C35) such that
L189: C38 = ( ( C36 * C42 ) * C37 )
and
L190: C42 in C39;

L191: (ex B55 being (Element of C35) st (C38 = ( B55 * C37 ) & B55 in ( C36 * C39 )))
proof
take ( C36 * C42 );
thus L192: thesis by L189 , L190 , GROUP_2:27;
end;
thus L193: thesis by L191 , GROUP_2:28;
end;
theorem
L194: (for B56 being Group holds (for B57 being non  empty (Subset of B56) holds (for B58 being (Element of B56) holds ( card B57 ) = ( card ( ( ( B58 " ) * B57 ) * B58 ) ))))
proof
let C43 being Group;
let C44 being non  empty (Subset of C43);
let C45 being (Element of C43);
set D10 = ( ( ( C45 " ) * C44 ) * C45 );
L195: (C44 is non  empty & D10 is non  empty)
proof
set D11 = the (Element of C44);
L196: ( ( ( C45 " ) * D11 ) * C45 ) in D10 by L181;
thus L197: thesis by L196;
end;
reconsider D12 = D10 as non  empty (Subset of C43) by L195;
deffunc H2((Element of C43)) = ( ( ( C45 " ) * $1 ) * C45 );
consider C46 being (Function of C44 , (the carrier of C43)) such that L198: (for B59 being (Element of C44) holds ( C46 . B59 ) = H2(B59)) from FUNCT_2:sch 4;
L199: ( dom C46 ) = C44 by FUNCT_2:def 1;
L200: ( rng C46 ) c= D12
proof
let C47 being set;
assume L201: C47 in ( rng C46 );
consider C48 being set such that L202: C48 in C44 and L203: C47 = ( C46 . C48 ) by L201 , L199 , FUNCT_1:def 3;
reconsider D13 = C48 as (Element of C44) by L202;
L204: C47 = H2(D13) by L198 , L203;
thus L205: thesis by L204 , L181;
end;
L206: D12 c= ( rng C46 )
proof
let C49 being set;
assume L207: C49 in D12;
consider C50 being (Element of C43) such that L208: C49 = ( ( ( C45 " ) * C50 ) * C45 ) and L209: C50 in C44 by L207 , L181;
L210: (ex B60 being (Element of C43) st (B60 in ( dom C46 ) & C49 = ( C46 . B60 )))
proof
take C50;
thus L211: thesis by L198 , L208 , L209 , FUNCT_2:def 1;
end;
thus L212: thesis by L210 , FUNCT_1:def 3;
end;
reconsider D14 = C46 as (Function of C44 , D12) by L199 , L200 , FUNCT_2:2;
deffunc H3((Element of C43)) = ( ( C45 * $1 ) * ( C45 " ) );
consider C51 being (Function of D12 , (the carrier of C43)) such that L213: (for B61 being (Element of D12) holds ( C51 . B61 ) = H3(B61)) from FUNCT_2:sch 4;
L214: ( dom C51 ) = D12 by FUNCT_2:def 1;
L215: ( rng C51 ) c= C44
proof
let C52 being set;
assume L216: C52 in ( rng C51 );
consider C53 being set such that L217: C53 in D12 and L218: C52 = ( C51 . C53 ) by L216 , L214 , FUNCT_1:def 3;
reconsider D15 = C53 as (Element of D12) by L217;
L219: C52 = H3(D15) by L213 , L218;
consider C54 being (Element of C43) such that L220: D15 = ( ( ( C45 " ) * C54 ) * C45 ) and L221: C54 in C44 by L181;
L222: C52 = ( ( ( C45 * ( ( C45 " ) * C54 ) ) * C45 ) * ( C45 " ) ) by L219 , L220 , GROUP_1:def 3
.= ( ( ( ( C45 * ( C45 " ) ) * C54 ) * C45 ) * ( C45 " ) ) by GROUP_1:def 3
.= ( ( ( C45 * ( C45 " ) ) * C54 ) * ( C45 * ( C45 " ) ) ) by GROUP_1:def 3
.= ( ( ( 1_ C43 ) * C54 ) * ( C45 * ( C45 " ) ) ) by GROUP_1:def 5
.= ( ( ( 1_ C43 ) * C54 ) * ( 1_ C43 ) ) by GROUP_1:def 5
.= ( ( 1_ C43 ) * C54 ) by GROUP_1:def 4
.= C54 by GROUP_1:def 4;
thus L223: thesis by L222 , L221;
end;
reconsider D16 = C51 as (Function of D12 , C44) by L215 , L214 , FUNCT_2:2;
L224: (for B62 , B63 being (Element of C44) holds (( D14 . B62 ) = ( D14 . B63 ) implies B62 = B63))
proof
let C55 , C56 being (Element of C44);
assume that
L225: ( D14 . C55 ) = ( D14 . C56 );
L226: ( ( ( C45 " ) * C55 ) * C45 ) in D12 by L181;
L227: ( ( ( C45 " ) * C56 ) * C45 ) in D12 by L181;
L228: ( D16 . ( D14 . C55 ) ) = ( D16 . ( ( ( C45 " ) * C55 ) * C45 ) ) by L198
.= ( ( C45 * ( ( ( C45 " ) * C55 ) * C45 ) ) * ( C45 " ) ) by L213 , L226
.= ( ( ( C45 * ( ( C45 " ) * C55 ) ) * C45 ) * ( C45 " ) ) by GROUP_1:def 3
.= ( ( ( ( C45 * ( C45 " ) ) * C55 ) * C45 ) * ( C45 " ) ) by GROUP_1:def 3
.= ( ( ( C45 * ( C45 " ) ) * C55 ) * ( C45 * ( C45 " ) ) ) by GROUP_1:def 3
.= ( ( ( 1_ C43 ) * C55 ) * ( C45 * ( C45 " ) ) ) by GROUP_1:def 5
.= ( C55 * ( C45 * ( C45 " ) ) ) by GROUP_1:def 4
.= ( C55 * ( 1_ C43 ) ) by GROUP_1:def 5
.= C55 by GROUP_1:def 4;
L229: ( D16 . ( D14 . C56 ) ) = ( D16 . ( ( ( C45 " ) * C56 ) * C45 ) ) by L198
.= ( ( C45 * ( ( ( C45 " ) * C56 ) * C45 ) ) * ( C45 " ) ) by L213 , L227
.= ( ( ( C45 * ( ( C45 " ) * C56 ) ) * C45 ) * ( C45 " ) ) by GROUP_1:def 3
.= ( ( ( ( C45 * ( C45 " ) ) * C56 ) * C45 ) * ( C45 " ) ) by GROUP_1:def 3
.= ( ( ( C45 * ( C45 " ) ) * C56 ) * ( C45 * ( C45 " ) ) ) by GROUP_1:def 3
.= ( ( ( 1_ C43 ) * C56 ) * ( C45 * ( C45 " ) ) ) by GROUP_1:def 5
.= ( C56 * ( C45 * ( C45 " ) ) ) by GROUP_1:def 4
.= ( C56 * ( 1_ C43 ) ) by GROUP_1:def 5
.= C56 by GROUP_1:def 4;
thus L230: thesis by L229 , L225 , L228;
end;
L231: C44 , D12 are_equipotent 
proof
take D14;
thus L232: thesis by L200 , L206 , L224 , FUNCT_2:def 1 , GROUP_6:1 , XBOOLE_0:def 10;
end;
thus L233: thesis by L231 , CARD_1:5;
end;
definition
let R1 being  strict Group;
let R7 being  strict (Subgroup of R1);
let R8 being  strict (Subgroup of R1);
func Double_Cosets (R7 , R8) -> (Subset-Family of R1) means 
(for R10 being (Subset of R1) holds (R10 in it iff (ex R2 being (Element of R1) st R10 = ( ( R7 * R2 ) * R8 ))));
existence
proof
defpred S1[ set ] means (ex R2 being (Element of R1) st $1 = ( ( R7 * R2 ) * R8 ));
L234: (ex B64 being (Subset-Family of R1) st (for B65 being (Subset of R1) holds (B65 in B64 iff S1[ B65 ]))) from SUBSET_1:sch 3;
thus L235: thesis by L234;
end;
uniqueness
proof
let C57 , C58 being (Subset-Family of R1);
defpred S2[ set ] means (ex R2 being (Element of R1) st $1 = ( ( R7 * R2 ) * R8 ));
assume L236: (for R10 being (Subset of R1) holds (R10 in C57 iff S2[ R10 ]));
assume L237: (for R10 being (Subset of R1) holds (R10 in C58 iff S2[ R10 ]));
thus L238: thesis from SUBSET_1:sch 4(L236 , L237);
end;
end;
theorem
L240: (for R1 being  strict Group holds (for R4 being (Element of R1) holds (for R6 being (Element of R1) holds (for R7 being  strict (Subgroup of R1) holds (for R8 being  strict (Subgroup of R1) holds (R6 in ( ( R7 * R4 ) * R8 ) iff (ex B66 , B67 being (Element of R1) st (R6 = ( ( B66 * R4 ) * B67 ) & B66 in R7 & B67 in R8))))))))
proof
let R1 being  strict Group;
let R4 being (Element of R1);
let R6 being (Element of R1);
let R7 being  strict (Subgroup of R1);
let R8 being  strict (Subgroup of R1);
thus L241: (R6 in ( ( R7 * R4 ) * R8 ) implies (ex B68 , B69 being (Element of R1) st (R6 = ( ( B68 * R4 ) * B69 ) & B68 in R7 & B69 in R8)))
proof
assume L242: R6 in ( ( R7 * R4 ) * R8 );
consider C59 , C60 being (Element of R1) such that L243: R6 = ( C59 * C60 ) and L244: C59 in ( R7 * R4 ) and L245: C60 in R8 by L242 , GROUP_2:94;
L246: (ex B70 being (Element of R1) st (C59 = ( B70 * R4 ) & B70 in R7)) by L244 , GROUP_2:104;
thus L247: thesis by L246 , L243 , L245;
end;

given C61 , C62 being (Element of R1) such that
L248: R6 = ( ( C61 * R4 ) * C62 )
and
L249: C61 in R7
and
L250: C62 in R8;

L251: (ex B71 , B72 being (Element of R1) st (R6 = ( B71 * B72 ) & B71 in ( R7 * R4 ) & B72 in R8))
proof
set D17 = ( C61 * R4 );
L252: D17 in ( R7 * R4 ) by L249 , GROUP_2:104;
thus L253: thesis by L252 , L248 , L250;
end;
thus L254: thesis by L251 , GROUP_2:94;
end;
theorem
L255: (for R1 being  strict Group holds (for R4 being (Element of R1) holds (for R5 being (Element of R1) holds (for R7 being  strict (Subgroup of R1) holds (for R8 being  strict (Subgroup of R1) holds (( ( R7 * R4 ) * R8 ) = ( ( R7 * R5 ) * R8 ) or (not (ex R6 being (Element of R1) st (R6 in ( ( R7 * R4 ) * R8 ) & R6 in ( ( R7 * R5 ) * R8 ))))))))))
proof
let R1 being  strict Group;
let R4 being (Element of R1);
let R5 being (Element of R1);
let R7 being  strict (Subgroup of R1);
let R8 being  strict (Subgroup of R1);
per cases ;
suppose L256: (not (ex R6 being (Element of R1) st (R6 in ( ( R7 * R4 ) * R8 ) & R6 in ( ( R7 * R5 ) * R8 ))));

thus L257: thesis by L256;
end;
suppose L258: (ex R6 being (Element of R1) st (R6 in ( ( R7 * R4 ) * R8 ) & R6 in ( ( R7 * R5 ) * R8 )));

consider R6 being (Element of R1) such that L259: R6 in ( ( R7 * R4 ) * R8 ) and L260: R6 in ( ( R7 * R5 ) * R8 ) by L258;
consider C63 , C64 being (Element of R1) such that L261: R6 = ( ( C63 * R4 ) * C64 ) and L262: C63 in R7 and L263: C64 in R8 by L259 , L240;
consider C65 , C66 being (Element of R1) such that L264: R6 = ( ( C65 * R5 ) * C66 ) and L265: C65 in R7 and L266: C66 in R8 by L260 , L240;
L267: (for B73 being set holds (B73 in ( ( R7 * R4 ) * R8 ) implies B73 in ( ( R7 * R5 ) * R8 )))
proof
let C67 being set;
assume L268: C67 in ( ( R7 * R4 ) * R8 );
consider C68 , C69 being (Element of R1) such that L269: C67 = ( ( C68 * R4 ) * C69 ) and L270: C68 in R7 and L271: C69 in R8 by L268 , L240;
L272: (ex B74 , B75 being (Element of R1) st (C67 = ( ( B74 * R5 ) * B75 ) & B74 in R7 & B75 in R8))
proof
L273: C68 = ( C68 * ( 1_ R1 ) ) by GROUP_1:def 4;
L274: ( ( C68 * R4 ) * C69 ) = ( ( ( ( C68 * ( 1_ R1 ) ) * R4 ) * ( 1_ R1 ) ) * C69 ) by L273 , GROUP_1:def 4;
L275: ( 1_ R1 ) = ( ( C63 " ) * C63 ) by GROUP_1:def 5;
L276: ( ( C68 * R4 ) * C69 ) = ( ( ( ( C68 * ( ( C63 " ) * C63 ) ) * R4 ) * ( C64 * ( C64 " ) ) ) * C69 ) by L275 , L274 , GROUP_1:def 5
.= ( ( ( ( ( C68 * ( ( C63 " ) * C63 ) ) * R4 ) * C64 ) * ( C64 " ) ) * C69 ) by GROUP_1:def 3
.= ( ( ( ( ( ( C68 * ( C63 " ) ) * C63 ) * R4 ) * C64 ) * ( C64 " ) ) * C69 ) by GROUP_1:def 3
.= ( ( ( ( ( C68 * ( C63 " ) ) * ( C63 * R4 ) ) * C64 ) * ( C64 " ) ) * C69 ) by GROUP_1:def 3
.= ( ( ( ( C68 * ( C63 " ) ) * ( ( C65 * R5 ) * C66 ) ) * ( C64 " ) ) * C69 ) by L261 , L264 , GROUP_1:def 3
.= ( ( ( ( ( C68 * ( C63 " ) ) * ( C65 * R5 ) ) * C66 ) * ( C64 " ) ) * C69 ) by GROUP_1:def 3
.= ( ( ( ( ( ( C68 * ( C63 " ) ) * C65 ) * R5 ) * C66 ) * ( C64 " ) ) * C69 ) by GROUP_1:def 3
.= ( ( ( ( ( C68 * ( C63 " ) ) * C65 ) * R5 ) * ( C66 * ( C64 " ) ) ) * C69 ) by GROUP_1:def 3
.= ( ( ( ( C68 * ( C63 " ) ) * C65 ) * R5 ) * ( ( C66 * ( C64 " ) ) * C69 ) ) by GROUP_1:def 3;
take ( ( C68 * ( C63 " ) ) * C65 );
take ( ( C66 * ( C64 " ) ) * C69 );
L277: ( C63 " ) in R7 by L262 , GROUP_2:51;
L278: ( C68 * ( C63 " ) ) in R7 by L277 , L270 , GROUP_2:50;
L279: ( C64 " ) in R8 by L263 , GROUP_2:51;
L280: ( C66 * ( C64 " ) ) in R8 by L279 , L266 , GROUP_2:50;
thus L281: thesis by L280 , L265 , L269 , L271 , L276 , L278 , GROUP_2:50;
end;
thus L282: thesis by L272 , L240;
end;
L283: ( ( R7 * R4 ) * R8 ) c= ( ( R7 * R5 ) * R8 ) by L267 , TARSKI:def 3;
L284: (for B76 being set holds (B76 in ( ( R7 * R5 ) * R8 ) implies B76 in ( ( R7 * R4 ) * R8 )))
proof
let C70 being set;
assume L285: C70 in ( ( R7 * R5 ) * R8 );
consider C71 , C72 being (Element of R1) such that L286: C70 = ( ( C71 * R5 ) * C72 ) and L287: C71 in R7 and L288: C72 in R8 by L285 , L240;
L289: (ex B77 , B78 being (Element of R1) st (C70 = ( ( B77 * R4 ) * B78 ) & B77 in R7 & B78 in R8))
proof
L290: C71 = ( C71 * ( 1_ R1 ) ) by GROUP_1:def 4;
L291: ( ( C71 * R5 ) * C72 ) = ( ( ( ( C71 * ( 1_ R1 ) ) * R5 ) * ( 1_ R1 ) ) * C72 ) by L290 , GROUP_1:def 4;
L292: ( 1_ R1 ) = ( ( C65 " ) * C65 ) by GROUP_1:def 5;
L293: ( ( C71 * R5 ) * C72 ) = ( ( ( ( C71 * ( ( C65 " ) * C65 ) ) * R5 ) * ( C66 * ( C66 " ) ) ) * C72 ) by L292 , L291 , GROUP_1:def 5
.= ( ( ( ( ( C71 * ( ( C65 " ) * C65 ) ) * R5 ) * C66 ) * ( C66 " ) ) * C72 ) by GROUP_1:def 3
.= ( ( ( ( ( ( C71 * ( C65 " ) ) * C65 ) * R5 ) * C66 ) * ( C66 " ) ) * C72 ) by GROUP_1:def 3
.= ( ( ( ( ( C71 * ( C65 " ) ) * ( C65 * R5 ) ) * C66 ) * ( C66 " ) ) * C72 ) by GROUP_1:def 3
.= ( ( ( ( C71 * ( C65 " ) ) * ( ( C63 * R4 ) * C64 ) ) * ( C66 " ) ) * C72 ) by L261 , L264 , GROUP_1:def 3
.= ( ( ( ( ( C71 * ( C65 " ) ) * ( C63 * R4 ) ) * C64 ) * ( C66 " ) ) * C72 ) by GROUP_1:def 3
.= ( ( ( ( ( ( C71 * ( C65 " ) ) * C63 ) * R4 ) * C64 ) * ( C66 " ) ) * C72 ) by GROUP_1:def 3
.= ( ( ( ( ( C71 * ( C65 " ) ) * C63 ) * R4 ) * ( C64 * ( C66 " ) ) ) * C72 ) by GROUP_1:def 3
.= ( ( ( ( C71 * ( C65 " ) ) * C63 ) * R4 ) * ( ( C64 * ( C66 " ) ) * C72 ) ) by GROUP_1:def 3;
take ( ( C71 * ( C65 " ) ) * C63 );
take ( ( C64 * ( C66 " ) ) * C72 );
L294: ( C65 " ) in R7 by L265 , GROUP_2:51;
L295: ( C71 * ( C65 " ) ) in R7 by L294 , L287 , GROUP_2:50;
L296: ( C66 " ) in R8 by L266 , GROUP_2:51;
L297: ( C64 * ( C66 " ) ) in R8 by L296 , L263 , GROUP_2:50;
thus L298: thesis by L297 , L262 , L286 , L288 , L293 , L295 , GROUP_2:50;
end;
thus L299: thesis by L289 , L240;
end;
L300: ( ( R7 * R5 ) * R8 ) c= ( ( R7 * R4 ) * R8 ) by L284 , TARSKI:def 3;
thus L301: thesis by L300 , L283 , XBOOLE_0:def 10;
end;
end;
registration
let R11 being Group;
let R14 being (Subgroup of R11);
cluster ( Left_Cosets R14 ) -> non  empty;
coherence by GROUP_2:135;
end;
notation
let C73 being Group;
let C74 being (Subgroup of C73);
synonym index (C73 , C74) for index C74;
end;
theorem
L305: (for R11 being Group holds (for R13 being (Subgroup of R11) holds (for R14 being (Subgroup of R11) holds (for R15 being (Subgroup of R14) holds ((R15 = ( R14 /\ R13 ) & R11 is  finite) implies ( index (R11 , R13) ) >= ( index (R14 , R15) ))))))
proof
let R11 being Group;
let R13 being (Subgroup of R11);
let R14 being (Subgroup of R11);
let R15 being (Subgroup of R14);
assume that
L306: R15 = ( R14 /\ R13 )
and
L307: R11 is  finite;
reconsider D18 = ( Left_Cosets R13 ) as  finite non  empty set by L307;
reconsider D19 = ( Left_Cosets R15 ) as  finite non  empty set by L307;
L308:
now
let C75 , C76 being (Element of R11);
let C77 , C78 being (Element of R14);
assume that
L309: C77 = C75
and
L310: C78 = C76;
L311: ( C78 " ) = ( C76 " ) by L310 , GROUP_2:48;
L312: ( ( C78 " ) * C77 ) in R14 by STRUCT_0:def 5;
L313: (( C75 * R13 ) = ( C76 * R13 ) iff ( ( C76 " ) * C75 ) in R13) by GROUP_2:114;
L314: (( C75 * R13 ) = ( C76 * R13 ) iff ( ( C78 " ) * C77 ) in R13) by L313 , L309 , L311 , GROUP_2:43;
L315: (( C75 * R13 ) = ( C76 * R13 ) iff ( ( C78 " ) * C77 ) in R15) by L314 , L306 , L312 , GROUP_2:82;
thus L316: (( C75 * R13 ) = ( C76 * R13 ) iff ( C77 * R15 ) = ( C78 * R15 )) by L315 , GROUP_2:114;
end;
defpred S3[ set , set ] means (ex B79 being (Element of R11) st (ex B80 being (Element of R14) st (B79 = B80 & $2 = ( B79 * R13 ) & $1 = ( B80 * R15 ))));
L317: (for B81 being (Element of D19) holds (ex B82 being (Element of D18) st S3[ B81 , B82 ]))
proof
let C79 being (Element of D19);
L318: C79 in D19;
consider C80 being (Element of R14) such that L319: C79 = ( C80 * R15 ) by L318 , GROUP_2:def 15;
reconsider D20 = C80 as (Element of R11) by GROUP_2:42;
reconsider D21 = ( D20 * R13 ) as (Element of D18) by GROUP_2:def 15;
take D21;
take D20;
take C80;
thus L320: thesis by L319;
end;
consider C81 being (Function of D19 , D18) such that L321: (for B83 being (Element of D19) holds S3[ B83 , ( C81 . B83 ) ]) from FUNCT_2:sch 3(L317);
L322: ( dom C81 ) = D19 by FUNCT_2:def 1;
L323: ( rng C81 ) c= D18 by RELAT_1:def 19;
L324: ( index R15 ) = ( card D19 ) by GROUP_2:def 18;
L325: ( index R13 ) = ( card D18 ) by GROUP_2:def 18;
L326: C81 is  one-to-one
proof
let C82 , C83 being set;
assume that
L327: C82 in ( dom C81 )
and
L328: C83 in ( dom C81 );
reconsider D22 = C82 , D23 = C83 as (Element of D19) by L327 , L328 , FUNCT_2:def 1;
L329: (ex B84 being (Element of R11) st (ex B85 being (Element of R14) st (B84 = B85 & ( C81 . D22 ) = ( B84 * R13 ) & D22 = ( B85 * R15 )))) by L321;
L330: (ex B86 being (Element of R11) st (ex B87 being (Element of R14) st (B86 = B87 & ( C81 . D23 ) = ( B86 * R13 ) & D23 = ( B87 * R15 )))) by L321;
thus L331: thesis by L330 , L308 , L329;
end;
L332: ( index R15 ) c= ( index R13 ) by L326 , L322 , L323 , L324 , L325 , CARD_1:10;
thus L333: thesis by L332 , NAT_1:39;
end;
theorem
L334: (for B88 being  finite Group holds (for B89 being (Subgroup of B88) holds ( index (B88 , B89) ) > ( 0 )))
proof
let C84 being  finite Group;
let C85 being (Subgroup of C84);
L335: ( card C84 ) = ( ( card C85 ) * ( index C85 ) ) by GROUP_2:147;
thus L336: thesis by L335;
end;
theorem
L337: (for B90 being Group holds (B90 is  finite implies (for B91 being (Subgroup of B90) holds (for B92 , B93 being (Subgroup of B91) holds (for B94 being (Subgroup of B92) holds (B94 = ( B92 /\ B93 ) implies (for B95 being (Subgroup of B93) holds (B95 = ( B92 /\ B93 ) implies (for B96 being (Subgroup of B91) holds (B96 = ( B92 /\ B93 ) implies (( index (B91 , B92) ) , ( index (B91 , B93) ) are_relative_prime  implies (( index (B91 , B93) ) = ( index (B92 , B94) ) & ( index (B91 , B92) ) = ( index (B93 , B95) )))))))))))))
proof
let R11 being Group;
assume that
L338: R11 is  finite;
let C86 being (Subgroup of R11);
let C87 , C88 being (Subgroup of C86);
let C89 being (Subgroup of C87);
assume that
L339: C89 = ( C87 /\ C88 );
let C90 being (Subgroup of C88);
assume that
L340: C90 = ( C87 /\ C88 );
let C91 being (Subgroup of C86);
assume that
L341: C91 = ( C87 /\ C88 );
assume that
L342: ( index C87 ) , ( index C88 ) are_relative_prime ;
L343: ( index C91 ) = ( ( index C90 ) * ( index C88 ) ) by L338 , L340 , L341 , GROUP_2:149;
L344: ( ( index C90 ) * ( index C88 ) ) = ( ( index C89 ) * ( index C87 ) ) by L343 , L338 , L339 , L341 , GROUP_2:149;
L345: (( index C88 ) qua Integer) divides ( (( index C87 ) qua Integer) * (( index C89 ) qua Integer) ) by L344 , INT_1:def 3;
L346: (( index C88 ) qua Integer) divides (( index C89 ) qua Integer) by L345 , L342 , INT_2:25;
L347: (ex B97 being (Element of ( NAT )) st ( index C89 ) = ( ( index C88 ) * B97 ))
proof
consider C92 being Integer such that L348: ( index C89 ) = ( (( index C88 ) qua Integer) * C92 ) by L346 , INT_1:def 3;
L349: ( 0 ) <= C92 by L338 , L348 , L334;
reconsider D24 = C92 as (Element of ( NAT )) by L349 , INT_1:3;
take D24;
thus L350: thesis by L348;
end;
L351: ( index C88 ) divides ( index C89 ) by L347 , NAT_D:def 3;
L352: ( index (C86 , C88) ) >= ( index (C87 , C89) ) by L338 , L339 , L305;
L353: ( index C88 ) = ( index C89 )
proof
assume L354: ( index C88 ) <> ( index C89 );
L355: ( index C89 ) > ( 0 ) by L338 , L334;
L356: ( index C88 ) <= ( index C89 ) by L355 , L351 , NAT_D:7;
thus L357: contradiction by L356 , L352 , L354 , XXREAL_0:1;
end;
L358: (( index C87 ) qua Integer) divides ( (( index C88 ) qua Integer) * (( index C90 ) qua Integer) ) by L344 , INT_1:def 3;
L359: (( index C87 ) qua Integer) divides ( index C90 ) by L358 , L342 , INT_2:25;
L360: (ex B98 being (Element of ( NAT )) st ( index C90 ) = ( ( index C87 ) * B98 ))
proof
consider C93 being Integer such that L361: ( index C90 ) = ( (( index C87 ) qua Integer) * C93 ) by L359 , INT_1:def 3;
L362: ( 0 ) <= C93 by L338 , L361 , L334;
reconsider D25 = C93 as (Element of ( NAT )) by L362 , INT_1:3;
take D25;
thus L363: thesis by L361;
end;
L364: ( index C87 ) divides ( index C90 ) by L360 , NAT_D:def 3;
L365: ( index C87 ) >= ( index C90 ) by L338 , L340 , L305;
L366: ( index C87 ) = ( index C90 )
proof
assume L367: ( index C87 ) <> ( index C90 );
L368: ( index C90 ) > ( 0 ) by L338 , L334;
L369: ( index C87 ) <= ( index C90 ) by L368 , L364 , NAT_D:7;
thus L370: contradiction by L369 , L365 , L367 , XXREAL_0:1;
end;
thus L371: thesis by L366 , L353;
end;
theorem
L372: (for R11 being Group holds (for R12 being (Subgroup of R11) holds (for B99 being (Element of R11) holds (B99 in R12 implies (for B100 being Integer holds ( B99 |^ B100 ) in R12)))))
proof
let R11 being Group;
let R12 being (Subgroup of R11);
let C94 being (Element of R11);
assume L373: C94 in R12;
let C95 being Integer;
consider C96 being (Element of ( NAT )) such that L374: (C95 = C96 or C95 = ( - C96 )) by INT_1:2;
per cases  by L374;
suppose L375: C95 = C96;

defpred S4[ (Element of ( NAT )) ] means ( C94 |^ $1 ) in R12;
L376: ( C94 |^ ( 0 ) ) = ( 1_ R11 ) by GROUP_1:25;
L377: S4[ ( 0 ) ] by L376 , GROUP_2:46;
L378: (for B101 being (Element of ( NAT )) holds (S4[ B101 ] implies S4[ ( B101 + 1 ) ]))
proof
let C97 being (Element of ( NAT ));
assume L379: S4[ C97 ];
L380: ( ( C94 |^ C97 ) * C94 ) in R12 by L379 , L373 , GROUP_2:50;
thus L381: thesis by L380 , GROUP_1:34;
end;
L382: (for B102 being (Element of ( NAT )) holds S4[ B102 ]) from NAT_1:sch 1(L377 , L378);
thus L383: thesis by L382 , L375;
end;
suppose L384: C95 = ( - C96 );

defpred S5[ (Element of ( NAT )) ] means ( C94 |^ ( - $1 ) ) in R12;
L385: ( C94 |^ ( 0 ) ) = ( 1_ R11 ) by GROUP_1:25;
L386: S5[ ( 0 ) ] by L385 , GROUP_2:46;
L387: (for B103 being (Element of ( NAT )) holds (S5[ B103 ] implies S5[ ( B103 + 1 ) ]))
proof
let C98 being (Element of ( NAT ));
assume that
L388: S5[ C98 ];
L389: ( C94 " ) in R12 by L373 , GROUP_2:51;
L390: ( ( C94 |^ ( - C98 ) ) * ( C94 " ) ) in R12 by L389 , L388 , GROUP_2:50;
L391: ( ( C94 |^ ( - C98 ) ) * ( C94 |^ ( - 1 ) ) ) in R12 by L390 , GROUP_1:32;
L392: ( C94 |^ ( ( - C98 ) + ( - 1 ) ) ) in R12 by L391 , GROUP_1:33;
thus L393: thesis by L392;
end;
L394: (for B104 being (Element of ( NAT )) holds S5[ B104 ]) from NAT_1:sch 1(L386 , L387);
thus L395: thesis by L394 , L384;
end;
end;
theorem
L397: (for B105 being  strict Group holds (B105 <> ( (1). B105 ) implies (ex B106 being (Element of B105) st B106 <> ( 1_ B105 ))))
proof
let C99 being  strict Group;
assume that
L398: C99 <> ( (1). C99 );
assume L399: (not (ex B107 being (Element of C99) st B107 <> ( 1_ C99 )));
L400: (for B108 , B109 being (Element of C99) holds B108 = B109)
proof
let C100 , C101 being (Element of C99);
L401: C100 = ( 1_ C99 ) by L399;
thus L402: thesis by L401 , L399;
end;
L403: C99 is  trivial by L400 , STRUCT_0:def 10;
thus L404: contradiction by L403 , L398 , GROUP_6:12;
end;
theorem
L405: (for B110 being  strict Group holds (for B111 being (Element of B110) holds (B110 = ( gr { B111 } ) implies (for B112 being  strict (Subgroup of B110) holds (B112 <> ( (1). B110 ) implies (ex B113 being (Element of ( NAT )) st (( 0 ) < B113 & ( B111 |^ B113 ) in B112)))))))
proof
let C102 being  strict Group;
let C103 being (Element of C102);
assume that
L406: C102 = ( gr { C103 } );
let C104 being  strict (Subgroup of C102);
assume L407: C104 <> ( (1). C102 );
L408: C104 <> ( (1). C104 ) by L407 , GROUP_2:63;
consider C105 being (Element of C104) such that L409: C105 <> ( 1_ C104 ) by L408 , L397;
L410: C105 in C104 by STRUCT_0:def 5;
L411: C105 in C102 by L410 , GROUP_2:40;
reconsider D26 = C105 as (Element of C102) by L411 , STRUCT_0:def 5;
L412: D26 in ( gr { C103 } ) by L406 , STRUCT_0:def 5;
L413: (ex B114 being Integer st (D26 = ( C103 |^ B114 ) & B114 <> ( 0 )))
proof
assume L414: (not (ex B115 being Integer st (D26 = ( C103 |^ B115 ) & B115 <> ( 0 ))));
consider C106 being Integer such that L415: D26 = ( C103 |^ C106 ) by L412 , GR_CY_1:5;
L416: ( C103 |^ C106 ) <> ( 1_ C102 ) by L409 , L415 , GROUP_2:44;
L417: C106 = ( 0 ) by L414 , L415;
thus L418: contradiction by L417 , L416 , GROUP_1:25;
end;
consider C107 being Integer such that L419: D26 = ( C103 |^ C107 ) and L420: C107 <> ( 0 ) by L413;
consider C108 being (Element of ( NAT )) such that L421: (C107 = C108 or C107 = ( - C108 )) by INT_1:2;
per cases  by L421;
suppose L422: C107 = C108;

thus L423: thesis by L422 , L410 , L419 , L420;
end;
suppose L424: C107 = ( - C108 );

L425: ( 0 ) < C108 by L424 , L420;
L426: ( ( C103 |^ C108 ) " ) in C104 by L410 , L419 , L424 , GROUP_1:36;
L427: ( ( ( C103 |^ C108 ) " ) " ) in C104 by L426 , GROUP_2:51;
thus L428: thesis by L427 , L425;
end;
end;
theorem
L430: (for B116 being  strict  cyclic Group holds (for B117 being  strict (Subgroup of B116) holds B117 is  cyclic  cyclic  cyclic  cyclic Group))
proof
let C109 being  strict  cyclic Group;
let C110 being  strict (Subgroup of C109);
per cases ;
suppose L431: C110 = ( (1). C109 );

thus L432: thesis by L431;
end;
suppose L433: C110 <> ( (1). C109 );

consider C111 being (Element of C109) such that L434: ( the multMagma of C109 ) = ( gr { C111 } ) by GR_CY_1:def 7;
L435: (ex B118 being Nat st (( 0 ) < B118 & ( C111 |^ B118 ) in C110 & (for B119 being Nat holds ((( 0 ) < B119 & ( C111 |^ B119 ) in C110) implies B118 <= B119))))
proof
defpred S6[ Nat ] means (( 0 ) < $1 & ( C111 |^ $1 ) in C110);
L436: (ex B120 being (Element of ( NAT )) st S6[ B120 ]) by L433 , L434 , L405;
L437: (ex B121 being Nat st S6[ B121 ]) by L436;
L438: (ex B122 being Nat st (S6[ B122 ] & (for B123 being Nat holds (S6[ B123 ] implies B122 <= B123)))) from NAT_1:sch 5(L437);
thus L439: thesis by L438;
end;
consider C112 being Nat such that L440: ( 0 ) < C112 and L441: ( C111 |^ C112 ) in C110 and L442: (for B124 being Nat holds ((( 0 ) < B124 & ( C111 |^ B124 ) in C110) implies C112 <= B124)) by L435;
set D27 = ( C111 |^ C112 );
reconsider D28 = D27 as (Element of C110) by L441 , STRUCT_0:def 5;
L443: (for B125 being (Element of C110) holds (ex B126 being Integer st B125 = ( D28 |^ B126 )))
proof
let C113 being (Element of C110);
L444: (ex B127 being Integer st (( C111 |^ B127 ) in C110 & ( C111 |^ B127 ) = C113))
proof
L445: C113 in C109 by GROUP_2:41;
L446: C113 in ( gr { C111 } ) by L434 , GROUP_2:41;
L447: C113 is (Element of C109) by L445 , STRUCT_0:def 5;
consider C114 being Integer such that L448: C113 = ( C111 |^ C114 ) by L447 , L446 , GR_CY_1:5;
L449: ( C111 |^ C114 ) in C110 by L448 , STRUCT_0:def 5;
thus L450: thesis by L449 , L448;
end;
consider C115 being Integer such that L451: ( C111 |^ C115 ) in C110 and L452: ( C111 |^ C115 ) = C113 by L444;
L453: (ex B128 , B129 being Integer st (( 0 ) <= B129 & B129 < C112 & C115 = ( ( C112 * B128 ) + B129 )))
proof
take ( C115 div C112 );
take ( C115 mod C112 );
thus L454: thesis by L440 , NEWTON:64 , NEWTON:65 , NEWTON:66;
end;
consider C116 , C117 being Integer such that L455: ( 0 ) <= C117 and L456: C117 < C112 and L457: C115 = ( ( C112 * C116 ) + C117 ) by L453;
reconsider D29 = C117 as (Element of ( NAT )) by L455 , INT_1:3;
L458: ( C111 |^ C115 ) = ( ( C111 |^ ( C112 * C116 ) ) * ( C111 |^ D29 ) ) by L457 , GROUP_1:33
.= ( ( ( C111 |^ C112 ) |^ C116 ) * ( C111 |^ D29 ) ) by GROUP_1:35;
L459: ( ( C111 |^ C112 ) |^ C116 ) in C110 by L441 , L372;
L460: ( C111 |^ D29 ) in C110
proof
set D30 = ( C111 |^ C115 );
set D31 = ( ( C111 |^ C112 ) |^ C116 );
L461: ( ( D31 " ) * D30 ) = ( ( ( D31 " ) * D31 ) * ( C111 |^ D29 ) ) by L458 , GROUP_1:def 3
.= ( ( 1_ C109 ) * ( C111 |^ D29 ) ) by GROUP_1:def 5
.= ( C111 |^ D29 ) by GROUP_1:def 4;
L462: ( D31 " ) in C110 by L459 , GROUP_2:51;
thus L463: thesis by L462 , L451 , L461 , GROUP_2:50;
end;
L464: D29 = ( 0 ) by L460 , L442 , L456;
L465: ( C111 |^ D29 ) = ( 1_ C109 ) by L464 , GROUP_1:25;
L466: ( C111 |^ C115 ) = ( ( C111 |^ C112 ) |^ C116 ) by L465 , L458 , GROUP_1:def 4;
L467: ( ( C111 |^ C112 ) |^ C116 ) = ( D28 |^ C116 ) by GROUP_4:2;
thus L468: thesis by L467 , L452 , L466;
end;
L469: C110 = ( gr { D28 } ) by L443 , GR_CY_2:5;
thus L470: thesis by L469 , GR_CY_2:4;
end;
end;
