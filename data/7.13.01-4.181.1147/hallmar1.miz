:: The {H}all {M}arriage {T}heorem
::  by Ewa Romanowicz and Adam Grabowski
::
:: Received May 11, 2004
:: Copyright (c) 2004-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, FINSET_1, CARD_1, XBOOLE_0, ARYTM_3, ARYTM_1, SUBSET_1,
      XXREAL_0, NAT_1, RELAT_1, FINSEQ_1, ZFMISC_1, FUNCT_1, TARSKI, FUNCT_4,
      HALLMAR1;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, RELAT_1, FUNCT_1, CARD_1,
      NUMBERS, XCMPLX_0, XXREAL_0, ORDINAL1, NAT_1, FINSET_1, FINSEQ_1,
      FUNCT_2, FUNCT_7;
 constructors REAL_1, NAT_1, FUNCT_7, RELSET_1;
 registrations SUBSET_1, RELAT_1, FUNCT_1, FINSET_1, XXREAL_0, XREAL_0,
      FINSEQ_1, CHAIN_1, ORDINAL1, CARD_1, RELSET_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, XBOOLE_0;
 theorems CARD_2, SPPOL_1, EULER_1, XBOOLE_1, ZFMISC_1, FUNCT_1, PARTFUN1,
      FINSET_1, PENCIL_1, CARD_1, TARSKI, NAT_1, XBOOLE_0, FINSEQ_1, FUNCT_7,
      FINSEQ_3, FINSEQ_5, TAXONOM1, RELAT_1, FUNCT_2, ENUMSET1, FINSEQ_2,
      XREAL_1, XXREAL_0, ORDINAL1;
 schemes NAT_1, FUNCT_2, XBOOLE_0;

begin
theorem
L1: (for B1 , B2 being  finite set holds ( ( card ( B1 \/ B2 ) ) + ( card ( B1 /\ B2 ) ) ) = ( ( card B1 ) + ( card B2 ) ))
proof
let C1 , C2 being  finite set;
L2: ( card ( C1 \/ C2 ) ) = ( ( ( card C1 ) + ( card C2 ) ) - ( card ( C1 /\ C2 ) ) ) by CARD_2:45;
thus L3: thesis by L2;
end;
scheme Regr11 { F1() -> (Element of ( NAT )) , P1[set] } : (for B3 being (Element of ( NAT )) holds ((1 <= B3 & B3 <= F1()) implies P1[ B3 ]))
provided
L4: (P1[ F1() ] & F1() >= 2)
and
L5: (for B4 being (Element of ( NAT )) holds ((1 <= B4 & B4 < F1() & P1[ ( B4 + 1 ) ]) implies P1[ B4 ]))
proof
defpred S1[ Nat ] means (1 <= $1 & $1 <= F1() & (not P1[ $1 ]));
assume L6: (ex B5 being (Element of ( NAT )) st S1[ B5 ]);
L7: (ex B6 being Nat st S1[ B6 ]) by L6;
L8: (for B7 being Nat holds (S1[ B7 ] implies B7 <= F1()));
consider C3 being Nat such that L9: S1[ C3 ] and L10: (for B8 being Nat holds (S1[ B8 ] implies B8 <= C3)) from NAT_1:sch 6(L8 , L7);
L11: ( C3 + 1 ) >= 1 by NAT_1:12;
L12: C3 < F1() by L4 , L9 , XXREAL_0:1;
L13: ( C3 + 1 ) <= F1() by L12 , NAT_1:13;
L14:
now
assume L15: (not P1[ ( C3 + 1 ) ]);
L16: ( C3 + 1 ) <= C3 by L15 , L10 , L13 , L11;
thus L17: contradiction by L16 , XREAL_1:29;
end;
L18: C3 in ( NAT ) by ORDINAL1:def 12;
thus L19: contradiction by L18 , L5 , L9 , L12 , L14;
end;
scheme Regr2 { P2[set] } : P2[ 1 ]
provided
L20: (ex B9 being (Element of ( NAT )) st (B9 > 1 & P2[ B9 ]))
and
L21: (for B10 being (Element of ( NAT )) holds ((B10 >= 1 & P2[ ( B10 + 1 ) ]) implies P2[ B10 ]))
proof
consider C4 being (Element of ( NAT )) such that L22: C4 > 1 and L23: P2[ C4 ] by L20;
L24: C4 >= ( 1 + 1 ) by L22 , NAT_1:13;
L25: (P2[ C4 ] & C4 >= 2) by L24 , L23;
L26: (for B11 being (Element of ( NAT )) holds ((1 <= B11 & B11 < C4 & P2[ ( B11 + 1 ) ]) implies P2[ B11 ])) by L21;
L27: (for B12 being (Element of ( NAT )) holds ((1 <= B12 & B12 <= C4) implies P2[ B12 ])) from Regr11(L25 , L26);
thus L28: thesis by L27 , L22;
end;
registration
let C5 being non  empty set;
cluster non  empty  non-empty for (FinSequence of ( bool C5 ));
existence
proof
set D1 = the non  empty (Subset of C5);
take D2 = <* D1 *>;
thus L29: D2 is non  empty;
L30: ( rng D2 ) = { D1 } by FINSEQ_1:39;
L31: (not ( {} ) in ( rng D2 )) by L30 , TARSKI:def 1;
thus L32: thesis by L31 , RELAT_1:def 9;
end;
end;
theorem
L34: (for B13 being non  empty set holds (for B14 being  non-empty (FinSequence of ( bool B13 )) holds (for B15 being (Element of ( NAT )) holds (B15 in ( dom B14 ) implies ( B14 . B15 ) <> ( {} )))))
proof
let C6 being non  empty set;
let C7 being  non-empty (FinSequence of ( bool C6 ));
let C8 being (Element of ( NAT ));
assume L35: C8 in ( dom C7 );
assume L36: ( C7 . C8 ) = ( {} );
L37: ( {} ) in ( rng C7 ) by L36 , L35 , FUNCT_1:3;
thus L38: thesis by L37 , RELAT_1:def 9;
end;
registration
let C9 being  finite set;
let C10 being (FinSequence of ( bool C9 ));
let C11 being (Element of ( NAT ));
cluster ( C10 . C11 ) ->  finite;
coherence
proof
per cases ;
suppose L39: C11 in ( dom C10 );

L40: ( C10 . C11 ) in ( bool C9 ) by L39 , PARTFUN1:4;
thus L41: thesis by L40;
end;
suppose L42: (not C11 in ( dom C10 ));

thus L43: thesis by L42 , FUNCT_1:def 2;
end;
end;
end;
begin
definition
let C12 being set;
let C13 being (FinSequence of ( bool C12 ));
let C14 being set;
func union (C13 , C14) -> set means 
:L46: (for B16 being set holds (B16 in it iff (ex B17 being set st (B17 in C14 & B17 in ( dom C13 ) & B16 in ( C13 . B17 )))));
existence
proof
defpred S2[ set ] means (ex B18 being set st (B18 in C14 & B18 in ( dom C13 ) & $1 in ( C13 . B18 )));
consider C15 being set such that L47: (for B19 being set holds (B19 in C15 iff (B19 in C12 & S2[ B19 ]))) from XBOOLE_0:sch 1;
take C15;
let C16 being set;
thus L48: (C16 in C15 implies (ex B20 being set st (B20 in C14 & B20 in ( dom C13 ) & C16 in ( C13 . B20 )))) by L47;
given C17 being set such that
L49: C17 in C14
and
L50: C17 in ( dom C13 )
and
L51: C16 in ( C13 . C17 );

L52: (( rng C13 ) c= ( bool C12 ) & ( C13 . C17 ) in ( rng C13 )) by L50 , FINSEQ_1:def 4 , FUNCT_1:3;
thus L53: thesis by L52 , L47 , L49 , L50 , L51;
end;
uniqueness
proof
defpred S3[ set ] means (ex B21 being set st (B21 in C14 & B21 in ( dom C13 ) & $1 in ( C13 . B21 )));
let C18 , C19 being set;
assume that
L54: (for B22 being set holds (B22 in C18 iff (ex B23 being set st (B23 in C14 & B23 in ( dom C13 ) & B22 in ( C13 . B23 )))))
and
L55: (for B24 being set holds (B24 in C19 iff (ex B25 being set st (B25 in C14 & B25 in ( dom C13 ) & B24 in ( C13 . B25 )))));
L56: (for B26 being set holds (B26 in C19 iff S3[ B26 ])) by L55;
L57: (for B27 being set holds (B27 in C18 iff S3[ B27 ])) by L54;
L58: C18 = C19 from XBOOLE_0:sch 2(L57 , L56);
thus L59: thesis by L58;
end;
end;
theorem
L61: (for B28 being set holds (for B29 being (FinSequence of ( bool B28 )) holds (for B30 being set holds ( union (B29 , B30) ) c= B28)))
proof
let C20 being set;
let C21 being (FinSequence of ( bool C20 ));
let C22 being set;
let C23 being set;
assume L62: C23 in ( union (C21 , C22) );
consider C24 being set such that L63: C24 in C22 and L64: C24 in ( dom C21 ) and L65: C23 in ( C21 . C24 ) by L62 , L46;
L66: (( rng C21 ) c= ( bool C20 ) & ( C21 . C24 ) in ( rng C21 )) by L64 , FINSEQ_1:def 4 , FUNCT_1:3;
thus L67: thesis by L66 , L65;
end;
theorem
L68: (for B31 being  finite set holds (for B32 being (FinSequence of ( bool B31 )) holds (for B33 , B34 being set holds (B33 c= B34 implies ( union (B32 , B33) ) c= ( union (B32 , B34) )))))
proof
let C25 being  finite set;
let C26 being (FinSequence of ( bool C25 ));
let C27 , C28 being set;
assume L69: C27 c= C28;
thus L70: ( union (C26 , C27) ) c= ( union (C26 , C28) )
proof
let C29 being set;
assume L71: C29 in ( union (C26 , C27) );
L72: (ex B35 being set st (B35 in C27 & B35 in ( dom C26 ) & C29 in ( C26 . B35 ))) by L71 , L46;
thus L73: thesis by L72 , L69 , L46;
end;

end;
registration
let C30 being  finite set;
let C31 being (FinSequence of ( bool C30 ));
let C32 being set;
cluster ( union (C31 , C32) ) ->  finite;
coherence by L61 , FINSET_1:1;
end;
theorem
L72: (for B36 being  finite set holds (for B37 being (FinSequence of ( bool B36 )) holds (for B38 being (Element of ( NAT )) holds (B38 in ( dom B37 ) implies ( union (B37 , { B38 }) ) = ( B37 . B38 )))))
proof
let C33 being  finite set;
let C34 being (FinSequence of ( bool C33 ));
let C35 being (Element of ( NAT ));
assume that
L73: C35 in ( dom C34 );
thus L74: ( union (C34 , { C35 }) ) c= ( C34 . C35 )
proof
let C36 being set;
assume L75: C36 in ( union (C34 , { C35 }) );
L76: (ex B39 being set st (B39 in { C35 } & B39 in ( dom C34 ) & C36 in ( C34 . B39 ))) by L75 , L46;
thus L77: thesis by L76 , TARSKI:def 1;
end;

thus L78: ( C34 . C35 ) c= ( union (C34 , { C35 }) )
proof
let C37 being set;
L79: C35 in { C35 } by TARSKI:def 1;
assume L80: C37 in ( C34 . C35 );
thus L81: thesis by L80 , L73 , L79 , L46;
end;

end;
theorem
L79: (for B40 being  finite set holds (for B41 being (FinSequence of ( bool B40 )) holds (for B42 , B43 being (Element of ( NAT )) holds ((B42 in ( dom B41 ) & B43 in ( dom B41 )) implies ( union (B41 , { B42 , B43 }) ) = ( ( B41 . B42 ) \/ ( B41 . B43 ) )))))
proof
let C38 being  finite set;
let C39 being (FinSequence of ( bool C38 ));
let C40 , C41 being (Element of ( NAT ));
assume that
L80: C40 in ( dom C39 )
and
L81: C41 in ( dom C39 );
thus L82: ( union (C39 , { C40 , C41 }) ) c= ( ( C39 . C40 ) \/ ( C39 . C41 ) )
proof
let C42 being set;
assume L83: C42 in ( union (C39 , { C40 , C41 }) );
consider C43 being set such that L84: (C43 in { C40 , C41 } & C43 in ( dom C39 ) & C42 in ( C39 . C43 )) by L83 , L46;
per cases  by L84 , TARSKI:def 2;
suppose L85: (C43 = C40 & C43 in ( dom C39 ) & C42 in ( C39 . C43 ));

thus L86: thesis by L85 , XBOOLE_0:def 3;
end;
suppose L87: (C43 = C41 & C43 in ( dom C39 ) & C42 in ( C39 . C43 ));

thus L88: thesis by L87 , XBOOLE_0:def 3;
end;
end;

thus L90: ( ( C39 . C40 ) \/ ( C39 . C41 ) ) c= ( union (C39 , { C40 , C41 }) )
proof
let C44 being set;
assume L91: C44 in ( ( C39 . C40 ) \/ ( C39 . C41 ) );
per cases  by L91 , XBOOLE_0:def 3;
suppose L92: C44 in ( C39 . C40 );

L93: C40 in { C40 , C41 } by TARSKI:def 2;
thus L94: thesis by L93 , L80 , L92 , L46;
end;
suppose L95: C44 in ( C39 . C41 );

L96: C41 in { C40 , C41 } by TARSKI:def 2;
thus L97: thesis by L96 , L81 , L95 , L46;
end;
end;

end;
theorem
L91: (for B44 being set holds (for B45 being  finite set holds (for B46 being (FinSequence of ( bool B45 )) holds (for B47 being (Element of ( NAT )) holds ((B47 in B44 & B47 in ( dom B46 )) implies ( B46 . B47 ) c= ( union (B46 , B44) ))))))
proof
let C45 being set;
let C46 being  finite set;
let C47 being (FinSequence of ( bool C46 ));
let C48 being (Element of ( NAT ));
assume that
L92: (C48 in C45 & C48 in ( dom C47 ));
let C49 being set;
assume L93: C49 in ( C47 . C48 );
thus L94: thesis by L93 , L92 , L46;
end;
theorem
L95: (for B48 being set holds (for B49 being  finite set holds (for B50 being (Element of ( NAT )) holds (for B51 being (FinSequence of ( bool B49 )) holds ((B50 in B48 & B50 in ( dom B51 )) implies ( union (B51 , B48) ) = ( ( union (B51 , ( B48 \ { B50 } )) ) \/ ( B51 . B50 ) ))))))
proof
let C50 being set;
let C51 being  finite set;
let C52 being (Element of ( NAT ));
let C53 being (FinSequence of ( bool C51 ));
assume L96: (C52 in C50 & C52 in ( dom C53 ));
L97: ( C53 . C52 ) c= ( union (C53 , C50) ) by L96 , L91;
thus L98: ( union (C53 , C50) ) c= ( ( union (C53 , ( C50 \ { C52 } )) ) \/ ( C53 . C52 ) )
proof
let C54 being set;
assume L99: C54 in ( union (C53 , C50) );
consider C55 being set such that L100: C55 in C50 and L101: C55 in ( dom C53 ) and L102: C54 in ( C53 . C55 ) by L99 , L46;
per cases ;
suppose L103: C52 = C55;

thus L104: thesis by L103 , L102 , XBOOLE_0:def 3;
end;
suppose L105: C52 <> C55;

L106: (not C55 in { C52 }) by L105 , TARSKI:def 1;
L107: C55 in ( C50 \ { C52 } ) by L106 , L100 , XBOOLE_0:def 5;
L108: C54 in ( union (C53 , ( C50 \ { C52 } )) ) by L107 , L101 , L102 , L46;
thus L109: thesis by L108 , XBOOLE_0:def 3;
end;
end;

thus L111: ( ( union (C53 , ( C50 \ { C52 } )) ) \/ ( C53 . C52 ) ) c= ( union (C53 , C50) )
proof
let C56 being set;
assume L112: C56 in ( ( union (C53 , ( C50 \ { C52 } )) ) \/ ( C53 . C52 ) );
L113: (C56 in ( union (C53 , ( C50 \ { C52 } )) ) or C56 in ( C53 . C52 )) by L112 , XBOOLE_0:def 3;
per cases  by L97 , L113;
suppose L114: C56 in ( union (C53 , ( C50 \ { C52 } )) );

L115: (ex B52 being set st (B52 in ( C50 \ { C52 } ) & B52 in ( dom C53 ) & C56 in ( C53 . B52 ))) by L114 , L46;
thus L116: thesis by L115 , L46;
end;
suppose L117: C56 in ( union (C53 , C50) );

thus L118: thesis by L117;
end;
end;

end;
theorem
L112: (for B53 , B54 being set holds (for B55 being  finite set holds (for B56 being (Element of ( NAT )) holds (for B57 being (FinSequence of ( bool B55 )) holds (B56 in ( dom B57 ) implies ( union (B57 , ( ( { B56 } \/ B53 ) \/ B54 )) ) = ( ( B57 . B56 ) \/ ( union (B57 , ( B53 \/ B54 )) ) ))))))
proof
let C57 , C58 being set;
let C59 being  finite set;
let C60 being (Element of ( NAT ));
let C61 being (FinSequence of ( bool C59 ));
assume L113: C60 in ( dom C61 );
L114: ( union (C61 , { C60 }) ) = ( C61 . C60 ) by L113 , L72;
thus L115: ( union (C61 , ( ( { C60 } \/ C57 ) \/ C58 )) ) c= ( ( C61 . C60 ) \/ ( union (C61 , ( C57 \/ C58 )) ) )
proof
let C62 being set;
assume L116: C62 in ( union (C61 , ( ( { C60 } \/ C57 ) \/ C58 )) );
consider C63 being set such that L117: C63 in ( ( { C60 } \/ C57 ) \/ C58 ) and L118: C63 in ( dom C61 ) and L119: C62 in ( C61 . C63 ) by L116 , L46;
per cases ;
suppose L120: C60 = C63;

thus L121: thesis by L120 , L119 , XBOOLE_0:def 3;
end;
suppose L122: C60 <> C63;

L123: C63 in ( { C60 } \/ ( C57 \/ C58 ) ) by L117 , XBOOLE_1:4;
L124: (C63 in { C60 } or C63 in ( C57 \/ C58 )) by L123 , XBOOLE_0:def 3;
L125: C62 in ( union (C61 , ( C57 \/ C58 )) ) by L124 , L118 , L119 , L122 , L46 , TARSKI:def 1;
thus L126: thesis by L125 , XBOOLE_0:def 3;
end;
end;

thus L128: ( ( C61 . C60 ) \/ ( union (C61 , ( C57 \/ C58 )) ) ) c= ( union (C61 , ( ( { C60 } \/ C57 ) \/ C58 )) )
proof
let C64 being set;
assume L129: C64 in ( ( C61 . C60 ) \/ ( union (C61 , ( C57 \/ C58 )) ) );
per cases  by L114 , L129 , XBOOLE_0:def 3;
suppose L130: C64 in ( union (C61 , { C60 }) );

consider C65 being set such that L131: C65 in { C60 } and L132: (C65 in ( dom C61 ) & C64 in ( C61 . C65 )) by L130 , L46;
L133: C65 in ( { C60 } \/ ( C57 \/ C58 ) ) by L131 , XBOOLE_0:def 3;
L134: C65 in ( ( { C60 } \/ C57 ) \/ C58 ) by L133 , XBOOLE_1:4;
thus L135: thesis by L134 , L132 , L46;
end;
suppose L136: C64 in ( union (C61 , ( C57 \/ C58 )) );

consider C66 being set such that L137: C66 in ( C57 \/ C58 ) and L138: (C66 in ( dom C61 ) & C64 in ( C61 . C66 )) by L136 , L46;
L139: C66 in ( { C60 } \/ ( C57 \/ C58 ) ) by L137 , XBOOLE_0:def 3;
L140: C66 in ( ( { C60 } \/ C57 ) \/ C58 ) by L139 , XBOOLE_1:4;
thus L141: thesis by L140 , L138 , L46;
end;
end;

end;
theorem
L129: (for B58 being  finite set holds (for B59 being (FinSequence of ( bool B58 )) holds (for B60 being (Element of ( NAT )) holds (for B61 , B62 being set holds ((B61 <> B62 & B61 in ( B59 . B60 ) & B62 in ( B59 . B60 )) implies ( ( ( B59 . B60 ) \ { B61 } ) \/ ( ( B59 . B60 ) \ { B62 } ) ) = ( B59 . B60 ))))))
proof
let C67 being  finite set;
let C68 being (FinSequence of ( bool C67 ));
let C69 being (Element of ( NAT ));
let C70 , C71 being set;
assume that
L130: C70 <> C71
and
L131: C70 in ( C68 . C69 )
and
L132: C71 in ( C68 . C69 );
L133: ( C68 . C69 ) c= ( ( ( C68 . C69 ) \ { C70 } ) \/ ( ( C68 . C69 ) \ { C71 } ) )
proof
L134: ( {} ) = ( { C71 } \ ( { C71 } \/ ( {} ) ) ) by XBOOLE_1:46;
L135: ( C68 . C69 ) = ( ( C68 . C69 ) \ ( { C71 } \ { C71 } ) ) by L134;
L136: ( C68 . C69 ) = ( ( ( C68 . C69 ) \ { C71 } ) \/ ( ( C68 . C69 ) /\ { C71 } ) ) by L135 , XBOOLE_1:52;
L137: ( C68 . C69 ) = ( ( ( C68 . C69 ) \ { C71 } ) \/ { C71 } ) by L136 , L132 , ZFMISC_1:46;
let C72 being set;
L138: (not C70 in { C71 }) by L130 , TARSKI:def 1;
L139: C70 in ( ( C68 . C69 ) \ { C71 } ) by L138 , L131 , XBOOLE_0:def 5;
assume L140: C72 in ( C68 . C69 );
L141: C72 in ( ( ( ( C68 . C69 ) \ { C70 } ) \/ { C70 } ) \/ ( ( ( C68 . C69 ) \ { C71 } ) \/ { C71 } ) ) by L140 , L137 , XBOOLE_0:def 3;
L142: C72 in ( ( ( C68 . C69 ) \ { C70 } ) \/ ( { C70 } \/ ( { C71 } \/ ( ( C68 . C69 ) \ { C71 } ) ) ) ) by L141 , XBOOLE_1:4;
L143: C72 in ( ( ( C68 . C69 ) \ { C70 } ) \/ ( ( { C70 } \/ { C71 } ) \/ ( ( C68 . C69 ) \ { C71 } ) ) ) by L142 , XBOOLE_1:4;
L144: C72 in ( ( ( ( C68 . C69 ) \ { C70 } ) \/ ( { C71 } \/ { C70 } ) ) \/ ( ( C68 . C69 ) \ { C71 } ) ) by L143 , XBOOLE_1:4;
L145: C72 in ( ( ( ( ( C68 . C69 ) \ { C70 } ) \/ { C71 } ) \/ { C70 } ) \/ ( ( C68 . C69 ) \ { C71 } ) ) by L144 , XBOOLE_1:4;
L146: C72 in ( ( ( ( C68 . C69 ) \ { C70 } ) \/ { C71 } ) \/ ( { C70 } \/ ( ( C68 . C69 ) \ { C71 } ) ) ) by L145 , XBOOLE_1:4;
L147: (not C71 in { C70 }) by L130 , TARSKI:def 1;
L148: C71 in ( ( C68 . C69 ) \ { C70 } ) by L147 , L132 , XBOOLE_0:def 5;
L149: C72 in ( ( ( C68 . C69 ) \ { C70 } ) \/ ( { C70 } \/ ( ( C68 . C69 ) \ { C71 } ) ) ) by L148 , L146 , ZFMISC_1:40;
thus L150: thesis by L149 , L139 , ZFMISC_1:40;
end;
thus L151: thesis by L133 , XBOOLE_0:def 10;
end;
begin
definition
let C73 being  finite set;
let C74 being (FinSequence of ( bool C73 ));
let C75 being (Element of ( NAT ));
let C76 being set;
func Cut (C74 , C75 , C76) -> (FinSequence of ( bool C73 )) means 
:L152: (( dom it ) = ( dom C74 ) & (for B63 being (Element of ( NAT )) holds (B63 in ( dom it ) implies ((C75 = B63 implies ( it . B63 ) = ( ( C74 . B63 ) \ { C76 } )) & (C75 <> B63 implies ( it . B63 ) = ( C74 . B63 ))))));
existence
proof
L153: ( C74 . C75 ) c= C73
proof
per cases ;
suppose L154: C75 in ( dom C74 );

L155: ( C74 . C75 ) in ( bool C73 ) by L154 , FINSEQ_2:11;
thus L156: thesis by L155;
end;
suppose L157: (not C75 in ( dom C74 ));

L158: ( C74 . C75 ) = ( {} ) by L157 , FUNCT_1:def 2;
thus L159: thesis by L158 , XBOOLE_1:2;
end;
end;
reconsider D3 = ( ( C74 . C75 ) \ { C76 } ) as (Subset of C73) by L153 , XBOOLE_1:1;
set D4 = ( C74 +* (C75 , D3) );
reconsider D5 = D4 as (FinSequence of ( bool C73 ));
take D5;
L161: ( dom D5 ) = ( dom C74 ) by FUNCT_7:30;
thus L162: thesis by L161 , FUNCT_7:31 , FUNCT_7:32;
end;
uniqueness
proof
let C77 , C78 being (FinSequence of ( bool C73 ));
assume that
L163: ( dom C77 ) = ( dom C74 )
and
L164: (for B64 being (Element of ( NAT )) holds (B64 in ( dom C77 ) implies ((C75 = B64 implies ( C77 . B64 ) = ( ( C74 . B64 ) \ { C76 } )) & (C75 <> B64 implies ( C77 . B64 ) = ( C74 . B64 )))))
and
L165: ( dom C78 ) = ( dom C74 )
and
L166: (for B65 being (Element of ( NAT )) holds (B65 in ( dom C78 ) implies ((C75 = B65 implies ( C78 . B65 ) = ( ( C74 . B65 ) \ { C76 } )) & (C75 <> B65 implies ( C78 . B65 ) = ( C74 . B65 )))));
L167: (for B66 being Nat holds (B66 in ( dom C77 ) implies ( C77 . B66 ) = ( C78 . B66 )))
proof
let C79 being Nat;
assume L168: C79 in ( dom C77 );
per cases ;
suppose L169: C79 = C75;

L170: ( C77 . C79 ) = ( ( C74 . C75 ) \ { C76 } ) by L169 , L164 , L168
.= ( C78 . C79 ) by L163 , L165 , L166 , L168 , L169;
thus L171: thesis by L170;
end;
suppose L172: C79 <> C75;

L173: ( C77 . C79 ) = ( C74 . C79 ) by L172 , L164 , L168
.= ( C78 . C79 ) by L163 , L165 , L166 , L168 , L172;
thus L174: thesis by L173;
end;
end;
thus L176: thesis by L167 , L163 , L165 , FINSEQ_1:13;
end;
end;
theorem
L178: (for B67 being  finite set holds (for B68 being (FinSequence of ( bool B67 )) holds (for B69 being (Element of ( NAT )) holds (for B70 being set holds ((B69 in ( dom B68 ) & B70 in ( B68 . B69 )) implies ( card ( ( Cut (B68 , B69 , B70) ) . B69 ) ) = ( ( card ( B68 . B69 ) ) - 1 ))))))
proof
let C80 being  finite set;
let C81 being (FinSequence of ( bool C80 ));
let C82 being (Element of ( NAT ));
let C83 being set;
set D6 = ( Cut (C81 , C82 , C83) );
assume that
L179: C82 in ( dom C81 )
and
L180: C83 in ( C81 . C82 );
L181: C82 in ( dom D6 ) by L179 , L152;
L182: ( D6 . C82 ) = ( ( C81 . C82 ) \ { C83 } ) by L181 , L152;
L183: { C83 } c= ( C81 . C82 ) by L180 , ZFMISC_1:31;
L184: ( card ( D6 . C82 ) ) = ( ( card ( C81 . C82 ) ) - ( card { C83 } ) ) by L183 , L182 , CARD_2:44
.= ( ( card ( C81 . C82 ) ) - 1 ) by CARD_2:42;
thus L185: thesis by L184;
end;
theorem
L186: (for B71 being  finite set holds (for B72 being (FinSequence of ( bool B71 )) holds (for B73 being (Element of ( NAT )) holds (for B74 , B75 being set holds ( union (( Cut (B72 , B73 , B74) ) , ( B75 \ { B73 } )) ) = ( union (B72 , ( B75 \ { B73 } )) )))))
proof
let C84 being  finite set;
let C85 being (FinSequence of ( bool C84 ));
let C86 being (Element of ( NAT ));
let C87 , C88 being set;
thus L187: ( union (( Cut (C85 , C86 , C87) ) , ( C88 \ { C86 } )) ) c= ( union (C85 , ( C88 \ { C86 } )) )
proof
let C89 being set;
assume L188: C89 in ( union (( Cut (C85 , C86 , C87) ) , ( C88 \ { C86 } )) );
consider C90 being set such that L189: C90 in ( C88 \ { C86 } ) and L190: C90 in ( dom ( Cut (C85 , C86 , C87) ) ) and L191: C89 in ( ( Cut (C85 , C86 , C87) ) . C90 ) by L188 , L46;
L192: (not C90 in { C86 }) by L189 , XBOOLE_0:def 5;
L193: C86 <> C90 by L192 , TARSKI:def 1;
L194: C89 in ( C85 . C90 ) by L193 , L190 , L191 , L152;
L195: C90 in ( dom C85 ) by L190 , L152;
thus L196: thesis by L195 , L189 , L194 , L46;
end;

L197: ( dom ( Cut (C85 , C86 , C87) ) ) = ( dom C85 ) by L152;
thus L198: ( union (C85 , ( C88 \ { C86 } )) ) c= ( union (( Cut (C85 , C86 , C87) ) , ( C88 \ { C86 } )) )
proof
let C91 being set;
assume L199: C91 in ( union (C85 , ( C88 \ { C86 } )) );
consider C92 being set such that L200: C92 in ( C88 \ { C86 } ) and L201: C92 in ( dom C85 ) and L202: C91 in ( C85 . C92 ) by L199 , L46;
L203: (not C92 in { C86 }) by L200 , XBOOLE_0:def 5;
L204: C86 <> C92 by L203 , TARSKI:def 1;
L205: ( ( Cut (C85 , C86 , C87) ) . C92 ) = ( C85 . C92 ) by L204 , L197 , L201 , L152;
thus L206: thesis by L205 , L197 , L200 , L201 , L202 , L46;
end;

end;
theorem
L199: (for B76 being  finite set holds (for B77 being (FinSequence of ( bool B76 )) holds (for B78 being (Element of ( NAT )) holds (for B79 , B80 being set holds ((not B78 in B80) implies ( union (B77 , B80) ) = ( union (( Cut (B77 , B78 , B79) ) , B80) ))))))
proof
let C93 being  finite set;
let C94 being (FinSequence of ( bool C93 ));
let C95 being (Element of ( NAT ));
let C96 , C97 being set;
assume L200: (not C95 in C97);
thus L201: ( union (C94 , C97) ) c= ( union (( Cut (C94 , C95 , C96) ) , C97) )
proof
let C98 being set;
assume L202: C98 in ( union (C94 , C97) );
consider C99 being set such that L203: C99 in C97 and L204: C99 in ( dom C94 ) and L205: C98 in ( C94 . C99 ) by L202 , L46;
L206: C99 in ( dom ( Cut (C94 , C95 , C96) ) ) by L204 , L152;
per cases ;
suppose L207: C95 = C99;

thus L208: thesis by L207 , L200 , L203;
end;
suppose L209: C95 <> C99;

L210: ( ( Cut (C94 , C95 , C96) ) . C99 ) = ( C94 . C99 ) by L209 , L206 , L152;
thus L211: thesis by L210 , L203 , L205 , L206 , L46;
end;
end;

let C100 being set;
assume L213: C100 in ( union (( Cut (C94 , C95 , C96) ) , C97) );
consider C101 being set such that L214: C101 in C97 and L215: C101 in ( dom ( Cut (C94 , C95 , C96) ) ) and L216: C100 in ( ( Cut (C94 , C95 , C96) ) . C101 ) by L213 , L46;
L217: C101 in ( dom C94 ) by L215 , L152;
per cases ;
suppose L218: C95 = C101;

thus L219: thesis by L218 , L200 , L214;
end;
suppose L220: C95 <> C101;

L221: ( ( Cut (C94 , C95 , C96) ) . C101 ) = ( C94 . C101 ) by L220 , L215 , L152;
thus L222: thesis by L221 , L214 , L216 , L217 , L46;
end;
end;
theorem
L224: (for B81 being  finite set holds (for B82 being (FinSequence of ( bool B81 )) holds (for B83 being (Element of ( NAT )) holds (for B84 , B85 being set holds ((B83 in ( dom ( Cut (B82 , B83 , B84) ) ) & B83 in B85) implies ( union (( Cut (B82 , B83 , B84) ) , B85) ) = ( ( union (B82 , ( B85 \ { B83 } )) ) \/ ( ( B82 . B83 ) \ { B84 } ) ))))))
proof
let C102 being  finite set;
let C103 being (FinSequence of ( bool C102 ));
let C104 being (Element of ( NAT ));
let C105 , C106 being set;
assume that
L225: C104 in ( dom ( Cut (C103 , C104 , C105) ) )
and
L226: C104 in C106;
L227: ( union (( Cut (C103 , C104 , C105) ) , C106) ) = ( ( union (( Cut (C103 , C104 , C105) ) , ( C106 \ { C104 } )) ) \/ ( ( Cut (C103 , C104 , C105) ) . C104 ) ) by L225 , L226 , L95
.= ( ( union (C103 , ( C106 \ { C104 } )) ) \/ ( ( Cut (C103 , C104 , C105) ) . C104 ) ) by L186
.= ( ( union (C103 , ( C106 \ { C104 } )) ) \/ ( ( C103 . C104 ) \ { C105 } ) ) by L225 , L152;
thus L228: thesis by L227;
end;
begin
definition
let C107 being  finite set;
let C108 being (FinSequence of ( bool C107 ));
let C109 being set;
pred C109 is_a_system_of_different_representatives_of C108
means
:L229: (ex B86 being (FinSequence of C107) st (B86 = C109 & ( dom C108 ) = ( dom B86 ) & (for B87 being (Element of ( NAT )) holds (B87 in ( dom B86 ) implies ( B86 . B87 ) in ( C108 . B87 ))) & B86 is  one-to-one))
;end;
definition
let C110 being  finite set;
let C111 being (FinSequence of ( bool C110 ));
attr C111 is  Hall
means
:L231: (for B88 being  finite set holds (B88 c= ( dom C111 ) implies ( card B88 ) <= ( card ( union (C111 , B88) ) )));
end;
registration
let C112 being  finite non  empty set;
cluster  Hall non  empty for (FinSequence of ( bool C112 ));
existence
proof
set D7 = the (Element of C112);
reconsider D8 = { D7 } as (Element of ( bool C112 )) by ZFMISC_1:31;
reconsider D9 = <* D8 *> as (FinSequence of ( bool C112 ));
L233: (for B89 being  finite set holds (B89 c= ( dom D9 ) implies ( card B89 ) <= ( card ( union (D9 , B89) ) )))
proof
let C113 being  finite set;
assume L234: C113 c= ( dom D9 );
L235: ( dom D9 ) = { 1 } by FINSEQ_1:2 , FINSEQ_1:38;
L236: (C113 = ( {} ) or C113 = { 1 }) by L235 , L234 , ZFMISC_1:33;
per cases  by L236;
suppose L237: C113 = ( {} );

L238: ( card C113 ) = ( 0 ) by L237;
thus L239: thesis by L238 , NAT_1:2;
end;
suppose L240: C113 = { 1 };

L241: (1 in ( dom D9 ) & 1 in ( NAT )) by L235 , TARSKI:def 1;
L242: ( union (D9 , { 1 }) ) = ( D9 . 1 ) by L241 , L72
.= D8 by FINSEQ_1:40;
L243: ( card ( union (D9 , C113) ) ) = 1 by L242 , L240 , CARD_1:30;
thus L244: thesis by L243 , L240 , CARD_1:30;
end;
end;
L246: D9 is  Hall by L233 , L231;
thus L247: thesis by L246;
end;
end;
registration
let C114 being  finite set;
cluster  Hall for (FinSequence of ( bool C114 ));
existence
proof
reconsider D10 = ( <*> ( bool C114 ) ) as (FinSequence of ( bool C114 ));
L249: (for B90 being  finite set holds (B90 c= ( dom D10 ) implies ( card B90 ) <= ( card ( union (D10 , B90) ) )))
proof
let C115 being  finite set;
assume L250: C115 c= ( dom D10 );
L251: ( card C115 ) = ( 0 ) by L250;
thus L252: thesis by L251 , NAT_1:2;
end;
L253: D10 is  Hall by L249 , L231;
take D10;
thus L254: thesis by L253;
end;
end;
theorem
L256: (for B91 being  finite set holds (for B92 being non  empty (FinSequence of ( bool B91 )) holds (B92 is  Hall implies B92 is  non-empty)))
proof
let C116 being  finite set;
let C117 being non  empty (FinSequence of ( bool C116 ));
assume L257: C117 is  Hall;
assume L258: C117 is non  non-empty;
L259: ( {} ) in ( rng C117 ) by L258 , RELAT_1:def 9;
consider C118 being set such that L260: (C118 in ( dom C117 ) & ( C117 . C118 ) = ( {} )) by L259 , FUNCT_1:def 3;
set D11 = { C118 };
L261: ( card D11 ) = 1 by CARD_2:42;
L262: (D11 c= ( dom C117 ) & ( card ( union (C117 , D11) ) ) = ( 0 )) by L260 , L72 , CARD_1:27 , ZFMISC_1:31;
thus L263: thesis by L262 , L257 , L261 , L231;
end;
registration
let C119 being  finite set;
cluster  Hall ->  non-empty for non  empty non  empty non  empty non  empty (FinSequence of ( bool C119 ));
coherence by L256;
end;
theorem
L265: (for B93 being  finite set holds (for B94 being (FinSequence of ( bool B93 )) holds (for B95 being (Element of ( NAT )) holds ((B95 in ( dom B94 ) & B94 is  Hall) implies ( card ( B94 . B95 ) ) >= 1))))
proof
let C120 being  finite set;
let C121 being (FinSequence of ( bool C120 ));
let C122 being (Element of ( NAT ));
assume that
L266: C122 in ( dom C121 )
and
L267: C121 is  Hall;
set D12 = { C122 };
L268: D12 c= ( dom C121 ) by L266 , ZFMISC_1:31;
L269: ( card D12 ) <= ( card ( union (C121 , D12) ) ) by L268 , L267 , L231;
assume L270: ( card ( C121 . C122 ) ) < 1;
L271: ( union (C121 , D12) ) = ( C121 . C122 ) by L266 , L72;
thus L272: thesis by L271 , L270 , L269 , CARD_2:42;
end;
theorem
L273: (for B96 being non  empty  finite set holds (for B97 being non  empty (FinSequence of ( bool B96 )) holds (((for B98 being (Element of ( NAT )) holds (B98 in ( dom B97 ) implies ( card ( B97 . B98 ) ) = 1)) & B97 is  Hall) implies (ex B99 being set st B99 is_a_system_of_different_representatives_of B97))))
proof
let C123 being non  empty  finite set;
let C124 being non  empty (FinSequence of ( bool C123 ));
assume L274: (for B100 being (Element of ( NAT )) holds (B100 in ( dom C124 ) implies ( card ( C124 . B100 ) ) = 1));
reconsider D13 = ( dom C124 ) as non  empty set;
deffunc H1((Element of D13)) = ( C124 . $1 );
assume L275: C124 is  Hall;
L276: (for B101 being (Element of D13) holds C123 meets H1(B101))
proof
let C125 being (Element of D13);
set D14 = the (Element of ( C124 . C125 ));
L277: ( C124 . C125 ) <> ( {} ) by L275;
L278: D14 in ( C124 . C125 ) by L277;
L279: (( rng C124 ) c= ( bool C123 ) & ( C124 . C125 ) in ( rng C124 )) by FINSEQ_1:def 4 , FUNCT_1:3;
thus L280: thesis by L279 , L278 , XBOOLE_0:3;
end;
L281: (ex B102 being (Function of D13 , C123) st (for B103 being (Element of D13) holds ( B102 . B103 ) in H1(B103))) from FUNCT_2:sch 10(L276);
consider C126 being (Function of D13 , C123) such that L282: (for B104 being (Element of D13) holds ( C126 . B104 ) in H1(B104)) by L281;
L283: ( dom C126 ) = ( dom C124 ) by FUNCT_2:def 1;
L284: ( rng C126 ) c= C123
proof
let C127 being set;
L285: ( rng C124 ) c= ( bool C123 ) by FINSEQ_1:def 4;
assume L286: C127 in ( rng C126 );
consider C128 being set such that L287: C128 in ( dom C126 ) and L288: C127 = ( C126 . C128 ) by L286 , FUNCT_1:def 3;
L289: (( C126 . C128 ) in ( C124 . C128 ) & ( C124 . C128 ) in ( rng C124 )) by L282 , L283 , L287 , FUNCT_1:3;
thus L290: thesis by L289 , L288 , L285;
end;
L291: (ex B105 being Nat st ( dom C124 ) = ( Seg B105 )) by FINSEQ_1:def 2;
L292: C126 is FinSequence by L291 , L283 , FINSEQ_1:def 2;
reconsider D15 = C126 as (FinSequence of C123) by L292 , L284 , FINSEQ_1:def 4;
L293: ( dom C124 ) = ( dom D15 ) by FUNCT_2:def 1;
L294: ( card { ( {} ) } ) = 1 by CARD_1:30;
L295: (for B106 , B107 being (Element of ( NAT )) holds ((B106 in ( dom D15 ) & B107 in ( dom D15 ) & B106 <> B107) implies ( D15 . B106 ) <> ( D15 . B107 )))
proof
let C129 , C130 being (Element of ( NAT ));
assume that
L296: C129 in ( dom D15 )
and
L297: C130 in ( dom D15 )
and
L298: C129 <> C130;
thus L299: ( D15 . C129 ) <> ( D15 . C130 )
proof
L300: ( card ( C124 . C129 ) ) = ( card { ( {} ) } ) by L274 , L294 , L293 , L296;
consider C131 being set such that L301: ( C124 . C129 ) = { C131 } by L300 , CARD_1:29;
L302: ( C124 . C129 ) = { ( D15 . C129 ) }
proof
thus L303: ( C124 . C129 ) c= { ( D15 . C129 ) }
proof
let C132 being set;
assume L304: C132 in ( C124 . C129 );
L305: C132 = ( D15 . C129 )
proof
L306: ( D15 . C129 ) in ( C124 . C129 ) by L282 , L283 , L296;
L307: ( D15 . C129 ) = C131 by L306 , L301 , TARSKI:def 1;
assume L308: C132 <> ( D15 . C129 );
thus L309: thesis by L308 , L301 , L304 , L307 , TARSKI:def 1;
end;
thus L310: thesis by L305 , TARSKI:def 1;
end;

let C133 being set;
assume L311: C133 in { ( D15 . C129 ) };
L312: C133 = ( D15 . C129 ) by L311 , TARSKI:def 1;
thus L313: thesis by L312 , L282 , L283 , L296;
end;
L314: C130 in ( dom C124 ) by L297 , FUNCT_2:def 1;
L315: ( card ( C124 . C130 ) ) = ( card { ( {} ) } ) by L314 , L274 , L294;
consider C134 being set such that L316: ( C124 . C130 ) = { C134 } by L315 , CARD_1:29;
L317: ( C124 . C130 ) = { ( D15 . C130 ) }
proof
thus L318: ( C124 . C130 ) c= { ( D15 . C130 ) }
proof
let C135 being set;
assume L319: C135 in ( C124 . C130 );
L320: C135 = ( D15 . C130 )
proof
L321: ( D15 . C130 ) in ( C124 . C130 ) by L282 , L283 , L297;
L322: ( D15 . C130 ) = C134 by L321 , L316 , TARSKI:def 1;
assume L323: C135 <> ( D15 . C130 );
thus L324: thesis by L323 , L316 , L319 , L322 , TARSKI:def 1;
end;
thus L325: thesis by L320 , TARSKI:def 1;
end;

let C136 being set;
assume L326: C136 in { ( D15 . C130 ) };
L327: C136 = ( D15 . C130 ) by L326 , TARSKI:def 1;
thus L328: thesis by L327 , L282 , L283 , L297;
end;
set D16 = { C129 , C130 };
assume L329: ( D15 . C129 ) = ( D15 . C130 );
L330: { ( D15 . C129 ) , ( D15 . C130 ) } = { ( D15 . C129 ) } by L329 , ENUMSET1:29;
L331: ( card D16 ) = 2 by L298 , CARD_2:57;
L332: C129 in ( dom C124 ) by L296 , FUNCT_2:def 1;
L333: D16 c= ( dom C124 ) by L332 , L314 , ZFMISC_1:32;
L334: ( card ( union (C124 , D16) ) ) = ( card ( ( C124 . C129 ) \/ ( C124 . C130 ) ) ) by L332 , L314 , L79
.= ( card { ( D15 . C129 ) , ( D15 . C130 ) } ) by L302 , L317 , ENUMSET1:1
.= 1 by L330 , CARD_1:30;
thus L335: contradiction by L334 , L275 , L331 , L333 , L231;
end;

end;
L300: (for B108 , B109 being set holds ((B108 in ( dom D15 ) & B109 in ( dom D15 ) & ( D15 . B108 ) = ( D15 . B109 )) implies B108 = B109)) by L295;
L301: D15 is  one-to-one by L300 , FUNCT_1:def 4;
L302: (for B110 being (Element of ( NAT )) holds (B110 in ( dom D15 ) implies ( D15 . B110 ) in ( C124 . B110 ))) by L282 , L283;
L303: D15 is_a_system_of_different_representatives_of C124 by L302 , L293 , L301 , L229;
thus L304: thesis by L303;
end;
theorem
L305: (for B111 being  finite set holds (for B112 being (FinSequence of ( bool B111 )) holds ((ex B113 being set st B113 is_a_system_of_different_representatives_of B112) implies B112 is  Hall)))
proof
let C137 being  finite set;
let C138 being (FinSequence of ( bool C137 ));
given C139 being set such that
L306: C139 is_a_system_of_different_representatives_of C138;

consider C140 being (FinSequence of C137) such that L307: C140 = C139 and L308: ( dom C138 ) = ( dom C140 ) and L309: (for B114 being (Element of ( NAT )) holds (B114 in ( dom C140 ) implies ( C140 . B114 ) in ( C138 . B114 ))) and L310: C140 is  one-to-one by L306 , L229;
L311: (for B115 being  finite set holds (B115 c= ( dom C138 ) implies ( card B115 ) <= ( card ( union (C138 , B115) ) )))
proof
let C141 being  finite set;
set D17 = C141;
set D18 = ( union (C138 , C141) );
set D19 = ( C140 | D17 );
assume L312: C141 c= ( dom C138 );
L313: ( dom D19 ) = D17 by L312 , L308 , RELAT_1:62;
L314: ( dom D19 ) c= ( dom C140 ) by RELAT_1:60;
L315: ( rng D19 ) c= D18
proof
let C142 being set;
assume L316: C142 in ( rng D19 );
consider C143 being set such that L317: C143 in ( dom D19 ) and L318: C142 = ( D19 . C143 ) by L316 , FUNCT_1:def 3;
L319: C143 in ( dom C140 ) by L314 , L317;
reconsider D20 = C143 as (Element of ( NAT )) by L319;
L320: ( C140 . D20 ) in ( C138 . D20 ) by L308 , L309 , L312 , L313 , L317;
L321: ( D19 . D20 ) in ( C138 . D20 ) by L320 , L317 , FUNCT_1:47;
thus L322: thesis by L321 , L312 , L313 , L317 , L318 , L46;
end;
L323: D19 is  one-to-one by L310 , FUNCT_1:52;
L324: ( card D17 ) c= ( card D18 ) by L323 , L313 , L315 , CARD_1:10;
thus L325: thesis by L324 , NAT_1:39;
end;
thus L326: thesis by L311 , L231;
end;
begin
definition
let C144 being set;
let C145 being (FinSequence of ( bool C144 ));
let C146 being (Element of ( NAT ));
mode Reduction of C145 , C146
 -> (FinSequence of ( bool C144 ))
means :L327: (( dom it ) = ( dom C145 ) & (for B116 being (Element of ( NAT )) holds ((B116 in ( dom C145 ) & B116 <> C146) implies ( C145 . B116 ) = ( it . B116 ))) & ( it . C146 ) c= ( C145 . C146 ));
existence
proof
take C145;
thus L328: thesis;
end;
end;
definition
let C147 being set;
let C148 being (FinSequence of ( bool C147 ));
mode Reduction of C148
 -> (FinSequence of ( bool C147 ))
means :L330: (( dom it ) = ( dom C148 ) & (for B117 being (Element of ( NAT )) holds (B117 in ( dom C148 ) implies ( it . B117 ) c= ( C148 . B117 ))));
existence
proof
L331: (for B118 being (Element of ( NAT )) holds (B118 in ( dom C148 ) implies ( C148 . B118 ) c= ( C148 . B118 )));
thus L332: thesis by L331;
end;
end;
definition
let C149 being set;
let C150 being (FinSequence of ( bool C149 ));
let C151 being (Element of ( NAT ));
assume that
L334: C151 in ( dom C150 )
and
L335: ( C150 . C151 ) <> ( {} );
mode Singlification of C150 , C151
 -> (Reduction of C150)
means :L336: ( card ( it . C151 ) ) = 1;
existence
proof
set D21 = the (Element of ( C150 . C151 ));
L337: (( C150 . C151 ) in ( bool C149 ) & D21 in ( C150 . C151 )) by L334 , L335 , PARTFUN1:4;
reconsider D22 = { D21 } as (Subset of C149) by L337 , ZFMISC_1:31;
reconsider D23 = ( C150 +* (C151 , D22) ) as (FinSequence of ( bool C149 ));
L338: (for B119 being (Element of ( NAT )) holds (B119 in ( dom C150 ) implies ( D23 . B119 ) c= ( C150 . B119 )))
proof
let C152 being (Element of ( NAT ));
assume L339: C152 in ( dom C150 );
per cases ;
suppose L340: C152 = C151;

L341: ( D23 . C151 ) = { D21 } by L334 , FUNCT_7:31;
thus L342: thesis by L341 , L335 , L340 , ZFMISC_1:31;
end;
suppose L343: C152 <> C151;

thus L344: thesis by L343 , FUNCT_7:32;
end;
end;
L346: ( D23 . C151 ) = { D21 } by L334 , FUNCT_7:31;
L347: ( card ( D23 . C151 ) ) = 1 by L346 , CARD_2:42;
L348: ( dom D23 ) = ( dom C150 ) by FUNCT_7:30;
L349: D23 is (Reduction of C150) by L348 , L338 , L330;
thus L350: thesis by L349 , L347;
end;
end;
theorem
L352: (for B120 being  finite set holds (for B121 being (FinSequence of ( bool B120 )) holds (for B122 being (Element of ( NAT )) holds (for B123 being (Reduction of B121 , B122) holds B123 is (Reduction of B121)))))
proof
let C153 being  finite set;
let C154 being (FinSequence of ( bool C153 ));
let C155 being (Element of ( NAT ));
let C156 being (Reduction of C154 , C155);
L353: ( dom C156 ) = ( dom C154 ) by L327;
L354: (for B124 being (Element of ( NAT )) holds (B124 in ( dom C156 ) implies ( C156 . B124 ) c= ( C154 . B124 )))
proof
let C157 being (Element of ( NAT ));
assume L355: C157 in ( dom C156 );
per cases ;
suppose L356: C157 = C155;

thus L357: thesis by L356 , L327;
end;
suppose L358: C157 <> C155;

thus L359: thesis by L358 , L353 , L355 , L327;
end;
end;
thus L361: thesis by L354 , L353 , L330;
end;
theorem
L362: (for B125 being  finite set holds (for B126 being (FinSequence of ( bool B125 )) holds (for B127 being (Element of ( NAT )) holds (for B128 being set holds (B127 in ( dom B126 ) implies ( Cut (B126 , B127 , B128) ) is (Reduction of B126 , B127))))))
proof
let C158 being  finite set;
let C159 being (FinSequence of ( bool C158 ));
let C160 being (Element of ( NAT ));
let C161 being set;
set D24 = ( Cut (C159 , C160 , C161) );
L363: ( dom D24 ) = ( dom C159 ) by L152;
L364: (for B129 being (Element of ( NAT )) holds ((B129 in ( dom C159 ) & B129 <> C160) implies ( C159 . B129 ) = ( D24 . B129 ))) by L363 , L152;
assume L365: C160 in ( dom C159 );
L366: ( D24 . C160 ) = ( ( C159 . C160 ) \ { C161 } ) by L365 , L363 , L152;
thus L367: thesis by L366 , L363 , L364 , L327;
end;
theorem
L368: (for B130 being  finite set holds (for B131 being (FinSequence of ( bool B130 )) holds (for B132 being (Element of ( NAT )) holds (for B133 being set holds (B132 in ( dom B131 ) implies ( Cut (B131 , B132 , B133) ) is (Reduction of B131))))))
proof
let C162 being  finite set;
let C163 being (FinSequence of ( bool C162 ));
let C164 being (Element of ( NAT ));
let C165 being set;
assume L369: C164 in ( dom C163 );
L370: ( Cut (C163 , C164 , C165) ) is (Reduction of C163 , C164) by L369 , L362;
thus L371: thesis by L370 , L352;
end;
theorem
L372: (for B134 being  finite set holds (for B135 being (FinSequence of ( bool B134 )) holds (for B136 being (Reduction of B135) holds (for B137 being (Reduction of B136) holds B137 is (Reduction of B135)))))
proof
let C166 being  finite set;
let C167 being (FinSequence of ( bool C166 ));
let C168 being (Reduction of C167);
let C169 being (Reduction of C168);
L373: (for B138 being (Element of ( NAT )) holds (B138 in ( dom C167 ) implies ( C169 . B138 ) c= ( C167 . B138 )))
proof
let C170 being (Element of ( NAT ));
assume L374: C170 in ( dom C167 );
L375: C170 in ( dom C168 ) by L374 , L330;
L376: ( C169 . C170 ) c= ( C168 . C170 ) by L375 , L330;
L377: ( C168 . C170 ) c= ( C167 . C170 ) by L374 , L330;
thus L378: thesis by L377 , L376 , XBOOLE_1:1;
end;
L379: ( dom C168 ) = ( dom C169 ) by L330;
thus L380: thesis by L379 , L373 , L330;
end;
theorem
L381: (for B139 being non  empty  finite set holds (for B140 being  non-empty (FinSequence of ( bool B139 )) holds (for B141 being (Element of ( NAT )) holds (for B142 being (Singlification of B140 , B141) holds (B141 in ( dom B140 ) implies ( B142 . B141 ) <> ( {} ))))))
proof
let C171 being non  empty  finite set;
let C172 being  non-empty (FinSequence of ( bool C171 ));
let C173 being (Element of ( NAT ));
let C174 being (Singlification of C172 , C173);
assume L382: C173 in ( dom C172 );
L383: ( C172 . C173 ) <> ( {} ) by L382 , L34;
thus L384: thesis by L383 , L382 , L336 , CARD_1:27;
end;
theorem
L385: (for B143 being non  empty  finite set holds (for B144 being  non-empty (FinSequence of ( bool B143 )) holds (for B145 , B146 being (Element of ( NAT )) holds (for B147 being (Singlification of B144 , B145) holds (for B148 being (Singlification of B147 , B146) holds ((B145 in ( dom B144 ) & B146 in ( dom B144 ) & ( B148 . B145 ) <> ( {} ) & ( B147 . B146 ) <> ( {} )) implies (B148 is (Singlification of B144 , B146) & B148 is (Singlification of B144 , B145))))))))
proof
let C175 being non  empty  finite set;
let C176 being  non-empty (FinSequence of ( bool C175 ));
let C177 , C178 being (Element of ( NAT ));
let C179 being (Singlification of C176 , C177);
let C180 being (Singlification of C179 , C178);
assume that
L386: C177 in ( dom C176 )
and
L387: C178 in ( dom C176 )
and
L388: ( C180 . C177 ) <> ( {} )
and
L389: ( C179 . C178 ) <> ( {} );
L390: ( dom C179 ) = ( dom C176 ) by L330;
L391: ( C180 . C177 ) c= ( C179 . C177 ) by L390 , L386 , L330;
L392: ( C176 . C177 ) <> ( {} ) by L386 , L34;
L393: ( card ( C179 . C177 ) ) = 1 by L392 , L386 , L336;
L394: ( card ( C180 . C177 ) ) = 1 by L393 , L388 , L391 , NAT_1:25 , NAT_1:43;
L395: ( C176 . C178 ) <> ( {} ) by L387 , L34;
L396: C180 is (Reduction of C176) by L372;
L397: ( card ( C180 . C178 ) ) = 1 by L387 , L389 , L390 , L336;
thus L398: thesis by L397 , L386 , L387 , L392 , L395 , L396 , L394 , L336;
end;
theorem
L399: (for B149 being set holds (for B150 being (FinSequence of ( bool B149 )) holds (for B151 being (Element of ( NAT )) holds B150 is (Reduction of B150 , B151))))
proof
let C181 being set;
let C182 being (FinSequence of ( bool C181 ));
let C183 being (Element of ( NAT ));
L400: ((for B152 being (Element of ( NAT )) holds ((B152 in ( dom C182 ) & B152 <> C183) implies ( C182 . B152 ) = ( C182 . B152 ))) & ( C182 . C183 ) c= ( C182 . C183 ));
thus L401: thesis by L400 , L327;
end;
theorem
L402: (for B153 being set holds (for B154 being (FinSequence of ( bool B153 )) holds B154 is (Reduction of B154)))
proof
let C184 being set;
let C185 being (FinSequence of ( bool C184 ));
L403: (for B155 being (Element of ( NAT )) holds (B155 in ( dom C185 ) implies ( C185 . B155 ) c= ( C185 . B155 )));
thus L404: thesis by L403 , L330;
end;
definition
let C186 being non  empty set;
let C187 being (FinSequence of ( bool C186 ));
assume L405: C187 is  non-empty;
mode Singlification of C187
 -> (Reduction of C187)
means :L406: (for B156 being (Element of ( NAT )) holds (B156 in ( dom C187 ) implies ( card ( it . B156 ) ) = 1));
existence
proof
deffunc H2(set) = { ( choose ( C187 . $1 ) ) };
L407: (for B157 being set holds (B157 in ( dom C187 ) implies H2(B157) in ( bool C186 )))
proof
let C188 being set;
assume L408: C188 in ( dom C187 );
L409: ( C187 . C188 ) <> ( {} ) by L408 , L405 , L34;
L410: { ( choose ( C187 . C188 ) ) } c= ( C187 . C188 ) by L409 , ZFMISC_1:31;
L411: ( C187 . C188 ) in ( bool C186 ) by L408 , PARTFUN1:4;
L412: { ( choose ( C187 . C188 ) ) } c= C186 by L411 , L410 , XBOOLE_1:1;
thus L413: thesis by L412;
end;
L414: (ex B158 being (Function of ( dom C187 ) , ( bool C186 )) st (for B159 being set holds (B159 in ( dom C187 ) implies ( B158 . B159 ) = H2(B159)))) from FUNCT_2:sch 2(L407);
consider C189 being (Function of ( dom C187 ) , ( bool C186 )) such that L415: (for B160 being set holds (B160 in ( dom C187 ) implies ( C189 . B160 ) = H2(B160))) by L414;
L416: (for B161 being (Element of ( NAT )) holds (B161 in ( dom C189 ) implies ( C189 . B161 ) = { ( choose ( C187 . B161 ) ) }))
proof
let C190 being (Element of ( NAT ));
assume L417: C190 in ( dom C189 );
L418: C190 in ( dom C187 ) by L417 , FUNCT_2:def 1;
thus L419: thesis by L418 , L415;
end;
L420: ( dom C189 ) = ( dom C187 ) by FUNCT_2:def 1;
L421: (for B162 being (Element of ( NAT )) holds (B162 in ( dom C187 ) implies ( C189 . B162 ) c= ( C187 . B162 )))
proof
let C191 being (Element of ( NAT ));
assume L422: C191 in ( dom C187 );
L423: ( C187 . C191 ) <> ( {} ) by L422 , L405 , L34;
L424: { ( choose ( C187 . C191 ) ) } c= ( C187 . C191 ) by L423 , ZFMISC_1:31;
thus L425: thesis by L424 , L420 , L416 , L422;
end;
L426: ( dom C189 ) = ( dom C187 ) by FUNCT_2:def 1
.= ( Seg ( len C187 ) ) by FINSEQ_1:def 3;
L427: C189 is FinSequence by L426 , FINSEQ_1:def 2;
L428: ( rng C189 ) c= ( bool C186 ) by RELAT_1:def 19;
L429: C189 is (FinSequence of ( bool C186 )) by L428 , L427 , FINSEQ_1:def 4;
reconsider D25 = C189 as (Reduction of C187) by L429 , L420 , L421 , L330;
L430: (for B163 being (Element of ( NAT )) holds (B163 in ( dom C187 ) implies ( card ( D25 . B163 ) ) = 1))
proof
let C192 being (Element of ( NAT ));
assume L431: C192 in ( dom C187 );
L432: C192 in ( dom D25 ) by L431 , FUNCT_2:def 1;
L433: ( D25 . C192 ) = { ( choose ( C187 . C192 ) ) } by L432 , L416;
thus L434: thesis by L433 , CARD_2:42;
end;
thus L435: thesis by L430;
end;
end;
theorem
L437: (for B164 being non  empty  finite set holds (for B165 being non  empty  non-empty (FinSequence of ( bool B164 )) holds (for B166 being Function holds (B166 is (Singlification of B165) iff (( dom B166 ) = ( dom B165 ) & (for B167 being (Element of ( NAT )) holds (B167 in ( dom B165 ) implies B166 is (Singlification of B165 , B167))))))))
proof
let C193 being non  empty  finite set;
let C194 being non  empty  non-empty (FinSequence of ( bool C193 ));
let C195 being Function;
thus L438:now
assume L439: C195 is (Singlification of C194);
reconsider D26 = C195 as (Singlification of C194) by L439;
L440: D26 is (Reduction of C194);
thus L441: ( dom C195 ) = ( dom C194 ) by L440 , L330;
let C196 being (Element of ( NAT ));
assume L442: C196 in ( dom C194 );
L443: (( card ( D26 . C196 ) ) = 1 & ( C194 . C196 ) <> ( {} )) by L442 , L406;
thus L444: C195 is (Singlification of C194 , C196) by L443 , L442 , L336;
end;
assume that
L445: ( dom C195 ) = ( dom C194 )
and
L446: (for B168 being (Element of ( NAT )) holds (B168 in ( dom C194 ) implies C195 is (Singlification of C194 , B168)));
reconsider D27 = C195 as (FinSequence of ( bool C193 )) by L446 , FINSEQ_5:6;
L447: (for B169 being (Element of ( NAT )) holds (B169 in ( dom C194 ) implies ( D27 . B169 ) c= ( C194 . B169 )))
proof
let C197 being (Element of ( NAT ));
assume L448: C197 in ( dom C194 );
L449: D27 is (Singlification of C194 , C197) by L448 , L446;
thus L450: thesis by L449 , L448 , L330;
end;
reconsider D28 = D27 as (Reduction of C194) by L447 , L445 , L330;
L451: (for B170 being (Element of ( NAT )) holds (B170 in ( dom C194 ) implies ( card ( D28 . B170 ) ) = 1))
proof
let C198 being (Element of ( NAT ));
assume L452: C198 in ( dom C194 );
L453: (D27 is (Singlification of C194 , C198) & ( C194 . C198 ) <> ( {} )) by L452 , L446;
thus L454: thesis by L453 , L452 , L336;
end;
thus L455: thesis by L451 , L406;
end;
registration
let C199 being non  empty  finite set;
let C200 being non  empty (FinSequence of ( bool C199 ));
let C201 being (Element of ( NAT ));
cluster  -> non  empty for (Singlification of C200 , C201);
coherence
proof
let C202 being (Singlification of C200 , C201);
L456: ( dom C202 ) = ( dom C200 ) by L330;
thus L457: thesis by L456;
end;
end;
registration
let C203 being non  empty  finite set;
let C204 being non  empty (FinSequence of ( bool C203 ));
cluster  -> non  empty for (Singlification of C204);
coherence
proof
let C205 being (Singlification of C204);
L459: ( dom C205 ) = ( dom C204 ) by L330;
thus L460: thesis by L459;
end;
end;
begin
theorem
L462: (for B171 being non  empty  finite set holds (for B172 being non  empty (FinSequence of ( bool B171 )) holds (for B173 being set holds (for B174 being (Reduction of B172) holds (B173 is_a_system_of_different_representatives_of B174 implies B173 is_a_system_of_different_representatives_of B172)))))
proof
let C206 being non  empty  finite set;
let C207 being non  empty (FinSequence of ( bool C206 ));
let C208 being set;
let C209 being (Reduction of C207);
assume that
L463: C208 is_a_system_of_different_representatives_of C209;
L464: C208 is_a_system_of_different_representatives_of C207
proof
consider C210 being (FinSequence of C206) such that L465: C210 = C208 and L466: ( dom C209 ) = ( dom C210 ) and L467: (for B175 being (Element of ( NAT )) holds (B175 in ( dom C210 ) implies ( C210 . B175 ) in ( C209 . B175 ))) and L468: C210 is  one-to-one by L463 , L229;
L469: (for B176 being (Element of ( NAT )) holds (B176 in ( dom C210 ) implies ( C210 . B176 ) in ( C207 . B176 )))
proof
let C211 being (Element of ( NAT ));
assume that
L470: C211 in ( dom C210 );
L471: ( C210 . C211 ) in ( C209 . C211 ) by L467 , L470;
L472: ( dom C209 ) = ( dom C207 ) by L330;
L473: ( C209 . C211 ) c= ( C207 . C211 ) by L472 , L466 , L470 , L330;
thus L474: thesis by L473 , L471;
end;
L475: ( dom C207 ) = ( dom C209 ) by L330;
thus L476: thesis by L475 , L465 , L466 , L468 , L469 , L229;
end;
thus L477: thesis by L464;
end;
theorem
L478: (for B177 being  finite set holds (for B178 being (FinSequence of ( bool B177 )) holds (B178 is  Hall implies (for B179 being (Element of ( NAT )) holds (( card ( B178 . B179 ) ) >= 2 implies (ex B180 being set st (B180 in ( B178 . B179 ) & ( Cut (B178 , B179 , B180) ) is  Hall)))))))
proof
let C212 being  finite set;
let C213 being (FinSequence of ( bool C212 ));
assume that
L479: C213 is  Hall;
let C214 being (Element of ( NAT ));
assume that
L480: ( card ( C213 . C214 ) ) >= 2;
L481: 2 c= ( card ( C213 . C214 ) ) by L480 , NAT_1:39;
reconsider D29 = ( C213 . C214 ) as non  trivial  finite set by L481 , PENCIL_1:4;
consider C215 , C216 being set such that L482: C215 in D29 and L483: C216 in D29 and L484: C215 <> C216 by ZFMISC_1:def 10;
assume L485: (for B181 being set holds (B181 in ( C213 . C214 ) implies (not ( Cut (C213 , C214 , B181) ) is  Hall)));
L486: (not ( Cut (C213 , C214 , C215) ) is  Hall) by L485 , L482;
consider C217 being  finite set such that L487: C217 c= ( dom ( Cut (C213 , C214 , C215) ) ) and L488: ( card C217 ) > ( card ( union (( Cut (C213 , C214 , C215) ) , C217) ) ) by L486 , L231;
L489: (ex B182 being  finite set st ((not C214 in B182) & B182 c= ( dom ( Cut (C213 , C214 , C215) ) ) & ( card B182 ) >= ( card ( ( union (C213 , B182) ) \/ ( ( C213 . C214 ) \ { C215 } ) ) )))
proof
per cases ;
suppose L490: C214 in C217;

set D30 = ( C217 \ { C214 } );
L491: ( card D30 ) = ( ( card C217 ) - ( card { C214 } ) ) by L490 , EULER_1:4
.= ( ( card C217 ) - 1 ) by CARD_1:30;
L492: (D30 c= ( dom ( Cut (C213 , C214 , C215) ) ) & { C214 } misses D30) by L487 , XBOOLE_1:1 , XBOOLE_1:79;
L493: ( union (( Cut (C213 , C214 , C215) ) , C217) ) = ( ( union (C213 , ( C217 \ { C214 } )) ) \/ ( ( C213 . C214 ) \ { C215 } ) ) by L487 , L490 , L224;
L494: ( card D30 ) >= ( card ( ( union (C213 , D30) ) \/ ( ( C213 . C214 ) \ { C215 } ) ) ) by L493 , L488 , L491 , SPPOL_1:1;
thus L495: thesis by L494 , L492 , ZFMISC_1:48;
end;
suppose L496: (not C214 in C217);

take D31 = C217;
L497: D31 c= ( dom C213 ) by L487 , L152;
L498: ( card D31 ) > ( card ( union (C213 , D31) ) ) by L488 , L496 , L199;
thus L499: thesis by L498 , L479 , L497 , L231;
end;
end;
consider C218 being  finite set such that L501: (not C214 in C218) and L502: C218 c= ( dom ( Cut (C213 , C214 , C215) ) ) and L503: ( card C218 ) >= ( card ( ( union (C213 , C218) ) \/ ( ( C213 . C214 ) \ { C215 } ) ) ) by L489;
L504: (not ( Cut (C213 , C214 , C216) ) is  Hall) by L483 , L485;
consider C219 being  finite set such that L505: C219 c= ( dom ( Cut (C213 , C214 , C216) ) ) and L506: ( card C219 ) > ( card ( union (( Cut (C213 , C214 , C216) ) , C219) ) ) by L504 , L231;
L507: (ex B183 being  finite set st ((not C214 in B183) & B183 c= ( dom ( Cut (C213 , C214 , C216) ) ) & ( card B183 ) >= ( card ( ( union (C213 , B183) ) \/ ( ( C213 . C214 ) \ { C216 } ) ) )))
proof
per cases ;
suppose L508: C214 in C219;

set D32 = ( C219 \ { C214 } );
L509: ( card D32 ) = ( ( card C219 ) - ( card { C214 } ) ) by L508 , EULER_1:4
.= ( ( card C219 ) - 1 ) by CARD_1:30;
L510: (D32 c= ( dom ( Cut (C213 , C214 , C216) ) ) & { C214 } misses D32) by L505 , XBOOLE_1:1 , XBOOLE_1:79;
L511: ( union (( Cut (C213 , C214 , C216) ) , C219) ) = ( ( union (C213 , ( C219 \ { C214 } )) ) \/ ( ( C213 . C214 ) \ { C216 } ) ) by L505 , L508 , L224;
L512: ( card D32 ) >= ( card ( ( union (C213 , D32) ) \/ ( ( C213 . C214 ) \ { C216 } ) ) ) by L511 , L506 , L509 , SPPOL_1:1;
thus L513: thesis by L512 , L510 , ZFMISC_1:48;
end;
suppose L514: (not C214 in C219);

set D33 = C219;
take D33;
L515: D33 c= ( dom C213 ) by L505 , L152;
L516: ( card D33 ) > ( card ( union (C213 , D33) ) ) by L506 , L514 , L199;
thus L517: thesis by L516 , L479 , L515 , L231;
end;
end;
consider C220 being  finite set such that L519: (not C214 in C220) and L520: C220 c= ( dom ( Cut (C213 , C214 , C216) ) ) and L521: ( card C220 ) >= ( card ( ( union (C213 , C220) ) \/ ( ( C213 . C214 ) \ { C216 } ) ) ) by L507;
reconsider D34 = ( { C214 } \/ ( C218 \/ C220 ) ) as  finite set;
L522: C220 c= ( dom C213 ) by L520 , L152;
L523: ( ( union (C213 , ( C218 \/ C220 )) ) \/ D29 ) c= ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) \/ ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) )
proof
let C221 being set;
assume L524: C221 in ( ( union (C213 , ( C218 \/ C220 )) ) \/ D29 );
per cases  by L524 , XBOOLE_0:def 3;
suppose L525: C221 in ( union (C213 , ( C218 \/ C220 )) );

consider C222 being set such that L526: C222 in ( C218 \/ C220 ) and L527: (C222 in ( dom C213 ) & C221 in ( C213 . C222 )) by L525 , L46;
L528: (C222 in C218 or C222 in C220) by L526 , XBOOLE_0:def 3;
L529: (C221 in ( union (C213 , C218) ) or C221 in ( union (C213 , C220) )) by L528 , L527 , L46;
L530: C221 in ( ( union (C213 , C218) ) \/ ( union (C213 , C220) ) ) by L529 , XBOOLE_0:def 3;
L531: C221 in ( ( ( union (C213 , C218) ) \/ ( union (C213 , C220) ) ) \/ ( ( D29 \ { C215 } ) \/ ( D29 \ { C216 } ) ) ) by L530 , XBOOLE_0:def 3;
L532: C221 in ( ( ( ( union (C213 , C218) ) \/ ( union (C213 , C220) ) ) \/ ( D29 \ { C215 } ) ) \/ ( D29 \ { C216 } ) ) by L531 , XBOOLE_1:4;
L533: C221 in ( ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) \/ ( union (C213 , C220) ) ) \/ ( D29 \ { C216 } ) ) by L532 , XBOOLE_1:4;
thus L534: thesis by L533 , XBOOLE_1:4;
end;
suppose L535: C221 in D29;

L536: (C221 in ( ( D29 \ { C215 } ) \/ ( D29 \ { C216 } ) ) or C221 in ( union (C213 , C218) ) or C221 in ( union (C213 , C220) )) by L535 , L482 , L483 , L484 , L129;
L537: (C221 in ( ( ( D29 \ { C215 } ) \/ ( D29 \ { C216 } ) ) \/ ( union (C213 , C218) ) ) or C221 in ( union (C213 , C220) )) by L536 , XBOOLE_0:def 3;
L538: C221 in ( ( ( ( D29 \ { C215 } ) \/ ( D29 \ { C216 } ) ) \/ ( union (C213 , C218) ) ) \/ ( union (C213 , C220) ) ) by L537 , XBOOLE_0:def 3;
L539: C221 in ( ( ( union (C213 , C218) ) \/ ( union (C213 , C220) ) ) \/ ( ( D29 \ { C215 } ) \/ ( D29 \ { C216 } ) ) ) by L538 , XBOOLE_1:4;
L540: C221 in ( ( ( ( union (C213 , C218) ) \/ ( union (C213 , C220) ) ) \/ ( D29 \ { C215 } ) ) \/ ( D29 \ { C216 } ) ) by L539 , XBOOLE_1:4;
L541: C221 in ( ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) \/ ( union (C213 , C220) ) ) \/ ( D29 \ { C216 } ) ) by L540 , XBOOLE_1:4;
thus L542: thesis by L541 , XBOOLE_1:4;
end;
end;
L544: ( card ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) \/ ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) ) ) >= ( card ( ( union (C213 , ( C218 \/ C220 )) ) \/ D29 ) ) by L523 , NAT_1:43;
L545: ( union (C213 , ( C218 /\ C220 )) ) c= ( ( union (C213 , C218) ) /\ ( union (C213 , C220) ) )
proof
let C223 being set;
assume L546: C223 in ( union (C213 , ( C218 /\ C220 )) );
consider C224 being set such that L547: C224 in ( C218 /\ C220 ) and L548: (C224 in ( dom C213 ) & C223 in ( C213 . C224 )) by L546 , L46;
L549: C224 in C220 by L547 , XBOOLE_0:def 4;
L550: C223 in ( union (C213 , C220) ) by L549 , L548 , L46;
L551: C224 in C218 by L547 , XBOOLE_0:def 4;
L552: C223 in ( union (C213 , C218) ) by L551 , L548 , L46;
thus L553: thesis by L552 , L550 , XBOOLE_0:def 4;
end;
L554: ( card ( ( union (C213 , C218) ) /\ ( union (C213 , C220) ) ) ) >= ( card ( union (C213 , ( C218 /\ C220 )) ) ) by L545 , NAT_1:43;
L555: ( ( card ( ( union (C213 , ( C218 \/ C220 )) ) \/ D29 ) ) + ( card ( ( union (C213 , C218) ) /\ ( union (C213 , C220) ) ) ) ) >= ( ( card ( D29 \/ ( union (C213 , ( C218 \/ C220 )) ) ) ) + ( card ( union (C213 , ( C218 /\ C220 )) ) ) ) by L554 , XREAL_1:7;
L556: C218 c= ( dom C213 ) by L502 , L152;
L557: ( C218 \/ C220 ) c= ( dom C213 ) by L556 , L522 , XBOOLE_1:8;
L558: C214 in ( dom C213 ) by L480 , CARD_1:27 , FUNCT_1:def 2;
L559: { C214 } c= ( dom C213 ) by L558 , ZFMISC_1:31;
L560: D34 c= ( dom C213 ) by L559 , L557 , XBOOLE_1:8;
L561: ( card ( union (C213 , ( { C214 } \/ ( C218 \/ C220 ) )) ) ) >= ( card ( { C214 } \/ ( C218 \/ C220 ) ) ) by L560 , L479 , L231;
L562: ( card ( union (C213 , ( ( { C214 } \/ C218 ) \/ C220 )) ) ) >= ( card ( { C214 } \/ ( C218 \/ C220 ) ) ) by L561 , XBOOLE_1:4;
L563: (not C214 in ( C218 \/ C220 )) by L501 , L519 , XBOOLE_0:def 3;
L564: ( card ( { C214 } \/ ( C218 \/ C220 ) ) ) = ( ( card { C214 } ) + ( card ( C218 \/ C220 ) ) ) by L563 , CARD_2:40 , ZFMISC_1:50;
L565: (( C218 /\ C220 ) c= C218 & C218 c= ( dom C213 )) by L502 , L152 , XBOOLE_1:17;
L566: ( C218 /\ C220 ) c= ( dom C213 ) by L565 , XBOOLE_1:1;
L567: ( card ( union (C213 , ( C218 /\ C220 )) ) ) >= ( card ( C218 /\ C220 ) ) by L566 , L479 , L231;
set D35 = ( ( union (C213 , C220) ) \/ ( ( C213 . C214 ) \ { C216 } ) );
set D36 = ( ( union (C213 , C218) ) \/ ( ( C213 . C214 ) \ { C215 } ) );
L568: ( ( card C218 ) + ( card C220 ) ) >= ( ( card D36 ) + ( card D35 ) ) by L503 , L521 , XREAL_1:7;
L569: ( ( card C218 ) + ( card C220 ) ) >= ( ( card ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) \/ ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) ) ) + ( card ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) /\ ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) ) ) ) by L568 , L1;
L570: ( ( union (C213 , C218) ) /\ ( union (C213 , C220) ) ) c= ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) /\ ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) )
proof
let C225 being set;
assume L571: C225 in ( ( union (C213 , C218) ) /\ ( union (C213 , C220) ) );
L572: C225 in ( union (C213 , C220) ) by L571 , XBOOLE_0:def 4;
L573: C225 in ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) by L572 , XBOOLE_0:def 3;
L574: C225 in ( union (C213 , C218) ) by L571 , XBOOLE_0:def 4;
L575: C225 in ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) by L574 , XBOOLE_0:def 3;
thus L576: thesis by L575 , L573 , XBOOLE_0:def 4;
end;
L577: ( card ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) /\ ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) ) ) >= ( card ( ( union (C213 , C218) ) /\ ( union (C213 , C220) ) ) ) by L570 , NAT_1:43;
L578: ( ( card ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) \/ ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) ) ) + ( card ( ( ( union (C213 , C218) ) \/ ( D29 \ { C215 } ) ) /\ ( ( union (C213 , C220) ) \/ ( D29 \ { C216 } ) ) ) ) ) >= ( ( card ( ( union (C213 , ( C218 \/ C220 )) ) \/ D29 ) ) + ( card ( ( union (C213 , C218) ) /\ ( union (C213 , C220) ) ) ) ) by L577 , L544 , XREAL_1:7;
L579: ( ( card C218 ) + ( card C220 ) ) >= ( ( card ( ( union (C213 , ( C218 \/ C220 )) ) \/ D29 ) ) + ( card ( ( union (C213 , C218) ) /\ ( union (C213 , C220) ) ) ) ) by L578 , L569 , XXREAL_0:2;
L580: ( ( card C218 ) + ( card C220 ) ) >= ( ( card ( D29 \/ ( union (C213 , ( C218 \/ C220 )) ) ) ) + ( card ( union (C213 , ( C218 /\ C220 )) ) ) ) by L579 , L555 , XXREAL_0:2;
L581: ( card ( union (C213 , ( ( { C214 } \/ C218 ) \/ C220 )) ) ) = ( card ( D29 \/ ( union (C213 , ( C218 \/ C220 )) ) ) ) by L558 , L112;
L582: ( card ( D29 \/ ( union (C213 , ( C218 \/ C220 )) ) ) ) >= ( 1 + ( card ( C218 \/ C220 ) ) ) by L581 , L562 , L564 , CARD_1:30;
L583: ( ( card ( D29 \/ ( union (C213 , ( C218 \/ C220 )) ) ) ) + ( card ( union (C213 , ( C218 /\ C220 )) ) ) ) >= ( ( 1 + ( card ( C218 \/ C220 ) ) ) + ( card ( C218 /\ C220 ) ) ) by L582 , L567 , XREAL_1:7;
L584: ( ( card ( C218 \/ C220 ) ) + ( card ( C218 /\ C220 ) ) ) = ( ( card C218 ) + ( card C220 ) ) by L1;
L585: ( ( 1 + ( card ( C218 \/ C220 ) ) ) + ( card ( C218 /\ C220 ) ) ) = ( 1 + ( ( card C218 ) + ( card C220 ) ) ) by L584;
thus L586: thesis by L585 , L580 , L583 , NAT_1:13;
end;
theorem
L587: (for B184 being  finite set holds (for B185 being (FinSequence of ( bool B184 )) holds (for B186 being (Element of ( NAT )) holds ((B186 in ( dom B185 ) & B185 is  Hall) implies (ex B187 being (Singlification of B185 , B186) st B187 is  Hall)))))
proof
let C226 being  finite set;
let C227 being (FinSequence of ( bool C226 ));
let C228 being (Element of ( NAT ));
assume that
L588: C228 in ( dom C227 )
and
L589: C227 is  Hall;
L590: ( C227 . C228 ) <> ( {} ) by L588 , L589 , L265 , CARD_1:27;
set D37 = ( card ( C227 . C228 ) );
L591: D37 >= 1 by L588 , L589 , L265;
defpred S4[ (Element of ( NAT )) ] means (ex B188 being (Reduction of C227) st (B188 is  Hall & ( card ( B188 . C228 ) ) = $1));
L592: C227 is (Reduction of C227) by L402;
per cases  by L591 , XXREAL_0:1;
suppose L593: D37 = 1;

L594: C227 is (Singlification of C227 , C228) by L593 , L588 , L592 , L336 , CARD_1:27;
thus L595: thesis by L594 , L589;
end;
suppose L596: D37 > 1;

L597: (for B189 being (Element of ( NAT )) holds ((B189 >= 1 & S4[ ( B189 + 1 ) ]) implies S4[ B189 ]))
proof
let C229 being (Element of ( NAT ));
assume that
L598: C229 >= 1
and
L599: S4[ ( C229 + 1 ) ];
consider C230 being (Reduction of C227) such that L600: C230 is  Hall and L601: ( card ( C230 . C228 ) ) = ( C229 + 1 ) by L599;
L602: ( 1 + 1 ) <= ( C229 + 1 ) by L598 , XREAL_1:6;
consider C231 being set such that L603: C231 in ( C230 . C228 ) and L604: ( Cut (C230 , C228 , C231) ) is  Hall by L602 , L600 , L601 , L478;
set D38 = ( Cut (C230 , C228 , C231) );
L605: ( dom C230 ) = ( dom C227 ) by L330;
L606: D38 is (Reduction of C230) by L605 , L588 , L368;
L607: D38 is (Reduction of C227) by L606 , L372;
L608: ( card ( D38 . C228 ) ) = ( ( C229 + 1 ) - 1 ) by L588 , L601 , L605 , L603 , L178
.= C229;
thus L609: thesis by L608 , L604 , L607;
end;
L610: C227 is (Reduction of C227) by L402;
L611: (ex B190 being (Element of ( NAT )) st (B190 > 1 & S4[ B190 ])) by L610 , L589 , L596;
L612: S4[ 1 ] from Regr2(L611 , L597);
consider C232 being (Reduction of C227) such that L613: C232 is  Hall and L614: ( card ( C232 . C228 ) ) = 1 by L612;
L615: C232 is (Singlification of C227 , C228) by L588 , L590 , L614 , L336;
thus L616: thesis by L615 , L613;
end;
end;
theorem
L618: (for B191 being non  empty  finite set holds (for B192 being non  empty (FinSequence of ( bool B191 )) holds (B192 is  Hall implies (ex B193 being (Singlification of B192) st B193 is  Hall))))
proof
let C233 being non  empty  finite set;
let C234 being non  empty (FinSequence of ( bool C233 ));
defpred S5[ (Element of ( NAT )) ] means ($1 in ( dom C234 ) implies (ex B194 being (Singlification of C234 , $1) st (B194 is  Hall & (for B195 being (Element of ( NAT )) holds ((1 <= B195 & B195 <= $1) implies B194 is (Singlification of C234 , B195))))));
assume L619: C234 is  Hall;
L620: C234 is  non-empty by L619;
L621: (for B196 being (Element of ( NAT )) holds (S5[ B196 ] implies S5[ ( B196 + 1 ) ]))
proof
let C235 being (Element of ( NAT ));
assume L622: S5[ C235 ];
L623: (( C235 + 1 ) in ( dom C234 ) implies (ex B197 being (Singlification of C234 , ( C235 + 1 )) st (B197 is  Hall & (for B198 being (Element of ( NAT )) holds ((1 <= B198 & B198 <= ( C235 + 1 )) implies B197 is (Singlification of C234 , B198))))))
proof
assume L624: ( C235 + 1 ) in ( dom C234 );
per cases  by L624 , TAXONOM1:1;
suppose L625: C235 = ( 0 );

consider C236 being (Singlification of C234 , ( C235 + 1 )) such that L626: C236 is  Hall by L619 , L624 , L587;
L627: (for B199 being (Element of ( NAT )) holds ((1 <= B199 & B199 <= ( C235 + 1 )) implies C236 is (Singlification of C234 , B199))) by L625 , XXREAL_0:1;
thus L628: thesis by L627 , L626;
end;
suppose L629: C235 in ( dom C234 );

consider C237 being (Singlification of C234 , C235) such that L630: C237 is  Hall and L631: (for B200 being (Element of ( NAT )) holds ((1 <= B200 & B200 <= C235) implies C237 is (Singlification of C234 , B200))) by L629 , L622;
L632: ( C235 + 1 ) in ( dom C237 ) by L624 , L330;
consider C238 being (Singlification of C237 , ( C235 + 1 )) such that L633: C238 is  Hall by L632 , L630 , L587;
L634: ( dom C237 ) = ( dom C234 ) by L330;
L635: ( dom C238 ) = ( dom C234 ) by L634 , L330;
L636: ( C238 . C235 ) <> ( {} ) by L635 , L629 , L633;
L637: ( C237 . ( C235 + 1 ) ) <> ( {} ) by L630 , L624 , L634;
reconsider D39 = C238 as (Singlification of C234 , ( C235 + 1 )) by L637 , L620 , L624 , L629 , L636 , L385;
L638: (for B201 being (Element of ( NAT )) holds ((1 <= B201 & B201 <= ( C235 + 1 )) implies D39 is (Singlification of C234 , B201)))
proof
let C239 being (Element of ( NAT ));
assume that
L639: 1 <= C239
and
L640: C239 <= ( C235 + 1 );
L641: ( C235 + 1 ) <= ( len C234 ) by L624 , FINSEQ_3:25;
L642: C239 <= ( len C234 ) by L641 , L640 , XXREAL_0:2;
L643: C239 in ( dom C234 ) by L642 , L639 , FINSEQ_3:25;
L644: ( D39 . C239 ) <> ( {} ) by L643 , L635 , L633;
per cases  by L640 , NAT_1:8;
suppose L645: C239 <= C235;

L646: C237 is (Singlification of C234 , C239) by L645 , L631 , L639;
thus L647: thesis by L646 , L620 , L624 , L637 , L643 , L644 , L385;
end;
suppose L648: C239 = ( C235 + 1 );

thus L649: thesis by L648;
end;
end;
thus L651: thesis by L638 , L633;
end;
end;
thus L653: thesis by L623;
end;
L654: S5[ ( 0 ) ]
proof
assume L655: ( 0 ) in ( dom C234 );
consider C240 being (Singlification of C234 , ( 0 )) such that L656: C240 is  Hall by L655 , L619 , L587;
L657: (for B202 being (Element of ( NAT )) holds ((1 <= B202 & B202 <= ( 0 )) implies C240 is (Singlification of C234 , B202)));
thus L658: thesis by L657 , L656;
end;
L659: (for B203 being (Element of ( NAT )) holds S5[ B203 ]) from NAT_1:sch 1(L654 , L621);
L660: (( len C234 ) in ( dom C234 ) implies (ex B204 being (Singlification of C234 , ( len C234 )) st (B204 is  Hall & (for B205 being (Element of ( NAT )) holds ((1 <= B205 & B205 <= ( len C234 )) implies B204 is (Singlification of C234 , B205)))))) by L659;
consider C241 being (Singlification of C234 , ( len C234 )) such that L661: C241 is  Hall and L662: (for B206 being (Element of ( NAT )) holds ((1 <= B206 & B206 <= ( len C234 )) implies C241 is (Singlification of C234 , B206))) by L660 , FINSEQ_5:6;
L663: (for B207 being (Element of ( NAT )) holds (B207 in ( dom C234 ) implies C241 is (Singlification of C234 , B207)))
proof
let C242 being (Element of ( NAT ));
assume L664: C242 in ( dom C234 );
L665: (1 <= C242 & C242 <= ( len C234 )) by L664 , FINSEQ_3:25;
thus L666: thesis by L665 , L662;
end;
L667: ( dom C241 ) = ( dom C234 ) by L330;
L668: C241 is (Singlification of C234) by L667 , L620 , L663 , L437;
thus L669: thesis by L668 , L661;
end;
::$N Hall Marriage Theorem
theorem
L670: (for B208 being non  empty  finite set holds (for B209 being non  empty (FinSequence of ( bool B208 )) holds ((ex B210 being set st B210 is_a_system_of_different_representatives_of B209) iff B209 is  Hall)))
proof
let C243 being non  empty  finite set;
let C244 being non  empty (FinSequence of ( bool C243 ));
thus L671: ((ex B211 being set st B211 is_a_system_of_different_representatives_of C244) implies C244 is  Hall) by L305;
assume L672: C244 is  Hall;
consider C245 being (Singlification of C244) such that L673: C245 is  Hall by L672 , L618;
L674: (for B212 being (Element of ( NAT )) holds (B212 in ( dom C245 ) implies ( card ( C245 . B212 ) ) = 1))
proof
let C246 being (Element of ( NAT ));
assume L675: C246 in ( dom C245 );
L676: ( dom C245 ) = ( dom C244 ) by L330;
thus L677: thesis by L676 , L672 , L675 , L406;
end;
L678: (ex B213 being set st B213 is_a_system_of_different_representatives_of C245) by L674 , L673 , L273;
thus L679: thesis by L678 , L462;
end;
