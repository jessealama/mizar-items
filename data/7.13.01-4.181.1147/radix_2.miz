:: High-speed algorithms for RSA cryptograms
::  by Yasushi Fuwa and Yoshinori Fujisawa
::
:: Received February 1, 2000
:: Copyright (c) 2000-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies NUMBERS, NAT_1, INT_1, CARD_1, RELAT_1, ARYTM_3, XXREAL_0,
      ARYTM_1, NEWTON, FINSEQ_1, RADIX_1, POWER, FINSEQ_2, PARTFUN1, FUNCT_1,
      CARD_3, ORDINAL4, SUBSET_1, TARSKI, REAL_1, RADIX_2;
 notations TARSKI, NUMBERS, XCMPLX_0, XXREAL_0, REAL_1, INT_1, ORDINAL1, NAT_1,
      NAT_D, FUNCT_1, POWER, PARTFUN1, FINSEQ_1, FINSEQ_2, SEQ_1, NEWTON,
      RVSUM_1, GR_CY_1, WSIERP_1, RADIX_1, SUBSET_1, RECDEF_1;
 constructors REAL_1, NAT_D, NEWTON, POWER, BINARITH, WSIERP_1, GR_CY_1,
      RADIX_1, SEQ_1, RECDEF_1;
 registrations ORDINAL1, RELSET_1, NUMBERS, XXREAL_0, XREAL_0, NAT_1, INT_1,
      MEMBERED, NEWTON, XBOOLE_0, VALUED_0, FINSEQ_2, FINSEQ_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI;
 theorems NAT_1, NAT_2, INT_1, FINSEQ_1, PREPOWER, POWER, RVSUM_1, FINSEQ_2,
      TARSKI, FUNCT_1, PEPIN, RADIX_1, EULER_2, NEWTON, INT_2, XCMPLX_1,
      XREAL_1, XXREAL_0, XREAL_0, NAT_D, ORDINAL1, PARTFUN1, CARD_1;
 schemes NAT_1, FINSEQ_2, RECDEF_1;

begin
theorem
L1: (for B1 being Nat holds ( B1 mod 1 ) = ( 0 ))
proof
let C1 being Nat;
L2: C1 = ( ( 1 * C1 ) + ( 0 ) );
thus L3: thesis by L2 , NAT_D:def 2;
end;
theorem
L4: (for B2 , B3 being Integer holds (for B4 being Nat holds (B4 > ( 0 ) implies ( ( ( B2 mod B4 ) + ( B3 mod B4 ) ) mod B4 ) = ( ( B2 + ( B3 mod B4 ) ) mod B4 ))))
proof
let C2 , C3 being Integer;
let C4 being Nat;
assume L5: C4 > ( 0 );
L6: ( ( C2 mod C4 ) + ( ( C2 div C4 ) * C4 ) ) = ( ( C2 - ( ( C2 div C4 ) * C4 ) ) + ( ( C2 div C4 ) * C4 ) ) by L5 , INT_1:def 10
.= ( C2 + ( 0 ) );
L7: C4 divides ( ( C2 + ( C3 mod C4 ) ) - ( ( C2 mod C4 ) + ( C3 mod C4 ) ) ) by L6 , INT_1:def 3;
L8: ( C2 + ( C3 mod C4 ) ) , ( ( C2 mod C4 ) + ( C3 mod C4 ) ) are_congruent_mod C4 by L7 , INT_2:15;
thus L9: thesis by L8 , NAT_D:64;
end;
theorem
L10: (for B5 , B6 being Integer holds (for B7 being Nat holds (B7 > ( 0 ) implies ( ( B5 * B6 ) mod B7 ) = ( ( B5 * ( B6 mod B7 ) ) mod B7 ))))
proof
let C5 , C6 being Integer;
let C7 being Nat;
assume L11: C7 > ( 0 );
L12: ( ( C6 mod C7 ) + ( ( C6 div C7 ) * C7 ) ) = ( ( C6 - ( ( C6 div C7 ) * C7 ) ) + ( ( C6 div C7 ) * C7 ) ) by L11 , INT_1:def 10
.= ( C6 + ( 0 ) );
L13: ( ( C5 * C6 ) - ( C5 * ( C6 mod C7 ) ) ) = ( ( C5 * ( C6 div C7 ) ) * C7 ) by L12;
L14: C7 divides ( ( C5 * C6 ) - ( C5 * ( C6 mod C7 ) ) ) by L13 , INT_1:def 3;
L15: ( C5 * C6 ) , ( C5 * ( C6 mod C7 ) ) are_congruent_mod C7 by L14 , INT_2:15;
thus L16: thesis by L15 , NAT_D:64;
end;
theorem
L17: (for B8 , B9 , B10 being Nat holds ((1 <= B10 & ( 0 ) < B9) implies ( ( B8 mod ( B9 |^ B10 ) ) div ( B9 |^ ( B10 -' 1 ) ) ) = ( ( B8 div ( B9 |^ ( B10 -' 1 ) ) ) mod B9 )))
proof
let C8 , C9 , C10 being Nat;
assume that
L18: 1 <= C10
and
L19: ( 0 ) < C9;
set D1 = ( C10 -' 1 );
set D2 = ( C9 |^ D1 );
L20: D2 > ( 0 ) by L19 , PREPOWER:6;
set D3 = ( C9 |^ ( D1 + 1 ) );
L21: ( C8 mod D3 ) = ( C8 - ( D3 * ( C8 div D3 ) ) ) by L19 , NEWTON:63 , PREPOWER:6;
reconsider D4 = ( C9 * ( - ( C8 div D3 ) ) ) as Integer;
L22: ( D1 + 1 ) = ( ( C10 - 1 ) + 1 ) by L18 , XREAL_1:233
.= C10;
L23: ( ( C8 mod ( C9 |^ C10 ) ) div ( C9 |^ ( C10 -' 1 ) ) ) = ( ( C8 + ( D3 * ( - ( C8 div D3 ) ) ) ) div D2 ) by L22 , L21
.= ( ( C8 + ( ( D2 * C9 ) * ( - ( C8 div D3 ) ) ) ) div D2 ) by NEWTON:6
.= [\ ( ( C8 + ( D2 * D4 ) ) / D2 ) /] by INT_1:def 9
.= [\ ( ( C8 / D2 ) + D4 ) /] by L20 , XCMPLX_1:113
.= ( [\ ( C8 / D2 ) /] + D4 ) by INT_1:28
.= ( ( C8 div D2 ) + ( - ( C9 * ( C8 div D3 ) ) ) ) by INT_1:def 9
.= ( ( C8 div D2 ) - ( C9 * ( C8 div D3 ) ) )
.= ( ( C8 div D2 ) - ( C9 * ( C8 div ( D2 * C9 ) ) ) ) by NEWTON:6
.= ( ( C8 div D2 ) - ( C9 * ( ( C8 div D2 ) div C9 ) ) ) by NAT_2:27;
thus L24: thesis by L23 , L19 , NEWTON:63;
end;
theorem
L25: (for B11 , B12 being Nat holds (B11 in ( Seg B12 ) implies ( B11 + 1 ) in ( Seg ( B12 + 1 ) )))
proof
let C11 , C12 being Nat;
assume L26: C11 in ( Seg C12 );
L27: 1 <= C11 by L26 , FINSEQ_1:1;
L28: ( 1 + 1 ) <= ( C11 + 1 ) by L27 , XREAL_1:6;
L29: 1 <= ( C11 + 1 ) by L28 , XXREAL_0:2;
L30: C11 <= C12 by L26 , FINSEQ_1:1;
L31: ( C11 + 1 ) <= ( C12 + 1 ) by L30 , XREAL_1:6;
thus L32: thesis by L31 , L29 , FINSEQ_1:1;
end;
begin
theorem
L33: (for B13 being Nat holds ( Radix B13 ) > ( 0 ))
proof
let C13 being Nat;
L34: ( Radix C13 ) = ( 2 to_power C13 ) by RADIX_1:def 1;
thus L35: thesis by L34 , POWER:34;
end;
theorem
L36: (for R1 being Nat holds (for B14 being (Tuple of 1 , ( R1 -SD )) holds ( SDDec B14 ) = ( DigA (B14 , 1) )))
proof
let R1 being Nat;
L37: ( 1 - 1 ) = ( 0 );
L38: ( 1 -' 1 ) = ( 0 ) by L37 , XREAL_0:def 2;
let C14 being (Tuple of 1 , ( R1 -SD ));
L39: 1 in ( Seg 1 ) by FINSEQ_1:2 , TARSKI:def 1;
L40: ( ( DigitSD C14 ) /. 1 ) = ( SubDigit (C14 , 1 , R1) ) by L39 , RADIX_1:def 6;
L41: ( len ( DigitSD C14 ) ) = 1 by CARD_1:def 7;
L42: 1 in ( dom ( DigitSD C14 ) ) by L41 , L39 , FINSEQ_1:def 3;
L43: ( ( DigitSD C14 ) . 1 ) = ( SubDigit (C14 , 1 , R1) ) by L42 , L40 , PARTFUN1:def 6;
thus L44: ( SDDec C14 ) = ( Sum ( DigitSD C14 ) ) by RADIX_1:def 7
.= ( Sum <* ( SubDigit (C14 , 1 , R1) ) *> ) by L41 , L43 , FINSEQ_1:40
.= ( SubDigit (C14 , 1 , R1) ) by RVSUM_1:73
.= ( ( ( Radix R1 ) |^ ( 0 ) ) * ( DigB (C14 , 1) ) ) by L38 , RADIX_1:def 5
.= ( 1 * ( DigB (C14 , 1) ) ) by NEWTON:4
.= ( DigA (C14 , 1) ) by RADIX_1:def 4;
end;
theorem
L45: (for R1 being Nat holds (for B15 being Integer holds ( ( SD_Add_Data (B15 , R1) ) + ( ( SD_Add_Carry B15 ) * ( Radix R1 ) ) ) = B15))
proof
let R1 being Nat;
let C15 being Integer;
L46: ( ( SD_Add_Data (C15 , R1) ) + ( ( SD_Add_Carry C15 ) * ( Radix R1 ) ) ) = ( ( C15 - ( ( SD_Add_Carry C15 ) * ( Radix R1 ) ) ) + ( ( SD_Add_Carry C15 ) * ( Radix R1 ) ) ) by RADIX_1:def 11;
thus L47: thesis by L46;
end;
theorem
L48: (for R1 being Nat holds (for B16 being Nat holds (for B17 being (Tuple of ( B16 + 1 ) , ( R1 -SD )) holds (for B18 being (Tuple of B16 , ( R1 -SD )) holds ((for B19 being Nat holds (B19 in ( Seg B16 ) implies ( B17 . B19 ) = ( B18 . B19 ))) implies ( Sum ( DigitSD B17 ) ) = ( Sum ( ( DigitSD B18 ) ^ <* ( SubDigit (B17 , ( B16 + 1 ) , R1) ) *> ) ))))))
proof
let R1 being Nat;
let C16 being Nat;
let C17 being (Tuple of ( C16 + 1 ) , ( R1 -SD ));
let C18 being (Tuple of C16 , ( R1 -SD ));
L49: ( len ( DigitSD C17 ) ) = ( C16 + 1 ) by CARD_1:def 7;
assume L50: (for B20 being Nat holds (B20 in ( Seg C16 ) implies ( C17 . B20 ) = ( C18 . B20 )));
L51: (for B21 being (Element of ( NAT )) holds (B21 in ( Seg C16 ) implies ( DigA (C17 , B21) ) = ( DigA (C18 , B21) )))
proof
let C19 being (Element of ( NAT ));
assume L52: C19 in ( Seg C16 );
L53: C19 in ( Seg ( C16 + 1 ) ) by L52 , FINSEQ_2:8;
L54: ( DigA (C17 , C19) ) = ( C17 . C19 ) by L53 , RADIX_1:def 3
.= ( C18 . C19 ) by L50 , L52;
thus L55: thesis by L54 , L52 , RADIX_1:def 3;
end;
L56: ( len ( DigitSD C18 ) ) = C16 by CARD_1:def 7;
L57: (for B22 being Nat holds ((1 <= B22 & B22 <= ( len ( DigitSD C17 ) )) implies ( ( DigitSD C17 ) . B22 ) = ( ( ( DigitSD C18 ) ^ <* ( SubDigit (C17 , ( C16 + 1 ) , R1) ) *> ) . B22 )))
proof
let C20 being Nat;
assume that
L58: 1 <= C20
and
L59: C20 <= ( len ( DigitSD C17 ) );
L60: ( C16 + 1 ) in ( Seg ( C16 + 1 ) ) by FINSEQ_1:3;
L61: C20 <= ( C16 + 1 ) by L59 , CARD_1:def 7;
L62: C20 in ( Seg ( C16 + 1 ) ) by L61 , L58 , FINSEQ_1:1;
L63:
now
per cases  by L62 , FINSEQ_2:7;
suppose L64: C20 in ( Seg C16 );

L65: C20 in ( Seg ( C16 + 1 ) ) by L64 , FINSEQ_2:8;
L66: C20 in ( dom ( DigitSD C17 ) ) by L65 , L49 , FINSEQ_1:def 3;
L67: C20 in ( dom ( DigitSD C18 ) ) by L56 , L64 , FINSEQ_1:def 3;
L68: ( ( ( DigitSD C18 ) ^ <* ( SubDigit (C17 , ( C16 + 1 ) , R1) ) *> ) . C20 ) = ( ( DigitSD C18 ) . C20 ) by L67 , FINSEQ_1:def 7
.= ( ( DigitSD C18 ) /. C20 ) by L67 , PARTFUN1:def 6
.= ( SubDigit (C18 , C20 , R1) ) by L64 , RADIX_1:def 6
.= ( ( ( Radix R1 ) |^ ( C20 -' 1 ) ) * ( DigB (C18 , C20) ) ) by RADIX_1:def 5
.= ( ( ( Radix R1 ) |^ ( C20 -' 1 ) ) * ( DigA (C18 , C20) ) ) by RADIX_1:def 4
.= ( ( ( Radix R1 ) |^ ( C20 -' 1 ) ) * ( DigA (C17 , C20) ) ) by L51 , L64
.= ( ( ( Radix R1 ) |^ ( C20 -' 1 ) ) * ( DigB (C17 , C20) ) ) by RADIX_1:def 4
.= ( SubDigit (C17 , C20 , R1) ) by RADIX_1:def 5
.= ( ( DigitSD C17 ) /. C20 ) by L65 , RADIX_1:def 6;
thus L69: thesis by L68 , L66 , PARTFUN1:def 6;
end;
suppose L70: C20 = ( C16 + 1 );

L71: C20 in ( dom ( DigitSD C17 ) ) by L70 , L49 , L60 , FINSEQ_1:def 3;
L72: ( ( ( DigitSD C18 ) ^ <* ( SubDigit (C17 , ( C16 + 1 ) , R1) ) *> ) . C20 ) = ( ( ( DigitSD C18 ) ^ <* ( SubDigit (C17 , ( C16 + 1 ) , R1) ) *> ) . ( ( len ( DigitSD C18 ) ) + 1 ) ) by L70 , CARD_1:def 7
.= ( SubDigit (C17 , ( C16 + 1 ) , R1) ) by FINSEQ_1:42
.= ( ( DigitSD C17 ) /. ( C16 + 1 ) ) by L60 , RADIX_1:def 6
.= ( ( DigitSD C17 ) . ( C16 + 1 ) ) by L70 , L71 , PARTFUN1:def 6;
thus L73: thesis by L72 , L70;
end;
end;
thus L75: thesis by L63;
end;
L76: ( len <* ( SubDigit (C17 , ( C16 + 1 ) , R1) ) *> ) = 1 by FINSEQ_1:39;
L77: ( len ( ( DigitSD C18 ) ^ <* ( SubDigit (C17 , ( C16 + 1 ) , R1) ) *> ) ) = ( ( len ( DigitSD C18 ) ) + ( len <* ( SubDigit (C17 , ( C16 + 1 ) , R1) ) *> ) ) by FINSEQ_1:22
.= ( C16 + 1 ) by L76 , CARD_1:def 7;
L78: ( len ( DigitSD C17 ) ) = ( len ( ( DigitSD C18 ) ^ <* ( SubDigit (C17 , ( C16 + 1 ) , R1) ) *> ) ) by L77 , CARD_1:def 7;
thus L79: thesis by L78 , L57 , FINSEQ_1:14;
end;
theorem
L80: (for R1 being Nat holds (for B23 being Nat holds (for B24 being (Tuple of ( B23 + 1 ) , ( R1 -SD )) holds (for B25 being (Tuple of B23 , ( R1 -SD )) holds ((for B26 being Nat holds (B26 in ( Seg B23 ) implies ( B24 . B26 ) = ( B25 . B26 ))) implies ( ( SDDec B25 ) + ( ( ( Radix R1 ) |^ B23 ) * ( DigA (B24 , ( B23 + 1 )) ) ) ) = ( SDDec B24 ))))))
proof
let R1 being Nat;
let C21 being Nat;
let C22 being (Tuple of ( C21 + 1 ) , ( R1 -SD ));
let C23 being (Tuple of C21 , ( R1 -SD ));
assume L81: (for B27 being Nat holds (B27 in ( Seg C21 ) implies ( C22 . B27 ) = ( C23 . B27 )));
L82: ( SDDec C22 ) = ( Sum ( DigitSD C22 ) ) by RADIX_1:def 7
.= ( Sum ( ( DigitSD C23 ) ^ <* ( SubDigit (C22 , ( C21 + 1 ) , R1) ) *> ) ) by L81 , L48
.= ( ( Sum ( DigitSD C23 ) ) + ( SubDigit (C22 , ( C21 + 1 ) , R1) ) ) by RVSUM_1:74
.= ( ( Sum ( DigitSD C23 ) ) + ( ( ( Radix R1 ) |^ ( ( C21 + 1 ) -' 1 ) ) * ( DigB (C22 , ( C21 + 1 )) ) ) ) by RADIX_1:def 5
.= ( ( Sum ( DigitSD C23 ) ) + ( ( ( Radix R1 ) |^ C21 ) * ( DigB (C22 , ( C21 + 1 )) ) ) ) by NAT_D:34
.= ( ( Sum ( DigitSD C23 ) ) + ( ( ( Radix R1 ) |^ C21 ) * ( DigA (C22 , ( C21 + 1 )) ) ) ) by RADIX_1:def 4;
thus L83: thesis by L82 , RADIX_1:def 7;
end;
theorem
L84: (for R1 being Nat holds (for B28 being Nat holds (B28 >= 1 implies (for B29 , B30 being (Tuple of B28 , ( R1 -SD )) holds (R1 >= 2 implies ( ( SDDec ( B29 '+' B30 ) ) + ( ( SD_Add_Carry ( ( DigA (B29 , B28) ) + ( DigA (B30 , B28) ) ) ) * ( ( Radix R1 ) |^ B28 ) ) ) = ( ( SDDec B29 ) + ( SDDec B30 ) ))))))
proof
let R1 being Nat;
defpred S1[ Nat ] means (for B31 , B32 being (Tuple of $1 , ( R1 -SD )) holds (R1 >= 2 implies ( ( SDDec ( B31 '+' B32 ) ) + ( ( SD_Add_Carry ( ( DigA (B31 , $1) ) + ( DigA (B32 , $1) ) ) ) * ( ( Radix R1 ) |^ $1 ) ) ) = ( ( SDDec B31 ) + ( SDDec B32 ) )));
L85: (for B33 being Nat holds ((B33 >= 1 & S1[ B33 ]) implies S1[ ( B33 + 1 ) ]))
proof
let C24 being Nat;
assume that
L86: C24 >= 1
and
L87: S1[ C24 ];
L88: C24 in ( Seg C24 ) by L86 , FINSEQ_1:3;
let C25 , C26 being (Tuple of ( C24 + 1 ) , ( R1 -SD ));
assume L89: R1 >= 2;
deffunc H1(Nat) = ( DigB (C25 , $1) );
consider C27 being (FinSequence of ( INT )) such that L90: ( len C27 ) = C24 and L91: (for B34 being Nat holds (B34 in ( dom C27 ) implies ( C27 . B34 ) = H1(B34))) from FINSEQ_2:sch 1;
L92: ( dom C27 ) = ( Seg C24 ) by L90 , FINSEQ_1:def 3;
L93: ( rng C27 ) c= ( R1 -SD )
proof
let C28 being set;
assume L94: C28 in ( rng C27 );
consider C29 being set such that L95: C29 in ( dom C27 ) and L96: C28 = ( C27 . C29 ) by L94 , FUNCT_1:def 3;
reconsider D5 = C29 as (Element of ( NAT )) by L95;
L97: ( dom C27 ) = ( Seg C24 ) by L90 , FINSEQ_1:def 3;
L98: D5 in ( Seg ( C24 + 1 ) ) by L97 , L95 , FINSEQ_2:8;
L99: ( DigA (C25 , D5) ) is (Element of ( R1 -SD )) by L98 , RADIX_1:16;
L100: C28 = ( DigB (C25 , D5) ) by L91 , L95 , L96
.= ( DigA (C25 , D5) ) by RADIX_1:def 4;
thus L101: thesis by L100 , L99;
end;
reconsider D6 = C27 as (FinSequence of ( R1 -SD )) by L93 , FINSEQ_1:def 4;
L102: (for B35 being Nat holds (B35 in ( Seg C24 ) implies ( D6 . B35 ) = ( C25 . B35 )))
proof
let C30 being Nat;
assume L103: C30 in ( Seg C24 );
L104: C30 in ( Seg ( C24 + 1 ) ) by L103 , FINSEQ_2:8;
L105: ( D6 . C30 ) = ( DigB (C25 , C30) ) by L91 , L92 , L103
.= ( DigA (C25 , C30) ) by RADIX_1:def 4;
thus L106: thesis by L105 , L104 , RADIX_1:def 3;
end;
reconsider D7 = D6 as (Tuple of C24 , ( R1 -SD )) by L90 , CARD_1:def 7;
deffunc H2(Nat) = ( DigB (C26 , $1) );
consider C31 being (FinSequence of ( INT )) such that L107: ( len C31 ) = C24 and L108: (for B36 being Nat holds (B36 in ( dom C31 ) implies ( C31 . B36 ) = H2(B36))) from FINSEQ_2:sch 1;
L109: ( dom C31 ) = ( Seg C24 ) by L107 , FINSEQ_1:def 3;
L110: ( rng C31 ) c= ( R1 -SD )
proof
let C32 being set;
assume L111: C32 in ( rng C31 );
consider C33 being set such that L112: C33 in ( dom C31 ) and L113: C32 = ( C31 . C33 ) by L111 , FUNCT_1:def 3;
reconsider D8 = C33 as (Element of ( NAT )) by L112;
L114: ( dom C31 ) = ( Seg C24 ) by L107 , FINSEQ_1:def 3;
L115: D8 in ( Seg ( C24 + 1 ) ) by L114 , L112 , FINSEQ_2:8;
L116: ( DigA (C26 , D8) ) is (Element of ( R1 -SD )) by L115 , RADIX_1:16;
L117: C32 = ( DigB (C26 , D8) ) by L108 , L112 , L113
.= ( DigA (C26 , D8) ) by RADIX_1:def 4;
thus L118: thesis by L117 , L116;
end;
reconsider D9 = C31 as (FinSequence of ( R1 -SD )) by L110 , FINSEQ_1:def 4;
L119: (for B37 being Nat holds (B37 in ( Seg C24 ) implies ( D9 . B37 ) = ( C26 . B37 )))
proof
let C34 being Nat;
assume L120: C34 in ( Seg C24 );
L121: C34 in ( Seg ( C24 + 1 ) ) by L120 , FINSEQ_2:8;
L122: ( D9 . C34 ) = ( DigB (C26 , C34) ) by L108 , L109 , L120
.= ( DigA (C26 , C34) ) by RADIX_1:def 4;
thus L123: thesis by L122 , L121 , RADIX_1:def 3;
end;
reconsider D10 = D9 as (Tuple of C24 , ( R1 -SD )) by L107 , CARD_1:def 7;
L124: (for B38 being Nat holds (B38 in ( Seg C24 ) implies ( DigA (C26 , B38) ) = ( DigA (D10 , B38) )))
proof
let C35 being Nat;
assume L125: C35 in ( Seg C24 );
L126: C35 in ( Seg ( C24 + 1 ) ) by L125 , FINSEQ_2:8;
L127: ( DigA (C26 , C35) ) = ( C26 . C35 ) by L126 , RADIX_1:def 3
.= ( D10 . C35 ) by L119 , L125;
thus L128: thesis by L127 , L125 , RADIX_1:def 3;
end;
L129: ( C24 + 1 ) in ( Seg ( C24 + 1 ) ) by FINSEQ_1:3;
L130: (for B39 being (Element of ( NAT )) holds (B39 in ( Seg C24 ) implies ( DigA (C25 , B39) ) = ( DigA (D7 , B39) )))
proof
let C36 being (Element of ( NAT ));
assume L131: C36 in ( Seg C24 );
L132: C36 in ( Seg ( C24 + 1 ) ) by L131 , FINSEQ_2:8;
L133: ( DigA (C25 , C36) ) = ( C25 . C36 ) by L132 , RADIX_1:def 3
.= ( D7 . C36 ) by L102 , L131;
thus L134: thesis by L133 , L131 , RADIX_1:def 3;
end;
L135: (for B40 being Nat holds (B40 in ( Seg C24 ) implies ( ( C25 '+' C26 ) . B40 ) = ( ( D7 '+' D10 ) . B40 )))
proof
let C37 being Nat;
assume L136: C37 in ( Seg C24 );
L137: C37 in ( Seg ( C24 + 1 ) ) by L136 , FINSEQ_2:8;
L138: ( ( C25 '+' C26 ) . C37 ) = ( ( D7 '+' D10 ) . C37 )
proof
L139: C37 <= ( C24 + 1 ) by L137 , FINSEQ_1:1;
L140: C37 >= 1 by L136 , FINSEQ_1:1;
L141:
now
per cases  by L140 , XXREAL_0:1;
suppose L142: C37 > 1;

L143: ( C37 - 1 ) > ( 1 - 1 ) by L142 , XREAL_1:9;
L144: ( C37 -' 1 ) = ( C37 - 1 ) by L143 , XREAL_0:def 2;
L145: ( C37 -' 1 ) > ( 1 -' 1 ) by L142 , NAT_D:57;
L146: ( C37 -' 1 ) >= 1 by L145 , NAT_1:14;
L147: ( C37 - 1 ) <= ( ( C24 + 1 ) - 1 ) by L139 , XREAL_1:9;
L148: ( C37 -' 1 ) in ( Seg C24 ) by L147 , L146 , L144 , FINSEQ_1:1;
L149: ( ( C25 '+' C26 ) . C37 ) = ( DigA (( C25 '+' C26 ) , C37) ) by L137 , RADIX_1:def 3
.= ( Add (C25 , C26 , C37 , R1) ) by L137 , RADIX_1:def 14
.= ( ( SD_Add_Data (( ( DigA (C25 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C25 , ( C37 -' 1 )) ) + ( DigA (C26 , ( C37 -' 1 )) ) ) ) ) by L89 , L137 , RADIX_1:def 13
.= ( ( SD_Add_Data (( ( DigA (D7 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C25 , ( C37 -' 1 )) ) + ( DigA (C26 , ( C37 -' 1 )) ) ) ) ) by L130 , L136
.= ( ( SD_Add_Data (( ( DigA (D7 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( C37 -' 1 )) ) + ( DigA (C26 , ( C37 -' 1 )) ) ) ) ) by L130 , L148
.= ( ( SD_Add_Data (( ( DigA (D7 , C37) ) + ( DigA (D10 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( C37 -' 1 )) ) + ( DigA (C26 , ( C37 -' 1 )) ) ) ) ) by L124 , L136
.= ( ( SD_Add_Data (( ( DigA (D7 , C37) ) + ( DigA (D10 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( C37 -' 1 )) ) + ( DigA (D10 , ( C37 -' 1 )) ) ) ) ) by L124 , L148
.= ( Add (D7 , D10 , C37 , R1) ) by L89 , L136 , RADIX_1:def 13
.= ( DigA (( D7 '+' D10 ) , C37) ) by L136 , RADIX_1:def 14;
thus L150: thesis by L149 , L136 , RADIX_1:def 3;
end;
suppose L151: C37 = 1;

L152: ( ( C25 '+' C26 ) . C37 ) = ( DigA (( C25 '+' C26 ) , C37) ) by L137 , RADIX_1:def 3
.= ( Add (C25 , C26 , C37 , R1) ) by L137 , RADIX_1:def 14
.= ( ( SD_Add_Data (( ( DigA (C25 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C25 , ( 1 -' 1 )) ) + ( DigA (C26 , ( 1 -' 1 )) ) ) ) ) by L89 , L137 , L151 , RADIX_1:def 13
.= ( ( SD_Add_Data (( ( DigA (C25 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C25 , ( 0 )) ) + ( DigA (C26 , ( 1 -' 1 )) ) ) ) ) by XREAL_1:232
.= ( ( SD_Add_Data (( ( DigA (C25 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C25 , ( 0 )) ) + ( DigA (C26 , ( 0 )) ) ) ) ) by XREAL_1:232
.= ( ( SD_Add_Data (( ( DigA (C25 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( 0 ) + ( DigA (C26 , ( 0 )) ) ) ) ) by RADIX_1:def 3
.= ( ( SD_Add_Data (( ( DigA (C25 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( 0 ) + ( 0 ) ) ) ) by RADIX_1:def 3
.= ( ( SD_Add_Data (( ( DigA (C25 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( 0 )) ) + ( 0 ) ) ) ) by RADIX_1:def 3
.= ( ( SD_Add_Data (( ( DigA (C25 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( 0 )) ) + ( DigA (D10 , ( 0 )) ) ) ) ) by RADIX_1:def 3
.= ( ( SD_Add_Data (( ( DigA (D7 , C37) ) + ( DigA (C26 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( 0 )) ) + ( DigA (D10 , ( 0 )) ) ) ) ) by L130 , L136
.= ( ( SD_Add_Data (( ( DigA (D7 , C37) ) + ( DigA (D10 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( 0 )) ) + ( DigA (D10 , ( 0 )) ) ) ) ) by L124 , L136
.= ( ( SD_Add_Data (( ( DigA (D7 , C37) ) + ( DigA (D10 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( 1 -' 1 )) ) + ( DigA (D10 , ( 0 )) ) ) ) ) by XREAL_1:232
.= ( ( SD_Add_Data (( ( DigA (D7 , C37) ) + ( DigA (D10 , C37) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (D7 , ( C37 -' 1 )) ) + ( DigA (D10 , ( C37 -' 1 )) ) ) ) ) by L151 , XREAL_1:232
.= ( Add (D7 , D10 , C37 , R1) ) by L89 , L136 , RADIX_1:def 13
.= ( DigA (( D7 '+' D10 ) , C37) ) by L136 , RADIX_1:def 14;
thus L153: thesis by L152 , L136 , RADIX_1:def 3;
end;
end;
thus L155: thesis by L141;
end;
thus L156: thesis by L138;
end;
L157: ( Sum ( DigitSD ( C25 '+' C26 ) ) ) = ( Sum ( ( DigitSD ( D7 '+' D10 ) ) ^ <* ( SubDigit (( C25 '+' C26 ) , ( C24 + 1 ) , R1) ) *> ) ) by L135 , L48;
L158: ( SDDec ( C25 '+' C26 ) ) = ( Sum ( ( DigitSD ( D7 '+' D10 ) ) ^ <* ( SubDigit (( C25 '+' C26 ) , ( C24 + 1 ) , R1) ) *> ) ) by L157 , RADIX_1:def 7
.= ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( SubDigit (( C25 '+' C26 ) , ( C24 + 1 ) , R1) ) ) by RVSUM_1:74
.= ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( ( ( Radix R1 ) |^ ( ( C24 + 1 ) -' 1 ) ) * ( DigB (( C25 '+' C26 ) , ( C24 + 1 )) ) ) ) by RADIX_1:def 5
.= ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( DigB (( C25 '+' C26 ) , ( C24 + 1 )) ) ) ) by NAT_D:34
.= ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( DigA (( C25 '+' C26 ) , ( C24 + 1 )) ) ) ) by RADIX_1:def 4
.= ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( Add (C25 , C26 , ( C24 + 1 ) , R1) ) ) ) by L129 , RADIX_1:def 14
.= ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C25 , ( ( C24 + 1 ) -' 1 )) ) + ( DigA (C26 , ( ( C24 + 1 ) -' 1 )) ) ) ) ) ) ) by L89 , L129 , RADIX_1:def 13
.= ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C25 , C24) ) + ( DigA (C26 , ( ( C24 + 1 ) -' 1 )) ) ) ) ) ) ) by NAT_D:34
.= ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C25 , C24) ) + ( DigA (C26 , C24) ) ) ) ) ) ) by NAT_D:34
.= ( ( ( Sum ( DigitSD ( D7 '+' D10 ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Carry ( ( DigA (C25 , C24) ) + ( DigA (C26 , C24) ) ) ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) ) )
.= ( ( ( SDDec ( D7 '+' D10 ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Carry ( ( DigA (C25 , C24) ) + ( DigA (C26 , C24) ) ) ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) ) ) by RADIX_1:def 7
.= ( ( ( SDDec ( D7 '+' D10 ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Carry ( ( DigA (D7 , C24) ) + ( DigA (C26 , C24) ) ) ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) ) ) by L130 , L88
.= ( ( ( SDDec ( D7 '+' D10 ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Carry ( ( DigA (D7 , C24) ) + ( DigA (D10 , C24) ) ) ) ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) ) ) by L86 , L124 , FINSEQ_1:3
.= ( ( ( SDDec D7 ) + ( SDDec D10 ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) ) ) by L87 , L89;
L159: ( ( SDDec ( C25 '+' C26 ) ) + ( ( SD_Add_Carry ( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) ) * ( ( Radix R1 ) |^ ( C24 + 1 ) ) ) ) = ( ( ( SDDec D7 ) + ( SDDec D10 ) ) + ( ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) ) + ( ( SD_Add_Carry ( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) ) * ( ( Radix R1 ) |^ ( C24 + 1 ) ) ) ) ) by L158
.= ( ( ( SDDec D7 ) + ( SDDec D10 ) ) + ( ( ( ( Radix R1 ) |^ C24 ) * ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) ) + ( ( SD_Add_Carry ( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) ) * ( ( ( Radix R1 ) |^ C24 ) * ( Radix R1 ) ) ) ) ) by NEWTON:6
.= ( ( ( SDDec D7 ) + ( SDDec D10 ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( ( SD_Add_Data (( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) , R1) ) + ( ( SD_Add_Carry ( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) ) * ( Radix R1 ) ) ) ) )
.= ( ( ( SDDec D7 ) + ( SDDec D10 ) ) + ( ( ( Radix R1 ) |^ C24 ) * ( ( DigA (C25 , ( C24 + 1 )) ) + ( DigA (C26 , ( C24 + 1 )) ) ) ) ) by L45
.= ( ( ( SDDec D7 ) + ( ( ( Radix R1 ) |^ C24 ) * ( DigA (C25 , ( C24 + 1 )) ) ) ) + ( ( SDDec D10 ) + ( ( ( Radix R1 ) |^ C24 ) * ( DigA (C26 , ( C24 + 1 )) ) ) ) )
.= ( ( SDDec C25 ) + ( ( SDDec D10 ) + ( ( ( Radix R1 ) |^ C24 ) * ( DigA (C26 , ( C24 + 1 )) ) ) ) ) by L102 , L80;
thus L160: thesis by L159 , L119 , L80;
end;
L161: S1[ 1 ]
proof
L162: ( 1 - 1 ) = ( 0 );
L163: ( 1 -' 1 ) = ( 0 ) by L162 , XREAL_0:def 2;
let C38 , C39 being (Tuple of 1 , ( R1 -SD ));
assume L164: R1 >= 2;
L165: (( SDDec C39 ) = ( DigA (C39 , 1) ) & ( SD_Add_Data (( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) , R1) ) = ( ( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) - ( ( SD_Add_Carry ( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) ) * ( Radix R1 ) ) )) by L36 , RADIX_1:def 11;
L166: 1 in ( Seg 1 ) by FINSEQ_1:2 , TARSKI:def 1;
L167: ( DigA (( C38 '+' C39 ) , 1) ) = ( Add (C38 , C39 , 1 , R1) ) by L166 , RADIX_1:def 14
.= ( ( SD_Add_Data (( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) , R1) ) + ( SD_Add_Carry ( ( DigA (C38 , ( 0 )) ) + ( DigA (C39 , ( 0 )) ) ) ) ) by L164 , L166 , L163 , RADIX_1:def 13
.= ( ( SD_Add_Data (( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) , R1) ) + ( SD_Add_Carry ( ( 0 ) + ( DigA (C39 , ( 0 )) ) ) ) ) by RADIX_1:def 3
.= ( ( SD_Add_Data (( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) , R1) ) + ( 0 ) ) by RADIX_1:18 , RADIX_1:def 3;
L168: ( SDDec ( C38 '+' C39 ) ) = ( SD_Add_Data (( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) , R1) ) by L167 , L36;
thus L169: ( ( SDDec ( C38 '+' C39 ) ) + ( ( SD_Add_Carry ( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) ) * ( ( Radix R1 ) |^ 1 ) ) ) = ( ( SD_Add_Data (( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) , R1) ) + ( ( SD_Add_Carry ( ( DigA (C38 , 1) ) + ( DigA (C39 , 1) ) ) ) * ( Radix R1 ) ) ) by L168 , NEWTON:5
.= ( ( SDDec C38 ) + ( SDDec C39 ) ) by L165 , L36;
end;
L170: (for B41 being Nat holds (B41 >= 1 implies S1[ B41 ])) from NAT_1:sch 8(L161 , L85);
thus L171: thesis by L170;
end;
begin
definition
let C40 , C41 , C42 being Nat;
let C43 being (Tuple of C42 , ( NAT ));
func SubDigit2 (C43 , C40 , C41) -> (Element of ( NAT )) equals 
( ( ( Radix C41 ) |^ ( C40 -' 1 ) ) * ( C43 . C40 ) );
coherence;
end;
definition
let C44 , C45 being Nat;
let C46 being (Tuple of C44 , ( NAT ));
func DigitSD2 (C46 , C45) -> (Tuple of C44 , ( NAT )) means 
:L173: (for B42 being Nat holds (B42 in ( Seg C44 ) implies ( it /. B42 ) = ( SubDigit2 (C46 , B42 , C45) )));
existence
proof
deffunc H3(Nat) = ( SubDigit2 (C46 , $1 , C45) );
consider C47 being (FinSequence of ( NAT )) such that L174: ( len C47 ) = C44 and L175: (for B43 being Nat holds (B43 in ( dom C47 ) implies ( C47 . B43 ) = H3(B43))) from FINSEQ_2:sch 1;
L176: ( dom C47 ) = ( Seg C44 ) by L174 , FINSEQ_1:def 3;
reconsider D11 = C47 as (Tuple of C44 , ( NAT )) by L174 , CARD_1:def 7;
take D11;
let C48 being Nat;
assume L177: C48 in ( Seg C44 );
L178: C48 in ( dom D11 ) by L177 , L174 , FINSEQ_1:def 3;
thus L179: ( D11 /. C48 ) = ( D11 . C48 ) by L178 , PARTFUN1:def 6
.= ( SubDigit2 (C46 , C48 , C45) ) by L175 , L176 , L177;
end;
uniqueness
proof
let C49 , C50 being (Tuple of C44 , ( NAT ));
assume that
L180: (for B44 being Nat holds (B44 in ( Seg C44 ) implies ( C49 /. B44 ) = ( SubDigit2 (C46 , B44 , C45) )))
and
L181: (for B45 being Nat holds (B45 in ( Seg C44 ) implies ( C50 /. B45 ) = ( SubDigit2 (C46 , B45 , C45) )));
L182: ( len C49 ) = C44 by CARD_1:def 7;
L183: ( dom C49 ) = ( Seg C44 ) by L182 , FINSEQ_1:def 3;
L184: ( len C50 ) = C44 by CARD_1:def 7;
L185:
now
let C51 being Nat;
assume L186: C51 in ( dom C49 );
L187: C51 in ( dom C50 ) by L186 , L184 , L183 , FINSEQ_1:def 3;
L188: ( C49 . C51 ) = ( C49 /. C51 ) by L186 , PARTFUN1:def 6
.= ( SubDigit2 (C46 , C51 , C45) ) by L180 , L183 , L186
.= ( C50 /. C51 ) by L181 , L183 , L186;
thus L189: ( C49 . C51 ) = ( C50 . C51 ) by L188 , L187 , PARTFUN1:def 6;
end;
thus L190: thesis by L185 , L182 , L184 , FINSEQ_2:9;
end;
end;
definition
let C52 , C53 being Nat;
let C54 being (Tuple of C52 , ( NAT ));
func SDDec2 (C54 , C53) -> (Element of ( NAT )) equals 
( Sum ( DigitSD2 (C54 , C53) ) );
coherence;
end;
definition
let C55 , C56 , C57 being Nat;
func DigitDC2 (C57 , C55 , C56) -> (Element of ( NAT )) equals 
( ( C57 mod ( ( Radix C56 ) |^ C55 ) ) div ( ( Radix C56 ) |^ ( C55 -' 1 ) ) );
coherence;
end;
definition
let C58 , C59 , C60 being Nat;
func DecSD2 (C60 , C59 , C58) -> (Tuple of C59 , ( NAT )) means 
:L194: (for B46 being Nat holds (B46 in ( Seg C59 ) implies ( it . B46 ) = ( DigitDC2 (C60 , B46 , C58) )));
existence
proof
deffunc H4(Nat) = ( DigitDC2 (C60 , $1 , C58) );
consider C61 being (FinSequence of ( NAT )) such that L195: ( len C61 ) = C59 and L196: (for B47 being Nat holds (B47 in ( dom C61 ) implies ( C61 . B47 ) = H4(B47))) from FINSEQ_2:sch 1;
L197: ( dom C61 ) = ( Seg C59 ) by L195 , FINSEQ_1:def 3;
reconsider D12 = C61 as (Tuple of C59 , ( NAT )) by L195 , CARD_1:def 7;
take D12;
let C62 being Nat;
assume L198: C62 in ( Seg C59 );
thus L199: thesis by L198 , L196 , L197;
end;
uniqueness
proof
let C63 , C64 being (Tuple of C59 , ( NAT ));
assume that
L200: (for B48 being Nat holds (B48 in ( Seg C59 ) implies ( C63 . B48 ) = ( DigitDC2 (C60 , B48 , C58) )))
and
L201: (for B49 being Nat holds (B49 in ( Seg C59 ) implies ( C64 . B49 ) = ( DigitDC2 (C60 , B49 , C58) )));
L202: ( len C63 ) = C59 by CARD_1:def 7;
L203: ( dom C63 ) = ( Seg C59 ) by L202 , FINSEQ_1:def 3;
L204:
now
let C65 being Nat;
assume L205: C65 in ( dom C63 );
L206: ( C63 . C65 ) = ( DigitDC2 (C60 , C65 , C58) ) by L205 , L200 , L203;
thus L207: ( C63 . C65 ) = ( C64 . C65 ) by L206 , L201 , L203 , L205;
end;
L208: ( len C64 ) = C59 by CARD_1:def 7;
thus L209: thesis by L208 , L202 , L204 , FINSEQ_2:9;
end;
end;
theorem
L211: (for B50 , B51 being Nat holds (for B52 being (Tuple of B50 , ( NAT )) holds (for B53 being (Tuple of B50 , ( B51 -SD )) holds (B52 = B53 implies ( DigitSD2 (B52 , B51) ) = ( DigitSD B53 )))))
proof
let C66 , C67 being Nat;
let C68 being (Tuple of C66 , ( NAT ));
let C69 being (Tuple of C66 , ( C67 -SD ));
L212: ( len ( DigitSD C69 ) ) = C66 by CARD_1:def 7;
L213: ( len ( DigitSD2 (C68 , C67) ) ) = C66 by CARD_1:def 7;
L214: ( dom ( DigitSD2 (C68 , C67) ) ) = ( Seg C66 ) by L213 , FINSEQ_1:def 3;
assume L215: C68 = C69;
L216:
now
let C70 being (Element of ( NAT ));
assume L217: C70 in ( Seg C66 );
L218: ( C68 . C70 ) = ( DigA (C69 , C70) ) by L217 , L215 , RADIX_1:def 3
.= ( DigB (C69 , C70) ) by RADIX_1:def 4;
thus L219: ( C68 . C70 ) = ( DigB (C69 , C70) ) by L218;
end;
L220:
now
let C71 being Nat;
assume L221: C71 in ( dom ( DigitSD2 (C68 , C67) ) );
L222: C71 in ( dom ( DigitSD C69 ) ) by L221 , L212 , L214 , FINSEQ_1:def 3;
L223: ( ( DigitSD2 (C68 , C67) ) . C71 ) = ( ( DigitSD2 (C68 , C67) ) /. C71 ) by L221 , PARTFUN1:def 6
.= ( SubDigit2 (C68 , C71 , C67) ) by L214 , L221 , L173
.= ( ( ( Radix C67 ) |^ ( C71 -' 1 ) ) * ( DigB (C69 , C71) ) ) by L216 , L214 , L221
.= ( SubDigit (C69 , C71 , C67) ) by RADIX_1:def 5
.= ( ( DigitSD C69 ) /. C71 ) by L214 , L221 , RADIX_1:def 6
.= ( ( DigitSD C69 ) . C71 ) by L222 , PARTFUN1:def 6;
thus L224: ( ( DigitSD2 (C68 , C67) ) . C71 ) = ( ( DigitSD C69 ) . C71 ) by L223;
end;
thus L225: thesis by L220 , L213 , L212 , FINSEQ_2:9;
end;
theorem
L226: (for B54 , B55 being Nat holds (for B56 being (Tuple of B54 , ( NAT )) holds (for B57 being (Tuple of B54 , ( B55 -SD )) holds (B56 = B57 implies ( SDDec2 (B56 , B55) ) = ( SDDec B57 )))))
proof
let C72 , C73 being Nat;
let C74 being (Tuple of C72 , ( NAT ));
let C75 being (Tuple of C72 , ( C73 -SD ));
assume L227: C74 = C75;
L228: ( SDDec2 (C74 , C73) ) = ( Sum ( DigitSD C75 ) ) by L227 , L211;
thus L229: thesis by L228 , RADIX_1:def 7;
end;
theorem
L230: (for B58 , B59 , B60 being Nat holds ( DecSD2 (B58 , B59 , B60) ) = ( DecSD (B58 , B59 , B60) ))
proof
let C76 , C77 , C78 being Nat;
L231: ( len ( DecSD2 (C76 , C77 , C78) ) ) = C77 by CARD_1:def 7;
L232: ( dom ( DecSD2 (C76 , C77 , C78) ) ) = ( Seg C77 ) by L231 , FINSEQ_1:def 3;
L233:
now
let C79 being Nat;
assume L234: C79 in ( dom ( DecSD2 (C76 , C77 , C78) ) );
L235: ( ( DecSD2 (C76 , C77 , C78) ) . C79 ) = ( DigitDC2 (C76 , C79 , C78) ) by L234 , L232 , L194
.= ( DigitDC (C76 , C79 , C78) ) by RADIX_1:def 8
.= ( DigA (( DecSD (C76 , C77 , C78) ) , C79) ) by L232 , L234 , RADIX_1:def 9
.= ( ( DecSD (C76 , C77 , C78) ) . C79 ) by L232 , L234 , RADIX_1:def 3;
thus L236: ( ( DecSD2 (C76 , C77 , C78) ) . C79 ) = ( ( DecSD (C76 , C77 , C78) ) . C79 ) by L235;
end;
L237: ( len ( DecSD (C76 , C77 , C78) ) ) = C77 by CARD_1:def 7;
thus L238: thesis by L237 , L231 , L233 , FINSEQ_2:9;
end;
theorem
L239: (for B61 being Nat holds (B61 >= 1 implies (for B62 , B63 being Nat holds (B62 is_represented_by B61 , B63 implies B62 = ( SDDec2 (( DecSD2 (B62 , B61 , B63) ) , B63) )))))
proof
let C80 being Nat;
assume L240: C80 >= 1;
let C81 , C82 being Nat;
assume L241: C81 is_represented_by C80 , C82;
L242: ( SDDec2 (( DecSD2 (C81 , C80 , C82) ) , C82) ) = ( SDDec ( DecSD (C81 , C80 , C82) ) ) by L226 , L230;
thus L243: thesis by L242 , L240 , L241 , RADIX_1:22;
end;
begin
definition
let C83 being Integer;
let C84 , C85 , C86 , C87 being Nat;
let C88 being (Tuple of C87 , ( C86 -SD ));
func Table1 (C83 , C88 , C84 , C85) -> Integer equals 
( ( C83 * ( DigA (C88 , C85) ) ) mod C84 );
correctness;
end;
definition
let C89 being Integer;
let C90 , C91 , C92 being Nat;
let C93 being (Tuple of C92 , ( C90 -SD ));
assume L245: C92 >= 1;
func Mul_mod (C89 , C93 , C91 , C90) -> (Tuple of C92 , ( INT )) means 
:L246: (( it . 1 ) = ( Table1 (C89 , C93 , C91 , C92) ) & (for B64 being Nat holds ((1 <= B64 & B64 <= ( C92 - 1 )) implies (ex B65 , B66 being Integer st (B65 = ( it . B64 ) & B66 = ( it . ( B64 + 1 ) ) & B66 = ( ( ( ( Radix C90 ) * B65 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' B64 )) ) ) mod C91 ))))));
existence
proof
defpred S2[ (Element of ( NAT )) , set , set ] means (ex B67 , B68 being Integer st (B67 = $2 & B68 = $3 & B68 = ( ( ( ( Radix C90 ) * B67 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' $1 )) ) ) mod C91 )));
reconsider D13 = C92 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D14 = ( Table1 (C89 , C93 , C91 , C92) ) as (Element of ( INT )) by INT_1:def 2;
L247: (for B69 being (Element of ( NAT )) holds ((1 <= B69 & B69 < D13) implies (for B70 being (Element of ( INT )) holds (ex B71 being (Element of ( INT )) st S2[ B69 , B70 , B71 ]))))
proof
let C94 being (Element of ( NAT ));
assume that
L248: 1 <= C94
and
L249: C94 < D13;
let C95 being (Element of ( INT ));
reconsider D15 = C95 as Integer;
consider C96 being Integer such that L250: C96 = ( ( ( ( Radix C90 ) * D15 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' C94 )) ) ) mod C91 );
reconsider D16 = C96 as (Element of ( INT )) by INT_1:def 2;
take D16;
thus L251: thesis by L250;
end;
consider C97 being (FinSequence of ( INT )) such that L252: (( len C97 ) = D13 & (( C97 . 1 ) = D14 or D13 = ( 0 ))) and L253: (for B72 being (Element of ( NAT )) holds ((1 <= B72 & B72 < D13) implies S2[ B72 , ( C97 . B72 ) , ( C97 . ( B72 + 1 ) ) ])) from RECDEF_1:sch 4(L247);
reconsider D17 = C97 as (Tuple of C92 , ( INT )) by L252 , CARD_1:def 7;
take D17;
thus L254: ( D17 . 1 ) = ( Table1 (C89 , C93 , C91 , C92) ) by L245 , L252;
let C98 being Nat;
assume L255: (1 <= C98 & C98 <= ( C92 - 1 ));
L256: C98 in ( NAT ) by ORDINAL1:def 12;
thus L257: thesis by L256 , L253 , L255 , XREAL_1:147;
end;
uniqueness
proof
let C99 , C100 being (Tuple of C92 , ( INT ));
assume that
L258: ( C99 . 1 ) = ( Table1 (C89 , C93 , C91 , C92) )
and
L259: (for B73 being Nat holds ((1 <= B73 & B73 <= ( C92 - 1 )) implies (ex B74 , B75 being Integer st (B74 = ( C99 . B73 ) & B75 = ( C99 . ( B73 + 1 ) ) & B75 = ( ( ( ( Radix C90 ) * B74 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' B73 )) ) ) mod C91 )))))
and
L260: ( C100 . 1 ) = ( Table1 (C89 , C93 , C91 , C92) )
and
L261: (for B76 being Nat holds ((1 <= B76 & B76 <= ( C92 - 1 )) implies (ex B77 , B78 being Integer st (B77 = ( C100 . B76 ) & B78 = ( C100 . ( B76 + 1 ) ) & B78 = ( ( ( ( Radix C90 ) * B77 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' B76 )) ) ) mod C91 )))));
defpred S3[ Nat ] means ((1 <= $1 & $1 <= ( C92 - 1 )) implies ( C99 . $1 ) = ( C100 . $1 ));
L262: (for B79 being Nat holds (S3[ B79 ] implies S3[ ( B79 + 1 ) ]))
proof
let C101 being Nat;
assume L263: ((1 <= C101 & C101 <= ( C92 - 1 )) implies ( C99 . C101 ) = ( C100 . C101 ));
L264: (( 0 ) = C101 or (( 0 ) < C101 & ( ( 0 ) + 1 ) = 1));
assume that
L265: 1 <= ( C101 + 1 )
and
L266: ( C101 + 1 ) <= ( C92 - 1 );
per cases  by L264 , NAT_1:13;
suppose L267: ( 0 ) = C101;

thus L268: thesis by L267 , L258 , L260;
end;
suppose L269: 1 <= C101;

L270: C101 <= ( C101 + 1 ) by NAT_1:11;
L271: C101 <= ( C92 - 1 ) by L270 , L266 , XXREAL_0:2;
L272: ((ex B80 , B81 being Integer st (B80 = ( C99 . C101 ) & B81 = ( C99 . ( C101 + 1 ) ) & B81 = ( ( ( ( Radix C90 ) * B80 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' C101 )) ) ) mod C91 ))) & (ex B82 , B83 being Integer st (B82 = ( C100 . C101 ) & B83 = ( C100 . ( C101 + 1 ) ) & B83 = ( ( ( ( Radix C90 ) * B82 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' C101 )) ) ) mod C91 )))) by L271 , L259 , L261 , L269;
thus L273: thesis by L272 , L263 , L266 , L269 , L270 , XXREAL_0:2;
end;
end;
L275: ( len C99 ) = C92 by CARD_1:def 7;
L276: S3[ ( 0 ) ];
L277: (for B84 being Nat holds S3[ B84 ]) from NAT_1:sch 2(L276 , L262);
L278: ( C99 . C92 ) = ( C100 . C92 )
proof
L279: ( C92 - 1 ) >= ( 1 - 1 ) by L245 , XREAL_1:9;
reconsider D18 = ( C92 - 1 ) as (Element of ( NAT )) by L279 , INT_1:3;
L280:
now
per cases ;
suppose L281: D18 = ( 0 );

thus L282: thesis by L281 , L258 , L260;
end;
suppose L283: ( 0 ) < D18;

L284: 1 <= D18 by L283 , NAT_1:14;
L285: ((ex B85 , B86 being Integer st (B85 = ( C99 . D18 ) & B86 = ( C99 . ( D18 + 1 ) ) & B86 = ( ( ( ( Radix C90 ) * B85 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' D18 )) ) ) mod C91 ))) & (ex B87 , B88 being Integer st (B87 = ( C100 . D18 ) & B88 = ( C100 . ( D18 + 1 ) ) & B88 = ( ( ( ( Radix C90 ) * B87 ) + ( Table1 (C89 , C93 , C91 , ( C92 -' D18 )) ) ) mod C91 )))) by L284 , L259 , L261;
thus L286: thesis by L285 , L277 , L284;
end;
end;
thus L288: thesis by L280;
end;
L289: (for B89 being Nat holds ((1 <= B89 & B89 <= ( len C99 )) implies ( C99 . B89 ) = ( C100 . B89 )))
proof
let C102 being Nat;
assume that
L290: 1 <= C102
and
L291: C102 <= ( len C99 );
L292:
now
per cases  by L291 , XXREAL_0:1;
suppose L293: C102 < ( len C99 );

L294: ( C92 - 1 ) >= ( 1 - 1 ) by L245 , XREAL_1:9;
reconsider D19 = ( ( len C99 ) - 1 ) as (Element of ( NAT )) by L294 , L275 , INT_1:3;
L295: ( D19 + 1 ) = ( len C99 );
L296: C102 <= D19 by L295 , L293 , NAT_1:13;
thus L297: thesis by L296 , L275 , L277 , L290;
end;
suppose L298: C102 = ( len C99 );

thus L299: thesis by L298 , L275 , L278;
end;
end;
thus L301: thesis by L292;
end;
L302: ( len C99 ) = ( len C100 ) by L275 , CARD_1:def 7;
thus L303: thesis by L302 , L289 , FINSEQ_1:14;
end;
end;
theorem
L305: (for B90 being Nat holds (B90 >= 1 implies (for B91 being Integer holds (for B92 , B93 , B94 being Nat holds ((B92 is_represented_by B90 , B94 & B93 > ( 0 )) implies (for B95 being (Tuple of B90 , ( B94 -SD )) holds (B95 = ( DecSD (B92 , B90 , B94) ) implies ( ( Mul_mod (B91 , B95 , B93 , B94) ) . B90 ) = ( ( B91 * B92 ) mod B93 ))))))))
proof
defpred S4[ Nat ] means (for B96 being Integer holds (for B97 , B98 , B99 being Nat holds ((B97 is_represented_by $1 , B99 & B98 > ( 0 )) implies (for B100 being (Tuple of $1 , ( B99 -SD )) holds (B100 = ( DecSD (B97 , $1 , B99) ) implies ( ( Mul_mod (B96 , B100 , B98 , B99) ) . $1 ) = ( ( B96 * B97 ) mod B98 ))))));
L306: (for B101 being Nat holds ((B101 >= 1 & S4[ B101 ]) implies S4[ ( B101 + 1 ) ]))
proof
let C103 being Nat;
assume that
L307: C103 >= 1
and
L308: S4[ C103 ];
let C104 being Integer;
let C105 , C106 , C107 being Nat;
assume that
L309: C105 is_represented_by ( C103 + 1 ) , C107
and
L310: C106 > ( 0 );
let C108 being (Tuple of ( C103 + 1 ) , ( C107 -SD ));
deffunc H5(Nat) = ( DigB (C108 , ( $1 + 1 )) );
consider C109 being (FinSequence of ( INT )) such that L311: ( len C109 ) = C103 and L312: (for B102 being Nat holds (B102 in ( dom C109 ) implies ( C109 . B102 ) = H5(B102))) from FINSEQ_2:sch 1;
L313: ( dom C109 ) = ( Seg C103 ) by L311 , FINSEQ_1:def 3;
L314: ( rng C109 ) c= ( C107 -SD )
proof
let C110 being set;
assume L315: C110 in ( rng C109 );
consider C111 being set such that L316: C111 in ( dom C109 ) and L317: C110 = ( C109 . C111 ) by L315 , FUNCT_1:def 3;
reconsider D20 = C111 as (Element of ( NAT )) by L316;
L318: ( dom C109 ) = ( Seg C103 ) by L311 , FINSEQ_1:def 3;
L319: ( D20 + 1 ) in ( Seg ( C103 + 1 ) ) by L318 , L316 , L25;
L320: ( DigA (C108 , ( D20 + 1 )) ) is (Element of ( C107 -SD )) by L319 , RADIX_1:16;
L321: C110 = ( DigB (C108 , ( D20 + 1 )) ) by L312 , L316 , L317
.= ( DigA (C108 , ( D20 + 1 )) ) by RADIX_1:def 4;
thus L322: thesis by L321 , L320;
end;
reconsider D21 = C109 as (FinSequence of ( C107 -SD )) by L314 , FINSEQ_1:def 4;
reconsider D22 = D21 as (Tuple of C103 , ( C107 -SD )) by L311 , CARD_1:def 7;
L323: ( C103 + 1 ) >= 1 by NAT_1:12;
set D23 = ( DecSD2 (C105 , ( C103 + 1 ) , C107) );
L324: ( Radix C107 ) > ( 0 ) by L33;
deffunc H6(Nat) = ( D23 . ( $1 + 1 ) );
consider C112 being (FinSequence of ( NAT )) such that L325: ( len C112 ) = C103 and L326: (for B103 being Nat holds (B103 in ( dom C112 ) implies ( C112 . B103 ) = H6(B103))) from FINSEQ_2:sch 1;
L327: ( dom C112 ) = ( Seg C103 ) by L325 , FINSEQ_1:def 3;
reconsider D24 = C112 as (Tuple of C103 , ( NAT )) by L325 , CARD_1:def 7;
set D25 = ( SDDec2 (D24 , C107) );
L328: C105 < ( ( Radix C107 ) |^ ( C103 + 1 ) ) by L309 , RADIX_1:def 12;
set D26 = ( SDDec D22 );
assume L329: C108 = ( DecSD (C105 , ( C103 + 1 ) , C107) );
L330: D23 = C108 by L329 , L230;
L331: (for B104 being Nat holds ((1 <= B104 & B104 <= ( len D22 )) implies ( D22 . B104 ) = ( D24 . B104 )))
proof
let C113 being Nat;
assume L332: (1 <= C113 & C113 <= ( len D22 ));
L333: C113 in ( Seg C103 ) by L332 , L311 , FINSEQ_1:1;
L334: ( C113 + 1 ) in ( Seg ( C103 + 1 ) ) by L333 , L25;
L335: ( D22 . C113 ) = ( DigB (C108 , ( C113 + 1 )) ) by L312 , L313 , L333
.= ( DigA (C108 , ( C113 + 1 )) ) by RADIX_1:def 4
.= ( C108 . ( C113 + 1 ) ) by L334 , RADIX_1:def 3
.= ( D23 . ( C113 + 1 ) ) by L329 , L230;
thus L336: thesis by L335 , L326 , L327 , L333;
end;
L337: D26 = D25 by L331 , L311 , L325 , L226 , FINSEQ_1:14;
L338: 1 in ( Seg 1 ) by FINSEQ_1:2 , TARSKI:def 1;
L339: 1 in ( Seg ( 1 + C103 ) ) by L338 , FINSEQ_2:8;
L340: C105 = ( ( ( Radix C107 ) * D25 ) + ( D23 . 1 ) )
proof
L341: ( len <* ( SubDigit2 (D23 , 1 , C107) ) *> ) = 1 by FINSEQ_1:39;
L342: ( 1 - 1 ) = ( 0 );
deffunc H7(Nat) = ( ( DigitSD2 (D24 , C107) ) . $1 );
reconsider D27 = ( Radix C107 ) as (Element of ( REAL )) by XREAL_0:def 1;
consider C114 being (FinSequence of ( REAL )) such that L343: ( len C114 ) = C103 and L344: (for B105 being Nat holds (B105 in ( dom C114 ) implies ( C114 . B105 ) = H7(B105))) from FINSEQ_2:sch 1;
reconsider D28 = C114 as (Tuple of C103 , ( REAL )) by L343 , CARD_1:def 7;
L345: ( dom ( DigitSD2 (D24 , C107) ) ) = ( Seg ( len ( DigitSD2 (D24 , C107) ) ) ) by FINSEQ_1:def 3
.= ( Seg C103 ) by CARD_1:def 7;
reconsider D29 = D28 as (Element of ( C103 -tuples_on ( REAL ) )) by FINSEQ_2:131;
L346: ( dom D28 ) = ( Seg C103 ) by L343 , FINSEQ_1:def 3;
L347: ( len ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) = ( len ( D27 * D29 ) ) by L346 , L344 , L345 , FINSEQ_1:13
.= C103 by CARD_1:def 7;
L348: ( len ( <* ( SubDigit2 (D23 , 1 , C107) ) *> ^ ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) ) = ( ( len <* ( SubDigit2 (D23 , 1 , C107) ) *> ) + ( len ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) ) by FINSEQ_1:22
.= ( C103 + 1 ) by L347 , CARD_1:def 7;
L349: ( len ( DigitSD2 (D23 , C107) ) ) = ( C103 + 1 ) by CARD_1:def 7;
L350: (for B106 being Nat holds ((1 <= B106 & B106 <= ( len ( DigitSD2 (D23 , C107) ) )) implies ( ( DigitSD2 (D23 , C107) ) . B106 ) = ( ( <* ( SubDigit2 (D23 , 1 , C107) ) *> ^ ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) . B106 )))
proof
let C115 being Nat;
assume that
L351: 1 <= C115
and
L352: C115 <= ( len ( DigitSD2 (D23 , C107) ) );
L353: C115 <= ( C103 + 1 ) by L352 , CARD_1:def 7;
L354: C115 in ( Seg ( C103 + 1 ) ) by L353 , L351 , FINSEQ_1:1;
L355: C115 in ( dom ( DigitSD2 (D23 , C107) ) ) by L354 , L349 , FINSEQ_1:def 3;
per cases ;
suppose L356: C115 = 1;

L357: ( ( <* ( SubDigit2 (D23 , 1 , C107) ) *> ^ ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) . C115 ) = ( SubDigit2 (D23 , 1 , C107) ) by L356 , FINSEQ_1:41
.= ( ( DigitSD2 (D23 , C107) ) /. 1 ) by L339 , L173
.= ( ( DigitSD2 (D23 , C107) ) . 1 ) by L355 , L356 , PARTFUN1:def 6;
thus L358: thesis by L357 , L356;
end;
suppose L359: C115 <> 1;

reconsider D30 = ( ( DigitSD2 (D24 , C107) ) . ( C115 - 1 ) ) as (Element of ( NAT ));
reconsider D31 = ( D28 . ( C115 - 1 ) ) as Real;
L360: ( 1 - 1 ) <= ( C115 - 1 ) by L351 , XREAL_1:9;
reconsider D32 = ( C115 - 1 ) as (Element of ( NAT )) by L360 , INT_1:3;
L361: 1 < C115 by L351 , L359 , XXREAL_0:1;
L362: ( 1 + 1 ) <= C115 by L361 , INT_1:7;
L363: ( ( 1 + 1 ) - 1 ) <= ( C115 - 1 ) by L362 , XREAL_1:9;
L364: ( C115 - 1 ) <= ( ( C103 + 1 ) - 1 ) by L353 , XREAL_1:9;
L365: D32 in ( Seg C103 ) by L364 , L363 , FINSEQ_1:1;
L366: 1 < C115 by L351 , L359 , XXREAL_0:1;
L367: ( ( <* ( SubDigit2 (D23 , 1 , C107) ) *> ^ ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) . C115 ) = ( ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) . ( C115 - 1 ) ) by L366 , L341 , L348 , L353 , FINSEQ_1:24
.= ( ( D27 * D28 ) . ( C115 - 1 ) ) by L344 , L345 , L346 , FINSEQ_1:13
.= ( D27 * D31 ) by RVSUM_1:45
.= ( ( Radix C107 ) * D30 ) by L344 , L345 , L346 , FINSEQ_1:13
.= ( ( Radix C107 ) * ( ( DigitSD2 (D24 , C107) ) /. D32 ) ) by L345 , L365 , PARTFUN1:def 6
.= ( ( Radix C107 ) * ( SubDigit2 (D24 , D32 , C107) ) ) by L365 , L173
.= ( ( ( Radix C107 ) * ( ( Radix C107 ) |^ ( D32 -' 1 ) ) ) * ( D24 . D32 ) )
.= ( ( ( Radix C107 ) |^ ( ( D32 -' 1 ) + 1 ) ) * ( D24 . D32 ) ) by NEWTON:6
.= ( ( ( Radix C107 ) |^ D32 ) * ( D24 . D32 ) ) by L363 , XREAL_1:235
.= ( ( ( Radix C107 ) |^ D32 ) * ( D23 . ( D32 + 1 ) ) ) by L326 , L327 , L365
.= ( SubDigit2 (D23 , C115 , C107) ) by L351 , XREAL_1:233
.= ( ( DigitSD2 (D23 , C107) ) /. C115 ) by L354 , L173;
thus L368: thesis by L367 , L355 , PARTFUN1:def 6;
end;
end;
L370: ( len ( DigitSD2 (D23 , C107) ) ) = ( len ( <* ( SubDigit2 (D23 , 1 , C107) ) *> ^ ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) ) by L348 , CARD_1:def 7;
L371: ( DigitSD2 (D23 , C107) ) = ( <* ( SubDigit2 (D23 , 1 , C107) ) *> ^ ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) by L370 , L350 , FINSEQ_1:14;
L372: C105 = ( SDDec2 (( DecSD2 (C105 , ( C103 + 1 ) , C107) ) , C107) ) by L309 , L239 , NAT_1:12
.= ( ( SubDigit2 (D23 , 1 , C107) ) + ( Sum ( ( Radix C107 ) * ( DigitSD2 (D24 , C107) ) ) ) ) by L371 , RVSUM_1:76
.= ( ( SubDigit2 (D23 , 1 , C107) ) + ( Sum ( D27 * D28 ) ) ) by L344 , L345 , L346 , FINSEQ_1:13
.= ( ( SubDigit2 (D23 , 1 , C107) ) + ( D27 * ( Sum D28 ) ) ) by RVSUM_1:87
.= ( ( SubDigit2 (D23 , 1 , C107) ) + ( ( Radix C107 ) * D25 ) ) by L344 , L345 , L346 , FINSEQ_1:13
.= ( ( ( ( Radix C107 ) |^ ( 0 ) ) * ( D23 . 1 ) ) + ( ( Radix C107 ) * D25 ) ) by L342 , XREAL_0:def 2
.= ( ( 1 * ( D23 . 1 ) ) + ( ( Radix C107 ) * D25 ) ) by NEWTON:4;
thus L373: thesis by L372;
end;
L374: ( ( C104 * C105 ) mod C106 ) = ( ( ( ( C104 * ( Radix C107 ) ) * D25 ) + ( C104 * ( D23 . 1 ) ) ) mod C106 ) by L340
.= ( ( ( ( ( Radix C107 ) * ( C104 * D25 ) ) mod C106 ) + ( ( C104 * ( D23 . 1 ) ) mod C106 ) ) mod C106 ) by NAT_D:66
.= ( ( ( ( ( Radix C107 ) * ( ( C104 * D25 ) mod C106 ) ) mod C106 ) + ( ( C104 * ( D23 . 1 ) ) mod C106 ) ) mod C106 ) by L310 , L10
.= ( ( ( ( Radix C107 ) * ( ( C104 * D25 ) mod C106 ) ) + ( ( C104 * ( D23 . 1 ) ) mod C106 ) ) mod C106 ) by L310 , L4;
L375: D22 = D24 by L311 , L325 , L331 , FINSEQ_1:14;
L376: (for B107 being Nat holds ((1 <= B107 & B107 <= ( len D22 )) implies ( D22 . B107 ) = ( ( DecSD2 (D25 , C103 , C107) ) . B107 )))
proof
L377: ( D23 . 1 ) = ( DigitDC2 (C105 , 1 , C107) ) by L339 , L194
.= ( ( C105 mod ( ( Radix C107 ) |^ 1 ) ) div ( ( Radix C107 ) |^ ( 0 ) ) ) by XREAL_1:232
.= ( ( C105 mod ( ( Radix C107 ) |^ 1 ) ) div 1 ) by NEWTON:4
.= ( C105 mod ( ( Radix C107 ) |^ 1 ) ) by NAT_2:4
.= ( C105 mod ( Radix C107 ) ) by NEWTON:5;
L378: ( 0 ) < ( Radix C107 ) by L33;
L379: ( ( ( D23 . 1 ) + ( D25 * ( Radix C107 ) ) ) div ( Radix C107 ) ) = [\ ( ( ( D23 . 1 ) + ( D25 * ( Radix C107 ) ) ) / ( Radix C107 ) ) /] by INT_1:def 9
.= [\ ( ( ( D23 . 1 ) / ( Radix C107 ) ) + D25 ) /] by L378 , XCMPLX_1:113
.= ( [\ ( ( D23 . 1 ) / ( Radix C107 ) ) /] + D25 ) by INT_1:28
.= ( ( ( D23 . 1 ) div ( Radix C107 ) ) + D25 ) by INT_1:def 9
.= ( ( 0 ) + D25 ) by L324 , L377 , NAT_D:1 , NAT_D:27;
L380: ( Radix C107 ) <> ( 0 ) by L33;
let C116 being Nat;
assume that
L381: 1 <= C116
and
L382: C116 <= ( len D22 );
L383: C116 in ( Seg C103 ) by L311 , L381 , L382 , FINSEQ_1:1;
reconsider D33 = C116 as (Element of ( NAT )) by ORDINAL1:def 12;
L384: 1 <= ( D33 + 1 ) by L381 , XREAL_1:29;
L385: (1 <= ( D33 + 1 ) & ( D33 + 1 ) <= ( C103 + 1 )) by L311 , L381 , L382 , XREAL_1:6 , XREAL_1:29;
L386: ( D33 + 1 ) in ( Seg ( C103 + 1 ) ) by L385 , FINSEQ_1:1;
L387: ( D22 . D33 ) = ( D23 . ( D33 + 1 ) ) by L326 , L327 , L375 , L383
.= ( DigitDC2 (C105 , ( D33 + 1 ) , C107) ) by L386 , L194
.= ( ( ( ( D25 * ( Radix C107 ) ) + ( D23 . 1 ) ) div ( ( Radix C107 ) |^ ( ( D33 + 1 ) -' 1 ) ) ) mod ( Radix C107 ) ) by L340 , L384 , L17 , L33
.= ( ( ( ( D25 * ( Radix C107 ) ) + ( D23 . 1 ) ) div ( ( Radix C107 ) |^ D33 ) ) mod ( Radix C107 ) ) by NAT_D:34
.= ( ( ( ( D25 * ( Radix C107 ) ) + ( D23 . 1 ) ) div ( ( Radix C107 ) * ( ( Radix C107 ) |^ ( D33 -' 1 ) ) ) ) mod ( Radix C107 ) ) by L381 , L380 , PEPIN:26
.= ( ( D25 div ( ( Radix C107 ) |^ ( D33 -' 1 ) ) ) mod ( Radix C107 ) ) by L379 , NAT_2:27
.= ( DigitDC2 (D25 , D33 , C107) ) by L381 , L17 , L33;
thus L388: thesis by L387 , L383 , L194;
end;
reconsider D34 = D26 as (Element of ( NAT )) by L337;
L389: ( len D22 ) = ( len ( DecSD2 (D25 , C103 , C107) ) ) by L311 , CARD_1:def 7;
L390: D22 = ( DecSD2 (D25 , C103 , C107) ) by L389 , L376 , FINSEQ_1:14;
L391: D22 = ( DecSD (D34 , C103 , C107) ) by L390 , L337 , L230;
L392: C105 >= ( ( Radix C107 ) * D25 ) by L340 , INT_1:6;
L393: ( D25 * ( Radix C107 ) ) < ( ( Radix C107 ) |^ ( C103 + 1 ) ) by L392 , L328 , XXREAL_0:2;
L394: ( D25 * ( Radix C107 ) ) < ( ( ( Radix C107 ) |^ C103 ) * ( Radix C107 ) ) by L393 , NEWTON:6;
L395: D34 < ( ( Radix C107 ) |^ C103 ) by L394 , L337 , XREAL_1:64;
L396: D34 is_represented_by C103 , C107 by L395 , RADIX_1:def 12;
L397: (for B108 being (Element of ( NAT )) holds (B108 in ( Seg C103 ) implies ( DigA (D22 , B108) ) = ( DigA (C108 , ( B108 + 1 )) )))
proof
let C117 being (Element of ( NAT ));
assume L398: C117 in ( Seg C103 );
L399: ( DigA (C108 , ( C117 + 1 )) ) = ( DigB (C108 , ( C117 + 1 )) ) by RADIX_1:def 4
.= ( D22 . C117 ) by L312 , L313 , L398;
thus L400: thesis by L399 , L398 , RADIX_1:def 3;
end;
L401: (for B109 being (Element of ( NAT )) holds (B109 in ( Seg C103 ) implies ( ( Mul_mod (C104 , D22 , C106 , C107) ) . B109 ) = ( ( Mul_mod (C104 , C108 , C106 , C107) ) . B109 )))
proof
defpred S5[ (Element of ( NAT )) ] means ($1 in ( Seg C103 ) implies ( ( Mul_mod (C104 , D22 , C106 , C107) ) . $1 ) = ( ( Mul_mod (C104 , C108 , C106 , C107) ) . $1 ));
L402: (for B110 being (Element of ( NAT )) holds (S5[ B110 ] implies S5[ ( B110 + 1 ) ]))
proof
let C118 being (Element of ( NAT ));
assume L403: (C118 in ( Seg C103 ) implies ( ( Mul_mod (C104 , D22 , C106 , C107) ) . C118 ) = ( ( Mul_mod (C104 , C108 , C106 , C107) ) . C118 ));
L404: (C118 = ( 0 ) or ( C118 + 1 ) > ( 1 + ( 0 ) )) by XREAL_1:6;
assume L405: ( C118 + 1 ) in ( Seg C103 );
L406: ( C118 + 1 ) <= C103 by L405 , FINSEQ_1:1;
L407: ( ( C118 + 1 ) - 1 ) <= ( C103 - 1 ) by L406 , XREAL_1:9;
L408: C103 in ( Seg C103 ) by L307 , FINSEQ_1:1;
L409:
now
per cases  by L404 , NAT_1:13;
case L410: C118 = ( 0 );
L411: ( ( Mul_mod (C104 , D22 , C106 , C107) ) . ( C118 + 1 ) ) = ( Table1 (C104 , D22 , C106 , C103) ) by L410 , L307 , L246
.= ( Table1 (C104 , C108 , C106 , ( C103 + 1 )) ) by L397 , L408
.= ( ( Mul_mod (C104 , C108 , C106 , C107) ) . 1 ) by L323 , L246;
thus L412: thesis by L411 , L410;
end;
case L413: C118 >= 1;
reconsider D35 = ( C103 - 1 ) as (Element of ( NAT )) by L307 , INT_1:5;
L414: C118 <= ( D35 + 1 ) by L407 , NAT_1:12;
L415: C118 <= ( ( C103 + 1 ) - 1 ) by L414;
L416: (ex B111 , B112 being Integer st (B111 = ( ( Mul_mod (C104 , C108 , C106 , C107) ) . C118 ) & B112 = ( ( Mul_mod (C104 , C108 , C106 , C107) ) . ( C118 + 1 ) ) & B112 = ( ( ( ( Radix C107 ) * B111 ) + ( Table1 (C104 , C108 , C106 , ( ( C103 + 1 ) -' C118 )) ) ) mod C106 ))) by L415 , L323 , L413 , L246;
L417: ( C103 -' C118 ) <= C103 by NAT_D:35;
L418: ( ( 1 + C118 ) - C118 ) <= ( C103 - C118 ) by L406 , XREAL_1:9;
L419: 1 <= ( C103 -' C118 ) by L418 , L414 , XREAL_1:233;
L420: ( C103 -' C118 ) in ( Seg C103 ) by L419 , L417 , FINSEQ_1:1;
L421: (ex B113 , B114 being Integer st (B113 = ( ( Mul_mod (C104 , D22 , C106 , C107) ) . C118 ) & B114 = ( ( Mul_mod (C104 , D22 , C106 , C107) ) . ( C118 + 1 ) ) & B114 = ( ( ( ( Radix C107 ) * B113 ) + ( Table1 (C104 , D22 , C106 , ( C103 -' C118 )) ) ) mod C106 ))) by L307 , L407 , L413 , L246;
L422: ( ( Mul_mod (C104 , D22 , C106 , C107) ) . ( C118 + 1 ) ) = ( ( ( ( Radix C107 ) * ( ( Mul_mod (C104 , C108 , C106 , C107) ) . C118 ) ) + ( ( C104 * ( DigA (C108 , ( ( C103 -' C118 ) + 1 )) ) ) mod C106 ) ) mod C106 ) by L421 , L397 , L403 , L413 , L414 , L420 , FINSEQ_1:1
.= ( ( Mul_mod (C104 , C108 , C106 , C107) ) . ( C118 + 1 ) ) by L414 , L416 , NAT_D:38;
thus L423: thesis by L422;
end;
end;
thus L425: thesis by L409;
end;
L426: S5[ ( 0 ) ] by FINSEQ_1:1;
L427: (for B115 being (Element of ( NAT )) holds S5[ B115 ]) from NAT_1:sch 1(L426 , L402);
thus L428: thesis by L427;
end;
L429: (C103 <= ( ( C103 + 1 ) - 1 ) & ( C103 + 1 ) >= 1) by NAT_1:11;
L430: (ex B116 , B117 being Integer st (B116 = ( ( Mul_mod (C104 , C108 , C106 , C107) ) . C103 ) & B117 = ( ( Mul_mod (C104 , C108 , C106 , C107) ) . ( C103 + 1 ) ) & B117 = ( ( ( ( Radix C107 ) * B116 ) + ( Table1 (C104 , C108 , C106 , ( ( C103 + 1 ) -' C103 )) ) ) mod C106 ))) by L429 , L307 , L246;
L431: C103 in ( Seg C103 ) by L307 , FINSEQ_1:3;
L432: ( ( Mul_mod (C104 , C108 , C106 , C107) ) . ( C103 + 1 ) ) = ( ( ( ( Radix C107 ) * ( ( Mul_mod (C104 , D22 , C106 , C107) ) . C103 ) ) + ( Table1 (C104 , C108 , C106 , ( ( C103 + 1 ) -' C103 )) ) ) mod C106 ) by L431 , L401 , L430
.= ( ( ( ( Radix C107 ) * ( ( C104 * D34 ) mod C106 ) ) + ( Table1 (C104 , C108 , C106 , ( ( C103 + 1 ) -' C103 )) ) ) mod C106 ) by L308 , L310 , L396 , L391
.= ( ( ( ( Radix C107 ) * ( ( C104 * D25 ) mod C106 ) ) + ( Table1 (C104 , C108 , C106 , ( ( C103 + 1 ) -' C103 )) ) ) mod C106 ) by L311 , L325 , L331 , L226 , FINSEQ_1:14
.= ( ( ( ( Radix C107 ) * ( ( C104 * D25 ) mod C106 ) ) + ( ( C104 * ( DigA (C108 , 1) ) ) mod C106 ) ) mod C106 ) by NAT_D:34
.= ( ( ( ( Radix C107 ) * ( ( C104 * D25 ) mod C106 ) ) + ( ( C104 * ( D23 . 1 ) ) mod C106 ) ) mod C106 ) by L330 , L339 , RADIX_1:def 3;
thus L433: thesis by L432 , L374;
end;
L434: S4[ 1 ]
proof
let C119 being Integer;
let C120 , C121 , C122 being Nat;
assume that
L435: C120 is_represented_by 1 , C122
and
L436: C121 > ( 0 );
let C123 being (Tuple of 1 , ( C122 -SD ));
assume L437: C123 = ( DecSD (C120 , 1 , C122) );
L438: ( ( Mul_mod (C119 , C123 , C121 , C122) ) . 1 ) = ( Table1 (C119 , C123 , C121 , 1) ) by L246
.= ( ( C119 * ( SDDec ( DecSD (C120 , 1 , C122) ) ) ) mod C121 ) by L437 , L36;
thus L439: thesis by L438 , L435 , RADIX_1:22;
end;
L440: (for B118 being Nat holds (B118 >= 1 implies S4[ B118 ])) from NAT_1:sch 8(L434 , L306);
thus L441: thesis by L440;
end;
begin
definition
let C124 , C125 , C126 , C127 being Nat;
let C128 being (Tuple of C124 , ( NAT ));
func Table2 (C127 , C128 , C125 , C126) -> (Element of ( NAT )) equals 
( ( C127 |^ ( C128 /. C126 ) ) mod C125 );
correctness;
end;
definition
let C129 , C130 , C131 , C132 being Nat;
let C133 being (Tuple of C132 , ( NAT ));
assume L443: C132 >= 1;
func Pow_mod (C131 , C133 , C130 , C129) -> (Tuple of C132 , ( NAT )) means 
:L444: (( it . 1 ) = ( Table2 (C131 , C133 , C130 , C132) ) & (for B119 being Nat holds ((1 <= B119 & B119 <= ( C132 - 1 )) implies (ex B120 , B121 being Nat st (B120 = ( it . B119 ) & B121 = ( it . ( B119 + 1 ) ) & B121 = ( ( ( ( B120 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( C132 -' B119 )) ) ) mod C130 ))))));
existence
proof
reconsider D36 = C132 as (Element of ( NAT )) by ORDINAL1:def 12;
reconsider D37 = ( Table2 (C131 , C133 , C130 , C132) ) as (Element of ( NAT ));
defpred S6[ Nat , set , set ] means (ex B122 , B123 being Nat st (B122 = $2 & B123 = $3 & B123 = ( ( ( ( B122 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( D36 -' $1 )) ) ) mod C130 )));
L445: (for B124 being (Element of ( NAT )) holds ((1 <= B124 & B124 < D36) implies (for B125 being (Element of ( NAT )) holds (ex B126 being (Element of ( NAT )) st S6[ B124 , B125 , B126 ]))))
proof
let C134 being (Element of ( NAT ));
assume that
L446: 1 <= C134
and
L447: C134 < D36;
let C135 being (Element of ( NAT ));
reconsider D38 = C135 as (Element of ( NAT ));
consider C136 being (Element of ( NAT )) such that L448: C136 = ( ( ( ( D38 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( C132 -' C134 )) ) ) mod C130 );
reconsider D39 = C136 as (Element of ( NAT ));
take D39;
thus L449: thesis by L448;
end;
consider C137 being (FinSequence of ( NAT )) such that L450: (( len C137 ) = D36 & (( C137 . 1 ) = D37 or D36 = ( 0 ))) and L451: (for B127 being (Element of ( NAT )) holds ((1 <= B127 & B127 < D36) implies S6[ B127 , ( C137 . B127 ) , ( C137 . ( B127 + 1 ) ) ])) from RECDEF_1:sch 4(L445);
reconsider D40 = C137 as (Tuple of C132 , ( NAT )) by L450 , CARD_1:def 7;
take D40;
thus L452: ( D40 . 1 ) = ( Table2 (C131 , C133 , C130 , C132) ) by L443 , L450;
let C138 being Nat;
assume L453: (1 <= C138 & C138 <= ( C132 - 1 ));
L454: C138 in ( NAT ) by ORDINAL1:def 12;
thus L455: thesis by L454 , L451 , L453 , XREAL_1:147;
end;
uniqueness
proof
let C139 , C140 being (Tuple of C132 , ( NAT ));
assume that
L456: ( C139 . 1 ) = ( Table2 (C131 , C133 , C130 , C132) )
and
L457: (for B128 being Nat holds ((1 <= B128 & B128 <= ( C132 - 1 )) implies (ex B129 , B130 being Nat st (B129 = ( C139 . B128 ) & B130 = ( C139 . ( B128 + 1 ) ) & B130 = ( ( ( ( B129 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( C132 -' B128 )) ) ) mod C130 )))))
and
L458: ( C140 . 1 ) = ( Table2 (C131 , C133 , C130 , C132) )
and
L459: (for B131 being Nat holds ((1 <= B131 & B131 <= ( C132 - 1 )) implies (ex B132 , B133 being Nat st (B132 = ( C140 . B131 ) & B133 = ( C140 . ( B131 + 1 ) ) & B133 = ( ( ( ( B132 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( C132 -' B131 )) ) ) mod C130 )))));
defpred S7[ (Element of ( NAT )) ] means ((1 <= $1 & $1 <= ( C132 - 1 )) implies ( C139 . $1 ) = ( C140 . $1 ));
L460: (for B134 being (Element of ( NAT )) holds (S7[ B134 ] implies S7[ ( B134 + 1 ) ]))
proof
let C141 being (Element of ( NAT ));
assume L461: ((1 <= C141 & C141 <= ( C132 - 1 )) implies ( C139 . C141 ) = ( C140 . C141 ));
L462: (( 0 ) = C141 or (( 0 ) < C141 & ( ( 0 ) + 1 ) = 1));
assume that
L463: 1 <= ( C141 + 1 )
and
L464: ( C141 + 1 ) <= ( C132 - 1 );
per cases  by L462 , NAT_1:13;
suppose L465: ( 0 ) = C141;

thus L466: thesis by L465 , L456 , L458;
end;
suppose L467: 1 <= C141;

L468: C141 <= ( C141 + 1 ) by NAT_1:11;
L469: C141 <= ( C132 - 1 ) by L468 , L464 , XXREAL_0:2;
L470: ((ex B135 , B136 being Nat st (B135 = ( C139 . C141 ) & B136 = ( C139 . ( C141 + 1 ) ) & B136 = ( ( ( ( B135 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( C132 -' C141 )) ) ) mod C130 ))) & (ex B137 , B138 being Nat st (B137 = ( C140 . C141 ) & B138 = ( C140 . ( C141 + 1 ) ) & B138 = ( ( ( ( B137 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( C132 -' C141 )) ) ) mod C130 )))) by L469 , L457 , L459 , L467;
thus L471: thesis by L470 , L461 , L464 , L467 , L468 , XXREAL_0:2;
end;
end;
L473: ( len C139 ) = C132 by CARD_1:def 7;
L474: S7[ ( 0 ) ];
L475: (for B139 being (Element of ( NAT )) holds S7[ B139 ]) from NAT_1:sch 1(L474 , L460);
L476: ( C139 . C132 ) = ( C140 . C132 )
proof
L477: ( C132 - 1 ) >= ( 1 - 1 ) by L443 , XREAL_1:9;
reconsider D41 = ( C132 - 1 ) as (Element of ( NAT )) by L477 , INT_1:3;
L478:
now
per cases ;
suppose L479: D41 = ( 0 );

thus L480: thesis by L479 , L456 , L458;
end;
suppose L481: ( 0 ) < D41;

L482: 1 <= D41 by L481 , NAT_1:14;
L483: ((ex B140 , B141 being Nat st (B140 = ( C139 . D41 ) & B141 = ( C139 . ( D41 + 1 ) ) & B141 = ( ( ( ( B140 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( C132 -' D41 )) ) ) mod C130 ))) & (ex B142 , B143 being Nat st (B142 = ( C140 . D41 ) & B143 = ( C140 . ( D41 + 1 ) ) & B143 = ( ( ( ( B142 |^ ( Radix C129 ) ) mod C130 ) * ( Table2 (C131 , C133 , C130 , ( C132 -' D41 )) ) ) mod C130 )))) by L482 , L457 , L459;
thus L484: thesis by L483 , L475 , L482;
end;
end;
thus L486: thesis by L478;
end;
L487: (for B144 being Nat holds ((1 <= B144 & B144 <= ( len C139 )) implies ( C139 . B144 ) = ( C140 . B144 )))
proof
let C142 being Nat;
assume that
L488: 1 <= C142
and
L489: C142 <= ( len C139 );
L490: C142 in ( NAT ) by ORDINAL1:def 12;
L491:
now
per cases  by L489 , XXREAL_0:1;
suppose L492: C142 < ( len C139 );

L493: ( C132 - 1 ) >= ( 1 - 1 ) by L443 , XREAL_1:9;
reconsider D42 = ( ( len C139 ) - 1 ) as (Element of ( NAT )) by L493 , L473 , INT_1:3;
L494: ( D42 + 1 ) = ( len C139 );
L495: C142 <= D42 by L494 , L492 , NAT_1:13;
thus L496: thesis by L495 , L473 , L475 , L488 , L490;
end;
suppose L497: C142 = ( len C139 );

thus L498: thesis by L497 , L473 , L476;
end;
end;
thus L500: thesis by L491;
end;
L501: ( len C139 ) = ( len C140 ) by L473 , CARD_1:def 7;
thus L502: thesis by L501 , L487 , FINSEQ_1:14;
end;
end;
theorem
L504: (for B145 being Nat holds (B145 >= 1 implies (for B146 , B147 , B148 , B149 being Nat holds ((B149 is_represented_by B145 , B147 & B148 > ( 0 )) implies (for B150 being (Tuple of B145 , ( NAT )) holds (B150 = ( DecSD2 (B149 , B145 , B147) ) implies ( ( Pow_mod (B146 , B150 , B148 , B147) ) . B145 ) = ( ( B146 |^ B149 ) mod B148 )))))))
proof
defpred S8[ Nat ] means (for B151 , B152 , B153 , B154 being Nat holds ((B154 is_represented_by $1 , B152 & B153 > ( 0 )) implies (for B155 being (Tuple of $1 , ( NAT )) holds (B155 = ( DecSD2 (B154 , $1 , B152) ) implies ( ( Pow_mod (B151 , B155 , B153 , B152) ) . $1 ) = ( ( B151 |^ B154 ) mod B153 )))));
L505: (for B156 being Nat holds ((B156 >= 1 & S8[ B156 ]) implies S8[ ( B156 + 1 ) ]))
proof
let C143 being Nat;
assume that
L506: C143 >= 1
and
L507: S8[ C143 ];
let C144 , C145 , C146 , C147 being Nat;
L508: ( C143 + 1 ) >= 1 by NAT_1:12;
assume that
L509: C147 is_represented_by ( C143 + 1 ) , C145
and
L510: C146 > ( 0 );
let C148 being (Tuple of ( C143 + 1 ) , ( NAT ));
assume L511: C148 = ( DecSD2 (C147 , ( C143 + 1 ) , C145) );
reconsider D43 = C143 as (Element of ( NAT )) by ORDINAL1:def 12;
deffunc H8(Nat) = ( C148 . ( $1 + 1 ) );
consider C149 being (FinSequence of ( NAT )) such that L512: ( len C149 ) = D43 and L513: (for B157 being Nat holds (B157 in ( dom C149 ) implies ( C149 . B157 ) = H8(B157))) from FINSEQ_2:sch 1;
L514: ( dom C149 ) = ( Seg D43 ) by L512 , FINSEQ_1:def 3;
reconsider D44 = C149 as (Tuple of D43 , ( NAT )) by L512 , CARD_1:def 7;
L515: D43 in ( Seg D43 ) by L506 , FINSEQ_1:1;
L516: C147 < ( ( Radix C145 ) |^ ( D43 + 1 ) ) by L509 , RADIX_1:def 12;
set D45 = ( SDDec2 (D44 , C145) );
L517: 1 in ( Seg 1 ) by FINSEQ_1:2 , TARSKI:def 1;
L518: 1 in ( Seg ( 1 + D43 ) ) by L517 , FINSEQ_2:8;
L519: C147 = ( ( D45 * ( Radix C145 ) ) + ( C148 /. 1 ) )
proof
L520: ( len <* ( SubDigit2 (C148 , 1 , C145) ) *> ) = 1 by FINSEQ_1:39;
deffunc H9(Nat) = ( ( DigitSD2 (D44 , C145) ) . $1 );
reconsider D46 = ( Radix C145 ) as (Element of ( REAL )) by XREAL_0:def 1;
consider C150 being (FinSequence of ( REAL )) such that L521: ( len C150 ) = D43 and L522: (for B158 being Nat holds (B158 in ( dom C150 ) implies ( C150 . B158 ) = H9(B158))) from FINSEQ_2:sch 1;
reconsider D47 = C150 as (Tuple of D43 , ( REAL )) by L521 , CARD_1:def 7;
L523: ( dom D47 ) = ( Seg D43 ) by L521 , FINSEQ_1:def 3;
reconsider D48 = D47 as (Element of ( D43 -tuples_on ( REAL ) )) by FINSEQ_2:131;
L524: ( dom ( DigitSD2 (D44 , C145) ) ) = ( Seg ( len ( DigitSD2 (D44 , C145) ) ) ) by FINSEQ_1:def 3
.= ( Seg D43 ) by CARD_1:def 7;
L525: ( len ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) = ( len ( D46 * D48 ) ) by L524 , L522 , L523 , FINSEQ_1:13
.= D43 by CARD_1:def 7;
L526: ( len ( <* ( SubDigit2 (C148 , 1 , C145) ) *> ^ ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) ) = ( ( len <* ( SubDigit2 (C148 , 1 , C145) ) *> ) + ( len ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) ) by FINSEQ_1:22
.= ( D43 + 1 ) by L525 , CARD_1:def 7;
L527: ( len ( DigitSD2 (C148 , C145) ) ) = ( D43 + 1 ) by CARD_1:def 7;
L528: (for B159 being Nat holds ((1 <= B159 & B159 <= ( len ( DigitSD2 (C148 , C145) ) )) implies ( ( DigitSD2 (C148 , C145) ) . B159 ) = ( ( <* ( SubDigit2 (C148 , 1 , C145) ) *> ^ ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) . B159 )))
proof
let C151 being Nat;
assume that
L529: 1 <= C151
and
L530: C151 <= ( len ( DigitSD2 (C148 , C145) ) );
L531: C151 <= ( D43 + 1 ) by L530 , CARD_1:def 7;
L532: C151 in ( Seg ( D43 + 1 ) ) by L531 , L529 , FINSEQ_1:1;
L533: C151 in ( dom ( DigitSD2 (C148 , C145) ) ) by L532 , L527 , FINSEQ_1:def 3;
per cases ;
suppose L534: C151 = 1;

L535: ( ( <* ( SubDigit2 (C148 , 1 , C145) ) *> ^ ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) . C151 ) = ( SubDigit2 (C148 , 1 , C145) ) by L534 , FINSEQ_1:41
.= ( ( DigitSD2 (C148 , C145) ) /. 1 ) by L518 , L173
.= ( ( DigitSD2 (C148 , C145) ) . 1 ) by L533 , L534 , PARTFUN1:def 6;
thus L536: thesis by L535 , L534;
end;
suppose L537: C151 <> 1;

reconsider D49 = ( ( DigitSD2 (D44 , C145) ) . ( C151 - 1 ) ) as (Element of ( NAT ));
reconsider D50 = ( D47 . ( C151 - 1 ) ) as Real;
L538: ( 1 - 1 ) <= ( C151 - 1 ) by L529 , XREAL_1:9;
reconsider D51 = ( C151 - 1 ) as (Element of ( NAT )) by L538 , INT_1:3;
L539: 1 < C151 by L529 , L537 , XXREAL_0:1;
L540: ( 1 + 1 ) <= C151 by L539 , INT_1:7;
L541: ( ( 1 + 1 ) - 1 ) <= ( C151 - 1 ) by L540 , XREAL_1:9;
L542: ( C151 - 1 ) <= ( ( D43 + 1 ) - 1 ) by L531 , XREAL_1:9;
L543: D51 in ( Seg D43 ) by L542 , L541 , FINSEQ_1:1;
L544: D51 in ( dom D47 ) by L523 , L541 , L542 , FINSEQ_1:1;
L545: 1 < C151 by L529 , L537 , XXREAL_0:1;
L546: ( ( <* ( SubDigit2 (C148 , 1 , C145) ) *> ^ ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) . C151 ) = ( ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) . ( C151 - 1 ) ) by L545 , L520 , L526 , L531 , FINSEQ_1:24
.= ( ( D46 * D47 ) . ( C151 - 1 ) ) by L522 , L524 , L523 , FINSEQ_1:13
.= ( D46 * D50 ) by RVSUM_1:45
.= ( ( Radix C145 ) * D49 ) by L522 , L524 , L523 , FINSEQ_1:13
.= ( ( Radix C145 ) * ( ( DigitSD2 (D44 , C145) ) /. D51 ) ) by L524 , L523 , L544 , PARTFUN1:def 6
.= ( ( Radix C145 ) * ( SubDigit2 (D44 , D51 , C145) ) ) by L543 , L173
.= ( ( ( Radix C145 ) * ( ( Radix C145 ) |^ ( D51 -' 1 ) ) ) * ( D44 . D51 ) )
.= ( ( ( Radix C145 ) |^ ( ( D51 -' 1 ) + 1 ) ) * ( D44 . D51 ) ) by NEWTON:6
.= ( ( ( Radix C145 ) |^ D51 ) * ( D44 . D51 ) ) by L541 , XREAL_1:235
.= ( ( ( Radix C145 ) |^ D51 ) * ( C148 . ( D51 + 1 ) ) ) by L513 , L514 , L543
.= ( SubDigit2 (C148 , C151 , C145) ) by L529 , XREAL_1:233
.= ( ( DigitSD2 (C148 , C145) ) /. C151 ) by L532 , L173;
thus L547: thesis by L546 , L533 , PARTFUN1:def 6;
end;
end;
L549: ( len ( DigitSD2 (C148 , C145) ) ) = ( len ( <* ( SubDigit2 (C148 , 1 , C145) ) *> ^ ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) ) by L526 , CARD_1:def 7;
L550: ( DigitSD2 (C148 , C145) ) = ( <* ( SubDigit2 (C148 , 1 , C145) ) *> ^ ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) by L549 , L528 , FINSEQ_1:14;
L551: ( dom C148 ) = ( Seg ( len C148 ) ) by FINSEQ_1:def 3;
L552: 1 in ( dom C148 ) by L551 , L518 , CARD_1:def 7;
L553: ( 1 - 1 ) = ( 0 );
L554: C147 = ( SDDec2 (C148 , C145) ) by L509 , L511 , L239 , NAT_1:12
.= ( ( SubDigit2 (C148 , 1 , C145) ) + ( Sum ( ( Radix C145 ) * ( DigitSD2 (D44 , C145) ) ) ) ) by L550 , RVSUM_1:76
.= ( ( SubDigit2 (C148 , 1 , C145) ) + ( Sum ( D46 * D47 ) ) ) by L522 , L524 , L523 , FINSEQ_1:13
.= ( ( SubDigit2 (C148 , 1 , C145) ) + ( D46 * ( Sum D47 ) ) ) by RVSUM_1:87
.= ( ( SubDigit2 (C148 , 1 , C145) ) + ( ( Radix C145 ) * ( SDDec2 (D44 , C145) ) ) ) by L522 , L524 , L523 , FINSEQ_1:13
.= ( ( ( ( Radix C145 ) |^ ( 0 ) ) * ( C148 . 1 ) ) + ( ( Radix C145 ) * D45 ) ) by L553 , XREAL_0:def 2
.= ( ( 1 * ( C148 . 1 ) ) + ( ( Radix C145 ) * D45 ) ) by NEWTON:4;
thus L555: thesis by L554 , L552 , PARTFUN1:def 6;
end;
L556: C147 >= ( D45 * ( Radix C145 ) ) by L519 , INT_1:6;
L557: ( D45 * ( Radix C145 ) ) < ( ( Radix C145 ) |^ ( D43 + 1 ) ) by L556 , L516 , XXREAL_0:2;
L558: ( D45 * ( Radix C145 ) ) < ( ( ( Radix C145 ) |^ D43 ) * ( Radix C145 ) ) by L557 , NEWTON:6;
L559: D45 < ( ( Radix C145 ) |^ D43 ) by L558 , XREAL_1:64;
L560: D45 is_represented_by D43 , C145 by L559 , RADIX_1:def 12;
L561: ( D43 + 1 ) in ( Seg ( D43 + 1 ) ) by L508 , FINSEQ_1:1;
L562: (for B160 being (Element of ( NAT )) holds (B160 in ( Seg D43 ) implies ( ( Pow_mod (C144 , D44 , C146 , C145) ) . B160 ) = ( ( Pow_mod (C144 , C148 , C146 , C145) ) . B160 )))
proof
defpred S9[ (Element of ( NAT )) ] means ($1 in ( Seg D43 ) implies ( ( Pow_mod (C144 , D44 , C146 , C145) ) . $1 ) = ( ( Pow_mod (C144 , C148 , C146 , C145) ) . $1 ));
L563: (for B161 being (Element of ( NAT )) holds (S9[ B161 ] implies S9[ ( B161 + 1 ) ]))
proof
let C152 being (Element of ( NAT ));
assume L564: (C152 in ( Seg D43 ) implies ( ( Pow_mod (C144 , D44 , C146 , C145) ) . C152 ) = ( ( Pow_mod (C144 , C148 , C146 , C145) ) . C152 ));
L565: (C152 = ( 0 ) or ( C152 + 1 ) > ( 1 + ( 0 ) )) by XREAL_1:6;
L566: ( dom D44 ) = ( Seg D43 ) by L512 , FINSEQ_1:def 3;
assume L567: ( C152 + 1 ) in ( Seg D43 );
L568: ( C152 + 1 ) <= D43 by L567 , FINSEQ_1:1;
L569: ( ( C152 + 1 ) - 1 ) <= ( D43 - 1 ) by L568 , XREAL_1:9;
L570: ( dom C148 ) = ( Seg ( len C148 ) ) by FINSEQ_1:def 3;
L571: ( dom C148 ) = ( Seg ( D43 + 1 ) ) by L570 , CARD_1:def 7;
L572:
now
per cases  by L565 , NAT_1:13;
case L573: C152 = ( 0 );
L574: ( ( Pow_mod (C144 , D44 , C146 , C145) ) . ( C152 + 1 ) ) = ( Table2 (C144 , D44 , C146 , D43) ) by L573 , L506 , L444
.= ( ( C144 |^ ( D44 . D43 ) ) mod C146 ) by L515 , L566 , PARTFUN1:def 6
.= ( ( C144 |^ ( C148 . ( D43 + 1 ) ) ) mod C146 ) by L513 , L514 , L515
.= ( Table2 (C144 , C148 , C146 , ( D43 + 1 )) ) by L561 , L571 , PARTFUN1:def 6
.= ( ( Pow_mod (C144 , C148 , C146 , C145) ) . 1 ) by L508 , L444;
thus L575: thesis by L574 , L573;
end;
case L576: C152 >= 1;
reconsider D52 = ( D43 - 1 ) as (Element of ( NAT )) by L506 , INT_1:5;
L577: C152 <= ( D52 + 1 ) by L569 , NAT_1:12;
L578: C152 <= ( ( D43 + 1 ) - 1 ) by L577;
L579: (ex B162 , B163 being Nat st (B162 = ( ( Pow_mod (C144 , C148 , C146 , C145) ) . C152 ) & B163 = ( ( Pow_mod (C144 , C148 , C146 , C145) ) . ( C152 + 1 ) ) & B163 = ( ( ( ( B162 |^ ( Radix C145 ) ) mod C146 ) * ( Table2 (C144 , C148 , C146 , ( ( D43 + 1 ) -' C152 )) ) ) mod C146 ))) by L578 , L508 , L576 , L444;
L580: (ex B164 , B165 being Nat st (B164 = ( ( Pow_mod (C144 , D44 , C146 , C145) ) . C152 ) & B165 = ( ( Pow_mod (C144 , D44 , C146 , C145) ) . ( C152 + 1 ) ) & B165 = ( ( ( ( B164 |^ ( Radix C145 ) ) mod C146 ) * ( Table2 (C144 , D44 , C146 , ( D43 -' C152 )) ) ) mod C146 ))) by L506 , L569 , L576 , L444;
L581: ( D43 -' C152 ) <= D43 by NAT_D:35;
L582: ( C152 + 1 ) <= D43 by L567 , FINSEQ_1:1;
L583: ( ( C152 + 1 ) - 1 ) <= ( D43 - 1 ) by L582 , XREAL_1:9;
L584: ( ( D43 + 1 ) -' C152 ) >= ( ( D43 + 1 ) -' D52 ) by L583 , NAT_D:41;
L585: ( ( D43 + 1 ) -' C152 ) >= ( ( D43 + 1 ) - ( D43 - 1 ) ) by L584 , XREAL_0:def 2;
L586: (( ( D43 + 1 ) -' C152 ) <= ( D43 + 1 ) & 1 <= ( ( D43 + 1 ) -' C152 )) by L585 , NAT_D:35 , XXREAL_0:2;
L587: ( ( D43 + 1 ) -' C152 ) in ( Seg ( D43 + 1 ) ) by L586 , FINSEQ_1:1;
L588: ( ( D43 + 1 ) -' C152 ) in ( dom C148 ) by L587 , L570 , CARD_1:def 7;
L589: ( ( 1 + C152 ) - C152 ) <= ( D43 - C152 ) by L568 , XREAL_1:9;
L590: 1 <= ( D43 -' C152 ) by L589 , L577 , XREAL_1:233;
L591: ( D43 -' C152 ) in ( Seg D43 ) by L590 , L581 , FINSEQ_1:1;
L592: ( D43 -' C152 ) in ( dom D44 ) by L591 , L512 , FINSEQ_1:def 3;
L593: ( ( Pow_mod (C144 , D44 , C146 , C145) ) . ( C152 + 1 ) ) = ( ( ( ( ( ( Pow_mod (C144 , C148 , C146 , C145) ) . C152 ) |^ ( Radix C145 ) ) mod C146 ) * ( ( C144 |^ ( D44 . ( D43 -' C152 ) ) ) mod C146 ) ) mod C146 ) by L592 , L564 , L576 , L577 , L580 , FINSEQ_1:1 , PARTFUN1:def 6
.= ( ( ( ( ( ( Pow_mod (C144 , C148 , C146 , C145) ) . C152 ) |^ ( Radix C145 ) ) mod C146 ) * ( ( C144 |^ ( C148 . ( ( D43 -' C152 ) + 1 ) ) ) mod C146 ) ) mod C146 ) by L513 , L514 , L591
.= ( ( ( ( ( ( Pow_mod (C144 , C148 , C146 , C145) ) . C152 ) |^ ( Radix C145 ) ) mod C146 ) * ( ( C144 |^ ( C148 . ( ( D43 + 1 ) -' C152 ) ) ) mod C146 ) ) mod C146 ) by L577 , NAT_D:38
.= ( ( ( ( ( ( Pow_mod (C144 , C148 , C146 , C145) ) . C152 ) |^ ( Radix C145 ) ) mod C146 ) * ( Table2 (C144 , C148 , C146 , ( ( D43 + 1 ) -' C152 )) ) ) mod C146 ) by L588 , PARTFUN1:def 6;
thus L594: thesis by L593 , L579;
end;
end;
thus L596: thesis by L572;
end;
L597: S9[ ( 0 ) ] by FINSEQ_1:1;
L598: (for B166 being (Element of ( NAT )) holds S9[ B166 ]) from NAT_1:sch 1(L597 , L563);
thus L599: thesis by L598;
end;
L600: ( Radix C145 ) > ( 0 ) by L33;
L601: (for B167 being Nat holds ((1 <= B167 & B167 <= ( len D44 )) implies ( D44 . B167 ) = ( ( DecSD2 (D45 , D43 , C145) ) . B167 )))
proof
L602: ( dom C148 ) = ( Seg ( len C148 ) ) by FINSEQ_1:def 3;
L603: ( dom C148 ) = ( Seg ( D43 + 1 ) ) by L602 , CARD_1:def 7;
L604: ( C148 . 1 ) = ( DigitDC2 (C147 , 1 , C145) ) by L511 , L518 , L194
.= ( ( C147 mod ( ( Radix C145 ) |^ 1 ) ) div ( ( Radix C145 ) |^ ( 0 ) ) ) by XREAL_1:232
.= ( ( C147 mod ( ( Radix C145 ) |^ 1 ) ) div 1 ) by NEWTON:4
.= ( C147 mod ( ( Radix C145 ) |^ 1 ) ) by NAT_2:4
.= ( C147 mod ( Radix C145 ) ) by NEWTON:5;
L605: ( 0 ) < ( Radix C145 ) by L33;
L606: ( ( ( C148 . 1 ) + ( D45 * ( Radix C145 ) ) ) div ( Radix C145 ) ) = [\ ( ( ( C148 . 1 ) + ( D45 * ( Radix C145 ) ) ) / ( Radix C145 ) ) /] by INT_1:def 9
.= [\ ( ( ( C148 . 1 ) / ( Radix C145 ) ) + D45 ) /] by L605 , XCMPLX_1:113
.= ( [\ ( ( C148 . 1 ) / ( Radix C145 ) ) /] + D45 ) by INT_1:28
.= ( ( ( C148 . 1 ) div ( Radix C145 ) ) + D45 ) by INT_1:def 9
.= ( ( 0 ) + D45 ) by L600 , L604 , NAT_D:1 , NAT_D:27;
L607: ( Radix C145 ) <> ( 0 ) by L33;
let C153 being Nat;
assume that
L608: 1 <= C153
and
L609: C153 <= ( len D44 );
L610: 1 <= ( C153 + 1 ) by L608 , XREAL_1:29;
L611: (1 <= ( C153 + 1 ) & ( C153 + 1 ) <= ( D43 + 1 )) by L512 , L608 , L609 , XREAL_1:6 , XREAL_1:29;
L612: ( C153 + 1 ) in ( Seg ( D43 + 1 ) ) by L611 , FINSEQ_1:1;
L613: C153 in ( Seg D43 ) by L512 , L608 , L609 , FINSEQ_1:1;
L614: ( D44 . C153 ) = ( C148 . ( C153 + 1 ) ) by L613 , L513 , L514
.= ( DigitDC2 (C147 , ( C153 + 1 ) , C145) ) by L511 , L612 , L194
.= ( ( ( ( D45 * ( Radix C145 ) ) + ( C148 /. 1 ) ) div ( ( Radix C145 ) |^ ( ( C153 + 1 ) -' 1 ) ) ) mod ( Radix C145 ) ) by L519 , L610 , L17 , L33
.= ( ( ( ( D45 * ( Radix C145 ) ) + ( C148 . 1 ) ) div ( ( Radix C145 ) |^ ( ( C153 + 1 ) -' 1 ) ) ) mod ( Radix C145 ) ) by L517 , L603 , FINSEQ_2:8 , PARTFUN1:def 6
.= ( ( ( ( D45 * ( Radix C145 ) ) + ( C148 . 1 ) ) div ( ( Radix C145 ) |^ C153 ) ) mod ( Radix C145 ) ) by NAT_D:34
.= ( ( ( ( D45 * ( Radix C145 ) ) + ( C148 . 1 ) ) div ( ( Radix C145 ) * ( ( Radix C145 ) |^ ( C153 -' 1 ) ) ) ) mod ( Radix C145 ) ) by L608 , L607 , PEPIN:26
.= ( ( ( ( ( C148 . 1 ) + ( D45 * ( Radix C145 ) ) ) div ( Radix C145 ) ) div ( ( Radix C145 ) |^ ( C153 -' 1 ) ) ) mod ( Radix C145 ) ) by NAT_2:27
.= ( DigitDC2 (D45 , C153 , C145) ) by L608 , L606 , L17 , L33;
thus L615: thesis by L614 , L613 , L194;
end;
L616: ( len D44 ) = ( len ( DecSD2 (D45 , D43 , C145) ) ) by L512 , CARD_1:def 7;
L617: D44 = ( DecSD2 (D45 , D43 , C145) ) by L616 , L601 , FINSEQ_1:14;
L618: (D43 <= ( ( D43 + 1 ) - 1 ) & ( D43 + 1 ) >= 1) by NAT_1:11;
L619: (ex B168 , B169 being Nat st (B168 = ( ( Pow_mod (C144 , C148 , C146 , C145) ) . D43 ) & B169 = ( ( Pow_mod (C144 , C148 , C146 , C145) ) . ( D43 + 1 ) ) & B169 = ( ( ( ( B168 |^ ( Radix C145 ) ) mod C146 ) * ( Table2 (C144 , C148 , C146 , ( ( D43 + 1 ) -' D43 )) ) ) mod C146 ))) by L618 , L506 , L444;
L620: ( ( Pow_mod (C144 , C148 , C146 , C145) ) . ( D43 + 1 ) ) = ( ( ( ( ( ( Pow_mod (C144 , D44 , C146 , C145) ) . D43 ) |^ ( Radix C145 ) ) mod C146 ) * ( Table2 (C144 , C148 , C146 , ( ( D43 + 1 ) -' D43 )) ) ) mod C146 ) by L619 , L506 , L562 , FINSEQ_1:3
.= ( ( ( ( ( ( C144 |^ D45 ) mod C146 ) |^ ( Radix C145 ) ) mod C146 ) * ( Table2 (C144 , C148 , C146 , ( ( D43 + 1 ) -' D43 )) ) ) mod C146 ) by L507 , L510 , L560 , L617
.= ( ( ( ( ( C144 |^ D45 ) |^ ( Radix C145 ) ) mod C146 ) * ( Table2 (C144 , C148 , C146 , ( ( D43 + 1 ) -' D43 )) ) ) mod C146 ) by PEPIN:12
.= ( ( ( ( C144 |^ D45 ) |^ ( Radix C145 ) ) * ( Table2 (C144 , C148 , C146 , ( ( D43 + 1 ) -' D43 )) ) ) mod C146 ) by EULER_2:8
.= ( ( ( C144 |^ ( D45 * ( Radix C145 ) ) ) * ( Table2 (C144 , C148 , C146 , ( ( D43 + 1 ) -' D43 )) ) ) mod C146 ) by NEWTON:9
.= ( ( ( C144 |^ ( D45 * ( Radix C145 ) ) ) * ( ( C144 |^ ( C148 /. 1 ) ) mod C146 ) ) mod C146 ) by NAT_D:34
.= ( ( ( C144 |^ ( D45 * ( Radix C145 ) ) ) * ( C144 |^ ( C148 /. 1 ) ) ) mod C146 ) by EULER_2:7
.= ( ( C144 |^ ( ( D45 * ( Radix C145 ) ) + ( C148 /. 1 ) ) ) mod C146 ) by NEWTON:8;
thus L621: thesis by L620 , L519;
end;
L622: S8[ 1 ]
proof
let C154 , C155 , C156 , C157 being Nat;
assume that
L623: C157 is_represented_by 1 , C155
and
L624: C156 > ( 0 );
L625: C157 < ( ( Radix C155 ) |^ 1 ) by L623 , RADIX_1:def 12;
L626: C157 < ( Radix C155 ) by L625 , NEWTON:5;
let C158 being (Tuple of 1 , ( NAT ));
L627: ( 1 - 1 ) = ( 0 );
L628: 1 in ( Seg 1 ) by FINSEQ_1:2 , TARSKI:def 1;
L629: ( len ( DecSD2 (C157 , 1 , C155) ) ) = 1 by CARD_1:def 7;
L630: 1 in ( dom ( DecSD2 (C157 , 1 , C155) ) ) by L629 , L628 , FINSEQ_1:def 3;
assume L631: C158 = ( DecSD2 (C157 , 1 , C155) );
L632: ( C158 /. 1 ) = ( ( DecSD2 (C157 , 1 , C155) ) . 1 ) by L631 , L630 , PARTFUN1:def 6
.= ( DigitDC2 (C157 , 1 , C155) ) by L628 , L194
.= ( ( C157 mod ( ( Radix C155 ) |^ 1 ) ) div ( ( Radix C155 ) |^ ( 0 ) ) ) by L627 , XREAL_0:def 2
.= ( ( C157 mod ( ( Radix C155 ) |^ 1 ) ) div 1 ) by NEWTON:4
.= ( C157 mod ( ( Radix C155 ) |^ 1 ) ) by NAT_2:4
.= ( C157 mod ( Radix C155 ) ) by NEWTON:5
.= C157 by L626 , NAT_D:24;
L633: ( ( C154 |^ C157 ) mod C156 ) = ( Table2 (C154 , C158 , C156 , 1) ) by L632;
thus L634: thesis by L633 , L444;
end;
L635: (for B170 being Nat holds (B170 >= 1 implies S8[ B170 ])) from NAT_1:sch 8(L622 , L505);
thus L636: thesis by L635;
end;
