:: More on the Lattice of Congruences in a Many Sorted Algebra
::  by Robert Milewski
::
:: Received March 6, 1996
:: Copyright (c) 1996-2012 Association of Mizar Users
::           (Stowarzyszenie Uzytkownikow Mizara, Bialystok, Poland).
:: This code can be distributed under the GNU General Public Licence
:: version 3.0 or later, or the Creative Commons Attribution-ShareAlike
:: License version 3.0 or later, subject to the binding interpretation
:: detailed in file COPYING.interpretation.
:: See COPYING.GPL and COPYING.CC-BY-SA for the full text of these
:: licenses, or see http://www.gnu.org/licenses/gpl.html and
:: http://creativecommons.org/licenses/by-sa/3.0/.

environ

 vocabularies XBOOLE_0, PBOOLE, SUBSET_1, NUMBERS, FINSEQ_1, STRUCT_0,
      MSUALG_1, RELAT_1, XXREAL_0, ARYTM_3, FUNCT_1, MSUALG_5, EQREL_1, TARSKI,
      LATTICES, XXREAL_2, REWRITE1, LATTICE3, SETFAM_1, ZFMISC_1, CARD_1,
      MSUALG_4, CLOSURE2, NAT_1, MARGREL1, PARTFUN1, FUNCT_4, FINSET_1, CARD_3,
      MSUALG_6, MSUALG_7, MSUALG_8;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, SETFAM_1, RELAT_1, RELSET_1,
      DOMAIN_1, NUMBERS, STRUCT_0, ORDINAL1, NAT_1, BINOP_1, FUNCT_1, PARTFUN1,
      FUNCT_2, FINSET_1, FINSEQ_1, CARD_3, REWRITE1, EQREL_1, LATTICES,
      LATTICE3, PBOOLE, MSSUBFAM, MSUALG_1, MSUALG_4, MSUALG_5, CLOSURE2,
      MSUALG_6, MSUALG_7, XXREAL_0;
 constructors BINOP_1, NAT_1, MEMBERED, REALSET1, REWRITE1, MSSUBFAM, LATTICE3,
      MSUALG_5, CLOSURE2, MSUALG_6, MSUALG_7, RELSET_1;
 registrations SUBSET_1, RELSET_1, PARTFUN1, FINSET_1, MEMBERED, EQREL_1,
      PBOOLE, STRUCT_0, LATTICES, MSUALG_1, MSUALG_3, MSUALG_5, CLOSURE2,
      MSUALG_6, MSUALG_7, FUNCT_1;
 requirements NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, XBOOLE_0, EQREL_1;
 theorems XBOOLE_0, TARSKI, PBOOLE, NAT_LAT, MSUALG_4, MSUALG_5, MSUALG_7,
      CLOSURE2, SETFAM_1, LATTICES, LATTICE3, MSSUBFAM, ZFMISC_1, FINSEQ_1,
      SUBSET_1, REWRITE1, RELAT_1, MSUALG_6, FUNCT_2, NAT_1, EQREL_1, VECTSP_8,
      CARD_3, XBOOLE_1, PARTFUN1;
 schemes FINSEQ_1, PARTFUN1, CLASSES1;

begin
theorem
L1: (for B1 being (Element of ( NAT )) holds (for B2 being FinSequence holds ((1 <= B1 & B1 < ( len B2 )) iff (B1 in ( dom B2 ) & ( B1 + 1 ) in ( dom B2 )))))
proof
let C1 being (Element of ( NAT ));
let C2 being FinSequence;
thus L2: ((1 <= C1 & C1 < ( len C2 )) implies (C1 in ( dom C2 ) & ( C1 + 1 ) in ( dom C2 )))
proof
assume that
L3: 1 <= C1
and
L4: C1 < ( len C2 );
L5: (1 <= ( C1 + 1 ) & ( C1 + 1 ) <= ( len C2 )) by L4 , NAT_1:11 , NAT_1:13;
L6: ( C1 + 1 ) in ( Seg ( len C2 ) ) by L5 , FINSEQ_1:1;
L7: C1 in ( Seg ( len C2 ) ) by L3 , L4 , FINSEQ_1:1;
thus L8: thesis by L7 , L6 , FINSEQ_1:def 3;
end;

thus L9: ((C1 in ( dom C2 ) & ( C1 + 1 ) in ( dom C2 )) implies (1 <= C1 & C1 < ( len C2 )))
proof
assume that
L10: C1 in ( dom C2 )
and
L11: ( C1 + 1 ) in ( dom C2 );
L12: ( C1 + 1 ) in ( Seg ( len C2 ) ) by L11 , FINSEQ_1:def 3;
L13: ( C1 + 1 ) <= ( len C2 ) by L12 , FINSEQ_1:1;
L14: C1 in ( Seg ( len C2 ) ) by L10 , FINSEQ_1:def 3;
thus L15: thesis by L14 , L13 , FINSEQ_1:1 , NAT_1:13;
end;

end;
scheme NonUniqSeqEx { F1() -> (Element of ( NAT )) , P1[set , set] } : (ex R10 being FinSequence st (( dom R10 ) = ( Seg F1() ) & (for R9 being (Element of ( NAT )) holds (R9 in ( Seg F1() ) implies P1[ R9 , ( R10 . R9 ) ]))))
provided
L10: (for R9 being (Element of ( NAT )) holds (R9 in ( Seg F1() ) implies (ex R4 being set st P1[ R9 , R4 ])))
proof
L11: (for R4 being set holds (R4 in ( Seg F1() ) implies (ex R5 being set st P1[ R4 , R5 ]))) by L10;
consider C3 being Function such that L12: (( dom C3 ) = ( Seg F1() ) & (for R4 being set holds (R4 in ( Seg F1() ) implies P1[ R4 , ( C3 . R4 ) ]))) from CLASSES1:sch 1(L11);
reconsider D1 = C3 as FinSequence by L12 , FINSEQ_1:def 2;
take D1;
thus L13: thesis by L12;
end;
theorem
L14: (for R3 being set holds (for B3 , B4 being (Element of ( EqRelLatt R3 )) holds (for B5 , B6 being (Equivalence_Relation of R3) holds ((B3 = B5 & B4 = B6) implies (B3 [= B4 iff B5 c= B6)))))
proof
let R3 being set;
let C4 , C5 being (Element of ( EqRelLatt R3 ));
let C6 , C7 being (Equivalence_Relation of R3);
assume that
L15: C4 = C6
and
L16: C5 = C7;
thus L17: (C4 [= C5 implies C6 c= C7)
proof
assume L18: C4 [= C5;
L19: ( C6 /\ C7 ) = ( (the L_meet of ( EqRelLatt R3 )) . (C6 , C7) ) by MSUALG_5:def 2
.= ( C4 "/\" C5 ) by L15 , L16 , LATTICES:def 2
.= C6 by L15 , L18 , LATTICES:4;
thus L20: thesis by L19 , XBOOLE_1:17;
end;

thus L21: (C6 c= C7 implies C4 [= C5)
proof
assume L22: C6 c= C7;
L23: ( C4 "/\" C5 ) = ( (the L_meet of ( EqRelLatt R3 )) . (C6 , C7) ) by L15 , L16 , LATTICES:def 2
.= ( C6 /\ C7 ) by MSUALG_5:def 2
.= C4 by L15 , L22 , XBOOLE_1:28;
thus L24: thesis by L23 , LATTICES:4;
end;

end;
registration
let R3 being set;
cluster ( EqRelLatt R3 ) ->  bounded;
coherence
proof
L22: (ex B7 being (Element of ( EqRelLatt R3 )) st (for B8 being (Element of ( EqRelLatt R3 )) holds (( B7 "\/" B8 ) = B7 & ( B8 "\/" B7 ) = B7)))
proof
set D2 = ( nabla R3 );
reconsider D3 = D2 as (Element of ( EqRelLatt R3 )) by MSUALG_5:21;
take D3;
let C8 being (Element of ( EqRelLatt R3 ));
reconsider D4 = C8 as (Equivalence_Relation of R3) by MSUALG_5:21;
thus L23: ( D3 "\/" C8 ) = ( (the L_join of ( EqRelLatt R3 )) . (D3 , C8) ) by LATTICES:def 1
.= ( D2 "\/" D4 ) by MSUALG_5:def 2
.= ( EqCl ( D2 \/ D4 ) ) by MSUALG_5:1
.= ( EqCl D2 ) by EQREL_1:1
.= D3 by MSUALG_5:2;
thus L24: thesis by L23;
end;
L25: ( EqRelLatt R3 ) is  upper-bounded by L22 , LATTICES:def 14;
L26: (ex B9 being (Element of ( EqRelLatt R3 )) st (for B10 being (Element of ( EqRelLatt R3 )) holds (( B9 "/\" B10 ) = B9 & ( B10 "/\" B9 ) = B9)))
proof
set D5 = ( id R3 );
reconsider D6 = D5 as (Element of ( EqRelLatt R3 )) by MSUALG_5:21;
take D6;
let C9 being (Element of ( EqRelLatt R3 ));
reconsider D7 = C9 as (Equivalence_Relation of R3) by MSUALG_5:21;
thus L27: ( D6 "/\" C9 ) = ( (the L_meet of ( EqRelLatt R3 )) . (D6 , C9) ) by LATTICES:def 2
.= ( D5 /\ D7 ) by MSUALG_5:def 2
.= D6 by EQREL_1:10;
thus L28: thesis by L27;
end;
L29: ( EqRelLatt R3 ) is  lower-bounded by L26 , LATTICES:def 13;
thus L30: thesis by L29 , L25;
end;
end;
theorem
L32: (for R3 being set holds ( Bottom ( EqRelLatt R3 ) ) = ( id R3 ))
proof
let R3 being set;
reconsider D8 = ( id R3 ) as (Element of ( EqRelLatt R3 )) by MSUALG_5:21;
L33:
now
let C10 being (Element of ( EqRelLatt R3 ));
reconsider D9 = C10 as (Equivalence_Relation of R3) by MSUALG_5:21;
thus L34: ( D8 "/\" C10 ) = ( (the L_meet of ( EqRelLatt R3 )) . (D8 , C10) ) by LATTICES:def 2
.= ( ( id R3 ) /\ D9 ) by MSUALG_5:def 2
.= D8 by EQREL_1:10;
thus L35: ( C10 "/\" D8 ) = D8 by L34;
end;
thus L36: thesis by L33 , LATTICES:def 16;
end;
theorem
L37: (for R3 being set holds ( Top ( EqRelLatt R3 ) ) = ( nabla R3 ))
proof
let R3 being set;
reconsider D10 = ( nabla R3 ) as (Element of ( EqRelLatt R3 )) by MSUALG_5:21;
L38:
now
let C11 being (Element of ( EqRelLatt R3 ));
reconsider D11 = C11 as (Equivalence_Relation of R3) by MSUALG_5:21;
thus L39: ( D10 "\/" C11 ) = ( (the L_join of ( EqRelLatt R3 )) . (D10 , C11) ) by LATTICES:def 1
.= ( ( nabla R3 ) "\/" D11 ) by MSUALG_5:def 2
.= ( EqCl ( ( nabla R3 ) \/ D11 ) ) by MSUALG_5:1
.= ( EqCl ( nabla R3 ) ) by EQREL_1:1
.= D10 by MSUALG_5:2;
thus L40: ( C11 "\/" D10 ) = D10 by L39;
end;
thus L41: thesis by L38 , LATTICES:def 17;
end;
theorem
L42: (for R3 being set holds ( EqRelLatt R3 ) is  complete)
proof
let R3 being set;
L43: (for B11 being (Subset of ( EqRelLatt R3 )) holds (ex B12 being (Element of ( EqRelLatt R3 )) st (B12 is_less_than B11 & (for B13 being (Element of ( EqRelLatt R3 )) holds (B13 is_less_than B11 implies B13 [= B12)))))
proof
let C12 being (Subset of ( EqRelLatt R3 ));
per cases ;
suppose L44: C12 is  empty;

take D12 = ( Top ( EqRelLatt R3 ) );
L45: (for B14 being (Element of ( EqRelLatt R3 )) holds (B14 in C12 implies D12 [= B14)) by L44;
thus L46: D12 is_less_than C12 by L45 , LATTICE3:def 16;
let C13 being (Element of ( EqRelLatt R3 ));
assume L47: C13 is_less_than C12;
thus L48: thesis by LATTICES:19;
end;
suppose L49: C12 is non  empty;

set D13 = ( meet C12 );
L50: C12 c= ( bool [: R3 , R3 :] )
proof
let R4 being set;
assume L51: R4 in C12;
L52: R4 is (Equivalence_Relation of R3) by L51 , MSUALG_5:21;
thus L53: thesis by L52;
end;
reconsider D14 = C12 as (Subset-Family of [: R3 , R3 :]) by L50;
L54: (for B15 being set holds (B15 in C12 implies B15 is (Equivalence_Relation of R3))) by MSUALG_5:21;
L55: ( meet D14 ) is (Equivalence_Relation of R3) by L54 , L49 , EQREL_1:11;
reconsider D15 = D13 as (Equivalence_Relation of R3) by L55;
set D16 = D15;
reconsider D17 = D15 as (Element of ( EqRelLatt R3 )) by MSUALG_5:21;
take D17;
L56:
now
let C14 being (Element of ( EqRelLatt R3 ));
reconsider D18 = C14 as (Equivalence_Relation of R3) by MSUALG_5:21;
assume L57: C14 in C12;
L58: D16 c= D18 by L57 , SETFAM_1:3;
thus L59: D17 [= C14 by L58 , L14;
end;
thus L60: D17 is_less_than C12 by L56 , LATTICE3:def 16;
L61:
now
let C15 being (Element of ( EqRelLatt R3 ));
reconsider D19 = C15 as (Equivalence_Relation of R3) by MSUALG_5:21;
assume L62: C15 is_less_than C12;
L63:
now
let R4 being set;
assume L64: R4 in D19;
L65:
now
let C16 being set;
assume L66: C16 in C12;
reconsider D20 = C16 as (Element of ( EqRelLatt R3 )) by L66;
reconsider D21 = D20 as (Equivalence_Relation of R3) by MSUALG_5:21;
L67: C15 [= D20 by L62 , L66 , LATTICE3:def 16;
L68: D19 c= D21 by L67 , L14;
thus L69: R4 in C16 by L68 , L64;
end;
thus L70: R4 in ( meet C12 ) by L65 , L49 , SETFAM_1:def 1;
end;
L71: D19 c= ( meet C12 ) by L63 , TARSKI:def 3;
thus L72: C15 [= D17 by L71 , L14;
end;
thus L73: thesis by L61;
end;
end;
thus L75: thesis by L43 , VECTSP_8:def 6;
end;
registration
let R3 being set;
cluster ( EqRelLatt R3 ) ->  complete;
coherence by L42;
end;
theorem
L77: (for B16 being set holds (for B17 being (Subset of ( EqRelLatt B16 )) holds ( union B17 ) is (Relation of B16)))
proof
let C17 being set;
let C18 being (Subset of ( EqRelLatt C17 ));
L78:
now
let R4 being set;
assume L79: R4 in ( union C18 );
consider C19 being set such that L80: R4 in C19 and L81: C19 in C18 by L79 , TARSKI:def 4;
L82: C19 is (Equivalence_Relation of C17) by L81 , MSUALG_5:21;
thus L83: R4 in [: C17 , C17 :] by L82 , L80;
end;
thus L84: thesis by L78 , TARSKI:def 3;
end;
theorem
L85: (for B18 being set holds (for B19 being (Subset of ( EqRelLatt B18 )) holds ( union B19 ) c= ( "\/" B19 )))
proof
let C20 being set;
let C21 being (Subset of ( EqRelLatt C20 ));
reconsider D22 = ( "\/" C21 ) as (Equivalence_Relation of C20) by MSUALG_5:21;
let R4 being set;
assume L86: R4 in ( union C21 );
consider C22 being set such that L87: R4 in C22 and L88: C22 in C21 by L86 , TARSKI:def 4;
reconsider D23 = C22 as (Element of ( EqRelLatt C20 )) by L88;
reconsider D24 = D23 as (Equivalence_Relation of C20) by MSUALG_5:21;
L89: C21 is_less_than ( "\/" C21 ) by LATTICE3:def 21;
L90: D23 [= ( "\/" C21 ) by L89 , L88 , LATTICE3:def 17;
L91: D24 c= D22 by L90 , L14;
thus L92: thesis by L91 , L87;
end;
theorem
L93: (for B20 being set holds (for B21 being (Subset of ( EqRelLatt B20 )) holds (for B22 being (Relation of B20) holds (B22 = ( union B21 ) implies ( "\/" B21 ) = ( EqCl B22 )))))
proof
let C23 being set;
let C24 being (Subset of ( EqRelLatt C23 ));
let C25 being (Relation of C23);
reconsider D25 = ( "\/" C24 ) as (Equivalence_Relation of C23) by MSUALG_5:21;
assume L94: C25 = ( union C24 );
L95:
now
let C26 being (Equivalence_Relation of C23);
reconsider D26 = C26 as (Element of ( EqRelLatt C23 )) by MSUALG_5:21;
assume L96: C25 c= C26;
L97:
now
let C27 being (Element of ( EqRelLatt C23 ));
reconsider D27 = C27 as (Equivalence_Relation of C23) by MSUALG_5:21;
assume L98: C27 in C24;
L99:
now
let R4 being set;
assume L100: R4 in D27;
L101: R4 in ( union C24 ) by L100 , L98 , TARSKI:def 4;
thus L102: R4 in C26 by L101 , L94 , L96;
end;
L103: D27 c= C26 by L99 , TARSKI:def 3;
thus L104: C27 [= D26 by L103 , L14;
end;
L105: C24 is_less_than D26 by L97 , LATTICE3:def 17;
L106: ( "\/" C24 ) [= D26 by L105 , LATTICE3:def 21;
thus L107: D25 c= C26 by L106 , L14;
end;
L108: C25 c= ( "\/" C24 ) by L94 , L85;
thus L109: thesis by L108 , L95 , MSUALG_5:def 1;
end;
theorem
L110: (for B23 being set holds (for B24 being (Subset of ( EqRelLatt B23 )) holds (for B25 being Relation holds (B25 = ( union B24 ) implies B25 = ( B25 ~ )))))
proof
let C28 being set;
let C29 being (Subset of ( EqRelLatt C28 ));
let C30 being Relation;
assume L111: C30 = ( union C29 );
L112:
now
let R4 being set;
let R5 being set;
thus L113: ([ R4 , R5 ] in C30 implies [ R4 , R5 ] in ( C30 ~ ))
proof
assume L114: [ R4 , R5 ] in C30;
consider C31 being set such that L115: [ R4 , R5 ] in C31 and L116: C31 in C29 by L114 , L111 , TARSKI:def 4;
reconsider D28 = C31 as (Equivalence_Relation of C28) by L116 , MSUALG_5:21;
L117: [ R5 , R4 ] in D28 by L115 , EQREL_1:6;
L118: [ R5 , R4 ] in C30 by L117 , L111 , L116 , TARSKI:def 4;
thus L119: thesis by L118 , RELAT_1:def 7;
end;

thus L120: ([ R4 , R5 ] in ( C30 ~ ) implies [ R4 , R5 ] in C30)
proof
assume L121: [ R4 , R5 ] in ( C30 ~ );
L122: [ R5 , R4 ] in C30 by L121 , RELAT_1:def 7;
consider C32 being set such that L123: [ R5 , R4 ] in C32 and L124: C32 in C29 by L122 , L111 , TARSKI:def 4;
reconsider D29 = C32 as (Equivalence_Relation of C28) by L124 , MSUALG_5:21;
L125: [ R4 , R5 ] in D29 by L123 , EQREL_1:6;
thus L126: thesis by L125 , L111 , L124 , TARSKI:def 4;
end;

end;
thus L121: thesis by L112 , RELAT_1:def 2;
end;
theorem
L122: (for R4 being set holds (for R5 being set holds (for B26 being set holds (for B27 being (Subset of ( EqRelLatt B26 )) holds ((R4 in B26 & R5 in B26) implies ([ R4 , R5 ] in ( "\/" B27 ) iff (ex B28 being FinSequence st (1 <= ( len B28 ) & R4 = ( B28 . 1 ) & R5 = ( B28 . ( len B28 ) ) & (for B29 being (Element of ( NAT )) holds ((1 <= B29 & B29 < ( len B28 )) implies [ ( B28 . B29 ) , ( B28 . ( B29 + 1 ) ) ] in ( union B27 )))))))))))
proof
let R4 being set;
let R5 being set;
let C33 being set;
let C34 being (Subset of ( EqRelLatt C33 ));
assume that
L123: R4 in C33
and
L124: R5 in C33;
reconsider D30 = C33 as non  empty set by L123;
reconsider D31 = R4 , D32 = R5 as (Element of D30) by L123 , L124;
reconsider D33 = ( union C34 ) as (Relation of D30) by L77;
L125: D33 = ( D33 ~ ) by L110;
L126: ( D33 \/ ( D33 ~ ) ) = D33 by L125;
L127: ([ R4 , R5 ] in ( "\/" C34 ) implies D33 reduces R4 , R5)
proof
assume L128: [ R4 , R5 ] in ( "\/" C34 );
L129: [ D31 , D32 ] in ( EqCl D33 ) by L128 , L93;
L130: R4 , R5 are_convertible_wrt D33 by L129 , MSUALG_6:41;
thus L131: thesis by L130 , L126 , REWRITE1:def 4;
end;
thus L132: ([ R4 , R5 ] in ( "\/" C34 ) implies (ex B30 being FinSequence st (1 <= ( len B30 ) & R4 = ( B30 . 1 ) & R5 = ( B30 . ( len B30 ) ) & (for B31 being (Element of ( NAT )) holds ((1 <= B31 & B31 < ( len B30 )) implies [ ( B30 . B31 ) , ( B30 . ( B31 + 1 ) ) ] in ( union C34 ))))))
proof
assume L133: [ R4 , R5 ] in ( "\/" C34 );
consider C35 being FinSequence such that L134: ( len C35 ) > ( 0 ) and L135: (R4 = ( C35 . 1 ) & R5 = ( C35 . ( len C35 ) )) and L136: (for B32 being (Element of ( NAT )) holds ((B32 in ( dom C35 ) & ( B32 + 1 ) in ( dom C35 )) implies [ ( C35 . B32 ) , ( C35 . ( B32 + 1 ) ) ] in D33)) by L133 , L127 , REWRITE1:11;
take C35;
L137: ( ( 0 ) + 1 ) <= ( len C35 ) by L134 , NAT_1:13;
thus L138: (1 <= ( len C35 ) & R4 = ( C35 . 1 ) & R5 = ( C35 . ( len C35 ) )) by L137 , L135;
let C36 being (Element of ( NAT ));
assume L139: (1 <= C36 & C36 < ( len C35 ));
L140: (C36 in ( dom C35 ) & ( C36 + 1 ) in ( dom C35 )) by L139 , L1;
thus L141: thesis by L140 , L136;
end;

L142: (D33 reduces R4 , R5 implies [ R4 , R5 ] in ( "\/" C34 ))
proof
assume L143: D33 reduces R4 , R5;
L144: R4 , R5 are_convertible_wrt D33 by L143 , REWRITE1:25;
L145: [ D31 , D32 ] in ( EqCl D33 ) by L144 , MSUALG_6:41;
thus L146: thesis by L145 , L93;
end;
thus L147: ((ex B33 being FinSequence st (1 <= ( len B33 ) & R4 = ( B33 . 1 ) & R5 = ( B33 . ( len B33 ) ) & (for B34 being (Element of ( NAT )) holds ((1 <= B34 & B34 < ( len B33 )) implies [ ( B33 . B34 ) , ( B33 . ( B34 + 1 ) ) ] in ( union C34 ))))) implies [ R4 , R5 ] in ( "\/" C34 ))
proof
given C37 being FinSequence such that
L148: 1 <= ( len C37 )
and
L149: (R4 = ( C37 . 1 ) & R5 = ( C37 . ( len C37 ) ))
and
L150: (for B35 being (Element of ( NAT )) holds ((1 <= B35 & B35 < ( len C37 )) implies [ ( C37 . B35 ) , ( C37 . ( B35 + 1 ) ) ] in ( union C34 )));

L151:
now
let C38 being (Element of ( NAT ));
assume L152: (C38 in ( dom C37 ) & ( C38 + 1 ) in ( dom C37 ));
L153: (1 <= C38 & C38 < ( len C37 )) by L152 , L1;
thus L154: [ ( C37 . C38 ) , ( C37 . ( C38 + 1 ) ) ] in ( union C34 ) by L153 , L150;
end;
L155: ( ( 0 ) + 1 ) <= ( len C37 ) by L148;
L156: ( len C37 ) > ( 0 ) by L155 , NAT_1:13;
thus L157: thesis by L156 , L142 , L149 , L151 , REWRITE1:11;
end;

end;
begin
theorem
L148: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds (for B36 being (Subset of ( CongrLatt R12 )) holds ( "/\" (B36 , ( EqRelLatt (the Sorts of R12) )) ) is (MSCongruence of R12))))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
set D34 = (the Sorts of R12);
set D35 = ( EqRelLatt D34 );
set D36 = ( CongrLatt R12 );
let C39 being (Subset of D36);
set D37 = ( "/\" (C39 , D35) );
reconsider D38 = D37 as (Equivalence_Relation of (the Sorts of R12)) by MSUALG_5:def 5;
reconsider D39 = D38 as  MSEquivalence-like (ManySortedRelation of R12) by MSUALG_4:def 3;
L149: (the carrier of D36) c= (the carrier of D35) by NAT_LAT:def 12;
reconsider D40 = C39 as (Subset of D35) by L149 , XBOOLE_1:1;
reconsider D41 = D40 as (SubsetFamily of [| D34 , D34 |]) by MSUALG_7:5;
per cases ;
suppose L150: C39 is  empty;

reconsider D42 = C39 as  empty (Subset of ( CongrLatt R12 )) by L150;
L151: (for B37 being (Element of D35) holds (B37 in D42 implies ( Top D35 ) [= B37));
L152: ( Top D35 ) is_less_than C39 by L151 , LATTICE3:def 16;
L153: (for B38 being (Element of D35) holds (B38 is_less_than C39 implies B38 [= ( Top D35 ))) by LATTICES:19;
L154: ( "/\" (C39 , D35) ) = ( Top D35 ) by L153 , L152 , LATTICE3:34
.= [| D34 , D34 |] by MSUALG_7:4;
thus L155: thesis by L154 , MSUALG_5:18;
end;
suppose L156: C39 is non  empty;

L157: (for B39 being (OperSymbol of R11) holds (for B40 , B41 being (Element of ( Args (B39 , R12) )) holds ((for B42 being Nat holds (B42 in ( dom B40 ) implies [ ( B40 . B42 ) , ( B41 . B42 ) ] in ( D39 . ( ( the_arity_of B39 ) /. B42 ) ))) implies [ ( ( Den (B39 , R12) ) . B40 ) , ( ( Den (B39 , R12) ) . B41 ) ] in ( D39 . ( the_result_sort_of B39 ) ))))
proof
reconsider D43 = D41 as non  empty (SubsetFamily of [| D34 , D34 |]) by L156;
reconsider D44 = ( meet |: D41 :| ) as (Equivalence_Relation of D34) by L156 , MSUALG_7:8;
let C40 being (OperSymbol of R11);
let C41 , C42 being (Element of ( Args (C40 , R12) ));
L158: |: D43 :| is  non-empty;
assume L159: (for B43 being Nat holds (B43 in ( dom C41 ) implies [ ( C41 . B43 ) , ( C42 . B43 ) ] in ( D39 . ( ( the_arity_of C40 ) /. B43 ) )));
L160:
now
let C43 being (MSCongruence of R12);
assume L161: C43 in C39;
L162:
now
let C44 being Nat;
assume L163: C44 in ( dom C41 );
L164: [ ( C41 . C44 ) , ( C42 . C44 ) ] in ( D39 . ( ( the_arity_of C40 ) /. C44 ) ) by L163 , L159;
L165: [ ( C41 . C44 ) , ( C42 . C44 ) ] in ( D44 . ( ( the_arity_of C40 ) /. C44 ) ) by L164 , L156 , MSUALG_7:10;
L166: D44 c= C43 by L161 , MSUALG_7:7;
L167: ( D44 . ( ( the_arity_of C40 ) /. C44 ) ) c= ( C43 . ( ( the_arity_of C40 ) /. C44 ) ) by L166 , PBOOLE:def 2;
thus L168: [ ( C41 . C44 ) , ( C42 . C44 ) ] in ( C43 . ( ( the_arity_of C40 ) /. C44 ) ) by L167 , L165;
end;
thus L169: [ ( ( Den (C40 , R12) ) . C41 ) , ( ( Den (C40 , R12) ) . C42 ) ] in ( C43 . ( the_result_sort_of C40 ) ) by L162 , MSUALG_4:def 4;
end;
L170: ( |: D41 :| . ( the_result_sort_of C40 ) ) = { ( B44 . ( the_result_sort_of C40 ) ) where B44 is (Element of ( Bool [| D34 , D34 |] )) : B44 in C39 } by L156 , CLOSURE2:14;
L171:
now
let C45 being set;
assume L172: C45 in ( |: D41 :| . ( the_result_sort_of C40 ) );
consider C46 being (Element of ( Bool [| D34 , D34 |] )) such that L173: C45 = ( C46 . ( the_result_sort_of C40 ) ) and L174: C46 in C39 by L172 , L170;
reconsider D45 = C46 as (MSCongruence of R12) by L174 , MSUALG_5:def 6;
L175: [ ( ( Den (C40 , R12) ) . C41 ) , ( ( Den (C40 , R12) ) . C42 ) ] in ( D45 . ( the_result_sort_of C40 ) ) by L160 , L174;
thus L176: [ ( ( Den (C40 , R12) ) . C41 ) , ( ( Den (C40 , R12) ) . C42 ) ] in C45 by L175 , L173;
end;
L177: ((ex B45 being (Subset-Family of ( [| D34 , D34 |] . ( the_result_sort_of C40 ) )) st (B45 = ( |: D41 :| . ( the_result_sort_of C40 ) ) & ( D44 . ( the_result_sort_of C40 ) ) = ( Intersect B45 ))) & [ ( ( Den (C40 , R12) ) . C41 ) , ( ( Den (C40 , R12) ) . C42 ) ] in ( meet ( |: D41 :| . ( the_result_sort_of C40 ) ) )) by L171 , L158 , MSSUBFAM:def 1 , SETFAM_1:def 1;
L178: [ ( ( Den (C40 , R12) ) . C41 ) , ( ( Den (C40 , R12) ) . C42 ) ] in ( D44 . ( the_result_sort_of C40 ) ) by L177 , L158 , SETFAM_1:def 9;
thus L179: thesis by L178 , L156 , MSUALG_7:10;
end;
thus L180: thesis by L157 , MSUALG_4:def 4;
end;
end;
definition
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
let C47 being (Element of ( EqRelLatt (the Sorts of R12) ));
func CongrCl C47 -> (MSCongruence of R12) equals 
( "/\" ({ B46 where B46 is (Element of ( EqRelLatt (the Sorts of R12) )) : (B46 is (MSCongruence of R12) & C47 [= B46) } , ( EqRelLatt (the Sorts of R12) )) );
coherence
proof
set D46 = { B47 where B47 is (Element of ( EqRelLatt (the Sorts of R12) )) : (B47 is (MSCongruence of R12) & C47 [= B47) };
L182:
now
let C48 being set;
assume L183: C48 in D46;
L184: (ex B48 being (Element of ( EqRelLatt (the Sorts of R12) )) st (C48 = B48 & B48 is (MSCongruence of R12) & C47 [= B48)) by L183;
thus L185: C48 in (the carrier of ( CongrLatt R12 )) by L184 , MSUALG_5:def 6;
end;
reconsider D47 = D46 as (Subset of ( CongrLatt R12 )) by L182 , TARSKI:def 3;
L186: ( "/\" (D47 , ( EqRelLatt (the Sorts of R12) )) ) is (MSCongruence of R12) by L148;
thus L187: thesis by L186;
end;
end;
definition
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
let C49 being (Subset of ( EqRelLatt (the Sorts of R12) ));
func CongrCl C49 -> (MSCongruence of R12) equals 
( "/\" ({ B49 where B49 is (Element of ( EqRelLatt (the Sorts of R12) )) : (B49 is (MSCongruence of R12) & C49 is_less_than B49) } , ( EqRelLatt (the Sorts of R12) )) );
coherence
proof
set D48 = { B50 where B50 is (Element of ( EqRelLatt (the Sorts of R12) )) : (B50 is (MSCongruence of R12) & C49 is_less_than B50) };
L189:
now
let C50 being set;
assume L190: C50 in D48;
L191: (ex B51 being (Element of ( EqRelLatt (the Sorts of R12) )) st (C50 = B51 & B51 is (MSCongruence of R12) & C49 is_less_than B51)) by L190;
thus L192: C50 in (the carrier of ( CongrLatt R12 )) by L191 , MSUALG_5:def 6;
end;
reconsider D49 = D48 as (Subset of ( CongrLatt R12 )) by L189 , TARSKI:def 3;
L193: ( "/\" (D49 , ( EqRelLatt (the Sorts of R12) )) ) is (MSCongruence of R12) by L148;
thus L194: thesis by L193;
end;
end;
theorem
L196: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds (for B52 being (Element of ( EqRelLatt (the Sorts of R12) )) holds (B52 is (MSCongruence of R12) implies ( CongrCl B52 ) = B52))))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
let C51 being (Element of ( EqRelLatt (the Sorts of R12) ));
set D50 = { B53 where B53 is (Element of ( EqRelLatt (the Sorts of R12) )) : (B53 is (MSCongruence of R12) & C51 [= B53) };
L197:
now
let C52 being (Element of ( EqRelLatt (the Sorts of R12) ));
assume L198: C52 in D50;
L199: (ex B54 being (Element of ( EqRelLatt (the Sorts of R12) )) st (C52 = B54 & B54 is (MSCongruence of R12) & C51 [= B54)) by L198;
thus L200: C51 [= C52 by L199;
end;
L201: C51 is_less_than D50 by L197 , LATTICE3:def 16;
assume L202: C51 is (MSCongruence of R12);
L203: C51 in D50 by L202;
thus L204: thesis by L203 , L201 , LATTICE3:41;
end;
theorem
L205: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds (for B55 being (Subset of ( EqRelLatt (the Sorts of R12) )) holds ( CongrCl ( "\/" (B55 , ( EqRelLatt (the Sorts of R12) )) ) ) = ( CongrCl B55 ))))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
let C53 being (Subset of ( EqRelLatt (the Sorts of R12) ));
set D51 = { B56 where B56 is (Element of ( EqRelLatt (the Sorts of R12) )) : (B56 is (MSCongruence of R12) & ( "\/" (C53 , ( EqRelLatt (the Sorts of R12) )) ) [= B56) };
set D52 = { B57 where B57 is (Element of ( EqRelLatt (the Sorts of R12) )) : (B57 is (MSCongruence of R12) & C53 is_less_than B57) };
L206: D51 c= D52
proof
let C54 being set;
assume L207: C54 in D51;
consider C55 being (Element of ( EqRelLatt (the Sorts of R12) )) such that L208: (C54 = C55 & C55 is (MSCongruence of R12)) and L209: ( "\/" (C53 , ( EqRelLatt (the Sorts of R12) )) ) [= C55 by L207;
L210:
now
let C56 being (Element of ( EqRelLatt (the Sorts of R12) ));
L211: C53 is_less_than ( "\/" (C53 , ( EqRelLatt (the Sorts of R12) )) ) by LATTICE3:def 21;
assume L212: C56 in C53;
L213: C56 [= ( "\/" (C53 , ( EqRelLatt (the Sorts of R12) )) ) by L212 , L211 , LATTICE3:def 17;
thus L214: C56 [= C55 by L213 , L209 , LATTICES:7;
end;
L215: C53 is_less_than C55 by L210 , LATTICE3:def 17;
thus L216: thesis by L215 , L208;
end;
L217: D52 c= D51
proof
let C57 being set;
assume L218: C57 in D52;
consider C58 being (Element of ( EqRelLatt (the Sorts of R12) )) such that L219: (C57 = C58 & C58 is (MSCongruence of R12)) and L220: C53 is_less_than C58 by L218;
L221: ( "\/" (C53 , ( EqRelLatt (the Sorts of R12) )) ) [= C58 by L220 , LATTICE3:def 21;
thus L222: thesis by L221 , L219;
end;
thus L223: thesis by L217 , L206 , XBOOLE_0:def 10;
end;
theorem
L224: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds (for B58 , B59 being (Subset of ( CongrLatt R12 )) holds (for B60 , B61 being (MSCongruence of R12) holds ((B60 = ( "\/" (B58 , ( EqRelLatt (the Sorts of R12) )) ) & B61 = ( "\/" (B59 , ( EqRelLatt (the Sorts of R12) )) )) implies ( B60 "\/" B61 ) = ( "\/" (( B58 \/ B59 ) , ( EqRelLatt (the Sorts of R12) )) ))))))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
let C59 , C60 being (Subset of ( CongrLatt R12 ));
let C61 , C62 being (MSCongruence of R12);
set D53 = ( EqRelLatt (the Sorts of R12) );
assume L225: (C61 = ( "\/" (C59 , ( EqRelLatt (the Sorts of R12) )) ) & C62 = ( "\/" (C60 , ( EqRelLatt (the Sorts of R12) )) ));
L226: (the carrier of ( CongrLatt R12 )) c= (the carrier of ( EqRelLatt (the Sorts of R12) )) by NAT_LAT:def 12;
reconsider D54 = C59 , D55 = C60 as (Subset of ( EqRelLatt (the Sorts of R12) )) by L226 , XBOOLE_1:1;
L227: { ( "\/" D54 ) , ( "\/" D55 ) } c= { ( "\/" B62 ) where B62 is (Subset of D53) : B62 in { C59 , C60 } }
proof
let R4 being set;
assume L228: R4 in { ( "\/" D54 ) , ( "\/" D55 ) };
L229: (R4 = ( "\/" D54 ) or R4 = ( "\/" D55 )) by L228 , TARSKI:def 2;
L230: (D54 in { C59 , C60 } & D55 in { C59 , C60 }) by TARSKI:def 2;
thus L231: thesis by L230 , L229;
end;
L232: { ( "\/" B63 ) where B63 is (Subset of D53) : B63 in { C59 , C60 } } c= { ( "\/" D54 ) , ( "\/" D55 ) }
proof
let R4 being set;
assume L233: R4 in { ( "\/" B64 ) where B64 is (Subset of D53) : B64 in { C59 , C60 } };
consider C63 being (Subset of D53) such that L234: R4 = ( "\/" C63 ) and L235: C63 in { C59 , C60 } by L233;
L236: (C63 = C59 or C63 = C60) by L235 , TARSKI:def 2;
thus L237: thesis by L236 , L234 , TARSKI:def 2;
end;
L238: { ( "\/" B65 ) where B65 is (Subset of D53) : B65 in { C59 , C60 } } = { ( "\/" D54 ) , ( "\/" D55 ) } by L232 , L227 , XBOOLE_0:def 10;
L239:
now
let R7 being set;
assume L240: R7 in { C59 , C60 };
L241: (R7 = D54 or R7 = D55) by L240 , TARSKI:def 2;
thus L242: R7 in ( bool (the carrier of D53) ) by L241;
end;
L243: { C59 , C60 } c= ( bool (the carrier of D53) ) by L239 , TARSKI:def 3;
thus L244: ( "\/" (( C59 \/ C60 ) , ( EqRelLatt (the Sorts of R12) )) ) = ( "\/" (( union { C59 , C60 } ) , D53) ) by ZFMISC_1:75
.= ( "\/" ({ ( "\/" B66 ) where B66 is (Subset of D53) : B66 in { C59 , C60 } } , D53) ) by L243 , LATTICE3:48
.= ( ( "\/" D54 ) "\/" ( "\/" D55 ) ) by L238 , LATTICE3:43
.= ( (the L_join of D53) . (C61 , C62) ) by L225 , LATTICES:def 1
.= ( C61 "\/" C62 ) by MSUALG_5:def 5;
end;
theorem
L245: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds (for B67 being (Subset of ( CongrLatt R12 )) holds ( "\/" (B67 , ( EqRelLatt (the Sorts of R12) )) ) = ( "\/" ({ ( "\/" (B68 , ( EqRelLatt (the Sorts of R12) )) ) where B68 is (Subset of ( EqRelLatt (the Sorts of R12) )) : B68 is  finite  finite  finite  finite (Subset of B67) } , ( EqRelLatt (the Sorts of R12) )) ))))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
let C64 being (Subset of ( CongrLatt R12 ));
set D56 = ( EqRelLatt (the Sorts of R12) );
set D57 = { B69 where B69 is (Subset of D56) : B69 is  finite  finite  finite  finite (Subset of C64) };
set D58 = { ( "\/" B70 ) where B70 is (Subset of D56) : B70 in D57 };
set D59 = { ( "\/" (B71 , ( EqRelLatt (the Sorts of R12) )) ) where B71 is (Subset of D56) : B71 is  finite  finite  finite  finite (Subset of C64) };
L246: D59 c= D58
proof
let R4 being set;
assume L247: R4 in D59;
consider C65 being (Subset of D56) such that L248: R4 = ( "\/" C65 ) and L249: C65 is  finite  finite  finite  finite (Subset of C64) by L247;
L250: C65 in D57 by L249;
thus L251: thesis by L250 , L248;
end;
L252: C64 c= ( union D57 )
proof
let R4 being set;
assume L253: R4 in C64;
reconsider D60 = R4 as (Element of ( CongrLatt R12 )) by L253;
L254: (the carrier of ( CongrLatt R12 )) c= (the carrier of D56) by NAT_LAT:def 12;
reconsider D61 = D60 as (Element of D56) by L254 , TARSKI:def 3;
L255: { D61 } is  finite  finite  finite  finite (Subset of C64) by L253 , SUBSET_1:41;
L256: (R4 in { R4 } & { D61 } in D57) by L255 , TARSKI:def 1;
thus L257: thesis by L256 , TARSKI:def 4;
end;
L258: ( union D57 ) c= C64
proof
let R4 being set;
assume L259: R4 in ( union D57 );
consider C66 being set such that L260: R4 in C66 and L261: C66 in D57 by L259 , TARSKI:def 4;
L262: (ex B72 being (Subset of D56) st (C66 = B72 & B72 is  finite  finite  finite  finite (Subset of C64))) by L261;
thus L263: thesis by L262 , L260;
end;
L264: C64 = ( union D57 ) by L258 , L252 , XBOOLE_0:def 10;
L265:
now
let R7 being set;
assume L266: R7 in D57;
L267: (ex B73 being (Subset of D56) st (R7 = B73 & B73 is  finite  finite  finite  finite (Subset of C64))) by L266;
thus L268: R7 in ( bool (the carrier of D56) ) by L267;
end;
L269: D57 c= ( bool (the carrier of D56) ) by L265 , TARSKI:def 3;
L270: D58 c= D59
proof
let R4 being set;
assume L271: R4 in D58;
consider C67 being (Subset of D56) such that L272: R4 = ( "\/" C67 ) and L273: C67 in D57 by L271;
L274: (ex B74 being (Subset of D56) st (C67 = B74 & B74 is  finite  finite  finite  finite (Subset of C64))) by L273;
thus L275: thesis by L274 , L272;
end;
L276: D58 = D59 by L270 , L246 , XBOOLE_0:def 10;
thus L277: thesis by L276 , L269 , L264 , LATTICE3:48;
end;
theorem
L278: (for R1 being non  empty set holds (for R2 being (ManySortedSet of R1) holds (for B75 being (Element of R1) holds (for B76 being (Equivalence_Relation of ( R2 . B75 )) holds (ex B77 being (Equivalence_Relation of R2) st (( B77 . B75 ) = B76 & (for B78 being (Element of R1) holds (B78 <> B75 implies ( B77 . B78 ) = ( nabla ( R2 . B78 ) )))))))))
proof
let R1 being non  empty set;
let R2 being (ManySortedSet of R1);
let C68 being (Element of R1);
let C69 being (Equivalence_Relation of ( R2 . C68 ));
defpred S1[ set ] means $1 = C68;
deffunc H1(set) = C69;
deffunc H2(set) = ( nabla ( R2 . $1 ) );
consider C70 being Function such that L279: ( dom C70 ) = R1 and L280: (for R8 being set holds (R8 in R1 implies ((S1[ R8 ] implies ( C70 . R8 ) = H1(R8)) & ((not S1[ R8 ]) implies ( C70 . R8 ) = H2(R8))))) from PARTFUN1:sch 1;
reconsider D62 = C70 as (ManySortedSet of R1) by L279 , PARTFUN1:def 2 , RELAT_1:def 18;
L281:
now
let C71 being set;
assume L282: C71 in R1;
per cases ;
suppose L283: C71 = C68;

thus L284: ( D62 . C71 ) is (Relation of ( R2 . C71 )) by L283 , L280;
end;
suppose L285: C71 <> C68;

L286: ( D62 . C71 ) = ( nabla ( R2 . C71 ) ) by L285 , L280 , L282;
thus L287: ( D62 . C71 ) is (Relation of ( R2 . C71 )) by L286;
end;
end;
reconsider D63 = D62 as (ManySortedRelation of R2) by L281 , MSUALG_4:def 1;
L289:
now
let C72 being set;
let C73 being (Relation of ( R2 . C72 ));
assume that
L290: C72 in R1
and
L291: ( D63 . C72 ) = C73;
per cases ;
suppose L292: C72 = C68;

thus L293: C73 is (Equivalence_Relation of ( R2 . C72 )) by L292 , L280 , L291;
end;
suppose L294: C72 <> C68;

L295: ( D63 . C72 ) = ( nabla ( R2 . C72 ) ) by L294 , L280 , L290;
thus L296: C73 is (Equivalence_Relation of ( R2 . C72 )) by L295 , L291;
end;
end;
reconsider D64 = D63 as (Equivalence_Relation of R2) by L289 , MSUALG_4:def 2;
take D64;
thus L298: ( D64 . C68 ) = C69 by L280;
let C74 being (Element of R1);
assume L299: C74 <> C68;
thus L300: thesis by L299 , L280;
end;
notation
let C75 being non  empty set;
let C76 being (ManySortedSet of C75);
let C77 being (Element of C75);
let C78 being (Subset of ( EqRelLatt C76 ));
synonym EqRelSet (C78 , C77) for pi (C78 , C77);
end;
definition
let C79 being non  empty set;
let C80 being (ManySortedSet of C79);
let C81 being (Element of C79);
let C82 being (Subset of ( EqRelLatt C80 ));
redefine func EqRelSet (C82 , C81) -> (Subset of ( EqRelLatt ( C80 . C81 ) )) means 
:L302: (for R4 being set holds (R4 in it iff (ex B79 being (Equivalence_Relation of C80) st (R4 = ( B79 . C81 ) & B79 in C82))));
coherence
proof
L303: ( pi (C82 , C81) ) c= (the carrier of ( EqRelLatt ( C80 . C81 ) ))
proof
let C83 being set;
assume L304: C83 in ( pi (C82 , C81) );
consider C84 being Function such that L305: C84 in C82 and L306: C83 = ( C84 . C81 ) by L304 , CARD_3:def 6;
reconsider D65 = C84 as (Equivalence_Relation of C80) by L305 , MSUALG_5:def 5;
L307: ( D65 . C81 ) is (Equivalence_Relation of ( C80 . C81 )) by MSUALG_4:def 2;
thus L308: thesis by L307 , L306 , MSUALG_5:21;
end;
thus L309: thesis by L303;
end;
compatibility
proof
thus L310: (for B80 being (Subset of ( EqRelLatt ( C80 . C81 ) )) holds (B80 = ( pi (C82 , C81) ) iff (for R4 being set holds (R4 in B80 iff (ex B81 being (Equivalence_Relation of C80) st (R4 = ( B81 . C81 ) & B81 in C82))))))
proof
let C85 being (Subset of ( EqRelLatt ( C80 . C81 ) ));
thus L311: (C85 = ( pi (C82 , C81) ) implies (for R4 being set holds (R4 in C85 iff (ex B82 being (Equivalence_Relation of C80) st (R4 = ( B82 . C81 ) & B82 in C82)))))
proof
assume L312: C85 = ( pi (C82 , C81) );
let R4 being set;
thus L313: (R4 in C85 implies (ex B83 being (Equivalence_Relation of C80) st (R4 = ( B83 . C81 ) & B83 in C82)))
proof
assume L314: R4 in C85;
consider C86 being Function such that L315: C86 in C82 and L316: R4 = ( C86 . C81 ) by L314 , L312 , CARD_3:def 6;
reconsider D66 = C86 as (Equivalence_Relation of C80) by L315 , MSUALG_5:def 5;
take D66;
thus L317: thesis by L315 , L316;
end;

thus L318: thesis by L312 , CARD_3:def 6;
end;

thus L319: ((for R4 being set holds (R4 in C85 iff (ex B84 being (Equivalence_Relation of C80) st (R4 = ( B84 . C81 ) & B84 in C82)))) implies C85 = ( pi (C82 , C81) ))
proof
assume L320: (for R4 being set holds (R4 in C85 iff (ex B85 being (Equivalence_Relation of C80) st (R4 = ( B85 . C81 ) & B85 in C82))));
thus L321: C85 c= ( pi (C82 , C81) )
proof
let R6 being set;
assume L322: R6 in C85;
L323: (ex B86 being (Equivalence_Relation of C80) st (R6 = ( B86 . C81 ) & B86 in C82)) by L322 , L320;
thus L324: thesis by L323 , CARD_3:def 6;
end;

thus L325: ( pi (C82 , C81) ) c= C85
proof
let R6 being set;
assume L326: R6 in ( pi (C82 , C81) );
consider C87 being Function such that L327: C87 in C82 and L328: R6 = ( C87 . C81 ) by L326 , CARD_3:def 6;
reconsider D67 = C87 as (Equivalence_Relation of C80) by L327 , MSUALG_5:def 5;
L329: (ex B87 being (Equivalence_Relation of C80) st (R6 = ( B87 . C81 ) & B87 in C82))
proof
take D67;
thus L330: thesis by L327 , L328;
end;
thus L331: thesis by L329 , L320;
end;

end;

end;

end;
end;
theorem
L312: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds (for B88 being (Element of R11) holds (for B89 being (Subset of ( EqRelLatt (the Sorts of R12) )) holds (for B90 being (Equivalence_Relation of (the Sorts of R12)) holds (B90 = ( "\/" B89 ) implies ( B90 . B88 ) = ( "\/" (( EqRelSet (B89 , B88) ) , ( EqRelLatt ( (the Sorts of R12) . B88 ) )) )))))))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
let C88 being (Element of R11);
set D68 = (the Sorts of R12);
set D69 = ( EqRelLatt D68 );
set D70 = ( EqRelLatt ( D68 . C88 ) );
let C89 being (Subset of D69);
let C90 being (Equivalence_Relation of D68);
reconsider D71 = C90 as (Element of D69) by MSUALG_5:def 5;
reconsider D72 = ( C90 . C88 ) as (Equivalence_Relation of ( D68 . C88 )) by MSUALG_4:def 2;
reconsider D73 = D72 as (Element of D70) by MSUALG_5:21;
assume L313: C90 = ( "\/" C89 );
L314:
now
let C91 being (Element of D70);
reconsider D74 = C91 as (Equivalence_Relation of ( D68 . C88 )) by MSUALG_5:21;
consider C92 being (Equivalence_Relation of (the Sorts of R12)) such that L315: ( C92 . C88 ) = D74 and L316: (for B91 being (SortSymbol of R11) holds (B91 <> C88 implies ( C92 . B91 ) = ( nabla ( (the Sorts of R12) . B91 ) ))) by L278;
reconsider D75 = C92 as (Element of D69) by MSUALG_5:def 5;
assume L317: ( EqRelSet (C89 , C88) ) is_less_than C91;
L318:
now
let C93 being (Element of D69);
reconsider D76 = C93 as (Equivalence_Relation of D68) by MSUALG_5:def 5;
reconsider D77 = ( D76 . C88 ) as (Equivalence_Relation of ( D68 . C88 )) by MSUALG_4:def 2;
reconsider D78 = D77 as (Element of D70) by MSUALG_5:21;
assume L319: C93 in C89;
L320: D78 in ( EqRelSet (C89 , C88) ) by L319 , L302;
L321: D78 [= C91 by L320 , L317 , LATTICE3:def 17;
L322:
now
let R8 being set;
assume L323: R8 in (the carrier of R11);
reconsider D79 = R8 as (Element of R11) by L323;
reconsider D80 = ( C92 . D79 ) , D81 = ( D76 . D79 ) as (Equivalence_Relation of ( D68 . R8 )) by MSUALG_4:def 2;
per cases ;
suppose L324: R8 = C88;

thus L325: ( D76 . R8 ) c= ( C92 . R8 ) by L324 , L315 , L321 , L14;
end;
suppose L326: R8 <> C88;

L327: ( C92 . R8 ) = ( nabla ( (the Sorts of R12) . R8 ) ) by L326 , L316 , L323;
L328: ( D81 /\ D80 ) = D81 by L327 , XBOOLE_1:28;
thus L329: ( D76 . R8 ) c= ( C92 . R8 ) by L328 , XBOOLE_1:17;
end;
end;
L331: D76 c= C92 by L322 , PBOOLE:def 2;
thus L332: C93 [= D75 by L331 , MSUALG_7:6;
end;
L333: C89 is_less_than D75 by L318 , LATTICE3:def 17;
L334: D71 [= D75 by L333 , L313 , LATTICE3:def 21;
L335: C90 c= C92 by L334 , MSUALG_7:6;
L336: D72 c= D74 by L335 , L315 , PBOOLE:def 2;
thus L337: D73 [= C91 by L336 , L14;
end;
L338:
now
let C94 being (Element of D70);
reconsider D82 = C94 as (Equivalence_Relation of ( D68 . C88 )) by MSUALG_5:21;
assume L339: C94 in ( EqRelSet (C89 , C88) );
consider C95 being (Equivalence_Relation of D68) such that L340: C94 = ( C95 . C88 ) and L341: C95 in C89 by L339 , L302;
reconsider D83 = C95 as (Element of D69) by MSUALG_5:def 5;
L342: D83 [= D71 by L313 , L341 , LATTICE3:38;
L343: C95 c= C90 by L342 , MSUALG_7:6;
L344: D82 c= D72 by L343 , L340 , PBOOLE:def 2;
thus L345: C94 [= D73 by L344 , L14;
end;
L346: ( EqRelSet (C89 , C88) ) is_less_than D73 by L338 , LATTICE3:def 17;
thus L347: thesis by L346 , L314 , LATTICE3:def 21;
end;
theorem
L348: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds (for B92 being (Subset of ( CongrLatt R12 )) holds ( "\/" (B92 , ( EqRelLatt (the Sorts of R12) )) ) is (MSCongruence of R12))))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
let C96 being (Subset of ( CongrLatt R12 ));
set D84 = (the Sorts of R12);
set D85 = ( EqRelLatt D84 );
L349: (the carrier of ( CongrLatt R12 )) c= (the carrier of ( EqRelLatt D84 )) by NAT_LAT:def 12;
reconsider D86 = C96 as (Subset of ( EqRelLatt D84 )) by L349 , XBOOLE_1:1;
reconsider D87 = ( "\/" (D86 , D85) ) as (Equivalence_Relation of D84) by MSUALG_5:def 5;
reconsider D88 = D87 as (ManySortedRelation of R12);
reconsider D89 = D88 as  MSEquivalence-like (ManySortedRelation of R12) by MSUALG_4:def 3;
L350: (for B93 , B94 being (SortSymbol of R11) holds (for B95 being Function holds (B95 is_e.translation_of R12 , B93 , B94 implies (for B96 , B97 being set holds ([ B96 , B97 ] in ( D89 . B93 ) implies [ ( B95 . B96 ) , ( B95 . B97 ) ] in ( D89 . B94 ))))))
proof
let C97 , C98 being (SortSymbol of R11);
let C99 being Function;
assume L351: C99 is_e.translation_of R12 , C97 , C98;
reconsider D90 = C99 as (Function of ( D84 . C97 ) , ( D84 . C98 )) by L351 , MSUALG_6:11;
let C100 , C101 being set;
assume L352: [ C100 , C101 ] in ( D89 . C97 );
L353: C100 in ( D84 . C97 ) by L352 , ZFMISC_1:87;
L354: C101 in ( D84 . C97 ) by L352 , ZFMISC_1:87;
L355: ( D90 . C101 ) in ( D84 . C98 ) by L354 , FUNCT_2:5;
L356: [ C100 , C101 ] in ( "\/" ( EqRelSet (D86 , C97) ) ) by L352 , L312;
consider C102 being FinSequence such that L357: 1 <= ( len C102 ) and L358: C100 = ( C102 . 1 ) and L359: C101 = ( C102 . ( len C102 ) ) and L360: (for B98 being (Element of ( NAT )) holds ((1 <= B98 & B98 < ( len C102 )) implies [ ( C102 . B98 ) , ( C102 . ( B98 + 1 ) ) ] in ( union ( EqRelSet (D86 , C97) ) ))) by L356 , L353 , L354 , L122;
L361: (ex B99 being FinSequence st (1 <= ( len B99 ) & ( C99 . C100 ) = ( B99 . 1 ) & ( C99 . C101 ) = ( B99 . ( len B99 ) ) & (for B100 being (Element of ( NAT )) holds ((1 <= B100 & B100 < ( len B99 )) implies [ ( B99 . B100 ) , ( B99 . ( B100 + 1 ) ) ] in ( union ( EqRelSet (D86 , C98) ) )))))
proof
deffunc H3(set) = ( C99 . ( C102 . $1 ) );
consider C103 being FinSequence such that L362: (( len C103 ) = ( len C102 ) & (for B101 being Nat holds (B101 in ( dom C103 ) implies ( C103 . B101 ) = H3(B101)))) from FINSEQ_1:sch 2;
take C103;
thus L363: 1 <= ( len C103 ) by L357 , L362;
L364: ( dom C103 ) = ( Seg ( len C102 ) ) by L362 , FINSEQ_1:def 3;
L365: 1 in ( Seg ( len C102 ) ) by L357 , FINSEQ_1:1;
thus L366: ( C103 . 1 ) = ( C99 . C100 ) by L365 , L358 , L362 , L364;
L367: ( len C103 ) in ( Seg ( len C102 ) ) by L357 , L362 , FINSEQ_1:1;
thus L368: ( C103 . ( len C103 ) ) = ( C99 . C101 ) by L367 , L359 , L362 , L364;
let C104 being (Element of ( NAT ));
assume that
L369: 1 <= C104
and
L370: C104 < ( len C103 );
L371: 1 <= ( C104 + 1 ) by L369 , NAT_1:13;
L372: [ ( C102 . C104 ) , ( C102 . ( C104 + 1 ) ) ] in ( union ( EqRelSet (D86 , C97) ) ) by L360 , L362 , L369 , L370;
consider C105 being set such that L373: [ ( C102 . C104 ) , ( C102 . ( C104 + 1 ) ) ] in C105 and L374: C105 in ( EqRelSet (D86 , C97) ) by L372 , TARSKI:def 4;
consider C106 being (Equivalence_Relation of D84) such that L375: C105 = ( C106 . C97 ) and L376: C106 in D86 by L374 , L302;
reconsider D91 = C106 as (ManySortedRelation of R12);
reconsider D92 = D91 as  MSEquivalence-like (ManySortedRelation of R12) by MSUALG_4:def 3;
L377: D92 is (MSCongruence of R12) by L376 , MSUALG_5:def 6;
reconsider D93 = D92 as  compatible  MSEquivalence-like (ManySortedRelation of R12) by L377 , MSUALG_6:27;
L378: (ex B102 being set st ([ ( C99 . ( C102 . C104 ) ) , ( C99 . ( C102 . ( C104 + 1 ) ) ) ] in B102 & B102 in ( EqRelSet (D86 , C98) )))
proof
take D94 = ( D93 . C98 );
thus L379: [ ( C99 . ( C102 . C104 ) ) , ( C99 . ( C102 . ( C104 + 1 ) ) ) ] in D94 by L351 , L373 , L375 , MSUALG_6:def 8;
thus L380: thesis by L376 , L302;
end;
L381: [ ( C99 . ( C102 . C104 ) ) , ( C99 . ( C102 . ( C104 + 1 ) ) ) ] in ( union ( EqRelSet (D86 , C98) ) ) by L378 , TARSKI:def 4;
L382: ( C104 + 1 ) <= ( len C102 ) by L362 , L370 , NAT_1:13;
L383: ( C104 + 1 ) in ( Seg ( len C102 ) ) by L382 , L371 , FINSEQ_1:1;
L384: C104 in ( Seg ( len C102 ) ) by L362 , L369 , L370 , FINSEQ_1:1;
L385: ( C103 . C104 ) = ( C99 . ( C102 . C104 ) ) by L384 , L362 , L364;
thus L386: thesis by L385 , L362 , L364 , L381 , L383;
end;
L387: ( D90 . C100 ) in ( D84 . C98 ) by L353 , FUNCT_2:5;
L388: [ ( C99 . C100 ) , ( C99 . C101 ) ] in ( "\/" ( EqRelSet (D86 , C98) ) ) by L387 , L355 , L361 , L122;
thus L389: thesis by L388 , L312;
end;
reconsider D95 = D89 as  invariant  MSEquivalence-like (ManySortedRelation of R12) by L350 , MSUALG_6:def 8;
L390: D95 is  compatible;
thus L391: thesis by L390 , MSUALG_6:27;
end;
theorem
L392: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds ( CongrLatt R12 ) is  /\-inheriting))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
set D96 = ( EqRelLatt (the Sorts of R12) );
set D97 = ( CongrLatt R12 );
L393:
now
let C107 being (Subset of D97);
reconsider D98 = ( "/\" (C107 , D96) ) as (MSCongruence of R12) by L148;
L394: D98 in (the carrier of D97) by MSUALG_5:def 6;
thus L395: ( "/\" (C107 , D96) ) in (the carrier of D97) by L394;
end;
thus L396: thesis by L393 , MSUALG_7:def 2;
end;
theorem
L397: (for R11 being non  void non  empty ManySortedSign holds (for R12 being  non-empty MSAlgebra over R11 holds ( CongrLatt R12 ) is  \/-inheriting))
proof
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
set D99 = ( EqRelLatt (the Sorts of R12) );
set D100 = ( CongrLatt R12 );
L398:
now
let C108 being (Subset of D100);
reconsider D101 = ( "\/" (C108 , D99) ) as (MSCongruence of R12) by L348;
L399: D101 in (the carrier of D100) by MSUALG_5:def 6;
thus L400: ( "\/" (C108 , D99) ) in (the carrier of D100) by L399;
end;
thus L401: thesis by L398 , MSUALG_7:def 3;
end;
registration
let R11 being non  void non  empty ManySortedSign;
let R12 being  non-empty MSAlgebra over R11;
cluster ( CongrLatt R12 ) ->  /\-inheriting  \/-inheriting;
coherence by L392 , L397;
end;
